var aZ=Object.defineProperty,iZ=Object.defineProperties;var oZ=Object.getOwnPropertyDescriptors;var K0=Object.getOwnPropertySymbols;var hR=Object.prototype.hasOwnProperty,mR=Object.prototype.propertyIsEnumerable;var pR=e=>{throw TypeError(e)},Qp=Math.pow,Zj=(e,t,r)=>t in e?aZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,D=(e,t)=>{for(var r in t||(t={}))hR.call(t,r)&&Zj(e,r,t[r]);if(K0)for(var r of K0(t))mR.call(t,r)&&Zj(e,r,t[r]);return e},V=(e,t)=>iZ(e,oZ(t));var ge=(e,t)=>{var r={};for(var n in e)hR.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&K0)for(var n of K0(e))t.indexOf(n)<0&&mR.call(e,n)&&(r[n]=e[n]);return r};var Pr=(e,t,r)=>Zj(e,typeof t!="symbol"?t+"":t,r),Xj=(e,t,r)=>t.has(e)||pR("Cannot "+r);var it=(e,t,r)=>(Xj(e,t,"read from private field"),r?r.call(e):t.get(e)),bn=(e,t,r)=>t.has(e)?pR("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Tr=(e,t,r,n)=>(Xj(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),wa=(e,t,r)=>(Xj(e,t,"access private method"),r);var Z0=(e,t,r,n)=>({set _(a){Tr(e,t,a,r)},get _(){return it(e,t,n)}});var E=(e,t,r)=>new Promise((n,a)=>{var i=c=>{try{l(r.next(c))}catch(d){a(d)}},o=c=>{try{l(r.throw(c))}catch(d){a(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(i,o);l((r=r.apply(e,t)).next())});function lZ(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var na=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function wn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function cZ(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var lL={exports:{}},Cb={},cL={exports:{}},ln={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iy=Symbol.for("react.element"),dZ=Symbol.for("react.portal"),uZ=Symbol.for("react.fragment"),fZ=Symbol.for("react.strict_mode"),hZ=Symbol.for("react.profiler"),mZ=Symbol.for("react.provider"),pZ=Symbol.for("react.context"),gZ=Symbol.for("react.forward_ref"),vZ=Symbol.for("react.suspense"),yZ=Symbol.for("react.memo"),xZ=Symbol.for("react.lazy"),gR=Symbol.iterator;function _Z(e){return e===null||typeof e!="object"?null:(e=gR&&e[gR]||e["@@iterator"],typeof e=="function"?e:null)}var dL={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},uL=Object.assign,fL={};function cp(e,t,r){this.props=e,this.context=t,this.refs=fL,this.updater=r||dL}cp.prototype.isReactComponent={};cp.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};cp.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function hL(){}hL.prototype=cp.prototype;function RC(e,t,r){this.props=e,this.context=t,this.refs=fL,this.updater=r||dL}var OC=RC.prototype=new hL;OC.constructor=RC;uL(OC,cp.prototype);OC.isPureReactComponent=!0;var vR=Array.isArray,mL=Object.prototype.hasOwnProperty,MC={current:null},pL={key:!0,ref:!0,__self:!0,__source:!0};function gL(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)mL.call(t,n)&&!pL.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:Iy,type:e,key:i,ref:o,props:a,_owner:MC.current}}function wZ(e,t){return{$$typeof:Iy,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function DC(e){return typeof e=="object"&&e!==null&&e.$$typeof===Iy}function bZ(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var yR=/\/+/g;function Jj(e,t){return typeof e=="object"&&e!==null&&e.key!=null?bZ(""+e.key):t.toString(36)}function Jx(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Iy:case dZ:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+Jj(o,0):n,vR(a)?(r="",e!=null&&(r=e.replace(yR,"$&/")+"/"),Jx(a,t,r,"",function(d){return d})):a!=null&&(DC(a)&&(a=wZ(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(yR,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",vR(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+Jj(i,l);o+=Jx(i,t,r,c,a)}else if(c=_Z(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+Jj(i,l++),o+=Jx(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function X0(e,t,r){if(e==null)return e;var n=[],a=0;return Jx(e,n,"","",function(i){return t.call(r,i,a++)}),n}function jZ(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Za={current:null},Qx={transition:null},NZ={ReactCurrentDispatcher:Za,ReactCurrentBatchConfig:Qx,ReactCurrentOwner:MC};function vL(){throw Error("act(...) is not supported in production builds of React.")}ln.Children={map:X0,forEach:function(e,t,r){X0(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return X0(e,function(){t++}),t},toArray:function(e){return X0(e,function(t){return t})||[]},only:function(e){if(!DC(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ln.Component=cp;ln.Fragment=uZ;ln.Profiler=hZ;ln.PureComponent=RC;ln.StrictMode=fZ;ln.Suspense=vZ;ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NZ;ln.act=vL;ln.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=uL({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=MC.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)mL.call(t,c)&&!pL.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:Iy,type:e.type,key:a,ref:i,props:n,_owner:o}};ln.createContext=function(e){return e={$$typeof:pZ,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:mZ,_context:e},e.Consumer=e};ln.createElement=gL;ln.createFactory=function(e){var t=gL.bind(null,e);return t.type=e,t};ln.createRef=function(){return{current:null}};ln.forwardRef=function(e){return{$$typeof:gZ,render:e}};ln.isValidElement=DC;ln.lazy=function(e){return{$$typeof:xZ,_payload:{_status:-1,_result:e},_init:jZ}};ln.memo=function(e,t){return{$$typeof:yZ,type:e,compare:t===void 0?null:t}};ln.startTransition=function(e){var t=Qx.transition;Qx.transition={};try{e()}finally{Qx.transition=t}};ln.unstable_act=vL;ln.useCallback=function(e,t){return Za.current.useCallback(e,t)};ln.useContext=function(e){return Za.current.useContext(e)};ln.useDebugValue=function(){};ln.useDeferredValue=function(e){return Za.current.useDeferredValue(e)};ln.useEffect=function(e,t){return Za.current.useEffect(e,t)};ln.useId=function(){return Za.current.useId()};ln.useImperativeHandle=function(e,t,r){return Za.current.useImperativeHandle(e,t,r)};ln.useInsertionEffect=function(e,t){return Za.current.useInsertionEffect(e,t)};ln.useLayoutEffect=function(e,t){return Za.current.useLayoutEffect(e,t)};ln.useMemo=function(e,t){return Za.current.useMemo(e,t)};ln.useReducer=function(e,t,r){return Za.current.useReducer(e,t,r)};ln.useRef=function(e){return Za.current.useRef(e)};ln.useState=function(e){return Za.current.useState(e)};ln.useSyncExternalStore=function(e,t,r){return Za.current.useSyncExternalStore(e,t,r)};ln.useTransition=function(){return Za.current.useTransition()};ln.version="18.3.1";cL.exports=ln;var y=cL.exports;const te=wn(y),IC=lZ({__proto__:null,default:te},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SZ=y,kZ=Symbol.for("react.element"),EZ=Symbol.for("react.fragment"),CZ=Object.prototype.hasOwnProperty,PZ=SZ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,TZ={key:!0,ref:!0,__self:!0,__source:!0};function yL(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)CZ.call(t,n)&&!TZ.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:kZ,type:e,key:i,ref:o,props:a,_owner:PZ.current}}Cb.Fragment=EZ;Cb.jsx=yL;Cb.jsxs=yL;lL.exports=Cb;var s=lL.exports,xL={exports:{}},Li={},_L={exports:{}},wL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(q,K){var Z=q.length;q.push(K);e:for(;0<Z;){var ne=Z-1>>>1,Y=q[ne];if(0<a(Y,K))q[ne]=K,q[Z]=Y,Z=ne;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var K=q[0],Z=q.pop();if(Z!==K){q[0]=Z;e:for(var ne=0,Y=q.length,X=Y>>>1;ne<X;){var se=2*(ne+1)-1,de=q[se],_e=se+1,xe=q[_e];if(0>a(de,Z))_e<Y&&0>a(xe,de)?(q[ne]=xe,q[_e]=Z,ne=_e):(q[ne]=de,q[se]=Z,ne=se);else if(_e<Y&&0>a(xe,Z))q[ne]=xe,q[_e]=Z,ne=_e;else break e}}return K}function a(q,K){var Z=q.sortIndex-K.sortIndex;return Z!==0?Z:q.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],f=1,u=null,h=3,m=!1,v=!1,g=!1,x=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(q){for(var K=r(d);K!==null;){if(K.callback===null)n(d);else if(K.startTime<=q)n(d),K.sortIndex=K.expirationTime,t(c,K);else break;K=r(d)}}function N(q){if(g=!1,b(q),!v)if(r(c)!==null)v=!0,U(S);else{var K=r(d);K!==null&&H(N,K.startTime-q)}}function S(q,K){v=!1,g&&(g=!1,_(A),A=-1),m=!0;var Z=h;try{for(b(K),u=r(c);u!==null&&(!(u.expirationTime>K)||q&&!O());){var ne=u.callback;if(typeof ne=="function"){u.callback=null,h=u.priorityLevel;var Y=ne(u.expirationTime<=K);K=e.unstable_now(),typeof Y=="function"?u.callback=Y:u===r(c)&&n(c),b(K)}else n(c);u=r(c)}if(u!==null)var X=!0;else{var se=r(d);se!==null&&H(N,se.startTime-K),X=!1}return X}finally{u=null,h=Z,m=!1}}var k=!1,C=null,A=-1,R=5,I=-1;function O(){return!(e.unstable_now()-I<R)}function z(){if(C!==null){var q=e.unstable_now();I=q;var K=!0;try{K=C(!0,q)}finally{K?M():(k=!1,C=null)}}else k=!1}var M;if(typeof w=="function")M=function(){w(z)};else if(typeof MessageChannel!="undefined"){var B=new MessageChannel,F=B.port2;B.port1.onmessage=z,M=function(){F.postMessage(null)}}else M=function(){x(z,0)};function U(q){C=q,k||(k=!0,M())}function H(q,K){A=x(function(){q(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,U(S))},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(q){switch(h){case 1:case 2:case 3:var K=3;break;default:K=h}var Z=h;h=K;try{return q()}finally{h=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(q,K){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var Z=h;h=q;try{return K()}finally{h=Z}},e.unstable_scheduleCallback=function(q,K,Z){var ne=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ne+Z:ne):Z=ne,q){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=Z+Y,q={id:f++,callback:K,priorityLevel:q,startTime:Z,expirationTime:Y,sortIndex:-1},Z>ne?(q.sortIndex=Z,t(d,q),r(c)===null&&q===r(d)&&(g?(_(A),A=-1):g=!0,H(N,Z-ne))):(q.sortIndex=Y,t(c,q),v||m||(v=!0,U(S))),q},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(q){var K=h;return function(){var Z=h;h=K;try{return q.apply(this,arguments)}finally{h=Z}}}})(wL);_L.exports=wL;var AZ=_L.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RZ=y,$i=AZ;function xt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bL=new Set,mv={};function kf(e,t){pm(e,t),pm(e+"Capture",t)}function pm(e,t){for(mv[e]=t,e=0;e<t.length;e++)bL.add(t[e])}var Pc=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),QS=Object.prototype.hasOwnProperty,OZ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xR={},_R={};function MZ(e){return QS.call(_R,e)?!0:QS.call(xR,e)?!1:OZ.test(e)?_R[e]=!0:(xR[e]=!0,!1)}function DZ(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function IZ(e,t,r,n){if(t===null||typeof t=="undefined"||DZ(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Xa(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var va={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){va[e]=new Xa(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];va[t]=new Xa(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){va[e]=new Xa(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){va[e]=new Xa(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){va[e]=new Xa(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){va[e]=new Xa(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){va[e]=new Xa(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){va[e]=new Xa(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){va[e]=new Xa(e,5,!1,e.toLowerCase(),null,!1,!1)});var $C=/[\-:]([a-z])/g;function LC(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($C,LC);va[t]=new Xa(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($C,LC);va[t]=new Xa(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($C,LC);va[t]=new Xa(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){va[e]=new Xa(e,1,!1,e.toLowerCase(),null,!1,!1)});va.xlinkHref=new Xa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){va[e]=new Xa(e,1,!1,e.toLowerCase(),null,!0,!0)});function FC(e,t,r,n){var a=va.hasOwnProperty(t)?va[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(IZ(t,r,a,n)&&(r=null),n||a===null?MZ(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Uc=RZ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,J0=Symbol.for("react.element"),xh=Symbol.for("react.portal"),_h=Symbol.for("react.fragment"),zC=Symbol.for("react.strict_mode"),ek=Symbol.for("react.profiler"),jL=Symbol.for("react.provider"),NL=Symbol.for("react.context"),BC=Symbol.for("react.forward_ref"),tk=Symbol.for("react.suspense"),rk=Symbol.for("react.suspense_list"),UC=Symbol.for("react.memo"),cd=Symbol.for("react.lazy"),SL=Symbol.for("react.offscreen"),wR=Symbol.iterator;function eg(e){return e===null||typeof e!="object"?null:(e=wR&&e[wR]||e["@@iterator"],typeof e=="function"?e:null)}var fs=Object.assign,Qj;function Dg(e){if(Qj===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Qj=t&&t[1]||""}return`
`+Qj+e}var eN=!1;function tN(e,t){if(!e||eN)return"";eN=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var c=`
`+a[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{eN=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Dg(e):""}function $Z(e){switch(e.tag){case 5:return Dg(e.type);case 16:return Dg("Lazy");case 13:return Dg("Suspense");case 19:return Dg("SuspenseList");case 0:case 2:case 15:return e=tN(e.type,!1),e;case 11:return e=tN(e.type.render,!1),e;case 1:return e=tN(e.type,!0),e;default:return""}}function nk(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case _h:return"Fragment";case xh:return"Portal";case ek:return"Profiler";case zC:return"StrictMode";case tk:return"Suspense";case rk:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case NL:return(e.displayName||"Context")+".Consumer";case jL:return(e._context.displayName||"Context")+".Provider";case BC:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case UC:return t=e.displayName||null,t!==null?t:nk(e.type)||"Memo";case cd:t=e._payload,e=e._init;try{return nk(e(t))}catch(r){}}return null}function LZ(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return nk(t);case 8:return t===zC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Fd(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function kL(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function FZ(e){var t=kL(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r!="undefined"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Q0(e){e._valueTracker||(e._valueTracker=FZ(e))}function EL(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=kL(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function b_(e){if(e=e||(typeof document!="undefined"?document:void 0),typeof e=="undefined")return null;try{return e.activeElement||e.body}catch(t){return e.body}}function sk(e,t){var r=t.checked;return fs({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r!=null?r:e._wrapperState.initialChecked})}function bR(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Fd(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function CL(e,t){t=t.checked,t!=null&&FC(e,"checked",t,!1)}function ak(e,t){CL(e,t);var r=Fd(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ik(e,t.type,r):t.hasOwnProperty("defaultValue")&&ik(e,t.type,Fd(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function jR(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ik(e,t,r){(t!=="number"||b_(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ig=Array.isArray;function zh(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Fd(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function ok(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(xt(91));return fs({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function NR(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(xt(92));if(Ig(r)){if(1<r.length)throw Error(xt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Fd(r)}}function PL(e,t){var r=Fd(t.value),n=Fd(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function SR(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function TL(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lk(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?TL(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ex,AL=function(e){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ex=ex||document.createElement("div"),ex.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ex.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function pv(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Gg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zZ=["Webkit","ms","Moz","O"];Object.keys(Gg).forEach(function(e){zZ.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Gg[t]=Gg[e]})});function RL(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Gg.hasOwnProperty(e)&&Gg[e]?(""+t).trim():t+"px"}function OL(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=RL(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var BZ=fs({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ck(e,t){if(t){if(BZ[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(xt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(xt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(xt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(xt(62))}}function dk(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var uk=null;function qC(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var fk=null,Bh=null,Uh=null;function kR(e){if(e=Fy(e)){if(typeof fk!="function")throw Error(xt(280));var t=e.stateNode;t&&(t=Ob(t),fk(e.stateNode,e.type,t))}}function ML(e){Bh?Uh?Uh.push(e):Uh=[e]:Bh=e}function DL(){if(Bh){var e=Bh,t=Uh;if(Uh=Bh=null,kR(e),t)for(e=0;e<t.length;e++)kR(t[e])}}function IL(e,t){return e(t)}function $L(){}var rN=!1;function LL(e,t,r){if(rN)return e(t,r);rN=!0;try{return IL(e,t,r)}finally{rN=!1,(Bh!==null||Uh!==null)&&($L(),DL())}}function gv(e,t){var r=e.stateNode;if(r===null)return null;var n=Ob(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(xt(231,t,typeof r));return r}var hk=!1;if(Pc)try{var tg={};Object.defineProperty(tg,"passive",{get:function(){hk=!0}}),window.addEventListener("test",tg,tg),window.removeEventListener("test",tg,tg)}catch(e){hk=!1}function UZ(e,t,r,n,a,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(f){this.onError(f)}}var Yg=!1,j_=null,N_=!1,mk=null,qZ={onError:function(e){Yg=!0,j_=e}};function VZ(e,t,r,n,a,i,o,l,c){Yg=!1,j_=null,UZ.apply(qZ,arguments)}function WZ(e,t,r,n,a,i,o,l,c){if(VZ.apply(this,arguments),Yg){if(Yg){var d=j_;Yg=!1,j_=null}else throw Error(xt(198));N_||(N_=!0,mk=d)}}function Ef(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function FL(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ER(e){if(Ef(e)!==e)throw Error(xt(188))}function HZ(e){var t=e.alternate;if(!t){if(t=Ef(e),t===null)throw Error(xt(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return ER(a),e;if(i===n)return ER(a),t;i=i.sibling}throw Error(xt(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(xt(189))}}if(r.alternate!==n)throw Error(xt(190))}if(r.tag!==3)throw Error(xt(188));return r.stateNode.current===r?e:t}function zL(e){return e=HZ(e),e!==null?BL(e):null}function BL(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=BL(e);if(t!==null)return t;e=e.sibling}return null}var UL=$i.unstable_scheduleCallback,CR=$i.unstable_cancelCallback,GZ=$i.unstable_shouldYield,YZ=$i.unstable_requestPaint,Ss=$i.unstable_now,KZ=$i.unstable_getCurrentPriorityLevel,VC=$i.unstable_ImmediatePriority,qL=$i.unstable_UserBlockingPriority,S_=$i.unstable_NormalPriority,ZZ=$i.unstable_LowPriority,VL=$i.unstable_IdlePriority,Pb=null,Al=null;function XZ(e){if(Al&&typeof Al.onCommitFiberRoot=="function")try{Al.onCommitFiberRoot(Pb,e,void 0,(e.current.flags&128)===128)}catch(t){}}var Vo=Math.clz32?Math.clz32:eX,JZ=Math.log,QZ=Math.LN2;function eX(e){return e>>>=0,e===0?32:31-(JZ(e)/QZ|0)|0}var tx=64,rx=4194304;function $g(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function k_(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=$g(l):(i&=o,i!==0&&(n=$g(i)))}else o=r&~a,o!==0?n=$g(o):i!==0&&(n=$g(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Vo(t),a=1<<r,n|=e[r],t&=~a;return n}function tX(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rX(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Vo(i),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=tX(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function pk(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function WL(){var e=tx;return tx<<=1,!(tx&4194240)&&(tx=64),e}function nN(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function $y(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Vo(t),e[t]=r}function nX(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Vo(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function WC(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Vo(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Mn=0;function HL(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var GL,HC,YL,KL,ZL,gk=!1,nx=[],Cd=null,Pd=null,Td=null,vv=new Map,yv=new Map,fd=[],sX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function PR(e,t){switch(e){case"focusin":case"focusout":Cd=null;break;case"dragenter":case"dragleave":Pd=null;break;case"mouseover":case"mouseout":Td=null;break;case"pointerover":case"pointerout":vv.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":yv.delete(t.pointerId)}}function rg(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Fy(t),t!==null&&HC(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function aX(e,t,r,n,a){switch(t){case"focusin":return Cd=rg(Cd,e,t,r,n,a),!0;case"dragenter":return Pd=rg(Pd,e,t,r,n,a),!0;case"mouseover":return Td=rg(Td,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return vv.set(i,rg(vv.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,yv.set(i,rg(yv.get(i)||null,e,t,r,n,a)),!0}return!1}function XL(e){var t=Cu(e.target);if(t!==null){var r=Ef(t);if(r!==null){if(t=r.tag,t===13){if(t=FL(r),t!==null){e.blockedOn=t,ZL(e.priority,function(){YL(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function e_(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=vk(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);uk=n,r.target.dispatchEvent(n),uk=null}else return t=Fy(r),t!==null&&HC(t),e.blockedOn=r,!1;t.shift()}return!0}function TR(e,t,r){e_(e)&&r.delete(t)}function iX(){gk=!1,Cd!==null&&e_(Cd)&&(Cd=null),Pd!==null&&e_(Pd)&&(Pd=null),Td!==null&&e_(Td)&&(Td=null),vv.forEach(TR),yv.forEach(TR)}function ng(e,t){e.blockedOn===t&&(e.blockedOn=null,gk||(gk=!0,$i.unstable_scheduleCallback($i.unstable_NormalPriority,iX)))}function xv(e){function t(a){return ng(a,e)}if(0<nx.length){ng(nx[0],e);for(var r=1;r<nx.length;r++){var n=nx[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Cd!==null&&ng(Cd,e),Pd!==null&&ng(Pd,e),Td!==null&&ng(Td,e),vv.forEach(t),yv.forEach(t),r=0;r<fd.length;r++)n=fd[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<fd.length&&(r=fd[0],r.blockedOn===null);)XL(r),r.blockedOn===null&&fd.shift()}var qh=Uc.ReactCurrentBatchConfig,E_=!0;function oX(e,t,r,n){var a=Mn,i=qh.transition;qh.transition=null;try{Mn=1,GC(e,t,r,n)}finally{Mn=a,qh.transition=i}}function lX(e,t,r,n){var a=Mn,i=qh.transition;qh.transition=null;try{Mn=4,GC(e,t,r,n)}finally{Mn=a,qh.transition=i}}function GC(e,t,r,n){if(E_){var a=vk(e,t,r,n);if(a===null)hN(e,t,n,C_,r),PR(e,n);else if(aX(a,e,t,r,n))n.stopPropagation();else if(PR(e,n),t&4&&-1<sX.indexOf(e)){for(;a!==null;){var i=Fy(a);if(i!==null&&GL(i),i=vk(e,t,r,n),i===null&&hN(e,t,n,C_,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else hN(e,t,n,null,r)}}var C_=null;function vk(e,t,r,n){if(C_=null,e=qC(n),e=Cu(e),e!==null)if(t=Ef(e),t===null)e=null;else if(r=t.tag,r===13){if(e=FL(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return C_=e,null}function JL(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(KZ()){case VC:return 1;case qL:return 4;case S_:case ZZ:return 16;case VL:return 536870912;default:return 16}default:return 16}}var bd=null,YC=null,t_=null;function QL(){if(t_)return t_;var e,t=YC,r=t.length,n,a="value"in bd?bd.value:bd.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return t_=a.slice(e,1<n?1-n:void 0)}function r_(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function sx(){return!0}function AR(){return!1}function Fi(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?sx:AR,this.isPropagationStopped=AR,this}return fs(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=sx)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=sx)},persist:function(){},isPersistent:sx}),t}var dp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},KC=Fi(dp),Ly=fs({},dp,{view:0,detail:0}),cX=Fi(Ly),sN,aN,sg,Tb=fs({},Ly,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ZC,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sg&&(sg&&e.type==="mousemove"?(sN=e.screenX-sg.screenX,aN=e.screenY-sg.screenY):aN=sN=0,sg=e),sN)},movementY:function(e){return"movementY"in e?e.movementY:aN}}),RR=Fi(Tb),dX=fs({},Tb,{dataTransfer:0}),uX=Fi(dX),fX=fs({},Ly,{relatedTarget:0}),iN=Fi(fX),hX=fs({},dp,{animationName:0,elapsedTime:0,pseudoElement:0}),mX=Fi(hX),pX=fs({},dp,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),gX=Fi(pX),vX=fs({},dp,{data:0}),OR=Fi(vX),yX={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xX={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_X={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wX(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_X[e])?!!t[e]:!1}function ZC(){return wX}var bX=fs({},Ly,{key:function(e){if(e.key){var t=yX[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=r_(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?xX[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ZC,charCode:function(e){return e.type==="keypress"?r_(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?r_(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),jX=Fi(bX),NX=fs({},Tb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),MR=Fi(NX),SX=fs({},Ly,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ZC}),kX=Fi(SX),EX=fs({},dp,{propertyName:0,elapsedTime:0,pseudoElement:0}),CX=Fi(EX),PX=fs({},Tb,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),TX=Fi(PX),AX=[9,13,27,32],XC=Pc&&"CompositionEvent"in window,Kg=null;Pc&&"documentMode"in document&&(Kg=document.documentMode);var RX=Pc&&"TextEvent"in window&&!Kg,e6=Pc&&(!XC||Kg&&8<Kg&&11>=Kg),DR=" ",IR=!1;function t6(e,t){switch(e){case"keyup":return AX.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function r6(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var wh=!1;function OX(e,t){switch(e){case"compositionend":return r6(t);case"keypress":return t.which!==32?null:(IR=!0,DR);case"textInput":return e=t.data,e===DR&&IR?null:e;default:return null}}function MX(e,t){if(wh)return e==="compositionend"||!XC&&t6(e,t)?(e=QL(),t_=YC=bd=null,wh=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return e6&&t.locale!=="ko"?null:t.data;default:return null}}var DX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $R(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!DX[e.type]:t==="textarea"}function n6(e,t,r,n){ML(n),t=P_(t,"onChange"),0<t.length&&(r=new KC("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Zg=null,_v=null;function IX(e){m6(e,0)}function Ab(e){var t=Nh(e);if(EL(t))return e}function $X(e,t){if(e==="change")return t}var s6=!1;if(Pc){var oN;if(Pc){var lN="oninput"in document;if(!lN){var LR=document.createElement("div");LR.setAttribute("oninput","return;"),lN=typeof LR.oninput=="function"}oN=lN}else oN=!1;s6=oN&&(!document.documentMode||9<document.documentMode)}function FR(){Zg&&(Zg.detachEvent("onpropertychange",a6),_v=Zg=null)}function a6(e){if(e.propertyName==="value"&&Ab(_v)){var t=[];n6(t,_v,e,qC(e)),LL(IX,t)}}function LX(e,t,r){e==="focusin"?(FR(),Zg=t,_v=r,Zg.attachEvent("onpropertychange",a6)):e==="focusout"&&FR()}function FX(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ab(_v)}function zX(e,t){if(e==="click")return Ab(t)}function BX(e,t){if(e==="input"||e==="change")return Ab(t)}function UX(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Go=typeof Object.is=="function"?Object.is:UX;function wv(e,t){if(Go(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!QS.call(t,a)||!Go(e[a],t[a]))return!1}return!0}function zR(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function BR(e,t){var r=zR(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=zR(r)}}function i6(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?i6(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function o6(){for(var e=window,t=b_();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch(n){r=!1}if(r)e=t.contentWindow;else break;t=b_(e.document)}return t}function JC(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function qX(e){var t=o6(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&i6(r.ownerDocument.documentElement,r)){if(n!==null&&JC(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=BR(r,i);var o=BR(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var VX=Pc&&"documentMode"in document&&11>=document.documentMode,bh=null,yk=null,Xg=null,xk=!1;function UR(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;xk||bh==null||bh!==b_(n)||(n=bh,"selectionStart"in n&&JC(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Xg&&wv(Xg,n)||(Xg=n,n=P_(yk,"onSelect"),0<n.length&&(t=new KC("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=bh)))}function ax(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var jh={animationend:ax("Animation","AnimationEnd"),animationiteration:ax("Animation","AnimationIteration"),animationstart:ax("Animation","AnimationStart"),transitionend:ax("Transition","TransitionEnd")},cN={},l6={};Pc&&(l6=document.createElement("div").style,"AnimationEvent"in window||(delete jh.animationend.animation,delete jh.animationiteration.animation,delete jh.animationstart.animation),"TransitionEvent"in window||delete jh.transitionend.transition);function Rb(e){if(cN[e])return cN[e];if(!jh[e])return e;var t=jh[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in l6)return cN[e]=t[r];return e}var c6=Rb("animationend"),d6=Rb("animationiteration"),u6=Rb("animationstart"),f6=Rb("transitionend"),h6=new Map,qR="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Kd(e,t){h6.set(e,t),kf(t,[e])}for(var dN=0;dN<qR.length;dN++){var uN=qR[dN],WX=uN.toLowerCase(),HX=uN[0].toUpperCase()+uN.slice(1);Kd(WX,"on"+HX)}Kd(c6,"onAnimationEnd");Kd(d6,"onAnimationIteration");Kd(u6,"onAnimationStart");Kd("dblclick","onDoubleClick");Kd("focusin","onFocus");Kd("focusout","onBlur");Kd(f6,"onTransitionEnd");pm("onMouseEnter",["mouseout","mouseover"]);pm("onMouseLeave",["mouseout","mouseover"]);pm("onPointerEnter",["pointerout","pointerover"]);pm("onPointerLeave",["pointerout","pointerover"]);kf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));kf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));kf("onBeforeInput",["compositionend","keypress","textInput","paste"]);kf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));kf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));kf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GX=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lg));function VR(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,WZ(n,t,void 0,e),e.currentTarget=null}function m6(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;VR(a,l,d),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;VR(a,l,d),i=c}}}if(N_)throw e=mk,N_=!1,mk=null,e}function Zn(e,t){var r=t[Nk];r===void 0&&(r=t[Nk]=new Set);var n=e+"__bubble";r.has(n)||(p6(t,e,2,!1),r.add(n))}function fN(e,t,r){var n=0;t&&(n|=4),p6(r,e,n,t)}var ix="_reactListening"+Math.random().toString(36).slice(2);function bv(e){if(!e[ix]){e[ix]=!0,bL.forEach(function(r){r!=="selectionchange"&&(GX.has(r)||fN(r,!1,e),fN(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ix]||(t[ix]=!0,fN("selectionchange",!1,t))}}function p6(e,t,r,n){switch(JL(t)){case 1:var a=oX;break;case 4:a=lX;break;default:a=GC}r=a.bind(null,t,r,e),a=void 0,!hk||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function hN(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=Cu(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}LL(function(){var d=i,f=qC(r),u=[];e:{var h=h6.get(e);if(h!==void 0){var m=KC,v=e;switch(e){case"keypress":if(r_(r)===0)break e;case"keydown":case"keyup":m=jX;break;case"focusin":v="focus",m=iN;break;case"focusout":v="blur",m=iN;break;case"beforeblur":case"afterblur":m=iN;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=RR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=uX;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=kX;break;case c6:case d6:case u6:m=mX;break;case f6:m=CX;break;case"scroll":m=cX;break;case"wheel":m=TX;break;case"copy":case"cut":case"paste":m=gX;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=MR}var g=(t&4)!==0,x=!g&&e==="scroll",_=g?h!==null?h+"Capture":null:h;g=[];for(var w=d,b;w!==null;){b=w;var N=b.stateNode;if(b.tag===5&&N!==null&&(b=N,_!==null&&(N=gv(w,_),N!=null&&g.push(jv(w,N,b)))),x)break;w=w.return}0<g.length&&(h=new m(h,v,null,r,f),u.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==uk&&(v=r.relatedTarget||r.fromElement)&&(Cu(v)||v[Tc]))break e;if((m||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=d,v=v?Cu(v):null,v!==null&&(x=Ef(v),v!==x||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=d),m!==v)){if(g=RR,N="onMouseLeave",_="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(g=MR,N="onPointerLeave",_="onPointerEnter",w="pointer"),x=m==null?h:Nh(m),b=v==null?h:Nh(v),h=new g(N,w+"leave",m,r,f),h.target=x,h.relatedTarget=b,N=null,Cu(f)===d&&(g=new g(_,w+"enter",v,r,f),g.target=b,g.relatedTarget=x,N=g),x=N,m&&v)t:{for(g=m,_=v,w=0,b=g;b;b=Kf(b))w++;for(b=0,N=_;N;N=Kf(N))b++;for(;0<w-b;)g=Kf(g),w--;for(;0<b-w;)_=Kf(_),b--;for(;w--;){if(g===_||_!==null&&g===_.alternate)break t;g=Kf(g),_=Kf(_)}g=null}else g=null;m!==null&&WR(u,h,m,g,!1),v!==null&&x!==null&&WR(u,x,v,g,!0)}}e:{if(h=d?Nh(d):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var S=$X;else if($R(h))if(s6)S=BX;else{S=FX;var k=LX}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=zX);if(S&&(S=S(e,d))){n6(u,S,r,f);break e}k&&k(e,h,d),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&ik(h,"number",h.value)}switch(k=d?Nh(d):window,e){case"focusin":($R(k)||k.contentEditable==="true")&&(bh=k,yk=d,Xg=null);break;case"focusout":Xg=yk=bh=null;break;case"mousedown":xk=!0;break;case"contextmenu":case"mouseup":case"dragend":xk=!1,UR(u,r,f);break;case"selectionchange":if(VX)break;case"keydown":case"keyup":UR(u,r,f)}var C;if(XC)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else wh?t6(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(e6&&r.locale!=="ko"&&(wh||A!=="onCompositionStart"?A==="onCompositionEnd"&&wh&&(C=QL()):(bd=f,YC="value"in bd?bd.value:bd.textContent,wh=!0)),k=P_(d,A),0<k.length&&(A=new OR(A,e,null,r,f),u.push({event:A,listeners:k}),C?A.data=C:(C=r6(r),C!==null&&(A.data=C)))),(C=RX?OX(e,r):MX(e,r))&&(d=P_(d,"onBeforeInput"),0<d.length&&(f=new OR("onBeforeInput","beforeinput",null,r,f),u.push({event:f,listeners:d}),f.data=C))}m6(u,t)})}function jv(e,t,r){return{instance:e,listener:t,currentTarget:r}}function P_(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=gv(e,r),i!=null&&n.unshift(jv(e,i,a)),i=gv(e,t),i!=null&&n.push(jv(e,i,a))),e=e.return}return n}function Kf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function WR(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,a?(c=gv(r,i),c!=null&&o.unshift(jv(r,c,l))):a||(c=gv(r,i),c!=null&&o.push(jv(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var YX=/\r\n?/g,KX=/\u0000|\uFFFD/g;function HR(e){return(typeof e=="string"?e:""+e).replace(YX,`
`).replace(KX,"")}function ox(e,t,r){if(t=HR(t),HR(e)!==t&&r)throw Error(xt(425))}function T_(){}var _k=null,wk=null;function bk(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var jk=typeof setTimeout=="function"?setTimeout:void 0,ZX=typeof clearTimeout=="function"?clearTimeout:void 0,GR=typeof Promise=="function"?Promise:void 0,XX=typeof queueMicrotask=="function"?queueMicrotask:typeof GR!="undefined"?function(e){return GR.resolve(null).then(e).catch(JX)}:jk;function JX(e){setTimeout(function(){throw e})}function mN(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),xv(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);xv(t)}function Ad(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function YR(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var up=Math.random().toString(36).slice(2),xl="__reactFiber$"+up,Nv="__reactProps$"+up,Tc="__reactContainer$"+up,Nk="__reactEvents$"+up,QX="__reactListeners$"+up,eJ="__reactHandles$"+up;function Cu(e){var t=e[xl];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Tc]||r[xl]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=YR(e);e!==null;){if(r=e[xl])return r;e=YR(e)}return t}e=r,r=e.parentNode}return null}function Fy(e){return e=e[xl]||e[Tc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Nh(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(xt(33))}function Ob(e){return e[Nv]||null}var Sk=[],Sh=-1;function Zd(e){return{current:e}}function Qn(e){0>Sh||(e.current=Sk[Sh],Sk[Sh]=null,Sh--)}function Vn(e,t){Sh++,Sk[Sh]=e.current,e.current=t}var zd={},Ma=Zd(zd),mi=Zd(!1),sf=zd;function gm(e,t){var r=e.type.contextTypes;if(!r)return zd;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function pi(e){return e=e.childContextTypes,e!=null}function A_(){Qn(mi),Qn(Ma)}function KR(e,t,r){if(Ma.current!==zd)throw Error(xt(168));Vn(Ma,t),Vn(mi,r)}function g6(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(xt(108,LZ(e)||"Unknown",a));return fs({},r,n)}function R_(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||zd,sf=Ma.current,Vn(Ma,e),Vn(mi,mi.current),!0}function ZR(e,t,r){var n=e.stateNode;if(!n)throw Error(xt(169));r?(e=g6(e,t,sf),n.__reactInternalMemoizedMergedChildContext=e,Qn(mi),Qn(Ma),Vn(Ma,e)):Qn(mi),Vn(mi,r)}var dc=null,Mb=!1,pN=!1;function v6(e){dc===null?dc=[e]:dc.push(e)}function tJ(e){Mb=!0,v6(e)}function Xd(){if(!pN&&dc!==null){pN=!0;var e=0,t=Mn;try{var r=dc;for(Mn=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}dc=null,Mb=!1}catch(a){throw dc!==null&&(dc=dc.slice(e+1)),UL(VC,Xd),a}finally{Mn=t,pN=!1}}return null}var kh=[],Eh=0,O_=null,M_=0,Hi=[],Gi=0,af=null,hc=1,mc="";function vu(e,t){kh[Eh++]=M_,kh[Eh++]=O_,O_=e,M_=t}function y6(e,t,r){Hi[Gi++]=hc,Hi[Gi++]=mc,Hi[Gi++]=af,af=e;var n=hc;e=mc;var a=32-Vo(n)-1;n&=~(1<<a),r+=1;var i=32-Vo(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,hc=1<<32-Vo(t)+a|r<<a|n,mc=i+e}else hc=1<<i|r<<a|n,mc=e}function QC(e){e.return!==null&&(vu(e,1),y6(e,1,0))}function eP(e){for(;e===O_;)O_=kh[--Eh],kh[Eh]=null,M_=kh[--Eh],kh[Eh]=null;for(;e===af;)af=Hi[--Gi],Hi[Gi]=null,mc=Hi[--Gi],Hi[Gi]=null,hc=Hi[--Gi],Hi[Gi]=null}var Di=null,Oi=null,ss=!1,Mo=null;function x6(e,t){var r=Qi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function XR(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Di=e,Oi=Ad(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Di=e,Oi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=af!==null?{id:hc,overflow:mc}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Qi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Di=e,Oi=null,!0):!1;default:return!1}}function kk(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ek(e){if(ss){var t=Oi;if(t){var r=t;if(!XR(e,t)){if(kk(e))throw Error(xt(418));t=Ad(r.nextSibling);var n=Di;t&&XR(e,t)?x6(n,r):(e.flags=e.flags&-4097|2,ss=!1,Di=e)}}else{if(kk(e))throw Error(xt(418));e.flags=e.flags&-4097|2,ss=!1,Di=e}}}function JR(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Di=e}function lx(e){if(e!==Di)return!1;if(!ss)return JR(e),ss=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!bk(e.type,e.memoizedProps)),t&&(t=Oi)){if(kk(e))throw _6(),Error(xt(418));for(;t;)x6(e,t),t=Ad(t.nextSibling)}if(JR(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(xt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Oi=Ad(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Oi=null}}else Oi=Di?Ad(e.stateNode.nextSibling):null;return!0}function _6(){for(var e=Oi;e;)e=Ad(e.nextSibling)}function vm(){Oi=Di=null,ss=!1}function tP(e){Mo===null?Mo=[e]:Mo.push(e)}var rJ=Uc.ReactCurrentBatchConfig;function ag(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(xt(309));var n=r.stateNode}if(!n)throw Error(xt(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(xt(284));if(!r._owner)throw Error(xt(290,e))}return e}function cx(e,t){throw e=Object.prototype.toString.call(t),Error(xt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function QR(e){var t=e._init;return t(e._payload)}function w6(e){function t(_,w){if(e){var b=_.deletions;b===null?(_.deletions=[w],_.flags|=16):b.push(w)}}function r(_,w){if(!e)return null;for(;w!==null;)t(_,w),w=w.sibling;return null}function n(_,w){for(_=new Map;w!==null;)w.key!==null?_.set(w.key,w):_.set(w.index,w),w=w.sibling;return _}function a(_,w){return _=Dd(_,w),_.index=0,_.sibling=null,_}function i(_,w,b){return _.index=b,e?(b=_.alternate,b!==null?(b=b.index,b<w?(_.flags|=2,w):b):(_.flags|=2,w)):(_.flags|=1048576,w)}function o(_){return e&&_.alternate===null&&(_.flags|=2),_}function l(_,w,b,N){return w===null||w.tag!==6?(w=bN(b,_.mode,N),w.return=_,w):(w=a(w,b),w.return=_,w)}function c(_,w,b,N){var S=b.type;return S===_h?f(_,w,b.props.children,N,b.key):w!==null&&(w.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===cd&&QR(S)===w.type)?(N=a(w,b.props),N.ref=ag(_,w,b),N.return=_,N):(N=c_(b.type,b.key,b.props,null,_.mode,N),N.ref=ag(_,w,b),N.return=_,N)}function d(_,w,b,N){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=jN(b,_.mode,N),w.return=_,w):(w=a(w,b.children||[]),w.return=_,w)}function f(_,w,b,N,S){return w===null||w.tag!==7?(w=Xu(b,_.mode,N,S),w.return=_,w):(w=a(w,b),w.return=_,w)}function u(_,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=bN(""+w,_.mode,b),w.return=_,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case J0:return b=c_(w.type,w.key,w.props,null,_.mode,b),b.ref=ag(_,null,w),b.return=_,b;case xh:return w=jN(w,_.mode,b),w.return=_,w;case cd:var N=w._init;return u(_,N(w._payload),b)}if(Ig(w)||eg(w))return w=Xu(w,_.mode,b,null),w.return=_,w;cx(_,w)}return null}function h(_,w,b,N){var S=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:l(_,w,""+b,N);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case J0:return b.key===S?c(_,w,b,N):null;case xh:return b.key===S?d(_,w,b,N):null;case cd:return S=b._init,h(_,w,S(b._payload),N)}if(Ig(b)||eg(b))return S!==null?null:f(_,w,b,N,null);cx(_,b)}return null}function m(_,w,b,N,S){if(typeof N=="string"&&N!==""||typeof N=="number")return _=_.get(b)||null,l(w,_,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case J0:return _=_.get(N.key===null?b:N.key)||null,c(w,_,N,S);case xh:return _=_.get(N.key===null?b:N.key)||null,d(w,_,N,S);case cd:var k=N._init;return m(_,w,b,k(N._payload),S)}if(Ig(N)||eg(N))return _=_.get(b)||null,f(w,_,N,S,null);cx(w,N)}return null}function v(_,w,b,N){for(var S=null,k=null,C=w,A=w=0,R=null;C!==null&&A<b.length;A++){C.index>A?(R=C,C=null):R=C.sibling;var I=h(_,C,b[A],N);if(I===null){C===null&&(C=R);break}e&&C&&I.alternate===null&&t(_,C),w=i(I,w,A),k===null?S=I:k.sibling=I,k=I,C=R}if(A===b.length)return r(_,C),ss&&vu(_,A),S;if(C===null){for(;A<b.length;A++)C=u(_,b[A],N),C!==null&&(w=i(C,w,A),k===null?S=C:k.sibling=C,k=C);return ss&&vu(_,A),S}for(C=n(_,C);A<b.length;A++)R=m(C,_,A,b[A],N),R!==null&&(e&&R.alternate!==null&&C.delete(R.key===null?A:R.key),w=i(R,w,A),k===null?S=R:k.sibling=R,k=R);return e&&C.forEach(function(O){return t(_,O)}),ss&&vu(_,A),S}function g(_,w,b,N){var S=eg(b);if(typeof S!="function")throw Error(xt(150));if(b=S.call(b),b==null)throw Error(xt(151));for(var k=S=null,C=w,A=w=0,R=null,I=b.next();C!==null&&!I.done;A++,I=b.next()){C.index>A?(R=C,C=null):R=C.sibling;var O=h(_,C,I.value,N);if(O===null){C===null&&(C=R);break}e&&C&&O.alternate===null&&t(_,C),w=i(O,w,A),k===null?S=O:k.sibling=O,k=O,C=R}if(I.done)return r(_,C),ss&&vu(_,A),S;if(C===null){for(;!I.done;A++,I=b.next())I=u(_,I.value,N),I!==null&&(w=i(I,w,A),k===null?S=I:k.sibling=I,k=I);return ss&&vu(_,A),S}for(C=n(_,C);!I.done;A++,I=b.next())I=m(C,_,A,I.value,N),I!==null&&(e&&I.alternate!==null&&C.delete(I.key===null?A:I.key),w=i(I,w,A),k===null?S=I:k.sibling=I,k=I);return e&&C.forEach(function(z){return t(_,z)}),ss&&vu(_,A),S}function x(_,w,b,N){if(typeof b=="object"&&b!==null&&b.type===_h&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case J0:e:{for(var S=b.key,k=w;k!==null;){if(k.key===S){if(S=b.type,S===_h){if(k.tag===7){r(_,k.sibling),w=a(k,b.props.children),w.return=_,_=w;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===cd&&QR(S)===k.type){r(_,k.sibling),w=a(k,b.props),w.ref=ag(_,k,b),w.return=_,_=w;break e}r(_,k);break}else t(_,k);k=k.sibling}b.type===_h?(w=Xu(b.props.children,_.mode,N,b.key),w.return=_,_=w):(N=c_(b.type,b.key,b.props,null,_.mode,N),N.ref=ag(_,w,b),N.return=_,_=N)}return o(_);case xh:e:{for(k=b.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){r(_,w.sibling),w=a(w,b.children||[]),w.return=_,_=w;break e}else{r(_,w);break}else t(_,w);w=w.sibling}w=jN(b,_.mode,N),w.return=_,_=w}return o(_);case cd:return k=b._init,x(_,w,k(b._payload),N)}if(Ig(b))return v(_,w,b,N);if(eg(b))return g(_,w,b,N);cx(_,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(r(_,w.sibling),w=a(w,b),w.return=_,_=w):(r(_,w),w=bN(b,_.mode,N),w.return=_,_=w),o(_)):r(_,w)}return x}var ym=w6(!0),b6=w6(!1),D_=Zd(null),I_=null,Ch=null,rP=null;function nP(){rP=Ch=I_=null}function sP(e){var t=D_.current;Qn(D_),e._currentValue=t}function Ck(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Vh(e,t){I_=e,rP=Ch=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ui=!0),e.firstContext=null)}function uo(e){var t=e._currentValue;if(rP!==e)if(e={context:e,memoizedValue:t,next:null},Ch===null){if(I_===null)throw Error(xt(308));Ch=e,I_.dependencies={lanes:0,firstContext:e}}else Ch=Ch.next=e;return t}var Pu=null;function aP(e){Pu===null?Pu=[e]:Pu.push(e)}function j6(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,aP(t)):(r.next=a.next,a.next=r),t.interleaved=r,Ac(e,n)}function Ac(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var dd=!1;function iP(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function N6(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function jc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Rd(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,_n&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Ac(e,r)}return a=n.interleaved,a===null?(t.next=t,aP(n)):(t.next=a.next,a.next=t),n.interleaved=t,Ac(e,r)}function n_(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,WC(e,r)}}function eO(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function $_(e,t,r,n){var a=e.updateQueue;dd=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=c))}if(i!==null){var u=a.baseState;o=0,f=d=c=null,l=i;do{var h=l.lane,m=l.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,g=l;switch(h=t,m=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){u=v.call(m,u,h);break e}u=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,h=typeof v=="function"?v.call(m,u,h):v,h==null)break e;u=fs({},u,h);break e;case 2:dd=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=m,c=u):f=f.next=m,o|=h;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;h=l,l=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(f===null&&(c=u),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);lf|=o,e.lanes=o,e.memoizedState=u}}function tO(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(xt(191,a));a.call(n)}}}var zy={},Rl=Zd(zy),Sv=Zd(zy),kv=Zd(zy);function Tu(e){if(e===zy)throw Error(xt(174));return e}function oP(e,t){switch(Vn(kv,t),Vn(Sv,e),Vn(Rl,zy),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:lk(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=lk(t,e)}Qn(Rl),Vn(Rl,t)}function xm(){Qn(Rl),Qn(Sv),Qn(kv)}function S6(e){Tu(kv.current);var t=Tu(Rl.current),r=lk(t,e.type);t!==r&&(Vn(Sv,e),Vn(Rl,r))}function lP(e){Sv.current===e&&(Qn(Rl),Qn(Sv))}var ls=Zd(0);function L_(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var gN=[];function cP(){for(var e=0;e<gN.length;e++)gN[e]._workInProgressVersionPrimary=null;gN.length=0}var s_=Uc.ReactCurrentDispatcher,vN=Uc.ReactCurrentBatchConfig,of=0,us=null,qs=null,Qs=null,F_=!1,Jg=!1,Ev=0,nJ=0;function ba(){throw Error(xt(321))}function dP(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Go(e[r],t[r]))return!1;return!0}function uP(e,t,r,n,a,i){if(of=i,us=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,s_.current=e===null||e.memoizedState===null?oJ:lJ,e=r(n,a),Jg){i=0;do{if(Jg=!1,Ev=0,25<=i)throw Error(xt(301));i+=1,Qs=qs=null,t.updateQueue=null,s_.current=cJ,e=r(n,a)}while(Jg)}if(s_.current=z_,t=qs!==null&&qs.next!==null,of=0,Qs=qs=us=null,F_=!1,t)throw Error(xt(300));return e}function fP(){var e=Ev!==0;return Ev=0,e}function dl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qs===null?us.memoizedState=Qs=e:Qs=Qs.next=e,Qs}function fo(){if(qs===null){var e=us.alternate;e=e!==null?e.memoizedState:null}else e=qs.next;var t=Qs===null?us.memoizedState:Qs.next;if(t!==null)Qs=t,qs=e;else{if(e===null)throw Error(xt(310));qs=e,e={memoizedState:qs.memoizedState,baseState:qs.baseState,baseQueue:qs.baseQueue,queue:qs.queue,next:null},Qs===null?us.memoizedState=Qs=e:Qs=Qs.next=e}return Qs}function Cv(e,t){return typeof t=="function"?t(e):t}function yN(e){var t=fo(),r=t.queue;if(r===null)throw Error(xt(311));r.lastRenderedReducer=e;var n=qs,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=o=null,c=null,d=i;do{var f=d.lane;if((of&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var u={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=u,o=n):c=c.next=u,us.lanes|=f,lf|=f}d=d.next}while(d!==null&&d!==i);c===null?o=n:c.next=l,Go(n,t.memoizedState)||(ui=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,us.lanes|=i,lf|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function xN(e){var t=fo(),r=t.queue;if(r===null)throw Error(xt(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);Go(i,t.memoizedState)||(ui=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function k6(){}function E6(e,t){var r=us,n=fo(),a=t(),i=!Go(n.memoizedState,a);if(i&&(n.memoizedState=a,ui=!0),n=n.queue,hP(T6.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Qs!==null&&Qs.memoizedState.tag&1){if(r.flags|=2048,Pv(9,P6.bind(null,r,n,a,t),void 0,null),sa===null)throw Error(xt(349));of&30||C6(r,t,a)}return a}function C6(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=us.updateQueue,t===null?(t={lastEffect:null,stores:null},us.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function P6(e,t,r,n){t.value=r,t.getSnapshot=n,A6(t)&&R6(e)}function T6(e,t,r){return r(function(){A6(t)&&R6(e)})}function A6(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Go(e,r)}catch(n){return!0}}function R6(e){var t=Ac(e,1);t!==null&&Wo(t,e,1,-1)}function rO(e){var t=dl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cv,lastRenderedState:e},t.queue=e,e=e.dispatch=iJ.bind(null,us,e),[t.memoizedState,e]}function Pv(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=us.updateQueue,t===null?(t={lastEffect:null,stores:null},us.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function O6(){return fo().memoizedState}function a_(e,t,r,n){var a=dl();us.flags|=e,a.memoizedState=Pv(1|t,r,void 0,n===void 0?null:n)}function Db(e,t,r,n){var a=fo();n=n===void 0?null:n;var i=void 0;if(qs!==null){var o=qs.memoizedState;if(i=o.destroy,n!==null&&dP(n,o.deps)){a.memoizedState=Pv(t,r,i,n);return}}us.flags|=e,a.memoizedState=Pv(1|t,r,i,n)}function nO(e,t){return a_(8390656,8,e,t)}function hP(e,t){return Db(2048,8,e,t)}function M6(e,t){return Db(4,2,e,t)}function D6(e,t){return Db(4,4,e,t)}function I6(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function $6(e,t,r){return r=r!=null?r.concat([e]):null,Db(4,4,I6.bind(null,t,e),r)}function mP(){}function L6(e,t){var r=fo();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&dP(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function F6(e,t){var r=fo();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&dP(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function z6(e,t,r){return of&21?(Go(r,t)||(r=WL(),us.lanes|=r,lf|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ui=!0),e.memoizedState=r)}function sJ(e,t){var r=Mn;Mn=r!==0&&4>r?r:4,e(!0);var n=vN.transition;vN.transition={};try{e(!1),t()}finally{Mn=r,vN.transition=n}}function B6(){return fo().memoizedState}function aJ(e,t,r){var n=Md(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},U6(e))q6(t,r);else if(r=j6(e,t,r,n),r!==null){var a=Ga();Wo(r,e,n,a),V6(r,t,n)}}function iJ(e,t,r){var n=Md(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(U6(e))q6(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,Go(l,o)){var c=t.interleaved;c===null?(a.next=a,aP(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch(d){}finally{}r=j6(e,t,a,n),r!==null&&(a=Ga(),Wo(r,e,n,a),V6(r,t,n))}}function U6(e){var t=e.alternate;return e===us||t!==null&&t===us}function q6(e,t){Jg=F_=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function V6(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,WC(e,r)}}var z_={readContext:uo,useCallback:ba,useContext:ba,useEffect:ba,useImperativeHandle:ba,useInsertionEffect:ba,useLayoutEffect:ba,useMemo:ba,useReducer:ba,useRef:ba,useState:ba,useDebugValue:ba,useDeferredValue:ba,useTransition:ba,useMutableSource:ba,useSyncExternalStore:ba,useId:ba,unstable_isNewReconciler:!1},oJ={readContext:uo,useCallback:function(e,t){return dl().memoizedState=[e,t===void 0?null:t],e},useContext:uo,useEffect:nO,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,a_(4194308,4,I6.bind(null,t,e),r)},useLayoutEffect:function(e,t){return a_(4194308,4,e,t)},useInsertionEffect:function(e,t){return a_(4,2,e,t)},useMemo:function(e,t){var r=dl();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=dl();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=aJ.bind(null,us,e),[n.memoizedState,e]},useRef:function(e){var t=dl();return e={current:e},t.memoizedState=e},useState:rO,useDebugValue:mP,useDeferredValue:function(e){return dl().memoizedState=e},useTransition:function(){var e=rO(!1),t=e[0];return e=sJ.bind(null,e[1]),dl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=us,a=dl();if(ss){if(r===void 0)throw Error(xt(407));r=r()}else{if(r=t(),sa===null)throw Error(xt(349));of&30||C6(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,nO(T6.bind(null,n,i,e),[e]),n.flags|=2048,Pv(9,P6.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=dl(),t=sa.identifierPrefix;if(ss){var r=mc,n=hc;r=(n&~(1<<32-Vo(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ev++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=nJ++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},lJ={readContext:uo,useCallback:L6,useContext:uo,useEffect:hP,useImperativeHandle:$6,useInsertionEffect:M6,useLayoutEffect:D6,useMemo:F6,useReducer:yN,useRef:O6,useState:function(){return yN(Cv)},useDebugValue:mP,useDeferredValue:function(e){var t=fo();return z6(t,qs.memoizedState,e)},useTransition:function(){var e=yN(Cv)[0],t=fo().memoizedState;return[e,t]},useMutableSource:k6,useSyncExternalStore:E6,useId:B6,unstable_isNewReconciler:!1},cJ={readContext:uo,useCallback:L6,useContext:uo,useEffect:hP,useImperativeHandle:$6,useInsertionEffect:M6,useLayoutEffect:D6,useMemo:F6,useReducer:xN,useRef:O6,useState:function(){return xN(Cv)},useDebugValue:mP,useDeferredValue:function(e){var t=fo();return qs===null?t.memoizedState=e:z6(t,qs.memoizedState,e)},useTransition:function(){var e=xN(Cv)[0],t=fo().memoizedState;return[e,t]},useMutableSource:k6,useSyncExternalStore:E6,useId:B6,unstable_isNewReconciler:!1};function ko(e,t){if(e&&e.defaultProps){t=fs({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Pk(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:fs({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Ib={isMounted:function(e){return(e=e._reactInternals)?Ef(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ga(),a=Md(e),i=jc(n,a);i.payload=t,r!=null&&(i.callback=r),t=Rd(e,i,a),t!==null&&(Wo(t,e,a,n),n_(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ga(),a=Md(e),i=jc(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Rd(e,i,a),t!==null&&(Wo(t,e,a,n),n_(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ga(),n=Md(e),a=jc(r,n);a.tag=2,t!=null&&(a.callback=t),t=Rd(e,a,n),t!==null&&(Wo(t,e,n,r),n_(t,e,n))}};function sO(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!wv(r,n)||!wv(a,i):!0}function W6(e,t,r){var n=!1,a=zd,i=t.contextType;return typeof i=="object"&&i!==null?i=uo(i):(a=pi(t)?sf:Ma.current,n=t.contextTypes,i=(n=n!=null)?gm(e,a):zd),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ib,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function aO(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Ib.enqueueReplaceState(t,t.state,null)}function Tk(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},iP(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=uo(i):(i=pi(t)?sf:Ma.current,a.context=gm(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Pk(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Ib.enqueueReplaceState(a,a.state,null),$_(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function _m(e,t){try{var r="",n=t;do r+=$Z(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function _N(e,t,r){return{value:e,source:null,stack:r!=null?r:null,digest:t!=null?t:null}}function Ak(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var dJ=typeof WeakMap=="function"?WeakMap:Map;function H6(e,t,r){r=jc(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){U_||(U_=!0,Bk=n),Ak(e,t)},r}function G6(e,t,r){r=jc(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Ak(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Ak(e,t),typeof n!="function"&&(Od===null?Od=new Set([this]):Od.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function iO(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new dJ;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=NJ.bind(null,e,t,r),t.then(e,e))}function oO(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function lO(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=jc(-1,1),t.tag=2,Rd(r,t,1))),r.lanes|=1),e)}var uJ=Uc.ReactCurrentOwner,ui=!1;function Ba(e,t,r,n){t.child=e===null?b6(t,null,r,n):ym(t,e.child,r,n)}function cO(e,t,r,n,a){r=r.render;var i=t.ref;return Vh(t,a),n=uP(e,t,r,n,i,a),r=fP(),e!==null&&!ui?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Rc(e,t,a)):(ss&&r&&QC(t),t.flags|=1,Ba(e,t,n,a),t.child)}function dO(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!bP(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Y6(e,t,i,n,a)):(e=c_(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:wv,r(o,n)&&e.ref===t.ref)return Rc(e,t,a)}return t.flags|=1,e=Dd(i,n),e.ref=t.ref,e.return=t,t.child=e}function Y6(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(wv(i,n)&&e.ref===t.ref)if(ui=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(ui=!0);else return t.lanes=e.lanes,Rc(e,t,a)}return Rk(e,t,r,n,a)}function K6(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vn(Th,Ci),Ci|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Vn(Th,Ci),Ci|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Vn(Th,Ci),Ci|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Vn(Th,Ci),Ci|=n;return Ba(e,t,a,r),t.child}function Z6(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Rk(e,t,r,n,a){var i=pi(r)?sf:Ma.current;return i=gm(t,i),Vh(t,a),r=uP(e,t,r,n,i,a),n=fP(),e!==null&&!ui?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Rc(e,t,a)):(ss&&n&&QC(t),t.flags|=1,Ba(e,t,r,a),t.child)}function uO(e,t,r,n,a){if(pi(r)){var i=!0;R_(t)}else i=!1;if(Vh(t,a),t.stateNode===null)i_(e,t),W6(t,r,n),Tk(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=uo(d):(d=pi(r)?sf:Ma.current,d=gm(t,d));var f=r.getDerivedStateFromProps,u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==d)&&aO(t,o,n,d),dd=!1;var h=t.memoizedState;o.state=h,$_(t,n,o,a),c=t.memoizedState,l!==n||h!==c||mi.current||dd?(typeof f=="function"&&(Pk(t,r,f,n),c=t.memoizedState),(l=dd||sO(t,r,l,n,h,c,d))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,N6(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:ko(t.type,l),o.props=d,u=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=uo(c):(c=pi(r)?sf:Ma.current,c=gm(t,c));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==u||h!==c)&&aO(t,o,n,c),dd=!1,h=t.memoizedState,o.state=h,$_(t,n,o,a);var v=t.memoizedState;l!==u||h!==v||mi.current||dd?(typeof m=="function"&&(Pk(t,r,m,n),v=t.memoizedState),(d=dd||sO(t,r,d,n,h,v,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,v,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),o.props=n,o.state=v,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Ok(e,t,r,n,i,a)}function Ok(e,t,r,n,a,i){Z6(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&ZR(t,r,!1),Rc(e,t,i);n=t.stateNode,uJ.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=ym(t,e.child,null,i),t.child=ym(t,null,l,i)):Ba(e,t,l,i),t.memoizedState=n.state,a&&ZR(t,r,!0),t.child}function X6(e){var t=e.stateNode;t.pendingContext?KR(e,t.pendingContext,t.pendingContext!==t.context):t.context&&KR(e,t.context,!1),oP(e,t.containerInfo)}function fO(e,t,r,n,a){return vm(),tP(a),t.flags|=256,Ba(e,t,r,n),t.child}var Mk={dehydrated:null,treeContext:null,retryLane:0};function Dk(e){return{baseLanes:e,cachePool:null,transitions:null}}function J6(e,t,r){var n=t.pendingProps,a=ls.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Vn(ls,a&1),e===null)return Ek(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Fb(o,n,0,null),e=Xu(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Dk(r),t.memoizedState=Mk,e):pP(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return fJ(e,t,o,n,l,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Dd(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=Dd(l,i):(i=Xu(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?Dk(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Mk,n}return i=e.child,e=i.sibling,n=Dd(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function pP(e,t){return t=Fb({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function dx(e,t,r,n){return n!==null&&tP(n),ym(t,e.child,null,r),e=pP(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function fJ(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=_N(Error(xt(422))),dx(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Fb({mode:"visible",children:n.children},a,0,null),i=Xu(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&ym(t,e.child,null,o),t.child.memoizedState=Dk(o),t.memoizedState=Mk,i);if(!(t.mode&1))return dx(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(xt(419)),n=_N(i,n,void 0),dx(e,t,o,n)}if(l=(o&e.childLanes)!==0,ui||l){if(n=sa,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Ac(e,a),Wo(n,e,a,-1))}return wP(),n=_N(Error(xt(421))),dx(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=SJ.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Oi=Ad(a.nextSibling),Di=t,ss=!0,Mo=null,e!==null&&(Hi[Gi++]=hc,Hi[Gi++]=mc,Hi[Gi++]=af,hc=e.id,mc=e.overflow,af=t),t=pP(t,n.children),t.flags|=4096,t)}function hO(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ck(e.return,t,r)}function wN(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function Q6(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Ba(e,t,n.children,r),n=ls.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&hO(e,r,t);else if(e.tag===19)hO(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Vn(ls,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&L_(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),wN(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&L_(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}wN(t,!0,r,null,i);break;case"together":wN(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function i_(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Rc(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),lf|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(xt(153));if(t.child!==null){for(e=t.child,r=Dd(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Dd(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function hJ(e,t,r){switch(t.tag){case 3:X6(t),vm();break;case 5:S6(t);break;case 1:pi(t.type)&&R_(t);break;case 4:oP(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Vn(D_,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Vn(ls,ls.current&1),t.flags|=128,null):r&t.child.childLanes?J6(e,t,r):(Vn(ls,ls.current&1),e=Rc(e,t,r),e!==null?e.sibling:null);Vn(ls,ls.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Q6(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Vn(ls,ls.current),n)break;return null;case 22:case 23:return t.lanes=0,K6(e,t,r)}return Rc(e,t,r)}var eF,Ik,tF,rF;eF=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ik=function(){};tF=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Tu(Rl.current);var i=null;switch(r){case"input":a=sk(e,a),n=sk(e,n),i=[];break;case"select":a=fs({},a,{value:void 0}),n=fs({},n,{value:void 0}),i=[];break;case"textarea":a=ok(e,a),n=ok(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=T_)}ck(r,n);var o;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var l=a[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(mv.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(l=a!=null?a[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(mv.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Zn("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};rF=function(e,t,r,n){r!==n&&(t.flags|=4)};function ig(e,t){if(!ss)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ja(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function mJ(e,t,r){var n=t.pendingProps;switch(eP(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ja(t),null;case 1:return pi(t.type)&&A_(),ja(t),null;case 3:return n=t.stateNode,xm(),Qn(mi),Qn(Ma),cP(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(lx(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Mo!==null&&(Vk(Mo),Mo=null))),Ik(e,t),ja(t),null;case 5:lP(t);var a=Tu(kv.current);if(r=t.type,e!==null&&t.stateNode!=null)tF(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(xt(166));return ja(t),null}if(e=Tu(Rl.current),lx(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[xl]=t,n[Nv]=i,e=(t.mode&1)!==0,r){case"dialog":Zn("cancel",n),Zn("close",n);break;case"iframe":case"object":case"embed":Zn("load",n);break;case"video":case"audio":for(a=0;a<Lg.length;a++)Zn(Lg[a],n);break;case"source":Zn("error",n);break;case"img":case"image":case"link":Zn("error",n),Zn("load",n);break;case"details":Zn("toggle",n);break;case"input":bR(n,i),Zn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Zn("invalid",n);break;case"textarea":NR(n,i),Zn("invalid",n)}ck(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&ox(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&ox(n.textContent,l,e),a=["children",""+l]):mv.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Zn("scroll",n)}switch(r){case"input":Q0(n),jR(n,i,!0);break;case"textarea":Q0(n),SR(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=T_)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=TL(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[xl]=t,e[Nv]=n,eF(e,t,!1,!1),t.stateNode=e;e:{switch(o=dk(r,n),r){case"dialog":Zn("cancel",e),Zn("close",e),a=n;break;case"iframe":case"object":case"embed":Zn("load",e),a=n;break;case"video":case"audio":for(a=0;a<Lg.length;a++)Zn(Lg[a],e);a=n;break;case"source":Zn("error",e),a=n;break;case"img":case"image":case"link":Zn("error",e),Zn("load",e),a=n;break;case"details":Zn("toggle",e),a=n;break;case"input":bR(e,n),a=sk(e,n),Zn("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=fs({},n,{value:void 0}),Zn("invalid",e);break;case"textarea":NR(e,n),a=ok(e,n),Zn("invalid",e);break;default:a=n}ck(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?OL(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&AL(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&pv(e,c):typeof c=="number"&&pv(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(mv.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Zn("scroll",e):c!=null&&FC(e,i,c,o))}switch(r){case"input":Q0(e),jR(e,n,!1);break;case"textarea":Q0(e),SR(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Fd(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?zh(e,!!n.multiple,i,!1):n.defaultValue!=null&&zh(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=T_)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ja(t),null;case 6:if(e&&t.stateNode!=null)rF(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(xt(166));if(r=Tu(kv.current),Tu(Rl.current),lx(t)){if(n=t.stateNode,r=t.memoizedProps,n[xl]=t,(i=n.nodeValue!==r)&&(e=Di,e!==null))switch(e.tag){case 3:ox(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ox(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[xl]=t,t.stateNode=n}return ja(t),null;case 13:if(Qn(ls),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ss&&Oi!==null&&t.mode&1&&!(t.flags&128))_6(),vm(),t.flags|=98560,i=!1;else if(i=lx(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(xt(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(xt(317));i[xl]=t}else vm(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ja(t),i=!1}else Mo!==null&&(Vk(Mo),Mo=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ls.current&1?Ws===0&&(Ws=3):wP())),t.updateQueue!==null&&(t.flags|=4),ja(t),null);case 4:return xm(),Ik(e,t),e===null&&bv(t.stateNode.containerInfo),ja(t),null;case 10:return sP(t.type._context),ja(t),null;case 17:return pi(t.type)&&A_(),ja(t),null;case 19:if(Qn(ls),i=t.memoizedState,i===null)return ja(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)ig(i,!1);else{if(Ws!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=L_(e),o!==null){for(t.flags|=128,ig(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Vn(ls,ls.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ss()>wm&&(t.flags|=128,n=!0,ig(i,!1),t.lanes=4194304)}else{if(!n)if(e=L_(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ig(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ss)return ja(t),null}else 2*Ss()-i.renderingStartTime>wm&&r!==1073741824&&(t.flags|=128,n=!0,ig(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ss(),t.sibling=null,r=ls.current,Vn(ls,n?r&1|2:r&1),t):(ja(t),null);case 22:case 23:return _P(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ci&1073741824&&(ja(t),t.subtreeFlags&6&&(t.flags|=8192)):ja(t),null;case 24:return null;case 25:return null}throw Error(xt(156,t.tag))}function pJ(e,t){switch(eP(t),t.tag){case 1:return pi(t.type)&&A_(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return xm(),Qn(mi),Qn(Ma),cP(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return lP(t),null;case 13:if(Qn(ls),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(xt(340));vm()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Qn(ls),null;case 4:return xm(),null;case 10:return sP(t.type._context),null;case 22:case 23:return _P(),null;case 24:return null;default:return null}}var ux=!1,Ca=!1,gJ=typeof WeakSet=="function"?WeakSet:Set,Gt=null;function Ph(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ms(e,t,n)}else r.current=null}function $k(e,t,r){try{r()}catch(n){ms(e,t,n)}}var mO=!1;function vJ(e,t){if(_k=E_,e=o6(),JC(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch(N){r=null;break e}var o=0,l=-1,c=-1,d=0,f=0,u=e,h=null;t:for(;;){for(var m;u!==r||a!==0&&u.nodeType!==3||(l=o+a),u!==i||n!==0&&u.nodeType!==3||(c=o+n),u.nodeType===3&&(o+=u.nodeValue.length),(m=u.firstChild)!==null;)h=u,u=m;for(;;){if(u===e)break t;if(h===r&&++d===a&&(l=o),h===i&&++f===n&&(c=o),(m=u.nextSibling)!==null)break;u=h,h=u.parentNode}u=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(wk={focusedElem:e,selectionRange:r},E_=!1,Gt=t;Gt!==null;)if(t=Gt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Gt=e;else for(;Gt!==null;){t=Gt;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,x=v.memoizedState,_=t.stateNode,w=_.getSnapshotBeforeUpdate(t.elementType===t.type?g:ko(t.type,g),x);_.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xt(163))}}catch(N){ms(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,Gt=e;break}Gt=t.return}return v=mO,mO=!1,v}function Qg(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&$k(t,r,i)}a=a.next}while(a!==n)}}function $b(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Lk(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function nF(e){var t=e.alternate;t!==null&&(e.alternate=null,nF(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[xl],delete t[Nv],delete t[Nk],delete t[QX],delete t[eJ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sF(e){return e.tag===5||e.tag===3||e.tag===4}function pO(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||sF(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fk(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=T_));else if(n!==4&&(e=e.child,e!==null))for(Fk(e,t,r),e=e.sibling;e!==null;)Fk(e,t,r),e=e.sibling}function zk(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(zk(e,t,r),e=e.sibling;e!==null;)zk(e,t,r),e=e.sibling}var ua=null,To=!1;function ed(e,t,r){for(r=r.child;r!==null;)aF(e,t,r),r=r.sibling}function aF(e,t,r){if(Al&&typeof Al.onCommitFiberUnmount=="function")try{Al.onCommitFiberUnmount(Pb,r)}catch(l){}switch(r.tag){case 5:Ca||Ph(r,t);case 6:var n=ua,a=To;ua=null,ed(e,t,r),ua=n,To=a,ua!==null&&(To?(e=ua,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ua.removeChild(r.stateNode));break;case 18:ua!==null&&(To?(e=ua,r=r.stateNode,e.nodeType===8?mN(e.parentNode,r):e.nodeType===1&&mN(e,r),xv(e)):mN(ua,r.stateNode));break;case 4:n=ua,a=To,ua=r.stateNode.containerInfo,To=!0,ed(e,t,r),ua=n,To=a;break;case 0:case 11:case 14:case 15:if(!Ca&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&$k(r,t,o),a=a.next}while(a!==n)}ed(e,t,r);break;case 1:if(!Ca&&(Ph(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){ms(r,t,l)}ed(e,t,r);break;case 21:ed(e,t,r);break;case 22:r.mode&1?(Ca=(n=Ca)||r.memoizedState!==null,ed(e,t,r),Ca=n):ed(e,t,r);break;default:ed(e,t,r)}}function gO(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new gJ),t.forEach(function(n){var a=kJ.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function _o(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:ua=l.stateNode,To=!1;break e;case 3:ua=l.stateNode.containerInfo,To=!0;break e;case 4:ua=l.stateNode.containerInfo,To=!0;break e}l=l.return}if(ua===null)throw Error(xt(160));aF(i,o,a),ua=null,To=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){ms(a,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)iF(t,e),t=t.sibling}function iF(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(_o(t,e),cl(e),n&4){try{Qg(3,e,e.return),$b(3,e)}catch(g){ms(e,e.return,g)}try{Qg(5,e,e.return)}catch(g){ms(e,e.return,g)}}break;case 1:_o(t,e),cl(e),n&512&&r!==null&&Ph(r,r.return);break;case 5:if(_o(t,e),cl(e),n&512&&r!==null&&Ph(r,r.return),e.flags&32){var a=e.stateNode;try{pv(a,"")}catch(g){ms(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&CL(a,i),dk(l,o);var d=dk(l,i);for(o=0;o<c.length;o+=2){var f=c[o],u=c[o+1];f==="style"?OL(a,u):f==="dangerouslySetInnerHTML"?AL(a,u):f==="children"?pv(a,u):FC(a,f,u,d)}switch(l){case"input":ak(a,i);break;case"textarea":PL(a,i);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?zh(a,!!i.multiple,m,!1):h!==!!i.multiple&&(i.defaultValue!=null?zh(a,!!i.multiple,i.defaultValue,!0):zh(a,!!i.multiple,i.multiple?[]:"",!1))}a[Nv]=i}catch(g){ms(e,e.return,g)}}break;case 6:if(_o(t,e),cl(e),n&4){if(e.stateNode===null)throw Error(xt(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){ms(e,e.return,g)}}break;case 3:if(_o(t,e),cl(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{xv(t.containerInfo)}catch(g){ms(e,e.return,g)}break;case 4:_o(t,e),cl(e);break;case 13:_o(t,e),cl(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(yP=Ss())),n&4&&gO(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Ca=(d=Ca)||f,_o(t,e),Ca=d):_o(t,e),cl(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(Gt=e,f=e.child;f!==null;){for(u=Gt=f;Gt!==null;){switch(h=Gt,m=h.child,h.tag){case 0:case 11:case 14:case 15:Qg(4,h,h.return);break;case 1:Ph(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){ms(n,r,g)}}break;case 5:Ph(h,h.return);break;case 22:if(h.memoizedState!==null){yO(u);continue}}m!==null?(m.return=h,Gt=m):yO(u)}f=f.sibling}e:for(f=null,u=e;;){if(u.tag===5){if(f===null){f=u;try{a=u.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=u.stateNode,c=u.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=RL("display",o))}catch(g){ms(e,e.return,g)}}}else if(u.tag===6){if(f===null)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(g){ms(e,e.return,g)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;f===u&&(f=null),u=u.return}f===u&&(f=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:_o(t,e),cl(e),n&4&&gO(e);break;case 21:break;default:_o(t,e),cl(e)}}function cl(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(sF(r)){var n=r;break e}r=r.return}throw Error(xt(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(pv(a,""),n.flags&=-33);var i=pO(e);zk(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=pO(e);Fk(e,l,o);break;default:throw Error(xt(161))}}catch(c){ms(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function yJ(e,t,r){Gt=e,oF(e)}function oF(e,t,r){for(var n=(e.mode&1)!==0;Gt!==null;){var a=Gt,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||ux;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||Ca;l=ux;var d=Ca;if(ux=o,(Ca=c)&&!d)for(Gt=a;Gt!==null;)o=Gt,c=o.child,o.tag===22&&o.memoizedState!==null?xO(a):c!==null?(c.return=o,Gt=c):xO(a);for(;i!==null;)Gt=i,oF(i),i=i.sibling;Gt=a,ux=l,Ca=d}vO(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Gt=i):vO(e)}}function vO(e){for(;Gt!==null;){var t=Gt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ca||$b(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ca)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:ko(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&tO(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}tO(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var u=f.dehydrated;u!==null&&xv(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xt(163))}Ca||t.flags&512&&Lk(t)}catch(h){ms(t,t.return,h)}}if(t===e){Gt=null;break}if(r=t.sibling,r!==null){r.return=t.return,Gt=r;break}Gt=t.return}}function yO(e){for(;Gt!==null;){var t=Gt;if(t===e){Gt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Gt=r;break}Gt=t.return}}function xO(e){for(;Gt!==null;){var t=Gt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{$b(4,t)}catch(c){ms(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){ms(t,a,c)}}var i=t.return;try{Lk(t)}catch(c){ms(t,i,c)}break;case 5:var o=t.return;try{Lk(t)}catch(c){ms(t,o,c)}}}catch(c){ms(t,t.return,c)}if(t===e){Gt=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Gt=l;break}Gt=t.return}}var xJ=Math.ceil,B_=Uc.ReactCurrentDispatcher,gP=Uc.ReactCurrentOwner,so=Uc.ReactCurrentBatchConfig,_n=0,sa=null,Rs=null,ga=0,Ci=0,Th=Zd(0),Ws=0,Tv=null,lf=0,Lb=0,vP=0,ev=null,oi=null,yP=0,wm=1/0,lc=null,U_=!1,Bk=null,Od=null,fx=!1,jd=null,q_=0,tv=0,Uk=null,o_=-1,l_=0;function Ga(){return _n&6?Ss():o_!==-1?o_:o_=Ss()}function Md(e){return e.mode&1?_n&2&&ga!==0?ga&-ga:rJ.transition!==null?(l_===0&&(l_=WL()),l_):(e=Mn,e!==0||(e=window.event,e=e===void 0?16:JL(e.type)),e):1}function Wo(e,t,r,n){if(50<tv)throw tv=0,Uk=null,Error(xt(185));$y(e,r,n),(!(_n&2)||e!==sa)&&(e===sa&&(!(_n&2)&&(Lb|=r),Ws===4&&hd(e,ga)),gi(e,n),r===1&&_n===0&&!(t.mode&1)&&(wm=Ss()+500,Mb&&Xd()))}function gi(e,t){var r=e.callbackNode;rX(e,t);var n=k_(e,e===sa?ga:0);if(n===0)r!==null&&CR(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&CR(r),t===1)e.tag===0?tJ(_O.bind(null,e)):v6(_O.bind(null,e)),XX(function(){!(_n&6)&&Xd()}),r=null;else{switch(HL(n)){case 1:r=VC;break;case 4:r=qL;break;case 16:r=S_;break;case 536870912:r=VL;break;default:r=S_}r=pF(r,lF.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function lF(e,t){if(o_=-1,l_=0,_n&6)throw Error(xt(327));var r=e.callbackNode;if(Wh()&&e.callbackNode!==r)return null;var n=k_(e,e===sa?ga:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=V_(e,n);else{t=n;var a=_n;_n|=2;var i=dF();(sa!==e||ga!==t)&&(lc=null,wm=Ss()+500,Zu(e,t));do try{bJ();break}catch(l){cF(e,l)}while(!0);nP(),B_.current=i,_n=a,Rs!==null?t=0:(sa=null,ga=0,t=Ws)}if(t!==0){if(t===2&&(a=pk(e),a!==0&&(n=a,t=qk(e,a))),t===1)throw r=Tv,Zu(e,0),hd(e,n),gi(e,Ss()),r;if(t===6)hd(e,n);else{if(a=e.current.alternate,!(n&30)&&!_J(a)&&(t=V_(e,n),t===2&&(i=pk(e),i!==0&&(n=i,t=qk(e,i))),t===1))throw r=Tv,Zu(e,0),hd(e,n),gi(e,Ss()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(xt(345));case 2:yu(e,oi,lc);break;case 3:if(hd(e,n),(n&130023424)===n&&(t=yP+500-Ss(),10<t)){if(k_(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Ga(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=jk(yu.bind(null,e,oi,lc),t);break}yu(e,oi,lc);break;case 4:if(hd(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-Vo(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=Ss()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*xJ(n/1960))-n,10<n){e.timeoutHandle=jk(yu.bind(null,e,oi,lc),n);break}yu(e,oi,lc);break;case 5:yu(e,oi,lc);break;default:throw Error(xt(329))}}}return gi(e,Ss()),e.callbackNode===r?lF.bind(null,e):null}function qk(e,t){var r=ev;return e.current.memoizedState.isDehydrated&&(Zu(e,t).flags|=256),e=V_(e,t),e!==2&&(t=oi,oi=r,t!==null&&Vk(t)),e}function Vk(e){oi===null?oi=e:oi.push.apply(oi,e)}function _J(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Go(i(),a))return!1}catch(o){return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function hd(e,t){for(t&=~vP,t&=~Lb,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Vo(t),n=1<<r;e[r]=-1,t&=~n}}function _O(e){if(_n&6)throw Error(xt(327));Wh();var t=k_(e,0);if(!(t&1))return gi(e,Ss()),null;var r=V_(e,t);if(e.tag!==0&&r===2){var n=pk(e);n!==0&&(t=n,r=qk(e,n))}if(r===1)throw r=Tv,Zu(e,0),hd(e,t),gi(e,Ss()),r;if(r===6)throw Error(xt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,yu(e,oi,lc),gi(e,Ss()),null}function xP(e,t){var r=_n;_n|=1;try{return e(t)}finally{_n=r,_n===0&&(wm=Ss()+500,Mb&&Xd())}}function cf(e){jd!==null&&jd.tag===0&&!(_n&6)&&Wh();var t=_n;_n|=1;var r=so.transition,n=Mn;try{if(so.transition=null,Mn=1,e)return e()}finally{Mn=n,so.transition=r,_n=t,!(_n&6)&&Xd()}}function _P(){Ci=Th.current,Qn(Th)}function Zu(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,ZX(r)),Rs!==null)for(r=Rs.return;r!==null;){var n=r;switch(eP(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&A_();break;case 3:xm(),Qn(mi),Qn(Ma),cP();break;case 5:lP(n);break;case 4:xm();break;case 13:Qn(ls);break;case 19:Qn(ls);break;case 10:sP(n.type._context);break;case 22:case 23:_P()}r=r.return}if(sa=e,Rs=e=Dd(e.current,null),ga=Ci=t,Ws=0,Tv=null,vP=Lb=lf=0,oi=ev=null,Pu!==null){for(t=0;t<Pu.length;t++)if(r=Pu[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}Pu=null}return e}function cF(e,t){do{var r=Rs;try{if(nP(),s_.current=z_,F_){for(var n=us.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}F_=!1}if(of=0,Qs=qs=us=null,Jg=!1,Ev=0,gP.current=null,r===null||r.return===null){Ws=1,Tv=t,Rs=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=ga,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=l,u=f.tag;if(!(f.mode&1)&&(u===0||u===11||u===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=oO(o);if(m!==null){m.flags&=-257,lO(m,o,l,i,t),m.mode&1&&iO(i,d,t),t=m,c=d;var v=t.updateQueue;if(v===null){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}else{if(!(t&1)){iO(i,d,t),wP();break e}c=Error(xt(426))}}else if(ss&&l.mode&1){var x=oO(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),lO(x,o,l,i,t),tP(_m(c,l));break e}}i=c=_m(c,l),Ws!==4&&(Ws=2),ev===null?ev=[i]:ev.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var _=H6(i,c,t);eO(i,_);break e;case 1:l=c;var w=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Od===null||!Od.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var N=G6(i,l,t);eO(i,N);break e}}i=i.return}while(i!==null)}fF(r)}catch(S){t=S,Rs===r&&r!==null&&(Rs=r=r.return);continue}break}while(!0)}function dF(){var e=B_.current;return B_.current=z_,e===null?z_:e}function wP(){(Ws===0||Ws===3||Ws===2)&&(Ws=4),sa===null||!(lf&268435455)&&!(Lb&268435455)||hd(sa,ga)}function V_(e,t){var r=_n;_n|=2;var n=dF();(sa!==e||ga!==t)&&(lc=null,Zu(e,t));do try{wJ();break}catch(a){cF(e,a)}while(!0);if(nP(),_n=r,B_.current=n,Rs!==null)throw Error(xt(261));return sa=null,ga=0,Ws}function wJ(){for(;Rs!==null;)uF(Rs)}function bJ(){for(;Rs!==null&&!GZ();)uF(Rs)}function uF(e){var t=mF(e.alternate,e,Ci);e.memoizedProps=e.pendingProps,t===null?fF(e):Rs=t,gP.current=null}function fF(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=pJ(r,t),r!==null){r.flags&=32767,Rs=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ws=6,Rs=null;return}}else if(r=mJ(r,t,Ci),r!==null){Rs=r;return}if(t=t.sibling,t!==null){Rs=t;return}Rs=t=e}while(t!==null);Ws===0&&(Ws=5)}function yu(e,t,r){var n=Mn,a=so.transition;try{so.transition=null,Mn=1,jJ(e,t,r,n)}finally{so.transition=a,Mn=n}return null}function jJ(e,t,r,n){do Wh();while(jd!==null);if(_n&6)throw Error(xt(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(xt(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(nX(e,i),e===sa&&(Rs=sa=null,ga=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||fx||(fx=!0,pF(S_,function(){return Wh(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=so.transition,so.transition=null;var o=Mn;Mn=1;var l=_n;_n|=4,gP.current=null,vJ(e,r),iF(r,e),qX(wk),E_=!!_k,wk=_k=null,e.current=r,yJ(r),YZ(),_n=l,Mn=o,so.transition=i}else e.current=r;if(fx&&(fx=!1,jd=e,q_=a),i=e.pendingLanes,i===0&&(Od=null),XZ(r.stateNode),gi(e,Ss()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(U_)throw U_=!1,e=Bk,Bk=null,e;return q_&1&&e.tag!==0&&Wh(),i=e.pendingLanes,i&1?e===Uk?tv++:(tv=0,Uk=e):tv=0,Xd(),null}function Wh(){if(jd!==null){var e=HL(q_),t=so.transition,r=Mn;try{if(so.transition=null,Mn=16>e?16:e,jd===null)var n=!1;else{if(e=jd,jd=null,q_=0,_n&6)throw Error(xt(331));var a=_n;for(_n|=4,Gt=e.current;Gt!==null;){var i=Gt,o=i.child;if(Gt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Gt=d;Gt!==null;){var f=Gt;switch(f.tag){case 0:case 11:case 15:Qg(8,f,i)}var u=f.child;if(u!==null)u.return=f,Gt=u;else for(;Gt!==null;){f=Gt;var h=f.sibling,m=f.return;if(nF(f),f===d){Gt=null;break}if(h!==null){h.return=m,Gt=h;break}Gt=m}}}var v=i.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(g!==null)}}Gt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Gt=o;else e:for(;Gt!==null;){if(i=Gt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Qg(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,Gt=_;break e}Gt=i.return}}var w=e.current;for(Gt=w;Gt!==null;){o=Gt;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,Gt=b;else e:for(o=w;Gt!==null;){if(l=Gt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:$b(9,l)}}catch(S){ms(l,l.return,S)}if(l===o){Gt=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,Gt=N;break e}Gt=l.return}}if(_n=a,Xd(),Al&&typeof Al.onPostCommitFiberRoot=="function")try{Al.onPostCommitFiberRoot(Pb,e)}catch(S){}n=!0}return n}finally{Mn=r,so.transition=t}}return!1}function wO(e,t,r){t=_m(r,t),t=H6(e,t,1),e=Rd(e,t,1),t=Ga(),e!==null&&($y(e,1,t),gi(e,t))}function ms(e,t,r){if(e.tag===3)wO(e,e,r);else for(;t!==null;){if(t.tag===3){wO(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Od===null||!Od.has(n))){e=_m(r,e),e=G6(t,e,1),t=Rd(t,e,1),e=Ga(),t!==null&&($y(t,1,e),gi(t,e));break}}t=t.return}}function NJ(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ga(),e.pingedLanes|=e.suspendedLanes&r,sa===e&&(ga&r)===r&&(Ws===4||Ws===3&&(ga&130023424)===ga&&500>Ss()-yP?Zu(e,0):vP|=r),gi(e,t)}function hF(e,t){t===0&&(e.mode&1?(t=rx,rx<<=1,!(rx&130023424)&&(rx=4194304)):t=1);var r=Ga();e=Ac(e,t),e!==null&&($y(e,t,r),gi(e,r))}function SJ(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),hF(e,r)}function kJ(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(xt(314))}n!==null&&n.delete(t),hF(e,r)}var mF;mF=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||mi.current)ui=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ui=!1,hJ(e,t,r);ui=!!(e.flags&131072)}else ui=!1,ss&&t.flags&1048576&&y6(t,M_,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;i_(e,t),e=t.pendingProps;var a=gm(t,Ma.current);Vh(t,r),a=uP(null,t,n,e,a,r);var i=fP();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,pi(n)?(i=!0,R_(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,iP(t),a.updater=Ib,t.stateNode=a,a._reactInternals=t,Tk(t,n,e,r),t=Ok(null,t,n,!0,i,r)):(t.tag=0,ss&&i&&QC(t),Ba(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(i_(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=CJ(n),e=ko(n,e),a){case 0:t=Rk(null,t,n,e,r);break e;case 1:t=uO(null,t,n,e,r);break e;case 11:t=cO(null,t,n,e,r);break e;case 14:t=dO(null,t,n,ko(n.type,e),r);break e}throw Error(xt(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ko(n,a),Rk(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ko(n,a),uO(e,t,n,a,r);case 3:e:{if(X6(t),e===null)throw Error(xt(387));n=t.pendingProps,i=t.memoizedState,a=i.element,N6(e,t),$_(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=_m(Error(xt(423)),t),t=fO(e,t,n,r,a);break e}else if(n!==a){a=_m(Error(xt(424)),t),t=fO(e,t,n,r,a);break e}else for(Oi=Ad(t.stateNode.containerInfo.firstChild),Di=t,ss=!0,Mo=null,r=b6(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(vm(),n===a){t=Rc(e,t,r);break e}Ba(e,t,n,r)}t=t.child}return t;case 5:return S6(t),e===null&&Ek(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,bk(n,a)?o=null:i!==null&&bk(n,i)&&(t.flags|=32),Z6(e,t),Ba(e,t,o,r),t.child;case 6:return e===null&&Ek(t),null;case 13:return J6(e,t,r);case 4:return oP(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ym(t,null,n,r):Ba(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ko(n,a),cO(e,t,n,a,r);case 7:return Ba(e,t,t.pendingProps,r),t.child;case 8:return Ba(e,t,t.pendingProps.children,r),t.child;case 12:return Ba(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,Vn(D_,n._currentValue),n._currentValue=o,i!==null)if(Go(i.value,o)){if(i.children===a.children&&!mi.current){t=Rc(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=jc(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Ck(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(xt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Ck(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ba(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Vh(t,r),a=uo(a),n=n(a),t.flags|=1,Ba(e,t,n,r),t.child;case 14:return n=t.type,a=ko(n,t.pendingProps),a=ko(n.type,a),dO(e,t,n,a,r);case 15:return Y6(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ko(n,a),i_(e,t),t.tag=1,pi(n)?(e=!0,R_(t)):e=!1,Vh(t,r),W6(t,n,a),Tk(t,n,a,r),Ok(null,t,n,!0,e,r);case 19:return Q6(e,t,r);case 22:return K6(e,t,r)}throw Error(xt(156,t.tag))};function pF(e,t){return UL(e,t)}function EJ(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qi(e,t,r,n){return new EJ(e,t,r,n)}function bP(e){return e=e.prototype,!(!e||!e.isReactComponent)}function CJ(e){if(typeof e=="function")return bP(e)?1:0;if(e!=null){if(e=e.$$typeof,e===BC)return 11;if(e===UC)return 14}return 2}function Dd(e,t){var r=e.alternate;return r===null?(r=Qi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function c_(e,t,r,n,a,i){var o=2;if(n=e,typeof e=="function")bP(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case _h:return Xu(r.children,a,i,t);case zC:o=8,a|=8;break;case ek:return e=Qi(12,r,t,a|2),e.elementType=ek,e.lanes=i,e;case tk:return e=Qi(13,r,t,a),e.elementType=tk,e.lanes=i,e;case rk:return e=Qi(19,r,t,a),e.elementType=rk,e.lanes=i,e;case SL:return Fb(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case jL:o=10;break e;case NL:o=9;break e;case BC:o=11;break e;case UC:o=14;break e;case cd:o=16,n=null;break e}throw Error(xt(130,e==null?e:typeof e,""))}return t=Qi(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Xu(e,t,r,n){return e=Qi(7,e,n,t),e.lanes=r,e}function Fb(e,t,r,n){return e=Qi(22,e,n,t),e.elementType=SL,e.lanes=r,e.stateNode={isHidden:!1},e}function bN(e,t,r){return e=Qi(6,e,null,t),e.lanes=r,e}function jN(e,t,r){return t=Qi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function PJ(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nN(0),this.expirationTimes=nN(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nN(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function jP(e,t,r,n,a,i,o,l,c){return e=new PJ(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Qi(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},iP(i),e}function TJ(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xh,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function gF(e){if(!e)return zd;e=e._reactInternals;e:{if(Ef(e)!==e||e.tag!==1)throw Error(xt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(pi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(xt(171))}if(e.tag===1){var r=e.type;if(pi(r))return g6(e,r,t)}return t}function vF(e,t,r,n,a,i,o,l,c){return e=jP(r,n,!0,e,a,i,o,l,c),e.context=gF(null),r=e.current,n=Ga(),a=Md(r),i=jc(n,a),i.callback=t!=null?t:null,Rd(r,i,a),e.current.lanes=a,$y(e,a,n),gi(e,n),e}function zb(e,t,r,n){var a=t.current,i=Ga(),o=Md(a);return r=gF(r),t.context===null?t.context=r:t.pendingContext=r,t=jc(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Rd(a,t,o),e!==null&&(Wo(e,a,o,i),n_(e,a,o)),o}function W_(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function bO(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function NP(e,t){bO(e,t),(e=e.alternate)&&bO(e,t)}function AJ(){return null}var yF=typeof reportError=="function"?reportError:function(e){console.error(e)};function SP(e){this._internalRoot=e}Bb.prototype.render=SP.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(xt(409));zb(e,t,null,null)};Bb.prototype.unmount=SP.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;cf(function(){zb(null,e,null,null)}),t[Tc]=null}};function Bb(e){this._internalRoot=e}Bb.prototype.unstable_scheduleHydration=function(e){if(e){var t=KL();e={blockedOn:null,target:e,priority:t};for(var r=0;r<fd.length&&t!==0&&t<fd[r].priority;r++);fd.splice(r,0,e),r===0&&XL(e)}};function kP(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ub(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function jO(){}function RJ(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var d=W_(o);i.call(d)}}var o=vF(t,n,e,0,null,!1,!1,"",jO);return e._reactRootContainer=o,e[Tc]=o.current,bv(e.nodeType===8?e.parentNode:e),cf(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var d=W_(c);l.call(d)}}var c=jP(e,0,!1,null,null,!1,!1,"",jO);return e._reactRootContainer=c,e[Tc]=c.current,bv(e.nodeType===8?e.parentNode:e),cf(function(){zb(t,c,r,n)}),c}function qb(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var c=W_(o);l.call(c)}}zb(t,o,e,a)}else o=RJ(r,t,e,a,n);return W_(o)}GL=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=$g(t.pendingLanes);r!==0&&(WC(t,r|1),gi(t,Ss()),!(_n&6)&&(wm=Ss()+500,Xd()))}break;case 13:cf(function(){var n=Ac(e,1);if(n!==null){var a=Ga();Wo(n,e,1,a)}}),NP(e,1)}};HC=function(e){if(e.tag===13){var t=Ac(e,134217728);if(t!==null){var r=Ga();Wo(t,e,134217728,r)}NP(e,134217728)}};YL=function(e){if(e.tag===13){var t=Md(e),r=Ac(e,t);if(r!==null){var n=Ga();Wo(r,e,t,n)}NP(e,t)}};KL=function(){return Mn};ZL=function(e,t){var r=Mn;try{return Mn=e,t()}finally{Mn=r}};fk=function(e,t,r){switch(t){case"input":if(ak(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Ob(n);if(!a)throw Error(xt(90));EL(n),ak(n,a)}}}break;case"textarea":PL(e,r);break;case"select":t=r.value,t!=null&&zh(e,!!r.multiple,t,!1)}};IL=xP;$L=cf;var OJ={usingClientEntryPoint:!1,Events:[Fy,Nh,Ob,ML,DL,xP]},og={findFiberByHostInstance:Cu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},MJ={bundleType:og.bundleType,version:og.version,rendererPackageName:og.rendererPackageName,rendererConfig:og.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Uc.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=zL(e),e===null?null:e.stateNode},findFiberByHostInstance:og.findFiberByHostInstance||AJ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"){var hx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hx.isDisabled&&hx.supportsFiber)try{Pb=hx.inject(MJ),Al=hx}catch(e){}}Li.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OJ;Li.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kP(t))throw Error(xt(200));return TJ(e,t,null,r)};Li.createRoot=function(e,t){if(!kP(e))throw Error(xt(299));var r=!1,n="",a=yF;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=jP(e,1,!1,null,null,r,!1,n,a),e[Tc]=t.current,bv(e.nodeType===8?e.parentNode:e),new SP(t)};Li.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(xt(188)):(e=Object.keys(e).join(","),Error(xt(268,e)));return e=zL(t),e=e===null?null:e.stateNode,e};Li.flushSync=function(e){return cf(e)};Li.hydrate=function(e,t,r){if(!Ub(t))throw Error(xt(200));return qb(null,e,t,!0,r)};Li.hydrateRoot=function(e,t,r){if(!kP(e))throw Error(xt(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=yF;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=vF(t,null,e,1,r!=null?r:null,a,!1,i,o),e[Tc]=t.current,bv(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Bb(t)};Li.render=function(e,t,r){if(!Ub(t))throw Error(xt(200));return qb(null,e,t,!1,r)};Li.unmountComponentAtNode=function(e){if(!Ub(e))throw Error(xt(40));return e._reactRootContainer?(cf(function(){qb(null,null,e,!1,function(){e._reactRootContainer=null,e[Tc]=null})}),!0):!1};Li.unstable_batchedUpdates=xP;Li.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Ub(r))throw Error(xt(200));if(e==null||e._reactInternals===void 0)throw Error(xt(38));return qb(e,t,r,!1,n)};Li.version="18.3.1-next-f1338f8080-20240426";function xF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xF)}catch(e){console.error(e)}}xF(),xL.exports=Li;var ao=xL.exports;const Hh=wn(ao);var _F,NO=ao;_F=NO.createRoot,NO.hydrateRoot;const DJ=1,IJ=1e6;let NN=0;function $J(){return NN=(NN+1)%Number.MAX_SAFE_INTEGER,NN.toString()}const SN=new Map,SO=e=>{if(SN.has(e))return;const t=setTimeout(()=>{SN.delete(e),rv({type:"REMOVE_TOAST",toastId:e})},IJ);SN.set(e,t)},LJ=(e,t)=>{switch(t.type){case"ADD_TOAST":return V(D({},e),{toasts:[t.toast,...e.toasts].slice(0,DJ)});case"UPDATE_TOAST":return V(D({},e),{toasts:e.toasts.map(r=>r.id===t.toast.id?D(D({},r),t.toast):r)});case"DISMISS_TOAST":{const{toastId:r}=t;return r?SO(r):e.toasts.forEach(n=>{SO(n.id)}),V(D({},e),{toasts:e.toasts.map(n=>n.id===r||r===void 0?V(D({},n),{open:!1}):n)})}case"REMOVE_TOAST":return t.toastId===void 0?V(D({},e),{toasts:[]}):V(D({},e),{toasts:e.toasts.filter(r=>r.id!==t.toastId)})}},d_=[];let u_={toasts:[]};function rv(e){u_=LJ(u_,e),d_.forEach(t=>{t(u_)})}function FJ(t){var e=ge(t,[]);const r=$J(),n=i=>rv({type:"UPDATE_TOAST",toast:V(D({},i),{id:r})}),a=()=>rv({type:"DISMISS_TOAST",toastId:r});return rv({type:"ADD_TOAST",toast:V(D({},e),{id:r,open:!0,onOpenChange:i=>{i||a()}})}),{id:r,dismiss:a,update:n}}function Er(){const[e,t]=y.useState(u_);return y.useEffect(()=>(d_.push(t),()=>{const r=d_.indexOf(t);r>-1&&d_.splice(r,1)}),[e]),V(D({},e),{toast:FJ,dismiss:r=>rv({type:"DISMISS_TOAST",toastId:r})})}function mt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function kO(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Oc(...e){return t=>{let r=!1;const n=e.map(a=>{const i=kO(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():kO(e[a],null)}}}}function mr(...e){return y.useCallback(Oc(...e),e)}function zJ(e,t){const r=y.createContext(t),n=i=>{const d=i,{children:o}=d,l=ge(d,["children"]),c=y.useMemo(()=>l,Object.values(l));return s.jsx(r.Provider,{value:c,children:o})};n.displayName=e+"Provider";function a(i){const o=y.useContext(r);if(o)return o;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[n,a]}function $s(e,t=[]){let r=[];function n(i,o){const l=y.createContext(o),c=r.length;r=[...r,o];const d=u=>{var w;const _=u,{scope:h,children:m}=_,v=ge(_,["scope","children"]),g=((w=h==null?void 0:h[e])==null?void 0:w[c])||l,x=y.useMemo(()=>v,Object.values(v));return s.jsx(g.Provider,{value:x,children:m})};d.displayName=i+"Provider";function f(u,h){var g;const m=((g=h==null?void 0:h[e])==null?void 0:g[c])||l,v=y.useContext(m);if(v)return v;if(o!==void 0)return o;throw new Error(`\`${u}\` must be used within \`${i}\``)}return[d,f]}const a=()=>{const i=r.map(o=>y.createContext(o));return function(l){const c=(l==null?void 0:l[e])||i;return y.useMemo(()=>({[`__scope${e}`]:V(D({},l),{[e]:c})}),[l,c])}};return a.scopeName=e,[n,BJ(a,...t)]}function BJ(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:d})=>{const u=c(i)[`__scope${d}`];return D(D({},l),u)},{});return y.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function Bd(e){const t=qJ(e),r=y.forwardRef((n,a)=>{const d=n,{children:i}=d,o=ge(d,["children"]),l=y.Children.toArray(i),c=l.find(VJ);if(c){const f=c.props.children,u=l.map(h=>h===c?y.Children.count(f)>1?y.Children.only(null):y.isValidElement(f)?f.props.children:null:h);return s.jsx(t,V(D({},o),{ref:a,children:y.isValidElement(f)?y.cloneElement(f,void 0,u):null}))}return s.jsx(t,V(D({},o),{ref:a,children:i}))});return r.displayName=`${e}.Slot`,r}var UJ=Bd("Slot");function qJ(e){const t=y.forwardRef((r,n)=>{const o=r,{children:a}=o,i=ge(o,["children"]);if(y.isValidElement(a)){const l=HJ(a),c=WJ(i,a.props);return a.type!==y.Fragment&&(c.ref=n?Oc(n,l):l),y.cloneElement(a,c)}return y.Children.count(a)>1?y.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var wF=Symbol("radix.slottable");function bF(e){const t=({children:r})=>s.jsx(s.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=wF,t}function VJ(e){return y.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===wF}function WJ(e,t){const r=D({},t);for(const n in t){const a=e[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{const c=i(...l);return a(...l),c}:a&&(r[n]=a):n==="style"?r[n]=D(D({},a),i):n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return D(D({},e),r)}function HJ(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function fp(e){const t=e+"CollectionProvider",[r,n]=$s(t),[a,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=g=>{const{scope:x,children:_}=g,w=te.useRef(null),b=te.useRef(new Map).current;return s.jsx(a,{scope:x,itemMap:b,collectionRef:w,children:_})};o.displayName=t;const l=e+"CollectionSlot",c=Bd(l),d=te.forwardRef((g,x)=>{const{scope:_,children:w}=g,b=i(l,_),N=mr(x,b.collectionRef);return s.jsx(c,{ref:N,children:w})});d.displayName=l;const f=e+"CollectionItemSlot",u="data-radix-collection-item",h=Bd(f),m=te.forwardRef((g,x)=>{const C=g,{scope:_,children:w}=C,b=ge(C,["scope","children"]),N=te.useRef(null),S=mr(x,N),k=i(f,_);return te.useEffect(()=>(k.itemMap.set(N,D({ref:N},b)),()=>void k.itemMap.delete(N))),s.jsx(h,{[u]:"",ref:S,children:w})});m.displayName=f;function v(g){const x=i(e+"CollectionConsumer",g);return te.useCallback(()=>{const w=x.collectionRef.current;if(!w)return[];const b=Array.from(w.querySelectorAll(`[${u}]`));return Array.from(x.itemMap.values()).sort((k,C)=>b.indexOf(k.ref.current)-b.indexOf(C.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:o,Slot:d,ItemSlot:m},v,n]}var GJ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Pt=GJ.reduce((e,t)=>{const r=Bd(`Primitive.${t}`),n=y.forwardRef((a,i)=>{const d=a,{asChild:o}=d,l=ge(d,["asChild"]),c=o?r:t;return typeof window!="undefined"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(c,V(D({},l),{ref:i}))});return n.displayName=`Primitive.${t}`,V(D({},e),{[t]:n})},{});function EP(e,t){e&&ao.flushSync(()=>e.dispatchEvent(t))}function ys(e){const t=y.useRef(e);return y.useEffect(()=>{t.current=e}),y.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function YJ(e,t=globalThis==null?void 0:globalThis.document){const r=ys(e);y.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var KJ="DismissableLayer",Wk="dismissableLayer.update",ZJ="dismissableLayer.pointerDownOutside",XJ="dismissableLayer.focusOutside",EO,jF=y.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Cf=y.forwardRef((e,t)=>{var A;const C=e,{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:l}=C,c=ge(C,["disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss"]),d=y.useContext(jF),[f,u]=y.useState(null),h=(A=f==null?void 0:f.ownerDocument)!=null?A:globalThis==null?void 0:globalThis.document,[,m]=y.useState({}),v=mr(t,R=>u(R)),g=Array.from(d.layers),[x]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),_=g.indexOf(x),w=f?g.indexOf(f):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,N=w>=_,S=QJ(R=>{const I=R.target,O=[...d.branches].some(z=>z.contains(I));!N||O||(a==null||a(R),o==null||o(R),R.defaultPrevented||l==null||l())},h),k=eQ(R=>{const I=R.target;[...d.branches].some(z=>z.contains(I))||(i==null||i(R),o==null||o(R),R.defaultPrevented||l==null||l())},h);return YJ(R=>{w===d.layers.size-1&&(n==null||n(R),!R.defaultPrevented&&l&&(R.preventDefault(),l()))},h),y.useEffect(()=>{if(f)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(EO=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(f)),d.layers.add(f),CO(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=EO)}},[f,h,r,d]),y.useEffect(()=>()=>{f&&(d.layers.delete(f),d.layersWithOutsidePointerEventsDisabled.delete(f),CO())},[f,d]),y.useEffect(()=>{const R=()=>m({});return document.addEventListener(Wk,R),()=>document.removeEventListener(Wk,R)},[]),s.jsx(Pt.div,V(D({},c),{ref:v,style:D({pointerEvents:b?N?"auto":"none":void 0},e.style),onFocusCapture:mt(e.onFocusCapture,k.onFocusCapture),onBlurCapture:mt(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:mt(e.onPointerDownCapture,S.onPointerDownCapture)}))});Cf.displayName=KJ;var JJ="DismissableLayerBranch",NF=y.forwardRef((e,t)=>{const r=y.useContext(jF),n=y.useRef(null),a=mr(t,n);return y.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),s.jsx(Pt.div,V(D({},e),{ref:a}))});NF.displayName=JJ;function QJ(e,t=globalThis==null?void 0:globalThis.document){const r=ys(e),n=y.useRef(!1),a=y.useRef(()=>{});return y.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){SF(ZJ,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function eQ(e,t=globalThis==null?void 0:globalThis.document){const r=ys(e),n=y.useRef(!1);return y.useEffect(()=>{const a=i=>{i.target&&!n.current&&SF(XJ,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function CO(){const e=new CustomEvent(Wk);document.dispatchEvent(e)}function SF(e,t,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?EP(a,i):a.dispatchEvent(i)}var tQ=Cf,rQ=NF,xs=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},nQ="Portal",hp=y.forwardRef((e,t)=>{var c;const l=e,{container:r}=l,n=ge(l,["container"]),[a,i]=y.useState(!1);xs(()=>i(!0),[]);const o=r||a&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return o?Hh.createPortal(s.jsx(Pt.div,V(D({},n),{ref:t})),o):null});hp.displayName=nQ;function sQ(e,t){return y.useReducer((r,n)=>{const a=t[r][n];return a!=null?a:r},e)}var Ks=e=>{const{present:t,children:r}=e,n=aQ(t),a=typeof r=="function"?r({present:n.isPresent}):y.Children.only(r),i=mr(n.ref,iQ(a));return typeof r=="function"||n.isPresent?y.cloneElement(a,{ref:i}):null};Ks.displayName="Presence";function aQ(e){const[t,r]=y.useState(),n=y.useRef(null),a=y.useRef(e),i=y.useRef("none"),o=e?"mounted":"unmounted",[l,c]=sQ(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const d=mx(n.current);i.current=l==="mounted"?d:"none"},[l]),xs(()=>{const d=n.current,f=a.current;if(f!==e){const h=i.current,m=mx(d);e?c("MOUNT"):m==="none"||(d==null?void 0:d.display)==="none"?c("UNMOUNT"):c(f&&h!==m?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),xs(()=>{var d;if(t){let f;const u=(d=t.ownerDocument.defaultView)!=null?d:window,h=v=>{const x=mx(n.current).includes(v.animationName);if(v.target===t&&x&&(c("ANIMATION_END"),!a.current)){const _=t.style.animationFillMode;t.style.animationFillMode="forwards",f=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=_)})}},m=v=>{v.target===t&&(i.current=mx(n.current))};return t.addEventListener("animationstart",m),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{u.clearTimeout(f),t.removeEventListener("animationstart",m),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:y.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function mx(e){return(e==null?void 0:e.animationName)||"none"}function iQ(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var oQ=IC[" useInsertionEffect ".trim().toString()]||xs;function Ya({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,i,o]=lQ({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:a;{const f=y.useRef(e!==void 0);y.useEffect(()=>{const u=f.current;u!==l&&console.warn(`${n} is changing from ${u?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=l},[l,n])}const d=y.useCallback(f=>{var u;if(l){const h=cQ(f)?f(e):f;h!==e&&((u=o.current)==null||u.call(o,h))}else i(f)},[l,e,i,o]);return[c,d]}function lQ({defaultProp:e,onChange:t}){const[r,n]=y.useState(e),a=y.useRef(r),i=y.useRef(t);return oQ(()=>{i.current=t},[t]),y.useEffect(()=>{var o;a.current!==r&&((o=i.current)==null||o.call(i,r),a.current=r)},[r,a]),[r,n,i]}function cQ(e){return typeof e=="function"}var kF=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),dQ="VisuallyHidden",Vb=y.forwardRef((e,t)=>s.jsx(Pt.span,V(D({},e),{ref:t,style:D(D({},kF),e.style)})));Vb.displayName=dQ;var uQ=Vb,CP="ToastProvider",[PP,fQ,hQ]=fp("Toast"),[EF,UBe]=$s("Toast",[hQ]),[mQ,Wb]=EF(CP),CF=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:o}=e,[l,c]=y.useState(null),[d,f]=y.useState(0),u=y.useRef(!1),h=y.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${CP}\`. Expected non-empty \`string\`.`),s.jsx(PP.Provider,{scope:t,children:s.jsx(mQ,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:i,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:y.useCallback(()=>f(m=>m+1),[]),onToastRemove:y.useCallback(()=>f(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:u,isClosePausedRef:h,children:o})})};CF.displayName=CP;var PF="ToastViewport",pQ=["F8"],Hk="toast.viewportPause",Gk="toast.viewportResume",TF=y.forwardRef((e,t)=>{const x=e,{__scopeToast:r,hotkey:n=pQ,label:a="Notifications ({hotkey})"}=x,i=ge(x,["__scopeToast","hotkey","label"]),o=Wb(PF,r),l=fQ(r),c=y.useRef(null),d=y.useRef(null),f=y.useRef(null),u=y.useRef(null),h=mr(t,u,o.onViewportChange),m=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=o.toastCount>0;y.useEffect(()=>{const _=w=>{var N;n.length!==0&&n.every(S=>w[S]||w.code===S)&&((N=u.current)==null||N.focus())};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[n]),y.useEffect(()=>{const _=c.current,w=u.current;if(v&&_&&w){const b=()=>{if(!o.isClosePausedRef.current){const C=new CustomEvent(Hk);w.dispatchEvent(C),o.isClosePausedRef.current=!0}},N=()=>{if(o.isClosePausedRef.current){const C=new CustomEvent(Gk);w.dispatchEvent(C),o.isClosePausedRef.current=!1}},S=C=>{!_.contains(C.relatedTarget)&&N()},k=()=>{_.contains(document.activeElement)||N()};return _.addEventListener("focusin",b),_.addEventListener("focusout",S),_.addEventListener("pointermove",b),_.addEventListener("pointerleave",k),window.addEventListener("blur",b),window.addEventListener("focus",N),()=>{_.removeEventListener("focusin",b),_.removeEventListener("focusout",S),_.removeEventListener("pointermove",b),_.removeEventListener("pointerleave",k),window.removeEventListener("blur",b),window.removeEventListener("focus",N)}}},[v,o.isClosePausedRef]);const g=y.useCallback(({tabbingDirection:_})=>{const b=l().map(N=>{const S=N.ref.current,k=[S,...CQ(S)];return _==="forwards"?k:k.reverse()});return(_==="forwards"?b.reverse():b).flat()},[l]);return y.useEffect(()=>{const _=u.current;if(_){const w=b=>{var k,C,A;const N=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!N){const R=document.activeElement,I=b.shiftKey;if(b.target===_&&I){(k=d.current)==null||k.focus();return}const M=g({tabbingDirection:I?"backwards":"forwards"}),B=M.findIndex(F=>F===R);kN(M.slice(B+1))?b.preventDefault():I?(C=d.current)==null||C.focus():(A=f.current)==null||A.focus()}};return _.addEventListener("keydown",w),()=>_.removeEventListener("keydown",w)}},[l,g]),s.jsxs(rQ,{ref:c,role:"region","aria-label":a.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&s.jsx(Yk,{ref:d,onFocusFromOutsideViewport:()=>{const _=g({tabbingDirection:"forwards"});kN(_)}}),s.jsx(PP.Slot,{scope:r,children:s.jsx(Pt.ol,V(D({tabIndex:-1},i),{ref:h}))}),v&&s.jsx(Yk,{ref:f,onFocusFromOutsideViewport:()=>{const _=g({tabbingDirection:"backwards"});kN(_)}})]})});TF.displayName=PF;var AF="ToastFocusProxy",Yk=y.forwardRef((e,t)=>{const o=e,{__scopeToast:r,onFocusFromOutsideViewport:n}=o,a=ge(o,["__scopeToast","onFocusFromOutsideViewport"]),i=Wb(AF,r);return s.jsx(Vb,V(D({"aria-hidden":!0,tabIndex:0},a),{ref:t,style:{position:"fixed"},onFocus:l=>{var f;const c=l.relatedTarget;!((f=i.viewport)!=null&&f.contains(c))&&n()}}))});Yk.displayName=AF;var By="Toast",gQ="toast.swipeStart",vQ="toast.swipeMove",yQ="toast.swipeCancel",xQ="toast.swipeEnd",RF=y.forwardRef((e,t)=>{const d=e,{forceMount:r,open:n,defaultOpen:a,onOpenChange:i}=d,o=ge(d,["forceMount","open","defaultOpen","onOpenChange"]),[l,c]=Ya({prop:n,defaultProp:a!=null?a:!0,onChange:i,caller:By});return s.jsx(Ks,{present:r||l,children:s.jsx(bQ,V(D({open:l},o),{ref:t,onClose:()=>c(!1),onPause:ys(e.onPause),onResume:ys(e.onResume),onSwipeStart:mt(e.onSwipeStart,f=>{f.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:mt(e.onSwipeMove,f=>{const{x:u,y:h}=f.detail.delta;f.currentTarget.setAttribute("data-swipe","move"),f.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),f.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:mt(e.onSwipeCancel,f=>{f.currentTarget.setAttribute("data-swipe","cancel"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),f.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:mt(e.onSwipeEnd,f=>{const{x:u,y:h}=f.detail.delta;f.currentTarget.setAttribute("data-swipe","end"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),f.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),f.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})}))})});RF.displayName=By;var[_Q,wQ]=EF(By,{onClose(){}}),bQ=y.forwardRef((e,t)=>{const B=e,{__scopeToast:r,type:n="foreground",duration:a,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:f,onSwipeMove:u,onSwipeCancel:h,onSwipeEnd:m}=B,v=ge(B,["__scopeToast","type","duration","open","onClose","onEscapeKeyDown","onPause","onResume","onSwipeStart","onSwipeMove","onSwipeCancel","onSwipeEnd"]),g=Wb(By,r),[x,_]=y.useState(null),w=mr(t,F=>_(F)),b=y.useRef(null),N=y.useRef(null),S=a||g.duration,k=y.useRef(0),C=y.useRef(S),A=y.useRef(0),{onToastAdd:R,onToastRemove:I}=g,O=ys(()=>{var U;(x==null?void 0:x.contains(document.activeElement))&&((U=g.viewport)==null||U.focus()),o()}),z=y.useCallback(F=>{!F||F===1/0||(window.clearTimeout(A.current),k.current=new Date().getTime(),A.current=window.setTimeout(O,F))},[O]);y.useEffect(()=>{const F=g.viewport;if(F){const U=()=>{z(C.current),d==null||d()},H=()=>{const q=new Date().getTime()-k.current;C.current=C.current-q,window.clearTimeout(A.current),c==null||c()};return F.addEventListener(Hk,H),F.addEventListener(Gk,U),()=>{F.removeEventListener(Hk,H),F.removeEventListener(Gk,U)}}},[g.viewport,S,c,d,z]),y.useEffect(()=>{i&&!g.isClosePausedRef.current&&z(S)},[i,S,g.isClosePausedRef,z]),y.useEffect(()=>(R(),()=>I()),[R,I]);const M=y.useMemo(()=>x?FF(x):null,[x]);return g.viewport?s.jsxs(s.Fragment,{children:[M&&s.jsx(jQ,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:M}),s.jsx(_Q,{scope:r,onClose:O,children:ao.createPortal(s.jsx(PP.ItemSlot,{scope:r,children:s.jsx(tQ,{asChild:!0,onEscapeKeyDown:mt(l,()=>{g.isFocusedToastEscapeKeyDownRef.current||O(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:s.jsx(Pt.li,V(D({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection},v),{ref:w,style:D({userSelect:"none",touchAction:"none"},e.style),onKeyDown:mt(e.onKeyDown,F=>{F.key==="Escape"&&(l==null||l(F.nativeEvent),F.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,O()))}),onPointerDown:mt(e.onPointerDown,F=>{F.button===0&&(b.current={x:F.clientX,y:F.clientY})}),onPointerMove:mt(e.onPointerMove,F=>{if(!b.current)return;const U=F.clientX-b.current.x,H=F.clientY-b.current.y,q=!!N.current,K=["left","right"].includes(g.swipeDirection),Z=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,ne=K?Z(0,U):0,Y=K?0:Z(0,H),X=F.pointerType==="touch"?10:2,se={x:ne,y:Y},de={originalEvent:F,delta:se};q?(N.current=se,px(vQ,u,de,{discrete:!1})):PO(se,g.swipeDirection,X)?(N.current=se,px(gQ,f,de,{discrete:!1}),F.target.setPointerCapture(F.pointerId)):(Math.abs(U)>X||Math.abs(H)>X)&&(b.current=null)}),onPointerUp:mt(e.onPointerUp,F=>{const U=N.current,H=F.target;if(H.hasPointerCapture(F.pointerId)&&H.releasePointerCapture(F.pointerId),N.current=null,b.current=null,U){const q=F.currentTarget,K={originalEvent:F,delta:U};PO(U,g.swipeDirection,g.swipeThreshold)?px(xQ,m,K,{discrete:!0}):px(yQ,h,K,{discrete:!0}),q.addEventListener("click",Z=>Z.preventDefault(),{once:!0})}})}))})}),g.viewport)})]}):null}),jQ=e=>{const d=e,{__scopeToast:t,children:r}=d,n=ge(d,["__scopeToast","children"]),a=Wb(By,t),[i,o]=y.useState(!1),[l,c]=y.useState(!1);return kQ(()=>o(!0)),y.useEffect(()=>{const f=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(f)},[]),l?null:s.jsx(hp,{asChild:!0,children:s.jsx(Vb,V(D({},n),{children:i&&s.jsxs(s.Fragment,{children:[a.label," ",r]})}))})},NQ="ToastTitle",OF=y.forwardRef((e,t)=>{const a=e,{__scopeToast:r}=a,n=ge(a,["__scopeToast"]);return s.jsx(Pt.div,V(D({},n),{ref:t}))});OF.displayName=NQ;var SQ="ToastDescription",MF=y.forwardRef((e,t)=>{const a=e,{__scopeToast:r}=a,n=ge(a,["__scopeToast"]);return s.jsx(Pt.div,V(D({},n),{ref:t}))});MF.displayName=SQ;var DF="ToastAction",IF=y.forwardRef((e,t)=>{const a=e,{altText:r}=a,n=ge(a,["altText"]);return r.trim()?s.jsx(LF,{altText:r,asChild:!0,children:s.jsx(TP,V(D({},n),{ref:t}))}):(console.error(`Invalid prop \`altText\` supplied to \`${DF}\`. Expected non-empty \`string\`.`),null)});IF.displayName=DF;var $F="ToastClose",TP=y.forwardRef((e,t)=>{const i=e,{__scopeToast:r}=i,n=ge(i,["__scopeToast"]),a=wQ($F,r);return s.jsx(LF,{asChild:!0,children:s.jsx(Pt.button,V(D({type:"button"},n),{ref:t,onClick:mt(e.onClick,a.onClose)}))})});TP.displayName=$F;var LF=y.forwardRef((e,t)=>{const i=e,{__scopeToast:r,altText:n}=i,a=ge(i,["__scopeToast","altText"]);return s.jsx(Pt.div,V(D({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0},a),{ref:t}))});function FF(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),EQ(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const o=n.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...FF(n))}}),t}function px(e,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?EP(a,i):a.dispatchEvent(i)}var PO=(e,t,r=0)=>{const n=Math.abs(e.x),a=Math.abs(e.y),i=n>a;return t==="left"||t==="right"?i&&n>r:!i&&a>r};function kQ(e=()=>{}){const t=ys(e);xs(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function EQ(e){return e.nodeType===e.ELEMENT_NODE}function CQ(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function kN(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var PQ=CF,zF=TF,BF=RF,UF=OF,qF=MF,VF=IF,WF=TP;function HF(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=HF(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function on(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=HF(e))&&(n&&(n+=" "),n+=t);return n}const TO=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,AO=on,mp=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return AO(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,o=Object.keys(a).map(d=>{const f=r==null?void 0:r[d],u=i==null?void 0:i[d];if(f===null)return null;const h=TO(f)||TO(u);return a[d][h]}),l=r&&Object.entries(r).reduce((d,f)=>{let[u,h]=f;return h===void 0||(d[u]=h),d},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,f)=>{let v=f,{class:u,className:h}=v,m=ge(v,["class","className"]);return Object.entries(m).every(g=>{let[x,_]=g;return Array.isArray(_)?_.includes(D(D({},i),l)[x]):D(D({},i),l)[x]===_})?[...d,u,h]:d},[]);return AO(e,o,c,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TQ=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),GF=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var AQ={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RQ=y.forwardRef((d,c)=>{var f=d,{color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o}=f,l=ge(f,["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"]);return y.createElement("svg",D(V(D({ref:c},AQ),{width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:GF("lucide",a)}),l),[...o.map(([u,h])=>y.createElement(u,h)),...Array.isArray(i)?i:[i]])});/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=(e,t)=>{const r=y.forwardRef((o,i)=>{var l=o,{className:n}=l,a=ge(l,["className"]);return y.createElement(RQ,D({ref:i,iconNode:t,className:GF(`lucide-${TQ(e)}`,n)},a))});return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=st("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OQ=st("ArrowDownUp",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MQ=st("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=st("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=st("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DQ=st("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IQ=st("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=st("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=st("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mc=st("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Q=st("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=st("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LQ=st("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ud=st("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FQ=st("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Io=st("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=st("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Av=st("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=st("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hb=st("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=st("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=st("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AP=st("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uy=st("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=st("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const df=st("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=st("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=st("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zQ=st("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BQ=st("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=st("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=st("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=st("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RP=st("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UQ=st("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=st("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qQ=st("Disc",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Do=st("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pp=st("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VQ=st("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WQ=st("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=st("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HQ=st("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=st("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GQ=st("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=st("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=st("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YQ=st("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=st("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KQ=st("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xk=st("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZQ=st("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XQ=st("HeartOff",[["line",{x1:"2",y1:"2",x2:"22",y2:"22",key:"1w4vcy"}],["path",{d:"M16.5 16.5 12 21l-7-7c-1.5-1.45-3-3.2-3-5.5a5.5 5.5 0 0 1 2.14-4.35",key:"3mpagl"}],["path",{d:"M8.76 3.1c1.15.22 2.13.78 3.24 1.9 1.5-1.5 2.74-2 4.5-2A5.5 5.5 0 0 1 22 8.5c0 2.12-1.3 3.78-2.67 5.17",key:"1gh3v3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=st("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OP=st("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=st("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=st("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DP=st("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=st("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JQ=st("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QQ=st("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=st("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rv=st("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RO=st("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=st("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=st("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=st("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eee=st("MapPinned",[["path",{d:"M18 8c0 3.613-3.869 7.429-5.393 8.795a1 1 0 0 1-1.214 0C9.87 15.429 6 11.613 6 8a6 6 0 0 1 12 0",key:"11u0oz"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M8.714 14h-3.71a1 1 0 0 0-.948.683l-2.004 6A1 1 0 0 0 3 22h18a1 1 0 0 0 .948-1.316l-2-6a1 1 0 0 0-.949-.684h-3.712",key:"q8zwxj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tee=st("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ree=st("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nee=st("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=st("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ah=st("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const see=st("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=st("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=st("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aee=st("Music2",[["circle",{cx:"8",cy:"18",r:"4",key:"1fc0mg"}],["path",{d:"M12 18V2l7 4",key:"g04rme"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=st("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=st("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iee=st("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=st("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oee=st("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lee=st("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=st("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cee=st("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=st("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vi=st("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=st("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jk=st("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LP=st("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ho=st("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qc=st("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FP=st("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dc=st("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dee=st("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=st("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uee=st("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=st("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=st("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fee=st("SquarePlus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hee=st("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=st("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ji=st("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=st("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zl=st("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=st("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=st("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=st("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BP=st("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vd=st("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y_=st("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fg=st("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=st("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=st("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=st("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=st("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=st("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=st("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=st("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e2=st("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),UP="-",mee=e=>{const t=gee(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:o=>{const l=o.split(UP);return l[0]===""&&l.length!==1&&l.shift(),oz(l,t)||pee(o)},getConflictingClassGroupIds:(o,l)=>{const c=r[o]||[];return l&&n[o]?[...c,...n[o]]:c}}},oz=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?oz(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(UP);return(o=t.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},OO=/^\[(.+)\]$/,pee=e=>{if(OO.test(e)){const t=OO.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},gee=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return yee(Object.entries(e.classGroups),r).forEach(([i,o])=>{t2(o,n,i,t)}),n},t2=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:MO(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(vee(a)){t2(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,o])=>{t2(o,MO(t,i),r,n)})})},MO=(e,t)=>{let r=e;return t.split(UP).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},vee=e=>e.isThemeGetter,yee=(e,t)=>t?e.map(([r,n])=>{const a=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[t+o,l])):i);return[r,a]}):e,xee=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(i,o)=>{r.set(i,o),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return a(i,o),o},set(i,o){r.has(i)?r.set(i,o):a(i,o)}}},lz="!",_ee=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],i=t.length,o=l=>{const c=[];let d=0,f=0,u;for(let x=0;x<l.length;x++){let _=l[x];if(d===0){if(_===a&&(n||l.slice(x,x+i)===t)){c.push(l.slice(f,x)),f=x+i;continue}if(_==="/"){u=x;continue}}_==="["?d++:_==="]"&&d--}const h=c.length===0?l:l.substring(f),m=h.startsWith(lz),v=m?h.substring(1):h,g=u&&u>f?u-f:void 0;return{modifiers:c,hasImportantModifier:m,baseClassName:v,maybePostfixModifierPosition:g}};return r?l=>r({className:l,parseClassName:o}):o},wee=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},bee=e=>D({cache:xee(e.cacheSize),parseClassName:_ee(e)},mee(e)),jee=/\s+/,Nee=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,i=[],o=e.trim().split(jee);let l="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{modifiers:f,hasImportantModifier:u,baseClassName:h,maybePostfixModifierPosition:m}=r(d);let v=!!m,g=n(v?h.substring(0,m):h);if(!g){if(!v){l=d+(l.length>0?" "+l:l);continue}if(g=n(h),!g){l=d+(l.length>0?" "+l:l);continue}v=!1}const x=wee(f).join(":"),_=u?x+lz:x,w=_+g;if(i.includes(w))continue;i.push(w);const b=a(g,v);for(let N=0;N<b.length;++N){const S=b[N];i.push(_+S)}l=d+(l.length>0?" "+l:l)}return l};function See(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=cz(t))&&(n&&(n+=" "),n+=r);return n}const cz=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=cz(e[n]))&&(r&&(r+=" "),r+=t);return r};function kee(e,...t){let r,n,a,i=o;function o(c){const d=t.reduce((f,u)=>u(f),e());return r=bee(d),n=r.cache.get,a=r.cache.set,i=l,l(c)}function l(c){const d=n(c);if(d)return d;const f=Nee(c,r);return a(c,f),f}return function(){return i(See.apply(null,arguments))}}const Kn=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},dz=/^\[(?:([a-z-]+):)?(.+)\]$/i,Eee=/^\d+\/\d+$/,Cee=new Set(["px","full","screen"]),Pee=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Tee=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Aee=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Ree=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Oee=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ec=e=>Gh(e)||Cee.has(e)||Eee.test(e),td=e=>gp(e,"length",Bee),Gh=e=>!!e&&!Number.isNaN(Number(e)),CN=e=>gp(e,"number",Gh),lg=e=>!!e&&Number.isInteger(Number(e)),Mee=e=>e.endsWith("%")&&Gh(e.slice(0,-1)),Ur=e=>dz.test(e),rd=e=>Pee.test(e),Dee=new Set(["length","size","percentage"]),Iee=e=>gp(e,Dee,uz),$ee=e=>gp(e,"position",uz),Lee=new Set(["image","url"]),Fee=e=>gp(e,Lee,qee),zee=e=>gp(e,"",Uee),cg=()=>!0,gp=(e,t,r)=>{const n=dz.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},Bee=e=>Tee.test(e)&&!Aee.test(e),uz=()=>!1,Uee=e=>Ree.test(e),qee=e=>Oee.test(e),Vee=()=>{const e=Kn("colors"),t=Kn("spacing"),r=Kn("blur"),n=Kn("brightness"),a=Kn("borderColor"),i=Kn("borderRadius"),o=Kn("borderSpacing"),l=Kn("borderWidth"),c=Kn("contrast"),d=Kn("grayscale"),f=Kn("hueRotate"),u=Kn("invert"),h=Kn("gap"),m=Kn("gradientColorStops"),v=Kn("gradientColorStopPositions"),g=Kn("inset"),x=Kn("margin"),_=Kn("opacity"),w=Kn("padding"),b=Kn("saturate"),N=Kn("scale"),S=Kn("sepia"),k=Kn("skew"),C=Kn("space"),A=Kn("translate"),R=()=>["auto","contain","none"],I=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto",Ur,t],z=()=>[Ur,t],M=()=>["",ec,td],B=()=>["auto",Gh,Ur],F=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],U=()=>["solid","dashed","dotted","double","none"],H=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],q=()=>["start","end","center","between","around","evenly","stretch"],K=()=>["","0",Ur],Z=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ne=()=>[Gh,Ur];return{cacheSize:500,separator:":",theme:{colors:[cg],spacing:[ec,td],blur:["none","",rd,Ur],brightness:ne(),borderColor:[e],borderRadius:["none","","full",rd,Ur],borderSpacing:z(),borderWidth:M(),contrast:ne(),grayscale:K(),hueRotate:ne(),invert:K(),gap:z(),gradientColorStops:[e],gradientColorStopPositions:[Mee,td],inset:O(),margin:O(),opacity:ne(),padding:z(),saturate:ne(),scale:ne(),sepia:K(),skew:ne(),space:z(),translate:z()},classGroups:{aspect:[{aspect:["auto","square","video",Ur]}],container:["container"],columns:[{columns:[rd]}],"break-after":[{"break-after":Z()}],"break-before":[{"break-before":Z()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...F(),Ur]}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",lg,Ur]}],basis:[{basis:O()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ur]}],grow:[{grow:K()}],shrink:[{shrink:K()}],order:[{order:["first","last","none",lg,Ur]}],"grid-cols":[{"grid-cols":[cg]}],"col-start-end":[{col:["auto",{span:["full",lg,Ur]},Ur]}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":[cg]}],"row-start-end":[{row:["auto",{span:[lg,Ur]},Ur]}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ur]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ur]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...q()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...q(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...q(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ur,t]}],"min-w":[{"min-w":[Ur,t,"min","max","fit"]}],"max-w":[{"max-w":[Ur,t,"none","full","min","max","fit","prose",{screen:[rd]},rd]}],h:[{h:[Ur,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ur,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ur,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ur,t,"auto","min","max","fit"]}],"font-size":[{text:["base",rd,td]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",CN]}],"font-family":[{font:[cg]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ur]}],"line-clamp":[{"line-clamp":["none",Gh,CN]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ec,Ur]}],"list-image":[{"list-image":["none",Ur]}],"list-style-type":[{list:["none","disc","decimal",Ur]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[_]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[_]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...U(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ec,td]}],"underline-offset":[{"underline-offset":["auto",ec,Ur]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:z()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ur]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ur]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[_]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...F(),$ee]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Iee]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Fee]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[_]}],"border-style":[{border:[...U(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[_]}],"divide-style":[{divide:U()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...U()]}],"outline-offset":[{"outline-offset":[ec,Ur]}],"outline-w":[{outline:[ec,td]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[_]}],"ring-offset-w":[{"ring-offset":[ec,td]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",rd,zee]}],"shadow-color":[{shadow:[cg]}],opacity:[{opacity:[_]}],"mix-blend":[{"mix-blend":[...H(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":H()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",rd,Ur]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[u]}],saturate:[{saturate:[b]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[_]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ur]}],duration:[{duration:ne()}],ease:[{ease:["linear","in","out","in-out",Ur]}],delay:[{delay:ne()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ur]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[lg,Ur]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ur]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ur]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":z()}],"scroll-mx":[{"scroll-mx":z()}],"scroll-my":[{"scroll-my":z()}],"scroll-ms":[{"scroll-ms":z()}],"scroll-me":[{"scroll-me":z()}],"scroll-mt":[{"scroll-mt":z()}],"scroll-mr":[{"scroll-mr":z()}],"scroll-mb":[{"scroll-mb":z()}],"scroll-ml":[{"scroll-ml":z()}],"scroll-p":[{"scroll-p":z()}],"scroll-px":[{"scroll-px":z()}],"scroll-py":[{"scroll-py":z()}],"scroll-ps":[{"scroll-ps":z()}],"scroll-pe":[{"scroll-pe":z()}],"scroll-pt":[{"scroll-pt":z()}],"scroll-pr":[{"scroll-pr":z()}],"scroll-pb":[{"scroll-pb":z()}],"scroll-pl":[{"scroll-pl":z()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ur]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ec,td,CN]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Wee=kee(Vee);function Oe(...e){return Wee(on(e))}const Hee=PQ,fz=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(zF,D({ref:r,className:Oe("fixed z-[3000] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),style:D({top:"env(safe-area-inset-top, 0px)"},t.style)},t))});fz.displayName=zF.displayName;const Gee=mp("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),hz=y.forwardRef((a,n)=>{var i=a,{className:e,variant:t}=i,r=ge(i,["className","variant"]);return s.jsx(BF,D({ref:n,className:Oe(Gee({variant:t}),e)},r))});hz.displayName=BF.displayName;const mz=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(VF,D({ref:r,className:Oe("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e)},t))});mz.displayName=VF.displayName;const pz=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(WF,V(D({ref:r,className:Oe("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":""},t),{children:s.jsx(Yr,{className:"h-4 w-4"})}))});pz.displayName=WF.displayName;const gz=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(UF,D({ref:r,className:Oe("text-sm font-semibold",e)},t))});gz.displayName=UF.displayName;const vz=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(qF,D({ref:r,className:Oe("text-sm opacity-90",e)},t))});vz.displayName=qF.displayName;function Yee(){const{toasts:e}=Er();return s.jsxs(Hee,{children:[e.map(function(o){var l=o,{id:t,title:r,description:n,action:a}=l,i=ge(l,["id","title","description","action"]);return s.jsxs(hz,V(D({},i),{children:[s.jsxs("div",{className:"grid gap-1",children:[r&&s.jsx(gz,{children:r}),n&&s.jsx(vz,{children:n})]}),a,s.jsx(pz,{})]}),t)}),s.jsx(fz,{})]})}var DO=["light","dark"],Kee="(prefers-color-scheme: dark)",Zee=y.createContext(void 0),Xee={setTheme:e=>{},themes:[]},Jee=()=>{var e;return(e=y.useContext(Zee))!=null?e:Xee};y.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:i,value:o,attrs:l,nonce:c})=>{let d=i==="system",f=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${l.map(v=>`'${v}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,u=a?DO.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",h=(v,g=!1,x=!0)=>{let _=o?o[v]:v,w=g?v+"|| ''":`'${_}'`,b="";return a&&x&&!g&&DO.includes(v)&&(b+=`d.style.colorScheme = '${v}';`),r==="class"?g||_?b+=`c.add(${w})`:b+="null":_&&(b+=`d[s](n,${w})`),b},m=e?`!function(){${f}${h(e)}}()`:n?`!function(){try{${f}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${d})){var t='${Kee}',m=window.matchMedia(t);if(m.media!==t||m.matches){${h("dark")}}else{${h("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${h(o?"x[e]":"e",!0)}}${d?"":"else{"+h(i,!1,!1)+"}"}${u}}catch(e){}}()`:`!function(){try{${f}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${h(o?"x[e]":"e",!0)}}else{${h(i,!1,!1)};}${u}}catch(t){}}();`;return y.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:m}})});var Qee=e=>{switch(e){case"success":return rte;case"info":return ste;case"warning":return nte;case"error":return ate;default:return null}},ete=Array(12).fill(0),tte=({visible:e,className:t})=>te.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},te.createElement("div",{className:"sonner-spinner"},ete.map((r,n)=>te.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),rte=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),nte=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),ste=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),ate=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),ite=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},te.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),te.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),ote=()=>{let[e,t]=te.useState(document.hidden);return te.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},r2=1,lte=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let l=e,{message:r}=l,n=ge(l,["message"]),a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:r2++,i=this.toasts.find(c=>c.id===a),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),i?this.toasts=this.toasts.map(c=>c.id===a?(this.publish(V(D(D({},c),e),{id:a,title:r})),V(D(D({},c),e),{id:a,dismissible:o,title:r})):c):this.addToast(V(D({title:r},n),{dismissible:o,id:a})),a},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create(V(D({},t),{message:e})),this.error=(e,t)=>this.create(V(D({},t),{message:e,type:"error"})),this.success=(e,t)=>this.create(V(D({},t),{type:"success",message:e})),this.info=(e,t)=>this.create(V(D({},t),{type:"info",message:e})),this.warning=(e,t)=>this.create(V(D({},t),{type:"warning",message:e})),this.loading=(e,t)=>this.create(V(D({},t),{type:"loading",message:e})),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create(V(D({},t),{promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0})));let n=e instanceof Promise?e:e(),a=r!==void 0,i,o=n.then(c=>E(this,null,function*(){if(i=["resolve",c],te.isValidElement(c))a=!1,this.create({id:r,type:"default",message:c});else if(dte(c)&&!c.ok){a=!1;let d=typeof t.error=="function"?yield t.error(`HTTP error! status: ${c.status}`):t.error,f=typeof t.description=="function"?yield t.description(`HTTP error! status: ${c.status}`):t.description;this.create({id:r,type:"error",message:d,description:f})}else if(t.success!==void 0){a=!1;let d=typeof t.success=="function"?yield t.success(c):t.success,f=typeof t.description=="function"?yield t.description(c):t.description;this.create({id:r,type:"success",message:d,description:f})}})).catch(c=>E(this,null,function*(){if(i=["reject",c],t.error!==void 0){a=!1;let d=typeof t.error=="function"?yield t.error(c):t.error,f=typeof t.description=="function"?yield t.description(c):t.description;this.create({id:r,type:"error",message:d,description:f})}})).finally(()=>{var c;a&&(this.dismiss(r),r=void 0),(c=t.finally)==null||c.call(t)}),l=()=>new Promise((c,d)=>o.then(()=>i[0]==="reject"?d(i[1]):c(i[1])).catch(d));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||r2++;return this.create(D({jsx:e(r),id:r},t)),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},si=new lte,cte=(e,t)=>{let r=(t==null?void 0:t.id)||r2++;return si.addToast(V(D({title:e},t),{id:r})),r},dte=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",ute=cte,fte=()=>si.toasts,hte=()=>si.getActiveToasts();Object.assign(ute,{success:si.success,info:si.info,warning:si.warning,error:si.error,custom:si.custom,message:si.message,promise:si.promise,dismiss:si.dismiss,loading:si.loading},{getHistory:fte,getToasts:hte});function mte(e,{insertAt:t}={}){if(typeof document=="undefined")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}mte(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function gx(e){return e.label!==void 0}var pte=3,gte="32px",vte="16px",IO=4e3,yte=356,xte=14,_te=20,wte=200;function wo(...e){return e.filter(Boolean).join(" ")}function bte(e){let[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var jte=e=>{var t,r,n,a,i,o,l,c,d,f,u;let{invert:h,toast:m,unstyled:v,interacting:g,setHeights:x,visibleToasts:_,heights:w,index:b,toasts:N,expanded:S,removeToast:k,defaultRichColors:C,closeButton:A,style:R,cancelButtonStyle:I,actionButtonStyle:O,className:z="",descriptionClassName:M="",duration:B,position:F,gap:U,loadingIcon:H,expandByDefault:q,classNames:K,icons:Z,closeButtonAriaLabel:ne="Close toast",pauseWhenPageIsHidden:Y}=e,[X,se]=te.useState(null),[de,_e]=te.useState(null),[xe,Q]=te.useState(!1),[oe,ie]=te.useState(!1),[ee,G]=te.useState(!1),[J,ae]=te.useState(!1),[fe,we]=te.useState(!1),[ve,me]=te.useState(0),[Me,Te]=te.useState(0),Ve=te.useRef(m.duration||B||IO),le=te.useRef(null),Ke=te.useRef(null),De=b===0,nt=b+1<=_,ze=m.type,vt=m.dismissible!==!1,rr=m.className||"",sr=m.descriptionClassName||"",Ae=te.useMemo(()=>w.findIndex(Fe=>Fe.toastId===m.id)||0,[w,m.id]),Ue=te.useMemo(()=>{var Fe;return(Fe=m.closeButton)!=null?Fe:A},[m.closeButton,A]),gt=te.useMemo(()=>m.duration||B||IO,[m.duration,B]),Ce=te.useRef(0),Ge=te.useRef(0),Nt=te.useRef(0),Tt=te.useRef(null),[at,ue]=F.split("-"),qe=te.useMemo(()=>w.reduce((Fe,ft,Et)=>Et>=Ae?Fe:Fe+ft.height,0),[w,Ae]),Ct=ote(),ct=m.invert||h,pt=ze==="loading";Ge.current=te.useMemo(()=>Ae*U+qe,[Ae,qe]),te.useEffect(()=>{Ve.current=gt},[gt]),te.useEffect(()=>{Q(!0)},[]),te.useEffect(()=>{let Fe=Ke.current;if(Fe){let ft=Fe.getBoundingClientRect().height;return Te(ft),x(Et=>[{toastId:m.id,height:ft,position:m.position},...Et]),()=>x(Et=>Et.filter(hr=>hr.toastId!==m.id))}},[x,m.id]),te.useLayoutEffect(()=>{if(!xe)return;let Fe=Ke.current,ft=Fe.style.height;Fe.style.height="auto";let Et=Fe.getBoundingClientRect().height;Fe.style.height=ft,Te(Et),x(hr=>hr.find(dr=>dr.toastId===m.id)?hr.map(dr=>dr.toastId===m.id?V(D({},dr),{height:Et}):dr):[{toastId:m.id,height:Et,position:m.position},...hr])},[xe,m.title,m.description,x,m.id]);let At=te.useCallback(()=>{ie(!0),me(Ge.current),x(Fe=>Fe.filter(ft=>ft.toastId!==m.id)),setTimeout(()=>{k(m)},wte)},[m,k,x,Ge]);te.useEffect(()=>{if(m.promise&&ze==="loading"||m.duration===1/0||m.type==="loading")return;let Fe;return S||g||Y&&Ct?(()=>{if(Nt.current<Ce.current){let ft=new Date().getTime()-Ce.current;Ve.current=Ve.current-ft}Nt.current=new Date().getTime()})():Ve.current!==1/0&&(Ce.current=new Date().getTime(),Fe=setTimeout(()=>{var ft;(ft=m.onAutoClose)==null||ft.call(m,m),At()},Ve.current)),()=>clearTimeout(Fe)},[S,g,m,ze,Y,Ct,At]),te.useEffect(()=>{m.delete&&At()},[At,m.delete]);function yt(){var Fe,ft,Et;return Z!=null&&Z.loading?te.createElement("div",{className:wo(K==null?void 0:K.loader,(Fe=m==null?void 0:m.classNames)==null?void 0:Fe.loader,"sonner-loader"),"data-visible":ze==="loading"},Z.loading):H?te.createElement("div",{className:wo(K==null?void 0:K.loader,(ft=m==null?void 0:m.classNames)==null?void 0:ft.loader,"sonner-loader"),"data-visible":ze==="loading"},H):te.createElement(tte,{className:wo(K==null?void 0:K.loader,(Et=m==null?void 0:m.classNames)==null?void 0:Et.loader),visible:ze==="loading"})}return te.createElement("li",{tabIndex:0,ref:Ke,className:wo(z,rr,K==null?void 0:K.toast,(t=m==null?void 0:m.classNames)==null?void 0:t.toast,K==null?void 0:K.default,K==null?void 0:K[ze],(r=m==null?void 0:m.classNames)==null?void 0:r[ze]),"data-sonner-toast":"","data-rich-colors":(n=m.richColors)!=null?n:C,"data-styled":!(m.jsx||m.unstyled||v),"data-mounted":xe,"data-promise":!!m.promise,"data-swiped":fe,"data-removed":oe,"data-visible":nt,"data-y-position":at,"data-x-position":ue,"data-index":b,"data-front":De,"data-swiping":ee,"data-dismissible":vt,"data-type":ze,"data-invert":ct,"data-swipe-out":J,"data-swipe-direction":de,"data-expanded":!!(S||q&&xe),style:D(D({"--index":b,"--toasts-before":b,"--z-index":N.length-b,"--offset":`${oe?ve:Ge.current}px`,"--initial-height":q?"auto":`${Me}px`},R),m.style),onDragEnd:()=>{G(!1),se(null),Tt.current=null},onPointerDown:Fe=>{pt||!vt||(le.current=new Date,me(Ge.current),Fe.target.setPointerCapture(Fe.pointerId),Fe.target.tagName!=="BUTTON"&&(G(!0),Tt.current={x:Fe.clientX,y:Fe.clientY}))},onPointerUp:()=>{var Fe,ft,Et,hr;if(J||!vt)return;Tt.current=null;let dr=Number(((Fe=Ke.current)==null?void 0:Fe.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),cn=Number(((ft=Ke.current)==null?void 0:ft.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),mn=new Date().getTime()-((Et=le.current)==null?void 0:Et.getTime()),je=X==="x"?dr:cn,pe=Math.abs(je)/mn;if(Math.abs(je)>=_te||pe>.11){me(Ge.current),(hr=m.onDismiss)==null||hr.call(m,m),_e(X==="x"?dr>0?"right":"left":cn>0?"down":"up"),At(),ae(!0),we(!1);return}G(!1),se(null)},onPointerMove:Fe=>{var ft,Et,hr,dr;if(!Tt.current||!vt||((ft=window.getSelection())==null?void 0:ft.toString().length)>0)return;let cn=Fe.clientY-Tt.current.y,mn=Fe.clientX-Tt.current.x,je=(Et=e.swipeDirections)!=null?Et:bte(F);!X&&(Math.abs(mn)>1||Math.abs(cn)>1)&&se(Math.abs(mn)>Math.abs(cn)?"x":"y");let pe={x:0,y:0};X==="y"?(je.includes("top")||je.includes("bottom"))&&(je.includes("top")&&cn<0||je.includes("bottom")&&cn>0)&&(pe.y=cn):X==="x"&&(je.includes("left")||je.includes("right"))&&(je.includes("left")&&mn<0||je.includes("right")&&mn>0)&&(pe.x=mn),(Math.abs(pe.x)>0||Math.abs(pe.y)>0)&&we(!0),(hr=Ke.current)==null||hr.style.setProperty("--swipe-amount-x",`${pe.x}px`),(dr=Ke.current)==null||dr.style.setProperty("--swipe-amount-y",`${pe.y}px`)}},Ue&&!m.jsx?te.createElement("button",{"aria-label":ne,"data-disabled":pt,"data-close-button":!0,onClick:pt||!vt?()=>{}:()=>{var Fe;At(),(Fe=m.onDismiss)==null||Fe.call(m,m)},className:wo(K==null?void 0:K.closeButton,(a=m==null?void 0:m.classNames)==null?void 0:a.closeButton)},(i=Z==null?void 0:Z.close)!=null?i:ite):null,m.jsx||y.isValidElement(m.title)?m.jsx?m.jsx:typeof m.title=="function"?m.title():m.title:te.createElement(te.Fragment,null,ze||m.icon||m.promise?te.createElement("div",{"data-icon":"",className:wo(K==null?void 0:K.icon,(o=m==null?void 0:m.classNames)==null?void 0:o.icon)},m.promise||m.type==="loading"&&!m.icon?m.icon||yt():null,m.type!=="loading"?m.icon||(Z==null?void 0:Z[ze])||Qee(ze):null):null,te.createElement("div",{"data-content":"",className:wo(K==null?void 0:K.content,(l=m==null?void 0:m.classNames)==null?void 0:l.content)},te.createElement("div",{"data-title":"",className:wo(K==null?void 0:K.title,(c=m==null?void 0:m.classNames)==null?void 0:c.title)},typeof m.title=="function"?m.title():m.title),m.description?te.createElement("div",{"data-description":"",className:wo(M,sr,K==null?void 0:K.description,(d=m==null?void 0:m.classNames)==null?void 0:d.description)},typeof m.description=="function"?m.description():m.description):null),y.isValidElement(m.cancel)?m.cancel:m.cancel&&gx(m.cancel)?te.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||I,onClick:Fe=>{var ft,Et;gx(m.cancel)&&vt&&((Et=(ft=m.cancel).onClick)==null||Et.call(ft,Fe),At())},className:wo(K==null?void 0:K.cancelButton,(f=m==null?void 0:m.classNames)==null?void 0:f.cancelButton)},m.cancel.label):null,y.isValidElement(m.action)?m.action:m.action&&gx(m.action)?te.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||O,onClick:Fe=>{var ft,Et;gx(m.action)&&((Et=(ft=m.action).onClick)==null||Et.call(ft,Fe),!Fe.defaultPrevented&&At())},className:wo(K==null?void 0:K.actionButton,(u=m==null?void 0:m.classNames)==null?void 0:u.actionButton)},m.action.label):null))};function $O(){if(typeof window=="undefined"||typeof document=="undefined")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Nte(e,t){let r={};return[e,t].forEach((n,a)=>{let i=a===1,o=i?"--mobile-offset":"--offset",l=i?vte:gte;function c(d){["top","right","bottom","left"].forEach(f=>{r[`${o}-${f}`]=typeof d=="number"?`${d}px`:d})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(d=>{n[d]===void 0?r[`${o}-${d}`]=l:r[`${o}-${d}`]=typeof n[d]=="number"?`${n[d]}px`:n[d]}):c(l)}),r}var Ste=y.forwardRef(function(e,t){let{invert:r,position:n="bottom-right",hotkey:a=["altKey","KeyT"],expand:i,closeButton:o,className:l,offset:c,mobileOffset:d,theme:f="light",richColors:u,duration:h,style:m,visibleToasts:v=pte,toastOptions:g,dir:x=$O(),gap:_=xte,loadingIcon:w,icons:b,containerAriaLabel:N="Notifications",pauseWhenPageIsHidden:S}=e,[k,C]=te.useState([]),A=te.useMemo(()=>Array.from(new Set([n].concat(k.filter(Y=>Y.position).map(Y=>Y.position)))),[k,n]),[R,I]=te.useState([]),[O,z]=te.useState(!1),[M,B]=te.useState(!1),[F,U]=te.useState(f!=="system"?f:typeof window!="undefined"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),H=te.useRef(null),q=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),K=te.useRef(null),Z=te.useRef(!1),ne=te.useCallback(Y=>{C(X=>{var se;return(se=X.find(de=>de.id===Y.id))!=null&&se.delete||si.dismiss(Y.id),X.filter(({id:de})=>de!==Y.id)})},[]);return te.useEffect(()=>si.subscribe(Y=>{if(Y.dismiss){C(X=>X.map(se=>se.id===Y.id?V(D({},se),{delete:!0}):se));return}setTimeout(()=>{Hh.flushSync(()=>{C(X=>{let se=X.findIndex(de=>de.id===Y.id);return se!==-1?[...X.slice(0,se),D(D({},X[se]),Y),...X.slice(se+1)]:[Y,...X]})})})}),[]),te.useEffect(()=>{if(f!=="system"){U(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?U("dark"):U("light")),typeof window=="undefined")return;let Y=window.matchMedia("(prefers-color-scheme: dark)");try{Y.addEventListener("change",({matches:X})=>{U(X?"dark":"light")})}catch(X){Y.addListener(({matches:se})=>{try{U(se?"dark":"light")}catch(de){console.error(de)}})}},[f]),te.useEffect(()=>{k.length<=1&&z(!1)},[k]),te.useEffect(()=>{let Y=X=>{var se,de;a.every(_e=>X[_e]||X.code===_e)&&(z(!0),(se=H.current)==null||se.focus()),X.code==="Escape"&&(document.activeElement===H.current||(de=H.current)!=null&&de.contains(document.activeElement))&&z(!1)};return document.addEventListener("keydown",Y),()=>document.removeEventListener("keydown",Y)},[a]),te.useEffect(()=>{if(H.current)return()=>{K.current&&(K.current.focus({preventScroll:!0}),K.current=null,Z.current=!1)}},[H.current]),te.createElement("section",{ref:t,"aria-label":`${N} ${q}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},A.map((Y,X)=>{var se;let[de,_e]=Y.split("-");return k.length?te.createElement("ol",{key:Y,dir:x==="auto"?$O():x,tabIndex:-1,ref:H,className:l,"data-sonner-toaster":!0,"data-theme":F,"data-y-position":de,"data-lifted":O&&k.length>1&&!i,"data-x-position":_e,style:D(D({"--front-toast-height":`${((se=R[0])==null?void 0:se.height)||0}px`,"--width":`${yte}px`,"--gap":`${_}px`},m),Nte(c,d)),onBlur:xe=>{Z.current&&!xe.currentTarget.contains(xe.relatedTarget)&&(Z.current=!1,K.current&&(K.current.focus({preventScroll:!0}),K.current=null))},onFocus:xe=>{xe.target instanceof HTMLElement&&xe.target.dataset.dismissible==="false"||Z.current||(Z.current=!0,K.current=xe.relatedTarget)},onMouseEnter:()=>z(!0),onMouseMove:()=>z(!0),onMouseLeave:()=>{M||z(!1)},onDragEnd:()=>z(!1),onPointerDown:xe=>{xe.target instanceof HTMLElement&&xe.target.dataset.dismissible==="false"||B(!0)},onPointerUp:()=>B(!1)},k.filter(xe=>!xe.position&&X===0||xe.position===Y).map((xe,Q)=>{var oe,ie;return te.createElement(jte,{key:xe.id,icons:b,index:Q,toast:xe,defaultRichColors:u,duration:(oe=g==null?void 0:g.duration)!=null?oe:h,className:g==null?void 0:g.className,descriptionClassName:g==null?void 0:g.descriptionClassName,invert:r,visibleToasts:v,closeButton:(ie=g==null?void 0:g.closeButton)!=null?ie:o,interacting:M,position:Y,style:g==null?void 0:g.style,unstyled:g==null?void 0:g.unstyled,classNames:g==null?void 0:g.classNames,cancelButtonStyle:g==null?void 0:g.cancelButtonStyle,actionButtonStyle:g==null?void 0:g.actionButtonStyle,removeToast:ne,toasts:k.filter(ee=>ee.position==xe.position),heights:R.filter(ee=>ee.position==xe.position),setHeights:I,expandByDefault:i,gap:_,loadingIcon:w,expanded:O,pauseWhenPageIsHidden:S,swipeDirections:e.swipeDirections})})):null}))});const kte=t=>{var e=ge(t,[]);const{theme:r="system"}=Jee();return s.jsx(Ste,D({theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}}},e))};var Ete=IC[" useId ".trim().toString()]||(()=>{}),Cte=0;function Os(e){const[t,r]=y.useState(Ete());return xs(()=>{e||r(n=>n!=null?n:String(Cte++))},[e]),e||(t?`radix-${t}`:"")}const Pte=["top","right","bottom","left"],Wd=Math.min,Ti=Math.max,K_=Math.round,vx=Math.floor,Ml=e=>({x:e,y:e}),Tte={left:"right",right:"left",bottom:"top",top:"bottom"},Ate={start:"end",end:"start"};function n2(e,t,r){return Ti(e,Wd(t,r))}function Ic(e,t){return typeof e=="function"?e(t):e}function $c(e){return e.split("-")[0]}function vp(e){return e.split("-")[1]}function qP(e){return e==="x"?"y":"x"}function VP(e){return e==="y"?"height":"width"}const Rte=new Set(["top","bottom"]);function bl(e){return Rte.has($c(e))?"y":"x"}function WP(e){return qP(bl(e))}function Ote(e,t,r){r===void 0&&(r=!1);const n=vp(e),a=WP(e),i=VP(a);let o=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=Z_(o)),[o,Z_(o)]}function Mte(e){const t=Z_(e);return[s2(e),t,s2(t)]}function s2(e){return e.replace(/start|end/g,t=>Ate[t])}const LO=["left","right"],FO=["right","left"],Dte=["top","bottom"],Ite=["bottom","top"];function $te(e,t,r){switch(e){case"top":case"bottom":return r?t?FO:LO:t?LO:FO;case"left":case"right":return t?Dte:Ite;default:return[]}}function Lte(e,t,r,n){const a=vp(e);let i=$te($c(e),r==="start",n);return a&&(i=i.map(o=>o+"-"+a),t&&(i=i.concat(i.map(s2)))),i}function Z_(e){return e.replace(/left|right|bottom|top/g,t=>Tte[t])}function Fte(e){return D({top:0,right:0,bottom:0,left:0},e)}function yz(e){return typeof e!="number"?Fte(e):{top:e,right:e,bottom:e,left:e}}function X_(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function zO(e,t,r){let{reference:n,floating:a}=e;const i=bl(t),o=WP(t),l=VP(o),c=$c(t),d=i==="y",f=n.x+n.width/2-a.width/2,u=n.y+n.height/2-a.height/2,h=n[l]/2-a[l]/2;let m;switch(c){case"top":m={x:f,y:n.y-a.height};break;case"bottom":m={x:f,y:n.y+n.height};break;case"right":m={x:n.x+n.width,y:u};break;case"left":m={x:n.x-a.width,y:u};break;default:m={x:n.x,y:n.y}}switch(vp(t)){case"start":m[o]-=h*(r&&d?-1:1);break;case"end":m[o]+=h*(r&&d?-1:1);break}return m}const zte=(e,t,r)=>E(void 0,null,function*(){const{placement:n="bottom",strategy:a="absolute",middleware:i=[],platform:o}=r,l=i.filter(Boolean),c=yield o.isRTL==null?void 0:o.isRTL(t);let d=yield o.getElementRects({reference:e,floating:t,strategy:a}),{x:f,y:u}=zO(d,n,c),h=n,m={},v=0;for(let g=0;g<l.length;g++){const{name:x,fn:_}=l[g],{x:w,y:b,data:N,reset:S}=yield _({x:f,y:u,initialPlacement:n,placement:h,strategy:a,middlewareData:m,rects:d,platform:o,elements:{reference:e,floating:t}});f=w!=null?w:f,u=b!=null?b:u,m=V(D({},m),{[x]:D(D({},m[x]),N)}),S&&v<=50&&(v++,typeof S=="object"&&(S.placement&&(h=S.placement),S.rects&&(d=S.rects===!0?yield o.getElementRects({reference:e,floating:t,strategy:a}):S.rects),{x:f,y:u}=zO(d,h,c)),g=-1)}return{x:f,y:u,placement:h,strategy:a,middlewareData:m}});function Ov(e,t){return E(this,null,function*(){var r;t===void 0&&(t={});const{x:n,y:a,platform:i,rects:o,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:f="viewport",elementContext:u="floating",altBoundary:h=!1,padding:m=0}=Ic(t,e),v=yz(m),x=l[h?u==="floating"?"reference":"floating":u],_=X_(yield i.getClippingRect({element:(r=yield i.isElement==null?void 0:i.isElement(x))==null||r?x:x.contextElement||(yield i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:d,rootBoundary:f,strategy:c})),w=u==="floating"?{x:n,y:a,width:o.floating.width,height:o.floating.height}:o.reference,b=yield i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating),N=(yield i.isElement==null?void 0:i.isElement(b))?(yield i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},S=X_(i.convertOffsetParentRelativeRectToViewportRelativeRect?yield i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:w,offsetParent:b,strategy:c}):w);return{top:(_.top-S.top+v.top)/N.y,bottom:(S.bottom-_.bottom+v.bottom)/N.y,left:(_.left-S.left+v.left)/N.x,right:(S.right-_.right+v.right)/N.x}})}const Bte=e=>({name:"arrow",options:e,fn(r){return E(this,null,function*(){const{x:n,y:a,placement:i,rects:o,platform:l,elements:c,middlewareData:d}=r,{element:f,padding:u=0}=Ic(e,r)||{};if(f==null)return{};const h=yz(u),m={x:n,y:a},v=WP(i),g=VP(v),x=yield l.getDimensions(f),_=v==="y",w=_?"top":"left",b=_?"bottom":"right",N=_?"clientHeight":"clientWidth",S=o.reference[g]+o.reference[v]-m[v]-o.floating[g],k=m[v]-o.reference[v],C=yield l.getOffsetParent==null?void 0:l.getOffsetParent(f);let A=C?C[N]:0;(!A||!(yield l.isElement==null?void 0:l.isElement(C)))&&(A=c.floating[N]||o.floating[g]);const R=S/2-k/2,I=A/2-x[g]/2-1,O=Wd(h[w],I),z=Wd(h[b],I),M=O,B=A-x[g]-z,F=A/2-x[g]/2+R,U=n2(M,F,B),H=!d.arrow&&vp(i)!=null&&F!==U&&o.reference[g]/2-(F<M?O:z)-x[g]/2<0,q=H?F<M?F-M:F-B:0;return{[v]:m[v]+q,data:D({[v]:U,centerOffset:F-U-q},H&&{alignmentOffset:q}),reset:H}})}}),Ute=function(e){return e===void 0&&(e={}),{name:"flip",options:e,fn(r){return E(this,null,function*(){var n,a;const{placement:i,middlewareData:o,rects:l,initialPlacement:c,platform:d,elements:f}=r,F=Ic(e,r),{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:m,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:x=!0}=F,_=ge(F,["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"]);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const w=$c(i),b=bl(c),N=$c(c)===c,S=yield d.isRTL==null?void 0:d.isRTL(f.floating),k=m||(N||!x?[Z_(c)]:Mte(c)),C=g!=="none";!m&&C&&k.push(...Lte(c,x,g,S));const A=[c,...k],R=yield Ov(r,_),I=[];let O=((a=o.flip)==null?void 0:a.overflows)||[];if(u&&I.push(R[w]),h){const U=Ote(i,l,S);I.push(R[U[0]],R[U[1]])}if(O=[...O,{placement:i,overflows:I}],!I.every(U=>U<=0)){var z,M;const U=(((z=o.flip)==null?void 0:z.index)||0)+1,H=A[U];if(H&&(!(h==="alignment"?b!==bl(H):!1)||O.every(Z=>Z.overflows[0]>0&&bl(Z.placement)===b)))return{data:{index:U,overflows:O},reset:{placement:H}};let q=(M=O.filter(K=>K.overflows[0]<=0).sort((K,Z)=>K.overflows[1]-Z.overflows[1])[0])==null?void 0:M.placement;if(!q)switch(v){case"bestFit":{var B;const K=(B=O.filter(Z=>{if(C){const ne=bl(Z.placement);return ne===b||ne==="y"}return!0}).map(Z=>[Z.placement,Z.overflows.filter(ne=>ne>0).reduce((ne,Y)=>ne+Y,0)]).sort((Z,ne)=>Z[1]-ne[1])[0])==null?void 0:B[0];K&&(q=K);break}case"initialPlacement":q=c;break}if(i!==q)return{reset:{placement:q}}}return{}})}}};function BO(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function UO(e){return Pte.some(t=>e[t]>=0)}const qte=function(e){return e===void 0&&(e={}),{name:"hide",options:e,fn(r){return E(this,null,function*(){const{rects:n}=r,o=Ic(e,r),{strategy:a="referenceHidden"}=o,i=ge(o,["strategy"]);switch(a){case"referenceHidden":{const l=yield Ov(r,V(D({},i),{elementContext:"reference"})),c=BO(l,n.reference);return{data:{referenceHiddenOffsets:c,referenceHidden:UO(c)}}}case"escaped":{const l=yield Ov(r,V(D({},i),{altBoundary:!0})),c=BO(l,n.floating);return{data:{escapedOffsets:c,escaped:UO(c)}}}default:return{}}})}}},xz=new Set(["left","top"]);function Vte(e,t){return E(this,null,function*(){const{placement:r,platform:n,elements:a}=e,i=yield n.isRTL==null?void 0:n.isRTL(a.floating),o=$c(r),l=vp(r),c=bl(r)==="y",d=xz.has(o)?-1:1,f=i&&c?-1:1,u=Ic(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:v}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return l&&typeof v=="number"&&(m=l==="end"?v*-1:v),c?{x:m*f,y:h*d}:{x:h*d,y:m*f}})}const Wte=function(e){return e===void 0&&(e=0),{name:"offset",options:e,fn(r){return E(this,null,function*(){var n,a;const{x:i,y:o,placement:l,middlewareData:c}=r,d=yield Vte(r,e);return l===((n=c.offset)==null?void 0:n.placement)&&(a=c.arrow)!=null&&a.alignmentOffset?{}:{x:i+d.x,y:o+d.y,data:V(D({},d),{placement:l})}})}}},Hte=function(e){return e===void 0&&(e={}),{name:"shift",options:e,fn(r){return E(this,null,function*(){const{x:n,y:a,placement:i}=r,_=Ic(e,r),{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:w=>{let{x:b,y:N}=w;return{x:b,y:N}}}}=_,d=ge(_,["mainAxis","crossAxis","limiter"]),f={x:n,y:a},u=yield Ov(r,d),h=bl($c(i)),m=qP(h);let v=f[m],g=f[h];if(o){const w=m==="y"?"top":"left",b=m==="y"?"bottom":"right",N=v+u[w],S=v-u[b];v=n2(N,v,S)}if(l){const w=h==="y"?"top":"left",b=h==="y"?"bottom":"right",N=g+u[w],S=g-u[b];g=n2(N,g,S)}const x=c.fn(V(D({},r),{[m]:v,[h]:g}));return V(D({},x),{data:{x:x.x-n,y:x.y-a,enabled:{[m]:o,[h]:l}}})})}}},Gte=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:i,middlewareData:o}=t,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=Ic(e,t),f={x:r,y:n},u=bl(a),h=qP(u);let m=f[h],v=f[u];const g=Ic(l,t),x=typeof g=="number"?{mainAxis:g,crossAxis:0}:D({mainAxis:0,crossAxis:0},g);if(c){const b=h==="y"?"height":"width",N=i.reference[h]-i.floating[b]+x.mainAxis,S=i.reference[h]+i.reference[b]-x.mainAxis;m<N?m=N:m>S&&(m=S)}if(d){var _,w;const b=h==="y"?"width":"height",N=xz.has($c(a)),S=i.reference[u]-i.floating[b]+(N&&((_=o.offset)==null?void 0:_[u])||0)+(N?0:x.crossAxis),k=i.reference[u]+i.reference[b]+(N?0:((w=o.offset)==null?void 0:w[u])||0)-(N?x.crossAxis:0);v<S?v=S:v>k&&(v=k)}return{[h]:m,[u]:v}}}},Yte=function(e){return e===void 0&&(e={}),{name:"size",options:e,fn(r){return E(this,null,function*(){var n,a;const{placement:i,rects:o,platform:l,elements:c}=r,O=Ic(e,r),{apply:d=()=>{}}=O,f=ge(O,["apply"]),u=yield Ov(r,f),h=$c(i),m=vp(i),v=bl(i)==="y",{width:g,height:x}=o.floating;let _,w;h==="top"||h==="bottom"?(_=h,w=m===((yield l.isRTL==null?void 0:l.isRTL(c.floating))?"start":"end")?"left":"right"):(w=h,_=m==="end"?"top":"bottom");const b=x-u.top-u.bottom,N=g-u.left-u.right,S=Wd(x-u[_],b),k=Wd(g-u[w],N),C=!r.middlewareData.shift;let A=S,R=k;if((n=r.middlewareData.shift)!=null&&n.enabled.x&&(R=N),(a=r.middlewareData.shift)!=null&&a.enabled.y&&(A=b),C&&!m){const z=Ti(u.left,0),M=Ti(u.right,0),B=Ti(u.top,0),F=Ti(u.bottom,0);v?R=g-2*(z!==0||M!==0?z+M:Ti(u.left,u.right)):A=x-2*(B!==0||F!==0?B+F:Ti(u.top,u.bottom))}yield d(V(D({},r),{availableWidth:R,availableHeight:A}));const I=yield l.getDimensions(c.floating);return g!==I.width||x!==I.height?{reset:{rects:!0}}:{}})}}};function Gb(){return typeof window!="undefined"}function yp(e){return _z(e)?(e.nodeName||"").toLowerCase():"#document"}function Ii(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Vl(e){var t;return(t=(_z(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function _z(e){return Gb()?e instanceof Node||e instanceof Ii(e).Node:!1}function Zo(e){return Gb()?e instanceof Element||e instanceof Ii(e).Element:!1}function Bl(e){return Gb()?e instanceof HTMLElement||e instanceof Ii(e).HTMLElement:!1}function qO(e){return!Gb()||typeof ShadowRoot=="undefined"?!1:e instanceof ShadowRoot||e instanceof Ii(e).ShadowRoot}const Kte=new Set(["inline","contents"]);function Vy(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=Xo(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!Kte.has(a)}const Zte=new Set(["table","td","th"]);function Xte(e){return Zte.has(yp(e))}const Jte=[":popover-open",":modal"];function Yb(e){return Jte.some(t=>{try{return e.matches(t)}catch(r){return!1}})}const Qte=["transform","translate","scale","rotate","perspective"],ere=["transform","translate","scale","rotate","perspective","filter"],tre=["paint","layout","strict","content"];function HP(e){const t=GP(),r=Zo(e)?Xo(e):e;return Qte.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||ere.some(n=>(r.willChange||"").includes(n))||tre.some(n=>(r.contain||"").includes(n))}function rre(e){let t=Hd(e);for(;Bl(t)&&!bm(t);){if(HP(t))return t;if(Yb(t))return null;t=Hd(t)}return null}function GP(){return typeof CSS=="undefined"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const nre=new Set(["html","body","#document"]);function bm(e){return nre.has(yp(e))}function Xo(e){return Ii(e).getComputedStyle(e)}function Kb(e){return Zo(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Hd(e){if(yp(e)==="html")return e;const t=e.assignedSlot||e.parentNode||qO(e)&&e.host||Vl(e);return qO(t)?t.host:t}function wz(e){const t=Hd(e);return bm(t)?e.ownerDocument?e.ownerDocument.body:e.body:Bl(t)&&Vy(t)?t:wz(t)}function Mv(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=wz(e),i=a===((n=e.ownerDocument)==null?void 0:n.body),o=Ii(a);if(i){const l=a2(o);return t.concat(o,o.visualViewport||[],Vy(a)?a:[],l&&r?Mv(l):[])}return t.concat(a,Mv(a,[],r))}function a2(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function bz(e){const t=Xo(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Bl(e),i=a?e.offsetWidth:r,o=a?e.offsetHeight:n,l=K_(r)!==i||K_(n)!==o;return l&&(r=i,n=o),{width:r,height:n,$:l}}function YP(e){return Zo(e)?e:e.contextElement}function Yh(e){const t=YP(e);if(!Bl(t))return Ml(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:i}=bz(t);let o=(i?K_(r.width):r.width)/n,l=(i?K_(r.height):r.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const sre=Ml(0);function jz(e){const t=Ii(e);return!GP()||!t.visualViewport?sre:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function are(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Ii(e)?!1:t}function ff(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),i=YP(e);let o=Ml(1);t&&(n?Zo(n)&&(o=Yh(n)):o=Yh(e));const l=are(i,r,n)?jz(i):Ml(0);let c=(a.left+l.x)/o.x,d=(a.top+l.y)/o.y,f=a.width/o.x,u=a.height/o.y;if(i){const h=Ii(i),m=n&&Zo(n)?Ii(n):n;let v=h,g=a2(v);for(;g&&n&&m!==v;){const x=Yh(g),_=g.getBoundingClientRect(),w=Xo(g),b=_.left+(g.clientLeft+parseFloat(w.paddingLeft))*x.x,N=_.top+(g.clientTop+parseFloat(w.paddingTop))*x.y;c*=x.x,d*=x.y,f*=x.x,u*=x.y,c+=b,d+=N,v=Ii(g),g=a2(v)}}return X_({width:f,height:u,x:c,y:d})}function KP(e,t){const r=Kb(e).scrollLeft;return t?t.left+r:ff(Vl(e)).left+r}function Nz(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:KP(e,n)),i=n.top+t.scrollTop;return{x:a,y:i}}function ire(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const i=a==="fixed",o=Vl(n),l=t?Yb(t.floating):!1;if(n===o||l&&i)return r;let c={scrollLeft:0,scrollTop:0},d=Ml(1);const f=Ml(0),u=Bl(n);if((u||!u&&!i)&&((yp(n)!=="body"||Vy(o))&&(c=Kb(n)),Bl(n))){const m=ff(n);d=Yh(n),f.x=m.x+n.clientLeft,f.y=m.y+n.clientTop}const h=o&&!u&&!i?Nz(o,c,!0):Ml(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-c.scrollLeft*d.x+f.x+h.x,y:r.y*d.y-c.scrollTop*d.y+f.y+h.y}}function ore(e){return Array.from(e.getClientRects())}function lre(e){const t=Vl(e),r=Kb(e),n=e.ownerDocument.body,a=Ti(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=Ti(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+KP(e);const l=-r.scrollTop;return Xo(n).direction==="rtl"&&(o+=Ti(t.clientWidth,n.clientWidth)-a),{width:a,height:i,x:o,y:l}}function cre(e,t){const r=Ii(e),n=Vl(e),a=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,l=0,c=0;if(a){i=a.width,o=a.height;const d=GP();(!d||d&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:i,height:o,x:l,y:c}}const dre=new Set(["absolute","fixed"]);function ure(e,t){const r=ff(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,i=Bl(e)?Yh(e):Ml(1),o=e.clientWidth*i.x,l=e.clientHeight*i.y,c=a*i.x,d=n*i.y;return{width:o,height:l,x:c,y:d}}function VO(e,t,r){let n;if(t==="viewport")n=cre(e,r);else if(t==="document")n=lre(Vl(e));else if(Zo(t))n=ure(t,r);else{const a=jz(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return X_(n)}function Sz(e,t){const r=Hd(e);return r===t||!Zo(r)||bm(r)?!1:Xo(r).position==="fixed"||Sz(r,t)}function fre(e,t){const r=t.get(e);if(r)return r;let n=Mv(e,[],!1).filter(l=>Zo(l)&&yp(l)!=="body"),a=null;const i=Xo(e).position==="fixed";let o=i?Hd(e):e;for(;Zo(o)&&!bm(o);){const l=Xo(o),c=HP(o);!c&&l.position==="fixed"&&(a=null),(i?!c&&!a:!c&&l.position==="static"&&!!a&&dre.has(a.position)||Vy(o)&&!c&&Sz(e,o))?n=n.filter(f=>f!==o):a=l,o=Hd(o)}return t.set(e,n),n}function hre(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const o=[...r==="clippingAncestors"?Yb(t)?[]:fre(t,this._c):[].concat(r),n],l=o[0],c=o.reduce((d,f)=>{const u=VO(t,f,a);return d.top=Ti(u.top,d.top),d.right=Wd(u.right,d.right),d.bottom=Wd(u.bottom,d.bottom),d.left=Ti(u.left,d.left),d},VO(t,l,a));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function mre(e){const{width:t,height:r}=bz(e);return{width:t,height:r}}function pre(e,t,r){const n=Bl(t),a=Vl(t),i=r==="fixed",o=ff(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=Ml(0);function d(){c.x=KP(a)}if(n||!n&&!i)if((yp(t)!=="body"||Vy(a))&&(l=Kb(t)),n){const m=ff(t,!0,i,t);c.x=m.x+t.clientLeft,c.y=m.y+t.clientTop}else a&&d();i&&!n&&a&&d();const f=a&&!n&&!i?Nz(a,l):Ml(0),u=o.left+l.scrollLeft-c.x-f.x,h=o.top+l.scrollTop-c.y-f.y;return{x:u,y:h,width:o.width,height:o.height}}function PN(e){return Xo(e).position==="static"}function WO(e,t){if(!Bl(e)||Xo(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Vl(e)===r&&(r=r.ownerDocument.body),r}function kz(e,t){const r=Ii(e);if(Yb(e))return r;if(!Bl(e)){let a=Hd(e);for(;a&&!bm(a);){if(Zo(a)&&!PN(a))return a;a=Hd(a)}return r}let n=WO(e,t);for(;n&&Xte(n)&&PN(n);)n=WO(n,t);return n&&bm(n)&&PN(n)&&!HP(n)?r:n||rre(e)||r}const gre=function(e){return E(this,null,function*(){const t=this.getOffsetParent||kz,r=this.getDimensions,n=yield r(e.floating);return{reference:pre(e.reference,yield t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}})};function vre(e){return Xo(e).direction==="rtl"}const yre={convertOffsetParentRelativeRectToViewportRelativeRect:ire,getDocumentElement:Vl,getClippingRect:hre,getOffsetParent:kz,getElementRects:gre,getClientRects:ore,getDimensions:mre,getScale:Yh,isElement:Zo,isRTL:vre};function Ez(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function xre(e,t){let r=null,n;const a=Vl(e);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const d=e.getBoundingClientRect(),{left:f,top:u,width:h,height:m}=d;if(l||t(),!h||!m)return;const v=vx(u),g=vx(a.clientWidth-(f+h)),x=vx(a.clientHeight-(u+m)),_=vx(f),b={rootMargin:-v+"px "+-g+"px "+-x+"px "+-_+"px",threshold:Ti(0,Wd(1,c))||1};let N=!0;function S(k){const C=k[0].intersectionRatio;if(C!==c){if(!N)return o();C?o(!1,C):n=setTimeout(()=>{o(!1,1e-7)},1e3)}C===1&&!Ez(d,e.getBoundingClientRect())&&o(),N=!1}try{r=new IntersectionObserver(S,V(D({},b),{root:a.ownerDocument}))}catch(k){r=new IntersectionObserver(S,b)}r.observe(e)}return o(!0),i}function _re(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,d=YP(e),f=a||i?[...d?Mv(d):[],...Mv(t)]:[];f.forEach(_=>{a&&_.addEventListener("scroll",r,{passive:!0}),i&&_.addEventListener("resize",r)});const u=d&&l?xre(d,r):null;let h=-1,m=null;o&&(m=new ResizeObserver(_=>{let[w]=_;w&&w.target===d&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=m)==null||b.observe(t)})),r()}),d&&!c&&m.observe(d),m.observe(t));let v,g=c?ff(e):null;c&&x();function x(){const _=ff(e);g&&!Ez(g,_)&&r(),g=_,v=requestAnimationFrame(x)}return r(),()=>{var _;f.forEach(w=>{a&&w.removeEventListener("scroll",r),i&&w.removeEventListener("resize",r)}),u==null||u(),(_=m)==null||_.disconnect(),m=null,c&&cancelAnimationFrame(v)}}const wre=Wte,bre=Hte,jre=Ute,Nre=Yte,Sre=qte,HO=Bte,kre=Gte,Ere=(e,t,r)=>{const n=new Map,a=D({platform:yre},r),i=V(D({},a.platform),{_c:n});return zte(e,t,V(D({},a),{platform:i}))};var Cre=typeof document!="undefined",Pre=function(){},f_=Cre?y.useLayoutEffect:Pre;function J_(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!J_(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const i=a[n];if(!(i==="_owner"&&e.$$typeof)&&!J_(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function Cz(e){return typeof window=="undefined"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function GO(e,t){const r=Cz(e);return Math.round(t*r)/r}function TN(e){const t=y.useRef(e);return f_(()=>{t.current=e}),t}function Tre(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[f,u]=y.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=y.useState(n);J_(h,n)||m(n);const[v,g]=y.useState(null),[x,_]=y.useState(null),w=y.useCallback(q=>{q!==k.current&&(k.current=q,g(q))},[]),b=y.useCallback(q=>{q!==C.current&&(C.current=q,_(q))},[]),N=i||v,S=o||x,k=y.useRef(null),C=y.useRef(null),A=y.useRef(f),R=c!=null,I=TN(c),O=TN(a),z=TN(d),M=y.useCallback(()=>{if(!k.current||!C.current)return;const q={placement:t,strategy:r,middleware:h};O.current&&(q.platform=O.current),Ere(k.current,C.current,q).then(K=>{const Z=V(D({},K),{isPositioned:z.current!==!1});B.current&&!J_(A.current,Z)&&(A.current=Z,ao.flushSync(()=>{u(Z)}))})},[h,t,r,O,z]);f_(()=>{d===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,u(q=>V(D({},q),{isPositioned:!1})))},[d]);const B=y.useRef(!1);f_(()=>(B.current=!0,()=>{B.current=!1}),[]),f_(()=>{if(N&&(k.current=N),S&&(C.current=S),N&&S){if(I.current)return I.current(N,S,M);M()}},[N,S,M,I,R]);const F=y.useMemo(()=>({reference:k,floating:C,setReference:w,setFloating:b}),[w,b]),U=y.useMemo(()=>({reference:N,floating:S}),[N,S]),H=y.useMemo(()=>{const q={position:r,left:0,top:0};if(!U.floating)return q;const K=GO(U.floating,f.x),Z=GO(U.floating,f.y);return l?D(V(D({},q),{transform:"translate("+K+"px, "+Z+"px)"}),Cz(U.floating)>=1.5&&{willChange:"transform"}):{position:r,left:K,top:Z}},[r,l,U.floating,f.x,f.y]);return y.useMemo(()=>V(D({},f),{update:M,refs:F,elements:U,floatingStyles:H}),[f,M,F,U,H])}const Are=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?HO({element:n.current,padding:a}).fn(r):{}:n?HO({element:n,padding:a}).fn(r):{}}}},Rre=(e,t)=>V(D({},wre(e)),{options:[e,t]}),Ore=(e,t)=>V(D({},bre(e)),{options:[e,t]}),Mre=(e,t)=>V(D({},kre(e)),{options:[e,t]}),Dre=(e,t)=>V(D({},jre(e)),{options:[e,t]}),Ire=(e,t)=>V(D({},Nre(e)),{options:[e,t]}),$re=(e,t)=>V(D({},Sre(e)),{options:[e,t]}),Lre=(e,t)=>V(D({},Are(e)),{options:[e,t]});var Fre="Arrow",Pz=y.forwardRef((e,t)=>{const o=e,{children:r,width:n=10,height:a=5}=o,i=ge(o,["children","width","height"]);return s.jsx(Pt.svg,V(D({},i),{ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:s.jsx("polygon",{points:"0,0 30,0 15,10"})}))});Pz.displayName=Fre;var zre=Pz;function Zb(e){const[t,r]=y.useState(void 0);return xs(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,d=Array.isArray(c)?c[0]:c;o=d.inlineSize,l=d.blockSize}else o=e.offsetWidth,l=e.offsetHeight;r({width:o,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var ZP="Popper",[Tz,Qd]=$s(ZP),[Bre,Az]=Tz(ZP),Rz=e=>{const{__scopePopper:t,children:r}=e,[n,a]=y.useState(null);return s.jsx(Bre,{scope:t,anchor:n,onAnchorChange:a,children:r})};Rz.displayName=ZP;var Oz="PopperAnchor",Mz=y.forwardRef((e,t)=>{const c=e,{__scopePopper:r,virtualRef:n}=c,a=ge(c,["__scopePopper","virtualRef"]),i=Az(Oz,r),o=y.useRef(null),l=mr(t,o);return y.useEffect(()=>{i.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:s.jsx(Pt.div,V(D({},a),{ref:l}))});Mz.displayName=Oz;var XP="PopperContent",[Ure,qre]=Tz(XP),Dz=y.forwardRef((e,t)=>{var Q,oe,ie,ee,G,J,ae,fe;const xe=e,{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:f=0,sticky:u="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:v}=xe,g=ge(xe,["__scopePopper","side","sideOffset","align","alignOffset","arrowPadding","avoidCollisions","collisionBoundary","collisionPadding","sticky","hideWhenDetached","updatePositionStrategy","onPlaced"]),x=Az(XP,r),[_,w]=y.useState(null),b=mr(t,we=>w(we)),[N,S]=y.useState(null),k=Zb(N),C=(Q=k==null?void 0:k.width)!=null?Q:0,A=(oe=k==null?void 0:k.height)!=null?oe:0,R=n+(i!=="center"?"-"+i:""),I=typeof f=="number"?f:D({top:0,right:0,bottom:0,left:0},f),O=Array.isArray(d)?d:[d],z=O.length>0,M={padding:I,boundary:O.filter(Wre),altBoundary:z},{refs:B,floatingStyles:F,placement:U,isPositioned:H,middlewareData:q}=Tre({strategy:"fixed",placement:R,whileElementsMounted:(...we)=>_re(...we,{animationFrame:m==="always"}),elements:{reference:x.anchor},middleware:[Rre({mainAxis:a+A,alignmentAxis:o}),c&&Ore(D({mainAxis:!0,crossAxis:!1,limiter:u==="partial"?Mre():void 0},M)),c&&Dre(D({},M)),Ire(V(D({},M),{apply:({elements:we,rects:ve,availableWidth:me,availableHeight:Me})=>{const{width:Te,height:Ve}=ve.reference,le=we.floating.style;le.setProperty("--radix-popper-available-width",`${me}px`),le.setProperty("--radix-popper-available-height",`${Me}px`),le.setProperty("--radix-popper-anchor-width",`${Te}px`),le.setProperty("--radix-popper-anchor-height",`${Ve}px`)}})),N&&Lre({element:N,padding:l}),Hre({arrowWidth:C,arrowHeight:A}),h&&$re(D({strategy:"referenceHidden"},M))]}),[K,Z]=Lz(U),ne=ys(v);xs(()=>{H&&(ne==null||ne())},[H,ne]);const Y=(ie=q.arrow)==null?void 0:ie.x,X=(ee=q.arrow)==null?void 0:ee.y,se=((G=q.arrow)==null?void 0:G.centerOffset)!==0,[de,_e]=y.useState();return xs(()=>{_&&_e(window.getComputedStyle(_).zIndex)},[_]),s.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:D(V(D({},F),{transform:H?F.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:de,"--radix-popper-transform-origin":[(J=q.transformOrigin)==null?void 0:J.x,(ae=q.transformOrigin)==null?void 0:ae.y].join(" ")}),((fe=q.hide)==null?void 0:fe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}),dir:e.dir,children:s.jsx(Ure,{scope:r,placedSide:K,onArrowChange:S,arrowX:Y,arrowY:X,shouldHideArrow:se,children:s.jsx(Pt.div,V(D({"data-side":K,"data-align":Z},g),{ref:b,style:V(D({},g.style),{animation:H?void 0:"none"})}))})})});Dz.displayName=XP;var Iz="PopperArrow",Vre={top:"bottom",right:"left",bottom:"top",left:"right"},$z=y.forwardRef(function(t,r){const l=t,{__scopePopper:n}=l,a=ge(l,["__scopePopper"]),i=qre(Iz,n),o=Vre[i.placedSide];return s.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:s.jsx(zre,V(D({},a),{ref:r,style:V(D({},a.style),{display:"block"})}))})});$z.displayName=Iz;function Wre(e){return e!==null}var Hre=e=>({name:"transformOrigin",options:e,fn(t){var x,_,w,b,N;const{placement:r,rects:n,middlewareData:a}=t,o=((x=a.arrow)==null?void 0:x.centerOffset)!==0,l=o?0:e.arrowWidth,c=o?0:e.arrowHeight,[d,f]=Lz(r),u={start:"0%",center:"50%",end:"100%"}[f],h=((w=(_=a.arrow)==null?void 0:_.x)!=null?w:0)+l/2,m=((N=(b=a.arrow)==null?void 0:b.y)!=null?N:0)+c/2;let v="",g="";return d==="bottom"?(v=o?u:`${h}px`,g=`${-c}px`):d==="top"?(v=o?u:`${h}px`,g=`${n.floating.height+c}px`):d==="right"?(v=`${-c}px`,g=o?u:`${m}px`):d==="left"&&(v=`${n.floating.width+c}px`,g=o?u:`${m}px`),{data:{x:v,y:g}}}});function Lz(e){const[t,r="center"]=e.split("-");return[t,r]}var Xb=Rz,Wy=Mz,Jb=Dz,Qb=$z,[e1,qBe]=$s("Tooltip",[Qd]),t1=Qd(),Fz="TooltipProvider",Gre=700,i2="tooltip.open",[Yre,JP]=e1(Fz),zz=e=>{const{__scopeTooltip:t,delayDuration:r=Gre,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:i}=e,o=y.useRef(!0),l=y.useRef(!1),c=y.useRef(0);return y.useEffect(()=>{const d=c.current;return()=>window.clearTimeout(d)},[]),s.jsx(Yre,{scope:t,isOpenDelayedRef:o,delayDuration:r,onOpen:y.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:y.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:y.useCallback(d=>{l.current=d},[]),disableHoverableContent:a,children:i})};zz.displayName=Fz;var Dv="Tooltip",[Kre,r1]=e1(Dv),Bz=e=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:a,onOpenChange:i,disableHoverableContent:o,delayDuration:l}=e,c=JP(Dv,e.__scopeTooltip),d=t1(t),[f,u]=y.useState(null),h=Os(),m=y.useRef(0),v=o!=null?o:c.disableHoverableContent,g=l!=null?l:c.delayDuration,x=y.useRef(!1),[_,w]=Ya({prop:n,defaultProp:a!=null?a:!1,onChange:C=>{C?(c.onOpen(),document.dispatchEvent(new CustomEvent(i2))):c.onClose(),i==null||i(C)},caller:Dv}),b=y.useMemo(()=>_?x.current?"delayed-open":"instant-open":"closed",[_]),N=y.useCallback(()=>{window.clearTimeout(m.current),m.current=0,x.current=!1,w(!0)},[w]),S=y.useCallback(()=>{window.clearTimeout(m.current),m.current=0,w(!1)},[w]),k=y.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{x.current=!0,w(!0),m.current=0},g)},[g,w]);return y.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),s.jsx(Xb,V(D({},d),{children:s.jsx(Kre,{scope:t,contentId:h,open:_,stateAttribute:b,trigger:f,onTriggerChange:u,onTriggerEnter:y.useCallback(()=>{c.isOpenDelayedRef.current?k():N()},[c.isOpenDelayedRef,k,N]),onTriggerLeave:y.useCallback(()=>{v?S():(window.clearTimeout(m.current),m.current=0)},[S,v]),onOpen:N,onClose:S,disableHoverableContent:v,children:r})}))};Bz.displayName=Dv;var o2="TooltipTrigger",Uz=y.forwardRef((e,t)=>{const h=e,{__scopeTooltip:r}=h,n=ge(h,["__scopeTooltip"]),a=r1(o2,r),i=JP(o2,r),o=t1(r),l=y.useRef(null),c=mr(t,l,a.onTriggerChange),d=y.useRef(!1),f=y.useRef(!1),u=y.useCallback(()=>d.current=!1,[]);return y.useEffect(()=>()=>document.removeEventListener("pointerup",u),[u]),s.jsx(Wy,V(D({asChild:!0},o),{children:s.jsx(Pt.button,V(D({"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute},n),{ref:c,onPointerMove:mt(e.onPointerMove,m=>{m.pointerType!=="touch"&&!f.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),f.current=!0)}),onPointerLeave:mt(e.onPointerLeave,()=>{a.onTriggerLeave(),f.current=!1}),onPointerDown:mt(e.onPointerDown,()=>{a.open&&a.onClose(),d.current=!0,document.addEventListener("pointerup",u,{once:!0})}),onFocus:mt(e.onFocus,()=>{d.current||a.onOpen()}),onBlur:mt(e.onBlur,a.onClose),onClick:mt(e.onClick,a.onClose)}))}))});Uz.displayName=o2;var Zre="TooltipPortal",[VBe,Xre]=e1(Zre,{forceMount:void 0}),jm="TooltipContent",qz=y.forwardRef((e,t)=>{const r=Xre(jm,e.__scopeTooltip),l=e,{forceMount:n=r.forceMount,side:a="top"}=l,i=ge(l,["forceMount","side"]),o=r1(jm,e.__scopeTooltip);return s.jsx(Ks,{present:n||o.open,children:o.disableHoverableContent?s.jsx(Vz,V(D({side:a},i),{ref:t})):s.jsx(Jre,V(D({side:a},i),{ref:t}))})}),Jre=y.forwardRef((e,t)=>{const r=r1(jm,e.__scopeTooltip),n=JP(jm,e.__scopeTooltip),a=y.useRef(null),i=mr(t,a),[o,l]=y.useState(null),{trigger:c,onClose:d}=r,f=a.current,{onPointerInTransitChange:u}=n,h=y.useCallback(()=>{l(null),u(!1)},[u]),m=y.useCallback((v,g)=>{const x=v.currentTarget,_={x:v.clientX,y:v.clientY},w=nne(_,x.getBoundingClientRect()),b=sne(_,w),N=ane(g.getBoundingClientRect()),S=one([...b,...N]);l(S),u(!0)},[u]);return y.useEffect(()=>()=>h(),[h]),y.useEffect(()=>{if(c&&f){const v=x=>m(x,f),g=x=>m(x,c);return c.addEventListener("pointerleave",v),f.addEventListener("pointerleave",g),()=>{c.removeEventListener("pointerleave",v),f.removeEventListener("pointerleave",g)}}},[c,f,m,h]),y.useEffect(()=>{if(o){const v=g=>{const x=g.target,_={x:g.clientX,y:g.clientY},w=(c==null?void 0:c.contains(x))||(f==null?void 0:f.contains(x)),b=!ine(_,o);w?h():b&&(h(),d())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[c,f,o,d,h]),s.jsx(Vz,V(D({},e),{ref:i}))}),[Qre,ene]=e1(Dv,{isInside:!1}),tne=bF("TooltipContent"),Vz=y.forwardRef((e,t)=>{const u=e,{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o}=u,l=ge(u,["__scopeTooltip","children","aria-label","onEscapeKeyDown","onPointerDownOutside"]),c=r1(jm,r),d=t1(r),{onClose:f}=c;return y.useEffect(()=>(document.addEventListener(i2,f),()=>document.removeEventListener(i2,f)),[f]),y.useEffect(()=>{if(c.trigger){const h=m=>{const v=m.target;v!=null&&v.contains(c.trigger)&&f()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[c.trigger,f]),s.jsx(Cf,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:f,children:s.jsxs(Jb,V(D(D({"data-state":c.stateAttribute},d),l),{ref:t,style:V(D({},l.style),{"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}),children:[s.jsx(tne,{children:n}),s.jsx(Qre,{scope:r,isInside:!0,children:s.jsx(uQ,{id:c.contentId,role:"tooltip",children:a||n})})]}))})});qz.displayName=jm;var Wz="TooltipArrow",rne=y.forwardRef((e,t)=>{const o=e,{__scopeTooltip:r}=o,n=ge(o,["__scopeTooltip"]),a=t1(r);return ene(Wz,r).isInside?null:s.jsx(Qb,V(D(D({},a),n),{ref:t}))});rne.displayName=Wz;function nne(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,n,a,i)){case i:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function sne(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function ane(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function ine(e,t){const{x:r,y:n}=e;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],c=t[o],d=l.x,f=l.y,u=c.x,h=c.y;f>n!=h>n&&r<(u-d)*(n-f)/(h-f)+d&&(a=!a)}return a}function one(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),lne(t)}function lne(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var cne=zz,dne=Bz,une=Uz,Hz=qz;const QP=cne,Gz=dne,Yz=une,eT=y.forwardRef((a,n)=>{var i=a,{className:e,sideOffset:t=4}=i,r=ge(i,["className","sideOffset"]);return s.jsx(Hz,D({ref:n,sideOffset:t,className:Oe("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e)},r))});eT.displayName=Hz.displayName;var n1=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},s1=typeof window=="undefined"||"Deno"in globalThis;function Eo(){}function fne(e,t){return typeof e=="function"?e(t):e}function hne(e){return typeof e=="number"&&e>=0&&e!==1/0}function mne(e,t){return Math.max(e+(t||0)-Date.now(),0)}function l2(e,t){return typeof e=="function"?e(t):e}function pne(e,t){return typeof e=="function"?e(t):e}function YO(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:i,queryKey:o,stale:l}=e;if(o){if(n){if(t.queryHash!==tT(o,t.options))return!1}else if(!$v(t.queryKey,o))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||i&&!i(t))}function KO(e,t){const{exact:r,status:n,predicate:a,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Iv(t.options.mutationKey)!==Iv(i))return!1}else if(!$v(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function tT(e,t){return((t==null?void 0:t.queryKeyHashFn)||Iv)(e)}function Iv(e){return JSON.stringify(e,(t,r)=>c2(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function $v(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>$v(e[r],t[r])):!1}function Kz(e,t){if(e===t)return e;const r=ZO(e)&&ZO(t);if(r||c2(e)&&c2(t)){const n=r?e:Object.keys(e),a=n.length,i=r?t:Object.keys(t),o=i.length,l=r?[]:{},c=new Set(n);let d=0;for(let f=0;f<o;f++){const u=r?f:i[f];(!r&&c.has(u)||r)&&e[u]===void 0&&t[u]===void 0?(l[u]=void 0,d++):(l[u]=Kz(e[u],t[u]),l[u]===e[u]&&e[u]!==void 0&&d++)}return a===o&&d===a?e:l}return t}function ZO(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function c2(e){if(!XO(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!XO(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function XO(e){return Object.prototype.toString.call(e)==="[object Object]"}function gne(e){return new Promise(t=>{setTimeout(t,e)})}function vne(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Kz(e,t):t}function yne(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function xne(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var rT=Symbol();function Zz(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===rT?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Vu,vd,om,eL,_ne=(eL=class extends n1{constructor(){super();bn(this,Vu);bn(this,vd);bn(this,om);Tr(this,om,t=>{if(!s1&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){it(this,vd)||this.setEventListener(it(this,om))}onUnsubscribe(){var t;this.hasListeners()||((t=it(this,vd))==null||t.call(this),Tr(this,vd,void 0))}setEventListener(t){var r;Tr(this,om,t),(r=it(this,vd))==null||r.call(this),Tr(this,vd,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){it(this,Vu)!==t&&(Tr(this,Vu,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof it(this,Vu)=="boolean"?it(this,Vu):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Vu=new WeakMap,vd=new WeakMap,om=new WeakMap,eL),Xz=new _ne,lm,yd,cm,tL,wne=(tL=class extends n1{constructor(){super();bn(this,lm,!0);bn(this,yd);bn(this,cm);Tr(this,cm,t=>{if(!s1&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){it(this,yd)||this.setEventListener(it(this,cm))}onUnsubscribe(){var t;this.hasListeners()||((t=it(this,yd))==null||t.call(this),Tr(this,yd,void 0))}setEventListener(t){var r;Tr(this,cm,t),(r=it(this,yd))==null||r.call(this),Tr(this,yd,t(this.setOnline.bind(this)))}setOnline(t){it(this,lm)!==t&&(Tr(this,lm,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return it(this,lm)}},lm=new WeakMap,yd=new WeakMap,cm=new WeakMap,tL),Q_=new wne;function bne(){let e,t;const r=new Promise((a,i)=>{e=a,t=i});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}function jne(e){return Math.min(1e3*Qp(2,e),3e4)}function Jz(e){return(e!=null?e:"online")==="online"?Q_.isOnline():!0}var Qz=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function AN(e){return e instanceof Qz}function e9(e){let t=!1,r=0,n=!1,a;const i=bne(),o=g=>{var x;n||(h(new Qz(g)),(x=e.abort)==null||x.call(e))},l=()=>{t=!0},c=()=>{t=!1},d=()=>Xz.isFocused()&&(e.networkMode==="always"||Q_.isOnline())&&e.canRun(),f=()=>Jz(e.networkMode)&&e.canRun(),u=g=>{var x;n||(n=!0,(x=e.onSuccess)==null||x.call(e,g),a==null||a(),i.resolve(g))},h=g=>{var x;n||(n=!0,(x=e.onError)==null||x.call(e,g),a==null||a(),i.reject(g))},m=()=>new Promise(g=>{var x;a=_=>{(n||d())&&g(_)},(x=e.onPause)==null||x.call(e)}).then(()=>{var g;a=void 0,n||(g=e.onContinue)==null||g.call(e)}),v=()=>{if(n)return;let g;const x=r===0?e.initialPromise:void 0;try{g=x!=null?x:e.fn()}catch(_){g=Promise.reject(_)}Promise.resolve(g).then(u).catch(_=>{var k,C,A;if(n)return;const w=(k=e.retry)!=null?k:s1?0:3,b=(C=e.retryDelay)!=null?C:jne,N=typeof b=="function"?b(r,_):b,S=w===!0||typeof w=="number"&&r<w||typeof w=="function"&&w(r,_);if(t||!S){h(_);return}r++,(A=e.onFail)==null||A.call(e,r,_),gne(N).then(()=>d()?void 0:m()).then(()=>{t?h(_):v()})})};return{promise:i,cancel:o,continue:()=>(a==null||a(),i),cancelRetry:l,continueRetry:c,canStart:f,start:()=>(f()?v():m().then(v),i)}}var Nne=e=>setTimeout(e,0);function Sne(){let e=[],t=0,r=l=>{l()},n=l=>{l()},a=Nne;const i=l=>{t?e.push(l):a(()=>{r(l)})},o=()=>{const l=e;e=[],l.length&&a(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{a=l}}}var qa=Sne(),Wu,rL,t9=(rL=class{constructor(){bn(this,Wu)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),hne(this.gcTime)&&Tr(this,Wu,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e!=null?e:s1?1/0:5*60*1e3)}clearGcTimeout(){it(this,Wu)&&(clearTimeout(it(this,Wu)),Tr(this,Wu,void 0))}},Wu=new WeakMap,rL),dm,Hu,Wi,Gu,Sa,My,Yu,Co,sc,nL,kne=(nL=class extends t9{constructor(t){var r;super();bn(this,Co);bn(this,dm);bn(this,Hu);bn(this,Wi);bn(this,Gu);bn(this,Sa);bn(this,My);bn(this,Yu);Tr(this,Yu,!1),Tr(this,My,t.defaultOptions),this.setOptions(t.options),this.observers=[],Tr(this,Gu,t.client),Tr(this,Wi,it(this,Gu).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Tr(this,dm,Cne(this.options)),this.state=(r=t.state)!=null?r:it(this,dm),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=it(this,Sa))==null?void 0:t.promise}setOptions(t){this.options=D(D({},it(this,My)),t),this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&it(this,Wi).remove(this)}setData(t,r){const n=vne(this.state.data,t,this.options);return wa(this,Co,sc).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){wa(this,Co,sc).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=it(this,Sa))==null?void 0:n.promise;return(a=it(this,Sa))==null||a.cancel(t),r?r.then(Eo).catch(Eo):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(it(this,dm))}isActive(){return this.observers.some(t=>pne(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===rT||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>l2(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!mne(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=it(this,Sa))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=it(this,Sa))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),it(this,Wi).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(it(this,Sa)&&(it(this,Yu)?it(this,Sa).cancel({revert:!0}):it(this,Sa).cancelRetry()),this.scheduleGc()),it(this,Wi).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||wa(this,Co,sc).call(this,{type:"invalidate"})}fetch(t,r){var d,f,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(it(this,Sa))return it(this,Sa).continueRetry(),it(this,Sa).promise}if(t&&this.setOptions(t),!this.options.queryFn){const h=this.observers.find(m=>m.options.queryFn);h&&this.setOptions(h.options)}const n=new AbortController,a=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(Tr(this,Yu,!0),n.signal)})},i=()=>{const h=Zz(this.options,r),v=(()=>{const g={client:it(this,Gu),queryKey:this.queryKey,meta:this.meta};return a(g),g})();return Tr(this,Yu,!1),this.options.persister?this.options.persister(h,v,this):h(v)},l=(()=>{const h={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:it(this,Gu),state:this.state,fetchFn:i};return a(h),h})();(d=this.options.behavior)==null||d.onFetch(l,this),Tr(this,Hu,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&wa(this,Co,sc).call(this,{type:"fetch",meta:(u=l.fetchOptions)==null?void 0:u.meta});const c=h=>{var m,v,g,x;AN(h)&&h.silent||wa(this,Co,sc).call(this,{type:"error",error:h}),AN(h)||((v=(m=it(this,Wi).config).onError)==null||v.call(m,h,this),(x=(g=it(this,Wi).config).onSettled)==null||x.call(g,this.state.data,h,this)),this.scheduleGc()};return Tr(this,Sa,e9({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:h=>{var m,v,g,x;if(h===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(_){c(_);return}(v=(m=it(this,Wi).config).onSuccess)==null||v.call(m,h,this),(x=(g=it(this,Wi).config).onSettled)==null||x.call(g,h,this.state.error,this),this.scheduleGc()},onError:c,onFail:(h,m)=>{wa(this,Co,sc).call(this,{type:"failed",failureCount:h,error:m})},onPause:()=>{wa(this,Co,sc).call(this,{type:"pause"})},onContinue:()=>{wa(this,Co,sc).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),it(this,Sa).start()}},dm=new WeakMap,Hu=new WeakMap,Wi=new WeakMap,Gu=new WeakMap,Sa=new WeakMap,My=new WeakMap,Yu=new WeakMap,Co=new WeakSet,sc=function(t){const r=n=>{var a,i;switch(t.type){case"failed":return V(D({},n),{fetchFailureCount:t.failureCount,fetchFailureReason:t.error});case"pause":return V(D({},n),{fetchStatus:"paused"});case"continue":return V(D({},n),{fetchStatus:"fetching"});case"fetch":return V(D(D({},n),Ene(n.data,this.options)),{fetchMeta:(a=t.meta)!=null?a:null});case"success":return Tr(this,Hu,void 0),D(V(D({},n),{data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:(i=t.dataUpdatedAt)!=null?i:Date.now(),error:null,isInvalidated:!1,status:"success"}),!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null});case"error":const o=t.error;return AN(o)&&o.revert&&it(this,Hu)?V(D({},it(this,Hu)),{fetchStatus:"idle"}):V(D({},n),{error:o,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"});case"invalidate":return V(D({},n),{isInvalidated:!0});case"setState":return D(D({},n),t.state)}};this.state=r(this.state),qa.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),it(this,Wi).notify({query:this,type:"updated",action:t})})},nL);function Ene(e,t){return D({fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Jz(t.networkMode)?"fetching":"paused"},e===void 0&&{error:null,status:"pending"})}function Cne(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n!=null?n:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var ml,sL,Pne=(sL=class extends n1{constructor(t={}){super();bn(this,ml);this.config=t,Tr(this,ml,new Map)}build(t,r,n){var l;const a=r.queryKey,i=(l=r.queryHash)!=null?l:tT(a,r);let o=this.get(i);return o||(o=new kne({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(o)),o}add(t){it(this,ml).has(t.queryHash)||(it(this,ml).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=it(this,ml).get(t.queryHash);r&&(t.destroy(),r===t&&it(this,ml).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){qa.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return it(this,ml).get(t)}getAll(){return[...it(this,ml).values()]}find(t){const r=D({exact:!0},t);return this.getAll().find(n=>YO(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>YO(t,n)):r}notify(t){qa.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){qa.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){qa.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ml=new WeakMap,sL),pl,za,Ku,gl,ad,aL,Tne=(aL=class extends t9{constructor(t){super();bn(this,gl);bn(this,pl);bn(this,za);bn(this,Ku);this.mutationId=t.mutationId,Tr(this,za,t.mutationCache),Tr(this,pl,[]),this.state=t.state||Ane(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){it(this,pl).includes(t)||(it(this,pl).push(t),this.clearGcTimeout(),it(this,za).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Tr(this,pl,it(this,pl).filter(r=>r!==t)),this.scheduleGc(),it(this,za).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){it(this,pl).length||(this.state.status==="pending"?this.scheduleGc():it(this,za).remove(this))}continue(){var t,r;return(r=(t=it(this,Ku))==null?void 0:t.continue())!=null?r:this.execute(this.state.variables)}execute(t){return E(this,null,function*(){var i,o,l,c,d,f,u,h,m,v,g,x,_,w,b,N,S,k,C,A,R;const r=()=>{wa(this,gl,ad).call(this,{type:"continue"})};Tr(this,Ku,e9({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(I,O)=>{wa(this,gl,ad).call(this,{type:"failed",failureCount:I,error:O})},onPause:()=>{wa(this,gl,ad).call(this,{type:"pause"})},onContinue:r,retry:(i=this.options.retry)!=null?i:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>it(this,za).canRun(this)}));const n=this.state.status==="pending",a=!it(this,Ku).canStart();try{if(n)r();else{wa(this,gl,ad).call(this,{type:"pending",variables:t,isPaused:a}),yield(l=(o=it(this,za).config).onMutate)==null?void 0:l.call(o,t,this);const O=yield(d=(c=this.options).onMutate)==null?void 0:d.call(c,t);O!==this.state.context&&wa(this,gl,ad).call(this,{type:"pending",context:O,variables:t,isPaused:a})}const I=yield it(this,Ku).start();return yield(u=(f=it(this,za).config).onSuccess)==null?void 0:u.call(f,I,t,this.state.context,this),yield(m=(h=this.options).onSuccess)==null?void 0:m.call(h,I,t,this.state.context),yield(g=(v=it(this,za).config).onSettled)==null?void 0:g.call(v,I,null,this.state.variables,this.state.context,this),yield(_=(x=this.options).onSettled)==null?void 0:_.call(x,I,null,t,this.state.context),wa(this,gl,ad).call(this,{type:"success",data:I}),I}catch(I){try{throw yield(b=(w=it(this,za).config).onError)==null?void 0:b.call(w,I,t,this.state.context,this),yield(S=(N=this.options).onError)==null?void 0:S.call(N,I,t,this.state.context),yield(C=(k=it(this,za).config).onSettled)==null?void 0:C.call(k,void 0,I,this.state.variables,this.state.context,this),yield(R=(A=this.options).onSettled)==null?void 0:R.call(A,void 0,I,t,this.state.context),I}finally{wa(this,gl,ad).call(this,{type:"error",error:I})}}finally{it(this,za).runNext(this)}})}},pl=new WeakMap,za=new WeakMap,Ku=new WeakMap,gl=new WeakSet,ad=function(t){const r=n=>{switch(t.type){case"failed":return V(D({},n),{failureCount:t.failureCount,failureReason:t.error});case"pause":return V(D({},n),{isPaused:!0});case"continue":return V(D({},n),{isPaused:!1});case"pending":return V(D({},n),{context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()});case"success":return V(D({},n),{data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1});case"error":return V(D({},n),{data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"})}};this.state=r(this.state),qa.batch(()=>{it(this,pl).forEach(n=>{n.onMutationUpdate(t)}),it(this,za).notify({mutation:this,type:"updated",action:t})})},aL);function Ane(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var uc,Po,Dy,iL,Rne=(iL=class extends n1{constructor(t={}){super();bn(this,uc);bn(this,Po);bn(this,Dy);this.config=t,Tr(this,uc,new Set),Tr(this,Po,new Map),Tr(this,Dy,0)}build(t,r,n){const a=new Tne({mutationCache:this,mutationId:++Z0(this,Dy)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){it(this,uc).add(t);const r=yx(t);if(typeof r=="string"){const n=it(this,Po).get(r);n?n.push(t):it(this,Po).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(it(this,uc).delete(t)){const r=yx(t);if(typeof r=="string"){const n=it(this,Po).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&it(this,Po).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=yx(t);if(typeof r=="string"){const n=it(this,Po).get(r),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n,a;const r=yx(t);if(typeof r=="string"){const i=(n=it(this,Po).get(r))==null?void 0:n.find(o=>o!==t&&o.state.isPaused);return(a=i==null?void 0:i.continue())!=null?a:Promise.resolve()}else return Promise.resolve()}clear(){qa.batch(()=>{it(this,uc).forEach(t=>{this.notify({type:"removed",mutation:t})}),it(this,uc).clear(),it(this,Po).clear()})}getAll(){return Array.from(it(this,uc))}find(t){const r=D({exact:!0},t);return this.getAll().find(n=>KO(r,n))}findAll(t={}){return this.getAll().filter(r=>KO(t,r))}notify(t){qa.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return qa.batch(()=>Promise.all(t.map(r=>r.continue().catch(Eo))))}},uc=new WeakMap,Po=new WeakMap,Dy=new WeakMap,iL);function yx(e){var t;return(t=e.options.scope)==null?void 0:t.id}function JO(e){return{onFetch:(t,r)=>{var f,u,h,m,v;const n=t.options,a=(h=(u=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:u.fetchMore)==null?void 0:h.direction,i=((m=t.state.data)==null?void 0:m.pages)||[],o=((v=t.state.data)==null?void 0:v.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=()=>E(this,null,function*(){var b;let g=!1;const x=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},_=Zz(t.options,t.fetchOptions),w=(N,S,k)=>E(this,null,function*(){if(g)return Promise.reject();if(S==null&&N.pages.length)return Promise.resolve(N);const A=(()=>{const z={client:t.client,queryKey:t.queryKey,pageParam:S,direction:k?"backward":"forward",meta:t.options.meta};return x(z),z})(),R=yield _(A),{maxPages:I}=t.options,O=k?xne:yne;return{pages:O(N.pages,R,I),pageParams:O(N.pageParams,S,I)}});if(a&&i.length){const N=a==="backward",S=N?One:QO,k={pages:i,pageParams:o},C=S(n,k);l=yield w(k,C,N)}else{const N=e!=null?e:i.length;do{const S=c===0?(b=o[0])!=null?b:n.initialPageParam:QO(n,l);if(c>0&&S==null)break;l=yield w(l,S),c++}while(c<N)}return l});t.options.persister?t.fetchFn=()=>{var g,x;return(x=(g=t.options).persister)==null?void 0:x.call(g,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=d}}}function QO(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function One(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var hs,xd,_d,um,fm,wd,hm,mm,oL,Mne=(oL=class{constructor(e={}){bn(this,hs);bn(this,xd);bn(this,_d);bn(this,um);bn(this,fm);bn(this,wd);bn(this,hm);bn(this,mm);Tr(this,hs,e.queryCache||new Pne),Tr(this,xd,e.mutationCache||new Rne),Tr(this,_d,e.defaultOptions||{}),Tr(this,um,new Map),Tr(this,fm,new Map),Tr(this,wd,0)}mount(){Z0(this,wd)._++,it(this,wd)===1&&(Tr(this,hm,Xz.subscribe(e=>E(this,null,function*(){e&&(yield this.resumePausedMutations(),it(this,hs).onFocus())}))),Tr(this,mm,Q_.subscribe(e=>E(this,null,function*(){e&&(yield this.resumePausedMutations(),it(this,hs).onOnline())}))))}unmount(){var e,t;Z0(this,wd)._--,it(this,wd)===0&&((e=it(this,hm))==null||e.call(this),Tr(this,hm,void 0),(t=it(this,mm))==null||t.call(this),Tr(this,mm,void 0))}isFetching(e){return it(this,hs).findAll(V(D({},e),{fetchStatus:"fetching"})).length}isMutating(e){return it(this,xd).findAll(V(D({},e),{status:"pending"})).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=it(this,hs).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=it(this,hs).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(l2(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return it(this,hs).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=it(this,hs).get(n.queryHash),i=a==null?void 0:a.state.data,o=fne(t,i);if(o!==void 0)return it(this,hs).build(this,n).setData(o,V(D({},r),{manual:!0}))}setQueriesData(e,t,r){return qa.batch(()=>it(this,hs).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=it(this,hs).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=it(this,hs);qa.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=it(this,hs);return qa.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries(D({type:"active"},e),t)))}cancelQueries(e,t={}){const r=D({revert:!0},t),n=qa.batch(()=>it(this,hs).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(Eo).catch(Eo)}invalidateQueries(e,t={}){return qa.batch(()=>{var r,n;return it(this,hs).findAll(e).forEach(a=>{a.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries(V(D({},e),{type:(n=(r=e==null?void 0:e.refetchType)!=null?r:e==null?void 0:e.type)!=null?n:"active"}),t)})}refetchQueries(e,t={}){var a;const r=V(D({},t),{cancelRefetch:(a=t.cancelRefetch)!=null?a:!0}),n=qa.batch(()=>it(this,hs).findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let o=i.fetch(void 0,r);return r.throwOnError||(o=o.catch(Eo)),i.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(Eo)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=it(this,hs).build(this,t);return r.isStaleByTime(l2(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Eo).catch(Eo)}fetchInfiniteQuery(e){return e.behavior=JO(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Eo).catch(Eo)}ensureInfiniteQueryData(e){return e.behavior=JO(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Q_.isOnline()?it(this,xd).resumePausedMutations():Promise.resolve()}getQueryCache(){return it(this,hs)}getMutationCache(){return it(this,xd)}getDefaultOptions(){return it(this,_d)}setDefaultOptions(e){Tr(this,_d,e)}setQueryDefaults(e,t){it(this,um).set(Iv(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...it(this,um).values()],r={};return t.forEach(n=>{$v(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){it(this,fm).set(Iv(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...it(this,fm).values()],r={};return t.forEach(n=>{$v(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t=V(D(D(D({},it(this,_d).queries),this.getQueryDefaults(e.queryKey)),e),{_defaulted:!0});return t.queryHash||(t.queryHash=tT(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===rT&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:V(D(D(D({},it(this,_d).mutations),(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey)),e),{_defaulted:!0})}clear(){it(this,hs).clear(),it(this,xd).clear()}},hs=new WeakMap,xd=new WeakMap,_d=new WeakMap,um=new WeakMap,fm=new WeakMap,wd=new WeakMap,hm=new WeakMap,mm=new WeakMap,oL),Dne=y.createContext(void 0),Ine=({client:e,children:t})=>(y.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),s.jsx(Dne.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Lv(){return Lv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lv.apply(this,arguments)}var Nd;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Nd||(Nd={}));const eM="popstate";function $ne(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:o,hash:l}=n.location;return d2("",{pathname:i,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:n9(a)}return Fne(t,r,null,e)}function Ms(e,t){if(e===!1||e===null||typeof e=="undefined")throw new Error(t)}function r9(e,t){if(!e){typeof console!="undefined"&&console.warn(t);try{throw new Error(t)}catch(r){}}}function Lne(){return Math.random().toString(36).substr(2,8)}function tM(e,t){return{usr:e.state,key:e.key,idx:t}}function d2(e,t,r,n){return r===void 0&&(r=null),Lv({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?xp(t):t,{state:r,key:t&&t.key||n||Lne()})}function n9(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function xp(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Fne(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,l=Nd.Pop,c=null,d=f();d==null&&(d=0,o.replaceState(Lv({},o.state,{idx:d}),""));function f(){return(o.state||{idx:null}).idx}function u(){l=Nd.Pop;let x=f(),_=x==null?null:x-d;d=x,c&&c({action:l,location:g.location,delta:_})}function h(x,_){l=Nd.Push;let w=d2(g.location,x,_);d=f()+1;let b=tM(w,d),N=g.createHref(w);try{o.pushState(b,"",N)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;a.location.assign(N)}i&&c&&c({action:l,location:g.location,delta:1})}function m(x,_){l=Nd.Replace;let w=d2(g.location,x,_);d=f();let b=tM(w,d),N=g.createHref(w);o.replaceState(b,"",N),i&&c&&c({action:l,location:g.location,delta:0})}function v(x){let _=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof x=="string"?x:n9(x);return w=w.replace(/ $/,"%20"),Ms(_,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,_)}let g={get action(){return l},get location(){return e(a,o)},listen(x){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(eM,u),c=x,()=>{a.removeEventListener(eM,u),c=null}},createHref(x){return t(a,x)},createURL:v,encodeLocation(x){let _=v(x);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:h,replace:m,go(x){return o.go(x)}};return g}var rM;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(rM||(rM={}));function zne(e,t,r){return r===void 0&&(r="/"),Bne(e,t,r,!1)}function Bne(e,t,r,n){let a=typeof t=="string"?xp(t):t,i=i9(a.pathname||"/",r);if(i==null)return null;let o=s9(e);Une(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=Qne(i);l=Xne(o[c],d,n)}return l}function s9(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Ms(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Ju([n,c.relativePath]),f=r.concat(c);i.children&&i.children.length>0&&(Ms(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),s9(i.children,t,f,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:Kne(d,i.index),routesMeta:f})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,o);else for(let c of a9(i.path))a(i,o,c)}),t}function a9(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=a9(n.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function Une(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Zne(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const qne=/^:[\w-]+$/,Vne=3,Wne=2,Hne=1,Gne=10,Yne=-2,nM=e=>e==="*";function Kne(e,t){let r=e.split("/"),n=r.length;return r.some(nM)&&(n+=Yne),t&&(n+=Wne),r.filter(a=>!nM(a)).reduce((a,i)=>a+(qne.test(i)?Vne:i===""?Hne:Gne),n)}function Zne(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function Xne(e,t,r){let{routesMeta:n}=e,a={},i="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,f=i==="/"?t:t.slice(i.length)||"/",u=sM({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},f),h=c.route;if(!u&&d&&r&&!n[n.length-1].route.index&&(u=sM({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},f)),!u)return null;Object.assign(a,u.params),o.push({params:a,pathname:Ju([i,u.pathname]),pathnameBase:nse(Ju([i,u.pathnameBase])),route:h}),u.pathnameBase!=="/"&&(i=Ju([i,u.pathnameBase]))}return o}function sM(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Jne(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((d,f,u)=>{let{paramName:h,isOptional:m}=f;if(h==="*"){let g=l[u]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const v=l[u];return m&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:e}}function Jne(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),r9(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function Qne(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return r9(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function i9(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function ese(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?xp(e):e;return{pathname:r?r.startsWith("/")?r:tse(r,t):t,search:sse(n),hash:ase(a)}}function tse(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function RN(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function rse(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function o9(e,t){let r=rse(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function l9(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=xp(e):(a=Lv({},e),Ms(!a.pathname||!a.pathname.includes("?"),RN("?","pathname","search",a)),Ms(!a.pathname||!a.pathname.includes("#"),RN("#","pathname","hash",a)),Ms(!a.search||!a.search.includes("#"),RN("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=r;else{let u=t.length-1;if(!n&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),u-=1;a.pathname=h.join("/")}l=u>=0?t[u]:"/"}let c=ese(a,l),d=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||f)&&(c.pathname+="/"),c}const Ju=e=>e.join("/").replace(/\/\/+/g,"/"),nse=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),sse=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ase=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ise(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const c9=["post","put","patch","delete"];new Set(c9);const ose=["get",...c9];new Set(ose);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fv(){return Fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fv.apply(this,arguments)}const nT=y.createContext(null),lse=y.createContext(null),Hy=y.createContext(null),a1=y.createContext(null),eu=y.createContext({outlet:null,matches:[],isDataRoute:!1}),d9=y.createContext(null);function Gy(){return y.useContext(a1)!=null}function Vc(){return Gy()||Ms(!1),y.useContext(a1).location}function u9(e){y.useContext(Hy).static||y.useLayoutEffect(e)}function ts(){let{isDataRoute:e}=y.useContext(eu);return e?wse():cse()}function cse(){Gy()||Ms(!1);let e=y.useContext(nT),{basename:t,future:r,navigator:n}=y.useContext(Hy),{matches:a}=y.useContext(eu),{pathname:i}=Vc(),o=JSON.stringify(o9(a,r.v7_relativeSplatPath)),l=y.useRef(!1);return u9(()=>{l.current=!0}),y.useCallback(function(d,f){if(f===void 0&&(f={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let u=l9(d,JSON.parse(o),i,f.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:Ju([t,u.pathname])),(f.replace?n.replace:n.push)(u,f.state,f)},[t,n,o,i,e])}function sT(){let{matches:e}=y.useContext(eu),t=e[e.length-1];return t?t.params:{}}function dse(e,t){return use(e,t)}function use(e,t,r,n){Gy()||Ms(!1);let{navigator:a}=y.useContext(Hy),{matches:i}=y.useContext(eu),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=Vc(),f;if(t){var u;let x=typeof t=="string"?xp(t):t;c==="/"||(u=x.pathname)!=null&&u.startsWith(c)||Ms(!1),f=x}else f=d;let h=f.pathname||"/",m=h;if(c!=="/"){let x=c.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(x.length).join("/")}let v=zne(e,{pathname:m}),g=gse(v&&v.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:Ju([c,a.encodeLocation?a.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:Ju([c,a.encodeLocation?a.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,r,n);return t&&g?y.createElement(a1.Provider,{value:{location:Fv({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Nd.Pop}},g):g}function fse(){let e=_se(),t=ise(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},t),r?y.createElement("pre",{style:a},r):null,null)}const hse=y.createElement(fse,null);class mse extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?y.createElement(eu.Provider,{value:this.props.routeContext},y.createElement(d9.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function pse(e){let{routeContext:t,match:r,children:n}=e,a=y.useContext(nT);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),y.createElement(eu.Provider,{value:t},n)}function gse(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(a=r)==null?void 0:a.errors;if(l!=null){let f=o.findIndex(u=>u.route.id&&(l==null?void 0:l[u.route.id])!==void 0);f>=0||Ms(!1),o=o.slice(0,Math.min(o.length,f+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<o.length;f++){let u=o[f];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(d=f),u.route.id){let{loaderData:h,errors:m}=r,v=u.route.loader&&h[u.route.id]===void 0&&(!m||m[u.route.id]===void 0);if(u.route.lazy||v){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((f,u,h)=>{let m,v=!1,g=null,x=null;r&&(m=l&&u.route.id?l[u.route.id]:void 0,g=u.route.errorElement||hse,c&&(d<0&&h===0?(v=!0,x=null):d===h&&(v=!0,x=u.route.hydrateFallbackElement||null)));let _=t.concat(o.slice(0,h+1)),w=()=>{let b;return m?b=g:v?b=x:u.route.Component?b=y.createElement(u.route.Component,null):u.route.element?b=u.route.element:b=f,y.createElement(pse,{match:u,routeContext:{outlet:f,matches:_,isDataRoute:r!=null},children:b})};return r&&(u.route.ErrorBoundary||u.route.errorElement||h===0)?y.createElement(mse,{location:r.location,revalidation:r.revalidation,component:g,error:m,children:w(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):w()},null)}var f9=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(f9||{}),ew=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ew||{});function vse(e){let t=y.useContext(nT);return t||Ms(!1),t}function yse(e){let t=y.useContext(lse);return t||Ms(!1),t}function xse(e){let t=y.useContext(eu);return t||Ms(!1),t}function h9(e){let t=xse(),r=t.matches[t.matches.length-1];return r.route.id||Ms(!1),r.route.id}function _se(){var e;let t=y.useContext(d9),r=yse(ew.UseRouteError),n=h9(ew.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function wse(){let{router:e}=vse(f9.UseNavigateStable),t=h9(ew.UseNavigateStable),r=y.useRef(!1);return u9(()=>{r.current=!0}),y.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Fv({fromRouteId:t},i)))},[e,t])}function bse(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function jse(e){let{to:t,replace:r,state:n,relative:a}=e;Gy()||Ms(!1);let{future:i,static:o}=y.useContext(Hy),{matches:l}=y.useContext(eu),{pathname:c}=Vc(),d=ts(),f=l9(t,o9(l,i.v7_relativeSplatPath),c,a==="path"),u=JSON.stringify(f);return y.useEffect(()=>d(JSON.parse(u),{replace:r,state:n,relative:a}),[d,u,a,r,n]),null}function As(e){Ms(!1)}function Nse(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Nd.Pop,navigator:i,static:o=!1,future:l}=e;Gy()&&Ms(!1);let c=t.replace(/^\/*/,"/"),d=y.useMemo(()=>({basename:c,navigator:i,static:o,future:Fv({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof n=="string"&&(n=xp(n));let{pathname:f="/",search:u="",hash:h="",state:m=null,key:v="default"}=n,g=y.useMemo(()=>{let x=i9(f,c);return x==null?null:{location:{pathname:x,search:u,hash:h,state:m,key:v},navigationType:a}},[c,f,u,h,m,v,a]);return g==null?null:y.createElement(Hy.Provider,{value:d},y.createElement(a1.Provider,{children:r,value:g}))}function m9(e){let{children:t,location:r}=e;return dse(u2(t),r)}new Promise(()=>{});function u2(e,t){t===void 0&&(t=[]);let r=[];return y.Children.forEach(e,(n,a)=>{if(!y.isValidElement(n))return;let i=[...t,a];if(n.type===y.Fragment){r.push.apply(r,u2(n.props.children,i));return}n.type!==As&&Ms(!1),!n.props.index||!n.props.children||Ms(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=u2(n.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Sse="6";try{window.__reactRouterVersion=Sse}catch(e){}const kse="startTransition",aM=IC[kse];function Ese(e){let{basename:t,children:r,future:n,window:a}=e,i=y.useRef();i.current==null&&(i.current=$ne({window:a,v5Compat:!0}));let o=i.current,[l,c]=y.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},f=y.useCallback(u=>{d&&aM?aM(()=>c(u)):c(u)},[c,d]);return y.useLayoutEffect(()=>o.listen(f),[o,f]),y.useEffect(()=>bse(n),[n]),y.createElement(Nse,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}var iM;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(iM||(iM={}));var oM;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(oM||(oM={}));const Cse=()=>{const{pathname:e}=Vc();return y.useEffect(()=>{window.scrollTo(0,0)},[e]),null},Pse=()=>{const e=Vc();return y.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),s.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),s.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},Tse="modulepreload",Ase=function(e,t){return new URL(e,t).href},lM={},Rr=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){const o=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(r.map(d=>{if(d=Ase(d,n),d in lM)return;lM[d]=!0;const f=d.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(!!n)for(let v=o.length-1;v>=0;v--){const g=o[v];if(g.href===d&&(!f||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${u}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":Tse,f||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),f)return new Promise((v,g)=>{m.addEventListener("load",v),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},Rse=e=>{let t;return e?t=e:typeof fetch=="undefined"?t=(...r)=>Rr(()=>E(void 0,null,function*(){const{default:n}=yield Promise.resolve().then(()=>_p);return{default:n}}),void 0,import.meta.url).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class aT extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Ose extends aT{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class cM extends aT{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class dM extends aT{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var f2;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(f2||(f2={}));var Mse=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(f){try{d(n.next(f))}catch(u){o(u)}}function c(f){try{d(n.throw(f))}catch(u){o(u)}}function d(f){f.done?i(f.value):a(f.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Dse{constructor(t,{headers:r={},customFetch:n,region:a=f2.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Rse(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Mse(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=r;let l={},{region:c}=r;c||(c=this.region);const d=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let f;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob!="undefined"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",f=o):typeof o=="string"?(l["Content-Type"]="text/plain",f=o):typeof FormData!="undefined"&&o instanceof FormData?f=o:(l["Content-Type"]="application/json",f=JSON.stringify(o)));const u=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),a),body:f}).catch(g=>{throw new Ose(g)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new cM(u);if(!u.ok)throw new dM(u);let m=((n=u.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),v;return m==="application/json"?v=yield u.json():m==="application/octet-stream"?v=yield u.blob():m==="text/event-stream"?v=u:m==="multipart/form-data"?v=yield u.formData():v=yield u.text(),{data:v,error:null,response:u}}catch(a){return{data:null,error:a,response:a instanceof dM||a instanceof cM?a.context:void 0}}})}}var li={},iT={},i1={},Yy={},o1={},l1={},Ise=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object")},Nm=Ise();const $se=Nm.fetch,p9=Nm.fetch.bind(Nm),g9=Nm.Headers,Lse=Nm.Request,Fse=Nm.Response,_p=Object.freeze(Object.defineProperty({__proto__:null,Headers:g9,Request:Lse,Response:Fse,default:p9,fetch:$se},Symbol.toStringTag,{value:"Module"})),zse=cZ(_p);var c1={};Object.defineProperty(c1,"__esModule",{value:!0});let Bse=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};c1.default=Bse;var v9=na&&na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(l1,"__esModule",{value:!0});const Use=v9(zse),qse=v9(c1);let Vse=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch=="undefined"?this.fetch=Use.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(i=>E(this,null,function*(){var o,l,c,d;let f=null,u=null,h=null,m=i.status,v=i.statusText;if(i.ok){if(this.method!=="HEAD"){const w=yield i.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?u=w:u=JSON.parse(w))}const x=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),_=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");x&&_&&_.length>1&&(h=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(f={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,m=406,v="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const x=yield i.text();try{f=JSON.parse(x),Array.isArray(f)&&i.status===404&&(u=[],f=null,m=200,v="OK")}catch(_){i.status===404&&x===""?(m=204,v="No Content"):f={message:x}}if(f&&this.isMaybeSingle&&(!((d=f==null?void 0:f.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,m=200,v="OK"),f&&this.shouldThrowOnError)throw new qse.default(f)}return{error:f,data:u,count:h,status:m,statusText:v}}));return this.shouldThrowOnError||(a=a.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};l1.default=Vse;var Wse=na&&na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o1,"__esModule",{value:!0});const Hse=Wse(l1);let Gse=class extends Hse.default{select(t){let r=!1;const n=(t!=null?t:"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n=="undefined"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const i=typeof a=="undefined"?"offset":`${a}.offset`,o=typeof a=="undefined"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};o1.default=Gse;var Yse=na&&na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Yy,"__esModule",{value:!0});const Kse=Yse(o1);let Zse=class extends Kse.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Yy.default=Zse;var Xse=na&&na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i1,"__esModule",{value:!0});const dg=Xse(Yy);let Jse=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let i=!1;const o=(t!=null?t:"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new dg.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var a;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new dg.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:i=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(c.length>0){const d=[...new Set(c)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new dg.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:r}={}){var n;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new dg.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new dg.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};i1.default=Jse;var y9=na&&na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(iT,"__esModule",{value:!0});const Qse=y9(i1),eae=y9(Yy);let tae=class x9{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new Qse.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new x9(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){var o;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;n||a?(l=n?"HEAD":"GET",Object.entries(r).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{c.searchParams.append(u,h)})):(l="POST",d=r);const f=new Headers(this.headers);return i&&f.set("Prefer",`count=${i}`),new eae.default({method:l,url:c,headers:f,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};iT.default=tae;var wp=na&&na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(li,"__esModule",{value:!0});li.PostgrestError=li.PostgrestBuilder=li.PostgrestTransformBuilder=li.PostgrestFilterBuilder=li.PostgrestQueryBuilder=li.PostgrestClient=void 0;const _9=wp(iT);li.PostgrestClient=_9.default;const w9=wp(i1);li.PostgrestQueryBuilder=w9.default;const b9=wp(Yy);li.PostgrestFilterBuilder=b9.default;const j9=wp(o1);li.PostgrestTransformBuilder=j9.default;const N9=wp(l1);li.PostgrestBuilder=N9.default;const S9=wp(c1);li.PostgrestError=S9.default;var rae=li.default={PostgrestClient:_9.default,PostgrestQueryBuilder:w9.default,PostgrestFilterBuilder:b9.default,PostgrestTransformBuilder:j9.default,PostgrestBuilder:N9.default,PostgrestError:S9.default};const{PostgrestClient:nae,PostgrestQueryBuilder:ZBe,PostgrestFilterBuilder:XBe,PostgrestTransformBuilder:JBe,PostgrestBuilder:QBe,PostgrestError:eUe}=rae;class sae{static detectEnvironment(){var t;if(typeof WebSocket!="undefined")return{type:"native",constructor:WebSocket};if(typeof globalThis!="undefined"&&typeof globalThis.WebSocket!="undefined")return{type:"native",constructor:globalThis.WebSocket};if(typeof global!="undefined"&&typeof global.WebSocket!="undefined")return{type:"native",constructor:global.WebSocket};if(typeof globalThis!="undefined"&&typeof globalThis.WebSocketPair!="undefined"&&typeof globalThis.WebSocket=="undefined")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis!="undefined"&&globalThis.EdgeRuntime||typeof navigator!="undefined"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process!="undefined"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket!="undefined"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch(t){return!1}}}const aae="2.15.5",iae=`realtime-js/${aae}`,oae="1.0.0",h2=1e4,lae=1e3,cae=100;var nv;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(nv||(nv={}));var Bs;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Bs||(Bs={}));var Ao;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ao||(Ao={}));var m2;(function(e){e.websocket="websocket"})(m2||(m2={}));var Nu;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Nu||(Nu={}));class dae{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(t.slice(o,o+a));o=o+a;const c=n.decode(t.slice(o,o+i));o=o+i;const d=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class k9{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Bn;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Bn||(Bn={}));const uM=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,o)=>(i[o]=uae(o,e,t,a),i),{})},uae=(e,t,r,n)=>{const a=t.find(l=>l.name===e),i=a==null?void 0:a.type,o=r[e];return i&&!n.includes(i)?E9(i,o):p2(o)},E9=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return pae(t,r)}switch(e){case Bn.bool:return fae(t);case Bn.float4:case Bn.float8:case Bn.int2:case Bn.int4:case Bn.int8:case Bn.numeric:case Bn.oid:return hae(t);case Bn.json:case Bn.jsonb:return mae(t);case Bn.timestamp:return gae(t);case Bn.abstime:case Bn.date:case Bn.daterange:case Bn.int4range:case Bn.int8range:case Bn.money:case Bn.reltime:case Bn.text:case Bn.time:case Bn.timestamptz:case Bn.timetz:case Bn.tsrange:case Bn.tstzrange:return p2(t);default:return p2(t)}},p2=e=>e,fae=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},hae=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},mae=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},pae=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch(l){i=o?o.split(","):[]}return i.map(l=>E9(t,l))}return e},gae=e=>typeof e=="string"?e.replace(" ","T"):e,C9=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class ON{constructor(t,r,n={},a=h2){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var fM;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(fM||(fM={}));class sv{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=sv.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=sv.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=sv.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(i,(d,f)=>{o[d]||(c[d]=f)}),this.map(o,(d,f)=>{const u=i[d];if(u){const h=f.map(x=>x.presence_ref),m=u.map(x=>x.presence_ref),v=f.filter(x=>m.indexOf(x.presence_ref)<0),g=u.filter(x=>h.indexOf(x.presence_ref)<0);v.length>0&&(l[d]=v),g.length>0&&(c[d]=g)}else l[d]=f}),this.syncDiff(i,{joins:l,leaves:c},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var d;const f=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),f.length>0){const u=t[l].map(m=>m.presence_ref),h=f.filter(m=>u.indexOf(m.presence_ref)<0);t[l].unshift(...h)}n(l,f,c)}),this.map(o,(l,c)=>{let d=t[l];if(!d)return;const f=c.map(u=>u.presence_ref);d=d.filter(u=>f.indexOf(u.presence_ref)<0),t[l]=d,a(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var hM;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(hM||(hM={}));var av;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(av||(av={}));var cc;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(cc||(cc={}));class oT{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Bs.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new ON(this,Ao.join,this.params,this.timeout),this.rejoinTimer=new k9(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Bs.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Bs.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Bs.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Bs.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Bs.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ao.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new sv(this),this.broadcastEndpointURL=C9(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Bs.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&a!==void 0?a:[],f=!!this.bindings[av.PRESENCE]&&this.bindings[av.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,u={},h={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:f}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(m=>t==null?void 0:t(cc.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(cc.CLOSED)),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",v=>E(this,[v],function*({postgres_changes:m}){var g;if(this.socket.setAuth(),m===void 0){t==null||t(cc.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,_=(g=x==null?void 0:x.length)!==null&&g!==void 0?g:0,w=[];for(let b=0;b<_;b++){const N=x[b],{filter:{event:S,schema:k,table:C,filter:A}}=N,R=m&&m[b];if(R&&R.event===S&&R.schema===k&&R.table===C&&R.filter===A)w.push(Object.assign(Object.assign({},N),{id:R.id}));else{this.unsubscribe(),this.state=Bs.errored,t==null||t(cc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(cc.SUBSCRIBED);return}})).receive("error",m=>{this.state=Bs.errored,t==null||t(cc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(cc.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(n){return E(this,arguments,function*(t,r={}){return yield this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)})}untrack(){return E(this,arguments,function*(t={}){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,r,n){return this.state===Bs.joined&&t===av.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}send(n){return E(this,arguments,function*(t,r={}){var a,i;if(!this._canPush()&&t.type==="broadcast"){const{event:o,payload:l}=t,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:l,private:this.private}]})};try{const f=yield this._fetchWithTimeout(this.broadcastEndpointURL,d,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return yield(i=f.body)===null||i===void 0?void 0:i.cancel(),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var l,c,d;const f=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&o("ok"),f.receive("ok",()=>o("ok")),f.receive("error",()=>o("error")),f.receive("timeout",()=>o("timed out"))})})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Bs.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ao.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new ON(this,Ao.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Bs.closed,this.bindings={}}_fetchWithTimeout(t,r,n){return E(this,null,function*(){const a=new AbortController,i=setTimeout(()=>a.abort(),n),o=yield this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),o})}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new ON(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>cae){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:f}=Ao;if(n&&[l,c,d,f].indexOf(o)>=0&&n!==this._joinRef())return;let h=this._onMessage(o,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(m=>{var v,g,x;return((v=m.filter)===null||v===void 0?void 0:v.event)==="*"||((x=(g=m.filter)===null||g===void 0?void 0:g.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===o}).map(m=>m.callback(h,n)):(i=this.bindings[o])===null||i===void 0||i.filter(m=>{var v,g,x,_,w,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const N=m.id,S=(v=m.filter)===null||v===void 0?void 0:v.event;return N&&((g=r.ids)===null||g===void 0?void 0:g.includes(N))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const N=(w=(_=m==null?void 0:m.filter)===null||_===void 0?void 0:_.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return N==="*"||N===((b=r==null?void 0:r.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof h=="object"&&"ids"in h){const v=h.data,{schema:g,table:x,commit_timestamp:_,type:w,errors:b}=v;h=Object.assign(Object.assign({},{schema:g,table:x,commit_timestamp:_,eventType:w,new:{},old:{},errors:b}),this._getPayloadRecords(v))}m.callback(h,n)})}_isClosed(){return this.state===Bs.closed}_isJoined(){return this.state===Bs.joined}_isJoining(){return this.state===Bs.joining}_isLeaving(){return this.state===Bs.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&oT.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ao.close,{},t)}_onError(t){this._on(Ao.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Bs.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=uM(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=uM(t.columns,t.old_record)),r}}const MN=()=>{},xx={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},vae=[1e3,2e3,5e3,1e4],yae=1e4,xae=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class _ae{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=h2,this.transport=null,this.heartbeatIntervalMs=xx.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=MN,this.ref=0,this.reconnectTimer=null,this.logger=MN,this.conn=null,this.sendBuffer=[],this.serializer=new dae,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch=="undefined"?i=(...o)=>Rr(()=>E(this,null,function*(){const{default:l}=yield Promise.resolve().then(()=>_p);return{default:l}}),void 0,import.meta.url).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${m2.websocket}`,this.httpEndpoint=C9(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=sae.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:oae}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r!=null?r:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}removeChannel(t){return E(this,null,function*(){const r=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),r})}removeAllChannels(){return E(this,null,function*(){const t=yield Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t})}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case nv.connecting:return Nu.Connecting;case nv.open:return Nu.Open;case nv.closing:return Nu.Closing;default:return Nu.Closed}}isConnected(){return this.connectionState()===Nu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new oT(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(t=null){return E(this,null,function*(){this._authPromise=this._performAuth(t);try{yield this._authPromise}finally{this._authPromise=null}})}sendHeartbeat(){return E(this,null,function*(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(lae,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},xx.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")})}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:i,ref:o}=r,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${n} ${a} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(a,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ao.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([xae],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}_performAuth(t=null){return E(this,null,function*(){let r;t?r=t:this.accessToken?r=yield this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:iae};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Ao.access_token,{access_token:r})}))})}_waitForAuthIfNeeded(){return E(this,null,function*(){this._authPromise&&(yield this._authPromise)})}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new k9(()=>E(this,null,function*(){setTimeout(()=>E(this,null,function*(){yield this._waitForAuthIfNeeded(),this.isConnected()||this.connect()}),xx.RECONNECT_DELAY)}),this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,i,o,l,c,d,f;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:h2,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:xx.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:MN,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:u=>vae[u-1]||yae,this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(u,h)=>h(JSON.stringify(u)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window!="undefined"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class lT extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Us(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class wae extends lT{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class g2 extends lT{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var bae=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(f){try{d(n.next(f))}catch(u){o(u)}}function c(f){try{d(n.throw(f))}catch(u){o(u)}}function d(f){f.done?i(f.value):a(f.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const P9=e=>{let t;return e?t=e:typeof fetch=="undefined"?t=(...r)=>Rr(()=>E(void 0,null,function*(){const{default:n}=yield Promise.resolve().then(()=>_p);return{default:n}}),void 0,import.meta.url).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},jae=()=>bae(void 0,void 0,void 0,function*(){return typeof Response=="undefined"?(yield Rr(()=>Promise.resolve().then(()=>_p),void 0,import.meta.url)).Response:Response}),v2=e=>{if(Array.isArray(e))return e.map(r=>v2(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=v2(n)}),t},Nae=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Pf=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(f){try{d(n.next(f))}catch(u){o(u)}}function c(f){try{d(n.throw(f))}catch(u){o(u)}}function d(f){f.done?i(f.value):a(f.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const DN=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Sae=(e,t,r)=>Pf(void 0,void 0,void 0,function*(){const n=yield jae();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const i=e.status||500,o=(a==null?void 0:a.statusCode)||i+"";t(new wae(DN(a),i,o))}).catch(a=>{t(new g2(DN(a),a))}):t(new g2(DN(e),e))}),kae=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(Nae(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function Ky(e,t,r,n,a,i){return Pf(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,kae(t,n,a,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Sae(c,l,n))})})}function tw(e,t,r,n){return Pf(this,void 0,void 0,function*(){return Ky(e,"GET",t,r,n)})}function ul(e,t,r,n,a){return Pf(this,void 0,void 0,function*(){return Ky(e,"POST",t,n,a,r)})}function y2(e,t,r,n,a){return Pf(this,void 0,void 0,function*(){return Ky(e,"PUT",t,n,a,r)})}function Eae(e,t,r,n){return Pf(this,void 0,void 0,function*(){return Ky(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function T9(e,t,r,n,a){return Pf(this,void 0,void 0,function*(){return Ky(e,"DELETE",t,n,a,r)})}var Fa=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(f){try{d(n.next(f))}catch(u){o(u)}}function c(f){try{d(n.throw(f))}catch(u){o(u)}}function d(f){f.done?i(f.value):a(f.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const Cae={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},mM={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Pae{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=P9(a)}uploadOrUpdate(t,r,n,a){return Fa(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},mM),a);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob!="undefined"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData!="undefined"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const d=this._removeEmptyFolders(r),f=this._getFinalPath(d),u=yield(t=="PUT"?y2:ul)(this.fetch,`${this.url}/object/${f}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:u.Id,fullPath:u.Key},error:null}}catch(i){if(Us(i))return{data:null,error:i};throw i}})}upload(t,r,n){return Fa(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Fa(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:mM.upsert},a),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob!="undefined"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData!="undefined"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,f["cache-control"]=`max-age=${d.cacheControl}`,f["content-type"]=d.contentType);const u=yield y2(this.fetch,l.toString(),c,{headers:f});return{data:{path:i,fullPath:u.Key},error:null}}catch(c){if(Us(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Fa(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield ul(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new lT("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(Us(n))return{data:null,error:n};throw n}})}update(t,r,n){return Fa(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Fa(this,void 0,void 0,function*(){try{return{data:yield ul(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Us(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Fa(this,void 0,void 0,function*(){try{return{data:{path:(yield ul(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Us(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Fa(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield ul(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(Us(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Fa(this,void 0,void 0,function*(){try{const a=yield ul(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(Us(a))return{data:null,error:a};throw a}})}download(t,r){return Fa(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)!="undefined"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield tw(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Us(l))return{data:null,error:l};throw l}})}info(t){return Fa(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield tw(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:v2(n),error:null}}catch(n){if(Us(n))return{data:null,error:n};throw n}})}exists(t){return Fa(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Eae(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Us(n)&&n instanceof g2){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const l=typeof(r==null?void 0:r.transform)!="undefined"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&a.push(c);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(t){return Fa(this,void 0,void 0,function*(){try{return{data:yield T9(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Us(r))return{data:null,error:r};throw r}})}list(t,r,n){return Fa(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Cae),r),{prefix:t||""});return{data:yield ul(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Us(a))return{data:null,error:a};throw a}})}listV2(t,r){return Fa(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield ul(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Us(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer!="undefined"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Tae="2.11.0",Aae={"X-Client-Info":`storage-js/${Tae}`};var Zf=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(f){try{d(n.next(f))}catch(u){o(u)}}function c(f){try{d(n.throw(f))}catch(u){o(u)}}function d(f){f.done?i(f.value):a(f.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Rae{constructor(t,r={},n,a){const i=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},Aae),r),this.fetch=P9(n)}listBuckets(){return Zf(this,void 0,void 0,function*(){try{return{data:yield tw(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Us(t))return{data:null,error:t};throw t}})}getBucket(t){return Zf(this,void 0,void 0,function*(){try{return{data:yield tw(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Us(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Zf(this,void 0,void 0,function*(){try{return{data:yield ul(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Us(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Zf(this,void 0,void 0,function*(){try{return{data:yield y2(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Us(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Zf(this,void 0,void 0,function*(){try{return{data:yield ul(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Us(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Zf(this,void 0,void 0,function*(){try{return{data:yield T9(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Us(r))return{data:null,error:r};throw r}})}}class Oae extends Rae{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new Pae(this.url,this.headers,t,this.fetch)}}const Mae="2.57.2";let zg="";typeof Deno!="undefined"?zg="deno":typeof document!="undefined"?zg="web":typeof navigator!="undefined"&&navigator.product==="ReactNative"?zg="react-native":zg="node";const Dae={"X-Client-Info":`supabase-js-${zg}/${Mae}`},Iae={headers:Dae},$ae={schema:"public"},Lae={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Fae={};var zae=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(f){try{d(n.next(f))}catch(u){o(u)}}function c(f){try{d(n.throw(f))}catch(u){o(u)}}function d(f){f.done?i(f.value):a(f.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const Bae=e=>{let t;return e?t=e:typeof fetch=="undefined"?t=p9:t=fetch,(...r)=>t(...r)},Uae=()=>typeof Headers=="undefined"?g9:Headers,qae=(e,t,r)=>{const n=Bae(r),a=Uae();return(i,o)=>zae(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let d=new a(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},o),{headers:d}))})};var Vae=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(f){try{d(n.next(f))}catch(u){o(u)}}function c(f){try{d(n.throw(f))}catch(u){o(u)}}function d(f){f.done?i(f.value):a(f.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};function Wae(e){return e.endsWith("/")?e:e+"/"}function Hae(e,t){var r,n;const{db:a,auth:i,realtime:o,global:l}=e,{db:c,auth:d,realtime:f,global:u}=t,h={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},f),o),storage:{},global:Object.assign(Object.assign(Object.assign({},u),l),{headers:Object.assign(Object.assign({},(r=u==null?void 0:u.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>Vae(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const A9="2.71.1",mh=30*1e3,x2=3,IN=x2*mh,Gae="http://localhost:9999",Yae="supabase.auth.token",Kae={"X-Client-Info":`gotrue-js/${A9}`},_2="X-Supabase-Api-Version",R9={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Zae=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Xae=10*60*1e3;class cT extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ir(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Jae extends cT{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Qae(e){return Ir(e)&&e.name==="AuthApiError"}class O9 extends cT{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class tu extends cT{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class id extends tu{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function eie(e){return Ir(e)&&e.name==="AuthSessionMissingError"}class _x extends tu{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class wx extends tu{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class bx extends tu{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function tie(e){return Ir(e)&&e.name==="AuthImplicitGrantRedirectError"}class pM extends tu{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class w2 extends tu{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function $N(e){return Ir(e)&&e.name==="AuthRetryableFetchError"}class gM extends tu{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class b2 extends tu{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const rw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),vM=` 	
\r=`.split(""),rie=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<vM.length;t+=1)e[vM[t].charCodeAt(0)]=-2;for(let t=0;t<rw.length;t+=1)e[rw[t].charCodeAt(0)]=t;return e})();function yM(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(rw[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(rw[n]),t.queuedBits-=6}}function M9(e,t,r){const n=rie[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function xM(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{aie(o,n,r)};for(let o=0;o<e.length;o+=1)M9(e.charCodeAt(o),a,i);return t.join("")}function nie(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function sie(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}nie(n,t)}}function aie(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function iie(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)M9(e.charCodeAt(a),r,n);return new Uint8Array(t)}function oie(e){const t=[];return sie(e,r=>t.push(r)),new Uint8Array(t)}function lie(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>yM(a,r,n)),yM(null,r,n),t.join("")}function cie(e){return Math.round(Date.now()/1e3)+e}function die(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const jo=()=>typeof window!="undefined"&&typeof document!="undefined",fu={tested:!1,writable:!1},D9=()=>{if(!jo())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch(t){return!1}if(fu.tested)return fu.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),fu.tested=!0,fu.writable=!0}catch(t){fu.tested=!0,fu.writable=!1}return fu.writable};function uie(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch(n){}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const I9=e=>{let t;return e?t=e:typeof fetch=="undefined"?t=(...r)=>Rr(()=>E(void 0,null,function*(){const{default:n}=yield Promise.resolve().then(()=>_p);return{default:n}}),void 0,import.meta.url).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},fie=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",ph=(e,t,r)=>E(void 0,null,function*(){yield e.setItem(t,JSON.stringify(r))}),hu=(e,t)=>E(void 0,null,function*(){const r=yield e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(n){return r}}),nd=(e,t)=>E(void 0,null,function*(){yield e.removeItem(t)});class d1{constructor(){this.promise=new d1.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}d1.promiseConstructor=Promise;function LN(e){const t=e.split(".");if(t.length!==3)throw new b2("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Zae.test(t[n]))throw new b2("JWT not in base64url format");return{header:JSON.parse(xM(t[0])),payload:JSON.parse(xM(t[1])),signature:iie(t[2]),raw:{header:t[0],payload:t[1]}}}function hie(e){return E(this,null,function*(){return yield new Promise(t=>{setTimeout(()=>t(null),e)})})}function mie(e,t){return new Promise((n,a)=>{E(this,null,function*(){for(let i=0;i<1/0;i++)try{const o=yield e(i);if(!t(i,null,o)){n(o);return}}catch(o){if(!t(i,o)){a(o);return}}})})}function pie(e){return("0"+e.toString(16)).substr(-2)}function gie(){const t=new Uint32Array(56);if(typeof crypto=="undefined"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,pie).join("")}function vie(e){return E(this,null,function*(){const r=new TextEncoder().encode(e),n=yield crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")})}function yie(e){return E(this,null,function*(){if(!(typeof crypto!="undefined"&&typeof crypto.subtle!="undefined"&&typeof TextEncoder!="undefined"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=yield vie(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}function Xf(e,t,r=!1){return E(this,null,function*(){const n=gie();let a=n;r&&(a+="/PASSWORD_RECOVERY"),yield ph(e,`${t}-code-verifier`,a);const i=yield yie(n);return[i,n===i?"plain":"s256"]})}const xie=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function _ie(e){const t=e.headers.get(_2);if(!t||!t.match(xie))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(r){return null}}function wie(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function bie(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const jie=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Jf(e){if(!jie.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function FN(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function _M(e){return JSON.parse(JSON.stringify(e))}var Nie=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const xu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Sie=[502,503,504];function wM(e){return E(this,null,function*(){var t;if(!fie(e))throw new w2(xu(e),0);if(Sie.includes(e.status))throw new w2(xu(e),e.status);let r;try{r=yield e.json()}catch(i){throw new O9(xu(i),i)}let n;const a=_ie(e);if(a&&a.getTime()>=R9["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new gM(xu(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new id}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new gM(xu(r),e.status,r.weak_password.reasons);throw new Jae(xu(r),e.status||500,n)})}const kie=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};function an(e,t,r,n){return E(this,null,function*(){var a;const i=Object.assign({},n==null?void 0:n.headers);i[_2]||(i[_2]=R9["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=yield Eie(e,t,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}})}function Eie(e,t,r,n,a,i){return E(this,null,function*(){const o=kie(t,n,a,i);let l;try{l=yield e(r,Object.assign({},o))}catch(c){throw console.error(c),new w2(xu(c),0)}if(l.ok||(yield wM(l)),n!=null&&n.noResolveJson)return l;try{return yield l.json()}catch(c){yield wM(c)}})}function ac(e){var t;let r=null;Aie(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=cie(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function bM(e){const t=ac(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function md(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Cie(e){return{data:e,error:null}}function Pie(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,o=Nie(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Tie(e){return e}function Aie(e){return e.access_token&&e.refresh_token&&e.expires_in}const zN=["global","local","others"];var Rie=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class Oie{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=I9(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(n){return E(this,arguments,function*(t,r=zN[0]){if(zN.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${zN.join(", ")}`);try{return yield an(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Ir(a))return{data:null,error:a};throw a}})}inviteUserByEmail(n){return E(this,arguments,function*(t,r={}){try{return yield an(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:md})}catch(a){if(Ir(a))return{data:{user:null},error:a};throw a}})}generateLink(t){return E(this,null,function*(){try{const{options:r}=t,n=Rie(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),yield an(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Pie,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ir(r))return{data:{properties:null,user:null},error:r};throw r}})}createUser(t){return E(this,null,function*(){try{return yield an(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:md})}catch(r){if(Ir(r))return{data:{user:null},error:r};throw r}})}listUsers(t){return E(this,null,function*(){var r,n,a,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},f=yield an(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:Tie});if(f.error)throw f.error;const u=yield f.json(),h=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(c=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(v.split(";")[1].split("=")[1]);d[`${x}Page`]=g}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},u),d),error:null}}catch(d){if(Ir(d))return{data:{users:[]},error:d};throw d}})}getUserById(t){return E(this,null,function*(){Jf(t);try{return yield an(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:md})}catch(r){if(Ir(r))return{data:{user:null},error:r};throw r}})}updateUserById(t,r){return E(this,null,function*(){Jf(t);try{return yield an(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:md})}catch(n){if(Ir(n))return{data:{user:null},error:n};throw n}})}deleteUser(t,r=!1){return E(this,null,function*(){Jf(t);try{return yield an(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:md})}catch(n){if(Ir(n))return{data:{user:null},error:n};throw n}})}_listFactors(t){return E(this,null,function*(){Jf(t.userId);try{const{data:r,error:n}=yield an(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Ir(r))return{data:null,error:r};throw r}})}_deleteFactor(t){return E(this,null,function*(){Jf(t.userId),Jf(t.id);try{return{data:yield an(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ir(r))return{data:null,error:r};throw r}})}}function jM(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function Mie(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){typeof self!="undefined"&&(self.globalThis=self)}}const Qf={debug:!!(globalThis&&D9()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class $9 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Die extends $9{}function Iie(e,t,r){return E(this,null,function*(){Qf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Qf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},a=>E(this,null,function*(){if(a){Qf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return yield r()}finally{Qf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Qf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Die(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Qf.debug)try{const i=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield r()}})))})}Mie();const $ie={url:Gae,storageKey:Yae,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Kae,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};function NM(e,t,r){return E(this,null,function*(){return yield r()})}const eh={};class zv{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=zv.nextInstanceID,zv.nextInstanceID+=1,this.instanceID>0&&jo()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},$ie),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Oie({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=I9(a.fetch),this.lock=a.lock||NM,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:jo()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Iie:this.lock=NM,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:D9()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=jM(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=jM(this.memoryStorage)),jo()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",i=>E(this,null,function*(){this._debug("received broadcast notification from other tab or client",i),yield this._notifyAllSubscribers(i.data.event,i.data.session,!1)}))}this.initialize()}get jwks(){var t,r;return(r=(t=eh[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){eh[this.storageKey]=Object.assign(Object.assign({},eh[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=eh[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){eh[this.storageKey]=Object.assign(Object.assign({},eh[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${A9}) ${new Date().toISOString()}`,...t),this}initialize(){return E(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=E(this,null,function*(){return yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._initialize()}))}),yield this.initializePromise)})}_initialize(){return E(this,null,function*(){var t;try{const r=uie(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":(yield this._isPKCECallback(r))&&(n="pkce"),jo()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=yield this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),tie(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return yield this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),yield this._saveSession(o),setTimeout(()=>E(this,null,function*(){l==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",o):yield this._notifyAllSubscribers("SIGNED_IN",o)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(r){return Ir(r)?{error:r}:{error:new O9("Unexpected error during initialization",r)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(t){return E(this,null,function*(){var r,n,a;try{const i=yield an(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:ac}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Ir(i))return{data:{user:null,session:null},error:i};throw i}})}signUp(t){return E(this,null,function*(){var r,n,a;try{let i;if("email"in t){const{email:f,password:u,options:h}=t;let m=null,v=null;this.flowType==="pkce"&&([m,v]=yield Xf(this.storage,this.storageKey)),i=yield an(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:f,password:u,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:v},xform:ac})}else if("phone"in t){const{phone:f,password:u,options:h}=t;i=yield an(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:u,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ac})}else throw new wx("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Ir(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithPassword(t){return E(this,null,function*(){try{let r;if("email"in t){const{email:i,password:o,options:l}=t;r=yield an(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:bM})}else if("phone"in t){const{phone:i,password:o,options:l}=t;r=yield an(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:bM})}else throw new wx("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new _x}:(n.session&&(yield this._saveSession(n.session),yield this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Ir(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOAuth(t){return E(this,null,function*(){var r,n,a,i;return yield this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})})}exchangeCodeForSession(t){return E(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>E(this,null,function*(){return this._exchangeCodeForSession(t)}))})}signInWithWeb3(t){return E(this,null,function*(){const{chain:r}=t;if(r==="solana")return yield this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)})}signInWithSolana(t){return E(this,null,function*(){var r,n,a,i,o,l,c,d,f,u,h,m;let v,g;if("message"in t)v=t.message,g=t.signature;else{const{chain:x,wallet:_,statement:w,options:b}=t;let N;if(jo())if(typeof _=="object")N=_;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))N=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=_}const S=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in N&&N.signIn){const k=yield N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),w?{statement:w}:null));let C;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")C=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)C=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)v=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),g=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${S.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(a=(n=b==null?void 0:b.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((u=(f=b==null?void 0:b.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||u===void 0)&&u.length?["Resources",...b.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const k=yield N.signMessage(new TextEncoder().encode(v),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=k}}try{const{data:x,error:_}=yield an(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:lie(g)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:ac});if(_)throw _;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new _x}:(x.session&&(yield this._saveSession(x.session),yield this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:_})}catch(x){if(Ir(x))return{data:{user:null,session:null},error:x};throw x}})}_exchangeCodeForSession(t){return E(this,null,function*(){const r=yield hu(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r!=null?r:"").split("/");try{const{data:i,error:o}=yield an(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:ac});if(yield nd(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new _x}:(i.session&&(yield this._saveSession(i.session),yield this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a!=null?a:null}),error:o})}catch(i){if(Ir(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}})}signInWithIdToken(t){return E(this,null,function*(){try{const{options:r,provider:n,token:a,access_token:i,nonce:o}=t,l=yield an(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ac}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new _x}:(c.session&&(yield this._saveSession(c.session),yield this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(Ir(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOtp(t){return E(this,null,function*(){var r,n,a,i,o;try{if("email"in t){const{email:l,options:c}=t;let d=null,f=null;this.flowType==="pkce"&&([d,f]=yield Xf(this.storage,this.storageKey));const{error:u}=yield an(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:f}=yield an(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:f}}throw new wx("You must provide either an email or phone number.")}catch(l){if(Ir(l))return{data:{user:null,session:null},error:l};throw l}})}verifyOtp(t){return E(this,null,function*(){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=yield an(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:ac});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(yield this._saveSession(c),yield this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Ir(a))return{data:{user:null,session:null},error:a};throw a}})}signInWithSSO(t){return E(this,null,function*(){var r,n,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=yield Xf(this.storage,this.storageKey)),yield an(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Cie})}catch(i){if(Ir(i))return{data:null,error:i};throw i}})}reauthenticate(){return E(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return E(this,null,function*(){try{return yield this._useSession(t=>E(this,null,function*(){const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new id;const{error:a}=yield an(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}}))}catch(t){if(Ir(t))return{data:{user:null,session:null},error:t};throw t}})}resend(t){return E(this,null,function*(){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:o}=yield an(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:o,error:l}=yield an(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new wx("You must provide either an email or phone number and a type")}catch(r){if(Ir(r))return{data:{user:null,session:null},error:r};throw r}})}getSession(){return E(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return this._useSession(r=>E(this,null,function*(){return r}))}))})}_acquireLock(t,r){return E(this,null,function*(){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=E(this,null,function*(){return yield n,yield r()});return this.pendingInLock.push(E(this,null,function*(){try{yield a}catch(i){}})),a}return yield this.lock(`lock:${this.storageKey}`,t,()=>E(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push(E(this,null,function*(){try{yield n}catch(a){}})),yield n;this.pendingInLock.length;){const a=[...this.pendingInLock];yield Promise.all(a),this.pendingInLock.splice(0,a.length)}return yield n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(t){return E(this,null,function*(){this._debug("#_useSession","begin");try{const r=yield this.__loadSession();return yield t(r)}finally{this._debug("#_useSession","end")}})}__loadSession(){return E(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=yield hu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<IN:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=yield hu(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=FN()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,f)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,f))})}return{data:{session:t},error:null}}const{session:a,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(t){return E(this,null,function*(){return t?yield this._getUser(t):(yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._getUser()})))})}_getUser(t){return E(this,null,function*(){try{return t?yield an(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:md}):yield this._useSession(r=>E(this,null,function*(){var n,a,i;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new id}:yield an(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:md})}))}catch(r){if(Ir(r))return eie(r)&&(yield this._removeSession(),yield nd(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}})}updateUser(n){return E(this,arguments,function*(t,r={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._updateUser(t,r)}))})}_updateUser(n){return E(this,arguments,function*(t,r={}){try{return yield this._useSession(a=>E(this,null,function*(){const{data:i,error:o}=a;if(o)throw o;if(!i.session)throw new id;const l=i.session;let c=null,d=null;this.flowType==="pkce"&&t.email!=null&&([c,d]=yield Xf(this.storage,this.storageKey));const{data:f,error:u}=yield an(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:md});if(u)throw u;return l.user=f.user,yield this._saveSession(l),yield this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}}))}catch(a){if(Ir(a))return{data:{user:null},error:a};throw a}})}setSession(t){return E(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._setSession(t)}))})}_setSession(t){return E(this,null,function*(){try{if(!t.access_token||!t.refresh_token)throw new id;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:o}=LN(t.access_token);if(o.exp&&(n=o.exp,a=n<=r),a){const{session:l,error:c}=yield this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=yield this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},yield this._saveSession(i),yield this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Ir(r))return{data:{session:null,user:null},error:r};throw r}})}refreshSession(t){return E(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._refreshSession(t)}))})}_refreshSession(t){return E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new id;const{session:a,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}}))}catch(r){if(Ir(r))return{data:{user:null,session:null},error:r};throw r}})}_getSessionFromURL(t,r){return E(this,null,function*(){try{if(!jo())throw new bx("No browser detected.");if(t.error||t.error_description||t.error_code)throw new bx(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new pM("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new bx("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new pM("No code detected.");const{data:w,error:b}=yield this._exchangeCodeForSession(t.code);if(b)throw b;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=t;if(!i||!l||!o||!d)throw new bx("No session defined in URL");const f=Math.round(Date.now()/1e3),u=parseInt(l);let h=f+u;c&&(h=parseInt(c));const m=h-f;m*1e3<=mh&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${u}s`);const v=h-u;f-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,h,f):f-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,h,f);const{data:g,error:x}=yield this._getUser(i);if(x)throw x;const _={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:u,expires_at:h,refresh_token:o,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:_,redirectType:t.type},error:null}}catch(n){if(Ir(n))return{data:{session:null,redirectType:null},error:n};throw n}})}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}_isPKCECallback(t){return E(this,null,function*(){const r=yield hu(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)})}signOut(){return E(this,arguments,function*(t={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._signOut(t)}))})}_signOut(){return E(this,arguments,function*({scope:t}={scope:"global"}){return yield this._useSession(r=>E(this,null,function*(){var n;const{data:a,error:i}=r;if(i)return{error:i};const o=(n=a.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=yield this.admin.signOut(o,t);if(l&&!(Qae(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(yield this._removeSession(),yield nd(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))})}onAuthStateChange(t){const r=die(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),E(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){this._emitInitialSession(r)}))}),{data:{subscription:n}}}_emitInitialSession(t){return E(this,null,function*(){return yield this._useSession(r=>E(this,null,function*(){var n,a;try{const{data:{session:i},error:o}=r;if(o)throw o;yield(n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){yield(a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}}))})}resetPasswordForEmail(n){return E(this,arguments,function*(t,r={}){let a=null,i=null;this.flowType==="pkce"&&([a,i]=yield Xf(this.storage,this.storageKey,!0));try{return yield an(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(Ir(o))return{data:null,error:o};throw o}})}getUserIdentities(){return E(this,null,function*(){var t;try{const{data:r,error:n}=yield this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Ir(r))return{data:null,error:r};throw r}})}linkIdentity(t){return E(this,null,function*(){var r;try{const{data:n,error:a}=yield this._useSession(i=>E(this,null,function*(){var o,l,c,d,f;const{data:u,error:h}=i;if(h)throw h;const m=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return yield an(this.fetch,"GET",m,{headers:this.headers,jwt:(f=(d=u.session)===null||d===void 0?void 0:d.access_token)!==null&&f!==void 0?f:void 0})}));if(a)throw a;return jo()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Ir(n))return{data:{provider:t.provider,url:null},error:n};throw n}})}unlinkIdentity(t){return E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n,a;const{data:i,error:o}=r;if(o)throw o;return yield an(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})}))}catch(r){if(Ir(r))return{data:null,error:r};throw r}})}_refreshAccessToken(t){return E(this,null,function*(){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return yield mie(a=>E(this,null,function*(){return a>0&&(yield hie(200*Math.pow(2,a-1))),this._debug(r,"refreshing attempt",a),yield an(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ac})}),(a,i)=>{const o=200*Math.pow(2,a);return i&&$N(i)&&Date.now()+o-n<mh})}catch(n){if(this._debug(r,"error",n),Ir(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}})}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}_handleProviderSignIn(t,r){return E(this,null,function*(){const n=yield this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),jo()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}})}_recoverAndRefresh(){return E(this,null,function*(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=yield hu(this.storage,this.storageKey);if(a&&this.userStorage){let o=yield hu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},yield ph(this.userStorage,this.storageKey+"-user",o)),a.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:FN()}else if(a&&!a.user&&!a.user){const o=yield hu(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,yield nd(this.storage,this.storageKey+"-user"),yield ph(this.storage,this.storageKey,a)):a.user=FN()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&(yield this._removeSession());return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<IN;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${IN}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=yield this._callRefreshToken(a.refresh_token);o&&(console.error(o),$N(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),yield this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=yield this._getUser(a.access_token);!l&&(o!=null&&o.user)?(a.user=o.user,yield this._saveSession(a),yield this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else yield this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}})}_callRefreshToken(t){return E(this,null,function*(){var r,n;if(!t)throw new id;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new d1;const{data:i,error:o}=yield this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new id;yield this._saveSession(i.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),Ir(i)){const o={session:null,error:i};return $N(i)||(yield this._removeSession()),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}})}_notifyAllSubscribers(t,r,n=!0){return E(this,null,function*(){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(l=>E(this,null,function*(){try{yield l.callback(t,r)}catch(c){i.push(c)}}));if(yield Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}})}_saveSession(t){return E(this,null,function*(){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&(yield ph(this.userStorage,this.storageKey+"-user",{user:r.user}));const a=Object.assign({},r);delete a.user;const i=_M(a);yield ph(this.storage,this.storageKey,i)}else{const a=_M(r);yield ph(this.storage,this.storageKey,a)}})}_removeSession(){return E(this,null,function*(){this._debug("#_removeSession()"),yield nd(this.storage,this.storageKey),yield nd(this.storage,this.storageKey+"-code-verifier"),yield nd(this.storage,this.storageKey+"-user"),this.userStorage&&(yield nd(this.userStorage,this.storageKey+"-user")),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&jo()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}_startAutoRefresh(){return E(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),mh);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno!="undefined"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(()=>E(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return E(this,null,function*(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)})}startAutoRefresh(){return E(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return E(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return E(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>E(this,null,function*(){try{const t=Date.now();try{return yield this._useSession(r=>E(this,null,function*(){const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/mh);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${mh}ms, refresh threshold is ${x2} ticks`),a<=x2&&(yield this._callRefreshToken(n.refresh_token))}))}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(t){if(t.isAcquireTimeout||t instanceof $9)this._debug("auto refresh token tick lock not available");else throw t}})}_handleVisibilityChange(){return E(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!jo()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>E(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})}_onVisibilityChanged(t){return E(this,null,function*(){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(t,r,n){return E(this,null,function*(){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=yield Xf(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`})}_unenroll(t){return E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n;const{data:a,error:i}=r;return i?{data:null,error:i}:yield an(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})}))}catch(r){if(Ir(r))return{data:null,error:r};throw r}})}_enroll(t){return E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n,a;const{data:i,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:d}=yield an(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})}))}catch(r){if(Ir(r))return{data:null,error:r};throw r}})}_verify(t){return E(this,null,function*(){return this._acquireLock(-1,()=>E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:l}=yield an(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})}))}catch(r){if(Ir(r))return{data:null,error:r};throw r}}))})}_challenge(t){return E(this,null,function*(){return this._acquireLock(-1,()=>E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n;const{data:a,error:i}=r;return i?{data:null,error:i}:yield an(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})}))}catch(r){if(Ir(r))return{data:null,error:r};throw r}}))})}_challengeAndVerify(t){return E(this,null,function*(){const{data:r,error:n}=yield this._challenge({factorId:t.factorId});return n?{data:null,error:n}:yield this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})})}_listFactors(){return E(this,null,function*(){const{data:{user:t},error:r}=yield this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:a,phone:i},error:null}})}_getAuthenticatorAssuranceLevel(){return E(this,null,function*(){return this._acquireLock(-1,()=>E(this,null,function*(){return yield this._useSession(t=>E(this,null,function*(){var r,n;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=LN(a.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(u=>u.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const f=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:f},error:null}}))}))})}fetchJwk(n){return E(this,arguments,function*(t,r={keys:[]}){let a=r.keys.find(c=>c.kid===t);if(a)return a;const i=Date.now();if(a=this.jwks.keys.find(c=>c.kid===t),a&&this.jwks_cached_at+Xae>i)return a;const{data:o,error:l}=yield an(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=i,a=o.keys.find(c=>c.kid===t),!a)?null:a})}getClaims(n){return E(this,arguments,function*(t,r={}){try{let a=t;if(!a){const{data:v,error:g}=yield this.getSession();if(g||!v.session)return{data:null,error:g};a=v.session.access_token}const{header:i,payload:o,signature:l,raw:{header:c,payload:d}}=LN(a);r!=null&&r.allowExpired||wie(o.exp);const f=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:yield this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!f){const{error:v}=yield this.getUser(a);if(v)throw v;return{data:{claims:o,header:i,signature:l},error:null}}const u=bie(i.alg),h=yield crypto.subtle.importKey("jwk",f,u,!0,["verify"]);if(!(yield crypto.subtle.verify(u,h,l,oie(`${c}.${d}`))))throw new b2("Invalid JWT signature");return{data:{claims:o,header:i,signature:l},error:null}}catch(a){if(Ir(a))return{data:null,error:a};throw a}})}}zv.nextInstanceID=0;const Lie=zv;class Fie extends Lie{constructor(t){super(t)}}var zie=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(f){try{d(n.next(f))}catch(u){o(u)}}function c(f){try{d(n.throw(f))}catch(u){o(u)}}function d(f){f.done?i(f.value):a(f.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Bie{constructor(t,r,n){var a,i,o;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=Wae(t),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:$ae,realtime:Fae,auth:Object.assign(Object.assign({},Lae),{storageKey:d}),global:Iae},u=Hae(n!=null?n:{},f);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=qae(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new nae(new URL("rest/v1",c).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Oae(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new Dse(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return zie(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,storageKey:o,flowType:l,lock:c,debug:d},f,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Fie({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),f),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,flowType:l,lock:c,debug:d,fetch:u,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new _ae(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Uie=(e,t,r)=>new Bie(e,t,r);function qie(){if(typeof window!="undefined"||typeof process=="undefined")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}qie()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Vie="https://glpiolbrafqikqhnseto.supabase.co",Wie="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdscGlvbGJyYWZxaWtxaG5zZXRvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5Mzc4MjQsImV4cCI6MjA3MjUxMzgyNH0.O5G3fW-YFtpACNqNfo_lsLK44F-3L3p69Ka-G2lSTLE",T=Uie(Vie,Wie),Hie=Object.freeze(Object.defineProperty({__proto__:null,supabase:T},Symbol.toStringTag,{value:"Module"})),SM=["view","click","like","share","interest","search","review","comment","navigate","form_submit","profile_update","swipe","follow","unfollow","attendance","ticket_click","streaming_top","streaming_recent"],kM=["event","artist","venue","review","user","profile","view","form","ticket_link","song","album","playlist","genre","scene","search"];class Gie{constructor(){Pr(this,"sessionId");Pr(this,"eventQueue",[]);Pr(this,"batchTimeout",null);Pr(this,"BATCH_SIZE",10);Pr(this,"BATCH_DELAY",2e3);Pr(this,"sessionStartTime");Pr(this,"sessionInteractions",0);Pr(this,"sessionPageViews",0);Pr(this,"UUID_REGEX",/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i);this.sessionId=this.generateSessionId(),this.sessionStartTime=new Date}generateSessionId(){return crypto.randomUUID()}isValidUuid(t){return typeof t=="string"&&this.UUID_REGEX.test(t)}normalizeInteractionEvent(t){return t.entityId&&this.isValidUuid(t.entityId)&&!t.entityUuid?V(D({},t),{entityUuid:t.entityId}):t}validateInteractionData(t){const r=[],n=[];if(t.eventType?SM.includes(t.eventType)||r.push(`Invalid eventType: ${t.eventType}. Must be one of: ${SM.join(", ")}`):r.push("eventType is required"),t.entityType?kM.includes(t.entityType)||r.push(`Invalid entityType: ${t.entityType}. Must be one of: ${kM.join(", ")}`):r.push("entityType is required"),!["search","view","form","ticket_link","song","album","playlist","genre","scene"].includes(t.entityType)?!t.entityUuid&&!t.entityId&&r.push(`entityUuid or entityId is required for entityType: ${t.entityType}`):t.entityId||n.push(`No entity identifier provided for entityType: ${t.entityType}. Consider providing entityId for better tracking.`),t.metadata){const o=this.validateMetadata(t.entityType,t.metadata);o.isValid||r.push(...o.errors),n.push(...o.warnings)}return{isValid:r.length===0,errors:r,warnings:n}}validateMetadata(t,r){const n=[],a=[];switch(t){case"event":r.artist_name&&typeof r.artist_name!="string"&&n.push("artist_name must be a string"),r.venue_name&&typeof r.venue_name!="string"&&n.push("venue_name must be a string"),r.event_date&&!this.isValidDate(r.event_date)&&n.push("event_date must be a valid ISO date string");break;case"artist":r.artist_name&&typeof r.artist_name!="string"&&n.push("artist_name must be a string"),r.genres&&!Array.isArray(r.genres)&&n.push("genres must be an array");break;case"venue":r.venue_name&&typeof r.venue_name!="string"&&n.push("venue_name must be a string"),r.venue_city&&typeof r.venue_city!="string"&&n.push("venue_city must be a string"),r.venue_state&&typeof r.venue_state!="string"&&n.push("venue_state must be a string");break;case"review":r.rating&&(typeof r.rating!="number"||r.rating<1||r.rating>5)&&n.push("rating must be a number between 1 and 5"),r.review_text&&typeof r.review_text!="string"&&n.push("review_text must be a string");break;case"ticket_link":r.price&&typeof r.price!="number"&&n.push("price must be a number"),r.currency&&typeof r.currency!="string"&&n.push("currency must be a string");break}return{isValid:n.length===0,errors:n,warnings:a}}isValidDate(t){const r=new Date(t);return r instanceof Date&&!isNaN(r.getTime())}logError(t,r,n){return E(this,null,function*(){console.error(`[${t}]`,r,n)})}calculateSessionMetrics(){const t=Date.now()-this.sessionStartTime.getTime(),r=this.calculateEngagementScore(),n=this.sessionPageViews<=1?100:0;return{duration:t,interactionCount:this.sessionInteractions,engagementScore:r,pageViews:this.sessionPageViews,bounceRate:n}}calculateEngagementScore(){if(this.sessionInteractions===0)return 0;const r=(Date.now()-this.sessionStartTime.getTime())/(1e3*60);let n=Math.min(this.sessionInteractions*10,50);return r>5&&(n+=20),r>15&&(n+=20),r>30&&(n+=10),r<1&&(n*=.5),Math.min(Math.round(n),100)}logInteraction(t){return E(this,null,function*(){const r=this.normalizeInteractionEvent(t);try{const n=this.validateInteractionData(r);if(!n.isValid){yield this.logError("interaction_validation_error",new Error(n.errors.join(", ")),r),console.warn("Invalid interaction data:",n.errors);return}n.warnings.length>0&&console.warn("Interaction validation warnings:",n.warnings);const{data:{user:a}}=yield T.auth.getUser();if(!a){console.warn("No authenticated user for interaction logging");return}if(this.sessionInteractions++,r.eventType==="view"&&this.sessionPageViews++,!["search","view","form","ticket_link","song","album","playlist","genre","scene"].includes(r.entityType)&&!r.entityUuid){console.warn(`Skipping interaction: entity_type '${r.entityType}' requires entity_uuid but it was not provided`,r);return}const{error:o}=yield T.from("interactions").insert([{user_id:a.id,session_id:r.sessionId||this.sessionId,event_type:r.eventType,entity_type:r.entityType,entity_id:r.entityId||null,entity_uuid:r.entityUuid||null}]);o&&(yield this.logError("interaction_logging_error",o,r),console.error("Failed to log interaction:",o))}catch(n){yield this.logError("interaction_logging_exception",n,r),console.error("Error logging interaction:",n)}})}queueInteraction(t){this.eventQueue.push(V(D({},t),{sessionId:t.sessionId||this.sessionId,timestamp:new Date().toISOString()})),this.eventQueue.length>=this.BATCH_SIZE?this.flushBatch():(this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(()=>{this.flushBatch()},this.BATCH_DELAY))}flushBatch(){return E(this,null,function*(){if(this.eventQueue.length===0)return;const t=[...this.eventQueue];this.eventQueue=[],this.batchTimeout&&(clearTimeout(this.batchTimeout),this.batchTimeout=null);const r=[];try{const{data:{user:n}}=yield T.auth.getUser();if(!n){console.warn("No authenticated user for batch logging");return}const a=[];for(const c of t){const d=this.normalizeInteractionEvent(c),f=this.validateInteractionData(d);f.isValid?(f.warnings.length>0&&console.warn("Interaction validation warnings:",f.warnings,d),r.push(d)):(a.push({event:d,errors:f.errors}),yield this.logError("interaction_validation_error",new Error(f.errors.join(", ")),d),console.warn("Invalid interaction in batch:",f.errors,d))}if(r.length===0){console.warn("No valid interactions in batch to insert"),a.length>0&&console.warn(`Skipped ${a.length} invalid interactions`);return}const i=["search","view","form","ticket_link","song","album","playlist","genre","scene"],o=r.filter(c=>!i.includes(c.entityType)&&!c.entityUuid?(console.warn(`Skipping interaction: entity_type '${c.entityType}' requires entity_uuid but it was not provided`,c),!1):!0).map(c=>({user_id:n.id,session_id:c.sessionId||this.sessionId,event_type:c.eventType,entity_type:c.entityType,entity_id:c.entityId||null,entity_uuid:c.entityUuid||null})),{error:l}=yield T.from("interactions").insert(o);if(l){console.error("Failed to log interaction batch:",l);for(const c of r)yield this.logError("interaction_logging_error",l,c)}else console.debug(` Logged ${o.length} interactions`),a.length>0&&console.warn(` Skipped ${a.length} invalid interactions`)}catch(n){console.error("Error logging interaction batch:",n);for(const a of r)yield this.logError("interaction_logging_exception",n,a)}})}flush(){return E(this,null,function*(){yield this.flushBatch()})}startNewSession(){return this.sessionId=this.generateSessionId(),this.sessionStartTime=new Date,this.sessionInteractions=0,this.sessionPageViews=0,this.sessionId}getSessionMetrics(){return this.calculateSessionMetrics()}getSessionId(){return this.sessionId}}const Ns=new Gie,Zt={search:(e,t,r,n)=>{Ns.queueInteraction({eventType:"search",entityType:t,entityId:r,metadata:D({query:e},n)})},click:(e,t,r,n)=>{Ns.queueInteraction({eventType:"click",entityType:e,entityId:t,entityUuid:n||void 0,metadata:r})},like:(e,t,r,n,a)=>{Ns.queueInteraction({eventType:"like",entityType:e,entityId:t,entityUuid:a||void 0,metadata:D({isLiked:r},n)})},share:(e,t,r,n,a)=>{Ns.queueInteraction({eventType:"share",entityType:e,entityId:t,entityUuid:a||void 0,metadata:D({platform:r},n)})},comment:(e,t,r,n,a)=>{Ns.queueInteraction({eventType:"comment",entityType:e,entityId:t,entityUuid:a||void 0,metadata:D({commentLength:r},n)})},review:(e,t,r,n,a)=>{Ns.queueInteraction({eventType:"review",entityType:e,entityId:t,entityUuid:a||void 0,metadata:D({rating:r},n)})},interest:(e,t,r,n,a)=>{Ns.queueInteraction({eventType:"interest",entityType:e,entityId:t,entityUuid:a||void 0,metadata:D({isInterested:r},n)})},swipe:(e,t,r,n,a)=>{Ns.queueInteraction({eventType:"swipe",entityType:e,entityId:t,entityUuid:a||void 0,metadata:D({direction:r},n)})},view:(e,t,r,n,a)=>{Ns.queueInteraction({eventType:"view",entityType:e,entityId:t,entityUuid:a||void 0,metadata:D({duration:r},n)})},trackFeedImpression:(e,t,r)=>{Ns.queueInteraction({eventType:"view",entityType:"event",entityId:e,entityUuid:r||void 0,metadata:D({source:"feed",impression:!0},t)})},navigate:(e,t,r)=>{Ns.queueInteraction({eventType:"navigate",entityType:"view",entityId:t,metadata:D({fromView:e},r)})},formSubmit:(e,t,r,n,a)=>{Ns.queueInteraction({eventType:"form_submit",entityType:e,entityId:t,entityUuid:a||void 0,metadata:D({success:r},n)})},profileUpdate:(e,t,r)=>{Ns.queueInteraction({eventType:"profile_update",entityType:"profile",entityId:t,metadata:D({field:e},r)})},follow:(e,t,r,n)=>{Ns.queueInteraction({eventType:"follow",entityType:e,entityId:t,entityUuid:n||void 0,metadata:r})},unfollow:(e,t,r,n)=>{Ns.queueInteraction({eventType:"unfollow",entityType:e,entityId:t,entityUuid:n||void 0,metadata:r})}};typeof window!="undefined"&&window.addEventListener("beforeunload",()=>{Ns.flush()});const Zy=Object.freeze(Object.defineProperty({__proto__:null,interactionTracker:Ns,trackInteraction:Zt},Symbol.toStringTag,{value:"Module"})),Yie={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdscGlvbGJyYWZxaWtxaG5zZXRvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5Mzc4MjQsImV4cCI6MjA3MjUxMzgyNH0.O5G3fW-YFtpACNqNfo_lsLK44F-3L3p69Ka-G2lSTLE",VITE_SUPABASE_URL:"https://glpiolbrafqikqhnseto.supabase.co"},Eu=class Eu{constructor(){Pr(this,"accessToken",null);Pr(this,"config");const t="",r=typeof window!="undefined"?`${window.location.origin}/auth/spotify/callback`:"";console.log(" Spotify Config Debug:",{hasClientId:!!t,hasRedirectUri:!!r,clientIdLength:t.length,redirectUri:r,envMode:"production",allEnvKeys:Object.keys(Yie)}),this.config={clientId:t,redirectUri:r,scopes:["user-read-private","user-read-email","user-top-read","user-read-recently-played","user-read-playback-state","user-read-currently-playing"]},console.error("Spotify config is missing. Ensure VITE_SPOTIFY_CLIENT_ID and VITE_SPOTIFY_REDIRECT_URI are set.")}static getInstance(){return Eu.instance||(Eu.instance=new Eu),Eu.instance}isConfigured(){return!!(this.config.clientId&&this.config.redirectUri)}authenticate(){return E(this,null,function*(){if(!this.config.clientId||!this.config.redirectUri)throw console.warn("Spotify not configured. Missing VITE_SPOTIFY_CLIENT_ID or VITE_SPOTIFY_REDIRECT_URI environment variables."),new Error("Spotify integration is not configured. Please contact the administrator.");const t=this.generateRandomString(16),r=this.generateRandomString(64),n=yield this.generateCodeChallenge(r);localStorage.setItem("spotify_auth_state",t),localStorage.setItem("spotify_code_verifier",r);const a=new URL("https://accounts.spotify.com/authorize");a.searchParams.append("client_id",this.config.clientId),a.searchParams.append("response_type","code"),a.searchParams.append("redirect_uri",this.config.redirectUri),a.searchParams.append("state",t),a.searchParams.append("scope",this.config.scopes.join(" ")),a.searchParams.append("code_challenge_method","S256"),a.searchParams.append("code_challenge",n);try{Zt.click("spotify",this.config.clientId,{action:"connect_start",scopes:this.config.scopes,redirectUri:this.config.redirectUri})}catch(i){}window.location.href=a.toString()})}reauthenticate(){console.log(" Forcing re-authentication..."),this.logout(),this.authenticate()}validateTokenAndReauthIfNeeded(){return E(this,null,function*(){if(!this.accessToken)return console.log(" No access token available"),!1;const t=new URLSearchParams(window.location.search);if(t.get("code")&&t.get("state"))return console.log(" Currently in auth callback, skipping token validation to avoid race condition"),!1;try{return console.log(" Validating token scopes..."),yield this.spotifyApiCall("/me"),console.log(" Token validation successful"),!0}catch(n){if(console.error(" Token validation failed:",n),n instanceof Error&&n.message.includes("403"))return console.log(" Token has insufficient scopes, clearing old token and forcing re-authentication..."),this.clearStoredData(),this.reauthenticate(),!1;throw n}})}handleAuthCallback(){return E(this,null,function*(){console.log(" Handling Spotify auth callback...");const t=new URLSearchParams(window.location.search),r=t.get("code"),n=t.get("state"),a=t.get("error");if(console.log(" Callback params:",{code:!!r,state:!!n,error:a}),a)throw console.error(" Authentication error:",a),new Error(`Authentication failed: ${a}`);if(!r||!n)return console.log(" No code or state in callback, not a Spotify auth"),!1;const i=localStorage.getItem("spotify_auth_state");if(console.log(" State validation:",{received:n,stored:i,match:n===i}),n!==i)if(console.error(" State mismatch detected"),console.log(" Attempting recovery..."),i){console.error(" State mismatch with stored state present"),console.log(" This might be due to a race condition - attempting token exchange anyway");try{return yield this.exchangeCodeForToken(r),console.log(" Token exchange successful despite state mismatch"),window.history.replaceState({},document.title,window.location.pathname),localStorage.removeItem("spotify_auth_state"),localStorage.removeItem("spotify_code_verifier"),!0}catch(o){throw console.error(" Token exchange failed:",o),new Error("Authentication state mismatch. Please try connecting to Spotify again.")}}else{console.log(" No stored state found - user may have navigated away during auth"),console.log(" Attempting to proceed with token exchange anyway...");try{return yield this.exchangeCodeForToken(r),console.log(" Token exchange successful despite state mismatch"),window.history.replaceState({},document.title,window.location.pathname),!0}catch(o){throw console.error(" Token exchange failed:",o),new Error("Authentication state mismatch. Please try connecting to Spotify again.")}}console.log(" State validated, exchanging code for token..."),yield this.exchangeCodeForToken(r),window.history.replaceState({},document.title,window.location.pathname);try{Zt.click("spotify","current_user",{action:"connect_success"})}catch(o){}return console.log(" Authentication completed successfully!"),!0})}syncUserMusicPreferences(){return E(this,null,function*(){var t;try{const[r,n,a]=yield Promise.all([this.getTopArtists("short_term",50,0).catch(()=>({items:[]})),this.getTopArtists("medium_term",50,0).catch(()=>({items:[]})),this.getTopArtists("long_term",50,0).catch(()=>({items:[]}))]),[i,o,l]=yield Promise.all([this.getTopTracks("short_term",50,0).catch(()=>({items:[]})),this.getTopTracks("medium_term",50,0).catch(()=>({items:[]})),this.getTopTracks("long_term",50,0).catch(()=>({items:[]}))]),c=yield this.getRecentlyPlayed(50).catch(()=>({items:[]})),d=yield this.getUserProfile().catch(()=>null),f=[...r.items,...n.items,...a.items],u=[...i.items,...o.items,...l.items];yield this.saveToStreamingProfiles({topArtists:f,topTracks:u,recentlyPlayed:c.items,userProfile:d});const h=(v,g)=>{Ns.queueInteraction({eventType:"music_pref",entityType:"artist",entityId:v.id,metadata:{name:v.name,genres:v.genres,popularity:v.popularity,timeRange:g}})};r.items.forEach(v=>h(v,"short_term")),n.items.forEach(v=>h(v,"medium_term")),a.items.forEach(v=>h(v,"long_term"));const m=(v,g)=>{var x,_,w;Ns.queueInteraction({eventType:"music_pref",entityType:"track",entityId:v.id,metadata:{name:v.name,album:(x=v.album)==null?void 0:x.name,artistNames:(_=v.artists)==null?void 0:_.map(b=>b.name),artistIds:(w=v.artists)==null?void 0:w.map(b=>b.id),popularity:v.popularity,timeRange:g}})};i.items.forEach(v=>m(v,"short_term")),o.items.forEach(v=>m(v,"medium_term")),l.items.forEach(v=>m(v,"long_term")),c.items.forEach(v=>{var x,_,w;const g=v.track;g&&Ns.queueInteraction({eventType:"listen",entityType:"track",entityId:g.id,metadata:{name:g.name,album:(x=g.album)==null?void 0:x.name,artistNames:(_=g.artists)==null?void 0:_.map(b=>b.name),artistIds:(w=g.artists)==null?void 0:w.map(b=>b.id),played_at:v.played_at}})});try{yield Ns.flush()}catch(v){(v==null?void 0:v.code)==="23505"&&((t=v==null?void 0:v.message)!=null&&t.includes("user_genre_interactions"))?console.warn("Some genre interactions were duplicates (this is expected during sync)"):console.error("Error flushing interactions:",v)}try{const{data:{user:v}}=yield T.auth.getUser();if(v){console.log(" Fetching comprehensive streaming data...");const[g,x,_]=yield Promise.all([this.getAllTopArtists("short_term").catch(()=>[]),this.getAllTopArtists("medium_term").catch(()=>[]),this.getAllTopArtists("long_term").catch(()=>[])]),[w,b,N]=yield Promise.all([this.getAllTopTracks("short_term").catch(()=>[]),this.getAllTopTracks("medium_term").catch(()=>[]),this.getAllTopTracks("long_term").catch(()=>[])]),S=yield Promise.all([this.getRecentlyPlayed(50,void 0,void 0).catch(()=>({items:[]})),this.getRecentlyPlayed(50,void 0,void 0).catch(()=>({items:[]})),this.getRecentlyPlayed(50,void 0,void 0).catch(()=>({items:[]})),this.getRecentlyPlayed(50,void 0,void 0).catch(()=>({items:[]}))]).then(k=>k.flatMap(R=>R.items||[]).filter((R,I,O)=>I===O.findIndex(z=>{var M,B;return((M=z.track)==null?void 0:M.id)===((B=R.track)==null?void 0:B.id)})).slice(0,200));console.log(" Stats table removed - stats not persisted. Fetched:",{short_term:{artists:g.length,tracks:w.length},medium_term:{artists:x.length,tracks:b.length},long_term:{artists:_.length,tracks:N.length},recently_played:S.length});try{const{streamingSyncService:k}=yield Rr(()=>E(this,null,function*(){const{streamingSyncService:C}=yield Promise.resolve().then(()=>nw);return{streamingSyncService:C}}),void 0,import.meta.url);k.isSyncing()&&k.completeSync()}catch(k){console.warn("Could not notify sync service:",k)}}}catch(v){console.error("Error storing comprehensive Spotify stats:",v);try{const{streamingSyncService:g}=yield Rr(()=>E(this,null,function*(){const{streamingSyncService:x}=yield Promise.resolve().then(()=>nw);return{streamingSyncService:x}}),void 0,import.meta.url);g.errorSync(v instanceof Error?v.message:"Unknown error")}catch(g){console.warn("Could not notify sync service of error:",g)}}Zt.click("spotify","current_user",{action:"sync_complete",artists_short:r.items.length,artists_medium:n.items.length,artists_long:a.items.length,tracks_short:i.items.length,tracks_medium:o.items.length,tracks_long:l.items.length,recently_played:c.items.length})}catch(r){console.error("Spotify sync error:",r)}})}saveToStreamingProfiles(t){return E(this,null,function*(){var r,n,a,i,o,l,c,d,f,u,h;try{const{data:{user:m}}=yield T.auth.getUser();if(!m){console.warn("No authenticated user for streaming profile save");return}const v={topArtists:t.topArtists,topTracks:t.topTracks,recentlyPlayed:t.recentlyPlayed,userProfile:t.userProfile,external_urls:(r=t.userProfile)==null?void 0:r.external_urls,followers:(n=t.userProfile)==null?void 0:n.followers,country:(a=t.userProfile)==null?void 0:a.country,display_name:(i=t.userProfile)==null?void 0:i.display_name,email:(o=t.userProfile)==null?void 0:o.email,images:(l=t.userProfile)==null?void 0:l.images,product:(c=t.userProfile)==null?void 0:c.product,type:(d=t.userProfile)==null?void 0:d.type,uri:(f=t.userProfile)==null?void 0:f.uri},{error:g}=yield T.from("streaming_profiles").upsert({user_id:m.id,service_type:"spotify",profile_data:v,sync_status:"completed",last_updated:new Date().toISOString()},{onConflict:"user_id,service_type",ignoreDuplicates:!1});if(g)if(g.code==="PGRST205")console.warn("Table streaming_profiles does not exist or RLS policy issue");else if(g.code==="23505"){const{error:x}=yield T.from("streaming_profiles").update({profile_data:v,sync_status:"completed",last_updated:new Date().toISOString()}).eq("user_id",m.id).eq("service_type","spotify");x?console.error("Error updating streaming profile:",x):console.log(" Updated streaming profile for user:",m.id)}else console.error("Error upserting streaming profile:",g);else console.log(" Upserted streaming profile for user:",m.id);if((h=(u=t.userProfile)==null?void 0:u.external_urls)!=null&&h.spotify){const{error:x}=yield T.from("users").update({music_streaming_profile:t.userProfile.external_urls.spotify,updated_at:new Date().toISOString()}).eq("user_id",m.id);x?console.warn("Warning: Failed to update user profile with Spotify URL:",x):console.log(" Updated user profile with Spotify URL")}}catch(m){console.error("Error saving to streaming profiles:",m)}})}checkStoredToken(){const t=localStorage.getItem("spotify_access_token"),r=localStorage.getItem("spotify_token_expiry");return t&&r&&Date.now()<parseInt(r)?(this.accessToken=t,console.log(" Found stored token, expires at:",new Date(parseInt(r)).toLocaleString()),!0):(console.log(" No valid stored token found"),!1)}ensureSession(){return E(this,null,function*(){const t=localStorage.getItem("spotify_access_token"),r=localStorage.getItem("spotify_token_expiry");if(t&&r){const n=parseInt(r);return Date.now()<n?(this.accessToken=t,!0):yield this.refreshToken()}return!1})}syncThisSessionLightly(){return E(this,null,function*(){try{yield Promise.all([this.getTopArtists("medium_term",10,0).catch(()=>null),this.getTopTracks("medium_term",10,0).catch(()=>null),this.getRecentlyPlayed(10).catch(()=>null)])}catch(t){console.warn("Light sync skipped:",t)}})}isAuthenticated(){return this.accessToken!==null}checkTokenScopes(){return E(this,null,function*(){try{console.log(" Checking Spotify token scopes..."),console.log(" Requested scopes:",this.config.scopes),console.log(" Access token present:",!!this.accessToken);try{const t=yield this.spotifyApiCall("/me");console.log(" User profile loaded successfully, basic scopes are working"),console.log(" User profile:",t.display_name)}catch(t){throw console.error(" User profile failed:",t),t}try{yield this.spotifyApiCall("/me/top/tracks?limit=1"),console.log(" user-top-read scope is working")}catch(t){console.warn(" user-top-read scope may be missing:",t)}try{yield this.spotifyApiCall("/me/player/recently-played?limit=1"),console.log(" user-read-recently-played scope is working")}catch(t){console.warn(" user-read-recently-played scope may be missing:",t)}return["user-read-private","user-read-email"]}catch(t){throw console.error(" Token scope check failed:",t),new Error("Unable to verify token scopes. Please reconnect to Spotify.")}})}logout(){console.log(" Logging out from Spotify..."),this.accessToken=null,localStorage.removeItem("spotify_access_token"),localStorage.removeItem("spotify_token_expiry"),localStorage.removeItem("spotify_refresh_token"),localStorage.removeItem("spotify_auth_state"),localStorage.removeItem("spotify_code_verifier"),console.log(" Spotify logout completed")}clearStoredData(){console.log(" Clearing all stored Spotify data..."),this.logout(),console.log(" All Spotify data cleared")}forceClearAndReauth(){console.log(" Force clearing all data and re-authenticating..."),this.clearStoredData(),typeof window!="undefined"&&alert("Clearing all Spotify data. Please reconnect with the new authentication method."),this.authenticate()}recoverFromStateMismatch(){console.log(" Recovering from state mismatch..."),this.clearStoredData(),typeof window!="undefined"&&confirm(`Spotify authentication session expired. This can happen if you navigated away during the connection process.

Would you like to try connecting again now?`)&&this.authenticate()}nuclearReset(){console.log(" NUCLEAR RESET: Clearing everything and forcing fresh start..."),["spotify_access_token","spotify_token_expiry","spotify_refresh_token","spotify_auth_state","spotify_code_verifier"].forEach(r=>{localStorage.removeItem(r),console.log(` Removed ${r}`)}),this.accessToken=null,typeof window!="undefined"&&(alert("Nuclear reset complete. All Spotify data cleared. Please refresh the page and reconnect."),window.location.reload())}exchangeCodeForToken(t){return E(this,null,function*(){const r=localStorage.getItem("spotify_code_verifier")||"";if(!this.config.clientId||!this.config.redirectUri)throw new Error("Spotify not configured for token exchange");const n=yield fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",code:t,redirect_uri:this.config.redirectUri,client_id:this.config.clientId,code_verifier:r})}),a=yield n.json();if(!n.ok)throw console.error(" Token exchange failed:",n.status,n.statusText),console.error("Response data:",a),new Error("Failed to exchange code for token");if(console.log(" Token exchange successful!"),console.log(" Granted scopes:",a.scope),console.log(" Token expires in:",a.expires_in,"seconds"),a.access_token){this.accessToken=a.access_token;const i=Date.now()+a.expires_in*1e3;localStorage.setItem("spotify_access_token",a.access_token),localStorage.setItem("spotify_token_expiry",i.toString()),a.refresh_token&&(localStorage.setItem("spotify_refresh_token",a.refresh_token),console.log(" Refresh token saved"))}else throw new Error("No access token received")})}refreshToken(){return E(this,null,function*(){const t=localStorage.getItem("spotify_refresh_token");if(!t)return this.logout(),!1;try{const n=yield(yield fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:t,client_id:this.config.clientId})})).json();if(n.access_token){this.accessToken=n.access_token;const a=Date.now()+n.expires_in*1e3;return localStorage.setItem("spotify_access_token",n.access_token),localStorage.setItem("spotify_token_expiry",a.toString()),!0}return!1}catch(r){return console.error("Token refresh error:",r),!1}})}spotifyApiCall(n){return E(this,arguments,function*(t,r={}){if(!this.accessToken)throw new Error("No access token available");const a=`https://api.spotify.com/v1${t}`,i=yield fetch(a,D({headers:D({Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"},r.headers)},r));if(i.status===401){if(yield this.refreshToken())return this.spotifyApiCall(t,r);throw this.logout(),new Error("Authentication failed")}if(i.status===429){const o=i.headers.get("Retry-After"),l=o?parseInt(o)*1e3:1e3;return yield new Promise(c=>setTimeout(c,l)),this.spotifyApiCall(t,r)}if(i.status===403)throw console.log(" 403 Forbidden detected, clearing all stored data..."),this.clearStoredData(),typeof window!="undefined"&&window.dispatchEvent(new CustomEvent("spotify-token-cleared")),new Error("Access forbidden. Please reconnect with proper permissions.");if(i.status===404)throw new Error("No data found. This might be because you haven't listened to enough music yet.");if(!i.ok){const o=yield i.text().catch(()=>"Unknown error");throw new Error(`Spotify API error: ${i.status} ${i.statusText} - ${o}`)}return i.json()})}getUserProfile(){return E(this,null,function*(){try{return yield this.spotifyApiCall("/me")}catch(t){throw console.error("Error fetching user profile:",t),t instanceof Error&&t.message.includes("403")?new Error("Insufficient permissions. Please reconnect with proper Spotify permissions."):t}})}getTopTracks(t="medium_term",r=20,n=0){return E(this,null,function*(){var o,l;if(r<1||r>50)throw new Error("Limit must be between 1 and 50");if(n<0)throw new Error("Offset must be 0 or greater");const a=new URLSearchParams({time_range:t,limit:r.toString(),offset:n.toString()}),i=yield this.spotifyApiCall(`/me/top/tracks?${a.toString()}`);try{Zt.view("spotify","current_user",void 0,{resource:"top_tracks",count:(l=(o=i.items)==null?void 0:o.length)!=null?l:0,timeRange:t})}catch(c){}return i})}getTopArtists(t="medium_term",r=20,n=0){return E(this,null,function*(){var o,l;if(r<1||r>50)throw new Error("Limit must be between 1 and 50");if(n<0)throw new Error("Offset must be 0 or greater");const a=new URLSearchParams({time_range:t,limit:r.toString(),offset:n.toString()}),i=yield this.spotifyApiCall(`/me/top/artists?${a.toString()}`);try{Zt.view("spotify","current_user",void 0,{resource:"top_artists",count:(l=(o=i.items)==null?void 0:o.length)!=null?l:0,timeRange:t})}catch(c){}return i})}getRecentlyPlayed(t=20,r,n){return E(this,null,function*(){var o,l;if(t<1||t>50)throw new Error("Limit must be between 1 and 50");const a=new URLSearchParams({limit:t.toString()});r!==void 0&&a.append("after",r.toString()),n!==void 0&&a.append("before",n.toString());const i=yield this.spotifyApiCall(`/me/player/recently-played?${a.toString()}`);try{Zt.view("spotify","current_user",void 0,{resource:"recently_played",count:(l=(o=i.items)==null?void 0:o.length)!=null?l:0})}catch(c){}return i})}getCurrentPlayback(){return E(this,null,function*(){try{return this.spotifyApiCall("/me/player")}catch(t){return console.log("No active player found"),null}})}getAllTopTracks(t="medium_term"){return E(this,null,function*(){const r=[];let n=0;const a=50;let i=!0;for(;i;)try{const o=yield this.getTopTracks(t,a,n);r.push(...o.items),i=o.next!==null,n+=a}catch(o){console.error("Error fetching top tracks:",o);break}return r})}getAllTopArtists(t="medium_term"){return E(this,null,function*(){const r=[];let n=0;const a=50;let i=!0;for(;i;)try{const o=yield this.getTopArtists(t,a,n);r.push(...o.items),i=o.next!==null,n+=a}catch(o){console.error("Error fetching top artists:",o);break}return r})}calculateListeningStats(t,r){const n=t.length;if(n===0)return{totalTracks:0,uniqueArtists:0,uniqueAlbums:0,totalHours:0,avgPopularity:0,topGenres:[]};const a=new Set(t.flatMap(u=>u.artists.map(h=>h.id))).size,i=new Set(t.map(u=>u.album.id)).size,o=Math.round(t.reduce((u,h)=>u+h.popularity,0)/n),l=t.reduce((u,h)=>u+h.duration_ms,0),c=Math.round(l/(1e3*60*60)*10)/10,d={};r.forEach(u=>{u.genres.forEach(h=>{d[h]=(d[h]||0)+1})});const f=Object.entries(d).sort(([,u],[,h])=>h-u).slice(0,5).map(([u])=>u);return{totalTracks:n,uniqueArtists:a,uniqueAlbums:i,totalHours:c,avgPopularity:o,topGenres:f}}formatDate(t){const n=new Date().getTime()-t.getTime(),a=Math.floor(n/(1e3*60)),i=Math.floor(n/(1e3*60*60)),o=Math.floor(n/(1e3*60*60*24));return a<60?`${a} minutes ago`:i<24?`${i} hours ago`:o<7?`${o} days ago`:t.toLocaleDateString()}generateRandomString(t){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let a=0;a<t;a++)n+=r.charAt(Math.floor(Math.random()*r.length));return n}generateCodeChallenge(t){return E(this,null,function*(){const n=new TextEncoder().encode(t),a=yield crypto.subtle.digest("SHA-256",n);return btoa(String.fromCharCode(...new Uint8Array(a))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}selfTest(){return E(this,null,function*(){var t,r,n,a;try{const i=yield this.getUserProfile(),o=yield this.getTopArtists("short_term",1,0),l=yield this.getRecentlyPlayed(1);return{ok:!0,profile:i.display_name,topArtists:(r=(t=o.items)==null?void 0:t.length)!=null?r:0,recentlyPlayed:(a=(n=l.items)==null?void 0:n.length)!=null?a:0}}catch(i){return{ok:!1,error:(i==null?void 0:i.message)||String(i)}}})}};Pr(Eu,"instance");let j2=Eu;const Au=j2.getInstance();class Kie{constructor(){Pr(this,"syncState",{status:"idle",serviceType:null,startedAt:null,completedAt:null,error:null});Pr(this,"listeners",[]);Pr(this,"checkInterval",null)}startSync(t){this.syncState={status:"syncing",serviceType:t,startedAt:Date.now(),completedAt:null,error:null},localStorage.setItem("streaming_sync_state",JSON.stringify(this.syncState)),this.notifyListeners(),this.startPolling()}completeSync(){this.syncState=V(D({},this.syncState),{status:"completed",completedAt:Date.now()}),localStorage.setItem("streaming_sync_state",JSON.stringify(this.syncState)),this.notifyListeners(),this.stopPolling()}errorSync(t){this.syncState=V(D({},this.syncState),{status:"error",completedAt:Date.now(),error:t}),localStorage.setItem("streaming_sync_state",JSON.stringify(this.syncState)),this.notifyListeners(),this.stopPolling()}getState(){return D({},this.syncState)}isSyncing(){return this.syncState.status==="syncing"}clearSync(){this.syncState={status:"idle",serviceType:null,startedAt:null,completedAt:null,error:null},localStorage.removeItem("streaming_sync_state"),this.notifyListeners(),this.stopPolling()}restoreState(){localStorage.removeItem("streaming_sync_state"),this.clearSync()}startPolling(){this.stopPolling(),this.syncState.status==="syncing"&&this.completeSync()}stopPolling(){this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)}subscribe(t){return this.listeners.push(t),t(this.getState()),()=>{const r=this.listeners.indexOf(t);r>-1&&this.listeners.splice(r,1)}}notifyListeners(){this.listeners.forEach(t=>t(this.getState()))}}const jl=new Kie,nw=Object.freeze(Object.defineProperty({__proto__:null,streamingSyncService:jl},Symbol.toStringTag,{value:"Module"})),Zie=()=>{const{toast:e}=Er(),[t,r]=y.useState("connecting"),[n,a]=y.useState("");return y.useEffect(()=>{E(void 0,null,function*(){try{r("connecting"),(yield Au.handleAuthCallback())?(jl.startSync("spotify"),Au.syncUserMusicPreferences().catch(l=>{console.error("Background sync error:",l),jl.errorSync(l.message||"Sync failed")}),r("complete"),e({title:"Connected to Spotify",description:"Your stats are syncing in the background. You'll be notified when ready!"}),setTimeout(()=>{window.location.href="/",localStorage.setItem("intendedView","feed")},1500)):(r("error"),a("Authentication was not successful. Please try again."),e({title:"Connection Failed",description:"Failed to connect to Spotify. Please try again.",variant:"destructive"}),setTimeout(()=>{window.location.href="/"},2e3))}catch(o){console.error("Spotify callback error:",o),r("error");let l="Failed to connect to Spotify. Please try again.";o instanceof Error&&(o.message.includes("state mismatch")?l="Authentication session expired. Please try connecting again.":o.message.includes("Authentication failed")?l="Spotify authentication was cancelled or failed.":l=o.message),a(l),e({title:"Connection Failed",description:l,variant:"destructive"}),Au.clearStoredData(),setTimeout(()=>{window.location.href="/"},2e3)}})},[e]),s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-white to-beige-50",children:s.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[t==="connecting"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Connecting to Spotify..."}),s.jsx("p",{className:"text-muted-foreground",children:"Please wait while we authenticate your account."})]}),t==="complete"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Successfully Connected!"}),s.jsx("p",{className:"text-muted-foreground mb-2",children:"Your stats are syncing in the background."}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"You'll be notified when they're ready. Redirecting to app..."})]}),t==="error"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("h2",{className:"text-xl font-semibold mb-2 text-red-600",children:"Connection Failed"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:n}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Redirecting to home..."})]})]})})},Xie="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M5.4885%2022.0003C4.11417%2022.0003%203%2020.857%203%2019.4453V9.17632C3%208.40049%203.34417%207.66549%203.93333%207.18132L10.7782%201.56032C11.2155%201.19817%2011.7655%201%2012.3333%201C12.9012%201%2013.4512%201.19817%2013.8885%201.56032L20.7322%207.18132C21.3225%207.66549%2021.6667%208.40049%2021.6667%209.17632V19.4453C21.6667%2020.857%2020.5525%2022.0003%2019.1782%2022.0003H5.4885Z'%20fill='%23CC2486'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M9%2021.75V15.3333C9%2014.7145%209.24583%2014.121%209.68342%2013.6834C10.121%2013.2458%2010.7145%2013%2011.3333%2013H12.5C13.1188%2013%2013.7123%2013.2458%2014.1499%2013.6834C14.5875%2014.121%2014.8333%2014.7145%2014.8333%2015.3333V21.75'%20stroke='%23FDF2F7'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",Jie="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_3690_6527)'%3e%3cpath%20d='M23%2012C23%2013.4445%2022.7155%2014.8749%2022.1627%2016.2095C21.6099%2017.5441%2020.7996%2018.7567%2019.7782%2019.7782C18.7567%2020.7996%2017.5441%2021.6099%2016.2095%2022.1627C14.8749%2022.7155%2013.4445%2023%2012%2023C10.5555%2023%209.12506%2022.7155%207.79048%2022.1627C6.4559%2021.6099%205.24327%2020.7996%204.22183%2019.7782C3.20038%2018.7567%202.39013%2017.5441%201.83733%2016.2095C1.28452%2014.8749%201%2013.4445%201%2012C1%209.08262%202.15893%206.28473%204.22183%204.22183C6.28473%202.15893%209.08262%201%2012%201C14.9174%201%2017.7153%202.15893%2019.7782%204.22183C21.8411%206.28473%2023%209.08262%2023%2012Z'%20fill='%23CC2486'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M7%2017L9.5%209.5L17%207L14.5%2014.5L7%2017Z'%20fill='%23FDF2F7'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_3690_6527'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",Qie="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_3690_6539)'%3e%3cpath%20d='M12%2023C14.1756%2023%2016.3023%2022.3549%2018.1113%2021.1462C19.9202%2019.9375%2021.3301%2018.2195%2022.1627%2016.2095C22.9952%2014.1995%2023.2131%2011.9878%2022.7886%209.85401C22.3642%207.72022%2021.3165%205.76021%2019.7782%204.22183C18.2398%202.68345%2016.2798%201.6358%2014.146%201.21137C12.0122%200.78693%209.80047%201.00477%207.79048%201.83733C5.78049%202.66989%204.06253%204.07979%202.85383%205.88873C1.64514%207.69767%201%209.82441%201%2012C1%2013.76%201.41311%2015.4222%202.14889%2016.8974C2.70256%2018.0109%201.93256%2019.513%201.63922%2020.6093C1.57424%2020.8518%201.57422%2021.1071%201.63919%2021.3496C1.70415%2021.5921%201.83181%2021.8132%202.00931%2021.9907C2.18682%2022.1682%202.40792%2022.2958%202.6504%2022.3608C2.89288%2022.4258%203.14819%2022.4258%203.39067%2022.3608C4.487%2022.0674%205.98911%2021.2974%207.10255%2021.8523C8.62448%2022.608%2010.3008%2023.0008%2012%2023Z'%20fill='%23CC2486'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_3690_6539'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",eoe="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M16%205.125C16%206.21902%2015.5786%207.26823%2014.8284%208.04182C14.0783%208.8154%2013.0609%209.25%2012%209.25C10.9391%209.25%209.92172%208.8154%209.17157%208.04182C8.42143%207.26823%208%206.21902%208%205.125C8%204.03098%208.42143%202.98177%209.17157%202.20818C9.92172%201.4346%2010.9391%201%2012%201C13.0609%201%2014.0783%201.4346%2014.8284%202.20818C15.5786%202.98177%2016%204.03098%2016%205.125ZM22%2023C21.3667%2010.1671%202.63333%2010.1671%202%2023Z'%20fill='%23CC2486'/%3e%3cpath%20d='M22%2023C21.3667%2010.1671%202.63333%2010.1671%202%2023M16%205.125C16%206.21902%2015.5786%207.26823%2014.8284%208.04182C14.0783%208.8154%2013.0609%209.25%2012%209.25C10.9391%209.25%209.92172%208.8154%209.17157%208.04182C8.42143%207.26823%208%206.21902%208%205.125C8%204.03098%208.42143%202.98177%209.17157%202.20818C9.92172%201.4346%2010.9391%201%2012%201C13.0609%201%2014.0783%201.4346%2014.8284%202.20818C15.5786%202.98177%2016%204.03098%2016%205.125Z'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",toe={houseSelected:Xie,discoverSelected:Jie,circleCommentSelected:Qie,userSelected:eoe},roe={x:"X",heart:"Heart",smallMusic:"Music",smallLocation:"MapPin",smallCheck:"Check",house:"Home",discover:"Compass",circleComment:"MessageCircle",user:"User",search:"Search",send:"Send",share:"Share2",upload:"Upload",download:"Download",edit:"SquarePen",trash:"Trash2",refresh:"RefreshCw",repeat:"Repeat",plus:"Plus",plusBox:"SquarePlus",hamburgerMenu:"Menu",bell:"Bell",settings:"Settings",filter:"Filter",sort:"ArrowDownUp",sortFilter:"SlidersHorizontal",check:"Check",checkMark:"Check",circleCheck:"CheckCircle2",minus:"Minus",questionMark:"CircleHelp",infoCircle:"Info",exclamationTriangle:"AlertTriangle",ellipsis:"Ellipsis",moreHorizontal:"Ellipsis",overflowMenu:"Ellipsis",arrowDown:"ArrowDown",arrowUp:"ArrowUp",left:"ChevronLeft",leftArrow:"ArrowLeft",right:"ChevronRight",up:"ChevronUp",upArrow:"ArrowUp",down:"ChevronDown",thumbsUp:"ThumbsUp",star:"Star",image:"Image",photo:"Camera",video:"Video",music:"Music",location:"MapPin",calendar:"Calendar",ticket:"Ticket",clock:"Clock",envelope:"Mail",squareComment:"MessageSquare",atSymbol:"AtSign",userPlus:"UserPlus",twoUsers:"Users",dollar:"DollarSign",building:"Building2",lock:"Lock",key:"Key",shield:"Shield",ban:"Ban",flag:"Flag",barChart:"BarChart3",pieChart:"PieChart",trendingUp:"TrendingUp",globe:"Globe",eye:"Eye",externalLink:"ExternalLink",maximize:"Maximize2",mousePointer:"MousePointer",target:"Target",route:"Route",ribbonAward:"Award",logOut:"LogOut",spotifyLogo:"Music",appleMusicLogo:"Music",instagram:"Instagram",mediumStar:"Star",mediumMusic:"Music",mediumLocation:"MapPin",mediumSend:"Send",mediumDollar:"DollarSign",mediumBuildings:"Building2",mediumShootingStar:"Sparkles",mediumMicrophone:"Mic",mediumEdit:"Pencil",largeHeart:"Heart",largeStar:"Star",largeVideo:"Video",largeCamera:"Camera",largeMusic:"Music",largeMessaging:"MessageCircle",fullStar:"Star",halfStar:"Star"},noe=new Set(["houseSelected","discoverSelected","circleCommentSelected","userSelected"]);function L9(e){return noe.has(e)}function soe(e){return L9(e)?null:roe[e]||null}const aoe={X:Yr,Heart:es,Music:Ft,MapPin:yr,Check:fa,Search:Ho,Send:qc,Share2:Dc,Upload:Y_,Download:pp,SquarePen:Ol,Trash2:Ko,RefreshCw:vi,Repeat:nz,Plus:Yo,SquarePlus:fee,Menu:nee,Bell:Ud,Settings:FP,Filter:qy,ArrowDownUp:OQ,SlidersHorizontal:uee,Minus:tz,CircleHelp:zQ,Info:MP,AlertTriangle:BP,CheckCircle2:Zk,Ellipsis:WQ,ArrowDown:YF,ArrowUp:KF,ChevronLeft:AP,ArrowLeft:ks,ChevronRight:Uy,ChevronUp:Lo,ChevronDown:Aa,ThumbsUp:zP,Star:Xt,Image:G_,Camera:Av,Video:iz,Home:OP,Compass:RP,Calendar:Lt,Ticket:zl,Clock:Oa,Mail:ez,MessageSquare:Ah,AtSign:Kk,User:Is,UserPlus:Id,Users:Vr,DollarSign:Do,Building2:Io,Lock:Rv,Key:JF,Shield:wl,Ban:H_,Flag:eo,BarChart3:qd,PieChart:Hb,TrendingUp:qn,Globe:Xi,Eye:Jd,ExternalLink:io,Maximize2:ree,MousePointer:IP,Target:Ji,Route:Jk,Award:Mc,LogOut:QF,Instagram:DP,Sparkles:Fl,Mic:see,Pencil:oee,MessageCircle:Ln};function ioe(e){return aoe[e]||null}const Re=({name:e,size:t=24,color:r,alt:n,className:a})=>{const i=L9(e),o=i?toe[e]:null;if(i)return o?s.jsx("img",{src:o,alt:n||`${e} icon`,width:t,height:t,className:`synth-icon ${a||""}`,style:{display:"block",flexShrink:0,margin:0,padding:0,verticalAlign:"middle",objectFit:"contain",objectPosition:"center"}}):(console.error(` Icon "${e}" not found in icons mapping`),s.jsx("span",{style:{display:"inline-block",width:`${t}px`,height:`${t}px`,backgroundColor:"#ff0000",color:"#fff",fontSize:"10px",textAlign:"center",lineHeight:`${t}px`},title:`Missing icon: ${e}`,children:"?"}));const l=soe(e),c=l?ioe(l):null;return c?s.jsx("span",{className:`synth-icon ${a||""}`,style:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,margin:0,padding:0,verticalAlign:"middle",width:`${t}px`,height:`${t}px`,lineHeight:0,color:r||void 0},"aria-label":n||`${e} icon`,role:"img",children:s.jsx(c,{size:t,color:r||"currentColor",strokeWidth:2,"aria-hidden":"true"})}):(console.error(` Icon "${e}" not found in lucide-react mapping`),s.jsx("span",{style:{display:"inline-block",width:`${t}px`,height:`${t}px`,backgroundColor:"#ff0000",color:"#fff",fontSize:"10px",textAlign:"center",lineHeight:`${t}px`},title:`Missing icon: ${e}`,children:"?"}))},Su=({size:e,variant:t,initial:r,imageUrl:n,alt:a,className:i})=>{const o="profile-picture",l=`${o}--${e}`,c=`${o}--${t}`,d=[o,l,c,i].filter(Boolean).join(" "),f=()=>t==="image"&&n?s.jsx("img",{src:n,alt:a||"",className:"profile-picture__image"}):(t==="image"||t==="initial")&&r?s.jsx("span",{className:"profile-picture__initial","aria-hidden":a?void 0:!0,children:r.charAt(0).toUpperCase()}):s.jsx(Re,{name:"music",size:24,alt:a||"Music",className:"profile-picture__icon"});return s.jsx("div",{className:d,role:a?"img":void 0,"aria-label":a,children:f()})},fc=({name:e,username:t,initial:r,variant:n,followers:a,following:i,events:o,onFollowersClick:l,onFollowingClick:c,onEventsClick:d,imageUrl:f,className:u})=>{let h=45,m="initial";n==="artist"?(h=45,m="musicIcon"):n==="chat"?(h=32,m=f?"image":"initial"):n==="userProfile"?(h=75,m=f?"image":"initial"):(h=45,m=f?"image":"initial");const v=["user-info",`user-info--${n}`,u].filter(Boolean).join(" "),g=(n==="user"||n==="userProfile")&&t,x=n==="userProfile",_=[{key:"followers",label:"Followers",value:a},{key:"following",label:"Following",value:i},{key:"events",label:"Events",value:o}];return s.jsxs("div",{className:v,children:[s.jsx("div",{className:"user-info__avatar",children:s.jsx(Su,{size:h,variant:m,initial:r,imageUrl:f,alt:e})}),s.jsxs("div",{className:"user-info__content",children:[s.jsx("p",{className:"user-info__name",children:e}),g&&s.jsxs("p",{className:"user-info__username",children:["@",t]}),x&&s.jsx("div",{className:"user-info__stats","aria-label":"User statistics",children:_.map(w=>{var N;const b=()=>{w.key==="followers"&&l?l():w.key==="following"&&c?c():w.key==="events"&&d&&d()};return s.jsxs("button",{className:"user-info__stat",type:"button",onClick:b,style:{background:"none",border:"none",padding:0,cursor:l||c||d?"pointer":"default",textAlign:"center"},children:[s.jsx("span",{className:"user-info__stat-value",children:(N=w.value)!=null?N:0}),s.jsx("span",{className:"user-info__stat-label",children:w.label})]},w.key)})})]})]})},Nn=d=>{var f=d,{variant:e="primary",size:t,icon:r,iconPosition:n="left",fullWidth:a=!1,children:i,className:o="",disabled:l}=f,c=ge(f,["variant","size","icon","iconPosition","fullWidth","children","className","disabled"]);const u=l||e==="disabled",h=u?"disabled":e,m=t||(e==="tertiary"?"tertiary":"standard"),v=e==="tertiary"?!1:a,g=e==="tertiary"?!1:m==="iconOnly";g&&!["primary","secondary","disabled"].includes(h)&&console.warn("Icon-only buttons are only allowed for primary, secondary, or disabled variants. Using standard size instead.");const x="synth-button",_=`synth-button--${h}`,w=`synth-button--${m}`,S=[x,_,w,v?"synth-button--full-width":"",g?"synth-button--icon-only":"",o].filter(Boolean).join(" "),k=()=>{switch(m){case"iconOnly":return 24;case"tertiary":return 19;case"standard":default:return 24}},C=()=>{if(!r)return null;const R=k();return s.jsx(Re,{name:r,size:R,className:"synth-button__icon"})},A=g||!i&&r&&m==="iconOnly";return s.jsx("button",V(D({type:"button",className:S,disabled:u,"aria-label":A&&!c["aria-label"]&&!i?r:c["aria-label"]},c),{children:A?C():s.jsxs(s.Fragment,{children:[r&&n==="left"&&C(),i&&s.jsx("span",{className:"synth-button__text",children:i}),r&&n==="right"&&C()]})}))},Bg=({text:e,icon:t,iconPosition:r,className:n="",onClick:a})=>{const i="icon-text",o=`icon-text--${r}`,c=[i,o,a?"icon-text--clickable":"",n].filter(Boolean).join(" "),d=s.jsxs(s.Fragment,{children:[r==="left"&&s.jsxs(s.Fragment,{children:[s.jsx(Re,{name:t,size:24,alt:"",className:"icon-text__icon"}),s.jsx("span",{className:"icon-text__text",children:e})]}),r==="right"&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"icon-text__text",children:e}),s.jsx(Re,{name:t,size:24,alt:"",className:"icon-text__icon"})]})]});return a?s.jsx("button",{className:c,onClick:a,type:"button","aria-label":e,children:d}):s.jsx("div",{className:c,children:d})},Ru=({label:e,icon:t,onPress:r,className:n=""})=>{const o=["menu-category",r?"menu-category--clickable":"",n].filter(Boolean).join(" "),l=s.jsx("div",{className:"menu-category__content",children:s.jsx(Bg,{text:e,icon:t,iconPosition:"left",className:"menu-category__icon-text"})});return r?s.jsx("button",{className:o,onClick:r,type:"button","aria-label":e,children:l}):s.jsx("div",{className:o,children:l})};class sw{static refreshSignals(){return E(this,null,function*(){try{const{data:t,error:r}=yield T.rpc("refresh_user_preference_signals");return r?(console.error("Error refreshing preference signals:",r),{success:!1,error:r.message}):t&&t.success?(console.log(" Preference signals refreshed:",{signalsUpdated:t.signals_updated,timestamp:t.timestamp}),{success:!0,signalsUpdated:t.signals_updated}):{success:!1,error:"Unknown error"}}catch(t){return console.error("Exception refreshing preference signals:",t),{success:!1,error:t instanceof Error?t.message:"Unknown error"}}})}static shouldRefreshForSession(){const t=localStorage.getItem(this.SESSION_REFRESH_KEY);if(!t)return!0;const r=parseInt(t,10);return Date.now()-r>this.REFRESH_COOLDOWN_MS}static markRefreshed(){localStorage.setItem(this.SESSION_REFRESH_KEY,Date.now().toString())}static clearRefreshMarker(){localStorage.removeItem(this.SESSION_REFRESH_KEY)}static refreshIfNeeded(){return E(this,null,function*(){if(!this.shouldRefreshForSession()){console.log(" Skipping preference signals refresh (recently refreshed)");return}console.log(" Refreshing preference signals at session start..."),(yield this.refreshSignals()).success?this.markRefreshed():console.warn(" Preference signals refresh failed, will retry on next session")})}}Pr(sw,"SESSION_REFRESH_KEY","preference_signals_refreshed"),Pr(sw,"REFRESH_COOLDOWN_MS",60*60*1e3);function ws(){const[e,t]=y.useState(null),[r,n]=y.useState(null),[a,i]=y.useState(!0),[o,l]=y.useState(!1),c=y.useRef(null);return y.useEffect(()=>{E(this,null,function*(){try{const{data:{session:v},error:g}=yield T.auth.getSession();if(g)console.error("Error getting session:",g),l(!0),n(null),t(null);else if(v){const x=Math.floor(Date.now()/1e3);v.expires_at&&v.expires_at<x?(console.log("Initial session expired"),l(!0),n(null),t(null)):(l(!1),n(v),t(v.user),c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{sw.refreshIfNeeded().catch(_=>{console.warn("Failed to refresh preference signals:",_)}),c.current=null},1e3))}else l(!1),n(null),t(null)}catch(v){console.error("Error in getInitialSession:",v),l(!0),n(null),t(null)}finally{i(!1)}});const h=setInterval(()=>E(this,null,function*(){try{const{data:{session:v},error:g}=yield T.auth.getSession();if(g)console.error("Error checking session:",g),l(!0),n(null),t(null);else if(v){const x=Math.floor(Date.now()/1e3);v.expires_at&&v.expires_at<x&&(console.log("Session expired during periodic check"),l(!0),n(null),t(null))}}catch(v){console.error("Error in periodic session check:",v)}}),5*60*1e3),{data:{subscription:m}}=T.auth.onAuthStateChange((v,g)=>E(this,null,function*(){var x;if(console.log("Auth state changed:",v,(x=g==null?void 0:g.user)==null?void 0:x.id),v==="SIGNED_OUT")console.log("User signed out"),l(!1),n(null),t(null);else if(v==="TOKEN_REFRESHED"&&!g)console.log("Session expired - no valid session after token refresh"),l(!0),n(null),t(null);else if(g){const _=Math.floor(Date.now()/1e3);g.expires_at&&g.expires_at<_?(console.log("Session expired - expires_at is in the past"),l(!0),n(null),t(null)):(console.log("Valid session found"),l(!1),n(g),t(g.user),(v==="SIGNED_IN"||v==="TOKEN_REFRESHED"||v==="INITIAL_SESSION")&&(c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{sw.refreshIfNeeded().catch(w=>{console.warn("Failed to refresh preference signals:",w)}),c.current=null},1e3)))}else console.log("No session available"),l(!1),n(null),t(null);i(!1)}));return()=>{m.unsubscribe(),clearInterval(h),c.current&&(clearTimeout(c.current),c.current=null)}},[]),{user:e,session:r,loading:a,sessionExpired:o,signOut:()=>E(this,null,function*(){try{i(!0);const{error:u}=yield T.auth.signOut();u&&console.error("Error signing out:",u)}catch(u){console.error("Error in signOut:",u)}finally{i(!1)}}),resetSessionExpired:()=>{l(!1)}}}class ooe{constructor(){Pr(this,"cache",new Map);Pr(this,"maxSize",1e3)}get(t){const r=this.cache.get(t);return r?Date.now()-r.timestamp>r.ttl?(this.cache.delete(t),null):r.data:null}set(t,r,n){if(this.cache.size>=this.maxSize){const a=this.cache.keys().next().value;a&&this.cache.delete(a)}this.cache.set(t,{data:r,timestamp:Date.now(),ttl:n})}delete(t){this.cache.delete(t)}clear(){this.cache.clear()}clearPattern(t){const r=[];for(const n of this.cache.keys())n.startsWith(t)&&r.push(n);r.forEach(n=>this.cache.delete(n))}cleanup(){const t=Date.now(),r=[];for(const[n,a]of this.cache.entries())t-a.timestamp>a.ttl&&r.push(n);r.forEach(n=>this.cache.delete(n))}getStats(){const t=Date.now();let r=0,n=0;for(const a of this.cache.values())t-a.timestamp>a.ttl?r++:n++;return{total:this.cache.size,active:n,expired:r}}}const Fo=new ooe;typeof window!="undefined"&&setInterval(()=>{Fo.cleanup()},5*60*1e3);const N2={connectionDegree:(e,t)=>`connection_degree_${t}_${e}`,connectionInterests:e=>`connection_interests_${e}`,reviews:(e,t,r)=>`reviews_${e}_${t}_${r}`,chatPreviews:e=>`chat_previews_${e}`,userProfile:e=>`user_profile_${e}`,notifications:(e,t)=>`notifications_${e}_${t}`,messages:e=>`messages_${e}`},Bv={CONNECTION_DATA:10*60*1e3,REVIEWS:3*60*1e3,CHAT_PREVIEWS:2*60*1e3,USER_PROFILE:5*60*1e3,NOTIFICATIONS:2*60*1e3,MESSAGES:1*60*1e3},jn={log:(...e)=>{},warn:(...e)=>{},error:(...e)=>{console.error(...e)},info:(...e)=>{},debug:(...e)=>{}};function hf(){const{user:e}=ws(),[t,r]=y.useState(null),[n,a]=y.useState(!0),[i,o]=y.useState(null);y.useEffect(()=>{if(!e){r(null),a(!1);return}l()},[e]);const l=()=>E(this,null,function*(){if(e)try{a(!0),o(null);const g=N2.userProfile(e.id),x=Fo.get(g);if(x){r(x),a(!1);return}const{data:_,error:w}=yield T.from("users_complete").select("account_type, subscription_tier, verified, verification_level, business_info").eq("user_id",e.id).single();if(w)jn.error(" useAccountType: Error fetching account info:",w),o(w.message),r({account_type:"user",subscription_tier:"free",verified:!1,verification_level:"none"});else{const b={account_type:_.account_type||"user",subscription_tier:_.subscription_tier||"free",verified:_.verified||!1,verification_level:_.verification_level||"none",business_info:_.business_info};r(b),Fo.set(g,b,Bv.USER_PROFILE)}}catch(g){jn.error(" useAccountType: Error in fetchAccountInfo:",g),o("Failed to fetch account information"),r({account_type:"user",subscription_tier:"free",verified:!1,verification_level:"none"})}finally{a(!1)}});return{accountInfo:t,loading:n,error:i,hasAnalyticsAccess:()=>t?["creator","business","admin"].includes(t.account_type):!1,isAdmin:()=>(t==null?void 0:t.account_type)==="admin",isCreator:()=>(t==null?void 0:t.account_type)==="creator",isBusiness:()=>(t==null?void 0:t.account_type)==="business",isRegularUser:()=>(t==null?void 0:t.account_type)==="user",hasPremiumFeatures:()=>t?["premium","professional","enterprise"].includes(t.subscription_tier):!1,getAnalyticsDashboardRoute:()=>{if(!t)return null;switch(t.account_type){case"creator":return"/analytics/creator";case"business":return"/analytics/business";case"admin":return"/analytics/admin";default:return null}},refetch:l}}const Ze=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx("div",D({ref:r,className:Oe("synth-card synth-hover-lift",e)},t))});Ze.displayName="Card";const kr=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx("div",D({ref:r,className:Oe("flex flex-col space-y-1.5 p-6 relative",e)},t))});kr.displayName="CardHeader";const Lr=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx("h3",D({ref:r,className:Oe("text-2xl font-semibold leading-none tracking-tight synth-heading",e)},t))});Lr.displayName="CardTitle";const zo=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx("p",D({ref:r,className:Oe("text-sm text-muted-foreground synth-text",e)},t))});zo.displayName="CardDescription";const tt=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx("div",D({ref:r,className:Oe("p-6 pt-0 relative",e)},t))});tt.displayName="CardContent";const loe=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx("div",D({ref:r,className:Oe("flex items-center p-6 pt-0 relative",e)},t))});loe.displayName="CardFooter";const dT=mp("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 synth-focus",{variants:{variant:{default:"btn-synth-primary",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 hover:shadow-lg hover:shadow-destructive/25 hover:-translate-y-0.5",outline:"btn-synth-secondary",secondary:"btn-synth-secondary",ghost:"btn-ghost",link:"text-primary underline-offset-4 hover:underline",synth:"btn-synth-primary","synth-secondary":"btn-synth-secondary"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-lg px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ce=y.forwardRef((o,i)=>{var l=o,{className:e,variant:t,size:r,asChild:n=!1}=l,a=ge(l,["className","variant","size","asChild"]);const c=n?UJ:"button";return s.jsx(c,D({className:Oe(dT({variant:t,size:r,className:e})),ref:i},a))});ce.displayName="Button";function coe(e){switch(e){case"business":return{icon:dee,colors:{from:"#3B82F6",to:"#2563EB",text:"text-blue-600"},label:"Verified Business",description:"This is a verified business account with confirmed venue or promoter credentials."};case"creator":return{icon:Xt,colors:{from:"#A855F7",to:"#9333EA",text:"text-purple-600"},label:"Verified Creator",description:"This is a verified creator account with confirmed artist or influencer credentials."};case"admin":return{icon:uf,colors:{from:"#F59E0B",to:"#D97706",text:"text-amber-600"},label:"Admin",description:"This is an official Synth platform administrator."};case"user":default:return{icon:pc,colors:{from:"#10B981",to:"#059669",text:"text-emerald-600"},label:"Verified User",description:"This user has met trust and safety criteria for verification."}}}function EM(e,t=0,r=0,n=0,a=0){const i={profileComplete:!!(e.name&&e.bio&&e.avatar_url&&e.birthday&&e.gender),streamingConnected:!!e.music_streaming_profile,hasReviews:t>=3,hasFriends:r>=10,hasEvents:n>=10,accountAge:e.created_at?new Date().getTime()-new Date(e.created_at).getTime()>=2592e6:!1,emailVerified:!0,hasAttended:a>=3},o=Object.values(i).filter(Boolean).length,l=Object.keys(i).length,c=Math.round(o/l*100),d=o>=4;return{score:c,criteriaMet:o,totalCriteria:l,criteria:i,isVerified:d}}function doe(e){const t=["name","bio","avatar_url","birthday","gender"];let r=0;for(const n of t)e[n]&&r++;return Math.round(r/t.length*100)}function uoe(e,t,r){let n;return e==="profileComplete"&&t&&(n=doe(t)),{profileComplete:{label:"Complete Profile",description:"Fill out your name, bio, avatar, birthday, and gender",target:n!==void 0?`${n}% complete`:"100% complete"},streamingConnected:{label:"Streaming Account",description:"Connect your Spotify or Apple Music account",target:"Connected"},hasReviews:{label:"Event Reviews",description:"Share your concert experiences by posting reviews",target:"3+ reviews"},hasFriends:{label:"Friend Network",description:"Build your network by connecting with other users",target:r!==void 0?`${r}+ friends`:"10+ friends"},hasEvents:{label:"Event Interests",description:"Show interest in concerts you want to attend",target:"10+ events"},accountAge:{label:"Account Age",description:"Be an active member of the community",target:"30+ days"},emailVerified:{label:"Email Verified",description:"Verify your email address",target:"Verified"},hasAttended:{label:"Event Attendance",description:"Attend and review concerts",target:"3+ attended"}}[e]}class aw{static checkVerificationStatus(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("users").select("account_type").eq("user_id",t).single();if(n||!r)throw new Error("User not found");const{data:a,error:i}=yield T.from("user_verifications").select("*").eq("user_id",t).single();if(r.account_type!=="user")return(i||!a)&&(yield T.from("user_verifications").upsert({user_id:t,verified:!0,verification_level:"premium",trust_score:100})),{verified:(a==null?void 0:a.verified)||!0,trustScore:(a==null?void 0:a.trust_score)||100,criteriaMet:8};const{count:o}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t),{count:l}=yield T.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`),{count:c}=yield T.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("user_id",t).in("relationship_type",["interested","going","maybe"]),{count:d}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("was_there",!0),{data:f,error:u}=yield T.from("users_complete").select("*").eq("user_id",t).single();if(u||!f)throw console.error("Error fetching profile for trust score calculation:",u),new Error("Profile not found for trust score calculation");const h=EM(f,o||0,l||0,c||0,d||0),{error:m}=yield T.from("user_verifications").upsert({user_id:t,trust_score:h.score,verification_criteria_met:h.criteria,verified:h.isVerified,verified_at:h.isVerified&&!(a!=null&&a.verified_at)?new Date().toISOString():a==null?void 0:a.verified_at});return m&&console.error("Error updating verification status:",m),{verified:h.isVerified,trustScore:h.score,criteriaMet:h.criteriaMet}}catch(r){throw console.error("Error checking verification status:",r),r}})}static getTrustScoreBreakdown(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("users_complete").select("*").eq("user_id",t).single();if(n||!r)throw new Error("Profile not found");const{count:a}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t),{count:i}=yield T.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`),{count:o}=yield T.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("user_id",t).in("relationship_type",["interested","going","maybe"]),{count:l}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("was_there",!0),c=EM(r,a||0,i||0,o||0,l||0);return V(D({},c),{profile:r,friendCount:i||0})}catch(r){throw console.error("Error getting trust score breakdown:",r),r}})}static refreshVerificationStatus(t){return E(this,null,function*(){yield this.checkVerificationStatus(t)})}static manuallyVerifyUser(t,r,n){return E(this,null,function*(){try{const{data:a}=yield T.from("users").select("account_type").eq("user_id",r).single();if((a==null?void 0:a.account_type)!=="admin")throw new Error("Only admins can manually verify users");const{error:i}=yield T.from("user_verifications").upsert({user_id:t,verified:n,verified_by:n?r:null,verified_at:n?new Date().toISOString():null});if(i)throw i}catch(a){throw console.error("Error manually verifying user:",a),a}})}static getUsersNearVerification(t=50){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("users").select(`
          *,
          user_verifications!inner (
            verified,
            trust_score,
            verification_level
          )
        `).eq("account_type","user").eq("user_verifications.verified",!1).gte("user_verifications.trust_score",40).order("user_verifications.trust_score",{ascending:!1}).limit(t);if(n)throw n;return r||[]}catch(r){throw console.error("Error getting users near verification:",r),r}})}}function foe(e){const[t,r]=y.useState(null),[n,a]=y.useState(!0),[i,o]=y.useState(null);return y.useEffect(()=>{if(!e){r(null),a(!1);return}let l=!0;return E(this,null,function*(){try{a(!0);const d=yield aw.getTrustScoreBreakdown(e);if(!l)return;r(d),o(null)}catch(d){if(!l)return;o(d instanceof Error?d.message:"Unknown error")}finally{l&&a(!1)}}),()=>{l=!1}},[e]),{breakdown:t,loading:n,error:i}}function F9({userId:e,accountType:t,verified:r}){const{breakdown:n,loading:a,error:i}=foe(e),[o,l]=y.useState(!1),{toast:c}=Er();if(t!=="user")return r?s.jsxs(Ze,{children:[s.jsxs(kr,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Fl,{className:"w-5 h-5 text-primary"}),s.jsx(Lr,{children:"Verified Account"})]}),s.jsxs(zo,{children:["Your ",t," account is verified and trusted by the Synth community."]})]}),s.jsx(tt,{children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(pc,{className:"w-16 h-16 text-green-500"})})})]}):s.jsx(Ze,{children:s.jsxs(kr,{children:[s.jsx(Lr,{children:"Verification Status"}),s.jsx(zo,{children:"Verification details are not available for this account type."})]})});const d=()=>E(this,null,function*(){try{l(!0),yield aw.refreshVerificationStatus(e),c({title:"Status Updated",description:"Your verification status has been refreshed."})}catch(u){c({title:"Error",description:"Failed to refresh verification status.",variant:"destructive"})}finally{l(!1)}});if(a)return s.jsxs(Ze,{children:[s.jsx(kr,{children:s.jsx(Lr,{children:"Verification Status"})}),s.jsx(tt,{children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]});if(i||!n||!e)return s.jsx(Ze,{children:s.jsxs(kr,{children:[s.jsx(Lr,{children:"Verification Status"}),s.jsx(zo,{children:"Verification details are currently unavailable."})]})});const f=n.criteriaMet/n.totalCriteria*100;return s.jsxs(Ze,{children:[s.jsx(kr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs(Lr,{className:"flex items-center gap-2",children:["Verification Status",r&&s.jsx(pc,{className:"w-5 h-5 text-green-500"})]}),s.jsx(zo,{children:r?"You are a verified member of the Synth community":"Complete criteria to earn verification"})]}),s.jsx(ce,{variant:"ghost",size:"sm",onClick:d,disabled:o,children:s.jsx(vi,{className:`w-4 h-4 ${o?"animate-spin":""}`})})]})}),s.jsxs(tt,{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Trust Score"}),s.jsxs("span",{className:"text-2xl font-bold text-primary",children:[n.score,"%"]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"8px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all duration-300",style:{width:`${f}%`,background:"var(--gradient-brand)",borderRadius:f>=100?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:f>0?"4px":"0"}})}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.criteriaMet," of ",n.totalCriteria," criteria met",!r&&n.criteriaMet<4&&s.jsxs(s.Fragment,{children:["  ",4-n.criteriaMet," more needed for verification"]})]})]}),r&&s.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(pc,{className:"w-8 h-8 text-green-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-green-900",children:"Verified User"}),s.jsx("p",{className:"text-sm text-green-700",children:"You have earned the trusted user badge"})]})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-semibold text-sm",children:"Verification Criteria"}),Object.entries(n.criteria).map(([u,h])=>{const m=uoe(u,n.profile,n.friendCount);return s.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg border ${h?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[s.jsx("div",{className:"flex-shrink-0 mt-0.5",children:h?s.jsx(pc,{className:"w-5 h-5 text-green-600"}):s.jsx(XF,{className:"w-5 h-5 text-gray-400"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("h5",{className:"font-medium text-sm",children:m.label}),s.jsx("div",{style:{height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",backgroundColor:h?"#f0fdf4":"#f9fafb",color:h?"#16a34a":"#6b7280",border:h?"2px solid #bbf7d0":"2px solid #e5e7eb",borderRadius:"999px",display:"inline-flex",alignItems:"center",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",whiteSpace:"nowrap"},children:m.target})]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:m.description})]})]},u)})]}),!r&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-sm text-blue-900 mb-2",children:"Tips to Get Verified"}),s.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[s.jsx("li",{children:" Complete your profile with all information"}),s.jsx("li",{children:" Connect your music streaming account"}),s.jsx("li",{children:" Post reviews for concerts you attend"}),s.jsx("li",{children:" Build your friend network"}),s.jsx("li",{children:" Mark concerts you're interested in"})]})]})]})]})}const z9=({isOpen:e,onClose:t,onToggle:r,onNavigateToNotifications:n,onNavigateToProfile:a,onNavigateToSettings:i,onNavigateToVerification:o,onSignOut:l})=>{var _;const c=ts(),{user:d}=ws(),{accountInfo:f}=hf(),[u,h]=y.useState(null);y.useEffect(()=>{E(void 0,null,function*(){if(e){if(!d){h(null);return}try{const{data:b,error:N}=yield T.from("users").select("name, username, avatar_url").eq("user_id",d.id).maybeSingle();if(N&&N.code==="PGRST116"){const{data:S}=yield T.from("users").select("name, username, avatar_url").eq("id",d.id).maybeSingle();h(S||null)}else h(N?null:b||null)}catch(b){console.error("SideMenu: Error fetching user profile",b),h(null)}}})},[e,d]);const m=w=>{if(!w)return"?";const b=w.trim();return b?b[0].toUpperCase():"?"},v=w=>{w.target===w.currentTarget&&t()},g=()=>{t(),r&&r()},x=()=>E(void 0,null,function*(){if(t(),l)yield l();else{try{yield T.auth.signOut()}catch(w){console.error("Error signing out:",w)}c("/")}});return e?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"side-menu__overlay",onClick:v,"aria-hidden":"true"}),s.jsxs("aside",{className:"side-menu__drawer",role:"dialog","aria-modal":"true","aria-label":"Navigation menu",children:[s.jsx("div",{className:"side-menu__safe-area-spacer"}),s.jsx("div",{className:"side-menu__header-bar",children:s.jsx("button",{className:"side-menu__close-button",onClick:g,"aria-label":"Close menu",type:"button",children:s.jsx(Re,{name:"x",size:24,alt:""})})}),s.jsxs("div",{className:"side-menu__content",children:[s.jsx("div",{className:"side-menu__user-info-section",children:s.jsx(fc,{variant:"user",name:(u==null?void 0:u.name)||((_=d==null?void 0:d.email)==null?void 0:_.split("@")[0])||"User",username:(u==null?void 0:u.username)||void 0,initial:m((u==null?void 0:u.name)||(d==null?void 0:d.email)),imageUrl:(u==null?void 0:u.avatar_url)||void 0})}),s.jsxs("div",{className:"side-menu__list",children:[s.jsx(Ru,{label:"Notifications",icon:"bell",onPress:()=>{try{Zt.click("view","side_menu_notifications",{source:"side_menu"})}catch(w){console.error("Error tracking menu click:",w)}n==null||n(),t()}}),s.jsx(Ru,{label:"Event Timeline",icon:"music",onPress:()=>{try{Zt.click("view","side_menu_timeline",{source:"side_menu"})}catch(w){console.error("Error tracking menu click:",w)}a&&(sessionStorage.setItem("profileTab","timeline"),a(void 0,"timeline")),t()}}),s.jsx(Ru,{label:"Interested",icon:"heart",onPress:()=>{try{Zt.click("view","side_menu_interested",{source:"side_menu"})}catch(w){console.error("Error tracking menu click:",w)}a&&(sessionStorage.setItem("profileTab","interested"),a(void 0,"interested")),t()}}),s.jsx(Ru,{label:"Settings",icon:"settings",onPress:()=>{try{Zt.click("view","side_menu_settings",{source:"side_menu"})}catch(w){console.error("Error tracking menu click:",w)}i==null||i(),t()}})]}),d&&f&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"side-menu__section-divider","aria-hidden":"true"}),s.jsx("div",{className:"side-menu__verification-section",children:s.jsx(F9,{userId:d.id,accountType:f.account_type||"user",verified:f.verified||!1})}),s.jsx("div",{className:"side-menu__verification-divider","aria-hidden":"true"})]}),s.jsx("div",{className:"side-menu__logout-section",children:s.jsx(Nn,{variant:"primary",size:"standard",fullWidth:!0,onClick:x,children:"Log out"})})]})]})]}):null},CM=({currentView:e,onViewChange:t,onOpenEventReview:r})=>{const n=e==="feed",a=e==="search",i=e==="chat",o=e==="profile",l=(d,f)=>{f?(window.scrollTo({top:0,behavior:"smooth"}),window.location.reload()):d()},c=[{id:"home",label:"Home",icon:n?"houseSelected":"house",onClick:()=>{Zt.navigate(e,"feed",{source:"bottom_nav"}),t("feed")},isActive:n},{id:"discover",label:"Discover",icon:a?"discoverSelected":"discover",onClick:()=>{Zt.navigate(e,"discover",{source:"bottom_nav"}),t("search")},isActive:a},{id:"post",label:"Post",icon:"plus",onClick:()=>{Zt.click("view","create_post",{source:"bottom_nav"}),r?r():t("search")},isCTA:!0},{id:"messages",label:"Messages",icon:i?"circleCommentSelected":"circleComment",onClick:()=>{Zt.navigate(e,"chat",{source:"bottom_nav"}),t("chat")},isActive:i},{id:"profile",label:"Profile",icon:o?"userSelected":"user",onClick:()=>{Zt.navigate(e,"profile",{source:"bottom_nav"}),t("profile")},isActive:o}];return s.jsx("nav",{className:"bottom-nav",role:"navigation","aria-label":"Main navigation",children:s.jsx("div",{className:"bottom-nav__container",children:c.map(d=>d.isCTA?s.jsx("button",{className:"bottom-nav__item bottom-nav__item--cta",onClick:()=>l(d.onClick,d.isActive),"aria-label":d.label,"aria-current":d.isActive?"page":void 0,type:"button",children:s.jsx(Re,{name:d.icon,size:24,alt:""})},d.id):s.jsx("button",{className:`bottom-nav__item ${d.isActive?"bottom-nav__item--active":""}`,onClick:()=>l(d.onClick,d.isActive),"aria-label":d.label,"aria-current":d.isActive?"page":void 0,type:"button",children:s.jsx(Re,{name:d.icon,size:24,alt:""})},d.id))})})},B9=e=>{y.useEffect(()=>{if(e){const t=window.scrollY;return document.body.style.position="fixed",document.body.style.top=`-${t}px`,document.body.style.width="100%",document.body.style.overflow="hidden",()=>{document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,t)}}},[e])};var BN="focusScope.autoFocusOnMount",UN="focusScope.autoFocusOnUnmount",PM={bubbles:!1,cancelable:!0},hoe="FocusScope",Xy=y.forwardRef((e,t)=>{const g=e,{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i}=g,o=ge(g,["loop","trapped","onMountAutoFocus","onUnmountAutoFocus"]),[l,c]=y.useState(null),d=ys(a),f=ys(i),u=y.useRef(null),h=mr(t,x=>c(x)),m=y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;y.useEffect(()=>{if(n){let x=function(N){if(m.paused||!l)return;const S=N.target;l.contains(S)?u.current=S:od(u.current,{select:!0})},_=function(N){if(m.paused||!l)return;const S=N.relatedTarget;S!==null&&(l.contains(S)||od(u.current,{select:!0}))},w=function(N){if(document.activeElement===document.body)for(const k of N)k.removedNodes.length>0&&od(l)};document.addEventListener("focusin",x),document.addEventListener("focusout",_);const b=new MutationObserver(w);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",_),b.disconnect()}}},[n,l,m.paused]),y.useEffect(()=>{if(l){AM.add(m);const x=document.activeElement;if(!l.contains(x)){const w=new CustomEvent(BN,PM);l.addEventListener(BN,d),l.dispatchEvent(w),w.defaultPrevented||(moe(xoe(U9(l)),{select:!0}),document.activeElement===x&&od(l))}return()=>{l.removeEventListener(BN,d),setTimeout(()=>{const w=new CustomEvent(UN,PM);l.addEventListener(UN,f),l.dispatchEvent(w),w.defaultPrevented||od(x!=null?x:document.body,{select:!0}),l.removeEventListener(UN,f),AM.remove(m)},0)}}},[l,d,f,m]);const v=y.useCallback(x=>{if(!r&&!n||m.paused)return;const _=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,w=document.activeElement;if(_&&w){const b=x.currentTarget,[N,S]=poe(b);N&&S?!x.shiftKey&&w===S?(x.preventDefault(),r&&od(N,{select:!0})):x.shiftKey&&w===N&&(x.preventDefault(),r&&od(S,{select:!0})):w===b&&x.preventDefault()}},[r,n,m.paused]);return s.jsx(Pt.div,V(D({tabIndex:-1},o),{ref:h,onKeyDown:v}))});Xy.displayName=hoe;function moe(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(od(n,{select:t}),document.activeElement!==r)return}function poe(e){const t=U9(e),r=TM(t,e),n=TM(t.reverse(),e);return[r,n]}function U9(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function TM(e,t){for(const r of e)if(!goe(r,{upTo:t}))return r}function goe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function voe(e){return e instanceof HTMLInputElement&&"select"in e}function od(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&voe(e)&&t&&e.select()}}var AM=yoe();function yoe(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=RM(e,t),e.unshift(t)},remove(t){var r;e=RM(e,t),(r=e[0])==null||r.resume()}}}function RM(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function xoe(e){return e.filter(t=>t.tagName!=="A")}var qN=0;function u1(){y.useEffect(()=>{var t,r;const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=e[0])!=null?t:OM()),document.body.insertAdjacentElement("beforeend",(r=e[1])!=null?r:OM()),qN++,()=>{qN===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),qN--}},[])}function OM(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var _l=function(){return _l=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},_l.apply(this,arguments)};function q9(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function _oe(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}var h_="right-scroll-bar-position",m_="width-before-scroll-bar",woe="with-scroll-bars-hidden",boe="--removed-body-scroll-bar-size";function VN(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function joe(e,t){var r=y.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var Noe=typeof window!="undefined"?y.useLayoutEffect:y.useEffect,MM=new WeakMap;function Soe(e,t){var r=joe(null,function(n){return e.forEach(function(a){return VN(a,n)})});return Noe(function(){var n=MM.get(r);if(n){var a=new Set(n),i=new Set(e),o=r.current;a.forEach(function(l){i.has(l)||VN(l,null)}),i.forEach(function(l){a.has(l)||VN(l,o)})}MM.set(r,e)},[e]),r}function koe(e){return e}function Eoe(e,t){t===void 0&&(t=koe);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var o=t(i,n);return r.push(o),function(){r=r.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(n=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(l){return i(l)},filter:function(){return r}}},assignMedium:function(i){n=!0;var o=[];if(r.length){var l=r;r=[],l.forEach(i),o=r}var c=function(){var f=o;o=[],f.forEach(i)},d=function(){return Promise.resolve().then(c)};d(),r={push:function(f){o.push(f),d()},filter:function(f){return o=o.filter(f),r}}}};return a}function Coe(e){e===void 0&&(e={});var t=Eoe(null);return t.options=_l({async:!0,ssr:!1},e),t}var V9=function(e){var t=e.sideCar,r=q9(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return y.createElement(n,_l({},r))};V9.isSideCarExport=!0;function Poe(e,t){return e.useMedium(t),V9}var W9=Coe(),WN=function(){},f1=y.forwardRef(function(e,t){var r=y.useRef(null),n=y.useState({onScrollCapture:WN,onWheelCapture:WN,onTouchMoveCapture:WN}),a=n[0],i=n[1],o=e.forwardProps,l=e.children,c=e.className,d=e.removeScrollBar,f=e.enabled,u=e.shards,h=e.sideCar,m=e.noRelative,v=e.noIsolation,g=e.inert,x=e.allowPinchZoom,_=e.as,w=_===void 0?"div":_,b=e.gapMode,N=q9(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=h,k=Soe([r,t]),C=_l(_l({},N),a);return y.createElement(y.Fragment,null,f&&y.createElement(S,{sideCar:W9,removeScrollBar:d,shards:u,noRelative:m,noIsolation:v,inert:g,setCallbacks:i,allowPinchZoom:!!x,lockRef:r,gapMode:b}),o?y.cloneElement(y.Children.only(l),_l(_l({},C),{ref:k})):y.createElement(w,_l({},C,{className:c,ref:k}),l))});f1.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};f1.classNames={fullWidth:m_,zeroRight:h_};var Toe=function(){if(typeof __webpack_nonce__!="undefined")return __webpack_nonce__};function Aoe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Toe();return t&&e.setAttribute("nonce",t),e}function Roe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Ooe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Moe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=Aoe())&&(Roe(t,r),Ooe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Doe=function(){var e=Moe();return function(t,r){y.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},H9=function(){var e=Doe(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},Ioe={left:0,top:0,right:0,gap:0},HN=function(e){return parseInt(e||"",10)||0},$oe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[HN(r),HN(n),HN(a)]},Loe=function(e){if(e===void 0&&(e="margin"),typeof window=="undefined")return Ioe;var t=$oe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Foe=H9(),Kh="data-scroll-locked",zoe=function(e,t,r,n){var a=e.left,i=e.top,o=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(woe,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(Kh,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(h_,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(m_,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(h_," .").concat(h_,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(m_," .").concat(m_,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Kh,`] {
    `).concat(boe,": ").concat(l,`px;
  }
`)},DM=function(){var e=parseInt(document.body.getAttribute(Kh)||"0",10);return isFinite(e)?e:0},Boe=function(){y.useEffect(function(){return document.body.setAttribute(Kh,(DM()+1).toString()),function(){var e=DM()-1;e<=0?document.body.removeAttribute(Kh):document.body.setAttribute(Kh,e.toString())}},[])},Uoe=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;Boe();var i=y.useMemo(function(){return Loe(a)},[a]);return y.createElement(Foe,{styles:zoe(i,!t,a,r?"":"!important")})},S2=!1;if(typeof window!="undefined")try{var jx=Object.defineProperty({},"passive",{get:function(){return S2=!0,!0}});window.addEventListener("test",jx,jx),window.removeEventListener("test",jx,jx)}catch(e){S2=!1}var th=S2?{passive:!1}:!1,qoe=function(e){return e.tagName==="TEXTAREA"},G9=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!qoe(e)&&r[t]==="visible")},Voe=function(e){return G9(e,"overflowY")},Woe=function(e){return G9(e,"overflowX")},IM=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot!="undefined"&&n instanceof ShadowRoot&&(n=n.host);var a=Y9(e,n);if(a){var i=K9(e,n),o=i[1],l=i[2];if(o>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Hoe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Goe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},Y9=function(e,t){return e==="v"?Voe(t):Woe(t)},K9=function(e,t){return e==="v"?Hoe(t):Goe(t)},Yoe=function(e,t){return e==="h"&&t==="rtl"?-1:1},Koe=function(e,t,r,n,a){var i=Yoe(e,window.getComputedStyle(t).direction),o=i*n,l=r.target,c=t.contains(l),d=!1,f=o>0,u=0,h=0;do{if(!l)break;var m=K9(e,l),v=m[0],g=m[1],x=m[2],_=g-x-i*v;(v||_)&&Y9(e,l)&&(u+=_,h+=v);var w=l.parentNode;l=w&&w.nodeType===Node.DOCUMENT_FRAGMENT_NODE?w.host:w}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(f&&(Math.abs(u)<1||!a)||!f&&(Math.abs(h)<1||!a))&&(d=!0),d},Nx=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},$M=function(e){return[e.deltaX,e.deltaY]},LM=function(e){return e&&"current"in e?e.current:e},Zoe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Xoe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Joe=0,rh=[];function Qoe(e){var t=y.useRef([]),r=y.useRef([0,0]),n=y.useRef(),a=y.useState(Joe++)[0],i=y.useState(H9)[0],o=y.useRef(e);y.useEffect(function(){o.current=e},[e]),y.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var g=_oe([e.lockRef.current],(e.shards||[]).map(LM),!0).filter(Boolean);return g.forEach(function(x){return x.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),g.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var l=y.useCallback(function(g,x){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var _=Nx(g),w=r.current,b="deltaX"in g?g.deltaX:w[0]-_[0],N="deltaY"in g?g.deltaY:w[1]-_[1],S,k=g.target,C=Math.abs(b)>Math.abs(N)?"h":"v";if("touches"in g&&C==="h"&&k.type==="range")return!1;var A=IM(C,k);if(!A)return!0;if(A?S=C:(S=C==="v"?"h":"v",A=IM(C,k)),!A)return!1;if(!n.current&&"changedTouches"in g&&(b||N)&&(n.current=S),!S)return!0;var R=n.current||S;return Koe(R,x,g,R==="h"?b:N,!0)},[]),c=y.useCallback(function(g){var x=g;if(!(!rh.length||rh[rh.length-1]!==i)){var _="deltaY"in x?$M(x):Nx(x),w=t.current.filter(function(S){return S.name===x.type&&(S.target===x.target||x.target===S.shadowParent)&&Zoe(S.delta,_)})[0];if(w&&w.should){x.cancelable&&x.preventDefault();return}if(!w){var b=(o.current.shards||[]).map(LM).filter(Boolean).filter(function(S){return S.contains(x.target)}),N=b.length>0?l(x,b[0]):!o.current.noIsolation;N&&x.cancelable&&x.preventDefault()}}},[]),d=y.useCallback(function(g,x,_,w){var b={name:g,delta:x,target:_,should:w,shadowParent:ele(_)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(N){return N!==b})},1)},[]),f=y.useCallback(function(g){r.current=Nx(g),n.current=void 0},[]),u=y.useCallback(function(g){d(g.type,$M(g),g.target,l(g,e.lockRef.current))},[]),h=y.useCallback(function(g){d(g.type,Nx(g),g.target,l(g,e.lockRef.current))},[]);y.useEffect(function(){return rh.push(i),e.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:h}),document.addEventListener("wheel",c,th),document.addEventListener("touchmove",c,th),document.addEventListener("touchstart",f,th),function(){rh=rh.filter(function(g){return g!==i}),document.removeEventListener("wheel",c,th),document.removeEventListener("touchmove",c,th),document.removeEventListener("touchstart",f,th)}},[]);var m=e.removeScrollBar,v=e.inert;return y.createElement(y.Fragment,null,v?y.createElement(i,{styles:Xoe(a)}):null,m?y.createElement(Uoe,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function ele(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const tle=Poe(W9,Qoe);var Jy=y.forwardRef(function(e,t){return y.createElement(f1,_l({},e,{ref:t,sideCar:tle}))});Jy.classNames=f1.classNames;var rle=function(e){if(typeof document=="undefined")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},nh=new WeakMap,Sx=new WeakMap,kx={},GN=0,Z9=function(e){return e&&(e.host||Z9(e.parentNode))},nle=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=Z9(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},sle=function(e,t,r,n){var a=nle(t,Array.isArray(e)?e:[e]);kx[r]||(kx[r]=new WeakMap);var i=kx[r],o=[],l=new Set,c=new Set(a),d=function(u){!u||l.has(u)||(l.add(u),d(u.parentNode))};a.forEach(d);var f=function(u){!u||c.has(u)||Array.prototype.forEach.call(u.children,function(h){if(l.has(h))f(h);else try{var m=h.getAttribute(n),v=m!==null&&m!=="false",g=(nh.get(h)||0)+1,x=(i.get(h)||0)+1;nh.set(h,g),i.set(h,x),o.push(h),g===1&&v&&Sx.set(h,!0),x===1&&h.setAttribute(r,"true"),v||h.setAttribute(n,"true")}catch(_){console.error("aria-hidden: cannot operate on ",h,_)}})};return f(t),l.clear(),GN++,function(){o.forEach(function(u){var h=nh.get(u)-1,m=i.get(u)-1;nh.set(u,h),i.set(u,m),h||(Sx.has(u)||u.removeAttribute(n),Sx.delete(u)),m||u.removeAttribute(r)}),GN--,GN||(nh=new WeakMap,nh=new WeakMap,Sx=new WeakMap,kx={})}},h1=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=rle(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live]"))),sle(n,a,r,"aria-hidden")):function(){return null}},m1="Dialog",[X9,J9]=$s(m1),[ale,tl]=X9(m1),Q9=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:o=!0}=e,l=y.useRef(null),c=y.useRef(null),[d,f]=Ya({prop:n,defaultProp:a!=null?a:!1,onChange:i,caller:m1});return s.jsx(ale,{scope:t,triggerRef:l,contentRef:c,contentId:Os(),titleId:Os(),descriptionId:Os(),open:d,onOpenChange:f,onOpenToggle:y.useCallback(()=>f(u=>!u),[f]),modal:o,children:r})};Q9.displayName=m1;var e8="DialogTrigger",t8=y.forwardRef((e,t)=>{const o=e,{__scopeDialog:r}=o,n=ge(o,["__scopeDialog"]),a=tl(e8,r),i=mr(t,a.triggerRef);return s.jsx(Pt.button,V(D({type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":hT(a.open)},n),{ref:i,onClick:mt(e.onClick,a.onOpenToggle)}))});t8.displayName=e8;var uT="DialogPortal",[ile,r8]=X9(uT,{forceMount:void 0}),n8=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,i=tl(uT,t);return s.jsx(ile,{scope:t,forceMount:r,children:y.Children.map(n,o=>s.jsx(Ks,{present:r||i.open,children:s.jsx(hp,{asChild:!0,container:a,children:o})}))})};n8.displayName=uT;var iw="DialogOverlay",s8=y.forwardRef((e,t)=>{const r=r8(iw,e.__scopeDialog),o=e,{forceMount:n=r.forceMount}=o,a=ge(o,["forceMount"]),i=tl(iw,e.__scopeDialog);return i.modal?s.jsx(Ks,{present:n||i.open,children:s.jsx(lle,V(D({},a),{ref:t}))}):null});s8.displayName=iw;var ole=Bd("DialogOverlay.RemoveScroll"),lle=y.forwardRef((e,t)=>{const i=e,{__scopeDialog:r}=i,n=ge(i,["__scopeDialog"]),a=tl(iw,r);return s.jsx(Jy,{as:ole,allowPinchZoom:!0,shards:[a.contentRef],children:s.jsx(Pt.div,V(D({"data-state":hT(a.open)},n),{ref:t,style:D({pointerEvents:"auto"},n.style)}))})}),mf="DialogContent",a8=y.forwardRef((e,t)=>{const r=r8(mf,e.__scopeDialog),o=e,{forceMount:n=r.forceMount}=o,a=ge(o,["forceMount"]),i=tl(mf,e.__scopeDialog);return s.jsx(Ks,{present:n||i.open,children:i.modal?s.jsx(cle,V(D({},a),{ref:t})):s.jsx(dle,V(D({},a),{ref:t}))})});a8.displayName=mf;var cle=y.forwardRef((e,t)=>{const r=tl(mf,e.__scopeDialog),n=y.useRef(null),a=mr(t,r.contentRef,n);return y.useEffect(()=>{const i=n.current;if(i)return h1(i)},[]),s.jsx(i8,V(D({},e),{ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:mt(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:mt(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:mt(e.onFocusOutside,i=>i.preventDefault())}))}),dle=y.forwardRef((e,t)=>{const r=tl(mf,e.__scopeDialog),n=y.useRef(!1),a=y.useRef(!1);return s.jsx(i8,V(D({},e),{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var c,d;(c=e.onInteractOutside)==null||c.call(e,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((d=r.triggerRef.current)==null?void 0:d.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}}))}),i8=y.forwardRef((e,t)=>{const f=e,{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i}=f,o=ge(f,["__scopeDialog","trapFocus","onOpenAutoFocus","onCloseAutoFocus"]),l=tl(mf,r),c=y.useRef(null),d=mr(t,c);return u1(),s.jsxs(s.Fragment,{children:[s.jsx(Xy,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:s.jsx(Cf,V(D({role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":hT(l.open)},o),{ref:d,onDismiss:()=>l.onOpenChange(!1)}))}),s.jsxs(s.Fragment,{children:[s.jsx(fle,{titleId:l.titleId}),s.jsx(mle,{contentRef:c,descriptionId:l.descriptionId})]})]})}),fT="DialogTitle",o8=y.forwardRef((e,t)=>{const i=e,{__scopeDialog:r}=i,n=ge(i,["__scopeDialog"]),a=tl(fT,r);return s.jsx(Pt.h2,V(D({id:a.titleId},n),{ref:t}))});o8.displayName=fT;var l8="DialogDescription",c8=y.forwardRef((e,t)=>{const i=e,{__scopeDialog:r}=i,n=ge(i,["__scopeDialog"]),a=tl(l8,r);return s.jsx(Pt.p,V(D({id:a.descriptionId},n),{ref:t}))});c8.displayName=l8;var d8="DialogClose",u8=y.forwardRef((e,t)=>{const i=e,{__scopeDialog:r}=i,n=ge(i,["__scopeDialog"]),a=tl(d8,r);return s.jsx(Pt.button,V(D({type:"button"},n),{ref:t,onClick:mt(e.onClick,()=>a.onOpenChange(!1))}))});u8.displayName=d8;function hT(e){return e?"open":"closed"}var f8="DialogTitleWarning",[ule,h8]=zJ(f8,{contentName:mf,titleName:fT,docsSlug:"dialog"}),fle=({titleId:e})=>{const t=h8(f8),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return y.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},hle="DialogDescriptionWarning",mle=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${h8(hle).contentName}}.`;return y.useEffect(()=>{var i;const a=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},p1=Q9,ple=t8,g1=n8,bp=s8,jp=a8,Qy=o8,e0=c8,v1=u8;const vn=p1,gle=g1,m8=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(bp,D({ref:r,className:Oe("fixed inset-0 z-[9999] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),style:D({backgroundColor:"var(--overlay-50, rgba(14, 14, 14, 0.5))",backdropFilter:"blur(8px)"},t.style)},t))});m8.displayName=bp.displayName;const hn=y.forwardRef((o,i)=>{var l=o,{className:e,children:t,hideCloseButton:r=!1,style:n}=l,a=ge(l,["className","children","hideCloseButton","style"]);return s.jsxs(gle,{children:[s.jsx(m8,{}),s.jsxs(jp,V(D({ref:i,className:Oe("fixed z-[9999] grid gap-4 border bg-background shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg overflow-hidden flex flex-col",e),style:D({left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"calc(100vw - 40px)",maxWidth:"var(--size-popup-width, calc(100vw - 40px))",maxHeight:"calc(100vh - 40px)",backgroundColor:"var(--neutral-50)",border:"1px solid var(--neutral-200)",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 4px 12px 0 var(--shadow-color)",padding:0},n)},a),{children:[s.jsx("div",{style:{display:"flex",flexDirection:"column",height:"100%",maxHeight:"calc(100vh - 40px)",overflow:"hidden"},children:t}),!r&&s.jsxs(v1,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",style:{zIndex:10,width:"44px",height:"44px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"var(--neutral-50)",border:"1px solid var(--neutral-200)",borderRadius:"var(--radius-corner, 10px)",color:"var(--neutral-900)"},children:[s.jsx(Yr,{className:"h-5 w-5"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]}))]})});hn.displayName=jp.displayName;const Hn=r=>{var n=r,{className:e}=n,t=ge(n,["className"]);return s.jsx("div",D({className:Oe("flex flex-col space-y-1.5",e),style:D({padding:"var(--spacing-grouped, 24px)",paddingBottom:"var(--spacing-small, 12px)",flexShrink:0},t.style)},t))};Hn.displayName="DialogHeader";const Tf=r=>{var n=r,{className:e}=n,t=ge(n,["className"]);return s.jsx("div",D({className:Oe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),style:D({padding:"var(--spacing-grouped, 24px)",paddingTop:"var(--spacing-small, 12px)",flexShrink:0},t.style)},t))};Tf.displayName="DialogFooter";const Sn=y.forwardRef((a,n)=>{var i=a,{className:e,style:t}=i,r=ge(i,["className","style"]);return s.jsx(Qy,D({ref:n,className:Oe("leading-none tracking-tight",e),style:D({fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},t)},r))});Sn.displayName=Qy.displayName;const ds=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(e0,D({ref:r,className:Oe("text-sm text-muted-foreground",e)},t))});ds.displayName=e0.displayName;const p8=r=>{var n=r,{className:e}=n,t=ge(n,["className"]);return s.jsx("div",D({className:Oe("flex-1 overflow-y-auto overflow-x-hidden",e),style:D({padding:"0 var(--spacing-grouped, 24px)",WebkitOverflowScrolling:"touch"},t.style)},t))};p8.displayName="DialogBody";const vle=mp("inline-flex items-center border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function et(a){var i=a,{className:e,variant:t,style:r}=i,n=ge(i,["className","variant","style"]);return s.jsx("div",D({className:Oe(vle({variant:t}),e),style:D({borderRadius:"var(--radius-corner, 10px)",height:"25px"},r)},n))}var g8={exports:{}},v8={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sm=y;function yle(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var xle=typeof Object.is=="function"?Object.is:yle,_le=Sm.useState,wle=Sm.useEffect,ble=Sm.useLayoutEffect,jle=Sm.useDebugValue;function Nle(e,t){var r=t(),n=_le({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return ble(function(){a.value=r,a.getSnapshot=t,YN(a)&&i({inst:a})},[e,r,t]),wle(function(){return YN(a)&&i({inst:a}),e(function(){YN(a)&&i({inst:a})})},[e]),jle(r),r}function YN(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!xle(e,r)}catch(n){return!0}}function Sle(e,t){return t()}var kle=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?Sle:Nle;v8.useSyncExternalStore=Sm.useSyncExternalStore!==void 0?Sm.useSyncExternalStore:kle;g8.exports=v8;var Ele=g8.exports;function Cle(){return Ele.useSyncExternalStore(Ple,()=>!0,()=>!1)}function Ple(){return()=>{}}var mT="Avatar",[Tle,tUe]=$s(mT),[Ale,y8]=Tle(mT),x8=y.forwardRef((e,t)=>{const o=e,{__scopeAvatar:r}=o,n=ge(o,["__scopeAvatar"]),[a,i]=y.useState("idle");return s.jsx(Ale,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:i,children:s.jsx(Pt.span,V(D({},n),{ref:t}))})});x8.displayName=mT;var _8="AvatarImage",w8=y.forwardRef((e,t)=>{const d=e,{__scopeAvatar:r,src:n,onLoadingStatusChange:a=()=>{}}=d,i=ge(d,["__scopeAvatar","src","onLoadingStatusChange"]),o=y8(_8,r),l=Rle(n,i),c=ys(f=>{a(f),o.onImageLoadingStatusChange(f)});return xs(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?s.jsx(Pt.img,V(D({},i),{ref:t,src:n})):null});w8.displayName=_8;var b8="AvatarFallback",j8=y.forwardRef((e,t)=>{const c=e,{__scopeAvatar:r,delayMs:n}=c,a=ge(c,["__scopeAvatar","delayMs"]),i=y8(b8,r),[o,l]=y.useState(n===void 0);return y.useEffect(()=>{if(n!==void 0){const d=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(d)}},[n]),o&&i.imageLoadingStatus!=="loaded"?s.jsx(Pt.span,V(D({},a),{ref:t})):null});j8.displayName=b8;function FM(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Rle(e,{referrerPolicy:t,crossOrigin:r}){const n=Cle(),a=y.useRef(null),i=n?(a.current||(a.current=new window.Image),a.current):null,[o,l]=y.useState(()=>FM(i,e));return xs(()=>{l(FM(i,e))},[i,e]),xs(()=>{const c=u=>()=>{l(u)};if(!i)return;const d=c("loaded"),f=c("error");return i.addEventListener("load",d),i.addEventListener("error",f),t&&(i.referrerPolicy=t),typeof r=="string"&&(i.crossOrigin=r),()=>{i.removeEventListener("load",d),i.removeEventListener("error",f)}},[i,r,t]),o}var N8=x8,S8=w8,k8=j8;const Wr=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(N8,D({ref:r,className:Oe("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e)},t))});Wr.displayName=N8.displayName;const Qr=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(S8,D({ref:r,className:Oe("aspect-square h-full w-full",e)},t))});Qr.displayName=S8.displayName;const Hr=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(k8,D({ref:r,className:Oe("flex h-full w-full items-center justify-center rounded-full bg-muted",e)},t))});Hr.displayName=k8.displayName;var Ole=y.createContext(void 0);function Af(e){const t=y.useContext(Ole);return e||t||"ltr"}var KN="rovingFocusGroup.onEntryFocus",Mle={bubbles:!1,cancelable:!0},t0="RovingFocusGroup",[k2,E8,Dle]=fp(t0),[Ile,y1]=$s(t0,[Dle]),[$le,Lle]=Ile(t0),C8=y.forwardRef((e,t)=>s.jsx(k2.Provider,{scope:e.__scopeRovingFocusGroup,children:s.jsx(k2.Slot,{scope:e.__scopeRovingFocusGroup,children:s.jsx(Fle,V(D({},e),{ref:t}))})}));C8.displayName=t0;var Fle=y.forwardRef((e,t)=>{const A=e,{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:f=!1}=A,u=ge(A,["__scopeRovingFocusGroup","orientation","loop","dir","currentTabStopId","defaultCurrentTabStopId","onCurrentTabStopIdChange","onEntryFocus","preventScrollOnEntryFocus"]),h=y.useRef(null),m=mr(t,h),v=Af(i),[g,x]=Ya({prop:o,defaultProp:l!=null?l:null,onChange:c,caller:t0}),[_,w]=y.useState(!1),b=ys(d),N=E8(r),S=y.useRef(!1),[k,C]=y.useState(0);return y.useEffect(()=>{const R=h.current;if(R)return R.addEventListener(KN,b),()=>R.removeEventListener(KN,b)},[b]),s.jsx($le,{scope:r,orientation:n,dir:v,loop:a,currentTabStopId:g,onItemFocus:y.useCallback(R=>x(R),[x]),onItemShiftTab:y.useCallback(()=>w(!0),[]),onFocusableItemAdd:y.useCallback(()=>C(R=>R+1),[]),onFocusableItemRemove:y.useCallback(()=>C(R=>R-1),[]),children:s.jsx(Pt.div,V(D({tabIndex:_||k===0?-1:0,"data-orientation":n},u),{ref:m,style:D({outline:"none"},e.style),onMouseDown:mt(e.onMouseDown,()=>{S.current=!0}),onFocus:mt(e.onFocus,R=>{const I=!S.current;if(R.target===R.currentTarget&&I&&!_){const O=new CustomEvent(KN,Mle);if(R.currentTarget.dispatchEvent(O),!O.defaultPrevented){const z=N().filter(H=>H.focusable),M=z.find(H=>H.active),B=z.find(H=>H.id===g),U=[M,B,...z].filter(Boolean).map(H=>H.ref.current);A8(U,f)}}S.current=!1}),onBlur:mt(e.onBlur,()=>w(!1))}))})}),P8="RovingFocusGroupItem",T8=y.forwardRef((e,t)=>{const x=e,{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:i,children:o}=x,l=ge(x,["__scopeRovingFocusGroup","focusable","active","tabStopId","children"]),c=Os(),d=i||c,f=Lle(P8,r),u=f.currentTabStopId===d,h=E8(r),{onFocusableItemAdd:m,onFocusableItemRemove:v,currentTabStopId:g}=f;return y.useEffect(()=>{if(n)return m(),()=>v()},[n,m,v]),s.jsx(k2.ItemSlot,{scope:r,id:d,focusable:n,active:a,children:s.jsx(Pt.span,V(D({tabIndex:u?0:-1,"data-orientation":f.orientation},l),{ref:t,onMouseDown:mt(e.onMouseDown,_=>{n?f.onItemFocus(d):_.preventDefault()}),onFocus:mt(e.onFocus,()=>f.onItemFocus(d)),onKeyDown:mt(e.onKeyDown,_=>{if(_.key==="Tab"&&_.shiftKey){f.onItemShiftTab();return}if(_.target!==_.currentTarget)return;const w=Ule(_,f.orientation,f.dir);if(w!==void 0){if(_.metaKey||_.ctrlKey||_.altKey||_.shiftKey)return;_.preventDefault();let N=h().filter(S=>S.focusable).map(S=>S.ref.current);if(w==="last")N.reverse();else if(w==="prev"||w==="next"){w==="prev"&&N.reverse();const S=N.indexOf(_.currentTarget);N=f.loop?qle(N,S+1):N.slice(S+1)}setTimeout(()=>A8(N))}}),children:typeof o=="function"?o({isCurrentTabStop:u,hasTabStop:g!=null}):o}))})});T8.displayName=P8;var zle={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Ble(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Ule(e,t,r){const n=Ble(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return zle[n]}function A8(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function qle(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var R8=C8,O8=T8,x1="Tabs",[Vle,rUe]=$s(x1,[y1]),M8=y1(),[Wle,pT]=Vle(x1),D8=y.forwardRef((e,t)=>{const m=e,{__scopeTabs:r,value:n,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic"}=m,d=ge(m,["__scopeTabs","value","onValueChange","defaultValue","orientation","dir","activationMode"]),f=Af(l),[u,h]=Ya({prop:n,onChange:a,defaultProp:i!=null?i:"",caller:x1});return s.jsx(Wle,{scope:r,baseId:Os(),value:u,onValueChange:h,orientation:o,dir:f,activationMode:c,children:s.jsx(Pt.div,V(D({dir:f,"data-orientation":o},d),{ref:t}))})});D8.displayName=x1;var I8="TabsList",$8=y.forwardRef((e,t)=>{const l=e,{__scopeTabs:r,loop:n=!0}=l,a=ge(l,["__scopeTabs","loop"]),i=pT(I8,r),o=M8(r);return s.jsx(R8,V(D({asChild:!0},o),{orientation:i.orientation,dir:i.dir,loop:n,children:s.jsx(Pt.div,V(D({role:"tablist","aria-orientation":i.orientation},a),{ref:t}))}))});$8.displayName=I8;var L8="TabsTrigger",F8=y.forwardRef((e,t)=>{const u=e,{__scopeTabs:r,value:n,disabled:a=!1}=u,i=ge(u,["__scopeTabs","value","disabled"]),o=pT(L8,r),l=M8(r),c=U8(o.baseId,n),d=q8(o.baseId,n),f=n===o.value;return s.jsx(O8,V(D({asChild:!0},l),{focusable:!a,active:f,children:s.jsx(Pt.button,V(D({type:"button",role:"tab","aria-selected":f,"aria-controls":d,"data-state":f?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c},i),{ref:t,onMouseDown:mt(e.onMouseDown,h=>{!a&&h.button===0&&h.ctrlKey===!1?o.onValueChange(n):h.preventDefault()}),onKeyDown:mt(e.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(n)}),onFocus:mt(e.onFocus,()=>{const h=o.activationMode!=="manual";!f&&!a&&h&&o.onValueChange(n)})}))}))});F8.displayName=L8;var z8="TabsContent",B8=y.forwardRef((e,t)=>{const h=e,{__scopeTabs:r,value:n,forceMount:a,children:i}=h,o=ge(h,["__scopeTabs","value","forceMount","children"]),l=pT(z8,r),c=U8(l.baseId,n),d=q8(l.baseId,n),f=n===l.value,u=y.useRef(f);return y.useEffect(()=>{const m=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(m)},[]),s.jsx(Ks,{present:a||f,children:({present:m})=>s.jsx(Pt.div,V(D({"data-state":f?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!m,id:d,tabIndex:0},o),{ref:t,style:V(D({},e.style),{animationDuration:u.current?"0s":void 0}),children:m&&i}))})});B8.displayName=z8;function U8(e,t){return`${e}-trigger-${t}`}function q8(e,t){return`${e}-content-${t}`}var Hle=D8,V8=$8,W8=F8,H8=B8;const zi=Hle,wi=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(V8,D({ref:r,className:Oe("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e)},t))});wi.displayName=V8.displayName;const en=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(W8,D({ref:r,className:Oe("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e)},t))});en.displayName=W8.displayName;const tn=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(H8,D({ref:r,className:Oe("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e)},t))});tn.displayName=H8.displayName;const ow=({size:e="md",className:t})=>{const r={sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16",xl:"w-24 h-24"};return s.jsx("div",{className:Oe("inline-block",r[e],t),children:s.jsx("img",{src:"/Logos/Main logo black background.png",alt:"Synth Logo",className:"w-full h-full object-contain"})})};function ZN(){return s.jsxs("div",{className:"synth-card relative w-full max-w-sm mx-auto overflow-hidden shadow-lg border border-white/20",role:"status","aria-label":"Loading content","aria-busy":"true",children:[s.jsxs("div",{className:"relative h-72 bg-gradient-to-br from-pink-50 via-white to-pink-100 animate-pulse",children:[s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx(ow,{size:"lg",className:"opacity-40 animate-breathe animate-float"})}),s.jsx("div",{className:"absolute top-4 left-4",children:s.jsx("div",{className:"w-20 h-6 bg-pink-200 animate-pulse rounded-full"})}),s.jsx("div",{className:"absolute top-4 right-4",children:s.jsx("div",{className:"w-16 h-6 bg-gradient-to-r from-pink-300 to-pink-400 animate-pulse rounded-full"})})]}),s.jsxs("div",{className:"p-6 space-y-5 bg-white",children:[s.jsxs("div",{children:[s.jsx("div",{className:"h-7 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-4/5 mb-3"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-50 to-white rounded animate-pulse w-3/4"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-50 to-white rounded animate-pulse w-1/2 mt-1"})]}),s.jsxs("div",{className:"space-y-3 bg-gradient-to-r from-pink-50/50 to-white rounded-xl p-4 border border-pink-100/50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 bg-pink-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-32"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 bg-pink-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-24"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 bg-pink-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-20"})]})]}),s.jsxs("div",{className:"flex gap-4 pt-2",children:[s.jsx("div",{className:"flex-1 h-14 bg-gradient-to-r from-gray-100 to-white rounded-lg animate-pulse border border-pink-100"}),s.jsx("div",{className:"flex-1 h-14 bg-gradient-to-r from-pink-200 to-pink-300 rounded-lg animate-pulse"})]})]}),s.jsx("span",{className:"sr-only",children:"Loading event details..."})]})}function G8({promotionTier:e,className:t=""}){const n=(i=>({icon:uf,text:"Promoted",className:"bg-gradient-to-r from-yellow-100 to-amber-100 text-yellow-800 border-yellow-300 hover:from-yellow-200 hover:to-amber-200 shadow-lg shadow-yellow-200/50",iconClassName:"text-yellow-600"}))(),a=n.icon;return s.jsxs(et,{variant:"secondary",className:`flex items-center gap-1 text-xs font-medium ${n.className} ${t}`,children:[s.jsx(a,{className:`w-3 h-3 ${n.iconClassName}`}),n.text]})}const Gle=({icon:e,title:t,description:r,action:n})=>s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6 text-center",children:[e&&s.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"var(--spacing-inline, 6px)"},children:s.jsx("div",{style:{color:"var(--neutral-600)"},children:e})}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,marginBottom:"var(--spacing-inline, 6px)",textAlign:"center"},children:t}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,maxWidth:"100%",textAlign:"center"},children:r}),n&&s.jsx("button",{onClick:n.onClick,className:"px-6 py-3 rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2",style:{marginTop:"var(--spacing-grouped, 24px)",backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},onMouseEnter:a=>{a.currentTarget.style.backgroundColor="var(--brand-pink-600)"},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="var(--brand-pink-500)"},onFocus:a=>{a.currentTarget.style.outline="2px solid var(--brand-pink-500)"},"aria-label":n.label,children:n.label})]});class zM{static getAvailableCities(t=1,r=1e3){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("city_centers").select("*").limit(r);return a?(console.warn(" city_centers table not available or has different structure, using events table:",a.message),yield this.getCitiesFromEvents(t,r)):!n||n.length===0?yield this.getCitiesFromEvents(t,r):n.map(i=>{const o=i.city_name||i.name||i.normalized_name||"";return{name:o,city_name:o,normalized_name:o,state:i.state||null,center_latitude:i.center_latitude?Number(i.center_latitude):i.latitude?Number(i.latitude):void 0,center_longitude:i.center_longitude?Number(i.center_longitude):i.longitude?Number(i.longitude):void 0,event_count:i.event_count||i.upcoming_events_count||0,aliases:[]}})}catch(n){return console.error("Error in getAvailableCities:",n),[]}})}static getCitiesFromEvents(t=1,r=1e3){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("events").select("venue_city, venue_state").not("venue_city","is",null).gte("event_date",new Date().toISOString());if(a)return console.error("Error fetching cities from events:",a),[];const i=new Map;return(n||[]).forEach(l=>{const c=l.venue_city?`${l.venue_city}${l.venue_state?`, ${l.venue_state}`:""}`:null;c&&i.set(c,(i.get(c)||0)+1)}),Array.from(i.entries()).filter(([l,c])=>c>=t).sort(([l,c],[d,f])=>f-c).slice(0,r).map(([l,c])=>l)}catch(n){return console.error("Error in getCitiesFromEvents:",n),[]}})}}function xr(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function xi(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function ea(e,t){const r=xr(e);return isNaN(t)?xi(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Jo(e,t){const r=xr(e);if(isNaN(t))return xi(e,NaN);if(!t)return r;const n=r.getDate(),a=xi(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const i=a.getDate();return n>=i?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const gT=6048e5,Yle=864e5,vT=6e4,Y8=36e5,Ex=43200,BM=1440;let Kle={};function Np(){return Kle}function ho(e,t){var l,c,d,f,u,h,m,v;const r=Np(),n=(v=(m=(f=(d=t==null?void 0:t.weekStartsOn)!=null?d:(c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)!=null?f:r.weekStartsOn)!=null?m:(h=(u=r.locale)==null?void 0:u.options)==null?void 0:h.weekStartsOn)!=null?v:0,a=xr(e),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function pf(e){return ho(e,{weekStartsOn:1})}function K8(e){const t=xr(e),r=t.getFullYear(),n=xi(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=pf(n),i=xi(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=pf(i);return t.getTime()>=a.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function km(e){const t=xr(e);return t.setHours(0,0,0,0),t}function Em(e){const t=xr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Nl(e,t){const r=km(e),n=km(t),a=+r-Em(r),i=+n-Em(n);return Math.round((a-i)/Yle)}function Zle(e){const t=K8(e),r=xi(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),pf(r)}function E2(e,t){const r=t*7;return ea(e,r)}function Xle(e,t){return Jo(e,t*12)}function Jle(e){let t;return e.forEach(function(r){const n=xr(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function Qle(e){let t;return e.forEach(r=>{const n=xr(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function p_(e,t){const r=xr(e),n=xr(t),a=r.getTime()-n.getTime();return a<0?-1:a>0?1:a}function _1(e){return xi(e,Date.now())}function Ra(e,t){const r=km(e),n=km(t);return+r==+n}function yT(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function ece(e){if(!yT(e)&&typeof e!="number")return!1;const t=xr(e);return!isNaN(Number(t))}function Cm(e,t){const r=xr(e),n=xr(t),a=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return a*12+i}function tce(e,t,r){const n=ho(e,r),a=ho(t,r),i=+n-Em(n),o=+a-Em(a);return Math.round((i-o)/gT)}function Z8(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function X8(e,t){return+xr(e)-+xr(t)}function C2(e,t,r){const n=X8(e,t)/vT;return Z8(r==null?void 0:r.roundingMethod)(n)}function rce(e){const t=xr(e);return t.setHours(23,59,59,999),t}function w1(e){const t=xr(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function nce(e){const t=xr(e);return+rce(t)==+w1(t)}function sce(e,t){const r=xr(e),n=xr(t),a=p_(r,n),i=Math.abs(Cm(r,n));let o;if(i<1)o=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*i);let l=p_(r,n)===-a;nce(xr(e))&&i===1&&p_(e,n)===1&&(l=!1),o=a*(i-Number(l))}return o===0?0:o}function ace(e,t,r){const n=X8(e,t)/1e3;return Z8(r==null?void 0:r.roundingMethod)(n)}function yi(e){const t=xr(e);return t.setDate(1),t.setHours(0,0,0,0),t}function J8(e){const t=xr(e),r=xi(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function xT(e,t){var l,c,d,f,u,h,m,v;const r=Np(),n=(v=(m=(f=(d=t==null?void 0:t.weekStartsOn)!=null?d:(c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)!=null?f:r.weekStartsOn)!=null?m:(h=(u=r.locale)==null?void 0:u.options)==null?void 0:h.weekStartsOn)!=null?v:0,a=xr(e),i=a.getDay(),o=(i<n?-7:0)+6-(i-n);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}function Q8(e){return xT(e,{weekStartsOn:1})}const ice={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},oce=(e,t,r)=>{let n;const a=ice[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function XN(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const lce={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},cce={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dce={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},uce={date:XN({formats:lce,defaultWidth:"full"}),time:XN({formats:cce,defaultWidth:"full"}),dateTime:XN({formats:dce,defaultWidth:"full"})},fce={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},hce=(e,t,r,n)=>fce[e];function ug(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const mce={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},pce={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},gce={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},vce={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},yce={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},xce={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},_ce=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},wce={ordinalNumber:_ce,era:ug({values:mce,defaultWidth:"wide"}),quarter:ug({values:pce,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ug({values:gce,defaultWidth:"wide"}),day:ug({values:vce,defaultWidth:"wide"}),dayPeriod:ug({values:yce,defaultWidth:"wide",formattingValues:xce,defaultFormattingWidth:"wide"})};function fg(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const o=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?jce(l,u=>u.test(o)):bce(l,u=>u.test(o));let d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const f=t.slice(o.length);return{value:d,rest:f}}}function bce(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function jce(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Nce(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(a.length);return{value:o,rest:l}}}const Sce=/^(\d+)(th|st|nd|rd)?/i,kce=/\d+/i,Ece={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Cce={any:[/^b/i,/^(a|c)/i]},Pce={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Tce={any:[/1/i,/2/i,/3/i,/4/i]},Ace={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Rce={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Oce={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Mce={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Dce={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Ice={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},$ce={ordinalNumber:Nce({matchPattern:Sce,parsePattern:kce,valueCallback:e=>parseInt(e,10)}),era:fg({matchPatterns:Ece,defaultMatchWidth:"wide",parsePatterns:Cce,defaultParseWidth:"any"}),quarter:fg({matchPatterns:Pce,defaultMatchWidth:"wide",parsePatterns:Tce,defaultParseWidth:"any",valueCallback:e=>e+1}),month:fg({matchPatterns:Ace,defaultMatchWidth:"wide",parsePatterns:Rce,defaultParseWidth:"any"}),day:fg({matchPatterns:Oce,defaultMatchWidth:"wide",parsePatterns:Mce,defaultParseWidth:"any"}),dayPeriod:fg({matchPatterns:Dce,defaultMatchWidth:"any",parsePatterns:Ice,defaultParseWidth:"any"})},_T={code:"en-US",formatDistance:oce,formatLong:uce,formatRelative:hce,localize:wce,match:$ce,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Lce(e){const t=xr(e);return Nl(t,J8(t))+1}function eB(e){const t=xr(e),r=+pf(t)-+Zle(t);return Math.round(r/gT)+1}function tB(e,t){var f,u,h,m,v,g,x,_;const r=xr(e),n=r.getFullYear(),a=Np(),i=(_=(x=(m=(h=t==null?void 0:t.firstWeekContainsDate)!=null?h:(u=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:u.firstWeekContainsDate)!=null?m:a.firstWeekContainsDate)!=null?x:(g=(v=a.locale)==null?void 0:v.options)==null?void 0:g.firstWeekContainsDate)!=null?_:1,o=xi(e,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=ho(o,t),c=xi(e,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const d=ho(c,t);return r.getTime()>=l.getTime()?n+1:r.getTime()>=d.getTime()?n:n-1}function Fce(e,t){var l,c,d,f,u,h,m,v;const r=Np(),n=(v=(m=(f=(d=t==null?void 0:t.firstWeekContainsDate)!=null?d:(c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)!=null?f:r.firstWeekContainsDate)!=null?m:(h=(u=r.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)!=null?v:1,a=tB(e,t),i=xi(e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),ho(i,t)}function rB(e,t){const r=xr(e),n=+ho(r,t)-+Fce(r,t);return Math.round(n/gT)+1}function On(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const sd={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return On(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):On(r+1,2)},d(e,t){return On(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return On(e.getHours()%12||12,t.length)},H(e,t){return On(e.getHours(),t.length)},m(e,t){return On(e.getMinutes(),t.length)},s(e,t){return On(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return On(a,t.length)}},sh={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},UM={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return sd.y(e,t)},Y:function(e,t,r,n){const a=tB(e,n),i=a>0?a:1-a;if(t==="YY"){const o=i%100;return On(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):On(i,t.length)},R:function(e,t){const r=K8(e);return On(r,t.length)},u:function(e,t){const r=e.getFullYear();return On(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return On(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return On(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return sd.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return On(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=rB(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):On(a,t.length)},I:function(e,t,r){const n=eB(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):On(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):sd.d(e,t)},D:function(e,t,r){const n=Lce(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):On(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return On(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return On(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return On(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=sh.noon:n===0?a=sh.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=sh.evening:n>=12?a=sh.afternoon:n>=4?a=sh.morning:a=sh.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return sd.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):sd.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):On(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):On(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):sd.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):sd.s(e,t)},S:function(e,t){return sd.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return VM(n);case"XXXX":case"XX":return _u(n);case"XXXXX":case"XXX":default:return _u(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return VM(n);case"xxxx":case"xx":return _u(n);case"xxxxx":case"xxx":default:return _u(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+qM(n,":");case"OOOO":default:return"GMT"+_u(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+qM(n,":");case"zzzz":default:return"GMT"+_u(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return On(n,t.length)},T:function(e,t,r){const n=e.getTime();return On(n,t.length)}};function qM(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+On(i,2)}function VM(e,t){return e%60===0?(e>0?"-":"+")+On(Math.abs(e)/60,2):_u(e,t)}function _u(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=On(Math.trunc(n/60),2),i=On(n%60,2);return r+a+t+i}const WM=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},nB=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},zce=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return WM(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",WM(n,t)).replace("{{time}}",nB(a,t))},Bce={p:nB,P:zce},Uce=/^D+$/,qce=/^Y+$/,Vce=["D","DD","YY","YYYY"];function Wce(e){return Uce.test(e)}function Hce(e){return qce.test(e)}function Gce(e,t,r){const n=Yce(e,t,r);if(console.warn(n),Vce.includes(e))throw new RangeError(n)}function Yce(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Kce=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Zce=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Xce=/^'([^]*?)'?$/,Jce=/''/g,Qce=/[a-zA-Z]/;function Rt(e,t,r){var f,u,h,m,v,g,x,_,w,b,N,S,k,C,A,R,I,O;const n=Np(),a=(u=(f=r==null?void 0:r.locale)!=null?f:n.locale)!=null?u:_T,i=(b=(w=(g=(v=r==null?void 0:r.firstWeekContainsDate)!=null?v:(m=(h=r==null?void 0:r.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)!=null?g:n.firstWeekContainsDate)!=null?w:(_=(x=n.locale)==null?void 0:x.options)==null?void 0:_.firstWeekContainsDate)!=null?b:1,o=(O=(I=(C=(k=r==null?void 0:r.weekStartsOn)!=null?k:(S=(N=r==null?void 0:r.locale)==null?void 0:N.options)==null?void 0:S.weekStartsOn)!=null?C:n.weekStartsOn)!=null?I:(R=(A=n.locale)==null?void 0:A.options)==null?void 0:R.weekStartsOn)!=null?O:0,l=xr(e);if(!ece(l))throw new RangeError("Invalid time value");let c=t.match(Zce).map(z=>{const M=z[0];if(M==="p"||M==="P"){const B=Bce[M];return B(z,a.formatLong)}return z}).join("").match(Kce).map(z=>{if(z==="''")return{isToken:!1,value:"'"};const M=z[0];if(M==="'")return{isToken:!1,value:ede(z)};if(UM[M])return{isToken:!0,value:z};if(M.match(Qce))throw new RangeError("Format string contains an unescaped latin alphabet character `"+M+"`");return{isToken:!1,value:z}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return c.map(z=>{if(!z.isToken)return z.value;const M=z.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&Hce(M)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Wce(M))&&Gce(M,t,String(e));const B=UM[M[0]];return B(l,M,a.localize,d)}).join("")}function ede(e){const t=e.match(Xce);return t?t[1].replace(Jce,"'"):e}function tde(e,t,r){var v,g;const n=Np(),a=(g=(v=r==null?void 0:r.locale)!=null?v:n.locale)!=null?g:_T,i=2520,o=p_(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o});let c,d;o>0?(c=xr(t),d=xr(e)):(c=xr(e),d=xr(t));const f=ace(d,c),u=(Em(d)-Em(c))/1e3,h=Math.round((f-u)/60);let m;if(h<2)return r!=null&&r.includeSeconds?f<5?a.formatDistance("lessThanXSeconds",5,l):f<10?a.formatDistance("lessThanXSeconds",10,l):f<20?a.formatDistance("lessThanXSeconds",20,l):f<40?a.formatDistance("halfAMinute",0,l):f<60?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",1,l):h===0?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",h,l);if(h<45)return a.formatDistance("xMinutes",h,l);if(h<90)return a.formatDistance("aboutXHours",1,l);if(h<BM){const x=Math.round(h/60);return a.formatDistance("aboutXHours",x,l)}else{if(h<i)return a.formatDistance("xDays",1,l);if(h<Ex){const x=Math.round(h/BM);return a.formatDistance("xDays",x,l)}else if(h<Ex*2)return m=Math.round(h/Ex),a.formatDistance("aboutXMonths",m,l)}if(m=sce(d,c),m<12){const x=Math.round(h/Ex);return a.formatDistance("xMonths",x,l)}else{const x=m%12,_=Math.trunc(m/12);return x<3?a.formatDistance("aboutXYears",_,l):x<9?a.formatDistance("overXYears",_,l):a.formatDistance("almostXYears",_+1,l)}}function Uv(e,t){return tde(e,_1(e),t)}function rde(e){const t=xr(e),r=t.getFullYear(),n=t.getMonth(),a=xi(e,0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function nde(e){return Math.trunc(+xr(e)/1e3)}function sde(e){const t=xr(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function ade(e,t){return tce(sde(e),yi(e),t)+1}function P2(e,t){const r=xr(e),n=xr(t);return r.getTime()>n.getTime()}function sB(e,t){const r=xr(e),n=xr(t);return+r<+n}function ide(e,t,r){const n=ho(e,r),a=ho(t,r);return+n==+a}function wT(e,t){const r=xr(e),n=xr(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function ode(e,t){const r=xr(e),n=xr(t);return r.getFullYear()===n.getFullYear()}function lde(e,t){return ide(e,_1(e),t)}function cde(e){return Ra(e,_1(e))}function dde(e,t){const r=+xr(e),[n,a]=[+xr(t.start),+xr(t.end)].sort((i,o)=>i-o);return r>=n&&r<=a}function iv(e,t){return ea(e,-t)}function ude(e){return Ra(e,iv(_1(e),1))}function gs(e,t){const n=pde(e);let a;if(n.date){const c=gde(n.date,2);a=vde(c.restDateString,c.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const i=a.getTime();let o=0,l;if(n.time&&(o=yde(n.time),isNaN(o)))return new Date(NaN);if(n.timezone){if(l=xde(n.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(i+o),d=new Date(0);return d.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),d.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),d}return new Date(i+o+l)}const Cx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},fde=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,hde=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,mde=/^([+-])(\d{2})(?::?(\d{2}))?$/;function pde(e){const t={},r=e.split(Cx.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],Cx.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Cx.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const a=Cx.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function gde(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?a:i*100,restDateString:e.slice((n[1]||n[2]).length)}}function vde(e,t){if(t===null)return new Date(NaN);const r=e.match(fde);if(!r)return new Date(NaN);const n=!!r[4],a=hg(r[1]),i=hg(r[2])-1,o=hg(r[3]),l=hg(r[4]),c=hg(r[5])-1;if(n)return Nde(t,l,c)?_de(t,l,c):new Date(NaN);{const d=new Date(0);return!bde(t,i,o)||!jde(t,a)?new Date(NaN):(d.setUTCFullYear(t,i,Math.max(a,o)),d)}}function hg(e){return e?parseInt(e):1}function yde(e){const t=e.match(hde);if(!t)return NaN;const r=JN(t[1]),n=JN(t[2]),a=JN(t[3]);return Sde(r,n,a)?r*Y8+n*vT+a*1e3:NaN}function JN(e){return e&&parseFloat(e.replace(",","."))||0}function xde(e){if(e==="Z")return 0;const t=e.match(mde);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return kde(n,a)?r*(n*Y8+a*vT):NaN}function _de(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,i=(t-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+i),n}const wde=[31,null,31,30,31,30,31,31,30,31,30,31];function aB(e){return e%400===0||e%4===0&&e%100!==0}function bde(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(wde[t]||(aB(e)?29:28))}function jde(e,t){return t>=1&&t<=(aB(e)?366:365)}function Nde(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function Sde(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function kde(e,t){return t>=0&&t<=59}function QN(e,t){const r=xr(e),n=r.getFullYear(),a=r.getDate(),i=xi(e,0);i.setFullYear(n,t,15),i.setHours(0,0,0,0);const o=rde(i);return r.setMonth(t,Math.min(a,o)),r}function HM(e,t){const r=xr(e);return isNaN(+r)?xi(e,NaN):(r.setFullYear(t),r)}function bT(e){return E(this,null,function*(){var t;try{const{data:r,error:n}=yield T.from("chat_participants").select("chat_id").eq("user_id",e);if(n)return n.code==="42P17"||(t=n.message)!=null&&t.includes("infinite recursion")?(console.warn("RLS recursion detected in chat_participants, returning empty chats"),{data:[],error:null}):(console.error("Error fetching chat participants:",n),{data:null,error:n});if(!r||r.length===0)return{data:[],error:null};const a=r.map(u=>u.chat_id),{data:i,error:o}=yield T.from("chats").select(`
        id,
        chat_name,
        is_group_chat,
        latest_message_id,
        group_admin_id,
        created_at,
        updated_at,
        messages!latest_message_id (
          id,
          content,
          created_at,
          sender_id,
          users!messages_sender_id_fkey (
            user_id,
            name
          )
        )
      `).in("id",a).order("updated_at",{ascending:!1});if(o)return console.error("Error fetching chats:",o),{data:null,error:o};const{data:l,error:c}=yield T.from("chat_participants").select("chat_id, user_id").in("chat_id",a);if(c)return console.error("Error fetching all participants:",c),{data:null,error:c};const d=new Map;return l==null||l.forEach(u=>{const h=d.get(u.chat_id)||[];h.push(u.user_id),d.set(u.chat_id,h)}),{data:(i||[]).map(u=>{var h,m,v,g;return{id:u.id,chat_name:u.chat_name,is_group_chat:u.is_group_chat,users:d.get(u.id)||[],latest_message_id:u.latest_message_id,latest_message:((h=u.messages)==null?void 0:h.content)||"",latest_message_created_at:((m=u.messages)==null?void 0:m.created_at)||null,latest_message_sender_name:((g=(v=u.messages)==null?void 0:v.users)==null?void 0:g.name)||null,group_admin_id:u.group_admin_id,created_at:u.created_at,updated_at:u.updated_at}}),error:null}}catch(r){return console.error("Error in fetchUserChats:",r),{data:null,error:r}}})}class gh{static getNotifications(){return E(this,arguments,function*(t={}){try{const{data:{user:r}}=yield T.auth.getUser();if(!r)throw new Error("User not authenticated");const n=!t.offset&&!t.type&&t.is_read===void 0,a=n?`notifications_${r.id}_${t.limit||50}`:null;if(n&&a){const i=Fo.get(a);if(i)return i}try{let i=T.from("notifications_with_details").select("*",{count:"exact"}).eq("user_id",r.id).order("created_at",{ascending:!1});t.type&&(i=i.eq("type",t.type)),t.is_read!==void 0&&(i=i.eq("is_read",t.is_read));const o=t.limit||20,l=t.offset||0,c=Math.ceil(o*1.5);i=i.range(l,l+c-1);const{data:d,error:f,count:u}=yield i;if(f){const h=f.code||(f==null?void 0:f.statusCode)||(f==null?void 0:f.status),m=(f.message||String(f)||"").toLowerCase(),v=((f==null?void 0:f.details)||"").toLowerCase(),g=((f==null?void 0:f.hint)||"").toLowerCase();if(h==="PGRST205"||h==="42P01"||h===404||h==="404"||String(h)==="404"||(m==null?void 0:m.includes("notifications_with_details"))||(m==null?void 0:m.includes("does not exist"))||(m==null?void 0:m.includes("relation"))||(m==null?void 0:m.includes("not found"))||(m==null?void 0:m.includes("404"))||(v==null?void 0:v.includes("notifications_with_details"))||(g==null?void 0:g.includes("notifications_with_details"))||(f==null?void 0:f.status)===404||(f==null?void 0:f.statusCode)===404)return yield this.getNotificationsWithManualJoin(t);throw f}if(d!=null){const h=(d||[]).filter(w=>{var b;return w.type==="friend_request"&&((b=w.data)==null?void 0:b.request_id)});let m=new Set;if(h.length>0)try{const w=h.map(b=>b.data.request_id).filter(Boolean);if(w.length>0){const{data:b}=yield T.from("user_relationships").select("id").in("id",w).eq("relationship_type","friend").neq("status","pending");b&&(m=new Set(b.map(N=>N.id)))}}catch(w){}const _={notifications:(d||[]).map(w=>{var b;if(w.type==="friend_request"&&((b=w.data)!=null&&b.request_id)){const N=w.data.request_id;if(m.has(N))return null}return w}).filter(w=>w!==null).slice(0,o),total:u||0};return n&&a&&Fo.set(a,_,Bv.NOTIFICATIONS),_}else return yield this.getNotificationsWithManualJoin(t)}catch(i){const o=(i==null?void 0:i.message)||String(i)||"",l=(i==null?void 0:i.code)||(i==null?void 0:i.statusCode)||(i==null?void 0:i.status);if(l==="PGRST205"||l==="42P01"||l===404||o!=null&&o.includes("notifications_with_details")||o!=null&&o.includes("does not exist")||o!=null&&o.includes("Not Found")||o!=null&&o.includes("404"))return yield this.getNotificationsWithManualJoin(t);throw i}}catch(r){throw console.error("Error fetching notifications:",r),new Error(`Failed to get notifications: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getNotificationsWithManualJoin(){return E(this,arguments,function*(t={}){const{data:{user:r}}=yield T.auth.getUser();if(!r)throw new Error("User not authenticated");let n=T.from("notifications").select("*",{count:"exact"}).eq("user_id",r.id).order("created_at",{ascending:!1});t.type&&(n=n.eq("type",t.type)),t.is_read!==void 0&&(n=n.eq("is_read",t.is_read));const a=t.limit||20,i=t.offset||0,o=Math.ceil(a*1.5);n=n.range(i,i+o-1);const{data:l,error:c,count:d}=yield n;if(c)throw c;if(!l||l.length===0)return{notifications:[],total:d||0};const f=l.filter(x=>{var _;return x.type==="friend_request"&&((_=x.data)==null?void 0:_.request_id)});let u=new Set;if(f.length>0)try{const x=f.map(_=>_.data.request_id).filter(Boolean);if(x.length>0){const{data:_}=yield T.from("user_relationships").select("id").in("id",x).eq("relationship_type","friend").neq("status","pending");_&&(u=new Set(_.map(w=>w.id)))}}catch(x){}const v=l.map(x=>{var _;if(x.type==="friend_request"&&((_=x.data)!=null&&_.request_id)){const w=x.data.request_id;if(u.has(w))return null}return x}).filter(x=>x!==null).slice(0,a);return v.length===0?{notifications:[],total:d||0}:{notifications:yield Promise.all(v.map(x=>E(this,null,function*(){const _=D({},x);if(x.actor_user_id)try{let w=null;const{data:b,error:N}=yield T.from("users").select("name, avatar_url").eq("user_id",x.actor_user_id).single();if(!N&&b)w=b;else{const{data:S,error:k}=yield T.from("profiles").select("name, avatar_url").eq("user_id",x.actor_user_id).single();!k&&S&&(w=S)}w&&(_.actor_name=w.name,_.actor_avatar=w.avatar_url)}catch(w){console.log("Could not fetch actor profile:",w)}if(x.review_id){const{data:w}=yield T.from("user_reviews").select("review_text, rating, event_id").eq("id",x.review_id).single();if(w&&(_.review_text=w.review_text,_.rating=w.rating,w.event_id)){const{data:b}=yield T.from("jambase_events").select("title, artist_name, venue_name").eq("id",w.event_id).single();b&&(_.event_title=b.title,_.artist_name=b.artist_name,_.venue_name=b.venue_name)}}return _}))),total:d||0}})}static enrichNotification(t){return E(this,null,function*(){const r=D({},t);if(t.actor_user_id)try{let n=null;const{data:a,error:i}=yield T.from("users").select("name, avatar_url").eq("user_id",t.actor_user_id).single();if(!i&&a)n=a;else{const{data:o,error:l}=yield T.from("profiles").select("name, avatar_url").eq("user_id",t.actor_user_id).single();!l&&o&&(n=o)}n&&(r.actor_name=n.name,r.actor_avatar=n.avatar_url)}catch(n){console.log("Could not fetch actor profile:",n)}if(t.review_id){const{data:n}=yield T.from("user_reviews").select("review_text, rating, event_id").eq("id",t.review_id).single();if(n&&(r.review_text=n.review_text,r.rating=n.rating,n.event_id)){const{data:a}=yield T.from("jambase_events").select("title, artist_name, venue_name").eq("id",n.event_id).single();a&&(r.event_title=a.title,r.artist_name=a.artist_name,r.venue_name=a.venue_name)}}return r})}static getUnreadNotifications(){return E(this,null,function*(){return(yield this.getNotifications({is_read:!1,limit:50})).notifications})}static getNotificationStats(){return E(this,null,function*(){var t;try{const{data:r,error:n}=yield T.from("notifications").select("type, is_read").eq("user_id",(t=(yield T.auth.getUser()).data.user)==null?void 0:t.id);if(n)throw n;const a={total:(r==null?void 0:r.length)||0,unread:(r==null?void 0:r.filter(i=>!i.is_read).length)||0,by_type:{friend_request:0,friend_accepted:0,match:0,message:0,review_liked:0,review_commented:0,comment_replied:0,event_interest:0,event_attendance_reminder:0,artist_followed:0,artist_new_event:0,artist_profile_updated:0,venue_new_event:0,venue_profile_updated:0,event_share:0,friend_rsvp_going:0,friend_rsvp_changed:0,friend_review_posted:0,friend_attended_same_event:0,event_reminder:0,group_chat_invite:0,trending_in_network:0,mutual_attendance:0,flag_reviewed:0,user_warned:0,user_restricted:0,user_suspended:0}};return r==null||r.forEach(i=>{a.by_type[i.type]++}),a}catch(r){throw console.error("Error fetching notification stats:",r),new Error(`Failed to get notification stats: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getUnreadCount(){return E(this,null,function*(){try{const{data:{user:t}}=yield T.auth.getUser();if(!t)return console.log("No user found, returning 0 unread count"),0;const r=`unread_count_${t.id}`,n=Fo.get(r);if(n!==null)return n;const{data:a,error:i}=yield T.from("notifications").select("id, type, data, is_read").eq("user_id",t.id).eq("is_read",!1);if(i)return console.error("Error fetching notifications for unread count:",i),0;if(!a||a.length===0)return 0;const o=a.filter(f=>{var u;return f.type==="friend_request"&&((u=f.data)==null?void 0:u.request_id)});let l=new Set;if(o.length>0)try{const f=o.map(u=>u.data.request_id).filter(Boolean);if(f.length>0){const{data:u}=yield T.from("user_relationships").select("id").in("id",f).eq("relationship_type","friend").neq("status","pending");u&&(l=new Set(u.map(h=>h.id)))}}catch(f){}const d=a.filter(f=>{var u;if(f.type==="friend_request"&&((u=f.data)!=null&&u.request_id)){const h=f.data.request_id;return!l.has(h)}return!0}).length;return Fo.set(r,d,Bv.NOTIFICATIONS),d}catch(t){return console.error("Error fetching unread count:",t),0}})}static markAsRead(t){return E(this,null,function*(){var r,n;try{const{error:a}=yield T.rpc("mark_notification_read",{notification_id:t});if(a){if(a.code==="PGRST202"||(r=a.message)!=null&&r.includes("Could not find the function")){console.log("Notification function not found, falling back to direct update");const{error:i}=yield T.from("notifications").update({is_read:!0}).eq("id",t).eq("user_id",(n=(yield T.auth.getUser()).data.user)==null?void 0:n.id);if(i)throw i;return}throw a}}catch(a){throw console.error("Error marking notification as read:",a),new Error(`Failed to mark notification as read: ${a instanceof Error?a.message:"Unknown error"}`)}})}static markAllAsRead(){return E(this,null,function*(){var t,r;try{const{error:n}=yield T.rpc("mark_all_notifications_read");if(n){if(n.code==="PGRST202"||(t=n.message)!=null&&t.includes("Could not find the function")){console.log("Notification function not found, falling back to direct update");const{error:a}=yield T.from("notifications").update({is_read:!0}).eq("user_id",(r=(yield T.auth.getUser()).data.user)==null?void 0:r.id).eq("is_read",!1);if(a)throw a;return}throw n}}catch(n){throw console.error("Error marking all notifications as read:",n),new Error(`Failed to mark all notifications as read: ${n instanceof Error?n.message:"Unknown error"}`)}})}static subscribeToNotifications(t,r,n){return E(this,null,function*(){const{data:{user:a}}=yield T.auth.getUser();if(!a)return console.error("Cannot subscribe to notifications: User not authenticated"),null;const i=a.id;return T.channel("notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${i}`},l=>E(this,null,function*(){try{let c=null;const{data:d,error:f}=yield T.from("notifications_with_details").select("*").eq("id",l.new.id).single();if(f){const u=f.code||(f==null?void 0:f.statusCode)||(f==null?void 0:f.status),h=(f.message||String(f)||"").toLowerCase();u==="PGRST205"||u==="42P01"||u===404||u==="404"||String(u)==="404"||(f==null?void 0:f.status)===404||(f==null?void 0:f.statusCode)===404||(h==null?void 0:h.includes("notifications_with_details"))||(h==null?void 0:h.includes("does not exist"))||(h==null?void 0:h.includes("not found"))||(h==null?void 0:h.includes("404"))||console.warn("Unexpected error fetching from notifications_with_details view:",f)}else d&&(c=d);if(!c){const{data:u}=yield T.from("notifications").select("*").eq("id",l.new.id).single();u&&(c=yield this.enrichNotification(u))}c&&t(c)}catch(c){console.error("Error fetching new notification details:",c)}})).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notifications",filter:`user_id=eq.${i}`},l=>E(this,null,function*(){try{let c=null;const{data:d,error:f}=yield T.from("notifications_with_details").select("*").eq("id",l.new.id).single();if(f){const u=f.code||(f==null?void 0:f.statusCode)||(f==null?void 0:f.status),h=(f.message||String(f)||"").toLowerCase();u==="PGRST205"||u==="42P01"||u===404||u==="404"||String(u)==="404"||(f==null?void 0:f.status)===404||(f==null?void 0:f.statusCode)===404||(h==null?void 0:h.includes("notifications_with_details"))||(h==null?void 0:h.includes("does not exist"))||(h==null?void 0:h.includes("not found"))||(h==null?void 0:h.includes("404"))||console.warn("Unexpected error fetching from notifications_with_details view:",f)}else d&&(c=d);if(!c){const{data:u}=yield T.from("notifications").select("*").eq("id",l.new.id).single();u&&(c=yield this.enrichNotification(u))}c&&r(c)}catch(c){console.error("Error fetching updated notification details:",c)}})).on("postgres_changes",{event:"DELETE",schema:"public",table:"notifications",filter:`user_id=eq.${i}`},l=>{n(l.old.id)}).subscribe()})}static unsubscribeFromNotifications(t){t&&T.removeChannel(t)}static getNotificationIcon(t){switch(t){case"friend_request":return"";case"friend_accepted":return"";case"review_liked":return"";case"review_commented":return"";case"comment_replied":return"";case"match":return"";case"message":return"";case"event_interest":return"";case"event_attendance_reminder":return"";case"artist_followed":return"";case"artist_new_event":return"";case"artist_profile_updated":return"";case"venue_new_event":return"";case"venue_profile_updated":return"";default:return""}}static getNotificationColor(t){switch(t){case"friend_request":return"bg-blue-100 text-blue-800 border-blue-200";case"friend_accepted":return"bg-green-100 text-green-800 border-green-200";case"review_liked":return"bg-red-100 text-red-800 border-red-200";case"review_commented":return"bg-purple-100 text-purple-800 border-purple-200";case"comment_replied":return"bg-orange-100 text-orange-800 border-orange-200";case"match":return"bg-pink-100 text-pink-800 border-pink-200";case"message":return"bg-indigo-100 text-indigo-800 border-indigo-200";case"event_interest":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"event_attendance_reminder":return"bg-teal-100 text-teal-800 border-teal-200";case"artist_followed":return"bg-purple-100 text-purple-800 border-purple-200";case"artist_new_event":return"bg-pink-100 text-pink-800 border-pink-200";case"artist_profile_updated":return"bg-indigo-100 text-indigo-800 border-indigo-200";case"venue_new_event":return"bg-blue-100 text-blue-800 border-blue-200";case"venue_profile_updated":return"bg-cyan-100 text-cyan-800 border-cyan-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}}static formatNotificationTime(t){const r=new Date,n=new Date(t),a=Math.floor((r.getTime()-n.getTime())/(1e3*60));return a<1?"Just now":a<60?`${a}m ago`:a<1440?`${Math.floor(a/60)}h ago`:`${Math.floor(a/1440)}d ago`}static handleAttendanceReminderAction(t,r,n){return E(this,null,function*(){try{const{data:{user:a}}=yield T.auth.getUser();if(!a)throw new Error("User not authenticated");const{UserEventService:i}=yield Rr(()=>E(this,null,function*(){const{UserEventService:o}=yield Promise.resolve().then(()=>vfe);return{UserEventService:o}}),void 0,import.meta.url);yield i.markUserAttendance(a.id,r,n),yield this.markAsRead(t),console.log(` Attendance marked for event ${r}: ${n?"attended":"did not attend"}`)}catch(a){throw console.error("Error handling attendance reminder action:",a),new Error(`Failed to mark attendance: ${a instanceof Error?a.message:"Unknown error"}`)}})}static requiresAction(t){return["friend_request","event_attendance_reminder"].includes(t)}static getNotificationActions(t){switch(t){case"friend_request":return[{label:"Accept",action:"accept",variant:"success"},{label:"Decline",action:"decline",variant:"secondary"}];case"event_attendance_reminder":return[{label:"Yes, I attended",action:"attended",variant:"primary"},{label:"No, I didn't go",action:"not_attended",variant:"secondary"},{label:"Dismiss",action:"dismiss",variant:"secondary"}];default:return[]}}}function Ede({onClick:e,className:t}){const[r,n]=y.useState(0),[a,i]=y.useState(!0);return y.useEffect(()=>{let o=null;const l=()=>E(this,null,function*(){try{const d=yield gh.getUnreadCount();console.log(" NotificationBell: Unread count loaded:",d),n(d)}catch(d){console.error("Error loading unread count:",d)}finally{i(!1)}}),c=()=>E(this,null,function*(){try{const{data:{user:d},error:f}=yield T.auth.getUser();if(f||!d){console.error("Error getting user for notification subscription:",f),i(!1);return}o=T.channel("notification-bell").on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`user_id=eq.${d.id}`},u=>{console.log(" NotificationBell: Notification change detected:",u.eventType),l()}).subscribe(u=>{u==="SUBSCRIBED"?console.log(" NotificationBell: Successfully subscribed to notifications"):u==="CHANNEL_ERROR"&&console.error(" NotificationBell: Channel subscription error")})}catch(d){console.error("Error setting up notification subscription:",d),i(!1)}});return l(),c(),()=>{o&&T.removeChannel(o)}},[]),a?s.jsx(ce,{variant:"outline",size:"icon",className:Oe("relative",t),disabled:!0,children:s.jsx(Ud,{className:"h-5 w-5"})}):s.jsxs(ce,{variant:"outline",size:"icon",className:Oe("relative",t),onClick:e,"aria-label":"Notifications",children:[s.jsx(Ud,{className:"h-5 w-5"}),r>0&&s.jsx(et,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 rounded-full p-0 flex items-center justify-center text-xs",children:r>99?"99+":r})]})}const Cde=({currentUserId:e,onNavigateToNotifications:t,onNavigateToChat:r,className:n})=>{const[a,i]=y.useState(!1);return y.useEffect(()=>{let o=!1;const l=()=>E(void 0,null,function*(){try{const{data:d,error:f}=yield bT(e);if(f||o||!d)return;const{data:u}=yield T.from("chat_participants").select("chat_id, last_read_at").eq("user_id",e),h=new Map;u==null||u.forEach(m=>{h.set(m.chat_id,m.last_read_at)});for(const m of d){if(o)break;const v=h.get(m.id),g=T.from("messages").select("id").eq("chat_id",m.id).neq("sender_id",e).limit(1);v&&g.gt("created_at",v);const{data:x}=yield g.maybeSingle();if(x){o||i(!0);return}}o||i(!1)}catch(d){console.error("Error loading unread status:",d)}});l();const c=T.channel("page-actions-unread").on("postgres_changes",{event:"*",schema:"public",table:"messages"},l).subscribe();return()=>{o=!0,T.removeChannel(c)}},[e]),s.jsxs("div",{className:Oe("flex items-center gap-2",n),children:[s.jsx(Ede,{onClick:t,className:"h-10 w-10 rounded-full border-2 hover:bg-synth-pink/10 hover:border-synth-pink/50 transition-colors"}),s.jsxs(ce,{variant:"outline",size:"icon",className:"h-10 w-10 rounded-full border-2 hover:bg-synth-pink/10 hover:border-synth-pink/50 transition-colors relative",onClick:()=>r==null?void 0:r(e),"aria-label":"Open chat",children:[s.jsx(Ln,{className:"h-5 w-5"}),a&&s.jsx("span",{className:"absolute -top-1 -right-1 bg-synth-pink rounded-full h-3 w-3 shadow-lg shadow-synth-pink/30 animate-pulse"})]})]})},Pde=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,Px=e=>typeof e=="string"&&Pde.test(e);class cs{static setEventReview(t,r,n,a,i){return E(this,null,function*(){var o,l,c,d,f,u,h,m,v,g,x,_,w,b,N,S,k,C;try{let A;if(n.Event_date&&(n.Event_date instanceof Date?A=n.Event_date.toISOString().split("T")[0]:typeof n.Event_date=="string"&&(A=n.Event_date)),!A&&r&&Px(r))try{const{data:q}=yield T.from("events").select("event_date").eq("id",r).maybeSingle();q!=null&&q.event_date&&(A=new Date(q.event_date).toISOString().split("T")[0])}catch(q){console.warn(" ReviewService: Could not fetch event date:",q)}const R=q=>{const K=Y=>Math.max(.5,Math.min(5,Y));if(typeof q.rating=="number"&&!Number.isNaN(q.rating))return Number(K(q.rating).toFixed(1));const Z=[q.artist_performance_rating,q.production_rating,q.venue_rating,q.location_rating,q.value_rating].filter(Y=>typeof Y=="number"&&Y>0);if(Z.length>0){const Y=Z.reduce((X,se)=>X+se,0)/Z.length;return Number(K(Y).toFixed(1))}const ne=[q.artist_rating].filter(Y=>typeof Y=="number"&&Y>0);return ne.length>0?K(Math.round(ne[0])):3},I=r?Px(r):!1,O=Px(a)?a:void 0,z=Px(i)?i:void 0;if(a&&!O&&console.warn(" ReviewService: Received non-UUID venueId parameter, ignoring",a),i&&!z&&console.warn(" ReviewService: Received non-UUID artistId parameter, ignoring",i),!I&&(!z||!O))throw new Error("Either eventId or both artistId and venueId must be provided");let M=null,B=null;if(I){const q=yield T.from("reviews").select("id, is_draft").eq("user_id",t).eq("event_id",r).eq("is_draft",!1).maybeSingle(),K=yield T.from("reviews").select("id, is_draft").eq("user_id",t).eq("event_id",r).eq("is_draft",!0).maybeSingle(),Z=q.data,ne=K.data;if(console.log(" ReviewService: Checked for existing reviews by event_id:",{published:!!Z,published_id:Z==null?void 0:Z.id,draft:!!ne,draft_id:ne==null?void 0:ne.id}),Z){if(M=Z,B=q.error,ne){console.log(" ReviewService: Found both published review and draft - deleting draft:",ne.id);try{const{error:Y}=yield T.from("reviews").delete().eq("id",ne.id);Y?console.warn(" Failed to delete draft:",Y):console.log(" Deleted draft:",ne.id)}catch(Y){console.warn(" Error deleting draft:",Y)}}}else ne?(M=ne,B=K.error):(M=null,B=null)}else if(z&&O){const q=yield T.from("reviews").select("id, is_draft").eq("user_id",t).eq("artist_id",z).eq("venue_id",O).is("event_id",null).eq("is_draft",!1).maybeSingle(),K=yield T.from("reviews").select("id, is_draft").eq("user_id",t).eq("artist_id",z).eq("venue_id",O).is("event_id",null).eq("is_draft",!0).maybeSingle(),Z=q.data,ne=K.data;if(console.log(" ReviewService: Checked for existing reviews by artist_id + venue_id:",{published:!!Z,published_id:Z==null?void 0:Z.id,draft:!!ne,draft_id:ne==null?void 0:ne.id}),Z){if(M=Z,B=q.error,ne){console.log(" ReviewService: Found both published review and draft - deleting draft:",ne.id);try{const{error:Y}=yield T.from("reviews").delete().eq("id",ne.id);Y?console.warn(" Failed to delete draft:",Y):console.log(" Deleted draft:",ne.id)}catch(Y){console.warn(" Error deleting draft:",Y)}}}else ne?(M=ne,B=K.error):(M=null,B=null)}if(B&&B.code!=="PGRST116"&&B.status!==406)throw B;if(M){if(M.is_draft===!0){console.log(" ReviewService: Existing review is a draft - deleting it completely before creating published review:",M.id);try{const{error:K}=yield T.from("reviews").delete().eq("user_id",t).eq("event_id",r).eq("is_draft",!0);if(K)throw console.error(" Failed to delete draft before creating published review:",K),K;console.log(" Deleted draft completely - will create fresh published review"),M=null}catch(K){throw console.error(" Exception deleting draft:",K),K}}else if(console.log(" ReviewService: Existing review is already published - updating it:",M.id),I)try{let K=T.from("reviews").delete().eq("user_id",t).eq("is_draft",!0);I&&r?K=K.eq("event_id",r):z&&O&&(K=K.eq("artist_id",z).eq("venue_id",O).is("event_id",null));const{error:Z}=yield K;Z?console.warn(" Error deleting drafts before update:",Z):console.log(" Deleted all drafts before updating published review")}catch(K){console.warn(" Exception deleting drafts before update:",K)}if(M){console.log(" ReviewService: Updating existing published review:",M.id);const{data:K}=yield T.from("reviews").select("setlist, custom_setlist").eq("id",M.id).maybeSingle(),Z=V(D(V(D(D({},O?{venue_id:O}:{}),z?{artist_id:z}:{}),{review_text:n.review_text,is_public:n.is_public,is_draft:!1,draft_data:null,last_saved_at:null}),A?{Event_date:A}:{}),{artist_performance_rating:typeof n.artist_performance_rating=="number"&&!isNaN(n.artist_performance_rating)&&n.artist_performance_rating>0?Number(Math.max(.5,Math.min(5,n.artist_performance_rating)).toFixed(1)):void 0,production_rating:typeof n.production_rating=="number"&&!isNaN(n.production_rating)&&n.production_rating>0?Number(Math.max(.5,Math.min(5,n.production_rating)).toFixed(1)):void 0,venue_rating:typeof n.venue_rating=="number"&&!isNaN(n.venue_rating)&&n.venue_rating>0?Number(Math.max(.5,Math.min(5,n.venue_rating)).toFixed(1)):void 0,location_rating:typeof n.location_rating=="number"&&!isNaN(n.location_rating)&&n.location_rating>0?Number(Math.max(.5,Math.min(5,n.location_rating)).toFixed(1)):void 0,value_rating:typeof n.value_rating=="number"&&!isNaN(n.value_rating)&&n.value_rating>0?Number(Math.max(.5,Math.min(5,n.value_rating)).toFixed(1)):void 0,artist_performance_feedback:((o=n.artist_performance_feedback)==null?void 0:o.trim())||void 0,production_feedback:((l=n.production_feedback)==null?void 0:l.trim())||void 0,venue_feedback:((c=n.venue_feedback)==null?void 0:c.trim())||void 0,location_feedback:((d=n.location_feedback)==null?void 0:d.trim())||void 0,value_feedback:((f=n.value_feedback)==null?void 0:f.trim())||void 0,ticket_price_paid:n.ticket_price_paid,artist_rating:n.artist_rating,review_type:n.review_type,venue_tags:n.venue_tags,artist_tags:n.artist_tags,photos:n.photos,setlist:n.setlist!==void 0?n.setlist:(K==null?void 0:K.setlist)||null,custom_setlist:n.custom_setlist!==void 0?n.custom_setlist:(K==null?void 0:K.custom_setlist)||null,attendees:n.attendees,met_on_synth:n.met_on_synth,was_there:!0,updated_at:new Date().toISOString()});console.log(" ReviewService: Update payload category ratings:",{artist_performance_rating:Z.artist_performance_rating,production_rating:Z.production_rating,venue_rating:Z.venue_rating,location_rating:Z.location_rating,value_rating:Z.value_rating}),console.log(" ReviewService: Update payload category feedback:",{artist_performance_feedback:Z.artist_performance_feedback,production_feedback:Z.production_feedback,venue_feedback:Z.venue_feedback,location_feedback:Z.location_feedback,value_feedback:Z.value_feedback});let{error:ne}=yield T.from("reviews").update(Z).eq("id",M.id),Y=null;if(!ne){const X=yield T.from("reviews").select("*").eq("id",M.id).maybeSingle();Y=X.data,ne=X.error,console.log(" ReviewService: Updated review category ratings:",{artist_performance_rating:Y==null?void 0:Y.artist_performance_rating,production_rating:Y==null?void 0:Y.production_rating,venue_rating:Y==null?void 0:Y.venue_rating,location_rating:Y==null?void 0:Y.location_rating,value_rating:Y==null?void 0:Y.value_rating}),console.log(" ReviewService: Updated review category feedback:",{artist_performance_feedback:Y==null?void 0:Y.artist_performance_feedback,production_feedback:Y==null?void 0:Y.production_feedback,venue_feedback:Y==null?void 0:Y.venue_feedback,location_feedback:Y==null?void 0:Y.location_feedback,value_feedback:Y==null?void 0:Y.value_feedback})}if(ne){const X=V(D({},O?{venue_id:O}:{}),{rating:typeof n.rating=="number"?Number(n.rating.toFixed(1)):R(n),review_text:n.review_text,is_public:n.is_public,is_draft:!1,draft_data:null,last_saved_at:null,photos:n.photos,was_there:!0,updated_at:new Date().toISOString()}),se=yield T.from("reviews").update(X).eq("id",M.id).select().single();Y=se.data,ne=se.error}if(ne)throw ne;if(I&&Y)try{const X=yield T.from("reviews").select("id, is_draft").eq("id",Y.id).maybeSingle();X.data&&X.data.is_draft===!0&&(console.warn(" ReviewService: Draft flag still true after update, forcing is_draft = false"),yield T.from("reviews").update({is_draft:!1,draft_data:null,last_saved_at:null}).eq("id",Y.id));let se=T.from("reviews").delete().eq("user_id",t).eq("is_draft",!0);I&&r?se=se.eq("event_id",r):z&&O&&(se=se.eq("artist_id",z).eq("venue_id",O).is("event_id",null));const de=yield se;if(de.error)console.warn(" ReviewService: Failed to delete drafts after update:",de.error);else{const _e=((u=de.data)==null?void 0:u.length)||0;_e>0?console.log(` Deleted ${_e} draft review(s) after submitting review for event:`,r):console.log(" ReviewService: No drafts found to delete (review is now published)");let xe=T.from("reviews").select("id, is_draft").eq("user_id",t).eq("is_draft",!0);I&&r?xe=xe.eq("event_id",r):z&&O&&(xe=xe.eq("artist_id",z).eq("venue_id",O).is("event_id",null));const Q=yield xe;Q.data&&Q.data.length>0?console.warn(` ReviewService: WARNING - ${Q.data.length} draft(s) still exist after cleanup for event:`,r):console.log(" ReviewService: Verified - no drafts remain for this event")}}catch(X){console.warn(" ReviewService: Error during draft cleanup after update:",X)}return Y}}const F=V(D(V(D(D(D({user_id:t},I&&r?{event_id:r}:{}),O?{venue_id:O}:{}),z?{artist_id:z}:{}),{reaction_emoji:n.reaction_emoji,review_text:n.review_text,is_public:(h=n.is_public)!=null?h:!0,is_draft:!1}),A?{Event_date:A}:{}),{artist_performance_rating:typeof n.artist_performance_rating=="number"&&!isNaN(n.artist_performance_rating)&&n.artist_performance_rating>0?Number(Math.max(.5,Math.min(5,n.artist_performance_rating)).toFixed(1)):void 0,production_rating:typeof n.production_rating=="number"&&!isNaN(n.production_rating)&&n.production_rating>0?Number(Math.max(.5,Math.min(5,n.production_rating)).toFixed(1)):void 0,venue_rating:typeof n.venue_rating=="number"&&!isNaN(n.venue_rating)&&n.venue_rating>0?Number(Math.max(.5,Math.min(5,n.venue_rating)).toFixed(1)):void 0,location_rating:typeof n.location_rating=="number"&&!isNaN(n.location_rating)&&n.location_rating>0?Number(Math.max(.5,Math.min(5,n.location_rating)).toFixed(1)):void 0,value_rating:typeof n.value_rating=="number"&&!isNaN(n.value_rating)&&n.value_rating>0?Number(Math.max(.5,Math.min(5,n.value_rating)).toFixed(1)):void 0,artist_performance_feedback:((m=n.artist_performance_feedback)==null?void 0:m.trim())||void 0,production_feedback:((v=n.production_feedback)==null?void 0:v.trim())||void 0,venue_feedback:((g=n.venue_feedback)==null?void 0:g.trim())||void 0,location_feedback:((x=n.location_feedback)==null?void 0:x.trim())||void 0,value_feedback:((_=n.value_feedback)==null?void 0:_.trim())||void 0,ticket_price_paid:n.ticket_price_paid,artist_rating:n.artist_rating,review_type:n.review_type,venue_tags:n.venue_tags,artist_tags:n.artist_tags,photos:n.photos,setlist:n.setlist||null,attendees:n.attendees,met_on_synth:n.met_on_synth,was_there:!0});if(console.log(" ReviewService: Insert payload category ratings:",{artist_performance_rating:F.artist_performance_rating,production_rating:F.production_rating,venue_rating:F.venue_rating,location_rating:F.location_rating,value_rating:F.value_rating}),console.log(" ReviewService: Insert payload category feedback:",{artist_performance_feedback:F.artist_performance_feedback,production_feedback:F.production_feedback,venue_feedback:F.venue_feedback,location_feedback:F.location_feedback,value_feedback:F.value_feedback}),I&&r){console.log(" ReviewService: Checking event JamBase IDs for eventId:",r);const{data:q,error:K}=yield T.from("events_with_artist_venue").select("id, artist_id, artist_name_normalized, venue_id, venue_name_normalized").eq("id",r).single();if(K)console.error(" ReviewService: Error fetching event data:",K);else{console.log(" ReviewService: Event data:",q);const Z=q==null?void 0:q.artist_id;Z&&!z?(console.log(" ReviewService: Using JamBase artist_id from event:",Z),F.artist_id=Z):z?(console.log(" ReviewService: Using provided artistId parameter:",z),F.artist_id=z):console.log(" ReviewService: No artist_id found for event"),O?(console.log(" ReviewService: Using venueId parameter:",O),F.venue_id=O):a?console.warn(" ReviewService: Ignoring non-UUID venueId parameter",a):console.log(" ReviewService: No venueId parameter provided")}}else z&&(console.log(" ReviewService: Using provided artistId (no event):",z),F.artist_id=z),O&&(console.log(" ReviewService: Using provided venueId (no event):",O),F.venue_id=O);console.log(" ReviewService: Final insert payload:",V(D({},F),{category_ratings:{artist_performance_rating:F.artist_performance_rating,production_rating:F.production_rating,venue_rating:F.venue_rating,location_rating:F.location_rating,value_rating:F.value_rating},category_feedback:{artist_performance_feedback:F.artist_performance_feedback,production_feedback:F.production_feedback,venue_feedback:F.venue_feedback,location_feedback:F.location_feedback,value_feedback:F.value_feedback}}));let{data:U,error:H}=yield T.from("reviews").insert(F).select().maybeSingle();if(H){const q=H;if((q==null?void 0:q.code)==="23505"||/duplicate key/i.test((q==null?void 0:q.message)||"")){const K=yield T.from("reviews").update(F).eq("user_id",t).eq("event_id",r).select().maybeSingle();U=K.data,H=K.error}}if(H){const q=V(D(V(D({user_id:t,event_id:r},O?{venue_id:O}:{}),{review_text:n.review_text,is_public:(w=n.is_public)!=null?w:!0,is_draft:!1}),A?{Event_date:A}:{}),{artist_performance_rating:typeof n.artist_performance_rating=="number"&&!isNaN(n.artist_performance_rating)&&n.artist_performance_rating>0?Number(Math.max(.5,Math.min(5,n.artist_performance_rating)).toFixed(1)):void 0,production_rating:typeof n.production_rating=="number"&&!isNaN(n.production_rating)&&n.production_rating>0?Number(Math.max(.5,Math.min(5,n.production_rating)).toFixed(1)):void 0,venue_rating:typeof n.venue_rating=="number"&&!isNaN(n.venue_rating)&&n.venue_rating>0?Number(Math.max(.5,Math.min(5,n.venue_rating)).toFixed(1)):void 0,location_rating:typeof n.location_rating=="number"&&!isNaN(n.location_rating)&&n.location_rating>0?Number(Math.max(.5,Math.min(5,n.location_rating)).toFixed(1)):void 0,value_rating:typeof n.value_rating=="number"&&!isNaN(n.value_rating)&&n.value_rating>0?Number(Math.max(.5,Math.min(5,n.value_rating)).toFixed(1)):void 0,artist_performance_feedback:((b=n.artist_performance_feedback)==null?void 0:b.trim())||void 0,production_feedback:((N=n.production_feedback)==null?void 0:N.trim())||void 0,venue_feedback:((S=n.venue_feedback)==null?void 0:S.trim())||void 0,location_feedback:((k=n.location_feedback)==null?void 0:k.trim())||void 0,value_feedback:((C=n.value_feedback)==null?void 0:C.trim())||void 0,ticket_price_paid:n.ticket_price_paid,photos:n.photos,setlist:n.setlist||null,was_there:!0});console.error(" ReviewService: First insert failed, retrying with minimal insert. Error:",H);const K=yield T.from("reviews").insert(q).select().single();U=K.data,H=K.error}if(H)throw console.error(" ReviewService: Final insert/update error:",H),H;if(console.log(" ReviewService: Review saved successfully. Data:",U),console.log(" ReviewService: Saved category ratings:",{artist_performance_rating:U==null?void 0:U.artist_performance_rating,production_rating:U==null?void 0:U.production_rating,venue_rating:U==null?void 0:U.venue_rating,location_rating:U==null?void 0:U.location_rating,value_rating:U==null?void 0:U.value_rating}),console.log(" ReviewService: Saved category feedback:",{artist_performance_feedback:U==null?void 0:U.artist_performance_feedback,production_feedback:U==null?void 0:U.production_feedback,venue_feedback:U==null?void 0:U.venue_feedback,location_feedback:U==null?void 0:U.location_feedback,value_feedback:U==null?void 0:U.value_feedback}),I&&U)try{const{error:q,data:K}=yield T.from("reviews").delete().eq("user_id",t).eq("event_id",r).eq("is_draft",!0).select("id");if(q)console.error(" CRITICAL: Failed to delete drafts after creating review:",q);else{const Z=(K==null?void 0:K.length)||0;Z>0&&console.log(` NUCLEAR: Deleted ${Z} draft(s) after review creation`);const ne=yield T.from("reviews").select("id").eq("user_id",t).eq("event_id",r).eq("is_draft",!0);ne.data&&ne.data.length>0?(console.error(` CRITICAL ERROR: ${ne.data.length} draft(s) STILL EXIST after deletion!`,ne.data),yield T.from("reviews").delete().eq("user_id",t).eq("event_id",r).eq("is_draft",!0)):console.log(" Verified: All drafts deleted successfully")}}catch(q){console.error(" CRITICAL: Exception during draft cleanup:",q);try{yield T.from("reviews").delete().eq("user_id",t).eq("event_id",r).eq("is_draft",!0)}catch(K){console.error(" CRITICAL: Retry deletion also failed:",K)}}return U}catch(A){const R=A,I=(R==null?void 0:R.message)||(R==null?void 0:R.error_description)||(R==null?void 0:R.details)||(R==null?void 0:R.hint)||JSON.stringify(R);throw console.error("Error setting event review:",R),new Error(`Failed to set event review: ${I}`)}})}static getUserEventReview(t,r){return E(this,null,function*(){try{if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r))return console.log(" Invalid event ID format (not a UUID), skipping review lookup:",r),null;const{data:a,error:i}=yield T.from("reviews").select("*").eq("user_id",t).eq("event_id",r).single();if(i&&i.code!=="PGRST116")throw i;return a||null}catch(n){const a=n;return(a==null?void 0:a.code)!=="22P02"&&console.error("Error getting user event review:",n),null}})}static getPreviousVenueReview(t,r,n){return E(this,null,function*(){try{if(!r)return null;const a=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;if(!a.test(r))return null;const i=T.from("reviews").select("*").eq("user_id",t).eq("venue_id",r).eq("is_draft",!1).order("created_at",{ascending:!1});n&&a.test(n)&&i.neq("event_id",n);const{data:o,error:l}=yield i;return l&&l.code!=="PGRST116"?(console.error("Error getting previous venue review:",l),null):!o||o.length===0?null:o.find(d=>d.venue_rating!=null||d.location_rating!=null||d.venue_feedback||d.location_feedback)||null}catch(a){return console.error("Error getting previous venue review:",a),null}})}static getEventReviews(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select(`
          *,
          events_with_artist_venue:event_id (id, title, artist_name_normalized, venue_name_normalized, event_date),
          review_likes!left(id, user_id)
        `).eq("event_id",t).eq("is_public",!0);if(n&&n.sort((d,f)=>{const u=typeof d.rating=="number"?d.rating:0,h=typeof f.rating=="number"?f.rating:0;return h!==u?h-u:new Date(f.created_at).getTime()-new Date(d.created_at).getTime()}),a)throw a;let i=[];if(r&&n&&n.length>0){const d=n.map(h=>h.id),{data:f,error:u}=yield T.from("entities").select("id, entity_uuid").eq("entity_type","review").in("entity_uuid",d);if(u)console.error("Error fetching entities for review likes:",u);else if(f&&f.length>0){const h=f.map(g=>g.id),{data:m}=yield T.from("engagements").select("entity_id").eq("user_id",r).eq("engagement_type","like").in("entity_id",h),v=new Map(f.map(g=>[g.id,g.entity_uuid]));i=(m==null?void 0:m.map(g=>v.get(g.entity_id)).filter(Boolean))||[]}}const o=(n||[]).map(d=>{var f,u,h,m,v,g;return V(D({},d),{artist_name:((f=d.events_with_artist_venue)==null?void 0:f.artist_name_normalized)||((u=d.events)==null?void 0:u.artist_name),artist_id:d.artist_id||null,venue_name:((h=d.events_with_artist_venue)==null?void 0:h.venue_name_normalized)||((m=d.events)==null?void 0:m.venue_name),venue_id:d.venue_id||null,is_liked_by_user:i.includes(d.id),user_like_id:i.includes(d.id)?(g=(v=d.review_likes)==null?void 0:v.find(x=>x.user_id===r))==null?void 0:g.id:void 0,review_type:d.review_type,is_public:d.is_public})}),l=o.length,c=l>0?o.reduce((d,f)=>d+f.rating,0)/l:0;return{reviews:o,averageRating:c,totalReviews:l}}catch(n){throw console.error("Error getting event reviews:",n),new Error(`Failed to get event reviews: ${n instanceof Error?n.message:"Unknown error"}`)}})}static getUserReviewHistory(t){return E(this,null,function*(){var r,n;try{console.log(" ReviewService: Getting user review history for userId:",t),console.log(" ReviewService: Starting query for userId:",t);const{count:a}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t);console.log(" ReviewService: Total reviews (including drafts) for user:",a);const{data:i,error:o,count:l}=yield T.from("reviews").select('*, "Event_date"',{count:"exact"}).eq("user_id",t).eq("is_draft",!1).order("created_at",{ascending:!1});if(i&&i.length>0&&(console.log(" ReviewService: First review column names:",Object.keys(i[0])),console.log(" ReviewService: First review Event_date check:",{hasEventDate:"event_date"in i[0],hasEventDateCapital:"Event_date"in i[0],event_date:i[0].event_date,Event_date:i[0].Event_date})),i&&i.sort((_,w)=>{const b=typeof _.rating=="number"?_.rating:0,N=typeof w.rating=="number"?w.rating:0;return N!==b?N-b:_.rank_order!=null&&w.rank_order!=null?_.rank_order-w.rank_order:_.rank_order!=null?-1:w.rank_order!=null?1:new Date(w.created_at).getTime()-new Date(_.created_at).getTime()}),console.log(" ReviewService: Query completed. Count:",l,"Data length:",i==null?void 0:i.length),i&&i.length>0&&console.log(" ReviewService: First review sample:",{id:i[0].id,user_id:i[0].user_id,event_id:i[0].event_id,is_draft:i[0].is_draft,was_there:i[0].was_there,review_text:(r=i[0].review_text)==null?void 0:r.substring(0,50)}),console.log(" ReviewService: Raw query result:",{dataLength:i==null?void 0:i.length,error:o,firstReview:i==null?void 0:i[0],userId:t}),o)throw console.error(" ReviewService: Query error:",o),o;if(!i||i.length===0)return console.warn(" ReviewService: No reviews found for user:",t),{reviews:[],total:0};const c=[...new Set((i||[]).map(_=>_.event_id).filter(Boolean))];console.log(" ReviewService: Event IDs to fetch:",c.length,c);let d={};const f=[...new Set((i||[]).map(_=>_.artist_id).filter(Boolean))],u=[...new Set((i||[]).map(_=>_.venue_id).filter(Boolean))];if(c.length>0){const{data:_,error:w}=yield T.from("events").select("id, title, artist_name, venue_name, artist_id, venue_id, event_date, doors_time, venue_city, venue_state, venue_zip").in("id",c);if(console.log(" ReviewService: Events query result:",{dataLength:_==null?void 0:_.length,error:w,firstEvent:_==null?void 0:_[0]}),!w&&_){const b=[...new Set(_.map(R=>R.artist_id).filter(Boolean))],N=[...new Set(_.map(R=>R.venue_id).filter(Boolean))],S=[...new Set([...b,...f])],k=[...new Set([...N,...u])];let C={};if(S.length>0){const{data:R}=yield T.from("artists").select("id, name, image_url").in("id",S);R&&(C=R.reduce((I,O)=>(I[O.id]=O,I),{}))}let A={};if(k.length>0){const{data:R}=yield T.from("venues").select("id, name, image_url").in("id",k);R&&(A=R.reduce((I,O)=>(I[O.id]=O,I),{}))}d=_.reduce((R,I)=>{var O,z;return R[I.id]=V(D({},I),{artist_name:((O=C[I.artist_id])==null?void 0:O.name)||I.artist_name,venue_name:((z=A[I.venue_id])==null?void 0:z.name)||I.venue_name,artist_id:I.artist_id,venue_id:I.venue_id}),R},{}),console.log(" ReviewService: Events map created with",Object.keys(d).length,"events"),console.log(" ReviewService: Sample event in map:",d[Object.keys(d)[0]])}else w&&console.error(" ReviewService: Error fetching events:",w)}else console.warn(" ReviewService: No event IDs found in reviews");let h={},m={};if(f.length>0){const{data:_}=yield T.from("artists").select("id, name, image_url").in("id",f);_&&(h=_.reduce((w,b)=>(w[b.id]=b,w),{}))}if(u.length>0){const{data:_}=yield T.from("venues").select("id, name, image_url").in("id",u);_&&(m=_.reduce((w,b)=>(w[b.id]=b,w),{}))}const v=i,g=(v||[]).filter(_=>!!(_.was_there===!0||_.review_text&&_.review_text!=="ATTENDANCE_ONLY"));console.log(" ReviewService: Total reviews fetched:",v==null?void 0:v.length),console.log(" ReviewService: Reviews after filtering:",g.length),console.log(" ReviewService: Sample filtered review:",g[0]?{id:g[0].id,user_id:g[0].user_id,event_id:g[0].event_id,was_there:g[0].was_there,review_text:g[0].review_text,hasEventInMap:!!d[g[0].event_id],eventTitle:(n=d[g[0].event_id])==null?void 0:n.title}:"No reviews");const x={reviews:g.map(_=>{var k,C;let b=_.event_id&&d[_.event_id]||null;!b&&(_.artist_id||_.venue_id)&&(b={id:null,title:null,artist_name:_.artist_id&&((k=h[_.artist_id])==null?void 0:k.name)||null,venue_name:_.venue_id&&((C=m[_.venue_id])==null?void 0:C.name)||null,artist_id:_.artist_id,venue_id:_.venue_id,event_date:null}),b&&(!b.artist_name||!b.venue_name)&&(!b.artist_name&&_.artist_id&&h[_.artist_id]&&(b.artist_name=h[_.artist_id].name,b.artist_id=_.artist_id),!b.venue_name&&_.venue_id&&m[_.venue_id]&&(b.venue_name=m[_.venue_id].name,b.venue_id=_.venue_id));let N;const S=_.Event_date||_.event_date;if(S){const[A,R,I]=S.split("-").map(Number);if(A&&R&&I){const O=new Date(A,R-1,I);isNaN(O.getTime())||(N=O)}}return{review:{id:_.id,user_id:_.user_id,event_id:_.event_id,artist_id:_.artist_id,venue_id:_.venue_id,rating:_.rating,rank_order:_.rank_order,review_type:_.review_type,review_text:_.review_text,photos:_.photos,videos:_.videos,setlist:_.setlist,mood_tags:_.mood_tags,genre_tags:_.genre_tags,context_tags:_.context_tags,artist_rating:_.artist_rating,artist_performance_rating:_.artist_performance_rating,production_rating:_.production_rating,venue_rating:_.venue_rating,location_rating:_.location_rating,value_rating:_.value_rating,artist_performance_feedback:_.artist_performance_feedback,production_feedback:_.production_feedback,venue_feedback:_.venue_feedback,location_feedback:_.location_feedback,value_feedback:_.value_feedback,Event_date:N,ticket_price_paid:_.ticket_price_paid,created_at:_.created_at,updated_at:_.updated_at,likes_count:_.likes_count,comments_count:_.comments_count,shares_count:_.shares_count,is_public:_.is_public,was_there:_.was_there,attendees:_.attendees,met_on_synth:_.met_on_synth},event:b}}),total:Array.isArray(v)?v.length:0};return console.log(" ReviewService: Processed result:",x),x}catch(a){throw console.error(" ReviewService: Error getting user review history:",a),new Error(`Failed to get user review history: ${a instanceof Error?a.message:"Unknown error"}`)}})}static setRankOrderForRatingGroup(t,r,n){return E(this,null,function*(){console.log(" Saving rank order:",{userId:t,rating:r,count:n.length});const a=Math.round(r*10)/10,i=n.map((o,l)=>({id:o,rank_order:l+1}));try{const{data:o,error:l}=yield T.from("reviews").select("id, rating, artist_performance_rating, production_rating, venue_rating, location_rating, value_rating").eq("user_id",t).eq("is_draft",!1);if(l)console.warn(" Could not fetch reviews to clear rank_order:",l);else if(o){const c=o.filter(d=>{const f=[d.artist_performance_rating,d.production_rating,d.venue_rating,d.location_rating,d.value_rating].filter(h=>typeof h=="number"&&h>0);if(f.length>0){const h=f.reduce((v,g)=>v+g,0)/f.length;return Math.round(h*10)/10===a}return(d.rating?Math.round(d.rating*10)/10:null)===a});for(const d of c)n.includes(d.id)||(yield T.from("reviews").update({rank_order:null}).eq("id",d.id).eq("user_id",t))}for(const c of i){console.log(`  Updating review ${c.id.slice(0,8)}...  rank_order = ${c.rank_order}`);const{error:d}=yield T.from("reviews").update({rank_order:c.rank_order}).eq("id",c.id).eq("user_id",t);if(d)throw console.error(` Error updating review ${c.id}:`,d),d}console.log(" All rankings saved successfully")}catch(o){throw console.error(" Error updating rank order group:",o),new Error(`Failed to update ranking: ${o instanceof Error?o.message:"Unknown error"}`)}})}static clearRankOnRatingChange(t){return E(this,null,function*(){try{const{error:r}=yield T.from("reviews").update({rank_order:null}).eq("id",t);if(r)throw r}catch(r){console.warn("Failed to clear rank_order on rating change",r)}})}static deleteEventReview(t,r){return E(this,null,function*(){try{console.log(" Deleting review:",{userId:t,reviewId:r});const{error:n}=yield T.from("reviews").delete().eq("id",r).eq("user_id",t);if(n)throw console.error("Error deleting review:",n),n;console.log(" Review deleted successfully")}catch(n){throw console.error("Error deleting __event review:",n),new Error(`Failed to delete event review: ${n instanceof Error?n.message:"Unknown error"}`)}})}static likeReview(t,r){return E(this,null,function*(){console.log(" ReviewService: likeReview called",{userId:t,reviewId:r});try{const{data:n,error:a}=yield T.rpc("get_or_create_entity",{p_entity_type:"review",p_entity_uuid:r,p_entity_text_id:null});if(a)throw a;console.log(" ReviewService: Checking for existing like...");const{data:i,error:o}=yield T.from("engagements").select("id").eq("user_id",t).eq("entity_id",n).eq("engagement_type","like").maybeSingle();if(console.log(" ReviewService: Existing like check result:",{existingLike:i,checkError:o}),o&&o.code!=="PGRST116")throw console.error(" ReviewService: Error checking existing like:",o),o;if(i){console.log(" ReviewService: User already liked this review, fetching full like record...");const{data:d,error:f}=yield T.from("engagements").select("*").eq("user_id",t).eq("entity_id",n).eq("engagement_type","like").single();if(f||!d)throw console.error(" ReviewService: Error fetching existing like:",f),f||new Error("Failed to fetch existing like");return{id:d.id,user_id:d.user_id,review_id:r,created_at:d.created_at}}console.log(" ReviewService: Inserting new like...");const{data:l,error:c}=yield T.from("engagements").insert({user_id:t,entity_id:n,engagement_type:"like"}).select().single();if(console.log(" ReviewService: Insert result:",{data:l,error:c}),c){if(console.error(" ReviewService: Error inserting like:",c),c.code==="23505"){console.log(" ReviewService: Duplicate key error, fetching existing like...");const{data:d,error:f}=yield T.from("engagements").select("*").eq("user_id",t).eq("entity_id",n).eq("engagement_type","like").single();if(f||!d)throw console.error(" ReviewService: Error fetching existing like after duplicate key error:",f),c;return console.log(" ReviewService: Found existing like after duplicate error:",d),{id:d.id,user_id:d.user_id,review_id:r,created_at:d.created_at}}throw c}return console.log(" ReviewService: Like inserted successfully:",l),{id:l.id,user_id:l.user_id,review_id:r,created_at:l.created_at}}catch(n){throw console.error(" ReviewService: Error liking review:",n),new Error(`Failed to like review: ${n instanceof Error?n.message:"Unknown error"}`)}})}static unlikeReview(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("entities").select("id").eq("entity_type","review").eq("entity_uuid",r).single();if(a&&a.code!=="PGRST116")throw a;if(!(n!=null&&n.id))return;const{error:i}=yield T.from("engagements").delete().eq("user_id",t).eq("entity_id",n.id).eq("engagement_type","like");if(i)throw i}catch(n){throw console.error("Error unliking review:",n),new Error(`Failed to unlike review: ${n instanceof Error?n.message:"Unknown error"}`)}})}static addComment(t,r,n,a){return E(this,null,function*(){try{const{data:i,error:o}=yield T.rpc("get_or_create_entity",{p_entity_type:"review",p_entity_uuid:r,p_entity_text_id:null});if(o)throw o;const{data:l,error:c}=yield T.from("comments").insert({user_id:t,entity_id:i,comment_text:n,parent_comment_id:a}).select().single();if(c)throw c;return yield this.updateReviewCounts(r,"comments",1),{id:l.id,user_id:l.user_id,review_id:r,comment_text:l.comment_text,parent_comment_id:l.parent_comment_id,created_at:l.created_at,updated_at:l.updated_at,likes_count:l.likes_count||0}}catch(i){throw console.error("Error adding comment:",i),new Error(`Failed to add comment: ${i instanceof Error?i.message:"Unknown error"}`)}})}static getReviewComments(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("entities").select("id").eq("entity_type","review").eq("entity_uuid",t).single();if(n&&n.code!=="PGRST116")throw n;if(!(r!=null&&r.id))return[];const{data:a,error:i}=yield T.from("comments").select("*").eq("entity_id",r.id).order("created_at",{ascending:!0});if(i)throw i;if(!a||a.length===0)return[];const o=[...new Set(a.map(u=>u.user_id))],{data:l,error:c}=yield T.from("users").select("id, name, avatar_url, user_id").in("user_id",o);if(c)throw c;const d=new Map;return l==null||l.forEach(u=>{d.set(u.user_id,{id:u.id,name:u.name,avatar_url:u.avatar_url})}),a.map(u=>V(D({},u),{user:d.get(u.user_id)||{id:u.user_id,name:"Unknown User",avatar_url:void 0}}))}catch(r){throw console.error("Error getting review comments:",r),new Error(`Failed to get review comments: ${r instanceof Error?r.message:"Unknown error"}`)}})}static shareReview(t,r,n){return E(this,null,function*(){try{const{data:a,error:i}=yield T.rpc("get_or_create_entity",{p_entity_type:"review",p_entity_uuid:r,p_entity_text_id:null});if(i)throw i;const{data:o,error:l}=yield T.from("engagements").insert({user_id:t,entity_id:a,engagement_type:"share",engagement_value:n||"unknown",metadata:{review_id:r,share_platform:n}}).select().single();if(l)throw l;return yield this.updateReviewCounts(r,"shares",1),o}catch(a){throw console.error("Error sharing review:",a),new Error(`Failed to share review: ${a instanceof Error?a.message:"Unknown error"}`)}})}static getPublicReviewsWithProfiles(t,r,n=20,a=0){return E(this,null,function*(){try{let i=T.from("reviews").select(`
          *,
          users:users!reviews_user_id_fkey (
            user_id,
            name,
            avatar_url,
            account_type
          )
          events_with_artist_venue:event_id (
            id,
            title,
            artist_name_normalized,
            venue_name_normalized,
            event_date
          )
        `,{count:"exact"}).eq("is_public",!0).eq("is_draft",!1).order("created_at",{ascending:!1}).range(a,a+n-1);t&&(i=i.eq("event_id",t)),r&&(i=i.eq("venue_id",r));const{data:o,error:l,count:c}=yield i;if(l)throw l;const d=(o||[]).map(h=>h.user_id).filter(Boolean),f=new Map;if(d.length>0){const{data:h}=yield T.from("user_verifications").select("user_id, verified").in("user_id",d);h==null||h.forEach(m=>{f.set(m.user_id,m.verified||!1)})}return{reviews:(o||[]).map(h=>{var m,v,g,x,_,w,b,N,S,k,C;return V(D({},h),{reviewer_name:(m=h.users)==null?void 0:m.name,reviewer_avatar:(v=h.users)==null?void 0:v.avatar_url,reviewer_verified:f.get(h.user_id)||!1,reviewer_account_type:(g=h.users)==null?void 0:g.account_type,event_title:((x=h.events_with_artist_venue)==null?void 0:x.title)||((_=h.events)==null?void 0:_.title),artist_name:((w=h.events_with_artist_venue)==null?void 0:w.artist_name_normalized)||((b=h.events)==null?void 0:b.artist_name),venue_name:((N=h.events_with_artist_venue)==null?void 0:N.venue_name_normalized)||((S=h.events)==null?void 0:S.venue_name),event_date:((k=h.events_with_artist_venue)==null?void 0:k.event_date)||((C=h.events)==null?void 0:C.event_date)})}),total:c||0}}catch(i){throw console.error("Error getting public reviews with profiles:",i),new Error(`Failed to get public reviews: ${i instanceof Error?i.message:"Unknown error"}`)}})}static updateReviewCounts(t,r,n){return E(this,null,function*(){try{const a=`${r}_count`;console.log(" ReviewService: Updating review counts",{reviewId:t,type:r,delta:n,column:a});const{data:i,error:o}=yield T.from("reviews").select("likes_count, comments_count, shares_count").eq("id",t).single();if(o){console.error(" ReviewService: Error fetching current counts:",o);return}const l=(i==null?void 0:i[a])||0,c=Math.max(0,l+n);console.log(" ReviewService: Updating count",{currentCount:l,nextCount:c});const{error:d}=yield T.from("reviews").update({[a]:c}).eq("id",t);d?console.error(" ReviewService: Error updating count:",d):console.log(" ReviewService: Successfully updated count")}catch(a){console.error(` ReviewService: Error updating ${r} count:`,a)}})}static getReviewEngagement(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("get_review_engagement",{review_id_param:t,user_id_param:r||null});if(!a&&n&&Array.isArray(n)&&n.length>0&&typeof n[0]=="object")return n[0];console.log(" ReviewService: RPC failed, using direct queries");const{data:i,error:o}=yield T.from("reviews").select("likes_count, comments_count, shares_count").eq("id",t).single();if(o)throw console.error(" ReviewService: Error fetching review data:",o),o;let l=!1;if(r){const{data:c,error:d}=yield T.from("entities").select("id").eq("entity_type","review").eq("entity_uuid",t).single();if(d&&d.code!=="PGRST116"&&console.error("Error fetching entity for review engagement check:",d),c!=null&&c.id){const{data:f,error:u}=yield T.from("engagements").select("id").eq("entity_id",c.id).eq("engagement_type","like").eq("user_id",r).maybeSingle();u?console.error(" ReviewService: Error checking like status:",u):l=!!f}}return{likes_count:(i==null?void 0:i.likes_count)||0,comments_count:(i==null?void 0:i.comments_count)||0,shares_count:(i==null?void 0:i.shares_count)||0,is_liked_by_user:l}}catch(n){return console.warn("ReviewService.getReviewEngagement failed",n),null}})}static getReviewsEngagement(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select(`
          id, 
          likes_count, 
          comments_count, 
          shares_count,
          review_likes!left(id, user_id)
        `).in("id",t);if(a)throw a;const i={};return n==null||n.forEach(o=>{const l=Array.isArray(o.review_likes)?o.review_likes:[],c=r?l.some(d=>d.user_id===r):!1;i[o.id]={likes_count:o.likes_count||0,comments_count:o.comments_count||0,shares_count:o.shares_count||0,is_liked_by_user:c}}),i}catch(n){return console.warn("ReviewService.getReviewsEngagement failed",n),{}}})}static getPopularTags(t){return E(this,null,function*(){try{const r=`${t}_tags`,{data:n,error:a}=yield T.from("reviews").select(r).not(r,"is",null).eq("is_public",!0);if(a)throw a;const i={};return n==null||n.forEach(o=>{(o[r]||[]).forEach(c=>{i[c]=(i[c]||0)+1})}),Object.entries(i).map(([o,l])=>({tag:o,count:l})).sort((o,l)=>l.count-o.count).slice(0,20)}catch(r){return console.error("Error getting popular tags:",r),[]}})}static getVenueStats(t){return E(this,null,function*(){try{let r=t;if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)){const{data:o}=yield T.from("venues_with_external_ids").select("jambase_venue_id").eq("id",t).maybeSingle();o!=null&&o.jambase_venue_id&&(r=o.jambase_venue_id)}const{data:a,error:i}=yield T.rpc("get_venue_stats",{venue_jambase_id:r});if(i)throw i;return a[0]||{total_reviews:0,average_venue_rating:0,average_artist_rating:0,average_overall_rating:0,rating_distribution:{"1_star":0,"2_star":0,"3_star":0,"4_star":0,"5_star":0}}}catch(r){throw console.error("Error getting venue stats:",r),new Error(`Failed to get venue stats: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getPopularVenueTags(t){return E(this,null,function*(){try{let r=t;if(t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)){const{data:o}=yield T.from("venues_with_external_ids").select("jambase_venue_id").eq("id",t).maybeSingle();o!=null&&o.jambase_venue_id&&(r=o.jambase_venue_id)}const{data:n,error:a}=yield T.rpc("get_popular_venue_tags",r?{venue_jambase_id:r}:{});if(a)throw a;return n||[]}catch(r){return console.error("Error getting popular venue tags:",r),[]}})}static getVenueReviews(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select(`
          *,
          review_likes!left(id, user_id)
        `).eq("venue_id",t).eq("is_public",!0).order("created_at",{ascending:!1});if(a)throw a;let i=[];if(r&&n&&n.length>0){const d=n.map(h=>h.id),{data:f,error:u}=yield T.from("entities").select("id, entity_uuid").eq("entity_type","review").in("entity_uuid",d);if(u)console.error("Error fetching entities for review likes:",u);else if(f&&f.length>0){const h=f.map(g=>g.id),{data:m}=yield T.from("engagements").select("entity_id").eq("user_id",r).eq("engagement_type","like").in("entity_id",h),v=new Map(f.map(g=>[g.id,g.entity_uuid]));i=(m==null?void 0:m.map(g=>v.get(g.entity_id)).filter(Boolean))||[]}}const o=(n||[]).map(d=>{var f,u;return V(D({},d),{is_liked_by_user:i.includes(d.id),user_like_id:i.includes(d.id)?(u=(f=d.review_likes)==null?void 0:f.find(h=>h.user_id===r))==null?void 0:u.id:void 0,review_type:d.review_type,is_public:d.is_public})}),l=o.length,c=l>0?o.reduce((d,f)=>d+f.rating,0)/l:0;return{reviews:o,averageRating:c,totalReviews:l}}catch(n){throw console.error("Error getting venue reviews:",n),new Error(`Failed to get venue reviews: ${n instanceof Error?n.message:"Unknown error"}`)}})}static getArtistReviews(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select(`
          *,
          review_likes!left(id, user_id)
        `).eq("artist_id",t).eq("is_public",!0).order("created_at",{ascending:!1});if(a)throw a;let i=[];if(r&&n&&n.length>0){const d=n.map(h=>h.id),{data:f,error:u}=yield T.from("entities").select("id, entity_uuid").eq("entity_type","review").in("entity_uuid",d);if(u)console.error("Error fetching entities for review likes:",u);else if(f&&f.length>0){const h=f.map(g=>g.id),{data:m}=yield T.from("engagements").select("entity_id").eq("user_id",r).eq("engagement_type","like").in("entity_id",h),v=new Map(f.map(g=>[g.id,g.entity_uuid]));i=(m==null?void 0:m.map(g=>v.get(g.entity_id)).filter(Boolean))||[]}}const o=(n||[]).map(d=>{var f,u;return V(D({},d),{is_liked_by_user:i.includes(d.id),user_like_id:i.includes(d.id)?(u=(f=d.review_likes)==null?void 0:f.find(h=>h.user_id===r))==null?void 0:u.id:void 0,review_type:d.review_type,is_public:d.is_public})}),l=o.length,c=l>0?o.reduce((d,f)=>d+f.rating,0)/l:0;return{reviews:o,averageRating:c,totalReviews:l}}catch(n){throw console.error("Error getting artist reviews:",n),new Error(`Failed to get artist reviews: ${n instanceof Error?n.message:"Unknown error"}`)}})}static getArtistStats(t){return E(this,null,function*(){try{let r=t;if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)){const{data:o}=yield T.from("artists").select("jambase_artist_id").eq("id",t).single();o!=null&&o.jambase_artist_id&&(r=o.jambase_artist_id)}const{data:a,error:i}=yield T.rpc("get_artist_stats",{artist_jambase_id:r});if(i)throw i;return a[0]||{total_reviews:0,average_rating:0,rating_distribution:{"1_star":0,"2_star":0,"3_star":0,"4_star":0,"5_star":0}}}catch(r){throw console.error("Error getting artist stats:",r),new Error(`Failed to get artist stats: ${r instanceof Error?r.message:"Unknown error"}`)}})}}const Nr=y.forwardRef((a,n)=>{var i=a,{className:e,type:t}=i,r=ge(i,["className","type"]);return s.jsx("input",D({type:t,className:Oe("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n},r))});Nr.displayName="Input";var Tde="Label",iB=y.forwardRef((e,t)=>s.jsx(Pt.label,V(D({},e),{ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}})));iB.displayName=Tde;var oB=iB;const Ade=mp("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),qt=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(oB,D({ref:r,className:Oe(Ade(),e)},t))});qt.displayName=oB.displayName;const Rde=e=>{switch(e){case"1min":return 4;case"3min":return 6;case"5min":return 9;default:return 1}},Zh=8,GM={reviewDuration:null,selectedArtist:null,selectedVenue:null,eventDate:"",selectedSetlist:null,customSetlist:[],artistPerformanceRating:0,productionRating:0,venueRating:0,locationRating:0,valueRating:0,artistPerformanceFeedback:"",productionFeedback:"",venueFeedback:"",locationFeedback:"",valueFeedback:"",ticketPricePaid:"",rating:0,reviewText:"",photos:[],videos:[],attendees:[],metOnSynth:!1,isPublic:!0,reviewType:"event"};function Ode(){const[e,t]=y.useState({currentStep:1,formData:GM,errors:{},isLoading:!1,isValid:!1}),r=g=>{switch(g){case"1min":return"quick";case"3min":return"standard";case"5min":return"detailed";default:return null}},n=g=>Rde(g),a=y.useCallback((g,x)=>{const _={},w=r(x.reviewDuration);if(n(x.reviewDuration),g===1&&!x.reviewDuration)return _.reviewDuration="Please select how much time you want to spend",_;switch(w){case"quick":g===2?(x.selectedArtist||(_.selectedArtist="Please select an artist"),x.selectedVenue||(_.selectedVenue="Please select a venue"),x.eventDate||(_.eventDate="Please select a date")):g===3&&((!x.rating||x.rating<.5||x.rating>5)&&(_.rating="Please provide an overall rating (0.5 - 5 stars)"),!x.reviewText||x.reviewText.trim()===""?_.reviewText="Please share a brief description of your experience":x.reviewText.length>200&&(_.reviewText="Review text must be 200 characters or less for quick review"));break;case"standard":g===2?(x.selectedArtist||(_.selectedArtist="Please select an artist"),x.selectedVenue||(_.selectedVenue="Please select a venue"),x.eventDate||(_.eventDate="Please select a date")):g===3?(!x.artistPerformanceRating||x.artistPerformanceRating<.5||x.artistPerformanceRating>5)&&(_.artistPerformanceRating="Please rate the artist performance (0.5 - 5 stars)"):g===4?(!x.venueRating||x.venueRating<.5||x.venueRating>5)&&(_.venueRating="Please rate the venue (0.5 - 5 stars)"):g===5&&(!x.reviewText||x.reviewText.trim()===""?_.reviewText="Please share a description of your experience":x.reviewText.length>400&&(_.reviewText="Review text must be 400 characters or less for standard review"));break;case"detailed":g===2?(x.selectedArtist||(_.selectedArtist="Please select an artist"),x.selectedVenue||(_.selectedVenue="Please select a venue"),x.eventDate||(_.eventDate="Please select a date")):g===3?(!x.artistPerformanceRating||x.artistPerformanceRating<.5||x.artistPerformanceRating>5)&&(_.artistPerformanceRating="Please rate the artist performance (0.5 - 5 stars)"):g===4?(!x.productionRating||x.productionRating<.5||x.productionRating>5)&&(_.productionRating="Please rate the production quality (0.5 - 5 stars)"):g===5?(!x.venueRating||x.venueRating<.5||x.venueRating>5)&&(_.venueRating="Please rate the venue (0.5 - 5 stars)"):g===6?(!x.locationRating||x.locationRating<.5||x.locationRating>5)&&(_.locationRating="Please rate the location & logistics (0.5 - 5 stars)"):g===7?((!x.valueRating||x.valueRating<.5||x.valueRating>5)&&(_.valueRating="Please rate the value for the ticket (0.5 - 5 stars)"),x.ticketPricePaid&&Number.isNaN(Number(x.ticketPricePaid))?_.ticketPricePaid="Ticket price must be a valid number":x.ticketPricePaid&&Number(x.ticketPricePaid)<0&&(_.ticketPricePaid="Ticket price cannot be negative")):g===8&&(!x.reviewText||x.reviewText.trim()===""?_.reviewText="Please share a brief description of your experience":x.reviewText.length>500&&(_.reviewText="Review text must be 500 characters or less"));break}return _},[]),i=y.useCallback(g=>{const x=[];if(g.artistPerformanceRating&&g.artistPerformanceRating>0&&x.push(g.artistPerformanceRating),g.productionRating&&g.productionRating>0&&x.push(g.productionRating),g.venueRating&&g.venueRating>0&&x.push(g.venueRating),g.locationRating&&g.locationRating>0&&x.push(g.locationRating),g.valueRating&&g.valueRating>0&&x.push(g.valueRating),x.length===0)return 0;const _=x.reduce((w,b)=>w+b,0)/x.length;return Math.round(_*10)/10},[]),o=y.useCallback(g=>{console.log(" useReviewForm: updateFormData called with:",g),t(x=>{const _=D(D({},x.formData),g);console.log(" useReviewForm: Previous formData:",x.formData),console.log(" useReviewForm: New formData:",_),(g.artistPerformanceRating!==void 0||g.productionRating!==void 0||g.venueRating!==void 0||g.locationRating!==void 0||g.valueRating!==void 0)&&(_.rating=i(_));const w=a(x.currentStep,_),b=Object.keys(w).length===0;return console.log(" useReviewForm: Step validation errors:",w),console.log(" useReviewForm: Form is valid:",b),V(D({},x),{formData:_,errors:w,isValid:b})})},[a,i]),l=y.useCallback(()=>{t(g=>{const x=a(g.currentStep,g.formData);if(!(Object.keys(x).length===0))return V(D({},g),{errors:x});const w=n(g.formData.reviewDuration),b=w>0?w:Zh,N=Math.min(g.currentStep+1,b);return V(D({},g),{currentStep:N,errors:{},isValid:!0})})},[a]),c=y.useCallback(()=>{t(g=>V(D({},g),{currentStep:Math.max(g.currentStep-1,1),errors:{}}))},[]),d=y.useCallback(g=>{t(x=>{const _=n(x.formData.reviewDuration),w=_>0?_:Zh;return V(D({},x),{currentStep:Math.max(1,Math.min(g,w)),errors:{}})})},[]),f=y.useCallback(g=>{t(x=>V(D({},x),{isLoading:g}))},[]),u=y.useCallback(()=>{t({currentStep:1,formData:GM,errors:{},isLoading:!1,isValid:!1})},[]),h=y.useCallback(g=>{t(x=>{const _=D(D({},x.formData),g);(g.artistPerformanceRating!==void 0||g.productionRating!==void 0||g.venueRating!==void 0||g.locationRating!==void 0||g.valueRating!==void 0)&&(_.rating=i(_));const w=a(x.currentStep,_),b=Object.keys(w).length===0;return V(D({},x),{formData:_,errors:w,isValid:b})})},[a,i]),m=n(e.formData.reviewDuration),v=m>0?m:Zh;return V(D({},e),{updateFormData:o,nextStep:l,prevStep:c,setStep:d,setLoading:f,resetForm:u,setFormData:h,canProceed:e.isValid,canGoBack:e.currentStep>1,isLastStep:e.currentStep===v,totalSteps:v,currentFlow:r(e.formData.reviewDuration)})}function Mde({reviewDuration:e,onSelectDuration:t}){const r=[{value:"1min",label:"1 Minute",subtitle:"Quick Review",description:"Overall rating + brief text",features:["Overall rating","Brief review text (200 chars)","Optional setlist"]},{value:"3min",label:"3 Minutes",subtitle:"Standard Review",description:"Key ratings + text + photos",features:["Overall rating","Artist Performance & Venue ratings","Review text (400 chars)","Optional photos","Optional setlist"]},{value:"5min",label:"5 Minutes",subtitle:"Detailed Review",description:"Full detailed review",features:["All 5 category ratings","Category feedback","Full review text (500 chars)","Photos & videos","Optional setlist","Optional ticket price"]}];return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("header",{className:"text-center space-y-2",children:[s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",textTransform:"uppercase",letterSpacing:"0.3em"},children:"Get Started"}),s.jsx("h2",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:"How much time do you want to spend?"}),s.jsx("p",{className:"max-w-xl mx-auto",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:"Choose the review style that works best for you."})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:r.map(n=>{const a=e===n.value;return s.jsxs("button",{type:"button",onClick:()=>t(n.value),className:Oe("relative p-6 rounded-2xl border-2 text-left transition-all hover:scale-[1.02]"),style:{borderColor:a?"var(--brand-pink-500)":"var(--neutral-200)",background:a?"var(--brand-pink-050)":"var(--neutral-50)",boxShadow:a?"0 4px 4px 0 var(--shadow-color)":"none"},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx(Oa,{className:"w-5 h-5",style:{color:a?"var(--brand-pink-500)":"var(--neutral-400)"}}),s.jsxs("div",{children:[s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)"},children:n.label}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:n.subtitle})]})]}),s.jsx("p",{className:"mb-4",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:n.description}),s.jsx("ul",{className:"space-y-1.5",children:n.features.map((i,o)=>s.jsxs("li",{className:"flex items-start gap-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsx("span",{style:{width:"var(--spacing-inline, 6px)",height:"var(--spacing-inline, 6px)",backgroundColor:"var(--brand-pink-500)",borderRadius:"999px",display:"inline-block",marginTop:"var(--spacing-inline, 6px)",flexShrink:0}}),s.jsx("span",{children:i})]},o))}),a&&s.jsx("div",{className:"absolute top-4 right-4",children:s.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--brand-pink-500)"},children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",style:{color:"var(--neutral-50)"},children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})})]},n.value)})})]})}const Ai=({value:e,onChange:t,placeholder:r="Search",onSubmit:n,widthVariant:a="full",className:i="",autoFocus:o=!1,disabled:l=!1,id:c,name:d,onFocus:f,onBlur:u})=>{const[h,m]=y.useState(""),v=y.useRef(null),g=e!==void 0?e:h,x=e!==void 0,_=A=>{const R=A.target.value;x||m(R),t==null||t(R)},w=()=>{var A;x||m(""),t==null||t(""),(A=v.current)==null||A.focus()},b=A=>{A.key==="Enter"&&n&&n(g)},N=g.length>0,S="synth-search-bar",k=`synth-search-bar--${a}`,C=[S,k,i].filter(Boolean).join(" ");return s.jsxs("div",{className:C,children:[s.jsx("div",{className:"synth-search-bar__icon-left","aria-hidden":"true",children:s.jsx(Re,{name:"search",size:24,alt:""})}),s.jsx("input",{ref:v,type:"text",value:g,onChange:_,onKeyDown:b,onFocus:f,onBlur:u,placeholder:r,disabled:l,autoFocus:o,id:c||`search-input-${Math.random().toString(36).substr(2,9)}`,name:d,className:"synth-search-bar__input","aria-label":r||"Search","aria-describedby":N?`${c||"search-input"}-clear-button`:void 0}),N&&s.jsx("button",{type:"button",onClick:w,className:"synth-search-bar__clear","aria-label":"Clear search",id:`${c||"search-input"}-clear-button`,children:s.jsx(Re,{name:"x",size:16,alt:"","aria-hidden":"true"})})]})};class r0{static searchArtistsTrigram(t,r=20){return E(this,null,function*(){if(!t||t.length<2)return[];try{return yield this.getFuzzyMatchedResults(t,r)}catch(n){return console.error("Error in trigram search:",n),this.searchArtists(t,r,!1)}})}static searchArtists(t,r=20,n=!1,a=!0){return E(this,null,function*(){if(!t||t.length<2)return[];try{console.log(` Searching for artists: "${t}" (useApi: ${n}, useTrigram: ${a})`);let i=[];try{a?(i=yield this.searchArtistsTrigram(t,r),console.log(` Found ${i.length} artists using trigram search`)):(i=yield this.getFuzzyMatchedResults(t,r),console.log(` Found ${i.length} artists from local database`))}catch(l){if(console.warn("  Could not get fuzzy results from database:",l),a)try{i=yield this.getFuzzyMatchedResults(t,r),console.log(` Fallback: Found ${i.length} artists using client-side search`)}catch(c){console.warn("  Fallback search also failed:",c)}}if(!n)return console.log(` Returning ${i.length} results from local database (no API call)`),i;let o=[];try{a?(o=yield this.searchArtistsTrigram(t,r),console.log(` Final trigram search results: ${o.length}`)):(o=yield this.getFuzzyMatchedResults(t,r),console.log(` Final database results: ${o.length}`))}catch(l){if(console.warn("  Could not get final results from database:",l),a)try{o=yield this.getFuzzyMatchedResults(t,r),console.log(` Fallback final results: ${o.length}`)}catch(c){console.warn("  Fallback final search also failed:",c)}}return o.length>0?o:(console.log(" No results found in database"),[])}catch(i){return console.error(" Error in unified artist search:",i),[]}})}static searchTicketmasterAttractions(t,r){return E(this,null,function*(){return[]})}static searchJamBaseAPI(t,r){return E(this,null,function*(){return[]})}static getFallbackArtists(t,r){const i=[{id:"cage-the-elephant-1",name:"Cage The Elephant",identifier:"jambase:cage-the-elephant-1",image:"https://picsum.photos/300/300?random=1",genres:["alternative rock","indie rock","garage rock"],"x-bandOrMusician":"band","x-numUpcomingEvents":12},{id:"goose-1",name:"Goose",identifier:"jambase:goose-1",image:"https://picsum.photos/300/300?random=2",genres:["jam band","rock","funk"],"x-bandOrMusician":"band","x-numUpcomingEvents":25},{id:"phish-1",name:"Phish",identifier:"jambase:194164",image:"https://picsum.photos/300/300?random=3",genres:["rock","jam band","psychedelic rock"],"x-bandOrMusician":"band","x-numUpcomingEvents":12},{id:"dead-company-1",name:"Dead & Company",identifier:"jambase:123456",image:"https://picsum.photos/300/300?random=4",genres:["rock","jam band","psychedelic rock"],"x-bandOrMusician":"band","x-numUpcomingEvents":8},{id:"grateful-dead-1",name:"Grateful Dead",identifier:"jambase:789012",image:"https://picsum.photos/300/300?random=5",genres:["rock","jam band","psychedelic rock"],"x-bandOrMusician":"band","x-numUpcomingEvents":0},{id:"tame-impala-1",name:"Tame Impala",identifier:"jambase:345678",image:"https://picsum.photos/300/300?random=6",genres:["psychedelic rock","indie rock","electronic"],"x-bandOrMusician":"band","x-numUpcomingEvents":15},{id:"radiohead-1",name:"Radiohead",identifier:"jambase:901234",image:"https://picsum.photos/300/300?random=7",genres:["alternative rock","electronic","experimental"],"x-bandOrMusician":"band","x-numUpcomingEvents":6},{id:"taylor-swift-1",name:"Taylor Swift",identifier:"jambase:taylor-swift-1",image:"https://picsum.photos/300/300?random=8",genres:["pop","country","folk"],"x-bandOrMusician":"musician","x-numUpcomingEvents":50},{id:"drake-1",name:"Drake",identifier:"jambase:drake-1",image:"https://picsum.photos/300/300?random=9",genres:["hip-hop","r&b","pop"],"x-bandOrMusician":"musician","x-numUpcomingEvents":30},{id:"joe-russo-1",name:"Joe Russo",identifier:"jambase:joe-russo-1",image:"https://picsum.photos/300/300?random=10",genres:["rock","jam band","drummer"],"x-bandOrMusician":"musician","x-numUpcomingEvents":5},{id:"joe-russo-almost-dead-1",name:"Joe Russo's Almost Dead",identifier:"jambase:joe-russo-almost-dead-1",image:"https://picsum.photos/300/300?random=11",genres:["jam band","rock","grateful dead"],"x-bandOrMusician":"band","x-numUpcomingEvents":15}].map(o=>V(D({},o),{match_score:this.calculateFuzzyMatchScore(t,o.name)})).filter(o=>o.match_score>15).sort((o,l)=>l.match_score-o.match_score).slice(0,r);return console.log(` Fallback search for "${t}": ${i.length} matches found`),i}static populateArtistProfiles(t){return E(this,null,function*(){var n,a,i,o,l,c;const r=[];if(!t||t.length===0)return r;for(const d of t)try{const f=((n=d.identifier)==null?void 0:n.split(":")[1])||d.identifier||d.id;if(!f){console.warn(` Skipping artist ${d.name} - no identifier available`);continue}let u=null;try{const{data:g,error:x}=yield T.from("artists_with_external_ids").select("*").eq("jambase_artist_id",f).maybeSingle();g&&!x&&(u=g),x&&(x.code==="PGRST301"||x.status===406||((a=x.message)==null?void 0:a.includes("406"))||((i=x.message)==null?void 0:i.includes("Not Acceptable")))?console.warn(`  406 error checking artist ${d.name}, continuing anyway:`,x.message):x&&x.code!=="PGRST116"&&console.warn(`  Database error checking artist ${d.name}:`,x)}catch(g){console.warn(`  Exception checking artist ${d.name}:`,g)}if(u){console.log(`  Artist ${d.name} already exists in database`),r.push(u);continue}const h={name:d.name,identifier:d.identifier,url:d.url||null,image_url:d.image||null,date_published:new Date().toISOString(),date_modified:new Date().toISOString()};let m=null;try{const{data:g,error:x}=yield T.from("artists_with_external_ids").select("id").eq("jambase_artist_id",f).maybeSingle();g&&!x&&(m=g),x&&(x.code==="PGRST301"||x.status===406||((o=x.message)==null?void 0:o.includes("406"))||((l=x.message)==null?void 0:l.includes("Not Acceptable")))?(console.warn(`  406 error checking artist ${d.name} for update, will try insert:`,x.message),m=null):x&&x.code!=="PGRST116"&&console.warn(`  Error checking artist ${d.name}:`,x)}catch(g){console.warn(`  Exception checking artist ${d.name}:`,g),m=null}let v;if(m){const{data:g,error:x}=yield T.from("artists").update(h).eq("id",m.id).select().maybeSingle();if(x)console.error(` Error updating artist ${d.name}:`,x),v=m;else{v=g;try{yield T.from("external_entity_ids").upsert({entity_type:"artist",entity_uuid:v.id,source:"jambase",external_id:f},{onConflict:"entity_uuid,source,entity_type"}).select()}catch(_){}}}else{const{data:g,error:x}=yield T.from("artists").insert(h).select().maybeSingle();if(x)console.error(` Error inserting artist ${d.name}:`,x),v=null;else{v=g;try{yield T.from("external_entity_ids").insert({entity_type:"artist",entity_uuid:v.id,source:"jambase",external_id:f}).select()}catch(_){}}}if(!v){console.error(` Failed to save artist ${d.name}`);continue}console.log(` Saved artist ${d.name} to database`),r.push(v)}catch(f){console.error(` Error processing artist ${d.name}:`,f);const u=((c=d.identifier)==null?void 0:c.split(":")[1])||d.identifier||d.id;if(!u)continue;r.push({id:d.id||u,jambase_artist_id:u,name:d.name,description:d.description||`Artist: ${d.name}`,genres:d.genres||[],image_url:d.image,popularity_score:d["x-numUpcomingEvents"]||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),identifier:d.identifier||u,band_or_musician:d["x-bandOrMusician"]||"band",num_upcoming_events:d["x-numUpcomingEvents"]||0,last_synced_at:new Date().toISOString()});continue}return r})}static fetchFullArtistDetails(t){return E(this,null,function*(){throw new Error("JamBase API removed - use database queries instead")})}static getFuzzyMatchedResults(t,r){return E(this,null,function*(){try{const n=t.trim(),i=n.split(/\s+/).length===1&&n.length>0?`${n}%`:`%${n}%`,{data:o,error:l}=yield T.from("artists").select("id, name, identifier, image_url, genres, num_upcoming_events").ilike("name",i).limit(Math.max(r*5,100));if(l)return console.warn(`  Database error getting artists: ${l.message}`),[];if(!o||o.length===0)return console.log(" No artists found in database for artist search"),[];const c=o.filter(m=>typeof m=="object"&&m!==null&&typeof m.id=="string"&&typeof m.name=="string"),d=c.map(m=>m.id),f=c.filter(m=>!m.num_upcoming_events||m.num_upcoming_events===0),u=new Map;if(f.length>0){const m=new Date().toISOString(),{data:v,error:g}=yield T.from("events").select("artist_id").in("artist_id",f.map(x=>x.id)).gte("event_date",m);!g&&v&&v.forEach(x=>{if(x.artist_id){const _=u.get(x.artist_id)||0;u.set(x.artist_id,_+1)}})}return c.map(m=>{let v=m.num_upcoming_events||0;return v===0&&u.has(m.id)&&(v=u.get(m.id)||0),{id:m.id,name:m.name,identifier:m.identifier||`manual:${m.id}`,image_url:m.image_url||void 0,genres:m.genres||[],band_or_musician:"band",num_upcoming_events:v,match_score:this.calculateFuzzyMatchScore(t,m.name),is_from_database:!0}}).filter(m=>m.match_score>5).sort((m,v)=>v.match_score-m.match_score).slice(0,r)}catch(n){return console.error(" Error getting fuzzy matched results:",n),[]}})}static calculateFuzzyMatchScore(t,r){const n=t.toLowerCase().trim(),a=r.toLowerCase().trim();if(a===n)return 100;if(a.startsWith(n))return 95;if(a.includes(n)){const u=n.length/a.length;return u>=.3?85+Math.round(u*10):70+Math.round(u*15)}const i=n.split(/[\s']+/).filter(u=>u.length>0),o=a.split(/[\s']+/).filter(u=>u.length>0);if(i.length>1){let u=0;for(const h of i)o.includes(h)&&u++;if(u>=Math.ceil(i.length*.5))return 80+u/i.length*15}if(i.length===1&&o.includes(i[0]))return 85;let l=0;for(const u of i)for(const h of o)if(h.includes(u)||u.includes(h)){l++;break}if(l>0)return 50+l/i.length*30;const c=this.levenshteinDistance(n,a),d=Math.max(n.length,a.length),f=1-c/d;return f>.5?Math.round(f*60):0}static searchAllContent(t,r=20,n=!1){return E(this,null,function*(){try{console.log(` Searching all content for: "${t}" with limit: ${r} (useApi: ${n})`),console.log(` Searching artists with limit: ${Math.floor(r*.5)}`);const a=yield this.searchArtists(t,Math.floor(r*.5),n);console.log(` Searching events with limit: ${Math.floor(r*.3)}`);const i=yield this.searchEvents(t,Math.floor(r*.3));console.log(` Searching users with limit: ${Math.floor(r*.2)}`);const o=yield this.searchUsers(t,Math.floor(r*.2));return console.log(" Search results summary:",{artists:a.length,events:i.length,users:o.length}),{artists:a,events:i,users:o}}catch(a){return console.error(" Error searching all content:",a),{artists:[],events:[],users:[]}}})}static searchEvents(t,r){return E(this,null,function*(){try{console.log(` Searching events for: "${t}" with limit: ${r}`);const{data:n,error:a}=yield T.from("events").select("*").or(`artist_name.ilike.%${t}%,venue_name.ilike.%${t}%,title.ilike.%${t}%`).order("event_date",{ascending:!0}).limit(r);return a?(console.warn("  Error searching events:",a),[]):(console.log(` Found ${(n==null?void 0:n.length)||0} events:`,n==null?void 0:n.map(i=>i.title||i.artist_name)),n||[])}catch(n){return console.error(" Error searching events:",n),[]}})}static searchUsers(t,r){return E(this,null,function*(){try{console.log(` Searching users for: "${t}" with limit: ${r}`);const{data:n,error:a}=yield T.from("users").select("user_id, name, bio, avatar_url, instagram_handle").or(`name.ilike.%${t}%,bio.ilike.%${t}%,instagram_handle.ilike.%${t}%`).order("created_at",{ascending:!1}).limit(r);return a?(console.warn("  Error searching users:",a),[]):(console.log(` Found ${(n==null?void 0:n.length)||0} users:`,n==null?void 0:n.map(i=>i.name)),n||[])}catch(n){return console.error(" Error searching users:",n),[]}})}static levenshteinDistance(t,r){const n=Array(r.length+1).fill(null).map(()=>Array(t.length+1).fill(null));for(let a=0;a<=t.length;a++)n[0][a]=a;for(let a=0;a<=r.length;a++)n[a][0]=a;for(let a=1;a<=r.length;a++)for(let i=1;i<=t.length;i++){const o=t[i-1]===r[a-1]?0:1;n[a][i]=Math.min(n[a][i-1]+1,n[a-1][i]+1,n[a-1][i-1]+o)}return n[r.length][t.length]}static getArtistSuggestions(t,r=10){return E(this,null,function*(){return this.searchArtists(t,r)})}static getArtistById(t){return E(this,null,function*(){const{data:r,error:n}=yield T.from("artists_with_external_ids").select("*").eq("jambase_artist_id",t).maybeSingle();if(n){if(n.code==="PGRST116")return null;throw new Error(`Database error: ${n.message}`)}return r})}static getAllArtists(t=50){return E(this,null,function*(){const{data:r,error:n}=yield T.from("artists").select("*").order("created_at",{ascending:!1}).limit(t);if(n)throw new Error(`Database error: ${n.message}`);return r||[]})}static clearAllArtists(){return E(this,null,function*(){const{error:t}=yield T.from("artists").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw new Error(`Database error: ${t.message}`)})}static testJamBaseAPI(){return E(this,null,function*(){return{success:!1,message:"JamBase API has been removed. Use database queries instead."}})}}const Dde=Object.freeze(Object.defineProperty({__proto__:null,UnifiedArtistSearchService:r0},Symbol.toStringTag,{value:"Module"}));function b1({onArtistSelect:e,placeholder:t="Search for an artist...",className:r,hideClearButton:n=!1,onSearchStateChange:a}){const[i,o]=y.useState(""),[l,c]=y.useState(null),[d,f]=y.useState(!1),[u,h]=y.useState(!1),[m,v]=y.useState(-1),g=y.useRef(null);y.useEffect(()=>{if(!i.trim()){c(null),h(!1),a==null||a(!1);return}const k=setTimeout(()=>E(this,null,function*(){yield x(i)}),300);return()=>clearTimeout(k)},[i]),y.useEffect(()=>{const k=C=>{if(!(!u||!l))switch(C.key){case"ArrowDown":C.preventDefault(),v(A=>A<l.artists.length-1?A+1:A);break;case"ArrowUp":C.preventDefault(),v(A=>A>0?A-1:-1);break;case"Enter":C.preventDefault(),m>=0&&m<l.artists.length&&_(l.artists[m]);break;case"Escape":h(!1),v(-1);break}};return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)},[u,l,m]),y.useEffect(()=>{if(m>=0&&g.current){const k=g.current.children[m];k&&k.scrollIntoView({block:"nearest"})}},[m]);const x=k=>E(this,null,function*(){try{f(!0);const C=yield r0.searchArtists(k,10),A={artists:C.map(R=>{var I;return{id:R.id,jambase_artist_id:((I=R.identifier)==null?void 0:I.replace("jambase:",""))||R.id,name:R.name,description:`${R.num_upcoming_events||0} upcoming events`,genres:R.genres||[],image_url:R.image_url,popularity_score:R.num_upcoming_events||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),source:R.is_from_database?"database":"jambase"}}),totalFound:C.length,query:k};c(A),h(!0),v(-1),a==null||a(!0)}catch(C){console.error("Artist search error:",C),c({artists:[],totalFound:0,query:k}),h(!0)}finally{f(!1)}}),_=k=>{try{const A=k.id||null;Zt.click("artist",A||k.jambase_artist_id||k.name,{source:"artist_search_box",name:k.name||k.name},A||void 0)}catch(A){}e(k),o(k.name),h(!1),v(-1),a==null||a(!1);const C=document.getElementById("artist-search-input");C==null||C.blur()},w=()=>{l&&l.artists.length>0&&h(!0)},b=()=>{setTimeout(()=>{h(!1),v(-1),a==null||a(!1)},150)},N=()=>{o(""),c(null),h(!1),v(-1),a==null||a(!1);const k=document.getElementById("artist-search-input");k==null||k.focus()},S=(k=[])=>k.slice(0,3).join(", ");return s.jsxs("div",{className:Oe("relative w-full",r),children:[s.jsxs("div",{className:"relative",children:[s.jsx(Ai,{id:"artist-search-input",name:"artistSearch",placeholder:t,value:i,onChange:k=>o(k),onFocus:w,onBlur:b,widthVariant:"full"}),s.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[d&&s.jsx(fr,{className:"w-4 h-4 animate-spin text-gray-400"}),i&&!d&&!n&&s.jsx(ce,{type:"button",variant:"ghost",size:"sm",onClick:N,className:"h-6 w-6 p-0 hover:bg-gray-100",children:s.jsx(Yr,{className:"w-3 h-3"})})]})]}),u&&l&&s.jsx("div",{className:"absolute top-full left-0 right-0 z-[9999] mt-2 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",children:l.artists.length>0?s.jsxs("div",{ref:g,className:"max-h-[min(500px,calc(100vh-300px))] overflow-y-auto overscroll-contain synth-scrollbar",style:{scrollBehavior:"smooth"},children:[l.artists.map((k,C)=>s.jsxs("div",{className:Oe("relative px-4 py-3 cursor-pointer transition-all duration-150","flex items-center gap-3","hover:bg-gray-50",m===C&&"bg-blue-50"),onClick:()=>_(k),onMouseEnter:()=>v(C),children:[m===C&&s.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-blue-500 rounded-r"}),s.jsx("div",{className:"flex-shrink-0",children:k.image_url?s.jsx("img",{src:k.image_url,alt:k.name,className:"w-12 h-12 rounded-full object-cover ring-2 ring-gray-100"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-pink-100 to-purple-100 flex items-center justify-center ring-2 ring-gray-100",children:s.jsx(Ft,{className:"w-6 h-6 text-pink-500"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm leading-tight truncate",children:k.name}),k.genres&&k.genres.length>0&&s.jsx("p",{className:"text-xs text-gray-500 mt-0.5 truncate",children:S(k.genres)})]})]},k.id)),l.totalFound>l.artists.length&&s.jsxs("div",{className:"sticky bottom-0 px-4 py-2 text-xs text-gray-500 text-center bg-gray-50 border-t border-gray-200",children:["Showing ",l.artists.length," of ",l.totalFound," artists"]})]}):s.jsxs("div",{className:"px-6 py-12 text-center text-gray-500",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:s.jsx(Ft,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No artists found"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Try a different search term"})]})})]})}class lB{static searchVenues(t,r=20,n=!1){return E(this,null,function*(){if(!t||t.length<2)return[];try{console.log(` Searching for venues: "${t}" (useApi: ${n})`);let a=[];try{a=yield this.getFuzzyMatchedResults(t,r),console.log(` Found ${a.length} venues from local database`)}catch(i){console.warn("  Could not get fuzzy results from database:",i)}if(!n)return console.log(` Returning ${a.length} results from local database (no API call)`),a;console.log(" Explicit search triggered - searching for new venues in database...");try{a=yield this.getFuzzyMatchedResults(t,r),console.log(` Final database results: ${a.length}`)}catch(i){console.warn("  Could not get final results from database:",i)}return a.length>0?a:(console.log(" No venues found in database"),[])}catch(a){return console.error(" Error in venue search:",a),[]}})}static searchJamBaseAPI(t,r){return E(this,null,function*(){return[]})}static getFallbackVenues(t,r){const n=[{id:"madison-square-garden",name:"Madison Square Garden",identifier:"jambase:msg-1",image:"https://picsum.photos/300/300?random=1",address:{streetAddress:"4 Pennsylvania Plaza",addressLocality:"New York",addressRegion:"NY",postalCode:"10001",addressCountry:"US"},geo:{latitude:40.7505,longitude:-73.9934},maximumAttendeeCapacity:20789,num_upcoming_events:25},{id:"hollywood-bowl",name:"Hollywood Bowl",identifier:"jambase:hb-1",image:"https://picsum.photos/300/300?random=2",address:{streetAddress:"2301 N Highland Ave",addressLocality:"Los Angeles",addressRegion:"CA",postalCode:"90068",addressCountry:"US"},geo:{latitude:34.1122,longitude:-118.339},maximumAttendeeCapacity:17500,num_upcoming_events:30},{id:"the-factory",name:"The Factory",identifier:"jambase:factory-1",image:"https://picsum.photos/300/300?random=3",address:{streetAddress:"123 Factory St",addressLocality:"St. Louis",addressRegion:"MO",postalCode:"63101",addressCountry:"US"},geo:{latitude:38.627,longitude:-90.1994},maximumAttendeeCapacity:2500,num_upcoming_events:15},{id:"red-rocks",name:"Red Rocks Amphitheatre",identifier:"jambase:rr-1",image:"https://picsum.photos/300/300?random=4",address:{streetAddress:"18300 W Alameda Pkwy",addressLocality:"Morrison",addressRegion:"CO",postalCode:"80465",addressCountry:"US"},geo:{latitude:39.6654,longitude:-105.2056},maximumAttendeeCapacity:9525,num_upcoming_events:40},{id:"brooklyn-bowl",name:"Brooklyn Bowl",identifier:"jambase:bb-1",image:"https://picsum.photos/300/300?random=5",address:{streetAddress:"61 Wythe Ave",addressLocality:"Brooklyn",addressRegion:"NY",postalCode:"11249",addressCountry:"US"},geo:{latitude:40.7214,longitude:-73.9575},maximumAttendeeCapacity:1200,num_upcoming_events:15},{id:"the-fillmore",name:"The Fillmore",identifier:"jambase:tf-1",image:"https://picsum.photos/300/300?random=6",address:{streetAddress:"1805 Geary Blvd",addressLocality:"San Francisco",addressRegion:"CA",postalCode:"94115",addressCountry:"US"},geo:{latitude:37.7849,longitude:-122.4334},maximumAttendeeCapacity:1250,num_upcoming_events:20},{id:"house-of-blues",name:"House of Blues",identifier:"jambase:hob-1",image:"https://picsum.photos/300/300?random=7",address:{streetAddress:"225 Decatur St",addressLocality:"New Orleans",addressRegion:"LA",postalCode:"70130",addressCountry:"US"},geo:{latitude:29.9584,longitude:-90.0644},maximumAttendeeCapacity:1e3,num_upcoming_events:18},{id:"radio-city-music-hall",name:"Radio City Music Hall",identifier:"jambase:rcmh-1",image:"https://picsum.photos/300/300?random=8",address:{streetAddress:"1260 6th Ave",addressLocality:"New York",addressRegion:"NY",postalCode:"10020",addressCountry:"US"},geo:{latitude:40.76,longitude:-73.9798},maximumAttendeeCapacity:6e3,num_upcoming_events:12},{id:"the-greek-theatre",name:"The Greek Theatre",identifier:"jambase:tgt-1",image:"https://picsum.photos/300/300?random=9",address:{streetAddress:"2700 N Vermont Ave",addressLocality:"Los Angeles",addressRegion:"CA",postalCode:"90027",addressCountry:"US"},geo:{latitude:34.1183,longitude:-118.3003},maximumAttendeeCapacity:5900,num_upcoming_events:22}],a=n.filter(i=>{var o,l,c,d;return i.name.toLowerCase().includes(t.toLowerCase())||((l=(o=i.address)==null?void 0:o.addressLocality)==null?void 0:l.toLowerCase().includes(t.toLowerCase()))||((d=(c=i.address)==null?void 0:c.addressRegion)==null?void 0:d.toLowerCase().includes(t.toLowerCase()))});return a.length===0?n.slice(0,r):a.slice(0,r)}static populateVenueProfiles(t){return E(this,null,function*(){var n,a,i,o,l,c,d,f,u;const r=[];if(!t||t.length===0)return r;for(const h of t)try{const m=((n=h.identifier)==null?void 0:n.split(":")[1])||h.identifier,{data:v,error:g}=yield T.from("venues_with_external_ids").select("*").eq("jambase_venue_id",m).maybeSingle();if(v&&!g){console.log(`  Venue ${h.name} already exists in database`),r.push(V(D({},v),{address:{streetAddress:v.address,addressLocality:v.city,addressRegion:v.state,postalCode:v.zip,addressCountry:v.country},geo:{latitude:v.latitude,longitude:v.longitude}}));continue}if(g&&(g.code==="PGRST116"||g.code==="42P01")){console.warn(`  venues table doesn't exist yet. Skipping database operations for ${h.name}`),r.push({id:h.id,jambase_venue_id:m,name:h.name,address:h.address,geo:h.geo,maximum_attendee_capacity:h.maximumAttendeeCapacity,num_upcoming_events:h["x-numUpcomingEvents"]||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),identifier:h.identifier});continue}if(g){console.warn(`  Database error checking venue ${h.name}:`,g),r.push({id:h.id,jambase_venue_id:m,name:h.name,address:h.address,geo:h.geo,maximum_attendee_capacity:h.maximumAttendeeCapacity,num_upcoming_events:h["x-numUpcomingEvents"]||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),identifier:h.identifier});continue}const x={name:h.name,identifier:h.identifier,address:((a=h.address)==null?void 0:a.streetAddress)||null,city:((i=h.address)==null?void 0:i.addressLocality)||null,state:((o=h.address)==null?void 0:o.addressRegion)||null,zip:((l=h.address)==null?void 0:l.postalCode)||null,country:((c=h.address)==null?void 0:c.addressCountry)||"US",latitude:((d=h.geo)==null?void 0:d.latitude)||null,longitude:((f=h.geo)==null?void 0:f.longitude)||null,image_url:h.image,url:h.url,date_published:new Date().toISOString(),date_modified:new Date().toISOString()},{data:_}=yield T.from("venues_with_external_ids").select("id").eq("jambase_venue_id",h.id).maybeSingle();let w;if(_){const{data:b,error:N}=yield T.from("venues").update(x).eq("id",_.id).select().single();if(N)console.error(` Error updating venue ${h.name}:`,N),w=_;else{w=b;try{yield T.from("external_entity_ids").upsert({entity_type:"venue",entity_uuid:w.id,source:"jambase",external_id:m},{onConflict:"entity_uuid,source,entity_type"}).select()}catch(S){}}}else{const{data:b,error:N}=yield T.from("venues").insert(x).select().single();if(N)console.error(` Error inserting venue ${h.name}:`,N),w=null;else{w=b;try{yield T.from("external_entity_ids").insert({entity_type:"venue",entity_uuid:w.id,source:"jambase",external_id:m}).select()}catch(S){}}}if(!w){console.error(` Failed to save venue ${h.name}`);continue}console.log(` Saved venue ${h.name} to database`),r.push(V(D({},w),{address:{streetAddress:w.address,addressLocality:w.city,addressRegion:w.state,postalCode:w.zip,addressCountry:w.country},geo:{latitude:w.latitude,longitude:w.longitude}}))}catch(m){console.error(` Error processing venue ${h.name}:`,m),r.push({id:h.id,jambase_venue_id:((u=h.identifier)==null?void 0:u.split(":")[1])||h.identifier,name:h.name,address:h.address,geo:h.geo,maximum_attendee_capacity:h.maximumAttendeeCapacity,num_upcoming_events:h["x-numUpcomingEvents"]||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),identifier:h.identifier,last_synced_at:new Date().toISOString()});continue}return r})}static getFuzzyMatchedResults(t,r){return E(this,null,function*(){try{const n=t.trim(),i=n.split(/\s+/).length===1&&n.length>0?`${n}%`:`%${n}%`,{data:o,error:l}=yield T.from("venues").select("*").ilike("name",i).order("num_upcoming_events",{ascending:!1,nullsFirst:!1}).limit(Math.max(r*5,100));return l?(l.code==="PGRST116"||l.code==="42P01"?console.warn("  venues table doesn't exist yet. Returning empty results for fuzzy matching."):console.warn(`  Database error getting venues: ${l.message}`),[]):!o||o.length===0?(console.log(" No venues found in database"),[]):Array.isArray(o)?o.filter(f=>typeof f=="object"&&f!==null&&typeof f.id=="string"&&typeof f.name=="string").map(f=>({id:f.id,name:f.name,identifier:f.identifier||`manual:${f.id}`,image_url:f.image_url||void 0,address:{streetAddress:f.street_address||void 0,addressLocality:void 0,addressRegion:f.state||void 0,postalCode:f.zip||void 0,addressCountry:f.country||void 0},geo:(()=>{if(f.geo)try{if(typeof f.geo=="object"&&f.geo!==null)return{latitude:f.geo.latitude||f.latitude,longitude:f.geo.longitude||f.longitude};if(typeof f.geo=="string"){const u=JSON.parse(f.geo);return{latitude:u.latitude||f.latitude,longitude:u.longitude||f.longitude}}}catch(u){}if(f.latitude&&f.longitude)return{latitude:f.latitude,longitude:f.longitude}})(),maximumAttendeeCapacity:f.maximum_attendee_capacity||void 0,num_upcoming_events:f.num_upcoming_events||0,match_score:this.calculateFuzzyMatchScore(t,f.name),is_from_database:!0})).filter(f=>f.match_score>5).sort((f,u)=>u.match_score!==f.match_score?u.match_score-f.match_score:(u.num_upcoming_events||0)-(f.num_upcoming_events||0)).slice(0,r):(console.warn("  Invalid venue data received from database"),[])}catch(n){return console.error(" Error getting fuzzy matched results:",n),[]}})}static calculateFuzzyMatchScore(t,r){const n=t.toLowerCase().trim(),a=r.toLowerCase().trim();if(a===n)return 100;if(a.startsWith(n))return 95;const i=n.split(/\s+/),o=a.split(/\s+/);let l=0;for(const h of i)o.includes(h)&&l++;if(l>0)return 85+l/i.length*10;if(a.includes(n))return 75;let c=0;for(const h of i)for(const m of o)if(m.includes(h)||h.includes(m)){c++;break}if(c>0)return 60+c/i.length*15;const d=this.levenshteinDistance(n,a),f=Math.max(n.length,a.length),u=1-d/f;return Math.round(u*50)}static levenshteinDistance(t,r){const n=Array(r.length+1).fill(null).map(()=>Array(t.length+1).fill(null));for(let a=0;a<=t.length;a++)n[0][a]=a;for(let a=0;a<=r.length;a++)n[a][0]=a;for(let a=1;a<=r.length;a++)for(let i=1;i<=t.length;i++){const o=t[i-1]===r[a-1]?0:1;n[a][i]=Math.min(n[a][i-1]+1,n[a-1][i]+1,n[a-1][i-1]+o)}return n[r.length][t.length]}static getVenueSuggestions(t,r=10){return E(this,null,function*(){return this.searchVenues(t,r)})}}function cB({onVenueSelect:e,placeholder:t="Search for a venue...",className:r,hideClearButton:n=!1,onSearchStateChange:a}){const[i,o]=y.useState(""),[l,c]=y.useState([]),[d,f]=y.useState(!1),[u,h]=y.useState(!1),[m,v]=y.useState(-1),g=y.useRef(null),x=y.useRef(null);y.useEffect(()=>{if(!i.trim()){c([]),h(!1),a==null||a(!1);return}const C=setTimeout(()=>E(this,null,function*(){yield _(i)}),300);return()=>clearTimeout(C)},[i]),y.useEffect(()=>{const C=A=>{if(!(!u||!l))switch(A.key){case"ArrowDown":A.preventDefault(),v(R=>R<l.length-1?R+1:R);break;case"ArrowUp":A.preventDefault(),v(R=>R>0?R-1:-1);break;case"Enter":A.preventDefault(),m>=0&&m<l.length&&w(l[m]);break;case"Escape":h(!1),v(-1);break}};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[u,l,m]),y.useEffect(()=>{if(m>=0&&g.current){const C=g.current.children[m];C&&C.scrollIntoView({block:"nearest"})}},[m]);const _=C=>E(this,null,function*(){try{f(!0);const A=yield lB.searchVenues(C,10);c(A),h(!0),v(-1),a==null||a(!0)}catch(A){console.error("Venue search error:",A),c([]),h(!0)}finally{f(!1)}}),w=C=>{var R,I;try{const O=C.id||null;Zt.click("venue",O||C.identifier||C.name,{source:"venue_search_box",name:C.name,city:(R=C.address)==null?void 0:R.addressLocality,state:(I=C.address)==null?void 0:I.addressRegion},O||void 0)}catch(O){}e(C),o(C.name),h(!1),v(-1),a==null||a(!1);const A=document.getElementById("venue-search-input");A==null||A.blur()};y.useEffect(()=>{const C=A=>{const R=A.target,I=x.current;I&&!I.contains(R)&&(h(!1),v(-1),a==null||a(!1))};if(u){const A=setTimeout(()=>{document.addEventListener("mousedown",C)},100);return()=>{clearTimeout(A),document.removeEventListener("mousedown",C)}}},[u]);const b=()=>{l&&l.length>0&&h(!0)},N=C=>{var R;const A=C.relatedTarget;A&&((R=g.current)!=null&&R.contains(A))||setTimeout(()=>{h(!1),v(-1),a==null||a(!1)},100)},S=()=>{o(""),c([]),h(!1),v(-1),a==null||a(!1);const C=document.getElementById("venue-search-input");C==null||C.focus()},k=C=>{var R,I;const A=[];return(R=C.address)!=null&&R.addressLocality&&A.push(C.address.addressLocality),(I=C.address)!=null&&I.addressRegion&&A.push(C.address.addressRegion),A.join(", ")};return s.jsxs("div",{ref:x,className:Oe("relative w-full",r),children:[s.jsxs("div",{className:"relative",children:[s.jsx(Ai,{value:i,onChange:C=>o(C),placeholder:t,widthVariant:"full",id:"venue-search-input",name:"venueSearch",onFocus:b,onBlur:N}),s.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[d&&s.jsx(fr,{className:"w-4 h-4 animate-spin text-gray-400"}),i&&!d&&!n&&s.jsx(ce,{type:"button",variant:"ghost",size:"sm",onClick:S,className:"h-6 w-6 p-0 hover:bg-gray-100",children:s.jsx(Yr,{className:"w-3 h-3"})})]})]}),u&&l&&s.jsx("div",{className:"absolute top-full left-0 right-0 z-[9999] mt-2 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",children:l.length>0?s.jsx("div",{ref:g,className:"max-h-[min(500px,calc(100vh-300px))] overflow-y-auto overscroll-contain synth-scrollbar",style:{scrollBehavior:"smooth"},children:l.map((C,A)=>s.jsxs("div",{className:Oe("relative px-4 py-3 cursor-pointer transition-all duration-150","flex items-center gap-3","hover:bg-gray-50",m===A&&"bg-blue-50"),onClick:R=>{R.preventDefault(),R.stopPropagation(),w(C)},onMouseDown:R=>{R.preventDefault(),R.stopPropagation()},onMouseEnter:()=>v(A),children:[m===A&&s.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-blue-500 rounded-r"}),s.jsx("div",{className:"flex-shrink-0",children:C.image_url?s.jsx("img",{src:C.image_url,alt:C.name,className:"w-12 h-12 rounded-full object-cover ring-2 ring-gray-100"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-100 to-indigo-100 flex items-center justify-center ring-2 ring-gray-100",children:s.jsx(yr,{className:"w-6 h-6 text-blue-500"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm leading-tight truncate",children:C.name}),k(C)&&s.jsx("p",{className:"text-xs text-gray-500 mt-0.5 truncate",children:k(C)})]})]},C.id))}):s.jsxs("div",{className:"px-6 py-12 text-center text-gray-500",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:s.jsx(yr,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No venues found"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Try a different search term"})]})})]})}const jT=e=>{const t=new Date(e),r=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),a=new Date(r.getFullYear(),r.getMonth(),r.getDate());return n>=a?"upcoming":"past"},YM=e=>jT(e)==="past",dB=(e,t)=>e.filter(r=>jT(r.event_date)===t),Ide=e=>dB(e,"upcoming"),$de=e=>dB(e,"past");function eS({formData:e,errors:t,onUpdateFormData:r,onClose:n}){const[a,i]=te.useState(""),[o,l]=te.useState([]),[c,d]=te.useState(!1),[f,u]=te.useState(!1);te.useEffect(()=>{const N=setTimeout(()=>E(this,null,function*(){const S=a.trim();if(S.length<2){l([]);return}try{d(!0);const{data:k,error:C}=yield T.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date, artist_id, venue_id").or(`artist_name_normalized.ilike.%${S}%,title.ilike.%${S}%,venue_name_normalized.ilike.%${S}%`).order("event_date",{ascending:!1}).limit(50);if(!C&&k){const R=k.filter(I=>YM(I.event_date)).sort((I,O)=>new Date(O.event_date).getTime()-new Date(I.event_date).getTime());l(R),u(!0)}else l([]),u(!1)}finally{d(!1)}}),300);return()=>clearTimeout(N)},[a]);const h=N=>E(this,null,function*(){const S=N!=null&&N.event_date?String(N.event_date).split("T")[0]:"",k=(N==null?void 0:N.artist_name_normalized)||(N==null?void 0:N.artist_name),C=k?{id:N.artist_id||`manual-${k}`,name:k,is_from_database:!!N.artist_id}:null;let A=null;const R=(N==null?void 0:N.venue_name_normalized)||(N==null?void 0:N.venue_name);if(R)try{if(N.venue_id){const{data:O}=yield T.from("venues").select("id, name, identifier").eq("id",N.venue_id).single();O&&(A={id:O.id,name:O.name,identifier:O.identifier,is_from_database:!0})}A||(A={id:N.venue_id||`manual-${R}`,name:R,is_from_database:!!N.venue_id})}catch(O){console.error("Error looking up venue:",O);const z=(N==null?void 0:N.venue_name_normalized)||(N==null?void 0:N.venue_name)||"Unknown Venue";A={id:N.venue_id||`manual-${z}`,name:z,is_from_database:!1}}const I={reviewType:"event"};C&&(I.selectedArtist=C),A&&(I.selectedVenue=A),S&&(I.eventDate=S),r(I),u(!1),C&&_(!0),A&&b(!0)}),m=N=>{console.log(" Artist selected in EventDetailsStep:",{name:N.name,id:N.id}),r({selectedArtist:N}),_(!0)},v=N=>{console.log(" Venue selected in EventDetailsStep:",{name:N.name,id:N.id,is_from_database:N.is_from_database,identifier:N.identifier}),console.log(" Before update - formData.selectedVenue:",e.selectedVenue),console.log(" Before update - venueLocked:",w),r({selectedVenue:N}),console.log(" After update - setting venueLocked to true"),b(!0)},g=N=>{r({eventDate:N.target.value})},[x,_]=te.useState(!!e.selectedArtist),[w,b]=te.useState(!!e.selectedVenue);return console.log(" EventDetailsStep: Debug:",{hasSelectedArtist:!!e.selectedArtist,artistLocked:x,shouldShowButton:!e.selectedArtist||!x,hasSetlist:!!e.selectedSetlist}),te.useEffect(()=>{e.selectedArtist?_(!0):_(!1)},[e.selectedArtist]),te.useEffect(()=>{e.selectedVenue?b(!0):b(!1)},[e.selectedVenue]),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(qt,{className:"text-sm font-medium",children:"Quick search existing event (optional)"}),n&&s.jsx(ce,{variant:"ghost",size:"sm",onClick:n,className:"h-8 w-8 p-0","aria-label":"Close",children:s.jsx(Yr,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Nr,{placeholder:"Search by artist, event title, or venue...","aria-label":"Quick search existing event",value:a,onChange:N=>i(N.target.value),onFocus:()=>{o.length>0&&u(!0)}}),f&&(o.length>0||c)&&s.jsxs("div",{className:"absolute z-20 mt-1 w-full max-h-64 overflow-auto rounded-md border bg-white shadow",children:[c&&s.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"Searching"}),!c&&o.map(N=>(jT(N.event_date),YM(N.event_date),s.jsxs("button",{type:"button",className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50 border-l-4 border-l-green-500 bg-green-50/30",onClick:()=>h(N),children:[s.jsx("div",{className:"font-medium text-gray-900",children:N.title||`${N.artist_name_normalized||N.artist_name||"Artist"} @ ${N.venue_name_normalized||N.venue_name||"Venue"}`}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center justify-between",children:[s.jsxs("span",{children:[N.artist_name_normalized||N.artist_name||"Artist","  ",N.venue_name_normalized||N.venue_name||"Venue","  ",new Date(N.event_date).toLocaleDateString()]}),s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Past Event"})]})]},N.id))),!c&&o.length===0&&s.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No past events found"})]})]})]}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Event Details"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Tell us about the concert you attended"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-start",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"artist",className:"text-sm font-medium",children:"Artist or Band *"}),!e.selectedArtist||!x?s.jsx(b1,{onArtistSelect:m,placeholder:"Search for an artist or band...",className:"w-full",hideClearButton:!!e.selectedArtist}):s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200",children:[s.jsx("div",{children:s.jsx("p",{className:"text-sm font-medium text-green-800",children:e.selectedArtist.name})}),s.jsx("button",{className:"text-xs text-red-600",onClick:()=>{r({selectedArtist:null}),_(!1)},children:""})]})}),t.selectedArtist&&s.jsx("p",{className:"text-sm text-red-600",children:t.selectedArtist})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"venue",className:"text-sm font-medium",children:"Venue *"}),(()=>{var N;return console.log(" Venue render check:",{hasSelectedVenue:!!e.selectedVenue,venueLocked:w,selectedVenueName:(N=e.selectedVenue)==null?void 0:N.name,shouldShowSearch:!e.selectedVenue||!w}),null})(),!e.selectedVenue||!w?s.jsx(cB,{onVenueSelect:v,placeholder:"Search for a venue...",className:"w-full",hideClearButton:!!e.selectedVenue}):s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-green-800",children:e.selectedVenue.name}),e.selectedVenue.address&&s.jsx("p",{className:"text-xs text-green-700",children:[e.selectedVenue.address.addressLocality,e.selectedVenue.address.addressRegion].filter(Boolean).join(", ")})]}),s.jsx("button",{className:"text-xs text-red-600",onClick:()=>{r({selectedVenue:null}),b(!1)},children:""})]}),t.selectedVenue&&s.jsx("p",{className:"text-sm text-red-600",children:t.selectedVenue})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(qt,{htmlFor:"eventDate",className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(Lt,{className:"w-4 h-4"}),"Date *"]}),s.jsx(Nr,{id:"eventDate",type:"date",value:e.eventDate,onChange:g,className:"w-full",max:new Date().toISOString().split("T")[0]}),t.eventDate&&s.jsx("p",{className:"text-sm text-red-600",children:t.eventDate})]})]}),e.selectedArtist&&e.selectedVenue&&e.eventDate&&s.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[s.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Event Summary"}),s.jsxs("div",{className:"text-sm text-blue-800",children:[s.jsx("p",{children:s.jsx("button",{className:"font-bold hover:text-blue-600 hover:underline cursor-pointer",onClick:N=>{var k,C;N.preventDefault(),N.stopPropagation();const S=new CustomEvent("open-artist-card",{detail:{artistId:(k=e.selectedArtist)==null?void 0:k.id,artistName:(C=e.selectedArtist)==null?void 0:C.name}});document.dispatchEvent(S)},"aria-label":`View artist ${e.selectedArtist.name}`,children:e.selectedArtist.name})}),s.jsxs("p",{children:["at"," ",s.jsx("button",{className:"font-bold hover:text-blue-600 hover:underline cursor-pointer",onClick:N=>{var k,C;N.preventDefault(),N.stopPropagation();const S=new CustomEvent("open-venue-card",{detail:{venueId:(k=e.selectedVenue)==null?void 0:k.id,venueName:(C=e.selectedVenue)==null?void 0:C.name}});document.dispatchEvent(S)},"aria-label":`View venue ${e.selectedVenue.name}`,children:e.selectedVenue.name})]}),s.jsxs("p",{children:["on ",new Date(e.eventDate+"T12:00:00").toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})]})]})]})]})}const _s=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx("textarea",D({className:Oe("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r},t))});_s.displayName="Textarea";function mu({config:e,formData:t,errors:r,onUpdateFormData:n,children:a,previousVenueReview:i}){var _;const[o,l]=y.useState(null),c=t[e.ratingKey],d=t[e.feedbackKey],f=(_=o!=null?o:c)!=null?_:0,u=i&&(e.ratingKey==="venueRating"||e.ratingKey==="locationRating"),h=()=>{if(!i||!u)return;const w={};if(e.ratingKey==="venueRating"){const b=i.venue_rating;if(b){const N=typeof b=="number"?b:parseFloat(String(b));!isNaN(N)&&N>0&&(w.venueRating=N)}i.venue_feedback&&(w.venueFeedback=i.venue_feedback)}else if(e.ratingKey==="locationRating"){const b=i.location_rating;if(b){const N=typeof b=="number"?b:parseFloat(String(b));!isNaN(N)&&N>0&&(w.locationRating=N)}i.location_feedback&&(w.locationFeedback=i.location_feedback)}n(w)},m=y.useMemo(()=>f?`${f.toFixed(1)} / 5.0`:"Not rated yet",[f]),v=w=>{n({[e.ratingKey]:w})},g=w=>{const b={};if(!d||d.trim().length===0)b[e.feedbackKey]=w.description||w.label;else{const N=d.trim(),S=w.description||w.label;b[e.feedbackKey]=N+(N?" ":"")+S}n(b)},x=w=>d&&(d.includes(w.label)||d.includes(w.description||""));return s.jsxs("div",{className:"space-y-6 w-full max-w-full overflow-x-hidden",children:[s.jsxs("header",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Step"}),s.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-900 break-words",children:e.title}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 max-w-full mx-auto break-words",children:e.subtitle})]}),s.jsx("section",{className:"bg-gradient-to-br from-pink-50 via-rose-50 to-fuchsia-50 border border-pink-200/60 rounded-2xl p-4 sm:p-6 shadow-sm text-center space-y-4 w-full max-w-full overflow-x-hidden",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-pink-600 font-semibold",children:"Your rating"}),s.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4 flex-wrap",children:[s.jsx("div",{className:"flex items-center flex-shrink-0",onMouseLeave:()=>l(null),children:Array.from({length:5},(w,b)=>{const N=b+1,S=N,k=N-.5,C=f>=S,A=!C&&f===k;return s.jsxs("div",{className:"relative w-8 h-8 sm:w-10 sm:h-10 cursor-pointer flex-shrink-0",children:[s.jsx(Xt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-300"}),(C||A)&&s.jsx("div",{className:Oe("absolute left-0 top-0 h-full overflow-hidden pointer-events-none",C?"w-full":"w-1/2"),children:s.jsx(Xt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-pink-500 fill-current"})}),s.jsx("button",{type:"button","aria-label":`Set ${e.title} rating to ${k.toFixed(1)} stars`,className:"absolute left-0 top-0 h-full w-1/2",onMouseEnter:()=>l(k),onFocus:()=>l(k),onBlur:()=>l(null),onClick:()=>v(k)}),s.jsx("button",{type:"button","aria-label":`Set ${e.title} rating to ${S.toFixed(1)} stars`,className:"absolute right-0 top-0 h-full w-1/2",onMouseEnter:()=>l(S),onFocus:()=>l(S),onBlur:()=>l(null),onClick:()=>v(S)})]},b)})}),s.jsx("span",{className:"text-2xl sm:text-3xl font-extrabold text-gray-900 break-words",children:m})]}),e.helperText&&s.jsx("p",{className:"text-xs text-pink-500 break-words",children:e.helperText}),r[e.ratingKey]&&s.jsx("p",{className:"text-xs sm:text-sm text-red-600 break-words",children:r[e.ratingKey]})]})}),u&&s.jsx("section",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4 w-full max-w-full overflow-x-hidden",children:s.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-xs sm:text-sm font-medium text-blue-900 break-words",children:"Copy from previous review at this venue?"}),s.jsx("p",{className:"text-xs text-blue-700 mt-1 break-words",children:"You've reviewed this venue before. Copy your venue and location ratings and feedback."})]}),s.jsxs(ce,{type:"button",variant:"outline",size:"sm",onClick:h,className:"sm:ml-4 border-blue-300 text-blue-700 hover:bg-blue-100 flex-shrink-0",children:[s.jsx(UQ,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),"Copy"]})]})}),s.jsxs("section",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[s.jsx(qt,{htmlFor:`${e.ratingKey}-feedback`,className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:"Add a quick note (optional)"}),s.jsx(_s,{id:`${e.ratingKey}-feedback`,placeholder:"Share any highlights or watch-outs for future fans...",value:d,onChange:w=>n({[e.feedbackKey]:w.target.value}),rows:4,className:"resize-none text-sm sm:text-base w-full max-w-full min-w-0",maxLength:400}),s.jsxs("p",{className:"text-xs text-gray-400 text-right",children:[(d||"").length,"/400"]})]}),s.jsxs("section",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Need inspiration? Tap a vibe:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:e.suggestions.map(w=>s.jsx(ce,{type:"button",variant:x(w)?"default":"outline",className:Oe("px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm rounded-full border flex-shrink-0",w.sentiment==="positive"?"border-emerald-200 text-emerald-700 hover:bg-emerald-50":"border-rose-200 text-rose-700 hover:bg-rose-50",x(w)&&"bg-pink-500 text-white hover:bg-pink-600 border-transparent"),onClick:()=>g(w),children:w.label},w.id))})]}),a&&s.jsx("section",{className:"space-y-4 w-full max-w-full overflow-x-hidden",children:a})]})}class Lde{constructor(){Pr(this,"DEFAULT_OPTIONS",{maxSizeMB:5,allowedTypes:["image/jpeg","image/jpg","image/png","image/webp","image/heic"],compressionQuality:.8})}uploadPhoto(i,o,l){return E(this,arguments,function*(t,r,n,a={}){var _,w,b;const c=D(D({},this.DEFAULT_OPTIONS),a);if(!((_=c.allowedTypes)!=null&&_.includes(t.type)))throw new Error(`Invalid file type. Allowed types: ${(w=c.allowedTypes)==null?void 0:w.join(", ")}`);const d=(c.maxSizeMB||5)*1024*1024;if(t.size>d)throw new Error(`File size exceeds ${c.maxSizeMB}MB limit. Current size: ${(t.size/1024/1024).toFixed(2)}MB`);const f=yield this.processImage(t,c),u=((b=t.name.split(".").pop())==null?void 0:b.toLowerCase())||"jpg",h=`${Date.now()}-${Math.random().toString(36).substring(7)}.${u}`,m=`${n}/${h}`,{data:v,error:g}=yield T.storage.from(r).upload(m,f,{cacheControl:"3600",upsert:!1});if(g)throw console.error("Upload error:",g),new Error(`Failed to upload photo: ${g.message}`);const{data:{publicUrl:x}}=T.storage.from(r).getPublicUrl(v.path);return{url:x,path:v.path}})}uploadPhotos(i,o,l){return E(this,arguments,function*(t,r,n,a={}){const c=t.map(d=>this.uploadPhoto(d,r,n,a));return Promise.all(c)})}deletePhoto(t,r){return E(this,null,function*(){const{error:n}=yield T.storage.from(t).remove([r]);if(n)throw console.error("Delete error:",n),new Error(`Failed to delete photo: ${n.message}`)})}deletePhotos(t,r){return E(this,null,function*(){const{error:n}=yield T.storage.from(t).remove(r);if(n)throw console.error("Delete error:",n),new Error(`Failed to delete photos: ${n.message}`)})}getPathFromUrl(t,r){try{return new URL(t).pathname.split(`/storage/v1/object/public/${r}/`)[1]||null}catch(n){return null}}processImage(t,r){return E(this,null,function*(){return t.size<5e5||r.compressionQuality===1?t:new Promise((n,a)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var c;const l=new Image;l.src=(c=o.target)==null?void 0:c.result,l.onload=()=>{const d=document.createElement("canvas");let f=l.width,u=l.height;const h=1920;(f>h||u>h)&&(f>u?(u=u/f*h,f=h):(f=f/u*h,u=h)),d.width=f,d.height=u;const m=d.getContext("2d");m==null||m.drawImage(l,0,0,f,u),d.toBlob(v=>{v?n(v):a(new Error("Failed to compress image"))},t.type,r.compressionQuality||.8)},l.onerror=()=>a(new Error("Failed to load image"))},i.onerror=()=>a(new Error("Failed to read file"))})})}validateImage(t,r={}){var i,o;const n=D(D({},this.DEFAULT_OPTIONS),r);if(!((i=n.allowedTypes)!=null&&i.includes(t.type)))return{valid:!1,error:`Invalid file type. Please use: ${(o=n.allowedTypes)==null?void 0:o.join(", ")}`};const a=(n.maxSizeMB||5)*1024*1024;return t.size>a?{valid:!1,error:`File too large. Maximum size: ${n.maxSizeMB}MB`}:{valid:!0}}uploadVideo(i,o,l){return E(this,arguments,function*(t,r,n,a={}){var x,_,w;const c=D({maxSizeMB:100,allowedTypes:["video/mp4","video/webm","video/quicktime","video/x-msvideo","video/3gpp","video/x-flv"]},a);if(!((x=c.allowedTypes)!=null&&x.includes(t.type)))throw new Error(`Invalid file type. Allowed types: ${(_=c.allowedTypes)==null?void 0:_.join(", ")}`);const d=(c.maxSizeMB||100)*1024*1024;if(t.size>d)throw new Error(`File size exceeds ${c.maxSizeMB}MB limit. Current size: ${(t.size/1024/1024).toFixed(2)}MB`);const f=((w=t.name.split(".").pop())==null?void 0:w.toLowerCase())||"mp4",u=`${Date.now()}-${Math.random().toString(36).substring(7)}.${f}`,h=`${n}/${u}`,{data:m,error:v}=yield T.storage.from(r).upload(h,t,{cacheControl:"3600",upsert:!1});if(v)throw console.error("Upload error:",v),new Error(`Failed to upload video: ${v.message}`);const{data:{publicUrl:g}}=T.storage.from(r).getPublicUrl(m.path);return{url:g,path:m.path}})}uploadVideos(i,o,l){return E(this,arguments,function*(t,r,n,a={}){const c=t.map(d=>this.uploadVideo(d,r,n,a));return Promise.all(c)})}deleteVideo(t,r){return E(this,null,function*(){const{error:n}=yield T.storage.from(t).remove([r]);if(n)throw console.error("Delete error:",n),new Error(`Failed to delete video: ${n.message}`)})}deleteVideos(t,r){return E(this,null,function*(){const{error:n}=yield T.storage.from(t).remove(r);if(n)throw console.error("Delete error:",n),new Error(`Failed to delete videos: ${n.message}`)})}validateVideo(t,r={}){var i,o;const n=D({maxSizeMB:100,allowedTypes:["video/mp4","video/webm","video/quicktime","video/x-msvideo","video/3gpp","video/x-flv"]},r);if(!((i=n.allowedTypes)!=null&&i.includes(t.type)))return{valid:!1,error:`Invalid file type. Please use: ${(o=n.allowedTypes)==null?void 0:o.join(", ")}`};const a=(n.maxSizeMB||100)*1024*1024;return t.size>a?{valid:!1,error:`File too large. Maximum size: ${n.maxSizeMB}MB`}:{valid:!0}}}const ci=new Lde;function Fde({value:e=[],onChange:t,userId:r,bucket:n,maxPhotos:a=5,maxSizeMB:i=5,label:o="Photos",helperText:l,className:c,disabled:d=!1}){const[f,u]=y.useState(!1),[h,m]=y.useState(0),v=y.useRef(null),{toast:g}=Er(),x=b=>E(this,null,function*(){const N=Array.from(b.target.files||[]);if(N.length!==0){if(e.length+N.length>a){g({title:"Too many photos",description:`You can only upload up to ${a} photos`,variant:"destructive"});return}for(const S of N){const k=ci.validateImage(S,{maxSizeMB:i});if(!k.valid){g({title:"Invalid file",description:k.error,variant:"destructive"});return}}u(!0),m(0);try{const S=[];for(let k=0;k<N.length;k++){const C=yield ci.uploadPhoto(N[k],n,r,{maxSizeMB:i});S.push(C.url),m((k+1)/N.length*100)}t([...e,...S]),g({title:"Upload successful",description:`${N.length} photo${N.length>1?"s":""} uploaded`})}catch(S){console.error("Upload error:",S),g({title:"Upload failed",description:S instanceof Error?S.message:"Failed to upload photos",variant:"destructive"})}finally{u(!1),m(0),v.current&&(v.current.value="")}}}),_=(b,N)=>E(this,null,function*(){try{const S=ci.getPathFromUrl(b,n);S&&(yield ci.deletePhoto(n,S));const k=e.filter((C,A)=>A!==N);t(k),g({title:"Photo removed",description:"Photo deleted successfully"})}catch(S){console.error("Delete error:",S),g({title:"Delete failed",description:"Failed to delete photo",variant:"destructive"})}}),w=()=>{var b;(b=v.current)==null||b.click()};return s.jsxs("div",{className:Oe("space-y-3",c),children:[o&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium",children:o}),l&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.map((b,N)=>s.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100 group",children:[s.jsx("img",{src:b,alt:`Photo ${N+1}`,className:"w-full h-full object-cover"}),s.jsx("button",{type:"button",onClick:()=>_(b,N),disabled:d||f,className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",children:s.jsx(Yr,{className:"w-4 h-4"})})]},b)),e.length<a&&s.jsx("button",{type:"button",onClick:w,disabled:d||f,className:Oe("aspect-square rounded-lg border-2 border-dashed border-gray-300 hover:border-gray-400","flex flex-col items-center justify-center gap-2 transition-colors","disabled:opacity-50 disabled:cursor-not-allowed",f&&"border-primary"),children:f?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-6 h-6 animate-spin text-primary"}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[h.toFixed(0),"%"]})]}):s.jsxs(s.Fragment,{children:[s.jsx(Av,{className:"w-6 h-6 text-gray-400"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"Add Photo"})]})})]}),s.jsx("input",{ref:v,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,image/heic",multiple:!0,onChange:x,className:"hidden",disabled:d||f}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.length," / ",a," photos  Max ",i,"MB per photo"]})]})}function zde({value:e,onChange:t,userId:r,bucket:n,maxSizeMB:a=25,label:i="Photo",helperText:o,className:l,disabled:c=!1,aspectRatio:d="square"}){const[f,u]=y.useState(!1),[h,m]=y.useState(!1),v=y.useRef(null),g=y.useRef(null),{toast:x}=Er(),_=()=>{var k;(k=v.current)==null||k.click()},w=()=>{var k;(k=g.current)==null||k.click()},b=k=>E(this,null,function*(){var R;const C=(R=k.target.files)==null?void 0:R[0];if(!C)return;m(!1);const A=ci.validateImage(C,{maxSizeMB:a});if(!A.valid){x({title:"Invalid file",description:A.error,variant:"destructive"});return}u(!0);try{if(e){const O=ci.getPathFromUrl(e,n);O&&(yield ci.deletePhoto(n,O).catch(console.error))}const I=yield ci.uploadPhoto(C,n,r,{maxSizeMB:a});t(I.url),x({title:"Upload successful",description:"Photo uploaded successfully"})}catch(I){console.error("Upload error:",I),x({title:"Upload failed",description:I instanceof Error?I.message:"Failed to upload photo",variant:"destructive"})}finally{u(!1),g.current&&(g.current.value=""),v.current&&(v.current.value="")}}),N=()=>E(this,null,function*(){if(e)try{const k=ci.getPathFromUrl(e,n);k&&(yield ci.deletePhoto(n,k)),t(null),x({title:"Photo removed",description:"Photo deleted successfully"})}catch(k){console.error("Delete error:",k),x({title:"Delete failed",description:"Failed to delete photo",variant:"destructive"})}}),S=()=>{var k;(k=g.current)==null||k.click()};return s.jsxs("div",{className:Oe("space-y-3",l),children:[i&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium",children:i}),o&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:o})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:Oe("relative w-24 h-24 bg-gray-100 overflow-hidden group",d==="circle"?"rounded-full":"rounded-lg"),children:e?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:e,alt:"Upload",className:"w-full h-full object-cover"}),s.jsx("button",{type:"button",onClick:N,disabled:c||f,className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",children:s.jsx(Yr,{className:"w-6 h-6 text-white"})})]}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(G_,{className:"w-8 h-8 text-gray-400"})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx(ce,{type:"button",variant:"outline",onClick:S,disabled:c||f,className:"w-full",children:f?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Av,{className:"w-4 h-4 mr-2"}),e?"Change Photo":"Upload Photo"]})}),o&&s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:o})]})]}),s.jsx("input",{ref:v,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,image/heic",onChange:b,className:"hidden",disabled:c||f,capture:"environment"}),s.jsx("input",{ref:g,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,image/heic",onChange:b,className:"hidden",disabled:c||f}),h&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4 text-center",children:"Choose Photo Source"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(ce,{onClick:_,className:"w-full flex items-center justify-center gap-3 py-3",variant:"outline",disabled:c||f,children:[s.jsx(Av,{className:"w-5 h-5"}),"Take Photo"]}),s.jsxs(ce,{onClick:w,className:"w-full flex items-center justify-center gap-3 py-3",variant:"outline",disabled:c||f,children:[s.jsx(G_,{className:"w-5 h-5"}),"Choose from Gallery"]})]}),s.jsx(ce,{onClick:()=>m(!1),variant:"ghost",className:"w-full mt-4",children:"Cancel"})]})})]})}function Bde({value:e=[],onChange:t,userId:r,bucket:n,maxVideos:a=3,maxSizeMB:i=100,label:o="Videos",helperText:l,className:c,disabled:d=!1}){const[f,u]=y.useState(!1),[h,m]=y.useState(0),v=y.useRef(null),{toast:g}=Er(),x=b=>E(this,null,function*(){const N=Array.from(b.target.files||[]);if(N.length!==0){if(e.length+N.length>a){g({title:"Too many videos",description:`You can only upload up to ${a} videos`,variant:"destructive"});return}for(const S of N){const k=ci.validateVideo(S,{maxSizeMB:i});if(!k.valid){g({title:"Invalid file",description:k.error,variant:"destructive"});return}}u(!0),m(0);try{const S=[];for(let k=0;k<N.length;k++){const C=yield ci.uploadVideo(N[k],n,r,{maxSizeMB:i});S.push(C.url),m((k+1)/N.length*100)}t([...e,...S]),g({title:"Upload successful",description:`${N.length} video${N.length>1?"s":""} uploaded`})}catch(S){console.error("Upload error:",S),g({title:"Upload failed",description:S instanceof Error?S.message:"Failed to upload videos",variant:"destructive"})}finally{u(!1),m(0),v.current&&(v.current.value="")}}}),_=(b,N)=>E(this,null,function*(){try{const S=ci.getPathFromUrl(b,n);S&&(yield ci.deleteVideo(n,S));const k=e.filter((C,A)=>A!==N);t(k),g({title:"Video removed",description:"Video deleted successfully"})}catch(S){console.error("Delete error:",S),g({title:"Delete failed",description:"Failed to delete video",variant:"destructive"})}}),w=()=>{var b;(b=v.current)==null||b.click()};return s.jsxs("div",{className:Oe("space-y-3",c),children:[o&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium",children:o}),l&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.map((b,N)=>s.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100 group",children:[s.jsx("video",{src:b,className:"w-full h-full object-cover",muted:!0,playsInline:!0}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:s.jsx("div",{className:"bg-black/50 rounded-full p-2",children:s.jsx(cee,{className:"w-6 h-6 text-white",fill:"white"})})}),s.jsx("button",{type:"button",onClick:()=>_(b,N),disabled:d||f,className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",children:s.jsx(Yr,{className:"w-4 h-4"})})]},b)),e.length<a&&s.jsx("button",{type:"button",onClick:w,disabled:d||f,className:Oe("aspect-square rounded-lg border-2 border-dashed border-gray-300 hover:border-gray-400","flex flex-col items-center justify-center gap-2 transition-colors","disabled:opacity-50 disabled:cursor-not-allowed",f&&"border-primary"),children:f?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-6 h-6 animate-spin text-primary"}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[h.toFixed(0),"%"]})]}):s.jsxs(s.Fragment,{children:[s.jsx(iz,{className:"w-6 h-6 text-gray-400"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"Add Video"})]})})]}),s.jsx("input",{ref:v,type:"file",accept:"video/mp4,video/webm,video/quicktime,video/x-msvideo,video/3gpp,video/x-flv",multiple:!0,onChange:x,className:"hidden",disabled:d||f}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.length," / ",a," videos  Max ",i,"MB per video"]})]})}function Ude({value:e,onChange:t,userId:r,metOnSynth:n,onMetOnSynthChange:a}){const[i,o]=y.useState(""),[l,c]=y.useState([]),[d,f]=y.useState(!1),[u,h]=y.useState(""),[m,v]=y.useState(""),g=y.useRef(null);y.useEffect(()=>{if(!i.trim()){c([]);return}const b=setTimeout(()=>E(this,null,function*(){f(!0);try{const{data:N,error:S}=yield T.from("users").select("user_id, name, avatar_url").ilike("name",`%${i}%`).neq("user_id",r).order("name",{ascending:!0}).limit(10);S?(console.error("Error searching users:",S),c([])):c(N||[])}catch(N){console.error("Error searching users:",N),c([])}finally{f(!1)}}),300);return()=>clearTimeout(b)},[i,r]),y.useEffect(()=>{const b=N=>{g.current&&!g.current.contains(N.target)&&o("")};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]);const x=b=>{const N={type:"user",user_id:b.user_id,name:b.name,avatar_url:b.avatar_url};e.some(k=>k.type==="user"&&k.user_id===b.user_id)||t([...e,N]),o("")},_=b=>{t(e.filter((N,S)=>S!==b))},w=()=>{if(!u.trim())return;const b={type:"phone",phone:u,name:m.trim()||void 0};e.some(S=>S.type==="phone"&&S.phone===u)||t([...e,b]),h(""),v("")};return s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"relative",ref:g,children:s.jsx(Ai,{value:i,onChange:b=>o(b),placeholder:"Search Synth users or invite by phone...",widthVariant:"full"})}),i&&s.jsx("div",{className:"w-full bg-white border-2 border-pink-200 rounded-lg shadow-2xl max-h-[500px] overflow-y-auto",children:d?s.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Searching..."}):l.length>0?s.jsxs(s.Fragment,{children:[l.map(b=>{const N=e.some(S=>S.type==="user"&&S.user_id===b.user_id);return s.jsxs("button",{onClick:()=>x(b),disabled:N,className:"w-full flex items-center gap-3 p-3 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsxs(Wr,{className:"h-10 w-10",children:[s.jsx(Qr,{src:b.avatar_url,alt:b.name}),s.jsx(Hr,{children:b.name.charAt(0)})]}),s.jsx("div",{className:"flex-1 text-left",children:s.jsx("p",{className:"text-sm font-medium text-gray-900",children:b.name})}),N&&s.jsx("span",{className:"text-xs text-green-600",children:"Added"})]},b.user_id)}),s.jsxs("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[s.jsx(qt,{className:"text-xs font-semibold text-gray-700 mb-2 block",children:"Add by Phone"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Input,{type:"tel",placeholder:"Phone: +1234567890",value:u,onChange:b=>h(b.target.value),className:"text-sm"}),s.jsx(Input,{type:"text",placeholder:"Name (optional)",value:m,onChange:b=>v(b.target.value),className:"text-sm"}),s.jsx(ce,{size:"sm",onClick:w,disabled:!u.trim(),className:"w-full text-sm",children:"Add Contact"})]})]})]}):s.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"No users found. Use the phone option below to add them."})}),e.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:e.map((b,N)=>s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 rounded-full",children:[b.type==="user"?s.jsxs(s.Fragment,{children:[s.jsxs(Wr,{className:"h-6 w-6",children:[s.jsx(Qr,{src:b.avatar_url,alt:b.name}),s.jsx(Hr,{children:b.name.charAt(0)})]}),s.jsx("span",{className:"text-sm text-gray-900",children:b.name})]}):s.jsxs(s.Fragment,{children:[s.jsx(lee,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{className:"text-sm text-gray-900",children:b.name||b.phone})]}),s.jsx("button",{onClick:()=>_(N),className:"ml-1 text-gray-400 hover:text-gray-600",children:s.jsx(Yr,{className:"h-4 w-4"})})]},N))}),e.length>0&&e.some(b=>b.type==="user")&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",id:"metOnSynth",checked:n,onChange:b=>a(b.target.checked),className:"h-4 w-4 rounded border-gray-300 text-pink-600 focus:ring-pink-500"}),s.jsx(qt,{htmlFor:"metOnSynth",className:"text-sm text-gray-700 cursor-pointer",children:"Did you meet or plan this on Synth?"})]})]})}function KM({formData:e,errors:t,onUpdateFormData:r,maxCharacters:n=500}){const{user:a}=ws(),i=e.reviewText.length,o=i>n*.8;return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("header",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Almost there"}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Share the story"}),s.jsx("p",{className:"text-sm text-gray-600 max-w-xl mx-auto",children:"Bring the show to life with a short recap and any photos you snapped."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(qt,{htmlFor:"reviewText",className:"text-base font-semibold text-gray-900",children:"Overall Experience *"}),s.jsx(_s,{id:"reviewText",placeholder:"What made this night unforgettable? Any standout moments future fans should know?",value:e.reviewText,onChange:l=>r({reviewText:l.target.value}),rows:6,className:"resize-none text-base",maxLength:n}),s.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[s.jsx("span",{children:"Minimum 1-2 sentences is perfect."}),s.jsxs("span",{className:Oe(o?"text-orange-600":"text-gray-500"),children:[i,"/",n]})]}),t.reviewText&&s.jsx("p",{className:"text-sm text-red-600",children:t.reviewText})]}),a&&s.jsx(Fde,{value:e.photos||[],onChange:l=>r({photos:l}),userId:a.id,bucket:"review-photos",maxPhotos:5,maxSizeMB:5,label:"Photos (Optional)",helperText:"Add up to 5 photos to give fans a feel for the night."}),a&&s.jsx(Bde,{value:e.videos||[],onChange:l=>r({videos:l}),userId:a.id,bucket:"review-videos",maxVideos:3,maxSizeMB:100,label:"Videos (Optional)",helperText:"Add videos from the event (max 100MB per video)"}),a&&s.jsx(Ze,{className:"border-2 border-pink-100 bg-gradient-to-br from-pink-50/50 to-purple-50/30",children:s.jsxs(tt,{className:"p-8 pb-12",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[s.jsx(Vr,{className:"w-6 h-6 text-pink-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Who tagged along? (Optional)"})]}),s.jsx(Ude,{value:e.attendees,onChange:l=>r({attendees:l}),userId:a.id,metOnSynth:e.metOnSynth,onMetOnSynthChange:l=>r({metOnSynth:l})})]})})]})}var qde="Separator",ZM="horizontal",Vde=["horizontal","vertical"],uB=y.forwardRef((e,t)=>{const c=e,{decorative:r,orientation:n=ZM}=c,a=ge(c,["decorative","orientation"]),i=Wde(n)?n:ZM,l=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return s.jsx(Pt.div,V(D(D({"data-orientation":i},l),a),{ref:t}))});uB.displayName=qde;function Wde(e){return Vde.includes(e)}var fB=uB;const hl=y.forwardRef((i,a)=>{var o=i,{className:e,orientation:t="horizontal",decorative:r=!0}=o,n=ge(o,["className","orientation","decorative"]);return s.jsx(fB,D({ref:a,decorative:r,orientation:t,className:Oe("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e)},n))});hl.displayName=fB.displayName;const XM="https://synth-beta-testing.vercel.app",Hde=()=>{if(typeof window=="undefined")return"http://localhost:3001";const e=window.location.hostname;return e==="localhost"||e.startsWith("127.0.0.1")||e.startsWith("192.168.")||e.startsWith("10.0.")||e.startsWith("172.")?"http://localhost:3001":window.Capacitor?"https://synth-beta-testing.vercel.app":""};class Xh{static searchSetlists(t){return E(this,null,function*(){const r=this.buildQueryString(t),a=`${Hde()}/api/setlists/search?${r}`;try{console.log(" SetlistService: Making request to setlist.fm API via backend proxy:",a);const i=yield fetch(a,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!i.ok){if(i.status===404)return console.log(" No results from setlist.fm API"),null;throw new Error(`Backend API error: ${i.status} ${i.statusText}`)}const o=yield i.json();return!o.setlist||o.setlist.length===0?(console.log(" No results from setlist.fm API"),null):(console.log(" SetlistService: Received setlists from setlist.fm API:",o.setlist.length),o.setlist)}catch(i){console.error(" Error with setlist.fm API proxy:",i);const o=new Error("setlist-service-offline");throw o.name="SetlistServiceOfflineError",o}})}static buildQueryString(t){const r=new URLSearchParams;return t.artistName&&r.append("artistName",t.artistName),t.date&&r.append("date",t.date),t.venueName&&r.append("venueName",t.venueName),t.cityName&&r.append("cityName",t.cityName),t.stateCode&&r.append("stateCode",t.stateCode),r.toString()}static searchSetlistsViaServerless(t,r){return E(this,null,function*(){var n;try{const a=`/api/setlists/search?${r}`;console.log(" SetlistService: Trying serverless proxy:",a);const i=yield fetch(a,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!i.ok){if(i.status===404)return null;throw new Error(`Serverless proxy error: ${i.status} ${i.statusText}`)}if(!((n=i.headers.get("content-type"))!=null?n:"").includes("application/json"))return console.warn(" Serverless proxy returned non-JSON payload"),null;const l=yield i.json();return!l.setlist||l.setlist.length===0?null:(console.log(" SetlistService: Received setlists from serverless proxy:",l.setlist.length),l.setlist)}catch(a){return console.warn(" Serverless setlist proxy failed:",a),null}})}static searchSetlistsViaRemoteProxy(t,r){return E(this,null,function*(){var n,a;try{const i=`${XM}/api/setlists/search?${r}`;console.log(" SetlistService: Trying remote proxy:",i);const o=yield fetch(i,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!o.ok){if(o.status===404)return null;try{yield fetch(`${XM}/api/setlists/health`,{method:"GET"})}catch(h){console.warn(" Remote proxy health check failed:",h)}const d=yield fetch(i,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!d.ok)throw new Error(`Remote proxy error: ${d.status} ${d.statusText}`);if(!((n=d.headers.get("content-type"))!=null?n:"").includes("application/json"))return console.warn(" Remote proxy retry returned non-JSON payload"),null;const u=yield d.json();return!u.setlist||u.setlist.length===0?null:(console.log(" SetlistService: Received setlists from remote proxy (retry):",u.setlist.length),u.setlist)}if(!((a=o.headers.get("content-type"))!=null?a:"").includes("application/json"))return console.warn(" Remote proxy returned non-JSON payload"),null;const c=yield o.json();return!c.setlist||c.setlist.length===0?null:(console.log(" SetlistService: Received setlists from remote proxy:",c.setlist.length),c.setlist)}catch(i){return console.warn(" Remote setlist proxy failed:",i),null}})}static searchSetlistsFromDatabase(t){return E(this,null,function*(){try{let r=T.from("events").select("id, setlist, artist_id, venue_id, event_date").not("setlist","is",null);if(t.artistName){const{data:o}=yield T.from("artists").select("id").ilike("name",`%${t.artistName}%`).limit(1).maybeSingle();if(o!=null&&o.id)r=r.eq("artist_id",o.id);else return null}if(t.venueName){const{data:o}=yield T.from("venues").select("id").ilike("name",`%${t.venueName}%`).limit(1).maybeSingle();if(o!=null&&o.id)r=r.eq("venue_id",o.id);else return null}if(t.date){const o=t.date.trim();if(/^\d{4}-\d{2}-\d{2}$/.test(o)){const l=new Date(o+"T00:00:00Z"),c=new Date(o+"T23:59:59Z");r=r.gte("event_date",l.toISOString()).lte("event_date",c.toISOString())}else r=r.eq("event_date",o)}const{data:n,error:a}=yield r.limit(10);if(a)return console.error(" Supabase setlist fallback error:",a),null;if(!n||n.length===0)return null;const i=n.map(o=>o.setlist).filter(o=>!!o);return i.length===0?null:(console.log(" SetlistService: Served setlists from Supabase cache:",i.length),i)}catch(r){return console.error(" Supabase setlist fallback exception:",r),null}})}static getSetlistForEvent(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("events").select("setlist, setlist_enriched, setlist_song_count, setlist_fm_id, event_date").eq("id",t).single();if(n)throw n;return r!=null&&r.setlist?r.setlist:null}catch(r){return console.error("Error getting setlist for event:",r),null}})}static searchSetlistsByArtist(t,r){return E(this,null,function*(){return this.searchSetlists({artistName:t,date:r})})}static searchSetlistsByArtistAndVenue(t,r,n){return E(this,null,function*(){return this.searchSetlists({artistName:t,venueName:r,date:n})})}}function hB({isOpen:e,onClose:t,artistName:r,venueName:n,eventDate:a,onSetlistSelect:i}){const[o,l]=y.useState([]),[c,d]=y.useState(!1),[f,u]=y.useState(null),[h,m]=y.useState("none"),[v,g]=y.useState(null),{toast:x}=Er();y.useEffect(()=>{e&&r&&_()},[e,r,n,a]);const _=()=>E(this,null,function*(){try{d(!0),u(null),m("none"),console.log(" SetlistModal: fetchSetlists called with:",{artistName:r,venueName:n,eventDate:a,eventDateType:typeof a});let S=[];if(n&&a)try{console.log(" Searching by artist, venue, and date:",{artistName:r,venueName:n,eventDate:a});const R=yield Xh.searchSetlistsByArtistAndVenue(r,n,a);R&&R.length>0&&(console.log(` Found ${R.length} results from venue+date search`),S=[...S,...R])}catch(R){console.warn(" Venue+date search failed:",R)}if(S.length>0){console.log(" Using venue+date results, skipping additional searches to avoid rate limits"),l(S),d(!1);return}if(a)try{console.log(" Searching by artist and date:",{artistName:r,eventDate:a});const R=yield Xh.searchSetlistsByArtist(r,a);R&&R.length>0&&(console.log(` Found ${R.length} results from artist+date search`),S=[...S,...R])}catch(R){console.warn(" Artist+date search failed:",R)}if(S.length>0){console.log(" Using artist+date results, skipping additional searches to avoid rate limits"),l(S),d(!1);return}try{console.log(" Searching by artist only:",{artistName:r});const R=yield Xh.searchSetlistsByArtist(r);R&&R.length>0&&(console.log(` Found ${R.length} results from artist-only search`),S=[...S,...R])}catch(R){console.warn(" Artist-only search failed:",R)}const k=S.filter(R=>{var B;const I=r.toLowerCase().trim(),O=(((B=R.artist)==null?void 0:B.name)||"").toLowerCase().trim();return O===I||O.split(" ")[0]===I&&O.length<=I.length+2});console.log(` Filtered ${S.length} results to ${k.length} matching artist name`),console.log(" Filtered results:",k.map(R=>{var I;return(I=R.artist)==null?void 0:I.name}));const A=k.filter((R,I,O)=>I===O.findIndex(z=>z.setlistFmId===R.setlistFmId)).sort((R,I)=>{if(!a)return 0;const O=new Date(a),z=new Date(R.eventDate),M=new Date(I.eventDate),B=z.toDateString()===O.toDateString(),F=M.toDateString()===O.toDateString();if(B&&!F)return-1;if(!B&&F)return 1;const U=Math.abs(z.getTime()-O.getTime()),H=Math.abs(M.getTime()-O.getTime());return U-H});if(console.log(" Final sorted setlists:",A.length),l(A),a&&A.length>0){const R=A.find(I=>{const O=w(I.eventDate),z=w(a)||new Date(a);return O?O.toDateString()===z.toDateString():!1});R&&(console.log(" Auto-selecting exact date match:",R.eventDate),g(R))}A.length===0&&(m("not-found"),u("We couldnt find official setlists for this artist. Feel free to add the songs manually below."))}catch(S){console.error("Error fetching setlists:",S),S instanceof Error&&S.name==="SetlistServiceOfflineError"?(m("offline"),u("Setlist import is offline. Start the local proxy or add the setlist manually in the form."),x({title:"Setlist import unavailable",description:"Run `npm run backend:dev` in another terminal or enter the songs manually.",variant:"destructive"})):(m("generic"),u("Failed to fetch setlists. Please try again."),x({title:"Error",description:"Failed to fetch setlists. Please try again.",variant:"destructive"}))}finally{d(!1)}}),w=S=>{if(!S)return null;try{if(S.includes("-")&&S.length===10){const C=S.split("-");if(C.length===3){if(C[0].length===2&&C[1].length===2&&C[2].length===4){const A=parseInt(C[2],10),R=parseInt(C[1],10)-1,I=parseInt(C[0],10);return new Date(A,R,I)}else if(C[0].length===4)return new Date(S)}}const k=new Date(S);if(!isNaN(k.getTime()))return k}catch(k){}return null},b=S=>{const k=w(S);return!k||isNaN(k.getTime())?(console.warn("Invalid date string:",S),"Date TBD"):k.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})},N=S=>{const k={};return S.forEach(C=>{k[C.setNumber]||(k[C.setNumber]=[]),k[C.setNumber].push(C)}),k};return e?s.jsx(vn,{open:e,onOpenChange:t,children:s.jsxs(hn,{className:"max-w-4xl w-[95vw] h-[90vh] max-h-[90vh] p-0 overflow-hidden flex flex-col",hideCloseButton:!0,children:[s.jsx(Hn,{className:"px-6 py-4 border-b border-gray-200 bg-white sticky top-0 z-10",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Sn,{className:"text-xl font-semibold",children:["Setlists for ",r]}),s.jsx(ce,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0",children:s.jsx(Yr,{className:"h-4 w-4"})})]})}),s.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-6",children:[c&&s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(fr,{className:"h-8 w-8 animate-spin mr-3"}),s.jsx("span",{children:"Searching for setlists..."})]}),f&&!c&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ft,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:h==="offline"?"Setlist Import Offline":h==="not-found"?"No Setlists Found":"Something Went Wrong"}),s.jsx("p",{className:"text-gray-600 mb-4 max-w-lg mx-auto whitespace-pre-wrap",children:f}),h==="offline"&&s.jsxs("div",{className:"bg-pink-50 border border-pink-100 rounded-lg p-4 text-left max-w-md mx-auto mb-6 text-sm text-pink-900",children:[s.jsx("p",{className:"font-medium mb-2",children:"To import from setlist.fm locally:"}),s.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[s.jsx("li",{children:"Open a new terminal window"}),s.jsxs("li",{children:["Run ",s.jsx("code",{className:"px-1 py-0.5 bg-white rounded border border-pink-200 text-xs",children:"npm run backend:dev"})]}),s.jsx("li",{children:"Keep it running while you use the import"})]}),s.jsx("p",{className:"mt-3",children:"Or close this modal and add the songs manually using the Add your own setlist section in the form."})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3",children:[s.jsx(ce,{onClick:_,variant:"outline",children:"Try Again"}),s.jsx(ce,{variant:"ghost",onClick:t,children:"Close & add manually"})]})]}),!c&&!f&&o.length>0&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Found ",o.length," setlist",o.length!==1?"s":""," for ",r]}),o.map((S,k)=>{const C=N(S.songs),A=(v==null?void 0:v.setlistFmId)===S.setlistFmId,R=w(S.eventDate),I=a?w(a)||new Date(a):null,O=a&&R&&I&&R.toDateString()===I.toDateString();return s.jsxs(Ze,{className:`overflow-hidden transition-all duration-200 ${A?"ring-2 ring-blue-500 shadow-lg":"hover:shadow-md"}`,children:[s.jsx(kr,{className:`bg-gradient-to-r from-purple-50 to-pink-50 ${A?"bg-gradient-to-r from-blue-50 to-indigo-50":""}`,children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Lr,{className:"text-lg",children:S.artist.name}),O&&s.jsx(et,{variant:"default",className:"bg-green-500 hover:bg-green-600",children:"Exact Match"}),A&&s.jsx(et,{variant:"default",className:"bg-blue-500 hover:bg-blue-600",children:"Selected"})]}),s.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"h-4 w-4"}),b(S.eventDate)]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(yr,{className:"h-4 w-4"}),S.venue.name,", ",S.venue.city,S.venue.state&&`, ${S.venue.state}`]}),S.tour&&s.jsx("div",{className:"text-purple-600 font-medium",children:S.tour})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs(et,{variant:"secondary",className:"mb-2",children:[S.songCount," songs"]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[Object.keys(C).length," set",Object.keys(C).length!==1?"s":""]})]})]})}),s.jsxs(tt,{className:"p-6",children:[S.info&&s.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-800",children:S.info}),s.jsx("div",{className:"space-y-4",children:Object.entries(C).map(([z,M])=>{var B;return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(et,{variant:"outline",className:"font-medium",children:((B=M[0])==null?void 0:B.setName)||`Set ${z}`}),s.jsxs("span",{className:"text-sm text-gray-500",children:[M.length," song",M.length!==1?"s":""]})]}),s.jsx("div",{className:"space-y-1",children:M.map((F,U)=>s.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-500 w-8 text-right",children:[F.position,"."]}),s.jsx("span",{className:"text-sm flex-1",children:F.name}),F.cover&&s.jsx(et,{variant:"secondary",className:"text-xs",children:F.cover.artist}),F.tape&&s.jsx(et,{variant:"outline",className:"text-xs",children:"Tape"})]},U))}),parseInt(z)<Object.keys(C).length&&s.jsx(hl,{className:"my-4"})]},z)})}),s.jsx("div",{className:"mt-6 pt-4 border-t",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ce,{variant:A?"default":"outline",size:"sm",onClick:()=>{g(S),i&&i(S),x({title:"Setlist Selected",description:`Selected setlist from ${S.venue.name} on ${b(S.eventDate)}`}),setTimeout(()=>{t()},1e3)},className:"flex-1",children:A?s.jsxs(s.Fragment,{children:[s.jsx(Ft,{className:"h-4 w-4 mr-2"}),"Selected"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ft,{className:"h-4 w-4 mr-2"}),"Select This Setlist"]})}),s.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>window.open(S.url,"_blank"),children:[s.jsx(io,{className:"h-4 w-4 mr-2"}),"View on Setlist.fm"]})]})})]})]},S.setlistFmId)})]})]})]})}):null}function T2({songs:e,onChange:t,className:r,disabled:n=!1}){const[a,i]=y.useState(!1),[o,l]=y.useState(null),[c,d]=y.useState({song_name:"",cover_artist:"",notes:""}),f=()=>{var _,w;if(!c.song_name.trim())return;const x={song_name:c.song_name.trim(),cover_artist:((_=c.cover_artist)==null?void 0:_.trim())||void 0,notes:((w=c.notes)==null?void 0:w.trim())||void 0,position:e.length+1};t([...e,x]),d({song_name:"",cover_artist:"",notes:""}),i(!1)},u=x=>{const _=e[x];d({song_name:_.song_name,cover_artist:_.cover_artist||"",notes:_.notes||""}),l(x),i(!0)},h=()=>{var _,w;if(o===null||!c.song_name.trim())return;const x=[...e];x[o]={song_name:c.song_name.trim(),cover_artist:((_=c.cover_artist)==null?void 0:_.trim())||void 0,notes:((w=c.notes)==null?void 0:w.trim())||void 0,position:o+1},t(x),d({song_name:"",cover_artist:"",notes:""}),l(null),i(!1)},m=()=>{d({song_name:"",cover_artist:"",notes:""}),l(null),i(!1)},v=x=>{const w=e.filter((b,N)=>N!==x).map((b,N)=>V(D({},b),{position:N+1}));t(w)},g=(x,_)=>{if(_==="up"&&x===0||_==="down"&&x===e.length-1)return;const w=_==="up"?x-1:x+1,b=[...e];[b[x],b[w]]=[b[w],b[x]];const N=b.map((S,k)=>V(D({},S),{position:k+1}));t(N)};return s.jsxs("div",{className:Oe("space-y-3",r,n&&"opacity-50 pointer-events-none"),children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ft,{className:Oe("w-5 h-5",n?"text-gray-400":"text-purple-600")}),s.jsx(qt,{className:Oe("text-sm font-medium",n&&"text-gray-500"),children:n?"Custom Setlist (Disabled)":"Custom Setlist (Optional)"}),e.length>0&&s.jsxs(et,{variant:"secondary",className:Oe(n?"bg-gray-100 text-gray-600":"bg-purple-100 text-purple-800"),children:[e.length," song",e.length!==1?"s":""]})]}),!a&&!n&&s.jsxs(ce,{type:"button",variant:"outline",size:"sm",onClick:()=>i(!0),className:"text-purple-600 border-purple-300 hover:bg-purple-50",children:[s.jsx(Yo,{className:"w-4 h-4 mr-1"}),"Add Song"]})]}),s.jsx("p",{className:Oe("text-xs",n?"text-gray-400":"text-gray-500"),children:n?"Custom setlist creation is disabled because an API setlist was selected.":"Create your own setlist for this show. Add songs in the order they were played."}),e.length>0&&s.jsx("div",{className:"space-y-2",children:e.map((x,_)=>s.jsx(Ze,{className:"border-purple-200 bg-purple-50/30",children:s.jsx(tt,{className:"p-3",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs("div",{className:"flex flex-col gap-1 pt-1",children:[s.jsx("button",{type:"button",onClick:()=>g(_,"up"),disabled:_===0,className:"text-purple-400 hover:text-purple-600 disabled:opacity-30 disabled:cursor-not-allowed","aria-label":"Move up",children:s.jsx(Xk,{className:"w-4 h-4"})}),s.jsx("button",{type:"button",onClick:()=>g(_,"down"),disabled:_===e.length-1,className:"text-purple-400 hover:text-purple-600 disabled:opacity-30 disabled:cursor-not-allowed","aria-label":"Move down",children:s.jsx(Xk,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-purple-100 text-purple-700 font-semibold text-sm flex-shrink-0",children:_+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium text-purple-900",children:x.song_name}),x.cover_artist&&s.jsx("div",{className:"text-xs text-purple-600 mt-1",children:s.jsxs(et,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:["Cover: ",x.cover_artist]})}),x.notes&&s.jsxs("div",{className:"text-xs text-purple-700 mt-1 italic",children:['"',x.notes,'"']})]}),s.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[s.jsx(ce,{type:"button",variant:"ghost",size:"sm",onClick:()=>u(_),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:s.jsx(rz,{className:"h-4 w-4"})}),s.jsx(ce,{type:"button",variant:"ghost",size:"sm",onClick:()=>v(_),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:s.jsx(Ko,{className:"h-4 w-4"})})]})]})})},_))}),a&&s.jsxs(Ze,{className:"border-purple-300 bg-purple-50",children:[s.jsx(kr,{className:"pb-3",children:s.jsx("h4",{className:"text-sm font-semibold text-purple-900",children:o!==null?"Edit Song":"Add Song"})}),s.jsxs(tt,{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"song_name",className:"text-xs font-medium text-purple-900",children:"Song Name *"}),s.jsx(Nr,{id:"song_name",value:c.song_name,onChange:x=>d(V(D({},c),{song_name:x.target.value})),placeholder:"Enter song name...",maxLength:200,className:"border-purple-200"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"cover_artist",className:"text-xs font-medium text-purple-900",children:"Cover Artist (Optional)"}),s.jsx(Nr,{id:"cover_artist",value:c.cover_artist,onChange:x=>d(V(D({},c),{cover_artist:x.target.value})),placeholder:"If this was a cover, enter original artist...",maxLength:100,className:"border-purple-200"}),s.jsx("p",{className:"text-xs text-purple-600",children:"Leave blank if it's an original by the performing artist"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"notes",className:"text-xs font-medium text-purple-900",children:"Special Notes (Optional)"}),s.jsx(_s,{id:"notes",value:c.notes,onChange:x=>d(V(D({},c),{notes:x.target.value})),placeholder:"Any special notes about this performance...",maxLength:300,rows:2,className:"border-purple-200 resize-none"}),s.jsx("p",{className:"text-xs text-purple-600",children:'E.g., "Extended guitar solo", "First time played live", "Crowd favorite"'})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs(ce,{type:"button",onClick:o!==null?h:f,disabled:!c.song_name.trim(),className:"bg-purple-600 hover:bg-purple-700",children:[s.jsx(LP,{className:"w-4 h-4 mr-1"}),o!==null?"Save Changes":"Add Song"]}),s.jsxs(ce,{type:"button",variant:"outline",onClick:m,className:"border-purple-300 text-purple-700 hover:bg-purple-50",children:[s.jsx(Yr,{className:"w-4 h-4 mr-1"}),"Cancel"]})]})]})]}),e.length===0&&!a&&s.jsxs("div",{className:"text-center py-6 border-2 border-dashed border-purple-200 rounded-lg bg-purple-50/30",children:[s.jsx(Ft,{className:"w-8 h-8 text-purple-300 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-purple-600 mb-2",children:"No songs added yet"}),s.jsxs(ce,{type:"button",variant:"outline",size:"sm",onClick:()=>i(!0),className:"text-purple-600 border-purple-300 hover:bg-purple-50",children:[s.jsx(Yo,{className:"w-4 h-4 mr-1"}),"Add Your First Song"]})]})]})}function Gde({formData:e,errors:t,onUpdateFormData:r,artistName:n,venueName:a,eventDate:i}){var b,N,S;const[o,l]=y.useState(null),[c,d]=y.useState(!1),f=(b=o!=null?o:e.rating)!=null?b:0,u=e.reviewText.length,h=200,m=u>h*.8,v=k=>{r({selectedSetlist:k}),d(!1)},g=()=>{r({selectedSetlist:null})},x=k=>{r({customSetlist:k})},_=k=>{r({rating:k})},w=k=>{if(!k)return"";const C=new Date(k);return Number.isNaN(C.getTime())?"":C.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})};return s.jsxs("div",{className:"space-y-6 w-full max-w-full overflow-x-hidden",children:[s.jsxs("header",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Quick Review"}),s.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-900 break-words",children:"Share your experience"}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 max-w-full mx-auto break-words",children:"Rate the overall experience and share a brief recap."})]}),s.jsx("section",{className:"bg-gradient-to-br from-pink-50 via-rose-50 to-fuchsia-50 border border-pink-200/60 rounded-2xl p-4 sm:p-6 shadow-sm text-center space-y-4 w-full max-w-full overflow-x-hidden",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-pink-600 font-semibold",children:"Overall Rating"}),s.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4 flex-wrap",children:[s.jsx("div",{className:"flex items-center flex-shrink-0",onMouseLeave:()=>l(null),children:Array.from({length:5},(k,C)=>{const A=C+1,R=A,I=A-.5,O=f>=R,z=!O&&f===I;return s.jsxs("div",{className:"relative w-8 h-8 sm:w-10 sm:h-10 cursor-pointer flex-shrink-0",children:[s.jsx(Xt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-300"}),(O||z)&&s.jsx("div",{className:Oe("absolute left-0 top-0 h-full overflow-hidden pointer-events-none",O?"w-full":"w-1/2"),children:s.jsx(Xt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-pink-500 fill-current"})}),s.jsx("button",{type:"button",className:"absolute inset-0",onMouseEnter:()=>l(R),onClick:()=>_(R),"aria-label":`Rate ${R} stars`}),s.jsx("button",{type:"button",className:"absolute inset-0 left-0 w-1/2",onMouseEnter:()=>l(I),onClick:()=>_(I),"aria-label":`Rate ${I} stars`})]},C)})}),s.jsx("span",{className:"text-base sm:text-lg font-semibold text-gray-700 break-words",children:f>0?`${f.toFixed(1)} / 5.0`:"Not rated yet"})]}),t.rating&&s.jsx("p",{className:"text-xs sm:text-sm text-red-600 break-words",children:t.rating})]})}),s.jsxs("div",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[s.jsx(qt,{htmlFor:"reviewText",className:"text-sm sm:text-base font-semibold text-gray-900",children:"Brief Review *"}),s.jsx(_s,{id:"reviewText",placeholder:"What made this night memorable? Share a quick recap.",value:e.reviewText,onChange:k=>r({reviewText:k.target.value}),rows:4,className:"resize-none text-sm sm:text-base w-full max-w-full min-w-0",maxLength:h}),s.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[s.jsx("span",{className:"break-words",children:"Keep it brief - 1-2 sentences is perfect."}),s.jsxs("span",{className:Oe(m?"text-orange-600":"text-gray-500","flex-shrink-0 ml-2"),children:[u,"/",h]})]}),t.reviewText&&s.jsx("p",{className:"text-xs sm:text-sm text-red-600 break-words",children:t.reviewText})]}),s.jsxs("div",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[s.jsx(qt,{className:"text-sm sm:text-base font-semibold text-gray-900",children:"Setlist (Optional)"}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 break-words",children:"Add the setlist if you remember it"}),e.selectedSetlist?s.jsxs("div",{className:"p-3 sm:p-4 bg-pink-50 rounded-lg border border-pink-200 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx(Ft,{className:"w-4 h-4 sm:w-5 sm:h-5 text-pink-600 flex-shrink-0"}),s.jsx("span",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:"Setlist Selected"})]}),s.jsx(ce,{type:"button",variant:"ghost",size:"sm",onClick:g,className:"h-8 w-8 p-0 flex-shrink-0",children:s.jsx(Yr,{className:"w-4 h-4"})})]}),s.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 break-words",children:[(N=e.selectedSetlist.artist)==null?void 0:N.name," - ",w(e.selectedSetlist.eventDate)]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.selectedSetlist.songCount||((S=e.selectedSetlist.songs)==null?void 0:S.length)||0," songs"]})]}):e.customSetlist.length>0?s.jsxs("div",{className:"p-3 sm:p-4 bg-pink-50 rounded-lg border border-pink-200 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx(Ft,{className:"w-4 h-4 sm:w-5 sm:h-5 text-pink-600 flex-shrink-0"}),s.jsx("span",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:"Custom Setlist"})]}),s.jsx(ce,{type:"button",variant:"ghost",size:"sm",onClick:()=>r({customSetlist:[]}),className:"h-8 w-8 p-0 flex-shrink-0",children:s.jsx(Yr,{className:"w-4 h-4"})})]}),s.jsxs("p",{className:"text-xs sm:text-sm text-gray-600",children:[e.customSetlist.length," songs"]})]}):s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[s.jsxs(ce,{type:"button",variant:"outline",onClick:()=>d(!0),className:"flex items-center justify-center gap-2 w-full sm:w-auto flex-shrink-0",children:[s.jsx(Ft,{className:"w-4 h-4"}),"Import from setlist.fm"]}),s.jsx(T2,{songs:e.customSetlist,onChange:x})]}),c&&n&&s.jsx(hB,{isOpen:c,onClose:()=>d(!1),artistName:n,venueName:a,eventDate:i,onSetlistSelect:v})]})]})}function tS({formData:e,errors:t,onUpdateFormData:r,onSubmit:n,isLoading:a,averageRating:i,categoryBreakdown:o}){var m,v,g,x,_,w,b,N;const l=S=>{r({isPublic:S})},c=S=>{if(!S)return"Date TBD";const k=new Date(S);return Number.isNaN(k.getTime())?"Date TBD":k.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},d=(S=0,k="sm")=>{const C=k==="lg"?"w-6 h-6":k==="md"?"w-5 h-5":"w-4 h-4",A=k==="lg"?"text-pink-200":"text-gray-300",R=k==="lg"?"text-white":"text-yellow-400";return Array.from({length:5},(I,O)=>{const z=O+1,M=S>=z-.01,B=!M&&S>=z-.5&&S<z;return s.jsxs("div",{className:"relative",children:[s.jsx(Xt,{className:Oe(C,M?`${R} fill-current drop-shadow`:A)}),B&&s.jsx("div",{className:"absolute inset-0 overflow-hidden w-1/2",children:s.jsx(Xt,{className:`${C} ${R} fill-current`})})]},O)})},f=Number.isFinite(i)&&i>0?Math.round(i*10)/10:0,u=f?f.toFixed(1):"",h=e.ticketPricePaid&&!Number.isNaN(Number(e.ticketPricePaid))?Number(e.ticketPricePaid).toFixed(2):null;return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Final Step"}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Review & Share"}),s.jsx("p",{className:"text-sm text-gray-600 max-w-2xl mx-auto",children:"Take a final look at your ratings, highlight anything fans should know, and choose who can see your review."})]}),s.jsx("section",{className:"rounded-3xl bg-gradient-to-br from-pink-500 via-rose-500 to-purple-500 text-white shadow-lg p-8 space-y-4",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.25em] text-white/80",children:"Average rating"}),s.jsxs("div",{className:"flex items-baseline gap-4 mt-2",children:[s.jsx("span",{className:"text-5xl font-bold tracking-tight",children:u}),s.jsx("div",{className:"flex items-center gap-1",children:d(f,"lg")})]}),s.jsx("p",{className:"text-sm text-white/80 mt-2",children:"Based on five categories of your concert experience."})]}),s.jsxs("div",{className:"flex flex-col items-start sm:items-end gap-2",children:[((m=e.selectedArtist)==null?void 0:m.name)&&((v=e.selectedVenue)==null?void 0:v.name)&&s.jsxs("div",{className:"text-sm font-medium",children:[(g=e.selectedArtist)==null?void 0:g.name," @ ",(x=e.selectedVenue)==null?void 0:x.name]}),e.eventDate&&s.jsxs("div",{className:"text-xs text-white/80 flex items-center gap-2",children:[s.jsx(Lt,{className:"w-4 h-4"}),c(e.eventDate)]})]})]})}),s.jsx("section",{className:"grid gap-4 md:grid-cols-2",children:o.map(S=>{var k;return s.jsx("div",{className:"rounded-xl border border-pink-100 bg-white shadow-sm p-4 space-y-3",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:S.label}),S.annotation&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:S.annotation})]}),s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsx("span",{className:"text-lg font-semibold text-gray-900",children:S.rating?S.rating.toFixed(1):""}),s.jsx("div",{className:"flex gap-0.5",children:d((k=S.rating)!=null?k:0,"sm")})]})]})},S.label)})}),s.jsx(Ze,{className:"border-gray-200 shadow-sm",children:s.jsxs(tt,{className:"p-4",children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"What you're sharing"}),s.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[((_=e.selectedArtist)==null?void 0:_.name)&&((w=e.selectedVenue)==null?void 0:w.name)&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fa,{className:"w-4 h-4 text-green-500"}),s.jsxs("span",{children:[s.jsx("strong",{children:(b=e.selectedArtist)==null?void 0:b.name})," at"," ",s.jsx("strong",{children:(N=e.selectedVenue)==null?void 0:N.name})]})]}),e.eventDate&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fa,{className:"w-4 h-4 text-green-500"}),s.jsx("span",{children:c(e.eventDate)})]}),h&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fa,{className:"w-4 h-4 text-green-500"}),s.jsxs("span",{children:["Ticket price (kept private): $",h]})]}),e.reviewText&&s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(fa,{className:"w-4 h-4 text-green-500 mt-0.5"}),s.jsxs("span",{children:["Written story (",e.reviewText.length," characters)"]})]}),Array.isArray(e.photos)&&e.photos.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fa,{className:"w-4 h-4 text-green-500"}),s.jsxs("span",{children:[e.photos.length," photo",e.photos.length!==1?"s":""," attached"]})]})]})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(qt,{className:"text-sm font-medium text-gray-900",children:"Who can see this review?"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"radio",id:"public",name:"privacy",checked:e.isPublic,onChange:()=>l(!0),className:"sr-only"}),s.jsxs("label",{htmlFor:"public",className:Oe("flex items-center space-x-3 p-4 rounded-lg border-2 cursor-pointer transition-all duration-200",e.isPublic?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[s.jsx("div",{className:Oe("w-5 h-5 rounded-full border-2 flex items-center justify-center",e.isPublic?"border-blue-500 bg-blue-500":"border-gray-300"),children:e.isPublic&&s.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Xi,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-900",children:"Public"}),s.jsx(et,{variant:"secondary",className:"text-xs",children:"Recommended"})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Everyone can see your review. Help the community decide where to go."})]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"radio",id:"private",name:"privacy",checked:!e.isPublic,onChange:()=>l(!1),className:"sr-only"}),s.jsxs("label",{htmlFor:"private",className:Oe("flex items-center space-x-3 p-4 rounded-lg border-2 cursor-pointer transition-all duration-200",e.isPublic?"border-gray-200 hover:border-gray-300":"border-blue-500 bg-blue-50"),children:[s.jsx("div",{className:Oe("w-5 h-5 rounded-full border-2 flex items-center justify-center",e.isPublic?"border-gray-300":"border-blue-500 bg-blue-500"),children:!e.isPublic&&s.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Rv,{className:"w-5 h-5 text-gray-600"}),s.jsx("span",{className:"font-medium text-gray-900",children:"Private"})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Only you can see this review. You can always share it later."})]})]})]})]})]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(MP,{className:"w-4 h-4 text-gray-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-gray-600",children:[s.jsx("p",{className:"font-medium mb-1",children:"About privacy:"}),s.jsxs("ul",{className:"space-y-1 text-xs",children:[s.jsx("li",{children:" Public reviews help the community discover amazing shows"}),s.jsx("li",{children:" You can change the privacy setting any time in your profile"}),s.jsx("li",{children:" Private reviews are only visible to you"}),s.jsx("li",{children:" All reviews follow Synths community guidelines"})]})]})]})}),s.jsxs("div",{className:"pt-6 pb-4",children:[s.jsx(ce,{onClick:n,disabled:a,className:"w-full bg-pink-500 hover:bg-pink-600 text-white py-3 text-base font-medium",children:a?s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Submitting Review..."})]}):s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(fa,{className:"w-5 h-5"}),s.jsx("span",{children:"Submit Review"})]})}),t.submit&&s.jsx("p",{className:"text-sm text-red-600 text-center mt-2",children:t.submit})]}),s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-xs text-gray-500",children:"By submitting, you agree to our terms of service and community guidelines."})})]})}function Yde({isOpen:e,onClose:t,userId:r,newReview:n,rating:a}){var I;console.log(" PostSubmitRankingModal MOUNTED/RENDERING with props:",{isOpen:e,userId:r==null?void 0:r.slice(0,8),newReviewId:(I=n==null?void 0:n.id)==null?void 0:I.slice(0,8),rating:a});const[i,o]=y.useState([]),[l,c]=y.useState([]),[d,f]=y.useState(!0),[u,h]=y.useState(!1),[m,v]=y.useState(null),{toast:g}=Er(),x=Math.round(a*10)/10;y.useEffect(()=>{var O;console.log(" PostSubmitRankingModal useEffect triggered:",{isOpen:e,userId:r==null?void 0:r.slice(0,8),rating:a,newReviewId:(O=n==null?void 0:n.id)==null?void 0:O.slice(0,8)}),e&&r?(console.log("   Conditions met, loading reviews..."),_()):console.log("   Conditions not met, skipping load")},[e,r,a]);const _=()=>E(this,null,function*(){f(!0);try{console.log(" Loading reviews for rating:",x,"userId:",r);const{reviews:O}=yield cs.getUserReviewHistory(r);console.log(" Total user reviews fetched:",O.length);const z=O.map(({review:M,event:B})=>V(D({},M),{event_title:B==null?void 0:B.title,artist_name:B==null?void 0:B.artist_name,venue_name:B==null?void 0:B.venue_name,event_date:B==null?void 0:B.event_date,effectiveRating:w(M),rank_order:M.rank_order||null})).filter(M=>{const B=Math.round(M.effectiveRating*10)/10,F=B===x;return console.log(`  Review ${M.id.slice(0,8)}: rating=${M.rating}, effective=${M.effectiveRating}, rounded=${B}, matches=${F}`),F});console.log(` Found ${z.length} reviews matching ${x}`),z.sort((M,B)=>M.rank_order!=null&&B.rank_order!=null?M.rank_order-B.rank_order:M.rank_order!=null?-1:B.rank_order!=null?1:new Date(B.created_at).getTime()-new Date(M.created_at).getTime()),o(z),c(z.map(M=>M.id))}catch(O){console.error(" Error loading reviews with same rating:",O),g({title:"Error",description:"Failed to load reviews for ranking",variant:"destructive"})}finally{f(!1)}}),w=O=>{const z=[O.artist_performance_rating,O.production_rating,O.venue_rating,O.location_rating,O.value_rating].filter(M=>typeof M=="number"&&M>0);if(z.length>0){const M=z.reduce((B,F)=>B+F,0)/z.length;return Math.round(M*10)/10}return O.rating||0};y.useEffect(()=>{console.log(" PostSubmitRankingModal state:",{isOpen:e,reviewsCount:i.length,displayRating:x,newReviewId:n.id})},[e,i.length,x,n.id]);const b=O=>{v(O)},N=(O,z)=>{if(O.preventDefault(),m===null||m===z)return;const M=[...l],B=M[m];M.splice(m,1),M.splice(z,0,B),c(M),v(z)},S=()=>{v(null)},k=(O,z)=>{console.log(" Moving review:",{index:O,direction:z,total:l.length});const M=z==="up"?O-1:O+1;if(M<0||M>=l.length){console.log(" Cannot move - out of bounds");return}const B=[...l],F=B[O];B[O]=B[M],B[M]=F,console.log(" New order:",B),c(B)},C=()=>E(this,null,function*(){h(!0);try{yield cs.setRankOrderForRatingGroup(r,x,l),g({title:"Rankings Saved! ",description:`Your ${x.toFixed(1)} reviews have been ranked.`}),t()}catch(O){console.error("Error saving rankings:",O),g({title:"Error",description:"Failed to save rankings. Please try again.",variant:"destructive"})}finally{h(!1)}}),A=()=>{t()},R=O=>i.find(z=>z.id===O);return d?s.jsx(vn,{open:e,onOpenChange:t,children:s.jsxs(hn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsx(Hn,{children:s.jsx(Sn,{children:"Loading reviews..."})}),s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-pink-500 border-t-transparent rounded-full"})})]})}):!d&&i.length<=1?(console.log(" Only 1 or fewer reviews found, closing modal"),e&&setTimeout(()=>t(),100),null):s.jsx(vn,{open:e,onOpenChange:t,children:s.jsxs(hn,{className:"max-w-3xl max-h-[85vh] overflow-hidden flex flex-col",children:[s.jsxs(Hn,{children:[s.jsxs(Sn,{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"w-5 h-5 text-yellow-400 fill-current"}),"Rank Your ",x.toFixed(1)," Reviews"]}),s.jsxs(ds,{children:["You have ",i.length," reviews rated ",x.toFixed(1),". Drag to reorder them from your favorite (top) to least favorite (bottom). This helps us give you better recommendations!"]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto py-4 space-y-3",children:l.map((O,z)=>{const M=R(O);if(!M)return null;const B=M.id===n.id;return s.jsx(Ze,{draggable:!0,onDragStart:()=>b(z),onDragOver:F=>N(F,z),onDragEnd:S,className:Oe("p-4 cursor-move transition-all",m===z&&"opacity-50",B&&"border-2 border-pink-500 bg-pink-50/50"),children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs("div",{className:"flex flex-col items-center justify-center pt-1",children:[s.jsx(Xk,{className:"w-5 h-5 text-gray-400"}),s.jsx("div",{className:"mt-1 flex items-center justify-center w-7 h-7 rounded-full bg-gray-100 text-sm font-semibold text-gray-700",children:z+1})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold text-gray-900 truncate",children:M.event_title||M.artist_name||"Concert"}),s.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm text-gray-600",children:[M.artist_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ft,{className:"w-3.5 h-3.5"}),s.jsx("span",{className:"truncate",children:M.artist_name})]}),M.venue_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(yr,{className:"w-3.5 h-3.5"}),s.jsx("span",{className:"truncate",children:M.venue_name})]})]}),M.event_date&&s.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-gray-500",children:[s.jsx(Lt,{className:"w-3 h-3"}),s.jsx("span",{children:new Date(M.event_date).toLocaleDateString()})]}),M.review_text&&s.jsx("p",{className:"mt-2 text-sm text-gray-700 line-clamp-2",children:M.review_text})]}),B&&s.jsx("div",{className:"flex-shrink-0",children:s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-pink-100 text-pink-800",children:"New"})})]}),s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsx(ce,{type:"button",variant:"outline",size:"sm",onClick:F=>{F.preventDefault(),F.stopPropagation(),k(z,"up")},disabled:z===0,className:"text-xs",children:" Move Up"}),s.jsx(ce,{type:"button",variant:"outline",size:"sm",onClick:F=>{F.preventDefault(),F.stopPropagation(),k(z,"down")},disabled:z===l.length-1,className:"text-xs",children:" Move Down"})]})]})]})},M.id)})}),s.jsxs(Tf,{className:"gap-2",children:[s.jsx(ce,{type:"button",variant:"outline",onClick:A,disabled:u,children:"Skip for Now"}),s.jsx(ce,{type:"button",onClick:C,disabled:u,className:"bg-pink-500 hover:bg-pink-600",children:u?"Saving...":"Save Rankings"})]})]})})}const Kde=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,ku=e=>typeof e=="string"&&Kde.test(e),JM=e=>{var r,n;if(!e||typeof e!="object")return e;const t=D({},e);return"id"in t&&!ku(t.id)&&(typeof t.id=="string"&&(t.jambase_id=(r=t.jambase_id)!=null?r:t.id),t.id=null),"identifier"in t&&!ku(t.identifier)&&(t.jambase_identifier=(n=t.jambase_identifier)!=null?n:t.identifier),t};class Jh{static ensureEventArtistUuid(t,r){return E(this,null,function*(){var n,a,i;try{const{data:o,error:l}=yield T.from("events").select("id, artist_id, artist_name").eq("id",t).maybeSingle();if(l&&console.warn(" DraftReviewService: Failed to fetch event for artist resolution",l),o!=null&&o.artist_id){const u=o.artist_id.trim();if(ku(u))return u;{const{data:h}=yield T.from("artists_with_external_ids").select("id").eq("jambase_artist_id",u).maybeSingle();if(h!=null&&h.id)return h.id}}const c=r.selectedArtist||null;let d,f;if(c&&typeof c=="object"){const u=c.id;ku(u)&&(d=u),f=f||c.jambase_id||(typeof u=="string"&&!ku(u)?u:void 0)||(typeof c.identifier=="string"?(i=(a=(n=c.identifier).split)==null?void 0:a.call(n,":"))==null?void 0:i[1]:void 0)}if(!f&&(o!=null&&o.artist_id)){const u=o.artist_id.trim();ku(u)?d=u:u&&(f=u)}if(!d&&f){let u=yield T.from("artists_with_external_ids").select("id").eq("jambase_artist_id",f).limit(1);if(!u.error&&Array.isArray(u.data)&&u.data.length>0)d=u.data[0].id;else if(!u.error)try{const{UnifiedArtistSearchService:h}=yield Rr(()=>E(this,null,function*(){const{UnifiedArtistSearchService:m}=yield Promise.resolve().then(()=>Dde);return{UnifiedArtistSearchService:m}}),void 0,import.meta.url);yield h.searchArtists((c==null?void 0:c.name)||(o==null?void 0:o.artist_name)||"",20,!1),u=yield T.from("artists_with_external_ids").select("id").eq("jambase_artist_id",f).limit(1),!u.error&&Array.isArray(u.data)&&u.data.length>0&&(d=u.data[0].id)}catch(h){console.warn(" DraftReviewService: Artist search retry failed",h)}}if(d&&ku(d))return yield T.from("events").update({artist_uuid:d}).eq("id",t),d}catch(o){console.warn(" DraftReviewService: ensureEventArtistUuid encountered error",o)}})}static saveDraft(t,r,n){return E(this,null,function*(){try{if(console.log(" Saving draft:",{userId:t,eventId:r,draftData:n}),!t||!r)return console.error(" Missing required parameters:",{userId:t,eventId:r}),null;if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r))return console.error(" Event ID is not a valid UUID:",r),null;const{data:i,error:o}=yield T.from("reviews").select("id, is_draft").eq("user_id",t).eq("event_id",r).eq("is_draft",!1).maybeSingle();if(o&&o.code!=="PGRST116"&&console.error(" Error checking for existing published review:",o),i&&!i.is_draft)return console.log(" Draft save blocked: Published review already exists for this event"),console.log("   Published review ID:",i.id),null;const l=yield this.ensureEventArtistUuid(r,n),c=l?V(D({},n),{selectedArtist:n.selectedArtist?V(D({},n.selectedArtist),{id:l}):n.selectedArtist}):n,d=V(D({},c),{selectedArtist:JM(c.selectedArtist),selectedVenue:JM(c.selectedVenue)}),{data:f,error:u}=yield T.rpc("save_review_draft",{p_user_id:t,p_event_id:r,p_draft_data:d});return u?(console.error(" Error saving draft:",u),console.error(" Error details:",JSON.stringify(u,null,2)),null):(console.log(" Draft saved successfully:",f),f)}catch(a){return console.error(" Exception saving draft:",a),null}})}static getUserDrafts(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("get_user_draft_reviews",{p_user_id:t});return n?(console.error("Error fetching drafts:",n),[]):r||[]}catch(r){return console.error("Error fetching drafts:",r),[]}})}static publishDraft(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("publish_review_draft",{p_draft_id:t,p_final_data:r});return a?(console.error("Error publishing draft:",a),null):n}catch(n){return console.error("Error publishing draft:",n),null}})}static deleteDraft(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("delete_review_draft",{p_draft_id:t,p_user_id:r});return a?(console.error("Error deleting draft:",a),!1):n}catch(n){return console.error("Error deleting draft:",n),!1}})}static loadDraftForEvent(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select("draft_data").eq("user_id",t).eq("entity_type","event").eq("entity_id",r).eq("is_draft",!0).single();return a?(a.code==="PGRST116"||console.error("Error loading draft:",a),null):(n==null?void 0:n.draft_data)||null}catch(n){return console.error("Error loading draft:",n),null}})}static hasDraftForEvent(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select("id").eq("user_id",t).eq("event_id",r).eq("is_draft",!0).single();return a?(a.code==="PGRST116"||console.error("Error checking draft:",a),!1):!!n}catch(n){return console.error("Error checking draft:",n),!1}})}}function Zde({userId:e,eventId:t,formData:r,enabled:n=!0,debounceMs:a=2e3,onSave:i,onEventIdChange:o}){const l=y.useRef(),c=y.useRef(""),d=y.useRef(!1),f=y.useCallback(x=>x?/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(x):!1,[]),u=y.useCallback((x,_)=>E(this,null,function*(){if(!n||!e){console.log(" Auto-save skipped:",{enabled:n,userId:!!e});return}const w=_||t;if(!w||!f(w)){console.log(" Auto-save: No valid event ID yet, saving to localStorage as fallback");try{const N=`review_draft_${e}_new`;localStorage.setItem(N,JSON.stringify({data:x,timestamp:Date.now(),eventId:null})),i==null||i(!0),c.current=JSON.stringify(x)}catch(N){console.error("Auto-save to localStorage failed:",N),i==null||i(!1)}return}if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(w)){console.log(" Auto-save skipped: Invalid event ID format:",w);return}if(d.current){console.log(" Auto-save: Already saving, skipping...");return}try{d.current=!0,console.log(" Auto-saving draft to database:",{userId:e,eventId:w});const N=yield Jh.saveDraft(e,w,x);N?(console.log(" Auto-saved draft successfully:",N),i==null||i(!0),c.current=JSON.stringify(x)):(console.warn(" Auto-save returned null (may be expected)"),i==null||i(!1))}catch(N){console.error(" Auto-save to database failed:",N),i==null||i(!1)}finally{d.current=!1}}),[e,t,n,i,f]),h=y.useCallback(x=>{l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{u(x)},a)},[u,a]);y.useEffect(()=>{if(!n||!e)return;JSON.stringify(r)!==c.current&&Object.values(r).some(w=>Array.isArray(w)?w.length>0:typeof w=="object"&&w!==null?Object.keys(w).length>0:w!=null&&w!=="")&&h(r)},[r,h,n,e]),y.useEffect(()=>{if(!n||!e||!t||!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t))return;Object.values(r).some(w=>Array.isArray(w)?w.length>0:typeof w=="object"&&w!==null?Object.keys(w).length>0:w!=null&&w!=="")&&(console.log(" Event ID available, saving draft immediately"),l.current&&clearTimeout(l.current),u(r,t),o==null||o(t))},[t,n,e,r,u,o]),y.useEffect(()=>()=>{l.current&&clearTimeout(l.current)},[]);const m=y.useCallback(()=>E(this,null,function*(){console.log(" Manual save triggered:",{userId:e,eventId:t,hasFormData:!!r}),l.current&&clearTimeout(l.current),yield u(r,t||void 0)}),[u,r,e,t]),v=y.useCallback(x=>{try{const _=`review_draft_${e}_${x||"new"}`,w=localStorage.getItem(_);if(w){const b=JSON.parse(w);return console.log(" Loaded draft from localStorage:",_),b.data}}catch(_){console.error("Error loading draft from localStorage:",_)}return null},[e]),g=y.useCallback(x=>{try{const _=`review_draft_${e}_${x||"new"}`;localStorage.removeItem(_),console.log(" Cleared draft from localStorage:",_)}catch(_){console.error("Error clearing draft from localStorage:",_)}},[e]);return{manualSave:m,loadDraft:v,clearDraft:g}}function qv(e,[t,r]){return Math.min(r,Math.max(t,e))}function Xde(e,t){return y.useReducer((r,n)=>{const a=t[r][n];return a!=null?a:r},e)}var NT="ScrollArea",[mB,nUe]=$s(NT),[Jde,po]=mB(NT),pB=y.forwardRef((e,t)=>{const O=e,{__scopeScrollArea:r,type:n="hover",dir:a,scrollHideDelay:i=600}=O,o=ge(O,["__scopeScrollArea","type","dir","scrollHideDelay"]),[l,c]=y.useState(null),[d,f]=y.useState(null),[u,h]=y.useState(null),[m,v]=y.useState(null),[g,x]=y.useState(null),[_,w]=y.useState(0),[b,N]=y.useState(0),[S,k]=y.useState(!1),[C,A]=y.useState(!1),R=mr(t,z=>c(z)),I=Af(a);return s.jsx(Jde,{scope:r,type:n,dir:I,scrollHideDelay:i,scrollArea:l,viewport:d,onViewportChange:f,content:u,onContentChange:h,scrollbarX:m,onScrollbarXChange:v,scrollbarXEnabled:S,onScrollbarXEnabledChange:k,scrollbarY:g,onScrollbarYChange:x,scrollbarYEnabled:C,onScrollbarYEnabledChange:A,onCornerWidthChange:w,onCornerHeightChange:N,children:s.jsx(Pt.div,V(D({dir:I},o),{ref:R,style:D({position:"relative","--radix-scroll-area-corner-width":_+"px","--radix-scroll-area-corner-height":b+"px"},e.style)}))})});pB.displayName=NT;var gB="ScrollAreaViewport",vB=y.forwardRef((e,t)=>{const d=e,{__scopeScrollArea:r,children:n,nonce:a}=d,i=ge(d,["__scopeScrollArea","children","nonce"]),o=po(gB,r),l=y.useRef(null),c=mr(t,l,o.onViewportChange);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),s.jsx(Pt.div,V(D({"data-radix-scroll-area-viewport":""},i),{ref:c,style:D({overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden"},e.style),children:s.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:n})}))]})});vB.displayName=gB;var Wl="ScrollAreaScrollbar",ST=y.forwardRef((e,t)=>{const c=e,{forceMount:r}=c,n=ge(c,["forceMount"]),a=po(Wl,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,l=e.orientation==="horizontal";return y.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),a.type==="hover"?s.jsx(Qde,V(D({},n),{ref:t,forceMount:r})):a.type==="scroll"?s.jsx(eue,V(D({},n),{ref:t,forceMount:r})):a.type==="auto"?s.jsx(yB,V(D({},n),{ref:t,forceMount:r})):a.type==="always"?s.jsx(kT,V(D({},n),{ref:t})):null});ST.displayName=Wl;var Qde=y.forwardRef((e,t)=>{const l=e,{forceMount:r}=l,n=ge(l,["forceMount"]),a=po(Wl,e.__scopeScrollArea),[i,o]=y.useState(!1);return y.useEffect(()=>{const c=a.scrollArea;let d=0;if(c){const f=()=>{window.clearTimeout(d),o(!0)},u=()=>{d=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return c.addEventListener("pointerenter",f),c.addEventListener("pointerleave",u),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",f),c.removeEventListener("pointerleave",u)}}},[a.scrollArea,a.scrollHideDelay]),s.jsx(Ks,{present:r||i,children:s.jsx(yB,V(D({"data-state":i?"visible":"hidden"},n),{ref:t}))})}),eue=y.forwardRef((e,t)=>{const d=e,{forceMount:r}=d,n=ge(d,["forceMount"]),a=po(Wl,e.__scopeScrollArea),i=e.orientation==="horizontal",o=N1(()=>c("SCROLL_END"),100),[l,c]=Xde("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return y.useEffect(()=>{if(l==="idle"){const f=window.setTimeout(()=>c("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(f)}},[l,a.scrollHideDelay,c]),y.useEffect(()=>{const f=a.viewport,u=i?"scrollLeft":"scrollTop";if(f){let h=f[u];const m=()=>{const v=f[u];h!==v&&(c("SCROLL"),o()),h=v};return f.addEventListener("scroll",m),()=>f.removeEventListener("scroll",m)}},[a.viewport,i,c,o]),s.jsx(Ks,{present:r||l!=="hidden",children:s.jsx(kT,V(D({"data-state":l==="hidden"?"hidden":"visible"},n),{ref:t,onPointerEnter:mt(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:mt(e.onPointerLeave,()=>c("POINTER_LEAVE"))}))})}),yB=y.forwardRef((e,t)=>{const r=po(Wl,e.__scopeScrollArea),d=e,{forceMount:n}=d,a=ge(d,["forceMount"]),[i,o]=y.useState(!1),l=e.orientation==="horizontal",c=N1(()=>{if(r.viewport){const f=r.viewport.offsetWidth<r.viewport.scrollWidth,u=r.viewport.offsetHeight<r.viewport.scrollHeight;o(l?f:u)}},10);return Pm(r.viewport,c),Pm(r.content,c),s.jsx(Ks,{present:n||i,children:s.jsx(kT,V(D({"data-state":i?"visible":"hidden"},a),{ref:t}))})}),kT=y.forwardRef((e,t)=>{const h=e,{orientation:r="vertical"}=h,n=ge(h,["orientation"]),a=po(Wl,e.__scopeScrollArea),i=y.useRef(null),o=y.useRef(0),[l,c]=y.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=jB(l.viewport,l.content),f=V(D({},n),{sizes:l,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:m=>i.current=m,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:m=>o.current=m});function u(m,v){return iue(m,o.current,l,v)}return r==="horizontal"?s.jsx(tue,V(D({},f),{ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const m=a.viewport.scrollLeft,v=QM(m,l,a.dir);i.current.style.transform=`translate3d(${v}px, 0, 0)`}},onWheelScroll:m=>{a.viewport&&(a.viewport.scrollLeft=m)},onDragScroll:m=>{a.viewport&&(a.viewport.scrollLeft=u(m,a.dir))}})):r==="vertical"?s.jsx(rue,V(D({},f),{ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const m=a.viewport.scrollTop,v=QM(m,l);i.current.style.transform=`translate3d(0, ${v}px, 0)`}},onWheelScroll:m=>{a.viewport&&(a.viewport.scrollTop=m)},onDragScroll:m=>{a.viewport&&(a.viewport.scrollTop=u(m))}})):null}),tue=y.forwardRef((e,t)=>{const f=e,{sizes:r,onSizesChange:n}=f,a=ge(f,["sizes","onSizesChange"]),i=po(Wl,e.__scopeScrollArea),[o,l]=y.useState(),c=y.useRef(null),d=mr(t,c,i.onScrollbarXChange);return y.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),s.jsx(_B,V(D({"data-orientation":"horizontal"},a),{ref:d,sizes:r,style:D({bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":j1(r)+"px"},e.style),onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,h)=>{if(i.viewport){const m=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(m),SB(m,h)&&u.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:cw(o.paddingLeft),paddingEnd:cw(o.paddingRight)}})}}))}),rue=y.forwardRef((e,t)=>{const f=e,{sizes:r,onSizesChange:n}=f,a=ge(f,["sizes","onSizesChange"]),i=po(Wl,e.__scopeScrollArea),[o,l]=y.useState(),c=y.useRef(null),d=mr(t,c,i.onScrollbarYChange);return y.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),s.jsx(_B,V(D({"data-orientation":"vertical"},a),{ref:d,sizes:r,style:D({top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":j1(r)+"px"},e.style),onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,h)=>{if(i.viewport){const m=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(m),SB(m,h)&&u.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:cw(o.paddingTop),paddingEnd:cw(o.paddingBottom)}})}}))}),[nue,xB]=mB(Wl),_B=y.forwardRef((e,t)=>{const R=e,{__scopeScrollArea:r,sizes:n,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:f,onResize:u}=R,h=ge(R,["__scopeScrollArea","sizes","hasThumb","onThumbChange","onThumbPointerUp","onThumbPointerDown","onThumbPositionChange","onDragScroll","onWheelScroll","onResize"]),m=po(Wl,r),[v,g]=y.useState(null),x=mr(t,I=>g(I)),_=y.useRef(null),w=y.useRef(""),b=m.viewport,N=n.content-n.viewport,S=ys(f),k=ys(c),C=N1(u,10);function A(I){if(_.current){const O=I.clientX-_.current.left,z=I.clientY-_.current.top;d({x:O,y:z})}}return y.useEffect(()=>{const I=O=>{const z=O.target;(v==null?void 0:v.contains(z))&&S(O,N)};return document.addEventListener("wheel",I,{passive:!1}),()=>document.removeEventListener("wheel",I,{passive:!1})},[b,v,N,S]),y.useEffect(k,[n,k]),Pm(v,C),Pm(m.content,C),s.jsx(nue,{scope:r,scrollbar:v,hasThumb:a,onThumbChange:ys(i),onThumbPointerUp:ys(o),onThumbPositionChange:k,onThumbPointerDown:ys(l),children:s.jsx(Pt.div,V(D({},h),{ref:x,style:D({position:"absolute"},h.style),onPointerDown:mt(e.onPointerDown,I=>{I.button===0&&(I.target.setPointerCapture(I.pointerId),_.current=v.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),A(I))}),onPointerMove:mt(e.onPointerMove,A),onPointerUp:mt(e.onPointerUp,I=>{const O=I.target;O.hasPointerCapture(I.pointerId)&&O.releasePointerCapture(I.pointerId),document.body.style.webkitUserSelect=w.current,m.viewport&&(m.viewport.style.scrollBehavior=""),_.current=null})}))})}),lw="ScrollAreaThumb",wB=y.forwardRef((e,t)=>{const i=e,{forceMount:r}=i,n=ge(i,["forceMount"]),a=xB(lw,e.__scopeScrollArea);return s.jsx(Ks,{present:r||a.hasThumb,children:s.jsx(sue,D({ref:t},n))})}),sue=y.forwardRef((e,t)=>{const u=e,{__scopeScrollArea:r,style:n}=u,a=ge(u,["__scopeScrollArea","style"]),i=po(lw,r),o=xB(lw,r),{onThumbPositionChange:l}=o,c=mr(t,h=>o.onThumbChange(h)),d=y.useRef(void 0),f=N1(()=>{d.current&&(d.current(),d.current=void 0)},100);return y.useEffect(()=>{const h=i.viewport;if(h){const m=()=>{if(f(),!d.current){const v=oue(h,l);d.current=v,l()}};return l(),h.addEventListener("scroll",m),()=>h.removeEventListener("scroll",m)}},[i.viewport,f,l]),s.jsx(Pt.div,V(D({"data-state":o.hasThumb?"visible":"hidden"},a),{ref:c,style:D({width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)"},n),onPointerDownCapture:mt(e.onPointerDownCapture,h=>{const v=h.target.getBoundingClientRect(),g=h.clientX-v.left,x=h.clientY-v.top;o.onThumbPointerDown({x:g,y:x})}),onPointerUp:mt(e.onPointerUp,o.onThumbPointerUp)}))});wB.displayName=lw;var ET="ScrollAreaCorner",bB=y.forwardRef((e,t)=>{const r=po(ET,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?s.jsx(aue,V(D({},e),{ref:t})):null});bB.displayName=ET;var aue=y.forwardRef((e,t)=>{const f=e,{__scopeScrollArea:r}=f,n=ge(f,["__scopeScrollArea"]),a=po(ET,r),[i,o]=y.useState(0),[l,c]=y.useState(0),d=!!(i&&l);return Pm(a.scrollbarX,()=>{var h;const u=((h=a.scrollbarX)==null?void 0:h.offsetHeight)||0;a.onCornerHeightChange(u),c(u)}),Pm(a.scrollbarY,()=>{var h;const u=((h=a.scrollbarY)==null?void 0:h.offsetWidth)||0;a.onCornerWidthChange(u),o(u)}),d?s.jsx(Pt.div,V(D({},n),{ref:t,style:D({width:i,height:l,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0},e.style)})):null});function cw(e){return e?parseInt(e,10):0}function jB(e,t){const r=e/t;return isNaN(r)?0:r}function j1(e){const t=jB(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-r)*t;return Math.max(n,18)}function iue(e,t,r,n="ltr"){const a=j1(r),i=a/2,o=t||i,l=a-o,c=r.scrollbar.paddingStart+o,d=r.scrollbar.size-r.scrollbar.paddingEnd-l,f=r.content-r.viewport,u=n==="ltr"?[0,f]:[f*-1,0];return NB([c,d],u)(e)}function QM(e,t,r="ltr"){const n=j1(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-a,o=t.content-t.viewport,l=i-n,c=r==="ltr"?[0,o]:[o*-1,0],d=qv(e,c);return NB([0,o],[0,l])(d)}function NB(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function SB(e,t){return e>0&&e<t}var oue=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return function a(){const i={left:e.scrollLeft,top:e.scrollTop},o=r.left!==i.left,l=r.top!==i.top;(o||l)&&t(),r=i,n=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(n)};function N1(e,t){const r=ys(e),n=y.useRef(0);return y.useEffect(()=>()=>window.clearTimeout(n.current),[]),y.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function Pm(e,t){const r=ys(t);xs(()=>{let n=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return a.observe(e),()=>{window.cancelAnimationFrame(n),a.unobserve(e)}}},[e,r])}var kB=pB,lue=vB,cue=bB;const S1=y.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=ge(i,["className","children"]);return s.jsxs(kB,V(D({ref:n,className:Oe("relative overflow-hidden",e)},r),{children:[s.jsx(lue,{className:"h-full w-full rounded-[inherit]",children:t}),s.jsx(CT,{}),s.jsx(cue,{})]}))});S1.displayName=kB.displayName;const CT=y.forwardRef((a,n)=>{var i=a,{className:e,orientation:t="vertical"}=i,r=ge(i,["className","orientation"]);return s.jsx(ST,V(D({ref:n,orientation:t,className:Oe("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e)},r),{children:s.jsx(wB,{className:"relative flex-1 rounded-full bg-border"})}))});CT.displayName=ST.displayName;function due({userId:e,onSelectDraft:t,onNewReview:r,currentMode:n}){const[a,i]=y.useState([]),[o,l]=y.useState(!1),[c,d]=y.useState(!1),{toast:f}=Er(),u=()=>E(this,null,function*(){d(!0);try{const g=yield Jh.getUserDrafts(e);i(g)}catch(g){console.error("Error loading drafts:",g),f({title:"Error",description:"Failed to load draft reviews",variant:"destructive"})}finally{d(!1)}});y.useEffect(()=>{o&&u()},[o,e]);const h=g=>E(this,null,function*(){try{(yield Jh.deleteDraft(g,e))?(i(_=>_.filter(w=>w.id!==g)),f({title:"Draft Deleted",description:"Draft review has been deleted"})):f({title:"Error",description:"Failed to delete draft",variant:"destructive"})}catch(x){console.error("Error deleting draft:",x),f({title:"Error",description:"Failed to delete draft",variant:"destructive"})}}),m=g=>{t(g),l(!1)},v=g=>{var _,w;const x=[];return(_=g.selectedArtist)!=null&&_.name&&x.push(`Artist: ${g.selectedArtist.name}`),(w=g.selectedVenue)!=null&&w.name&&x.push(`Venue: ${g.selectedVenue.name}`),g.eventDate&&x.push(`Date: ${Rt(new Date(g.eventDate),"MMM d, yyyy")}`),g.performanceRating&&x.push(`Performance: ${g.performanceRating}/5`),g.venueRating&&x.push(`Venue: ${g.venueRating}/5`),g.overallExperienceRating&&x.push(`Overall: ${g.overallExperienceRating}/5`),g.reviewText&&x.push(`Review: ${g.reviewText.substring(0,50)}...`),x.length>0?x.join("  "):"Empty draft"};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsxs(ce,{variant:n==="new"?"default":"outline",size:"sm",onClick:r,className:"flex items-center gap-2",children:[s.jsx(Ol,{className:"w-4 h-4"}),"New Review"]}),s.jsxs(ce,{variant:n==="draft"?"default":"outline",size:"sm",onClick:()=>l(!0),className:"flex items-center gap-2",children:[s.jsx(Oa,{className:"w-4 h-4"}),"View Drafts",a.length>0&&s.jsx(et,{variant:"secondary",className:"ml-1",children:a.length})]})]}),s.jsx(vn,{open:o,onOpenChange:l,children:s.jsxs(hn,{className:"max-w-2xl max-h-[80vh]",children:[s.jsx(Hn,{children:s.jsxs(Sn,{className:"flex items-center gap-2",children:[s.jsx(Oa,{className:"w-5 h-5"}),"Draft Reviews"]})}),s.jsx(S1,{className:"max-h-[60vh]",children:c?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-sm text-gray-500",children:"Loading drafts..."})}):a.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Oa,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Draft Reviews"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"You don't have any draft reviews. Start writing a review to create your first draft."}),s.jsx(ce,{onClick:r,children:"Create New Review"})]}):s.jsx("div",{className:"space-y-4",children:a.map(g=>s.jsxs(Ze,{className:"hover:shadow-md transition-shadow",children:[s.jsx(kr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx(Lr,{className:"text-base mb-1",children:g.event_title||"Untitled Event"}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[g.artist_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ft,{className:"w-3 h-3"}),g.artist_name]}),g.venue_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(yr,{className:"w-3 h-3"}),g.venue_name]}),g.event_date&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"w-3 h-3"}),Rt(new Date(g.event_date),"MMM d, yyyy")]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>m(g),className:"flex items-center gap-1",children:[s.jsx(Ol,{className:"w-3 h-3"}),"Continue"]}),s.jsx(ce,{variant:"outline",size:"sm",onClick:()=>h(g.id),className:"flex items-center gap-1 text-red-600 hover:text-red-700",children:s.jsx(Ko,{className:"w-3 h-3"})})]})]})}),s.jsxs(tt,{className:"pt-0",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-2",children:v(g.draft_data)}),s.jsxs("div",{className:"text-xs text-gray-400",children:["Last saved: ",Rt(new Date(g.last_saved_at),"MMM d, yyyy 'at' h:mm a")]})]})]},g.id))})})]})})]})}class uue{static sendReviewInvitations(t,r,n){return E(this,null,function*(){try{console.log(" Sending SMS invitations:",{phoneNumbers:t,reviewId:r,senderName:n});const{error:a}=yield T.functions.invoke("send-review-invitations",{body:{phoneNumbers:t,reviewId:r,senderName:n,message:`${n} tagged you in a concert review on Synth! Check it out: https://synth.app/reviews/${r}`}});a?console.error("Error invoking SMS function:",a):console.log(" SMS invitations sent successfully")}catch(a){console.error("Failed to send SMS invitations:",a)}})}static validatePhoneNumber(t){return/^\+[1-9]\d{1,14}$/.test(t)}static formatPhoneNumber(t){const r=t.replace(/[^\d+]/g,"");return r.startsWith("+")?r:`+${r}`}}const fue=[{id:"artist-electric",label:"Electric energy",description:"The band fed off the crowd with nonstop energy.",sentiment:"positive"},{id:"artist-tight",label:"Tight musicianship",description:"Flawless set and tight transitions all night.",sentiment:"positive"},{id:"artist-weak-vocals",label:"Vocals struggled",description:"Vocals were off pitch for most of the night.",sentiment:"negative"},{id:"artist-short-set",label:"Short setlist",description:"Felt too quickleft wanting a few more songs.",sentiment:"negative"}],hue=[{id:"production-lights",label:"Insane light show",description:"Lighting design elevated every drop.",sentiment:"positive"},{id:"production-soundmix",label:"Crystal clear mix",description:"Sound mix was balanced and immersive.",sentiment:"positive"},{id:"production-feedback",label:"Feedback issues",description:"Persistent sound issues distracted from songs.",sentiment:"negative"},{id:"production-lag",label:"Stage delays",description:"Long pauses between songs killed the momentum.",sentiment:"negative"}],mue=[{id:"venue-staff",label:"Staff was incredible",description:"Friendly staff kept lines moving smoothly.",sentiment:"positive"},{id:"venue-comfort",label:"Comfortable layout",description:"Plenty of space and easy sightlines.",sentiment:"positive"},{id:"venue-crowded",label:"Overcrowded",description:"Packed to the brim with no room to breathe.",sentiment:"negative"},{id:"venue-sound",label:"Muddy house sound",description:"Venue acoustics made everything sound muffled.",sentiment:"negative"}],pue=[{id:"location-easy",label:"Easy transit",description:"Quick rideshare + plenty of parking nearby.",sentiment:"positive"},{id:"location-food",label:"Great pre-show spots",description:"Awesome food and bars in walking distance.",sentiment:"positive"},{id:"location-traffic",label:"Nightmare traffic",description:"Getting there and back took forever.",sentiment:"negative"},{id:"location-safety",label:"Felt unsafe",description:"Area felt sketchy walking back to the car.",sentiment:"negative"}],gue=[{id:"value-worth-every-dollar",label:"Worth every dollar",description:"Totally justified the ticket price.",sentiment:"positive"},{id:"value-underpriced",label:"Steal of a night",description:"Felt like we paid half of what it was worth.",sentiment:"positive"},{id:"value-overpriced",label:"Overpriced",description:"Fun night, but tickets were overpriced.",sentiment:"negative"},{id:"value-hidden-fees",label:"Too many fees",description:"Fees and merch prices added up fast.",sentiment:"negative"}],rS=e=>{if(!e)return["Select time"];switch(e){case"quick":return["Select time","Event details","Quick review","Submit"];case"standard":return["Select time","Event details","Artist performance","Venue","Review content","Submit"];case"detailed":return["Select time","Event details","Artist performance","Production","Venue","Location","Value","Review content","Submit"];default:return[]}};function EB({event:e,userId:t,onSubmitted:r,onDeleted:n,onClose:a}){var rr,sr,Ae,Ue,gt;const{toast:i}=Er(),{formData:o,errors:l,isLoading:c,updateFormData:d,setLoading:f,resetForm:u,setFormData:h,currentStep:m,nextStep:v,prevStep:g,canProceed:x,canGoBack:_,isLastStep:w,totalSteps:b,currentFlow:N}=Ode(),[S,k]=y.useState(null),[C]=y.useState([]),[A,R]=y.useState(!1),[I,O]=y.useState(null),[z,M]=y.useState(!1),[B,F]=y.useState(null),[U,H]=y.useState(!1);y.useEffect(()=>{H(!1)},[e==null?void 0:e.id]);const q=Ce=>Ce?/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Ce):!1,K=()=>{var Ce;return(Ce=e.id)!=null&&Ce.startsWith("new-review")||q(e.id)?e.id:""},[Z,ne]=y.useState(K()),[Y,X]=y.useState(null),[se,de]=y.useState(!1),[_e,xe]=y.useState(null);y.useEffect(()=>{E(this,null,function*(){var at;if(!((at=o.selectedVenue)!=null&&at.is_from_database)||!o.selectedVenue.id||!t||S){xe(null);return}const Ge=o.selectedVenue.id,Nt=Z||e.id||"";if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Ge)){xe(null);return}try{const ue=yield cs.getPreviousVenueReview(t,Ge,Nt);xe(ue)}catch(ue){console.error("Error checking for previous venue review:",ue),xe(null)}})},[(rr=o.selectedVenue)==null?void 0:rr.id,t,Z,e.id,S]);const Q=Ce=>{if(!Ce)return"";const Ge=new Date(Ce);return Number.isNaN(Ge.getTime())?"":Ge.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},oe=Ce=>{d({selectedSetlist:Ce}),de(!1)},ie=()=>{d({selectedSetlist:null})},ee=Ce=>{d({customSetlist:Ce})},{manualSave:G,loadDraft:J,clearDraft:ae}=Zde({userId:t,eventId:Z||null,formData:o,enabled:!U,debounceMs:2e3,onSave:Ce=>{M(!1),Ce&&F(new Date)},onEventIdChange:Ce=>{Ce&&Ce!==Z&&ne(Ce)}}),fe=y.useMemo(()=>{var Ge,Nt;const Ce=(Ge=o.selectedArtist)==null?void 0:Ge.name;return{2:{title:"Artist Performance",subtitle:Ce?`How did ${Ce} deliver live? Share your honest take.`:"How did the artist deliver live? Share your honest take.",ratingKey:"artistPerformanceRating",feedbackKey:"artistPerformanceFeedback",helperText:"Tap a star (half points allowed) to capture the performance.",suggestions:fue},3:{title:"Production Quality",subtitle:"Lights, visuals, sound mix  did the production elevate the night?",ratingKey:"productionRating",feedbackKey:"productionFeedback",helperText:"Think about sound clarity, lighting, visuals, and pacing.",suggestions:hue},4:{title:"Venue Experience",subtitle:(Nt=o.selectedVenue)!=null&&Nt.name?`What was ${o.selectedVenue.name} like to be in?`:"Consider the staff, comfort, lines, and vibe inside the venue.",ratingKey:"venueRating",feedbackKey:"venueFeedback",helperText:"Include staff vibes, comfort, and amenities.",suggestions:mue},5:{title:"Location & Logistics",subtitle:"Getting there, getting home, nearby spots  how easy was the night?",ratingKey:"locationRating",feedbackKey:"locationFeedback",helperText:"Parking, transit, food options, safety  it all counts.",suggestions:pue},6:{title:"Value for Ticket Price",subtitle:"Given what you paid, did the experience feel worth it?",ratingKey:"valueRating",feedbackKey:"valueFeedback",helperText:"Honest value helps fans budget for future shows.",suggestions:gue}}},[(sr=o.selectedArtist)==null?void 0:sr.name,(Ae=o.selectedVenue)==null?void 0:Ae.name]);y.useEffect(()=>{E(this,null,function*(){var Ge,Nt,Tt,at,ue,qe,Ct,ct,pt;if(!(!e||!t))try{const At=e==null?void 0:e.existing_review_id;let yt=null;if(At&&q(At)){const{data:Fe,error:ft}=yield T.from("reviews").select("*").eq("id",At).maybeSingle();Fe&&!ft&&(yt=Fe)}else q(e.id)&&(yt=yield cs.getUserEventReview(t,e.id));if(!yt){const Fe=J(e.id);Fe&&(console.log(" Loaded draft from localStorage for event:",e.id),h(Fe))}if(yt){k(yt);let Fe=null;if(e){const Et="artist_id"in e||"venue_id"in e;Fe={artist_name:"artist_name"in e?e.artist_name:void 0,artist_id:Et&&"artist_id"in e?e.artist_id:void 0,venue_name:"venue_name"in e?e.venue_name:void 0,venue_id:Et&&"venue_id"in e?e.venue_id:void 0,event_date:"event_date"in e?e.event_date:void 0}}const ft=Fe!=null&&Fe.event_date?String(Fe.event_date).split("T")[0]:e!=null&&e.event_date?String(e.event_date).split("T")[0]:(yt.created_at||"").split("T")[0];h({selectedArtist:null,selectedVenue:null,eventDate:ft,artistPerformanceRating:yt.artist_performance_rating||yt.rating,productionRating:yt.production_rating||yt.artist_performance_rating||yt.rating,venueRating:yt.venue_rating||yt.rating,locationRating:yt.location_rating||yt.venue_rating||yt.rating,valueRating:yt.value_rating||yt.rating,artistPerformanceFeedback:yt.artist_performance_feedback||"",productionFeedback:yt.production_feedback||"",venueFeedback:yt.venue_feedback||"",locationFeedback:yt.location_feedback||"",valueFeedback:yt.value_feedback||"",ticketPricePaid:yt.ticket_price_paid?String(yt.ticket_price_paid):"",rating:yt.rating,reviewText:yt.review_text||"",photos:yt.photos||[],videos:yt.videos||[],selectedSetlist:yt.setlist||null,customSetlist:yt.custom_setlist||[],isPublic:yt.is_public,reviewType:yt.review_type||"event"});try{const Et=(Fe==null?void 0:Fe.artist_name)||(e==null?void 0:e.artist_name)||((Ge=e==null?void 0:e.artist)==null?void 0:Ge.name),hr=(Fe==null?void 0:Fe.artist_id)||(e==null?void 0:e.artist_id)||((Nt=e==null?void 0:e.artist)==null?void 0:Nt.id),dr=(Fe==null?void 0:Fe.venue_name)||(e==null?void 0:e.venue_name)||((Tt=e==null?void 0:e.venue)==null?void 0:Tt.name),cn=(Fe==null?void 0:Fe.venue_id)||yt.venue_id||((at=e==null?void 0:e.venue)==null?void 0:at.id),mn=Fe!=null&&Fe.event_date?String(Fe.event_date).split("T")[0]:e!=null&&e.event_date?String(e.event_date).split("T")[0]:null,je=Et?{id:hr||`manual-${Et}`,name:Et,is_from_database:!!hr}:null,pe=dr?{id:cn||`manual-${dr}`,name:dr,is_from_database:!!cn}:null,Pe={selectedArtist:je,selectedVenue:pe,selectedSetlist:e.setlist||((ue=e==null?void 0:e.existing_review)==null?void 0:ue.selectedSetlist)||null,eventDate:mn||o.eventDate};console.log(" Pre-populating form data for edit:",{selectedArtist:je,selectedVenue:pe,hasSetlist:!!Pe.selectedSetlist,eventDate:Pe.eventDate,eventDateFromEvent:mn,eventDetails:Fe}),h(Pe)}catch(Et){console.error(" Error pre-populating artist/venue:",Et)}}else{k(null),u(),H(!1);try{const Fe=(e==null?void 0:e.artist_name)||((qe=e==null?void 0:e.artist)==null?void 0:qe.name),ft=(e==null?void 0:e.artist_id)||((Ct=e==null?void 0:e.artist)==null?void 0:Ct.id)||void 0,Et=(e==null?void 0:e.venue_name)||((ct=e==null?void 0:e.venue)==null?void 0:ct.name),hr=(e==null?void 0:e.venue_id)||((pt=e==null?void 0:e.venue)==null?void 0:pt.id)||void 0,dr=(e==null?void 0:e.event_date)||(e==null?void 0:e.date)||void 0,cn=Fe?{id:ft||`manual-${Fe}`,name:Fe,is_from_database:!!ft}:null,mn=Et?{id:hr||`manual-${Et}`,name:Et,is_from_database:!!hr}:null,je=dr?String(dr).split("T")[0]:"";h(D(D(D({reviewType:"event"},cn?{selectedArtist:cn}:{}),mn?{selectedVenue:mn}:{}),je?{eventDate:je}:{}))}catch(Fe){h({reviewType:"event"})}}}catch(At){console.error("Error loading review for single page form",At)}})},[e==null?void 0:e.id,t]);const we=()=>E(this,null,function*(){var yt,Fe,ft,Et,hr,dr,cn,mn,je,pe,Pe,Ne,Ye,We,It,jt,Ee,rt,ir,rn,Mt,ye,Ie,dt,wt,ht,Le,Xe,ke,St,_t,Fr,dn,En;if(!t){i({title:"Authentication Required",description:"Please log in to submit a review.",variant:"destructive"});return}const Ce=[];o.reviewType==="event"?(o.selectedArtist||Ce.push("Please select an artist"),o.selectedVenue||Ce.push("Please select a venue"),o.eventDate||Ce.push("Please select an event date")):o.reviewType==="venue"?o.selectedVenue||Ce.push("Please select a venue"):o.reviewType==="artist"&&(o.selectedArtist||Ce.push("Please select an artist"));const Ge=N||"detailed";if(Ge==="quick"?((!o.rating||o.rating<.5||o.rating>5)&&Ce.push("Please provide an overall rating (0.5 - 5 stars)"),!o.reviewText||o.reviewText.trim()===""?Ce.push("Please share a brief description of your experience"):o.reviewText.length>200&&Ce.push("Review text must be 200 characters or less for quick review")):Ge==="standard"?((!o.artistPerformanceRating||o.artistPerformanceRating<.5||o.artistPerformanceRating>5)&&Ce.push("Please rate the artist performance (0.5 - 5 stars)"),(!o.venueRating||o.venueRating<.5||o.venueRating>5)&&Ce.push("Please rate the venue (0.5 - 5 stars)"),!o.reviewText||o.reviewText.trim()===""?Ce.push("Please share a description of your experience"):o.reviewText.length>400&&Ce.push("Review text must be 400 characters or less for standard review")):([[o.artistPerformanceRating,"artist performance"],[o.productionRating,"production quality"],[o.venueRating,"venue"],[o.locationRating,"location & logistics"],[o.valueRating,"value for the ticket price"]].forEach(([ur,or])=>{!ur||ur===0?Ce.push(`Please rate the ${or}`):(ur<.5||ur>5)&&Ce.push(`The ${or} rating must be between 0.5 and 5.0 stars`)}),!o.reviewText||o.reviewText.trim()===""?Ce.push("Please share a brief description of your experience"):o.reviewText.length>500&&Ce.push("Review text must be 500 characters or less")),[[o.artistPerformanceFeedback,"Artist performance note must be 400 characters or less"],[o.productionFeedback,"Production note must be 400 characters or less"],[o.venueFeedback,"Venue note must be 400 characters or less"],[o.locationFeedback,"Location note must be 400 characters or less"],[o.valueFeedback,"Value note must be 400 characters or less"]].forEach(([Dt,ur])=>{Dt&&Dt.length>400&&Ce.push(ur)}),o.ticketPricePaid){const Dt=Number(o.ticketPricePaid);Number.isNaN(Dt)?Ce.push("Ticket price must be a valid number"):Dt<0&&Ce.push("Ticket price cannot be negative")}if(Ce.length>0){const Dt=Ce.length===1?Ce[0]:`Please complete the following:
 ${Ce.join(`
 `)}`;i({title:"Incomplete Review",description:Dt,variant:"destructive",duration:6e3});return}let Tt=q(Z)?Z:q(e.id)?e.id:Z||e.id,at;try{const Dt=o.selectedArtist||(e==null?void 0:e.artist)||null,ur=(Dt==null?void 0:Dt.id)||((ft=(Fe=(yt=Dt==null?void 0:Dt.identifier)==null?void 0:yt.split)==null?void 0:Fe.call(yt,":"))==null?void 0:ft[1]);if(console.log(" EventReviewForm: Artist resolution - candidate:",Dt,"jambaseArtistId:",ur),ur){if(console.log(" EventReviewForm: Looking up artist with jambaseArtistId:",ur),Dt!=null&&Dt.identifier){const{data:or}=yield T.from("artists").select("id").eq("identifier",Dt.identifier).limit(1).maybeSingle();or&&(at=or.id,console.log(" EventReviewForm: Found existing artist by identifier:",at))}if(!at&&(Dt!=null&&Dt.name)){const{data:or}=yield T.from("artists").select("id").ilike("name",Dt.name).limit(1).maybeSingle();or&&(at=or.id,console.log(" EventReviewForm: Found existing artist by name:",at))}at||console.log(" EventReviewForm: Artist not found in database")}}catch(Dt){}let ue=(Et=o.selectedVenue)!=null&&Et.is_from_database?o.selectedVenue.id:void 0;if(!ue&&o.selectedVenue)try{const Dt=o.selectedVenue.identifier,ur=typeof Dt=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Dt);let or;if(ur){const Wt=yield T.from("venues").select("id").eq("identifier",Dt).limit(1);or=Array.isArray(Wt.data)&&Wt.data.length>0?Wt.data[0].id:void 0}if(or)ue=or;else{const Wt=yield T.from("venues").select("id").ilike("name",`%${o.selectedVenue.name}%`).limit(1);or=Array.isArray(Wt.data)&&Wt.data.length>0?Wt.data[0].id:void 0,or&&(ue=or)}}catch(Dt){}ue&&!q(ue)&&(ue=void 0);const qe=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Tt),Ct=!qe||((hr=e==null?void 0:e.id)==null?void 0:hr.startsWith("new-review")),ct=o.selectedArtist&&S&&o.selectedArtist.name!==(S.artist_name||(e==null?void 0:e.artist_name)),pt=o.selectedVenue&&S&&o.selectedVenue.name!==(S.venue_name||(e==null?void 0:e.venue_name)),At=Ct||ct||pt;if(qe&&!((dr=e==null?void 0:e.id)!=null&&dr.startsWith("new-review"))&&!At&&o.eventDate&&o.eventDate.trim()!=="")try{const Dt=new Date(o.eventDate+"T20:00:00Z");if(!isNaN(Dt.getTime())){const{data:ur}=yield T.from("events").select("event_date").eq("id",Tt).single();if(ur){const or=new Date(ur.event_date),Wt=Dt;Math.abs((Wt.getTime()-or.getTime())/(1e3*60*60*24))>1&&(console.log(" Updating event date from",or,"to",Wt),yield T.from("events").update({event_date:Dt.toISOString()}).eq("id",Tt))}}}catch(Dt){console.error(" Error updating event date:",Dt)}if(At)try{if(!o.eventDate||o.eventDate.trim()==="")throw new Error("Event date is required");const Dt=new Date(o.eventDate+"T20:00:00Z");if(isNaN(Dt.getTime()))throw new Error(`Invalid event date: ${o.eventDate}`);const ur=(cn=o.selectedVenue)!=null&&cn.is_from_database&&q(o.selectedVenue.id)?o.selectedVenue.id:null,or=(mn=o.selectedArtist)==null?void 0:mn.is_from_database,Wt=at||(or&&q((je=o.selectedArtist)==null?void 0:je.id)?o.selectedArtist.id:null);let Sr=V(D(D({title:`${((pe=o.selectedArtist)==null?void 0:pe.name)||"Concert"} at ${((Pe=o.selectedVenue)==null?void 0:Pe.name)||"Venue"}`},Wt?{artist_id:Wt}:{}),ur?{venue_id:ur}:{}),{venue_city:((Ye=(Ne=o.selectedVenue)==null?void 0:Ne.address)==null?void 0:Ye.addressLocality)||"Unknown",venue_state:((It=(We=o.selectedVenue)==null?void 0:We.address)==null?void 0:It.addressRegion)||"Unknown",event_date:Dt.toISOString(),description:`Concert by ${((jt=o.selectedArtist)==null?void 0:jt.name)||""} at ${((Ee=o.selectedVenue)==null?void 0:Ee.name)||""}`}),yn={data:null,error:null};try{const{MissingEntityRequestService:nr}=yield Rr(()=>E(this,null,function*(){const{MissingEntityRequestService:Cr}=yield import("./missingEntityRequestService-DnUo_jW_.js");return{MissingEntityRequestService:Cr}}),[],import.meta.url);yield nr.submitRequest({entity_type:"event",entity_name:Sr.title,entity_date:Sr.event_date,entity_location:`${Sr.venue_city}, ${Sr.venue_state}`,additional_info:{artist_id:Wt,venue_id:ur}}),console.log(" Submitted request for missing event:",Sr.title),i({title:"Event Request Submitted",description:"Your event request has been submitted for review. You can still write your review."}),yn.data={id:`pending-${Date.now()}`}}catch(nr){console.error(" Error submitting event request:",nr),yn.error=nr,i({title:"Request Submission Failed",description:"Could not submit event request, but you can still write your review.",variant:"destructive"})}if(!yn.error&&ue?console.log(" EventReviewForm: VenueId resolved for ReviewService:",ue):console.log(" EventReviewForm: No venueId resolved:",{venueId:ue,hasError:!!yn.error}),yn.error)throw yn.error;Tt=yn.data.id,ne(yn.data.id),S&&(ct||pt)&&(console.log(" EventReviewForm: Artist/venue changed, deleting old review and creating new one"),yield T.from("reviews").delete().eq("id",S.id),k(null))}catch(Dt){console.error("Error creating event:",Dt),i({title:"Error",description:"Failed to create event entry. Please try again.",variant:"destructive"});return}f(!0),H(!0);try{const Dt=C.length?`

Show rankings:
${C.slice().sort((tr,Mr)=>Mr.rating-tr.rating||tr.order-Mr.order).map((tr,Mr)=>`${Mr+1}. ${tr.show_name||"Show"}${tr.show_date?` (${tr.show_date})`:""}${tr.venue_name?` @ ${tr.venue_name}`:""}  ${tr.rating}/5${C.filter(un=>un.rating===tr.rating).length>1?` [tie #${tr.order}]`:""}`).join(`
`)}
        `:"",ur=N||"detailed";let or;if(ur==="quick")or=typeof o.rating=="number"&&o.rating>0?o.rating:void 0;else if(ur==="standard"){const tr=[o.artistPerformanceRating,o.venueRating].filter(Mr=>typeof Mr=="number"&&Mr>0);or=tr.length>0?Number((tr.reduce((Mr,un)=>Mr+un,0)/tr.length).toFixed(1)):typeof o.rating=="number"&&o.rating>0?o.rating:void 0}else{const tr=[o.artistPerformanceRating,o.productionRating,o.venueRating,o.locationRating,o.valueRating].filter(Mr=>typeof Mr=="number"&&Mr>0);or=tr.length>0?Number((tr.reduce((Mr,un)=>Mr+un,0)/tr.length).toFixed(1)):typeof o.rating=="number"&&o.rating>0?o.rating:void 0}const Wt=o.ticketPricePaid?Number(o.ticketPricePaid):void 0;let Sr;ur==="quick"?Sr=typeof or=="number"&&or>0?Number(or.toFixed(1)):void 0:Sr=typeof o.artistPerformanceRating=="number"&&o.artistPerformanceRating>0?Number(o.artistPerformanceRating.toFixed(1)):void 0;const yn=typeof o.productionRating=="number"&&o.productionRating>0?Number(o.productionRating.toFixed(1)):void 0,nr=typeof o.venueRating=="number"&&o.venueRating>0?Number(o.venueRating.toFixed(1)):void 0,Cr=typeof o.locationRating=="number"&&o.locationRating>0?Number(o.locationRating.toFixed(1)):void 0,Cn=typeof o.valueRating=="number"&&o.valueRating>0?Number(o.valueRating.toFixed(1)):void 0,Ht=((rt=o.artistPerformanceFeedback)==null?void 0:rt.trim())||void 0,cr=((ir=o.productionFeedback)==null?void 0:ir.trim())||void 0,In=((rn=o.venueFeedback)==null?void 0:rn.trim())||void 0,bs=((Mt=o.locationFeedback)==null?void 0:Mt.trim())||void 0,is=((ye=o.valueFeedback)==null?void 0:ye.trim())||void 0,zr={review_type:"event",rating:typeof or=="number"&&or>0?or:void 0,artist_performance_rating:Sr,production_rating:yn,venue_rating:nr,location_rating:Cr,value_rating:Cn,artist_performance_feedback:Ht,production_feedback:cr,venue_feedback:In,location_feedback:bs,value_feedback:is,ticket_price_paid:typeof Wt=="number"&&!Number.isNaN(Wt)?Wt:void 0,review_text:(o.reviewText.trim()+Dt).trim()||void 0,photos:o.photos&&o.photos.length>0?o.photos:void 0,videos:o.videos&&o.videos.length>0?o.videos:void 0,setlist:o.selectedSetlist!==void 0?o.selectedSetlist:(S==null?void 0:S.setlist)||void 0,custom_setlist:o.customSetlist&&o.customSetlist.length>0?o.customSetlist:void 0,is_public:o.isPublic};console.log(" EventReviewForm: Review data being saved:",{rating:zr.rating,decimalAverage:or,hasSetlist:!!zr.setlist,setlistData:zr.setlist,formDataSelectedSetlist:o.selectedSetlist,hasCustomSetlist:!!zr.custom_setlist,customSetlistSongCount:((Ie=zr.custom_setlist)==null?void 0:Ie.length)||0,categoryRatings:{artist_performance_rating:zr.artist_performance_rating,production_rating:zr.production_rating,venue_rating:zr.venue_rating,location_rating:zr.location_rating,value_rating:zr.value_rating},categoryFeedback:{artist_performance_feedback:zr.artist_performance_feedback,production_feedback:zr.production_feedback,venue_feedback:zr.venue_feedback,location_feedback:zr.location_feedback,value_feedback:zr.value_feedback},formDataRatings:{artistPerformanceRating:o.artistPerformanceRating,productionRating:o.productionRating,venueRating:o.venueRating,locationRating:o.locationRating,valueRating:o.valueRating},formDataFeedback:{artistPerformanceFeedback:o.artistPerformanceFeedback,productionFeedback:o.productionFeedback,venueFeedback:o.venueFeedback,locationFeedback:o.locationFeedback,valueFeedback:o.valueFeedback}});let Or=(dt=o.selectedVenue)!=null&&dt.is_from_database?o.selectedVenue.id:void 0;if(!Or&&o.selectedVenue)try{const tr=o.selectedVenue.identifier,Mr=typeof tr=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(tr);let un;if(Mr){const Rn=yield T.from("venues").select("id").eq("identifier",tr).limit(1);un=Array.isArray(Rn.data)&&Rn.data.length>0?Rn.data[0].id:void 0}if(un)Or=un;else{const Rn=yield T.from("venues").select("id").ilike("name",`%${o.selectedVenue.name}%`).limit(1),Es=Array.isArray(Rn.data)&&Rn.data.length>0?Rn.data[0].id:void 0;if(Es)Or=Es;else{const Qa=`user-created-${Date.now()}`;if(!(yield T.from("venues").insert({jambase_venue_id:Qa,name:o.selectedVenue.name,identifier:Mr?tr:`user-created-${o.selectedVenue.name.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`,address:typeof o.selectedVenue.address=="string"?o.selectedVenue.address:((wt=o.selectedVenue.address)==null?void 0:wt.streetAddress)||null,city:((ht=o.selectedVenue.address)==null?void 0:ht.addressLocality)||null,state:((Le=o.selectedVenue.address)==null?void 0:Le.addressRegion)||null,zip:((Xe=o.selectedVenue.address)==null?void 0:Xe.postalCode)||null,country:((ke=o.selectedVenue.address)==null?void 0:ke.addressCountry)||"US",latitude:((St=o.selectedVenue.geo)==null?void 0:St.latitude)||null,longitude:((_t=o.selectedVenue.geo)==null?void 0:_t.longitude)||null,image_url:o.selectedVenue.image_url||null,url:o.selectedVenue.url||null,date_published:new Date().toISOString(),date_modified:new Date().toISOString()})).error){if(Mr){const js=yield T.from("venues").select("id").eq("identifier",tr).limit(1);Array.isArray(js.data)&&js.data.length>0&&(Or=js.data[0].id)}if(!Or){const js=yield T.from("venues").select("id").ilike("name",`%${o.selectedVenue.name}%`).limit(1);Array.isArray(js.data)&&js.data.length>0&&(Or=js.data[0].id)}}}}}catch(tr){}Or&&!q(Or)&&(Or=void 0);const An=q(Tt)?Tt:void 0,Br=Or&&q(Or)?Or:void 0,zn=at&&q(at)?at:void 0;if(!An&&(!zn||!Br))throw new Error("Unable to determine a valid event ID or artist+venue combination for this review.");let la;if(o.eventDate&&o.eventDate.trim()!==""){const tr=new Date(o.eventDate+"T00:00:00Z");isNaN(tr.getTime())||(la=tr)}else e!=null&&e.event_date&&(la=new Date(e.event_date));const Da=D(D({},zr),la?{Event_date:la}:{}),Tn=yield cs.setEventReview(t,An,Da,Br,zn);An&&ae(An);try{console.log(" EventReviewForm: Starting NUCLEAR draft deletion:",{eventId:An,artistId:zn,venueId:Br});let tr=T.from("reviews").delete().eq("user_id",t).eq("is_draft",!0);An?tr=tr.eq("event_id",An):zn&&Br&&(tr=tr.eq("artist_id",zn).eq("venue_id",Br).is("event_id",null)),tr=tr.select("id");const{error:Mr,data:un}=yield tr;if(Mr)console.error(" EventReviewForm: First deletion failed:",Mr);else{const Es=(un==null?void 0:un.length)||0;console.log(` EventReviewForm: Deleted ${Es} draft(s)`)}if((Fr=o.selectedArtist)!=null&&Fr.name&&((dn=o.selectedVenue)!=null&&dn.name)&&o.eventDate){console.log(" EventReviewForm: Looking for matching drafts by artist/venue/date...");const{data:Es,error:Qa}=yield T.from("reviews").select("id, event_id, draft_data, is_draft").eq("user_id",t).eq("is_draft",!0);if(!Qa&&Es){const xa=Es.filter(js=>{var du,Kc,Yl,Zc;if(!js.draft_data)return!1;const os=js.draft_data,_a=((du=os==null?void 0:os.selectedArtist)==null?void 0:du.name)||(os==null?void 0:os.artist_name),jr=((Kc=os==null?void 0:os.selectedVenue)==null?void 0:Kc.name)||(os==null?void 0:os.venue_name),Ia=os==null?void 0:os.eventDate,pn=_a===((Yl=o.selectedArtist)==null?void 0:Yl.name)&&jr===((Zc=o.selectedVenue)==null?void 0:Zc.name)&&Ia===o.eventDate;return pn&&console.log(` EventReviewForm: Found matching draft ${js.id} for same concert (different event_id)`),pn});for(const js of xa)console.log(` EventReviewForm: Deleting matching draft ${js.id}`),yield T.from("reviews").delete().eq("id",js.id);xa.length>0&&console.log(` EventReviewForm: Deleted ${xa.length} matching draft(s) for same concert`)}}yield new Promise(Es=>setTimeout(Es,200));const Rn=yield T.from("reviews").select("id, is_draft").eq("user_id",t).eq("event_id",Tt).eq("is_draft",!0);Rn.data&&Rn.data.length>0?(console.error(` EventReviewForm: ${Rn.data.length} draft(s) STILL EXIST! Force deleting...`,Rn.data),yield T.from("reviews").delete().eq("user_id",t).eq("event_id",Tt).eq("is_draft",!0)):console.log(" EventReviewForm: Verified - all drafts for this event successfully deleted")}catch(tr){console.error(" EventReviewForm: CRITICAL error during draft deletion:",tr)}try{const tr=Tn.id||"unknown",Mr=q(Tn.id)?Tn.id:null;let un,Rn,Es=null;zn?(un="artist",Rn=zn,Es=zn):Br?(un="venue",Rn=Br,Es=Br):An&&(un="event",Rn=An,Es=An);const Qa={artist_performance_rating:zr.artist_performance_rating,production_rating:zr.production_rating,venue_rating:zr.venue_rating,location_rating:zr.location_rating,value_rating:zr.value_rating,is_public:zr.is_public,has_text:!!zr.review_text,text_length:((En=zr.review_text)==null?void 0:En.length)||0,reviewType:o.reviewType};if(un&&Rn&&(Qa.reviewed_entity_type=un,Qa.reviewed_entity_id=Rn),e){const{getEventMetadata:js}=yield Rr(()=>E(this,null,function*(){const{getEventMetadata:_a}=yield Promise.resolve().then(()=>U2);return{getEventMetadata:_a}}),void 0,import.meta.url),os=js(e);Object.assign(Qa,os)}Zt.review("review",tr,zr.rating,Qa,Mr);const xa={reviewType:o.reviewType};un&&Rn&&(xa.reviewed_entity_type=un,xa.reviewed_entity_id=Rn),Zt.formSubmit("review",tr,!0,xa,Mr)}catch(tr){}if(i({title:S?"Review Updated":"Review Submitted! ",description:S?"Your review has been updated.":"Thanks for sharing your concert experience!"}),o.attendees&&o.attendees.length>0){const tr=o.attendees.filter(Mr=>Mr.type==="phone").map(Mr=>Mr.phone);if(tr.length>0)try{const{data:Mr}=yield T.from("users").select("name").eq("user_id",t).single(),un=(Mr==null?void 0:Mr.name)||"A friend";yield uue.sendReviewInvitations(tr,Tn.id,un)}catch(Mr){console.error("Failed to send SMS invitations:",Mr)}}if(S){if(r){console.log(" Calling onSubmitted callback immediately after edit");const tr=r(Tn);tr instanceof Promise&&(yield tr)}}else{console.log(" New review submitted, checking if we should show ranking modal"),console.log("  Review data:",{id:Tn.id,rating:Tn.rating,artist_performance_rating:Tn.artist_performance_rating,production_rating:Tn.production_rating,venue_rating:Tn.venue_rating,location_rating:Tn.location_rating,value_rating:Tn.value_rating});const tr=[Tn.artist_performance_rating,Tn.production_rating,Tn.venue_rating,Tn.location_rating,Tn.value_rating].filter(un=>typeof un=="number"&&un>0),Mr=tr.length===5?tr.reduce((un,Rn)=>un+Rn,0)/tr.length:Tn.rating;console.log("  Effective rating for modal:",Mr),console.log("  Opening ranking modal with review ID:",Tn.id),console.log("   Deferring onSubmitted callback until ranking modal closes to avoid unmounting component"),O(Tn),setTimeout(()=>{R(!0),console.log("   Modal state updated:",{showRankingModal:!0,submittedReview:Tn.id})},100)}}catch(Dt){const ur=Dt instanceof Error?Dt.message:String(Dt);console.error("Error submitting review:",Dt),i({title:"Error",description:`Failed to submit review: ${ur}`,variant:"destructive"}),H(!1)}finally{f(!1)}}),ve=()=>E(this,null,function*(){console.log(" Ranking modal closing"),R(!1);const Ce=I;if(O(null),u(),H(!1),r&&Ce){console.log(" Calling onSubmitted callback after ranking modal close");const Ge=r(Ce);Ge instanceof Promise&&(yield Ge)}}),me=()=>{const Ce=[o.artistPerformanceRating,o.productionRating,o.venueRating,o.locationRating,o.valueRating].filter(Ge=>typeof Ge=="number"&&Ge>0);return Ce.length>0?Ce.reduce((Ge,Nt)=>Ge+Nt,0)/Ce.length:o.rating},Me=me(),Te=b||Zh,Ve=Math.min(100,Math.max(0,Math.round(m/Te*100))),le=rS(N||"detailed"),Ke=m<Te&&le[m]?le[m]:null,De=[{label:"Artist performance",rating:o.artistPerformanceRating,annotation:o.artistPerformanceFeedback},{label:"Production quality",rating:o.productionRating,annotation:o.productionFeedback},{label:"Venue experience",rating:o.venueRating,annotation:o.venueFeedback},{label:"Location & logistics",rating:o.locationRating,annotation:o.locationFeedback},{label:"Value for ticket",rating:o.valueRating,annotation:o.valueFeedback}],nt=()=>{var Ge,Nt,Tt,at;const Ce=((Ge=o.selectedArtist)==null?void 0:Ge.name)&&o.eventDate;return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs(ce,{type:"button",variant:"outline",onClick:()=>de(!0),disabled:!Ce,className:"border-pink-200 text-pink-600 hover:bg-pink-50 w-full sm:w-auto",children:[s.jsx(Ft,{className:"w-4 h-4 mr-2"}),"Import from setlist.fm"]}),o.selectedSetlist&&s.jsx(ce,{type:"button",variant:"ghost",onClick:ie,className:"text-gray-500 hover:text-gray-700 w-full sm:w-auto",children:"Clear setlist"})]}),!Ce&&s.jsx("p",{className:"text-xs text-gray-500",children:"Select an artist (and date if you know it) to search official setlists."}),o.selectedSetlist?s.jsxs("div",{className:"rounded-xl border border-pink-100 bg-pink-50/40 p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:((Nt=o.selectedSetlist.artist)==null?void 0:Nt.name)||((Tt=o.selectedArtist)==null?void 0:Tt.name)}),s.jsxs("p",{className:"text-xs text-gray-600",children:[(at=o.selectedSetlist.venue)==null?void 0:at.name,o.selectedSetlist.eventDate&&s.jsxs(s.Fragment,{children:["  ",Q(o.selectedSetlist.eventDate)]})]})]}),s.jsxs(et,{variant:"secondary",className:"bg-white text-pink-600 border-pink-100",children:[o.selectedSetlist.songCount," songs"]})]}),s.jsx("ul",{className:"grid gap-1 text-xs text-gray-700 sm:grid-cols-2",children:(o.selectedSetlist.songs||[]).slice(0,8).map((ue,qe)=>{var Ct;return s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsxs("span",{className:"font-medium text-pink-600",children:[qe+1,"."]}),s.jsxs("span",{className:"flex-1",children:[ue.name,((Ct=ue.cover)==null?void 0:Ct.artist)&&s.jsxs("span",{className:"block text-[11px] text-gray-500",children:["Cover: ",ue.cover.artist]})]})]},`${ue.name}-${qe}`)})}),Array.isArray(o.selectedSetlist.songs)&&o.selectedSetlist.songs.length>8&&s.jsxs("p",{className:"text-[11px] text-gray-500",children:["+",o.selectedSetlist.songs.length-8," more in the setlist"]})]}):s.jsx("p",{className:"text-xs text-gray-500",children:"Can't find it? Add your own setlist below so other fans know what was played."}),s.jsx(T2,{songs:o.customSetlist||[],onChange:ee,disabled:!!o.selectedSetlist,className:"mt-2"})]})},ze=()=>{var Ge,Nt,Tt,at;const Ce=!!((Ge=o.selectedArtist)!=null&&Ge.name);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[s.jsxs(ce,{type:"button",variant:"outline",onClick:()=>de(!0),disabled:!Ce,className:"border-pink-200 text-pink-600 hover:bg-pink-50 w-full sm:w-auto",children:[s.jsx(Ft,{className:"w-4 h-4 mr-2"}),"Import from setlist.fm"]}),o.selectedSetlist&&s.jsx(ce,{type:"button",variant:"ghost",onClick:ie,className:"text-gray-500 hover:text-gray-700 w-full sm:w-auto",children:"Clear setlist"})]}),!Ce&&s.jsx("p",{className:"text-xs text-gray-500",children:"Select an artist (and date if you know it) to search official setlists."}),o.selectedSetlist?s.jsxs("div",{className:"rounded-xl border border-pink-100 bg-pink-50/40 p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:((Nt=o.selectedSetlist.artist)==null?void 0:Nt.name)||((Tt=o.selectedArtist)==null?void 0:Tt.name)}),s.jsxs("p",{className:"text-xs text-gray-600",children:[(at=o.selectedSetlist.venue)==null?void 0:at.name,o.selectedSetlist.eventDate&&s.jsxs(s.Fragment,{children:["  ",Q(o.selectedSetlist.eventDate)]})]})]}),s.jsxs(et,{variant:"secondary",className:"bg-white text-pink-600 border-pink-100",children:[o.selectedSetlist.songCount," songs"]})]}),s.jsx("ul",{className:"grid gap-1 text-xs text-gray-700 sm:grid-cols-2",children:(o.selectedSetlist.songs||[]).slice(0,8).map((ue,qe)=>{var Ct;return s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsxs("span",{className:"font-medium text-pink-600",children:[qe+1,"."]}),s.jsxs("span",{className:"flex-1",children:[ue.name,((Ct=ue.cover)==null?void 0:Ct.artist)&&s.jsxs("span",{className:"block text-[11px] text-gray-500",children:["Cover: ",ue.cover.artist]})]})]},`${ue.name}-${qe}`)})}),Array.isArray(o.selectedSetlist.songs)&&o.selectedSetlist.songs.length>8&&s.jsxs("p",{className:"text-[11px] text-gray-500",children:["+",o.selectedSetlist.songs.length-8," more in the setlist"]})]}):s.jsx("p",{className:"text-xs text-gray-500",children:"Cant find it? Add your own setlist below so other fans know what was played."}),s.jsx(T2,{songs:o.customSetlist||[],onChange:ee,disabled:!!o.selectedSetlist,className:"mt-2"})]})},vt=()=>{var Ge,Nt;const Ce=N||"detailed";if(m===1)return s.jsx(Mde,{reviewDuration:o.reviewDuration,onSelectDuration:Tt=>{d({reviewDuration:Tt}),setTimeout(()=>v(),100)}});switch(Ce){case"quick":if(m===2)return s.jsx(eS,{formData:o,errors:l,onUpdateFormData:d});if(m===3)return s.jsx(Gde,{formData:o,errors:l,onUpdateFormData:d,artistName:(Ge=o.selectedArtist)==null?void 0:Ge.name,venueName:(Nt=o.selectedVenue)==null?void 0:Nt.name,eventDate:o.eventDate});if(m===4)return s.jsx(tS,{formData:o,errors:l,onUpdateFormData:d,onSubmit:we,isLoading:c,averageRating:o.rating,categoryBreakdown:[]});break;case"standard":if(m===2)return s.jsx(eS,{formData:o,errors:l,onUpdateFormData:d});if(m===3)return s.jsx(mu,{config:fe[2],formData:o,errors:l,onUpdateFormData:d,children:ze()});if(m===4)return s.jsx(mu,{config:fe[4],formData:o,errors:l,onUpdateFormData:d,previousVenueReview:_e});if(m===5)return s.jsxs(s.Fragment,{children:[s.jsx(KM,{formData:o,errors:l,onUpdateFormData:d,maxCharacters:400}),s.jsxs("div",{className:"mt-8 space-y-4",children:[s.jsx(qt,{className:"text-base font-semibold text-gray-900",children:"Setlist (Optional)"}),nt()]})]});if(m===6){const Tt=o.artistPerformanceRating>0&&o.venueRating>0?(o.artistPerformanceRating+o.venueRating)/2:o.rating;return s.jsx(tS,{formData:o,errors:l,onUpdateFormData:d,onSubmit:we,isLoading:c,averageRating:Tt,categoryBreakdown:[{label:"Artist Performance",rating:o.artistPerformanceRating},{label:"Venue",rating:o.venueRating}]})}break;case"detailed":if(m===2)return s.jsx(eS,{formData:o,errors:l,onUpdateFormData:d});if(m===3)return s.jsx(mu,{config:fe[2],formData:o,errors:l,onUpdateFormData:d,children:ze()});if(m===4)return s.jsx(mu,{config:fe[3],formData:o,errors:l,onUpdateFormData:d});if(m===5)return s.jsx(mu,{config:fe[4],formData:o,errors:l,onUpdateFormData:d,previousVenueReview:_e});if(m===6)return s.jsx(mu,{config:fe[5],formData:o,errors:l,onUpdateFormData:d,previousVenueReview:_e});if(m===7)return s.jsx(mu,{config:fe[6],formData:o,errors:l,onUpdateFormData:d,children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs(qt,{htmlFor:"ticketPricePaid",className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Do,{className:"w-4 h-4 text-pink-500"}),"What did you pay? (kept private)"]}),s.jsx(Nr,{id:"ticketPricePaid",type:"number",min:"0",step:"0.01",placeholder:"e.g. 78.50",value:o.ticketPricePaid,onChange:Tt=>d({ticketPricePaid:Tt.target.value})}),s.jsx("p",{className:"text-xs text-gray-500",children:"Only you can see this number. It helps calibrate value for other fans."})]})});if(m===8)return s.jsxs(s.Fragment,{children:[s.jsx(KM,{formData:o,errors:l,onUpdateFormData:d,maxCharacters:500}),s.jsxs("div",{className:"mt-8 space-y-4",children:[s.jsx(qt,{className:"text-base font-semibold text-gray-900",children:"Setlist (Optional)"}),nt()]})]});if(m===9)return s.jsx(tS,{formData:o,errors:l,onUpdateFormData:d,onSubmit:we,isLoading:c,averageRating:Me,categoryBreakdown:De});break}return null};return console.log(" EventReviewForm render state:",{existingReview:!!S,isLoading:c,actualEventId:Z,hasFormData:!!o}),s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-6 space-y-6 sm:space-y-8 w-full max-w-full overflow-x-hidden",children:[!S&&s.jsx(due,{userId:t,onSelectDraft:Ce=>{X(Ce),Ce.draft_data&&h(Ce.draft_data),a&&a()},onNewReview:()=>{X(null),u(),H(!1)},currentMode:Y?"draft":"new"}),!S&&s.jsx("div",{className:"p-3 rounded-lg w-full max-w-full overflow-x-hidden",style:{backgroundColor:"var(--brand-pink-050)",border:"1px solid var(--brand-pink-500)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsxs("div",{className:"flex items-center gap-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)"},children:[s.jsx("div",{className:"flex-shrink-0",style:{width:"var(--spacing-inline, 6px)",height:"var(--spacing-inline, 6px)",backgroundColor:"var(--brand-pink-500)",borderRadius:"999px"}}),s.jsx("span",{className:"break-words",children:"Your progress is automatically saved locally"})]})}),s.jsx("div",{className:"space-y-3 sm:space-y-4 w-full max-w-full overflow-x-hidden",children:m!==1&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[s.jsxs("div",{className:"min-w-0",children:[s.jsxs("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:["Step ",m," of ",b||Zh]}),s.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mt-1 break-words",children:rS(N||"detailed")[m-1]||"Review"})]}),s.jsx("div",{className:"w-full sm:w-48 h-2 overflow-hidden flex-shrink-0",style:{backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all duration-300",style:{width:`${Ve}%`,backgroundColor:"var(--brand-pink-500)",borderRadius:"var(--radius-corner, 10px)"}})})]}),s.jsx("div",{className:"flex flex-wrap gap-2 w-full max-w-full overflow-x-hidden",children:rS(N||"detailed").map((Ce,Ge)=>{const Nt=Ge+1,Tt=Nt===m,at=Nt<m;return s.jsxs("span",{className:Oe("px-2 sm:px-3 py-1 rounded-full text-xs font-medium transition-colors flex-shrink-0",Tt?"bg-pink-500 text-white shadow-sm":at?"bg-pink-100 text-pink-700":"bg-gray-100 text-gray-500"),children:[Nt,". ",Ce]},`${Ce}-${Ge}`)})})]})}),s.jsx("div",{className:"min-h-[420px] w-full max-w-full overflow-x-hidden",children:vt()}),s.jsxs("div",{className:"space-y-3 sm:space-y-4 border-t pt-3 sm:pt-4 w-full max-w-full overflow-x-hidden",children:[s.jsx("div",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-center justify-between gap-2 w-full",children:[s.jsx(ce,{variant:"ghost",onClick:g,disabled:!_,className:"flex-shrink-0",size:"sm",children:"Back"}),s.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500 flex-shrink-0",children:z?s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"animate-pulse flex-shrink-0",style:{width:"var(--spacing-inline, 6px)",height:"var(--spacing-inline, 6px)",backgroundColor:"var(--rating-star)",borderRadius:"999px"}}),s.jsx("span",{className:"whitespace-nowrap",children:"Auto-saving"})]}):B?s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"flex-shrink-0",style:{width:"var(--spacing-inline, 6px)",height:"var(--spacing-inline, 6px)",backgroundColor:"var(--status-success-500)",borderRadius:"999px"}}),s.jsxs("span",{className:"whitespace-nowrap hidden sm:inline",children:["Auto-saved ",B.toLocaleTimeString()]}),s.jsx("span",{className:"whitespace-nowrap sm:hidden",children:"Saved"})]}):s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"flex-shrink-0",style:{width:"var(--spacing-inline, 6px)",height:"var(--spacing-inline, 6px)",backgroundColor:"var(--neutral-400)",borderRadius:"999px"}}),s.jsx("span",{className:"whitespace-nowrap hidden sm:inline",children:"Auto-save active"}),s.jsx("span",{className:"whitespace-nowrap sm:hidden",children:"Saved"})]})}),m<(b||Zh)&&s.jsxs(ce,{onClick:v,disabled:!x,className:"bg-pink-500 hover:bg-pink-600 flex-shrink-0",size:"sm",children:["Next",Ke?`: ${Ke}`:""]})]})}),S&&s.jsx("div",{className:"flex justify-end",children:s.jsx(ce,{variant:"outline",onClick:()=>E(this,null,function*(){console.log(" Deleting review:",{reviewId:S==null?void 0:S.id,eventId:e.id,userId:t});try{if(!(S!=null&&S.id))throw new Error("No review ID found");yield cs.deleteEventReview(t,S.id),console.log(" Review deleted successfully");try{Zt.click("review",e.id,{action:"delete",source:"event_review_form"},e.id)}catch(Ce){}if(i({title:"Review Deleted",description:"Your review has been deleted."}),k(null),u(),H(!1),n){console.log(" Calling onDeleted callback");const Ce=n();Ce instanceof Promise&&(yield Ce)}}catch(Ce){console.error(" Error deleting review:",Ce);const Ge=Ce instanceof Error?Ce.message:"Unknown error";i({title:"Error",description:`Failed to delete review: ${Ge}`,variant:"destructive"})}}),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:"Delete Review"})})]})]}),s.jsx(hB,{isOpen:se,onClose:()=>de(!1),artistName:((Ue=o.selectedArtist)==null?void 0:Ue.name)||"",venueName:((gt=o.selectedVenue)==null?void 0:gt.name)||void 0,eventDate:o.eventDate||void 0,onSetlistSelect:oe}),I&&s.jsx(Yde,{isOpen:A,onClose:ve,userId:t,newReview:I,rating:me()})]})}function CB({event:e,userId:t,isOpen:r,onClose:n,onReviewSubmitted:a}){if(!e&&!r)return null;const i=()=>{n()},o=e&&"title"in e?e.title:e&&"event_name"in e?e.event_name:"Create Review";return s.jsx(vn,{open:r,onOpenChange:i,children:s.jsxs(hn,{children:[s.jsx(Hn,{children:s.jsx(Sn,{children:o})}),s.jsx(p8,{children:s.jsx(EB,{event:e,userId:t,onSubmitted:l=>E(this,null,function*(){if(a){const c=a(l);c instanceof Promise&&(yield c)}n()}),onDeleted:()=>E(this,null,function*(){if(a){const l=a(null);l instanceof Promise&&(yield l)}n()})})})]})})}function go(e,t,r,n,a={}){const{enabled:i=!0,delay:o=0}=a,l=y.useRef(!1);y.useEffect(()=>{if(!i||l.current||!t)return;const c=()=>{try{Zt.view(e,t,void 0,V(D({},r),{tracked_via:"useViewTracking"}),n||void 0),l.current=!0}catch(d){console.error("Error tracking view:",d)}};if(o>0){const d=setTimeout(c,o);return()=>clearTimeout(d)}else c()},[e,t,n,i,o])}function PT({accountType:e,verified:t,size:r="md",className:n="",showTooltip:a=!0}){if(!t)return null;const i=coe(e),o=i.icon,l={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"},c=s.jsx("div",{className:`inline-flex items-center justify-center ${l[r]} ${n}`,style:{background:`linear-gradient(135deg, ${i.colors.from}, ${i.colors.to})`,borderRadius:"50%",padding:"2px"},children:s.jsx(o,{className:"w-full h-full text-white",strokeWidth:2.5,fill:"white"})});return a?s.jsx(QP,{children:s.jsxs(Gz,{children:[s.jsx(Yz,{asChild:!0,children:c}),s.jsx(eT,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"font-semibold",children:i.label}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1 max-w-[200px]",children:i.description})]})})]})}):c}const PB=p1,vue=g1,TB=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(bp,V(D({className:Oe("fixed inset-0 z-[9999] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),style:D({backgroundColor:"var(--overlay-50, rgba(14, 14, 14, 0.5))",backdropFilter:"blur(8px)"},t.style)},t),{ref:r}))});TB.displayName=bp.displayName;const yue=mp("fixed z-[9999] gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),TT=y.forwardRef((i,a)=>{var o=i,{side:e="right",className:t,children:r}=o,n=ge(o,["side","className","children"]);return s.jsxs(vue,{children:[s.jsx(TB,{}),s.jsxs(jp,V(D({ref:a,className:Oe(yue({side:e}),t)},n),{children:[r,s.jsxs(v1,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[s.jsx(Yr,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]}))]})});TT.displayName=jp.displayName;const AT=r=>{var n=r,{className:e}=n,t=ge(n,["className"]);return s.jsx("div",D({className:Oe("flex flex-col space-y-2 text-center sm:text-left",e)},t))};AT.displayName="SheetHeader";const RT=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(Qy,D({ref:r,className:Oe("text-lg font-semibold text-foreground",e)},t))});RT.displayName=Qy.displayName;const OT=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(e0,D({ref:r,className:Oe("text-sm text-muted-foreground",e)},t))});OT.displayName=e0.displayName;class Sd{static getShareTargets(t){return E(this,null,function*(){try{const{data:r,error:n}=yield bT(t);if(n)throw console.error("Error fetching share targets:",n),n;return(r||[]).map(i=>({id:i.id,name:i.chat_name,type:i.is_group_chat?"group":"direct",users:i.users||[],avatar_url:null}))}catch(r){throw console.error("Error getting share targets:",r),new Error(`Failed to get share targets: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getFriends(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_relationships").select("id, user_id, related_user_id, created_at").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`).order("created_at",{ascending:!1});if(n)throw console.error("Error fetching friends:",n),n;if(!r||r.length===0)return[];const a=r.map(l=>l.user_id===t?l.related_user_id:l.user_id),{data:i,error:o}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",a);if(o)throw console.error("Error fetching friend profiles:",o),o;return i||[]}catch(r){throw console.error("Error getting friends:",r),new Error(`Failed to get friends: ${r instanceof Error?r.message:"Unknown error"}`)}})}static shareEventToChat(t,r,n,a){return E(this,null,function*(){var i;try{const o=a||"Check out this event!",{data:l,error:c}=yield T.from("messages").insert({chat_id:r,sender_id:n,content:o,message_type:"event_share",shared_event_id:t,metadata:{custom_message:a,share_context:"in_app_share"}}).select("id, chat_id").single();if(c){if(console.error("Error creating share message:",c),c.code==="23503"||(i=c.message)!=null&&i.includes("foreign key")||c.code==="42703"){console.warn("FK constraint or column error, retrying without shared_event_id FK");const{data:d,error:f}=yield T.from("messages").insert({chat_id:r,sender_id:n,content:o,message_type:"event_share",shared_event_id:null,metadata:{custom_message:a,share_context:"in_app_share",event_id:t}}).select("id, chat_id").single();if(f)return{success:!1,error:"Failed to share event: "+(f.message||"Unknown error")};try{yield T.from("event_shares").insert({event_id:t,sharer_user_id:n,chat_id:r,message_id:d.id,share_type:"direct_chat"})}catch(u){console.warn("Failed to track event share in analytics (non-critical):",u)}return{success:!0,message_id:d.id,chat_id:d.chat_id}}return{success:!1,error:"Failed to share event: "+(c.message||"Unknown error")}}try{yield T.from("event_shares").insert({event_id:t,sharer_user_id:n,chat_id:r,message_id:l.id,share_type:"direct_chat"})}catch(d){console.warn("Failed to track event share in analytics (non-critical):",d)}return{success:!0,message_id:l.id,chat_id:l.chat_id}}catch(o){return console.error("Error sharing event to chat:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}})}static shareEventToMultipleChats(t,r,n,a){return E(this,null,function*(){const i=[];for(const c of r){const d=yield this.shareEventToChat(t,c,n,a);i.push(d)}const o=i.filter(c=>c.success).length,l=i.filter(c=>!c.success).length;return{successCount:o,failureCount:l,results:i}})}static shareEventToNewChat(t,r,n,a){return E(this,null,function*(){try{const{data:i,error:o}=yield T.rpc("create_direct_chat",{user1_id:n,user2_id:r});return o||!i?{success:!1,error:"Failed to create chat"}:yield this.shareEventToChat(t,i,n,a)}catch(i){return console.error("Error sharing event to new chat:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}})}static getEventShareStats(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_shares").select("share_type").eq("event_id",t);if(n)return console.error("Error fetching share stats:",n),{total_shares:0,direct_shares:0,group_shares:0};const a=(r==null?void 0:r.length)||0,i=(r==null?void 0:r.filter(l=>l.share_type==="direct_chat").length)||0,o=(r==null?void 0:r.filter(l=>l.share_type==="group_chat").length)||0;return{total_shares:a,direct_shares:i,group_shares:o}}catch(r){return console.error("Error getting event share stats:",r),{total_shares:0,direct_shares:0,group_shares:0}}})}static shareReviewToChat(t,r,n,a){return E(this,null,function*(){var i;try{const{data:o,error:l}=yield T.from("reviews").select("id, review_text, rating, event_id, user_id").eq("id",t).single();if(l||!o)return{success:!1,error:"Review not found"};const c=a||"Check out this review!",{data:d,error:f}=yield T.from("messages").insert({chat_id:r,sender_id:n,content:c,message_type:"review_share",shared_review_id:t,metadata:{custom_message:a,share_context:"in_app_share"}}).select("id, chat_id").single();if(f){if(console.error("Error creating review share message:",f),f.code==="23503"||(i=f.message)!=null&&i.includes("foreign key")||f.code==="42703"){console.warn("FK constraint or column error, retrying without shared_review_id FK");const{data:u,error:h}=yield T.from("messages").insert({chat_id:r,sender_id:n,content:c,message_type:"review_share",shared_review_id:null,metadata:{custom_message:a,share_context:"in_app_share",review_id:t}}).select("id, chat_id").single();return h?{success:!1,error:"Failed to share review: "+(h.message||"Unknown error")}:{success:!0,message_id:u.id,chat_id:u.chat_id}}return{success:!1,error:"Failed to share review: "+(f.message||"Unknown error")}}return{success:!0,message_id:d.id,chat_id:d.chat_id}}catch(o){return console.error("Error sharing review to chat:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}})}static shareReviewToMultipleChats(t,r,n,a){return E(this,null,function*(){const i=[];for(const c of r){const d=yield this.shareReviewToChat(t,c,n,a);i.push(d)}const o=i.filter(c=>c.success).length,l=i.filter(c=>!c.success).length;return{successCount:o,failureCount:l,results:i}})}static shareReviewToNewChat(t,r,n,a){return E(this,null,function*(){try{const{data:i,error:o}=yield T.rpc("create_direct_chat",{user1_id:n,user2_id:r});return o||!i?{success:!1,error:"Failed to create chat"}:yield this.shareReviewToChat(t,i,n,a)}catch(i){return console.error("Error sharing review to new chat:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}})}}class ov{static getBaseUrl(){return typeof window!="undefined"&&window.location?window.location.origin:"https://plusone.app"}static getEventUrl(t){return`${this.getBaseUrl()}/?event=${encodeURIComponent(t)}`}static getReviewUrl(t){return`${this.getBaseUrl()}/?review=${encodeURIComponent(t)}`}static shareEvent(t,r,n){return E(this,null,function*(){var i;const a=this.getEventUrl(t);try{navigator.share?yield navigator.share({title:r||"PlusOne Event",text:n,url:a}):(i=navigator.clipboard)!=null&&i.writeText&&(yield navigator.clipboard.writeText(a))}catch(o){}return a})}static shareReview(t,r,n){return E(this,null,function*(){var i;const a=this.getReviewUrl(t);try{navigator.share?yield navigator.share({title:r||"PlusOne Review",text:n,url:a}):(i=navigator.clipboard)!=null&&i.writeText&&(yield navigator.clipboard.writeText(a))}catch(o){}return a})}}function MT({review:e,currentUserId:t,isOpen:r,onClose:n,onShareComplete:a}){const[i,o]=y.useState([]),[l,c]=y.useState([]),[d,f]=y.useState(new Set);y.useState(new Set);const[u,h]=y.useState(""),[m,v]=y.useState(""),[g,x]=y.useState(!1),[_,w]=y.useState(!1),[b,N]=y.useState(!1),{toast:S}=Er(),k=e.artist_name?`${e.artist_name}${e.venue_name?` at ${e.venue_name}`:""}`:e.venue_name||"Concert Review",C=()=>E(this,null,function*(){try{const F=yield ov.shareReview(e.id,"PlusOne Review",e.review_text||void 0);navigator.share?(yield navigator.share({title:`Review: ${k}`,text:e.review_text||"Check out this concert review!",url:F}),S({title:"Shared!",description:"Review shared successfully"})):(yield navigator.clipboard.writeText(F),S({title:"Link Copied!",description:"Review link copied to clipboard"}))}catch(F){F.name!=="AbortError"&&(console.error("Error sharing externally:",F),S({title:"Error",description:"Failed to share review",variant:"destructive"}))}});y.useEffect(()=>{r&&(A(),R(),N(!1))},[r,t]);const A=()=>E(this,null,function*(){try{x(!0);const F=yield Sd.getShareTargets(t);o(F)}catch(F){console.error("Error loading share targets:",F),S({title:"Error",description:"Failed to load chats",variant:"destructive"})}finally{x(!1)}}),R=()=>E(this,null,function*(){try{const F=yield Sd.getFriends(t);c(F)}catch(F){console.error("Error loading friends:",F)}}),I=F=>{f(U=>{const H=new Set(U);return H.has(F)?H.delete(F):H.add(F),H})},O=()=>E(this,null,function*(){if(d.size===0){S({title:"No chats selected",description:"Please select at least one chat to share with",variant:"destructive"});return}try{w(!0);const F=Array.from(d),U=F.filter(K=>!K.startsWith("friend-")),H=F.filter(K=>K.startsWith("friend-")).map(K=>K.replace("friend-",""));let q={successCount:0,errors:[]};if(U.length>0){const K=yield Sd.shareReviewToMultipleChats(e.id,U,t,u||void 0);q.successCount+=K.successCount,q.errors.push(...K.results.filter(Z=>!Z.success).map(Z=>Z.error||"Unknown error"))}for(const K of H)try{const Z=yield Sd.shareReviewToNewChat(e.id,K,t,u||void 0);Z.success?q.successCount+=1:q.errors.push(Z.error||"Failed to share with friend")}catch(Z){q.errors.push(`Failed to share with friend: ${Z}`)}if(q.successCount>0){try{yield cs.shareReview(t,e.id,"in_app_chat"),a&&a()}catch(K){console.warn("Failed to record share in analytics (non-critical):",K)}S({title:"Review Shared! ",description:`Successfully shared to ${q.successCount} chat${q.successCount>1?"s":""}`}),f(new Set),h(""),n()}q.errors.length>0&&S({title:"Partial Success",description:`${q.errors.length} share${q.errors.length>1?"s":""} failed`,variant:"destructive"})}catch(F){console.error("Error sharing review:",F),S({title:"Error",description:"Failed to share review",variant:"destructive"})}finally{w(!1)}}),z=i.filter(F=>F.name.toLowerCase().includes(m.toLowerCase())&&!F.name.toLowerCase().includes("direct chat")&&!F.name.toLowerCase().includes("dc direct")),M=l.filter(F=>F.name.toLowerCase().includes(m.toLowerCase())),B=[...z.map(F=>V(D({},F),{type:"group",isGroup:!0})),...M.map(F=>({id:`friend-${F.user_id}`,name:F.name,avatar_url:F.avatar_url,type:"friend",isGroup:!1,user_id:F.user_id}))];return s.jsx(PB,{open:r,onOpenChange:n,children:s.jsxs(TT,{side:"bottom",className:"h-[85vh] max-h-[85vh] p-0 flex flex-col overflow-hidden",style:{paddingTop:0,backgroundColor:"var(--neutral-50)",borderTopLeftRadius:"var(--radius-corner, 10px)",borderTopRightRadius:"var(--radius-corner, 10px)"},children:[s.jsx("div",{className:"w-full flex justify-center pt-3 pb-2 flex-shrink-0",children:s.jsx("div",{className:"w-12 h-1.5 rounded-full",style:{backgroundColor:"var(--neutral-200)"}})}),s.jsxs(AT,{className:"px-4 pb-3 flex-shrink-0",children:[s.jsx(RT,{className:"text-xl font-bold",children:"Share Review"}),s.jsxs(OT,{children:['Share "',k,'" with your friends']})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-4",children:[s.jsxs("div",{className:"rounded-lg p-3 border",style:{background:"var(--gradient-soft)",borderColor:"var(--neutral-200)"},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((F,U)=>s.jsx(Xt,{className:`w-4 h-4 ${U<(e.rating||0)?"fill-pink-500 text-pink-500":"text-gray-300"}`},U))}),s.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:k})]}),e.review_text&&s.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:e.review_text})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(ce,{onClick:C,variant:"outline",className:"h-auto py-4 border-pink-200 hover:bg-pink-50 flex flex-col items-center gap-2",children:[s.jsx(Dc,{className:"w-6 h-6 text-pink-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Share Externally"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Phone, Apps, etc."})]}),s.jsxs(ce,{onClick:()=>{N(!b),!b&&i.length===0&&l.length===0&&!g&&(A(),R())},variant:b?"default":"outline",className:`h-auto py-4 border-pink-200 flex flex-col items-center gap-2 ${b?"bg-pink-500 hover:bg-pink-600 text-white border-pink-500":"hover:bg-pink-50"}`,children:[s.jsx(Ln,{className:`w-6 h-6 ${b?"text-white":"text-pink-500"}`}),s.jsx("span",{className:"text-sm font-medium",children:"Share in Chat"}),s.jsx("span",{className:`text-xs ${b?"text-pink-100":"text-gray-500"}`,children:"Within Synth"})]})]}),b&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-1 mt-4 border-t pt-4",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Add a message (optional)"}),s.jsx(_s,{placeholder:"Check out this review! ",value:u,onChange:F=>h(F.target.value),rows:1,className:"resize-none text-sm"})]}),s.jsxs("div",{className:"flex flex-col mt-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Ln,{className:"w-5 h-5 text-pink-500"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Choose Chats"})]}),s.jsxs("div",{className:"relative mb-3",children:[s.jsx(Ho,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx(Nr,{placeholder:"Search chats...",value:m,onChange:F=>v(F.target.value),className:"pl-10"})]}),s.jsx("div",{className:"space-y-2 pr-2 max-h-[40vh] overflow-y-auto",children:g?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(fr,{className:"w-6 h-6 animate-spin text-pink-500"})}):B.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Ln,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),s.jsx("p",{children:"No chats found"}),s.jsx("p",{className:"text-sm",children:"Start a conversation to share reviews"})]}):B.map(F=>{var U;return s.jsxs("div",{onClick:()=>I(F.id),className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all ${d.has(F.id)?"bg-pink-50 border-2 border-pink-300":"bg-white border border-gray-200 hover:border-pink-200"}`,children:[s.jsxs(Wr,{className:"w-10 h-10",children:[s.jsx(Qr,{src:F.avatar_url||void 0}),s.jsx(Hr,{children:F.isGroup?s.jsx(Ln,{className:"w-5 h-5"}):F.name.split(" ").map(H=>H[0]).join("")})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:F.name}),s.jsx("p",{className:"text-xs text-gray-500",children:F.isGroup?`${((U=F.users)==null?void 0:U.length)||F.member_count||0} members`:"Direct message"})]}),d.has(F.id)&&s.jsx("div",{className:"w-6 h-6 rounded-full bg-pink-500 flex items-center justify-center",children:s.jsx(fa,{className:"w-4 h-4 text-white"})})]},F.id)})}),s.jsxs("div",{className:"mt-4 pt-4 border-t flex gap-2",children:[s.jsx(ce,{onClick:n,variant:"outline",className:"flex-1",children:"Cancel"}),s.jsx(ce,{onClick:O,disabled:d.size===0||_,className:"flex-1 bg-pink-500 hover:bg-pink-600 text-white",children:_?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-4 h-4 mr-2 animate-spin"}),"Sharing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(qc,{className:"w-4 h-4 mr-2"}),"Share (",d.size,")"]})})]})]})]})]})]})})}function A2({setlist:e,customSetlist:t,className:r,compact:n=!1,type:a}){var m,v,g,x;const[i,o]=y.useState(!1),l=a||(t?"custom":"api");if(!(l==="custom"?t:e))return null;if(l==="custom"){const _=t||[],w=_.length;return w===0?null:n?s.jsxs("div",{children:[s.jsxs("button",{className:Oe("flex items-center justify-between gap-2 p-3 bg-purple-50 rounded-lg border border-purple-200 hover:bg-purple-100 transition-colors w-full",r),onClick:b=>{b.stopPropagation(),o(!i)},children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Is,{className:"w-4 h-4 text-purple-600"}),s.jsxs("span",{className:"text-sm font-medium text-purple-800",children:["Custom Setlist  ",w," song",w!==1?"s":""]})]}),i?s.jsx(Lo,{className:"w-4 h-4 text-purple-600"}):s.jsx(Aa,{className:"w-4 h-4 text-purple-600"})]}),i&&s.jsx("div",{className:"mt-2 p-4 bg-white rounded-lg border border-purple-200",children:s.jsx("div",{className:"space-y-2",children:_.map((b,N)=>s.jsxs("div",{className:"flex items-start gap-3 p-2 bg-purple-50/30 rounded",children:[s.jsxs("span",{className:"text-sm font-medium text-purple-500 w-8 text-right flex-shrink-0",children:[b.position,"."]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 block",children:b.song_name}),b.cover_artist&&s.jsxs(et,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700 mt-1",children:["Cover: ",b.cover_artist]}),b.notes&&s.jsxs("p",{className:"text-xs text-gray-600 mt-1 italic",children:['"',b.notes,'"']})]})]},N))})})]}):s.jsxs(Ze,{className:Oe("border-purple-300 bg-gradient-to-br from-purple-50 to-pink-50",r),children:[s.jsx(kr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Is,{className:"w-5 h-5 text-purple-600"}),s.jsx("h4",{className:"font-semibold text-purple-900",children:"Custom Setlist"}),s.jsxs(et,{variant:"secondary",className:"bg-purple-100 text-purple-800",children:[w," song",w!==1?"s":""]})]}),s.jsx("p",{className:"text-xs text-purple-600",children:"User-created setlist for this show"})]}),s.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>o(!i),className:"text-purple-600 border-purple-300 hover:bg-purple-100",children:[i?s.jsx(Lo,{className:"w-4 h-4 mr-1"}):s.jsx(Aa,{className:"w-4 h-4 mr-1"}),i?"Hide":"Show"," Setlist"]})]})}),i&&s.jsx(tt,{className:"pt-0",children:s.jsx("div",{className:"space-y-2",children:_.map((b,N)=>s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white/60 rounded border border-purple-100",children:[s.jsxs("span",{className:"text-sm font-medium text-purple-500 w-8 text-right flex-shrink-0",children:[b.position,"."]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("span",{className:"text-sm font-medium text-purple-900 block",children:b.song_name}),b.cover_artist&&s.jsx("div",{className:"mt-1",children:s.jsxs(et,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:["Cover: ",b.cover_artist]})}),b.notes&&s.jsxs("p",{className:"text-xs text-purple-700 mt-1 italic",children:['"',b.notes,'"']})]})]},N))})})]})}if(!e)return null;const d=_=>{try{return new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch(w){return _}},u=(_=>{const w={};return _.forEach(b=>{w[b.setNumber]||(w[b.setNumber]=[]),w[b.setNumber].push(b)}),w})(e.songs||[]),h=((m=e.songs)==null?void 0:m.length)||0;return n?s.jsxs("div",{children:[s.jsxs("button",{className:Oe("flex items-center justify-between gap-2 p-3 bg-purple-50 rounded-lg border border-purple-200 hover:bg-purple-100 transition-colors w-full",r),onClick:_=>{_.stopPropagation(),o(!i)},children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ft,{className:"w-4 h-4 text-purple-600"}),s.jsxs("span",{className:"text-sm font-medium text-purple-800",children:[h," songs  ",Object.keys(u).length," set",Object.keys(u).length!==1?"s":""]})]}),i?s.jsx(Lo,{className:"w-4 h-4 text-purple-600"}):s.jsx(Aa,{className:"w-4 h-4 text-purple-600"})]}),i&&s.jsx("div",{className:"mt-2 p-4 bg-white rounded-lg border border-purple-200",children:Object.entries(u).map(([_,w])=>s.jsxs("div",{className:"mb-4 last:mb-0",children:[s.jsxs("h5",{className:"text-sm font-bold text-purple-900 mb-2",children:["Set ",_," (",w.length," songs)"]}),s.jsx("div",{className:"space-y-1",children:w.map((b,N)=>s.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[s.jsxs("span",{className:"text-purple-400 font-medium w-6 text-right flex-shrink-0",children:[N+1,"."]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-gray-900",children:b.name}),b.info&&s.jsxs("span",{className:"text-gray-500 ml-2 text-xs",children:["(",b.info,")"]})]})]},N))})]},_))})]}):s.jsxs(Ze,{className:Oe("border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50",r),children:[s.jsx(kr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ft,{className:"w-5 h-5 text-purple-600"}),s.jsx("h4",{className:"font-semibold text-purple-900",children:"Setlist"}),s.jsxs(et,{variant:"secondary",className:"bg-purple-100 text-purple-800",children:[h," songs"]})]}),s.jsxs("div",{className:"space-y-1 text-sm text-purple-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"h-3 w-3"}),d(e.eventDate)]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(yr,{className:"h-3 w-3"}),(v=e.venue)==null?void 0:v.name,", ",(g=e.venue)==null?void 0:g.city,((x=e.venue)==null?void 0:x.state)&&`, ${e.venue.state}`]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>o(!i),className:"text-purple-600 border-purple-300 hover:bg-purple-100",children:[i?s.jsx(Lo,{className:"w-4 h-4 mr-1"}):s.jsx(Aa,{className:"w-4 h-4 mr-1"}),i?"Hide":"Show"," Setlist"]}),e.url&&s.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>window.open(e.url,"_blank"),className:"text-purple-600 border-purple-300 hover:bg-purple-100",children:[s.jsx(io,{className:"w-4 h-4 mr-1"}),"Setlist.fm"]})]})]})}),i&&s.jsxs(tt,{className:"pt-0",children:[e.info&&s.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-800",children:e.info}),s.jsx("div",{className:"space-y-4",children:Object.entries(u).map(([_,w])=>{var b;return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(et,{variant:"outline",className:"font-medium border-purple-300 text-purple-700",children:((b=w[0])==null?void 0:b.setName)||`Set ${_}`}),s.jsxs("span",{className:"text-sm text-purple-600",children:[w.length," song",w.length!==1?"s":""]})]}),s.jsx("div",{className:"space-y-1",children:w.map((N,S)=>s.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white/60 rounded border border-purple-100",children:[s.jsxs("span",{className:"text-sm font-medium text-purple-500 w-8 text-right",children:[N.position,"."]}),s.jsx("span",{className:"text-sm flex-1 text-purple-900",children:N.name}),N.cover&&s.jsx(et,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:N.cover.artist}),N.tape&&s.jsx(et,{variant:"outline",className:"text-xs border-purple-300 text-purple-600",children:"Tape"})]},S))})]},_)})})]})]})}class ki{static setArtistFollow(t,r,n){return E(this,null,function*(){var a,i,o,l;try{const{error:c}=yield T.rpc("set_artist_follow",{p_artist_id:r,p_following:n});if(c&&(c.code==="42883"||c.code==="PGRST404"||c.code==="42P01"||((a=c.message)==null?void 0:a.includes("404"))||((i=c.message)==null?void 0:i.includes("does not exist"))||((o=c.message)==null?void 0:o.includes("function"))||((l=c.message)==null?void 0:l.includes("relation"))))if(console.warn(" RPC function set_artist_follow not available, using direct table operations"),n){const{data:f,error:u}=yield T.from("artists").select("id, name").eq("id",r).maybeSingle();if(u&&u.code!=="PGRST116")throw console.error("Error checking if artist exists:",u),new Error(`Failed to verify artist: ${u.message}`);if(!f)throw new Error(`Artist with ID ${r} does not exist. Please use setArtistFollowByName to create the artist first.`);const{error:h}=yield T.from("artist_follows").insert({user_id:t,artist_id:r});if(h&&h.code!=="23505")throw h}else{const{error:f}=yield T.from("artist_follows").delete().eq("user_id",t).eq("artist_id",r);if(f)throw f}else if(c)throw c;console.log(` Artist follow ${n?"added":"removed"}:`,{userId:t,artistId:r})}catch(c){throw console.error("Error setting artist follow:",c),new Error(`Failed to ${n?"follow":"unfollow"} artist: ${c instanceof Error?c.message:"Unknown error"}`)}})}static setArtistFollowByName(t,r,n,a=!0){return E(this,null,function*(){try{let i=null;if(!r||r.trim()==="")throw new Error("Cannot follow artist without a name");const o=r.trim(),{data:l,error:c}=yield T.from("artists").select("id, name").ilike("name",o).limit(1).maybeSingle();if(c&&console.warn("Error searching for existing artist:",c),l){if(i=l.id,!l.name){const{error:d}=yield T.from("artists").update({name:o,updated_at:new Date().toISOString()}).eq("id",i);d?console.warn("Failed to update artist name:",d):console.log(` Updated artist name to: ${o}`)}}else{const{data:d,error:f}=yield T.from("artists").insert({name:o,identifier:n||`manual:${o.toLowerCase().replace(/\s+/g,"-")}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("id, name").single();if(f)throw console.error("Error creating artist:",f),f;if(!d||!d.name)throw new Error("Failed to create artist - artist was created without a name");i=d.id,console.log(` Created artist: ${d.name} (ID: ${i})`)}if(!i)throw new Error("Failed to find or create artist");yield this.setArtistFollow(t,i,a)}catch(i){throw console.error("Error setting artist follow by name:",i),new Error(`Failed to ${a?"follow":"unfollow"} artist: ${i instanceof Error?i.message:"Unknown error"}`)}})}static isFollowingArtist(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("artist_follows").select("id").eq("user_id",r).eq("artist_id",t).maybeSingle();return a&&a.code!=="PGRST116"?(console.error("Error checking if following artist:",a),!1):!!n}catch(n){return console.error("Error checking if following artist:",n),!1}})}static getFollowerCount(t){return E(this,null,function*(){try{const{count:r,error:n}=yield T.from("artist_follows").select("*",{count:"exact",head:!0}).eq("artist_id",t);return n?(console.error("Error getting follower count:",n),0):r||0}catch(r){return console.error("Error getting follower count:",r),0}})}static getArtistFollowStats(t,r){return E(this,null,function*(){try{const[n,a]=yield Promise.all([this.getFollowerCount(t),r?this.isFollowingArtist(t,r):Promise.resolve(!1)]);return{follower_count:n,is_following:a}}catch(n){return console.error("Error getting artist follow stats:",n),{follower_count:0,is_following:!1}}})}static getArtistFollowStatsByName(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("artists").select("id").ilike("name",t).limit(1).maybeSingle();return a?(console.warn("Error searching for artist in getArtistFollowStatsByName:",a),{follower_count:0,is_following:!1}):n?yield this.getArtistFollowStats(n.id,r):{follower_count:0,is_following:!1}}catch(n){return console.error("Error getting artist follow stats by name:",n),{follower_count:0,is_following:!1}}})}static getUserFollowedArtists(t){return E(this,null,function*(){try{console.log(" Getting followed artists for user:",t);const{data:r,error:n}=yield T.from("artist_follows").select("id, artist_id, user_id, created_at, updated_at").eq("user_id",t).order("created_at",{ascending:!1});if(console.log(" ArtistFollowService query result:",{followsLength:(r==null?void 0:r.length)||0,error:n,firstFollow:r==null?void 0:r[0]}),n)return console.error(" Error fetching artist follows:",n),console.error(" Error details:",JSON.stringify(n,null,2)),[];if(!r||r.length===0)return console.log(" No artist follows found for user:",t),[];console.log(` Found ${r.length} artist follows`);const a=r.map(u=>u.artist_id).filter(Boolean);if(console.log("Artist IDs to fetch:",a.length),a.length===0)return[];const{data:i,error:o}=yield T.from("artists").select("id, name, image_url, identifier").in("id",a);if(o)return console.error("Error fetching artist details:",o),[];const l=new Map((i||[]).map(u=>[u.id,u])),c=[],d=r.map(u=>{const h=l.get(u.artist_id);return h||c.push(u.artist_id),{id:u.id,user_id:t,artist_id:u.artist_id,created_at:u.created_at,artist_name:(h==null?void 0:h.name)||null,artist_image_url:(h==null?void 0:h.image_url)||null,jambase_artist_id:(h==null?void 0:h.identifier)||null,num_upcoming_events:null,genres:null,user_name:null,user_avatar_url:null}});if(c.length>0){console.warn(` Found ${c.length} followed artists not in artists table, attempting fallback lookup...`);for(const u of c){let h=null;try{const{data:m}=yield T.from("events").select("artist_name, artist_id").eq("artist_id",u).limit(1).maybeSingle();if(m!=null&&m.artist_name&&(h=m.artist_name),!h){const{data:v}=yield T.from("events_with_artist_venue").select("artist_name_normalized, artist_id").eq("artist_id",u).limit(1).maybeSingle();v!=null&&v.artist_name_normalized&&(h=v.artist_name_normalized)}if(!h){const{data:v}=yield T.from("artists_with_external_ids").select("name, id").eq("id",u).maybeSingle();v!=null&&v.name&&(h=v.name)}if(h){const v=d.findIndex(g=>g.artist_id===u);if(v>=0){d[v].artist_name=h,console.log(` Found artist name: ${h} for ID: ${u}`);try{yield T.from("artists").upsert({id:u,name:h,updated_at:new Date().toISOString()},{onConflict:"id"}),console.log(` Created/updated artist record for: ${h}`)}catch(g){console.warn(" Failed to upsert artist record:",g)}}}else console.error(` Could not find artist name for ID: ${u} - this follow should be removed`)}catch(m){console.warn(` Fallback lookup failed for artist ID ${u}:`,m)}}}const f=d.filter(u=>u.artist_name!==null&&u.artist_name!=="");if(f.length<d.length){const u=d.length-f.length;console.warn(` Filtered out ${u} follows with missing artist data - these should be cleaned up`)}return console.log(" Followed artists fetched:",f.length),f}catch(r){return console.error("Error getting followed artists:",r),[]}})}static getArtistFollowers(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("artist_follows").select("id, user_id, artist_id, created_at, updated_at").eq("artist_id",t).order("created_at",{ascending:!1});if(n)throw n;if(!r||r.length===0)return[];const a=r.map(c=>c.user_id),[i,o]=yield Promise.all([T.from("users").select("user_id, name, avatar_url").in("user_id",a),T.from("artists").select("id, name, image_url, identifier").eq("id",t).maybeSingle()]),l=new Map((i.data||[]).map(c=>[c.user_id,c]));return r.map(c=>{var d,f,u,h,m;return{id:c.id,user_id:c.user_id,artist_id:c.artist_id,created_at:c.created_at,artist_name:((d=o.data)==null?void 0:d.name)||null,artist_image_url:((f=o.data)==null?void 0:f.image_url)||null,jambase_artist_id:((u=o.data)==null?void 0:u.identifier)||null,num_upcoming_events:null,genres:null,user_name:((h=l.get(c.user_id))==null?void 0:h.name)||null,user_avatar_url:((m=l.get(c.user_id))==null?void 0:m.avatar_url)||null}})}catch(r){throw console.error("Error getting artist followers:",r),new Error(`Failed to get artist followers: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getArtistUuidByJambaseId(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("get_entity_uuid_by_external_id",{p_external_id:t,p_source:"jambase",p_entity_type:"artist"});if(!n&&r)return r;const{data:a,error:i}=yield T.from("artists_with_external_ids").select("id").eq("jambase_artist_id",t).maybeSingle();if(i&&i.code!=="PGRST116")console.warn("Artists table query failed:",i);else if(a)return a.id;return null}catch(r){return console.error("Error getting artist UUID:",r),null}})}static getArtistUuidByName(t){return E(this,null,function*(){try{let{data:r,error:n}=yield T.from("artists").select("id").ilike("name",t).limit(1).maybeSingle();if(n&&n.code!=="PGRST116")console.warn("Artists table query failed:",n);else if(r)return r.id;return null}catch(r){return console.error("Error getting artist UUID by name:",r),null}})}static subscribeToArtistFollows(t,r){return T.channel("artist-follows").on("postgres_changes",{event:"INSERT",schema:"public",table:"artist_follows",filter:`user_id=eq.${t}`},a=>{r({id:a.new.id,user_id:a.new.user_id,artist_id:a.new.artist_id},"INSERT")}).on("postgres_changes",{event:"DELETE",schema:"public",table:"artist_follows",filter:`user_id=eq.${t}`},a=>{r({id:a.old.id,user_id:a.old.user_id,artist_id:a.old.artist_id},"DELETE")}).subscribe()}}class gc{static getOrCreateVerifiedChat(t,r,n){return E(this,null,function*(){try{console.log(" Calling get_or_create_verified_chat RPC:",{p_entity_type:t,p_entity_id:r,p_entity_name:n});const{data:a,error:i}=yield T.rpc("get_or_create_verified_chat",{p_entity_type:t,p_entity_id:r,p_entity_name:n});if(i)throw console.error(" Error getting/creating verified chat:",i),i;return console.log(" get_or_create_verified_chat RPC returned:",a),a}catch(a){throw console.error(" Error in getOrCreateVerifiedChat:",a),a}})}static joinVerifiedChat(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("join_verified_chat",{p_chat_id:t,p_user_id:r});if(a)throw console.error("Error joining verified chat:",a),a;return n}catch(n){throw console.error("Error in joinVerifiedChat:",n),n}})}static getVerifiedChatInfo(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("get_verified_chat_info",{p_entity_type:t,p_entity_id:r});if(a)throw console.error("Error getting verified chat info:",a),a;if(!n||n.length===0)return null;const i=n[0];return{chat_id:i.chat_id,chat_name:i.chat_name,member_count:i.member_count||0,last_activity_at:i.last_activity_at,is_user_member:i.is_user_member||!1,current_user_id:i.current_user_id}}catch(n){throw console.error("Error in getVerifiedChatInfo:",n),n}})}static isUserMember(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("chat_participants").select("user_id").eq("chat_id",t).eq("user_id",r).maybeSingle();return a?(console.error("Error checking user membership:",a),!1):!!n}catch(n){return console.error("Error in isUserMember:",n),!1}})}static joinOrOpenVerifiedChat(t,r,n,a){return E(this,null,function*(){try{console.log(" VerifiedChatService.joinOrOpenVerifiedChat called:",{entityType:t,entityId:r,entityName:n,userId:a});const i=yield this.getVerifiedChatInfo(t,r);console.log(" Chat info retrieved:",i);let o;return i!=null&&i.chat_id?(o=i.chat_id,console.log(" Chat exists, chatId:",o),i.is_user_member?console.log(" User already a member"):(console.log(" User not a member, joining chat..."),yield this.joinVerifiedChat(o,a),console.log(" User joined chat successfully"))):(console.log(" Chat does not exist, creating new verified chat..."),o=yield this.getOrCreateVerifiedChat(t,r,n),console.log(" Verified chat created, chatId:",o),console.log(" Joining newly created chat..."),yield this.joinVerifiedChat(o,a),console.log(" User joined newly created chat successfully")),console.log(" joinOrOpenVerifiedChat completed successfully, returning chatId:",o),o}catch(i){throw console.error(" Error in joinOrOpenVerifiedChat:",i),i}})}}const xue=Object.freeze(Object.defineProperty({__proto__:null,VerifiedChatService:gc},Symbol.toStringTag,{value:"Module"}));function n0({artistId:e,artistName:t,jambaseArtistId:r,userId:n,variant:a="outline",size:i="sm",showFollowerCount:o=!1,className:l,onFollowChange:c}){const[d,f]=y.useState(!1),[u,h]=y.useState(0),[m,v]=y.useState(!1),[g,x]=y.useState(e||null),[_,w]=y.useState(null),{toast:b}=Er();y.useEffect(()=>{E(this,null,function*(){if(e){x(e),w(e);return}if(r){const k=yield ki.getArtistUuidByJambaseId(r);if(k){x(k),w(k);return}}if(t){const k=yield ki.getArtistUuidByName(t);if(k){x(k),w(k);return}}w(null)})},[e,r,t]),y.useEffect(()=>{E(this,null,function*(){if(n)try{let k;if(_&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(_))k=yield ki.getArtistFollowStats(_,n);else if(t)k=yield ki.getArtistFollowStatsByName(t,n);else return;f(k.is_following),h(k.follower_count)}catch(k){if(console.error("Error loading follow status:",k),t)try{const C=yield ki.getArtistFollowStatsByName(t,n);f(C.is_following),h(C.follower_count)}catch(C){console.error("Error in fallback follow status lookup:",C)}}})},[_,t,n]),y.useEffect(()=>{if(!n)return;const S=ki.subscribeToArtistFollows(n,(k,C)=>{if(_?k.artist_id===_:!1){const R=C==="INSERT";f(R),h(I=>R?I+1:Math.max(0,I-1))}});return()=>{S.unsubscribe()}},[n,_,t]);const N=S=>E(this,null,function*(){var k;if(S.preventDefault(),S.stopPropagation(),!n){b({title:"Error",description:"Please log in to follow artists.",variant:"destructive"});return}v(!0);try{const C=!d;if(_)try{yield ki.setArtistFollow(n,_,C)}catch(A){if((k=A.message)!=null&&k.includes("does not exist")&&t)console.warn("Resolved artist ID does not exist, falling back to setArtistFollowByName"),yield ki.setArtistFollowByName(n,t,r,C);else throw A}else if(t)yield ki.setArtistFollowByName(n,t,r,C);else throw new Error("No artist information available");f(C),h(A=>C?A+1:Math.max(0,A-1));try{Zt[C?"follow":"unfollow"]("artist",_||t||"unknown",{artist_name:t},_||void 0)}catch(A){console.error("Error tracking follow/unfollow:",A)}if(C)try{console.log(" ArtistFollowButton: User followed artist, joining verified chat...",{artistId:_,artistName:t,jambaseArtistId:r,userId:n});const A=_||r||t||"";A?(yield gc.joinOrOpenVerifiedChat("artist",A,t||"Artist",n),console.log(" ArtistFollowButton: Successfully joined artist verified chat")):console.warn(" ArtistFollowButton: Could not determine entityId for chat join")}catch(A){console.error(" ArtistFollowButton: Error joining artist verified chat (non-fatal):",A)}b({title:C?"Following!":"Unfollowed",description:C?`You'll receive notifications when ${t||"this artist"} has new events or updates`:`You won't receive notifications from ${t||"this artist"} anymore`}),c==null||c(C)}catch(C){console.error("Error toggling follow:",C),b({title:"Error",description:`Failed to ${d?"unfollow":"follow"} artist`,variant:"destructive"})}finally{v(!1)}});return n?s.jsxs(ce,{variant:d?"secondary":a,size:i,className:Oe("gap-2",l),onClick:N,disabled:m,"data-artist-name":t,"data-testid":"artist-follow-button",children:[m?s.jsx(fr,{className:"h-4 w-4 animate-spin"}):d?s.jsx(Fg,{className:"h-4 w-4"}):s.jsx(Id,{className:"h-4 w-4"}),s.jsxs("span",{children:[d?"Following":"Follow",o&&u>0&&` (${u})`]})]}):(console.warn(" ArtistFollowButton: No userId provided, not rendering"),null)}class Ou{static normalizeVenueName(t){return t.trim()}static setVenueFollowByName(t,r,n,a,i=!0){return E(this,null,function*(){try{const o=this.normalizeVenueName(r);let l=null;if(l=yield this.getVenueIdByName(o,n,a),!l)throw new Error(`Venue not found: ${o}. Cannot follow venue that doesn't exist in database.`);if(i){const{error:c}=yield T.from("user_venue_relationships").insert({user_id:t,venue_id:l});if(c&&c.code!=="23505")throw c}else{const{error:c}=yield T.from("user_venue_relationships").delete().eq("user_id",t).eq("venue_id",l);if(c)throw c}console.log(` Venue follow ${i?"added":"removed"}:`,{userId:t,venueName:o,venueCity:n,venueState:a})}catch(o){throw console.error("Error setting venue follow:",o),new Error(`Failed to ${i?"follow":"unfollow"} venue: ${o instanceof Error?o.message:"Unknown error"}`)}})}static getVenueIdByName(t,r,n){return E(this,null,function*(){try{const a=this.normalizeVenueName(t);let i=T.from("venues").select("id, state").ilike("name",`%${a}%`).limit(10);n&&(i=i.ilike("state",`%${n}%`));const{data:o,error:l}=yield i;if(l)return console.warn("Error querying venues by name:",l),null;if(!o||o.length===0)return null;if(r){const c=o.map(f=>f.id),{data:d}=yield T.from("events").select("venue_id").in("venue_id",c).ilike("venue_city",`%${r}%`).limit(100);if(d&&d.length>0){const f=new Map;d.forEach(m=>{m.venue_id&&f.set(m.venue_id,(f.get(m.venue_id)||0)+1)});let u=0,h=null;if(f.forEach((m,v)=>{m>u&&(u=m,h=v)}),h)return h}}return o[0].id}catch(a){return console.error("Error getting venue ID by name:",a),null}})}static isFollowingVenueByName(t,r,n,a){return E(this,null,function*(){try{const i=this.normalizeVenueName(t);let o=T.from("venues").select("id").ilike("name",i);n&&(o=o.ilike("state",n));let{data:l}=yield o;if(r&&l&&l.length>0){const f=l.map(h=>h.id),{data:u}=yield T.from("events").select("venue_id").in("venue_id",f).ilike("venue_city",`%${r}%`).limit(100);if(u&&u.length>0){const h=new Set(u.map(m=>m.venue_id));l=l.filter(m=>h.has(m.id))}}if(!l||l.length===0)return!1;const c=l.map(f=>f.id),{count:d}=yield T.from("user_venue_relationships").select("*",{count:"exact",head:!0}).eq("user_id",a).in("venue_id",c);return(d||0)>0}catch(i){return!1}})}static getFollowerCountByName(t,r,n){return E(this,null,function*(){try{const a=this.normalizeVenueName(t);let i=T.from("venues").select("id").ilike("name",a);n&&(i=i.ilike("state",n));let{data:o}=yield i;if(r&&o&&o.length>0){const c=o.map(f=>f.id),{data:d}=yield T.from("events").select("venue_id").in("venue_id",c).ilike("venue_city",`%${r}%`).limit(100);if(d&&d.length>0){const f=new Set(d.map(u=>u.venue_id));o=o.filter(u=>f.has(u.id))}}let l=0;if(o&&o.length>0){const c=o.map(f=>f.id),{count:d}=yield T.from("user_venue_relationships").select("*",{count:"exact",head:!0}).in("venue_id",c);l+=d||0}return l}catch(a){return 0}})}static getVenueFollowStatsByName(t,r,n,a){return E(this,null,function*(){try{const[i,o]=yield Promise.all([this.getFollowerCountByName(t,r,n),a?this.isFollowingVenueByName(t,r,n,a):Promise.resolve(!1)]);return{follower_count:i,is_following:o}}catch(i){return console.error("Error getting venue follow stats:",i),{follower_count:0,is_following:!1}}})}static getUserFollowedVenues(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_venue_relationships").select("id, user_id, venue_id, created_at").eq("user_id",t).order("created_at",{ascending:!1});if(n)throw n;if(!r||r.length===0)return[];const a=[...new Set(r.map(l=>l.venue_id).filter(Boolean))],i=new Map;if(a.length>0){const{data:l}=yield T.from("venues").select("id, name, image_url, street_address, state, country, zip").in("id",a);l&&l.forEach(c=>{i.set(c.id,c)})}const{data:o}=yield T.from("users").select("user_id, name, avatar_url").eq("user_id",t).maybeSingle();return r.map(l=>{const c=i.get(l.venue_id);return{id:l.id,user_id:l.user_id,venue_id:l.venue_id,venue_name:(c==null?void 0:c.name)||null,venue_city:null,venue_state:(c==null?void 0:c.state)||null,venue_address:(c==null?void 0:c.street_address)||null,venue_image_url:(c==null?void 0:c.image_url)||null,num_upcoming_events:null,created_at:l.created_at,user_name:(o==null?void 0:o.name)||null,user_avatar_url:(o==null?void 0:o.avatar_url)||null}})}catch(r){return console.error("Error getting followed venues:",r),[]}})}static getVenueFollowersByName(t,r,n){return E(this,null,function*(){try{const a=this.normalizeVenueName(t);let i=T.from("venues").select("id, name, state").ilike("name",a);n&&(i=i.ilike("state",n));let{data:o,error:l}=yield i;if(r&&o&&o.length>0){const v=o.map(x=>x.id),{data:g}=yield T.from("events").select("venue_id").in("venue_id",v).ilike("venue_city",`%${r}%`).limit(100);if(g&&g.length>0){const x=new Set(g.map(_=>_.venue_id));o=o.filter(_=>x.has(_.id))}}if(l)throw l;if(!o||o.length===0)return[];const c=o.map(v=>v.id),{data:d,error:f}=yield T.from("user_venue_relationships").select("id, user_id, venue_id, created_at").in("venue_id",c).order("created_at",{ascending:!1});if(f)throw f;if(!d||d.length===0)return[];const u=[...new Set(d.map(v=>v.user_id).filter(Boolean))],h=new Map;if(u.length>0){const{data:v}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",u);v&&v.forEach(g=>{h.set(g.user_id,g)})}const m=new Map;return o.forEach(v=>{m.set(v.id,v)}),d.map(v=>{const g=m.get(v.venue_id)||{},x=h.get(v.user_id)||{};return{id:v.id,user_id:v.user_id,venue_id:v.venue_id,venue_name:g.name||null,venue_city:g.city||null,venue_state:g.state||null,venue_image_url:g.image_url||null,num_upcoming_events:null,created_at:v.created_at,user_name:x.name||null,user_avatar_url:x.avatar_url||null}})}catch(a){throw console.error("Error getting venue followers:",a),new Error(`Failed to get venue followers: ${a instanceof Error?a.message:"Unknown error"}`)}})}static subscribeToVenueFollows(t,r){return T.channel(`venue-follows-${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"user_venue_relationships",filter:`user_id=eq.${t}`},a=>{(()=>{T.from("venues").select("name, address, city, state").eq("id",a.new.venue_id).maybeSingle().then(({data:o})=>{const l={id:a.new.id,user_id:a.new.user_id,venue_name:(o==null?void 0:o.name)||null,venue_city:(o==null?void 0:o.city)||null,venue_state:(o==null?void 0:o.state)||null,created_at:a.new.created_at,updated_at:a.new.updated_at||a.new.created_at};r(l,"INSERT")}).catch(o=>{console.error("Error fetching venue details in realtime callback:",o);const l={id:a.new.id,user_id:a.new.user_id,venue_name:null,venue_city:null,venue_state:null,created_at:a.new.created_at,updated_at:a.new.updated_at||a.new.created_at};r(l,"INSERT")})})()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"user_venue_relationships",filter:`user_id=eq.${t}`},a=>{const i={id:a.old.id,user_id:a.old.user_id,venue_name:null,venue_city:null,venue_state:null,created_at:a.old.created_at,updated_at:a.old.updated_at||a.old.created_at};r(i,"DELETE")}).subscribe()}}function k1({venueName:e,venueCity:t,venueState:r,userId:n,variant:a="outline",size:i="sm",showFollowerCount:o=!1,className:l,onFollowChange:c}){const[d,f]=y.useState(!1),[u,h]=y.useState(0),[m,v]=y.useState(!1),{toast:g}=Er();y.useEffect(()=>{E(this,null,function*(){if(!(!n||!e))try{const w=yield Ou.getVenueFollowStatsByName(e,t,r,n);f(w.is_following),h(w.follower_count)}catch(w){console.error("Error loading venue follow status:",w)}})},[e,t,r,n]),y.useEffect(()=>{if(!n)return;const _=Ou.subscribeToVenueFollows(n,(w,b)=>{var S,k;if(w.venue_name.toLowerCase()===e.toLowerCase()&&(!t||((S=w.venue_city)==null?void 0:S.toLowerCase())===t.toLowerCase())&&(!r||((k=w.venue_state)==null?void 0:k.toLowerCase())===r.toLowerCase())){const C=b==="INSERT";f(C),h(A=>C?A+1:Math.max(0,A-1))}});return()=>{_.unsubscribe()}},[n,e,t,r]);const x=_=>E(this,null,function*(){if(_.preventDefault(),_.stopPropagation(),!n){g({title:"Error",description:"Please log in to follow venues.",variant:"destructive"});return}if(!e){g({title:"Error",description:"Venue name is required.",variant:"destructive"});return}v(!0);try{const w=!d;let b=null;if(w&&(b=yield Ou.getVenueIdByName(e,t,r)),yield Ou.setVenueFollowByName(n,e,t,r,w),f(w),h(S=>w?S+1:Math.max(0,S-1)),w&&b)try{console.log(" VenueFollowButton: User followed venue, joining verified chat...",{venueId:b,venueName:e,venueCity:t,venueState:r,userId:n}),yield gc.joinOrOpenVerifiedChat("venue",b,e,n),console.log(" VenueFollowButton: Successfully joined venue verified chat")}catch(S){console.error(" VenueFollowButton: Error joining venue verified chat (non-fatal):",S)}else if(w&&!b)try{console.log(" VenueFollowButton: No venueId found, using venue name as entity_id"),yield gc.joinOrOpenVerifiedChat("venue",e,e,n),console.log(" VenueFollowButton: Successfully joined venue verified chat (using name)")}catch(S){console.error(" VenueFollowButton: Error joining venue verified chat with name (non-fatal):",S)}const N=t&&r?` in ${t}, ${r}`:t?` in ${t}`:"";g({title:w?"Following!":"Unfollowed",description:w?`You'll receive notifications when ${e}${N} has new events`:`You won't receive notifications from ${e}${N} anymore`}),c==null||c(w)}catch(w){console.error("Error toggling venue follow:",w),g({title:"Error",description:`Failed to ${d?"unfollow":"follow"} venue`,variant:"destructive"})}finally{v(!1)}});return n?e?s.jsxs(ce,{variant:d?"secondary":a,size:i,className:Oe("gap-2",l),onClick:x,disabled:m,"data-venue-name":e,"data-testid":"venue-follow-button",children:[m?s.jsx(fr,{className:"h-4 w-4 animate-spin"}):d?s.jsx(eee,{className:"h-4 w-4"}):s.jsx(yr,{className:"h-4 w-4"}),s.jsxs("span",{children:[d?"Following":"Follow",o&&u>0&&` (${u})`]})]}):(console.warn(" VenueFollowButton: No venueName provided, not rendering"),null):(console.warn(" VenueFollowButton: No userId provided, not rendering"),null)}const Rh={spam:{label:"Spam",description:"Unwanted or repetitive content",icon:""},inappropriate_content:{label:"Inappropriate Content",description:"Offensive, explicit, or disturbing content",icon:""},harassment:{label:"Harassment or Bullying",description:"Targeting someone with hateful or threatening content",icon:""},misinformation:{label:"False Information",description:"Spreading false or misleading information",icon:""},copyright_violation:{label:"Copyright Violation",description:"Unauthorized use of copyrighted material",icon:""},fake_event:{label:"Fake or Fraudulent Event",description:"Event that doesn't exist or is misleading",icon:""},duplicate:{label:"Duplicate Content",description:"Same content posted multiple times",icon:""},other:{label:"Other",description:"Something else that violates guidelines",icon:""}};class Qu{static reportContent(t){return E(this,null,function*(){var r;try{const{data:{user:n},error:a}=yield T.auth.getUser();if(a||!n)throw new Error("User must be authenticated to report content");const o={spam:"spam",inappropriate_content:"inappropriate_content",harassment:"harassment",misinformation:"misinformation",copyright_violation:"copyright_violation",fake_event:"fake_content",duplicate:"spam",other:"other"}[t.flag_reason]||"other";let l=t.content_type;if(l==="comment"||l==="profile"||l==="message")if(l==="comment")l="review";else if(l==="profile")l="artist";else throw new Error(`Content type ${l} is not supported for moderation flags`);const{data:c,error:d}=yield T.from("users").select("user_id").eq("user_id",n.id).maybeSingle(),f=(c==null?void 0:c.user_id)||n.id,{data:u,error:h}=yield T.from("moderation_flags").insert({flagged_by_user_id:f,content_type:l,content_id:t.content_id,flag_reason:t.flag_reason,flag_category:o,additional_details:((r=t.flag_details)==null?void 0:r.trim())||null,status:"pending"}).select("id").single();if(h)throw h.code==="23505"?new Error("You have already reported this content"):h;return u.id}catch(n){throw console.error("Error reporting content:",n),n instanceof Error?n:new Error("Failed to report content")}})}static blockUser(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("block_user",{p_blocked_user_id:t.blocked_user_id,p_block_reason:t.block_reason||null});if(n)throw n;return r}catch(r){throw console.error("Error blocking user:",r),r}})}static unblockUser(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("unblock_user",{p_blocked_user_id:t});if(r)throw r}catch(r){throw console.error("Error unblocking user:",r),r}})}static isUserBlocked(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("is_user_blocked",{p_user_id:t,p_by_user_id:r||null});if(a)throw a;return n||!1}catch(n){return console.error("Error checking block status:",n),!1}})}static getBlockedUsers(){return E(this,null,function*(){try{const{data:t,error:r}=yield T.rpc("get_blocked_users");if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching blocked users:",t),t}})}static getUserReports(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const a=t||r.id,{data:i,error:o}=yield T.from("moderation_flags").select("*").eq("flagged_by_user_id",a).order("created_at",{ascending:!1});if(o)throw o;return i||[]}catch(r){throw console.error("Error fetching user reports:",r),r}})}static moderateContent(t,r,n,a=!0){return E(this,null,function*(){try{const{error:i}=yield T.rpc("moderate_content",{p_flag_id:t,p_action:r,p_review_notes:n||null,p_notify_user:a});if(i)throw i}catch(i){throw console.error("Error moderating content:",i),i}})}static getFlaggedContentDetails(t,r){return E(this,null,function*(){try{let n;switch(t){case"event":n=T.from("events").select("*").eq("id",r).single();break;case"review":n=T.from("reviews").select(`
              *,
              user:users!reviews_user_id_fkey(name, avatar_url)
            `).eq("id",r).single();break;case"comment":n=T.from("comments").select(`
              *,
              user:users!comments_user_id_fkey(name, avatar_url)
            `).eq("id",r).single();break;case"profile":n=T.from("users").select("*").eq("user_id",r).single();break;default:throw new Error("Unsupported content type")}const{data:a,error:i}=yield n;if(i)throw i;return a}catch(n){throw console.error("Error fetching content details:",n),n}})}static getFlagReasons(){return Rh}static getUserModerationStatus(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("users").select("moderation_status, warning_count, last_warned_at, suspended_until, ban_reason").eq("user_id",t).single();if(n)throw n;return r}catch(r){throw console.error("Error fetching moderation status:",r),r}})}static canReportContent(t,r){return E(this,null,function*(){try{const{data:{user:n}}=yield T.auth.getUser();if(!n)return!1;const{data:a,error:i}=yield T.from("moderation_flags").select("id").eq("flagged_by_user_id",n.id).eq("content_type",t).eq("content_id",r).single();return i&&i.code==="PGRST116"?!0:!a}catch(n){return console.error("Error checking report eligibility:",n),!1}})}static getContentTypeDisplayName(t){return{event:"Event",review:"Review",comment:"Comment",profile:"Profile",message:"Message"}[t]||t}}function E1({open:e,onClose:t,contentType:r,contentId:n,contentTitle:a,onReportSubmitted:i}){const{toast:o}=Er(),[l,c]=y.useState(!1),[d,f]=y.useState(""),[u,h]=y.useState(""),m=g=>E(this,null,function*(){if(g.preventDefault(),!d){o({title:"Please select a reason",description:"Select why you're reporting this content",variant:"destructive"});return}c(!0);try{yield Qu.reportContent({content_type:r,content_id:n,flag_reason:d,flag_details:u.trim()||void 0}),o({title:"Report Submitted",description:"Thank you for helping keep our community safe. We'll review this report shortly."}),i==null||i(),v()}catch(x){console.error("Error submitting report:",x),o({title:"Error",description:x instanceof Error?x.message:"Failed to submit report",variant:"destructive"})}finally{c(!1)}}),v=()=>{l||(f(""),h(""),t())};return s.jsx(vn,{open:e,onOpenChange:v,children:s.jsxs(hn,{className:"sm:max-w-[550px] max-h-[90vh] flex flex-col",children:[s.jsxs(Hn,{className:"flex-shrink-0",children:[s.jsxs(Sn,{className:"flex items-center gap-2",children:[s.jsx(eo,{className:"h-5 w-5 text-red-600"}),"Report ",Qu.getContentTypeDisplayName(r)]}),s.jsx(ds,{children:"Help us understand what's wrong with this content. Your report is anonymous."})]}),a&&s.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200 flex-shrink-0",children:s.jsx("p",{className:"text-sm text-gray-700 font-medium truncate",children:a})}),s.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:s.jsxs("form",{onSubmit:m,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs(qt,{children:["Why are you reporting this? ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("div",{className:"space-y-2",children:Object.entries(Rh).map(([g,x])=>s.jsxs("label",{className:`flex items-start p-3 border rounded-lg cursor-pointer transition-colors ${d===g?"border-red-500 bg-red-50":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"reason",value:g,checked:d===g,onChange:_=>f(_.target.value),disabled:l,className:"mt-0.5 mr-3"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-lg",children:x.icon}),s.jsx("span",{className:"font-medium text-sm",children:x.label})]}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:x.description})]})]},g))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"details",children:"Additional Details (Optional)"}),s.jsx(_s,{id:"details",placeholder:"Provide any additional context that might help us review this report...",value:u,onChange:g=>h(g.target.value),disabled:l,rows:4}),s.jsx("p",{className:"text-xs text-gray-500",children:"Do not include personal information in your report."})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex gap-3",children:[s.jsx(df,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-900",children:[s.jsx("p",{className:"font-medium mb-1",children:"What happens next?"}),s.jsxs("ul",{className:"text-xs space-y-1 list-disc list-inside",children:[s.jsx("li",{children:"Your report will be reviewed by our moderation team"}),s.jsx("li",{children:"We may remove content that violates our guidelines"}),s.jsx("li",{children:"You'll receive a notification about the outcome"}),s.jsx("li",{children:"Reports are confidential and anonymous"})]})]})]})]})}),s.jsxs(Tf,{className:"flex-shrink-0 border-t pt-4",children:[s.jsx(ce,{type:"button",variant:"outline",onClick:v,disabled:l,children:"Cancel"}),s.jsx(ce,{type:"submit",variant:"destructive",disabled:l||!d,onClick:m,children:l?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-4 h-4 mr-2 animate-spin"}),"Submitting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(eo,{className:"w-4 h-4 mr-2"}),"Submit Report"]})})]})]})})}var C1="Collapsible",[_ue,AB]=$s(C1),[wue,DT]=_ue(C1),RB=y.forwardRef((e,t)=>{const f=e,{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:i,onOpenChange:o}=f,l=ge(f,["__scopeCollapsible","open","defaultOpen","disabled","onOpenChange"]),[c,d]=Ya({prop:n,defaultProp:a!=null?a:!1,onChange:o,caller:C1});return s.jsx(wue,{scope:r,disabled:i,contentId:Os(),open:c,onOpenToggle:y.useCallback(()=>d(u=>!u),[d]),children:s.jsx(Pt.div,V(D({"data-state":FT(c),"data-disabled":i?"":void 0},l),{ref:t}))})});RB.displayName=C1;var OB="CollapsibleTrigger",IT=y.forwardRef((e,t)=>{const i=e,{__scopeCollapsible:r}=i,n=ge(i,["__scopeCollapsible"]),a=DT(OB,r);return s.jsx(Pt.button,V(D({type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":FT(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled},n),{ref:t,onClick:mt(e.onClick,a.onOpenToggle)}))});IT.displayName=OB;var $T="CollapsibleContent",LT=y.forwardRef((e,t)=>{const i=e,{forceMount:r}=i,n=ge(i,["forceMount"]),a=DT($T,e.__scopeCollapsible);return s.jsx(Ks,{present:r||a.open,children:({present:o})=>s.jsx(bue,V(D({},n),{ref:t,present:o}))})});LT.displayName=$T;var bue=y.forwardRef((e,t)=>{const w=e,{__scopeCollapsible:r,present:n,children:a}=w,i=ge(w,["__scopeCollapsible","present","children"]),o=DT($T,r),[l,c]=y.useState(n),d=y.useRef(null),f=mr(t,d),u=y.useRef(0),h=u.current,m=y.useRef(0),v=m.current,g=o.open||l,x=y.useRef(g),_=y.useRef(void 0);return y.useEffect(()=>{const b=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(b)},[]),xs(()=>{const b=d.current;if(b){_.current=_.current||{transitionDuration:b.style.transitionDuration,animationName:b.style.animationName},b.style.transitionDuration="0s",b.style.animationName="none";const N=b.getBoundingClientRect();u.current=N.height,m.current=N.width,x.current||(b.style.transitionDuration=_.current.transitionDuration,b.style.animationName=_.current.animationName),c(n)}},[o.open,n]),s.jsx(Pt.div,V(D({"data-state":FT(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!g},i),{ref:f,style:D({"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":v?`${v}px`:void 0},e.style),children:g&&a}))});function FT(e){return e?"open":"closed"}var MB=RB,jue=IT,Nue=LT;const Sue=MB,kue=IT,Eue=LT;function R2({review:e,currentUserId:t,onLike:r,onComment:n,onShare:a,onEdit:i,onDelete:o,showEventInfo:l=!1,onReport:c,userProfile:d,followedArtists:f=[],followedVenues:u=[]}){var qe,Ct,ct,pt,At,yt,Fe,ft,Et,hr,dr,cn,mn,je,pe,Pe,Ne,Ye,We,It,jt;const[h,m]=y.useState(null);y.useEffect(()=>{const Ee=e.artist_performance_rating!=null||e.production_rating!=null||e.venue_rating!=null||e.location_rating!=null||e.value_rating!=null,ir=!!e.venue_feedback&&e.venue_rating==null;!Ee||ir?(console.log(" BelliStyleReviewCard - Missing category ratings, fetching full review data for:",e.id),T.from("reviews").select("rating, artist_performance_rating, production_rating, venue_rating, location_rating, value_rating, artist_performance_feedback, production_feedback, venue_feedback, location_feedback, value_feedback").eq("id",e.id).single().then(({data:rn,error:Mt})=>{!Mt&&rn?(console.log(" BelliStyleReviewCard - Fetched review data:",rn),m(rn)):Mt&&console.error(" BelliStyleReviewCard - Error fetching review data:",Mt)})):console.log(" BelliStyleReviewCard - Full review object:",{id:e.id,venue_rating:e.venue_rating,artist_performance_rating:e.artist_performance_rating,production_rating:e.production_rating,location_rating:e.location_rating,value_rating:e.value_rating,rating:e.rating,allKeys:Object.keys(e)})},[e.id]);const[v,g]=y.useState(e.is_liked_by_user||!1),[x,_]=y.useState(e.likes_count),[w,b]=y.useState(!1),[N,S]=y.useState(!1),[k,C]=y.useState([]),[A,R]=y.useState(e.comments_count||0),[I,O]=y.useState(!1),[z,M]=y.useState(""),[B,F]=y.useState(!1);y.useState(!1);const U=Array.isArray(e==null?void 0:e.photos)?e.photos:[],[H,q]=y.useState(!1),[K,Z]=y.useState(0),[ne,Y]=y.useState(!1),[X,se]=y.useState(!1),[de,_e]=y.useState(!1),{toast:xe}=Er(),[Q,oe]=y.useState(null),[ie,ee]=y.useState("loading"),[G,J]=y.useState(!1),ae=()=>E(this,null,function*(){if(!(!t||w)){b(!0);try{v?(yield cs.unlikeReview(t,e.id),_(Ee=>Math.max(0,Ee-1)),g(!1)):(yield cs.likeReview(t,e.id),_(Ee=>Ee+1),g(!0)),r&&r(e.id,!v)}catch(Ee){console.error("Error toggling like:",Ee),v?(_(rt=>rt+1),g(!0)):(_(rt=>Math.max(0,rt-1)),g(!1))}finally{b(!1)}}}),fe=()=>E(this,null,function*(){const Ee=!N;if(S(Ee),Ee&&k.length===0)try{O(!0);const rt=yield cs.getReviewComments(e.id);C(rt),R(rt.length)}catch(rt){console.error("Error loading comments:",rt)}finally{O(!1)}}),we=()=>E(this,null,function*(){if(!(!t||!z.trim()||B))try{F(!0);const Ee=yield cs.addComment(t,e.id,z.trim());C(rt=>[...rt,V(D({},Ee),{user:{id:Ee.user_id,name:(d==null?void 0:d.name)||"You",avatar_url:d==null?void 0:d.avatar_url}})]),M(""),R(rt=>rt+1)}finally{F(!1)}}),ve=()=>{a&&a(e.id),_e(!0)},me=Ee=>{Ee.preventDefault(),Ee.stopPropagation(),console.log("BelliStyleReviewCard: Edit button clicked",{reviewId:e.id}),i?i(e):console.warn("onEdit handler not provided to BelliStyleReviewCard")},Me=()=>E(this,null,function*(){o&&window.confirm("Are you sure you want to delete this review?")&&o(e.id)}),Te=t&&e.user_id===t;h&&D(D({},e),h);const Ve=(qe=h==null?void 0:h.artist_performance_rating)!=null?qe:e.artist_performance_rating,le=(Ct=h==null?void 0:h.production_rating)!=null?Ct:e.production_rating,Ke=(ct=h==null?void 0:h.venue_rating)!=null?ct:e.venue_rating,De=(pt=h==null?void 0:h.location_rating)!=null?pt:e.location_rating,nt=(At=h==null?void 0:h.value_rating)!=null?At:e.value_rating,ze=[Ve,le,Ke,De,nt].filter(Ee=>typeof Ee=="number"&&!isNaN(Ee)&&Ee>0),vt=ze.length>0?Number((ze.reduce((Ee,rt)=>Ee+rt,0)/ze.length).toFixed(1)):null,rr=typeof e.rating=="string"?parseFloat(e.rating):typeof e.rating=="number"?e.rating:null,sr=h!=null&&h.rating?typeof h.rating=="string"?parseFloat(h.rating):h.rating:null,Ae=sr!=null&&!Number.isNaN(sr)&&sr>=0?sr:rr!=null&&!Number.isNaN(rr)&&rr>=0?rr:vt!=null&&vt>=0?vt:null;y.useEffect(()=>{console.log(" Overall Rating Debug:",{reviewRating:e.rating,reviewRatingType:typeof e.rating,reviewRatingValue:rr,computedAverage:vt,categoryAverages:ze,overallRating:Ae,fetchedReviewData:!!h,willDisplay:Ae>0})},[e.rating,rr,vt,Ae,h]);const Ue=Ee=>Ee>=4.5?"ring-green-500":Ee>=3.5?"ring-yellow-500":Ee>=2.5?"ring-orange-500":"ring-red-500",gt=Ee=>Ee>=4.5?"from-green-400 to-green-600":Ee>=3.5?"from-yellow-400 to-yellow-600":Ee>=2.5?"from-orange-400 to-orange-600":"from-red-400 to-red-600",Ce=(Ee,rt="sm")=>{const ir=rt==="sm"?"w-3 h-3":"w-4 h-4";return Array.from({length:5},(rn,Mt)=>{const ye=Mt+1,Ie=Ee>=ye,dt=!Ie&&Ee>=ye-.5;return s.jsxs("div",{className:Oe("relative",ir),children:[s.jsx(Xt,{className:Oe(ir,"text-gray-300")}),(dt||Ie)&&s.jsx("div",{className:Oe("absolute left-0 top-0 h-full overflow-hidden pointer-events-none",Ie?"w-full":"w-1/2"),children:s.jsx(Xt,{className:Oe(ir,"text-yellow-400 fill-current")})})]},Mt)})};y.useEffect(()=>{const Ee=ir=>{ir.stopPropagation(),fe()},rt=document.getElementById(`belli-review-card-${e.id}`);return rt==null||rt.addEventListener("toggle-review-comments",Ee),()=>rt==null?void 0:rt.removeEventListener("toggle-review-comments",Ee)},[e.id,N,k.length]),y.useEffect(()=>{E(this,null,function*(){if(!t||!e.user_id||t===e.user_id){oe(null),ee("none");return}try{const{data:rt,error:ir}=yield T.rpc("get_connection_info",{current_user_id:t,target_user_id:e.user_id});ir?(console.warn("Error fetching connection info:",ir),oe(null)):rt&&rt.length>0&&rt[0].degree<=3?oe({degree:rt[0].degree,label:rt[0].label,color:rt[0].color}):oe(null);const{data:rn,error:Mt}=yield T.from("user_relationships").select("id, user_id, related_user_id, status").eq("relationship_type","friend").eq("status","accepted").or(`and(user_id.eq.${t},related_user_id.eq.${e.user_id}),and(user_id.eq.${e.user_id},related_user_id.eq.${t})`).maybeSingle();if(Mt&&Mt.code!=="PGRST116"&&console.warn("Error checking friend status:",Mt),rn)ee("friends");else{const{data:ye,error:Ie}=yield T.from("user_relationships").select("id, user_id, related_user_id, status").eq("relationship_type","friend").eq("status","pending").or(`and(user_id.eq.${t},related_user_id.eq.${e.user_id}),and(user_id.eq.${e.user_id},related_user_id.eq.${t})`).maybeSingle();Ie&&Ie.code!=="PGRST116"&&console.warn("Error checking friend request:",Ie),ye?ye.user_id===t?ee("pending_sent"):ee("pending_received"):ee("none")}}catch(rt){console.error("Error fetching connection/friend info:",rt),oe(null),ee("none")}})},[t,e.user_id]),y.useEffect(()=>{E(this,null,function*(){if(t)try{const rt=yield cs.getReviewEngagement(e.id,t);rt&&(_(rt.likes_count),R(rt.comments_count),g(rt.is_liked_by_user))}catch(rt){console.error("Error refreshing engagement data:",rt)}})},[e.id,t]);const Ge=Ee=>{Z(Ee),q(!0)},Nt=()=>q(!1),Tt=()=>E(this,null,function*(){if(!(!t||!e.user_id||G))try{J(!0);const{data:Ee,error:rt}=yield T.rpc("create_friend_request",{receiver_user_id:e.user_id});if(rt)throw rt;ee("pending_sent"),xe({title:"Friend Request Sent! ",description:"Your friend request has been sent."})}catch(Ee){console.error("Error sending friend request:",Ee),xe({title:"Error",description:Ee.message||"Failed to send friend request. Please try again.",variant:"destructive"})}finally{J(!1)}}),at=Ee=>{Ee&&Ee.stopPropagation(),U.length&&Z(rt=>(rt-1+U.length)%U.length)},ue=Ee=>{Ee&&Ee.stopPropagation(),U.length&&Z(rt=>(rt+1)%U.length)};return s.jsxs(Ze,{className:"w-full border-2 shadow-lg hover:shadow-xl transition-all duration-300 bg-gray-50 rounded-xl overflow-hidden",id:`belli-review-card-${e.id}`,children:[s.jsxs(kr,{className:"pb-4 bg-gradient-to-br from-gray-50 via-white to-gray-50 border-b-2 relative",children:[Ae!=null&&Ae>=0&&s.jsxs("div",{className:Oe("absolute top-4 right-4 w-16 h-16 rounded-full flex flex-col items-center justify-center","bg-gradient-to-br shadow-lg",gt(Math.max(.5,Ae)),"text-white font-bold z-10"),children:[s.jsx("span",{className:"text-2xl leading-none",children:Ae.toFixed(1)}),s.jsx("div",{className:"flex items-center gap-0.5 mt-1",children:Array.from({length:5},(Ee,rt)=>s.jsx(Xt,{className:Oe("w-2 h-2",rt<Math.round(Ae)?"fill-white text-white":"text-white/40")},rt))})]}),s.jsxs("div",{className:"flex items-start gap-4 pr-20",children:[s.jsxs(Wr,{className:Oe("w-14 h-14 ring-4",Ue(Ae)),children:[s.jsx(Qr,{src:(d==null?void 0:d.avatar_url)||void 0,alt:(d==null?void 0:d.name)||"User"}),s.jsx(Hr,{className:"text-lg font-semibold bg-gradient-to-br from-[#FF3399] to-[#FF66B3] text-white",children:((yt=d==null?void 0:d.name)==null?void 0:yt.charAt(0).toUpperCase())||((Fe=e.user_id)==null?void 0:Fe.slice(0,1).toUpperCase())||"U"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1 flex-wrap gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:(d==null?void 0:d.name)||"User"}),(d==null?void 0:d.verified)&&(d==null?void 0:d.account_type)&&s.jsx(PT,{accountType:d.account_type,verified:d.verified,size:"md"}),t&&e.user_id!==t&&Q&&Q.degree<=3&&s.jsx(et,{className:Oe("text-xs font-semibold px-2 py-0.5 border-2 border-black",Q.color==="dark-green"?"bg-green-700 text-white hover:bg-green-800":Q.color==="light-green"?"bg-green-400 text-green-900 hover:bg-green-500":Q.color==="yellow"?"bg-yellow-400 text-yellow-900 hover:bg-yellow-500":Q.color==="red"?"bg-red-500 text-white hover:bg-red-600":Q.color==="blue"?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-500 text-white hover:bg-gray-600"),children:Q.label})]}),t&&e.user_id!==t&&ie!=="friends"&&ie!=="pending_sent"&&ie!=="loading"&&s.jsxs(ce,{size:"sm",variant:"outline",onClick:Ee=>{Ee.preventDefault(),Ee.stopPropagation(),Tt()},disabled:G,className:"h-7 text-xs px-2 gap-1",children:[s.jsx(Id,{className:"w-3 h-3"}),G?"Sending...":ie==="pending_received"?"Pending":"Add Friend"]})]}),s.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:["Reviewed ",s.jsx("span",{className:"text-[#FF3399] font-semibold",children:e.artist_name||((ft=e.event)==null?void 0:ft.artist_name)||"Artist"}),(e.venue_name||((Et=e.event)==null?void 0:Et.venue_name))&&s.jsxs(s.Fragment,{children:[" ","at ",s.jsx("span",{className:"text-gray-800",children:e.venue_name||((hr=e.event)==null?void 0:hr.venue_name)})]})]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center gap-2",children:[s.jsx("span",{children:Uv(new Date(e.created_at),{addSuffix:!0})}),e.venue_city&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(yr,{className:"w-3 h-3"}),e.venue_city,", ",e.venue_state]})]})]})]}),Te&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ce,{variant:"ghost",size:"sm",onClick:Ee=>me(Ee),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"Edit review",children:s.jsx(Ol,{className:"h-4 w-4"})}),s.jsx(ce,{variant:"ghost",size:"sm",onClick:Me,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:s.jsx(Ko,{className:"h-4 w-4"})})]})]})]}),s.jsxs(tt,{className:"pt-5 px-5 pb-2",children:[e.review_text&&e.review_text!=="ATTENDANCE_ONLY"&&s.jsx("div",{className:"mb-4",children:s.jsx("p",{className:"text-base leading-relaxed text-gray-800",children:e.review_text})}),U.length>0&&s.jsx("div",{className:"mb-4",children:U.length===1?s.jsx("div",{className:"rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm",children:s.jsx("img",{src:U[0],alt:"Review photo",className:"w-full h-80 object-cover cursor-zoom-in hover:opacity-95 transition-opacity",loading:"lazy",onClick:Ee=>{Ee.stopPropagation(),Ge(0)}})}):s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx("div",{className:"col-span-2 row-span-2 rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm",children:s.jsx("img",{src:U[0],alt:"Review photo 1",className:"w-full h-full object-cover cursor-zoom-in hover:opacity-95 transition-opacity",loading:"lazy",onClick:Ee=>{Ee.stopPropagation(),Ge(0)}})}),U.slice(1,5).map((Ee,rt)=>s.jsx("div",{className:"rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm aspect-square",children:s.jsx("img",{src:Ee,alt:`Review photo ${rt+2}`,className:"w-full h-full object-cover cursor-zoom-in hover:opacity-95 transition-opacity",loading:"lazy",onClick:ir=>{ir.stopPropagation(),Ge(rt+1)}})},rt)),U.length>5&&s.jsxs("button",{onClick:Ee=>{Ee.stopPropagation(),Ge(5)},className:"rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm aspect-square bg-black/60 flex items-center justify-center text-white font-bold text-lg hover:bg-black/70 transition-colors",children:["+",U.length-5]})]})}),s.jsxs(Sue,{open:X,onOpenChange:se,children:[s.jsx(kue,{asChild:!0,children:s.jsxs(ce,{variant:"outline",className:"w-full mb-3 flex items-center justify-between hover:bg-gray-50",onClick:Ee=>{Ee.stopPropagation(),se(!X)},children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(Fl,{className:"w-4 h-4"}),"View Rating Details"]}),X?s.jsx(Lo,{className:"w-4 h-4"}):s.jsx(Aa,{className:"w-4 h-4"})]})}),s.jsx(Eue,{className:"space-y-3 mb-4",children:[{label:"Artist Performance",rating:(dr=h==null?void 0:h.artist_performance_rating)!=null?dr:e.artist_performance_rating,feedback:(cn=h==null?void 0:h.artist_performance_feedback)!=null?cn:e.artist_performance_feedback,icon:aee,border:"border-[#FF3399]",gradient:"from-[#FF3399]/5 to-[#FF3399]/10",iconColor:"text-[#FF3399]"},{label:"Production Quality",rating:(mn=h==null?void 0:h.production_rating)!=null?mn:e.production_rating,feedback:(je=h==null?void 0:h.production_feedback)!=null?je:e.production_feedback,icon:JQ,border:"border-purple-500",gradient:"from-purple-50 to-purple-50/30",iconColor:"text-purple-600"},{label:"Venue Experience",rating:(Pe=(pe=h==null?void 0:h.venue_rating)!=null?pe:e.venue_rating)!=null?Pe:void 0,feedback:(Ne=h==null?void 0:h.venue_feedback)!=null?Ne:e.venue_feedback,recommendation:e.venue_recommendation,icon:Io,border:"border-blue-500",gradient:"from-blue-50 to-blue-50/30",iconColor:"text-blue-600"},{label:"Location & Logistics",rating:(Ye=h==null?void 0:h.location_rating)!=null?Ye:e.location_rating,feedback:(We=h==null?void 0:h.location_feedback)!=null?We:e.location_feedback,recommendation:e.location_recommendation,icon:RP,border:"border-emerald-500",gradient:"from-emerald-50 to-emerald-50/30",iconColor:"text-emerald-600"},{label:"Value for Ticket",rating:(It=h==null?void 0:h.value_rating)!=null?It:e.value_rating,feedback:(jt=h==null?void 0:h.value_feedback)!=null?jt:e.value_feedback,recommendation:e.value_recommendation,icon:Do,border:"border-amber-500",gradient:"from-amber-50 to-amber-50/30",iconColor:"text-amber-600"}].map(Ee=>{const rt=typeof Ee.rating=="string"?parseFloat(Ee.rating):Ee.rating,ir=typeof rt=="number"&&!isNaN(rt)&&rt>0?rt:void 0;if(Ee.label==="Venue Experience"&&console.log(" Venue Experience Debug:",{label:Ee.label,rawRating:Ee.rating,ratingValue:rt,resolvedRating:ir,reviewVenueRating:e.venue_rating,fetchedVenueRating:h==null?void 0:h.venue_rating,hasFeedback:!!Ee.feedback}),!ir&&!Ee.feedback)return null;const rn=Ee.icon;return s.jsxs("div",{className:Oe("border-l-4 rounded-r-lg p-4 shadow-sm bg-gradient-to-r",Ee.border,Ee.gradient),children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(rn,{className:Oe("w-5 h-5",Ee.iconColor)}),s.jsx("span",{className:"text-sm font-bold text-gray-900",children:Ee.label})]}),ir&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex items-center gap-0.5",children:Ce(ir,"md")}),s.jsx("span",{className:"text-lg font-bold text-gray-900",children:ir.toFixed(1)})]})]}),Ee.feedback&&s.jsxs("p",{className:"text-sm text-gray-700 italic leading-relaxed",children:['"',Ee.feedback,'"']})]},Ee.label)})})]}),e.setlist&&s.jsx("div",{className:"mb-4",children:s.jsx(A2,{setlist:e.setlist,compact:!0,type:"api"})}),e.custom_setlist&&e.custom_setlist.length>0&&s.jsx("div",{className:"mb-4",children:s.jsx(A2,{customSetlist:e.custom_setlist,compact:!0,type:"custom"})}),s.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg border-2 border-gray-200",children:s.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[e.artist_name&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:Oe("px-3 py-1.5 rounded-full font-medium text-sm transition-all shadow-sm flex items-center gap-1.5",f.includes(e.artist_name)?"bg-[#FF3399] text-white border-2 border-[#FF3399]":"bg-white border-2 border-[#FF3399]/30 hover:border-[#FF3399] hover:bg-[#FF3399]/5"),onClick:Ee=>{Ee.preventDefault(),Ee.stopPropagation();const rt=e.artist_id||e.artist_uuid,ir=new CustomEvent("open-artist-card",{detail:{artistId:rt,artistName:e.artist_name}});document.dispatchEvent(ir)},"aria-label":`View artist ${e.artist_name}`,children:[f.includes(e.artist_name)&&s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})," ",e.artist_name]}),t&&s.jsx(n0,{artistName:e.artist_name,userId:t,variant:"outline",size:"sm",showFollowerCount:!1,className:"h-8 text-xs border-2"})]}),e.venue_name&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:Oe("px-3 py-1.5 rounded-full font-medium text-sm transition-all shadow-sm flex items-center gap-1.5",u.some(Ee=>Ee.name===e.venue_name&&(!Ee.city||Ee.city===e.venue_city)&&(!Ee.state||Ee.state===e.venue_state))?"bg-blue-600 text-white border-2 border-blue-600":"bg-white border-2 border-blue-200 hover:border-blue-400 hover:bg-blue-50"),onClick:Ee=>{Ee.preventDefault(),Ee.stopPropagation();const rt=e.venue_id||e.venue_uuid,ir=new CustomEvent("open-venue-card",{detail:{venueId:rt,venueName:e.venue_name}});document.dispatchEvent(ir)},"aria-label":`View venue ${e.venue_name}`,children:[u.some(Ee=>Ee.name===e.venue_name&&(!Ee.city||Ee.city===e.venue_city)&&(!Ee.state||Ee.state===e.venue_state))&&s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})," ",e.venue_name]}),t&&s.jsx(k1,{venueName:e.venue_name,venueCity:e.venue_city,venueState:e.venue_state,userId:t,variant:"outline",size:"sm",showFollowerCount:!1,className:"h-8 text-xs border-2"})]})]})}),s.jsxs("div",{className:"flex items-center justify-between pt-3 pb-2 border-t-2",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(ce,{variant:"ghost",size:"sm",onMouseDown:Ee=>{Ee.stopPropagation()},onClick:Ee=>{Ee.preventDefault(),Ee.stopPropagation(),ae()},disabled:!t||w,className:Oe("flex items-center gap-2 px-4 py-2 rounded-full font-medium transition-all",v?"bg-[#FF3399]/10 text-[#FF3399] hover:bg-[#FF3399]/20":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[s.jsx(zP,{className:Oe("h-5 w-5",v&&"fill-current")}),s.jsx("span",{className:"font-semibold",children:x}),s.jsx("span",{className:"hidden sm:inline",children:"Helpful"})]}),s.jsxs(ce,{variant:"ghost",size:"sm",onMouseDown:Ee=>{Ee.stopPropagation()},onClick:Ee=>{Ee.preventDefault(),Ee.stopPropagation(),fe()},className:"flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium transition-all",children:[s.jsx(Ln,{className:"h-5 w-5"}),s.jsx("span",{className:"font-semibold",children:A}),s.jsx("span",{className:"hidden sm:inline",children:"Comments"})]}),s.jsxs(ce,{variant:"ghost",size:"sm",onMouseDown:Ee=>{Ee.stopPropagation()},onClick:Ee=>{Ee.preventDefault(),Ee.stopPropagation(),ve()},className:"flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium transition-all",children:[s.jsx(Dc,{className:"h-5 w-5"}),s.jsx("span",{className:"hidden sm:inline",children:"Share"})]})]}),t&&!Te&&s.jsx(ce,{variant:"ghost",size:"sm",onMouseDown:Ee=>{Ee.stopPropagation()},onClick:Ee=>{Ee.preventDefault(),Ee.stopPropagation(),Y(!0)},className:"rounded-full p-2 text-gray-500 hover:text-red-600 hover:bg-red-50",title:"Report this review",children:s.jsx(eo,{className:"h-5 w-5"})})]})]}),N&&s.jsx("div",{className:"px-5 pb-3 pt-3 border-t-2",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Ln,{className:"w-5 h-5 text-[#FF3399]"}),"Comments (",A,")"]}),I?s.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[s.jsx(fr,{className:"h-4 w-4 animate-spin mr-2"}),"Loading comments"]}):k.length===0?s.jsx("div",{className:"text-sm text-gray-500 italic text-center py-4 bg-gray-50 rounded-lg",children:"No comments yet. Be the first to comment!"}):s.jsx("div",{className:"space-y-3",children:k.map(Ee=>{var rt,ir,rn,Mt;return s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsxs(Wr,{className:"w-9 h-9",children:[s.jsx(Qr,{src:((rt=Ee.user)==null?void 0:rt.avatar_url)||void 0,alt:((ir=Ee.user)==null?void 0:ir.name)||"User"}),s.jsx(Hr,{className:"text-xs bg-gradient-to-br from-[#FF3399] to-[#FF66B3] text-white",children:(((rn=Ee.user)==null?void 0:rn.name)||"U").charAt(0).toUpperCase()})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:((Mt=Ee.user)==null?void 0:Mt.name)||"User"}),s.jsx("span",{className:"text-xs text-gray-500",children:Uv(new Date(Ee.created_at),{addSuffix:!0})})]}),s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:Ee.comment_text})]})]},Ee.id)})}),s.jsxs("div",{className:"flex items-end gap-2 mt-4",children:[s.jsx(_s,{value:z,onChange:Ee=>M(Ee.target.value),placeholder:t?"Write a comment":"Sign in to comment",disabled:!t||B,className:"min-h-[60px] border-2 focus:border-[#FF3399] rounded-lg"}),s.jsx(ce,{onClick:we,disabled:!t||B||!z.trim(),className:"bg-gradient-to-r from-[#FF3399] to-[#FF66B3] hover:from-[#FF66B3] hover:to-[#FF3399] text-white",size:"lg",children:B?s.jsx(fr,{className:"h-5 w-5 animate-spin"}):s.jsx(qc,{className:"h-5 w-5"})})]})]})}),H&&U.length>0&&s.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center",onClick:Nt,role:"dialog","aria-modal":"true",children:[s.jsx("button",{className:"absolute top-4 right-4 text-white/80 hover:text-white text-3xl w-12 h-12 flex items-center justify-center rounded-full hover:bg-white/10","aria-label":"Close",onClick:Ee=>{Ee.stopPropagation(),Nt()},children:""}),U.length>1&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"absolute left-4 text-white/80 hover:text-white text-4xl w-12 h-12 flex items-center justify-center rounded-full hover:bg-white/10","aria-label":"Previous image",onClick:at,children:""}),s.jsx("button",{className:"absolute right-4 text-white/80 hover:text-white text-4xl w-12 h-12 flex items-center justify-center rounded-full hover:bg-white/10","aria-label":"Next image",onClick:ue,children:""})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("img",{src:U[K],alt:`Review photo ${K+1}`,className:"max-h-[85vh] max-w-[90vw] object-contain rounded-lg shadow-2xl",onClick:Ee=>Ee.stopPropagation()}),s.jsxs("p",{className:"text-white/70 mt-4 text-sm",children:[K+1," / ",U.length]})]})]}),s.jsx(E1,{open:ne,onClose:()=>Y(!1),contentType:"review",contentId:e.id,contentTitle:`Review for ${e.artist_name} at ${e.venue_name}`,onReportSubmitted:()=>{Y(!1),c==null||c(e.id)}}),de&&t&&s.jsx(MT,{review:e,currentUserId:t,isOpen:de,onClose:()=>_e(!1)})]})}var rl="Accordion",Cue=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[zT,Pue,Tue]=fp(rl),[P1,sUe]=$s(rl,[Tue,AB]),BT=AB(),DB=te.forwardRef((e,t)=>{const o=e,{type:r}=o,n=ge(o,["type"]),a=n,i=n;return s.jsx(zT.Provider,{scope:e.__scopeAccordion,children:r==="multiple"?s.jsx(Mue,V(D({},i),{ref:t})):s.jsx(Oue,V(D({},a),{ref:t}))})});DB.displayName=rl;var[IB,Aue]=P1(rl),[$B,Rue]=P1(rl,{collapsible:!1}),Oue=te.forwardRef((e,t)=>{const d=e,{value:r,defaultValue:n,onValueChange:a=()=>{},collapsible:i=!1}=d,o=ge(d,["value","defaultValue","onValueChange","collapsible"]),[l,c]=Ya({prop:r,defaultProp:n!=null?n:"",onChange:a,caller:rl});return s.jsx(IB,{scope:e.__scopeAccordion,value:te.useMemo(()=>l?[l]:[],[l]),onItemOpen:c,onItemClose:te.useCallback(()=>i&&c(""),[i,c]),children:s.jsx($B,{scope:e.__scopeAccordion,collapsible:i,children:s.jsx(LB,V(D({},o),{ref:t}))})})}),Mue=te.forwardRef((e,t)=>{const f=e,{value:r,defaultValue:n,onValueChange:a=()=>{}}=f,i=ge(f,["value","defaultValue","onValueChange"]),[o,l]=Ya({prop:r,defaultProp:n!=null?n:[],onChange:a,caller:rl}),c=te.useCallback(u=>l((h=[])=>[...h,u]),[l]),d=te.useCallback(u=>l((h=[])=>h.filter(m=>m!==u)),[l]);return s.jsx(IB,{scope:e.__scopeAccordion,value:o,onItemOpen:c,onItemClose:d,children:s.jsx($B,{scope:e.__scopeAccordion,collapsible:!0,children:s.jsx(LB,V(D({},i),{ref:t}))})})}),[Due,T1]=P1(rl),LB=te.forwardRef((e,t)=>{const m=e,{__scopeAccordion:r,disabled:n,dir:a,orientation:i="vertical"}=m,o=ge(m,["__scopeAccordion","disabled","dir","orientation"]),l=te.useRef(null),c=mr(l,t),d=Pue(r),u=Af(a)==="ltr",h=mt(e.onKeyDown,v=>{var R;if(!Cue.includes(v.key))return;const g=v.target,x=d().filter(I=>{var O;return!((O=I.ref.current)!=null&&O.disabled)}),_=x.findIndex(I=>I.ref.current===g),w=x.length;if(_===-1)return;v.preventDefault();let b=_;const N=0,S=w-1,k=()=>{b=_+1,b>S&&(b=N)},C=()=>{b=_-1,b<N&&(b=S)};switch(v.key){case"Home":b=N;break;case"End":b=S;break;case"ArrowRight":i==="horizontal"&&(u?k():C());break;case"ArrowDown":i==="vertical"&&k();break;case"ArrowLeft":i==="horizontal"&&(u?C():k());break;case"ArrowUp":i==="vertical"&&C();break}const A=b%w;(R=x[A].ref.current)==null||R.focus()});return s.jsx(Due,{scope:r,disabled:n,direction:a,orientation:i,children:s.jsx(zT.Slot,{scope:r,children:s.jsx(Pt.div,V(D({},o),{"data-orientation":i,ref:c,onKeyDown:n?void 0:h}))})})}),dw="AccordionItem",[Iue,UT]=P1(dw),FB=te.forwardRef((e,t)=>{const u=e,{__scopeAccordion:r,value:n}=u,a=ge(u,["__scopeAccordion","value"]),i=T1(dw,r),o=Aue(dw,r),l=BT(r),c=Os(),d=n&&o.value.includes(n)||!1,f=i.disabled||e.disabled;return s.jsx(Iue,{scope:r,open:d,disabled:f,triggerId:c,children:s.jsx(MB,V(D(D({"data-orientation":i.orientation,"data-state":WB(d)},l),a),{ref:t,disabled:f,open:d,onOpenChange:h=>{h?o.onItemOpen(n):o.onItemClose(n)}}))})});FB.displayName=dw;var zB="AccordionHeader",BB=te.forwardRef((e,t)=>{const o=e,{__scopeAccordion:r}=o,n=ge(o,["__scopeAccordion"]),a=T1(rl,r),i=UT(zB,r);return s.jsx(Pt.h3,V(D({"data-orientation":a.orientation,"data-state":WB(i.open),"data-disabled":i.disabled?"":void 0},n),{ref:t}))});BB.displayName=zB;var O2="AccordionTrigger",UB=te.forwardRef((e,t)=>{const c=e,{__scopeAccordion:r}=c,n=ge(c,["__scopeAccordion"]),a=T1(rl,r),i=UT(O2,r),o=Rue(O2,r),l=BT(r);return s.jsx(zT.ItemSlot,{scope:r,children:s.jsx(jue,V(D(D({"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":a.orientation,id:i.triggerId},l),n),{ref:t}))})});UB.displayName=O2;var qB="AccordionContent",VB=te.forwardRef((e,t)=>{const l=e,{__scopeAccordion:r}=l,n=ge(l,["__scopeAccordion"]),a=T1(rl,r),i=UT(qB,r),o=BT(r);return s.jsx(Nue,V(D(D({role:"region","aria-labelledby":i.triggerId,"data-orientation":a.orientation},o),n),{ref:t,style:D({"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)"},e.style)}))});VB.displayName=qB;function WB(e){return e?"open":"closed"}var $ue=DB,Lue=FB,Fue=BB,HB=UB,GB=VB;const zue=$ue,YB=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(Lue,D({ref:r,className:Oe("border-b",e)},t))});YB.displayName="AccordionItem";const KB=y.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=ge(i,["className","children"]);return s.jsx(Fue,{className:"flex",children:s.jsxs(HB,V(D({ref:n,className:Oe("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e)},r),{children:[t,s.jsx(Aa,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]}))})});KB.displayName=HB.displayName;const ZB=y.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=ge(i,["className","children"]);return s.jsx(GB,V(D({ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"},r),{children:s.jsx("div",{className:Oe("pb-4 pt-0",e),children:t})}))});ZB.displayName=GB.displayName;class nS{static resolveInternalEventId(t){return E(this,null,function*(){if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t))return t;const{data:n}=yield T.from("events").select("id").eq("jambase_event_id",t).limit(1).single();return(n==null?void 0:n.id)||t})}static getEventComments(t,r=20,n=0){return E(this,null,function*(){const a=yield this.resolveInternalEventId(t),{data:i,error:o}=yield T.from("entities").select("id").eq("entity_type","event").eq("entity_uuid",a).single();if(o&&o.code!=="PGRST116")throw o;if(!(i!=null&&i.id))return{comments:[],total:0,hasMore:!1};const l=i.id,{count:c,error:d}=yield T.from("comments").select("*",{count:"exact",head:!0}).eq("entity_id",l);if(d&&d.code!=="PGRST205")throw d;const f=c||0,{data:u,error:h}=yield T.from("comments").select("*").eq("entity_id",l).order("created_at",{ascending:!0}).range(n,n+r-1);if(h){if(h.code==="PGRST205")return console.warn("comments table not found. Did you run the consolidation migration?"),{comments:[],total:0,hasMore:!1};throw h}if(!u||u.length===0)return{comments:[],total:f,hasMore:!1};const m=[...new Set(u.map(b=>b.user_id))],{data:v,error:g}=yield T.from("users").select("id, name, avatar_url, user_id").in("user_id",m);if(g)throw g;const x=new Map;v==null||v.forEach(b=>{x.set(b.user_id,{id:b.id,name:b.name,avatar_url:b.avatar_url||void 0})});const _=u.map(b=>{var N;return{id:b.id,user_id:b.user_id,event_id:a,parent_comment_id:(N=b.parent_comment_id)!=null?N:null,comment_text:b.comment_text,created_at:b.created_at,updated_at:b.updated_at,user:x.get(b.user_id)||{id:b.user_id,name:"Unknown User"}}}),w=n+u.length<f;return{comments:_,total:f,hasMore:w}})}static addEventComment(t,r,n,a){return E(this,null,function*(){var f;const i=yield this.resolveInternalEventId(r),{data:o,error:l}=yield T.rpc("get_or_create_entity",{p_entity_type:"event",p_entity_uuid:i,p_entity_text_id:null});if(l)throw l;const{data:c,error:d}=yield T.from("comments").insert({user_id:t,entity_id:o,comment_text:n,parent_comment_id:a}).select().single();if(d)throw d.code==="PGRST205"?new Error("Event comments are not yet enabled. Please apply the consolidation migration."):d;return{id:c.id,user_id:c.user_id,event_id:i,parent_comment_id:(f=c.parent_comment_id)!=null?f:null,comment_text:c.comment_text,created_at:c.created_at,updated_at:c.updated_at}})}}function XB({eventId:e,isOpen:t,onClose:r,currentUserId:n,onCommentAdded:a,onCommentsLoaded:i}){const[o,l]=y.useState([]),[c,d]=y.useState(!1),[f,u]=y.useState(!1),[h,m]=y.useState(""),[v,g]=y.useState(null),[x,_]=y.useState(!1),[w,b]=y.useState(!1);y.useEffect(()=>{t&&e&&N()},[t,e]);const N=()=>E(this,null,function*(){if(e)try{d(!0),g(null);const C=yield nS.getEventComments(e,20,0);l(C.comments),_(C.hasMore),i&&i(C.comments.length)}catch(C){console.error("Failed to load event comments",C),g("Failed to load comments")}finally{d(!1)}}),S=()=>E(this,null,function*(){if(!(!e||w||!x))try{b(!0);const C=yield nS.getEventComments(e,20,o.length);l(A=>[...A,...C.comments]),_(C.hasMore)}catch(C){console.error("Failed to load more comments",C),g("Failed to load more comments")}finally{b(!1)}}),k=()=>E(this,null,function*(){if(!(!n||!e||!h.trim()||f))try{u(!0);const C=yield nS.addEventComment(n,e,h.trim());l(A=>[...A,V(D({},C),{user:{id:C.user_id,name:"You"}})]),m(""),a&&a()}catch(C){console.error("Failed to add comment",C),g("Failed to add comment")}finally{u(!1)}});return s.jsx(vn,{open:t,onOpenChange:C=>!C&&r(),children:s.jsxs(hn,{className:"sm:max-w-lg",children:[s.jsxs(Hn,{children:[s.jsx(Sn,{children:"Event Comments"}),s.jsx(ds,{children:"Discuss this event."})]}),s.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-1",children:[c?s.jsxs("div",{className:"flex items-center justify-center py-8 text-muted-foreground",children:[s.jsx(fr,{className:"h-5 w-5 animate-spin mr-2"})," Loading comments..."]}):v?s.jsx("div",{className:"text-sm text-red-600 py-4",children:v}):o.length===0?s.jsx("div",{className:"text-sm text-muted-foreground py-4",children:"No comments yet. Be the first to comment!"}):o.map(C=>s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs(Wr,{className:"h-8 w-8",children:[s.jsx(Qr,{src:C.user.avatar_url||void 0}),s.jsx(Hr,{children:(C.user.name||"U").slice(0,2).toUpperCase()})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-sm font-medium text-foreground",children:C.user.name||"User"}),s.jsx("div",{className:"text-sm text-foreground whitespace-pre-wrap",children:C.comment_text}),s.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(C.created_at).toLocaleString()})]})]},C.id)),x&&!c&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(ce,{variant:"outline",size:"sm",onClick:S,disabled:w,className:"text-sm",children:w?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"h-4 w-4 animate-spin mr-2"}),"Loading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Aa,{className:"h-4 w-4 mr-2"}),"Load More Comments"]})})})]}),s.jsx("div",{className:"pt-2 border-t mt-2",children:s.jsxs("div",{className:"flex items-end gap-2",children:[s.jsx(_s,{value:h,onChange:C=>m(C.target.value),placeholder:n?"Write a comment":"Sign in to comment",disabled:!n||f,className:"min-h-[72px]"}),s.jsx(ce,{onClick:k,disabled:!n||f||!h.trim(),className:"bg-pink-500 hover:bg-pink-600 text-white",children:f?s.jsx(fr,{className:"h-4 w-4 animate-spin"}):s.jsx(qc,{className:"h-4 w-4"})})]})})]})})}function Bue({eventId:e,onClick:t}){const[r,n]=y.useState(0),[a,i]=y.useState(!0);y.useEffect(()=>{o()},[e]);const o=()=>E(this,null,function*(){try{const{data:{user:l}}=yield T.auth.getUser();if(!l){i(!1);return}const{data:c}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${l.id},related_user_id.eq.${l.id}`);if(!c||c.length===0){i(!1);return}const d=c.map(h=>h.user_id===l.id?h.related_user_id:h.user_id),{data:f,error:u}=yield T.from("user_event_relationships").select("user_id").eq("event_id",e).eq("relationship_type","interested").in("user_id",d);if(!u&&f){n(f.length);return}if(u){console.error("Error loading friends interested from user_event_relationships:",u),n(0);return}n(0)}catch(l){console.error("Error loading friends interested:",l)}finally{i(!1)}});return a||r===0?null:s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--info-blue-050)",border:"2px solid var(--info-blue-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--info-blue-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",gap:"var(--spacing-inline, 6px)",cursor:t?"pointer":"default"},onClick:t,onMouseEnter:l=>{t&&(l.currentTarget.style.backgroundColor="var(--info-blue-050)",l.currentTarget.style.opacity="0.9")},onMouseLeave:l=>{t&&(l.currentTarget.style.backgroundColor="var(--info-blue-050)",l.currentTarget.style.opacity="1")},children:[s.jsx(Vr,{size:19}),s.jsxs("span",{children:[r," friend",r!==1?"s":""," interested"]})]})}function Uue({eventId:e,className:t}){const[r,n]=y.useState(!1),[a,i]=y.useState(!0);y.useEffect(()=>{o()},[e]);const o=()=>E(this,null,function*(){var l;try{const c=new Date;c.setHours(c.getHours()-24);const{count:d,error:f}=yield T.from("interactions").select("id",{count:"exact",head:!0}).eq("entity_type","event").eq("entity_id",e).gte("occurred_at",c.toISOString());if(f){if(f.code==="PGRST205"||(l=f.message)!=null&&l.includes("does not exist"))return;throw f}n((d||0)>=20)}catch(c){console.debug("Trending status check failed (non-critical):",c)}finally{i(!1)}});return a||!r?null:s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",background:"linear-gradient(135deg, #f97316 0%, #ec4899 100%)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-50)",boxShadow:"0 4px 4px 0 var(--shadow-color)",gap:"var(--spacing-inline, 6px)"},className:t,children:[s.jsx(YQ,{size:19,style:{fill:"currentColor"}}),s.jsx("span",{children:"Trending"})]})}function que({interestedCount:e,attendanceCount:t,className:r}){const a=(()=>{const o=e+(t||0);return o>=100?{tier:"mega",label:"Mega Popular",icon:uf,className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white"}:o>=50?{tier:"very",label:"Very Popular",icon:Fl,className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white"}:o>=20?{tier:"popular",label:"Popular",icon:Xt,className:"bg-blue-100 text-blue-800"}:null})();if(!a)return null;const i=a.icon;return s.jsxs(et,{className:`${a.className} ${r}`,children:[s.jsx(i,{className:"h-3 w-3 mr-1 fill-current"}),a.label]})}class sS{static recordSwipe(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:a,error:i}=yield T.rpc("get_or_create_entity",{p_entity_type:"user",p_entity_uuid:t.swiped_user_id,p_entity_text_id:null});if(i)throw i;const{error:o}=yield T.from("engagements").insert({user_id:r.id,entity_id:a,engagement_type:"swipe",engagement_value:t.is_interested?"right":"left",metadata:{event_id:t.event_id,swiped_user_id:t.swiped_user_id,is_interested:t.is_interested}});if(o)throw o;t.is_interested&&(yield this.checkForMatch(r.id,t.swiped_user_id,t.event_id))}catch(r){throw console.error("Error recording swipe:",r),r}})}static checkForMatch(t,r,n){return E(this,null,function*(){var a,i;try{const{data:o}=yield T.from("engagements").select("*").eq("user_id",r).eq("entity_type","user").eq("entity_id",t).eq("engagement_type","swipe").eq("engagement_value","right").eq("metadata->>event_id",n).single();if(o){yield T.from("user_relationships").insert([{user_id:t,related_user_id:r,relationship_type:"match",status:"accepted",metadata:{event_id:n,matched_user_id:r}},{user_id:r,related_user_id:t,relationship_type:"match",status:"accepted",metadata:{event_id:n,matched_user_id:t}}]);const{data:l}=yield T.from("events_with_artist_venue").select("title, artist_name_normalized").eq("id",n).single(),[c,d]=yield Promise.all([T.from("users").select("name").eq("user_id",t).single(),T.from("users").select("name").eq("user_id",r).single()]),f=((a=c.data)==null?void 0:a.name)||"Someone",u=((i=d.data)==null?void 0:i.name)||"Someone",h=(l==null?void 0:l.title)||"an event",m=[{user_id:t,type:"match",title:" It's a Match!",message:`You and ${u} both want to meet up at ${h}!`,data:{match_user_id:r,match_user_name:u,event_id:n,event_title:h,event_artist:l==null?void 0:l.artist_name_normalized},actor_user_id:r},{user_id:r,type:"match",title:" It's a Match!",message:`You and ${f} both want to meet up at ${h}!`,data:{match_user_id:t,match_user_name:f,event_id:n,event_title:h,event_artist:l==null?void 0:l.artist_name_normalized},actor_user_id:t}];yield T.from("notifications").insert(m),yield this.createMatchChat(t,r,n)}}catch(o){console.error("Error checking for match:",o)}})}static getPotentialMatches(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:a,error:i}=yield T.from("user_event_relationships").select("user_id").eq("event_id",t).in("relationship_type",["interested","going","maybe"]).neq("user_id",r.id);if(i)throw i;if(!a||a.length===0)return[];const o=a.map(f=>f.user_id),{data:l,error:c}=yield T.from("users").select(`
          user_id,
          name,
          avatar_url,
          bio,
          music_streaming_profile,
          gender,
          birthday,
          instagram_handle
        `).in("user_id",o);if(c)throw c;return(yield Promise.all((l||[]).map(f=>E(this,null,function*(){if(!f)return null;const{data:u}=yield T.from("engagements").select("id").eq("user_id",r.id).eq("entity_type","user").eq("entity_id",f.user_id).eq("engagement_type","swipe").eq("metadata->>event_id",t).single();if(u)return null;const{data:h}=yield T.rpc("is_user_blocked",{p_user_id:f.user_id,p_by_user_id:r.id});if(h)return null;const m=yield this.calculateCompatibility(r.id,f.user_id),v=yield this.getSharedPreferences(r.id,f.user_id);return{user_id:f.user_id,name:f.name,avatar_url:f.avatar_url,bio:f.bio,gender:f.gender,birthday:f.birthday,instagram_handle:f.instagram_handle,compatibility_score:m,shared_artists:v.artists,shared_genres:v.genres,music_streaming_profile:f.music_streaming_profile}})))).filter(f=>f!==null)}catch(r){throw console.error("Error getting potential matches:",r),r}})}static calculateCompatibility(t,r){return E(this,null,function*(){var n,a;try{const[i,o]=yield Promise.all([T.from("user_preferences").select("music_preference_signals").eq("user_id",t).single(),T.from("user_preferences").select("music_preference_signals").eq("user_id",r).single()]),l=((n=i.data)==null?void 0:n.music_preference_signals)||[],c=((a=o.data)==null?void 0:a.music_preference_signals)||[];if(!l.length||!c.length)return 50;const d=l.filter(x=>x.preference_type==="artist").map(x=>x.preference_value.toLowerCase()),f=l.filter(x=>x.preference_type==="genre").map(x=>x.preference_value.toLowerCase()),u=c.filter(x=>x.preference_type==="artist").map(x=>x.preference_value.toLowerCase()),h=c.filter(x=>x.preference_type==="genre").map(x=>x.preference_value.toLowerCase()),m=this.calculateOverlap(d,u),v=this.calculateOverlap(f,h),g=m*.6+v*.4;return Math.round(Math.min(100,Math.max(0,g*100)))}catch(i){return console.error("Error calculating compatibility:",i),50}})}static calculateOverlap(t,r){if(!(t!=null&&t.length)||!(r!=null&&r.length))return 0;const n=new Set(t),a=new Set(r);return[...n].filter(o=>a.has(o)).length/Math.max(n.size,a.size)}static getSharedPreferences(t,r){return E(this,null,function*(){var n,a;try{const[i,o]=yield Promise.all([T.from("user_preferences").select("music_preference_signals").eq("user_id",t).single(),T.from("user_preferences").select("music_preference_signals").eq("user_id",r).single()]),l=((n=i.data)==null?void 0:n.music_preference_signals)||[],c=((a=o.data)==null?void 0:a.music_preference_signals)||[];if(!l.length||!c.length)return{artists:[],genres:[]};const d=l.filter(g=>g.preference_type==="artist").map(g=>g.preference_value),f=l.filter(g=>g.preference_type==="genre").map(g=>g.preference_value),u=c.filter(g=>g.preference_type==="artist").map(g=>g.preference_value),h=c.filter(g=>g.preference_type==="genre").map(g=>g.preference_value),m=d.filter(g=>u.some(x=>x.toLowerCase()===g.toLowerCase())),v=f.filter(g=>h.some(x=>x.toLowerCase()===g.toLowerCase()));return{artists:m.slice(0,5),genres:v.slice(0,3)}}catch(i){return console.error("Error getting shared preferences:",i),{artists:[],genres:[]}}})}static createMatchChat(t,r,n){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("chat_participants").select("chat_id").eq("user_id",t);if(i)throw new Error(`Failed to check existing chats for user1: ${i.message}`);const{data:o,error:l}=yield T.from("chat_participants").select("chat_id").eq("user_id",r);if(l)throw new Error(`Failed to check existing chats for user2: ${l.message}`);const c=new Set((a==null?void 0:a.map(_=>_.chat_id))||[]),d=new Set((o==null?void 0:o.map(_=>_.chat_id))||[]),f=[...c].filter(_=>d.has(_));if(f.length>0){const{data:_,error:w}=yield T.from("chats").select("id").in("id",f).eq("is_group_chat",!1).limit(1);if(w)console.error("Error checking for existing direct chat:",w);else if(_&&_.length>0)return}const{data:u}=yield T.from("events_with_artist_venue").select("title, artist_name_normalized").eq("id",n).single(),h=(u==null?void 0:u.title)||"Concert Chat",{data:m,error:v}=yield T.from("chats").insert({chat_name:h,is_group_chat:!1}).select().single();if(v||!m)throw new Error(`Failed to create chat: ${(v==null?void 0:v.message)||"Unknown error"}`);const{error:g}=yield T.from("chat_participants").insert([{chat_id:m.id,user_id:t},{chat_id:m.id,user_id:r}]);if(g){const{error:_}=yield T.from("chats").delete().eq("id",m.id);throw _?(console.error(`CRITICAL: Failed to cleanup orphaned chat ${m.id} after participant insert failure. Original error: ${g.message}. Cleanup error: ${_.message}`),new Error(`Failed to add participants to chat: ${g.message}. CRITICAL: Cleanup also failed - orphaned chat ${m.id} may exist: ${_.message}`)):new Error(`Failed to add participants to chat: ${g.message}`)}const{error:x}=yield T.from("messages").insert({chat_id:m.id,sender_id:t,content:` You matched! Start chatting about ${(u==null?void 0:u.title)||"the event"}!`});x&&console.warn("Failed to send welcome message, but chat was created successfully:",x)}catch(a){console.error("Error creating match chat:",a)}})}static getEventMatches(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:a,error:i}=yield T.from("user_relationships").select("*").eq("relationship_type","match").eq("user_id",r.id).eq("metadata->>event_id",t);if(i)throw i;return yield Promise.all((a||[]).map(l=>E(this,null,function*(){var h;const c=l.related_user_id,d=(h=l.metadata)==null?void 0:h.event_id,[f,u]=yield Promise.all([T.from("users").select("user_id, name, avatar_url, bio").eq("user_id",c).single(),d?T.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date").eq("id",d).single():Promise.resolve({data:null})]);return V(D({},l),{user1_id:l.user_id,user2_id:l.related_user_id,event_id:d||t,matched_user:f.data,event:u.data})})))}catch(r){throw console.error("Error getting event matches:",r),r}})}static getAllMatches(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{data:n,error:a}=yield T.from("user_relationships").select("*").eq("relationship_type","match").eq("user_id",t.id).order("created_at",{ascending:!1});if(a)throw a;return yield Promise.all((n||[]).map(o=>E(this,null,function*(){var u;const l=o.related_user_id,c=(u=o.metadata)==null?void 0:u.event_id,[d,f]=yield Promise.all([T.from("users").select("user_id, name, avatar_url, bio, music_streaming_profile").eq("user_id",l).single(),c?T.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date, images").eq("id",c).single():Promise.resolve({data:null})]);return V(D({},o),{user1_id:o.user_id,user2_id:o.related_user_id,event_id:c||"",matched_user:d.data,event:f.data})})))}catch(t){throw console.error("Error getting all matches:",t),t}})}static hasSwipedOn(t,r){return E(this,null,function*(){try{const{data:{user:n},error:a}=yield T.auth.getUser();if(a||!n)throw new Error("User not authenticated");const{data:i}=yield T.from("engagements").select("id").eq("user_id",n.id).eq("entity_type","user").eq("entity_id",r).eq("engagement_type","swipe").eq("metadata->>event_id",t).single();return!!i}catch(n){return!1}})}static getMatchCount(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)return 0;const{count:n,error:a}=yield T.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","match").eq("user_id",t.id);if(a)throw a;return n||0}catch(t){return console.error("Error getting match count:",t),0}})}static getNotifications(t=20){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:a,error:i}=yield T.from("notifications").select(`
          *,
          actor_profile:actor_user_id (
            name,
            avatar_url
          )
        `).eq("user_id",r.id).order("created_at",{ascending:!1}).limit(t);if(i)throw i;return a||[]}catch(r){throw console.error("Error getting notifications:",r),r}})}static markNotificationRead(t){return E(this,null,function*(){try{const{error:r}=yield T.from("notifications").update({is_read:!0}).eq("id",t);if(r)throw r}catch(r){throw console.error("Error marking notification as read:",r),r}})}static getUnreadNotificationCount(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{count:n,error:a}=yield T.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",t.id).eq("is_read",!1);if(a)throw a;return n||0}catch(t){return console.error("Error getting unread notification count:",t),0}})}static getChats(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{data:n,error:a}=yield T.from("chat_participants").select("chat_id").eq("user_id",t.id);if(a)throw a;const i=(n==null?void 0:n.map(c=>c.chat_id))||[];if(i.length===0)return[];const{data:o,error:l}=yield T.from("chats").select(`
          *,
          messages (
            id,
            message,
            sender_id,
            created_at
          )
        `).in("id",i).order("updated_at",{ascending:!1});if(l)throw l;if(o&&o.length>0){const c=o.map(u=>u.id),{data:d}=yield T.from("chat_participants").select("chat_id, user_id").in("chat_id",c),f=new Map;return d==null||d.forEach(u=>{const h=f.get(u.chat_id)||[];h.push(u.user_id),f.set(u.chat_id,h)}),o.map(u=>V(D({},u),{users:f.get(u.id)||[]}))}return[]}catch(t){throw console.error("Error getting chats:",t),t}})}static sendMessage(t,r){return E(this,null,function*(){try{const{data:{user:n},error:a}=yield T.auth.getUser();if(a||!n)throw new Error("User not authenticated");const{error:i}=yield T.from("messages").insert({chat_id:t,sender_id:n.id,content:r});if(i)throw i;yield T.from("chats").update({updated_at:new Date().toISOString()}).eq("id",t)}catch(n){throw console.error("Error sending message:",n),n}})}}class uw{static requestPermission(){return E(this,null,function*(){if(!this.isSupported)return console.log("Push notifications not supported"),!1;try{return this.permission=yield Notification.requestPermission(),this.permission==="granted"}catch(t){return console.error("Error requesting notification permission:",t),!1}})}static isEnabled(){return this.isSupported&&this.permission==="granted"}static showMatchNotification(t){if(!this.isEnabled())return;const r=new Notification(" It's a Match!",{body:`You and ${t.userName} both want to meet up at ${t.eventTitle}!`,icon:"/favicon.png",badge:"/favicon.png",tag:"match-notification",requireInteraction:!0,actions:[{action:"view",title:"View Match"},{action:"chat",title:"Start Chat"}]});r.onclick=()=>{window.focus(),window.location.href="/matches",r.close()}}static showMessageNotification(t){if(!this.isEnabled())return;const r=new Notification(`Message from ${t.senderName}`,{body:t.message,icon:"/favicon.png",badge:"/favicon.png",tag:`message-${t.chatId}`,requireInteraction:!1});r.onclick=()=>{window.focus(),window.location.href=`/chat/${t.chatId}`,r.close()}}static initialize(){return E(this,null,function*(){this.isSupported&&(this.permission=Notification.permission,this.permission==="default"&&console.log("Notification permission not set. Consider showing a UI prompt."))})}static subscribeToServiceWorker(){return E(this,null,function*(){if("serviceWorker"in navigator)try{const t=yield navigator.serviceWorker.register("/sw.js");console.log("Service Worker registered:",t)}catch(t){console.error("Service Worker registration failed:",t)}})}}Pr(uw,"isSupported","Notification"in window),Pr(uw,"permission","default");typeof window!="undefined"&&uw.initialize();function Vue({eventId:e,eventTitle:t,interestedCount:r,onMatchCreated:n,onNavigateToProfile:a}){const{toast:i}=Er(),[o,l]=y.useState([]),[c,d]=y.useState(0),[f,u]=y.useState(!0),[h,m]=y.useState(!1),[v,g]=y.useState(null);y.useEffect(()=>{x()},[e]);const x=()=>E(this,null,function*(){u(!0);try{const b=yield sS.getPotentialMatches(e);l(b),d(0)}catch(b){console.error("Error loading potential matches:",b),i({title:"Error",description:"Failed to load potential concert buddies",variant:"destructive"})}finally{u(!1)}}),_=b=>E(this,null,function*(){const N=o[c];if(!(!N||h)){m(!0),g(b?"right":"left");try{yield sS.recordSwipe({event_id:e,swiped_user_id:N.user_id,is_interested:b});try{Zt.swipe("user",N.user_id,b?"like":"pass",{event_id:e,event_title:t},N.user_id)}catch(S){console.error("Error tracking swipe:",S)}b&&((yield sS.getEventMatches(e)).find(C=>C.user1_id===N.user_id||C.user2_id===N.user_id)?(i({title:" It's a Match!",description:`You and ${N.name} both want to meet up!`}),uw.showMatchNotification({userName:N.name,eventTitle:t}),n&&n(N)):i({title:" Sent!",description:`If ${N.name} swipes right too, you'll match!`})),setTimeout(()=>{d(S=>S+1),g(null),m(!1)},300)}catch(S){console.error("Error swiping:",S),i({title:"Error",description:"Failed to record swipe",variant:"destructive"}),g(null),m(!1)}}});if(f)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(fr,{className:"h-8 w-8 animate-spin text-purple-600"})});if(o.length===0)return s.jsx(Ze,{children:s.jsxs(tt,{className:"py-12 text-center",children:[s.jsx(es,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),r===0?s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No One Going Yet"}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Be the first to show interest in this event! Share it with friends to meet people going."})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"All Caught Up!"}),s.jsx("p",{className:"text-gray-600 text-sm",children:"You've swiped through everyone going to this event. Check back later for new people!"})]})]})});if(c>=o.length)return s.jsx(Ze,{children:s.jsxs(tt,{className:"py-12 text-center",children:[s.jsx(Fl,{className:"h-16 w-16 text-purple-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"All Done!"}),s.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"You've reviewed all people going to this event"}),s.jsx(ce,{onClick:x,variant:"outline",children:"Check for New People"})]})});const w=o[c];return s.jsxs("div",{className:"max-w-md mx-auto",children:[s.jsxs("div",{className:"mb-4 flex items-center justify-between text-sm text-gray-600",children:[s.jsxs("span",{children:[c+1," of ",o.length]}),s.jsxs("span",{className:"text-purple-600 font-medium",children:["Meet People Going to ",t]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Ze,{className:`transition-all duration-300 cursor-pointer hover:shadow-lg ${v==="left"?"translate-x-[-100%] opacity-0":v==="right"?"translate-x-[100%] opacity-0":""}`,onClick:b=>{b.stopPropagation(),a&&a(w.user_id)},children:s.jsxs(tt,{className:"p-0",children:[s.jsx("div",{className:"relative h-96 bg-gradient-to-br from-purple-100 to-pink-100 rounded-t-lg",children:w.avatar_url?s.jsx("img",{src:w.avatar_url,alt:w.name,className:"w-full h-full object-cover rounded-t-lg"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx("span",{className:"text-8xl font-bold text-purple-300",children:w.name.charAt(0).toUpperCase()})})}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-1",children:w.name}),w.bio&&s.jsx("p",{className:"text-gray-700 text-sm",children:w.bio})]}),w.music_streaming_profile&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Ft,{className:"h-4 w-4"}),s.jsx("span",{children:"Has Spotify connected"})]}),w.shared_artists&&w.shared_artists.length>0&&s.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-sm font-medium text-purple-900 mb-2",children:"Shared Artists"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:w.shared_artists.slice(0,5).map((b,N)=>s.jsx(et,{variant:"outline",className:"text-xs",children:b},N))})]}),(w.gender||w.birthday||w.instagram_handle)&&s.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Profile Highlights"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.gender&&s.jsx(et,{variant:"outline",className:"text-xs",children:w.gender}),w.birthday&&(()=>{const b=new Date().getFullYear()-new Date(w.birthday).getFullYear();return s.jsxs(et,{variant:"outline",className:"text-xs",children:[b," years old"]})})(),w.instagram_handle&&s.jsxs(et,{variant:"outline",className:"text-xs",children:["@",w.instagram_handle]})]})]}),w.compatibility_score!==void 0&&s.jsx("div",{className:"text-center pt-2",children:s.jsx("p",{className:"text-xs text-gray-500",children:"Based on music taste and preferences"})})]})]})}),s.jsxs("div",{className:"flex items-center justify-center gap-8 mt-6",children:[s.jsx(ce,{size:"lg",variant:"outline",onClick:()=>_(!1),disabled:h,className:"w-20 h-20 rounded-full border-2 border-red-300 hover:bg-red-50 hover:border-red-400",children:s.jsx(Yr,{className:"h-10 w-10 text-red-500"})}),s.jsx(ce,{size:"lg",variant:"default",onClick:()=>_(!0),disabled:h,className:"w-24 h-24 rounded-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 shadow-lg",children:s.jsx(es,{className:"h-12 w-12 fill-current"})})]}),s.jsxs("div",{className:"mt-6 text-center text-sm text-gray-600",children:[s.jsx("p",{children:"Swipe right if you'd like to meet up at this event"}),s.jsx("p",{className:"text-xs mt-1",children:"If they swipe right too, you'll match and can chat!"})]})]})]})}const mg={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"},Wue={sm:"text-xs",md:"text-sm",lg:"text-base",xl:"text-lg"},Tm=({size:e="md",variant:t="spinner",text:r,fullPage:n=!1,inline:a=!1,className:i,background:o="blur"})=>{const l=()=>{switch(t){case"spinner":return s.jsx("div",{className:Oe("relative",mg[e],"animate-spin rounded-full border-4 border-synth-pink/20","border-t-synth-pink border-r-synth-pink"),children:s.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-transparent border-t-synth-pink/40 animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})});case"pulse":return s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:Oe("rounded-full bg-gradient-to-br from-synth-pink to-synth-pink-light","animate-pulse",mg[e]),style:{boxShadow:"0 0 20px rgba(255, 51, 153, 0.4)"}}),s.jsx("div",{className:Oe("absolute inset-0 rounded-full bg-gradient-to-br from-synth-pink to-synth-pink-light","animate-ping opacity-75",mg[e])})]});case"dots":return s.jsx("div",{className:"flex items-center gap-2",children:[0,1,2].map(d=>s.jsx("div",{className:Oe("rounded-full bg-synth-pink",e==="sm"?"w-1.5 h-1.5":e==="md"?"w-2 h-2":e==="lg"?"w-3 h-3":"w-4 h-4","animate-bounce"),style:{animationDelay:`${d*.15}s`,animationDuration:"0.6s"}},d))});case"logo":return s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:Oe("flex items-center justify-center","rounded-full bg-gradient-to-br from-synth-pink/20 to-synth-pink-light/20","backdrop-blur-sm border-2 border-synth-pink/30",mg[e]),children:s.jsx(Ft,{className:Oe("text-synth-pink animate-pulse",e==="sm"?"w-2 h-2":e==="md"?"w-4 h-4":e==="lg"?"w-6 h-6":"w-8 h-8")})}),s.jsx("div",{className:Oe("absolute inset-0 rounded-full border-2 border-synth-pink/40","animate-ping",mg[e])})]});default:return null}},c=s.jsxs("div",{className:Oe("flex flex-col items-center justify-center gap-3",i),children:[l(),r&&s.jsx("p",{className:Oe("text-muted-foreground font-medium animate-pulse",Wue[e]),children:r})]});return n?s.jsx("div",{className:Oe("fixed inset-0 z-50 flex items-center justify-center",o==="blur"&&"bg-background/80 backdrop-blur-sm",o==="solid"&&"bg-background",o==="transparent"&&"bg-transparent"),children:s.jsx("div",{className:"text-center space-y-6",children:c})}):a?s.jsx("div",{className:Oe("flex items-center justify-center py-8",i),children:c}):c},A1=({text:e="Loading...",showLogo:t=!1})=>s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-white via-synth-beige/30 to-white",children:s.jsxs("div",{className:"text-center space-y-6 px-4",children:[t&&s.jsx("div",{className:"w-32 h-32 mx-auto mb-4",children:s.jsxs("div",{className:"relative w-full h-full",children:[s.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-synth-pink/20 to-synth-pink-light/20 animate-pulse"}),s.jsx("div",{className:"absolute inset-2 rounded-full bg-gradient-to-br from-synth-pink to-synth-pink-light flex items-center justify-center",children:s.jsx(Ft,{className:"w-16 h-16 text-white"})}),s.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-synth-pink/40 animate-ping"})]})}),s.jsx(Tm,{variant:"spinner",size:"lg",text:e})]})}),Nc=({text:e,size:t="md",variant:r="spinner"})=>s.jsx(Tm,{variant:r,size:t,text:e,inline:!0});class Hue{static uploadPhoto(t){return E(this,null,function*(){throw new Error("Photo uploads are handled through reviews. Please add photos when creating or editing a review.")})}static getEventPhotos(t,r=20,n=0){return E(this,null,function*(){try{const{data:{user:a}}=yield T.auth.getUser(),{data:i,error:o}=yield T.from("event_media").select(`
          id,
          url,
          review_id,
          created_at,
          review:reviews!event_media_review_id_fkey (
            user_id,
            user:users!reviews_user_id_fkey (
              name,
              avatar_url
            )
          )
        `).eq("event_id",t).eq("media_type","photo").order("created_at",{ascending:!1}).range(n,n+r-1);return o?(console.warn("Error getting event photos from event_media:",o),[]):(i||[]).map(c=>{const d=c.review,f=d==null?void 0:d.user;return{id:c.id,event_id:t,photo_url:c.url,caption:void 0,likes_count:0,comments_count:0,is_featured:!1,user_id:(d==null?void 0:d.user_id)||"",user_name:(f==null?void 0:f.name)||"Unknown",user_avatar_url:(f==null?void 0:f.avatar_url)||null,user_has_liked:!1,created_at:c.created_at}})}catch(a){return console.error("Error getting event photos:",a),[]}})}static togglePhotoLike(t,r){return E(this,null,function*(){console.warn("Photo likes not supported - photos are part of reviews")})}static addComment(t,r){return E(this,null,function*(){throw new Error("Photo comments not supported - photos are part of reviews. Please comment on the review instead.")})}static getPhotoComments(t){return E(this,null,function*(){return[]})}static deletePhoto(t){return E(this,null,function*(){throw new Error("Photos are part of reviews. Please edit the review to remove photos.")})}static updateCaption(t,r){return E(this,null,function*(){throw new Error("Photo captions not supported - photos are part of reviews.")})}static getUserPhotos(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const a=t||r.id,{data:i,error:o}=yield T.from("reviews").select("id").eq("user_id",a).eq("is_public",!0).eq("is_draft",!1);if(o||!i||i.length===0)return[];const l=i.map(u=>u.id),{data:c,error:d}=yield T.from("event_media").select(`
          id,
          url,
          review_id,
          event_id,
          created_at,
          review:reviews!event_media_review_id_fkey (
            user:users!reviews_user_id_fkey (
              name,
              avatar_url
            )
          ),
          event:events (
            id,
            title,
            artist_name,
            event_date
          )
        `).in("review_id",l).eq("media_type","photo").order("created_at",{ascending:!1});return d?(console.warn("Error getting user photos from event_media:",d),[]):(c||[]).map(u=>{const h=u.review,m=h==null?void 0:h.user;return{id:u.id,event_id:u.event_id||"",photo_url:u.url,caption:void 0,likes_count:0,comments_count:0,is_featured:!1,user_id:(h==null?void 0:h.user_id)||a,user_name:(m==null?void 0:m.name)||"Unknown",user_avatar_url:(m==null?void 0:m.avatar_url)||null,user_has_liked:!1,created_at:u.created_at}})}catch(r){return console.error("Error getting user photos:",r),[]}})}static toggleFeatured(t,r){return E(this,null,function*(){throw new Error("Photo featuring not supported - photos are part of reviews.")})}}function Gue({eventId:e,eventTitle:t,canUpload:r=!0}){const{user:n}=ws(),{toast:a}=Er(),[i,o]=y.useState([]),[l,c]=y.useState(!0);y.useEffect(()=>{d()},[e]);const d=()=>E(this,null,function*(){c(!0);try{const m=yield Hue.getEventPhotos(e,50);o(m)}catch(m){console.error("Error loading photos:",m),o([])}finally{c(!1)}}),f=m=>E(this,null,function*(){a({title:"Info",description:"Photos are part of reviews. Like the review instead."})}),u=m=>E(this,null,function*(){a({title:"Info",description:"Photos are part of reviews. Please edit the review to remove photos."})}),h=({photo:m})=>s.jsxs(Ze,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:m.photo_url,alt:m.caption||"Event photo",className:"w-full aspect-square object-cover cursor-pointer",onClick:()=>{}}),m.is_featured&&s.jsx(et,{className:"absolute top-2 right-2 bg-yellow-500",children:" Featured"})]}),s.jsxs(tt,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[m.user_avatar_url?s.jsx("img",{src:m.user_avatar_url,alt:m.user_name,className:"w-8 h-8 rounded-full"}):s.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center",children:s.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:m.user_name.charAt(0)})}),s.jsx("span",{className:"font-medium text-sm",children:m.user_name})]}),m.caption&&s.jsx("p",{className:"text-sm text-gray-700 mb-3",children:m.caption}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(ce,{variant:"ghost",size:"sm",onClick:()=>f(),className:m.user_has_liked?"text-red-500":"text-gray-600",children:[s.jsx(es,{className:`h-4 w-4 mr-1 ${m.user_has_liked?"fill-current":""}`}),m.likes_count]}),s.jsxs(ce,{variant:"ghost",size:"sm",onClick:()=>{a({title:"Info",description:"Photos are part of reviews. Comment on the review instead."})},className:"text-gray-600",children:[s.jsx(Ln,{className:"h-4 w-4 mr-1"}),m.comments_count]}),(n==null?void 0:n.id)===m.user_id&&s.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>u(),className:"text-gray-600 hover:text-red-600 ml-auto",children:s.jsx(Ko,{className:"h-4 w-4"})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(m.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})})]})]});return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold",children:"Event Photos"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[i.length," photo",i.length!==1?"s":""]})]}),r&&s.jsxs(ce,{onClick:()=>{a({title:"Info",description:"Photos are added through reviews. Please create or edit a review to add photos."})},size:"sm",children:[s.jsx(Y_,{className:"h-4 w-4 mr-2"}),"Upload Photo"]})]}),l?s.jsx(Nc,{text:"Loading photos...",size:"lg"}):i.length===0?s.jsx(Ze,{children:s.jsxs(tt,{className:"py-12 text-center",children:[s.jsx(G_,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),s.jsx("h4",{className:"text-lg font-semibold mb-2",children:"No Photos Yet"}),s.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Be the first to share a photo from this event!"}),r&&s.jsxs(ce,{onClick:()=>{a({title:"Info",description:"Photos are added through reviews. Please create or edit a review to add photos."})},children:[s.jsx(Y_,{className:"h-4 w-4 mr-2"}),"Upload First Photo"]})]})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(m=>s.jsx(h,{photo:m},m.id))})]})}class Yue{static createGroup(t){return E(this,null,function*(){var r;try{const{data:n,error:a}=yield T.rpc("create_event_group",{p_event_id:t.event_id,p_name:t.name,p_description:t.description||null,p_is_public:(r=t.is_public)!=null?r:!0,p_max_members:t.max_members||null});if(a)throw a;return n}catch(n){throw console.error("Error creating group:",n),n}})}static getEventGroups(t){return E(this,null,function*(){return[]})}static joinGroup(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("join_event_group",{p_group_id:t});if(r)throw r}catch(r){throw console.error("Error joining group:",r),r}})}static leaveGroup(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("leave_event_group",{p_group_id:t});if(r)throw r}catch(r){throw console.error("Error leaving group:",r),r}})}static getGroupMembers(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_group_members").select(`
          *,
          user:users!event_group_members_user_id_fkey (
            user_id,
            name,
            avatar_url,
            bio
          )
        `).eq("group_id",t).order("joined_at",{ascending:!0});if(n)throw n;return r||[]}catch(r){throw console.error("Error getting group members:",r),r}})}static getUserGroups(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{data:n,error:a}=yield T.from("event_group_members").select(`
          group:event_groups (
            *,
            event:events (
              id,
              title,
              artist_name,
              event_date,
              poster_image_url
            ),
            creator:users!event_groups_created_by_user_id_fkey (
              name,
              avatar_url
            )
          )
        `).eq("user_id",t.id).order("joined_at",{ascending:!1});if(a)throw a;return(n||[]).map(i=>i.group).filter(Boolean)}catch(t){throw console.error("Error getting user groups:",t),t}})}static updateGroup(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("event_groups").update(V(D({},r),{updated_at:new Date().toISOString()})).eq("id",t);if(n)throw n}catch(n){throw console.error("Error updating group:",n),n}})}static deleteGroup(t){return E(this,null,function*(){try{const{error:r}=yield T.from("event_groups").delete().eq("id",t);if(r)throw r}catch(r){throw console.error("Error deleting group:",r),r}})}static isMember(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)return!1;const{data:a}=yield T.from("event_group_members").select("id").eq("group_id",t).eq("user_id",r.id).single();return!!a}catch(r){return!1}})}static getGroup(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_groups").select(`
          *,
          event:jambase_events (
            id,
            title,
            artist_name,
            venue_name,
            event_date,
            poster_image_url
          ),
          creator:profiles!event_groups_created_by_user_id_fkey (
            name,
            avatar_url
          )
        `).eq("id",t).single();if(n)throw n;return r}catch(r){throw console.error("Error getting group:",r),r}})}}function Kue({open:e,onClose:t,event:r,onGroupCreated:n}){const{toast:a}=Er(),[i,o]=y.useState(!1),[l,c]=y.useState({name:"",description:"",is_public:!0,max_members:""}),d=m=>{const{name:v,value:g}=m.target;c(x=>V(D({},x),{[v]:g}))},f=m=>E(this,null,function*(){if(m.preventDefault(),!l.name.trim()){a({title:"Group name required",description:"Please enter a name for your group",variant:"destructive"});return}o(!0);try{const v=yield Yue.createGroup({event_id:r.id,name:l.name.trim(),description:l.description.trim()||void 0,is_public:l.is_public,max_members:l.max_members?parseInt(l.max_members):void 0});try{Zt.click("view","create_event_group",{event_id:r.id,artist_name:r.artist_name,group_name:l.name},r.id)}catch(g){console.error("Error tracking group creation:",g)}a({title:"Group Created! ",description:`${l.name} is ready for members`}),n==null||n(v),u()}catch(v){console.error("Error creating group:",v),a({title:"Error",description:v instanceof Error?v.message:"Failed to create group",variant:"destructive"})}finally{o(!1)}}),u=()=>{i||(c({name:"",description:"",is_public:!0,max_members:""}),t())},h=m=>new Date(m).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"});return s.jsx(vn,{open:e,onOpenChange:u,children:s.jsxs(hn,{className:"sm:max-w-[550px]",children:[s.jsxs(Hn,{children:[s.jsxs(Sn,{className:"flex items-center gap-2",children:[s.jsx(Vr,{className:"h-5 w-5 text-purple-600"}),"Create Event Group"]}),s.jsx(ds,{children:"Start a community for this event. Chat, share plans, and meet up!"})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[s.jsx("p",{className:"font-semibold text-sm mb-1",children:r.title}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-700",children:[s.jsx(Lt,{className:"h-3 w-3"}),s.jsx("span",{children:h(r.event_date)})]})]}),s.jsxs("form",{onSubmit:f,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(qt,{htmlFor:"name",children:["Group Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Nr,{id:"name",name:"name",placeholder:"e.g., Taylor Swift Squad, VIP Section Crew",value:l.name,onChange:d,disabled:i,maxLength:50})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"description",children:"Description (Optional)"}),s.jsx(_s,{id:"description",name:"description",placeholder:"What's this group about?",value:l.description,onChange:d,disabled:i,rows:3,maxLength:200})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(qt,{children:"Privacy"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-start p-3 border rounded-lg cursor-pointer",children:[s.jsx("input",{type:"radio",name:"privacy",checked:l.is_public,onChange:()=>c(m=>V(D({},m),{is_public:!0})),disabled:i,className:"mt-0.5 mr-3"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xi,{className:"h-4 w-4 text-green-600"}),s.jsx("span",{className:"font-medium text-sm",children:"Public"})]}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Anyone can find and join this group"})]})]}),s.jsxs("label",{className:"flex items-start p-3 border rounded-lg cursor-pointer",children:[s.jsx("input",{type:"radio",name:"privacy",checked:!l.is_public,onChange:()=>c(m=>V(D({},m),{is_public:!1})),disabled:i,className:"mt-0.5 mr-3"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Rv,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm",children:"Private"})]}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Only you can invite members"})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"max_members",children:"Max Members (Optional)"}),s.jsx(Nr,{id:"max_members",name:"max_members",type:"number",placeholder:"Leave blank for unlimited",value:l.max_members,onChange:d,disabled:i,min:"2",max:"100"})]}),s.jsxs(Tf,{children:[s.jsx(ce,{type:"button",variant:"outline",onClick:u,disabled:i,children:"Cancel"}),s.jsx(ce,{type:"submit",disabled:i||!l.name.trim(),children:i?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Vr,{className:"w-4 h-4 mr-2"}),"Create Group"]})})]})]})]})})}class Qh{static isUserVisible(t,r,n=!1){if(t.user_id===r||n)return!0;const a=t.avatar_url&&t.avatar_url.trim()!=="",i=t.is_public_profile===!0;return a&&i}static filterVisibleUsers(t,r,n=[]){return t.filter(a=>{const i=n.includes(a.user_id);return this.isUserVisible(a,r,i)})}static isVisibleInSearch(t,r,n=!1){return t.user_id===r,!0}static isVisibleForMatching(t,r,n=!1){if(t.user_id===r||n)return!0;const a=t.avatar_url&&t.avatar_url.trim()!=="",i=t.is_public_profile===!0;return a&&i}static formatLastActive(t){if(!t)return"Recently";try{const r=typeof t=="string"?new Date(t):t,a=new Date().getTime()-r.getTime(),i=Math.floor(a/(1e3*60)),o=Math.floor(a/(1e3*60*60)),l=Math.floor(a/(1e3*60*60*24));return i<1?"Just now":i<60?`${i}m ago`:o<24?`${o}h ago`:l<7?`${l}d ago`:Uv(r,{addSuffix:!0})}catch(r){return console.error("Error formatting last active time:",r),"Recently"}}static updateLastActive(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("update_user_last_active",{user_id_param:t});r&&console.error("Error updating last active:",r)}catch(r){console.error("Failed to update last active:",r)}})}static getUserVisibilitySettings(t){return E(this,null,function*(){var r;try{const{data:n,error:a}=yield T.from("users").select("avatar_url, is_public_profile, last_active_at").eq("user_id",t).single();return a?(console.error("Error fetching visibility settings:",a),null):{has_avatar:!!(n!=null&&n.avatar_url),is_public_profile:(r=n==null?void 0:n.is_public_profile)!=null?r:!0,last_active_at:(n==null?void 0:n.last_active_at)||new Date().toISOString()}}catch(n){return console.error("Failed to fetch visibility settings:",n),null}})}static setProfileVisibility(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("users").update({is_public_profile:r}).eq("user_id",t);return n?(console.error("Error updating profile visibility:",n),!1):!0}catch(n){return console.error("Failed to update profile visibility:",n),!1}})}static hasProfilePicture(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("users").select("avatar_url").eq("user_id",t).single();return n?(console.error("Error checking profile picture:",n),!1):!!(r!=null&&r.avatar_url&&r.avatar_url.trim()!=="")}catch(r){return console.error("Failed to check profile picture:",r),!1}})}static getFriendIds(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);return n?(console.error("Error fetching friends:",n),[]):(r||[]).map(a=>a.user_id===t?a.related_user_id:a.user_id)}catch(r){return console.error("Failed to fetch friends:",r),[]}})}}const Zue=({friend:e,isOpen:t,onClose:r,onStartChat:n,onAddFriend:a,onUnfriend:i,onNavigateToProfile:o})=>t?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:9999},children:s.jsxs(Ze,{className:"w-full max-w-md max-h-[80vh] overflow-y-auto",children:[s.jsx(kr,{className:"pb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Lr,{className:"text-xl font-bold",children:"Profile"}),s.jsx(ce,{variant:"ghost",size:"sm",onClick:r,className:"h-8 w-8 p-0",children:s.jsx(Yr,{className:"h-4 w-4"})})]})}),s.jsxs(tt,{className:"space-y-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs(Wr,{className:"w-20 h-20 mx-auto mb-3",children:[s.jsx(Qr,{src:e.avatar_url||void 0}),s.jsx(Hr,{className:"text-xl",children:e.name?e.name.split(" ").map(l=>l[0]).join(""):"F"})]}),s.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:e.name}),e.verified&&e.account_type&&s.jsx(PT,{accountType:e.account_type,verified:e.verified,size:"md"})]}),s.jsxs("p",{className:"text-gray-600 mb-2 text-sm",children:["@",e.username]}),(e.gender||e.birthday)&&s.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2 w-full",children:[e.gender&&s.jsx(et,{variant:"secondary",className:"text-xs",children:e.gender}),e.birthday&&s.jsx(et,{variant:"secondary",className:"text-xs",children:(()=>{const l=new Date(e.birthday),c=new Date;let d=c.getFullYear()-l.getFullYear();const f=c.getMonth()-l.getMonth();return(f<0||f===0&&c.getDate()<l.getDate())&&d--,`${d} years old`})()})]}),e.last_active_at&&s.jsxs(et,{variant:"secondary",className:"mb-2 flex items-center gap-1 text-xs mx-auto w-fit",children:[s.jsx(Oa,{className:"w-3 h-3"}),Qh.formatLastActive(e.last_active_at)]}),s.jsxs(et,{variant:"secondary",className:"bg-blue-100 text-blue-800 text-xs",children:[s.jsx(Is,{className:"w-3 h-3 mr-1"}),"Friend"]})]}),e.bio&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"About"}),s.jsx("p",{className:"text-gray-700 text-sm leading-relaxed px-2",children:e.bio})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx(Lt,{className:"w-3 h-3"}),s.jsxs("span",{children:["Member since ",(()=>{try{return Rt(gs(e.created_at),"MMMM yyyy")}catch(l){return e.created_at}})()]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Music Preferences"}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.jsxs(et,{variant:"outline",className:"text-xs",children:[s.jsx(Ft,{className:"w-3 h-3 mr-1"}),"Concert Lover"]}),s.jsxs(et,{variant:"outline",className:"text-xs",children:[s.jsx(es,{className:"w-3 h-3 mr-1"}),"Live Music"]}),s.jsxs(et,{variant:"outline",className:"text-xs",children:[s.jsx(Xt,{className:"w-3 h-3 mr-1"}),"Music Enthusiast"]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Recent Activity"}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),s.jsx("span",{children:"Active now"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx(Ft,{className:"w-3 h-3"}),s.jsx("span",{children:"Recently reviewed a concert"})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-2 pt-3 border-t",children:[s.jsxs("div",{className:"flex gap-2",children:[a&&s.jsx(ce,{variant:"outline",className:"flex-1 text-sm",size:"sm",onClick:l=>E(void 0,null,function*(){l.preventDefault(),l.stopPropagation(),console.log(" Add Friend button clicked for:",e.name,"ID:",e.user_id);try{yield a(e.user_id),console.log(" Add friend request completed")}catch(c){console.error(" Error in Add Friend:",c)}}),children:"Add Friend"}),s.jsxs(ce,{variant:"outline",className:"flex-1 text-sm",size:"sm",onClick:l=>{l.preventDefault(),l.stopPropagation(),o&&(o(e.user_id),r())},children:[s.jsx(Is,{className:"w-3 h-3 mr-1"}),"Full Profile"]}),s.jsxs(ce,{className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white text-sm",size:"sm",onClick:l=>{l.preventDefault(),l.stopPropagation(),n&&n(e.user_id),r()},children:[s.jsx(Ln,{className:"w-3 h-3 mr-1"}),"Start Chat"]})]}),i&&s.jsxs(ce,{variant:"destructive",className:"w-full text-sm",size:"sm",onClick:()=>E(void 0,null,function*(){try{yield i(e.user_id),r()}catch(l){console.error("Error unfriending user:",l)}}),children:[s.jsx(az,{className:"w-3 h-3 mr-1"}),"Unfriend"]})]})]})]})}):null;function Vv(e){if(!e)return"";if(e.startsWith("$"))return e;if(e.includes("-")){const[t,r]=e.split("-");return`$${t.trim()}-$${r.trim()}`}return`$${e.trim()}`}function Xue(e){if(!e)return 0;const t=e.match(/\$?(\d+)/);return t?parseInt(t[1]):0}const JB=""+new URL("Synth_Placeholder-oP3veiyu.png",import.meta.url).href,tc=e=>typeof e.rating=="number"?e.rating:0;function qT({artistName:e,venueName:t,artistId:r,venueId:n}){const[a,i]=y.useState({totalReviews:0,averageRating:0,loading:!0}),[o,l]=y.useState({totalReviews:0,averageRating:0,loading:!0}),[c,d]=y.useState([]),[f,u]=y.useState([]),[h,m]=y.useState("newest"),[v,g]=y.useState("newest"),[x,_]=y.useState(!1),[w,b]=y.useState(!1);y.useEffect(()=>{E(this,null,function*(){console.log(" ArtistVenueReviews - Searching for:",{artistName:e,venueName:t});try{let R=[];const{data:I}=yield T.from("artists").select("id, name").ilike("name",e).maybeSingle();if(I){const{data:B,error:F}=yield T.from("events_with_artist_venue").select("id").eq("artist_id",I.id).limit(1e3);!F&&B&&(R=B)}if(R.length===0){const{data:B,error:F}=yield T.from("events_with_artist_venue").select("id").ilike("artist_name_normalized",`${e}%`).limit(500);!F&&B&&(R=B)}if(R.length===0){const{data:B,error:F}=yield T.from("events_with_artist_venue").select("id").ilike("artist_name_normalized",`%${e}%`).limit(500);if(F){console.error("Error fetching event IDs for artist:",F),i({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load artist reviews"});return}B&&(R=B)}const O=R.map(B=>B.id);if(O.length===0){i({totalReviews:0,averageRating:0,loading:!1});return}const{data:z,error:M}=yield T.from("reviews").select(`
            rating,
            review_text,
            created_at,
            event_id
          `).eq("is_public",!0).in("event_id",O);if(M)console.error("Error fetching artist reviews:",M),i({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load artist reviews"});else if(z&&z.length>0){const B=z.map(K=>tc(K)).filter(K=>typeof K=="number"&&K>0),F=B.length,U=F>0?B.reduce((K,Z)=>K+Z,0)/F:0;i({totalReviews:F,averageRating:U,loading:!1});const{data:H,error:q}=yield T.from("reviews").select(`
              id,
              user_id,
              event_id,
              rating,
              artist_performance_rating,
              production_rating,
              venue_rating,
              location_rating,
              value_rating,
              artist_performance_feedback,
              production_feedback,
              venue_feedback,
              location_feedback,
              value_feedback,
              ticket_price_paid,
              review_text,
              created_at,
              mood_tags,
              genre_tags,
              reaction_emoji,
              photos
            `).eq("is_public",!0);if(!q&&H){const K=H.filter(de=>!0),Z=K.map(de=>de.user_id).filter(Boolean),{data:ne}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",Z),Y=K.map(de=>de.event_id).filter(Boolean),{data:X}=yield T.from("events_with_artist_venue").select("id, artist_id, venue_id, event_date, title, artist_name_normalized, venue_name_normalized").in("id",Y),se=K.map(de=>{var oe,ie,ee,G,J,ae,fe,we,ve,me,Me;const _e=ne==null?void 0:ne.find(Te=>Te.user_id===de.user_id),xe=X==null?void 0:X.find(Te=>Te.id===de.event_id);return{id:de.id,rating:de.rating,artist_performance_rating:(oe=de.artist_performance_rating)!=null?oe:void 0,production_rating:(ie=de.production_rating)!=null?ie:void 0,venue_rating:(ee=de.venue_rating)!=null?ee:void 0,location_rating:(G=de.location_rating)!=null?G:void 0,value_rating:(J=de.value_rating)!=null?J:void 0,artist_performance_feedback:(ae=de.artist_performance_feedback)!=null?ae:void 0,production_feedback:(fe=de.production_feedback)!=null?fe:void 0,venue_feedback:(we=de.venue_feedback)!=null?we:void 0,location_feedback:(ve=de.location_feedback)!=null?ve:void 0,value_feedback:(me=de.value_feedback)!=null?me:void 0,ticket_price_paid:(Me=de.ticket_price_paid)!=null?Me:void 0,review_text:de.review_text,created_at:de.created_at,reviewer_name:(_e==null?void 0:_e.name)||"Anonymous",reviewer_avatar:(_e==null?void 0:_e.avatar_url)||null,event_title:(xe==null?void 0:xe.title)||"",event_date:(xe==null?void 0:xe.event_date)||"",mood_tags:de.mood_tags||[],genre_tags:de.genre_tags||[],reaction_emoji:de.reaction_emoji||null,artist_name:(xe==null?void 0:xe.artist_name_normalized)||"",venue_name:(xe==null?void 0:xe.venue_name_normalized)||"",photos:Array.isArray(de.photos)?de.photos:[],category_average:tc(de)}}).filter(de=>de.artist_name&&de.artist_name.toLowerCase().includes(e.toLowerCase()));d(se)}}else i({totalReviews:0,averageRating:0,loading:!1})}catch(R){console.error("Error fetching artist reviews:",R),i({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load artist reviews"}),d([])}try{const{data:R,error:I}=yield T.from("events_with_artist_venue").select("id").ilike("venue_name_normalized",`%${t}%`);if(I){console.error("Error fetching event IDs for venue:",I),l({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load venue reviews"});return}const O=(R==null?void 0:R.map(U=>U.id))||[];if(O.length===0){l({totalReviews:0,averageRating:0,loading:!1});return}const{data:z,error:M}=yield T.from("reviews").select(`
            rating,
            review_text,
            created_at,
            event_id
          `).eq("is_public",!0).in("event_id",O),{data:B,error:F}=O.length>0?yield T.from("reviews").select(`
                id,
                event_id
              `).eq("is_public",!0).in("event_id",O):{data:[],error:null};if(M)console.error("Error fetching venue reviews:",M),l({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load venue reviews"});else if(z&&z.length>0){const U=z.map(ne=>tc(ne)).filter(ne=>typeof ne=="number"&&ne>0),H=U.length,q=H>0?U.reduce((ne,Y)=>ne+Y,0)/H:0;l({totalReviews:H,averageRating:q,loading:!1});const{data:K,error:Z}=yield T.from("reviews").select(`
              id,
              user_id,
              event_id,
              rating,
              artist_performance_rating,
              production_rating,
              venue_rating,
              location_rating,
              value_rating,
              artist_performance_feedback,
              production_feedback,
              venue_feedback,
              location_feedback,
              value_feedback,
              ticket_price_paid,
              review_text,
              created_at,
              mood_tags,
              genre_tags,
              reaction_emoji,
              photos
            `).eq("is_public",!0);if(!Z&&K){const ne=K.filter(xe=>xe.venue_rating||xe.artist_performance_rating||xe.production_rating||xe.location_rating||xe.value_rating),Y=ne.map(xe=>xe.user_id).filter(Boolean),{data:X}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",Y),se=ne.map(xe=>xe.event_id).filter(Boolean),{data:de}=yield T.from("events_with_artist_venue").select("id, artist_id, venue_id, event_date, title, artist_name_normalized, venue_name_normalized").in("id",se),_e=ne.map(xe=>{var ie,ee,G,J,ae,fe,we,ve,me,Me,Te;const Q=X==null?void 0:X.find(Ve=>Ve.user_id===xe.user_id),oe=de==null?void 0:de.find(Ve=>Ve.id===xe.event_id);return{id:xe.id,rating:xe.rating,artist_performance_rating:(ie=xe.artist_performance_rating)!=null?ie:void 0,production_rating:(ee=xe.production_rating)!=null?ee:void 0,venue_rating:(G=xe.venue_rating)!=null?G:void 0,location_rating:(J=xe.location_rating)!=null?J:void 0,value_rating:(ae=xe.value_rating)!=null?ae:void 0,artist_performance_feedback:(fe=xe.artist_performance_feedback)!=null?fe:void 0,production_feedback:(we=xe.production_feedback)!=null?we:void 0,venue_feedback:(ve=xe.venue_feedback)!=null?ve:void 0,location_feedback:(me=xe.location_feedback)!=null?me:void 0,value_feedback:(Me=xe.value_feedback)!=null?Me:void 0,ticket_price_paid:(Te=xe.ticket_price_paid)!=null?Te:void 0,review_text:xe.review_text,created_at:xe.created_at,reviewer_name:(Q==null?void 0:Q.name)||"Anonymous",reviewer_avatar:(Q==null?void 0:Q.avatar_url)||null,event_title:(oe==null?void 0:oe.title)||"",event_date:(oe==null?void 0:oe.event_date)||"",mood_tags:xe.mood_tags||[],genre_tags:xe.genre_tags||[],reaction_emoji:xe.reaction_emoji||null,artist_name:(oe==null?void 0:oe.artist_name)||"",venue_name:(oe==null?void 0:oe.venue_name)||"",photos:Array.isArray(xe.photos)?xe.photos:[],category_average:tc(xe)}}).filter(xe=>{const Q=xe.venue_name&&xe.venue_name.toLowerCase().includes(t.toLowerCase());return console.log(" Venue matching:",{reviewVenue:xe.venue_name,searchVenue:t,matches:Q}),Q});u(_e)}}else l({totalReviews:0,averageRating:0,loading:!1})}catch(R){console.error("Error fetching venue reviews:",R),l({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load venue reviews"}),u([])}})},[e,t]);const N=(A,R)=>{const I=[...A];switch(R){case"newest":return I.sort((O,z)=>new Date(z.created_at).getTime()-new Date(O.created_at).getTime());case"oldest":return I.sort((O,z)=>new Date(O.created_at).getTime()-new Date(z.created_at).getTime());case"highest_rating":return I.sort((O,z)=>{var F,U;const M=(F=O.category_average)!=null?F:tc(O);return(((U=z.category_average)!=null?U:tc(z))||0)-(M||0)});case"lowest_rating":return I.sort((O,z)=>{var F,U;const M=(F=O.category_average)!=null?F:tc(O),B=(U=z.category_average)!=null?U:tc(z);return(M||0)-(B||0)});default:return I}},S=A=>{const R=[],I=Math.floor(A),O=A%1>=.5;for(let M=0;M<I;M++)R.push(s.jsx(Xt,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},M));O&&R.push(s.jsx(Xt,{className:"w-4 h-4 fill-yellow-400/50 text-yellow-400"},"half"));const z=5-Math.ceil(A);for(let M=0;M<z;M++)R.push(s.jsx(Xt,{className:"w-4 h-4 text-gray-300"},`empty-${M}`));return R},k=A=>new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),C=(A,R=!0)=>{var O;const I=(O=A.category_average)!=null?O:tc(A);return s.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("img",{src:A.reviewer_avatar||JB,alt:A.reviewer_name,className:"w-8 h-8 rounded-full"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-sm",children:A.reviewer_name}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(Lt,{className:"w-3 h-3"}),k(A.event_date)]}),R&&A.venue_name&&s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx(yr,{className:"w-3 h-3"}),A.venue_name]}),!R&&A.artist_name&&s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx(Ft,{className:"w-3 h-3"}),A.artist_name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[S(I),s.jsx("span",{className:"text-sm font-medium ml-1",children:I.toFixed(1)})]})]}),A.review_text&&s.jsx("p",{className:"text-sm text-gray-700",children:A.review_text}),[{label:"Artist performance",rating:A.artist_performance_rating,feedback:A.artist_performance_feedback},{label:"Production",rating:A.production_rating,feedback:A.production_feedback},{label:"Venue",rating:A.venue_rating,feedback:A.venue_feedback},{label:"Location",rating:A.location_rating,feedback:A.location_feedback},{label:"Value",rating:A.value_rating,feedback:A.value_feedback}].filter(({rating:z,feedback:M})=>z||M).map(({label:z,rating:M,feedback:B})=>s.jsxs("div",{className:"text-sm border-l-4 border-pink-200 pl-2 mt-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium text-gray-600",children:z}),typeof M=="number"&&s.jsx("span",{className:"text-xs text-gray-500",children:M.toFixed(1)})]}),B&&s.jsxs("div",{className:"text-xs text-gray-700 italic",children:["",B,""]})]},z)),A.mood_tags&&A.mood_tags.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:A.mood_tags.map((z,M)=>s.jsx(et,{variant:"secondary",className:"text-xs",children:z},M))}),A.reaction_emoji&&s.jsx("div",{className:"text-lg",children:A.reaction_emoji})]},A.id)};return s.jsxs("div",{className:"space-y-6 mb-6",children:[s.jsxs(Ze,{className:"border-gray-200",children:[s.jsx(kr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ft,{className:"w-5 h-5 text-pink-500"}),s.jsx(Lr,{className:"text-lg",children:"Artist Reviews"})]}),a.totalReviews>0&&s.jsxs(ce,{variant:"ghost",size:"sm",onClick:()=>_(!x),className:"flex items-center gap-1",children:[x?s.jsx(Lo,{className:"w-4 h-4"}):s.jsx(Aa,{className:"w-4 h-4"}),x?"Hide":"View"," Reviews"]})]})}),s.jsx(tt,{className:"pt-0",children:a.loading?s.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."}):a.totalReviews>0?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[S(a.averageRating),s.jsx("span",{className:"text-sm font-medium",children:a.averageRating.toFixed(1)}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",a.totalReviews," review",a.totalReviews!==1?"s":"",")"]})]}),x&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),s.jsxs("select",{value:h,onChange:A=>m(A.target.value),className:"w-40 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500",children:[s.jsx("option",{value:"newest",children:"Newest"}),s.jsx("option",{value:"oldest",children:"Oldest"}),s.jsx("option",{value:"highest_rating",children:"Highest Rating"}),s.jsx("option",{value:"lowest_rating",children:"Lowest Rating"})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:N(c,h).map(A=>C(A,!0))})]})]}):s.jsxs("div",{className:"text-sm text-gray-500",children:["No reviews yet for ",e]})})]}),s.jsxs(Ze,{className:"border-gray-200",children:[s.jsx(kr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(yr,{className:"w-5 h-5 text-pink-500"}),s.jsx(Lr,{className:"text-lg",children:"Venue Reviews"})]}),o.totalReviews>0&&s.jsxs(ce,{variant:"ghost",size:"sm",onClick:()=>b(!w),className:"flex items-center gap-1",children:[w?s.jsx(Lo,{className:"w-4 h-4"}):s.jsx(Aa,{className:"w-4 h-4"}),w?"Hide":"View"," Reviews"]})]})}),s.jsx(tt,{className:"pt-0",children:o.loading?s.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."}):o.totalReviews>0?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[S(o.averageRating),s.jsx("span",{className:"text-sm font-medium",children:o.averageRating.toFixed(1)}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",o.totalReviews," review",o.totalReviews!==1?"s":"",")"]})]}),w&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),s.jsxs("select",{value:v,onChange:A=>g(A.target.value),className:"w-40 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500",children:[s.jsx("option",{value:"newest",children:"Newest"}),s.jsx("option",{value:"oldest",children:"Oldest"}),s.jsx("option",{value:"highest_rating",children:"Highest Rating"}),s.jsx("option",{value:"lowest_rating",children:"Lowest Rating"})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:N(f,v).map(A=>C(A,!1))})]})]}):s.jsxs("div",{className:"text-sm text-gray-500",children:["No reviews yet for ",t]})})]})]})}function QB(e,t){const r=y.useRef(t);y.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}function Jue(e,t,r){t.center!==r.center&&e.setLatLng(t.center),t.radius!=null&&t.radius!==r.radius&&e.setRadius(t.radius)}const Que=1;function efe(e){return Object.freeze({__version:Que,map:e})}function VT(e,t){return Object.freeze(D(D({},e),t))}const eU=y.createContext(null),tU=eU.Provider;function R1(){const e=y.useContext(eU);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function rU(e){function t(r,n){const{instance:a,context:i}=e(r).current;return y.useImperativeHandle(n,()=>a),r.children==null?null:te.createElement(tU,{value:i},r.children)}return y.forwardRef(t)}function tfe(e){function t(r,n){const[a,i]=y.useState(!1),{instance:o}=e(r,i).current;y.useImperativeHandle(n,()=>o),y.useEffect(function(){a&&o.update()},[o,a,r.children]);const l=o._contentNode;return l?ao.createPortal(r.children,l):null}return y.forwardRef(t)}function rfe(e){function t(r,n){const{instance:a}=e(r).current;return y.useImperativeHandle(n,()=>a),null}return y.forwardRef(t)}function WT(e,t){const r=y.useRef();y.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function O1(e,t){var n;const r=(n=e.pane)!=null?n:t.pane;return r?V(D({},e),{pane:r}):e}function nfe(e,t){return function(n,a){const i=R1(),o=e(O1(n,i),i);return QB(i.map,n.attribution),WT(o.current,n.eventHandlers),t(o.current,i,n,a),o}}var M2={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,n){n(t)})(na,function(r){var n="1.9.4";function a(p){var j,P,$,W;for(P=1,$=arguments.length;P<$;P++){W=arguments[P];for(j in W)p[j]=W[j]}return p}var i=Object.create||function(){function p(){}return function(j){return p.prototype=j,new p}}();function o(p,j){var P=Array.prototype.slice;if(p.bind)return p.bind.apply(p,P.call(arguments,1));var $=P.call(arguments,2);return function(){return p.apply(j,$.length?$.concat(P.call(arguments)):arguments)}}var l=0;function c(p){return"_leaflet_id"in p||(p._leaflet_id=++l),p._leaflet_id}function d(p,j,P){var $,W,re,be;return be=function(){$=!1,W&&(re.apply(P,W),W=!1)},re=function(){$?W=arguments:(p.apply(P,arguments),setTimeout(be,j),$=!0)},re}function f(p,j,P){var $=j[1],W=j[0],re=$-W;return p===$&&P?p:((p-W)%re+re)%re+W}function u(){return!1}function h(p,j){if(j===!1)return p;var P=Math.pow(10,j===void 0?6:j);return Math.round(p*P)/P}function m(p){return p.trim?p.trim():p.replace(/^\s+|\s+$/g,"")}function v(p){return m(p).split(/\s+/)}function g(p,j){Object.prototype.hasOwnProperty.call(p,"options")||(p.options=p.options?i(p.options):{});for(var P in j)p.options[P]=j[P];return p.options}function x(p,j,P){var $=[];for(var W in p)$.push(encodeURIComponent(P?W.toUpperCase():W)+"="+encodeURIComponent(p[W]));return(!j||j.indexOf("?")===-1?"?":"&")+$.join("&")}var _=/\{ *([\w_ -]+) *\}/g;function w(p,j){return p.replace(_,function(P,$){var W=j[$];if(W===void 0)throw new Error("No value provided for variable "+P);return typeof W=="function"&&(W=W(j)),W})}var b=Array.isArray||function(p){return Object.prototype.toString.call(p)==="[object Array]"};function N(p,j){for(var P=0;P<p.length;P++)if(p[P]===j)return P;return-1}var S="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function k(p){return window["webkit"+p]||window["moz"+p]||window["ms"+p]}var C=0;function A(p){var j=+new Date,P=Math.max(0,16-(j-C));return C=j+P,window.setTimeout(p,P)}var R=window.requestAnimationFrame||k("RequestAnimationFrame")||A,I=window.cancelAnimationFrame||k("CancelAnimationFrame")||k("CancelRequestAnimationFrame")||function(p){window.clearTimeout(p)};function O(p,j,P){if(P&&R===A)p.call(j);else return R.call(window,o(p,j))}function z(p){p&&I.call(window,p)}var M={__proto__:null,extend:a,create:i,bind:o,get lastId(){return l},stamp:c,throttle:d,wrapNum:f,falseFn:u,formatNum:h,trim:m,splitWords:v,setOptions:g,getParamString:x,template:w,isArray:b,indexOf:N,emptyImageUrl:S,requestFn:R,cancelFn:I,requestAnimFrame:O,cancelAnimFrame:z};function B(){}B.extend=function(p){var j=function(){g(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},P=j.__super__=this.prototype,$=i(P);$.constructor=j,j.prototype=$;for(var W in this)Object.prototype.hasOwnProperty.call(this,W)&&W!=="prototype"&&W!=="__super__"&&(j[W]=this[W]);return p.statics&&a(j,p.statics),p.includes&&(F(p.includes),a.apply(null,[$].concat(p.includes))),a($,p),delete $.statics,delete $.includes,$.options&&($.options=P.options?i(P.options):{},a($.options,p.options)),$._initHooks=[],$.callInitHooks=function(){if(!this._initHooksCalled){P.callInitHooks&&P.callInitHooks.call(this),this._initHooksCalled=!0;for(var re=0,be=$._initHooks.length;re<be;re++)$._initHooks[re].call(this)}},j},B.include=function(p){var j=this.prototype.options;return a(this.prototype,p),p.options&&(this.prototype.options=j,this.mergeOptions(p.options)),this},B.mergeOptions=function(p){return a(this.prototype.options,p),this},B.addInitHook=function(p){var j=Array.prototype.slice.call(arguments,1),P=typeof p=="function"?p:function(){this[p].apply(this,j)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(P),this};function F(p){if(!(typeof L=="undefined"||!L||!L.Mixin)){p=b(p)?p:[p];for(var j=0;j<p.length;j++)p[j]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var U={on:function(p,j,P){if(typeof p=="object")for(var $ in p)this._on($,p[$],j);else{p=v(p);for(var W=0,re=p.length;W<re;W++)this._on(p[W],j,P)}return this},off:function(p,j,P){if(!arguments.length)delete this._events;else if(typeof p=="object")for(var $ in p)this._off($,p[$],j);else{p=v(p);for(var W=arguments.length===1,re=0,be=p.length;re<be;re++)W?this._off(p[re]):this._off(p[re],j,P)}return this},_on:function(p,j,P,$){if(typeof j!="function"){console.warn("wrong listener type: "+typeof j);return}if(this._listens(p,j,P)===!1){P===this&&(P=void 0);var W={fn:j,ctx:P};$&&(W.once=!0),this._events=this._events||{},this._events[p]=this._events[p]||[],this._events[p].push(W)}},_off:function(p,j,P){var $,W,re;if(this._events&&($=this._events[p],!!$)){if(arguments.length===1){if(this._firingCount)for(W=0,re=$.length;W<re;W++)$[W].fn=u;delete this._events[p];return}if(typeof j!="function"){console.warn("wrong listener type: "+typeof j);return}var be=this._listens(p,j,P);if(be!==!1){var Be=$[be];this._firingCount&&(Be.fn=u,this._events[p]=$=$.slice()),$.splice(be,1)}}},fire:function(p,j,P){if(!this.listens(p,P))return this;var $=a({},j,{type:p,target:this,sourceTarget:j&&j.sourceTarget||this});if(this._events){var W=this._events[p];if(W){this._firingCount=this._firingCount+1||1;for(var re=0,be=W.length;re<be;re++){var Be=W[re],He=Be.fn;Be.once&&this.off(p,He,Be.ctx),He.call(Be.ctx||this,$)}this._firingCount--}}return P&&this._propagateEvent($),this},listens:function(p,j,P,$){typeof p!="string"&&console.warn('"string" type argument expected');var W=j;typeof j!="function"&&($=!!j,W=void 0,P=void 0);var re=this._events&&this._events[p];if(re&&re.length&&this._listens(p,W,P)!==!1)return!0;if($){for(var be in this._eventParents)if(this._eventParents[be].listens(p,j,P,$))return!0}return!1},_listens:function(p,j,P){if(!this._events)return!1;var $=this._events[p]||[];if(!j)return!!$.length;P===this&&(P=void 0);for(var W=0,re=$.length;W<re;W++)if($[W].fn===j&&$[W].ctx===P)return W;return!1},once:function(p,j,P){if(typeof p=="object")for(var $ in p)this._on($,p[$],j,!0);else{p=v(p);for(var W=0,re=p.length;W<re;W++)this._on(p[W],j,P,!0)}return this},addEventParent:function(p){return this._eventParents=this._eventParents||{},this._eventParents[c(p)]=p,this},removeEventParent:function(p){return this._eventParents&&delete this._eventParents[c(p)],this},_propagateEvent:function(p){for(var j in this._eventParents)this._eventParents[j].fire(p.type,a({layer:p.target,propagatedFrom:p.target},p),!0)}};U.addEventListener=U.on,U.removeEventListener=U.clearAllEventListeners=U.off,U.addOneTimeEventListener=U.once,U.fireEvent=U.fire,U.hasEventListeners=U.listens;var H=B.extend(U);function q(p,j,P){this.x=P?Math.round(p):p,this.y=P?Math.round(j):j}var K=Math.trunc||function(p){return p>0?Math.floor(p):Math.ceil(p)};q.prototype={clone:function(){return new q(this.x,this.y)},add:function(p){return this.clone()._add(Z(p))},_add:function(p){return this.x+=p.x,this.y+=p.y,this},subtract:function(p){return this.clone()._subtract(Z(p))},_subtract:function(p){return this.x-=p.x,this.y-=p.y,this},divideBy:function(p){return this.clone()._divideBy(p)},_divideBy:function(p){return this.x/=p,this.y/=p,this},multiplyBy:function(p){return this.clone()._multiplyBy(p)},_multiplyBy:function(p){return this.x*=p,this.y*=p,this},scaleBy:function(p){return new q(this.x*p.x,this.y*p.y)},unscaleBy:function(p){return new q(this.x/p.x,this.y/p.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=K(this.x),this.y=K(this.y),this},distanceTo:function(p){p=Z(p);var j=p.x-this.x,P=p.y-this.y;return Math.sqrt(j*j+P*P)},equals:function(p){return p=Z(p),p.x===this.x&&p.y===this.y},contains:function(p){return p=Z(p),Math.abs(p.x)<=Math.abs(this.x)&&Math.abs(p.y)<=Math.abs(this.y)},toString:function(){return"Point("+h(this.x)+", "+h(this.y)+")"}};function Z(p,j,P){return p instanceof q?p:b(p)?new q(p[0],p[1]):p==null?p:typeof p=="object"&&"x"in p&&"y"in p?new q(p.x,p.y):new q(p,j,P)}function ne(p,j){if(p)for(var P=j?[p,j]:p,$=0,W=P.length;$<W;$++)this.extend(P[$])}ne.prototype={extend:function(p){var j,P;if(!p)return this;if(p instanceof q||typeof p[0]=="number"||"x"in p)j=P=Z(p);else if(p=Y(p),j=p.min,P=p.max,!j||!P)return this;return!this.min&&!this.max?(this.min=j.clone(),this.max=P.clone()):(this.min.x=Math.min(j.x,this.min.x),this.max.x=Math.max(P.x,this.max.x),this.min.y=Math.min(j.y,this.min.y),this.max.y=Math.max(P.y,this.max.y)),this},getCenter:function(p){return Z((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,p)},getBottomLeft:function(){return Z(this.min.x,this.max.y)},getTopRight:function(){return Z(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(p){var j,P;return typeof p[0]=="number"||p instanceof q?p=Z(p):p=Y(p),p instanceof ne?(j=p.min,P=p.max):j=P=p,j.x>=this.min.x&&P.x<=this.max.x&&j.y>=this.min.y&&P.y<=this.max.y},intersects:function(p){p=Y(p);var j=this.min,P=this.max,$=p.min,W=p.max,re=W.x>=j.x&&$.x<=P.x,be=W.y>=j.y&&$.y<=P.y;return re&&be},overlaps:function(p){p=Y(p);var j=this.min,P=this.max,$=p.min,W=p.max,re=W.x>j.x&&$.x<P.x,be=W.y>j.y&&$.y<P.y;return re&&be},isValid:function(){return!!(this.min&&this.max)},pad:function(p){var j=this.min,P=this.max,$=Math.abs(j.x-P.x)*p,W=Math.abs(j.y-P.y)*p;return Y(Z(j.x-$,j.y-W),Z(P.x+$,P.y+W))},equals:function(p){return p?(p=Y(p),this.min.equals(p.getTopLeft())&&this.max.equals(p.getBottomRight())):!1}};function Y(p,j){return!p||p instanceof ne?p:new ne(p,j)}function X(p,j){if(p)for(var P=j?[p,j]:p,$=0,W=P.length;$<W;$++)this.extend(P[$])}X.prototype={extend:function(p){var j=this._southWest,P=this._northEast,$,W;if(p instanceof de)$=p,W=p;else if(p instanceof X){if($=p._southWest,W=p._northEast,!$||!W)return this}else return p?this.extend(_e(p)||se(p)):this;return!j&&!P?(this._southWest=new de($.lat,$.lng),this._northEast=new de(W.lat,W.lng)):(j.lat=Math.min($.lat,j.lat),j.lng=Math.min($.lng,j.lng),P.lat=Math.max(W.lat,P.lat),P.lng=Math.max(W.lng,P.lng)),this},pad:function(p){var j=this._southWest,P=this._northEast,$=Math.abs(j.lat-P.lat)*p,W=Math.abs(j.lng-P.lng)*p;return new X(new de(j.lat-$,j.lng-W),new de(P.lat+$,P.lng+W))},getCenter:function(){return new de((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new de(this.getNorth(),this.getWest())},getSouthEast:function(){return new de(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(p){typeof p[0]=="number"||p instanceof de||"lat"in p?p=_e(p):p=se(p);var j=this._southWest,P=this._northEast,$,W;return p instanceof X?($=p.getSouthWest(),W=p.getNorthEast()):$=W=p,$.lat>=j.lat&&W.lat<=P.lat&&$.lng>=j.lng&&W.lng<=P.lng},intersects:function(p){p=se(p);var j=this._southWest,P=this._northEast,$=p.getSouthWest(),W=p.getNorthEast(),re=W.lat>=j.lat&&$.lat<=P.lat,be=W.lng>=j.lng&&$.lng<=P.lng;return re&&be},overlaps:function(p){p=se(p);var j=this._southWest,P=this._northEast,$=p.getSouthWest(),W=p.getNorthEast(),re=W.lat>j.lat&&$.lat<P.lat,be=W.lng>j.lng&&$.lng<P.lng;return re&&be},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(p,j){return p?(p=se(p),this._southWest.equals(p.getSouthWest(),j)&&this._northEast.equals(p.getNorthEast(),j)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function se(p,j){return p instanceof X?p:new X(p,j)}function de(p,j,P){if(isNaN(p)||isNaN(j))throw new Error("Invalid LatLng object: ("+p+", "+j+")");this.lat=+p,this.lng=+j,P!==void 0&&(this.alt=+P)}de.prototype={equals:function(p,j){if(!p)return!1;p=_e(p);var P=Math.max(Math.abs(this.lat-p.lat),Math.abs(this.lng-p.lng));return P<=(j===void 0?1e-9:j)},toString:function(p){return"LatLng("+h(this.lat,p)+", "+h(this.lng,p)+")"},distanceTo:function(p){return Q.distance(this,_e(p))},wrap:function(){return Q.wrapLatLng(this)},toBounds:function(p){var j=180*p/40075017,P=j/Math.cos(Math.PI/180*this.lat);return se([this.lat-j,this.lng-P],[this.lat+j,this.lng+P])},clone:function(){return new de(this.lat,this.lng,this.alt)}};function _e(p,j,P){return p instanceof de?p:b(p)&&typeof p[0]!="object"?p.length===3?new de(p[0],p[1],p[2]):p.length===2?new de(p[0],p[1]):null:p==null?p:typeof p=="object"&&"lat"in p?new de(p.lat,"lng"in p?p.lng:p.lon,p.alt):j===void 0?null:new de(p,j,P)}var xe={latLngToPoint:function(p,j){var P=this.projection.project(p),$=this.scale(j);return this.transformation._transform(P,$)},pointToLatLng:function(p,j){var P=this.scale(j),$=this.transformation.untransform(p,P);return this.projection.unproject($)},project:function(p){return this.projection.project(p)},unproject:function(p){return this.projection.unproject(p)},scale:function(p){return 256*Math.pow(2,p)},zoom:function(p){return Math.log(p/256)/Math.LN2},getProjectedBounds:function(p){if(this.infinite)return null;var j=this.projection.bounds,P=this.scale(p),$=this.transformation.transform(j.min,P),W=this.transformation.transform(j.max,P);return new ne($,W)},infinite:!1,wrapLatLng:function(p){var j=this.wrapLng?f(p.lng,this.wrapLng,!0):p.lng,P=this.wrapLat?f(p.lat,this.wrapLat,!0):p.lat,$=p.alt;return new de(P,j,$)},wrapLatLngBounds:function(p){var j=p.getCenter(),P=this.wrapLatLng(j),$=j.lat-P.lat,W=j.lng-P.lng;if($===0&&W===0)return p;var re=p.getSouthWest(),be=p.getNorthEast(),Be=new de(re.lat-$,re.lng-W),He=new de(be.lat-$,be.lng-W);return new X(Be,He)}},Q=a({},xe,{wrapLng:[-180,180],R:6371e3,distance:function(p,j){var P=Math.PI/180,$=p.lat*P,W=j.lat*P,re=Math.sin((j.lat-p.lat)*P/2),be=Math.sin((j.lng-p.lng)*P/2),Be=re*re+Math.cos($)*Math.cos(W)*be*be,He=2*Math.atan2(Math.sqrt(Be),Math.sqrt(1-Be));return this.R*He}}),oe=6378137,ie={R:oe,MAX_LATITUDE:85.0511287798,project:function(p){var j=Math.PI/180,P=this.MAX_LATITUDE,$=Math.max(Math.min(P,p.lat),-P),W=Math.sin($*j);return new q(this.R*p.lng*j,this.R*Math.log((1+W)/(1-W))/2)},unproject:function(p){var j=180/Math.PI;return new de((2*Math.atan(Math.exp(p.y/this.R))-Math.PI/2)*j,p.x*j/this.R)},bounds:function(){var p=oe*Math.PI;return new ne([-p,-p],[p,p])}()};function ee(p,j,P,$){if(b(p)){this._a=p[0],this._b=p[1],this._c=p[2],this._d=p[3];return}this._a=p,this._b=j,this._c=P,this._d=$}ee.prototype={transform:function(p,j){return this._transform(p.clone(),j)},_transform:function(p,j){return j=j||1,p.x=j*(this._a*p.x+this._b),p.y=j*(this._c*p.y+this._d),p},untransform:function(p,j){return j=j||1,new q((p.x/j-this._b)/this._a,(p.y/j-this._d)/this._c)}};function G(p,j,P,$){return new ee(p,j,P,$)}var J=a({},Q,{code:"EPSG:3857",projection:ie,transformation:function(){var p=.5/(Math.PI*ie.R);return G(p,.5,-p,.5)}()}),ae=a({},J,{code:"EPSG:900913"});function fe(p){return document.createElementNS("http://www.w3.org/2000/svg",p)}function we(p,j){var P="",$,W,re,be,Be,He;for($=0,re=p.length;$<re;$++){for(Be=p[$],W=0,be=Be.length;W<be;W++)He=Be[W],P+=(W?"L":"M")+He.x+" "+He.y;P+=j?Ne.svg?"z":"x":""}return P||"M0 0"}var ve=document.documentElement.style,me="ActiveXObject"in window,Me=me&&!document.addEventListener,Te="msLaunchUri"in navigator&&!("documentMode"in document),Ve=Pe("webkit"),le=Pe("android"),Ke=Pe("android 2")||Pe("android 3"),De=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),nt=le&&Pe("Google")&&De<537&&!("AudioNode"in window),ze=!!window.opera,vt=!Te&&Pe("chrome"),rr=Pe("gecko")&&!Ve&&!ze&&!me,sr=!vt&&Pe("safari"),Ae=Pe("phantom"),Ue="OTransition"in ve,gt=navigator.platform.indexOf("Win")===0,Ce=me&&"transition"in ve,Ge="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ke,Nt="MozPerspective"in ve,Tt=!window.L_DISABLE_3D&&(Ce||Ge||Nt)&&!Ue&&!Ae,at=typeof orientation!="undefined"||Pe("mobile"),ue=at&&Ve,qe=at&&Ge,Ct=!window.PointerEvent&&window.MSPointerEvent,ct=!!(window.PointerEvent||Ct),pt="ontouchstart"in window||!!window.TouchEvent,At=!window.L_NO_TOUCH&&(pt||ct),yt=at&&ze,Fe=at&&rr,ft=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Et=function(){var p=!1;try{var j=Object.defineProperty({},"passive",{get:function(){p=!0}});window.addEventListener("testPassiveEventSupport",u,j),window.removeEventListener("testPassiveEventSupport",u,j)}catch(P){}return p}(),hr=function(){return!!document.createElement("canvas").getContext}(),dr=!!(document.createElementNS&&fe("svg").createSVGRect),cn=!!dr&&function(){var p=document.createElement("div");return p.innerHTML="<svg/>",(p.firstChild&&p.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),mn=!dr&&function(){try{var p=document.createElement("div");p.innerHTML='<v:shape adj="1"/>';var j=p.firstChild;return j.style.behavior="url(#default#VML)",j&&typeof j.adj=="object"}catch(P){return!1}}(),je=navigator.platform.indexOf("Mac")===0,pe=navigator.platform.indexOf("Linux")===0;function Pe(p){return navigator.userAgent.toLowerCase().indexOf(p)>=0}var Ne={ie:me,ielt9:Me,edge:Te,webkit:Ve,android:le,android23:Ke,androidStock:nt,opera:ze,chrome:vt,gecko:rr,safari:sr,phantom:Ae,opera12:Ue,win:gt,ie3d:Ce,webkit3d:Ge,gecko3d:Nt,any3d:Tt,mobile:at,mobileWebkit:ue,mobileWebkit3d:qe,msPointer:Ct,pointer:ct,touch:At,touchNative:pt,mobileOpera:yt,mobileGecko:Fe,retina:ft,passiveEvents:Et,canvas:hr,svg:dr,vml:mn,inlineSvg:cn,mac:je,linux:pe},Ye=Ne.msPointer?"MSPointerDown":"pointerdown",We=Ne.msPointer?"MSPointerMove":"pointermove",It=Ne.msPointer?"MSPointerUp":"pointerup",jt=Ne.msPointer?"MSPointerCancel":"pointercancel",Ee={touchstart:Ye,touchmove:We,touchend:It,touchcancel:jt},rt={touchstart:Xe,touchmove:Le,touchend:Le,touchcancel:Le},ir={},rn=!1;function Mt(p,j,P){return j==="touchstart"&&ht(),rt[j]?(P=rt[j].bind(this,P),p.addEventListener(Ee[j],P,!1),P):(console.warn("wrong event specified:",j),u)}function ye(p,j,P){if(!Ee[j]){console.warn("wrong event specified:",j);return}p.removeEventListener(Ee[j],P,!1)}function Ie(p){ir[p.pointerId]=p}function dt(p){ir[p.pointerId]&&(ir[p.pointerId]=p)}function wt(p){delete ir[p.pointerId]}function ht(){rn||(document.addEventListener(Ye,Ie,!0),document.addEventListener(We,dt,!0),document.addEventListener(It,wt,!0),document.addEventListener(jt,wt,!0),rn=!0)}function Le(p,j){if(j.pointerType!==(j.MSPOINTER_TYPE_MOUSE||"mouse")){j.touches=[];for(var P in ir)j.touches.push(ir[P]);j.changedTouches=[j],p(j)}}function Xe(p,j){j.MSPOINTER_TYPE_TOUCH&&j.pointerType===j.MSPOINTER_TYPE_TOUCH&&rs(j),Le(p,j)}function ke(p){var j={},P,$;for($ in p)P=p[$],j[$]=P&&P.bind?P.bind(p):P;return p=j,j.type="dblclick",j.detail=2,j.isTrusted=!1,j._simulated=!0,j}var St=200;function _t(p,j){p.addEventListener("dblclick",j);var P=0,$;function W(re){if(re.detail!==1){$=re.detail;return}if(!(re.pointerType==="mouse"||re.sourceCapabilities&&!re.sourceCapabilities.firesTouchEvents)){var be=Vp(re);if(!(be.some(function(He){return He instanceof HTMLLabelElement&&He.attributes.for})&&!be.some(function(He){return He instanceof HTMLInputElement||He instanceof HTMLSelectElement}))){var Be=Date.now();Be-P<=St?($++,$===2&&j(ke(re))):$=1,P=Be}}}return p.addEventListener("click",W),{dblclick:j,simDblclick:W}}function Fr(p,j){p.removeEventListener("dblclick",j.dblclick),p.removeEventListener("click",j.simDblclick)}var dn=Or(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),En=Or(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Dt=En==="webkitTransition"||En==="OTransition"?En+"End":"transitionend";function ur(p){return typeof p=="string"?document.getElementById(p):p}function or(p,j){var P=p.style[j]||p.currentStyle&&p.currentStyle[j];if((!P||P==="auto")&&document.defaultView){var $=document.defaultView.getComputedStyle(p,null);P=$?$[j]:null}return P==="auto"?null:P}function Wt(p,j,P){var $=document.createElement(p);return $.className=j||"",P&&P.appendChild($),$}function Sr(p){var j=p.parentNode;j&&j.removeChild(p)}function yn(p){for(;p.firstChild;)p.removeChild(p.firstChild)}function nr(p){var j=p.parentNode;j&&j.lastChild!==p&&j.appendChild(p)}function Cr(p){var j=p.parentNode;j&&j.firstChild!==p&&j.insertBefore(p,j.firstChild)}function Cn(p,j){if(p.classList!==void 0)return p.classList.contains(j);var P=bs(p);return P.length>0&&new RegExp("(^|\\s)"+j+"(\\s|$)").test(P)}function Ht(p,j){if(p.classList!==void 0)for(var P=v(j),$=0,W=P.length;$<W;$++)p.classList.add(P[$]);else if(!Cn(p,j)){var re=bs(p);In(p,(re?re+" ":"")+j)}}function cr(p,j){p.classList!==void 0?p.classList.remove(j):In(p,m((" "+bs(p)+" ").replace(" "+j+" "," ")))}function In(p,j){p.className.baseVal===void 0?p.className=j:p.className.baseVal=j}function bs(p){return p.correspondingElement&&(p=p.correspondingElement),p.className.baseVal===void 0?p.className:p.className.baseVal}function is(p,j){"opacity"in p.style?p.style.opacity=j:"filter"in p.style&&zr(p,j)}function zr(p,j){var P=!1,$="DXImageTransform.Microsoft.Alpha";try{P=p.filters.item($)}catch(W){if(j===1)return}j=Math.round(j*100),P?(P.Enabled=j!==100,P.Opacity=j):p.style.filter+=" progid:"+$+"(opacity="+j+")"}function Or(p){for(var j=document.documentElement.style,P=0;P<p.length;P++)if(p[P]in j)return p[P];return!1}function An(p,j,P){var $=j||new q(0,0);p.style[dn]=(Ne.ie3d?"translate("+$.x+"px,"+$.y+"px)":"translate3d("+$.x+"px,"+$.y+"px,0)")+(P?" scale("+P+")":"")}function Br(p,j){p._leaflet_pos=j,Ne.any3d?An(p,j):(p.style.left=j.x+"px",p.style.top=j.y+"px")}function zn(p){return p._leaflet_pos||new q(0,0)}var la,Da,Tn;if("onselectstart"in document)la=function(){jr(window,"selectstart",rs)},Da=function(){pn(window,"selectstart",rs)};else{var tr=Or(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);la=function(){if(tr){var p=document.documentElement.style;Tn=p[tr],p[tr]="none"}},Da=function(){tr&&(document.documentElement.style[tr]=Tn,Tn=void 0)}}function Mr(){jr(window,"dragstart",rs)}function un(){pn(window,"dragstart",rs)}var Rn,Es;function Qa(p){for(;p.tabIndex===-1;)p=p.parentNode;p.style&&(xa(),Rn=p,Es=p.style.outlineStyle,p.style.outlineStyle="none",jr(window,"keydown",xa))}function xa(){Rn&&(Rn.style.outlineStyle=Es,Rn=void 0,Es=void 0,pn(window,"keydown",xa))}function js(p){do p=p.parentNode;while((!p.offsetWidth||!p.offsetHeight)&&p!==document.body);return p}function os(p){var j=p.getBoundingClientRect();return{x:j.width/p.offsetWidth||1,y:j.height/p.offsetHeight||1,boundingClientRect:j}}var _a={__proto__:null,TRANSFORM:dn,TRANSITION:En,TRANSITION_END:Dt,get:ur,getStyle:or,create:Wt,remove:Sr,empty:yn,toFront:nr,toBack:Cr,hasClass:Cn,addClass:Ht,removeClass:cr,setClass:In,getClass:bs,setOpacity:is,testProp:Or,setTransform:An,setPosition:Br,getPosition:zn,get disableTextSelection(){return la},get enableTextSelection(){return Da},disableImageDrag:Mr,enableImageDrag:un,preventOutline:Qa,restoreOutline:xa,getSizedParentNode:js,getScale:os};function jr(p,j,P,$){if(j&&typeof j=="object")for(var W in j)Yl(p,W,j[W],P);else{j=v(j);for(var re=0,be=j.length;re<be;re++)Yl(p,j[re],P,$)}return this}var Ia="_leaflet_events";function pn(p,j,P,$){if(arguments.length===1)du(p),delete p[Ia];else if(j&&typeof j=="object")for(var W in j)Zc(p,W,j[W],P);else if(j=v(j),arguments.length===2)du(p,function(Be){return N(j,Be)!==-1});else for(var re=0,be=j.length;re<be;re++)Zc(p,j[re],P,$);return this}function du(p,j){for(var P in p[Ia]){var $=P.split(/\d/)[0];(!j||j($))&&Zc(p,$,null,null,P)}}var Kc={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Yl(p,j,P,$){var W=j+c(P)+($?"_"+c($):"");if(p[Ia]&&p[Ia][W])return this;var re=function(Be){return P.call($||p,Be||window.event)},be=re;!Ne.touchNative&&Ne.pointer&&j.indexOf("touch")===0?re=Mt(p,j,re):Ne.touch&&j==="dblclick"?re=_t(p,re):"addEventListener"in p?j==="touchstart"||j==="touchmove"||j==="wheel"||j==="mousewheel"?p.addEventListener(Kc[j]||j,re,Ne.passiveEvents?{passive:!1}:!1):j==="mouseenter"||j==="mouseleave"?(re=function(Be){Be=Be||window.event,Bf(p,Be)&&be(Be)},p.addEventListener(Kc[j],re,!1)):p.addEventListener(j,be,!1):p.attachEvent("on"+j,re),p[Ia]=p[Ia]||{},p[Ia][W]=re}function Zc(p,j,P,$,W){W=W||j+c(P)+($?"_"+c($):"");var re=p[Ia]&&p[Ia][W];if(!re)return this;!Ne.touchNative&&Ne.pointer&&j.indexOf("touch")===0?ye(p,j,re):Ne.touch&&j==="dblclick"?Fr(p,re):"removeEventListener"in p?p.removeEventListener(Kc[j]||j,re,!1):p.detachEvent("on"+j,re),p[Ia][W]=null}function il(p){return p.stopPropagation?p.stopPropagation():p.originalEvent?p.originalEvent._stopped=!0:p.cancelBubble=!0,this}function zf(p){return Yl(p,"wheel",il),this}function ei(p){return jr(p,"mousedown touchstart dblclick contextmenu",il),p._leaflet_disable_click=!0,this}function rs(p){return p.preventDefault?p.preventDefault():p.returnValue=!1,this}function Kl(p){return rs(p),il(p),this}function Vp(p){if(p.composedPath)return p.composedPath();for(var j=[],P=p.target;P;)j.push(P),P=P.parentNode;return j}function T0(p,j){if(!j)return new q(p.clientX,p.clientY);var P=os(j),$=P.boundingClientRect;return new q((p.clientX-$.left)/P.x-j.clientLeft,(p.clientY-$.top)/P.y-j.clientTop)}var Uj=Ne.linux&&Ne.chrome?window.devicePixelRatio:Ne.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function A0(p){return Ne.edge?p.wheelDeltaY/2:p.deltaY&&p.deltaMode===0?-p.deltaY/Uj:p.deltaY&&p.deltaMode===1?-p.deltaY*20:p.deltaY&&p.deltaMode===2?-p.deltaY*60:p.deltaX||p.deltaZ?0:p.wheelDelta?(p.wheelDeltaY||p.wheelDelta)/2:p.detail&&Math.abs(p.detail)<32765?-p.detail*20:p.detail?p.detail/-32765*60:0}function Bf(p,j){var P=j.relatedTarget;if(!P)return!0;try{for(;P&&P!==p;)P=P.parentNode}catch($){return!1}return P!==p}var R0={__proto__:null,on:jr,off:pn,stopPropagation:il,disableScrollPropagation:zf,disableClickPropagation:ei,preventDefault:rs,stop:Kl,getPropagationPath:Vp,getMousePosition:T0,getWheelDelta:A0,isExternalTarget:Bf,addListener:jr,removeListener:pn},Wp=H.extend({run:function(p,j,P,$){this.stop(),this._el=p,this._inProgress=!0,this._duration=P||.25,this._easeOutPower=1/Math.max($||.5,.2),this._startPos=zn(p),this._offset=j.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=O(this._animate,this),this._step()},_step:function(p){var j=+new Date-this._startTime,P=this._duration*1e3;j<P?this._runFrame(this._easeOut(j/P),p):(this._runFrame(1),this._complete())},_runFrame:function(p,j){var P=this._startPos.add(this._offset.multiplyBy(p));j&&P._round(),Br(this._el,P),this.fire("step")},_complete:function(){z(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(p){return 1-Math.pow(1-p,this._easeOutPower)}}),nn=H.extend({options:{crs:J,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(p,j){j=g(this,j),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(p),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),j.maxBounds&&this.setMaxBounds(j.maxBounds),j.zoom!==void 0&&(this._zoom=this._limitZoom(j.zoom)),j.center&&j.zoom!==void 0&&this.setView(_e(j.center),j.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=En&&Ne.any3d&&!Ne.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),jr(this._proxy,Dt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(p,j,P){if(j=j===void 0?this._zoom:this._limitZoom(j),p=this._limitCenter(_e(p),j,this.options.maxBounds),P=P||{},this._stop(),this._loaded&&!P.reset&&P!==!0){P.animate!==void 0&&(P.zoom=a({animate:P.animate},P.zoom),P.pan=a({animate:P.animate,duration:P.duration},P.pan));var $=this._zoom!==j?this._tryAnimatedZoom&&this._tryAnimatedZoom(p,j,P.zoom):this._tryAnimatedPan(p,P.pan);if($)return clearTimeout(this._sizeTimer),this}return this._resetView(p,j,P.pan&&P.pan.noMoveStart),this},setZoom:function(p,j){return this._loaded?this.setView(this.getCenter(),p,{zoom:j}):(this._zoom=p,this)},zoomIn:function(p,j){return p=p||(Ne.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+p,j)},zoomOut:function(p,j){return p=p||(Ne.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-p,j)},setZoomAround:function(p,j,P){var $=this.getZoomScale(j),W=this.getSize().divideBy(2),re=p instanceof q?p:this.latLngToContainerPoint(p),be=re.subtract(W).multiplyBy(1-1/$),Be=this.containerPointToLatLng(W.add(be));return this.setView(Be,j,{zoom:P})},_getBoundsCenterZoom:function(p,j){j=j||{},p=p.getBounds?p.getBounds():se(p);var P=Z(j.paddingTopLeft||j.padding||[0,0]),$=Z(j.paddingBottomRight||j.padding||[0,0]),W=this.getBoundsZoom(p,!1,P.add($));if(W=typeof j.maxZoom=="number"?Math.min(j.maxZoom,W):W,W===1/0)return{center:p.getCenter(),zoom:W};var re=$.subtract(P).divideBy(2),be=this.project(p.getSouthWest(),W),Be=this.project(p.getNorthEast(),W),He=this.unproject(be.add(Be).divideBy(2).add(re),W);return{center:He,zoom:W}},fitBounds:function(p,j){if(p=se(p),!p.isValid())throw new Error("Bounds are not valid.");var P=this._getBoundsCenterZoom(p,j);return this.setView(P.center,P.zoom,j)},fitWorld:function(p){return this.fitBounds([[-90,-180],[90,180]],p)},panTo:function(p,j){return this.setView(p,this._zoom,{pan:j})},panBy:function(p,j){if(p=Z(p).round(),j=j||{},!p.x&&!p.y)return this.fire("moveend");if(j.animate!==!0&&!this.getSize().contains(p))return this._resetView(this.unproject(this.project(this.getCenter()).add(p)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Wp,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),j.noMoveStart||this.fire("movestart"),j.animate!==!1){Ht(this._mapPane,"leaflet-pan-anim");var P=this._getMapPanePos().subtract(p).round();this._panAnim.run(this._mapPane,P,j.duration||.25,j.easeLinearity)}else this._rawPanBy(p),this.fire("move").fire("moveend");return this},flyTo:function(p,j,P){if(P=P||{},P.animate===!1||!Ne.any3d)return this.setView(p,j,P);this._stop();var $=this.project(this.getCenter()),W=this.project(p),re=this.getSize(),be=this._zoom;p=_e(p),j=j===void 0?be:j;var Be=Math.max(re.x,re.y),He=Be*this.getZoomScale(be,j),ut=W.distanceTo($)||1,zt=1.42,vr=zt*zt;function Xr(Ps){var Y0=Ps?-1:1,tZ=Ps?He:Be,rZ=He*He-Be*Be+Y0*vr*vr*ut*ut,nZ=2*tZ*vr*ut,Kj=rZ/nZ,fR=Math.sqrt(Kj*Kj+1)-Kj,sZ=fR<1e-9?-18:Math.log(fR);return sZ}function La(Ps){return(Math.exp(Ps)-Math.exp(-Ps))/2}function Xs(Ps){return(Math.exp(Ps)+Math.exp(-Ps))/2}function Bi(Ps){return La(Ps)/Xs(Ps)}var ri=Xr(0);function Yf(Ps){return Be*(Xs(ri)/Xs(ri+zt*Ps))}function XK(Ps){return Be*(Xs(ri)*Bi(ri+zt*Ps)-La(ri))/vr}function JK(Ps){return 1-Math.pow(1-Ps,1.5)}var QK=Date.now(),dR=(Xr(1)-ri)/zt,eZ=P.duration?1e3*P.duration:1e3*dR*.8;function uR(){var Ps=(Date.now()-QK)/eZ,Y0=JK(Ps)*dR;Ps<=1?(this._flyToFrame=O(uR,this),this._move(this.unproject($.add(W.subtract($).multiplyBy(XK(Y0)/ut)),be),this.getScaleZoom(Be/Yf(Y0),be),{flyTo:!0})):this._move(p,j)._moveEnd(!0)}return this._moveStart(!0,P.noMoveStart),uR.call(this),this},flyToBounds:function(p,j){var P=this._getBoundsCenterZoom(p,j);return this.flyTo(P.center,P.zoom,j)},setMaxBounds:function(p){return p=se(p),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),p.isValid()?(this.options.maxBounds=p,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(p){var j=this.options.minZoom;return this.options.minZoom=p,this._loaded&&j!==p&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(p):this},setMaxZoom:function(p){var j=this.options.maxZoom;return this.options.maxZoom=p,this._loaded&&j!==p&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(p):this},panInsideBounds:function(p,j){this._enforcingBounds=!0;var P=this.getCenter(),$=this._limitCenter(P,this._zoom,se(p));return P.equals($)||this.panTo($,j),this._enforcingBounds=!1,this},panInside:function(p,j){j=j||{};var P=Z(j.paddingTopLeft||j.padding||[0,0]),$=Z(j.paddingBottomRight||j.padding||[0,0]),W=this.project(this.getCenter()),re=this.project(p),be=this.getPixelBounds(),Be=Y([be.min.add(P),be.max.subtract($)]),He=Be.getSize();if(!Be.contains(re)){this._enforcingBounds=!0;var ut=re.subtract(Be.getCenter()),zt=Be.extend(re).getSize().subtract(He);W.x+=ut.x<0?-zt.x:zt.x,W.y+=ut.y<0?-zt.y:zt.y,this.panTo(this.unproject(W),j),this._enforcingBounds=!1}return this},invalidateSize:function(p){if(!this._loaded)return this;p=a({animate:!1,pan:!0},p===!0?{animate:!0}:p);var j=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var P=this.getSize(),$=j.divideBy(2).round(),W=P.divideBy(2).round(),re=$.subtract(W);return!re.x&&!re.y?this:(p.animate&&p.pan?this.panBy(re):(p.pan&&this._rawPanBy(re),this.fire("move"),p.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:j,newSize:P}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(p){if(p=this._locateOptions=a({timeout:1e4,watch:!1},p),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var j=o(this._handleGeolocationResponse,this),P=o(this._handleGeolocationError,this);return p.watch?this._locationWatchId=navigator.geolocation.watchPosition(j,P,p):navigator.geolocation.getCurrentPosition(j,P,p),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(p){if(this._container._leaflet_id){var j=p.code,P=p.message||(j===1?"permission denied":j===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:j,message:"Geolocation error: "+P+"."})}},_handleGeolocationResponse:function(p){if(this._container._leaflet_id){var j=p.coords.latitude,P=p.coords.longitude,$=new de(j,P),W=$.toBounds(p.coords.accuracy*2),re=this._locateOptions;if(re.setView){var be=this.getBoundsZoom(W);this.setView($,re.maxZoom?Math.min(be,re.maxZoom):be)}var Be={latlng:$,bounds:W,timestamp:p.timestamp};for(var He in p.coords)typeof p.coords[He]=="number"&&(Be[He]=p.coords[He]);this.fire("locationfound",Be)}},addHandler:function(p,j){if(!j)return this;var P=this[p]=new j(this);return this._handlers.push(P),this.options[p]&&P.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(j){this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Sr(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(z(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var p;for(p in this._layers)this._layers[p].remove();for(p in this._panes)Sr(this._panes[p]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(p,j){var P="leaflet-pane"+(p?" leaflet-"+p.replace("Pane","")+"-pane":""),$=Wt("div",P,j||this._mapPane);return p&&(this._panes[p]=$),$},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var p=this.getPixelBounds(),j=this.unproject(p.getBottomLeft()),P=this.unproject(p.getTopRight());return new X(j,P)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(p,j,P){p=se(p),P=Z(P||[0,0]);var $=this.getZoom()||0,W=this.getMinZoom(),re=this.getMaxZoom(),be=p.getNorthWest(),Be=p.getSouthEast(),He=this.getSize().subtract(P),ut=Y(this.project(Be,$),this.project(be,$)).getSize(),zt=Ne.any3d?this.options.zoomSnap:1,vr=He.x/ut.x,Xr=He.y/ut.y,La=j?Math.max(vr,Xr):Math.min(vr,Xr);return $=this.getScaleZoom(La,$),zt&&($=Math.round($/(zt/100))*(zt/100),$=j?Math.ceil($/zt)*zt:Math.floor($/zt)*zt),Math.max(W,Math.min(re,$))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(p,j){var P=this._getTopLeftPoint(p,j);return new ne(P,P.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(p){return this.options.crs.getProjectedBounds(p===void 0?this.getZoom():p)},getPane:function(p){return typeof p=="string"?this._panes[p]:p},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(p,j){var P=this.options.crs;return j=j===void 0?this._zoom:j,P.scale(p)/P.scale(j)},getScaleZoom:function(p,j){var P=this.options.crs;j=j===void 0?this._zoom:j;var $=P.zoom(p*P.scale(j));return isNaN($)?1/0:$},project:function(p,j){return j=j===void 0?this._zoom:j,this.options.crs.latLngToPoint(_e(p),j)},unproject:function(p,j){return j=j===void 0?this._zoom:j,this.options.crs.pointToLatLng(Z(p),j)},layerPointToLatLng:function(p){var j=Z(p).add(this.getPixelOrigin());return this.unproject(j)},latLngToLayerPoint:function(p){var j=this.project(_e(p))._round();return j._subtract(this.getPixelOrigin())},wrapLatLng:function(p){return this.options.crs.wrapLatLng(_e(p))},wrapLatLngBounds:function(p){return this.options.crs.wrapLatLngBounds(se(p))},distance:function(p,j){return this.options.crs.distance(_e(p),_e(j))},containerPointToLayerPoint:function(p){return Z(p).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(p){return Z(p).add(this._getMapPanePos())},containerPointToLatLng:function(p){var j=this.containerPointToLayerPoint(Z(p));return this.layerPointToLatLng(j)},latLngToContainerPoint:function(p){return this.layerPointToContainerPoint(this.latLngToLayerPoint(_e(p)))},mouseEventToContainerPoint:function(p){return T0(p,this._container)},mouseEventToLayerPoint:function(p){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(p))},mouseEventToLatLng:function(p){return this.layerPointToLatLng(this.mouseEventToLayerPoint(p))},_initContainer:function(p){var j=this._container=ur(p);if(j){if(j._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");jr(j,"scroll",this._onScroll,this),this._containerId=c(j)},_initLayout:function(){var p=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ne.any3d,Ht(p,"leaflet-container"+(Ne.touch?" leaflet-touch":"")+(Ne.retina?" leaflet-retina":"")+(Ne.ielt9?" leaflet-oldie":"")+(Ne.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var j=or(p,"position");j!=="absolute"&&j!=="relative"&&j!=="fixed"&&j!=="sticky"&&(p.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var p=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Br(this._mapPane,new q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ht(p.markerPane,"leaflet-zoom-hide"),Ht(p.shadowPane,"leaflet-zoom-hide"))},_resetView:function(p,j,P){Br(this._mapPane,new q(0,0));var $=!this._loaded;this._loaded=!0,j=this._limitZoom(j),this.fire("viewprereset");var W=this._zoom!==j;this._moveStart(W,P)._move(p,j)._moveEnd(W),this.fire("viewreset"),$&&this.fire("load")},_moveStart:function(p,j){return p&&this.fire("zoomstart"),j||this.fire("movestart"),this},_move:function(p,j,P,$){j===void 0&&(j=this._zoom);var W=this._zoom!==j;return this._zoom=j,this._lastCenter=p,this._pixelOrigin=this._getNewPixelOrigin(p),$?P&&P.pinch&&this.fire("zoom",P):((W||P&&P.pinch)&&this.fire("zoom",P),this.fire("move",P)),this},_moveEnd:function(p){return p&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return z(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(p){Br(this._mapPane,this._getMapPanePos().subtract(p))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(p){this._targets={},this._targets[c(this._container)]=this;var j=p?pn:jr;j(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&j(window,"resize",this._onResize,this),Ne.any3d&&this.options.transform3DLimit&&(p?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){z(this._resizeRequest),this._resizeRequest=O(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var p=this._getMapPanePos();Math.max(Math.abs(p.x),Math.abs(p.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(p,j){for(var P=[],$,W=j==="mouseout"||j==="mouseover",re=p.target||p.srcElement,be=!1;re;){if($=this._targets[c(re)],$&&(j==="click"||j==="preclick")&&this._draggableMoved($)){be=!0;break}if($&&$.listens(j,!0)&&(W&&!Bf(re,p)||(P.push($),W))||re===this._container)break;re=re.parentNode}return!P.length&&!be&&!W&&this.listens(j,!0)&&(P=[this]),P},_isClickDisabled:function(p){for(;p&&p!==this._container;){if(p._leaflet_disable_click)return!0;p=p.parentNode}},_handleDOMEvent:function(p){var j=p.target||p.srcElement;if(!(!this._loaded||j._leaflet_disable_events||p.type==="click"&&this._isClickDisabled(j))){var P=p.type;P==="mousedown"&&Qa(j),this._fireDOMEvent(p,P)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(p,j,P){if(p.type==="click"){var $=a({},p);$.type="preclick",this._fireDOMEvent($,$.type,P)}var W=this._findEventTargets(p,j);if(P){for(var re=[],be=0;be<P.length;be++)P[be].listens(j,!0)&&re.push(P[be]);W=re.concat(W)}if(W.length){j==="contextmenu"&&rs(p);var Be=W[0],He={originalEvent:p};if(p.type!=="keypress"&&p.type!=="keydown"&&p.type!=="keyup"){var ut=Be.getLatLng&&(!Be._radius||Be._radius<=10);He.containerPoint=ut?this.latLngToContainerPoint(Be.getLatLng()):this.mouseEventToContainerPoint(p),He.layerPoint=this.containerPointToLayerPoint(He.containerPoint),He.latlng=ut?Be.getLatLng():this.layerPointToLatLng(He.layerPoint)}for(be=0;be<W.length;be++)if(W[be].fire(j,He,!0),He.originalEvent._stopped||W[be].options.bubblingMouseEvents===!1&&N(this._mouseEvents,j)!==-1)return}},_draggableMoved:function(p){return p=p.dragging&&p.dragging.enabled()?p:this,p.dragging&&p.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var p=0,j=this._handlers.length;p<j;p++)this._handlers[p].disable()},whenReady:function(p,j){return this._loaded?p.call(j||this,{target:this}):this.on("load",p,j),this},_getMapPanePos:function(){return zn(this._mapPane)||new q(0,0)},_moved:function(){var p=this._getMapPanePos();return p&&!p.equals([0,0])},_getTopLeftPoint:function(p,j){var P=p&&j!==void 0?this._getNewPixelOrigin(p,j):this.getPixelOrigin();return P.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(p,j){var P=this.getSize()._divideBy(2);return this.project(p,j)._subtract(P)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(p,j,P){var $=this._getNewPixelOrigin(P,j);return this.project(p,j)._subtract($)},_latLngBoundsToNewLayerBounds:function(p,j,P){var $=this._getNewPixelOrigin(P,j);return Y([this.project(p.getSouthWest(),j)._subtract($),this.project(p.getNorthWest(),j)._subtract($),this.project(p.getSouthEast(),j)._subtract($),this.project(p.getNorthEast(),j)._subtract($)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(p){return this.latLngToLayerPoint(p).subtract(this._getCenterLayerPoint())},_limitCenter:function(p,j,P){if(!P)return p;var $=this.project(p,j),W=this.getSize().divideBy(2),re=new ne($.subtract(W),$.add(W)),be=this._getBoundsOffset(re,P,j);return Math.abs(be.x)<=1&&Math.abs(be.y)<=1?p:this.unproject($.add(be),j)},_limitOffset:function(p,j){if(!j)return p;var P=this.getPixelBounds(),$=new ne(P.min.add(p),P.max.add(p));return p.add(this._getBoundsOffset($,j))},_getBoundsOffset:function(p,j,P){var $=Y(this.project(j.getNorthEast(),P),this.project(j.getSouthWest(),P)),W=$.min.subtract(p.min),re=$.max.subtract(p.max),be=this._rebound(W.x,-re.x),Be=this._rebound(W.y,-re.y);return new q(be,Be)},_rebound:function(p,j){return p+j>0?Math.round(p-j)/2:Math.max(0,Math.ceil(p))-Math.max(0,Math.floor(j))},_limitZoom:function(p){var j=this.getMinZoom(),P=this.getMaxZoom(),$=Ne.any3d?this.options.zoomSnap:1;return $&&(p=Math.round(p/$)*$),Math.max(j,Math.min(P,p))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){cr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(p,j){var P=this._getCenterOffset(p)._trunc();return(j&&j.animate)!==!0&&!this.getSize().contains(P)?!1:(this.panBy(P,j),!0)},_createAnimProxy:function(){var p=this._proxy=Wt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(p),this.on("zoomanim",function(j){var P=dn,$=this._proxy.style[P];An(this._proxy,this.project(j.center,j.zoom),this.getZoomScale(j.zoom,1)),$===this._proxy.style[P]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Sr(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var p=this.getCenter(),j=this.getZoom();An(this._proxy,this.project(p,j),this.getZoomScale(j,1))},_catchTransitionEnd:function(p){this._animatingZoom&&p.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(p,j,P){if(this._animatingZoom)return!0;if(P=P||{},!this._zoomAnimated||P.animate===!1||this._nothingToAnimate()||Math.abs(j-this._zoom)>this.options.zoomAnimationThreshold)return!1;var $=this.getZoomScale(j),W=this._getCenterOffset(p)._divideBy(1-1/$);return P.animate!==!0&&!this.getSize().contains(W)?!1:(O(function(){this._moveStart(!0,P.noMoveStart||!1)._animateZoom(p,j,!0)},this),!0)},_animateZoom:function(p,j,P,$){this._mapPane&&(P&&(this._animatingZoom=!0,this._animateToCenter=p,this._animateToZoom=j,Ht(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:p,zoom:j,noUpdate:$}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&cr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function O0(p,j){return new nn(p,j)}var ti=B.extend({options:{position:"topright"},initialize:function(p){g(this,p)},getPosition:function(){return this.options.position},setPosition:function(p){var j=this._map;return j&&j.removeControl(this),this.options.position=p,j&&j.addControl(this),this},getContainer:function(){return this._container},addTo:function(p){this.remove(),this._map=p;var j=this._container=this.onAdd(p),P=this.getPosition(),$=p._controlCorners[P];return Ht(j,"leaflet-control"),P.indexOf("bottom")!==-1?$.insertBefore(j,$.firstChild):$.appendChild(j),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Sr(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(p){this._map&&p&&p.screenX>0&&p.screenY>0&&this._map.getContainer().focus()}}),Xc=function(p){return new ti(p)};nn.include({addControl:function(p){return p.addTo(this),this},removeControl:function(p){return p.remove(),this},_initControlPos:function(){var p=this._controlCorners={},j="leaflet-",P=this._controlContainer=Wt("div",j+"control-container",this._container);function $(W,re){var be=j+W+" "+j+re;p[W+re]=Wt("div",be,P)}$("top","left"),$("top","right"),$("bottom","left"),$("bottom","right")},_clearControlPos:function(){for(var p in this._controlCorners)Sr(this._controlCorners[p]);Sr(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Hp=ti.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(p,j,P,$){return P<$?-1:$<P?1:0}},initialize:function(p,j,P){g(this,P),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var $ in p)this._addLayer(p[$],$);for($ in j)this._addLayer(j[$],$,!0)},onAdd:function(p){this._initLayout(),this._update(),this._map=p,p.on("zoomend",this._checkDisabledLayers,this);for(var j=0;j<this._layers.length;j++)this._layers[j].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(p){return ti.prototype.addTo.call(this,p),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var p=0;p<this._layers.length;p++)this._layers[p].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(p,j){return this._addLayer(p,j),this._map?this._update():this},addOverlay:function(p,j){return this._addLayer(p,j,!0),this._map?this._update():this},removeLayer:function(p){p.off("add remove",this._onLayerChange,this);var j=this._getLayer(c(p));return j&&this._layers.splice(this._layers.indexOf(j),1),this._map?this._update():this},expand:function(){Ht(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var p=this._map.getSize().y-(this._container.offsetTop+50);return p<this._section.clientHeight?(Ht(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=p+"px"):cr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return cr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var p="leaflet-control-layers",j=this._container=Wt("div",p),P=this.options.collapsed;j.setAttribute("aria-haspopup",!0),ei(j),zf(j);var $=this._section=Wt("section",p+"-list");P&&(this._map.on("click",this.collapse,this),jr(j,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var W=this._layersLink=Wt("a",p+"-toggle",j);W.href="#",W.title="Layers",W.setAttribute("role","button"),jr(W,{keydown:function(re){re.keyCode===13&&this._expandSafely()},click:function(re){rs(re),this._expandSafely()}},this),P||this.expand(),this._baseLayersList=Wt("div",p+"-base",$),this._separator=Wt("div",p+"-separator",$),this._overlaysList=Wt("div",p+"-overlays",$),j.appendChild($)},_getLayer:function(p){for(var j=0;j<this._layers.length;j++)if(this._layers[j]&&c(this._layers[j].layer)===p)return this._layers[j]},_addLayer:function(p,j,P){this._map&&p.on("add remove",this._onLayerChange,this),this._layers.push({layer:p,name:j,overlay:P}),this.options.sortLayers&&this._layers.sort(o(function($,W){return this.options.sortFunction($.layer,W.layer,$.name,W.name)},this)),this.options.autoZIndex&&p.setZIndex&&(this._lastZIndex++,p.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;yn(this._baseLayersList),yn(this._overlaysList),this._layerControlInputs=[];var p,j,P,$,W=0;for(P=0;P<this._layers.length;P++)$=this._layers[P],this._addItem($),j=j||$.overlay,p=p||!$.overlay,W+=$.overlay?0:1;return this.options.hideSingleBase&&(p=p&&W>1,this._baseLayersList.style.display=p?"":"none"),this._separator.style.display=j&&p?"":"none",this},_onLayerChange:function(p){this._handlingClick||this._update();var j=this._getLayer(c(p.target)),P=j.overlay?p.type==="add"?"overlayadd":"overlayremove":p.type==="add"?"baselayerchange":null;P&&this._map.fire(P,j)},_createRadioElement:function(p,j){var P='<input type="radio" class="leaflet-control-layers-selector" name="'+p+'"'+(j?' checked="checked"':"")+"/>",$=document.createElement("div");return $.innerHTML=P,$.firstChild},_addItem:function(p){var j=document.createElement("label"),P=this._map.hasLayer(p.layer),$;p.overlay?($=document.createElement("input"),$.type="checkbox",$.className="leaflet-control-layers-selector",$.defaultChecked=P):$=this._createRadioElement("leaflet-base-layers_"+c(this),P),this._layerControlInputs.push($),$.layerId=c(p.layer),jr($,"click",this._onInputClick,this);var W=document.createElement("span");W.innerHTML=" "+p.name;var re=document.createElement("span");j.appendChild(re),re.appendChild($),re.appendChild(W);var be=p.overlay?this._overlaysList:this._baseLayersList;return be.appendChild(j),this._checkDisabledLayers(),j},_onInputClick:function(){if(!this._preventClick){var p=this._layerControlInputs,j,P,$=[],W=[];this._handlingClick=!0;for(var re=p.length-1;re>=0;re--)j=p[re],P=this._getLayer(j.layerId).layer,j.checked?$.push(P):j.checked||W.push(P);for(re=0;re<W.length;re++)this._map.hasLayer(W[re])&&this._map.removeLayer(W[re]);for(re=0;re<$.length;re++)this._map.hasLayer($[re])||this._map.addLayer($[re]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var p=this._layerControlInputs,j,P,$=this._map.getZoom(),W=p.length-1;W>=0;W--)j=p[W],P=this._getLayer(j.layerId).layer,j.disabled=P.options.minZoom!==void 0&&$<P.options.minZoom||P.options.maxZoom!==void 0&&$>P.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var p=this._section;this._preventClick=!0,jr(p,"click",rs),this.expand();var j=this;setTimeout(function(){pn(p,"click",rs),j._preventClick=!1})}}),M0=function(p,j,P){return new Hp(p,j,P)},Uf=ti.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(p){var j="leaflet-control-zoom",P=Wt("div",j+" leaflet-bar"),$=this.options;return this._zoomInButton=this._createButton($.zoomInText,$.zoomInTitle,j+"-in",P,this._zoomIn),this._zoomOutButton=this._createButton($.zoomOutText,$.zoomOutTitle,j+"-out",P,this._zoomOut),this._updateDisabled(),p.on("zoomend zoomlevelschange",this._updateDisabled,this),P},onRemove:function(p){p.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(p){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(p.shiftKey?3:1))},_zoomOut:function(p){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(p.shiftKey?3:1))},_createButton:function(p,j,P,$,W){var re=Wt("a",P,$);return re.innerHTML=p,re.href="#",re.title=j,re.setAttribute("role","button"),re.setAttribute("aria-label",j),ei(re),jr(re,"click",Kl),jr(re,"click",W,this),jr(re,"click",this._refocusOnMap,this),re},_updateDisabled:function(){var p=this._map,j="leaflet-disabled";cr(this._zoomInButton,j),cr(this._zoomOutButton,j),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||p._zoom===p.getMinZoom())&&(Ht(this._zoomOutButton,j),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||p._zoom===p.getMaxZoom())&&(Ht(this._zoomInButton,j),this._zoomInButton.setAttribute("aria-disabled","true"))}});nn.mergeOptions({zoomControl:!0}),nn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Uf,this.addControl(this.zoomControl))});var D0=function(p){return new Uf(p)},he=ti.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(p){var j="leaflet-control-scale",P=Wt("div",j),$=this.options;return this._addScales($,j+"-line",P),p.on($.updateWhenIdle?"moveend":"move",this._update,this),p.whenReady(this._update,this),P},onRemove:function(p){p.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(p,j,P){p.metric&&(this._mScale=Wt("div",j,P)),p.imperial&&(this._iScale=Wt("div",j,P))},_update:function(){var p=this._map,j=p.getSize().y/2,P=p.distance(p.containerPointToLatLng([0,j]),p.containerPointToLatLng([this.options.maxWidth,j]));this._updateScales(P)},_updateScales:function(p){this.options.metric&&p&&this._updateMetric(p),this.options.imperial&&p&&this._updateImperial(p)},_updateMetric:function(p){var j=this._getRoundNum(p),P=j<1e3?j+" m":j/1e3+" km";this._updateScale(this._mScale,P,j/p)},_updateImperial:function(p){var j=p*3.2808399,P,$,W;j>5280?(P=j/5280,$=this._getRoundNum(P),this._updateScale(this._iScale,$+" mi",$/P)):(W=this._getRoundNum(j),this._updateScale(this._iScale,W+" ft",W/j))},_updateScale:function(p,j,P){p.style.width=Math.round(this.options.maxWidth*P)+"px",p.innerHTML=j},_getRoundNum:function(p){var j=Math.pow(10,(Math.floor(p)+"").length-1),P=p/j;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:1,j*P}}),$e=function(p){return new he(p)},lt='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Se=ti.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ne.inlineSvg?lt+" ":"")+"Leaflet</a>"},initialize:function(p){g(this,p),this._attributions={}},onAdd:function(p){p.attributionControl=this,this._container=Wt("div","leaflet-control-attribution"),ei(this._container);for(var j in p._layers)p._layers[j].getAttribution&&this.addAttribution(p._layers[j].getAttribution());return this._update(),p.on("layeradd",this._addAttribution,this),this._container},onRemove:function(p){p.off("layeradd",this._addAttribution,this)},_addAttribution:function(p){p.layer.getAttribution&&(this.addAttribution(p.layer.getAttribution()),p.layer.once("remove",function(){this.removeAttribution(p.layer.getAttribution())},this))},setPrefix:function(p){return this.options.prefix=p,this._update(),this},addAttribution:function(p){return p?(this._attributions[p]||(this._attributions[p]=0),this._attributions[p]++,this._update(),this):this},removeAttribution:function(p){return p?(this._attributions[p]&&(this._attributions[p]--,this._update()),this):this},_update:function(){if(this._map){var p=[];for(var j in this._attributions)this._attributions[j]&&p.push(j);var P=[];this.options.prefix&&P.push(this.options.prefix),p.length&&P.push(p.join(", ")),this._container.innerHTML=P.join(' <span aria-hidden="true">|</span> ')}}});nn.mergeOptions({attributionControl:!0}),nn.addInitHook(function(){this.options.attributionControl&&new Se().addTo(this)});var ar=function(p){return new Se(p)};ti.Layers=Hp,ti.Zoom=Uf,ti.Scale=he,ti.Attribution=Se,Xc.layers=M0,Xc.zoom=D0,Xc.scale=$e,Xc.attribution=ar;var kt=B.extend({initialize:function(p){this._map=p},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});kt.addTo=function(p,j){return p.addHandler(j,this),this};var $t={Events:U},Ut=Ne.touch?"touchstart mousedown":"mousedown",pr=H.extend({options:{clickTolerance:3},initialize:function(p,j,P,$){g(this,$),this._element=p,this._dragStartTarget=j||p,this._preventOutline=P},enable:function(){this._enabled||(jr(this._dragStartTarget,Ut,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(pr._dragging===this&&this.finishDrag(!0),pn(this._dragStartTarget,Ut,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(p){if(this._enabled&&(this._moved=!1,!Cn(this._element,"leaflet-zoom-anim"))){if(p.touches&&p.touches.length!==1){pr._dragging===this&&this.finishDrag();return}if(!(pr._dragging||p.shiftKey||p.which!==1&&p.button!==1&&!p.touches)&&(pr._dragging=this,this._preventOutline&&Qa(this._element),Mr(),la(),!this._moving)){this.fire("down");var j=p.touches?p.touches[0]:p,P=js(this._element);this._startPoint=new q(j.clientX,j.clientY),this._startPos=zn(this._element),this._parentScale=os(P);var $=p.type==="mousedown";jr(document,$?"mousemove":"touchmove",this._onMove,this),jr(document,$?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(p){if(this._enabled){if(p.touches&&p.touches.length>1){this._moved=!0;return}var j=p.touches&&p.touches.length===1?p.touches[0]:p,P=new q(j.clientX,j.clientY)._subtract(this._startPoint);!P.x&&!P.y||Math.abs(P.x)+Math.abs(P.y)<this.options.clickTolerance||(P.x/=this._parentScale.x,P.y/=this._parentScale.y,rs(p),this._moved||(this.fire("dragstart"),this._moved=!0,Ht(document.body,"leaflet-dragging"),this._lastTarget=p.target||p.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ht(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(P),this._moving=!0,this._lastEvent=p,this._updatePosition())}},_updatePosition:function(){var p={originalEvent:this._lastEvent};this.fire("predrag",p),Br(this._element,this._newPos),this.fire("drag",p)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(p){cr(document.body,"leaflet-dragging"),this._lastTarget&&(cr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),pn(document,"mousemove touchmove",this._onMove,this),pn(document,"mouseup touchend touchcancel",this._onUp,this),un(),Da();var j=this._moved&&this._moving;this._moving=!1,pr._dragging=!1,j&&this.fire("dragend",{noInertia:p,distance:this._newPos.distanceTo(this._startPos)})}});function Gr(p,j,P){var $,W=[1,4,2,8],re,be,Be,He,ut,zt,vr,Xr;for(re=0,zt=p.length;re<zt;re++)p[re]._code=ol(p[re],j);for(Be=0;Be<4;Be++){for(vr=W[Be],$=[],re=0,zt=p.length,be=zt-1;re<zt;be=re++)He=p[re],ut=p[be],He._code&vr?ut._code&vr||(Xr=uu(ut,He,vr,j,P),Xr._code=ol(Xr,j),$.push(Xr)):(ut._code&vr&&(Xr=uu(ut,He,vr,j,P),Xr._code=ol(Xr,j),$.push(Xr)),$.push(He));p=$}return p}function _r(p,j){var P,$,W,re,be,Be,He,ut,zt;if(!p||p.length===0)throw new Error("latlngs not passed");$a(p)||(console.warn("latlngs are not flat! Only the first ring will be used"),p=p[0]);var vr=_e([0,0]),Xr=se(p),La=Xr.getNorthWest().distanceTo(Xr.getSouthWest())*Xr.getNorthEast().distanceTo(Xr.getNorthWest());La<1700&&(vr=fn(p));var Xs=p.length,Bi=[];for(P=0;P<Xs;P++){var ri=_e(p[P]);Bi.push(j.project(_e([ri.lat-vr.lat,ri.lng-vr.lng])))}for(Be=He=ut=0,P=0,$=Xs-1;P<Xs;$=P++)W=Bi[P],re=Bi[$],be=W.y*re.x-re.y*W.x,He+=(W.x+re.x)*be,ut+=(W.y+re.y)*be,Be+=be*3;Be===0?zt=Bi[0]:zt=[He/Be,ut/Be];var Yf=j.unproject(Z(zt));return _e([Yf.lat+vr.lat,Yf.lng+vr.lng])}function fn(p){for(var j=0,P=0,$=0,W=0;W<p.length;W++){var re=_e(p[W]);j+=re.lat,P+=re.lng,$++}return _e([j/$,P/$])}var Cs={__proto__:null,clipPolygon:Gr,polygonCenter:_r,centroid:fn};function lr(p,j){if(!j||!p.length)return p.slice();var P=j*j;return p=ca(p,P),p=Dr(p,P),p}function sn(p,j,P){return Math.sqrt(Jc(p,j,P,!0))}function Yn(p,j,P){return Jc(p,j,P)}function Dr(p,j){var P=p.length,$=typeof Uint8Array!="undefined"?Uint8Array:Array,W=new $(P);W[0]=W[P-1]=1,Qt(p,W,j,0,P-1);var re,be=[];for(re=0;re<P;re++)W[re]&&be.push(p[re]);return be}function Qt(p,j,P,$,W){var re=0,be,Be,He;for(Be=$+1;Be<=W-1;Be++)He=Jc(p[Be],p[$],p[W],!0),He>re&&(be=Be,re=He);re>P&&(j[be]=1,Qt(p,j,P,$,be),Qt(p,j,P,be,W))}function ca(p,j){for(var P=[p[0]],$=1,W=0,re=p.length;$<re;$++)I0(p[$],p[W])>j&&(P.push(p[$]),W=$);return W<re-1&&P.push(p[re-1]),P}var wr;function Pn(p,j,P,$,W){var re=$?wr:ol(p,P),be=ol(j,P),Be,He,ut;for(wr=be;;){if(!(re|be))return[p,j];if(re&be)return!1;Be=re||be,He=uu(p,j,Be,P,W),ut=ol(He,P),Be===re?(p=He,re=ut):(j=He,be=ut)}}function uu(p,j,P,$,W){var re=j.x-p.x,be=j.y-p.y,Be=$.min,He=$.max,ut,zt;return P&8?(ut=p.x+re*(He.y-p.y)/be,zt=He.y):P&4?(ut=p.x+re*(Be.y-p.y)/be,zt=Be.y):P&2?(ut=He.x,zt=p.y+be*(He.x-p.x)/re):P&1&&(ut=Be.x,zt=p.y+be*(Be.x-p.x)/re),new q(ut,zt,W)}function ol(p,j){var P=0;return p.x<j.min.x?P|=1:p.x>j.max.x&&(P|=2),p.y<j.min.y?P|=4:p.y>j.max.y&&(P|=8),P}function I0(p,j){var P=j.x-p.x,$=j.y-p.y;return P*P+$*$}function Jc(p,j,P,$){var W=j.x,re=j.y,be=P.x-W,Be=P.y-re,He=be*be+Be*Be,ut;return He>0&&(ut=((p.x-W)*be+(p.y-re)*Be)/He,ut>1?(W=P.x,re=P.y):ut>0&&(W+=be*ut,re+=Be*ut)),be=p.x-W,Be=p.y-re,$?be*be+Be*Be:new q(W,re)}function $a(p){return!b(p[0])||typeof p[0][0]!="object"&&typeof p[0][0]!="undefined"}function Gp(p){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),$a(p)}function Yp(p,j){var P,$,W,re,be,Be,He,ut;if(!p||p.length===0)throw new Error("latlngs not passed");$a(p)||(console.warn("latlngs are not flat! Only the first ring will be used"),p=p[0]);var zt=_e([0,0]),vr=se(p),Xr=vr.getNorthWest().distanceTo(vr.getSouthWest())*vr.getNorthEast().distanceTo(vr.getNorthWest());Xr<1700&&(zt=fn(p));var La=p.length,Xs=[];for(P=0;P<La;P++){var Bi=_e(p[P]);Xs.push(j.project(_e([Bi.lat-zt.lat,Bi.lng-zt.lng])))}for(P=0,$=0;P<La-1;P++)$+=Xs[P].distanceTo(Xs[P+1])/2;if($===0)ut=Xs[0];else for(P=0,re=0;P<La-1;P++)if(be=Xs[P],Be=Xs[P+1],W=be.distanceTo(Be),re+=W,re>$){He=(re-$)/W,ut=[Be.x-He*(Be.x-be.x),Be.y-He*(Be.y-be.y)];break}var ri=j.unproject(Z(ut));return _e([ri.lat+zt.lat,ri.lng+zt.lng])}var $0={__proto__:null,simplify:lr,pointToSegmentDistance:sn,closestPointOnSegment:Yn,clipSegment:Pn,_getEdgeIntersection:uu,_getBitCode:ol,_sqClosestPointOnSegment:Jc,isFlat:$a,_flat:Gp,polylineCenter:Yp},qj={project:function(p){return new q(p.lng,p.lat)},unproject:function(p){return new de(p.y,p.x)},bounds:new ne([-180,-90],[180,90])},Vj={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ne([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(p){var j=Math.PI/180,P=this.R,$=p.lat*j,W=this.R_MINOR/P,re=Math.sqrt(1-W*W),be=re*Math.sin($),Be=Math.tan(Math.PI/4-$/2)/Math.pow((1-be)/(1+be),re/2);return $=-P*Math.log(Math.max(Be,1e-10)),new q(p.lng*j*P,$)},unproject:function(p){for(var j=180/Math.PI,P=this.R,$=this.R_MINOR/P,W=Math.sqrt(1-$*$),re=Math.exp(-p.y/P),be=Math.PI/2-2*Math.atan(re),Be=0,He=.1,ut;Be<15&&Math.abs(He)>1e-7;Be++)ut=W*Math.sin(be),ut=Math.pow((1-ut)/(1+ut),W/2),He=Math.PI/2-2*Math.atan(re*ut)-be,be+=He;return new de(be*j,p.x*j/P)}},EK={__proto__:null,LonLat:qj,Mercator:Vj,SphericalMercator:ie},CK=a({},Q,{code:"EPSG:3395",projection:Vj,transformation:function(){var p=.5/(Math.PI*Vj.R);return G(p,.5,-p,.5)}()}),V5=a({},Q,{code:"EPSG:4326",projection:qj,transformation:G(1/180,1,-1/180,.5)}),PK=a({},xe,{projection:qj,transformation:G(1,0,-1,0),scale:function(p){return Math.pow(2,p)},zoom:function(p){return Math.log(p)/Math.LN2},distance:function(p,j){var P=j.lng-p.lng,$=j.lat-p.lat;return Math.sqrt(P*P+$*$)},infinite:!0});xe.Earth=Q,xe.EPSG3395=CK,xe.EPSG3857=J,xe.EPSG900913=ae,xe.EPSG4326=V5,xe.Simple=PK;var xo=H.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(p){return p.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(p){return p&&p.removeLayer(this),this},getPane:function(p){return this._map.getPane(p?this.options[p]||p:this.options.pane)},addInteractiveTarget:function(p){return this._map._targets[c(p)]=this,this},removeInteractiveTarget:function(p){return delete this._map._targets[c(p)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(p){var j=p.target;if(j.hasLayer(this)){if(this._map=j,this._zoomAnimated=j._zoomAnimated,this.getEvents){var P=this.getEvents();j.on(P,this),this.once("remove",function(){j.off(P,this)},this)}this.onAdd(j),this.fire("add"),j.fire("layeradd",{layer:this})}}});nn.include({addLayer:function(p){if(!p._layerAdd)throw new Error("The provided object is not a Layer.");var j=c(p);return this._layers[j]?this:(this._layers[j]=p,p._mapToAdd=this,p.beforeAdd&&p.beforeAdd(this),this.whenReady(p._layerAdd,p),this)},removeLayer:function(p){var j=c(p);return this._layers[j]?(this._loaded&&p.onRemove(this),delete this._layers[j],this._loaded&&(this.fire("layerremove",{layer:p}),p.fire("remove")),p._map=p._mapToAdd=null,this):this},hasLayer:function(p){return c(p)in this._layers},eachLayer:function(p,j){for(var P in this._layers)p.call(j,this._layers[P]);return this},_addLayers:function(p){p=p?b(p)?p:[p]:[];for(var j=0,P=p.length;j<P;j++)this.addLayer(p[j])},_addZoomLimit:function(p){(!isNaN(p.options.maxZoom)||!isNaN(p.options.minZoom))&&(this._zoomBoundLayers[c(p)]=p,this._updateZoomLevels())},_removeZoomLimit:function(p){var j=c(p);this._zoomBoundLayers[j]&&(delete this._zoomBoundLayers[j],this._updateZoomLevels())},_updateZoomLevels:function(){var p=1/0,j=-1/0,P=this._getZoomSpan();for(var $ in this._zoomBoundLayers){var W=this._zoomBoundLayers[$].options;p=W.minZoom===void 0?p:Math.min(p,W.minZoom),j=W.maxZoom===void 0?j:Math.max(j,W.maxZoom)}this._layersMaxZoom=j===-1/0?void 0:j,this._layersMinZoom=p===1/0?void 0:p,P!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var qf=xo.extend({initialize:function(p,j){g(this,j),this._layers={};var P,$;if(p)for(P=0,$=p.length;P<$;P++)this.addLayer(p[P])},addLayer:function(p){var j=this.getLayerId(p);return this._layers[j]=p,this._map&&this._map.addLayer(p),this},removeLayer:function(p){var j=p in this._layers?p:this.getLayerId(p);return this._map&&this._layers[j]&&this._map.removeLayer(this._layers[j]),delete this._layers[j],this},hasLayer:function(p){var j=typeof p=="number"?p:this.getLayerId(p);return j in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(p){var j=Array.prototype.slice.call(arguments,1),P,$;for(P in this._layers)$=this._layers[P],$[p]&&$[p].apply($,j);return this},onAdd:function(p){this.eachLayer(p.addLayer,p)},onRemove:function(p){this.eachLayer(p.removeLayer,p)},eachLayer:function(p,j){for(var P in this._layers)p.call(j,this._layers[P]);return this},getLayer:function(p){return this._layers[p]},getLayers:function(){var p=[];return this.eachLayer(p.push,p),p},setZIndex:function(p){return this.invoke("setZIndex",p)},getLayerId:function(p){return c(p)}}),TK=function(p,j){return new qf(p,j)},Zl=qf.extend({addLayer:function(p){return this.hasLayer(p)?this:(p.addEventParent(this),qf.prototype.addLayer.call(this,p),this.fire("layeradd",{layer:p}))},removeLayer:function(p){return this.hasLayer(p)?(p in this._layers&&(p=this._layers[p]),p.removeEventParent(this),qf.prototype.removeLayer.call(this,p),this.fire("layerremove",{layer:p})):this},setStyle:function(p){return this.invoke("setStyle",p)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var p=new X;for(var j in this._layers){var P=this._layers[j];p.extend(P.getBounds?P.getBounds():P.getLatLng())}return p}}),AK=function(p,j){return new Zl(p,j)},Vf=B.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(p){g(this,p)},createIcon:function(p){return this._createIcon("icon",p)},createShadow:function(p){return this._createIcon("shadow",p)},_createIcon:function(p,j){var P=this._getIconUrl(p);if(!P){if(p==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var $=this._createImg(P,j&&j.tagName==="IMG"?j:null);return this._setIconStyles($,p),(this.options.crossOrigin||this.options.crossOrigin==="")&&($.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),$},_setIconStyles:function(p,j){var P=this.options,$=P[j+"Size"];typeof $=="number"&&($=[$,$]);var W=Z($),re=Z(j==="shadow"&&P.shadowAnchor||P.iconAnchor||W&&W.divideBy(2,!0));p.className="leaflet-marker-"+j+" "+(P.className||""),re&&(p.style.marginLeft=-re.x+"px",p.style.marginTop=-re.y+"px"),W&&(p.style.width=W.x+"px",p.style.height=W.y+"px")},_createImg:function(p,j){return j=j||document.createElement("img"),j.src=p,j},_getIconUrl:function(p){return Ne.retina&&this.options[p+"RetinaUrl"]||this.options[p+"Url"]}});function RK(p){return new Vf(p)}var Kp=Vf.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(p){return typeof Kp.imagePath!="string"&&(Kp.imagePath=this._detectIconPath()),(this.options.imagePath||Kp.imagePath)+Vf.prototype._getIconUrl.call(this,p)},_stripUrl:function(p){var j=function(P,$,W){var re=$.exec(P);return re&&re[W]};return p=j(p,/^url\((['"])?(.+)\1\)$/,2),p&&j(p,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var p=Wt("div","leaflet-default-icon-path",document.body),j=or(p,"background-image")||or(p,"backgroundImage");if(document.body.removeChild(p),j=this._stripUrl(j),j)return j;var P=document.querySelector('link[href$="leaflet.css"]');return P?P.href.substring(0,P.href.length-11-1):""}}),W5=kt.extend({initialize:function(p){this._marker=p},addHooks:function(){var p=this._marker._icon;this._draggable||(this._draggable=new pr(p,p,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ht(p,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&cr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(p){var j=this._marker,P=j._map,$=this._marker.options.autoPanSpeed,W=this._marker.options.autoPanPadding,re=zn(j._icon),be=P.getPixelBounds(),Be=P.getPixelOrigin(),He=Y(be.min._subtract(Be).add(W),be.max._subtract(Be).subtract(W));if(!He.contains(re)){var ut=Z((Math.max(He.max.x,re.x)-He.max.x)/(be.max.x-He.max.x)-(Math.min(He.min.x,re.x)-He.min.x)/(be.min.x-He.min.x),(Math.max(He.max.y,re.y)-He.max.y)/(be.max.y-He.max.y)-(Math.min(He.min.y,re.y)-He.min.y)/(be.min.y-He.min.y)).multiplyBy($);P.panBy(ut,{animate:!1}),this._draggable._newPos._add(ut),this._draggable._startPos._add(ut),Br(j._icon,this._draggable._newPos),this._onDrag(p),this._panRequest=O(this._adjustPan.bind(this,p))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(p){this._marker.options.autoPan&&(z(this._panRequest),this._panRequest=O(this._adjustPan.bind(this,p)))},_onDrag:function(p){var j=this._marker,P=j._shadow,$=zn(j._icon),W=j._map.layerPointToLatLng($);P&&Br(P,$),j._latlng=W,p.latlng=W,p.oldLatLng=this._oldLatLng,j.fire("move",p).fire("drag",p)},_onDragEnd:function(p){z(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",p)}}),L0=xo.extend({options:{icon:new Kp,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(p,j){g(this,j),this._latlng=_e(p)},onAdd:function(p){this._zoomAnimated=this._zoomAnimated&&p.options.markerZoomAnimation,this._zoomAnimated&&p.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(p){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&p.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(p){var j=this._latlng;return this._latlng=_e(p),this.update(),this.fire("move",{oldLatLng:j,latlng:this._latlng})},setZIndexOffset:function(p){return this.options.zIndexOffset=p,this.update()},getIcon:function(){return this.options.icon},setIcon:function(p){return this.options.icon=p,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var p=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(p)}return this},_initIcon:function(){var p=this.options,j="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),P=p.icon.createIcon(this._icon),$=!1;P!==this._icon&&(this._icon&&this._removeIcon(),$=!0,p.title&&(P.title=p.title),P.tagName==="IMG"&&(P.alt=p.alt||"")),Ht(P,j),p.keyboard&&(P.tabIndex="0",P.setAttribute("role","button")),this._icon=P,p.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&jr(P,"focus",this._panOnFocus,this);var W=p.icon.createShadow(this._shadow),re=!1;W!==this._shadow&&(this._removeShadow(),re=!0),W&&(Ht(W,j),W.alt=""),this._shadow=W,p.opacity<1&&this._updateOpacity(),$&&this.getPane().appendChild(this._icon),this._initInteraction(),W&&re&&this.getPane(p.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&pn(this._icon,"focus",this._panOnFocus,this),Sr(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Sr(this._shadow),this._shadow=null},_setPos:function(p){this._icon&&Br(this._icon,p),this._shadow&&Br(this._shadow,p),this._zIndex=p.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(p){this._icon&&(this._icon.style.zIndex=this._zIndex+p)},_animateZoom:function(p){var j=this._map._latLngToNewLayerPoint(this._latlng,p.zoom,p.center).round();this._setPos(j)},_initInteraction:function(){if(this.options.interactive&&(Ht(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),W5)){var p=this.options.draggable;this.dragging&&(p=this.dragging.enabled(),this.dragging.disable()),this.dragging=new W5(this),p&&this.dragging.enable()}},setOpacity:function(p){return this.options.opacity=p,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var p=this.options.opacity;this._icon&&is(this._icon,p),this._shadow&&is(this._shadow,p)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var p=this._map;if(p){var j=this.options.icon.options,P=j.iconSize?Z(j.iconSize):Z(0,0),$=j.iconAnchor?Z(j.iconAnchor):Z(0,0);p.panInside(this._latlng,{paddingTopLeft:$,paddingBottomRight:P.subtract($)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function OK(p,j){return new L0(p,j)}var Qc=xo.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(p){this._renderer=p.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(p){return g(this,p),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&p&&Object.prototype.hasOwnProperty.call(p,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),F0=Qc.extend({options:{fill:!0,radius:10},initialize:function(p,j){g(this,j),this._latlng=_e(p),this._radius=this.options.radius},setLatLng:function(p){var j=this._latlng;return this._latlng=_e(p),this.redraw(),this.fire("move",{oldLatLng:j,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(p){return this.options.radius=this._radius=p,this.redraw()},getRadius:function(){return this._radius},setStyle:function(p){var j=p&&p.radius||this._radius;return Qc.prototype.setStyle.call(this,p),this.setRadius(j),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var p=this._radius,j=this._radiusY||p,P=this._clickTolerance(),$=[p+P,j+P];this._pxBounds=new ne(this._point.subtract($),this._point.add($))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(p){return p.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function MK(p,j){return new F0(p,j)}var Wj=F0.extend({initialize:function(p,j,P){if(typeof j=="number"&&(j=a({},P,{radius:j})),g(this,j),this._latlng=_e(p),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(p){return this._mRadius=p,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var p=[this._radius,this._radiusY||this._radius];return new X(this._map.layerPointToLatLng(this._point.subtract(p)),this._map.layerPointToLatLng(this._point.add(p)))},setStyle:Qc.prototype.setStyle,_project:function(){var p=this._latlng.lng,j=this._latlng.lat,P=this._map,$=P.options.crs;if($.distance===Q.distance){var W=Math.PI/180,re=this._mRadius/Q.R/W,be=P.project([j+re,p]),Be=P.project([j-re,p]),He=be.add(Be).divideBy(2),ut=P.unproject(He).lat,zt=Math.acos((Math.cos(re*W)-Math.sin(j*W)*Math.sin(ut*W))/(Math.cos(j*W)*Math.cos(ut*W)))/W;(isNaN(zt)||zt===0)&&(zt=re/Math.cos(Math.PI/180*j)),this._point=He.subtract(P.getPixelOrigin()),this._radius=isNaN(zt)?0:He.x-P.project([ut,p-zt]).x,this._radiusY=He.y-be.y}else{var vr=$.unproject($.project(this._latlng).subtract([this._mRadius,0]));this._point=P.latLngToLayerPoint(this._latlng),this._radius=this._point.x-P.latLngToLayerPoint(vr).x}this._updateBounds()}});function DK(p,j,P){return new Wj(p,j,P)}var Xl=Qc.extend({options:{smoothFactor:1,noClip:!1},initialize:function(p,j){g(this,j),this._setLatLngs(p)},getLatLngs:function(){return this._latlngs},setLatLngs:function(p){return this._setLatLngs(p),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(p){for(var j=1/0,P=null,$=Jc,W,re,be=0,Be=this._parts.length;be<Be;be++)for(var He=this._parts[be],ut=1,zt=He.length;ut<zt;ut++){W=He[ut-1],re=He[ut];var vr=$(p,W,re,!0);vr<j&&(j=vr,P=$(p,W,re))}return P&&(P.distance=Math.sqrt(j)),P},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Yp(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(p,j){return j=j||this._defaultShape(),p=_e(p),j.push(p),this._bounds.extend(p),this.redraw()},_setLatLngs:function(p){this._bounds=new X,this._latlngs=this._convertLatLngs(p)},_defaultShape:function(){return $a(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(p){for(var j=[],P=$a(p),$=0,W=p.length;$<W;$++)P?(j[$]=_e(p[$]),this._bounds.extend(j[$])):j[$]=this._convertLatLngs(p[$]);return j},_project:function(){var p=new ne;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,p),this._bounds.isValid()&&p.isValid()&&(this._rawPxBounds=p,this._updateBounds())},_updateBounds:function(){var p=this._clickTolerance(),j=new q(p,p);this._rawPxBounds&&(this._pxBounds=new ne([this._rawPxBounds.min.subtract(j),this._rawPxBounds.max.add(j)]))},_projectLatlngs:function(p,j,P){var $=p[0]instanceof de,W=p.length,re,be;if($){for(be=[],re=0;re<W;re++)be[re]=this._map.latLngToLayerPoint(p[re]),P.extend(be[re]);j.push(be)}else for(re=0;re<W;re++)this._projectLatlngs(p[re],j,P)},_clipPoints:function(){var p=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(p))){if(this.options.noClip){this._parts=this._rings;return}var j=this._parts,P,$,W,re,be,Be,He;for(P=0,W=0,re=this._rings.length;P<re;P++)for(He=this._rings[P],$=0,be=He.length;$<be-1;$++)Be=Pn(He[$],He[$+1],p,$,!0),Be&&(j[W]=j[W]||[],j[W].push(Be[0]),(Be[1]!==He[$+1]||$===be-2)&&(j[W].push(Be[1]),W++))}},_simplifyPoints:function(){for(var p=this._parts,j=this.options.smoothFactor,P=0,$=p.length;P<$;P++)p[P]=lr(p[P],j)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(p,j){var P,$,W,re,be,Be,He=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(p))return!1;for(P=0,re=this._parts.length;P<re;P++)for(Be=this._parts[P],$=0,be=Be.length,W=be-1;$<be;W=$++)if(!(!j&&$===0)&&sn(p,Be[W],Be[$])<=He)return!0;return!1}});function IK(p,j){return new Xl(p,j)}Xl._flat=Gp;var Wf=Xl.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return _r(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(p){var j=Xl.prototype._convertLatLngs.call(this,p),P=j.length;return P>=2&&j[0]instanceof de&&j[0].equals(j[P-1])&&j.pop(),j},_setLatLngs:function(p){Xl.prototype._setLatLngs.call(this,p),$a(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return $a(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var p=this._renderer._bounds,j=this.options.weight,P=new q(j,j);if(p=new ne(p.min.subtract(P),p.max.add(P)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(p))){if(this.options.noClip){this._parts=this._rings;return}for(var $=0,W=this._rings.length,re;$<W;$++)re=Gr(this._rings[$],p,!0),re.length&&this._parts.push(re)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(p){var j=!1,P,$,W,re,be,Be,He,ut;if(!this._pxBounds||!this._pxBounds.contains(p))return!1;for(re=0,He=this._parts.length;re<He;re++)for(P=this._parts[re],be=0,ut=P.length,Be=ut-1;be<ut;Be=be++)$=P[be],W=P[Be],$.y>p.y!=W.y>p.y&&p.x<(W.x-$.x)*(p.y-$.y)/(W.y-$.y)+$.x&&(j=!j);return j||Xl.prototype._containsPoint.call(this,p,!0)}});function $K(p,j){return new Wf(p,j)}var Jl=Zl.extend({initialize:function(p,j){g(this,j),this._layers={},p&&this.addData(p)},addData:function(p){var j=b(p)?p:p.features,P,$,W;if(j){for(P=0,$=j.length;P<$;P++)W=j[P],(W.geometries||W.geometry||W.features||W.coordinates)&&this.addData(W);return this}var re=this.options;if(re.filter&&!re.filter(p))return this;var be=z0(p,re);return be?(be.feature=q0(p),be.defaultOptions=be.options,this.resetStyle(be),re.onEachFeature&&re.onEachFeature(p,be),this.addLayer(be)):this},resetStyle:function(p){return p===void 0?this.eachLayer(this.resetStyle,this):(p.options=a({},p.defaultOptions),this._setLayerStyle(p,this.options.style),this)},setStyle:function(p){return this.eachLayer(function(j){this._setLayerStyle(j,p)},this)},_setLayerStyle:function(p,j){p.setStyle&&(typeof j=="function"&&(j=j(p.feature)),p.setStyle(j))}});function z0(p,j){var P=p.type==="Feature"?p.geometry:p,$=P?P.coordinates:null,W=[],re=j&&j.pointToLayer,be=j&&j.coordsToLatLng||Hj,Be,He,ut,zt;if(!$&&!P)return null;switch(P.type){case"Point":return Be=be($),H5(re,p,Be,j);case"MultiPoint":for(ut=0,zt=$.length;ut<zt;ut++)Be=be($[ut]),W.push(H5(re,p,Be,j));return new Zl(W);case"LineString":case"MultiLineString":return He=B0($,P.type==="LineString"?0:1,be),new Xl(He,j);case"Polygon":case"MultiPolygon":return He=B0($,P.type==="Polygon"?1:2,be),new Wf(He,j);case"GeometryCollection":for(ut=0,zt=P.geometries.length;ut<zt;ut++){var vr=z0({geometry:P.geometries[ut],type:"Feature",properties:p.properties},j);vr&&W.push(vr)}return new Zl(W);case"FeatureCollection":for(ut=0,zt=P.features.length;ut<zt;ut++){var Xr=z0(P.features[ut],j);Xr&&W.push(Xr)}return new Zl(W);default:throw new Error("Invalid GeoJSON object.")}}function H5(p,j,P,$){return p?p(j,P):new L0(P,$&&$.markersInheritOptions&&$)}function Hj(p){return new de(p[1],p[0],p[2])}function B0(p,j,P){for(var $=[],W=0,re=p.length,be;W<re;W++)be=j?B0(p[W],j-1,P):(P||Hj)(p[W]),$.push(be);return $}function Gj(p,j){return p=_e(p),p.alt!==void 0?[h(p.lng,j),h(p.lat,j),h(p.alt,j)]:[h(p.lng,j),h(p.lat,j)]}function U0(p,j,P,$){for(var W=[],re=0,be=p.length;re<be;re++)W.push(j?U0(p[re],$a(p[re])?0:j-1,P,$):Gj(p[re],$));return!j&&P&&W.length>0&&W.push(W[0].slice()),W}function Hf(p,j){return p.feature?a({},p.feature,{geometry:j}):q0(j)}function q0(p){return p.type==="Feature"||p.type==="FeatureCollection"?p:{type:"Feature",properties:{},geometry:p}}var Yj={toGeoJSON:function(p){return Hf(this,{type:"Point",coordinates:Gj(this.getLatLng(),p)})}};L0.include(Yj),Wj.include(Yj),F0.include(Yj),Xl.include({toGeoJSON:function(p){var j=!$a(this._latlngs),P=U0(this._latlngs,j?1:0,!1,p);return Hf(this,{type:(j?"Multi":"")+"LineString",coordinates:P})}}),Wf.include({toGeoJSON:function(p){var j=!$a(this._latlngs),P=j&&!$a(this._latlngs[0]),$=U0(this._latlngs,P?2:j?1:0,!0,p);return j||($=[$]),Hf(this,{type:(P?"Multi":"")+"Polygon",coordinates:$})}}),qf.include({toMultiPoint:function(p){var j=[];return this.eachLayer(function(P){j.push(P.toGeoJSON(p).geometry.coordinates)}),Hf(this,{type:"MultiPoint",coordinates:j})},toGeoJSON:function(p){var j=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(j==="MultiPoint")return this.toMultiPoint(p);var P=j==="GeometryCollection",$=[];return this.eachLayer(function(W){if(W.toGeoJSON){var re=W.toGeoJSON(p);if(P)$.push(re.geometry);else{var be=q0(re);be.type==="FeatureCollection"?$.push.apply($,be.features):$.push(be)}}}),P?Hf(this,{geometries:$,type:"GeometryCollection"}):{type:"FeatureCollection",features:$}}});function G5(p,j){return new Jl(p,j)}var LK=G5,V0=xo.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(p,j,P){this._url=p,this._bounds=se(j),g(this,P)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ht(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Sr(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(p){return this.options.opacity=p,this._image&&this._updateOpacity(),this},setStyle:function(p){return p.opacity&&this.setOpacity(p.opacity),this},bringToFront:function(){return this._map&&nr(this._image),this},bringToBack:function(){return this._map&&Cr(this._image),this},setUrl:function(p){return this._url=p,this._image&&(this._image.src=p),this},setBounds:function(p){return this._bounds=se(p),this._map&&this._reset(),this},getEvents:function(){var p={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(p.zoomanim=this._animateZoom),p},setZIndex:function(p){return this.options.zIndex=p,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var p=this._url.tagName==="IMG",j=this._image=p?this._url:Wt("img");if(Ht(j,"leaflet-image-layer"),this._zoomAnimated&&Ht(j,"leaflet-zoom-animated"),this.options.className&&Ht(j,this.options.className),j.onselectstart=u,j.onmousemove=u,j.onload=o(this.fire,this,"load"),j.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(j.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),p){this._url=j.src;return}j.src=this._url,j.alt=this.options.alt},_animateZoom:function(p){var j=this._map.getZoomScale(p.zoom),P=this._map._latLngBoundsToNewLayerBounds(this._bounds,p.zoom,p.center).min;An(this._image,P,j)},_reset:function(){var p=this._image,j=new ne(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),P=j.getSize();Br(p,j.min),p.style.width=P.x+"px",p.style.height=P.y+"px"},_updateOpacity:function(){is(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var p=this.options.errorOverlayUrl;p&&this._url!==p&&(this._url=p,this._image.src=p)},getCenter:function(){return this._bounds.getCenter()}}),FK=function(p,j,P){return new V0(p,j,P)},Y5=V0.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var p=this._url.tagName==="VIDEO",j=this._image=p?this._url:Wt("video");if(Ht(j,"leaflet-image-layer"),this._zoomAnimated&&Ht(j,"leaflet-zoom-animated"),this.options.className&&Ht(j,this.options.className),j.onselectstart=u,j.onmousemove=u,j.onloadeddata=o(this.fire,this,"load"),p){for(var P=j.getElementsByTagName("source"),$=[],W=0;W<P.length;W++)$.push(P[W].src);this._url=P.length>0?$:[j.src];return}b(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(j.style,"objectFit")&&(j.style.objectFit="fill"),j.autoplay=!!this.options.autoplay,j.loop=!!this.options.loop,j.muted=!!this.options.muted,j.playsInline=!!this.options.playsInline;for(var re=0;re<this._url.length;re++){var be=Wt("source");be.src=this._url[re],j.appendChild(be)}}});function zK(p,j,P){return new Y5(p,j,P)}var K5=V0.extend({_initImage:function(){var p=this._image=this._url;Ht(p,"leaflet-image-layer"),this._zoomAnimated&&Ht(p,"leaflet-zoom-animated"),this.options.className&&Ht(p,this.options.className),p.onselectstart=u,p.onmousemove=u}});function BK(p,j,P){return new K5(p,j,P)}var ll=xo.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(p,j){p&&(p instanceof de||b(p))?(this._latlng=_e(p),g(this,j)):(g(this,p),this._source=j),this.options.content&&(this._content=this.options.content)},openOn:function(p){return p=arguments.length?p:this._source._map,p.hasLayer(this)||p.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(p){return this._map?this.close():(arguments.length?this._source=p:p=this._source,this._prepareOpen(),this.openOn(p._map)),this},onAdd:function(p){this._zoomAnimated=p._zoomAnimated,this._container||this._initLayout(),p._fadeAnimated&&is(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),p._fadeAnimated&&is(this._container,1),this.bringToFront(),this.options.interactive&&(Ht(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(p){p._fadeAnimated?(is(this._container,0),this._removeTimeout=setTimeout(o(Sr,void 0,this._container),200)):Sr(this._container),this.options.interactive&&(cr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(p){return this._latlng=_e(p),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(p){return this._content=p,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var p={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(p.zoomanim=this._animateZoom),p},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&nr(this._container),this},bringToBack:function(){return this._map&&Cr(this._container),this},_prepareOpen:function(p){var j=this._source;if(!j._map)return!1;if(j instanceof Zl){j=null;var P=this._source._layers;for(var $ in P)if(P[$]._map){j=P[$];break}if(!j)return!1;this._source=j}if(!p)if(j.getCenter)p=j.getCenter();else if(j.getLatLng)p=j.getLatLng();else if(j.getBounds)p=j.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(p),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var p=this._contentNode,j=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof j=="string")p.innerHTML=j;else{for(;p.hasChildNodes();)p.removeChild(p.firstChild);p.appendChild(j)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var p=this._map.latLngToLayerPoint(this._latlng),j=Z(this.options.offset),P=this._getAnchor();this._zoomAnimated?Br(this._container,p.add(P)):j=j.add(p).add(P);var $=this._containerBottom=-j.y,W=this._containerLeft=-Math.round(this._containerWidth/2)+j.x;this._container.style.bottom=$+"px",this._container.style.left=W+"px"}},_getAnchor:function(){return[0,0]}});nn.include({_initOverlay:function(p,j,P,$){var W=j;return W instanceof p||(W=new p($).setContent(j)),P&&W.setLatLng(P),W}}),xo.include({_initOverlay:function(p,j,P,$){var W=P;return W instanceof p?(g(W,$),W._source=this):(W=j&&!$?j:new p($,this),W.setContent(P)),W}});var W0=ll.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(p){return p=arguments.length?p:this._source._map,!p.hasLayer(this)&&p._popup&&p._popup.options.autoClose&&p.removeLayer(p._popup),p._popup=this,ll.prototype.openOn.call(this,p)},onAdd:function(p){ll.prototype.onAdd.call(this,p),p.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Qc||this._source.on("preclick",il))},onRemove:function(p){ll.prototype.onRemove.call(this,p),p.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Qc||this._source.off("preclick",il))},getEvents:function(){var p=ll.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(p.preclick=this.close),this.options.keepInView&&(p.moveend=this._adjustPan),p},_initLayout:function(){var p="leaflet-popup",j=this._container=Wt("div",p+" "+(this.options.className||"")+" leaflet-zoom-animated"),P=this._wrapper=Wt("div",p+"-content-wrapper",j);if(this._contentNode=Wt("div",p+"-content",P),ei(j),zf(this._contentNode),jr(j,"contextmenu",il),this._tipContainer=Wt("div",p+"-tip-container",j),this._tip=Wt("div",p+"-tip",this._tipContainer),this.options.closeButton){var $=this._closeButton=Wt("a",p+"-close-button",j);$.setAttribute("role","button"),$.setAttribute("aria-label","Close popup"),$.href="#close",$.innerHTML='<span aria-hidden="true">&#215;</span>',jr($,"click",function(W){rs(W),this.close()},this)}},_updateLayout:function(){var p=this._contentNode,j=p.style;j.width="",j.whiteSpace="nowrap";var P=p.offsetWidth;P=Math.min(P,this.options.maxWidth),P=Math.max(P,this.options.minWidth),j.width=P+1+"px",j.whiteSpace="",j.height="";var $=p.offsetHeight,W=this.options.maxHeight,re="leaflet-popup-scrolled";W&&$>W?(j.height=W+"px",Ht(p,re)):cr(p,re),this._containerWidth=this._container.offsetWidth},_animateZoom:function(p){var j=this._map._latLngToNewLayerPoint(this._latlng,p.zoom,p.center),P=this._getAnchor();Br(this._container,j.add(P))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var p=this._map,j=parseInt(or(this._container,"marginBottom"),10)||0,P=this._container.offsetHeight+j,$=this._containerWidth,W=new q(this._containerLeft,-P-this._containerBottom);W._add(zn(this._container));var re=p.layerPointToContainerPoint(W),be=Z(this.options.autoPanPadding),Be=Z(this.options.autoPanPaddingTopLeft||be),He=Z(this.options.autoPanPaddingBottomRight||be),ut=p.getSize(),zt=0,vr=0;re.x+$+He.x>ut.x&&(zt=re.x+$-ut.x+He.x),re.x-zt-Be.x<0&&(zt=re.x-Be.x),re.y+P+He.y>ut.y&&(vr=re.y+P-ut.y+He.y),re.y-vr-Be.y<0&&(vr=re.y-Be.y),(zt||vr)&&(this.options.keepInView&&(this._autopanning=!0),p.fire("autopanstart").panBy([zt,vr]))}},_getAnchor:function(){return Z(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),UK=function(p,j){return new W0(p,j)};nn.mergeOptions({closePopupOnClick:!0}),nn.include({openPopup:function(p,j,P){return this._initOverlay(W0,p,j,P).openOn(this),this},closePopup:function(p){return p=arguments.length?p:this._popup,p&&p.close(),this}}),xo.include({bindPopup:function(p,j){return this._popup=this._initOverlay(W0,this._popup,p,j),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(p){return this._popup&&(this instanceof Zl||(this._popup._source=this),this._popup._prepareOpen(p||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(p){return this._popup&&this._popup.setContent(p),this},getPopup:function(){return this._popup},_openPopup:function(p){if(!(!this._popup||!this._map)){Kl(p);var j=p.layer||p.target;if(this._popup._source===j&&!(j instanceof Qc)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(p.latlng);return}this._popup._source=j,this.openPopup(p.latlng)}},_movePopup:function(p){this._popup.setLatLng(p.latlng)},_onKeyPress:function(p){p.originalEvent.keyCode===13&&this._openPopup(p)}});var H0=ll.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(p){ll.prototype.onAdd.call(this,p),this.setOpacity(this.options.opacity),p.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(p){ll.prototype.onRemove.call(this,p),p.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var p=ll.prototype.getEvents.call(this);return this.options.permanent||(p.preclick=this.close),p},_initLayout:function(){var p="leaflet-tooltip",j=p+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Wt("div",j),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(p){var j,P,$=this._map,W=this._container,re=$.latLngToContainerPoint($.getCenter()),be=$.layerPointToContainerPoint(p),Be=this.options.direction,He=W.offsetWidth,ut=W.offsetHeight,zt=Z(this.options.offset),vr=this._getAnchor();Be==="top"?(j=He/2,P=ut):Be==="bottom"?(j=He/2,P=0):Be==="center"?(j=He/2,P=ut/2):Be==="right"?(j=0,P=ut/2):Be==="left"?(j=He,P=ut/2):be.x<re.x?(Be="right",j=0,P=ut/2):(Be="left",j=He+(zt.x+vr.x)*2,P=ut/2),p=p.subtract(Z(j,P,!0)).add(zt).add(vr),cr(W,"leaflet-tooltip-right"),cr(W,"leaflet-tooltip-left"),cr(W,"leaflet-tooltip-top"),cr(W,"leaflet-tooltip-bottom"),Ht(W,"leaflet-tooltip-"+Be),Br(W,p)},_updatePosition:function(){var p=this._map.latLngToLayerPoint(this._latlng);this._setPosition(p)},setOpacity:function(p){this.options.opacity=p,this._container&&is(this._container,p)},_animateZoom:function(p){var j=this._map._latLngToNewLayerPoint(this._latlng,p.zoom,p.center);this._setPosition(j)},_getAnchor:function(){return Z(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),qK=function(p,j){return new H0(p,j)};nn.include({openTooltip:function(p,j,P){return this._initOverlay(H0,p,j,P).openOn(this),this},closeTooltip:function(p){return p.close(),this}}),xo.include({bindTooltip:function(p,j){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(H0,this._tooltip,p,j),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(p){if(!(!p&&this._tooltipHandlersAdded)){var j=p?"off":"on",P={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?P.add=this._openTooltip:(P.mouseover=this._openTooltip,P.mouseout=this.closeTooltip,P.click=this._openTooltip,this._map?this._addFocusListeners():P.add=this._addFocusListeners),this._tooltip.options.sticky&&(P.mousemove=this._moveTooltip),this[j](P),this._tooltipHandlersAdded=!p}},openTooltip:function(p){return this._tooltip&&(this instanceof Zl||(this._tooltip._source=this),this._tooltip._prepareOpen(p)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(p){return this._tooltip&&this._tooltip.setContent(p),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(p){var j=typeof p.getElement=="function"&&p.getElement();j&&(jr(j,"focus",function(){this._tooltip._source=p,this.openTooltip()},this),jr(j,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(p){var j=typeof p.getElement=="function"&&p.getElement();j&&j.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(p){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var j=this;this._map.once("moveend",function(){j._openOnceFlag=!1,j._openTooltip(p)});return}this._tooltip._source=p.layer||p.target,this.openTooltip(this._tooltip.options.sticky?p.latlng:void 0)}},_moveTooltip:function(p){var j=p.latlng,P,$;this._tooltip.options.sticky&&p.originalEvent&&(P=this._map.mouseEventToContainerPoint(p.originalEvent),$=this._map.containerPointToLayerPoint(P),j=this._map.layerPointToLatLng($)),this._tooltip.setLatLng(j)}});var Z5=Vf.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(p){var j=p&&p.tagName==="DIV"?p:document.createElement("div"),P=this.options;if(P.html instanceof Element?(yn(j),j.appendChild(P.html)):j.innerHTML=P.html!==!1?P.html:"",P.bgPos){var $=Z(P.bgPos);j.style.backgroundPosition=-$.x+"px "+-$.y+"px"}return this._setIconStyles(j,"icon"),j},createShadow:function(){return null}});function VK(p){return new Z5(p)}Vf.Default=Kp;var Zp=xo.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ne.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(p){g(this,p)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(p){p._addZoomLimit(this)},onRemove:function(p){this._removeAllTiles(),Sr(this._container),p._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(nr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Cr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(p){return this.options.opacity=p,this._updateOpacity(),this},setZIndex:function(p){return this.options.zIndex=p,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var p=this._clampZoom(this._map.getZoom());p!==this._tileZoom&&(this._tileZoom=p,this._updateLevels()),this._update()}return this},getEvents:function(){var p={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),p.move=this._onMove),this._zoomAnimated&&(p.zoomanim=this._animateZoom),p},createTile:function(){return document.createElement("div")},getTileSize:function(){var p=this.options.tileSize;return p instanceof q?p:new q(p,p)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(p){for(var j=this.getPane().children,P=-p(-1/0,1/0),$=0,W=j.length,re;$<W;$++)re=j[$].style.zIndex,j[$]!==this._container&&re&&(P=p(P,+re));isFinite(P)&&(this.options.zIndex=P+p(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ne.ielt9){is(this._container,this.options.opacity);var p=+new Date,j=!1,P=!1;for(var $ in this._tiles){var W=this._tiles[$];if(!(!W.current||!W.loaded)){var re=Math.min(1,(p-W.loaded)/200);is(W.el,re),re<1?j=!0:(W.active?P=!0:this._onOpaqueTile(W),W.active=!0)}}P&&!this._noPrune&&this._pruneTiles(),j&&(z(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this))}},_onOpaqueTile:u,_initContainer:function(){this._container||(this._container=Wt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var p=this._tileZoom,j=this.options.maxZoom;if(p!==void 0){for(var P in this._levels)P=Number(P),this._levels[P].el.children.length||P===p?(this._levels[P].el.style.zIndex=j-Math.abs(p-P),this._onUpdateLevel(P)):(Sr(this._levels[P].el),this._removeTilesAtZoom(P),this._onRemoveLevel(P),delete this._levels[P]);var $=this._levels[p],W=this._map;return $||($=this._levels[p]={},$.el=Wt("div","leaflet-tile-container leaflet-zoom-animated",this._container),$.el.style.zIndex=j,$.origin=W.project(W.unproject(W.getPixelOrigin()),p).round(),$.zoom=p,this._setZoomTransform($,W.getCenter(),W.getZoom()),u($.el.offsetWidth),this._onCreateLevel($)),this._level=$,$}},_onUpdateLevel:u,_onRemoveLevel:u,_onCreateLevel:u,_pruneTiles:function(){if(this._map){var p,j,P=this._map.getZoom();if(P>this.options.maxZoom||P<this.options.minZoom){this._removeAllTiles();return}for(p in this._tiles)j=this._tiles[p],j.retain=j.current;for(p in this._tiles)if(j=this._tiles[p],j.current&&!j.active){var $=j.coords;this._retainParent($.x,$.y,$.z,$.z-5)||this._retainChildren($.x,$.y,$.z,$.z+2)}for(p in this._tiles)this._tiles[p].retain||this._removeTile(p)}},_removeTilesAtZoom:function(p){for(var j in this._tiles)this._tiles[j].coords.z===p&&this._removeTile(j)},_removeAllTiles:function(){for(var p in this._tiles)this._removeTile(p)},_invalidateAll:function(){for(var p in this._levels)Sr(this._levels[p].el),this._onRemoveLevel(Number(p)),delete this._levels[p];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(p,j,P,$){var W=Math.floor(p/2),re=Math.floor(j/2),be=P-1,Be=new q(+W,+re);Be.z=+be;var He=this._tileCoordsToKey(Be),ut=this._tiles[He];return ut&&ut.active?(ut.retain=!0,!0):(ut&&ut.loaded&&(ut.retain=!0),be>$?this._retainParent(W,re,be,$):!1)},_retainChildren:function(p,j,P,$){for(var W=2*p;W<2*p+2;W++)for(var re=2*j;re<2*j+2;re++){var be=new q(W,re);be.z=P+1;var Be=this._tileCoordsToKey(be),He=this._tiles[Be];if(He&&He.active){He.retain=!0;continue}else He&&He.loaded&&(He.retain=!0);P+1<$&&this._retainChildren(W,re,P+1,$)}},_resetView:function(p){var j=p&&(p.pinch||p.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),j,j)},_animateZoom:function(p){this._setView(p.center,p.zoom,!0,p.noUpdate)},_clampZoom:function(p){var j=this.options;return j.minNativeZoom!==void 0&&p<j.minNativeZoom?j.minNativeZoom:j.maxNativeZoom!==void 0&&j.maxNativeZoom<p?j.maxNativeZoom:p},_setView:function(p,j,P,$){var W=Math.round(j);this.options.maxZoom!==void 0&&W>this.options.maxZoom||this.options.minZoom!==void 0&&W<this.options.minZoom?W=void 0:W=this._clampZoom(W);var re=this.options.updateWhenZooming&&W!==this._tileZoom;(!$||re)&&(this._tileZoom=W,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),W!==void 0&&this._update(p),P||this._pruneTiles(),this._noPrune=!!P),this._setZoomTransforms(p,j)},_setZoomTransforms:function(p,j){for(var P in this._levels)this._setZoomTransform(this._levels[P],p,j)},_setZoomTransform:function(p,j,P){var $=this._map.getZoomScale(P,p.zoom),W=p.origin.multiplyBy($).subtract(this._map._getNewPixelOrigin(j,P)).round();Ne.any3d?An(p.el,W,$):Br(p.el,W)},_resetGrid:function(){var p=this._map,j=p.options.crs,P=this._tileSize=this.getTileSize(),$=this._tileZoom,W=this._map.getPixelWorldBounds(this._tileZoom);W&&(this._globalTileRange=this._pxBoundsToTileRange(W)),this._wrapX=j.wrapLng&&!this.options.noWrap&&[Math.floor(p.project([0,j.wrapLng[0]],$).x/P.x),Math.ceil(p.project([0,j.wrapLng[1]],$).x/P.y)],this._wrapY=j.wrapLat&&!this.options.noWrap&&[Math.floor(p.project([j.wrapLat[0],0],$).y/P.x),Math.ceil(p.project([j.wrapLat[1],0],$).y/P.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(p){var j=this._map,P=j._animatingZoom?Math.max(j._animateToZoom,j.getZoom()):j.getZoom(),$=j.getZoomScale(P,this._tileZoom),W=j.project(p,this._tileZoom).floor(),re=j.getSize().divideBy($*2);return new ne(W.subtract(re),W.add(re))},_update:function(p){var j=this._map;if(j){var P=this._clampZoom(j.getZoom());if(p===void 0&&(p=j.getCenter()),this._tileZoom!==void 0){var $=this._getTiledPixelBounds(p),W=this._pxBoundsToTileRange($),re=W.getCenter(),be=[],Be=this.options.keepBuffer,He=new ne(W.getBottomLeft().subtract([Be,-Be]),W.getTopRight().add([Be,-Be]));if(!(isFinite(W.min.x)&&isFinite(W.min.y)&&isFinite(W.max.x)&&isFinite(W.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ut in this._tiles){var zt=this._tiles[ut].coords;(zt.z!==this._tileZoom||!He.contains(new q(zt.x,zt.y)))&&(this._tiles[ut].current=!1)}if(Math.abs(P-this._tileZoom)>1){this._setView(p,P);return}for(var vr=W.min.y;vr<=W.max.y;vr++)for(var Xr=W.min.x;Xr<=W.max.x;Xr++){var La=new q(Xr,vr);if(La.z=this._tileZoom,!!this._isValidTile(La)){var Xs=this._tiles[this._tileCoordsToKey(La)];Xs?Xs.current=!0:be.push(La)}}if(be.sort(function(ri,Yf){return ri.distanceTo(re)-Yf.distanceTo(re)}),be.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Bi=document.createDocumentFragment();for(Xr=0;Xr<be.length;Xr++)this._addTile(be[Xr],Bi);this._level.el.appendChild(Bi)}}}},_isValidTile:function(p){var j=this._map.options.crs;if(!j.infinite){var P=this._globalTileRange;if(!j.wrapLng&&(p.x<P.min.x||p.x>P.max.x)||!j.wrapLat&&(p.y<P.min.y||p.y>P.max.y))return!1}if(!this.options.bounds)return!0;var $=this._tileCoordsToBounds(p);return se(this.options.bounds).overlaps($)},_keyToBounds:function(p){return this._tileCoordsToBounds(this._keyToTileCoords(p))},_tileCoordsToNwSe:function(p){var j=this._map,P=this.getTileSize(),$=p.scaleBy(P),W=$.add(P),re=j.unproject($,p.z),be=j.unproject(W,p.z);return[re,be]},_tileCoordsToBounds:function(p){var j=this._tileCoordsToNwSe(p),P=new X(j[0],j[1]);return this.options.noWrap||(P=this._map.wrapLatLngBounds(P)),P},_tileCoordsToKey:function(p){return p.x+":"+p.y+":"+p.z},_keyToTileCoords:function(p){var j=p.split(":"),P=new q(+j[0],+j[1]);return P.z=+j[2],P},_removeTile:function(p){var j=this._tiles[p];j&&(Sr(j.el),delete this._tiles[p],this.fire("tileunload",{tile:j.el,coords:this._keyToTileCoords(p)}))},_initTile:function(p){Ht(p,"leaflet-tile");var j=this.getTileSize();p.style.width=j.x+"px",p.style.height=j.y+"px",p.onselectstart=u,p.onmousemove=u,Ne.ielt9&&this.options.opacity<1&&is(p,this.options.opacity)},_addTile:function(p,j){var P=this._getTilePos(p),$=this._tileCoordsToKey(p),W=this.createTile(this._wrapCoords(p),o(this._tileReady,this,p));this._initTile(W),this.createTile.length<2&&O(o(this._tileReady,this,p,null,W)),Br(W,P),this._tiles[$]={el:W,coords:p,current:!0},j.appendChild(W),this.fire("tileloadstart",{tile:W,coords:p})},_tileReady:function(p,j,P){j&&this.fire("tileerror",{error:j,tile:P,coords:p});var $=this._tileCoordsToKey(p);P=this._tiles[$],P&&(P.loaded=+new Date,this._map._fadeAnimated?(is(P.el,0),z(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this)):(P.active=!0,this._pruneTiles()),j||(Ht(P.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:P.el,coords:p})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ne.ielt9||!this._map._fadeAnimated?O(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(p){return p.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(p){var j=new q(this._wrapX?f(p.x,this._wrapX):p.x,this._wrapY?f(p.y,this._wrapY):p.y);return j.z=p.z,j},_pxBoundsToTileRange:function(p){var j=this.getTileSize();return new ne(p.min.unscaleBy(j).floor(),p.max.unscaleBy(j).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var p in this._tiles)if(!this._tiles[p].loaded)return!1;return!0}});function WK(p){return new Zp(p)}var Gf=Zp.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(p,j){this._url=p,j=g(this,j),j.detectRetina&&Ne.retina&&j.maxZoom>0?(j.tileSize=Math.floor(j.tileSize/2),j.zoomReverse?(j.zoomOffset--,j.minZoom=Math.min(j.maxZoom,j.minZoom+1)):(j.zoomOffset++,j.maxZoom=Math.max(j.minZoom,j.maxZoom-1)),j.minZoom=Math.max(0,j.minZoom)):j.zoomReverse?j.minZoom=Math.min(j.maxZoom,j.minZoom):j.maxZoom=Math.max(j.minZoom,j.maxZoom),typeof j.subdomains=="string"&&(j.subdomains=j.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(p,j){return this._url===p&&j===void 0&&(j=!0),this._url=p,j||this.redraw(),this},createTile:function(p,j){var P=document.createElement("img");return jr(P,"load",o(this._tileOnLoad,this,j,P)),jr(P,"error",o(this._tileOnError,this,j,P)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(P.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(P.referrerPolicy=this.options.referrerPolicy),P.alt="",P.src=this.getTileUrl(p),P},getTileUrl:function(p){var j={r:Ne.retina?"@2x":"",s:this._getSubdomain(p),x:p.x,y:p.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var P=this._globalTileRange.max.y-p.y;this.options.tms&&(j.y=P),j["-y"]=P}return w(this._url,a(j,this.options))},_tileOnLoad:function(p,j){Ne.ielt9?setTimeout(o(p,this,null,j),0):p(null,j)},_tileOnError:function(p,j,P){var $=this.options.errorTileUrl;$&&j.getAttribute("src")!==$&&(j.src=$),p(P,j)},_onTileRemove:function(p){p.tile.onload=null},_getZoomForUrl:function(){var p=this._tileZoom,j=this.options.maxZoom,P=this.options.zoomReverse,$=this.options.zoomOffset;return P&&(p=j-p),p+$},_getSubdomain:function(p){var j=Math.abs(p.x+p.y)%this.options.subdomains.length;return this.options.subdomains[j]},_abortLoading:function(){var p,j;for(p in this._tiles)if(this._tiles[p].coords.z!==this._tileZoom&&(j=this._tiles[p].el,j.onload=u,j.onerror=u,!j.complete)){j.src=S;var P=this._tiles[p].coords;Sr(j),delete this._tiles[p],this.fire("tileabort",{tile:j,coords:P})}},_removeTile:function(p){var j=this._tiles[p];if(j)return j.el.setAttribute("src",S),Zp.prototype._removeTile.call(this,p)},_tileReady:function(p,j,P){if(!(!this._map||P&&P.getAttribute("src")===S))return Zp.prototype._tileReady.call(this,p,j,P)}});function X5(p,j){return new Gf(p,j)}var J5=Gf.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(p,j){this._url=p;var P=a({},this.defaultWmsParams);for(var $ in j)$ in this.options||(P[$]=j[$]);j=g(this,j);var W=j.detectRetina&&Ne.retina?2:1,re=this.getTileSize();P.width=re.x*W,P.height=re.y*W,this.wmsParams=P},onAdd:function(p){this._crs=this.options.crs||p.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var j=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[j]=this._crs.code,Gf.prototype.onAdd.call(this,p)},getTileUrl:function(p){var j=this._tileCoordsToNwSe(p),P=this._crs,$=Y(P.project(j[0]),P.project(j[1])),W=$.min,re=$.max,be=(this._wmsVersion>=1.3&&this._crs===V5?[W.y,W.x,re.y,re.x]:[W.x,W.y,re.x,re.y]).join(","),Be=Gf.prototype.getTileUrl.call(this,p);return Be+x(this.wmsParams,Be,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+be},setParams:function(p,j){return a(this.wmsParams,p),j||this.redraw(),this}});function HK(p,j){return new J5(p,j)}Gf.WMS=J5,X5.wms=HK;var Ql=xo.extend({options:{padding:.1},initialize:function(p){g(this,p),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ht(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var p={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(p.zoomanim=this._onAnimZoom),p},_onAnimZoom:function(p){this._updateTransform(p.center,p.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(p,j){var P=this._map.getZoomScale(j,this._zoom),$=this._map.getSize().multiplyBy(.5+this.options.padding),W=this._map.project(this._center,j),re=$.multiplyBy(-P).add(W).subtract(this._map._getNewPixelOrigin(p,j));Ne.any3d?An(this._container,re,P):Br(this._container,re)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var p in this._layers)this._layers[p]._reset()},_onZoomEnd:function(){for(var p in this._layers)this._layers[p]._project()},_updatePaths:function(){for(var p in this._layers)this._layers[p]._update()},_update:function(){var p=this.options.padding,j=this._map.getSize(),P=this._map.containerPointToLayerPoint(j.multiplyBy(-p)).round();this._bounds=new ne(P,P.add(j.multiplyBy(1+p*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Q5=Ql.extend({options:{tolerance:0},getEvents:function(){var p=Ql.prototype.getEvents.call(this);return p.viewprereset=this._onViewPreReset,p},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ql.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var p=this._container=document.createElement("canvas");jr(p,"mousemove",this._onMouseMove,this),jr(p,"click dblclick mousedown mouseup contextmenu",this._onClick,this),jr(p,"mouseout",this._handleMouseOut,this),p._leaflet_disable_events=!0,this._ctx=p.getContext("2d")},_destroyContainer:function(){z(this._redrawRequest),delete this._ctx,Sr(this._container),pn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var p;this._redrawBounds=null;for(var j in this._layers)p=this._layers[j],p._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ql.prototype._update.call(this);var p=this._bounds,j=this._container,P=p.getSize(),$=Ne.retina?2:1;Br(j,p.min),j.width=$*P.x,j.height=$*P.y,j.style.width=P.x+"px",j.style.height=P.y+"px",Ne.retina&&this._ctx.scale(2,2),this._ctx.translate(-p.min.x,-p.min.y),this.fire("update")}},_reset:function(){Ql.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(p){this._updateDashArray(p),this._layers[c(p)]=p;var j=p._order={layer:p,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=j),this._drawLast=j,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(p){this._requestRedraw(p)},_removePath:function(p){var j=p._order,P=j.next,$=j.prev;P?P.prev=$:this._drawLast=$,$?$.next=P:this._drawFirst=P,delete p._order,delete this._layers[c(p)],this._requestRedraw(p)},_updatePath:function(p){this._extendRedrawBounds(p),p._project(),p._update(),this._requestRedraw(p)},_updateStyle:function(p){this._updateDashArray(p),this._requestRedraw(p)},_updateDashArray:function(p){if(typeof p.options.dashArray=="string"){var j=p.options.dashArray.split(/[, ]+/),P=[],$,W;for(W=0;W<j.length;W++){if($=Number(j[W]),isNaN($))return;P.push($)}p.options._dashArray=P}else p.options._dashArray=p.options.dashArray},_requestRedraw:function(p){this._map&&(this._extendRedrawBounds(p),this._redrawRequest=this._redrawRequest||O(this._redraw,this))},_extendRedrawBounds:function(p){if(p._pxBounds){var j=(p.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ne,this._redrawBounds.extend(p._pxBounds.min.subtract([j,j])),this._redrawBounds.extend(p._pxBounds.max.add([j,j]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var p=this._redrawBounds;if(p){var j=p.getSize();this._ctx.clearRect(p.min.x,p.min.y,j.x,j.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var p,j=this._redrawBounds;if(this._ctx.save(),j){var P=j.getSize();this._ctx.beginPath(),this._ctx.rect(j.min.x,j.min.y,P.x,P.y),this._ctx.clip()}this._drawing=!0;for(var $=this._drawFirst;$;$=$.next)p=$.layer,(!j||p._pxBounds&&p._pxBounds.intersects(j))&&p._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(p,j){if(this._drawing){var P,$,W,re,be=p._parts,Be=be.length,He=this._ctx;if(Be){for(He.beginPath(),P=0;P<Be;P++){for($=0,W=be[P].length;$<W;$++)re=be[P][$],He[$?"lineTo":"moveTo"](re.x,re.y);j&&He.closePath()}this._fillStroke(He,p)}}},_updateCircle:function(p){if(!(!this._drawing||p._empty())){var j=p._point,P=this._ctx,$=Math.max(Math.round(p._radius),1),W=(Math.max(Math.round(p._radiusY),1)||$)/$;W!==1&&(P.save(),P.scale(1,W)),P.beginPath(),P.arc(j.x,j.y/W,$,0,Math.PI*2,!1),W!==1&&P.restore(),this._fillStroke(P,p)}},_fillStroke:function(p,j){var P=j.options;P.fill&&(p.globalAlpha=P.fillOpacity,p.fillStyle=P.fillColor||P.color,p.fill(P.fillRule||"evenodd")),P.stroke&&P.weight!==0&&(p.setLineDash&&p.setLineDash(j.options&&j.options._dashArray||[]),p.globalAlpha=P.opacity,p.lineWidth=P.weight,p.strokeStyle=P.color,p.lineCap=P.lineCap,p.lineJoin=P.lineJoin,p.stroke())},_onClick:function(p){for(var j=this._map.mouseEventToLayerPoint(p),P,$,W=this._drawFirst;W;W=W.next)P=W.layer,P.options.interactive&&P._containsPoint(j)&&(!(p.type==="click"||p.type==="preclick")||!this._map._draggableMoved(P))&&($=P);this._fireEvent($?[$]:!1,p)},_onMouseMove:function(p){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var j=this._map.mouseEventToLayerPoint(p);this._handleMouseHover(p,j)}},_handleMouseOut:function(p){var j=this._hoveredLayer;j&&(cr(this._container,"leaflet-interactive"),this._fireEvent([j],p,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(p,j){if(!this._mouseHoverThrottled){for(var P,$,W=this._drawFirst;W;W=W.next)P=W.layer,P.options.interactive&&P._containsPoint(j)&&($=P);$!==this._hoveredLayer&&(this._handleMouseOut(p),$&&(Ht(this._container,"leaflet-interactive"),this._fireEvent([$],p,"mouseover"),this._hoveredLayer=$)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,p),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(p,j,P){this._map._fireDOMEvent(j,P||j.type,p)},_bringToFront:function(p){var j=p._order;if(j){var P=j.next,$=j.prev;if(P)P.prev=$;else return;$?$.next=P:P&&(this._drawFirst=P),j.prev=this._drawLast,this._drawLast.next=j,j.next=null,this._drawLast=j,this._requestRedraw(p)}},_bringToBack:function(p){var j=p._order;if(j){var P=j.next,$=j.prev;if($)$.next=P;else return;P?P.prev=$:$&&(this._drawLast=$),j.prev=null,j.next=this._drawFirst,this._drawFirst.prev=j,this._drawFirst=j,this._requestRedraw(p)}}});function eR(p){return Ne.canvas?new Q5(p):null}var Xp=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(p){return document.createElement("<lvml:"+p+' class="lvml">')}}catch(p){}return function(p){return document.createElement("<"+p+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),GK={_initContainer:function(){this._container=Wt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ql.prototype._update.call(this),this.fire("update"))},_initPath:function(p){var j=p._container=Xp("shape");Ht(j,"leaflet-vml-shape "+(this.options.className||"")),j.coordsize="1 1",p._path=Xp("path"),j.appendChild(p._path),this._updateStyle(p),this._layers[c(p)]=p},_addPath:function(p){var j=p._container;this._container.appendChild(j),p.options.interactive&&p.addInteractiveTarget(j)},_removePath:function(p){var j=p._container;Sr(j),p.removeInteractiveTarget(j),delete this._layers[c(p)]},_updateStyle:function(p){var j=p._stroke,P=p._fill,$=p.options,W=p._container;W.stroked=!!$.stroke,W.filled=!!$.fill,$.stroke?(j||(j=p._stroke=Xp("stroke")),W.appendChild(j),j.weight=$.weight+"px",j.color=$.color,j.opacity=$.opacity,$.dashArray?j.dashStyle=b($.dashArray)?$.dashArray.join(" "):$.dashArray.replace(/( *, *)/g," "):j.dashStyle="",j.endcap=$.lineCap.replace("butt","flat"),j.joinstyle=$.lineJoin):j&&(W.removeChild(j),p._stroke=null),$.fill?(P||(P=p._fill=Xp("fill")),W.appendChild(P),P.color=$.fillColor||$.color,P.opacity=$.fillOpacity):P&&(W.removeChild(P),p._fill=null)},_updateCircle:function(p){var j=p._point.round(),P=Math.round(p._radius),$=Math.round(p._radiusY||P);this._setPath(p,p._empty()?"M0 0":"AL "+j.x+","+j.y+" "+P+","+$+" 0,"+65535*360)},_setPath:function(p,j){p._path.v=j},_bringToFront:function(p){nr(p._container)},_bringToBack:function(p){Cr(p._container)}},G0=Ne.vml?Xp:fe,Jp=Ql.extend({_initContainer:function(){this._container=G0("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=G0("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Sr(this._container),pn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ql.prototype._update.call(this);var p=this._bounds,j=p.getSize(),P=this._container;(!this._svgSize||!this._svgSize.equals(j))&&(this._svgSize=j,P.setAttribute("width",j.x),P.setAttribute("height",j.y)),Br(P,p.min),P.setAttribute("viewBox",[p.min.x,p.min.y,j.x,j.y].join(" ")),this.fire("update")}},_initPath:function(p){var j=p._path=G0("path");p.options.className&&Ht(j,p.options.className),p.options.interactive&&Ht(j,"leaflet-interactive"),this._updateStyle(p),this._layers[c(p)]=p},_addPath:function(p){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(p._path),p.addInteractiveTarget(p._path)},_removePath:function(p){Sr(p._path),p.removeInteractiveTarget(p._path),delete this._layers[c(p)]},_updatePath:function(p){p._project(),p._update()},_updateStyle:function(p){var j=p._path,P=p.options;j&&(P.stroke?(j.setAttribute("stroke",P.color),j.setAttribute("stroke-opacity",P.opacity),j.setAttribute("stroke-width",P.weight),j.setAttribute("stroke-linecap",P.lineCap),j.setAttribute("stroke-linejoin",P.lineJoin),P.dashArray?j.setAttribute("stroke-dasharray",P.dashArray):j.removeAttribute("stroke-dasharray"),P.dashOffset?j.setAttribute("stroke-dashoffset",P.dashOffset):j.removeAttribute("stroke-dashoffset")):j.setAttribute("stroke","none"),P.fill?(j.setAttribute("fill",P.fillColor||P.color),j.setAttribute("fill-opacity",P.fillOpacity),j.setAttribute("fill-rule",P.fillRule||"evenodd")):j.setAttribute("fill","none"))},_updatePoly:function(p,j){this._setPath(p,we(p._parts,j))},_updateCircle:function(p){var j=p._point,P=Math.max(Math.round(p._radius),1),$=Math.max(Math.round(p._radiusY),1)||P,W="a"+P+","+$+" 0 1,0 ",re=p._empty()?"M0 0":"M"+(j.x-P)+","+j.y+W+P*2+",0 "+W+-P*2+",0 ";this._setPath(p,re)},_setPath:function(p,j){p._path.setAttribute("d",j)},_bringToFront:function(p){nr(p._path)},_bringToBack:function(p){Cr(p._path)}});Ne.vml&&Jp.include(GK);function tR(p){return Ne.svg||Ne.vml?new Jp(p):null}nn.include({getRenderer:function(p){var j=p.options.renderer||this._getPaneRenderer(p.options.pane)||this.options.renderer||this._renderer;return j||(j=this._renderer=this._createRenderer()),this.hasLayer(j)||this.addLayer(j),j},_getPaneRenderer:function(p){if(p==="overlayPane"||p===void 0)return!1;var j=this._paneRenderers[p];return j===void 0&&(j=this._createRenderer({pane:p}),this._paneRenderers[p]=j),j},_createRenderer:function(p){return this.options.preferCanvas&&eR(p)||tR(p)}});var rR=Wf.extend({initialize:function(p,j){Wf.prototype.initialize.call(this,this._boundsToLatLngs(p),j)},setBounds:function(p){return this.setLatLngs(this._boundsToLatLngs(p))},_boundsToLatLngs:function(p){return p=se(p),[p.getSouthWest(),p.getNorthWest(),p.getNorthEast(),p.getSouthEast()]}});function YK(p,j){return new rR(p,j)}Jp.create=G0,Jp.pointsToPath=we,Jl.geometryToLayer=z0,Jl.coordsToLatLng=Hj,Jl.coordsToLatLngs=B0,Jl.latLngToCoords=Gj,Jl.latLngsToCoords=U0,Jl.getFeature=Hf,Jl.asFeature=q0,nn.mergeOptions({boxZoom:!0});var nR=kt.extend({initialize:function(p){this._map=p,this._container=p._container,this._pane=p._panes.overlayPane,this._resetStateTimeout=0,p.on("unload",this._destroy,this)},addHooks:function(){jr(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){pn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Sr(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(p){if(!p.shiftKey||p.which!==1&&p.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),la(),Mr(),this._startPoint=this._map.mouseEventToContainerPoint(p),jr(document,{contextmenu:Kl,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(p){this._moved||(this._moved=!0,this._box=Wt("div","leaflet-zoom-box",this._container),Ht(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(p);var j=new ne(this._point,this._startPoint),P=j.getSize();Br(this._box,j.min),this._box.style.width=P.x+"px",this._box.style.height=P.y+"px"},_finish:function(){this._moved&&(Sr(this._box),cr(this._container,"leaflet-crosshair")),Da(),un(),pn(document,{contextmenu:Kl,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(p){if(!(p.which!==1&&p.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var j=new X(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(j).fire("boxzoomend",{boxZoomBounds:j})}},_onKeyDown:function(p){p.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});nn.addInitHook("addHandler","boxZoom",nR),nn.mergeOptions({doubleClickZoom:!0});var sR=kt.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(p){var j=this._map,P=j.getZoom(),$=j.options.zoomDelta,W=p.originalEvent.shiftKey?P-$:P+$;j.options.doubleClickZoom==="center"?j.setZoom(W):j.setZoomAround(p.containerPoint,W)}});nn.addInitHook("addHandler","doubleClickZoom",sR),nn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var aR=kt.extend({addHooks:function(){if(!this._draggable){var p=this._map;this._draggable=new pr(p._mapPane,p._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),p.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),p.on("zoomend",this._onZoomEnd,this),p.whenReady(this._onZoomEnd,this))}Ht(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){cr(this._map._container,"leaflet-grab"),cr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var p=this._map;if(p._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var j=se(this._map.options.maxBounds);this._offsetLimit=Y(this._map.latLngToContainerPoint(j.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(j.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;p.fire("movestart").fire("dragstart"),p.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(p){if(this._map.options.inertia){var j=this._lastTime=+new Date,P=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(P),this._times.push(j),this._prunePositions(j)}this._map.fire("move",p).fire("drag",p)},_prunePositions:function(p){for(;this._positions.length>1&&p-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var p=this._map.getSize().divideBy(2),j=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=j.subtract(p).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(p,j){return p-(p-j)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var p=this._draggable._newPos.subtract(this._draggable._startPos),j=this._offsetLimit;p.x<j.min.x&&(p.x=this._viscousLimit(p.x,j.min.x)),p.y<j.min.y&&(p.y=this._viscousLimit(p.y,j.min.y)),p.x>j.max.x&&(p.x=this._viscousLimit(p.x,j.max.x)),p.y>j.max.y&&(p.y=this._viscousLimit(p.y,j.max.y)),this._draggable._newPos=this._draggable._startPos.add(p)}},_onPreDragWrap:function(){var p=this._worldWidth,j=Math.round(p/2),P=this._initialWorldOffset,$=this._draggable._newPos.x,W=($-j+P)%p+j-P,re=($+j+P)%p-j-P,be=Math.abs(W+P)<Math.abs(re+P)?W:re;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=be},_onDragEnd:function(p){var j=this._map,P=j.options,$=!P.inertia||p.noInertia||this._times.length<2;if(j.fire("dragend",p),$)j.fire("moveend");else{this._prunePositions(+new Date);var W=this._lastPos.subtract(this._positions[0]),re=(this._lastTime-this._times[0])/1e3,be=P.easeLinearity,Be=W.multiplyBy(be/re),He=Be.distanceTo([0,0]),ut=Math.min(P.inertiaMaxSpeed,He),zt=Be.multiplyBy(ut/He),vr=ut/(P.inertiaDeceleration*be),Xr=zt.multiplyBy(-vr/2).round();!Xr.x&&!Xr.y?j.fire("moveend"):(Xr=j._limitOffset(Xr,j.options.maxBounds),O(function(){j.panBy(Xr,{duration:vr,easeLinearity:be,noMoveStart:!0,animate:!0})}))}}});nn.addInitHook("addHandler","dragging",aR),nn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var iR=kt.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(p){this._map=p,this._setPanDelta(p.options.keyboardPanDelta),this._setZoomDelta(p.options.zoomDelta)},addHooks:function(){var p=this._map._container;p.tabIndex<=0&&(p.tabIndex="0"),jr(p,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),pn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var p=document.body,j=document.documentElement,P=p.scrollTop||j.scrollTop,$=p.scrollLeft||j.scrollLeft;this._map._container.focus(),window.scrollTo($,P)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(p){var j=this._panKeys={},P=this.keyCodes,$,W;for($=0,W=P.left.length;$<W;$++)j[P.left[$]]=[-1*p,0];for($=0,W=P.right.length;$<W;$++)j[P.right[$]]=[p,0];for($=0,W=P.down.length;$<W;$++)j[P.down[$]]=[0,p];for($=0,W=P.up.length;$<W;$++)j[P.up[$]]=[0,-1*p]},_setZoomDelta:function(p){var j=this._zoomKeys={},P=this.keyCodes,$,W;for($=0,W=P.zoomIn.length;$<W;$++)j[P.zoomIn[$]]=p;for($=0,W=P.zoomOut.length;$<W;$++)j[P.zoomOut[$]]=-p},_addHooks:function(){jr(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){pn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(p){if(!(p.altKey||p.ctrlKey||p.metaKey)){var j=p.keyCode,P=this._map,$;if(j in this._panKeys){if(!P._panAnim||!P._panAnim._inProgress)if($=this._panKeys[j],p.shiftKey&&($=Z($).multiplyBy(3)),P.options.maxBounds&&($=P._limitOffset(Z($),P.options.maxBounds)),P.options.worldCopyJump){var W=P.wrapLatLng(P.unproject(P.project(P.getCenter()).add($)));P.panTo(W)}else P.panBy($)}else if(j in this._zoomKeys)P.setZoom(P.getZoom()+(p.shiftKey?3:1)*this._zoomKeys[j]);else if(j===27&&P._popup&&P._popup.options.closeOnEscapeKey)P.closePopup();else return;Kl(p)}}});nn.addInitHook("addHandler","keyboard",iR),nn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var oR=kt.extend({addHooks:function(){jr(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){pn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(p){var j=A0(p),P=this._map.options.wheelDebounceTime;this._delta+=j,this._lastMousePos=this._map.mouseEventToContainerPoint(p),this._startTime||(this._startTime=+new Date);var $=Math.max(P-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),$),Kl(p)},_performZoom:function(){var p=this._map,j=p.getZoom(),P=this._map.options.zoomSnap||0;p._stop();var $=this._delta/(this._map.options.wheelPxPerZoomLevel*4),W=4*Math.log(2/(1+Math.exp(-Math.abs($))))/Math.LN2,re=P?Math.ceil(W/P)*P:W,be=p._limitZoom(j+(this._delta>0?re:-re))-j;this._delta=0,this._startTime=null,be&&(p.options.scrollWheelZoom==="center"?p.setZoom(j+be):p.setZoomAround(this._lastMousePos,j+be))}});nn.addInitHook("addHandler","scrollWheelZoom",oR);var KK=600;nn.mergeOptions({tapHold:Ne.touchNative&&Ne.safari&&Ne.mobile,tapTolerance:15});var lR=kt.extend({addHooks:function(){jr(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){pn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(p){if(clearTimeout(this._holdTimeout),p.touches.length===1){var j=p.touches[0];this._startPos=this._newPos=new q(j.clientX,j.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(jr(document,"touchend",rs),jr(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",j))},this),KK),jr(document,"touchend touchcancel contextmenu",this._cancel,this),jr(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function p(){pn(document,"touchend",rs),pn(document,"touchend touchcancel",p)},_cancel:function(){clearTimeout(this._holdTimeout),pn(document,"touchend touchcancel contextmenu",this._cancel,this),pn(document,"touchmove",this._onMove,this)},_onMove:function(p){var j=p.touches[0];this._newPos=new q(j.clientX,j.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(p,j){var P=new MouseEvent(p,{bubbles:!0,cancelable:!0,view:window,screenX:j.screenX,screenY:j.screenY,clientX:j.clientX,clientY:j.clientY});P._simulated=!0,j.target.dispatchEvent(P)}});nn.addInitHook("addHandler","tapHold",lR),nn.mergeOptions({touchZoom:Ne.touch,bounceAtZoomLimits:!0});var cR=kt.extend({addHooks:function(){Ht(this._map._container,"leaflet-touch-zoom"),jr(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){cr(this._map._container,"leaflet-touch-zoom"),pn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(p){var j=this._map;if(!(!p.touches||p.touches.length!==2||j._animatingZoom||this._zooming)){var P=j.mouseEventToContainerPoint(p.touches[0]),$=j.mouseEventToContainerPoint(p.touches[1]);this._centerPoint=j.getSize()._divideBy(2),this._startLatLng=j.containerPointToLatLng(this._centerPoint),j.options.touchZoom!=="center"&&(this._pinchStartLatLng=j.containerPointToLatLng(P.add($)._divideBy(2))),this._startDist=P.distanceTo($),this._startZoom=j.getZoom(),this._moved=!1,this._zooming=!0,j._stop(),jr(document,"touchmove",this._onTouchMove,this),jr(document,"touchend touchcancel",this._onTouchEnd,this),rs(p)}},_onTouchMove:function(p){if(!(!p.touches||p.touches.length!==2||!this._zooming)){var j=this._map,P=j.mouseEventToContainerPoint(p.touches[0]),$=j.mouseEventToContainerPoint(p.touches[1]),W=P.distanceTo($)/this._startDist;if(this._zoom=j.getScaleZoom(W,this._startZoom),!j.options.bounceAtZoomLimits&&(this._zoom<j.getMinZoom()&&W<1||this._zoom>j.getMaxZoom()&&W>1)&&(this._zoom=j._limitZoom(this._zoom)),j.options.touchZoom==="center"){if(this._center=this._startLatLng,W===1)return}else{var re=P._add($)._divideBy(2)._subtract(this._centerPoint);if(W===1&&re.x===0&&re.y===0)return;this._center=j.unproject(j.project(this._pinchStartLatLng,this._zoom).subtract(re),this._zoom)}this._moved||(j._moveStart(!0,!1),this._moved=!0),z(this._animRequest);var be=o(j._move,j,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=O(be,this,!0),rs(p)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,z(this._animRequest),pn(document,"touchmove",this._onTouchMove,this),pn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});nn.addInitHook("addHandler","touchZoom",cR),nn.BoxZoom=nR,nn.DoubleClickZoom=sR,nn.Drag=aR,nn.Keyboard=iR,nn.ScrollWheelZoom=oR,nn.TapHold=lR,nn.TouchZoom=cR,r.Bounds=ne,r.Browser=Ne,r.CRS=xe,r.Canvas=Q5,r.Circle=Wj,r.CircleMarker=F0,r.Class=B,r.Control=ti,r.DivIcon=Z5,r.DivOverlay=ll,r.DomEvent=R0,r.DomUtil=_a,r.Draggable=pr,r.Evented=H,r.FeatureGroup=Zl,r.GeoJSON=Jl,r.GridLayer=Zp,r.Handler=kt,r.Icon=Vf,r.ImageOverlay=V0,r.LatLng=de,r.LatLngBounds=X,r.Layer=xo,r.LayerGroup=qf,r.LineUtil=$0,r.Map=nn,r.Marker=L0,r.Mixin=$t,r.Path=Qc,r.Point=q,r.PolyUtil=Cs,r.Polygon=Wf,r.Polyline=Xl,r.Popup=W0,r.PosAnimation=Wp,r.Projection=EK,r.Rectangle=rR,r.Renderer=Ql,r.SVG=Jp,r.SVGOverlay=K5,r.TileLayer=Gf,r.Tooltip=H0,r.Transformation=ee,r.Util=M,r.VideoOverlay=Y5,r.bind=o,r.bounds=Y,r.canvas=eR,r.circle=DK,r.circleMarker=MK,r.control=Xc,r.divIcon=VK,r.extend=a,r.featureGroup=AK,r.geoJSON=G5,r.geoJson=LK,r.gridLayer=WK,r.icon=RK,r.imageOverlay=FK,r.latLng=_e,r.latLngBounds=se,r.layerGroup=TK,r.map=O0,r.marker=OK,r.point=Z,r.polygon=$K,r.polyline=IK,r.popup=UK,r.rectangle=YK,r.setOptions=g,r.stamp=c,r.svg=tR,r.svgOverlay=BK,r.tileLayer=X5,r.tooltip=qK,r.transformation=G,r.version=n,r.videoOverlay=zK;var ZK=window.L;r.noConflict=function(){return window.L=ZK,this},window.L=r})})(M2,M2.exports);var ya=M2.exports;const nU=wn(ya);function s0(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function M1(e,t){return t==null?function(n,a){const i=y.useRef();return i.current||(i.current=e(n,a)),i}:function(n,a){const i=y.useRef();i.current||(i.current=e(n,a));const o=y.useRef(n),{instance:l}=i.current;return y.useEffect(function(){o.current!==n&&(t(l,n,o.current),o.current=n)},[l,n,a]),i}}function sU(e,t){y.useEffect(function(){var a;return((a=t.layerContainer)!=null?a:t.map).addLayer(e.instance),function(){var o;(o=t.layerContainer)==null||o.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function aU(e){return function(r){const n=R1(),a=e(O1(r,n),n);return QB(n.map,r.attribution),WT(a.current,r.eventHandlers),sU(a.current,n),a}}function sfe(e,t){const r=y.useRef();y.useEffect(function(){var a;if(t.pathOptions!==r.current){const i=(a=t.pathOptions)!=null?a:{};e.instance.setStyle(i),r.current=i}},[e,t])}function afe(e){return function(r){const n=R1(),a=e(O1(r,n),n);return WT(a.current,r.eventHandlers),sU(a.current,n),sfe(a.current,r),a}}function ife(e,t){const r=M1(e,t),n=aU(r);return rU(n)}function ofe(e,t){const r=M1(e),n=nfe(r,t);return tfe(n)}function iU(e,t){const r=M1(e,t),n=afe(r);return rU(n)}function lfe(e,t){const r=M1(e,t),n=aU(r);return rfe(n)}function cfe(e,t,r){const{opacity:n,zIndex:a}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),a!=null&&a!==r.zIndex&&e.setZIndex(a)}function Rf(){return R1().map}const dfe=iU(function(i,a){var o=i,{center:t,children:r}=o,n=ge(o,["center","children"]);const l=new ya.Circle(t,n);return s0(l,VT(a,{overlayContainer:l}))},Jue);function D2(){return D2=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D2.apply(this,arguments)}function ufe(h,u){var m=h,{bounds:e,boundsOptions:t,center:r,children:n,className:a,id:i,placeholder:o,style:l,whenReady:c,zoom:d}=m,f=ge(m,["bounds","boundsOptions","center","children","className","id","placeholder","style","whenReady","zoom"]);const[v]=y.useState({className:a,id:i,style:l}),[g,x]=y.useState(null);y.useImperativeHandle(u,()=>{var b;return(b=g==null?void 0:g.map)!=null?b:null},[g]);const _=y.useCallback(b=>{if(b!==null&&g===null){const N=new ya.Map(b,f);r!=null&&d!=null?N.setView(r,d):e!=null&&N.fitBounds(e,t),c!=null&&N.whenReady(c),x(efe(N))}},[]);y.useEffect(()=>()=>{g==null||g.map.remove()},[g]);const w=g?te.createElement(tU,{value:g},n):o!=null?o:null;return te.createElement("div",D2({},v,{ref:_}),w)}const a0=y.forwardRef(ufe),gf=ife(function(a,n){var i=a,{position:t}=i,r=ge(i,["position"]);const o=new ya.Marker(t,r);return s0(o,VT(n,{overlayContainer:o}))},function(t,r,n){r.position!==n.position&&t.setLatLng(r.position),r.icon!=null&&r.icon!==n.icon&&t.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==n.zIndexOffset&&t.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==n.opacity&&t.setOpacity(r.opacity),t.dragging!=null&&r.draggable!==n.draggable&&(r.draggable===!0?t.dragging.enable():t.dragging.disable())}),oU=iU(function(a,n){var i=a,{positions:t}=i,r=ge(i,["positions"]);const o=new ya.Polyline(t,r);return s0(o,VT(n,{overlayContainer:o}))},function(t,r,n){r.positions!==n.positions&&t.setLatLngs(r.positions)}),lU=ofe(function(t,r){const n=new ya.Popup(t,r.overlayContainer);return s0(n,r)},function(t,r,{position:n},a){y.useEffect(function(){const{instance:o}=t;function l(d){d.popup===o&&(o.update(),a(!0))}function c(d){d.popup===o&&a(!1)}return r.map.on({popupopen:l,popupclose:c}),r.overlayContainer==null?(n!=null&&o.setLatLng(n),o.openOn(r.map)):r.overlayContainer.bindPopup(o),function(){var f;r.map.off({popupopen:l,popupclose:c}),(f=r.overlayContainer)==null||f.unbindPopup(),r.map.removeLayer(o)}},[t,r,a,n])}),i0=lfe(function(a,n){var i=a,{url:t}=i,r=ge(i,["url"]);const o=new ya.TileLayer(t,O1(r,n));return s0(o,n)},function(t,r,n){cfe(t,r,n);const{url:a}=r;a!=null&&a!==n.url&&t.setUrl(a)}),cU="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",dU="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",uU="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",ffe=e=>{const t=new Map;return e.forEach(r=>{if(!r.latitude||!r.longitude)return;const n=Number(r.latitude),a=Number(r.longitude);if(isNaN(n)||isNaN(a))return;const i=r.venue_id||`${r.venue_name}-${n}-${a}`;t.has(i)?t.get(i).events.push(r):t.set(i,{venueId:r.venue_id||i,venueName:r.venue_name||"Unknown Venue",venueAddress:r.venue_address||"",venueCity:r.venue_city||"",venueState:r.venue_state||"",latitude:n,longitude:a,events:[r]})}),t.forEach(r=>{r.events.sort((n,a)=>{const i=new Date(n.event_date),o=new Date(a.event_date);return i.getTime()-o.getTime()})}),Array.from(t.values())},hfe=new ya.Icon({iconUrl:dU,iconRetinaUrl:cU,shadowUrl:uU,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41],className:"brand-pink-marker"}),mfe=({center:e,zoom:t})=>{const r=Rf();return y.useEffect(()=>{r.setView(e,t)},[r,e,t]),null},pfe=({onMapMove:e})=>{const t=Rf();return y.useEffect(()=>{if(!e)return;const r=()=>{const n=t.getBounds();e({north:n.getNorth(),south:n.getSouth(),east:n.getEast(),west:n.getWest()})};return r(),t.on("moveend",r),t.on("zoomend",r),()=>{t.off("moveend",r),t.off("zoomend",r)}},[t,e]),null},HT=({center:e,zoom:t,events:r,onEventClick:n,onMapMove:a,showRadius:i=!1,radiusMiles:o=30,onVenueClick:l})=>{const c=y.useRef(null),d=r.filter(u=>{if(!u)return!1;const h=Number(u.latitude),m=Number(u.longitude);return u.latitude!=null&&u.longitude!=null&&!Number.isNaN(h)&&!Number.isNaN(m)}),f=ffe(d);return s.jsxs("div",{className:"w-full h-full",children:[s.jsx("style",{children:`
        .custom-scrollbar::-webkit-scrollbar {
          width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: #f1f5f9;
          border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: #e2e8f0;
          border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: #cbd5e1;
        }
        .venue-popup .leaflet-popup-content {
          margin: 0;
          padding: 0;
          border-radius: 12px;
          overflow: hidden;
          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        /* Brand pink marker styling - using brand-pink-500 color */
        .brand-pink-marker img {
          filter: brightness(0) saturate(100%) invert(27%) sepia(93%) saturate(1352%) hue-rotate(300deg) brightness(0.85) contrast(0.9);
        }
      `}),s.jsxs(a0,{center:e,zoom:t,style:{height:"100%",width:"100%"},ref:c,children:[s.jsx(i0,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(mfe,{center:e,zoom:t}),s.jsx(pfe,{onMapMove:a}),i&&s.jsx(dfe,{center:e,radius:o*1609.34,pathOptions:{color:"#ec4899",fillColor:"#ec4899",fillOpacity:.1,weight:2,opacity:.6}}),f.map(u=>s.jsx(gf,{position:[u.latitude,u.longitude],icon:hfe,eventHandlers:{click:()=>{l&&l(u.venueId,u.venueName,u.latitude,u.longitude)}}},u.venueId))]})]})},fw=({isOpen:e,onClose:t,artistId:r,artistName:n,currentUserId:a})=>{const i=ts(),[o,l]=y.useState(null),[c,d]=y.useState(0),[f,u]=y.useState(0),[h,m]=y.useState(0),[v,g]=y.useState(null),[x,_]=y.useState(0),[w,b]=y.useState(!0);y.useEffect(()=>{e&&r&&N()},[e,r]);const N=()=>E(void 0,null,function*(){var S;try{b(!0);const{data:k}=yield T.from("artists").select("id, name, image_url").eq("id",r).maybeSingle();k!=null&&k.image_url&&l(k.image_url);const{data:C}=yield T.from("events").select("id, event_date, images").eq("artist_id",r);if(C){d(C.length);const R=new Date,I=C.filter(O=>new Date(O.event_date)>=R).length;if(u(I),m(C.length-I),!o){const O=C.find(z=>z.images&&Array.isArray(z.images)&&z.images.length>0);if(O!=null&&O.images){const z=(S=O.images.find(M=>M==null?void 0:M.url))==null?void 0:S.url;z&&l(z)}}}const A=(C==null?void 0:C.map(R=>R.id))||[];if(A.length>0){const{data:R}=yield T.from("reviews").select("rating").in("event_id",A).eq("is_public",!0).eq("is_draft",!1);if(R&&R.length>0){const I=R.reduce((O,z)=>O+(z.rating||0),0)/R.length;g(I),_(R.length)}}}catch(k){console.error("Error loading artist data:",k)}finally{b(!1)}});return e?s.jsxs("div",{className:"fixed inset-0 z-[100] bg-[#fcfcfc] overflow-y-auto overflow-x-hidden w-full max-w-full",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},children:[s.jsx("div",{className:"bg-[#fcfcfc] border-b border-gray-200 w-full max-w-full",children:s.jsxs("div",{className:"px-4 py-3 flex items-center justify-between gap-2",children:[s.jsx("h1",{className:"text-lg font-bold flex-1 pr-2 break-words min-w-0",children:n}),s.jsx("button",{onClick:t,className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",children:s.jsx(Re,{name:"x",size:24,color:"var(--neutral-900)"})})]})}),s.jsx("div",{className:"px-4 py-4 w-full max-w-full overflow-x-hidden",children:w?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start gap-3 w-full",children:[o?s.jsx("img",{src:o,alt:n,className:"w-16 h-16 rounded-full object-cover flex-shrink-0"}):s.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center flex-shrink-0",children:s.jsx(Re,{name:"music",size:35,color:"var(--neutral-600)"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-lg font-bold mb-2 break-words",children:n}),v!==null&&s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"flex items-center",children:Array.from({length:5}).map((S,k)=>s.jsx(Xt,{size:16,style:{color:k<Math.floor(v)?"var(--color-yellow)":"var(--neutral-300)",fill:k<Math.floor(v)?"var(--color-yellow)":"none"}},k))}),s.jsx("span",{className:"text-sm font-medium",children:v.toFixed(1)}),x>0&&s.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",x," ",x===1?"review":"reviews",")"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-3 flex-wrap",children:[s.jsx(n0,{artistName:n,artistId:r,userId:a}),s.jsx(ce,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>{i(`/artist/${encodeURIComponent(n)}`),t()},children:"View All Events"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 w-full",children:[s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:c}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Events"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:f}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Upcoming"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:h}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Past"})]})]}),x>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-4",children:"Reviews"}),s.jsx(qT,{artistName:n,venueName:"",artistId:r})]}),s.jsx(ce,{variant:"outline",className:"w-full",onClick:()=>{i(`/artist/${encodeURIComponent(n)}`),t()},children:"View Full Artist Page"})]})})]}):null},hw=({isOpen:e,onClose:t,venueId:r,venueName:n,currentUserId:a})=>{const i=ts(),[o,l]=y.useState(null),[c,d]=y.useState(null),[f,u]=y.useState(null),[h,m]=y.useState(null),[v,g]=y.useState(0),[x,_]=y.useState(0),[w,b]=y.useState(0),[N,S]=y.useState(null),[k,C]=y.useState(0),[A,R]=y.useState(!0);y.useEffect(()=>{e&&I()},[e,r,n]);const I=()=>E(void 0,null,function*(){try{R(!0);const{data:O,error:z}=yield T.from("events").select("id, event_date, venue_city, venue_state, latitude, longitude").eq("venue_id",r).limit(100);z&&console.warn("Error fetching venue events:",z);try{const{data:B}=yield T.from("venues").select("id, name, state, latitude, longitude, street_address, zip, country").eq("id",r).maybeSingle();B&&(B.state&&!c&&d(B.state),B.latitude&&!f&&u(Number(B.latitude)),B.longitude&&!h&&m(Number(B.longitude)))}catch(B){console.warn("Could not fetch venue details (non-critical):",B)}if(O&&O.length>0){g(O.length);const B=new Date,F=O.filter(H=>new Date(H.event_date)>=B).length;_(F),b(O.length-F);const U=O[0];U.venue_city&&l(U.venue_city),U.venue_state&&d(U.venue_state),U.latitude&&u(Number(U.latitude)),U.longitude&&m(Number(U.longitude))}if(O&&O.length>0){g(O.length);const B=new Date,F=O.filter(U=>new Date(U.event_date)>=B).length;if(_(F),b(O.length-F),!o||!c){const U=O[0];U.venue_city&&!o&&l(U.venue_city),U.venue_state&&!c&&d(U.venue_state),U.latitude&&!f&&u(Number(U.latitude)),U.longitude&&!h&&m(Number(U.longitude))}}const M=(O==null?void 0:O.map(B=>B.id))||[];if(M.length>0){const{data:B}=yield T.from("reviews").select("venue_rating, rating").in("event_id",M).eq("is_public",!0).eq("is_draft",!1);if(B&&B.length>0){const F=B.map(U=>U.venue_rating||U.rating).filter(U=>typeof U=="number"&&!isNaN(U)&&U>0);if(F.length>0){const U=F.reduce((H,q)=>H+q,0)/F.length;S(U)}else S(null);C(F.length)}}}catch(O){console.error("Error loading venue data:",O)}finally{R(!1)}});return e?s.jsxs("div",{className:"fixed inset-0 z-50 bg-[#fcfcfc] overflow-y-auto overflow-x-hidden w-full max-w-full",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},children:[s.jsx("div",{className:"bg-[#fcfcfc] border-b border-gray-200 w-full max-w-full",children:s.jsxs("div",{className:"px-4 py-3 flex items-center justify-between gap-2",children:[s.jsx("h1",{className:"text-lg font-bold flex-1 pr-2 break-words min-w-0",children:n}),s.jsx("button",{onClick:t,className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",children:s.jsx(Re,{name:"x",size:24,color:"var(--neutral-900)"})})]})}),s.jsx("div",{className:"px-4 py-4 w-full max-w-full overflow-x-hidden",children:A?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start gap-3 w-full",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center flex-shrink-0",children:s.jsx(Re,{name:"location",size:35,color:"var(--neutral-600)"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-lg font-bold mb-2 break-words",children:n}),(o||c)&&s.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground mb-2",children:[s.jsx(Re,{name:"location",size:16,color:"var(--neutral-600)"}),s.jsx("span",{children:[o,c].filter(Boolean).join(", ")})]}),N!==null&&s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"flex items-center",children:Array.from({length:5}).map((O,z)=>s.jsx(Xt,{size:16,style:{color:z<Math.floor(N)?"var(--color-yellow)":"var(--neutral-300)",fill:z<Math.floor(N)?"var(--color-yellow)":"none"}},z))}),s.jsx("span",{className:"text-sm font-medium",children:N.toFixed(1)}),k>0&&s.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",k," ",k===1?"review":"reviews",")"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-3 flex-wrap",children:[s.jsx(k1,{venueName:n,venueCity:o||void 0,venueState:c||void 0,userId:a}),s.jsx(ce,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>{i(`/venue/${encodeURIComponent(n)}`),t()},children:"View All Events"})]})]})]}),f&&h&&s.jsx("div",{className:"h-64 rounded-lg overflow-hidden border",children:s.jsx(HT,{center:[f,h],zoom:15,events:[{id:r,jambase_event_id:r,title:n,artist_name:n,artist_id:"",venue_name:n,venue_id:r,event_date:new Date().toISOString(),latitude:f,longitude:h}],onEventClick:()=>{}})}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 w-full",children:[s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:v}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Events"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:x}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Upcoming"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:w}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Past"})]})]}),k>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-4",children:"Reviews"}),s.jsx(qT,{artistName:"",venueName:n,venueId:r})]}),s.jsx(ce,{variant:"outline",className:"w-full",onClick:()=>{i(`/venue/${encodeURIComponent(n)}`),t()},children:"View Full Venue Page"})]})})]}):null};class Sl{static checkTableExists(){return E(this,null,function*(){return this.tableExistsCache!==null?this.tableExistsCache:this.tableCheckPromise?this.tableCheckPromise:(this.tableCheckPromise=E(this,null,function*(){var t,r;try{const{error:n}=yield T.from("event_promotions").select("id").limit(0),a=!n||n.code!=="PGRST205"&&n.code!=="42P01"&&!((t=n.message)!=null&&t.includes("does not exist"))&&!((r=n.message)!=null&&r.includes("Not Found"));return this.tableExistsCache=a,a}catch(n){return this.tableExistsCache=!1,!1}finally{this.tableCheckPromise=null}}),this.tableCheckPromise)})}static trackPromotionInteraction(t,r,n,a){return E(this,null,function*(){try{if(!(yield this.checkTableExists()))return;const{data:o,error:l}=yield T.from("event_promotions").select("id, impressions, clicks, conversions").eq("event_id",t).eq("promotion_status","active").lte("starts_at",new Date().toISOString()).gte("expires_at",new Date().toISOString());if(l||!o||o.length===0)return;for(const c of o){const d={};switch(n){case"view":d.impressions=(c.impressions||0)+1;break;case"click":d.clicks=(c.clicks||0)+1;break;case"conversion":d.conversions=(c.conversions||0)+1;break}if(Object.keys(d).length>0){const{error:f}=yield T.from("event_promotions").update(d).eq("id",c.id);f?console.error(`Error updating promotion ${c.id}:`,f):console.log(` Updated promotion ${c.id} ${n}:`,d)}}}catch(i){console.error("Error tracking promotion interaction:",i)}})}static getPromotionMetricsFromInteractions(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("event_promotions").select("*").eq("id",t).single();if(a||!n)throw new Error("Promotion not found");const{data:i,error:o}=yield T.from("interactions").select("event_type, entity_type, occurred_at").eq("entity_id",r).eq("entity_type","event").gte("occurred_at",n.starts_at).lte("occurred_at",n.expires_at);if(o)return console.error("Error fetching interactions for promotion metrics:",o),{impressions:n.impressions||0,clicks:n.clicks||0,conversions:n.conversions||0,ctr:0,conversion_rate:0};const l=(i==null?void 0:i.filter(h=>h.event_type==="view").length)||0,c=(i==null?void 0:i.filter(h=>h.event_type==="click").length)||0,d=(i==null?void 0:i.filter(h=>h.event_type==="click"&&h.entity_type==="ticket_link").length)||0,f=l>0?c/l*100:0,u=c>0?d/c*100:0;return{impressions:l,clicks:c,conversions:d,ctr:Math.round(f*100)/100,conversion_rate:Math.round(u*100)/100}}catch(n){return console.error("Error calculating promotion metrics from interactions:",n),{impressions:0,clicks:0,conversions:0,ctr:0,conversion_rate:0}}})}static syncPromotionMetrics(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select("event_id, starts_at, expires_at").eq("id",t).single();if(n||!r)throw new Error("Promotion not found");const a=yield this.getPromotionMetricsFromInteractions(t,r.event_id),{error:i}=yield T.from("event_promotions").update({impressions:a.impressions,clicks:a.clicks,conversions:a.conversions}).eq("id",t);i?console.error("Error syncing promotion metrics:",i):console.log(` Synced promotion ${t} metrics:`,a)}catch(r){console.error("Error syncing promotion metrics:",r)}})}}Pr(Sl,"tableExistsCache",null),Pr(Sl,"tableCheckPromise",null);const gfe=Object.freeze(Object.defineProperty({__proto__:null,PromotionTrackingService:Sl},Symbol.toStringTag,{value:"Module"}));class Kr{static getUserInterestedEventIdSet(n){return E(this,arguments,function*(t,r=[]){const a=new Set;if(!t)return a;try{let i=T.from("user_event_relationships").select("event_id").eq("user_id",t).eq("relationship_type","interested");r.length>0&&(i=i.in("event_id",r));const{data:o,error:l}=yield i;if(!l&&o&&o.length>0)return o.forEach(c=>{c.event_id&&a.add(String(c.event_id))}),a;if(l)return console.error("Error loading interested events from user_event_relationships:",l),a}catch(i){return console.error("Error loading interested events from user_event_relationships:",i),a}return a})}static getInterestedCountsByEventId(t,r){return E(this,null,function*(){const n=new Map;if(t.length===0)return n;try{let a=T.from("user_event_relationships").select("event_id, user_id").eq("relationship_type","interested").in("event_id",t);r&&(a=a.neq("user_id",r));const{data:i,error:o}=yield a;if(!o&&i&&i.length>0)return i.forEach(l=>{if(!l.event_id)return;const c=String(l.event_id);n.set(c,(n.get(c)||0)+1)}),n;if(o)return console.error("Error loading interested counts from user_event_relationships:",o),n}catch(a){console.error("Error loading interested counts from user_event_relationships:",a)}return n})}static resolveEventIdentifiers(t){return E(this,null,function*(){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)?{eventUuid:t,jambaseEventId:null}:{eventUuid:null,jambaseEventId:t}})}static setEventInterest(t,r,n){return E(this,null,function*(){try{console.log(" setEventInterest called with:",{userId:t,jambaseEventId:r,interested:n});const{eventUuid:a,jambaseEventId:i}=yield Kr.resolveEventIdentifiers(r);if(!a&&!i)throw new Error(`Event not found: ${r}`);const{data:o,error:l}=yield T.auth.getUser();l&&console.warn(" Error getting auth user:",l);const c=o==null?void 0:o.user;(c==null?void 0:c.id)!==t&&console.warn(" User ID mismatch: auth.uid() =",c==null?void 0:c.id,"but userId param =",t);let d=!1,f=null;if(a)if(n){const{error:x}=yield T.from("user_event_relationships").upsert({user_id:t,event_id:a,relationship_type:"interested"},{onConflict:"user_id,event_id"});x?f=x:d=!0}else{const{error:x}=yield T.from("user_event_relationships").delete().eq("user_id",t).eq("event_id",a).eq("relationship_type","interested");x?f=x:d=!0}if(!d){if(f)throw console.error("Interested write failed on user_event_relationships:",f),new Error(`Failed to set event interest: ${f.message||"Unknown error"}`);if(!a)throw new Error("Cannot set event interest: event UUID not found")}console.log(" Checking if relationship was saved:",{userId:t,eventUuid:a,interested:n}),yield new Promise(x=>setTimeout(x,300));const{data:u,error:h}=yield T.auth.getUser();h&&console.warn(" Error getting auth user:",h);const m=u==null?void 0:u.user,v=(m==null?void 0:m.id)||t;let g=null;if(a){const{data:x,error:_}=yield T.from("user_event_relationships").select("*").eq("user_id",v).eq("event_id",a).eq("relationship_type","interested").maybeSingle();_?console.error("Error checking user_event_relationships after write:",_):g=x}if(n&&a)try{console.log(" UserEventService: User expressed interest, joining verified chat...",{eventUuid:a,jambaseEventId:r,userId:t});const{data:x}=yield T.from("events").select("title, id").eq("id",a).maybeSingle(),_=(x==null?void 0:x.title)||"Event";yield gc.joinOrOpenVerifiedChat("event",a,_,t),console.log(" UserEventService: Successfully joined event verified chat")}catch(x){console.error(" UserEventService: Error joining event verified chat (non-fatal):",x)}try{let x=null;if(r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(r))x=r;else{const{data:_}=yield T.from("events").select("id").eq("jambase_event_id",r).maybeSingle();_!=null&&_.id&&(x=_.id)}Zt.interest("event",r,n,{},x),console.log(" Tracked interest interaction:",{jambaseEventId:r,interested:n,eventUuid:x})}catch(x){console.error("Error tracking interest interaction:",x)}return g||{}}catch(a){throw console.error("Error setting event interest:",a),new Error(`Failed to set event interest: ${a instanceof Error?a.message:"Unknown error"}`)}})}static removeEventInterest(t,r){return E(this,null,function*(){try{yield Kr.setEventInterest(t,r,!1);try{let n=null;if(r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(r))n=r;else{const{data:a}=yield T.from("events").select("id").eq("jambase_event_id",r).maybeSingle();a!=null&&a.id&&(n=a.id)}Zt.interest("event",r,!1,{action:"remove"},n)}catch(n){}}catch(n){throw console.error("Error removing event interest:",n),new Error(`Failed to remove event interest: ${n instanceof Error?n.message:"Unknown error"}`)}})}static isUserInterested(t,r){return E(this,null,function*(){try{const{eventUuid:n,jambaseEventId:a}=yield Kr.resolveEventIdentifiers(r),{data:i,error:o}=yield T.auth.getUser();o&&console.warn(" Error getting auth user:",o);const l=i==null?void 0:i.user,c=(l==null?void 0:l.id)||t;let d=null,f=null;if(n){const{data:u,error:h}=yield T.from("user_event_relationships").select("user_id, event_id").eq("user_id",c).eq("event_id",n).in("relationship_type",["interested","going","maybe"]).maybeSingle();d=u,f=h}return!f&&d?!0:(f&&console.error("Error checking event interest:",f),!1)}catch(n){return console.error("Error checking event interest:",n),!1}})}static getUserInterestedEvents(t){return E(this,null,function*(){var r,n;try{const{data:a,error:i}=yield T.auth.getUser();i&&console.warn(" Error getting auth user:",i);const o=a==null?void 0:a.user,l=(o==null?void 0:o.id)||t,{data:c,error:d}=yield T.from("user_event_relationships").select("*").eq("user_id",l).in("relationship_type",["interested","going","maybe"]).order("created_at",{ascending:!1});if(d)throw console.error("Error loading user interested events from user_event_relationships:",d),d;if(c&&c.length>0){const f=c.map(C=>C.event_id).filter(Boolean);if(f.length===0)return{events:[],total:0};const{data:u,error:h}=yield T.from("events").select("*, artists(name), venues(name)").in("id",f);if(h)throw h;const m=u||[];console.log(" getUserInterestedEvents: Fetched events with JOINs:",{count:m.length,sample:m[0]?{id:m[0].id,title:m[0].title,artist_id:m[0].artist_id,artist_name_from_join:(r=m[0].artists)==null?void 0:r.name,venue_id:m[0].venue_id,venue_name_from_join:(n=m[0].venues)==null?void 0:n.name}:null});const v=new Set,g=new Set;m.forEach(C=>{var A,R;!((A=C.artists)!=null&&A.name)&&C.artist_id&&v.add(C.artist_id),!((R=C.venues)!=null&&R.name)&&C.venue_id&&g.add(C.venue_id)}),(v.size>0||g.size>0)&&console.log(" getUserInterestedEvents: Need to fetch names for:",{artists:Array.from(v),venues:Array.from(g)});const[x,_]=yield Promise.all([v.size>0?T.from("artists").select("id, name").in("id",Array.from(v)):Promise.resolve({data:[],error:null}),g.size>0?T.from("venues").select("id, name").in("id",Array.from(g)):Promise.resolve({data:[],error:null})]),w=new Map((x.data||[]).map(C=>[C.id,C.name])),b=new Map((_.data||[]).map(C=>[C.id,C.name]));(v.size>0||g.size>0)&&console.log(" getUserInterestedEvents: Fetched names:",{artists:Object.fromEntries(w),venues:Object.fromEntries(b)});const N=m.map(C=>{var I,O;const A=((I=C.artists)==null?void 0:I.name)||(C.artist_id?w.get(C.artist_id):null)||null,R=((O=C.venues)==null?void 0:O.name)||(C.venue_id?b.get(C.venue_id):null)||null;return!A&&C.artist_id&&console.warn(" getUserInterestedEvents: Could not fetch artist name for artist_id:",C.artist_id,"event:",C.id,"title:",C.title),!R&&C.venue_id&&console.warn(" getUserInterestedEvents: Could not fetch venue name for venue_id:",C.venue_id,"event:",C.id,"title:",C.title),V(D({},C),{artist_name:A,venue_name:R})});console.log(" getUserInterestedEvents: Normalized events sample:",N[0]?{id:N[0].id,title:N[0].title,artist_name:N[0].artist_name,venue_name:N[0].venue_name}:null);const S=new Map(N.map(C=>[C.id,C])),k=c.map(C=>{const A=S.get(C.event_id)||null;return{interest:{id:C.id,user_id:C.user_id,jambase_event_id:(A==null?void 0:A.jambase_event_id)||null,created_at:C.created_at},event:A}}).filter(C=>C.event!==null);return{events:k,total:k.length}}return{events:[],total:0}}catch(a){throw console.error("Error getting user interested events:",a),new Error(`Failed to get user interested events: ${a instanceof Error?a.message:"Unknown error"}`)}})}static setEventReview(t,r,n){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("reviews").select("*").eq("user_id",t).eq("entity_type","event").eq("entity_id",r).maybeSingle();if(i)throw i;if(a){const{data:o,error:l}=yield T.from("reviews").update(V(D({},n),{updated_at:new Date().toISOString()})).eq("user_id",t).eq("entity_type","event").eq("entity_id",r).select().single();if(l)throw l;if(!o||typeof o!="object"||o.id===void 0)throw new Error("Failed to update event review");return o}else{const{data:o,error:l}=yield T.from("reviews").insert(D({user_id:t,entity_type:"event",entity_id:r},n)).select().single();if(l)throw l;if(!o||typeof o!="object"||o.id===void 0)throw new Error("Failed to create event review");return o}}catch(a){throw console.error("Error setting event review:",a),new Error(`Failed to set event review: ${a instanceof Error?a.message:"Unknown error"}`)}})}static getUserEventReview(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select("*").eq("user_id",t).eq("entity_type","event").eq("entity_id",r).single();if(a&&a.code!=="PGRST116")throw a;return!n||typeof n!="object"||n.id===void 0?null:n}catch(n){return console.error("Error getting user event review:",n),null}})}static getEventReviews(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("reviews").select(`
          id,
          user_id,
          entity_id,
          rating,
          review_text,
          created_at,
          user:users!reviews_user_id_fkey (
            user_id,
            name,
            avatar_url
          )
        `).eq("entity_type","event").eq("entity_id",t).order("created_at",{ascending:!1});if(n)throw new Error(`Failed to fetch event reviews: ${n.message}`);const a=r||[],i=a.length,o=i>0?a.reduce((l,c)=>l+c.rating,0)/i:0;return{reviews:a,averageRating:o,totalReviews:i}}catch(r){throw console.error("Error getting event reviews:",r),new Error(`Failed to get event reviews: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getUserEventHistory(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("reviews").select(`
          id,
          user_id,
          entity_id,
          rating,
          review_text,
          created_at,
          user:users!reviews_user_id_fkey (
            user_id,
            name,
            avatar_url
          ),
          event:events!reviews_entity_id_fkey(*)
        `).eq("user_id",t).eq("entity_type","event").order("created_at",{ascending:!1});if(n)throw new Error(`Failed to fetch user event history: ${n.message}`);return{reviews:r||[],total:(r==null?void 0:r.length)||0}}catch(r){throw console.error("Error getting user event history:",r),new Error(`Failed to get user event history: ${r instanceof Error?r.message:"Unknown error"}`)}})}static deleteEventReview(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("reviews").delete().eq("user_id",t).eq("entity_type","event").eq("entity_id",r);if(n)throw n}catch(n){throw console.error("Error deleting event review:",n),new Error(`Failed to delete event review: ${n instanceof Error?n.message:"Unknown error"}`)}})}static getUserUpcomingEvents(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.auth.getUser();n&&console.warn(" Error getting auth user:",n);const a=r==null?void 0:r.user,i=(a==null?void 0:a.id)||t,o=new Date;o.setHours(0,0,0,0);const l=o.toISOString().split("T")[0],{data:c,error:d}=yield T.from("user_event_relationships").select(`
          *,
          events:events!user_event_relationships_event_id_fkey!inner(*)
        `).eq("user_id",i).in("relationship_type",["interested","going","maybe"]).gte("events.event_date",l).order("events.event_date",{ascending:!0});if(d)throw new Error(`Failed to fetch upcoming events: ${d.message}`);return{events:(c||[]).map(f=>{const u=f.events;return{interest:{id:f.id,user_id:f.user_id,jambase_event_id:(u==null?void 0:u.jambase_event_id)||null,created_at:f.created_at},event:u}}),total:(c==null?void 0:c.length)||0}}catch(r){throw console.error("Error getting user upcoming events:",r),new Error(`Failed to get user upcoming events: ${r instanceof Error?r.message:"Unknown error"}`)}})}static markUserAttendance(t,r,n){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("reviews").select("id, was_there, review_text").eq("user_id",t).eq("entity_type","event").eq("entity_id",r).maybeSingle();if(i&&i.code!=="PGRST116")throw i;if(a)if(n){const{error:o}=yield T.from("reviews").update({was_there:n,updated_at:new Date().toISOString()}).eq("user_id",t).eq("entity_type","event").eq("entity_id",r);if(o)throw o}else if(a.review_text==="ATTENDANCE_ONLY"){console.log(" Deleting ATTENDANCE_ONLY record for:",{userId:t,eventId:r});const{error:o}=yield T.from("reviews").delete().eq("user_id",t).eq("event_id",r);if(o)throw console.error(" Error deleting ATTENDANCE_ONLY record:",o),o;console.log(" Successfully deleted ATTENDANCE_ONLY record")}else{const{error:o}=yield T.from("reviews").update({was_there:n,updated_at:new Date().toISOString()}).eq("user_id",t).eq("event_id",r);if(o)throw o}else if(n){console.log(" Creating ATTENDANCE_ONLY record for:",{userId:t,eventId:r,wasThere:n});const o={user_id:t,event_id:r,rating:1,review_text:"ATTENDANCE_ONLY",was_there:n,is_public:!1,is_draft:!1,likes_count:0,comments_count:0,shares_count:0,review_type:"event",artist_performance_rating:null,production_rating:null,venue_rating:null,location_rating:null,value_rating:null,artist_performance_feedback:null,production_feedback:null,venue_feedback:null,location_feedback:null,value_feedback:null,artist_performance_recommendation:null,production_recommendation:null,venue_recommendation:null,location_recommendation:null,value_recommendation:null,ticket_price_paid:null,rank_order:0};console.log(" ATTENDANCE_ONLY record data:",o);const{data:l,error:c}=yield T.from("reviews").insert(o).select("id, is_public, review_text").single();if(c)throw console.error(" Error creating ATTENDANCE_ONLY record:",c),c;if(console.log(" ATTENDANCE_ONLY record created:",l),l&&l.is_public===!0){console.error(" CRITICAL: ATTENDANCE_ONLY record was created as PUBLIC! This should not happen!"),console.error(" Record data:",l);const{error:d}=yield T.from("reviews").update({is_public:!1}).eq("id",l.id);d?console.error(" Failed to fix is_public flag:",d):console.log(" Fixed is_public flag for ATTENDANCE_ONLY record")}}try{const o=r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(r)?r:null;Zt.interest("event",r,n,{action:"attendance"},o)}catch(o){}}catch(a){throw console.error("Error marking user attendance:",a),new Error(`Failed to mark attendance: ${a instanceof Error?a.message:"Unknown error"}`)}})}static getUserAttendance(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select("was_there, review_text, id, created_at").eq("user_id",t).eq("event_id",r).maybeSingle();if(console.log(" getUserAttendance:",{userId:t,eventId:r,data:n,error:a}),a&&a.code!=="PGRST116")throw a;if(n){const l=n.review_text&&n.review_text!=="ATTENDANCE_ONLY",c=!!n.was_there;return console.log(" Attendance check:",{hasReview:l,wasThere:c,reviewText:n.review_text,reviewId:n.id}),l&&!c?(console.log(" Auto-fixing attendance for review:",r),yield T.from("reviews").update({was_there:!0}).eq("user_id",t).eq("event_id",r),!0):c}console.log(" No review found, checking for any reviews for this user...");const{data:i,error:o}=yield T.from("reviews").select("id, event_id, review_text, was_there, created_at").eq("user_id",t).order("created_at",{ascending:!1}).limit(5);return console.log(" Recent reviews for user:",{allUserReviews:i,allError:o}),!1}catch(n){return console.error("Error checking user attendance:",n),!1}})}static getEventAttendanceCount(t){return E(this,null,function*(){try{const{count:r,error:n}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("event_id",t).eq("was_there",!0);if(n)throw n;return r||0}catch(r){return console.error("Error getting event attendance count:",r),0}})}static getEventAttendees(t,r=10){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select(`
          user_id,
          user:users!reviews_user_id_fkey(
            user_id,
            name,
            avatar_url
          )
        `).eq("event_id",t).eq("was_there",!0).limit(r);if(a)throw a;return(n||[]).map(i=>({user_id:i.user_id,name:i.profiles.name,avatar_url:i.profiles.avatar_url}))}catch(n){return console.error("Error getting event attendees:",n),[]}})}}const vfe=Object.freeze(Object.defineProperty({__proto__:null,UserEventService:Kr},Symbol.toStringTag,{value:"Module"}));function e4(e,t={}){var r,n,a,i,o,l,c,d,f,u,h;return D({event_id:e.id,artist_name:e.artist_name||((r=e.event_data)==null?void 0:r.artist_name),venue_name:e.venue_name||((n=e.event_data)==null?void 0:n.venue_name),venue_city:e.venue_city||((a=e.event_data)==null?void 0:a.venue_city),venue_state:e.venue_state||((i=e.event_data)==null?void 0:i.venue_state),event_date:e.event_date||((o=e.event_data)==null?void 0:o.event_date),price_range:e.price_range||((l=e.event_data)==null?void 0:l.price_range),has_ticket_urls:!!((c=e.ticket_urls)!=null&&c.length||(f=(d=e.event_data)==null?void 0:d.ticket_urls)!=null&&f.length),has_setlist:!!(e.setlist||(u=e.event_data)!=null&&u.setlist),genres:e.genres||((h=e.event_data)==null?void 0:h.genres)},t)}function pg(e){const t=new Date().getTime(),n=new Date(e).getTime()-t;return Math.ceil(n/(1e3*60*60*24))}function yfe(e){const t=new URLSearchParams;return t.set("utm_source",e.source||"synth"),t.set("utm_medium",e.medium||"app"),t.set("utm_campaign",e.campaign||"event_discovery"),e.content&&t.set("utm_content",e.content),e.term&&t.set("utm_term",e.term),t}function xfe(e,t){try{const r=new URL(e);return yfe({source:"synth",medium:"app",campaign:"event_modal",content:`event_${t.eventId}`,term:t.userId}).forEach((a,i)=>{r.searchParams.set(i,a)}),t.userId&&r.searchParams.set("synth_user_id",t.userId),r.searchParams.set("synth_event_id",t.eventId),r.toString()}catch(r){return console.error("Error adding UTM parameters:",r),e}}function _fe(e){try{const r=new URL(e).hostname.replace("www.",""),n={"ticketmaster.com":"Ticketmaster","stubhub.com":"StubHub","seatgeek.com":"SeatGeek","viagogo.com":"Viagogo","eventbrite.com":"Eventbrite","axs.com":"AXS","ticketfly.com":"Ticketfly","etix.com":"Etix","ticketweb.com":"TicketWeb","universe.com":"Universe"};for(const[a,i]of Object.entries(n))if(r.includes(a))return i;return r.split(".")[0]}catch(t){return"unknown"}}function D1({entityType:e,entityId:t,entityName:r,currentUserId:n,onChatOpen:a,className:i,variant:o="default"}){const[l,c]=y.useState(null),[d,f]=y.useState(!1),[u,h]=y.useState(!1),{toast:m}=Er();y.useEffect(()=>{console.log(" VerifiedChatBadge: Component mounted/updated",{entityType:e,entityId:t,entityName:r,currentUserId:n}),v()},[e,t,n]);const v=()=>E(this,null,function*(){try{console.log(" VerifiedChatBadge: Loading chat info...",{entityType:e,entityId:t,entityName:r}),f(!0);let w=yield gc.getVerifiedChatInfo(e,t);if(console.log(" VerifiedChatBadge: Initial chat info check:",w),!w||!w.chat_id){console.log(" VerifiedChatBadge: Chat does not exist, creating verified chat...");try{const b=yield gc.getOrCreateVerifiedChat(e,t,r);console.log(" VerifiedChatBadge: Verified chat created, chatId:",b),w=yield gc.getVerifiedChatInfo(e,t),console.log(" VerifiedChatBadge: Chat info after creation:",w)}catch(b){console.error(" VerifiedChatBadge: Error creating verified chat:",b)}}c(w)}catch(w){console.error(" VerifiedChatBadge: Error loading chat info:",w)}finally{f(!1)}}),g=()=>E(this,null,function*(){if(console.log(" VerifiedChatBadge: handleJoinOrOpen called",{entityType:e,entityId:t,entityName:r,currentUserId:n,hasOnChatOpen:!!a}),!n){console.log(" VerifiedChatBadge: No currentUserId, showing sign in toast"),m({title:"Please sign in",description:"You need to be signed in to join chats",variant:"destructive"});return}try{h(!0),console.log(" VerifiedChatBadge: Calling joinOrOpenVerifiedChat...");const w=yield gc.joinOrOpenVerifiedChat(e,t,r,n);console.log(" VerifiedChatBadge: joinOrOpenVerifiedChat returned chatId:",w),console.log(" VerifiedChatBadge: Reloading chat info..."),yield v(),console.log(" VerifiedChatBadge: Chat info reloaded"),a?(console.log(" VerifiedChatBadge: Calling onChatOpen callback with chatId:",w),a(w)):(console.log(" VerifiedChatBadge: No onChatOpen callback, showing toast"),m({title:"Chat opened",description:"You can now participate in the chat"})),console.log(" VerifiedChatBadge: handleJoinOrOpen completed successfully")}catch(w){console.error(" VerifiedChatBadge: Error joining/opening chat:",w),m({title:"Error",description:"Failed to join chat. Please try again.",variant:"destructive"})}finally{h(!1)}}),x=()=>{if(!(l!=null&&l.last_activity_at))return null;try{const w=new Date(l.last_activity_at);return Uv(w,{addSuffix:!0})}catch(w){return null}},_=()=>{if(!(l!=null&&l.last_activity_at))return!1;try{const w=new Date(l.last_activity_at);return(Date.now()-w.getTime())/(1e3*60*60)<24}catch(w){return!1}};return o==="compact"?s.jsxs(ce,{variant:"ghost",size:"sm",onClick:g,disabled:u||d,className:Oe("h-8 px-2",i),children:[u||d?s.jsx(fr,{className:"h-4 w-4 animate-spin"}):s.jsx(Ah,{className:"h-4 w-4"}),l!=null&&l.member_count?s.jsx("span",{className:"ml-1 text-xs",children:l.member_count}):null]}):s.jsxs("div",{className:Oe("flex items-center gap-2",i),children:[d?s.jsxs(ce,{variant:"outline",size:"sm",disabled:!0,children:[s.jsx(fr,{className:"h-4 w-4 animate-spin mr-2"}),"Loading..."]}):l!=null&&l.chat_id?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-100)",border:"2px solid var(--neutral-200)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)",boxShadow:"0 4px 4px 0 var(--shadow-color)",gap:"var(--spacing-inline, 6px)"},children:[s.jsx(Ah,{size:19,style:{color:"var(--brand-pink-500)"}}),s.jsxs("span",{children:[l.member_count||0," ",l.member_count===1?"member":"members"]}),_()&&s.jsx("span",{style:{height:"6px",width:"6px",borderRadius:"50%",backgroundColor:"#2E8B63",flexShrink:0},title:"Active"})]}),s.jsx(ce,{variant:l.is_user_member?"default":"outline",size:"sm",onClick:g,disabled:u,className:"h-8",children:u?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"h-3.5 w-3.5 animate-spin mr-1.5"}),"Joining..."]}):l.is_user_member?s.jsxs(s.Fragment,{children:[s.jsx(Ah,{className:"h-3.5 w-3.5 mr-1.5"}),"Open Chat"]}):s.jsxs(s.Fragment,{children:[s.jsx(Vr,{className:"h-3.5 w-3.5 mr-1.5"}),"Join Chat"]})})]}):s.jsx(ce,{variant:"outline",size:"sm",onClick:g,disabled:u,className:"h-8",children:u?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"h-3.5 w-3.5 animate-spin mr-1.5"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ah,{className:"h-3.5 w-3.5 mr-1.5"}),"Start Chat"]})}),(l==null?void 0:l.last_activity_at)&&x()&&s.jsx("span",{className:"text-xs text-muted-foreground hidden sm:inline",children:x()})]})}function Hl({event:e,currentUserId:t,isOpen:r,onClose:n,onInterestToggle:a,onReview:i,onAttendanceChange:o,isInterested:l=!1,hasReviewed:c=!1,onNavigateToProfile:d,onNavigateToChat:f}){ts();const[u,h]=y.useState(e),[m,v]=y.useState(!1),[g,x]=y.useState(l),[_,w]=y.useState(null),[b,N]=y.useState(!1),[S,k]=y.useState(null);y.useState(!1),y.useState([]),y.useState(1),y.useState(0);const[C,A]=y.useState(!1),[R,I]=y.useState(!1),[O,z]=y.useState(!1),[M,B]=y.useState(!1),[F,U]=y.useState(!1),[H,q]=y.useState(!1),[K,Z]=y.useState(!1),[ne,Y]=y.useState(!1),[X,se]=y.useState(!1),[de,_e]=y.useState(!1),[xe,Q]=y.useState([]),[oe,ie]=y.useState(null),[ee,G]=y.useState(!1),J=y.useRef(!1),[ae,fe]=y.useState(null),[we,ve]=y.useState(null),[me,Me]=y.useState(!1),{toast:Te}=Er(),{isCreator:Ve,isAdmin:le,isBusiness:Ke}=hf(),De=y.useRef(null),nt=y.useRef(!1);y.useEffect(()=>{h(e),J.current=!1},[e,Ve,le]),y.useEffect(()=>{r&&(u!=null&&u.id)&&t&&!J.current&&(J.current=!0,ze())},[r,u==null?void 0:u.id,t]),y.useEffect(()=>{x(l)},[l]);const ze=()=>E(this,null,function*(){if(!(!(u!=null&&u.id)||!t||ee))try{G(!0);const{VerifiedChatService:ue}=yield Rr(()=>E(this,null,function*(){const{VerifiedChatService:ct}=yield Promise.resolve().then(()=>xue);return{VerifiedChatService:ct}}),void 0,import.meta.url),qe=yield ue.getOrCreateVerifiedChat("event",u.id,u.title||"Event"),Ct=yield ue.getVerifiedChatInfo("event",u.id);ie(Ct)}catch(ue){console.error("Error loading verified chat:",ue),J.current=!1}finally{G(!1)}});if(y.useEffect(()=>{var ue;if(r&&(u!=null&&u.id)){De.current=Date.now(),nt.current=!1;const qe=e4(u,{source:"event_modal",has_ticket_urls:!!((ue=u.ticket_urls)!=null&&ue.length),has_setlist:!!u.setlist,price_range:u.price_range,days_until_event:u.event_date?pg(u.event_date):void 0});Zt.view("event",u.id,void 0,qe,u.id)}return()=>{if(De.current&&(u!=null&&u.id)){const qe=Math.floor((Date.now()-De.current)/1e3);Zt.view("event",u.id,qe,{source:"event_modal_close",duration_seconds:qe,interacted:nt.current},u.id),De.current=null}}},[r,u==null?void 0:u.id]),y.useEffect(()=>{var ue;if(r&&(u!=null&&u.id)){De.current=Date.now(),nt.current=!1;const qe=e4(u,{source:"event_modal",has_ticket_urls:!!((ue=u.ticket_urls)!=null&&ue.length),has_setlist:!!u.setlist,price_range:u.price_range,days_until_event:u.event_date?pg(u.event_date):void 0});Zt.view("event",u.id,void 0,qe,u.id)}return()=>{if(De.current&&(u!=null&&u.id)){const qe=Math.floor((Date.now()-De.current)/1e3);Zt.view("event",u.id,qe,{source:"event_modal_close",duration_seconds:qe,interacted:nt.current},u.id),De.current=null}}},[r,u==null?void 0:u.id]),y.useEffect(()=>{r&&(e!=null&&e.id)?E(this,null,function*(){var qe,Ct;try{v(!0);const{data:ct,error:pt}=yield T.from("events").select("*, artists(name), venues(name)").eq("id",e.id).single();if(pt){console.error("Error fetching event:",pt),h(e),v(!1);return}if(ct){const At=V(D(D({},e),ct),{artist_id:ct.artist_id||e.artist_id||null,venue_id:ct.venue_id||e.venue_id||null,artist_name:((qe=ct.artists)==null?void 0:qe.name)||e.artist_name||null,venue_name:((Ct=ct.venues)==null?void 0:Ct.name)||e.venue_name||null});h(At)}else h(e)}catch(ct){console.error("Error fetching event with foreign keys:",ct),h(e)}finally{v(!1)}}):r&&e&&(h(e),v(!1))},[r,e==null?void 0:e.id]),y.useEffect(()=>{r&&u&&(!u.artist_name||!u.venue_name)&&E(this,null,function*(){try{const qe=[];u.artist_id&&!u.artist_name&&qe.push(Promise.resolve(T.from("artists").select("name").eq("id",u.artist_id).single()).then(({data:pt,error:At})=>({type:"artist",data:pt,error:At}))),u.venue_id&&!u.venue_name&&qe.push(Promise.resolve(T.from("venues").select("name").eq("id",u.venue_id).single()).then(({data:pt,error:At})=>({type:"venue",data:pt,error:At}))),!u.artist_id&&u.artist_name&&qe.push(Promise.resolve(T.from("artists").select("id, name").ilike("name",`%${u.artist_name}%`).limit(1).maybeSingle()).then(({data:pt,error:At})=>({type:"artist_lookup",data:pt,error:At}))),!u.venue_id&&u.venue_name&&qe.push(Promise.resolve(T.from("venues").select("id, name").ilike("name",`%${u.venue_name}%`).limit(1).maybeSingle()).then(({data:pt,error:At})=>({type:"venue_lookup",data:pt,error:At})));const Ct=yield Promise.all(qe),ct={};Ct.forEach(pt=>{pt.data&&!pt.error&&(pt.type==="artist"?ct.artist_name=pt.data.name:pt.type==="venue"?ct.venue_name=pt.data.name:pt.type==="artist_lookup"?(ct.artist_id=pt.data.id,ct.artist_name=pt.data.name):pt.type==="venue_lookup"&&(ct.venue_id=pt.data.id,ct.venue_name=pt.data.name))}),Object.keys(ct).length>0&&h(pt=>D(D({},pt),ct))}catch(qe){console.error("Error fetching artist/venue names:",qe)}})},[r,u==null?void 0:u.id,u==null?void 0:u.artist_id,u==null?void 0:u.venue_id,u==null?void 0:u.artist_name,u==null?void 0:u.venue_name]),y.useEffect(()=>{u&&r&&new Date(u.event_date)<new Date&&Ge()},[u==null?void 0:u.id,r,t]),y.useEffect(()=>{if(!u||!r)return;const ue=new Date(u.event_date)<new Date,qe=u.setlist,Ct=qe&&qe!==null&&typeof qe=="object"&&Object.keys(qe).length>0&&(Array.isArray(qe)||qe.songs&&Array.isArray(qe.songs)||qe.setlist&&Array.isArray(qe.setlist)),ct=u.setlist_enriched===!0;ue&&!Ct&&!ct&&u.artist_name&&E(this,null,function*(){B(!0);try{const At=new Date(u.event_date),yt=`${String(At.getDate()).padStart(2,"0")}-${String(At.getMonth()+1).padStart(2,"0")}-${At.getFullYear()}`;let Fe=null;if(Fe=yield Xh.searchSetlists({artistName:u.artist_name,date:yt,venueName:u.venue_name,cityName:u.venue_city,stateCode:u.venue_state}),(!Fe||Fe.length===0)&&(Fe=yield Xh.searchSetlists({artistName:u.artist_name,date:yt})),(!Fe||Fe.length===0)&&(Fe=yield Xh.searchSetlists({artistName:u.artist_name})),Fe&&Fe.length>0){let ft=Fe.find(Et=>{var je,pe;const hr=new Date(Et.eventDate),dr=new Date(u.event_date),cn=hr.toDateString()===dr.toDateString(),mn=Et.venue.name.toLowerCase().includes(((je=u.venue_name)==null?void 0:je.toLowerCase())||"")||((pe=u.venue_name)==null?void 0:pe.toLowerCase().includes(Et.venue.name.toLowerCase()));return cn&&mn});ft||(ft=Fe.find(Et=>{const hr=new Date(Et.eventDate),dr=new Date(u.event_date);return hr.toDateString()===dr.toDateString()})),ft||(ft=Fe[0]),h(Et=>Et&&V(D({},Et),{setlist:ft,setlist_enriched:!0,setlist_song_count:ft.songCount||0,setlist_fm_id:ft.setlistFmId,setlist_fm_url:ft.url,setlist_source:"setlist.fm",setlist_last_updated:new Date().toISOString()}))}}catch(At){console.error("Error fetching setlist from setlist.fm:",At)}finally{B(!1)}})},[u==null?void 0:u.id,u==null?void 0:u.event_date,u==null?void 0:u.artist_name,u==null?void 0:u.venue_name,r]),y.useEffect(()=>{E(this,null,function*(){var qe;if(u!=null&&u.id)try{const Ct=yield Kr.getInterestedCountsByEventId([u.id],t);w((qe=Ct.get(u.id))!=null?qe:0)}catch(Ct){console.error(" Error fetching interested count:",Ct),w(null)}})},[u==null?void 0:u.id,t]),!u)return null;const vt=ue=>new Date(ue).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),rr=ue=>new Date(ue).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),sr=ue=>ue?new Date(ue).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):null,Ae=new Date(u.event_date)<new Date,Ue=new Date(u.event_date)>=new Date,gt=()=>{const ue=[u.venue_city,u.venue_state].filter(Boolean);return ue.length>0?ue.join(", "):"Location TBD"},Ce=()=>u.venue_address?u.venue_address:gt(),Ge=()=>E(this,null,function*(){try{if(Me(!0),!(u!=null&&u.id)||!t){fe(!1),ve(0);return}const ue=yield Kr.getUserAttendance(t,u.id);fe(ue);const qe=yield Kr.getEventAttendanceCount(u.id);ve(qe)}catch(ue){console.error("Error loading attendance data:",ue),fe(!1),ve(0)}finally{Me(!1)}}),Nt=()=>E(this,null,function*(){try{Me(!0);const ue=!ae;if(!(u!=null&&u.id))throw new Error("Event ID is missing");yield Kr.markUserAttendance(t,u.id,ue),fe(ue);const qe=yield Kr.getEventAttendanceCount(u.id);ve(qe),o&&o(u.id,ue),Te({title:ue?"Marked as attended!":"Removed attendance",description:ue?"You've marked that you were at this event. Add a review to share your experience!":"You've removed your attendance for this event"}),yield Ge()}catch(ue){console.error("Error toggling attendance:",ue),Te({title:"Error",description:"Failed to update attendance",variant:"destructive"})}finally{Me(!1)}}),Tt=()=>E(this,null,function*(){if(!u.artist_id){console.warn("No artist_id available for event:",u.id);return}let ue=u.artist_id,qe=u.artist_name;if(!qe&&ue)try{const{data:Ct}=yield T.from("artists").select("id, name").eq("id",ue).single();Ct&&(qe=Ct.name)}catch(Ct){console.error("Error fetching artist name:",Ct)}ue&&qe&&(Zt.click("artist",ue,{source:"event_modal",event_id:u.id,artist_name:qe,from_view:window.location.pathname},ue),Zt.click("event",u.id,{source:"event_modal_artist_click",artist_name:qe,venue_name:u.venue_name,event_date:u.event_date,genres:u.genres,price_range:u.price_range,days_until_event:u.event_date?pg(u.event_date):void 0},u.id),Sl.trackPromotionInteraction(u.id,t||"","click",{source:"event_modal_artist_click",artist_name:qe,venue_name:u.venue_name}),nt.current=!0,se(!0))}),at=()=>E(this,null,function*(){if(!u.venue_id){console.warn("No venue_id available for event:",u.id);return}let ue=u.venue_id,qe=u.venue_name;if(!qe&&ue)try{const{data:Ct}=yield T.from("venues").select("id, name").eq("id",ue).single();Ct&&(qe=Ct.name)}catch(Ct){console.error("Error fetching venue name:",Ct)}ue&&qe&&(Zt.click("venue",ue,{source:"event_modal",event_id:u.id,venue_name:qe,venue_city:u.venue_city,venue_state:u.venue_state,from_view:window.location.pathname},ue),Zt.click("event",u.id,{source:"event_modal_venue_click",artist_name:u.artist_name,venue_name:qe,event_date:u.event_date,genres:u.genres,price_range:u.price_range,days_until_event:u.event_date?pg(u.event_date):void 0},u.id),Sl.trackPromotionInteraction(u.id,t||"","click",{source:"event_modal_venue_click",artist_name:u.artist_name,venue_name:qe}),nt.current=!0,_e(!0))});return r?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"fixed inset-0 z-50 bg-[#fcfcfc] overflow-y-auto overflow-x-hidden w-full max-w-full",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))",pointerEvents:"auto"},children:[s.jsxs("div",{className:"bg-[#fcfcfc] border-b border-gray-200 w-full max-w-full",children:[s.jsx("div",{style:{paddingTop:"var(--spacing-grouped, 24px)",paddingBottom:"var(--spacing-small, 12px)",paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)"},children:s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx("h1",{className:"text-lg font-bold leading-tight flex-1 min-w-0 pr-2 break-words",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:u.title}),s.jsx("button",{onClick:n,className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",style:{width:"44px",height:"44px"},children:s.jsx(Yr,{size:24})})]})}),s.jsxs("div",{style:{paddingBottom:"var(--spacing-small, 12px)",paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)"},children:[s.jsxs("div",{className:"mb-2 flex gap-1.5 flex-wrap",children:[Ue&&a&&s.jsxs(ce,{variant:g?"default":"outline",type:"button",onClick:()=>E(this,null,function*(){console.log("Interest button clicked",{currentState:g,eventId:u==null?void 0:u.id});const ue=!g;x(ue);try{const{getEventMetadata:qe}=yield Rr(()=>E(this,null,function*(){const{getEventMetadata:Ct}=yield Promise.resolve().then(()=>U2);return{getEventMetadata:Ct}}),void 0,import.meta.url);Zt.interest("event",u.id,ue,V(D({},qe(u)),{source:"event_modal_interest_button"}),u.id)}catch(qe){console.error("Error tracking interest toggle:",qe)}ue&&Sl.trackPromotionInteraction(u.id,t||"","conversion",{source:"event_modal_interest_button",action:"interested"});try{yield a==null?void 0:a(u.id,ue)}catch(qe){console.error("Error toggling interest:",qe),x(!ue)}}),style:{fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",height:"var(--size-button-height-sm, 28px)",borderRadius:"var(--radius-corner, 10px)",border:g?"none":"2px solid var(--brand-pink-500)",backgroundColor:g?"var(--brand-pink-500)":"var(--neutral-50)",color:g?"var(--neutral-0)":"var(--brand-pink-500)",transition:"all 0.2s ease",boxShadow:"0 4px 4px 0 var(--shadow-color)",pointerEvents:"auto",zIndex:10,position:"relative"},onMouseEnter:ue=>{g?ue.currentTarget.style.backgroundColor="var(--brand-pink-600)":(ue.currentTarget.style.backgroundColor="var(--brand-pink-050)",ue.currentTarget.style.borderColor="var(--brand-pink-600)")},onMouseLeave:ue=>{g?ue.currentTarget.style.backgroundColor="var(--brand-pink-500)":(ue.currentTarget.style.backgroundColor="var(--neutral-50)",ue.currentTarget.style.borderColor="var(--brand-pink-500)")},children:[s.jsx(es,{size:24,className:`mr-1 ${g?"fill-current":""}`}),g?"Interested":"I'm Interested"]}),s.jsxs(ce,{type:"button",variant:"secondary",size:"sm",onClick:ue=>{ue.preventDefault(),ue.stopPropagation(),console.log("Report button clicked",{eventId:u==null?void 0:u.id}),u!=null&&u.id?(console.log("Opening report modal, current state:",R),I(!0),console.log("Report modal should now be open")):Te({title:"Error",description:"Unable to report this content",variant:"destructive"})},style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",pointerEvents:"auto",zIndex:100,position:"relative"},children:[s.jsx(eo,{size:16,style:{color:"var(--brand-pink-500)"}}),s.jsx("span",{children:"Report"})]})]}),s.jsxs("div",{className:"flex items-center gap-1.5 mb-3 flex-wrap",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsx(Lt,{size:16,style:{color:"var(--neutral-600)"}}),s.jsx("span",{children:vt(u.event_date)}),s.jsx("span",{children:""}),s.jsx(Oa,{size:16,style:{color:"var(--neutral-600)"}}),s.jsx("span",{children:rr(u.event_date)}),u.doors_time&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{children:["Doors: ",sr(u.doors_time)]})]}),(()=>{var pt,At;const ue=u,qe=ue==null?void 0:ue.price_range,Ct=(pt=ue==null?void 0:ue.ticket_price_min)!=null?pt:ue==null?void 0:ue.price_min,ct=(At=ue==null?void 0:ue.ticket_price_max)!=null?At:ue==null?void 0:ue.price_max;if(qe||Ct||ct){let yt="";return qe?yt=Vv(qe):Ct&&ct?yt=`$${Ct} - $${ct}`:Ct?yt=`$${Ct}+`:ct&&(yt=`Up to $${ct}`),s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsx(zl,{size:16,style:{color:"var(--neutral-600)"}}),s.jsx("span",{style:{fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)"},children:yt})]})}return null})()]}),Ae&&a&&g&&s.jsxs(ce,{variant:"secondary",type:"button",onClick:()=>E(this,null,function*(){console.log("Remove interest button clicked");try{const{getEventMetadata:ue}=yield Rr(()=>E(this,null,function*(){const{getEventMetadata:qe}=yield Promise.resolve().then(()=>U2);return{getEventMetadata:qe}}),void 0,import.meta.url);Zt.interest("event",u.id,!1,V(D({},ue(u)),{source:"event_modal_remove_interest",action:"remove"}),u.id)}catch(ue){console.error("Error tracking interest removal:",ue)}a(u.id,!1)}),style:{pointerEvents:"auto",zIndex:10},children:[s.jsx(Yr,{size:16,style:{marginRight:"var(--spacing-inline, 6px)"}}),"Remove Interest"]})]})]}),s.jsxs("div",{className:`flex flex-col px-4 pb-28 w-full max-w-full overflow-x-hidden ${b?"pb-40":""}`,id:"event-details-desc",style:{paddingTop:"var(--spacing-small, 12px)"},children:[s.jsxs("div",{className:"flex flex-wrap gap-1.5",style:{marginBottom:"var(--spacing-grouped, 24px)"},children:[Ae&&s.jsx("div",{style:{height:"25px",borderRadius:"var(--radius-corner, 10px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--neutral-100)",border:"2px solid var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",boxShadow:"0 4px 4px 0 var(--shadow-color)"},children:"Past Event"}),Ue&&s.jsx("div",{style:{height:"25px",borderRadius:"var(--radius-corner, 10px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",color:"var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",boxShadow:"0 4px 4px 0 var(--shadow-color)"},children:"Upcoming"}),s.jsx(Uue,{eventId:u.id}),s.jsx(Bue,{eventId:u.id}),s.jsx(que,{interestedCount:_||0,attendanceCount:we||0})]}),s.jsxs("div",{className:"flex flex-col gap-3 mb-3",children:[u.artist_name&&u.artist_id&&s.jsxs("button",{onClick:Tt,className:"w-full text-left",style:{backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",borderRadius:"var(--radius-corner, 10px)",border:"1px solid rgba(0, 0, 0, 0.1)",padding:"var(--spacing-small, 12px)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",transition:"all 0.2s ease",cursor:"pointer"},onMouseEnter:ue=>{ue.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.95)",ue.currentTarget.style.transform="translateY(-1px)",ue.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.12)"},onMouseLeave:ue=>{ue.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.85)",ue.currentTarget.style.transform="translateY(0)",ue.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.08)"},title:"Click to view all events for this artist",children:[s.jsx("div",{className:"font-semibold break-words",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 600)",lineHeight:"var(--typography-body-line-height, 1.4)",color:"var(--neutral-900)",marginBottom:u.genres&&u.genres.length>0?"8px":"0"},children:u.artist_name}),u.genres&&u.genres.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1.5",children:u.genres.slice(0,3).map((ue,qe)=>s.jsx("span",{style:{display:"inline-flex",alignItems:"center",height:"24px",paddingLeft:"10px",paddingRight:"10px",borderRadius:"12px",backgroundColor:"rgba(0, 0, 0, 0.05)",border:"1px solid rgba(0, 0, 0, 0.1)",fontFamily:"var(--font-family)",fontSize:"13px",fontWeight:"500",color:"var(--neutral-700)",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"},children:ue},qe))})]}),u.venue_name&&u.venue_id&&s.jsxs("button",{onClick:at,className:"w-full text-left",style:{backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",borderRadius:"var(--radius-corner, 10px)",border:"1px solid rgba(0, 0, 0, 0.1)",padding:"var(--spacing-small, 12px)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",transition:"all 0.2s ease",cursor:"pointer"},onMouseEnter:ue=>{ue.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.95)",ue.currentTarget.style.transform="translateY(-1px)",ue.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.12)"},onMouseLeave:ue=>{ue.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.85)",ue.currentTarget.style.transform="translateY(0)",ue.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.08)"},title:"Click to view all events at this venue",children:[s.jsx("div",{className:"font-semibold break-words mb-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 600)",lineHeight:"var(--typography-body-line-height, 1.4)",color:"var(--neutral-900)"},children:u.venue_name}),s.jsx("div",{className:"break-words",style:{fontFamily:"var(--font-family)",fontSize:"14px",color:"var(--neutral-600)",lineHeight:"1.4"},children:Ce()}),u.venue_zip&&s.jsxs("div",{style:{fontFamily:"var(--font-family)",fontSize:"13px",color:"var(--neutral-500)",marginTop:"4px"},children:["ZIP: ",u.venue_zip]})]})]}),s.jsx(qT,{artistName:u.artist_name,venueName:u.venue_name,artistId:u.artist_id,venueId:u.venue_id}),s.jsxs("div",{className:"mt-4 space-y-3",children:[s.jsxs("div",{className:"flex gap-1 border-b pb-2 flex-wrap",children:[s.jsx(ce,{variant:K?"default":"ghost",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:K?"var(--neutral-50)":void 0},onClick:()=>{!K&&(u!=null&&u.id)&&Zt.click("view","event_photos_tab",{event_id:u.id,source:"event_modal"},u.id),Z(!K),q(!1),U(!1)},children:s.jsx("span",{style:{color:K?"var(--neutral-50)":void 0},children:" Photos"})}),s.jsxs(ce,{variant:H?"default":"ghost",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",whiteSpace:"nowrap",color:H?"var(--neutral-50)":void 0},onClick:()=>{!H&&(u!=null&&u.id)&&Zt.click("view","event_groups_tab",{event_id:u.id,source:"event_modal"},u.id),q(!H),Z(!1),U(!1)},children:[s.jsx(Vr,{size:16,style:{marginRight:"var(--spacing-inline, 6px)",color:H?"var(--neutral-50)":void 0}}),s.jsxs("span",{style:{color:H?"var(--neutral-50)":void 0},children:["Groups (",xe.length+(oe!=null&&oe.chat_id?1:0),")"]})]}),Ue&&s.jsxs(ce,{variant:F?"default":"ghost",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",whiteSpace:"nowrap",color:F?"var(--neutral-50)":void 0},onClick:()=>{!F&&(u!=null&&u.id)&&Zt.click("view","event_buddies_tab",{event_id:u.id,source:"event_modal"},u.id),U(!F),Z(!1),q(!1)},children:[s.jsx(es,{size:24,style:{marginRight:"var(--spacing-inline, 6px)",flexShrink:0,color:F?"var(--neutral-50)":void 0}}),s.jsxs("span",{style:{color:F?"var(--neutral-50)":void 0},children:["Meet (",_!==null?_:0,")"]})]})]}),K&&s.jsx(Gue,{eventId:u.id,eventTitle:u.title,canUpload:Ae}),H&&s.jsx("div",{className:"flex items-center justify-center py-24",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(Ln,{size:60,className:"mx-auto text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Verified chats are coming soon!"})]})}),F&&s.jsx(Vue,V(D({eventId:u.id,eventTitle:u.title},_!==null&&{interestedCount:_}),{onMatchCreated:ue=>{Te({title:"New Match! ",description:`You matched with ${ue.name}!`})},onNavigateToProfile:ue=>{d&&(d(ue),n())}}))]}),(()=>{const ue=u==null?void 0:u.setlist,qe=ue&&ue!==null&&typeof ue=="object"&&Object.keys(ue).length>0&&(Array.isArray(ue)||ue.songs&&Array.isArray(ue.songs)||ue.setlist&&Array.isArray(ue.setlist)),Ct=(u==null?void 0:u.setlist_enriched)===!0,ct=(u==null?void 0:u.setlist_song_count)&&u.setlist_song_count>0;return Ae&&(qe||Ct||ct||M)})()&&s.jsx(zue,{type:"single",collapsible:!0,value:O?"setlist":"",onValueChange:ue=>z(ue==="setlist"),className:"mb-6",children:s.jsxs(YB,{value:"setlist",className:"border border-purple-200 rounded-lg",children:[s.jsx(KB,{className:"px-6 py-4 hover:no-underline",children:s.jsxs("div",{className:"flex items-center gap-3 w-full",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center",children:s.jsx(Ft,{size:24,className:"text-white"})}),s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("h3",{className:"text-lg font-bold text-purple-900",children:"Setlist from this Show"}),s.jsxs("p",{className:"text-sm text-purple-700",children:[(()=>{if(u.setlist_song_count&&u.setlist_song_count>0)return u.setlist_song_count;const ue=u.setlist;return ue&&ue.songs?ue.songs.length:"Multiple"})()," songs performed"]})]}),u.setlist_fm_url&&s.jsx(ce,{variant:"outline",size:"sm",asChild:!0,className:"border-purple-300 hover:bg-purple-100",onClick:ue=>ue.stopPropagation(),children:s.jsxs("a",{href:u.setlist_fm_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1",children:[s.jsx("span",{children:"View on setlist.fm"}),s.jsx(io,{size:16})]})})]})}),s.jsx(ZB,{className:"px-6 pb-6 max-h-96 overflow-y-auto",children:M?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ft,{size:35,className:"text-purple-500 mx-auto mb-3 animate-pulse"}),s.jsx("p",{className:"text-purple-700",children:"Loading setlist from setlist.fm..."})]}):(()=>{const ue=u.setlist;let qe=[];return ue&&typeof ue=="object"&&(Array.isArray(ue)?qe=ue:ue.songs&&Array.isArray(ue.songs)?qe=ue.songs:ue.setlist&&Array.isArray(ue.setlist)&&(qe=ue.setlist)),!qe||qe.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx("p",{className:"text-purple-700",children:"Setlist data is available but in an unexpected format."}),s.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Data keys: ",ue?Object.keys(ue).join(", "):"none"]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Setlist type: ",typeof ue]})]}):s.jsxs("div",{className:"space-y-4",children:[Array.from(new Set(qe.map(Ct=>Ct.setNumber||1))).map(Ct=>{var At;const ct=qe.filter(yt=>(yt.setNumber||1)===Ct),pt=((At=ct[0])==null?void 0:At.setName)||`Set ${Ct}`;return s.jsxs("div",{className:"bg-white/70 rounded-lg p-4",children:[s.jsxs("h4",{className:"font-semibold text-purple-900 mb-3 flex items-center gap-2",children:[s.jsx(Ft,{size:16}),pt]}),s.jsx("div",{className:"space-y-1",children:ct.map((yt,Fe)=>s.jsxs("div",{className:"flex items-start gap-3 py-1",children:[s.jsxs("span",{className:"text-purple-600 font-medium min-w-[28px] text-sm",children:[yt.position||Fe+1,"."]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("span",{className:"text-gray-900 text-sm font-medium",children:yt.name||yt.title||yt.song||"Unknown Song"}),yt.cover&&s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-100)",border:"2px solid var(--neutral-200)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)",boxShadow:"0 4px 4px 0 var(--shadow-color)"},children:[yt.cover.artist||yt.cover," cover"]})]}),(yt.info||yt.notes)&&s.jsx("p",{className:"text-xs text-gray-600 mt-1 italic",children:yt.info||yt.notes})]})]},yt.position||Fe))})]},Ct)}),ue.info&&s.jsx("div",{className:"bg-purple-100/50 rounded-lg p-3 mt-4",children:s.jsxs("p",{className:"text-sm text-purple-900",children:[s.jsx("span",{className:"font-semibold",children:"Note:"})," ",ue.info]})}),ue.tour&&s.jsx("div",{className:"bg-blue-100/50 rounded-lg p-3 mt-4",children:s.jsxs("p",{className:"text-sm text-blue-900",children:[s.jsx("span",{className:"font-semibold",children:"Tour:"})," ",ue.tour]})})]})})()})]})}),Ae&&s.jsxs("div",{className:"mb-6 rounded-md border p-4",style:{backgroundColor:"var(--neutral-100)",borderColor:"var(--neutral-200)"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--neutral-200)"},children:s.jsx(Vr,{size:16,style:{color:"var(--neutral-900)"}})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",style:{color:"var(--neutral-900)"},children:"Event Attendance"}),s.jsx("p",{className:"text-sm",style:{color:"var(--neutral-600)"},children:me?"Loading...":we===null?"Loading attendance...":we===0?"No one has marked attendance yet":`${we} person${we===1?"":"s"} attended this event`})]})]}),s.jsx(ce,{size:"default",variant:"secondary",onClick:Nt,disabled:me,style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:me?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):ae?s.jsxs(s.Fragment,{children:[s.jsx(Vr,{size:16,className:"mr-2"}),"I was there"]}):s.jsxs(s.Fragment,{children:[s.jsx(Vr,{size:16,className:"mr-2"}),"I was there"]})})]}),ae&&s.jsx("div",{className:"text-sm rounded-lg p-2",style:{color:"var(--neutral-600)",backgroundColor:"var(--neutral-100)"},children:" You've marked that you attended this event"})]}),Ue&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Location"}),u.latitude!=null&&u.longitude!=null&&!Number.isNaN(Number(u.latitude))&&!Number.isNaN(Number(u.longitude))?s.jsx("div",{className:"rounded-lg overflow-hidden border h-[400px]",children:s.jsx(HT,{center:[Number(u.latitude),Number(u.longitude)],zoom:13,events:[e],onEventClick:()=>{}})}):s.jsx("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center h-[400px]",children:s.jsxs("div",{className:"text-center text-gray-500",children:[s.jsx(yr,{size:35,className:"mx-auto mb-2"}),s.jsx("p",{children:"Location not available"})]})})]}),s.jsx("div",{className:`pt-3 border-t ${b?"mt-2":"mt-4"} w-full max-w-full overflow-x-hidden`,children:Ae?s.jsx("div",{className:"flex flex-wrap items-center gap-2 w-full",children:i&&s.jsxs(ce,{variant:c?"default":"outline",size:"sm",onClick:()=>i(u.id),className:`text-xs px-3 py-1 h-7 ${c?"bg-yellow-500 hover:bg-yellow-600 text-white":"hover:bg-yellow-50 hover:text-yellow-600 hover:border-yellow-300"}`,children:[c?s.jsx(Xt,{size:16,className:"mr-1 fill-current"}):s.jsx(Xt,{size:16,className:"mr-1"}),s.jsx("span",{className:"text-xs",children:c?"Reviewed":"I Was There!"})]})}):s.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full",children:[s.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>A(!0),className:"text-xs px-3 py-1 h-7",children:[s.jsx(Ah,{size:16,className:"mr-1 flex-shrink-0"}),s.jsx("span",{className:"text-xs",children:"Comments"})]}),(()=>{var pt,At;const ue=u,qe=ue==null?void 0:ue.price_range,Ct=(pt=ue==null?void 0:ue.ticket_price_min)!=null?pt:ue==null?void 0:ue.price_min,ct=(At=ue==null?void 0:ue.ticket_price_max)!=null?At:ue==null?void 0:ue.price_max;if(qe||Ct||ct){let yt="";return qe?yt=Vv(qe):Ct&&ct?yt=`$${Ct}-$${ct}`:Ct?yt=`$${Ct}+`:ct&&(yt=`$${ct}`),s.jsxs("div",{className:"text-xs flex items-center",children:[s.jsx("span",{className:"text-muted-foreground",children:"Price: "}),s.jsx("span",{className:"font-medium",children:yt})]})}return null})(),t&&(u==null?void 0:u.id)&&s.jsx("div",{className:"flex items-center flex-shrink-0",children:s.jsx(D1,{entityType:"event",entityId:u.id,entityName:u.title||"Event",currentUserId:t,onChatOpen:ue=>{console.log(" EventDetailsModal: Chat opened, navigating to chat:",ue),f?f(ue):window.location.href=`/chats?chatId=${ue}`}})})]}),s.jsx("div",{className:"flex flex-wrap items-center gap-2 w-full",children:(u.ticket_urls&&u.ticket_urls.length>0||u.ticket_url)&&s.jsxs(ce,{variant:"default",size:"sm",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-0)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",height:"var(--size-button-height-sm, 28px)",borderRadius:"var(--radius-corner, 10px)",border:"none",display:"flex",alignItems:"center",gap:"var(--spacing-inline, 6px)",transition:"all 0.2s ease",boxShadow:"0 4px 4px 0 var(--shadow-color)"},onMouseEnter:ue=>{ue.currentTarget.style.backgroundColor="var(--brand-pink-600)"},onMouseLeave:ue=>{ue.currentTarget.style.backgroundColor="var(--brand-pink-500)"},onClick:()=>{var pt;const ue=((pt=u.ticket_urls)==null?void 0:pt[0])||u.ticket_url,qe=_fe(ue),Ct=u.event_date?pg(u.event_date):void 0;Zt.click("ticket_link",u.id,{ticket_url:ue,ticket_provider:qe,price_range:u.price_range,event_date:u.event_date,artist_name:u.artist_name,venue_name:u.venue_name,days_until_event:Ct,source:"event_modal",user_interested:g},u.id),Sl.trackPromotionInteraction(u.id,t||"","click",{source:"event_modal_ticket_click",ticket_url:ue,ticket_provider:qe}),nt.current=!0;const ct=xfe(ue,{eventId:u.id,userId:t,source:"event_modal"});window.open(ct,"_blank","noopener,noreferrer")},children:[s.jsx(zl,{size:16,style:{flexShrink:0,color:"var(--neutral-50)"}}),s.jsx("span",{style:{color:"var(--neutral-50)"},children:"Get Tickets"})]})})]})}),s.jsx("div",{className:`${b?"h-20":"h-2"}`})]}),b&&S&&s.jsx(Zue,{friend:S,isOpen:b,onClose:()=>N(!1),onStartChat:ue=>{if(f)f(ue),n();else{const qe=new CustomEvent("start-chat",{detail:{friendUserId:ue,eventId:u.id}});window.dispatchEvent(qe)}N(!1)},onNavigateToProfile:ue=>{d&&(d(ue),n())},onAddFriend:ue=>E(this,null,function*(){try{const{error:qe}=yield T.rpc("create_friend_request",{receiver_user_id:ue});if(qe)throw qe;console.log(" Friend request sent successfully")}catch(qe){console.error(" Failed to send friend request:",qe)}})}),s.jsx(XB,{eventId:u.id,isOpen:C,onClose:()=>A(!1),currentUserId:t}),(u==null?void 0:u.id)&&s.jsx(E1,{open:R,onClose:()=>{console.log("Closing report modal"),I(!1)},contentType:"event",contentId:u.id,contentTitle:u.title||"Event",onReportSubmitted:()=>{console.log("Report submitted, closing modal"),I(!1),Te({title:"Report Submitted",description:"Thank you for helping keep our community safe"})}}),s.jsx(Kue,{open:ne,onClose:()=>Y(!1),event:{id:u.id,title:u.title,artist_name:u.artist_name,event_date:u.event_date},onGroupCreated:ue=>{Y(!1),Te({title:"Group Created! ",description:"Your event group is ready"})}})]}),(u==null?void 0:u.artist_id)&&(u==null?void 0:u.artist_name)&&s.jsx(fw,{isOpen:X,onClose:()=>se(!1),artistId:u.artist_id,artistName:u.artist_name,currentUserId:t}),(u==null?void 0:u.venue_id)&&(u==null?void 0:u.venue_name)&&s.jsx(hw,{isOpen:de,onClose:()=>_e(!1),venueId:u.venue_id,venueName:u.venue_name,currentUserId:t})]}):null}function fU({reviewId:e,isOpen:t,onClose:r,currentUserId:n,onCommentAdded:a,onCommentsLoaded:i}){const[o,l]=y.useState([]),[c,d]=y.useState(!1),[f,u]=y.useState(!1),[h,m]=y.useState(""),[v,g]=y.useState(null);y.useEffect(()=>{t&&e&&x()},[t,e]);const x=()=>E(this,null,function*(){if(e)try{d(!0),g(null);const b=yield cs.getReviewComments(e);l(b),i&&i(b.length)}catch(b){console.error("Failed to load review comments",b),g("Failed to load comments")}finally{d(!1)}}),_=()=>E(this,null,function*(){if(!(!n||!e||!h.trim()||f))try{u(!0),g(null);const b=yield cs.addComment(n,e,h.trim()),N=V(D({},b),{user:{id:n,name:"You",avatar_url:void 0}});l(S=>[...S,N]),m(""),a&&a()}catch(b){console.error("Failed to add comment",b),g("Failed to add comment")}finally{u(!1)}}),w=b=>{b.key==="Enter"&&(b.ctrlKey||b.metaKey)&&(b.preventDefault(),_())};return s.jsx(vn,{open:t,onOpenChange:r,children:s.jsxs(hn,{className:"fixed inset-0 z-[100] max-w-none w-full h-full m-0 p-0 overflow-hidden flex flex-col rounded-none",style:{left:0,top:0,transform:"none",width:"100vw",height:"100vh",maxWidth:"100vw",maxHeight:"100vh",borderRadius:0,backgroundColor:"var(--neutral-50)"},children:[s.jsxs(Hn,{className:"px-4 py-3 border-b sticky top-0 z-10",style:{borderColor:"var(--neutral-200)",backgroundColor:"var(--neutral-50)"},children:[s.jsx(Sn,{children:"Review Comments"}),s.jsx(ds,{children:"Share your thoughts about this review"})]}),s.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto px-4 py-4 space-y-4",children:c?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(fr,{className:"h-6 w-6 animate-spin mr-2"}),s.jsx("span",{children:"Loading comments..."})]}):v?s.jsxs("div",{className:"text-center py-8 text-red-600",children:[s.jsx("p",{children:v}),s.jsx(ce,{variant:"outline",onClick:x,className:"mt-2",children:"Try Again"})]}):o.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx("p",{children:"No comments yet."}),s.jsx("p",{className:"text-sm",children:"Be the first to share your thoughts!"})]}):s.jsx("div",{className:"space-y-4",children:o.map(b=>s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsxs(Wr,{className:"w-8 h-8",children:[s.jsx(Qr,{src:b.user.avatar_url}),s.jsx(Hr,{className:"text-xs",children:(b.user.name||"U").slice(0,2).toUpperCase()})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"font-medium text-sm",children:b.user.name||"User"}),s.jsx("span",{className:"text-xs text-gray-500",children:new Date(b.created_at).toLocaleString()})]}),s.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:b.comment_text})]})]},b.id))})}),s.jsxs("div",{className:"border-t border-gray-200 p-4 bg-white",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(_s,{value:h,onChange:b=>m(b.target.value),onKeyDown:w,placeholder:n?"Write a comment...":"Sign in to comment",disabled:!n||f,className:"min-h-[60px] resize-none"}),s.jsx(ce,{onClick:_,disabled:!n||f||!h.trim(),className:"px-3",children:f?s.jsx(fr,{className:"h-4 w-4 animate-spin"}):s.jsx(qc,{className:"h-4 w-4"})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Press Ctrl+Enter to submit"})]})]})})}class wfe{static resolveInternalEventId(t){return E(this,null,function*(){if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t))return t;const{data:n}=yield T.from("events").select("id").eq("jambase_event_id",t).limit(1).single();return(n==null?void 0:n.id)||t})}static likeEvent(t,r){return E(this,null,function*(){const n=yield this.resolveInternalEventId(r),{data:a,error:i}=yield T.rpc("get_or_create_entity",{p_entity_type:"event",p_entity_uuid:n,p_entity_text_id:null});if(i)throw i;const{data:o,error:l}=yield T.from("engagements").select("*").eq("user_id",t).eq("entity_id",a).eq("engagement_type","like").maybeSingle();if(l&&l.code!=="PGRST116")throw console.error("Error checking existing like:",l),l;if(o)return{id:o.id,user_id:o.user_id,event_id:n,created_at:o.created_at};const{data:c,error:d}=yield T.from("engagements").insert({user_id:t,entity_id:a,engagement_type:"like"}).select("*").single();if(d){if(d.code==="PGRST205")return console.warn("engagements table not found. Add migration to enable event likes."),null;if(d.code==="23505"||d.status===409){const{data:f,error:u}=yield T.from("engagements").select("*").eq("user_id",t).eq("entity_id",a).eq("engagement_type","like").single();if(u)throw console.error("Error fetching existing like after duplicate key error:",u),d;return{id:f.id,user_id:f.user_id,event_id:n,created_at:f.created_at}}throw d}return{id:c.id,user_id:c.user_id,event_id:n,created_at:c.created_at}})}static unlikeEvent(t,r){return E(this,null,function*(){const n=yield this.resolveInternalEventId(r),{data:a,error:i}=yield T.from("entities").select("id").eq("entity_type","event").eq("entity_uuid",n).single();if(i){i.code!=="PGRST116"&&console.error("Error fetching entity for unlike event:",i);return}if(!(a!=null&&a.id))return;const{error:o}=yield T.from("engagements").delete().eq("user_id",t).eq("entity_id",a.id).eq("engagement_type","like");if(o){if(o.code==="PGRST205")return;throw o}})}static getEventLikers(t){return E(this,null,function*(){const r=yield this.resolveInternalEventId(t),{data:n,error:a}=yield T.from("entities").select("id").eq("entity_type","event").eq("entity_uuid",r).single();if(a)return a.code!=="PGRST116"&&console.error("Error fetching entity for event likers:",a),[];if(!(n!=null&&n.id))return[];const{data:i,error:o}=yield T.from("engagements").select("user_id").eq("entity_id",n.id).eq("engagement_type","like");if(o){if(o.code==="PGRST205")return[];throw o}const l=(i||[]).map(f=>f.user_id);if(l.length===0)return[];const{data:c,error:d}=yield T.from("users").select("id, user_id, name, avatar_url").in("user_id",l);if(d)throw d;return c||[]})}static isLikedByUser(t,r){return E(this,null,function*(){try{const n=yield this.resolveInternalEventId(r),{data:a,error:i}=yield T.from("entities").select("id").eq("entity_type","event").eq("entity_uuid",n).single();if(i)return i.code!=="PGRST116"&&console.error("Error fetching entity for isLikedByUser:",i),!1;if(!(a!=null&&a.id))return!1;const{data:o,error:l}=yield T.from("engagements").select("id").eq("user_id",t).eq("entity_id",a.id).eq("engagement_type","like").limit(1).maybeSingle();if(l){if(l.code==="PGRST205")return!1;throw l}return!!o}catch(n){return console.error("Error checking if event is liked by user:",n),!1}})}}function bfe({eventId:e,isOpen:t,onClose:r}){const[n,a]=y.useState([]),[i,o]=y.useState(!1);return y.useEffect(()=>{!t||!e||E(this,null,function*(){o(!0);try{const l=yield wfe.getEventLikers(e);a(l)}finally{o(!1)}})},[t,e]),s.jsx(vn,{open:t,onOpenChange:l=>!l&&r(),children:s.jsxs(hn,{className:"sm:max-w-md",children:[s.jsxs(Hn,{children:[s.jsx(Sn,{children:"Likes"}),s.jsx(ds,{children:"People who liked this event"})]}),s.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-1",children:i?s.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading"}):n.length===0?s.jsx("div",{className:"text-sm text-muted-foreground",children:"No likes yet."}):n.map(l=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Wr,{className:"h-8 w-8",children:[s.jsx(Qr,{src:l.avatar_url||void 0}),s.jsx(Hr,{children:(l.name||"U").slice(0,2).toUpperCase()})]}),s.jsx("div",{className:"text-sm",children:l.name||"User"})]},l.user_id))})]})})}function GT({event:e,currentUserId:t,isOpen:r,onClose:n}){y.useState("all");const[a,i]=y.useState([]),[o,l]=y.useState([]),[c,d]=y.useState(new Set);y.useState(new Set);const[f,u]=y.useState(""),[h,m]=y.useState(""),[v,g]=y.useState(!1),[x,_]=y.useState(!1),[w,b]=y.useState(!1),{toast:N}=Er(),S=()=>E(this,null,function*(){try{const M=yield ov.shareEvent(e.id,e.title,e.description||void 0);navigator.share?(yield navigator.share({title:e.title,text:e.description||"Check out this concert!",url:M}),N({title:"Shared!",description:"Event shared successfully"})):(yield navigator.clipboard.writeText(M),N({title:"Link Copied!",description:"Event link copied to clipboard"}))}catch(M){M.name!=="AbortError"&&(console.error("Error sharing externally:",M),N({title:"Error",description:"Failed to share event",variant:"destructive"}))}});y.useEffect(()=>{r&&(k(),C(),b(!1))},[r,t]);const k=()=>E(this,null,function*(){try{g(!0);const M=yield Sd.getShareTargets(t);i(M)}catch(M){console.error("Error loading share targets:",M),N({title:"Error",description:"Failed to load chats",variant:"destructive"})}finally{g(!1)}}),C=()=>E(this,null,function*(){try{const M=yield Sd.getFriends(t);l(M)}catch(M){console.error("Error loading friends:",M)}}),A=M=>{d(B=>{const F=new Set(B);return F.has(M)?F.delete(M):F.add(M),F})},R=()=>E(this,null,function*(){if(c.size===0){N({title:"No chats selected",description:"Please select at least one chat to share with",variant:"destructive"});return}try{_(!0);const M=Array.from(c),B=M.filter(H=>!H.startsWith("friend-")),F=M.filter(H=>H.startsWith("friend-")).map(H=>H.replace("friend-",""));let U={successCount:0,errors:[]};if(B.length>0){const H=yield Sd.shareEventToMultipleChats(e.id,B,t,f||void 0);U.successCount+=H.successCount,U.errors.push(...H.results.filter(q=>!q.success).map(q=>q.error||"Unknown error"))}for(const H of F)try{const q=yield Sd.shareEventToNewChat(e.id,H,t,f||void 0);q.success?U.successCount+=1:U.errors.push(q.error||"Failed to share with friend")}catch(q){U.errors.push(`Failed to share with friend: ${q}`)}U.successCount>0&&(N({title:"Event Shared! ",description:`Successfully shared to ${U.successCount} chat${U.successCount>1?"s":""}`}),d(new Set),u(""),n()),U.errors.length>0&&N({title:"Partial Success",description:`${U.errors.length} share${U.errors.length>1?"s":""} failed`,variant:"destructive"})}catch(M){console.error("Error sharing event:",M),N({title:"Error",description:"Failed to share event",variant:"destructive"})}finally{_(!1)}}),I=a.filter(M=>M.name.toLowerCase().includes(h.toLowerCase())&&!M.name.toLowerCase().includes("direct chat")&&!M.name.toLowerCase().includes("dc direct")),O=o.filter(M=>M.name.toLowerCase().includes(h.toLowerCase())),z=[...I.map(M=>V(D({},M),{type:"group",isGroup:!0})),...O.map(M=>({id:`friend-${M.user_id}`,name:M.name,avatar_url:M.avatar_url,type:"friend",isGroup:!1,user_id:M.user_id}))];return s.jsx(vn,{open:r,onOpenChange:n,children:s.jsxs(hn,{className:"max-w-lg max-h-[85vh] overflow-hidden flex flex-col",children:[s.jsxs(Hn,{children:[s.jsx(Sn,{className:"text-xl font-bold",children:"Share Event"}),s.jsxs(ds,{children:['Share "',e.title,'" with your friends']})]}),s.jsxs("div",{className:"bg-gradient-to-r from-pink-50 to-purple-50 rounded-lg p-3 border border-pink-200",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:e.title}),s.jsxs("p",{className:"text-xs text-gray-600",children:[e.venue_name,"  ",new Date(e.event_date).toLocaleDateString()]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(ce,{onClick:S,variant:"outline",className:"h-auto py-4 border-pink-200 hover:bg-pink-50 flex flex-col items-center gap-2",children:[s.jsx(Dc,{className:"w-6 h-6 text-pink-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Share Externally"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Phone, Apps, etc."})]}),s.jsxs(ce,{onClick:()=>{b(!w),!w&&a.length===0&&o.length===0&&!v&&(k(),C())},variant:w?"default":"outline",className:`h-auto py-4 border-pink-200 flex flex-col items-center gap-2 ${w?"bg-pink-500 hover:bg-pink-600 text-white border-pink-500":"hover:bg-pink-50"}`,children:[s.jsx(Ln,{className:`w-6 h-6 ${w?"text-white":"text-pink-500"}`}),s.jsx("span",{className:"text-sm font-medium",children:"Share in Chat"}),s.jsx("span",{className:`text-xs ${w?"text-pink-100":"text-gray-500"}`,children:"Within Synth"})]})]}),w&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-1 mt-4 border-t pt-4",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Add a message (optional)"}),s.jsx(_s,{placeholder:"Let's go to this show together! ",value:f,onChange:M=>u(M.target.value),rows:1,className:"resize-none text-sm"})]}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden mt-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Ln,{className:"w-5 h-5 text-pink-500"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Choose Chats"})]}),s.jsxs("div",{className:"relative mb-3",children:[s.jsx(Ho,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx(Nr,{placeholder:"Search chats...",value:h,onChange:M=>m(M.target.value),className:"pl-10"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2",children:v?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(fr,{className:"w-6 h-6 animate-spin text-pink-500"})}):z.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Ln,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),s.jsx("p",{children:"No chats found"}),s.jsx("p",{className:"text-sm",children:"Start a conversation to share events"})]}):z.map(M=>{var B;return s.jsxs("div",{onClick:()=>A(M.id),className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all ${c.has(M.id)?"bg-pink-50 border-2 border-pink-300":"bg-white border border-gray-200 hover:border-pink-200"}`,children:[s.jsxs(Wr,{className:"w-10 h-10",children:[s.jsx(Qr,{src:M.avatar_url||void 0}),s.jsx(Hr,{children:M.isGroup?s.jsx(Vr,{className:"w-5 h-5"}):M.name.split(" ").map(F=>F[0]).join("")})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:M.name}),s.jsx("p",{className:"text-xs text-gray-500",children:M.isGroup?`${((B=M.users)==null?void 0:B.length)||M.member_count||0} members`:"Direct message"})]}),c.has(M.id)&&s.jsx("div",{className:"w-6 h-6 rounded-full bg-pink-500 flex items-center justify-center",children:s.jsx(fa,{className:"w-4 h-4 text-white"})})]},M.id)})}),s.jsxs("div",{className:"mt-4 pt-4 border-t flex gap-2",children:[s.jsx(ce,{onClick:n,variant:"outline",className:"flex-1",children:"Cancel"}),s.jsx(ce,{onClick:R,disabled:c.size===0||x,className:"flex-1 bg-pink-500 hover:bg-pink-600 text-white",children:x?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-4 h-4 mr-2 animate-spin"}),"Sharing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(qc,{className:"w-4 h-4 mr-2"}),"Share (",c.size,")"]})})]})]})]})]})})}function I1(e){const t=y.useRef({value:e,previous:e});return y.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var jfe=[" ","Enter","ArrowUp","ArrowDown"],Nfe=[" ","Enter"],vf="Select",[$1,L1,Sfe]=fp(vf),[Sp,aUe]=$s(vf,[Sfe,Qd]),F1=Qd(),[kfe,ru]=Sp(vf),[Efe,Cfe]=Sp(vf),hU=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:d,name:f,autoComplete:u,disabled:h,required:m,form:v}=e,g=F1(t),[x,_]=y.useState(null),[w,b]=y.useState(null),[N,S]=y.useState(!1),k=Af(d),[C,A]=Ya({prop:n,defaultProp:a!=null?a:!1,onChange:i,caller:vf}),[R,I]=Ya({prop:o,defaultProp:l,onChange:c,caller:vf}),O=y.useRef(null),z=x?v||!!x.closest("form"):!0,[M,B]=y.useState(new Set),F=Array.from(M).map(U=>U.props.value).join(";");return s.jsx(Xb,V(D({},g),{children:s.jsxs(kfe,{required:m,scope:t,trigger:x,onTriggerChange:_,valueNode:w,onValueNodeChange:b,valueNodeHasChildren:N,onValueNodeHasChildrenChange:S,contentId:Os(),value:R,onValueChange:I,open:C,onOpenChange:A,dir:k,triggerPointerDownPosRef:O,disabled:h,children:[s.jsx($1.Provider,{scope:t,children:s.jsx(Efe,{scope:e.__scopeSelect,onNativeOptionAdd:y.useCallback(U=>{B(H=>new Set(H).add(U))},[]),onNativeOptionRemove:y.useCallback(U=>{B(H=>{const q=new Set(H);return q.delete(U),q})},[]),children:r})}),z?s.jsxs($U,{"aria-hidden":!0,required:m,tabIndex:-1,name:f,autoComplete:u,value:R,onChange:U=>I(U.target.value),disabled:h,form:v,children:[R===void 0?s.jsx("option",{value:""}):null,Array.from(M)]},F):null]})}))};hU.displayName=vf;var mU="SelectTrigger",pU=y.forwardRef((e,t)=>{const g=e,{__scopeSelect:r,disabled:n=!1}=g,a=ge(g,["__scopeSelect","disabled"]),i=F1(r),o=ru(mU,r),l=o.disabled||n,c=mr(t,o.onTriggerChange),d=L1(r),f=y.useRef("touch"),[u,h,m]=FU(x=>{const _=d().filter(N=>!N.disabled),w=_.find(N=>N.value===o.value),b=zU(_,x,w);b!==void 0&&o.onValueChange(b.value)}),v=x=>{l||(o.onOpenChange(!0),m()),x&&(o.triggerPointerDownPosRef.current={x:Math.round(x.pageX),y:Math.round(x.pageY)})};return s.jsx(Wy,V(D({asChild:!0},i),{children:s.jsx(Pt.button,V(D({type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":LU(o.value)?"":void 0},a),{ref:c,onClick:mt(a.onClick,x=>{x.currentTarget.focus(),f.current!=="mouse"&&v(x)}),onPointerDown:mt(a.onPointerDown,x=>{f.current=x.pointerType;const _=x.target;_.hasPointerCapture(x.pointerId)&&_.releasePointerCapture(x.pointerId),x.button===0&&x.ctrlKey===!1&&x.pointerType==="mouse"&&(v(x),x.preventDefault())}),onKeyDown:mt(a.onKeyDown,x=>{const _=u.current!=="";!(x.ctrlKey||x.altKey||x.metaKey)&&x.key.length===1&&h(x.key),!(_&&x.key===" ")&&jfe.includes(x.key)&&(v(),x.preventDefault())})}))}))});pU.displayName=mU;var gU="SelectValue",vU=y.forwardRef((e,t)=>{const h=e,{__scopeSelect:r,className:n,style:a,children:i,placeholder:o=""}=h,l=ge(h,["__scopeSelect","className","style","children","placeholder"]),c=ru(gU,r),{onValueNodeHasChildrenChange:d}=c,f=i!==void 0,u=mr(t,c.onValueNodeChange);return xs(()=>{d(f)},[d,f]),s.jsx(Pt.span,V(D({},l),{ref:u,style:{pointerEvents:"none"},children:LU(c.value)?s.jsx(s.Fragment,{children:o}):i}))});vU.displayName=gU;var Pfe="SelectIcon",yU=y.forwardRef((e,t)=>{const i=e,{__scopeSelect:r,children:n}=i,a=ge(i,["__scopeSelect","children"]);return s.jsx(Pt.span,V(D({"aria-hidden":!0},a),{ref:t,children:n||""}))});yU.displayName=Pfe;var Tfe="SelectPortal",xU=e=>s.jsx(hp,D({asChild:!0},e));xU.displayName=Tfe;var yf="SelectContent",_U=y.forwardRef((e,t)=>{const r=ru(yf,e.__scopeSelect),[n,a]=y.useState();if(xs(()=>{a(new DocumentFragment)},[]),!r.open){const i=n;return i?ao.createPortal(s.jsx(wU,{scope:e.__scopeSelect,children:s.jsx($1.Slot,{scope:e.__scopeSelect,children:s.jsx("div",{children:e.children})})}),i):null}return s.jsx(bU,V(D({},e),{ref:t}))});_U.displayName=yf;var So=10,[wU,nu]=Sp(yf),Afe="SelectContentImpl",Rfe=Bd("SelectContent.RemoveScroll"),bU=y.forwardRef((e,t)=>{const xe=e,{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:d,alignOffset:f,arrowPadding:u,collisionBoundary:h,collisionPadding:m,sticky:v,hideWhenDetached:g,avoidCollisions:x}=xe,_=ge(xe,["__scopeSelect","position","onCloseAutoFocus","onEscapeKeyDown","onPointerDownOutside","side","sideOffset","align","alignOffset","arrowPadding","collisionBoundary","collisionPadding","sticky","hideWhenDetached","avoidCollisions"]),w=ru(yf,r),[b,N]=y.useState(null),[S,k]=y.useState(null),C=mr(t,Q=>N(Q)),[A,R]=y.useState(null),[I,O]=y.useState(null),z=L1(r),[M,B]=y.useState(!1),F=y.useRef(!1);y.useEffect(()=>{if(b)return h1(b)},[b]),u1();const U=y.useCallback(Q=>{const[oe,...ie]=z().map(J=>J.ref.current),[ee]=ie.slice(-1),G=document.activeElement;for(const J of Q)if(J===G||(J==null||J.scrollIntoView({block:"nearest"}),J===oe&&S&&(S.scrollTop=0),J===ee&&S&&(S.scrollTop=S.scrollHeight),J==null||J.focus(),document.activeElement!==G))return},[z,S]),H=y.useCallback(()=>U([A,b]),[U,A,b]);y.useEffect(()=>{M&&H()},[M,H]);const{onOpenChange:q,triggerPointerDownPosRef:K}=w;y.useEffect(()=>{if(b){let Q={x:0,y:0};const oe=ee=>{var G,J,ae,fe;Q={x:Math.abs(Math.round(ee.pageX)-((J=(G=K.current)==null?void 0:G.x)!=null?J:0)),y:Math.abs(Math.round(ee.pageY)-((fe=(ae=K.current)==null?void 0:ae.y)!=null?fe:0))}},ie=ee=>{Q.x<=10&&Q.y<=10?ee.preventDefault():b.contains(ee.target)||q(!1),document.removeEventListener("pointermove",oe),K.current=null};return K.current!==null&&(document.addEventListener("pointermove",oe),document.addEventListener("pointerup",ie,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",oe),document.removeEventListener("pointerup",ie,{capture:!0})}}},[b,q,K]),y.useEffect(()=>{const Q=()=>q(!1);return window.addEventListener("blur",Q),window.addEventListener("resize",Q),()=>{window.removeEventListener("blur",Q),window.removeEventListener("resize",Q)}},[q]);const[Z,ne]=FU(Q=>{const oe=z().filter(G=>!G.disabled),ie=oe.find(G=>G.ref.current===document.activeElement),ee=zU(oe,Q,ie);ee&&setTimeout(()=>ee.ref.current.focus())}),Y=y.useCallback((Q,oe,ie)=>{const ee=!F.current&&!ie;(w.value!==void 0&&w.value===oe||ee)&&(R(Q),ee&&(F.current=!0))},[w.value]),X=y.useCallback(()=>b==null?void 0:b.focus(),[b]),se=y.useCallback((Q,oe,ie)=>{const ee=!F.current&&!ie;(w.value!==void 0&&w.value===oe||ee)&&O(Q)},[w.value]),de=n==="popper"?I2:jU,_e=de===I2?{side:l,sideOffset:c,align:d,alignOffset:f,arrowPadding:u,collisionBoundary:h,collisionPadding:m,sticky:v,hideWhenDetached:g,avoidCollisions:x}:{};return s.jsx(wU,{scope:r,content:b,viewport:S,onViewportChange:k,itemRefCallback:Y,selectedItem:A,onItemLeave:X,itemTextRefCallback:se,focusSelectedItem:H,selectedItemText:I,position:n,isPositioned:M,searchRef:Z,children:s.jsx(Jy,{as:Rfe,allowPinchZoom:!0,children:s.jsx(Xy,{asChild:!0,trapped:w.open,onMountAutoFocus:Q=>{Q.preventDefault()},onUnmountAutoFocus:mt(a,Q=>{var oe;(oe=w.trigger)==null||oe.focus({preventScroll:!0}),Q.preventDefault()}),children:s.jsx(Cf,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:Q=>Q.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:s.jsx(de,V(D(D({role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:Q=>Q.preventDefault()},_),_e),{onPlaced:()=>B(!0),ref:C,style:D({display:"flex",flexDirection:"column",outline:"none"},_.style),onKeyDown:mt(_.onKeyDown,Q=>{const oe=Q.ctrlKey||Q.altKey||Q.metaKey;if(Q.key==="Tab"&&Q.preventDefault(),!oe&&Q.key.length===1&&ne(Q.key),["ArrowUp","ArrowDown","Home","End"].includes(Q.key)){let ee=z().filter(G=>!G.disabled).map(G=>G.ref.current);if(["ArrowUp","End"].includes(Q.key)&&(ee=ee.slice().reverse()),["ArrowUp","ArrowDown"].includes(Q.key)){const G=Q.target,J=ee.indexOf(G);ee=ee.slice(J+1)}setTimeout(()=>U(ee)),Q.preventDefault()}})}))})})})})});bU.displayName=Afe;var Ofe="SelectItemAlignedPosition",jU=y.forwardRef((e,t)=>{const C=e,{__scopeSelect:r,onPlaced:n}=C,a=ge(C,["__scopeSelect","onPlaced"]),i=ru(yf,r),o=nu(yf,r),[l,c]=y.useState(null),[d,f]=y.useState(null),u=mr(t,A=>f(A)),h=L1(r),m=y.useRef(!1),v=y.useRef(!0),{viewport:g,selectedItem:x,selectedItemText:_,focusSelectedItem:w}=o,b=y.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&d&&g&&x&&_){const A=i.trigger.getBoundingClientRect(),R=d.getBoundingClientRect(),I=i.valueNode.getBoundingClientRect(),O=_.getBoundingClientRect();if(i.dir!=="rtl"){const G=O.left-R.left,J=I.left-G,ae=A.left-J,fe=A.width+ae,we=Math.max(fe,R.width),ve=window.innerWidth-So,me=qv(J,[So,Math.max(So,ve-we)]);l.style.minWidth=fe+"px",l.style.left=me+"px"}else{const G=R.right-O.right,J=window.innerWidth-I.right-G,ae=window.innerWidth-A.right-J,fe=A.width+ae,we=Math.max(fe,R.width),ve=window.innerWidth-So,me=qv(J,[So,Math.max(So,ve-we)]);l.style.minWidth=fe+"px",l.style.right=me+"px"}const z=h(),M=window.innerHeight-So*2,B=g.scrollHeight,F=window.getComputedStyle(d),U=parseInt(F.borderTopWidth,10),H=parseInt(F.paddingTop,10),q=parseInt(F.borderBottomWidth,10),K=parseInt(F.paddingBottom,10),Z=U+H+B+K+q,ne=Math.min(x.offsetHeight*5,Z),Y=window.getComputedStyle(g),X=parseInt(Y.paddingTop,10),se=parseInt(Y.paddingBottom,10),de=A.top+A.height/2-So,_e=M-de,xe=x.offsetHeight/2,Q=x.offsetTop+xe,oe=U+H+Q,ie=Z-oe;if(oe<=de){const G=z.length>0&&x===z[z.length-1].ref.current;l.style.bottom="0px";const J=d.clientHeight-g.offsetTop-g.offsetHeight,ae=Math.max(_e,xe+(G?se:0)+J+q),fe=oe+ae;l.style.height=fe+"px"}else{const G=z.length>0&&x===z[0].ref.current;l.style.top="0px";const ae=Math.max(de,U+g.offsetTop+(G?X:0)+xe)+ie;l.style.height=ae+"px",g.scrollTop=oe-de+g.offsetTop}l.style.margin=`${So}px 0`,l.style.minHeight=ne+"px",l.style.maxHeight=M+"px",n==null||n(),requestAnimationFrame(()=>m.current=!0)}},[h,i.trigger,i.valueNode,l,d,g,x,_,i.dir,n]);xs(()=>b(),[b]);const[N,S]=y.useState();xs(()=>{d&&S(window.getComputedStyle(d).zIndex)},[d]);const k=y.useCallback(A=>{A&&v.current===!0&&(b(),w==null||w(),v.current=!1)},[b,w]);return s.jsx(Dfe,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:k,children:s.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:N},children:s.jsx(Pt.div,V(D({},a),{ref:u,style:D({boxSizing:"border-box",maxHeight:"100%"},a.style)}))})})});jU.displayName=Ofe;var Mfe="SelectPopperPosition",I2=y.forwardRef((e,t)=>{const l=e,{__scopeSelect:r,align:n="start",collisionPadding:a=So}=l,i=ge(l,["__scopeSelect","align","collisionPadding"]),o=F1(r);return s.jsx(Jb,V(D(D({},o),i),{ref:t,align:n,collisionPadding:a,style:V(D({boxSizing:"border-box"},i.style),{"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"})}))});I2.displayName=Mfe;var[Dfe,YT]=Sp(yf,{}),$2="SelectViewport",NU=y.forwardRef((e,t)=>{const d=e,{__scopeSelect:r,nonce:n}=d,a=ge(d,["__scopeSelect","nonce"]),i=nu($2,r),o=YT($2,r),l=mr(t,i.onViewportChange),c=y.useRef(0);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),s.jsx($1.Slot,{scope:r,children:s.jsx(Pt.div,V(D({"data-radix-select-viewport":"",role:"presentation"},a),{ref:l,style:D({position:"relative",flex:1,overflow:"hidden auto"},a.style),onScroll:mt(a.onScroll,f=>{const u=f.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:m}=o;if(m!=null&&m.current&&h){const v=Math.abs(c.current-u.scrollTop);if(v>0){const g=window.innerHeight-So*2,x=parseFloat(h.style.minHeight),_=parseFloat(h.style.height),w=Math.max(x,_);if(w<g){const b=w+v,N=Math.min(g,b),S=b-N;h.style.height=N+"px",h.style.bottom==="0px"&&(u.scrollTop=S>0?S:0,h.style.justifyContent="flex-end")}}}c.current=u.scrollTop})}))})]})});NU.displayName=$2;var SU="SelectGroup",[Ife,$fe]=Sp(SU),Lfe=y.forwardRef((e,t)=>{const i=e,{__scopeSelect:r}=i,n=ge(i,["__scopeSelect"]),a=Os();return s.jsx(Ife,{scope:r,id:a,children:s.jsx(Pt.div,V(D({role:"group","aria-labelledby":a},n),{ref:t}))})});Lfe.displayName=SU;var kU="SelectLabel",EU=y.forwardRef((e,t)=>{const i=e,{__scopeSelect:r}=i,n=ge(i,["__scopeSelect"]),a=$fe(kU,r);return s.jsx(Pt.div,V(D({id:a.id},n),{ref:t}))});EU.displayName=kU;var mw="SelectItem",[Ffe,CU]=Sp(mw),PU=y.forwardRef((e,t)=>{const w=e,{__scopeSelect:r,value:n,disabled:a=!1,textValue:i}=w,o=ge(w,["__scopeSelect","value","disabled","textValue"]),l=ru(mw,r),c=nu(mw,r),d=l.value===n,[f,u]=y.useState(i!=null?i:""),[h,m]=y.useState(!1),v=mr(t,b=>{var N;return(N=c.itemRefCallback)==null?void 0:N.call(c,b,n,a)}),g=Os(),x=y.useRef("touch"),_=()=>{a||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return s.jsx(Ffe,{scope:r,value:n,disabled:a,textId:g,isSelected:d,onItemTextChange:y.useCallback(b=>{u(N=>{var S;return N||((S=b==null?void 0:b.textContent)!=null?S:"").trim()})},[]),children:s.jsx($1.ItemSlot,{scope:r,value:n,disabled:a,textValue:f,children:s.jsx(Pt.div,V(D({role:"option","aria-labelledby":g,"data-highlighted":h?"":void 0,"aria-selected":d&&h,"data-state":d?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1},o),{ref:v,onFocus:mt(o.onFocus,()=>m(!0)),onBlur:mt(o.onBlur,()=>m(!1)),onClick:mt(o.onClick,()=>{x.current!=="mouse"&&_()}),onPointerUp:mt(o.onPointerUp,()=>{x.current==="mouse"&&_()}),onPointerDown:mt(o.onPointerDown,b=>{x.current=b.pointerType}),onPointerMove:mt(o.onPointerMove,b=>{var N;x.current=b.pointerType,a?(N=c.onItemLeave)==null||N.call(c):x.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:mt(o.onPointerLeave,b=>{var N;b.currentTarget===document.activeElement&&((N=c.onItemLeave)==null||N.call(c))}),onKeyDown:mt(o.onKeyDown,b=>{var S;((S=c.searchRef)==null?void 0:S.current)!==""&&b.key===" "||(Nfe.includes(b.key)&&_(),b.key===" "&&b.preventDefault())})}))})})});PU.displayName=mw;var Ug="SelectItemText",TU=y.forwardRef((e,t)=>{const _=e,{__scopeSelect:r,className:n,style:a}=_,i=ge(_,["__scopeSelect","className","style"]),o=ru(Ug,r),l=nu(Ug,r),c=CU(Ug,r),d=Cfe(Ug,r),[f,u]=y.useState(null),h=mr(t,w=>u(w),c.onItemTextChange,w=>{var b;return(b=l.itemTextRefCallback)==null?void 0:b.call(l,w,c.value,c.disabled)}),m=f==null?void 0:f.textContent,v=y.useMemo(()=>s.jsx("option",{value:c.value,disabled:c.disabled,children:m},c.value),[c.disabled,c.value,m]),{onNativeOptionAdd:g,onNativeOptionRemove:x}=d;return xs(()=>(g(v),()=>x(v)),[g,x,v]),s.jsxs(s.Fragment,{children:[s.jsx(Pt.span,V(D({id:c.textId},i),{ref:h})),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?ao.createPortal(i.children,o.valueNode):null]})});TU.displayName=Ug;var AU="SelectItemIndicator",RU=y.forwardRef((e,t)=>{const i=e,{__scopeSelect:r}=i,n=ge(i,["__scopeSelect"]);return CU(AU,r).isSelected?s.jsx(Pt.span,V(D({"aria-hidden":!0},n),{ref:t})):null});RU.displayName=AU;var L2="SelectScrollUpButton",OU=y.forwardRef((e,t)=>{const r=nu(L2,e.__scopeSelect),n=YT(L2,e.__scopeSelect),[a,i]=y.useState(!1),o=mr(t,n.onScrollButtonChange);return xs(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollTop>0;i(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?s.jsx(DU,V(D({},e),{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}})):null});OU.displayName=L2;var F2="SelectScrollDownButton",MU=y.forwardRef((e,t)=>{const r=nu(F2,e.__scopeSelect),n=YT(F2,e.__scopeSelect),[a,i]=y.useState(!1),o=mr(t,n.onScrollButtonChange);return xs(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,f=Math.ceil(c.scrollTop)<d;i(f)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?s.jsx(DU,V(D({},e),{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}})):null});MU.displayName=F2;var DU=y.forwardRef((e,t)=>{const d=e,{__scopeSelect:r,onAutoScroll:n}=d,a=ge(d,["__scopeSelect","onAutoScroll"]),i=nu("SelectScrollButton",r),o=y.useRef(null),l=L1(r),c=y.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return y.useEffect(()=>()=>c(),[c]),xs(()=>{var u;const f=l().find(h=>h.ref.current===document.activeElement);(u=f==null?void 0:f.ref.current)==null||u.scrollIntoView({block:"nearest"})},[l]),s.jsx(Pt.div,V(D({"aria-hidden":!0},a),{ref:t,style:D({flexShrink:0},a.style),onPointerDown:mt(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:mt(a.onPointerMove,()=>{var f;(f=i.onItemLeave)==null||f.call(i),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:mt(a.onPointerLeave,()=>{c()})}))}),zfe="SelectSeparator",IU=y.forwardRef((e,t)=>{const a=e,{__scopeSelect:r}=a,n=ge(a,["__scopeSelect"]);return s.jsx(Pt.div,V(D({"aria-hidden":!0},n),{ref:t}))});IU.displayName=zfe;var z2="SelectArrow",Bfe=y.forwardRef((e,t)=>{const l=e,{__scopeSelect:r}=l,n=ge(l,["__scopeSelect"]),a=F1(r),i=ru(z2,r),o=nu(z2,r);return i.open&&o.position==="popper"?s.jsx(Qb,V(D(D({},a),n),{ref:t})):null});Bfe.displayName=z2;var Ufe="SelectBubbleInput",$U=y.forwardRef((a,n)=>{var i=a,{__scopeSelect:e,value:t}=i,r=ge(i,["__scopeSelect","value"]);const o=y.useRef(null),l=mr(n,o),c=I1(t);return y.useEffect(()=>{const d=o.current;if(!d)return;const f=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(f,"value").set;if(c!==t&&h){const m=new Event("change",{bubbles:!0});h.call(d,t),d.dispatchEvent(m)}},[c,t]),s.jsx(Pt.select,V(D({},r),{style:D(D({},kF),r.style),ref:l,defaultValue:t}))});$U.displayName=Ufe;function LU(e){return e===""||e===void 0}function FU(e){const t=ys(e),r=y.useRef(""),n=y.useRef(0),a=y.useCallback(o=>{const l=r.current+o;t(l),function c(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),i=y.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return y.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,i]}function zU(e,t,r){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=qfe(e,Math.max(i,0));a.length===1&&(o=o.filter(d=>d!==r));const c=o.find(d=>d.textValue.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function qfe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var Vfe=hU,BU=pU,Wfe=vU,Hfe=yU,Gfe=xU,UU=_U,Yfe=NU,qU=EU,VU=PU,Kfe=TU,Zfe=RU,WU=OU,HU=MU,GU=IU;const aa=Vfe,ia=Wfe,Gs=y.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=ge(i,["className","children"]);return s.jsxs(BU,V(D({ref:n,className:Oe("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e)},r),{children:[t,s.jsx(Hfe,{asChild:!0,children:s.jsx(Aa,{className:"h-4 w-4 opacity-50"})})]}))});Gs.displayName=BU.displayName;const YU=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(WU,V(D({ref:r,className:Oe("flex cursor-default items-center justify-center py-1",e)},t),{children:s.jsx(Lo,{className:"h-4 w-4"})}))});YU.displayName=WU.displayName;const KU=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(HU,V(D({ref:r,className:Oe("flex cursor-default items-center justify-center py-1",e)},t),{children:s.jsx(Aa,{className:"h-4 w-4"})}))});KU.displayName=HU.displayName;const Ys=y.forwardRef((i,a)=>{var o=i,{className:e,children:t,position:r="popper"}=o,n=ge(o,["className","children","position"]);return s.jsx(Gfe,{children:s.jsxs(UU,V(D({ref:a,className:Oe("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),style:D({backgroundColor:"var(--neutral-50)",color:"var(--neutral-900)",borderColor:"var(--neutral-200)"},n.style),position:r},n),{children:[s.jsx(YU,{}),s.jsx(Yfe,{className:Oe("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),s.jsx(KU,{})]}))})});Ys.displayName=UU.displayName;const Xfe=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(qU,D({ref:r,className:Oe("py-1.5 pl-8 pr-2 text-sm font-semibold",e)},t))});Xfe.displayName=qU.displayName;const Bt=y.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=ge(i,["className","children"]);return s.jsxs(VU,V(D({ref:n,className:Oe("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),style:D({fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},r.style)},r),{children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(Zfe,{children:s.jsx(fa,{className:"h-4 w-4"})})}),s.jsx(Kfe,{children:t})]}))});Bt.displayName=VU.displayName;const Jfe=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(GU,D({ref:r,className:Oe("-mx-1 my-1 h-px bg-muted",e)},t))});Jfe.displayName=GU.displayName;class Qfe{static flagContent(t){return E(this,null,function*(){var r;try{const{data:{user:n},error:a}=yield T.auth.getUser();if(a||!n)throw new Error("User must be authenticated to flag content");const{data:i,error:o}=yield T.from("users").select("user_id").eq("user_id",n.id).maybeSingle(),l=(i==null?void 0:i.user_id)||n.id,{data:c,error:d}=yield T.from("moderation_flags").insert({flagged_by_user_id:l,content_type:t.content_type,content_id:t.content_id,flag_reason:t.flag_reason.trim(),flag_category:t.flag_category||null,additional_details:((r=t.additional_details)==null?void 0:r.trim())||null,status:"pending"}).select().single();if(d)throw d.code==="23505"?new Error("You have already flagged this content"):(console.error("Database error flagging content:",d),d);return c}catch(n){throw console.error("Error flagging content:",n),n instanceof Error?n:new Error("Failed to flag content")}})}static hasUserFlagged(t,r,n){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("moderation_flags").select("id").eq("flagged_by_user_id",t).eq("content_type",r).eq("content_id",n).maybeSingle();if(i&&i.code!=="PGRST116")throw i;return!!a}catch(a){return console.error("Error checking if user flagged content:",a),!1}})}static getFlagsForContent(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("moderation_flags").select("*").eq("content_type",t).eq("content_id",r).order("created_at",{ascending:!1});if(a)throw a;return n||[]}catch(n){return console.error("Error getting flags for content:",n),[]}})}}const ZU=({isOpen:e,onClose:t,contentType:r,contentId:n,contentTitle:a})=>{const[i,o]=y.useState(""),[l,c]=y.useState(""),[d,f]=y.useState(""),[u,h]=y.useState(!1),{toast:m}=Er(),v=[{value:"spam",label:"Spam"},{value:"harassment",label:"Harassment"},{value:"inappropriate_content",label:"Inappropriate Content"},{value:"misinformation",label:"Misinformation"},{value:"copyright_violation",label:"Copyright Violation"},{value:"fake_content",label:"Fake Content"},{value:"other",label:"Other"}],g=()=>E(void 0,null,function*(){if(!i||!l.trim()){m({title:"Missing Information",description:"Please select a category and provide a reason for flagging.",variant:"destructive"});return}h(!0);try{yield Qfe.flagContent({content_type:r,content_id:n,flag_reason:l.trim(),flag_category:i,additional_details:d.trim()||void 0}),m({title:"Content Flagged",description:"Thank you for reporting this. Our team will review it shortly."}),o(""),c(""),f(""),t()}catch(_){console.error("Error flagging content:",_),m({title:"Error",description:_.message||"Failed to flag content. Please try again.",variant:"destructive"})}finally{h(!1)}}),x={event:"Event",review:"Review",artist:"Artist",venue:"Venue"};return s.jsx(vn,{open:e,onOpenChange:t,children:s.jsxs(hn,{className:"sm:max-w-[500px]",children:[s.jsxs(Hn,{children:[s.jsxs(Sn,{className:"flex items-center gap-2",children:[s.jsx(eo,{className:"w-5 h-5 text-red-500"}),"Flag ",x[r]]}),s.jsxs(ds,{children:[a&&s.jsx("span",{className:"font-semibold",children:a}),s.jsx("br",{}),"Help us keep the community safe by reporting content that violates our guidelines."]})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"flag-category",children:"Category *"}),s.jsxs(aa,{value:i,onValueChange:o,children:[s.jsx(Gs,{id:"flag-category",children:s.jsx(ia,{placeholder:"Select a category"})}),s.jsx(Ys,{children:v.map(_=>s.jsx(Bt,{value:_.value,children:_.label},_.value))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"flag-reason",children:"Reason *"}),s.jsx(_s,{id:"flag-reason",placeholder:"Please describe why you're flagging this content...",value:l,onChange:_=>c(_.target.value),rows:4,className:"resize-none"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"additional-details",children:"Additional Details (Optional)"}),s.jsx(_s,{id:"additional-details",placeholder:"Any additional information that might help us review this...",value:d,onChange:_=>f(_.target.value),rows:3,className:"resize-none"})]})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(ce,{variant:"outline",onClick:t,disabled:u,children:"Cancel"}),s.jsx(ce,{onClick:g,disabled:u,children:u?"Submitting...":"Submit Flag"})]})]})})},ehe={threshold:.5,rootMargin:"0px",trackOnce:!0,debounce:500};function XU(e,t,r={}){const n=y.useRef(null),a=y.useRef(new Set),i=y.useRef(new Map),o=D(D({},ehe),r);return y.useEffect(()=>{const c=new IntersectionObserver(d=>{d.forEach(f=>{const u=f.target.getAttribute("data-track-id");if(u)if(f.isIntersecting){if(o.trackOnce&&a.current.has(u))return;const h=i.current.get(u);h&&clearTimeout(h);const m=setTimeout(()=>{const v=t.find(g=>g.id===u);if(v){const g=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(u);Zt.view(e,u,void 0,V(D({},v.metadata),{viewport_time:Date.now(),tracked_via:"intersection_observer_list"}),g?u:void 0),a.current.add(u)}i.current.delete(u)},o.debounce);i.current.set(u,m)}else{const h=i.current.get(u);h&&(clearTimeout(h),i.current.delete(u))}})},{threshold:o.threshold,rootMargin:o.rootMargin});return n.current=c,()=>{i.current.forEach(d=>clearTimeout(d)),i.current.clear(),c.disconnect()}},[e,t,o.threshold,o.rootMargin,o.debounce,o.trackOnce]),y.useCallback((c,d)=>{!c||!n.current||(c.setAttribute("data-track-id",d),n.current.observe(c))},[])}const ra=e=>!e||typeof e!="string"?"":e.toLowerCase().trim().replace(/\bdc\b/g,"district of columbia").replace(/\bd\.c\.\b/g,"district of columbia").replace(/\bd c\b/g,"district of columbia").replace(/\bny\b/g,"new york").replace(/\bn\.y\.\b/g,"new york").replace(/\bnyc\b/g,"new york city").replace(/\bla\b/g,"los angeles").replace(/\bl\.a\.\b/g,"los angeles").replace(/\bsf\b/g,"san francisco").replace(/\bs\.f\.\b/g,"san francisco").replace(/\bchi\b/g,"chicago").replace(/\bchi\.\b/g,"chicago").replace(/\bmia\b/g,"miami").replace(/\bmia\.\b/g,"miami").replace(/\bsea\b/g,"seattle").replace(/\bsea\.\b/g,"seattle").replace(/\bphx\b/g,"phoenix").replace(/\bphx\.\b/g,"phoenix").replace(/\bden\b/g,"denver").replace(/\bden\.\b/g,"denver").replace(/\bvegas\b/g,"las vegas").replace(/\blv\b/g,"las vegas").replace(/\bl\.v\.\b/g,"las vegas").replace(/\s+/g," ").replace(/[^\w\s]/g,"").trim(),JU=e=>{const t=e.map(r=>ra(r));if(t.some(r=>r.includes("washington")&&r.includes("district of columbia"))){const r=e.find(n=>n.toLowerCase().includes("washington")&&(n.toLowerCase().includes("dc")||n.toLowerCase().includes("d.c.")||n.toLowerCase().includes("d c")));if(r)return r}if(t.some(r=>r.includes("new york"))){const r=e.find(a=>a.toLowerCase().includes("nyc"));if(r)return r;const n=e.find(a=>a.toLowerCase().includes("new york"));if(n)return n}if(t.some(r=>r.includes("los angeles"))){const r=e.find(n=>n.toLowerCase().includes("los angeles"));if(r)return r}return e.sort((r,n)=>r.length!==n.length?r.length-n.length:r.localeCompare(n))[0]},Oh=e=>{if(!e||e.length===0)return[];const t=new Map;e.forEach(a=>{if(!a||typeof a!="string")return;const i=ra(a);i&&(t.has(i)||t.set(i,[]),t.get(i).push(a))});const r=[];return t.forEach((a,i)=>{const o=JU(a);r.push(o)}),r.some(a=>ra(a).includes("washington")&&(a.toLowerCase().includes("dc")||a.toLowerCase().includes("d.c")))?r.filter(a=>!(ra(a).includes("washington")&&!a.toLowerCase().includes("dc")&&!a.toLowerCase().includes("d.c"))):r},g_=e=>{if(!e||typeof e!="string")return"";const t=e.trim(),r={sea:"Seattle",den:"Denver",nyc:"New York",ny:"New York",la:"Los Angeles",sf:"San Francisco",chi:"Chicago",mia:"Miami",phx:"Phoenix",lv:"Las Vegas",vegas:"Las Vegas",dc:"Washington DC","d.c.":"Washington DC","d c":"Washington DC",washington:"Washington DC"},n=t.toLowerCase();if(r[n])return r[n];const a=t.match(/^(.+?),\s*([A-Z]{2})$/);return a?a[1].trim():t.split(" ").map(i=>i.charAt(0).toUpperCase()+i.slice(1).toLowerCase()).join(" ")},t4=Object.freeze(Object.defineProperty({__proto__:null,deduplicateCities:Oh,formatCityNameForDisplay:g_,getCanonicalCityName:JU,normalizeCityName:ra},Symbol.toStringTag,{value:"Module"})),r4=50;new Date(0).toISOString();class em{static getPersonalizedFeedV3(t,r=50,n=0,a){return E(this,null,function*(){var c,d,f,u,h;const i=typeof performance!="undefined"?performance.now():Date.now(),o=yield this.normalizeFilters(a),l={p_user_id:t,p_limit:r,p_offset:n,p_city_lat:(d=(c=o.cityCoordinates)==null?void 0:c.lat)!=null?d:null,p_city_lng:(u=(f=o.cityCoordinates)==null?void 0:f.lng)!=null?u:null,p_radius_miles:o.radiusMiles};try{console.log(" Calling get_personalized_feed_v3 with payload:",l);const{data:m,error:v}=yield T.rpc("get_personalized_feed_v3",l);if(v)throw v.code==="42P01"||v.code==="PGRST204"||v.code==="PGRST116"||(h=v.message)!=null&&h.includes("does not exist")?(console.warn(" get_personalized_feed_v3 RPC function not found"),v):(console.error(" get_personalized_feed_v3 error:",{code:v.code,message:v.message,details:v.details,hint:v.hint,error:v}),v);const g=(m!=null?m:[]).map(w=>({id:String(w.id),type:w.type,score:Number(w.score)||0,payload:w.payload||{},context:w.context||{},created_at:w.created_at||new Date().toISOString()})),_=(typeof performance!="undefined"?performance.now():Date.now())-i;return console.log(" Unified feed v3 (RPC):",{userId:t,itemCount:g.length,types:g.reduce((w,b)=>(w[b.type]=(w[b.type]||0)+1,w),{}),loadTimeMs:Math.round(_)}),{items:g,has_more:g.length===r}}catch(m){throw console.error(" get_personalized_feed_v3 exception:",m),m}})}static getPersonalizedFeed(t,r=50,n=0,a=!1,i){return E(this,null,function*(){var u,h,m,v,g,x,_,w,b,N,S,k,C,A,R,I,O,z;const o=typeof performance!="undefined"?performance.now():Date.now(),l=yield this.normalizeFilters(i),c=n===0&&!a,d=c?`personalized_feed_${t}_${r}_${(u=l.cityCoordinates)==null?void 0:u.lat}_${(h=l.cityCoordinates)==null?void 0:h.lng}_${(m=l.genres)==null?void 0:m.join(",")}_${l.followingOnly}`:null;if(c&&d){const M=Fo.get(d);if(M)return jn.log(" Personalized feed (cached):",{count:M.length,userId:t}),M}const f={p_user_id:t,p_limit:r,p_offset:n,p_city_lat:(g=(v=l.cityCoordinates)==null?void 0:v.lat)!=null?g:null,p_city_lng:(_=(x=l.cityCoordinates)==null?void 0:x.lng)!=null?_:null,p_radius_miles:(w=l.radiusMiles)!=null?w:50};try{jn.debug(" Calling get_personalized_feed_v3 with payload:",f);const{data:M,error:B}=yield T.rpc("get_personalized_feed_v3",f);if(B)return B.code==="42P01"||B.code==="PGRST204"||B.code==="PGRST116"||(b=B.message)!=null&&b.includes("does not exist")||(N=B.message)!=null&&N.includes("Could not find the function")?(jn.warn(" get_personalized_feed_v3 RPC function not found, using fallback feed"),this.getFallbackFeed(t,r,n,a,l)):B.code==="400"||B.code==="PGRST202"?(jn.error(" get_personalized_feed_v3 parameter/signature mismatch:",{code:B.code,message:B.message,hint:B.hint,payload:f}),jn.warn(" Falling back to basic feed due to function signature mismatch"),this.getFallbackFeed(t,r,n,a,l)):(jn.error(" get_personalized_feed_v3 error:",B),this.getFallbackFeed(t,r,n,a,l));const F=(M!=null?M:[]).filter(Z=>Z.type==="event").map(Z=>{var Y,X,se,de,_e,xe,Q,oe,ie,ee,G,J,ae,fe,we,ve,me,Me,Te,Ve,le,Ke,De,nt,ze,vt,rr,sr,Ae,Ue;const ne=Z.payload||{};return{event_id:ne.event_id||Z.id||"",title:(Y=ne.title)!=null?Y:null,artist_name:(X=ne.artist_name)!=null?X:null,artist_id:(se=ne.artist_id)!=null?se:null,artist_uuid:(de=ne.artist_uuid)!=null?de:null,venue_name:(_e=ne.venue_name)!=null?_e:null,venue_id:(xe=ne.venue_id)!=null?xe:null,venue_uuid:(Q=ne.venue_uuid)!=null?Q:null,venue_city:(oe=ne.venue_city)!=null?oe:null,venue_state:(ie=ne.venue_state)!=null?ie:null,venue_address:(ee=ne.venue_address)!=null?ee:null,venue_zip:(G=ne.venue_zip)!=null?G:null,event_date:ne.event_date,doors_time:(J=ne.doors_time)!=null?J:null,description:(ae=ne.description)!=null?ae:null,genres:Array.isArray(ne.genres)?ne.genres:[],latitude:(fe=ne.latitude)!=null?fe:null,longitude:(we=ne.longitude)!=null?we:null,ticket_urls:Array.isArray(ne.ticket_urls)?ne.ticket_urls:[],ticket_available:(ve=ne.ticket_available)!=null?ve:null,price_range:(me=ne.price_range)!=null?me:null,ticket_price_min:(Me=ne.ticket_price_min)!=null?Me:null,ticket_price_max:(Te=ne.ticket_price_max)!=null?Te:null,relevance_score:(Ve=Z.score)!=null?Ve:null,friend_interest_count:(le=ne.friend_interest_count)!=null?le:null,total_interest_count:(Ke=ne.interested_count)!=null?Ke:null,is_promoted:(De=ne.is_promoted)!=null?De:null,promotion_tier:(nt=ne.promotion_tier)!=null?nt:null,distance_miles:(ze=ne.distance_miles)!=null?ze:null,poster_image_url:(vt=ne.poster_image_url)!=null?vt:null,event_media_url:(rr=ne.event_media_url)!=null?rr:null,images:(sr=ne.images)!=null?sr:null,created_at:(Ae=Z.created_at)!=null?Ae:null,updated_at:(Ue=ne.updated_at)!=null?Ue:null}});jn.debug(" RPC v3 response (events only):",{rawDataCount:(S=M==null?void 0:M.length)!=null?S:0,eventCount:F.length,sampleEvent:F[0]?{title:F[0].title,venue_city:F[0].venue_city,event_date:F[0].event_date,genres:F[0].genres,event_date_parsed:F[0].event_date?new Date(F[0].event_date).toISOString():null,isPast:F[0].event_date?new Date(F[0].event_date).getTime()<Date.now():null}:null,filters:l.debugSummary,allEventTypes:(M==null?void 0:M.map(Z=>Z.type))||[],cityCoordinates:l.cityCoordinates,cleanedCities:l.cleanedCities,originalCities:l.originalCities});const U=this.applyClientSideFilters(F,l,a);jn.debug(" After client-side filtering:",{filteredCount:U.length,removedCount:F.length-U.length,sampleRemoved:F.length>U.length&&F[0]?{title:F[0].title,event_date:F[0].event_date,venue_city:F[0].venue_city,genres:F[0].genres}:null});const H=U.map(Z=>this.mapRowToEvent(Z));if(U.length===0&&n===0){const Z=F.slice(0,3).map(ne=>{const Y=ne.event_date?new Date(ne.event_date):null,X=l.dateStart,se=l.dateEnd;let de=null;if((X||se)&&Y){const _e=Y.getUTCFullYear(),xe=Y.getUTCMonth(),Q=Y.getUTCDate();if(X){const oe=new Date(X),ie=oe.getUTCFullYear(),ee=oe.getUTCMonth(),G=oe.getUTCDate();de=V(D({},de),{beforeStart:_e<ie||_e===ie&&xe<ee||_e===ie&&xe===ee&&Q<G,startDate:`${ie}-${String(ee+1).padStart(2,"0")}-${String(G).padStart(2,"0")}`})}if(se){const oe=new Date(se),ie=oe.getUTCFullYear(),ee=oe.getUTCMonth(),G=oe.getUTCDate();de=V(D({},de),{afterEnd:_e>ie||_e===ie&&xe>ee||_e===ie&&xe===ee&&Q>G,endDate:`${ie}-${String(ee+1).padStart(2,"0")}-${String(G).padStart(2,"0")}`,eventDate:`${_e}-${String(xe+1).padStart(2,"0")}-${String(Q).padStart(2,"0")}`})}}return{title:ne.title,event_date:ne.event_date,event_date_parsed:Y==null?void 0:Y.toISOString(),venue_city:ne.venue_city,genres:ne.genres,isPast:Y?Y.getTime()<Date.now():null,dateRangeCheck:de}});return jn.warn(" RPC returned no events at offset 0  falling back to basic feed.",{rawDataCount:(k=M==null?void 0:M.length)!=null?k:0,mappedRowsCount:F.length,filteredCount:U.length,sampleEvents:Z,activeFilters:{includePast:a,hasCityFilter:!l.cityCoordinates&&!!((C=l.cleanedCities)!=null&&C.length||(A=l.originalCities)!=null&&A.length),hasCityCoordinates:!!l.cityCoordinates,hasGenreFilter:!!((R=l.genres)!=null&&R.length),hasDateRange:!!(l.dateStart||l.dateEnd),dateRange:l.dateStart||l.dateEnd?{start:(I=l.dateStart)==null?void 0:I.toISOString(),end:(O=l.dateEnd)==null?void 0:O.toISOString()}:null,hasDaysOfWeek:!!((z=l.daysOfWeek)!=null&&z.length)}}),this.getFallbackFeed(t,r,n,a,l)}const K=(typeof performance!="undefined"?performance.now():Date.now())-o;return c&&d&&Fo.set(d,H,Bv.REVIEWS),jn.log(" Personalized feed (RPC):",{userId:t,count:H.length,limit:r,offset:n,loadTimeMs:Math.round(K),cached:c&&!!d}),H}catch(M){return jn.error(" get_personalized_feed_v2 exception:",M),this.getFallbackFeed(t,r,n,a,l)}})}static getFallbackFeed(t,r,n,a,i){return E(this,null,function*(){var o,l,c,d;try{let f=T.from("events").select("*").order("event_date",{ascending:!0}).range(n,n+r-1);if(a||(f=f.gte("event_date",new Date().toISOString())),(o=i.genres)!=null&&o.length&&(f=f.overlaps("genres",i.genres)),i.cleanedCities&&i.cleanedCities.length>0){const g=[];i.cleanedCities.forEach(x=>{g.push(`venue_city.ilike.%${x}%`),(x.includes("washington")||x.includes("district"))&&(g.push("venue_city.ilike.%Washington%"),g.push("venue_city.ilike.%DC%"),g.push("venue_city.ilike.%D.C%"))}),g.length>0&&(f=f.or(g.join(",")))}else if(i.originalCities&&i.originalCities.length>0){const g=[];i.originalCities.forEach(x=>{var w;const _=(w=x.split(",")[0])==null?void 0:w.trim();_&&g.push(`venue_city.ilike.%${_}%`)}),g.length>0&&(f=f.or(g.join(",")))}i.dateStartIso&&(f=f.gte("event_date",i.dateStartIso)),i.dateEndIso&&(f=f.lte("event_date",i.dateEndIso));const{data:u,error:h}=yield f;if(h)return jn.error(" Fallback feed query error:",h),[];let m=(u!=null?u:[]).map(g=>{var x,_,w,b,N,S,k;return{event_id:g.id,title:g.title,artist_name:g.artist_name,artist_id:g.artist_id,artist_uuid:(x=g.artist_uuid)!=null?x:null,venue_name:g.venue_name,venue_id:g.venue_id,venue_city:g.venue_city,venue_state:g.venue_state,venue_address:g.venue_address,venue_zip:g.venue_zip,event_date:g.event_date,doors_time:g.doors_time,description:g.description,genres:g.genres,latitude:g.latitude,longitude:g.longitude,ticket_urls:g.ticket_urls,ticket_available:g.ticket_available,price_range:g.price_range,ticket_price_min:(_=g.ticket_price_min)!=null?_:g.price_min,ticket_price_max:(w=g.ticket_price_max)!=null?w:g.price_max,relevance_score:0,friend_interest_count:0,total_interest_count:0,is_promoted:(b=g.is_promoted)!=null?b:!1,promotion_tier:(N=g.promotion_tier)!=null?N:null,distance_miles:null,poster_image_url:(S=g.poster_image_url)!=null?S:null,images:(k=g.images)!=null?k:null,created_at:g.created_at,updated_at:g.updated_at}});if(((l=i.cityCoordinates)==null?void 0:l.lat)!==void 0&&((c=i.cityCoordinates)==null?void 0:c.lng)!==void 0){const{lat:g,lng:x}=i.cityCoordinates,_=(d=i.radiusMiles)!=null?d:r4;m=m.map(w=>{var N;if(w.latitude==null||w.longitude==null)return w;const b=this.calculateDistanceMiles(typeof w.latitude=="string"?Number(w.latitude):w.latitude,typeof w.longitude=="string"?Number(w.longitude):w.longitude,g,x);return V(D({},w),{distance_miles:Number.isFinite(b)?b:(N=w.distance_miles)!=null?N:null})}).filter(w=>{if(w.distance_miles==null)return!0;const b=typeof w.distance_miles=="string"?Number(w.distance_miles):w.distance_miles;return Number.isFinite(b)?b<=_:!0})}let v=this.applyClientSideFilters(m,i,a);if(i.followingOnly){const{followedUuidSet:g,followedJambaseSet:x,followedNameSet:_}=yield this.getFollowedArtistIdentifiers(t);if(g.size===0&&x.size===0&&_.size===0)return[];v=v.filter(w=>{const b=w.artist_uuid?String(w.artist_uuid).toLowerCase():null,N=w.artist_id?String(w.artist_id).toLowerCase():null,S=w.artist_name?w.artist_name.toLowerCase().trim():null;return!!(b&&g.has(b)||N&&x.has(N)||S&&_.has(S))})}return v.map(g=>this.mapRowToEvent(g))}catch(f){return jn.error(" Fallback feed exception:",f),[]}})}static getFollowedArtistIdentifiers(t){return E(this,null,function*(){const r=new Set,n=new Set,a=new Set;try{const{data:i,error:o}=yield T.from("artist_follows").select("artist_id").eq("user_id",t);if(o)return jn.warn(" Unable to load artist_follows for fallback filter:",o),{followedUuidSet:r,followedJambaseSet:n,followedNameSet:a};const l=(i!=null?i:[]).map(c=>c.artist_id?String(c.artist_id):null).filter(c=>!!c);if(l.forEach(c=>r.add(c.toLowerCase())),l.length>0){const{data:c,error:d}=yield T.from("artists_with_external_ids").select("id, jambase_artist_id, name").in("id",l);if(d)jn.warn(" Unable to load artists for fallback filter:",d);else for(const f of c!=null?c:[])f.jambase_artist_id&&n.add(String(f.jambase_artist_id).toLowerCase()),f.name&&a.add(String(f.name).toLowerCase().trim())}}catch(i){}return{followedUuidSet:r,followedJambaseSet:n,followedNameSet:a}})}static getUserMusicProfile(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("get_user_music_profile_summary",{p_user_id:t});if(n)throw n;return!r||typeof r!="object"?null:r}catch(r){return jn.error(" Error fetching music profile:",r),null}})}static getUserTopGenres(t,r=10){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("get_user_top_genres",{p_user_id:t,p_limit:r});if(a)throw a;return Array.isArray(n)?n:[]}catch(n){return jn.error(" Error fetching top genres:",n),[]}})}static getUserTopArtists(t,r=20){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("get_user_top_artists",{p_user_id:t,p_limit:r});if(a)throw a;return Array.isArray(n)?n:[]}catch(n){return jn.error(" Error fetching top artists:",n),[]}})}static userHasMusicData(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_preferences").select("music_preference_signals").eq("user_id",t).maybeSingle();if(n)throw n;const a=(r==null?void 0:r.music_preference_signals)||[];return Array.isArray(a)&&a.length>0}catch(r){return jn.error(" Error checking music data:",r),!1}})}static getEventRelevanceScore(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("calculate_event_relevance_score",{p_user_id:t,p_event_id:r});if(a)throw a;return n||0}catch(n){return jn.error(" Error calculating relevance:",n),0}})}static mapRowToEvent(t){var l,c,d,f,u,h,m,v,g,x,_,w,b,N,S,k,C,A,R,I,O,z,M,B;const r=new Date().toISOString(),n=t.latitude!==null&&t.latitude!==void 0?Number(t.latitude):null,a=t.longitude!==null&&t.longitude!==void 0?Number(t.longitude):null,i=t.distance_miles!==null&&t.distance_miles!==void 0?Number(t.distance_miles):null,o=Array.isArray(t.ticket_urls)?t.ticket_urls:[];return{id:t.event_id,jambase_event_id:t.event_id,title:(l=t.title)!=null?l:"Untitled Event",artist_name:(c=t.artist_name)!=null?c:"Unknown Artist",artist_id:(d=t.artist_id)!=null?d:null,venue_name:(f=t.venue_name)!=null?f:"Unknown Venue",venue_id:(u=t.venue_id)!=null?u:null,venue_city:(h=t.venue_city)!=null?h:null,venue_state:(m=t.venue_state)!=null?m:null,venue_address:(v=t.venue_address)!=null?v:null,venue_zip:(g=t.venue_zip)!=null?g:null,event_date:t.event_date,doors_time:(x=t.doors_time)!=null?x:null,description:(_=t.description)!=null?_:null,genres:(w=t.genres)!=null?w:[],latitude:n,longitude:a,ticket_urls:o,ticket_available:(b=t.ticket_available)!=null?b:o.length>0,price_range:(N=t.price_range)!=null?N:null,ticket_price_min:t.ticket_price_min!==void 0&&t.ticket_price_min!==null?Number(t.ticket_price_min):null,ticket_price_max:t.ticket_price_max!==void 0&&t.ticket_price_max!==null?Number(t.ticket_price_max):null,ticket_url:o.length>0?o[0]:null,setlist:null,setlist_enriched:!1,setlist_song_count:null,setlist_fm_id:null,setlist_fm_url:null,setlist_source:null,setlist_last_updated:null,tour_name:null,created_at:(S=t.created_at)!=null?S:r,updated_at:(k=t.updated_at)!=null?k:r,relevance_score:(C=t.relevance_score)!=null?C:0,user_is_interested:void 0,interested_count:(A=t.total_interest_count)!=null?A:0,friends_interested_count:(R=t.friend_interest_count)!=null?R:0,artist_frequency_rank:void 0,diversity_penalty:void 0,is_promoted:(I=t.is_promoted)!=null?I:!1,promotion_tier:t.promotion_tier==="basic"||t.promotion_tier==="premium"||t.promotion_tier==="featured"?t.promotion_tier:null,active_promotion_id:null,distance_miles:i,poster_image_url:(O=t.poster_image_url)!=null?O:null,event_media_url:(M=(z=t.event_media_url)!=null?z:t.event_media_url)!=null?M:null,images:(B=t.images)!=null?B:null}}static normalizeFilters(t){return E(this,null,function*(){var h,m,v,g,x,_,w,b,N,S,k;const r=(m=(h=t==null?void 0:t.selectedCities)==null?void 0:h.map(C=>{var A;return(A=C.split(",")[0])==null?void 0:A.trim()}).filter(Boolean).map(C=>ra(C||"")))!=null?m:void 0,n=(g=(v=t==null?void 0:t.city)!=null?v:r==null?void 0:r[0])!=null?g:null,a=n?ra(n):null,i=t!=null&&t.genres&&t.genres.length>0?t.genres:void 0,o=t!=null&&t.daysOfWeek&&t.daysOfWeek.length>0?t.daysOfWeek:void 0,l=(t==null?void 0:t.filterByFollowing)==="following",c=(x=t==null?void 0:t.dateRange)==null?void 0:x.from,d=(_=t==null?void 0:t.dateRange)==null?void 0:_.to,f=(w=t==null?void 0:t.radiusMiles)!=null?w:r4;let u=null;if(n)try{const{RadiusSearchService:C}=yield Rr(()=>E(this,null,function*(){const{RadiusSearchService:A}=yield Promise.resolve().then(()=>V2);return{RadiusSearchService:A}}),void 0,import.meta.url);u=yield C.getCityCoordinates(n),u?jn.log(` Found coordinates for "${n}":`,u):jn.warn(` No coordinates found for city: "${n}"`)}catch(C){jn.error("Error looking up city coordinates:",C)}return{genres:i,cleanedCities:r,originalCities:(b=t==null?void 0:t.selectedCities)!=null?b:[],city:a,cityCoordinates:u,radiusMiles:f,dateStartIso:c?c.toISOString():void 0,dateEndIso:d?d.toISOString():void 0,dateStart:c,dateEnd:d,daysOfWeek:o,followingOnly:l,debugSummary:{city:a,radius:f,genres:(N=i==null?void 0:i.length)!=null?N:0,citiesSelected:(S=r==null?void 0:r.length)!=null?S:0,daysOfWeek:(k=o==null?void 0:o.length)!=null?k:0,followingOnly:l}}})}static applyClientSideFilters(t,r,n){var l;let a=t;const i=t.length;if(!n&&!r.cityCoordinates&&!r.dateStart&&!r.dateEnd){const c=Date.now(),d=a.length;a=a.filter(f=>{if(!f.event_date)return!0;const u=Date.parse(f.event_date);return Number.isNaN(u)?!0:u>=c}),a.length<d&&jn.debug(` Date filter removed ${d-a.length} past events`)}if(!r.cityCoordinates){const c=r.cleanedCities&&r.cleanedCities.length>0?r.cleanedCities:r.originalCities&&r.originalCities.length>0?r.originalCities:void 0;if(c&&c.length>0){const d=h=>ra(h||"").replace(/\s+/g," ").trim(),f=new Set(c.map(d)),u=a.length;a=a.filter(h=>{const m=h.venue_city?d(h.venue_city):"",v=f.has(m);return!v&&u>0&&jn.debug(` City filter removing event: "${h.title}" (city: "${h.venue_city}" -> normalized: "${m}", allowed: ${Array.from(f).join(", ")})`),v}),a.length<u&&jn.debug(` City filter removed ${u-a.length} events (allowed cities: ${Array.from(f).join(", ")})`)}}if(r.genres&&r.genres.length>0){const c=new Set(r.genres.map(f=>f.toLowerCase())),d=a.length;a=a.filter(f=>!f.genres||f.genres.length===0?!1:f.genres.some(u=>c.has(u.toLowerCase()))),a.length<d&&jn.debug(` Genre filter removed ${d-a.length} events`)}if((r.dateStart||r.dateEnd)&&!r.cityCoordinates){const c=a.length,d=r.dateStart?new Date(r.dateStart):null;d&&d.setUTCHours(0,0,0,0);const f=r.dateEnd?new Date(r.dateEnd):null;f&&f.setUTCHours(23,59,59,999),a=a.filter(u=>{if(!u.event_date)return!0;const h=Date.parse(u.event_date);if(Number.isNaN(h))return!0;const m=new Date(h);return!(d&&m.getTime()<d.getTime()||f&&m.getTime()>f.getTime())}),a.length<c&&jn.debug(` Date range filter removed ${c-a.length} events`)}if((l=r.daysOfWeek)!=null&&l.length){const c=new Set(r.daysOfWeek),d=a.length;a=a.filter(f=>{if(!f.event_date)return!0;const u=new Date(f.event_date);return Number.isNaN(u.getTime())?!0:c.has(u.getDay())}),a.length<d&&jn.debug(` Days of week filter removed ${d-a.length} events`)}return a.length<i&&jn.debug(` Client-side filters: ${i}  ${a.length} events (removed ${i-a.length})`),a}static calculateDistanceMiles(t,r,n,a){const o=u=>u*(Math.PI/180),l=o(n-t),c=o(a-r),d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(o(t))*Math.cos(o(n))*Math.sin(c/2)*Math.sin(c/2);return 3959*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}static mapRpcRowToFeedRow(t){var n,a,i,o,l,c,d,f,u,h,m,v,g,x,_,w,b,N,S,k,C,A,R,I,O,z,M,B,F,U,H,q,K;const r=Array.isArray(t.ticket_urls)?t.ticket_urls:t.ticket_url?[t.ticket_url]:[];return{event_id:String((a=(n=t.event_id)!=null?n:t.id)!=null?a:""),title:(i=t.title)!=null?i:null,artist_name:(o=t.artist_name)!=null?o:null,artist_id:(l=t.artist_id)!=null?l:null,artist_uuid:(c=t.artist_uuid)!=null?c:null,venue_name:(d=t.venue_name)!=null?d:null,venue_id:(f=t.venue_id)!=null?f:null,venue_uuid:(u=t.venue_uuid)!=null?u:null,venue_city:(h=t.venue_city)!=null?h:null,venue_state:(m=t.venue_state)!=null?m:null,venue_address:(v=t.venue_address)!=null?v:null,venue_zip:(g=t.venue_zip)!=null?g:null,event_date:t.event_date,doors_time:(x=t.doors_time)!=null?x:null,description:(_=t.description)!=null?_:null,genres:Array.isArray(t.genres)?t.genres:[],latitude:(w=t.latitude)!=null?w:null,longitude:(b=t.longitude)!=null?b:null,ticket_urls:r,ticket_available:(S=t.ticket_available)!=null?S:r.length>0?!0:(N=t.ticket_available)!=null?N:null,price_range:(k=t.price_range)!=null?k:null,ticket_price_min:(C=t.ticket_price_min)!=null?C:null,ticket_price_max:(A=t.ticket_price_max)!=null?A:null,relevance_score:(R=t.relevance_score)!=null?R:null,friend_interest_count:(O=(I=t.friend_interest_count)!=null?I:t.friends_interested_count)!=null?O:null,total_interest_count:(M=(z=t.total_interest_count)!=null?z:t.interested_count)!=null?M:null,is_promoted:(B=t.is_promoted)!=null?B:null,promotion_tier:(F=t.promotion_tier)!=null?F:null,distance_miles:(U=t.distance_miles)!=null?U:null,poster_image_url:(H=t.poster_image_url)!=null?H:null,created_at:(q=t.created_at)!=null?q:null,updated_at:(K=t.updated_at)!=null?K:null}}}class n4{static getFriendsReviews(t,r=20,n=0){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(i)throw i;if(!a||a.length===0)return[];const o=a.map(d=>d.user_id===t?d.related_user_id:d.user_id),{data:l,error:c}=yield T.from("reviews").select(`
          *,
          user:users!reviews_user_id_fkey (
            name,
            avatar_url,
            verified,
            account_type
          ),
          events (
            id,
            title,
            venue_name,
            event_date,
            artist_name,
            artist_id
          )
        `).in("user_id",o).eq("is_public",!0).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).range(n,n+r-1);if(c)throw c;return(l||[]).map(d=>{var u,h,m;const f=d.events;return{id:`friends-review-${d.id}`,type:"review",review_id:d.id,title:`${((u=d.user)==null?void 0:u.name)||"Friend"}'s Review`,content:d.review_text||"",author:{id:d.user_id,name:((h=d.user)==null?void 0:h.name)||"Anonymous",avatar_url:(m=d.user)==null?void 0:m.avatar_url},created_at:d.created_at,updated_at:d.updated_at,rating:d.rating,is_public:!0,photos:d.photos||void 0,setlist:d.setlist||void 0,likes_count:d.likes_count||0,comments_count:d.comments_count||0,shares_count:d.shares_count||0,artist_performance_rating:d.artist_performance_rating,production_rating:d.production_rating,venue_rating:d.venue_rating,location_rating:d.location_rating,value_rating:d.value_rating,artist_performance_feedback:d.artist_performance_feedback,production_feedback:d.production_feedback,venue_feedback:d.venue_feedback,location_feedback:d.location_feedback,value_feedback:d.value_feedback,event_info:{event_name:(f==null?void 0:f.title)||"Concert Review",venue_name:(f==null?void 0:f.venue_name)||"Unknown Venue",event_date:(f==null?void 0:f.event_date)||d.created_at,artist_name:f==null?void 0:f.artist_name,artist_id:f==null?void 0:f.artist_id},relevance_score:this.calculateFriendReviewRelevance(d,1)}})}catch(a){return console.error("Error fetching friends reviews:",a),[]}})}static getFriendsPlusOneReviews(t,r=20,n=0){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(i)throw i;if(!a||a.length===0)return[];const o=a.map(m=>m.user_id===t?m.related_user_id:m.user_id),{data:l,error:c}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").in("user_id",o);if(c)throw c;const d=(l||[]).map(m=>m.user_id===t?m.related_user_id:m.user_id).filter(m=>!o.includes(m)&&m!==t),f=[...o,...d];if(f.length===0)return[];const{data:u,error:h}=yield T.from("reviews").select(`
          *,
          user:users!reviews_user_id_fkey (
            name,
            avatar_url,
            verified,
            account_type
          ),
          events (
            id,
            title,
            venue_name,
            event_date,
            artist_name,
            artist_id
          )
        `).in("user_id",f).eq("is_public",!0).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).range(n,n+r-1);if(h)throw h;return(u||[]).map(m=>{var _,w,b;const g=o.includes(m.user_id)?1:2,x=m.events;return{id:`friends-plus-one-review-${m.id}`,type:"review",review_id:m.id,title:`${((_=m.user)==null?void 0:_.name)||"Friend"}'s Review`,content:m.review_text||"",author:{id:m.user_id,name:((w=m.profiles)==null?void 0:w.name)||"Anonymous",avatar_url:(b=m.profiles)==null?void 0:b.avatar_url},created_at:m.created_at,updated_at:m.updated_at,rating:m.rating,is_public:!0,photos:m.photos||void 0,setlist:m.setlist||void 0,likes_count:m.likes_count||0,comments_count:m.comments_count||0,shares_count:m.shares_count||0,event_info:{event_name:(x==null?void 0:x.title)||"Concert Review",venue_name:(x==null?void 0:x.venue_name)||"Unknown Venue",event_date:(x==null?void 0:x.event_date)||m.created_at,artist_name:x==null?void 0:x.artist_name,artist_id:x==null?void 0:x.artist_id},relevance_score:this.calculateFriendReviewRelevance(m,g)}})}catch(a){return console.error("Error fetching friends plus one reviews:",a),[]}})}static getFriendActivity(t,r=10){return E(this,null,function*(){try{const n=yield this.getFriendsReviews(t,Math.floor(r*.7),0),{data:a,error:i}=yield T.from("notifications").select("id, type, title, message, data, created_at").eq("user_id",t).in("type",["friend_accepted"]).order("created_at",{ascending:!1}).limit(5);if(i)return console.error("Error fetching friend notifications:",i),n.slice(0,r);const o=[...n];return a&&a.length>0&&a.forEach(l=>{o.push({id:`friend-activity-${l.id}`,type:"friend_activity",title:l.title,content:l.message,author:{id:"system",name:"Synth",avatar_url:void 0},created_at:l.created_at,relevance_score:.8})}),o.slice(0,r)}catch(n){return console.error("Error fetching friend activity:",n),[]}})}static calculateFriendReviewRelevance(t,r){let n=.5;r===1?n+=.4:r===2&&(n+=.2);const a=Math.floor((Date.now()-new Date(t.created_at).getTime())/(1e3*60*60*24));return a<=7?n+=.2:a<=30&&(n+=.1),t.review_text&&t.review_text.length>50&&(n+=.1),t.photos&&t.photos.length>0&&(n+=.1),t.rating>=4&&(n+=.1),Math.min(n,1)}static getFriendCount(t){return E(this,null,function*(){try{const{count:r,error:n}=yield T.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(n)throw n;return r||0}catch(r){return console.error("Error getting friend count:",r),0}})}static areFriends(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("user_relationships").select("id").eq("relationship_type","friend").eq("status","accepted").or(`and(user_id.eq.${t},related_user_id.eq.${r}),and(user_id.eq.${r},related_user_id.eq.${t})`).single();if(a&&a.code!=="PGRST116")throw a;return!!n}catch(n){return console.error("Error checking friendship:",n),!1}})}static getConnectionDegreeReviews(t,r=20,n=0){return E(this,null,function*(){try{if(n===0){const l=N2.reviews(t,r,n),c=Fo.get(l);if(c)return c}const{data:a,error:i}=yield T.rpc("get_connection_degree_reviews",{p_user_id:t,p_limit:r,p_offset:n});if(i){console.warn(" RPC function get_connection_degree_reviews failed, using direct query with connection functions"),console.warn("Error details:",{code:i.code,message:i.message,details:i.details});try{const[l,c]=yield Promise.all([T.rpc("get_first_degree_connections",{target_user_id:t}),T.rpc("get_second_degree_connections",{target_user_id:t})]),d=(l.data||[]).map(v=>v.connected_user_id),f=(c.data||[]).map(v=>v.connected_user_id),u=[...d,...f];if(u.length===0)return[];const{data:h,error:m}=yield T.from("reviews").select(`
              *,
              users:user_id (
                user_id,
                name,
                avatar_url,
                verified,
                account_type
              ),
              events (
                id,
                title,
                venue_name,
                event_date,
                artist_name
              )
            `).in("user_id",u).eq("is_public",!0).eq("is_draft",!1).not("review_text","is",null).order("created_at",{ascending:!1}).range(n,n+r-1);return m?(console.warn("Direct reviews query failed, returning empty array:",m),[]):(h||[]).map(v=>{const g=d.includes(v.user_id)?1:2,x=v.users||{},_=v.events||{};return{id:`review-${v.id}`,type:"review",review_id:v.id,title:`${x.name||"User"}'s Review`,content:v.review_text||"",author:{id:v.user_id,name:x.name||"Anonymous",avatar_url:x.avatar_url,verified:x.verified,account_type:x.account_type},created_at:v.created_at,updated_at:v.updated_at,rating:v.rating,is_public:v.is_public,photos:v.photos||void 0,setlist:v.setlist||void 0,likes_count:v.likes_count||0,comments_count:v.comments_count||0,shares_count:v.shares_count||0,artist_performance_rating:v.artist_performance_rating,production_rating:v.production_rating,venue_rating:v.venue_rating,location_rating:v.location_rating,value_rating:v.value_rating,artist_performance_feedback:v.artist_performance_feedback,production_feedback:v.production_feedback,venue_feedback:v.venue_feedback,location_feedback:v.location_feedback,value_feedback:v.value_feedback,event_info:{event_name:_.title||"Concert Review",venue_name:_.venue_name||"Unknown Venue",event_date:_.event_date||v.created_at,artist_name:_.artist_name,artist_id:_.artist_id},connection_degree:g,connection_type_label:g===1?"Friend":"Mutual Friend",relevance_score:this.calculateFriendReviewRelevance(v,g)}})}catch(l){return console.warn("Error in fallback query, returning empty array:",l),[]}}const o=(a||[]).map(l=>this.transformConnectionReview(l));if(n===0){const l=N2.reviews(t,r,n);Fo.set(l,o,Bv.REVIEWS)}return o}catch(a){return console.error("Error fetching connection degree reviews:",a),this.getFriendsPlusOneReviews(t,r,n)}})}static transformConnectionReview(t){return{id:`connection-review-${t.review_id}`,type:"review",review_id:t.review_id,title:`${t.reviewer_name||"User"}'s Review`,content:t.review_text||t.content||"",author:{id:t.reviewer_id,name:t.reviewer_name||"Anonymous",avatar_url:t.reviewer_avatar,verified:t.reviewer_verified,account_type:t.reviewer_account_type},created_at:t.created_at,updated_at:t.updated_at,rating:t.rating,is_public:t.is_public,photos:t.photos||void 0,setlist:t.setlist||void 0,likes_count:t.likes_count||0,comments_count:t.comments_count||0,shares_count:t.shares_count||0,event_info:{event_name:t.event_title||"Concert Review",venue_name:t.venue_name||"Unknown Venue",event_date:t.Event_date||t.event_date||t.event_date||t.created_at,artist_name:t.artist_name,artist_id:t.artist_id},connection_degree:t.connection_degree,connection_type_label:t.connection_type_label,connection_color:t.connection_color,relevance_score:this.calculateFriendReviewRelevance(t,t.connection_degree||3)}}static fetchEventsByIds(t){return E(this,null,function*(){const r=new Map,n=Array.from(new Set(t));if(n.length===0)return r;try{const{data:a,error:i}=yield T.from("events").select("id, title, artist_name, artist_id, venue_name, venue_id, event_date, venue_city, venue_state").in("id",n);if(i)return console.warn(" Unable to load events for friend reviews:",i),r;for(const o of a!=null?a:[])o.id&&r.set(o.id,o)}catch(a){console.warn(" Unexpected error while loading events for friend reviews:",a)}return r})}}class aS{static getFeedItems(t){return E(this,null,function*(){const{userId:r,limit:n=50,offset:a=0,userLocation:i,includePrivateReviews:o=!0,feedType:l="all",filters:c}=t;try{switch(l){case"friends":case"friends_plus_one":return yield n4.getConnectionDegreeReviews(r,n,a);case"public_only":return yield this.getPublicReviews(r,n);case"all":default:return yield this.getUnifiedFeed(t)}}catch(d){throw console.error("Error fetching unified feed:",d),new Error(`Failed to fetch feed: ${d instanceof Error?d.message:"Unknown error"}`)}})}static getUnifiedFeed(t){return E(this,null,function*(){const{userId:r,limit:n=50,offset:a=0,userLocation:i,includePrivateReviews:o=!0,filters:l}=t;try{const c=[];if(o){const v=yield this.getUserReviews(r);c.push(...v)}try{const v=yield n4.getConnectionDegreeReviews(r,n);c.push(...v)}catch(v){console.warn("Error fetching connection degree reviews, falling back to public reviews:",v);const g=yield this.getPublicReviews(r,n);c.push(...g)}const d=yield this.getRecentEvents(i,20,r,a,l);c.push(...d);const f=yield this.getFriendActivity(r,10);c.push(...f);const u=this.deduplicateFeedItems(c),h=this.sortByRelevanceAndTime(u,i);return this.enforceArtistDiversity(h,1).slice(a,a+n)}catch(c){throw console.error("Error fetching unified feed:",c),new Error(`Failed to fetch feed: ${c instanceof Error?c.message:"Unknown error"}`)}})}static getUserReviews(t){return E(this,null,function*(){try{const{data:r}=yield T.from("users").select("name, avatar_url, verified, account_type").eq("user_id",t).single(),{data:n,error:a}=yield T.from("reviews").select("*").eq("user_id",t).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).limit(20);if(a)throw a;const i=yield this.fetchEventsByIds((n||[]).map(o=>o.event_id).filter(o=>!!o));return(n||[]).map(o=>{const l=o.event_id?i.get(o.event_id):null,c=Array.isArray(o.events)?o.events[0]:o.events,d=o.setlist||(c==null?void 0:c.setlist)||(l==null?void 0:l.setlist);return console.log(" getUserReviews: Processing review:",{reviewId:o.id,hasUserReviewSetlist:!!o.setlist,hasEventSetlist:!!(c!=null&&c.setlist||l!=null&&l.setlist),setlistToUse:!!d}),{id:`review-${o.id}`,type:"review",review_id:o.id,title:(c==null?void 0:c.title)||(l==null?void 0:l.title)||(o.is_public?"Your Public Review":"Your Private Review"),content:o.review_text||"",author:{id:t,name:(r==null?void 0:r.name)||"You",avatar_url:r==null?void 0:r.avatar_url,verified:r==null?void 0:r.verified,account_type:r==null?void 0:r.account_type},created_at:o.created_at,updated_at:o.updated_at,rating:o.rating,is_public:o.is_public,photos:o.photos||void 0,setlist:d||void 0,artist_performance_rating:o.artist_performance_rating,production_rating:o.production_rating,venue_rating:o.venue_rating,location_rating:o.location_rating,value_rating:o.value_rating,artist_performance_feedback:o.artist_performance_feedback,production_feedback:o.production_feedback,venue_feedback:o.venue_feedback,location_feedback:o.location_feedback,value_feedback:o.value_feedback,likes_count:o.likes_count||0,comments_count:o.comments_count||0,shares_count:o.shares_count||0,event_info:{event_name:(c==null?void 0:c.title)||(l==null?void 0:l.title)||"Concert Review",venue_name:(c==null?void 0:c.venue_name)||(l==null?void 0:l.venue_name)||"Unknown Venue",event_date:o.Event_date||o.event_date||(c==null?void 0:c.event_date)||(l==null?void 0:l.event_date)||o.created_at,artist_name:(c==null?void 0:c.artist_name)||(l==null?void 0:l.artist_name),artist_id:(c==null?void 0:c.artist_id)||(l==null?void 0:l.artist_id)},relevance_score:this.calculateReviewRelevance(o,!0)}})}catch(r){return console.error("Error fetching user reviews:",r),[]}})}static fetchEventsByIds(t){return E(this,null,function*(){const r=new Map,n=Array.from(new Set(t));if(n.length===0)return r;try{const{data:a,error:i}=yield T.from("events").select("id, title, artist_name, artist_id, venue_name, venue_id, event_date, venue_city, venue_state, setlist").in("id",n);if(i)return console.warn(" Unable to load events for reviews:",i),r;for(const o of a!=null?a:[])o.id&&r.set(o.id,o)}catch(a){console.warn(" Unexpected error while loading events for reviews:",a)}return r})}static fetchUsersByIds(t){return E(this,null,function*(){const r=new Map,n=Array.from(new Set(t));if(n.length===0)return r;try{const{data:a,error:i}=yield T.from("users").select("user_id, name, avatar_url, verified, account_type").in("user_id",n);if(i)return console.warn(" Unable to load users for reviews:",i),r;for(const o of a!=null?a:[])o.user_id&&r.set(o.user_id,o)}catch(a){console.warn(" Unexpected error while loading users for reviews:",a)}return r})}static getPublicReviews(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select("*").neq("user_id",t).eq("is_public",!0).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).limit(r);if(a)throw a;const i=yield this.fetchEventsByIds((n||[]).map(l=>l.event_id).filter(l=>!!l)),o=yield this.fetchUsersByIds((n||[]).map(l=>l.user_id).filter(l=>!!l));return(n||[]).map(l=>{const c=l.event_id?i.get(l.event_id):null,d=l.user_id?o.get(l.user_id):null;return{id:`public-review-${l.id}`,type:"review",review_id:l.id,title:`${(d==null?void 0:d.name)||"Someone"}'s Review`,content:l.review_text||"",author:{id:l.user_id,name:(d==null?void 0:d.name)||"Anonymous",avatar_url:d==null?void 0:d.avatar_url,verified:d==null?void 0:d.verified,account_type:d==null?void 0:d.account_type},created_at:l.created_at,rating:l.rating,is_public:!0,photos:l.photos||void 0,setlist:(c==null?void 0:c.setlist)||void 0,likes_count:l.likes_count||0,comments_count:l.comments_count||0,shares_count:l.shares_count||0,event_info:{event_name:(c==null?void 0:c.title)||"Concert Review",venue_name:(c==null?void 0:c.venue_name)||"Unknown Venue",event_date:(c==null?void 0:c.event_date)||l.created_at,artist_name:c==null?void 0:c.artist_name,artist_id:l.artist_id},relevance_score:this.calculateReviewRelevance(l,!1)}})}catch(n){return console.error("Error fetching public reviews:",n),[]}})}static getRecentEvents(t,r=20,n,a=0,i){return E(this,null,function*(){var o,l;try{if(n){console.log(" Attempting personalized feed for user:",n);try{const v=yield em.getPersonalizedFeed(n,r,a,!1,i),g=v.length>0&&v.some(_=>_.relevance_score!==void 0&&_.relevance_score!==null);return g||v.length===0||a>0?(v.length>0?console.log(" Using PERSONALIZED feed:",{count:v.length,topScore:(o=v[0])==null?void 0:o.relevance_score,topArtist:(l=v[0])==null?void 0:l.artist_name,hasScores:g,scores:v.slice(0,5).map(_=>({artist:_.artist_name,score:_.relevance_score}))}):console.log(" Using PERSONALIZED feed (empty - end of results at this offset):",{offset:a,limit:r,reason:a>0?"pagination":"no personalized events available"}),v.map(_=>this.transformPersonalizedEventToFeedItem(_,t))):(console.warn(" Personalized feed returned events without scores at offset 0. Using anyway (scores may be 0/null but still personalized)."),v.map(_=>this.transformPersonalizedEventToFeedItem(_,t)))}catch(v){console.warn(" Personalized feed failed, falling back to standard:",v)}}console.log(" Using STANDARD feed (no personalization)");let c=T.from("events").select("*").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0});const d=Math.max(r*2,40);c=c.limit(d);const{data:f,error:u}=yield c;if(u)throw u;let h=f||[];if(h.length<r&&a===0){console.log(` Standard feed: Only got ${h.length} events, fetching more to reach ${r}...`);const{data:v}=yield T.from("events").select("*").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(r*3);v&&v.length>h.length&&(h=v,console.log(` Standard feed: Got ${h.length} events from expanded query`))}let m=(h||[]).map(v=>{const g={id:`event-${v.id}`,type:"event",title:v.title,content:v.description||`${v.artist_name} is performing at ${v.venue_name}`,author:{id:"system",name:"",avatar_url:void 0},created_at:v.created_at||v.event_date,event_data:D(D(D(D(D({id:v.id,jambase_event_id:v.jambase_event_id,title:v.title,artist_name:v.artist_name,artist_id:v.artist_id||"",venue_name:v.venue_name,venue_id:v.venue_id||"",event_date:v.event_date,doors_time:v.doors_time,description:v.description,genres:v.genres,venue_address:v.venue_address,venue_city:v.venue_city,venue_state:v.venue_state,venue_zip:v.venue_zip,latitude:v.latitude?Number(v.latitude):void 0,longitude:v.longitude?Number(v.longitude):void 0,ticket_available:v.ticket_available,price_range:v.price_range,ticket_urls:v.ticket_urls||(v.ticket_url?[v.ticket_url]:[]),setlist:v.setlist,setlist_enriched:v.setlist_enriched,setlist_song_count:v.setlist_song_count,setlist_fm_id:v.setlist_fm_id,setlist_fm_url:v.setlist_fm_url,tour_name:v.tour_name,created_at:v.created_at,updated_at:v.updated_at},v.price_min&&{ticket_price_min:v.price_min}),v.price_max&&{ticket_price_max:v.price_max}),v.ticket_url&&{ticket_url:v.ticket_url}),v.price_min&&{price_min:v.price_min}),v.price_max&&{price_max:v.price_max}),event_info:{event_name:v.title,venue_name:v.venue_name,event_date:v.event_date,artist_name:v.artist_name,artist_id:v.artist_id},location:v.latitude&&v.longitude?{lat:Number(v.latitude),lng:Number(v.longitude),venue_name:v.venue_name,venue_address:v.venue_address}:void 0,relevance_score:this.calculateEventRelevance(v,t)};return t&&g.location&&(g.distance_miles=this.calculateDistance(t.lat,t.lng,g.location.lat,g.location.lng)),g});return t&&(m=m.filter(v=>!v.distance_miles||v.distance_miles<=50).slice(0,r)),m}catch(c){return console.error("Error fetching recent events:",c),[]}})}static transformPersonalizedEventToFeedItem(t,r){var o,l,c;const n=t.id||t.event_id||t.jambase_event_id,a=V(D({},t),{id:n,ticket_price_min:(o=t.ticket_price_min)!=null?o:null,ticket_price_max:(l=t.ticket_price_max)!=null?l:null,ticket_url:(c=t.ticket_url)!=null?c:null}),i={id:`event-${n||"unknown"}`,type:"event",title:t.title,content:t.description||`${t.artist_name} is performing at ${t.venue_name}`,author:{id:"system",name:"",avatar_url:void 0},created_at:t.created_at,event_data:a,event_info:{event_name:t.title,venue_name:t.venue_name,event_date:t.event_date,artist_name:t.artist_name,artist_id:t.artist_id||void 0},location:t.latitude&&t.longitude?{lat:Number(t.latitude),lng:Number(t.longitude),venue_name:t.venue_name,venue_address:t.venue_address||void 0}:void 0,relevance_score:(t.relevance_score||0)/100};return r&&i.location&&(i.distance_miles=this.calculateDistance(r.lat,r.lng,i.location.lat,i.location.lng)),i}static getFriendActivity(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("user_relationships").select("id, user_id, related_user_id, created_at").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`).order("created_at",{ascending:!1}).limit(r);if(a)throw a;if(!n||n.length===0)return[];const i=n.map(d=>d.user_id===t?d.related_user_id:d.user_id),{data:o,error:l}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",i);if(l)return console.error("Error fetching friend profiles:",l),[];const c=new Map((o==null?void 0:o.map(d=>[d.user_id,d]))||[]);return n.map(d=>{const f=d.user_id===t?d.related_user_id:d.user_id,u=c.get(f);return{id:`friend-activity-${d.id}`,type:"friend_activity",title:`You're now friends with ${(u==null?void 0:u.name)||"someone"}!`,content:"Start chatting and discover concerts together.",author:{id:f,name:(u==null?void 0:u.name)||"Unknown",avatar_url:u==null?void 0:u.avatar_url},created_at:d.created_at,relevance_score:this.calculateFriendActivityRelevance(d)}})}catch(n){return console.error("Error fetching friend activity:",n),[]}})}static sortByRelevanceAndTime(t,r){return t.sort((n,a)=>{const i=a.relevance_score-n.relevance_score;if(Math.abs(i)>.1)return i;const o=new Date(n.created_at).getTime();return new Date(a.created_at).getTime()-o})}static calculateReviewRelevance(t,r){let n=r?.9:.5;t.is_public&&!r&&(n+=.2);const a=(Date.now()-new Date(t.created_at).getTime())/(1e3*60*60*24);a<1?n+=.3:a<7?n+=.2:a<30&&(n+=.1);const i=(t.likes_count||0)+(t.comments_count||0);return n+=Math.min(i*.05,.3),Math.min(n,1)}static calculateEventRelevance(t,r){let n=.6;const i=(new Date(t.event_date).getTime()-Date.now())/(1e3*60*60*24);return i>=0&&i<=30?n+=.3:i>30&&i<=90&&(n+=.2),t.latitude&&t.longitude&&(n+=.1),t.ticket_available&&(n+=.1),Math.min(n,1)}static calculateFriendActivityRelevance(t){let r=.7;const n=(Date.now()-new Date(t.created_at).getTime())/(1e3*60*60*24);return n<1?r+=.2:n<7&&(r+=.1),Math.min(r,1)}static calculateDistance(t,r,n,a){const o=this.toRadians(n-t),l=this.toRadians(a-r),c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(this.toRadians(t))*Math.cos(this.toRadians(n))*Math.sin(l/2)*Math.sin(l/2);return 3959*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}static toRadians(t){return t*(Math.PI/180)}static deduplicateFeedItems(t){var i,o,l,c,d,f,u;const r=new Set,n=[],a=[];for(const h of t){let m=null;if(h.type==="event"&&((i=h.event_data)!=null&&i.id)&&(m=`id-${String(h.event_data.id)}`),!m&&h.type==="event"){const v=(((o=h.event_info)==null?void 0:o.artist_name)||h.title||"").toLowerCase().trim().replace(/\s+/g," ").replace(/[^\w\s]/g,""),g=(((l=h.event_info)==null?void 0:l.venue_name)||((c=h.event_data)==null?void 0:c.venue_name)||"").toLowerCase().trim().replace(/\s+/g," ").replace(/\bthe\s+/gi,"").replace(/\bo2\s+/gi,"").replace(/[^\w\s]/g,""),x=(d=h.event_info)!=null&&d.event_date?h.event_info.event_date.split("T")[0]:(f=h.event_data)!=null&&f.event_date?h.event_data.event_date.split("T")[0]:"";v&&g&&x&&(m=`match-${v}|${g}|${x}`)}if(!m){n.push(h);continue}if(!r.has(m))r.add(m),n.push(h);else{a.push(m);const v=((u=h.event_info)==null?void 0:u.event_name)||h.title||"Unknown";console.log(` Duplicate event filtered: ${v} (key: ${m})`)}}return a.length>0&&console.log(` Deduplication: Removed ${a.length} duplicate event(s) from feed`),n}static enforceArtistDiversity(t,r){var i,o;const n=new Map,a=[];for(const l of t){const c=(((i=l.event_info)==null?void 0:i.artist_name)||((o=l.event_data)==null?void 0:o.artist_name)||"").toString();if(!c){a.push(l);continue}const d=c.toLowerCase().trim().replace(/\s+/g," ").replace(/[^[\w\s]]/g,""),f=n.get(d)||0;f<r&&(a.push(l),n.set(d,f+1))}return a}}const the=new ya.Icon({iconUrl:dU,iconRetinaUrl:cU,shadowUrl:uU,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),rhe=({center:e,zoom:t,onCenterChange:r})=>{const n=Rf(),a=y.useRef(!1),i=y.useRef(e),o=y.useRef(t);return y.useEffect(()=>{const l=Math.abs(i.current[0]-e[0])>1e-4||Math.abs(i.current[1]-e[1])>1e-4,c=o.current!==t;(l||c)&&!a.current&&(i.current=e,o.current=t,n.setView(e,t,{animate:!1}))},[n,e,t]),y.useEffect(()=>{const l=()=>{a.current=!0},c=()=>{const d=n.getCenter();r&&r([d.lat,d.lng]),setTimeout(()=>{a.current=!1},300)};return n.on("movestart",l),n.on("dragstart",l),n.on("zoomstart",l),n.on("wheel",l),n.on("moveend",c),n.on("dragend",c),n.on("zoomend",c),()=>{n.off("movestart",l),n.off("dragstart",l),n.off("zoomstart",l),n.off("wheel",l),n.off("moveend",c),n.off("dragend",c),n.off("zoomend",c)}},[n,r]),null},nhe=({events:e,onBoundsChange:t})=>{const r=Rf(),n=y.useRef(null),a=y.useRef(e),i=y.useRef(t);return y.useEffect(()=>{a.current=e,i.current=t},[e,t]),y.useEffect(()=>{const o=()=>{const c=r.getBounds(),d={north:c.getNorth(),south:c.getSouth(),east:c.getEast(),west:c.getWest()},f=`${d.north.toFixed(4)}_${d.south.toFixed(4)}_${d.east.toFixed(4)}_${d.west.toFixed(4)}`;if(n.current===f)return;n.current=f;const u=a.current.filter(h=>{if(!h.latitude||!h.longitude)return!1;const m=Number(h.latitude),v=Number(h.longitude);return Number.isNaN(m)||Number.isNaN(v)?!1:m>=d.south&&m<=d.north&&v>=d.west&&v<=d.east});i.current&&i.current(u)};r.on("moveend",o),r.on("zoomend",o);const l=setTimeout(o,100);return()=>{clearTimeout(l),r.off("moveend",o),r.off("zoomend",o)}},[r]),null},QU=({center:e,zoom:t,events:r,onEventClick:n,onMapCenterChange:a})=>{const i=y.useRef(null),[o,l]=y.useState([]),c=r.filter(f=>{const u=Number(f.latitude),h=Number(f.longitude);return f.latitude!=null&&f.longitude!=null&&!Number.isNaN(u)&&!Number.isNaN(h)}),d=o.length>0?o:c;return s.jsx("div",{className:"w-full h-full",children:s.jsxs(a0,{center:e,zoom:t,style:{height:"100%",width:"100%"},ref:i,scrollWheelZoom:!0,wheelPxPerZoomLevel:60,children:[s.jsx(i0,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(rhe,{center:e,zoom:t,onCenterChange:a}),s.jsx(nhe,{events:c,onBoundsChange:l}),d.map(f=>s.jsx(gf,{position:[Number(f.latitude),Number(f.longitude)],icon:the,children:s.jsx(lU,{maxWidth:300,className:"event-popup",children:s.jsxs("div",{className:"p-2",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-sm text-gray-900 mb-1 truncate",children:f.title}),s.jsx("p",{className:"text-sm text-blue-600 font-medium mb-1",children:f.artist_name})]}),s.jsxs(et,{variant:"outline",className:"text-xs ml-2",children:[s.jsx(Ft,{className:"w-3 h-3 mr-1"}),"Event"]})]}),s.jsxs("div",{className:"space-y-2 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx(yr,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:f.venue_name})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx(Lt,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{children:(()=>{try{return Rt(gs(f.event_date),"MMM d, yyyy h:mm a")}catch(u){return f.event_date}})()})]}),f.venue_address&&s.jsxs("p",{className:"text-xs text-gray-500 line-clamp-2",children:[f.venue_address,f.venue_city&&`, ${f.venue_city}`,f.venue_state&&`, ${f.venue_state}`]}),f.genres&&f.genres.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:f.genres.slice(0,3).map((u,h)=>s.jsx(et,{variant:"secondary",className:"text-xs",children:u},h))}),f.price_range&&s.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-600",children:[s.jsx(zl,{className:"w-3 h-3"}),s.jsx("span",{children:Vv(f.price_range)})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ce,{size:"sm",onClick:u=>{u.stopPropagation(),n(f)},className:"flex-1 text-xs bg-pink-500 hover:bg-pink-600",children:[s.jsx(Ft,{className:"w-3 h-3 mr-1"}),"Review"]}),f.ticket_urls&&f.ticket_urls.length>0&&s.jsxs(ce,{size:"sm",variant:"outline",onClick:u=>{u.stopPropagation(),window.open(f.ticket_urls[0],"_blank")},className:"text-xs",children:[s.jsx(zl,{className:"w-3 h-3 mr-1"}),"Tickets"]})]})]})})},f.id))]})})};var B2=["Enter"," "],she=["ArrowDown","PageUp","Home"],eq=["ArrowUp","PageDown","End"],ahe=[...she,...eq],ihe={ltr:[...B2,"ArrowRight"],rtl:[...B2,"ArrowLeft"]},ohe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},o0="Menu",[Wv,lhe,che]=fp(o0),[Of,tq]=$s(o0,[che,Qd,y1]),z1=Qd(),rq=y1(),[dhe,Mf]=Of(o0),[uhe,l0]=Of(o0),nq=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:i,modal:o=!0}=e,l=z1(t),[c,d]=y.useState(null),f=y.useRef(!1),u=ys(i),h=Af(a);return y.useEffect(()=>{const m=()=>{f.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>f.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),s.jsx(Xb,V(D({},l),{children:s.jsx(dhe,{scope:t,open:r,onOpenChange:u,content:c,onContentChange:d,children:s.jsx(uhe,{scope:t,onClose:y.useCallback(()=>u(!1),[u]),isUsingKeyboardRef:f,dir:h,modal:o,children:n})})}))};nq.displayName=o0;var fhe="MenuAnchor",KT=y.forwardRef((e,t)=>{const i=e,{__scopeMenu:r}=i,n=ge(i,["__scopeMenu"]),a=z1(r);return s.jsx(Wy,V(D(D({},a),n),{ref:t}))});KT.displayName=fhe;var ZT="MenuPortal",[hhe,sq]=Of(ZT,{forceMount:void 0}),aq=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,i=Mf(ZT,t);return s.jsx(hhe,{scope:t,forceMount:r,children:s.jsx(Ks,{present:r||i.open,children:s.jsx(hp,{asChild:!0,container:a,children:n})})})};aq.displayName=ZT;var oo="MenuContent",[mhe,XT]=Of(oo),iq=y.forwardRef((e,t)=>{const r=sq(oo,e.__scopeMenu),l=e,{forceMount:n=r.forceMount}=l,a=ge(l,["forceMount"]),i=Mf(oo,e.__scopeMenu),o=l0(oo,e.__scopeMenu);return s.jsx(Wv.Provider,{scope:e.__scopeMenu,children:s.jsx(Ks,{present:n||i.open,children:s.jsx(Wv.Slot,{scope:e.__scopeMenu,children:o.modal?s.jsx(phe,V(D({},a),{ref:t})):s.jsx(ghe,V(D({},a),{ref:t}))})})})}),phe=y.forwardRef((e,t)=>{const r=Mf(oo,e.__scopeMenu),n=y.useRef(null),a=mr(t,n);return y.useEffect(()=>{const i=n.current;if(i)return h1(i)},[]),s.jsx(JT,V(D({},e),{ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:mt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)}))}),ghe=y.forwardRef((e,t)=>{const r=Mf(oo,e.__scopeMenu);return s.jsx(JT,V(D({},e),{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)}))}),vhe=Bd("MenuContent.ScrollLock"),JT=y.forwardRef((e,t)=>{const K=e,{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:f,onFocusOutside:u,onInteractOutside:h,onDismiss:m,disableOutsideScroll:v}=K,g=ge(K,["__scopeMenu","loop","trapFocus","onOpenAutoFocus","onCloseAutoFocus","disableOutsidePointerEvents","onEntryFocus","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss","disableOutsideScroll"]),x=Mf(oo,r),_=l0(oo,r),w=z1(r),b=rq(r),N=lhe(r),[S,k]=y.useState(null),C=y.useRef(null),A=mr(t,C,x.onContentChange),R=y.useRef(0),I=y.useRef(""),O=y.useRef(0),z=y.useRef(null),M=y.useRef("right"),B=y.useRef(0),F=v?Jy:y.Fragment,U=v?{as:vhe,allowPinchZoom:!0}:void 0,H=Z=>{var Q,oe;const ne=I.current+Z,Y=N().filter(ie=>!ie.disabled),X=document.activeElement,se=(Q=Y.find(ie=>ie.ref.current===X))==null?void 0:Q.textValue,de=Y.map(ie=>ie.textValue),_e=Phe(de,ne,se),xe=(oe=Y.find(ie=>ie.textValue===_e))==null?void 0:oe.ref.current;(function ie(ee){I.current=ee,window.clearTimeout(R.current),ee!==""&&(R.current=window.setTimeout(()=>ie(""),1e3))})(ne),xe&&setTimeout(()=>xe.focus())};y.useEffect(()=>()=>window.clearTimeout(R.current),[]),u1();const q=y.useCallback(Z=>{var Y,X;return M.current===((Y=z.current)==null?void 0:Y.side)&&Ahe(Z,(X=z.current)==null?void 0:X.area)},[]);return s.jsx(mhe,{scope:r,searchRef:I,onItemEnter:y.useCallback(Z=>{q(Z)&&Z.preventDefault()},[q]),onItemLeave:y.useCallback(Z=>{var ne;q(Z)||((ne=C.current)==null||ne.focus(),k(null))},[q]),onTriggerLeave:y.useCallback(Z=>{q(Z)&&Z.preventDefault()},[q]),pointerGraceTimerRef:O,onPointerGraceIntentChange:y.useCallback(Z=>{z.current=Z},[]),children:s.jsx(F,V(D({},U),{children:s.jsx(Xy,{asChild:!0,trapped:a,onMountAutoFocus:mt(i,Z=>{var ne;Z.preventDefault(),(ne=C.current)==null||ne.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:s.jsx(Cf,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:f,onFocusOutside:u,onInteractOutside:h,onDismiss:m,children:s.jsx(R8,V(D({asChild:!0},b),{dir:_.dir,orientation:"vertical",loop:n,currentTabStopId:S,onCurrentTabStopIdChange:k,onEntryFocus:mt(c,Z=>{_.isUsingKeyboardRef.current||Z.preventDefault()}),preventScrollOnEntryFocus:!0,children:s.jsx(Jb,V(D(D({role:"menu","aria-orientation":"vertical","data-state":bq(x.open),"data-radix-menu-content":"",dir:_.dir},w),g),{ref:A,style:D({outline:"none"},g.style),onKeyDown:mt(g.onKeyDown,Z=>{const Y=Z.target.closest("[data-radix-menu-content]")===Z.currentTarget,X=Z.ctrlKey||Z.altKey||Z.metaKey,se=Z.key.length===1;Y&&(Z.key==="Tab"&&Z.preventDefault(),!X&&se&&H(Z.key));const de=C.current;if(Z.target!==de||!ahe.includes(Z.key))return;Z.preventDefault();const xe=N().filter(Q=>!Q.disabled).map(Q=>Q.ref.current);eq.includes(Z.key)&&xe.reverse(),Ehe(xe)}),onBlur:mt(e.onBlur,Z=>{Z.currentTarget.contains(Z.target)||(window.clearTimeout(R.current),I.current="")}),onPointerMove:mt(e.onPointerMove,Hv(Z=>{const ne=Z.target,Y=B.current!==Z.clientX;if(Z.currentTarget.contains(ne)&&Y){const X=Z.clientX>B.current?"right":"left";M.current=X,B.current=Z.clientX}}))}))}))})})}))})});iq.displayName=oo;var yhe="MenuGroup",QT=y.forwardRef((e,t)=>{const a=e,{__scopeMenu:r}=a,n=ge(a,["__scopeMenu"]);return s.jsx(Pt.div,V(D({role:"group"},n),{ref:t}))});QT.displayName=yhe;var xhe="MenuLabel",oq=y.forwardRef((e,t)=>{const a=e,{__scopeMenu:r}=a,n=ge(a,["__scopeMenu"]);return s.jsx(Pt.div,V(D({},n),{ref:t}))});oq.displayName=xhe;var pw="MenuItem",s4="menu.itemSelect",B1=y.forwardRef((e,t)=>{const u=e,{disabled:r=!1,onSelect:n}=u,a=ge(u,["disabled","onSelect"]),i=y.useRef(null),o=l0(pw,e.__scopeMenu),l=XT(pw,e.__scopeMenu),c=mr(t,i),d=y.useRef(!1),f=()=>{const h=i.current;if(!r&&h){const m=new CustomEvent(s4,{bubbles:!0,cancelable:!0});h.addEventListener(s4,v=>n==null?void 0:n(v),{once:!0}),EP(h,m),m.defaultPrevented?d.current=!1:o.onClose()}};return s.jsx(lq,V(D({},a),{ref:c,disabled:r,onClick:mt(e.onClick,f),onPointerDown:h=>{var m;(m=e.onPointerDown)==null||m.call(e,h),d.current=!0},onPointerUp:mt(e.onPointerUp,h=>{var m;d.current||(m=h.currentTarget)==null||m.click()}),onKeyDown:mt(e.onKeyDown,h=>{const m=l.searchRef.current!=="";r||m&&h.key===" "||B2.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})}))});B1.displayName=pw;var lq=y.forwardRef((e,t)=>{const v=e,{__scopeMenu:r,disabled:n=!1,textValue:a}=v,i=ge(v,["__scopeMenu","disabled","textValue"]),o=XT(pw,r),l=rq(r),c=y.useRef(null),d=mr(t,c),[f,u]=y.useState(!1),[h,m]=y.useState("");return y.useEffect(()=>{var x;const g=c.current;g&&m(((x=g.textContent)!=null?x:"").trim())},[i.children]),s.jsx(Wv.ItemSlot,{scope:r,disabled:n,textValue:a!=null?a:h,children:s.jsx(O8,V(D({asChild:!0},l),{focusable:!n,children:s.jsx(Pt.div,V(D({role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0},i),{ref:d,onPointerMove:mt(e.onPointerMove,Hv(g=>{n?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:mt(e.onPointerLeave,Hv(g=>o.onItemLeave(g))),onFocus:mt(e.onFocus,()=>u(!0)),onBlur:mt(e.onBlur,()=>u(!1))}))}))})}),_he="MenuCheckboxItem",cq=y.forwardRef((e,t)=>{const i=e,{checked:r=!1,onCheckedChange:n}=i,a=ge(i,["checked","onCheckedChange"]);return s.jsx(mq,{scope:e.__scopeMenu,checked:r,children:s.jsx(B1,V(D({role:"menuitemcheckbox","aria-checked":gw(r)?"mixed":r},a),{ref:t,"data-state":tA(r),onSelect:mt(a.onSelect,()=>n==null?void 0:n(gw(r)?!0:!r),{checkForDefaultPrevented:!1})}))})});cq.displayName=_he;var dq="MenuRadioGroup",[whe,bhe]=Of(dq,{value:void 0,onValueChange:()=>{}}),uq=y.forwardRef((e,t)=>{const o=e,{value:r,onValueChange:n}=o,a=ge(o,["value","onValueChange"]),i=ys(n);return s.jsx(whe,{scope:e.__scopeMenu,value:r,onValueChange:i,children:s.jsx(QT,V(D({},a),{ref:t}))})});uq.displayName=dq;var fq="MenuRadioItem",hq=y.forwardRef((e,t)=>{const o=e,{value:r}=o,n=ge(o,["value"]),a=bhe(fq,e.__scopeMenu),i=r===a.value;return s.jsx(mq,{scope:e.__scopeMenu,checked:i,children:s.jsx(B1,V(D({role:"menuitemradio","aria-checked":i},n),{ref:t,"data-state":tA(i),onSelect:mt(n.onSelect,()=>{var l;return(l=a.onValueChange)==null?void 0:l.call(a,r)},{checkForDefaultPrevented:!1})}))})});hq.displayName=fq;var eA="MenuItemIndicator",[mq,jhe]=Of(eA,{checked:!1}),pq=y.forwardRef((e,t)=>{const o=e,{__scopeMenu:r,forceMount:n}=o,a=ge(o,["__scopeMenu","forceMount"]),i=jhe(eA,r);return s.jsx(Ks,{present:n||gw(i.checked)||i.checked===!0,children:s.jsx(Pt.span,V(D({},a),{ref:t,"data-state":tA(i.checked)}))})});pq.displayName=eA;var Nhe="MenuSeparator",gq=y.forwardRef((e,t)=>{const a=e,{__scopeMenu:r}=a,n=ge(a,["__scopeMenu"]);return s.jsx(Pt.div,V(D({role:"separator","aria-orientation":"horizontal"},n),{ref:t}))});gq.displayName=Nhe;var She="MenuArrow",vq=y.forwardRef((e,t)=>{const i=e,{__scopeMenu:r}=i,n=ge(i,["__scopeMenu"]),a=z1(r);return s.jsx(Qb,V(D(D({},a),n),{ref:t}))});vq.displayName=She;var khe="MenuSub",[iUe,yq]=Of(khe),qg="MenuSubTrigger",xq=y.forwardRef((e,t)=>{const r=Mf(qg,e.__scopeMenu),n=l0(qg,e.__scopeMenu),a=yq(qg,e.__scopeMenu),i=XT(qg,e.__scopeMenu),o=y.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,d={__scopeMenu:e.__scopeMenu},f=y.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return y.useEffect(()=>f,[f]),y.useEffect(()=>{const u=l.current;return()=>{window.clearTimeout(u),c(null)}},[l,c]),s.jsx(KT,V(D({asChild:!0},d),{children:s.jsx(lq,V(D({id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":bq(r.open)},e),{ref:Oc(t,a.onTriggerChange),onClick:u=>{var h;(h=e.onClick)==null||h.call(e,u),!(e.disabled||u.defaultPrevented)&&(u.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:mt(e.onPointerMove,Hv(u=>{i.onItemEnter(u),!u.defaultPrevented&&!e.disabled&&!r.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),f()},100))})),onPointerLeave:mt(e.onPointerLeave,Hv(u=>{var m,v;f();const h=(m=r.content)==null?void 0:m.getBoundingClientRect();if(h){const g=(v=r.content)==null?void 0:v.dataset.side,x=g==="right",_=x?-5:5,w=h[x?"left":"right"],b=h[x?"right":"left"];i.onPointerGraceIntentChange({area:[{x:u.clientX+_,y:u.clientY},{x:w,y:h.top},{x:b,y:h.top},{x:b,y:h.bottom},{x:w,y:h.bottom}],side:g}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(u),u.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:mt(e.onKeyDown,u=>{var m;const h=i.searchRef.current!=="";e.disabled||h&&u.key===" "||ihe[n.dir].includes(u.key)&&(r.onOpenChange(!0),(m=r.content)==null||m.focus(),u.preventDefault())})}))}))});xq.displayName=qg;var _q="MenuSubContent",wq=y.forwardRef((e,t)=>{const r=sq(oo,e.__scopeMenu),f=e,{forceMount:n=r.forceMount}=f,a=ge(f,["forceMount"]),i=Mf(oo,e.__scopeMenu),o=l0(oo,e.__scopeMenu),l=yq(_q,e.__scopeMenu),c=y.useRef(null),d=mr(t,c);return s.jsx(Wv.Provider,{scope:e.__scopeMenu,children:s.jsx(Ks,{present:n||i.open,children:s.jsx(Wv.Slot,{scope:e.__scopeMenu,children:s.jsx(JT,V(D({id:l.contentId,"aria-labelledby":l.triggerId},a),{ref:d,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:mt(e.onFocusOutside,u=>{u.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:mt(e.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:mt(e.onKeyDown,u=>{var v;const h=u.currentTarget.contains(u.target),m=ohe[o.dir].includes(u.key);h&&m&&(i.onOpenChange(!1),(v=l.trigger)==null||v.focus(),u.preventDefault())})}))})})})});wq.displayName=_q;function bq(e){return e?"open":"closed"}function gw(e){return e==="indeterminate"}function tA(e){return gw(e)?"indeterminate":e?"checked":"unchecked"}function Ehe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function Che(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function Phe(e,t,r){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=Che(e,Math.max(i,0));a.length===1&&(o=o.filter(d=>d!==r));const c=o.find(d=>d.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function The(e,t){const{x:r,y:n}=e;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],c=t[o],d=l.x,f=l.y,u=c.x,h=c.y;f>n!=h>n&&r<(u-d)*(n-f)/(h-f)+d&&(a=!a)}return a}function Ahe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return The(r,t)}function Hv(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Rhe=nq,Ohe=KT,Mhe=aq,Dhe=iq,Ihe=QT,$he=oq,Lhe=B1,Fhe=cq,zhe=uq,Bhe=hq,Uhe=pq,qhe=gq,Vhe=vq,Whe=xq,Hhe=wq,U1="DropdownMenu",[Ghe,oUe]=$s(U1,[tq]),Ja=tq(),[Yhe,jq]=Ghe(U1),Nq=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:i,onOpenChange:o,modal:l=!0}=e,c=Ja(t),d=y.useRef(null),[f,u]=Ya({prop:a,defaultProp:i!=null?i:!1,onChange:o,caller:U1});return s.jsx(Yhe,{scope:t,triggerId:Os(),triggerRef:d,contentId:Os(),open:f,onOpenChange:u,onOpenToggle:y.useCallback(()=>u(h=>!h),[u]),modal:l,children:s.jsx(Rhe,V(D({},c),{open:f,onOpenChange:u,dir:n,modal:l,children:r}))})};Nq.displayName=U1;var Sq="DropdownMenuTrigger",kq=y.forwardRef((e,t)=>{const l=e,{__scopeDropdownMenu:r,disabled:n=!1}=l,a=ge(l,["__scopeDropdownMenu","disabled"]),i=jq(Sq,r),o=Ja(r);return s.jsx(Ohe,V(D({asChild:!0},o),{children:s.jsx(Pt.button,V(D({type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n},a),{ref:Oc(t,i.triggerRef),onPointerDown:mt(e.onPointerDown,c=>{!n&&c.button===0&&c.ctrlKey===!1&&(i.onOpenToggle(),i.open||c.preventDefault())}),onKeyDown:mt(e.onKeyDown,c=>{n||(["Enter"," "].includes(c.key)&&i.onOpenToggle(),c.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(c.key)&&c.preventDefault())})}))}))});kq.displayName=Sq;var Khe="DropdownMenuPortal",Eq=e=>{const a=e,{__scopeDropdownMenu:t}=a,r=ge(a,["__scopeDropdownMenu"]),n=Ja(t);return s.jsx(Mhe,D(D({},n),r))};Eq.displayName=Khe;var Cq="DropdownMenuContent",Pq=y.forwardRef((e,t)=>{const l=e,{__scopeDropdownMenu:r}=l,n=ge(l,["__scopeDropdownMenu"]),a=jq(Cq,r),i=Ja(r),o=y.useRef(!1);return s.jsx(Dhe,V(D(D({id:a.contentId,"aria-labelledby":a.triggerId},i),n),{ref:t,onCloseAutoFocus:mt(e.onCloseAutoFocus,c=>{var d;o.current||(d=a.triggerRef.current)==null||d.focus(),o.current=!1,c.preventDefault()}),onInteractOutside:mt(e.onInteractOutside,c=>{const d=c.detail.originalEvent,f=d.button===0&&d.ctrlKey===!0,u=d.button===2||f;(!a.modal||u)&&(o.current=!0)}),style:V(D({},e.style),{"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))});Pq.displayName=Cq;var Zhe="DropdownMenuGroup",Xhe=y.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=ge(i,["__scopeDropdownMenu"]),a=Ja(r);return s.jsx(Ihe,V(D(D({},a),n),{ref:t}))});Xhe.displayName=Zhe;var Jhe="DropdownMenuLabel",Tq=y.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=ge(i,["__scopeDropdownMenu"]),a=Ja(r);return s.jsx($he,V(D(D({},a),n),{ref:t}))});Tq.displayName=Jhe;var Qhe="DropdownMenuItem",Aq=y.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=ge(i,["__scopeDropdownMenu"]),a=Ja(r);return s.jsx(Lhe,V(D(D({},a),n),{ref:t}))});Aq.displayName=Qhe;var eme="DropdownMenuCheckboxItem",Rq=y.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=ge(i,["__scopeDropdownMenu"]),a=Ja(r);return s.jsx(Fhe,V(D(D({},a),n),{ref:t}))});Rq.displayName=eme;var tme="DropdownMenuRadioGroup",rme=y.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=ge(i,["__scopeDropdownMenu"]),a=Ja(r);return s.jsx(zhe,V(D(D({},a),n),{ref:t}))});rme.displayName=tme;var nme="DropdownMenuRadioItem",Oq=y.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=ge(i,["__scopeDropdownMenu"]),a=Ja(r);return s.jsx(Bhe,V(D(D({},a),n),{ref:t}))});Oq.displayName=nme;var sme="DropdownMenuItemIndicator",Mq=y.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=ge(i,["__scopeDropdownMenu"]),a=Ja(r);return s.jsx(Uhe,V(D(D({},a),n),{ref:t}))});Mq.displayName=sme;var ame="DropdownMenuSeparator",Dq=y.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=ge(i,["__scopeDropdownMenu"]),a=Ja(r);return s.jsx(qhe,V(D(D({},a),n),{ref:t}))});Dq.displayName=ame;var ime="DropdownMenuArrow",ome=y.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=ge(i,["__scopeDropdownMenu"]),a=Ja(r);return s.jsx(Vhe,V(D(D({},a),n),{ref:t}))});ome.displayName=ime;var lme="DropdownMenuSubTrigger",Iq=y.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=ge(i,["__scopeDropdownMenu"]),a=Ja(r);return s.jsx(Whe,V(D(D({},a),n),{ref:t}))});Iq.displayName=lme;var cme="DropdownMenuSubContent",$q=y.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=ge(i,["__scopeDropdownMenu"]),a=Ja(r);return s.jsx(Hhe,V(D(D({},a),n),{ref:t,style:V(D({},e.style),{"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))});$q.displayName=cme;var dme=Nq,ume=kq,fme=Eq,Lq=Pq,Fq=Tq,zq=Aq,Bq=Rq,Uq=Oq,qq=Mq,Vq=Dq,Wq=Iq,Hq=$q;const q1=dme,V1=ume,hme=y.forwardRef((i,a)=>{var o=i,{className:e,inset:t,children:r}=o,n=ge(o,["className","inset","children"]);return s.jsxs(Wq,V(D({ref:a,className:Oe("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e)},n),{children:[r,s.jsx(Uy,{className:"ml-auto h-4 w-4"})]}))});hme.displayName=Wq.displayName;const mme=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(Hq,D({ref:r,className:Oe("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e)},t))});mme.displayName=Hq.displayName;const c0=y.forwardRef((a,n)=>{var i=a,{className:e,sideOffset:t=4}=i,r=ge(i,["className","sideOffset"]);return s.jsx(fme,{children:s.jsx(Lq,D({ref:n,sideOffset:t,className:Oe("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e)},r))})});c0.displayName=Lq.displayName;const Yi=y.forwardRef((a,n)=>{var i=a,{className:e,inset:t}=i,r=ge(i,["className","inset"]);return s.jsx(zq,D({ref:n,className:Oe("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e)},r))});Yi.displayName=zq.displayName;const pme=y.forwardRef((i,a)=>{var o=i,{className:e,children:t,checked:r}=o,n=ge(o,["className","children","checked"]);return s.jsxs(Bq,V(D({ref:a,className:Oe("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r},n),{children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(qq,{children:s.jsx(fa,{className:"h-4 w-4"})})}),t]}))});pme.displayName=Bq.displayName;const gme=y.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=ge(i,["className","children"]);return s.jsxs(Uq,V(D({ref:n,className:Oe("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e)},r),{children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(qq,{children:s.jsx(XF,{className:"h-2 w-2 fill-current"})})}),t]}))});gme.displayName=Uq.displayName;const vme=y.forwardRef((a,n)=>{var i=a,{className:e,inset:t}=i,r=ge(i,["className","inset"]);return s.jsx(Fq,D({ref:n,className:Oe("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e)},r))});vme.displayName=Fq.displayName;const v_=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(Vq,D({ref:r,className:Oe("-mx-1 my-1 h-px bg-muted",e)},t))});v_.displayName=Vq.displayName;class Mu{static getFriends(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_relationships").select("id, user_id, related_user_id, created_at").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`).order("created_at",{ascending:!1});if(n)return console.error("Error fetching friends:",n),[];if(!r||r.length===0)return[];const a=new Set;r.forEach(d=>{const f=d.user_id===t?d.related_user_id:d.user_id;f&&f!==t&&a.add(String(f))});const i=Array.from(a);if(i.length===0)return[];const{data:o,error:l}=yield T.from("users").select("id, name, avatar_url, bio, user_id, created_at").in("user_id",i);if(l)return console.error("Error fetching friend profiles:",l),[];const c=new Map;return r.forEach(d=>{const f=d.user_id===t?String(d.related_user_id):String(d.user_id);if(c.has(f)||f===t)return;const u=o==null?void 0:o.find(h=>String(h.user_id)===f);c.set(f,{id:(u==null?void 0:u.id)||f,user_id:f,name:(u==null?void 0:u.name)||"Unknown User",username:((u==null?void 0:u.name)||"unknown").toLowerCase().replace(/\s+/g,""),avatar_url:(u==null?void 0:u.avatar_url)||null,bio:(u==null?void 0:u.bio)||null,friendship_id:d.id,created_at:d.created_at})}),Array.from(c.values())}catch(r){return console.error("Error getting friends:",r),[]}})}static unfriendUser(t){return E(this,null,function*(){var r,n;try{const{error:a}=yield T.rpc("unfriend_user",{friend_user_id:t});if(a){if((r=a.message)!=null&&r.includes("Friendship does not exist")||a.code==="P0001"){console.log("Friendship already removed or does not exist:",t);return}throw console.error("Error unfriending user:",a),a}}catch(a){if((n=a==null?void 0:a.message)!=null&&n.includes("Friendship does not exist")||(a==null?void 0:a.code)==="P0001"){console.log("Friendship already removed or does not exist:",t);return}throw console.error("Error in unfriendUser:",a),a}})}static cancelFriendRequest(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("cancel_friend_request",{request_id:t});if(r)throw console.error("Error cancelling friend request:",r),r}catch(r){throw console.error("Error in cancelFriendRequest:",r),r}})}static getPendingRequestId(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("user_relationships").select("id").eq("user_id",t).eq("related_user_id",r).eq("relationship_type","friend").eq("status","pending").single();return a?(a.code==="PGRST116"||console.error("Error getting pending request ID:",a),null):(n==null?void 0:n.id)||null}catch(n){return console.error("Error in getPendingRequestId:",n),null}})}static getRecommendedFriends(t,r=10){return E(this,null,function*(){try{const[n,a]=yield Promise.all([T.rpc("get_second_degree_connections",{target_user_id:t}),T.rpc("get_third_degree_connections",{target_user_id:t})]);n.error&&console.error("Error fetching second degree connections:",n.error),a.error&&console.error("Error fetching third degree connections:",a.error);const i=n.data||[],o=a.data||[],l=[];return i.forEach(d=>{l.push({user_id:d.connected_user_id,name:d.name||"Unknown User",avatar_url:d.avatar_url||null,verified:d.is_public_profile!==!1,connection_depth:2,mutual_friends_count:d.mutual_friends_count||0})}),o.forEach(d=>{l.push({user_id:d.connected_user_id,name:d.name||"Unknown User",avatar_url:d.avatar_url||null,verified:d.is_public_profile!==!1,connection_depth:3,mutual_friends_count:d.mutual_friends_count||0})}),l.sort((d,f)=>d.mutual_friends_count!==f.mutual_friends_count?f.mutual_friends_count-d.mutual_friends_count:d.connection_depth-f.connection_depth),Array.from(new Map(l.map(d=>[d.user_id,d])).values()).slice(0,r)}catch(n){return console.error("Error getting recommended friends:",n),[]}})}}const Qo=({menuOpen:e=!1,onMenuClick:t,children:r})=>s.jsx("header",{className:"mobile-header",role:"banner",children:s.jsxs("div",{className:"mobile-header__container",children:[s.jsx("div",{className:"mobile-header__center",children:r}),s.jsx("button",{className:"mobile-header__menu-button",onClick:t,"aria-label":e?"Close menu":"Open menu","aria-expanded":e,type:"button",children:e?s.jsx(Re,{name:"x",size:24,alt:""}):s.jsx(Re,{name:"hamburgerMenu",size:24,alt:""})})]})});function yme({eventId:e,customMessage:t,onEventClick:r,onInterestToggle:n,onAttendanceToggle:a,currentUserId:i,className:o="",refreshTrigger:l}){const[c,d]=y.useState(null),[f,u]=y.useState(!0),[h,m]=y.useState(!1),[v,g]=y.useState(!1),[x,_]=y.useState(!1),[w,b]=y.useState(!1);y.useEffect(()=>{k()},[e]),y.useEffect(()=>{c&&i&&(N(),S())},[c,i]),y.useEffect(()=>{l&&c&&i&&(N(),S())},[l,c,i]);const N=()=>E(this,null,function*(){if(!(!c||!i))try{console.log(" checkInterest called with:",{eventId:c.id,currentUserId:i});const O=yield Kr.isUserInterested(i,c.id);console.log(" checkInterest result:",{interested:O}),m(O)}catch(O){console.log(" checkInterest error:",O),m(!1)}}),S=()=>E(this,null,function*(){if(!(!c||!i))try{const{data:O,error:z}=yield T.from("reviews").select("was_there").eq("user_id",i).eq("event_id",c.id).maybeSingle();if(z){if(z.code==="PGRST116"||z.code==="406"){_(!1);return}console.error("Error checking attendance:",z),_(!1);return}_(O?!!O.was_there:!1)}catch(O){console.error("Error checking attendance:",O),_(!1)}}),k=()=>E(this,null,function*(){try{u(!0);const{data:O,error:z}=yield T.from("events").select("*").eq("id",e).single();if(z){console.error("Error loading shared event:",z);return}d(O)}catch(O){console.error("Error loading shared event:",O)}finally{u(!1)}}),C=O=>{try{return Rt(gs(O),"EEE, MMM d, yyyy")}catch(z){return O}},A=O=>{try{return Rt(gs(O),"h:mm a")}catch(z){return""}},R=c?new Date(c.event_date)<new Date:!1,I=c?new Date(c.event_date)>=new Date:!1;return f?s.jsx(Ze,{className:`p-4 bg-gradient-to-r from-pink-50 to-purple-50 border-pink-200 animate-pulse ${o}`,children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-pink-200 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-pink-200 rounded w-1/2"}),s.jsx("div",{className:"h-3 bg-pink-200 rounded w-2/3"})]})}):c?s.jsxs(Ze,{className:`overflow-hidden bg-gradient-to-br from-white via-pink-50/30 to-purple-50/30 border-2 border-pink-200 hover:border-pink-300 transition-all duration-200 hover:shadow-lg cursor-pointer ${o}`,onClick:()=>r==null?void 0:r(c),children:[s.jsxs("div",{className:"bg-gradient-to-r from-pink-500 to-purple-600 p-3 flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:s.jsx(Ft,{className:"w-5 h-5 text-white"})}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-white text-xs font-medium",children:"Shared Event"})}),I&&s.jsx(et,{className:"bg-green-500 text-white text-xs",children:"Upcoming"}),R&&s.jsx(et,{variant:"secondary",className:"text-xs",children:"Past Event"})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[t&&s.jsx("div",{className:"bg-white/80 rounded-lg p-3 border border-pink-200",children:s.jsxs("p",{className:"text-sm text-gray-700 italic",children:['"',t,'"']})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-gray-900 leading-tight mb-1",children:c.title}),s.jsx("p",{className:"text-pink-600 font-semibold text-sm",children:c.artist_name})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[s.jsx(Lt,{className:"w-4 h-4 text-pink-500"}),s.jsx("span",{className:"font-medium",children:C(c.event_date)}),s.jsx("span",{className:"text-gray-400",children:""}),s.jsx("span",{children:A(c.event_date)})]}),s.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-700",children:[s.jsx(yr,{className:"w-4 h-4 text-pink-500 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:c.venue_name}),s.jsx("p",{className:"text-xs text-gray-500",children:[c.venue_city,c.venue_state].filter(Boolean).join(", ")})]})]}),c.genres&&c.genres.length>0&&s.jsxs("div",{className:"flex flex-wrap gap-1",children:[c.genres.slice(0,3).map((O,z)=>s.jsx(et,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:O},z)),c.genres.length>3&&s.jsxs(et,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:["+",c.genres.length-3]})]}),c.price_range&&s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Price: "}),s.jsx("span",{className:"font-semibold text-gray-900",children:c.price_range})]}),s.jsxs("div",{className:"pt-2 border-t border-pink-100 flex gap-2",children:[I&&i&&n&&s.jsxs(ce,{size:"sm",disabled:v,className:`flex-1 ${h?"bg-green-500 hover:bg-green-600":"bg-pink-500 hover:bg-pink-600"} text-white`,onClick:O=>E(this,null,function*(){O.stopPropagation(),g(!0);try{const z=!h;console.log(" Interest button clicked:",{eventId:c.id,newInterestState:z,currentUserId:i}),yield n(c.id,z),m(z)}catch(z){console.error("Error toggling interest:",z)}finally{g(!1)}}),children:[s.jsx(es,{className:`w-3 h-3 mr-1 ${h?"fill-current":""}`}),h?"Interested!":"I'm Interested"]}),R&&i&&a&&s.jsxs(ce,{size:"sm",disabled:w,className:`flex-1 ${x?"bg-blue-500 hover:bg-blue-600":"bg-yellow-500 hover:bg-yellow-600"} text-white`,onClick:O=>E(this,null,function*(){O.stopPropagation(),b(!0);try{const z=!x;yield a(c.id,z),_(z)}catch(z){console.error("Error toggling attendance:",z)}finally{b(!1)}}),children:[w?s.jsx("div",{className:"w-3 h-3 mr-1 animate-spin rounded-full border-b-2 border-white"}):s.jsx(Xt,{className:`w-3 h-3 mr-1 ${x?"fill-current":""}`}),w?"Updating...":x?"I Was There!":"I Was There"]}),c.ticket_urls&&c.ticket_urls.length>0&&I&&s.jsx(ce,{size:"sm",variant:"outline",className:"flex-1 border-blue-300 text-blue-700 hover:bg-blue-50",asChild:!0,onClick:O=>O.stopPropagation(),children:s.jsxs("a",{href:c.ticket_urls[0],target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-1",children:[s.jsx(zl,{className:"w-3 h-3"}),"Tickets",s.jsx(io,{className:"w-3 h-3"})]})})]}),s.jsx(ce,{variant:"ghost",size:"sm",className:"w-full text-pink-600 hover:text-pink-700 hover:bg-pink-50",onClick:()=>r==null?void 0:r(c),children:"View Full Details "})]})]}):s.jsx(Ze,{className:`p-4 bg-gray-50 border-gray-200 ${o}`,children:s.jsx("p",{className:"text-sm text-gray-500",children:"Event not found"})})}function xme({reviewId:e,customMessage:t,onReviewClick:r,currentUserId:n,className:a="",metadata:i}){const[o,l]=y.useState(null),[c,d]=y.useState(!0),[f,u]=y.useState("User"),[h,m]=y.useState(null);y.useEffect(()=>{v()},[e]);const v=()=>E(this,null,function*(){try{d(!0);const{data:w,error:b}=yield T.from("reviews").select(`
          id,
          user_id,
          event_id,
          rating,
          review_text,
          photos,
          created_at,
          updated_at,
          likes_count,
          comments_count,
          shares_count
        `).eq("id",e).single();if(b){console.error("Error loading review:",b),d(!1);return}if(!w){d(!1);return}let N="User",S=null;if(w.user_id){const{data:I}=yield T.from("users").select("user_id, name, avatar_url").eq("user_id",w.user_id).single();I&&(N=I.name||"User",S=I.avatar_url||null)}let k="",C="",A="";if(w.event_id){const{data:I}=yield T.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date").eq("id",w.event_id).single();I&&(k=I.artist_name_normalized||"",C=I.venue_name_normalized||"",A=I.title||"")}const R={id:w.id,user_id:w.user_id,event_id:w.event_id||"",rating:w.rating||0,review_text:w.review_text||"",is_public:!0,created_at:w.created_at,updated_at:w.updated_at||w.created_at,likes_count:w.likes_count||0,comments_count:w.comments_count||0,shares_count:w.shares_count||0,is_liked_by_user:!1,reaction_emoji:"",photos:Array.isArray(w.photos)?w.photos:[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:k,artist_id:"",venue_name:C,venue_id:""};l(R),u(N),m(S)}catch(w){console.error("Error loading review:",w)}finally{d(!1)}});if(c)return s.jsx(Ze,{className:`p-4 bg-gradient-to-r from-pink-50 to-purple-50 border-pink-200 animate-pulse ${a}`,children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-pink-200 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-pink-200 rounded w-1/2"}),s.jsx("div",{className:"h-3 bg-pink-200 rounded w-2/3"})]})});if(!o)return s.jsx(Ze,{className:`p-4 bg-gray-50 border-gray-200 ${a}`,children:s.jsx("p",{className:"text-sm text-gray-500",children:"Review not found"})});const g=o.artist_name&&o.venue_name?`${o.artist_name} at ${o.venue_name}`:o.artist_name||o.venue_name||"Concert Review",x=o.review_text?o.review_text.length>100?o.review_text.substring(0,100)+"...":o.review_text:"No review text",_=o.created_at?Rt(gs(o.created_at),"MMM d, yyyy"):"";return s.jsxs(Ze,{className:`overflow-hidden bg-gradient-to-br from-white via-pink-50/30 to-purple-50/30 border-2 border-pink-200 hover:border-pink-300 transition-all duration-200 hover:shadow-lg cursor-pointer ${a}`,onClick:()=>r==null?void 0:r(o),children:[s.jsxs("div",{className:"bg-gradient-to-r from-pink-500 to-purple-600 p-3 flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:s.jsx(Xt,{className:"w-5 h-5 text-white fill-white"})}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-white text-xs font-medium",children:"Shared Review"})})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[t&&s.jsx("div",{className:"bg-white/80 rounded-lg p-3 border border-pink-200",children:s.jsx("p",{className:"text-sm text-gray-700",children:t})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-pink-400 to-purple-500 flex items-center justify-center text-white text-xs font-semibold overflow-hidden",children:h?s.jsx("img",{src:h,alt:f,className:"w-full h-full object-cover"}):s.jsx(Is,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:f}),_&&s.jsx("p",{className:"text-xs text-gray-500",children:_})]})]}),s.jsx("div",{children:s.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-1",children:g})}),o.rating>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(w,b)=>{const N=b+1,S=N<=Math.floor(o.rating||0),k=!S&&N-.5<=(o.rating||0);return s.jsxs("div",{className:"relative w-4 h-4",children:[s.jsx(Xt,{className:`w-4 h-4 ${S||k?"text-yellow-400 fill-yellow-400":"text-gray-300"}`}),k&&s.jsx("div",{className:"absolute left-0 top-0 h-full w-1/2 overflow-hidden pointer-events-none",children:s.jsx(Xt,{className:"w-4 h-4 text-yellow-400 fill-yellow-400"})})]},b)})}),s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[o.rating,"/5"]})]}),s.jsx("div",{className:"bg-white/60 rounded-lg p-3 border border-pink-100",children:s.jsx("p",{className:"text-sm text-gray-700 line-clamp-3",children:x})}),(o.artist_name||o.venue_name)&&s.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-gray-600",children:[o.artist_name&&s.jsxs(et,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:[s.jsx(Ft,{className:"w-3 h-3 mr-1"}),o.artist_name]}),o.venue_name&&s.jsxs(et,{variant:"secondary",className:"bg-blue-100 text-blue-800 border-blue-200",children:[s.jsx(yr,{className:"w-3 h-3 mr-1"}),o.venue_name]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 pt-2 border-t border-pink-100",children:[s.jsxs("span",{children:[o.likes_count||0," likes"]}),s.jsxs("span",{children:[o.comments_count||0," comments"]})]})]})]})}const Gq=({currentUserId:e,onBack:t,menuOpen:r=!1,onMenuClick:n,hideHeader:a=!1})=>{var Fe,ft,Et,hr,dr,cn,mn,je;go("view","chat",{source:"messages"});const[i,o]=y.useState([]),[l,c]=y.useState(null),[d,f]=y.useState([]),[u,h]=y.useState(""),[m,v]=y.useState([]),[g,x]=y.useState(!1),[_,w]=y.useState(new Map),[b,N]=y.useState(!1),[S,k]=y.useState(""),[C,A]=y.useState([]);y.useState("");const[R,I]=y.useState(!0);y.useState(!1),y.useState("");const{toast:O}=Er(),[z,M]=y.useState(!1),[B,F]=y.useState(null),[U,H]=y.useState(!1),[q,K]=y.useState(0),[Z,ne]=y.useState(!1),[Y,X]=y.useState(null),[se,de]=y.useState(!1),[_e,xe]=y.useState(null),[Q,oe]=y.useState(new Set);y.useState(!1);const[ie,ee]=y.useState([]),[G,J]=y.useState(!1),[ae,fe]=y.useState(null),[we,ve]=y.useState(!1),me=y.useRef(null);y.useEffect(()=>{Ke(),De()},[e]),y.useEffect(()=>{console.log(" users changed:",m),console.log(" users length:",m.length)},[m]),y.useEffect(()=>{console.log(" selectedChat changed:",l),console.log(" selectedChat exists:",!!l),console.log(" selectedChat id:",l==null?void 0:l.id)},[l]),y.useEffect(()=>{l&&(nt(l.id),Tt(l.id),at(l.id),Ge(l.id))},[l]),y.useEffect(()=>{if(!l)return;const pe=T.channel(`chat-messages-${l.id}`).on("postgres_changes",{event:"*",schema:"public",table:"messages",filter:`chat_id=eq.${l.id}`},Pe=>{console.log(" Real-time message update:",Pe),(Pe.eventType==="INSERT"||Pe.eventType==="UPDATE"||Pe.eventType==="DELETE")&&(nt(l.id),Ke())}).subscribe(Pe=>{Pe==="SUBSCRIBED"?console.log(" Subscribed to messages for chat:",l.id):Pe==="CHANNEL_ERROR"&&console.error(" Error subscribing to messages")});return()=>{T.removeChannel(pe)}},[l==null?void 0:l.id]),y.useEffect(()=>{if(!e)return;const pe=T.channel("chat-list-updates").on("postgres_changes",{event:"*",schema:"public",table:"chats"},Pe=>{console.log(" Real-time chat update:",Pe);const Ne=Pe.new,Ye=Pe.old,We=(Ne==null?void 0:Ne.users)||(Ye==null?void 0:Ye.users)||[];Array.isArray(We)&&We.includes(e)&&Ke()}).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},Pe=>{console.log(" New message in any chat:",Pe),Ke()}).subscribe(Pe=>{Pe==="SUBSCRIBED"?console.log(" Subscribed to chat list updates"):Pe==="CHANNEL_ERROR"&&console.error(" Error subscribing to chat list")});return()=>{T.removeChannel(pe)}},[e]),y.useEffect(()=>{g&&De()},[g]);const Me=pe=>E(void 0,null,function*(){F(pe);try{const Pe=yield Kr.isUserInterested(e,pe.id);H(Pe)}catch(Pe){console.error("Error checking interest:",Pe),H(!1)}M(!0)}),Te=(pe,Pe)=>E(void 0,null,function*(){try{yield Kr.setEventInterest(e,pe,Pe),H(Pe),K(Ne=>Ne+1),O({title:Pe?"Added to interested events!":"Removed from interested events",description:Pe?"This event will appear in your profile":"Event removed from your interested list"})}catch(Ne){console.error("Error toggling interest:",Ne),O({title:"Error",description:"Failed to update interest",variant:"destructive"})}}),Ve=pe=>E(void 0,null,function*(){let Pe="User",Ne;if(pe.user_id)try{const{data:We,error:It}=yield T.from("users").select("user_id, name, avatar_url").eq("user_id",pe.user_id).maybeSingle();!It&&We&&(Pe=We.name||"User",Ne=We.avatar_url||void 0)}catch(We){console.error("Error fetching author information:",We)}const Ye={id:pe.id,type:"review",review_id:pe.id,title:pe.artist_name&&pe.venue_name?`${pe.artist_name} at ${pe.venue_name}`:pe.artist_name||pe.venue_name||"Concert Review",content:pe.review_text||"",author:{id:pe.user_id,name:Pe,avatar_url:Ne},created_at:pe.created_at,rating:pe.rating,photos:pe.photos||[],likes_count:pe.likes_count||0,comments_count:pe.comments_count||0,shares_count:pe.shares_count||0,is_liked:pe.is_liked_by_user||!1,event_info:{artist_name:pe.artist_name,venue_name:pe.venue_name,artist_id:pe.artist_id,venue_id:pe.venue_id},relevance_score:0};X(Ye),ne(!0),de(!0),xe(null);try{const{data:We,error:It}=yield T.from("reviews").select(`
            photos,
            videos,
            artist_performance_rating,
            production_rating,
            venue_rating,
            venue_rating,
            location_rating,
            value_rating,
            artist_performance_feedback,
            production_feedback,
            venue_feedback,
            location_feedback,
            value_feedback,
            mood_tags,
            genre_tags,
            context_tags,
            venue_tags,
            artist_tags,
            reaction_emoji,
            review_text
          `).eq("id",pe.id).maybeSingle();if(It){console.error("Error fetching review details:",It),xe(null),de(!1);return}We&&xe({photos:Array.isArray(We.photos)?We.photos:[],videos:Array.isArray(We.videos)?We.videos:[],categoryRatings:{performance:typeof We.performance_rating=="number"?We.performance_rating:void 0,venue:typeof We.venue_rating=="number"?We.venue_rating:void 0,overallExperience:typeof We.overall_experience_rating=="number"?We.overall_experience_rating:void 0},categoryTexts:{performance:We.performance_review_text||void 0,venue:We.venue_review_text||void 0,overallExperience:We.overall_experience_review_text||void 0},moodTags:Array.isArray(We.mood_tags)&&We.mood_tags.length>0?We.mood_tags:void 0,genreTags:Array.isArray(We.genre_tags)&&We.genre_tags.length>0?We.genre_tags:void 0,contextTags:Array.isArray(We.context_tags)&&We.context_tags.length>0?We.context_tags:void 0,venueTags:Array.isArray(We.venue_tags)&&We.venue_tags.length>0?We.venue_tags:void 0,artistTags:Array.isArray(We.artist_tags)&&We.artist_tags.length>0?We.artist_tags:void 0,reactionEmoji:We.reaction_emoji||void 0})}catch(We){console.error("Error fetching review details:",We),xe(null)}finally{de(!1)}}),le=(pe,Pe)=>E(void 0,null,function*(){try{yield Kr.markUserAttendance(e,pe,Pe),O({title:Pe?"Marked as attended!":"Removed attendance",description:Pe?"This event will appear in your attended events":"Attendance removed"})}catch(Ne){console.error("Error toggling attendance:",Ne),O({title:"Error",description:"Failed to update attendance",variant:"destructive"})}}),Ke=()=>E(void 0,null,function*(){try{const{data:pe,error:Pe}=yield bT(e);if(Pe){console.error("Error fetching chats:",Pe);return}const{data:Ne}=yield T.from("chat_participants").select("chat_id, last_read_at").eq("user_id",e),Ye=new Map;Ne==null||Ne.forEach(Mt=>{Ye.set(Mt.chat_id,Mt.last_read_at)});const It=(yield Promise.all((pe||[]).map(Mt=>E(void 0,null,function*(){try{const ye=Ye.get(Mt.id),Ie=T.from("messages").select("id").eq("chat_id",Mt.id).neq("sender_id",e).limit(1);ye&&Ie.gt("created_at",ye);const{data:dt}=yield Ie.maybeSingle();return V(D({},Mt),{has_unread:!!dt,unread_count:0})}catch(ye){return console.error("Error checking unread status for chat:",Mt.id,ye),V(D({},Mt),{has_unread:!1,unread_count:0})}})))).sort((Mt,ye)=>{if(Mt.has_unread&&!ye.has_unread)return-1;if(!Mt.has_unread&&ye.has_unread)return 1;const Ie=Mt.latest_message_created_at?new Date(Mt.latest_message_created_at).getTime():0;return(ye.latest_message_created_at?new Date(ye.latest_message_created_at).getTime():0)-Ie}),jt=It.filter(Mt=>Mt.is_group_chat).map(Mt=>Mt.id),Ee=new Map;if(console.log(" fetchChats: Group chat IDs:",jt),jt.length>0){const{data:Mt,error:ye}=yield T.from("chats").select("id, entity_type, entity_uuid").in("id",jt);console.log(" fetchChats: Chat entities:",Mt,"Error:",ye);const Ie=(Mt==null?void 0:Mt.filter(dt=>dt.entity_type==="event"&&dt.entity_uuid))||[];if(console.log(" fetchChats: Event chats:",Ie),Ie.length>0){const dt=Ie.map(Xe=>Xe.entity_uuid).filter(Boolean);console.log(" fetchChats: Event IDs:",dt);const{data:wt,error:ht}=yield T.from("events").select("id, artist_id").in("id",dt);console.log(" fetchChats: Events with artist_id:",wt,"Error:",ht);const Le=wt?[...new Set(wt.map(Xe=>Xe.artist_id).filter(Boolean))]:[];if(console.log(" fetchChats: Artist UUIDs:",Le),Le.length>0){const{data:Xe,error:ke}=yield T.from("artists").select("id, image_url").in("id",Le);if(console.log(" fetchChats: Artists fetched by UUID:",Xe,"Error:",ke),Xe&&Xe.length>0){const St=new Map;Xe.forEach(_t=>{_t.image_url&&_t.id&&(St.set(_t.id,_t.image_url),console.log(` Mapped artist UUID: ${_t.id} -> image_url: ${_t.image_url}`))}),console.log(" fetchChats: Artist image map:",Array.from(St.entries())),wt==null||wt.forEach(_t=>{const Fr=Ie.find(dn=>dn.entity_uuid===_t.id);if(Fr&&_t.artist_id){const dn=St.get(_t.artist_id);console.log(` fetchChats: Mapping chat ${Fr.id} to artist image:`,{eventId:_t.id,artist_id:_t.artist_id,imageUrl:dn}),dn&&Ee.set(Fr.id,{entity_type:Fr.entity_type,entity_uuid:Fr.entity_uuid,event_image_url:dn})}}),console.log(" fetchChats: Final entityDataMap:",Array.from(Ee.entries()))}else console.log(" fetchChats: No artists found for UUIDs:",Le)}}}const rt=It.map(Mt=>{var dt,wt,ht,Le,Xe,ke,St,_t,Fr,dn,En,Dt,ur;const ye=Mt,Ie=Ee.get(Mt.id);return V(D({},Mt),{latest_message_id:(dt=Mt.latest_message_id)!=null?dt:null,latest_message:(wt=Mt.latest_message)!=null?wt:null,latest_message_created_at:(ht=Mt.latest_message_created_at)!=null?ht:null,latest_message_sender_name:(Le=Mt.latest_message_sender_name)!=null?Le:null,group_admin_id:(Xe=Mt.group_admin_id)!=null?Xe:null,member_count:(ke=ye.member_count)!=null?ke:null,entity_type:(_t=(St=Ie==null?void 0:Ie.entity_type)!=null?St:ye.entity_type)!=null?_t:null,entity_uuid:(dn=(Fr=Ie==null?void 0:Ie.entity_uuid)!=null?Fr:ye.entity_uuid)!=null?dn:null,event_image_url:(En=Ie==null?void 0:Ie.event_image_url)!=null?En:null,created_at:(Dt=Mt.created_at)!=null?Dt:new Date().toISOString(),updated_at:(ur=Mt.updated_at)!=null?ur:new Date().toISOString()})});o(rt);const ir=It.filter(Mt=>!Mt.is_group_chat).map(Mt=>Mt.id);if(ir.length>0){const{data:Mt,error:ye}=yield T.from("chat_participants").select("chat_id, user_id").in("chat_id",ir).neq("user_id",e);ye&&console.error("Error fetching chat participants for direct chats:",ye);const Ie=new Map,dt=new Set;if(Mt==null||Mt.forEach(wt=>{Ie.set(wt.chat_id,wt.user_id),dt.add(wt.user_id)}),w(Ie),dt.size>0){const wt=Array.from(dt).filter(ht=>!m.some(Le=>Le.user_id===ht));if(wt.length>0){const{data:ht}=yield T.from("users").select("user_id, name, avatar_url, bio").in("user_id",wt);ht&&ht.length>0&&v(Le=>{const Xe=new Set(Le.map(St=>St.user_id)),ke=ht.filter(St=>!Xe.has(St.user_id));return[...Le,...ke]})}}}const rn=new Set;for(const Mt of It)Mt.is_group_chat&&(yield gt(Mt.id))&&rn.add(Mt.id);oe(rn)}catch(pe){console.error("Error fetching chats:",pe)}finally{setTimeout(()=>{I(!1)},800)}}),De=()=>E(void 0,null,function*(){try{console.log(" Current user ID:",e),console.log(" User ID type:",typeof e);const pe=yield Mu.getFriends(e);console.log(" Friends fetched successfully:",pe),console.log(" Number of friends:",pe.length),v(pe)}catch(pe){console.error("Error fetching friends:",pe),v([])}}),nt=pe=>E(void 0,null,function*(){try{const{data:Pe,error:Ne}=yield T.from("messages").select(`
          id,
          chat_id,
          sender_id,
          content,
          created_at,
          message_type,
          shared_event_id,
          shared_review_id,
          metadata
        `).eq("chat_id",pe).order("created_at",{ascending:!0});if(Ne){console.error("Error fetching messages:",Ne);return}const Ye=[...new Set((Pe||[]).map(jt=>jt.sender_id))],{data:We}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",Ye),It=(Pe||[]).map(jt=>{const Ee=We==null?void 0:We.find(rt=>rt.user_id===jt.sender_id);return{id:jt.id,chat_id:jt.chat_id,sender_id:jt.sender_id,content:jt.content,created_at:jt.created_at,sender_name:(Ee==null?void 0:Ee.name)||"Unknown",sender_avatar:(Ee==null?void 0:Ee.avatar_url)||null,message_type:jt.message_type||"text",shared_event_id:jt.shared_event_id,shared_review_id:jt.shared_review_id,metadata:jt.metadata}});f(It.map(jt=>V(D({},jt),{message_type:jt.message_type==="text"||jt.message_type==="event_share"||jt.message_type==="review_share"||jt.message_type==="system"?jt.message_type:"text"}))),setTimeout(()=>{var jt;(jt=me.current)==null||jt.scrollIntoView({behavior:"smooth"})},100)}catch(Pe){console.error("Error fetching messages:",Pe)}});y.useEffect(()=>{d.length>0&&setTimeout(()=>{var pe;(pe=me.current)==null||pe.scrollIntoView({behavior:"smooth"})},100)},[d.length]);const ze=()=>E(void 0,null,function*(){var Pe;if(!u.trim()||!l)return;const pe=u.trim();h("");try{const{data:Ne,error:Ye}=yield T.from("messages").insert({chat_id:l.id,sender_id:e,content:pe}).select().single();if(Ye){console.error("Error sending message:",Ye),h(pe),O({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"});return}nt(l.id);try{const We=(Pe=l.users)==null?void 0:Pe.find(It=>It!==e);Zt.click("user",We||l.id,{action:"send_message",message_length:pe.length,is_group_chat:l.is_group_chat,source:"chat"},We||void 0)}catch(We){console.error("Error tracking message send:",We)}O({title:"Message Sent! ",description:"Your message has been delivered"})}catch(Ne){console.error("Error sending message:",Ne),O({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"})}}),vt=pe=>E(void 0,null,function*(){try{if(console.log("Creating direct chat between:",e,"and",pe),!m.some(We=>We.user_id===pe)){O({title:"Not Friends Yet",description:"You can only chat with people who have accepted your friend request.",variant:"destructive"});return}const{data:Ne,error:Ye}=yield T.rpc("create_direct_chat",{user1_id:e,user2_id:pe});if(Ye){console.error("Error creating direct chat:",Ye),O({title:"Error",description:"Failed to create chat. Please try again.",variant:"destructive"});return}Ke(),x(!1),O({title:"Chat Created! ",description:"You can now start chatting!"})}catch(Pe){console.error("Error creating direct chat:",Pe),O({title:"Error",description:"Failed to create chat. Please try again.",variant:"destructive"})}}),rr=pe=>E(void 0,null,function*(){try{const{error:Pe}=yield T.from("chats").delete().eq("id",pe);if(Pe){console.error("Error deleting chat:",Pe),O({title:"Error",description:"Failed to delete chat. Please try again.",variant:"destructive"});return}o(Ne=>Ne.filter(Ye=>Ye.id!==pe)),(l==null?void 0:l.id)===pe&&(c(null),f([])),O({title:"Chat Deleted",description:"Chat has been removed."})}catch(Pe){console.error("Error deleting chat:",Pe),O({title:"Error",description:"Failed to delete chat. Please try again.",variant:"destructive"})}}),sr=m.filter(pe=>pe.name.toLowerCase().includes(S.toLowerCase())),Ae=pe=>{if(pe.is_group_chat)return"";const Pe=_.get(pe.id);return Pe||Array.isArray(pe.users)&&pe.users.find(Ne=>Ne!==e)||""},Ue=pe=>{if(pe.is_group_chat)return(pe.chat_name||"Group Chat").replace(/\s+Group\s+Chat\s*$/,"");const Pe=Ae(pe);if(!Pe)return pe.chat_name||"Unknown User";const Ne=m.find(Ye=>Ye.user_id===Pe);return(Ne==null?void 0:Ne.name)||"Unknown User"},gt=pe=>E(void 0,null,function*(){return!1}),Ce=pe=>{if(pe.is_group_chat){const Ye=pe.event_image_url;return console.log(" getChatAvatar for group chat:",{chatId:pe.id,chatName:pe.chat_name,event_image_url:Ye,entity_type:pe.entity_type,entity_uuid:pe.entity_uuid}),Ye||null}const Pe=Ae(pe);if(!Pe)return null;const Ne=m.find(Ye=>Ye.user_id===Pe);return(Ne==null?void 0:Ne.avatar_url)||null},Ge=pe=>E(void 0,null,function*(){try{const{error:Pe}=yield T.rpc("mark_chat_as_read",{p_chat_id:pe});Pe&&console.error("Error updating last_read_at:",Pe),o(Ne=>Ne.map(Ye=>Ye.id===pe?V(D({},Ye),{has_unread:!1,unread_count:0}):Ye))}catch(Pe){console.error("Error marking chat as read:",Pe)}}),Nt=pe=>{if(!pe)return"";const Pe=gs(pe),Ne=new Date,Ye=new Date(Ne.getFullYear(),Ne.getMonth(),Ne.getDate()),We=new Date(Ye);We.setDate(We.getDate()-1);const It=new Date(Pe.getFullYear(),Pe.getMonth(),Pe.getDate());return It.getTime()===Ye.getTime()?Rt(Pe,"h:mm a"):It.getTime()===We.getTime()?`Yesterday ${Rt(Pe,"h:mm a")}`:Math.floor((Ye.getTime()-It.getTime())/864e5)<7?`${Rt(Pe,"EEEE")} ${Rt(Pe,"h:mm a")}`:Rt(Pe,"MMM d, h:mm a")},Tt=pe=>E(void 0,null,function*(){try{const{data:Pe,error:Ne}=yield T.from("chat_participants").select(`
          id,
          user_id,
          joined_at,
          last_read_at,
          is_admin,
          notifications_enabled,
          users!user_id(
            user_id,
            name,
            avatar_url,
            bio,
            account_type
          )
        `).eq("chat_id",pe).order("joined_at",{ascending:!0});if(Ne){console.error("Error fetching chat participants:",Ne);return}if(!Pe||Pe.length===0){ee([]);return}const Ye=Pe.map(jt=>jt.user_id).filter(Boolean),We=new Map;if(Ye.length>0){const{data:jt}=yield T.from("user_verifications").select("user_id, verified").in("user_id",Ye);jt&&jt.forEach(Ee=>{We.set(Ee.user_id,Ee.verified||!1)})}const It=Pe.map(jt=>{const Ee=jt.users;if(!Ee)return null;const rt=We.get(jt.user_id)||!1;return{id:jt.id,user_id:jt.user_id,name:Ee.name||"Unknown User",avatar_url:Ee.avatar_url||null,bio:Ee.bio||null,verified:rt,account_type:Ee.account_type||null,joined_at:jt.joined_at,last_read_at:jt.last_read_at,is_admin:jt.is_admin||!1,notifications_enabled:jt.notifications_enabled!==!1}}).filter(Boolean);ee(It)}catch(Pe){console.error("Error fetching chat participants:",Pe)}}),at=pe=>E(void 0,null,function*(){var Pe;try{const{data:Ne,error:Ye}=yield T.from("messages").select("shared_event_id, metadata").eq("chat_id",pe).eq("message_type","event_share").order("created_at",{ascending:!1}).limit(1).maybeSingle(),We=(Ne==null?void 0:Ne.shared_event_id)||((Pe=Ne==null?void 0:Ne.metadata)==null?void 0:Pe.event_id);if(!Ye&&We){const{data:It,error:jt}=yield T.from("events_with_artist_venue").select("id, title, event_date, images, artist_name_normalized, venue_name_normalized").eq("id",We).maybeSingle();if(!jt&&It){fe(V(D({},It),{artist_name:It.artist_name_normalized,venue_name:It.venue_name_normalized}));return}}}catch(Ne){}}),ue=()=>{!l||!l.is_group_chat||(Tt(l.id),ve(!0))},qe=pe=>{O({title:"View Profile",description:"Profile view functionality will be implemented soon"})},Ct=pe=>{O({title:"Block User",description:"Block user functionality will be implemented soon"})},ct=()=>{J(!G),O({title:G?"Notifications Unmuted":"Notifications Muted",description:G?"You will receive notifications for this chat":"You will not receive notifications for this chat"})},pt=()=>{ae&&(F(ae),M(!0))},At=()=>E(void 0,null,function*(){if(!(!l||!window.confirm(`Are you sure you want to delete this ${l.is_group_chat?"group":"chat"}? This action cannot be undone.`)))try{const{error:Pe}=yield T.from("chats").delete().eq("id",l.id);if(Pe){console.error("Error deleting chat:",Pe),O({title:"Error",description:"Failed to delete chat",variant:"destructive"});return}c(null),Ke(),O({title:"Chat Deleted",description:"The chat has been removed"})}catch(Pe){console.error("Error deleting chat:",Pe),O({title:"Error",description:"Failed to delete chat",variant:"destructive"})}}),yt=()=>{const pe=[];let Pe=[];d.forEach((We,It)=>{const jt=It>0?d[It-1]:null;jt&&jt.sender_id===We.sender_id&&jt.message_type===We.message_type&&(We.message_type==="text"||We.message_type==="event_share"||We.message_type==="review_share")?Pe.push(We):(Pe.length>0&&pe.push(Pe),Pe=[We])}),Pe.length>0&&pe.push(Pe);const Ne=[];let Ye=[];return pe.forEach((We,It)=>{const jt=We[0],Ee=It>0?pe[It-1]:null,rt=Ee?Ee[Ee.length-1]:null;rt&&C2(gs(jt.created_at),gs(rt.created_at))>=30?(Ye.length>0&&Ne.push(Ye),Ye=[We]):Ye.push(We)}),Ye.length>0&&Ne.push(Ye),Ne.map((We,It)=>{const Ee=We[0][0],rt=gs(Ee.created_at),ir=new Date,rn=iv(ir,7),Mt=dde(rt,{start:rn,end:ir});return s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{className:"flex justify-center w-full",style:{marginBottom:"var(--spacing-grouped, 24px)"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:Mt?s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{fontWeight:"var(--typography-meta-weight, 700)"},children:Rt(rt,"EEEE")}),s.jsxs("span",{style:{fontWeight:"var(--typography-meta-weight, 500)"},children:[" at ",Rt(rt,"h:mm a")]})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{fontWeight:"var(--typography-meta-weight, 700)"},children:Rt(rt,"MMM d")}),s.jsxs("span",{style:{fontWeight:"var(--typography-meta-weight, 500)"},children:[" at ",Rt(rt,"h:mm a")]})]})})}),We.map((ye,Ie)=>{const dt=ye[0],wt=Ie>0?We[Ie-1]:null,ht=wt?wt[wt.length-1]:null,Le=(l==null?void 0:l.is_group_chat)&&dt.sender_id!==e&&(ht===null||ht.sender_id!==dt.sender_id||ht.message_type!=="text"&&ht.message_type!=="review_share"&&ht.message_type!=="event_share"),Xe=dt.sender_id===e;return s.jsxs("div",{className:"flex flex-col",style:{alignItems:Xe?"flex-end":"flex-start",marginTop:wt?"var(--spacing-grouped, 24px)":"0"},children:[Le&&s.jsx("div",{style:{marginBottom:"var(--spacing-inline, 6px)"},children:s.jsx(fc,{variant:"chat",name:dt.sender_name,initial:dt.sender_name.split(" ").map(ke=>ke[0]).join("").substring(0,1),imageUrl:dt.sender_avatar||null})}),s.jsx("div",{className:"flex flex-col",style:{gap:"var(--spacing-inline, 6px)"},children:ye.map((ke,St)=>{var Fr,dn,En,Dt,ur,or;const _t=St===ye.length-1;return s.jsxs("div",{className:"flex flex-col",style:{gap:_t?"var(--spacing-inline, 6px)":"0"},children:[ke.message_type==="review_share"&&(ke.shared_review_id||(Fr=ke.metadata)!=null&&Fr.review_id)?s.jsx(xme,{reviewId:ke.shared_review_id||((dn=ke.metadata)==null?void 0:dn.review_id),customMessage:(En=ke.metadata)==null?void 0:En.custom_message,onReviewClick:Ve,currentUserId:e,metadata:ke.metadata}):ke.message_type==="event_share"&&(ke.shared_event_id||(Dt=ke.metadata)!=null&&Dt.event_id)?s.jsx(yme,{eventId:ke.shared_event_id||((ur=ke.metadata)==null?void 0:ur.event_id),customMessage:(or=ke.metadata)==null?void 0:or.custom_message,onEventClick:Me,onInterestToggle:Te,onAttendanceToggle:le,currentUserId:e,refreshTrigger:q}):s.jsx("div",{style:{maxWidth:"172px",padding:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",border:ke.sender_id===e?"none":"1px solid var(--neutral-200)",backgroundColor:ke.sender_id===e?"var(--brand-pink-500)":"var(--neutral-100)",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",margin:0,color:ke.sender_id===e?"var(--neutral-50)":"var(--neutral-900)"},children:ke.content})}),_t&&s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",lineHeight:"var(--typography-meta-line-height, 1.5)",textAlign:Xe?"right":"left",margin:0},children:Rt(gs(ke.created_at),"h:mm a")})]},ke.id)})})]},`group-${It}-${Ie}`)})]},`session-${It}`)})};return R?s.jsx(A1,{text:"Loading messages..."}):s.jsxs("div",{className:"flex min-h-screen w-full max-w-[393px] mx-auto",style:{backgroundColor:"var(--neutral-50)"},children:[!a&&s.jsx(Qo,{menuOpen:r,onMenuClick:n,children:s.jsx("h1",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",color:"var(--neutral-900)"},children:"Messages"})}),!l&&s.jsxs("div",{className:"w-full flex flex-col",children:[s.jsx("div",{style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:a?"calc(env(safe-area-inset-top, 0px) + var(--spacing-small, 12px))":"calc(env(safe-area-inset-top, 0px) + 68px + var(--spacing-small, 12px))",paddingBottom:0},children:s.jsx(Nn,{variant:"primary",size:"standard",fullWidth:!0,icon:"plus",iconPosition:"right",onClick:pe=>{pe.preventDefault(),console.log(" Button clicked! Opening user search"),x(!0)},children:"New Chat"})}),i.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center min-h-full",style:{gap:"var(--spacing-big-section, 60px)",padding:"var(--spacing-small, 12px)",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[s.jsxs("div",{className:"flex flex-col items-center justify-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx(Ln,{size:60,strokeWidth:2,style:{color:"var(--neutral-600)"}}),s.jsx("h2",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No Conversations Yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Start chatting with your friends!"})]}),s.jsx("div",{className:"swift-ui-card rounded-[12px] p-3 min-h-[110px] flex items-center justify-center",style:{width:"calc(100vw - 40px)",backgroundColor:"var(--neutral-200) !important",border:"3px solid var(--overlay-20) !important"},children:s.jsx("div",{className:"swift-ui-card-content",children:s.jsxs("ul",{className:"list-disc space-y-0 ml-6",style:{color:"var(--neutral-900)"},children:[s.jsx("li",{className:"mb-0",children:s.jsx("span",{style:{fontFamily:"var(--font-family)",color:"var(--neutral-900)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:"Send friend requests first"})}),s.jsx("li",{className:"mb-0",children:s.jsx("span",{style:{fontFamily:"var(--font-family)",color:"var(--neutral-900)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:"Wait for them to accept"})}),s.jsx("li",{children:s.jsx("span",{style:{fontFamily:"var(--font-family)",color:"var(--neutral-900)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:"Then start chatting!"})})]})})})]}):s.jsx("div",{style:{paddingTop:0,paddingBottom:"var(--spacing-bottom-nav, 112px)",display:"flex",flexDirection:"column"},children:i.map((pe,Pe)=>s.jsx("div",{className:"cursor-pointer transition-colors",style:{padding:"var(--spacing-grouped, 24px)",paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",borderBottom:Pe<i.length-1?"1px solid var(--neutral-200)":"none",backgroundColor:(l==null?void 0:l.id)===pe.id?"var(--neutral-100)":"transparent"},onClick:()=>{var Ne;try{const Ye=(Ne=pe.users)==null?void 0:Ne.find(We=>We!==e);Zt.click("user",Ye||pe.id,{action:"open_chat",is_group_chat:pe.is_group_chat,source:"chat_list"},Ye||void 0)}catch(Ye){console.error("Error tracking chat open:",Ye)}c(pe)},onMouseEnter:Ne=>{(l==null?void 0:l.id)!==pe.id&&(Ne.currentTarget.style.backgroundColor="var(--neutral-100)")},onMouseLeave:Ne=>{(l==null?void 0:l.id)!==pe.id&&(Ne.currentTarget.style.backgroundColor="transparent")},children:s.jsxs("div",{className:"flex items-center gap-3",children:[pe.has_unread?s.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0 animate-pulse",style:{backgroundColor:"var(--brand-pink-500)"}}):s.jsx("div",{className:"w-3 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 flex items-center gap-4 cursor-pointer min-w-0",children:[s.jsxs(Wr,{className:"w-12 h-12 flex-shrink-0",children:[s.jsx(Qr,{src:Ce(pe)||void 0}),s.jsx(Hr,{className:"font-medium",style:{backgroundImage:"var(--gradient-brand)",color:"var(--neutral-50)"},children:pe.is_group_chat?s.jsx(Vr,{className:"w-6 h-6"}):Ue(pe).split(" ").map(Ne=>Ne[0]).join("")})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[s.jsx("h3",{className:"font-semibold break-words",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)"},children:Ue(pe)}),pe.latest_message_created_at&&s.jsx("span",{className:"text-xs flex-shrink-0 font-medium whitespace-nowrap",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:Nt(pe.latest_message_created_at)})]}),s.jsx("p",{className:"text-sm break-words mb-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:pe.latest_message?s.jsxs("span",{children:[s.jsxs("span",{className:"font-medium",children:[pe.latest_message_sender_name,":"]})," ",pe.latest_message]}):s.jsx("span",{style:{color:"var(--neutral-600)"},children:"No messages yet"})}),pe.is_group_chat&&pe.is_verified&&s.jsx("div",{className:"flex items-center gap-2 mt-2",children:s.jsxs(et,{variant:"default",className:"text-xs font-medium",style:{backgroundColor:"var(--status-success-050)",color:"var(--status-success-500)",border:"1px solid var(--status-success-500)"},children:[s.jsx(wl,{className:"w-3 h-3 mr-1"}),"Verified ",pe.entity_type?pe.entity_type.charAt(0).toUpperCase()+pe.entity_type.slice(1):"Chat"]})})]})]}),s.jsx(ce,{variant:"ghost",size:"sm",onClick:Ne=>{Ne.stopPropagation(),rr(pe.id)},className:"hover:text-red-500 hover:bg-red-50 p-2 flex-shrink-0 rounded-lg transition-all duration-200",style:{color:"var(--neutral-600)"},children:s.jsx(Ko,{className:"w-4 h-4"})})]})},pe.id))})]}),l&&s.jsx("div",{className:"w-full flex flex-col",style:{backgroundColor:"var(--neutral-50)",minHeight:"100dvh",position:"relative"},children:s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"h-[44px] flex items-center justify-between flex-shrink-0",style:{position:"fixed",top:a?"calc(env(safe-area-inset-top, 0px))":"calc(env(safe-area-inset-top, 0px) + 68px)",left:0,right:0,maxWidth:"393px",margin:"0 auto",paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",backgroundColor:"var(--neutral-50)",boxShadow:"0px 4px 4px 0px var(--shadow-color)",zIndex:40},children:[s.jsxs("div",{className:"flex items-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx("button",{onClick:()=>c(null),className:"w-6 h-6 flex items-center justify-center cursor-pointer",children:s.jsx(ks,{className:"w-6 h-6",style:{color:"var(--neutral-900)"}})}),s.jsxs(Wr,{className:"w-8 h-8 flex-shrink-0",children:[s.jsx(Qr,{src:Ce(l)||void 0}),s.jsx(Hr,{className:"font-medium text-base",style:{backgroundImage:"var(--gradient-brand)",color:"var(--neutral-50)"},children:l.is_group_chat?s.jsx(Vr,{className:"w-5 h-5"}):Ue(l).split(" ").map(pe=>pe[0]).join("")})]}),s.jsx("h2",{className:"font-bold text-[24px] leading-[normal]",style:{color:"var(--neutral-900)"},children:Ue(l)})]}),s.jsxs(q1,{children:[s.jsx(V1,{asChild:!0,children:s.jsx(ce,{variant:"ghost",style:{width:"var(--size-input-height, 44px)",height:"var(--size-input-height, 44px)",padding:0,display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(VQ,{size:24,style:{color:"var(--neutral-900)"}})})}),s.jsxs(c0,{align:"end",className:"w-56",style:{zIndex:50},children:[l.is_group_chat&&s.jsxs(s.Fragment,{children:[s.jsxs(Yi,{onClick:ue,children:[s.jsx(Vr,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"View Users"})]}),s.jsx(v_,{})]}),s.jsxs(Yi,{onClick:()=>qe(Ae(l)),children:[s.jsx(Is,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"View Profile"})]}),s.jsxs(Yi,{onClick:()=>Ct(Ae(l)),children:[s.jsx(Qk,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Block User"})]}),s.jsxs(Yi,{onClick:ct,children:[G?s.jsx(Ud,{className:"mr-2 h-4 w-4"}):s.jsx(LQ,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:G?"Unmute Notifications":"Mute Notifications"})]}),ae&&s.jsxs(s.Fragment,{children:[s.jsx(v_,{}),s.jsxs(Yi,{onClick:pt,children:[s.jsx(Lt,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"View Event"})]})]}),s.jsx(v_,{}),s.jsxs(Yi,{onClick:At,className:"text-red-600 focus:text-red-600",children:[s.jsx(Ko,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Delete Chat"})]})]})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",style:{maxWidth:"353px",width:"100%",margin:"0 auto",paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:a?"calc(env(safe-area-inset-top, 0px) + 44px + var(--spacing-small, 12px))":"calc(env(safe-area-inset-top, 0px) + 68px + 44px + var(--spacing-small, 12px))",paddingBottom:"calc(44px + var(--spacing-screen-margin-x, 20px) + env(safe-area-inset-bottom, 0px) + var(--spacing-bottom-nav, 112px))"},children:l.is_group_chat?s.jsxs(s.Fragment,{children:[s.jsx("div",{style:{position:"absolute",top:a?"var(--spacing-small, 12px)":"calc(68px + var(--spacing-small, 12px))",left:"var(--spacing-screen-margin-x, 20px)",zIndex:10},children:s.jsx(Nn,{variant:"secondary",icon:"leftArrow",iconPosition:"left",onClick:()=>{window.scrollTo(0,0),t&&t()},children:"Back"})}),s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsxs("div",{className:"flex flex-col items-center justify-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx(Ln,{size:60,className:"mx-auto",style:{color:"var(--neutral-600)"}}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"Coming Soon"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Group chats are still in development"})]})})]}):d.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx(Ln,{size:60,strokeWidth:2,style:{color:"var(--neutral-600)"}}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No Messages Yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Start the conversation!"})]}):s.jsxs("div",{className:"flex flex-col",style:{paddingTop:"var(--spacing-grouped, 24px)",paddingBottom:"var(--spacing-grouped, 24px)"},children:[yt(),s.jsx("div",{ref:me})]})}),!l.is_group_chat&&s.jsx("div",{style:{position:"fixed",bottom:"calc(var(--spacing-bottom-nav, 112px) + env(safe-area-inset-bottom, 0px))",left:0,right:0,maxWidth:"393px",margin:"0 auto",paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:"var(--spacing-grouped, 24px)",paddingBottom:"var(--spacing-screen-margin-x, 20px)",backgroundColor:"rgba(250, 250, 250, 0.95)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",zIndex:40},children:s.jsxs("div",{className:"border-2 rounded-[10px] flex items-center justify-between h-[44px] pl-5 pr-[1px]",style:{backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",borderColor:"rgba(236, 72, 153, 0.2)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.08)"},children:[s.jsx(Nr,{value:u,onChange:pe=>h(pe.target.value),placeholder:"Type a message...",onKeyPress:pe=>pe.key==="Enter"&&ze(),className:"bg-transparent border-0 flex-1 h-full text-[16px] focus-visible:ring-0 focus-visible:ring-offset-0 px-0",style:{color:"var(--neutral-600)"},id:"chat-message-input","aria-label":"Type a message","aria-describedby":"chat-send-button"}),s.jsx(ce,{onClick:ze,disabled:!u.trim(),className:"h-[44px] w-[44px] p-0 rounded-br-[10px] rounded-tr-[10px] rounded-bl-0 rounded-tl-0 disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0",style:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},onMouseEnter:pe=>{pe.currentTarget.disabled||(pe.currentTarget.style.backgroundColor="var(--brand-pink-600)")},onMouseLeave:pe=>{pe.currentTarget.style.backgroundColor="var(--brand-pink-500)"},id:"chat-send-button","aria-label":"Send message","aria-describedby":u.trim()?void 0:"chat-send-disabled-hint",children:s.jsx(qc,{className:"w-[22px] h-[22px]",style:{color:"var(--neutral-50)"},"aria-hidden":"true"})}),!u.trim()&&s.jsx("span",{id:"chat-send-disabled-hint",className:"sr-only",children:"Message input is empty"})]})})]})}),g&&s.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[9999]",style:{backgroundColor:"var(--overlay-50)"},children:s.jsxs("div",{className:"border rounded-[10px] h-[452px] flex flex-col p-3 relative",style:{width:"calc(100vw - 40px)",backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",boxShadow:"0px 4px 4px 0px var(--shadow-color)"},children:[s.jsx("button",{onClick:()=>{x(!1),A([]),k("")},className:"absolute top-3 right-3 w-6 h-6 flex items-center justify-center cursor-pointer rounded transition-colors",style:{color:"var(--neutral-900)"},onMouseEnter:pe=>{pe.currentTarget.style.backgroundColor="var(--neutral-100)"},onMouseLeave:pe=>{pe.currentTarget.style.backgroundColor="transparent"},children:s.jsx(Yr,{className:"w-5 h-5",style:{color:"var(--neutral-900)"}})}),s.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[s.jsx("h2",{className:"font-bold text-[20px] leading-[normal]",style:{color:"var(--neutral-900)"},children:"Select Users to Chat With"}),s.jsx("div",{className:"w-full",children:s.jsx(Ai,{placeholder:"Search users...",value:S,onChange:pe=>k(pe),widthVariant:"full"})}),s.jsx("div",{className:"flex flex-col h-[235px] overflow-y-auto overflow-x-hidden",style:{gap:"var(--spacing-small, 12px)"},children:sr.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center",style:{gap:"var(--spacing-inline, 6px)",paddingTop:"var(--spacing-grouped, 24px)",paddingBottom:"var(--spacing-grouped, 24px)"},children:[s.jsx(Vr,{className:"w-[60px] h-[60px] mx-auto",style:{color:"var(--neutral-600)"}}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No friends to chat with yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"You need to be friends with someone before you can chat with them."})]}):sr.map(pe=>{const Pe=C.some(Ne=>Ne.user_id===pe.user_id);return s.jsxs("div",{className:"border rounded-[10px] shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)] h-[60px] cursor-pointer flex items-center px-[7px] gap-[45px] transition-all ",style:{borderColor:"var(--brand-pink-500)",backgroundColor:Pe?"var(--brand-pink-050)":"var(--neutral-50)"},onClick:()=>{vt(pe.user_id),x(!1),A([]),k("")},children:[s.jsxs("div",{className:"flex items-center gap-[6px] flex-1 min-w-0",children:[s.jsxs(Wr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(Qr,{src:pe.avatar_url||void 0}),s.jsx(Hr,{className:"bg-synth-beige/50 text-synth-black font-medium text-sm",children:pe.name.split(" ").map(Ne=>Ne[0]).join("")})]}),s.jsxs("div",{className:"flex flex-col gap-[6px] justify-center min-w-0 flex-1",children:[s.jsx("p",{className:"font-bold text-[20px] leading-[normal] truncate",style:{color:"var(--neutral-900)"},children:pe.name}),pe.bio&&s.jsx("p",{className:"font-normal text-[16px] leading-[normal] truncate",style:{color:"var(--neutral-600)"},children:pe.bio})]})]}),s.jsx(Uy,{className:"w-6 h-6 flex-shrink-0",style:{color:"var(--neutral-900)"}})]},pe.user_id)})})]})]})}),b&&s.jsx("div",{className:"fixed inset-0 backdrop-blur-sm flex items-center justify-center z-[9999]",style:{backgroundColor:"var(--overlay-50)"},children:s.jsxs("div",{className:"rounded-3xl p-8 w-full max-w-lg mx-4 shadow-2xl border-2",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",boxShadow:"0 25px 50px -12px var(--shadow-color)"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--neutral-900)"},children:"Create Group Chat"}),s.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>N(!1),className:"rounded-xl h-9 w-9 p-0",onMouseEnter:pe=>{pe.currentTarget.style.backgroundColor="var(--neutral-100)"},onMouseLeave:pe=>{pe.currentTarget.style.backgroundColor="transparent"},children:s.jsx(Yr,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex items-center justify-center py-16",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(Ln,{className:"w-12 h-12 mx-auto text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Group chats are still in development"})]})}),s.jsx(ce,{onClick:()=>N(!1),className:"w-full shadow-lg hover:shadow-xl rounded-xl py-6 font-semibold text-base transition-all duration-300",style:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},onMouseEnter:pe=>{pe.currentTarget.style.backgroundColor="var(--brand-pink-600)"},onMouseLeave:pe=>{pe.currentTarget.style.backgroundColor="var(--brand-pink-500)"},children:"Close"})]})}),Z&&Y&&s.jsx(vn,{open:Z,onOpenChange:pe=>{ne(pe),pe||(X(null),xe(null),de(!1))},children:s.jsxs(hn,{className:"max-w-6xl w-[95vw] h-[95vh] max-h-[95vh] p-0 overflow-hidden flex flex-col",hideCloseButton:!0,children:[s.jsx(Sn,{className:"sr-only",children:"Review Details"}),s.jsx(ds,{className:"sr-only",children:"Review details"}),s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",style:{borderColor:"var(--neutral-200)",backgroundColor:"var(--neutral-50)"},children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Wr,{className:"w-10 h-10",children:[s.jsx(Qr,{src:((Fe=Y.author)==null?void 0:Fe.avatar_url)||void 0}),s.jsx(Hr,{style:{backgroundImage:"var(--gradient-brand)",color:"var(--neutral-50)"},children:((Et=(ft=Y.author)==null?void 0:ft.name)==null?void 0:Et.charAt(0))||"U"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("span",{className:"font-semibold",children:((hr=Y.author)==null?void 0:hr.name)||"User"})}),s.jsx("div",{className:"text-xs",style:{color:"var(--neutral-600)"},children:new Date(Y.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]}),s.jsx(ce,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>ne(!1),children:s.jsx(Yr,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s.jsxs("div",{className:"flex-1 bg-black flex items-center justify-center min-h-0 relative",children:[_e!=null&&_e.photos&&_e.photos.length>0||Y.photos&&Y.photos.length>0?s.jsx("img",{src:(_e==null?void 0:_e.photos[0])||((dr=Y.photos)==null?void 0:dr[0]),alt:"Review photo",className:"max-w-full max-h-full object-contain"}):s.jsxs("div",{className:"text-center",style:{color:"var(--neutral-50)"},children:[s.jsxs("div",{className:"text-6xl font-bold mb-4",children:[s.jsx("span",{className:"text-pink-500",children:"S"}),"ynth"]}),s.jsx("div",{className:"w-32 h-0.5 bg-white mx-auto mb-4"}),s.jsx("div",{className:"text-sm opacity-80",children:"Concert Review"})]}),(_e==null?void 0:_e.reactionEmoji)&&s.jsx("div",{className:"absolute top-4 right-4 text-4xl bg-white/20 backdrop-blur-sm rounded-full w-16 h-16 flex items-center justify-center",children:_e.reactionEmoji})]}),s.jsx("div",{className:"flex-1 flex flex-col bg-white overflow-y-auto",children:se?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsxs("div",{className:"text-center",children:[s.jsx(fr,{className:"h-8 w-8 animate-spin text-indigo-500 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Loading review details..."})]})}):s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:((cn=Y.event_info)==null?void 0:cn.event_name)||Y.title||"Concert Review"}),s.jsx("div",{className:"flex flex-wrap items-center gap-2 text-sm text-gray-600 mb-3",children:((mn=Y.event_info)==null?void 0:mn.artist_name)&&s.jsx(et,{variant:"secondary",className:"cursor-pointer hover:bg-indigo-100",children:Y.event_info.artist_name})}),((je=Y.event_info)==null?void 0:je.venue_name)&&s.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[s.jsx(yr,{className:"w-4 h-4"}),s.jsx("span",{children:Y.event_info.venue_name})]})]}),Y.rating&&s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(pe,Pe)=>{const Ne=Pe+1,Ye=Y.rating||0,We=Ne<=Math.floor(Ye),It=!We&&Ne-.5<=Ye;return s.jsxs("div",{className:"relative w-6 h-6",children:[s.jsx(Xt,{className:"w-6 h-6 text-gray-300"}),(It||We)&&s.jsx("div",{className:`absolute left-0 top-0 h-full overflow-hidden pointer-events-none ${We?"w-full":"w-1/2"}`,children:s.jsx(Xt,{className:"w-6 h-6 text-yellow-500 fill-yellow-500"})})]},Pe)})}),s.jsxs("span",{className:"text-lg font-semibold",children:[Y.rating,"/5"]})]}),Y.content&&s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold mb-2 text-gray-900",children:"Review"}),s.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:Y.content})]}),s.jsxs("div",{className:"flex items-center gap-6 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[s.jsx(es,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:Y.likes_count||0})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[s.jsx(Ln,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:Y.comments_count||0})]})]})]})})]})]})}),B&&s.jsx(Hl,{event:B,currentUserId:e,isOpen:z,onClose:()=>{M(!1),F(null),K(pe=>pe+1)},onInterestToggle:Te,isInterested:U}),we&&l&&l.is_group_chat&&s.jsx(vn,{open:we,onOpenChange:ve,children:s.jsxs(hn,{className:"max-w-[393px] max-h-[80vh] overflow-y-auto",style:{backgroundColor:"var(--neutral-50)"},children:[s.jsxs(Hn,{children:[s.jsxs(Sn,{className:"text-[20px] font-bold",style:{color:"var(--neutral-900)"},children:["Group Members (",ie.length,")"]}),s.jsx(ds,{className:"text-[16px]",style:{color:"var(--neutral-600)"},children:"Members of this group chat"})]}),s.jsx("div",{className:"space-y-3 mt-4",children:ie.length===0?s.jsxs("div",{className:"flex flex-col gap-[6px] items-center justify-center py-8",children:[s.jsx(Vr,{className:"w-[60px] h-[60px] mx-auto",style:{color:"var(--neutral-600)"}}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"No members found"})]}):ie.map(pe=>{const Pe=pe.user_id===e,Ne=pe.is_admin;return s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-[10px] transition-colors",style:{borderColor:"var(--neutral-200)",backgroundColor:"var(--neutral-100)"},children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 cursor-pointer",onClick:()=>{qe(pe.user_id),ve(!1)},children:[s.jsxs(Wr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(Qr,{src:pe.avatar_url||void 0}),s.jsx(Hr,{className:"font-medium",style:{backgroundImage:"var(--gradient-brand)",color:"var(--neutral-50)"},children:pe.name.split(" ").map(Ye=>Ye[0]).join("")})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h3",{className:"font-semibold text-[16px] truncate",style:{color:"var(--neutral-900)"},children:[pe.name,Pe&&s.jsx("span",{className:"text-[14px] font-normal ml-1",style:{color:"var(--neutral-600)"},children:"(You)"})]}),pe.verified&&s.jsx(et,{variant:"default",className:"text-[10px]",style:{backgroundColor:"var(--status-success-500)",color:"var(--neutral-50)"},children:" Verified"})]}),pe.bio&&s.jsx("p",{className:"text-[14px] truncate mt-1",style:{color:"var(--neutral-600)"},children:pe.bio}),s.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[Ne&&s.jsx(et,{variant:"default",className:"text-[12px]",style:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},children:"Admin"}),s.jsxs("span",{className:"text-[12px]",style:{color:"var(--neutral-600)"},children:["Joined ",Rt(gs(pe.joined_at),"MMM d, yyyy")]})]})]})]}),!Pe&&s.jsx(ce,{variant:"ghost",size:"sm",onClick:Ye=>{Ye.stopPropagation(),qe(pe.user_id),ve(!1)},className:"p-2 flex-shrink-0",style:{color:"var(--neutral-600)"},onMouseEnter:Ye=>{Ye.currentTarget.style.color="var(--brand-pink-500)",Ye.currentTarget.style.backgroundColor="var(--brand-pink-050)"},onMouseLeave:Ye=>{Ye.currentTarget.style.color="var(--neutral-600)",Ye.currentTarget.style.backgroundColor="transparent"},children:s.jsx(Is,{className:"w-4 h-4"})})]},pe.id||pe.user_id)})})]})})]})};class Mh{static fetchAllNews(){return E(this,null,function*(){const t=this.getCachedNews();if(t)return console.log(" Using cached news articles"),t;console.log(" Fetching fresh news articles from RSS feeds");const r=[],n=this.SOURCES.map(i=>this.fetchFromSource(i));return(yield Promise.allSettled(n)).forEach((i,o)=>{i.status==="fulfilled"?(r.push(...i.value),console.log(` ${this.SOURCES[o].displayName}: ${i.value.length} articles`)):console.error(` ${this.SOURCES[o].displayName}: ${i.reason}`)}),r.sort((i,o)=>new Date(o.pubDate).getTime()-new Date(i.pubDate).getTime()),this.cacheNews(r),r})}static fetchFromSource(t){return E(this,null,function*(){try{const r=`https://api.allorigins.win/raw?url=${encodeURIComponent(t.url)}`,n=yield fetch(r);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const a=yield n.text();return this.parseRSSFeed(a,t)}catch(r){return console.error(`Error fetching from ${t.displayName}:`,r),[]}})}static parseRSSFeed(t,r){const n=[];try{const i=new DOMParser().parseFromString(t,"text/xml"),o=i.querySelector("parsererror");if(o)throw new Error(`XML parsing error: ${o.textContent}`);i.querySelectorAll("item").forEach((c,d)=>{var f,u,h,m,v,g,x,_,w,b,N,S,k,C,A;try{const R=((u=(f=c.querySelector("title"))==null?void 0:f.textContent)==null?void 0:u.trim())||"",I=((m=(h=c.querySelector("description"))==null?void 0:h.textContent)==null?void 0:m.trim())||"",O=((g=(v=c.querySelector("link"))==null?void 0:v.textContent)==null?void 0:g.trim())||"",z=((_=(x=c.querySelector("pubDate"))==null?void 0:x.textContent)==null?void 0:_.trim())||"",M=((b=(w=c.querySelector("author"))==null?void 0:w.textContent)==null?void 0:b.trim())||((S=(N=c.querySelector("dc\\:creator"))==null?void 0:N.textContent)==null?void 0:S.trim())||((C=(k=c.querySelector("creator"))==null?void 0:k.textContent)==null?void 0:C.trim())||"";let B="";const F=c.querySelector("media\\:content"),U=c.querySelector("enclosure");if(F)B=F.getAttribute("url")||"";else if(U&&((A=U.getAttribute("type"))!=null&&A.startsWith("image/")))B=U.getAttribute("url")||"";else{const H=I.match(/<img[^>]+src="([^"]+)"/i);H&&(B=H[1])}R&&O&&this.isMusicRelated(R,I)&&n.push({id:`${r.name}-${d}-${Date.now()}`,title:this.cleanText(R),description:this.cleanText(I),link:O,pubDate:this.parseDate(z),source:r.displayName,imageUrl:B||void 0,author:M||void 0})}catch(R){console.error(`Error parsing item ${d} from ${r.displayName}:`,R)}})}catch(a){console.error(`Error parsing RSS feed from ${r.displayName}:`,a)}return n}static isMusicRelated(t,r){const n=`${t} ${r}`.toLowerCase(),a=["music","song","album","artist","band","concert","tour","live music","musician","singer","guitarist","drummer","bassist","pianist","vocalist","rock","pop","hip hop","rap","jazz","blues","country","electronic","indie","alternative","metal","punk","reggae","soul","r&b","folk","festival","gig","venue","music video","single","ep","soundtrack","record label","music producer","dj","remix","cover","collaboration","music industry","streaming","spotify","apple music","billboard","grammy","mtv","music awards","chart","top 40","radio","playlist"],i=["game","gaming","video game","xbox","playstation","nintendo","movie","film","tv show","television","series","netflix","sports","football","basketball","soccer","baseball","tennis","politics","election","president","government","political","technology","tech","computer","software","hardware","iphone","business","economy","finance","stock","market","crypto","food","restaurant","recipe","cooking","chef","fashion","clothing","style","beauty","makeup","travel","vacation","hotel","flight","tourism"];for(const o of i)if(n.includes(o))return console.log(` Filtered out non-music article: "${t}" (keyword: ${o})`),!1;for(const o of a)if(n.includes(o))return console.log(` Music article found: "${t}" (keyword: ${o})`),!0;return console.log(` Unclear content filtered out: "${t}"`),!1}static cleanText(t){return t.replace(/<[^>]*>/g,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&nbsp;/g," ").trim()}static parseDate(t){try{const r=new Date(t);return isNaN(r.getTime())?new Date().toISOString():r.toISOString()}catch(r){return console.error("Error parsing date:",t,r),new Date().toISOString()}}static getCachedNews(){try{const t=localStorage.getItem("news-cache");if(!t)return null;const r=JSON.parse(t);return Date.now()<r.expiresAt?r.articles:(localStorage.removeItem("news-cache"),null)}catch(t){return console.error("Error reading news cache:",t),localStorage.removeItem("news-cache"),null}}static cacheNews(t){try{const r=Date.now(),n={articles:t,timestamp:r,expiresAt:r+this.CACHE_DURATION};localStorage.setItem("news-cache",JSON.stringify(n)),console.log(` Cached ${t.length} news articles for ${this.CACHE_DURATION/1e3/60} minutes`)}catch(r){console.error("Error caching news:",r)}}static getSources(){return this.SOURCES.map(t=>D({},t))}static filterBySource(t,r){if(r==="all")return t;const n=this.SOURCES.find(a=>a.name===r);return n?t.filter(a=>a.source===n.displayName):t}static clearCache(){localStorage.removeItem("news-cache"),console.log(" News cache cleared - will fetch fresh articles with music filtering")}static scoreArticleRelevance(t,r,n){let a=0;const i=`${t.title} ${t.description}`.toLowerCase();for(const f of r)if(i.includes(f.artist_name.toLowerCase())){a+=Math.min(f.score*1.5,60),console.log(` Artist match: "${f.artist_name}" in "${t.title}" (+${Math.min(f.score*1.5,60)} pts)`);break}let o=0,l=0;const c=[];for(const f of n)i.includes(f.genre.toLowerCase())&&(o+=f.score,l++,c.push(f.genre));if(l>0){const f=Math.min(o/l*1.33,40);a+=f,console.log(` Genre match: [${c.join(", ")}] in "${t.title}" (+${f.toFixed(1)} pts)`)}const d=Math.min(a,100);return d>0&&console.log(` Article scored: "${t.title}" = ${d.toFixed(1)}/100`),d}static getPersonalizedNews(t){return E(this,null,function*(){var r,n,a,i,o;try{console.log(" Fetching personalized news for user:",t);const l=yield this.fetchAllNews();if(!(yield em.userHasMusicData(t)))return console.log(" No music data for user, returning all news sorted by date"),l;const d=yield em.getUserTopArtists(t,50),f=yield em.getUserTopGenres(t,20);if(console.log(" User music profile:",{artists:d.length,genres:f.length,topArtist:(r=d[0])==null?void 0:r.artist_name,topGenre:(n=f[0])==null?void 0:n.genre}),d.length===0&&f.length===0)return console.log(" No artist/genre preferences found, returning all news"),l;const h=l.map(m=>{const v=this.scoreArticleRelevance(m,d,f);return V(D({},m),{relevance_score:v})}).sort((m,v)=>v.relevance_score!==m.relevance_score?(v.relevance_score||0)-(m.relevance_score||0):new Date(v.pubDate).getTime()-new Date(m.pubDate).getTime());return console.log(" Personalized news complete:",{total:h.length,topScore:(i=(a=h[0])==null?void 0:a.relevance_score)==null?void 0:i.toFixed(1),topArticle:(o=h[0])==null?void 0:o.title,personalizedCount:h.filter(m=>(m.relevance_score||0)>0).length}),h}catch(l){return console.error(" Error in personalized news:",l),this.fetchAllNews()}})}}Pr(Mh,"CACHE_DURATION",5*60*1e3),Pr(Mh,"SOURCES",[{name:"pitchfork",url:"https://pitchfork.com/rss/news/",displayName:"Pitchfork"},{name:"rollingstone",url:"https://www.rollingstone.com/music/rss/",displayName:"Rolling Stone"},{name:"nme",url:"https://www.nme.com/music/feed/",displayName:"NME"},{name:"billboard",url:"https://www.billboard.com/feed/rss",displayName:"Billboard"}]);function _me({article:e,className:t=""}){const r=i=>{try{const o=gs(i),c=Math.abs(new Date().getTime()-o.getTime())/(1e3*60*60);return c<24?Rt(o,"h:mm a"):c<168?Rt(o,"EEEE"):Rt(o,"MMM d")}catch(o){return"Recent"}},n=(i,o=150)=>i.length<=o?i:i.substring(0,o).trim()+"...",a=()=>{window.open(e.link,"_blank","noopener,noreferrer")};return s.jsxs(Ze,{className:`overflow-hidden hover:shadow-md transition-all duration-200 cursor-pointer group ${t}`,children:[e.imageUrl&&s.jsx("div",{className:"h-48 w-full overflow-hidden bg-gray-100",children:s.jsx("img",{src:e.imageUrl,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",loading:"lazy",onError:i=>{const o=i.target;o.style.display="none",o.parentElement.style.display="none"}})}),s.jsxs(tt,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(et,{variant:"secondary",className:"flex items-center gap-1 text-xs bg-pink-100 text-pink-700 hover:bg-pink-200",children:[s.jsx($P,{className:"w-3 h-3"}),e.source]}),e.relevance_score&&e.relevance_score>50&&s.jsxs(et,{variant:"secondary",className:"flex items-center gap-1 text-xs bg-gradient-to-r from-purple-100 to-pink-100 text-purple-700 border-purple-200",children:[s.jsx(Xt,{className:"w-3 h-3 fill-purple-500"}),"For You"]})]}),s.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[s.jsx(Lt,{className:"w-3 h-3"}),r(e.pubDate)]})]}),s.jsx("h3",{className:"font-semibold text-lg mb-2 line-clamp-2 text-gray-900 group-hover:text-pink-600 transition-colors",children:e.title}),e.description&&s.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-3 leading-relaxed",children:n(e.description)}),e.author&&s.jsxs("div",{className:"flex items-center gap-1 mb-3 text-xs text-gray-500",children:[s.jsx(Is,{className:"w-3 h-3"}),s.jsx("span",{children:e.author})]}),s.jsxs(ce,{onClick:a,variant:"outline",size:"sm",className:"w-full border-pink-200 text-pink-600 hover:bg-pink-50 hover:border-pink-300 transition-colors",children:[s.jsx(io,{className:"w-4 h-4 mr-2"}),"Read More"]})]})]})}function wme({className:e=""}){return s.jsxs(Ze,{className:`overflow-hidden ${e}`,children:[s.jsx("div",{className:"h-48 w-full bg-gray-200 animate-pulse"}),s.jsxs(tt,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"h-5 w-20 bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"})]}),s.jsxs("div",{className:"space-y-2 mb-2",children:[s.jsx("div",{className:"h-5 w-full bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-5 w-3/4 bg-gray-200 rounded animate-pulse"})]}),s.jsxs("div",{className:"space-y-2 mb-3",children:[s.jsx("div",{className:"h-3 w-full bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-3 w-full bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-3 w-2/3 bg-gray-200 rounded animate-pulse"})]}),s.jsx("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse mb-3"}),s.jsx("div",{className:"h-8 w-full bg-gray-200 rounded animate-pulse"})]})]})}function ef(e){return e?e.id&&typeof e.id=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e.id)?e.id:e.event_id&&typeof e.event_id=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e.event_id)?e.event_id:null:null}function Vg(e){return e?e.id&&typeof e.id=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e.id)?e.id:e.artist_id&&typeof e.artist_id=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e.artist_id)?e.artist_id:e.artist_uuid&&typeof e.artist_uuid=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e.artist_uuid)?e.artist_uuid:null:null}function Gv(e){const t={};return e&&(e.artist_name&&(t.artist_name=e.artist_name),e.venue_name&&(t.venue_name=e.venue_name),e.event_date&&(t.event_date=e.event_date),e.venue_city&&(t.venue_city=e.venue_city),e.venue_state&&(t.venue_state=e.venue_state),e.genres&&Array.isArray(e.genres)&&(t.genres=e.genres),e.price_range&&(t.price_range=e.price_range),e.title&&(t.title=e.title)),t}function rA(e){const t={};return e&&(e.name&&(t.artist_name=e.name),e.artist_name&&(t.artist_name=e.artist_name),e.genres&&Array.isArray(e.genres)&&(t.genres=e.genres)),t}function nA(e){const t={};return e&&(e.name&&(t.venue_name=e.name),e.venue_name&&(t.venue_name=e.venue_name),(e.city||e.venue_city)&&(t.venue_city=e.city||e.venue_city),(e.state||e.venue_state)&&(t.venue_state=e.state||e.venue_state)),t}const U2=Object.freeze(Object.defineProperty({__proto__:null,getArtistMetadata:rA,getArtistUuid:Vg,getEventMetadata:Gv,getEventUuid:ef,getVenueMetadata:nA},Symbol.toStringTag,{value:"Module"})),sA=({event:e,onClick:t,className:r})=>{const n=e.event_date?new Date(e.event_date):null,a=e.doors_time?new Date(e.doors_time):null,i=d=>d?Rt(d,"EEE, MMM d"):"",o=d=>d?Rt(d,"h:mm a"):"",l=()=>{const d=[e.venue_city,e.venue_state].filter(Boolean);return d.length>0?d.join(", "):"Location TBD"},c=()=>{if(t){try{const d=ef(e),f=Gv(e);Zt.click("event",e.id,V(D({},f),{source:"event_card"}),d||void 0)}catch(d){console.error("Error tracking event card click:",d)}t()}};return s.jsxs("button",{onClick:c,className:Oe("w-full text-left overflow-hidden relative group","transition-all duration-300 ease-out",r),style:{backgroundColor:"color-mix(in srgb, var(--neutral-0) 85%, transparent)",backdropFilter:"blur(40px) saturate(180%)",WebkitBackdropFilter:"blur(40px) saturate(180%)",border:"1px solid color-mix(in srgb, var(--neutral-0) 30%, transparent)",boxShadow:"0 4px 4px 0 var(--shadow-color), inset 0 1px 0 0 color-mix(in srgb, var(--neutral-0) 60%, transparent)",padding:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",cursor:t?"pointer":"default",outline:"none"},onMouseEnter:d=>{t&&(d.currentTarget.style.transform="translateY(-4px)",d.currentTarget.style.boxShadow="0 12px 40px 0 rgba(0, 0, 0, 0.12), 0 4px 12px 0 rgba(0, 0, 0, 0.08), inset 0 1px 0 0 rgba(255, 255, 255, 0.8)",d.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.95)")},onMouseLeave:d=>{t&&(d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="0 8px 32px 0 rgba(0, 0, 0, 0.1), 0 2px 8px 0 rgba(0, 0, 0, 0.05), inset 0 1px 0 0 rgba(255, 255, 255, 0.6)",d.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.85)")},onMouseDown:d=>{t&&(d.currentTarget.style.transform="translateY(-2px) scale(0.98)")},onMouseUp:d=>{t&&(d.currentTarget.style.transform="translateY(-4px) scale(1)")},"aria-label":`View event: ${e.title}`,children:[s.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{borderRadius:"var(--radius-corner, 10px)",background:"linear-gradient(135deg, color-mix(in srgb, var(--neutral-0) 12%, transparent) 0%, transparent 50%, color-mix(in srgb, var(--brand-pink-050) 20%, transparent) 100%)"}}),s.jsxs("div",{className:"relative z-10 flex flex-col",style:{gap:"var(--spacing-small, 12px)"},children:[s.jsx("h3",{className:"font-bold leading-tight line-clamp-2",style:{fontSize:"var(--typography-meta-size, 16px)",fontFamily:"var(--font-family)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},children:e.title}),s.jsxs("div",{className:"flex flex-col",style:{gap:"var(--spacing-inline, 6px)"},children:[n&&s.jsxs("div",{className:"flex items-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx(Lt,{size:14,className:"flex-shrink-0",style:{color:"var(--brand-pink-500)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-700)"},children:i(n)})]}),n&&s.jsxs("div",{className:"flex items-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx(Oa,{size:14,className:"flex-shrink-0",style:{color:"var(--brand-pink-500)"}}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[o(n),a&&`  Doors: ${o(a)}`]})]})]}),(e.venue_name||e.venue_city||e.venue_state)&&s.jsxs("div",{className:"flex flex-col pt-1 border-t border-solid",style:{gap:"var(--spacing-inline, 6px)",borderColor:"var(--neutral-200)"},children:[e.venue_name&&s.jsxs("div",{className:"flex items-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx(yr,{size:14,className:"flex-shrink-0",style:{color:"var(--brand-pink-500)"}}),s.jsx("span",{className:"truncate",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-700)"},title:e.venue_name,children:e.venue_name})]}),(e.venue_city||e.venue_state)&&s.jsx("span",{style:{paddingLeft:"calc(var(--spacing-inline, 6px) * 2)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:l()})]}),e.genres&&e.genres.length>0&&s.jsx("div",{className:"flex flex-wrap pt-1",style:{gap:"var(--spacing-inline, 6px)"},children:e.genres.slice(0,2).map((d,f)=>s.jsx("span",{className:"inline-flex items-center",style:{height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"999px",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)"},children:d},f))}),s.jsxs("div",{className:"flex items-center justify-between pt-1 border-t border-solid",style:{borderColor:"rgba(0, 0, 0, 0.08)"},children:[e.price_range?s.jsx("span",{className:"font-semibold",style:{fontSize:"14px",fontFamily:"var(--font-family)",color:"var(--neutral-900)"},children:`$${e.price_range.replace(/^\$+/,"")}`}):s.jsx("span",{className:"font-medium",style:{fontSize:"13px",fontFamily:"var(--font-family)",color:"var(--neutral-500)"},children:"Price TBD"}),e.ticket_available&&e.ticket_urls&&e.ticket_urls.length>0&&s.jsxs("a",{href:e.ticket_urls[0],target:"_blank",rel:"noopener noreferrer",onClick:d=>d.stopPropagation(),className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg font-semibold transition-all",style:{backgroundColor:"var(--brand-pink-500)",color:"white",fontSize:"12px",fontFamily:"var(--font-family)",boxShadow:"0 2px 8px rgba(236, 72, 153, 0.3)"},onMouseEnter:d=>{d.currentTarget.style.backgroundColor="var(--brand-pink-600)",d.currentTarget.style.transform="scale(1.05)"},onMouseLeave:d=>{d.currentTarget.style.backgroundColor="var(--brand-pink-500)",d.currentTarget.style.transform="scale(1)"},children:[s.jsx(zl,{size:12}),s.jsx("span",{children:"Buy"})]})]})]})]})};function bme({artist:e,events:t,totalEvents:r,source:n,userId:a,onBack:i,onViewAllEvents:o,showAllEvents:l=!1,className:c}){const[d,f]=te.useState(a),u=te.useMemo(()=>Vg(e),[e==null?void 0:e.id]),h=te.useMemo(()=>rA(e),[e==null?void 0:e.name,e==null?void 0:e.genres]);go("artist",u||(e==null?void 0:e.id)||(e==null?void 0:e.name)||"unknown",h,u||void 0),te.useEffect(()=>{a||T.auth.getUser().then(({data:g})=>{var x;f((x=g.user)==null?void 0:x.id)})},[a]);const m=t.filter(g=>new Date(g.event_date)>new Date),v=l?m:m.slice(0,10);return s.jsxs("div",{className:Oe("w-full max-w-4xl mx-auto space-y-6 overflow-x-hidden",c),children:[i&&s.jsx("button",{onClick:()=>{try{const g=Vg(e);Zt.click("artist",e.id||e.name||"unknown",{action:"back",source:"artist_card"},g||void 0)}catch(g){console.error("Error tracking back click:",g)}i()},className:"mb-4 flex items-center gap-2 px-4 py-2 rounded-xl font-medium transition-all",style:{backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.3)",color:"var(--neutral-700)",fontFamily:"var(--font-family)",fontSize:"15px"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.95)",g.currentTarget.style.transform="translateX(-2px)"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.85)",g.currentTarget.style.transform="translateX(0)"},children:" Back to Search"}),s.jsx(Ze,{children:s.jsx(kr,{children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsxs(Wr,{className:"w-20 h-20",children:[s.jsx(Qr,{src:e.image_url||void 0}),s.jsx(Hr,{className:"text-2xl",children:s.jsx(Ft,{className:"w-10 h-10"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[s.jsx(Lr,{className:"text-3xl",children:e.name}),s.jsx("div",{className:"flex items-center gap-2",children:d&&s.jsxs(s.Fragment,{children:[s.jsx(D1,{entityType:"artist",entityId:e.id||e.jambase_artist_id,entityName:e.name,currentUserId:d,onChatOpen:g=>{window.location.href=`/chats?chatId=${g}`},variant:"compact"}),s.jsx(n0,{artistName:e.name,jambaseArtistId:e.jambase_artist_id,userId:d,variant:"outline",size:"default",showFollowerCount:!0})]})})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jambase_artist_id&&s.jsxs(et,{variant:"outline",className:"flex items-center gap-1",children:[s.jsx(io,{className:"w-3 h-3"}),"JamBase Verified"]}),s.jsx(et,{variant:"secondary",children:n==="api"?"Live Data":"Cached Data"})]}),e.description&&s.jsx("p",{className:"text-muted-foreground leading-relaxed mb-4",children:e.description}),e.genres&&e.genres.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsx("div",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Genres"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:e.genres.map((g,x)=>s.jsx(et,{variant:"secondary",className:"text-xs",children:g},x))})]}),s.jsxs("div",{className:"flex items-center gap-6 text-sm text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"w-4 h-4"}),s.jsxs("span",{children:[r," total events"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Oa,{className:"w-4 h-4"}),s.jsxs("span",{children:[m.length," upcoming"]})]}),e.popularity_score&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Xt,{className:"w-4 h-4 text-yellow-400 fill-current"}),s.jsxs("span",{children:["Score: ",e.popularity_score]})]})]})]})]})})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Events"}),o&&r>t.length&&s.jsxs(ce,{variant:"outline",onClick:()=>{try{const g=Vg(e);Zt.click("artist",e.id||e.name||"unknown",{action:"view_all_events"},g||void 0)}catch(g){console.error("Error tracking view all events:",g)}o==null||o()},children:["View All ",r," Events"]})]}),m.length>0&&s.jsxs("div",{className:"w-full overflow-x-hidden",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[s.jsx(Lt,{className:"w-5 h-5"}),"Upcoming Events (",m.length,")"]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 w-full",children:v.map(g=>s.jsx(sA,{event:{id:g.id||g.jambase_event_id||"",title:g.title||"Event",event_date:g.event_date,venue_name:g.venue_name,venue_city:g.venue_city,venue_state:g.venue_state,doors_time:g.doors_time,price_range:g.price_range,ticket_urls:g.ticket_urls,ticket_available:g.ticket_available,genres:g.genres}},g.jambase_event_id||g.id))}),l&&m.length>10&&s.jsx("div",{className:"mt-4",children:s.jsx("button",{onClick:()=>{try{const g=Vg(e);Zt.click("artist",e.id||e.name||"unknown",{action:"view_all_events"},g||void 0)}catch(g){console.error("Error tracking view all events:",g)}o==null||o()},className:"w-full py-3 rounded-2xl font-semibold transition-all",style:{backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.3)",color:"var(--brand-pink-600)",fontFamily:"var(--font-family)",fontSize:"15px",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.08)"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.95)",g.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.85)",g.currentTarget.style.transform="translateY(0)"},children:"Show Less (Back to 10 events)"})})]}),t.length===0&&s.jsx(Ze,{children:s.jsxs(tt,{className:"text-center py-12",children:[s.jsx(Ft,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Events Found"}),s.jsxs("p",{className:"text-muted-foreground",children:["No events found for ",e.name,". This could mean:"]}),s.jsxs("ul",{className:"text-sm text-muted-foreground mt-2 space-y-1",children:[s.jsx("li",{children:" The artist has no upcoming or recent events"}),s.jsx("li",{children:" The artist name might be spelled differently"}),s.jsx("li",{children:" The events might not be in our database yet"})]})]})})]})]})}function jme({venueId:e,venueName:t,onClose:r}){var h,m,v,g;const n=e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?e:null;go("venue",n||e||t||"unknown",nA({id:n||e||void 0,name:t}),n||void 0);const[a,i]=y.useState(null),[o,l]=y.useState([]),[c,d]=y.useState([]),[f,u]=y.useState(null);return y.useEffect(()=>{T.auth.getUser().then(({data:x})=>{var _;u(((_=x.user)==null?void 0:_.id)||null)})},[]),y.useEffect(()=>{E(this,null,function*(){try{if(e){const{data:x}=yield T.from("venues").select("latitude, longitude").eq("id",e).single();x!=null&&x.latitude&&(x!=null&&x.longitude)&&i({lat:x.latitude,lng:x.longitude})}}catch(x){}try{if(e){const x=yield cs.getVenueReviews(e);l(x.reviews||[])}}catch(x){}try{const x=yield fetch(`/api/jambase/venues/upcoming?name=${encodeURIComponent(t)}`);if(x.ok){const _=yield x.json();d(Array.isArray(_==null?void 0:_.events)?_.events.slice(0,5):[])}}catch(x){}})},[e,t]),s.jsx(Ze,{className:"border-gray-200",children:s.jsxs(tt,{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1 flex-1",children:[s.jsx("h3",{className:"text-base font-semibold",children:t}),a&&s.jsxs("div",{className:"text-xs text-gray-600 flex items-center gap-1",children:[s.jsx(yr,{className:"w-3 h-3"}),s.jsxs("span",{children:[(h=a.lat)==null?void 0:h.toFixed(3),", ",(m=a.lng)==null?void 0:m.toFixed(3)]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[f&&e&&s.jsx(D1,{entityType:"venue",entityId:e,entityName:t,currentUserId:f,onChatOpen:x=>{window.location.href=`/chats?chatId=${x}`},variant:"compact"}),r&&s.jsx(ce,{variant:"ghost",size:"sm",onClick:r,children:""})]})]}),s.jsx("div",{className:"w-full h-40 rounded border flex items-center justify-center text-sm text-gray-500",children:a?`Map: ${(v=a.lat)==null?void 0:v.toFixed(3)}, ${(g=a.lng)==null?void 0:g.toFixed(3)}`:"Map location unavailable"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium mb-2",children:"Recent Reviews"}),o.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No venue reviews yet."}):s.jsx("div",{className:"space-y-2",children:o.slice(0,3).map(x=>s.jsxs("div",{className:"text-sm text-gray-700 flex items-center gap-2",children:[s.jsx(Xt,{className:"w-3 h-3 text-yellow-400 fill-current"}),s.jsxs("span",{children:[x.rating,"/5"]}),s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"truncate",children:x.review_text||"No text"})]},x.id))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium mb-2",children:"Upcoming Events"}),c.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No upcoming events found."}):s.jsx("div",{className:"space-y-2",children:c.map((x,_)=>s.jsxs("div",{className:"text-sm text-gray-700 flex items-center gap-2",children:[s.jsx(Lt,{className:"w-3 h-3"}),s.jsx("span",{className:"truncate",children:x.title||x.name||"Event"})]},_))})]})]})})}function Nme({followedArtists:e,followedVenues:t,artistName:r,venueName:n,venueCity:a,venueState:i}){const o=r&&e.includes(r),l=n&&t.some(c=>c.name===n&&(!c.city||c.city===a)&&(!c.state||c.state===i));return!o&&!l?null:o&&l?s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsxs(et,{className:"bg-[#FF3399] text-white text-xs px-2 py-0.5 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"Following Artist"})]}),s.jsxs(et,{className:"bg-blue-600 text-white text-xs px-2 py-0.5 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"Following Venue"})]})]}):o?s.jsxs(et,{className:"bg-[#FF3399] text-white text-xs px-2 py-1 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"Following Artist"})]}):l?s.jsxs(et,{className:"bg-blue-600 text-white text-xs px-2 py-1 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"Following Venue"})]}):null}var br=function(){return br=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},br.apply(this,arguments)};function Sme(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Yq(e,t,r){for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function d0(e){return e.mode==="multiple"}function u0(e){return e.mode==="range"}function W1(e){return e.mode==="single"}var kme={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function Eme(e,t){return Rt(e,"LLLL y",t)}function Cme(e,t){return Rt(e,"d",t)}function Pme(e,t){return Rt(e,"LLLL",t)}function Tme(e){return"".concat(e)}function Ame(e,t){return Rt(e,"cccccc",t)}function Rme(e,t){return Rt(e,"yyyy",t)}var Ome=Object.freeze({__proto__:null,formatCaption:Eme,formatDay:Cme,formatMonthCaption:Pme,formatWeekNumber:Tme,formatWeekdayName:Ame,formatYearCaption:Rme}),Mme=function(e,t,r){return Rt(e,"do MMMM (EEEE)",r)},Dme=function(){return"Month: "},Ime=function(){return"Go to next month"},$me=function(){return"Go to previous month"},Lme=function(e,t){return Rt(e,"cccc",t)},Fme=function(e){return"Week n. ".concat(e)},zme=function(){return"Year: "},Bme=Object.freeze({__proto__:null,labelDay:Mme,labelMonthDropdown:Dme,labelNext:Ime,labelPrevious:$me,labelWeekNumber:Fme,labelWeekday:Lme,labelYearDropdown:zme});function Ume(){var e="buttons",t=kme,r=_T,n={},a={},i=1,o={},l=new Date;return{captionLayout:e,classNames:t,formatters:Ome,labels:Bme,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:i,styles:o,today:l,mode:"default"}}function qme(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,i=e.fromDate,o=e.toDate;return n?i=yi(n):t&&(i=new Date(t,0,1)),a?o=w1(a):r&&(o=new Date(r,11,31)),{fromDate:i?km(i):void 0,toDate:o?km(o):void 0}}var Kq=y.createContext(void 0);function Vme(e){var t,r=e.initialProps,n=Ume(),a=qme(r),i=a.fromDate,o=a.toDate,l=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;l!=="buttons"&&(!i||!o)&&(l="buttons");var c;(W1(r)||d0(r)||u0(r))&&(c=r.onSelect);var d=br(br(br({},n),r),{captionLayout:l,classNames:br(br({},n.classNames),r.classNames),components:br({},r.components),formatters:br(br({},n.formatters),r.formatters),fromDate:i,labels:br(br({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:br(br({},n.modifiers),r.modifiers),modifiersClassNames:br(br({},n.modifiersClassNames),r.modifiersClassNames),onSelect:c,styles:br(br({},n.styles),r.styles),toDate:o});return s.jsx(Kq.Provider,{value:d,children:e.children})}function Gn(){var e=y.useContext(Kq);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function Zq(e){var t=Gn(),r=t.locale,n=t.classNames,a=t.styles,i=t.formatters.formatCaption;return s.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:i(e.displayMonth,{locale:r})})}function Wme(e){return s.jsx("svg",br({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:s.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Xq(e){var t,r,n=e.onChange,a=e.value,i=e.children,o=e.caption,l=e.className,c=e.style,d=Gn(),f=(r=(t=d.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:Wme;return s.jsxs("div",{className:l,style:c,children:[s.jsx("span",{className:d.classNames.vhidden,children:e["aria-label"]}),s.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:d.classNames.dropdown,style:d.styles.dropdown,value:a,onChange:n,children:i}),s.jsxs("div",{className:d.classNames.caption_label,style:d.styles.caption_label,"aria-hidden":"true",children:[o,s.jsx(f,{className:d.classNames.dropdown_icon,style:d.styles.dropdown_icon})]})]})}function Hme(e){var t,r=Gn(),n=r.fromDate,a=r.toDate,i=r.styles,o=r.locale,l=r.formatters.formatMonthCaption,c=r.classNames,d=r.components,f=r.labels.labelMonthDropdown;if(!n)return s.jsx(s.Fragment,{});if(!a)return s.jsx(s.Fragment,{});var u=[];if(ode(n,a))for(var h=yi(n),m=n.getMonth();m<=a.getMonth();m++)u.push(QN(h,m));else for(var h=yi(new Date),m=0;m<=11;m++)u.push(QN(h,m));var v=function(x){var _=Number(x.target.value),w=QN(yi(e.displayMonth),_);e.onChange(w)},g=(t=d==null?void 0:d.Dropdown)!==null&&t!==void 0?t:Xq;return s.jsx(g,{name:"months","aria-label":f(),className:c.dropdown_month,style:i.dropdown_month,onChange:v,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:o}),children:u.map(function(x){return s.jsx("option",{value:x.getMonth(),children:l(x,{locale:o})},x.getMonth())})})}function Gme(e){var t,r=e.displayMonth,n=Gn(),a=n.fromDate,i=n.toDate,o=n.locale,l=n.styles,c=n.classNames,d=n.components,f=n.formatters.formatYearCaption,u=n.labels.labelYearDropdown,h=[];if(!a)return s.jsx(s.Fragment,{});if(!i)return s.jsx(s.Fragment,{});for(var m=a.getFullYear(),v=i.getFullYear(),g=m;g<=v;g++)h.push(HM(J8(new Date),g));var x=function(w){var b=HM(yi(r),Number(w.target.value));e.onChange(b)},_=(t=d==null?void 0:d.Dropdown)!==null&&t!==void 0?t:Xq;return s.jsx(_,{name:"years","aria-label":u(),className:c.dropdown_year,style:l.dropdown_year,onChange:x,value:r.getFullYear(),caption:f(r,{locale:o}),children:h.map(function(w){return s.jsx("option",{value:w.getFullYear(),children:f(w,{locale:o})},w.getFullYear())})})}function Yme(e,t){var r=y.useState(e),n=r[0],a=r[1],i=t===void 0?n:t;return[i,a]}function Kme(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,i=e.toDate,o=e.fromDate,l=e.numberOfMonths,c=l===void 0?1:l;if(i&&Cm(i,a)<0){var d=-1*(c-1);a=Jo(i,d)}return o&&Cm(a,o)<0&&(a=o),yi(a)}function Zme(){var e=Gn(),t=Kme(e),r=Yme(t,e.month),n=r[0],a=r[1],i=function(o){var l;if(!e.disableNavigation){var c=yi(o);a(c),(l=e.onMonthChange)===null||l===void 0||l.call(e,c)}};return[n,i]}function Xme(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=yi(e),i=yi(Jo(a,n)),o=Cm(i,a),l=[],c=0;c<o;c++){var d=Jo(a,c);l.push(d)}return r&&(l=l.reverse()),l}function Jme(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,i=a===void 0?1:a,o=n?i:1,l=yi(e);if(!r)return Jo(l,o);var c=Cm(r,e);if(!(c<i))return Jo(l,o)}}function Qme(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,i=a===void 0?1:a,o=n?i:1,l=yi(e);if(!r)return Jo(l,-o);var c=Cm(l,r);if(!(c<=0))return Jo(l,-o)}}var Jq=y.createContext(void 0);function epe(e){var t=Gn(),r=Zme(),n=r[0],a=r[1],i=Xme(n,t),o=Jme(n,t),l=Qme(n,t),c=function(u){return i.some(function(h){return wT(u,h)})},d=function(u,h){c(u)||(h&&sB(u,h)?a(Jo(u,1+t.numberOfMonths*-1)):a(u))},f={currentMonth:n,displayMonths:i,goToMonth:a,goToDate:d,previousMonth:l,nextMonth:o,isDateDisplayed:c};return s.jsx(Jq.Provider,{value:f,children:e.children})}function f0(){var e=y.useContext(Jq);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function a4(e){var t,r=Gn(),n=r.classNames,a=r.styles,i=r.components,o=f0().goToMonth,l=function(f){o(Jo(f,e.displayIndex?-e.displayIndex:0))},c=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:Zq,d=s.jsx(c,{id:e.id,displayMonth:e.displayMonth});return s.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[s.jsx("div",{className:n.vhidden,children:d}),s.jsx(Hme,{onChange:l,displayMonth:e.displayMonth}),s.jsx(Gme,{onChange:l,displayMonth:e.displayMonth})]})}function tpe(e){return s.jsx("svg",br({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:s.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function rpe(e){return s.jsx("svg",br({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:s.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var vw=y.forwardRef(function(e,t){var r=Gn(),n=r.classNames,a=r.styles,i=[n.button_reset,n.button];e.className&&i.push(e.className);var o=i.join(" "),l=br(br({},a.button_reset),a.button);return e.style&&Object.assign(l,e.style),s.jsx("button",br({},e,{ref:t,type:"button",className:o,style:l}))});function npe(e){var t,r,n=Gn(),a=n.dir,i=n.locale,o=n.classNames,l=n.styles,c=n.labels,d=c.labelPrevious,f=c.labelNext,u=n.components;if(!e.nextMonth&&!e.previousMonth)return s.jsx(s.Fragment,{});var h=d(e.previousMonth,{locale:i}),m=[o.nav_button,o.nav_button_previous].join(" "),v=f(e.nextMonth,{locale:i}),g=[o.nav_button,o.nav_button_next].join(" "),x=(t=u==null?void 0:u.IconRight)!==null&&t!==void 0?t:rpe,_=(r=u==null?void 0:u.IconLeft)!==null&&r!==void 0?r:tpe;return s.jsxs("div",{className:o.nav,style:l.nav,children:[!e.hidePrevious&&s.jsx(vw,{name:"previous-month","aria-label":h,className:m,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?s.jsx(x,{className:o.nav_icon,style:l.nav_icon}):s.jsx(_,{className:o.nav_icon,style:l.nav_icon})}),!e.hideNext&&s.jsx(vw,{name:"next-month","aria-label":v,className:g,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?s.jsx(_,{className:o.nav_icon,style:l.nav_icon}):s.jsx(x,{className:o.nav_icon,style:l.nav_icon})})]})}function i4(e){var t=Gn().numberOfMonths,r=f0(),n=r.previousMonth,a=r.nextMonth,i=r.goToMonth,o=r.displayMonths,l=o.findIndex(function(v){return wT(e.displayMonth,v)}),c=l===0,d=l===o.length-1,f=t>1&&(c||!d),u=t>1&&(d||!c),h=function(){n&&i(n)},m=function(){a&&i(a)};return s.jsx(npe,{displayMonth:e.displayMonth,hideNext:f,hidePrevious:u,nextMonth:a,previousMonth:n,onPreviousClick:h,onNextClick:m})}function spe(e){var t,r=Gn(),n=r.classNames,a=r.disableNavigation,i=r.styles,o=r.captionLayout,l=r.components,c=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:Zq,d;return a?d=s.jsx(c,{id:e.id,displayMonth:e.displayMonth}):o==="dropdown"?d=s.jsx(a4,{displayMonth:e.displayMonth,id:e.id}):o==="dropdown-buttons"?d=s.jsxs(s.Fragment,{children:[s.jsx(a4,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),s.jsx(i4,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):d=s.jsxs(s.Fragment,{children:[s.jsx(c,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),s.jsx(i4,{displayMonth:e.displayMonth,id:e.id})]}),s.jsx("div",{className:n.caption,style:i.caption,children:d})}function ape(e){var t=Gn(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?s.jsx("tfoot",{className:a,style:n.tfoot,children:s.jsx("tr",{children:s.jsx("td",{colSpan:8,children:r})})}):s.jsx(s.Fragment,{})}function ipe(e,t,r){for(var n=r?pf(new Date):ho(new Date,{locale:e,weekStartsOn:t}),a=[],i=0;i<7;i++){var o=ea(n,i);a.push(o)}return a}function ope(){var e=Gn(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,i=e.weekStartsOn,o=e.ISOWeek,l=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,d=ipe(a,i,o);return s.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&s.jsx("td",{style:r.head_cell,className:t.head_cell}),d.map(function(f,u){return s.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":c(f,{locale:a}),children:l(f,{locale:a})},u)})]})}function lpe(){var e,t=Gn(),r=t.classNames,n=t.styles,a=t.components,i=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:ope;return s.jsx("thead",{style:n.head,className:r.head,children:s.jsx(i,{})})}function cpe(e){var t=Gn(),r=t.locale,n=t.formatters.formatDay;return s.jsx(s.Fragment,{children:n(e.date,{locale:r})})}var aA=y.createContext(void 0);function dpe(e){if(!d0(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return s.jsx(aA.Provider,{value:t,children:e.children})}return s.jsx(upe,{initialProps:e.initialProps,children:e.children})}function upe(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,i=t.max,o=function(d,f,u){var h,m;(h=t.onDayClick)===null||h===void 0||h.call(t,d,f,u);var v=!!(f.selected&&a&&(n==null?void 0:n.length)===a);if(!v){var g=!!(!f.selected&&i&&(n==null?void 0:n.length)===i);if(!g){var x=n?Yq([],n):[];if(f.selected){var _=x.findIndex(function(w){return Ra(d,w)});x.splice(_,1)}else x.push(d);(m=t.onSelect)===null||m===void 0||m.call(t,x,d,f,u)}}},l={disabled:[]};n&&l.disabled.push(function(d){var f=i&&n.length>i-1,u=n.some(function(h){return Ra(h,d)});return!!(f&&!u)});var c={selected:n,onDayClick:o,modifiers:l};return s.jsx(aA.Provider,{value:c,children:r})}function iA(){var e=y.useContext(aA);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function fpe(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?Ra(a,e)&&Ra(n,e)?void 0:Ra(a,e)?{from:a,to:void 0}:Ra(n,e)?void 0:P2(n,e)?{from:e,to:a}:{from:n,to:e}:a?P2(e,a)?{from:a,to:e}:{from:e,to:a}:n?sB(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var oA=y.createContext(void 0);function hpe(e){if(!u0(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return s.jsx(oA.Provider,{value:t,children:e.children})}return s.jsx(mpe,{initialProps:e.initialProps,children:e.children})}function mpe(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},i=a.from,o=a.to,l=t.min,c=t.max,d=function(m,v,g){var x,_;(x=t.onDayClick)===null||x===void 0||x.call(t,m,v,g);var w=fpe(m,n);(_=t.onSelect)===null||_===void 0||_.call(t,w,m,v,g)},f={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(f.range_start=[i],o?(f.range_end=[o],Ra(i,o)||(f.range_middle=[{after:i,before:o}])):f.range_end=[i]):o&&(f.range_start=[o],f.range_end=[o]),l&&(i&&!o&&f.disabled.push({after:iv(i,l-1),before:ea(i,l-1)}),i&&o&&f.disabled.push({after:i,before:ea(i,l-1)}),!i&&o&&f.disabled.push({after:iv(o,l-1),before:ea(o,l-1)})),c){if(i&&!o&&(f.disabled.push({before:ea(i,-c+1)}),f.disabled.push({after:ea(i,c-1)})),i&&o){var u=Nl(o,i)+1,h=c-u;f.disabled.push({before:iv(i,h)}),f.disabled.push({after:ea(o,h)})}!i&&o&&(f.disabled.push({before:ea(o,-c+1)}),f.disabled.push({after:ea(o,c-1)}))}return s.jsx(oA.Provider,{value:{selected:n,onDayClick:d,modifiers:f},children:r})}function lA(){var e=y.useContext(oA);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function y_(e){return Array.isArray(e)?Yq([],e):e!==void 0?[e]:[]}function ppe(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=y_(a)}),t}var el;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(el||(el={}));var gpe=el.Selected,rc=el.Disabled,vpe=el.Hidden,ype=el.Today,iS=el.RangeEnd,oS=el.RangeMiddle,lS=el.RangeStart,xpe=el.Outside;function _pe(e,t,r){var n,a=(n={},n[gpe]=y_(e.selected),n[rc]=y_(e.disabled),n[vpe]=y_(e.hidden),n[ype]=[e.today],n[iS]=[],n[oS]=[],n[lS]=[],n[xpe]=[],n);return e.fromDate&&a[rc].push({before:e.fromDate}),e.toDate&&a[rc].push({after:e.toDate}),d0(e)?a[rc]=a[rc].concat(t.modifiers[rc]):u0(e)&&(a[rc]=a[rc].concat(r.modifiers[rc]),a[lS]=r.modifiers[lS],a[oS]=r.modifiers[oS],a[iS]=r.modifiers[iS]),a}var Qq=y.createContext(void 0);function wpe(e){var t=Gn(),r=iA(),n=lA(),a=_pe(t,r,n),i=ppe(t.modifiers),o=br(br({},a),i);return s.jsx(Qq.Provider,{value:o,children:e.children})}function e7(){var e=y.useContext(Qq);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function bpe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function jpe(e){return!!(e&&typeof e=="object"&&"from"in e)}function Npe(e){return!!(e&&typeof e=="object"&&"after"in e)}function Spe(e){return!!(e&&typeof e=="object"&&"before"in e)}function kpe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Epe(e,t){var r,n=t.from,a=t.to;if(n&&a){var i=Nl(a,n)<0;i&&(r=[a,n],n=r[0],a=r[1]);var o=Nl(e,n)>=0&&Nl(a,e)>=0;return o}return a?Ra(a,e):n?Ra(n,e):!1}function Cpe(e){return yT(e)}function Ppe(e){return Array.isArray(e)&&e.every(yT)}function Tpe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(Cpe(r))return Ra(e,r);if(Ppe(r))return r.includes(e);if(jpe(r))return Epe(e,r);if(kpe(r))return r.dayOfWeek.includes(e.getDay());if(bpe(r)){var n=Nl(r.before,e),a=Nl(r.after,e),i=n>0,o=a<0,l=P2(r.before,r.after);return l?o&&i:i||o}return Npe(r)?Nl(e,r.after)>0:Spe(r)?Nl(r.before,e)>0:typeof r=="function"?r(e):!1})}function cA(e,t,r){var n=Object.keys(t).reduce(function(i,o){var l=t[o];return Tpe(e,l)&&i.push(o),i},[]),a={};return n.forEach(function(i){return a[i]=!0}),r&&!wT(e,r)&&(a.outside=!0),a}function Ape(e,t){for(var r=yi(e[0]),n=w1(e[e.length-1]),a,i,o=r;o<=n;){var l=cA(o,t),c=!l.disabled&&!l.hidden;if(!c){o=ea(o,1);continue}if(l.selected)return o;l.today&&!i&&(i=o),a||(a=o),o=ea(o,1)}return i||a}var Rpe=365;function t7(e,t){var r=t.moveBy,n=t.direction,a=t.context,i=t.modifiers,o=t.retry,l=o===void 0?{count:0,lastFocused:e}:o,c=a.weekStartsOn,d=a.fromDate,f=a.toDate,u=a.locale,h={day:ea,week:E2,month:Jo,year:Xle,startOfWeek:function(x){return a.ISOWeek?pf(x):ho(x,{locale:u,weekStartsOn:c})},endOfWeek:function(x){return a.ISOWeek?Q8(x):xT(x,{locale:u,weekStartsOn:c})}},m=h[r](e,n==="after"?1:-1);n==="before"&&d?m=Jle([d,m]):n==="after"&&f&&(m=Qle([f,m]));var v=!0;if(i){var g=cA(m,i);v=!g.disabled&&!g.hidden}return v?m:l.count>Rpe?l.lastFocused:t7(m,{moveBy:r,direction:n,context:a,modifiers:i,retry:br(br({},l),{count:l.count+1})})}var r7=y.createContext(void 0);function Ope(e){var t=f0(),r=e7(),n=y.useState(),a=n[0],i=n[1],o=y.useState(),l=o[0],c=o[1],d=Ape(t.displayMonths,r),f=(a!=null?a:l&&t.isDateDisplayed(l))?l:d,u=function(){c(a),i(void 0)},h=function(x){i(x)},m=Gn(),v=function(x,_){if(a){var w=t7(a,{moveBy:x,direction:_,context:m,modifiers:r});Ra(a,w)||(t.goToDate(w,a),h(w))}},g={focusedDay:a,focusTarget:f,blur:u,focus:h,focusDayAfter:function(){return v("day","after")},focusDayBefore:function(){return v("day","before")},focusWeekAfter:function(){return v("week","after")},focusWeekBefore:function(){return v("week","before")},focusMonthBefore:function(){return v("month","before")},focusMonthAfter:function(){return v("month","after")},focusYearBefore:function(){return v("year","before")},focusYearAfter:function(){return v("year","after")},focusStartOfWeek:function(){return v("startOfWeek","before")},focusEndOfWeek:function(){return v("endOfWeek","after")}};return s.jsx(r7.Provider,{value:g,children:e.children})}function dA(){var e=y.useContext(r7);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function Mpe(e,t){var r=e7(),n=cA(e,r,t);return n}var uA=y.createContext(void 0);function Dpe(e){if(!W1(e.initialProps)){var t={selected:void 0};return s.jsx(uA.Provider,{value:t,children:e.children})}return s.jsx(Ipe,{initialProps:e.initialProps,children:e.children})}function Ipe(e){var t=e.initialProps,r=e.children,n=function(i,o,l){var c,d,f;if((c=t.onDayClick)===null||c===void 0||c.call(t,i,o,l),o.selected&&!t.required){(d=t.onSelect)===null||d===void 0||d.call(t,void 0,i,o,l);return}(f=t.onSelect)===null||f===void 0||f.call(t,i,i,o,l)},a={selected:t.selected,onDayClick:n};return s.jsx(uA.Provider,{value:a,children:r})}function n7(){var e=y.useContext(uA);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function $pe(e,t){var r=Gn(),n=n7(),a=iA(),i=lA(),o=dA(),l=o.focusDayAfter,c=o.focusDayBefore,d=o.focusWeekAfter,f=o.focusWeekBefore,u=o.blur,h=o.focus,m=o.focusMonthBefore,v=o.focusMonthAfter,g=o.focusYearBefore,x=o.focusYearAfter,_=o.focusStartOfWeek,w=o.focusEndOfWeek,b=function(H){var q,K,Z,ne;W1(r)?(q=n.onDayClick)===null||q===void 0||q.call(n,e,t,H):d0(r)?(K=a.onDayClick)===null||K===void 0||K.call(a,e,t,H):u0(r)?(Z=i.onDayClick)===null||Z===void 0||Z.call(i,e,t,H):(ne=r.onDayClick)===null||ne===void 0||ne.call(r,e,t,H)},N=function(H){var q;h(e),(q=r.onDayFocus)===null||q===void 0||q.call(r,e,t,H)},S=function(H){var q;u(),(q=r.onDayBlur)===null||q===void 0||q.call(r,e,t,H)},k=function(H){var q;(q=r.onDayMouseEnter)===null||q===void 0||q.call(r,e,t,H)},C=function(H){var q;(q=r.onDayMouseLeave)===null||q===void 0||q.call(r,e,t,H)},A=function(H){var q;(q=r.onDayPointerEnter)===null||q===void 0||q.call(r,e,t,H)},R=function(H){var q;(q=r.onDayPointerLeave)===null||q===void 0||q.call(r,e,t,H)},I=function(H){var q;(q=r.onDayTouchCancel)===null||q===void 0||q.call(r,e,t,H)},O=function(H){var q;(q=r.onDayTouchEnd)===null||q===void 0||q.call(r,e,t,H)},z=function(H){var q;(q=r.onDayTouchMove)===null||q===void 0||q.call(r,e,t,H)},M=function(H){var q;(q=r.onDayTouchStart)===null||q===void 0||q.call(r,e,t,H)},B=function(H){var q;(q=r.onDayKeyUp)===null||q===void 0||q.call(r,e,t,H)},F=function(H){var q;switch(H.key){case"ArrowLeft":H.preventDefault(),H.stopPropagation(),r.dir==="rtl"?l():c();break;case"ArrowRight":H.preventDefault(),H.stopPropagation(),r.dir==="rtl"?c():l();break;case"ArrowDown":H.preventDefault(),H.stopPropagation(),d();break;case"ArrowUp":H.preventDefault(),H.stopPropagation(),f();break;case"PageUp":H.preventDefault(),H.stopPropagation(),H.shiftKey?g():m();break;case"PageDown":H.preventDefault(),H.stopPropagation(),H.shiftKey?x():v();break;case"Home":H.preventDefault(),H.stopPropagation(),_();break;case"End":H.preventDefault(),H.stopPropagation(),w();break}(q=r.onDayKeyDown)===null||q===void 0||q.call(r,e,t,H)},U={onClick:b,onFocus:N,onBlur:S,onKeyDown:F,onKeyUp:B,onMouseEnter:k,onMouseLeave:C,onPointerEnter:A,onPointerLeave:R,onTouchCancel:I,onTouchEnd:O,onTouchMove:z,onTouchStart:M};return U}function Lpe(){var e=Gn(),t=n7(),r=iA(),n=lA(),a=W1(e)?t.selected:d0(e)?r.selected:u0(e)?n.selected:void 0;return a}function Fpe(e){return Object.values(el).includes(e)}function zpe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if(Fpe(n)){var i=e.classNames["day_".concat(n)];i&&r.push(i)}}),r}function Bpe(e,t){var r=br({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=br(br({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function Upe(e,t,r){var n,a,i,o=Gn(),l=dA(),c=Mpe(e,t),d=$pe(e,c),f=Lpe(),u=!!(o.onDayClick||o.mode!=="default");y.useEffect(function(){var k;c.outside||l.focusedDay&&u&&Ra(l.focusedDay,e)&&((k=r.current)===null||k===void 0||k.focus())},[l.focusedDay,e,r,u,c.outside]);var h=zpe(o,c).join(" "),m=Bpe(o,c),v=!!(c.outside&&!o.showOutsideDays||c.hidden),g=(i=(a=o.components)===null||a===void 0?void 0:a.DayContent)!==null&&i!==void 0?i:cpe,x=s.jsx(g,{date:e,displayMonth:t,activeModifiers:c}),_={style:m,className:h,children:x,role:"gridcell"},w=l.focusTarget&&Ra(l.focusTarget,e)&&!c.outside,b=l.focusedDay&&Ra(l.focusedDay,e),N=br(br(br({},_),(n={disabled:c.disabled,role:"gridcell"},n["aria-selected"]=c.selected,n.tabIndex=b||w?0:-1,n)),d),S={isButton:u,isHidden:v,activeModifiers:c,selectedDays:f,buttonProps:N,divProps:_};return S}function qpe(e){var t=y.useRef(null),r=Upe(e.date,e.displayMonth,t);return r.isHidden?s.jsx("div",{role:"gridcell"}):r.isButton?s.jsx(vw,br({name:"day",ref:t},r.buttonProps)):s.jsx("div",br({},r.divProps))}function Vpe(e){var t=e.number,r=e.dates,n=Gn(),a=n.onWeekNumberClick,i=n.styles,o=n.classNames,l=n.locale,c=n.labels.labelWeekNumber,d=n.formatters.formatWeekNumber,f=d(Number(t),{locale:l});if(!a)return s.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:f});var u=c(Number(t),{locale:l}),h=function(m){a(t,r,m)};return s.jsx(vw,{name:"week-number","aria-label":u,className:o.weeknumber,style:i.weeknumber,onClick:h,children:f})}function Wpe(e){var t,r,n=Gn(),a=n.styles,i=n.classNames,o=n.showWeekNumber,l=n.components,c=(t=l==null?void 0:l.Day)!==null&&t!==void 0?t:qpe,d=(r=l==null?void 0:l.WeekNumber)!==null&&r!==void 0?r:Vpe,f;return o&&(f=s.jsx("td",{className:i.cell,style:a.cell,children:s.jsx(d,{number:e.weekNumber,dates:e.dates})})),s.jsxs("tr",{className:i.row,style:a.row,children:[f,e.dates.map(function(u){return s.jsx("td",{className:i.cell,style:a.cell,role:"presentation",children:s.jsx(c,{displayMonth:e.displayMonth,date:u})},nde(u))})]})}function o4(e,t,r){for(var n=r!=null&&r.ISOWeek?Q8(t):xT(t,r),a=r!=null&&r.ISOWeek?pf(e):ho(e,r),i=Nl(n,a),o=[],l=0;l<=i;l++)o.push(ea(a,l));var c=o.reduce(function(d,f){var u=r!=null&&r.ISOWeek?eB(f):rB(f,r),h=d.find(function(m){return m.weekNumber===u});return h?(h.dates.push(f),d):(d.push({weekNumber:u,dates:[f]}),d)},[]);return c}function Hpe(e,t){var r=o4(yi(e),w1(e),t);if(t!=null&&t.useFixedWeeks){var n=ade(e,t);if(n<6){var a=r[r.length-1],i=a.dates[a.dates.length-1],o=E2(i,6-n),l=o4(E2(i,1),o,t);r.push.apply(r,l)}}return r}function Gpe(e){var t,r,n,a=Gn(),i=a.locale,o=a.classNames,l=a.styles,c=a.hideHead,d=a.fixedWeeks,f=a.components,u=a.weekStartsOn,h=a.firstWeekContainsDate,m=a.ISOWeek,v=Hpe(e.displayMonth,{useFixedWeeks:!!d,ISOWeek:m,locale:i,weekStartsOn:u,firstWeekContainsDate:h}),g=(t=f==null?void 0:f.Head)!==null&&t!==void 0?t:lpe,x=(r=f==null?void 0:f.Row)!==null&&r!==void 0?r:Wpe,_=(n=f==null?void 0:f.Footer)!==null&&n!==void 0?n:ape;return s.jsxs("table",{id:e.id,className:o.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!c&&s.jsx(g,{}),s.jsx("tbody",{className:o.tbody,style:l.tbody,children:v.map(function(w){return s.jsx(x,{displayMonth:e.displayMonth,dates:w.dates,weekNumber:w.weekNumber},w.weekNumber)})}),s.jsx(_,{displayMonth:e.displayMonth})]})}function Ype(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}var Kpe=Ype()?y.useLayoutEffect:y.useEffect,cS=!1,Zpe=0;function l4(){return"react-day-picker-".concat(++Zpe)}function Xpe(e){var t,r=e!=null?e:cS?l4():null,n=y.useState(r),a=n[0],i=n[1];return Kpe(function(){a===null&&i(l4())},[]),y.useEffect(function(){cS===!1&&(cS=!0)},[]),(t=e!=null?e:a)!==null&&t!==void 0?t:void 0}function Jpe(e){var t,r,n=Gn(),a=n.dir,i=n.classNames,o=n.styles,l=n.components,c=f0().displayMonths,d=Xpe(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),f=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,u=[i.month],h=o.month,m=e.displayIndex===0,v=e.displayIndex===c.length-1,g=!m&&!v;a==="rtl"&&(t=[m,v],v=t[0],m=t[1]),m&&(u.push(i.caption_start),h=br(br({},h),o.caption_start)),v&&(u.push(i.caption_end),h=br(br({},h),o.caption_end)),g&&(u.push(i.caption_between),h=br(br({},h),o.caption_between));var x=(r=l==null?void 0:l.Caption)!==null&&r!==void 0?r:spe;return s.jsxs("div",{className:u.join(" "),style:h,children:[s.jsx(x,{id:d,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),s.jsx(Gpe,{id:f,"aria-labelledby":d,displayMonth:e.displayMonth})]},e.displayIndex)}function Qpe(e){var t=Gn(),r=t.classNames,n=t.styles;return s.jsx("div",{className:r.months,style:n.months,children:e.children})}function ege(e){var t,r,n=e.initialProps,a=Gn(),i=dA(),o=f0(),l=y.useState(!1),c=l[0],d=l[1];y.useEffect(function(){a.initialFocus&&i.focusTarget&&(c||(i.focus(i.focusTarget),d(!0)))},[a.initialFocus,c,i.focus,i.focusTarget,i]);var f=[a.classNames.root,a.className];a.numberOfMonths>1&&f.push(a.classNames.multiple_months),a.showWeekNumber&&f.push(a.classNames.with_weeknumber);var u=br(br({},a.styles.root),a.style),h=Object.keys(n).filter(function(v){return v.startsWith("data-")}).reduce(function(v,g){var x;return br(br({},v),(x={},x[g]=n[g],x))},{}),m=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:Qpe;return s.jsx("div",br({className:f.join(" "),style:u,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},h,{children:s.jsx(m,{children:o.displayMonths.map(function(v,g){return s.jsx(Jpe,{displayIndex:g,displayMonth:v},g)})})}))}function tge(e){var t=e.children,r=Sme(e,["children"]);return s.jsx(Vme,{initialProps:r,children:s.jsx(epe,{children:s.jsx(Dpe,{initialProps:r,children:s.jsx(dpe,{initialProps:r,children:s.jsx(hpe,{initialProps:r,children:s.jsx(wpe,{children:s.jsx(Ope,{children:t})})})})})})})}function rge(e){return s.jsx(tge,br({},e,{children:s.jsx(ege,{initialProps:e})}))}function h0(a){var i=a,{className:e,classNames:t,showOutsideDays:r=!0}=i,n=ge(i,["className","classNames","showOutsideDays"]);return s.jsx(rge,D({showOutsideDays:r,className:Oe("p-3",e),classNames:D({months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"",nav:"space-x-1 flex items-center",nav_button:"h-7 w-7 bg-transparent p-0",nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"rounded-md w-9",row:"flex w-full mt-2",cell:"h-9 w-9 text-center p-0 relative focus-within:relative focus-within:z-20",day:"h-9 w-9 p-0 aria-selected:opacity-100",day_range_end:"day-range-end",day_selected:"",day_today:"",day_outside:"day-outside",day_disabled:"",day_range_middle:"",day_hidden:"invisible"},t),styles:{caption_label:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},nav_button:{backgroundColor:"transparent",border:"none",boxShadow:"none",outline:"none",color:"var(--neutral-900)"},head_cell:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},day:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)",backgroundColor:"transparent",border:"none"}},modifiersStyles:{selected:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)",borderRadius:"10px"},today:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)",borderRadius:"10px"},disabled:{color:"var(--neutral-400)"},outside:{color:"var(--neutral-400)"}},components:{IconLeft:l=>{var o=ge(l,[]);return s.jsx(AP,{size:16,style:{color:"var(--neutral-900)"}})},IconRight:l=>{var o=ge(l,[]);return s.jsx(Uy,{size:16,style:{color:"var(--neutral-900)"}})}}},n))}h0.displayName="Calendar";var H1="Popover",[s7,lUe]=$s(H1,[Qd]),m0=Qd(),[nge,su]=s7(H1),a7=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:o=!1}=e,l=m0(t),c=y.useRef(null),[d,f]=y.useState(!1),[u,h]=Ya({prop:n,defaultProp:a!=null?a:!1,onChange:i,caller:H1});return s.jsx(Xb,V(D({},l),{children:s.jsx(nge,{scope:t,contentId:Os(),triggerRef:c,open:u,onOpenChange:h,onOpenToggle:y.useCallback(()=>h(m=>!m),[h]),hasCustomAnchor:d,onCustomAnchorAdd:y.useCallback(()=>f(!0),[]),onCustomAnchorRemove:y.useCallback(()=>f(!1),[]),modal:o,children:r})}))};a7.displayName=H1;var i7="PopoverAnchor",sge=y.forwardRef((e,t)=>{const c=e,{__scopePopover:r}=c,n=ge(c,["__scopePopover"]),a=su(i7,r),i=m0(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=a;return y.useEffect(()=>(o(),()=>l()),[o,l]),s.jsx(Wy,V(D(D({},i),n),{ref:t}))});sge.displayName=i7;var o7="PopoverTrigger",l7=y.forwardRef((e,t)=>{const c=e,{__scopePopover:r}=c,n=ge(c,["__scopePopover"]),a=su(o7,r),i=m0(r),o=mr(t,a.triggerRef),l=s.jsx(Pt.button,V(D({type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":h7(a.open)},n),{ref:o,onClick:mt(e.onClick,a.onOpenToggle)}));return a.hasCustomAnchor?l:s.jsx(Wy,V(D({asChild:!0},i),{children:l}))});l7.displayName=o7;var fA="PopoverPortal",[age,ige]=s7(fA,{forceMount:void 0}),c7=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,i=su(fA,t);return s.jsx(age,{scope:t,forceMount:r,children:s.jsx(Ks,{present:r||i.open,children:s.jsx(hp,{asChild:!0,container:a,children:n})})})};c7.displayName=fA;var Am="PopoverContent",d7=y.forwardRef((e,t)=>{const r=ige(Am,e.__scopePopover),o=e,{forceMount:n=r.forceMount}=o,a=ge(o,["forceMount"]),i=su(Am,e.__scopePopover);return s.jsx(Ks,{present:n||i.open,children:i.modal?s.jsx(lge,V(D({},a),{ref:t})):s.jsx(cge,V(D({},a),{ref:t}))})});d7.displayName=Am;var oge=Bd("PopoverContent.RemoveScroll"),lge=y.forwardRef((e,t)=>{const r=su(Am,e.__scopePopover),n=y.useRef(null),a=mr(t,n),i=y.useRef(!1);return y.useEffect(()=>{const o=n.current;if(o)return h1(o)},[]),s.jsx(Jy,{as:oge,allowPinchZoom:!0,children:s.jsx(u7,V(D({},e),{ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:mt(e.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:mt(e.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;i.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:mt(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})}))})}),cge=y.forwardRef((e,t)=>{const r=su(Am,e.__scopePopover),n=y.useRef(!1),a=y.useRef(!1);return s.jsx(u7,V(D({},e),{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var c,d;(c=e.onInteractOutside)==null||c.call(e,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((d=r.triggerRef.current)==null?void 0:d.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}}))}),u7=y.forwardRef((e,t)=>{const v=e,{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:f}=v,u=ge(v,["__scopePopover","trapFocus","onOpenAutoFocus","onCloseAutoFocus","disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside"]),h=su(Am,r),m=m0(r);return u1(),s.jsx(Xy,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:s.jsx(Cf,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:f,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>h.onOpenChange(!1),children:s.jsx(Jb,V(D(D({"data-state":h7(h.open),role:"dialog",id:h.contentId},m),u),{ref:t,style:V(D({},u.style),{"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"})}))})})}),f7="PopoverClose",dge=y.forwardRef((e,t)=>{const i=e,{__scopePopover:r}=i,n=ge(i,["__scopePopover"]),a=su(f7,r);return s.jsx(Pt.button,V(D({type:"button"},n),{ref:t,onClick:mt(e.onClick,()=>a.onOpenChange(!1))}))});dge.displayName=f7;var uge="PopoverArrow",fge=y.forwardRef((e,t)=>{const i=e,{__scopePopover:r}=i,n=ge(i,["__scopePopover"]),a=m0(r);return s.jsx(Qb,V(D(D({},a),n),{ref:t}))});fge.displayName=uge;function h7(e){return e?"open":"closed"}var hge=a7,mge=l7,pge=c7,m7=d7;const vc=hge,yc=mge,kl=y.forwardRef((i,a)=>{var o=i,{className:e,align:t="center",sideOffset:r=4}=o,n=ge(o,["className","align","sideOffset"]);return s.jsx(pge,{children:s.jsx(m7,D({ref:a,align:t,sideOffset:r,className:Oe("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e)},n))})});kl.displayName=m7.displayName;var G1="Checkbox",[gge,cUe]=$s(G1),[vge,hA]=gge(G1);function yge(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:a,disabled:i,form:o,name:l,onCheckedChange:c,required:d,value:f="on",internal_do_not_use_render:u}=e,[h,m]=Ya({prop:r,defaultProp:a!=null?a:!1,onChange:c,caller:G1}),[v,g]=y.useState(null),[x,_]=y.useState(null),w=y.useRef(!1),b=v?!!o||!!v.closest("form"):!0,N={checked:h,disabled:i,setChecked:m,control:v,setControl:g,name:l,form:o,value:f,hasConsumerStoppedPropagationRef:w,required:d,defaultChecked:$d(a)?!1:a,isFormControl:b,bubbleInput:x,setBubbleInput:_};return s.jsx(vge,V(D({scope:t},N),{children:xge(u)?u(N):n}))}var p7="CheckboxTrigger",g7=y.forwardRef((i,a)=>{var o=i,{__scopeCheckbox:e,onKeyDown:t,onClick:r}=o,n=ge(o,["__scopeCheckbox","onKeyDown","onClick"]);const{control:l,value:c,disabled:d,checked:f,required:u,setControl:h,setChecked:m,hasConsumerStoppedPropagationRef:v,isFormControl:g,bubbleInput:x}=hA(p7,e),_=mr(a,h),w=y.useRef(f);return y.useEffect(()=>{const b=l==null?void 0:l.form;if(b){const N=()=>m(w.current);return b.addEventListener("reset",N),()=>b.removeEventListener("reset",N)}},[l,m]),s.jsx(Pt.button,V(D({type:"button",role:"checkbox","aria-checked":$d(f)?"mixed":f,"aria-required":u,"data-state":w7(f),"data-disabled":d?"":void 0,disabled:d,value:c},n),{ref:_,onKeyDown:mt(t,b=>{b.key==="Enter"&&b.preventDefault()}),onClick:mt(r,b=>{m(N=>$d(N)?!0:!N),x&&g&&(v.current=b.isPropagationStopped(),v.current||b.stopPropagation())})}))});g7.displayName=p7;var mA=y.forwardRef((e,t)=>{const h=e,{__scopeCheckbox:r,name:n,checked:a,defaultChecked:i,required:o,disabled:l,value:c,onCheckedChange:d,form:f}=h,u=ge(h,["__scopeCheckbox","name","checked","defaultChecked","required","disabled","value","onCheckedChange","form"]);return s.jsx(yge,{__scopeCheckbox:r,checked:a,defaultChecked:i,disabled:l,required:o,onCheckedChange:d,name:n,form:f,value:c,internal_do_not_use_render:({isFormControl:m})=>s.jsxs(s.Fragment,{children:[s.jsx(g7,V(D({},u),{ref:t,__scopeCheckbox:r})),m&&s.jsx(_7,{__scopeCheckbox:r})]})})});mA.displayName=G1;var v7="CheckboxIndicator",y7=y.forwardRef((e,t)=>{const o=e,{__scopeCheckbox:r,forceMount:n}=o,a=ge(o,["__scopeCheckbox","forceMount"]),i=hA(v7,r);return s.jsx(Ks,{present:n||$d(i.checked)||i.checked===!0,children:s.jsx(Pt.span,V(D({"data-state":w7(i.checked),"data-disabled":i.disabled?"":void 0},a),{ref:t,style:D({pointerEvents:"none"},e.style)}))})});y7.displayName=v7;var x7="CheckboxBubbleInput",_7=y.forwardRef((n,r)=>{var a=n,{__scopeCheckbox:e}=a,t=ge(a,["__scopeCheckbox"]);const{control:i,hasConsumerStoppedPropagationRef:o,checked:l,defaultChecked:c,required:d,disabled:f,name:u,value:h,form:m,bubbleInput:v,setBubbleInput:g}=hA(x7,e),x=mr(r,g),_=I1(l),w=Zb(i);y.useEffect(()=>{const N=v;if(!N)return;const S=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(S,"checked").set,A=!o.current;if(_!==l&&C){const R=new Event("click",{bubbles:A});N.indeterminate=$d(l),C.call(N,$d(l)?!1:l),N.dispatchEvent(R)}},[v,_,l,o]);const b=y.useRef($d(l)?!1:l);return s.jsx(Pt.input,V(D({type:"checkbox","aria-hidden":!0,defaultChecked:c!=null?c:b.current,required:d,disabled:f,name:u,value:h,form:m},t),{tabIndex:-1,ref:x,style:V(D(D({},t.style),w),{position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"})}))});_7.displayName=x7;function xge(e){return typeof e=="function"}function $d(e){return e==="indeterminate"}function w7(e){return $d(e)?"indeterminate":e?"checked":"unchecked"}const yw=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(mA,V(D({ref:r,className:Oe("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e)},t),{children:s.jsx(y7,{className:Oe("flex items-center justify-center text-current"),children:s.jsx(fa,{className:"h-4 w-4"})})}))});yw.displayName=mA.displayName;const _ge=["Rock","Pop","Hip-Hop","Electronic","Jazz","Classical","Country","R&B","Reggae","Folk","Blues","Alternative","Indie","Punk","Metal","Funk","Soul","Gospel","Latin","World"],wge=({filters:e,onFiltersChange:t,availableGenres:r=_ge,availableCities:n=[],className:a="",onOverlayChange:i,onClearVenueSelection:o})=>{var Q,oe,ie;const[l,c]=y.useState(e.selectedCities||[]),[d,f]=y.useState(!1),[u,h]=y.useState(""),[m,v]=y.useState(!1),[g,x]=y.useState(!1),[_,w]=y.useState(""),[b,N]=y.useState([]),[S,k]=y.useState(!1),[C,A]=y.useState(!1);y.useEffect(()=>{if(e.selectedCities&&e.selectedCities.length>0){const ee=Oh(e.selectedCities);(ee.length!==e.selectedCities.length||!ee.every((G,J)=>G===e.selectedCities[J]))&&t(V(D({},e),{selectedCities:ee}))}},[e.selectedCities]),y.useEffect(()=>{g&&R()},[g]);const R=()=>E(void 0,null,function*(){k(!0);try{const{data:ee,error:G}=yield T.rpc("get_available_cities_for_filter",{min_event_count:1,limit_count:500});if(G){console.warn("Error loading cities from database function, falling back to direct query:",G);const{data:J,error:ae}=yield T.from("events").select("display_city, venue_state").not("display_city","is",null).gte("event_date",new Date().toISOString());if(ae)throw ae;const fe=new Map;(J||[]).forEach(ve=>{var Ve,le;const me=(Ve=ve.display_city)==null?void 0:Ve.trim(),Me=((le=ve.venue_state)==null?void 0:le.trim())||"",Te=`${me}|${Me}`;me&&(fe.has(Te)||fe.set(Te,{state:Me,count:0}),fe.get(Te).count++)});const we=Array.from(fe.entries()).map(([ve,me])=>{const Me=ve.split("|")[0];return{city:g_(Me),state:me.state,eventCount:me.count}}).sort((ve,me)=>me.eventCount-ve.eventCount);N(we)}else{const J=(ee||[]).map(me=>({city:me.city_name,state:me.state||"",eventCount:Number(me.event_count)})),ae=me=>{if(!me)return"";const Me=me.trim().toUpperCase();return Me==="DC"||Me==="D.C."||Me==="DISTRICT OF COLUMBIA"?"DC":me.trim()},fe=me=>{let Me=me.trim().toLowerCase();return Me=Me.replace(/\s+dc$/,""),Me=Me.replace(/\s+d\.c\.$/,""),Me=Me.replace(/\s+/g," "),Me},we=new Map;J.forEach(me=>{const Me=fe(me.city),Te=ae(me.state),Ve=`${Me}|${Te}`;if(!we.has(Ve))we.set(Ve,me);else{const le=we.get(Ve);(me.eventCount>le.eventCount||me.eventCount===le.eventCount&&me.state&&!le.state)&&we.set(Ve,me)}});const ve=Array.from(we.values()).map(me=>V(D({},me),{city:g_(me.city)})).sort((me,Me)=>Me.eventCount-me.eventCount);N(ve)}}catch(ee){console.error("Error loading cities:",ee),N([])}finally{k(!1)}}),I=ee=>{var J,ae,fe,we;const G=((J=ee==null?void 0:ee.genres)!=null?J:m)||((ae=ee==null?void 0:ee.locations)!=null?ae:g)||((fe=ee==null?void 0:ee.date)!=null?fe:d)||((we=ee==null?void 0:ee.daysOfWeek)!=null?we:C);i&&i(G)},O=ee=>{const G=e.genres.includes(ee)?e.genres.filter(J=>J!==ee):[...e.genres,ee];t(V(D({},e),{genres:G}))},z=()=>{if(_.trim()&&!e.genres.includes(_.trim())){const ee=[...e.genres,_.trim()];t(V(D({},e),{genres:ee})),w("")}},M=ee=>{ee.key==="Enter"&&z()},B=()=>{const ee=Oh(l);t(V(D({},e),{selectedCities:ee}))},F=()=>{c([]),t(V(D({},e),{selectedCities:[]}))},U=ee=>{const G={from:ee.from?(()=>{const J=new Date(ee.from);return J.setHours(0,0,0,0),J})():void 0,to:ee.to?(()=>{const J=new Date(ee.to);return J.setHours(23,59,59,999),J})():void 0};if(G.from&&!G.to){const J=new Date(G.from);J.setHours(23,59,59,999),G.to=J}else if(!G.from&&G.to){const J=new Date(G.to);J.setHours(0,0,0,0),G.from=J}t(V(D({},e),{dateRange:G})),G.from&&G.to&&f(!1)},H=()=>{t(V(D({},e),{dateRange:{from:void 0,to:void 0}}))},q=ee=>{const G={from:(()=>{const J=new Date(ee.from);return J.setHours(0,0,0,0),J})(),to:(()=>{const J=new Date(ee.to);return J.setHours(23,59,59,999),J})()};t(V(D({},e),{dateRange:G})),f(!1)},K=()=>{if(!e.dateRange.from||!e.dateRange.to)return null;const ee=xe(),G=e.dateRange.from,J=e.dateRange.to,ae=ve=>{const me=new Date(ve);return me.setHours(0,0,0,0),me.getTime()},fe=ae(G),we=ae(J);return ee.find(ve=>{const me=ae(ve.value.from),Me=ae(ve.value.to);return me===fe&&Me===we})},Z=ee=>{const G=e.daysOfWeek.includes(ee)?e.daysOfWeek.filter(J=>J!==ee):[...e.daysOfWeek,ee];t(V(D({},e),{daysOfWeek:G}))},ne=()=>{const ee=[0,1,2,3,4];if(ee.every(J=>e.daysOfWeek.includes(J)))t(V(D({},e),{daysOfWeek:e.daysOfWeek.filter(J=>!ee.includes(J))}));else{const J=[...new Set([...e.daysOfWeek,...ee])];t(V(D({},e),{daysOfWeek:J}))}},Y=()=>{const ee=[5,6];if(ee.every(J=>e.daysOfWeek.includes(J)))t(V(D({},e),{daysOfWeek:e.daysOfWeek.filter(J=>!ee.includes(J))}));else{const J=[...new Set([...e.daysOfWeek,...ee])];t(V(D({},e),{daysOfWeek:J}))}},X=()=>{t({genres:[],selectedCities:[],dateRange:{from:void 0,to:void 0},showFilters:e.showFilters,radiusMiles:e.radiusMiles,filterByFollowing:"all",daysOfWeek:[]}),c([]),o&&o()},se=e.genres.length>0||e.selectedCities&&e.selectedCities.length>0||e.dateRange.from||e.dateRange.to||e.filterByFollowing==="following"||e.daysOfWeek.length>0;y.useMemo(()=>b.slice(0,10),[b]);const de=y.useMemo(()=>{const ee=u.trim().toLowerCase(),G=b.length>0?b:(n||[]).map(J=>({city:J,state:"",eventCount:0}));return ee?G.filter(J=>{const ae=typeof J=="string"?J:J.city,fe=typeof J=="string"?"":J.state,we=ra(ae),ve=fe.toLowerCase().trim(),me=ra(ee);return we.includes(me)||ve.includes(me)||ae.toLowerCase().includes(ee)||fe.toLowerCase().includes(ee)}):G},[b,n,u]),_e=()=>{if(e.dateRange.from&&e.dateRange.to){const ee=e.dateRange.from.toDateString(),G=e.dateRange.to.toDateString();return ee===G?Rt(e.dateRange.from,"MMM d, yyyy"):`${Rt(e.dateRange.from,"MMM d")} - ${Rt(e.dateRange.to,"MMM d")}`}else{if(e.dateRange.from)return Rt(e.dateRange.from,"MMM d, yyyy");if(e.dateRange.to)return`Until ${Rt(e.dateRange.to,"MMM d, yyyy")}`}return"Calendar"},xe=()=>{const ee=new Date;ee.setHours(0,0,0,0);const G=new Date(ee);G.setHours(23,59,59,999);const J=ea(ee,7);J.setHours(23,59,59,999);const ae=ea(ee,30);ae.setHours(23,59,59,999);const fe=ea(ee,90);return fe.setHours(23,59,59,999),[{label:"Today",value:{from:new Date(ee),to:G}},{label:"This Week",value:{from:new Date(ee),to:J}},{label:"This Month",value:{from:new Date(ee),to:ae}},{label:"Next 3 Months",value:{from:new Date(ee),to:fe}}]};return s.jsxs("div",{className:Oe("space-y-4",a),children:[s.jsxs("div",{className:"flex items-center gap-2 bg-white/60 backdrop-blur-sm rounded-2xl p-4 border border-white/20 overflow-x-auto",children:[s.jsxs(vc,{open:m,onOpenChange:ee=>{v(ee),I({genres:ee})},children:[s.jsx(yc,{asChild:!0,children:s.jsxs(ce,{variant:"outline",size:"sm",className:"rounded-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0",children:[s.jsx(Ft,{className:"h-4 w-4 mr-1"}),"Genres",e.genres.length>0&&s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",marginLeft:"var(--spacing-inline, 6px)"},children:e.genres.length})]})}),s.jsx(kl,{className:"w-80 z-[60] bg-white/95 backdrop-blur-md border border-gray-200/50 rounded-2xl shadow-xl",children:s.jsxs("div",{className:"space-y-4 p-2",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(ee=>s.jsx(et,{variant:e.genres.includes(ee)?"default":"outline",className:`cursor-pointer transition-all duration-200 ${e.genres.includes(ee)?"bg-synth-pink text-white hover:bg-synth-pink-dark":"hover:bg-synth-pink/10 hover:text-synth-pink hover:border-synth-pink/30"}`,onClick:()=>O(ee),children:ee},ee))}),s.jsx("div",{className:"border-t border-gray-200/50 pt-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",placeholder:"Other: _____",value:_,onChange:ee=>w(ee.target.value),onKeyPress:M,className:"synth-input flex-1 h-9 text-sm"}),s.jsx(ce,{size:"sm",onClick:z,disabled:!_.trim()||e.genres.includes(_.trim()),className:"h-9 px-4",children:"Add"})]})})]})})]}),s.jsxs(vc,{open:g,onOpenChange:ee=>{x(ee),I({locations:ee})},children:[s.jsx(yc,{asChild:!0,children:s.jsxs(ce,{variant:"outline",size:"sm",className:"rounded-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0",children:[s.jsx(yr,{className:"h-4 w-4 mr-1"}),"Locations",(((Q=e.selectedCities)==null?void 0:Q.length)||0)>0&&s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",marginLeft:"var(--spacing-inline, 6px)"},children:e.selectedCities.length})]})}),s.jsx(kl,{className:"w-96 z-[60] bg-white/95 backdrop-blur-md border border-gray-200/50 rounded-2xl shadow-xl",children:s.jsxs("div",{className:"space-y-4 p-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Ai,{value:u,onChange:ee=>h(ee),placeholder:"Search cities...",widthVariant:"full",className:"h-9"})}),s.jsx(ce,{size:"sm",onClick:B,disabled:l.length===(((oe=e.selectedCities)==null?void 0:oe.length)||0)&&l.every(ee=>e.selectedCities.includes(ee)),children:"Apply"}),e.selectedCities&&e.selectedCities.length>0&&s.jsx(ce,{size:"sm",variant:"outline",onClick:F,children:s.jsx(Yr,{className:"h-4 w-4"})})]}),(l.length>0||e.selectedCities&&e.selectedCities.length>0)&&s.jsxs("div",{className:"border-t border-gray-200/50 pt-3 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Search Radius"}),s.jsxs("span",{className:"text-sm text-gray-600",children:[e.radiusMiles," miles"]})]}),s.jsx("input",{type:"range",min:"5",max:"100",step:"5",value:e.radiusMiles||25,onChange:ee=>{t(V(D({},e),{radiusMiles:parseInt(ee.target.value,10)}))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-synth-pink"}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[s.jsx("span",{children:"5 mi"}),s.jsx("span",{children:"25 mi"}),s.jsx("span",{children:"50 mi"}),s.jsx("span",{children:"100 mi"})]})]}),s.jsxs("div",{className:"max-h-48 overflow-auto pr-1 space-y-1 synth-scrollbar",children:[S?s.jsxs("div",{className:"flex items-center justify-center py-4",children:[s.jsx(fr,{className:"h-4 w-4 animate-spin mr-2"}),s.jsx("span",{className:"text-sm text-gray-600",children:"Loading cities..."})]}):de.map((ee,G)=>{let J=typeof ee=="string"?ee:ee.city,ae=typeof ee=="string"?"":ee.state;const fe=J.match(/^(.+?),\s*([A-Z]{2})$/);fe&&(J=fe[1].trim(),ae=fe[2].trim()||ae);const we=g_(J),ve=ae?ae.trim().toUpperCase().replace(/\./g,""):"",me=we,Me=l.some(Ve=>{const le=Ve.includes(",")?Ve.split(",")[0].trim():Ve,Ke=ra(le),De=ra(we);return Ke===De}),Te=ve?`${we}-${ve}-${G}`:`${we}-${G}`;return s.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer select-none p-2 rounded-lg hover:bg-synth-pink/5 transition-colors",children:[s.jsx(yw,{checked:Me,onCheckedChange:Ve=>{if(!!Ve)c(Ke=>{const De=[...Ke,me];return Oh(De)});else{const Ke=ra(we);c(De=>De.filter(nt=>{const ze=nt.includes(",")?nt.split(",")[0].trim():nt;return ra(ze)!==Ke}))}}}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium truncate",children:we}),ve&&s.jsx("div",{className:"text-xs text-gray-500 truncate",children:ve})]})]},Te)}),!S&&de.length===0&&s.jsx("div",{className:"text-xs text-muted-foreground text-center py-4",children:u?`No cities found for "${u}"`:"No cities available"})]})]})})]}),s.jsxs(vc,{open:C,onOpenChange:ee=>{A(ee),I({daysOfWeek:ee})},children:[s.jsx(yc,{asChild:!0,children:s.jsxs(ce,{variant:"outline",size:"sm",className:"rounded-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0",children:[s.jsx(Lt,{className:"h-4 w-4 mr-1"}),"Days",e.daysOfWeek.length>0&&s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",marginLeft:"var(--spacing-inline, 6px)"},children:e.daysOfWeek.length})]})}),s.jsx(kl,{className:"w-80 z-[60] bg-white/95 backdrop-blur-md border border-gray-200/50 rounded-2xl shadow-xl",children:s.jsxs("div",{className:"space-y-4 p-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ce,{variant:"outline",size:"sm",onClick:ne,className:Oe("flex-1 text-xs",[0,1,2,3,4].every(ee=>e.daysOfWeek.includes(ee))?"bg-synth-pink text-white hover:bg-synth-pink-dark":"bg-white/80 border-synth-pink/20 hover:border-synth-pink/40"),children:"Weekdays"}),s.jsx(ce,{variant:"outline",size:"sm",onClick:Y,className:Oe("flex-1 text-xs",[5,6].every(ee=>e.daysOfWeek.includes(ee))?"bg-synth-pink text-white hover:bg-synth-pink-dark":"bg-white/80 border-synth-pink/20 hover:border-synth-pink/40"),children:"Weekend"})]}),s.jsx("div",{className:"grid grid-cols-7 gap-2",children:[{label:"Su",value:0},{label:"M",value:1},{label:"T",value:2},{label:"W",value:3},{label:"Th",value:4},{label:"F",value:5},{label:"Sa",value:6}].map(ee=>s.jsx(ce,{variant:"outline",size:"sm",onClick:()=>Z(ee.value),className:Oe("h-10 p-0 text-xs font-medium",e.daysOfWeek.includes(ee.value)?"bg-synth-pink text-white hover:bg-synth-pink-dark border-synth-pink":"bg-white/80 border-gray-300 hover:border-synth-pink/40 hover:bg-synth-pink/10"),children:ee.label},ee.value))}),e.daysOfWeek.length>0&&s.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>t(V(D({},e),{daysOfWeek:[]})),className:"w-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40",children:[s.jsx(Yr,{className:"h-4 w-4 mr-1"}),"Clear Days"]})]})})]}),s.jsxs(vc,{open:d,onOpenChange:ee=>{f(ee),I({date:ee})},children:[s.jsx(yc,{asChild:!0,children:s.jsxs(ce,{variant:"outline",size:"sm",className:"rounded-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0 max-w-[180px]",children:[s.jsx(Lt,{className:"h-4 w-4 mr-1 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:K()?(ie=K())==null?void 0:ie.label:e.dateRange.from||e.dateRange.to?_e():"Calendar"}),(e.dateRange.from||e.dateRange.to)&&s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",marginLeft:"var(--spacing-inline, 6px)",flexShrink:0},children:K()?"Range":"Custom"})]})}),s.jsx(kl,{className:"w-auto p-4 z-[60] bg-white/95 backdrop-blur-md border border-gray-200/50 rounded-2xl shadow-xl",align:"start",children:s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:xe().map(ee=>{var J;const G=((J=K())==null?void 0:J.label)===ee.label;return s.jsxs(ce,{variant:G?"default":"outline",size:"sm",onClick:()=>q(ee.value),className:`text-xs ${G?"bg-synth-pink text-white hover:bg-synth-pink-dark":"bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40"}`,children:[s.jsx(Oa,{className:"h-3 w-3 mr-1"}),ee.label]},ee.label)})}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("span",{className:"w-full border-t"})}),s.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:s.jsx("span",{className:"bg-white px-2 text-gray-500",children:"Or select custom dates"})})]}),s.jsx(h0,{initialFocus:!0,mode:"range",defaultMonth:e.dateRange.from||new Date,selected:e.dateRange.from?{from:e.dateRange.from,to:e.dateRange.to||e.dateRange.from}:void 0,onSelect:ee=>{if(ee)if(ee.from&&ee.to&&ee.from.getTime()===ee.to.getTime()){const G=new Date(ee.from);G.setHours(0,0,0,0);const J=new Date(ee.from);J.setHours(23,59,59,999),U({from:G,to:J})}else U(ee)},numberOfMonths:2,disabled:ee=>{const G=new Date;G.setHours(0,0,0,0);const J=new Date(ee);return J.setHours(0,0,0,0),J<G}}),(e.dateRange.from||e.dateRange.to)&&s.jsxs(ce,{variant:"outline",size:"sm",onClick:H,className:"bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40",children:[s.jsx(Yr,{className:"h-4 w-4 mr-1"}),"Clear Date"]})]})})]}),s.jsxs(ce,{variant:e.filterByFollowing==="following"?"default":"outline",size:"sm",onClick:()=>t(V(D({},e),{filterByFollowing:e.filterByFollowing==="following"?"all":"following"})),className:`rounded-full backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0 ${e.filterByFollowing==="following"?"bg-synth-pink text-white":"bg-white/80"}`,children:[s.jsx(Vr,{className:"h-4 w-4 mr-1"}),"Following"]}),se&&s.jsxs(ce,{variant:"ghost",size:"sm",onClick:X,className:"text-muted-foreground hover:text-foreground bg-white/60 backdrop-blur-sm border border-white/20 hover:bg-white/80 flex-shrink-0",children:[s.jsx(Yr,{className:"h-4 w-4 mr-1"}),"Clear all"]})]}),se&&s.jsxs("div",{className:"flex flex-wrap gap-2 bg-white/40 backdrop-blur-sm rounded-2xl p-3 border border-white/20",children:[e.genres.map(ee=>s.jsxs(et,{variant:"secondary",className:"flex items-center gap-1 bg-synth-pink/20 text-synth-pink border-synth-pink/30 hover:bg-synth-pink/30 transition-colors",children:[s.jsx(Ft,{className:"h-3 w-3"}),ee,s.jsx(Yr,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>O(ee)})]},ee)),Oh(e.selectedCities||[]).map((ee,G)=>s.jsxs(et,{variant:"secondary",className:"flex items-center gap-1 bg-synth-beige/30 text-synth-black border-synth-beige-dark hover:bg-synth-beige/50 transition-colors",children:[s.jsx(yr,{className:"h-3 w-3"}),ee,s.jsx(Yr,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>t(V(D({},e),{selectedCities:(e.selectedCities||[]).filter(J=>J!==ee)}))})]},`selected-city-${ee}-${G}`)),(e.dateRange.from||e.dateRange.to)&&s.jsxs(et,{variant:"secondary",className:"flex items-center gap-1 bg-synth-pink/20 text-synth-pink border-synth-pink/30 hover:bg-synth-pink/30 transition-colors",children:[s.jsx(Lt,{className:"h-3 w-3"}),_e(),s.jsx(Yr,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:H})]}),e.daysOfWeek.length>0&&s.jsxs(et,{variant:"secondary",className:"flex items-center gap-1 bg-synth-beige/30 text-synth-black border-synth-beige-dark hover:bg-synth-beige/50 transition-colors",children:[s.jsx(Lt,{className:"h-3 w-3"}),e.daysOfWeek.length===7?"All Days":e.daysOfWeek.sort().map(ee=>["Su","M","T","W","Th","F","Sa"][ee]).join(", "),s.jsx(Yr,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>t(V(D({},e),{daysOfWeek:[]}))})]})]})]})},bge=({suggestions:e,onUserClick:t,onDismiss:r,onAddFriend:n})=>{const[a,i]=y.useState(new Set);y.useEffect(()=>{E(void 0,null,function*(){if(e.length!==0)try{const{data:{user:d}}=yield T.auth.getUser();if(!d)return;const f=e.map(x=>x.user_id),{data:u,error:h}=yield T.from("user_relationships").select("related_user_id").eq("user_id",d.id).eq("relationship_type","friend").eq("status","pending").in("related_user_id",f);h&&console.error("Error checking sent friend requests:",h);const{data:m,error:v}=yield T.from("user_relationships").select("user_id").eq("related_user_id",d.id).eq("relationship_type","friend").eq("status","pending").in("user_id",f);v&&console.error("Error checking received friend requests:",v);const g=new Set;u&&u.forEach(x=>g.add(x.related_user_id)),m&&m.forEach(x=>g.add(x.user_id)),g.size>0&&i(g)}catch(d){console.error("Error checking friend requests:",d)}})},[e]);const o=c=>E(void 0,null,function*(){var d,f;if(!a.has(c))try{n&&(yield n(c),i(u=>new Set(u).add(c)))}catch(u){console.error("Error sending friend request:",u),((d=u==null?void 0:u.message)!=null&&d.includes("already sent")||(f=u==null?void 0:u.message)!=null&&f.includes("Friend request already sent"))&&i(h=>new Set(h).add(c))}});if(e.length===0)return null;const l=c=>c.split(" ").map(d=>d[0]).join("").toUpperCase().slice(0,2);return s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 px-1",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-synth-black",children:"Who You Should Know"}),s.jsx("p",{className:"text-sm text-synth-black/60",children:"People you may know"})]}),r&&s.jsx(ce,{variant:"ghost",size:"sm",onClick:r,className:"h-8 w-8 p-0",children:s.jsx(Yr,{className:"h-4 w-4"})})]}),s.jsxs(S1,{className:"w-full",children:[s.jsx("div",{className:"flex space-x-4 pb-4 pt-1",children:e.map(c=>{var d;return s.jsxs("div",{className:"flex flex-col items-center min-w-[120px] max-w-[120px] group cursor-pointer",onClick:()=>t==null?void 0:t(c.user_id),children:[s.jsxs("div",{className:"relative mb-2 mt-1",children:[s.jsxs(Wr,{className:"h-16 w-16 ring-2 ring-synth-pink/20 group-hover:ring-synth-pink/40 transition-all",children:[s.jsx(Qr,{src:c.avatar_url||void 0,alt:c.name}),s.jsx(Hr,{className:"bg-synth-pink/10 text-synth-pink",children:l(c.name)})]}),c.verified&&s.jsx("div",{className:"absolute -bottom-1 -right-1 bg-synth-pink rounded-full p-0.5",children:s.jsx($Q,{className:"h-3 w-3 text-white"})})]}),s.jsx("p",{className:"text-sm font-medium text-synth-black text-center truncate w-full mb-1",children:c.name}),s.jsxs("div",{className:"text-xs text-synth-black/60 text-center space-y-0.5",children:[c.mutual_friends_count>0&&s.jsxs("p",{children:[c.mutual_friends_count," mutual friend",c.mutual_friends_count!==1?"s":""]}),((d=c.shared_genres_count)!=null?d:0)>0&&s.jsxs("p",{children:[c.shared_genres_count," shared genre",c.shared_genres_count!==1?"s":""]})]}),n&&s.jsx(ce,{size:"sm",variant:(a.has(c.user_id),"outline"),className:Oe("mt-2 h-7 text-xs w-full",a.has(c.user_id)&&"border-synth-pink/30 bg-synth-pink/5"),disabled:a.has(c.user_id),onClick:f=>{f.stopPropagation(),o(c.user_id)},children:a.has(c.user_id)?s.jsxs(s.Fragment,{children:[s.jsx(fa,{className:"h-3 w-3 mr-1"}),"Requested"]}):s.jsxs(s.Fragment,{children:[s.jsx(Id,{className:"h-3 w-3 mr-1"}),"Add"]})})]},c.user_id)})}),s.jsx(CT,{orientation:"horizontal"})]})]})};function b7(e,t,r,n){const i=Tx(r-e),o=Tx(n-t),l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(Tx(e))*Math.cos(Tx(r))*Math.sin(o/2)*Math.sin(o/2),d=3959*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)));return Math.round(d*100)/100}function Tx(e){return e*(Math.PI/180)}function j7(e){if(e.length===0)return[39.8283,-98.5795];if(e.length===1)return e[0];const t=e.reduce((n,[a])=>n+a,0),r=e.reduce((n,[,a])=>n+a,0);return[t/e.length,r/e.length]}function N7(e,t=.1){if(e.length===0)return{north:40,south:39,east:-97,west:-99};const r=e.map(([a])=>a),n=e.map(([,a])=>a);return{north:Math.max(...r)+t,south:Math.min(...r)-t,east:Math.max(...n)+t,west:Math.min(...n)-t}}function S7(e){const t=e.north-e.south,r=e.east-e.west,n=Math.max(t,r);return n>50?4:n>20?5:n>10?6:n>5?7:n>2?8:n>1?9:n>.5?10:n>.2?11:n>.1?12:n>.05?13:n>.02?14:n>.01?15:16}function q2(e,t,r,n){return e.filter(a=>a.latitude!=null&&a.longitude!=null&&!Number.isNaN(Number(a.latitude))&&!Number.isNaN(Number(a.longitude))).map(a=>{const i=b7(t,r,Number(a.latitude),Number(a.longitude));return V(D({},a),{distance_miles:i})}).filter(a=>a.distance_miles<=n).sort((a,i)=>a.distance_miles-i.distance_miles)}const jge=Object.freeze(Object.defineProperty({__proto__:null,calculateBounds:N7,calculateCenter:j7,calculateDistance:b7,calculateZoomLevel:S7,filterEventsByRadius:q2},Symbol.toStringTag,{value:"Module"}));class pA{static getEventsNearZip(t){return E(this,null,function*(){try{const{zipCode:r,radiusMiles:n=25,limit:a=100}=t;if(!r)throw new Error("Zip code is required");const i=yield this.getZipCoordinates(r);if(!i)return[];const o=n/69,l=n/(69*Math.cos(i.lat*Math.PI/180)),{data:c,error:d}=yield T.from("events").select("*").gte("event_date",new Date().toISOString()).gte("latitude",i.lat-o).lte("latitude",i.lat+o).gte("longitude",i.lng-l).lte("longitude",i.lng+l).not("latitude","is",null).not("longitude","is",null).limit(500);if(d)throw d;const f=(c||[]).map(h=>({id:h.id,jambase_event_id:h.jambase_event_id,title:h.title,artist_name:h.artist_name,artist_id:h.artist_id||"",venue_name:h.venue_name,venue_id:h.venue_id||"",event_date:h.event_date,doors_time:h.doors_time,description:h.description,genres:h.genres,venue_address:h.venue_address,venue_city:h.venue_city,venue_state:h.venue_state,venue_zip:h.venue_zip,latitude:h.latitude,longitude:h.longitude,ticket_available:h.ticket_available,price_range:h.price_range,ticket_urls:h.ticket_urls,setlist:h.setlist,tour_name:h.tour_name,created_at:h.created_at,updated_at:h.updated_at}));return q2(f,i.lat,i.lng,n).slice(0,a)}catch(r){return[]}})}static getEventsNearCity(t){return E(this,null,function*(){try{const{city:r,state:n,radiusMiles:a=25,limit:i=100}=t;if(!r)throw new Error("City is required");const o=yield this.getCityCoordinates(r,n);if(!o)return[];const l=a/69,c=a/(69*Math.cos(o.lat*Math.PI/180)),{data:d,error:f}=yield T.from("events").select("*").gte("event_date",new Date().toISOString()).gte("latitude",o.lat-l).lte("latitude",o.lat+l).gte("longitude",o.lng-c).lte("longitude",o.lng+c).not("latitude","is",null).not("longitude","is",null).limit(500);if(f)throw f;const u=(d||[]).map(m=>({id:m.id,jambase_event_id:m.jambase_event_id,title:m.title,artist_name:m.artist_name,artist_id:m.artist_id||"",venue_name:m.venue_name,venue_id:m.venue_id||"",event_date:m.event_date,doors_time:m.doors_time,description:m.description,genres:m.genres,venue_address:m.venue_address,venue_city:m.venue_city,venue_state:m.venue_state,venue_zip:m.venue_zip,latitude:m.latitude,longitude:m.longitude,ticket_available:m.ticket_available,price_range:m.price_range,ticket_urls:m.ticket_urls,setlist:m.setlist,tour_name:m.tour_name,created_at:m.created_at,updated_at:m.updated_at}));return q2(u,o.lat,o.lng,a).slice(0,i)}catch(r){return[]}})}static getZipsNearCity(t,r,n=25){return E(this,null,function*(){try{let a=T.from("events").select("venue_zip, venue_city, venue_state, latitude, longitude").eq("venue_city",t).gte("event_date",new Date().toISOString()).not("venue_zip","is",null);r&&(a=a.eq("venue_state",r));const{data:i,error:o}=yield a;if(o)throw o;const l=new Map;return(i||[]).forEach(c=>{c.venue_zip&&c.venue_zip!==""&&l.set(c.venue_zip,{zip_code:c.venue_zip,city:c.venue_city,state:c.venue_state,latitude:c.latitude,longitude:c.longitude,distance_miles:0})}),Array.from(l.values())}catch(a){return[]}})}static getZipCoordinates(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("events").select("latitude, longitude").eq("venue_zip",t).not("latitude","is",null).not("longitude","is",null).limit(1).single();if(n)throw n;return r?{lat:Number(r.latitude),lng:Number(r.longitude)}:null}catch(r){return null}})}static getCityCoordinates(t,r){return E(this,null,function*(){var n;try{const a=ra(t),i=r?r.toLowerCase().trim():null,o=Sge(a,i),l=new Set(o.map(g=>ra(g)));let c=T.from("city_centers").select("normalized_name, state, center_latitude, center_longitude, aliases, event_count");if(o.length>0){const g=o.map(w=>`normalized_name.ilike.%${w}%`).join(","),x=o.map(w=>`aliases.cs.{${w}}`).join(","),_=[g,x].filter(Boolean).join(",");_&&(c=c.or(_))}const{data:d,error:f}=yield c.limit(10);if(!f&&d&&d.length>0){const x=(n=d.map(_=>({match:_,score:kge(_,l,i)})).sort((_,w)=>w.score-_.score)[0])==null?void 0:n.match;if(x&&x.center_latitude&&x.center_longitude)return{lat:Number(x.center_latitude),lng:Number(x.center_longitude)}}let u=T.from("events").select("latitude, longitude, venue_city, venue_state").ilike("venue_city",`%${a}%`).not("latitude","is",null).not("longitude","is",null);r&&(u=u.ilike("venue_state",`%${r.toLowerCase().trim()}%`));const{data:h,error:m}=yield u.limit(5);if(!m&&h&&h.length>0){const g=h.filter(x=>x.latitude!=null&&x.longitude!=null&&!Number.isNaN(Number(x.latitude))&&!Number.isNaN(Number(x.longitude)));if(g.length>0){const x=g.reduce((w,b)=>w+Number(b.latitude),0)/g.length,_=g.reduce((w,b)=>w+Number(b.longitude),0)/g.length;return{lat:x,lng:_}}}const v=[...o,a];for(const g of v){const x=g.replace(/\s+/g," ").trim();if(x&&this.CITY_COORDINATES[x])return this.CITY_COORDINATES[x]}return null}catch(a){return console.error("Error getting city coordinates:",a),null}})}static searchEventsByLocation(t,r=25,n=100){return E(this,null,function*(){if(/^\d{5}(-\d{4})?$/.test(t.trim()))return this.getEventsNearZip({zipCode:t.trim(),radiusMiles:r,limit:n});{const[i,o]=t.split(",").map(l=>l.trim());return this.getEventsNearCity({city:i,state:o||void 0,radiusMiles:r,limit:n})}})}static getMapConfigForEvents(t,r){const n=t.filter(c=>c.latitude!=null&&c.longitude!=null&&!Number.isNaN(Number(c.latitude))&&!Number.isNaN(Number(c.longitude)));if(n.length===0)return{center:r||[39.8283,-98.5795],zoom:4};if(n.length===1)return{center:[Number(n[0].latitude),Number(n[0].longitude)],zoom:12};const a=n.map(c=>[Number(c.latitude),Number(c.longitude)]),i=j7(a),o=N7(a,.05),l=S7(o);return{center:i,zoom:l,bounds:o}}static getEventsNearZipWithRPC(t){return E(this,null,function*(){try{const{zipCode:r,radiusMiles:n=25,limit:a=100}=t;if(!r)throw new Error("Zip code is required");try{const{data:i,error:o}=yield T.rpc("get_events_near_zip_improved",{search_zip:r,radius_miles:n});if(!o&&i)return i.slice(0,a).map(l=>({id:l.id,jambase_event_id:l.jambase_event_id,title:l.title,artist_name:l.artist_name,artist_id:l.artist_id||"",venue_name:l.venue_name,venue_id:l.venue_id||"",event_date:l.event_date,doors_time:l.doors_time,description:l.description,genres:l.genres,venue_address:l.venue_address,venue_city:l.venue_city,venue_state:l.venue_state,venue_zip:l.venue_zip,latitude:l.latitude,longitude:l.longitude,ticket_available:l.ticket_available,price_range:l.price_range,ticket_urls:l.ticket_urls,setlist:l.setlist,tour_name:l.tour_name,created_at:l.created_at,updated_at:l.updated_at,distance_miles:l.distance_miles}))}catch(i){}return this.getEventsNearZip(t)}catch(r){return[]}})}}Pr(pA,"CITY_COORDINATES",{washington:{lat:38.9072,lng:-77.0369},"washington dc":{lat:38.9072,lng:-77.0369},"new york":{lat:40.7128,lng:-74.006},"los angeles":{lat:34.0522,lng:-118.2437},chicago:{lat:41.8781,lng:-87.6298},houston:{lat:29.7604,lng:-95.3698},phoenix:{lat:33.4484,lng:-112.074},philadelphia:{lat:39.9526,lng:-75.1652},"san antonio":{lat:29.4241,lng:-98.4936},"san diego":{lat:32.7157,lng:-117.1611},dallas:{lat:32.7767,lng:-96.797},"san jose":{lat:37.3382,lng:-121.8863},austin:{lat:30.2672,lng:-97.7431},jacksonville:{lat:30.3322,lng:-81.6557},"san francisco":{lat:37.7749,lng:-122.4194},columbus:{lat:39.9612,lng:-82.9988},"fort worth":{lat:32.7555,lng:-97.3308},indianapolis:{lat:39.7684,lng:-86.1581},charlotte:{lat:35.2271,lng:-80.8431},seattle:{lat:47.6062,lng:-122.3321},denver:{lat:39.7392,lng:-104.9903},boston:{lat:42.3601,lng:-71.0589},detroit:{lat:42.3314,lng:-83.0458},nashville:{lat:36.1627,lng:-86.7816},portland:{lat:45.5152,lng:-122.6784},"las vegas":{lat:36.1699,lng:-115.1398},memphis:{lat:35.1495,lng:-90.049},louisville:{lat:38.2527,lng:-85.7585},baltimore:{lat:39.2904,lng:-76.6122},milwaukee:{lat:43.0389,lng:-87.9065},albuquerque:{lat:35.0844,lng:-106.6504},tucson:{lat:32.2226,lng:-110.9747},fresno:{lat:36.7378,lng:-119.7871},sacramento:{lat:38.5816,lng:-121.4944},"kansas city":{lat:39.0997,lng:-94.5786},mesa:{lat:33.4152,lng:-111.8315},atlanta:{lat:33.749,lng:-84.388},omaha:{lat:41.2565,lng:-95.9345},"colorado springs":{lat:38.8339,lng:-104.8214},raleigh:{lat:35.7796,lng:-78.6382},miami:{lat:25.7617,lng:-80.1918},"long beach":{lat:33.7701,lng:-118.1937},"virginia beach":{lat:36.8529,lng:-75.978},oakland:{lat:37.8044,lng:-122.2712},minneapolis:{lat:44.9778,lng:-93.265},tulsa:{lat:36.154,lng:-95.9928},arlington:{lat:32.7357,lng:-97.1081},tampa:{lat:27.9506,lng:-82.4572}});const Nge=["district of columbia","city","county","borough","metro area","metropolitan area","municipality","township","parish"];function Sge(e,t){const r=new Set,n=e.replace(/\s+/g," ").trim();n&&r.add(n);const a=t?t.toLowerCase().trim():null;a&&(r.add(a),n.endsWith(a)&&r.add(n.slice(0,-a.length).trim())),Nge.forEach(o=>{n.endsWith(` ${o}`)&&r.add(n.slice(0,-o.length).trim())});const i=n.split(" ").filter(Boolean);return i.length>1&&(r.add(i.slice(0,i.length-1).join(" ")),r.add(i.slice(0,Math.min(i.length,2)).join(" ")),r.add(i[0])),!r.has("washington")&&n.includes("washington")&&(r.add("washington"),r.add("washington dc")),Array.from(r).map(o=>o.replace(/\s+/g," ").trim()).filter(Boolean)}function kge(e,t,r){let n=0;const a=ra(e.normalized_name||"");t.has(a)&&(n+=50),Array.isArray(e.aliases)&&e.aliases.map(l=>ra(l)).some(l=>t.has(l))&&(n+=40);const i=e.state?e.state.toLowerCase().trim():null;return r&&i&&(i===r||i===r.replace(/\s+/g,""))&&(n+=20),typeof e.event_count=="number"&&(n+=Math.min(e.event_count,500)),n}const V2=Object.freeze(Object.defineProperty({__proto__:null,RadiusSearchService:pA},Symbol.toStringTag,{value:"Module"})),c4=[39.8283,-98.5795],dS=["events","reviews","news"],Ege={events:{label:"Events",icon:Lt},reviews:{label:"Reviews",icon:Xt},news:{label:"News",icon:$P}},Cge=({currentUserId:e,onBack:t,onNavigateToNotifications:r,onViewChange:n,onNavigateToProfile:a,onNavigateToChat:i,headerTitle:o,headerSubtitle:l,visibleSections:c,enableMap:d,sectionLayout:f="tabs",onHighlightUpdate:u,embedded:h=!1,showSectionTabs:m=!0})=>{var Bf,R0,Wp,nn,O0,ti,Xc,Hp,M0,Uf,D0;const v=y.useRef(!1);!v.current&&e&&(console.log(" UnifiedFeed initialized:",{currentUserId:e,hasCurrentUserId:!!e,onNavigateToProfile:!!a,onNavigateToChat:!!i}),v.current=!0);const g=y.useMemo(()=>{if(!c||c.length===0)return dS;const he=c.filter($e=>dS.includes($e));return he.length>0?he:dS},[c]),x=g.length,_=f==="stacked",w=x===1?"grid-cols-1":x===2?"grid-cols-2":"grid-cols-3",b=h,N=b?"w-full":"min-h-screen bg-[#f9fafb]",S=b?{}:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},k=b?"w-full space-y-0":"max-w-4xl mx-auto p-6 space-y-8",C=b?"mb-0":"mb-8",A=o!=null?o:"Feed",R=l!=null?l:"Discover reviews and events from friends and the community",I=A.trim(),O=R.trim(),z=I.length>0,M=O.length>0,B=z||M,F=d!=null?d:!0,[U,H]=y.useState([]),[q,K]=y.useState(!0),[Z,ne]=y.useState(!1),[Y,X]=y.useState(!0),[se,de]=y.useState(!0),[_e,xe]=y.useState(!1),[Q,oe]=y.useState(null),[ie,ee]=y.useState(),[G,J]=y.useState(!1),[ae,fe]=y.useState(c4),[we,ve]=y.useState(!1),{toast:me}=Er(),{sessionExpired:Me}=ws(),Te=ts(),[Ve,le]=y.useState(!1),[Ke,De]=y.useState(null),[nt,ze]=y.useState(!1),[vt,rr]=y.useState(null),[sr,Ae]=y.useState(null),[Ue,gt]=y.useState(null),[Ce,Ge]=y.useState(null);y.useState("review"),y.useState(!1),y.useState(null),y.useState(!1);const[Nt,Tt]=y.useState(!1),[at,ue]=y.useState(null),[qe,Ct]=y.useState("relevance"),[ct,pt]=y.useState("desc"),At=typeof window!="undefined"&&localStorage.getItem("feedFilter")==="following"?(localStorage.removeItem("feedFilter"),"following"):"all",[yt,Fe]=y.useState(At),[ft,Et]=y.useState({genres:[],selectedCities:[],dateRange:{from:void 0,to:void 0},showFilters:!1,radiusMiles:30,filterByFollowing:At,daysOfWeek:[]}),[hr,dr]=y.useState(ft),[cn,mn]=y.useState([]),je=y.useRef(!1),pe=y.useRef(!1),Pe=y.useRef(null),[Ne,Ye]=y.useState(0);y.useState({}),y.useState({}),y.useState({}),y.useState({});const[We,It]=y.useState(new Set),[jt,Ee]=y.useState(new Set),[rt,ir]=y.useState(new Set),[rn,Mt]=y.useState(!1),[ye,Ie]=y.useState(null),[dt,wt]=y.useState([]),[ht,Le]=y.useState([]),[Xe,ke]=y.useState(!1),[St,_t]=y.useState(!1),[Fr,dn]=y.useState(null),[En,Dt]=y.useState(!1),[ur,or]=y.useState(null),[Wt,Sr]=y.useState([]),[yn,nr]=y.useState(!1),[Cr,Cn]=y.useState("all"),[Ht,cr]=y.useState(()=>{var he;return(he=g[0])!=null?he:"events"}),[In,bs]=y.useState([]),[is,zr]=y.useState(!1);y.useEffect(()=>{var he;_||g.includes(Ht)||cr((he=g[0])!=null?he:"events")},[g,Ht,_]);const[Or,An]=y.useState({open:!1,artist:null}),[Br,zn]=y.useState({open:!1,venueId:null,venueName:""}),[la,Da]=y.useState(!1);y.useEffect(()=>{E(void 0,null,function*(){if(!(!Or.open||!Or.artist)&&!(Or.events&&Or.events.length>0)){Da(!0);try{const $e=Or.artist.name,{data:lt,error:Se}=yield T.from("events").select("*").ilike("artist_name",`%${$e}%`).order("event_date",{ascending:!0}).limit(200);if(Se){console.error("Error fetching events:",Se);return}const kt=[...(lt||[]).map(Ut=>V(D({},Ut),{source:"manual"}))],$t=Tn(kt);$t.sort((Ut,pr)=>new Date(Ut.event_date).getTime()-new Date(pr.event_date).getTime()),An(Ut=>V(D({},Ut),{events:$t,totalEvents:$t.length}))}catch($e){console.error("Error fetching artist dialog events:",$e)}finally{Da(!1)}}})},[Or.open,(Bf=Or.artist)==null?void 0:Bf.name]);const Tn=he=>{const $e=new Map;return he.filter(lt=>{var Ut;const Se=(lt.artist_name||"").toLowerCase().trim(),ar=(lt.venue_name||"").toLowerCase().replace(/\s+/g," ").replace(/\bthe\s+/gi,"").replace(/[^\w\s]/g,"").trim(),kt=((Ut=lt.event_date)==null?void 0:Ut.split("T")[0])||"",$t=`${Se}|${ar}|${kt}`;return $e.has($t)?($e.get($t),!1):($e.set($t,lt),!0)})},tr=()=>E(void 0,null,function*(){nr(!0);try{const he=yield Mh.getPersonalizedNews(e);Sr(he);const $e=he.filter(lt=>(lt.relevance_score||0)>0).length;me({title:"News updated",description:$e>0?`Loaded ${he.length} articles (${$e} personalized for you)`:`Loaded ${he.length} articles`})}catch(he){console.error("Error fetching news:",he),me({title:"Error",description:"Failed to load news articles",variant:"destructive"})}finally{nr(!1)}}),Mr=he=>{cr(he),he==="news"&&g.includes("news")&&(Mh.clearCache(),tr()),he==="reviews"&&g.includes("reviews")&&un()},un=()=>E(void 0,null,function*(){if(!(is||In.length>0)){zr(!0);try{const he=yield Mu.getRecommendedFriends(e,10);bs(he)}catch(he){console.error("Error loading recommended friends:",he)}finally{zr(!1)}}}),Rn=he=>E(void 0,null,function*(){try{const{error:$e}=yield T.rpc("create_friend_request",{receiver_user_id:he});if($e)throw $e;me({title:"Friend Request Sent! ",description:"Your friend request has been sent."})}catch($e){throw console.error("Error sending friend request:",$e),me({title:"Error",description:$e.message||"Failed to send friend request. Please try again.",variant:"destructive"}),$e}});y.useEffect(()=>{if(Me){K(!1),de(!1);return}if(!e){de(!1);return}E(void 0,null,function*(){try{const{data:$e}=yield T.from("users").select("location_city").eq("user_id",e).maybeSingle();if($e!=null&&$e.location_city&&!pe.current){const lt=$e.location_city.trim();console.log(" User location_city from profile:",lt);let Se=lt;try{const $t=yield zM.getAvailableCities(1,1e3);if($t&&$t.length>0){const Ut=lt.toLowerCase().trim();let pr=$t.find(Gr=>{var _r;return((_r=Gr.city_name)==null?void 0:_r.toLowerCase().trim())===Ut});pr||(pr=$t.find(Gr=>{var _r,fn;return((_r=Gr.city_name)==null?void 0:_r.toLowerCase().includes(Ut))||Ut.includes(((fn=Gr.city_name)==null?void 0:fn.toLowerCase())||"")})),!pr&&(Ut.includes("washington")||Ut.includes("dc")||Ut.includes("district"))&&(pr=$t.find(Gr=>{var fn;const _r=((fn=Gr.city_name)==null?void 0:fn.toLowerCase())||"";return _r.includes("washington")&&(_r.includes("dc")||Gr.state==="DC")||Gr.state==="DC"&&_r.includes("washington")})),!pr&&(Ut==="dc"||Ut==="district of columbia")&&(pr=$t.find(Gr=>{var _r;return Gr.state==="DC"&&((_r=Gr.city_name)==null?void 0:_r.toLowerCase().includes("washington"))})),pr?(Se=typeof pr=="object"&&pr!==null&&"city_name"in pr?pr.city_name:typeof pr=="string"?pr:lt,console.log(" Matched user city to database city:",lt,"",Se)):(console.warn(" Could not match user city to available cities. Using raw city name:",lt),Se=lt)}}catch($t){console.warn(" Could not load available cities. Using raw city name:",$t),Se=lt}console.log(" Auto-applying city filter from profile:",Se);const ar=Oh([Se]),kt={genres:[],selectedCities:ar,dateRange:{from:void 0,to:void 0},daysOfWeek:[],filterByFollowing:"all",showFilters:!1,radiusMiles:50};if(dr(kt),Et(kt),Se)try{const $t=yield pA.getCityCoordinates(Se);$t&&(console.log("Got city coordinates:",$t),ee($t),fe([$t.lat,$t.lng]))}catch($t){console.warn("Could not get city coordinates:",$t)}je.current=!0,console.log(" Initial load with auto-applied city filter:",Se),Ye(0),de(!1),_a(0,!1,!1,kt),Promise.all([jr(),Es(),Yl()]).catch($t=>console.warn("Error loading parallel data:",$t));return}}catch($e){console.warn(" Error loading user city from profile:",$e)}de(!1),Promise.all([Promise.resolve(_a(0,!1)),jr(),Es(),Yl(),un(),Ia()]).catch($e=>console.warn("Error loading parallel data:",$e))})},[Me,e]),y.useEffect(()=>{E(void 0,null,function*(){if(ie&&!je.current&&!(ft.selectedCities&&ft.selectedCities.length>0))try{const $e=yield zM.getAvailableCities(1,200);if(!Array.isArray($e)||$e.length===0)return;const lt=Ut=>Ut*(Math.PI/180),Se=(Ut,pr,Gr,_r)=>{const Cs=lt(Gr-Ut),lr=lt(_r-pr),sn=Qp(Math.sin(Cs/2),2)+Math.cos(lt(Ut))*Math.cos(lt(Gr))*Qp(Math.sin(lr/2),2);return 2*3959*Math.atan2(Math.sqrt(sn),Math.sqrt(1-sn))};let ar=$e[0],kt=1/0;for(const Ut of $e){const pr=Se(ie.lat,ie.lng,Number(Ut.center_latitude),Number(Ut.center_longitude));pr<kt&&(kt=pr,ar=Ut)}const $t=ar.city_name;if($t){je.current=!0;const{deduplicateCities:Ut}=yield Rr(()=>E(void 0,null,function*(){const{deduplicateCities:_r}=yield Promise.resolve().then(()=>t4);return{deduplicateCities:_r}}),void 0,import.meta.url),pr=Ut([$t]),Gr=V(D({},ft),{selectedCities:pr});Et(Gr),dr(Gr),Ye(0),_a(0,!1)}}catch($e){}})},[ie,ft.selectedCities]),y.useEffect(()=>()=>{Pe.current&&clearTimeout(Pe.current)},[]),y.useEffect(()=>{const he=lt=>{const Se=lt.detail||{},ar=Se.venueId||Se.venueName;ar&&Te(`/venue/${encodeURIComponent(ar)}`)},$e=lt=>E(void 0,null,function*(){const Se=lt.detail||{};if(Se.artistName){const ar=Se.artistId&&Se.artistId!=="manual"?Se.artistId:encodeURIComponent(Se.artistName);Te(`/artist/${ar}`)}});return document.addEventListener("open-venue-card",he),document.addEventListener("open-artist-card",$e),()=>{document.removeEventListener("open-venue-card",he),document.removeEventListener("open-artist-card",$e)}},[Te]);const Es=()=>E(void 0,null,function*(){if(e){ke(!0);try{const he=yield ki.getUserFollowedArtists(e);wt(he.map(lt=>lt.artist_name));const $e=yield Ou.getUserFollowedVenues(e);Le($e.map(lt=>({name:lt.venue_name,city:lt.venue_city,state:lt.venue_state})))}catch(he){console.error("Error loading followed data:",he)}finally{ke(!1)}}});y.useEffect(()=>{const he=localStorage.getItem("reopenEventId");if(console.log(" UnifiedFeed: Checking for reopenEventId in localStorage:",he),console.log(" UnifiedFeed: feedItems.length:",U.length),he&&U.length>0){console.log(" UnifiedFeed: Looking for event with id:",he);const $e=U.find(lt=>{var Se;return lt.type==="event"&&((Se=lt.event_data)==null?void 0:Se.id)===he});console.log(" UnifiedFeed: Found eventItem:",$e),$e&&$e.event_data&&(console.log(" UnifiedFeed: Re-opening modal for event:",$e.event_data),De($e.event_data),le(!0),localStorage.removeItem("reopenEventId"))}},[U]),y.useEffect(()=>{(()=>{const $e=localStorage.getItem("selectedEvent");if($e)try{const lt=JSON.parse($e);console.log(" UnifiedFeed: Opening event from localStorage:",lt),De(lt),le(!0),localStorage.removeItem("selectedEvent")}catch(lt){console.error("Error parsing selectedEvent from localStorage:",lt),localStorage.removeItem("selectedEvent")}})()},[]),y.useEffect(()=>{if(!e||U.length===0)return;const he=U.filter(Se=>{var ar;return Se.type==="event"&&((ar=Se.event_data)==null?void 0:ar.id)});he.length===0||he.map(Se=>Se.event_data.id).filter(Boolean).filter(Se=>!rt.has(Se)).length===0||Ia()},[U,e,rt]);const Qa=he=>{const $e=ei.find(lt=>{var Se;return lt.type==="event"&&((Se=lt.event_data)==null?void 0:Se.id)===he.id});$e!=null&&$e.event_data?De($e.event_data):De(he),le(!0),ve(!1)},xa=he=>E(void 0,null,function*(){if(!e)return;const $e=We.has(he.id),lt=new Set(We);$e?lt.delete(he.id):lt.add(he.id),It(lt);try{const Se=he.type==="review"&&he.review_id||he.id;yield Zt.like(he.type,he.review_id||he.id,!!e,{},Se)}catch(Se){console.error("Error tracking like:",Se)}}),js=he=>E(void 0,null,function*(){const $e=jt.has(he.id),lt=new Set(jt);$e?lt.delete(he.id):lt.add(he.id),Ee(lt)}),os=he=>{const $e=gs(he),Se=Math.floor((new Date().getTime()-$e.getTime())/1e3);return Se<60?`${Se}s`:Se<3600?`${Math.floor(Se/60)}m`:Se<86400?`${Math.floor(Se/3600)}h`:`${Math.floor(Se/86400)}d`};y.useEffect(()=>{const he=()=>{window.innerHeight+document.documentElement.scrollTop>=document.documentElement.offsetHeight-1e3&&!Z&&Y&&_a(U.length)};return window.addEventListener("scroll",he),()=>window.removeEventListener("scroll",he)},[Z,Y,U.length]);const _a=(he=0,$e=!1,lt=!1,Se)=>E(void 0,null,function*(){try{const ar=Se!=null?Se:ft,kt=lt?Se!=null?Se:hr:ar,$t=kt.genres&&kt.genres.length>0||kt.selectedCities&&kt.selectedCities.length>0||kt.dateRange.from||kt.dateRange.to||kt.daysOfWeek&&kt.daysOfWeek.length>0||kt.filterByFollowing==="following",Ut=$e?0:he;console.log(" loadFeedData called with offset:",Ut,"isRefresh:",$e,"isFilterUpdate:",lt,"hasActiveFilters:",$t),lt?(K(!1),ne(!0),X(!0)):he===0&&!$e?(K(!0),H([]),X(!0)):$e?K(!0):ne(!0);const{deduplicateCities:pr}=yield Rr(()=>E(void 0,null,function*(){const{deduplicateCities:Qt}=yield Promise.resolve().then(()=>t4);return{deduplicateCities:Qt}}),void 0,import.meta.url),Gr=kt.selectedCities&&kt.selectedCities.length>0?pr(kt.selectedCities):void 0,_r={genres:kt.genres&&kt.genres.length>0?kt.genres:void 0,selectedCities:Gr,dateRange:kt.dateRange.from||kt.dateRange.to?kt.dateRange:void 0,daysOfWeek:kt.daysOfWeek&&kt.daysOfWeek.length>0?kt.daysOfWeek:void 0,filterByFollowing:kt.filterByFollowing!=="all"?kt.filterByFollowing:void 0,radiusMiles:kt.radiusMiles!==void 0?kt.radiusMiles:void 0},fn=_r.genres||_r.selectedCities||_r.dateRange||_r.daysOfWeek||_r.filterByFollowing?_r:void 0,lr=(yield aS.getFeedItems({userId:e,limit:20,offset:Ut,includePrivateReviews:!0,filters:fn})).filter(Qt=>!(Qt.type==="review"&&(Qt.deleted_at||Qt.is_deleted||!Qt.content&&(!Qt.photos||Qt.photos.length===0)||Qt.content==="ATTENDANCE_ONLY"||Qt.content==="[deleted]"||Qt.content==="DELETED")));if(lt)H(lr),Ye(0);else if(he===0&&!$e)H(lr);else if($e)if(lr.length>0)H(lr),Ye(0);else{console.log(" Refresh: No items at current offset, resetting to 0..."),Ye(0);const ca=(yield aS.getFeedItems({userId:e,limit:20,offset:0,includePrivateReviews:!0})).filter(wr=>!(wr.type==="review"&&(wr.deleted_at||wr.is_deleted||!wr.content&&(!wr.photos||wr.photos.length===0)||wr.content==="ATTENDANCE_ONLY"||wr.content==="[deleted]"||wr.content==="DELETED")));ca.length>0?(H(ca),Ye(0)):console.warn(" Refresh: No items found even at offset 0, keeping existing feed")}else H(Qt=>[...Qt,...lr]);const sn=lr.filter(Qt=>Qt.type==="event"),Dr=lr.length>=20||sn.length>=20;console.log(` Loaded ${lr.length} items (${sn.length} events), hasMore: ${Dr}`),X(Dr)}catch(ar){if(console.error("Error loading feed data:",ar),$e&&U.length===0){console.log(" Refresh failed with no items, retrying from offset 0...");try{const $t=(yield aS.getFeedItems({userId:e,limit:20,offset:0,includePrivateReviews:!0})).filter(Ut=>!(Ut.type==="review"&&(Ut.deleted_at||Ut.is_deleted||!Ut.content&&(!Ut.photos||Ut.photos.length===0)||Ut.content==="ATTENDANCE_ONLY"||Ut.content==="[deleted]"||Ut.content==="DELETED")));if($t.length>0){H($t),Ye(20);return}}catch(kt){console.error("Retry also failed:",kt)}}me({title:"Error",description:"Failed to load feed data. Please try again.",variant:"destructive"})}finally{console.log(" Setting loading to false"),K(!1),ne(!1)}}),jr=()=>E(void 0,null,function*(){try{console.log("Loading upcoming events...")}catch(he){console.error("Error loading upcoming events:",he)}}),Ia=()=>E(void 0,null,function*(){if(e)try{const he=yield Kr.getUserInterestedEventIdSet(e);ir(he),console.log(" Loaded all interested events:",he.size,"events")}catch(he){console.error("Error loading all interested events:",he)}}),pn=he=>E(void 0,null,function*(){var $e,lt,Se,ar,kt;try{if(he.type==="event"&&he.event_data)try{yield Zt.click("share",he.event_data.id,{source:"feed_event_card",artist_name:he.event_data.artist_name,venue_name:he.event_data.venue_name},he.event_data.id)}catch($t){console.error("Error tracking share:",$t)}if(he.type==="event"&&he.event_data)dn(he.event_data),_t(!0);else if(he.type==="review"){const $t={id:he.review_id||he.id,user_id:(($e=he.author)==null?void 0:$e.id)||e,event_id:he.event_id||"",rating:typeof he.rating=="number"?he.rating:he.artist_performance_rating||0,review_text:he.content||"",is_public:!0,created_at:he.created_at,updated_at:he.updated_at||he.created_at,likes_count:he.likes_count||0,comments_count:he.comments_count||0,shares_count:he.shares_count||0,is_liked_by_user:We.has(he.id),reaction_emoji:"",photos:he.photos||[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:(lt=he.event_info)==null?void 0:lt.artist_name,artist_id:(Se=he.event_info)==null?void 0:Se.artist_id,venue_name:(ar=he.event_info)==null?void 0:ar.venue_name,venue_id:(kt=he.event_info)==null?void 0:kt.venue_id};or($t),Dt(!0)}else{const $t=`Check out this ${he.type}: ${he.title}`;yield navigator.clipboard.writeText($t),me({title:"Shared!",description:"Link copied to clipboard"})}}catch($t){console.error("Error sharing item:",$t)}}),du=he=>E(void 0,null,function*(){if(!e||!he.event_data)return;const lt=!rt.has(he.event_data.id);lt?rt.add(he.event_data.id):rt.delete(he.event_data.id),ir(new Set(rt));try{yield Kr.setEventInterest(e,he.event_data.id,lt),me({title:lt?"You're interested!":"Interest removed",description:lt?"We'll notify you about this event":"You'll no longer receive notifications for this event"})}catch(Se){console.error("Error toggling interest:",Se),lt?rt.delete(he.event_data.id):rt.add(he.event_data.id),ir(new Set(rt)),me({title:"Error",description:"Failed to update interest",variant:"destructive"})}}),Kc=he=>[...he].sort(($e,lt)=>{var ar,kt,$t,Ut;let Se=0;switch(qe){case"date":{const _r=$e.type==="event"&&((ar=$e.event_data)!=null&&ar.event_date)?new Date($e.event_data.event_date).getTime():new Date($e.created_at).getTime(),fn=lt.type==="event"&&((kt=lt.event_data)!=null&&kt.event_date)?new Date(lt.event_data.event_date).getTime():new Date(lt.created_at).getTime();Se=_r-fn;break}case"price":{const _r=zf($e),fn=zf(lt);Se=_r-fn;break}case"popularity":{const _r=($e.likes_count||0)+($e.comments_count||0)+($e.shares_count||0),fn=(lt.likes_count||0)+(lt.comments_count||0)+(lt.shares_count||0);Se=_r-fn;break}case"distance":{const _r=$e.distance_miles||1/0,fn=lt.distance_miles||1/0;Se=_r-fn;break}case"relevance":default:const pr=($t=$e.relevance_score)!=null?$t:0,Gr=(Ut=lt.relevance_score)!=null?Ut:0;Se=pr-Gr;break}return ct==="asc"?Se:-Se}),Yl=()=>E(void 0,null,function*(){try{const{data:he,error:$e}=yield T.from("events").select("venue_city").not("venue_city","is",null);if($e)throw $e;const lt=Array.from(new Set((he||[]).map(Se=>Se.venue_city.trim()).filter(Boolean))).sort();mn(lt)}catch(he){console.error("Failed to load cities:",he),mn([])}}),Zc=y.useMemo(()=>{const he=new Set;return U.forEach($e=>{var lt;$e.type==="event"&&((lt=$e.event_data)!=null&&lt.genres)&&$e.event_data.genres.forEach(Se=>he.add(Se))}),Array.from(he).sort()},[U]),il=y.useMemo(()=>{let he=[...U];if(ft.filterByFollowing==="following"){const $e=he.filter(ar=>ar.type==="event"),lt=he.filter(ar=>ar.type!=="event");return[...$e.filter(ar=>{if(!ar.event_data)return!1;const kt=ar.event_data;return kt.artist_name&&dt.includes(kt.artist_name)?!0:kt.venue_name?ht.some($t=>$t.name===kt.venue_name&&(!$t.city||$t.city===kt.venue_city)&&(!$t.state||$t.state===kt.venue_state)):!1}),...lt]}return he},[U,ft.filterByFollowing,dt,ht]);y.useEffect(()=>{dr(ft)},[ft]);const zf=he=>{var $e;return he.type==="event"&&(($e=he.event_data)!=null&&$e.price_range)?Xue(he.event_data.price_range):0},ei=y.useMemo(()=>Kc(il),[il,qe,ct]),rs=y.useMemo(()=>ei.filter(he=>he.type==="event"&&!!he.event_data).map(he=>{var ar,kt,$t,Ut,pr,Gr,_r,fn,Cs,lr,sn,Yn,Dr,Qt,ca,wr,Pn,uu,ol,I0,Jc,$a,Gp,Yp,$0;const $e=he.event_data,lt=$e.latitude!=null?Number($e.latitude):void 0,Se=$e.longitude!=null?Number($e.longitude):void 0;return{id:$e.id,jambase_event_id:(ar=$e.jambase_event_id)!=null?ar:$e.id,title:($t=(kt=$e.title)!=null?kt:$e.artist_name)!=null?$t:"Untitled Event",artist_name:(Ut=$e.artist_name)!=null?Ut:"",artist_id:(pr=$e.artist_id)!=null?pr:"",venue_name:(Gr=$e.venue_name)!=null?Gr:"",venue_id:(_r=$e.venue_id)!=null?_r:"",event_date:$e.event_date,doors_time:$e.doors_time,description:$e.description,genres:(fn=$e.genres)!=null?fn:[],venue_address:$e.venue_address,venue_city:$e.venue_city,venue_state:$e.venue_state,venue_zip:$e.venue_zip,latitude:lt,longitude:Se,ticket_available:$e.ticket_available,price_range:$e.price_range,ticket_urls:(Cs=$e.ticket_urls)!=null?Cs:$e.ticket_url?[$e.ticket_url]:[],poster_image_url:(lr=$e.poster_image_url)!=null?lr:null,setlist:(sn=$e.setlist)!=null?sn:null,setlist_enriched:(Yn=$e.setlist_enriched)!=null?Yn:!1,setlist_song_count:(Dr=$e.setlist_song_count)!=null?Dr:null,setlist_fm_id:(Qt=$e.setlist_fm_id)!=null?Qt:null,setlist_fm_url:(ca=$e.setlist_fm_url)!=null?ca:null,setlist_source:(wr=$e.setlist_source)!=null?wr:null,setlist_last_updated:(Pn=$e.setlist_last_updated)!=null?Pn:null,tour_name:(uu=$e.tour_name)!=null?uu:null,created_at:(ol=$e.created_at)!=null?ol:null,updated_at:(I0=$e.updated_at)!=null?I0:null,is_promoted:(Jc=$e.is_promoted)!=null?Jc:!1,promotion_tier:($a=$e.promotion_tier)!=null?$a:null,active_promotion_id:(Gp=$e.active_promotion_id)!=null?Gp:null,ticket_price_min:(Yp=$e.ticket_price_min)!=null?Yp:null,ticket_price_max:($0=$e.ticket_price_max)!=null?$0:null}}).filter(he=>typeof he.latitude=="number"&&typeof he.longitude=="number"),[ei]),Kl=rs.length>1?6:9,Vp=y.useMemo(()=>{var Se,ar,kt,$t;const he=ei.find(Ut=>Ut.type==="event"&&!!Ut.event_data);if(!he||!he.event_data)return null;const $e=he.event_data,lt=$e.poster_image_url||(Array.isArray($e.images)?(Se=$e.images.find(Ut=>Ut==null?void 0:Ut.url))==null?void 0:Se.url:void 0)||null;return{eventId:$e.id||he.id,title:$e.title||he.title||$e.artist_name||"Upcoming Event",artistName:$e.artist_name||((ar=he.event_info)==null?void 0:ar.artist_name),venueName:$e.venue_name||((kt=he.event_info)==null?void 0:kt.venue_name),eventDate:$e.event_date||(($t=he.event_info)==null?void 0:$t.event_date),imageUrl:lt,distanceMiles:he.distance_miles,eventData:$e}},[ei]);y.useEffect(()=>{u&&u(Vp)},[Vp,u]),y.useEffect(()=>{if(we)return;const he=rs.find($e=>typeof $e.latitude=="number"&&typeof $e.longitude=="number");he&&typeof he.latitude=="number"&&typeof he.longitude=="number"?fe([he.latitude,he.longitude]):fe(c4)},[rs,we]);const T0=y.useMemo(()=>ei.filter(he=>he.type==="event").map((he,$e)=>{var lt,Se,ar,kt,$t;return{id:((lt=he.event_data)==null?void 0:lt.id)||he.id,metadata:{source:"feed",position:$e,feed_tab:Ht,feed_type:yt,artist_name:((Se=he.event_data)==null?void 0:Se.artist_name)||((ar=he.event_info)==null?void 0:ar.artist_name),venue_name:((kt=he.event_data)==null?void 0:kt.venue_name)||(($t=he.event_info)==null?void 0:$t.venue_name),distance_miles:he.distance_miles,relevance_score:he.relevance_score}}}),[ei,Ht,yt]),Uj=XU("event",T0,{threshold:.5,trackOnce:!0,debounce:500}),A0=({item:he})=>{var Se,ar;const[$e,lt]=y.useState(null);return y.useEffect(()=>{E(void 0,null,function*(){var kt,$t,Ut;try{if(Array.isArray(he.photos)&&he.photos.length>0){console.log("ReviewHeroImage: Using item photos:",he.photos[0]),lt(he.photos[0]);return}const pr=((kt=he.event_info)==null?void 0:kt.artist_name)||"";if(!pr){console.log("ReviewHeroImage: No artist name, setting null"),lt(null);return}const{data:Gr}=yield T.from("events").select("id").ilike("artist_name",`%${pr}%`).limit(20);if(Gr&&Gr.length>0){const _r=Gr.map(lr=>lr.id),fn=yield T.from("reviews").select("photos").not("photos","is",null).in("event_id",_r).order("likes_count",{ascending:!1}).limit(1),Cs=Array.isArray(fn.data)&&((Ut=($t=fn.data[0])==null?void 0:$t.photos)==null?void 0:Ut[0]);if(Cs){console.log("ReviewHeroImage: Using artist review photo:",Cs),lt(Cs);return}}lt(null)}catch(pr){console.error("ReviewHeroImage: Error resolving image:",pr),lt(null)}})},[he.id,he.photos,(Se=he.event_info)==null?void 0:Se.artist_name]),$e?s.jsx("div",{className:"h-44 w-full overflow-hidden rounded-t-lg",children:s.jsx("img",{src:$e,alt:((ar=he.event_info)==null?void 0:ar.event_name)||he.title,className:"w-full h-full object-cover",loading:"lazy"})}):null};return q||se?(console.log(" Showing skeleton loading state",{loading:q,isInitializing:se}),s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6 w-full",children:[s.jsx(ZN,{}),s.jsx(ZN,{}),s.jsx(ZN,{})]})})):s.jsxs("div",{className:N,style:S,children:[s.jsxs("div",{className:k,children:[B&&s.jsx("div",{className:C,children:s.jsxs("div",{children:[z&&s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:I}),M&&s.jsx("p",{className:"text-gray-600 mt-2",children:O})]})}),s.jsxs(zi,{value:Ht,onValueChange:he=>Mr(he),children:[m!==!1&&s.jsx(wi,{className:`grid w-full ${b?"mb-1 mt-0":"mb-6"} bg-white/60 backdrop-blur-sm border border-white/20 rounded-2xl p-1 ${w}`,children:g.map(he=>{const{label:$e,icon:lt}=Ege[he];return s.jsxs(en,{value:he,className:"flex items-center gap-2 data-[state=active]:bg-synth-pink data-[state=active]:text-white rounded-xl",children:[s.jsx(lt,{className:"w-4 h-4"}),$e]},he)})}),Ht==="events"&&g.includes("events")&&s.jsxs("div",{className:`${b?"mb-1 pt-0":"mb-6"} flex flex-col gap-2 md:flex-row md:items-center md:justify-between`,children:[s.jsx("div",{className:`${b?"flex-1":"md:flex-1"}`,children:s.jsx(wge,{filters:hr,onFiltersChange:he=>{console.log(" Filter change detected:",he),pe.current=!0,je.current=!0,dr(he),Pe.current&&clearTimeout(Pe.current),Pe.current=setTimeout(()=>{console.log(" Applying debounced filters, regenerating personalized feed..."),Et(he),Ye(0),e&&_a(0,!1,!0,he)},400)},availableGenres:Zc,availableCities:cn,onOverlayChange:he=>dr($e=>V(D({},$e),{showFilters:he})),className:b?"space-y-0":""})}),b&&r&&i&&s.jsx("div",{className:"flex items-center gap-2 flex-shrink-0 -mt-1",children:s.jsx(Cde,{currentUserId:e,onNavigateToNotifications:r,onNavigateToChat:i,className:"flex-shrink-0"})}),!b&&F&&s.jsxs(ce,{variant:"outline",size:"sm",className:"md:self-start",onClick:()=>ve(!0),disabled:rs.length===0,children:[s.jsx(tee,{className:"h-4 w-4 mr-2"}),"Map View"]})]}),g.includes("events")&&s.jsxs(tn,{value:"events",className:"mt-0 space-y-4",children:[s.jsx("div",{className:"space-y-4",children:ei.filter(he=>he.type==="event").map((he,$e)=>{var lt,Se,ar,kt,$t,Ut,pr,Gr,_r,fn,Cs;return s.jsx(Ze,{className:Oe("cursor-pointer overflow-hidden group",((lt=he.event_data)==null?void 0:lt.is_promoted)&&"ring-2 ring-yellow-400/50 shadow-lg shadow-yellow-200/30 border-yellow-200/50"),ref:lr=>{var sn;return lr&&Uj(lr,((sn=he.event_data)==null?void 0:sn.id)||he.id)},"data-tour":$e===0?"event-card":void 0,onClick:lr=>E(void 0,null,function*(){if(!lr.defaultPrevented&&he.event_data){const{PromotionTrackingService:sn}=yield Rr(()=>E(void 0,null,function*(){const{PromotionTrackingService:Yn}=yield Promise.resolve().then(()=>gfe);return{PromotionTrackingService:Yn}}),void 0,import.meta.url);sn.trackPromotionInteraction(he.event_data.id,e,"click",{source:"feed_event_card_click",artist_name:he.event_data.artist_name,venue_name:he.event_data.venue_name}),De(he.event_data);try{const Yn=yield Kr.isUserInterested(e,he.event_data.id);ze(Yn)}catch(Yn){ze(!1)}le(!0)}}),children:s.jsxs(tt,{className:"p-6",children:[he.type!=="event"&&s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Wr,{className:"w-10 h-10 ring-2 ring-synth-pink/20",children:[s.jsx(Qr,{src:((Se=he.author)==null?void 0:Se.avatar_url)||void 0}),s.jsx(Hr,{className:"text-sm font-semibold bg-synth-pink/10 text-synth-pink",children:((kt=(ar=he.author)==null?void 0:ar.name)==null?void 0:kt.split(" ").map(lr=>lr[0]).join(""))||"U"})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-sm text-gray-900",children:(($t=he.author)==null?void 0:$t.name)||"Anonymous"}),s.jsx("p",{className:"text-xs text-gray-500",children:he.type.charAt(0).toUpperCase()+he.type.slice(1)})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(et,{className:"synth-badge text-xs",children:[s.jsx(Lt,{className:"w-3 h-3 mr-1"}),he.type.charAt(0).toUpperCase()+he.type.slice(1)]})})]}),s.jsx("div",{className:"mb-4",children:s.jsx(A0,{item:he})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h2",{className:"font-bold text-lg text-gray-900",children:he.title}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Nme,{followedArtists:dt,followedVenues:ht,artistName:(Ut=he.event_data)==null?void 0:Ut.artist_name,venueName:(pr=he.event_data)==null?void 0:pr.venue_name,venueCity:(Gr=he.event_data)==null?void 0:Gr.venue_city,venueState:(_r=he.event_data)==null?void 0:_r.venue_state}),((fn=he.event_data)==null?void 0:fn.is_promoted)&&((Cs=he.event_data)==null?void 0:Cs.promotion_tier)&&s.jsx(G8,{promotionTier:he.event_data.promotion_tier})]})]}),he.event_data&&s.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(yr,{className:"w-4 h-4 text-synth-pink"}),s.jsx("span",{children:he.event_data.venue_name}),he.event_data.venue_city&&s.jsxs("span",{className:"text-gray-500",children:[" ",he.event_data.venue_city]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"w-4 h-4 text-synth-pink"}),s.jsx("span",{children:Rt(gs(he.event_data.event_date),"EEEE, MMMM d, yyyy")})]}),(()=>{var Qt,ca;const lr=he.event_data,sn=lr==null?void 0:lr.price_range,Yn=(Qt=lr==null?void 0:lr.ticket_price_min)!=null?Qt:lr==null?void 0:lr.price_min,Dr=(ca=lr==null?void 0:lr.ticket_price_max)!=null?ca:lr==null?void 0:lr.price_max;if(sn||Yn||Dr){let wr="";return sn?wr=Vv(sn):Yn&&Dr?wr=`$${Yn} - $${Dr}`:Yn?wr=`$${Yn}+`:Dr&&(wr=`Up to $${Dr}`),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(zl,{className:"w-4 h-4 text-synth-pink"}),s.jsx("span",{className:"font-medium",children:wr})]})}return null})()]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[he.type==="event"&&he.event_data?s.jsxs("button",{onClick:lr=>{lr.stopPropagation(),du(he)},className:`flex items-center gap-1 text-sm transition-colors px-3 py-1 rounded-md ${rt.has(he.event_data.id)?"bg-pink-500 text-white hover:bg-pink-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[s.jsx(es,{className:`w-4 h-4 ${rt.has(he.event_data.id)?"fill-current":""}`}),s.jsx("span",{children:rt.has(he.event_data.id)?"Interested":"I'm Interested"})]}):s.jsxs("button",{onClick:lr=>{lr.stopPropagation(),xa(he)},className:`flex items-center gap-1 text-sm transition-colors ${We.has(he.id)?"text-red-500":"text-gray-500 hover:text-red-500"}`,children:[s.jsx(es,{className:`w-4 h-4 ${We.has(he.id)?"fill-current":""}`}),s.jsx("span",{children:he.likes_count||0})]}),s.jsxs("button",{onClick:lr=>{var sn;lr.stopPropagation(),rr(((sn=he.event_data)==null?void 0:sn.id)||he.id)},className:"flex items-center gap-1 text-sm text-gray-500 hover:text-blue-500 transition-colors",children:[s.jsx(Ln,{className:"w-4 h-4"}),s.jsx("span",{children:he.comments_count||0})]}),s.jsxs("button",{onClick:lr=>{lr.stopPropagation(),pn(he)},className:"flex items-center gap-1 text-sm text-gray-500 hover:text-green-500 transition-colors",children:[s.jsx(Dc,{className:"w-4 h-4"}),s.jsx("span",{children:"Share"})]})]}),s.jsx("div",{className:"text-xs text-gray-400",children:os(he.created_at)})]})]})]})},`event-${he.id}-${$e}`)})}),U.length>0&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-6 mt-6",children:[!Y&&s.jsx("p",{className:"text-gray-500 text-sm mb-3",children:"You're all caught up! "}),s.jsx(ce,{onClick:()=>_a(U.length),disabled:Z||!Y,className:Oe("text-white shadow-lg px-6 py-2",Y?"bg-synth-pink hover:bg-synth-pink-dark":"bg-gray-400 cursor-not-allowed"),children:Z?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"h-4 w-4 mr-2 animate-spin"}),"Loading more events..."]}):Y?s.jsx(s.Fragment,{children:"Load more (20 events)"}):s.jsx(s.Fragment,{children:"You're all caught up"})})]})]}),g.includes("reviews")&&s.jsx(tn,{value:"reviews",className:"mt-6",children:U.filter(he=>he.type==="review"&&!he.deleted_at&&!he.is_deleted).length===0?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"flex flex-col gap-[6px] items-center justify-center",children:[s.jsx(Xt,{className:"w-[60px] h-[60px]",style:{color:"var(--neutral-600)"}}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No reviews yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Be the first to share a concert review!"})]})}):s.jsx("div",{className:"space-y-6",children:(()=>{const he=U.filter(Se=>Se.type==="review"&&!Se.deleted_at&&!Se.is_deleted),$e=he.slice(0,3),lt=he.slice(3);return s.jsxs(s.Fragment,{children:[$e.map((Se,ar)=>{var kt,$t,Ut,pr,Gr,_r,fn,Cs,lr,sn,Yn;return console.log(" Review item author data:",{id:Se.id,authorName:(kt=Se.author)==null?void 0:kt.name,avatarUrl:($t=Se.author)==null?void 0:$t.avatar_url,authorId:(Ut=Se.author)==null?void 0:Ut.id,fullAuthor:Se.author}),s.jsx(R2,{review:{id:Se.review_id||Se.id,user_id:((pr=Se.author)==null?void 0:pr.id)||e,event_id:Se.event_id||"",rating:typeof Se.rating=="number"?Se.rating:(Gr=typeof Se.rating=="string"?parseFloat(Se.rating):null)!=null?Gr:0,review_text:Se.content||"",is_public:!0,created_at:Se.created_at,updated_at:Se.updated_at||Se.created_at,likes_count:Se.likes_count||0,comments_count:Se.comments_count||0,shares_count:Se.shares_count||0,is_liked_by_user:We.has(Se.id),reaction_emoji:Se.reaction_emoji||"",photos:Se.photos||[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:(_r=Se.event_info)==null?void 0:_r.artist_name,venue_name:(fn=Se.event_info)==null?void 0:fn.venue_name,artist_performance_rating:Se.artist_performance_rating,production_rating:Se.production_rating,venue_rating:Se.venue_rating,location_rating:Se.location_rating,value_rating:Se.value_rating,artist_performance_feedback:Se.artist_performance_feedback,production_feedback:Se.production_feedback,venue_feedback:Se.venue_feedback,location_feedback:Se.location_feedback,value_feedback:Se.value_feedback,ticket_price_paid:Se.ticket_price_paid,setlist:Se.setlist,custom_setlist:Se.custom_setlist,connection_degree:Se.connection_degree,connection_type_label:Se.connection_type_label},currentUserId:e,onLike:(Dr,Qt)=>{console.log(" BelliStyle onLike:",{reviewId:Dr,isLiked:Qt,itemId:Se.id}),It(Qt?ca=>new Set([...ca,Se.id]):ca=>{const wr=new Set(ca);return wr.delete(Se.id),wr})},onComment:()=>Ae(Se.review_id||Se.id),onShare:Dr=>{pn(Se)},onEdit:()=>{console.log("Edit button clicked for review:",Se.review_id||Se.id),console.log("Full item data:",Se),E(void 0,null,function*(){try{const{data:Qt,error:ca}=yield T.from("reviews").select(`
                              *,
                              events!inner (
                                id,
                                title,
                                artist_name,
                                artist_id,
                                venue_name,
                                venue_id,
                                venue_city,
                                venue_state,
                                venue_zip,
                                venue_address,
                                event_date,
                                doors_time,
                                description,
                                genres,
                                price_range,
                                ticket_urls,
                                setlist
                              )
                            `).eq("id",Se.review_id||Se.id).single();if(ca){console.error("Error fetching review:",ca);return}if(Qt&&Qt.events){const wr=Qt.events,Pn=Qt;console.log(" Setting up edit modal with event data:",{eventId:wr.id,artistName:wr.artist_name,venueName:wr.venue_name,hasSetlist:!!wr.setlist,reviewId:Pn.id}),oe({id:wr.id,jambase_event_id:wr.jambase_event_id,title:wr.title||"Concert Review",artist_name:wr.artist_name,artist_id:wr.artist_id,venue_name:wr.venue_name,venue_id:wr.venue_id,event_date:wr.event_date,doors_time:wr.doors_time,description:wr.description,genres:wr.genres,venue_city:wr.venue_city,venue_state:wr.venue_state,venue_zip:wr.venue_zip,venue_address:wr.venue_address,price_range:wr.price_range,ticket_urls:wr.ticket_urls,setlist:wr.setlist,existing_review_id:Pn.id,existing_review:{rating:Pn.rating,review_text:Pn.review_text,artist_performance_rating:Pn.artist_performance_rating,production_rating:Pn.production_rating,venue_rating:Pn.venue_rating,location_rating:Pn.location_rating,value_rating:Pn.value_rating,artist_performance_feedback:Pn.artist_performance_feedback,production_feedback:Pn.production_feedback,venue_feedback:Pn.venue_feedback,location_feedback:Pn.location_feedback,value_feedback:Pn.value_feedback,ticket_price_paid:Pn.ticket_price_paid,reaction_emoji:Pn.reaction_emoji,is_public:Pn.is_public,review_type:Pn.review_type,photos:Pn.photos,custom_setlist:Pn.custom_setlist,selectedSetlist:wr.setlist,venue_tags:Pn.venue_tags,artist_tags:Pn.artist_tags,mood_tags:Pn.mood_tags,genre_tags:Pn.genre_tags,context_tags:Pn.context_tags}}),xe(!0)}}catch(Qt){console.error("Error loading review data for edit:",Qt)}})},onDelete:Dr=>E(void 0,null,function*(){try{yield cs.deleteEventReview(e,Dr),_a(0),me({title:"Review Deleted",description:"Your review has been deleted."})}catch(Qt){console.error("Error deleting review:",Qt),me({title:"Error",description:"Failed to delete review.",variant:"destructive"})}}),onReport:()=>Ge(Se.id),userProfile:{name:((Cs=Se.author)==null?void 0:Cs.name)||"User",avatar_url:((lr=Se.author)==null?void 0:lr.avatar_url)||void 0,verified:(sn=Se.author)==null?void 0:sn.verified,account_type:(Yn=Se.author)==null?void 0:Yn.account_type},followedArtists:dt,followedVenues:ht},`${Se.id}-${ar}`)}),In.length>0&&s.jsx(bge,{suggestions:In,onUserClick:Se=>a==null?void 0:a(Se),onAddFriend:Rn}),lt.map((Se,ar)=>{var kt,$t,Ut,pr,Gr,_r,fn,Cs;return s.jsx(R2,{review:{id:Se.review_id||Se.id,user_id:((kt=Se.author)==null?void 0:kt.id)||e,event_id:Se.event_id||"",rating:typeof Se.rating=="number"?Se.rating:($t=typeof Se.rating=="string"?parseFloat(Se.rating):null)!=null?$t:0,review_text:Se.content||"",is_public:!0,created_at:Se.created_at,updated_at:Se.updated_at||Se.created_at,likes_count:Se.likes_count||0,comments_count:Se.comments_count||0,shares_count:Se.shares_count||0,is_liked_by_user:We.has(Se.id),reaction_emoji:Se.reaction_emoji||"",photos:Se.photos||[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:(Ut=Se.event_info)==null?void 0:Ut.artist_name,venue_name:(pr=Se.event_info)==null?void 0:pr.venue_name,artist_performance_rating:Se.artist_performance_rating,production_rating:Se.production_rating,venue_rating:Se.venue_rating,location_rating:Se.location_rating,value_rating:Se.value_rating,artist_performance_feedback:Se.artist_performance_feedback,production_feedback:Se.production_feedback,venue_feedback:Se.venue_feedback,location_feedback:Se.location_feedback,value_feedback:Se.value_feedback,ticket_price_paid:Se.ticket_price_paid,setlist:Se.setlist,custom_setlist:Se.custom_setlist,connection_degree:Se.connection_degree,connection_type_label:Se.connection_type_label},currentUserId:e,onLike:(lr,sn)=>{It(sn?Yn=>new Set([...Yn,Se.id]):Yn=>{const Dr=new Set(Yn);return Dr.delete(Se.id),Dr})},onComment:()=>Ae(Se.review_id||Se.id),onShare:lr=>pn(Se),onEdit:()=>{E(void 0,null,function*(){try{const{data:sn,error:Yn}=yield T.from("reviews").select(`
                                    *,
                                    events!inner (
                                      id, title, artist_name, artist_id, venue_name, venue_id,
                                      venue_city, venue_state, venue_zip, venue_address,
                                      event_date, doors_time, description, genres,
                                      price_range, ticket_urls, setlist
                                    )
                                  `).eq("id",Se.review_id||Se.id).single();if(Yn||!sn||!sn.events)return;const Dr=sn.events,Qt=sn;oe({id:Dr.id,jambase_event_id:Dr.jambase_event_id,title:Dr.title||"Concert Review",artist_name:Dr.artist_name,artist_id:Dr.artist_id,venue_name:Dr.venue_name,venue_id:Dr.venue_id,event_date:Dr.event_date,doors_time:Dr.doors_time,description:Dr.description,genres:Dr.genres,venue_city:Dr.venue_city,venue_state:Dr.venue_state,venue_zip:Dr.venue_zip,venue_address:Dr.venue_address,price_range:Dr.price_range,ticket_urls:Dr.ticket_urls,setlist:Dr.setlist,existing_review_id:Qt.id,existing_review:{rating:Qt.rating,review_text:Qt.review_text,artist_performance_rating:Qt.artist_performance_rating,production_rating:Qt.production_rating,venue_rating:Qt.venue_rating,location_rating:Qt.location_rating,value_rating:Qt.value_rating,artist_performance_feedback:Qt.artist_performance_feedback,production_feedback:Qt.production_feedback,venue_feedback:Qt.venue_feedback,location_feedback:Qt.location_feedback,value_feedback:Qt.value_feedback,ticket_price_paid:Qt.ticket_price_paid,reaction_emoji:Qt.reaction_emoji,is_public:Qt.is_public,review_type:Qt.review_type,photos:Qt.photos,custom_setlist:Qt.custom_setlist,selectedSetlist:Dr.setlist,venue_tags:Qt.venue_tags,artist_tags:Qt.artist_tags,mood_tags:Qt.mood_tags,genre_tags:Qt.genre_tags,context_tags:Qt.context_tags}}),xe(!0)}catch(sn){console.error("Error loading review data for edit:",sn)}})},onDelete:lr=>E(void 0,null,function*(){try{yield cs.deleteEventReview(e,lr),_a(0),me({title:"Review Deleted",description:"Your review has been deleted."})}catch(sn){console.error("Error deleting review:",sn),me({title:"Error",description:"Failed to delete review.",variant:"destructive"})}}),onReport:()=>Ge(Se.id),userProfile:{name:((Gr=Se.author)==null?void 0:Gr.name)||"User",avatar_url:((_r=Se.author)==null?void 0:_r.avatar_url)||void 0,verified:(fn=Se.author)==null?void 0:fn.verified,account_type:(Cs=Se.author)==null?void 0:Cs.account_type},followedArtists:dt,followedVenues:ht},`${Se.id}-${ar+3}`)})]})})()})}),g.includes("news")&&s.jsxs(tn,{value:"news",className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Music News"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("select",{value:Cr,onChange:he=>Cn(he.target.value),className:"px-3 py-1 text-sm border border-gray-200 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-pink-500",children:[s.jsx("option",{value:"all",children:"All Sources"}),s.jsx("option",{value:"pitchfork",children:"Pitchfork"}),s.jsx("option",{value:"rollingstone",children:"Rolling Stone"}),s.jsx("option",{value:"nme",children:"NME"}),s.jsx("option",{value:"billboard",children:"Billboard"})]}),s.jsx(ce,{onClick:()=>{Mh.clearCache(),tr()},variant:"outline",size:"sm",disabled:yn,className:"text-pink-600 border-pink-200 hover:bg-pink-50",children:yn?s.jsx("div",{className:"w-4 h-4 animate-spin rounded-full border-2 border-pink-500 border-t-transparent"}):"Refresh"})]})]}),yn&&Wt.length===0&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((he,$e)=>s.jsx(wme,{},$e))}),!yn&&Wt.length>0&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Mh.filterBySource(Wt,Cr).map(he=>s.jsx(_me,{article:he},he.id))}),!yn&&Wt.length===0&&s.jsx(Gle,{icon:s.jsx($P,{className:"w-[60px] h-[60px]",style:{color:"var(--neutral-600)"}}),title:"No news articles found",description:"Check back later for the latest music news and updates!"})]})]}),F&&s.jsx(vn,{open:we,onOpenChange:ve,children:s.jsxs(hn,{className:"sm:max-w-[900px] w-full h-[80vh]",children:[s.jsxs(Hn,{children:[s.jsx(Sn,{children:"Events Map"}),s.jsx(ds,{children:"Explore upcoming events from your feed on an interactive map."})]}),rs.length>0?s.jsx("div",{className:"h-[calc(80vh-120px)] w-full",children:s.jsx(QU,{center:ae,zoom:Kl,events:rs,onEventClick:Qa,onMapCenterChange:he=>fe(he)})}):s.jsx("div",{className:"flex h-[calc(80vh-120px)] items-center justify-center rounded-lg border border-dashed border-muted-foreground/40",children:s.jsx("p",{className:"px-6 text-center text-sm text-muted-foreground",children:"No events in your feed have location data yet. Try adjusting your filters or check back soon."})})]})})]}),s.jsx("div",{style:{height:"0px"}}),_e&&s.jsx(CB,{isOpen:_e,onClose:()=>xe(!1),event:Q,userId:e,onReviewSubmitted:()=>{xe(!1),_a()}}),Ve&&Ke&&s.jsx(Hl,{isOpen:Ve,onClose:()=>le(!1),event:Ke,currentUserId:e,onReview:()=>{Ke&&(oe(Ke),xe(!0))},onInterestToggle:(he,$e)=>E(void 0,null,function*(){try{yield Kr.setEventInterest(e,he,$e),ze($e),H(lt=>lt.map(Se=>{var ar;return Se.type==="event"&&((ar=Se.event_data)==null?void 0:ar.id)===he?V(D({},Se),{event_data:V(D({},Se.event_data),{isInterested:$e})}):Se})),setTimeout(()=>{_a(0,!1)},500),me({title:$e?"Event Added!":"Event Removed",description:$e?"You're now interested in this event":"You're no longer interested in this event"})}catch(lt){console.error("Failed to toggle interest from feed modal",lt),me({title:"Error",description:"Failed to update your interest. Please try again.",variant:"destructive"})}}),onAttendanceChange:(he,$e)=>{console.log(" Attendance changed in feed:",he,$e),$e&&H(lt=>lt.map(Se=>{var ar;return Se.type==="event"&&((ar=Se.event_data)==null?void 0:ar.id)===he?V(D({},Se),{event_data:V(D({},Se.event_data),{isInterested:!1,hasAttended:!0})}):Se}))},isInterested:nt,onNavigateToProfile:a,onNavigateToChat:i}),vt&&s.jsx(XB,{eventId:vt,isOpen:!!vt,onClose:()=>rr(null)}),sr&&s.jsx(fU,{reviewId:sr,isOpen:!!sr,onClose:()=>Ae(null)}),Ue&&s.jsx(bfe,{eventId:Ue,isOpen:!!Ue,onClose:()=>gt(null)}),St&&Fr&&s.jsx(GT,{event:Fr,currentUserId:e,isOpen:St,onClose:()=>_t(!1)}),En&&ur&&s.jsx(MT,{review:ur,currentUserId:e,isOpen:En,onClose:()=>{Dt(!1),or(null)}}),G&&s.jsx(Gq,{currentUserId:e,onBack:()=>J(!1)}),Nt&&at&&s.jsx(vn,{open:Nt,onOpenChange:Tt,children:s.jsxs(hn,{className:"max-w-5xl w-[90vw] h-[90vh] max-h-[90vh] p-0 overflow-hidden flex",children:[s.jsx(Sn,{className:"sr-only",children:"Review Details"}),s.jsxs(ds,{className:"sr-only",children:["Review details for ",((R0=at.event_info)==null?void 0:R0.artist_name)||"artist"]}),s.jsx("div",{className:"flex-1 bg-black flex items-center justify-center min-h-0",children:at.photos&&at.photos.length>0?s.jsx("img",{src:at.photos[0],alt:"Review photo",className:"max-w-full max-h-full object-contain"}):s.jsxs("div",{className:"text-center text-white",children:[s.jsxs("div",{className:"text-6xl font-bold mb-4",children:[s.jsx("span",{className:"text-pink-500",children:"S"}),"ynth"]}),s.jsx("div",{className:"w-32 h-0.5 bg-white mx-auto mb-4"}),s.jsx("div",{className:"text-sm opacity-80",children:"Concert Review"})]})}),s.jsxs("div",{className:"flex-1 flex flex-col bg-white",children:[s.jsx("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white text-sm font-bold",children:((nn=(Wp=at.author)==null?void 0:Wp.name)==null?void 0:nn.charAt(0))||"U"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold text-sm",children:((O0=at.author)==null?void 0:O0.name)||"User"}),s.jsx("div",{className:"text-xs text-gray-500",children:new Date(at.created_at).toLocaleDateString()})]})]})}),s.jsxs("div",{className:"flex-1 p-4 space-y-4 overflow-y-auto",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("div",{className:"flex items-start justify-between mb-3",children:s.jsxs("div",{className:"flex-1",children:[s.jsx("h2",{className:"text-lg font-semibold mb-1",children:((ti=at.event_info)==null?void 0:ti.event_name)||"Concert Review"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[(Xc=at.event_info)==null?void 0:Xc.artist_name,"  ",(Hp=at.event_info)!=null&&Hp.event_date?new Date(at.event_info.event_date).toLocaleDateString():"Date unknown"]}),((M0=at.event_info)==null?void 0:M0.venue_name)&&s.jsx("p",{className:"text-sm text-gray-500",children:at.event_info.venue_name})]})}),s.jsx("div",{className:"flex items-center gap-2",children:(Uf=at.event_info)!=null&&Uf.event_date&&new Date(at.event_info.event_date)<new Date?s.jsxs(et,{variant:"secondary",className:"text-xs bg-gray-100 text-gray-700",children:[s.jsx(Lt,{className:"w-3 h-3 mr-1"}),"Past Event"]}):s.jsxs(et,{variant:"secondary",className:"text-xs bg-blue-100 text-blue-700",children:[s.jsx(Lt,{className:"w-3 h-3 mr-1"}),"Upcoming"]})})]}),at.rating&&s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("div",{className:"flex items-center gap-1",children:[Array.from({length:5},(he,$e)=>s.jsx(Xt,{className:`w-5 h-5 ${$e<Math.floor(at.rating)?"text-yellow-500 fill-yellow-500":"text-gray-300"}`},$e)),s.jsxs("span",{className:"text-sm font-medium ml-1",children:[at.rating,"/5"]})]})}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Review"}),s.jsx("p",{className:"text-gray-700 leading-relaxed",children:at.content||"No review text available."})]}),s.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-gray-200",children:[s.jsxs("button",{onClick:()=>xa(at),className:`flex items-center gap-2 transition-colors ${We.has(at.id)?"text-red-500":"text-gray-700 hover:text-red-500"}`,children:[s.jsx(es,{className:`w-5 h-5 ${We.has(at.id)?"fill-current":""}`}),s.jsxs("span",{children:[at.likes_count||0," likes"]})]}),s.jsxs("button",{onClick:()=>Ae(at.review_id||at.id),className:"flex items-center gap-2 text-gray-700 hover:text-blue-500 transition-colors",children:[s.jsx(Ln,{className:"w-5 h-5"}),s.jsxs("span",{children:[at.comments_count||0," comments"]})]}),s.jsxs("button",{onClick:()=>pn(at),className:"flex items-center gap-2 text-gray-700 hover:text-green-500 transition-colors",children:[s.jsx(Dc,{className:"w-5 h-5"}),s.jsx("span",{children:"Share"})]}),s.jsxs("button",{onClick:()=>js(at),className:`flex items-center gap-2 transition-colors ${jt.has(at.id)?"text-yellow-500":"text-gray-700 hover:text-yellow-500"}`,children:[s.jsx(FQ,{className:`w-5 h-5 ${jt.has(at.id)?"fill-current":""}`}),s.jsx("span",{children:"Save"})]})]})]})]})]})}),s.jsx(vn,{open:Or.open,onOpenChange:he=>An({open:he,artist:null,events:void 0,totalEvents:void 0}),children:s.jsxs(hn,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(Sn,{className:"sr-only",children:"Artist Profile"}),s.jsxs(ds,{className:"sr-only",children:["Artist profile for ",((D0=Or.artist)==null?void 0:D0.name)||"artist"]}),Or.artist&&(la?s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(fr,{className:"w-6 h-6 animate-spin text-pink-500"}),s.jsx("span",{className:"ml-2",children:"Loading events..."})]}):s.jsx(bme,{artist:Or.artist,events:Or.events||[],totalEvents:Or.totalEvents||0,source:Or.events&&Or.events.length>0?"api":"database",userId:e,onBack:()=>An({open:!1,artist:null,events:void 0,totalEvents:void 0}),showAllEvents:!0}))]})}),s.jsx(vn,{open:Br.open,onOpenChange:he=>zn({open:he,venueId:null,venueName:""}),children:s.jsxs(hn,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(Sn,{className:"sr-only",children:"Venue Profile"}),s.jsxs(ds,{className:"sr-only",children:["Venue profile for ",Br.venueName||"venue"]}),s.jsx(jme,{venueId:Br.venueId,venueName:Br.venueName,onClose:()=>zn({open:!1,venueId:null,venueName:""})})]})}),ye&&s.jsx(ZU,{isOpen:rn,onClose:()=>{Mt(!1),Ie(null)},contentType:"event",contentId:ye.id,contentTitle:ye.title})]})},Pge=({isOpen:e,onClose:t,type:r,friends:n,count:a,onStartChat:i,onViewProfile:o,onUnfriend:l})=>{const c=r==="friends"?"Friends":r==="followers"?"Followers":"Following";return s.jsx(vn,{open:e,onOpenChange:t,children:s.jsxs(hn,{className:"sm:max-w-lg w-[95vw] max-h-[80vh] flex flex-col",children:[s.jsx(Hn,{className:"flex-shrink-0",children:s.jsx(Sn,{className:"text-center",children:c})}),s.jsx(S1,{className:"flex-1 max-h-[60vh]",children:s.jsx("div",{className:"space-y-2 py-2",children:n.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Is,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:r==="friends"?"No friends yet":r==="followers"?"No followers yet":"Not following anyone yet"})]}):n.map(d=>s.jsxs("div",{className:"flex items-center gap-3 hover:bg-muted/40 rounded-lg p-3 transition-colors mx-2",children:[s.jsxs(Wr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(Qr,{src:d.avatar_url||void 0}),s.jsx(Hr,{className:"text-sm",children:d.name?d.name.split(" ").map(f=>f[0]).join(""):"U"})]}),s.jsxs("div",{className:"flex-1 min-w-0 mr-2",onClick:()=>o&&o(d),children:[s.jsx("p",{className:"font-semibold text-sm truncate",children:d.name}),s.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["@",d.username]}),d.bio&&s.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:d.bio})]}),s.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[o&&s.jsx(ce,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 hover:bg-gray-100",onClick:f=>{f.stopPropagation(),o(d)},children:s.jsx(Jd,{className:"w-4 h-4"})}),i&&s.jsx(ce,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 hover:bg-gray-100",onClick:f=>{f.stopPropagation(),i(d.user_id)},children:s.jsx(Ln,{className:"w-4 h-4"})}),l&&r==="friends"&&s.jsx(ce,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",onClick:f=>E(void 0,null,function*(){f.stopPropagation();try{yield l(d.user_id)}catch(u){console.error("Error unfriending user:",u)}}),children:s.jsx(az,{className:"w-4 h-4"})})]})]},d.id))})})]})})};function Tge({isOpen:e,onClose:t,userId:r,profileName:n,isOwnProfile:a=!1,onNavigateToProfile:i}){const o=ts(),[l,c]=y.useState([]),[d,f]=y.useState([]),[u,h]=y.useState([]),[m,v]=y.useState(!0),[g,x]=y.useState(null),[_,w]=y.useState("users");y.useEffect(()=>{e&&r?(console.log(" FollowingModal: Loading following for user:",r),b()):(c([]),f([]),h([]),v(!0))},[e,r]);const b=()=>E(this,null,function*(){try{v(!0),x(null),console.log(" FollowingModal: Fetching users, artists and venues for user:",r);const[C,A,R]=yield Promise.all([T.from("user_relationships").select("related_user_id, created_at").eq("user_id",r).eq("relationship_type","follow").order("created_at",{ascending:!1}),ki.getUserFollowedArtists(r),Ou.getUserFollowedVenues(r)]);if(C.error)console.error("Error fetching followed users:",C.error);else{const M=(C.data||[]).map(B=>B.related_user_id).filter(Boolean);if(M.length>0){const{data:B,error:F}=yield T.from("users").select("id, user_id, name, username, avatar_url, bio").in("user_id",M);if(F)console.error("Error fetching user profiles:",F);else{const U=(B||[]).sort((H,q)=>(H.name||"").localeCompare(q.name||"",void 0,{sensitivity:"base"})).map(H=>({id:H.id,user_id:H.user_id,name:H.name||"Unknown User",username:H.username,avatar_url:H.avatar_url,bio:H.bio}));c(U),console.log(" FollowingModal: Set users:",U.length)}}}console.log(" FollowingModal: Received artists:",A.length,"venues:",R.length),console.log(" FollowingModal: Artist details:",A.map(M=>({name:M.artist_name,id:M.artist_id})));const I=A.filter(M=>M.artist_name&&M.artist_name.trim()!=="");I.length<A.length&&console.warn(` Filtered out ${A.length-I.length} artists without names`);const O=[...I].sort((M,B)=>(M.artist_name||"").localeCompare(B.artist_name||"",void 0,{sensitivity:"base"})),z=[...R].sort((M,B)=>(M.venue_name||"").localeCompare(B.venue_name||"",void 0,{sensitivity:"base"}));f(O),h(z),console.log(" FollowingModal: Set artists:",O.length,"venues:",z.length)}catch(C){console.error(" FollowingModal: Error loading following:",C),x("Failed to load following")}finally{v(!1)}}),N=C=>{if(!C.artist_name)return;const A=C.artist_id&&C.artist_id!=="manual"?C.artist_id:encodeURIComponent(C.artist_name);o(`/artist/${A}`),t()},S=C=>{if(!C.venue_name)return;const A=C.venue_id||encodeURIComponent(C.venue_name);o(`/venue/${A}`),t()},k=C=>{i&&i(C.user_id),t()};return l.length+d.length+u.length,s.jsx(vn,{open:e,onOpenChange:t,children:s.jsxs(hn,{className:"sm:max-w-lg w-[95vw] max-h-[80vh] flex flex-col p-0 max-w-[393px] mx-auto",children:[s.jsxs(Hn,{className:"flex-shrink-0 px-6 pt-6 pb-4 border-b relative",children:[s.jsx(Sn,{className:"text-center text-lg font-semibold",children:"Following"}),s.jsx("button",{onClick:t,className:"absolute right-4 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full bg-[#cc2486] flex items-center justify-center hover:bg-[#b01f75] transition-colors","aria-label":"Close",children:s.jsx(Yr,{className:"w-4 h-4 text-white"})})]}),s.jsxs(zi,{value:_,onValueChange:C=>w(C),className:"flex-1 flex flex-col min-h-0",children:[s.jsxs(wi,{className:"w-full grid grid-cols-3 rounded-none border-b",children:[s.jsxs(en,{value:"users",className:"rounded-none",children:["Users (",l.length,")"]}),s.jsxs(en,{value:"artists",className:"rounded-none",children:["Artists (",d.length,")"]}),s.jsxs(en,{value:"venues",className:"rounded-none",children:["Venues (",u.length,")"]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4 min-h-0",children:m?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(fr,{className:"w-6 h-6 animate-spin text-[#cc2486] mr-2"}),s.jsx("span",{className:"text-muted-foreground",children:"Loading..."})]}):g?s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-red-600",children:g})}):s.jsxs(s.Fragment,{children:[s.jsx(tn,{value:"users",className:"mt-0 space-y-2",children:l.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Is,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:a?"Not following any users yet":`${n} is not following any users yet`})]}):l.map(C=>s.jsxs("div",{className:"flex items-center gap-3 hover:bg-muted/40 rounded-lg p-3 transition-colors mx-2",onClick:()=>k(C),children:[s.jsxs(Wr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(Qr,{src:C.avatar_url||void 0}),s.jsx(Hr,{className:"text-sm",children:C.name?C.name.split(" ").map(A=>A[0]).join(""):"U"})]}),s.jsxs("div",{className:"flex-1 min-w-0 mr-2",children:[s.jsx("p",{className:"font-semibold text-sm truncate",children:C.name}),C.username?s.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["@",C.username]}):null,C.bio&&s.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:C.bio})]})]},C.user_id))}),s.jsx(tn,{value:"artists",className:"mt-0 space-y-2",children:d.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ft,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:a?"Not following any artists yet":`${n} is not following any artists yet`})]}):d.map(C=>s.jsxs("div",{className:"flex items-center gap-3 hover:bg-[rgba(201,201,201,0.2)] rounded-lg p-3 transition-colors cursor-pointer",onClick:()=>N(C),children:[s.jsxs(Wr,{className:"w-12 h-12 flex-shrink-0",children:[C.artist_image_url?s.jsx(Qr,{src:C.artist_image_url,alt:C.artist_name||"Artist"}):null,s.jsx(Hr,{className:"bg-[#fdf2f7]",children:s.jsx(Ft,{className:"w-6 h-6 text-[#cc2486]"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-base truncate",children:C.artist_name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Artist"})]})]},C.artist_id||C.artist_name))}),s.jsx(tn,{value:"venues",className:"mt-0 space-y-2",children:u.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(yr,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:a?"Not following any venues yet":`${n} is not following any venues yet`})]}):u.map(C=>s.jsxs("div",{className:"flex items-center gap-3 hover:bg-[rgba(201,201,201,0.2)] rounded-lg p-3 transition-colors cursor-pointer",onClick:()=>S(C),children:[s.jsxs(Wr,{className:"w-12 h-12 flex-shrink-0",children:[C.venue_image_url?s.jsx(Qr,{src:C.venue_image_url,alt:C.venue_name||"Venue"}):null,s.jsx(Hr,{className:"bg-[#fdf2f7]",children:s.jsx(yr,{className:"w-6 h-6 text-[#cc2486]"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-base truncate",children:C.venue_name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:C.venue_state||"Venue"})]})]},C.venue_id||C.venue_name))})]})})]})]})})}function Age({children:e}){const[t,r]=y.useState(!1);return y.useEffect(()=>{const n=()=>{r(window.innerWidth<768)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),t?s.jsx("div",{className:"flex justify-center py-4",children:s.jsxs("div",{className:"relative w-full max-w-[420px] rounded-3xl border border-gray-200 bg-[#fcfcfc] shadow-lg overflow-hidden",children:[s.jsxs("div",{className:"h-[47px] bg-[#fcfcfc] border-b border-gray-200 flex items-end justify-center px-3 pt-1",children:[s.jsx("div",{className:"flex-1 flex items-center",children:s.jsx("span",{className:"text-[13px] font-semibold text-black ml-1",children:"9:41"})}),s.jsx("div",{className:"flex-1 flex justify-center",children:s.jsx("div",{className:"bg-black h-[28px] w-[108px] rounded-full"})}),s.jsxs("div",{className:"flex-1 flex justify-end items-center gap-1 text-black/80 text-[10px]",children:[s.jsx("div",{className:"w-4 h-[10px] bg-gradient-to-r from-black/10 to-black rounded-[3px]"}),s.jsx("div",{className:"w-4 h-[10px] bg-gradient-to-r from-black/10 to-black rounded-[3px]"}),s.jsx("div",{className:"w-6 h-[10px] border border-black rounded-[3px] flex items-center justify-end pr-[1px]",children:s.jsx("div",{className:"h-[7px] w-[9px] bg-black rounded-[2px]"})})]})]}),s.jsx("div",{className:"max-h-[calc(100vh-140px)] overflow-y-auto px-4 pb-24 pt-4",children:e}),s.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-3 flex justify-center",children:s.jsxs("div",{className:"pointer-events-auto flex items-center justify-between gap-6 rounded-2xl border border-gray-200 bg-[#f9d7e4] px-6 py-3 shadow-md w-[90%] max-w-[360px]",children:[s.jsxs("button",{type:"button",className:"flex flex-col items-center text-xs text-[#cc2486]",children:[s.jsx(OP,{className:"w-5 h-5"}),s.jsx("span",{className:"mt-1",children:"Home"})]}),s.jsxs("button",{type:"button",className:"flex flex-col items-center text-xs text-[#cc2486]",children:[s.jsx(Ho,{className:"w-5 h-5"}),s.jsx("span",{className:"mt-1",children:"Search"})]}),s.jsx("button",{type:"button",className:"flex items-center justify-center rounded-full bg-[#cc2486] text-white w-[70px] h-10 shadow-sm",children:s.jsx(Yo,{className:"w-5 h-5"})}),s.jsxs("button",{type:"button",className:"flex flex-col items-center text-xs text-[#cc2486]",children:[s.jsx(Ln,{className:"w-5 h-5"}),s.jsx("span",{className:"mt-1",children:"Feed"})]}),s.jsxs("button",{type:"button",className:"flex flex-col items-center text-xs text-[#cc2486]",children:[s.jsx(Is,{className:"w-5 h-5"}),s.jsx("span",{className:"mt-1",children:"Profile"})]})]})})]})}):s.jsx("div",{className:"flex justify-center py-6",children:s.jsx("div",{className:"w-full max-w-3xl rounded-xl border border-gray-200 bg-[#fcfcfc] shadow-md max-h-[80vh] overflow-y-auto px-6 pb-6 pt-4",children:e})})}function k7({event:e,userId:t,isOpen:r,onClose:n,onReviewSubmitted:a}){if(!e)return null;const i=()=>{n()};return s.jsx(vn,{open:r,onOpenChange:i,children:s.jsx(hn,{className:"max-w-4xl w-[98vw] h-[90dvh] max-h-[90dvh] p-0 overflow-hidden flex flex-col bg-transparent border-none shadow-none",hideCloseButton:!0,children:s.jsx(Age,{children:s.jsx(EB,{event:e,userId:t,onSubmitted:o=>E(this,null,function*(){if(a){const l=a(o);l instanceof Promise&&(yield l)}n()}),onDeleted:()=>E(this,null,function*(){if(a){const o=a(null);o instanceof Promise&&(yield o)}n()}),onClose:n})})})})}class Rge{constructor(){Pr(this,"developerToken","");Pr(this,"musicKit",null);Pr(this,"userToken",null);Pr(this,"storefront","us");this.init()}init(){return E(this,null,function*(){yield this.loadMusicKit()})}loadMusicKit(){return E(this,null,function*(){if(typeof window!="undefined")if(window.MusicKit)this.configureMusicKit();else return new Promise((t,r)=>{const n=document.createElement("script");n.src="https://js-cdn.music.apple.com/musickit/v1/musickit.js",n.onload=()=>{this.configureMusicKit(),t()},n.onerror=r,document.head.appendChild(n)})})}configureMusicKit(){if(!this.developerToken){console.warn("Apple Music developer token not configured");return}try{window.MusicKit.configure({developerToken:this.developerToken,app:{name:"PlusOne Event Crew",build:"1.0.0"}}),this.musicKit=window.MusicKit.getInstance()}catch(t){console.error("MusicKit configuration error:",t)}}authenticate(){return E(this,null,function*(){if(!this.musicKit)throw new Error("MusicKit not initialized");yield this.musicKit.authorize(),this.musicKit.isAuthorized&&(this.userToken=this.musicKit.musicUserToken,yield this.getUserStorefront(),setTimeout(()=>{this.autoSync().catch(console.error)},2e3))})}checkStoredToken(){var t;return((t=this.musicKit)==null?void 0:t.isAuthorized)||!1}logout(){this.musicKit&&this.musicKit.unauthorize(),this.userToken=null}appleMusicApiCall(n){return E(this,arguments,function*(t,r={}){if(!this.userToken&&!t.includes("/catalog/"))throw new Error("User token required for library access");const i=`https://api.music.apple.com/v1${t}`,o={Authorization:`Bearer ${this.developerToken}`,"Content-Type":"application/json"};this.userToken&&!t.includes("/catalog/")&&(o["Music-User-Token"]=this.userToken);const l=yield fetch(i,D({headers:o},r));if(!l.ok)throw new Error(`Apple Music API error: ${l.status} ${l.statusText}`);return l.json()})}getUserStorefront(){return E(this,null,function*(){try{const t=yield this.appleMusicApiCall("/me/storefront");return t.data&&t.data.length>0?(this.storefront=t.data[0].id,t.data[0]):null}catch(t){return console.error("Error getting user storefront:",t),null}})}getLibrarySongs(t=100){return E(this,null,function*(){return this.appleMusicApiCall(`/me/library/songs?limit=${t}`)})}getLibraryArtists(t=100){return E(this,null,function*(){return this.appleMusicApiCall(`/me/library/artists?limit=${t}`)})}getLibraryAlbums(t=100){return E(this,null,function*(){return this.appleMusicApiCall(`/me/library/albums?limit=${t}`)})}getRecentlyPlayed(t=30){return E(this,null,function*(){return this.appleMusicApiCall(`/me/recent/played/tracks?limit=${t}`)})}getReplayData(){return E(this,null,function*(){try{return this.appleMusicApiCall("/me/library/replay")}catch(t){return console.log("Replay data not available or accessible"),null}})}getHeavyRotation(){return E(this,null,function*(){try{return this.appleMusicApiCall("/me/history/heavy-rotation")}catch(t){return console.log("Heavy rotation data not available"),null}})}getRecommendations(){return E(this,null,function*(){try{return this.appleMusicApiCall("/me/recommendations")}catch(t){return console.log("Recommendations not available"),null}})}getCharts(t="songs,albums,artists",r=20){return E(this,null,function*(){return this.appleMusicApiCall(`/catalog/${this.storefront}/charts?types=${t}&limit=${r}`)})}getLibraryPlaylist(t=100){return E(this,null,function*(){try{return this.appleMusicApiCall(`/me/library/playlists?limit=${t}`)}catch(r){return console.log("Library playlists not available"),null}})}getLibraryStats(){return E(this,null,function*(){try{const[t,r,n,a]=yield Promise.allSettled([this.getLibrarySongs(1e3),this.getLibraryArtists(1e3),this.getLibraryAlbums(1e3),this.getLibraryPlaylist(1e3)]),i=t.status==="fulfilled"?t.value.data:[],o=r.status==="fulfilled"?r.value.data:[],l=n.status==="fulfilled"?n.value.data:[],c=a.status==="fulfilled"?a.value.data:[];return{totalSongs:i.length,totalArtists:o.length,totalAlbums:l.length,totalPlaylists:c.length,songs:i,artists:o,albums:l,playlists:c}}catch(t){return console.error("Error getting library stats:",t),null}})}processLibraryData(t,r){if(!t||!Array.isArray(t))return[];let n=[...t];switch(r){case"last-week":n=t.slice(0,20);break;case"last-month":n=t.slice(0,30);break;case"last-6-months":n=t.slice(0,50);break;default:n=t.slice(0,20)}return n}calculateListeningStats(t,r){const n=t.length,a=r.length,i=new Set;t.forEach(h=>{h.attributes.albumName&&i.add(h.attributes.albumName)});const o=i.size,l=t.reduce((h,m)=>h+(m.attributes.durationInMillis||0),0),c=Math.round(l/(1e3*60*60)*10)/10,d=n>0?Math.round(l/n/1e3):0,f={};[...t,...r].forEach(h=>{(h.attributes.genreNames||[]).forEach(v=>{f[v]=(f[v]||0)+1})});const u=Object.entries(f).sort(([,h],[,m])=>m-h).slice(0,5).map(([h])=>h);return{totalTracks:n,uniqueArtists:a,uniqueAlbums:o,totalHours:c,avgDuration:d,topGenres:u}}formatDuration(t){if(!t)return"";const r=Math.floor(t/6e4),n=Math.floor(t%6e4/1e3);return`${r}:${n.toString().padStart(2,"0")}`}formatDate(t){const n=(new Date().getTime()-t.getTime())/(1e3*60*60);return n<1?"Just now":n<24?`${Math.floor(n)} hours ago`:n<168?`${Math.floor(n/24)} days ago`:t.toLocaleDateString()}getArtworkUrl(t,r=300,n=300){return t!=null&&t.url?t.url.replace("{w}",r.toString()).replace("{h}",n.toString()):""}generateProfileData(){return E(this,null,function*(){try{if(!this.userToken)throw new Error("User not authenticated");const t=yield this.getLibraryStats();if(!t)throw new Error("Failed to get library stats");const[r,n]=yield Promise.allSettled([this.getRecentlyPlayed(50),this.getUserStorefront()]),a=r.status==="fulfilled"?r.value.data:[],i=n.status==="fulfilled"?n.value:null,o=this.calculateListeningStats(t.songs,t.artists),l=this.processLibraryData(t.songs,"last-month").slice(0,20),c=this.processLibraryData(t.artists,"last-month").slice(0,20),d=this.processLibraryData(t.albums,"last-month").slice(0,20);return{storefront:(i==null?void 0:i.id)||"us",libraryStats:t,topTracks:l,topArtists:c,topAlbums:d,recentlyPlayed:a,topGenres:o.topGenres,listeningTime:o.totalHours,lastUpdated:new Date().toISOString()}}catch(t){return console.error("Error generating profile data:",t),null}})}uploadProfileData(t){return E(this,null,function*(){try{const r=yield this.getCurrentUserId(),n=typeof window!="undefined"?window.location.origin:"",a=yield fetch(`${n}/api/user/streaming-profile`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"apple-music",data:t,userId:r||"anonymous"})});if(!a.ok){const o=yield a.json().catch(()=>({}));throw new Error(`Upload failed: ${a.status} ${a.statusText} - ${o.error||"Unknown error"}`)}const i=yield a.json();console.log("Profile data uploaded successfully:",i);try{const o=yield this.getCurrentUserId();if(o&&t){const l=t.topArtists||[],c=t.topGenres||[],d={user_id:o,service_type:"apple-music",top_artists:l.map(f=>{var u;return{name:f.name||((u=f.attributes)==null?void 0:u.name)||"",popularity:f.popularity||0,id:f.id}}),top_genres:c.map(f=>({genre:typeof f=="string"?f:f.genre||"",count:typeof f=="string"?1:f.count||1})),total_tracks:t.totalTracks||0,unique_artists:l.length,total_listening_hours:t.totalListeningHours||0};console.log(" Stats table removed - stats not persisted");try{const{streamingSyncService:f}=yield Rr(()=>E(this,null,function*(){const{streamingSyncService:u}=yield Promise.resolve().then(()=>nw);return{streamingSyncService:u}}),void 0,import.meta.url);f.isSyncing()&&f.completeSync()}catch(f){console.warn("Could not notify sync service:",f)}}}catch(o){console.error("Error storing Apple Music stats:",o);try{const{streamingSyncService:l}=yield Rr(()=>E(this,null,function*(){const{streamingSyncService:c}=yield Promise.resolve().then(()=>nw);return{streamingSyncService:c}}),void 0,import.meta.url);l.errorSync(o instanceof Error?o.message:"Unknown error")}catch(l){console.warn("Could not notify sync service of error:",l)}}return!0}catch(r){return console.error("Error uploading profile data:",r),!1}})}getCurrentUserId(){return E(this,null,function*(){try{const{supabase:t}=yield Rr(()=>E(this,null,function*(){const{supabase:n}=yield Promise.resolve().then(()=>Hie);return{supabase:n}}),void 0,import.meta.url),{data:{user:r}}=yield t.auth.getUser();return(r==null?void 0:r.id)||null}catch(t){return console.error("Error getting current user:",t),null}})}syncProfileData(){return E(this,null,function*(){try{const t=yield this.generateProfileData();return t?yield this.uploadProfileData(t):!1}catch(t){return console.error("Error syncing profile data:",t),!1}})}shouldSync(){const t=localStorage.getItem("apple-music-last-sync");if(!t)return!0;const r=new Date(t);return(new Date().getTime()-r.getTime())/(1e3*60*60)>=24}markSyncCompleted(){localStorage.setItem("apple-music-last-sync",new Date().toISOString())}autoSync(){return E(this,null,function*(){if(!this.shouldSync()){console.log("Apple Music profile sync not needed yet");return}console.log("Starting Apple Music profile sync..."),(yield this.syncProfileData())?(this.markSyncCompleted(),console.log("Apple Music profile sync completed successfully")):console.log("Apple Music profile sync failed")})}}const gg=new Rge,E7=e=>{if(!e)return"unknown";const t=e.toLowerCase();return t.includes("spotify.com")||t.includes("open.spotify")||t.startsWith("spotify:")||/^[a-zA-Z0-9_]{1,}$/.test(e)?"spotify":t.includes("music.apple.com")||t.includes("apple.com/music")||t.includes("applemusic")||t.includes("apple music")?"apple-music":"unknown"};class Oge{static getUserStats(t,r=30){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("event_type, entity_type").eq("user_id",t).gte("occurred_at",new Date(Date.now()-r*24*60*60*1e3).toISOString());if(a)throw a;const i={events_viewed:(n==null?void 0:n.filter(d=>d.event_type==="view"&&d.entity_type==="event").length)||0,events_clicked:(n==null?void 0:n.filter(d=>d.event_type==="click"&&d.entity_type==="event").length)||0,events_interested:0,events_attended:0,reviews_written:0,reviews_liked:(n==null?void 0:n.filter(d=>d.event_type==="like"&&d.entity_type==="review").length)||0,ticket_clicks:(n==null?void 0:n.filter(d=>d.event_type==="click"&&d.entity_type==="ticket_link").length)||0,searches_performed:(n==null?void 0:n.filter(d=>d.event_type==="search").length)||0,friends_count:0},[o,l,c]=yield Promise.all([T.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("user_id",t).in("relationship_type",["interested","going","maybe"]),T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY"),T.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","friend").or(`user_id.eq.${t},related_user_id.eq.${t}`)]);return i.events_interested=o.count||0,i.reviews_written=l.count||0,i.friends_count=c.count||0,i}catch(n){throw console.error("Error fetching user stats:",n),n}})}static getTopArtists(t,r=5){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("metadata").eq("user_id",t).not("metadata->artist_name","is",null).gte("occurred_at",new Date(Date.now()-7776e6).toISOString());if(a)throw a;const i=new Map;return n==null||n.forEach(l=>{var d;const c=(d=l.metadata)==null?void 0:d.artist_name;c&&i.set(c,(i.get(c)||0)+1)}),Array.from(i.entries()).map(([l,c])=>({artist_name:l,interaction_count:c,reviews_written:0})).sort((l,c)=>c.interaction_count-l.interaction_count).slice(0,r)}catch(n){return console.error("Error fetching top artists:",n),[]}})}static getTopVenues(t,r=5){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("metadata").eq("user_id",t).not("metadata->venue_name","is",null).gte("occurred_at",new Date(Date.now()-7776e6).toISOString());if(a)throw a;const i=new Map;return n==null||n.forEach(o=>{var f,u,h;const l=(f=o.metadata)==null?void 0:f.venue_name,c=(u=o.metadata)==null?void 0:u.venue_city,d=(h=o.metadata)==null?void 0:h.venue_state;if(l){const m=i.get(l)||{count:0};i.set(l,{count:m.count+1,city:c||m.city,state:d||m.state})}}),Array.from(i.entries()).map(([o,l])=>({venue_name:o,venue_city:l.city,venue_state:l.state,interaction_count:l.count})).sort((o,l)=>l.interaction_count-o.interaction_count).slice(0,r)}catch(n){return console.error("Error fetching top venues:",n),[]}})}static getReviewStats(t){return E(this,null,function*(){var r;try{const{data:n,error:a}=yield T.from("reviews").select("id, rating, likes_count, comments_count, event_id").eq("user_id",t).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").order("likes_count",{ascending:!1});if(a)throw a;const i=[...new Set((n||[]).map(d=>d.event_id).filter(Boolean))];let o={};if(i.length>0){const{data:d,error:f}=yield T.from("events").select("id, title").in("id",i);!f&&d&&(o=d.reduce((u,h)=>(u[h.id]=h,u),{}))}const l=(n||[]).map(d=>V(D({},d),{event:d.event_id&&o[d.event_id]||null}));if(!l||l.length===0)return{review_count:0,avg_rating:0,total_likes:0,total_comments:0};const c={review_count:l.length,avg_rating:l.reduce((d,f)=>d+f.rating,0)/l.length,total_likes:l.reduce((d,f)=>d+(f.likes_count||0),0),total_comments:l.reduce((d,f)=>d+(f.comments_count||0),0)};return l[0]&&l[0].likes_count>0&&(c.most_liked_review={id:l[0].id,event_name:((r=l[0].event)==null?void 0:r.title)||"Unknown Event",likes_count:l[0].likes_count}),c}catch(n){return console.error("Error fetching review stats:",n),{review_count:0,avg_rating:0,total_likes:0,total_comments:0}}})}static getGenreBreakdown(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("interactions").select("metadata").eq("user_id",t).eq("entity_type","event").not("metadata->genres","is",null);if(n)throw n;const a=new Map;let i=0;return r==null||r.forEach(o=>{var c;(((c=o.metadata)==null?void 0:c.genres)||[]).forEach(d=>{a.set(d,(a.get(d)||0)+1),i++})}),Array.from(a.entries()).map(([o,l])=>({genre:o,count:l,percentage:Math.round(l/i*100)})).sort((o,l)=>l.count-o.count).slice(0,5)}catch(r){return console.error("Error fetching genre breakdown:",r),[]}})}static getActualAttendedEventsCount(t){return E(this,null,function*(){try{const{count:r}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY"),{count:n}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_draft",!0),{count:a}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("review_text","ATTENDANCE_ONLY"),i=(r||0)+(n||0)+(a||0);return console.log(` Attended events: ${r||0} reviews + ${n||0} drafts + ${a||0} attendance-only = ${i}`),i}catch(r){return console.error("Error getting actual attended events count:",r),0}})}static getActualUniqueVenuesCount(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("reviews").select(`
          id, 
          is_draft, 
          review_text, 
          events!inner(
            id,
            title, 
            venues(name),
            artists(name)
          )
        `).eq("user_id",t);if(n)return console.error("Error fetching reviews for venue count:",n),0;if(!r||r.length===0)return 0;const a=new Set,i=[];r.forEach(c=>{var m,v;const d=c.events,f=((m=d==null?void 0:d.venues)==null?void 0:m.name)||null,u=((v=d==null?void 0:d.artists)==null?void 0:v.name)||null,h=(d==null?void 0:d.title)||null;if(f){a.add(f);let g="completed";c.is_draft?g="draft":c.review_text==="ATTENDANCE_ONLY"&&(g="attendance-only"),i.push({venue:f,event:h||`${u} concert`,type:g})}});const o=a.size;console.log(` Unique venues: ${o} from ${(r==null?void 0:r.length)||0} total attended events`),console.log(" Venue details:",i),console.log(" Unique venue names:",Array.from(a));const l=i.filter(c=>c.venue==="Ameris Bank Amphitheatre");if(l.length>0){console.log(" PROBLEM FOUND: Incorrect venue data:",l),console.log(" This venue should be removed or corrected in the database");const c=Array.from(a).filter(d=>d!=="Ameris Bank Amphitheatre");return console.log(` Corrected unique venues (excluding problematic): ${c.length}`),console.log(" Corrected venue names:",c),c.length}return o}catch(r){return console.error("Error getting actual unique venues count:",r),0}})}static getActualInterestedEventsCount(t){return E(this,null,function*(){try{const{count:r}=yield T.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("user_id",t).in("relationship_type",["interested","going","maybe"]),n=r||0;return console.log(` Interested events: ${n}`),n}catch(r){return console.error("Error getting actual interested events count:",r),0}})}static getUserAchievements(t){return E(this,null,function*(){try{const[r,n,a,i]=yield Promise.all([this.getUserStats(t,365),this.getReviewStats(t),this.getTopVenues(t,20),this.getGenreBreakdown(t)]),o=yield this.getActualAttendedEventsCount(t);console.log(" Actual attended events count:",o);const l=yield this.getActualUniqueVenuesCount(t);console.log(" Actual unique venues count:",l);const c=yield this.getActualInterestedEventsCount(t);console.log(" Actual interested events count:",c);const d=[{id:"concert_enthusiast",name:"Concert Enthusiast",description:"Attend 10+ events",icon:"",progress:o,goal:10,unlocked:o>=10,category:"events"},{id:"trusted_reviewer",name:"Trusted Reviewer",description:"Write 5+ reviews with 20+ total likes",icon:"",progress:n.review_count>=5&&n.total_likes>=20?1:0,goal:1,unlocked:n.review_count>=5&&n.total_likes>=20,category:"reviews"},{id:"genre_explorer",name:"Genre Explorer",description:"Review events from 5+ different genres",icon:"",progress:i.length,goal:5,unlocked:i.length>=5,category:"exploration"},{id:"local_expert",name:"Local Expert",description:"Attend events at 10+ different venues",icon:"",progress:l,goal:10,unlocked:l>=10,category:"exploration"},{id:"social_butterfly",name:"Social Butterfly",description:"Connect with 20+ friends",icon:"",progress:r.friends_count,goal:20,unlocked:r.friends_count>=20,category:"social"},{id:"super_fan",name:"Super Fan",description:"Follow 15+ artists",icon:"",progress:0,goal:15,unlocked:!1,category:"social"},{id:"review_master",name:"Review Master",description:"Write 25+ reviews",icon:"",progress:n.review_count,goal:25,unlocked:n.review_count>=25,category:"reviews"},{id:"influencer",name:"Influencer",description:"Get 100+ likes on your reviews",icon:"",progress:n.total_likes,goal:100,unlocked:n.total_likes>=100,category:"reviews"},{id:"early_bird",name:"Early Bird",description:"Mark interested in 50+ events",icon:"",progress:c,goal:50,unlocked:c>=50,category:"events"},{id:"ticket_hunter",name:"Ticket Hunter",description:"Click 100+ ticket links",icon:"",progress:r.ticket_clicks,goal:100,unlocked:r.ticket_clicks>=100,category:"events"}],f=yield this.getArtistFollowsCount(t),u=d.findIndex(h=>h.id==="super_fan");return u!==-1&&(d[u].progress=f||0,d[u].unlocked=(f||0)>=15),d}catch(r){return console.error("Error calculating achievements:",r),[]}})}static getActivityTimeline(t,r=30){return E(this,null,function*(){try{return console.log("Activity timeline not available yet - analytics tables not deployed"),[]}catch(n){return console.error("Error fetching activity timeline:",n),[]}})}static exportUserData(t){return E(this,null,function*(){try{const[r,n,a,i,o]=yield Promise.all([this.getUserStats(t,365),this.getTopArtists(t,20),this.getTopVenues(t,20),this.getReviewStats(t),this.getUserAchievements(t)]);let l=`Synth User Analytics Export
`;return l+=`Generated: ${new Date().toISOString()}

`,l+=`SUMMARY STATS (Last 365 days)
`,l+=`Metric,Value
`,l+=`Events Viewed,${r.events_viewed}
`,l+=`Events Clicked,${r.events_clicked}
`,l+=`Events Interested,${r.events_interested}
`,l+=`Events Attended,${r.events_attended}
`,l+=`Reviews Written,${r.reviews_written}
`,l+=`Ticket Clicks,${r.ticket_clicks}
`,l+=`Friends,${r.friends_count}

`,l+=`TOP ARTISTS
`,l+=`Artist,Interactions
`,n.forEach(c=>l+=`${c.artist_name},${c.interaction_count}
`),l+=`
`,l+=`TOP VENUES
`,l+=`Venue,City,State,Interactions
`,a.forEach(c=>l+=`${c.venue_name},${c.venue_city||""},${c.venue_state||""},${c.interaction_count}
`),l+=`
`,l+=`REVIEW STATS
`,l+=`Total Reviews,Average Rating,Total Likes,Total Comments
`,l+=`${i.review_count},${i.avg_rating.toFixed(2)},${i.total_likes},${i.total_comments}

`,l+=`ACHIEVEMENTS
`,l+=`Achievement,Progress,Goal,Unlocked
`,o.forEach(c=>l+=`${c.name},${c.progress},${c.goal},${c.unlocked}
`),l}catch(r){throw console.error("Error exporting user data:",r),r}})}static getArtistFollowsCount(t){return E(this,null,function*(){try{console.log(` Getting artist follows count for user: ${t}`);const{count:r,error:n}=yield T.from("artist_follows").select("*",{count:"exact",head:!0}).eq("user_id",t);console.log(` Count query result: count=${r}, error=`,n);const{data:a,error:i}=yield T.from("artist_follows").select("id, artist_id, user_id, created_at").eq("user_id",t);if(console.log(` Data query result: data.length=${(a==null?void 0:a.length)||0}, error=`,i),a&&a.length>0&&console.log(" First follow record:",a[0]),n)return console.error(" Artist follows count query error:",n),console.error(" Error details:",JSON.stringify(n,null,2)),!i&&a?(console.log(` Using data length as fallback: ${a.length}`),a.length):0;const o=r!=null?r:(a==null?void 0:a.length)||0;if(console.log(` Artist follows count: ${o} (count query: ${r}, data length: ${(a==null?void 0:a.length)||0})`),o>0&&a&&a.length>0){const l=a.map(c=>c.followed_entity_id).filter(Boolean);if(l.length>0){const{data:c,error:d}=yield T.from("artists").select("id, name").in("id",l);if(!d&&c){const f=c.map(u=>u.name||"Unknown Artist");console.log(` Followed artist names (${c.length}):`,f)}else d&&console.warn(" Could not fetch artist names:",d)}}return o}catch(r){return console.error(" Error getting artist follows count:",r),0}})}static getVenueFollowsCount(t){return E(this,null,function*(){try{console.log(` Getting venue follows count for user: ${t}`);const{count:r,data:n,error:a}=yield T.from("user_venue_relationships").select("*",{count:"exact"}).eq("user_id",t);if(a)return console.error(" Venue follows query error:",a),0;const i=r||(n==null?void 0:n.length)||0;if(console.log(` Venue follows count from user_venue_relationships table: ${i} (from count: ${r}, from data.length: ${n==null?void 0:n.length})`),i>0&&n&&n.length>0){const o=n.map(l=>l.venue_id).filter(Boolean);if(o.length>0){const l=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,c=o.filter(h=>l.test(String(h)));let d=[],f=null;if(c.length>0){const h=yield T.from("venues").select("name").in("id",c);d=h.data||[],f=h.error}const u=o.filter(h=>!l.test(String(h)));if(u.length>0&&!f){const{data:h,error:m}=yield T.from("venues").select("name").in("name",u);!m&&h&&(d=[...d,...h])}if(!f&&d&&d.length>0){const h=d.map(m=>m.name||"Unknown Venue");console.log(" Followed venue names:",h)}else{const h=o.map(m=>m);console.log(" Followed venue IDs/names (could not find in venues table):",h)}}}else console.log(` No venue follows found for user ${t}`);return i}catch(r){return console.error("Error getting venue follows count:",r),0}})}static hasPremium(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_subscriptions").select("subscription_tier, subscription_expires_at, status").eq("user_id",t).single();return n?(console.error("Error checking premium status:",n),!1):r?r.subscription_tier&&r.subscription_tier!=="free"&&r.status==="active"&&(!r.subscription_expires_at||new Date(r.subscription_expires_at)>new Date):!1}catch(r){return console.error("Error checking premium status:",r),!1}})}static trackSubscriptionChange(t,r,n,a){return E(this,null,function*(){try{const{trackInteraction:i}=yield Rr(()=>E(this,null,function*(){const{trackInteraction:o}=yield Promise.resolve().then(()=>Zy);return{trackInteraction:o}}),void 0,import.meta.url);yield i.profileUpdate("subscription_tier",t,{oldTier:r,newTier:n,changeType:a,revenueImpact:this.calculateRevenueImpact(r,n),timestamp:new Date().toISOString()})}catch(i){console.error("Error tracking subscription change:",i)}})}static calculateRevenueImpact(t,r){const n={free:0,premium:4.99,professional:9.99,enterprise:19.99},a=n[t]||0;return(n[r]||0)-a}static getSubscriptionAnalytics(t){return E(this,null,function*(){try{const{data:r}=yield T.from("user_subscriptions").select("subscription_tier, subscription_started_at, subscription_expires_at").eq("user_id",t).single(),{data:n}=yield T.from("interactions").select("*").eq("user_id",t).eq("event_type","profile_update").eq("entity_type","profile").contains("metadata",{field:"subscription_tier"}).order("occurred_at",{ascending:!0}),a=(n==null?void 0:n.map(o=>{const l=o.metadata;return{date:o.occurred_at,tier:(l==null?void 0:l.newTier)||"unknown",changeType:(l==null?void 0:l.changeType)||"unknown",revenueImpact:(l==null?void 0:l.revenueImpact)||0}}))||[],i=a.reduce((o,l)=>o+l.revenueImpact,0);return{currentTier:(r==null?void 0:r.subscription_tier)||"free",subscriptionStartDate:(r==null?void 0:r.subscription_started_at)||null,subscriptionExpiryDate:(r==null?void 0:r.subscription_expires_at)||null,totalRevenue:i,subscriptionHistory:a}}catch(r){return console.error("Error getting subscription analytics:",r),{currentTier:"free",totalRevenue:0,subscriptionHistory:[]}}})}}function Mge({open:e,onClose:t,user:r,isBlocked:n=!1,onBlockToggled:a}){const{toast:i}=Er(),[o,l]=y.useState(!1),[c,d]=y.useState(""),f=()=>E(this,null,function*(){l(!0);try{n?(yield Qu.unblockUser(r.id),i({title:"User Unblocked",description:`You can now see content from ${r.name}`})):(yield Qu.blockUser({blocked_user_id:r.id,block_reason:c.trim()||void 0}),i({title:"User Blocked",description:`You won't see content from ${r.name} anymore`})),a==null||a(),u()}catch(h){console.error("Error toggling block:",h),i({title:"Error",description:h instanceof Error?h.message:"Failed to update block status",variant:"destructive"})}finally{l(!1)}}),u=()=>{o||(d(""),t())};return s.jsx(vn,{open:e,onOpenChange:u,children:s.jsxs(hn,{className:"sm:max-w-[500px]",children:[s.jsxs(Hn,{children:[s.jsx(Sn,{className:"flex items-center gap-2",children:n?s.jsxs(s.Fragment,{children:[s.jsx(Qk,{className:"h-5 w-5 text-gray-600"}),"Unblock User"]}):s.jsxs(s.Fragment,{children:[s.jsx(H_,{className:"h-5 w-5 text-red-600"}),"Block User"]})}),s.jsx(ds,{children:n?"You will start seeing content from this user again":"You won't see content from this user anymore"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 flex items-center gap-3",children:[r.avatar_url?s.jsx("img",{src:r.avatar_url,alt:r.name,className:"w-12 h-12 rounded-full object-cover"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center",children:s.jsx("span",{className:"text-purple-600 font-semibold text-lg",children:r.name.charAt(0).toUpperCase()})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:r.name}),s.jsx("p",{className:"text-sm text-gray-600",children:n?"Currently blocked":"Will be blocked"})]})]}),!n&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"reason",children:"Reason for blocking (Optional, for your reference)"}),s.jsx(_s,{id:"reason",placeholder:"Why are you blocking this user?",value:c,onChange:h=>d(h.target.value),disabled:o,rows:3})]}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex gap-3",children:[s.jsx(df,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-yellow-900",children:[s.jsx("p",{className:"font-medium mb-1",children:"When you block someone:"}),s.jsxs("ul",{className:"text-xs space-y-1 list-disc list-inside",children:[s.jsx("li",{children:"You won't see their events, reviews, or comments"}),s.jsx("li",{children:"They won't be able to see your content"}),s.jsx("li",{children:"They won't be notified that you blocked them"}),s.jsx("li",{children:"You can unblock them at any time"})]})]})]})]}),n&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex gap-3",children:[s.jsx(df,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-900",children:[s.jsx("p",{className:"font-medium mb-1",children:"When you unblock someone:"}),s.jsxs("ul",{className:"text-xs space-y-1 list-disc list-inside",children:[s.jsx("li",{children:"You'll start seeing their content again"}),s.jsx("li",{children:"They'll be able to see your content"}),s.jsx("li",{children:"You can interact with each other normally"})]})]})]}),s.jsxs(Tf,{children:[s.jsx(ce,{type:"button",variant:"outline",onClick:u,disabled:o,children:"Cancel"}),s.jsx(ce,{onClick:f,variant:n?"default":"destructive",disabled:o,children:o?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-4 h-4 mr-2 animate-spin"}),n?"Unblocking...":"Blocking..."]}):s.jsx(s.Fragment,{children:n?s.jsxs(s.Fragment,{children:[s.jsx(Qk,{className:"w-4 h-4 mr-2"}),"Unblock User"]}):s.jsxs(s.Fragment,{children:[s.jsx(H_,{className:"w-4 h-4 mr-2"}),"Block User"]})})})]})]})})}function Dge({draftCount:e,onClick:t}){return e<=0?null:s.jsxs("button",{type:"button",onClick:t,className:"relative w-full overflow-hidden rounded-2xl shadow-md bg-gradient-to-br from-[#0e0e0e] via-[#1a1a1a] to-[#3b0b22] text-left focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 focus:ring-offset-background",children:[s.jsx("div",{className:"absolute inset-0 opacity-40 bg-[radial-gradient(circle_at_top,_rgba(255,51,153,0.85),_transparent_55%),_radial-gradient(circle_at_bottom,_rgba(186,104,200,0.8),_transparent_55%)]"}),s.jsxs("div",{className:"relative px-4 py-6 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium tracking-[0.18em] uppercase text-pink-200/90",children:"Drafts"}),s.jsxs("p",{className:"mt-1 text-2xl font-semibold text-white drop-shadow",children:[e," in progress"]}),s.jsx("p",{className:"mt-1 text-xs text-pink-100/90",children:"Tap to jump into your unreviewed shows and drafts."})]}),s.jsxs("div",{className:"ml-4 flex flex-col items-end gap-1 text-[11px] text-pink-100/80",children:[s.jsx("span",{className:"px-2 py-1 rounded-full bg-pink-500/30 border border-pink-300/40",children:"Keep the streak"}),s.jsx("span",{className:"px-2 py-1 rounded-full bg-white/10 border border-white/20",children:"Autosave on"})]})]})]})}const Ige="https://www.jambase.com/wp-content/uploads/2021/08/jambase-default-band-image-bw-1480x832.png",C7=JB;function Va(e){return e?e.includes("jambase-default-band-image-bw-1480x832.png")||e===Ige||e.includes("jambase.com/wp-content/uploads/2021/08/jambase-default-band-image-bw-1480x832.png")?C7:e:null}const W2=["/Generic Images/1.jpeg","/Generic Images/2.jpeg","/Generic Images/3.jpeg","/Generic Images/4.jpeg","/Generic Images/5.jpeg","/Generic Images/6.jpg","/Generic Images/7.jpg","/Generic Images/8.jpg","/Generic Images/9.webp","/Generic Images/10.jpeg","/Generic Images/11.jpeg","/Generic Images/12.jpeg","/Generic Images/13.jpeg","/Generic Images/14.jpeg","/Generic Images/15.jpeg","/Generic Images/16.jpg","/Generic Images/17.jpeg","/Generic Images/18.jpeg","/Generic Images/19.jpeg","/Generic Images/20.jpeg"],uS=W2.length;function $ge(e){let t=0;for(let r=0;r<e.length;r+=1)t=(t<<5)-t+e.charCodeAt(r),t|=0;return Math.abs(t)}function gA(e){if(uS===0)return C7;if(!e){const r=Math.floor(Math.random()*uS);return encodeURI(W2[r])}const t=$ge(e)%uS;return encodeURI(W2[t])}function d4({review:e,ratingValue:t,stars:r,onSelectReview:n,renderStars:a}){const i=e.event||{},o=e.jambase_events||{},l=i.artist_name||o.artist_name||i.artist_name_normalized||"Unknown Artist",c=i.venue_name||o.venue_name||i.venue_name_normalized||"Unknown Venue";let d;const f=e.Event_date||e.event_date;f&&(f instanceof Date?d=f.toISOString().split("T")[0]:typeof f=="string"&&(d=f)),d||(d=i.event_date||e.created_at);const u=(i==null?void 0:i.artist_id)||e.artist_id||(o==null?void 0:o.artist_id)||null,h=Array.isArray(e.photos)&&e.photos.length>0,m=h?e.photos[0]:void 0,[v,g]=y.useState(null);y.useEffect(()=>{!m&&u&&T.from("artists").select("image_url").eq("id",u).maybeSingle().then(({data:w,error:b})=>{!b&&(w!=null&&w.image_url)&&g(w.image_url)})},[m,u]);const x=`${e.id}-${l}-${c}-${d||""}`,_=m||v||gA(x);return s.jsxs("button",{type:"button",onClick:()=>n==null?void 0:n(e),className:"w-40 shrink-0 text-left overflow-hidden flex flex-col h-auto min-h-0",style:{backgroundColor:"var(--neutral-50)",border:"1px solid var(--neutral-200)",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)",transition:"all 0.2s ease"},onMouseEnter:w=>{w.currentTarget.style.boxShadow="0 4px 8px 0 var(--shadow-color)"},onMouseLeave:w=>{w.currentTarget.style.boxShadow="0 2px 4px 0 var(--shadow-color)"},children:[s.jsxs("div",{className:"relative h-20 w-full overflow-hidden shrink-0",children:[s.jsx("img",{src:_,alt:`${l} at ${c}`,className:`w-full h-full object-cover transition-transform duration-500 ${h?"":"scale-105"}`,loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 via-black/10 to-transparent","aria-hidden":"true"})]}),s.jsxs("div",{className:"px-3 py-2 space-y-1 flex flex-col flex-grow min-h-0",children:[s.jsx("div",{className:"h-8 min-h-[2rem] flex items-center",children:s.jsx("p",{className:"text-sm font-bold text-gray-900 break-words leading-tight line-clamp-2",children:l})}),s.jsx("p",{className:"text-xs text-gray-600 break-words leading-tight",children:c}),s.jsx("p",{className:"text-[11px] text-gray-400 leading-tight shrink-0",children:d?(()=>{const[w,b,N]=d.split("-").map(Number);return w&&b&&N?new Date(w,b-1,N).toLocaleDateString():d})():""}),t>0?s.jsxs("div",{className:"flex items-center justify-between mt-1 shrink-0",children:[a(t),s.jsxs("span",{className:"text-xs font-semibold text-gray-800",children:[Math.round(t*10)/10,""]})]}):s.jsx("div",{className:"mt-1 shrink-0",children:s.jsx("span",{className:"text-xs text-gray-500",children:"No rating"})})]})]},e.id)}function Lge({reviews:e,onSelectReview:t}){const r=y.useMemo(()=>{const o={1:[],2:[],3:[],4:[],5:[]},l=[];for(const f of e||[]){if(f.review_text==="ATTENDANCE_ONLY"&&!f.was_there)continue;const u=typeof f.category_average=="number"?f.category_average:f.category_average===null||f.category_average===void 0?null:typeof f.rating=="number"?f.rating:f.rating===null||f.rating===void 0?null:0;if(u==null){l.push(f);continue}if(!u||u<=0)continue;const h=Math.floor(u);h>=1&&h<=5&&o[h].push(f)}[5,4,3,2,1].forEach(f=>{const u=o[f]||[];o[f]=u.slice().sort((h,m)=>{var b,N;const v=S=>typeof(S==null?void 0:S.category_average)=="number"?S.category_average:typeof(S==null?void 0:S.rating)=="number"?S.rating:f,g=v(h),x=v(m);if(x!==g)return x-g;const _=(h==null?void 0:h.Event_date)||(h==null?void 0:h.event_date)||((b=h==null?void 0:h.event)==null?void 0:b.event_date)||(h==null?void 0:h.created_at),w=(m==null?void 0:m.Event_date)||(m==null?void 0:m.event_date)||((N=m==null?void 0:m.event)==null?void 0:N.event_date)||(m==null?void 0:m.created_at);return new Date(w).getTime()-new Date(_).getTime()})});const d=l.slice().sort((f,u)=>{var v,g;const h=(f==null?void 0:f.Event_date)||(f==null?void 0:f.event_date)||((v=f==null?void 0:f.event)==null?void 0:v.event_date)||(f==null?void 0:f.created_at),m=(u==null?void 0:u.Event_date)||(u==null?void 0:u.event_date)||((g=u==null?void 0:u.event)==null?void 0:g.event_date)||(u==null?void 0:u.created_at);return new Date(m).getTime()-new Date(h).getTime()});return{buckets:o,unrated:d}},[e]),n=o=>{const l=Math.floor(o*2)/2;return s.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5},(c,d)=>{const f=d+1,u=l>=f,h=!u&&l>=f-.5;return s.jsxs("div",{className:"relative w-3 h-3",children:[s.jsx(Xt,{className:`w-3 h-3 ${u?"text-yellow-400 fill-yellow-400":"text-gray-300"}`}),h&&s.jsx("div",{className:"absolute inset-0 overflow-hidden",style:{width:"50%"},children:s.jsx(Xt,{className:"w-3 h-3 text-yellow-400 fill-yellow-400"})})]},d)})})},a=[{stars:5,label:"5 Star Reviews"},{stars:4,label:"4 Star Reviews"},{stars:3,label:"3 Star Reviews"},{stars:2,label:"2 Star Reviews"},{stars:1,label:"1 Star Reviews"}];return a.some(({stars:o})=>r.buckets[o].length>0)||r.unrated.length>0?s.jsxs("div",{className:"space-y-6 mb-8",children:[a.map(({stars:o,label:l})=>{const c=r.buckets[o];return!c||c.length===0?null:s.jsxs("section",{className:"space-y-2",children:[s.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:[l," ",s.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",c.length,")"]})]}),s.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:c.map(d=>{const f=typeof d.category_average=="number"?d.category_average:typeof d.rating=="number"?d.rating:o;return s.jsx(d4,{review:d,ratingValue:f,stars:o,onSelectReview:t,renderStars:n},d.id)})})]},o)}),r.unrated.length>0&&s.jsxs("section",{className:"space-y-2",children:[s.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:["Unrated Reviews ",s.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",r.unrated.length,")"]})]}),s.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:r.unrated.map(o=>s.jsx(d4,{review:o,ratingValue:0,stars:0,onSelectReview:t,renderStars:n},o.id))})]})]}):null}class Bo{static getPassportProgress(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("passport_entries").select("*").eq("user_id",t).order("unlocked_at",{ascending:!1});if(n)throw n;const a=r||[];return{cities:a.filter(i=>i.type==="city"),venues:a.filter(i=>i.type==="venue"),artists:a.filter(i=>i.type==="artist"),scenes:a.filter(i=>i.type==="scene"),totalCount:a.length}}catch(r){return console.error("Error fetching passport progress:",r),{cities:[],venues:[],artists:[],scenes:[],totalCount:0}}})}static unlockPassportEntry(t,r,n,a,i,o){return E(this,null,function*(){try{const{data:l,error:c}=yield T.from("passport_entries").insert({user_id:t,type:r,entity_id:n,entity_uuid:i||null,entity_name:a,metadata:o||{}}).select().single();if(c){if(c.code==="23505"){let d=T.from("passport_entries").select("*").eq("user_id",t).eq("type",r);if(i)d=d.eq("entity_uuid",i);else if(n)d=d.eq("entity_id",n);else return console.warn("PassportService: Cannot fetch duplicate entry - both entityUuid and entityId are null"),null;const{data:f,error:u}=yield d.single();return u?(console.warn("PassportService: Error fetching duplicate entry:",u),null):f}throw c}return l}catch(l){return console.error("Error unlocking passport entry:",l),null}})}static getCitiesVisited(t){return E(this,null,function*(){try{const{count:r}=yield T.from("passport_entries").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("type","city");return r||0}catch(r){return console.error("Error counting cities:",r),0}})}static getIconicVenuesUnlocked(t){return E(this,null,function*(){try{const{count:r}=yield T.from("passport_entries").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("type","venue");return r||0}catch(r){return console.error("Error counting venues:",r),0}})}static getArtistMilestones(t){return E(this,null,function*(){try{const{count:r}=yield T.from("passport_entries").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("type","artist");return r||0}catch(r){return console.error("Error counting artists:",r),0}})}static getSceneParticipation(t){return E(this,null,function*(){try{const{count:r}=yield T.from("passport_entries").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("type","scene");return r||0}catch(r){return console.error("Error counting scenes:",r),0}})}static getNextToUnlock(t){return E(this,null,function*(){var r;try{const n=[],a=yield this.getPassportProgress(t),{data:i}=yield T.from("users").select("location_city, location_state").eq("user_id",t).single();if(i!=null&&i.location_city){const l=new Set(a.cities.map(d=>{var f;return(f=d.entity_id)==null?void 0:f.toLowerCase()})),c=`${i.location_city.toLowerCase()}_${(i.location_state||"").toLowerCase()}`;l.has(c)||n.push({type:"city",entity_name:i.location_city,hint:`Review an event in ${i.location_city} to unlock this city`,progress:a.cities.length,goal:a.cities.length+1})}const{data:o}=yield T.from("events").select("artist_id, artists!inner(name)").gte("event_date",new Date().toISOString()).not("artist_id","is",null).limit(10);if(o&&o.length>0){const l=new Set(a.artists.map(d=>d.entity_id)),c=o.find(d=>{var u;const f=d.artist_id||((u=d.artists)==null?void 0:u.id);return f&&!l.has(f)});if(c){const d=((r=c.artists)==null?void 0:r.name)||"Unknown Artist";n.push({type:"artist",entity_name:d,hint:`Attend a show by ${d} to unlock this artist`,progress:a.artists.length,goal:a.artists.length+1})}}return n.slice(0,3)}catch(n){return console.error("Error getting next to unlock:",n),[]}})}static getPassportIdentity(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("passport_identity").select("*, home_scene:scenes(*)").eq("user_id",t).single();if(n&&n.code!=="PGRST116")throw n;return r}catch(r){return console.error("Error fetching passport identity:",r),null}})}static getStampsByRarity(t,r){return E(this,null,function*(){try{let n=T.from("passport_entries").select("*").eq("user_id",t).order("unlocked_at",{ascending:!1});r&&(n=n.eq("rarity",r));const{data:a,error:i}=yield n;if(i)throw i;return a||[]}catch(n){return console.error("Error fetching stamps by rarity:",n),[]}})}static getTimeline(t,r=20){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("passport_timeline").select("*, review:reviews(*)").eq("user_id",t).order("created_at",{ascending:!1}).limit(r);if(a)throw a;return n||[]}catch(n){return console.error("Error fetching timeline:",n),[]}})}static pinTimelineEvent(t,r){return E(this,null,function*(){try{const{count:n}=yield T.from("passport_timeline").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_pinned",!0);if(n&&n>=5)throw new Error("Maximum of 5 pinned timeline items allowed");const{data:a,error:i}=yield T.from("passport_timeline").upsert({user_id:t,review_id:r,is_pinned:!0,updated_at:new Date().toISOString()},{onConflict:"user_id,review_id"}).select().single();if(i)throw i;return a}catch(n){throw console.error("Error pinning timeline event:",n),n}})}static unpinTimelineEvent(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("passport_timeline").update({is_pinned:!1}).eq("id",r).eq("user_id",t);if(n)throw n}catch(n){throw console.error("Error unpinning timeline event:",n),n}})}static addTimelineMilestone(t,r,n,a){return E(this,null,function*(){var i,o,l,c;try{const{data:d,error:f}=yield T.from("reviews").select(`
          id,
          event_id,
          artist_id,
          venue_id,
          events:event_id (
            artist_id,
            venue_id
          )
        `).eq("id",r).eq("user_id",t).single();if(f||!d)throw new Error("Review not found");const u=((i=d.events)==null?void 0:i.artist_id)||d.artist_id,h=((o=d.events)==null?void 0:o.venue_id)||d.venue_id;let m=null;if(u||h){const[x,_]=yield Promise.all([u?T.from("artists").select("name").eq("id",u).single():Promise.resolve({data:null}),h?T.from("venues").select("name").eq("id",h).single():Promise.resolve({data:null})]),w=(l=x.data)==null?void 0:l.name,b=(c=_.data)==null?void 0:c.name;w&&b?m=`${w} @ ${b}`:w?m=w:b&&(m=b)}const{data:v,error:g}=yield T.from("passport_timeline").upsert({user_id:t,review_id:r,significance:n,description:a||null,Event_name:m,is_auto_selected:!1,updated_at:new Date().toISOString()},{onConflict:"user_id,review_id"}).select().single();if(g)throw g;return v}catch(d){throw console.error("Error adding timeline milestone:",d),d}})}static updateTimelineMilestone(t,r,n,a){return E(this,null,function*(){try{const{data:i,error:o}=yield T.from("passport_timeline").update({significance:n,description:a!==void 0?a:null,updated_at:new Date().toISOString()}).eq("id",r).eq("user_id",t).select().single();if(o)throw o;return i}catch(i){throw console.error("Error updating timeline milestone:",i),i}})}static deleteTimelineEntry(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("passport_timeline").delete().eq("id",r).eq("user_id",t);if(n)throw n}catch(n){throw console.error("Error deleting timeline entry:",n),n}})}static getUserReviewsForTimeline(t,r=100){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select(`
          id,
          rating,
          review_text,
          created_at,
          event_id,
          artist_id,
          venue_id,
          "Event_date"
        `).eq("user_id",t).eq("is_draft",!1).order("created_at",{ascending:!1}).limit(r);if(a)throw a;return n?yield Promise.all(n.map(o=>E(this,null,function*(){let l=null,c=null,d=null,f=null;if(o.event_id){const{data:h}=yield T.from("events").select("artist_uuid, venue_uuid").eq("id",o.event_id).single();d=(h==null?void 0:h.artist_uuid)||o.artist_id,f=(h==null?void 0:h.venue_uuid)||o.venue_id}else d=o.artist_id,f=o.venue_id;if(d){const{data:h}=yield T.from("artists").select("name").eq("id",d).single();l=(h==null?void 0:h.name)||null}if(f){const{data:h}=yield T.from("venues").select("name").eq("id",f).single();c=(h==null?void 0:h.name)||null}const u=l&&c?`${l} @ ${c}`:l||c||"Event";return V(D({},o),{event:{id:o.event_id||null,title:u,artist_name:l,venue_name:c,event_date:o.Event_date||o.created_at}})}))):[]}catch(n){return console.error("Error fetching user reviews for timeline:",n),[]}})}static getTasteMap(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("passport_taste_map").select("*").eq("user_id",t).maybeSingle();if(n&&n.code!=="PGRST116")throw n;return r}catch(r){return console.error("Error fetching taste map:",r),null}})}static calculateAndUpdateIdentity(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("recalculate_passport_data",{p_user_id:t});if(r)throw r;return!0}catch(r){return console.error("Error recalculating passport identity:",r),!1}})}}class Ax{static getFanType(t){return E(this,null,function*(){try{const r=yield this.getIdentity(t);if(r!=null&&r.fan_type)return r.fan_type;yield this.calculateIdentity(t);const n=yield this.getIdentity(t);return(n==null?void 0:n.fan_type)||null}catch(r){return console.error("Error getting fan type:",r),null}})}static getHomeScene(t){return E(this,null,function*(){try{const r=yield this.getIdentity(t);return(r==null?void 0:r.home_scene)||null}catch(r){return console.error("Error getting home scene:",r),null}})}static getJoinYear(t){return E(this,null,function*(){try{const r=yield this.getIdentity(t);return(r==null?void 0:r.join_year)||null}catch(r){return console.error("Error getting join year:",r),null}})}static getIdentity(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("passport_identity").select("*").eq("user_id",t).single();if(n&&n.code!=="PGRST116")throw n;if(!r)return null;const{data:a,error:i}=yield T.from("users").select("location_city").eq("user_id",t).single();return i&&console.error("Error fetching user location_city:",i),V(D({},r),{home_scene:null,home_city:(a==null?void 0:a.location_city)||null})}catch(r){return console.error("Error fetching passport identity:",r),null}})}static calculateIdentity(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("update_passport_identity",{p_user_id:t});if(r)throw r;return!0}catch(r){return console.error("Error calculating identity:",r),!1}})}static calculateHomeScene(t){return E(this,null,function*(){return!0})}static getFanTypeDisplay(t){return{jam_chaser:{name:"Jam Chaser",description:"High artist loyalty, following favorite acts across multiple shows"},venue_purist:{name:"Venue Purist",description:"Prefers returning to favorite venues, values consistency and atmosphere"},scene_builder:{name:"Scene Builder",description:"Active participant across multiple music scenes, connects communities"},road_tripper:{name:"Road Tripper",description:"Explores diverse cities and regions, music is a journey"},genre_explorer:{name:"Genre Explorer",description:"Diverse musical tastes, always discovering new sounds"},festival_fanatic:{name:"Festival Fanatic",description:"Loves the festival experience, thrives on variety and community"}}[t||""]||{name:"Music Fan",description:"Building your live music journey"}}}function xw(r){var n=r,{className:e}=n,t=ge(n,["className"]);return s.jsx("div",D({className:Oe("animate-pulse rounded-md bg-muted",e)},t))}const Fge=()=>ya.divIcon({className:"travel-tracker-marker",html:`<div style="
      background-color: #FF3399;
      color: white;
      border: 3px solid white;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    "></div>`,iconSize:[32,32],iconAnchor:[16,32]}),zge=({reviews:e})=>{const t=Rf();return y.useEffect(()=>{if(e.length!==0)try{const r=ya.latLngBounds(e.map(n=>[n.latitude,n.longitude]));r.isValid()&&t.fitBounds(r,{padding:[50,50]})}catch(r){console.error("Error fitting map bounds:",r)}},[t,e]),null},Bge=({userId:e})=>{var f,u,h,m;const[t,r]=y.useState([]),[n,a]=y.useState(!0),[i,o]=y.useState(null),[l,c]=y.useState([39.8283,-98.5795]);y.useEffect(()=>{d()},[e]);const d=()=>E(void 0,null,function*(){a(!0);try{const{data:v,error:g}=yield T.from("reviews").select(`
          id,
          event_id,
          venue_id,
          rating,
          review_text,
          created_at,
          Event_date,
          photos,
          mood_tags,
          genre_tags,
          venues:venue_id (
            id,
            name,
            latitude,
            longitude,
            state,
            street_address
          )
        `).eq("user_id",e).eq("is_draft",!1).not("venue_id","is",null).order("Event_date",{ascending:!1});if(g)throw g;const x=(v||[]).map(_=>{const w=Array.isArray(_.venues)?_.venues[0]:_.venues;if(!w)return null;const b=w.latitude?Number(w.latitude):null,N=w.longitude?Number(w.longitude):null;return b&&N&&!isNaN(b)&&!isNaN(N)&&b>=-90&&b<=90&&N>=-180&&N<=180?{id:_.id,event_id:_.event_id,venue_id:_.venue_id,rating:_.rating,review_text:_.review_text,created_at:_.created_at,Event_date:_.Event_date||_.created_at,venue_name:w.name||null,artist_name:null,event_title:null,latitude:b,longitude:N,venue_city:null,venue_state:w.state||null,photos:_.photos||null,mood_tags:_.mood_tags||null,genre_tags:_.genre_tags||null}:null}).filter(_=>_!==null);if(r(x),x.length>0){const _=x.reduce((b,N)=>b+N.latitude,0)/x.length,w=x.reduce((b,N)=>b+N.longitude,0)/x.length;c([_,w])}}catch(v){console.error("Error loading travel data:",v)}finally{a(!1)}});return n?s.jsxs("div",{style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:"var(--spacing-small, 12px)",paddingBottom:"var(--spacing-small, 12px)"},children:[s.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:"var(--spacing-small, 12px)"},children:[s.jsx(yr,{size:24,style:{color:"var(--brand-pink-500)"}}),s.jsx("h2",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)",margin:0},children:"Travel Tracker"})]}),s.jsx(xw,{className:"h-96 w-full",style:{borderRadius:"var(--radius-corner, 10px)"}})]}):t.length===0?s.jsxs("div",{style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:"var(--spacing-small, 12px)",paddingBottom:"var(--spacing-small, 12px)"},children:[s.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:"var(--spacing-small, 12px)"},children:[s.jsx(yr,{size:24,style:{color:"var(--brand-pink-500)"}}),s.jsx("h2",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)",margin:0},children:"Travel Tracker"})]}),s.jsxs("div",{className:"flex flex-col items-center justify-center",style:{gap:"var(--spacing-inline, 6px)",paddingTop:"var(--spacing-big-section, 60px)",paddingBottom:"var(--spacing-big-section, 60px)"},children:[s.jsx(yr,{size:60,style:{color:"var(--neutral-600)"}}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No shows tracked yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Start reviewing shows to see your travel map!"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:"var(--spacing-small, 12px)",paddingBottom:"var(--spacing-small, 12px)"},children:[s.jsxs("div",{className:"flex items-center justify-between",style:{marginBottom:"var(--spacing-small, 12px)"},children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(yr,{size:24,style:{color:"var(--brand-pink-500)"}}),s.jsx("h2",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)",margin:0},children:"Travel Tracker"})]}),s.jsxs(et,{variant:"secondary",style:{backgroundColor:"var(--neutral-100)",color:"var(--neutral-900)",border:"1px solid var(--neutral-200)"},children:[t.length," ",t.length===1?"show":"shows"]})]}),s.jsx("div",{children:s.jsx("div",{className:"h-96 rounded-lg overflow-hidden border relative z-0",children:s.jsxs(a0,{center:l,zoom:4,style:{height:"100%",width:"100%",zIndex:0},children:[s.jsx(i0,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(zge,{reviews:t}),t.map(v=>s.jsx(gf,{position:[v.latitude,v.longitude],icon:Fge(),eventHandlers:{click:()=>{o(v)}},children:s.jsx(lU,{maxWidth:300,children:s.jsxs("div",{className:"p-2",children:[s.jsx("div",{className:"font-semibold text-sm mb-1",children:v.venue_name||"Show"}),v.venue_state&&s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:v.venue_state}),s.jsx("div",{className:"text-xs text-gray-500 mb-2",children:Rt(new Date(v.Event_date),"MMM d, yyyy")}),v.rating&&s.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[s.jsx(Xt,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"}),s.jsx("span",{children:v.rating.toFixed(1)})]}),s.jsx("button",{onClick:()=>o(v),className:"mt-2 text-xs text-synth-pink hover:underline",children:"View Review "})]})})},v.id))]})})})]}),s.jsx(vn,{open:!!i,onOpenChange:()=>o(null),children:s.jsx(hn,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:i&&s.jsxs(s.Fragment,{children:[s.jsx(Hn,{children:s.jsxs(Sn,{className:"flex items-center gap-2",children:[s.jsx(Ft,{className:"w-5 h-5 text-synth-pink"}),i.venue_name||"Show Review"]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[i.venue_name&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(yr,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{className:"font-medium",children:i.venue_name}),i.venue_state&&s.jsx("span",{className:"text-muted-foreground",children:i.venue_state})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Lt,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{children:Rt(new Date(i.Event_date),"MMMM d, yyyy")})]}),i.rating&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"w-5 h-5 fill-yellow-400 text-yellow-400"}),s.jsx("span",{className:"text-lg font-semibold",children:i.rating.toFixed(1)})]})]}),i.review_text&&s.jsx("div",{className:"pt-2 border-t",children:s.jsx("p",{className:"text-sm whitespace-pre-wrap",children:i.review_text})}),(((f=i.mood_tags)==null?void 0:f.length)||((u=i.genre_tags)==null?void 0:u.length))&&s.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t",children:[(h=i.mood_tags)==null?void 0:h.map((v,g)=>s.jsx(et,{variant:"secondary",className:"text-xs",children:v},`mood-${g}`)),(m=i.genre_tags)==null?void 0:m.map((v,g)=>s.jsx(et,{variant:"outline",className:"text-xs",children:v},`genre-${g}`))]}),i.photos&&i.photos.length>0&&s.jsx("div",{className:"pt-2 border-t",children:s.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.photos.slice(0,4).map((v,g)=>s.jsx("img",{src:v,alt:`Review photo ${g+1}`,className:"w-full h-32 object-cover rounded-lg"},g))})})]})]})})})]})},P7=({userId:e,userName:t})=>{const[r,n]=y.useState(null),[a,i]=y.useState(!0);y.useEffect(()=>{o()},[e]);const o=()=>E(void 0,null,function*(){i(!0);try{let c=yield Ax.getIdentity(e);c||(yield Ax.calculateIdentity(e),c=yield Ax.getIdentity(e)),n(c)}catch(c){console.error("Error loading passport identity:",c)}finally{i(!1)}});if(a)return s.jsxs("div",{className:"space-y-4",children:[s.jsx(xw,{className:"h-32 w-full"}),s.jsx(xw,{className:"h-24 w-full"})]});if(!r)return s.jsx(Ze,{children:s.jsx(tt,{className:"p-6 text-center text-muted-foreground",children:s.jsx("p",{children:"Identity calculation in progress..."})})});const l=Ax.getFanTypeDisplay(r.fan_type);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs(Ze,{className:"border-2 border-synth-pink/20 bg-gradient-to-br from-white to-pink-50/30",children:[s.jsx(kr,{children:s.jsxs(Lr,{className:"text-2xl font-bold flex items-center gap-2",children:[s.jsx(Ft,{className:"w-6 h-6 text-synth-pink"}),t?`${t}'s`:"Your"," Passport"]})}),s.jsxs(tt,{children:[s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-small, 12px)"},children:[s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",width:"fit-content"},children:l.name}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0},children:l.description})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-small, 12px)",marginTop:"var(--spacing-small, 12px)"},children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Lt,{className:"w-4 h-4 text-muted-foreground"}),s.jsxs("span",{className:"font-medium",children:["Live since ",r.join_year]})]}),r.home_city&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(yr,{className:"w-4 h-4 text-muted-foreground"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"font-medium",children:"Home Scene: "}),s.jsx("span",{className:"text-muted-foreground",children:r.home_city})]})]}),!r.home_city&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(yr,{className:"w-4 h-4"}),s.jsx("span",{children:"No location set"})]})]})]})]}),s.jsx(Bge,{userId:e})]})},Uge=e=>{switch(e){case"legendary":return{border:"border-purple-400",bg:"bg-gradient-to-br from-purple-50/90 to-pink-50/90",badge:"bg-purple-100 text-purple-800 border-purple-300",icon:s.jsx(Re,{name:"ribbonAward",size:16})};case"uncommon":return{border:"border-blue-400",bg:"bg-gradient-to-br from-blue-50/90 to-cyan-50/90",badge:"bg-blue-100 text-blue-800 border-blue-300",icon:s.jsx(Re,{name:"mediumShootingStar",size:16})};default:return{border:"border-yellow-300",bg:"bg-gradient-to-br from-yellow-50/80 to-amber-50/80",badge:"bg-yellow-100 text-yellow-800 border-yellow-300",icon:s.jsx(Re,{name:"check",size:16})}}},qge=({entry:e,onClick:t,className:r,showProgress:n=!1,progress:a,goal:i})=>{var u;y.useState(!1);const o=!!e.unlocked_at,l=a&&i?Math.min(a/i*100,100):0,c=Uge(e.rarity),d=()=>{if(!e.metadata)return null;if(e.type==="festival"&&e.metadata.years_attended){const h=e.metadata.years_attended;return s.jsxs("p",{className:"text-xs text-muted-foreground mb-1",children:["Attended ",h.length," ",h.length===1?"time":"times"," (",h.join(", "),")"]})}return e.type==="artist_milestone"&&e.metadata.show_count?s.jsxs("p",{className:"text-xs text-muted-foreground mb-1",children:[e.metadata.show_count," shows",e.metadata.year_span>=3&&`  ${e.metadata.year_span} years`]}):e.type==="era"&&e.metadata.event_count?s.jsxs("p",{className:"text-xs text-muted-foreground mb-1",children:[e.metadata.event_count," events  ",e.metadata.year_span," years"]}):null},f=s.jsxs(Ze,{className:Oe("cursor-pointer transition-all hover:shadow-md relative overflow-hidden",o?`border-2 ${c.border} ${c.bg}`:"border-gray-200 bg-gray-50 opacity-75",r),onClick:t,children:[s.jsxs(tt,{className:"p-4",children:[s.jsx("div",{className:"flex items-start justify-between mb-2",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[s.jsx("h4",{className:"font-semibold text-sm",children:e.entity_name}),o&&e.rarity&&s.jsxs(et,{variant:"outline",className:Oe("text-xs",c.badge),children:[c.icon,s.jsx("span",{className:"ml-1 capitalize",children:e.rarity})]}),o&&!e.rarity&&s.jsxs(et,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 text-xs",children:[s.jsx(Re,{name:"check",size:16,className:"mr-1"}),"Unlocked"]}),!o&&s.jsx(Re,{name:"lock",size:16,color:"var(--neutral-400)"})]}),d(),((u=e.metadata)==null?void 0:u.description)&&s.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:e.metadata.description}),o&&e.unlocked_at&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Unlocked ",Rt(new Date(e.unlocked_at),"MMM d, yyyy")]})]})}),n&&!o&&a!==void 0&&i!==void 0&&s.jsxs("div",{className:"mt-3 space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-muted-foreground",children:"Progress"}),s.jsxs("span",{className:"font-semibold",children:[a,"/",i]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:s.jsx("div",{className:"bg-synth-pink h-1.5 rounded-full transition-all",style:{width:`${l}%`}})})]})]}),o&&s.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[s.jsx("div",{className:Oe("absolute top-0 left-0 w-8 h-8 border-t-2 border-l-2 rounded-tl-lg",c.border)}),s.jsx("div",{className:Oe("absolute top-0 right-0 w-8 h-8 border-t-2 border-r-2 rounded-tr-lg",c.border)}),s.jsx("div",{className:Oe("absolute bottom-0 left-0 w-8 h-8 border-b-2 border-l-2 rounded-bl-lg",c.border)}),s.jsx("div",{className:Oe("absolute bottom-0 right-0 w-8 h-8 border-b-2 border-r-2 rounded-br-lg",c.border)})]})]});return e.cultural_context&&o?s.jsx(QP,{children:s.jsxs(Gz,{children:[s.jsx(Yz,{asChild:!0,children:f}),s.jsx(eT,{className:"max-w-xs",children:s.jsx("p",{className:"text-sm",children:e.cultural_context})})]})}):f},T7=({stamps:e,achievements:t=[],loading:r=!1})=>{var h,m,v,g;const[n,a]=y.useState("all"),[i,o]=y.useState("all"),l=e.reduce((x,_)=>(x[_.type]||(x[_.type]=[]),x[_.type].push(_),x),{}),c=t.filter(x=>x.unlocked),d=e.filter(x=>!(n!=="all"&&x.type!==n||i!=="all"&&x.rarity!==i)),f={all:e.length,city:((h=l.city)==null?void 0:h.length)||0,venue:((m=l.venue)==null?void 0:m.length)||0,artist:((v=l.artist)==null?void 0:v.length)||0,scene:((g=l.scene)==null?void 0:g.length)||0,completed_achievements:c.length},u={all:e.length,common:e.filter(x=>x.rarity==="common").length,uncommon:e.filter(x=>x.rarity==="uncommon").length,legendary:e.filter(x=>x.rarity==="legendary").length};return r?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading stamps..."}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsxs(aa,{value:n,onValueChange:a,children:[s.jsx(Gs,{className:"w-[180px] bg-white",children:s.jsx(ia,{placeholder:"Filter by type"})}),s.jsxs(Ys,{className:"bg-white",children:[s.jsxs(Bt,{value:"all",children:["All Types (",f.all,")"]}),s.jsxs(Bt,{value:"city",children:["Cities (",f.city,")"]}),s.jsxs(Bt,{value:"venue",children:["Venues (",f.venue,")"]}),s.jsxs(Bt,{value:"artist",children:["Artists (",f.artist,")"]}),s.jsxs(Bt,{value:"scene",children:["Scenes (",f.scene,")"]}),s.jsxs(Bt,{value:"completed_achievements",children:["Completed Achievements (",f.completed_achievements,")"]})]})]}),n!=="completed_achievements"&&s.jsxs(aa,{value:i,onValueChange:o,children:[s.jsx(Gs,{className:"w-[180px] bg-white",children:s.jsx(ia,{placeholder:"Filter by rarity"})}),s.jsxs(Ys,{className:"bg-white",children:[s.jsxs(Bt,{value:"all",children:["All Rarities (",u.all,")"]}),s.jsxs(Bt,{value:"common",children:["Common (",u.common,")"]}),s.jsxs(Bt,{value:"uncommon",children:["Uncommon (",u.uncommon,")"]}),s.jsxs(Bt,{value:"legendary",children:["Legendary (",u.legendary,")"]})]})]})]}),n==="completed_achievements"?c.length===0?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:s.jsx("p",{children:"No completed achievements yet."})}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(x=>{const _={gold:"border-yellow-200 bg-yellow-50",silver:"border-gray-200 bg-gray-50",bronze:"border-orange-200 bg-orange-50"};return s.jsx(Ze,{className:`border-2 ${_[x.tier||"bronze"]}`,children:s.jsx(tt,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"text-3xl",children:x.icon}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h4",{className:"font-semibold",children:x.name.replace(/\s+\([^)]+\)$/,"")}),s.jsx(Mc,{className:"w-4 h-4 text-muted-foreground"})]}),s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:x.description}),x.unlocked_at&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Unlocked ",new Date(x.unlocked_at).toLocaleDateString()]})]})]})})},x.id||x.type)})}):d.length===0?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:s.jsx("p",{children:"No stamps found with selected filters."})}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(x=>s.jsx(qge,{entry:x},x.id))})]})},u4=({isOpen:e,onClose:t,userId:r,existingReviewId:n,existingSignificance:a,existingDescription:i,onSuccess:o})=>{var I,O,z,M,B;const[l,c]=y.useState([]),[d,f]=y.useState(n||""),[u,h]=y.useState("best_setlist"),[m,v]=y.useState(a||""),[g,x]=y.useState(""),[_,w]=y.useState(!1),[b,N]=y.useState(!1),{toast:S}=Er();y.useEffect(()=>{if(e&&(k(),n)){f(n);const F=a||"";F.toLowerCase().includes("best setlist")?(h("best_setlist"),v(i||"")):F.toLowerCase().includes("first time seeing")?(h("first_favorite_artist"),v(i||"")):F.toLowerCase().includes("first time at")?(h("first_favorite_venue"),v(i||"")):(h("custom"),x(F||""),v(i||""))}},[e,n,a,i]);const k=()=>E(void 0,null,function*(){N(!0);try{const F=yield Bo.getUserReviewsForTimeline(r,100);c(F)}catch(F){console.error("Error loading reviews:",F),S({title:"Error",description:"Failed to load reviews",variant:"destructive"})}finally{N(!1)}}),C=()=>E(void 0,null,function*(){var K,Z;if(!n&&!d){S({title:"Selection required",description:"Please select a review",variant:"destructive"});return}const F=n||d;if(!F)return;const U=l.find(ne=>ne.id===F);let H="",q=null;if(u==="best_setlist")H="Best setlist",q=m.trim()||null;else if(u==="first_favorite_artist")H="First time seeing "+(((K=U==null?void 0:U.event)==null?void 0:K.artist_name)||"this artist"),q=m.trim()||null;else if(u==="first_favorite_venue")H="First time at "+(((Z=U==null?void 0:U.event)==null?void 0:Z.venue_name)||"this venue"),q=m.trim()||null;else if(u==="custom"){if(!g.trim()){S({title:"Milestone name required",description:"Please name your custom milestone",variant:"destructive"});return}H=g.trim(),q=m.trim()||null}w(!0);try{if(n){const Y=(yield Bo.getTimeline(r,1e3)).find(X=>X.review_id===n);if(!Y)throw new Error("Timeline entry not found");yield Bo.updateTimelineMilestone(r,Y.id,H,q)}else yield Bo.addTimelineMilestone(r,d,H,q);S({title:"Success",description:"Timeline milestone added successfully"}),o(),A()}catch(ne){console.error("Error saving timeline milestone:",ne),S({title:"Error",description:"Failed to save timeline milestone",variant:"destructive"})}finally{w(!1)}}),A=()=>{_||(f(""),h("best_setlist"),v(""),x(""),t())},R=l.find(F=>F.id===d);return s.jsx(vn,{open:e,onOpenChange:F=>{!F&&!_&&A()},children:s.jsxs(hn,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Hn,{children:[s.jsx(Sn,{children:n?"Edit Timeline Milestone":"Add Timeline Milestone"}),s.jsx(ds,{children:"Mark a special moment in your music journey. Choose a review and tell us why it's significant."})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[!n&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"review",children:"Select Review"}),b?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(fr,{className:"h-6 w-6 animate-spin text-synth-pink"})}):s.jsxs(aa,{value:d,onValueChange:f,children:[s.jsx(Gs,{id:"review",children:s.jsx(ia,{placeholder:"Choose a review..."})}),s.jsx(Ys,{className:"z-[10000] bg-white",children:l.map(F=>{var U,H,q;return s.jsx(Bt,{value:F.id,children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("span",{className:"font-medium",children:[((U=F.event)==null?void 0:U.artist_name)||"Unknown Artist"," @ ",((H=F.event)==null?void 0:H.venue_name)||"Unknown Venue"]}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:[(q=F.event)!=null&&q.event_date?Rt(new Date(F.event.event_date),"MMM d, yyyy"):Rt(new Date(F.created_at),"MMM d, yyyy"),F.rating&&`  ${F.rating.toFixed(1)}`]})]})},F.id)})})]}),R&&s.jsxs("div",{className:"mt-2 p-3 bg-muted rounded-lg",children:[s.jsxs("div",{className:"text-sm font-medium",children:[(I=R.event)==null?void 0:I.artist_name," @ ",(O=R.event)==null?void 0:O.venue_name]}),s.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:(z=R.event)!=null&&z.event_date?Rt(new Date(R.event.event_date),"MMM d, yyyy"):Rt(new Date(R.created_at),"MMM d, yyyy")}),R.review_text&&s.jsx("div",{className:"text-sm mt-2 line-clamp-2",children:R.review_text})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"milestone-type",children:"What makes this moment significant?"}),s.jsxs(aa,{value:u,onValueChange:F=>{h(F),F!=="custom"&&(x(""),v(""))},children:[s.jsx(Gs,{id:"milestone-type",children:s.jsx(ia,{})}),s.jsxs(Ys,{className:"z-[10000] bg-white",children:[s.jsx(Bt,{value:"best_setlist",children:"Best Setlist"}),s.jsx(Bt,{value:"first_favorite_artist",children:"First Time Seeing Favorite Artist"}),s.jsx(Bt,{value:"first_favorite_venue",children:"First Time at Favorite Venue"}),s.jsx(Bt,{value:"custom",children:"Custom Milestone"})]})]})]}),u==="custom"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"custom-milestone-name",children:"Milestone Name"}),s.jsx(Nr,{id:"custom-milestone-name",placeholder:"e.g., First festival, Best encore, Special guest appearance...",value:g,onChange:F=>x(F.target.value),maxLength:100}),s.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[g.length,"/100"]})]}),(u==="custom"||u==="best_setlist")&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"significance",children:u==="best_setlist"?"Why was this the best setlist?":"Description (optional)"}),s.jsx(_s,{id:"significance",placeholder:u==="best_setlist"?"Tell us what made this setlist stand out...":"Describe why this moment is significant...",value:m,onChange:F=>v(F.target.value),rows:4,maxLength:500}),s.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[m.length,"/500"]})]}),u==="first_favorite_artist"&&R&&s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-blue-900",children:["This will mark this as your first time seeing ",s.jsx("strong",{children:((M=R.event)==null?void 0:M.artist_name)||"this artist"})," as your favorite artist."]})}),u==="first_favorite_venue"&&R&&s.jsx("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-purple-900",children:["This will mark this as your first time at ",s.jsx("strong",{children:((B=R.event)==null?void 0:B.venue_name)||"this venue"})," as your favorite venue."]})})]}),s.jsxs(Tf,{children:[s.jsx(ce,{type:"button",variant:"outline",onClick:A,disabled:_,children:"Cancel"}),s.jsx(ce,{type:"button",onClick:C,disabled:_||!n&&!d,children:_?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):n?"Update":"Add to Timeline"})]})]})})},A7=({userId:e})=>{const[t,r]=y.useState([]),[n,a]=y.useState(!0),[i,o]=y.useState(0),[l,c]=y.useState(!1),[d,f]=y.useState(null),{toast:u}=Er();y.useEffect(()=>{h()},[e]);const h=()=>E(void 0,null,function*(){a(!0);try{const b=yield Bo.getTimeline(e);r(b),o(b.filter(N=>N.is_pinned).length)}catch(b){console.error("Error loading timeline:",b)}finally{a(!1)}}),m=(b,N)=>E(void 0,null,function*(){try{if(N)yield Bo.unpinTimelineEvent(e,b),u({title:"Unpinned",description:"Event removed from pinned timeline"});else{if(i>=5){u({title:"Maximum pins reached",description:"You can pin a maximum of 5 timeline events",variant:"destructive"});return}const S=t.find(k=>k.id===b);S!=null&&S.review_id&&(yield Bo.pinTimelineEvent(e,S.review_id),u({title:"Pinned",description:"Event pinned to timeline"}))}yield h()}catch(S){console.error("Error toggling pin:",S),u({title:"Error",description:"Failed to update pin status",variant:"destructive"})}}),v=b=>{if(!b.significance)return{icon:Fl,color:"text-synth-pink",bg:"bg-synth-pink/10"};const N=b.significance.toLowerCase();return N.includes("first review")?{icon:e2,color:"text-yellow-600",bg:"bg-yellow-100"}:N.includes("first time seeing")?{icon:Ft,color:"text-blue-600",bg:"bg-blue-100"}:N.includes("first time at")?{icon:yr,color:"text-purple-600",bg:"bg-purple-100"}:N.includes("best setlist")?{icon:GQ,color:"text-indigo-600",bg:"bg-indigo-100"}:{icon:Xt,color:"text-pink-600",bg:"bg-pink-100"}},g=y.useMemo(()=>[...t].sort((b,N)=>b.is_pinned&&!N.is_pinned?-1:!b.is_pinned&&N.is_pinned?1:new Date(N.created_at).getTime()-new Date(b.created_at).getTime()),[t]);if(n)return s.jsx("div",{className:"space-y-4",children:[...Array(3)].map((b,N)=>s.jsx(xw,{className:"h-32 w-full"},N))});const x=()=>{f(null),c(!0)},_=b=>{f(b),c(!0)},w=()=>{h()};return t.length===0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[s.jsx(Fl,{className:"w-12 h-12 mx-auto mb-4",style:{color:"var(--neutral-600)"}}),s.jsx("p",{className:"font-medium",children:"No timeline highlights yet."}),s.jsx("p",{className:"text-sm mt-2",children:"Mark special moments in your music journey."}),s.jsxs(ce,{onClick:x,className:"mt-4",variant:"default",children:["Add Your First Milestone",s.jsx(Yo,{className:"w-4 h-4 ml-2"})]})]}),s.jsx(u4,{isOpen:l,onClose:()=>c(!1),userId:e,existingReviewId:(d==null?void 0:d.review_id)||void 0,existingSignificance:(d==null?void 0:d.significance)||void 0,existingDescription:(d==null?void 0:d.description)||void 0,onSuccess:w})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"mb-6 flex justify-end",children:s.jsxs(ce,{onClick:x,variant:"outline",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[s.jsx(Yo,{size:16,style:{marginRight:"var(--spacing-inline, 6px)"}}),"Add Milestone"]})}),s.jsx("div",{className:"absolute left-7 sm:left-9 top-0 bottom-0 w-0.5 bg-gradient-to-b from-synth-pink/30 via-synth-pink/40 to-synth-pink/20"}),s.jsx("div",{className:"space-y-8",children:g.map((b,N)=>{var R,I,O;const S=v(b),k=S.icon,C=(R=b.review)!=null&&R.Event_date?new Date(b.review.Event_date):new Date(b.created_at),A=!b.is_auto_selected;return s.jsxs("div",{className:"relative pl-16 sm:pl-20",children:[s.jsxs("div",{className:"absolute left-0 top-0 flex flex-col items-end pr-2 w-14 sm:w-16",children:[s.jsxs("div",{className:Oe("mb-2 px-1.5 py-0.5 rounded text-[10px] sm:text-xs font-semibold whitespace-nowrap shadow-sm text-center w-full",b.is_pinned?"bg-synth-pink text-white":"bg-gray-100 text-gray-700"),children:[s.jsx("div",{className:"leading-tight",children:Rt(C,"MMM")}),s.jsx("div",{className:"leading-tight font-bold",children:Rt(C,"d")}),s.jsx("div",{className:"leading-tight text-[9px] sm:text-[10px] opacity-75",children:Rt(C,"yyyy")})]}),s.jsx("div",{className:Oe("w-8 h-8 sm:w-10 sm:h-10 rounded-full border-2 border-white shadow-lg flex items-center justify-center z-10 transition-all duration-300 mx-auto",b.is_pinned?"bg-synth-pink ring-4 ring-synth-pink/30 scale-110 shadow-xl shadow-synth-pink/40":`${S.bg} ring-2 ring-white/80`),children:s.jsx(k,{className:Oe("w-4 h-4 sm:w-5 sm:h-5",b.is_pinned?"text-white":S.color)})})]}),s.jsxs(Ze,{className:Oe("relative overflow-hidden transition-all duration-300 hover:shadow-xl w-full max-w-full",b.is_pinned?"border-2 border-synth-pink shadow-lg shadow-synth-pink/20 bg-gradient-to-br from-white to-synth-pink/5":"border border-gray-200 bg-white hover:border-synth-pink/30"),children:[s.jsx(tt,{className:"p-4 sm:p-6",children:s.jsxs("div",{className:"flex items-start justify-between gap-3 sm:gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0 overflow-x-hidden",children:[b.significance&&s.jsx("div",{className:"mb-3 sm:mb-4",children:s.jsxs("div",{className:Oe("inline-flex items-center gap-1.5 sm:gap-2 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg font-bold text-sm sm:text-base mb-2 sm:mb-3 break-words",b.is_pinned?"bg-synth-pink/10 text-synth-pink border-2 border-synth-pink/30":`${S.bg} ${S.color} border-2 border-current/20`),children:[s.jsx(k,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),s.jsx("span",{className:"break-words",children:b.significance})]})}),b.Event_name&&s.jsx("h4",{className:"font-bold text-base sm:text-lg text-gray-900 mb-2 sm:mb-3 break-words",children:b.Event_name}),((I=b.review)==null?void 0:I.rating)&&s.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 mb-3 sm:mb-4",children:[[...Array(5)].map((z,M)=>s.jsx(Xt,{className:Oe("w-4 h-4 sm:w-5 sm:h-5 transition-colors flex-shrink-0",M<Math.round(b.review.rating)?"fill-yellow-400 text-yellow-400":"fill-gray-200 text-gray-200")},M)),s.jsx("span",{className:"text-xs sm:text-sm font-semibold text-gray-700 ml-1 flex-shrink-0",children:b.review.rating.toFixed(1)})]}),((O=b.review)==null?void 0:O.review_text)&&s.jsx("p",{className:"text-xs sm:text-sm text-gray-700 leading-relaxed line-clamp-3 break-words",children:b.review.review_text})]}),s.jsxs("div",{className:"flex flex-col items-end gap-2 shrink-0",children:[b.is_pinned&&s.jsxs(et,{className:"bg-synth-pink text-white border-0 text-xs",children:[s.jsx(EN,{className:"w-3 h-3 mr-1 fill-current"}),"Pinned"]}),s.jsxs("div",{className:"flex gap-1",children:[A&&s.jsx(ce,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full text-gray-400 hover:text-synth-pink hover:bg-synth-pink/5",onClick:()=>_(b),title:"Edit milestone",children:s.jsx(rz,{className:"w-4 h-4"})}),s.jsx(ce,{variant:"ghost",size:"sm",className:Oe("h-8 w-8 p-0 rounded-full transition-all",b.is_pinned?"text-synth-pink hover:bg-synth-pink/10":"text-gray-400 hover:text-synth-pink hover:bg-synth-pink/5"),onClick:()=>m(b.id,b.is_pinned),disabled:!b.is_pinned&&i>=5,title:b.is_pinned?"Unpin":"Pin to timeline",children:b.is_pinned?s.jsx(EN,{className:"w-4 h-4 fill-current"}):s.jsx(EN,{className:"w-4 h-4"})})]})]})]})}),b.is_pinned&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-synth-pink via-synth-pink-light to-transparent"})]})]},b.id)})})]}),s.jsx(u4,{isOpen:l,onClose:()=>c(!1),userId:e,existingReviewId:(d==null?void 0:d.review_id)||void 0,existingSignificance:(d==null?void 0:d.significance)||void 0,existingDescription:(d==null?void 0:d.description)||void 0,onSuccess:w})]})};class Rx{static getBucketList(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("bucket_list").select("id, user_id, entity_id, entity_name, added_at, metadata").eq("user_id",t).order("added_at",{ascending:!1});if(n)throw n;return yield Promise.all((r||[]).map(i=>E(this,null,function*(){let o,l;if(i.entity_id){const{data:c}=yield T.from("entities").select("entity_type, entity_uuid").eq("id",i.entity_id).single();c&&(o=c.entity_type,l=c.entity_uuid||void 0)}if(l){const{data:c}=yield T.from("artists").select("id, name, image_url").eq("id",l).maybeSingle();if(c)return{id:i.id,user_id:i.user_id,entity_type:"artist",entity_id:l,entity_name:i.entity_name,added_at:i.added_at,metadata:i.metadata||{},artist:c};const{data:d}=yield T.from("venues").select("id, name, image_url").eq("id",l).maybeSingle();if(d)return{id:i.id,user_id:i.user_id,entity_type:"venue",entity_id:l,entity_name:i.entity_name,added_at:i.added_at,metadata:i.metadata||{},venue:d}}if(!o){const{data:c}=yield T.from("artists").select("id, name, image_url").ilike("name",i.entity_name).limit(1).maybeSingle();if(c)return{id:i.id,user_id:i.user_id,entity_type:"artist",entity_id:c.id,entity_name:i.entity_name,added_at:i.added_at,metadata:i.metadata||{},artist:c};const{data:d}=yield T.from("venues").select("id, name, image_url").ilike("name",i.entity_name).limit(1).maybeSingle();if(d)return{id:i.id,user_id:i.user_id,entity_type:"venue",entity_id:d.id,entity_name:i.entity_name,added_at:i.added_at,metadata:i.metadata||{},venue:d}}return{id:i.id,user_id:i.user_id,entity_type:o||"artist",entity_id:l||i.entity_id,entity_name:i.entity_name,added_at:i.added_at,metadata:i.metadata||{}}})))}catch(r){return console.error("Error fetching bucket list:",r),[]}})}static addArtist(t,r,n){return E(this,null,function*(){try{const{error:a}=yield T.from("bucket_list").insert({user_id:t,entity_type:"artist",entity_id:r,entity_name:n});if(a){if(a.code==="23505")return!0;throw a}return!0}catch(a){return console.error("Error adding artist to bucket list:",a),!1}})}static addVenue(t,r,n){return E(this,null,function*(){try{const{error:a}=yield T.from("bucket_list").insert({user_id:t,entity_type:"venue",entity_id:r,entity_name:n});if(a){if(a.code==="23505")return!0;throw a}return!0}catch(a){return console.error("Error adding venue to bucket list:",a),!1}})}static removeItem(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("bucket_list").delete().eq("id",r).eq("user_id",t);if(n)throw n;return!0}catch(n){return console.error("Error removing item from bucket list:",n),!1}})}static removeEntity(t,r,n){return E(this,null,function*(){try{const{error:a}=yield T.from("bucket_list").delete().eq("user_id",t).eq("entity_type",r).eq("entity_id",n);if(a)throw a;return!0}catch(a){return console.error("Error removing entity from bucket list:",a),!1}})}static isInBucketList(t,r,n){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("bucket_list").select("id").eq("user_id",t).eq("entity_type",r).eq("entity_id",n).single();if(i&&i.code!=="PGRST116")throw i;return!!a}catch(a){return console.error("Error checking bucket list:",a),!1}})}static searchBucketList(t,r,n=50){return E(this,null,function*(){try{if(!r.trim())return yield this.getBucketList(t);const{data:a,error:i}=yield T.rpc("search_bucket_list",{p_user_id:t,p_search_query:r.trim(),p_limit:n});if(i)throw i;return(a||[]).map(o=>({id:o.id,user_id:o.user_id,entity_type:o.entity_type,entity_id:o.entity_id,entity_name:o.entity_name,added_at:o.added_at,metadata:o.metadata||{},artist:o.artist_id?{id:o.artist_id,name:o.artist_name||o.entity_name,image_url:o.artist_image_url||void 0}:void 0,venue:o.venue_id?{id:o.venue_id,name:o.venue_name||o.entity_name,image_url:o.venue_image_url||void 0}:void 0}))}catch(a){return console.error("Error searching bucket list:",a),[]}})}}const R7=({userId:e})=>{const[t,r]=y.useState([]),[n,a]=y.useState(!0),[i,o]=y.useState(!1),[l,c]=y.useState(!1),[d,f]=y.useState(!1),[u,h]=y.useState(!1);y.useEffect(()=>{m()},[e]);const m=()=>E(void 0,null,function*(){a(!0);try{const w=yield Rx.getBucketList(e);r(w)}catch(w){console.error("Error loading bucket list:",w)}finally{a(!1)}}),v=w=>E(void 0,null,function*(){f(!0);try{(yield Rx.addArtist(e,w.id,w.name))&&(o(!1),yield m())}catch(b){console.error("Error adding artist:",b)}finally{f(!1)}}),g=w=>E(void 0,null,function*(){f(!0);try{(yield Rx.addVenue(e,w.id,w.name))&&(c(!1),yield m())}catch(b){console.error("Error adding venue:",b)}finally{f(!1)}}),x=w=>E(void 0,null,function*(){try{(yield Rx.removeItem(e,w))&&(yield m())}catch(b){console.error("Error removing item:",b)}}),_=w=>{const b=w.entity_type||(w.artist?"artist":w.venue?"venue":null);if(!b){console.error("Cannot determine entity type for item:",w);return}if(b==="artist"||w.artist){const N=new CustomEvent("open-artist-card",{detail:{artistId:w.entity_id,artistName:w.entity_name},bubbles:!0});document.dispatchEvent(N)}else if(b==="venue"||w.venue){const N=new CustomEvent("open-venue-card",{detail:{venueId:w.entity_id,venueName:w.entity_name},bubbles:!0});document.dispatchEvent(N)}else console.error("Unknown entity type:",b,w)};return n?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(fr,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):s.jsxs("div",{className:"space-y-4 overflow-visible",children:[s.jsx(Ze,{className:u?"mb-4":"",style:{overflow:"visible"},children:s.jsxs(tt,{className:"p-4",style:{overflow:"visible"},children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[s.jsxs(ce,{variant:"outline",onClick:()=>{o(!i),c(!1),h(!1)},className:"flex-1",children:[s.jsx(Yo,{className:"w-4 h-4 mr-2"}),"Add Artist"]}),s.jsxs(ce,{variant:"outline",onClick:()=>{c(!l),o(!1),h(!1)},className:"flex-1",children:[s.jsx(Yo,{className:"w-4 h-4 mr-2"}),"Add Venue"]})]}),i&&s.jsxs("div",{className:"mt-4 relative",style:{zIndex:1e3},children:[s.jsx(b1,{onArtistSelect:v,placeholder:"Search for an artist to add...",onSearchStateChange:h}),d&&s.jsxs("div",{className:"flex items-center justify-center mt-2",children:[s.jsx(fr,{className:"w-4 h-4 animate-spin text-muted-foreground mr-2"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"Adding..."})]})]}),l&&s.jsxs("div",{className:"mt-4 relative",style:{zIndex:1e3},children:[s.jsx(cB,{onVenueSelect:g,placeholder:"Search for a venue to add...",onSearchStateChange:h}),d&&s.jsxs("div",{className:"flex items-center justify-center mt-2",children:[s.jsx(fr,{className:"w-4 h-4 animate-spin text-muted-foreground mr-2"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"Adding..."})]})]})]})}),!u&&s.jsx(s.Fragment,{children:t.length===0?s.jsx(Ze,{children:s.jsxs(tt,{className:"p-8 text-center",children:[s.jsx("p",{className:"text-muted-foreground mb-2",children:"Your bucket list is empty"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Add artists or venues to get notified when new shows are announced!"})]})}):s.jsx("div",{className:"max-h-[600px] overflow-y-auto pr-2 space-y-3",children:t.map(w=>{var b,N,S,k;return s.jsx(Ze,{className:"cursor-pointer hover:shadow-md transition-shadow border-2 hover:border-synth-pink/50",onClick:()=>_(w),children:s.jsx(tt,{className:"p-3",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Wr,{className:"h-10 w-10 flex-shrink-0",children:w.entity_type==="artist"&&((b=w.artist)!=null&&b.image_url)||w.entity_type==="venue"&&((N=w.venue)!=null&&N.image_url)?s.jsx(Qr,{src:w.entity_type==="artist"?(S=w.artist)==null?void 0:S.image_url:(k=w.venue)==null?void 0:k.image_url,alt:w.entity_name}):s.jsx(Hr,{className:"text-xs",children:w.entity_type==="artist"?s.jsx(Ft,{className:"w-5 h-5"}):s.jsx(Io,{className:"w-5 h-5"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("h4",{className:"font-semibold text-sm truncate",children:w.entity_name}),s.jsx(ce,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 flex-shrink-0 hover:bg-red-100 hover:text-red-600",onClick:C=>{C.stopPropagation(),x(w.id)},children:s.jsx(Yr,{className:"w-3 h-3"})})]}),s.jsx("div",{className:"flex items-center gap-2 mt-1",children:s.jsxs("span",{className:"text-xs text-muted-foreground",children:["Added ",new Date(w.added_at).toLocaleDateString()]})})]})]})})},w.id)})})})]})};class Vge{static getBehavioralAchievements(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("achievements").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(n)throw n;const{data:a,error:i}=yield T.from("user_achievement_progress").select("*").eq("user_id",t);if(i)throw i;const o=new Map;(a||[]).forEach(c=>{o.set(c.achievement_id,c)});const l=[];return(r||[]).forEach(c=>{const d=o.get(c.id),f=(d==null?void 0:d.current_progress)||0,u=(d==null?void 0:d.highest_tier_achieved)||null,h=parseInt(String(c.bronze_goal))||0,m=parseInt(String(c.silver_goal))||0,v=parseInt(String(c.gold_goal))||0;let g=!1,x=h,_=null,w,b=c.bronze_requirement;u==="gold"?(g=!0,_="gold",x=v,b=c.gold_requirement,w=d==null?void 0:d.gold_achieved_at):u==="silver"?(g=!0,_="silver",x=m,b=c.silver_requirement,w=d==null?void 0:d.silver_achieved_at):u==="bronze"?(g=!0,_="bronze",x=h,b=c.bronze_requirement,w=d==null?void 0:d.bronze_achieved_at):(x=h,_=null,b=c.bronze_requirement);const N=this.getIconForAchievement(c.achievement_key,c.category);l.push({id:c.id,type:c.achievement_key,name:c.name,description:b,icon:N,tier:_||void 0,progress:f,goal:x,unlocked:g,unlocked_at:w,metadata:(d==null?void 0:d.progress_metadata)||{}})}),l.sort((c,d)=>{if(c.unlocked!==d.unlocked)return c.unlocked?-1:1;if(c.unlocked&&d.unlocked){const f={gold:0,silver:1,bronze:2},u=c.tier||"bronze",h=d.tier||"bronze",m=(f[u]||2)-(f[h]||2);if(m!==0)return m}return(d.progress||0)-(c.progress||0)})}catch(r){return console.error("Error fetching behavioral achievements:",r),[]}})}static getIconForAchievement(t,r){const n={genre_curator:"",genre_specialist:"",bucket_list_starter:"",intentional_explorer:"",return_engagement:"",new_blood:"",festival_attendance:"",artist_devotee:"",venue_regular:"",go_with_friends:"",venue_hopper:"",scene_explorer:"",city_crosser:"",era_walker:"",first_through_door:"",trusted_voice:"",deep_cut_reviewer:"",scene_regular:"",road_tripper:"",venue_loyalist:"",genre_blender:"",memory_maker:"",early_adopter:"",connector:"",passport_complete:""};return n[t]?n[t]:{exploration:"",specialization:"",milestones:"",discovery:"",loyalty:"",social:""}[r]||""}static checkAndUnlockAchievements(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("check_all_achievements",{p_user_id:t});if(r)throw r}catch(r){console.error("Error checking achievements:",r)}})}static mapAchievementToDisplay(t){const r=this.getAchievementInfo(t.achievement_type,t.tier);return{id:t.id,type:t.achievement_type,name:r.name,description:r.description,icon:r.icon,tier:t.tier,progress:t.progress||0,goal:t.goal||0,unlocked:!!t.unlocked_at,unlocked_at:t.unlocked_at,metadata:t.metadata}}static getAchievementInfo(t,r){const n=r?` (${r.charAt(0).toUpperCase()+r.slice(1)})`:"";return{venue_hopper:{name:"Venue Hopper"+n,description:r==="gold"?"Attend shows at 15 different venues":r==="silver"?"Attend shows at 7 different venues":"Attend shows at 3 different venues",icon:""},scene_explorer:{name:"Scene Explorer"+n,description:r==="gold"?"Engage with 7 distinct scenes":r==="silver"?"Engage with 4 distinct scenes":"Engage with 2 distinct scenes",icon:""},city_crosser:{name:"City Crosser"+n,description:r==="gold"?"Attend shows in 10 cities":r==="silver"?"Attend shows in 5 cities":"Attend shows in 2 cities",icon:""},era_walker:{name:"Era Walker"+n,description:r==="gold"?"Attend shows from 5 different eras":r==="silver"?"Attend shows from 3 different eras":"Attend shows from 2 different eras",icon:""},first_through_door:{name:"First Through the Door"+n,description:r==="gold"?"Attend 6 emerging-artist shows":r==="silver"?"Attend 3 emerging-artist shows":"Attend 1 emerging-artist show",icon:""},trusted_voice:{name:"Trusted Voice"+n,description:r==="gold"?"Reviews saved by others 25 times":r==="silver"?"Reviews saved by others 10 times":"Reviews saved by others 3 times",icon:""},deep_cut_reviewer:{name:"Deep Cut Reviewer"+n,description:r==="gold"?"Review 10 non-headliner performances":r==="silver"?"Review 5 non-headliner performances":"Review 2 non-headliner performances",icon:""},scene_regular:{name:"Scene Regular"+n,description:r==="gold"?"Attend 10 events in the same scene":r==="silver"?"Attend 6 events in the same scene":"Attend 3 events in the same scene",icon:""},road_tripper:{name:"Road Tripper"+n,description:r==="gold"?"Attend 6 out-of-town shows":r==="silver"?"Attend 3 out-of-town shows":"Attend 1 out-of-town show",icon:""},venue_loyalist:{name:"Venue Loyalist"+n,description:r==="gold"?"Attend 10 shows at the same venue":r==="silver"?"Attend 6 shows at the same venue":"Attend 3 shows at the same venue",icon:""},genre_blender:{name:"Genre Blender"+n,description:r==="gold"?"Attend shows across 6 genres":r==="silver"?"Attend shows across 4 genres":"Attend shows across 2 genres",icon:""},memory_maker:{name:"Memory Maker"+n,description:r==="gold"?"Pin 5 defining shows to your passport":r==="silver"?"Pin 3 defining shows to your passport":"Pin 1 defining show to your passport",icon:""},early_adopter:{name:"Early Adopter"+n,description:r==="gold"?"Attend 5 shows early after joining":r==="silver"?"Attend 3 shows early after joining":"Attend a show shortly after joining",icon:""},connector:{name:"Connector"+n,description:r==="gold"?"Attend 10 shows with friends":r==="silver"?"Attend 5 shows with friends":"Attend 2 shows with friends",icon:""},passport_complete:{name:"Passport Complete"+n,description:r==="gold"?"Unlock all 15 achievements":r==="silver"?"Unlock 10 achievements":"Unlock 5 achievements",icon:""}}[t]||{name:"Achievement"+n,description:"Awarded for your musical journey",icon:""}}}const Wge=({isOpen:e,onClose:t,userId:r,userName:n,inline:a=!1})=>{var A;const[i,o]=y.useState({cities:[],venues:[],artists:[],scenes:[],totalCount:0}),[l,c]=y.useState([]),[d,f]=y.useState([]),[u,h]=y.useState([]),[m,v]=y.useState(!0),[g,x]=y.useState("identity"),[_,w]=y.useState(()=>({open:!1})),[b,N]=y.useState(()=>({open:!1})),S=y.useRef({artist:!1,venue:!1});y.useEffect(()=>{(e||a)&&k()},[e,a,r]),y.useEffect(()=>{const R=O=>E(void 0,null,function*(){if(S.current.artist)return;S.current.artist=!0;const z=O.detail||{};let M=z.artistId;if(!M&&z.artistName)try{const{data:F}=yield T.from("artists").select("id").ilike("name",z.artistName).limit(1).maybeSingle();F&&(M=F.id)}catch(F){console.error("Error fetching artist ID:",F)}const B={open:!0,artistId:M||null,artistName:z.artistName||"Unknown Artist"};N(B),e&&!a?setTimeout(()=>{t(),setTimeout(()=>{S.current.artist=!1},300)},100):setTimeout(()=>{S.current.artist=!1},500)}),I=O=>E(void 0,null,function*(){if(S.current.venue)return;S.current.venue=!0;const z=O.detail||{};e&&!a&&t();let M=z.venueId;if(!M&&z.venueName)try{const{data:B}=yield T.from("venues").select("id").ilike("name",z.venueName).limit(1).maybeSingle();B&&(M=B.id)}catch(B){console.error("Error fetching venue ID:",B)}w({open:!0,venueId:M||null,venueName:z.venueName}),setTimeout(()=>{S.current.venue=!1},500)});return document.addEventListener("open-venue-card",I),document.addEventListener("open-artist-card",R),()=>{document.removeEventListener("open-venue-card",I),document.removeEventListener("open-artist-card",R)}},[e,a,t]);const k=()=>E(void 0,null,function*(){v(!0);try{const[R,I,O,z]=yield Promise.all([Bo.getPassportProgress(r),Bo.getStampsByRarity(r),Vge.getBehavioralAchievements(r),Bo.getNextToUnlock(r)]);o(R),c(I),f(O),h(z)}catch(R){console.error("Error loading passport data:",R)}finally{v(!1)}});if(!e&&!a&&!b.open&&!_.open)return null;const C=s.jsxs(s.Fragment,{children:[a&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold gradient-text",children:"Live Music Passport"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your curated, earned, and evolving snapshot of your live-music journey"})]}),m?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Re,{name:"refresh",size:24,className:"animate-spin",color:"var(--neutral-600)"})}):s.jsxs(zi,{value:g,onValueChange:R=>x(R),className:`${a?"":"mt-4"} w-full max-w-full`,children:[s.jsx("div",{className:"w-full overflow-x-auto overflow-y-hidden scrollbar-hide -mx-1 px-1",children:s.jsxs(wi,{className:"inline-flex w-auto min-w-full h-auto bg-transparent",style:{gap:"var(--spacing-inline, 6px)",padding:"var(--spacing-inline, 6px)"},children:[s.jsxs(en,{value:"identity",className:"flex flex-col items-center justify-center flex-shrink-0 min-w-[65px]",style:{gap:"var(--spacing-inline, 6px)",padding:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:g==="identity"?"var(--neutral-50)":"var(--neutral-100)",border:"1px solid var(--neutral-200)",boxShadow:g==="identity"?"0 4px 4px 0 var(--shadow-color)":"none"},children:[s.jsx(Re,{name:"user",size:16,className:"flex-shrink-0",color:"var(--neutral-900)"}),s.jsx("span",{className:"text-center leading-tight",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},children:"Identity"})]}),s.jsxs(en,{value:"stamps",className:"flex flex-col items-center justify-center flex-shrink-0 min-w-[65px]",style:{gap:"var(--spacing-inline, 6px)",padding:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:g==="stamps"?"var(--neutral-50)":"var(--neutral-100)",border:"1px solid var(--neutral-200)",boxShadow:g==="stamps"?"0 4px 4px 0 var(--shadow-color)":"none"},children:[s.jsx(Re,{name:"mediumShootingStar",size:16,className:"flex-shrink-0",color:"var(--neutral-900)"}),s.jsx("span",{className:"text-center leading-tight",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},children:"Stamps"})]}),s.jsxs(en,{value:"achievements",className:"flex flex-col items-center justify-center flex-shrink-0 min-w-[65px]",style:{gap:"var(--spacing-inline, 6px)",padding:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:g==="achievements"?"var(--neutral-50)":"var(--neutral-100)",border:"1px solid var(--neutral-200)",boxShadow:g==="achievements"?"0 4px 4px 0 var(--shadow-color)":"none"},children:[s.jsx(Re,{name:"ribbonAward",size:16,className:"flex-shrink-0",color:"var(--neutral-900)"}),s.jsx("span",{className:"text-center leading-tight",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},children:"Achievements"})]}),s.jsxs(en,{value:"timeline",className:"flex flex-col items-center justify-center flex-shrink-0 min-w-[65px]",style:{gap:"var(--spacing-inline, 6px)",padding:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:g==="timeline"?"var(--neutral-50)":"var(--neutral-100)",border:"1px solid var(--neutral-200)",boxShadow:g==="timeline"?"0 4px 4px 0 var(--shadow-color)":"none"},children:[s.jsx(Re,{name:"clock",size:16,className:"flex-shrink-0",color:"var(--neutral-900)"}),s.jsx("span",{className:"text-center leading-tight",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},children:"Timeline"})]}),s.jsxs(en,{value:"bucket",className:"flex flex-col items-center justify-center flex-shrink-0 min-w-[65px]",style:{gap:"var(--spacing-inline, 6px)",padding:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:g==="bucket"?"var(--neutral-50)":"var(--neutral-100)",border:"1px solid var(--neutral-200)",boxShadow:g==="bucket"?"0 4px 4px 0 var(--shadow-color)":"none"},children:[s.jsx(Re,{name:"checkMark",size:16,className:"flex-shrink-0",color:"var(--neutral-900)"}),s.jsx("span",{className:"text-center leading-tight",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},children:"Bucket List"})]})]})}),s.jsx(tn,{value:"identity",className:"mt-4 w-full max-w-full overflow-x-hidden px-1",children:s.jsx(P7,{userId:r,userName:n})}),s.jsx(tn,{value:"stamps",className:"mt-4 w-full max-w-full overflow-x-hidden px-1",children:s.jsx(T7,{stamps:l,achievements:d,loading:m})}),s.jsx(tn,{value:"achievements",className:"mt-4 w-full max-w-full overflow-x-hidden px-1",children:d.length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx("p",{children:"No achievements unlocked yet."}),s.jsx("p",{className:"text-xs mt-1",children:"Keep attending events and writing reviews to unlock achievements!"})]}):s.jsx("div",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:d.map(R=>{const I=R.goal>0?Math.min(R.progress/R.goal*100,100):0;return s.jsxs("div",{className:`flex gap-[6px] items-center px-6 py-3 rounded-[10px] shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)] w-full max-w-full ${R.unlocked?"bg-[#fcfcfc] border border-[#5d646f]":"bg-[rgba(201,201,201,0.5)] border border-[#5d646f]"}`,children:[s.jsx("p",{className:"font-bold text-[35px] leading-[normal] flex-shrink-0",children:R.icon||""}),s.jsxs("div",{className:"flex flex-col gap-[6px] items-start justify-center flex-1 min-w-0",children:[s.jsx("p",{className:"font-bold leading-[normal] text-[20px] text-black break-words",children:R.name}),s.jsx("p",{className:"font-normal leading-[normal] text-[#5d646f] text-[16px] break-words whitespace-pre-wrap",children:R.description}),R.unlocked?s.jsxs("div",{className:"bg-[#fdf2f7] flex gap-3 h-[25px] items-center px-3 py-3 rounded-[10px] shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)] mt-1",children:[s.jsx("svg",{width:"15",height:"12",viewBox:"0 0 15 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-[17px] h-[17px]",children:s.jsx("path",{d:"M1 6L5 10L14 1",stroke:"#b00056",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),s.jsx("p",{className:"font-normal leading-[normal] text-[16px] text-[#b00056]",children:"Unlocked"})]}):s.jsxs("div",{className:"w-full mt-1",children:[s.jsx("div",{className:"bg-[rgba(201,201,201,0.5)] border border-[#5d646f] h-[10px] rounded-[10px] overflow-hidden relative w-full mb-1",children:s.jsx("div",{className:"absolute bg-[#cc2486] border border-[#5d646f] h-[10px] rounded-l-[10px]",style:{width:`${I}%`}})}),s.jsxs("p",{className:"font-normal leading-[normal] text-[#5d646f] text-[16px] text-right w-full",children:[R.progress,"/",R.goal]})]})]})]},R.id||R.type)})})}),s.jsx(tn,{value:"timeline",className:"mt-4 w-full max-w-full overflow-x-hidden px-1",children:s.jsx(A7,{userId:r})}),s.jsx(tn,{value:"bucket",className:"mt-4 w-full max-w-full overflow-x-hidden px-1",children:s.jsx(R7,{userId:r})})]})]});return a?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-full",children:C}),s.jsx(vn,{open:b.open,onOpenChange:R=>N({open:R,artist:null,events:void 0,totalEvents:void 0}),children:s.jsxs(hn,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(Sn,{className:"sr-only",children:"Artist Profile"}),s.jsxs(ds,{className:"sr-only",children:["Artist profile for ",((A=b.artist)==null?void 0:A.name)||"artist"]}),b.artist&&s.jsx(ArtistCard,{artist:b.artist,events:b.events||[],totalEvents:b.totalEvents||0,source:b.events&&b.events.length>0?"api":"database",userId:r,onBack:()=>N({open:!1,artist:null,events:void 0,totalEvents:void 0}),showAllEvents:!0})]})}),b.artistId&&s.jsx(fw,{isOpen:b.open,onClose:()=>N({open:!1,artistId:null,artistName:void 0}),artistId:b.artistId,artistName:b.artistName||"Unknown Artist",currentUserId:r}),_.venueId&&_.venueName&&s.jsx(hw,{isOpen:_.open,onClose:()=>w({open:!1,venueId:null,venueName:""}),venueId:_.venueId,venueName:_.venueName,currentUserId:r})]}):s.jsxs(s.Fragment,{children:[s.jsx(vn,{open:e,onOpenChange:t,children:s.jsxs(hn,{className:"max-w-5xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Hn,{children:[s.jsx(Sn,{children:"Live Music Passport"}),s.jsx(ds,{children:"Your curated, earned, and evolving snapshot of your live-music journey"})]}),C]})}),b.open&&b.artistId&&s.jsx(fw,{isOpen:b.open,onClose:()=>{N({open:!1,artistId:null,artistName:void 0})},artistId:b.artistId,artistName:b.artistName||"Unknown Artist",currentUserId:r}),_.open&&_.venueId&&_.venueName&&s.jsx(hw,{isOpen:_.open,onClose:()=>{w({open:!1,venueId:null,venueName:""})},venueId:_.venueId,venueName:_.venueName,currentUserId:r})]})},Hge=({currentUserId:e,profileUserId:t,onBack:r,onEdit:n,onSettings:a,onSignOut:i,onNavigateToProfile:o,onNavigateToChat:l,onNavigateToNotifications:c,menuOpen:d=!1,onMenuClick:f,hideHeader:u=!1,refreshTrigger:h=0})=>{var rt,ir,rn,Mt;const[m,v]=y.useState(null),[g,x]=y.useState([]),[_,w]=y.useState(!0),[b,N]=y.useState(!1),[S,k]=y.useState(!1),[C,A]=y.useState([]),[R,I]=y.useState(0),[O,z]=y.useState(null),[M,B]=y.useState([]),[F,U]=y.useState("my-events"),[H,q]=y.useState(!1),[K,Z]=y.useState([]),[ne,Y]=y.useState(!1),[X,se]=y.useState([]),[de,_e]=y.useState(!1),[xe,Q]=y.useState(!0),[oe,ie]=y.useState(null),[ee,G]=y.useState(!1),[J,ae]=y.useState(!1),[fe,we]=y.useState(null),[ve,me]=y.useState(!1),[Me,Te]=y.useState(!1),[Ve,le]=y.useState(!1),[Ke,De]=y.useState(!1),[nt,ze]=y.useState("friends"),[vt,rr]=y.useState(!1),[sr,Ae]=y.useState("none"),[Ue,gt]=y.useState(null),[Ce,Ge]=y.useState(0),[Nt,Tt]=y.useState({cities:0,venues:0,artists:0,scenes:0}),{toast:at}=Er(),{user:ue,sessionExpired:qe}=ws(),Ct=ts(),ct=t||e,pt=!t||t===e;go("profile",ct,{is_own_profile:pt},ct),y.useEffect(()=>{if(console.log(" ProfileView: useEffect triggered with:",{targetUserId:ct,sessionExpired:qe,user:ue==null?void 0:ue.id,hasUser:!!ue}),qe){console.log(" ProfileView: Session expired, skipping data fetch"),w(!1);return}if(!ue){console.log(" ProfileView: User not available yet, waiting...");return}const ye=setTimeout(()=>{console.log(" ProfileView: User is available, fetching data..."),w(!0),console.log(" ProfileView: Loading state set to TRUE"),E(void 0,null,function*(){try{console.log(" ProfileView: fetchData function called - parallelizing queries"),yield Promise.all([At(),yt(),ft(),Et(),cn(),je(),pe(),mn(),Pe(),pt?Promise.resolve():Ne()]),console.log(" ProfileView: All data fetched successfully")}catch(dt){console.error(" ProfileView: Error fetching data:",dt)}finally{w(!1),console.log(" ProfileView: Loading state set to FALSE")}})},300);return()=>clearTimeout(ye)},[ct,qe,ue]),y.useEffect(()=>{F==="interested"&&ct&&(console.log(" ProfileView: User switched to interested tab, refreshing events..."),yt())},[F,ct]),y.useEffect(()=>{h&&h>0&&ue&&!qe&&(console.log(" ProfileView: Refresh trigger changed, refetching reviews..."),ft(),Et())},[h]),y.useEffect(()=>{if(window.location.hash.substring(1)==="spotify"){U("spotify");return}if(pt){const Ie=sessionStorage.getItem("profileTab");Ie&&["timeline","interested","passport"].includes(Ie)&&(U(Ie==="timeline"?"passport":Ie),sessionStorage.removeItem("profileTab"))}},[pt]),y.useEffect(()=>{if(pt){const ye=sessionStorage.getItem("profileTab");ye&&["timeline","interested","passport"].includes(ye)&&(U(ye==="timeline"?"passport":ye),sessionStorage.removeItem("profileTab"))}},[pt]),y.useEffect(()=>{if(!ue){Q(!0);return}if(ue.id===e){Q(!0);return}E(void 0,null,function*(){try{const{data:ye}=yield T.from("user_relationships").select("id").eq("relationship_type","friend").eq("status","accepted").or(`and(user_id.eq.${ue.id},related_user_id.eq.${e}),and(user_id.eq.${e},related_user_id.eq.${ue.id}))`).limit(1);Q(Array.isArray(ye)?ye.length>0:!1)}catch(ye){Q(!0)}})},[ue,e]);const At=()=>E(void 0,null,function*(){var ye,Ie,dt,wt,ht,Le;try{if(console.log(" ProfileView: Starting profile fetch..."),console.log(" ProfileView: sessionExpired:",qe),console.log(" ProfileView: user:",ue),console.log(" ProfileView: currentUserId:",e),qe||!ue){console.log(" Session expired or no user, skipping profile fetch");return}console.log(" Fetching profile for user:",ct),console.log("ProfileView: Fetching profile for user:",ct);const Xe=ur=>E(void 0,null,function*(){return console.log(`ProfileView: Attempting profile lookup by ${ur}`),yield T.from("users").select("*").eq(ur,ct).maybeSingle()});let ke=null;const{data:St,error:_t}=yield Xe("user_id");if(console.log("ProfileView: Profile query result (user_id):",{data:St,error:_t}),_t&&_t.code!=="PGRST116"){if(console.error("Profile query error:",_t),console.error("Error code:",_t.code),console.error("Error message:",_t.message),console.error("Error details:",_t.details),(ye=_t.message)!=null&&ye.includes("invalid")||(Ie=_t.message)!=null&&Ie.includes("API key")||(dt=_t.message)!=null&&dt.includes("JWT")||(wt=_t.message)!=null&&wt.includes("expired")){console.error("Session error in ProfileView:",_t),at({title:"Session Expired",description:"Your session has expired. Please sign in again.",variant:"destructive"});return}}else ke=St;if(!ke){const{data:ur,error:or}=yield Xe("id");if(console.log("ProfileView: Profile query result (id):",{fallbackData:ur,fallbackError:or}),or&&or.code!=="PGRST116")throw or;ke=ur}if(ke){console.log("Profile found:",ke),v(ke);return}console.log("No profile found for user:",e),console.log("Creating default profile for user:",e);const{data:{user:Fr}}=yield T.auth.getUser(),dn=((ht=Fr==null?void 0:Fr.user_metadata)==null?void 0:ht.name)||((Le=Fr==null?void 0:Fr.email)==null?void 0:Le.split("@")[0])||"New User";console.log("Creating profile with name:",dn);const{data:En,error:Dt}=yield T.from("users").insert({user_id:e,name:dn,bio:"Music lover looking to connect at events!",instagram_handle:null,music_streaming_profile:null}).select().single();console.log("Profile creation result:",{newProfile:En,insertError:Dt}),Dt?(console.error("Error creating profile:",Dt),console.error("Insert error details:",Dt.details),console.error("Insert error hint:",Dt.hint),v({id:"temp",user_id:e,name:dn,username:null,avatar_url:null,bio:"Music lover looking to connect at events!",instagram_handle:null,music_streaming_profile:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})):En&&(console.log("Profile created successfully:",En),v(En))}catch(Xe){console.error("Error fetching profile:",Xe),v({id:"temp",user_id:e,name:"New User",username:null,avatar_url:null,bio:null,instagram_handle:null,music_streaming_profile:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}}),yt=()=>E(void 0,null,function*(){try{if(console.log(" ProfileView: fetchUserEvents called for user:",ct),qe||!ue){console.log("Session expired or no user, skipping user events fetch");return}console.log(" ProfileView: Fetching user events from database...");let Ie=(yield Kr.getUserInterestedEvents(ct)).events.map(Xe=>Xe.event).filter(Boolean);console.log(" ProfileView: Database query returned:",Ie==null?void 0:Ie.length,"events");const{data:dt}=yield T.from("reviews").select("event_id").eq("user_id",ct).eq("was_there",!0),wt=new Set((dt==null?void 0:dt.map(Xe=>Xe.event_id))||[]),Le=((Ie==null?void 0:Ie.map(Xe=>{var Fr,dn,En,Dt,ur,or,Wt,Sr,yn,nr,Cr,Cn,Ht,cr,In,bs,is,zr,Or,An,Br,zn,la,Da,Tn;const ke=Xe,St=Xe;console.log("ProfileView: Processing event in getUserEvents:",{title:ke==null?void 0:ke.title,artist_name:ke==null?void 0:ke.artist_name,venue_name:ke==null?void 0:ke.venue_name,poster_image_url:St==null?void 0:St.poster_image_url,images:St==null?void 0:St.images}),(Fr=ke==null?void 0:ke.title)!=null&&Fr.includes("Anotha")&&console.log("ProfileView: Found Anotha event in getUserEvents:",{item:Xe,jambaseEvent:ke,title:ke==null?void 0:ke.title,artist_name:ke==null?void 0:ke.artist_name,venue_name:ke==null?void 0:ke.venue_name,venue_city:ke==null?void 0:ke.venue_city,venue_state:ke==null?void 0:ke.venue_state});const _t={id:(dn=ke==null?void 0:ke.id)!=null?dn:"",jambase_event_id:(Dt=(En=ke==null?void 0:ke.jambase_event_id)!=null?En:ke==null?void 0:ke.id)!=null?Dt:"",title:(ur=ke==null?void 0:ke.title)!=null?ur:"",artist_name:(ke==null?void 0:ke.artist_name)||(ke==null?void 0:ke.artist_name)||null,artist_id:(Wt=(or=ke==null?void 0:ke.artist_id)!=null?or:ke==null?void 0:ke.artist_id)!=null?Wt:null,venue_name:(ke==null?void 0:ke.venue_name)||(ke==null?void 0:ke.venue_name)||null,venue_id:(yn=(Sr=ke==null?void 0:ke.venue_id)!=null?Sr:ke==null?void 0:ke.venue_id)!=null?yn:null,venue_address:(nr=ke==null?void 0:ke.venue_address)!=null?nr:null,venue_city:(Cr=ke==null?void 0:ke.venue_city)!=null?Cr:null,venue_state:(Cn=ke==null?void 0:ke.venue_state)!=null?Cn:null,venue_zip:(Ht=ke==null?void 0:ke.venue_zip)!=null?Ht:null,event_date:(cr=ke==null?void 0:ke.event_date)!=null?cr:"",doors_time:(In=ke==null?void 0:ke.doors_time)!=null?In:null,description:(bs=ke==null?void 0:ke.description)!=null?bs:null,genres:Array.isArray(ke==null?void 0:ke.genres)?ke.genres:[],latitude:(is=ke==null?void 0:ke.latitude)!=null?is:null,longitude:(zr=ke==null?void 0:ke.longitude)!=null?zr:null,ticket_available:!!(ke!=null&&ke.ticket_available),price_range:(Or=ke==null?void 0:ke.price_range)!=null?Or:null,ticket_urls:(ke==null?void 0:ke.ticket_urls)||[],poster_image_url:(An=St==null?void 0:St.poster_image_url)!=null?An:null,event_media_url:(Br=St==null?void 0:St.event_media_url)!=null?Br:null,images:(zn=St==null?void 0:St.images)!=null?zn:null,media_urls:(la=St==null?void 0:St.media_urls)!=null?la:null,setlist:null,setlist_enriched:null,setlist_song_count:null,setlist_fm_id:null,setlist_fm_url:null,setlist_source:null,setlist_last_updated:null,tour_name:(Da=ke==null?void 0:ke.tour_name)!=null?Da:null,created_at:Xe.created_at,updated_at:Xe.created_at};return(Tn=ke==null?void 0:ke.title)!=null&&Tn.includes("Anotha")&&console.log("ProfileView: Processed Anotha event:",{processedEvent:_t,title:_t.title,artist_name:_t.artist_name,venue_name:_t.venue_name,venue_city:_t.venue_city,venue_state:_t.venue_state}),_t}))||[]).filter(Xe=>!wt.has(Xe.id));console.log("ProfileView: Final filtered events:",Le.map(Xe=>({title:Xe.title,artist_name:Xe.artist_name,venue_name:Xe.venue_name}))),x(Le),console.log(" ProfileView: fetchUserEvents completed successfully")}catch(ye){console.error(" ProfileView: Error fetching user events:",ye),x([])}finally{w(!1)}}),Fe=b?$de(g):Ide(g),ft=()=>E(void 0,null,function*(){var ye;try{if(qe||!ue){console.log("Session expired or no user, skipping reviews fetch");return}console.log(" ProfileView: Fetching reviews for user:",ct),console.log(" ProfileView: isViewingOwnProfile:",pt),console.log(" ProfileView: Session user:",ue==null?void 0:ue.id);let Ie;try{Ie=yield cs.getUserReviewHistory(ct),console.log(" ProfileView: Raw review data:",Ie),console.log(" ProfileView: Number of reviews in result:",Ie.reviews.length),Ie.reviews.length>0&&console.log(" ProfileView: First review event data:",{reviewId:Ie.reviews[0].review.id,eventId:Ie.reviews[0].review.event_id,event:Ie.reviews[0].event,eventTitle:(ye=Ie.reviews[0].event)==null?void 0:ye.title})}catch(Le){console.error(" ProfileView: Error calling ReviewService.getUserReviewHistory:",Le),A([]);return}const dt=Ie.reviews.filter(Le=>!(!pt&&!Le.review.is_public||Le.review.review_text==="ATTENDANCE_ONLY"&&!Le.review.was_there)).map(Le=>{var St,_t,Fr,dn,En,Dt,ur,or,Wt,Sr,yn,nr;let Xe;const ke=Le.review.event_date||Le.review.Event_date;if(ke){if(ke instanceof Date)Xe=ke;else if(typeof ke=="string"){const[Cr,Cn,Ht]=ke.split("-").map(Number);if(Cr&&Cn&&Ht){const cr=new Date(Cr,Cn-1,Ht);isNaN(cr.getTime())||(Xe=cr)}}}return{id:Le.review.id,user_id:Le.review.user_id,event_id:Le.review.event_id,artist_id:Le.review.artist_id,venue_id:Le.review.venue_id,rating:Le.review.rating,rank_order:Le.review.rank_order,artist_performance_rating:Le.review.artist_performance_rating,production_rating:Le.review.production_rating,venue_rating:Le.review.venue_rating,location_rating:Le.review.location_rating,value_rating:Le.review.value_rating,review_text:Le.review.review_text,reaction_emoji:Le.review.reaction_emoji,artist_performance_feedback:Le.review.artist_performance_feedback,production_feedback:Le.review.production_feedback,venue_feedback:Le.review.venue_feedback,location_feedback:Le.review.location_feedback,value_feedback:Le.review.value_feedback,photos:Le.review.photos||[],videos:Le.review.videos||[],setlist:Le.review.setlist,is_public:Le.review.is_public,is_draft:Le.review.is_draft||!1,was_there:Le.review.was_there,created_at:Le.review.created_at,ticket_price_paid:Le.review.ticket_price_paid,category_average:hr(Le.review),event_date:Xe,artist_name:(St=Le.event)==null?void 0:St.artist_name,venue_name:(_t=Le.event)==null?void 0:_t.venue_name,jambase_events:Le.event||null,event:{event_name:((Fr=Le.event)==null?void 0:Fr.title)||((dn=Le.event)!=null&&dn.artist_name&&((En=Le.event)!=null&&En.venue_name)?`${Le.event.artist_name} at ${Le.event.venue_name}`:((Dt=Le.event)==null?void 0:Dt.event_name)||"Concert Review"),location:((ur=Le.event)==null?void 0:ur.venue_name)||"Unknown Venue",artist_name:(or=Le.event)==null?void 0:or.artist_name,venue_name:(Wt=Le.event)==null?void 0:Wt.venue_name,event_date:Xe?Xe.toISOString().split("T")[0]:((Sr=Le.event)==null?void 0:Sr.event_date)||Le.review.created_at,event_time:((yn=Le.event)==null?void 0:yn.event_time)||((nr=Le.event)==null?void 0:nr.doors_time)||"TBD",_fullEvent:Le.event||null}}});console.log(" ProfileView: Transformed reviews:",dt),console.log(" ProfileView: Number of transformed reviews:",dt.length);const wt=dt.filter(Le=>Le.setlist);console.log(" ProfileView: Reviews with setlist:",wt.length,wt);const ht=dt.filter(Le=>!(Le.review_text==="ATTENDANCE_ONLY"&&!Le.was_there));console.log(" ProfileView: Reviews for PostsGrid:",ht.length),console.log(" ProfileView: Reviews for PostsGrid (first 3):",ht.slice(0,3).map(Le=>{var Xe;return{id:Le.id,event_name:(Xe=Le.event)==null?void 0:Xe.event_name,review_text:Le.review_text,was_there:Le.was_there}})),A(dt)}catch(Ie){console.error(" ProfileView: Error fetching reviews:",Ie),A([])}}),Et=()=>E(void 0,null,function*(){try{console.log(" ProfileView: Fetching reviews count for user:",ct);let ye=T.from("reviews").select("id, was_there, review_text, is_public",{count:"exact"}).eq("user_id",ct).eq("is_draft",!1);pt||(ye=ye.eq("is_public",!0));const{data:Ie,count:dt,error:wt}=yield ye;if(wt){console.error(" ProfileView: Error fetching reviews count:",wt),I(0);return}const Le=(Ie||[]).filter(Xe=>!!(Xe.was_there===!0||Xe.review_text&&Xe.review_text!=="ATTENDANCE_ONLY")).length;console.log(" ProfileView: Reviews count (raw):",dt),console.log(" ProfileView: Reviews count (filtered):",Le),I(Le)}catch(ye){console.error(" ProfileView: Error fetching reviews count:",ye),I(0)}}),hr=ye=>{if(typeof ye.rating=="number")return ye.rating;if(typeof ye.rating=="string"){const Ie=parseFloat(ye.rating);return isNaN(Ie)?null:Ie}return ye.rating===null||ye.rating===void 0?null:ye.rating==="good"?5:ye.rating==="okay"?3:ye.rating==="bad"?1:null},dr=ye=>{const Ie=hr(ye);return parseFloat(Ie.toFixed(1))},cn=()=>E(void 0,null,function*(){try{if(qe||!ue){console.log("Session expired or no user, skipping friends fetch");return}const ye=yield Mu.getFriends(ct);B(ye)}catch(ye){console.warn("Warning: Error fetching friends:",ye),B([])}}),mn=()=>E(void 0,null,function*(){try{if(qe||!ue){console.log("Session expired or no user, skipping followed artists count fetch");return}console.log(" ProfileView: Fetching artist follows count for user:",ct),console.log(" ProfileView: Current authenticated user:",ue==null?void 0:ue.id);const ye=yield Oge.getArtistFollowsCount(ct);console.log(" ProfileView: Artist follows count:",ye);const Ie=yield ki.getUserFollowedArtists(ct);console.log(" ProfileView: Followed artists array length:",Ie.length),console.log(" ProfileView: Artist names:",Ie.map(wt=>wt.artist_name));const dt=ye!==Ie.length?Ie.length:ye;ye!==Ie.length&&console.warn(` ProfileView: Count mismatch! Service count: ${ye}, Array length: ${Ie.length}. Using array length.`),Ge(dt),console.log(" ProfileView: Final artist follows count set to:",dt)}catch(ye){console.error("Error fetching followed artists count:",ye),Ge(0)}}),je=()=>E(void 0,null,function*(){try{if(qe||!ue){console.log("Session expired or no user, skipping attended events fetch");return}console.log(" ProfileView: Fetching attended events for user:",ct),Y(!0);const{data:ye,error:Ie}=yield T.from("reviews").select(`
          id, 
          event_id, 
          rating, 
          review_text, 
          was_there, 
          is_public, 
          created_at, 
          updated_at
        `).eq("user_id",ct).eq("is_draft",!1).order("created_at",{ascending:!1});if(Ie){console.error("Error fetching attended events:",Ie),Z([]);return}if(!ye||ye.length===0){Z([]);return}const dt=ye.map(_t=>_t.event_id).filter(Boolean),wt=new Map;if(dt.length>0){const{data:_t}=yield T.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date, venue_city, venue_state, setlist").in("id",dt);_t&&_t.forEach(Fr=>{wt.set(Fr.id,Fr)})}const ht=ye.map(_t=>V(D({},_t),{events:wt.get(_t.event_id)}));console.log(" ProfileView: Attended events data (raw):",ht),console.log(" ProfileView: Total attended events fetched (raw):",ht==null?void 0:ht.length);const Le=(ht||[]).filter(_t=>!!(_t.was_there===!0||_t.review_text&&_t.review_text!=="ATTENDANCE_ONLY"));console.log(" ProfileView: Attended events data (filtered):",Le),console.log(" ProfileView: Total attended events fetched (filtered):",Le==null?void 0:Le.length);const Xe=(Le==null?void 0:Le.filter(_t=>_t.review_text&&_t.review_text!=="ATTENDANCE_ONLY").length)||0,ke=(Le==null?void 0:Le.filter(_t=>_t.review_text==="ATTENDANCE_ONLY").length)||0,St=(Le==null?void 0:Le.filter(_t=>!_t.review_text).length)||0;if(console.log(" Event breakdown:"),console.log(`   With reviews: ${Xe}`),console.log(`   Attendance only: ${ke}`),console.log(`   No review: ${St}`),console.log(`   Total: ${Le==null?void 0:Le.length}`),Le&&Le.length>0){const _t=Le.map(Fr=>V(D({},Fr),{jambase_events:Fr.events||null}));Z(_t)}else Z([])}catch(ye){console.error("Error fetching attended events:",ye),Z([])}finally{Y(!1)}}),pe=()=>E(void 0,null,function*(){var ye,Ie,dt,wt,ht,Le,Xe;try{if(qe||!ue){console.log("Session expired or no user, skipping draft reviews fetch");return}if(console.log(" ProfileView: Fetching draft reviews for user:",ct),_e(!0),!pt){se([]);return}const{data:ke,error:St}=yield T.from("reviews").select("id, event_id, is_draft, draft_data, last_saved_at").eq("user_id",ct).eq("is_draft",!0);St&&console.error(" ProfileView: Error fetching drafts directly:",St),console.log(" ProfileView: All drafts from database (direct query):",(ke==null?void 0:ke.length)||0);const _t=yield Jh.getUserDrafts(ct);console.log(" ProfileView: Drafts from RPC function:",(_t==null?void 0:_t.length)||0);const{data:Fr}=yield T.from("reviews").select(`
          event_id,
          event:events!inner(
            id,
            artist_id,
            venue_id,
            event_date
          )
        `).eq("user_id",ct).eq("is_draft",!1).not("review_text","is",null).neq("review_text","ATTENDANCE_ONLY"),dn=new Set((Fr||[]).map(nr=>nr.event_id).filter(Boolean)),En=Array.from(dn);let Dt=new Map;if(En.length>0){const{data:nr}=yield T.from("events_with_artist_venue").select("id, artist_name_normalized, venue_name_normalized").in("id",En);nr&&nr.forEach(Cr=>{Dt.set(Cr.id,{artist_name:Cr.artist_name_normalized||"",venue_name:Cr.venue_name_normalized||""})})}const ur=new Map;(Fr||[]).forEach(nr=>{if(nr.event){const Cr=Dt.get(nr.event.id),Cn=(Cr==null?void 0:Cr.artist_name)||"",Ht=(Cr==null?void 0:Cr.venue_name)||"",cr=`${Cn.toLowerCase().trim()}|${Ht.toLowerCase().trim()}|${nr.event.event_date}`;ur.set(cr,nr)}}),console.log(" ProfileView: Published review event IDs:",Array.from(dn)),console.log(" ProfileView: Published reviews by concert:",ur.size);const or=nr=>{if(!nr)return null;try{return new Date(nr).toISOString().split("T")[0]}catch(Cr){return nr}},Wt=[],Sr=[];for(const nr of _t||[]){if(!nr.event_id){console.log(" ProfileView: Draft has no event_id:",nr.id);continue}let Cr=!1,Cn="";if(dn.has(nr.event_id))Cr=!0,Cn=`published review exists for event ${nr.event_id}`;else{const cr=nr.artist_name||((Ie=(ye=nr.draft_data)==null?void 0:ye.selectedArtist)==null?void 0:Ie.name),In=nr.venue_name||((wt=(dt=nr.draft_data)==null?void 0:dt.selectedVenue)==null?void 0:wt.name),bs=nr.event_date||((ht=nr.draft_data)==null?void 0:ht.eventDate);if(cr&&In&&bs){const is=or(bs),zr=cr.toLowerCase().trim(),Or=In.toLowerCase().trim();for(const[An]of ur.entries()){const[Br,zn,la]=An.split("|"),Da=or(la);if(Br===zr&&zn===Or&&Da===is){Cr=!0,Cn=`published review exists for same concert (${cr} at ${In})`;break}}}}Cr?(Wt.push(nr.id),console.log(` ProfileView: Marked draft ${nr.id} for deletion - ${Cn}`)):Sr.push(nr)}if(Wt.length>0){console.log(` ProfileView: Deleting ${Wt.length} orphaned draft(s)...`);const nr=Wt.map(cr=>E(void 0,null,function*(){try{const{error:In}=yield T.from("reviews").delete().eq("id",cr);return In?(console.error(` ProfileView: Failed to delete orphaned draft ${cr}:`,In),{success:!1,draftId:cr,error:In}):(console.log(` ProfileView: Successfully deleted orphaned draft ${cr}`),{success:!0,draftId:cr})}catch(In){return console.error(` ProfileView: Exception deleting orphaned draft ${cr}:`,In),{success:!1,draftId:cr,error:In}}})),Cr=yield Promise.all(nr),Cn=Cr.filter(cr=>cr.success).length,Ht=Cr.filter(cr=>!cr.success);if(Ht.length>0){console.error(` ProfileView: Failed to delete ${Ht.length} draft(s):`,Ht);const cr=new Set(Ht.map(bs=>bs.draftId)),In=(_t||[]).filter(bs=>cr.has(bs.id));Sr.push(...In)}console.log(` ProfileView: Deletion complete - ${Cn} successful, ${Ht.length} failed`)}const yn=Sr;if(ke)for(const nr of ke){let Cr=!1;if(nr.event_id&&dn.has(nr.event_id)&&(console.log(` ProfileView: Found orphaned draft ${nr.id} in database (same event_id) - deleting`),Cr=!0),!Cr&&nr.draft_data){const Cn=nr.draft_data,Ht=(Le=Cn==null?void 0:Cn.selectedArtist)==null?void 0:Le.name,cr=(Xe=Cn==null?void 0:Cn.selectedVenue)==null?void 0:Xe.name,In=Cn==null?void 0:Cn.eventDate;if(Ht&&cr&&In){const bs=zr=>{if(!zr)return null;try{return new Date(zr).toISOString().split("T")[0]}catch(Or){return zr}},is=bs(In);for(const[zr]of ur.entries()){const[Or,An,Br]=zr.split("|"),zn=bs(Br);if(Or===Ht&&An===cr&&zn===is){console.log(` ProfileView: Found orphaned draft ${nr.id} in database (same concert) - deleting`),Cr=!0;break}}}}Cr&&(yield T.from("reviews").delete().eq("id",nr.id))}console.log(" ProfileView: Draft reviews data (final):",yn),console.log(" ProfileView: Total valid draft reviews (after filtering):",yn==null?void 0:yn.length),se(yn)}catch(ke){console.error("Error fetching draft reviews:",ke),se([])}finally{_e(!1)}}),Pe=()=>E(void 0,null,function*(){try{if(qe||!ue||!pt)return;const ye=yield Bo.getPassportProgress(ct);Tt({cities:ye.cities.length,venues:ye.venues.length,artists:ye.artists.length,scenes:ye.scenes.length})}catch(ye){console.error("Error loading passport summary:",ye)}}),Ne=()=>E(void 0,null,function*(){try{if(qe||!ue||pt)return;const{data:ye,error:Ie}=yield T.from("user_relationships").select("id, status").eq("relationship_type","friend").or(`and(user_id.eq.${e},related_user_id.eq.${ct}),and(user_id.eq.${ct},related_user_id.eq.${e})`).in("status",["accepted"]).limit(1);if(Ie){console.warn("Warning: Could not check friendship status:",Ie);return}if(ye&&ye.length>0){Ae("friends");return}const{data:dt,error:wt}=yield T.from("user_relationships").select("id").eq("user_id",e).eq("related_user_id",ct).eq("relationship_type","friend").eq("status","pending").limit(1);if(wt){console.warn("Warning: Could not check sent friend requests:",wt);return}if(dt&&dt.length>0){Ae("pending_sent"),gt(dt[0].id);return}const{data:ht,error:Le}=yield T.from("user_relationships").select("id").eq("user_id",ct).eq("related_user_id",e).eq("relationship_type","friend").eq("status","pending").limit(1);if(Le){console.warn("Warning: Could not check received friend requests:",Le);return}if(ht&&ht.length>0){Ae("pending_received");return}Ae("none")}catch(ye){console.warn("Warning: Error checking friend status:",ye),Ae("none")}}),Ye=()=>E(void 0,null,function*(){try{if(qe||!ue||pt)return;console.log("Sending friend request to:",ct);const{data:ye,error:Ie}=yield T.rpc("create_friend_request",{receiver_user_id:ct});if(Ie)throw console.error("Error creating friend request:",Ie),Ie;let dt=null;ye?dt=ye:dt=yield Mu.getPendingRequestId(e,ct),gt(dt),Ae("pending_sent"),at({title:"Friend Request Sent! ",description:"Your friend request has been sent and they'll be notified."})}catch(ye){console.error("Error sending friend request:",ye),at({title:"Error",description:ye.message||"Failed to send friend request. Please try again.",variant:"destructive"})}}),We=ye=>E(void 0,null,function*(){var Ie;try{if(qe||!ue)return;console.log("Unfriending user:",ye),yield Mu.unfriendUser(ye),B(dt=>dt.filter(wt=>wt.user_id!==ye)),ct===ye&&Ae("none"),yield cn(),at({title:"Friend Removed",description:"You are no longer friends with this person."})}catch(dt){if(console.error("Error unfriending user:",dt),(Ie=dt==null?void 0:dt.message)!=null&&Ie.includes("Friendship does not exist")){B(wt=>wt.filter(ht=>ht.user_id!==ye)),ct===ye&&Ae("none"),yield cn();return}throw at({title:"Error",description:dt.message||"Failed to unfriend user. Please try again.",variant:"destructive"}),dt}}),It=ye=>E(void 0,null,function*(){if(k(!1),z(null),ye!=null&&ye.event_id)try{console.log(" ProfileView: NUCLEAR deletion of drafts for event:",ye.event_id);const{error:Ie}=yield T.from("reviews").delete().eq("user_id",e).eq("event_id",ye.event_id).eq("is_draft",!0);Ie?console.error(" ProfileView: Failed to delete drafts:",Ie):console.log(" ProfileView: Deleted all drafts for event:",ye.event_id)}catch(Ie){console.error(" ProfileView: Exception deleting drafts:",Ie)}yield new Promise(Ie=>setTimeout(Ie,1e3)),yield Promise.all([ft(),je(),pe()]),at({title:"Review Added",description:"Your concert review has been added!"})}),jt=ye=>{var dt,wt,ht,Le,Xe,ke,St,_t;let Ie;ye.event_date instanceof Date?Ie=ye.event_date.toISOString().split("T")[0]:typeof ye.event_date=="string"?Ie=ye.event_date:Ie=((dt=ye.event)==null?void 0:dt.event_date)||ye.created_at,z({id:ye.event_id,title:((wt=ye.event)==null?void 0:wt.event_name)||"Concert Review",venue_name:((ht=ye.event)==null?void 0:ht.venue_name)||((Le=ye.event)==null?void 0:Le.location)||"Unknown Venue",event_date:Ie,artist_name:((Xe=ye.event)==null?void 0:Xe.artist_name)||"Unknown Artist",existing_review_id:ye.id,existing_review:{rating:ye.rating,review_text:ye.review_text,artist_performance_rating:ye.artist_performance_rating,production_rating:ye.production_rating,venue_rating:ye.venue_rating,location_rating:ye.location_rating,value_rating:ye.value_rating,artist_performance_feedback:ye.artist_performance_feedback,production_feedback:ye.production_feedback,venue_feedback:ye.venue_feedback,location_feedback:ye.location_feedback,value_feedback:ye.value_feedback,ticket_price_paid:ye.ticket_price_paid,reaction_emoji:ye.reaction_emoji,is_public:ye.is_public,review_type:ye.review_type,event_date:ye.event_date||((ke=ye.event)==null?void 0:ke.event_date)||ye.created_at,artist_name:(St=ye.event)==null?void 0:St.artist_name,venue_name:(_t=ye.event)==null?void 0:_t.venue_name,venue_id:ye.venue_id}}),k(!0)},Ee=ye=>E(void 0,null,function*(){try{console.log(" ProfileView: Deleting review:",{userId:e,reviewId:ye}),yield cs.deleteEventReview(e,ye),console.log(" ProfileView: Review deleted successfully"),ft(),at({title:"Review Deleted",description:"Your review has been deleted."})}catch(Ie){console.error(" ProfileView: Error deleting review:",Ie),at({title:"Error",description:`Failed to delete review: ${Ie instanceof Error?Ie.message:"Unknown error"}`,variant:"destructive"})}});return _||!m?s.jsx(A1,{text:"Loading profile..."}):m?(console.log(" ProfileView: Rendering profile for:",m.name),s.jsxs("div",{className:"min-h-screen w-full max-w-[393px] mx-auto overflow-x-hidden",style:{backgroundColor:"var(--neutral-50)"},children:[!u&&s.jsx(Qo,{menuOpen:d,onMenuClick:f,children:s.jsx("h1",{className:"font-bold truncate text-center",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:m.username?`@${m.username}`:m.name||"Profile"})}),s.jsxs("div",{className:"w-full max-w-full overflow-x-hidden",style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:u?"calc(env(safe-area-inset-top, 0px) + var(--spacing-small, 12px))":"calc(env(safe-area-inset-top, 0px) + 68px + var(--spacing-small, 12px))",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[s.jsxs("div",{className:"mb-6 relative w-full max-w-full",style:{padding:"var(--spacing-grouped, 24px) 0",border:"none"},children:[s.jsxs("div",{className:"flex flex-col items-center gap-4 mb-4 w-full max-w-full",children:[s.jsx("div",{className:"w-full flex justify-center",children:s.jsxs("div",{className:"relative",style:{display:"flex",alignItems:"flex-start",gap:"6px"},children:[s.jsxs("div",{className:"relative",children:[s.jsx(fc,{variant:"userProfile",name:m.name,username:m.username||void 0,initial:m.name.charAt(0).toUpperCase(),imageUrl:m.avatar_url,followers:M.length,following:Ce,events:R,onFollowersClick:()=>{ze("friends"),De(!0)},onFollowingClick:()=>rr(!0)}),!pt&&m.last_active_at&&s.jsx("div",{className:"absolute bottom-0 left-0 w-6 h-6 rounded-full border-2",style:{backgroundColor:"var(--status-success-500)",borderColor:"var(--neutral-50)"},children:s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:"var(--neutral-50)"}})})})]}),m.verified&&m.account_type&&s.jsx("div",{style:{marginTop:"2px"},children:s.jsx(PT,{accountType:m.account_type,verified:m.verified,size:"lg"})})]})}),!pt&&m.last_active_at&&s.jsx("div",{className:"w-full flex justify-center",children:s.jsxs(et,{variant:"secondary",className:"flex items-center gap-1 bg-green-100 text-green-700 border-green-200",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[s.jsx(Oa,{size:16}),Qh.formatLastActive(m.last_active_at)]})}),s.jsx("div",{className:"w-full max-w-full",children:s.jsx("div",{className:"flex flex-wrap items-center gap-2 w-full max-w-full",children:pt?s.jsxs(s.Fragment,{children:[s.jsxs(ce,{onClick:n,variant:"default",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",boxShadow:"0 4px 4px 0 var(--shadow-color)",border:"none"},onMouseEnter:ye=>{ye.currentTarget.style.backgroundColor="var(--brand-pink-600)"},onMouseLeave:ye=>{ye.currentTarget.style.backgroundColor="var(--brand-pink-500)"},children:[s.jsx(Ol,{size:16,style:{marginRight:"var(--spacing-inline, 6px)",color:"var(--neutral-50)"}}),s.jsx("span",{style:{color:"var(--neutral-50)"},children:"Edit Profile"})]}),s.jsx(ce,{onClick:a,variant:"secondary",size:"icon",style:{width:"44px",height:"44px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"var(--neutral-50)",border:"2px solid var(--neutral-200)",color:"var(--neutral-900)"},"aria-label":"Profile settings",children:s.jsx(FP,{size:24,style:{color:"var(--neutral-900)"}})})]}):s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[sr==="none"&&s.jsxs(ce,{onClick:Ye,variant:"default",size:"sm",className:"shadow-md",style:{backgroundColor:"var(--status-success-500)",color:"var(--neutral-50)"},onMouseEnter:ye=>{ye.currentTarget.style.opacity="0.9"},onMouseLeave:ye=>{ye.currentTarget.style.opacity="1"},"aria-label":"Send friend request",children:[s.jsx(Yo,{size:16,className:"mr-2"}),"Add Friend"]}),sr==="pending_sent"&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ce,{disabled:!0,variant:"outline",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderColor:"var(--neutral-200)",color:"var(--neutral-600)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:"Friend Request Sent"}),s.jsx(ce,{onClick:()=>E(void 0,null,function*(){if(!Ue){at({title:"Cannot Cancel",description:"Request ID not available. Please refresh the page.",variant:"destructive"});return}try{yield Mu.cancelFriendRequest(Ue),Ae("none"),gt(null),at({title:"Request Cancelled",description:"Friend request has been cancelled."})}catch(ye){at({title:"Error",description:ye.message||"Failed to cancel request.",variant:"destructive"})}}),disabled:!Ue,variant:"outline",size:"sm",className:"disabled:opacity-50 disabled:cursor-not-allowed",style:{borderColor:"var(--neutral-200)",color:"var(--neutral-600)"},title:Ue?"Cancel friend request":"Request ID not available",children:"Cancel"})]}),sr==="pending_received"&&s.jsx(ce,{disabled:!0,variant:"outline",size:"sm",style:{borderColor:"var(--info-blue-500)",color:"var(--info-blue-500)",backgroundColor:"var(--state-disabled-bg)",cursor:"not-allowed"},"aria-label":"Friend request already sent","aria-disabled":"true",children:"Respond to Request"}),sr==="friends"&&s.jsx(ce,{onClick:()=>We(ct),variant:"outline",size:"sm",className:"border",style:{color:"var(--status-error-500)",borderColor:"var(--status-error-500)"},onMouseEnter:ye=>{ye.currentTarget.style.backgroundColor="var(--status-error-050)",ye.currentTarget.style.color="var(--status-error-500)"},onMouseLeave:ye=>{ye.currentTarget.style.backgroundColor="transparent",ye.currentTarget.style.color="var(--status-error-500)"},"aria-label":"Unfriend user",children:"Unfriend"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>Te(!0),className:"p-2",style:{color:"var(--neutral-600)"},onMouseEnter:ye=>{ye.currentTarget.style.color="var(--status-error-500)",ye.currentTarget.style.backgroundColor="var(--status-error-050)"},onMouseLeave:ye=>{ye.currentTarget.style.color="var(--neutral-600)",ye.currentTarget.style.backgroundColor="transparent"},"aria-label":"Block user",children:s.jsx(H_,{size:16})}),s.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>me(!0),className:"p-2",style:{color:"var(--neutral-600)"},onMouseEnter:ye=>{ye.currentTarget.style.color="var(--status-error-500)",ye.currentTarget.style.backgroundColor="var(--status-error-050)"},onMouseLeave:ye=>{ye.currentTarget.style.color="var(--neutral-600)",ye.currentTarget.style.backgroundColor="transparent"},"aria-label":"Block user",children:s.jsx(eo,{size:16})})]})]})})})]}),s.jsxs("div",{style:{paddingTop:"var(--spacing-grouped, 24px)"},children:[m.bio&&s.jsx("div",{className:"mb-4",children:s.jsx("p",{className:"leading-relaxed",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:m.bio})}),s.jsxs("div",{className:"flex flex-wrap gap-3",children:[m.instagram_handle&&s.jsxs(ce,{variant:"outline",size:"sm",onClick:()=>window.open(`https://instagram.com/${m.instagram_handle}`,"_blank"),style:{borderColor:"var(--neutral-200)",color:"var(--neutral-900)"},children:[s.jsx(DP,{size:16,className:"mr-2"}),"@",m.instagram_handle]}),!pt&&m.music_streaming_profile&&(()=>{const ye=E7(m.music_streaming_profile),Ie=ye==="spotify",dt=ye==="apple-music";let wt=m.music_streaming_profile,ht=m.music_streaming_profile;return Ie?(wt=m.music_streaming_profile.startsWith("http")?m.music_streaming_profile:`https://open.spotify.com/user/${m.music_streaming_profile}`,ht="Spotify Profile"):dt&&(wt=(m.music_streaming_profile.startsWith("http"),m.music_streaming_profile),ht="Apple Music Profile"),s.jsxs(ce,{variant:"outline",onClick:()=>window.open(wt,"_blank"),style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[s.jsx(Ft,{size:16,style:{marginRight:"var(--spacing-inline, 6px)"}}),ht]})})()]}),s.jsx("div",{"aria-hidden":"true",style:{height:"1px",backgroundColor:"var(--neutral-200)",width:"100%",marginTop:"var(--spacing-grouped, 24px)"}})]})]}),pt&&!de&&Array.isArray(X)&&X.length>0&&s.jsx("div",{className:"mb-6",children:s.jsx(Dge,{draftCount:X.length,onClick:()=>q("unreviewed")})}),s.jsxs(zi,{value:F,onValueChange:ye=>{try{Zt.click("profile",`profile_tab_${ye}`,{tab:ye,is_own_profile:pt,profile_user_id:ct},ct)}catch(Ie){console.error("Error tracking profile tab switch:",Ie)}U(ye)},className:"w-full",children:[s.jsxs(wi,{className:`glass-card inner-glow grid w-full max-w-full mb-4 p-1 floating-shadow overflow-x-hidden ${xe?"grid-cols-3":"grid-cols-2"}`,children:[s.jsxs(en,{value:"my-events",className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"w-4 h-4"}),"Events"]}),xe&&s.jsxs(en,{value:"interested",className:"flex items-center gap-2",children:[s.jsx(es,{size:16}),"Interested"]}),s.jsxs(en,{value:"passport",className:"flex items-center gap-2",children:[s.jsx(Fl,{size:16}),"Passport"]})]}),s.jsxs(tn,{value:"my-events",className:"mt-4 mb-32 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"flex flex-col gap-3 mb-4 p-2 w-full max-w-full",children:[s.jsx("h3",{className:"gradient-text font-semibold",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)"},children:pt?"My Events":`${(m==null?void 0:m.name)||"User"}'s Events`}),pt&&s.jsxs("div",{className:"flex flex-col gap-2 w-full max-w-full",children:[s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:"View mode:"}),s.jsxs("div",{className:"flex w-full max-w-full overflow-x-auto",style:{padding:"var(--spacing-inline, 6px)",gap:"var(--spacing-inline, 6px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-100)",border:"1px solid var(--neutral-200)"},children:[s.jsx("button",{onClick:()=>q(!1),className:"transition-colors",style:{paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",height:"var(--size-button-height, 36px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",backgroundColor:H?"transparent":"var(--neutral-50)",color:H?"var(--neutral-600)":"var(--neutral-900)"},children:"Reviews"}),s.jsx("button",{onClick:()=>q(!0),className:"transition-colors",style:{paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",height:"var(--size-button-height, 36px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",backgroundColor:H?"var(--neutral-50)":"transparent",color:H?"var(--neutral-900)":"var(--neutral-600)"},children:"Rankings"}),s.jsx("button",{onClick:()=>q("unreviewed"),className:"transition-colors",style:{paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",height:"var(--size-button-height, 36px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",backgroundColor:H==="unreviewed"?"var(--neutral-50)":"transparent",color:H==="unreviewed"?"var(--neutral-900)":"var(--neutral-600)"},children:"Unreviewed"})]})]})]}),H===!1&&s.jsx(Lge,{reviews:C,onSelectReview:ye=>{we(ye),ae(!0)}}),H===!0&&pt&&s.jsx("div",{className:"space-y-6",children:Array.from(new Set(C.filter(Ie=>Ie.review_text!=="ATTENDANCE_ONLY").map(Ie=>{const dt=dr(Ie);return Math.round(dt*10)/10}))).sort((Ie,dt)=>dt-Ie).map(Ie=>{const dt=C.filter(wt=>{if(wt.review_text==="ATTENDANCE_ONLY")return!1;const ht=dr(wt),Le=Math.round(ht*10)/10;return Math.abs(Le-Ie)<.01});return dt.length===0?null:s.jsxs("div",{children:[s.jsxs("div",{className:"font-semibold mb-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[Ie.toFixed(1),""]}),s.jsx("div",{className:"divide-y",style:{backgroundColor:"var(--neutral-50)",border:"1px solid var(--neutral-200)",borderRadius:"var(--radius-corner, 10px)",padding:"var(--spacing-small, 12px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"},children:dt.sort((wt,ht)=>{var ke,St;const Le=(ke=wt.rank_order)!=null?ke:9999,Xe=(St=ht.rank_order)!=null?St:9999;return Le!==Xe?Le-Xe:new Date(ht.created_at).getTime()-new Date(wt.created_at).getTime()}).map((wt,ht)=>s.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{borderBottom:ht<dt.length-1?"1px solid var(--neutral-200)":"none"},onClick:()=>{we(wt),ae(!0)},onMouseEnter:Le=>{Le.currentTarget.style.backgroundColor="var(--neutral-100)"},onMouseLeave:Le=>{Le.currentTarget.style.backgroundColor="transparent"},children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-6 w-6 rounded-full flex items-center justify-center border",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",backgroundColor:"var(--neutral-50)"},children:ht+1}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:wt.event.event_name}),s.jsx("div",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:(()=>{const Le=(wt.event_date instanceof Date?wt.event_date:wt.event_date?new Date(wt.event_date):null)||(wt.event.event_date?new Date(wt.event.event_date):null);return Le?Le.toLocaleDateString():""})()})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[ht>0&&s.jsx(ce,{size:"icon",variant:"ghost",onClick:Le=>{Le.stopPropagation();const Xe=dt.slice().sort((St,_t)=>(St.rank_order||9999)-(_t.rank_order||9999)),ke=Xe.findIndex(St=>St.id===wt.id);if(ke>0){const[St]=Xe.splice(ke,1);Xe.splice(ke-1,0,St),E(void 0,null,function*(){yield cs.setRankOrderForRatingGroup(e,Ie,Xe.map(_t=>_t.id)),ft()})}},children:""}),ht<dt.length-1&&s.jsx(ce,{size:"icon",variant:"ghost",onClick:Le=>{Le.stopPropagation();const Xe=dt.slice().sort((St,_t)=>(St.rank_order||9999)-(_t.rank_order||9999)),ke=Xe.findIndex(St=>St.id===wt.id);if(ke!==-1&&ke<Xe.length-1){const[St]=Xe.splice(ke,1);Xe.splice(ke+1,0,St),E(void 0,null,function*(){yield cs.setRankOrderForRatingGroup(e,Ie,Xe.map(_t=>_t.id)),ft()})}},children:""})]})]},wt.id))})]},Ie)})}),H==="unreviewed"&&pt&&s.jsx("div",{className:"space-y-4",children:ne||de?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-3"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:"Loading unreviewed events and drafts..."})]}):(()=>{const ye=K.filter(ht=>ht.review_text==="ATTENDANCE_ONLY"),Ie=new Set(C.filter(ht=>{const Le=ht.is_draft===!0,Xe=ht.review_text==="ATTENDANCE_ONLY",ke=ht.review_text&&ht.review_text.trim().length>0;return!Le&&ke&&!Xe}).map(ht=>ht.event_id).filter(Boolean)),dt=X.filter(ht=>{const Le=ht.event_id;return Le?!Ie.has(Le):!1}),wt=[...ye.map(ht=>({type:"unreviewed",data:ht})),...dt.map(ht=>({type:"draft",data:ht}))];return wt.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Lt,{className:"w-16 h-16 mx-auto mb-4",style:{color:"var(--neutral-200)"},"aria-hidden":"true"}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",marginBottom:"var(--spacing-small, 12px)"},children:"All Caught Up!"}),s.jsx("p",{className:"mb-4",style:{color:"var(--neutral-600)"},children:"You've reviewed all the events you've attended and have no draft reviews. Great job!"})]}):s.jsx("div",{className:"space-y-4",children:wt.map(ht=>{if(ht.type==="unreviewed"){const Le=ht.data,Xe=Le.jambase_events;return s.jsx(Ze,{className:"overflow-hidden cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{const ke=Xe.jambase_event||Xe,St=V(D({},ke),{id:ke.id||Xe.id||Le.event_id,title:ke.title||Xe.title||"Unknown Event",artist_name:ke.artist_name||Xe.artist_name||"Unknown Artist",venue_name:ke.venue_name||Xe.venue_name||"Unknown Venue",event_date:ke.event_date||Xe.event_date||new Date().toISOString(),venue_city:ke.venue_city||Xe.venue_city||null,venue_state:ke.venue_state||Xe.venue_state||null,setlist:ke.setlist||Xe.setlist||null,setlist_song_count:ke.setlist_song_count||Xe.setlist_song_count||null,setlist_fm_url:ke.setlist_fm_url||Xe.setlist_fm_url||null});console.log("ProfileView: Complete event data for modal:",{originalEvent:Xe,completeEvent:St,attendanceEventId:Le.event_id}),ie(St),G(!0)},children:s.jsxs(tt,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-lg font-semibold mb-2",style:{color:"var(--neutral-900)"},children:Xe.title}),s.jsxs("div",{className:"flex items-center gap-4 text-sm mb-3",style:{color:"var(--neutral-600)"},children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ft,{className:"w-4 h-4"}),s.jsx("span",{children:Xe.artist_name})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(yr,{className:"w-4 h-4"}),s.jsx("span",{children:Xe.venue_name}),Xe.venue_city&&s.jsxs("span",{style:{color:"var(--neutral-400)"},children:[" ",Xe.venue_city,", ",Xe.venue_state]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"w-4 h-4"}),s.jsx("span",{children:new Date(Xe.event_date).toLocaleDateString()})]})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(et,{variant:"outline",className:"text-orange-600 border-orange-300",children:[s.jsx(Lt,{className:"w-3 h-3 mr-1"}),"Needs Review"]})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs",style:{color:"var(--neutral-600)"},children:["Attended on ",new Date(Le.created_at).toLocaleDateString()]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(ce,{size:"sm",variant:"outline",onClick:ke=>{ke.stopPropagation();const St=Xe.jambase_event||Xe,_t=V(D({},St),{id:St.id||Xe.id||Le.event_id,title:St.title||Xe.title||"Unknown Event",artist_name:St.artist_name||Xe.artist_name||"Unknown Artist",venue_name:St.venue_name||Xe.venue_name||"Unknown Venue",event_date:St.event_date||Xe.event_date||new Date().toISOString(),venue_city:St.venue_city||Xe.venue_city||null,venue_state:St.venue_state||Xe.venue_state||null,setlist:St.setlist||Xe.setlist||null,setlist_song_count:St.setlist_song_count||Xe.setlist_song_count||null,setlist_fm_url:St.setlist_fm_url||Xe.setlist_fm_url||null});ie(_t),G(!0)},children:[s.jsx(io,{className:"w-4 h-4 mr-2"}),"View Event"]}),s.jsxs(ce,{size:"sm",onClick:ke=>{ke.stopPropagation(),z(Xe),k(!0)},className:"bg-primary hover:bg-primary/90",children:[s.jsx(Xt,{className:"w-4 h-4 mr-2"}),"Add Review"]})]})]})]})},`unreviewed-${Le.id}`)}else if(ht.type==="draft"){const Le=ht.data;return s.jsx(Ze,{className:"overflow-hidden cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{const Xe={id:Le.event_id,title:Le.event_title||"Draft Review",artist_name:Le.artist_name||"Unknown Artist",venue_name:Le.venue_name||"Unknown Venue",event_date:Le.event_date||new Date().toISOString(),venue_city:null,venue_state:null,setlist:null,setlist_song_count:null,setlist_fm_url:null};z(Xe),k(!0)},children:s.jsxs(tt,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-lg font-semibold mb-2",style:{color:"var(--neutral-900)"},children:Le.event_title||"Draft Review"}),s.jsxs("div",{className:"flex items-center gap-4 text-sm mb-3",style:{color:"var(--neutral-600)"},children:[Le.artist_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ft,{className:"w-4 h-4"}),s.jsx("span",{children:Le.artist_name})]}),Le.venue_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(yr,{className:"w-4 h-4"}),s.jsx("span",{children:Le.venue_name})]}),Le.event_date&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"w-4 h-4"}),s.jsx("span",{children:new Date(Le.event_date).toLocaleDateString()})]})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(et,{variant:"outline",style:{color:"var(--info-blue-500)",borderColor:"var(--info-blue-500)"},children:[s.jsx(Ol,{className:"w-3 h-3 mr-1"}),"Draft"]})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs",style:{color:"var(--neutral-600)"},children:["Last saved: ",Le.last_saved_at?new Date(Le.last_saved_at).toLocaleDateString():"Unknown"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(ce,{size:"sm",onClick:Xe=>{Xe.stopPropagation();const ke={id:Le.event_id,title:Le.event_title||"Draft Review",artist_name:Le.artist_name||"Unknown Artist",venue_name:Le.venue_name||"Unknown Venue",event_date:Le.event_date||new Date().toISOString(),venue_city:null,venue_state:null,setlist:null,setlist_song_count:null,setlist_fm_url:null};z(ke),k(!0)},className:"",style:{backgroundColor:"var(--info-blue-500)",color:"var(--neutral-50)"},onMouseEnter:Xe=>{Xe.currentTarget.style.backgroundColor="var(--info-blue-500)"},onMouseLeave:Xe=>{Xe.currentTarget.style.backgroundColor="var(--info-blue-500)"},children:[s.jsx(Ol,{className:"w-4 h-4 mr-2"}),"Continue Draft"]}),s.jsx(ce,{size:"sm",variant:"outline",onClick:Xe=>E(void 0,null,function*(){if(Xe.stopPropagation(),confirm("Are you sure you want to delete this draft? This action cannot be undone."))try{if(yield Jh.deleteDraft(Le.id,e)){const St=yield Jh.getUserDrafts(e);se(St||[]),at({title:"Draft Deleted",description:"The draft has been deleted successfully."})}else at({title:"Error",description:"Failed to delete draft. Please try again.",variant:"destructive"})}catch(ke){console.error("Error deleting draft:",ke),at({title:"Error",description:"Failed to delete draft. Please try again.",variant:"destructive"})}}),className:"border",style:{color:"var(--status-error-500)",borderColor:"var(--status-error-500)"},onMouseEnter:Xe=>{Xe.currentTarget.style.backgroundColor="var(--status-error-050)",Xe.currentTarget.style.color="var(--status-error-500)"},onMouseLeave:Xe=>{Xe.currentTarget.style.backgroundColor="transparent",Xe.currentTarget.style.color="var(--status-error-500)"},children:s.jsx(Ko,{className:"w-4 h-4"})})]})]})]})},`draft-${Le.id}`)}return null})})})()})]}),xe&&s.jsxs(tn,{value:"interested",className:"mt-4 w-full max-w-full overflow-x-hidden",children:[g.length>0&&s.jsx("div",{className:"flex justify-center mb-4 w-full max-w-full",children:s.jsxs("div",{className:"p-1 flex w-full max-w-full",style:{borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-50)"},children:[s.jsx("button",{onClick:()=>N(!1),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${b?"":"shadow-sm"}`,children:"Upcoming"}),s.jsx("button",{onClick:()=>N(!0),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${b?"shadow-sm":""}`,children:"Past"})]})}),g.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12",style:{borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-50)",gap:"var(--spacing-inline, 6px)"},children:[s.jsx(es,{className:"w-[60px] h-[60px] mx-auto",style:{color:"var(--neutral-600)"}}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No Interested Events Yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Tap the heart on events to add them here."})]}):Fe.length===0?s.jsxs("div",{className:"text-center py-12",style:{borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-100)"},children:[s.jsx(es,{className:"w-12 h-12 mx-auto mb-3",style:{color:"var(--neutral-400)"}}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)"},children:b?"No Past Events":"No Upcoming Events"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:b?"You haven't marked any past events as interested.":"You don't have any upcoming events marked as interested."})]}):s.jsx("div",{className:"grid grid-cols-3 gap-2.5 w-full max-w-full",children:Fe.sort((ye,Ie)=>new Date(ye.event_date).getTime()-new Date(Ie.event_date).getTime()).slice(0,9).map(ye=>s.jsx("div",{className:`aspect-square cursor-pointer rounded-xl overflow-hidden hover:shadow-lg transition-all duration-200 relative ${b?"opacity-75":""}`,style:{backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.5)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.08), 0 2px 4px rgba(0, 0, 0, 0.04), inset 0 1px 0 rgba(255, 255, 255, 0.6)"},onMouseEnter:Ie=>{Ie.currentTarget.style.transform="translateY(-2px)",Ie.currentTarget.style.boxShadow="0 8px 24px rgba(0, 0, 0, 0.12), 0 4px 8px rgba(0, 0, 0, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.8)"},onMouseLeave:Ie=>{Ie.currentTarget.style.transform="translateY(0)",Ie.currentTarget.style.boxShadow="0 4px 16px rgba(0, 0, 0, 0.08), 0 2px 4px rgba(0, 0, 0, 0.04), inset 0 1px 0 rgba(255, 255, 255, 0.6)"},onClick:()=>{console.log("ProfileView: Event data being passed to modal from interested events:",ye);const Ie=V(D({},ye),{id:ye.id||ye.jambase_event_id,title:ye.title||"Unknown Event",artist_name:ye.artist_name||"Unknown Artist",venue_name:ye.venue_name||"Unknown Venue",event_date:ye.event_date||new Date().toISOString(),venue_city:ye.venue_city||null,venue_state:ye.venue_state||null,setlist:ye.setlist||null,setlist_song_count:ye.setlist_song_count||null,setlist_fm_url:ye.setlist_fm_url||null});console.log("ProfileView: Complete event data for modal from interested events:",{originalEvent:ye,completeEvent:Ie,artist_name:Ie.artist_name,venue_name:Ie.venue_name,venue_city:Ie.venue_city,venue_state:Ie.venue_state}),ie(Ie),G(!0)},children:s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"h-2/3 w-full relative overflow-hidden bg-gradient-to-br from-pink-400 to-pink-600 rounded-t-xl",children:[(()=>{const Ie=ye;let dt;if(Ie!=null&&Ie.poster_image_url)dt=Va(Ie.poster_image_url);else if(Ie!=null&&Ie.images&&Array.isArray(Ie.images)&&Ie.images.length>0){const wt=Ie.images.find(ht=>(ht==null?void 0:ht.url)&&((ht==null?void 0:ht.ratio)==="16_9"||(ht==null?void 0:ht.width)&&ht.width>1e3))||Ie.images.find(ht=>ht==null?void 0:ht.url);dt=wt!=null&&wt.url?Va(wt.url):void 0}else Ie!=null&&Ie.media_urls&&Array.isArray(Ie.media_urls)&&Ie.media_urls.length>0?dt=Ie.media_urls[0]:Ie!=null&&Ie.event_media_url&&(dt=Ie.event_media_url);return dt?s.jsx("img",{src:dt,alt:ye.title,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(es,{className:"w-1/3 h-1/3 text-white"})})})(),!b&&s.jsx("div",{className:"absolute top-1.5 right-1.5 px-1.5 py-0.5 rounded-md font-semibold text-[10px] leading-tight uppercase tracking-wide",style:{backgroundColor:"rgba(0, 0, 0, 0.75)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",color:"rgba(255, 255, 255, 0.95)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.15)"},children:"Interested"}),b&&s.jsx("div",{className:"absolute top-1.5 right-1.5 px-1.5 py-0.5 rounded-md font-semibold text-[10px] leading-tight uppercase tracking-wide",style:{backgroundColor:"rgba(0, 0, 0, 0.75)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",color:"rgba(255, 255, 255, 0.95)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.15)"},children:"Past"})]}),s.jsxs("div",{className:"px-2.5 pt-2.5 pb-2.5 flex-1 flex flex-col justify-between min-h-0",children:[s.jsxs("div",{className:"min-w-0 flex-shrink",children:[s.jsx("h4",{className:"font-semibold truncate mb-0.5 leading-tight",style:{fontSize:"11px",fontFamily:"var(--font-family)",color:"var(--neutral-900)"},children:ye.title}),s.jsx("p",{className:"truncate leading-tight",style:{fontSize:"10px",fontFamily:"var(--font-family)",color:"var(--neutral-600)",marginTop:"2px"},children:ye.venue_name})]}),s.jsxs("div",{className:"mt-1.5 pt-1.5 border-t border-solid",style:{borderColor:"rgba(0, 0, 0, 0.08)"},children:[s.jsx("div",{className:"font-medium leading-tight mb-0.5",style:{fontSize:"11px",fontFamily:"var(--font-family)",color:"var(--neutral-900)"},children:new Date(ye.event_date).toLocaleDateString(void 0,{month:"short",day:"numeric"})}),[ye.venue_city,ye.venue_state].filter(Boolean).length>0&&s.jsx("p",{className:"truncate leading-tight",style:{fontSize:"10px",fontFamily:"var(--font-family)",color:"var(--neutral-600)"},children:[ye.venue_city,ye.venue_state].filter(Boolean).join(", ")})]})]})]})},ye.id))})]}),s.jsx(tn,{value:"passport",className:"mt-4 mb-32 w-full max-w-full overflow-x-hidden",children:s.jsx(Wge,{isOpen:!0,onClose:()=>U("my-events"),userId:ct,userName:(m==null?void 0:m.name)||void 0,inline:!0})})]})]}),s.jsx(k7,{event:O,userId:e,isOpen:S,onClose:()=>{k(!1),z(null)},onReviewSubmitted:It}),J&&fe&&s.jsx(vn,{open:J,onOpenChange:ae,children:s.jsxs(hn,{className:"max-w-5xl w-[90vw] h-[90vh] max-h-[90vh] p-0 overflow-hidden bg-transparent border-none shadow-none",children:[s.jsxs(Hn,{className:"sr-only",children:[s.jsx(Sn,{children:"Review"}),s.jsx(ds,{children:"View concert review details"})]}),s.jsx("div",{className:"w-full h-full overflow-y-auto p-2",children:s.jsx(R2,{review:{id:fe.id,user_id:fe.user_id||(m==null?void 0:m.user_id)||"",event_id:fe.event_id||"",rating:fe.rating||0,review_text:fe.review_text||"",is_public:(rt=fe.is_public)!=null?rt:!0,created_at:fe.created_at,updated_at:fe.updated_at||fe.created_at,likes_count:fe.likes_count||0,comments_count:fe.comments_count||0,shares_count:fe.shares_count||0,is_liked_by_user:fe.is_liked_by_user||!1,reaction_emoji:fe.reaction_emoji||"",photos:fe.photos||[],videos:fe.videos||[],mood_tags:fe.mood_tags||[],genre_tags:fe.genre_tags||[],context_tags:fe.context_tags||[],artist_name:(ir=fe.jambase_events)==null?void 0:ir.artist_name,venue_name:(rn=fe.jambase_events)==null?void 0:rn.venue_name,artist_performance_rating:fe.artist_performance_rating,production_rating:fe.production_rating,venue_rating:fe.venue_rating,location_rating:fe.location_rating,value_rating:fe.value_rating,artist_performance_feedback:fe.artist_performance_feedback,production_feedback:fe.production_feedback,venue_feedback:fe.venue_feedback,location_feedback:fe.location_feedback,value_feedback:fe.value_feedback,ticket_price_paid:fe.ticket_price_paid,setlist:fe.setlist||((Mt=fe.jambase_events)==null?void 0:Mt.setlist),custom_setlist:fe.custom_setlist},currentUserId:e,onLike:(ye,Ie)=>E(void 0,null,function*(){console.log(" ProfileView BelliStyle onLike:",{reviewId:ye,isLiked:Ie})}),onComment:()=>{console.log("Comment on review from ProfileView")},onShare:()=>{console.log("Share review from ProfileView")},onEdit:()=>{ae(!1),jt(fe)},onDelete:()=>E(void 0,null,function*(){window.confirm("Are you sure you want to delete this review?")&&(yield Ee(fe.id),ae(!1),we(null))}),userProfile:{name:(m==null?void 0:m.name)||"User",avatar_url:m==null?void 0:m.avatar_url,verified:m==null?void 0:m.verified,account_type:m==null?void 0:m.account_type}})})]})}),s.jsx(Pge,{isOpen:!!Ke,onClose:()=>De(!1),type:"friends",friends:Array.isArray(M)?M:[],count:Array.isArray(M)?M.length:0,onStartChat:ye=>{console.log("Start chat with friend:",ye),l&&l(ye)},onViewProfile:ye=>{const Ie=new CustomEvent("open-user-profile",{detail:{userId:ye.user_id}});window.dispatchEvent(Ie),De(!1)},onUnfriend:We}),m&&s.jsx(Tge,{isOpen:vt,onClose:()=>rr(!1),userId:ct,profileName:m.name,isOwnProfile:pt,onNavigateToProfile:o}),ee&&oe&&s.jsx(Hl,{event:(console.log(" ProfileView: Event data being passed to EventDetailsModal:",{event:oe,hasSetlist:oe.setlist,hasSetlistEnriched:oe.setlist_enriched,setlistSongCount:oe.setlist_song_count}),oe),currentUserId:e,isOpen:ee,onClose:()=>G(!1),isInterested:!0,onInterestToggle:(ye,Ie)=>E(void 0,null,function*(){console.log(" Interest toggled in profile view:",ye,Ie);try{yield Kr.setEventInterest(e,ye,Ie),Ie||G(!1),yield yt(),at({title:Ie?"Interest Added":"Interest Removed",description:Ie?"You're now interested in this event":"You've removed this event from your interested list"})}catch(dt){console.error("Error toggling event interest:",dt),at({title:"Error",description:"Failed to update interest",variant:"destructive"})}}),onNavigateToProfile:o,onNavigateToChat:l,onAttendanceChange:(ye,Ie)=>E(void 0,null,function*(){console.log(" Attendance changed in profile view:",ye,Ie),yield Promise.all([yt(),je()])})}),!pt&&m&&s.jsx(E1,{open:ve,onClose:()=>me(!1),contentType:"profile",contentId:ct,contentTitle:`${m.name}'s profile`,onReportSubmitted:()=>{me(!1),at({title:"Report Submitted",description:"Thank you for helping keep our community safe"})}}),!pt&&m&&s.jsx(Mge,{open:Me,onClose:()=>Te(!1),user:{id:ct,name:m.name,avatar_url:m.avatar_url||void 0},isBlocked:Ve,onBlockToggled:()=>{Te(!1),le(!Ve),at({title:Ve?"User Unblocked":"User Blocked",description:Ve?`You can now see content from ${m.name}`:`You won't see content from ${m.name} anymore`})}})]})):(console.log(" ProfileView: No profile data available after loading"),console.log(" ProfileView: Loading state:",_),console.log(" ProfileView: Current user ID:",e),s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"font-bold mb-4",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)"},children:"Profile not found"}),s.jsx("p",{className:"mb-4",style:{color:"var(--neutral-600)"},children:"Unable to load profile data. Please try again."}),s.jsxs(ce,{onClick:()=>{window.history.length>1?Ct(-1):r()},children:[s.jsx(ks,{size:16,className:"mr-2"}),"Back"]})]})}))},O7=["admin","administrator","support","help","root","system","api","www","mail","email","postmaster","noreply","no-reply","test","testing","null","undefined","delete","remove","moderator","mod","staff","team","official","verify","verified"];function Ki(e){if(!e)return"";let t=e.toLowerCase().trim();return t=t.replace(/[^a-z0-9_.]/g,""),t=t.replace(/^[_.]+|[_.]+$/g,""),t=t.replace(/[_.]{2,}/g,r=>r[0]),t}function _w(e){if(!e)return{valid:!1,error:"Username is required"};const t=Ki(e);return t.length<3?{valid:!1,error:"Username must be at least 3 characters"}:t.length>30?{valid:!1,error:"Username must be 30 characters or less"}:/^[a-z0-9_.]+$/.test(t)?O7.includes(t)?{valid:!1,error:"This username is reserved and cannot be used"}:t.startsWith(".")||t.startsWith("_")||t.endsWith(".")||t.endsWith("_")?{valid:!1,error:"Username cannot start or end with a period or underscore"}:{valid:!0}:{valid:!1,error:"Username can only contain lowercase letters, numbers, underscores, and periods"}}function M7(e){if(!e)return"";let t=e.toLowerCase().trim();t=t.replace(/[^a-z0-9\s]/g,"");const r=t.split(/\s+/).filter(Boolean);return r.length===0?"":r.length===1?r[0]:r.join("")}function D7(e){return O7.includes(e.toLowerCase())}const fS=Object.freeze(Object.defineProperty({__proto__:null,generateBaseUsernameFromName:M7,isReservedUsername:D7,sanitizeUsername:Ki,validateUsernameFormat:_w},Symbol.toStringTag,{value:"Module"})),H2=30;function tm(e,t){return E(this,null,function*(){var a;const r=Ki(e);if(!r)return{available:!1,error:"Username is required"};const n=_w(r);if(!n.valid)return{available:!1,error:n.error};if(D7(r))return{available:!1,error:"This username is reserved and cannot be used"};try{let i=T.from("users").select("user_id, username").eq("username",r).limit(1);t&&(i=i.neq("user_id",t));const{data:o,error:l}=yield i;return l?(console.error("Error checking username availability:",l),l.code==="PGRST116"||(a=l.message)!=null&&a.includes("does not exist")?{available:!0}:{available:!1,error:"Error checking username availability"}):!o||o.length===0?{available:!0}:{available:!1,error:"This username is already taken"}}catch(i){return console.error("Error checking username availability:",i),{available:!1,error:"Error checking username availability"}}})}function Gge(e,t){return E(this,null,function*(){const r=M7(e);if(!r){const o=`user${Math.floor(Math.random()*1e4)}`;return(yield tm(o,t)).available?o:null}if((yield tm(r,t)).available)return Ki(r);let a=2;const i=100;for(;a<i;){const o=`${Ki(r)}${a}`;if((yield tm(o,t)).available)return o;a++}return null})}function ww(e){return E(this,null,function*(){try{const{data:t,error:r}=yield T.from("users").select("last_username_change_at").eq("user_id",e).single();if(r||!t)return{allowed:!0};const n=t.last_username_change_at;if(!n)return{allowed:!0};const a=new Date(n),o=Math.floor((new Date().getTime()-a.getTime())/(1e3*60*60*24));return o>=H2?{allowed:!0,lastChangeDate:a}:{allowed:!1,daysRemaining:H2-o,lastChangeDate:a}}catch(t){return console.error("Error checking username change eligibility:",t),{allowed:!0}}})}function I7(e,t){return E(this,null,function*(){var i,o;const r=yield ww(e);if(!r.allowed)return{success:!1,error:`You can only change your username once every ${H2} days. You can change it again in ${r.daysRemaining} day${r.daysRemaining!==1?"s":""}.`};const n=yield tm(t,e);if(!n.available)return{success:!1,error:n.error||"Username is not available"};const a=Ki(t);try{const{error:l}=yield T.from("users").update({username:a,last_username_change_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("user_id",e);if(l){if(l.code==="23505"||(i=l.message)!=null&&i.includes("unique"))return{success:!1,error:"This username is already taken"};if((o=l.message)!=null&&o.includes("last_username_change_at")||l.code==="42703"){const{error:c}=yield T.from("users").update({username:a,updated_at:new Date().toISOString()}).eq("user_id",e);return c?(console.error("Error updating username:",c),{success:!1,error:"Failed to update username"}):{success:!0}}return console.error("Error updating username:",l),{success:!1,error:"Failed to update username"}}return{success:!0}}catch(l){return console.error("Error updating username:",l),{success:!1,error:l.message||"Failed to update username"}}})}const f4=Object.freeze(Object.defineProperty({__proto__:null,canChangeUsername:ww,checkUsernameAvailability:tm,generateAvailableUsername:Gge,updateUsername:I7},Symbol.toStringTag,{value:"Module"})),Yge=({currentUserId:e,onBack:t,onSave:r})=>{const[n,a]=y.useState(null),[i,o]=y.useState(!0),[l,c]=y.useState(!1),[d,f]=y.useState({name:"",username:"",bio:"",instagram_handle:"",music_streaming_profile:"",avatar_url:null,gender:"",birthday:""}),[u,h]=y.useState({checking:!1,available:null,error:null}),[m,v]=y.useState({allowed:!0}),g=y.useRef(null),{toast:x}=Er();y.useEffect(()=>{_()},[e]),y.useEffect(()=>()=>{g.current&&clearTimeout(g.current)},[]);const _=()=>E(void 0,null,function*(){try{console.log("Fetching profile for user:",e);const S="id, user_id, name, username, avatar_url, bio, instagram_handle, music_streaming_profile, gender, birthday, created_at, updated_at",k=O=>E(void 0,null,function*(){return console.log(`ProfileEdit: Attempting profile lookup by ${O}`),yield T.from("users").select(S).eq(O,e).maybeSingle()});let C=null;const{data:A,error:R}=yield k("user_id");if(R&&R.code!=="PGRST116")throw console.error("Profile fetch error:",R),console.error("Error code:",R.code),console.error("Error message:",R.message),console.error("Error details:",R.details),R;if(C=A,!C){const{data:O,error:z}=yield k("id");if(z&&z.code!=="PGRST116")throw console.error("Profile fetch fallback error:",z),z;C=O}if(!C){console.log("No profile found, will create one when user saves"),f({name:"",username:"",bio:"",instagram_handle:"",music_streaming_profile:"",avatar_url:null,gender:"",birthday:""}),o(!1);return}console.log("Profile data received:",C),a(C);const I=yield ww(e);v(I),f({name:C.name||"",username:C.username||"",bio:C.bio||"",instagram_handle:C.instagram_handle||"",music_streaming_profile:C.music_streaming_profile||"",avatar_url:C.avatar_url||null,gender:C.gender||"",birthday:C.birthday||""})}catch(S){console.error("Error fetching profile:",S),x({title:"Error",description:"Failed to load profile",variant:"destructive"})}finally{o(!1)}}),w=()=>E(void 0,null,function*(){if(console.log("Save button clicked, form data:",d),!d.name.trim()){x({title:"Error",description:"Name is required",variant:"destructive"});return}const S=Ki(d.username),k=n==null?void 0:n.username;let C=!1;if(S&&S!==k){const A=_w(S);if(!A.valid){x({title:"Invalid Username",description:A.error||"Username format is invalid",variant:"destructive"});return}if(u.checking){x({title:"Please Wait",description:"Still checking username availability...",variant:"destructive"});return}if(u.available===!1){x({title:"Username Not Available",description:u.error||"This username is not available",variant:"destructive"});return}if(u.available!==!0){x({title:"Please Wait",description:"Username validation is still in progress. Please wait a moment and try again.",variant:"destructive"});return}const R=yield I7(e,S);if(!R.success){x({title:"Error",description:R.error||"Failed to update username",variant:"destructive"});return}C=!0}c(!0);try{const A={user_id:e,name:d.name.trim(),bio:d.bio.trim()||null,instagram_handle:d.instagram_handle.trim()||null,music_streaming_profile:d.music_streaming_profile.trim()||null,avatar_url:d.avatar_url||null,gender:d.gender.trim()||null,birthday:d.birthday.trim()||null,updated_at:new Date().toISOString()};!C&&S&&S!==k&&(A.username=S),console.log("Saving profile with data:",A);let R;if(n&&n.id)console.log("Updating existing profile"),R=yield T.from("users").update(A).eq("user_id",e).select().single();else{if(!S){x({title:"Username Required",description:"Username is required for new profiles",variant:"destructive"}),c(!1);return}A.username=S,console.log("Creating new profile"),R=yield T.from("users").insert(A).select().single()}if(R.error)throw console.error("Profile save error:",R.error),R.error;console.log("Profile saved successfully:",R.data),x({title:"Success",description:"Profile saved successfully"});const I=yield ww(e);v(I),r()}catch(A){console.error("Error saving profile:",A),x({title:"Error",description:`Failed to save profile: ${A.message||"Unknown error"}`,variant:"destructive"})}finally{c(!1)}}),b=(S,k)=>{f(C=>V(D({},C),{[S]:k})),S==="username"&&N(k)},N=S=>E(void 0,null,function*(){g.current&&clearTimeout(g.current);const k=Ki(S);if(h({checking:!1,available:null,error:null}),!k)return;const C=_w(k);if(!C.valid){h({checking:!1,available:!1,error:C.error||null});return}g.current=setTimeout(()=>E(void 0,null,function*(){h({checking:!0,available:null,error:null});try{const A=n==null?void 0:n.username;if(k===A){h({checking:!1,available:!0,error:null});return}const R=yield tm(k,e);h({checking:!1,available:R.available,error:R.error||null})}catch(A){console.error("Error checking username availability:",A),h({checking:!1,available:null,error:"Error checking username availability"})}}),500)});return i?s.jsx(A1,{text:"Loading profile..."}):s.jsx("div",{className:"p-4 bg-gray-50",children:s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx(ce,{variant:"ghost",size:"icon",onClick:t,children:s.jsx(ks,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Edit Profile"}),s.jsx("p",{className:"text-muted-foreground",children:"Update your profile information"})]})]}),s.jsxs(Ze,{children:[s.jsx(kr,{children:s.jsxs(Lr,{className:"flex items-center gap-2",children:[s.jsx(Is,{className:"w-5 h-5"}),"Profile Information"]})}),s.jsxs(tt,{className:"space-y-6",children:[s.jsx(zde,{value:d.avatar_url,onChange:S=>E(void 0,null,function*(){if(b("avatar_url",S||""),S&&n&&n.id)try{yield T.from("users").update({avatar_url:S}).eq("user_id",e),a(V(D({},n),{avatar_url:S}))}catch(k){console.error("Error auto-saving avatar:",k)}}),userId:e,bucket:"profile-avatars",maxSizeMB:25,label:"Profile Picture",helperText:"Upload a photo to personalize your profile. Max 25MB. Your avatar saves automatically.",aspectRatio:"circle"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"name",children:"Display Name *"}),s.jsx(Nr,{id:"name",value:d.name,onChange:S=>b("name",S.target.value),placeholder:"Enter your display name",maxLength:50}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"This is your display name that others will see on your profile"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"username",children:"Username *"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",children:"@"}),s.jsx(Nr,{id:"username",value:d.username,onChange:S=>b("username",S.target.value),placeholder:"username",maxLength:30,disabled:!m.allowed,className:`pl-8 pr-20 ${u.available===!1?"border-red-500 focus:border-red-500":u.available===!0?"border-green-500 focus:border-green-500":""}`}),s.jsxs("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center gap-2",children:[u.checking&&s.jsx(fr,{className:"w-4 h-4 animate-spin text-muted-foreground"}),!u.checking&&u.available===!0&&s.jsx(Zk,{className:"w-4 h-4 text-green-500"}),!u.checking&&u.available===!1&&s.jsx(ZF,{className:"w-4 h-4 text-red-500"})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[u.error&&s.jsxs("p",{className:"text-xs text-red-500 mt-1 flex items-center gap-1",children:[s.jsx(df,{className:"w-3 h-3"}),u.error]}),!u.error&&u.available===!0&&Ki(d.username)&&s.jsxs("p",{className:"text-xs text-green-600 mt-1 flex items-center gap-1",children:[s.jsx(Zk,{className:"w-3 h-3"}),"Available: @",Ki(d.username)]}),!m.allowed&&m.daysRemaining!==void 0&&s.jsxs("p",{className:"text-xs text-amber-600 mt-1 flex items-center gap-1",children:[s.jsx(df,{className:"w-3 h-3"}),"You can change your username in ",m.daysRemaining," day",m.daysRemaining!==1?"s":""]}),m.allowed&&Ki(d.username)&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Changing your username will update your profile URL"})]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[Ki(d.username).length,"/30"]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your unique identifier. Can only be changed once every 30 days. 3-30 characters, lowercase letters, numbers, underscores, and periods only."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"bio",children:"Bio"}),s.jsx(_s,{id:"bio",value:d.bio,onChange:S=>b("bio",S.target.value),placeholder:"Tell people about yourself...",maxLength:200,rows:3}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[d.bio.length,"/200 characters"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(qt,{htmlFor:"instagram",className:"flex items-center gap-2",children:[s.jsx(DP,{className:"w-4 h-4"}),"Instagram Handle"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-muted-foreground",children:"@"}),s.jsx(Nr,{id:"instagram",value:d.instagram_handle,onChange:S=>b("instagram_handle",S.target.value.replace("@","")),placeholder:"username",maxLength:100})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your Instagram profile will be linked when people view your profile"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(qt,{htmlFor:"music-streaming",className:"flex items-center gap-2",children:[s.jsx(Ft,{className:"w-4 h-4"}),"Music Streaming Profile"]}),s.jsx(Nr,{id:"music-streaming",value:d.music_streaming_profile,onChange:S=>b("music_streaming_profile",S.target.value),placeholder:"https://open.spotify.com/user/yourusername or @username",maxLength:200}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Share your Spotify, Apple Music, or other streaming profile link. Will display as a clickable link on your profile."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(qt,{htmlFor:"gender",className:"flex items-center gap-2",children:[s.jsx(Vr,{className:"w-4 h-4"}),"Gender"]}),s.jsxs(aa,{value:d.gender||void 0,onValueChange:S=>b("gender",S),children:[s.jsx(Gs,{children:s.jsx(ia,{placeholder:"Select your gender (optional)"})}),s.jsxs(Ys,{children:[s.jsx(Bt,{value:"male",children:"Male"}),s.jsx(Bt,{value:"female",children:"Female"}),s.jsx(Bt,{value:"non-binary",children:"Non-binary"}),s.jsx(Bt,{value:"prefer-not-to-say",children:"Prefer not to say"}),s.jsx(Bt,{value:"other",children:"Other"}),s.jsx(Bt,{value:"not-specified",children:"Not specified"})]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your gender will be shown to other users interested in the same events for trust and safety"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(qt,{htmlFor:"birthday",className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"w-4 h-4"}),"Birthday"]}),s.jsx(Nr,{id:"birthday",type:"date",value:d.birthday,onChange:S=>b("birthday",S.target.value),max:(()=>{const S=new Date;return S.setFullYear(S.getFullYear()-13),S.toISOString().split("T")[0]})()}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your age (not exact birthday) will be shown to other users interested in the same events. You must be at least 13 years old."})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsxs(ce,{onClick:w,disabled:l||!d.name.trim(),className:"flex-1",children:[s.jsx(LP,{className:"w-4 h-4 mr-2"}),l?"Saving...":"Save Changes"]}),s.jsx(ce,{variant:"outline",onClick:t,children:"Cancel"})]})]})]})]})})};function Kge(){return E(this,null,function*(){return new Promise(e=>{if(!$7()){e({success:!1,error:"Apple Sign In is only available on iOS devices"});return}const t=n=>{var o;const a=n,i=((o=a.detail)==null?void 0:o.token)||a.token;i&&(n.stopImmediatePropagation(),window.removeEventListener("AppleSignInTokenReceived",t,!0),window.removeEventListener("AppleSignInError",r,!0),Xge(i).then(l=>e(l)).catch(l=>e({success:!1,error:l.message||"Failed to authenticate with Supabase"})))},r=n=>{var o;const a=n,i=((o=a.detail)==null?void 0:o.error)||a.error||"Unknown error";n.stopImmediatePropagation(),window.removeEventListener("AppleSignInTokenReceived",t,!0),window.removeEventListener("AppleSignInError",r,!0),e({success:!1,error:i})};window.addEventListener("AppleSignInTokenReceived",t,{capture:!0}),window.addEventListener("AppleSignInError",r,{capture:!0}),Zge()})})}function Zge(){var t,r,n,a;if((r=(t=window.webkit)==null?void 0:t.messageHandlers)!=null&&r.appleSignIn)try{window.webkit.messageHandlers.appleSignIn.postMessage({});return}catch(i){console.warn("Failed to post via WebKit message handler:",i)}window.dispatchEvent(new CustomEvent("RequestAppleSignIn"));const e=window.Capacitor;if(e&&typeof e.isNativePlatform=="function"&&e.Plugins)try{(a=(n=window.webkit)==null?void 0:n.messageHandlers)!=null&&a.capacitor&&window.webkit.messageHandlers.capacitor.postMessage({type:"plugin",callbackId:"apple-sign-in",pluginId:"App",methodName:"handleAppleSignIn",options:{}})}catch(i){console.log("Capacitor bridge method failed")}}function Xge(e){return E(this,null,function*(){try{const{data:t,error:r}=yield T.auth.signInWithIdToken({provider:"apple",token:e});return r?{success:!1,error:r.message||"Failed to authenticate with Supabase"}:{success:!0,session:t.session}}catch(t){return{success:!1,error:t.message||"Authentication error"}}})}function $7(){if(typeof window=="undefined")return!1;const e=window.navigator.userAgent||window.navigator.vendor||window.opera,t=/iPad|iPhone|iPod/.test(e)&&!window.MSStream,r=window.Capacitor;if(r&&typeof r.getPlatform=="function")try{return r.getPlatform()==="ios"||t}catch(n){return console.warn("Error checking Capacitor platform:",n),t}return t}function Jge(){if(!$7())return null;const e=t=>{var a;const r=t,n=((a=r.detail)==null?void 0:a.error)||r.error;console.error("Apple Sign In error:",n)};return window.addEventListener("AppleSignInError",e),()=>{window.removeEventListener("AppleSignInError",e)}}const Qge=`
  @keyframes elegant-shift {
    0% { background-position: 0% 50%; }
    25% { background-position: 100% 50%; }
    50% { background-position: 100% 100%; }
    75% { background-position: 0% 100%; }
    100% { background-position: 0% 50%; }
  }
`;if(typeof document!="undefined"){const e=document.createElement("style");e.textContent=Qge,document.head.appendChild(e)}function L7({onAuthSuccess:e}){const[t,r]=y.useState(""),[n,a]=y.useState(""),[i,o]=y.useState(""),[l,c]=y.useState(!1),[d,f]=y.useState(!1),[u,h]=y.useState(!1),[m,v]=y.useState(!1),{toast:g}=Er();y.useEffect(()=>{(()=>{const S=window.navigator.userAgent||window.navigator.vendor||window.opera,k=/iPad|iPhone|iPod/.test(S)&&!window.MSStream,C=window.Capacitor;if(C&&typeof C.getPlatform=="function")try{h(C.getPlatform()==="ios"||k)}catch(A){console.warn("Error checking Capacitor platform:",A),h(k)}else h(k)})()},[]),y.useEffect(()=>{let N=null;return u&&(N=Jge()),()=>{N&&N()}},[u]);const x=N=>E(this,null,function*(){N.preventDefault(),c(!0);try{const{error:S}=yield T.auth.signUp({email:t,password:n,options:{emailRedirectTo:"https://synth-beta-testing.vercel.app/#onboarding",data:{name:i}}});if(S)throw S;g({title:"Check your email!",description:"We sent you a confirmation link."})}catch(S){g({title:"Sign up failed",description:S.message,variant:"destructive"})}finally{c(!1)}}),_=N=>E(this,null,function*(){N.preventDefault(),c(!0);try{const{error:S}=yield T.auth.signInWithPassword({email:t,password:n});if(S)throw S;g({title:"Welcome back!",description:"You're now signed in."}),e()}catch(S){g({title:"Sign in failed",description:S.message,variant:"destructive"})}finally{c(!1)}}),w=()=>E(this,null,function*(){if(!t){g({title:"Email required",description:"Please enter your email address first.",variant:"destructive"});return}v(!0);try{const{error:N}=yield T.auth.resetPasswordForEmail(t,{redirectTo:"https://synth-beta-testing.vercel.app/reset-password"});if(N)throw N;g({title:"Password reset email sent",description:"Check your email for instructions to reset your password."})}catch(N){console.error("Error sending password reset:",N),g({title:"Error",description:N.message||"Failed to send password reset email.",variant:"destructive"})}finally{v(!1)}}),b=()=>E(this,null,function*(){if(!u){g({title:"Not available",description:"Apple Sign In is only available on iOS devices.",variant:"destructive"});return}f(!0);try{const N=yield Kge();N.success?(g({title:"Welcome!",description:"You're now signed in with Apple."}),e()):g({title:"Sign in failed",description:N.error||"Failed to sign in with Apple",variant:"destructive"})}catch(N){g({title:"Sign in failed",description:N.message||"Failed to sign in with Apple",variant:"destructive"})}finally{f(!1)}});return s.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{background:"linear-gradient(45deg, #fdf2f8 0%, #ffffff 25%, #fce7f3 50%, #ffffff 75%, #fdf2f8 100%)",backgroundSize:"400% 400%",animation:"elegant-shift 20s ease infinite"},children:s.jsxs(Ze,{className:"w-full max-w-md bg-white/90 backdrop-blur-lg rounded-3xl shadow-xl border-0",children:[s.jsxs(kr,{className:"text-center pb-8",children:[s.jsx("div",{className:"flex justify-center mb-6",children:s.jsx("img",{src:"/Logos/Main logo black background.png",alt:"Synth Logo",className:"w-20 h-20 rounded-2xl"})}),s.jsx(Lr,{className:"text-3xl font-bold text-black mb-2",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Synth"}),s.jsx(zo,{className:"text-[#666666] text-base",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Connect with people at events you love"})]}),s.jsxs(tt,{className:"px-10 pb-10",children:[s.jsxs(zi,{defaultValue:"signin",children:[s.jsxs(wi,{className:"grid w-full grid-cols-2 bg-[#F5F5DC] rounded-xl p-1",children:[s.jsx(en,{value:"signin",className:"data-[state=active]:bg-white data-[state=active]:text-black text-[#666666] font-medium rounded-lg transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Sign In"}),s.jsx(en,{value:"signup",className:"data-[state=active]:bg-white data-[state=active]:text-black text-[#666666] font-medium rounded-lg transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Sign Up"})]}),s.jsx(tn,{value:"signin",className:"mt-6",children:s.jsxs("form",{onSubmit:_,className:"space-y-6",children:[s.jsx("div",{children:s.jsx(Nr,{id:"signin-email",name:"signinEmail",type:"email",placeholder:"Email",value:t,onChange:N=>r(N.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx("div",{children:s.jsx(Nr,{id:"signin-password",name:"signinPassword",type:"password",placeholder:"Password",value:n,onChange:N=>a(N.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{type:"button",onClick:w,disabled:m,className:"text-sm text-[#FF3399] hover:text-[#E6007A] transition-colors disabled:opacity-50",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:m?"Sending...":"Forgot password?"})}),s.jsx(ce,{type:"submit",disabled:l,className:"w-full bg-[#FF3399] hover:bg-[#E6007A] text-white font-semibold py-3 px-6 rounded-lg transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:l?"Signing in...":"Sign In"})]})}),s.jsx(tn,{value:"signup",className:"mt-6",children:s.jsxs("form",{onSubmit:x,className:"space-y-6",children:[s.jsx("div",{children:s.jsx(Nr,{id:"signup-name",name:"signupName",type:"text",placeholder:"Your name",value:i,onChange:N=>o(N.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx("div",{children:s.jsx(Nr,{id:"signup-email",name:"signupEmail",type:"email",placeholder:"Email",value:t,onChange:N=>r(N.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx("div",{children:s.jsx(Nr,{id:"signup-password",name:"signupPassword",type:"password",placeholder:"Password (min 6 characters)",value:n,onChange:N=>a(N.target.value),required:!0,minLength:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx(ce,{type:"submit",disabled:l,className:"w-full bg-[#FF3399] hover:bg-[#E6007A] text-white font-semibold py-3 px-6 rounded-lg transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:l?"Creating account...":"Sign Up"})]})})]}),u&&s.jsxs("div",{className:"mt-6",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("span",{className:"w-full border-t border-gray-300"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-white/90 text-gray-500",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Or continue with"})})]}),s.jsx(ce,{onClick:b,disabled:d||l,className:"w-full mt-4 bg-black hover:bg-gray-800 text-white font-semibold py-3 px-6 rounded-lg transition-all flex items-center justify-center gap-2",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:d?"Signing in...":s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M17.05 20.28c-.98.95-2.05.88-3.08.4-1.09-.5-2.08-.48-3.24 0-1.44.62-2.2.44-3.06-.4C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"})}),"Sign in with Apple"]})})]})]})]})})}var Y1="Switch",[eve,dUe]=$s(Y1),[tve,rve]=eve(Y1),F7=y.forwardRef((e,t)=>{const b=e,{__scopeSwitch:r,name:n,checked:a,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:d,form:f}=b,u=ge(b,["__scopeSwitch","name","checked","defaultChecked","required","disabled","value","onCheckedChange","form"]),[h,m]=y.useState(null),v=mr(t,N=>m(N)),g=y.useRef(!1),x=h?f||!!h.closest("form"):!0,[_,w]=Ya({prop:a,defaultProp:i!=null?i:!1,onChange:d,caller:Y1});return s.jsxs(tve,{scope:r,checked:_,disabled:l,children:[s.jsx(Pt.button,V(D({type:"button",role:"switch","aria-checked":_,"aria-required":o,"data-state":q7(_),"data-disabled":l?"":void 0,disabled:l,value:c},u),{ref:v,onClick:mt(e.onClick,N=>{w(S=>!S),x&&(g.current=N.isPropagationStopped(),g.current||N.stopPropagation())})})),x&&s.jsx(U7,{control:h,bubbles:!g.current,name:n,value:c,checked:_,required:o,disabled:l,form:f,style:{transform:"translateX(-100%)"}})]})});F7.displayName=Y1;var z7="SwitchThumb",B7=y.forwardRef((e,t)=>{const i=e,{__scopeSwitch:r}=i,n=ge(i,["__scopeSwitch"]),a=rve(z7,r);return s.jsx(Pt.span,V(D({"data-state":q7(a.checked),"data-disabled":a.disabled?"":void 0},n),{ref:t}))});B7.displayName=z7;var nve="SwitchBubbleInput",U7=y.forwardRef((o,i)=>{var l=o,{__scopeSwitch:e,control:t,checked:r,bubbles:n=!0}=l,a=ge(l,["__scopeSwitch","control","checked","bubbles"]);const c=y.useRef(null),d=mr(c,i),f=I1(r),u=Zb(t);return y.useEffect(()=>{const h=c.current;if(!h)return;const m=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(m,"checked").set;if(f!==r&&g){const x=new Event("click",{bubbles:n});g.call(h,r),h.dispatchEvent(x)}},[f,r,n]),s.jsx("input",V(D({type:"checkbox","aria-hidden":!0,defaultChecked:r},a),{tabIndex:-1,ref:d,style:V(D(D({},a.style),u),{position:"absolute",pointerEvents:"none",opacity:0,margin:0})}))});U7.displayName=nve;function q7(e){return e?"checked":"unchecked"}var V7=F7,sve=B7;const lv=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(V7,V(D({className:Oe("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e)},t),{ref:r,children:s.jsx(sve,{className:Oe("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}))});lv.displayName=V7.displayName;class Ox{static getUserMusicTags(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_preferences").select("preferred_genres, preferred_artists, music_preference_signals").eq("user_id",t).maybeSingle();if(n&&n.code!=="PGRST116")throw n;if(!r)return[];const a=(r.preferred_genres||[]).map(l=>({id:`${t}-genre-${l}`,user_id:t,tag_type:"genre",tag_value:l,tag_source:"manual",weight:5,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),i=r.preferred_artists||[];let o=[];if(i.length>0){const{data:l}=yield T.from("artists").select("id, name").in("id",i);l&&(o=l.map(c=>({id:`${t}-artist-${c.id}`,user_id:t,tag_type:"artist",tag_value:c.name,tag_source:"manual",weight:5,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})))}return[...a,...o]}catch(r){return console.error("Error fetching user music tags:",r),[]}})}static getUserMusicTagsByType(t,r){return E(this,null,function*(){try{return(yield this.getUserMusicTags(t)).filter(a=>a.tag_type===r)}catch(n){return console.error(`Error fetching ${r} tags:`,n),[]}})}static addMusicTag(t,r){return E(this,null,function*(){try{const{data:n}=yield T.from("user_preferences").select("preferred_genres, preferred_artists, id").eq("user_id",t).maybeSingle(),a=(n==null?void 0:n.preferred_genres)||[],i=(n==null?void 0:n.preferred_artists)||[];let o;if(r.tag_type==="genre")a.includes(r.tag_value)||a.push(r.tag_value),o={preferred_genres:a,preferred_artists:i,updated_at:new Date().toISOString()};else{let d=null;const{data:f,error:u}=yield T.from("artists").select("id, name").ilike("name",r.tag_value).limit(1).maybeSingle();if(u&&u.code!=="PGRST116"&&console.warn(`Error searching for artist "${r.tag_value}":`,u),f)d=f.id;else try{const{MissingEntityRequestService:h}=yield Rr(()=>E(this,null,function*(){const{MissingEntityRequestService:m}=yield import("./missingEntityRequestService-DnUo_jW_.js");return{MissingEntityRequestService:m}}),[],import.meta.url);yield h.submitRequest({entity_type:"artist",entity_name:r.tag_value}),console.log(` Submitted request for missing artist: "${r.tag_value}"`)}catch(h){console.warn(`Error submitting artist request "${r.tag_value}":`,h)}d&&!i.includes(d)&&i.push(d),o={preferred_genres:a,preferred_artists:i,updated_at:new Date().toISOString()}}let l,c;if(n){const d=yield T.from("user_preferences").update(o).eq("user_id",t).select().single();l=d.data,c=d.error}else{const d=yield T.from("user_preferences").insert(D({user_id:t},o)).select().single();l=d.data,c=d.error}if(c)throw c;return{id:`${t}-${r.tag_type}-${r.tag_value}`,user_id:t,tag_type:r.tag_type,tag_value:r.tag_value,tag_source:r.tag_source||"manual",weight:r.weight||5,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}catch(n){return console.error("Error adding music tag:",n),null}})}static removeMusicTag(t){return E(this,null,function*(){try{const r=t.split("-");if(r.length<3)return console.error("Invalid tag ID format:",t),!1;const n=r[0],a=r[1],i=r.slice(2).join("-");return yield this.removeMusicTagByValue(n,a,i)}catch(r){return console.error("Error removing music tag:",r),!1}})}static removeMusicTagByValue(t,r,n){return E(this,null,function*(){try{const{data:a}=yield T.from("user_preferences").select("preferred_genres, preferred_artists").eq("user_id",t).maybeSingle();if(!a)return!0;let i=a.preferred_genres||[],o=a.preferred_artists||[];if(r==="genre")i=i.filter(c=>c!==n);else{const{data:c}=yield T.from("artists").select("id").eq("name",n).maybeSingle();c?o=o.filter(d=>d!==c.id):console.warn(` Artist "${n}" not found in database, cannot remove`)}const{error:l}=yield T.from("user_preferences").update({preferred_genres:i,preferred_artists:o,updated_at:new Date().toISOString()}).eq("user_id",t);if(l)throw l;return!0}catch(a){return console.error("Error removing music tag by value:",a),!1}})}static bulkUpdateMusicTags(t,r){return E(this,null,function*(){try{const n=r.filter(d=>d.tag_type==="genre").map(d=>d.tag_value),a=r.filter(d=>d.tag_type==="artist").map(d=>d.tag_value),i=[];if(a.length>0)for(const d of a)try{const{data:f,error:u}=yield T.from("artists").select("id, name").ilike("name",d).limit(1).maybeSingle();if(u&&u.code!=="PGRST116"){console.warn(`Error searching for artist "${d}":`,u);continue}if(f)i.includes(f.id)||i.push(f.id);else{const h=d.toLowerCase().replace(/\s+/g,"-"),m=`manual:${h}-${Date.now()}`,{data:v,error:g}=yield T.from("artists").insert({name:d,identifier:h,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("id").single();if(g){console.warn(`Error creating artist "${d}":`,g);continue}v&&(yield T.from("external_entity_ids").insert({entity_type:"artist",entity_uuid:v.id,source:"manual",external_id:m}).catch(()=>{}),i.push(v.id),console.log(` Created new artist: "${d}" (${v.id})`))}}catch(f){console.error(`Error processing artist "${d}":`,f)}const{data:o,error:l}=yield T.from("user_preferences").select("id").eq("user_id",t).maybeSingle();if(l&&l.code!=="PGRST116")throw l;const c={preferred_genres:n||[],preferred_artists:i,updated_at:new Date().toISOString()};if(o){const{error:d}=yield T.from("user_preferences").update(c).eq("user_id",t);if(d)throw d}else{const{error:d}=yield T.from("user_preferences").insert({user_id:t,preferred_genres:n||[],preferred_artists:i,updated_at:new Date().toISOString()});if(d)throw d}return!0}catch(n){return console.error("Error bulk updating music tags:",n),!1}})}static syncSpotifyTags(t,r){return E(this,null,function*(){try{const{data:n}=yield T.from("user_preferences").select("preferred_genres, preferred_artists, music_preference_signals, id").eq("user_id",t).maybeSingle();let a=(n==null?void 0:n.preferred_genres)||[],i=(n==null?void 0:n.preferred_artists)||[];const o=(n==null?void 0:n.music_preference_signals)||{},l=r.filter(h=>h.tag_type==="artist").map(h=>h.tag_value),c=[];if(l.length>0)for(const h of l)try{const{data:m,error:v}=yield T.from("artists").select("id, name").ilike("name",h).limit(1).maybeSingle();if(v&&v.code!=="PGRST116"){console.warn(`Error searching for Spotify artist "${h}":`,v);continue}if(m)c.includes(m.id)||c.push(m.id);else{const g=h.toLowerCase().replace(/\s+/g,"-"),{data:x,error:_}=yield T.from("artists").insert({name:h,jambase_artist_id:`spotify:${g}-${Date.now()}`,identifier:g,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("id").single();if(_){console.warn(`Error creating Spotify artist "${h}":`,_);continue}x&&(c.push(x.id),console.log(` Created new Spotify artist: "${h}" (${x.id})`))}}catch(m){console.error(`Error processing Spotify artist "${h}":`,m)}r.forEach(h=>{h.tag_type==="genre"&&(a.includes(h.tag_value)||a.push(h.tag_value))});const d=[...new Set([...i,...c])],f={preferred_genres:a,preferred_artists:d,music_preference_signals:o,updated_at:new Date().toISOString()};let u;if(n?u=(yield T.from("user_preferences").update(f).eq("user_id",t)).error:u=(yield T.from("user_preferences").insert(D({user_id:t},f))).error,u)throw u;return!0}catch(n){return console.error("Error syncing Spotify tags:",n),!1}})}static updateTagWeight(t,r){return E(this,null,function*(){try{const n=t.split("-");if(n.length<3)return console.error("Invalid tag ID format:",t),!1;const a=n[0],i=n[1],o=n.slice(2).join("-"),{data:l}=yield T.from("user_preferences").select("music_preference_signals").eq("user_id",a).single(),c=(l==null?void 0:l.music_preference_signals)||{},d=`${i}_${o}`;c[d]=V(D({},c[d]),{weight:r});const{error:f}=yield T.from("user_preferences").update({music_preference_signals:c,updated_at:new Date().toISOString()}).eq("user_id",a);if(f)throw f;return!0}catch(n){return console.error("Error updating tag weight:",n),!1}})}static getMusicPreferencesSummary(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_preferences").select("preferred_genres, preferred_artists, music_preference_signals").eq("user_id",t).maybeSingle();if(n&&n.code!=="PGRST116")throw n;const a=(r==null?void 0:r.preferred_genres)||[],i=(r==null?void 0:r.preferred_artists)||[],o=(r==null?void 0:r.music_preference_signals)||{};let l=[];if(i.length>0){const{data:d}=yield T.from("artists").select("name").in("id",i);d&&(l=d.map(f=>f.name))}const c=Object.keys(o).some(d=>{var f;return typeof o[d]=="object"&&((f=o[d])==null?void 0:f.source)==="spotify"});return{genres:a,artists:l,hasSpotify:c}}catch(r){return console.error("Error getting music preferences summary:",r),{genres:[],artists:[],hasSpotify:!1}}})}}const W7=["Rock","Pop","Hip Hop","Rap","Electronic","Jazz","Classical","Indie","R&B","Soul","Country","Metal","Folk","Punk","Blues","Reggae","EDM","House","Techno","Dubstep","Trance","Drum & Bass","Ambient","Alternative","Grunge","Hard Rock","Progressive Rock","Psychedelic Rock","Trap","Grime","Afrobeat","Disco","Funk","Dance","Latin","Reggaeton","K-Pop","Salsa","Bossa Nova","Gospel","Bluegrass","Ska","Emo","Screamo","Shoegaze","Post-Rock","Industrial","Experimental","Lo-Fi","Other"],ave=({onClose:e})=>{const{user:t}=ws(),{toast:r}=Er(),[n,a]=y.useState(null),[i,o]=y.useState([]),[l,c]=y.useState(!0),[d,f]=y.useState(!1),[u,h]=y.useState({location_city:"",gender:"",birthday:"",bio:"",similar_users_notifications:!0}),[m,v]=y.useState({genres:[],artists:[],customGenres:[],customArtists:[]});y.useEffect(()=>{t!=null&&t.id&&g()},[t==null?void 0:t.id]);const g=()=>E(void 0,null,function*(){var b;if(t!=null&&t.id)try{const{data:N,error:S}=yield T.from("users").select("*").eq("user_id",t.id).single();if(S&&S.code!=="PGRST116")throw S;N&&(a(N),h({location_city:N.location_city||"",gender:N.gender||"",birthday:N.birthday||"",bio:N.bio||"",similar_users_notifications:(b=N.similar_users_notifications)!=null?b:!0}));const k=yield Ox.getUserMusicTags(t.id);o(k);const C=k.filter(R=>R.tag_type==="genre").map(R=>R.tag_value),A=k.filter(R=>R.tag_type==="artist").map(R=>R.tag_value);v(R=>V(D({},R),{genres:C,artists:A}))}catch(N){console.error("Error fetching user data:",N),r({title:"Error",description:"Failed to load your preferences",variant:"destructive"})}finally{c(!1)}}),x=(b,N)=>{h(S=>V(D({},S),{[b]:N}))},_=(b,N,S)=>E(void 0,null,function*(){if(t!=null&&t.id)try{if(S)yield Ox.addMusicTag(t.id,{tag_type:b,tag_value:N,tag_source:"manual",weight:5});else{const R=i.find(I=>I.tag_type===b&&I.tag_value===N);R&&(yield Ox.removeMusicTag(t.id,R.id))}const k=yield Ox.getUserMusicTags(t.id);o(k);const C=k.filter(R=>R.tag_type==="genre").map(R=>R.tag_value),A=k.filter(R=>R.tag_type==="artist").map(R=>R.tag_value);v(R=>V(D({},R),{genres:C,artists:A}))}catch(k){console.error("Error updating music tag:",k),r({title:"Error",description:"Failed to update music preferences",variant:"destructive"})}}),w=()=>E(void 0,null,function*(){if(t!=null&&t.id){f(!0);try{const{error:b}=yield T.from("users").update({location_city:u.location_city.trim()||null,gender:u.gender.trim()||null,birthday:u.birthday.trim()||null,bio:u.bio.trim()||null,similar_users_notifications:u.similar_users_notifications,updated_at:new Date().toISOString()}).eq("user_id",t.id);if(b)throw b;r({title:"Success",description:"Your preferences have been saved"}),e&&e()}catch(b){console.error("Error saving preferences:",b),r({title:"Error",description:"Failed to save preferences",variant:"destructive"})}finally{f(!1)}}});return l?s.jsx("div",{className:"flex items-center justify-center p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading preferences..."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(Is,{className:"w-5 h-5 text-primary"}),"Profile & Preferences"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your profile information and personalization settings"})]}),s.jsx(hl,{}),s.jsxs(Ze,{children:[s.jsx(kr,{className:"pb-3",children:s.jsxs(Lr,{className:"text-base flex items-center gap-2",children:[s.jsx(yr,{className:"w-4 h-4"}),"Location"]})}),s.jsx(tt,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"location",children:"City"}),s.jsx(Nr,{id:"location",value:u.location_city,onChange:b=>x("location_city",b.target.value),placeholder:"Enter your city",maxLength:100,className:"bg-white"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Used for local event discovery and recommendations"})]})})]}),s.jsxs(Ze,{children:[s.jsx(kr,{className:"pb-3",children:s.jsxs(Lr,{className:"text-base flex items-center gap-2",children:[s.jsx(Vr,{className:"w-4 h-4"}),"Demographics"]})}),s.jsxs(tt,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"gender",children:"Gender"}),s.jsxs(aa,{value:u.gender||void 0,onValueChange:b=>x("gender",b),children:[s.jsx(Gs,{className:"bg-white",children:s.jsx(ia,{placeholder:"Select your gender (optional)"})}),s.jsxs(Ys,{className:"bg-white",children:[s.jsx(Bt,{value:"male",children:"Male"}),s.jsx(Bt,{value:"female",children:"Female"}),s.jsx(Bt,{value:"non-binary",children:"Non-binary"}),s.jsx(Bt,{value:"prefer-not-to-say",children:"Prefer not to say"}),s.jsx(Bt,{value:"other",children:"Other"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"birthday",children:"Birthday"}),s.jsx(Nr,{id:"birthday",type:"date",value:u.birthday,onChange:b=>x("birthday",b.target.value),max:(()=>{const b=new Date;return b.setFullYear(b.getFullYear()-13),b.toISOString().split("T")[0]})(),className:"bg-white"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your age (not exact birthday) helps with event recommendations and safety"})]})]})]}),s.jsxs(Ze,{children:[s.jsx(kr,{className:"pb-3",children:s.jsxs(Lr,{className:"text-base flex items-center gap-2",children:[s.jsx(iee,{className:"w-4 h-4"}),"Bio"]})}),s.jsx(tt,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"bio",children:"About You"}),s.jsx(_s,{id:"bio",value:u.bio,onChange:b=>x("bio",b.target.value),placeholder:"Tell people about yourself...",maxLength:200,rows:3,className:"bg-white"}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[u.bio.length,"/200 characters"]})]})})]}),s.jsxs(Ze,{children:[s.jsx(kr,{className:"pb-3",children:s.jsxs(Lr,{className:"text-base flex items-center gap-2",children:[s.jsx(Ft,{className:"w-4 h-4"}),"Music Preferences"]})}),s.jsxs(tt,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(qt,{className:"text-sm font-medium",children:"Favorite Genres"}),s.jsxs(et,{variant:"secondary",children:[m.genres.length,"/7"]})]}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:W7.slice(0,20).map(b=>s.jsx(ce,{type:"button",variant:m.genres.includes(b)?"default":"outline",size:"sm",onClick:()=>_("genre",b,!m.genres.includes(b)),disabled:!m.genres.includes(b)&&m.genres.length>=7,className:"justify-start text-xs",children:b},b))}),m.genres.length>=7&&s.jsx("p",{className:"text-xs text-amber-600",children:"Maximum of 7 genres selected"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(qt,{className:"text-sm font-medium",children:"Favorite Artists"}),s.jsxs(et,{variant:"secondary",children:[m.artists.length,"/15"]})]}),m.artists.length>0?s.jsx("div",{className:"flex flex-wrap gap-2",children:m.artists.map(b=>s.jsxs(et,{variant:"secondary",className:"flex items-center gap-1",children:[b,s.jsx("button",{type:"button",onClick:()=>_("artist",b,!1),className:"ml-1 text-xs hover:text-destructive",children:""})]},b))}):s.jsx("p",{className:"text-sm text-muted-foreground",children:"Add artists by searching for them in the search bar or during onboarding"})]})]})]}),s.jsxs(Ze,{children:[s.jsx(kr,{className:"pb-3",children:s.jsxs(Lr,{className:"text-base flex items-center gap-2",children:[s.jsx(Ud,{className:"w-4 h-4"}),"Notifications"]})}),s.jsx(tt,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:"Similar Users Notifications"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Get notified when similar users (age, gender, interests) show interest in events"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Helps you connect with people who share your interests and demographics"})]}),s.jsx(lv,{checked:u.similar_users_notifications,onCheckedChange:b=>x("similar_users_notifications",b)})]})})]}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsxs(ce,{onClick:w,disabled:d,className:"min-w-[120px]",children:[s.jsx(LP,{className:"w-4 h-4 mr-2"}),d?"Saving...":"Save Changes"]})})]})};function H7(e){return E(this,null,function*(){try{const{data:t,error:r}=yield T.from("user_settings_preferences").select("*").eq("user_id",e).single();if(r){if(r.code==="PGRST116")return yield G7(e);throw console.error("Error fetching user settings preferences:",r),r}return t}catch(t){return console.error("Failed to get user settings preferences:",t),null}})}function ive(){return E(this,null,function*(){try{const{data:{user:e}}=yield T.auth.getUser();if(!e)throw new Error("No authenticated user");return yield H7(e.id)}catch(e){return console.error("Failed to get current user settings preferences:",e),null}})}function ove(e,t){return E(this,null,function*(){try{yield lve(e);const{data:r,error:n}=yield T.from("user_settings_preferences").update(t).eq("user_id",e).select().single();if(n)throw console.error("Error updating user settings preferences:",n),n;return r}catch(r){return console.error("Failed to update user settings preferences:",r),null}})}function hS(e){return E(this,null,function*(){try{const{data:{user:t}}=yield T.auth.getUser();if(!t)throw new Error("No authenticated user");return yield ove(t.id,e)}catch(t){return console.error("Failed to update current user settings preferences:",t),null}})}function G7(e){return E(this,null,function*(){try{const{data:t,error:r}=yield T.from("user_settings_preferences").insert({user_id:e,enable_push_notifications:!0,enable_emails:!0,is_public_profile:!0}).select().single();if(r)throw console.error("Error creating user settings preferences:",r),r;return t}catch(t){return console.error("Failed to create user settings preferences:",t),null}})}function lve(e){return E(this,null,function*(){try{let t=yield H7(e);return t||(t=yield G7(e)),t}catch(t){return console.error("Failed to ensure user settings preferences exist:",t),null}})}const cve=({isOpen:e,onClose:t,onSignOut:r,userEmail:n})=>{go("view","settings",{source:"settings"},void 0,{enabled:e});const[a,i]=y.useState(!1),[o,l]=y.useState("menu"),[c,d]=y.useState(!1),[f,u]=y.useState(!1),[h,m]=y.useState(""),[v,g]=y.useState(!0),[x,_]=y.useState(!1),[w,b]=y.useState(!0),[N,S]=y.useState("user"),[k,C]=y.useState(!1),[A,R]=y.useState(!0),[I,O]=y.useState(!0),[z,M]=y.useState(!1),{toast:B}=Er(),{user:F}=ws(),U=()=>E(void 0,null,function*(){i(!0);try{yield r(),t(),B({title:"Signed out successfully",description:"You've been signed out of your account."})}catch(se){console.error("Error signing out:",se),B({title:"Error",description:"Failed to sign out. Please try again.",variant:"destructive"})}finally{i(!1)}}),H=()=>{l("menu"),m(""),t()},q=()=>{l("menu"),m("")},K=()=>E(void 0,null,function*(){if(!n){B({title:"Error",description:"No email address found for this account.",variant:"destructive"});return}d(!0);try{const{error:se}=yield T.auth.resetPasswordForEmail(n,{redirectTo:"https://synth-beta-testing.vercel.app/reset-password"});if(se)throw se;B({title:"Password reset email sent",description:"Check your email for instructions to reset your password."})}catch(se){console.error("Error sending password reset:",se),B({title:"Error",description:se.message||"Failed to send password reset email.",variant:"destructive"})}finally{d(!1)}}),Z=()=>E(void 0,null,function*(){if(!h.trim()){B({title:"Error",description:"Please enter a new email address.",variant:"destructive"});return}if(h===n){B({title:"Error",description:"The new email address must be different from your current email.",variant:"destructive"});return}u(!0);try{const{error:se}=yield T.auth.updateUser({email:h});if(se)throw se;B({title:"Email change confirmation sent",description:`Check ${h} for a confirmation link to complete the change.`}),m("")}catch(se){console.error("Error changing email:",se),B({title:"Error",description:se.message||"Failed to send email change confirmation.",variant:"destructive"})}finally{u(!1)}}),ne=se=>E(void 0,null,function*(){if(F!=null&&F.id){_(!0);try{if(se&&!(yield Qh.hasProfilePicture(F.id))){B({title:"Profile Picture Required",description:"You must upload a profile picture before making your profile public. Go to Edit Profile to add a photo.",variant:"destructive"}),_(!1);return}if(yield Qh.setProfileVisibility(F.id,se))yield hS({is_public_profile:se}),g(se),B({title:se?"Profile is now public":"Profile is now private",description:se?"Your profile is visible to all users.":"Your profile is only visible to your friends."});else throw new Error("Failed to update visibility")}catch(de){console.error("Error toggling profile visibility:",de),B({title:"Error",description:"Failed to update profile visibility. Please try again.",variant:"destructive"})}finally{_(!1)}}}),Y=se=>E(void 0,null,function*(){if(F!=null&&F.id){M(!0);try{if(yield hS({enable_push_notifications:se}))R(se),B({title:se?"Push notifications enabled":"Push notifications disabled",description:se?"You will receive push notifications.":"Push notifications are now disabled."});else throw new Error("Failed to update preferences")}catch(de){console.error("Error toggling push notifications:",de),B({title:"Error",description:"Failed to update push notification preferences. Please try again.",variant:"destructive"})}finally{M(!1)}}}),X=se=>E(void 0,null,function*(){if(F!=null&&F.id){M(!0);try{if(yield hS({enable_emails:se}))O(se),B({title:se?"Email notifications enabled":"Email notifications disabled",description:se?"You will receive email notifications.":"Email notifications are now disabled."});else throw new Error("Failed to update preferences")}catch(de){console.error("Error toggling email notifications:",de),B({title:"Error",description:"Failed to update email preferences. Please try again.",variant:"destructive"})}finally{M(!1)}}});return y.useEffect(()=>{e&&(F!=null&&F.id)&&(Qh.getUserVisibilitySettings(F.id).then(se=>{se&&(g(se.is_public_profile),b(se.has_avatar))}).catch(se=>{console.error("Error loading visibility settings:",se),g(!0),b(!0)}),M(!0),ive().then(se=>{se&&(R(se.enable_push_notifications),O(se.enable_emails),se.is_public_profile!==void 0&&g(se.is_public_profile))}).catch(se=>{console.error("Error loading user settings preferences:",se)}).finally(()=>{M(!1)}),T.from("users").select("account_type, verified").eq("user_id",F.id).single().then(({data:se})=>{se&&(S(se.account_type||"user"),C(se.verified||!1))}))},[e,F==null?void 0:F.id]),s.jsx(vn,{open:e,onOpenChange:H,children:s.jsxs(hn,{className:"max-w-md w-[95vw] max-h-[90vh] overflow-y-auto",children:[s.jsx(Hn,{children:s.jsxs(Sn,{className:"flex items-center gap-2",children:[o!=="menu"&&s.jsx(ce,{variant:"ghost",size:"sm",onClick:q,className:"mr-2 -ml-2",children:" Back"}),o==="menu"&&s.jsx(wl,{className:"w-5 h-5"}),o==="menu"?"Settings":o==="onboarding-preferences"?"Profile & Preferences":o==="security-actions"?"Security Actions":o==="verification"?"Verification Status":"Settings"]})}),o==="menu"?s.jsxs("div",{className:"space-y-4",children:[n&&s.jsx("div",{className:"p-3 bg-muted/50 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Is,{className:"w-4 h-4"}),s.jsxs("span",{children:["Signed in as: ",n]})]})}),s.jsx(hl,{}),s.jsx("div",{className:"p-4 bg-muted/30 rounded-lg border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[v?s.jsx(Jd,{className:"w-5 h-5 text-primary mt-0.5"}):s.jsx(HQ,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:"Public Profile"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:v?"Your profile is visible to all users":"Your profile is only visible to friends"}),!w&&s.jsxs("div",{className:"text-xs text-amber-600 mt-1 flex items-center gap-1",children:[s.jsx(df,{className:"w-3 h-3"}),"Profile picture required to make profile public"]})]})]}),s.jsx(lv,{checked:v,onCheckedChange:ne,disabled:x})]})}),s.jsx(hl,{}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"p-4 bg-muted/30 rounded-lg border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[s.jsx(Ud,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:"Push Notifications"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:A?"You will receive push notifications":"Push notifications are disabled"})]})]}),s.jsx(lv,{checked:A,onCheckedChange:Y,disabled:z})]})}),s.jsx("div",{className:"p-4 bg-muted/30 rounded-lg border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[s.jsx(ez,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:"Email Notifications"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:I?"You will receive email notifications":"Email notifications are disabled"})]})]}),s.jsx(lv,{checked:I,onCheckedChange:X,disabled:z})]})})]}),s.jsx(hl,{}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ce,{variant:"ghost",className:"w-full justify-start gap-3 h-12",onClick:()=>l("onboarding-preferences"),children:[s.jsx(Is,{className:"w-5 h-5"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-medium",children:"Profile & Preferences"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Manage your profile information and preferences"})]})]}),s.jsxs(ce,{variant:"ghost",className:"w-full justify-start gap-3 h-12",onClick:()=>l("security-actions"),children:[s.jsx(wl,{className:"w-5 h-5"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-medium",children:"Security Actions"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Change password, email, and security settings"})]})]}),s.jsxs(ce,{variant:"ghost",className:"w-full justify-start gap-3 h-12",onClick:()=>l("verification"),children:[s.jsx(pc,{className:"w-5 h-5"}),s.jsxs("div",{className:"text-left",children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:["Verification Status",k&&s.jsx("span",{className:"text-xs text-green-600",children:" Verified"})]}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Track your verification progress"})]})]})]}),s.jsx(hl,{}),s.jsxs(ce,{variant:"destructive",className:"w-full gap-3 h-12",onClick:U,disabled:a,children:[s.jsx(QF,{className:"w-5 h-5"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-medium",children:a?"Signing out...":"Sign Out"}),s.jsx("div",{className:"text-sm opacity-80",children:a?"Please wait...":"Sign out of your account"})]})]})]}):o==="onboarding-preferences"?s.jsx(ave,{onClose:q}):o==="verification"?s.jsx("div",{className:"p-4",children:(F==null?void 0:F.id)&&s.jsx(F9,{userId:F.id,accountType:N,verified:k})}):o==="security-actions"?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(wl,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Security Actions"})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your account security settings"})]}),s.jsx(hl,{}),n&&s.jsx("div",{className:"p-3 bg-muted/50 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Kk,{className:"w-4 h-4"}),s.jsxs("span",{children:["Current email: ",s.jsx("strong",{children:n})]})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[s.jsx(Kk,{className:"w-5 h-5"}),"Change Email Address"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Change your email address. You'll receive a confirmation email at the new address."}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx(qt,{htmlFor:"new-email",children:"New Email Address"}),s.jsx(Nr,{id:"new-email",type:"email",placeholder:"Enter new email address",value:h,onChange:se=>m(se.target.value),disabled:f})]}),s.jsx(ce,{onClick:Z,disabled:f||!h.trim(),className:"w-full",children:f?"Sending...":"Send Email Change Confirmation"})]})]}),s.jsx(hl,{}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[s.jsx(JF,{className:"w-5 h-5"}),"Reset Password"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Send a password reset link to your email address."}),s.jsx(ce,{variant:"outline",onClick:K,disabled:c,className:"w-full",children:c?"Sending...":"Send Password Reset Email"})]}),s.jsx(hl,{}),s.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(MP,{className:"w-4 h-4 text-blue-600 mt-0.5"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"About Security Emails"}),s.jsx("p",{className:"text-blue-700",children:"All security emails are sent automatically and cannot be disabled for your account protection. Check your email (including spam folder) for confirmation links."})]})]})})]}):null]})})};function vg(){return s.jsx("div",{className:"bg-white rounded-xl p-4 border border-white/20 shadow-sm animate-pulse",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-100 to-pink-200 rounded-full flex items-center justify-center",children:s.jsx(ow,{size:"sm",className:"opacity-30 animate-breathe"})}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-3/4"}),s.jsx("div",{className:"h-3 bg-gradient-to-r from-pink-50 to-white rounded animate-pulse w-1/2"}),s.jsx("div",{className:"h-3 bg-gradient-to-r from-pink-50 to-white rounded animate-pulse w-1/4"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-pink-200 to-pink-300 rounded-full animate-pulse"}),s.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-gray-100 to-white rounded-full animate-pulse"})]})]})})}const dve=({currentUserId:e,onBack:t,onNavigateToProfile:r,onNavigateToEvent:n,onNavigateToArtist:a,onNavigateToVenue:i})=>{go("view","notifications",{source:"notifications"});const[o,l]=y.useState([]),[c,d]=y.useState(!0),[f,u]=y.useState(0),{toast:h}=Er(),{sessionExpired:m}=ws();y.useEffect(()=>{if(m){d(!1);return}v()},[e,m]);const v=()=>E(void 0,null,function*(){try{if(m){console.log("Session expired, skipping notifications fetch"),d(!1);return}const[A,R]=yield Promise.all([gh.getNotifications({limit:50}),gh.getUnreadCount()]);l(A.notifications),u(R)}catch(A){console.error("Error fetching notifications:",A),h({title:"Error",description:"Failed to load notifications. Please try again.",variant:"destructive"}),l([]),u(0)}finally{d(!1)}}),g=A=>E(void 0,null,function*(){try{yield gh.markAsRead(A),l(I=>I.map(O=>O.id===A?V(D({},O),{is_read:!0}):O));const R=yield gh.getUnreadCount();u(R)}catch(R){console.error("Error marking notification as read:",R),h({title:"Error",description:"Failed to mark notification as read",variant:"destructive"})}}),x=()=>E(void 0,null,function*(){try{yield gh.markAllAsRead(),yield v(),h({title:"All notifications marked as read",description:"You're all caught up!"})}catch(A){console.error("Error marking all notifications as read:",A),h({title:"Error",description:"Failed to mark all notifications as read",variant:"destructive"})}}),_=A=>E(void 0,null,function*(){var R;try{const{data:I,error:O}=yield T.from("user_relationships").select("status").eq("id",A).eq("relationship_type","friend").single();if(O){const z=O.message||"";if(O.code==="PGRST301"||O.code==="42501"||z.includes("406")||z.includes("Not Acceptable")){console.log(" RLS restriction, cannot check status directly");const{data:{user:M}}=yield T.auth.getUser();if(M){const{data:B}=yield T.from("notifications").select("data").eq("type","friend_request").eq("user_id",M.id).eq("data->>request_id",A).single();if((R=B==null?void 0:B.data)!=null&&R.sender_id){const F=B.data.sender_id,{data:U}=yield T.from("user_relationships").select("user_id, related_user_id, status").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${M.id},related_user_id.eq.${M.id}`);if(U&&U.length>0&&U.find(q=>q.user_id===M.id&&q.related_user_id===F||q.user_id===F&&q.related_user_id===M.id))return"accepted"}}return"unknown"}return console.log(" Request not found:",O),"not_found"}return(I==null?void 0:I.status)||"not_found"}catch(I){return console.error("Error checking friend request status:",I),"not_found"}}),w=A=>E(void 0,null,function*(){try{const{data:R,error:I}=yield T.from("notifications").select("id, data").eq("type","friend_request").eq("user_id",e);if(I)throw console.error("Could not fetch notifications for deletion:",I),new Error(`Failed to fetch notifications: ${I.message}`);const O=(R==null?void 0:R.filter(B=>{var U;const F=(U=B.data)==null?void 0:U.request_id;return F==null||A==null?F===A:String(F)===String(A)}))||[];if(O.length===0){console.log("No matching notification found to delete");return}const z=O.map(B=>B.id),{error:M}=yield T.from("notifications").delete().in("id",z);if(M)throw console.error("Could not delete notification:",M),new Error(`Failed to delete notification: ${M.message}`);console.log(` Deleted ${z.length} friend request notification(s)`)}catch(R){throw console.error("Error deleting notification:",R),R}}),b=A=>E(void 0,null,function*(){var R,I,O,z;if(console.log(" Accepting friend request:",A),!A){h({title:"Error",description:"Invalid friend request. Please refresh and try again.",variant:"destructive"});return}try{const M=typeof A=="string"?A:String(A);console.log(" Converted request ID:",M);const{error:B}=yield T.rpc("accept_friend_request",{request_id:M});if(console.log(" Accept friend request result:",B),B){if(console.error("Error accepting friend request:",B),B.code==="23505"||(R=B.message)!=null&&R.includes("duplicate key")||(I=B.message)!=null&&I.includes("unique constraint")){console.log(" Friendship already exists, treating as success"),l(F=>F.filter(U=>{var q;const H=(q=U.data)==null?void 0:q.request_id;return H==null||A==null?H!==A:String(H)!==String(A)}));try{yield w(A)}catch(F){console.error("Failed to delete notification, but continuing:",F)}yield new Promise(F=>setTimeout(F,500)),yield v(),h({title:"Already Friends! ",description:"You're already friends with this person."});return}if((O=B.message)!=null&&O.includes("not found")||(z=B.message)!=null&&z.includes("already processed")){const F=yield _(A);h(F==="accepted"?{title:"Already Friends! ",description:"You're already friends with this person."}:{title:"Request Already Processed",description:"This friend request has already been handled."}),l(U=>U.filter(H=>{var K;const q=(K=H.data)==null?void 0:K.request_id;return q==null||A==null?q!==A:String(q)!==String(A)}));try{yield w(A)}catch(U){console.error("Failed to delete notification, but continuing:",U)}yield new Promise(U=>setTimeout(U,500)),yield v();return}throw B}l(F=>F.filter(U=>{var q;const H=(q=U.data)==null?void 0:q.request_id;return H==null||A==null?H!==A:String(H)!==String(A)}));try{yield w(A)}catch(F){console.error("Failed to delete notification, but continuing:",F)}yield new Promise(F=>setTimeout(F,500)),yield v(),h({title:"Friend Request Accepted! ",description:"You're now friends!"})}catch(M){console.error("Error accepting friend request:",M),h({title:"Error",description:M.message||"Failed to accept friend request. Please try again.",variant:"destructive"})}}),N=A=>E(void 0,null,function*(){var R,I;if(console.log(" Declining friend request:",A),!A){h({title:"Error",description:"Invalid friend request. Please refresh and try again.",variant:"destructive"});return}console.log(" Debug: Declining friend request with ID:",A);try{const{error:O}=yield T.rpc("decline_friend_request",{request_id:A});if(console.log(" Decline friend request result:",O),O){if(console.error("Error declining friend request:",O),(R=O.message)!=null&&R.includes("not found")||(I=O.message)!=null&&I.includes("already processed")){h({title:"Request Already Processed",description:"This friend request has already been handled.",variant:"destructive"}),l(z=>z.filter(M=>{var F;const B=(F=M.data)==null?void 0:F.request_id;return B==null||A==null?B!==A:String(B)!==String(A)}));try{yield w(A)}catch(z){console.error("Failed to delete notification, but continuing:",z)}yield new Promise(z=>setTimeout(z,500)),yield v();return}throw O}l(z=>z.filter(M=>{var F;const B=(F=M.data)==null?void 0:F.request_id;return B==null||A==null?B!==A:String(B)!==String(A)}));try{yield w(A)}catch(z){console.error("Failed to delete notification, but continuing:",z)}yield new Promise(z=>setTimeout(z,500)),yield v(),h({title:"Friend Request Declined",description:"The friend request has been declined."})}catch(O){console.error("Error declining friend request:",O),h({title:"Error",description:O.message||"Failed to decline friend request. Please try again.",variant:"destructive"})}}),S=A=>{switch(A){case"friend_request":return s.jsx(Id,{className:"w-4 h-4"});case"event_interest":return s.jsx(es,{className:"w-4 h-4"});case"review_like":return s.jsx(Xt,{className:"w-4 h-4"});case"review_comment":return s.jsx(Ln,{className:"w-4 h-4"});case"event_reminder":return s.jsx(Lt,{className:"w-4 h-4"});default:return s.jsx(Ud,{className:"w-4 h-4"})}},k=A=>{const R=new Date(A),O=Math.floor((new Date().getTime()-R.getTime())/(1e3*60));return O<1?"Just now":O<60?`${O}m ago`:O<1440?`${Math.floor(O/60)}h ago`:`${Math.floor(O/1440)}d ago`},C=A=>E(void 0,null,function*(){if(A.type==="friend_request"){yield g(A.id);return}g(A.id);const R=A.data;switch(A.type){case"artist_new_event":case"artist_profile_updated":R!=null&&R.event_id&&n?n(R.event_id):R!=null&&R.artist_id&&a?a(R.artist_id):A.artist_name&&a&&a(A.artist_name);break;case"venue_new_event":case"venue_profile_updated":A.venue_name&&i?i(A.venue_name):R!=null&&R.venue_name&&i&&i(R.venue_name),R!=null&&R.event_id&&n&&n(R.event_id);break;case"event_interest":case"event_attendance_reminder":case"event_reminder":case"friend_rsvp_going":case"friend_rsvp_changed":case"friend_review_posted":case"friend_attended_same_event":R!=null&&R.event_id&&n?n(R.event_id):A.event_title&&console.log("Navigate to event:",A.event_title);break;case"friend_request":case"friend_accepted":R!=null&&R.sender_id&&r?r(R.sender_id):R!=null&&R.friend_id&&r?r(R.friend_id):A.actor_user_id&&r&&r(A.actor_user_id);break;case"review_liked":case"review_commented":case"comment_replied":if(R!=null&&R.event_id&&n)n(R.event_id);else if(A.review_id)try{const{data:I}=yield T.from("reviews").select("event_id").eq("id",A.review_id).single();I!=null&&I.event_id&&n&&n(I.event_id)}catch(I){console.error("Error fetching review event:",I)}break}});return c?s.jsx("div",{className:"min-h-screen synth-gradient-card p-4 pb-20",children:s.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[s.jsx("div",{className:"glass-card inner-glow text-center space-y-3 p-4 mb-6 floating-shadow",children:s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx(ow,{size:"md",className:"hover-icon animate-breathe"}),s.jsx("div",{className:"h-8 bg-gray-200 rounded animate-pulse w-36"})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(vg,{}),s.jsx(vg,{}),s.jsx(vg,{}),s.jsx(vg,{}),s.jsx(vg,{})]})]})}):s.jsx("div",{className:"min-h-screen synth-gradient-card pb-20",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)"},children:s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsx("div",{className:"glass-card inner-glow text-center space-y-3 p-4 mb-6 floating-shadow",style:{marginTop:"var(--spacing-small, 12px)"},children:s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx(ce,{variant:"ghost",size:"sm",onClick:t,className:"hover-button absolute left-4",children:s.jsx(ks,{className:"w-4 h-4 hover-icon"})}),s.jsx(ow,{size:"md",className:"hover-icon"}),s.jsx("h1",{className:"gradient-text text-2xl font-bold",children:"Notifications"}),f>0&&s.jsxs(et,{variant:"default",className:"gradient-badge",children:[f," unread"]})]})}),o.length>0&&f>0&&s.jsx("div",{className:"glass-card inner-glow p-4 mb-6 floating-shadow",children:s.jsxs(ce,{variant:"outline",size:"sm",onClick:x,className:"hover-button w-full border-gray-200 hover:border-pink-400 hover:text-pink-500",children:[s.jsx(fa,{className:"w-4 h-4 mr-2 hover-icon"}),"Mark all as read"]})}),o.length===0?s.jsx(Ze,{className:"glass-card inner-glow floating-shadow",children:s.jsxs(tt,{className:"text-center py-12",children:[s.jsx(Ud,{className:"w-12 h-12 mx-auto mb-4 hover-icon",style:{background:"linear-gradient(135deg, #ec4899, #f472b6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}}),s.jsx("h3",{className:"text-lg font-semibold mb-2 gradient-text",children:"No notifications yet"}),s.jsx("p",{className:"text-gray-500",children:"When you get friend requests, event updates, or review activity, they'll appear here."})]})}):s.jsx("div",{className:"space-y-3",children:o.map(A=>s.jsx(Ze,{className:`glass-card inner-glow hover-card cursor-pointer floating-shadow ${A.is_read?"":"border-pink-300"}`,onClick:()=>C(A),children:s.jsx(tt,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 hover-icon",children:te.cloneElement(S(A.type),{style:{background:"linear-gradient(135deg, #ec4899, #f472b6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h4",{className:"font-semibold text-sm truncate gradient-text",children:A.title}),!A.is_read&&s.jsx("div",{className:"w-2 h-2 gradient-badge rounded-full flex-shrink-0"})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:A.message}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-500 bg-white/30 px-2 py-1 rounded backdrop-blur-sm",children:k(A.created_at)}),A.type==="friend_request"&&s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ce,{size:"sm",variant:"default",className:"hover-button gradient-button h-6 px-2",onClick:R=>E(void 0,null,function*(){var I;R.stopPropagation(),R.preventDefault(),yield b((I=A.data)==null?void 0:I.request_id)}),children:[s.jsx(fa,{className:"w-3 h-3 mr-1 hover-icon"}),"Accept"]}),s.jsxs(ce,{size:"sm",variant:"outline",className:"hover-button h-6 px-2 border-gray-200 hover:border-red-400 hover:text-red-500",onClick:R=>E(void 0,null,function*(){var I;R.stopPropagation(),R.preventDefault(),yield N((I=A.data)==null?void 0:I.request_id)}),children:[s.jsx(Yr,{className:"w-3 h-3 mr-1 hover-icon"}),"Decline"]})]})]})]})]})})},A.id))})]})})};class x_{static createEvent(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{MissingEntityRequestService:a}=yield Rr(()=>E(this,null,function*(){const{MissingEntityRequestService:o}=yield import("./missingEntityRequestService-DnUo_jW_.js");return{MissingEntityRequestService:o}}),[],import.meta.url);return{id:(yield a.submitRequest({entity_type:"event",entity_name:t.title,entity_description:t.artist_name&&t.venue_name?`${t.artist_name} at ${t.venue_name}`:void 0,entity_date:t.event_date,entity_location:t.venue_name,entity_image_url:t.poster_image_url,additional_info:{artist_name:t.artist_name,venue_name:t.venue_name,latitude:t.latitude,longitude:t.longitude,video_url:t.video_url,age_restriction:t.age_restriction,accessibility_info:t.accessibility_info,parking_info:t.parking_info,venue_capacity:t.venue_capacity,estimated_attendance:t.estimated_attendance,media_urls:t.media_urls}})).id,title:t.title,status:"pending",message:"Your event request has been submitted for review."}}catch(r){throw console.error("Error submitting event request:",r),r}})}static getMyCreatedEvents(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{data:n,error:a}=yield T.from("events").select("*").eq("created_by_user_id",t.id).order("created_at",{ascending:!1});if(a)throw a;return n||[]}catch(t){throw console.error("Error fetching created events:",t),t}})}static updateEvent(t,r){return E(this,null,function*(){try{const{data:{user:n},error:a}=yield T.auth.getUser();if(a||!n)throw new Error("User not authenticated");const{data:i,error:o}=yield T.from("events").select("created_by_user_id").eq("id",t).single();if(o)throw o;if(i.created_by_user_id!==n.id)throw new Error("You can only update events you created");const{data:l,error:c}=yield T.from("events").update(V(D({},r),{updated_at:new Date().toISOString()})).eq("id",t).select().single();if(c)throw c;return l}catch(n){throw console.error("Error updating event:",n),n}})}static deleteEvent(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:a,error:i}=yield T.from("events").select("created_by_user_id").eq("id",t).single();if(i)throw i;if(a.created_by_user_id!==r.id)throw new Error("You can only delete events you created");const{error:o}=yield T.from("events").delete().eq("id",t);if(o)throw o}catch(r){throw console.error("Error deleting event:",r),r}})}static canCreateEvents(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)return!1;const{data:n,error:a}=yield T.from("users").select("account_type").eq("user_id",t.id).single();return a?!1:["business","creator","admin"].includes(n.account_type)}catch(t){return console.error("Error checking create permissions:",t),!1}})}}function uve({open:e,onClose:t,onEventCreated:r,prefilledData:n}){const[a,i]=y.useState(!1),[o,l]=y.useState(D({title:"",artist_name:"",venue_name:"",event_date:"",latitude:void 0,longitude:void 0,poster_image_url:"",video_url:"",age_restriction:"",accessibility_info:"",parking_info:"",venue_capacity:void 0,estimated_attendance:void 0,media_urls:[]},n)),{toast:c}=Er(),d=(h,m)=>{l(v=>V(D({},v),{[h]:m}))},f=h=>E(this,null,function*(){if(h.preventDefault(),!o.title.trim()){c({title:"Title required",description:"Please enter an event title.",variant:"destructive"});return}i(!0);try{const m=yield x_.createEvent(o);c({title:"Event created!",description:"Your event has been created successfully."}),r==null||r(m),u()}catch(m){console.error("Error creating event:",m),c({title:"Creation failed",description:m instanceof Error?m.message:"Failed to create event",variant:"destructive"})}finally{i(!1)}}),u=()=>{a||(l(D({title:"",artist_name:"",venue_name:"",event_date:"",latitude:void 0,longitude:void 0,poster_image_url:"",video_url:"",age_restriction:"",accessibility_info:"",parking_info:"",venue_capacity:void 0,estimated_attendance:void 0,media_urls:[]},n)),t())};return s.jsx(vn,{open:e,onOpenChange:u,children:s.jsxs(hn,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[s.jsxs(Hn,{children:[s.jsxs(Sn,{className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"h-5 w-5 text-purple-600"}),"Create New Event"]}),s.jsx(ds,{children:"Create a new event for your audience. Fill in the details below."})]}),s.jsxs("form",{onSubmit:f,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(Ft,{className:"h-5 w-5"}),"Basic Information"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"title",children:"Event Title *"}),s.jsx(Nr,{id:"title",value:o.title,onChange:h=>d("title",h.target.value),placeholder:"e.g., Summer Music Festival 2024",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"artist_name",children:"Artist/Performer"}),s.jsx(Nr,{id:"artist_name",value:o.artist_name||"",onChange:h=>d("artist_name",h.target.value),placeholder:"e.g., The Rolling Stones"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"venue_name",children:"Venue"}),s.jsx(Nr,{id:"venue_name",value:o.venue_name||"",onChange:h=>d("venue_name",h.target.value),placeholder:"e.g., Madison Square Garden"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"event_date",children:"Event Date & Time"}),s.jsx(Nr,{id:"event_date",type:"datetime-local",value:o.event_date||"",onChange:h=>d("event_date",h.target.value)})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(yr,{className:"h-5 w-5"}),"Location Details"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"latitude",children:"Latitude"}),s.jsx(Nr,{id:"latitude",type:"number",step:"any",value:o.latitude||"",onChange:h=>d("latitude",h.target.value?parseFloat(h.target.value):void 0),placeholder:"40.7128"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"longitude",children:"Longitude"}),s.jsx(Nr,{id:"longitude",type:"number",step:"any",value:o.longitude||"",onChange:h=>d("longitude",h.target.value?parseFloat(h.target.value):void 0),placeholder:"-74.0060"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(Vr,{className:"h-5 w-5"}),"Additional Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"venue_capacity",children:"Venue Capacity"}),s.jsx(Nr,{id:"venue_capacity",type:"number",value:o.venue_capacity||"",onChange:h=>d("venue_capacity",h.target.value?parseInt(h.target.value):void 0),placeholder:"5000"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"estimated_attendance",children:"Estimated Attendance"}),s.jsx(Nr,{id:"estimated_attendance",type:"number",value:o.estimated_attendance||"",onChange:h=>d("estimated_attendance",h.target.value?parseInt(h.target.value):void 0),placeholder:"3000"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"age_restriction",children:"Age Restriction"}),s.jsx(Nr,{id:"age_restriction",value:o.age_restriction||"",onChange:h=>d("age_restriction",h.target.value),placeholder:"e.g., 18+, All Ages, 21+"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"accessibility_info",children:"Accessibility Information"}),s.jsx(_s,{id:"accessibility_info",value:o.accessibility_info||"",onChange:h=>d("accessibility_info",h.target.value),placeholder:"Information about accessibility features...",rows:3})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"parking_info",children:"Parking Information"}),s.jsx(_s,{id:"parking_info",value:o.parking_info||"",onChange:h=>d("parking_info",h.target.value),placeholder:"Information about parking options...",rows:3})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(Ft,{className:"h-5 w-5"}),"Media"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"poster_image_url",children:"Poster Image URL"}),s.jsx(Nr,{id:"poster_image_url",value:o.poster_image_url||"",onChange:h=>d("poster_image_url",h.target.value),placeholder:"https://example.com/poster.jpg"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"video_url",children:"Video URL"}),s.jsx(Nr,{id:"video_url",value:o.video_url||"",onChange:h=>d("video_url",h.target.value),placeholder:"https://youtube.com/watch?v=..."})]})]})]}),s.jsxs(Tf,{children:[s.jsx(ce,{type:"button",variant:"outline",onClick:u,disabled:a,children:"Cancel"}),s.jsx(ce,{type:"submit",onClick:f,disabled:a,className:"bg-purple-600 hover:bg-purple-700",children:a?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Lt,{className:"w-4 h-4 mr-2"}),"Create Event"]})})]})]})})}function fve(){hf();const{toast:e}=Er(),[t,r]=y.useState([]),[n,a]=y.useState(!0),[i,o]=y.useState(!1),[l,c]=y.useState(!1);hf(),y.useEffect(()=>{d(),f()},[]);const d=()=>E(this,null,function*(){try{a(!0);const x=yield x_.getMyCreatedEvents();r(x)}catch(x){console.error("Error loading events:",x),e({title:"Error loading events",description:"Failed to load your created events.",variant:"destructive"})}finally{a(!1)}}),f=()=>E(this,null,function*(){try{const x=yield x_.canCreateEvents();c(x)}catch(x){console.error("Error checking permissions:",x),c(!1)}}),u=x=>{r(_=>[x,..._])},h=x=>E(this,null,function*(){if(confirm("Are you sure you want to delete this event? This action cannot be undone."))try{yield x_.deleteEvent(x),r(_=>_.filter(w=>w.id!==x)),e({title:"Event deleted",description:"The event has been deleted successfully."})}catch(_){console.error("Error deleting event:",_),e({title:"Delete failed",description:_ instanceof Error?_.message:"Failed to delete event",variant:"destructive"})}}),m=x=>new Date(x).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),v=x=>new Date(x).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),g=({event:x})=>s.jsxs(Ze,{className:"hover:shadow-lg transition-shadow",children:[s.jsx(kr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx(Lr,{className:"text-lg mb-2",children:x.title}),x.artist_name&&s.jsx("p",{className:"text-purple-600 font-medium mb-1",children:x.artist_name}),x.venue_name&&s.jsxs("div",{className:"flex items-center gap-1 text-gray-600 text-sm",children:[s.jsx(yr,{className:"h-4 w-4"}),s.jsx("span",{children:x.venue_name})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ce,{variant:"outline",size:"sm",onClick:()=>{e({title:"Edit Event",description:"Event editing features coming soon!"})},children:s.jsx(Ol,{className:"h-4 w-4"})}),s.jsx(ce,{variant:"outline",size:"sm",onClick:()=>h(x.id),className:"text-red-600 hover:text-red-700 hover:border-red-300",children:s.jsx(Ko,{className:"h-4 w-4"})})]})]})}),s.jsx(tt,{className:"pt-0",children:s.jsxs("div",{className:"space-y-2",children:[x.event_date&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Lt,{className:"h-4 w-4"}),s.jsx("span",{children:m(x.event_date)}),s.jsx(Oa,{className:"h-4 w-4 ml-2"}),s.jsx("span",{children:v(x.event_date)})]}),(x.venue_capacity||x.estimated_attendance)&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Vr,{className:"h-4 w-4"}),x.venue_capacity&&s.jsxs("span",{children:["Capacity: ",x.venue_capacity.toLocaleString()]}),x.venue_capacity&&x.estimated_attendance&&s.jsx("span",{children:""}),x.estimated_attendance&&s.jsxs("span",{children:["Est. Attendance: ",x.estimated_attendance.toLocaleString()]})]}),x.age_restriction&&s.jsx(et,{variant:"outline",className:"text-xs",children:x.age_restriction})]})})]});return l?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Events"}),s.jsx("p",{className:"text-gray-600",children:"Manage your created events"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ce,{variant:"outline",onClick:d,disabled:n,children:[s.jsx(vi,{className:`h-4 w-4 mr-2 ${n?"animate-spin":""}`}),"Refresh"]}),s.jsxs(ce,{onClick:()=>o(!0),children:[s.jsx(Yo,{className:"h-4 w-4 mr-2"}),"Create Event"]})]})]})}),n?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(fr,{className:"h-8 w-8 animate-spin text-purple-600"})}):s.jsx("div",{className:"space-y-4",children:t.length===0?s.jsx(Ze,{children:s.jsxs(tt,{className:"py-12 text-center",children:[s.jsx(Lt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"You haven't created any events yet"}),s.jsxs(ce,{onClick:()=>o(!0),children:[s.jsx(Yo,{className:"h-4 w-4 mr-2"}),"Create Your First Event"]})]})}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(Lt,{className:"h-5 w-5"}),"Created Events (",t.length,")"]})}),s.jsx("div",{className:"space-y-3",children:t.map(x=>s.jsx(g,{event:x},x.id))})]})}),s.jsx(uve,{open:i,onClose:()=>o(!1),onEventCreated:u})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsx("div",{className:"max-w-4xl mx-auto",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"My Events"}),s.jsx("p",{className:"text-gray-600 mb-8",children:"Only business, creator, and admin accounts can create events."}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-blue-900 mb-2",children:"What you can do:"}),s.jsxs("ul",{className:"text-blue-800 space-y-1",children:[s.jsx("li",{children:" Express interest in events"}),s.jsx("li",{children:" Meet people going to the same events"}),s.jsx("li",{children:" Chat with matched users"}),s.jsx("li",{children:" Leave reviews and ratings"})]})]})]})})})}const hve=mp("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),vA=y.forwardRef((a,n)=>{var i=a,{className:e,variant:t}=i,r=ge(i,["className","variant"]);return s.jsx("div",D({ref:n,role:"alert",className:Oe(hve({variant:t}),e)},r))});vA.displayName="Alert";const mve=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx("h5",D({ref:r,className:Oe("mb-1 font-medium leading-none tracking-tight",e)},t))});mve.displayName="AlertTitle";const yA=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx("div",D({ref:r,className:Oe("text-sm [&_p]:leading-relaxed",e)},t))});yA.displayName="AlertDescription";const h4="onboarding_reminder_dismissed",pve=3*24*60*60*1e3,gve=({onComplete:e})=>{const[t,r]=y.useState(!1);y.useEffect(()=>{const i=localStorage.getItem(h4);if(i){const o=parseInt(i,10);if(Date.now()-o<pve)return}r(!0)},[]);const n=()=>{localStorage.setItem(h4,Date.now().toString()),r(!1)},a=()=>{r(!1),e()};return t?s.jsx(vA,{className:"rounded-none border-x-0 border-t-0 bg-gradient-to-r from-primary/10 to-accent/10",style:{marginTop:"env(safe-area-inset-top, 0px)"},children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs(yA,{className:"flex-1 text-sm",children:[s.jsx("strong",{className:"font-semibold",children:"Complete your profile"})," to get personalized event recommendations and connect with people who share your music taste."]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ce,{size:"sm",onClick:a,children:"Complete Profile"}),s.jsxs(ce,{size:"sm",variant:"ghost",onClick:n,className:"h-8 w-8 p-0",children:[s.jsx(Yr,{className:"w-4 h-4"}),s.jsx("span",{className:"sr-only",children:"Dismiss"})]})]})]})}):null};function Y7(e){return t=>typeof t===e}var vve=Y7("function"),yve=e=>e===null,m4=e=>Object.prototype.toString.call(e).slice(8,-1)==="RegExp",p4=e=>!xve(e)&&!yve(e)&&(vve(e)||typeof e=="object"),xve=Y7("undefined");function _ve(e,t){const{length:r}=e;if(r!==t.length)return!1;for(let n=r;n--!==0;)if(!Wa(e[n],t[n]))return!1;return!0}function wve(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new DataView(e.buffer),n=new DataView(t.buffer);let a=e.byteLength;for(;a--;)if(r.getUint8(a)!==n.getUint8(a))return!1;return!0}function bve(e,t){if(e.size!==t.size)return!1;for(const r of e.entries())if(!t.has(r[0]))return!1;for(const r of e.entries())if(!Wa(r[1],t.get(r[0])))return!1;return!0}function jve(e,t){if(e.size!==t.size)return!1;for(const r of e.entries())if(!t.has(r[0]))return!1;return!0}function Wa(e,t){if(e===t)return!0;if(e&&p4(e)&&t&&p4(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return _ve(e,t);if(e instanceof Map&&t instanceof Map)return bve(e,t);if(e instanceof Set&&t instanceof Set)return jve(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return wve(e,t);if(m4(e)&&m4(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let a=r.length;a--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[a]))return!1;for(let a=r.length;a--!==0;){const i=r[a];if(!(i==="_owner"&&e.$$typeof)&&!Wa(e[i],t[i]))return!1}return!0}return Number.isNaN(e)&&Number.isNaN(t)?!0:e===t}var Nve=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],Sve=["bigint","boolean","null","number","string","symbol","undefined"];function K1(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(/HTML\w+Element/.test(t))return"HTMLElement";if(kve(t))return t}function nl(e){return t=>K1(t)===e}function kve(e){return Nve.includes(e)}function kp(e){return t=>typeof t===e}function Eve(e){return Sve.includes(e)}var Cve=["innerHTML","ownerDocument","style","attributes","nodeValue"];function Vt(e){if(e===null)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(Vt.array(e))return"Array";if(Vt.plainFunction(e))return"Function";const t=K1(e);return t||"Object"}Vt.array=Array.isArray;Vt.arrayOf=(e,t)=>!Vt.array(e)&&!Vt.function(t)?!1:e.every(r=>t(r));Vt.asyncGeneratorFunction=e=>K1(e)==="AsyncGeneratorFunction";Vt.asyncFunction=nl("AsyncFunction");Vt.bigint=kp("bigint");Vt.boolean=e=>e===!0||e===!1;Vt.date=nl("Date");Vt.defined=e=>!Vt.undefined(e);Vt.domElement=e=>Vt.object(e)&&!Vt.plainObject(e)&&e.nodeType===1&&Vt.string(e.nodeName)&&Cve.every(t=>t in e);Vt.empty=e=>Vt.string(e)&&e.length===0||Vt.array(e)&&e.length===0||Vt.object(e)&&!Vt.map(e)&&!Vt.set(e)&&Object.keys(e).length===0||Vt.set(e)&&e.size===0||Vt.map(e)&&e.size===0;Vt.error=nl("Error");Vt.function=kp("function");Vt.generator=e=>Vt.iterable(e)&&Vt.function(e.next)&&Vt.function(e.throw);Vt.generatorFunction=nl("GeneratorFunction");Vt.instanceOf=(e,t)=>!e||!t?!1:Object.getPrototypeOf(e)===t.prototype;Vt.iterable=e=>!Vt.nullOrUndefined(e)&&Vt.function(e[Symbol.iterator]);Vt.map=nl("Map");Vt.nan=e=>Number.isNaN(e);Vt.null=e=>e===null;Vt.nullOrUndefined=e=>Vt.null(e)||Vt.undefined(e);Vt.number=e=>kp("number")(e)&&!Vt.nan(e);Vt.numericString=e=>Vt.string(e)&&e.length>0&&!Number.isNaN(Number(e));Vt.object=e=>!Vt.nullOrUndefined(e)&&(Vt.function(e)||typeof e=="object");Vt.oneOf=(e,t)=>Vt.array(e)?e.indexOf(t)>-1:!1;Vt.plainFunction=nl("Function");Vt.plainObject=e=>{if(K1(e)!=="Object")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.getPrototypeOf({})};Vt.primitive=e=>Vt.null(e)||Eve(typeof e);Vt.promise=nl("Promise");Vt.propertyOf=(e,t,r)=>{if(!Vt.object(e)||!t)return!1;const n=e[t];return Vt.function(r)?r(n):Vt.defined(n)};Vt.regexp=nl("RegExp");Vt.set=nl("Set");Vt.string=kp("string");Vt.symbol=kp("symbol");Vt.undefined=kp("undefined");Vt.weakMap=nl("WeakMap");Vt.weakSet=nl("WeakSet");var Jt=Vt;function Pve(...e){return e.every(t=>Jt.string(t)||Jt.array(t)||Jt.plainObject(t))}function Tve(e,t,r){return K7(e,t)?[e,t].every(Jt.array)?!e.some(_4(r))&&t.some(_4(r)):[e,t].every(Jt.plainObject)?!Object.entries(e).some(x4(r))&&Object.entries(t).some(x4(r)):t===r:!1}function g4(e,t,r){const{actual:n,key:a,previous:i,type:o}=r,l=El(e,a),c=El(t,a);let d=[l,c].every(Jt.number)&&(o==="increased"?l<c:l>c);return Jt.undefined(n)||(d=d&&c===n),Jt.undefined(i)||(d=d&&l===i),d}function v4(e,t,r){const{key:n,type:a,value:i}=r,o=El(e,n),l=El(t,n),c=a==="added"?o:l,d=a==="added"?l:o;if(!Jt.nullOrUndefined(i)){if(Jt.defined(c)){if(Jt.array(c)||Jt.plainObject(c))return Tve(c,d,i)}else return Wa(d,i);return!1}return[o,l].every(Jt.array)?!d.every(xA(c)):[o,l].every(Jt.plainObject)?Ave(Object.keys(c),Object.keys(d)):![o,l].every(f=>Jt.primitive(f)&&Jt.defined(f))&&(a==="added"?!Jt.defined(o)&&Jt.defined(l):Jt.defined(o)&&!Jt.defined(l))}function y4(e,t,{key:r}={}){let n=El(e,r),a=El(t,r);if(!K7(n,a))throw new TypeError("Inputs have different types");if(!Pve(n,a))throw new TypeError("Inputs don't have length");return[n,a].every(Jt.plainObject)&&(n=Object.keys(n),a=Object.keys(a)),[n,a]}function x4(e){return([t,r])=>Jt.array(e)?Wa(e,r)||e.some(n=>Wa(n,r)||Jt.array(r)&&xA(r)(n)):Jt.plainObject(e)&&e[t]?!!e[t]&&Wa(e[t],r):Wa(e,r)}function Ave(e,t){return t.some(r=>!e.includes(r))}function _4(e){return t=>Jt.array(e)?e.some(r=>Wa(r,t)||Jt.array(t)&&xA(t)(r)):Wa(e,t)}function yg(e,t){return Jt.array(e)?e.some(r=>Wa(r,t)):Wa(e,t)}function xA(e){return t=>e.some(r=>Wa(r,t))}function K7(...e){return e.every(Jt.array)||e.every(Jt.number)||e.every(Jt.plainObject)||e.every(Jt.string)}function El(e,t){return Jt.plainObject(e)||Jt.array(e)?Jt.string(t)?t.split(".").reduce((n,a)=>n&&n[a],e):Jt.number(t)?e[t]:e:e}function bw(e,t){if([e,t].some(Jt.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every(f=>Jt.plainObject(f)||Jt.array(f)))throw new Error("Expected plain objects or array");return{added:(f,u)=>{try{return v4(e,t,{key:f,type:"added",value:u})}catch(h){return!1}},changed:(f,u,h)=>{try{const m=El(e,f),v=El(t,f),g=Jt.defined(u),x=Jt.defined(h);if(g||x){const _=x?yg(h,m):!yg(u,m),w=yg(u,v);return _&&w}return[m,v].every(Jt.array)||[m,v].every(Jt.plainObject)?!Wa(m,v):m!==v}catch(m){return!1}},changedFrom:(f,u,h)=>{if(!Jt.defined(f))return!1;try{const m=El(e,f),v=El(t,f),g=Jt.defined(h);return yg(u,m)&&(g?yg(h,v):!g)}catch(m){return!1}},decreased:(f,u,h)=>{if(!Jt.defined(f))return!1;try{return g4(e,t,{key:f,actual:u,previous:h,type:"decreased"})}catch(m){return!1}},emptied:f=>{try{const[u,h]=y4(e,t,{key:f});return!!u.length&&!h.length}catch(u){return!1}},filled:f=>{try{const[u,h]=y4(e,t,{key:f});return!u.length&&!!h.length}catch(u){return!1}},increased:(f,u,h)=>{if(!Jt.defined(f))return!1;try{return g4(e,t,{key:f,actual:u,previous:h,type:"increased"})}catch(m){return!1}},removed:(f,u)=>{try{return v4(e,t,{key:f,type:"removed",value:u})}catch(h){return!1}}}}var Rve=new Error("Element already at target scroll position"),Ove=new Error("Scroll cancelled"),Mve=Math.min,w4=Date.now,Dve={left:b4("scrollLeft"),top:b4("scrollTop")};function b4(e){return function(r,n,a,i){a=a||{},typeof a=="function"&&(i=a,a={}),typeof i!="function"&&(i=$ve);var o=w4(),l=r[e],c=a.ease||Ive,d=isNaN(a.duration)?350:+a.duration,f=!1;return l===n?i(Rve,r[e]):requestAnimationFrame(h),u;function u(){f=!0}function h(m){if(f)return i(Ove,r[e]);var v=w4(),g=Mve(1,(v-o)/d),x=c(g);r[e]=x*(n-l)+l,g<1?requestAnimationFrame(h):requestAnimationFrame(function(){i(null,r[e])})}}}function Ive(e){return .5*(1-Math.cos(Math.PI*e))}function $ve(){}const Lve=wn(Dve);var Z7={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.Scrollparent=r()})(na,function(){function t(n){var a=getComputedStyle(n,null).getPropertyValue("overflow");return a.indexOf("scroll")>-1||a.indexOf("auto")>-1}function r(n){if(n instanceof HTMLElement||n instanceof SVGElement){for(var a=n.parentNode;a.parentNode;){if(t(a))return a;a=a.parentNode}return document.scrollingElement||document.documentElement}}return r})})(Z7);var Fve=Z7.exports;const X7=wn(Fve);var zve=function(e){return Object.prototype.hasOwnProperty.call(e,"props")},Bve=function(e,t){return e+Yv(t)},Yv=function(e){return e===null||typeof e=="boolean"||typeof e=="undefined"?"":typeof e=="number"?e.toString():typeof e=="string"?e:Array.isArray(e)?e.reduce(Bve,""):zve(e)&&Object.prototype.hasOwnProperty.call(e.props,"children")?Yv(e.props.children):""};Yv.default=Yv;var Uve=Yv;const j4=wn(Uve);var qve=function(t){return Vve(t)&&!Wve(t)};function Vve(e){return!!e&&typeof e=="object"}function Wve(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||Yve(e)}var Hve=typeof Symbol=="function"&&Symbol.for,Gve=Hve?Symbol.for("react.element"):60103;function Yve(e){return e.$$typeof===Gve}function Kve(e){return Array.isArray(e)?[]:{}}function Kv(e,t){return t.clone!==!1&&t.isMergeableObject(e)?Rm(Kve(e),e,t):e}function Zve(e,t,r){return e.concat(t).map(function(n){return Kv(n,r)})}function Xve(e,t){if(!t.customMerge)return Rm;var r=t.customMerge(e);return typeof r=="function"?r:Rm}function Jve(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}function N4(e){return Object.keys(e).concat(Jve(e))}function J7(e,t){try{return t in e}catch(r){return!1}}function Qve(e,t){return J7(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function eye(e,t,r){var n={};return r.isMergeableObject(e)&&N4(e).forEach(function(a){n[a]=Kv(e[a],r)}),N4(t).forEach(function(a){Qve(e,a)||(J7(e,a)&&r.isMergeableObject(t[a])?n[a]=Xve(a,r)(e[a],t[a],r):n[a]=Kv(t[a],r))}),n}function Rm(e,t,r){r=r||{},r.arrayMerge=r.arrayMerge||Zve,r.isMergeableObject=r.isMergeableObject||qve,r.cloneUnlessOtherwiseSpecified=Kv;var n=Array.isArray(t),a=Array.isArray(e),i=n===a;return i?n?r.arrayMerge(e,t,r):eye(e,t,r):Kv(t,r)}Rm.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(n,a){return Rm(n,a,r)},{})};var tye=Rm,rye=tye;const Uo=wn(rye);var Q7={exports:{}},nye="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",sye=nye,aye=sye;function eV(){}function tV(){}tV.resetWarningCache=eV;var iye=function(){function e(n,a,i,o,l,c){if(c!==aye){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:tV,resetWarningCache:eV};return r.PropTypes=r,r};Q7.exports=iye();var oye=Q7.exports;const ot=wn(oye);/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.16.1
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var p0=typeof window!="undefined"&&typeof document!="undefined"&&typeof navigator!="undefined",lye=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(p0&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}();function cye(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then(function(){t=!1,e()}))}}function dye(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},lye))}}var uye=p0&&window.Promise,fye=uye?cye:dye;function rV(e){var t={};return e&&t.toString.call(e)==="[object Function]"}function Df(e,t){if(e.nodeType!==1)return[];var r=e.ownerDocument.defaultView,n=r.getComputedStyle(e,null);return t?n[t]:n}function _A(e){return e.nodeName==="HTML"?e:e.parentNode||e.host}function g0(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=Df(e),r=t.overflow,n=t.overflowX,a=t.overflowY;return/(auto|scroll|overlay)/.test(r+a+n)?e:g0(_A(e))}function nV(e){return e&&e.referenceNode?e.referenceNode:e}var S4=p0&&!!(window.MSInputMethodContext&&document.documentMode),k4=p0&&/MSIE 10/.test(navigator.userAgent);function Ep(e){return e===11?S4:e===10?k4:S4||k4}function Om(e){if(!e)return document.documentElement;for(var t=Ep(10)?document.body:null,r=e.offsetParent||null;r===t&&e.nextElementSibling;)r=(e=e.nextElementSibling).offsetParent;var n=r&&r.nodeName;return!n||n==="BODY"||n==="HTML"?e?e.ownerDocument.documentElement:document.documentElement:["TH","TD","TABLE"].indexOf(r.nodeName)!==-1&&Df(r,"position")==="static"?Om(r):r}function hye(e){var t=e.nodeName;return t==="BODY"?!1:t==="HTML"||Om(e.firstElementChild)===e}function G2(e){return e.parentNode!==null?G2(e.parentNode):e}function jw(e,t){if(!e||!e.nodeType||!t||!t.nodeType)return document.documentElement;var r=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,n=r?e:t,a=r?t:e,i=document.createRange();i.setStart(n,0),i.setEnd(a,0);var o=i.commonAncestorContainer;if(e!==o&&t!==o||n.contains(a))return hye(o)?o:Om(o);var l=G2(e);return l.host?jw(l.host,t):jw(e,G2(t).host)}function Mm(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top",r=t==="top"?"scrollTop":"scrollLeft",n=e.nodeName;if(n==="BODY"||n==="HTML"){var a=e.ownerDocument.documentElement,i=e.ownerDocument.scrollingElement||a;return i[r]}return e[r]}function mye(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=Mm(t,"top"),a=Mm(t,"left"),i=r?-1:1;return e.top+=n*i,e.bottom+=n*i,e.left+=a*i,e.right+=a*i,e}function E4(e,t){var r=t==="x"?"Left":"Top",n=r==="Left"?"Right":"Bottom";return parseFloat(e["border"+r+"Width"])+parseFloat(e["border"+n+"Width"])}function C4(e,t,r,n){return Math.max(t["offset"+e],t["scroll"+e],r["client"+e],r["offset"+e],r["scroll"+e],Ep(10)?parseInt(r["offset"+e])+parseInt(n["margin"+(e==="Height"?"Top":"Left")])+parseInt(n["margin"+(e==="Height"?"Bottom":"Right")]):0)}function sV(e){var t=e.body,r=e.documentElement,n=Ep(10)&&getComputedStyle(r);return{height:C4("Height",t,r,n),width:C4("Width",t,r,n)}}var pye=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},gye=function(){function e(t,r){for(var n=0;n<r.length;n++){var a=r[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),Dm=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},to=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function Gd(e){return to({},e,{right:e.left+e.width,bottom:e.top+e.height})}function Y2(e){var t={};try{if(Ep(10)){t=e.getBoundingClientRect();var r=Mm(e,"top"),n=Mm(e,"left");t.top+=r,t.left+=n,t.bottom+=r,t.right+=n}else t=e.getBoundingClientRect()}catch(u){}var a={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},i=e.nodeName==="HTML"?sV(e.ownerDocument):{},o=i.width||e.clientWidth||a.width,l=i.height||e.clientHeight||a.height,c=e.offsetWidth-o,d=e.offsetHeight-l;if(c||d){var f=Df(e);c-=E4(f,"x"),d-=E4(f,"y"),a.width-=c,a.height-=d}return Gd(a)}function wA(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=Ep(10),a=t.nodeName==="HTML",i=Y2(e),o=Y2(t),l=g0(e),c=Df(t),d=parseFloat(c.borderTopWidth),f=parseFloat(c.borderLeftWidth);r&&a&&(o.top=Math.max(o.top,0),o.left=Math.max(o.left,0));var u=Gd({top:i.top-o.top-d,left:i.left-o.left-f,width:i.width,height:i.height});if(u.marginTop=0,u.marginLeft=0,!n&&a){var h=parseFloat(c.marginTop),m=parseFloat(c.marginLeft);u.top-=d-h,u.bottom-=d-h,u.left-=f-m,u.right-=f-m,u.marginTop=h,u.marginLeft=m}return(n&&!r?t.contains(l):t===l&&l.nodeName!=="BODY")&&(u=mye(u,t)),u}function vye(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=e.ownerDocument.documentElement,n=wA(e,r),a=Math.max(r.clientWidth,window.innerWidth||0),i=Math.max(r.clientHeight,window.innerHeight||0),o=t?0:Mm(r),l=t?0:Mm(r,"left"),c={top:o-n.top+n.marginTop,left:l-n.left+n.marginLeft,width:a,height:i};return Gd(c)}function aV(e){var t=e.nodeName;if(t==="BODY"||t==="HTML")return!1;if(Df(e,"position")==="fixed")return!0;var r=_A(e);return r?aV(r):!1}function iV(e){if(!e||!e.parentElement||Ep())return document.documentElement;for(var t=e.parentElement;t&&Df(t,"transform")==="none";)t=t.parentElement;return t||document.documentElement}function bA(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,i={top:0,left:0},o=a?iV(e):jw(e,nV(t));if(n==="viewport")i=vye(o,a);else{var l=void 0;n==="scrollParent"?(l=g0(_A(t)),l.nodeName==="BODY"&&(l=e.ownerDocument.documentElement)):n==="window"?l=e.ownerDocument.documentElement:l=n;var c=wA(l,o,a);if(l.nodeName==="HTML"&&!aV(o)){var d=sV(e.ownerDocument),f=d.height,u=d.width;i.top+=c.top-c.marginTop,i.bottom=f+c.top,i.left+=c.left-c.marginLeft,i.right=u+c.left}else i=c}r=r||0;var h=typeof r=="number";return i.left+=h?r:r.left||0,i.top+=h?r:r.top||0,i.right-=h?r:r.right||0,i.bottom-=h?r:r.bottom||0,i}function yye(e){var t=e.width,r=e.height;return t*r}function oV(e,t,r,n,a){var i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(e.indexOf("auto")===-1)return e;var o=bA(r,n,i,a),l={top:{width:o.width,height:t.top-o.top},right:{width:o.right-t.right,height:o.height},bottom:{width:o.width,height:o.bottom-t.bottom},left:{width:t.left-o.left,height:o.height}},c=Object.keys(l).map(function(h){return to({key:h},l[h],{area:yye(l[h])})}).sort(function(h,m){return m.area-h.area}),d=c.filter(function(h){var m=h.width,v=h.height;return m>=r.clientWidth&&v>=r.clientHeight}),f=d.length>0?d[0].key:c[0].key,u=e.split("-")[1];return f+(u?"-"+u:"")}function lV(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a=n?iV(t):jw(t,nV(r));return wA(r,a,n)}function cV(e){var t=e.ownerDocument.defaultView,r=t.getComputedStyle(e),n=parseFloat(r.marginTop||0)+parseFloat(r.marginBottom||0),a=parseFloat(r.marginLeft||0)+parseFloat(r.marginRight||0),i={width:e.offsetWidth+a,height:e.offsetHeight+n};return i}function Nw(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,function(r){return t[r]})}function dV(e,t,r){r=r.split("-")[0];var n=cV(e),a={width:n.width,height:n.height},i=["right","left"].indexOf(r)!==-1,o=i?"top":"left",l=i?"left":"top",c=i?"height":"width",d=i?"width":"height";return a[o]=t[o]+t[c]/2-n[c]/2,r===l?a[l]=t[l]-n[d]:a[l]=t[Nw(l)],a}function v0(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function xye(e,t,r){if(Array.prototype.findIndex)return e.findIndex(function(a){return a[t]===r});var n=v0(e,function(a){return a[t]===r});return e.indexOf(n)}function uV(e,t,r){var n=r===void 0?e:e.slice(0,xye(e,"name",r));return n.forEach(function(a){a.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var i=a.function||a.fn;a.enabled&&rV(i)&&(t.offsets.popper=Gd(t.offsets.popper),t.offsets.reference=Gd(t.offsets.reference),t=i(t,a))}),t}function _ye(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=lV(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=oV(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=dV(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=uV(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function fV(e,t){return e.some(function(r){var n=r.name,a=r.enabled;return a&&n===t})}function jA(e){for(var t=[!1,"ms","Webkit","Moz","O"],r=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<t.length;n++){var a=t[n],i=a?""+a+r:e;if(typeof document.body.style[i]!="undefined")return i}return null}function wye(){return this.state.isDestroyed=!0,fV(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[jA("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function hV(e){var t=e.ownerDocument;return t?t.defaultView:window}function mV(e,t,r,n){var a=e.nodeName==="BODY",i=a?e.ownerDocument.defaultView:e;i.addEventListener(t,r,{passive:!0}),a||mV(g0(i.parentNode),t,r,n),n.push(i)}function bye(e,t,r,n){r.updateBound=n,hV(e).addEventListener("resize",r.updateBound,{passive:!0});var a=g0(e);return mV(a,"scroll",r.updateBound,r.scrollParents),r.scrollElement=a,r.eventsEnabled=!0,r}function jye(){this.state.eventsEnabled||(this.state=bye(this.reference,this.options,this.state,this.scheduleUpdate))}function Nye(e,t){return hV(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach(function(r){r.removeEventListener("scroll",t.updateBound)}),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t}function Sye(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=Nye(this.reference,this.state))}function NA(e){return e!==""&&!isNaN(parseFloat(e))&&isFinite(e)}function K2(e,t){Object.keys(t).forEach(function(r){var n="";["width","height","top","right","bottom","left"].indexOf(r)!==-1&&NA(t[r])&&(n="px"),e.style[r]=t[r]+n})}function kye(e,t){Object.keys(t).forEach(function(r){var n=t[r];n!==!1?e.setAttribute(r,t[r]):e.removeAttribute(r)})}function Eye(e){return K2(e.instance.popper,e.styles),kye(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&K2(e.arrowElement,e.arrowStyles),e}function Cye(e,t,r,n,a){var i=lV(a,t,e,r.positionFixed),o=oV(r.placement,i,t,e,r.modifiers.flip.boundariesElement,r.modifiers.flip.padding);return t.setAttribute("x-placement",o),K2(t,{position:r.positionFixed?"fixed":"absolute"}),r}function Pye(e,t){var r=e.offsets,n=r.popper,a=r.reference,i=Math.round,o=Math.floor,l=function(_){return _},c=i(a.width),d=i(n.width),f=["left","right"].indexOf(e.placement)!==-1,u=e.placement.indexOf("-")!==-1,h=c%2===d%2,m=c%2===1&&d%2===1,v=t?f||u||h?i:o:l,g=t?i:l;return{left:v(m&&!u&&t?n.left-1:n.left),top:g(n.top),bottom:g(n.bottom),right:v(n.right)}}var Tye=p0&&/Firefox/i.test(navigator.userAgent);function Aye(e,t){var r=t.x,n=t.y,a=e.offsets.popper,i=v0(e.instance.modifiers,function(b){return b.name==="applyStyle"}).gpuAcceleration;i!==void 0&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var o=i!==void 0?i:t.gpuAcceleration,l=Om(e.instance.popper),c=Y2(l),d={position:a.position},f=Pye(e,window.devicePixelRatio<2||!Tye),u=r==="bottom"?"top":"bottom",h=n==="right"?"left":"right",m=jA("transform"),v=void 0,g=void 0;if(u==="bottom"?l.nodeName==="HTML"?g=-l.clientHeight+f.bottom:g=-c.height+f.bottom:g=f.top,h==="right"?l.nodeName==="HTML"?v=-l.clientWidth+f.right:v=-c.width+f.right:v=f.left,o&&m)d[m]="translate3d("+v+"px, "+g+"px, 0)",d[u]=0,d[h]=0,d.willChange="transform";else{var x=u==="bottom"?-1:1,_=h==="right"?-1:1;d[u]=g*x,d[h]=v*_,d.willChange=u+", "+h}var w={"x-placement":e.placement};return e.attributes=to({},w,e.attributes),e.styles=to({},d,e.styles),e.arrowStyles=to({},e.offsets.arrow,e.arrowStyles),e}function pV(e,t,r){var n=v0(e,function(l){var c=l.name;return c===t}),a=!!n&&e.some(function(l){return l.name===r&&l.enabled&&l.order<n.order});if(!a){var i="`"+t+"`",o="`"+r+"`";console.warn(o+" modifier is required by "+i+" modifier in order to work, be sure to include it before "+i+"!")}return a}function Rye(e,t){var r;if(!pV(e.instance.modifiers,"arrow","keepTogether"))return e;var n=t.element;if(typeof n=="string"){if(n=e.instance.popper.querySelector(n),!n)return e}else if(!e.instance.popper.contains(n))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var a=e.placement.split("-")[0],i=e.offsets,o=i.popper,l=i.reference,c=["left","right"].indexOf(a)!==-1,d=c?"height":"width",f=c?"Top":"Left",u=f.toLowerCase(),h=c?"left":"top",m=c?"bottom":"right",v=cV(n)[d];l[m]-v<o[u]&&(e.offsets.popper[u]-=o[u]-(l[m]-v)),l[u]+v>o[m]&&(e.offsets.popper[u]+=l[u]+v-o[m]),e.offsets.popper=Gd(e.offsets.popper);var g=l[u]+l[d]/2-v/2,x=Df(e.instance.popper),_=parseFloat(x["margin"+f]),w=parseFloat(x["border"+f+"Width"]),b=g-e.offsets.popper[u]-_-w;return b=Math.max(Math.min(o[d]-v,b),0),e.arrowElement=n,e.offsets.arrow=(r={},Dm(r,u,Math.round(b)),Dm(r,h,""),r),e}function Oye(e){return e==="end"?"start":e==="start"?"end":e}var gV=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],mS=gV.slice(3);function P4(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=mS.indexOf(e),n=mS.slice(r+1).concat(mS.slice(0,r));return t?n.reverse():n}var pS={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function Mye(e,t){if(fV(e.instance.modifiers,"inner")||e.flipped&&e.placement===e.originalPlacement)return e;var r=bA(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),n=e.placement.split("-")[0],a=Nw(n),i=e.placement.split("-")[1]||"",o=[];switch(t.behavior){case pS.FLIP:o=[n,a];break;case pS.CLOCKWISE:o=P4(n);break;case pS.COUNTERCLOCKWISE:o=P4(n,!0);break;default:o=t.behavior}return o.forEach(function(l,c){if(n!==l||o.length===c+1)return e;n=e.placement.split("-")[0],a=Nw(n);var d=e.offsets.popper,f=e.offsets.reference,u=Math.floor,h=n==="left"&&u(d.right)>u(f.left)||n==="right"&&u(d.left)<u(f.right)||n==="top"&&u(d.bottom)>u(f.top)||n==="bottom"&&u(d.top)<u(f.bottom),m=u(d.left)<u(r.left),v=u(d.right)>u(r.right),g=u(d.top)<u(r.top),x=u(d.bottom)>u(r.bottom),_=n==="left"&&m||n==="right"&&v||n==="top"&&g||n==="bottom"&&x,w=["top","bottom"].indexOf(n)!==-1,b=!!t.flipVariations&&(w&&i==="start"&&m||w&&i==="end"&&v||!w&&i==="start"&&g||!w&&i==="end"&&x),N=!!t.flipVariationsByContent&&(w&&i==="start"&&v||w&&i==="end"&&m||!w&&i==="start"&&x||!w&&i==="end"&&g),S=b||N;(h||_||S)&&(e.flipped=!0,(h||_)&&(n=o[c+1]),S&&(i=Oye(i)),e.placement=n+(i?"-"+i:""),e.offsets.popper=to({},e.offsets.popper,dV(e.instance.popper,e.offsets.reference,e.placement)),e=uV(e.instance.modifiers,e,"flip"))}),e}function Dye(e){var t=e.offsets,r=t.popper,n=t.reference,a=e.placement.split("-")[0],i=Math.floor,o=["top","bottom"].indexOf(a)!==-1,l=o?"right":"bottom",c=o?"left":"top",d=o?"width":"height";return r[l]<i(n[c])&&(e.offsets.popper[c]=i(n[c])-r[d]),r[c]>i(n[l])&&(e.offsets.popper[c]=i(n[l])),e}function Iye(e,t,r,n){var a=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),i=+a[1],o=a[2];if(!i)return e;if(o.indexOf("%")===0){var l=void 0;switch(o){case"%p":l=r;break;case"%":case"%r":default:l=n}var c=Gd(l);return c[t]/100*i}else if(o==="vh"||o==="vw"){var d=void 0;return o==="vh"?d=Math.max(document.documentElement.clientHeight,window.innerHeight||0):d=Math.max(document.documentElement.clientWidth,window.innerWidth||0),d/100*i}else return i}function $ye(e,t,r,n){var a=[0,0],i=["right","left"].indexOf(n)!==-1,o=e.split(/(\+|\-)/).map(function(f){return f.trim()}),l=o.indexOf(v0(o,function(f){return f.search(/,|\s/)!==-1}));o[l]&&o[l].indexOf(",")===-1&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var c=/\s*,\s*|\s+/,d=l!==-1?[o.slice(0,l).concat([o[l].split(c)[0]]),[o[l].split(c)[1]].concat(o.slice(l+1))]:[o];return d=d.map(function(f,u){var h=(u===1?!i:i)?"height":"width",m=!1;return f.reduce(function(v,g){return v[v.length-1]===""&&["+","-"].indexOf(g)!==-1?(v[v.length-1]=g,m=!0,v):m?(v[v.length-1]+=g,m=!1,v):v.concat(g)},[]).map(function(v){return Iye(v,h,t,r)})}),d.forEach(function(f,u){f.forEach(function(h,m){NA(h)&&(a[u]+=h*(f[m-1]==="-"?-1:1))})}),a}function Lye(e,t){var r=t.offset,n=e.placement,a=e.offsets,i=a.popper,o=a.reference,l=n.split("-")[0],c=void 0;return NA(+r)?c=[+r,0]:c=$ye(r,i,o,l),l==="left"?(i.top+=c[0],i.left-=c[1]):l==="right"?(i.top+=c[0],i.left+=c[1]):l==="top"?(i.left+=c[0],i.top-=c[1]):l==="bottom"&&(i.left+=c[0],i.top+=c[1]),e.popper=i,e}function Fye(e,t){var r=t.boundariesElement||Om(e.instance.popper);e.instance.reference===r&&(r=Om(r));var n=jA("transform"),a=e.instance.popper.style,i=a.top,o=a.left,l=a[n];a.top="",a.left="",a[n]="";var c=bA(e.instance.popper,e.instance.reference,t.padding,r,e.positionFixed);a.top=i,a.left=o,a[n]=l,t.boundaries=c;var d=t.priority,f=e.offsets.popper,u={primary:function(m){var v=f[m];return f[m]<c[m]&&!t.escapeWithReference&&(v=Math.max(f[m],c[m])),Dm({},m,v)},secondary:function(m){var v=m==="right"?"left":"top",g=f[v];return f[m]>c[m]&&!t.escapeWithReference&&(g=Math.min(f[v],c[m]-(m==="right"?f.width:f.height))),Dm({},v,g)}};return d.forEach(function(h){var m=["left","top"].indexOf(h)!==-1?"primary":"secondary";f=to({},f,u[m](h))}),e.offsets.popper=f,e}function zye(e){var t=e.placement,r=t.split("-")[0],n=t.split("-")[1];if(n){var a=e.offsets,i=a.reference,o=a.popper,l=["bottom","top"].indexOf(r)!==-1,c=l?"left":"top",d=l?"width":"height",f={start:Dm({},c,i[c]),end:Dm({},c,i[c]+i[d]-o[d])};e.offsets.popper=to({},o,f[n])}return e}function Bye(e){if(!pV(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,r=v0(e.instance.modifiers,function(n){return n.name==="preventOverflow"}).boundaries;if(t.bottom<r.top||t.left>r.right||t.top>r.bottom||t.right<r.left){if(e.hide===!0)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(e.hide===!1)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}function Uye(e){var t=e.placement,r=t.split("-")[0],n=e.offsets,a=n.popper,i=n.reference,o=["left","right"].indexOf(r)!==-1,l=["top","left"].indexOf(r)===-1;return a[o?"left":"top"]=i[r]-(l?a[o?"width":"height"]:0),e.placement=Nw(t),e.offsets.popper=Gd(a),e}var qye={shift:{order:100,enabled:!0,fn:zye},offset:{order:200,enabled:!0,fn:Lye,offset:0},preventOverflow:{order:300,enabled:!0,fn:Fye,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:Dye},arrow:{order:500,enabled:!0,fn:Rye,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:Mye,behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:Uye},hide:{order:800,enabled:!0,fn:Bye},computeStyle:{order:850,enabled:!0,fn:Aye,gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:Eye,onLoad:Cye,gpuAcceleration:void 0}},Vye={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:qye},Zv=function(){function e(t,r){var n=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};pye(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(n.update)},this.update=fye(this.update.bind(this)),this.options=to({},e.Defaults,a),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=r&&r.jquery?r[0]:r,this.options.modifiers={},Object.keys(to({},e.Defaults.modifiers,a.modifiers)).forEach(function(o){n.options.modifiers[o]=to({},e.Defaults.modifiers[o]||{},a.modifiers?a.modifiers[o]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(o){return to({name:o},n.options.modifiers[o])}).sort(function(o,l){return o.order-l.order}),this.modifiers.forEach(function(o){o.enabled&&rV(o.onLoad)&&o.onLoad(n.reference,n.popper,n.options,o,n.state)}),this.update();var i=this.options.eventsEnabled;i&&this.enableEventListeners(),this.state.eventsEnabled=i}return gye(e,[{key:"update",value:function(){return _ye.call(this)}},{key:"destroy",value:function(){return wye.call(this)}},{key:"enableEventListeners",value:function(){return jye.call(this)}},{key:"disableEventListeners",value:function(){return Sye.call(this)}}]),e}();Zv.Utils=(typeof window!="undefined"?window:global).PopperUtils;Zv.placements=gV;Zv.Defaults=Vye;var Wye=["innerHTML","ownerDocument","style","attributes","nodeValue"],Hye=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],Gye=["bigint","boolean","null","number","string","symbol","undefined"];function Z1(e){var t=Object.prototype.toString.call(e).slice(8,-1);if(/HTML\w+Element/.test(t))return"HTMLElement";if(Yye(t))return t}function sl(e){return function(t){return Z1(t)===e}}function Yye(e){return Hye.includes(e)}function Cp(e){return function(t){return typeof t===e}}function Kye(e){return Gye.includes(e)}function Je(e){if(e===null)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(Je.array(e))return"Array";if(Je.plainFunction(e))return"Function";var t=Z1(e);return t||"Object"}Je.array=Array.isArray;Je.arrayOf=function(e,t){return!Je.array(e)&&!Je.function(t)?!1:e.every(function(r){return t(r)})};Je.asyncGeneratorFunction=function(e){return Z1(e)==="AsyncGeneratorFunction"};Je.asyncFunction=sl("AsyncFunction");Je.bigint=Cp("bigint");Je.boolean=function(e){return e===!0||e===!1};Je.date=sl("Date");Je.defined=function(e){return!Je.undefined(e)};Je.domElement=function(e){return Je.object(e)&&!Je.plainObject(e)&&e.nodeType===1&&Je.string(e.nodeName)&&Wye.every(function(t){return t in e})};Je.empty=function(e){return Je.string(e)&&e.length===0||Je.array(e)&&e.length===0||Je.object(e)&&!Je.map(e)&&!Je.set(e)&&Object.keys(e).length===0||Je.set(e)&&e.size===0||Je.map(e)&&e.size===0};Je.error=sl("Error");Je.function=Cp("function");Je.generator=function(e){return Je.iterable(e)&&Je.function(e.next)&&Je.function(e.throw)};Je.generatorFunction=sl("GeneratorFunction");Je.instanceOf=function(e,t){return!e||!t?!1:Object.getPrototypeOf(e)===t.prototype};Je.iterable=function(e){return!Je.nullOrUndefined(e)&&Je.function(e[Symbol.iterator])};Je.map=sl("Map");Je.nan=function(e){return Number.isNaN(e)};Je.null=function(e){return e===null};Je.nullOrUndefined=function(e){return Je.null(e)||Je.undefined(e)};Je.number=function(e){return Cp("number")(e)&&!Je.nan(e)};Je.numericString=function(e){return Je.string(e)&&e.length>0&&!Number.isNaN(Number(e))};Je.object=function(e){return!Je.nullOrUndefined(e)&&(Je.function(e)||typeof e=="object")};Je.oneOf=function(e,t){return Je.array(e)?e.indexOf(t)>-1:!1};Je.plainFunction=sl("Function");Je.plainObject=function(e){if(Z1(e)!=="Object")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.getPrototypeOf({})};Je.primitive=function(e){return Je.null(e)||Kye(typeof e)};Je.promise=sl("Promise");Je.propertyOf=function(e,t,r){if(!Je.object(e)||!t)return!1;var n=e[t];return Je.function(r)?r(n):Je.defined(n)};Je.regexp=sl("RegExp");Je.set=sl("Set");Je.string=Cp("string");Je.symbol=Cp("symbol");Je.undefined=Cp("undefined");Je.weakMap=sl("WeakMap");Je.weakSet=sl("WeakSet");function vV(e){return function(t){return typeof t===e}}var Zye=vV("function"),Xye=function(e){return e===null},T4=function(e){return Object.prototype.toString.call(e).slice(8,-1)==="RegExp"},A4=function(e){return!Jye(e)&&!Xye(e)&&(Zye(e)||typeof e=="object")},Jye=vV("undefined"),Z2=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function Qye(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=r;n--!==0;)if(!fi(e[n],t[n]))return!1;return!0}function e0e(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=new DataView(e.buffer),n=new DataView(t.buffer),a=e.byteLength;a--;)if(r.getUint8(a)!==n.getUint8(a))return!1;return!0}function t0e(e,t){var r,n,a,i;if(e.size!==t.size)return!1;try{for(var o=Z2(e.entries()),l=o.next();!l.done;l=o.next()){var c=l.value;if(!t.has(c[0]))return!1}}catch(u){r={error:u}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}try{for(var d=Z2(e.entries()),f=d.next();!f.done;f=d.next()){var c=f.value;if(!fi(c[1],t.get(c[0])))return!1}}catch(u){a={error:u}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}return!0}function r0e(e,t){var r,n;if(e.size!==t.size)return!1;try{for(var a=Z2(e.entries()),i=a.next();!i.done;i=a.next()){var o=i.value;if(!t.has(o[0]))return!1}}catch(l){r={error:l}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!0}function fi(e,t){if(e===t)return!0;if(e&&A4(e)&&t&&A4(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return Qye(e,t);if(e instanceof Map&&t instanceof Map)return t0e(e,t);if(e instanceof Set&&t instanceof Set)return r0e(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e0e(e,t);if(T4(e)&&T4(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=r.length;a--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[a]))return!1;for(var a=r.length;a--!==0;){var i=r[a];if(!(i==="_owner"&&e.$$typeof)&&!fi(e[i],t[i]))return!1}return!0}return Number.isNaN(e)&&Number.isNaN(t)?!0:e===t}function n0e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(function(r){return Je.string(r)||Je.array(r)||Je.plainObject(r)})}function s0e(e,t,r){return yV(e,t)?[e,t].every(Je.array)?!e.some(I4(r))&&t.some(I4(r)):[e,t].every(Je.plainObject)?!Object.entries(e).some(D4(r))&&Object.entries(t).some(D4(r)):t===r:!1}function R4(e,t,r){var n=r.actual,a=r.key,i=r.previous,o=r.type,l=Cl(e,a),c=Cl(t,a),d=[l,c].every(Je.number)&&(o==="increased"?l<c:l>c);return Je.undefined(n)||(d=d&&c===n),Je.undefined(i)||(d=d&&l===i),d}function O4(e,t,r){var n=r.key,a=r.type,i=r.value,o=Cl(e,n),l=Cl(t,n),c=a==="added"?o:l,d=a==="added"?l:o;if(!Je.nullOrUndefined(i)){if(Je.defined(c)){if(Je.array(c)||Je.plainObject(c))return s0e(c,d,i)}else return fi(d,i);return!1}return[o,l].every(Je.array)?!d.every(SA(c)):[o,l].every(Je.plainObject)?a0e(Object.keys(c),Object.keys(d)):![o,l].every(function(f){return Je.primitive(f)&&Je.defined(f)})&&(a==="added"?!Je.defined(o)&&Je.defined(l):Je.defined(o)&&!Je.defined(l))}function M4(e,t,r){var n=r===void 0?{}:r,a=n.key,i=Cl(e,a),o=Cl(t,a);if(!yV(i,o))throw new TypeError("Inputs have different types");if(!n0e(i,o))throw new TypeError("Inputs don't have length");return[i,o].every(Je.plainObject)&&(i=Object.keys(i),o=Object.keys(o)),[i,o]}function D4(e){return function(t){var r=t[0],n=t[1];return Je.array(e)?fi(e,n)||e.some(function(a){return fi(a,n)||Je.array(n)&&SA(n)(a)}):Je.plainObject(e)&&e[r]?!!e[r]&&fi(e[r],n):fi(e,n)}}function a0e(e,t){return t.some(function(r){return!e.includes(r)})}function I4(e){return function(t){return Je.array(e)?e.some(function(r){return fi(r,t)||Je.array(t)&&SA(t)(r)}):fi(e,t)}}function xg(e,t){return Je.array(e)?e.some(function(r){return fi(r,t)}):fi(e,t)}function SA(e){return function(t){return e.some(function(r){return fi(r,t)})}}function yV(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(Je.array)||e.every(Je.number)||e.every(Je.plainObject)||e.every(Je.string)}function Cl(e,t){if(Je.plainObject(e)||Je.array(e)){if(Je.string(t)){var r=t.split(".");return r.reduce(function(n,a){return n&&n[a]},e)}return Je.number(t)?e[t]:e}return e}function i0e(e,t){if([e,t].some(Je.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every(function(u){return Je.plainObject(u)||Je.array(u)}))throw new Error("Expected plain objects or array");var r=function(u,h){try{return O4(e,t,{key:u,type:"added",value:h})}catch(m){return!1}},n=function(u,h,m){try{var v=Cl(e,u),g=Cl(t,u),x=Je.defined(h),_=Je.defined(m);if(x||_){var w=_?xg(m,v):!xg(h,v),b=xg(h,g);return w&&b}return[v,g].every(Je.array)||[v,g].every(Je.plainObject)?!fi(v,g):v!==g}catch(N){return!1}},a=function(u,h,m){if(!Je.defined(u))return!1;try{var v=Cl(e,u),g=Cl(t,u),x=Je.defined(m);return xg(h,v)&&(x?xg(m,g):!x)}catch(_){return!1}},i=function(u,h){return Je.defined(u)?n(u,h):!1},o=function(u,h,m){if(!Je.defined(u))return!1;try{return R4(e,t,{key:u,actual:h,previous:m,type:"decreased"})}catch(v){return!1}},l=function(u){try{var h=M4(e,t,{key:u}),m=h[0],v=h[1];return!!m.length&&!v.length}catch(g){return!1}},c=function(u){try{var h=M4(e,t,{key:u}),m=h[0],v=h[1];return!m.length&&!!v.length}catch(g){return!1}},d=function(u,h,m){if(!Je.defined(u))return!1;try{return R4(e,t,{key:u,actual:h,previous:m,type:"increased"})}catch(v){return!1}},f=function(u,h){try{return O4(e,t,{key:u,type:"removed",value:h})}catch(m){return!1}};return{added:r,changed:n,changedFrom:a,changedTo:i,decreased:o,emptied:l,filled:c,increased:d,removed:f}}function $4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ns(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$4(Object(r),!0).forEach(function(n){Ea(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function y0(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o0e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_V(n.key),n)}}function x0(e,t,r){return t&&o0e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ea(e,t,r){return t=_V(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _0(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X2(e,t)}function Sw(e){return Sw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sw(e)}function X2(e,t){return X2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},X2(e,t)}function l0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function c0e(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function xV(e,t){if(e==null)return{};var r=c0e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ic(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d0e(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ic(e)}function w0(e){var t=l0e();return function(){var n=Sw(e),a;if(t){var i=Sw(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return d0e(this,a)}}function u0e(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _V(e){var t=u0e(e,"string");return typeof t=="symbol"?t:String(t)}var f0e={flip:{padding:20},preventOverflow:{padding:10}},h0e="The typeValidator argument must be a function with the signature function(props, propName, componentName).",m0e="The error message is optional, but must be a string if provided.";function p0e(e,t,r,n){return typeof e=="boolean"?e:typeof e=="function"?e(t,r,n):e?!!e:!1}function g0e(e,t){return Object.hasOwnProperty.call(e,t)}function v0e(e,t,r,n){return new Error("Required ".concat(e[t]," `").concat(t,"` was not specified in `").concat(r,"`."))}function y0e(e,t){if(typeof e!="function")throw new TypeError(h0e);if(t&&typeof t!="string")throw new TypeError(m0e)}function L4(e,t,r){return y0e(e,r),function(n,a,i){for(var o=arguments.length,l=new Array(o>3?o-3:0),c=3;c<o;c++)l[c-3]=arguments[c];return p0e(t,n,a,i)?g0e(n,a)?e.apply(void 0,[n,a,i].concat(l)):v0e(n,a,i):e.apply(void 0,[n,a,i].concat(l))}}var gn={INIT:"init",IDLE:"idle",OPENING:"opening",OPEN:"open",CLOSING:"closing",ERROR:"error"},_g=Hh.createPortal!==void 0;function vl(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}function gS(){return"ontouchstart"in window&&/Mobi/.test(navigator.userAgent)}function Mx(e){var t=e.title,r=e.data,n=e.warn,a=n===void 0?!1:n,i=e.debug,o=i===void 0?!1:i,l=a?console.warn||console.error:console.log;o&&t&&r&&(console.groupCollapsed("%creact-floater: ".concat(t),"color: #9b00ff; font-weight: bold; font-size: 12px;"),Array.isArray(r)?r.forEach(function(c){Je.plainObject(c)&&c.key?l.apply(console,[c.key,c.value]):l.apply(console,[c])}):l.apply(console,[r]),console.groupEnd())}function x0e(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;e.addEventListener(t,r,n)}function _0e(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;e.removeEventListener(t,r,n)}function w0e(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a;a=function(o){r(o),_0e(e,t,a)},x0e(e,t,a,n)}function F4(){}var wV=function(e){_0(r,e);var t=w0(r);function r(){return y0(this,r),t.apply(this,arguments)}return x0(r,[{key:"componentDidMount",value:function(){vl()&&(this.node||this.appendNode(),_g||this.renderPortal())}},{key:"componentDidUpdate",value:function(){vl()&&(_g||this.renderPortal())}},{key:"componentWillUnmount",value:function(){!vl()||!this.node||(_g||Hh.unmountComponentAtNode(this.node),this.node&&this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=void 0))}},{key:"appendNode",value:function(){var a=this.props,i=a.id,o=a.zIndex;this.node||(this.node=document.createElement("div"),i&&(this.node.id=i),o&&(this.node.style.zIndex=o),document.body.appendChild(this.node))}},{key:"renderPortal",value:function(){if(!vl())return null;var a=this.props,i=a.children,o=a.setRef;if(this.node||this.appendNode(),_g)return Hh.createPortal(i,this.node);var l=Hh.unstable_renderSubtreeIntoContainer(this,i.length>1?te.createElement("div",null,i):i[0],this.node);return o(l),null}},{key:"renderReact16",value:function(){var a=this.props,i=a.hasChildren,o=a.placement,l=a.target;return i?this.renderPortal():l||o==="center"?this.renderPortal():null}},{key:"render",value:function(){return _g?this.renderReact16():null}}]),r}(te.Component);Ea(wV,"propTypes",{children:ot.oneOfType([ot.element,ot.array]),hasChildren:ot.bool,id:ot.oneOfType([ot.string,ot.number]),placement:ot.string,setRef:ot.func.isRequired,target:ot.oneOfType([ot.object,ot.string]),zIndex:ot.number});var bV=function(e){_0(r,e);var t=w0(r);function r(){return y0(this,r),t.apply(this,arguments)}return x0(r,[{key:"parentStyle",get:function(){var a=this.props,i=a.placement,o=a.styles,l=o.arrow.length,c={pointerEvents:"none",position:"absolute",width:"100%"};return i.startsWith("top")?(c.bottom=0,c.left=0,c.right=0,c.height=l):i.startsWith("bottom")?(c.left=0,c.right=0,c.top=0,c.height=l):i.startsWith("left")?(c.right=0,c.top=0,c.bottom=0):i.startsWith("right")&&(c.left=0,c.top=0),c}},{key:"render",value:function(){var a=this.props,i=a.placement,o=a.setArrowRef,l=a.styles,c=l.arrow,d=c.color,f=c.display,u=c.length,h=c.margin,m=c.position,v=c.spread,g={display:f,position:m},x,_=v,w=u;return i.startsWith("top")?(x="0,0 ".concat(_/2,",").concat(w," ").concat(_,",0"),g.bottom=0,g.marginLeft=h,g.marginRight=h):i.startsWith("bottom")?(x="".concat(_,",").concat(w," ").concat(_/2,",0 0,").concat(w),g.top=0,g.marginLeft=h,g.marginRight=h):i.startsWith("left")?(w=v,_=u,x="0,0 ".concat(_,",").concat(w/2," 0,").concat(w),g.right=0,g.marginTop=h,g.marginBottom=h):i.startsWith("right")&&(w=v,_=u,x="".concat(_,",").concat(w," ").concat(_,",0 0,").concat(w/2),g.left=0,g.marginTop=h,g.marginBottom=h),te.createElement("div",{className:"__floater__arrow",style:this.parentStyle},te.createElement("span",{ref:o,style:g},te.createElement("svg",{width:_,height:w,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},te.createElement("polygon",{points:x,fill:d}))))}}]),r}(te.Component);Ea(bV,"propTypes",{placement:ot.string.isRequired,setArrowRef:ot.func.isRequired,styles:ot.object.isRequired});var b0e=["color","height","width"];function jV(e){var t=e.handleClick,r=e.styles,n=r.color,a=r.height,i=r.width,o=xV(r,b0e);return te.createElement("button",{"aria-label":"close",onClick:t,style:o,type:"button"},te.createElement("svg",{width:"".concat(i,"px"),height:"".concat(a,"px"),viewBox:"0 0 18 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid"},te.createElement("g",null,te.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:n}))))}jV.propTypes={handleClick:ot.func.isRequired,styles:ot.object.isRequired};function NV(e){var t=e.content,r=e.footer,n=e.handleClick,a=e.open,i=e.positionWrapper,o=e.showCloseButton,l=e.title,c=e.styles,d={content:te.isValidElement(t)?t:te.createElement("div",{className:"__floater__content",style:c.content},t)};return l&&(d.title=te.isValidElement(l)?l:te.createElement("div",{className:"__floater__title",style:c.title},l)),r&&(d.footer=te.isValidElement(r)?r:te.createElement("div",{className:"__floater__footer",style:c.footer},r)),(o||i)&&!Je.boolean(a)&&(d.close=te.createElement(jV,{styles:c.close,handleClick:n})),te.createElement("div",{className:"__floater__container",style:c.container},d.close,d.title,d.content,d.footer)}NV.propTypes={content:ot.node.isRequired,footer:ot.node,handleClick:ot.func.isRequired,open:ot.bool,positionWrapper:ot.bool.isRequired,showCloseButton:ot.bool.isRequired,styles:ot.object.isRequired,title:ot.node};var SV=function(e){_0(r,e);var t=w0(r);function r(){return y0(this,r),t.apply(this,arguments)}return x0(r,[{key:"style",get:function(){var a=this.props,i=a.disableAnimation,o=a.component,l=a.placement,c=a.hideArrow,d=a.status,f=a.styles,u=f.arrow.length,h=f.floater,m=f.floaterCentered,v=f.floaterClosing,g=f.floaterOpening,x=f.floaterWithAnimation,_=f.floaterWithComponent,w={};return c||(l.startsWith("top")?w.padding="0 0 ".concat(u,"px"):l.startsWith("bottom")?w.padding="".concat(u,"px 0 0"):l.startsWith("left")?w.padding="0 ".concat(u,"px 0 0"):l.startsWith("right")&&(w.padding="0 0 0 ".concat(u,"px"))),[gn.OPENING,gn.OPEN].indexOf(d)!==-1&&(w=ns(ns({},w),g)),d===gn.CLOSING&&(w=ns(ns({},w),v)),d===gn.OPEN&&!i&&(w=ns(ns({},w),x)),l==="center"&&(w=ns(ns({},w),m)),o&&(w=ns(ns({},w),_)),ns(ns({},h),w)}},{key:"render",value:function(){var a=this.props,i=a.component,o=a.handleClick,l=a.hideArrow,c=a.setFloaterRef,d=a.status,f={},u=["__floater"];return i?te.isValidElement(i)?f.content=te.cloneElement(i,{closeFn:o}):f.content=i({closeFn:o}):f.content=te.createElement(NV,this.props),d===gn.OPEN&&u.push("__floater__open"),l||(f.arrow=te.createElement(bV,this.props)),te.createElement("div",{ref:c,className:u.join(" "),style:this.style},te.createElement("div",{className:"__floater__body"},f.content,f.arrow))}}]),r}(te.Component);Ea(SV,"propTypes",{component:ot.oneOfType([ot.func,ot.element]),content:ot.node,disableAnimation:ot.bool.isRequired,footer:ot.node,handleClick:ot.func.isRequired,hideArrow:ot.bool.isRequired,open:ot.bool,placement:ot.string.isRequired,positionWrapper:ot.bool.isRequired,setArrowRef:ot.func.isRequired,setFloaterRef:ot.func.isRequired,showCloseButton:ot.bool,status:ot.string.isRequired,styles:ot.object.isRequired,title:ot.node});var kV=function(e){_0(r,e);var t=w0(r);function r(){return y0(this,r),t.apply(this,arguments)}return x0(r,[{key:"render",value:function(){var a=this.props,i=a.children,o=a.handleClick,l=a.handleMouseEnter,c=a.handleMouseLeave,d=a.setChildRef,f=a.setWrapperRef,u=a.style,h=a.styles,m;if(i)if(te.Children.count(i)===1)if(!te.isValidElement(i))m=te.createElement("span",null,i);else{var v=Je.function(i.type)?"innerRef":"ref";m=te.cloneElement(te.Children.only(i),Ea({},v,d))}else m=i;return m?te.createElement("span",{ref:f,style:ns(ns({},h),u),onClick:o,onMouseEnter:l,onMouseLeave:c},m):null}}]),r}(te.Component);Ea(kV,"propTypes",{children:ot.node,handleClick:ot.func.isRequired,handleMouseEnter:ot.func.isRequired,handleMouseLeave:ot.func.isRequired,setChildRef:ot.func.isRequired,setWrapperRef:ot.func.isRequired,style:ot.object,styles:ot.object.isRequired});var j0e={zIndex:100};function N0e(e){var t=Uo(j0e,e.options||{});return{wrapper:{cursor:"help",display:"inline-flex",flexDirection:"column",zIndex:t.zIndex},wrapperPosition:{left:-1e3,position:"absolute",top:-1e3,visibility:"hidden"},floater:{display:"inline-block",filter:"drop-shadow(0 0 3px rgba(0, 0, 0, 0.3))",maxWidth:300,opacity:0,position:"relative",transition:"opacity 0.3s",visibility:"hidden",zIndex:t.zIndex},floaterOpening:{opacity:1,visibility:"visible"},floaterWithAnimation:{opacity:1,transition:"opacity 0.3s, transform 0.2s",visibility:"visible"},floaterWithComponent:{maxWidth:"100%"},floaterClosing:{opacity:0,visibility:"visible"},floaterCentered:{left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)"},container:{backgroundColor:"#fff",color:"#666",minHeight:60,minWidth:200,padding:20,position:"relative",zIndex:10},title:{borderBottom:"1px solid #555",color:"#555",fontSize:18,marginBottom:5,paddingBottom:6,paddingRight:18},content:{fontSize:15},close:{backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",fontSize:0,height:15,outline:"none",padding:10,position:"absolute",right:0,top:0,width:15,WebkitAppearance:"none"},footer:{borderTop:"1px solid #ccc",fontSize:13,marginTop:10,paddingTop:5},arrow:{color:"#fff",display:"inline-flex",length:16,margin:8,position:"absolute",spread:32},options:t}}var S0e=["arrow","flip","offset"],k0e=["position","top","right","bottom","left"],kA=function(e){_0(r,e);var t=w0(r);function r(n){var a;return y0(this,r),a=t.call(this,n),Ea(ic(a),"setArrowRef",function(i){a.arrowRef=i}),Ea(ic(a),"setChildRef",function(i){a.childRef=i}),Ea(ic(a),"setFloaterRef",function(i){a.floaterRef=i}),Ea(ic(a),"setWrapperRef",function(i){a.wrapperRef=i}),Ea(ic(a),"handleTransitionEnd",function(){var i=a.state.status,o=a.props.callback;a.wrapperPopper&&a.wrapperPopper.instance.update(),a.setState({status:i===gn.OPENING?gn.OPEN:gn.IDLE},function(){var l=a.state.status;o(l===gn.OPEN?"open":"close",a.props)})}),Ea(ic(a),"handleClick",function(){var i=a.props,o=i.event,l=i.open;if(!Je.boolean(l)){var c=a.state,d=c.positionWrapper,f=c.status;(a.event==="click"||a.event==="hover"&&d)&&(Mx({title:"click",data:[{event:o,status:f===gn.OPEN?"closing":"opening"}],debug:a.debug}),a.toggle())}}),Ea(ic(a),"handleMouseEnter",function(){var i=a.props,o=i.event,l=i.open;if(!(Je.boolean(l)||gS())){var c=a.state.status;a.event==="hover"&&c===gn.IDLE&&(Mx({title:"mouseEnter",data:[{key:"originalEvent",value:o}],debug:a.debug}),clearTimeout(a.eventDelayTimeout),a.toggle())}}),Ea(ic(a),"handleMouseLeave",function(){var i=a.props,o=i.event,l=i.eventDelay,c=i.open;if(!(Je.boolean(c)||gS())){var d=a.state,f=d.status,u=d.positionWrapper;a.event==="hover"&&(Mx({title:"mouseLeave",data:[{key:"originalEvent",value:o}],debug:a.debug}),l?[gn.OPENING,gn.OPEN].indexOf(f)!==-1&&!u&&!a.eventDelayTimeout&&(a.eventDelayTimeout=setTimeout(function(){delete a.eventDelayTimeout,a.toggle()},l*1e3)):a.toggle(gn.IDLE))}}),a.state={currentPlacement:n.placement,needsUpdate:!1,positionWrapper:n.wrapperOptions.position&&!!n.target,status:gn.INIT,statusWrapper:gn.INIT},a._isMounted=!1,a.hasMounted=!1,vl()&&window.addEventListener("load",function(){a.popper&&a.popper.instance.update(),a.wrapperPopper&&a.wrapperPopper.instance.update()}),a}return x0(r,[{key:"componentDidMount",value:function(){if(vl()){var a=this.state.positionWrapper,i=this.props,o=i.children,l=i.open,c=i.target;this._isMounted=!0,Mx({title:"init",data:{hasChildren:!!o,hasTarget:!!c,isControlled:Je.boolean(l),positionWrapper:a,target:this.target,floater:this.floaterRef},debug:this.debug}),this.hasMounted||(this.initPopper(),this.hasMounted=!0),!o&&c&&Je.boolean(l)}}},{key:"componentDidUpdate",value:function(a,i){if(vl()){var o=this.props,l=o.autoOpen,c=o.open,d=o.target,f=o.wrapperOptions,u=i0e(i,this.state),h=u.changedFrom,m=u.changed;if(a.open!==c){var v;Je.boolean(c)&&(v=c?gn.OPENING:gn.CLOSING),this.toggle(v)}(a.wrapperOptions.position!==f.position||a.target!==d)&&this.changeWrapperPosition(this.props),m("status",gn.IDLE)&&c?this.toggle(gn.OPEN):h("status",gn.INIT,gn.IDLE)&&l&&this.toggle(gn.OPEN),this.popper&&m("status",gn.OPENING)&&this.popper.instance.update(),this.floaterRef&&(m("status",gn.OPENING)||m("status",gn.CLOSING))&&w0e(this.floaterRef,"transitionend",this.handleTransitionEnd),m("needsUpdate",!0)&&this.rebuildPopper()}}},{key:"componentWillUnmount",value:function(){vl()&&(this._isMounted=!1,this.popper&&this.popper.instance.destroy(),this.wrapperPopper&&this.wrapperPopper.instance.destroy())}},{key:"initPopper",value:function(){var a=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.target,o=this.state.positionWrapper,l=this.props,c=l.disableFlip,d=l.getPopper,f=l.hideArrow,u=l.offset,h=l.placement,m=l.wrapperOptions,v=h==="top"||h==="bottom"?"flip":["right","bottom-end","top-end","left","top-start","bottom-start"];if(h==="center")this.setState({status:gn.IDLE});else if(i&&this.floaterRef){var g=this.options,x=g.arrow,_=g.flip,w=g.offset,b=xV(g,S0e);new Zv(i,this.floaterRef,{placement:h,modifiers:ns({arrow:ns({enabled:!f,element:this.arrowRef},x),flip:ns({enabled:!c,behavior:v},_),offset:ns({offset:"0, ".concat(u,"px")},w)},b),onCreate:function(k){var C;if(a.popper=k,!((C=a.floaterRef)!==null&&C!==void 0&&C.isConnected)){a.setState({needsUpdate:!0});return}d(k,"floater"),a._isMounted&&a.setState({currentPlacement:k.placement,status:gn.IDLE}),h!==k.placement&&setTimeout(function(){k.instance.update()},1)},onUpdate:function(k){a.popper=k;var C=a.state.currentPlacement;a._isMounted&&k.placement!==C&&a.setState({currentPlacement:k.placement})}})}if(o){var N=Je.undefined(m.offset)?0:m.offset;new Zv(this.target,this.wrapperRef,{placement:m.placement||h,modifiers:{arrow:{enabled:!1},offset:{offset:"0, ".concat(N,"px")},flip:{enabled:!1}},onCreate:function(k){a.wrapperPopper=k,a._isMounted&&a.setState({statusWrapper:gn.IDLE}),d(k,"wrapper"),h!==k.placement&&setTimeout(function(){k.instance.update()},1)}})}}},{key:"rebuildPopper",value:function(){var a=this;this.floaterRefInterval=setInterval(function(){var i;(i=a.floaterRef)!==null&&i!==void 0&&i.isConnected&&(clearInterval(a.floaterRefInterval),a.setState({needsUpdate:!1}),a.initPopper())},50)}},{key:"changeWrapperPosition",value:function(a){var i=a.target,o=a.wrapperOptions;this.setState({positionWrapper:o.position&&!!i})}},{key:"toggle",value:function(a){var i=this.state.status,o=i===gn.OPEN?gn.CLOSING:gn.OPENING;Je.undefined(a)||(o=a),this.setState({status:o})}},{key:"debug",get:function(){var a=this.props.debug;return a||vl()&&"ReactFloaterDebug"in window&&!!window.ReactFloaterDebug}},{key:"event",get:function(){var a=this.props,i=a.disableHoverToClick,o=a.event;return o==="hover"&&gS()&&!i?"click":o}},{key:"options",get:function(){var a=this.props.options;return Uo(f0e,a||{})}},{key:"styles",get:function(){var a=this,i=this.state,o=i.status,l=i.positionWrapper,c=i.statusWrapper,d=this.props.styles,f=Uo(N0e(d),d);if(l){var u;[gn.IDLE].indexOf(o)===-1||[gn.IDLE].indexOf(c)===-1?u=f.wrapperPosition:u=this.wrapperPopper.styles,f.wrapper=ns(ns({},f.wrapper),u)}if(this.target){var h=window.getComputedStyle(this.target);this.wrapperStyles?f.wrapper=ns(ns({},f.wrapper),this.wrapperStyles):["relative","static"].indexOf(h.position)===-1&&(this.wrapperStyles={},l||(k0e.forEach(function(m){a.wrapperStyles[m]=h[m]}),f.wrapper=ns(ns({},f.wrapper),this.wrapperStyles),this.target.style.position="relative",this.target.style.top="auto",this.target.style.right="auto",this.target.style.bottom="auto",this.target.style.left="auto"))}return f}},{key:"target",get:function(){if(!vl())return null;var a=this.props.target;return a?Je.domElement(a)?a:document.querySelector(a):this.childRef||this.wrapperRef}},{key:"render",value:function(){var a=this.state,i=a.currentPlacement,o=a.positionWrapper,l=a.status,c=this.props,d=c.children,f=c.component,u=c.content,h=c.disableAnimation,m=c.footer,v=c.hideArrow,g=c.id,x=c.open,_=c.showCloseButton,w=c.style,b=c.target,N=c.title,S=te.createElement(kV,{handleClick:this.handleClick,handleMouseEnter:this.handleMouseEnter,handleMouseLeave:this.handleMouseLeave,setChildRef:this.setChildRef,setWrapperRef:this.setWrapperRef,style:w,styles:this.styles.wrapper},d),k={};return o?k.wrapperInPortal=S:k.wrapperAsChildren=S,te.createElement("span",null,te.createElement(wV,{hasChildren:!!d,id:g,placement:i,setRef:this.setFloaterRef,target:b,zIndex:this.styles.options.zIndex},te.createElement(SV,{component:f,content:u,disableAnimation:h,footer:m,handleClick:this.handleClick,hideArrow:v||i==="center",open:x,placement:i,positionWrapper:o,setArrowRef:this.setArrowRef,setFloaterRef:this.setFloaterRef,showCloseButton:_,status:l,styles:this.styles,title:N}),k.wrapperInPortal),k.wrapperAsChildren)}}]),r}(te.Component);Ea(kA,"propTypes",{autoOpen:ot.bool,callback:ot.func,children:ot.node,component:L4(ot.oneOfType([ot.func,ot.element]),function(e){return!e.content}),content:L4(ot.node,function(e){return!e.component}),debug:ot.bool,disableAnimation:ot.bool,disableFlip:ot.bool,disableHoverToClick:ot.bool,event:ot.oneOf(["hover","click"]),eventDelay:ot.number,footer:ot.node,getPopper:ot.func,hideArrow:ot.bool,id:ot.oneOfType([ot.string,ot.number]),offset:ot.number,open:ot.bool,options:ot.object,placement:ot.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto","center"]),showCloseButton:ot.bool,style:ot.object,styles:ot.object,target:ot.oneOfType([ot.object,ot.string]),title:ot.node,wrapperOptions:ot.shape({offset:ot.number,placement:ot.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto"]),position:ot.bool})});Ea(kA,"defaultProps",{autoOpen:!1,callback:F4,debug:!1,disableAnimation:!1,disableFlip:!1,disableHoverToClick:!1,event:"click",eventDelay:.4,getPopper:F4,hideArrow:!1,offset:15,placement:"bottom",showCloseButton:!1,styles:{},target:null,wrapperOptions:{position:!1}});var E0e=Object.defineProperty,C0e=(e,t,r)=>t in e?E0e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,er=(e,t,r)=>C0e(e,typeof t!="symbol"?t+"":t,r),xn={INIT:"init",START:"start",STOP:"stop",RESET:"reset",PREV:"prev",NEXT:"next",GO:"go",CLOSE:"close",SKIP:"skip",UPDATE:"update"},Vs={TOUR_START:"tour:start",STEP_BEFORE:"step:before",BEACON:"beacon",TOOLTIP:"tooltip",STEP_AFTER:"step:after",TOUR_END:"tour:end",TOUR_STATUS:"tour:status",TARGET_NOT_FOUND:"error:target_not_found",ERROR:"error"},Ar={INIT:"init",READY:"ready",BEACON:"beacon",TOOLTIP:"tooltip",COMPLETE:"complete",ERROR:"error"},Jr={IDLE:"idle",READY:"ready",WAITING:"waiting",RUNNING:"running",PAUSED:"paused",SKIPPED:"skipped",FINISHED:"finished",ERROR:"error"};function pd(){var e;return!!(typeof window!="undefined"&&((e=window.document)!=null&&e.createElement))}function EV(e){return e?e.getBoundingClientRect():null}function P0e(e=!1){const{body:t,documentElement:r}=document;if(!t||!r)return 0;if(e){const n=[t.scrollHeight,t.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight].sort((i,o)=>i-o),a=Math.floor(n.length/2);return n.length%2===0?(n[a-1]+n[a])/2:n[a]}return Math.max(t.scrollHeight,t.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight)}function xc(e){if(typeof e=="string")try{return document.querySelector(e)}catch(t){return null}return e}function T0e(e){return!e||e.nodeType!==1?null:getComputedStyle(e)}function Xv(e,t,r){if(!e)return Du();const n=X7(e);if(n){if(n.isSameNode(Du()))return r?document:Du();if(!(n.scrollHeight>n.offsetHeight)&&!t)return n.style.overflow="initial",Du()}return n}function X1(e,t){if(!e)return!1;const r=Xv(e,t);return r?!r.isSameNode(Du()):!1}function A0e(e){return e.offsetParent!==document.body}function Im(e,t="fixed"){if(!e||!(e instanceof HTMLElement))return!1;const{nodeName:r}=e,n=T0e(e);return r==="BODY"||r==="HTML"?!1:n&&n.position===t?!0:e.parentNode?Im(e.parentNode,t):!1}function R0e(e){var t;if(!e)return!1;let r=e;for(;r&&r!==document.body;){if(r instanceof HTMLElement){const{display:n,visibility:a}=getComputedStyle(r);if(n==="none"||a==="hidden")return!1}r=(t=r.parentElement)!=null?t:null}return!0}function O0e(e,t,r){var n,a,i;const o=EV(e),l=Xv(e,r),c=X1(e,r),d=Im(e);let f=0,u=(n=o==null?void 0:o.top)!=null?n:0;if(c&&d){const h=(a=e==null?void 0:e.offsetTop)!=null?a:0,m=(i=l==null?void 0:l.scrollTop)!=null?i:0;u=h-m}else l instanceof HTMLElement&&(f=l.scrollTop,!c&&!Im(e)&&(u+=f),l.isSameNode(Du())||(u+=Du().scrollTop));return Math.floor(u-t)}function M0e(e,t,r){var n;if(!e)return 0;const{offsetTop:a=0,scrollTop:i=0}=(n=X7(e))!=null?n:{};let o=e.getBoundingClientRect().top+i;a&&(X1(e,r)||A0e(e))&&(o-=a);const l=Math.floor(o-t);return l<0?0:l}function Du(){var e;return(e=document.scrollingElement)!=null?e:document.documentElement}function D0e(e,t){const{duration:r,element:n}=t;return new Promise((a,i)=>{const{scrollTop:o}=n,l=e>o?e-o:o-e;Lve.top(n,e,{duration:l<100?50:r},c=>c&&c.message!=="Element already at target scroll position"?i(c):a())})}var wg=ao.createPortal!==void 0;function CV(e=navigator.userAgent){let t=e;return typeof window=="undefined"?t="node":document.documentMode?t="ie":/Edge/.test(e)?t="edge":window.opera||e.includes(" OPR/")?t="opera":typeof window.InstallTrigger!="undefined"?t="firefox":window.chrome?t="chrome":/(Version\/([\d._]+).*Safari|CriOS|FxiOS| Mobile\/)/.test(e)&&(t="safari"),t}function __(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function yl(e,t={}){const{defaultValue:r,step:n,steps:a}=t;let i=j4(e);if(i)(i.includes("{step}")||i.includes("{steps}"))&&n&&a&&(i=i.replace("{step}",n.toString()).replace("{steps}",a.toString()));else if(y.isValidElement(e)&&!Object.values(e.props).length&&__(e.type)==="function"){const o=e.type({});i=yl(o,t)}else i=j4(r);return i}function I0e(e,t){return!Jt.plainObject(e)||!Jt.array(t)?!1:Object.keys(e).every(r=>t.includes(r))}function $0e(e){const t=/^#?([\da-f])([\da-f])([\da-f])$/i,r=e.replace(t,(a,i,o,l)=>i+i+o+o+l+l),n=/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i.exec(r);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:[]}function z4(e){return e.disableBeacon||e.placement==="center"}function B4(){return!["chrome","safari","firefox","opera"].includes(CV())}function xf({data:e,debug:t=!1,title:r,warn:n=!1}){const a=n?console.warn||console.error:console.log;t&&(r&&e?(console.groupCollapsed(`%creact-joyride: ${r}`,"color: #ff0044; font-weight: bold; font-size: 12px;"),Array.isArray(e)?e.forEach(i=>{Jt.plainObject(i)&&i.key?a.apply(console,[i.key,i.value]):a.apply(console,[i])}):a.apply(console,[e]),console.groupEnd()):console.error("Missing title or data props"))}function L0e(e){return Object.keys(e)}function PV(e,...t){if(!Jt.plainObject(e))throw new TypeError("Expected an object");const r={};for(const n in e)({}).hasOwnProperty.call(e,n)&&(t.includes(n)||(r[n]=e[n]));return r}function F0e(e,...t){if(!Jt.plainObject(e))throw new TypeError("Expected an object");if(!t.length)return e;const r={};for(const n in e)({}).hasOwnProperty.call(e,n)&&t.includes(n)&&(r[n]=e[n]);return r}function J2(e,t,r){const n=i=>i.replace("{step}",String(t)).replace("{steps}",String(r));if(__(e)==="string")return n(e);if(!y.isValidElement(e))return e;const{children:a}=e.props;if(__(a)==="string"&&a.includes("{step}"))return y.cloneElement(e,{children:n(a)});if(Array.isArray(a))return y.cloneElement(e,{children:a.map(i=>typeof i=="string"?n(i):J2(i,t,r))});if(__(e.type)==="function"&&!Object.values(e.props).length){const i=e.type({});return J2(i,t,r)}return e}function z0e(e){const{isFirstStep:t,lifecycle:r,previousLifecycle:n,scrollToFirstStep:a,step:i,target:o}=e;return!i.disableScrolling&&(!t||a||r===Ar.TOOLTIP)&&i.placement!=="center"&&(!i.isFixed||!Im(o))&&n!==r&&[Ar.BEACON,Ar.TOOLTIP].includes(r)}var B0e={options:{preventOverflow:{boundariesElement:"scrollParent"}},wrapperOptions:{offset:-18,position:!0}},TV={back:"Back",close:"Close",last:"Last",next:"Next",nextLabelWithProgress:"Next (Step {step} of {steps})",open:"Open the dialog",skip:"Skip"},U0e={event:"click",placement:"bottom",offset:10,disableBeacon:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrollParentFix:!1,disableScrolling:!1,hideBackButton:!1,hideCloseButton:!1,hideFooter:!1,isFixed:!1,locale:TV,showProgress:!1,showSkipButton:!1,spotlightClicks:!1,spotlightPadding:10},q0e={continuous:!1,debug:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrolling:!1,disableScrollParentFix:!1,getHelpers:void 0,hideBackButton:!1,run:!0,scrollOffset:20,scrollDuration:300,scrollToFirstStep:!1,showSkipButton:!1,showProgress:!1,spotlightClicks:!1,spotlightPadding:10,steps:[]},V0e={arrowColor:"#fff",backgroundColor:"#fff",beaconSize:36,overlayColor:"rgba(0, 0, 0, 0.5)",primaryColor:"#f04",spotlightShadow:"0 0 15px rgba(0, 0, 0, 0.5)",textColor:"#333",width:380,zIndex:100},bg={backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",cursor:"pointer",fontSize:16,lineHeight:1,padding:8,WebkitAppearance:"none"},U4={borderRadius:4,position:"absolute"};function W0e(e,t){var r,n,a,i,o;const{floaterProps:l,styles:c}=e,d=Uo((r=t.floaterProps)!=null?r:{},l!=null?l:{}),f=Uo(c!=null?c:{},(n=t.styles)!=null?n:{}),u=Uo(V0e,f.options||{}),h=t.placement==="center"||t.disableBeacon;let{width:m}=u;window.innerWidth>480&&(m=380),"width"in u&&(m=typeof u.width=="number"&&window.innerWidth<u.width?window.innerWidth-30:u.width);const v={bottom:0,left:0,overflow:"hidden",position:"absolute",right:0,top:0,zIndex:u.zIndex},g={beacon:V(D({},bg),{display:h?"none":"inline-block",height:u.beaconSize,position:"relative",width:u.beaconSize,zIndex:u.zIndex}),beaconInner:{animation:"joyride-beacon-inner 1.2s infinite ease-in-out",backgroundColor:u.primaryColor,borderRadius:"50%",display:"block",height:"50%",left:"50%",opacity:.7,position:"absolute",top:"50%",transform:"translate(-50%, -50%)",width:"50%"},beaconOuter:{animation:"joyride-beacon-outer 1.2s infinite ease-in-out",backgroundColor:`rgba(${$0e(u.primaryColor).join(",")}, 0.2)`,border:`2px solid ${u.primaryColor}`,borderRadius:"50%",boxSizing:"border-box",display:"block",height:"100%",left:0,opacity:.9,position:"absolute",top:0,transformOrigin:"center",width:"100%"},tooltip:{backgroundColor:u.backgroundColor,borderRadius:5,boxSizing:"border-box",color:u.textColor,fontSize:16,maxWidth:"100%",padding:15,position:"relative",width:m},tooltipContainer:{lineHeight:1.4,textAlign:"center"},tooltipTitle:{fontSize:18,margin:0},tooltipContent:{padding:"20px 10px"},tooltipFooter:{alignItems:"center",display:"flex",justifyContent:"flex-end",marginTop:15},tooltipFooterSpacer:{flex:1},buttonNext:V(D({},bg),{backgroundColor:u.primaryColor,borderRadius:4,color:"#fff"}),buttonBack:V(D({},bg),{color:u.primaryColor,marginLeft:"auto",marginRight:5}),buttonClose:V(D({},bg),{color:u.textColor,height:14,padding:15,position:"absolute",right:0,top:0,width:14}),buttonSkip:V(D({},bg),{color:u.textColor,fontSize:14}),overlay:V(D({},v),{backgroundColor:u.overlayColor,mixBlendMode:"hard-light"}),overlayLegacy:D({},v),overlayLegacyCenter:V(D({},v),{backgroundColor:u.overlayColor}),spotlight:V(D({},U4),{backgroundColor:"gray"}),spotlightLegacy:V(D({},U4),{boxShadow:`0 0 0 9999px ${u.overlayColor}, ${u.spotlightShadow}`}),floaterStyles:{arrow:{color:(o=(i=(a=d==null?void 0:d.styles)==null?void 0:a.arrow)==null?void 0:i.color)!=null?o:u.arrowColor},options:{zIndex:u.zIndex+100}},options:u};return Uo(g,f)}function H0e(e){return F0e(e,"beaconComponent","disableCloseOnEsc","disableOverlay","disableOverlayClose","disableScrolling","disableScrollParentFix","floaterProps","hideBackButton","hideCloseButton","locale","showProgress","showSkipButton","spotlightClicks","spotlightPadding","styles","tooltipComponent")}function ah(e,t){var r,n,a,i,o,l;const c=t!=null?t:{},d=Uo.all([U0e,H0e(e),c],{isMergeableObject:Jt.plainObject}),f=W0e(e,d),u=X1(xc(d.target),d.disableScrollParentFix),h=Uo.all([B0e,(r=e.floaterProps)!=null?r:{},(n=d.floaterProps)!=null?n:{}]);return h.offset=d.offset,h.styles=Uo((a=h.styles)!=null?a:{},f.floaterStyles),h.offset+=(o=(i=e.spotlightPadding)!=null?i:d.spotlightPadding)!=null?o:0,d.placementBeacon&&h.wrapperOptions&&(h.wrapperOptions.placement=d.placementBeacon),u&&h.options.preventOverflow&&(h.options.preventOverflow.boundariesElement="window"),V(D({},d),{locale:Uo.all([TV,(l=e.locale)!=null?l:{},d.locale||{}]),floaterProps:h,styles:PV(f,"floaterStyles")})}function AV(e,t=!1){return Jt.plainObject(e)?e.target?!0:(xf({title:"validateStep",data:"target is missing from the step",warn:!0,debug:t}),!1):(xf({title:"validateStep",data:"step must be an object",warn:!0,debug:t}),!1)}function q4(e,t=!1){return Jt.array(e)?e.every(r=>AV(r,t)):(xf({title:"validateSteps",data:"steps must be an array",warn:!0,debug:t}),!1)}var RV={action:"init",controlled:!1,index:0,lifecycle:Ar.INIT,origin:null,size:0,status:Jr.IDLE},V4=L0e(PV(RV,"controlled","size")),G0e=class{constructor(e){er(this,"beaconPopper"),er(this,"tooltipPopper"),er(this,"data",new Map),er(this,"listener"),er(this,"store",new Map),er(this,"addListener",a=>{this.listener=a}),er(this,"setSteps",a=>{const{size:i,status:o}=this.getState(),l={size:a.length,status:o};this.data.set("steps",a),o===Jr.WAITING&&!i&&a.length&&(l.status=Jr.RUNNING),this.setState(l)}),er(this,"getPopper",a=>a==="beacon"?this.beaconPopper:this.tooltipPopper),er(this,"setPopper",(a,i)=>{a==="beacon"?this.beaconPopper=i:this.tooltipPopper=i}),er(this,"cleanupPoppers",()=>{this.beaconPopper=null,this.tooltipPopper=null}),er(this,"close",(a=null)=>{const{index:i,status:o}=this.getState();o===Jr.RUNNING&&this.setState(D({},this.getNextState({action:xn.CLOSE,index:i+1,origin:a})))}),er(this,"go",a=>{const{controlled:i,status:o}=this.getState();if(i||o!==Jr.RUNNING)return;const l=this.getSteps()[a];this.setState(V(D({},this.getNextState({action:xn.GO,index:a})),{status:l?o:Jr.FINISHED}))}),er(this,"info",()=>this.getState()),er(this,"next",()=>{const{index:a,status:i}=this.getState();i===Jr.RUNNING&&this.setState(this.getNextState({action:xn.NEXT,index:a+1}))}),er(this,"open",()=>{const{status:a}=this.getState();a===Jr.RUNNING&&this.setState(D({},this.getNextState({action:xn.UPDATE,lifecycle:Ar.TOOLTIP})))}),er(this,"prev",()=>{const{index:a,status:i}=this.getState();i===Jr.RUNNING&&this.setState(D({},this.getNextState({action:xn.PREV,index:a-1})))}),er(this,"reset",(a=!1)=>{const{controlled:i}=this.getState();i||this.setState(V(D({},this.getNextState({action:xn.RESET,index:0})),{status:a?Jr.RUNNING:Jr.READY}))}),er(this,"skip",()=>{const{status:a}=this.getState();a===Jr.RUNNING&&this.setState({action:xn.SKIP,lifecycle:Ar.INIT,status:Jr.SKIPPED})}),er(this,"start",a=>{const{index:i,size:o}=this.getState();this.setState(V(D({},this.getNextState({action:xn.START,index:Jt.number(a)?a:i},!0)),{status:o?Jr.RUNNING:Jr.WAITING}))}),er(this,"stop",(a=!1)=>{const{index:i,status:o}=this.getState();[Jr.FINISHED,Jr.SKIPPED].includes(o)||this.setState(V(D({},this.getNextState({action:xn.STOP,index:i+(a?1:0)})),{status:Jr.PAUSED}))}),er(this,"update",a=>{var i,o;if(!I0e(a,V4))throw new Error(`State is not valid. Valid keys: ${V4.join(", ")}`);this.setState(D({},this.getNextState(V(D(D({},this.getState()),a),{action:(i=a.action)!=null?i:xn.UPDATE,origin:(o=a.origin)!=null?o:null}),!0)))});const{continuous:t=!1,stepIndex:r,steps:n=[]}=e!=null?e:{};this.setState({action:xn.INIT,controlled:Jt.number(r),continuous:t,index:Jt.number(r)?r:0,lifecycle:Ar.INIT,origin:null,status:n.length?Jr.READY:Jr.IDLE},!0),this.beaconPopper=null,this.tooltipPopper=null,this.listener=null,this.setSteps(n)}getState(){return this.store.size?{action:this.store.get("action")||"",controlled:this.store.get("controlled")||!1,index:parseInt(this.store.get("index"),10),lifecycle:this.store.get("lifecycle")||"",origin:this.store.get("origin")||null,size:this.store.get("size")||0,status:this.store.get("status")||""}:D({},RV)}getNextState(e,t=!1){var r,n,a,i,o;const{action:l,controlled:c,index:d,size:f,status:u}=this.getState(),h=Jt.number(e.index)?e.index:d,m=c&&!t?d:Math.min(Math.max(h,0),f);return{action:(r=e.action)!=null?r:l,controlled:c,index:m,lifecycle:(n=e.lifecycle)!=null?n:Ar.INIT,origin:(a=e.origin)!=null?a:null,size:(i=e.size)!=null?i:f,status:m===f?Jr.FINISHED:(o=e.status)!=null?o:u}}getSteps(){const e=this.data.get("steps");return Array.isArray(e)?e:[]}hasUpdatedState(e){const t=JSON.stringify(e),r=JSON.stringify(this.getState());return t!==r}setState(e,t=!1){const r=this.getState(),{action:n,index:a,lifecycle:i,origin:o=null,size:l,status:c}=D(D({},r),e);this.store.set("action",n),this.store.set("index",a),this.store.set("lifecycle",i),this.store.set("origin",o),this.store.set("size",l),this.store.set("status",c),t&&(this.store.set("controlled",e.controlled),this.store.set("continuous",e.continuous)),this.listener&&this.hasUpdatedState(r)&&this.listener(this.getState())}getHelpers(){return{close:this.close,go:this.go,info:this.info,next:this.next,open:this.open,prev:this.prev,reset:this.reset,skip:this.skip}}};function Y0e(e){return new G0e(e)}function K0e({styles:e}){return y.createElement("div",{key:"JoyrideSpotlight",className:"react-joyride__spotlight","data-test-id":"spotlight",style:e})}var Z0e=K0e,X0e=class extends y.Component{constructor(){super(...arguments),er(this,"isActive",!1),er(this,"resizeTimeout"),er(this,"scrollTimeout"),er(this,"scrollParent"),er(this,"state",{isScrolling:!1,mouseOverSpotlight:!1,showSpotlight:!0}),er(this,"hideSpotlight",()=>{const{continuous:e,disableOverlay:t,lifecycle:r}=this.props,n=[Ar.INIT,Ar.BEACON,Ar.COMPLETE,Ar.ERROR];return t||(e?n.includes(r):r!==Ar.TOOLTIP)}),er(this,"handleMouseMove",e=>{const{mouseOverSpotlight:t}=this.state,{height:r,left:n,position:a,top:i,width:o}=this.spotlightStyles,l=a==="fixed"?e.clientY:e.pageY,c=a==="fixed"?e.clientX:e.pageX,d=l>=i&&l<=i+r,u=c>=n&&c<=n+o&&d;u!==t&&this.updateState({mouseOverSpotlight:u})}),er(this,"handleScroll",()=>{const{target:e}=this.props,t=xc(e);if(this.scrollParent!==document){const{isScrolling:r}=this.state;r||this.updateState({isScrolling:!0,showSpotlight:!1}),clearTimeout(this.scrollTimeout),this.scrollTimeout=window.setTimeout(()=>{this.updateState({isScrolling:!1,showSpotlight:!0})},50)}else Im(t,"sticky")&&this.updateState({})}),er(this,"handleResize",()=>{clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(()=>{this.isActive&&this.forceUpdate()},100)})}componentDidMount(){const{debug:e,disableScrolling:t,disableScrollParentFix:r=!1,target:n}=this.props,a=xc(n);this.scrollParent=Xv(a!=null?a:document.body,r,!0),this.isActive=!0,window.addEventListener("resize",this.handleResize)}componentDidUpdate(e){var t;const{disableScrollParentFix:r,lifecycle:n,spotlightClicks:a,target:i}=this.props,{changed:o}=bw(e,this.props);if(o("target")||o("disableScrollParentFix")){const l=xc(i);this.scrollParent=Xv(l!=null?l:document.body,r,!0)}o("lifecycle",Ar.TOOLTIP)&&((t=this.scrollParent)==null||t.addEventListener("scroll",this.handleScroll,{passive:!0}),setTimeout(()=>{const{isScrolling:l}=this.state;l||this.updateState({showSpotlight:!0})},100)),(o("spotlightClicks")||o("disableOverlay")||o("lifecycle"))&&(a&&n===Ar.TOOLTIP?window.addEventListener("mousemove",this.handleMouseMove,!1):n!==Ar.TOOLTIP&&window.removeEventListener("mousemove",this.handleMouseMove))}componentWillUnmount(){var e;this.isActive=!1,window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("resize",this.handleResize),clearTimeout(this.resizeTimeout),clearTimeout(this.scrollTimeout),(e=this.scrollParent)==null||e.removeEventListener("scroll",this.handleScroll)}get overlayStyles(){const{mouseOverSpotlight:e}=this.state,{disableOverlayClose:t,placement:r,styles:n}=this.props;let a=n.overlay;return B4()&&(a=r==="center"?n.overlayLegacyCenter:n.overlayLegacy),D({cursor:t?"default":"pointer",height:P0e(),pointerEvents:e?"none":"auto"},a)}get spotlightStyles(){var e,t,r;const{showSpotlight:n}=this.state,{disableScrollParentFix:a=!1,spotlightClicks:i,spotlightPadding:o=0,styles:l,target:c}=this.props,d=xc(c),f=EV(d),u=Im(d),h=O0e(d,o,a);return V(D({},B4()?l.spotlightLegacy:l.spotlight),{height:Math.round(((e=f==null?void 0:f.height)!=null?e:0)+o*2),left:Math.round(((t=f==null?void 0:f.left)!=null?t:0)-o),opacity:n?1:0,pointerEvents:i?"none":"auto",position:u?"fixed":"absolute",top:h,transition:"opacity 0.2s",width:Math.round(((r=f==null?void 0:f.width)!=null?r:0)+o*2)})}updateState(e){this.isActive&&this.setState(t=>D(D({},t),e))}render(){const{showSpotlight:e}=this.state,{onClickOverlay:t,placement:r}=this.props,{hideSpotlight:n,overlayStyles:a,spotlightStyles:i}=this;if(n())return null;let o=r!=="center"&&e&&y.createElement(Z0e,{styles:i});if(CV()==="safari"){const l=a,{mixBlendMode:c,zIndex:d}=l,f=ge(l,["mixBlendMode","zIndex"]);o=y.createElement("div",{style:D({},f)},o),delete a.backgroundColor}return y.createElement("div",{className:"react-joyride__overlay","data-test-id":"overlay",onClick:t,role:"presentation",style:a},o)}},J0e=class extends y.Component{constructor(){super(...arguments),er(this,"node",null)}componentDidMount(){const{id:e}=this.props;pd()&&(this.node=document.createElement("div"),this.node.id=e,document.body.appendChild(this.node),wg||this.renderReact15())}componentDidUpdate(){pd()&&(wg||this.renderReact15())}componentWillUnmount(){!pd()||!this.node||(wg||ao.unmountComponentAtNode(this.node),this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=null))}renderReact15(){if(!pd())return;const{children:e}=this.props;this.node&&ao.unstable_renderSubtreeIntoContainer(this,e,this.node)}renderReact16(){if(!pd()||!wg)return null;const{children:e}=this.props;return this.node?ao.createPortal(e,this.node):null}render(){return wg?this.renderReact16():null}},Q0e=class{constructor(e,t){if(er(this,"element"),er(this,"options"),er(this,"canBeTabbed",r=>{const{tabIndex:n}=r;return n===null||n<0?!1:this.canHaveFocus(r)}),er(this,"canHaveFocus",r=>{const n=/input|select|textarea|button|object/,a=r.nodeName.toLowerCase();return(n.test(a)&&!r.getAttribute("disabled")||a==="a"&&!!r.getAttribute("href"))&&this.isVisible(r)}),er(this,"findValidTabElements",()=>[].slice.call(this.element.querySelectorAll("*"),0).filter(this.canBeTabbed)),er(this,"handleKeyDown",r=>{const{code:n="Tab"}=this.options;r.code===n&&this.interceptTab(r)}),er(this,"interceptTab",r=>{r.preventDefault();const n=this.findValidTabElements(),{shiftKey:a}=r;if(!n.length)return;let i=document.activeElement?n.indexOf(document.activeElement):0;i===-1||!a&&i+1===n.length?i=0:a&&i===0?i=n.length-1:i+=a?-1:1,n[i].focus()}),er(this,"isHidden",r=>{const n=r.offsetWidth<=0&&r.offsetHeight<=0,a=window.getComputedStyle(r);return n&&!r.innerHTML?!0:n&&a.getPropertyValue("overflow")!=="visible"||a.getPropertyValue("display")==="none"}),er(this,"isVisible",r=>{let n=r;for(;n;)if(n instanceof HTMLElement){if(n===document.body)break;if(this.isHidden(n))return!1;n=n.parentNode}return!0}),er(this,"removeScope",()=>{window.removeEventListener("keydown",this.handleKeyDown)}),er(this,"checkFocus",r=>{document.activeElement!==r&&(r.focus(),window.requestAnimationFrame(()=>this.checkFocus(r)))}),er(this,"setFocus",()=>{const{selector:r}=this.options;if(!r)return;const n=this.element.querySelector(r);n&&window.requestAnimationFrame(()=>this.checkFocus(n))}),!(e instanceof HTMLElement))throw new TypeError("Invalid parameter: element must be an HTMLElement");this.element=e,this.options=t,window.addEventListener("keydown",this.handleKeyDown,!1),this.setFocus()}},exe=class extends y.Component{constructor(e){if(super(e),er(this,"beacon",null),er(this,"setBeaconRef",a=>{this.beacon=a}),e.beaconComponent)return;const t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.id="joyride-beacon-animation",e.nonce&&r.setAttribute("nonce",e.nonce),r.appendChild(document.createTextNode(`
        @keyframes joyride-beacon-inner {
          20% {
            opacity: 0.9;
          }
        
          90% {
            opacity: 0.7;
          }
        }
        
        @keyframes joyride-beacon-outer {
          0% {
            transform: scale(1);
          }
        
          45% {
            opacity: 0.7;
            transform: scale(0.75);
          }
        
          100% {
            opacity: 0.9;
            transform: scale(1);
          }
        }
      `)),t.appendChild(r)}componentDidMount(){const{shouldFocus:e}=this.props;setTimeout(()=>{Jt.domElement(this.beacon)&&e&&this.beacon.focus()},0)}componentWillUnmount(){const e=document.getElementById("joyride-beacon-animation");e!=null&&e.parentNode&&e.parentNode.removeChild(e)}render(){const{beaconComponent:e,continuous:t,index:r,isLastStep:n,locale:a,onClickOrHover:i,size:o,step:l,styles:c}=this.props,d=yl(a.open),f={"aria-label":d,onClick:i,onMouseEnter:i,ref:this.setBeaconRef,title:d};let u;if(e){const h=e;u=y.createElement(h,D({continuous:t,index:r,isLastStep:n,size:o,step:l},f))}else u=y.createElement("button",D({key:"JoyrideBeacon",className:"react-joyride__beacon","data-test-id":"button-beacon",style:c.beacon,type:"button"},f),y.createElement("span",{style:c.beaconInner}),y.createElement("span",{style:c.beaconOuter}));return u}};function txe(r){var n=r,{styles:e}=n,t=ge(n,["styles"]);const c=e,{color:a,height:i,width:o}=c,l=ge(c,["color","height","width"]);return te.createElement("button",D({style:l,type:"button"},t),te.createElement("svg",{height:typeof i=="number"?`${i}px`:i,preserveAspectRatio:"xMidYMid",version:"1.1",viewBox:"0 0 18 18",width:typeof o=="number"?`${o}px`:o,xmlns:"http://www.w3.org/2000/svg"},te.createElement("g",null,te.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:a}))))}var rxe=txe;function nxe(e){const{backProps:t,closeProps:r,index:n,isLastStep:a,primaryProps:i,skipProps:o,step:l,tooltipProps:c}=e,{content:d,hideBackButton:f,hideCloseButton:u,hideFooter:h,showSkipButton:m,styles:v,title:g}=l,x={};return x.primary=y.createElement("button",D({"data-test-id":"button-primary",style:v.buttonNext,type:"button"},i)),m&&!a&&(x.skip=y.createElement("button",D({"aria-live":"off","data-test-id":"button-skip",style:v.buttonSkip,type:"button"},o))),!f&&n>0&&(x.back=y.createElement("button",D({"data-test-id":"button-back",style:v.buttonBack,type:"button"},t))),x.close=!u&&y.createElement(rxe,D({"data-test-id":"button-close",styles:v.buttonClose},r)),y.createElement("div",D({key:"JoyrideTooltip","aria-label":yl(g!=null?g:d),className:"react-joyride__tooltip",style:v.tooltip},c),y.createElement("div",{style:v.tooltipContainer},g&&y.createElement("h1",{"aria-label":yl(g),style:v.tooltipTitle},g),y.createElement("div",{style:v.tooltipContent},d)),!h&&y.createElement("div",{style:v.tooltipFooter},y.createElement("div",{style:v.tooltipFooterSpacer},x.skip),x.back,x.primary),x.close)}var sxe=nxe,axe=class extends y.Component{constructor(){super(...arguments),er(this,"handleClickBack",e=>{e.preventDefault();const{helpers:t}=this.props;t.prev()}),er(this,"handleClickClose",e=>{e.preventDefault();const{helpers:t}=this.props;t.close("button_close")}),er(this,"handleClickPrimary",e=>{e.preventDefault();const{continuous:t,helpers:r}=this.props;if(!t){r.close("button_primary");return}r.next()}),er(this,"handleClickSkip",e=>{e.preventDefault();const{helpers:t}=this.props;t.skip()}),er(this,"getElementsProps",()=>{const{continuous:e,index:t,isLastStep:r,setTooltipRef:n,size:a,step:i}=this.props,{back:o,close:l,last:c,next:d,nextLabelWithProgress:f,skip:u}=i.locale,h=yl(o),m=yl(l),v=yl(c),g=yl(d),x=yl(u);let _=l,w=m;if(e){if(_=d,w=g,i.showProgress&&!r){const b=yl(f,{step:t+1,steps:a});_=J2(f,t+1,a),w=b}r&&(_=c,w=v)}return{backProps:{"aria-label":h,children:o,"data-action":"back",onClick:this.handleClickBack,role:"button",title:h},closeProps:{"aria-label":m,children:l,"data-action":"close",onClick:this.handleClickClose,role:"button",title:m},primaryProps:{"aria-label":w,children:_,"data-action":"primary",onClick:this.handleClickPrimary,role:"button",title:w},skipProps:{"aria-label":x,children:u,"data-action":"skip",onClick:this.handleClickSkip,role:"button",title:x},tooltipProps:{"aria-modal":!0,ref:n,role:"alertdialog"}}})}render(){const{continuous:e,index:t,isLastStep:r,setTooltipRef:n,size:a,step:i}=this.props,f=i,{beaconComponent:o,tooltipComponent:l}=f,c=ge(f,["beaconComponent","tooltipComponent"]);let d;if(l){const u=V(D({},this.getElementsProps()),{continuous:e,index:t,isLastStep:r,size:a,step:c,setTooltipRef:n}),h=l;d=y.createElement(h,D({},u))}else d=y.createElement(sxe,V(D({},this.getElementsProps()),{continuous:e,index:t,isLastStep:r,size:a,step:i}));return d}},ixe=class extends y.Component{constructor(){super(...arguments),er(this,"scope",null),er(this,"tooltip",null),er(this,"handleClickHoverBeacon",e=>{const{step:t,store:r}=this.props;e.type==="mouseenter"&&t.event!=="hover"||r.update({lifecycle:Ar.TOOLTIP})}),er(this,"setTooltipRef",e=>{this.tooltip=e}),er(this,"setPopper",(e,t)=>{var r;const{action:n,lifecycle:a,step:i,store:o}=this.props;t==="wrapper"?o.setPopper("beacon",e):o.setPopper("tooltip",e),o.getPopper("beacon")&&(o.getPopper("tooltip")||i.placement==="center")&&a===Ar.INIT&&o.update({action:n,lifecycle:Ar.READY}),(r=i.floaterProps)!=null&&r.getPopper&&i.floaterProps.getPopper(e,t)}),er(this,"renderTooltip",e=>{const{continuous:t,helpers:r,index:n,size:a,step:i}=this.props;return y.createElement(axe,D({continuous:t,helpers:r,index:n,isLastStep:n+1===a,setTooltipRef:this.setTooltipRef,size:a,step:i},e))})}componentDidMount(){const{debug:e,index:t}=this.props;xf({title:`step:${t}`,data:[{key:"props",value:this.props}],debug:e})}componentDidUpdate(e){var t;const{action:r,callback:n,continuous:a,controlled:i,debug:o,helpers:l,index:c,lifecycle:d,shouldScroll:f,status:u,step:h,store:m}=this.props,{changed:v,changedFrom:g}=bw(e,this.props),x=l.info(),_=a&&r!==xn.CLOSE&&(c>0||r===xn.PREV),w=v("action")||v("index")||v("lifecycle")||v("status"),b=g("lifecycle",[Ar.TOOLTIP,Ar.INIT],Ar.INIT),N=v("action",[xn.NEXT,xn.PREV,xn.SKIP,xn.CLOSE]),S=i&&c===e.index;if(N&&(b||S)&&n(V(D({},x),{index:e.index,lifecycle:Ar.COMPLETE,step:e.step,type:Vs.STEP_AFTER})),h.placement==="center"&&u===Jr.RUNNING&&v("index")&&r!==xn.START&&d===Ar.INIT&&m.update({lifecycle:Ar.READY}),w){const k=xc(h.target),C=!!k;C&&R0e(k)?(g("status",Jr.READY,Jr.RUNNING)||g("lifecycle",Ar.INIT,Ar.READY))&&n(V(D({},x),{step:h,type:Vs.STEP_BEFORE})):(console.warn(C?"Target not visible":"Target not mounted",h),n(V(D({},x),{type:Vs.TARGET_NOT_FOUND,step:h})),i||m.update({index:c+(r===xn.PREV?-1:1)}))}g("lifecycle",Ar.INIT,Ar.READY)&&m.update({lifecycle:z4(h)||_?Ar.TOOLTIP:Ar.BEACON}),v("index")&&xf({title:`step:${d}`,data:[{key:"props",value:this.props}],debug:o}),v("lifecycle",Ar.BEACON)&&n(V(D({},x),{step:h,type:Vs.BEACON})),v("lifecycle",Ar.TOOLTIP)&&(n(V(D({},x),{step:h,type:Vs.TOOLTIP})),f&&this.tooltip&&(this.scope=new Q0e(this.tooltip,{selector:"[data-action=primary]"}),this.scope.setFocus())),g("lifecycle",[Ar.TOOLTIP,Ar.INIT],Ar.INIT)&&((t=this.scope)==null||t.removeScope(),m.cleanupPoppers())}componentWillUnmount(){var e;(e=this.scope)==null||e.removeScope()}get open(){const{lifecycle:e,step:t}=this.props;return z4(t)||e===Ar.TOOLTIP}render(){const{continuous:e,debug:t,index:r,nonce:n,shouldScroll:a,size:i,step:o}=this.props,l=xc(o.target);return!AV(o)||!Jt.domElement(l)?null:y.createElement("div",{key:`JoyrideStep-${r}`,className:"react-joyride__step"},y.createElement(kA,V(D({},o.floaterProps),{component:this.renderTooltip,debug:t,getPopper:this.setPopper,id:`react-joyride-step-${r}`,open:this.open,placement:o.placement,target:o.target}),y.createElement(exe,{beaconComponent:o.beaconComponent,continuous:e,index:r,isLastStep:r+1===i,locale:o.locale,nonce:n,onClickOrHover:this.handleClickHoverBeacon,shouldFocus:a,size:i,step:o,styles:o.styles})))}},OV=class extends y.Component{constructor(e){super(e),er(this,"helpers"),er(this,"store"),er(this,"callback",o=>{const{callback:l}=this.props;Jt.function(l)&&l(o)}),er(this,"handleKeyboard",o=>{const{index:l,lifecycle:c}=this.state,{steps:d}=this.props,f=d[l];c===Ar.TOOLTIP&&o.code==="Escape"&&f&&!f.disableCloseOnEsc&&this.store.close("keyboard")}),er(this,"handleClickOverlay",()=>{const{index:o}=this.state,{steps:l}=this.props;ah(this.props,l[o]).disableOverlayClose||this.helpers.close("overlay")}),er(this,"syncState",o=>{this.setState(o)});const{debug:t,getHelpers:r,run:n=!0,stepIndex:a}=e;this.store=Y0e(V(D({},e),{controlled:n&&Jt.number(a)})),this.helpers=this.store.getHelpers();const{addListener:i}=this.store;xf({title:"init",data:[{key:"props",value:this.props},{key:"state",value:this.state}],debug:t}),i(this.syncState),r&&r(this.helpers),this.state=this.store.getState()}componentDidMount(){if(!pd())return;const{debug:e,disableCloseOnEsc:t,run:r,steps:n}=this.props,{start:a}=this.store;q4(n,e)&&r&&a(),t||document.body.addEventListener("keydown",this.handleKeyboard,{passive:!0})}componentDidUpdate(e,t){if(!pd())return;const{action:r,controlled:n,index:a,status:i}=this.state,{debug:o,run:l,stepIndex:c,steps:d}=this.props,{stepIndex:f,steps:u}=e,{reset:h,setSteps:m,start:v,stop:g,update:x}=this.store,{changed:_}=bw(e,this.props),{changed:w,changedFrom:b}=bw(t,this.state),N=ah(this.props,d[a]),S=!Wa(u,d),k=Jt.number(c)&&_("stepIndex"),C=xc(N.target);if(S&&(q4(d,o)?m(d):console.warn("Steps are not valid",d)),_("run")&&(l?v(c):g()),k){let I=Jt.number(f)&&f<c?xn.NEXT:xn.PREV;r===xn.STOP&&(I=xn.START),[Jr.FINISHED,Jr.SKIPPED].includes(i)||x({action:r===xn.CLOSE?xn.CLOSE:I,index:c,lifecycle:Ar.INIT})}!n&&i===Jr.RUNNING&&a===0&&!C&&(this.store.update({index:a+1}),this.callback(V(D({},this.state),{type:Vs.TARGET_NOT_FOUND,step:N})));const A=V(D({},this.state),{index:a,step:N});if(w("action",[xn.NEXT,xn.PREV,xn.SKIP,xn.CLOSE])&&w("status",Jr.PAUSED)){const I=ah(this.props,d[t.index]);this.callback(V(D({},A),{index:t.index,lifecycle:Ar.COMPLETE,step:I,type:Vs.STEP_AFTER}))}if(w("status",[Jr.FINISHED,Jr.SKIPPED])){const I=ah(this.props,d[t.index]);n||this.callback(V(D({},A),{index:t.index,lifecycle:Ar.COMPLETE,step:I,type:Vs.STEP_AFTER})),this.callback(V(D({},A),{type:Vs.TOUR_END,step:I,index:t.index})),h()}else b("status",[Jr.IDLE,Jr.READY],Jr.RUNNING)?this.callback(V(D({},A),{type:Vs.TOUR_START})):(w("status")||w("action",xn.RESET))&&this.callback(V(D({},A),{type:Vs.TOUR_STATUS}));this.scrollToStep(t)}componentWillUnmount(){const{disableCloseOnEsc:e}=this.props;e||document.body.removeEventListener("keydown",this.handleKeyboard)}scrollToStep(e){const{index:t,lifecycle:r,status:n}=this.state,{debug:a,disableScrollParentFix:i=!1,scrollDuration:o,scrollOffset:l=20,scrollToFirstStep:c=!1,steps:d}=this.props,f=ah(this.props,d[t]),u=xc(f.target),h=z0e({isFirstStep:t===0,lifecycle:r,previousLifecycle:e.lifecycle,scrollToFirstStep:c,step:f,target:u});if(n===Jr.RUNNING&&h){const m=X1(u,i),v=Xv(u,i);let g=Math.floor(M0e(u,l,i))||0;xf({title:"scrollToStep",data:[{key:"index",value:t},{key:"lifecycle",value:r},{key:"status",value:n}],debug:a});const x=this.store.getPopper("beacon"),_=this.store.getPopper("tooltip");if(r===Ar.BEACON&&x){const{offsets:w,placement:b}=x;!["bottom"].includes(b)&&!m&&(g=Math.floor(w.popper.top-l))}else if(r===Ar.TOOLTIP&&_){const{flipped:w,offsets:b,placement:N}=_;["top","right","left"].includes(N)&&!w&&!m?g=Math.floor(b.popper.top-l):g-=f.spotlightPadding}g=g>=0?g:0,n===Jr.RUNNING&&D0e(g,{element:v,duration:o}).then(()=>{setTimeout(()=>{var w;(w=this.store.getPopper("tooltip"))==null||w.instance.update()},10)})}}render(){if(!pd())return null;const{index:e,lifecycle:t,status:r}=this.state,{continuous:n=!1,debug:a=!1,nonce:i,scrollToFirstStep:o=!1,steps:l}=this.props,c=r===Jr.RUNNING,d={};if(c&&l[e]){const f=ah(this.props,l[e]);d.step=y.createElement(ixe,V(D({},this.state),{callback:this.callback,continuous:n,debug:a,helpers:this.helpers,nonce:i,shouldScroll:!f.disableScrolling&&(e!==0||o),step:f,store:this.store})),d.overlay=y.createElement(J0e,{id:"react-joyride-portal"},y.createElement(X0e,V(D({},f),{continuous:n,debug:a,lifecycle:t,onClickOverlay:this.handleClickOverlay})))}return y.createElement("div",{className:"react-joyride"},d.step,d.overlay)}};er(OV,"defaultProps",q0e);var oxe=OV;class Iu{static checkOnboardingStatus(t){return E(this,null,function*(){var r,n,a,i;try{const{data:o,error:l}=yield T.from("users").select("onboarding_completed, onboarding_skipped, tour_completed").eq("user_id",t).single();if(l){if(l.code==="42703"||(r=l.message)!=null&&r.includes("does not exist"))return console.warn("Onboarding columns not found in users table, returning defaults"),{onboarding_completed:!1,onboarding_skipped:!1,tour_completed:!1};throw l}return{onboarding_completed:(n=o==null?void 0:o.onboarding_completed)!=null?n:!1,onboarding_skipped:(a=o==null?void 0:o.onboarding_skipped)!=null?a:!1,tour_completed:(i=o==null?void 0:o.tour_completed)!=null?i:!1}}catch(o){return console.error("Error checking onboarding status:",o),{onboarding_completed:!1,onboarding_skipped:!1,tour_completed:!1}}})}static saveProfileSetup(t,r){return E(this,null,function*(){var n,i,o,l;try{const c={updated_at:new Date().toISOString()};r.username!==void 0&&(c.username=String(r.username).toLowerCase().trim()),r.birthday!==void 0&&(c.birthday=r.birthday),r.gender!==void 0&&(c.gender=r.gender),r.bio!==void 0&&(c.bio=r.bio),r.avatar_url!==void 0&&(c.avatar_url=r.avatar_url),r.location_city!==void 0&&(c.location_city=r.location_city);const{error:d}=yield T.from("users").update(c).eq("user_id",t);if(d){if(d.code==="PGRST204"||(n=d.message)!=null&&n.includes("does not exist")){console.warn("Some columns not found, trying without them:",d.message);const a=c,{username:f,location_city:u}=a,h=ge(a,["username","location_city"]),{error:m}=yield T.from("users").update(h).eq("user_id",t);if(m)throw m.code==="23505"&&((i=m.message)!=null&&i.includes("username"))?new Error("Username is already taken"):m;return!0}throw d.code==="23505"&&((o=d.message)!=null&&o.includes("username"))?new Error("Username is already taken"):d}return!0}catch(c){if(console.error("Error saving profile setup:",c),(l=c==null?void 0:c.message)!=null&&l.includes("Username is already taken"))throw c;return!1}})}static requestAccountUpgrade(t,r,n){return E(this,null,function*(){try{const{error:a}=yield T.from("account_upgrade_requests").insert({user_id:t,requested_account_type:r,business_info:n,status:"pending"});if(a)throw a;return!0}catch(a){return console.error("Error requesting account upgrade:",a),!1}})}static skipOnboarding(t){return E(this,null,function*(){var r;try{const{error:n}=yield T.from("users").update({onboarding_skipped:!0,updated_at:new Date().toISOString()}).eq("user_id",t);if(n){if(n.code==="42703"||(r=n.message)!=null&&r.includes("does not exist"))return console.warn("onboarding_skipped column not found, skipping update"),!0;throw n}return!0}catch(n){return console.error("Error skipping onboarding:",n),!1}})}static completeOnboarding(t){return E(this,null,function*(){var r;try{const{error:n}=yield T.from("users").update({onboarding_completed:!0,onboarding_skipped:!1,updated_at:new Date().toISOString()}).eq("user_id",t);if(n){if(n.code==="42703"||(r=n.message)!=null&&r.includes("does not exist"))return console.warn("onboarding_completed column not found, skipping update"),!0;throw n}return!0}catch(n){return console.error("Error completing onboarding:",n),!1}})}static completeTour(t){return E(this,null,function*(){var r;try{const{error:n}=yield T.from("users").update({tour_completed:!0,updated_at:new Date().toISOString()}).eq("user_id",t);if(n){if(n.code==="42703"||(r=n.message)!=null&&r.includes("does not exist"))return console.warn("tour_completed column not found, skipping update"),!0;throw n}return!0}catch(n){return console.error("Error completing tour:",n),!1}})}static hasPendingUpgradeRequest(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("account_upgrade_requests").select("id, status").eq("user_id",t).eq("status","pending").maybeSingle();if(n)throw n;return r!==null}catch(r){return console.error("Error checking pending upgrade request:",r),!1}})}static saveMusicPreferences(t,r,n){return E(this,null,function*(){try{const a=[],i=new Date().toISOString();if(r.forEach((o,l)=>{const c=Math.max(10-l,1);a.push({user_id:t,signal_type:"genre_manual_preference",entity_type:"genre",entity_id:null,entity_name:o,signal_weight:c,genre:o,context:{source:"onboarding",order:l+1},occurred_at:i,created_at:i,updated_at:i})}),n.forEach((o,l)=>{const c=Math.max(10-l,1);a.push({user_id:t,signal_type:"artist_manual_preference",entity_type:"artist",entity_id:o.id||null,entity_name:o.name,signal_weight:c,genre:null,context:{source:"onboarding",order:l+1},occurred_at:i,created_at:i,updated_at:i})}),a.length>0){const{error:o}=yield T.from("user_preference_signals").insert(a);if(o)return console.error("Error saving music preferences:",o),!1}return!0}catch(a){return console.error("Error saving music preferences:",a),!1}})}}const ih=(e,t=8e3,r=50)=>new Promise((n,a)=>{const i=Date.now(),o=document.querySelector(e);if(o&&o.offsetParent!==null&&o.getBoundingClientRect().width>0){n(o);return}const l=new MutationObserver(()=>{const d=document.querySelector(e);if(d){const f=d.getBoundingClientRect();if(d.offsetParent!==null&&f.width>0&&f.height>0){l.disconnect(),n(d);return}}if(Date.now()-i>=t){l.disconnect(),a(new Error(`Timeout waiting for element: ${e}`));return}});l.observe(document.body,{childList:!0,subtree:!0,attributes:!1});const c=setInterval(()=>{const d=document.querySelector(e);if(d){const f=d.getBoundingClientRect();if(d.offsetParent!==null&&f.width>0&&f.height>0){clearInterval(c),l.disconnect(),n(d);return}}Date.now()-i>=t&&(clearInterval(c),l.disconnect(),a(new Error(`Timeout waiting for element: ${e}`)))},r)}),lxe=({run:e,onFinish:t,onViewChange:r})=>{const{user:n}=ws(),[a,i]=y.useState(e),[o,l]=y.useState(void 0),[c,d]=y.useState(!1),[f,u]=y.useState(""),h=te.useRef(null);y.useEffect(()=>{i(e),e||(l(void 0),d(!1),u(""))},[e]),y.useEffect(()=>{if(a&&o===2){const g=setInterval(()=>{(document.querySelector("[data-joyride]")||document.querySelector(".react-joyride__tooltip")||document.querySelector('[role="dialog"]'))&&(console.log("Step 3 tooltip detected, clearing stepIndex for button clicks"),l(void 0),clearInterval(g))},50);return setTimeout(()=>{clearInterval(g),o===2&&(console.log("Timeout clearing stepIndex"),l(void 0))},2e3),()=>clearInterval(g)}},[a,o]),y.useEffect(()=>{a&&h.current===2&&o===void 0&&(console.log("Resuming tour at step 3, setting stepIndex briefly"),l(2),setTimeout(()=>{console.log("Clearing stepIndex after resume"),l(void 0),h.current=null},50))},[a,o]),y.useEffect(()=>{a&&h.current===4&&o===void 0&&(console.log("Resuming tour at step 5, setting stepIndex briefly"),l(4),setTimeout(()=>{console.log("Clearing stepIndex after resume step 5"),l(void 0),h.current=null},50))},[a,o]),y.useEffect(()=>{a&&h.current===5&&o===void 0&&(console.log("Resuming tour at step 6, setting stepIndex briefly"),l(5),setTimeout(()=>{console.log("Clearing stepIndex after resume step 6"),l(void 0),h.current=null},50))},[a,o]);const m=[{target:"body",content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Welcome to Synth! "}),s.jsx("p",{children:"Let's take a quick tour of the app to help you discover shows, connect with friends, and share your concert experiences."})]}),placement:"center",disableBeacon:!0,before:()=>{r&&r("feed")}},{target:'[data-tour="feed-toggle"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Toggle Your Feed"}),s.jsx("p",{children:"Switch between different feed types: Hand Picked Events, Trending Events, Friends Interested, and more. Each feed shows you different perspectives on what's happening."})]}),placement:"bottom",disableBeacon:!0,before:()=>E(void 0,null,function*(){r&&r("feed"),yield new Promise(g=>setTimeout(g,300)),yield new Promise(g=>requestAnimationFrame(g));try{(yield ih('[data-tour="feed-toggle"]',5e3)).scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(x=>setTimeout(x,400))}catch(g){throw console.error("Step 2: Element not found:",g),g}})},{target:'[data-tour="discover-vibes"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Discover by Vibes"}),s.jsx("p",{children:"Browse Vibes lets you explore events by mood and scene. You can also use the Map & Calendar view to see events by location and date. Try different vibes to find shows that match your energy!"})]}),placement:"bottom",disableBeacon:!0,before:()=>E(void 0,null,function*(){console.log("Step 3 before: Checking if discover view is ready"),r&&r("search"),yield new Promise(_=>setTimeout(_,200)),yield new Promise(_=>requestAnimationFrame(_)),yield new Promise(_=>requestAnimationFrame(_)),console.log("Step 3 before: Waiting for element...");const g=yield ih('[data-tour="discover-vibes"]',1e4);console.log("Step 3 before: Element found!",g),g.scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(_=>setTimeout(_,400));const x=g.getBoundingClientRect();if(x.width===0||x.height===0||g.offsetParent===null)throw console.error("Step 3 before: Element not visible!",x),new Error("Target element not visible");console.log("Step 3 before: Element verified and ready")})},{target:'[data-tour="create-review"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Share Your Experience"}),s.jsx("p",{children:"Tap the pink plus button to create a review for any show you've attended. Share photos, rate the performance, and let your friends know what you thought!"})]}),placement:"top",disableBeacon:!0,before:()=>E(void 0,null,function*(){r&&r("feed"),yield new Promise(g=>setTimeout(g,300)),yield new Promise(g=>requestAnimationFrame(g));try{(yield ih('[data-tour="create-review"]',5e3)).scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(x=>setTimeout(x,400))}catch(g){throw console.error("Step 4: Element not found:",g),g}})},{target:'[data-tour="chat"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Connect with Friends"}),s.jsx("p",{children:"Use the messages icon to chat with friends, join group conversations about shows, and stay connected with your concert community."})]}),placement:"top",disableBeacon:!0,before:()=>E(void 0,null,function*(){console.log("Step 5 before: Verifying chat view is loaded");try{Array.from(document.querySelectorAll("h1")).find(_=>{var w;return((w=_.textContent)==null?void 0:w.trim())==="Messages"})||(console.warn("Step 5 before: Messages heading not found, waiting..."),yield new Promise(_=>setTimeout(_,300))),console.log("Step 5 before: Waiting for chat navigation button...");const x=yield ih('[data-tour="chat"]',8e3);console.log("Step 5 before: Chat navigation button found!"),x.scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(_=>setTimeout(_,400))}catch(g){console.error("Step 5: Element not found:",g)}})},{target:'[data-tour="profile-passport"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Your Live Music Passport"}),s.jsx("p",{children:"Check out your profile and Live Music Passport! See your identity, stamps, achievements, timeline, and bucket list. Track your concert journey all in one place."})]}),placement:"top",disableBeacon:!0,before:()=>E(void 0,null,function*(){console.log("Step 6 before: Navigating to profile view"),r&&r("profile"),yield new Promise(g=>setTimeout(g,400)),yield new Promise(g=>requestAnimationFrame(g)),yield new Promise(g=>requestAnimationFrame(g));try{console.log("Step 6 before: Waiting for profile-passport element...");const g=yield ih('[data-tour="profile-passport"]',6e3);console.log("Step 6 before: Profile-passport element found!"),g.scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(x=>setTimeout(x,400))}catch(g){console.error("Step 6: Element not found:",g)}})},{target:"body",content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"You're All Set! "}),s.jsx("p",{children:"You've completed the tour! Start exploring shows, connecting with friends, and sharing your concert experiences. Have fun!"})]}),placement:"center",disableBeacon:!0,before:()=>E(void 0,null,function*(){r&&r("feed"),yield new Promise(g=>setTimeout(g,500))})}],v=g=>E(void 0,null,function*(){const{status:x,type:_,index:w,action:b}=g;if(_===Vs.STEP_AFTER&&b===xn.NEXT&&w===1&&r){console.log("Step 2 completed: Pausing tour to load discover view"),i(!1),d(!0),u("Loading discover page..."),r("search"),yield new Promise(N=>setTimeout(N,300)),yield new Promise(N=>requestAnimationFrame(N)),yield new Promise(N=>requestAnimationFrame(N));try{yield ih('[data-tour="discover-vibes"]',15e3),console.log("Step 3 target is ready, resuming tour"),yield new Promise(N=>setTimeout(N,300)),h.current=2,d(!1),u(""),l(void 0),yield new Promise(N=>setTimeout(N,100)),i(!0)}catch(N){console.error("Step 3 target not ready, resuming anyway:",N),d(!1),u(""),l(void 0),yield new Promise(S=>setTimeout(S,100)),i(!0)}return}if(_===Vs.STEP_BEFORE&&w===2&&(console.log("Step 3 shown, immediately clearing stepIndex to enable buttons"),l(void 0),setTimeout(()=>{const N=document.querySelector('[data-test-id="button-primary"]');N&&(console.log("Button found, ensuring it is clickable"),N.style.pointerEvents="auto",N.style.cursor="pointer")},0)),_===Vs.STEP_AFTER&&w===2&&o===2&&(console.log("Step 3 completed, clearing stepIndex"),l(void 0)),_===Vs.STEP_BEFORE&&w===4&&(console.log("Step 5 shown, immediately clearing stepIndex to enable buttons"),l(void 0),setTimeout(()=>{const N=['[data-action="primary"]','[data-test-id="button-primary"]','button[class*="buttonNext"]','button:contains("Next")',".react-joyride__tooltip button:last-child",'.react-joyride__tooltip [role="button"]:last-child','button[aria-label*="Next"]'],S=new Set;for(const A of N)try{Array.from(document.querySelectorAll(A)).forEach(I=>{if(S.has(I))return;const O=I.textContent||"";(O.includes("Next")||O.includes("Step 5"))&&(console.log(`Step 5 button found with selector: ${A}`),S.add(I),I.style.pointerEvents="auto",I.style.cursor="pointer",I.style.zIndex="99999",I.style.position="relative",I.removeAttribute("disabled"),I instanceof HTMLButtonElement&&(I.disabled=!1,I.setAttribute("aria-disabled","false")))})}catch(R){}Array.from(document.querySelectorAll("button")).forEach(A=>{if(S.has(A))return;const R=A.textContent||"";R.includes("Next")&&R.includes("Step 5")&&(console.log("Step 5 button found by text search"),S.add(A),A.style.pointerEvents="auto",A.style.cursor="pointer",A.style.zIndex="99999",A.style.position="relative",A.disabled=!1,A.removeAttribute("disabled"),A.setAttribute("aria-disabled","false"))}),document.querySelectorAll('[class*="overlay"]').forEach(A=>{A.style.pointerEvents="none",A.style.zIndex="1"})},0),setTimeout(()=>{l(void 0),Array.from(document.querySelectorAll("button")).forEach(S=>{(S.textContent||"").includes("Next")&&(S.style.pointerEvents="auto !important",S.style.cursor="pointer !important",S.disabled=!1)})},100)),_===Vs.STEP_AFTER&&w===4&&o===4&&(console.log("Step 5 completed, clearing stepIndex"),l(void 0)),_===Vs.STEP_AFTER&&b===xn.NEXT&&w===4&&r){console.log("Step 5 completed: Pausing tour to load profile view"),i(!1),d(!0),u("Loading Profile page..."),r("profile");try{console.log("Step 5 completed: Waiting for profile view to load..."),yield new Promise(k=>setTimeout(k,500)),yield new Promise(k=>requestAnimationFrame(k)),yield new Promise(k=>requestAnimationFrame(k)),yield new Promise(k=>requestAnimationFrame(k));let N=!1,S=0;for(;!N&&S<100;){if(document.querySelector('[data-tour="profile-passport"]')){console.log("Profile view is ready, resuming tour"),N=!0;break}yield new Promise(C=>setTimeout(C,100)),S++}N||console.warn("Profile view loading timeout, proceeding anyway"),yield new Promise(k=>setTimeout(k,500)),d(!1),u(""),h.current=5,l(void 0),yield new Promise(k=>setTimeout(k,100)),i(!0),setTimeout(()=>{h.current=null},200)}catch(N){console.error("Profile view loading error:",N),d(!1),u(""),h.current=5,l(void 0),yield new Promise(S=>setTimeout(S,100)),i(!0),setTimeout(()=>{h.current=null},200)}return}if(_===Vs.STEP_AFTER&&b===xn.NEXT&&w===3&&r){console.log("Step 4 completed: Pausing tour to load chat view"),i(!1),d(!0),u("Loading Chat page..."),r("chat");try{console.log("Step 4 completed: Waiting for chat view to load..."),yield new Promise(k=>setTimeout(k,500)),yield new Promise(k=>requestAnimationFrame(k)),yield new Promise(k=>requestAnimationFrame(k)),yield new Promise(k=>requestAnimationFrame(k));let N=!1,S=0;for(;!N&&S<100;){if(Array.from(document.querySelectorAll("h1")).find(C=>{var A;return((A=C.textContent)==null?void 0:A.trim())==="Messages"})){console.log("Chat view is ready, resuming tour"),N=!0;break}yield new Promise(C=>setTimeout(C,100)),S++}N||console.warn("Chat view loading timeout, proceeding anyway"),yield new Promise(k=>setTimeout(k,500)),d(!1),u(""),h.current=4,l(void 0),yield new Promise(k=>setTimeout(k,100)),i(!0),setTimeout(()=>{l(void 0),h.current=null},200)}catch(N){console.error("Chat view loading error:",N),d(!1),u(""),h.current=4,l(void 0),yield new Promise(S=>setTimeout(S,100)),i(!0),setTimeout(()=>{l(void 0),h.current=null},200)}return}(x===Jr.FINISHED||x===Jr.SKIPPED)&&(i(!1),l(void 0),d(!1),u(""),n&&(yield Iu.completeTour(n.id)),t()),_===Vs.TARGET_NOT_FOUND&&console.error("Joyride: Target not found for step",w,g)});return c?s.jsx("div",{className:"fixed inset-0 z-[9999] bg-[#fcfcfc] flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#cc2486] mx-auto"}),s.jsx("p",{className:"text-lg font-medium text-gray-700",children:f})]})}):a?s.jsx(oxe,V(D({steps:m,run:a},typeof o=="number"?{stepIndex:o}:{}),{continuous:!0,disableScrolling:!1,showProgress:!0,showSkipButton:!0,spotlightClicks:!0,callback:v,disableOverlayClose:!1,styles:{options:{primaryColor:"#cc2486",textColor:"#0e0e0e",backgroundColor:"#fcfcfc",arrowColor:"#fcfcfc",overlayColor:"rgba(0, 0, 0, 0)",zIndex:1e4,width:"max(320px, min(393px, 90vw))"},tooltip:{borderRadius:12,padding:20,maxWidth:"393px",fontSize:"14px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},tooltipContainer:{textAlign:"left"},buttonNext:{backgroundColor:"#cc2486",borderRadius:8,fontSize:14,padding:"10px 20px",fontWeight:600,color:"#fff",border:"none",outline:"none",cursor:"pointer !important",pointerEvents:"auto !important",zIndex:10001},buttonBack:{color:"#5d646f",fontSize:14,marginRight:10,border:"none",outline:"none"},buttonSkip:{color:"#5d646f",fontSize:14,border:"none",outline:"none"},overlay:{mixBlendMode:"normal",backgroundColor:"rgba(0, 0, 0, 0)",cursor:"default",pointerEvents:"none"},spotlight:{borderRadius:12,boxShadow:"0 0 0 4px rgba(204, 36, 134, 0.6), 0 0 30px rgba(204, 36, 134, 0.4)",backgroundColor:"transparent"},spotlightLegacy:{borderRadius:12}},locale:{back:"Back",close:"Close",last:"Finish",next:"Next",skip:"Skip Tour"}})):null};var EA="Progress",CA=100,[cxe,uUe]=$s(EA),[dxe,uxe]=cxe(EA),MV=y.forwardRef((e,t)=>{const f=e,{__scopeProgress:r,value:n=null,max:a,getValueLabel:i=fxe}=f,o=ge(f,["__scopeProgress","value","max","getValueLabel"]);(a||a===0)&&!W4(a)&&console.error(hxe(`${a}`,"Progress"));const l=W4(a)?a:CA;n!==null&&!H4(n,l)&&console.error(mxe(`${n}`,"Progress"));const c=H4(n,l)?n:null,d=kw(c)?i(c,l):void 0;return s.jsx(dxe,{scope:r,value:c,max:l,children:s.jsx(Pt.div,V(D({"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":kw(c)?c:void 0,"aria-valuetext":d,role:"progressbar","data-state":$V(c,l),"data-value":c!=null?c:void 0,"data-max":l},o),{ref:t}))})});MV.displayName=EA;var DV="ProgressIndicator",IV=y.forwardRef((e,t)=>{var o;const i=e,{__scopeProgress:r}=i,n=ge(i,["__scopeProgress"]),a=uxe(DV,r);return s.jsx(Pt.div,V(D({"data-state":$V(a.value,a.max),"data-value":(o=a.value)!=null?o:void 0,"data-max":a.max},n),{ref:t}))});IV.displayName=DV;function fxe(e,t){return`${Math.round(e/t*100)}%`}function $V(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function kw(e){return typeof e=="number"}function W4(e){return kw(e)&&!isNaN(e)&&e>0}function H4(e,t){return kw(e)&&!isNaN(e)&&e<=t&&e>=0}function hxe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${CA}\`.`}function mxe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${CA} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var LV=MV,pxe=IV;const Jv=y.forwardRef((a,n)=>{var i=a,{className:e,value:t}=i,r=ge(i,["className","value"]);return s.jsx(LV,V(D({ref:n,className:Oe("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e)},r),{children:s.jsx(pxe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}))});Jv.displayName=LV.displayName;const gxe=({initialData:e,onNext:t,onSkip:r})=>{var N;const[n,a]=y.useState({username:(e==null?void 0:e.username)||"",location_city:(e==null?void 0:e.location_city)||"",birthday:(e==null?void 0:e.birthday)||"",gender:(e==null?void 0:e.gender)||"",bio:(e==null?void 0:e.bio)||"",avatar_url:(e==null?void 0:e.avatar_url)||""}),[i,o]=y.useState({}),[l,c]=y.useState(!1),[d,f]=y.useState(!1),u=y.useRef(null),{user:h}=ws(),{toast:m}=Er(),v=te.useRef(!1),g=te.useRef(!1);y.useEffect(()=>{E(void 0,null,function*(){var A;const k=!n.username,C=!!((A=h==null?void 0:h.user_metadata)!=null&&A.name);if(k&&v.current&&!g.current&&(v.current=!1),k&&C&&!v.current&&!g.current){g.current=!0;try{const{generateAvailableUsername:R}=yield Rr(()=>E(void 0,null,function*(){const{generateAvailableUsername:O}=yield Promise.resolve().then(()=>f4);return{generateAvailableUsername:O}}),void 0,import.meta.url),I=yield R(h.user_metadata.name);I&&(v.current=!0,a(O=>V(D({},O),{username:I})))}catch(R){console.error("Error generating suggested username:",R)}finally{g.current=!1}}})},[(N=h==null?void 0:h.user_metadata)==null?void 0:N.name]);const x=S=>E(void 0,null,function*(){var R;const k=(R=S.target.files)==null?void 0:R[0];if(!k||!h)return;if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(k.type)){m({title:"Invalid file type",description:"Please select a JPEG, PNG, or WebP image.",variant:"destructive"});return}const A=5*1024*1024;if(k.size>A){m({title:"File too large",description:"Please select an image smaller than 5MB.",variant:"destructive"});return}c(!0);try{const I=k.name.split(".").pop(),O=`${h.id}/${Date.now()}.${I}`,{data:z,error:M}=yield T.storage.from("profile-avatars").upload(O,k,{cacheControl:"3600",upsert:!1});if(M)throw M;const{data:B}=T.storage.from("profile-avatars").getPublicUrl(z.path);a(V(D({},n),{avatar_url:B.publicUrl})),m({title:"Photo uploaded",description:"Your profile photo has been uploaded successfully."})}catch(I){console.error("Upload error:",I),m({title:"Upload failed",description:"Failed to upload photo. Please try again.",variant:"destructive"})}finally{c(!1)}}),_=S=>E(void 0,null,function*(){if(!S.trim())return{available:!1,error:"Username is required"};try{const{checkUsernameAvailability:k}=yield Rr(()=>E(void 0,null,function*(){const{checkUsernameAvailability:A}=yield Promise.resolve().then(()=>f4);return{checkUsernameAvailability:A}}),void 0,import.meta.url);return yield k(S)}catch(k){console.error("Error checking username availability:",k);try{const{sanitizeUsername:C}=yield Rr(()=>E(void 0,null,function*(){const{sanitizeUsername:z}=yield Promise.resolve().then(()=>fS);return{sanitizeUsername:z}}),void 0,import.meta.url),A=C(S);if(!A)return{available:!1,error:"Invalid username after sanitization"};const{data:R,error:I}=yield T.from("users").select("username").eq("username",A).limit(1);return I&&I.code!=="PGRST116"?(console.warn("Error checking username:",I),{available:!0}):!R||R.length===0?{available:!0}:{available:!1,error:"This username is already taken"}}catch(C){return console.error("Fallback username check failed:",C),{available:!0}}}}),w=()=>E(void 0,null,function*(){const S=n.username.trim();if(!S){o(V(D({},i),{username:"Username is required"}));return}try{const{validateUsernameFormat:k,sanitizeUsername:C}=yield Rr(()=>E(void 0,null,function*(){const{validateUsernameFormat:O,sanitizeUsername:z}=yield Promise.resolve().then(()=>fS);return{validateUsernameFormat:O,sanitizeUsername:z}}),void 0,import.meta.url),A=C(S),R=k(A);if(!R.valid){o(V(D({},i),{username:R.error||"Invalid username format"}));return}f(!0);const I=yield _(A);f(!1),I.available?o(V(D({},i),{username:""})):o(V(D({},i),{username:I.error||"This username is already taken"}))}catch(k){console.error("Error validating username:",k),f(!1),o(V(D({},i),{username:"Error validating username"}))}}),b=S=>E(void 0,null,function*(){S.preventDefault();const k={};let C=n.username.trim();if(!C)k.username="Username is required";else try{const{validateUsernameFormat:A,sanitizeUsername:R}=yield Rr(()=>E(void 0,null,function*(){const{validateUsernameFormat:z,sanitizeUsername:M}=yield Promise.resolve().then(()=>fS);return{validateUsernameFormat:z,sanitizeUsername:M}}),void 0,import.meta.url),I=R(C),O=A(I);if(!O.valid)k.username=O.error||"Invalid username format";else{f(!0);const z=yield _(I);f(!1),z.available?C=I:k.username=z.error||"This username is already taken"}}catch(A){console.error("Error validating username:",A),k.username="Error validating username"}if(n.location_city.trim()||(k.location_city="City is required"),!n.birthday)k.birthday="Birthday is required";else{const A=new Date(n.birthday),R=new Date,I=R.getFullYear()-A.getFullYear(),O=R.getMonth()-A.getMonth();O<0||O===0&&R.getDate()<A.getDate()?I-1<13&&(k.birthday="You must be at least 13 years old"):I<13&&(k.birthday="You must be at least 13 years old")}if(n.bio.length>120&&(k.bio="Bio must be 120 characters or less"),Object.keys(k).length>0){o(k);return}t(V(D({},n),{username:C}))});return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Welcome to Synth!"}),s.jsx("p",{className:"text-muted-foreground",children:"Let's set up your profile to personalize your experience"})]}),s.jsxs("form",{onSubmit:b,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(qt,{htmlFor:"username",children:["Username ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",children:"@"}),s.jsx(Nr,{id:"username",placeholder:"username",value:n.username,onChange:S=>{let k=S.target.value.toLowerCase().trim();k=k.replace(/[^a-z0-9_.]/g,""),k=k.replace(/^[_.]+|[_.]+$/g,""),k=k.replace(/[_.]{2,}/g,C=>C[0]),a(V(D({},n),{username:k})),i.username&&o(V(D({},i),{username:""}))},onBlur:w,maxLength:30,className:`bg-white pl-8 ${i.username?"border-destructive":""}`})]}),d&&s.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:s.jsx(fr,{className:"w-4 h-4 animate-spin text-muted-foreground"})})]}),i.username&&s.jsx("p",{className:"text-sm text-destructive",children:i.username}),n.username&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Preview: ",s.jsxs("span",{className:"font-medium",children:["@",n.username]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your unique username (3-30 characters, lowercase letters, numbers, underscores, and periods only)"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{children:"Profile Photo (Optional)"}),s.jsxs("div",{className:"flex items-center gap-4",children:[n.avatar_url?s.jsx("img",{src:n.avatar_url,alt:"Profile",className:"w-20 h-20 rounded-full object-cover"}):s.jsx("div",{className:"w-20 h-20 rounded-full bg-muted flex items-center justify-center",children:s.jsx(Y_,{className:"w-8 h-8 text-muted-foreground"})}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("input",{ref:u,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:x,className:"hidden"}),s.jsx(ce,{type:"button",variant:"outline",onClick:()=>{var S;return(S=u.current)==null?void 0:S.click()},disabled:l,className:"w-full",children:l?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Av,{className:"w-4 h-4 mr-2"}),"Upload Photo"]})}),s.jsx(Nr,{type:"url",placeholder:"Or paste image URL",value:n.avatar_url,onChange:S=>a(V(D({},n),{avatar_url:S.target.value})),disabled:l,className:"bg-white"})]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"You can add a photo now or skip and add it later"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(qt,{htmlFor:"location_city",children:["City ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsx(Nr,{id:"location_city",placeholder:"e.g., Los Angeles, CA",value:n.location_city,onChange:S=>a(V(D({},n),{location_city:S.target.value})),className:`bg-white ${i.location_city?"border-destructive":""}`}),i.location_city&&s.jsx("p",{className:"text-sm text-destructive",children:i.location_city}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"We'll show you events happening near you"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(qt,{htmlFor:"birthday",children:["Birthday ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsx(Nr,{id:"birthday",type:"date",value:n.birthday,onChange:S=>a(V(D({},n),{birthday:S.target.value})),className:`bg-white ${i.birthday?"border-destructive":""}`}),i.birthday&&s.jsx("p",{className:"text-sm text-destructive",children:i.birthday}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your age will be displayed to other users, but not your exact birthday"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"gender",children:"Gender (Optional)"}),s.jsxs(aa,{value:n.gender,onValueChange:S=>a(V(D({},n),{gender:S})),children:[s.jsx(Gs,{className:"bg-white",children:s.jsx(ia,{placeholder:"Select your gender"})}),s.jsxs(Ys,{className:"bg-white",children:[s.jsx(Bt,{value:"male",children:"Male"}),s.jsx(Bt,{value:"female",children:"Female"}),s.jsx(Bt,{value:"non-binary",children:"Non-binary"}),s.jsx(Bt,{value:"prefer-not-to-say",children:"Prefer not to say"}),s.jsx(Bt,{value:"other",children:"Other"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(qt,{htmlFor:"bio",children:"Bio (Optional)"}),s.jsx(_s,{id:"bio",placeholder:"Tell us a bit about yourself...",value:n.bio,onChange:S=>a(V(D({},n),{bio:S.target.value})),maxLength:120,className:`bg-white ${i.bio?"border-destructive":""}`}),s.jsxs("p",{className:"text-xs text-muted-foreground text-right",children:[n.bio.length,"/120 characters"]}),i.bio&&s.jsx("p",{className:"text-sm text-destructive",children:i.bio})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(ce,{type:"button",variant:"ghost",onClick:r,className:"flex-1",children:"Skip"}),s.jsx(ce,{type:"submit",className:"flex-1",children:"Continue"})]})]})]})};var G4=1,vxe=.9,yxe=.8,xxe=.17,vS=.1,yS=.999,_xe=.9999,wxe=.99,bxe=/[\\\/_+.#"@\[\(\{&]/,jxe=/[\\\/_+.#"@\[\(\{&]/g,Nxe=/[\s-]/,FV=/[\s-]/g;function Q2(e,t,r,n,a,i,o){if(i===t.length)return a===e.length?G4:wxe;var l=`${a},${i}`;if(o[l]!==void 0)return o[l];for(var c=n.charAt(i),d=r.indexOf(c,a),f=0,u,h,m,v;d>=0;)u=Q2(e,t,r,n,d+1,i+1,o),u>f&&(d===a?u*=G4:bxe.test(e.charAt(d-1))?(u*=yxe,m=e.slice(a,d-1).match(jxe),m&&a>0&&(u*=Math.pow(yS,m.length))):Nxe.test(e.charAt(d-1))?(u*=vxe,v=e.slice(a,d-1).match(FV),v&&a>0&&(u*=Math.pow(yS,v.length))):(u*=xxe,a>0&&(u*=Math.pow(yS,d-a))),e.charAt(d)!==t.charAt(i)&&(u*=_xe)),(u<vS&&r.charAt(d-1)===n.charAt(i+1)||n.charAt(i+1)===n.charAt(i)&&r.charAt(d-1)!==n.charAt(i))&&(h=Q2(e,t,r,n,d+1,i+2,o),h*vS>u&&(u=h*vS)),u>f&&(f=u),d=r.indexOf(c,d+1);return o[l]=f,f}function Y4(e){return e.toLowerCase().replace(FV," ")}function Sxe(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,Q2(e,t,Y4(e),Y4(t),0,0,{})}var jg='[cmdk-group=""]',xS='[cmdk-group-items=""]',kxe='[cmdk-group-heading=""]',zV='[cmdk-item=""]',K4=`${zV}:not([aria-disabled="true"])`,eE="cmdk-item-select",vh="data-value",Exe=(e,t,r)=>Sxe(e,t,r),BV=y.createContext(void 0),b0=()=>y.useContext(BV),UV=y.createContext(void 0),PA=()=>y.useContext(UV),qV=y.createContext(void 0),VV=y.forwardRef((e,t)=>{let r=yh(()=>{var X,se;return{search:"",value:(se=(X=e.value)!=null?X:e.defaultValue)!=null?se:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=yh(()=>new Set),a=yh(()=>new Map),i=yh(()=>new Map),o=yh(()=>new Set),l=WV(e),Y=e,{label:c,children:d,value:f,onValueChange:u,filter:h,shouldFilter:m,loop:v,disablePointerSelection:g=!1,vimBindings:x=!0}=Y,_=ge(Y,["label","children","value","onValueChange","filter","shouldFilter","loop","disablePointerSelection","vimBindings"]),w=Os(),b=Os(),N=Os(),S=y.useRef(null),k=Lxe();_f(()=>{if(f!==void 0){let X=f.trim();r.current.value=X,C.emit()}},[f]),_f(()=>{k(6,M)},[]);let C=y.useMemo(()=>({subscribe:X=>(o.current.add(X),()=>o.current.delete(X)),snapshot:()=>r.current,setState:(X,se,de)=>{var _e,xe,Q,oe;if(!Object.is(r.current[X],se)){if(r.current[X]=se,X==="search")z(),I(),k(1,O);else if(X==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let ie=document.getElementById(N);ie?ie.focus():(_e=document.getElementById(w))==null||_e.focus()}if(k(7,()=>{var ie;r.current.selectedItemId=(ie=B())==null?void 0:ie.id,C.emit()}),de||k(5,M),((xe=l.current)==null?void 0:xe.value)!==void 0){let ie=se!=null?se:"";(oe=(Q=l.current).onValueChange)==null||oe.call(Q,ie);return}}C.emit()}},emit:()=>{o.current.forEach(X=>X())}}),[]),A=y.useMemo(()=>({value:(X,se,de)=>{var _e;se!==((_e=i.current.get(X))==null?void 0:_e.value)&&(i.current.set(X,{value:se,keywords:de}),r.current.filtered.items.set(X,R(se,de)),k(2,()=>{I(),C.emit()}))},item:(X,se)=>(n.current.add(X),se&&(a.current.has(se)?a.current.get(se).add(X):a.current.set(se,new Set([X]))),k(3,()=>{z(),I(),r.current.value||O(),C.emit()}),()=>{i.current.delete(X),n.current.delete(X),r.current.filtered.items.delete(X);let de=B();k(4,()=>{z(),(de==null?void 0:de.getAttribute("id"))===X&&O(),C.emit()})}),group:X=>(a.current.has(X)||a.current.set(X,new Set),()=>{i.current.delete(X),a.current.delete(X)}),filter:()=>l.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:w,inputId:N,labelId:b,listInnerRef:S}),[]);function R(X,se){var de,_e;let xe=(_e=(de=l.current)==null?void 0:de.filter)!=null?_e:Exe;return X?xe(X,r.current.search,se):0}function I(){if(!r.current.search||l.current.shouldFilter===!1)return;let X=r.current.filtered.items,se=[];r.current.filtered.groups.forEach(_e=>{let xe=a.current.get(_e),Q=0;xe.forEach(oe=>{let ie=X.get(oe);Q=Math.max(ie,Q)}),se.push([_e,Q])});let de=S.current;F().sort((_e,xe)=>{var Q,oe;let ie=_e.getAttribute("id"),ee=xe.getAttribute("id");return((Q=X.get(ee))!=null?Q:0)-((oe=X.get(ie))!=null?oe:0)}).forEach(_e=>{let xe=_e.closest(xS);xe?xe.appendChild(_e.parentElement===xe?_e:_e.closest(`${xS} > *`)):de.appendChild(_e.parentElement===de?_e:_e.closest(`${xS} > *`))}),se.sort((_e,xe)=>xe[1]-_e[1]).forEach(_e=>{var xe;let Q=(xe=S.current)==null?void 0:xe.querySelector(`${jg}[${vh}="${encodeURIComponent(_e[0])}"]`);Q==null||Q.parentElement.appendChild(Q)})}function O(){let X=F().find(de=>de.getAttribute("aria-disabled")!=="true"),se=X==null?void 0:X.getAttribute(vh);C.setState("value",se||void 0)}function z(){var X,se,de,_e;if(!r.current.search||l.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let xe=0;for(let Q of n.current){let oe=(se=(X=i.current.get(Q))==null?void 0:X.value)!=null?se:"",ie=(_e=(de=i.current.get(Q))==null?void 0:de.keywords)!=null?_e:[],ee=R(oe,ie);r.current.filtered.items.set(Q,ee),ee>0&&xe++}for(let[Q,oe]of a.current)for(let ie of oe)if(r.current.filtered.items.get(ie)>0){r.current.filtered.groups.add(Q);break}r.current.filtered.count=xe}function M(){var X,se,de;let _e=B();_e&&(((X=_e.parentElement)==null?void 0:X.firstChild)===_e&&((de=(se=_e.closest(jg))==null?void 0:se.querySelector(kxe))==null||de.scrollIntoView({block:"nearest"})),_e.scrollIntoView({block:"nearest"}))}function B(){var X;return(X=S.current)==null?void 0:X.querySelector(`${zV}[aria-selected="true"]`)}function F(){var X;return Array.from(((X=S.current)==null?void 0:X.querySelectorAll(K4))||[])}function U(X){let se=F()[X];se&&C.setState("value",se.getAttribute(vh))}function H(X){var se;let de=B(),_e=F(),xe=_e.findIndex(oe=>oe===de),Q=_e[xe+X];(se=l.current)!=null&&se.loop&&(Q=xe+X<0?_e[_e.length-1]:xe+X===_e.length?_e[0]:_e[xe+X]),Q&&C.setState("value",Q.getAttribute(vh))}function q(X){let se=B(),de=se==null?void 0:se.closest(jg),_e;for(;de&&!_e;)de=X>0?Ixe(de,jg):$xe(de,jg),_e=de==null?void 0:de.querySelector(K4);_e?C.setState("value",_e.getAttribute(vh)):H(X)}let K=()=>U(F().length-1),Z=X=>{X.preventDefault(),X.metaKey?K():X.altKey?q(1):H(1)},ne=X=>{X.preventDefault(),X.metaKey?U(0):X.altKey?q(-1):H(-1)};return y.createElement(Pt.div,V(D({ref:t,tabIndex:-1},_),{"cmdk-root":"",onKeyDown:X=>{var se;(se=_.onKeyDown)==null||se.call(_,X);let de=X.nativeEvent.isComposing||X.keyCode===229;if(!(X.defaultPrevented||de))switch(X.key){case"n":case"j":{x&&X.ctrlKey&&Z(X);break}case"ArrowDown":{Z(X);break}case"p":case"k":{x&&X.ctrlKey&&ne(X);break}case"ArrowUp":{ne(X);break}case"Home":{X.preventDefault(),U(0);break}case"End":{X.preventDefault(),K();break}case"Enter":{X.preventDefault();let _e=B();if(_e){let xe=new Event(eE);_e.dispatchEvent(xe)}}}}}),y.createElement("label",{"cmdk-label":"",htmlFor:A.inputId,id:A.labelId,style:zxe},c),J1(e,X=>y.createElement(UV.Provider,{value:C},y.createElement(BV.Provider,{value:A},X))))}),Cxe=y.forwardRef((e,t)=>{var r,n;let a=Os(),i=y.useRef(null),o=y.useContext(qV),l=b0(),c=WV(e),d=(n=(r=c.current)==null?void 0:r.forceMount)!=null?n:o==null?void 0:o.forceMount;_f(()=>{if(!d)return l.item(a,o==null?void 0:o.id)},[d]);let f=HV(a,i,[e.value,e.children,i],e.keywords),u=PA(),h=Yd(C=>C.value&&C.value===f.current),m=Yd(C=>d||l.filter()===!1?!0:C.search?C.filtered.items.get(a)>0:!0);y.useEffect(()=>{let C=i.current;if(!(!C||e.disabled))return C.addEventListener(eE,v),()=>C.removeEventListener(eE,v)},[m,e.onSelect,e.disabled]);function v(){var C,A;g(),(A=(C=c.current).onSelect)==null||A.call(C,f.current)}function g(){u.setState("value",f.current,!0)}if(!m)return null;let k=e,{disabled:x,value:_,onSelect:w,forceMount:b,keywords:N}=k,S=ge(k,["disabled","value","onSelect","forceMount","keywords"]);return y.createElement(Pt.div,V(D({ref:Oc(i,t)},S),{id:a,"cmdk-item":"",role:"option","aria-disabled":!!x,"aria-selected":!!h,"data-disabled":!!x,"data-selected":!!h,onPointerMove:x||l.getDisablePointerSelection()?void 0:g,onClick:x?void 0:v}),e.children)}),Pxe=y.forwardRef((e,t)=>{let m=e,{heading:r,children:n,forceMount:a}=m,i=ge(m,["heading","children","forceMount"]),o=Os(),l=y.useRef(null),c=y.useRef(null),d=Os(),f=b0(),u=Yd(v=>a||f.filter()===!1?!0:v.search?v.filtered.groups.has(o):!0);_f(()=>f.group(o),[]),HV(o,l,[e.value,e.heading,c]);let h=y.useMemo(()=>({id:o,forceMount:a}),[a]);return y.createElement(Pt.div,V(D({ref:Oc(l,t)},i),{"cmdk-group":"",role:"presentation",hidden:u?void 0:!0}),r&&y.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:d},r),J1(e,v=>y.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?d:void 0},y.createElement(qV.Provider,{value:h},v))))}),Txe=y.forwardRef((e,t)=>{let o=e,{alwaysRender:r}=o,n=ge(o,["alwaysRender"]),a=y.useRef(null),i=Yd(l=>!l.search);return!r&&!i?null:y.createElement(Pt.div,V(D({ref:Oc(a,t)},n),{"cmdk-separator":"",role:"separator"}))}),Axe=y.forwardRef((e,t)=>{let d=e,{onValueChange:r}=d,n=ge(d,["onValueChange"]),a=e.value!=null,i=PA(),o=Yd(f=>f.search),l=Yd(f=>f.selectedItemId),c=b0();return y.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),y.createElement(Pt.input,V(D({ref:t},n),{"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:a?e.value:o,onChange:f=>{a||i.setState("search",f.target.value),r==null||r(f.target.value)}}))}),Rxe=y.forwardRef((e,t)=>{let d=e,{children:r,label:n="Suggestions"}=d,a=ge(d,["children","label"]),i=y.useRef(null),o=y.useRef(null),l=Yd(f=>f.selectedItemId),c=b0();return y.useEffect(()=>{if(o.current&&i.current){let f=o.current,u=i.current,h,m=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let v=f.offsetHeight;u.style.setProperty("--cmdk-list-height",v.toFixed(1)+"px")})});return m.observe(f),()=>{cancelAnimationFrame(h),m.unobserve(f)}}},[]),y.createElement(Pt.div,V(D({ref:Oc(i,t)},a),{"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":n,id:c.listId}),J1(e,f=>y.createElement("div",{ref:Oc(o,c.listInnerRef),"cmdk-list-sizer":""},f)))}),Oxe=y.forwardRef((e,t)=>{let c=e,{open:r,onOpenChange:n,overlayClassName:a,contentClassName:i,container:o}=c,l=ge(c,["open","onOpenChange","overlayClassName","contentClassName","container"]);return y.createElement(p1,{open:r,onOpenChange:n},y.createElement(g1,{container:o},y.createElement(bp,{"cmdk-overlay":"",className:a}),y.createElement(jp,{"aria-label":e.label,"cmdk-dialog":"",className:i},y.createElement(VV,D({ref:t},l)))))}),Mxe=y.forwardRef((e,t)=>Yd(r=>r.filtered.count===0)?y.createElement(Pt.div,V(D({ref:t},e),{"cmdk-empty":"",role:"presentation"})):null),Dxe=y.forwardRef((e,t)=>{let o=e,{progress:r,children:n,label:a="Loading..."}=o,i=ge(o,["progress","children","label"]);return y.createElement(Pt.div,V(D({ref:t},i),{"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a}),J1(e,l=>y.createElement("div",{"aria-hidden":!0},l)))}),bi=Object.assign(VV,{List:Rxe,Item:Cxe,Input:Axe,Group:Pxe,Separator:Txe,Dialog:Oxe,Empty:Mxe,Loading:Dxe});function Ixe(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function $xe(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function WV(e){let t=y.useRef(e);return _f(()=>{t.current=e}),t}var _f=typeof window=="undefined"?y.useEffect:y.useLayoutEffect;function yh(e){let t=y.useRef();return t.current===void 0&&(t.current=e()),t}function Yd(e){let t=PA(),r=()=>e(t.snapshot());return y.useSyncExternalStore(t.subscribe,r,r)}function HV(e,t,r,n=[]){let a=y.useRef(),i=b0();return _f(()=>{var o;let l=(()=>{var d;for(let f of r){if(typeof f=="string")return f.trim();if(typeof f=="object"&&"current"in f)return f.current?(d=f.current.textContent)==null?void 0:d.trim():a.current}})(),c=n.map(d=>d.trim());i.value(e,l,c),(o=t.current)==null||o.setAttribute(vh,l),a.current=l}),a}var Lxe=()=>{let[e,t]=y.useState(),r=yh(()=>new Map);return _f(()=>{r.current.forEach(n=>n()),r.current=new Map},[e]),(n,a)=>{r.current.set(n,a),t({})}};function Fxe(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function J1({asChild:e,children:t},r){return e&&y.isValidElement(t)?y.cloneElement(Fxe(t),{ref:t.ref},r(t.props.children)):r(t)}var zxe={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const GV=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(bi,D({ref:r,className:Oe("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e)},t))});GV.displayName=bi.displayName;const YV=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[s.jsx(Ho,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),s.jsx(bi.Input,D({ref:r,className:Oe("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e)},t))]})});YV.displayName=bi.Input.displayName;const Bxe=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(bi.List,D({ref:r,className:Oe("max-h-[300px] overflow-y-auto overflow-x-hidden",e)},t))});Bxe.displayName=bi.List.displayName;const KV=y.forwardRef((e,t)=>s.jsx(bi.Empty,D({ref:t,className:"py-6 text-center text-sm"},e)));KV.displayName=bi.Empty.displayName;const ZV=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(bi.Group,D({ref:r,className:Oe("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e)},t))});ZV.displayName=bi.Group.displayName;const Uxe=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(bi.Separator,D({ref:r,className:Oe("-mx-1 h-px bg-border",e)},t))});Uxe.displayName=bi.Separator.displayName;const XV=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(bi.Item,D({ref:r,className:Oe("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e)},t))});XV.displayName=bi.Item.displayName;const qxe=({onNext:e,onBack:t,onSkip:r})=>{const[n,a]=y.useState([]),[i,o]=y.useState([]),[l,c]=y.useState(""),[d,f]=y.useState(""),[u,h]=y.useState(!1),[m,v]=y.useState({}),[g,x]=y.useState([]),[_,w]=y.useState(!1),[b,N]=y.useState(!1),S=y.useRef(null),k=M=>{if(n.length>=7){v(V(D({},m),{genres:"Maximum 7 genres allowed"}));return}n.includes(M)||(a([...n,M]),v(V(D({},m),{genres:""}))),h(!1)},C=()=>{const M=l.trim();if(M){if(n.length>=7){v(V(D({},m),{genres:"Maximum 7 genres allowed"}));return}n.includes(M)||(a([...n,M]),c(""),v(V(D({},m),{genres:""})))}},A=M=>{a(n.filter(B=>B!==M)),v(V(D({},m),{genres:""}))};y.useEffect(()=>{if(d.trim().length<2){x([]),N(!1);return}return S.current&&clearTimeout(S.current),S.current=setTimeout(()=>E(void 0,null,function*(){w(!0);try{const M=yield r0.searchArtistsTrigram(d.trim(),5);x(M),N(M.length>0)}catch(M){console.error("Error searching artists:",M),x([])}finally{w(!1)}}),300),()=>{S.current&&clearTimeout(S.current)}},[d]);const R=M=>{if(i.length>=15){v(V(D({},m),{artists:"Maximum 15 artists allowed"}));return}i.includes(M.name)||(o([...i,M.name]),f(""),x([]),N(!1),v(V(D({},m),{artists:""})))},I=()=>{const M=d.trim();if(M){if(i.length>=15){v(V(D({},m),{artists:"Maximum 15 artists allowed"}));return}i.includes(M)||(o([...i,M]),f(""),x([]),N(!1),v(V(D({},m),{artists:""})))}},O=M=>{o(i.filter(B=>B!==M)),v(V(D({},m),{artists:""}))},z=()=>{const M={};if(n.length<3&&(M.genres="Please select at least 3 genres"),i.length<3&&(M.artists="Please add at least 3 artists"),Object.keys(M).length>0){v(M);return}e({genres:n,artists:i})};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Tell us about your music taste"}),s.jsx("p",{className:"text-muted-foreground",children:"This helps us recommend events and connect you with like-minded people"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(qt,{className:"flex items-center gap-2",children:[s.jsx(Ft,{className:"w-4 h-4"}),"Favorite Genres",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[n.length,"/7 (min 3)"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(vc,{open:u,onOpenChange:h,children:[s.jsx(yc,{asChild:!0,children:s.jsx(ce,{variant:"outline",className:"w-full justify-start bg-white",children:"Select genres..."})}),s.jsx(kl,{className:"w-full p-0 bg-white",align:"start",children:s.jsxs(GV,{className:"bg-white",children:[s.jsx(YV,{placeholder:"Search genres...",className:"bg-white"}),s.jsx(KV,{children:"No genre found."}),s.jsx(ZV,{className:"max-h-64 overflow-auto bg-white",children:W7.filter(M=>!n.includes(M)).map(M=>s.jsx(XV,{onSelect:()=>k(M),className:"hover:bg-gray-100",children:M},M))})]})})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Nr,{placeholder:"Or type a custom genre...",value:l,onChange:M=>c(M.target.value),onKeyDown:M=>{M.key==="Enter"&&(M.preventDefault(),C())},className:"bg-white"}),s.jsx(ce,{type:"button",onClick:C,variant:"secondary",children:"Add"})]})]}),n.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:n.map((M,B)=>s.jsxs(et,{variant:B<3?"default":"secondary",className:"px-3 py-1",children:[M,s.jsx("button",{type:"button",onClick:()=>A(M),className:"ml-2 hover:text-destructive",children:s.jsx(Yr,{className:"w-3 h-3"})})]},M))}),n.length>0&&s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your top 3 genres get higher weight in recommendations"}),m.genres&&s.jsx("p",{className:"text-sm text-destructive",children:m.genres})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(qt,{className:"flex items-center gap-2",children:[s.jsx(Is,{className:"w-4 h-4"}),"Favorite Artists",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[i.length,"/15 (min 3)"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(Nr,{placeholder:"Type an artist name...",value:d,onChange:M=>f(M.target.value),onKeyDown:M=>{M.key==="Enter"&&(M.preventDefault(),g.length>0&&b?R(g[0]):I())},onFocus:()=>{g.length>0&&d.trim().length>=2&&N(!0)},onBlur:()=>{setTimeout(()=>N(!1),200)},className:"bg-white"}),_&&s.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:s.jsx(fr,{className:"w-4 h-4 animate-spin text-muted-foreground"})})]}),s.jsx(ce,{type:"button",onClick:I,variant:"secondary",children:"Add"})]}),b&&g.length>0&&s.jsx("div",{className:"border rounded-md bg-white shadow-md max-h-48 overflow-auto z-10",onMouseDown:M=>M.preventDefault(),children:g.map(M=>s.jsxs("button",{type:"button",onClick:()=>R(M),className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",children:[s.jsx("span",{className:"flex-1",children:M.name}),M.genres&&M.genres.length>0&&s.jsx("span",{className:"text-xs text-muted-foreground",children:M.genres[0]})]},M.id))})]}),i.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:i.map((M,B)=>s.jsxs(et,{variant:B<3?"default":"secondary",className:"px-3 py-1",children:[M,s.jsx("button",{type:"button",onClick:()=>O(M),className:"ml-2 hover:text-destructive",children:s.jsx(Yr,{className:"w-3 h-3"})})]},M))}),i.length>0&&s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your top 3 artists get higher weight in recommendations"}),m.artists&&s.jsx("p",{className:"text-sm text-destructive",children:m.artists})]}),s.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg p-4 text-sm",children:s.jsxs("p",{className:"text-blue-700 dark:text-blue-300",children:[" ",s.jsx("strong",{children:"Tip:"})," You can also connect your Spotify account later to automatically sync your music preferences!"]})}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(ce,{type:"button",variant:"ghost",onClick:t,className:"flex-1",children:"Back"}),s.jsx(ce,{type:"button",variant:"outline",onClick:r,className:"flex-1",children:"Skip"}),s.jsx(ce,{onClick:z,className:"flex-1",children:"Complete Setup"})]})]})};var JV="AlertDialog",[Vxe,fUe]=$s(JV,[J9]),Wc=J9(),QV=e=>{const a=e,{__scopeAlertDialog:t}=a,r=ge(a,["__scopeAlertDialog"]),n=Wc(t);return s.jsx(p1,V(D(D({},n),r),{modal:!0}))};QV.displayName=JV;var Wxe="AlertDialogTrigger",Hxe=y.forwardRef((e,t)=>{const i=e,{__scopeAlertDialog:r}=i,n=ge(i,["__scopeAlertDialog"]),a=Wc(r);return s.jsx(ple,V(D(D({},a),n),{ref:t}))});Hxe.displayName=Wxe;var Gxe="AlertDialogPortal",eW=e=>{const a=e,{__scopeAlertDialog:t}=a,r=ge(a,["__scopeAlertDialog"]),n=Wc(t);return s.jsx(g1,D(D({},n),r))};eW.displayName=Gxe;var Yxe="AlertDialogOverlay",tW=y.forwardRef((e,t)=>{const i=e,{__scopeAlertDialog:r}=i,n=ge(i,["__scopeAlertDialog"]),a=Wc(r);return s.jsx(bp,V(D(D({},a),n),{ref:t}))});tW.displayName=Yxe;var rm="AlertDialogContent",[Kxe,Zxe]=Vxe(rm),Xxe=bF("AlertDialogContent"),rW=y.forwardRef((e,t)=>{const d=e,{__scopeAlertDialog:r,children:n}=d,a=ge(d,["__scopeAlertDialog","children"]),i=Wc(r),o=y.useRef(null),l=mr(t,o),c=y.useRef(null);return s.jsx(ule,{contentName:rm,titleName:nW,docsSlug:"alert-dialog",children:s.jsx(Kxe,{scope:r,cancelRef:c,children:s.jsxs(jp,V(D(D({role:"alertdialog"},i),a),{ref:l,onOpenAutoFocus:mt(a.onOpenAutoFocus,f=>{var u;f.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:f=>f.preventDefault(),onInteractOutside:f=>f.preventDefault(),children:[s.jsx(Xxe,{children:n}),s.jsx(Qxe,{contentRef:o})]}))})})});rW.displayName=rm;var nW="AlertDialogTitle",sW=y.forwardRef((e,t)=>{const i=e,{__scopeAlertDialog:r}=i,n=ge(i,["__scopeAlertDialog"]),a=Wc(r);return s.jsx(Qy,V(D(D({},a),n),{ref:t}))});sW.displayName=nW;var aW="AlertDialogDescription",iW=y.forwardRef((e,t)=>{const i=e,{__scopeAlertDialog:r}=i,n=ge(i,["__scopeAlertDialog"]),a=Wc(r);return s.jsx(e0,V(D(D({},a),n),{ref:t}))});iW.displayName=aW;var Jxe="AlertDialogAction",oW=y.forwardRef((e,t)=>{const i=e,{__scopeAlertDialog:r}=i,n=ge(i,["__scopeAlertDialog"]),a=Wc(r);return s.jsx(v1,V(D(D({},a),n),{ref:t}))});oW.displayName=Jxe;var lW="AlertDialogCancel",cW=y.forwardRef((e,t)=>{const l=e,{__scopeAlertDialog:r}=l,n=ge(l,["__scopeAlertDialog"]),{cancelRef:a}=Zxe(lW,r),i=Wc(r),o=mr(t,a);return s.jsx(v1,V(D(D({},i),n),{ref:o}))});cW.displayName=lW;var Qxe=({contentRef:e})=>{const t=`\`${rm}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${rm}\` by passing a \`${aW}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${rm}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return y.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},e_e=QV,t_e=eW,dW=tW,uW=rW,fW=oW,hW=cW,mW=sW,pW=iW;const r_e=e_e,n_e=t_e,gW=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(dW,V(D({className:Oe("fixed inset-0 z-[9999] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),style:D({backgroundColor:"var(--overlay-50, rgba(14, 14, 14, 0.5))"},t.style)},t),{ref:r}))});gW.displayName=dW.displayName;const vW=y.forwardRef((a,n)=>{var i=a,{className:e,style:t}=i,r=ge(i,["className","style"]);return s.jsxs(n_e,{children:[s.jsx(gW,{}),s.jsx(uW,D({ref:n,className:Oe("fixed z-[9999] grid gap-4 border bg-background shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg",e),style:D({left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"calc(100vw - 40px)",maxWidth:"var(--size-popup-width, calc(100vw - 40px))",maxHeight:"calc(100vh - 40px)",backgroundColor:"var(--neutral-50)",border:"1px solid var(--neutral-200)",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 4px 12px 0 var(--shadow-color)",padding:"var(--spacing-grouped, 24px)"},t)},r))]})});vW.displayName=uW.displayName;const yW=r=>{var n=r,{className:e}=n,t=ge(n,["className"]);return s.jsx("div",D({className:Oe("flex flex-col space-y-2 text-center sm:text-left",e)},t))};yW.displayName="AlertDialogHeader";const xW=r=>{var n=r,{className:e}=n,t=ge(n,["className"]);return s.jsx("div",D({className:Oe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e)},t))};xW.displayName="AlertDialogFooter";const _W=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(mW,D({ref:r,className:Oe("text-lg font-semibold",e)},t))});_W.displayName=mW.displayName;const wW=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(pW,D({ref:r,className:Oe("text-sm text-muted-foreground",e)},t))});wW.displayName=pW.displayName;const bW=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(fW,D({ref:r,className:Oe(dT(),e)},t))});bW.displayName=fW.displayName;const jW=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsx(hW,D({ref:r,className:Oe(dT({variant:"outline"}),"mt-2 sm:mt-0",e)},t))});jW.displayName=hW.displayName;const s_e=({open:e,onOpenChange:t,onConfirmSkip:r})=>s.jsx(r_e,{open:e,onOpenChange:t,children:s.jsxs(vW,{children:[s.jsxs(yW,{children:[s.jsx(_W,{children:"Skip profile setup?"}),s.jsxs(wW,{className:"space-y-3",children:[s.jsx("p",{children:"Completing your profile helps us personalize your experience:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[s.jsx("li",{children:"Discover events that match your music taste"}),s.jsx("li",{children:"Connect with people who share your interests"}),s.jsx("li",{children:"Get better recommendations based on your preferences"})]}),s.jsx("p",{className:"text-sm font-medium",children:"You can always complete this later from your profile settings."})]})]}),s.jsxs(xW,{children:[s.jsx(jW,{children:"Continue Setup"}),s.jsx(bW,{onClick:r,children:"Skip for Now"})]})]})}),a_e=({onComplete:e})=>{const[t,r]=y.useState(1),[n,a]=y.useState(!1),[i,o]=y.useState(!1),{user:l}=ws(),{toast:c}=Er(),[d,f]=y.useState({}),u=2,h=t/u*100;go("view",`onboarding_step_${t}`,{step:t===1?"profile_setup":"music_tags",step_number:t,total_steps:u}),useEffect(()=>{t===u&&Zt.formSubmit("onboarding","onboarding_complete",!0,{completed:!0,total_steps:u})},[t,u]);const m=_=>E(void 0,null,function*(){if(l){o(!0);try{(yield Iu.saveProfileSetup(l.id,_))?(f(_),r(2)):c({title:"Error",description:"Failed to save profile data. Please try again.",variant:"destructive"})}catch(w){const b=(w==null?void 0:w.message)||"An error occurred. Please try again.";c({title:"Error",description:b,variant:"destructive"})}finally{o(!1)}}}),v=_=>E(void 0,null,function*(){if(l){o(!0);try{const w=[];for(const N of _.artists)try{const S=yield r0.searchArtistsTrigram(N,1);if(S.length>0&&S[0].name.toLowerCase()===N.toLowerCase())w.push({name:S[0].name,id:S[0].id});else{w.push({name:N});try{const{MissingEntityRequestService:k}=yield Rr(()=>E(void 0,null,function*(){const{MissingEntityRequestService:C}=yield import("./missingEntityRequestService-DnUo_jW_.js");return{MissingEntityRequestService:C}}),[],import.meta.url);yield k.submitRequest({entity_type:"artist",entity_name:N})}catch(k){console.warn("Error submitting missing artist request:",k)}}}catch(S){console.warn(`Error searching for artist "${N}":`,S),w.push({name:N})}if(!(yield Iu.saveMusicPreferences(l.id,_.genres,w))){c({title:"Error",description:"Failed to save music preferences.",variant:"destructive"}),o(!1);return}yield Iu.completeOnboarding(l.id),c({title:"Welcome to Synth!",description:"Your profile is all set up. Let's explore the app!"}),e()}catch(w){console.error("Error in handleMusicTags:",w),c({title:"Error",description:"An error occurred. Please try again.",variant:"destructive"})}finally{o(!1)}}}),g=()=>{a(!0)},x=()=>E(void 0,null,function*(){if(l){o(!0);try{yield Iu.skipOnboarding(l.id),c({title:"Onboarding Skipped",description:"You can complete your profile anytime from settings."}),e()}catch(_){c({title:"Error",description:"An error occurred. Please try again.",variant:"destructive"})}finally{o(!1),a(!1)}}});return s.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-primary/10 to-accent/10",children:[s.jsx(Ze,{className:"w-full max-w-2xl",children:s.jsxs(tt,{className:"p-6 md:p-8",children:[s.jsxs("div",{className:"mb-8 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Step ",t," of ",u]}),s.jsxs("span",{children:[Math.round(h),"% complete"]})]}),s.jsx(Jv,{value:h})]}),i?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto"}),s.jsx("p",{className:"text-muted-foreground",children:"Saving your information..."})]})}):s.jsxs(s.Fragment,{children:[t===1&&s.jsx(gxe,{initialData:d,onNext:m,onSkip:g}),t===2&&s.jsx(qxe,{onNext:v,onBack:()=>r(1),onSkip:g})]})]})}),s.jsx(s_e,{open:n,onOpenChange:a,onConfirmSkip:x})]})};function i_e(){const{user:e}=ws(),t=y.useRef(0),r=y.useRef(null),n=2*60*1e3,a=()=>E(this,null,function*(){if(!(e!=null&&e.id))return;const i=Date.now();if(!(i-t.current<n))try{yield Qh.updateLastActive(e.id),t.current=i,console.log(" Activity tracked: last_active_at updated")}catch(l){console.error("Failed to track activity:",l)}});return y.useEffect(()=>{if(e!=null&&e.id)return a(),r.current=setInterval(()=>{a()},5*60*1e3),()=>{r.current&&clearInterval(r.current)}},[e==null?void 0:e.id]),y.useEffect(()=>{const i=()=>{document.visibilityState==="visible"&&a()};return document.addEventListener("visibilitychange",i),()=>{document.removeEventListener("visibilitychange",i)}},[e==null?void 0:e.id]),{trackActivity:a}}class vs{static getAllProfiles(){return E(this,null,function*(){try{const{data:t,error:r}=yield T.rpc("get_all_profiles_for_analytics");if(r)throw console.error("Error getting all profiles for analytics:",r),r;return t||[]}catch(t){throw console.error("Error in getAllProfiles:",t),t}})}static getProfilesByAccountType(t){return E(this,null,function*(){try{return(yield this.getAllProfiles()).filter(n=>n.account_type===t)}catch(r){throw console.error("Error getting profiles by account type:",r),r}})}static getAllUserInteractions(t,r,n){return E(this,null,function*(){try{let a=T.from("interactions").select("*");t&&t.length>0&&(a=a.in("entity_id",t)),r&&r.length>0&&(a=a.in("event_type",r)),n&&n.length>0&&(a=a.in("entity_type",n));const{data:i,error:o}=yield a;if(o)throw console.error("Error getting user interactions for analytics:",o),o;return i||[]}catch(a){throw console.error("Error in getAllUserInteractions:",a),a}})}static getAllUserReviews(t){return E(this,null,function*(){try{let r=T.from("reviews").select("*").eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY");t&&t.length>0&&(r=r.in("event_id",t));const{data:n,error:a}=yield r;if(a)throw console.error("Error getting user reviews for analytics:",a),a;return n||[]}catch(r){throw console.error("Error in getAllUserReviews:",r),r}})}static getAllInterestedUsers(t){return E(this,null,function*(){try{let r=T.from("user_event_relationships").select("*").in("relationship_type",["interested","going","maybe"]);t&&t.length>0&&(r=r.in("event_id",t));const{data:n,error:a}=yield r;if(a)throw console.error("Error getting interested users for analytics:",a),a;return n||[]}catch(r){throw console.error("Error in getAllInterestedUsers:",r),r}})}static getAllFriendships(){return E(this,null,function*(){try{const{data:t,error:r}=yield T.from("user_relationships").select("*").eq("relationship_type","friend").eq("status","accepted");if(r)throw console.error("Error getting friendships for analytics:",r),r;return t||[]}catch(t){throw console.error("Error in getAllFriendships:",t),t}})}static getProfileById(t){return E(this,null,function*(){try{return(yield this.getAllProfiles()).find(n=>n.user_id===t)||null}catch(r){throw console.error("Error getting profile by ID:",r),r}})}static getProfilesByBusinessInfo(t){return E(this,null,function*(){try{return(yield this.getAllProfiles()).filter(n=>{if(!n.business_info)return!1;for(const[a,i]of Object.entries(t))if(n.business_info[a]!==i)return!1;return!0})}catch(r){throw console.error("Error getting profiles by business info:",r),r}})}}class oh{static getCreatorStats(t){return E(this,null,function*(){try{const{count:r}=yield T.from("artist_follows").select("*",{count:"exact",head:!0}).eq("artist_id",t);console.log(" CreatorAnalyticsService: Searching for events with creatorId:",t);const{data:n,error:a}=yield T.from("events").select("id, title, artist_name, venue_name, event_date, created_by_user_id").eq("created_by_user_id",t);if(a&&console.error(" CreatorAnalyticsService: Error fetching events:",a),console.log(" CreatorAnalyticsService: Found events for creator",t,":",(n==null?void 0:n.length)||0),n&&n.length>0)console.log(" CreatorAnalyticsService: Event details:",n.map(w=>({id:w.id,title:w.title,created_by:w.created_by_user_id})));else{console.log(" CreatorAnalyticsService: No events found. Let me check all events in database...");const{data:w,error:b}=yield T.from("events").select("id, title, artist_name, created_by_user_id").limit(10);b?console.error(" CreatorAnalyticsService: Error fetching all events:",b):console.log(" CreatorAnalyticsService: Sample events in database:",w==null?void 0:w.map(N=>({id:N.id,title:N.title,created_by:N.created_by_user_id})))}if(!n||n.length===0)return console.log(" CreatorAnalyticsService: No events found for creator",t),{total_followers:r||0,engagement_rate:0,total_event_views:0,total_reviews:0,profile_visits:0,ticket_clicks:0,fan_growth_rate:0,top_venue_performance:0};const i=n.map(w=>w.id),o=yield vs.getAllUserInteractions(i,void 0,["event"]);console.log(" CreatorAnalyticsService: Found interactions for events:",(o==null?void 0:o.length)||0),o&&o.length>0&&console.log(" CreatorAnalyticsService: Interaction details:",o.map(w=>({event_type:w.event_type,entity_id:w.entity_id,user_id:w.user_id})));const{data:l}=yield T.from("reviews").select(`
          *,
          event:events!inner(id, artist_name)
        `).in("event_id",i);console.log(" CreatorAnalyticsService: Found reviews for events:",(l==null?void 0:l.length)||0);const c=r||0,d=(o==null?void 0:o.filter(w=>w.event_type==="view").length)||0,f=(l==null?void 0:l.length)||0,u=(o==null?void 0:o.filter(w=>w.event_type==="profile_visit").length)||0,h=(o==null?void 0:o.filter(w=>w.event_type==="click_ticket").length)||0,m=d+u+h,v=c>0?m/c*100:0,_={total_followers:c,engagement_rate:Math.round(v*100)/100,total_event_views:d,total_reviews:f,profile_visits:u,ticket_clicks:h,fan_growth_rate:0,top_venue_performance:0};return console.log(" CreatorAnalyticsService: Final stats for creator",t,":",_),_}catch(r){return console.error("Error getting creator stats:",r),{total_followers:0,engagement_rate:0,total_event_views:0,total_reviews:0,profile_visits:0,ticket_clicks:0,fan_growth_rate:0,top_venue_performance:0}}})}static getFanInsights(t){return E(this,null,function*(){try{const{data:r}=yield T.from("events").select("*").eq("created_by_user_id",t);if(!r||r.length===0)return[];const n=r.map(l=>l.id),a=yield vs.getAllUserInteractions(n,void 0,["event"]),i=new Map;return r.forEach(l=>{const c=l.venue_name;i.has(c)||i.set(c,{eventCount:0,totalViews:0,interactions:[]}),i.get(c).eventCount++}),a==null||a.forEach(l=>{const c=r.find(d=>d.id===l.entity_id);if(c){const d=c.venue_name,f=i.get(d);f&&(f.interactions.push(l),l.event_type==="view"&&f.totalViews++)}}),Array.from(i.entries()).map(([l,c])=>{const d=c.eventCount>0?c.totalViews/c.eventCount:0,f=c.interactions.length>0?c.interactions.length/c.eventCount:0;return{venue_name:l,event_count:c.eventCount,total_views:c.totalViews,engagement_score:Math.round(d*100)/100,fan_density:Math.round(f*100)/100}}).sort((l,c)=>c.engagement_score-l.engagement_score)}catch(r){return console.error("Error getting fan insights:",r),[]}})}static getGeographicInsights(t){return E(this,null,function*(){try{const{data:r}=yield T.from("events").select("*").eq("created_by_user_id",t);if(!r||r.length===0)return[];const n=r.map(l=>l.id),a=yield vs.getAllUserInteractions(n,void 0,["event"]),i=new Map;return r.forEach(l=>{const c=`${l.venue_city||"Unknown"}, ${l.venue_state||"Unknown"}`;i.has(c)||i.set(c,{eventCount:0,fanCount:0,interactions:[]}),i.get(c).eventCount++}),a==null||a.forEach(l=>{const c=r.find(d=>d.id===l.entity_id);if(c){const d=`${c.venue_city||"Unknown"}, ${c.venue_state||"Unknown"}`,f=i.get(d);f&&(f.interactions.push(l),f.interactions.some(u=>u.user_id===l.user_id)||f.fanCount++)}}),Array.from(i.entries()).map(([l,c])=>{const[d,f]=l.split(", "),u=c.fanCount>0?c.interactions.length/c.fanCount*100:0;return{city:d.trim(),state:f.trim(),fan_count:c.fanCount,event_count:c.eventCount,engagement_rate:Math.round(u*100)/100}}).sort((l,c)=>c.fan_count-l.fan_count)}catch(r){return console.error("Error getting geographic insights:",r),[]}})}static getContentPerformance(t,r=30){return E(this,null,function*(){try{const n=new Date;n.setDate(n.getDate()-r);const{data:a}=yield T.from("events").select("id").eq("created_by_user_id",t);if(!a||a.length===0)return[];const i=a.map(d=>d.id),{data:o}=yield T.from("interactions").select("*").eq("entity_type","event").in("entity_id",i).gte("occurred_at",n.toISOString()),l=new Map;return o==null||o.forEach(d=>{const f=new Date(d.created_at).toISOString().split("T")[0];l.has(f)||l.set(f,{eventViews:0,profileVisits:0,followerGains:0,interactions:[]});const u=l.get(f);u.interactions.push(d),d.event_type==="view"?u.eventViews++:d.event_type==="profile_visit"&&u.profileVisits++}),Array.from(l.entries()).map(([d,f])=>{const u=f.interactions.length>0?f.interactions.length/10*100:0;return{date:d,event_views:f.eventViews,profile_visits:f.profileVisits,follower_gains:f.followerGains,engagement_rate:Math.round(u*100)/100}}).sort((d,f)=>new Date(d.date).getTime()-new Date(f.date).getTime())}catch(n){return console.error("Error getting content performance:",n),[]}})}static getCreatorAchievements(t){return E(this,null,function*(){try{const r=yield this.getCreatorStats(t),n=yield this.getFanInsights(t);return[{id:"first_follower",name:"First Fan",description:"Get your first follower",icon:"",progress:Math.min(r.total_followers,1),goal:1,unlocked:r.total_followers>=1,category:"follower"},{id:"growing_audience",name:"Growing Audience",description:"Reach 100 followers",icon:"",progress:Math.min(r.total_followers,100),goal:100,unlocked:r.total_followers>=100,category:"follower"},{id:"popular_creator",name:"Popular Creator",description:"Reach 1,000 followers",icon:"",progress:Math.min(r.total_followers,1e3),goal:1e3,unlocked:r.total_followers>=1e3,category:"follower"},{id:"engaging_content",name:"Engaging Content",description:"Achieve 10% engagement rate",icon:"",progress:Math.min(r.engagement_rate,10),goal:10,unlocked:r.engagement_rate>=10,category:"engagement"},{id:"highly_engaging",name:"Highly Engaging",description:"Achieve 25% engagement rate",icon:"",progress:Math.min(r.engagement_rate,25),goal:25,unlocked:r.engagement_rate>=25,category:"engagement"},{id:"venue_favorite",name:"Venue Favorite",description:"Perform at 5 different venues",icon:"",progress:Math.min(n.length,5),goal:5,unlocked:n.length>=5,category:"venue"},{id:"touring_artist",name:"Touring Artist",description:"Perform at 10 different venues",icon:"",progress:Math.min(n.length,10),goal:10,unlocked:n.length>=10,category:"venue"},{id:"reviewed_performer",name:"Reviewed Performer",description:"Get 10 reviews from fans",icon:"",progress:Math.min(r.total_reviews,10),goal:10,unlocked:r.total_reviews>=10,category:"engagement"},{id:"fan_favorite",name:"Fan Favorite",description:"Get 50 reviews from fans",icon:"",progress:Math.min(r.total_reviews,50),goal:50,unlocked:r.total_reviews>=50,category:"engagement"},{id:"ticket_seller",name:"Ticket Seller",description:"Generate 100 ticket clicks",icon:"",progress:Math.min(r.ticket_clicks,100),goal:100,unlocked:r.ticket_clicks>=100,category:"revenue"}]}catch(r){return console.error("Error getting creator achievements:",r),[]}})}static exportCreatorData(t){return E(this,null,function*(){const[r,n,a,i,o]=yield Promise.all([this.getCreatorStats(t),this.getFanInsights(t),this.getGeographicInsights(t),this.getContentPerformance(t),this.getCreatorAchievements(t)]);return{stats:r,fanInsights:n,geographicInsights:a,contentPerformance:i,achievements:o}})}}function di({title:e,value:t,change:r,changePercent:n,trend:a,icon:i,subtitle:o,className:l,valuePrefix:c="",valueSuffix:d=""}){const f=()=>!a||a==="neutral"?s.jsx(tz,{className:"w-4 h-4"}):a==="up"?s.jsx(KF,{className:"w-4 h-4"}):s.jsx(YF,{className:"w-4 h-4"}),u=()=>!a||a==="neutral"?"text-gray-500":a==="up"?"text-green-600":"text-red-600",h=m=>typeof m=="number"?m.toLocaleString():m;return s.jsxs(Ze,{className:Oe("glass-card inner-glow floating-shadow",l),children:[s.jsx(kr,{className:"pb-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Lr,{className:"text-sm font-medium text-gray-600",children:e}),i&&s.jsx("div",{className:"text-synth-pink",children:i})]})}),s.jsx(tt,{children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:[c,h(t),d]}),(r!==void 0||n!==void 0)&&s.jsxs("div",{className:Oe("flex items-center gap-1 text-sm",u()),children:[f(),s.jsxs("span",{className:"font-medium",children:[r!==void 0&&`${r>0?"+":""}${r}`,n!==void 0&&` (${n>0?"+":""}${n}%)`]}),o&&s.jsx("span",{className:"text-gray-500 ml-1",children:o})]}),!r&&!n&&o&&s.jsx("div",{className:"text-sm text-gray-500",children:o})]})})]})}function TA({name:e,description:t,icon:r,progress:n,goal:a,unlocked:i,unlockedAt:o,className:l,compact:c=!1}){const d=Math.min(n/a*100,100);return c?s.jsxs("div",{className:Oe("flex items-center gap-3 p-3 rounded-lg border transition-all",i?"bg-gradient-to-r from-yellow-50 to-amber-50 border-yellow-200":"bg-gray-50 border-gray-200 opacity-60",l),children:[s.jsx("div",{className:"text-3xl",children:r}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-semibold text-sm text-gray-900",children:e}),i&&s.jsxs(et,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 text-xs",children:[s.jsx(fa,{className:"w-3 h-3 mr-1"}),"Unlocked"]}),!i&&s.jsx(Rv,{className:"w-3 h-3 text-gray-400"})]}),s.jsx("p",{className:"text-xs text-gray-600",children:t}),!i&&s.jsxs("div",{className:"mt-1",children:[s.jsx(Jv,{value:d,className:"h-1"}),s.jsxs("span",{className:"text-xs text-gray-500",children:[n,"/",a]})]})]})]}):s.jsx(Ze,{className:Oe("overflow-hidden transition-all hover:shadow-md",i?"glass-card border-2 border-yellow-300 bg-gradient-to-br from-yellow-50/80 to-amber-50/80":"bg-white border-gray-200 opacity-75",l),children:s.jsxs(tt,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:Oe("text-5xl",i?"animate-bounce":"grayscale"),children:r}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:e}),s.jsx("p",{className:"text-sm text-gray-600",children:t})]})]}),i?s.jsxs(et,{className:"bg-yellow-500 text-white border-0",children:[s.jsx(fa,{className:"w-4 h-4 mr-1"}),"Unlocked!"]}):s.jsxs("div",{className:"flex items-center gap-1 text-gray-400",children:[s.jsx(Rv,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Locked"})]})]}),!i&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Progress"}),s.jsxs("span",{className:"font-semibold text-gray-900",children:[n,"/",a," (",Math.round(d),"%)"]})]}),s.jsx(Jv,{value:d,className:"h-2"})]}),i&&o&&s.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:["Unlocked on ",new Date(o).toLocaleDateString()]})]})})}function ro(){return s.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm animate-pulse",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3"}),s.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded-full"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6"})]}),s.jsxs("div",{className:"flex items-center gap-2 pt-4",children:[s.jsx("div",{className:"h-10 bg-gray-200 rounded w-1/4"}),s.jsx("div",{className:"h-10 bg-gray-200 rounded w-1/4"})]})]})})}function NW({stages:e,title:t="Conversion Funnel",showOptimizationTips:r=!0,className:n=""}){var f,u;const a=h=>h>=1e6?`${(h/1e6).toFixed(1)}M`:h>=1e3?`${(h/1e3).toFixed(1)}K`:h.toString(),i=h=>{const m=["from-blue-500 to-blue-600","from-purple-500 to-purple-600","from-pink-500 to-pink-600","from-green-500 to-green-600","from-yellow-500 to-yellow-600"];return m[h%m.length]},o=h=>h>70?"high":h>40?"medium":"low",l=h=>{switch(h){case"high":return"text-red-600 bg-red-50";case"medium":return"text-yellow-600 bg-yellow-50";case"low":return"text-green-600 bg-green-50"}},c=((f=e[0])==null?void 0:f.users_entered)||0,d=((u=e[e.length-1])==null?void 0:u.conversion_rate)||0;return s.jsxs(Ze,{className:`glass-card inner-glow ${n}`,children:[s.jsx(kr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Lr,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Ji,{className:"w-5 h-5 text-synth-pink"}),t]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(et,{variant:"outline",className:"text-blue-600 border-blue-200",children:[a(c)," Total Users"]}),s.jsxs(et,{variant:"outline",className:"text-green-600 border-green-200",children:[d.toFixed(1),"% Final Conversion"]})]})]})}),s.jsxs(tt,{className:"space-y-4",children:[s.jsx("div",{className:"space-y-3",children:e.map((h,m)=>{const v=m===e.length-1,g=o(h.drop_off_rate),x=i(h.stage_order);return s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"flex items-center gap-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:h.stage_name}),s.jsxs(et,{variant:"outline",className:`text-xs ${l(g)}`,children:[h.conversion_rate.toFixed(1),"% conversion"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[a(h.users_entered),"  ",a(h.users_completed)]}),s.jsxs("p",{className:"text-xs text-gray-600",children:[h.average_time_spent.toFixed(1),"m avg time"]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-full h-8 bg-gray-200 rounded-lg overflow-hidden",children:s.jsx("div",{className:`h-full bg-gradient-to-r ${x} transition-all duration-500`,style:{width:`${h.users_completed/h.users_entered*100}%`}})}),h.drop_off_rate>0&&s.jsxs("div",{className:"absolute top-0 right-0 flex items-center gap-1",children:[s.jsx(sz,{className:"w-4 h-4 text-red-500"}),s.jsxs("span",{className:"text-xs text-red-600 font-medium",children:["-",h.drop_off_rate.toFixed(1),"%"]})]})]}),h.revenue_attributed>0&&s.jsx("div",{className:"mt-2 flex items-center gap-2",children:s.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["$",h.revenue_attributed.toFixed(0)," revenue"]})})]})}),!v&&s.jsx("div",{className:"flex justify-center my-2",children:s.jsx(DQ,{className:"w-4 h-4 text-gray-400"})})]},h.stage_name)})}),r&&s.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(BP,{className:"w-4 h-4 text-yellow-600"}),s.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Optimization Opportunities"})]}),s.jsxs("div",{className:"space-y-2",children:[e.filter(h=>h.drop_off_rate>40).map((h,m)=>s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full mt-2 flex-shrink-0"}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-xs font-medium text-gray-900",children:[h.stage_name," Stage"]}),s.jsxs("p",{className:"text-xs text-gray-600",children:[h.drop_off_rate.toFixed(1),"% drop-off rate - ",h.optimization_opportunities[0]]})]})]},m)),e.filter(h=>h.drop_off_rate>40).length===0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(pc,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-xs text-green-700",children:"Great! No significant drop-off issues detected."})]})]})]}),s.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Key Actions Across Funnel"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:Array.from(new Set(e.flatMap(h=>h.key_actions))).slice(0,6).map((h,m)=>s.jsx(et,{variant:"secondary",className:"text-xs",children:h},m))})]})]})]})}function SW({sources:e,totalRevenue:t,title:r="Revenue Attribution",showConfidenceScores:n=!0,showTrends:a=!0,className:i=""}){var u,h;const o=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(m),l=m=>m>=.8?"text-green-600 bg-green-50":m>=.6?"text-yellow-600 bg-yellow-50":m>=.4?"text-orange-600 bg-orange-50":"text-red-600 bg-red-50",c=m=>m>=.8?"High":m>=.6?"Medium":m>=.4?"Low":"Very Low",d=m=>{const v=["from-blue-500 to-blue-600","from-green-500 to-green-600","from-purple-500 to-purple-600","from-pink-500 to-pink-600","from-yellow-500 to-yellow-600","from-indigo-500 to-indigo-600"];return v[m%v.length]},f=m=>m?s.jsxs("div",{className:`flex items-center gap-1 ${m>0?"text-green-600":"text-red-600"}`,children:[s.jsx(qn,{className:`w-3 h-3 ${m<0?"rotate-180":""}`}),s.jsxs("span",{className:"text-xs",children:[Math.abs(m).toFixed(1),"%"]})]}):null;return s.jsxs(Ze,{className:`glass-card inner-glow ${i}`,children:[s.jsx(kr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Lr,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Do,{className:"w-5 h-5 text-synth-pink"}),r]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o(t)}),s.jsx("p",{className:"text-sm text-gray-600",children:"Total Revenue"})]})]})}),s.jsxs(tt,{className:"space-y-4",children:[s.jsx("div",{className:"space-y-3",children:e.map((m,v)=>s.jsxs("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-gray-100 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-10 h-10 bg-gradient-to-r ${d(v)} rounded-full flex items-center justify-center`,children:s.jsx(Do,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 capitalize",children:m.source}),s.jsxs("p",{className:"text-sm text-gray-600",children:[m.attribution_window,"h attribution window"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-gray-900",children:o(m.revenue)}),s.jsxs("p",{className:"text-sm text-gray-600",children:[m.percentage.toFixed(1),"% of total"]})]})]}),s.jsx("div",{className:"mb-3",children:s.jsx("div",{className:"w-full h-3 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full bg-gradient-to-r ${d(v)} transition-all duration-500`,style:{width:`${m.percentage}%`}})})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[n&&s.jsxs(et,{variant:"outline",className:`text-xs ${l(m.confidence_score)}`,children:[c(m.confidence_score)," Confidence"]}),a&&f(m.trend)]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:"text-xs text-gray-600",children:["Confidence: ",(m.confidence_score*100).toFixed(0),"%"]})})]})]},m.source))}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[s.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Hb,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Top Source"})]}),s.jsx("p",{className:"text-lg font-bold text-blue-900",children:((u=e[0])==null?void 0:u.source)||"N/A"}),s.jsxs("p",{className:"text-xs text-blue-700",children:[(h=e[0])==null?void 0:h.percentage.toFixed(1),"% of revenue"]})]}),s.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(qd,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-900",children:"Avg Confidence"})]}),s.jsxs("p",{className:"text-lg font-bold text-green-900",children:[(e.reduce((m,v)=>m+v.confidence_score,0)/e.length*100).toFixed(0),"%"]}),s.jsx("p",{className:"text-xs text-green-700",children:"Data quality score"})]})]}),e.some(m=>m.confidence_score<.5)&&s.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(df,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-900",children:"Data Quality Notice"})]}),s.jsx("p",{className:"text-xs text-yellow-800 mt-1",children:"Some revenue sources have low confidence scores. Consider improving data collection for more accurate attribution."})]}),s.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Attribution Insights"}),s.jsx("div",{className:"space-y-1",children:e.filter(m=>m.percentage>20).map((m,v)=>s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("span",{className:"text-gray-700",children:[m.source," drives ",m.percentage.toFixed(1),"% of revenue"]}),s.jsxs("span",{className:"text-gray-600",children:[m.attribution_window,"h window"]})]},v))})]})]})]})}function kW({metrics:e,title:t="Engagement Score",showBreakdown:r=!0,previousScore:n,className:a=""}){const i=u=>u>=80?"text-green-600":u>=60?"text-yellow-600":u>=40?"text-orange-600":"text-red-600",o=u=>u>=80?"Excellent":u>=60?"Good":u>=40?"Fair":"Poor",l=u=>u>=80?"Outstanding engagement! Users are highly active and invested.":u>=60?"Good engagement levels. Room for improvement in some areas.":u>=40?"Moderate engagement. Focus on improving user experience.":"Low engagement. Significant improvements needed to retain users.",d=n?((u,h)=>{if(!h)return{value:0,isPositive:!0};const m=u-h;return{value:Math.abs(m),isPositive:m>=0}})(e.score,n):null,f=e.score/100*180;return s.jsxs(Ze,{className:`glass-card inner-glow ${a}`,children:[s.jsx(kr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Lr,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(No,{className:"w-5 h-5 text-synth-pink"}),t]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(et,{variant:"outline",className:`${i(e.score)} border-current`,children:o(e.score)}),d&&s.jsxs("div",{className:`flex items-center gap-1 text-xs ${d.isPositive?"text-green-600":"text-red-600"}`,children:[s.jsx(qn,{className:`w-3 h-3 ${d.isPositive?"":"rotate-180"}`}),d.value.toFixed(0)," pts"]})]})]})}),s.jsxs(tt,{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-center",children:s.jsxs("div",{className:"relative w-48 h-24",children:[s.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 200 100",children:[s.jsx("path",{d:"M 20 80 A 60 60 0 0 1 180 80",stroke:"#e5e7eb",strokeWidth:"12",fill:"none",strokeLinecap:"round"}),s.jsx("path",{d:"M 20 80 A 60 60 0 0 1 180 80",stroke:e.score>=80?"#10b981":e.score>=60?"#f59e0b":e.score>=40?"#f97316":"#ef4444",strokeWidth:"12",fill:"none",strokeLinecap:"round",strokeDasharray:`${f*1.05} 314`,strokeDashoffset:"157",className:"transition-all duration-1000 ease-out"})]}),s.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[s.jsx("div",{className:`text-3xl font-bold ${i(e.score)}`,children:e.score}),s.jsx("div",{className:"text-sm text-gray-600",children:"/ 100"})]})]})}),s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-sm text-gray-700",children:l(e.score)})}),r&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Engagement Breakdown"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 rounded-lg",children:[s.jsx(Oa,{className:"w-4 h-4 text-blue-600"}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.floor(e.sessionDuration/6e4),"m"]}),s.jsx("p",{className:"text-xs text-gray-600",children:"Session Time"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 rounded-lg",children:[s.jsx(IP,{className:"w-4 h-4 text-green-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.interactionCount}),s.jsx("p",{className:"text-xs text-gray-600",children:"Interactions"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 rounded-lg",children:[s.jsx(Jd,{className:"w-3 h-3 text-gray-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-900",children:e.pageViews}),s.jsx("p",{className:"text-xs text-gray-600",children:"Views"})]})]}),s.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 rounded-lg",children:[s.jsx(es,{className:"w-3 h-3 text-gray-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-900",children:e.likes}),s.jsx("p",{className:"text-xs text-gray-600",children:"Likes"})]})]}),s.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 rounded-lg",children:[s.jsx(No,{className:"w-3 h-3 text-gray-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-900",children:e.shares}),s.jsx("p",{className:"text-xs text-gray-600",children:"Shares"})]})]})]}),e.bounceRate>70&&s.jsxs("div",{className:"p-2 bg-red-50 border border-red-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),s.jsxs("span",{className:"text-xs font-medium text-red-900",children:["High bounce rate: ",e.bounceRate.toFixed(1),"%"]})]}),s.jsx("p",{className:"text-xs text-red-700 mt-1",children:"Consider improving content relevance and user experience"})]})]}),s.jsxs("div",{className:"p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Improvement Suggestions"}),s.jsxs("div",{className:"space-y-1",children:[e.score<60&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full"}),s.jsx("span",{className:"text-xs text-gray-700",children:"Increase session duration by improving content quality"})]}),e.interactionCount<5&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full"}),s.jsx("span",{className:"text-xs text-gray-700",children:"Add more interactive elements to boost engagement"})]}),e.bounceRate>50&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full"}),s.jsx("span",{className:"text-xs text-gray-700",children:"Optimize page load times and content relevance"})]}),e.score>=80&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-xs text-green-700",children:"Excellent engagement! Keep up the great work"})]})]})]})]})]})}function EW({data:e,title:t="Trend Analysis",valueLabel:r="Value",showTrend:n=!0,showForecast:a=!1,className:i=""}){var g;const o=x=>x>=1e6?`${(x/1e6).toFixed(1)}M`:x>=1e3?`${(x/1e3).toFixed(1)}K`:x.toString(),l=x=>new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric"}),c=x=>{if(x.length<2)return{direction:"flat",percentage:0};const _=x[0].value,b=(x[x.length-1].value-_)/_*100;return Math.abs(b)<1?{direction:"flat",percentage:0}:{direction:b>0?"up":"down",percentage:Math.abs(b)}},d=()=>Math.max(...e.map(x=>x.value)),f=()=>Math.min(...e.map(x=>x.value)),u=(x,_,w)=>_===w?50:(x-w)/(_-w)*100,h=c(e),m=d(),v=f();return s.jsxs(Ze,{className:`glass-card inner-glow ${i}`,children:[s.jsx(kr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Lr,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(qd,{className:"w-5 h-5 text-synth-pink"}),t]}),n&&s.jsxs("div",{className:"flex items-center gap-2",children:[h.direction==="up"&&s.jsxs(et,{variant:"outline",className:"text-green-600 border-green-200",children:[s.jsx(qn,{className:"w-3 h-3 mr-1"}),"+",h.percentage.toFixed(1),"%"]}),h.direction==="down"&&s.jsxs(et,{variant:"outline",className:"text-red-600 border-red-200",children:[s.jsx(sz,{className:"w-3 h-3 mr-1"}),"-",h.percentage.toFixed(1),"%"]}),h.direction==="flat"&&s.jsxs(et,{variant:"outline",className:"text-gray-600 border-gray-200",children:[s.jsx(Ji,{className:"w-3 h-3 mr-1"}),"Stable"]})]})]})}),s.jsxs(tt,{className:"space-y-4",children:[s.jsxs("div",{className:"relative h-48 bg-gradient-to-b from-gray-50 to-white rounded-lg p-4",children:[s.jsx("div",{className:"absolute inset-4",children:[0,25,50,75,100].map((x,_)=>s.jsx("div",{className:"absolute w-full border-t border-gray-200",style:{top:`${x}%`}},_))}),s.jsxs("svg",{className:"absolute inset-4 w-full h-full",children:[s.jsx("polyline",{fill:"none",stroke:"#8b5cf6",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",points:e.map((x,_)=>{const w=_/(e.length-1)*100,b=100-u(x.value,m,v);return`${w},${b}`}).join(" ")}),e.map((x,_)=>{const w=_/(e.length-1)*100,b=100-u(x.value,m,v);return s.jsx("circle",{cx:w,cy:b,r:"4",fill:"#8b5cf6",className:"hover:r-6 transition-all duration-200"},_)})]}),s.jsxs("div",{className:"absolute left-0 top-4 bottom-4 flex flex-col justify-between text-xs text-gray-600",children:[s.jsx("span",{children:o(m)}),s.jsx("span",{children:o((m+v)/2)}),s.jsx("span",{children:o(v)})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-blue-900",children:o(((g=e[e.length-1])==null?void 0:g.value)||0)}),s.jsx("div",{className:"text-xs text-blue-700",children:"Current"})]}),s.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-green-900",children:o(m)}),s.jsx("div",{className:"text-xs text-green-700",children:"Peak"})]}),s.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-purple-900",children:o(e.reduce((x,_)=>x+_.value,0)/e.length)}),s.jsx("div",{className:"text-xs text-purple-700",children:"Average"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Recent Data"}),s.jsx("div",{className:"space-y-1",children:e.slice(-5).map((x,_)=>s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-gray-600",children:l(x.date)}),s.jsx("span",{className:"font-medium text-gray-900",children:o(x.value)}),x.label&&s.jsx("span",{className:"text-gray-500",children:x.label})]},_))})]}),n&&s.jsxs("div",{className:"p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Lt,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Trend Analysis"})]}),s.jsxs("p",{className:"text-xs text-gray-700",children:[h.direction==="up"&&`Showing ${h.percentage.toFixed(1)}% growth over the period`,h.direction==="down"&&`Showing ${h.percentage.toFixed(1)}% decline over the period`,h.direction==="flat"&&"Values have remained relatively stable"]})]})]})]})}class _i{static logError(t,r,n,a="medium",i="unknown"){return E(this,null,function*(){const o=typeof r=="string"?r:r.message;console.error(`[${a.toUpperCase()}] ${t}:`,o,n)})}static logValidationError(t,r,n){return E(this,null,function*(){yield this.logError(`validation_error: ${t}`,`Validation failed: ${r.join(", ")}`,{validation_errors:r,invalid_data:n},"medium","validation")})}static logNetworkError(t,r,n,a){return E(this,null,function*(){yield this.logError(`network_error: ${t}`,r,{url:n,status_code:a},"high","network")})}static logDatabaseError(t,r,n,a){return E(this,null,function*(){yield this.logError(`database_error: ${t}`,r,{query:n,table:a},"high","database")})}static logAuthError(t,r,n){return E(this,null,function*(){yield this.logError(`auth_error: ${t}`,r,{user_id:n},"medium","authentication")})}static logBusinessLogicError(t,r,n){return E(this,null,function*(){yield this.logError(`business_logic_error: ${t}`,r,n,"medium","business_logic")})}static getErrorStats(t=24){return E(this,null,function*(){return{total_errors:0,errors_by_category:{},errors_by_severity:{},recent_errors:[],error_rate:0}})}static getErrorsByCategory(t,r=50){return E(this,null,function*(){return[]})}static getCriticalErrors(t=20){return E(this,null,function*(){return[]})}static resolveError(t,r){return E(this,null,function*(){return!1})}static getErrorTrends(t=7){return E(this,null,function*(){return[]})}static getErrorCategories(){return this.ERROR_CATEGORIES}static getSeverityLevels(){return this.SEVERITY_LEVELS}}Pr(_i,"ERROR_CATEGORIES",{validation:"Data validation errors",network:"Network and API errors",database:"Database operation errors",authentication:"User authentication errors",business_logic:"Application logic errors",unknown:"Uncategorized errors"}),Pr(_i,"SEVERITY_LEVELS",{low:"Minor issues, non-blocking",medium:"Moderate issues, may affect functionality",high:"Serious issues, significant impact",critical:"Critical issues, system-breaking"});const Ei=_i.logError.bind(_i);_i.logValidationError.bind(_i);_i.logNetworkError.bind(_i);_i.logDatabaseError.bind(_i);_i.logAuthError.bind(_i);_i.logBusinessLogicError.bind(_i);class AA{static analyzeFunnel(t,r,n){return E(this,null,function*(){try{const{data:a}=yield T.from("users").select("user_id").eq("account_type",t);if(!a||a.length===0)return this.createEmptyFunnel(t);const i=a.map(g=>g.user_id),{data:o,error:l}=yield T.from("interactions").select("*").in("user_id",i).gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString()).order("occurred_at",{ascending:!0});if(l)return yield Ei("funnel_analysis_error",l,{userType:t,timeRange:r}),this.createEmptyFunnel(t);if(!o)return this.createEmptyFunnel(t);const c=yield this.analyzeFunnelStages(o,t),d=new Set(o.map(g=>g.user_id)).size,f=this.calculateOverallConversionRate(c),u=this.calculateTotalRevenue(c),h=this.calculateAverageTimeToConversion(o),m=this.identifyTopDropOffStages(c),v=this.generateRecommendations(c,t);return{funnel_id:`${t}_funnel_${Date.now()}`,funnel_name:`${t.charAt(0).toUpperCase()+t.slice(1)} Conversion Funnel`,total_users:d,overall_conversion_rate:f,stages:c,total_revenue:u,average_time_to_conversion:h,top_drop_off_stages:m,recommendations:v}}catch(a){return yield Ei("funnel_analysis_exception",a,{userType:t,timeRange:r}),this.createEmptyFunnel(t)}})}static trackUserJourney(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("*").eq("user_id",t).gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString()).order("occurred_at",{ascending:!0});if(a)return yield Ei("user_journey_tracking_error",a,{userId:t,timeRange:r}),[];if(!n||n.length===0)return[];const i=this.groupInteractionsBySession(n),o=[];for(const l of i){const c=this.analyzeUserJourney(t,l);o.push(c)}return o}catch(n){return yield Ei("user_journey_tracking_exception",n,{userId:t,timeRange:r}),[]}})}static compareFunnels(t,r){return E(this,null,function*(){const n=r.overall_conversion_rate-t.overall_conversion_rate,a=r.total_revenue-t.total_revenue,i=t.average_time_to_conversion-r.average_time_to_conversion;return{funnel_a:t,funnel_b:r,improvement_metrics:{conversion_rate_improvement:Math.round(n*100)/100,revenue_improvement:Math.round(a*100)/100,time_improvement:Math.round(i*100)/100}}})}static getOptimizationRecommendations(t){return E(this,null,function*(){const r=[];for(const n of t.top_drop_off_stages)n.drop_off_rate>50&&r.push({priority:"high",category:"conversion",title:`Reduce Drop-off at ${n.stage} Stage`,description:`${n.users_lost} users are dropping off at the ${n.stage} stage (${n.drop_off_rate}% drop-off rate)`,expected_impact:`Could improve conversion by ${Math.round(n.drop_off_rate*.3)}%`,implementation_effort:"medium"});return t.overall_conversion_rate<5&&r.push({priority:"high",category:"conversion",title:"Improve Overall Conversion Rate",description:`Current conversion rate is ${t.overall_conversion_rate}%, which is below industry standards`,expected_impact:"Could double conversion rate with optimization",implementation_effort:"high"}),t.average_time_to_conversion>7&&r.push({priority:"medium",category:"engagement",title:"Reduce Time to Conversion",description:`Average time to conversion is ${t.average_time_to_conversion} days`,expected_impact:"Could reduce time to conversion by 30-50%",implementation_effort:"medium"}),r})}static analyzeFunnelStages(t,r){return E(this,null,function*(){const n=[],a=Object.values(this.FUNNEL_STAGES);for(const i of a){const o=t.filter(g=>i.events.includes(g.event_type)),l=new Set(o.map(g=>g.user_id)).size,c=this.calculateUsersCompleted(o,i.order),d=l>0?c/l*100:0,f=l>0?(l-c)/l*100:0,u=this.calculateAverageTimeSpent(o),h=this.calculateStageRevenue(o),m=this.identifyKeyActions(o),v=this.identifyOptimizationOpportunities(i,o);n.push({stage_name:i.name,stage_order:i.order,users_entered:l,users_completed:c,conversion_rate:Math.round(d*100)/100,drop_off_rate:Math.round(f*100)/100,average_time_spent:Math.round(u*100)/100,revenue_attributed:Math.round(h*100)/100,key_actions:m,optimization_opportunities:v})}return n})}static calculateUsersCompleted(t,r){const n=this.getNextStageEvents(r),a=t.filter(i=>n.includes(i.event_type));return new Set(a.map(i=>i.user_id)).size}static getNextStageEvents(t){const n=Object.values(this.FUNNEL_STAGES).find(a=>a.order===t+1);return n?n.events:[]}static calculateAverageTimeSpent(t){if(t.length===0)return 0;const n=this.groupInteractionsBySession(t).map(a=>{const i=new Date(a[0].occurred_at);return(new Date(a[a.length-1].occurred_at).getTime()-i.getTime())/(1e3*60)});return n.reduce((a,i)=>a+i,0)/n.length}static calculateStageRevenue(t){return t.filter(r=>r.event_type==="ticket_click"||r.event_type==="form_submit"),0}static identifyKeyActions(t){const r={};return t.forEach(n=>{r[n.event_type]=(r[n.event_type]||0)+1}),Object.entries(r).sort(([,n],[,a])=>a-n).slice(0,3).map(([n])=>n)}static identifyOptimizationOpportunities(t,r){const n=[];return r.length===0?(n.push("No user activity in this stage - consider improving discovery"),n):(this.calculateStageConversionRate(r)<20&&n.push("Low conversion rate - consider improving user experience"),this.calculateAverageTimeSpent(r)>10&&n.push("Users spending too much time - consider simplifying the process"),n)}static calculateStageConversionRate(t){const r=new Set(t.map(a=>a.user_id)).size,n=new Set(t.filter(a=>a.event_type==="ticket_click"||a.event_type==="form_submit").map(a=>a.user_id)).size;return r>0?n/r*100:0}static groupInteractionsBySession(t){const r={};return t.forEach(n=>{const a=n.session_id||"default";r[a]||(r[a]=[]),r[a].push(n)}),Object.values(r)}static analyzeUserJourney(t,r){const n=r[0].occurred_at,a=r[r.length-1].occurred_at,i=new Date(a).getTime()-new Date(n).getTime(),o=this.identifyStagesCompleted(r),l=this.checkConversionAchieved(r),c=this.calculateJourneyRevenue(r),d=r.map(f=>({timestamp:f.occurred_at,stage:this.mapEventToStage(f.event_type),action:f.event_type,entity_id:f.entity_id,metadata:f.metadata}));return{user_id:t,journey_id:r[0].session_id||crypto.randomUUID(),start_time:n,end_time:a,stages_completed:o,total_duration:i,conversion_achieved:l,revenue_generated:c,touchpoints:d}}static identifyStagesCompleted(t){const r=new Set;return t.forEach(n=>{const a=this.mapEventToStage(n.event_type);a&&r.add(a)}),Array.from(r)}static mapEventToStage(t){for(const[r,n]of Object.entries(this.FUNNEL_STAGES))if(n.events.includes(t))return r;return null}static checkConversionAchieved(t){return t.some(r=>r.event_type==="ticket_click"||r.event_type==="form_submit")}static calculateJourneyRevenue(t){return t.filter(n=>n.event_type==="ticket_click"||n.event_type==="form_submit").length*50}static calculateOverallConversionRate(t){if(t.length===0)return 0;const r=t[0],n=t[t.length-1];return r.users_entered>0?n.users_completed/r.users_entered*100:0}static calculateTotalRevenue(t){return t.reduce((r,n)=>r+n.revenue_attributed,0)}static calculateAverageTimeToConversion(t){const n=this.groupInteractionsBySession(t).filter(i=>i.some(o=>o.event_type==="ticket_click"||o.event_type==="form_submit"));return n.length===0?0:n.reduce((i,o)=>{const l=new Date(o[0].occurred_at),c=new Date(o[o.length-1].occurred_at);return i+(c.getTime()-l.getTime())},0)/(n.length*(1e3*60*60*24))}static identifyTopDropOffStages(t){return t.map(r=>({stage:r.stage_name,drop_off_rate:r.drop_off_rate,users_lost:r.users_entered-r.users_completed})).sort((r,n)=>n.drop_off_rate-r.drop_off_rate).slice(0,3)}static generateRecommendations(t,r){const n=[],a=t.filter(o=>o.drop_off_rate>50);a.length>0&&n.push(`Focus on reducing drop-off in ${a.map(o=>o.stage_name).join(", ")} stages`);const i=t.filter(o=>o.conversion_rate<20);return i.length>0&&n.push(`Improve conversion rates in ${i.map(o=>o.stage_name).join(", ")} stages`),r==="user"?(n.push("Consider implementing social proof and user testimonials"),n.push("Add personalized recommendations based on music taste")):r==="creator"?(n.push("Provide detailed analytics and performance metrics"),n.push("Offer exclusive content and early access features")):r==="business"&&(n.push("Showcase venue capacity and past successful events"),n.push("Provide detailed ROI and revenue projections")),n}static createEmptyFunnel(t){return{funnel_id:`${t}_funnel_empty`,funnel_name:`${t.charAt(0).toUpperCase()+t.slice(1)} Conversion Funnel`,total_users:0,overall_conversion_rate:0,stages:[],total_revenue:0,average_time_to_conversion:0,top_drop_off_stages:[],recommendations:["No data available for analysis"]}}}Pr(AA,"FUNNEL_STAGES",{discovery:{name:"Discovery",order:1,events:["view","search","navigate"],description:"User discovers content or platform"},interest:{name:"Interest",order:2,events:["interest","like","follow","share"],description:"User shows interest in content"},consideration:{name:"Consideration",order:3,events:["click","navigate","view"],description:"User considers taking action"},conversion:{name:"Conversion",order:4,events:["ticket_click","form_submit","profile_update"],description:"User completes desired action"}});class Dh{static calculateTicketRevenue(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("*").eq("user_id",t).eq("event_type","click").eq("entity_type","ticket_link").gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString());if(a)return yield Ei("revenue_calculation_error",a,{userId:t,timeRange:r}),[];const i=[];for(const o of n||[]){const l=this.estimateTicketPrice(o.metadata),c=this.calculateConfidenceScore(o.metadata);i.push({id:crypto.randomUUID(),interaction_id:o.id,revenue_type:"ticket_click",estimated_amount:l,currency:"USD",attribution_window_hours:this.ATTRIBUTION_WINDOWS.ticket_click,confidence_score:c,user_id:t,entity_id:o.entity_id,entity_type:o.entity_type,created_at:new Date().toISOString(),metadata:{original_click:o,estimation_method:"ticket_click_analysis"}})}return i}catch(n){return yield Ei("ticket_revenue_calculation_error",n,{userId:t,timeRange:r}),[]}})}static calculateSubscriptionRevenue(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("*").eq("user_id",t).in("event_type",["profile_update","form_submit"]).gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString());if(a)return yield Ei("subscription_revenue_calculation_error",a,{userId:t,timeRange:r}),[];const i=[],o=(n==null?void 0:n.filter(l=>{const c=l.metadata;return(c==null?void 0:c.field)==="subscription_tier"||(c==null?void 0:c.formType)==="subscription"}))||[];for(const l of o){const c=this.estimateSubscriptionValue(l.metadata),d=this.calculateSubscriptionConfidence(l.metadata);i.push({id:crypto.randomUUID(),interaction_id:l.id,revenue_type:"subscription",estimated_amount:c,currency:"USD",attribution_window_hours:this.ATTRIBUTION_WINDOWS.subscription,confidence_score:d,user_id:t,entity_id:l.entity_id,entity_type:l.entity_type,created_at:new Date().toISOString(),metadata:{original_interaction:l,estimation_method:"subscription_analysis"}})}return i}catch(n){return yield Ei("subscription_revenue_calculation_error",n,{userId:t,timeRange:r}),[]}})}static calculateAffiliateRevenue(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("*").eq("user_id",t).eq("event_type","share").gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString());if(a)return yield Ei("affiliate_revenue_calculation_error",a,{userId:t,timeRange:r}),[];const i=[];for(const o of n||[]){const l=this.estimateAffiliateCommission(o.metadata),c=this.calculateAffiliateConfidence(o.metadata);l>0&&i.push({id:crypto.randomUUID(),interaction_id:o.id,revenue_type:"affiliate",estimated_amount:l,currency:"USD",attribution_window_hours:this.ATTRIBUTION_WINDOWS.affiliate,confidence_score:c,user_id:t,entity_id:o.entity_id,entity_type:o.entity_type,created_at:new Date().toISOString(),metadata:{original_share:o,estimation_method:"affiliate_analysis"}})}return i}catch(n){return yield Ei("affiliate_revenue_calculation_error",n,{userId:t,timeRange:r}),[]}})}static getUserRevenueMetrics(t,r){return E(this,null,function*(){try{return{total_revenue:0,revenue_by_type:{},conversion_rate:0,average_order_value:0,revenue_per_user:0,top_revenue_sources:[]}}catch(n){return yield Ei("revenue_metrics_calculation_error",n,{userId:t,timeRange:r}),{total_revenue:0,revenue_by_type:{},conversion_rate:0,average_order_value:0,revenue_per_user:0,top_revenue_sources:[]}}})}static analyzeConversionFunnel(t,r){return E(this,null,function*(){try{const{data:n}=yield T.from("interactions").select("*").eq("user_id",t).gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString());if(!n)return[];const a=[{name:"discovery",events:["view","search"]},{name:"interest",events:["interest","like","follow"]},{name:"consideration",events:["click","navigate"]},{name:"conversion",events:["ticket_click","form_submit"]}],i=[];let o=0;for(let l=0;l<a.length;l++){const c=a[l],d=n.filter(v=>c.events.includes(v.event_type)),f=new Set(d.map(v=>v.user_id)).size,u=o>0?f/o*100:100,h=o>0?(o-f)/o*100:0;i.push({stage:c.name,users:f,conversion_rate:Math.round(u*100)/100,drop_off_rate:Math.round(h*100)/100,revenue_attributed:Math.round(0*100)/100}),o=f}return i}catch(n){return yield Ei("conversion_funnel_analysis_error",n,{userId:t,timeRange:r}),[]}})}static getRevenueTrends(t,r="day"){return E(this,null,function*(){try{const{data:n}=yield T.from("interactions").select("*").gte("occurred_at",t.start.toISOString()).lte("occurred_at",t.end.toISOString()).in("event_type",["click","ticket_click","form_submit"]);if(!n)return[];const a={};return n.forEach(i=>{const o=new Date(i.occurred_at);let l;switch(r){case"day":l=o.toISOString().split("T")[0];break;case"week":const c=new Date(o);c.setDate(o.getDate()-o.getDay()),l=c.toISOString().split("T")[0];break;case"month":l=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`;break;default:l=o.toISOString().split("T")[0]}a[l]||(a[l]={revenue:0,conversions:0,interactions:0}),a[l].interactions++,i.event_type==="ticket_click"&&(a[l].conversions++,a[l].revenue+=0)}),Object.entries(a).map(([i,o])=>({date:i,revenue:o.revenue,conversions:o.conversions,conversion_rate:o.interactions>0?o.conversions/o.interactions*100:0,average_order_value:o.conversions>0?o.revenue/o.conversions:0})).sort((i,o)=>i.date.localeCompare(o.date))}catch(n){return yield Ei("revenue_trends_calculation_error",n,{timeRange:t,groupBy:r}),[]}})}static estimateTicketPrice(t){return t!=null&&t.price&&typeof t.price=="number"?t.price:this.ESTIMATED_TICKET_PRICE}static estimateSubscriptionValue(t){switch((t==null?void 0:t.newTier)||(t==null?void 0:t.subscription_tier)){case"premium":return this.ESTIMATED_SUBSCRIPTION_PRICE;case"professional":return this.ESTIMATED_SUBSCRIPTION_PRICE*2;case"enterprise":return this.ESTIMATED_SUBSCRIPTION_PRICE*5;default:return 0}}static estimateAffiliateCommission(t){const r=t==null?void 0:t.platform;return r==="instagram"||r==="twitter"||r==="facebook"?this.ESTIMATED_TICKET_PRICE*this.ESTIMATED_AFFILIATE_COMMISSION:0}static calculateConfidenceScore(t){let r=.5;return t!=null&&t.price&&(r+=.3),t!=null&&t.venue_name&&(r+=.1),t!=null&&t.artist_name&&(r+=.1),Math.min(r,1)}static calculateSubscriptionConfidence(t){let r=.3;return t!=null&&t.newTier&&(r+=.4),t!=null&&t.oldTier&&(r+=.2),t!=null&&t.changeType&&(r+=.1),Math.min(r,1)}static calculateAffiliateConfidence(t){let r=.2;return t!=null&&t.platform&&(r+=.3),t!=null&&t.reach&&(r+=.2),t!=null&&t.engagement&&(r+=.3),Math.min(r,1)}}Pr(Dh,"ESTIMATED_TICKET_PRICE",50),Pr(Dh,"ESTIMATED_SUBSCRIPTION_PRICE",4.99),Pr(Dh,"ESTIMATED_AFFILIATE_COMMISSION",.05),Pr(Dh,"ATTRIBUTION_WINDOWS",{ticket_click:24,subscription:30*24,affiliate:7*24});class Zi{static getUserPromotions(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select(`
          *,
          event:jambase_events!event_promotions_event_id_fkey(
            id,
            title,
            artist_name,
            venue_name,
            event_date,
            poster_image_url
          )
        `).eq("promoted_by_user_id",t).order("created_at",{ascending:!1});if(n)throw n;if(r&&r.length>0)for(const i of r)try{yield Sl.syncPromotionMetrics(i.id)}catch(o){console.error(`Error syncing metrics for promotion ${i.id}:`,o)}const a=(r==null?void 0:r.map(i=>i.event_id))||[];if(a.length>0){const i=yield vs.getAllUserInteractions(a,void 0,["event"]),o=yield vs.getAllInterestedUsers(a);for(const l of r){const c=(i==null?void 0:i.filter(m=>m.entity_id===l.event_id))||[],d=(o==null?void 0:o.filter(m=>m.jambase_event_id===l.event_id))||[],f=c.filter(m=>m.event_type==="view").length,u=c.filter(m=>m.event_type==="click").length,h=d.length;l.impressions=f,l.clicks=u,l.conversions=h}}return r||[]}catch(r){throw console.error("Error fetching user promotions:",r),r}})}static getPromotionMetrics(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select(`
          *,
          event:jambase_events!event_promotions_event_id_fkey(
            id,
            title,
            artist_name,
            venue_name,
            event_date
          )
        `).eq("id",t).single();if(n)throw n;if(!r)return null;const a=r.impressions>0?r.clicks/r.impressions*100:0,i=r.clicks>0?r.conversions/r.clicks*100:0,o=r.clicks>0?r.price_paid/r.clicks:0,l=r.conversions>0?r.price_paid/r.conversions:0,d=r.conversions*25,f=d>0?(d-r.price_paid)/r.price_paid*100:-100;return{promotion_id:r.id,event_title:r.event.title,tier:r.promotion_tier,impressions:r.impressions,clicks:r.clicks,conversions:r.conversions,ctr:Math.round(a*100)/100,conversion_rate:Math.round(i*100)/100,cost_per_click:Math.round(o*100)/100,cost_per_conversion:Math.round(l*100)/100,roi:Math.round(f*100)/100,revenue_attributed:Math.round(d*100)/100}}catch(r){throw console.error("Error fetching promotion metrics:",r),r}})}static getPromotionPerformanceComparison(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select(`
          *,
          event:jambase_events!event_promotions_event_id_fkey(
            id,
            title,
            artist_name,
            venue_name,
            event_date
          )
        `).eq("promoted_by_user_id",t).order("created_at",{ascending:!1});if(n)throw n;if(r&&r.length>0)for(const i of r)try{yield Sl.syncPromotionMetrics(i.id)}catch(o){console.error(`Error syncing metrics for promotion ${i.id}:`,o)}const a=(r==null?void 0:r.map(i=>i.event_id))||[];if(a.length>0){const i=yield vs.getAllUserInteractions(a,void 0,["event"]),o=yield vs.getAllInterestedUsers(a);for(const l of r){const c=(i==null?void 0:i.filter(m=>m.entity_id===l.event_id))||[],d=(o==null?void 0:o.filter(m=>m.jambase_event_id===l.event_id))||[],f=c.filter(m=>m.event_type==="view").length,u=c.filter(m=>m.event_type==="click").length,h=d.length;l.impressions=f,l.clicks=u,l.conversions=h}}return r?r.map(i=>{const o=i.impressions>0?i.clicks/i.impressions*100:0,l=i.clicks>0?i.conversions/i.clicks*100:0,c=i.clicks>0?i.price_paid/i.clicks:0,d=i.conversions>0?i.price_paid/i.conversions:0,f=Math.ceil((new Date(i.expires_at).getTime()-new Date(i.starts_at).getTime())/(1e3*60*60*24)),h=i.conversions*25,m=h>0?(h-i.price_paid)/i.price_paid*100:-100;return{promotion_id:i.id,event_title:i.event.title,tier:i.promotion_tier,duration_days:f,total_spend:i.price_paid,impressions:i.impressions,clicks:i.clicks,conversions:i.conversions,ctr:Math.round(o*100)/100,conversion_rate:Math.round(l*100)/100,cost_per_click:Math.round(c*100)/100,cost_per_conversion:Math.round(d*100)/100,roi:Math.round(m*100)/100}}):[]}catch(r){throw console.error("Error fetching promotion comparison:",r),r}})}static getPromotionROI(t){return E(this,null,function*(){try{const r=yield this.getPromotionMetrics(t);if(!r)throw new Error("Promotion not found");const n=r.cost_per_conversion*r.conversions,a=r.revenue_attributed-n,i=Math.ceil(n/25);return{roi:r.roi,revenue_attributed:r.revenue_attributed,cost:n,profit:a,break_even_conversions:i}}catch(r){throw console.error("Error calculating promotion ROI:",r),r}})}static getPromotionTrends(t,r=30){return E(this,null,function*(){try{const n=new Date;n.setDate(n.getDate()-r);const{data:a,error:i}=yield T.from("event_promotions").select("event_id, price_paid, created_at").eq("promoted_by_user_id",t).gte("created_at",n.toISOString()).order("created_at",{ascending:!0});if(i)throw i;if(!a||a.length===0)return[];const o=a.map(f=>f.event_id),l=yield vs.getAllUserInteractions(o,void 0,["event"]),c=yield vs.getAllInterestedUsers(o),d=new Map;for(let f=0;f<r;f++){const u=new Date;u.setDate(u.getDate()-f);const h=u.toISOString().split("T")[0];d.set(h,{impressions:0,clicks:0,conversions:0,spend:0})}for(const f of a){const u=f.created_at.split("T")[0],h=(l==null?void 0:l.filter(w=>w.entity_id===f.event_id))||[],m=(c==null?void 0:c.filter(w=>w.jambase_event_id===f.event_id))||[],v=h.filter(w=>w.event_type==="view").length,g=h.filter(w=>w.event_type==="click").length,x=m.length,_=d.get(u)||{impressions:0,clicks:0,conversions:0,spend:0};d.set(u,{impressions:_.impressions+v,clicks:_.clicks+g,conversions:_.conversions+x,spend:_.spend+(f.price_paid||0)})}return Array.from(d.entries()).map(([f,u])=>D({date:f},u))}catch(n){throw console.error("Error fetching promotion trends:",n),n}})}static getActivePromotions(t=10){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select(`
          *,
          event:jambase_events!event_promotions_event_id_fkey(
            id,
            title,
            artist_name,
            venue_name,
            event_date,
            poster_image_url
          )
        `).eq("promotion_status","active").lte("starts_at",new Date().toISOString()).gte("expires_at",new Date().toISOString()).order("created_at",{ascending:!1}).limit(t);if(n)throw n;return r||[]}catch(r){throw console.error("Error fetching active promotions:",r),r}})}}function CW({userId:e,enabled:t=!0}){const[r,n]=y.useState(!1),[a,i]=y.useState(null);return y.useEffect(()=>{if(!t||!e)return;const o=T.channel("promotion_analytics").on("postgres_changes",{event:"*",schema:"public",table:"event_promotions",filter:`promoted_by_user_id=eq.${e}`},l=>{console.log("Promotion data changed:",l),i(new Date),n(!0),setTimeout(()=>n(!1),5e3)}).on("postgres_changes",{event:"*",schema:"public",table:"jambase_events",filter:"active_promotion_id=is.not.null"},l=>{console.log("Event promotion status changed:",l),i(new Date),n(!0),setTimeout(()=>n(!1),5e3)}).subscribe();return()=>{T.removeChannel(o)}},[e,t]),{isLive:r,lastUpdate:a}}var o_e=Array.isArray,ji=o_e,l_e=typeof na=="object"&&na&&na.Object===Object&&na,PW=l_e,c_e=PW,d_e=typeof self=="object"&&self&&self.Object===Object&&self,u_e=c_e||d_e||Function("return this")(),Gl=u_e,f_e=Gl,h_e=f_e.Symbol,j0=h_e,Z4=j0,TW=Object.prototype,m_e=TW.hasOwnProperty,p_e=TW.toString,Ng=Z4?Z4.toStringTag:void 0;function g_e(e){var t=m_e.call(e,Ng),r=e[Ng];try{e[Ng]=void 0;var n=!0}catch(i){}var a=p_e.call(e);return n&&(t?e[Ng]=r:delete e[Ng]),a}var v_e=g_e,y_e=Object.prototype,x_e=y_e.toString;function __e(e){return x_e.call(e)}var w_e=__e,X4=j0,b_e=v_e,j_e=w_e,N_e="[object Null]",S_e="[object Undefined]",J4=X4?X4.toStringTag:void 0;function k_e(e){return e==null?e===void 0?S_e:N_e:J4&&J4 in Object(e)?b_e(e):j_e(e)}var Hc=k_e;function E_e(e){return e!=null&&typeof e=="object"}var Gc=E_e,C_e=Hc,P_e=Gc,T_e="[object Symbol]";function A_e(e){return typeof e=="symbol"||P_e(e)&&C_e(e)==T_e}var Pp=A_e,R_e=ji,O_e=Pp,M_e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,D_e=/^\w*$/;function I_e(e,t){if(R_e(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||O_e(e)?!0:D_e.test(e)||!M_e.test(e)||t!=null&&e in Object(t)}var RA=I_e;function $_e(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var au=$_e;const Tp=wn(au);var L_e=Hc,F_e=au,z_e="[object AsyncFunction]",B_e="[object Function]",U_e="[object GeneratorFunction]",q_e="[object Proxy]";function V_e(e){if(!F_e(e))return!1;var t=L_e(e);return t==B_e||t==U_e||t==z_e||t==q_e}var OA=V_e;const $r=wn(OA);var W_e=Gl,H_e=W_e["__core-js_shared__"],G_e=H_e,_S=G_e,Q4=function(){var e=/[^.]+$/.exec(_S&&_S.keys&&_S.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Y_e(e){return!!Q4&&Q4 in e}var K_e=Y_e,Z_e=Function.prototype,X_e=Z_e.toString;function J_e(e){if(e!=null){try{return X_e.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var AW=J_e,Q_e=OA,ewe=K_e,twe=au,rwe=AW,nwe=/[\\^$.*+?()[\]{}|]/g,swe=/^\[object .+?Constructor\]$/,awe=Function.prototype,iwe=Object.prototype,owe=awe.toString,lwe=iwe.hasOwnProperty,cwe=RegExp("^"+owe.call(lwe).replace(nwe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function dwe(e){if(!twe(e)||ewe(e))return!1;var t=Q_e(e)?cwe:swe;return t.test(rwe(e))}var uwe=dwe;function fwe(e,t){return e==null?void 0:e[t]}var hwe=fwe,mwe=uwe,pwe=hwe;function gwe(e,t){var r=pwe(e,t);return mwe(r)?r:void 0}var If=gwe,vwe=If,ywe=vwe(Object,"create"),Q1=ywe,e3=Q1;function xwe(){this.__data__=e3?e3(null):{},this.size=0}var _we=xwe;function wwe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var bwe=wwe,jwe=Q1,Nwe="__lodash_hash_undefined__",Swe=Object.prototype,kwe=Swe.hasOwnProperty;function Ewe(e){var t=this.__data__;if(jwe){var r=t[e];return r===Nwe?void 0:r}return kwe.call(t,e)?t[e]:void 0}var Cwe=Ewe,Pwe=Q1,Twe=Object.prototype,Awe=Twe.hasOwnProperty;function Rwe(e){var t=this.__data__;return Pwe?t[e]!==void 0:Awe.call(t,e)}var Owe=Rwe,Mwe=Q1,Dwe="__lodash_hash_undefined__";function Iwe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Mwe&&t===void 0?Dwe:t,this}var $we=Iwe,Lwe=_we,Fwe=bwe,zwe=Cwe,Bwe=Owe,Uwe=$we;function Ap(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ap.prototype.clear=Lwe;Ap.prototype.delete=Fwe;Ap.prototype.get=zwe;Ap.prototype.has=Bwe;Ap.prototype.set=Uwe;var qwe=Ap;function Vwe(){this.__data__=[],this.size=0}var Wwe=Vwe;function Hwe(e,t){return e===t||e!==e&&t!==t}var MA=Hwe,Gwe=MA;function Ywe(e,t){for(var r=e.length;r--;)if(Gwe(e[r][0],t))return r;return-1}var ej=Ywe,Kwe=ej,Zwe=Array.prototype,Xwe=Zwe.splice;function Jwe(e){var t=this.__data__,r=Kwe(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Xwe.call(t,r,1),--this.size,!0}var Qwe=Jwe,ebe=ej;function tbe(e){var t=this.__data__,r=ebe(t,e);return r<0?void 0:t[r][1]}var rbe=tbe,nbe=ej;function sbe(e){return nbe(this.__data__,e)>-1}var abe=sbe,ibe=ej;function obe(e,t){var r=this.__data__,n=ibe(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var lbe=obe,cbe=Wwe,dbe=Qwe,ube=rbe,fbe=abe,hbe=lbe;function Rp(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Rp.prototype.clear=cbe;Rp.prototype.delete=dbe;Rp.prototype.get=ube;Rp.prototype.has=fbe;Rp.prototype.set=hbe;var tj=Rp,mbe=If,pbe=Gl,gbe=mbe(pbe,"Map"),DA=gbe,t3=qwe,vbe=tj,ybe=DA;function xbe(){this.size=0,this.__data__={hash:new t3,map:new(ybe||vbe),string:new t3}}var _be=xbe;function wbe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var bbe=wbe,jbe=bbe;function Nbe(e,t){var r=e.__data__;return jbe(t)?r[typeof t=="string"?"string":"hash"]:r.map}var rj=Nbe,Sbe=rj;function kbe(e){var t=Sbe(this,e).delete(e);return this.size-=t?1:0,t}var Ebe=kbe,Cbe=rj;function Pbe(e){return Cbe(this,e).get(e)}var Tbe=Pbe,Abe=rj;function Rbe(e){return Abe(this,e).has(e)}var Obe=Rbe,Mbe=rj;function Dbe(e,t){var r=Mbe(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var Ibe=Dbe,$be=_be,Lbe=Ebe,Fbe=Tbe,zbe=Obe,Bbe=Ibe;function Op(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Op.prototype.clear=$be;Op.prototype.delete=Lbe;Op.prototype.get=Fbe;Op.prototype.has=zbe;Op.prototype.set=Bbe;var IA=Op,RW=IA,Ube="Expected a function";function $A(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Ube);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new($A.Cache||RW),r}$A.Cache=RW;var OW=$A;const qbe=wn(OW);var Vbe=OW,Wbe=500;function Hbe(e){var t=Vbe(e,function(n){return r.size===Wbe&&r.clear(),n}),r=t.cache;return t}var Gbe=Hbe,Ybe=Gbe,Kbe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zbe=/\\(\\)?/g,Xbe=Ybe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Kbe,function(r,n,a,i){t.push(a?i.replace(Zbe,"$1"):n||r)}),t}),Jbe=Xbe;function Qbe(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var LA=Qbe,r3=j0,e1e=LA,t1e=ji,r1e=Pp,n1e=1/0,n3=r3?r3.prototype:void 0,s3=n3?n3.toString:void 0;function MW(e){if(typeof e=="string")return e;if(t1e(e))return e1e(e,MW)+"";if(r1e(e))return s3?s3.call(e):"";var t=e+"";return t=="0"&&1/e==-n1e?"-0":t}var s1e=MW,a1e=s1e;function i1e(e){return e==null?"":a1e(e)}var DW=i1e,o1e=ji,l1e=RA,c1e=Jbe,d1e=DW;function u1e(e,t){return o1e(e)?e:l1e(e,t)?[e]:c1e(d1e(e))}var IW=u1e,f1e=Pp,h1e=1/0;function m1e(e){if(typeof e=="string"||f1e(e))return e;var t=e+"";return t=="0"&&1/e==-h1e?"-0":t}var nj=m1e,p1e=IW,g1e=nj;function v1e(e,t){t=p1e(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[g1e(t[r++])];return r&&r==n?e:void 0}var FA=v1e,y1e=FA;function x1e(e,t,r){var n=e==null?void 0:y1e(e,t);return n===void 0?r:n}var $W=x1e;const lo=wn($W);function _1e(e){return e==null}var w1e=_1e;const Zr=wn(w1e);var b1e=Hc,j1e=ji,N1e=Gc,S1e="[object String]";function k1e(e){return typeof e=="string"||!j1e(e)&&N1e(e)&&b1e(e)==S1e}var E1e=k1e;const wf=wn(E1e);var LW={exports:{}},Dn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zA=Symbol.for("react.element"),BA=Symbol.for("react.portal"),sj=Symbol.for("react.fragment"),aj=Symbol.for("react.strict_mode"),ij=Symbol.for("react.profiler"),oj=Symbol.for("react.provider"),lj=Symbol.for("react.context"),C1e=Symbol.for("react.server_context"),cj=Symbol.for("react.forward_ref"),dj=Symbol.for("react.suspense"),uj=Symbol.for("react.suspense_list"),fj=Symbol.for("react.memo"),hj=Symbol.for("react.lazy"),P1e=Symbol.for("react.offscreen"),FW;FW=Symbol.for("react.module.reference");function vo(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case zA:switch(e=e.type,e){case sj:case ij:case aj:case dj:case uj:return e;default:switch(e=e&&e.$$typeof,e){case C1e:case lj:case cj:case hj:case fj:case oj:return e;default:return t}}case BA:return t}}}Dn.ContextConsumer=lj;Dn.ContextProvider=oj;Dn.Element=zA;Dn.ForwardRef=cj;Dn.Fragment=sj;Dn.Lazy=hj;Dn.Memo=fj;Dn.Portal=BA;Dn.Profiler=ij;Dn.StrictMode=aj;Dn.Suspense=dj;Dn.SuspenseList=uj;Dn.isAsyncMode=function(){return!1};Dn.isConcurrentMode=function(){return!1};Dn.isContextConsumer=function(e){return vo(e)===lj};Dn.isContextProvider=function(e){return vo(e)===oj};Dn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===zA};Dn.isForwardRef=function(e){return vo(e)===cj};Dn.isFragment=function(e){return vo(e)===sj};Dn.isLazy=function(e){return vo(e)===hj};Dn.isMemo=function(e){return vo(e)===fj};Dn.isPortal=function(e){return vo(e)===BA};Dn.isProfiler=function(e){return vo(e)===ij};Dn.isStrictMode=function(e){return vo(e)===aj};Dn.isSuspense=function(e){return vo(e)===dj};Dn.isSuspenseList=function(e){return vo(e)===uj};Dn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===sj||e===ij||e===aj||e===dj||e===uj||e===P1e||typeof e=="object"&&e!==null&&(e.$$typeof===hj||e.$$typeof===fj||e.$$typeof===oj||e.$$typeof===lj||e.$$typeof===cj||e.$$typeof===FW||e.getModuleId!==void 0)};Dn.typeOf=vo;LW.exports=Dn;var T1e=LW.exports,A1e=Hc,R1e=Gc,O1e="[object Number]";function M1e(e){return typeof e=="number"||R1e(e)&&A1e(e)==O1e}var zW=M1e;const D1e=wn(zW);var I1e=zW;function $1e(e){return I1e(e)&&e!=+e}var L1e=$1e;const Mp=wn(L1e);var qo=function(t){return t===0?0:t>0?1:-1},$u=function(t){return wf(t)&&t.indexOf("%")===t.length-1},bt=function(t){return D1e(t)&&!Mp(t)},F1e=function(t){return Zr(t)},Hs=function(t){return bt(t)||wf(t)},z1e=0,Dp=function(t){var r=++z1e;return"".concat(t||"").concat(r)},bf=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!bt(t)&&!wf(t))return n;var i;if($u(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return Mp(i)&&(i=n),a&&i>r&&(i=r),i},gd=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},B1e=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},ha=function(t,r){return bt(t)&&bt(r)?function(n){return t+n*(r-t)}:function(){return r}};function Ew(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):lo(n,t))===r})}var U1e=function(t,r){return bt(t)&&bt(r)?t-r:wf(t)&&wf(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function nm(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function tE(e){"@babel/helpers - typeof";return tE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tE(e)}var q1e=["viewBox","children"],V1e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],a3=["points","pathLength"],wS={svg:q1e,polygon:a3,polyline:a3},UA=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Cw=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(y.isValidElement(t)&&(n=t.props),!Tp(n))return null;var a={};return Object.keys(n).forEach(function(i){UA.includes(i)&&(a[i]=r||function(o){return n[i](n,o)})}),a},W1e=function(t,r,n){return function(a){return t(r,n,a),null}},Pw=function(t,r,n){if(!Tp(t)||tE(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var o=t[i];UA.includes(i)&&typeof o=="function"&&(a||(a={}),a[i]=W1e(o,r,n))}),a},H1e=["children"],G1e=["children"];function i3(e,t){if(e==null)return{};var r=Y1e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Y1e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function rE(e){"@babel/helpers - typeof";return rE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rE(e)}var o3={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Sc=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},l3=null,bS=null,qA=function e(t){if(t===l3&&Array.isArray(bS))return bS;var r=[];return y.Children.forEach(t,function(n){Zr(n)||(T1e.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),bS=r,l3=t,r};function co(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return Sc(a)}):n=[Sc(t)],qA(e).forEach(function(a){var i=lo(a,"type.displayName")||lo(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function Pi(e,t){var r=co(e,t);return r&&r[0]}var c3=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!bt(n)||n<=0||!bt(a)||a<=0)},K1e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Z1e=function(t){return t&&t.type&&wf(t.type)&&K1e.indexOf(t.type)>=0},BW=function(t){return t&&rE(t)==="object"&&"clipDot"in t},X1e=function(t,r,n,a){var i,o=(i=wS==null?void 0:wS[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!$r(t)&&(a&&o.includes(r)||V1e.includes(r))||n&&UA.includes(r)},qr=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(y.isValidElement(t)&&(a=t.props),!Tp(a))return null;var i={};return Object.keys(a).forEach(function(o){var l;X1e((l=a)===null||l===void 0?void 0:l[o],o,r,n)&&(i[o]=a[o])}),i},nE=function e(t,r){if(t===r)return!0;var n=y.Children.count(t);if(n!==y.Children.count(r))return!1;if(n===0)return!0;if(n===1)return d3(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!d3(i,o))return!1}return!0},d3=function(t,r){if(Zr(t)&&Zr(r))return!0;if(!Zr(t)&&!Zr(r)){var n=t.props||{},a=n.children,i=i3(n,H1e),o=r.props||{},l=o.children,c=i3(o,G1e);return a&&l?nm(i,c)&&nE(a,l):!a&&!l?nm(i,c):!1}return!1},u3=function(t,r){var n=[],a={};return qA(t).forEach(function(i,o){if(Z1e(i))n.push(i);else if(i){var l=Sc(i.type),c=r[l]||{},d=c.handler,f=c.once;if(d&&(!f||!a[l])){var u=d(i,l,o);n.push(u),a[l]=!0}}}),n},J1e=function(t){var r=t&&t.type;return r&&o3[r]?o3[r]:null},Q1e=function(t,r){return qA(r).indexOf(t)},eje=["children","width","height","viewBox","className","style","title","desc"];function sE(){return sE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sE.apply(this,arguments)}function tje(e,t){if(e==null)return{};var r=rje(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rje(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function aE(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,o=e.style,l=e.title,c=e.desc,d=tje(e,eje),f=a||{width:r,height:n,x:0,y:0},u=on("recharts-surface",i);return te.createElement("svg",sE({},qr(d,!0,"svg"),{className:u,width:r,height:n,style:o,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height)}),te.createElement("title",null,l),te.createElement("desc",null,c),t)}var nje=["children","className"];function iE(){return iE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iE.apply(this,arguments)}function sje(e,t){if(e==null)return{};var r=aje(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aje(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Wn=te.forwardRef(function(e,t){var r=e.children,n=e.className,a=sje(e,nje),i=on("recharts-layer",n);return te.createElement("g",iE({className:i},qr(a,!0),{ref:t}),r)}),kc=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function ije(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var oje=ije,lje=oje;function cje(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:lje(e,t,r)}var dje=cje,uje="\\ud800-\\udfff",fje="\\u0300-\\u036f",hje="\\ufe20-\\ufe2f",mje="\\u20d0-\\u20ff",pje=fje+hje+mje,gje="\\ufe0e\\ufe0f",vje="\\u200d",yje=RegExp("["+vje+uje+pje+gje+"]");function xje(e){return yje.test(e)}var UW=xje;function _je(e){return e.split("")}var wje=_je,qW="\\ud800-\\udfff",bje="\\u0300-\\u036f",jje="\\ufe20-\\ufe2f",Nje="\\u20d0-\\u20ff",Sje=bje+jje+Nje,kje="\\ufe0e\\ufe0f",Eje="["+qW+"]",oE="["+Sje+"]",lE="\\ud83c[\\udffb-\\udfff]",Cje="(?:"+oE+"|"+lE+")",VW="[^"+qW+"]",WW="(?:\\ud83c[\\udde6-\\uddff]){2}",HW="[\\ud800-\\udbff][\\udc00-\\udfff]",Pje="\\u200d",GW=Cje+"?",YW="["+kje+"]?",Tje="(?:"+Pje+"(?:"+[VW,WW,HW].join("|")+")"+YW+GW+")*",Aje=YW+GW+Tje,Rje="(?:"+[VW+oE+"?",oE,WW,HW,Eje].join("|")+")",Oje=RegExp(lE+"(?="+lE+")|"+Rje+Aje,"g");function Mje(e){return e.match(Oje)||[]}var Dje=Mje,Ije=wje,$je=UW,Lje=Dje;function Fje(e){return $je(e)?Lje(e):Ije(e)}var zje=Fje,Bje=dje,Uje=UW,qje=zje,Vje=DW;function Wje(e){return function(t){t=Vje(t);var r=Uje(t)?qje(t):void 0,n=r?r[0]:t.charAt(0),a=r?Bje(r,1).join(""):t.slice(1);return n[e]()+a}}var Hje=Wje,Gje=Hje,Yje=Gje("toUpperCase"),Kje=Yje;const mj=wn(Kje);function Un(e){return function(){return e}}const KW=Math.cos,Tw=Math.sin,al=Math.sqrt,Aw=Math.PI,pj=2*Aw,cE=Math.PI,dE=2*cE,wu=1e-6,Zje=dE-wu;function ZW(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Xje(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return ZW;const r=Qp(10,t);return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class Jje{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?ZW:Xje(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=n-t,d=a-r,f=o-t,u=l-r,h=f*f+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>wu)if(!(Math.abs(u*c-d*f)>wu)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-o,v=a-l,g=c*c+d*d,x=m*m+v*v,_=Math.sqrt(g),w=Math.sqrt(h),b=i*Math.tan((cE-Math.acos((g+h-x)/(2*_*w)))/2),N=b/w,S=b/_;Math.abs(N-1)>wu&&this._append`L${t+N*f},${r+N*u}`,this._append`A${i},${i},0,0,${+(u*m>f*v)},${this._x1=t+S*c},${this._y1=r+S*d}`}}arc(t,r,n,a,i,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),d=t+l,f=r+c,u=1^o,h=o?a-i:i-a;this._x1===null?this._append`M${d},${f}`:(Math.abs(this._x1-d)>wu||Math.abs(this._y1-f)>wu)&&this._append`L${d},${f}`,n&&(h<0&&(h=h%dE+dE),h>Zje?this._append`A${n},${n},0,1,${u},${t-l},${r-c}A${n},${n},0,1,${u},${this._x1=d},${this._y1=f}`:h>wu&&this._append`A${n},${n},0,${+(h>=cE)},${u},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function VA(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Jje(t)}function WA(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function XW(e){this._context=e}XW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function gj(e){return new XW(e)}function JW(e){return e[0]}function QW(e){return e[1]}function eH(e,t){var r=Un(!0),n=null,a=gj,i=null,o=VA(l);e=typeof e=="function"?e:e===void 0?JW:Un(e),t=typeof t=="function"?t:t===void 0?QW:Un(t);function l(c){var d,f=(c=WA(c)).length,u,h=!1,m;for(n==null&&(i=a(m=o())),d=0;d<=f;++d)!(d<f&&r(u=c[d],d,c))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(u,d,c),+t(u,d,c));if(m)return i=null,m+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:Un(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:Un(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Un(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function Dx(e,t,r){var n=null,a=Un(!0),i=null,o=gj,l=null,c=VA(d);e=typeof e=="function"?e:e===void 0?JW:Un(+e),t=typeof t=="function"?t:Un(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?QW:Un(+r);function d(u){var h,m,v,g=(u=WA(u)).length,x,_=!1,w,b=new Array(g),N=new Array(g);for(i==null&&(l=o(w=c())),h=0;h<=g;++h){if(!(h<g&&a(x=u[h],h,u))===_)if(_=!_)m=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),v=h-1;v>=m;--v)l.point(b[v],N[v]);l.lineEnd(),l.areaEnd()}_&&(b[h]=+e(x,h,u),N[h]=+t(x,h,u),l.point(n?+n(x,h,u):b[h],r?+r(x,h,u):N[h]))}if(w)return l=null,w+""||null}function f(){return eH().defined(a).curve(o).context(i)}return d.x=function(u){return arguments.length?(e=typeof u=="function"?u:Un(+u),n=null,d):e},d.x0=function(u){return arguments.length?(e=typeof u=="function"?u:Un(+u),d):e},d.x1=function(u){return arguments.length?(n=u==null?null:typeof u=="function"?u:Un(+u),d):n},d.y=function(u){return arguments.length?(t=typeof u=="function"?u:Un(+u),r=null,d):t},d.y0=function(u){return arguments.length?(t=typeof u=="function"?u:Un(+u),d):t},d.y1=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:Un(+u),d):r},d.lineX0=d.lineY0=function(){return f().x(e).y(t)},d.lineY1=function(){return f().x(e).y(r)},d.lineX1=function(){return f().x(n).y(t)},d.defined=function(u){return arguments.length?(a=typeof u=="function"?u:Un(!!u),d):a},d.curve=function(u){return arguments.length?(o=u,i!=null&&(l=o(i)),d):o},d.context=function(u){return arguments.length?(u==null?i=l=null:l=o(i=u),d):i},d}class tH{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Qje(e){return new tH(e,!0)}function eNe(e){return new tH(e,!1)}const HA={draw(e,t){const r=al(t/Aw);e.moveTo(r,0),e.arc(0,0,r,0,pj)}},tNe={draw(e,t){const r=al(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},rH=al(1/3),rNe=rH*2,nNe={draw(e,t){const r=al(t/rNe),n=r*rH;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},sNe={draw(e,t){const r=al(t),n=-r/2;e.rect(n,n,r,r)}},aNe=.8908130915292852,nH=Tw(Aw/10)/Tw(7*Aw/10),iNe=Tw(pj/10)*nH,oNe=-KW(pj/10)*nH,lNe={draw(e,t){const r=al(t*aNe),n=iNe*r,a=oNe*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const o=pj*i/5,l=KW(o),c=Tw(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},jS=al(3),cNe={draw(e,t){const r=-al(t/(jS*3));e.moveTo(0,r*2),e.lineTo(-jS*r,-r),e.lineTo(jS*r,-r),e.closePath()}},Ui=-.5,qi=al(3)/2,uE=1/al(12),dNe=(uE/2+1)*3,uNe={draw(e,t){const r=al(t/dNe),n=r/2,a=r*uE,i=n,o=r*uE+r,l=-i,c=o;e.moveTo(n,a),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(Ui*n-qi*a,qi*n+Ui*a),e.lineTo(Ui*i-qi*o,qi*i+Ui*o),e.lineTo(Ui*l-qi*c,qi*l+Ui*c),e.lineTo(Ui*n+qi*a,Ui*a-qi*n),e.lineTo(Ui*i+qi*o,Ui*o-qi*i),e.lineTo(Ui*l+qi*c,Ui*c-qi*l),e.closePath()}};function fNe(e,t){let r=null,n=VA(a);e=typeof e=="function"?e:Un(e||HA),t=typeof t=="function"?t:Un(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Un(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Un(+i),a):t},a.context=function(i){return arguments.length?(r=i==null?null:i,a):r},a}function Rw(){}function Ow(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function sH(e){this._context=e}sH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ow(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ow(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function hNe(e){return new sH(e)}function aH(e){this._context=e}aH.prototype={areaStart:Rw,areaEnd:Rw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ow(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function mNe(e){return new aH(e)}function iH(e){this._context=e}iH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Ow(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function pNe(e){return new iH(e)}function oH(e){this._context=e}oH.prototype={areaStart:Rw,areaEnd:Rw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function gNe(e){return new oH(e)}function f3(e){return e<0?-1:1}function h3(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),l=(i*a+o*n)/(n+a);return(f3(i)+f3(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function m3(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function NS(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,o-l*r,i,o)}function Mw(e){this._context=e}Mw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:NS(this,this._t0,m3(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,NS(this,m3(this,r=h3(this,e,t)),r);break;default:NS(this,this._t0,r=h3(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function lH(e){this._context=new cH(e)}(lH.prototype=Object.create(Mw.prototype)).point=function(e,t){Mw.prototype.point.call(this,t,e)};function cH(e){this._context=e}cH.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function vNe(e){return new Mw(e)}function yNe(e){return new lH(e)}function dH(e){this._context=e}dH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=p3(e),a=p3(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function p3(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function xNe(e){return new dH(e)}function vj(e,t){this._context=e,this._t=t}vj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function _Ne(e){return new vj(e,.5)}function wNe(e){return new vj(e,0)}function bNe(e){return new vj(e,1)}function $m(e,t){if((o=e.length)>1)for(var r=1,n,a,i=e[t[0]],o,l=i.length;r<o;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function fE(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function jNe(e,t){return e[t]}function NNe(e){const t=[];return t.key=e,t}function SNe(){var e=Un([]),t=fE,r=$m,n=jNe;function a(i){var o=Array.from(e.apply(this,arguments),NNe),l,c=o.length,d=-1,f;for(const u of i)for(l=0,++d;l<c;++l)(o[l][d]=[0,+n(u,o[l].key,d,i)]).data=u;for(l=0,f=WA(t(o));l<c;++l)o[f[l]].index=l;return r(o,f),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Un(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Un(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?fE:typeof i=="function"?i:Un(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i==null?$m:i,a):r},a}function kNe(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}$m(e,t)}}function ENe(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var o=0,l=0;o<a;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}$m(e,t)}}function CNe(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var l=0,c=0,d=0;l<o;++l){for(var f=e[t[l]],u=f[n][1]||0,h=f[n-1][1]||0,m=(u-h)/2,v=0;v<l;++v){var g=e[t[v]],x=g[n][1]||0,_=g[n-1][1]||0;m+=x-_}c+=u,d+=m*u}a[n-1][1]+=a[n-1][0]=r,c&&(r-=d/c)}a[n-1][1]+=a[n-1][0]=r,$m(e,t)}}function Qv(e){"@babel/helpers - typeof";return Qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qv(e)}var PNe=["type","size","sizeType"];function hE(){return hE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hE.apply(this,arguments)}function g3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function v3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g3(Object(r),!0).forEach(function(n){TNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TNe(e,t,r){return t=ANe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ANe(e){var t=RNe(e,"string");return Qv(t)=="symbol"?t:t+""}function RNe(e,t){if(Qv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ONe(e,t){if(e==null)return{};var r=MNe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function MNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var uH={symbolCircle:HA,symbolCross:tNe,symbolDiamond:nNe,symbolSquare:sNe,symbolStar:lNe,symbolTriangle:cNe,symbolWye:uNe},DNe=Math.PI/180,INe=function(t){var r="symbol".concat(mj(t));return uH[r]||HA},$Ne=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*DNe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},LNe=function(t,r){uH["symbol".concat(mj(t))]=r},GA=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,o=t.sizeType,l=o===void 0?"area":o,c=ONe(t,PNe),d=v3(v3({},c),{},{type:n,size:i,sizeType:l}),f=function(){var x=INe(n),_=fNe().type(x).size($Ne(i,l,n));return _()},u=d.className,h=d.cx,m=d.cy,v=qr(d,!0);return h===+h&&m===+m&&i===+i?te.createElement("path",hE({},v,{className:on("recharts-symbols",u),transform:"translate(".concat(h,", ").concat(m,")"),d:f()})):null};GA.registerSymbol=LNe;function Lm(e){"@babel/helpers - typeof";return Lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lm(e)}function mE(){return mE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mE.apply(this,arguments)}function y3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function FNe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y3(Object(r),!0).forEach(function(n){ey(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BNe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hH(n.key),n)}}function UNe(e,t,r){return t&&BNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qNe(e,t,r){return t=Dw(t),VNe(e,fH()?Reflect.construct(t,r||[],Dw(e).constructor):t.apply(e,r))}function VNe(e,t){if(t&&(Lm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WNe(e)}function WNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(fH=function(){return!!e})()}function Dw(e){return Dw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dw(e)}function HNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pE(e,t)}function pE(e,t){return pE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},pE(e,t)}function ey(e,t,r){return t=hH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hH(e){var t=GNe(e,"string");return Lm(t)=="symbol"?t:t+""}function GNe(e,t){if(Lm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vi=32,YA=function(e){function t(){return zNe(this,t),qNe(this,t,arguments)}return HNe(t,e),UNe(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=Vi/2,o=Vi/6,l=Vi/3,c=n.inactive?a:n.color;if(n.type==="plainline")return te.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:Vi,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return te.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(Vi,"M").concat(2*l,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return te.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Vi/8,"h").concat(Vi,"v").concat(Vi*3/4,"h").concat(-Vi,"z"),className:"recharts-legend-icon"});if(te.isValidElement(n.legendIcon)){var d=FNe({},n);return delete d.legendIcon,te.cloneElement(n.legendIcon,d)}return te.createElement(GA,{fill:c,cx:i,cy:i,size:Vi,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,o=a.iconSize,l=a.layout,c=a.formatter,d=a.inactiveColor,f={x:0,y:0,width:Vi,height:Vi},u={display:l==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(m,v){var g=m.formatter||c,x=on(ey(ey({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",m.inactive));if(m.type==="none")return null;var _=$r(m.value)?null:m.value;kc(!$r(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var w=m.inactive?d:m.color;return te.createElement("li",mE({className:x,style:u,key:"legend-item-".concat(v)},Pw(n.props,m,v)),te.createElement(aE,{width:o,height:o,viewBox:f,style:h},n.renderIcon(m)),te.createElement("span",{className:"recharts-legend-item-text",style:{color:w}},g?g(_,m,v):_))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,o=n.align;if(!a||!a.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return te.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(y.PureComponent);ey(YA,"displayName","Legend");ey(YA,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var YNe=tj;function KNe(){this.__data__=new YNe,this.size=0}var ZNe=KNe;function XNe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var JNe=XNe;function QNe(e){return this.__data__.get(e)}var eSe=QNe;function tSe(e){return this.__data__.has(e)}var rSe=tSe,nSe=tj,sSe=DA,aSe=IA,iSe=200;function oSe(e,t){var r=this.__data__;if(r instanceof nSe){var n=r.__data__;if(!sSe||n.length<iSe-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new aSe(n)}return r.set(e,t),this.size=r.size,this}var lSe=oSe,cSe=tj,dSe=ZNe,uSe=JNe,fSe=eSe,hSe=rSe,mSe=lSe;function Ip(e){var t=this.__data__=new cSe(e);this.size=t.size}Ip.prototype.clear=dSe;Ip.prototype.delete=uSe;Ip.prototype.get=fSe;Ip.prototype.has=hSe;Ip.prototype.set=mSe;var mH=Ip,pSe="__lodash_hash_undefined__";function gSe(e){return this.__data__.set(e,pSe),this}var vSe=gSe;function ySe(e){return this.__data__.has(e)}var xSe=ySe,_Se=IA,wSe=vSe,bSe=xSe;function Iw(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new _Se;++t<r;)this.add(e[t])}Iw.prototype.add=Iw.prototype.push=wSe;Iw.prototype.has=bSe;var pH=Iw;function jSe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var gH=jSe;function NSe(e,t){return e.has(t)}var vH=NSe,SSe=pH,kSe=gH,ESe=vH,CSe=1,PSe=2;function TSe(e,t,r,n,a,i){var o=r&CSe,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var d=i.get(e),f=i.get(t);if(d&&f)return d==t&&f==e;var u=-1,h=!0,m=r&PSe?new SSe:void 0;for(i.set(e,t),i.set(t,e);++u<l;){var v=e[u],g=t[u];if(n)var x=o?n(g,v,u,t,e,i):n(v,g,u,e,t,i);if(x!==void 0){if(x)continue;h=!1;break}if(m){if(!kSe(t,function(_,w){if(!ESe(m,w)&&(v===_||a(v,_,r,n,i)))return m.push(w)})){h=!1;break}}else if(!(v===g||a(v,g,r,n,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var yH=TSe,ASe=Gl,RSe=ASe.Uint8Array,OSe=RSe;function MSe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var DSe=MSe;function ISe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var KA=ISe,x3=j0,_3=OSe,$Se=MA,LSe=yH,FSe=DSe,zSe=KA,BSe=1,USe=2,qSe="[object Boolean]",VSe="[object Date]",WSe="[object Error]",HSe="[object Map]",GSe="[object Number]",YSe="[object RegExp]",KSe="[object Set]",ZSe="[object String]",XSe="[object Symbol]",JSe="[object ArrayBuffer]",QSe="[object DataView]",w3=x3?x3.prototype:void 0,SS=w3?w3.valueOf:void 0;function eke(e,t,r,n,a,i,o){switch(r){case QSe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case JSe:return!(e.byteLength!=t.byteLength||!i(new _3(e),new _3(t)));case qSe:case VSe:case GSe:return $Se(+e,+t);case WSe:return e.name==t.name&&e.message==t.message;case YSe:case ZSe:return e==t+"";case HSe:var l=FSe;case KSe:var c=n&BSe;if(l||(l=zSe),e.size!=t.size&&!c)return!1;var d=o.get(e);if(d)return d==t;n|=USe,o.set(e,t);var f=LSe(l(e),l(t),n,a,i,o);return o.delete(e),f;case XSe:if(SS)return SS.call(e)==SS.call(t)}return!1}var tke=eke;function rke(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var xH=rke,nke=xH,ske=ji;function ake(e,t,r){var n=t(e);return ske(e)?n:nke(n,r(e))}var ike=ake;function oke(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}var lke=oke;function cke(){return[]}var dke=cke,uke=lke,fke=dke,hke=Object.prototype,mke=hke.propertyIsEnumerable,b3=Object.getOwnPropertySymbols,pke=b3?function(e){return e==null?[]:(e=Object(e),uke(b3(e),function(t){return mke.call(e,t)}))}:fke,gke=pke;function vke(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var yke=vke,xke=Hc,_ke=Gc,wke="[object Arguments]";function bke(e){return _ke(e)&&xke(e)==wke}var jke=bke,j3=jke,Nke=Gc,_H=Object.prototype,Ske=_H.hasOwnProperty,kke=_H.propertyIsEnumerable,Eke=j3(function(){return arguments}())?j3:function(e){return Nke(e)&&Ske.call(e,"callee")&&!kke.call(e,"callee")},ZA=Eke,$w={exports:{}};function Cke(){return!1}var Pke=Cke;$w.exports;(function(e,t){var r=Gl,n=Pke,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===a,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d})($w,$w.exports);var wH=$w.exports,Tke=9007199254740991,Ake=/^(?:0|[1-9]\d*)$/;function Rke(e,t){var r=typeof e;return t=t==null?Tke:t,!!t&&(r=="number"||r!="symbol"&&Ake.test(e))&&e>-1&&e%1==0&&e<t}var XA=Rke,Oke=9007199254740991;function Mke(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Oke}var JA=Mke,Dke=Hc,Ike=JA,$ke=Gc,Lke="[object Arguments]",Fke="[object Array]",zke="[object Boolean]",Bke="[object Date]",Uke="[object Error]",qke="[object Function]",Vke="[object Map]",Wke="[object Number]",Hke="[object Object]",Gke="[object RegExp]",Yke="[object Set]",Kke="[object String]",Zke="[object WeakMap]",Xke="[object ArrayBuffer]",Jke="[object DataView]",Qke="[object Float32Array]",e2e="[object Float64Array]",t2e="[object Int8Array]",r2e="[object Int16Array]",n2e="[object Int32Array]",s2e="[object Uint8Array]",a2e="[object Uint8ClampedArray]",i2e="[object Uint16Array]",o2e="[object Uint32Array]",Xn={};Xn[Qke]=Xn[e2e]=Xn[t2e]=Xn[r2e]=Xn[n2e]=Xn[s2e]=Xn[a2e]=Xn[i2e]=Xn[o2e]=!0;Xn[Lke]=Xn[Fke]=Xn[Xke]=Xn[zke]=Xn[Jke]=Xn[Bke]=Xn[Uke]=Xn[qke]=Xn[Vke]=Xn[Wke]=Xn[Hke]=Xn[Gke]=Xn[Yke]=Xn[Kke]=Xn[Zke]=!1;function l2e(e){return $ke(e)&&Ike(e.length)&&!!Xn[Dke(e)]}var c2e=l2e;function d2e(e){return function(t){return e(t)}}var bH=d2e,Lw={exports:{}};Lw.exports;(function(e,t){var r=PW,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,o=i&&r.process,l=function(){try{var c=a&&a.require&&a.require("util").types;return c||o&&o.binding&&o.binding("util")}catch(d){}}();e.exports=l})(Lw,Lw.exports);var u2e=Lw.exports,f2e=c2e,h2e=bH,N3=u2e,S3=N3&&N3.isTypedArray,m2e=S3?h2e(S3):f2e,jH=m2e,p2e=yke,g2e=ZA,v2e=ji,y2e=wH,x2e=XA,_2e=jH,w2e=Object.prototype,b2e=w2e.hasOwnProperty;function j2e(e,t){var r=v2e(e),n=!r&&g2e(e),a=!r&&!n&&y2e(e),i=!r&&!n&&!a&&_2e(e),o=r||n||a||i,l=o?p2e(e.length,String):[],c=l.length;for(var d in e)(t||b2e.call(e,d))&&!(o&&(d=="length"||a&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||x2e(d,c)))&&l.push(d);return l}var N2e=j2e,S2e=Object.prototype;function k2e(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||S2e;return e===r}var E2e=k2e;function C2e(e,t){return function(r){return e(t(r))}}var NH=C2e,P2e=NH,T2e=P2e(Object.keys,Object),A2e=T2e,R2e=E2e,O2e=A2e,M2e=Object.prototype,D2e=M2e.hasOwnProperty;function I2e(e){if(!R2e(e))return O2e(e);var t=[];for(var r in Object(e))D2e.call(e,r)&&r!="constructor"&&t.push(r);return t}var $2e=I2e,L2e=OA,F2e=JA;function z2e(e){return e!=null&&F2e(e.length)&&!L2e(e)}var N0=z2e,B2e=N2e,U2e=$2e,q2e=N0;function V2e(e){return q2e(e)?B2e(e):U2e(e)}var yj=V2e,W2e=ike,H2e=gke,G2e=yj;function Y2e(e){return W2e(e,G2e,H2e)}var K2e=Y2e,k3=K2e,Z2e=1,X2e=Object.prototype,J2e=X2e.hasOwnProperty;function Q2e(e,t,r,n,a,i){var o=r&Z2e,l=k3(e),c=l.length,d=k3(t),f=d.length;if(c!=f&&!o)return!1;for(var u=c;u--;){var h=l[u];if(!(o?h in t:J2e.call(t,h)))return!1}var m=i.get(e),v=i.get(t);if(m&&v)return m==t&&v==e;var g=!0;i.set(e,t),i.set(t,e);for(var x=o;++u<c;){h=l[u];var _=e[h],w=t[h];if(n)var b=o?n(w,_,h,t,e,i):n(_,w,h,e,t,i);if(!(b===void 0?_===w||a(_,w,r,n,i):b)){g=!1;break}x||(x=h=="constructor")}if(g&&!x){var N=e.constructor,S=t.constructor;N!=S&&"constructor"in e&&"constructor"in t&&!(typeof N=="function"&&N instanceof N&&typeof S=="function"&&S instanceof S)&&(g=!1)}return i.delete(e),i.delete(t),g}var eEe=Q2e,tEe=If,rEe=Gl,nEe=tEe(rEe,"DataView"),sEe=nEe,aEe=If,iEe=Gl,oEe=aEe(iEe,"Promise"),lEe=oEe,cEe=If,dEe=Gl,uEe=cEe(dEe,"Set"),SH=uEe,fEe=If,hEe=Gl,mEe=fEe(hEe,"WeakMap"),pEe=mEe,gE=sEe,vE=DA,yE=lEe,xE=SH,_E=pEe,kH=Hc,$p=AW,E3="[object Map]",gEe="[object Object]",C3="[object Promise]",P3="[object Set]",T3="[object WeakMap]",A3="[object DataView]",vEe=$p(gE),yEe=$p(vE),xEe=$p(yE),_Ee=$p(xE),wEe=$p(_E),bu=kH;(gE&&bu(new gE(new ArrayBuffer(1)))!=A3||vE&&bu(new vE)!=E3||yE&&bu(yE.resolve())!=C3||xE&&bu(new xE)!=P3||_E&&bu(new _E)!=T3)&&(bu=function(e){var t=kH(e),r=t==gEe?e.constructor:void 0,n=r?$p(r):"";if(n)switch(n){case vEe:return A3;case yEe:return E3;case xEe:return C3;case _Ee:return P3;case wEe:return T3}return t});var bEe=bu,kS=mH,jEe=yH,NEe=tke,SEe=eEe,R3=bEe,O3=ji,M3=wH,kEe=jH,EEe=1,D3="[object Arguments]",I3="[object Array]",Ix="[object Object]",CEe=Object.prototype,$3=CEe.hasOwnProperty;function PEe(e,t,r,n,a,i){var o=O3(e),l=O3(t),c=o?I3:R3(e),d=l?I3:R3(t);c=c==D3?Ix:c,d=d==D3?Ix:d;var f=c==Ix,u=d==Ix,h=c==d;if(h&&M3(e)){if(!M3(t))return!1;o=!0,f=!1}if(h&&!f)return i||(i=new kS),o||kEe(e)?jEe(e,t,r,n,a,i):NEe(e,t,c,r,n,a,i);if(!(r&EEe)){var m=f&&$3.call(e,"__wrapped__"),v=u&&$3.call(t,"__wrapped__");if(m||v){var g=m?e.value():e,x=v?t.value():t;return i||(i=new kS),a(g,x,r,n,i)}}return h?(i||(i=new kS),SEe(e,t,r,n,a,i)):!1}var TEe=PEe,AEe=TEe,L3=Gc;function EH(e,t,r,n,a){return e===t?!0:e==null||t==null||!L3(e)&&!L3(t)?e!==e&&t!==t:AEe(e,t,r,n,EH,a)}var QA=EH,REe=mH,OEe=QA,MEe=1,DEe=2;function IEe(e,t,r,n){var a=r.length,i=a,o=!n;if(e==null)return!i;for(e=Object(e);a--;){var l=r[a];if(o&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++a<i;){l=r[a];var c=l[0],d=e[c],f=l[1];if(o&&l[2]){if(d===void 0&&!(c in e))return!1}else{var u=new REe;if(n)var h=n(d,f,c,e,t,u);if(!(h===void 0?OEe(f,d,MEe|DEe,n,u):h))return!1}}return!0}var $Ee=IEe,LEe=au;function FEe(e){return e===e&&!LEe(e)}var CH=FEe,zEe=CH,BEe=yj;function UEe(e){for(var t=BEe(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,zEe(a)]}return t}var qEe=UEe;function VEe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var PH=VEe,WEe=$Ee,HEe=qEe,GEe=PH;function YEe(e){var t=HEe(e);return t.length==1&&t[0][2]?GEe(t[0][0],t[0][1]):function(r){return r===e||WEe(r,e,t)}}var KEe=YEe;function ZEe(e,t){return e!=null&&t in Object(e)}var XEe=ZEe,JEe=IW,QEe=ZA,eCe=ji,tCe=XA,rCe=JA,nCe=nj;function sCe(e,t,r){t=JEe(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var o=nCe(t[n]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&rCe(a)&&tCe(o,a)&&(eCe(e)||QEe(e)))}var aCe=sCe,iCe=XEe,oCe=aCe;function lCe(e,t){return e!=null&&oCe(e,t,iCe)}var cCe=lCe,dCe=QA,uCe=$W,fCe=cCe,hCe=RA,mCe=CH,pCe=PH,gCe=nj,vCe=1,yCe=2;function xCe(e,t){return hCe(e)&&mCe(t)?pCe(gCe(e),t):function(r){var n=uCe(r,e);return n===void 0&&n===t?fCe(r,e):dCe(t,n,vCe|yCe)}}var _Ce=xCe;function wCe(e){return e}var Lp=wCe;function bCe(e){return function(t){return t==null?void 0:t[e]}}var jCe=bCe,NCe=FA;function SCe(e){return function(t){return NCe(t,e)}}var kCe=SCe,ECe=jCe,CCe=kCe,PCe=RA,TCe=nj;function ACe(e){return PCe(e)?ECe(TCe(e)):CCe(e)}var RCe=ACe,OCe=KEe,MCe=_Ce,DCe=Lp,ICe=ji,$Ce=RCe;function LCe(e){return typeof e=="function"?e:e==null?DCe:typeof e=="object"?ICe(e)?MCe(e[0],e[1]):OCe(e):$Ce(e)}var iu=LCe;function FCe(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var TH=FCe;function zCe(e){return e!==e}var BCe=zCe;function UCe(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var qCe=UCe,VCe=TH,WCe=BCe,HCe=qCe;function GCe(e,t,r){return t===t?HCe(e,t,r):VCe(e,WCe,r)}var YCe=GCe,KCe=YCe;function ZCe(e,t){var r=e==null?0:e.length;return!!r&&KCe(e,t,0)>-1}var XCe=ZCe;function JCe(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var QCe=JCe;function ePe(){}var tPe=ePe,ES=SH,rPe=tPe,nPe=KA,sPe=1/0,aPe=ES&&1/nPe(new ES([,-0]))[1]==sPe?function(e){return new ES(e)}:rPe,iPe=aPe,oPe=pH,lPe=XCe,cPe=QCe,dPe=vH,uPe=iPe,fPe=KA,hPe=200;function mPe(e,t,r){var n=-1,a=lPe,i=e.length,o=!0,l=[],c=l;if(r)o=!1,a=cPe;else if(i>=hPe){var d=t?null:uPe(e);if(d)return fPe(d);o=!1,a=dPe,c=new oPe}else c=t?[]:l;e:for(;++n<i;){var f=e[n],u=t?t(f):f;if(f=r||f!==0?f:0,o&&u===u){for(var h=c.length;h--;)if(c[h]===u)continue e;t&&c.push(u),l.push(f)}else a(c,u,r)||(c!==l&&c.push(u),l.push(f))}return l}var pPe=mPe,gPe=iu,vPe=pPe;function yPe(e,t){return e&&e.length?vPe(e,gPe(t)):[]}var xPe=yPe;const F3=wn(xPe);function AH(e,t,r){return t===!0?F3(e,r):$r(t)?F3(e,t):e}function Fm(e){"@babel/helpers - typeof";return Fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fm(e)}var _Pe=["ref"];function z3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z3(Object(r),!0).forEach(function(n){xj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OH(n.key),n)}}function bPe(e,t,r){return t&&B3(e.prototype,t),r&&B3(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jPe(e,t,r){return t=Fw(t),NPe(e,RH()?Reflect.construct(t,r||[],Fw(e).constructor):t.apply(e,r))}function NPe(e,t){if(t&&(Fm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SPe(e)}function SPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(RH=function(){return!!e})()}function Fw(e){return Fw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fw(e)}function kPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wE(e,t)}function wE(e,t){return wE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},wE(e,t)}function xj(e,t,r){return t=OH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OH(e){var t=EPe(e,"string");return Fm(t)=="symbol"?t:t+""}function EPe(e,t){if(Fm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CPe(e,t){if(e==null)return{};var r=PPe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function PPe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function TPe(e){return e.value}function APe(e,t){if(te.isValidElement(e))return te.cloneElement(e,t);if(typeof e=="function")return te.createElement(e,t);t.ref;var r=CPe(t,_Pe);return te.createElement(YA,r)}var U3=1,tf=function(e){function t(){var r;wPe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=jPe(this,t,[].concat(a)),xj(r,"lastBoundingBox",{width:-1,height:-1}),r}return kPe(t,e),bPe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>U3||Math.abs(a.height-this.lastBoundingBox.height)>U3)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?nc({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,o=a.align,l=a.verticalAlign,c=a.margin,d=a.chartWidth,f=a.chartHeight,u,h;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&i==="vertical"){var m=this.getBBoxSnapshot();u={left:((d||0)-m.width)/2}}else u=o==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var v=this.getBBoxSnapshot();h={top:((f||0)-v.height)/2}}else h=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return nc(nc({},u),h)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,o=a.width,l=a.height,c=a.wrapperStyle,d=a.payloadUniqBy,f=a.payload,u=nc(nc({position:"absolute",width:o||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return te.createElement("div",{className:"recharts-legend-wrapper",style:u,ref:function(m){n.wrapperNode=m}},APe(i,nc(nc({},this.props),{},{payload:AH(f,d,TPe)})))}}],[{key:"getWithHeight",value:function(n,a){var i=nc(nc({},this.defaultProps),n.props),o=i.layout;return o==="vertical"&&bt(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||a}:null}}])}(y.PureComponent);xj(tf,"displayName","Legend");xj(tf,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var q3=j0,RPe=ZA,OPe=ji,V3=q3?q3.isConcatSpreadable:void 0;function MPe(e){return OPe(e)||RPe(e)||!!(V3&&e&&e[V3])}var DPe=MPe,IPe=xH,$Pe=DPe;function MH(e,t,r,n,a){var i=-1,o=e.length;for(r||(r=$Pe),a||(a=[]);++i<o;){var l=e[i];t>0&&r(l)?t>1?MH(l,t-1,r,n,a):IPe(a,l):n||(a[a.length]=l)}return a}var DH=MH;function LPe(e){return function(t,r,n){for(var a=-1,i=Object(t),o=n(t),l=o.length;l--;){var c=o[e?l:++a];if(r(i[c],c,i)===!1)break}return t}}var FPe=LPe,zPe=FPe,BPe=zPe(),UPe=BPe,qPe=UPe,VPe=yj;function WPe(e,t){return e&&qPe(e,t,VPe)}var IH=WPe,HPe=N0;function GPe(e,t){return function(r,n){if(r==null)return r;if(!HPe(r))return e(r,n);for(var a=r.length,i=t?a:-1,o=Object(r);(t?i--:++i<a)&&n(o[i],i,o)!==!1;);return r}}var YPe=GPe,KPe=IH,ZPe=YPe,XPe=ZPe(KPe),e5=XPe,JPe=e5,QPe=N0;function eTe(e,t){var r=-1,n=QPe(e)?Array(e.length):[];return JPe(e,function(a,i,o){n[++r]=t(a,i,o)}),n}var $H=eTe;function tTe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var rTe=tTe,W3=Pp;function nTe(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=W3(e),o=t!==void 0,l=t===null,c=t===t,d=W3(t);if(!l&&!d&&!i&&e>t||i&&o&&c&&!l&&!d||n&&o&&c||!r&&c||!a)return 1;if(!n&&!i&&!d&&e<t||d&&r&&a&&!n&&!i||l&&r&&a||!o&&a||!c)return-1}return 0}var sTe=nTe,aTe=sTe;function iTe(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,o=a.length,l=r.length;++n<o;){var c=aTe(a[n],i[n]);if(c){if(n>=l)return c;var d=r[n];return c*(d=="desc"?-1:1)}}return e.index-t.index}var oTe=iTe,CS=LA,lTe=FA,cTe=iu,dTe=$H,uTe=rTe,fTe=bH,hTe=oTe,mTe=Lp,pTe=ji;function gTe(e,t,r){t.length?t=CS(t,function(i){return pTe(i)?function(o){return lTe(o,i.length===1?i[0]:i)}:i}):t=[mTe];var n=-1;t=CS(t,fTe(cTe));var a=dTe(e,function(i,o,l){var c=CS(t,function(d){return d(i)});return{criteria:c,index:++n,value:i}});return uTe(a,function(i,o){return hTe(i,o,r)})}var vTe=gTe;function yTe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var xTe=yTe,_Te=xTe,H3=Math.max;function wTe(e,t,r){return t=H3(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=H3(n.length-t,0),o=Array(i);++a<i;)o[a]=n[t+a];a=-1;for(var l=Array(t+1);++a<t;)l[a]=n[a];return l[t]=r(o),_Te(e,this,l)}}var bTe=wTe;function jTe(e){return function(){return e}}var NTe=jTe,STe=If,kTe=function(){try{var e=STe(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),LH=kTe,ETe=NTe,G3=LH,CTe=Lp,PTe=G3?function(e,t){return G3(e,"toString",{configurable:!0,enumerable:!1,value:ETe(t),writable:!0})}:CTe,TTe=PTe,ATe=800,RTe=16,OTe=Date.now;function MTe(e){var t=0,r=0;return function(){var n=OTe(),a=RTe-(n-r);if(r=n,a>0){if(++t>=ATe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var DTe=MTe,ITe=TTe,$Te=DTe,LTe=$Te(ITe),FTe=LTe,zTe=Lp,BTe=bTe,UTe=FTe;function qTe(e,t){return UTe(BTe(e,t,zTe),e+"")}var VTe=qTe,WTe=MA,HTe=N0,GTe=XA,YTe=au;function KTe(e,t,r){if(!YTe(r))return!1;var n=typeof t;return(n=="number"?HTe(r)&&GTe(t,r.length):n=="string"&&t in r)?WTe(r[t],e):!1}var _j=KTe,ZTe=DH,XTe=vTe,JTe=VTe,Y3=_j,QTe=JTe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&Y3(e,t[0],t[1])?t=[]:r>2&&Y3(t[0],t[1],t[2])&&(t=[t[0]]),XTe(e,ZTe(t,1),[])}),eAe=QTe;const t5=wn(eAe);function ty(e){"@babel/helpers - typeof";return ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ty(e)}function bE(){return bE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bE.apply(this,arguments)}function tAe(e,t){return aAe(e)||sAe(e,t)||nAe(e,t)||rAe()}function rAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nAe(e,t){if(e){if(typeof e=="string")return K3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K3(e,t)}}function K3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sAe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(f){d=!0,a=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function aAe(e){if(Array.isArray(e))return e}function Z3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function PS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z3(Object(r),!0).forEach(function(n){iAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iAe(e,t,r){return t=oAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oAe(e){var t=lAe(e,"string");return ty(t)=="symbol"?t:t+""}function lAe(e,t){if(ty(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ty(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cAe(e){return Array.isArray(e)&&Hs(e[0])&&Hs(e[1])?e.join(" ~ "):e}var dAe=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,o=t.itemStyle,l=o===void 0?{}:o,c=t.labelStyle,d=c===void 0?{}:c,f=t.payload,u=t.formatter,h=t.itemSorter,m=t.wrapperClassName,v=t.labelClassName,g=t.label,x=t.labelFormatter,_=t.accessibilityLayer,w=_===void 0?!1:_,b=function(){if(f&&f.length){var z={padding:0,margin:0},M=(h?t5(f,h):f).map(function(B,F){if(B.type==="none")return null;var U=PS({display:"block",paddingTop:4,paddingBottom:4,color:B.color||"#000"},l),H=B.formatter||u||cAe,q=B.value,K=B.name,Z=q,ne=K;if(H&&Z!=null&&ne!=null){var Y=H(q,K,B,F,f);if(Array.isArray(Y)){var X=tAe(Y,2);Z=X[0],ne=X[1]}else Z=Y}return te.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(F),style:U},Hs(ne)?te.createElement("span",{className:"recharts-tooltip-item-name"},ne):null,Hs(ne)?te.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,te.createElement("span",{className:"recharts-tooltip-item-value"},Z),te.createElement("span",{className:"recharts-tooltip-item-unit"},B.unit||""))});return te.createElement("ul",{className:"recharts-tooltip-item-list",style:z},M)}return null},N=PS({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),S=PS({margin:0},d),k=!Zr(g),C=k?g:"",A=on("recharts-default-tooltip",m),R=on("recharts-tooltip-label",v);k&&x&&f!==void 0&&f!==null&&(C=x(g,f));var I=w?{role:"status","aria-live":"assertive"}:{};return te.createElement("div",bE({className:A,style:N},I),te.createElement("p",{className:R,style:S},te.isValidElement(C)?C:"".concat(C)),b())};function ry(e){"@babel/helpers - typeof";return ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ry(e)}function $x(e,t,r){return t=uAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uAe(e){var t=fAe(e,"string");return ry(t)=="symbol"?t:t+""}function fAe(e,t){if(ry(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ry(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sg="recharts-tooltip-wrapper",hAe={visibility:"hidden"};function mAe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return on(Sg,$x($x($x($x({},"".concat(Sg,"-right"),bt(r)&&t&&bt(t.x)&&r>=t.x),"".concat(Sg,"-left"),bt(r)&&t&&bt(t.x)&&r<t.x),"".concat(Sg,"-bottom"),bt(n)&&t&&bt(t.y)&&n>=t.y),"".concat(Sg,"-top"),bt(n)&&t&&bt(t.y)&&n<t.y))}function X3(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,o=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,d=e.viewBoxDimension;if(i&&bt(i[n]))return i[n];var f=r[n]-l-a,u=r[n]+a;if(t[n])return o[n]?f:u;if(o[n]){var h=f,m=c[n];return h<m?Math.max(u,c[n]):Math.max(f,c[n])}var v=u+l,g=c[n]+d;return v>g?Math.max(f,c[n]):Math.max(u,c[n])}function pAe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function gAe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,o=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,d,f,u;return o.height>0&&o.width>0&&r?(f=X3({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),u=X3({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),d=pAe({translateX:f,translateY:u,useTranslate3d:l})):d=hAe,{cssProperties:d,cssClasses:mAe({translateX:f,translateY:u,coordinate:r})}}function zm(e){"@babel/helpers - typeof";return zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zm(e)}function J3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Q3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J3(Object(r),!0).forEach(function(n){NE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yAe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zH(n.key),n)}}function xAe(e,t,r){return t&&yAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ae(e,t,r){return t=zw(t),wAe(e,FH()?Reflect.construct(t,r||[],zw(e).constructor):t.apply(e,r))}function wAe(e,t){if(t&&(zm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bAe(e)}function bAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(FH=function(){return!!e})()}function zw(e){return zw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zw(e)}function jAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jE(e,t)}function jE(e,t){return jE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},jE(e,t)}function NE(e,t,r){return t=zH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zH(e){var t=NAe(e,"string");return zm(t)=="symbol"?t:t+""}function NAe(e,t){if(zm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eD=1,SAe=function(e){function t(){var r;vAe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=_Ae(this,t,[].concat(a)),NE(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),NE(r,"handleKeyDown",function(o){if(o.key==="Escape"){var l,c,d,f;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(d=(f=r.props.coordinate)===null||f===void 0?void 0:f.y)!==null&&d!==void 0?d:0}})}}),r}return jAe(t,e),xAe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>eD||Math.abs(n.height-this.state.lastBoundingBox.height)>eD)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,d=a.children,f=a.coordinate,u=a.hasPayload,h=a.isAnimationActive,m=a.offset,v=a.position,g=a.reverseDirection,x=a.useTranslate3d,_=a.viewBox,w=a.wrapperStyle,b=gAe({allowEscapeViewBox:o,coordinate:f,offsetTopLeft:m,position:v,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:x,viewBox:_}),N=b.cssClasses,S=b.cssProperties,k=Q3(Q3({transition:h&&i?"transform ".concat(l,"ms ").concat(c):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&u?"visible":"hidden",position:"absolute",top:0,left:0},w);return te.createElement("div",{tabIndex:-1,className:N,style:k,ref:function(A){n.wrapperNode=A}},d)}}])}(y.PureComponent),kAe=function(){return!(typeof window!="undefined"&&window.document&&window.document.createElement&&window.setTimeout)},Dl={isSsr:kAe(),get:function(t){return Dl[t]},set:function(t,r){if(typeof t=="string")Dl[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(a){Dl[a]=t[a]})}}};function Bm(e){"@babel/helpers - typeof";return Bm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bm(e)}function tD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tD(Object(r),!0).forEach(function(n){r5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CAe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UH(n.key),n)}}function PAe(e,t,r){return t&&CAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function TAe(e,t,r){return t=Bw(t),AAe(e,BH()?Reflect.construct(t,r||[],Bw(e).constructor):t.apply(e,r))}function AAe(e,t){if(t&&(Bm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RAe(e)}function RAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(BH=function(){return!!e})()}function Bw(e){return Bw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bw(e)}function OAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SE(e,t)}function SE(e,t){return SE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},SE(e,t)}function r5(e,t,r){return t=UH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UH(e){var t=MAe(e,"string");return Bm(t)=="symbol"?t:t+""}function MAe(e,t){if(Bm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DAe(e){return e.dataKey}function IAe(e,t){return te.isValidElement(e)?te.cloneElement(e,t):typeof e=="function"?te.createElement(e,t):te.createElement(dAe,t)}var ta=function(e){function t(){return EAe(this,t),TAe(this,t,arguments)}return OAe(t,e),PAe(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,d=a.content,f=a.coordinate,u=a.filterNull,h=a.isAnimationActive,m=a.offset,v=a.payload,g=a.payloadUniqBy,x=a.position,_=a.reverseDirection,w=a.useTranslate3d,b=a.viewBox,N=a.wrapperStyle,S=v!=null?v:[];u&&S.length&&(S=AH(v.filter(function(C){return C.value!=null&&(C.hide!==!0||n.props.includeHidden)}),g,DAe));var k=S.length>0;return te.createElement(SAe,{allowEscapeViewBox:o,animationDuration:l,animationEasing:c,isAnimationActive:h,active:i,coordinate:f,hasPayload:k,offset:m,position:x,reverseDirection:_,useTranslate3d:w,viewBox:b,wrapperStyle:N},IAe(d,rD(rD({},this.props),{},{payload:S})))}}])}(y.PureComponent);r5(ta,"displayName","Tooltip");r5(ta,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Dl.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var $Ae=Gl,LAe=function(){return $Ae.Date.now()},FAe=LAe,zAe=/\s/;function BAe(e){for(var t=e.length;t--&&zAe.test(e.charAt(t)););return t}var UAe=BAe,qAe=UAe,VAe=/^\s+/;function WAe(e){return e&&e.slice(0,qAe(e)+1).replace(VAe,"")}var HAe=WAe,GAe=HAe,nD=au,YAe=Pp,sD=NaN,KAe=/^[-+]0x[0-9a-f]+$/i,ZAe=/^0b[01]+$/i,XAe=/^0o[0-7]+$/i,JAe=parseInt;function QAe(e){if(typeof e=="number")return e;if(YAe(e))return sD;if(nD(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=nD(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=GAe(e);var r=ZAe.test(e);return r||XAe.test(e)?JAe(e.slice(2),r?2:8):KAe.test(e)?sD:+e}var qH=QAe,e5e=au,TS=FAe,aD=qH,t5e="Expected a function",r5e=Math.max,n5e=Math.min;function s5e(e,t,r){var n,a,i,o,l,c,d=0,f=!1,u=!1,h=!0;if(typeof e!="function")throw new TypeError(t5e);t=aD(t)||0,e5e(r)&&(f=!!r.leading,u="maxWait"in r,i=u?r5e(aD(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h);function m(k){var C=n,A=a;return n=a=void 0,d=k,o=e.apply(A,C),o}function v(k){return d=k,l=setTimeout(_,t),f?m(k):o}function g(k){var C=k-c,A=k-d,R=t-C;return u?n5e(R,i-A):R}function x(k){var C=k-c,A=k-d;return c===void 0||C>=t||C<0||u&&A>=i}function _(){var k=TS();if(x(k))return w(k);l=setTimeout(_,g(k))}function w(k){return l=void 0,h&&n?m(k):(n=a=void 0,o)}function b(){l!==void 0&&clearTimeout(l),d=0,n=c=a=l=void 0}function N(){return l===void 0?o:w(TS())}function S(){var k=TS(),C=x(k);if(n=arguments,a=this,c=k,C){if(l===void 0)return v(c);if(u)return clearTimeout(l),l=setTimeout(_,t),m(c)}return l===void 0&&(l=setTimeout(_,t)),o}return S.cancel=b,S.flush=N,S}var a5e=s5e,i5e=a5e,o5e=au,l5e="Expected a function";function c5e(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(l5e);return o5e(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),i5e(e,t,{leading:n,maxWait:t,trailing:a})}var d5e=c5e;const VH=wn(d5e);function ny(e){"@babel/helpers - typeof";return ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ny(e)}function iD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iD(Object(r),!0).forEach(function(n){u5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u5e(e,t,r){return t=f5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f5e(e){var t=h5e(e,"string");return ny(t)=="symbol"?t:t+""}function h5e(e,t){if(ny(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ny(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function m5e(e,t){return y5e(e)||v5e(e,t)||g5e(e,t)||p5e()}function p5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g5e(e,t){if(e){if(typeof e=="string")return oD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oD(e,t)}}function oD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v5e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(f){d=!0,a=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function y5e(e){if(Array.isArray(e))return e}var oc=y.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,o=i===void 0?"100%":i,l=e.height,c=l===void 0?"100%":l,d=e.minWidth,f=d===void 0?0:d,u=e.minHeight,h=e.maxHeight,m=e.children,v=e.debounce,g=v===void 0?0:v,x=e.id,_=e.className,w=e.onResize,b=e.style,N=b===void 0?{}:b,S=y.useRef(null),k=y.useRef();k.current=w,y.useImperativeHandle(t,function(){return Object.defineProperty(S.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),S.current},configurable:!0})});var C=y.useState({containerWidth:a.width,containerHeight:a.height}),A=m5e(C,2),R=A[0],I=A[1],O=y.useCallback(function(M,B){I(function(F){var U=Math.round(M),H=Math.round(B);return F.containerWidth===U&&F.containerHeight===H?F:{containerWidth:U,containerHeight:H}})},[]);y.useEffect(function(){var M=function(K){var Z,ne=K[0].contentRect,Y=ne.width,X=ne.height;O(Y,X),(Z=k.current)===null||Z===void 0||Z.call(k,Y,X)};g>0&&(M=VH(M,g,{trailing:!0,leading:!1}));var B=new ResizeObserver(M),F=S.current.getBoundingClientRect(),U=F.width,H=F.height;return O(U,H),B.observe(S.current),function(){B.disconnect()}},[O,g]);var z=y.useMemo(function(){var M=R.containerWidth,B=R.containerHeight;if(M<0||B<0)return null;kc($u(o)||$u(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,c),kc(!r||r>0,"The aspect(%s) must be greater than zero.",r);var F=$u(o)?M:o,U=$u(c)?B:c;r&&r>0&&(F?U=F/r:U&&(F=U*r),h&&U>h&&(U=h)),kc(F>0||U>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,F,U,o,c,f,u,r);var H=!Array.isArray(m)&&Sc(m.type).endsWith("Chart");return te.Children.map(m,function(q){return te.isValidElement(q)?y.cloneElement(q,Lx({width:F,height:U},H?{style:Lx({height:"100%",width:"100%",maxHeight:U,maxWidth:F},q.props.style)}:{})):q})},[r,m,c,h,u,f,R,o]);return te.createElement("div",{id:x?"".concat(x):void 0,className:on("recharts-responsive-container",_),style:Lx(Lx({},N),{},{width:o,height:c,minWidth:f,minHeight:u,maxHeight:h}),ref:S},z)}),WH=function(t){return null};WH.displayName="Cell";function sy(e){"@babel/helpers - typeof";return sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sy(e)}function lD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lD(Object(r),!0).forEach(function(n){x5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x5e(e,t,r){return t=_5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _5e(e){var t=w5e(e,"string");return sy(t)=="symbol"?t:t+""}function w5e(e,t){if(sy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lh={widthCache:{},cacheCount:0},b5e=2e3,j5e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},cD="recharts_measurement_span";function N5e(e){var t=kE({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var cv=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Dl.isSsr)return{width:0,height:0};var n=N5e(r),a=JSON.stringify({text:t,copyStyle:n});if(lh.widthCache[a])return lh.widthCache[a];try{var i=document.getElementById(cD);i||(i=document.createElement("span"),i.setAttribute("id",cD),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=kE(kE({},j5e),n);Object.assign(i.style,o),i.textContent="".concat(t);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return lh.widthCache[a]=c,++lh.cacheCount>b5e&&(lh.cacheCount=0,lh.widthCache={}),c}catch(d){return{width:0,height:0}}},S5e=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function ay(e){"@babel/helpers - typeof";return ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ay(e)}function Uw(e,t){return P5e(e)||C5e(e,t)||E5e(e,t)||k5e()}function k5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E5e(e,t){if(e){if(typeof e=="string")return dD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dD(e,t)}}function dD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C5e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(f){d=!0,a=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function P5e(e){if(Array.isArray(e))return e}function T5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R5e(n.key),n)}}function A5e(e,t,r){return t&&uD(e.prototype,t),r&&uD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R5e(e){var t=O5e(e,"string");return ay(t)=="symbol"?t:t+""}function O5e(e,t){if(ay(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ay(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var fD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,hD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,M5e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,D5e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,HH={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},I5e=Object.keys(HH),Ih="NaN";function $5e(e,t){return e*HH[t]}var Fx=function(){function e(t,r){T5e(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!M5e.test(r)&&(this.num=NaN,this.unit=""),I5e.includes(r)&&(this.num=$5e(t,r),this.unit="px")}return A5e(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=D5e.exec(r))!==null&&n!==void 0?n:[],i=Uw(a,3),o=i[1],l=i[2];return new e(parseFloat(o),l!=null?l:"")}}])}();function GH(e){if(e.includes(Ih))return Ih;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=fD.exec(t))!==null&&r!==void 0?r:[],a=Uw(n,4),i=a[1],o=a[2],l=a[3],c=Fx.parse(i!=null?i:""),d=Fx.parse(l!=null?l:""),f=o==="*"?c.multiply(d):c.divide(d);if(f.isNaN())return Ih;t=t.replace(fD,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,h=(u=hD.exec(t))!==null&&u!==void 0?u:[],m=Uw(h,4),v=m[1],g=m[2],x=m[3],_=Fx.parse(v!=null?v:""),w=Fx.parse(x!=null?x:""),b=g==="+"?_.add(w):_.subtract(w);if(b.isNaN())return Ih;t=t.replace(hD,b.toString())}return t}var mD=/\(([^()]*)\)/;function L5e(e){for(var t=e;t.includes("(");){var r=mD.exec(t),n=Uw(r,2),a=n[1];t=t.replace(mD,GH(a))}return t}function F5e(e){var t=e.replace(/\s+/g,"");return t=L5e(t),t=GH(t),t}function z5e(e){try{return F5e(e)}catch(t){return Ih}}function AS(e){var t=z5e(e.slice(5,-1));return t===Ih?"":t}var B5e=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],U5e=["dx","dy","angle","className","breakAll"];function EE(){return EE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},EE.apply(this,arguments)}function pD(e,t){if(e==null)return{};var r=q5e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function q5e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function gD(e,t){return G5e(e)||H5e(e,t)||W5e(e,t)||V5e()}function V5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W5e(e,t){if(e){if(typeof e=="string")return vD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vD(e,t)}}function vD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function H5e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(f){d=!0,a=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function G5e(e){if(Array.isArray(e))return e}var YH=/[ \f\n\r\t\v\u2028\u2029]+/,KH=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];Zr(r)||(n?i=r.toString().split(""):i=r.toString().split(YH));var o=i.map(function(c){return{word:c,width:cv(c,a).width}}),l=n?0:cv("",a).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch(c){return null}},Y5e=function(t,r,n,a,i){var o=t.maxLines,l=t.children,c=t.style,d=t.breakAll,f=bt(o),u=l,h=function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return F.reduce(function(U,H){var q=H.word,K=H.width,Z=U[U.length-1];if(Z&&(a==null||i||Z.width+K+n<Number(a)))Z.words.push(q),Z.width+=K+n;else{var ne={words:[q],width:K};U.push(ne)}return U},[])},m=h(r),v=function(F){return F.reduce(function(U,H){return U.width>H.width?U:H})};if(!f)return m;for(var g="",x=function(F){var U=u.slice(0,F),H=KH({breakAll:d,style:c,children:U+g}).wordsWithComputedWidth,q=h(H),K=q.length>o||v(q).width>Number(a);return[K,q]},_=0,w=u.length-1,b=0,N;_<=w&&b<=u.length-1;){var S=Math.floor((_+w)/2),k=S-1,C=x(k),A=gD(C,2),R=A[0],I=A[1],O=x(S),z=gD(O,1),M=z[0];if(!R&&!M&&(_=S+1),R&&M&&(w=S-1),!R&&M){N=I;break}b++}return N||m},yD=function(t){var r=Zr(t)?[]:t.toString().split(YH);return[{words:r}]},K5e=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,o=t.breakAll,l=t.maxLines;if((r||n)&&!Dl.isSsr){var c,d,f=KH({breakAll:o,children:a,style:i});if(f){var u=f.wordsWithComputedWidth,h=f.spaceWidth;c=u,d=h}else return yD(a);return Y5e({breakAll:o,children:a,maxLines:l,style:i},c,d,r,n)}return yD(a)},xD="#808080",qw=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.lineHeight,l=o===void 0?"1em":o,c=t.capHeight,d=c===void 0?"0.71em":c,f=t.scaleToFit,u=f===void 0?!1:f,h=t.textAnchor,m=h===void 0?"start":h,v=t.verticalAnchor,g=v===void 0?"end":v,x=t.fill,_=x===void 0?xD:x,w=pD(t,B5e),b=y.useMemo(function(){return K5e({breakAll:w.breakAll,children:w.children,maxLines:w.maxLines,scaleToFit:u,style:w.style,width:w.width})},[w.breakAll,w.children,w.maxLines,u,w.style,w.width]),N=w.dx,S=w.dy,k=w.angle,C=w.className,A=w.breakAll,R=pD(w,U5e);if(!Hs(n)||!Hs(i))return null;var I=n+(bt(N)?N:0),O=i+(bt(S)?S:0),z;switch(g){case"start":z=AS("calc(".concat(d,")"));break;case"middle":z=AS("calc(".concat((b.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:z=AS("calc(".concat(b.length-1," * -").concat(l,")"));break}var M=[];if(u){var B=b[0].width,F=w.width;M.push("scale(".concat((bt(F)?F/B:1)/B,")"))}return k&&M.push("rotate(".concat(k,", ").concat(I,", ").concat(O,")")),M.length&&(R.transform=M.join(" ")),te.createElement("text",EE({},qr(R,!0),{x:I,y:O,className:on("recharts-text",C),textAnchor:m,fill:_.includes("url")?xD:_}),b.map(function(U,H){var q=U.words.join(A?"":" ");return te.createElement("tspan",{x:I,dy:H===0?z:l,key:"".concat(q,"-").concat(H)},q)}))};function Ld(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Z5e(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function n5(e){let t,r,n;e.length!==2?(t=Ld,r=(l,c)=>Ld(e(l),c),n=(l,c)=>e(l)-c):(t=e===Ld||e===Z5e?e:X5e,r=e,n=e);function a(l,c,d=0,f=l.length){if(d<f){if(t(c,c)!==0)return f;do{const u=d+f>>>1;r(l[u],c)<0?d=u+1:f=u}while(d<f)}return d}function i(l,c,d=0,f=l.length){if(d<f){if(t(c,c)!==0)return f;do{const u=d+f>>>1;r(l[u],c)<=0?d=u+1:f=u}while(d<f)}return d}function o(l,c,d=0,f=l.length){const u=a(l,c,d,f-1);return u>d&&n(l[u-1],c)>-n(l[u],c)?u-1:u}return{left:a,center:o,right:i}}function X5e(){return 0}function ZH(e){return e===null?NaN:+e}function*J5e(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const Q5e=n5(Ld),S0=Q5e.right;n5(ZH).center;class _D extends Map{constructor(t,r=rRe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(wD(this,t))}has(t){return super.has(wD(this,t))}set(t,r){return super.set(eRe(this,t),r)}delete(t){return super.delete(tRe(this,t))}}function wD({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function eRe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function tRe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function rRe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function nRe(e=Ld){if(e===Ld)return XH;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function XH(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const sRe=Math.sqrt(50),aRe=Math.sqrt(10),iRe=Math.sqrt(2);function Vw(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=sRe?10:i>=aRe?5:i>=iRe?2:1;let l,c,d;return a<0?(d=Math.pow(10,-a)/o,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,a)*o,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?Vw(e,t,r*2):[l,c,d]}function CE(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,o]=n?Vw(t,e,r):Vw(e,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(o<0)for(let d=0;d<l;++d)c[d]=(i-d)/-o;else for(let d=0;d<l;++d)c[d]=(i-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(a+d)/-o;else for(let d=0;d<l;++d)c[d]=(a+d)*o;return c}function PE(e,t,r){return t=+t,e=+e,r=+r,Vw(e,t,r)[2]}function TE(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?PE(t,e,r):PE(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function bD(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function jD(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function JH(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?XH:nRe(a);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,f=Math.log(c),u=.5*Math.exp(2*f/3),h=.5*Math.sqrt(f*u*(c-u)/c)*(d-c/2<0?-1:1),m=Math.max(r,Math.floor(t-d*u/c+h)),v=Math.min(n,Math.floor(t+(c-d)*u/c+h));JH(e,t,m,v,a)}const i=e[t];let o=r,l=n;for(kg(e,r,t),a(e[n],i)>0&&kg(e,r,n);o<l;){for(kg(e,o,l),++o,--l;a(e[o],i)<0;)++o;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?kg(e,r,l):(++l,kg(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function kg(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function oRe(e,t,r){if(e=Float64Array.from(J5e(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return jD(e);if(t>=1)return bD(e);var n,a=(n-1)*t,i=Math.floor(a),o=bD(JH(e,i).subarray(0,i+1)),l=jD(e.subarray(i+1));return o+(l-o)*(a-i)}}function lRe(e,t,r=ZH){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return o+(l-o)*(a-i)}}function cRe(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function yo(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Yc(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const AE=Symbol("implicit");function s5(){var e=new _D,t=[],r=[],n=AE;function a(i){let o=e.get(i);if(o===void 0){if(n!==AE)return n;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new _D;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return s5(t,r).unknown(n)},yo.apply(a,arguments),a}function iy(){var e=s5().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,o,l=!1,c=0,d=0,f=.5;delete e.unknown;function u(){var h=t().length,m=a<n,v=m?a:n,g=m?n:a;i=(g-v)/Math.max(1,h-c+d*2),l&&(i=Math.floor(i)),v+=(g-v-i*(h-c))*f,o=i*(1-c),l&&(v=Math.round(v),o=Math.round(o));var x=cRe(h).map(function(_){return v+i*_});return r(m?x.reverse():x)}return e.domain=function(h){return arguments.length?(t(h),u()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,u()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,l=!0,u()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(h){return arguments.length?(l=!!h,u()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,d=+h),u()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),u()):c},e.paddingOuter=function(h){return arguments.length?(d=+h,u()):d},e.align=function(h){return arguments.length?(f=Math.max(0,Math.min(1,h)),u()):f},e.copy=function(){return iy(t(),[n,a]).round(l).paddingInner(c).paddingOuter(d).align(f)},yo.apply(u(),arguments)}function QH(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return QH(t())},e}function dv(){return QH(iy.apply(null,arguments).paddingInner(1))}function a5(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function eG(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function k0(){}var oy=.7,Ww=1/oy,sm="\\s*([+-]?\\d+)\\s*",ly="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Il="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",dRe=/^#([0-9a-f]{3,8})$/,uRe=new RegExp(`^rgb\\(${sm},${sm},${sm}\\)$`),fRe=new RegExp(`^rgb\\(${Il},${Il},${Il}\\)$`),hRe=new RegExp(`^rgba\\(${sm},${sm},${sm},${ly}\\)$`),mRe=new RegExp(`^rgba\\(${Il},${Il},${Il},${ly}\\)$`),pRe=new RegExp(`^hsl\\(${ly},${Il},${Il}\\)$`),gRe=new RegExp(`^hsla\\(${ly},${Il},${Il},${ly}\\)$`),ND={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};a5(k0,cy,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:SD,formatHex:SD,formatHex8:vRe,formatHsl:yRe,formatRgb:kD,toString:kD});function SD(){return this.rgb().formatHex()}function vRe(){return this.rgb().formatHex8()}function yRe(){return tG(this).formatHsl()}function kD(){return this.rgb().formatRgb()}function cy(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=dRe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?ED(t):r===3?new hi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?zx(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?zx(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=uRe.exec(e))?new hi(t[1],t[2],t[3],1):(t=fRe.exec(e))?new hi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=hRe.exec(e))?zx(t[1],t[2],t[3],t[4]):(t=mRe.exec(e))?zx(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=pRe.exec(e))?TD(t[1],t[2]/100,t[3]/100,1):(t=gRe.exec(e))?TD(t[1],t[2]/100,t[3]/100,t[4]):ND.hasOwnProperty(e)?ED(ND[e]):e==="transparent"?new hi(NaN,NaN,NaN,0):null}function ED(e){return new hi(e>>16&255,e>>8&255,e&255,1)}function zx(e,t,r,n){return n<=0&&(e=t=r=NaN),new hi(e,t,r,n)}function xRe(e){return e instanceof k0||(e=cy(e)),e?(e=e.rgb(),new hi(e.r,e.g,e.b,e.opacity)):new hi}function RE(e,t,r,n){return arguments.length===1?xRe(e):new hi(e,t,r,n==null?1:n)}function hi(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}a5(hi,RE,eG(k0,{brighter(e){return e=e==null?Ww:Math.pow(Ww,e),new hi(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?oy:Math.pow(oy,e),new hi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new hi(rf(this.r),rf(this.g),rf(this.b),Hw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:CD,formatHex:CD,formatHex8:_Re,formatRgb:PD,toString:PD}));function CD(){return`#${Lu(this.r)}${Lu(this.g)}${Lu(this.b)}`}function _Re(){return`#${Lu(this.r)}${Lu(this.g)}${Lu(this.b)}${Lu((isNaN(this.opacity)?1:this.opacity)*255)}`}function PD(){const e=Hw(this.opacity);return`${e===1?"rgb(":"rgba("}${rf(this.r)}, ${rf(this.g)}, ${rf(this.b)}${e===1?")":`, ${e})`}`}function Hw(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function rf(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Lu(e){return e=rf(e),(e<16?"0":"")+e.toString(16)}function TD(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new $o(e,t,r,n)}function tG(e){if(e instanceof $o)return new $o(e.h,e.s,e.l,e.opacity);if(e instanceof k0||(e=cy(e)),!e)return new $o;if(e instanceof $o)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=NaN,l=i-a,c=(i+a)/2;return l?(t===i?o=(r-n)/l+(r<n)*6:r===i?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?i+a:2-i-a,o*=60):l=c>0&&c<1?0:o,new $o(o,l,c,e.opacity)}function wRe(e,t,r,n){return arguments.length===1?tG(e):new $o(e,t,r,n==null?1:n)}function $o(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}a5($o,wRe,eG(k0,{brighter(e){return e=e==null?Ww:Math.pow(Ww,e),new $o(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?oy:Math.pow(oy,e),new $o(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new hi(RS(e>=240?e-240:e+120,a,n),RS(e,a,n),RS(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new $o(AD(this.h),Bx(this.s),Bx(this.l),Hw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Hw(this.opacity);return`${e===1?"hsl(":"hsla("}${AD(this.h)}, ${Bx(this.s)*100}%, ${Bx(this.l)*100}%${e===1?")":`, ${e})`}`}}));function AD(e){return e=(e||0)%360,e<0?e+360:e}function Bx(e){return Math.max(0,Math.min(1,e||0))}function RS(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const i5=e=>()=>e;function bRe(e,t){return function(r){return e+r*t}}function jRe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function NRe(e){return(e=+e)==1?rG:function(t,r){return r-t?jRe(t,r,e):i5(isNaN(t)?r:t)}}function rG(e,t){var r=t-e;return r?bRe(e,r):i5(isNaN(e)?t:e)}const RD=function e(t){var r=NRe(t);function n(a,i){var o=r((a=RE(a)).r,(i=RE(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),d=rG(a.opacity,i.opacity);return function(f){return a.r=o(f),a.g=l(f),a.b=c(f),a.opacity=d(f),a+""}}return n.gamma=e,n}(1);function SRe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function kRe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ERe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=Fp(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<n;++o)i[o]=a[o](l);return i}}function CRe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Gw(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function PRe(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Fp(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var OE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,OS=new RegExp(OE.source,"g");function TRe(e){return function(){return e}}function ARe(e){return function(t){return e(t)+""}}function RRe(e,t){var r=OE.lastIndex=OS.lastIndex=0,n,a,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=OE.exec(e))&&(a=OS.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:Gw(n,a)})),r=OS.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?ARe(c[0].x):TRe(t):(t=c.length,function(d){for(var f=0,u;f<t;++f)l[(u=c[f]).i]=u.x(d);return l.join("")})}function Fp(e,t){var r=typeof t,n;return t==null||r==="boolean"?i5(t):(r==="number"?Gw:r==="string"?(n=cy(t))?(t=n,RD):RRe:t instanceof cy?RD:t instanceof Date?CRe:kRe(t)?SRe:Array.isArray(t)?ERe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?PRe:Gw)(e,t)}function o5(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function ORe(e,t){t===void 0&&(t=e,e=Fp);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[l](o-l)}}function MRe(e){return function(){return e}}function Yw(e){return+e}var OD=[0,1];function Ha(e){return e}function ME(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:MRe(isNaN(t)?NaN:.5)}function DRe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function IRe(e,t,r){var n=e[0],a=e[1],i=t[0],o=t[1];return a<n?(n=ME(a,n),i=r(o,i)):(n=ME(n,a),i=r(i,o)),function(l){return i(n(l))}}function $Re(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=ME(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var c=S0(e,l,1,n)-1;return i[c](a[c](l))}}function E0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function wj(){var e=OD,t=OD,r=Fp,n,a,i,o=Ha,l,c,d;function f(){var h=Math.min(e.length,t.length);return o!==Ha&&(o=DRe(e[0],e[h-1])),l=h>2?$Re:IRe,c=d=null,u}function u(h){return h==null||isNaN(h=+h)?i:(c||(c=l(e.map(n),t,r)))(n(o(h)))}return u.invert=function(h){return o(a((d||(d=l(t,e.map(n),Gw)))(h)))},u.domain=function(h){return arguments.length?(e=Array.from(h,Yw),f()):e.slice()},u.range=function(h){return arguments.length?(t=Array.from(h),f()):t.slice()},u.rangeRound=function(h){return t=Array.from(h),r=o5,f()},u.clamp=function(h){return arguments.length?(o=h?!0:Ha,f()):o!==Ha},u.interpolate=function(h){return arguments.length?(r=h,f()):r},u.unknown=function(h){return arguments.length?(i=h,u):i},function(h,m){return n=h,a=m,f()}}function l5(){return wj()(Ha,Ha)}function LRe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Kw(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Um(e){return e=Kw(Math.abs(e)),e?e[1]:NaN}function FRe(e,t){return function(r,n){for(var a=r.length,i=[],o=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function zRe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var BRe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function dy(e){if(!(t=BRe.exec(e)))throw new Error("invalid format: "+e);var t;return new c5({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}dy.prototype=c5.prototype;function c5(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}c5.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function URe(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var nG;function qRe(e,t){var r=Kw(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(nG=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Kw(e,Math.max(0,t+i-1))[0]}function MD(e,t){var r=Kw(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const DD={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:LRe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>MD(e*100,t),r:MD,s:qRe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function ID(e){return e}var $D=Array.prototype.map,LD=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function VRe(e){var t=e.grouping===void 0||e.thousands===void 0?ID:FRe($D.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?ID:zRe($D.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(u){u=dy(u);var h=u.fill,m=u.align,v=u.sign,g=u.symbol,x=u.zero,_=u.width,w=u.comma,b=u.precision,N=u.trim,S=u.type;S==="n"?(w=!0,S="g"):DD[S]||(b===void 0&&(b=12),N=!0,S="g"),(x||h==="0"&&m==="=")&&(x=!0,h="0",m="=");var k=g==="$"?r:g==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",C=g==="$"?n:/[%p]/.test(S)?o:"",A=DD[S],R=/[defgprs%]/.test(S);b=b===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function I(O){var z=k,M=C,B,F,U;if(S==="c")M=A(O)+M,O="";else{O=+O;var H=O<0||1/O<0;if(O=isNaN(O)?c:A(Math.abs(O),b),N&&(O=URe(O)),H&&+O==0&&v!=="+"&&(H=!1),z=(H?v==="("?v:l:v==="-"||v==="("?"":v)+z,M=(S==="s"?LD[8+nG/3]:"")+M+(H&&v==="("?")":""),R){for(B=-1,F=O.length;++B<F;)if(U=O.charCodeAt(B),48>U||U>57){M=(U===46?a+O.slice(B+1):O.slice(B))+M,O=O.slice(0,B);break}}}w&&!x&&(O=t(O,1/0));var q=z.length+O.length+M.length,K=q<_?new Array(_-q+1).join(h):"";switch(w&&x&&(O=t(K+O,K.length?_-M.length:1/0),K=""),m){case"<":O=z+O+M+K;break;case"=":O=z+K+O+M;break;case"^":O=K.slice(0,q=K.length>>1)+z+O+M+K.slice(q);break;default:O=K+z+O+M;break}return i(O)}return I.toString=function(){return u+""},I}function f(u,h){var m=d((u=dy(u),u.type="f",u)),v=Math.max(-8,Math.min(8,Math.floor(Um(h)/3)))*3,g=Math.pow(10,-v),x=LD[8+v/3];return function(_){return m(g*_)+x}}return{format:d,formatPrefix:f}}var Ux,d5,sG;WRe({thousands:",",grouping:[3],currency:["$",""]});function WRe(e){return Ux=VRe(e),d5=Ux.format,sG=Ux.formatPrefix,Ux}function HRe(e){return Math.max(0,-Um(Math.abs(e)))}function GRe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Um(t)/3)))*3-Um(Math.abs(e)))}function YRe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Um(t)-Um(e))+1}function aG(e,t,r,n){var a=TE(e,t,r),i;switch(n=dy(n==null?",f":n),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=GRe(a,o))&&(n.precision=i),sG(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=YRe(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=HRe(a))&&(n.precision=i-(n.type==="%")*2);break}}return d5(n)}function ou(e){var t=e.domain;return e.ticks=function(r){var n=t();return CE(n[0],n[n.length-1],r==null?10:r)},e.tickFormat=function(r,n){var a=t();return aG(a[0],a[a.length-1],r==null?10:r,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,o=n[a],l=n[i],c,d,f=10;for(l<o&&(d=o,o=l,l=d,d=a,a=i,i=d);f-- >0;){if(d=PE(o,l,r),d===c)return n[a]=o,n[i]=l,t(n);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function Zw(){var e=l5();return e.copy=function(){return E0(e,Zw())},yo.apply(e,arguments),ou(e)}function iG(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Yw),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return iG(e).unknown(t)},e=arguments.length?Array.from(e,Yw):[0,1],ou(r)}function oG(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),e[r]=t.floor(a),e[n]=t.ceil(i),e}function FD(e){return Math.log(e)}function zD(e){return Math.exp(e)}function KRe(e){return-Math.log(-e)}function ZRe(e){return-Math.exp(-e)}function XRe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function JRe(e){return e===10?XRe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function QRe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function BD(e){return(t,r)=>-e(-t,r)}function u5(e){const t=e(FD,zD),r=t.domain;let n=10,a,i;function o(){return a=QRe(n),i=JRe(n),r()[0]<0?(a=BD(a),i=BD(i),e(KRe,ZRe)):e(FD,zD),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let d=c[0],f=c[c.length-1];const u=f<d;u&&([d,f]=[f,d]);let h=a(d),m=a(f),v,g;const x=l==null?10:+l;let _=[];if(!(n%1)&&m-h<x){if(h=Math.floor(h),m=Math.ceil(m),d>0){for(;h<=m;++h)for(v=1;v<n;++v)if(g=h<0?v/i(-h):v*i(h),!(g<d)){if(g>f)break;_.push(g)}}else for(;h<=m;++h)for(v=n-1;v>=1;--v)if(g=h>0?v/i(-h):v*i(h),!(g<d)){if(g>f)break;_.push(g)}_.length*2<x&&(_=CE(d,f,x))}else _=CE(h,m,Math.min(m-h,x)).map(i);return u?_.reverse():_},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=dy(c)).precision==null&&(c.trim=!0),c=d5(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return f=>{let u=f/i(Math.round(a(f)));return u*n<n-.5&&(u*=n),u<=d?c(f):""}},t.nice=()=>r(oG(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function lG(){const e=u5(wj()).domain([1,10]);return e.copy=()=>E0(e,lG()).base(e.base()),yo.apply(e,arguments),e}function UD(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function qD(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function f5(e){var t=1,r=e(UD(t),qD(t));return r.constant=function(n){return arguments.length?e(UD(t=+n),qD(t)):t},ou(r)}function cG(){var e=f5(wj());return e.copy=function(){return E0(e,cG()).constant(e.constant())},yo.apply(e,arguments)}function VD(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function eOe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function tOe(e){return e<0?-e*e:e*e}function h5(e){var t=e(Ha,Ha),r=1;function n(){return r===1?e(Ha,Ha):r===.5?e(eOe,tOe):e(VD(r),VD(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},ou(t)}function m5(){var e=h5(wj());return e.copy=function(){return E0(e,m5()).exponent(e.exponent())},yo.apply(e,arguments),e}function rOe(){return m5.apply(null,arguments).exponent(.5)}function WD(e){return Math.sign(e)*e*e}function nOe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function dG(){var e=l5(),t=[0,1],r=!1,n;function a(i){var o=nOe(e(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return e.invert(WD(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Yw)).map(WD)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return dG(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},yo.apply(a,arguments),ou(a)}function uG(){var e=[],t=[],r=[],n;function a(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=lRe(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?n:t[S0(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Ld),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return uG().domain(e).range(t).unknown(n)},yo.apply(i,arguments)}function fG(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function o(c){return c!=null&&c<=c?a[S0(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var d=a.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return fG().domain([e,t]).range(a).unknown(i)},yo.apply(ou(o),arguments)}function hG(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[S0(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return hG().domain(e).range(t).unknown(r)},yo.apply(a,arguments)}const MS=new Date,DS=new Date;function Zs(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),l=a.ceil(i);return i-o<l-i?o:l},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<o);return c},a.filter=i=>Zs(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>(MS.setTime(+i),DS.setTime(+o),e(MS),e(DS),Math.floor(r(MS,DS))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const Xw=Zs(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Xw.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Zs(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Xw);Xw.range;const _c=1e3,no=_c*60,wc=no*60,Lc=wc*24,p5=Lc*7,HD=Lc*30,IS=Lc*365,Fu=Zs(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*_c)},(e,t)=>(t-e)/_c,e=>e.getUTCSeconds());Fu.range;const g5=Zs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*_c)},(e,t)=>{e.setTime(+e+t*no)},(e,t)=>(t-e)/no,e=>e.getMinutes());g5.range;const v5=Zs(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*no)},(e,t)=>(t-e)/no,e=>e.getUTCMinutes());v5.range;const y5=Zs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*_c-e.getMinutes()*no)},(e,t)=>{e.setTime(+e+t*wc)},(e,t)=>(t-e)/wc,e=>e.getHours());y5.range;const x5=Zs(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*wc)},(e,t)=>(t-e)/wc,e=>e.getUTCHours());x5.range;const C0=Zs(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*no)/Lc,e=>e.getDate()-1);C0.range;const bj=Zs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Lc,e=>e.getUTCDate()-1);bj.range;const mG=Zs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Lc,e=>Math.floor(e/Lc));mG.range;function $f(e){return Zs(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*no)/p5)}const jj=$f(0),Jw=$f(1),sOe=$f(2),aOe=$f(3),qm=$f(4),iOe=$f(5),oOe=$f(6);jj.range;Jw.range;sOe.range;aOe.range;qm.range;iOe.range;oOe.range;function Lf(e){return Zs(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/p5)}const Nj=Lf(0),Qw=Lf(1),lOe=Lf(2),cOe=Lf(3),Vm=Lf(4),dOe=Lf(5),uOe=Lf(6);Nj.range;Qw.range;lOe.range;cOe.range;Vm.range;dOe.range;uOe.range;const _5=Zs(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());_5.range;const w5=Zs(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());w5.range;const Fc=Zs(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Fc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Zs(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Fc.range;const zc=Zs(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());zc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Zs(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});zc.range;function pG(e,t,r,n,a,i){const o=[[Fu,1,_c],[Fu,5,5*_c],[Fu,15,15*_c],[Fu,30,30*_c],[i,1,no],[i,5,5*no],[i,15,15*no],[i,30,30*no],[a,1,wc],[a,3,3*wc],[a,6,6*wc],[a,12,12*wc],[n,1,Lc],[n,2,2*Lc],[r,1,p5],[t,1,HD],[t,3,3*HD],[e,1,IS]];function l(d,f,u){const h=f<d;h&&([d,f]=[f,d]);const m=u&&typeof u.range=="function"?u:c(d,f,u),v=m?m.range(d,+f+1):[];return h?v.reverse():v}function c(d,f,u){const h=Math.abs(f-d)/u,m=n5(([,,x])=>x).right(o,h);if(m===o.length)return e.every(TE(d/IS,f/IS,u));if(m===0)return Xw.every(Math.max(TE(d,f,u),1));const[v,g]=o[h/o[m-1][2]<o[m][2]/h?m-1:m];return v.every(g)}return[l,c]}const[fOe,hOe]=pG(zc,w5,Nj,mG,x5,v5),[mOe,pOe]=pG(Fc,_5,jj,C0,y5,g5);function $S(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function LS(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Eg(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function gOe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,d=Cg(a),f=Pg(a),u=Cg(i),h=Pg(i),m=Cg(o),v=Pg(o),g=Cg(l),x=Pg(l),_=Cg(c),w=Pg(c),b={a:H,A:q,b:K,B:Z,c:null,d:JD,e:JD,f:FOe,g:KOe,G:XOe,H:IOe,I:$Oe,j:LOe,L:gG,m:zOe,M:BOe,p:ne,q:Y,Q:tI,s:rI,S:UOe,u:qOe,U:VOe,V:WOe,w:HOe,W:GOe,x:null,X:null,y:YOe,Y:ZOe,Z:JOe,"%":eI},N={a:X,A:se,b:de,B:_e,c:null,d:QD,e:QD,f:rMe,g:fMe,G:mMe,H:QOe,I:eMe,j:tMe,L:yG,m:nMe,M:sMe,p:xe,q:Q,Q:tI,s:rI,S:aMe,u:iMe,U:oMe,V:lMe,w:cMe,W:dMe,x:null,X:null,y:uMe,Y:hMe,Z:pMe,"%":eI},S={a:I,A:O,b:z,B:M,c:B,d:ZD,e:ZD,f:ROe,g:KD,G:YD,H:XD,I:XD,j:COe,L:AOe,m:EOe,M:POe,p:R,q:kOe,Q:MOe,s:DOe,S:TOe,u:wOe,U:bOe,V:jOe,w:_Oe,W:NOe,x:F,X:U,y:KD,Y:YD,Z:SOe,"%":OOe};b.x=k(r,b),b.X=k(n,b),b.c=k(t,b),N.x=k(r,N),N.X=k(n,N),N.c=k(t,N);function k(oe,ie){return function(ee){var G=[],J=-1,ae=0,fe=oe.length,we,ve,me;for(ee instanceof Date||(ee=new Date(+ee));++J<fe;)oe.charCodeAt(J)===37&&(G.push(oe.slice(ae,J)),(ve=GD[we=oe.charAt(++J)])!=null?we=oe.charAt(++J):ve=we==="e"?" ":"0",(me=ie[we])&&(we=me(ee,ve)),G.push(we),ae=J+1);return G.push(oe.slice(ae,J)),G.join("")}}function C(oe,ie){return function(ee){var G=Eg(1900,void 0,1),J=A(G,oe,ee+="",0),ae,fe;if(J!=ee.length)return null;if("Q"in G)return new Date(G.Q);if("s"in G)return new Date(G.s*1e3+("L"in G?G.L:0));if(ie&&!("Z"in G)&&(G.Z=0),"p"in G&&(G.H=G.H%12+G.p*12),G.m===void 0&&(G.m="q"in G?G.q:0),"V"in G){if(G.V<1||G.V>53)return null;"w"in G||(G.w=1),"Z"in G?(ae=LS(Eg(G.y,0,1)),fe=ae.getUTCDay(),ae=fe>4||fe===0?Qw.ceil(ae):Qw(ae),ae=bj.offset(ae,(G.V-1)*7),G.y=ae.getUTCFullYear(),G.m=ae.getUTCMonth(),G.d=ae.getUTCDate()+(G.w+6)%7):(ae=$S(Eg(G.y,0,1)),fe=ae.getDay(),ae=fe>4||fe===0?Jw.ceil(ae):Jw(ae),ae=C0.offset(ae,(G.V-1)*7),G.y=ae.getFullYear(),G.m=ae.getMonth(),G.d=ae.getDate()+(G.w+6)%7)}else("W"in G||"U"in G)&&("w"in G||(G.w="u"in G?G.u%7:"W"in G?1:0),fe="Z"in G?LS(Eg(G.y,0,1)).getUTCDay():$S(Eg(G.y,0,1)).getDay(),G.m=0,G.d="W"in G?(G.w+6)%7+G.W*7-(fe+5)%7:G.w+G.U*7-(fe+6)%7);return"Z"in G?(G.H+=G.Z/100|0,G.M+=G.Z%100,LS(G)):$S(G)}}function A(oe,ie,ee,G){for(var J=0,ae=ie.length,fe=ee.length,we,ve;J<ae;){if(G>=fe)return-1;if(we=ie.charCodeAt(J++),we===37){if(we=ie.charAt(J++),ve=S[we in GD?ie.charAt(J++):we],!ve||(G=ve(oe,ee,G))<0)return-1}else if(we!=ee.charCodeAt(G++))return-1}return G}function R(oe,ie,ee){var G=d.exec(ie.slice(ee));return G?(oe.p=f.get(G[0].toLowerCase()),ee+G[0].length):-1}function I(oe,ie,ee){var G=m.exec(ie.slice(ee));return G?(oe.w=v.get(G[0].toLowerCase()),ee+G[0].length):-1}function O(oe,ie,ee){var G=u.exec(ie.slice(ee));return G?(oe.w=h.get(G[0].toLowerCase()),ee+G[0].length):-1}function z(oe,ie,ee){var G=_.exec(ie.slice(ee));return G?(oe.m=w.get(G[0].toLowerCase()),ee+G[0].length):-1}function M(oe,ie,ee){var G=g.exec(ie.slice(ee));return G?(oe.m=x.get(G[0].toLowerCase()),ee+G[0].length):-1}function B(oe,ie,ee){return A(oe,t,ie,ee)}function F(oe,ie,ee){return A(oe,r,ie,ee)}function U(oe,ie,ee){return A(oe,n,ie,ee)}function H(oe){return o[oe.getDay()]}function q(oe){return i[oe.getDay()]}function K(oe){return c[oe.getMonth()]}function Z(oe){return l[oe.getMonth()]}function ne(oe){return a[+(oe.getHours()>=12)]}function Y(oe){return 1+~~(oe.getMonth()/3)}function X(oe){return o[oe.getUTCDay()]}function se(oe){return i[oe.getUTCDay()]}function de(oe){return c[oe.getUTCMonth()]}function _e(oe){return l[oe.getUTCMonth()]}function xe(oe){return a[+(oe.getUTCHours()>=12)]}function Q(oe){return 1+~~(oe.getUTCMonth()/3)}return{format:function(oe){var ie=k(oe+="",b);return ie.toString=function(){return oe},ie},parse:function(oe){var ie=C(oe+="",!1);return ie.toString=function(){return oe},ie},utcFormat:function(oe){var ie=k(oe+="",N);return ie.toString=function(){return oe},ie},utcParse:function(oe){var ie=C(oe+="",!0);return ie.toString=function(){return oe},ie}}}var GD={"-":"",_:" ",0:"0"},oa=/^\s*\d+/,vOe=/^%/,yOe=/[\\^$*+?|[\]().{}]/g;function kn(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function xOe(e){return e.replace(yOe,"\\$&")}function Cg(e){return new RegExp("^(?:"+e.map(xOe).join("|")+")","i")}function Pg(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function _Oe(e,t,r){var n=oa.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function wOe(e,t,r){var n=oa.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function bOe(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function jOe(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function NOe(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function YD(e,t,r){var n=oa.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function KD(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function SOe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function kOe(e,t,r){var n=oa.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function EOe(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function ZD(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function COe(e,t,r){var n=oa.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function XD(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function POe(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function TOe(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function AOe(e,t,r){var n=oa.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function ROe(e,t,r){var n=oa.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function OOe(e,t,r){var n=vOe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function MOe(e,t,r){var n=oa.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function DOe(e,t,r){var n=oa.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function JD(e,t){return kn(e.getDate(),t,2)}function IOe(e,t){return kn(e.getHours(),t,2)}function $Oe(e,t){return kn(e.getHours()%12||12,t,2)}function LOe(e,t){return kn(1+C0.count(Fc(e),e),t,3)}function gG(e,t){return kn(e.getMilliseconds(),t,3)}function FOe(e,t){return gG(e,t)+"000"}function zOe(e,t){return kn(e.getMonth()+1,t,2)}function BOe(e,t){return kn(e.getMinutes(),t,2)}function UOe(e,t){return kn(e.getSeconds(),t,2)}function qOe(e){var t=e.getDay();return t===0?7:t}function VOe(e,t){return kn(jj.count(Fc(e)-1,e),t,2)}function vG(e){var t=e.getDay();return t>=4||t===0?qm(e):qm.ceil(e)}function WOe(e,t){return e=vG(e),kn(qm.count(Fc(e),e)+(Fc(e).getDay()===4),t,2)}function HOe(e){return e.getDay()}function GOe(e,t){return kn(Jw.count(Fc(e)-1,e),t,2)}function YOe(e,t){return kn(e.getFullYear()%100,t,2)}function KOe(e,t){return e=vG(e),kn(e.getFullYear()%100,t,2)}function ZOe(e,t){return kn(e.getFullYear()%1e4,t,4)}function XOe(e,t){var r=e.getDay();return e=r>=4||r===0?qm(e):qm.ceil(e),kn(e.getFullYear()%1e4,t,4)}function JOe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+kn(t/60|0,"0",2)+kn(t%60,"0",2)}function QD(e,t){return kn(e.getUTCDate(),t,2)}function QOe(e,t){return kn(e.getUTCHours(),t,2)}function eMe(e,t){return kn(e.getUTCHours()%12||12,t,2)}function tMe(e,t){return kn(1+bj.count(zc(e),e),t,3)}function yG(e,t){return kn(e.getUTCMilliseconds(),t,3)}function rMe(e,t){return yG(e,t)+"000"}function nMe(e,t){return kn(e.getUTCMonth()+1,t,2)}function sMe(e,t){return kn(e.getUTCMinutes(),t,2)}function aMe(e,t){return kn(e.getUTCSeconds(),t,2)}function iMe(e){var t=e.getUTCDay();return t===0?7:t}function oMe(e,t){return kn(Nj.count(zc(e)-1,e),t,2)}function xG(e){var t=e.getUTCDay();return t>=4||t===0?Vm(e):Vm.ceil(e)}function lMe(e,t){return e=xG(e),kn(Vm.count(zc(e),e)+(zc(e).getUTCDay()===4),t,2)}function cMe(e){return e.getUTCDay()}function dMe(e,t){return kn(Qw.count(zc(e)-1,e),t,2)}function uMe(e,t){return kn(e.getUTCFullYear()%100,t,2)}function fMe(e,t){return e=xG(e),kn(e.getUTCFullYear()%100,t,2)}function hMe(e,t){return kn(e.getUTCFullYear()%1e4,t,4)}function mMe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Vm(e):Vm.ceil(e),kn(e.getUTCFullYear()%1e4,t,4)}function pMe(){return"+0000"}function eI(){return"%"}function tI(e){return+e}function rI(e){return Math.floor(+e/1e3)}var ch,_G,wG;gMe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function gMe(e){return ch=gOe(e),_G=ch.format,ch.parse,wG=ch.utcFormat,ch.utcParse,ch}function vMe(e){return new Date(e)}function yMe(e){return e instanceof Date?+e:+new Date(+e)}function b5(e,t,r,n,a,i,o,l,c,d){var f=l5(),u=f.invert,h=f.domain,m=d(".%L"),v=d(":%S"),g=d("%I:%M"),x=d("%I %p"),_=d("%a %d"),w=d("%b %d"),b=d("%B"),N=d("%Y");function S(k){return(c(k)<k?m:l(k)<k?v:o(k)<k?g:i(k)<k?x:n(k)<k?a(k)<k?_:w:r(k)<k?b:N)(k)}return f.invert=function(k){return new Date(u(k))},f.domain=function(k){return arguments.length?h(Array.from(k,yMe)):h().map(vMe)},f.ticks=function(k){var C=h();return e(C[0],C[C.length-1],k==null?10:k)},f.tickFormat=function(k,C){return C==null?S:d(C)},f.nice=function(k){var C=h();return(!k||typeof k.range!="function")&&(k=t(C[0],C[C.length-1],k==null?10:k)),k?h(oG(C,k)):f},f.copy=function(){return E0(f,b5(e,t,r,n,a,i,o,l,c,d))},f}function xMe(){return yo.apply(b5(mOe,pOe,Fc,_5,jj,C0,y5,g5,Fu,_G).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function _Me(){return yo.apply(b5(fOe,hOe,zc,w5,Nj,bj,x5,v5,Fu,wG).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Sj(){var e=0,t=1,r,n,a,i,o=Ha,l=!1,c;function d(u){return u==null||isNaN(u=+u)?c:o(a===0?.5:(u=(i(u)-r)*a,l?Math.max(0,Math.min(1,u)):u))}d.domain=function(u){return arguments.length?([e,t]=u,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(u){return arguments.length?(l=!!u,d):l},d.interpolator=function(u){return arguments.length?(o=u,d):o};function f(u){return function(h){var m,v;return arguments.length?([m,v]=h,o=u(m,v),d):[o(0),o(1)]}}return d.range=f(Fp),d.rangeRound=f(o5),d.unknown=function(u){return arguments.length?(c=u,d):c},function(u){return i=u,r=u(e),n=u(t),a=r===n?0:1/(n-r),d}}function lu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function bG(){var e=ou(Sj()(Ha));return e.copy=function(){return lu(e,bG())},Yc.apply(e,arguments)}function jG(){var e=u5(Sj()).domain([1,10]);return e.copy=function(){return lu(e,jG()).base(e.base())},Yc.apply(e,arguments)}function NG(){var e=f5(Sj());return e.copy=function(){return lu(e,NG()).constant(e.constant())},Yc.apply(e,arguments)}function j5(){var e=h5(Sj());return e.copy=function(){return lu(e,j5()).exponent(e.exponent())},Yc.apply(e,arguments)}function wMe(){return j5.apply(null,arguments).exponent(.5)}function SG(){var e=[],t=Ha;function r(n){if(n!=null&&!isNaN(n=+n))return t((S0(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ld),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>oRe(e,i/n))},r.copy=function(){return SG(t).domain(e)},Yc.apply(r,arguments)}function kj(){var e=0,t=.5,r=1,n=1,a,i,o,l,c,d=Ha,f,u=!1,h;function m(g){return isNaN(g=+g)?h:(g=.5+((g=+f(g))-i)*(n*g<n*i?l:c),d(u?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([e,t,r]=g,a=f(e=+e),i=f(t=+t),o=f(r=+r),l=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,m):[e,t,r]},m.clamp=function(g){return arguments.length?(u=!!g,m):u},m.interpolator=function(g){return arguments.length?(d=g,m):d};function v(g){return function(x){var _,w,b;return arguments.length?([_,w,b]=x,d=ORe(g,[_,w,b]),m):[d(0),d(.5),d(1)]}}return m.range=v(Fp),m.rangeRound=v(o5),m.unknown=function(g){return arguments.length?(h=g,m):h},function(g){return f=g,a=g(e),i=g(t),o=g(r),l=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,m}}function kG(){var e=ou(kj()(Ha));return e.copy=function(){return lu(e,kG())},Yc.apply(e,arguments)}function EG(){var e=u5(kj()).domain([.1,1,10]);return e.copy=function(){return lu(e,EG()).base(e.base())},Yc.apply(e,arguments)}function CG(){var e=f5(kj());return e.copy=function(){return lu(e,CG()).constant(e.constant())},Yc.apply(e,arguments)}function N5(){var e=h5(kj());return e.copy=function(){return lu(e,N5()).exponent(e.exponent())},Yc.apply(e,arguments)}function bMe(){return N5.apply(null,arguments).exponent(.5)}const nI=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:iy,scaleDiverging:kG,scaleDivergingLog:EG,scaleDivergingPow:N5,scaleDivergingSqrt:bMe,scaleDivergingSymlog:CG,scaleIdentity:iG,scaleImplicit:AE,scaleLinear:Zw,scaleLog:lG,scaleOrdinal:s5,scalePoint:dv,scalePow:m5,scaleQuantile:uG,scaleQuantize:fG,scaleRadial:dG,scaleSequential:bG,scaleSequentialLog:jG,scaleSequentialPow:j5,scaleSequentialQuantile:SG,scaleSequentialSqrt:wMe,scaleSequentialSymlog:NG,scaleSqrt:rOe,scaleSymlog:cG,scaleThreshold:hG,scaleTime:xMe,scaleUtc:_Me,tickFormat:aG},Symbol.toStringTag,{value:"Module"}));var jMe=Pp;function NMe(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],o=t(i);if(o!=null&&(l===void 0?o===o&&!jMe(o):r(o,l)))var l=o,c=i}return c}var PG=NMe;function SMe(e,t){return e>t}var kMe=SMe,EMe=PG,CMe=kMe,PMe=Lp;function TMe(e){return e&&e.length?EMe(e,PMe,CMe):void 0}var AMe=TMe;const kd=wn(AMe);function RMe(e,t){return e<t}var OMe=RMe,MMe=PG,DMe=OMe,IMe=Lp;function $Me(e){return e&&e.length?MMe(e,IMe,DMe):void 0}var LMe=$Me;const Ej=wn(LMe);var FMe=LA,zMe=iu,BMe=$H,UMe=ji;function qMe(e,t){var r=UMe(e)?FMe:BMe;return r(e,zMe(t))}var VMe=qMe,WMe=DH,HMe=VMe;function GMe(e,t){return WMe(HMe(e,t),1)}var YMe=GMe;const KMe=wn(YMe);var ZMe=QA;function XMe(e,t){return ZMe(e,t)}var JMe=XMe;const Wm=wn(JMe);var zp=1e9,QMe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},k5,as=!0,mo="[DecimalError] ",nf=mo+"Invalid argument: ",S5=mo+"Exponent out of range: ",Bp=Math.floor,ju=Math.pow,e4e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ri,Js=1e7,Jn=7,TG=9007199254740991,eb=Bp(TG/Jn),Kt={};Kt.absoluteValue=Kt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Kt.comparedTo=Kt.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Kt.decimalPlaces=Kt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Jn;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Kt.dividedBy=Kt.div=function(e){return Ec(this,new this.constructor(e))};Kt.dividedToIntegerBy=Kt.idiv=function(e){var t=this,r=t.constructor;return Fn(Ec(t,new r(e),0,1),r.precision)};Kt.equals=Kt.eq=function(e){return!this.cmp(e)};Kt.exponent=function(){return Ds(this)};Kt.greaterThan=Kt.gt=function(e){return this.cmp(e)>0};Kt.greaterThanOrEqualTo=Kt.gte=function(e){return this.cmp(e)>=0};Kt.isInteger=Kt.isint=function(){return this.e>this.d.length-2};Kt.isNegative=Kt.isneg=function(){return this.s<0};Kt.isPositive=Kt.ispos=function(){return this.s>0};Kt.isZero=function(){return this.s===0};Kt.lessThan=Kt.lt=function(e){return this.cmp(e)<0};Kt.lessThanOrEqualTo=Kt.lte=function(e){return this.cmp(e)<1};Kt.logarithm=Kt.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ri))throw Error(mo+"NaN");if(r.s<1)throw Error(mo+(r.s?"NaN":"-Infinity"));return r.eq(Ri)?new n(0):(as=!1,t=Ec(uy(r,i),uy(e,i),i),as=!0,Fn(t,a))};Kt.minus=Kt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?OG(t,e):AG(t,(e.s=-e.s,e))};Kt.modulo=Kt.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(mo+"NaN");return r.s?(as=!1,t=Ec(r,e,0,1).times(e),as=!0,r.minus(t)):Fn(new n(r),a)};Kt.naturalExponential=Kt.exp=function(){return RG(this)};Kt.naturalLogarithm=Kt.ln=function(){return uy(this)};Kt.negated=Kt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Kt.plus=Kt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?AG(t,e):OG(t,(e.s=-e.s,e))};Kt.precision=Kt.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(nf+e);if(t=Ds(a)+1,n=a.d.length-1,r=n*Jn+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Kt.squareRoot=Kt.sqrt=function(){var e,t,r,n,a,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(mo+"NaN")}for(e=Ds(l),as=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=Pl(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Bp((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(i=n,n=i.plus(Ec(l,i,o+2)).times(.5),Pl(i.d).slice(0,o)===(t=Pl(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(Fn(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;o+=4}return as=!0,Fn(n,r)};Kt.times=Kt.mul=function(e){var t,r,n,a,i,o,l,c,d,f=this,u=f.constructor,h=f.d,m=(e=new u(e)).d;if(!f.s||!e.s)return new u(0);for(e.s*=f.s,r=f.e+e.e,c=h.length,d=m.length,c<d&&(i=h,h=m,m=i,o=c,c=d,d=o),i=[],o=c+d,n=o;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+m[n]*h[a-n-1]+t,i[a--]=l%Js|0,t=l/Js|0;i[a]=(i[a]+t)%Js|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,as?Fn(e,u.precision):e};Kt.toDecimalPlaces=Kt.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Ul(e,0,zp),t===void 0?t=n.rounding:Ul(t,0,8),Fn(r,e+Ds(r)+1,t))};Kt.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=jf(n,!0):(Ul(e,0,zp),t===void 0?t=a.rounding:Ul(t,0,8),n=Fn(new a(n),e+1,t),r=jf(n,!0,e+1)),r};Kt.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?jf(a):(Ul(e,0,zp),t===void 0?t=i.rounding:Ul(t,0,8),n=Fn(new i(a),e+Ds(a)+1,t),r=jf(n.abs(),!1,e+Ds(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Kt.toInteger=Kt.toint=function(){var e=this,t=e.constructor;return Fn(new t(e),Ds(e)+1,t.rounding)};Kt.toNumber=function(){return+this};Kt.toPower=Kt.pow=function(e){var t,r,n,a,i,o,l=this,c=l.constructor,d=12,f=+(e=new c(e));if(!e.s)return new c(Ri);if(l=new c(l),!l.s){if(e.s<1)throw Error(mo+"Infinity");return l}if(l.eq(Ri))return l;if(n=c.precision,e.eq(Ri))return Fn(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,i=l.s,o){if((r=f<0?-f:f)<=TG){for(a=new c(Ri),t=Math.ceil(n/Jn+4),as=!1;r%2&&(a=a.times(l),aI(a.d,t)),r=Bp(r/2),r!==0;)l=l.times(l),aI(l.d,t);return as=!0,e.s<0?new c(Ri).div(a):Fn(a,n)}}else if(i<0)throw Error(mo+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,as=!1,a=e.times(uy(l,n+d)),as=!0,a=RG(a),a.s=i,a};Kt.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Ds(a),n=jf(a,r<=i.toExpNeg||r>=i.toExpPos)):(Ul(e,1,zp),t===void 0?t=i.rounding:Ul(t,0,8),a=Fn(new i(a),e,t),r=Ds(a),n=jf(a,e<=r||r<=i.toExpNeg,e)),n};Kt.toSignificantDigits=Kt.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Ul(e,1,zp),t===void 0?t=n.rounding:Ul(t,0,8)),Fn(new n(r),e,t)};Kt.toString=Kt.valueOf=Kt.val=Kt.toJSON=Kt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ds(e),r=e.constructor;return jf(e,t<=r.toExpNeg||t>=r.toExpPos)};function AG(e,t){var r,n,a,i,o,l,c,d,f=e.constructor,u=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),as?Fn(t,u):t;if(c=e.d,d=t.d,o=e.e,a=t.e,c=c.slice(),i=o-a,i){for(i<0?(n=c,i=-i,l=d.length):(n=d,a=o,l=c.length),o=Math.ceil(u/Jn),l=o>l?o+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,n=d,d=c,c=n),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/Js|0,c[i]%=Js;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,as?Fn(t,u):t}function Ul(e,t,r){if(e!==~~e||e<t||e>r)throw Error(nf+e)}function Pl(e){var t,r,n,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)n=e[t]+"",r=Jn-n.length,r&&(i+=ud(r)),i+=n;o=e[t],n=o+"",r=Jn-n.length,r&&(i+=ud(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Ec=function(){function e(n,a){var i,o=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+o,n[l]=i%Js|0,o=i/Js|0;return o&&n.unshift(o),n}function t(n,a,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*Js+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var l,c,d,f,u,h,m,v,g,x,_,w,b,N,S,k,C,A,R=n.constructor,I=n.s==a.s?1:-1,O=n.d,z=a.d;if(!n.s)return new R(n);if(!a.s)throw Error(mo+"Division by zero");for(c=n.e-a.e,C=z.length,S=O.length,m=new R(I),v=m.d=[],d=0;z[d]==(O[d]||0);)++d;if(z[d]>(O[d]||0)&&--c,i==null?w=i=R.precision:o?w=i+(Ds(n)-Ds(a))+1:w=i,w<0)return new R(0);if(w=w/Jn+2|0,d=0,C==1)for(f=0,z=z[0],w++;(d<S||f)&&w--;d++)b=f*Js+(O[d]||0),v[d]=b/z|0,f=b%z|0;else{for(f=Js/(z[0]+1)|0,f>1&&(z=e(z,f),O=e(O,f),C=z.length,S=O.length),N=C,g=O.slice(0,C),x=g.length;x<C;)g[x++]=0;A=z.slice(),A.unshift(0),k=z[0],z[1]>=Js/2&&++k;do f=0,l=t(z,g,C,x),l<0?(_=g[0],C!=x&&(_=_*Js+(g[1]||0)),f=_/k|0,f>1?(f>=Js&&(f=Js-1),u=e(z,f),h=u.length,x=g.length,l=t(u,g,h,x),l==1&&(f--,r(u,C<h?A:z,h))):(f==0&&(l=f=1),u=z.slice()),h=u.length,h<x&&u.unshift(0),r(g,u,x),l==-1&&(x=g.length,l=t(z,g,C,x),l<1&&(f++,r(g,C<x?A:z,x))),x=g.length):l===0&&(f++,g=[0]),v[d++]=f,l&&g[0]?g[x++]=O[N]||0:(g=[O[N]],x=1);while((N++<S||g[0]!==void 0)&&w--)}return v[0]||v.shift(),m.e=c,Fn(m,o?i+Ds(m)+1:i)}}();function RG(e,t){var r,n,a,i,o,l,c=0,d=0,f=e.constructor,u=f.precision;if(Ds(e)>16)throw Error(S5+Ds(e));if(!e.s)return new f(Ri);for(t==null?(as=!1,l=u):l=t,o=new f(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(n=Math.log(ju(2,d))/Math.LN10*2+5|0,l+=n,r=a=i=new f(Ri),f.precision=l;;){if(a=Fn(a.times(e),l),r=r.times(++c),o=i.plus(Ec(a,r,l)),Pl(o.d).slice(0,l)===Pl(i.d).slice(0,l)){for(;d--;)i=Fn(i.times(i),l);return f.precision=u,t==null?(as=!0,Fn(i,u)):i}i=o}}function Ds(e){for(var t=e.e*Jn,r=e.d[0];r>=10;r/=10)t++;return t}function FS(e,t,r){if(t>e.LN10.sd())throw as=!0,r&&(e.precision=r),Error(mo+"LN10 precision limit exceeded");return Fn(new e(e.LN10),t)}function ud(e){for(var t="";e--;)t+="0";return t}function uy(e,t){var r,n,a,i,o,l,c,d,f,u=1,h=10,m=e,v=m.d,g=m.constructor,x=g.precision;if(m.s<1)throw Error(mo+(m.s?"NaN":"-Infinity"));if(m.eq(Ri))return new g(0);if(t==null?(as=!1,d=x):d=t,m.eq(10))return t==null&&(as=!0),FS(g,d);if(d+=h,g.precision=d,r=Pl(v),n=r.charAt(0),i=Ds(m),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(e),r=Pl(m.d),n=r.charAt(0),u++;i=Ds(m),n>1?(m=new g("0."+r),i++):m=new g(n+"."+r.slice(1))}else return c=FS(g,d+2,x).times(i+""),m=uy(new g(n+"."+r.slice(1)),d-h).plus(c),g.precision=x,t==null?(as=!0,Fn(m,x)):m;for(l=o=m=Ec(m.minus(Ri),m.plus(Ri),d),f=Fn(m.times(m),d),a=3;;){if(o=Fn(o.times(f),d),c=l.plus(Ec(o,new g(a),d)),Pl(c.d).slice(0,d)===Pl(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(FS(g,d+2,x).times(i+""))),l=Ec(l,new g(u),d),g.precision=x,t==null?(as=!0,Fn(l,x)):l;l=c,a+=2}}function sI(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Bp(r/Jn),e.d=[],n=(r+1)%Jn,r<0&&(n+=Jn),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Jn;n<a;)e.d.push(+t.slice(n,n+=Jn));t=t.slice(n),n=Jn-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),as&&(e.e>eb||e.e<-eb))throw Error(S5+r)}else e.s=0,e.e=0,e.d=[0];return e}function Fn(e,t,r){var n,a,i,o,l,c,d,f,u=e.d;for(o=1,i=u[0];i>=10;i/=10)o++;if(n=t-o,n<0)n+=Jn,a=t,d=u[f=0];else{if(f=Math.ceil((n+1)/Jn),i=u.length,f>=i)return e;for(d=i=u[f],o=1;i>=10;i/=10)o++;n%=Jn,a=n-Jn+o}if(r!==void 0&&(i=ju(10,o-a-1),l=d/i%10|0,c=t<0||u[f+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?d/ju(10,o-a):0:u[f-1])%10&1||r==(e.s<0?8:7))),t<1||!u[0])return c?(i=Ds(e),u.length=1,t=t-i-1,u[0]=ju(10,(Jn-t%Jn)%Jn),e.e=Bp(-t/Jn)||0):(u.length=1,u[0]=e.e=e.s=0),e;if(n==0?(u.length=f,i=1,f--):(u.length=f+1,i=ju(10,Jn-n),u[f]=a>0?(d/ju(10,o-a)%ju(10,a)|0)*i:0),c)for(;;)if(f==0){(u[0]+=i)==Js&&(u[0]=1,++e.e);break}else{if(u[f]+=i,u[f]!=Js)break;u[f--]=0,i=1}for(n=u.length;u[--n]===0;)u.pop();if(as&&(e.e>eb||e.e<-eb))throw Error(S5+Ds(e));return e}function OG(e,t){var r,n,a,i,o,l,c,d,f,u,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),as?Fn(t,m):t;if(c=e.d,u=t.d,n=t.e,d=e.e,c=c.slice(),o=d-n,o){for(f=o<0,f?(r=c,o=-o,l=u.length):(r=u,n=d,l=c.length),a=Math.max(Math.ceil(m/Jn),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=u.length,f=a<l,f&&(l=a),a=0;a<l;a++)if(c[a]!=u[a]){f=c[a]<u[a];break}o=0}for(f&&(r=c,c=u,u=r,t.s=-t.s),l=c.length,a=u.length-l;a>0;--a)c[l++]=0;for(a=u.length;a>o;){if(c[--a]<u[a]){for(i=a;i&&c[--i]===0;)c[i]=Js-1;--c[i],c[a]+=Js}c[a]-=u[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,as?Fn(t,m):t):new h(0)}function jf(e,t,r){var n,a=Ds(e),i=Pl(e.d),o=i.length;return t?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+ud(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+ud(-a-1)+i,r&&(n=r-o)>0&&(i+=ud(n))):a>=o?(i+=ud(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+ud(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=ud(n))),e.s<0?"-"+i:i}function aI(e,t){if(e.length>t)return e.length=t,!0}function MG(e){var t,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(nf+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return sI(o,i.toString())}else if(typeof i!="string")throw Error(nf+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,e4e.test(i))sI(o,i);else throw Error(nf+i)}if(a.prototype=Kt,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=MG,a.config=a.set=t4e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function t4e(e){if(!e||typeof e!="object")throw Error(mo+"Object expected");var t,r,n,a=["precision",1,zp,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Bp(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(nf+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(nf+r+": "+n);return this}var k5=MG(QMe);Ri=new k5(1);const $n=k5;function r4e(e){return i4e(e)||a4e(e)||s4e(e)||n4e()}function n4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s4e(e,t){if(e){if(typeof e=="string")return DE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DE(e,t)}}function a4e(e){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function i4e(e){if(Array.isArray(e))return DE(e)}function DE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o4e=function(t){return t},DG={"@@functional/placeholder":!0},IG=function(t){return t===DG},iI=function(t){return function r(){return arguments.length===0||arguments.length===1&&IG(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},l4e=function e(t,r){return t===1?r:iI(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=a.filter(function(l){return l!==DG}).length;return o>=t?r.apply(void 0,a):e(t-o,iI(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var f=a.map(function(u){return IG(u)?c.shift():u});return r.apply(void 0,r4e(f).concat(c))}))})},Cj=function(t){return l4e(t.length,t)},IE=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},c4e=Cj(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),d4e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return o4e;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},$E=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},$G=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r&&i.every(function(l,c){return l===r[c]})||(r=i,n=t.apply(void 0,i)),n}};function u4e(e){var t;return e===0?t=1:t=Math.floor(new $n(e).abs().log(10).toNumber())+1,t}function f4e(e,t,r){for(var n=new $n(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var h4e=Cj(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),m4e=Cj(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),p4e=Cj(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const Pj={rangeStep:f4e,getDigitCount:u4e,interpolateNumber:h4e,uninterpolateNumber:m4e,uninterpolateTruncation:p4e};function LE(e){return y4e(e)||v4e(e)||LG(e)||g4e()}function g4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v4e(e){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function y4e(e){if(Array.isArray(e))return FE(e)}function fy(e,t){return w4e(e)||_4e(e,t)||LG(e,t)||x4e()}function x4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LG(e,t){if(e){if(typeof e=="string")return FE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FE(e,t)}}function FE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _4e(e,t){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var o=e[Symbol.iterator](),l;!(n=(l=o.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){a=!0,i=c}finally{try{!n&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function w4e(e){if(Array.isArray(e))return e}function FG(e){var t=fy(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function zG(e,t,r){if(e.lte(0))return new $n(0);var n=Pj.getDigitCount(e.toNumber()),a=new $n(10).pow(n),i=e.div(a),o=n!==1?.05:.1,l=new $n(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return t?c:new $n(Math.ceil(c))}function b4e(e,t,r){var n=1,a=new $n(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new $n(10).pow(Pj.getDigitCount(e)-1),a=new $n(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new $n(Math.floor(e)))}else e===0?a=new $n(Math.floor((t-1)/2)):r||(a=new $n(Math.floor(e)));var o=Math.floor((t-1)/2),l=d4e(c4e(function(c){return a.add(new $n(c-o).mul(n)).toNumber()}),IE);return l(0,t)}function BG(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new $n(0),tickMin:new $n(0),tickMax:new $n(0)};var i=zG(new $n(t).sub(e).div(r-1),n,a),o;e<=0&&t>=0?o=new $n(0):(o=new $n(e).add(t).div(2),o=o.sub(new $n(o).mod(i)));var l=Math.ceil(o.sub(e).div(i).toNumber()),c=Math.ceil(new $n(t).sub(o).div(i).toNumber()),d=l+c+1;return d>r?BG(e,t,r,n,a+1):(d<r&&(c=t>0?c+(r-d):c,l=t>0?l:l+(r-d)),{step:i,tickMin:o.sub(new $n(l).mul(i)),tickMax:o.add(new $n(c).mul(i))})}function j4e(e){var t=fy(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),l=FG([r,n]),c=fy(l,2),d=c[0],f=c[1];if(d===-1/0||f===1/0){var u=f===1/0?[d].concat(LE(IE(0,a-1).map(function(){return 1/0}))):[].concat(LE(IE(0,a-1).map(function(){return-1/0})),[f]);return r>n?$E(u):u}if(d===f)return b4e(d,a,i);var h=BG(d,f,o,i),m=h.step,v=h.tickMin,g=h.tickMax,x=Pj.rangeStep(v,g.add(new $n(.1).mul(m)),m);return r>n?$E(x):x}function N4e(e,t){var r=fy(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=FG([n,a]),l=fy(o,2),c=l[0],d=l[1];if(c===-1/0||d===1/0)return[n,a];if(c===d)return[c];var f=Math.max(t,2),u=zG(new $n(d).sub(c).div(f-1),i,0),h=[].concat(LE(Pj.rangeStep(new $n(c),new $n(d).sub(new $n(.99).mul(u)),u)),[d]);return n>a?$E(h):h}var S4e=$G(j4e),k4e=$G(N4e),E4e="Invariant failed";function Nf(e,t){throw new Error(E4e)}var C4e=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Hm(e){"@babel/helpers - typeof";return Hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hm(e)}function tb(){return tb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tb.apply(this,arguments)}function P4e(e,t){return O4e(e)||R4e(e,t)||A4e(e,t)||T4e()}function T4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A4e(e,t){if(e){if(typeof e=="string")return oI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oI(e,t)}}function oI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R4e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(f){d=!0,a=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function O4e(e){if(Array.isArray(e))return e}function M4e(e,t){if(e==null)return{};var r=D4e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function D4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function I4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $4e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VG(n.key),n)}}function L4e(e,t,r){return t&&$4e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function F4e(e,t,r){return t=rb(t),z4e(e,UG()?Reflect.construct(t,r||[],rb(e).constructor):t.apply(e,r))}function z4e(e,t){if(t&&(Hm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B4e(e)}function B4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(UG=function(){return!!e})()}function rb(e){return rb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rb(e)}function U4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zE(e,t)}function zE(e,t){return zE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},zE(e,t)}function qG(e,t,r){return t=VG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VG(e){var t=q4e(e,"string");return Hm(t)=="symbol"?t:t+""}function q4e(e,t){if(Hm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P0=function(e){function t(){return I4e(this,t),F4e(this,t,arguments)}return U4e(t,e),L4e(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,o=n.width,l=n.dataKey,c=n.data,d=n.dataPointFormatter,f=n.xAxis,u=n.yAxis,h=M4e(n,C4e),m=qr(h,!1);this.props.direction==="x"&&f.type!=="number"&&Nf();var v=c.map(function(g){var x=d(g,l),_=x.x,w=x.y,b=x.value,N=x.errorVal;if(!N)return null;var S=[],k,C;if(Array.isArray(N)){var A=P4e(N,2);k=A[0],C=A[1]}else k=C=N;if(i==="vertical"){var R=f.scale,I=w+a,O=I+o,z=I-o,M=R(b-k),B=R(b+C);S.push({x1:B,y1:O,x2:B,y2:z}),S.push({x1:M,y1:I,x2:B,y2:I}),S.push({x1:M,y1:O,x2:M,y2:z})}else if(i==="horizontal"){var F=u.scale,U=_+a,H=U-o,q=U+o,K=F(b-k),Z=F(b+C);S.push({x1:H,y1:Z,x2:q,y2:Z}),S.push({x1:U,y1:K,x2:U,y2:Z}),S.push({x1:H,y1:K,x2:q,y2:K})}return te.createElement(Wn,tb({className:"recharts-errorBar",key:"bar-".concat(S.map(function(ne){return"".concat(ne.x1,"-").concat(ne.x2,"-").concat(ne.y1,"-").concat(ne.y2)}))},m),S.map(function(ne){return te.createElement("line",tb({},ne,{key:"line-".concat(ne.x1,"-").concat(ne.x2,"-").concat(ne.y1,"-").concat(ne.y2)}))}))});return te.createElement(Wn,{className:"recharts-errorBars"},v)}}])}(te.Component);qG(P0,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});qG(P0,"displayName","ErrorBar");function hy(e){"@babel/helpers - typeof";return hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hy(e)}function lI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lI(Object(r),!0).forEach(function(n){V4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function V4e(e,t,r){return t=W4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W4e(e){var t=H4e(e,"string");return hy(t)=="symbol"?t:t+""}function H4e(e,t){if(hy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WG=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,o=Pi(r,tf);if(!o)return null;var l=tf.defaultProps,c=l!==void 0?pu(pu({},l),o.props):{},d;return o.props&&o.props.payload?d=o.props&&o.props.payload:i==="children"?d=(n||[]).reduce(function(f,u){var h=u.item,m=u.props,v=m.sectors||m.data||[];return f.concat(v.map(function(g){return{type:o.props.iconType||h.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):d=(n||[]).map(function(f){var u=f.item,h=u.type.defaultProps,m=h!==void 0?pu(pu({},h),u.props):{},v=m.dataKey,g=m.name,x=m.legendType,_=m.hide;return{inactive:_,dataKey:v,type:c.iconType||x||"square",color:E5(u),value:g||v,payload:m}}),pu(pu(pu({},c),tf.getWithHeight(o,a)),{},{payload:d,item:o})};function my(e){"@babel/helpers - typeof";return my=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},my(e)}function cI(e){return Z4e(e)||K4e(e)||Y4e(e)||G4e()}function G4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y4e(e,t){if(e){if(typeof e=="string")return BE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BE(e,t)}}function K4e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Z4e(e){if(Array.isArray(e))return BE(e)}function BE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ps(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dI(Object(r),!0).forEach(function(n){am(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function am(e,t,r){return t=X4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X4e(e){var t=J4e(e,"string");return my(t)=="symbol"?t:t+""}function J4e(e,t){if(my(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(my(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ka(e,t,r){return Zr(e)||Zr(t)?r:Hs(t)?lo(e,t,r):$r(t)?t(e):r}function uv(e,t,r,n){var a=KMe(e,function(l){return Ka(l,t)});if(r==="number"){var i=a.filter(function(l){return bt(l)||parseFloat(l)});return i.length?[Ej(i),kd(i)]:[1/0,-1/0]}var o=n?a.filter(function(l){return!Zr(l)}):a;return o.map(function(l){return Hs(l)||l instanceof Date?l:""})}var Q4e=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,l=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,d=0;d<l;d++){var f=d>0?a[d-1].coordinate:a[l-1].coordinate,u=a[d].coordinate,h=d>=l-1?a[0].coordinate:a[d+1].coordinate,m=void 0;if(qo(u-f)!==qo(h-u)){var v=[];if(qo(h-u)===qo(c[1]-c[0])){m=h;var g=u+c[1]-c[0];v[0]=Math.min(g,(g+f)/2),v[1]=Math.max(g,(g+f)/2)}else{m=f;var x=h+c[1]-c[0];v[0]=Math.min(u,(x+u)/2),v[1]=Math.max(u,(x+u)/2)}var _=[Math.min(u,(m+u)/2),Math.max(u,(m+u)/2)];if(t>_[0]&&t<=_[1]||t>=v[0]&&t<=v[1]){o=a[d].index;break}}else{var w=Math.min(f,h),b=Math.max(f,h);if(t>(w+u)/2&&t<=(b+u)/2){o=a[d].index;break}}}else for(var N=0;N<l;N++)if(N===0&&t<=(n[N].coordinate+n[N+1].coordinate)/2||N>0&&N<l-1&&t>(n[N].coordinate+n[N-1].coordinate)/2&&t<=(n[N].coordinate+n[N+1].coordinate)/2||N===l-1&&t>(n[N].coordinate+n[N-1].coordinate)/2){o=n[N].index;break}return o},E5=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?ps(ps({},t.type.defaultProps),t.props):t.props,o=i.stroke,l=i.fill,c;switch(a){case"Line":c=o;break;case"Area":case"Radar":c=o&&o!=="none"?o:l;break;default:c=l;break}return c},e3e=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var o={},l=Object.keys(i),c=0,d=l.length;c<d;c++)for(var f=i[l[c]].stackGroups,u=Object.keys(f),h=0,m=u.length;h<m;h++){var v=f[u[h]],g=v.items,x=v.cateAxisId,_=g.filter(function(C){return Sc(C.type).indexOf("Bar")>=0});if(_&&_.length){var w=_[0].type.defaultProps,b=w!==void 0?ps(ps({},w),_[0].props):_[0].props,N=b.barSize,S=b[x];o[S]||(o[S]=[]);var k=Zr(N)?r:N;o[S].push({item:_[0],stackList:_.slice(1),barSize:Zr(k)?void 0:bf(k,n,0)})}}return o},t3e=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,l=t.maxBarSize,c=o.length;if(c<1)return null;var d=bf(r,a,0,!0),f,u=[];if(o[0].barSize===+o[0].barSize){var h=!1,m=a/c,v=o.reduce(function(N,S){return N+S.barSize||0},0);v+=(c-1)*d,v>=a&&(v-=(c-1)*d,d=0),v>=a&&m>0&&(h=!0,m*=.9,v=c*m);var g=(a-v)/2>>0,x={offset:g-d,size:0};f=o.reduce(function(N,S){var k={item:S.item,position:{offset:x.offset+x.size+d,size:h?m:S.barSize}},C=[].concat(cI(N),[k]);return x=C[C.length-1].position,S.stackList&&S.stackList.length&&S.stackList.forEach(function(A){C.push({item:A,position:x})}),C},u)}else{var _=bf(n,a,0,!0);a-2*_-(c-1)*d<=0&&(d=0);var w=(a-2*_-(c-1)*d)/c;w>1&&(w>>=0);var b=l===+l?Math.min(w,l):w;f=o.reduce(function(N,S,k){var C=[].concat(cI(N),[{item:S.item,position:{offset:_+(w+d)*k+(w-b)/2,size:b}}]);return S.stackList&&S.stackList.length&&S.stackList.forEach(function(A){C.push({item:A,position:C[C.length-1].position})}),C},u)}return f},r3e=function(t,r,n,a){var i=n.children,o=n.width,l=n.margin,c=o-(l.left||0)-(l.right||0),d=WG({children:i,legendWidth:c});if(d){var f=a||{},u=f.width,h=f.height,m=d.align,v=d.verticalAlign,g=d.layout;if((g==="vertical"||g==="horizontal"&&v==="middle")&&m!=="center"&&bt(t[m]))return ps(ps({},t),{},am({},m,t[m]+(u||0)));if((g==="horizontal"||g==="vertical"&&m==="center")&&v!=="middle"&&bt(t[v]))return ps(ps({},t),{},am({},v,t[v]+(h||0)))}return t},n3e=function(t,r,n){return Zr(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},HG=function(t,r,n,a,i){var o=r.props.children,l=co(o,P0).filter(function(d){return n3e(a,i,d.props.direction)});if(l&&l.length){var c=l.map(function(d){return d.props.dataKey});return t.reduce(function(d,f){var u=Ka(f,n);if(Zr(u))return d;var h=Array.isArray(u)?[Ej(u),kd(u)]:[u,u],m=c.reduce(function(v,g){var x=Ka(f,g,0),_=h[0]-Math.abs(Array.isArray(x)?x[0]:x),w=h[1]+Math.abs(Array.isArray(x)?x[1]:x);return[Math.min(_,v[0]),Math.max(w,v[1])]},[1/0,-1/0]);return[Math.min(m[0],d[0]),Math.max(m[1],d[1])]},[1/0,-1/0])}return null},s3e=function(t,r,n,a,i){var o=r.map(function(l){return HG(t,l,n,i,a)}).filter(function(l){return!Zr(l)});return o&&o.length?o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},GG=function(t,r,n,a,i){var o=r.map(function(c){var d=c.props.dataKey;return n==="number"&&d&&HG(t,c,d,a)||uv(t,d,n,i)});if(n==="number")return o.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);var l={};return o.reduce(function(c,d){for(var f=0,u=d.length;f<u;f++)l[d[f]]||(l[d[f]]=!0,c.push(d[f]));return c},[])},YG=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},KG=function(t,r,n,a){if(a)return t.map(function(c){return c.coordinate});var i,o,l=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===n&&(o=!0),c.coordinate});return i||l.push(r),o||l.push(n),l},bc=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,o=t.type,l=t.range,c=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,d=(r||n)&&o==="category"&&a.bandwidth?a.bandwidth()/c:0;if(d=t.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?qo(l[0]-l[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var f=(t.ticks||t.niceTicks).map(function(u){var h=i?i.indexOf(u):u;return{coordinate:a(h)+d,value:u,offset:d}});return f.filter(function(u){return!Mp(u.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(u,h){return{coordinate:a(u)+d,value:u,index:h,offset:d}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(u){return{coordinate:a(u)+d,value:u,offset:d}}):a.domain().map(function(u,h){return{coordinate:a(u)+d,value:i?i[u]:u,index:h,offset:d}})},zS=new WeakMap,qx=function(t,r){if(typeof r!="function")return t;zS.has(t)||zS.set(t,new WeakMap);var n=zS.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},a3e=function(t,r,n){var a=t.scale,i=t.type,o=t.layout,l=t.axisType;if(a==="auto")return o==="radial"&&l==="radiusAxis"?{scale:iy(),realScaleType:"band"}:o==="radial"&&l==="angleAxis"?{scale:Zw(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:dv(),realScaleType:"point"}:i==="category"?{scale:iy(),realScaleType:"band"}:{scale:Zw(),realScaleType:"linear"};if(wf(a)){var c="scale".concat(mj(a));return{scale:(nI[c]||dv)(),realScaleType:nI[c]?c:"point"}}return $r(a)?{scale:a}:{scale:dv(),realScaleType:"point"}},uI=1e-4,i3e=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-uI,o=Math.max(a[0],a[1])+uI,l=t(r[0]),c=t(r[n-1]);(l<i||l>o||c<i||c>o)&&t.domain([r[0],r[n-1]])}},o3e=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},l3e=function(t,r){if(!r||r.length!==2||!bt(r[0])||!bt(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!bt(t[0])||t[0]<n)&&(i[0]=n),(!bt(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},c3e=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0,l=0;l<r;++l){var c=Mp(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=i,t[l][n][1]=i+c,i=t[l][n][1]):(t[l][n][0]=o,t[l][n][1]=o+c,o=t[l][n][1])}},d3e=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0;o<r;++o){var l=Mp(t[o][n][1])?t[o][n][0]:t[o][n][1];l>=0?(t[o][n][0]=i,t[o][n][1]=i+l,i=t[o][n][1]):(t[o][n][0]=0,t[o][n][1]=0)}},u3e={sign:c3e,expand:kNe,none:$m,silhouette:ENe,wiggle:CNe,positive:d3e},f3e=function(t,r,n){var a=r.map(function(l){return l.props.dataKey}),i=u3e[n],o=SNe().keys(a).value(function(l,c){return+Ka(l,c,0)}).order(fE).offset(i);return o(t)},h3e=function(t,r,n,a,i,o){if(!t)return null;var l=o?r.reverse():r,c={},d=l.reduce(function(u,h){var m,v=(m=h.type)!==null&&m!==void 0&&m.defaultProps?ps(ps({},h.type.defaultProps),h.props):h.props,g=v.stackId,x=v.hide;if(x)return u;var _=v[n],w=u[_]||{hasStack:!1,stackGroups:{}};if(Hs(g)){var b=w.stackGroups[g]||{numericAxisId:n,cateAxisId:a,items:[]};b.items.push(h),w.hasStack=!0,w.stackGroups[g]=b}else w.stackGroups[Dp("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[h]};return ps(ps({},u),{},am({},_,w))},c),f={};return Object.keys(d).reduce(function(u,h){var m=d[h];if(m.hasStack){var v={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(g,x){var _=m.stackGroups[x];return ps(ps({},g),{},am({},x,{numericAxisId:n,cateAxisId:a,items:_.items,stackedData:f3e(t,_.items,i)}))},v)}return ps(ps({},u),{},am({},h,m))},f)},m3e=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,o=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var d=t.domain();if(!d.length)return null;var f=S4e(d,i,l);return t.domain([Ej(f),kd(f)]),{niceTicks:f}}if(i&&a==="number"){var u=t.domain(),h=k4e(u,i,l);return{niceTicks:h}}return null};function nb(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,o=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Zr(a[t.dataKey])){var l=Ew(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=Ka(a,Zr(o)?t.dataKey:o);return Zr(c)?null:t.scale(c)}var fI=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,o=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+a:null;var c=Ka(o,r.dataKey,r.domain[l]);return Zr(c)?null:r.scale(c)-i/2+a},p3e=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},g3e=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?ps(ps({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(Hs(i)){var o=r[i];if(o){var l=o.items.indexOf(t);return l>=0?o.stackedData[l]:null}}return null},v3e=function(t){return t.reduce(function(r,n){return[Ej(n.concat([r[0]]).filter(bt)),kd(n.concat([r[1]]).filter(bt))]},[1/0,-1/0])},ZG=function(t,r,n){return Object.keys(t).reduce(function(a,i){var o=t[i],l=o.stackedData,c=l.reduce(function(d,f){var u=v3e(f.slice(r,n+1));return[Math.min(d[0],u[0]),Math.max(d[1],u[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},hI=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,mI=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,UE=function(t,r,n){if($r(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(bt(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(hI.test(t[0])){var i=+hI.exec(t[0])[1];a[0]=r[0]-i}else $r(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(bt(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(mI.test(t[1])){var o=+mI.exec(t[1])[1];a[1]=r[1]+o}else $r(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},sb=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=t5(r,function(u){return u.coordinate}),o=1/0,l=1,c=i.length;l<c;l++){var d=i[l],f=i[l-1];o=Math.min((d.coordinate||0)-(f.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},pI=function(t,r,n){return!t||!t.length||Wm(t,lo(n,"type.defaultProps.domain"))?r:t},XG=function(t,r){var n=t.type.defaultProps?ps(ps({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,o=n.unit,l=n.formatter,c=n.tooltipType,d=n.chartType,f=n.hide;return ps(ps({},qr(t,!1)),{},{dataKey:a,unit:o,formatter:l,name:i||a,color:E5(t),value:Ka(r,a),type:c,payload:r,chartType:d,hide:f})};function py(e){"@babel/helpers - typeof";return py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},py(e)}function gI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gI(Object(r),!0).forEach(function(n){y3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function y3e(e,t,r){return t=x3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x3e(e){var t=_3e(e,"string");return py(t)=="symbol"?t:t+""}function _3e(e,t){if(py(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(py(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ab=Math.PI/180,w3e=function(t){return t*180/Math.PI},pa=function(t,r,n,a){return{x:t+Math.cos(-ab*a)*n,y:r+Math.sin(-ab*a)*n}},b3e=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-o,2))},j3e=function(t,r){var n=t.x,a=t.y,i=r.cx,o=r.cy,l=b3e({x:n,y:a},{x:i,y:o});if(l<=0)return{radius:l};var c=(n-i)/l,d=Math.acos(c);return a>o&&(d=2*Math.PI-d),{radius:l,angle:w3e(d),angleInRadian:d}},N3e=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return{startAngle:r-o*360,endAngle:n-o*360}},S3e=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),o=Math.floor(a/360),l=Math.min(i,o);return t+l*360},yI=function(t,r){var n=t.x,a=t.y,i=j3e({x:n,y:a},r),o=i.radius,l=i.angle,c=r.innerRadius,d=r.outerRadius;if(o<c||o>d)return!1;if(o===0)return!0;var f=N3e(r),u=f.startAngle,h=f.endAngle,m=l,v;if(u<=h){for(;m>h;)m-=360;for(;m<u;)m+=360;v=m>=u&&m<=h}else{for(;m>u;)m-=360;for(;m<h;)m+=360;v=m>=h&&m<=u}return v?vI(vI({},r),{},{radius:o,angle:S3e(m,r)}):null};function gy(e){"@babel/helpers - typeof";return gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gy(e)}var k3e=["offset"];function E3e(e){return A3e(e)||T3e(e)||P3e(e)||C3e()}function C3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P3e(e,t){if(e){if(typeof e=="string")return qE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qE(e,t)}}function T3e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function A3e(e){if(Array.isArray(e))return qE(e)}function qE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R3e(e,t){if(e==null)return{};var r=O3e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function O3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function xI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xI(Object(r),!0).forEach(function(n){M3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M3e(e,t,r){return t=D3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D3e(e){var t=I3e(e,"string");return gy(t)=="symbol"?t:t+""}function I3e(e,t){if(gy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vy(){return vy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vy.apply(this,arguments)}var $3e=function(t){var r=t.value,n=t.formatter,a=Zr(t.children)?r:t.children;return $r(n)?n(a):a},L3e=function(t,r){var n=qo(r-t),a=Math.min(Math.abs(r-t),360);return n*a},F3e=function(t,r,n){var a=t.position,i=t.viewBox,o=t.offset,l=t.className,c=i,d=c.cx,f=c.cy,u=c.innerRadius,h=c.outerRadius,m=c.startAngle,v=c.endAngle,g=c.clockWise,x=(u+h)/2,_=L3e(m,v),w=_>=0?1:-1,b,N;a==="insideStart"?(b=m+w*o,N=g):a==="insideEnd"?(b=v-w*o,N=!g):a==="end"&&(b=v+w*o,N=g),N=_<=0?N:!N;var S=pa(d,f,x,b),k=pa(d,f,x,b+(N?1:-1)*359),C="M".concat(S.x,",").concat(S.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(N?0:1,`,
    `).concat(k.x,",").concat(k.y),A=Zr(t.id)?Dp("recharts-radial-line-"):t.id;return te.createElement("text",vy({},n,{dominantBaseline:"central",className:on("recharts-radial-bar-label",l)}),te.createElement("defs",null,te.createElement("path",{id:A,d:C})),te.createElement("textPath",{xlinkHref:"#".concat(A)},r))},z3e=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,o=i.cx,l=i.cy,c=i.innerRadius,d=i.outerRadius,f=i.startAngle,u=i.endAngle,h=(f+u)/2;if(a==="outside"){var m=pa(o,l,d+n,h),v=m.x,g=m.y;return{x:v,y:g,textAnchor:v>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"end"};var x=(c+d)/2,_=pa(o,l,x,h),w=_.x,b=_.y;return{x:w,y:b,textAnchor:"middle",verticalAnchor:"middle"}},B3e=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,o=r,l=o.x,c=o.y,d=o.width,f=o.height,u=f>=0?1:-1,h=u*a,m=u>0?"end":"start",v=u>0?"start":"end",g=d>=0?1:-1,x=g*a,_=g>0?"end":"start",w=g>0?"start":"end";if(i==="top"){var b={x:l+d/2,y:c-u*a,textAnchor:"middle",verticalAnchor:m};return zs(zs({},b),n?{height:Math.max(c-n.y,0),width:d}:{})}if(i==="bottom"){var N={x:l+d/2,y:c+f+h,textAnchor:"middle",verticalAnchor:v};return zs(zs({},N),n?{height:Math.max(n.y+n.height-(c+f),0),width:d}:{})}if(i==="left"){var S={x:l-x,y:c+f/2,textAnchor:_,verticalAnchor:"middle"};return zs(zs({},S),n?{width:Math.max(S.x-n.x,0),height:f}:{})}if(i==="right"){var k={x:l+d+x,y:c+f/2,textAnchor:w,verticalAnchor:"middle"};return zs(zs({},k),n?{width:Math.max(n.x+n.width-k.x,0),height:f}:{})}var C=n?{width:d,height:f}:{};return i==="insideLeft"?zs({x:l+x,y:c+f/2,textAnchor:w,verticalAnchor:"middle"},C):i==="insideRight"?zs({x:l+d-x,y:c+f/2,textAnchor:_,verticalAnchor:"middle"},C):i==="insideTop"?zs({x:l+d/2,y:c+h,textAnchor:"middle",verticalAnchor:v},C):i==="insideBottom"?zs({x:l+d/2,y:c+f-h,textAnchor:"middle",verticalAnchor:m},C):i==="insideTopLeft"?zs({x:l+x,y:c+h,textAnchor:w,verticalAnchor:v},C):i==="insideTopRight"?zs({x:l+d-x,y:c+h,textAnchor:_,verticalAnchor:v},C):i==="insideBottomLeft"?zs({x:l+x,y:c+f-h,textAnchor:w,verticalAnchor:m},C):i==="insideBottomRight"?zs({x:l+d-x,y:c+f-h,textAnchor:_,verticalAnchor:m},C):Tp(i)&&(bt(i.x)||$u(i.x))&&(bt(i.y)||$u(i.y))?zs({x:l+bf(i.x,d),y:c+bf(i.y,f),textAnchor:"end",verticalAnchor:"end"},C):zs({x:l+d/2,y:c+f/2,textAnchor:"middle",verticalAnchor:"middle"},C)},U3e=function(t){return"cx"in t&&bt(t.cx)};function Pa(e){var t=e.offset,r=t===void 0?5:t,n=R3e(e,k3e),a=zs({offset:r},n),i=a.viewBox,o=a.position,l=a.value,c=a.children,d=a.content,f=a.className,u=f===void 0?"":f,h=a.textBreakAll;if(!i||Zr(l)&&Zr(c)&&!y.isValidElement(d)&&!$r(d))return null;if(y.isValidElement(d))return y.cloneElement(d,a);var m;if($r(d)){if(m=y.createElement(d,a),y.isValidElement(m))return m}else m=$3e(a);var v=U3e(i),g=qr(a,!0);if(v&&(o==="insideStart"||o==="insideEnd"||o==="end"))return F3e(a,m,g);var x=v?z3e(a):B3e(a);return te.createElement(qw,vy({className:on("recharts-label",u)},g,x,{breakAll:h}),m)}Pa.displayName="Label";var JG=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,o=t.endAngle,l=t.r,c=t.radius,d=t.innerRadius,f=t.outerRadius,u=t.x,h=t.y,m=t.top,v=t.left,g=t.width,x=t.height,_=t.clockWise,w=t.labelViewBox;if(w)return w;if(bt(g)&&bt(x)){if(bt(u)&&bt(h))return{x:u,y:h,width:g,height:x};if(bt(m)&&bt(v))return{x:m,y:v,width:g,height:x}}return bt(u)&&bt(h)?{x:u,y:h,width:0,height:0}:bt(r)&&bt(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:o||a||0,innerRadius:d||0,outerRadius:f||c||l||0,clockWise:_}:t.viewBox?t.viewBox:{}},q3e=function(t,r){return t?t===!0?te.createElement(Pa,{key:"label-implicit",viewBox:r}):Hs(t)?te.createElement(Pa,{key:"label-implicit",viewBox:r,value:t}):y.isValidElement(t)?t.type===Pa?y.cloneElement(t,{key:"label-implicit",viewBox:r}):te.createElement(Pa,{key:"label-implicit",content:t,viewBox:r}):$r(t)?te.createElement(Pa,{key:"label-implicit",content:t,viewBox:r}):Tp(t)?te.createElement(Pa,vy({viewBox:r},t,{key:"label-implicit"})):null:null},V3e=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=JG(t),o=co(a,Pa).map(function(c,d){return y.cloneElement(c,{viewBox:r||i,key:"label-".concat(d)})});if(!n)return o;var l=q3e(t.label,r||i);return[l].concat(E3e(o))};Pa.parseViewBox=JG;Pa.renderCallByParent=V3e;function W3e(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var H3e=W3e;const G3e=wn(H3e);function yy(e){"@babel/helpers - typeof";return yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yy(e)}var Y3e=["valueAccessor"],K3e=["data","dataKey","clockWise","id","textBreakAll"];function Z3e(e){return eDe(e)||Q3e(e)||J3e(e)||X3e()}function X3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J3e(e,t){if(e){if(typeof e=="string")return VE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VE(e,t)}}function Q3e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eDe(e){if(Array.isArray(e))return VE(e)}function VE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ib(){return ib=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ib.apply(this,arguments)}function _I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_I(Object(r),!0).forEach(function(n){tDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_I(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tDe(e,t,r){return t=rDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rDe(e){var t=nDe(e,"string");return yy(t)=="symbol"?t:t+""}function nDe(e,t){if(yy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bI(e,t){if(e==null)return{};var r=sDe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function sDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var aDe=function(t){return Array.isArray(t.value)?G3e(t.value):t.value};function Cc(e){var t=e.valueAccessor,r=t===void 0?aDe:t,n=bI(e,Y3e),a=n.data,i=n.dataKey,o=n.clockWise,l=n.id,c=n.textBreakAll,d=bI(n,K3e);return!a||!a.length?null:te.createElement(Wn,{className:"recharts-label-list"},a.map(function(f,u){var h=Zr(i)?r(f,u):Ka(f&&f.payload,i),m=Zr(l)?{}:{id:"".concat(l,"-").concat(u)};return te.createElement(Pa,ib({},qr(f,!0),d,m,{parentViewBox:f.parentViewBox,value:h,textBreakAll:c,viewBox:Pa.parseViewBox(Zr(o)?f:wI(wI({},f),{},{clockWise:o})),key:"label-".concat(u),index:u}))}))}Cc.displayName="LabelList";function iDe(e,t){return e?e===!0?te.createElement(Cc,{key:"labelList-implicit",data:t}):te.isValidElement(e)||$r(e)?te.createElement(Cc,{key:"labelList-implicit",data:t,content:e}):Tp(e)?te.createElement(Cc,ib({data:t},e,{key:"labelList-implicit"})):null:null}function oDe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=co(n,Cc).map(function(o,l){return y.cloneElement(o,{data:t,key:"labelList-".concat(l)})});if(!r)return a;var i=iDe(e.label,t);return[i].concat(Z3e(a))}Cc.renderCallByParent=oDe;function xy(e){"@babel/helpers - typeof";return xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xy(e)}function WE(){return WE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},WE.apply(this,arguments)}function jI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function NI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jI(Object(r),!0).forEach(function(n){lDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lDe(e,t,r){return t=cDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cDe(e){var t=dDe(e,"string");return xy(t)=="symbol"?t:t+""}function dDe(e,t){if(xy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uDe=function(t,r){var n=qo(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},Vx=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,o=t.sign,l=t.isExternal,c=t.cornerRadius,d=t.cornerIsExternal,f=c*(l?1:-1)+a,u=Math.asin(c/f)/ab,h=d?i:i+o*u,m=pa(r,n,f,h),v=pa(r,n,a,h),g=d?i-o*u:i,x=pa(r,n,f*Math.cos(u*ab),g);return{center:m,circleTangency:v,lineTangency:x,theta:u}},QG=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.startAngle,l=t.endAngle,c=uDe(o,l),d=o+c,f=pa(r,n,i,o),u=pa(r,n,i,d),h="M ".concat(f.x,",").concat(f.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>d),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(a>0){var m=pa(r,n,a,o),v=pa(r,n,a,d);h+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=d),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},fDe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,f=t.endAngle,u=qo(f-d),h=Vx({cx:r,cy:n,radius:i,angle:d,sign:u,cornerRadius:o,cornerIsExternal:c}),m=h.circleTangency,v=h.lineTangency,g=h.theta,x=Vx({cx:r,cy:n,radius:i,angle:f,sign:-u,cornerRadius:o,cornerIsExternal:c}),_=x.circleTangency,w=x.lineTangency,b=x.theta,N=c?Math.abs(d-f):Math.abs(d-f)-g-b;if(N<0)return l?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):QG({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:f});var S="M ".concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(N>180),",").concat(+(u<0),",").concat(_.x,",").concat(_.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(w.x,",").concat(w.y,`
  `);if(a>0){var k=Vx({cx:r,cy:n,radius:a,angle:d,sign:u,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),C=k.circleTangency,A=k.lineTangency,R=k.theta,I=Vx({cx:r,cy:n,radius:a,angle:f,sign:-u,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),O=I.circleTangency,z=I.lineTangency,M=I.theta,B=c?Math.abs(d-f):Math.abs(d-f)-R-M;if(B<0&&o===0)return"".concat(S,"L").concat(r,",").concat(n,"Z");S+="L".concat(z.x,",").concat(z.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(O.x,",").concat(O.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(B>180),",").concat(+(u>0),",").concat(C.x,",").concat(C.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(A.x,",").concat(A.y,"Z")}else S+="L".concat(r,",").concat(n,"Z");return S},hDe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},eY=function(t){var r=NI(NI({},hDe),t),n=r.cx,a=r.cy,i=r.innerRadius,o=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,d=r.cornerIsExternal,f=r.startAngle,u=r.endAngle,h=r.className;if(o<i||f===u)return null;var m=on("recharts-sector",h),v=o-i,g=bf(l,v,0,!0),x;return g>0&&Math.abs(f-u)<360?x=fDe({cx:n,cy:a,innerRadius:i,outerRadius:o,cornerRadius:Math.min(g,v/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:f,endAngle:u}):x=QG({cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:f,endAngle:u}),te.createElement("path",WE({},qr(r,!0),{className:m,d:x,role:"img"}))};function _y(e){"@babel/helpers - typeof";return _y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_y(e)}function HE(){return HE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HE.apply(this,arguments)}function SI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SI(Object(r),!0).forEach(function(n){mDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mDe(e,t,r){return t=pDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pDe(e){var t=gDe(e,"string");return _y(t)=="symbol"?t:t+""}function gDe(e,t){if(_y(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_y(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EI={curveBasisClosed:mNe,curveBasisOpen:pNe,curveBasis:hNe,curveBumpX:Qje,curveBumpY:eNe,curveLinearClosed:gNe,curveLinear:gj,curveMonotoneX:vNe,curveMonotoneY:yNe,curveNatural:xNe,curveStep:_Ne,curveStepAfter:bNe,curveStepBefore:wNe},Wx=function(t){return t.x===+t.x&&t.y===+t.y},Tg=function(t){return t.x},Ag=function(t){return t.y},vDe=function(t,r){if($r(t))return t;var n="curve".concat(mj(t));return(n==="curveMonotone"||n==="curveBump")&&r?EI["".concat(n).concat(r==="vertical"?"Y":"X")]:EI[n]||gj},yDe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,o=t.baseLine,l=t.layout,c=t.connectNulls,d=c===void 0?!1:c,f=vDe(n,l),u=d?i.filter(function(g){return Wx(g)}):i,h;if(Array.isArray(o)){var m=d?o.filter(function(g){return Wx(g)}):o,v=u.map(function(g,x){return kI(kI({},g),{},{base:m[x]})});return l==="vertical"?h=Dx().y(Ag).x1(Tg).x0(function(g){return g.base.x}):h=Dx().x(Tg).y1(Ag).y0(function(g){return g.base.y}),h.defined(Wx).curve(f),h(v)}return l==="vertical"&&bt(o)?h=Dx().y(Ag).x1(Tg).x0(o):bt(o)?h=Dx().x(Tg).y1(Ag).y0(o):h=eH().x(Tg).y(Ag),h.defined(Wx).curve(f),h(u)},im=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var o=n&&n.length?yDe(t):a;return y.createElement("path",HE({},qr(t,!1),Cw(t),{className:on("recharts-curve",r),d:o,ref:i}))},xDe=Object.getOwnPropertyNames,_De=Object.getOwnPropertySymbols,wDe=Object.prototype.hasOwnProperty;function CI(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function Hx(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var i=a.cache,o=i.get(r),l=i.get(n);if(o&&l)return o===n&&l===r;i.set(r,n),i.set(n,r);var c=e(r,n,a);return i.delete(r),i.delete(n),c}}function PI(e){return xDe(e).concat(_De(e))}var bDe=Object.hasOwn||function(e,t){return wDe.call(e,t)};function Ff(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var jDe="__v",NDe="__o",SDe="_owner",TI=Object.getOwnPropertyDescriptor,AI=Object.keys;function kDe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function EDe(e,t){return Ff(e.getTime(),t.getTime())}function CDe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function PDe(e,t){return e===t}function RI(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.entries(),o,l,c=0;(o=i.next())&&!o.done;){for(var d=t.entries(),f=!1,u=0;(l=d.next())&&!l.done;){if(a[u]){u++;continue}var h=o.value,m=l.value;if(r.equals(h[0],m[0],c,u,e,t,r)&&r.equals(h[1],m[1],h[0],m[0],e,t,r)){f=a[u]=!0;break}u++}if(!f)return!1;c++}return!0}var TDe=Ff;function ADe(e,t,r){var n=AI(e),a=n.length;if(AI(t).length!==a)return!1;for(;a-- >0;)if(!tY(e,t,r,n[a]))return!1;return!0}function Rg(e,t,r){var n=PI(e),a=n.length;if(PI(t).length!==a)return!1;for(var i,o,l;a-- >0;)if(i=n[a],!tY(e,t,r,i)||(o=TI(e,i),l=TI(t,i),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function RDe(e,t){return Ff(e.valueOf(),t.valueOf())}function ODe(e,t){return e.source===t.source&&e.flags===t.flags}function OI(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.values(),o,l;(o=i.next())&&!o.done;){for(var c=t.values(),d=!1,f=0;(l=c.next())&&!l.done;){if(!a[f]&&r.equals(o.value,l.value,o.value,l.value,e,t,r)){d=a[f]=!0;break}f++}if(!d)return!1}return!0}function MDe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function DDe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function tY(e,t,r,n){return(n===SDe||n===NDe||n===jDe)&&(e.$$typeof||t.$$typeof)?!0:bDe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var IDe="[object Arguments]",$De="[object Boolean]",LDe="[object Date]",FDe="[object Error]",zDe="[object Map]",BDe="[object Number]",UDe="[object Object]",qDe="[object RegExp]",VDe="[object Set]",WDe="[object String]",HDe="[object URL]",GDe=Array.isArray,MI=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,DI=Object.assign,YDe=Object.prototype.toString.call.bind(Object.prototype.toString);function KDe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,o=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,f=e.areSetsEqual,u=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(v,g,x){if(v===g)return!0;if(v==null||g==null)return!1;var _=typeof v;if(_!==typeof g)return!1;if(_!=="object")return _==="number"?o(v,g,x):_==="function"?a(v,g,x):!1;var w=v.constructor;if(w!==g.constructor)return!1;if(w===Object)return l(v,g,x);if(GDe(v))return t(v,g,x);if(MI!=null&&MI(v))return u(v,g,x);if(w===Date)return r(v,g,x);if(w===RegExp)return d(v,g,x);if(w===Map)return i(v,g,x);if(w===Set)return f(v,g,x);var b=YDe(v);return b===LDe?r(v,g,x):b===qDe?d(v,g,x):b===zDe?i(v,g,x):b===VDe?f(v,g,x):b===UDe?typeof v.then!="function"&&typeof g.then!="function"&&l(v,g,x):b===HDe?h(v,g,x):b===FDe?n(v,g,x):b===IDe?l(v,g,x):b===$De||b===BDe||b===WDe?c(v,g,x):!1}}function ZDe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Rg:kDe,areDatesEqual:EDe,areErrorsEqual:CDe,areFunctionsEqual:PDe,areMapsEqual:n?CI(RI,Rg):RI,areNumbersEqual:TDe,areObjectsEqual:n?Rg:ADe,arePrimitiveWrappersEqual:RDe,areRegExpsEqual:ODe,areSetsEqual:n?CI(OI,Rg):OI,areTypedArraysEqual:n?Rg:MDe,areUrlsEqual:DDe};if(r&&(a=DI({},a,r(a))),t){var i=Hx(a.areArraysEqual),o=Hx(a.areMapsEqual),l=Hx(a.areObjectsEqual),c=Hx(a.areSetsEqual);a=DI({},a,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:c})}return a}function XDe(e){return function(t,r,n,a,i,o,l){return e(t,r,l)}}function JDe(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(c,d){var f=n(),u=f.cache,h=u===void 0?t?new WeakMap:void 0:u,m=f.meta;return r(c,d,{cache:h,equals:a,meta:m,strict:i})};if(t)return function(c,d){return r(c,d,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var o={cache:void 0,equals:a,meta:void 0,strict:i};return function(c,d){return r(c,d,o)}}var QDe=cu();cu({strict:!0});cu({circular:!0});cu({circular:!0,strict:!0});cu({createInternalComparator:function(){return Ff}});cu({strict:!0,createInternalComparator:function(){return Ff}});cu({circular:!0,createInternalComparator:function(){return Ff}});cu({circular:!0,createInternalComparator:function(){return Ff},strict:!0});function cu(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,o=i===void 0?!1:i,l=ZDe(e),c=KDe(l),d=n?n(c):XDe(c);return JDe({circular:r,comparator:c,createState:a,equals:d,strict:o})}function eIe(e){typeof requestAnimationFrame!="undefined"&&requestAnimationFrame(e)}function II(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):eIe(a)};requestAnimationFrame(n)}function GE(e){"@babel/helpers - typeof";return GE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},GE(e)}function tIe(e){return aIe(e)||sIe(e)||nIe(e)||rIe()}function rIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nIe(e,t){if(e){if(typeof e=="string")return $I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $I(e,t)}}function $I(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sIe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aIe(e){if(Array.isArray(e))return e}function iIe(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,l=tIe(o),c=l[0],d=l.slice(1);if(typeof c=="number"){II(a.bind(null,d),c);return}a(c),II(a.bind(null,d));return}GE(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function wy(e){"@babel/helpers - typeof";return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wy(e)}function LI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function FI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LI(Object(r),!0).forEach(function(n){rY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rY(e,t,r){return t=oIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oIe(e){var t=lIe(e,"string");return wy(t)==="symbol"?t:String(t)}function lIe(e,t){if(wy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cIe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},dIe=function(t){return t},uIe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},fv=function(t,r){return Object.keys(r).reduce(function(n,a){return FI(FI({},n),{},rY({},a,t(a,r[a])))},{})},zI=function(t,r,n){return t.map(function(a){return"".concat(uIe(a)," ").concat(r,"ms ").concat(n)}).join(",")};function fIe(e,t){return pIe(e)||mIe(e,t)||nY(e,t)||hIe()}function hIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mIe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(f){d=!0,a=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function pIe(e){if(Array.isArray(e))return e}function gIe(e){return xIe(e)||yIe(e)||nY(e)||vIe()}function vIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nY(e,t){if(e){if(typeof e=="string")return YE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YE(e,t)}}function yIe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xIe(e){if(Array.isArray(e))return YE(e)}function YE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ob=1e-4,sY=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},aY=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},BI=function(t,r){return function(n){var a=sY(t,r);return aY(a,n)}},_Ie=function(t,r){return function(n){var a=sY(t,r),i=[].concat(gIe(a.map(function(o,l){return o*l}).slice(1)),[0]);return aY(i,n)}},UI=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],o=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,o=1,l=1;break;case"ease":a=.25,i=.1,o=.25,l=1;break;case"ease-in":a=.42,i=0,o=1,l=1;break;case"ease-out":a=.42,i=0,o=.58,l=1;break;case"ease-in-out":a=0,i=0,o=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var d=c[1].split(")")[0].split(",").map(function(x){return parseFloat(x)}),f=fIe(d,4);a=f[0],i=f[1],o=f[2],l=f[3]}}}var u=BI(a,o),h=BI(i,l),m=_Ie(a,o),v=function(_){return _>1?1:_<0?0:_},g=function(_){for(var w=_>1?1:_,b=w,N=0;N<8;++N){var S=u(b)-w,k=m(b);if(Math.abs(S-w)<ob||k<ob)return h(b);b=v(b-S/k)}return h(b)};return g.isStepper=!1,g},wIe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,o=t.dt,l=o===void 0?17:o,c=function(f,u,h){var m=-(f-u)*n,v=h*i,g=h+(m-v)*l/1e3,x=h*l/1e3+f;return Math.abs(x-u)<ob&&Math.abs(g)<ob?[u,0]:[x,g]};return c.isStepper=!0,c.dt=l,c},bIe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return UI(a);case"spring":return wIe();default:if(a.split("(")[0]==="cubic-bezier")return UI(a)}return typeof a=="function"?a:null};function by(e){"@babel/helpers - typeof";return by=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},by(e)}function qI(e){return SIe(e)||NIe(e)||iY(e)||jIe()}function jIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NIe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function SIe(e){if(Array.isArray(e))return ZE(e)}function VI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function da(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VI(Object(r),!0).forEach(function(n){KE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KE(e,t,r){return t=kIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kIe(e){var t=EIe(e,"string");return by(t)==="symbol"?t:String(t)}function EIe(e,t){if(by(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(by(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CIe(e,t){return AIe(e)||TIe(e,t)||iY(e,t)||PIe()}function PIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iY(e,t){if(e){if(typeof e=="string")return ZE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZE(e,t)}}function ZE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TIe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(f){d=!0,a=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function AIe(e){if(Array.isArray(e))return e}var lb=function(t,r,n){return t+(r-t)*n},XE=function(t){var r=t.from,n=t.to;return r!==n},RIe=function e(t,r,n){var a=fv(function(i,o){if(XE(o)){var l=t(o.from,o.to,o.velocity),c=CIe(l,2),d=c[0],f=c[1];return da(da({},o),{},{from:d,velocity:f})}return o},r);return n<1?fv(function(i,o){return XE(o)?da(da({},o),{},{velocity:lb(o.velocity,a[i].velocity,n),from:lb(o.from,a[i].from,n)}):o},r):e(t,a,n-1)};const OIe=function(e,t,r,n,a){var i=cIe(e,t),o=i.reduce(function(x,_){return da(da({},x),{},KE({},_,[e[_],t[_]]))},{}),l=i.reduce(function(x,_){return da(da({},x),{},KE({},_,{from:e[_],velocity:0,to:t[_]}))},{}),c=-1,d,f,u=function(){return null},h=function(){return fv(function(_,w){return w.from},l)},m=function(){return!Object.values(l).filter(XE).length},v=function(_){d||(d=_);var w=_-d,b=w/r.dt;l=RIe(r,l,b),a(da(da(da({},e),t),h())),d=_,m()||(c=requestAnimationFrame(u))},g=function(_){f||(f=_);var w=(_-f)/n,b=fv(function(S,k){return lb.apply(void 0,qI(k).concat([r(w)]))},o);if(a(da(da(da({},e),t),b)),w<1)c=requestAnimationFrame(u);else{var N=fv(function(S,k){return lb.apply(void 0,qI(k).concat([r(1)]))},o);a(da(da(da({},e),t),N))}};return u=r.isStepper?v:g,function(){return requestAnimationFrame(u),function(){cancelAnimationFrame(c)}}};function Gm(e){"@babel/helpers - typeof";return Gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gm(e)}var MIe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function DIe(e,t){if(e==null)return{};var r=IIe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function IIe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function BS(e){return zIe(e)||FIe(e)||LIe(e)||$Ie()}function $Ie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LIe(e,t){if(e){if(typeof e=="string")return JE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JE(e,t)}}function FIe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zIe(e){if(Array.isArray(e))return JE(e)}function JE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WI(Object(r),!0).forEach(function(n){Wg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wg(e,t,r){return t=oY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UIe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oY(n.key),n)}}function qIe(e,t,r){return t&&UIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oY(e){var t=VIe(e,"string");return Gm(t)==="symbol"?t:String(t)}function VIe(e,t){if(Gm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QE(e,t)}function QE(e,t){return QE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},QE(e,t)}function HIe(e){var t=GIe();return function(){var n=cb(e),a;if(t){var i=cb(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return eC(this,a)}}function eC(e,t){if(t&&(Gm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tC(e)}function tC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GIe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function cb(e){return cb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cb(e)}var ql=function(e){WIe(r,e);var t=HIe(r);function r(n,a){var i;BIe(this,r),i=t.call(this,n,a);var o=i.props,l=o.isActive,c=o.attributeName,d=o.from,f=o.to,u=o.steps,h=o.children,m=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(tC(i)),i.changeStyle=i.changeStyle.bind(tC(i)),!l||m<=0)return i.state={style:{}},typeof h=="function"&&(i.state={style:f}),eC(i);if(u&&u.length)i.state={style:u[0].style};else if(d){if(typeof h=="function")return i.state={style:d},eC(i);i.state={style:c?Wg({},c,d):d}}else i.state={style:{}};return i}return qIe(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,o=a.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,o=i.isActive,l=i.canBegin,c=i.attributeName,d=i.shouldReAnimate,f=i.to,u=i.from,h=this.state.style;if(l){if(!o){var m={style:c?Wg({},c,f):f};this.state&&h&&(c&&h[c]!==f||!c&&h!==f)&&this.setState(m);return}if(!(QDe(a.to,f)&&a.canBegin&&a.isActive)){var v=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=v||d?u:a.to;if(this.state&&h){var x={style:c?Wg({},c,g):g};(c&&h[c]!==g||!c&&h!==g)&&this.setState(x)}this.runAnimation(bo(bo({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,o=a.from,l=a.to,c=a.duration,d=a.easing,f=a.begin,u=a.onAnimationEnd,h=a.onAnimationStart,m=OIe(o,l,bIe(d),c,this.changeStyle),v=function(){i.stopJSAnimation=m()};this.manager.start([h,f,v,c,u])}},{key:"runStepAnimation",value:function(a){var i=this,o=a.steps,l=a.begin,c=a.onAnimationStart,d=o[0],f=d.style,u=d.duration,h=u===void 0?0:u,m=function(g,x,_){if(_===0)return g;var w=x.duration,b=x.easing,N=b===void 0?"ease":b,S=x.style,k=x.properties,C=x.onAnimationEnd,A=_>0?o[_-1]:x,R=k||Object.keys(S);if(typeof N=="function"||N==="spring")return[].concat(BS(g),[i.runJSAnimation.bind(i,{from:A.style,to:S,duration:w,easing:N}),w]);var I=zI(R,w,N),O=bo(bo(bo({},A.style),S),{},{transition:I});return[].concat(BS(g),[O,w,C]).filter(dIe)};return this.manager.start([c].concat(BS(o.reduce(m,[f,Math.max(h,l)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=iIe());var i=a.begin,o=a.duration,l=a.attributeName,c=a.to,d=a.easing,f=a.onAnimationStart,u=a.onAnimationEnd,h=a.steps,m=a.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof d=="function"||typeof m=="function"||d==="spring"){this.runJSAnimation(a);return}if(h.length>1){this.runStepAnimation(a);return}var g=l?Wg({},l,c):c,x=zI(Object.keys(g),o,d);v.start([f,i,bo(bo({},g),{},{transition:x}),o,u])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var l=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var c=DIe(a,MIe),d=y.Children.count(i),f=this.state.style;if(typeof i=="function")return i(f);if(!l||d===0||o<=0)return i;var u=function(m){var v=m.props,g=v.style,x=g===void 0?{}:g,_=v.className,w=y.cloneElement(m,bo(bo({},c),{},{style:bo(bo({},x),f),className:_}));return w};return d===1?u(y.Children.only(i)):te.createElement("div",null,y.Children.map(i,function(h){return u(h)}))}}]),r}(y.PureComponent);ql.displayName="Animate";ql.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};ql.propTypes={from:ot.oneOfType([ot.object,ot.string]),to:ot.oneOfType([ot.object,ot.string]),attributeName:ot.string,duration:ot.number,begin:ot.number,easing:ot.oneOfType([ot.string,ot.func]),steps:ot.arrayOf(ot.shape({duration:ot.number.isRequired,style:ot.object.isRequired,easing:ot.oneOfType([ot.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),ot.func]),properties:ot.arrayOf("string"),onAnimationEnd:ot.func})),children:ot.oneOfType([ot.node,ot.func]),isActive:ot.bool,canBegin:ot.bool,onAnimationEnd:ot.func,shouldReAnimate:ot.bool,onAnimationStart:ot.func,onAnimationReStart:ot.func};function jy(e){"@babel/helpers - typeof";return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jy(e)}function db(){return db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},db.apply(this,arguments)}function YIe(e,t){return JIe(e)||XIe(e,t)||ZIe(e,t)||KIe()}function KIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZIe(e,t){if(e){if(typeof e=="string")return HI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HI(e,t)}}function HI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XIe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(f){d=!0,a=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function JIe(e){if(Array.isArray(e))return e}function GI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function YI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GI(Object(r),!0).forEach(function(n){QIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QIe(e,t,r){return t=e$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e$e(e){var t=t$e(e,"string");return jy(t)=="symbol"?t:t+""}function t$e(e,t){if(jy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KI=function(t,r,n,a,i){var o=Math.min(Math.abs(n)/2,Math.abs(a)/2),l=a>=0?1:-1,c=n>=0?1:-1,d=a>=0&&n>=0||a<0&&n<0?1:0,f;if(o>0&&i instanceof Array){for(var u=[0,0,0,0],h=0,m=4;h<m;h++)u[h]=i[h]>o?o:i[h];f="M".concat(t,",").concat(r+l*u[0]),u[0]>0&&(f+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(d,",").concat(t+c*u[0],",").concat(r)),f+="L ".concat(t+n-c*u[1],",").concat(r),u[1]>0&&(f+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(d,`,
        `).concat(t+n,",").concat(r+l*u[1])),f+="L ".concat(t+n,",").concat(r+a-l*u[2]),u[2]>0&&(f+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(d,`,
        `).concat(t+n-c*u[2],",").concat(r+a)),f+="L ".concat(t+c*u[3],",").concat(r+a),u[3]>0&&(f+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+a-l*u[3])),f+="Z"}else if(o>0&&i===+i&&i>0){var v=Math.min(o,i);f="M ".concat(t,",").concat(r+l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+c*v,",").concat(r,`
            L `).concat(t+n-c*v,",").concat(r,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+n,",").concat(r+l*v,`
            L `).concat(t+n,",").concat(r+a-l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+n-c*v,",").concat(r+a,`
            L `).concat(t+c*v,",").concat(r+a,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t,",").concat(r+a-l*v," Z")}else f="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return f},r$e=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,o=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var d=Math.min(i,i+l),f=Math.max(i,i+l),u=Math.min(o,o+c),h=Math.max(o,o+c);return n>=d&&n<=f&&a>=u&&a<=h}return!1},n$e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},C5=function(t){var r=YI(YI({},n$e),t),n=y.useRef(),a=y.useState(-1),i=YIe(a,2),o=i[0],l=i[1];y.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var N=n.current.getTotalLength();N&&l(N)}catch(S){}},[]);var c=r.x,d=r.y,f=r.width,u=r.height,h=r.radius,m=r.className,v=r.animationEasing,g=r.animationDuration,x=r.animationBegin,_=r.isAnimationActive,w=r.isUpdateAnimationActive;if(c!==+c||d!==+d||f!==+f||u!==+u||f===0||u===0)return null;var b=on("recharts-rectangle",m);return w?te.createElement(ql,{canBegin:o>0,from:{width:f,height:u,x:c,y:d},to:{width:f,height:u,x:c,y:d},duration:g,animationEasing:v,isActive:w},function(N){var S=N.width,k=N.height,C=N.x,A=N.y;return te.createElement(ql,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:x,duration:g,isActive:_,easing:v},te.createElement("path",db({},qr(r,!0),{className:b,d:KI(C,A,S,k,h),ref:n})))}):te.createElement("path",db({},qr(r,!0),{className:b,d:KI(c,d,f,u,h)}))};function rC(){return rC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rC.apply(this,arguments)}var Tj=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,o=on("recharts-dot",i);return r===+r&&n===+n&&a===+a?y.createElement("circle",rC({},qr(t,!1),Cw(t),{className:o,cx:r,cy:n,r:a})):null};function Ny(e){"@babel/helpers - typeof";return Ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ny(e)}var s$e=["x","y","top","left","width","height","className"];function nC(){return nC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nC.apply(this,arguments)}function ZI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function a$e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZI(Object(r),!0).forEach(function(n){i$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i$e(e,t,r){return t=o$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o$e(e){var t=l$e(e,"string");return Ny(t)=="symbol"?t:t+""}function l$e(e,t){if(Ny(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ny(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function c$e(e,t){if(e==null)return{};var r=d$e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function d$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var u$e=function(t,r,n,a,i,o){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(n)},f$e=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.top,l=o===void 0?0:o,c=t.left,d=c===void 0?0:c,f=t.width,u=f===void 0?0:f,h=t.height,m=h===void 0?0:h,v=t.className,g=c$e(t,s$e),x=a$e({x:n,y:i,top:l,left:d,width:u,height:m},g);return!bt(n)||!bt(i)||!bt(u)||!bt(m)||!bt(l)||!bt(d)?null:te.createElement("path",nC({},qr(x,!0),{className:on("recharts-cross",v),d:u$e(n,i,u,m,l,d)}))},h$e=NH,m$e=h$e(Object.getPrototypeOf,Object),p$e=m$e,g$e=Hc,v$e=p$e,y$e=Gc,x$e="[object Object]",_$e=Function.prototype,w$e=Object.prototype,lY=_$e.toString,b$e=w$e.hasOwnProperty,j$e=lY.call(Object);function N$e(e){if(!y$e(e)||g$e(e)!=x$e)return!1;var t=v$e(e);if(t===null)return!0;var r=b$e.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&lY.call(r)==j$e}var S$e=N$e;const k$e=wn(S$e);var E$e=Hc,C$e=Gc,P$e="[object Boolean]";function T$e(e){return e===!0||e===!1||C$e(e)&&E$e(e)==P$e}var A$e=T$e;const R$e=wn(A$e);function Sy(e){"@babel/helpers - typeof";return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sy(e)}function ub(){return ub=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ub.apply(this,arguments)}function O$e(e,t){return $$e(e)||I$e(e,t)||D$e(e,t)||M$e()}function M$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D$e(e,t){if(e){if(typeof e=="string")return XI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XI(e,t)}}function XI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function I$e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(f){d=!0,a=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function $$e(e){if(Array.isArray(e))return e}function JI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function QI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JI(Object(r),!0).forEach(function(n){L$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L$e(e,t,r){return t=F$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F$e(e){var t=z$e(e,"string");return Sy(t)=="symbol"?t:t+""}function z$e(e,t){if(Sy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var e$=function(t,r,n,a,i){var o=n-a,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-o/2,",").concat(r+i),l+="L ".concat(t+n-o/2-a,",").concat(r+i),l+="L ".concat(t,",").concat(r," Z"),l},B$e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},U$e=function(t){var r=QI(QI({},B$e),t),n=y.useRef(),a=y.useState(-1),i=O$e(a,2),o=i[0],l=i[1];y.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var b=n.current.getTotalLength();b&&l(b)}catch(N){}},[]);var c=r.x,d=r.y,f=r.upperWidth,u=r.lowerWidth,h=r.height,m=r.className,v=r.animationEasing,g=r.animationDuration,x=r.animationBegin,_=r.isUpdateAnimationActive;if(c!==+c||d!==+d||f!==+f||u!==+u||h!==+h||f===0&&u===0||h===0)return null;var w=on("recharts-trapezoid",m);return _?te.createElement(ql,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:h,x:c,y:d},to:{upperWidth:f,lowerWidth:u,height:h,x:c,y:d},duration:g,animationEasing:v,isActive:_},function(b){var N=b.upperWidth,S=b.lowerWidth,k=b.height,C=b.x,A=b.y;return te.createElement(ql,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:x,duration:g,easing:v},te.createElement("path",ub({},qr(r,!0),{className:w,d:e$(C,A,N,S,k),ref:n})))}):te.createElement("g",null,te.createElement("path",ub({},qr(r,!0),{className:w,d:e$(c,d,f,u,h)})))},q$e=["option","shapeType","propTransformer","activeClassName","isActive"];function ky(e){"@babel/helpers - typeof";return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ky(e)}function V$e(e,t){if(e==null)return{};var r=W$e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function W$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function t$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t$(Object(r),!0).forEach(function(n){H$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function H$e(e,t,r){return t=G$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G$e(e){var t=Y$e(e,"string");return ky(t)=="symbol"?t:t+""}function Y$e(e,t){if(ky(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ky(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function K$e(e,t){return fb(fb({},t),e)}function Z$e(e,t){return e==="symbols"}function r$(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return te.createElement(C5,r);case"trapezoid":return te.createElement(U$e,r);case"sector":return te.createElement(eY,r);case"symbols":if(Z$e(t))return te.createElement(GA,r);break;default:return null}}function X$e(e){return y.isValidElement(e)?e.props:e}function J$e(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?K$e:n,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,l=e.isActive,c=V$e(e,q$e),d;if(y.isValidElement(t))d=y.cloneElement(t,fb(fb({},c),X$e(t)));else if($r(t))d=t(c);else if(k$e(t)&&!R$e(t)){var f=a(t,c);d=te.createElement(r$,{shapeType:r,elementProps:f})}else{var u=c;d=te.createElement(r$,{shapeType:r,elementProps:u})}return l?te.createElement(Wn,{className:o},d):d}function Aj(e,t){return t!=null&&"trapezoids"in e.props}function Rj(e,t){return t!=null&&"sectors"in e.props}function Ey(e,t){return t!=null&&"points"in e.props}function Q$e(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function eLe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function tLe(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function rLe(e,t){var r;return Aj(e,t)?r=Q$e:Rj(e,t)?r=eLe:Ey(e,t)&&(r=tLe),r}function nLe(e,t){var r;return Aj(e,t)?r="trapezoids":Rj(e,t)?r="sectors":Ey(e,t)&&(r="points"),r}function sLe(e,t){if(Aj(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(Rj(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Ey(e,t)?t.payload:{}}function aLe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=nLe(r,t),i=sLe(r,t),o=n.filter(function(c,d){var f=Wm(i,c),u=r.props[a].filter(function(v){var g=rLe(r,t);return g(v,t)}),h=r.props[a].indexOf(u[u.length-1]),m=d===h;return f&&m}),l=n.indexOf(o[o.length-1]);return l}var iLe=Math.ceil,oLe=Math.max;function lLe(e,t,r,n){for(var a=-1,i=oLe(iLe((t-e)/(r||1)),0),o=Array(i);i--;)o[n?i:++a]=e,e+=r;return o}var cLe=lLe,dLe=qH,n$=1/0,uLe=17976931348623157e292;function fLe(e){if(!e)return e===0?e:0;if(e=dLe(e),e===n$||e===-n$){var t=e<0?-1:1;return t*uLe}return e===e?e:0}var cY=fLe,hLe=cLe,mLe=_j,US=cY;function pLe(e){return function(t,r,n){return n&&typeof n!="number"&&mLe(t,r,n)&&(r=n=void 0),t=US(t),r===void 0?(r=t,t=0):r=US(r),n=n===void 0?t<r?1:-1:US(n),hLe(t,r,n,e)}}var gLe=pLe,vLe=gLe,yLe=vLe(),xLe=yLe;const hb=wn(xLe);function Cy(e){"@babel/helpers - typeof";return Cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cy(e)}function s$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function a$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s$(Object(r),!0).forEach(function(n){dY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dY(e,t,r){return t=_Le(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Le(e){var t=wLe(e,"string");return Cy(t)=="symbol"?t:t+""}function wLe(e,t){if(Cy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bLe=["Webkit","Moz","O","ms"],jLe=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=bLe.reduce(function(i,o){return a$(a$({},i),{},dY({},o+n,r))},{});return a[t]=r,a};function Ym(e){"@babel/helpers - typeof";return Ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ym(e)}function mb(){return mb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mb.apply(this,arguments)}function i$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i$(Object(r),!0).forEach(function(n){Si(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fY(n.key),n)}}function SLe(e,t,r){return t&&o$(e.prototype,t),r&&o$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kLe(e,t,r){return t=pb(t),ELe(e,uY()?Reflect.construct(t,r||[],pb(e).constructor):t.apply(e,r))}function ELe(e,t){if(t&&(Ym(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CLe(e)}function CLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(uY=function(){return!!e})()}function pb(e){return pb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pb(e)}function PLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sC(e,t)}function sC(e,t){return sC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},sC(e,t)}function Si(e,t,r){return t=fY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fY(e){var t=TLe(e,"string");return Ym(t)=="symbol"?t:t+""}function TLe(e,t){if(Ym(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ym(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ALe=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,o=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,d=dv().domain(hb(0,c)).range([i,i+o-l]),f=d.domain().map(function(u){return d(u)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(n),endX:d(a),scale:d,scaleValues:f}},l$=function(t){return t.changedTouches&&!!t.changedTouches.length},Km=function(e){function t(r){var n;return NLe(this,t),n=kLe(this,t,[r]),Si(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),Si(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),Si(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,o=a.onDragEnd,l=a.startIndex;o==null||o({endIndex:i,startIndex:l})}),n.detachDragEndListener()}),Si(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Si(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Si(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Si(n,"handleSlideDragStart",function(a){var i=l$(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return PLe(t,e),SLe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,o=this.state.scaleValues,l=this.props,c=l.gap,d=l.data,f=d.length-1,u=Math.min(a,i),h=Math.max(a,i),m=t.getIndexInRange(o,u),v=t.getIndexInRange(o,h);return{startIndex:m-m%c,endIndex:v===f?f:v-v%c}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,o=a.tickFormatter,l=a.dataKey,c=Ka(i[n],l,n);return $r(o)?o(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,o=a.startX,l=a.endX,c=this.props,d=c.x,f=c.width,u=c.travellerWidth,h=c.startIndex,m=c.endIndex,v=c.onChange,g=n.pageX-i;g>0?g=Math.min(g,d+f-u-l,d+f-u-o):g<0&&(g=Math.max(g,d-o,d-l));var x=this.getIndex({startX:o+g,endX:l+g});(x.startIndex!==h||x.endIndex!==m)&&v&&v(x),this.setState({startX:o+g,endX:l+g,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=l$(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,o=a.movingTravellerId,l=a.endX,c=a.startX,d=this.state[o],f=this.props,u=f.x,h=f.width,m=f.travellerWidth,v=f.onChange,g=f.gap,x=f.data,_={startX:this.state.startX,endX:this.state.endX},w=n.pageX-i;w>0?w=Math.min(w,u+h-m-d):w<0&&(w=Math.max(w,u-d)),_[o]=d+w;var b=this.getIndex(_),N=b.startIndex,S=b.endIndex,k=function(){var A=x.length-1;return o==="startX"&&(l>c?N%g===0:S%g===0)||l<c&&S===A||o==="endX"&&(l>c?S%g===0:N%g===0)||l>c&&S===A};this.setState(Si(Si({},o,d+w),"brushMoveStartX",n.pageX),function(){v&&k()&&v(b)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,o=this.state,l=o.scaleValues,c=o.startX,d=o.endX,f=this.state[a],u=l.indexOf(f);if(u!==-1){var h=u+n;if(!(h===-1||h>=l.length)){var m=l[h];a==="startX"&&m>=d||a==="endX"&&m<=c||this.setState(Si({},a,m),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,l=n.height,c=n.fill,d=n.stroke;return te.createElement("rect",{stroke:d,fill:c,x:a,y:i,width:o,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,l=n.height,c=n.data,d=n.children,f=n.padding,u=y.Children.only(d);return u?te.cloneElement(u,{x:a,y:i,width:o,height:l,margin:f,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,o,l=this,c=this.props,d=c.y,f=c.travellerWidth,u=c.height,h=c.traveller,m=c.ariaLabel,v=c.data,g=c.startIndex,x=c.endIndex,_=Math.max(n,this.props.x),w=qS(qS({},qr(this.props,!1)),{},{x:_,y:d,width:f,height:u}),b=m||"Min value: ".concat((i=v[g])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=v[x])===null||o===void 0?void 0:o.name);return te.createElement(Wn,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(S){["ArrowLeft","ArrowRight"].includes(S.key)&&(S.preventDefault(),S.stopPropagation(),l.handleTravellerMoveKeyboard(S.key==="ArrowRight"?1:-1,a))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,w))}},{key:"renderSlide",value:function(n,a){var i=this.props,o=i.y,l=i.height,c=i.stroke,d=i.travellerWidth,f=Math.min(n,a)+d,u=Math.max(Math.abs(a-n)-d,0);return te.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:f,y:o,width:u,height:l})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,o=n.y,l=n.height,c=n.travellerWidth,d=n.stroke,f=this.state,u=f.startX,h=f.endX,m=5,v={pointerEvents:"none",fill:d};return te.createElement(Wn,{className:"recharts-brush-texts"},te.createElement(qw,mb({textAnchor:"end",verticalAnchor:"middle",x:Math.min(u,h)-m,y:o+l/2},v),this.getTextOfTick(a)),te.createElement(qw,mb({textAnchor:"start",verticalAnchor:"middle",x:Math.max(u,h)+c+m,y:o+l/2},v),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,o=n.children,l=n.x,c=n.y,d=n.width,f=n.height,u=n.alwaysShowText,h=this.state,m=h.startX,v=h.endX,g=h.isTextActive,x=h.isSlideMoving,_=h.isTravellerMoving,w=h.isTravellerFocused;if(!a||!a.length||!bt(l)||!bt(c)||!bt(d)||!bt(f)||d<=0||f<=0)return null;var b=on("recharts-brush",i),N=te.Children.count(o)===1,S=jLe("userSelect","none");return te.createElement(Wn,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:S},this.renderBackground(),N&&this.renderPanorama(),this.renderSlide(m,v),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(v,"endX"),(g||x||_||w||u)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,o=n.width,l=n.height,c=n.stroke,d=Math.floor(i+l/2)-1;return te.createElement(te.Fragment,null,te.createElement("rect",{x:a,y:i,width:o,height:l,fill:c,stroke:"none"}),te.createElement("line",{x1:a+1,y1:d,x2:a+o-1,y2:d,fill:"none",stroke:"#fff"}),te.createElement("line",{x1:a+1,y1:d+2,x2:a+o-1,y2:d+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return te.isValidElement(n)?i=te.cloneElement(n,a):$r(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,o=n.width,l=n.x,c=n.travellerWidth,d=n.updateId,f=n.startIndex,u=n.endIndex;if(i!==a.prevData||d!==a.prevUpdateId)return qS({prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:o},i&&i.length?ALe({data:i,width:o,x:l,travellerWidth:c,startIndex:f,endIndex:u}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||l!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([l,l+o-c]);var h=a.scale.domain().map(function(m){return a.scale(m)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:o,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,o=0,l=i-1;l-o>1;){var c=Math.floor((o+l)/2);n[c]>a?l=c:o=c}return a>=n[l]?l:o}}])}(y.PureComponent);Si(Km,"displayName","Brush");Si(Km,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var RLe=e5;function OLe(e,t){var r;return RLe(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var MLe=OLe,DLe=gH,ILe=iu,$Le=MLe,LLe=ji,FLe=_j;function zLe(e,t,r){var n=LLe(e)?DLe:$Le;return r&&FLe(e,t,r)&&(t=void 0),n(e,ILe(t))}var BLe=zLe;const ULe=wn(BLe);var $l=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},c$=LH;function qLe(e,t,r){t=="__proto__"&&c$?c$(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var VLe=qLe,WLe=VLe,HLe=IH,GLe=iu;function YLe(e,t){var r={};return t=GLe(t),HLe(e,function(n,a,i){WLe(r,a,t(n,a,i))}),r}var KLe=YLe;const ZLe=wn(KLe);function XLe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var JLe=XLe,QLe=e5;function e6e(e,t){var r=!0;return QLe(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var t6e=e6e,r6e=JLe,n6e=t6e,s6e=iu,a6e=ji,i6e=_j;function o6e(e,t,r){var n=a6e(e)?r6e:n6e;return r&&i6e(e,t,r)&&(t=void 0),n(e,s6e(t))}var l6e=o6e;const hY=wn(l6e);var c6e=["x","y"];function Py(e){"@babel/helpers - typeof";return Py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Py(e)}function aC(){return aC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aC.apply(this,arguments)}function d$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Og(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d$(Object(r),!0).forEach(function(n){d6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function d6e(e,t,r){return t=u6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u6e(e){var t=f6e(e,"string");return Py(t)=="symbol"?t:t+""}function f6e(e,t){if(Py(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Py(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function h6e(e,t){if(e==null)return{};var r=m6e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function m6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function p6e(e,t){var r=e.x,n=e.y,a=h6e(e,c6e),i="".concat(r),o=parseInt(i,10),l="".concat(n),c=parseInt(l,10),d="".concat(t.height||a.height),f=parseInt(d,10),u="".concat(t.width||a.width),h=parseInt(u,10);return Og(Og(Og(Og(Og({},t),a),o?{x:o}:{}),c?{y:c}:{}),{},{height:f,width:h,name:t.name,radius:t.radius})}function u$(e){return te.createElement(J$e,aC({shapeType:"rectangle",propTransformer:p6e,activeClassName:"recharts-active-bar"},e))}var g6e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=bt(n)||F1e(n);return i?t(n,a):(i||Nf(),r)}},v6e=["value","background"],mY;function Zm(e){"@babel/helpers - typeof";return Zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zm(e)}function y6e(e,t){if(e==null)return{};var r=x6e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function x6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function gb(){return gb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gb.apply(this,arguments)}function f$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ts(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f$(Object(r),!0).forEach(function(n){Ed(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gY(n.key),n)}}function w6e(e,t,r){return t&&h$(e.prototype,t),r&&h$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function b6e(e,t,r){return t=vb(t),j6e(e,pY()?Reflect.construct(t,r||[],vb(e).constructor):t.apply(e,r))}function j6e(e,t){if(t&&(Zm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return N6e(e)}function N6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(pY=function(){return!!e})()}function vb(e){return vb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vb(e)}function S6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iC(e,t)}function iC(e,t){return iC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},iC(e,t)}function Ed(e,t,r){return t=gY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gY(e){var t=k6e(e,"string");return Zm(t)=="symbol"?t:t+""}function k6e(e,t){if(Zm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mi=function(e){function t(){var r;_6e(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=b6e(this,t,[].concat(a)),Ed(r,"state",{isAnimationFinished:!1}),Ed(r,"id",Dp("recharts-bar-")),Ed(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),Ed(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return S6e(t,e),w6e(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,o=i.shape,l=i.dataKey,c=i.activeIndex,d=i.activeBar,f=qr(this.props,!1);return n&&n.map(function(u,h){var m=h===c,v=m?d:o,g=Ts(Ts(Ts({},f),u),{},{isActive:m,option:v,index:h,dataKey:l,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return te.createElement(Wn,gb({className:"recharts-bar-rectangle"},Pw(a.props,u,h),{key:"rectangle-".concat(u==null?void 0:u.x,"-").concat(u==null?void 0:u.y,"-").concat(u==null?void 0:u.value,"-").concat(h)}),te.createElement(u$,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,o=a.layout,l=a.isAnimationActive,c=a.animationBegin,d=a.animationDuration,f=a.animationEasing,u=a.animationId,h=this.state.prevData;return te.createElement(ql,{begin:c,duration:d,isActive:l,easing:f,from:{t:0},to:{t:1},key:"bar-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var v=m.t,g=i.map(function(x,_){var w=h&&h[_];if(w){var b=ha(w.x,x.x),N=ha(w.y,x.y),S=ha(w.width,x.width),k=ha(w.height,x.height);return Ts(Ts({},x),{},{x:b(v),y:N(v),width:S(v),height:k(v)})}if(o==="horizontal"){var C=ha(0,x.height),A=C(v);return Ts(Ts({},x),{},{y:x.y+x.height-A,height:A})}var R=ha(0,x.width),I=R(v);return Ts(Ts({},x),{},{width:I})});return te.createElement(Wn,null,n.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,o=this.state.prevData;return i&&a&&a.length&&(!o||!Wm(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,o=a.dataKey,l=a.activeIndex,c=qr(this.props.background,!1);return i.map(function(d,f){d.value;var u=d.background,h=y6e(d,v6e);if(!u)return null;var m=Ts(Ts(Ts(Ts(Ts({},h),{},{fill:"#eee"},u),c),Pw(n.props,d,f)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:f,className:"recharts-bar-background-rectangle"});return te.createElement(u$,gb({key:"background-bar-".concat(f),option:n.props.background,isActive:f===l},m))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,l=i.xAxis,c=i.yAxis,d=i.layout,f=i.children,u=co(f,P0);if(!u)return null;var h=d==="vertical"?o[0].height/2:o[0].width/2,m=function(x,_){var w=Array.isArray(x.value)?x.value[1]:x.value;return{x:x.x,y:x.y,value:w,errorVal:Ka(x,_)}},v={clipPath:n?"url(#clipPath-".concat(a,")"):null};return te.createElement(Wn,v,u.map(function(g){return te.cloneElement(g,{key:"error-bar-".concat(a,"-").concat(g.props.dataKey),data:o,xAxis:l,yAxis:c,layout:d,offset:h,dataPointFormatter:m})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,o=n.className,l=n.xAxis,c=n.yAxis,d=n.left,f=n.top,u=n.width,h=n.height,m=n.isAnimationActive,v=n.background,g=n.id;if(a||!i||!i.length)return null;var x=this.state.isAnimationFinished,_=on("recharts-bar",o),w=l&&l.allowDataOverflow,b=c&&c.allowDataOverflow,N=w||b,S=Zr(g)?this.id:g;return te.createElement(Wn,{className:_},w||b?te.createElement("defs",null,te.createElement("clipPath",{id:"clipPath-".concat(S)},te.createElement("rect",{x:w?d:d-u/2,y:b?f:f-h/2,width:w?u:u*2,height:b?h:h*2}))):null,te.createElement(Wn,{className:"recharts-bar-rectangles",clipPath:N?"url(#clipPath-".concat(S,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(N,S),(!m||x)&&Cc.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(y.PureComponent);mY=Mi;Ed(Mi,"displayName","Bar");Ed(Mi,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Dl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Ed(Mi,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,o=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,d=e.stackedData,f=e.dataStartIndex,u=e.displayedData,h=e.offset,m=o3e(n,r);if(!m)return null;var v=t.layout,g=r.type.defaultProps,x=g!==void 0?Ts(Ts({},g),r.props):r.props,_=x.dataKey,w=x.children,b=x.minPointSize,N=v==="horizontal"?o:i,S=d?N.scale.domain():null,k=p3e({numericAxis:N}),C=co(w,WH),A=u.map(function(R,I){var O,z,M,B,F,U;d?O=l3e(d[f+I],S):(O=Ka(R,_),Array.isArray(O)||(O=[k,O]));var H=g6e(b,mY.defaultProps.minPointSize)(O[1],I);if(v==="horizontal"){var q,K=[o.scale(O[0]),o.scale(O[1])],Z=K[0],ne=K[1];z=fI({axis:i,ticks:l,bandSize:a,offset:m.offset,entry:R,index:I}),M=(q=ne!=null?ne:Z)!==null&&q!==void 0?q:void 0,B=m.size;var Y=Z-ne;if(F=Number.isNaN(Y)?0:Y,U={x:z,y:o.y,width:B,height:o.height},Math.abs(H)>0&&Math.abs(F)<Math.abs(H)){var X=qo(F||H)*(Math.abs(H)-Math.abs(F));M-=X,F+=X}}else{var se=[i.scale(O[0]),i.scale(O[1])],de=se[0],_e=se[1];if(z=de,M=fI({axis:o,ticks:c,bandSize:a,offset:m.offset,entry:R,index:I}),B=_e-de,F=m.size,U={x:i.x,y:M,width:i.width,height:F},Math.abs(H)>0&&Math.abs(B)<Math.abs(H)){var xe=qo(B||H)*(Math.abs(H)-Math.abs(B));B+=xe}}return Ts(Ts(Ts({},R),{},{x:z,y:M,width:B,height:F,value:d?O:O[1],payload:R,background:U},C&&C[I]&&C[I].props),{},{tooltipPayload:[XG(r,R)],tooltipPosition:{x:z+B/2,y:M+F/2}})});return Ts({data:A,layout:v},h)});function Ty(e){"@babel/helpers - typeof";return Ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ty(e)}function E6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vY(n.key),n)}}function C6e(e,t,r){return t&&m$(e.prototype,t),r&&m$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ro(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p$(Object(r),!0).forEach(function(n){Oj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Oj(e,t,r){return t=vY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vY(e){var t=P6e(e,"string");return Ty(t)=="symbol"?t:t+""}function P6e(e,t){if(Ty(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ty(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P5=function(t,r,n,a,i){var o=t.width,l=t.height,c=t.layout,d=t.children,f=Object.keys(r),u={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},h=!!Pi(d,Mi);return f.reduce(function(m,v){var g=r[v],x=g.orientation,_=g.domain,w=g.padding,b=w===void 0?{}:w,N=g.mirror,S=g.reversed,k="".concat(x).concat(N?"Mirror":""),C,A,R,I,O;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var z=_[1]-_[0],M=1/0,B=g.categoricalDomain.sort(U1e);if(B.forEach(function(se,de){de>0&&(M=Math.min((se||0)-(B[de-1]||0),M))}),Number.isFinite(M)){var F=M/z,U=g.layout==="vertical"?n.height:n.width;if(g.padding==="gap"&&(C=F*U/2),g.padding==="no-gap"){var H=bf(t.barCategoryGap,F*U),q=F*U/2;C=q-H-(q-H)/U*H}}}a==="xAxis"?A=[n.left+(b.left||0)+(C||0),n.left+n.width-(b.right||0)-(C||0)]:a==="yAxis"?A=c==="horizontal"?[n.top+n.height-(b.bottom||0),n.top+(b.top||0)]:[n.top+(b.top||0)+(C||0),n.top+n.height-(b.bottom||0)-(C||0)]:A=g.range,S&&(A=[A[1],A[0]]);var K=a3e(g,i,h),Z=K.scale,ne=K.realScaleType;Z.domain(_).range(A),i3e(Z);var Y=m3e(Z,Ro(Ro({},g),{},{realScaleType:ne}));a==="xAxis"?(O=x==="top"&&!N||x==="bottom"&&N,R=n.left,I=u[k]-O*g.height):a==="yAxis"&&(O=x==="left"&&!N||x==="right"&&N,R=u[k]-O*g.width,I=n.top);var X=Ro(Ro(Ro({},g),Y),{},{realScaleType:ne,x:R,y:I,scale:Z,width:a==="xAxis"?n.width:g.width,height:a==="yAxis"?n.height:g.height});return X.bandSize=sb(X,Y),!g.hide&&a==="xAxis"?u[k]+=(O?-1:1)*X.height:g.hide||(u[k]+=(O?-1:1)*X.width),Ro(Ro({},m),{},Oj({},v,X))},{})},yY=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return{x:Math.min(n,i),y:Math.min(a,o),width:Math.abs(i-n),height:Math.abs(o-a)}},T6e=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return yY({x:r,y:n},{x:a,y:i})},xY=function(){function e(t){E6e(this,e),this.scale=t}return C6e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(a){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();Oj(xY,"EPS",1e-4);var T5=function(t){var r=Object.keys(t).reduce(function(n,a){return Ro(Ro({},n),{},Oj({},a,xY.create(t[a])))},{});return Ro(Ro({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,l=i.position;return ZLe(a,function(c,d){return r[d].apply(c,{bandAware:o,position:l})})},isInRange:function(a){return hY(a,function(i,o){return r[o].isInRange(i)})}})};function A6e(e){return(e%180+180)%180}var R6e=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=A6e(a),o=i*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},O6e=iu,M6e=N0,D6e=yj;function I6e(e){return function(t,r,n){var a=Object(t);if(!M6e(t)){var i=O6e(r);t=D6e(t),r=function(l){return i(a[l],l,a)}}var o=e(t,r,n);return o>-1?a[i?t[o]:o]:void 0}}var $6e=I6e,L6e=cY;function F6e(e){var t=L6e(e),r=t%1;return t===t?r?t-r:t:0}var z6e=F6e,B6e=TH,U6e=iu,q6e=z6e,V6e=Math.max;function W6e(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:q6e(r);return a<0&&(a=V6e(n+a,0)),B6e(e,U6e(t),a)}var H6e=W6e,G6e=$6e,Y6e=H6e,K6e=G6e(Y6e),Z6e=K6e;const X6e=wn(Z6e);var J6e=qbe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),A5=y.createContext(void 0),R5=y.createContext(void 0),_Y=y.createContext(void 0),wY=y.createContext({}),bY=y.createContext(void 0),jY=y.createContext(0),NY=y.createContext(0),g$=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,o=t.clipPathId,l=t.children,c=t.width,d=t.height,f=J6e(i);return te.createElement(A5.Provider,{value:n},te.createElement(R5.Provider,{value:a},te.createElement(wY.Provider,{value:i},te.createElement(_Y.Provider,{value:f},te.createElement(bY.Provider,{value:o},te.createElement(jY.Provider,{value:d},te.createElement(NY.Provider,{value:c},l)))))))},Q6e=function(){return y.useContext(bY)},SY=function(t){var r=y.useContext(A5);r==null&&Nf();var n=r[t];return n==null&&Nf(),n},eFe=function(){var t=y.useContext(A5);return gd(t)},tFe=function(){var t=y.useContext(R5),r=X6e(t,function(n){return hY(n.domain,Number.isFinite)});return r||gd(t)},kY=function(t){var r=y.useContext(R5);r==null&&Nf();var n=r[t];return n==null&&Nf(),n},rFe=function(){var t=y.useContext(_Y);return t},nFe=function(){return y.useContext(wY)},O5=function(){return y.useContext(NY)},M5=function(){return y.useContext(jY)};function Xm(e){"@babel/helpers - typeof";return Xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xm(e)}function sFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aFe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CY(n.key),n)}}function iFe(e,t,r){return t&&aFe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oFe(e,t,r){return t=yb(t),lFe(e,EY()?Reflect.construct(t,r||[],yb(e).constructor):t.apply(e,r))}function lFe(e,t){if(t&&(Xm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cFe(e)}function cFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(EY=function(){return!!e})()}function yb(e){return yb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yb(e)}function dFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oC(e,t)}function oC(e,t){return oC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},oC(e,t)}function v$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function y$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v$(Object(r),!0).forEach(function(n){D5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D5(e,t,r){return t=CY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CY(e){var t=uFe(e,"string");return Xm(t)=="symbol"?t:t+""}function uFe(e,t){if(Xm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fFe(e,t){return gFe(e)||pFe(e,t)||mFe(e,t)||hFe()}function hFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mFe(e,t){if(e){if(typeof e=="string")return x$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x$(e,t)}}function x$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pFe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(f){d=!0,a=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function gFe(e){if(Array.isArray(e))return e}function lC(){return lC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lC.apply(this,arguments)}var vFe=function(t,r){var n;return te.isValidElement(t)?n=te.cloneElement(t,r):$r(t)?n=t(r):n=te.createElement("line",lC({},r,{className:"recharts-reference-line-line"})),n},yFe=function(t,r,n,a,i,o,l,c,d){var f=i.x,u=i.y,h=i.width,m=i.height;if(n){var v=d.y,g=t.y.apply(v,{position:o});if($l(d,"discard")&&!t.y.isInRange(g))return null;var x=[{x:f+h,y:g},{x:f,y:g}];return c==="left"?x.reverse():x}if(r){var _=d.x,w=t.x.apply(_,{position:o});if($l(d,"discard")&&!t.x.isInRange(w))return null;var b=[{x:w,y:u+m},{x:w,y:u}];return l==="top"?b.reverse():b}if(a){var N=d.segment,S=N.map(function(k){return t.apply(k,{position:o})});return $l(d,"discard")&&ULe(S,function(k){return!t.isInRange(k)})?null:S}return null};function xFe(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,o=e.shape,l=e.className,c=e.alwaysShow,d=Q6e(),f=SY(a),u=kY(i),h=rFe();if(!d||!h)return null;kc(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=T5({x:f.scale,y:u.scale}),v=Hs(t),g=Hs(r),x=n&&n.length===2,_=yFe(m,v,g,x,h,e.position,f.orientation,u.orientation,e);if(!_)return null;var w=fFe(_,2),b=w[0],N=b.x,S=b.y,k=w[1],C=k.x,A=k.y,R=$l(e,"hidden")?"url(#".concat(d,")"):void 0,I=y$(y$({clipPath:R},qr(e,!0)),{},{x1:N,y1:S,x2:C,y2:A});return te.createElement(Wn,{className:on("recharts-reference-line",l)},vFe(o,I),Pa.renderCallByParent(e,T6e({x1:N,y1:S,x2:C,y2:A})))}var I5=function(e){function t(){return sFe(this,t),oFe(this,t,arguments)}return dFe(t,e),iFe(t,[{key:"render",value:function(){return te.createElement(xFe,this.props)}}])}(te.Component);D5(I5,"displayName","ReferenceLine");D5(I5,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function cC(){return cC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cC.apply(this,arguments)}function Jm(e){"@babel/helpers - typeof";return Jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jm(e)}function _$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function w$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_$(Object(r),!0).forEach(function(n){Mj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wFe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TY(n.key),n)}}function bFe(e,t,r){return t&&wFe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jFe(e,t,r){return t=xb(t),NFe(e,PY()?Reflect.construct(t,r||[],xb(e).constructor):t.apply(e,r))}function NFe(e,t){if(t&&(Jm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SFe(e)}function SFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(PY=function(){return!!e})()}function xb(e){return xb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xb(e)}function kFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dC(e,t)}function dC(e,t){return dC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},dC(e,t)}function Mj(e,t,r){return t=TY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TY(e){var t=EFe(e,"string");return Jm(t)=="symbol"?t:t+""}function EFe(e,t){if(Jm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CFe=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,o=T5({x:a.scale,y:i.scale}),l=o.apply({x:r,y:n},{bandAware:!0});return $l(t,"discard")&&!o.isInRange(l)?null:l},Dj=function(e){function t(){return _Fe(this,t),jFe(this,t,arguments)}return kFe(t,e),bFe(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,o=n.r,l=n.alwaysShow,c=n.clipPathId,d=Hs(a),f=Hs(i);if(kc(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!d||!f)return null;var u=CFe(this.props);if(!u)return null;var h=u.x,m=u.y,v=this.props,g=v.shape,x=v.className,_=$l(this.props,"hidden")?"url(#".concat(c,")"):void 0,w=w$(w$({clipPath:_},qr(this.props,!0)),{},{cx:h,cy:m});return te.createElement(Wn,{className:on("recharts-reference-dot",x)},t.renderDot(g,w),Pa.renderCallByParent(this.props,{x:h-o,y:m-o,width:2*o,height:2*o}))}}])}(te.Component);Mj(Dj,"displayName","ReferenceDot");Mj(Dj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Mj(Dj,"renderDot",function(e,t){var r;return te.isValidElement(e)?r=te.cloneElement(e,t):$r(e)?r=e(t):r=te.createElement(Tj,cC({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function uC(){return uC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uC.apply(this,arguments)}function Qm(e){"@babel/helpers - typeof";return Qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qm(e)}function b$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function j$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b$(Object(r),!0).forEach(function(n){Ij(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TFe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RY(n.key),n)}}function AFe(e,t,r){return t&&TFe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function RFe(e,t,r){return t=_b(t),OFe(e,AY()?Reflect.construct(t,r||[],_b(e).constructor):t.apply(e,r))}function OFe(e,t){if(t&&(Qm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MFe(e)}function MFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(AY=function(){return!!e})()}function _b(e){return _b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_b(e)}function DFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fC(e,t)}function fC(e,t){return fC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},fC(e,t)}function Ij(e,t,r){return t=RY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RY(e){var t=IFe(e,"string");return Qm(t)=="symbol"?t:t+""}function IFe(e,t){if(Qm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $Fe=function(t,r,n,a,i){var o=i.x1,l=i.x2,c=i.y1,d=i.y2,f=i.xAxis,u=i.yAxis;if(!f||!u)return null;var h=T5({x:f.scale,y:u.scale}),m={x:t?h.x.apply(o,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(c,{position:"start"}):h.y.rangeMin},v={x:r?h.x.apply(l,{position:"end"}):h.x.rangeMax,y:a?h.y.apply(d,{position:"end"}):h.y.rangeMax};return $l(i,"discard")&&(!h.isInRange(m)||!h.isInRange(v))?null:yY(m,v)},$j=function(e){function t(){return PFe(this,t),RFe(this,t,arguments)}return DFe(t,e),AFe(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,o=n.y1,l=n.y2,c=n.className,d=n.alwaysShow,f=n.clipPathId;kc(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var u=Hs(a),h=Hs(i),m=Hs(o),v=Hs(l),g=this.props.shape;if(!u&&!h&&!m&&!v&&!g)return null;var x=$Fe(u,h,m,v,this.props);if(!x&&!g)return null;var _=$l(this.props,"hidden")?"url(#".concat(f,")"):void 0;return te.createElement(Wn,{className:on("recharts-reference-area",c)},t.renderRect(g,j$(j$({clipPath:_},qr(this.props,!0)),x)),Pa.renderCallByParent(this.props,x))}}])}(te.Component);Ij($j,"displayName","ReferenceArea");Ij($j,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Ij($j,"renderRect",function(e,t){var r;return te.isValidElement(e)?r=te.cloneElement(e,t):$r(e)?r=e(t):r=te.createElement(C5,uC({},t,{className:"recharts-reference-area-rect"})),r});function OY(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function LFe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return R6e(n,r)}function FFe(e,t,r){var n=r==="width",a=e.x,i=e.y,o=e.width,l=e.height;return t===1?{start:n?a:i,end:n?a+o:i+l}:{start:n?a+o:i+l,end:n?a:i}}function wb(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function zFe(e,t){return OY(e,t+1)}function BFe(e,t,r,n,a){for(var i=(n||[]).slice(),o=t.start,l=t.end,c=0,d=1,f=o,u=function(){var v=n==null?void 0:n[c];if(v===void 0)return{v:OY(n,d)};var g=c,x,_=function(){return x===void 0&&(x=r(v,g)),x},w=v.coordinate,b=c===0||wb(e,w,_,f,l);b||(c=0,f=o,d+=1),b&&(f=w+e*(_()/2+a),c+=d)},h;d<=i.length;)if(h=u(),h)return h.v;return[]}function Ay(e){"@babel/helpers - typeof";return Ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ay(e)}function N$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ka(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N$(Object(r),!0).forEach(function(n){UFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UFe(e,t,r){return t=qFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qFe(e){var t=VFe(e,"string");return Ay(t)=="symbol"?t:t+""}function VFe(e,t){if(Ay(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ay(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WFe(e,t,r,n,a){for(var i=(n||[]).slice(),o=i.length,l=t.start,c=t.end,d=function(h){var m=i[h],v,g=function(){return v===void 0&&(v=r(m,h)),v};if(h===o-1){var x=e*(m.coordinate+e*g()/2-c);i[h]=m=ka(ka({},m),{},{tickCoord:x>0?m.coordinate-x*e:m.coordinate})}else i[h]=m=ka(ka({},m),{},{tickCoord:m.coordinate});var _=wb(e,m.tickCoord,g,l,c);_&&(c=m.tickCoord-e*(g()/2+a),i[h]=ka(ka({},m),{},{isShow:!0}))},f=o-1;f>=0;f--)d(f);return i}function HFe(e,t,r,n,a,i){var o=(n||[]).slice(),l=o.length,c=t.start,d=t.end;if(i){var f=n[l-1],u=r(f,l-1),h=e*(f.coordinate+e*u/2-d);o[l-1]=f=ka(ka({},f),{},{tickCoord:h>0?f.coordinate-h*e:f.coordinate});var m=wb(e,f.tickCoord,function(){return u},c,d);m&&(d=f.tickCoord-e*(u/2+a),o[l-1]=ka(ka({},f),{},{isShow:!0}))}for(var v=i?l-1:l,g=function(w){var b=o[w],N,S=function(){return N===void 0&&(N=r(b,w)),N};if(w===0){var k=e*(b.coordinate-e*S()/2-c);o[w]=b=ka(ka({},b),{},{tickCoord:k<0?b.coordinate-k*e:b.coordinate})}else o[w]=b=ka(ka({},b),{},{tickCoord:b.coordinate});var C=wb(e,b.tickCoord,S,c,d);C&&(c=b.tickCoord+e*(S()/2+a),o[w]=ka(ka({},b),{},{isShow:!0}))},x=0;x<v;x++)g(x);return o}function $5(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,o=e.minTickGap,l=e.orientation,c=e.interval,d=e.tickFormatter,f=e.unit,u=e.angle;if(!a||!a.length||!n)return[];if(bt(c)||Dl.isSsr)return zFe(a,typeof c=="number"&&bt(c)?c:0);var h=[],m=l==="top"||l==="bottom"?"width":"height",v=f&&m==="width"?cv(f,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=function(b,N){var S=$r(d)?d(b.value,N):b.value;return m==="width"?LFe(cv(S,{fontSize:t,letterSpacing:r}),v,u):cv(S,{fontSize:t,letterSpacing:r})[m]},x=a.length>=2?qo(a[1].coordinate-a[0].coordinate):1,_=FFe(i,x,m);return c==="equidistantPreserveStart"?BFe(x,_,g,a,o):(c==="preserveStart"||c==="preserveStartEnd"?h=HFe(x,_,g,a,o,c==="preserveStartEnd"):h=WFe(x,_,g,a,o),h.filter(function(w){return w.isShow}))}var GFe=["viewBox"],YFe=["viewBox"],KFe=["ticks"];function ep(e){"@babel/helpers - typeof";return ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ep(e)}function $h(){return $h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$h.apply(this,arguments)}function S$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ls(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S$(Object(r),!0).forEach(function(n){L5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VS(e,t){if(e==null)return{};var r=ZFe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ZFe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function XFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DY(n.key),n)}}function JFe(e,t,r){return t&&k$(e.prototype,t),r&&k$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QFe(e,t,r){return t=bb(t),eze(e,MY()?Reflect.construct(t,r||[],bb(e).constructor):t.apply(e,r))}function eze(e,t){if(t&&(ep(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tze(e)}function tze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(MY=function(){return!!e})()}function bb(e){return bb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bb(e)}function rze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hC(e,t)}function hC(e,t){return hC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},hC(e,t)}function L5(e,t,r){return t=DY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DY(e){var t=nze(e,"string");return ep(t)=="symbol"?t:t+""}function nze(e,t){if(ep(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ep(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Up=function(e){function t(r){var n;return XFe(this,t),n=QFe(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return rze(t,e),JFe(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,o=VS(n,GFe),l=this.props,c=l.viewBox,d=VS(l,YFe);return!nm(i,c)||!nm(o,d)||!nm(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,o=a.y,l=a.width,c=a.height,d=a.orientation,f=a.tickSize,u=a.mirror,h=a.tickMargin,m,v,g,x,_,w,b=u?-1:1,N=n.tickSize||f,S=bt(n.tickCoord)?n.tickCoord:n.coordinate;switch(d){case"top":m=v=n.coordinate,x=o+ +!u*c,g=x-b*N,w=g-b*h,_=S;break;case"left":g=x=n.coordinate,v=i+ +!u*l,m=v-b*N,_=m-b*h,w=S;break;case"right":g=x=n.coordinate,v=i+ +u*l,m=v+b*N,_=m+b*h,w=S;break;default:m=v=n.coordinate,x=o+ +u*c,g=x+b*N,w=g+b*h,_=S;break}return{line:{x1:m,y1:g,x2:v,y2:x},tick:{x:_,y:w}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o;switch(a){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,l=n.height,c=n.orientation,d=n.mirror,f=n.axisLine,u=Ls(Ls(Ls({},qr(this.props,!1)),qr(f,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var h=+(c==="top"&&!d||c==="bottom"&&d);u=Ls(Ls({},u),{},{x1:a,y1:i+h*l,x2:a+o,y2:i+h*l})}else{var m=+(c==="left"&&!d||c==="right"&&d);u=Ls(Ls({},u),{},{x1:a+m*o,y1:i,x2:a+m*o,y2:i+l})}return te.createElement("line",$h({},u,{className:on("recharts-cartesian-axis-line",lo(f,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var o=this,l=this.props,c=l.tickLine,d=l.stroke,f=l.tick,u=l.tickFormatter,h=l.unit,m=$5(Ls(Ls({},this.props),{},{ticks:n}),a,i),v=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),x=qr(this.props,!1),_=qr(f,!1),w=Ls(Ls({},x),{},{fill:"none"},qr(c,!1)),b=m.map(function(N,S){var k=o.getTickLineCoord(N),C=k.line,A=k.tick,R=Ls(Ls(Ls(Ls({textAnchor:v,verticalAnchor:g},x),{},{stroke:"none",fill:d},_),A),{},{index:S,payload:N,visibleTicksCount:m.length,tickFormatter:u});return te.createElement(Wn,$h({className:"recharts-cartesian-axis-tick",key:"tick-".concat(N.value,"-").concat(N.coordinate,"-").concat(N.tickCoord)},Pw(o.props,N,S)),c&&te.createElement("line",$h({},w,C,{className:on("recharts-cartesian-axis-tick-line",lo(c,"className"))})),f&&t.renderTickItem(f,R,"".concat($r(u)?u(N.value,S):N.value).concat(h||"")))});return te.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,o=a.width,l=a.height,c=a.ticksGenerator,d=a.className,f=a.hide;if(f)return null;var u=this.props,h=u.ticks,m=VS(u,KFe),v=h;return $r(c)&&(v=h&&h.length>0?c(this.props):c(m)),o<=0||l<=0||!v||!v.length?null:te.createElement(Wn,{className:on("recharts-cartesian-axis",d),ref:function(x){n.layerReference=x}},i&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),Pa.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var o,l=on(a.className,"recharts-cartesian-axis-tick-value");return te.isValidElement(n)?o=te.cloneElement(n,Ls(Ls({},a),{},{className:l})):$r(n)?o=n(Ls(Ls({},a),{},{className:l})):o=te.createElement(qw,$h({},a,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(y.Component);L5(Up,"displayName","CartesianAxis");L5(Up,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var sze=["x1","y1","x2","y2","key"],aze=["offset"];function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function E$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ta(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E$(Object(r),!0).forEach(function(n){ize(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ize(e,t,r){return t=oze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oze(e){var t=lze(e,"string");return Sf(t)=="symbol"?t:t+""}function lze(e,t){if(Sf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zu(){return zu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zu.apply(this,arguments)}function C$(e,t){if(e==null)return{};var r=cze(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var dze=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,o=t.width,l=t.height,c=t.ry;return te.createElement("rect",{x:a,y:i,ry:c,width:o,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function IY(e,t){var r;if(te.isValidElement(e))r=te.cloneElement(e,t);else if($r(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,o=t.y2,l=t.key,c=C$(t,sze),d=qr(c,!1);d.offset;var f=C$(d,aze);r=te.createElement("line",zu({},f,{x1:n,y1:a,x2:i,y2:o,fill:"none",key:l}))}return r}function uze(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(l,c){var d=Ta(Ta({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return IY(a,d)});return te.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function fze(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(l,c){var d=Ta(Ta({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return IY(a,d)});return te.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function hze(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,o=e.height,l=e.horizontalPoints,c=e.horizontal,d=c===void 0?!0:c;if(!d||!t||!t.length)return null;var f=l.map(function(h){return Math.round(h+a-a)}).sort(function(h,m){return h-m});a!==f[0]&&f.unshift(0);var u=f.map(function(h,m){var v=!f[m+1],g=v?a+o-h:f[m+1]-h;if(g<=0)return null;var x=m%t.length;return te.createElement("rect",{key:"react-".concat(m),y:h,x:n,height:g,width:i,stroke:"none",fill:t[x],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return te.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function mze(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,o=e.y,l=e.width,c=e.height,d=e.verticalPoints;if(!r||!n||!n.length)return null;var f=d.map(function(h){return Math.round(h+i-i)}).sort(function(h,m){return h-m});i!==f[0]&&f.unshift(0);var u=f.map(function(h,m){var v=!f[m+1],g=v?i+l-h:f[m+1]-h;if(g<=0)return null;var x=m%n.length;return te.createElement("rect",{key:"react-".concat(m),x:h,y:o,width:g,height:c,stroke:"none",fill:n[x],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return te.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var pze=function(t,r){var n=t.xAxis,a=t.width,i=t.height,o=t.offset;return KG($5(Ta(Ta(Ta({},Up.defaultProps),n),{},{ticks:bc(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.left,o.left+o.width,r)},gze=function(t,r){var n=t.yAxis,a=t.width,i=t.height,o=t.offset;return KG($5(Ta(Ta(Ta({},Up.defaultProps),n),{},{ticks:bc(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.top,o.top+o.height,r)},dh={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function fl(e){var t,r,n,a,i,o,l=O5(),c=M5(),d=nFe(),f=Ta(Ta({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:dh.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:dh.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:dh.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:dh.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:dh.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:dh.verticalFill,x:bt(e.x)?e.x:d.left,y:bt(e.y)?e.y:d.top,width:bt(e.width)?e.width:d.width,height:bt(e.height)?e.height:d.height}),u=f.x,h=f.y,m=f.width,v=f.height,g=f.syncWithTicks,x=f.horizontalValues,_=f.verticalValues,w=eFe(),b=tFe();if(!bt(m)||m<=0||!bt(v)||v<=0||!bt(u)||u!==+u||!bt(h)||h!==+h)return null;var N=f.verticalCoordinatesGenerator||pze,S=f.horizontalCoordinatesGenerator||gze,k=f.horizontalPoints,C=f.verticalPoints;if((!k||!k.length)&&$r(S)){var A=x&&x.length,R=S({yAxis:b?Ta(Ta({},b),{},{ticks:A?x:b.ticks}):void 0,width:l,height:c,offset:d},A?!0:g);kc(Array.isArray(R),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Sf(R),"]")),Array.isArray(R)&&(k=R)}if((!C||!C.length)&&$r(N)){var I=_&&_.length,O=N({xAxis:w?Ta(Ta({},w),{},{ticks:I?_:w.ticks}):void 0,width:l,height:c,offset:d},I?!0:g);kc(Array.isArray(O),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Sf(O),"]")),Array.isArray(O)&&(C=O)}return te.createElement("g",{className:"recharts-cartesian-grid"},te.createElement(dze,{fill:f.fill,fillOpacity:f.fillOpacity,x:f.x,y:f.y,width:f.width,height:f.height,ry:f.ry}),te.createElement(uze,zu({},f,{offset:d,horizontalPoints:k,xAxis:w,yAxis:b})),te.createElement(fze,zu({},f,{offset:d,verticalPoints:C,xAxis:w,yAxis:b})),te.createElement(hze,zu({},f,{horizontalPoints:k})),te.createElement(mze,zu({},f,{verticalPoints:C})))}fl.displayName="CartesianGrid";var vze=["type","layout","connectNulls","ref"],yze=["key"];function tp(e){"@babel/helpers - typeof";return tp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tp(e)}function P$(e,t){if(e==null)return{};var r=xze(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function hv(){return hv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hv.apply(this,arguments)}function T$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T$(Object(r),!0).forEach(function(n){Oo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uh(e){return jze(e)||bze(e)||wze(e)||_ze()}function _ze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wze(e,t){if(e){if(typeof e=="string")return mC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mC(e,t)}}function bze(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jze(e){if(Array.isArray(e))return mC(e)}function mC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LY(n.key),n)}}function Sze(e,t,r){return t&&A$(e.prototype,t),r&&A$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kze(e,t,r){return t=jb(t),Eze(e,$Y()?Reflect.construct(t,r||[],jb(e).constructor):t.apply(e,r))}function Eze(e,t){if(t&&(tp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cze(e)}function Cze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return($Y=function(){return!!e})()}function jb(e){return jb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jb(e)}function Pze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pC(e,t)}function pC(e,t){return pC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},pC(e,t)}function Oo(e,t,r){return t=LY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LY(e){var t=Tze(e,"string");return tp(t)=="symbol"?t:t+""}function Tze(e,t){if(tp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rp=function(e){function t(){var r;Nze(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=kze(this,t,[].concat(a)),Oo(r,"state",{isAnimationFinished:!0,totalLength:0}),Oo(r,"generateSimpleStrokeDasharray",function(o,l){return"".concat(l,"px ").concat(o-l,"px")}),Oo(r,"getStrokeDasharray",function(o,l,c){var d=c.reduce(function(_,w){return _+w});if(!d)return r.generateSimpleStrokeDasharray(l,o);for(var f=Math.floor(o/d),u=o%d,h=l-o,m=[],v=0,g=0;v<c.length;g+=c[v],++v)if(g+c[v]>u){m=[].concat(uh(c.slice(0,v)),[u-g]);break}var x=m.length%2===0?[0,h]:[h];return[].concat(uh(t.repeat(c,f)),uh(m),x).map(function(_){return"".concat(_,"px")}).join(", ")}),Oo(r,"id",Dp("recharts-line-")),Oo(r,"pathRef",function(o){r.mainCurve=o}),Oo(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Oo(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return Pze(t,e),Sze(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch(a){return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,l=i.xAxis,c=i.yAxis,d=i.layout,f=i.children,u=co(f,P0);if(!u)return null;var h=function(g,x){return{x:g.x,y:g.y,value:g.value,errorVal:Ka(g.payload,x)}},m={clipPath:n?"url(#clipPath-".concat(a,")"):null};return te.createElement(Wn,m,u.map(function(v){return te.cloneElement(v,{key:"bar-".concat(v.props.dataKey),data:o,xAxis:l,yAxis:c,layout:d,dataPointFormatter:h})}))}},{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,d=l.points,f=l.dataKey,u=qr(this.props,!1),h=qr(c,!0),m=d.map(function(g,x){var _=Ni(Ni(Ni({key:"dot-".concat(x),r:3},u),h),{},{index:x,cx:g.x,cy:g.y,value:g.value,dataKey:f,payload:g.payload,points:d});return t.renderDotItem(c,_)}),v={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return te.createElement(Wn,hv({className:"recharts-line-dots",key:"dots"},v),m)}},{key:"renderCurveStatically",value:function(n,a,i,o){var l=this.props,c=l.type,d=l.layout,f=l.connectNulls;l.ref;var u=P$(l,vze),h=Ni(Ni(Ni({},qr(u,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},o),{},{type:c,layout:d,connectNulls:f});return te.createElement(im,hv({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,o=this.props,l=o.points,c=o.strokeDasharray,d=o.isAnimationActive,f=o.animationBegin,u=o.animationDuration,h=o.animationEasing,m=o.animationId,v=o.animateNewValues,g=o.width,x=o.height,_=this.state,w=_.prevPoints,b=_.totalLength;return te.createElement(ql,{begin:f,duration:u,isActive:d,easing:h,from:{t:0},to:{t:1},key:"line-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(N){var S=N.t;if(w){var k=w.length/l.length,C=l.map(function(z,M){var B=Math.floor(M*k);if(w[B]){var F=w[B],U=ha(F.x,z.x),H=ha(F.y,z.y);return Ni(Ni({},z),{},{x:U(S),y:H(S)})}if(v){var q=ha(g*2,z.x),K=ha(x/2,z.y);return Ni(Ni({},z),{},{x:q(S),y:K(S)})}return Ni(Ni({},z),{},{x:z.x,y:z.y})});return i.renderCurveStatically(C,n,a)}var A=ha(0,b),R=A(S),I;if(c){var O="".concat(c).split(/[,\s]+/gim).map(function(z){return parseFloat(z)});I=i.getStrokeDasharray(R,b,O)}else I=i.generateSimpleStrokeDasharray(b,R);return i.renderCurveStatically(l,n,a,{strokeDasharray:I})})}},{key:"renderCurve",value:function(n,a){var i=this.props,o=i.points,l=i.isAnimationActive,c=this.state,d=c.prevPoints,f=c.totalLength;return l&&o&&o.length&&(!d&&f>0||!Wm(d,o))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(o,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,l=a.points,c=a.className,d=a.xAxis,f=a.yAxis,u=a.top,h=a.left,m=a.width,v=a.height,g=a.isAnimationActive,x=a.id;if(i||!l||!l.length)return null;var _=this.state.isAnimationFinished,w=l.length===1,b=on("recharts-line",c),N=d&&d.allowDataOverflow,S=f&&f.allowDataOverflow,k=N||S,C=Zr(x)?this.id:x,A=(n=qr(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},R=A.r,I=R===void 0?3:R,O=A.strokeWidth,z=O===void 0?2:O,M=BW(o)?o:{},B=M.clipDot,F=B===void 0?!0:B,U=I*2+z;return te.createElement(Wn,{className:b},N||S?te.createElement("defs",null,te.createElement("clipPath",{id:"clipPath-".concat(C)},te.createElement("rect",{x:N?h:h-m/2,y:S?u:u-v/2,width:N?m:m*2,height:S?v:v*2})),!F&&te.createElement("clipPath",{id:"clipPath-dots-".concat(C)},te.createElement("rect",{x:h-U/2,y:u-U/2,width:m+U,height:v+U}))):null,!w&&this.renderCurve(k,C),this.renderErrorBar(k,C),(w||o)&&this.renderDots(k,F,C),(!g||_)&&Cc.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(uh(n),[0]):n,o=[],l=0;l<a;++l)o=[].concat(uh(o),uh(i));return o}},{key:"renderDotItem",value:function(n,a){var i;if(te.isValidElement(n))i=te.cloneElement(n,a);else if($r(n))i=n(a);else{var o=a.key,l=P$(a,yze),c=on("recharts-line-dot",typeof n!="boolean"?n.className:"");i=te.createElement(Tj,hv({key:o},l,{className:c}))}return i}}])}(y.PureComponent);Oo(rp,"displayName","Line");Oo(rp,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Dl.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Oo(rp,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,o=e.dataKey,l=e.bandSize,c=e.displayedData,d=e.offset,f=t.layout,u=c.map(function(h,m){var v=Ka(h,o);return f==="horizontal"?{x:nb({axis:r,ticks:a,bandSize:l,entry:h,index:m}),y:Zr(v)?null:n.scale(v),value:v,payload:h}:{x:Zr(v)?null:r.scale(v),y:nb({axis:n,ticks:i,bandSize:l,entry:h,index:m}),value:v,payload:h}});return Ni({points:u,layout:f},d)});var Aze=["layout","type","stroke","connectNulls","isRange","ref"],Rze=["key"],FY;function np(e){"@babel/helpers - typeof";return np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},np(e)}function zY(e,t){if(e==null)return{};var r=Oze(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Oze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Bu(){return Bu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bu.apply(this,arguments)}function R$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ld(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R$(Object(r),!0).forEach(function(n){Tl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UY(n.key),n)}}function Dze(e,t,r){return t&&O$(e.prototype,t),r&&O$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ize(e,t,r){return t=Nb(t),$ze(e,BY()?Reflect.construct(t,r||[],Nb(e).constructor):t.apply(e,r))}function $ze(e,t){if(t&&(np(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lze(e)}function Lze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(BY=function(){return!!e})()}function Nb(e){return Nb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nb(e)}function Fze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gC(e,t)}function gC(e,t){return gC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},gC(e,t)}function Tl(e,t,r){return t=UY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UY(e){var t=zze(e,"string");return np(t)=="symbol"?t:t+""}function zze(e,t){if(np(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(np(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bc=function(e){function t(){var r;Mze(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Ize(this,t,[].concat(a)),Tl(r,"state",{isAnimationFinished:!0}),Tl(r,"id",Dp("recharts-area-")),Tl(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),$r(o)&&o()}),Tl(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),$r(o)&&o()}),r}return Fze(t,e),Dze(t,[{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(o&&!l)return null;var c=this.props,d=c.dot,f=c.points,u=c.dataKey,h=qr(this.props,!1),m=qr(d,!0),v=f.map(function(x,_){var w=ld(ld(ld({key:"dot-".concat(_),r:3},h),m),{},{index:_,cx:x.x,cy:x.y,dataKey:u,value:x.value,payload:x.payload,points:f});return t.renderDotItem(d,w)}),g={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return te.createElement(Wn,Bu({className:"recharts-area-dots"},g),v)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,l=a.strokeWidth,c=o[0].x,d=o[o.length-1].x,f=n*Math.abs(c-d),u=kd(o.map(function(h){return h.y||0}));return bt(i)&&typeof i=="number"?u=Math.max(i,u):i&&Array.isArray(i)&&i.length&&(u=Math.max(kd(i.map(function(h){return h.y||0})),u)),bt(u)?te.createElement("rect",{x:c<d?c:c-f,y:0,width:f,height:Math.floor(u+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,l=a.strokeWidth,c=o[0].y,d=o[o.length-1].y,f=n*Math.abs(c-d),u=kd(o.map(function(h){return h.x||0}));return bt(i)&&typeof i=="number"?u=Math.max(i,u):i&&Array.isArray(i)&&i.length&&(u=Math.max(kd(i.map(function(h){return h.x||0})),u)),bt(u)?te.createElement("rect",{x:0,y:c<d?c:c-f,width:u+(l?parseInt("".concat(l),10):1),height:Math.floor(f)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,i,o){var l=this.props,c=l.layout,d=l.type,f=l.stroke,u=l.connectNulls,h=l.isRange;l.ref;var m=zY(l,Aze);return te.createElement(Wn,{clipPath:i?"url(#clipPath-".concat(o,")"):null},te.createElement(im,Bu({},qr(m,!0),{points:n,connectNulls:u,type:d,baseLine:a,layout:c,stroke:"none",className:"recharts-area-area"})),f!=="none"&&te.createElement(im,Bu({},qr(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:u,fill:"none",points:n})),f!=="none"&&h&&te.createElement(im,Bu({},qr(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:u,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var i=this,o=this.props,l=o.points,c=o.baseLine,d=o.isAnimationActive,f=o.animationBegin,u=o.animationDuration,h=o.animationEasing,m=o.animationId,v=this.state,g=v.prevPoints,x=v.prevBaseLine;return te.createElement(ql,{begin:f,duration:u,isActive:d,easing:h,from:{t:0},to:{t:1},key:"area-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(_){var w=_.t;if(g){var b=g.length/l.length,N=l.map(function(A,R){var I=Math.floor(R*b);if(g[I]){var O=g[I],z=ha(O.x,A.x),M=ha(O.y,A.y);return ld(ld({},A),{},{x:z(w),y:M(w)})}return A}),S;if(bt(c)&&typeof c=="number"){var k=ha(x,c);S=k(w)}else if(Zr(c)||Mp(c)){var C=ha(x,0);S=C(w)}else S=c.map(function(A,R){var I=Math.floor(R*b);if(x[I]){var O=x[I],z=ha(O.x,A.x),M=ha(O.y,A.y);return ld(ld({},A),{},{x:z(w),y:M(w)})}return A});return i.renderAreaStatically(N,S,n,a)}return te.createElement(Wn,null,te.createElement("defs",null,te.createElement("clipPath",{id:"animationClipPath-".concat(a)},i.renderClipRect(w))),te.createElement(Wn,{clipPath:"url(#animationClipPath-".concat(a,")")},i.renderAreaStatically(l,c,n,a)))})}},{key:"renderArea",value:function(n,a){var i=this.props,o=i.points,l=i.baseLine,c=i.isAnimationActive,d=this.state,f=d.prevPoints,u=d.prevBaseLine,h=d.totalLength;return c&&o&&o.length&&(!f&&h>0||!Wm(f,o)||!Wm(u,l))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(o,l,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,l=a.points,c=a.className,d=a.top,f=a.left,u=a.xAxis,h=a.yAxis,m=a.width,v=a.height,g=a.isAnimationActive,x=a.id;if(i||!l||!l.length)return null;var _=this.state.isAnimationFinished,w=l.length===1,b=on("recharts-area",c),N=u&&u.allowDataOverflow,S=h&&h.allowDataOverflow,k=N||S,C=Zr(x)?this.id:x,A=(n=qr(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},R=A.r,I=R===void 0?3:R,O=A.strokeWidth,z=O===void 0?2:O,M=BW(o)?o:{},B=M.clipDot,F=B===void 0?!0:B,U=I*2+z;return te.createElement(Wn,{className:b},N||S?te.createElement("defs",null,te.createElement("clipPath",{id:"clipPath-".concat(C)},te.createElement("rect",{x:N?f:f-m/2,y:S?d:d-v/2,width:N?m:m*2,height:S?v:v*2})),!F&&te.createElement("clipPath",{id:"clipPath-dots-".concat(C)},te.createElement("rect",{x:f-U/2,y:d-U/2,width:m+U,height:v+U}))):null,w?null:this.renderArea(k,C),(o||w)&&this.renderDots(k,F,C),(!g||_)&&Cc.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(y.PureComponent);FY=Bc;Tl(Bc,"displayName","Area");Tl(Bc,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Dl.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Tl(Bc,"getBaseValue",function(e,t,r,n){var a=e.layout,i=e.baseValue,o=t.props.baseValue,l=o!=null?o:i;if(bt(l)&&typeof l=="number")return l;var c=a==="horizontal"?n:r,d=c.scale.domain();if(c.type==="number"){var f=Math.max(d[0],d[1]),u=Math.min(d[0],d[1]);return l==="dataMin"?u:l==="dataMax"||f<0?f:Math.max(Math.min(d[0],d[1]),0)}return l==="dataMin"?d[0]:l==="dataMax"?d[1]:d[0]});Tl(Bc,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,l=e.bandSize,c=e.dataKey,d=e.stackedData,f=e.dataStartIndex,u=e.displayedData,h=e.offset,m=t.layout,v=d&&d.length,g=FY.getBaseValue(t,r,n,a),x=m==="horizontal",_=!1,w=u.map(function(N,S){var k;v?k=d[f+S]:(k=Ka(N,c),Array.isArray(k)?_=!0:k=[g,k]);var C=k[1]==null||v&&Ka(N,c)==null;return x?{x:nb({axis:n,ticks:i,bandSize:l,entry:N,index:S}),y:C?null:a.scale(k[1]),value:k,payload:N}:{x:C?null:n.scale(k[1]),y:nb({axis:a,ticks:o,bandSize:l,entry:N,index:S}),value:k,payload:N}}),b;return v||_?b=w.map(function(N){var S=Array.isArray(N.value)?N.value[0]:null;return x?{x:N.x,y:S!=null&&N.y!=null?a.scale(S):null}:{x:S!=null?n.scale(S):null,y:N.y}}):b=x?a.scale(g):n.scale(g),ld({points:w,baseLine:b,layout:m,isRange:_},h)});Tl(Bc,"renderDotItem",function(e,t){var r;if(te.isValidElement(e))r=te.cloneElement(e,t);else if($r(e))r=e(t);else{var n=on("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,i=zY(t,Rze);r=te.createElement(Tj,Bu({},i,{key:a,className:n}))}return r});function sp(e){"@babel/helpers - typeof";return sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sp(e)}function Bze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WY(n.key),n)}}function qze(e,t,r){return t&&Uze(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vze(e,t,r){return t=Sb(t),Wze(e,qY()?Reflect.construct(t,r||[],Sb(e).constructor):t.apply(e,r))}function Wze(e,t){if(t&&(sp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hze(e)}function Hze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(qY=function(){return!!e})()}function Sb(e){return Sb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sb(e)}function Gze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vC(e,t)}function vC(e,t){return vC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},vC(e,t)}function VY(e,t,r){return t=WY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WY(e){var t=Yze(e,"string");return sp(t)=="symbol"?t:t+""}function Yze(e,t){if(sp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yC(){return yC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yC.apply(this,arguments)}function Kze(e){var t=e.xAxisId,r=O5(),n=M5(),a=SY(t);return a==null?null:y.createElement(Up,yC({},a,{className:on("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(o){return bc(o,!0)}}))}var ai=function(e){function t(){return Bze(this,t),Vze(this,t,arguments)}return Gze(t,e),qze(t,[{key:"render",value:function(){return y.createElement(Kze,this.props)}}])}(y.Component);VY(ai,"displayName","XAxis");VY(ai,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function ap(e){"@babel/helpers - typeof";return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(e)}function Zze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YY(n.key),n)}}function Jze(e,t,r){return t&&Xze(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qze(e,t,r){return t=kb(t),e9e(e,HY()?Reflect.construct(t,r||[],kb(e).constructor):t.apply(e,r))}function e9e(e,t){if(t&&(ap(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t9e(e)}function t9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(HY=function(){return!!e})()}function kb(e){return kb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kb(e)}function r9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xC(e,t)}function xC(e,t){return xC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},xC(e,t)}function GY(e,t,r){return t=YY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YY(e){var t=n9e(e,"string");return ap(t)=="symbol"?t:t+""}function n9e(e,t){if(ap(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ap(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _C(){return _C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_C.apply(this,arguments)}var s9e=function(t){var r=t.yAxisId,n=O5(),a=M5(),i=kY(r);return i==null?null:y.createElement(Up,_C({},i,{className:on("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(l){return bc(l,!0)}}))},ii=function(e){function t(){return Zze(this,t),Qze(this,t,arguments)}return r9e(t,e),Jze(t,[{key:"render",value:function(){return y.createElement(s9e,this.props)}}])}(y.Component);GY(ii,"displayName","YAxis");GY(ii,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function M$(e){return l9e(e)||o9e(e)||i9e(e)||a9e()}function a9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i9e(e,t){if(e){if(typeof e=="string")return wC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wC(e,t)}}function o9e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function l9e(e){if(Array.isArray(e))return wC(e)}function wC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var bC=function(t,r,n,a,i){var o=co(t,I5),l=co(t,Dj),c=[].concat(M$(o),M$(l)),d=co(t,$j),f="".concat(a,"Id"),u=a[0],h=r;if(c.length&&(h=c.reduce(function(g,x){if(x.props[f]===n&&$l(x.props,"extendDomain")&&bt(x.props[u])){var _=x.props[u];return[Math.min(g[0],_),Math.max(g[1],_)]}return g},h)),d.length){var m="".concat(u,"1"),v="".concat(u,"2");h=d.reduce(function(g,x){if(x.props[f]===n&&$l(x.props,"extendDomain")&&bt(x.props[m])&&bt(x.props[v])){var _=x.props[m],w=x.props[v];return[Math.min(g[0],_,w),Math.max(g[1],_,w)]}return g},h)}return i&&i.length&&(h=i.reduce(function(g,x){return bt(x)?[Math.min(g[0],x),Math.max(g[1],x)]:g},h)),h},KY={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,d,f){this.fn=c,this.context=d,this.once=f||!1}function i(c,d,f,u,h){if(typeof f!="function")throw new TypeError("The listener must be a function");var m=new a(f,u||c,h),v=r?r+d:d;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],m]:c._events[v].push(m):(c._events[v]=m,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],f,u;if(this._eventsCount===0)return d;for(u in f=this._events)t.call(f,u)&&d.push(r?u.slice(1):u);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(f)):d},l.prototype.listeners=function(d){var f=r?r+d:d,u=this._events[f];if(!u)return[];if(u.fn)return[u.fn];for(var h=0,m=u.length,v=new Array(m);h<m;h++)v[h]=u[h].fn;return v},l.prototype.listenerCount=function(d){var f=r?r+d:d,u=this._events[f];return u?u.fn?1:u.length:0},l.prototype.emit=function(d,f,u,h,m,v){var g=r?r+d:d;if(!this._events[g])return!1;var x=this._events[g],_=arguments.length,w,b;if(x.fn){switch(x.once&&this.removeListener(d,x.fn,void 0,!0),_){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,f),!0;case 3:return x.fn.call(x.context,f,u),!0;case 4:return x.fn.call(x.context,f,u,h),!0;case 5:return x.fn.call(x.context,f,u,h,m),!0;case 6:return x.fn.call(x.context,f,u,h,m,v),!0}for(b=1,w=new Array(_-1);b<_;b++)w[b-1]=arguments[b];x.fn.apply(x.context,w)}else{var N=x.length,S;for(b=0;b<N;b++)switch(x[b].once&&this.removeListener(d,x[b].fn,void 0,!0),_){case 1:x[b].fn.call(x[b].context);break;case 2:x[b].fn.call(x[b].context,f);break;case 3:x[b].fn.call(x[b].context,f,u);break;case 4:x[b].fn.call(x[b].context,f,u,h);break;default:if(!w)for(S=1,w=new Array(_-1);S<_;S++)w[S-1]=arguments[S];x[b].fn.apply(x[b].context,w)}}return!0},l.prototype.on=function(d,f,u){return i(this,d,f,u,!1)},l.prototype.once=function(d,f,u){return i(this,d,f,u,!0)},l.prototype.removeListener=function(d,f,u,h){var m=r?r+d:d;if(!this._events[m])return this;if(!f)return o(this,m),this;var v=this._events[m];if(v.fn)v.fn===f&&(!h||v.once)&&(!u||v.context===u)&&o(this,m);else{for(var g=0,x=[],_=v.length;g<_;g++)(v[g].fn!==f||h&&!v[g].once||u&&v[g].context!==u)&&x.push(v[g]);x.length?this._events[m]=x.length===1?x[0]:x:o(this,m)}return this},l.prototype.removeAllListeners=function(d){var f;return d?(f=r?r+d:d,this._events[f]&&o(this,f)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(KY);var c9e=KY.exports;const d9e=wn(c9e);var WS=new d9e,HS="recharts.syncMouseEvents";function Ry(e){"@babel/helpers - typeof";return Ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ry(e)}function u9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f9e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZY(n.key),n)}}function h9e(e,t,r){return t&&f9e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function GS(e,t,r){return t=ZY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZY(e){var t=m9e(e,"string");return Ry(t)=="symbol"?t:t+""}function m9e(e,t){if(Ry(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ry(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var p9e=function(){function e(){u9e(this,e),GS(this,"activeIndex",0),GS(this,"coordinateList",[]),GS(this,"layout","horizontal")}return h9e(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,o=r.container,l=o===void 0?null:o,c=r.layout,d=c===void 0?null:c,f=r.offset,u=f===void 0?null:f,h=r.mouseHandlerCallback,m=h===void 0?null:h;this.coordinateList=(n=i!=null?i:this.coordinateList)!==null&&n!==void 0?n:[],this.container=l!=null?l:this.container,this.layout=d!=null?d:this.layout,this.offset=u!=null?u:this.offset,this.mouseHandlerCallback=m!=null?m:this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,o=a.y,l=a.height,c=this.coordinateList[this.activeIndex].coordinate,d=((r=window)===null||r===void 0?void 0:r.scrollX)||0,f=((n=window)===null||n===void 0?void 0:n.scrollY)||0,u=i+c+d,h=o+this.offset.top+l/2+f;this.mouseHandlerCallback({pageX:u,pageY:h})}}}])}();function g9e(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&bt(n)&&bt(a))return!0}return!1}function v9e(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function XY(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,o=pa(t,r,n,a),l=pa(t,r,n,i);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function y9e(e,t,r){var n,a,i,o;if(e==="horizontal")n=t.x,i=n,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,d=t.innerRadius,f=t.outerRadius,u=t.angle,h=pa(l,c,d,u),m=pa(l,c,f,u);n=h.x,a=h.y,i=m.x,o=m.y}else return XY(t);return[{x:n,y:a},{x:i,y:o}]}function Oy(e){"@babel/helpers - typeof";return Oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oy(e)}function D$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D$(Object(r),!0).forEach(function(n){x9e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x9e(e,t,r){return t=_9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _9e(e){var t=w9e(e,"string");return Oy(t)=="symbol"?t:t+""}function w9e(e,t){if(Oy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function b9e(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,o=e.activeCoordinate,l=e.activePayload,c=e.offset,d=e.activeTooltipIndex,f=e.tooltipAxisBandSize,u=e.layout,h=e.chartName,m=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!m||!i||!o||h!=="ScatterChart"&&a!=="axis")return null;var v,g=im;if(h==="ScatterChart")v=o,g=f$e;else if(h==="BarChart")v=v9e(u,o,c,f),g=C5;else if(u==="radial"){var x=XY(o),_=x.cx,w=x.cy,b=x.radius,N=x.startAngle,S=x.endAngle;v={cx:_,cy:w,startAngle:N,endAngle:S,innerRadius:b,outerRadius:b},g=eY}else v={points:y9e(u,o,c)},g=im;var k=Gx(Gx(Gx(Gx({stroke:"#ccc",pointerEvents:"none"},c),v),qr(m,!1)),{},{payload:l,payloadIndex:d,className:on("recharts-tooltip-cursor",m.className)});return y.isValidElement(m)?y.cloneElement(m,k):y.createElement(g,k)}var j9e=["item"],N9e=["children","className","width","height","style","compact","title","desc"];function ip(e){"@babel/helpers - typeof";return ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ip(e)}function Lh(){return Lh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lh.apply(this,arguments)}function I$(e,t){return E9e(e)||k9e(e,t)||QY(e,t)||S9e()}function S9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k9e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(f){d=!0,a=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function E9e(e){if(Array.isArray(e))return e}function $$(e,t){if(e==null)return{};var r=C9e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function C9e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function P9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T9e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eK(n.key),n)}}function A9e(e,t,r){return t&&T9e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function R9e(e,t,r){return t=Eb(t),O9e(e,JY()?Reflect.construct(t,r||[],Eb(e).constructor):t.apply(e,r))}function O9e(e,t){if(t&&(ip(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return M9e(e)}function M9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(JY=function(){return!!e})()}function Eb(e){return Eb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eb(e)}function D9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jC(e,t)}function jC(e,t){return jC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},jC(e,t)}function op(e){return L9e(e)||$9e(e)||QY(e)||I9e()}function I9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QY(e,t){if(e){if(typeof e=="string")return NC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NC(e,t)}}function $9e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function L9e(e){if(Array.isArray(e))return NC(e)}function NC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function L$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L$(Object(r),!0).forEach(function(n){gr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gr(e,t,r){return t=eK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eK(e){var t=F9e(e,"string");return ip(t)=="symbol"?t:t+""}function F9e(e,t){if(ip(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ip(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z9e={xAxis:["bottom","top"],yAxis:["left","right"]},B9e={width:"100%",height:"100%"},tK={x:0,y:0};function Yx(e){return e}var U9e=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},q9e=function(t,r,n,a){var i=r.find(function(f){return f&&f.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,l=a.radius;return Qe(Qe(Qe({},a),pa(a.cx,a.cy,l,o)),{},{angle:o,radius:l})}var c=i.coordinate,d=a.angle;return Qe(Qe(Qe({},a),pa(a.cx,a.cy,c,d)),{},{angle:d,radius:c})}return tK},Lj=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,o=(n!=null?n:[]).reduce(function(l,c){var d=c.props.data;return d&&d.length?[].concat(op(l),op(d)):l},[]);return o.length>0?o:t&&t.length&&bt(a)&&bt(i)?t.slice(a,i+1):[]};function rK(e){return e==="number"?[0,"auto"]:void 0}var SC=function(t,r,n,a){var i=t.graphicalItems,o=t.tooltipAxis,l=Lj(r,t);return n<0||!i||!i.length||n>=l.length?null:i.reduce(function(c,d){var f,u=(f=d.props.data)!==null&&f!==void 0?f:r;u&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(u=u.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(o.dataKey&&!o.allowDuplicatedCategory){var m=u===void 0?l:u;h=Ew(m,o.dataKey,a)}else h=u&&u[n]||l[n];return h?[].concat(op(c),[XG(d,h)]):c},[])},F$=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},o=U9e(i,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,d=t.tooltipTicks,f=Q4e(o,l,d,c);if(f>=0&&d){var u=d[f]&&d[f].value,h=SC(t,r,f,u),m=q9e(n,l,f,i);return{activeTooltipIndex:f,activeLabel:u,activePayload:h,activeCoordinate:m}}return null},V9e=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,f=t.layout,u=t.children,h=t.stackOffset,m=YG(f,i);return n.reduce(function(v,g){var x,_=g.type.defaultProps!==void 0?Qe(Qe({},g.type.defaultProps),g.props):g.props,w=_.type,b=_.dataKey,N=_.allowDataOverflow,S=_.allowDuplicatedCategory,k=_.scale,C=_.ticks,A=_.includeHidden,R=_[o];if(v[R])return v;var I=Lj(t.data,{graphicalItems:a.filter(function(Y){var X,se=o in Y.props?Y.props[o]:(X=Y.type.defaultProps)===null||X===void 0?void 0:X[o];return se===R}),dataStartIndex:c,dataEndIndex:d}),O=I.length,z,M,B;g9e(_.domain,N,w)&&(z=UE(_.domain,null,N),m&&(w==="number"||k!=="auto")&&(B=uv(I,b,"category")));var F=rK(w);if(!z||z.length===0){var U,H=(U=_.domain)!==null&&U!==void 0?U:F;if(b){if(z=uv(I,b,w),w==="category"&&m){var q=B1e(z);S&&q?(M=z,z=hb(0,O)):S||(z=pI(H,z,g).reduce(function(Y,X){return Y.indexOf(X)>=0?Y:[].concat(op(Y),[X])},[]))}else if(w==="category")S?z=z.filter(function(Y){return Y!==""&&!Zr(Y)}):z=pI(H,z,g).reduce(function(Y,X){return Y.indexOf(X)>=0||X===""||Zr(X)?Y:[].concat(op(Y),[X])},[]);else if(w==="number"){var K=s3e(I,a.filter(function(Y){var X,se,de=o in Y.props?Y.props[o]:(X=Y.type.defaultProps)===null||X===void 0?void 0:X[o],_e="hide"in Y.props?Y.props.hide:(se=Y.type.defaultProps)===null||se===void 0?void 0:se.hide;return de===R&&(A||!_e)}),b,i,f);K&&(z=K)}m&&(w==="number"||k!=="auto")&&(B=uv(I,b,"category"))}else m?z=hb(0,O):l&&l[R]&&l[R].hasStack&&w==="number"?z=h==="expand"?[0,1]:ZG(l[R].stackGroups,c,d):z=GG(I,a.filter(function(Y){var X=o in Y.props?Y.props[o]:Y.type.defaultProps[o],se="hide"in Y.props?Y.props.hide:Y.type.defaultProps.hide;return X===R&&(A||!se)}),w,f,!0);if(w==="number")z=bC(u,z,R,i,C),H&&(z=UE(H,z,N));else if(w==="category"&&H){var Z=H,ne=z.every(function(Y){return Z.indexOf(Y)>=0});ne&&(z=Z)}}return Qe(Qe({},v),{},gr({},R,Qe(Qe({},_),{},{axisType:i,domain:z,categoricalDomain:B,duplicateDomain:M,originalDomain:(x=_.domain)!==null&&x!==void 0?x:F,isCategorical:m,layout:f})))},{})},W9e=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,f=t.layout,u=t.children,h=Lj(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:d}),m=h.length,v=YG(f,i),g=-1;return n.reduce(function(x,_){var w=_.type.defaultProps!==void 0?Qe(Qe({},_.type.defaultProps),_.props):_.props,b=w[o],N=rK("number");if(!x[b]){g++;var S;return v?S=hb(0,m):l&&l[b]&&l[b].hasStack?(S=ZG(l[b].stackGroups,c,d),S=bC(u,S,b,i)):(S=UE(N,GG(h,n.filter(function(k){var C,A,R=o in k.props?k.props[o]:(C=k.type.defaultProps)===null||C===void 0?void 0:C[o],I="hide"in k.props?k.props.hide:(A=k.type.defaultProps)===null||A===void 0?void 0:A.hide;return R===b&&!I}),"number",f),a.defaultProps.allowDataOverflow),S=bC(u,S,b,i)),Qe(Qe({},x),{},gr({},b,Qe(Qe({axisType:i},a.defaultProps),{},{hide:!0,orientation:lo(z9e,"".concat(i,".").concat(g%2),null),domain:S,originalDomain:N,isCategorical:v,layout:f})))}return x},{})},H9e=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,f=t.children,u="".concat(a,"Id"),h=co(f,i),m={};return h&&h.length?m=V9e(t,{axes:h,graphicalItems:o,axisType:a,axisIdKey:u,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):o&&o.length&&(m=W9e(t,{Axis:i,graphicalItems:o,axisType:a,axisIdKey:u,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),m},G9e=function(t){var r=gd(t),n=bc(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:t5(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:sb(r,n)}},z$=function(t){var r=t.children,n=t.defaultShowTooltip,a=Pi(r,Km),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},Y9e=function(t){return!t||!t.length?!1:t.some(function(r){var n=Sc(r&&r.type);return n&&n.indexOf("Bar")>=0})},B$=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},K9e=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,l=t.yAxisMap,c=l===void 0?{}:l,d=n.width,f=n.height,u=n.children,h=n.margin||{},m=Pi(u,Km),v=Pi(u,tf),g=Object.keys(c).reduce(function(S,k){var C=c[k],A=C.orientation;return!C.mirror&&!C.hide?Qe(Qe({},S),{},gr({},A,S[A]+C.width)):S},{left:h.left||0,right:h.right||0}),x=Object.keys(o).reduce(function(S,k){var C=o[k],A=C.orientation;return!C.mirror&&!C.hide?Qe(Qe({},S),{},gr({},A,lo(S,"".concat(A))+C.height)):S},{top:h.top||0,bottom:h.bottom||0}),_=Qe(Qe({},x),g),w=_.bottom;m&&(_.bottom+=m.props.height||Km.defaultProps.height),v&&r&&(_=r3e(_,a,n,r));var b=d-_.left-_.right,N=f-_.top-_.bottom;return Qe(Qe({brushBottom:w},_),{},{width:Math.max(b,0),height:Math.max(N,0)})},Z9e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},F5=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,o=t.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=t.axisComponents,d=t.legendContent,f=t.formatAxisMap,u=t.defaultProps,h=function(_,w){var b=w.graphicalItems,N=w.stackGroups,S=w.offset,k=w.updateId,C=w.dataStartIndex,A=w.dataEndIndex,R=_.barSize,I=_.layout,O=_.barGap,z=_.barCategoryGap,M=_.maxBarSize,B=B$(I),F=B.numericAxisName,U=B.cateAxisName,H=Y9e(b),q=[];return b.forEach(function(K,Z){var ne=Lj(_.data,{graphicalItems:[K],dataStartIndex:C,dataEndIndex:A}),Y=K.type.defaultProps!==void 0?Qe(Qe({},K.type.defaultProps),K.props):K.props,X=Y.dataKey,se=Y.maxBarSize,de=Y["".concat(F,"Id")],_e=Y["".concat(U,"Id")],xe={},Q=c.reduce(function(Ve,le){var Ke=w["".concat(le.axisType,"Map")],De=Y["".concat(le.axisType,"Id")];Ke&&Ke[De]||le.axisType==="zAxis"||Nf();var nt=Ke[De];return Qe(Qe({},Ve),{},gr(gr({},le.axisType,nt),"".concat(le.axisType,"Ticks"),bc(nt)))},xe),oe=Q[U],ie=Q["".concat(U,"Ticks")],ee=N&&N[de]&&N[de].hasStack&&g3e(K,N[de].stackGroups),G=Sc(K.type).indexOf("Bar")>=0,J=sb(oe,ie),ae=[],fe=H&&e3e({barSize:R,stackGroups:N,totalSize:Z9e(Q,U)});if(G){var we,ve,me=Zr(se)?M:se,Me=(we=(ve=sb(oe,ie,!0))!==null&&ve!==void 0?ve:me)!==null&&we!==void 0?we:0;ae=t3e({barGap:O,barCategoryGap:z,bandSize:Me!==J?Me:J,sizeList:fe[_e],maxBarSize:me}),Me!==J&&(ae=ae.map(function(Ve){return Qe(Qe({},Ve),{},{position:Qe(Qe({},Ve.position),{},{offset:Ve.position.offset-Me/2})})}))}var Te=K&&K.type&&K.type.getComposedData;Te&&q.push({props:Qe(Qe({},Te(Qe(Qe({},Q),{},{displayedData:ne,props:_,dataKey:X,item:K,bandSize:J,barPosition:ae,offset:S,stackedData:ee,layout:I,dataStartIndex:C,dataEndIndex:A}))),{},gr(gr(gr({key:K.key||"item-".concat(Z)},F,Q[F]),U,Q[U]),"animationId",k)),childIndex:Q1e(K,_.children),item:K})}),q},m=function(_,w){var b=_.props,N=_.dataStartIndex,S=_.dataEndIndex,k=_.updateId;if(!c3({props:b}))return null;var C=b.children,A=b.layout,R=b.stackOffset,I=b.data,O=b.reverseStackOrder,z=B$(A),M=z.numericAxisName,B=z.cateAxisName,F=co(C,n),U=h3e(I,F,"".concat(M,"Id"),"".concat(B,"Id"),R,O),H=c.reduce(function(Y,X){var se="".concat(X.axisType,"Map");return Qe(Qe({},Y),{},gr({},se,H9e(b,Qe(Qe({},X),{},{graphicalItems:F,stackGroups:X.axisType===M&&U,dataStartIndex:N,dataEndIndex:S}))))},{}),q=K9e(Qe(Qe({},H),{},{props:b,graphicalItems:F}),w==null?void 0:w.legendBBox);Object.keys(H).forEach(function(Y){H[Y]=f(b,H[Y],q,Y.replace("Map",""),r)});var K=H["".concat(B,"Map")],Z=G9e(K),ne=h(b,Qe(Qe({},H),{},{dataStartIndex:N,dataEndIndex:S,updateId:k,graphicalItems:F,stackGroups:U,offset:q}));return Qe(Qe({formattedGraphicalItems:ne,graphicalItems:F,offset:q,stackGroups:U},Z),H)},v=function(x){function _(w){var b,N,S;return P9e(this,_),S=R9e(this,_,[w]),gr(S,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),gr(S,"accessibilityManager",new p9e),gr(S,"handleLegendBBoxUpdate",function(k){if(k){var C=S.state,A=C.dataStartIndex,R=C.dataEndIndex,I=C.updateId;S.setState(Qe({legendBBox:k},m({props:S.props,dataStartIndex:A,dataEndIndex:R,updateId:I},Qe(Qe({},S.state),{},{legendBBox:k}))))}}),gr(S,"handleReceiveSyncEvent",function(k,C,A){if(S.props.syncId===k){if(A===S.eventEmitterSymbol&&typeof S.props.syncMethod!="function")return;S.applySyncEvent(C)}}),gr(S,"handleBrushChange",function(k){var C=k.startIndex,A=k.endIndex;if(C!==S.state.dataStartIndex||A!==S.state.dataEndIndex){var R=S.state.updateId;S.setState(function(){return Qe({dataStartIndex:C,dataEndIndex:A},m({props:S.props,dataStartIndex:C,dataEndIndex:A,updateId:R},S.state))}),S.triggerSyncEvent({dataStartIndex:C,dataEndIndex:A})}}),gr(S,"handleMouseEnter",function(k){var C=S.getMouseInfo(k);if(C){var A=Qe(Qe({},C),{},{isTooltipActive:!0});S.setState(A),S.triggerSyncEvent(A);var R=S.props.onMouseEnter;$r(R)&&R(A,k)}}),gr(S,"triggeredAfterMouseMove",function(k){var C=S.getMouseInfo(k),A=C?Qe(Qe({},C),{},{isTooltipActive:!0}):{isTooltipActive:!1};S.setState(A),S.triggerSyncEvent(A);var R=S.props.onMouseMove;$r(R)&&R(A,k)}),gr(S,"handleItemMouseEnter",function(k){S.setState(function(){return{isTooltipActive:!0,activeItem:k,activePayload:k.tooltipPayload,activeCoordinate:k.tooltipPosition||{x:k.cx,y:k.cy}}})}),gr(S,"handleItemMouseLeave",function(){S.setState(function(){return{isTooltipActive:!1}})}),gr(S,"handleMouseMove",function(k){k.persist(),S.throttleTriggeredAfterMouseMove(k)}),gr(S,"handleMouseLeave",function(k){S.throttleTriggeredAfterMouseMove.cancel();var C={isTooltipActive:!1};S.setState(C),S.triggerSyncEvent(C);var A=S.props.onMouseLeave;$r(A)&&A(C,k)}),gr(S,"handleOuterEvent",function(k){var C=J1e(k),A=lo(S.props,"".concat(C));if(C&&$r(A)){var R,I;/.*touch.*/i.test(C)?I=S.getMouseInfo(k.changedTouches[0]):I=S.getMouseInfo(k),A((R=I)!==null&&R!==void 0?R:{},k)}}),gr(S,"handleClick",function(k){var C=S.getMouseInfo(k);if(C){var A=Qe(Qe({},C),{},{isTooltipActive:!0});S.setState(A),S.triggerSyncEvent(A);var R=S.props.onClick;$r(R)&&R(A,k)}}),gr(S,"handleMouseDown",function(k){var C=S.props.onMouseDown;if($r(C)){var A=S.getMouseInfo(k);C(A,k)}}),gr(S,"handleMouseUp",function(k){var C=S.props.onMouseUp;if($r(C)){var A=S.getMouseInfo(k);C(A,k)}}),gr(S,"handleTouchMove",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&S.throttleTriggeredAfterMouseMove(k.changedTouches[0])}),gr(S,"handleTouchStart",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&S.handleMouseDown(k.changedTouches[0])}),gr(S,"handleTouchEnd",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&S.handleMouseUp(k.changedTouches[0])}),gr(S,"handleDoubleClick",function(k){var C=S.props.onDoubleClick;if($r(C)){var A=S.getMouseInfo(k);C(A,k)}}),gr(S,"handleContextMenu",function(k){var C=S.props.onContextMenu;if($r(C)){var A=S.getMouseInfo(k);C(A,k)}}),gr(S,"triggerSyncEvent",function(k){S.props.syncId!==void 0&&WS.emit(HS,S.props.syncId,k,S.eventEmitterSymbol)}),gr(S,"applySyncEvent",function(k){var C=S.props,A=C.layout,R=C.syncMethod,I=S.state.updateId,O=k.dataStartIndex,z=k.dataEndIndex;if(k.dataStartIndex!==void 0||k.dataEndIndex!==void 0)S.setState(Qe({dataStartIndex:O,dataEndIndex:z},m({props:S.props,dataStartIndex:O,dataEndIndex:z,updateId:I},S.state)));else if(k.activeTooltipIndex!==void 0){var M=k.chartX,B=k.chartY,F=k.activeTooltipIndex,U=S.state,H=U.offset,q=U.tooltipTicks;if(!H)return;if(typeof R=="function")F=R(q,k);else if(R==="value"){F=-1;for(var K=0;K<q.length;K++)if(q[K].value===k.activeLabel){F=K;break}}var Z=Qe(Qe({},H),{},{x:H.left,y:H.top}),ne=Math.min(M,Z.x+Z.width),Y=Math.min(B,Z.y+Z.height),X=q[F]&&q[F].value,se=SC(S.state,S.props.data,F),de=q[F]?{x:A==="horizontal"?q[F].coordinate:ne,y:A==="horizontal"?Y:q[F].coordinate}:tK;S.setState(Qe(Qe({},k),{},{activeLabel:X,activeCoordinate:de,activePayload:se,activeTooltipIndex:F}))}else S.setState(k)}),gr(S,"renderCursor",function(k){var C,A=S.state,R=A.isTooltipActive,I=A.activeCoordinate,O=A.activePayload,z=A.offset,M=A.activeTooltipIndex,B=A.tooltipAxisBandSize,F=S.getTooltipEventType(),U=(C=k.props.active)!==null&&C!==void 0?C:R,H=S.props.layout,q=k.key||"_recharts-cursor";return te.createElement(b9e,{key:q,activeCoordinate:I,activePayload:O,activeTooltipIndex:M,chartName:r,element:k,isActive:U,layout:H,offset:z,tooltipAxisBandSize:B,tooltipEventType:F})}),gr(S,"renderPolarAxis",function(k,C,A){var R=lo(k,"type.axisType"),I=lo(S.state,"".concat(R,"Map")),O=k.type.defaultProps,z=O!==void 0?Qe(Qe({},O),k.props):k.props,M=I&&I[z["".concat(R,"Id")]];return y.cloneElement(k,Qe(Qe({},M),{},{className:on(R,M.className),key:k.key||"".concat(C,"-").concat(A),ticks:bc(M,!0)}))}),gr(S,"renderPolarGrid",function(k){var C=k.props,A=C.radialLines,R=C.polarAngles,I=C.polarRadius,O=S.state,z=O.radiusAxisMap,M=O.angleAxisMap,B=gd(z),F=gd(M),U=F.cx,H=F.cy,q=F.innerRadius,K=F.outerRadius;return y.cloneElement(k,{polarAngles:Array.isArray(R)?R:bc(F,!0).map(function(Z){return Z.coordinate}),polarRadius:Array.isArray(I)?I:bc(B,!0).map(function(Z){return Z.coordinate}),cx:U,cy:H,innerRadius:q,outerRadius:K,key:k.key||"polar-grid",radialLines:A})}),gr(S,"renderLegend",function(){var k=S.state.formattedGraphicalItems,C=S.props,A=C.children,R=C.width,I=C.height,O=S.props.margin||{},z=R-(O.left||0)-(O.right||0),M=WG({children:A,formattedGraphicalItems:k,legendWidth:z,legendContent:d});if(!M)return null;var B=M.item,F=$$(M,j9e);return y.cloneElement(B,Qe(Qe({},F),{},{chartWidth:R,chartHeight:I,margin:O,onBBoxUpdate:S.handleLegendBBoxUpdate}))}),gr(S,"renderTooltip",function(){var k,C=S.props,A=C.children,R=C.accessibilityLayer,I=Pi(A,ta);if(!I)return null;var O=S.state,z=O.isTooltipActive,M=O.activeCoordinate,B=O.activePayload,F=O.activeLabel,U=O.offset,H=(k=I.props.active)!==null&&k!==void 0?k:z;return y.cloneElement(I,{viewBox:Qe(Qe({},U),{},{x:U.left,y:U.top}),active:H,label:F,payload:H?B:[],coordinate:M,accessibilityLayer:R})}),gr(S,"renderBrush",function(k){var C=S.props,A=C.margin,R=C.data,I=S.state,O=I.offset,z=I.dataStartIndex,M=I.dataEndIndex,B=I.updateId;return y.cloneElement(k,{key:k.key||"_recharts-brush",onChange:qx(S.handleBrushChange,k.props.onChange),data:R,x:bt(k.props.x)?k.props.x:O.left,y:bt(k.props.y)?k.props.y:O.top+O.height+O.brushBottom-(A.bottom||0),width:bt(k.props.width)?k.props.width:O.width,startIndex:z,endIndex:M,updateId:"brush-".concat(B)})}),gr(S,"renderReferenceElement",function(k,C,A){if(!k)return null;var R=S,I=R.clipPathId,O=S.state,z=O.xAxisMap,M=O.yAxisMap,B=O.offset,F=k.type.defaultProps||{},U=k.props,H=U.xAxisId,q=H===void 0?F.xAxisId:H,K=U.yAxisId,Z=K===void 0?F.yAxisId:K;return y.cloneElement(k,{key:k.key||"".concat(C,"-").concat(A),xAxis:z[q],yAxis:M[Z],viewBox:{x:B.left,y:B.top,width:B.width,height:B.height},clipPathId:I})}),gr(S,"renderActivePoints",function(k){var C=k.item,A=k.activePoint,R=k.basePoint,I=k.childIndex,O=k.isRange,z=[],M=C.props.key,B=C.item.type.defaultProps!==void 0?Qe(Qe({},C.item.type.defaultProps),C.item.props):C.item.props,F=B.activeDot,U=B.dataKey,H=Qe(Qe({index:I,dataKey:U,cx:A.x,cy:A.y,r:4,fill:E5(C.item),strokeWidth:2,stroke:"#fff",payload:A.payload,value:A.value},qr(F,!1)),Cw(F));return z.push(_.renderActiveDot(F,H,"".concat(M,"-activePoint-").concat(I))),R?z.push(_.renderActiveDot(F,Qe(Qe({},H),{},{cx:R.x,cy:R.y}),"".concat(M,"-basePoint-").concat(I))):O&&z.push(null),z}),gr(S,"renderGraphicChild",function(k,C,A){var R=S.filterFormatItem(k,C,A);if(!R)return null;var I=S.getTooltipEventType(),O=S.state,z=O.isTooltipActive,M=O.tooltipAxis,B=O.activeTooltipIndex,F=O.activeLabel,U=S.props.children,H=Pi(U,ta),q=R.props,K=q.points,Z=q.isRange,ne=q.baseLine,Y=R.item.type.defaultProps!==void 0?Qe(Qe({},R.item.type.defaultProps),R.item.props):R.item.props,X=Y.activeDot,se=Y.hide,de=Y.activeBar,_e=Y.activeShape,xe=!!(!se&&z&&H&&(X||de||_e)),Q={};I!=="axis"&&H&&H.props.trigger==="click"?Q={onClick:qx(S.handleItemMouseEnter,k.props.onClick)}:I!=="axis"&&(Q={onMouseLeave:qx(S.handleItemMouseLeave,k.props.onMouseLeave),onMouseEnter:qx(S.handleItemMouseEnter,k.props.onMouseEnter)});var oe=y.cloneElement(k,Qe(Qe({},R.props),Q));function ie(le){return typeof M.dataKey=="function"?M.dataKey(le.payload):null}if(xe)if(B>=0){var ee,G;if(M.dataKey&&!M.allowDuplicatedCategory){var J=typeof M.dataKey=="function"?ie:"payload.".concat(M.dataKey.toString());ee=Ew(K,J,F),G=Z&&ne&&Ew(ne,J,F)}else ee=K==null?void 0:K[B],G=Z&&ne&&ne[B];if(_e||de){var ae=k.props.activeIndex!==void 0?k.props.activeIndex:B;return[y.cloneElement(k,Qe(Qe(Qe({},R.props),Q),{},{activeIndex:ae})),null,null]}if(!Zr(ee))return[oe].concat(op(S.renderActivePoints({item:R,activePoint:ee,basePoint:G,childIndex:B,isRange:Z})))}else{var fe,we=(fe=S.getItemByXY(S.state.activeCoordinate))!==null&&fe!==void 0?fe:{graphicalItem:oe},ve=we.graphicalItem,me=ve.item,Me=me===void 0?k:me,Te=ve.childIndex,Ve=Qe(Qe(Qe({},R.props),Q),{},{activeIndex:Te});return[y.cloneElement(Me,Ve),null,null]}return Z?[oe,null,null]:[oe,null]}),gr(S,"renderCustomized",function(k,C,A){return y.cloneElement(k,Qe(Qe({key:"recharts-customized-".concat(A)},S.props),S.state))}),gr(S,"renderMap",{CartesianGrid:{handler:Yx,once:!0},ReferenceArea:{handler:S.renderReferenceElement},ReferenceLine:{handler:Yx},ReferenceDot:{handler:S.renderReferenceElement},XAxis:{handler:Yx},YAxis:{handler:Yx},Brush:{handler:S.renderBrush,once:!0},Bar:{handler:S.renderGraphicChild},Line:{handler:S.renderGraphicChild},Area:{handler:S.renderGraphicChild},Radar:{handler:S.renderGraphicChild},RadialBar:{handler:S.renderGraphicChild},Scatter:{handler:S.renderGraphicChild},Pie:{handler:S.renderGraphicChild},Funnel:{handler:S.renderGraphicChild},Tooltip:{handler:S.renderCursor,once:!0},PolarGrid:{handler:S.renderPolarGrid,once:!0},PolarAngleAxis:{handler:S.renderPolarAxis},PolarRadiusAxis:{handler:S.renderPolarAxis},Customized:{handler:S.renderCustomized}}),S.clipPathId="".concat((b=w.id)!==null&&b!==void 0?b:Dp("recharts"),"-clip"),S.throttleTriggeredAfterMouseMove=VH(S.triggeredAfterMouseMove,(N=w.throttleDelay)!==null&&N!==void 0?N:1e3/60),S.state={},S}return D9e(_,x),A9e(_,[{key:"componentDidMount",value:function(){var b,N;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(N=this.props.margin.top)!==null&&N!==void 0?N:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,N=b.children,S=b.data,k=b.height,C=b.layout,A=Pi(N,ta);if(A){var R=A.props.defaultIndex;if(!(typeof R!="number"||R<0||R>this.state.tooltipTicks.length-1)){var I=this.state.tooltipTicks[R]&&this.state.tooltipTicks[R].value,O=SC(this.state,S,R,I),z=this.state.tooltipTicks[R].coordinate,M=(this.state.offset.top+k)/2,B=C==="horizontal",F=B?{x:z,y:M}:{y:z,x:M},U=this.state.formattedGraphicalItems.find(function(q){var K=q.item;return K.type.name==="Scatter"});U&&(F=Qe(Qe({},F),U.props.points[R].tooltipPosition),O=U.props.points[R].tooltipPayload);var H={activeTooltipIndex:R,isTooltipActive:!0,activeLabel:I,activePayload:O,activeCoordinate:F};this.setState(H),this.renderCursor(A),this.accessibilityManager.setIndex(R)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,N){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==N.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var S,k;this.accessibilityManager.setDetails({offset:{left:(S=this.props.margin.left)!==null&&S!==void 0?S:0,top:(k=this.props.margin.top)!==null&&k!==void 0?k:0}})}return null}},{key:"componentDidUpdate",value:function(b){nE([Pi(b.children,ta)],[Pi(this.props.children,ta)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=Pi(this.props.children,ta);if(b&&typeof b.props.shared=="boolean"){var N=b.props.shared?"axis":"item";return l.indexOf(N)>=0?N:i}return i}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var N=this.container,S=N.getBoundingClientRect(),k=S5e(S),C={chartX:Math.round(b.pageX-k.left),chartY:Math.round(b.pageY-k.top)},A=S.width/N.offsetWidth||1,R=this.inRange(C.chartX,C.chartY,A);if(!R)return null;var I=this.state,O=I.xAxisMap,z=I.yAxisMap,M=this.getTooltipEventType(),B=F$(this.state,this.props.data,this.props.layout,R);if(M!=="axis"&&O&&z){var F=gd(O).scale,U=gd(z).scale,H=F&&F.invert?F.invert(C.chartX):null,q=U&&U.invert?U.invert(C.chartY):null;return Qe(Qe({},C),{},{xValue:H,yValue:q},B)}return B?Qe(Qe({},C),B):null}},{key:"inRange",value:function(b,N){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,k=this.props.layout,C=b/S,A=N/S;if(k==="horizontal"||k==="vertical"){var R=this.state.offset,I=C>=R.left&&C<=R.left+R.width&&A>=R.top&&A<=R.top+R.height;return I?{x:C,y:A}:null}var O=this.state,z=O.angleAxisMap,M=O.radiusAxisMap;if(z&&M){var B=gd(z);return yI({x:C,y:A},B)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,N=this.getTooltipEventType(),S=Pi(b,ta),k={};S&&N==="axis"&&(S.props.trigger==="click"?k={onClick:this.handleClick}:k={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var C=Cw(this.props,this.handleOuterEvent);return Qe(Qe({},C),k)}},{key:"addListener",value:function(){WS.on(HS,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){WS.removeListener(HS,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,N,S){for(var k=this.state.formattedGraphicalItems,C=0,A=k.length;C<A;C++){var R=k[C];if(R.item===b||R.props.key===b.key||N===Sc(R.item.type)&&S===R.childIndex)return R}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,N=this.state.offset,S=N.left,k=N.top,C=N.height,A=N.width;return te.createElement("defs",null,te.createElement("clipPath",{id:b},te.createElement("rect",{x:S,y:k,height:C,width:A})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(N,S){var k=I$(S,2),C=k[0],A=k[1];return Qe(Qe({},N),{},gr({},C,A.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(N,S){var k=I$(S,2),C=k[0],A=k[1];return Qe(Qe({},N),{},gr({},C,A.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var N;return(N=this.state.xAxisMap)===null||N===void 0||(N=N[b])===null||N===void 0?void 0:N.scale}},{key:"getYScaleByAxisId",value:function(b){var N;return(N=this.state.yAxisMap)===null||N===void 0||(N=N[b])===null||N===void 0?void 0:N.scale}},{key:"getItemByXY",value:function(b){var N=this.state,S=N.formattedGraphicalItems,k=N.activeItem;if(S&&S.length)for(var C=0,A=S.length;C<A;C++){var R=S[C],I=R.props,O=R.item,z=O.type.defaultProps!==void 0?Qe(Qe({},O.type.defaultProps),O.props):O.props,M=Sc(O.type);if(M==="Bar"){var B=(I.data||[]).find(function(q){return r$e(b,q)});if(B)return{graphicalItem:R,payload:B}}else if(M==="RadialBar"){var F=(I.data||[]).find(function(q){return yI(b,q)});if(F)return{graphicalItem:R,payload:F}}else if(Aj(R,k)||Rj(R,k)||Ey(R,k)){var U=aLe({graphicalItem:R,activeTooltipItem:k,itemData:z.data}),H=z.activeIndex===void 0?U:z.activeIndex;return{graphicalItem:Qe(Qe({},R),{},{childIndex:H}),payload:Ey(R,k)?z.data[U]:R.props.data[U]}}}return null}},{key:"render",value:function(){var b=this;if(!c3(this))return null;var N=this.props,S=N.children,k=N.className,C=N.width,A=N.height,R=N.style,I=N.compact,O=N.title,z=N.desc,M=$$(N,N9e),B=qr(M,!1);if(I)return te.createElement(g$,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},te.createElement(aE,Lh({},B,{width:C,height:A,title:O,desc:z}),this.renderClipPath(),u3(S,this.renderMap)));if(this.props.accessibilityLayer){var F,U;B.tabIndex=(F=this.props.tabIndex)!==null&&F!==void 0?F:0,B.role=(U=this.props.role)!==null&&U!==void 0?U:"application",B.onKeyDown=function(q){b.accessibilityManager.keyboardEvent(q)},B.onFocus=function(){b.accessibilityManager.focus()}}var H=this.parseEventsOfWrapper();return te.createElement(g$,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},te.createElement("div",Lh({className:on("recharts-wrapper",k),style:Qe({position:"relative",cursor:"default",width:C,height:A},R)},H,{ref:function(K){b.container=K}}),te.createElement(aE,Lh({},B,{width:C,height:A,title:O,desc:z,style:B9e}),this.renderClipPath(),u3(S,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(y.Component);gr(v,"displayName",r),gr(v,"defaultProps",Qe({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},u)),gr(v,"getDerivedStateFromProps",function(x,_){var w=x.dataKey,b=x.data,N=x.children,S=x.width,k=x.height,C=x.layout,A=x.stackOffset,R=x.margin,I=_.dataStartIndex,O=_.dataEndIndex;if(_.updateId===void 0){var z=z$(x);return Qe(Qe(Qe({},z),{},{updateId:0},m(Qe(Qe({props:x},z),{},{updateId:0}),_)),{},{prevDataKey:w,prevData:b,prevWidth:S,prevHeight:k,prevLayout:C,prevStackOffset:A,prevMargin:R,prevChildren:N})}if(w!==_.prevDataKey||b!==_.prevData||S!==_.prevWidth||k!==_.prevHeight||C!==_.prevLayout||A!==_.prevStackOffset||!nm(R,_.prevMargin)){var M=z$(x),B={chartX:_.chartX,chartY:_.chartY,isTooltipActive:_.isTooltipActive},F=Qe(Qe({},F$(_,b,C)),{},{updateId:_.updateId+1}),U=Qe(Qe(Qe({},M),B),F);return Qe(Qe(Qe({},U),m(Qe({props:x},U),_)),{},{prevDataKey:w,prevData:b,prevWidth:S,prevHeight:k,prevLayout:C,prevStackOffset:A,prevMargin:R,prevChildren:N})}if(!nE(N,_.prevChildren)){var H,q,K,Z,ne=Pi(N,Km),Y=ne&&(H=(q=ne.props)===null||q===void 0?void 0:q.startIndex)!==null&&H!==void 0?H:I,X=ne&&(K=(Z=ne.props)===null||Z===void 0?void 0:Z.endIndex)!==null&&K!==void 0?K:O,se=Y!==I||X!==O,de=!Zr(b),_e=de&&!se?_.updateId:_.updateId+1;return Qe(Qe({updateId:_e},m(Qe(Qe({props:x},_),{},{updateId:_e,dataStartIndex:Y,dataEndIndex:X}),_)),{},{prevChildren:N,dataStartIndex:Y,dataEndIndex:X})}return null}),gr(v,"renderActiveDot",function(x,_,w){var b;return y.isValidElement(x)?b=y.cloneElement(x,_):$r(x)?b=x(_):b=te.createElement(Tj,_),te.createElement(Wn,{className:"recharts-active-dot",key:w},b)});var g=y.forwardRef(function(_,w){return te.createElement(v,Lh({},_,{ref:w}))});return g.displayName=v.displayName,g},U$=F5({chartName:"LineChart",GraphicalChild:rp,axisComponents:[{axisType:"xAxis",AxisComp:ai},{axisType:"yAxis",AxisComp:ii}],formatAxisMap:P5}),Hg=F5({chartName:"BarChart",GraphicalChild:Mi,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:ai},{axisType:"yAxis",AxisComp:ii}],formatAxisMap:P5}),q$=F5({chartName:"AreaChart",GraphicalChild:Bc,axisComponents:[{axisType:"xAxis",AxisComp:ai},{axisType:"yAxis",AxisComp:ii}],formatAxisMap:P5});function nK({data:e,className:t=""}){if(!e||e.length===0)return s.jsxs(Ze,{className:t,children:[s.jsx(kr,{children:s.jsxs(Lr,{className:"flex items-center gap-2",children:[s.jsx(qn,{className:"h-5 w-5"}),"Promotion Performance"]})}),s.jsx(tt,{children:s.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500",children:"No performance data available"})})]});const r=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"});return s.jsxs(Ze,{className:t,children:[s.jsx(kr,{children:s.jsxs(Lr,{className:"flex items-center gap-2",children:[s.jsx(qn,{className:"h-5 w-5"}),"Promotion Performance Over Time"]})}),s.jsx(tt,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),s.jsx("span",{children:"Impressions"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded"}),s.jsx("span",{children:"Clicks"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),s.jsx("span",{children:"Conversions"})]})]}),s.jsx("div",{className:"h-64 w-full",children:s.jsx(oc,{width:"100%",height:"100%",children:s.jsxs(Hg,{data:e,margin:{top:20,right:30,left:20,bottom:5},children:[s.jsx(fl,{strokeDasharray:"3 3"}),s.jsx(ai,{dataKey:"date",tickFormatter:r,angle:-45,textAnchor:"end",height:60}),s.jsx(ii,{}),s.jsx(ta,{formatter:(n,a)=>[n.toLocaleString(),a],labelFormatter:n=>`Date: ${r(n)}`}),s.jsx(tf,{}),s.jsx(Mi,{dataKey:"impressions",fill:"#3b82f6",name:"Impressions"}),s.jsx(Mi,{dataKey:"clicks",fill:"#8b5cf6",name:"Clicks"}),s.jsx(Mi,{dataKey:"conversions",fill:"#10b981",name:"Conversions"})]})})}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-4 border-t",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600 mb-1",children:[s.jsx(Jd,{className:"h-4 w-4"}),s.jsx("span",{children:"Total Impressions"})]}),s.jsx("p",{className:"text-lg font-semibold",children:e.reduce((n,a)=>n+a.impressions,0).toLocaleString()})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600 mb-1",children:[s.jsx(IP,{className:"h-4 w-4"}),s.jsx("span",{children:"Total Clicks"})]}),s.jsx("p",{className:"text-lg font-semibold",children:e.reduce((n,a)=>n+a.clicks,0).toLocaleString()})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600 mb-1",children:[s.jsx(Ji,{className:"h-4 w-4"}),s.jsx("span",{children:"Total Conversions"})]}),s.jsx("p",{className:"text-lg font-semibold",children:e.reduce((n,a)=>n+a.conversions,0).toLocaleString()})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600 mb-1",children:s.jsx("span",{children:"Total Spend"})}),s.jsxs("p",{className:"text-lg font-semibold",children:["$",e.reduce((n,a)=>n+a.spend,0).toLocaleString()]})]})]})]})})]})}function X9e(){go("view","analytics_creator",{dashboard_type:"creator"});const{user:e}=ws(),[t,r]=y.useState(!0),[n,a]=y.useState(null),[i,o]=y.useState([]),[l,c]=y.useState([]),[d,f]=y.useState([]),[u,h]=y.useState([]),[m,v]=y.useState("overview"),g=Y=>{try{Rr(()=>E(this,null,function*(){const{trackInteraction:X}=yield Promise.resolve().then(()=>Zy);return{trackInteraction:X}}),void 0,import.meta.url).then(({trackInteraction:X})=>{X.click("view",`analytics_tab_${Y}`,{tab:Y,dashboard_type:"creator"})})}catch(X){console.error("Error tracking tab switch:",X)}v(Y)},[x,_]=y.useState(!1),w=()=>E(this,null,function*(){if(e){_(!0);try{console.log(" CreatorAnalyticsDashboard: Loading promotion data...");const[Y,X,se]=yield Promise.all([Zi.getUserPromotions(e.id),Zi.getPromotionPerformanceComparison(e.id),Zi.getPromotionTrends(e.id,30)]);console.log(" CreatorAnalyticsDashboard: Promotion data loaded:",{promotions:Y.length,comparisons:X.length,trends:se.length}),z(Y),B(X),U(se)}catch(Y){console.error("Error loading promotion data:",Y)}finally{_(!1)}}}),[b,N]=y.useState(null),[S,k]=y.useState(null),[C,A]=y.useState([]),[R,I]=y.useState(null),[O,z]=y.useState([]),[M,B]=y.useState([]),[F,U]=y.useState([]),{isLive:H,lastUpdate:q}=CW({userId:(e==null?void 0:e.id)||"",enabled:!!e});y.useEffect(()=>{e&&K()},[e]),y.useEffect(()=>{m==="promotions"&&e&&w()},[m,e]);const K=()=>E(this,null,function*(){if(e)try{r(!0);const Y=e.id;console.log(" CreatorAnalyticsDashboard: Fetching data for creatorId:",Y);const[X,se,de,_e,xe]=yield Promise.all([oh.getCreatorStats(Y),oh.getFanInsights(Y),oh.getGeographicInsights(Y),oh.getContentPerformance(Y),oh.getCreatorAchievements(Y)]);a(X),o(se),c(de),f(_e),h(xe),yield Z(Y)}catch(Y){console.error("Error fetching creator data:",Y)}finally{r(!1)}}),Z=Y=>E(this,null,function*(){try{const X={start:new Date(Date.now()-2592e6),end:new Date},se=yield AA.analyzeFunnel("creator",X);N(se);const de=yield Dh.getUserRevenueMetrics(Y,X);k(de);const _e=d.map(ee=>({date:ee.date,value:ee.follower_gains,label:"New Followers"}));A(_e);const xe={score:(n==null?void 0:n.engagement_rate)||0,sessionDuration:0,interactionCount:(n==null?void 0:n.total_event_views)||0,pageViews:(n==null?void 0:n.total_event_views)||0,likes:(n==null?void 0:n.total_reviews)||0,shares:0,comments:0,bounceRate:0};I(xe);const[Q,oe,ie]=yield Promise.all([Zi.getUserPromotions(Y),Zi.getPromotionPerformanceComparison(Y),Zi.getPromotionTrends(Y,30)]);z(Q),B(oe),U(ie)}catch(X){console.error("Error loading enhanced analytics:",X)}}),ne=()=>E(this,null,function*(){if(e)try{const Y=yield oh.exportCreatorData(e.id),X=new Blob([JSON.stringify(Y,null,2)],{type:"application/json"}),se=URL.createObjectURL(X),de=document.createElement("a");de.href=se,de.download=`creator-analytics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(de),de.click(),document.body.removeChild(de),URL.revokeObjectURL(se)}catch(Y){console.error("Error exporting data:",Y)}});return t?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsx(ro,{})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((Y,X)=>s.jsx(ro,{},X))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(ro,{}),s.jsx(ro,{})]})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(uf,{className:"w-8 h-8 text-purple-600"}),s.jsx("h1",{className:"gradient-text text-3xl font-bold",children:"Creator Analytics"})]}),s.jsx("p",{className:"text-gray-600",children:"Track your fan engagement, content performance, and growth metrics"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:ne,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[s.jsx(pp,{className:"w-4 h-4"}),"Export Data"]}),s.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all",children:"Upgrade to Pro"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(di,{title:"Total Followers",value:(n==null?void 0:n.total_followers)||0,icon:s.jsx(Vr,{className:"w-6 h-6"}),trend:(n==null?void 0:n.fan_growth_rate)>0?"up":(n==null?void 0:n.fan_growth_rate)<0?"down":"neutral",subtitle:"growth this month"}),s.jsx(di,{title:"Engagement Rate",value:`${(n==null?void 0:n.engagement_rate)||0}%`,icon:s.jsx(qn,{className:"w-6 h-6"}),trend:"neutral",subtitle:"interactions per follower"}),s.jsx(di,{title:"Event Views",value:(n==null?void 0:n.total_event_views)||0,icon:s.jsx(Jd,{className:"w-6 h-6"}),trend:"neutral",subtitle:"total views"}),s.jsx(di,{title:"Fan Reviews",value:(n==null?void 0:n.total_reviews)||0,icon:s.jsx(Xt,{className:"w-6 h-6"}),trend:"neutral",subtitle:"reviews received"})]}),s.jsx("div",{className:"mb-8",children:s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:qd},{id:"fans",label:"Fan Insights",icon:Vr},{id:"content",label:"Content Performance",icon:Lt},{id:"promotions",label:"Promotions",icon:qn},{id:"achievements",label:"Achievements",icon:Vd}].map(Y=>s.jsxs("button",{onClick:()=>g(Y.id),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${m===Y.id?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(Y.icon,{className:"w-4 h-4"}),Y.label]},Y.id))})})}),m==="overview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[R&&s.jsx(kW,{metrics:R,title:"Creator Engagement Score",showBreakdown:!0}),C.length>0&&s.jsx(EW,{data:C,title:"Follower Growth",valueLabel:"New Followers",showTrend:!0})]}),b&&b.stages.length>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(qn,{className:"w-5 h-5 text-synth-pink"}),"Fan Conversion Funnel"]}),s.jsx(NW,{stages:b.stages,title:"Fan Journey Analysis",showOptimizationTips:!0})]}),S&&S.total_revenue>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Xt,{className:"w-5 h-5 text-synth-pink"}),"Revenue Attribution"]}),s.jsx(SW,{sources:S.top_revenue_sources.map(Y=>({source:Y.source,revenue:Y.revenue,percentage:Y.percentage,confidence_score:.8,attribution_window:24})),totalRevenue:S.total_revenue,title:"Revenue Sources",showConfidenceScores:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(yr,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Venues"})]}),i.length>0?s.jsx("div",{className:"space-y-3",children:i.slice(0,5).map((Y,X)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center text-sm font-semibold text-purple-600",children:X+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:Y.venue_name}),s.jsxs("p",{className:"text-sm text-gray-500",children:[Y.event_count," events"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:Y.total_views}),s.jsx("p",{className:"text-sm text-gray-500",children:"views"})]})]},Y.venue_name))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(yr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No venue data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Xi,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Geographic Reach"})]}),l.length>0?s.jsx("div",{className:"space-y-3",children:l.slice(0,5).map((Y,X)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm font-semibold text-blue-600",children:X+1}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900",children:[Y.city,", ",Y.state]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[Y.event_count," events"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:Y.fan_count}),s.jsx("p",{className:"text-sm text-gray-500",children:"fans"})]})]},`${Y.city}-${Y.state}`))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Xi,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]})]})]}),m==="fans"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Venue Performance"}),i.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Venue"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Events"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Views"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Engagement"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Fan Density"})]})}),s.jsx("tbody",{children:i.map(Y=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:Y.venue_name}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.event_count}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.total_views}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.engagement_score}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.fan_density})]},Y.venue_name))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Vr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No fan insights available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Geographic Distribution"}),l.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Location"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Fans"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Events"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Engagement"})]})}),s.jsx("tbody",{children:l.map(Y=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsxs("td",{className:"py-3 px-4 font-medium text-gray-900",children:[Y.city,", ",Y.state]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.fan_count}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.event_count}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[Y.engagement_rate,"%"]})]},`${Y.city}-${Y.state}`))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Xi,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]})]}),m==="content"&&s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Content Performance"}),d.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Date"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Event Views"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Profile Visits"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Follower Gains"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Engagement"})]})}),s.jsx("tbody",{children:d.map(Y=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:new Date(Y.date).toLocaleDateString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.event_views}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.profile_visits}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.follower_gains}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[Y.engagement_rate,"%"]})]},Y.date))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Lt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No content performance data available"})]})]}),m==="achievements"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[s.jsx(Vd,{className:"w-8 h-8 text-yellow-500"}),s.jsx("h2",{className:"gradient-text text-2xl font-bold",children:"Creator Achievements"})]}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Track your milestones as a creator and artist"})]}),["follower","engagement","venue","revenue"].map(Y=>{const X=u.filter(de=>de.category===Y),se={follower:"Follower Milestones",engagement:"Engagement Goals",venue:"Venue Performance",revenue:"Revenue Targets"};return s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Mc,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:se[Y]})]}),X.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:X.map(de=>s.jsx(TA,{name:de.name,description:de.description,icon:de.icon,progress:de.progress,goal:de.goal,unlocked:de.unlocked,unlockedAt:de.unlockedAt,compact:!0},de.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Mc,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No achievements in this category yet"})]})]},Y)})]}),m==="promotions"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Promotion Analytics"}),H&&s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live"]})]}),s.jsx("p",{className:"text-gray-600",children:"Track your event promotion performance and ROI"}),q&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Last updated: ",q.toLocaleTimeString()]})]})}),O.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(qn,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Promotions Yet"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Start promoting your events to see detailed analytics here"}),s.jsx("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Promote Your First Event"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:O.slice(0,3).map(Y=>s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold text-lg truncate",children:Y.event.title}),s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${Y.promotion_tier==="featured"?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800":Y.promotion_tier==="premium"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:Y.promotion_tier})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Impressions"}),s.jsx("p",{className:"text-xl font-bold",children:Y.impressions.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Clicks"}),s.jsx("p",{className:"text-xl font-bold",children:Y.clicks.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Conversions"}),s.jsx("p",{className:"text-xl font-bold text-green-600",children:Y.conversions.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"CTR"}),s.jsxs("p",{className:"text-xl font-bold",children:[(Y.clicks/Y.impressions*100).toFixed(1),"%"]})]})]})]},Y.id))}),s.jsx(nK,{data:F.map(Y=>({date:Y.date,impressions:Y.impressions||0,clicks:Y.clicks||0,conversions:Y.conversions||0,spend:Y.spend||0})),className:"bg-white rounded-xl shadow-sm border"}),M.length>0&&s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Promotion Comparison"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b",children:[s.jsx("th",{className:"text-left py-2",children:"Event"}),s.jsx("th",{className:"text-left py-2",children:"Tier"}),s.jsx("th",{className:"text-left py-2",children:"Impressions"}),s.jsx("th",{className:"text-left py-2",children:"Clicks"}),s.jsx("th",{className:"text-left py-2",children:"Conversions"}),s.jsx("th",{className:"text-left py-2",children:"CTR"}),s.jsx("th",{className:"text-left py-2",children:"ROI"})]})}),s.jsx("tbody",{children:M.slice(0,5).map(Y=>s.jsxs("tr",{className:"border-b",children:[s.jsx("td",{className:"py-2 font-medium truncate max-w-32",children:Y.event_title}),s.jsx("td",{className:"py-2",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs ${Y.tier==="featured"?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800":Y.tier==="premium"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:Y.tier})}),s.jsx("td",{className:"py-2",children:Y.impressions.toLocaleString()}),s.jsx("td",{className:"py-2",children:Y.clicks.toLocaleString()}),s.jsx("td",{className:"py-2",children:Y.conversions.toLocaleString()}),s.jsxs("td",{className:"py-2",children:[Y.ctr.toFixed(1),"%"]}),s.jsx("td",{className:"py-2",children:s.jsxs("span",{className:`font-semibold ${Y.roi>=0?"text-green-600":"text-red-600"}`,children:[Y.roi>=0?"+":"",Y.roi.toFixed(1),"%"]})})]},Y.promotion_id))})]})})]})]})]})]})})}class gu{static getBusinessStats(t){return E(this,null,function*(){try{console.log(" BusinessAnalyticsService: Getting business stats for user:",t);const{data:r,error:n}=yield T.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published");if(n)throw console.error("Error fetching business events:",n),n;if(console.log(" BusinessAnalyticsService: Found events:",(r==null?void 0:r.length)||0),!r||r.length===0)return console.log(" BusinessAnalyticsService: No events found, returning default stats"),{total_events:0,total_attendees:0,total_revenue:0,conversion_rate:0,customer_satisfaction:0,repeat_customer_rate:0,avg_event_attendance:0,revenue_growth_rate:0};const a=r.map(N=>N.id),i=yield vs.getAllUserInteractions(a,void 0,["event"]),o=yield vs.getAllUserReviews(a),l=yield vs.getAllInterestedUsers(a),c=r.length,d=(i==null?void 0:i.filter(N=>N.event_type==="view").length)||0,f=(i==null?void 0:i.filter(N=>N.event_type==="click_ticket").length)||0,u=(o==null?void 0:o.length)||0,h=(l==null?void 0:l.length)||0,m=d>0?f/d*100:0,v=(o==null?void 0:o.length)>0?o.reduce((N,S)=>N+(S.rating||0),0)/o.length:0,g=new Set((l==null?void 0:l.map(N=>N.user_id))||[]),x=Array.from(g).filter(N=>(l==null?void 0:l.filter(S=>S.user_id===N).length)>1).length,_=g.size>0?x/g.size*100:0,w=c>0?h/c:0;return{total_events:c,total_attendees:h,total_revenue:0,conversion_rate:Math.round(m*100)/100,customer_satisfaction:Math.round(v*100)/100,repeat_customer_rate:Math.round(_*100)/100,avg_event_attendance:Math.round(w*100)/100,revenue_growth_rate:0}}catch(r){return console.error("Error getting business stats:",r),{total_events:0,total_attendees:0,total_revenue:0,conversion_rate:0,customer_satisfaction:0,repeat_customer_rate:0,avg_event_attendance:0,revenue_growth_rate:0}}})}static getEventPerformance(t){return E(this,null,function*(){try{console.log(" BusinessAnalyticsService: Getting event performance for user:",t);const{data:r,error:n}=yield T.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published");if(n)throw console.error("Error fetching business events for performance:",n),n;if(console.log(" BusinessAnalyticsService: Found events for performance:",(r==null?void 0:r.length)||0),!r||r.length===0)return console.log(" BusinessAnalyticsService: No events found for performance, returning empty array"),[];const a=r.map(d=>d.id),i=yield vs.getAllUserInteractions(a,void 0,["event"]),o=yield vs.getAllUserReviews(a),l=yield vs.getAllInterestedUsers(a);return r.map(d=>{const f=(i==null?void 0:i.filter(w=>w.entity_id===d.id))||[],u=(o==null?void 0:o.filter(w=>w.event_id===d.id))||[],h=(l==null?void 0:l.filter(w=>w.event_id===d.id))||[],m=f.filter(w=>w.event_type==="view").length,v=f.filter(w=>w.event_type==="click_ticket").length,g=u.length>0?u.reduce((w,b)=>w+(b.rating||0),0)/u.length:0,x=0,_=m>0?h.length/m*100:0;return{event_id:d.id,title:d.title,artist_name:d.artist_name,event_date:d.event_date,venue_name:d.venue_name,total_views:m,total_interested:h.length,ticket_clicks:v,reviews_count:u.length,avg_rating:Math.round(g*100)/100,revenue_generated:x,attendance_rate:Math.round(_*100)/100}}).sort((d,f)=>f.revenue_generated-d.revenue_generated)}catch(r){return console.error("Error getting event performance:",r),[]}})}static getCustomerInsights(t){return E(this,null,function*(){try{console.log(" BusinessAnalyticsService: Getting customer insights for user:",t);const{data:r,error:n}=yield T.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published");if(n)throw console.error("Error fetching business events for customer insights:",n),n;if(console.log(" BusinessAnalyticsService: Found events for customer insights:",(r==null?void 0:r.length)||0),!r||r.length===0)return console.log(" BusinessAnalyticsService: No events found for customer insights, returning empty array"),[];const a=r.map(u=>u.id),{data:i}=yield T.from("user_event_relationships").select("*").in("relationship_type",["interested","going","maybe"]).in("event_id",a),{data:o}=yield T.from("reviews").select("*").in("event_id",a),l=new Map,c=new Map;return i==null||i.forEach(u=>{const h=l.get(u.user_id)||0;l.set(u.user_id,h+1)}),o==null||o.forEach(u=>{c.has(u.user_id)||c.set(u.user_id,[]),c.get(u.user_id).push(u.rating||0)}),Object.entries({"New Customers":{min:1,max:1},"Regular Customers":{min:2,max:4},"VIP Customers":{min:5,max:1/0}}).map(([u,h])=>{const m=Array.from(l.entries()).filter(([k,C])=>C>=h.min&&C<=h.max),v=l.size,g=m.length,x=v>0?g/v*100:0,_=g>0?m.reduce((k,[C,A])=>k+A,0)/g:0,w=_*50,b=m.map(([k,C])=>c.get(k)||[]),N=b.length>0?b.reduce((k,C)=>k+C.reduce((A,R)=>A+R,0)/C.length,0)/b.length:0,S=_*20+N*10;return{customer_segment:u,count:g,percentage:Math.round(x*100)/100,avg_events_attended:Math.round(_*100)/100,avg_spending:Math.round(w*100)/100,loyalty_score:Math.round(S*100)/100}})}catch(r){return console.error("Error getting customer insights:",r),[]}})}static getRevenueInsights(t,r=30){return E(this,null,function*(){try{const n=new Date;n.setDate(n.getDate()-r);const{data:a,error:i}=yield T.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published").gte("event_date",n.toISOString());if(i)throw console.error("Error fetching business events for revenue insights:",i),i;if(console.log(" BusinessAnalyticsService: Found events for revenue insights:",(a==null?void 0:a.length)||0),!a||a.length===0)return[];const o=a.map(f=>f.id),{data:l}=yield T.from("interactions").select("*").in("entity_id",o).eq("entity_type","event").gte("created_at",n.toISOString()),c=new Map;return l==null||l.forEach(f=>{const u=new Date(f.created_at).toISOString().split("T")[0];c.has(u)||c.set(u,{revenue:0,ticketClicks:0,views:0});const h=c.get(u);f.event_type==="view"?h.views++:f.event_type==="click_ticket"&&(h.ticketClicks++,h.revenue+=0)}),Array.from(c.entries()).map(([f,u])=>{const h=u.views>0?u.ticketClicks/u.views*100:0,m=u.ticketClicks>0?u.revenue/u.ticketClicks:0;return{date:f,revenue:u.revenue,ticket_clicks:u.ticketClicks,conversion_rate:Math.round(h*100)/100,avg_ticket_price:Math.round(m*100)/100}}).sort((f,u)=>new Date(f.date).getTime()-new Date(u.date).getTime())}catch(n){return console.error("Error getting revenue insights:",n),[]}})}static getArtistPerformance(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published");if(n)throw console.error("Error fetching business events for artist performance:",n),n;if(console.log(" BusinessAnalyticsService: Found events for artist performance:",(r==null?void 0:r.length)||0),!r||r.length===0)return[];const a=r.map(m=>m.id),[i,o,l]=yield Promise.all([T.from("interactions").select("*").in("entity_id",a).eq("entity_type","event"),T.from("reviews").select("*").in("event_id",a),T.from("user_event_relationships").select("*").in("relationship_type",["interested","going","maybe"]).in("event_id",a)]),c=i.data||[],d=o.data||[],f=l.data||[],u=new Map;return r.forEach(m=>{const v=m.artist_name;u.has(v)||u.set(v,{events:[],interactions:[],reviews:[],interested:[]}),u.get(v).events.push(m)}),c.forEach(m=>{var g;const v=r.find(x=>x.id===m.entity_id);v&&((g=u.get(v.artist_name))==null||g.interactions.push(m))}),d.forEach(m=>{var g;const v=r.find(x=>x.id===m.event_id);v&&((g=u.get(v.artist_name))==null||g.reviews.push(m))}),f.forEach(m=>{var g;const v=r.find(x=>x.id===m.event_id);v&&((g=u.get(v.artist_name))==null||g.interested.push(m))}),Array.from(u.entries()).map(([m,v])=>{const g=v.events.length,x=v.interactions.filter(C=>C.event_type==="view").length,_=v.interactions.filter(C=>C.event_type==="click_ticket").length*50,w=v.reviews.length>0?v.reviews.reduce((C,A)=>C+(A.rating||0),0)/v.reviews.length:0,b=w*20,N=new Set(v.interested.map(C=>C.user_id)),S=Array.from(N).filter(C=>v.interested.filter(A=>A.user_id===C).length>1).length,k=N.size>0?S/N.size*100:0;return{artist_name:m,events_count:g,total_views:x,avg_rating:Math.round(w*100)/100,total_revenue:_,customer_satisfaction:Math.round(b*100)/100,repeat_rate:Math.round(k*100)/100}}).sort((m,v)=>v.total_revenue-m.total_revenue)}catch(r){return console.error("Error getting artist performance:",r),[]}})}static getBusinessAchievements(t){return E(this,null,function*(){try{const r=yield this.getBusinessStats(t),n=yield this.getEventPerformance(t),a=yield this.getCustomerInsights(t);return[{id:"first_event",name:"First Event",description:"Host your first event",icon:"",progress:Math.min(r.total_events,1),goal:1,unlocked:r.total_events>=1,category:"events"},{id:"busy_venue",name:"Busy Venue",description:"Host 10 events",icon:"",progress:Math.min(r.total_events,10),goal:10,unlocked:r.total_events>=10,category:"events"},{id:"event_venue",name:"Event Venue",description:"Host 50 events",icon:"",progress:Math.min(r.total_events,50),goal:50,unlocked:r.total_events>=50,category:"events"},{id:"first_revenue",name:"First Revenue",description:"Generate $1,000 in ticket revenue",icon:"",progress:Math.min(r.total_revenue,1e3),goal:1e3,unlocked:r.total_revenue>=1e3,category:"revenue"},{id:"revenue_generator",name:"Revenue Generator",description:"Generate $10,000 in ticket revenue",icon:"",progress:Math.min(r.total_revenue,1e4),goal:1e4,unlocked:r.total_revenue>=1e4,category:"revenue"},{id:"high_conversion",name:"High Conversion",description:"Achieve 10% conversion rate",icon:"",progress:Math.min(r.conversion_rate,10),goal:10,unlocked:r.conversion_rate>=10,category:"growth"},{id:"customer_satisfaction",name:"Customer Satisfaction",description:"Achieve 4.5+ average rating",icon:"",progress:Math.min(r.customer_satisfaction,4.5),goal:4.5,unlocked:r.customer_satisfaction>=4.5,category:"customers"},{id:"loyal_customers",name:"Loyal Customers",description:"Achieve 30% repeat customer rate",icon:"",progress:Math.min(r.repeat_customer_rate,30),goal:30,unlocked:r.repeat_customer_rate>=30,category:"customers"},{id:"popular_venue",name:"Popular Venue",description:"Attract 1,000 total attendees",icon:"",progress:Math.min(r.total_attendees,1e3),goal:1e3,unlocked:r.total_attendees>=1e3,category:"growth"},{id:"successful_business",name:"Successful Business",description:"Generate $50,000 in total revenue",icon:"",progress:Math.min(r.total_revenue,5e4),goal:5e4,unlocked:r.total_revenue>=5e4,category:"revenue"}]}catch(r){return console.error("Error getting business achievements:",r),[]}})}static exportBusinessData(t){return E(this,null,function*(){const[r,n,a,i,o,l]=yield Promise.all([this.getBusinessStats(t),this.getEventPerformance(t),this.getCustomerInsights(t),this.getRevenueInsights(t),this.getArtistPerformance(t),this.getBusinessAchievements(t)]);return{stats:r,eventPerformance:n,customerInsights:a,revenueInsights:i,artistPerformance:o,achievements:l}})}}class YS{static getVIPCustomers(t,r=50){return E(this,null,function*(){try{console.log(" VIPAnalyticsService: Getting VIP customers for user:",t);const{data:n,error:a}=yield T.from("events").select("id").eq("created_by_user_id",t);if(a)throw console.error("Error fetching user events for VIP analysis:",a),a;if(!n||n.length===0)return console.log(" VIPAnalyticsService: No events found, returning empty VIP list"),[];const i=n.map(_=>_.id),{data:o,error:l}=yield T.from("interactions").select("user_id, event_type, entity_type, occurred_at").in("entity_id",i).eq("entity_type","event");if(l)throw console.error("Error fetching interactions for VIP analysis:",l),l;const{data:c,error:d}=yield T.from("user_event_relationships").select("user_id, event_id").in("relationship_type",["interested","going","maybe"]).in("event_id",i);if(d)throw console.error("Error fetching interested users for VIP analysis:",d),d;const{data:f,error:u}=yield T.from("reviews").select("user_id, event_id, review_text, rating, created_at").in("event_id",i).eq("is_draft",!1);if(u)throw console.error("Error fetching reviews for VIP analysis:",u),u;const h=[...new Set([...(o==null?void 0:o.map(_=>_.user_id))||[],...(c==null?void 0:c.map(_=>_.user_id))||[],...(f==null?void 0:f.map(_=>_.user_id))||[]])];if(h.length===0)return console.log(" VIPAnalyticsService: No users found, returning empty VIP list"),[];const v=(yield vs.getAllProfiles()).filter(_=>h.includes(_.user_id)),g=[];for(const _ of v||[]){const w=(o==null?void 0:o.filter(O=>O.user_id===_.user_id))||[],b=(c==null?void 0:c.filter(O=>O.user_id===_.user_id))||[],N=(f==null?void 0:f.filter(O=>O.user_id===_.user_id))||[],S=0,k=b.length,C=N.length,A=w.length;let R=0;R+=Math.min(S*5,30),R+=Math.min(k*2,20),R+=Math.min(C*4,20),R+=Math.min(A*.5,15);const I=_.subscription_tier==="premium"?15:_.subscription_tier==="professional"?12:_.subscription_tier==="enterprise"?15:0;if(R+=I,R>=20){const O=Math.floor((Date.now()-new Date(_.created_at).getTime())/864e5),z=w.length>0?w.sort((B,F)=>new Date(F.occurred_at).getTime()-new Date(B.occurred_at).getTime())[0].occurred_at:_.created_at;let M;R>=80?M="platinum":R>=60?M="gold":R>=40?M="silver":M="bronze",g.push({user_id:_.user_id,email:"",display_name:_.name||"Anonymous User",vip_score:Math.round(R),vip_tier:M,total_events_attended:S,total_events_interested:k,total_reviews_written:C,total_spending:0,subscription_tier:_.subscription_tier||"free",account_age_days:O,last_activity:z,engagement_score:Math.round(A/Math.max(O,1)*100)/100})}}const x=g.sort((_,w)=>w.vip_score-_.vip_score);return console.log(" VIPAnalyticsService: Found VIP customers:",x.length),x.slice(0,r)}catch(n){throw console.error("Error getting VIP customers:",n),n}})}static getVIPMetrics(t){return E(this,null,function*(){try{console.log(" VIPAnalyticsService: Getting VIP metrics for user:",t);const r=yield this.getVIPCustomers(t,1e3);if(r.length===0)return{total_vip_customers:0,vip_by_tier:{bronze:0,silver:0,gold:0,platinum:0},vip_growth_rate:0,avg_vip_score:0,vip_retention_rate:0,vip_revenue_contribution:0};const n=r.reduce((d,f)=>(d[f.vip_tier]++,d),{bronze:0,silver:0,gold:0,platinum:0}),a=r.reduce((d,f)=>d+f.vip_score,0)/r.length,i=new Date(Date.now()-30*24*60*60*1e3),l=r.filter(d=>new Date(d.last_activity)>i).length/r.length*100,c=r.reduce((d,f)=>d+f.total_spending,0);return console.log(" VIPAnalyticsService: VIP metrics calculated:",{total:r.length,tiers:n,avgScore:Math.round(a),retention:Math.round(l)}),{total_vip_customers:r.length,vip_by_tier:n,vip_growth_rate:0,avg_vip_score:Math.round(a*100)/100,vip_retention_rate:Math.round(l*100)/100,vip_revenue_contribution:c}}catch(r){throw console.error("Error getting VIP metrics:",r),r}})}static getVIPTrends(t,r=30){return E(this,null,function*(){try{console.log(" VIPAnalyticsService: Getting VIP trends for user:",t);const n=[],a=new Date;for(let i=r-1;i>=0;i--){const o=new Date(a);o.setDate(o.getDate()-i),n.push({date:o.toISOString().split("T")[0],total_vips:Math.floor(Math.random()*10)+5,new_vips:Math.floor(Math.random()*3),vip_revenue:Math.floor(Math.random()*1e3)+500})}return console.log(" VIPAnalyticsService: VIP trends generated:",n.length,"days"),n}catch(n){throw console.error("Error getting VIP trends:",n),n}})}}function J9e(e){return E(this,null,function*(){try{console.log(" Syncing all promotion metrics for user:",e);const{data:t,error:r}=yield T.from("event_promotions").select("id, event_id").eq("promoted_by_user_id",e);if(r){console.error("Error fetching user promotions:",r);return}if(!t||t.length===0){console.log("No promotions found for user");return}console.log(`Found ${t.length} promotions to sync`);for(const n of t)try{yield Sl.syncPromotionMetrics(n.id),console.log(` Synced promotion ${n.id}`)}catch(a){console.error(` Error syncing promotion ${n.id}:`,a)}console.log(" All promotion metrics synced successfully!")}catch(t){console.error("Error syncing user promotions:",t)}})}function Q9e(){go("view","analytics_business",{dashboard_type:"business"});const{user:e}=ws(),[t,r]=y.useState(!0),[n,a]=y.useState(null),[i,o]=y.useState([]),[l,c]=y.useState([]),[d,f]=y.useState([]),[u,h]=y.useState([]),[m,v]=y.useState([]),[g,x]=y.useState("overview"),_=J=>{try{Rr(()=>E(this,null,function*(){const{trackInteraction:ae}=yield Promise.resolve().then(()=>Zy);return{trackInteraction:ae}}),void 0,import.meta.url).then(({trackInteraction:ae})=>{ae.click("view",`analytics_tab_${J}`,{tab:J,dashboard_type:"business"})})}catch(ae){console.error("Error tracking tab switch:",ae)}x(J)},[w,b]=y.useState(!1),N=()=>E(this,null,function*(){if(e){b(!0);try{console.log(" BusinessAnalyticsDashboard: Loading promotion data...");const[J,ae,fe]=yield Promise.allSettled([Zi.getUserPromotions(e.id),Zi.getPromotionPerformanceComparison(e.id),Zi.getPromotionTrends(e.id,30)]).then(we=>we.map(ve=>ve.status==="fulfilled"?ve.value:[]));console.log(" BusinessAnalyticsDashboard: Promotion data loaded:",{promotions:J.length,comparisons:ae.length,trends:fe.length}),F(J),H(ae),K(fe)}catch(J){console.error("Error loading promotion data:",J)}finally{b(!1)}}}),S=()=>E(this,null,function*(){if(e){xe(!0);try{console.log(" BusinessAnalyticsDashboard: Loading VIP data...");const[J,ae,fe]=yield Promise.allSettled([YS.getVIPCustomers(e.id,20),YS.getVIPMetrics(e.id),YS.getVIPTrends(e.id,30)]).then(we=>we.map(ve=>ve.status==="fulfilled"?ve.value:[]));console.log(" BusinessAnalyticsDashboard: VIP data loaded:",{customers:Array.isArray(J)?J.length:0,metrics:ae,trends:Array.isArray(fe)?fe.length:0}),ne(Array.isArray(J)?J:[]),X(ae&&typeof ae=="object"&&!Array.isArray(ae)?ae:null),de(Array.isArray(fe)?fe:[])}catch(J){console.error("Error loading VIP data:",J)}finally{xe(!1)}}}),[k,C]=y.useState(null),[A,R]=y.useState(null),[I,O]=y.useState([]),[z,M]=y.useState(null),[B,F]=y.useState([]),[U,H]=y.useState([]),[q,K]=y.useState([]),[Z,ne]=y.useState([]),[Y,X]=y.useState(null),[se,de]=y.useState([]),[_e,xe]=y.useState(!1),{isLive:Q,lastUpdate:oe}=CW({userId:(e==null?void 0:e.id)||"",enabled:!!e});y.useEffect(()=>{e&&ie()},[e]),y.useEffect(()=>{g==="promotions"&&e&&N()},[g,e]),y.useEffect(()=>{g==="customers"&&e&&S()},[g,e]);const ie=()=>E(this,null,function*(){if(e)try{r(!0),console.log(" BusinessAnalyticsDashboard: Fetching business data for user:",e.id),console.log(" BusinessAnalyticsDashboard: Loading analytics for user:",e.id);const[J,ae,fe,we,ve,me]=yield Promise.all([gu.getBusinessStats(e.id),gu.getEventPerformance(e.id),gu.getCustomerInsights(e.id),gu.getRevenueInsights(e.id),gu.getArtistPerformance(e.id),gu.getBusinessAchievements(e.id)]);a(J),o(ae),c(fe),f(we),h(ve),v(me),yield ee()}catch(J){console.error("Error fetching business data:",J)}finally{r(!1)}}),ee=()=>E(this,null,function*(){try{const J={start:new Date(Date.now()-2592e6),end:new Date},ae=yield AA.analyzeFunnel("business",J);C(ae);const fe=yield Dh.getUserRevenueMetrics((e==null?void 0:e.id)||"",J);R(fe);const we=d.map(me=>({date:me.date,value:me.revenue,label:"Daily Revenue"}));O(we);const ve={score:(n==null?void 0:n.conversion_rate)||0,sessionDuration:0,interactionCount:(n==null?void 0:n.total_events)||0,pageViews:(n==null?void 0:n.total_events)||0,likes:(n==null?void 0:n.customer_satisfaction)||0,shares:0,comments:0,bounceRate:0};if(M(ve),e){const[me,Me,Te]=yield Promise.all([Zi.getUserPromotions(e.id),Zi.getPromotionPerformanceComparison(e.id),Zi.getPromotionTrends(e.id,30)]);F(me),H(Me),K(Te)}}catch(J){console.error("Error loading enhanced analytics:",J)}}),G=()=>E(this,null,function*(){if(e)try{const ae=yield gu.exportBusinessData("Sample Venue"),fe=new Blob([JSON.stringify(ae,null,2)],{type:"application/json"}),we=URL.createObjectURL(fe),ve=document.createElement("a");ve.href=we,ve.download=`business-analytics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(ve),ve.click(),document.body.removeChild(ve),URL.revokeObjectURL(we)}catch(J){console.error("Error exporting data:",J)}});return t?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsx(ro,{})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((J,ae)=>s.jsx(ro,{},ae))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(ro,{}),s.jsx(ro,{})]})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(Io,{className:"w-8 h-8 text-blue-600"}),s.jsx("h1",{className:"gradient-text text-3xl font-bold",children:"Business Analytics"})]}),s.jsx("p",{className:"text-gray-600",children:"Track your venue performance, revenue, and customer insights"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:G,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[s.jsx(pp,{className:"w-4 h-4"}),"Export Data"]}),s.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all",children:"Upgrade to Pro"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(di,{title:"Total Events",value:(n==null?void 0:n.total_events)||0,icon:s.jsx(Lt,{className:"w-6 h-6"}),trend:"neutral"}),s.jsx(di,{title:"Total Revenue",value:`$${((n==null?void 0:n.total_revenue)||0).toLocaleString()}`,icon:s.jsx(Do,{className:"w-6 h-6"}),trend:(n==null?void 0:n.revenue_growth_rate)>0?"up":(n==null?void 0:n.revenue_growth_rate)<0?"down":"neutral"}),s.jsx(di,{title:"Conversion Rate",value:`${(n==null?void 0:n.conversion_rate)||0}%`,icon:s.jsx(Ji,{className:"w-6 h-6"}),trend:"neutral"}),s.jsx(di,{title:"Customer Satisfaction",value:`${(n==null?void 0:n.customer_satisfaction)||0}/5`,icon:s.jsx(Xt,{className:"w-6 h-6"}),trend:"neutral"})]}),s.jsx("div",{className:"mb-8",children:s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:qd},{id:"revenue",label:"Revenue",icon:Do},{id:"customers",label:"Customers",icon:Vr},{id:"events",label:"Events",icon:Lt},{id:"promotions",label:"Promotions",icon:qn},{id:"achievements",label:"Achievements",icon:Vd}].map(J=>s.jsxs("button",{onClick:()=>_(J.id),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${g===J.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(J.icon,{className:"w-4 h-4"}),J.label]},J.id))})})}),g==="overview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[z&&s.jsx(kW,{metrics:z,title:"Business Performance Score",showBreakdown:!0}),I.length>0&&s.jsx(EW,{data:I,title:"Revenue Trends",valueLabel:"Daily Revenue",showTrend:!0})]}),k&&k.stages.length>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Ji,{className:"w-5 h-5 text-synth-pink"}),"Customer Conversion Funnel"]}),s.jsx(NW,{stages:k.stages,title:"Customer Journey Analysis",showOptimizationTips:!0})]}),A&&A.total_revenue>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Do,{className:"w-5 h-5 text-synth-pink"}),"Revenue Attribution"]}),s.jsx(SW,{sources:A.top_revenue_sources.map(J=>({source:J.source,revenue:J.revenue,percentage:J.percentage,confidence_score:.8,attribution_window:24})),totalRevenue:A.total_revenue,title:"Revenue Sources",showConfidenceScores:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(qn,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Performing Events"})]}),i.length>0?s.jsx("div",{className:"space-y-3",children:i.slice(0,5).map((J,ae)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm font-semibold text-blue-600",children:ae+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:J.title}),s.jsx("p",{className:"text-sm text-gray-500",children:J.artist_name})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-semibold text-gray-900",children:["$",J.revenue_generated]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[J.total_views," views"]})]})]},J.event_id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Lt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 mb-2",children:"No events created yet"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Create your first event to see performance analytics"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Hb,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Customer Segments"})]}),l.length>0?s.jsx("div",{className:"space-y-3",children:l.map((J,ae)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center text-sm font-semibold text-green-600",children:ae+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:J.customer_segment}),s.jsxs("p",{className:"text-sm text-gray-500",children:[J.avg_events_attended," avg events"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:J.count}),s.jsxs("p",{className:"text-sm text-gray-500",children:[J.percentage,"%"]})]})]},J.customer_segment))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Vr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 mb-2",children:"No customer data yet"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Customer insights will appear as people interact with your events"})]})]})]})]}),g==="revenue"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Do,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Total Revenue"})]}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:["$",((n==null?void 0:n.total_revenue)||0).toLocaleString()]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ji,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Conversion Rate"})]}),s.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:[(n==null?void 0:n.conversion_rate)||0,"%"]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(qn,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Avg Ticket Price"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:"$50"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Revenue Trends"}),d.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Date"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Revenue"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Ticket Clicks"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Conversion Rate"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Avg Price"})]})}),s.jsx("tbody",{children:d.slice(-10).map(J=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:new Date(J.date).toLocaleDateString()}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",J.revenue]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:J.ticket_clicks}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[J.conversion_rate,"%"]}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",J.avg_ticket_price]})]},J.date))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Do,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No revenue data available"})]})]})]}),g==="customers"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Vr,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Attendees"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:((n==null?void 0:n.total_attendees)||0).toLocaleString()})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(nz,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Repeat Rate"})]}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[(n==null?void 0:n.repeat_customer_rate)||0,"%"]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Xt,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"Satisfaction"})]}),s.jsxs("p",{className:"text-2xl font-bold text-yellow-900",children:[(n==null?void 0:n.customer_satisfaction)||0,"/5"]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Customer Segmentation"}),l.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Segment"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Count"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Percentage"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Avg Events"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Avg Spending"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Loyalty Score"})]})}),s.jsx("tbody",{children:l.map(J=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:J.customer_segment}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:J.count}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[J.percentage,"%"]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:J.avg_events_attended}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",J.avg_spending]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:J.loyalty_score})]},J.customer_segment))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Vr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No customer data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"VIP Customers"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Your most engaged and valuable customers"})]}),s.jsxs("button",{onClick:S,disabled:_e,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors flex items-center gap-2",children:[s.jsx(vi,{className:`w-4 h-4 ${_e?"animate-spin":""}`}),"Refresh"]})]}),_e?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(fr,{className:"w-8 h-8 animate-spin text-purple-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading VIP customers..."})]}):Z.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(uf,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No VIP Customers Yet"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"VIP customers will appear as people engage more with your events"}),s.jsx("p",{className:"text-sm text-gray-400",children:"VIP status is based on event attendance, reviews, and engagement"})]}):s.jsxs("div",{className:"space-y-6",children:[Y&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(uf,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-700",children:"Total VIPs"})]}),s.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:Y.total_vip_customers})]}),s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(qn,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Avg Score"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Y.avg_vip_score})]}),s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Vr,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-700",children:"Retention"})]}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[Y.vip_retention_rate,"%"]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Do,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Revenue"})]}),s.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:["$",Y.vip_revenue_contribution]})]})]}),Y&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"VIP Tier Distribution"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(Y.vip_by_tier).map(([J,ae])=>s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`w-12 h-12 rounded-full mx-auto mb-2 flex items-center justify-center text-white font-bold ${J==="platinum"?"bg-gradient-to-r from-gray-400 to-gray-600":J==="gold"?"bg-gradient-to-r from-yellow-400 to-yellow-600":J==="silver"?"bg-gradient-to-r from-gray-300 to-gray-500":"bg-gradient-to-r from-orange-400 to-orange-600"}`,children:J.charAt(0).toUpperCase()}),s.jsx("p",{className:"text-sm font-medium text-gray-900 capitalize",children:J}),s.jsx("p",{className:"text-lg font-bold text-gray-700",children:ae})]},J))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Top VIP Customers"}),s.jsx("div",{className:"space-y-3",children:Z.slice(0,10).map((J,ae)=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold ${J.vip_tier==="platinum"?"bg-gradient-to-r from-gray-400 to-gray-600":J.vip_tier==="gold"?"bg-gradient-to-r from-yellow-400 to-yellow-600":J.vip_tier==="silver"?"bg-gradient-to-r from-gray-300 to-gray-500":"bg-gradient-to-r from-orange-400 to-orange-600"}`,children:ae+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:J.display_name}),s.jsxs("p",{className:"text-sm text-gray-500 capitalize",children:[J.vip_tier," VIP  ",J.engagement_score," engagement"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-semibold text-gray-900",children:[J.vip_score," pts"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[J.total_events_attended," events"]})]})]},J.user_id))})]})]})]})]}),g==="events"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Event Performance"}),i.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Event"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Artist"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Date"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Views"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Interested"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Revenue"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Rating"})]})}),s.jsx("tbody",{children:i.map(J=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:J.title}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:J.artist_name}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:new Date(J.event_date).toLocaleDateString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:J.total_views}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:J.total_interested}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",J.revenue_generated]}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[J.avg_rating,"/5"]})]},J.event_id))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Lt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No event data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Artist Performance"}),u.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Artist"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Events"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Views"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Revenue"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Rating"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Repeat Rate"})]})}),s.jsx("tbody",{children:u.map(J=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:J.artist_name}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:J.events_count}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:J.total_views}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",J.total_revenue]}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[J.avg_rating,"/5"]}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[J.repeat_rate,"%"]})]},J.artist_name))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(qn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No artist performance data available"})]})]})]}),g==="achievements"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[s.jsx(Vd,{className:"w-8 h-8 text-yellow-500"}),s.jsx("h2",{className:"gradient-text text-2xl font-bold",children:"Business Achievements"})]}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Track your business milestones and growth metrics"})]}),["events","revenue","customers","growth"].map(J=>{const ae=m.filter(we=>we.category===J),fe={events:"Event Hosting",revenue:"Revenue Goals",customers:"Customer Satisfaction",growth:"Growth Metrics"};return s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Mc,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:fe[J]})]}),ae.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ae.map(we=>s.jsx(TA,{name:we.name,description:we.description,icon:we.icon,progress:we.progress,goal:we.goal,unlocked:we.unlocked,unlockedAt:we.unlockedAt,compact:!0},we.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Mc,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No achievements in this category yet"})]})]},J)})]}),g==="promotions"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Promotion Analytics"}),Q&&s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live"]})]}),s.jsx("p",{className:"text-gray-600",children:"Track your venue's event promotion performance and ROI"}),oe&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Last updated: ",oe.toLocaleTimeString()]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>E(this,null,function*(){e&&(yield J9e(e.id),yield N())}),className:"px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded-lg transition-colors flex items-center gap-2",children:[s.jsx(qn,{className:"w-4 h-4"}),"Sync Metrics"]}),s.jsxs("button",{onClick:N,disabled:w,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors flex items-center gap-2",children:[s.jsx(vi,{className:`w-4 h-4 ${w?"animate-spin":""}`}),"Refresh"]})]})]}),w?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(fr,{className:"w-8 h-8 animate-spin text-purple-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading promotion data..."})]}):B.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(qn,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Promotions Yet"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Start promoting your venue's events to see detailed analytics here"}),s.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Promote Your First Event"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:B.slice(0,3).map(J=>s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold text-lg truncate",children:J.event.title}),s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${J.promotion_tier==="featured"?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800":J.promotion_tier==="premium"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:J.promotion_tier})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Impressions"}),s.jsx("p",{className:"text-xl font-bold",children:J.impressions.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Clicks"}),s.jsx("p",{className:"text-xl font-bold",children:J.clicks.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Conversions"}),s.jsx("p",{className:"text-xl font-bold text-green-600",children:J.conversions.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"CTR"}),s.jsxs("p",{className:"text-xl font-bold",children:[(J.clicks/J.impressions*100).toFixed(1),"%"]})]})]})]},J.id))}),s.jsx(nK,{data:q.map(J=>({date:J.date,impressions:J.impressions||0,clicks:J.clicks||0,conversions:J.conversions||0,spend:J.spend||0})),className:"bg-white rounded-xl shadow-sm border"}),U.length>0&&s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Promotion Comparison"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b",children:[s.jsx("th",{className:"text-left py-2",children:"Event"}),s.jsx("th",{className:"text-left py-2",children:"Tier"}),s.jsx("th",{className:"text-left py-2",children:"Impressions"}),s.jsx("th",{className:"text-left py-2",children:"Clicks"}),s.jsx("th",{className:"text-left py-2",children:"Conversions"}),s.jsx("th",{className:"text-left py-2",children:"CTR"}),s.jsx("th",{className:"text-left py-2",children:"ROI"})]})}),s.jsx("tbody",{children:U.slice(0,5).map(J=>s.jsxs("tr",{className:"border-b",children:[s.jsx("td",{className:"py-2 font-medium truncate max-w-32",children:J.event_title}),s.jsx("td",{className:"py-2",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs ${J.tier==="featured"?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800":J.tier==="premium"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:J.tier})}),s.jsx("td",{className:"py-2",children:J.impressions.toLocaleString()}),s.jsx("td",{className:"py-2",children:J.clicks.toLocaleString()}),s.jsx("td",{className:"py-2",children:J.conversions.toLocaleString()}),s.jsxs("td",{className:"py-2",children:[J.ctr.toFixed(1),"%"]}),s.jsx("td",{className:"py-2",children:s.jsxs("span",{className:`font-semibold ${J.roi>=0?"text-green-600":"text-red-600"}`,children:[J.roi>=0?"+":"",J.roi.toFixed(1),"%"]})})]},J.promotion_id))})]})})]})]})]})]})})}class Fs{static getPlatformStats(){return E(this,null,function*(){try{const{count:t}=yield T.from("users").select("*",{count:"exact",head:!0}),{count:r}=yield T.from("events").select("*",{count:"exact",head:!0}),a=(yield vs.getAllUserInteractions()).length,i=new Date;i.setHours(0,0,0,0);const o=new Date(i);o.setHours(23,59,59,999);const{count:l}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("last_active_at",i.toISOString()).lte("last_active_at",o.toISOString()),c=new Date;c.setDate(c.getDate()-29),c.setHours(0,0,0,0);const{count:d}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("last_active_at",c.toISOString()),f=new Date;f.setDate(1);const{count:u}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("created_at",f.toISOString()),h=new Date;h.setMonth(h.getMonth()-1),h.setDate(1);const{count:m}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("created_at",h.toISOString()).lt("created_at",f.toISOString()),v=m>0?(u-m)/m*100:0;return{total_users:t||0,total_events:r||0,total_interactions:a||0,active_users_today:l||0,daily_active_users:l||0,monthly_active_users:d||0,new_users_this_month:u||0,platform_growth_rate:v,average_session_duration:0}}catch(t){return console.error("Error getting platform stats:",t),{total_users:0,total_events:0,total_interactions:0,active_users_today:0,daily_active_users:0,monthly_active_users:0,new_users_this_month:0,platform_growth_rate:0,average_session_duration:0}}})}static getUserGrowth(t=30){return E(this,null,function*(){try{const r=new Date;r.setDate(r.getDate()-t);const{data:n}=yield T.from("users").select("created_at").gte("created_at",r.toISOString()),{data:a}=yield T.from("interactions").select("user_id, created_at").gte("created_at",r.toISOString()),i=new Map;n==null||n.forEach(c=>{const d=new Date(c.created_at).toISOString().split("T")[0];i.has(d)||i.set(d,{newUsers:0,activeUsers:new Set,totalUsers:0}),i.get(d).newUsers++}),a==null||a.forEach(c=>{const d=new Date(c.created_at).toISOString().split("T")[0];i.has(d)||i.set(d,{newUsers:0,activeUsers:new Set,totalUsers:0}),i.get(d).activeUsers.add(c.user_id)});let o=0;const l=[];return Array.from(i.entries()).sort((c,d)=>c[0].localeCompare(d[0])).forEach(([c,d])=>{o+=d.newUsers;const f=d.activeUsers.size,u=o>0?f/o*100:0;l.push({date:c,new_users:d.newUsers,active_users:f,total_users:o,retention_rate:Math.round(u*100)/100})}),l}catch(r){return console.error("Error getting user growth:",r),[]}})}static getEngagementMetrics(){return E(this,null,function*(){try{const{data:t}=yield T.from("interactions").select("*"),r=(t==null?void 0:t.filter(f=>f.event_type==="view").length)||0,n=(t==null?void 0:t.filter(f=>f.event_type==="search").length)||0,a=(t==null?void 0:t.filter(f=>f.event_type==="click_ticket").length)||0,{count:i}=yield T.from("reviews").select("*",{count:"exact",head:!0}),l=new Set((t==null?void 0:t.map(f=>f.user_id))||[]).size;return{total_page_views:r,total_sessions:l,average_session_duration:0,bounce_rate:0,events_viewed:r,searches_performed:n,reviews_written:i||0,tickets_clicked:a}}catch(t){return console.error("Error getting engagement metrics:",t),{total_page_views:0,total_sessions:0,average_session_duration:0,bounce_rate:0,events_viewed:0,searches_performed:0,reviews_written:0,tickets_clicked:0}}})}static getActiveUserMetrics(){return E(this,null,function*(){try{const t=yield vs.getAllUserInteractions(),r=new Map;t.forEach(M=>{const B=M.user_id;r.set(B,(r.get(B)||0)+1)});const n=Array.from(r.entries()).filter(([M,B])=>B>=10).map(([M])=>M),a=n.length,i=new Date,o=new Date(i);o.setDate(o.getDate()-7);const l=new Date(i);l.setDate(l.getDate()-30);const c=new Date(i);c.setDate(c.getDate()-90);const d=new Set,f=new Set,u=new Set;t.forEach(M=>{if(n.includes(M.user_id)){const B=new Date(M.occurred_at);B>=c&&u.add(M.user_id),B>=l&&f.add(M.user_id),B>=o&&d.add(M.user_id)}});const h=n.reduce((M,B)=>M+(r.get(B)||0),0),m=a>0?h/a:0,{data:v}=yield T.from("users").select("user_id, location_city, created_at").in("user_id",n),g=new Map;v==null||v.forEach(M=>{const B=M.location_city||"Unknown";g.has(B)||g.set(B,{users:0,newUsers:0});const F=g.get(B);F.users++;const U=new Date(M.created_at),H=new Date;H.setDate(H.getDate()-30),U>=H&&F.newUsers++});const x=Array.from(g.entries()).map(([M,B])=>({country:"USA",city:M,users:B.users,events:0,revenue:0,growth_rate:B.users>0?B.newUsers/B.users*100:0})).sort((M,B)=>B.users-M.users).slice(0,20),{data:_}=yield T.from("users").select("user_id, verified, trust_score, verification_criteria_met").in("user_id",n),w=(_==null?void 0:_.filter(M=>M.verified).length)||0,b=(_==null?void 0:_.reduce((M,B)=>M+(B.trust_score||0),0))||0,N=(_==null?void 0:_.length)>0?b/_.length:0,S=(_==null?void 0:_.reduce((M,B)=>{const F=B.verification_criteria_met||{};return M+Object.values(F).filter(Boolean).length},0))||0,k=(_==null?void 0:_.length)>0?S/_.length:0,C=(_==null?void 0:_.filter(M=>(M.trust_score||0)>=40&&!M.verified).length)||0,A=(v==null?void 0:v.reduce((M,B)=>{const F=(i.getTime()-new Date(B.created_at).getTime())/864e5;return M+F},0))||0,R=(v==null?void 0:v.length)>0?A/v.length:0,I=yield this.getDAUOverTime(30),O=yield this.getWeeklyActiveUsers(12),z=yield this.getMAUOverTime(12);return{total_active_users:a,active_users_7d:d.size,active_users_30d:f.size,active_users_90d:u.size,avg_interactions_per_active_user:Math.round(m*100)/100,avg_account_age_days:Math.round(R*100)/100,geographic_distribution:x,verification_stats:{total_verified:w,avg_trust_score:Math.round(N*100)/100,avg_verification_progress:Math.round(k*100)/100,users_near_verification:C},time_series_data:{daily:I,weekly:O,monthly:z}}}catch(t){return console.error("Error getting active user metrics:",t),{total_active_users:0,active_users_7d:0,active_users_30d:0,active_users_90d:0,avg_interactions_per_active_user:0,avg_account_age_days:0,geographic_distribution:[],verification_stats:{total_verified:0,avg_trust_score:0,avg_verification_progress:0,users_near_verification:0},time_series_data:{daily:[],weekly:[],monthly:[]}}}})}static getWeeklyActiveUsers(t=12){return E(this,null,function*(){try{const r=new Date;r.setDate(r.getDate()-t*7),r.setHours(0,0,0,0);const{data:n}=yield T.from("interactions").select("user_id, occurred_at").gte("occurred_at",r.toISOString()),a=new Map;return n==null||n.forEach(o=>{const l=new Date(o.occurred_at),c=new Date(l);c.setDate(l.getDate()-l.getDay()),c.setHours(0,0,0,0);const d=c.toISOString().split("T")[0];a.has(d)||a.set(d,new Set),a.get(d).add(o.user_id)}),Array.from(a.entries()).map(([o,l])=>({date:o,value:l.size})).sort((o,l)=>o.date.localeCompare(l.date))}catch(r){return console.error("Error getting weekly active users:",r),[]}})}static getContentMetrics(){return E(this,null,function*(){try{const[t,r,n,a]=yield Promise.all([T.from("events").select("*",{count:"exact",head:!0}),T.from("artists").select("*",{count:"exact",head:!0}),T.from("venues").select("*",{count:"exact",head:!0}),T.from("reviews").select("*",{count:"exact",head:!0})]),i=new Date;i.setDate(1);const{count:o}=yield T.from("events").select("*",{count:"exact",head:!0}).gte("created_at",i.toISOString()),{data:l}=yield T.from("reviews").select("rating").not("rating","is",null),c=(l==null?void 0:l.length)>0?l.reduce((f,u)=>f+(u.rating||0),0)/l.length:0;return{total_events:t.count||0,events_this_month:o||0,total_artists:r.count||0,total_venues:n.count||0,total_reviews:a.count||0,average_event_rating:Math.round(c*100)/100,content_growth_rate:0}}catch(t){return console.error("Error getting content metrics:",t),{total_events:0,events_this_month:0,total_artists:0,total_venues:0,total_reviews:0,average_event_rating:0,content_growth_rate:0}}})}static getFeatureUsage(){return E(this,null,function*(){try{const t=yield vs.getAllUserInteractions(),r={"view:event":{name:"Event Views",category:"Event Discovery"},"click:event":{name:"Event Clicks",category:"Event Discovery"},"interest:event":{name:"Event Interest/RSVP",category:"Event Engagement"},"attendance:event":{name:"Event Attendance",category:"Event Engagement"},"share:event":{name:"Event Shares",category:"Social"},"view:artist":{name:"Artist Views",category:"Content Discovery"},"click:artist":{name:"Artist Clicks",category:"Content Discovery"},"view:venue":{name:"Venue Views",category:"Content Discovery"},"click:venue":{name:"Venue Clicks",category:"Content Discovery"},"review:event":{name:"Event Reviews",category:"Content Creation"},"review:artist":{name:"Artist Reviews",category:"Content Creation"},"review:venue":{name:"Venue Reviews",category:"Content Creation"},"like:review":{name:"Review Likes",category:"Social Engagement"},search:{name:"Search",category:"Discovery"},"click:ticket":{name:"Ticket Clicks",category:"Event Engagement"},"click:ticket_link":{name:"Ticket Link Clicks",category:"Event Engagement"},"follow:artist":{name:"Artist Follows",category:"Social"},"follow:user":{name:"User Follows",category:"Social"},navigate:{name:"Navigation",category:"Platform Usage"},profile_update:{name:"Profile Updates",category:"Profile Management"},"view:spotify":{name:"Spotify Integration",category:"Music Integration"},"click:spotify":{name:"Spotify Clicks",category:"Music Integration"}},n=new Map,a=new Date,i=new Date(a);i.setDate(i.getDate()-7);const o=new Date(a);o.setDate(o.getDate()-30),t.forEach(f=>{const u=`${f.event_type}:${f.entity_type}`,h=r[u]||{name:`${f.event_type} (${f.entity_type})`,category:"Other"};n.has(h.name)||n.set(h.name,{totalUses:0,uniqueUsers:new Set,usesLast7d:0,usesLast30d:0,usesLast7dUsers:new Set,usesLast30dUsers:new Set});const m=n.get(h.name);m.totalUses++,m.uniqueUsers.add(f.user_id);const v=new Date(f.occurred_at);v>=o&&(m.usesLast30d++,m.usesLast30dUsers.add(f.user_id)),v>=i&&(m.usesLast7d++,m.usesLast7dUsers.add(f.user_id))});const l=new Date(a);l.setDate(l.getDate()-14);const c=new Map;return t.forEach(f=>{const u=`${f.event_type}:${f.entity_type}`,h=r[u];if(h){const m=new Date(f.occurred_at);m>=l&&m<i&&c.set(h.name,(c.get(h.name)||0)+1)}}),Array.from(n.entries()).map(([f,u])=>{const h=Object.values(r).find(g=>g.name===f)||{name:f,category:"Other"},m=c.get(f)||0,v=m>0?(u.usesLast7d-m)/m*100:0;return{feature_name:f,feature_category:h.category,total_uses:u.totalUses,unique_users:u.uniqueUsers.size,uses_last_7d:u.usesLast7d,uses_last_30d:u.usesLast30d,avg_uses_per_user:u.uniqueUsers.size>0?u.totalUses/u.uniqueUsers.size:0,growth_rate:Math.round(v*100)/100}}).sort((f,u)=>u.total_uses-f.total_uses)}catch(t){return console.error("Error getting feature usage:",t),[]}})}static getUserSegments(){return E(this,null,function*(){try{const{data:t}=yield T.from("users").select("user_id, created_at"),{data:r}=yield T.from("interactions").select("user_id, created_at"),n=new Map;return r==null||r.forEach(o=>{const l=o.user_id;n.has(l)||n.set(l,{sessions:0,daysActive:new Set});const c=n.get(l);c.sessions++,c.daysActive.add(new Date(o.created_at).toISOString().split("T")[0])}),Object.entries({"New Users":{minSessions:0,maxSessions:5},"Active Users":{minSessions:6,maxSessions:20},"Power Users":{minSessions:21,maxSessions:1/0}}).map(([o,l])=>{const c=Array.from(n.entries()).filter(([v,g])=>g.sessions>=l.minSessions&&g.sessions<=l.maxSessions),d=c.length,f=n.size,u=f>0?d/f*100:0,h=d>0?c.reduce((v,[g,x])=>v+x.sessions,0)/d:0,m=d>0?c.reduce((v,[g,x])=>v+x.daysActive.size,0)/d/30*100:0;return{segment:o,count:d,percentage:Math.round(u*100)/100,avg_sessions:Math.round(h*100)/100,retention_rate:Math.round(m*100)/100}})}catch(t){return console.error("Error getting user segments:",t),[]}})}static getGeographicDistribution(){return E(this,null,function*(){try{const{data:t}=yield T.from("users").select("user_id, location_city, created_at");if(!t||t.length===0)return[];const r=new Map;t.forEach(l=>{const c=l.location_city||"Unknown";r.has(c)||r.set(c,{users:0,events:0,newUsers:0});const d=r.get(c);d.users++;const f=new Date(l.created_at),u=new Date;u.setDate(u.getDate()-30),f>=u&&d.newUsers++});const a=(yield T.from("events").select("*",{count:"exact",head:!0})).count||0,i=t.length;return r.forEach((l,c)=>{l.events=Math.round(l.users/i*a)}),Array.from(r.entries()).map(([l,c])=>{const d=c.users>0?c.newUsers/c.users*100:0;return{country:"USA",city:l,users:c.users,events:c.events,revenue:0,growth_rate:Math.round(d*100)/100}}).sort((l,c)=>c.users-l.users).slice(0,20)}catch(t){return console.error("Error getting geographic distribution:",t),[]}})}static getDAUOverTime(t=30){return E(this,null,function*(){var r;try{const n=new Date;n.setDate(n.getDate()-t),n.setHours(0,0,0,0);const{data:a}=yield T.from("interactions").select("user_id, occurred_at").gte("occurred_at",n.toISOString()),i=new Map;a==null||a.forEach(f=>{const u=new Date(f.occurred_at).toISOString().split("T")[0];i.has(u)||i.set(u,new Set),i.get(u).add(f.user_id)});const{data:o}=yield T.from("users").select("user_id, last_active_at").not("last_active_at","is",null).gte("last_active_at",n.toISOString());o==null||o.forEach(f=>{const u=new Date(f.last_active_at).toISOString().split("T")[0];i.has(u)||i.set(u,new Set),i.get(u).add(f.user_id)});const l=[],c=new Date(n),d=new Date;for(d.setHours(23,59,59,999);c<=d;){const f=c.toISOString().split("T")[0],u=((r=i.get(f))==null?void 0:r.size)||0;l.push({date:f,value:u}),c.setDate(c.getDate()+1)}return l}catch(n){return console.error("Error getting DAU over time:",n),[]}})}static getMAUOverTime(t=12){return E(this,null,function*(){var r;try{const n=new Date;n.setMonth(n.getMonth()-t),n.setDate(1),n.setHours(0,0,0,0);const{data:a}=yield T.from("interactions").select("user_id, occurred_at").gte("occurred_at",n.toISOString()),{data:i}=yield T.from("users").select("user_id, last_active_at").not("last_active_at","is",null).gte("last_active_at",n.toISOString()),o=new Map;a==null||a.forEach(d=>{const f=new Date(d.occurred_at),u=`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}`;o.has(u)||o.set(u,new Set),o.get(u).add(d.user_id)}),i==null||i.forEach(d=>{const f=new Date(d.last_active_at),u=`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}`;o.has(u)||o.set(u,new Set),o.get(u).add(d.user_id)});const l=[],c=new Date(n);for(;c<=new Date;){const d=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}`,f=((r=o.get(d))==null?void 0:r.size)||0;l.push({date:d,value:f}),c.setMonth(c.getMonth()+1)}return l}catch(n){return console.error("Error getting MAU over time:",n),[]}})}static getNewUsersOverTime(t=30){return E(this,null,function*(){try{const r=new Date;r.setDate(r.getDate()-t),r.setHours(0,0,0,0);const{data:n}=yield T.from("users").select("created_at").gte("created_at",r.toISOString()),a=new Map;n==null||n.forEach(c=>{const d=new Date(c.created_at).toISOString().split("T")[0];a.set(d,(a.get(d)||0)+1)});const i=[],o=new Date(r),l=new Date;for(l.setHours(23,59,59,999);o<=l;){const c=o.toISOString().split("T")[0];i.push({date:c,value:a.get(c)||0}),o.setDate(o.getDate()+1)}return i}catch(r){return console.error("Error getting new users over time:",r),[]}})}static getUserStats(){return E(this,null,function*(){try{const t=new Date,r=new Date(t);r.setDate(r.getDate()-7);const n=new Date(t);n.setDate(n.getDate()-30);const{count:a}=yield T.from("users").select("*",{count:"exact",head:!0}),{count:i}=yield T.from("users").select("*",{count:"exact",head:!0}).eq("verified",!0),{count:o}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("last_active_at",r.toISOString()),{count:l}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("last_active_at",n.toISOString()),{count:c}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("created_at",r.toISOString()),{count:d}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("created_at",n.toISOString()),{data:f}=yield T.from("users").select("created_at"),u=f&&f.length>0?f.reduce((x,_)=>{const w=(t.getTime()-new Date(_.created_at).getTime())/864e5;return x+w},0)/f.length:0,{data:h}=yield T.from("reviews").select("user_id").eq("is_draft",!1),m=new Set((h==null?void 0:h.map(x=>x.user_id))||[]).size,{data:v}=yield T.from("user_relationships").eq("relationship_type","friend").eq("status","accepted").select("user_id, related_user_id"),g=new Set([...(v==null?void 0:v.map(x=>x.user_id))||[],...(v==null?void 0:v.map(x=>x.related_user_id))||[]]).size;return{total_users:a||0,verified_users:i||0,active_users_7d:o||0,active_users_30d:l||0,new_users_7d:c||0,new_users_30d:d||0,avg_account_age_days:Math.round(u*100)/100,users_with_reviews:m,users_with_friends:g}}catch(t){return console.error("Error getting user stats:",t),{total_users:0,verified_users:0,active_users_7d:0,active_users_30d:0,new_users_7d:0,new_users_30d:0,avg_account_age_days:0,users_with_reviews:0,users_with_friends:0}}})}static getAdminAchievements(){return E(this,null,function*(){try{const t=yield this.getPlatformStats(),r=yield this.getContentMetrics();return[{id:"first_users",name:"First Users",description:"Reach 100 total users",icon:"",progress:Math.min(t.total_users,100),goal:100,unlocked:t.total_users>=100,category:"users"},{id:"growing_platform",name:"Growing Platform",description:"Reach 1,000 total users",icon:"",progress:Math.min(t.total_users,1e3),goal:1e3,unlocked:t.total_users>=1e3,category:"users"},{id:"popular_platform",name:"Popular Platform",description:"Reach 10,000 total users",icon:"",progress:Math.min(t.total_users,1e4),goal:1e4,unlocked:t.total_users>=1e4,category:"users"},{id:"content_creator",name:"Content Creator",description:"Host 100 events on the platform",icon:"",progress:Math.min(r.total_events,100),goal:100,unlocked:r.total_events>=100,category:"content"},{id:"event_platform",name:"Event Platform",description:"Host 1,000 events on the platform",icon:"",progress:Math.min(r.total_events,1e3),goal:1e3,unlocked:r.total_events>=1e3,category:"content"},{id:"high_engagement",name:"High Engagement",description:"Achieve 10,000 total interactions",icon:"",progress:Math.min(t.total_interactions,1e4),goal:1e4,unlocked:t.total_interactions>=1e4,category:"platform"},{id:"viral_platform",name:"Viral Platform",description:"Achieve 100,000 total interactions",icon:"",progress:Math.min(t.total_interactions,1e5),goal:1e5,unlocked:t.total_interactions>=1e5,category:"platform"}]}catch(t){return console.error("Error getting admin achievements:",t),[]}})}static getNorthStarMetric(){return E(this,null,function*(){try{const t=new Date,r=new Date(t.getFullYear(),t.getMonth(),1),n=new Date(t.getFullYear(),t.getMonth()-1,1),a=new Date(t.getFullYear(),t.getMonth(),0),{data:i}=yield T.from("interactions").select("user_id, event_type, entity_type, entity_id, metadata").gte("occurred_at",r.toISOString()).in("event_type",["interest","share","attendance"]).eq("entity_type","event"),{data:o}=yield T.from("interactions").select("user_id, event_type, entity_type, entity_id, metadata").gte("occurred_at",n.toISOString()).lt("occurred_at",a.toISOString()).in("event_type",["interest","share","attendance"]).eq("entity_type","event"),{data:l}=yield T.from("user_event_relationships").in("relationship_type",["going","maybe"]).select("user_id, event_id, relationship_type").gte("created_at",r.toISOString()),{data:c}=yield T.from("user_event_relationships").in("relationship_type",["going","maybe"]).select("user_id, event_id, relationship_type").gte("created_at",n.toISOString()).lt("created_at",a.toISOString()),d=b=>{var N,S,k,C,A,R;return(b==null?void 0:b.entity_id)||((N=b==null?void 0:b.metadata)==null?void 0:N.event_id)||((S=b==null?void 0:b.metadata)==null?void 0:S.eventId)||((C=(k=b==null?void 0:b.metadata)==null?void 0:k.event)==null?void 0:C.id)||((A=b==null?void 0:b.metadata)==null?void 0:A.jambase_event_id)||((R=b==null?void 0:b.metadata)==null?void 0:R.jambaseEventId)||null},f=(b,N,S=!1)=>{const k=new Map,C=new Set,A=new Set;let R=0;const I=S?{saves:0,rsvps:0,shares:0}:null,O=(z,M,B)=>{if(!z)return;const F=M==="interest"?"save":M,U=`${z}:${F}:${B||"unknown"}`;A.has(U)||(A.add(U),C.add(z),k.set(z,(k.get(z)||0)+1),R+=1,I&&(F==="save"?I.saves+=1:F==="share"?I.shares+=1:F==="rsvp"&&(I.rsvps+=1)))};return b==null||b.forEach(z=>{const M=d(z);O(z.user_id,z.event_type,M)}),N==null||N.forEach(z=>{O(z.user_id,"rsvp",z.event_id)}),{userScores:k,engagedCount:C.size,totalIntents:R,breakdown:I||{saves:0,rsvps:0,shares:0}}},u=f(i,l,!0),h=f(o,c,!1),m=u.engagedCount,v=h.engagedCount,g=m>0?u.totalIntents/m:0,x=v>0?h.totalIntents/v:0,_=x>0?(g-x)/x*100:0,w=Array.from(u.userScores.entries()).sort((b,N)=>N[1]-b[1]).slice(0,5).map(([b,N])=>({user_id:b,user_name:`User ${b.slice(0,8)}`,eci_score:N}));if(w.length>0){const b=w.map(S=>S.user_id),{data:N}=yield T.from("users").select("user_id, name").in("user_id",b);N==null||N.forEach(S=>{const k=w.find(C=>C.user_id===S.user_id);k&&(k.user_name=S.name||`User ${S.user_id.slice(0,8)}`)})}return{eci_per_user:Math.round(g*100)/100,total_engaged_users:m,total_concert_intents:u.totalIntents,monthly_growth_rate:Math.round(_*100)/100,breakdown:u.breakdown,top_engaged_users:w}}catch(t){return console.error("Error calculating North Star Metric:",t),{eci_per_user:0,total_engaged_users:0,total_concert_intents:0,monthly_growth_rate:0,breakdown:{saves:0,rsvps:0,shares:0},top_engaged_users:[]}}})}static getFeatureAdoptionFunnel(){return E(this,null,function*(){try{const t=yield vs.getAllUserInteractions(),r=[{name:"Event Interest/RSVP",eventType:"interest",entityType:"event"},{name:"Event Reviews",eventType:"review",entityType:"event"},{name:"Event Shares",eventType:"share",entityType:"event"},{name:"Search",eventType:"search",entityType:"search"},{name:"Ticket Clicks",eventType:"click_ticket",entityType:"ticket_link"}],n=new Date,a=new Date(n);a.setDate(a.getDate()-30);const i=new Date(n);i.setDate(i.getDate()-60);const o=[];for(const l of r){const c=new Set,d=new Set,f=new Set,u=new Set,h=t.filter(N=>N.event_type===l.eventType&&(l.entityType==="search"||N.entity_type===l.entityType)),m=new Map,v=new Map,g=new Map;h.forEach(N=>{const S=N.user_id,k=new Date(N.occurred_at);m.set(S,(m.get(S)||0)+1),(!v.has(S)||k<v.get(S))&&v.set(S,k),(!g.has(S)||k>g.get(S))&&g.set(S,k)}),m.forEach((N,S)=>{const k=v.get(S),C=g.get(S);c.add(S),N>=1&&N<=2?d.add(S):N>=3&&N<=10?f.add(S):N>10&&C>=a&&u.add(S)});const x=c.size,_=d.size,w=f.size,b=u.size;o.push({feature_name:l.name,discovery_count:x,trial_count:_,adoption_count:w,retention_count:b,discovery_to_trial_rate:x>0?_/x*100:0,trial_to_adoption_rate:_>0?w/_*100:0,adoption_to_retention_rate:w>0?b/w*100:0})}return o}catch(t){return console.error("Error getting feature adoption funnel:",t),[]}})}static getSessionAnalytics(){return E(this,null,function*(){try{const t=yield vs.getAllUserInteractions(),r=new Map;t.forEach(_=>{const w=_.session_id||"no-session",b=new Date(_.occurred_at);r.has(w)||r.set(w,{startTime:b,endTime:b,pageViews:0,userId:_.user_id});const N=r.get(w);b<N.startTime&&(N.startTime=b),b>N.endTime&&(N.endTime=b),_.event_type==="view"&&N.pageViews++});const n=[],a=[];r.forEach(_=>{const w=(_.endTime.getTime()-_.startTime.getTime())/6e4;n.push(w),a.push(_.pageViews||1)});const i=r.size,o=n.length>0?n.reduce((_,w)=>_+w,0)/n.length:0,l=a.length>0?a.reduce((_,w)=>_+w,0)/a.length:0,c=new Date,d=new Date(c);d.setDate(d.getDate()-7);const f=new Date(c);f.setDate(f.getDate()-30);const u=Array.from(r.values()).filter(_=>_.startTime>=d).length,h=Array.from(r.values()).filter(_=>_.startTime>=f).length,m=Array.from(r.values()).filter(_=>_.pageViews<=1).length,v=i>0?m/i*100:0,g=new Map;r.forEach(_=>{const w=_.startTime.getHours();g.set(w,(g.get(w)||0)+1)});const x=Array.from({length:24},(_,w)=>({hour:w,session_count:g.get(w)||0}));return{total_sessions:i,avg_session_duration_minutes:Math.round(o*100)/100,avg_pages_per_session:Math.round(l*100)/100,sessions_last_7d:u,sessions_last_30d:h,bounce_rate:Math.round(v*100)/100,sessions_by_hour:x}}catch(t){return console.error("Error getting session analytics:",t),{total_sessions:0,avg_session_duration_minutes:0,avg_pages_per_session:0,sessions_last_7d:0,sessions_last_30d:0,bounce_rate:0,sessions_by_hour:[]}}})}static getSocialGraphMetrics(){return E(this,null,function*(){try{const{data:t}=yield T.from("user_relationships").eq("relationship_type","friend").eq("status","accepted").select("user_id, related_user_id, created_at"),{count:r}=yield T.from("users").select("*",{count:"exact",head:!0}),n=new Map,a=new Set;t==null||t.forEach(b=>{n.set(b.user_id,(n.get(b.user_id)||0)+1),n.set(b.related_user_id,(n.get(b.related_user_id)||0)+1),a.add(b.user_id),a.add(b.related_user_id)});const i=(t==null?void 0:t.length)||0,o=a.size,l=(r||0)-o,c=Array.from(n.values()).reduce((b,N)=>b+N,0),d=o>0?c/o:0,f=o>0?i/o:0,u=o>1?o*(o-1)/2:0,h=u>0?i/u*100:0,m=new Date,v=new Date(m);v.setDate(v.getDate()-30);const g=new Date(m);g.setDate(g.getDate()-60);const x=(t==null?void 0:t.filter(b=>new Date(b.created_at)>=v).length)||0,_=(t==null?void 0:t.filter(b=>{const N=new Date(b.created_at);return N>=g&&N<v}).length)||0,w=_>0?(x-_)/_*100:0;return{total_connections:i,avg_connections_per_user:Math.round(d*100)/100,users_with_connections:o,users_without_connections:l,connection_growth_rate:Math.round(w*100)/100,avg_connection_degree:Math.round(f*100)/100,network_density:Math.round(h*100)/100}}catch(t){return console.error("Error getting social graph metrics:",t),{total_connections:0,avg_connections_per_user:0,users_with_connections:0,users_without_connections:0,connection_growth_rate:0,avg_connection_degree:0,network_density:0}}})}static getSearchEffectiveness(){return E(this,null,function*(){try{const t=yield vs.getAllUserInteractions(),r=t.filter(_=>_.event_type==="search"),n=new Set(r.map(_=>_.user_id)),a=new Date,i=new Date(a);i.setDate(i.getDate()-7);const o=new Date(a);o.setDate(o.getDate()-30);const l=r.filter(_=>new Date(_.occurred_at)>=i).length,c=r.filter(_=>new Date(_.occurred_at)>=o).length,d=new Map;r.forEach(_=>{var N,S;const w=((N=_.metadata)==null?void 0:N.query)||((S=_.metadata)==null?void 0:S.search_query)||"unknown";d.has(w)||d.set(w,{count:0,clicks:0,interests:0,searchers:new Set});const b=d.get(w);b.count++,b.searchers.add(_.user_id)}),r.forEach(_=>{var C,A;const w=new Date(_.occurred_at),b=_.user_id,N=((C=_.metadata)==null?void 0:C.query)||((A=_.metadata)==null?void 0:A.search_query)||"unknown",S=new Date(w.getTime()+5*60*1e3),k=t.filter(R=>R.user_id===b&&new Date(R.occurred_at)>=w&&new Date(R.occurred_at)<=S&&(R.event_type==="click"||R.event_type==="interest"));if(k.length>0){const R=d.get(N);R&&k.forEach(I=>{I.event_type==="click"?R.clicks++:I.event_type==="interest"&&R.interests++})}});const f=Array.from(d.entries()).map(([_,w])=>({query:_,count:w.count,click_rate:w.count>0?w.clicks/w.count*100:0})).sort((_,w)=>w.count-_.count).slice(0,10),u=Array.from(d.values()).reduce((_,w)=>_+w.clicks,0),h=r.length>0?u/r.length*100:0,m=Array.from(d.values()).reduce((_,w)=>_+w.interests,0),v=r.length>0?m/r.length*100:0,g=new Map;r.forEach(_=>{var k;const w=((k=_.metadata)==null?void 0:k.category)||_.entity_type||"general";g.has(w)||g.set(w,{count:0,successes:0}),g.get(w).count++;const b=new Date(_.occurred_at),N=new Date(b.getTime()+5*60*1e3);t.some(C=>C.user_id===_.user_id&&new Date(C.occurred_at)>=b&&new Date(C.occurred_at)<=N&&(C.event_type==="click"||C.event_type==="interest"))&&g.get(w).successes++});const x=Array.from(g.entries()).map(([_,w])=>({category:_,count:w.count,success_rate:w.count>0?w.successes/w.count*100:0})).sort((_,w)=>w.count-_.count);return{total_searches:r.length,unique_searchers:n.size,searches_last_7d:l,searches_last_30d:c,search_to_click_rate:Math.round(h*100)/100,search_to_interest_rate:Math.round(v*100)/100,top_queries:f.map(_=>V(D({},_),{click_rate:Math.round(_.click_rate*100)/100})),searches_by_category:x.map(_=>V(D({},_),{success_rate:Math.round(_.success_rate*100)/100}))}}catch(t){return console.error("Error getting search effectiveness:",t),{total_searches:0,unique_searchers:0,searches_last_7d:0,searches_last_30d:0,search_to_click_rate:0,search_to_interest_rate:0,top_queries:[],searches_by_category:[]}}})}static exportAdminData(){return E(this,null,function*(){const[t,r,n,a,i,o,l,c,d,f,u,h,m,v]=yield Promise.all([this.getPlatformStats(),this.getUserGrowth(),this.getEngagementMetrics(),this.getContentMetrics(),this.getActiveUserMetrics(),this.getFeatureUsage(),this.getFeatureAdoptionFunnel(),this.getSessionAnalytics(),this.getSocialGraphMetrics(),this.getSearchEffectiveness(),this.getUserSegments(),this.getGeographicDistribution(),this.getAdminAchievements(),this.getNorthStarMetric()]);return{platformStats:t,userGrowth:r,engagementMetrics:n,contentMetrics:a,activeUserMetrics:i,featureUsage:o,featureAdoptionFunnel:l,sessionAnalytics:c,socialGraphMetrics:d,searchEffectiveness:f,userSegments:u,geographicDistribution:h,achievements:m,northStarMetric:v}})}}function e8e(){var R,I,O,z,M;const{isAdmin:e,accountInfo:t,loading:r}=hf(),{toast:n}=Er(),[a,i]=y.useState(!0),[o,l]=y.useState([]),[c,d]=y.useState([]),[f,u]=y.useState(null),[h,m]=y.useState(""),[v,g]=y.useState(!1),[x,_]=y.useState(null);y.useEffect(()=>{if(console.log(" AdminModerationPanel: useEffect triggered"),console.log(" AdminModerationPanel: accountLoading:",r),console.log(" AdminModerationPanel: accountInfo:",t),console.log(" AdminModerationPanel: isAdmin() check:",e()),r){console.log(" AdminModerationPanel: Account still loading, waiting...");return}e()?(console.log(" AdminModerationPanel: User is admin, calling loadFlags()"),w()):console.log(" AdminModerationPanel: User is NOT admin, skipping loadFlags()")},[r,t]);const w=()=>E(this,null,function*(){var B;i(!0);try{console.log(" AdminModerationPanel: Loading flags..."),console.log(" AdminModerationPanel: isAdmin() result:",e());const{data:F,error:U}=yield T.from("moderation_flags").select("id, flag_status, flag_reason, created_at").order("created_at",{ascending:!1});if(console.log(" AdminModerationPanel: All flags in database:",F),console.log(" AdminModerationPanel: All flags error:",U),F&&Array.isArray(F)){const X=F.reduce((se,de)=>(se[de.flag_status]=(se[de.flag_status]||0)+1,se),{});console.log(" AdminModerationPanel: Flags by status:",X)}console.log(" AdminModerationPanel: Trying direct pending flags query...");const{data:H,error:q}=yield T.from("moderation_flags").select("*").eq("flag_status","pending").order("created_at",{ascending:!0});console.log(" AdminModerationPanel: Direct pending flags query result:",H),console.log(" AdminModerationPanel: Direct pending flags query error:",q);let K=H||[];if(K.length>0){const X=K.map(de=>de.flagged_by_user_id);console.log(" AdminModerationPanel: Fetching profiles for pending flags user IDs:",X);const{data:se}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",X);console.log(" AdminModerationPanel: Profiles for pending flags:",se),K=K.map(de=>V(D({},de),{flagger:se==null?void 0:se.find(_e=>_e.user_id===de.flagged_by_user_id)}))}const{data:Z,error:ne}=yield T.from("moderation_flags").select("*").neq("flag_status","pending").order("reviewed_at",{ascending:!1});console.log(" AdminModerationPanel: Reviewed flags from DB:",Z),console.log(" AdminModerationPanel: Reviewed flags error:",ne);let Y=Z||[];if(Y.length>0){const X=Y.map(de=>de.flagged_by_user_id);console.log(" AdminModerationPanel: Fetching profiles for reviewed flags user IDs:",X);const{data:se}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",X);console.log(" AdminModerationPanel: Profiles for reviewed flags:",se),Y=Y.map(de=>V(D({},de),{flagger:se==null?void 0:se.find(_e=>_e.user_id===de.flagged_by_user_id)}))}console.log(" AdminModerationPanel: Raw pending flags response:",K),console.log(" AdminModerationPanel: Raw reviewed flags response:",Y),console.log(" AdminModerationPanel: Pending flags type:",typeof K),console.log(" AdminModerationPanel: Pending flags is array:",Array.isArray(K)),console.log(" AdminModerationPanel: Pending flags length:",(K==null?void 0:K.length)||"undefined"),console.log(" AdminModerationPanel: Reviewed flags length:",(Y==null?void 0:Y.length)||"undefined"),K&&Array.isArray(K)&&(console.log(" AdminModerationPanel: Individual pending flags:"),K.forEach((X,se)=>{console.log(`  [${se}] Flag ID: ${X.id}, Status: ${X.flag_status}, Reason: ${X.flag_reason}`)})),l(K),d(Y.slice(0,20)),console.log(" AdminModerationPanel: State updated - pendingFlags.length:",(K==null?void 0:K.length)||0),console.log(" AdminModerationPanel: State updated - reviewedFlags.length:",((B=Y==null?void 0:Y.slice(0,20))==null?void 0:B.length)||0)}catch(F){console.error(" AdminModerationPanel: Error loading flags:",F),console.error(" AdminModerationPanel: Error details:",JSON.stringify(F,null,2)),n({title:"Error",description:"Failed to load moderation flags",variant:"destructive"})}finally{i(!1),console.log(" AdminModerationPanel: Loading completed")}}),b=B=>E(this,null,function*(){try{const F=yield Qu.getFlaggedContentDetails(B.content_type,B.content_id);_(F)}catch(F){console.error("Error loading content preview:",F),_(null)}}),N=B=>{u(B),m(""),b(B)},S=B=>E(this,null,function*(){if(f){g(!0);try{yield Qu.moderateContent(f.id,B,h.trim()||void 0,!0),n({title:"Content Moderated",description:`Successfully ${B==="remove"?"removed":B==="warn"?"warned about":"dismissed"} the flagged content`}),u(null),_(null),m(""),w()}catch(F){console.error("Error moderating content:",F),n({title:"Error",description:"Failed to moderate content",variant:"destructive"})}finally{g(!1)}}}),k=B=>new Date(B).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),C=B=>{const F={pending:"default",resolved:"secondary",dismissed:"outline"};return s.jsx(et,{variant:F[B]||"default",className:"capitalize",children:B})},A=({flag:B,onClick:F,isSelected:U})=>{var H,q,K;return s.jsx(Ze,{className:`cursor-pointer transition-all hover:shadow-md ${U?"border-purple-500 bg-purple-50":""}`,onClick:()=>F(B),children:s.jsx(tt,{className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-2xl",children:((H=Rh[B.flag_reason])==null?void 0:H.icon)||""}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-semibold text-sm",children:((q=Rh[B.flag_reason])==null?void 0:q.label)||B.flag_reason}),s.jsx("p",{className:"text-xs text-gray-600 capitalize",children:Qu.getContentTypeDisplayName(B.content_type)})]})]}),B.flag_details&&s.jsxs("p",{className:"text-sm text-gray-700 line-clamp-2 mb-2",children:['"',B.flag_details,'"']}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[s.jsxs("span",{children:["By ",((K=B.flagger)==null?void 0:K.name)||"Unknown"]}),s.jsx("span",{children:""}),s.jsx("span",{children:k(B.created_at)})]})]}),C(B.flag_status)]})})})};return e()?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Content Moderation"}),s.jsx("p",{className:"text-gray-600",children:"Review and moderate flagged content"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs(zi,{defaultValue:"pending",children:[s.jsxs(wi,{className:"w-full",children:[s.jsxs(en,{value:"pending",className:"flex-1",children:["Pending (",o.length,")"]}),s.jsx(en,{value:"reviewed",className:"flex-1",children:"Reviewed"})]}),s.jsx(tn,{value:"pending",className:"space-y-3 mt-4",children:a?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(fr,{className:"h-8 w-8 animate-spin text-purple-600"})}):o.length===0?s.jsx(Ze,{className:"border-dashed border-2 border-gray-200",children:s.jsxs(tt,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(eo,{className:"h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Pending Flags"}),s.jsx("p",{className:"text-sm text-gray-500 text-center max-w-sm",children:"There are no content flags waiting for review. Great job keeping the community safe! "})]})}):o.map(B=>s.jsx(A,{flag:B,onClick:N,isSelected:(f==null?void 0:f.id)===B.id},B.id))}),s.jsx(tn,{value:"reviewed",className:"space-y-3 mt-4",children:c.length===0?s.jsx(Ze,{className:"border-dashed border-2 border-gray-200",children:s.jsxs(tt,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(eo,{className:"h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Reviewed Flags"}),s.jsx("p",{className:"text-sm text-gray-500 text-center max-w-sm",children:"No content flags have been reviewed yet. This is where completed moderation actions will appear."})]})}):c.map(B=>s.jsx(A,{flag:B,onClick:N,isSelected:!1},B.id))})]})}),s.jsx("div",{className:"lg:col-span-2",children:f?s.jsxs(Ze,{children:[s.jsxs(kr,{children:[s.jsx(Lr,{children:"Review Flagged Content"}),s.jsx(zo,{children:(R=Rh[f.flag_reason])==null?void 0:R.description})]}),s.jsxs(tt,{className:"space-y-4",children:[s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(eo,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-semibold text-red-900",children:(I=Rh[f.flag_reason])==null?void 0:I.label}),s.jsx("p",{className:"text-sm text-red-800 mt-1",children:f.flag_details}),s.jsxs("p",{className:"text-xs text-red-700 mt-2",children:["Reported by ",(O=f.flagger)==null?void 0:O.name," on ",k(f.created_at)]})]})]})}),x&&s.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[s.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[s.jsx(Jd,{className:"h-4 w-4"}),"Content Preview"]}),s.jsxs("div",{className:"text-sm space-y-2",children:[f.content_type==="event"&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Title:"})," ",x.title]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Artist:"})," ",x.artist_name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Description:"})," ",x.description]})]}),f.content_type==="review"&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"By:"})," ",(z=x.user)==null?void 0:z.name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Rating:"})," ",x.rating,"/5"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Review:"})," ",x.review]})]}),f.content_type==="comment"&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"By:"})," ",(M=x.user)==null?void 0:M.name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Comment:"})," ",x.comment]})]})]})]}),f.flag_status==="pending"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Review Notes (Optional)"}),s.jsx(_s,{placeholder:"Add notes about your decision...",value:h,onChange:B=>m(B.target.value),disabled:v,rows:3})]}),f.flag_status==="pending"?s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(ce,{variant:"destructive",onClick:()=>S("remove"),disabled:v,className:"flex-1",children:[v?s.jsx(fr,{className:"h-4 w-4 mr-2 animate-spin"}):s.jsx(Ko,{className:"h-4 w-4 mr-2"}),"Remove Content"]}),s.jsxs(ce,{variant:"outline",onClick:()=>S("warn"),disabled:v,className:"flex-1 border-yellow-500 text-yellow-700 hover:bg-yellow-50",children:[s.jsx(BP,{className:"h-4 w-4 mr-2"}),"Warn User"]}),s.jsxs(ce,{variant:"outline",onClick:()=>S("dismiss"),disabled:v,className:"flex-1",children:[s.jsx(Yr,{className:"h-4 w-4 mr-2"}),"Dismiss"]})]}):s.jsxs("div",{className:"bg-gray-100 rounded-lg p-4",children:[s.jsx("p",{className:"font-semibold",children:"This flag has been reviewed"}),f.action_taken&&s.jsxs("p",{className:"text-sm text-gray-700 mt-1",children:["Action taken: ",s.jsx("span",{className:"font-medium capitalize",children:f.action_taken})]}),f.review_notes&&s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:f.review_notes})]})]})]}):s.jsx(Ze,{children:s.jsxs(tt,{className:"py-12 text-center",children:[s.jsx(eo,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"Select a flag to review"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Choose a flagged content item from the list to begin moderation"})]})})})]})]}):s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsx("p",{className:"text-gray-600",children:"Access denied. Admin privileges required."})})}function t8e({currentUserId:e}){const[t,r]=y.useState([]),[n,a]=y.useState([]),[i,o]=y.useState(!0),[l,c]=y.useState(null),[d,f]=y.useState(""),[u,h]=y.useState("all"),[m,v]=y.useState("score"),{toast:g}=Er();y.useEffect(()=>{x()},[]),y.useEffect(()=>{let N=[...t];d&&(N=N.filter(S=>S.name.toLowerCase().includes(d.toLowerCase()))),u!=="all"&&(N=N.filter(S=>u==="verified"?S.verified:!S.verified)),N.sort((S,k)=>m==="score"?(k.trust_score||0)-(S.trust_score||0):new Date(k.created_at).getTime()-new Date(S.created_at).getTime()),a(N)},[t,d,u,m]);const x=()=>E(this,null,function*(){try{o(!0);const N=yield aw.getUsersNearVerification(50);r(N)}catch(N){console.error("Error fetching users:",N),g({title:"Error",description:"Failed to load users near verification.",variant:"destructive"})}finally{o(!1)}}),_=(N,S)=>E(this,null,function*(){try{c(N),yield aw.manuallyVerifyUser(N,e,S),g({title:"Success",description:`User ${S?"verified":"unverified"} successfully.`}),yield x()}catch(k){console.error("Error verifying user:",k),g({title:"Error",description:"Failed to update user verification status.",variant:"destructive"})}finally{c(null)}}),w=N=>N?Object.values(N).filter(Boolean).length:0,b=()=>{const N=[["Name","Trust Score","Criteria Met","Verified","Account Age","Created At"].join(","),...n.map(A=>[A.name,A.trust_score||0,`${w(A.verification_criteria_met)}/8`,A.verified?"Yes":"No",Math.floor((Date.now()-new Date(A.created_at).getTime())/864e5),new Date(A.created_at).toLocaleDateString()].join(","))].join(`
`),S=new Blob([N],{type:"text/csv"}),k=window.URL.createObjectURL(S),C=document.createElement("a");C.href=k,C.download=`verification-stats-${new Date().toISOString().split("T")[0]}.csv`,C.click(),window.URL.revokeObjectURL(k)};return i?s.jsxs(Ze,{children:[s.jsxs(kr,{children:[s.jsx(Lr,{children:"Verification Management"}),s.jsx(zo,{children:"Manage user verification requests"})]}),s.jsx(tt,{children:s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(Ze,{children:[s.jsxs(kr,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs(Lr,{className:"flex items-center gap-2",children:[s.jsx(qn,{className:"w-5 h-5"}),"Verification Management"]}),s.jsx(zo,{children:"Users close to verification threshold (40%+ trust score)"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ce,{variant:"outline",size:"sm",onClick:b,disabled:n.length===0,children:[s.jsx(pp,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),s.jsxs(ce,{variant:"outline",size:"sm",onClick:x,disabled:i,children:[s.jsx(vi,{className:`w-4 h-4 mr-2 ${i?"animate-spin":""}`}),"Refresh"]})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Ho,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx(Nr,{placeholder:"Search by name...",value:d,onChange:N=>f(N.target.value),className:"pl-10"})]}),s.jsxs(aa,{value:u,onValueChange:N=>h(N),children:[s.jsxs(Gs,{className:"w-[180px]",children:[s.jsx(qy,{className:"w-4 h-4 mr-2"}),s.jsx(ia,{placeholder:"Filter status"})]}),s.jsxs(Ys,{children:[s.jsx(Bt,{value:"all",children:"All Users"}),s.jsx(Bt,{value:"verified",children:"Verified"}),s.jsx(Bt,{value:"unverified",children:"Unverified"})]})]}),s.jsxs(aa,{value:m,onValueChange:N=>v(N),children:[s.jsx(Gs,{className:"w-[180px]",children:s.jsx(ia,{placeholder:"Sort by"})}),s.jsxs(Ys,{children:[s.jsx(Bt,{value:"score",children:"Trust Score"}),s.jsx(Bt,{value:"date",children:"Join Date"})]})]})]})]}),s.jsx(tt,{children:n.length===0?s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:t.length===0?"No users near verification threshold":"No users match your filters"})}):s.jsx("div",{className:"space-y-4",children:n.map(N=>{const S=w(N.verification_criteria_met),k=8,C=l===N.user_id;return s.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsxs(Wr,{className:"w-12 h-12",children:[s.jsx(Qr,{src:N.avatar_url||void 0}),s.jsx(Hr,{children:N.name.charAt(0).toUpperCase()})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h4",{className:"font-semibold truncate",children:N.name}),N.verified&&s.jsx(et,{variant:"default",className:"text-xs",children:"Verified"}),s.jsx(et,{variant:"secondary",className:"text-xs",children:N.account_type})]}),s.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Trust Score: ",N.trust_score,"%"]}),s.jsxs("span",{children:["Criteria: ",S,"/",k]}),s.jsxs("span",{children:["Member since ",Rt(new Date(N.created_at),"MMM yyyy")]})]}),s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:N.verification_criteria_met&&Object.entries(N.verification_criteria_met).map(([A,R])=>R?s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:A},A):null)})]}),s.jsx("div",{className:"flex items-center gap-2",children:N.verified?s.jsx(ce,{variant:"outline",size:"sm",onClick:()=>_(N.user_id,!1),disabled:C,children:C?s.jsx(vi,{className:"w-4 h-4 animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(ZF,{className:"w-4 h-4 mr-2"}),"Unverify"]})}):s.jsx(ce,{variant:"default",size:"sm",onClick:()=>_(N.user_id,!0),disabled:C,children:C?s.jsx(vi,{className:"w-4 h-4 animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(pc,{className:"w-4 h-4 mr-2"}),"Verify"]})})})]},N.id)})})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(Ze,{children:s.jsx(tt,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-primary",children:t.length}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Near Verification"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"40%+ trust score"})]})})}),s.jsx(Ze,{children:s.jsx(tt,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600",children:t.filter(N=>N.verified).length}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Verified"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:t.length>0?`${Math.round(t.filter(N=>N.verified).length/t.length*100)}% conversion`:"0% conversion"})]})})}),s.jsx(Ze,{children:s.jsx(tt,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-amber-600",children:t.filter(N=>!N.verified).length}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Pending Review"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Awaiting criteria"})]})})}),s.jsx(Ze,{children:s.jsx(tt,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[Math.round(t.reduce((N,S)=>N+S.trust_score,0)/t.length)||0,"%"]}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Avg Trust Score"}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Range: ",Math.min(...t.map(N=>N.trust_score)),"% - ",Math.max(...t.map(N=>N.trust_score)),"%"]})]})})})]})]})}function r8e(){go("view","analytics_admin",{dashboard_type:"admin"});const{user:e}=ws(),[t,r]=y.useState(!0),[n,a]=y.useState(null),[i,o]=y.useState([]),[l,c]=y.useState(null),[d,f]=y.useState(null),[u,h]=y.useState([]),[m,v]=y.useState([]),[g,x]=y.useState([]),[_,w]=y.useState(null),[b,N]=y.useState([]),[S,k]=y.useState([]),[C,A]=y.useState([]),[R,I]=y.useState(null),[O,z]=y.useState(null),[M,B]=y.useState([]),[F,U]=y.useState([]),[H,q]=y.useState(null),[K,Z]=y.useState(null),[ne,Y]=y.useState(null),[X,se]=y.useState("overview"),de=Q=>{try{Rr(()=>E(this,null,function*(){const{trackInteraction:oe}=yield Promise.resolve().then(()=>Zy);return{trackInteraction:oe}}),void 0,import.meta.url).then(({trackInteraction:oe})=>{oe.click("view",`analytics_tab_${Q}`,{tab:Q,dashboard_type:"admin"})})}catch(oe){console.error("Error tracking tab switch:",oe)}se(Q)};y.useEffect(()=>{console.log(" AdminAnalyticsDashboard: activeTab changed to:",X)},[X]),y.useEffect(()=>{e&&_e()},[e]);const _e=()=>E(this,null,function*(){if(e)try{r(!0);const[Q,oe,ie,ee,G,J,ae,fe,we,ve,me,Me,Te,Ve,le,Ke,De,nt]=yield Promise.all([Fs.getPlatformStats(),Fs.getUserGrowth(),Fs.getEngagementMetrics(),Fs.getContentMetrics(),Fs.getUserSegments(),Fs.getGeographicDistribution(),Fs.getAdminAchievements(),Fs.getNorthStarMetric(),Fs.getDAUOverTime(30),Fs.getMAUOverTime(12),Fs.getNewUsersOverTime(30),Fs.getUserStats(),Fs.getActiveUserMetrics(),Fs.getFeatureUsage(),Fs.getFeatureAdoptionFunnel(),Fs.getSessionAnalytics(),Fs.getSocialGraphMetrics(),Fs.getSearchEffectiveness()]);a(Q),o(oe),c(ie),f(ee),h(G),v(J),x(ae),w(fe),N(we),k(ve),A(me),I(Me),z(Te),B(Ve),U(le),q(Ke),Z(De),Y(nt)}catch(Q){console.error("Error fetching admin data:",Q)}finally{r(!1)}}),xe=()=>E(this,null,function*(){if(e)try{const Q=yield Fs.exportAdminData(),oe=new Blob([JSON.stringify(Q,null,2)],{type:"application/json"}),ie=URL.createObjectURL(oe),ee=document.createElement("a");ee.href=ie,ee.download=`admin-analytics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),URL.revokeObjectURL(ie)}catch(Q){console.error("Error exporting data:",Q)}});return t?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsx(ro,{})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((Q,oe)=>s.jsx(ro,{},oe))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(ro,{}),s.jsx(ro,{})]})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(wl,{className:"w-8 h-8 text-red-600"}),s.jsx("h1",{className:"gradient-text text-3xl font-bold",children:"Admin Analytics"})]}),s.jsx("p",{className:"text-gray-600",children:"Platform-wide analytics, system health, and business intelligence"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:xe,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[s.jsx(pp,{className:"w-4 h-4"}),"Export Data"]}),s.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-red-600 to-orange-600 text-white rounded-lg hover:from-red-700 hover:to-orange-700 transition-all",children:"System Settings"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(di,{title:"North Star: ECI/U",value:(_==null?void 0:_.eci_per_user)||0,icon:s.jsx(Ji,{className:"w-6 h-6"}),trend:(_==null?void 0:_.monthly_growth_rate)>0?"up":(_==null?void 0:_.monthly_growth_rate)<0?"down":"neutral",subtitle:"concert intents per user"}),s.jsx(di,{title:"Total Users",value:(n==null?void 0:n.total_users)||0,icon:s.jsx(Vr,{className:"w-6 h-6"}),trend:(n==null?void 0:n.platform_growth_rate)>0?"up":(n==null?void 0:n.platform_growth_rate)<0?"down":"neutral"}),s.jsx(di,{title:"Daily Active Users",value:(n==null?void 0:n.daily_active_users)||0,icon:s.jsx(No,{className:"w-6 h-6"}),subtitle:"active today"}),s.jsx(di,{title:"Monthly Active Users",value:(n==null?void 0:n.monthly_active_users)||0,icon:s.jsx(qn,{className:"w-6 h-6"}),subtitle:"last 30 days"}),s.jsx(di,{title:"Active Users (10+ interactions)",value:(O==null?void 0:O.total_active_users)||0,icon:s.jsx(Fg,{className:"w-6 h-6"}),subtitle:"users with 10+ interactions"}),s.jsx(di,{title:"Total Events",value:(n==null?void 0:n.total_events)||0,icon:s.jsx(Lt,{className:"w-6 h-6"}),trend:(d==null?void 0:d.content_growth_rate)>0?"up":(d==null?void 0:d.content_growth_rate)<0?"down":"neutral",subtitle:"events this month"})]}),s.jsx("div",{className:"mb-8",children:s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:qd},{id:"users",label:"Users",icon:Vr},{id:"active-users",label:"Active Users",icon:Fg},{id:"content",label:"Content",icon:Lt},{id:"moderation",label:"Moderation",icon:eo},{id:"achievements",label:"Achievements",icon:Vd}].map(Q=>s.jsxs("button",{onClick:()=>{console.log(" AdminAnalyticsDashboard: Tab clicked:",Q.id),de(Q.id)},className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${X===Q.id?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(Q.icon,{className:"w-4 h-4"}),Q.label]},Q.id))})})}),X==="overview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gradient-to-r from-pink-50 to-red-50 rounded-xl p-6 shadow-sm border border-pink-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-gradient-to-r from-pink-500 to-red-500 rounded-lg",children:s.jsx(Ji,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"North Star Metric"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Engaged Concert Intent per User (ECI/U)"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-pink-600 mb-1",children:(_==null?void 0:_.eci_per_user)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Average ECI per User"}),s.jsx("div",{className:"text-xs text-gray-500",children:"This month"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:(_==null?void 0:_.total_engaged_users)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Engaged Users"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Active this month"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600 mb-1",children:(_==null?void 0:_.total_concert_intents)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Total Concert Intents"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Saves + RSVPs + Shares"})]})]}),s.jsxs("div",{className:"mt-6 pt-6 border-t border-pink-200",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Intent Breakdown"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[s.jsx("div",{className:"text-lg font-semibold text-pink-600",children:(_==null?void 0:_.breakdown.saves)||0}),s.jsx("div",{className:"text-xs text-gray-600",children:"Saves"})]}),s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[s.jsx("div",{className:"text-lg font-semibold text-blue-600",children:(_==null?void 0:_.breakdown.rsvps)||0}),s.jsx("div",{className:"text-xs text-gray-600",children:"RSVPs"})]}),s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[s.jsx("div",{className:"text-lg font-semibold text-purple-600",children:(_==null?void 0:_.breakdown.shares)||0}),s.jsx("div",{className:"text-xs text-gray-600",children:"Shares"})]})]})]}),(_==null?void 0:_.top_engaged_users)&&_.top_engaged_users.length>0&&s.jsxs("div",{className:"mt-6 pt-6 border-t border-pink-200",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Engaged Users"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:_.top_engaged_users.slice(0,6).map((Q,oe)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-pink-400 to-red-400 rounded-full flex items-center justify-center text-white text-xs font-bold",children:oe+1}),s.jsx("span",{className:"text-sm font-medium text-gray-900 truncate",children:Q.user_name})]}),s.jsxs("div",{className:"text-sm font-semibold text-pink-600",children:[Q.eci_score," ECI"]})]},Q.user_id))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Jd,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Page Views"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(l==null?void 0:l.total_page_views)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ho,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Searches"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:(l==null?void 0:l.searches_performed)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Xt,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"Reviews"})]}),s.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:(l==null?void 0:l.reviews_written)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(zl,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Ticket Clicks"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:(l==null?void 0:l.tickets_clicked)||0})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(e2,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Feature Usage"})]}),M.length>0?s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Feature"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Category"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Total Uses"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Unique Users"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Last 7d"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Last 30d"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Growth"})]})}),s.jsx("tbody",{children:M.slice(0,15).map((Q,oe)=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:Q.feature_name}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs bg-purple-100 text-purple-700",children:Q.feature_category})}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Q.total_uses.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Q.unique_users.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Q.uses_last_7d.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Q.uses_last_30d.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("span",{className:`font-semibold ${Q.growth_rate>0?"text-green-600":Q.growth_rate<0?"text-red-600":"text-gray-600"}`,children:[Q.growth_rate>0?"+":"",Q.growth_rate.toFixed(1),"%"]})})]},Q.feature_name))})]})})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(e2,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No feature usage data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(Ji,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Feature Adoption Funnel"})]}),F.length>0?s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Feature"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Discovery"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Trial"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Adoption"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Retention"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"DiscoveryTrial"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"TrialAdoption"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"AdoptionRetention"})]})}),s.jsx("tbody",{children:F.map(Q=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:Q.feature_name}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Q.discovery_count.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Q.trial_count.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Q.adoption_count.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Q.retention_count.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("span",{className:"font-semibold text-blue-600",children:[Q.discovery_to_trial_rate.toFixed(1),"%"]})}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("span",{className:"font-semibold text-green-600",children:[Q.trial_to_adoption_rate.toFixed(1),"%"]})}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("span",{className:"font-semibold text-purple-600",children:[Q.adoption_to_retention_rate.toFixed(1),"%"]})})]},Q.feature_name))})]})})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ji,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No feature adoption data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(Ho,{className:"w-5 h-5 text-green-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Search Effectiveness"})]}),ne?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Total Searches"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:ne.total_searches.toLocaleString()})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"SearchClick Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[ne.search_to_click_rate.toFixed(1),"%"]})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-purple-900 mb-1",children:"SearchInterest Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[ne.search_to_interest_rate.toFixed(1),"%"]})]}),s.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-orange-900 mb-1",children:"Unique Searchers"}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:ne.unique_searchers.toLocaleString()})]})]}),ne.top_queries.length>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Search Queries"}),s.jsx("div",{className:"space-y-2",children:ne.top_queries.slice(0,10).map((Q,oe)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-green-400 to-blue-400 rounded-full flex items-center justify-center text-white text-xs font-bold",children:oe+1}),s.jsx("span",{className:"font-medium text-gray-900",children:Q.query})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[Q.count," searches"]}),s.jsxs("span",{className:"text-sm font-semibold text-green-600",children:[Q.click_rate.toFixed(1),"% click rate"]})]})]},oe))})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ho,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No search data available"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Segments"}),u.length>0?s.jsx("div",{className:"space-y-3",children:u.map(Q=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:Q.segment}),s.jsxs("p",{className:"text-sm text-gray-500",children:[Q.avg_sessions," avg sessions"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:Q.count}),s.jsxs("p",{className:"text-sm text-gray-500",children:[Q.percentage,"%"]})]})]},Q.segment))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Vr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No user segment data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Geographic Distribution"}),m.length>0?s.jsx("div",{className:"space-y-3",children:m.slice(0,5).map(Q=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:Q.country}),s.jsxs("p",{className:"text-sm text-gray-500",children:[Q.events," events"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:Q.users}),s.jsx("p",{className:"text-sm text-gray-500",children:"users"})]})]},Q.country))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Xi,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]})]})]}),X==="users"&&s.jsxs("div",{className:"space-y-6",children:[R&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Vr,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:R.total_users.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"All registered users"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Fg,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Verified Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:R.verified_users.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:R.total_users>0?`${Math.round(R.verified_users/R.total_users*100)}% verified`:"0% verified"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(No,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Active (7d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:R.active_users_7d.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Active in last 7 days"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Id,{className:"w-4 h-4 text-pink-600"}),s.jsx("span",{className:"text-sm font-medium text-pink-600",children:"New (7d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-pink-900",children:R.new_users_7d.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"New users this week"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(qn,{className:"w-4 h-4 text-orange-600"}),s.jsx("span",{className:"text-sm font-medium text-orange-600",children:"Active (30d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:R.active_users_30d.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Active in last 30 days"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Xt,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"With Reviews"})]}),s.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:R.users_with_reviews.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Users who wrote reviews"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(es,{className:"w-4 h-4 text-red-600"}),s.jsx("span",{className:"text-sm font-medium text-red-600",children:"With Friends"})]}),s.jsx("p",{className:"text-2xl font-bold text-red-900",children:R.users_with_friends.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Users with connections"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Lt,{className:"w-4 h-4 text-indigo-600"}),s.jsx("span",{className:"text-sm font-medium text-indigo-600",children:"Avg Account Age"})]}),s.jsx("p",{className:"text-2xl font-bold text-indigo-900",children:Math.round(R.avg_account_age_days)}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Days since registration"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Daily Active Users (DAU)"}),s.jsx(No,{className:"w-5 h-5 text-blue-600"})]}),b.length>0?s.jsx(oc,{width:"100%",height:300,children:s.jsxs(q$,{data:b,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"dauGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),s.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),s.jsx(fl,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ai,{dataKey:"date",stroke:"#6b7280",tickFormatter:Q=>{const oe=new Date(Q);return`${oe.getMonth()+1}/${oe.getDate()}`}}),s.jsx(ii,{stroke:"#6b7280"}),s.jsx(ta,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},labelFormatter:Q=>new Date(Q).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),s.jsx(Bc,{type:"monotone",dataKey:"value",stroke:"#3b82f6",fillOpacity:1,fill:"url(#dauGradient)",name:"Active Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(No,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No DAU data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Monthly Active Users (MAU)"}),s.jsx(qn,{className:"w-5 h-5 text-green-600"})]}),S.length>0?s.jsx(oc,{width:"100%",height:300,children:s.jsxs(U$,{data:S,children:[s.jsx(fl,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ai,{dataKey:"date",stroke:"#6b7280",tickFormatter:Q=>{const[oe,ie]=Q.split("-");return`${ie}/${oe.slice(2)}`}}),s.jsx(ii,{stroke:"#6b7280"}),s.jsx(ta,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},labelFormatter:Q=>{const[oe,ie]=Q.split("-");return new Date(parseInt(oe),parseInt(ie)-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}}),s.jsx(rp,{type:"monotone",dataKey:"value",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",r:4},name:"Active Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(qn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No MAU data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"New Users Over Time"}),s.jsx(Id,{className:"w-5 h-5 text-pink-600"})]}),C.length>0?s.jsx(oc,{width:"100%",height:300,children:s.jsxs(Hg,{data:C,children:[s.jsx(fl,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ai,{dataKey:"date",stroke:"#6b7280",tickFormatter:Q=>{const oe=new Date(Q);return`${oe.getMonth()+1}/${oe.getDate()}`}}),s.jsx(ii,{stroke:"#6b7280"}),s.jsx(ta,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},labelFormatter:Q=>new Date(Q).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),s.jsx(Mi,{dataKey:"value",fill:"#ec4899",radius:[8,8,0,0],name:"New Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Id,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No new users data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"User Geography"}),s.jsx(Xi,{className:"w-5 h-5 text-indigo-600"})]}),m.length>0?s.jsxs("div",{className:"space-y-4",children:[s.jsx(oc,{width:"100%",height:300,children:s.jsxs(Hg,{data:m.slice(0,10),layout:"vertical",children:[s.jsx(fl,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ai,{type:"number",stroke:"#6b7280"}),s.jsx(ii,{type:"category",dataKey:"city",stroke:"#6b7280",width:120}),s.jsx(ta,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:Q=>[Q.toLocaleString(),"Users"]}),s.jsx(Mi,{dataKey:"users",fill:"#6366f1",radius:[0,8,8,0],name:"Users"})]})}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Cities by User Count"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:m.slice(0,12).map((Q,oe)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-indigo-400 to-purple-400 rounded-full flex items-center justify-center text-white text-xs font-bold",children:oe+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:Q.city||"Unknown"}),s.jsx("p",{className:"text-xs text-gray-500",children:Q.country})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:Q.users.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500",children:"users"})]})]},`${Q.city||"Unknown"}-${Q.country}-${oe}`))})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Xi,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Segmentation"}),u.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Segment"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Count"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Percentage"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Avg Sessions"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Retention"})]})}),s.jsx("tbody",{children:u.map(Q=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:Q.segment}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Q.count}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[Q.percentage,"%"]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Q.avg_sessions}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[Q.retention_rate,"%"]})]},Q.segment))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Hb,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No user segment data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(No,{className:"w-5 h-5 text-indigo-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Session Analytics"})]}),H?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Total Sessions"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:H.total_sessions.toLocaleString()}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"All time"})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Avg Duration"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[H.avg_session_duration_minutes.toFixed(1)," min"]}),s.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Per session"})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-purple-900 mb-1",children:"Avg Pages"}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:H.avg_pages_per_session.toFixed(1)}),s.jsx("p",{className:"text-xs text-purple-700 mt-1",children:"Per session"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-orange-900 mb-1",children:"Sessions (7d)"}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:H.sessions_last_7d.toLocaleString()})]}),s.jsxs("div",{className:"bg-pink-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-pink-900 mb-1",children:"Sessions (30d)"}),s.jsx("p",{className:"text-2xl font-bold text-pink-900",children:H.sessions_last_30d.toLocaleString()})]}),s.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-red-900 mb-1",children:"Bounce Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-red-900",children:[H.bounce_rate.toFixed(1),"%"]}),s.jsx("p",{className:"text-xs text-red-700 mt-1",children:"1 page view only"})]})]}),H.sessions_by_hour.length>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Sessions by Hour of Day"}),s.jsx(oc,{width:"100%",height:250,children:s.jsxs(Hg,{data:H.sessions_by_hour,children:[s.jsx(fl,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ai,{dataKey:"hour",stroke:"#6b7280",tickFormatter:Q=>`${Q%24}:00`}),s.jsx(ii,{stroke:"#6b7280"}),s.jsx(ta,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},labelFormatter:Q=>`${Q}:00`,formatter:Q=>[Q.toLocaleString(),"Sessions"]}),s.jsx(Mi,{dataKey:"session_count",fill:"#6366f1",radius:[8,8,0,0],name:"Sessions"})]})})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(No,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No session data available"})]})]})]}),X==="content"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Lt,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Events"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(d==null?void 0:d.total_events)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Vr,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Total Artists"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:(d==null?void 0:d.total_artists)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(uf,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Total Venues"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:(d==null?void 0:d.total_venues)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Xt,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"Avg Rating"})]}),s.jsxs("p",{className:"text-2xl font-bold text-yellow-900",children:[(d==null?void 0:d.average_event_rating)||0,"/5"]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Content Statistics"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Events This Month"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(d==null?void 0:d.events_this_month)||0}),s.jsx("p",{className:"text-xs text-blue-700",children:"New events added"})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Total Reviews"}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:(d==null?void 0:d.total_reviews)||0}),s.jsx("p",{className:"text-xs text-green-700",children:"User reviews written"})]})]})]})]}),X==="achievements"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[s.jsx(Vd,{className:"w-8 h-8 text-yellow-500"}),s.jsx("h2",{className:"gradient-text text-2xl font-bold",children:"Platform Achievements"})]}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Track your platform milestones and growth metrics"})]}),["users","content","platform"].map(Q=>{const oe=g.filter(ee=>ee.category===Q),ie={users:"User Growth",content:"Content Creation",platform:"Platform Engagement"};return s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Mc,{className:"w-5 h-5 text-red-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ie[Q]})]}),oe.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:oe.map(ee=>s.jsx(TA,{name:ee.name,description:ee.description,icon:ee.icon,progress:ee.progress,goal:ee.goal,unlocked:ee.unlocked,unlockedAt:ee.unlockedAt,compact:!0},ee.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Mc,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No achievements in this category yet"})]})]},Q)})]}),X==="active-users"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Fg,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Active Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(O==null?void 0:O.total_active_users)||0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"10+ interactions"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(No,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Active (7d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:(O==null?void 0:O.active_users_7d)||0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Last 7 days"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(qn,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Active (30d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:(O==null?void 0:O.active_users_30d)||0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Last 30 days"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ji,{className:"w-4 h-4 text-orange-600"}),s.jsx("span",{className:"text-sm font-medium text-orange-600",children:"Avg Interactions"})]}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:(O==null?void 0:O.avg_interactions_per_active_user)||0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Per active user"})]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-xl p-6 shadow-sm border border-green-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(pc,{className:"w-6 h-6 text-green-600"}),s.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Verification Statistics"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600 mb-1",children:(O==null?void 0:O.verification_stats.total_verified)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Verified Users"}),s.jsx("div",{className:"text-xs text-gray-500",children:(O==null?void 0:O.total_active_users)>0?`${Math.round(O.verification_stats.total_verified/O.total_active_users*100)}% of active users`:"0%"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:[(O==null?void 0:O.verification_stats.avg_trust_score)||0,"%"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Avg Trust Score"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Across active users"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold text-purple-600 mb-1",children:[(O==null?void 0:O.verification_stats.avg_verification_progress)||0,"/8"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Avg Progress"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Criteria met"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-1",children:(O==null?void 0:O.verification_stats.users_near_verification)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Near Verification"}),s.jsx("div",{className:"text-xs text-gray-500",children:"40%+ trust score"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(es,{className:"w-5 h-5 text-pink-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Social Graph Metrics"})]}),K?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-pink-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-pink-900 mb-1",children:"Total Connections"}),s.jsx("p",{className:"text-2xl font-bold text-pink-900",children:K.total_connections.toLocaleString()}),s.jsx("p",{className:"text-xs text-pink-700 mt-1",children:"Friendships"})]}),s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Avg Connections"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:K.avg_connections_per_user.toFixed(1)}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Per user"})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Network Density"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[K.network_density.toFixed(2),"%"]}),s.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Connectedness"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-purple-900 mb-1",children:"With Connections"}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:K.users_with_connections.toLocaleString()})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Without Connections"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:K.users_without_connections.toLocaleString()})]}),s.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-orange-900 mb-1",children:"Avg Degree"}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:K.avg_connection_degree.toFixed(1)})]}),s.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-indigo-900 mb-1",children:"Growth Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-indigo-900",children:[K.connection_growth_rate>0?"+":"",K.connection_growth_rate.toFixed(1),"%"]})]})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(es,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No social graph data available"})]})]}),e&&s.jsx("div",{className:"bg-white rounded-xl shadow-sm",children:s.jsx(t8e,{currentUserId:e.id})}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Geographic Distribution"}),s.jsx(Xi,{className:"w-5 h-5 text-indigo-600"})]}),O!=null&&O.geographic_distribution&&O.geographic_distribution.length>0?s.jsxs("div",{className:"space-y-4",children:[s.jsx(oc,{width:"100%",height:300,children:s.jsxs(Hg,{data:O.geographic_distribution.slice(0,10),layout:"vertical",children:[s.jsx(fl,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ai,{type:"number",stroke:"#6b7280"}),s.jsx(ii,{type:"category",dataKey:"city",stroke:"#6b7280",width:120}),s.jsx(ta,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:Q=>[Q.toLocaleString(),"Users"]}),s.jsx(Mi,{dataKey:"users",fill:"#6366f1",radius:[0,8,8,0],name:"Users"})]})}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Cities by Active Users"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:O.geographic_distribution.slice(0,12).map((Q,oe)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-indigo-400 to-purple-400 rounded-full flex items-center justify-center text-white text-xs font-bold",children:oe+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:Q.city||"Unknown"}),s.jsx("p",{className:"text-xs text-gray-500",children:Q.country})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:Q.users.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500",children:"users"})]})]},`${Q.city||"Unknown"}-${Q.country}-${oe}`))})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Xi,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Daily Active Users"}),s.jsx(No,{className:"w-5 h-5 text-blue-600"})]}),O!=null&&O.time_series_data.daily&&O.time_series_data.daily.length>0?s.jsx(oc,{width:"100%",height:250,children:s.jsxs(q$,{data:O.time_series_data.daily,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"dauGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),s.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),s.jsx(fl,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ai,{dataKey:"date",stroke:"#6b7280",tickFormatter:Q=>{const oe=new Date(Q);return`${oe.getMonth()+1}/${oe.getDate()}`}}),s.jsx(ii,{stroke:"#6b7280"}),s.jsx(ta,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),s.jsx(Bc,{type:"monotone",dataKey:"value",stroke:"#3b82f6",fillOpacity:1,fill:"url(#dauGradient)",name:"Active Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(No,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Active Users"}),s.jsx(qn,{className:"w-5 h-5 text-green-600"})]}),O!=null&&O.time_series_data.weekly&&O.time_series_data.weekly.length>0?s.jsx(oc,{width:"100%",height:250,children:s.jsxs(U$,{data:O.time_series_data.weekly,children:[s.jsx(fl,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ai,{dataKey:"date",stroke:"#6b7280",tickFormatter:Q=>{const oe=new Date(Q);return`${oe.getMonth()+1}/${oe.getDate()}`}}),s.jsx(ii,{stroke:"#6b7280"}),s.jsx(ta,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),s.jsx(rp,{type:"monotone",dataKey:"value",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",r:4},name:"Active Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(qn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No data available"})]})]})]})]}),X==="moderation"&&s.jsxs("div",{className:"space-y-6",children:[(console.log(" AdminAnalyticsDashboard: Rendering moderation tab, activeTab:",X),null),s.jsx(e8e,{})]})]})})}var sK=["PageUp","PageDown"],aK=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],iK={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},qp="Slider",[kC,n8e,s8e]=fp(qp),[oK,hUe]=$s(qp,[s8e]),[a8e,Fj]=oK(qp),lK=y.forwardRef((e,t)=>{const O=e,{name:r,min:n=0,max:a=100,step:i=1,orientation:o="horizontal",disabled:l=!1,minStepsBetweenThumbs:c=0,defaultValue:d=[n],value:f,onValueChange:u=()=>{},onValueCommit:h=()=>{},inverted:m=!1,form:v}=O,g=ge(O,["name","min","max","step","orientation","disabled","minStepsBetweenThumbs","defaultValue","value","onValueChange","onValueCommit","inverted","form"]),x=y.useRef(new Set),_=y.useRef(0),b=o==="horizontal"?i8e:o8e,[N=[],S]=Ya({prop:f,defaultProp:d,onChange:z=>{var B;(B=[...x.current][_.current])==null||B.focus(),u(z)}}),k=y.useRef(N);function C(z){const M=f8e(N,z);I(z,M)}function A(z){I(z,_.current)}function R(){const z=k.current[_.current];N[_.current]!==z&&h(N)}function I(z,M,{commit:B}={commit:!1}){const F=g8e(i),U=v8e(Math.round((z-n)/i)*i+n,F),H=qv(U,[n,a]);S((q=[])=>{const K=d8e(q,H,M);if(p8e(K,c*i)){_.current=K.indexOf(H);const Z=String(K)!==String(q);return Z&&B&&h(K),Z?K:q}else return q})}return s.jsx(a8e,{scope:e.__scopeSlider,name:r,disabled:l,min:n,max:a,valueIndexToChangeRef:_,thumbs:x.current,values:N,orientation:o,form:v,children:s.jsx(kC.Provider,{scope:e.__scopeSlider,children:s.jsx(kC.Slot,{scope:e.__scopeSlider,children:s.jsx(b,V(D({"aria-disabled":l,"data-disabled":l?"":void 0},g),{ref:t,onPointerDown:mt(g.onPointerDown,()=>{l||(k.current=N)}),min:n,max:a,inverted:m,onSlideStart:l?void 0:C,onSlideMove:l?void 0:A,onSlideEnd:l?void 0:R,onHomeKeyDown:()=>!l&&I(n,0,{commit:!0}),onEndKeyDown:()=>!l&&I(a,N.length-1,{commit:!0}),onStepKeyDown:({event:z,direction:M})=>{if(!l){const U=sK.includes(z.key)||z.shiftKey&&aK.includes(z.key)?10:1,H=_.current,q=N[H],K=i*U*M;I(q+K,H,{commit:!0})}}}))})})})});lK.displayName=qp;var[cK,dK]=oK(qp,{startEdge:"left",endEdge:"right",size:"width",direction:1}),i8e=y.forwardRef((e,t)=>{const b=e,{min:r,max:n,dir:a,inverted:i,onSlideStart:o,onSlideMove:l,onSlideEnd:c,onStepKeyDown:d}=b,f=ge(b,["min","max","dir","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"]),[u,h]=y.useState(null),m=mr(t,N=>h(N)),v=y.useRef(void 0),g=Af(a),x=g==="ltr",_=x&&!i||!x&&i;function w(N){const S=v.current||u.getBoundingClientRect(),k=[0,S.width],A=z5(k,_?[r,n]:[n,r]);return v.current=S,A(N-S.left)}return s.jsx(cK,{scope:e.__scopeSlider,startEdge:_?"left":"right",endEdge:_?"right":"left",direction:_?1:-1,size:"width",children:s.jsx(uK,V(D({dir:g,"data-orientation":"horizontal"},f),{ref:m,style:V(D({},f.style),{"--radix-slider-thumb-transform":"translateX(-50%)"}),onSlideStart:N=>{const S=w(N.clientX);o==null||o(S)},onSlideMove:N=>{const S=w(N.clientX);l==null||l(S)},onSlideEnd:()=>{v.current=void 0,c==null||c()},onStepKeyDown:N=>{const k=iK[_?"from-left":"from-right"].includes(N.key);d==null||d({event:N,direction:k?-1:1})}}))})}),o8e=y.forwardRef((e,t)=>{const g=e,{min:r,max:n,inverted:a,onSlideStart:i,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c}=g,d=ge(g,["min","max","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"]),f=y.useRef(null),u=mr(t,f),h=y.useRef(void 0),m=!a;function v(x){const _=h.current||f.current.getBoundingClientRect(),w=[0,_.height],N=z5(w,m?[n,r]:[r,n]);return h.current=_,N(x-_.top)}return s.jsx(cK,{scope:e.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:s.jsx(uK,V(D({"data-orientation":"vertical"},d),{ref:u,style:V(D({},d.style),{"--radix-slider-thumb-transform":"translateY(50%)"}),onSlideStart:x=>{const _=v(x.clientY);i==null||i(_)},onSlideMove:x=>{const _=v(x.clientY);o==null||o(_)},onSlideEnd:()=>{h.current=void 0,l==null||l()},onStepKeyDown:x=>{const w=iK[m?"from-bottom":"from-top"].includes(x.key);c==null||c({event:x,direction:w?-1:1})}}))})}),uK=y.forwardRef((e,t)=>{const u=e,{__scopeSlider:r,onSlideStart:n,onSlideMove:a,onSlideEnd:i,onHomeKeyDown:o,onEndKeyDown:l,onStepKeyDown:c}=u,d=ge(u,["__scopeSlider","onSlideStart","onSlideMove","onSlideEnd","onHomeKeyDown","onEndKeyDown","onStepKeyDown"]),f=Fj(qp,r);return s.jsx(Pt.span,V(D({},d),{ref:t,onKeyDown:mt(e.onKeyDown,h=>{h.key==="Home"?(o(h),h.preventDefault()):h.key==="End"?(l(h),h.preventDefault()):sK.concat(aK).includes(h.key)&&(c(h),h.preventDefault())}),onPointerDown:mt(e.onPointerDown,h=>{const m=h.target;m.setPointerCapture(h.pointerId),h.preventDefault(),f.thumbs.has(m)?m.focus():n(h)}),onPointerMove:mt(e.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&a(h)}),onPointerUp:mt(e.onPointerUp,h=>{const m=h.target;m.hasPointerCapture(h.pointerId)&&(m.releasePointerCapture(h.pointerId),i(h))})}))}),fK="SliderTrack",hK=y.forwardRef((e,t)=>{const i=e,{__scopeSlider:r}=i,n=ge(i,["__scopeSlider"]),a=Fj(fK,r);return s.jsx(Pt.span,V(D({"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation},n),{ref:t}))});hK.displayName=fK;var EC="SliderRange",mK=y.forwardRef((e,t)=>{const h=e,{__scopeSlider:r}=h,n=ge(h,["__scopeSlider"]),a=Fj(EC,r),i=dK(EC,r),o=y.useRef(null),l=mr(t,o),c=a.values.length,d=a.values.map(m=>vK(m,a.min,a.max)),f=c>1?Math.min(...d):0,u=100-Math.max(...d);return s.jsx(Pt.span,V(D({"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0},n),{ref:l,style:V(D({},e.style),{[i.startEdge]:f+"%",[i.endEdge]:u+"%"})}))});mK.displayName=EC;var CC="SliderThumb",pK=y.forwardRef((e,t)=>{const r=n8e(e.__scopeSlider),[n,a]=y.useState(null),i=mr(t,l=>a(l)),o=y.useMemo(()=>n?r().findIndex(l=>l.ref.current===n):-1,[r,n]);return s.jsx(l8e,V(D({},e),{ref:i,index:o}))}),l8e=y.forwardRef((e,t)=>{const w=e,{__scopeSlider:r,index:n,name:a}=w,i=ge(w,["__scopeSlider","index","name"]),o=Fj(CC,r),l=dK(CC,r),[c,d]=y.useState(null),f=mr(t,b=>d(b)),u=c?o.form||!!c.closest("form"):!0,h=Zb(c),m=o.values[n],v=m===void 0?0:vK(m,o.min,o.max),g=u8e(n,o.values.length),x=h==null?void 0:h[l.size],_=x?h8e(x,v,l.direction):0;return y.useEffect(()=>{if(c)return o.thumbs.add(c),()=>{o.thumbs.delete(c)}},[c,o.thumbs]),s.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[l.startEdge]:`calc(${v}% + ${_}px)`},children:[s.jsx(kC.ItemSlot,{scope:e.__scopeSlider,children:s.jsx(Pt.span,V(D({role:"slider","aria-label":e["aria-label"]||g,"aria-valuemin":o.min,"aria-valuenow":m,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0},i),{ref:f,style:m===void 0?{display:"none"}:e.style,onFocus:mt(e.onFocus,()=>{o.valueIndexToChangeRef.current=n})}))}),u&&s.jsx(gK,{name:a!=null?a:o.name?o.name+(o.values.length>1?"[]":""):void 0,form:o.form,value:m},n)]})});pK.displayName=CC;var c8e="RadioBubbleInput",gK=y.forwardRef((a,n)=>{var i=a,{__scopeSlider:e,value:t}=i,r=ge(i,["__scopeSlider","value"]);const o=y.useRef(null),l=mr(o,n),c=I1(t);return y.useEffect(()=>{const d=o.current;if(!d)return;const f=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(f,"value").set;if(c!==t&&h){const m=new Event("input",{bubbles:!0});h.call(d,t),d.dispatchEvent(m)}},[c,t]),s.jsx(Pt.input,V(D({style:{display:"none"}},r),{ref:l,defaultValue:t}))});gK.displayName=c8e;function d8e(e=[],t,r){const n=[...e];return n[r]=t,n.sort((a,i)=>a-i)}function vK(e,t,r){const i=100/(r-t)*(e-t);return qv(i,[0,100])}function u8e(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function f8e(e,t){if(e.length===1)return 0;const r=e.map(a=>Math.abs(a-t)),n=Math.min(...r);return r.indexOf(n)}function h8e(e,t,r){const n=e/2,i=z5([0,50],[0,n]);return(n-i(t)*r)*r}function m8e(e){return e.slice(0,-1).map((t,r)=>e[r+1]-t)}function p8e(e,t){if(t>0){const r=m8e(e);return Math.min(...r)>=t}return!0}function z5(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function g8e(e){return(String(e).split(".")[1]||"").length}function v8e(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}var yK=lK,y8e=hK,x8e=mK,_8e=pK;const xK=y.forwardRef((n,r)=>{var a=n,{className:e}=a,t=ge(a,["className"]);return s.jsxs(yK,V(D({ref:r,className:Oe("relative flex w-full touch-none select-none items-center",e)},t),{children:[s.jsx(y8e,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:s.jsx(x8e,{className:"absolute h-full bg-primary"})}),s.jsx(_8e,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}))});xK.displayName=yK.displayName;const KS=["all","users","artists","events","venues"],fh=2,Kx=()=>({users:[],artists:[],events:[],venues:[]}),w8e=[{key:"all",label:"All",icon:KQ,emptyMessage:"No results found."},{key:"users",label:"Users",icon:Vr,emptyMessage:"No users match that search yet."},{key:"artists",label:"Artists",icon:Ft,emptyMessage:"No artists found. Try a different spelling?"},{key:"events",label:"Events",icon:Lt,emptyMessage:"No upcoming events match that search."},{key:"venues",label:"Venues",icon:yr,emptyMessage:"No venues found. Try another location or name."}],b8e=({userId:e,allowedTabs:t,showMap:r=!0,layout:n="full",mode:a="full",showResults:i=!0,headerTitle:o,headerDescription:l,headerAccessory:c,showHelperText:d=!0,initialSearchQuery:f="",hideSearchInput:u=!1,onSearchStateChange:h,onNavigateToProfile:m,onNavigateToChat:v,onEventClick:g})=>{var Ve;const x=n==="compact",_=a==="embedded",w=i,b=y.useMemo(()=>{if(!t||t.length===0)return KS;const le=t.filter(Ke=>KS.includes(Ke));return le.length>0?le:KS},[t]),[N,S]=y.useState(f),[k,C]=y.useState(""),[A,R]=y.useState(()=>{var le;return(le=b[0])!=null?le:"all"}),[I,O]=y.useState(Kx),[z,M]=y.useState({all:!1,users:!1,artists:!1,events:!1,venues:!1}),[B,F]=y.useState({}),[U,H]=y.useState({all:{page:1,hasMore:!1},users:{page:1,hasMore:!1},artists:{page:1,hasMore:!1},events:{page:1,hasMore:!1},venues:{page:1,hasMore:!1}}),q=20,[K,Z]=y.useState([]),[ne,Y]=y.useState([39.8283,-98.5795]),[X,se]=y.useState(!1),de=y.useMemo(()=>w8e.filter(({key:le})=>b.includes(le)),[b]),_e=de.length,xe=_e>=4?"grid-cols-4":_e===3?"grid-cols-3":_e===2?"grid-cols-2":"grid-cols-1";y.useEffect(()=>{var le;b.includes(A)||R((le=b[0])!=null?le:"users")},[b,A]),y.useEffect(()=>{f!==N&&S(f)},[f]),y.useEffect(()=>{const le=setTimeout(()=>C(N.trim()),300);return()=>clearTimeout(le)},[N]),y.useEffect(()=>{if(k.length>=fh){try{Zt.search(k,"search","search_query",{query_length:k.length,source:"search_page"})}catch(le){console.error("Error tracking search query:",le)}H({all:{page:1,hasMore:!1},users:{page:1,hasMore:!1},artists:{page:1,hasMore:!1},events:{page:1,hasMore:!1},venues:{page:1,hasMore:!1}}),O(Kx())}},[k]),y.useEffect(()=>{if(k.length<fh){O(Kx()),F({}),M({all:!1,users:!1,artists:!1,events:!1,venues:!1});return}let le=!1;return E(void 0,null,function*(){var Ce;M({all:!0,users:!0,artists:!0,events:!0,venues:!0}),F({});const De=((Ce=U[A])==null?void 0:Ce.page)||1,nt=q,ze=(De-1)*nt,vt=nt*De,rr=nt*De,[sr,Ae,Ue,gt]=yield Promise.all([j8e(k,e,nt,ze),r0.searchArtists(k,vt+1,!1),N8e(k,nt,ze),lB.searchVenues(k,rr+1,!1)]);if(!le){const Ge=sr.length===nt,Nt=Ae.length>vt,Tt=Ue.length===nt,at=gt.length>rr,ue=De===1?0:I.artists.length,qe=De===1?0:I.venues.length,Ct=Ae.slice(ue,ue+nt),ct=gt.slice(qe,qe+nt);O(pt=>({users:De===1?sr:[...pt.users,...sr],artists:De===1?Ae.slice(0,nt):[...pt.artists,...Ct],events:De===1?Ue:[...pt.events,...Ue],venues:De===1?gt.slice(0,nt):[...pt.venues,...ct]})),H(pt=>V(D({},pt),{all:{page:De,hasMore:Ge||Nt||Tt||at},users:{page:De,hasMore:Ge},artists:{page:De,hasMore:Nt},events:{page:De,hasMore:Tt},venues:{page:De,hasMore:at}})),M({all:!1,users:!1,artists:!1,events:!1,venues:!1})}}).catch(()=>{le||(O(Kx()),F({[A]:"Something went wrong. Please try again."}),M({all:!1,users:!1,artists:!1,events:!1,venues:!1}))}),()=>{le=!0}},[k,e,A,(Ve=U[A])==null?void 0:Ve.page]),y.useEffect(()=>{r&&Q()},[r]);const Q=()=>E(void 0,null,function*(){try{se(!0);const{data:le,error:Ke}=yield T.from("events").select("venue_id, venue_name, venue_city, venue_state, latitude, longitude").not("latitude","is",null).not("longitude","is",null).limit(1e3);if(Ke){console.error("Error loading venues for map:",Ke);return}if(le){const De=new Map;le.forEach(vt=>{var gt,Ce,Ge;const rr=typeof vt.latitude=="number"?vt.latitude:Number(vt.latitude),sr=typeof vt.longitude=="number"?vt.longitude:Number(vt.longitude);if(!Number.isFinite(rr)||!Number.isFinite(sr))return;const Ae=(Ce=(gt=vt.venue_id)!=null?gt:vt.venue_name)!=null?Ce:`venue-${rr}-${sr}`,Ue=De.get(Ae);if(Ue){Ue.count+=1;return}De.set(Ae,{id:Ae,name:(Ge=vt.venue_name)!=null?Ge:"Unknown Venue",city:vt.venue_city,state:vt.venue_state,latitude:rr,longitude:sr,count:1})});const nt=Array.from(De.values()).slice(0,500);Z(nt);const ze=nt[0];ze&&Y([ze.latitude,ze.longitude])}}finally{se(!1)}}),oe=A==="all"?[...I.users.slice(0,3),...I.artists.slice(0,3),...I.events.slice(0,3),...I.venues.slice(0,3)]:I[A],ie=z[A],ee=B[A],G=y.useMemo(()=>d?N?N.trim().length<fh?"Type at least 2 characters to see results.":null:"Search for artists, events, venues, or people.":null,[N,d]);y.useEffect(()=>{h==null||h({query:N,debouncedQuery:k})},[N,k,h]);const J=_?"w-full":`${x?"":"min-h-screen"} bg-background`,ae=_?`w-full ${x?"space-y-2":"space-y-4"}`:`max-w-5xl mx-auto px-4 ${x?"py-4 space-y-6":"py-8 space-y-8"}`,we=(o!=null?o:"Search").trim(),ve=we.length>0,Me=(l!=null?l:"Find friends, discover artists, and track upcoming shows  all in one place.").trim(),Te=!x&&Me.length>0;return s.jsx("div",{className:J,children:s.jsxs("div",{className:ae,children:[s.jsxs("div",{className:_&&x?"space-y-1":`${x?"space-y-2":"space-y-4"}`,children:[ve&&s.jsx("h1",{className:`${x?"text-2xl font-semibold":"text-3xl font-bold"} text-foreground`,children:we}),Te&&s.jsx("p",{className:"text-muted-foreground",children:Me}),!u&&s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Ai,{value:N,onChange:le=>S(le),placeholder:'Try "Radiohead"',widthVariant:"flex",id:"global-search"})}),c&&s.jsx("div",{className:"flex-shrink-0",children:c})]}),G&&s.jsx("p",{className:`${x?"text-xs":"text-sm"} text-muted-foreground`,"aria-live":"polite",children:G})]}),w&&r&&k.length<fh&&s.jsx(Ze,{className:"border border-dashed border-muted-foreground/40 bg-muted/10",children:s.jsxs(tt,{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Explore venues on the map"}),s.jsx(et,{variant:"secondary",className:"text-xs",children:X?"Loading":`${K.length.toLocaleString()} venues`})]}),X&&K.length===0?s.jsxs("div",{className:"flex h-[360px] items-center justify-center text-muted-foreground",children:[s.jsx(fr,{className:"h-5 w-5 animate-spin mr-2"}),"Loading venues"]}):K.length===0?s.jsx("div",{className:"flex h-[360px] items-center justify-center text-muted-foreground text-sm",children:"No venues with map data yet. Add some favorites or try searching above."}):s.jsx("div",{className:"h-[420px] rounded-2xl overflow-hidden",children:s.jsx(QU,{center:ne,zoom:4,events:K.map(le=>({id:le.id,jambase_event_id:le.id,title:le.name,artist_name:le.city?`${le.name}`:le.name,artist_id:"",venue_name:le.name,venue_id:le.id,event_date:new Date().toISOString(),latitude:le.latitude,longitude:le.longitude})),onEventClick:()=>{}})})]})}),w&&k.length>=fh&&de.length>0&&s.jsxs(zi,{value:A,onValueChange:le=>{try{Zt.click("search",`search_tab_${le}`,{tab:le,query:k})}catch(Ke){console.error("Error tracking tab switch:",Ke)}R(le)},children:[s.jsx(wi,{className:`grid w-full md:w-auto md:inline-flex bg-muted/60 ${xe}`,children:de.map(({key:le,label:Ke,icon:De})=>s.jsxs(en,{value:le,className:"flex items-center gap-2",children:[s.jsx(De,{className:"h-4 w-4"}),s.jsx("span",{children:Ke})]},le))}),de.map(({key:le,emptyMessage:Ke})=>s.jsx(tn,{value:le,className:"mt-6 space-y-4",children:A===le&&s.jsxs(s.Fragment,{children:[ie&&s.jsxs("div",{className:"flex items-center justify-center py-16 text-muted-foreground",children:[s.jsx(fr,{className:"h-6 w-6 animate-spin mr-2"}),"Searching ",le,"..."]}),!ie&&ee&&s.jsx(vA,{variant:"destructive",children:s.jsx(yA,{children:ee})}),!ie&&!ee&&k.length>=fh&&(A==="all"?I.users.length===0&&I.artists.length===0&&I.events.length===0&&I.venues.length===0:oe.length===0)&&s.jsxs("div",{className:"flex flex-col gap-[6px] items-center justify-center p-12 text-center",children:[s.jsx(Ho,{className:"w-[60px] h-[60px]",style:{color:"var(--color-dark-grey, #5D646F)"}}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:Ke})]}),!ie&&(A==="all"?I.users.length>0||I.artists.length>0||I.events.length>0||I.venues.length>0:oe.length>0)&&s.jsxs("div",{className:"space-y-4",children:[le==="all"&&s.jsx(P8e,{results:I,onNavigateToProfile:m,onEventClick:g,onTabChange:R}),le==="users"&&s.jsxs(s.Fragment,{children:[s.jsx(S8e,{results:I.users,onNavigateToProfile:m}),U.users.hasMore&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(ce,{variant:"outline",onClick:()=>H(De=>V(D({},De),{users:V(D({},De.users),{page:De.users.page+1})})),disabled:z.users,children:z.users?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Load More"})})]}),le==="artists"&&s.jsxs(s.Fragment,{children:[s.jsx(k8e,{results:I.artists}),U.artists.hasMore&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(ce,{variant:"outline",onClick:()=>H(De=>V(D({},De),{artists:V(D({},De.artists),{page:De.artists.page+1})})),disabled:z.artists,children:z.artists?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Load More"})})]}),le==="events"&&s.jsxs(s.Fragment,{children:[s.jsx(E8e,{results:I.events,onEventClick:g}),U.events.hasMore&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(ce,{variant:"outline",onClick:()=>H(De=>V(D({},De),{events:V(D({},De.events),{page:De.events.page+1})})),disabled:z.events,children:z.events?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Load More"})})]}),le==="venues"&&s.jsxs(s.Fragment,{children:[s.jsx(C8e,{results:I.venues}),U.venues.hasMore&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(ce,{variant:"outline",onClick:()=>H(De=>V(D({},De),{venues:V(D({},De.venues),{page:De.venues.page+1})})),disabled:z.venues,children:z.venues?s.jsxs(s.Fragment,{children:[s.jsx(fr,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Load More"})})]})]})]})},le))]})]})})},j8e=(e,t,r=25,n=0)=>E(void 0,null,function*(){try{const a=e.trim(),o=a.split(/\s+/).length===1&&a.length>0?`${a}%`:`%${a}%`,{data:l,error:c}=yield T.from("users").select("user_id, name, avatar_url, bio, account_type").ilike("name",o).neq("user_id",t).order("name",{ascending:!0}).range(n,n+r-1);return c?(console.error("Error searching users:",c),[]):(l||[]).map(d=>({id:d.user_id,name:d.name,username:d.name,avatar_url:d.avatar_url,bio:d.bio,verified:!1,account_type:d.account_type}))}catch(a){return console.error("Error searching users:",a),[]}}),N8e=(e,t=25,r=0)=>E(void 0,null,function*(){try{const n=e.trim(),i=n.split(/\s+/).length===1&&n.length>0?`${n}%`:`%${n}%`,{data:o,error:l}=yield T.from("events").select(`
        id,
        title,
        event_date,
        images,
        event_media_url,
        media_urls,
        artist_id,
        venue_id,
        artists(id, name),
        venues(id, name)
      `).ilike("title",i).order("event_date",{ascending:!0}).range(r,r+t-1);return l?(console.error("Error searching events:",l),[]):(o||[]).map(c=>{var h,m,v;let d=null;if(c.event_media_url)d=c.event_media_url;else if(Array.isArray(c.media_urls)&&c.media_urls.length>0)d=c.media_urls[0];else if(Array.isArray(c.images)&&c.images.length>0){const g=c.images.find(x=>x==null?void 0:x.url);d=(h=g==null?void 0:g.url)!=null?h:null}const f=((m=c.artists)==null?void 0:m.name)||null,u=((v=c.venues)==null?void 0:v.name)||null;return{id:c.id,title:c.title,artistName:f,venueName:u,eventDate:c.event_date,imageUrl:d}})}catch(n){return console.error("Error searching events:",n),[]}}),S8e=({results:e,onNavigateToProfile:t})=>s.jsx(s.Fragment,{children:e.map(r=>{var n;return s.jsx(Ze,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>{try{Zt.click("user",r.id,{source:"search",query:debouncedQuery,result_type:"user"},r.id)}catch(a){console.error("Error tracking user search click:",a)}t==null||t(r.id)},children:s.jsxs(tt,{className:"p-4 flex items-center gap-4",children:[s.jsx(Wr,{className:"h-12 w-12",children:r.avatar_url?s.jsx(Qr,{src:r.avatar_url,alt:r.name}):s.jsx(Hr,{children:(n=r.name)==null?void 0:n.slice(0,2).toUpperCase()})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-semibold truncate",children:r.name}),r.verified&&s.jsx(et,{variant:"outline",children:"Verified"})]}),r.username&&s.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:["@",r.username]}),r.bio&&s.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mt-1",children:r.bio})]})]})},r.id)})}),k8e=({results:e})=>{const t=ts();return console.log(" ArtistResults - Artists with images:",e.map(r=>({name:r.name,hasImage:!!r.image_url,imageUrl:r.image_url}))),s.jsx(s.Fragment,{children:e.map(r=>{const n=r.image_url&&r.image_url.trim().length>0;return s.jsx(Ze,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>t(`/artist/${encodeURIComponent(r.name)}`),children:s.jsxs(tt,{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0 relative",children:n?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:r.image_url,alt:r.name,className:"h-12 w-12 rounded-full object-cover",onError:a=>{console.warn(` Failed to load image for artist "${r.name}": ${r.image_url}`);const i=a.currentTarget;i.style.display="none";const o=i.nextElementSibling;o&&o.classList.remove("hidden")},onLoad:()=>{console.log(` Loaded image for "${r.name}": ${r.image_url}`)}}),s.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center hidden",children:s.jsx(Ft,{className:"h-5 w-5 text-muted-foreground"})})]}):s.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center",children:s.jsx(Ft,{className:"h-5 w-5 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold truncate",children:r.name}),r.genres&&r.genres.length>0&&s.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:r.genres.slice(0,3).map(a=>s.jsx(et,{variant:"secondary",className:"text-xs",children:a},a))}),typeof r.num_upcoming_events=="number"&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[r.num_upcoming_events," upcoming ",r.num_upcoming_events===1?"show":"shows"]})]})]})},r.id)})})},E8e=({results:e,onEventClick:t})=>(ts(),s.jsx(s.Fragment,{children:e.map(r=>{var a,i,o,l;const n=(()=>{if(!r.eventDate)return null;try{return Rt(gs(r.eventDate),"MMM d, yyyy  h:mm a")}catch(c){return r.eventDate}})();return s.jsx(Ze,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>{if(t){try{Zt.click("event",r.id,{source:"search",query:debouncedQuery,result_type:"event",position:e.events.indexOf(r)},r.id)}catch(c){console.error("Error tracking search result click:",c)}t(r)}else r.id&&window.dispatchEvent(new CustomEvent("open-event-details",{detail:{event:r,eventId:r.id}}))},children:s.jsxs(tt,{className:"p-4 flex items-center gap-4",children:[s.jsxs("div",{className:"flex-shrink-0",children:[r.imageUrl?s.jsx("img",{src:r.imageUrl,alt:(i=(a=r.title)!=null?a:r.artistName)!=null?i:"Event",className:"h-16 w-16 rounded-lg object-cover",onError:c=>{var d;c.currentTarget.style.display="none",(d=c.currentTarget.nextElementSibling)==null||d.classList.remove("hidden")}}):null,s.jsx("div",{className:`h-16 w-16 rounded-lg bg-muted flex items-center justify-center ${r.imageUrl?"hidden":""}`,children:s.jsx(Lt,{className:"h-5 w-5 text-muted-foreground"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold truncate",children:(l=(o=r.title)!=null?o:r.artistName)!=null?l:"Untitled Event"}),s.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-0.5",children:[r.artistName&&s.jsx("p",{children:r.artistName}),r.venueName&&s.jsx("p",{children:r.venueName}),n&&s.jsx("p",{children:n})]})]})]})},r.id)})})),C8e=({results:e})=>{const t=ts();return s.jsx(s.Fragment,{children:e.map(r=>{var n,a;return s.jsx(Ze,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>t(`/venue/${encodeURIComponent(r.name)}`),children:s.jsxs(tt,{className:"p-4 flex items-start gap-4",children:[s.jsxs("div",{className:"flex-shrink-0",children:[r.image_url?s.jsx("img",{src:r.image_url,alt:r.name,className:"h-12 w-12 rounded-lg object-cover",onError:i=>{var o;i.currentTarget.style.display="none",(o=i.currentTarget.nextElementSibling)==null||o.classList.remove("hidden")}}):null,s.jsx("div",{className:`h-12 w-12 rounded-lg bg-muted flex items-center justify-center ${r.image_url?"hidden":""}`,children:s.jsx(yr,{className:"h-5 w-5 text-muted-foreground"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold truncate",children:r.name}),(((n=r.address)==null?void 0:n.addressRegion)||((a=r.address)==null?void 0:a.addressCountry))&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.address.addressRegion||"",r.address.addressRegion&&r.address.addressCountry?", ":"",r.address.addressCountry||""]}),typeof r.num_upcoming_events=="number"&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[r.num_upcoming_events," upcoming ",r.num_upcoming_events===1?"show":"shows"]})]})]})},r.id)})})},P8e=({results:e,onNavigateToProfile:t,onEventClick:r,onTabChange:n})=>(e.users.length+e.artists.length+e.events.length+e.venues.length,s.jsxs("div",{className:"space-y-6",children:[s.jsx(Ze,{children:s.jsxs(tt,{className:"p-4",children:[s.jsx("h3",{className:"font-semibold mb-4",children:"Search Results"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 p-3 rounded-lg transition-colors",onClick:()=>n("users"),children:[s.jsx("div",{className:"text-2xl font-bold",children:e.users.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Users"})]}),s.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 p-3 rounded-lg transition-colors",onClick:()=>n("artists"),children:[s.jsx("div",{className:"text-2xl font-bold",children:e.artists.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Artists"})]}),s.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 p-3 rounded-lg transition-colors",onClick:()=>n("events"),children:[s.jsx("div",{className:"text-2xl font-bold",children:e.events.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Events"})]}),s.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 p-3 rounded-lg transition-colors",onClick:()=>n("venues"),children:[s.jsx("div",{className:"text-2xl font-bold",children:e.venues.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Venues"})]})]})]})}),e.users.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold",children:"Users"}),s.jsxs(ce,{variant:"ghost",size:"sm",onClick:()=>n("users"),children:["View all (",e.users.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:e.users.slice(0,3).map(a=>{var i;return s.jsx(Ze,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>{try{Zt.click("user",a.id,{source:"search",query:debouncedQuery,result_type:"user"},a.id)}catch(o){console.error("Error tracking user search click:",o)}t==null||t(a.id)},children:s.jsxs(tt,{className:"p-3 flex items-center gap-3",children:[s.jsx(Wr,{className:"h-10 w-10",children:a.avatar_url?s.jsx(Qr,{src:a.avatar_url,alt:a.name}):s.jsx(Hr,{children:(i=a.name)==null?void 0:i.slice(0,2).toUpperCase()})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-semibold text-sm truncate",children:a.name}),a.verified&&s.jsx(et,{variant:"outline",className:"text-xs",children:"Verified"})]}),a.bio&&s.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1 mt-0.5",children:a.bio})]})]})},a.id)})})]}),e.artists.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold",children:"Artists"}),s.jsxs(ce,{variant:"ghost",size:"sm",onClick:()=>n("artists"),children:["View all (",e.artists.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:e.artists.slice(0,3).map(a=>s.jsx(Ze,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>n("artists"),children:s.jsxs(tt,{className:"p-3 flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:a.image_url?s.jsx("img",{src:a.image_url,alt:a.name,className:"h-10 w-10 rounded-full object-cover"}):s.jsx("div",{className:"h-10 w-10 rounded-full bg-muted flex items-center justify-center",children:s.jsx(Ft,{className:"h-5 w-5 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h5",{className:"font-semibold text-sm truncate",children:a.name}),a.genres&&a.genres.length>0&&s.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:a.genres.slice(0,2).map(i=>s.jsx(et,{variant:"secondary",className:"text-xs",children:i},i))})]})]})},a.id))})]}),e.events.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold",children:"Events"}),s.jsxs(ce,{variant:"ghost",size:"sm",onClick:()=>n("events"),children:["View all (",e.events.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:e.events.slice(0,3).map(a=>{var o,l,c,d;const i=(()=>{if(!a.eventDate)return null;try{return Rt(gs(a.eventDate),"MMM d, yyyy")}catch(f){return a.eventDate}})();return s.jsx(Ze,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>r==null?void 0:r(a),children:s.jsxs(tt,{className:"p-3 flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:a.imageUrl?s.jsx("img",{src:a.imageUrl,alt:(l=(o=a.title)!=null?o:a.artistName)!=null?l:"Event",className:"h-12 w-12 rounded-lg object-cover"}):s.jsx("div",{className:"h-12 w-12 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Lt,{className:"h-5 w-5 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h5",{className:"font-semibold text-sm truncate",children:(d=(c=a.title)!=null?c:a.artistName)!=null?d:"Untitled Event"}),s.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5",children:[a.artistName&&s.jsx("p",{className:"truncate",children:a.artistName}),i&&s.jsx("p",{children:i})]})]})]})},a.id)})})]}),e.venues.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold",children:"Venues"}),s.jsxs(ce,{variant:"ghost",size:"sm",onClick:()=>n("venues"),children:["View all (",e.venues.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:e.venues.slice(0,3).map(a=>{var i,o;return s.jsx(Ze,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>n("venues"),children:s.jsxs(tt,{className:"p-3 flex items-center gap-3",children:[s.jsxs("div",{className:"flex-shrink-0",children:[a.image_url?s.jsx("img",{src:a.image_url,alt:a.name,className:"h-10 w-10 rounded-lg object-cover",onError:l=>{var c;l.currentTarget.style.display="none",(c=l.currentTarget.nextElementSibling)==null||c.classList.remove("hidden")}}):null,s.jsx("div",{className:`h-10 w-10 rounded-lg bg-muted flex items-center justify-center ${a.image_url?"hidden":""}`,children:s.jsx(yr,{className:"h-4 w-4 text-muted-foreground"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h5",{className:"font-semibold text-sm truncate",children:a.name}),(((i=a.address)==null?void 0:i.addressRegion)||((o=a.address)==null?void 0:o.addressCountry))&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[a.address.addressRegion||"",a.address.addressRegion&&a.address.addressCountry?", ":"",a.address.addressCountry||""]})]})]})},a.id)})})]})]})),Zx=({title:e,description:t,icon:r,onClick:n,className:a})=>s.jsx(Ze,{className:Oe("cursor-pointer transition-all hover:shadow-md hover:scale-[1.02]",a),onClick:n,children:s.jsx(tt,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--brand-pink-050)"},children:s.jsx(Re,{name:r,size:16,color:"var(--brand-pink-500)"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold text-sm mb-1",children:e}),s.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:t})]})]})})}),Xx=[{id:"similar-artists",title:"Similar to Artists You Love",description:"Events by artists similar to ones you've seen",icon:"music",category:"taste"},{id:"last-5-attended",title:"Based on Your Last 5 Shows",description:"Recommendations from your recent attendance",icon:"calendar",category:"taste"},{id:"similar-taste-users",title:"Highly Rated by Similar Tastes",description:"Events loved by users with similar music taste",icon:"twoUsers",category:"taste"},{id:"this-weekend",title:"This Weekend",description:"Shows happening this Saturday and Sunday",icon:"calendar",category:"context"},{id:"under-25",title:"Under $25",description:"Affordable shows under $25",icon:"dollar",category:"context"},{id:"small-venues",title:"Small Venues",description:"Intimate shows at smaller venues",icon:"building",category:"context"},{id:"late-shows",title:"Late Shows",description:"Shows starting after 10 PM",icon:"clock",category:"context"},{id:"up-and-coming",title:"Up-and-Coming Artists",description:"Artists with fewer than 10 reviews",icon:"trendingUp",category:"discovery"},{id:"less-than-10-reviews",title:"Events with <10 Reviews",description:"Be among the first to review these shows",icon:"mediumShootingStar",category:"discovery"},{id:"highest-rated-month",title:"Highest-Rated This Month",description:"Events rated 4.5+ stars this month",icon:"star",category:"opinion"},{id:"best-venues",title:"Best Venues",description:"Events at venues rated 4+ stars",icon:"ribbonAward",category:"opinion"},{id:"best-value",title:"Best Value",description:"Events rated highly for value-for-price",icon:"target",category:"opinion"}],_K=({isOpen:e,onClose:t,onSelectVibe:r,isMobile:n=!1})=>{const a=f=>{r(f),t()},i=Xx.filter(f=>f.category==="taste"),o=Xx.filter(f=>f.category==="context"),l=Xx.filter(f=>f.category==="discovery"),c=Xx.filter(f=>f.category==="opinion"),d=s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold mb-2",children:"Start with a Vibe"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose a curated entry point to discover events through different perspectives"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:"By Taste"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:i.map(f=>s.jsx(Zx,{title:f.title,description:f.description,icon:f.icon,onClick:()=>a(f.id)},f.id))})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:"By Context"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:o.map(f=>s.jsx(Zx,{title:f.title,description:f.description,icon:f.icon,onClick:()=>a(f.id)},f.id))})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:"By Discovery Energy"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:l.map(f=>s.jsx(Zx,{title:f.title,description:f.description,icon:f.icon,onClick:()=>a(f.id)},f.id))})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:"By Opinion"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:c.map(f=>s.jsx(Zx,{title:f.title,description:f.description,icon:f.icon,onClick:()=>a(f.id)},f.id))})]})]});return n?s.jsx(PB,{open:e,onOpenChange:t,children:s.jsxs(TT,{side:"bottom",className:"h-[90vh] overflow-y-auto",children:[s.jsxs(AT,{children:[s.jsx(RT,{children:"Browse by Vibe"}),s.jsx(OT,{children:"Choose a curated entry point to discover events"})]}),s.jsx("div",{className:"mt-6",children:d})]})}):s.jsx(vn,{open:e,onOpenChange:t,children:s.jsxs(hn,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Hn,{children:[s.jsx(Sn,{children:"Browse by Vibe"}),s.jsx(ds,{children:"Choose a curated entry point to discover events through different perspectives"})]}),s.jsx("div",{className:"mt-4",children:d})]})})};class ni{static applyFilters(t,r){var n,a,i,o;if(!r)return t;if((n=r.dateRange)!=null&&n.from&&(t=t.gte("event_date",r.dateRange.from.toISOString())),(a=r.dateRange)!=null&&a.to&&(t=t.lte("event_date",r.dateRange.to.toISOString())),!((i=r.dateRange)!=null&&i.from)&&!((o=r.dateRange)!=null&&o.to)&&(t=t.gte("event_date",new Date().toISOString())),r.genres&&r.genres.length>0&&(t=t.overlaps("genres",r.genres)),r.cities&&r.cities.length>0){const l=r.cities.map(c=>`venue_city.ilike.%${c}%`).join(",");t=t.or(l)}else if(r.latitude&&r.longitude&&r.radiusMiles){const l=r.radiusMiles/69,c=r.radiusMiles/(69*Math.cos(r.latitude*Math.PI/180));t=t.not("latitude","is",null).not("longitude","is",null).gte("latitude",r.latitude-l).lte("latitude",r.latitude+l).gte("longitude",r.longitude-c).lte("longitude",r.longitude+c)}return t}static getSimilarArtists(t,r=20,n){return E(this,null,function*(){try{console.log(" [VIBE] getSimilarArtists - Starting");const a=new Date;a.setDate(a.getDate()-90),console.log(` [VIBE] getSimilarArtists - Using recency filter: last 90 days (since ${a.toISOString()})`);const{data:i}=yield T.from("reviews").select("events:event_id(artist_name)").eq("user_id",t).eq("is_draft",!1).not("events.artist_name","is",null).gte("created_at",a.toISOString()).order("created_at",{ascending:!1}).limit(50);console.log(` [VIBE] getSimilarArtists - Fetched ${(i==null?void 0:i.length)||0} reviews from last 90 days`);const o=new Set((i||[]).map(d=>{var f;return(f=d.events)==null?void 0:f.artist_name}).filter(Boolean));if(console.log(` [VIBE] getSimilarArtists - Found ${o.size} unique artists from reviews`),o.size===0)return console.log(" [VIBE] getSimilarArtists - No artists found, returning empty"),{events:[],title:"Similar to Artists You Love",description:"We need more data about your music taste to show similar artists.",totalCount:0};let l=T.from("events").select("*").in("artist_name",Array.from(o));l=ni.applyFilters(l,n);const{data:c}=yield l.order("event_date",{ascending:!0}).limit(r);return console.log(` [VIBE] getSimilarArtists - Found ${(c==null?void 0:c.length)||0} events, returning results`),{events:c||[],title:"Similar to Artists You Love",description:"Events by artists you've seen live",totalCount:(c==null?void 0:c.length)||0}}catch(a){return console.error("Error getting similar artists:",a),{events:[],title:"Similar to Artists You Love",description:"Unable to load similar artists.",totalCount:0}}})}static getLast5Attended(t,r=20,n){return E(this,null,function*(){try{console.log(" [VIBE] getLast5Attended - Starting");const{data:a}=yield T.from("reviews").select("events:event_id(artist_name, genres, venue_name)").eq("user_id",t).eq("is_draft",!1).eq("was_there",!0).order("created_at",{ascending:!1}).limit(5);if(console.log(` [VIBE] getLast5Attended - Fetched ${(a==null?void 0:a.length)||0} recent attended events`),!a||a.length===0)return{events:[],title:"Based on Your Last 5 Shows",description:"Attend and review events to get personalized recommendations.",totalCount:0};const i=new Set;a.forEach(c=>{var d;(d=c.events)!=null&&d.genres&&c.events.genres.forEach(f=>i.add(f))});let o=T.from("events").select("*").overlaps("genres",Array.from(i));o=ni.applyFilters(o,n);const{data:l}=yield o.order("event_date",{ascending:!0}).limit(r);return{events:l||[],title:"Based on Your Last 5 Shows",description:"Events similar to shows you've recently attended",totalCount:(l==null?void 0:l.length)||0}}catch(a){return console.error("Error getting last 5 attended:",a),{events:[],title:"Based on Your Last 5 Shows",description:"Unable to load recommendations.",totalCount:0}}})}static getSimilarTasteUsers(t,r=20,n){return E(this,null,function*(){try{console.log(" [VIBE] getSimilarTasteUsers - Starting");const a=new Date;a.setDate(a.getDate()-90),console.log(` [VIBE] getSimilarTasteUsers - Using recency filter: last 90 days (since ${a.toISOString()})`);const{data:i}=yield T.from("reviews").select("events:event_id(genres)").eq("user_id",t).eq("is_draft",!1).not("events.genres","is",null).gte("created_at",a.toISOString()).order("created_at",{ascending:!1}).limit(50);console.log(` [VIBE] getSimilarTasteUsers - Fetched ${(i==null?void 0:i.length)||0} user reviews from last 90 days`);const o=new Set;if((i||[]).forEach(h=>{var m;(m=h.events)!=null&&m.genres&&h.events.genres.forEach(v=>o.add(v))}),console.log(` [VIBE] getSimilarTasteUsers - Found ${o.size} unique genres from user reviews`),o.size===0)return console.log(" [VIBE] getSimilarTasteUsers - No genres found, returning empty"),{events:[],title:"Highly Rated by Similar Tastes",description:"We need more data about your music taste.",totalCount:0};const{data:l}=yield T.from("reviews").select("event_id").gte("rating",4).eq("is_draft",!1).gte("created_at",a.toISOString()).order("created_at",{ascending:!1}).limit(500);if(console.log(` [VIBE] getSimilarTasteUsers - Fetched ${(l==null?void 0:l.length)||0} high-rated reviews (4+) from last 90 days`),!l||l.length===0)return console.log(" [VIBE] getSimilarTasteUsers - No high-rated reviews found, returning empty"),{events:[],title:"Highly Rated by Similar Tastes",description:"No highly rated events found",totalCount:0};const c=[...new Set(l.map(h=>h.event_id))];console.log(` [VIBE] getSimilarTasteUsers - Found ${c.length} unique high-rated events`);let d=T.from("events").select("*").in("id",c).overlaps("genres",Array.from(o));d=ni.applyFilters(d,n);const{data:f}=yield d.order("event_date",{ascending:!0}).limit(r);console.log(` [VIBE] getSimilarTasteUsers - Found ${(f==null?void 0:f.length)||0} events matching genres`);const u=new Map;return(f||[]).forEach(h=>{u.has(h.id)||u.set(h.id,h)}),console.log(` [VIBE] getSimilarTasteUsers - Returning ${u.size} deduplicated events`),{events:Array.from(u.values()),title:"Highly Rated by Similar Tastes",description:"Events rated 4+ stars by users who like similar genres",totalCount:u.size}}catch(a){return console.error("Error getting similar taste users:",a),{events:[],title:"Highly Rated by Similar Tastes",description:"Unable to load recommendations.",totalCount:0}}})}static getThisWeekend(t=20,r){return E(this,null,function*(){try{const n=new Date,a=new Date(n);a.setDate(n.getDate()+(6-n.getDay())%7),a.setHours(0,0,0,0);const i=new Date(a);i.setDate(a.getDate()+1),i.setHours(23,59,59,999);let o=T.from("events").select("*").gte("event_date",a.toISOString()).lte("event_date",i.toISOString());const l=r&&V(D({},r),{dateRange:{from:a,to:i}});o=ni.applyFilters(o,l);const{data:c}=yield o.order("event_date",{ascending:!0}).limit(t);return{events:c||[],title:"This Weekend",description:`Events happening ${a.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${i.toLocaleDateString("en-US",{month:"short",day:"numeric"})}`,totalCount:(c==null?void 0:c.length)||0}}catch(n){return console.error("Error getting weekend events:",n),{events:[],title:"This Weekend",description:"Unable to load weekend events.",totalCount:0}}})}static getUnder25(t=20,r){return E(this,null,function*(){try{let n=T.from("events").select("*").or("price_min.lte.25,price_max.lte.25");n=ni.applyFilters(n,r);const{data:a}=yield n.order("event_date",{ascending:!0}).limit(t);return{events:a||[],title:"Under $25",description:"Affordable shows under $25",totalCount:(a==null?void 0:a.length)||0}}catch(n){return console.error("Error getting under $25 events:",n),{events:[],title:"Under $25",description:"Unable to load affordable events.",totalCount:0}}})}static getSmallVenues(t=20,r){return E(this,null,function*(){try{const{data:n}=yield T.from("venues").select("id").not("maximum_attendee_capacity","is",null).lt("maximum_attendee_capacity",500).limit(100);if(!n||n.length===0)return{events:[],title:"Small Venues",description:"Intimate shows at smaller venues",totalCount:0};const a=n.map(l=>l.id);let i=T.from("events").select("*").in("venue_jambase_id",a);i=ni.applyFilters(i,r);const{data:o}=yield i.order("event_date",{ascending:!0}).limit(t);return{events:o||[],title:"Small Venues",description:"Intimate shows at smaller venues (< 500 capacity)",totalCount:(o==null?void 0:o.length)||0}}catch(n){return console.error("Error getting small venues:",n),{events:[],title:"Small Venues",description:"Unable to load small venue events.",totalCount:0}}})}static getLateShows(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getLateShows - Starting");const n=new Date;new Date(n).setHours(22,0,0,0);let i=T.from("events").select("*").not("doors_time","is",null);i=ni.applyFilters(i,r);const{data:o}=yield i.order("event_date",{ascending:!0}).limit(t*3);console.log(` [VIBE] getLateShows - Fetched ${(o==null?void 0:o.length)||0} events with doors_time`);const l=(o||[]).filter(c=>{if(!c.doors_time)return!1;const d=new Date(c.doors_time),f=d.getHours()>=22;return f&&console.log(` [VIBE] getLateShows - Found late show: ${c.title} at ${d.toLocaleTimeString()}`),f}).slice(0,t);return console.log(` [VIBE] getLateShows - Filtered to ${l.length} late shows (doors_time >= 22:00)`),{events:l,title:"Late Shows",description:"Shows starting after 10 PM",totalCount:l.length}}catch(n){return console.error("Error getting late shows:",n),{events:[],title:"Late Shows",description:"Unable to load late shows.",totalCount:0}}})}static getUpAndComing(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getUpAndComing - Starting");const n=new Date;n.setDate(n.getDate()-180),console.log(` [VIBE] getUpAndComing - Using recency filter: last 180 days (since ${n.toISOString()})`);const{data:a}=yield T.from("reviews").select("events:event_id(artist_name)").eq("is_draft",!1).not("events.artist_name","is",null).gte("created_at",n.toISOString()).order("created_at",{ascending:!1}).limit(2e3);console.log(` [VIBE] getUpAndComing - Fetched ${(a==null?void 0:a.length)||0} reviews from last 180 days`);const i=new Map;(a||[]).forEach(d=>{var u;const f=(u=d.events)==null?void 0:u.artist_name;f&&i.set(f,(i.get(f)||0)+1)}),console.log(` [VIBE] getUpAndComing - Found ${i.size} unique artists with reviews`);const o=Array.from(i.entries()).filter(([d,f])=>f<10).map(([d])=>d);if(console.log(` [VIBE] getUpAndComing - Found ${o.length} artists with <10 reviews`),o.length===0)return{events:[],title:"Up-and-Coming Artists",description:"Artists with fewer than 10 reviews",totalCount:0};let l=T.from("events").select("*").in("artist_name",o.slice(0,50));l=ni.applyFilters(l,r);const{data:c}=yield l.order("event_date",{ascending:!0}).limit(t);return console.log(` [VIBE] getUpAndComing - Found ${(c==null?void 0:c.length)||0} events for up-and-coming artists`),{events:c||[],title:"Up-and-Coming Artists",description:"Artists with fewer than 10 reviews - discover them early",totalCount:(c==null?void 0:c.length)||0}}catch(n){return console.error("Error getting up-and-coming artists:",n),{events:[],title:"Up-and-Coming Artists",description:"Unable to load up-and-coming artists.",totalCount:0}}})}static getLessThan10Reviews(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getLessThan10Reviews - Starting");const n=new Date;n.setDate(n.getDate()-180),console.log(` [VIBE] getLessThan10Reviews - Using recency filter: last 180 days (since ${n.toISOString()})`);const{data:a}=yield T.from("reviews").select("event_id").eq("is_draft",!1).gte("created_at",n.toISOString()).order("created_at",{ascending:!1}).limit(2e3);console.log(` [VIBE] getLessThan10Reviews - Fetched ${(a==null?void 0:a.length)||0} reviews from last 180 days`);const i=new Map;(a||[]).forEach(d=>{i.set(d.event_id,(i.get(d.event_id)||0)+1)}),console.log(` [VIBE] getLessThan10Reviews - Found ${i.size} unique events with reviews`);let o=T.from("events").select("*");o=ni.applyFilters(o,r);const{data:l}=yield o.order("event_date",{ascending:!0}).limit(t*2),c=(l||[]).filter(d=>(i.get(d.id)||0)<10).slice(0,t);return console.log(` [VIBE] getLessThan10Reviews - Filtered to ${c.length} events with <10 reviews`),{events:c,title:"Events with <10 Reviews",description:"Be among the first to review these shows",totalCount:c.length}}catch(n){return console.error("Error getting events with <10 reviews:",n),{events:[],title:"Events with <10 Reviews",description:"Unable to load events.",totalCount:0}}})}static getHighestRatedMonth(t=20,r){return E(this,null,function*(){var n,a;try{console.log(" [VIBE] getHighestRatedMonth - Starting");const i=new Date,o=new Date(i.getFullYear(),i.getMonth(),1),l=new Date(i.getFullYear(),i.getMonth()+1,0,23,59,59);console.log(` [VIBE] getHighestRatedMonth - Filtering reviews from ${o.toISOString()} to ${l.toISOString()}`);const{data:c}=yield T.from("reviews").select("event_id").gte("rating",4.5).eq("is_draft",!1).gte("created_at",o.toISOString()).lte("created_at",l.toISOString()).order("created_at",{ascending:!1}).limit(500);if(console.log(` [VIBE] getHighestRatedMonth - Fetched ${(c==null?void 0:c.length)||0} reviews with rating >= 4.5 this month`),!c||c.length===0)return{events:[],title:"Highest-Rated This Month",description:"No highly rated events this month",totalCount:0};const d=[...new Set(c.map(v=>v.event_id))];console.log(` [VIBE] getHighestRatedMonth - Found ${d.length} unique events with rating >= 4.5 this month`);let f=T.from("events").select("*").gte("event_date",o.toISOString()).lte("event_date",l.toISOString()).in("id",d);const u=r?V(D({},r),{dateRange:{from:(n=r.dateRange)!=null&&n.from&&r.dateRange.from>o?r.dateRange.from:o,to:(a=r.dateRange)!=null&&a.to&&r.dateRange.to<l?r.dateRange.to:l}}):{dateRange:{from:o,to:l}};f=ni.applyFilters(f,u);const{data:h}=yield f.order("event_date",{ascending:!0}).limit(t);console.log(` [VIBE] getHighestRatedMonth - Found ${(h==null?void 0:h.length)||0} events matching filters`);const m=new Map;return(h||[]).forEach(v=>{m.has(v.id)||m.set(v.id,v)}),console.log(` [VIBE] getHighestRatedMonth - Returning ${m.size} deduplicated events`),{events:Array.from(m.values()),title:"Highest-Rated This Month",description:"Events rated 4.5+ stars this month",totalCount:m.size}}catch(i){return console.error("Error getting highest-rated month:",i),{events:[],title:"Highest-Rated This Month",description:"Unable to load highest-rated events.",totalCount:0}}})}static getBestVenues(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getBestVenues - Starting");const n=new Date;n.setDate(n.getDate()-180),console.log(` [VIBE] getBestVenues - Using recency filter: last 180 days (since ${n.toISOString()})`);const{data:a}=yield T.from("reviews").select("event_id, venue_rating_new, venue_rating").eq("is_draft",!1).gte("created_at",n.toISOString()).order("created_at",{ascending:!1}).limit(1e3);if(console.log(` [VIBE] getBestVenues - Fetched ${(a==null?void 0:a.length)||0} reviews from last 180 days`),!a||a.length===0)return{events:[],title:"Best Venues",description:"No highly rated venues found",totalCount:0};const i=a.filter(m=>{const v=m.venue_rating_new||m.venue_rating;return v&&v>=4});if(console.log(` [VIBE] getBestVenues - Found ${i.length} reviews with rating >= 4`),i.length===0)return console.log(" [VIBE] getBestVenues - No high-rated reviews found, returning empty"),{events:[],title:"Best Venues",description:"No highly rated venues found",totalCount:0};const o=[...new Set(i.map(m=>m.event_id))];console.log(` [VIBE] getBestVenues - Found ${o.length} unique events with high venue ratings`);const{data:l}=yield T.from("events").select("id, venue_jambase_id, venue_name").in("id",o);console.log(` [VIBE] getBestVenues - Fetched ${(l==null?void 0:l.length)||0} event details`);const c=new Map,d=new Map((l||[]).map(m=>[m.id,m]));i.forEach(m=>{const v=d.get(m.event_id);if(!v)return;const g=v.venue_jambase_id,x=v.venue_name,_=m.venue_rating_new||m.venue_rating;if(g&&x&&_){const w=c.get(g)||{name:x,avgRating:0,count:0};w.avgRating=(w.avgRating*w.count+_)/(w.count+1),w.count+=1,c.set(g,w)}});const f=Array.from(c.entries()).sort(([m,v],[g,x])=>x.avgRating-v.avgRating).slice(0,20).map(([m])=>m);if(f.length===0)return{events:[],title:"Best Venues",description:"No highly rated venues found",totalCount:0};let u=T.from("events").select("*").in("venue_jambase_id",f);u=ni.applyFilters(u,r);const{data:h}=yield u.order("event_date",{ascending:!0}).limit(t);return console.log(` [VIBE] getBestVenues - Found ${(h==null?void 0:h.length)||0} events at best venues`),{events:h||[],title:"Best Venues",description:"Events at venues rated 4+ stars",totalCount:(h==null?void 0:h.length)||0}}catch(n){return console.error("Error getting best venues:",n),{events:[],title:"Best Venues",description:"Unable to load best venue events.",totalCount:0}}})}static getBestValue(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getBestValue - Starting");const n=new Date;n.setDate(n.getDate()-90),console.log(` [VIBE] getBestValue - Using recency filter: last 90 days (since ${n.toISOString()})`);const{data:a}=yield T.from("reviews").select("event_id").gte("value_rating",4).eq("is_draft",!1).not("value_rating","is",null).gte("created_at",n.toISOString()).order("created_at",{ascending:!1}).limit(500);if(console.log(` [VIBE] getBestValue - Fetched ${(a==null?void 0:a.length)||0} reviews with value_rating >= 4 from last 90 days`),!a||a.length===0)return console.log(" [VIBE] getBestValue - No high-value reviews found, returning empty"),{events:[],title:"Best Value",description:"No high value events found",totalCount:0};const i=[...new Set(a.map(d=>d.event_id))];console.log(` [VIBE] getBestValue - Found ${i.length} unique events with high value ratings`);let o=T.from("events").select("*").in("id",i);o=ni.applyFilters(o,r);const{data:l}=yield o.order("event_date",{ascending:!0}).limit(t);console.log(` [VIBE] getBestValue - Found ${(l==null?void 0:l.length)||0} events matching filters`);const c=new Map;return(l||[]).forEach(d=>{c.has(d.id)||c.set(d.id,d)}),console.log(` [VIBE] getBestValue - Returning ${c.size} deduplicated events`),{events:Array.from(c.values()),title:"Best Value",description:"Events rated highly for value-for-price",totalCount:c.size}}catch(n){return console.error("Error getting best value:",n),{events:[],title:"Best Value",description:"Unable to load best value events.",totalCount:0}}})}static executeVibe(t,r,n=20,a){return E(this,null,function*(){switch(console.log(` [VIBE] executeVibe - Executing vibe: ${t} for user: ${r}, limit: ${n}`),a&&console.log(" [VIBE] executeVibe - Filters:",JSON.stringify(a,null,2)),t){case"similar-artists":return this.getSimilarArtists(r,n,a);case"last-5-attended":return this.getLast5Attended(r,n,a);case"similar-taste-users":return this.getSimilarTasteUsers(r,n,a);case"this-weekend":return this.getThisWeekend(n,a);case"under-25":return this.getUnder25(n,a);case"small-venues":return this.getSmallVenues(n,a);case"late-shows":return this.getLateShows(n,a);case"up-and-coming":return this.getUpAndComing(n,a);case"less-than-10-reviews":return this.getLessThan10Reviews(n,a);case"highest-rated-month":return this.getHighestRatedMonth(n,a);case"best-venues":return this.getBestVenues(n,a);case"best-value":return this.getBestValue(n,a);default:return{events:[],title:"Unknown Vibe",description:"Unknown vibe type",totalCount:0}}})}}const B5=({event:e,onClick:t,socialProofCount:r,reasonLabel:n,className:a})=>{var c,d,f;const i=u=>{try{return Rt(new Date(u),"MMM d")}catch(h){return""}},o=((d=(c=e.images)==null?void 0:c[0])==null?void 0:d.url)||e.event_media_url||((f=e.media_urls)==null?void 0:f[0]),l=o?Va(o):null;return s.jsxs(Ze,{className:Oe("w-[280px] cursor-pointer transition-all hover:shadow-lg overflow-hidden",a),onClick:t,children:[l&&s.jsx("div",{className:"w-full h-32 bg-gray-200 overflow-hidden",children:s.jsx("img",{src:l,alt:e.title||e.artist_name||"Event",className:"w-full h-full object-cover"})}),s.jsxs(tt,{className:"p-3",children:[s.jsx("h4",{className:"font-semibold text-sm mb-1 line-clamp-1",children:e.title||e.artist_name||"Event"}),e.artist_name&&s.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:e.artist_name}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-2 flex-wrap",children:[e.event_date&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Re,{name:"calendar",size:16}),s.jsx("span",{children:i(e.event_date)})]}),(e.venue_city||e.venue_state)&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Re,{name:"location",size:16}),s.jsx("span",{className:"line-clamp-1",children:e.venue_city?e.venue_state?`${e.venue_city}, ${e.venue_state}`:e.venue_city:e.venue_state||""})]}),(e.price_min||e.price_max||e.price_range)&&s.jsx("div",{className:"flex items-center gap-1 text-xs font-medium text-foreground",children:e.price_range||(e.price_min&&e.price_max?`$${e.price_min}${e.price_min!==e.price_max?`-$${e.price_max}`:""}`:e.price_min?`$${e.price_min}+`:e.price_max?`Up to $${e.price_max}`:"")})]}),(r!==void 0||n)&&s.jsxs("div",{className:"flex items-center gap-2",children:[r!==void 0&&r>0&&s.jsxs(et,{variant:"secondary",className:"text-xs",children:[r," ",r===1?"person":"people"]}),n&&s.jsx("span",{className:"text-xs text-muted-foreground",children:n})]})]})]})},T8e=["Rock","Pop","Hip-Hop","Electronic","Jazz","Classical","Country","R&B","Reggae","Folk","Blues","Alternative","Indie","Punk","Metal","Funk","Soul","Gospel","Latin","World"],A8e=({vibeType:e,userId:t,filters:r,onBack:n,onNavigateToProfile:a,onNavigateToChat:i})=>{var ee,G,J,ae,fe,we,ve;const[o,l]=y.useState(null),[c,d]=y.useState(!0),[f,u]=y.useState(1),[h,m]=y.useState(null),[v,g]=y.useState(!1),[x,_]=y.useState(!1),[w,b]=y.useState(new Set),[N,S]=y.useState(r||{}),[k,C]=y.useState(!1),[A,R]=y.useState(!1),[I,O]=y.useState(!1),[z,M]=y.useState([]),[B,F]=y.useState([]),[U,H]=y.useState(!1),q=20;y.useEffect(()=>{I&&K()},[I]),y.useEffect(()=>{_e(),de()},[e,t,N]);const K=()=>E(void 0,null,function*(){H(!0);try{const{data:me}=yield T.from("events").select("venue_city, venue_state").gte("event_date",new Date().toISOString()).not("venue_city","is",null).limit(1e3),Me=new Map;(me||[]).forEach(Te=>{if(Te.venue_city){const Ve=`${Te.venue_city}, ${Te.venue_state||""}`.trim(),le=Me.get(Ve);le?le.eventCount+=1:Me.set(Ve,{city:Te.venue_city,state:Te.venue_state||"",eventCount:1})}}),F(Array.from(Me.values()).sort((Te,Ve)=>Ve.eventCount-Te.eventCount).slice(0,50))}catch(me){console.error("Error loading cities:",me)}finally{H(!1)}}),Z=me=>{var Te;const Me=(Te=N.genres)!=null&&Te.includes(me)?N.genres.filter(Ve=>Ve!==me):[...N.genres||[],me];S(V(D({},N),{genres:Me}))},ne=()=>{S(V(D({},N),{cities:z})),O(!1)},Y=me=>{M(Me=>Me.includes(me)?Me.filter(Te=>Te!==me):[...Me,me])},X=()=>{S({dateRange:void 0,genres:[],cities:[],radiusMiles:r==null?void 0:r.radiusMiles,latitude:r==null?void 0:r.latitude,longitude:r==null?void 0:r.longitude}),M([])},se=!!((ee=N.dateRange)!=null&&ee.from||(G=N.dateRange)!=null&&G.to||N.genres&&N.genres.length>0||N.cities&&N.cities.length>0),de=()=>E(void 0,null,function*(){try{const me=yield Kr.getUserInterestedEventIdSet(t);b(me)}catch(me){console.error("Error loading interested events:",me)}}),_e=()=>E(void 0,null,function*(){d(!0);try{const me=yield ni.executeVibe(e,t,q*3,N);l(me),u(1)}catch(me){console.error("Error loading vibe results:",me),l({events:[],title:"Error",description:"Unable to load results",totalCount:0})}finally{d(!1)}}),xe=me=>E(void 0,null,function*(){try{const{data:Me}=yield T.from("events").select("*").eq("id",me.id).single();if(Me){m(Me);const Te=yield Kr.isUserInterested(t,Me.id);_(Te),g(!0)}else m(me),_(w.has(me.id||"")),g(!0)}catch(Me){console.error("Error fetching event details:",Me),m(me),_(w.has(me.id||"")),g(!0)}}),Q=(me,Me)=>E(void 0,null,function*(){try{yield Kr.setEventInterest(t,me,Me),b(Te=>{const Ve=new Set(Te);return Me?Ve.add(me):Ve.delete(me),Ve}),_(Me)}catch(Te){console.error("Error toggling interest:",Te)}}),oe=(o==null?void 0:o.events.slice(0,f*q))||[],ie=o?oe.length<o.events.length:!1;return s.jsxs("div",{className:"page-container",style:{overflow:"visible",backgroundColor:"var(--neutral-50)",position:"relative",minHeight:"100vh"},children:[s.jsxs("div",{className:"max-w-6xl mx-auto",style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:"calc(env(safe-area-inset-top, 0px) + var(--spacing-small, 12px))",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs(ce,{variant:"ghost",size:"sm",onClick:n,className:"mb-4",children:[s.jsx(Re,{name:"leftArrow",size:16,className:"mr-2",color:"var(--neutral-900)"}),"Back to Discover"]}),o&&s.jsxs(s.Fragment,{children:[s.jsx("h1",{className:"text-2xl font-bold mb-2",children:o.title}),s.jsx("p",{className:"text-muted-foreground",children:o.description})]})]}),s.jsxs("div",{className:"mb-6 flex items-center gap-2 flex-wrap",children:[s.jsxs(vc,{open:k,onOpenChange:C,children:[s.jsx(yc,{asChild:!0,children:s.jsx(ce,{variant:"outline",size:"sm",className:"p-2 flex-shrink-0",children:s.jsx(Re,{name:"calendar",size:16,color:"var(--neutral-900)"})})}),s.jsx(kl,{className:"w-auto p-0 swift-ui-card",align:"start",children:s.jsx("div",{className:"swift-ui-card-content",children:s.jsx(h0,{mode:"range",selected:{from:(J=N.dateRange)==null?void 0:J.from,to:(ae=N.dateRange)==null?void 0:ae.to},onSelect:me=>{S(V(D({},N),{dateRange:me})),me!=null&&me.from&&(me!=null&&me.to)&&C(!1)},numberOfMonths:2})})})]}),s.jsxs(vc,{open:A,onOpenChange:R,children:[s.jsx(yc,{asChild:!0,children:s.jsxs(ce,{variant:"outline",size:"sm",className:"p-2 relative flex-shrink-0",children:[s.jsx(Re,{name:"music",size:16,color:"var(--neutral-900)"}),N.genres&&N.genres.length>0&&s.jsx(et,{variant:"secondary",className:"absolute -top-1 -right-1 h-4 min-w-4 px-1 text-xs flex items-center justify-center",children:N.genres.length})]})}),s.jsx(kl,{className:"w-80 swift-ui-card",align:"start",children:s.jsxs("div",{className:"swift-ui-card-content space-y-2",children:[s.jsx("div",{className:"font-semibold text-sm mb-2",children:"Select Genres"}),s.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-64 overflow-y-auto",children:T8e.map(me=>{var Me;return s.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer p-2 rounded hover:bg-accent",children:[s.jsx(yw,{checked:((Me=N.genres)==null?void 0:Me.includes(me))||!1,onCheckedChange:()=>Z(me)}),s.jsx("span",{children:me})]},me)})})]})})]}),s.jsxs(vc,{open:I,onOpenChange:me=>{O(me),me&&M(N.cities||[])},children:[s.jsx(yc,{asChild:!0,children:s.jsxs(ce,{variant:"outline",size:"sm",className:"p-2 relative flex-shrink-0",children:[s.jsx(Re,{name:"location",size:16,color:"var(--neutral-900)"}),N.cities&&N.cities.length>0&&s.jsx(et,{variant:"secondary",className:"absolute -top-1 -right-1 h-4 min-w-4 px-1 text-xs flex items-center justify-center",children:N.cities.length})]})}),s.jsx(kl,{className:"w-80 swift-ui-card",align:"start",children:s.jsxs("div",{className:"swift-ui-card-content space-y-2",children:[s.jsx("div",{className:"font-semibold text-sm mb-2",children:"Select Cities"}),U?s.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading cities..."}):s.jsx("div",{className:"max-h-64 overflow-y-auto space-y-1",children:B.map((me,Me)=>{const Te=me.state?`${me.city}, ${me.state}`:me.city,Ve=z.includes(Te);return s.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer p-2 rounded hover:bg-accent",children:[s.jsx(yw,{checked:Ve,onCheckedChange:()=>Y(Te)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:me.city}),me.state&&s.jsx("div",{className:"text-xs text-muted-foreground",children:me.state})]}),s.jsx("div",{className:"text-xs text-muted-foreground",children:me.eventCount})]},`${Te}-${Me}`)})}),s.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[s.jsx(ce,{size:"sm",onClick:ne,className:"flex-1",children:"Apply"}),s.jsx(ce,{size:"sm",variant:"outline",onClick:()=>{M([]),S(V(D({},N),{cities:[]}))},children:"Clear"})]})]})})]}),se&&s.jsx(ce,{variant:"ghost",size:"sm",onClick:X,className:"p-2 text-muted-foreground hover:text-foreground flex-shrink-0",children:s.jsx(Re,{name:"x",size:16,color:"var(--neutral-900)"})})]}),se&&s.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-4",children:[((fe=N.dateRange)==null?void 0:fe.from)&&s.jsxs(et,{variant:"secondary",className:"gap-1",children:["Date: ",Rt(N.dateRange.from,"MMM d"),N.dateRange.to&&` - ${Rt(N.dateRange.to,"MMM d")}`,s.jsx("button",{onClick:()=>S(V(D({},N),{dateRange:void 0})),className:"ml-1 hover:text-destructive",children:s.jsx(Re,{name:"x",size:16,color:"var(--neutral-900)"})})]}),(we=N.genres)==null?void 0:we.map(me=>s.jsxs(et,{variant:"secondary",className:"gap-1",children:[me,s.jsx("button",{onClick:()=>Z(me),className:"ml-1 hover:text-destructive",children:s.jsx(Re,{name:"x",size:16,color:"var(--neutral-900)"})})]},me)),(ve=N.cities)==null?void 0:ve.map(me=>s.jsxs(et,{variant:"secondary",className:"gap-1",children:[me,s.jsx("button",{onClick:()=>{var Me;S(V(D({},N),{cities:(Me=N.cities)==null?void 0:Me.filter(Te=>Te!==me)}))},className:"ml-1 hover:text-destructive",children:s.jsx(Re,{name:"x",size:16,color:"var(--neutral-900)"})})]},me))]}),c?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Re,{name:"refresh",size:24,className:"animate-spin",color:"var(--neutral-600)"})}):o&&o.events.length===0?s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:"No events found for this vibe."})}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:oe.map(me=>s.jsx(B5,{event:me,onClick:()=>xe(me),socialProofCount:void 0},me.id))}),ie&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(ce,{variant:"outline",onClick:()=>u(me=>me+1),children:"Load More"})}),!ie&&o&&o.events.length>0&&s.jsxs("div",{className:"text-center py-4 text-sm text-muted-foreground",children:["Showing all ",o.events.length," events"]})]})]}),v&&h&&s.jsx(Hl,{isOpen:v,onClose:()=>{g(!1),m(null)},event:h,currentUserId:t,isInterested:x,onInterestToggle:Q,onReview:()=>{console.log("Review event:",h.id)},onNavigateToProfile:a,onNavigateToChat:i})]})},zj=({title:e,description:t,items:r,loading:n=!1,emptyMessage:a="No items to display",className:i,itemClassName:o,showTitle:l=!0})=>n?s.jsxs("div",{className:Oe("space-y-2",i),children:[l&&e&&s.jsxs("div",{children:[s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:e}),t&&s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:t})]}),s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(Re,{name:"refresh",size:24,className:"animate-spin",color:"var(--neutral-600)"})})]}):r.length===0?s.jsxs("div",{className:Oe("space-y-2",i),children:[l&&e&&s.jsxs("div",{children:[s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:e}),t&&s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:t})]}),s.jsx("div",{className:"py-8",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",textAlign:"center"},children:s.jsx("p",{children:a})})]}):s.jsxs("div",{className:Oe("space-y-2",i),children:[l&&e&&s.jsxs("div",{children:[s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:e}),t&&s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:t})]}),s.jsx("div",{className:"overflow-x-auto pb-2 -mx-4 px-4 scrollbar-hide",children:s.jsx("div",{className:"flex gap-4 items-stretch",style:{width:"max-content",minWidth:"100%",justifyContent:"center"},children:r.map((c,d)=>s.jsx("div",{className:Oe("flex-shrink-0 h-full",o),children:c},d))})})]});class R8e{static getEventsByArtist(t,r,n=10){return E(this,null,function*(){try{const a=yield em.getUserTopArtists(t,20);if(!a.some(c=>c.artist_name.toLowerCase()===r.toLowerCase())){const{data:c}=yield T.from("events").select("*").ilike("artist_name",`%${r}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(n);return(c||[]).map(d=>V(D({},d),{reason:`Because you like ${r}`,sourceArtist:r}))}const o=a.filter(c=>c.artist_name.toLowerCase()===r.toLowerCase()).flatMap(c=>c.genres||[]);if(o.length===0){const{data:c}=yield T.from("events").select("*").ilike("artist_name",`%${r}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(n);return(c||[]).map(d=>V(D({},d),{reason:`Because you like ${r}`,sourceArtist:r}))}const{data:l}=yield T.from("events").select("*").gte("event_date",new Date().toISOString()).overlaps("genres",o).not("artist_name","ilike",`%${r}%`).order("event_date",{ascending:!0}).limit(n);return(l||[]).map(c=>V(D({},c),{reason:`Similar to ${r}`,sourceArtist:r}))}catch(a){return console.error("Error getting events by artist:",a),[]}})}static getEventsByVenue(t,r,n=10){return E(this,null,function*(){try{const{data:a}=yield T.from("events").select("*").ilike("venue_name",`%${r}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(n);return(a||[]).map(i=>V(D({},i),{reason:`At ${r} (you rated this venue highly)`,sourceVenue:r}))}catch(a){return console.error("Error getting events by venue:",a),[]}})}static getEventsByGenre(t,r,n=10){return E(this,null,function*(){try{const{data:a}=yield T.from("events").select("*").gte("event_date",new Date().toISOString()).contains("genres",[r]).order("event_date",{ascending:!0}).limit(n);return(a||[]).map(i=>V(D({},i),{reason:`Because you attend ${r} shows`,sourceGenre:r}))}catch(a){return console.error("Error getting events by genre:",a),[]}})}static getAllBecauseYouLike(t){return E(this,null,function*(){try{const r=[],n=yield em.getUserTopArtists(t,5);for(const h of n.slice(0,3)){const m=yield this.getEventsByArtist(t,h.artist_name,10);m.length>0&&r.push({title:`Because you like ${h.artist_name}`,events:m,type:"artist"})}const{data:a,error:i}=yield T.from("reviews").select("venue_rating, event_id").eq("user_id",t).eq("is_draft",!1).gte("venue_rating",4).not("venue_rating","is",null).limit(10);if(i)return console.warn("Error fetching venue reviews:",i),r;if(!a||a.length===0)return r;const o=a.map(h=>h.event_id).filter(Boolean),l=new Map;if(o.length>0){const{data:h}=yield T.from("events").select("id, venue_name").in("id",o);(h||[]).forEach(m=>{m.venue_name&&l.set(m.id,m.venue_name)})}const c=new Set;a.forEach(h=>{const m=l.get(h.event_id);m&&c.add(m)});for(const h of Array.from(c).slice(0,2)){const m=yield this.getEventsByVenue(t,h,10);m.length>0&&r.push({title:`At ${h} (you rated this venue highly)`,events:m,type:"venue"})}const{data:d}=yield T.from("reviews").select("events:event_id(genres)").eq("user_id",t).eq("is_draft",!1).not("events.genres","is",null).limit(20),f=new Map;(d||[]).forEach(h=>{var m;(m=h.events)!=null&&m.genres&&h.events.genres.forEach(v=>{f.set(v,(f.get(v)||0)+1)})});const u=Array.from(f.entries()).sort(([h,m],[v,g])=>g-m).slice(0,2).map(([h])=>h);for(const h of u){const m=yield this.getEventsByGenre(t,h,10);m.length>0&&r.push({title:`Because you attend ${h} shows`,events:m,type:"genre"})}return r}catch(r){return console.error("Error getting all because you like:",r),[]}})}static dismissRecommendation(t,r,n){return E(this,null,function*(){try{const{data:a}=yield T.from("users").select("dismissed_recommendations").eq("user_id",t).single(),i=(a==null?void 0:a.dismissed_recommendations)||[],o=`${r}:${n}`;i.includes(o)||(yield T.from("users").update({dismissed_recommendations:[...i,o]}).eq("user_id",t))}catch(a){console.error("Error dismissing recommendation:",a)}})}}const O8e=({currentUserId:e,onNavigateToProfile:t,onNavigateToChat:r})=>{const[n,a]=y.useState([]),[i,o]=y.useState(!0),[l,c]=y.useState(new Set),[d,f]=y.useState(null),[u,h]=y.useState(!1),[m,v]=y.useState(!1),[g,x]=y.useState(new Set);y.useEffect(()=>{b(),_(),w()},[e]);const _=()=>E(void 0,null,function*(){try{const A=yield Kr.getUserInterestedEventIdSet(e);x(A)}catch(A){console.error("Error loading interested events:",A)}}),w=()=>E(void 0,null,function*(){try{const{data:A}=yield T.from("users").select("dismissed_recommendations").eq("user_id",e).single();A!=null&&A.dismissed_recommendations&&c(new Set(A.dismissed_recommendations))}catch(A){console.error("Error loading dismissed carousels:",A)}}),b=()=>E(void 0,null,function*(){o(!0);try{const A=yield R8e.getAllBecauseYouLike(e);a(A)}catch(A){console.error("Error loading because you like carousels:",A),a([])}finally{o(!1)}}),N=A=>E(void 0,null,function*(){try{const R=`${A.type}:${A.title}`;c(z=>new Set(z).add(R));const{data:I}=yield T.from("users").select("dismissed_recommendations").eq("user_id",e).single(),O=(I==null?void 0:I.dismissed_recommendations)||[];O.includes(R)||(yield T.from("users").update({dismissed_recommendations:[...O,R]}).eq("user_id",e)),a(z=>z.filter(M=>M.title!==A.title))}catch(R){console.error("Error dismissing carousel:",R)}}),S=A=>E(void 0,null,function*(){try{const{data:R}=yield T.from("events").select("*").eq("id",A.id).single();if(R){f(R);const I=yield Kr.isUserInterested(e,R.id);v(I),h(!0)}else f(A),v(g.has(A.id||"")),h(!0)}catch(R){console.error("Error fetching event details:",R),f(A),v(g.has(A.id||"")),h(!0)}}),k=(A,R)=>E(void 0,null,function*(){try{yield Kr.setEventInterest(e,A,R),x(I=>{const O=new Set(I);return R?O.add(A):O.delete(A),O}),v(R)}catch(I){console.error("Error toggling interest:",I)}}),C=n.filter(A=>{const R=`${A.type}:${A.title}`;return!l.has(R)});return C.length===0&&!i?null:s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-6",children:C.map(A=>s.jsxs("div",{className:"relative",children:[s.jsx(zj,{title:A.title,items:A.events.slice(0,10).map(R=>s.jsx(B5,{event:R,onClick:()=>S(R)},R.id)),loading:i,emptyMessage:`No events found for ${A.title}`}),s.jsx(ce,{variant:"ghost",size:"sm",className:"absolute top-0 right-0",onClick:()=>N(A),children:s.jsx(Re,{name:"x",size:16,color:"var(--neutral-900)"})})]},A.title))}),u&&d&&s.jsx(Hl,{isOpen:u,onClose:()=>{h(!1),f(null)},event:d,currentUserId:e,isInterested:m,onInterestToggle:k,onReview:()=>{console.log("Review event:",d.id)},onNavigateToProfile:t,onNavigateToChat:r})]})},wK=({scene:e,onClick:t,className:r})=>{var d,f,u,h,m;const n=e.userProgress,a=((d=e.participants)==null?void 0:d.length)||(((f=e.participating_artists)==null?void 0:f.length)||0)+(((u=e.participating_venues)==null?void 0:u.length)||0)+(((h=e.participating_cities)==null?void 0:h.length)||0)+(((m=e.participating_genres)==null?void 0:m.length)||0),i=n?(n.artists_experienced||0)+(n.venues_experienced||0)+(n.cities_experienced||0)+(n.genres_experienced||0):0,o=a,l=i,c=o>0?Math.min(l/o*100,100):0;return s.jsx(Ze,{className:Oe("cursor-pointer transition-all hover:shadow-lg flex flex-col h-full min-h-[400px] w-[320px] flex-shrink-0 swift-ui-card",r),onClick:t,children:s.jsxs("div",{className:"swift-ui-card-content flex flex-col h-full",children:[s.jsxs(kr,{className:"pb-2",children:[s.jsx(Lr,{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)"},children:e.name}),e.short_description&&s.jsx("p",{className:"mt-1 line-clamp-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:e.short_description})]}),s.jsxs(tt,{className:"flex-1 flex flex-col space-y-3",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:"Progress"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[l,"/",o," participants"]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"8px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all duration-300",style:{width:`${c}%`,background:"var(--gradient-brand)",borderRadius:c>=100?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:c>0?"4px":"0"}})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:"Participants"}),e.participants&&e.participants.length>0?s.jsxs(s.Fragment,{children:[(()=>{const v=e.participants.filter(g=>g.participant_type==="artist"&&g.artist_name);return v.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Re,{name:"music",size:16,color:"var(--neutral-600)"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:["Artists (",v.length,")"]})]}),s.jsxs("p",{className:"line-clamp-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[v.slice(0,3).map(g=>g.artist_name).filter(Boolean).join(", "),v.length>3&&` +${v.length-3}`]})]})})(),(()=>{const v=e.participants.filter(g=>g.participant_type==="venue"&&g.venue_name);return v.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Re,{name:"location",size:16,color:"var(--neutral-600)"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:["Venues (",v.length,")"]})]}),s.jsxs("p",{className:"line-clamp-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[v.slice(0,3).map(g=>g.venue_name).filter(Boolean).join(", "),v.length>3&&` +${v.length-3}`]})]})})()]}):s.jsxs(s.Fragment,{children:[e.participating_venues&&e.participating_venues.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Re,{name:"location",size:16,color:"var(--neutral-600)"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:["Venues (",e.participating_venues.length,")"]})]}),s.jsxs("p",{className:"line-clamp-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[e.participating_venues.slice(0,3).join(", "),e.participating_venues.length>3&&` +${e.participating_venues.length-3}`]})]}),e.participating_artists&&e.participating_artists.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Re,{name:"music",size:16,color:"var(--neutral-600)"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:["Artists (",e.participating_artists.length,")"]})]}),s.jsxs("p",{className:"line-clamp-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[e.participating_artists.slice(0,3).join(", "),e.participating_artists.length>3&&` +${e.participating_artists.length-3}`]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-2 border-t mt-auto",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Re,{name:"calendar",size:16,color:"var(--neutral-600)"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[e.upcomingEventsCount||0," upcoming"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Re,{name:"twoUsers",size:16,color:"var(--neutral-600)"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[e.activeReviewersCount||0," reviewers"]})]})]})]})]})})};class bK{static getScenes(t=10,r){return E(this,null,function*(){try{let n=T.from("scenes").select("*").eq("is_active",!0).order("sort_order",{ascending:!0}).order("is_featured",{ascending:!1}).limit(t);const{data:a,error:i}=yield n;if(i)throw i;if(!a||a.length===0)return[];let o=new Map;if(r)try{const g=a.map(w=>w.id),{data:x,error:_}=yield T.from("user_scene_progress").select("*").eq("user_id",r).in("scene_id",g);!_&&x&&x.forEach(w=>{o.set(w.scene_id,w)})}catch(g){}const l=a.map(g=>g.id),{data:c}=yield T.from("scene_participants").select(`
          id,
          scene_id,
          participant_type,
          artist_id,
          venue_id,
          text_value
        `).in("scene_id",l),d=[...new Set((c==null?void 0:c.filter(g=>g.artist_id).map(g=>g.artist_id))||[])],f=[...new Set((c==null?void 0:c.filter(g=>g.venue_id).map(g=>g.venue_id))||[])],u=new Map;if(d.length>0){const{data:g}=yield T.from("artists").select("id, name").in("id",d);g==null||g.forEach(x=>u.set(x.id,x.name))}const h=new Map;if(f.length>0){const{data:g}=yield T.from("venues").select("id, name").in("id",f);g==null||g.forEach(x=>h.set(x.id,x.name))}const m=new Map;return c&&c.forEach(g=>{m.has(g.scene_id)||m.set(g.scene_id,[]),m.get(g.scene_id).push({id:g.id,participant_type:g.participant_type,artist_id:g.artist_id,venue_id:g.venue_id,text_value:g.text_value,artist_name:g.artist_id?u.get(g.artist_id):void 0,venue_name:g.venue_id?h.get(g.venue_id):void 0})}),yield Promise.all(a.map(g=>E(this,null,function*(){const x=m.get(g.id)||[],_=x.filter(C=>C.participant_type==="artist"&&C.artist_id).map(C=>C.artist_id),w=x.filter(C=>C.participant_type==="venue"&&C.venue_id).map(C=>C.venue_id),b=x.filter(C=>C.participant_type==="city"&&C.text_value).map(C=>C.text_value),N=x.filter(C=>C.participant_type==="genre"&&C.text_value).map(C=>C.text_value),S=yield this.getUpcomingEventsCount(V(D({},g),{participating_artists:_,participating_venues:w,participating_cities:b,participating_genres:N})),k=yield this.getActiveReviewersCount(g.id,N);return V(D({},g),{participants:x,participating_artists:_,participating_venues:w,participating_cities:b,participating_genres:N,upcomingEventsCount:S,activeReviewersCount:k,userProgress:o.get(g.id)})})))}catch(n){return console.error("Error getting scenes:",n),[]}})}static getActiveReviewersCount(t,r){return E(this,null,function*(){try{const{data:n}=yield T.from("scenes").select("*").eq("id",t).single();if(!n)return 0;let a=T.from("events").select("id").gte("event_date",new Date().toISOString());n.participating_artists&&n.participating_artists.length>0&&(a=a.in("artist_id",n.participating_artists).not("artist_id","is",null)),n.participating_venues&&n.participating_venues.length>0&&(a=a.in("venue_id",n.participating_venues).not("venue_id","is",null)),n.participating_cities&&n.participating_cities.length>0&&(a=a.in("venue_city",n.participating_cities)),r&&r.length>0&&(a=a.overlaps("genres",r));const{data:i}=yield a.limit(100);if(!i||i.length===0)return 0;const o=i.map(d=>d.id),{count:l,error:c}=yield T.from("reviews").select("user_id",{count:"exact",head:!0}).in("event_id",o).eq("is_draft",!1).eq("was_there",!0);if(c)throw c;return l||0}catch(n){return console.error("Error counting active reviewers:",n),0}})}static getUpcomingEventsCount(t){return E(this,null,function*(){try{let r=T.from("events").select("id",{count:"exact",head:!0}).gte("event_date",new Date().toISOString());t.participating_artists&&t.participating_artists.length>0&&(r=r.in("artist_id",t.participating_artists).not("artist_id","is",null)),t.participating_venues&&t.participating_venues.length>0&&(r=r.in("venue_id",t.participating_venues).not("venue_id","is",null)),t.participating_cities&&t.participating_cities.length>0&&(r=r.in("venue_city",t.participating_cities)),t.participating_genres&&t.participating_genres.length>0&&(r=r.overlaps("genres",t.participating_genres));const{count:n,error:a}=yield r;if(a)throw a;return n||0}catch(r){return console.error("Error counting upcoming events:",r),0}})}static getUserSceneProgress(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("user_scene_progress").select("*").eq("user_id",t).eq("scene_id",r).maybeSingle();return a?a.code==="PGRST116"?null:a.code==="PGRST301"||a.status===406?(console.warn("RLS blocking access to user_scene_progress:",{code:a.code,status:a.status,message:a.message}),null):(console.warn("Error getting user scene progress:",a),null):n}catch(n){return console.warn("Error getting user scene progress:",n),null}})}static refreshSceneProgress(t,r){return E(this,null,function*(){try{const{error:n}=yield T.rpc("calculate_scene_progress",{p_user_id:t,p_scene_id:r});return n?(console.warn("Scene progress calculation failed (non-critical):",n),!1):!0}catch(n){return console.warn("Error refreshing scene progress (non-critical):",n),!1}})}static getAllUserSceneProgress(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("get_all_user_scene_progress",{p_user_id:t});if(!n&&r)return r;n&&n.status!==406&&console.warn("RPC function error (non-critical):",n);const{data:a,error:i}=yield T.from("user_scene_progress").select("*").eq("user_id",t).order("last_activity_at",{ascending:!1});return i?i.code==="PGRST301"||i.status===406?[]:(console.warn("Error getting all user scene progress:",i),[]):a||[]}catch(r){return console.warn("Error getting all user scene progress:",r),[]}})}static generateScenes(t=10){return E(this,null,function*(){return this.getScenes(t)})}static getSceneDetails(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("scenes").select("*").eq("id",t).eq("is_active",!0).single();if(a||!n)return null;let i=null;if(r)try{i=yield this.getUserSceneProgress(r,t)}catch(O){}const{data:o}=yield T.from("scene_participants").select(`
          id,
          participant_type,
          artist_id,
          venue_id,
          text_value
        `).eq("scene_id",t),l=[...new Set((o==null?void 0:o.filter(O=>O.artist_id).map(O=>O.artist_id))||[])],c=[...new Set((o==null?void 0:o.filter(O=>O.venue_id).map(O=>O.venue_id))||[])],d=new Map;if(l.length>0){const{data:O}=yield T.from("artists").select("id, name, identifier").in("id",l);O==null||O.forEach(z=>d.set(z.id,{name:z.name,identifier:z.identifier}))}const f=new Map;if(c.length>0){const{data:O}=yield T.from("venues").select("id, name, identifier").in("id",c);O==null||O.forEach(z=>f.set(z.id,{name:z.name,identifier:z.identifier}))}const u=[],h=[],m=[],v=[],g=[];o&&o.forEach(O=>{var z,M;if(g.push({id:O.id,participant_type:O.participant_type,artist_id:O.artist_id,venue_id:O.venue_id,text_value:O.text_value,artist_name:O.artist_id?(z=d.get(O.artist_id))==null?void 0:z.name:void 0,venue_name:O.venue_id?(M=f.get(O.venue_id))==null?void 0:M.name:void 0}),O.participant_type==="artist"&&O.artist_id){const B=d.get(O.artist_id);B!=null&&B.identifier&&u.push(B.identifier)}else if(O.participant_type==="venue"&&O.venue_id){const B=f.get(O.venue_id);B!=null&&B.identifier&&h.push(B.identifier)}else O.participant_type==="city"&&O.text_value?m.push(O.text_value):O.participant_type==="genre"&&O.text_value&&v.push(O.text_value)});const x=[],_=new Set,w=[];if(u.length>0){const O=T.from("events").select("*").gte("event_date",new Date().toISOString()).not("artist_id","is",null).order("event_date",{ascending:!0}).limit(200).then(({data:z,error:M})=>{if(M)throw M;return z?z.filter(F=>F.artist_id?u.some(U=>{if(F.artist_id===U)return!0;const H=F.artist_id.replace(/^jambase:/,""),q=U.replace(/^jambase:/,"");return H===q}):!1):[]});x.push(O)}if(h.length>0){const O=g.filter(M=>M.participant_type==="venue"&&M.venue_name).map(M=>M.venue_name).filter(Boolean),z=T.from("events").select("*").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(500).then(({data:M,error:B})=>{if(B)throw B;return M?M.filter(U=>U.venue_id&&h.some(q=>{if(U.venue_id===q)return!0;const K=U.venue_id.replace(/^jambase:/,""),Z=q.replace(/^jambase:/,"");return K===Z})?!0:U.venue_name&&O.length>0?O.some(H=>{var Z;const q=(Z=U.venue_name)==null?void 0:Z.toLowerCase().trim(),K=H==null?void 0:H.toLowerCase().trim();return!q||!K?!1:q===K||q.includes(K)||K.includes(q)}):!1):[]});x.push(z)}if(m.length>0){const O=T.from("events").select("*").gte("event_date",new Date().toISOString()).in("venue_city",m).order("event_date",{ascending:!0}).limit(50);x.push(O)}if(v.length>0){const O=T.from("events").select("*").gte("event_date",new Date().toISOString()).overlaps("genres",v).order("event_date",{ascending:!0}).limit(50);x.push(O)}if(x.length>0)try{(yield Promise.all(x)).forEach((z,M)=>{let B=[];Array.isArray(z)?B=z:z&&typeof z=="object"&&"data"in z&&(B=z.data||[]),B.forEach(F=>{F&&F.id&&!_.has(F.id)&&(_.add(F.id),w.push(F))})})}catch(O){console.error("Error fetching scene events:",O)}const b=w.sort((O,z)=>new Date(O.event_date).getTime()-new Date(z.event_date).getTime()).slice(0,20),N=(b||[]).map(O=>O.id);let S=T.from("reviews").select("user_id, event_id").eq("is_draft",!1).eq("was_there",!0).limit(100);N.length>0?S=S.in("event_id",N):S=S.eq("event_id","00000000-0000-0000-0000-000000000000");const{data:k}=yield S,C=[...new Set((k||[]).map(O=>O.user_id))],{data:A}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",C.length>0?C:[""]),R=new Map,I=new Map((A||[]).map(O=>[O.user_id,O]));return(k||[]).forEach(O=>{const z=O.user_id,M=I.get(z);if(z&&M){const B=R.get(z)||{user_id:z,name:M.name||"User",avatar_url:M.avatar_url,review_count:0};B.review_count+=1,R.set(z,B)}}),V(D({},n),{participants:g,participating_artists:u,participating_venues:h,participating_cities:m,participating_genres:v,userProgress:i||void 0,upcomingEvents:b||[],activeReviewers:Array.from(R.values()).sort((O,z)=>z.review_count-O.review_count).slice(0,10)})}catch(n){return console.error("Error getting scene details:",n),null}})}static getSceneEvents(t,r=20){return E(this,null,function*(){try{const n=yield this.getSceneDetails(t);return n?n.upcomingEvents.slice(0,r):[]}catch(n){return console.error("Error getting scene events:",n),[]}})}static getSceneReviewers(t){return E(this,null,function*(){try{const r=yield this.getSceneDetails(t);return r?r.activeReviewers:[]}catch(r){return console.error("Error getting scene reviewers:",r),[]}})}}const M8e=({sceneId:e,userId:t,onBack:r,onNavigateToProfile:n,onNavigateToChat:a})=>{var me,Me,Te,Ve;const i=ts(),[o,l]=y.useState(null),[c,d]=y.useState(!0),[f,u]=y.useState(null),[h,m]=y.useState(!1),[v,g]=y.useState(!1),[x,_]=y.useState(new Set),[w,b]=y.useState(new Set),[N,S]=y.useState(new Map),[k,C]=y.useState(new Map),[A,R]=y.useState(!1),[I,O]=y.useState(!1),[z,M]=y.useState(null),[B,F]=y.useState(""),[U,H]=y.useState(null),[q,K]=y.useState("");y.useEffect(()=>{de(),Z()},[e,t]),y.useEffect(()=>{o&&(ne(),Y(),X())},[o,t]);const Z=()=>E(void 0,null,function*(){try{const le=yield Kr.getUserInterestedEventIdSet(t);_(le)}catch(le){console.error("Error loading interested events:",le)}}),ne=()=>E(void 0,null,function*(){if(o!=null&&o.participants)try{const le=o.participants.filter(ze=>ze.participant_type==="artist"&&ze.artist_id).map(ze=>ze.artist_id),Ke=o.participants.filter(ze=>ze.participant_type==="venue"&&ze.venue_id).map(ze=>ze.venue_id),De=new Set;if(le.length>0){const ze=new Set(le),{data:vt}=yield T.from("passport_entries").select("entity_id, entity_uuid").eq("user_id",t).eq("type","artist").in("entity_uuid",le),rr=new Map;yield Promise.all(le.map(Ce=>E(void 0,null,function*(){const{data:Ge}=yield T.rpc("get_external_id",{p_entity_uuid:Ce,p_source:"jambase",p_entity_type:"artist"});Ge&&rr.set(Ce,Ge)})));const sr=Array.from(rr.values()),Ae=new Set;sr.forEach(Ce=>{Ae.add(Ce),Ae.add(`jambase:${Ce}`)});let Ue=[];if(sr.length>0){const{data:Ce}=yield T.from("passport_entries").select("entity_id, entity_uuid").eq("user_id",t).eq("type","artist").is("entity_uuid",null);Ue=(Ce||[]).filter(Ge=>{if(!Ge.entity_id)return!1;const Nt=Ge.entity_id.replace(/^jambase:/,"");return Ae.has(Ge.entity_id)||Ae.has(Nt)})}[...vt||[],...Ue].forEach(Ce=>{var Ge;if(Ce.entity_uuid&&ze.has(Ce.entity_uuid))De.add(`artist:${Ce.entity_uuid}`);else if(Ce.entity_id){const Nt=Ce.entity_id.replace(/^jambase:/,""),Tt=(Ge=Array.from(rr.entries()).find(([at,ue])=>ue===Nt||`jambase:${ue}`===Ce.entity_id))==null?void 0:Ge[0];Tt&&De.add(`artist:${Tt}`)}})}if(Ke.length>0){const ze=new Set(Ke),{data:vt}=yield T.from("passport_entries").select("entity_id, entity_uuid").eq("user_id",t).eq("type","venue").in("entity_uuid",Ke),rr=new Map;yield Promise.all(Ke.map(Ce=>E(void 0,null,function*(){const{data:Ge}=yield T.rpc("get_external_id",{p_entity_uuid:Ce,p_source:"jambase",p_entity_type:"venue"});Ge&&rr.set(Ce,Ge)})));const sr=Array.from(rr.values()),Ae=new Set;sr.forEach(Ce=>{Ae.add(Ce),Ae.add(`jambase:${Ce}`)});let Ue=[];if(sr.length>0){const{data:Ce}=yield T.from("passport_entries").select("entity_id, entity_uuid").eq("user_id",t).eq("type","venue").is("entity_uuid",null);Ue=(Ce||[]).filter(Ge=>{if(!Ge.entity_id)return!1;const Nt=Ge.entity_id.replace(/^jambase:/,"");return Ae.has(Ge.entity_id)||Ae.has(Nt)})}[...vt||[],...Ue].forEach(Ce=>{var Ge;if(Ce.entity_uuid&&ze.has(Ce.entity_uuid))De.add(`venue:${Ce.entity_uuid}`);else if(Ce.entity_id){const Nt=Ce.entity_id.replace(/^jambase:/,""),Tt=(Ge=Array.from(rr.entries()).find(([at,ue])=>ue===Nt||`jambase:${ue}`===Ce.entity_id))==null?void 0:Ge[0];Tt&&De.add(`venue:${Tt}`)}})}const nt=o.participants.filter(ze=>ze.participant_type==="city"&&ze.text_value).map(ze=>ze.text_value);if(nt.length>0){const{data:ze}=yield T.from("passport_entries").select("entity_name").eq("user_id",t).eq("type","city").in("entity_name",nt);ze==null||ze.forEach(vt=>De.add(`city:${vt.entity_name}`))}b(De)}catch(le){console.error("Error loading participant experience:",le)}}),Y=()=>E(void 0,null,function*(){if(!(o!=null&&o.participants))return;const le=new Map,Ke=new Date().toISOString();try{yield Promise.all(o.participants.map(De=>E(void 0,null,function*(){let nt=0;const ze=`${De.participant_type}:${De.artist_id||De.venue_id||De.text_value}`;try{if(De.participant_type==="artist"&&De.artist_id){const{count:vt}=yield T.from("events").select("id",{count:"exact",head:!0}).gte("event_date",Ke).eq("artist_id",De.artist_id);nt=vt||0}else if(De.participant_type==="venue"&&De.venue_id){const{count:vt}=yield T.from("events").select("id",{count:"exact",head:!0}).gte("event_date",Ke).eq("venue_id",De.venue_id);nt=vt||0}else if(De.participant_type==="city"&&De.text_value){const{count:vt}=yield T.from("events").select("id",{count:"exact",head:!0}).gte("event_date",Ke).eq("venue_city",De.text_value);nt=vt||0}le.set(ze,nt)}catch(vt){console.error(`Error loading event count for ${ze}:`,vt),le.set(ze,0)}}))),S(le)}catch(De){console.error("Error loading participant event counts:",De)}}),X=()=>E(void 0,null,function*(){if(!(o!=null&&o.participants))return;const le=new Map;try{const Ke=o.participants.filter(nt=>nt.participant_type==="artist"&&nt.artist_id).map(nt=>nt.artist_id);if(Ke.length>0){const{data:nt}=yield T.from("artists").select("id, image_url").in("id",Ke);nt==null||nt.forEach(ze=>{ze.image_url&&le.set(`artist:${ze.id}`,ze.image_url)})}const De=o.participants.filter(nt=>nt.participant_type==="venue"&&nt.venue_id).map(nt=>nt.venue_id);if(De.length>0){const{data:nt}=yield T.from("venues").select("id, image_url").in("id",De);nt==null||nt.forEach(ze=>{ze.image_url&&le.set(`venue:${ze.id}`,ze.image_url)})}C(le)}catch(Ke){console.error("Error loading participant images:",Ke)}}),se=le=>{le.type==="artist"&&le.participantId?i(`/artist/${le.participantId}`):le.type==="venue"&&le.participantId?i(`/venue/${le.participantId}`):le.type==="artist"&&le.name?i(`/artist/${encodeURIComponent(le.name)}`):le.type==="venue"&&le.name&&i(`/venue/${encodeURIComponent(le.name)}`)},de=()=>E(void 0,null,function*(){d(!0);try{const le=yield bK.getSceneDetails(e,t);l(le)}catch(le){console.error("Error loading scene details:",le)}finally{d(!1)}}),_e=le=>E(void 0,null,function*(){try{const{data:Ke}=yield T.from("events").select("*").eq("id",le.id).single();if(Ke){u(Ke);const De=yield Kr.isUserInterested(t,Ke.id);g(De),m(!0)}else u(le),g(x.has(le.id||"")),m(!0)}catch(Ke){console.error("Error fetching event details:",Ke),u(le),g(x.has(le.id||"")),m(!0)}}),xe=(le,Ke)=>E(void 0,null,function*(){try{yield Kr.setEventInterest(t,le,Ke),_(De=>{const nt=new Set(De);return Ke?nt.add(le):nt.delete(le),nt}),g(Ke)}catch(De){console.error("Error toggling interest:",De)}});if(c)return s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx(Re,{name:"refresh",size:24,className:"animate-spin",color:"var(--neutral-600)"})});if(!o)return s.jsx("div",{className:"min-h-screen bg-background",children:s.jsxs("div",{className:"max-w-6xl mx-auto px-4 pt-4 pb-6",children:[s.jsxs(ce,{variant:"ghost",onClick:()=>{window.history.length>1?i(-1):r()},className:"mb-4",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[s.jsx(Re,{name:"leftArrow",size:16,style:{marginRight:"var(--spacing-inline, 6px)"},color:"var(--neutral-900)"}),"Back to Discover"]}),s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:"Scene not found"})})]})});const Q=o.userProgress,oe=Q&&Q.discovery_state!=="undiscovered",ie=((me=o.participants)==null?void 0:me.filter(le=>le.participant_type==="venue"&&le.venue_name))||[],ee=((Me=o.participants)==null?void 0:Me.filter(le=>le.participant_type==="artist"&&le.artist_name))||[],G=((Te=o.participants)==null?void 0:Te.filter(le=>le.participant_type==="genre"&&le.text_value))||[],J=((Ve=o.participants)==null?void 0:Ve.filter(le=>le.participant_type==="city"&&le.text_value))||[],ae=ee.length,fe=ie.length,we=J.length,ve=G.length;return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/20",children:[s.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 pt-4",style:{paddingBottom:"calc(var(--spacing-bottom-nav, 112px) + env(safe-area-inset-bottom, 0px) + var(--spacing-grouped, 24px))"},children:[s.jsxs(ce,{variant:"ghost",size:"sm",onClick:()=>{window.history.length>1?i(-1):r()},className:"mb-6",children:[s.jsx(Re,{name:"leftArrow",size:16,className:"mr-2",color:"var(--neutral-900)"}),"Back to Discover"]}),s.jsxs("div",{className:"mb-8",children:[(o.image_url||o.scene_url)&&s.jsx("div",{className:"w-full h-80 rounded-2xl overflow-hidden mb-6 shadow-lg",children:s.jsx("img",{src:o.image_url||o.scene_url||"",alt:o.name,className:"w-full h-full object-cover"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h1",{className:"text-4xl font-bold tracking-tight",children:o.name}),o.short_description&&s.jsx("p",{className:"text-xl text-muted-foreground font-medium",children:o.short_description}),o.description&&s.jsx("p",{className:"text-base text-muted-foreground leading-relaxed max-w-3xl",children:o.description})]})]}),oe&&s.jsx(Ze,{className:"mb-8 shadow-lg",style:{backgroundColor:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(236, 72, 153, 0.2)",borderRadius:"var(--radius-corner, 20px)"},children:s.jsxs(tt,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"p-2 rounded-lg bg-synth-pink/10",children:s.jsx(Re,{name:"trendingUp",size:24,color:"var(--brand-pink-500)"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Your Progress"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Track your journey through this scene"})]}),s.jsx(et,{variant:Q.discovery_state==="completed"?"default":"secondary",className:"text-sm px-3 py-1",children:Q.discovery_state.replace("_"," ")})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Overall Progress"}),s.jsxs("span",{className:"text-lg font-bold text-synth-pink",children:[Q.progress_percentage,"%"]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"12px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${Q.progress_percentage}%`,background:"var(--gradient-brand)",borderRadius:Q.progress_percentage>=100?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:Q.progress_percentage>0?"4px":"0"}})})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[ae>0&&s.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(255, 255, 255, 0.5)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",border:"1px solid rgba(0, 0, 0, 0.1)"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Re,{name:"music",size:16,color:"var(--neutral-600)"}),s.jsx("span",{className:"text-sm font-medium",children:"Artists"})]}),s.jsxs("span",{className:"text-sm font-bold",children:[Q.artists_experienced,"/",ae]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"8px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all",style:{width:`${ae>0?Q.artists_experienced/ae*100:0}%`,backgroundColor:"var(--brand-pink-500)",borderRadius:Q.artists_experienced/ae>=1?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:Q.artists_experienced/ae>0?"4px":"0"}})})]}),fe>0&&s.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(255, 255, 255, 0.5)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",border:"1px solid rgba(0, 0, 0, 0.1)"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Re,{name:"location",size:16,color:"var(--neutral-600)"}),s.jsx("span",{className:"text-sm font-medium",children:"Venues"})]}),s.jsxs("span",{className:"text-sm font-bold",children:[Q.venues_experienced,"/",fe]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"8px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all",style:{width:`${fe>0?Q.venues_experienced/fe*100:0}%`,backgroundColor:"var(--brand-pink-500)",borderRadius:Q.venues_experienced/fe>=1?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:Q.venues_experienced/fe>0?"4px":"0"}})})]}),we>0&&s.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(255, 255, 255, 0.5)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",border:"1px solid rgba(0, 0, 0, 0.1)"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Re,{name:"location",size:16,color:"var(--neutral-600)"}),s.jsx("span",{className:"text-sm font-medium",children:"Cities"})]}),s.jsxs("span",{className:"text-sm font-bold",children:[Q.cities_experienced,"/",we]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"8px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all",style:{width:`${we>0?Q.cities_experienced/we*100:0}%`,backgroundColor:"var(--brand-pink-500)",borderRadius:Q.cities_experienced/we>=1?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:Q.cities_experienced/we>0?"4px":"0"}})})]}),ve>0&&s.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(255, 255, 255, 0.5)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",border:"1px solid rgba(0, 0, 0, 0.1)"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Re,{name:"mediumShootingStar",size:16,color:"var(--neutral-600)"}),s.jsx("span",{className:"text-sm font-medium",children:"Genres"})]}),s.jsxs("span",{className:"text-sm font-bold",children:[Q.genres_experienced,"/",ve]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"8px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all",style:{width:`${ve>0?Q.genres_experienced/ve*100:0}%`,backgroundColor:"var(--brand-pink-500)",borderRadius:Q.genres_experienced/ve>=1?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:Q.genres_experienced/ve>0?"4px":"0"}})})]})]}),Q.events_experienced>0&&s.jsxs("div",{className:"mt-4 p-3 rounded-lg flex items-center gap-3",style:{backgroundColor:"rgba(236, 72, 153, 0.1)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",border:"1px solid rgba(236, 72, 153, 0.2)"},children:[s.jsx(Re,{name:"circleCheck",size:24,className:"flex-shrink-0",color:"var(--brand-pink-500)"}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium",children:[s.jsx("span",{className:"text-synth-pink font-bold",children:Q.events_experienced})," events attended"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Keep exploring to complete this scene!"})]})]})]})}),s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[s.jsx(Re,{name:"mediumShootingStar",size:24,color:"var(--brand-pink-500)"}),s.jsx("h2",{className:"text-2xl font-bold",children:"Participants"})]}),s.jsxs("div",{className:"space-y-3",children:[ie.map(le=>{const Ke=`venue:${le.venue_id}`,De=w.has(Ke),nt=N.get(Ke)||0,ze=k.get(Ke);return s.jsx(Ze,{className:"cursor-pointer transition-all hover:shadow-lg",style:{backgroundColor:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"var(--radius-corner, 16px)"},onClick:()=>se({type:"venue",name:le.venue_name||"",id:le.id,participantId:le.venue_id}),children:s.jsx(tt,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:ze?s.jsx("img",{src:ze,alt:le.venue_name,className:"w-16 h-16 rounded-lg object-cover"}):s.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Re,{name:"location",size:35,color:"var(--neutral-600)"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"truncate",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h3-size, 18px)",fontWeight:"var(--typography-h3-weight, 600)",lineHeight:"var(--typography-h3-line-height, 1.4)",color:"var(--neutral-900)"},children:le.venue_name}),De&&s.jsx(Re,{name:"circleCheck",size:24,className:"flex-shrink-0",color:"var(--status-success-500)"})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsxs("span",{className:"flex items-center gap-1 flex-shrink-0",children:[s.jsx(Re,{name:"calendar",size:24,color:"var(--neutral-600)"}),nt," ",nt===1?"upcoming event":"upcoming events"]}),s.jsx("div",{className:"flex-shrink-0",style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:De?"var(--brand-pink-050)":"var(--neutral-100)",border:De?"2px solid var(--brand-pink-500)":"2px solid var(--neutral-200)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:De?"var(--brand-pink-500)":"var(--neutral-900)",boxShadow:"0 4px 4px 0 var(--shadow-color)",whiteSpace:"nowrap"},children:De?"Experienced":"Not Experienced"})]})]})]})})},le.id)}),ee.map(le=>{const Ke=`artist:${le.artist_id}`,De=w.has(Ke),nt=N.get(Ke)||0,ze=k.get(Ke);return s.jsx(Ze,{className:"cursor-pointer transition-all hover:shadow-lg",style:{backgroundColor:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"var(--radius-corner, 16px)"},onClick:()=>se({type:"artist",name:le.artist_name||"",id:le.id,participantId:le.artist_id}),children:s.jsx(tt,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:ze?s.jsx("img",{src:ze,alt:le.artist_name,className:"w-16 h-16 rounded-lg object-cover"}):s.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Re,{name:"music",size:35,color:"var(--neutral-600)"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"truncate",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h3-size, 18px)",fontWeight:"var(--typography-h3-weight, 600)",lineHeight:"var(--typography-h3-line-height, 1.4)",color:"var(--neutral-900)"},children:le.artist_name}),De&&s.jsx(Re,{name:"circleCheck",size:24,className:"flex-shrink-0",color:"var(--status-success-500)"})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsxs("span",{className:"flex items-center gap-1 flex-shrink-0",children:[s.jsx(Re,{name:"calendar",size:24,color:"var(--neutral-600)"}),nt," ",nt===1?"upcoming event":"upcoming events"]}),s.jsx("div",{className:"flex-shrink-0",style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:De?"var(--brand-pink-050)":"var(--neutral-100)",border:De?"2px solid var(--brand-pink-500)":"2px solid var(--neutral-200)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:De?"var(--brand-pink-500)":"var(--neutral-900)",boxShadow:"0 4px 4px 0 var(--shadow-color)",whiteSpace:"nowrap"},children:De?"Experienced":"Not Experienced"})]})]})]})})},le.id)}),J.map(le=>{const Ke=`city:${le.text_value}`,De=w.has(Ke),nt=N.get(Ke)||0;return s.jsx(Ze,{className:"cursor-pointer transition-all hover:shadow-lg",style:{backgroundColor:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"var(--radius-corner, 16px)"},onClick:()=>se({type:"city",name:le.text_value||"",id:le.id,textValue:le.text_value}),children:s.jsx(tt,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Re,{name:"location",size:35,color:"var(--neutral-600)"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"truncate",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h3-size, 18px)",fontWeight:"var(--typography-h3-weight, 600)",lineHeight:"var(--typography-h3-line-height, 1.4)",color:"var(--neutral-900)"},children:le.text_value}),De&&s.jsx(Re,{name:"circleCheck",size:24,className:"flex-shrink-0",color:"var(--status-success-500)"})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsxs("span",{className:"flex items-center gap-1 flex-shrink-0",children:[s.jsx(Re,{name:"calendar",size:24,color:"var(--neutral-600)"}),nt," ",nt===1?"upcoming event":"upcoming events"]}),s.jsx("div",{className:"flex-shrink-0",style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:De?"var(--brand-pink-050)":"var(--neutral-100)",border:De?"2px solid var(--brand-pink-500)":"2px solid var(--neutral-200)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:De?"var(--brand-pink-500)":"var(--neutral-900)",boxShadow:"0 4px 4px 0 var(--shadow-color)",whiteSpace:"nowrap"},children:De?"Experienced":"Not Experienced"})]})]})]})})},le.id)}),G.map(le=>{const Ke=`genre:${le.text_value}`,De=N.get(Ke)||0;return s.jsx(Ze,{className:"cursor-pointer transition-all hover:shadow-lg",style:{backgroundColor:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"var(--radius-corner, 16px)"},onClick:()=>se({type:"genre",name:le.text_value||"",id:le.id,textValue:le.text_value}),children:s.jsx(tt,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Re,{name:"mediumShootingStar",size:35,color:"var(--neutral-600)"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"flex items-center gap-2 mb-1",children:s.jsx("h3",{className:"truncate",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h3-size, 18px)",fontWeight:"var(--typography-h3-weight, 600)",lineHeight:"var(--typography-h3-line-height, 1.4)",color:"var(--neutral-900)"},children:le.text_value})}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Re,{name:"calendar",size:16,color:"var(--neutral-900)"}),De," ",De===1?"upcoming event":"upcoming events"]}),s.jsx(et,{variant:"secondary",className:"text-xs",children:"Genre"})]})]})]})})},le.id)})]})]}),o.upcomingEvents.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Re,{name:"calendar",size:24,color:"var(--brand-pink-500)"}),s.jsxs("h2",{className:"text-2xl font-bold",children:["Upcoming Events (",o.upcomingEvents.length,")"]})]}),s.jsx(zj,{title:"",showTitle:!1,items:o.upcomingEvents.map(le=>s.jsx(B5,{event:le,onClick:()=>_e(le)},le.id)),emptyMessage:"No upcoming events"})]}),o.activeReviewers.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Re,{name:"twoUsers",size:24,color:"var(--brand-pink-500)"}),s.jsxs("h2",{className:"text-2xl font-bold",children:["Active Reviewers (",o.activeReviewers.length,")"]})]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:o.activeReviewers.map(le=>s.jsx(Ze,{className:"cursor-pointer hover:shadow-md transition-all",style:{backgroundColor:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"var(--radius-corner, 16px)"},onClick:()=>n==null?void 0:n(le.user_id),children:s.jsx(tt,{className:"p-4",children:s.jsxs("div",{className:"flex flex-col items-center text-center space-y-2",children:[s.jsxs(Wr,{className:"w-12 h-12",children:[s.jsx(Qr,{src:le.avatar_url||void 0}),s.jsx(Hr,{className:"bg-synth-pink/10 text-synth-pink",children:le.name.charAt(0).toUpperCase()})]}),s.jsxs("div",{className:"w-full",children:[s.jsx("p",{className:"text-sm font-medium truncate",children:le.name}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[le.review_count," ",le.review_count===1?"review":"reviews"]})]})]})})},le.user_id))})]})]}),h&&f&&s.jsx(Hl,{isOpen:h,onClose:()=>{m(!1),u(null)},event:f,currentUserId:t,isInterested:v,onInterestToggle:xe,onReview:()=>{console.log("Review event:",f.id)},onNavigateToProfile:n,onNavigateToChat:a}),z&&s.jsx(fw,{isOpen:A,onClose:()=>{R(!1),M(null),F("")},artistId:z,artistName:B,currentUserId:t}),U&&s.jsx(hw,{isOpen:I,onClose:()=>{O(!1),H(null),K("")},venueId:U,venueName:q,currentUserId:t})]})},D8e=({currentUserId:e,onNavigateToProfile:t,onNavigateToChat:r})=>{const[n,a]=y.useState([]),[i,o]=y.useState(!0),[l,c]=y.useState(null);y.useEffect(()=>{d()},[e]);const d=()=>E(void 0,null,function*(){o(!0);try{const h=yield bK.getScenes(10,e);a(h)}catch(h){console.error("Error loading scenes:",h),a([])}finally{o(!1)}}),f=h=>{c(h)},u=()=>{c(null)};return l?s.jsx(M8e,{sceneId:l,userId:e,onBack:u,onNavigateToProfile:t,onNavigateToChat:r}):n.length===0&&!i?null:s.jsx(zj,{title:"Scenes & Signals",description:"Music scenes defined by genre overlap, venue clusters, and co-attendance patterns",items:n.map(h=>s.jsx(wK,{scene:h,onClick:()=>f(h.id)},h.id)),loading:i,emptyMessage:"No scenes found",itemClassName:"w-[320px]"})};class ZS{static getArtistTourEvents(t){return E(this,null,function*(){try{console.log(` [TOUR_TRACKER] Fetching tour events for artist ID: ${t}`);const{data:r,error:n}=yield T.from("artists").select("id, name, identifier").eq("id",t).single();if(n||!r)return console.error(" [TOUR_TRACKER] Artist not found:",n),[];console.log(` [TOUR_TRACKER] Found artist: ${r.name} (UUID: ${r.id}, Identifier: ${r.identifier})`);const{data:a,error:i}=yield T.from("events").select("*").eq("artist_id",r.id).gte("event_date",new Date().toISOString()).not("latitude","is",null).not("longitude","is",null).order("event_date",{ascending:!0});if(i)throw console.error(" [TOUR_TRACKER] Error fetching events:",i),i;return console.log(` [TOUR_TRACKER] Found ${(a==null?void 0:a.length)||0} upcoming events for ${r.name}`),(a||[]).map(o=>V(D({},o),{latitude:Number(o.latitude),longitude:Number(o.longitude),venue_city:o.venue_city||"",venue_state:o.venue_state||void 0}))}catch(r){return console.error("Error fetching artist tour events:",r),[]}})}static calculateTourRoute(t){const r=[...t].sort((a,i)=>{const o=new Date(a.event_date).getTime(),l=new Date(i.event_date).getTime();return o-l}),n=[];for(let a=0;a<r.length-1;a++){const i=r[a],o=r[a+1];i.latitude&&i.longitude&&o.latitude&&o.longitude&&n.push({from:{lat:i.latitude,lng:i.longitude,city:`${i.venue_city}${i.venue_state?`, ${i.venue_state}`:""}`},to:{lat:o.latitude,lng:o.longitude,city:`${o.venue_city}${o.venue_state?`, ${o.venue_state}`:""}`}})}return{events:r,route:n}}static getArtistGroupChats(t,r){return E(this,null,function*(){try{const n=[],{data:a}=yield T.from("artists").select("id, name, identifier").eq("id",t).single();if(!a)return console.warn(` [TOUR_TRACKER] Artist not found for ID: ${t}`),[];const i=a.name,{data:o,error:l}=yield T.from("chats").select("id, chat_name, users").ilike("chat_name",`%${i}%`).eq("is_group_chat",!0);if(!l&&o)for(const d of o){const f=Array.isArray(d.users)?d.users.length:0;n.push({id:d.id,name:d.chat_name||"Unnamed Chat",chat_id:d.id,member_count:f})}const{data:c}=yield T.from("events").select("id, title").eq("artist_id",a.id).gte("event_date",new Date().toISOString()).limit(10);if(c)for(const d of c){const{data:f}=yield T.from("chats").select("id, chat_name, users").ilike("chat_name",`%${d.title}%`).eq("is_group_chat",!0);if(f){for(const u of f)if(!n.find(h=>h.id===u.id)){const h=Array.isArray(u.users)?u.users.length:0;n.push({id:u.id,name:u.chat_name||"Unnamed Chat",chat_id:u.id,event_id:d.id,member_count:h})}}}return n}catch(n){return console.error("Error fetching artist group chats:",n),[]}})}}class I8e{constructor(){Pr(this,"pendingRequests",new Map);Pr(this,"REQUEST_TIMEOUT",3e4)}deduplicate(t,r){return E(this,null,function*(){this.cleanupExpiredRequests();const n=this.pendingRequests.get(t);if(n)return console.log(` Request deduplication: Reusing pending request for key: ${t}`),n.promise;console.log(` Request deduplication: Creating new request for key: ${t}`);const a=r().finally(()=>{this.pendingRequests.delete(t)});return this.pendingRequests.set(t,{promise:a,timestamp:Date.now()}),a})}cleanupExpiredRequests(){const t=Date.now();for(const[r,n]of this.pendingRequests.entries())t-n.timestamp>this.REQUEST_TIMEOUT&&(console.log(` Request deduplication: Cleaning up expired request for key: ${r}`),this.pendingRequests.delete(r))}clear(){console.log(` Request deduplication: Clearing ${this.pendingRequests.size} pending requests`),this.pendingRequests.clear()}getPendingCount(){return this.pendingRequests.size}}const $8e=new I8e,L8e={events:e=>`events_${e.userId||"anonymous"}_${e.limit||20}_${e.offset||0}`,promotions:e=>`promotions_${e.userId||"anonymous"}_${e.tier||"all"}_${e.limit||10}`,profile:e=>`profile_${e}`,reviews:e=>`reviews_${e.eventId||"all"}_${e.userId||"anonymous"}_${e.limit||20}`,friends:e=>`friends_${e}`,search:e=>`search_${e.query}_${e.type||"all"}_${e.limit||20}`,location:e=>`location_${e.lat}_${e.lng}_${e.radius||25}`},V$={basic:{name:"Basic",price:49.99,duration_days:7,features:["Homepage promotion","Search boost","Basic analytics","7-day duration"],color:"blue"},premium:{name:"Premium",price:149.99,duration_days:14,features:["Homepage featured section","Priority in search","Advanced analytics","Social media sharing","14-day duration"],color:"purple"},featured:{name:"Featured",price:499.99,duration_days:30,features:["Top homepage placement","Email newsletter feature","Premium badge","Full analytics suite","Dedicated support","30-day duration"],color:"gold"}};class F8e{static createPromotion(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("promote_event",{p_event_id:t.event_id,p_promotion_tier:t.promotion_tier,p_starts_at:t.starts_at,p_expires_at:t.expires_at,p_target_cities:t.target_cities||null,p_target_genres:t.target_genres||null});if(n)throw n;return r}catch(r){throw console.error("Error creating promotion:",r),r}})}static getUserPromotions(t){return E(this,null,function*(){const r=L8e.promotions({userId:t});return $8e.deduplicate(r,()=>E(this,null,function*(){try{const{data:{user:n},error:a}=yield T.auth.getUser();if(a||!n)throw new Error("User not authenticated");const i=t||n.id,{data:o,error:l}=yield T.from("event_promotions").select(`
            *,
            event:events(
              id,
              title,
              artist_name,
              venue_name,
              event_date,
              poster_image_url
            )
          `).eq("promoted_by_user_id",i).order("created_at",{ascending:!1});if(l)throw l;return o||[]}catch(n){throw console.error("Error fetching user promotions:",n),n}}))})}static getActivePromotions(t,r=10){return E(this,null,function*(){try{let n=T.from("event_promotions").select(`
          *,
          event:events(*)
        `).eq("promotion_status","active").lte("starts_at",new Date().toISOString()).gte("expires_at",new Date().toISOString()).order("created_at",{ascending:!1}).limit(r);t&&(n=n.eq("promotion_tier",t));const{data:a,error:i}=yield n;if(i)throw i;return a||[]}catch(n){throw console.error("Error fetching active promotions:",n),n}})}static getPromotion(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select(`
          *,
          event:events(*)
        `).eq("id",t).single();if(n)throw n;return r}catch(r){throw console.error("Error fetching promotion:",r),r}})}static getPendingPromotions(){return E(this,null,function*(){try{const{data:t,error:r}=yield T.from("event_promotions").select(`
          *,
          event:jambase_events(
            id,
            title,
            artist_name,
            venue_name,
            event_date,
            poster_image_url
          ),
          promoter:users!event_promotions_promoted_by_user_id_fkey(
            user_id,
            name,
            avatar_url,
            account_type
          )
        `).eq("promotion_status","pending").order("created_at",{ascending:!0});if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching pending promotions:",t),t}})}static reviewPromotion(t,r,n,a){return E(this,null,function*(){try{const{error:i}=yield T.rpc("review_event_promotion",{p_promotion_id:t,p_approved:r,p_admin_notes:n||null,p_rejection_reason:a||null});if(i)throw i}catch(i){throw console.error("Error reviewing promotion:",i),i}})}static cancelPromotion(t){return E(this,null,function*(){try{const{error:r}=yield T.from("event_promotions").update({promotion_status:"paused",updated_at:new Date().toISOString()}).eq("id",t);if(r)throw r}catch(r){throw console.error("Error canceling promotion:",r),r}})}static trackImpression(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("increment",{table_name:"event_promotions",row_id:t,column_name:"impressions"});if(r){const{data:n}=yield T.from("event_promotions").select("impressions").eq("id",t).single();n&&(yield T.from("event_promotions").update({impressions:(n.impressions||0)+1}).eq("id",t))}}catch(r){console.error("Error tracking impression:",r)}})}static trackClick(t){return E(this,null,function*(){try{const{data:r}=yield T.from("event_promotions").select("clicks").eq("id",t).single();r&&(yield T.from("event_promotions").update({clicks:(r.clicks||0)+1}).eq("id",t))}catch(r){console.error("Error tracking click:",r)}})}static trackConversion(t){return E(this,null,function*(){try{const{data:r}=yield T.from("event_promotions").select("conversions").eq("id",t).single();r&&(yield T.from("event_promotions").update({conversions:(r.conversions||0)+1}).eq("id",t))}catch(r){console.error("Error tracking conversion:",r)}})}static getPromotionAnalytics(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select("impressions, clicks, conversions, price_paid").eq("id",t).single();if(n)throw n;const a=r.impressions>0?r.clicks/r.impressions*100:0,i=r.clicks>0?r.conversions/r.clicks*100:0,o=r.clicks>0?r.price_paid/r.clicks:0,l=r.conversions>0?r.price_paid/r.conversions:0;return V(D({},r),{ctr:a.toFixed(2),conversion_rate:i.toFixed(2),cost_per_click:o.toFixed(2),cost_per_conversion:l.toFixed(2)})}catch(r){throw console.error("Error fetching promotion analytics:",r),r}})}static getPromotionPricing(t){return V$[t].price}static getPromotionTierInfo(t){return V$[t]}static canPromoteEvent(t){return E(this,null,function*(){try{const{data:{user:r}}=yield T.auth.getUser();if(!r)return!1;const{data:n}=yield T.from("events").select("created_by_user_id").eq("id",t).single();return n?n.created_by_user_id===r.id:!1}catch(r){return console.error("Error checking promotion eligibility:",r),!1}})}}function z8e({promotionId:e,enabled:t=!0,threshold:r=1}){const n=y.useRef(null),a=y.useRef(null),i=y.useRef(!1),o=`promotion_impression_${e}`,l=y.useCallback(()=>E(this,null,function*(){if(!t||i.current)return;if(sessionStorage.getItem(o)){i.current=!0;return}try{yield F8e.trackImpression(e),sessionStorage.setItem(o,"true"),i.current=!0}catch(d){console.error("Error tracking promotion impression:",d)}}),[e,t,o]);return y.useEffect(()=>{if(!t||!n.current)return;const c=n.current;let d;const f=h=>{h[0].isIntersecting?a.current=Date.now():a.current=null};d=new IntersectionObserver(f,{threshold:.5,rootMargin:"0px"}),d.observe(c);const u=setInterval(()=>{a.current&&!i.current&&(Date.now()-a.current)/1e3>=r&&l()},500);return()=>{d.disconnect(),clearInterval(u)}},[t,r,l]),n}function B8e(e){return!e||e.trim()===""||e==="NULL"?"Venue TBD":e.trim()}function jK(e,t){const r=[];return e&&e.trim()!==""&&e!=="NULL"&&r.push(e.trim()),t&&t.trim()!==""&&t!=="NULL"&&r.push(t.trim()),r.length>0?r.join(", "):""}function U8e(e,t,r,n){const a=[];e&&e.trim()!==""&&e!=="NULL"&&a.push(e.trim());const i=jK(t,r);return i&&a.push(i),n&&n.trim()!==""&&n!=="NULL"&&a.push(n.trim()),a.length>0?a.join(", "):""}function U5({event:e,onInterestToggle:t,onReview:r,isInterested:n=!1,hasReviewed:a=!1,showInterestButton:i=!0,showReviewButton:o=!0,currentUserId:l,onOpenInterestedUsers:c,className:d,onClick:f}){const[u,h]=y.useState(!1),[m,v]=y.useState(null),[g,x]=y.useState(null),[_,w]=y.useState(!1),{toast:b}=Er(),N=z8e({promotionId:e.active_promotion_id||"",enabled:e.is_promoted&&!!e.active_promotion_id}),S=U=>new Date(U).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),k=U=>new Date(U).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),C=U=>U?new Date(U).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):null,A=new Date(e.event_date)<new Date,R=new Date(e.event_date)>=new Date,I=U=>E(this,null,function*(){if(U.stopPropagation(),!(!t||u)){h(!0);try{yield t(e.id,!n)}catch(H){console.error("Error toggling interest:",H)}finally{h(!1)}}}),O=U=>{U.stopPropagation(),r&&r(e.id)},z=B8e(e.venue_name),M=jK(e.venue_city,e.venue_state),B=U8e(e.venue_address,e.venue_city,e.venue_state,e.venue_zip);y.useEffect(()=>{E(this,null,function*(){var H;try{const q=yield Kr.getInterestedCountsByEventId([e.id],l||void 0);v((H=q.get(e.id))!=null?H:0)}catch(q){console.error("Error fetching interested count:",q),v(null)}})},[e.id,l]),y.useEffect(()=>{E(this,null,function*(){var U,H,q,K;try{if(e.images&&Array.isArray(e.images)&&e.images.length>0){const Y=e.images.find(X=>X.url&&(X.ratio==="16_9"||X.width&&X.width>1e3))||e.images.find(X=>X.url);if(Y!=null&&Y.url){x(Va(Y.url)||null);return}}const Z=yield T.from("reviews").select("photos").eq("event_id",e.id).not("photos","is",null).order("likes_count",{ascending:!1}).limit(1),ne=Array.isArray(Z.data)&&((H=(U=Z.data[0])==null?void 0:U.photos)==null?void 0:H[0]);if(ne){x(Va(ne)||null);return}if(e.artist_name&&e.id){const Y=yield T.from("reviews").select("photos").not("photos","is",null).eq("event_id",e.id).order("likes_count",{ascending:!1}).limit(1),X=Array.isArray(Y.data)&&((K=(q=Y.data[0])==null?void 0:q.photos)==null?void 0:K[0]);if(X){x(Va(X)||null);return}}}catch(Z){console.error("Error resolving event image:",Z)}x(null)})},[e.id,e.artist_id,e.artist_name,e.images]);const F=()=>{if(!e.ticket_urls||e.ticket_urls.length===0)return null;const U=["stubhub","vividseats","seatgeek","ticketmaster","axs"],H=e.ticket_urls.map(q=>({url:q,l:q.toLowerCase()}));for(const q of U){const K=H.find(Z=>Z.l.includes(q));if(K)return K.url}return e.ticket_urls[0]};return s.jsxs(Ze,{ref:N,className:Oe("w-full transition-all duration-200 hover:shadow-lg",e.is_promoted&&"ring-2 ring-yellow-400/50 shadow-lg shadow-yellow-200/30 border-yellow-200/50",d),onClick:f,children:[g&&s.jsxs("div",{className:"h-48 w-full overflow-hidden rounded-t-lg relative",children:[s.jsx("img",{src:g,alt:e.title,className:"w-full h-full object-cover",loading:"lazy",onError:U=>{console.warn("Failed to load event image:",g),x(null)}}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/10 to-transparent pointer-events-none"})]}),s.jsx(kr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx(Lr,{className:"text-lg leading-tight mb-2",children:e.title}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-2",children:[s.jsx(Lt,{className:"w-4 h-4"}),s.jsx("span",{children:S(e.event_date)}),s.jsx("span",{children:""}),s.jsx(Oa,{className:"w-4 h-4"}),s.jsx("span",{children:k(e.event_date)}),e.doors_time&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{children:["Doors: ",C(e.doors_time)]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[e.is_promoted&&e.promotion_tier&&s.jsx(G8,{promotionTier:e.promotion_tier}),A&&s.jsx(et,{variant:"secondary",className:"text-xs",children:"Past Event"}),R&&s.jsx(et,{variant:"default",className:"text-xs",children:"Upcoming"})]})]})}),s.jsxs(tt,{className:"pt-0 space-y-4",children:[z&&s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(yr,{className:"w-4 h-4 text-muted-foreground mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"font-medium text-sm",children:z}),l&&e.venue_name&&e.venue_name!=="Venue TBD"&&s.jsx(k1,{venueName:e.venue_name,venueCity:e.venue_city,venueState:e.venue_state,userId:l,variant:"ghost",size:"sm",showFollowerCount:!1,className:"h-6 text-xs"})]}),B&&s.jsx("div",{className:"text-sm text-muted-foreground",children:B}),!B&&M&&s.jsx("div",{className:"text-sm text-muted-foreground",children:M})]})]}),e.latitude!=null&&e.longitude!=null&&!Number.isNaN(Number(e.latitude))&&!Number.isNaN(Number(e.longitude))&&s.jsx("div",{className:"h-40 rounded-md overflow-hidden border border-gray-100",children:s.jsx(HT,{center:[Number(e.latitude),Number(e.longitude)],zoom:12,events:[e],onEventClick:()=>{}})}),e.description&&s.jsx("div",{className:"text-sm text-muted-foreground leading-relaxed",children:e.description.length>200?`${e.description.substring(0,200)}...`:e.description}),e.artist_name&&s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx(et,{variant:"outline",className:"text-xs",children:e.artist_name})}),l&&s.jsx(n0,{artistId:e.artist_id,artistName:e.artist_name,userId:l,variant:"ghost",size:"sm",showFollowerCount:!1,className:"h-7 text-xs"})]}),e.genres&&e.genres.length>0&&s.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.genres.slice(0,4).map((U,H)=>s.jsx(et,{variant:"secondary",className:"text-xs",children:U},H)),e.genres.length>4&&s.jsxs(et,{variant:"secondary",className:"text-xs",children:["+",e.genres.length-4," more"]})]}),e.tour_name&&s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Tour: "}),s.jsx("span",{className:"font-medium",children:e.tour_name})]}),e.price_range&&s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Price: "}),s.jsx("span",{className:"font-medium",children:Vv(e.price_range)})]}),l&&s.jsx("div",{className:"flex items-center justify-start pt-2 pb-2 border-t border-gray-100",children:s.jsx(D1,{entityType:"event",entityId:e.id,entityName:e.title,currentUserId:l,onChatOpen:U=>{window.location.href=`/chats?chatId=${U}`}})}),s.jsxs("div",{className:"flex items-center justify-between pt-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[R&&i&&t&&s.jsxs(ce,{variant:n?"default":"outline",size:"sm",onClick:I,disabled:u,className:Oe("transition-colors",n?"bg-red-500 hover:bg-red-600 text-white":"hover:bg-red-50 hover:text-red-600 hover:border-red-300"),children:[n?s.jsx(es,{className:"w-4 h-4 mr-1 fill-current"}):s.jsx(XQ,{className:"w-4 h-4 mr-1"}),n?"Interested":"Interested?"]}),A&&o&&r&&s.jsxs(ce,{variant:a?"default":"outline",size:"sm",onClick:O,className:Oe("transition-colors",a?"bg-yellow-500 hover:bg-yellow-600 text-white":"hover:bg-yellow-50 hover:text-yellow-600 hover:border-yellow-300"),children:[a?s.jsx(Xt,{className:"w-4 h-4 mr-1 fill-current"}):s.jsx(hee,{className:"w-4 h-4 mr-1"}),a?"Reviewed":"I Was There"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(q1,{children:[s.jsx(V1,{asChild:!0,children:s.jsxs(ce,{variant:"ghost",size:"sm",onClick:U=>{U.stopPropagation()},className:"text-pink-600 hover:text-pink-700 hover:bg-pink-50",children:[s.jsx(Dc,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline ml-1",children:"Share"})]})}),s.jsxs(c0,{align:"end",className:"w-52 bg-white/95 backdrop-blur-sm border shadow-lg z-50",children:[l&&s.jsxs(Yi,{onClick:U=>{U.stopPropagation(),w(!0)},className:"cursor-pointer bg-white hover:bg-gray-50",children:[s.jsx(Vr,{className:"w-4 h-4 mr-2"}),"Share with Synth Friends"]}),s.jsxs(Yi,{onClick:U=>E(this,null,function*(){U.stopPropagation();try{const H=yield ov.shareEvent(e.id,e.title,e.description||void 0);navigator.share?yield navigator.share({title:e.title,text:e.description||"Check out this event!",url:H}):(yield navigator.clipboard.writeText(H),b({title:"Link copied",description:H}))}catch(H){try{const q=yield ov.shareEvent(e.id,e.title,e.description||void 0);yield navigator.clipboard.writeText(q),b({title:"Link copied",description:q})}catch(q){b({title:"Error",description:"Failed to share",variant:"destructive"})}}}),className:"cursor-pointer bg-white hover:bg-gray-50",children:[s.jsx(Xi,{className:"w-4 h-4 mr-2"}),"Share"]}),s.jsxs(Yi,{onClick:U=>E(this,null,function*(){U.stopPropagation();try{const H=yield ov.shareEvent(e.id,e.title,e.description||void 0);yield navigator.clipboard.writeText(H),b({title:"Link copied",description:H})}catch(H){b({title:"Error",description:"Failed to copy link",variant:"destructive"})}}),className:"cursor-pointer bg-white hover:bg-gray-50",children:[s.jsx(Dc,{className:"w-4 h-4 mr-2"}),"Copy Link"]})]})]}),e.ticket_urls&&e.ticket_urls.length>0&&s.jsx(ce,{variant:"ghost",size:"sm",asChild:!0,className:"text-blue-600 hover:text-blue-700",children:s.jsxs("a",{href:F()||e.ticket_urls[0],target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1",onClick:()=>{try{Zt.click("ticket_link",e.id,{providerUrl:F()||e.ticket_urls[0],artist_name:e.artist_name,venue_name:e.venue_name},e.id)}catch(U){}},children:[s.jsx(zl,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Tickets"}),s.jsx(io,{className:"w-3 h-3"})]})})]})]}),s.jsxs("div",{className:"mt-3 flex items-center justify-between rounded-md border p-2",children:[s.jsx("div",{className:"text-sm text-muted-foreground",children:m===null?"Loading people going":`${m} others are interested`}),c&&s.jsx(ce,{size:"sm",variant:"outline",onClick:()=>c(e.id),children:"Meet people going"})]}),e.setlist&&s.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[s.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Setlist Preview:"}),s.jsx("div",{className:"text-sm",children:typeof e.setlist=="string"?e.setlist.substring(0,100)+"...":JSON.stringify(e.setlist).substring(0,100)+"..."})]})]}),l&&s.jsx(GT,{event:e,currentUserId:l,isOpen:_,onClose:()=>w(!1)})]})}const Ll=({event:e,interestedCount:t=0,isInterested:r=!1,isCommunityPhoto:n=!1,reason:a,onInterestClick:i,onShareClick:o,onClick:l,className:c})=>{const d=e.poster_image_url||e.image_url,f=d?Va(d):null,u=e.event_date?new Date(e.event_date):null,h=_=>_?Rt(_,"EEE, MMM d, yyyy"):"",m=()=>{if(!a)return null;const _={recommended:"Recommended",trending:"Trending",friend_interested:"Friend Interested",following:"Following"};return s.jsx("div",{className:"absolute left-4 px-3 py-1.5 rounded-lg",style:{top:"var(--spacing-grouped, 24px)",backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)",boxShadow:"0 4px 4px 0 var(--shadow-color)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",letterSpacing:"0.5px",textTransform:"uppercase",zIndex:50},"aria-label":`Event shown because: ${_[a]}`,children:_[a]})},v=()=>{if(l){try{const _=ef(e),w=Gv(e);Zt.click("event",e.id,V(D({},w),{source:"feed",reason:a||"unknown"}),_||void 0)}catch(_){console.error("Error tracking event card click:",_)}l()}},g=_=>{if(_.stopPropagation(),i){try{const w=ef(e);Zt.interest("event",e.id,!r,{source:"event_card",reason:a||"unknown"},w||void 0)}catch(w){console.error("Error tracking interest toggle:",w)}i(_)}},x=_=>{if(_.stopPropagation(),o){try{const w=ef(e);Zt.share("event",e.id,"native",{source:"event_card"},w||void 0)}catch(w){console.error("Error tracking share click:",w)}o(_)}};return s.jsxs("div",{className:Oe("swift-ui-card flex flex-col overflow-hidden","relative group cursor-pointer","w-full h-full max-h-[85vh]",c),onClick:v,onKeyDown:_=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),v())},tabIndex:0,role:"button","aria-label":`View event: ${e.title}`,children:[s.jsx("div",{className:"relative w-full flex-1 min-h-[60vh] max-h-[70vh] overflow-hidden",children:f?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:f,alt:e.title,className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(to top, rgba(14, 14, 14, 0.8) 0%, rgba(14, 14, 14, 0.4) 50%, transparent 100%)"}}),a&&m(),n&&s.jsx("div",{className:"absolute top-4 right-4 swift-ui-badge z-50","aria-hidden":"true",children:s.jsx("span",{className:"swift-ui-badge-text",children:"Community Photo"})})]}):s.jsx("div",{className:"w-full h-full flex items-center justify-center swift-ui-gradient-bg",children:s.jsx("div",{className:"text-center px-4",children:s.jsx("p",{className:"line-clamp-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-0)"},children:e.title})})})}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 swift-ui-card-content",style:{zIndex:40},children:[s.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(to top, color-mix(in srgb, var(--neutral-0) 96%, transparent) 0%, color-mix(in srgb, var(--neutral-0) 90%, transparent) 60%, color-mix(in srgb, var(--neutral-0) 70%, transparent) 100%)",backdropFilter:"blur(24px)",WebkitBackdropFilter:"blur(24px)"}}),s.jsxs("div",{className:"relative flex flex-col",style:{padding:"var(--spacing-grouped, 24px)",gap:"var(--spacing-small, 12px)"},children:[s.jsx("h2",{className:"line-clamp-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:e.title}),s.jsxs("div",{className:"flex flex-col",style:{gap:"var(--spacing-inline, 6px)"},children:[e.venue_name&&s.jsxs("div",{className:"flex items-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx(yr,{size:20,style:{color:"var(--brand-pink-500)"}}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-700)"},children:[e.venue_name,e.venue_city&&`  ${e.venue_city}`]})]}),u&&s.jsxs("div",{className:"flex items-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx(Lt,{size:20,style:{color:"var(--brand-pink-500)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-700)"},children:h(u)})]})]}),t>0&&s.jsxs("div",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[t," ",t===1?"person":"people"," interested"]}),s.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[s.jsxs("button",{onClick:_=>{_.stopPropagation(),g(_)},className:Oe("swift-ui-button",r?"swift-ui-button-primary":"swift-ui-button-secondary"),"aria-label":r?"Remove interest":"Mark as interested",children:[s.jsx("span",{style:{color:r?"var(--neutral-50)":"var(--brand-pink-500)"},children:"Interested"}),s.jsx(es,{size:24,strokeWidth:2.5,style:{color:r?"var(--neutral-50)":"var(--brand-pink-500)"},"aria-hidden":"true"})]}),s.jsx("button",{onClick:_=>{_.stopPropagation(),x(_)},className:"swift-ui-button swift-ui-button-secondary w-14 h-14","aria-label":"Share event",children:s.jsx(qc,{size:20,strokeWidth:2.5})})]})]})]})]})},q8e=e=>ya.divIcon({className:"numbered-marker",html:`<div style="
      background-color: #ec4899;
      color: white;
      border: 2px solid white;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    ">${e}</div>`,iconSize:[32,32],iconAnchor:[16,16]}),V8e=({events:e})=>{const t=Rf();return y.useEffect(()=>{if(e.length===0)return;const r=ya.latLngBounds(e.map(n=>[n.latitude,n.longitude]));r.isValid()&&t.fitBounds(r,{padding:[50,50]})},[t,e]),null},W8e=({currentUserId:e,filters:t,onNavigateToProfile:r,onNavigateToChat:n})=>{const a=ts(),[i,o]=y.useState("calendar"),[l,c]=y.useState(new Date),[d,f]=y.useState(new Map),[u,h]=y.useState(void 0),[m,v]=y.useState([]),[g,x]=y.useState(!1),[_,w]=y.useState(null),[b,N]=y.useState([]),[S,k]=y.useState([]),[C,A]=y.useState([]),[R,I]=y.useState(!1),[O,z]=y.useState(null),[M,B]=y.useState(!1),[F,U]=y.useState(new Set),[H,q]=y.useState(new Map),K=y.useRef(""),Z=y.useRef(!1),ne=y.useCallback(()=>E(void 0,null,function*(){x(!0);try{const G=new Date;G.setHours(0,0,0,0),console.log(" [CALENDAR] Loading upcoming events with optimized spatial filtering");let J=[];if(t!=null&&t.latitude&&(t!=null&&t.longitude)&&(t!=null&&t.radiusMiles)){console.log(" [CALENDAR] Using RPC function with spatial index");const{data:fe,error:we}=yield T.rpc("get_calendar_events",{p_latitude:t.latitude,p_longitude:t.longitude,p_radius_miles:t.radiusMiles,p_min_date:G.toISOString(),p_genres:t!=null&&t.genres&&t.genres.length>0?t.genres:null,p_limit:1500});if(we)throw we;J=fe||[],console.log(` [CALENDAR] Loaded ${J.length} events within ${t.radiusMiles} miles (using spatial index)`)}else if(t!=null&&t.cities&&t.cities.length>0){let fe=T.from("events").select("*").gte("event_date",G.toISOString()).in("venue_city",t.cities);t!=null&&t.genres&&t.genres.length>0&&(fe=fe.overlaps("genres",t.genres),console.log(" [CALENDAR] Applied genre filters:",t.genres));const{data:we,error:ve}=yield fe.order("event_date",{ascending:!0}).limit(1e4);if(ve)throw ve;J=we||[],console.log(" [CALENDAR] City filter:",J.length,"events")}else{console.log(" [CALENDAR] Using RPC function without location filter");const{data:fe,error:we}=yield T.rpc("get_calendar_events",{p_latitude:null,p_longitude:null,p_radius_miles:null,p_min_date:G.toISOString(),p_genres:t!=null&&t.genres&&t.genres.length>0?t.genres:null,p_limit:1e4});if(we)throw we;J=fe||[],console.log(" [CALENDAR] No location filter:",J.length,"events")}console.log(` [CALENDAR] Final count: ${J.length} events`);const ae=new Map;J.forEach(fe=>{const we=new Date(fe.event_date),ve=Rt(we,"yyyy-MM-dd");ae.has(ve)||ae.set(ve,[]),ae.get(ve).push(fe)}),console.log(` [CALENDAR] Grouped events into ${ae.size} unique dates`),f(ae)}catch(G){console.error("Error loading calendar events:",G)}finally{x(!1)}}),[t==null?void 0:t.latitude,t==null?void 0:t.longitude,t==null?void 0:t.radiusMiles,t==null?void 0:t.cities,t==null?void 0:t.genres]);y.useEffect(()=>{if(i!=="calendar")return;const G=JSON.stringify({lat:t==null?void 0:t.latitude,lng:t==null?void 0:t.longitude,radius:t==null?void 0:t.radiusMiles,cities:t==null?void 0:t.cities,genres:t==null?void 0:t.genres});if(G===K.current)return;const J=(t==null?void 0:t.latitude)&&(t==null?void 0:t.longitude)&&(t==null?void 0:t.radiusMiles),ae=(t==null?void 0:t.cities)&&t.cities.length>0;if(!J&&!ae&&Z.current){console.log(" [CALENDAR] Skipping load - filters cleared but we already have data");return}if(!J&&!ae&&!Z.current){console.log(" [CALENDAR] Skipping initial load - waiting for filters to be set");return}K.current=G,Z.current=!0,ne()},[i,t==null?void 0:t.latitude,t==null?void 0:t.longitude,t==null?void 0:t.radiusMiles,t==null?void 0:t.cities,t==null?void 0:t.genres,ne]),y.useEffect(()=>{i==="tour"&&_&&Y()},[i,_]);const Y=()=>E(void 0,null,function*(){if(!(!_||!_.id)){I(!0);try{const G=yield ZS.getArtistTourEvents(_.id);N(G);const J=ZS.calculateTourRoute(G);k(J.route);const ae=yield ZS.getArtistGroupChats(_.id,e);A(ae),e&&G.length>0&&(yield X(G.map(fe=>fe.id)))}catch(G){console.error("Error loading tour data:",G)}finally{I(!1)}}}),X=G=>E(void 0,null,function*(){if(!(!e||G.length===0))try{const J=yield Kr.getUserInterestedEventIdSet(e,G);U(J);const ae=yield Kr.getInterestedCountsByEventId(G);q(ae)}catch(J){console.error("Error loading interested data:",J)}}),se=G=>{if(h(G),!G){v([]);return}};y.useEffect(()=>{if(!u){v([]);return}const G=Rt(u,"yyyy-MM-dd"),ae=[...d.get(G)||[]].sort((fe,we)=>new Date(fe.event_date).getTime()-new Date(we.event_date).getTime());v(ae)},[d,u]);const de=G=>{const J=Rt(G,"yyyy-MM-dd");return d.get(J)||[]},_e=G=>{z(G),B(!0)},xe=b.length>0?[...b].sort((G,J)=>new Date(G.event_date).getTime()-new Date(J.event_date).getTime()):[],Q=G=>`${G.venue_name||""}|${G.venue_city||""}|${G.venue_state||""}`.toLowerCase(),oe=te.useMemo(()=>{if(xe.length===0)return[];const G=[],J=new Set;let ae=1;for(const fe of xe){const we=Q(fe);if(G.findIndex(me=>me.venueKey===we)===-1)G.push({venueKey:we,venueName:fe.venue_name||"Unknown Venue",venueCity:fe.venue_city||"",venueState:fe.venue_state,latitude:fe.latitude,longitude:fe.longitude,number:ae++,events:[fe],firstEventDate:new Date(fe.event_date)}),J.add(we);else{const me=G[G.length-1];me.venueKey===we?me.events.push(fe):G.push({venueKey:we,venueName:fe.venue_name||"Unknown Venue",venueCity:fe.venue_city||"",venueState:fe.venue_state,latitude:fe.latitude,longitude:fe.longitude,number:ae++,events:[fe],firstEventDate:new Date(fe.event_date)})}}return G},[xe]);te.useMemo(()=>{const G=new Map;return oe.forEach(J=>{J.events.forEach(ae=>{G.set(ae.id,J.number)})}),G},[oe]);const ie=te.useMemo(()=>{if(oe.length<2)return[];const G=[];for(let J=0;J<oe.length-1;J++){const ae=oe[J],fe=oe[J+1];G.push({from:{lat:ae.latitude,lng:ae.longitude,city:`${ae.venueCity}${ae.venueState?`, ${ae.venueState}`:""}`},to:{lat:fe.latitude,lng:fe.longitude,city:`${fe.venueCity}${fe.venueState?`, ${fe.venueState}`:""}`}})}return G},[oe]),ee=()=>{if(b.length===0)return[39.8283,-98.5795];const G=b.reduce((ae,fe)=>ae+fe.latitude,0)/b.length,J=b.reduce((ae,fe)=>ae+fe.longitude,0)/b.length;return[G,J]};return s.jsxs("div",{className:"mb-2 space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:"Discover Events"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Discover events by date, leaderboards, or artist tour"})]})}),s.jsxs(zi,{value:i,onValueChange:G=>o(G),children:[s.jsxs(wi,{className:"grid w-full grid-cols-3",style:{marginBottom:0,backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(236, 72, 153, 0.2)",borderRadius:"var(--radius-corner, 10px)",padding:"4px"},children:[s.jsxs(en,{value:"calendar",className:"flex items-center gap-2",children:[s.jsx(Re,{name:"calendar",size:16}),"Calendar"]}),s.jsxs(en,{value:"leaderboards",className:"flex items-center gap-2",children:[s.jsx(Re,{name:"ribbonAward",size:16}),"Leaderboards"]}),s.jsxs(en,{value:"tour",className:"flex items-center gap-2",children:[s.jsx(Re,{name:"route",size:16}),"Tour Tracker"]})]}),s.jsx(tn,{value:"calendar",className:"mt-8",children:g?s.jsx(Nc,{text:"Loading calendar...",size:"lg"}):s.jsxs("div",{className:"space-y-4 flex flex-col items-center justify-center",children:[s.jsx("div",{className:"flex justify-center w-full",children:s.jsx("div",{className:"swift-ui-card",children:s.jsx("div",{className:"swift-ui-card-content",children:s.jsx(h0,{mode:"single",selected:u,onSelect:se,month:l,onMonthChange:c,className:"rounded-md border",numberOfMonths:1,disabled:G=>{const J=new Date;J.setHours(0,0,0,0);const ae=new Date(G);return ae.setHours(0,0,0,0),ae<J},modifiers:{hasEvents:G=>de(G).length>0},modifiersClassNames:{hasEvents:"bg-synth-pink/20 border-synth-pink"}})})})}),u&&m.length>0&&s.jsxs("div",{className:"mt-4 space-y-2 w-full max-w-2xl",children:[s.jsxs("h3",{className:"font-semibold",children:["Events on ",Rt(u,"MMMM d, yyyy")]}),s.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto",children:m.map(G=>s.jsx(Ze,{className:"cursor-pointer hover:shadow-md swift-ui-card",onClick:()=>_e(G),children:s.jsx("div",{className:"swift-ui-card-content",children:s.jsx(tt,{className:"p-4",children:s.jsx("div",{className:"flex items-start justify-between",children:s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold",children:G.title}),s.jsx("p",{className:"text-sm text-muted-foreground",children:G.venue_name}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:Rt(new Date(G.event_date),"MMMM d, yyyy  h:mm a")})]})})})})},G.id))})]}),u&&m.length===0&&!g&&s.jsx("div",{className:"mt-4 text-center text-muted-foreground",children:s.jsx("p",{children:"No events found for the selected date."})})]})}),s.jsx(tn,{value:"leaderboards",className:"mt-8",children:s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(Re,{name:"ribbonAward",size:60,className:"mx-auto",color:"var(--neutral-600)"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Leaderboards are still in development"})]})})}),s.jsx(tn,{value:"tour",className:"mt-8",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search for an Artist"}),s.jsx(b1,{onArtistSelect:G=>w(G),placeholder:"Search for an artist to track their tour..."})]}),_&&s.jsx(Ze,{className:"overflow-hidden border-2 border-synth-pink/20 shadow-lg cursor-pointer hover:shadow-xl transition-shadow swift-ui-card",onClick:()=>{const G=_.id||encodeURIComponent(_.name);a(`/artist/${G}`)},children:s.jsx("div",{className:"swift-ui-card-content",children:s.jsx("div",{className:"relative p-6",style:{background:"linear-gradient(135deg, rgba(255, 51, 153, 0.1) 0%, rgba(255, 51, 153, 0.05) 100%)"},children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex-shrink-0",children:[_.image_url?s.jsx("img",{src:_.image_url,alt:_.name,className:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-lg",onError:G=>{var ae;const J=G.target;J.style.display="none",(ae=J.nextElementSibling)==null||ae.classList.remove("hidden")}}):null,!_.image_url&&s.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-synth-pink to-purple-500 flex items-center justify-center border-4 border-white shadow-lg",children:s.jsx(Re,{name:"music",size:60,color:"var(--neutral-50)"})})]}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2 truncate",children:_.name}),s.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[b.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Re,{name:"calendar",size:16,color:"var(--brand-pink-500)"}),s.jsxs("span",{className:"text-sm font-medium text-foreground",children:[b.length," ",b.length===1?"Tour Date":"Tour Dates"]})]}),_.genres&&_.genres.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Re,{name:"music",size:16,color:"var(--brand-pink-500)"}),s.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[_.genres.slice(0,3).map((G,J)=>s.jsx(et,{variant:"secondary",className:"text-xs bg-white/80 text-foreground border-synth-pink/20",children:G},J)),_.genres.length>3&&s.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",_.genres.length-3," more"]})]})]})]})]}),s.jsx(ce,{variant:"ghost",size:"sm",onClick:G=>{G.stopPropagation(),w(null),N([]),k([]),A([])},className:"flex-shrink-0 text-muted-foreground hover:text-foreground",children:s.jsx(Re,{name:"x",size:16,color:"var(--neutral-600)"})})]})})]})})})}),R?s.jsx(Nc,{text:"Loading tour data...",size:"lg"}):_&&b.length>0?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"h-96 rounded-lg overflow-hidden border relative z-0",children:s.jsxs(a0,{center:ee(),zoom:5,style:{height:"100%",width:"100%",zIndex:0},boundsOptions:{padding:[50,50]},children:[s.jsx(i0,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(V8e,{events:xe}),ie.map((G,J)=>{const ae=G.from.lat,fe=G.from.lng,we=G.to.lat,ve=G.to.lng,me=we-ae,Me=ve-fe,Te=ae+me*.85,Ve=fe+Me*.85,De=`
                        <svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
                          <g transform="translate(10,10) rotate(${Math.atan2(me,Me)*180/Math.PI}) translate(-10,-10)">
                            <polygon points="10,2 4,16 16,16" fill="#ec4899" stroke="white" stroke-width="1.5"/>
                          </g>
                        </svg>
                      `;return s.jsxs(te.Fragment,{children:[s.jsx(oU,{positions:[[ae,fe],[we,ve]],pathOptions:{color:"#ec4899",weight:3,opacity:.7}}),s.jsx(gf,{position:[Te,Ve],icon:ya.divIcon({className:"arrowhead-marker",html:De,iconSize:[20,20],iconAnchor:[10,10]})})]},J)}),oe.map(G=>s.jsx(gf,{position:[G.latitude,G.longitude],icon:q8e(G.number),eventHandlers:{click:()=>{G.events.length>0&&_e(G.events[0])}}},`${G.venueKey}-${G.number}`))]})}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("h3",{className:"font-semibold mb-3",children:["Tour Dates (",xe.length,")"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 max-h-96 overflow-y-auto",children:xe.map(G=>{var fe,we,ve,me;const J=F.has(G.id),ae=H.get(G.id)||0;return s.jsx(Ll,{event:{id:G.id,title:G.title||"",artist_name:G.artist_name,venue_name:G.venue_name,event_date:G.event_date,venue_city:G.venue_city,image_url:(we=(fe=G.images)==null?void 0:fe[0])==null?void 0:we.url,poster_image_url:(me=(ve=G.images)==null?void 0:ve[0])==null?void 0:me.url},interestedCount:ae,isInterested:J,onInterestClick:Me=>E(void 0,null,function*(){if(Me.stopPropagation(),!e)return;const Te=!J;U(Ve=>{const le=new Set(Ve);return Te?le.add(G.id):le.delete(G.id),le});try{yield Kr.setEventInterest(e,G.id,Te),q(Ve=>{const le=new Map(Ve),Ke=le.get(G.id)||0;return le.set(G.id,Te?Ke+1:Math.max(0,Ke-1)),le})}catch(Ve){console.error("Error toggling interest:",Ve),U(le=>{const Ke=new Set(le);return J?Ke.add(G.id):Ke.delete(G.id),Ke})}}),onClick:()=>_e(G)},G.id)})})]}),C.length>0&&s.jsxs("div",{className:"mt-4",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Related Group Chats"}),s.jsx("div",{className:"grid grid-cols-1 gap-2",children:C.map(G=>s.jsx(Ze,{className:"cursor-pointer hover:shadow-md swift-ui-card",onClick:()=>n&&G.chat_id&&n(G.chat_id),children:s.jsx("div",{className:"swift-ui-card-content",children:s.jsx(tt,{className:"p-4",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold",children:G.name}),G.member_count!==void 0&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[G.member_count," members"]})]})})})})},G.id))})]})]}):_?s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsxs("p",{children:["No upcoming events found for ",_.name]})}):s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:"Search for an artist to see their tour route"})})]})})]}),s.jsx(vn,{open:M,onOpenChange:B,children:s.jsx(hn,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:O&&s.jsx(U5,{event:O,currentUserId:e,onInterestToggle:()=>E(void 0,null,function*(){}),onReview:()=>E(void 0,null,function*(){}),isInterested:!1,hasReviewed:!1,showInterestButton:!0,showReviewButton:!0})})})]})},Fh=class Fh{static searchCity(t){const r=t.toLowerCase().trim();return this.CITY_COORDINATES[r]||null}static getAllCities(){return Object.values(this.CITY_COORDINATES)}static searchEventsByLocation(t){return E(this,null,function*(){try{const{latitude:r,longitude:n,radius:a,limit:i=50,startDate:o,endDate:l}=t,c=a/69,d=a/(69*Math.cos(r*Math.PI/180)),f=r-c,u=r+c,h=n-d,m=n+d;let v=T.from("events").select("*").not("latitude","is",null).not("longitude","is",null).gte("latitude",f).lte("latitude",u).gte("longitude",h).lte("longitude",m).gte("event_date",new Date().toISOString());o&&(v=v.gte("event_date",o)),l&&(v=v.lte("event_date",l)),!o&&!l&&(v=v.gte("event_date",new Date().toISOString()));const{data:g,error:x}=yield v.order("event_date",{ascending:!0}).limit(i);if(x)throw x;return(g||[]).map(b=>({id:b.id,jambase_event_id:b.jambase_event_id,title:b.title,artist_name:b.artist_name,artist_id:b.artist_id||"",venue_name:b.venue_name,venue_id:b.venue_id||"",event_date:b.event_date,doors_time:b.doors_time,description:b.description,genres:b.genres,venue_address:b.venue_address,venue_city:b.venue_city,venue_state:b.venue_state,venue_zip:b.venue_zip,latitude:b.latitude?Number(b.latitude):void 0,longitude:b.longitude?Number(b.longitude):void 0,ticket_available:b.ticket_available,price_range:b.price_range,ticket_urls:b.ticket_urls,setlist:b.setlist,tour_name:b.tour_name,created_at:b.created_at,updated_at:b.updated_at})).map(b=>V(D({},b),{distance:Fh.calculateDistance(r,n,b.latitude||0,b.longitude||0)})).filter(b=>b.distance<=a).sort((b,N)=>b.distance-N.distance)}catch(r){throw console.error("Error searching events by location:",r),new Error(`Failed to search events by location: ${r instanceof Error?r.message:"Unknown error"}`)}})}static calculateDistance(t,r,n,a){const o=u=>u*(Math.PI/180),l=o(n-t),c=o(a-r),d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(o(t))*Math.cos(o(n))*Math.sin(c/2)*Math.sin(c/2);return 3959*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}static toRadians(t){return t*(Math.PI/180)}static getCurrentLocation(){return E(this,null,function*(){return new Promise((t,r)=>{if(!navigator.geolocation){r(new Error("Geolocation is not supported by this browser"));return}navigator.geolocation.getCurrentPosition(n=>{t({latitude:n.coords.latitude,longitude:n.coords.longitude})},n=>{const a=new Error(`Failed to get location: ${n.message}`);a.code=n.code,r(a)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})})})}static isGeolocationDenied(){return!navigator.geolocation}static getLocationErrorMessage(t){var r;if((r=t==null?void 0:t.message)!=null&&r.includes("not supported")||!navigator.geolocation)return{title:"Location Not Supported",description:"Your browser doesn't support location services. Showing general events instead."};switch(t==null?void 0:t.code){case 1:return{title:"Location Access Denied",description:"Location access was denied. Showing general events instead."};case 2:return{title:"Location Unavailable",description:"Could not determine your location. Showing general events instead."};case 3:return{title:"Location Timeout",description:"Location request timed out. Showing general events instead."};default:return{title:"Location Error",description:"Could not access your location. Showing general events instead."}}}static reverseGeocode(t,r){return E(this,null,function*(){try{let n=null;const a=Object.values(this.CITY_COORDINATES);for(const l of a){const c=Fh.calculateDistance(t,r,l.lat,l.lng);(!n||c<n.distance)&&(n={name:l.state?`${l.name}, ${l.state}`:l.name,distance:c})}if(n&&n.distance<=25)return n.name;const i=yield fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${t}&lon=${r}&zoom=10&addressdetails=1`,{headers:{"User-Agent":"Synth-App/1.0"}});if(!i.ok)return console.warn("Reverse geocoding API failed, using nearest city fallback"),(n==null?void 0:n.name)||null;const o=yield i.json();if(o&&o.address){const l=o.address.city||o.address.town||o.address.village||o.address.municipality,c=o.address.state;if(l)return c?`${l}, ${c}`:l}return(n==null?void 0:n.name)||null}catch(n){console.error("Error in reverse geocoding:",n);let a=null;const i=Object.values(this.CITY_COORDINATES);for(const o of i){const l=Fh.calculateDistance(t,r,o.lat,o.lng);(!a||l<a.distance)&&(a={name:o.state?`${o.name}, ${o.state}`:o.name,distance:l})}return(a==null?void 0:a.name)||null}})}static searchEventsByCity(t,r=25,n=50){return E(this,null,function*(){const a=this.searchCity(t);return a?{events:yield this.searchEventsByLocation({latitude:a.lat,longitude:a.lng,radius:r,limit:n}),city:a}:{events:[],city:null}})}};Pr(Fh,"CITY_COORDINATES",{"new york":{name:"New York",lat:40.7128,lng:-74.006,state:"NY"},"los angeles":{name:"Los Angeles",lat:34.0522,lng:-118.2437,state:"CA"},chicago:{name:"Chicago",lat:41.8781,lng:-87.6298,state:"IL"},houston:{name:"Houston",lat:29.7604,lng:-95.3698,state:"TX"},phoenix:{name:"Phoenix",lat:33.4484,lng:-112.074,state:"AZ"},philadelphia:{name:"Philadelphia",lat:39.9526,lng:-75.1652,state:"PA"},"san antonio":{name:"San Antonio",lat:29.4241,lng:-98.4936,state:"TX"},"san diego":{name:"San Diego",lat:32.7157,lng:-117.1611,state:"CA"},dallas:{name:"Dallas",lat:32.7767,lng:-96.797,state:"TX"},austin:{name:"Austin",lat:30.2672,lng:-97.7431,state:"TX"},"washington dc":{name:"Washington DC",lat:38.9072,lng:-77.0369,state:"DC"},boston:{name:"Boston",lat:42.3601,lng:-71.0589,state:"MA"},denver:{name:"Denver",lat:39.7392,lng:-104.9903,state:"CO"},seattle:{name:"Seattle",lat:47.6062,lng:-122.3321,state:"WA"},"san francisco":{name:"San Francisco",lat:37.7749,lng:-122.4194,state:"CA"},miami:{name:"Miami",lat:25.7617,lng:-80.1918,state:"FL"},atlanta:{name:"Atlanta",lat:33.749,lng:-84.388,state:"GA"},nashville:{name:"Nashville",lat:36.1627,lng:-86.7816,state:"TN"},portland:{name:"Portland",lat:45.5152,lng:-122.6784,state:"OR"},"las vegas":{name:"Las Vegas",lat:36.1699,lng:-115.1398,state:"NV"},detroit:{name:"Detroit",lat:42.3314,lng:-83.0458,state:"MI"},memphis:{name:"Memphis",lat:35.1495,lng:-90.049,state:"TN"},baltimore:{name:"Baltimore",lat:39.2904,lng:-76.6122,state:"MD"},milwaukee:{name:"Milwaukee",lat:43.0389,lng:-87.9065,state:"WI"},albuquerque:{name:"Albuquerque",lat:35.0844,lng:-106.6504,state:"NM"},tucson:{name:"Tucson",lat:32.2226,lng:-110.9747,state:"AZ"},fresno:{name:"Fresno",lat:36.7378,lng:-119.7871,state:"CA"},sacramento:{name:"Sacramento",lat:38.5816,lng:-121.4944,state:"CA"},"kansas city":{name:"Kansas City",lat:39.0997,lng:-94.5786,state:"MO"},mesa:{name:"Mesa",lat:33.4152,lng:-111.8315,state:"AZ"},"virginia beach":{name:"Virginia Beach",lat:36.8529,lng:-75.978,state:"VA"},omaha:{name:"Omaha",lat:41.2524,lng:-95.998,state:"NE"},"colorado springs":{name:"Colorado Springs",lat:38.8339,lng:-104.8214,state:"CO"},raleigh:{name:"Raleigh",lat:35.7796,lng:-78.6382,state:"NC"},"long beach":{name:"Long Beach",lat:33.7701,lng:-118.1937,state:"CA"}});let Ua=Fh;const PC=Object.freeze(Object.defineProperty({__proto__:null,LocationService:Ua},Symbol.toStringTag,{value:"Module"})),H8e=({currentUserId:e,onBack:t,onNavigateToNotifications:r,onNavigateToProfile:n,onNavigateToChat:a,onViewChange:i,menuOpen:o=!1,onMenuClick:l,hideHeader:c=!1})=>{const[d,f]=y.useState(""),[u,h]=y.useState(!1),[m,v]=y.useState(!1),[g,x]=y.useState(null),[_,w]=y.useState(!1),[b,N]=y.useState({radiusMiles:30}),[S,k]=y.useState(!1),[C,A]=y.useState(""),[R,I]=y.useState(""),[O,z]=y.useState(!1),[M,B]=y.useState(null);go("view","discover",{source:"discover"}),y.useEffect(()=>{const X=()=>{w(window.innerWidth<768)};return X(),window.addEventListener("resize",X),()=>window.removeEventListener("resize",X)},[]),y.useEffect(()=>{F()},[e]);const F=()=>E(void 0,null,function*(){try{const{data:X}=yield T.from("users").select("latitude, longitude, location_city").eq("user_id",e).single();if(X!=null&&X.latitude&&(X!=null&&X.longitude)){const se={latitude:X.latitude,longitude:X.longitude};B(se),N(de=>V(D({},de),{latitude:se.latitude,longitude:se.longitude,radiusMiles:30})),I(X.location_city||"Current Location")}else try{const se=yield Ua.getCurrentLocation();B(se),N(de=>V(D({},de),{latitude:se.latitude,longitude:se.longitude,radiusMiles:30}));try{const de=yield Ua.reverseGeocode(se.latitude,se.longitude);I(de||"Current Location")}catch(de){(de==null?void 0:de.code)!==1&&console.error("Error reverse geocoding:",de),I("Current Location")}}catch(se){(se==null?void 0:se.code)!==1&&console.error("Error getting current location:",se),I("")}}catch(X){console.error("Error loading user location:",X);try{const se=yield Ua.getCurrentLocation();B(se),N(de=>V(D({},de),{latitude:se.latitude,longitude:se.longitude,radiusMiles:30}));try{const de=yield Ua.reverseGeocode(se.latitude,se.longitude);I(de||"Current Location")}catch(de){(de==null?void 0:de.code)!==1&&console.error("Error reverse geocoding:",de),I("Current Location")}}catch(se){(se==null?void 0:se.code)!==1&&console.error("Error getting current location:",se)}}}),U=X=>{x(X)},H=()=>{x(null)},q=()=>E(void 0,null,function*(){z(!0);try{const X=yield Ua.getCurrentLocation();B(X),N(V(D({},b),{latitude:X.latitude,longitude:X.longitude,radiusMiles:b.radiusMiles||30}));try{const se=yield Ua.reverseGeocode(X.latitude,X.longitude);I(se||"Current Location")}catch(se){console.error("Error reverse geocoding:",se),I("Current Location")}k(!1)}catch(X){console.error("Error getting current location:",X),alert("Failed to get your current location. Please try again or enter a city name.")}finally{z(!1)}}),K=()=>{const X=C.trim();if(!X)return;const se=Ua.searchCity(X);se?(N(V(D({},b),{latitude:se.lat,longitude:se.lng,radiusMiles:b.radiusMiles||30})),I(se.state?`${se.name}, ${se.state}`:se.name),A(""),k(!1)):alert(`City "${X}" not found. Please try a major city name.`)},Z=X=>{N(V(D({},b),{radiusMiles:X[0]}))},ne=()=>{N(V(D({},b),{latitude:void 0,longitude:void 0,radiusMiles:30})),I("")},Y=!!(b.latitude&&b.longitude);return g?s.jsx(A8e,{vibeType:g,userId:e,filters:b,onBack:H,onNavigateToProfile:n,onNavigateToChat:a}):s.jsxs("div",{className:"page-container",style:{overflow:"visible",backgroundColor:"var(--neutral-50)",position:"relative",minHeight:"100vh"},children:[s.jsxs("div",{className:"swift-ui-discover-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,pointerEvents:"none",zIndex:0,overflow:"hidden"},children:[s.jsx("div",{className:"swift-ui-discover-blob",style:{position:"absolute",top:"10%",left:"5%",width:"300px",height:"300px",borderRadius:"50%",background:"radial-gradient(circle, color-mix(in srgb, var(--brand-pink-500) 20%, transparent) 0%, transparent 70%)",filter:"blur(80px)",opacity:.4,pointerEvents:"none"}}),s.jsx("div",{className:"swift-ui-discover-blob",style:{position:"absolute",top:"50%",right:"10%",width:"400px",height:"400px",borderRadius:"50%",background:"radial-gradient(circle, color-mix(in srgb, var(--brand-pink-400) 15%, transparent) 0%, transparent 70%)",filter:"blur(100px)",opacity:.3,pointerEvents:"none"}}),s.jsx("div",{className:"swift-ui-discover-blob",style:{position:"absolute",bottom:"20%",left:"20%",width:"250px",height:"250px",borderRadius:"50%",background:"radial-gradient(circle, color-mix(in srgb, var(--brand-pink-300) 18%, transparent) 0%, transparent 70%)",filter:"blur(60px)",opacity:.35,pointerEvents:"none"}}),s.jsx("div",{className:"swift-ui-discover-noise",style:{position:"absolute",inset:0,pointerEvents:"none",opacity:.05}})]}),!c&&s.jsx(Qo,{menuOpen:o,onMenuClick:l,children:s.jsx("div",{style:{display:"flex",alignItems:"center",gap:"6px",width:"100%",maxWidth:"100%"},children:s.jsx(Ai,{value:d,onChange:X=>{f(X),h(X.trim().length>=2)},placeholder:'Try "Radiohead"',widthVariant:"flex"})})}),s.jsxs("div",{className:"max-w-7xl mx-auto",style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:c?"calc(env(safe-area-inset-top, 0px) + var(--spacing-small, 12px))":"calc(env(safe-area-inset-top, 0px) + 68px + var(--spacing-small, 12px))",paddingBottom:"var(--spacing-bottom-nav, 112px)",overflow:"visible",minHeight:"auto",position:"relative",zIndex:1},children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",style:{marginBottom:"var(--spacing-small, 12px)"},children:[s.jsxs(ce,{onClick:()=>v(!0),className:"gap-2 flex-shrink-0",style:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},onMouseEnter:X=>{X.currentTarget.style.backgroundColor="var(--brand-pink-600)"},onMouseLeave:X=>{X.currentTarget.style.backgroundColor="var(--brand-pink-500)"},size:"sm","data-tour":"discover-vibes",children:[s.jsx(Re,{name:"mediumShootingStar",size:16,color:"var(--neutral-50)"}),"Browse Vibes"]}),s.jsxs(vc,{open:S,onOpenChange:k,children:[s.jsx(yc,{asChild:!0,children:s.jsxs(ce,{variant:"outline",className:"gap-2 flex-shrink-0",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[s.jsx(Re,{name:"location",size:16,color:"var(--neutral-900)"}),s.jsx("span",{style:{color:"var(--neutral-900)"},children:"Location"})]})}),s.jsx(kl,{className:"w-80 swift-ui-card",align:"start",children:s.jsxs("div",{className:"swift-ui-card-content space-y-4",children:[s.jsx("div",{className:"font-semibold text-sm",children:"Set Location"}),s.jsx(ce,{onClick:q,disabled:O,variant:"outline",className:"w-full",size:"sm",children:O?s.jsxs(s.Fragment,{children:[s.jsx(Re,{name:"refresh",size:16,className:"mr-2 animate-spin",color:"var(--neutral-900)"}),"Getting location..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Re,{name:"location",size:16,className:"mr-2",color:"var(--neutral-900)"}),"Use Current Location"]})}),s.jsx("div",{className:"text-sm text-center",style:{color:"var(--neutral-600)"},children:"or"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Nr,{placeholder:"Enter city name (e.g., New York, Los Angeles)",value:C,onChange:X=>A(X.target.value),onKeyDown:X=>{X.key==="Enter"&&K()}}),s.jsx(ce,{onClick:K,disabled:!C.trim(),className:"w-full",size:"sm",children:"Search City"})]}),Y&&s.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("span",{children:["Radius: ",b.radiusMiles||30," miles"]}),s.jsx("span",{style:{color:"var(--neutral-600)"},children:"Max: 50"})]}),s.jsx(xK,{value:[b.radiusMiles||30],onValueChange:Z,min:1,max:50,step:1,className:"w-full"})]}),Y&&s.jsx(ce,{onClick:ne,variant:"ghost",size:"sm",className:"w-full",children:"Clear Location"})]})})]})]}),Y&&s.jsxs("div",{className:"flex flex-wrap gap-2",style:{marginBottom:"24px"},children:[s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"999px",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",gap:"var(--spacing-inline, 6px)",whiteSpace:"nowrap",overflow:"hidden",width:"fit-content",maxWidth:"100%"},children:[s.jsx(Re,{name:"location",size:19,color:"var(--brand-pink-500)"}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",minWidth:0,flexShrink:1},children:R||"Location"}),s.jsx("button",{onClick:ne,style:{background:"none",border:"none",padding:0,cursor:"pointer",display:"flex",alignItems:"center",flexShrink:0,marginLeft:"var(--spacing-inline, 6px)"},className:"hover:text-destructive","aria-label":"Clear location",children:s.jsx(Re,{name:"x",size:19,color:"var(--brand-pink-500)"})})]}),s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",height:"25px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"999px",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",gap:"var(--spacing-inline, 6px)",whiteSpace:"nowrap",width:"fit-content"},children:[s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)"},children:[b.radiusMiles||30," mi radius"]}),s.jsx(Re,{name:"x",size:19,color:"var(--brand-pink-500)"})]})]}),u&&s.jsx("div",{className:"mt-4",children:s.jsx(b8e,{userId:e,allowedTabs:["artists","venues","users","events"],showMap:!1,layout:"compact",mode:"embedded",headerTitle:"",headerDescription:"",showHelperText:!1,initialSearchQuery:d,hideSearchInput:!0,showResults:!0,onNavigateToProfile:n,onNavigateToChat:a})}),!u&&s.jsxs(s.Fragment,{children:[s.jsx("div",{style:{marginBottom:"32px"},children:s.jsx(O8e,{currentUserId:e,onNavigateToProfile:n,onNavigateToChat:a})}),s.jsx("div",{style:{marginBottom:"32px"},children:s.jsx(W8e,{currentUserId:e,filters:b,onNavigateToProfile:n,onNavigateToChat:a})}),s.jsx("div",{children:s.jsx(D8e,{currentUserId:e,onNavigateToProfile:n,onNavigateToChat:a})})]})]}),s.jsx(_K,{isOpen:m,onClose:()=>v(!1),onSelectVibe:U,isMobile:_})]})};class Uu{static getFirstDegreeNetworkEvents(t,r=20){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(a)throw console.error("Error fetching friends:",a),a;if(!n||n.length===0)return[];const i=n.map(v=>v.user_id===t?v.related_user_id:v.user_id),{data:o,error:l}=yield T.from("user_event_relationships").select(`
          user_id,
          event_id,
          relationship_type,
          created_at,
          users:user_id (
            user_id,
            name,
            avatar_url
          )
        `).in("user_id",i).in("relationship_type",["interested","going","maybe"]).order("created_at",{ascending:!1}).limit(r*10);if(l)throw console.error("Error fetching user_event_relationships:",l),l;if(!o||o.length===0)return[];const c=[...new Set((o||[]).map(v=>v.event_id))];if(c.length===0)return[];const{data:d,error:f}=yield T.from("events").select("id, title, venue_city, event_date, images, event_media_url, media_urls, artist_id, venue_id, artists(name), venues(name)").in("id",c);if(f)throw f;const u=new Map((d||[]).map(v=>[v.id,v])),h=new Map;(o||[]).forEach(v=>{const g=v.event_id;h.has(g)||h.set(g,[]),h.get(g).push(v)});const m=[];return h.forEach((v,g)=>{var N,S,k;const x=u.get(g);if(!x)return;const _=v[0],w=_.users;let b;if(x.images&&Array.isArray(x.images)&&x.images.length>0){const C=x.images.find(A=>(A==null?void 0:A.url)&&((A==null?void 0:A.ratio)==="16_9"||(A==null?void 0:A.width)&&A.width>1e3))||x.images.find(A=>A==null?void 0:A.url);b=C==null?void 0:C.url}else x.event_media_url?b=x.event_media_url:x.media_urls&&Array.isArray(x.media_urls)&&x.media_urls.length>0&&(b=x.media_urls[0]);m.push({event_id:x.id,title:x.title||((N=x.artists)==null?void 0:N.name)||"Event",artist_name:((S=x.artists)==null?void 0:S.name)||"Unknown Artist",venue_name:((k=x.venues)==null?void 0:k.name)||"Unknown Venue",venue_city:x.venue_city||void 0,event_date:x.event_date,friend_id:(w==null?void 0:w.user_id)||_.user_id,friend_name:(w==null?void 0:w.name)||"Friend",friend_avatar:(w==null?void 0:w.avatar_url)||null,action_type:"interested",connection_degree:1,created_at:_.created_at,images:x.images,event_media_url:b,interested_count:v.length})}),m.sort((v,g)=>new Date(g.created_at).getTime()-new Date(v.created_at).getTime()).slice(0,r)}catch(n){return console.error("Error fetching first-degree network events:",n),[]}})}static getSecondDegreeNetworkEvents(t,r=15){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("get_second_degree_connections",{target_user_id:t});if(a)throw a;if(!n||n.length===0)return[];const i=n.map(h=>h.connected_user_id),{data:o,error:l}=yield T.from("user_event_relationships").select(`
          event_id,
          relationship_type,
          users:user_id (
            user_id,
            name,
            avatar_url
          )
        `).in("user_id",i).in("relationship_type",["interested","going","maybe"]);if(l)throw l;if(!o||o.length===0)return[];const c=new Map;(o||[]).forEach(h=>{const m=h.event_id,v=c.get(m)||{count:0,users:[]};v.count+=1,v.users.push(h.users),c.set(m,v)});const d=Array.from(c.entries()).sort((h,m)=>m[1].count-h[1].count).slice(0,r).map(([h])=>h);if(d.length===0)return[];const{data:f,error:u}=yield T.from("events").select("id, title, venue_city, event_date, images, event_media_url, media_urls, artist_id, artists(name), venue_id, venues(name)").in("id",d);if(u)throw u;return(f||[]).map(h=>{var x,_,w,b;const m=c.get(h.id),v=(x=m==null?void 0:m.users)==null?void 0:x[0];let g;if(h.images&&Array.isArray(h.images)&&h.images.length>0){const N=h.images.find(S=>(S==null?void 0:S.url)&&((S==null?void 0:S.ratio)==="16_9"||(S==null?void 0:S.width)&&S.width>1e3))||h.images.find(S=>S==null?void 0:S.url);g=N==null?void 0:N.url}else h.event_media_url?g=h.event_media_url:h.media_urls&&Array.isArray(h.media_urls)&&h.media_urls.length>0&&(g=h.media_urls[0]);return{event_id:h.id,title:h.title||((_=h.artists)==null?void 0:_.name)||"Event",artist_name:((w=h.artists)==null?void 0:w.name)||"Unknown Artist",venue_name:((b=h.venues)==null?void 0:b.name)||"Unknown Venue",venue_city:h.venue_city||void 0,event_date:h.event_date,friend_id:(v==null?void 0:v.user_id)||"",friend_name:(v==null?void 0:v.name)||"Friend",friend_avatar:(v==null?void 0:v.avatar_url)||null,action_type:"interested",connection_degree:2,created_at:new Date().toISOString(),images:h.images,event_media_url:g,interested_count:(m==null?void 0:m.count)||0}})}catch(n){return console.error("Error fetching second-degree network events:",n),[]}})}static getTrendingEvents(t,r,n,a=50,i=20,o){return E(this,null,function*(){console.log(" [TRENDING SERVICE] getTrendingEvents called:",{userId:t,cityLat:r,cityLng:n,radiusMiles:a,limit:i,city:o});try{console.log(" [TRENDING SERVICE] Fetching user_event_relationships...");const{data:l,error:c}=yield T.from("user_event_relationships").select("event_id").eq("relationship_type","interested");if(c)throw console.error(" [TRENDING SERVICE] Error fetching interests:",c),c;console.log(" [TRENDING SERVICE] Fetched interests:",{count:(l==null?void 0:l.length)||0});const d=new Map;(l||[]).forEach(M=>{const B=M.event_id;d.set(B,(d.get(B)||0)+1)}),console.log(" [TRENDING SERVICE] Interested counts calculated:",{uniqueEvents:d.size}),console.log(" [TRENDING SERVICE] Fetching reviews...");const{data:f,error:u}=yield T.from("reviews").select("event_id").eq("is_public",!0);if(u)throw console.error(" [TRENDING SERVICE] Error fetching reviews:",u),u;console.log(" [TRENDING SERVICE] Fetched reviews:",{count:(f==null?void 0:f.length)||0,reviews:f==null?void 0:f.map(M=>({id:M.id,event_id:M.event_id,artist_id:M.artist_id,venue_id:M.venue_id,rating:M.rating,created_at:M.created_at}))});const h=[...new Set((f||[]).map(M=>M.event_id).filter(M=>M!=null))];console.log(" [TRENDING SERVICE] Review event IDs:",{count:h.length,ids:h});const m=[...new Set((f||[]).map(M=>M.artist_id).filter(M=>M!=null))],v=[...new Set((f||[]).map(M=>M.venue_id).filter(M=>M!=null))];console.log(" [TRENDING SERVICE] Review artist/venue IDs:",{artistIds:m.length,venueIds:v.length});let g=new Map;if(h.length>0){console.log(" [TRENDING SERVICE] Fetching events for reviews (checking dates)...");const{data:M,error:B}=yield T.from("events").select("id, title, event_date, venue_city, latitude, longitude, artist_id, artists(name), venue_id, venues(name)").in("id",h);if(B)console.error(" [TRENDING SERVICE] Error fetching events for reviews:",B);else{const F=new Date().toISOString(),U=(M==null?void 0:M.filter(q=>q.event_date>=F))||[],H=(M==null?void 0:M.filter(q=>q.event_date<F))||[];console.log(" [TRENDING SERVICE] Events with reviews:",{total:(M==null?void 0:M.length)||0,upcoming:U.length,past:H.length,events:M==null?void 0:M.map(q=>({id:q.id,title:q.title,event_date:q.event_date,isUpcoming:q.event_date>=F}))})}!B&&M&&((M||[]).forEach(F=>{var H,q;const U=((H=F.artists)==null?void 0:H.name)||((q=F.title)==null?void 0:q.split(" at ")[0])||F.title||"Unknown Artist";if(U){const K=(f||[]).filter(Z=>Z.event_id===F.id).length;g.set(U,(g.get(U)||0)+K)}}),console.log(" [TRENDING SERVICE] Artist review counts:",Object.fromEntries(g)))}const x=Array.from(g.entries()).sort((M,B)=>B[1]-M[1]).slice(0,10).map(([M])=>M),_=Array.from(d.keys()),w=h,b=Array.from(new Set([..._,...w]));if(console.log(" [TRENDING SERVICE] Event IDs combined:",{fromInterests:_.length,fromReviews:w.length,total:b.length}),b.length===0){console.log(" [TRENDING SERVICE] No events with interests or reviews, trying fallback to recent upcoming events...");let M=T.from("events").select("id, title, venue_city, venue_state, event_date, event_media_url, latitude, longitude, genres, artist_id, artists(name), venue_id, venues(name)").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0});if(r&&n&&a){const H=a/69*1.1,q=a/(69*Math.cos(r*Math.PI/180))*1.1;M=M.not("latitude","is",null).not("longitude","is",null).gte("latitude",r-H).lte("latitude",r+H).gte("longitude",n-q).lte("longitude",n+q).limit(300)}else M=M.limit(i*3);const{data:B,error:F}=yield M;if(F)return console.error(" [TRENDING SERVICE] Error fetching fallback events:",F),[];if(!B||B.length===0)return console.log(" [TRENDING SERVICE] No fallback events found either"),[];console.log(" [TRENDING SERVICE] Using fallback events (before exact distance filter):",{count:B.length});let U=B;if(r&&n&&a&&B){const{LocationService:H}=yield Rr(()=>E(this,null,function*(){const{LocationService:q}=yield Promise.resolve().then(()=>PC);return{LocationService:q}}),void 0,import.meta.url);U=B.filter(q=>!q.latitude||!q.longitude?!1:H.calculateDistance(r,n,Number(q.latitude),Number(q.longitude))<=a),console.log(" [TRENDING SERVICE] After exact distance filter:",{before:B.length,after:U.length})}return U.slice(0,i).map(H=>{var q,K,Z;return{event_id:H.id,title:H.title||((q=H.artists)==null?void 0:q.name)||"Event",artist_name:((K=H.artists)==null?void 0:K.name)||"Unknown Artist",venue_name:((Z=H.venues)==null?void 0:Z.name)||"Unknown Venue",venue_city:H.venue_city||void 0,event_date:H.event_date,trending_score:0,save_velocity:0,attendance_markings:0,network_overlap:0,trending_label:void 0,event_media_url:H.event_media_url||void 0}})}console.log(" [TRENDING SERVICE] Fetching event details for",b.length,"events...");const N=new Date().toISOString();console.log(" [TRENDING SERVICE] Filtering for events after:",N);let S=T.from("events").select("id, title, venue_city, venue_state, event_date, event_media_url, latitude, longitude, genres, artist_id, artists(name), venue_id, venues(name)").in("id",b).gte("event_date",N);if(r&&n&&a){const M=a/69*1.1,B=a/(69*Math.cos(r*Math.PI/180))*1.1;S=S.gte("latitude",r-M).lte("latitude",r+M).gte("longitude",n-B).lte("longitude",n+B),console.log(" [TRENDING SERVICE] Applied bounding box filter:",{cityLat:r,cityLng:n,radiusMiles:a,latDelta:M,lngDelta:B})}const{data:k,error:C}=yield S.order("event_date",{ascending:!0}).limit(i*3);if(C)throw console.error(" [TRENDING SERVICE] Error fetching events:",C),C;console.log(" [TRENDING SERVICE] Fetched events:",{count:(k==null?void 0:k.length)||0,events:k==null?void 0:k.map(M=>({id:M.id,title:M.title,event_date:M.event_date,venue_city:M.venue_city,hasCoords:!!(M.latitude&&M.longitude)}))});let A=k||[];if(r&&n&&a&&k){console.log(" [TRENDING SERVICE] Applying exact distance filter...");const{LocationService:M}=yield Rr(()=>E(this,null,function*(){const{LocationService:B}=yield Promise.resolve().then(()=>PC);return{LocationService:B}}),void 0,import.meta.url);A=k.filter(B=>{if(!B.latitude||!B.longitude)return console.log(" [TRENDING SERVICE] Event missing coordinates:",B.id,B.title),!1;const F=M.calculateDistance(r,n,Number(B.latitude),Number(B.longitude)),U=F<=a;return U||console.log(" [TRENDING SERVICE] Event outside radius:",B.id,B.title,{distance:F,radiusMiles:a}),U}),console.log(" [TRENDING SERVICE] After exact distance filter:",{before:k.length,after:A.length,radiusMiles:a})}else console.log(" [TRENDING SERVICE] Skipping distance filter:",{cityLat:r,cityLng:n,radiusMiles:a,hasEvents:!!k});const R=new Map;(f||[]).forEach(M=>{M.event_id&&R.set(M.event_id,(R.get(M.event_id)||0)+1)});const I=new Map;(f||[]).forEach(M=>{if(M.event_id&&M.rating){const B=I.get(M.event_id)||{sum:0,count:0};I.set(M.event_id,{sum:B.sum+Number(M.rating),count:B.count+1})}});const O=new Map;I.forEach((M,B)=>{O.set(B,M.sum/M.count)}),console.log(" [TRENDING SERVICE] Calculating trending scores...");const z=A.map(M=>{var se,de,_e;const B=d.get(M.id)||0,F=R.get(M.id)||0,U=O.get(M.id)||0,H=((se=M.artists)==null?void 0:se.name)||((de=M.title)==null?void 0:de.split(" at ")[0])||"Unknown Artist",q=g.get(H)||0,K=x.includes(H),Z=B*3,ne=F>0?F*2+U*5+(K?q*2:0):0,Y=Z+ne;let X="";return B>=15?X=" Very Hot":B>=10?X=" Trending":F>=10&&U>=4?X=" Highly Reviewed":K&&(B>=5||F>=3)?X=" Popular":B>=5?X=" Getting Attention":F>=5&&(X=" Well Reviewed"),{event_id:M.id,title:M.title||H||"Event",artist_name:H,venue_name:((_e=M.venues)==null?void 0:_e.name)||"Unknown Venue",venue_city:M.venue_city||void 0,event_date:M.event_date,trending_score:Y,save_velocity:B,attendance_markings:0,network_overlap:0,trending_label:X||void 0,event_media_url:M.event_media_url||void 0}}).filter(M=>M.trending_score>0).sort((M,B)=>B.trending_score-M.trending_score).slice(0,i);return console.log(" [TRENDING SERVICE] Final trending events:",{count:z.length,events:z}),z}catch(l){return console.error(" [TRENDING SERVICE] Error fetching trending events:",l),[]}})}static getEventLists(t,r=5){return E(this,null,function*(){try{const n=[],{data:a,error:i}=yield T.from("reviews").select("event_id, rating").eq("user_id",t).gte("rating",4).order("rating",{ascending:!1}).limit(10);if(!i&&a&&a.length>0){const l=a.map(d=>d.event_id),{data:c}=yield T.from("events").select("id, title, venue_city, event_date, images, genres, artist_id, artists(name), venue_id, venues(name)").in("id",l).gte("event_date",new Date().toISOString()).limit(10);c&&c.length>0&&n.push({id:"user-top-rated",title:"Shows I'd See Again",description:"Based on your highest-rated reviews",list_type:"user_created",events:c.map(d=>{var f,u,h;return{id:d.id,title:d.title||((f=d.artists)==null?void 0:f.name)||"Event",artist_name:((u=d.artists)==null?void 0:u.name)||"Unknown Artist",venue_name:((h=d.venues)==null?void 0:h.name)||"Unknown Venue",event_date:d.event_date,genres:d.genres||[]}}),created_at:new Date().toISOString()})}const o=yield this.getFriendIds(t);if(o.length>0){const{data:l}=yield T.from("reviews").select("event_id, rating").in("user_id",o).gte("rating",4).order("rating",{ascending:!1}).limit(10);if(l&&l.length>0){const c=l.map(f=>f.event_id),{data:d}=yield T.from("events").select("id, title, venue_city, event_date, images, genres, artist_id, artists(name), venue_id, venues(name)").in("id",c).gte("event_date",new Date().toISOString()).lte("event_date",new Date(Date.now()+7*24*60*60*1e3).toISOString()).limit(10);d&&d.length>0&&n.push({id:"network-weekend",title:"Top Rated This Weekend in Your Network",description:"Highly rated by your friends",list_type:"system_generated",events:d.map(f=>({id:f.id,title:f.title||f.artist_name||"Event",artist_name:f.artist_name||"Unknown Artist",venue_name:f.venue_name||"Unknown Venue",event_date:f.event_date,genres:f.genres||[]})),created_at:new Date().toISOString()})}}return n.slice(0,r)}catch(n){return console.error("Error fetching event lists:",n),[]}})}static getNetworkReviews(t,r=20){return E(this,null,function*(){try{console.log(" [NETWORK_REVIEWS] Fetching network reviews for user:",t);const{data:n,error:a}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(a)throw console.error(" [NETWORK_REVIEWS] Error fetching friends:",a),a;if(console.log(" [NETWORK_REVIEWS] Found friends:",(n==null?void 0:n.length)||0),!n||n.length===0)return console.log(" [NETWORK_REVIEWS] No friends found, returning empty array"),[];const i=n.map(_=>_.user_id===t?_.related_user_id:_.user_id);console.log(" [NETWORK_REVIEWS] Friend IDs:",i);const{data:o,error:l}=yield T.from("reviews").select(`
          id,
          user_id,
          event_id,
          artist_id,
          venue_id,
          rating,
          review_text,
          photos,
          created_at,
          events (
            id,
            title,
            event_date,
            artist_id,
            venue_id
          )
        `).in("user_id",i).eq("is_public",!0).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).limit(r);if(l)throw console.error(" [NETWORK_REVIEWS] Error fetching reviews:",l),l;if(console.log(" [NETWORK_REVIEWS] Found reviews:",(o==null?void 0:o.length)||0),!o||o.length===0)return console.log(" [NETWORK_REVIEWS] No reviews found, returning empty array"),[];const c=[...new Set(o.map(_=>_.user_id))],{data:d,error:f}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",c);if(f)throw console.error(" [NETWORK_REVIEWS] Error fetching users:",f),f;const u=new Map;d==null||d.forEach(_=>u.set(_.user_id,_));const h=new Set,m=new Set;o.forEach(_=>{var w,b;_.artist_id&&h.add(_.artist_id),_.venue_id&&m.add(_.venue_id),(w=_.events)!=null&&w.artist_id&&h.add(_.events.artist_id),(b=_.events)!=null&&b.venue_id&&m.add(_.events.venue_id)});const v=new Map,g=new Map;if(h.size>0){const{data:_}=yield T.from("artists").select("id, name, image_url").in("id",Array.from(h));_==null||_.forEach(w=>v.set(w.id,{name:w.name,image_url:w.image_url}))}if(m.size>0){const{data:_}=yield T.from("venues").select("id, name").in("id",Array.from(m));_==null||_.forEach(w=>g.set(w.id,w.name))}return o.filter(_=>u.has(_.user_id)).map(_=>{var R,I,O;const w=u.get(_.user_id),b=_.artist_id||((R=_.events)==null?void 0:R.artist_id),N=_.venue_id||((I=_.events)==null?void 0:I.venue_id),S=b?v.get(b):void 0,k=S==null?void 0:S.name,C=(S==null?void 0:S.image_url)||void 0,A=N?g.get(N):void 0;return{id:_.id,author:{id:w.user_id,name:w.name||"User",avatar_url:w.avatar_url||void 0},created_at:_.created_at,rating:_.rating||void 0,content:_.review_text||void 0,photos:_.photos||void 0,artist_id:b||void 0,artist_image_url:C,event_info:{artist_name:k||void 0,venue_name:A||void 0,event_date:((O=_.events)==null?void 0:O.event_date)||void 0},connection_degree:1}})}catch(n){return console.error("Error fetching network reviews:",n),[]}})}static getFriendIds(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("get_first_degree_connections",{target_user_id:t});if(n)throw n;return(r||[]).map(a=>a.connected_user_id)}catch(r){return console.error("Error getting friend IDs:",r),[]}})}}const NK=({review:e,onClick:t,className:r})=>{var u,h,m;const n=e.author.name||"User",a=((u=e.event_info)==null?void 0:u.artist_name)||"Artist",i=((h=e.event_info)==null?void 0:h.venue_name)||"Venue",o=e.Event_date||e.event_date,l=o?Rt(new Date(o),"EEE, MMM d, yyyy"):(m=e.event_info)!=null&&m.event_date?Rt(new Date(e.event_info.event_date),"EEE, MMM d, yyyy"):e.created_at?Rt(new Date(e.created_at),"EEE, MMM d, yyyy"):"",c=e.rating||0,d=e.content||"",f=e.artist_image_url||null;return s.jsxs("div",{className:Oe("swift-ui-card flex flex-col overflow-hidden","relative group cursor-pointer","w-full h-full max-h-[85vh]",r),onClick:t,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),t==null||t())},tabIndex:0,role:"button","aria-label":`View review by ${n}`,children:[s.jsx("div",{className:"relative w-full flex-1 min-h-[60vh] max-h-[70vh] overflow-hidden",children:f?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:f,alt:`${a} at ${i}`,className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(to top, rgba(14, 14, 14, 0.8) 0%, rgba(14, 14, 14, 0.4) 50%, transparent 100%)"}})]}):s.jsx("div",{className:"w-full h-full flex items-center justify-center swift-ui-gradient-bg",children:s.jsx("div",{className:"text-center px-4",children:s.jsxs("p",{className:"line-clamp-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-0)"},children:[a,i&&` at ${i}`]})})})}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 swift-ui-card-content",style:{zIndex:40},children:[s.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(to top, color-mix(in srgb, var(--neutral-0) 96%, transparent) 0%, color-mix(in srgb, var(--neutral-0) 90%, transparent) 60%, color-mix(in srgb, var(--neutral-0) 70%, transparent) 100%)",backdropFilter:"blur(24px)",WebkitBackdropFilter:"blur(24px)"}}),s.jsxs("div",{className:"relative flex flex-col",style:{padding:"var(--spacing-grouped, 24px)",gap:"var(--spacing-small, 12px)"},children:[s.jsxs("h2",{className:"line-clamp-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:[a,i&&` at ${i}`]}),s.jsxs("div",{className:"flex flex-col",style:{gap:"var(--spacing-inline, 6px)"},children:[i&&s.jsxs("div",{className:"flex items-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx(yr,{size:20,style:{color:"var(--brand-pink-500)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-700)"},children:i})]}),l&&s.jsxs("div",{className:"flex items-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx(Lt,{size:20,style:{color:"var(--brand-pink-500)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-700)"},children:l})]})]}),s.jsxs("div",{className:"flex flex-col",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsxs("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-700)"},children:[s.jsx("span",{style:{fontWeight:"var(--typography-bold-weight, 700)"},children:n})," reviewed this event"]}),c>0&&s.jsxs("div",{className:"flex items-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{className:"flex items-center",style:{gap:"var(--spacing-inline, 6px)"},children:Array.from({length:5}).map((v,g)=>{const x=g+1,_=x<=Math.floor(c),w=!_&&x<=c;return s.jsx(Xt,{className:Oe("w-5 h-5"),style:{color:_||w?"var(--brand-pink-500)":"var(--neutral-200)",fill:_||w?"var(--brand-pink-500)":"transparent",fillOpacity:w?.5:1},strokeWidth:_||w?0:1.5},g)})}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)"},children:c.toFixed(1)})]})]}),d&&s.jsx("p",{className:"line-clamp-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)"},children:d})]})]})]})};function G8e({reviewId:e,currentUserId:t,onBack:r,onEdit:n,onDelete:a}){var F,U,H,q,K,Z,ne,Y,X;const[i,o]=y.useState(null),[l,c]=y.useState(!0),[d,f]=y.useState(!1),[u,h]=y.useState(0),[m,v]=y.useState(!1),[g,x]=y.useState(!1),[_,w]=y.useState(!1),[b,N]=y.useState(0),{toast:S}=Er();y.useEffect(()=>{e&&E(this,null,function*(){var de,_e,xe,Q;try{c(!0);const{data:oe,error:ie}=yield T.from("reviews").select(`
            id,
            user_id,
            review_text,
            rating,
            photos,
            created_at,
            artist_performance_rating,
            production_rating,
            venue_rating,
            location_rating,
            value_rating,
            artist_performance_feedback,
            production_feedback,
            venue_feedback,
            location_feedback,
            value_feedback,
            setlist,
            likes_count,
            comments_count,
            event_id,
            artist_id,
            venue_id
          `).eq("id",e).single();if(ie)throw ie;const{data:ee}=yield T.from("users").select("user_id, name, avatar_url").eq("user_id",oe.user_id).single();let G={};if(oe.event_id){const{data:ae}=yield T.from("events").select(`
              id,
              title,
              event_date,
              artist_id,
              venue_id,
              artists(name),
              venues(name)
            `).eq("id",oe.event_id).single();ae&&(G={artist_name:(de=ae.artists)==null?void 0:de.name,venue_name:(_e=ae.venues)==null?void 0:_e.name,event_date:ae.event_date})}else if(oe.artist_id&&oe.venue_id){const[ae,fe]=yield Promise.all([T.from("artists").select("name").eq("id",oe.artist_id).single(),T.from("venues").select("name").eq("id",oe.venue_id).single()]);G={artist_name:(xe=ae.data)==null?void 0:xe.name,venue_name:(Q=fe.data)==null?void 0:Q.name}}const J=V(D({},oe),{author:ee?{id:ee.user_id,name:ee.name,avatar_url:ee.avatar_url}:void 0,event_info:G});if(o(J),h(oe.likes_count||0),N(oe.comments_count||0),t)try{const{data:ae,error:fe}=yield T.from("entities").select("id").eq("entity_type","review").eq("entity_uuid",e).single();let we=!1;if(fe){fe.code!=="PGRST116"&&console.error("Error fetching entity for review like check:",fe);const[ve,me]=yield Promise.all([T.from("engagements").select("id").eq("user_id",t).eq("entity_id",e).eq("engagement_type","like").maybeSingle(),T.from("engagements").select("id").eq("user_id",t).is("entity_id",null).eq("engagement_type","like").eq("metadata->>review_id",e).maybeSingle()]);we=!!(ve.data||me.data)}else if(ae!=null&&ae.id){const{data:ve,error:me}=yield T.from("engagements").select("id").eq("user_id",t).eq("entity_id",ae.id).eq("engagement_type","like").maybeSingle();we=!!ve,me&&console.error("Error checking if review is liked:",me)}f(we)}catch(ae){console.error("Error checking if review is liked:",ae),f(!1)}}catch(oe){console.error("Error fetching review data:",oe)}finally{c(!1)}})},[e,t]);const k=()=>E(this,null,function*(){if(!(!t||m||!i)){v(!0);try{d?(yield cs.unlikeReview(t,e),h(se=>Math.max(0,se-1)),f(!1)):(yield cs.likeReview(t,e),h(se=>se+1),f(!0))}catch(se){console.error("Error toggling like:",se),S({title:"Error",description:"Failed to update like",variant:"destructive"})}finally{v(!1)}}}),C=()=>{x(!0)},A=()=>{w(!0)},R=()=>{N(se=>se+1)},I=se=>{N(se)};if(l||!i)return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"var(--neutral-50, #fcfcfc)"},children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-lg",style:{color:"var(--neutral-600)"},children:"Loading review..."})})});const O=Uv(new Date(i.created_at),{addSuffix:!0}),z=t===i.user_id,M=[{name:"Artist Performance",rating:i.artist_performance_rating||0,feedback:i.artist_performance_feedback},{name:"Production Quality",rating:i.production_rating||0,feedback:i.production_feedback},{name:"Venue Experience",rating:i.venue_rating||0,feedback:i.venue_feedback},{name:"Location & Logistics",rating:i.location_rating||0,feedback:i.location_feedback},{name:"Value for Ticket",rating:i.value_rating||0,feedback:i.value_feedback}].filter(se=>se.rating>0),B=i.photos&&i.photos.length>0?i.photos[0]:null;return s.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",style:{backgroundColor:"#ffffff",WebkitOverflowScrolling:"touch",zIndex:100},children:[s.jsx("div",{className:"sticky top-0 z-10",style:{background:"rgba(252, 252, 252, 0.85)",backdropFilter:"blur(40px) saturate(180%)",WebkitBackdropFilter:"blur(40px) saturate(180%)",borderBottom:"1px solid rgba(0, 0, 0, 0.05)",boxShadow:"0 4px 4px rgba(0, 0, 0, 0.25)"},children:s.jsx("div",{className:"max-w-2xl mx-auto px-5 pt-20 pb-4",children:s.jsxs("div",{className:"flex items-start justify-between gap-6",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[s.jsx(ce,{size:"icon",className:"h-6 w-6 rounded-full shrink-0",style:{backgroundColor:"#FF3399"},onClick:r,children:s.jsx(ks,{className:"h-4 w-4 text-white"})}),s.jsxs(Wr,{className:"w-14 h-14 shrink-0",children:[s.jsx(Qr,{src:((F=i.author)==null?void 0:F.avatar_url)||void 0,alt:(U=i.author)==null?void 0:U.name}),s.jsx(Hr,{className:"text-white font-bold text-lg",style:{backgroundColor:"#FF3399"},children:((q=(H=i.author)==null?void 0:H.name)==null?void 0:q.charAt(0).toUpperCase())||"U"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-bold text-xl mb-1",style:{color:"var(--neutral-900)"},children:((K=i.author)==null?void 0:K.name)||"User"}),s.jsxs("p",{className:"text-base mb-1",style:{color:"var(--neutral-700)"},children:["Reviewed"," ",((Z=i.event_info)==null?void 0:Z.artist_name)&&s.jsx(s.Fragment,{children:s.jsx("strong",{style:{color:"#FF3399",textDecoration:"underline"},children:i.event_info.artist_name})}),((ne=i.event_info)==null?void 0:ne.venue_name)&&s.jsxs(s.Fragment,{children:[" at ",s.jsx("strong",{style:{color:"#FF3399",textDecoration:"underline"},children:i.event_info.venue_name})]})]}),s.jsx("p",{className:"text-base",style:{color:"var(--neutral-600, #5d646f)"},children:O})]})]}),z&&s.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[n&&s.jsx(ce,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:n,children:s.jsx(Ol,{className:"h-4 w-4"})}),a&&s.jsx(ce,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:a,children:s.jsx(Ko,{className:"h-4 w-4"})})]})]})})}),s.jsxs("div",{className:"max-w-2xl mx-auto px-5 py-6 space-y-12",children:[(i.review_text||B)&&s.jsxs("div",{className:"space-y-3",children:[i.review_text&&s.jsx("p",{className:"text-xl font-medium",style:{color:"var(--neutral-600, #5d646f)"},children:i.review_text}),B&&s.jsx("div",{className:"rounded-xl overflow-hidden shadow-md",style:{aspectRatio:"353/250"},children:s.jsx("img",{src:B,alt:"Review",className:"w-full h-full object-cover",onError:se=>{se.target.style.display="none"}})})]}),M.length>0&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--neutral-900)"},children:"View Rating Details"}),s.jsx("div",{className:"space-y-6",children:M.map(se=>s.jsxs("div",{className:"flex gap-6 items-center p-3 rounded-xl border-2",style:{borderColor:"var(--neutral-300, #c9c9c9)",backgroundColor:"white"},children:[s.jsxs("div",{className:"flex flex-col gap-6 flex-1 min-w-0",children:[s.jsx("p",{className:"text-xl font-bold",style:{color:"var(--neutral-900)"},children:se.name}),se.feedback&&s.jsxs("p",{className:"text-base",style:{color:"var(--neutral-600, #5d646f)"},children:['"',se.feedback,'"']})]}),s.jsxs("div",{className:"flex flex-col gap-3 items-end shrink-0 w-[120px]",children:[s.jsx("p",{className:"text-xl font-bold",style:{color:"var(--neutral-900)"},children:se.rating.toFixed(1)}),s.jsx("div",{className:"flex gap-0",children:Array.from({length:5}).map((de,_e)=>{const xe=_e+1,Q=xe<=Math.floor(se.rating),oe=!Q&&xe<=se.rating;return s.jsx(Xt,{className:Oe("w-6 h-6",Q||oe?"fill-[#FCDC5F] text-[#FCDC5F]":"text-neutral-300 fill-transparent"),strokeWidth:Q||oe?0:1.5},_e)})})]})]},se.name))})]}),i.setlist&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--neutral-900)"},children:"Set List"}),s.jsx("div",{className:"p-6 rounded-lg border-2",style:{borderColor:"var(--neutral-600, #5d646f)",backgroundColor:"var(--neutral-50, #fcfcfc)",boxShadow:"0 4px 4px rgba(0, 0, 0, 0.25)"},children:s.jsx(A2,{setlist:i.setlist,type:"api"})})]}),s.jsxs("div",{className:"flex gap-3 pb-24",children:[s.jsxs(ce,{variant:"outline",className:"flex items-center gap-3 h-11 px-3 rounded-lg border-2 shadow-sm flex-1",style:{backgroundColor:"var(--brand-pink-050, #fdf2f7)",borderColor:"var(--brand-pink-050, #fdf2f7)",color:"var(--neutral-900)"},onClick:k,disabled:m||!t,children:[s.jsx(zP,{className:Oe("h-6 w-6",d&&"fill-current"),style:{color:"#FF3399"}}),s.jsx("span",{className:"font-bold",children:u}),s.jsx("span",{children:"Helpful"})]}),s.jsxs(ce,{variant:"outline",className:"flex items-center gap-3 h-11 px-3 rounded-lg border-2 shadow-sm flex-1",style:{backgroundColor:"var(--brand-pink-050, #fdf2f7)",borderColor:"var(--brand-pink-500, #FF3399)",color:"var(--neutral-900)"},onClick:C,children:[s.jsx(Ln,{className:"h-6 w-6",style:{color:"#FF3399"}}),s.jsx("span",{className:"font-bold",children:b}),s.jsx("span",{children:"Comments"})]}),s.jsx(ce,{className:"flex items-center justify-center h-11 w-11 rounded-lg shadow-sm shrink-0",style:{backgroundColor:"var(--brand-pink-500, #FF3399)"},onClick:A,children:s.jsx(Dc,{className:"h-5 w-5 text-white"})})]})]}),g&&s.jsx(fU,{reviewId:e,isOpen:g,onClose:()=>x(!1),currentUserId:t,onCommentAdded:R,onCommentsLoaded:I}),_&&i&&s.jsx(MT,{review:{id:i.id,user_id:i.user_id,event_id:i.event_id||"",rating:i.rating||0,review_text:i.review_text||"",is_public:!0,created_at:i.created_at,updated_at:i.created_at,likes_count:u,comments_count:b,shares_count:0,is_liked_by_user:d,reaction_emoji:"",photos:i.photos||[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:(Y=i.event_info)==null?void 0:Y.artist_name,artist_id:i.artist_id,venue_name:(X=i.event_info)==null?void 0:X.venue_name,venue_id:i.venue_id},currentUserId:t||"",isOpen:_,onClose:()=>w(!1)})]})}class SK{static getFeed(t,r=20,n=0,a,i=!1){return E(this,null,function*(){var o,l,c,d,f;try{console.log(" PreferencesV4Feed: Fetching feed for user:",t,{limit:r,offset:n,filters:a,skipFollowing:i});let u=(o=a==null?void 0:a.city)!=null?o:null;if(a!=null&&a.latitude&&(a!=null&&a.longitude)&&!u)try{const{LocationService:x}=yield Rr(()=>E(this,null,function*(){const{LocationService:w}=yield Promise.resolve().then(()=>PC);return{LocationService:w}}),void 0,import.meta.url),_=yield x.reverseGeocode(a.latitude,a.longitude);_&&(u=_.split(",")[0].trim(),console.log(` Reverse geocoded ${a.latitude},${a.longitude} to city: ${u}`))}catch(x){console.error("Error reverse geocoding for feed filter:",x)}const{data:h,error:m}=yield T.rpc("get_preferences_v4_feed",{p_user_id:t,p_limit:r,p_offset:n,p_include_past:(l=a==null?void 0:a.includePast)!=null?l:!1,p_city_filter:u,p_state_filter:(c=a==null?void 0:a.state)!=null?c:null,p_max_days_ahead:(d=a==null?void 0:a.maxDaysAhead)!=null?d:90,p_skip_following:i,p_radius_miles:(f=a==null?void 0:a.radiusMiles)!=null?f:null});if(m)throw console.error(" PreferencesV4Feed: Error fetching feed:",m),m;if(!h||h.length===0)return console.log(" PreferencesV4Feed: No events found"),{events:[],hasMore:!1};let v=h.map(x=>{var _,w,b,N;return{id:x.event_id,jambase_event_id:x.jambase_event_id,title:x.title||x.artist_name||"Event",artist_name:x.artist_name||"Unknown Artist",artist_id:x.artist_id,venue_name:x.venue_name||"Unknown Venue",venue_id:x.venue_id,event_date:x.event_date,doors_time:x.doors_time,description:x.description,genres:x.genres||[],venue_address:x.venue_address,venue_city:x.venue_city,venue_state:x.venue_state,venue_zip:x.venue_zip,latitude:x.latitude?Number(x.latitude):null,longitude:x.longitude?Number(x.longitude):null,ticket_available:(_=x.ticket_available)!=null?_:!0,price_range:x.price_range,ticket_urls:x.ticket_urls||[],setlist:x.setlist,setlist_enriched:x.setlist_enriched,setlist_song_count:x.setlist_song_count,setlist_fm_id:x.setlist_fm_id,setlist_fm_url:x.setlist_fm_url,setlist_source:x.setlist_source,setlist_last_updated:x.setlist_last_updated,tour_name:x.tour_name,poster_image_url:x.event_media_url||null,created_at:x.created_at,updated_at:x.updated_at,relevance_score:x.relevance_score?Number(x.relevance_score):void 0,user_is_interested:(w=x.user_is_interested)!=null?w:!1,interested_count:(b=x.interested_count)!=null?b:0,friends_interested_count:(N=x.friends_interested_count)!=null?N:0,recommendation_reason:x.recommendation_reason||void 0,recommendation_context:x.recommendation_context||void 0}});if(a!=null&&a.genres&&a.genres.length>0&&(v=v.filter(x=>{const _=x.genres||[];return a.genres.some(w=>_.some(b=>b.toLowerCase().includes(w.toLowerCase())||w.toLowerCase().includes(b.toLowerCase())))})),a!=null&&a.dateRange){const{from:x,to:_}=a.dateRange;(x||_)&&(v=v.filter(w=>{if(!w.event_date)return!1;const b=new Date(w.event_date);if(x&&b<x)return!1;if(_){const N=new Date(_);if(N.setHours(23,59,59,999),b>N)return!1}return!0}))}if(a!=null&&a.latitude&&(a!=null&&a.longitude)&&(a!=null&&a.radiusMiles)&&a.radiusMiles<50){const{filterEventsByRadius:x}=yield Rr(()=>E(this,null,function*(){const{filterEventsByRadius:w}=yield Promise.resolve().then(()=>jge);return{filterEventsByRadius:w}}),void 0,import.meta.url),_=v.length;v=x(v,a.latitude,a.longitude,a.radiusMiles),console.log(` Client-side radius filter: ${_} -> ${v.length} events (${a.radiusMiles}mi radius)`)}const g=h.length===r&&v.length>0;return console.log(` PreferencesV4Feed: Found ${v.length} events`,{hasMore:g,avgScore:v.length>0?v.reduce((x,_)=>x+(_.relevance_score||0),0)/v.length:0}),{events:v,hasMore:g}}catch(u){return console.error(" PreferencesV4Feed: Error in getFeed:",u),{events:[],hasMore:!1}}})}static getFeedPaginated(t,r=0,n=20,a,i=!1){return E(this,null,function*(){const o=r*n;return this.getFeed(t,n,o,a,i)})}}const Y8e=({userId:e,onEventClick:t,filters:r,className:n,filterControls:a})=>{const[i,o]=y.useState([]),[l,c]=y.useState(!0),[d,f]=y.useState(!1),[u,h]=y.useState(!0),[m,v]=y.useState(0),[g,x]=y.useState(null),[_,w]=y.useState(!1),[b,N]=y.useState(new Set),[S,k]=y.useState(!1),[C,A]=y.useState(null),[R,I]=y.useState(!1),[O,z]=y.useState(null),{toast:M}=Er(),B=y.useRef(null),F=20,U=5*60*1e3,H="recommendations_",q=Q=>[...Q].sort((oe,ie)=>{const ee=ae=>{if(!ae.event_date)return Number.MAX_SAFE_INTEGER;const fe=new Date(ae.event_date);return isNaN(fe.getTime())?Number.MAX_SAFE_INTEGER:fe.getTime()},G=ee(oe),J=ee(ie);return G-J}),K=(Q,oe)=>{var ae,fe,we,ve,me,Me,Te,Ve,le,Ke;if(!oe)return`${H}${Q}_default`;const ie="selectedCities"in oe?oe:null,ee=ie?null:oe;let G;ie!=null&&ie.dateRange?G={from:(ae=ie.dateRange.from)==null?void 0:ae.toISOString(),to:(fe=ie.dateRange.to)==null?void 0:fe.toISOString()}:ee!=null&&ee.dateRange&&(G={from:(we=ee.dateRange.from)==null?void 0:we.toISOString(),to:(ve=ee.dateRange.to)==null?void 0:ve.toISOString()});const J=JSON.stringify({city:(Me=(me=ie==null?void 0:ie.selectedCities)==null?void 0:me[0])!=null?Me:ee==null?void 0:ee.city,latitude:(Te=ie==null?void 0:ie.latitude)!=null?Te:ee==null?void 0:ee.latitude,longitude:(Ve=ie==null?void 0:ie.longitude)!=null?Ve:ee==null?void 0:ee.longitude,genres:(le=ie==null?void 0:ie.genres)!=null?le:ee==null?void 0:ee.genres,radiusMiles:(Ke=ie==null?void 0:ie.radiusMiles)!=null?Ke:ee==null?void 0:ee.radiusMiles,dateRange:G,includePast:ee==null?void 0:ee.includePast,maxDaysAhead:ee==null?void 0:ee.maxDaysAhead});return`${H}${Q}_${J}`},Z=Q=>{try{const oe=localStorage.getItem(Q);if(!oe)return null;const{events:ie,timestamp:ee}=JSON.parse(oe);return Date.now()-ee>U?(localStorage.removeItem(Q),null):ie}catch(oe){return console.warn("Error reading cache:",oe),null}},ne=(Q,oe)=>{const ie={events:oe,timestamp:Date.now()};try{localStorage.setItem(Q,JSON.stringify(ie))}catch(ee){console.warn("Error saving cache:",ee);try{const G=[];for(let J=0;J<localStorage.length;J++){const ae=localStorage.key(J);ae&&ae.startsWith(H)&&G.push(ae)}G.forEach(J=>localStorage.removeItem(J)),localStorage.setItem(Q,JSON.stringify(ie))}catch(G){console.warn("Could not clear cache:",G)}}},Y=()=>E(void 0,null,function*(){if(e)try{const Q=yield Kr.getUserInterestedEventIdSet(e);N(Q),console.log(" PreferencesV4FeedSection: Loaded all interested events:",Q.size)}catch(Q){console.error("Error loading all interested events:",Q)}});y.useEffect(()=>{e&&Y()},[e]);const X=(Q,oe)=>E(void 0,null,function*(){if(oe.stopPropagation(),!e)return;const ee=!b.has(Q);N(G=>{const J=new Set(G);return ee?J.add(Q):J.delete(Q),J});try{yield Kr.setEventInterest(e,Q,ee),o(G=>G.map(J=>J.id===Q?V(D({},J),{user_is_interested:ee}):J)),M({title:ee?"You're interested!":"Interest removed",description:ee?"We'll notify you about this event":"You'll no longer receive notifications for this event"})}catch(G){console.error("Error toggling interest:",G),N(J=>{const ae=new Set(J);return ee?ae.delete(Q):ae.add(Q),ae}),M({title:"Error",description:"Failed to update interest",variant:"destructive"})}}),se=(Q,oe)=>{oe.stopPropagation(),A(Q),k(!0)},de=(Q=0,oe=!1,ie,ee=!1)=>E(void 0,null,function*(){var J,ae,fe;let G=!1;try{let we;if(r)if("genres"in r&&"selectedCities"in r){const Te=r,Ve=Te.selectedCities&&Te.selectedCities.length>0?Te.selectedCities[0]:void 0;Ve?we={city:Ve,genres:Te.genres,dateRange:Te.dateRange,includePast:!1,maxDaysAhead:(J=Te.dateRange)!=null&&J.to?Math.ceil((Te.dateRange.to.getTime()-new Date().getTime())/(1e3*60*60*24)):90,radiusMiles:Te.radiusMiles}:Te.latitude&&Te.longitude?we={latitude:Te.latitude,longitude:Te.longitude,genres:Te.genres,dateRange:Te.dateRange,includePast:!1,maxDaysAhead:(ae=Te.dateRange)!=null&&ae.to?Math.ceil((Te.dateRange.to.getTime()-new Date().getTime())/(1e3*60*60*24)):90,radiusMiles:Te.radiusMiles}:we={genres:Te.genres,dateRange:Te.dateRange,includePast:!1,maxDaysAhead:(fe=Te.dateRange)!=null&&fe.to?Math.ceil((Te.dateRange.to.getTime()-new Date().getTime())/(1e3*60*60*24)):90,radiusMiles:Te.radiusMiles}}else we=r;const ve=K(e,we||r);let me=null;if(Q===0&&!ee&&!oe)if(me=Z(ve),me&&me.length>0){console.log(" Loading cached recommendations:",me.length,"events");const Te=q(me);o(Te),c(!1),x(null),G=!0}else o([]),c(!0);else Q===0&&!oe?(o([]),c(!0)):Q>0&&f(!0);x(null);const Me=yield SK.getFeedPaginated(e,Q,F,we,ie!==void 0?ie:_);if(oe)o(Te=>{const Ve=new Set(Te.map(vt=>vt.id)),le=Me.events.filter(vt=>!Ve.has(vt.id)),Ke=q(le),De=vt=>{if(!vt.event_date)return Number.MAX_SAFE_INTEGER;const rr=new Date(vt.event_date);return isNaN(rr.getTime())?Number.MAX_SAFE_INTEGER:rr.getTime()},nt=[];let ze=0;for(const vt of Te){const rr=De(vt);for(;ze<Ke.length&&De(Ke[ze])<rr;)nt.push(Ke[ze]),ze++;nt.push(vt)}for(;ze<Ke.length;)nt.push(Ke[ze]),ze++;return nt});else{const Te=q(Me.events);o(Te),Q===0&&Te.length>0&&ne(ve,Te)}h(Me.hasMore),v(Q)}catch(we){console.error("Error loading Preferences V4 feed:",we),G?(console.log(" Background fetch failed, keeping cached data"),x(null)):(x("Failed to load recommendations"),c(!1))}finally{(!G||Q>0)&&c(!1),f(!1)}});y.useEffect(()=>{de(0,!1)},[e,r&&"city"in r?r.city:void 0,r&&"selectedCities"in r?r.selectedCities:void 0,r&&"latitude"in r?r.latitude:void 0,r&&"longitude"in r?r.longitude:void 0,r&&"radiusMiles"in r?r.radiusMiles:void 0,r&&"genres"in r?r.genres:void 0,r&&"dateRange"in r?r.dateRange:void 0,r&&"includePast"in r?r.includePast:void 0,r&&"maxDaysAhead"in r?r.maxDaysAhead:void 0]);const _e=y.useCallback(()=>{!d&&u&&de(m+1,!0)},[d,u,m]),xe=y.useCallback(()=>{w(!0);const Q=K(e,r);localStorage.removeItem(Q),o([]),v(0),de(0,!1,!0,!0)},[e,r]);return y.useEffect(()=>{const Q=B.current;if(!Q)return;let oe=!1;Q.scrollTop;let ie=0;const ee=80;let G=!1,J=0;const ae=()=>{Q.scrollTop,oe||(oe=!0,Q.style.transition="none");const Ve=Q.scrollHeight,le=Q.clientHeight,Ke=Q.scrollTop;Ve-Ke-le<200&&u&&!d&&!l&&_e()},fe=()=>{oe=!1,Q.style.transition=""},we=Ve=>{ie=Ve.touches[0].clientY,J=0,G=!1},ve=Ve=>{const Ke=Ve.touches[0].clientY-ie;Q.scrollTop===0&&Ke>0&&(Ve.preventDefault(),J=Ke,G=!0,J>ee?Q.style.transform=`translateY(${Math.min(J,120)}px)`:Q.style.transform=`translateY(${J}px)`)},me=()=>{G&&J>ee?(Q.style.transform="",Q.style.transition="transform 0.3s ease",xe()):G&&(Q.style.transform="",Q.style.transition="transform 0.3s ease"),G=!1,J=0,fe()};Q.addEventListener("scroll",ae,{passive:!0}),Q.addEventListener("touchend",me,{passive:!1}),Q.addEventListener("touchstart",we,{passive:!0}),Q.addEventListener("touchmove",ve,{passive:!1});let Me;const Te=()=>{clearTimeout(Me),Me=setTimeout(fe,150)};return Q.addEventListener("wheel",Te,{passive:!0}),()=>{Q.removeEventListener("scroll",ae),Q.removeEventListener("touchend",me),Q.removeEventListener("touchstart",we),Q.removeEventListener("touchmove",ve),Q.removeEventListener("wheel",Te),clearTimeout(Me)}},[i.length,u,d,l,_e,xe]),l&&i.length===0&&m===0?s.jsx("div",{className:n,children:s.jsx(Nc,{text:"Loading recommendations...",size:"md"})}):g&&i.length===0?s.jsxs("div",{className:`text-center py-6 text-muted-foreground text-sm ${n}`,children:[s.jsx("p",{children:g}),s.jsx(ce,{variant:"outline",size:"sm",onClick:()=>de(0,!1),className:"mt-2",children:"Try Again"})]}):s.jsxs("div",{className:`swift-ui-feed-container ${n}`,children:[i.length>0?s.jsx(s.Fragment,{children:s.jsxs("div",{className:"swift-ui-feed",ref:B,children:[i.map((Q,oe)=>{var fe,we,ve,me,Me,Te;let ie,ee=!1;const G=Q.event_media_url,J=Q.images&&Array.isArray(Q.images)&&Q.images.length>0;if(G)ie=Va(G);else if(J){const Ve=Q.images.find(le=>(le==null?void 0:le.url)&&((le==null?void 0:le.ratio)==="16_9"||(le==null?void 0:le.width)&&le.width>1e3))||Q.images.find(le=>le==null?void 0:le.url);ie=Ve!=null&&Ve.url?Va(Ve.url):void 0}else if(Q.poster_image_url){ie=Va(Q.poster_image_url);const Ve=((fe=Q.poster_image_url)==null?void 0:fe.includes("/storage/v1/object/public/"))||((we=Q.poster_image_url)==null?void 0:we.includes("review-photos"))||((ve=Q.poster_image_url)==null?void 0:ve.includes("supabase.co/storage")),le=((me=Q.poster_image_url)==null?void 0:me.includes("/Generic Images/"))||((Me=Q.poster_image_url)==null?void 0:Me.includes("placeholder"))||((Te=Q.poster_image_url)==null?void 0:Te.includes("picsum.photos"));!J&&Ve&&!le&&(ee=!0)}const ae=`${Q.id||"event"}-${oe}`;return s.jsx("div",{className:"swift-ui-feed-item",children:s.jsx(Ll,{event:{id:Q.id||"",title:Q.title||Q.artist_name||"Event",artist_name:Q.artist_name,venue_name:Q.venue_name,event_date:Q.event_date,venue_city:Q.venue_city||void 0,image_url:ie,poster_image_url:Q.poster_image_url||void 0},interestedCount:(Q.interested_count||0)+(b.has(Q.id)||Q.user_is_interested?1:0),isInterested:b.has(Q.id)||Q.user_is_interested||!1,isCommunityPhoto:ee,onInterestClick:Ve=>X(Q.id,Ve),onShareClick:Ve=>se(Q,Ve),onClick:()=>t==null?void 0:t(Q.id)})},ae)}),d&&s.jsx("div",{className:"flex justify-center py-8",children:s.jsx(Tm,{variant:"spinner",size:"sm"})})]})}):s.jsxs("div",{className:"text-center py-6 text-muted-foreground text-sm",children:[s.jsx("p",{children:"No personalized recommendations yet."}),s.jsx("p",{className:"text-xs mt-1",children:"Start following artists or marking events as interested!"})]}),C&&s.jsx(GT,{event:C,currentUserId:e,isOpen:S,onClose:()=>{k(!1),A(null)}}),R&&O&&s.jsx(E1,{open:R,onClose:()=>{console.log("Closing flag modal"),I(!1),z(null)},contentType:"event",contentId:O.id,contentTitle:O.title||"Event",onReportSubmitted:()=>{console.log("Report submitted"),I(!1),z(null),M({title:"Report Submitted",description:"Thank you for helping keep our community safe"})}})]})},K8e=({currentUserId:e,filters:t,onEventClick:r,onInterestToggle:n,onShareClick:a})=>{const[i,o]=y.useState([]),[l,c]=y.useState(!0),[d,f]=y.useState(!1),[u,h]=y.useState(!0),[m,v]=y.useState(0),g=y.useRef(null),[x,_]=y.useState(new Set),[w,b]=y.useState(new Set),[N,S]=y.useState(new Set),k=XU("event",i.map(O=>({id:O.event_id,metadata:V(D({},Gv(O)),{source:"feed",position:i.indexOf(O)})})));y.useEffect(()=>{E(void 0,null,function*(){try{const{data:z}=yield T.from("artist_follows").select("artist_id").eq("user_id",e);z&&b(new Set(z.map(B=>B.artist_id)));const{data:M}=yield T.from("user_venue_relationships").select("venue_id").eq("user_id",e);M&&S(new Set(M.map(B=>B.venue_id)))}catch(z){console.error("Error loading following:",z)}})},[e]),y.useEffect(()=>{E(void 0,null,function*(){try{const{data:z}=yield T.from("user_event_relationships").select("event_id").eq("user_id",e).eq("relationship_type","interested");z&&_(new Set(z.map(M=>M.event_id)))}catch(z){console.error("Error loading interested events:",z)}})},[e]);const C=y.useCallback((O=0,z=!1,M=!1)=>E(void 0,null,function*(){var B,F,U,H;M&&(v(0),h(!0),o([]));try{O===0&&!z?c(!0):f(!0);const q=20,K=O*q;let Z;if(t)if("genres"in t&&"selectedCities"in t){const G=t,J=G.selectedCities&&G.selectedCities.length>0?G.selectedCities[0]:void 0;J?Z={city:J,genres:G.genres,dateRange:G.dateRange,includePast:!1,maxDaysAhead:(B=G.dateRange)!=null&&B.to?Math.ceil((G.dateRange.to.getTime()-new Date().getTime())/(1e3*60*60*24)):90,radiusMiles:G.radiusMiles||50}:G.latitude&&G.longitude?Z={latitude:G.latitude,longitude:G.longitude,genres:G.genres,dateRange:G.dateRange,includePast:!1,maxDaysAhead:(F=G.dateRange)!=null&&F.to?Math.ceil((G.dateRange.to.getTime()-new Date().getTime())/(1e3*60*60*24)):90,radiusMiles:G.radiusMiles||50}:Z={genres:G.genres,dateRange:G.dateRange,includePast:!1,maxDaysAhead:(U=G.dateRange)!=null&&U.to?Math.ceil((G.dateRange.to.getTime()-new Date().getTime())/(1e3*60*60*24)):90,radiusMiles:G.radiusMiles||50}}else Z=t;const ne=(Z==null?void 0:Z.city)||(t==null?void 0:t.city)||((H=t==null?void 0:t.selectedCities)==null?void 0:H[0]),[Y,X,se,de,_e]=yield Promise.all([SK.getFeed(e,q,0,Z,!1),Uu.getTrendingEvents(e,void 0,void 0,50,q,ne),Uu.getFirstDegreeNetworkEvents(e,q),Uu.getSecondDegreeNetworkEvents(e,q),A(e,q,K)]),xe=Y.events||[],Q=[];xe.forEach(G=>{Q.push({event_id:G.id||"",title:G.title||G.artist_name||"Event",artist_name:G.artist_name,venue_name:G.venue_name,venue_city:G.venue_city||void 0,event_date:G.event_date,image_url:G.image_url,poster_image_url:G.poster_image_url||void 0,images:G.images,event_media_url:G.event_media_url||G.poster_image_url||void 0,reason:"recommended",interested_count:G.interested_count||0,user_is_interested:G.user_is_interested||!1})});const oe=new Set(Q.map(G=>G.event_id));X.forEach(G=>{oe.has(G.event_id)||Q.push({event_id:G.event_id,title:G.title,artist_name:G.artist_name,venue_name:G.venue_name,venue_city:G.venue_city||void 0,event_date:G.event_date,event_media_url:G.event_media_url,reason:"trending",interested_count:0})}),oe.clear(),Q.forEach(G=>oe.add(G.event_id)),[...se,...de].forEach(G=>{oe.has(G.event_id)||Q.push({event_id:G.event_id,title:G.title,artist_name:G.artist_name,venue_name:G.venue_name,venue_city:G.venue_city||void 0,event_date:G.event_date,images:G.images,event_media_url:G.event_media_url,reason:"friend_interested",interested_count:G.interested_count||0})}),oe.clear(),Q.forEach(G=>oe.add(G.event_id)),_e.forEach(G=>{oe.has(G.event_id)||Q.push({event_id:G.event_id,title:G.title,artist_name:G.artist_name,venue_name:G.venue_name,venue_city:G.venue_city||void 0,event_date:G.event_date,images:G.images,event_media_url:G.event_media_url,reason:"following",followed_artist_id:G.followed_artist_id,followed_venue_id:G.followed_venue_id,interested_count:0})});const ie=new Date;ie.setHours(0,0,0,0);const ee=Q.filter(G=>{if(!G.event_date)return!1;const J=new Date(G.event_date);return J.setHours(0,0,0,0),J>=ie});for(let G=ee.length-1;G>0;G--){const J=Math.floor(Math.random()*(G+1));[ee[G],ee[J]]=[ee[J],ee[G]]}o(z?G=>[...G,...ee]:ee),h(ee.length>=q)}catch(q){console.error("Error loading unified events:",q)}finally{c(!1),f(!1)}}),[e,t]),A=(O,z,M)=>E(void 0,null,function*(){try{const{data:B}=yield T.from("artist_follows").select("artist_id").eq("user_id",O),{data:F}=yield T.from("user_venue_relationships").select("venue_id").eq("user_id",O),U=(B==null?void 0:B.map(ne=>ne.artist_id))||[],H=(F==null?void 0:F.map(ne=>ne.venue_id))||[];if(U.length===0&&H.length===0)return[];let q=T.from("events").select("id, title, event_date, venue_city, images, event_media_url, media_urls, artist_id, artists(name), venue_id, venues(name)").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).range(M,M+z-1);U.length>0&&H.length>0?q=q.or(`artist_id.in.(${U.join(",")}),venue_id.in.(${H.join(",")})`):U.length>0?q=q.in("artist_id",U):H.length>0&&(q=q.in("venue_id",H));const{data:K,error:Z}=yield q;return Z?(console.error("Error loading following events:",Z),[]):!K||K.length===0?[]:K.map(ne=>{var X,se,de;let Y;if(ne.event_media_url)Y=ne.event_media_url;else if(ne.images&&Array.isArray(ne.images)&&ne.images.length>0){const _e=ne.images.find(xe=>(xe==null?void 0:xe.url)&&((xe==null?void 0:xe.ratio)==="16_9"||(xe==null?void 0:xe.width)&&xe.width>1e3))||ne.images.find(xe=>xe==null?void 0:xe.url);Y=_e==null?void 0:_e.url}else ne.media_urls&&Array.isArray(ne.media_urls)&&ne.media_urls.length>0&&(Y=ne.media_urls[0]);return{event_id:ne.id,title:ne.title||((X=ne.artists)==null?void 0:X.name)||"Event",artist_name:((se=ne.artists)==null?void 0:se.name)||void 0,venue_name:((de=ne.venues)==null?void 0:de.name)||void 0,venue_city:ne.venue_city||void 0,event_date:ne.event_date,images:ne.images,event_media_url:Y,reason:"following",followed_artist_id:ne.artist_id,followed_venue_id:ne.venue_id,interested_count:0}})}catch(B){return console.error("Error loading following events:",B),[]}});y.useEffect(()=>{C(0,!1,!0)},[C]);const R=(O,z)=>E(void 0,null,function*(){const M=i.find(U=>U.event_id===O);if(M)try{const U=ef(M);trackInteraction.interest("event",O,!x.has(O),V(D({},Gv(M)),{source:"feed"}),U||void 0)}catch(U){console.error("Error tracking interest toggle:",U)}z.stopPropagation();const F=!x.has(O);try{yield Kr.setEventInterest(e,O,F),_(U=>{const H=new Set(U);return F?H.add(O):H.delete(O),H}),o(U=>U.map(H=>H.event_id===O?V(D({},H),{user_is_interested:F,interested_count:(H.interested_count||0)+(F?1:-1)}):H)),n==null||n(O,F)}catch(U){console.error("Error toggling interest:",U)}});y.useEffect(()=>{const O=g.current;if(!O)return;let z=0,M=80,B=!1,F=0;const U=()=>{const Z=O.scrollHeight,ne=O.clientHeight,Y=O.scrollTop;if(Z-Y-ne<200&&u&&!d&&!l){const X=m+1;v(X),C(X,!0)}},H=Z=>{z=Z.touches[0].clientY,F=0,B=!1},q=Z=>{const Y=Z.touches[0].clientY-z;O.scrollTop===0&&Y>0&&(Z.preventDefault(),F=Y,B=!0,F>M?O.style.transform=`translateY(${Math.min(F,120)}px)`:O.style.transform=`translateY(${F}px)`)},K=()=>{B&&F>M?(O.style.transform="",O.style.transition="transform 0.3s ease",C(0,!1,!0)):B&&(O.style.transform="",O.style.transition="transform 0.3s ease"),B=!1,F=0};return O.addEventListener("scroll",U,{passive:!0}),O.addEventListener("touchend",K,{passive:!1}),O.addEventListener("touchstart",H,{passive:!0}),O.addEventListener("touchmove",q,{passive:!1}),()=>{O.removeEventListener("scroll",U),O.removeEventListener("touchend",K),O.removeEventListener("touchstart",H),O.removeEventListener("touchmove",q)}},[u,d,l,m,C]);const I=O=>{if(O.event_media_url)return Va(O.event_media_url);if(O.images&&Array.isArray(O.images)&&O.images.length>0){const z=O.images.find(M=>(M==null?void 0:M.url)&&((M==null?void 0:M.ratio)==="16_9"||(M==null?void 0:M.width)&&M.width>1e3))||O.images.find(M=>M==null?void 0:M.url);return z!=null&&z.url?Va(z.url):void 0}else{if(O.image_url)return Va(O.image_url);if(O.poster_image_url)return Va(O.poster_image_url)}};return l&&i.length===0?s.jsx("div",{className:"swift-ui-feed-container",children:s.jsx(Nc,{text:"Loading events...",size:"md"})}):i.length===0?s.jsx("div",{className:"swift-ui-feed-container flex items-center justify-center",children:s.jsxs("div",{className:"text-center py-12 px-4",children:[s.jsx("p",{className:"text-lg font-semibold text-neutral-900 mb-2",children:"No events found"}),s.jsx("p",{className:"text-sm text-neutral-600",children:"Try adjusting your filters or check back later"})]})}):s.jsx("div",{className:"swift-ui-feed-container",children:s.jsxs("div",{className:"swift-ui-feed",ref:g,children:[i.map((O,z)=>{const M=I(O),B=x.has(O.event_id)||O.user_is_interested||!1,F=(O.interested_count||0)+(B?1:0);return s.jsx("div",{className:"swift-ui-feed-item",ref:U=>k(U,O.event_id),children:s.jsx(Ll,{event:{id:O.event_id,title:O.title,artist_name:O.artist_name,venue_name:O.venue_name,event_date:O.event_date,venue_city:O.venue_city,image_url:M,poster_image_url:O.poster_image_url},reason:O.reason,interestedCount:F,isInterested:B,onInterestClick:U=>R(O.event_id,U),onShareClick:U=>a==null?void 0:a(O,U),onClick:()=>r==null?void 0:r(O.event_id)})},`${O.event_id}-${z}`)}),d&&s.jsx("div",{className:"flex justify-center py-8",children:s.jsx(Tm,{variant:"spinner",size:"sm"})})]})})},Z8e=({currentUserId:e,onNavigateToProfile:t,onNavigateToEvent:r,onNavigateToArtist:n,onNavigateToVenue:a,onNavigateToChat:i,onNavigateToNotifications:o,onViewChange:l,menuOpen:c=!1,onMenuClick:d,hideHeader:f=!1,refreshTrigger:u=0})=>{var mn;const[h,m]=y.useState(null);y.useState("next_30_days");const[v,g]=y.useState(null),[x,_]=y.useState({genres:[],selectedCities:[],dateRange:{},showFilters:!1,radiusMiles:50,filterByFollowing:"all",daysOfWeek:[]});y.useRef(!1),y.useState(["Rock","Pop","Hip-Hop","Electronic","Jazz","Classical","Country","R&B","Reggae","Folk","Blues","Alternative","Indie","Punk","Metal","Funk","Soul","Gospel","Latin","World"]);const[w,b]=y.useState([]);y.useState([]);const[N,S]=y.useState([]),[k,C]=y.useState([]),[A,R]=y.useState([]);y.useState([]);const[I,O]=y.useState([]),[z,M]=y.useState(0),[B,F]=y.useState(0),[U,H]=y.useState(!0),[q,K]=y.useState(!0),[Z,ne]=y.useState([]);y.useState(new Set),y.useState(new Set),y.useState(new Set);const[Y,X]=y.useState(new Set),[se,de]=y.useState([]);y.useState(!0);const[_e,xe]=y.useState(!0),[Q,oe]=y.useState(!0);y.useState(!0);const[ie,ee]=y.useState(!0),[G,J]=y.useState(!1),[ae,fe]=y.useState(!1),[we,ve]=y.useState([]),[me,Me]=y.useState(!1),[Te,Ve]=y.useState(null),[le,Ke]=y.useState("events"),[De,nt]=y.useState(!1),[ze,vt]=y.useState(null),[rr,sr]=y.useState(null),[Ae,Ue]=y.useState(!1),[gt,Ce]=y.useState(!1),[Ge,Nt]=y.useState(null),[Tt,at]=y.useState(!1),ue=y.useRef(null),qe=y.useRef(null);y.useState([]),go("view","home_feed",{source:"home"}),y.useEffect(()=>{ct(),Ct()},[e]),y.useEffect(()=>{const je=()=>E(void 0,null,function*(){try{const Pe=localStorage.getItem("selectedEvent");if(Pe){const Ne=JSON.parse(Pe);if(localStorage.removeItem("selectedEvent"),sr(Ne),Ne.id){const Ye=yield Kr.isUserInterested(e,Ne.id);Ce(Ye)}setTimeout(()=>{Ue(!0)},50)}}catch(Pe){console.error("Error loading selectedEvent from localStorage:",Pe),localStorage.removeItem("selectedEvent")}});je();const pe=Pe=>{const Ne=Pe.detail;Ne!=null&&Ne.event&&je()};return window.addEventListener("open-event-details",pe),()=>{window.removeEventListener("open-event-details",pe)}},[e]),y.useEffect(()=>{E(void 0,null,function*(){try{const{data:pe}=yield T.rpc("get_available_cities_for_filter",{min_event_count:1,limit_count:500});pe&&b(pe.map(Pe=>Pe.city_name))}catch(pe){console.error("Error loading cities:",pe)}})},[]),y.useEffect(()=>{console.log(" [HOME FEED] Feed type changed:",le),le==="trending"?(console.log(" [HOME FEED] Loading trending events..."),Fe(!0)):le==="friends"?pt(!0):le==="group-chats"?(hr(),Et()):le==="reviews"&&(At(),ft())},[le]),y.useEffect(()=>{u&&u>0&&(console.log(" [HOME FEED] Refresh trigger changed, refetching reviews..."),le==="reviews"&&At())},[u,le]),y.useEffect(()=>{const je=document.querySelector('[data-tour="feed-toggle"]');je&&(je.style.borderColor=De?"var(--brand-pink-500)":"var(--neutral-200)")},[De]),y.useEffect(()=>{le==="trending"&&Fe(!0)},[x.genres,x.selectedCities,x.dateRange]),y.useEffect(()=>{if(le!=="trending")return;const je=ue.current;if(!je)return;let pe=0;const Pe=80;let Ne=!1,Ye=0;const We=()=>{const rt=je.scrollHeight,ir=je.clientHeight,rn=je.scrollTop;rt-rn-ir<200&&U&&!ie&&(M(Mt=>Mt+1),Fe(!1))},It=rt=>{pe=rt.touches[0].clientY,Ye=0,Ne=!1},jt=rt=>{const rn=rt.touches[0].clientY-pe;je.scrollTop===0&&rn>0&&(rt.preventDefault(),Ye=rn,Ne=!0,Ye>Pe?je.style.transform=`translateY(${Math.min(Ye,120)}px)`:je.style.transform=`translateY(${Ye}px)`)},Ee=()=>{Ne&&Ye>Pe?(je.style.transform="",je.style.transition="transform 0.3s ease",M(0),Fe(!0)):Ne&&(je.style.transform="",je.style.transition="transform 0.3s ease"),Ne=!1,Ye=0};return je.addEventListener("scroll",We,{passive:!0}),je.addEventListener("touchend",Ee,{passive:!1}),je.addEventListener("touchstart",It,{passive:!0}),je.addEventListener("touchmove",jt,{passive:!1}),()=>{je.removeEventListener("scroll",We),je.removeEventListener("touchend",Ee),je.removeEventListener("touchstart",It),je.removeEventListener("touchmove",jt)}},[le,U,ie,I.length]),y.useEffect(()=>{if(le!=="friends")return;const je=qe.current;if(!je)return;let pe=0;const Pe=80;let Ne=!1,Ye=0;const We=()=>{const rt=je.scrollHeight,ir=je.clientHeight,rn=je.scrollTop;rt-rn-ir<200&&q&&!_e&&(F(Mt=>Mt+1),pt(!1))},It=rt=>{pe=rt.touches[0].clientY,Ye=0,Ne=!1},jt=rt=>{const rn=rt.touches[0].clientY-pe;je.scrollTop===0&&rn>0&&(rt.preventDefault(),Ye=rn,Ne=!0,Ye>Pe?je.style.transform=`translateY(${Math.min(Ye,120)}px)`:je.style.transform=`translateY(${Ye}px)`)},Ee=()=>{Ne&&Ye>Pe?(je.style.transform="",je.style.transition="transform 0.3s ease",F(0),pt(!0)):Ne&&(je.style.transform="",je.style.transition="transform 0.3s ease"),Ne=!1,Ye=0};return je.addEventListener("scroll",We,{passive:!0}),je.addEventListener("touchend",Ee,{passive:!1}),je.addEventListener("touchstart",It,{passive:!0}),je.addEventListener("touchmove",jt,{passive:!1}),()=>{je.removeEventListener("scroll",We),je.removeEventListener("touchend",Ee),je.removeEventListener("touchstart",It),je.removeEventListener("touchmove",jt)}},[le,q,_e]);const Ct=()=>E(void 0,null,function*(){try{let je=null,pe=null;try{je=yield Ua.getCurrentLocation();const Ee=yield Ua.reverseGeocode(je.latitude,je.longitude);Ee&&(pe=Ee)}catch(Ee){(Ee==null?void 0:Ee.code)!==1&&console.error("Error getting current location:",Ee)}const{data:Pe}=yield T.from("users").select("location_city, latitude, longitude").eq("user_id",e).single();let Ne,Ye,We;if(Pe!=null&&Pe.location_city){Ne=Pe.location_city;try{const{RadiusSearchService:Ee}=yield Rr(()=>E(void 0,null,function*(){const{RadiusSearchService:ir}=yield Promise.resolve().then(()=>V2);return{RadiusSearchService:ir}}),void 0,import.meta.url),rt=yield Ee.getCityCoordinates(Pe.location_city);rt&&(Ye=rt.lat,We=rt.lng)}catch(Ee){console.error("Error converting city to coordinates:",Ee)}}else if(Pe!=null&&Pe.latitude&&(Pe!=null&&Pe.longitude)){Ye=Pe.latitude,We=Pe.longitude;try{const Ee=yield Ua.reverseGeocode(Pe.latitude,Pe.longitude);Ee&&(Ne=Ee)}catch(Ee){console.error("Error reverse geocoding specified location:",Ee)}}const It=Ye||(je==null?void 0:je.latitude),jt=We||(je==null?void 0:je.longitude);It&&jt?(vt({latitude:It,longitude:jt,radiusMiles:50,locationName:pe,specifiedLocationName:Ne,specifiedLatitude:Ye,specifiedLongitude:We}),_(Ee=>V(D({},Ee),{latitude:It,longitude:jt,radiusMiles:Ee.radiusMiles||50,selectedCities:[]}))):je&&(vt({latitude:je.latitude,longitude:je.longitude,radiusMiles:50,locationName:pe}),_(Ee=>V(D({},Ee),{latitude:je.latitude,longitude:je.longitude,radiusMiles:Ee.radiusMiles||50,selectedCities:[]})))}catch(je){console.error("Error loading feed location:",je)}}),ct=()=>E(void 0,null,function*(){try{const{data:je,error:pe}=yield T.from("users").select("location_city").eq("user_id",e).single();if(pe)throw pe;if(je!=null&&je.location_city){m(je.location_city);try{const{RadiusSearchService:Pe}=yield Rr(()=>E(void 0,null,function*(){const{RadiusSearchService:Ye}=yield Promise.resolve().then(()=>V2);return{RadiusSearchService:Ye}}),void 0,import.meta.url),Ne=yield Pe.getCityCoordinates(je.location_city);Ne&&g(Ne)}catch(Pe){console.error("Error getting city coordinates:",Pe)}}else m(null)}catch(je){console.error("Error loading user city:",je),m(null)}}),pt=(je=!1)=>E(void 0,null,function*(){je&&(F(0),xe(!0));try{const[Pe,Ne]=yield Promise.all([Uu.getFirstDegreeNetworkEvents(e,(B+1)*10),Uu.getSecondDegreeNetworkEvents(e,(B+1)*8)]);je?(S(Pe.slice(0,10)),C(Ne.slice(0,8))):(S(We=>[...We,...Pe.slice(B*10,(B+1)*10)]),C(We=>[...We,...Ne.slice(B*8,(B+1)*8)]));const Ye=Pe.length+Ne.length;K(Ye>(B+1)*18)}catch(pe){console.error("Error loading network events:",pe),je&&(S([]),C([]))}finally{xe(!1)}}),At=()=>E(void 0,null,function*(){oe(!0);try{const je=yield Uu.getNetworkReviews(e,20);R(je)}catch(je){console.error("Error loading reviews:",je),R([])}finally{oe(!1)}}),yt=je=>{console.log(" [FILTER] applyFiltersToEvents called:",{eventCount:je.length,filters:{selectedCities:x.selectedCities,dateRange:x.dateRange,genres:x.genres}});const pe=je.filter((Pe,Ne)=>{if(x.dateRange.from||x.dateRange.to){if(!Pe.event_date)return console.log(` [FILTER] Event ${Ne} filtered out: no event_date`),!1;const Ye=new Date(Pe.event_date);if(x.dateRange.from&&Ye<x.dateRange.from)return console.log(` [FILTER] Event ${Ne} filtered out: before date range`,Ye),!1;if(x.dateRange.to){const We=new Date(x.dateRange.to);if(We.setHours(23,59,59,999),Ye>We)return console.log(` [FILTER] Event ${Ne} filtered out: after date range`,Ye),!1}}if(x.genres&&x.genres.length>0){const Ye=(Pe.genres||[]).map(It=>It.toLowerCase());if(Ye.length===0)return console.log(` [FILTER] Event ${Ne} filtered out: no genres`),!1;if(!x.genres.some(It=>Ye.some(jt=>jt.includes(It.toLowerCase())||It.toLowerCase().includes(jt))))return console.log(` [FILTER] Event ${Ne} filtered out: genre mismatch`,{eventGenres:Ye,filterGenres:x.genres}),!1}return!0});return console.log(" [FILTER] applyFiltersToEvents result:",{inputCount:je.length,outputCount:pe.length}),pe},Fe=(je=!1)=>E(void 0,null,function*(){console.log(" [TRENDING] loadTrendingEvents called",{reset:je,trendingPage:z,cityCoordinates:v}),je&&(M(0),ee(!0));try{console.log(" [TRENDING] Calling getTrendingEvents with params:",{userId:e,cityLat:v==null?void 0:v.lat,cityLng:v==null?void 0:v.lng,radiusMiles:50,limit:(z+1)*12,activeCity:h});const Pe=yield Uu.getTrendingEvents(e,v==null?void 0:v.lat,v==null?void 0:v.lng,50,(z+1)*12,h||void 0);console.log(" [TRENDING] getTrendingEvents returned:",{eventCount:Pe.length,events:Pe});const Ne=yt(Pe);console.log(" [TRENDING] After applying filters:",{filteredCount:Ne.length}),je?(O(Ne.slice(0,12)),console.log(" [TRENDING] Set trending events (reset):",Ne.slice(0,12).length)):O(Ye=>{const We=[...Ye,...Ne.slice(z*12,(z+1)*12)];return console.log(" [TRENDING] Set trending events (append):",{prevCount:Ye.length,newCount:We.length}),We}),H(Ne.length>(z+1)*12),console.log(" [TRENDING] Load complete:",{hasMore:Ne.length>(z+1)*12})}catch(pe){console.error(" [TRENDING] Error loading trending events:",pe),je&&O([])}finally{ee(!1),console.log(" [TRENDING] Loading state set to false")}}),ft=()=>E(void 0,null,function*(){J(!0);try{const[je,pe]=yield Promise.allSettled([T.rpc("get_second_degree_connections",{target_user_id:e}),T.rpc("get_third_degree_connections",{target_user_id:e})]),Pe=je.status==="fulfilled"&&!je.value.error&&je.value.data?je.value.data.map(We=>V(D({},We),{connection_degree:2})):[],Ne=pe.status==="fulfilled"&&!pe.value.error&&pe.value.data?pe.value.data.map(We=>V(D({},We),{connection_degree:3})):[],Ye=[...Pe,...Ne].sort((We,It)=>{const jt=We.mutual_friends_count||0,Ee=It.mutual_friends_count||0;return jt!==Ee?Ee-jt:We.connection_degree-It.connection_degree}).slice(0,20);ne(Ye)}catch(je){console.error("Error loading recommended friends:",je),ne([])}finally{J(!1)}}),Et=()=>E(void 0,null,function*(){try{const je=yield Mu.getRecommendedFriends(e);ve(je)}catch(je){console.error("Error loading friend suggestions for rail:",je),ve([])}}),hr=()=>E(void 0,null,function*(){fe(!0);try{console.log(" Loading recommended chats for user:",e);const{data:je,error:pe}=yield T.rpc("get_recommended_chats",{p_user_id:e,p_limit:20,p_offset:0,p_radius_miles:50});if(pe)throw console.error(" Error calling get_recommended_chats:",pe),pe;console.log(" Raw recommended chats from RPC:",je);const Pe=(je||[]).filter(Ne=>!Y.has(Ne.chat_id)).map(Ne=>{let Ye=0;if(Ne.member_count!=null&&Ne.member_count!==void 0){const We=Ne.member_count;if(typeof We=="number")Ye=Math.max(0,Math.floor(We));else{const It=String(We).replace(/[^0-9]/g,""),jt=parseInt(It,10);!isNaN(jt)&&jt>=0&&(Ye=jt)}}return Ye=Number(Ye),(isNaN(Ye)||Ye<0)&&(Ye=0),{id:Ne.chat_id,chat_name:Ne.chat_name||Ne.entity_name||"Unnamed Group",member_count:Ye,friends_in_chat_count:0,entity_type:Ne.entity_type,entity_name:Ne.entity_name,entity_image_url:Ne.entity_image_url,relevance_score:Ne.relevance_score,distance_miles:Ne.distance_miles}});console.log(" Loaded recommended chats:",Pe.length),console.log(" Member counts:",Pe.map(Ne=>({id:Ne.id,name:Ne.chat_name,member_count:Ne.member_count,type:typeof Ne.member_count}))),de(Pe)}catch(je){console.error(" Error loading recommended group chats:",je),de([])}finally{fe(!1)}}),dr=je=>E(void 0,null,function*(){var pe,Pe;try{const Ne=ef({id:je});Zt.click("event",je,{source:"home_feed"},Ne||void 0)}catch(Ne){console.error("Error tracking event click:",Ne)}try{const{data:Ne,error:Ye}=yield T.from("events").select("*, artists(name), venues(name)").eq("id",je).single();if(Ye){console.error("Error fetching event:",Ye);return}if(Ne){const We=V(D({},Ne),{artist_name:((pe=Ne.artists)==null?void 0:pe.name)||null,venue_name:((Pe=Ne.venues)==null?void 0:Pe.name)||null});sr(We);const It=yield Kr.isUserInterested(e,Ne.id);Ce(It),Ue(!0)}}catch(Ne){console.error("Error fetching event details:",Ne)}}),cn=[{value:"events",label:"Events"},{value:"reviews",label:"Reviews"}];return s.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--neutral-50)"},children:[!f&&s.jsx(Qo,{menuOpen:c,onMenuClick:d,children:s.jsx("div",{style:{width:"100%",paddingLeft:"var(--spacing-screen-margin-x, 20px)",display:"flex",justifyContent:"flex-start"},children:s.jsxs(q1,{open:De,onOpenChange:nt,children:[s.jsx(V1,{asChild:!0,children:s.jsxs(ce,{variant:"outline",className:"flex items-center gap-2",style:{backgroundColor:"var(--neutral-50)",borderColor:De?"var(--brand-pink-500)":"var(--neutral-200)",borderWidth:"2px",borderStyle:"solid",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",transition:"border-color 0.2s ease"},onMouseEnter:je=>{je.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:je=>{!je.currentTarget.matches(":focus-visible")&&!De&&(je.currentTarget.style.borderColor="var(--neutral-200)")},onFocus:je=>{je.currentTarget.style.borderColor="var(--brand-pink-500)",je.currentTarget.style.outline="2px solid var(--brand-pink-500)",je.currentTarget.style.outlineOffset="2px"},onBlur:je=>{je.currentTarget.style.outline="none",De||(je.currentTarget.style.borderColor="var(--neutral-200)")},"data-tour":"feed-toggle",children:[s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},children:((mn=cn.find(je=>je.value===le))==null?void 0:mn.label)||"Events"}),s.jsx(Aa,{className:"h-4 w-4",style:{color:"var(--neutral-900)"}})]})}),s.jsx(c0,{style:{backgroundColor:"var(--neutral-50)",border:"2px solid var(--neutral-200)",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 4px 4px 0 var(--shadow-color)",padding:"var(--spacing-inline, 6px)",minWidth:"200px"},children:cn.map(je=>s.jsx(Yi,{onClick:()=>Ke(je.value),style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)",padding:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",cursor:"pointer"},onMouseEnter:pe=>{pe.currentTarget.style.backgroundColor="var(--brand-pink-050)"},onMouseLeave:pe=>{pe.currentTarget.style.backgroundColor="transparent"},children:je.label},je.value))})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto",style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:f?"calc(env(safe-area-inset-top, 0px) + var(--spacing-small, 12px))":"calc(env(safe-area-inset-top, 0px) + 68px + var(--spacing-small, 12px))",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[ze&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"flex items-center justify-end gap-2",style:{marginBottom:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-screen-margin-x, 20px)"},children:[s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-bold-weight, 700)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},children:"Radius:"}),s.jsx("select",{value:ze.radiusMiles,onChange:je=>{const pe=parseInt(je.target.value,10);vt(Pe=>Pe?V(D({},Pe),{radiusMiles:pe}):null),_(Pe=>V(D({},Pe),{radiusMiles:pe}))},className:"rounded px-2 py-1 focus:outline-none focus:ring-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",border:"1px solid var(--neutral-200)",backgroundColor:"var(--neutral-50)",color:"var(--neutral-900)"},children:[1,5,10,15,20,25,30,40,50].map(je=>s.jsxs("option",{value:je,style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[je," mi"]},je))})]})}),le==="events"&&s.jsx(K8e,{currentUserId:e,filters:x,onEventClick:dr,onInterestToggle:(je,pe)=>E(void 0,null,function*(){console.log("Interest toggled:",je,pe)}),onShareClick:(je,pe)=>E(void 0,null,function*(){pe.stopPropagation(),console.log("Share event:",je)})}),le==="recommended"&&s.jsx(Y8e,{userId:e,onEventClick:dr,filters:x}),le==="trending"&&s.jsx("div",{className:"space-y-4",children:ie&&I.length===0?s.jsx(Nc,{text:"Loading trending events...",size:"md"}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:I.map(je=>s.jsx(Ll,{event:{id:je.event_id,title:je.title,artist_name:je.artist_name,venue_name:je.venue_name,event_date:je.event_date,venue_city:je.venue_city||void 0,image_url:Va(je.event_media_url)||void 0},onClick:()=>dr(je.event_id)},je.event_id))}),U&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(ce,{variant:"outline",onClick:()=>{M(je=>je+1),Fe(!1)},disabled:ie,children:ie?s.jsxs(s.Fragment,{children:[s.jsx(Tm,{variant:"spinner",size:"sm"}),"Loading..."]}):"Load More"})})]})}),le==="friends"&&s.jsx("div",{className:"space-y-4",children:_e&&N.length===0&&k.length===0?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Nc,{})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:[...N,...k].map(je=>s.jsx(Ll,{event:{id:je.event_id,title:je.title,artist_name:je.artist_name,venue_name:je.venue_name,event_date:je.event_date,venue_city:je.venue_city||void 0},onClick:()=>dr(je.event_id)},je.event_id))}),q&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(ce,{variant:"outline",onClick:()=>{F(je=>je+1),pt(!1)},disabled:_e,children:_e?s.jsxs(s.Fragment,{children:[s.jsx(Tm,{variant:"spinner",size:"sm"}),"Loading..."]}):"Load More"})})]})}),le==="group-chats"&&s.jsx("div",{className:"flex items-center justify-center py-24",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(Ln,{className:"w-12 h-12 mx-auto",style:{color:"var(--neutral-600)"}}),s.jsx("h3",{className:"font-semibold",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)"},children:"Coming Soon"}),s.jsx("p",{className:"text-muted-foreground",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:"Group chats are still in development"})]})}),!1,le==="reviews"&&s.jsx("div",{className:"space-y-4",children:Q?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Nc,{})}):A.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center",style:{gap:"var(--spacing-inline, 6px)",paddingTop:"var(--spacing-grouped, 24px)",paddingBottom:"var(--spacing-grouped, 24px)"},children:[s.jsx(Re,{name:"squareComment",size:60,alt:"",color:"var(--neutral-600)"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No reviews yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Be the first to review an event!"})]}):s.jsx("div",{className:"space-y-3",children:A.map(je=>s.jsx(NK,{review:{id:je.id,author:{id:je.author.id,name:je.author.name,avatar_url:je.author.avatar_url},created_at:je.created_at,rating:je.rating,content:je.content,photos:je.photos,event_info:je.event_info},onClick:()=>{var Pe;const pe={id:je.id,type:"review",title:((Pe=je.event_info)==null?void 0:Pe.artist_name)||"Review",author:je.author,created_at:je.created_at,content:je.content,rating:je.rating,photos:je.photos,event_info:je.event_info,relevance_score:0};Nt(pe),at(!0)}},je.id))})})]}),Ae&&rr&&s.jsx(Hl,{isOpen:Ae,onClose:()=>{Ue(!1),sr(null)},event:rr,currentUserId:e,isInterested:gt,onInterestToggle:(je,pe)=>E(void 0,null,function*(){try{yield Kr.setEventInterest(e,je,pe),Ce(pe)}catch(Pe){console.error("Error toggling interest:",Pe)}}),onReview:()=>{console.log("Review event:",rr.id)},onNavigateToProfile:t,onNavigateToChat:i}),Tt&&Ge&&s.jsx(vn,{open:Tt,onOpenChange:at,children:s.jsxs(hn,{className:"fixed inset-0 z-[100] max-w-none w-full h-full m-0 p-0 overflow-hidden rounded-none",style:{left:0,top:0,transform:"none",width:"100vw",height:"100vh",maxWidth:"100vw",maxHeight:"100vh",borderRadius:0,border:"none",boxShadow:"none",backgroundColor:"var(--neutral-50)"},children:[s.jsx(Sn,{className:"sr-only",children:"Review Details"}),s.jsxs(ds,{className:"sr-only",children:["Detailed view of ",Ge.author.name,"'s review"]}),s.jsx(G8e,{reviewId:Ge.review_id||Ge.id,currentUserId:e,onBack:()=>at(!1),onEdit:()=>{},onDelete:()=>{}})]})}),Te&&s.jsx(ZU,{isOpen:me,onClose:()=>{Me(!1),Ve(null)},contentType:"event",contentId:Te.id,contentTitle:Te.title})]})};class TC{static registerToken(t,r="ios",n,a){return E(this,null,function*(){try{const{error:i}=yield T.rpc("register_device_token",{p_device_token:t,p_platform:r,p_device_id:n,p_app_version:a});if(i)throw i;console.log(" Device token registered successfully")}catch(i){throw console.error(" Error registering device token:",i),i}})}static unregisterToken(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("unregister_device_token",{p_device_token:t});if(r)throw r;console.log(" Device token unregistered successfully")}catch(r){console.error(" Error unregistering device token:",r)}})}static getStoredToken(){return typeof window=="undefined"?null:localStorage.getItem("device_token")}static storeToken(t){typeof window!="undefined"&&localStorage.setItem("device_token",t)}static initialize(){return E(this,null,function*(){var r;if(this.initialized){console.log("Push notifications already initialized");return}if(typeof window=="undefined"){console.log("Window not available, skipping push notification initialization");return}if(!((r=window.Capacitor)==null?void 0:r.isNativePlatform())){console.log("Not on native platform, skipping push notification initialization");return}try{const n=yield Rr(()=>import("./index-DIOKaW2y.js"),[],import.meta.url).catch(()=>null);if(!n||!n.PushNotifications){console.log(" Capacitor push notifications plugin not available (this is normal in web/desktop)");return}const{PushNotifications:a}=n;if((yield a.requestPermissions()).receive==="granted")yield a.register(),console.log(" Push notifications registered");else{console.log(" Push notification permission denied");return}a.addListener("registration",o=>E(this,null,function*(){var c;console.log(" Device token received:",o.value),this.storeToken(o.value);const l=((c=window.Capacitor)==null?void 0:c.getPlatform())==="ios"?(yield Rr(()=>E(this,null,function*(){const{App:d}=yield import("./index-BKCc29_F.js");return{App:d}}),[],import.meta.url)).App.getInfo().then(d=>d.version):void 0;yield this.registerToken(o.value,"ios",void 0,yield l)})),a.addListener("registrationError",o=>{console.error(" Push notification registration error:",o)}),a.addListener("pushNotificationReceived",o=>{console.log(" Push notification received:",o)}),a.addListener("pushNotificationActionPerformed",o=>E(this,null,function*(){console.log(" Push notification action performed:",o);const l=o.notification.data;l!=null&&l.type&&(yield this.handleNotificationNavigation(l))})),window.addEventListener("DeviceTokenReceived",o=>E(this,null,function*(){var c,d;const l=((c=o.detail)==null?void 0:c.token)||((d=o.detail)==null?void 0:d.token);l&&(console.log(" Device token received via native event:",l),this.storeToken(l),yield this.registerToken(l,"ios"))})),window.addEventListener("PushNotificationTapped",o=>E(this,null,function*(){const l=o.detail||o.detail;l&&(yield this.handleNotificationNavigation(l))})),this.initialized=!0,console.log(" Push notification service initialized")}catch(n){console.error(" Error initializing push notifications:",n)}})}static handleNotificationNavigation(t){return E(this,null,function*(){try{const{type:r,chat_id:n,event_id:a,sender_id:i}=t;switch(r){case"friend_request":i&&(window.location.href=`/profile/${i}`);break;case"message":n&&(window.location.href=`/chat/${n}`);break;case"event_interest":case"event_reminder_1_week":case"event_reminder_3_days":case"event_reminder_1_day":case"event_reminder_day_after":case"artist_new_event":case"venue_new_event":(a||t.event_id)&&(window.location.href=`/event/${a||t.event_id}`);break;default:window.location.href="/notifications"}}catch(r){console.error("Error handling notification navigation:",r)}})}static cleanup(){return E(this,null,function*(){const t=this.getStoredToken();t&&(yield this.unregisterToken(t),localStorage.removeItem("device_token")),this.initialized=!1})}}Pr(TC,"initialized",!1);const X8e=({onSignOut:e})=>{const[t,r]=y.useState("feed"),[n,a]=y.useState([]),[i,o]=y.useState(void 0),[l,c]=y.useState(void 0),[d,f]=y.useState(void 0),[u,h]=y.useState(!1),[m,v]=y.useState(!1),[g,x]=y.useState(0),{toast:_}=Er(),{user:w,session:b,loading:N,sessionExpired:S,signOut:k,resetSessionExpired:C}=ws(),{accountInfo:A}=hf();i_e(),y.useEffect(()=>{jl.restoreState();const Me=jl.subscribe(Te=>{if(Te.status==="completed"&&Te.serviceType){const Ve=Te.serviceType==="spotify"?"Spotify":"Apple Music";_({title:" Stats Ready!",description:`Your ${Ve} streaming stats have been synced and are ready to view.`,action:s.jsx(mz,{altText:"View stats",onClick:()=>{window.location.href="/streaming-stats",localStorage.setItem("intendedView","profile")},className:"",style:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},onMouseEnter:le=>{le.currentTarget.style.backgroundColor="var(--brand-pink-600)"},onMouseLeave:le=>{le.currentTarget.style.backgroundColor="var(--brand-pink-500)"},children:"View Stats"})}),setTimeout(()=>{jl.clearSync()},1e3)}else Te.status==="error"&&_({title:"Sync Error",description:`Failed to sync your ${Te.serviceType==="spotify"?"Spotify":"Apple Music"} stats: ${Te.error||"Unknown error"}`,variant:"destructive"})});return()=>{Me()}},[_]),y.useEffect(()=>{!N&&w&&E(void 0,null,function*(){if(!w)return;const Te=yield Iu.checkOnboardingStatus(w.id);Te&&(!Te.onboarding_completed&&!Te.onboarding_skipped?r("onboarding"):Te.onboarding_skipped&&!Te.onboarding_completed?h(!0):Te.onboarding_completed&&!Te.tour_completed&&t==="feed"&&setTimeout(()=>v(!0),1500))})},[w,N,t]),y.useEffect(()=>(!N&&w&&TC.initialize().catch(Me=>{console.error("Failed to initialize push notifications:",Me)}),()=>{w||TC.cleanup().catch(Me=>{console.error("Failed to cleanup push notifications:",Me)})}),[w,N]),y.useEffect(()=>{q();const Me=window.location.hash;Me==="#onboarding"?(r("onboarding"),window.history.replaceState(null,"",window.location.pathname)):Me==="#profile"&&(r("profile"),window.history.replaceState(null,"",window.location.pathname));const Te=localStorage.getItem("intendedView");Te&&["feed","search","profile","onboarding"].includes(Te)&&(r(Te),localStorage.removeItem("intendedView"));const Ve=De=>{(De.ctrlKey||De.metaKey)&&De.key==="l"&&(De.preventDefault(),I(!0))};window.addEventListener("keydown",Ve);const le=De=>{const nt=De.detail;nt!=null&&nt.userId&&(o(nt.userId),r("profile"))},Ke=De=>E(void 0,null,function*(){const nt=De.detail;if(nt!=null&&nt.event)localStorage.setItem("selectedEvent",JSON.stringify(nt.event)),r("feed");else if(nt!=null&&nt.eventId)try{const{data:ze,error:vt}=yield T.from("events").select("*").eq("id",nt.eventId).single();ze&&!vt&&(localStorage.setItem("selectedEvent",JSON.stringify(ze)),r("feed"))}catch(ze){console.error("Error fetching event:",ze)}});return window.addEventListener("open-user-profile",le),window.addEventListener("open-event-details",Ke),()=>{window.removeEventListener("keydown",Ve),window.removeEventListener("open-user-profile",le),window.removeEventListener("open-event-details",Ke)}},[]),y.useEffect(()=>{S&&(_({title:"Session Expired",description:"Your session has expired. Please sign in again.",variant:"destructive"}),r("feed"),I(!0))},[S,_]),y.useEffect(()=>{const Me=Te=>{var Ve,le;(le=(Ve=Te.detail)==null?void 0:Ve.message)!=null&&le.includes("Invalid API key")&&(I(!0),_({title:"Configuration Error",description:"Please check your Supabase configuration and sign in again.",variant:"destructive"}))};return window.addEventListener("api-error",Me),()=>window.removeEventListener("api-error",Me)},[_]);const[R,I]=y.useState(!1),[O,z]=y.useState(!1),[M,B]=y.useState(!1),[F,U]=y.useState(!1);B9(F);const H=()=>E(void 0,null,function*(){I(!1),C()}),q=()=>E(void 0,null,function*(){try{if(S||!w)return;const{data:Me,error:Te}=yield T.from("events").select("*").order("event_date",{ascending:!0});if(Te)throw Te;const Ve=(Me||[]).map(le=>({id:le.id,title:le.title||le.event_name||"Untitled Event",venue:le.venue||le.location||"Unknown Venue",date:le.event_date||le.date||new Date().toISOString().split("T")[0],time:le.event_time||le.time||"TBD",category:"music",description:le.description||"No description available",image:le.image||gA(le.id||le.title||le.event_name||"synth-event"),price:le.event_price||void 0,attendeeCount:Math.floor(Math.random()*100)+1}));a(Ve)}catch(Me){_({title:"Error",description:"Failed to load events",variant:"destructive"})}});y.useEffect(()=>{window.scrollTo(0,0)},[t]);const K=Me=>{r(Me),Me==="profile"?t==="profile"&&o(void 0):o(void 0),Me!=="chat"&&c(void 0)},Z=()=>{r("profile-edit")},ne=()=>{z(!0)},Y=()=>{r("profile")},X=()=>E(void 0,null,function*(){try{yield k(),I(!1),z(!1),_({title:"Signed out",description:"You've been successfully signed out."})}catch(Me){_({title:"Error",description:"Failed to sign out. Please try again.",variant:"destructive"})}}),se=()=>{window.history.length>1?window.history.back():(r("feed"),c(void 0))},de=()=>{r("notifications")},_e=Me=>E(void 0,null,function*(){var Te,Ve;try{const{data:le,error:Ke}=yield T.from("events").select("*, artists(name), venues(name)").eq("id",Me).single();if(Ke){console.error("Error fetching event:",Ke),_({title:"Error",description:"Failed to load event details",variant:"destructive"});return}if(le){const De=V(D({},le),{artist_name:((Te=le.artists)==null?void 0:Te.name)||null,venue_name:((Ve=le.venues)==null?void 0:Ve.name)||null});localStorage.setItem("selectedEvent",JSON.stringify(De)),r("feed"),window.dispatchEvent(new CustomEvent("open-event-details",{detail:{event:De}}))}}catch(le){console.error("Error navigating to event:",le),_({title:"Error",description:"Failed to load event",variant:"destructive"})}}),xe=Me=>{window.location.href=`/artist/${encodeURIComponent(Me)}`},Q=Me=>{window.location.href=`/venue/${encodeURIComponent(Me)}`},oe=(Me,Te)=>{r("profile"),Te?sessionStorage.setItem("profileTab",Te):sessionStorage.removeItem("profileTab"),o(Me)},ie=Me=>{Me.includes("-")&&Me.length===36?(f(Me),c(void 0)):(c(Me),f(void 0)),r("chat")},ee=()=>{U(!F)},G=()=>{U(!1)},J=()=>E(void 0,null,function*(){if(r("feed"),h(!1),w){const Me=yield Iu.checkOnboardingStatus(w.id);Me&&!Me.tour_completed&&setTimeout(()=>v(!0),1e3)}}),ae=()=>{v(!1)};if(N)return s.jsx(A1,{text:"Loading Synth..."});if(R||S||!(w!=null&&w.id))return s.jsx(L7,{onAuthSuccess:H});const fe=!1,we=()=>{switch(t){case"onboarding":return s.jsx(a_e,{onComplete:J});case"feed":return s.jsx(Z8e,{currentUserId:w.id,onNavigateToNotifications:de,onNavigateToProfile:oe,onNavigateToEvent:_e,onNavigateToArtist:xe,onNavigateToVenue:Q,onNavigateToChat:ie,onViewChange:K,menuOpen:F,onMenuClick:ee,refreshTrigger:g});case"search":return s.jsx(H8e,{currentUserId:w.id,onBack:se,onNavigateToProfile:oe,onNavigateToChat:ie,onNavigateToNotifications:de,onViewChange:K,menuOpen:F,onMenuClick:ee});case"profile":return s.jsx(Hge,{currentUserId:w.id,profileUserId:i,onBack:se,onEdit:Z,onSettings:ne,onSignOut:X,onNavigateToProfile:oe,onNavigateToChat:ie,onNavigateToNotifications:de,menuOpen:F,onMenuClick:ee,refreshTrigger:g});case"profile-edit":return s.jsx(Yge,{currentUserId:w.id,onBack:()=>r("profile"),onSave:Y});case"notifications":return s.jsx(dve,{currentUserId:w.id,onBack:se,onNavigateToProfile:oe,onNavigateToEvent:_e,onNavigateToArtist:xe,onNavigateToVenue:Q});case"chat":return s.jsx(Gq,{currentUserId:w.id,onBack:se,menuOpen:F,onMenuClick:ee,hideHeader:me});case"analytics":if(!A)return s.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"var(--neutral-50)"},children:s.jsx("div",{className:"text-center",children:s.jsx("p",{style:{color:"var(--neutral-600)"},children:"Loading account information..."})})});switch(console.log(" MainApp: Account info for analytics:",A),console.log(" MainApp: Account type:",A.account_type),A.account_type){case"creator":return console.log(" MainApp: Rendering CreatorAnalyticsDashboard"),s.jsx(X9e,{});case"business":return console.log(" MainApp: Rendering BusinessAnalyticsDashboard"),s.jsx(Q9e,{});case"admin":return console.log(" MainApp: Rendering AdminAnalyticsDashboard"),s.jsx(r8e,{});default:return console.log(" MainApp: Unknown account type, showing not available message"),s.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"var(--neutral-50)"},children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{style:{color:"var(--neutral-600)"},children:"Analytics not available for your account type."}),s.jsxs("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",marginTop:"var(--spacing-small, 12px)"},children:["Account type: ",A.account_type]})]})})}case"events":return s.jsx("div",{className:"min-h-screen p-6",style:{backgroundColor:"var(--neutral-50)"},children:s.jsx(fve,{})});default:return s.jsx(Cge,{currentUserId:w.id,onBack:se,onViewChange:K,onNavigateToNotifications:de,onNavigateToProfile:oe,onNavigateToChat:ie})}};if(t==="onboarding")return we();const ve=["feed","search","profile","chat"].includes(t),me=M;return s.jsxs("div",{className:"min-h-screen",style:{paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))",backgroundColor:"var(--neutral-50)"},children:[u&&!me&&s.jsx(gve,{onComplete:()=>r("onboarding")}),fe,s.jsx("div",{style:{paddingBottom:me?"0":"var(--spacing-bottom-nav, 112px)"},children:we()}),!me&&ve&&s.jsx(CM,{currentView:t,onViewChange:K,onOpenEventReview:()=>B(!0)}),!me&&!ve&&t!=="profile-edit"&&s.jsx(CM,{currentView:t,onViewChange:K,onOpenEventReview:()=>B(!0)}),s.jsx(z9,{isOpen:F,onClose:G,onToggle:ee,onNavigateToNotifications:de,onNavigateToProfile:oe,onNavigateToSettings:()=>z(!0),onNavigateToVerification:()=>{oe(void 0,"timeline")},onSignOut:X}),s.jsx(cve,{isOpen:O,onClose:()=>z(!1),onSignOut:X,userEmail:w==null?void 0:w.email}),(w==null?void 0:w.id)&&s.jsx(CB,{isOpen:M,onClose:()=>B(!1),event:{id:"new-review"},userId:w.id,onReviewSubmitted:()=>{B(!1),x(Me=>Me+1)}}),s.jsx(lxe,{run:m,onFinish:ae,onViewChange:K})]})},J8e=()=>(console.log(" App component is rendering..."),s.jsx(X8e,{}));function Q8e({}){const{artistId:e}=sT(),t=ts(),r=Vc(),{user:n}=ws(),[a,i]=y.useState([]),[o,l]=y.useState(""),[c,d]=y.useState(!0),[f,u]=y.useState(null),h=ae=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(ae),[m,v]=y.useState(null),[g,x]=y.useState(!1),[_,w]=y.useState({totalReviews:0,averageRating:0,loading:!0}),[b,N]=y.useState([]),[S,k]=y.useState(""),[C,A]=y.useState(""),[R,I]=y.useState(!1),[O,z]=y.useState("newest"),[M,B]=y.useState("all"),[F,U]=y.useState("date"),[H,q]=y.useState("asc"),[K,Z]=y.useState(null);y.useEffect(()=>{K&&o&&Rr(()=>E(this,null,function*(){const{trackInteraction:ae}=yield Promise.resolve().then(()=>Zy);return{trackInteraction:ae}}),void 0,import.meta.url).then(({trackInteraction:ae})=>{ae.view("artist",K,void 0,rA({id:K,name:o}),K)})},[K,o]);const ne=ae=>typeof ae.rating=="number"?ae.rating:0,Y=ae=>E(this,null,function*(){try{let fe=null,we=ae?decodeURIComponent(ae):"",ve=null;if(ae&&h(ae)){fe=ae,Z(ae);const{data:Ue}=yield T.from("artists").select("id, name, image_url").eq("id",fe).maybeSingle();if(Ue)Z(Ue.id),ve={name:Ue.name,image_url:Ue.image_url},l(Ue.name),Ue.image_url&&A(Ue.image_url);else{const{data:gt}=yield T.from("events").select("artist_name, artist_id").eq("artist_id",fe).limit(1).maybeSingle();if(gt!=null&&gt.artist_name)l(gt.artist_name);else{const{data:Ce}=yield T.from("artists_with_external_ids").select("name").eq("id",fe).limit(1).maybeSingle();Ce!=null&&Ce.name&&l(Ce.name)}}}else{const{data:Ue}=yield T.from("artists").select("id, name, image_url").ilike("name",`%${we}%`).limit(1).maybeSingle();Ue?(fe=Ue.id,Z(Ue.id),ve={name:Ue.name,image_url:Ue.image_url},l(Ue.name),Ue.image_url&&A(Ue.image_url)):l(we)}let me=[];if(fe){const{data:Ue,error:gt}=yield T.from("events").select("id").eq("artist_id",fe).limit(1e3);!gt&&Ue&&(me=Ue)}if(me.length===0&&we){const{data:Ue,error:gt}=yield T.from("events").select("id").ilike("artist_name",`${we}%`).limit(500);!gt&&Ue&&(me=Ue)}if(me.length===0&&we){const{data:Ue,error:gt}=yield T.from("events").select("id").ilike("artist_name",`%${we}%`).limit(500);if(gt){console.error("Error fetching event IDs for artist:",gt);return}Ue&&(me=Ue)}const Me=me.map(Ue=>Ue.id);if(Me.length===0){if(!C&&o&&!(ve!=null&&ve.image_url)){const{data:Ue}=yield T.from("artists").select("id, name, identifier, image_url").ilike("name",o).maybeSingle();Ue!=null&&Ue.image_url&&A(Ue.image_url)}w({totalReviews:0,averageRating:0,loading:!1}),N([]);return}const{data:Te,error:Ve}=yield T.from("reviews").select(`
          id,
          user_id,
          event_id,
          rating,
          review_text,
          created_at,
          mood_tags,
          genre_tags,
          photos
        `).eq("is_public",!0).eq("is_draft",!1).in("event_id",Me);if(Ve){console.error("Error fetching artist reviews:",Ve);return}const le=(Te==null?void 0:Te.map(Ue=>Ue.event_id).filter(Boolean))||[],Ke=new Map,De=new Map;if(le.length>0){const{data:Ue}=yield T.from("events").select("id, venue_name, event_date, title, artist_id").in("id",le),gt=[...new Set((Ue==null?void 0:Ue.map(Ce=>Ce.artist_id).filter(Boolean))||[])];if(gt.length>0){const{data:Ce}=yield T.from("artists").select("id, name").in("id",gt);Ce==null||Ce.forEach(Ge=>De.set(Ge.id,Ge.name))}Ue&&Ue.forEach(Ce=>{Ke.set(Ce.id,Ce)})}const nt=(Te==null?void 0:Te.map(Ue=>Ue.user_id).filter(Boolean))||[],{data:ze}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",nt),vt=(Te==null?void 0:Te.map(Ue=>{const gt=ze==null?void 0:ze.find(Nt=>Nt.user_id===Ue.user_id),Ce=Ke.get(Ue.event_id),Ge=Ce!=null&&Ce.artist_id?De.get(Ce.artist_id):"";return{id:Ue.id,user_id:Ue.user_id,event_id:Ue.event_id,rating:Ue.rating,review_text:Ue.review_text,created_at:Ue.created_at,reviewer_name:(gt==null?void 0:gt.name)||"Anonymous",reviewer_avatar:(gt==null?void 0:gt.avatar_url)||null,event_title:(Ce==null?void 0:Ce.title)||"",event_date:(Ce==null?void 0:Ce.event_date)||"",venue_name:(Ce==null?void 0:Ce.venue_name)||"",artist_name:Ge||"",mood_tags:Ue.mood_tags||[],genre_tags:Ue.genre_tags||[],photos:Ue.photos||[],category_average:ne(Ue)}}))||[],rr=vt.map(Ue=>{var gt;return(gt=Ue.category_average)!=null?gt:ne(Ue)}).filter(Ue=>typeof Ue=="number"&&Ue>0),sr=rr.length,Ae=sr>0?rr.reduce((Ue,gt)=>Ue+gt,0)/sr:0;if(w({totalReviews:sr,averageRating:Ae,loading:!1}),N(vt),!C&&o&&!(ve!=null&&ve.image_url)){const{data:Ue}=yield T.from("artists").select("id, name, identifier, image_url").ilike("name",o).maybeSingle();Ue&&(k(""),Ue.image_url&&A(Ue.image_url))}else k("");if(!C&&o&&!(ve!=null&&ve.image_url)){const{data:Ue}=yield T.from("artists").select("id, name, identifier, image_url").eq("name",o).maybeSingle();Ue!=null&&Ue.image_url&&A(Ue.image_url)}}catch(fe){console.error("Error fetching artist profile:",fe),w(we=>V(D({},we),{loading:!1}))}});y.useEffect(()=>{if(!e){u("No artist ID provided"),d(!1);return}se()},[e]),y.useEffect(()=>{e&&Y(e)},[e]);const X=e?decodeURIComponent(e):"",se=()=>E(this,null,function*(){try{d(!0),u(null);const ae=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(X);let fe=X,we=X;if(ae){const{data:ze,error:vt}=yield T.from("artists").select("id, name, image_url, jambase_artist_id").eq("id",X).maybeSingle();!vt&&ze?(ze.jambase_artist_id&&(we=ze.jambase_artist_id),ze.name&&(fe=ze.name),console.log(" Found artist from UUID:",{name:fe,jambaseId:we}),ze.image_url&&A(ze.image_url)):console.warn(" Could not find artist by UUID, will try to use as JamBase ID")}let ve=null,me=null;if(ae){const ze=yield T.from("events").select("*").eq("artist_id",X).order("event_date",{ascending:!0});ve=ze.data,me=ze.error}if(!ve||ve.length===0){const{data:ze,error:vt}=yield T.from("artists").select("id, name").ilike("name",fe).maybeSingle();if(!vt&&(ze!=null&&ze.id)){const{data:rr,error:sr}=yield T.from("events").select("*").eq("artist_id",ze.id).order("event_date",{ascending:!0});!sr&&rr&&rr.length>0?(ve=rr,me=null,fe=ze.name):ve||(ve=rr||[],me=sr)}else ve||(ve=[],me=null)}if(me)throw me;if(ae&&X&&!fe){const{data:ze}=yield T.from("artists").select("name").eq("id",X).maybeSingle();ze!=null&&ze.name&&(fe=ze.name)}const Me=[...new Set((ve||[]).map(ze=>ze.artist_id).filter(Boolean))],Te=new Map;if(Me.length>0){const{data:ze}=yield T.from("artists").select("id, name").in("id",Me);ze==null||ze.forEach(vt=>Te.set(vt.id,vt.name))}const le=[...(ve||[]).map(ze=>V(D({},ze),{artist_name:Te.get(ze.artist_id)||fe||"",source:ze.source||"jambase"}))],Ke=de(le);Ke.sort((ze,vt)=>new Date(ze.event_date).getTime()-new Date(vt.event_date).getTime()),i(Ke);let De=fe;if((!De||De===X)&&ae&&X){const{data:ze}=yield T.from("artists").select("name").eq("id",X).maybeSingle();ze!=null&&ze.name&&(De=ze.name)}if((!De||De===X||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(De))&&X){const{data:ze}=yield T.from("events").select("artist_name, artist_id").or(`artist_id.eq.${X},artist_name.ilike.%${X}%`).limit(1).maybeSingle();if(ze!=null&&ze.artist_name)De=ze.artist_name;else if(ae&&X){const{data:vt}=yield T.from("artists_with_external_ids").select("name").eq("id",X).limit(1).maybeSingle();vt!=null&&vt.name&&(De=vt.name)}}De&&De!==X&&!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(De)?l(De):X&&!ae&&l(X);let nt=!1;if(ae&&X){const{data:ze}=yield T.from("artists").select("id, name, image_url, jambase_artist_id").eq("id",X).maybeSingle();ze!=null&&ze.image_url&&(A(ze.image_url),nt=!0)}if(!nt&&De){const{data:ze}=yield T.from("artists").select("id, name, image_url, jambase_artist_id").ilike("name",De).maybeSingle();ze!=null&&ze.image_url&&A(ze.image_url)}}catch(ae){console.error("Error fetching artist events:",ae),u("Failed to load artist events")}finally{d(!1)}}),de=ae=>{const fe=new Map;return ae.filter(we=>{var le;const me=(we.artist_name||"").toLowerCase().trim(),Me=(we.venue_name||"").toLowerCase().replace(/\s+/g," ").replace(/\bthe\s+/gi,"").replace(/[^\w\s]/g,"").trim(),Te=((le=we.event_date)==null?void 0:le.split("T")[0])||"",Ve=`${me}|${Me}|${Te}`;return fe.has(Ve)?!1:(fe.set(Ve,we),!0)})},_e=ae=>{const fe=[],we=Math.floor(ae),ve=ae%1>=.5;for(let Me=0;Me<we;Me++)fe.push(s.jsx(Xt,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},Me));ve&&fe.push(s.jsx(Xt,{className:"w-4 h-4 fill-yellow-400/50 text-yellow-400"},"half"));const me=5-Math.ceil(ae);for(let Me=0;Me<me;Me++)fe.push(s.jsx(Xt,{className:"w-4 h-4 text-gray-300"},`empty-${Me}`));return fe},xe=(ae,fe)=>{const we=[...ae];switch(fe){case"newest":return we.sort((ve,me)=>new Date(me.created_at).getTime()-new Date(ve.created_at).getTime());case"oldest":return we.sort((ve,me)=>new Date(ve.created_at).getTime()-new Date(me.created_at).getTime());case"highest_rating":return we.sort((ve,me)=>{var Ve,le;const Me=(Ve=ve.category_average)!=null?Ve:ne(ve);return(((le=me.category_average)!=null?le:ne(me))||0)-(Me||0)});case"lowest_rating":return we.sort((ve,me)=>{var Ve,le;const Me=(Ve=ve.category_average)!=null?Ve:ne(ve),Te=(le=me.category_average)!=null?le:ne(me);return(Me||0)-(Te||0)});default:return we}},Q=(ae,fe)=>{if(fe==="all")return ae;const we=parseInt(fe.split("_")[0]);return ae.filter(ve=>{var Me;const me=(Me=ve.category_average)!=null?Me:ne(ve);return Math.floor(me)===we})},oe=ae=>new Date(ae).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),ie=ae=>new Date(ae)>=new Date,ee=ae=>{v(ae),x(!0)};if(c)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading artist events..."})]})})})});if(f)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:f}),s.jsxs(ce,{onClick:()=>t(-1),children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})})})});const J=((ae,fe)=>[...ae].sort((we,ve)=>{var Me,Te;let me=0;switch(fe){case"date":me=new Date(we.event_date).getTime()-new Date(ve.event_date).getTime();break;case"location":const Ve=`${we.venue_city||""}, ${we.venue_state||""}`.trim(),le=`${ve.venue_city||""}, ${ve.venue_state||""}`.trim();me=Ve.localeCompare(le);break;case"price":const Ke=parseFloat(((Me=we.price_range)==null?void 0:Me.replace(/[^0-9.]/g,""))||"0"),De=parseFloat(((Te=ve.price_range)==null?void 0:Te.replace(/[^0-9.]/g,""))||"0");me=Ke-De;break}return H==="asc"?me:-me}))(a.filter(ae=>ie(ae.event_date)),F);return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50 overflow-x-hidden w-full max-w-full",children:[s.jsxs("div",{className:"container mx-auto px-4 py-8 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs(ce,{variant:"ghost",onClick:()=>{var fe;const ae=(fe=r.state)==null?void 0:fe.eventId;ae&&localStorage.setItem("reopenEventId",ae),window.history.length>1?t(-1):t("/")},className:"mb-4 hover-button",children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex-shrink-0",children:s.jsx(Ft,{className:"w-6 h-6 text-white"})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("h1",{className:"text-2xl font-bold gradient-text break-words truncate",children:o||(e?decodeURIComponent(e):"Artist")})}),(n==null?void 0:n.id)&&s.jsx(n0,{artistName:o,userId:n.id,variant:"outline",size:"sm",showFollowerCount:!1,className:"flex-shrink-0"})]}),o&&s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsxs(ce,{variant:"outline",onClick:()=>window.open(`https://open.spotify.com/search/${encodeURIComponent(o)}`,"_blank"),style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},className:"flex items-center gap-1.5",children:[s.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:"#1DB954",borderRadius:"var(--radius-corner, 10px)",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx("span",{style:{color:"white",fontSize:"10px",fontWeight:"bold"},children:""})}),s.jsx("span",{children:"Spotify"})]}),s.jsxs(ce,{variant:"outline",onClick:()=>window.open(`https://music.apple.com/search?term=${encodeURIComponent(o)}`,"_blank"),style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},className:"flex items-center gap-1.5",children:[s.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:"#000000",borderRadius:"var(--radius-corner, 10px)",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx("span",{style:{color:"white",fontSize:"10px",fontWeight:"bold"},children:""})}),s.jsx("span",{children:"Apple Music"})]}),s.jsx("span",{className:"text-xs text-muted-foreground ml-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:"All events for this artist"})]}),s.jsx("div",{className:"flex items-center gap-2 text-sm",children:s.jsxs("div",{style:{height:"25px",borderRadius:"999px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--brand-pink-050)",color:"var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[J.length," Upcoming"]})})]}),s.jsxs("div",{className:"mb-8 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx(Ze,{children:s.jsxs(tt,{className:"p-3 text-center",children:[s.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:_e(_.averageRating)}),s.jsx("div",{className:"text-xl font-bold text-gray-900",children:_.averageRating.toFixed(1)}),s.jsx("div",{className:"text-xs text-gray-600",children:"Average Rating"})]})}),s.jsx(Ze,{children:s.jsxs(tt,{className:"p-3 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-gray-900",children:_.totalReviews}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Reviews"})]})}),s.jsx(Ze,{children:s.jsxs(tt,{className:"p-3 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-pink-600",children:J.length}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Events"})]})})]}),S&&s.jsx(Ze,{children:s.jsxs(tt,{className:"p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["About ",o]}),s.jsx("p",{className:"text-gray-700 leading-relaxed",children:S})]})}),_.totalReviews>0&&s.jsx(Ze,{children:s.jsxs(tt,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"w-5 h-5 text-yellow-500"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Reviews"})]}),s.jsxs(ce,{variant:"ghost",onClick:()=>I(!R),className:"flex items-center gap-1",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[R?s.jsx(Lo,{size:16}):s.jsx(Aa,{size:16}),R?"Hide":"View"," Reviews"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[_e(_.averageRating),s.jsx("span",{className:"text-sm font-medium",children:_.averageRating.toFixed(1)}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",_.totalReviews," review",_.totalReviews!==1?"s":"",")"]})]}),R&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(qy,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Filter by rating:"}),s.jsxs(aa,{value:M,onValueChange:ae=>B(ae),children:[s.jsx(Gs,{className:"w-32",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",borderRadius:"var(--radius-corner, 10px)"},onMouseEnter:ae=>{ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:ae=>{ae.currentTarget.style.borderColor="var(--neutral-200)"},onFocus:ae=>{ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onBlur:ae=>{ae.currentTarget.style.borderColor="var(--neutral-200)"},children:s.jsx(ia,{})}),s.jsxs(Ys,{children:[s.jsx(Bt,{value:"all",children:"All Ratings"}),s.jsx(Bt,{value:"5_star",children:"5 Stars"}),s.jsx(Bt,{value:"4_star",children:"4 Stars"}),s.jsx(Bt,{value:"3_star",children:"3 Stars"}),s.jsx(Bt,{value:"2_star",children:"2 Stars"}),s.jsx(Bt,{value:"1_star",children:"1 Star"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),s.jsxs(aa,{value:O,onValueChange:ae=>z(ae),children:[s.jsx(Gs,{className:"w-40",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",borderRadius:"var(--radius-corner, 10px)"},onMouseEnter:ae=>{ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:ae=>{ae.currentTarget.style.borderColor="var(--neutral-200)"},onFocus:ae=>{ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onBlur:ae=>{ae.currentTarget.style.borderColor="var(--neutral-200)"},children:s.jsx(ia,{})}),s.jsxs(Ys,{children:[s.jsx(Bt,{value:"newest",children:"Newest"}),s.jsx(Bt,{value:"oldest",children:"Oldest"}),s.jsx(Bt,{value:"highest_rating",children:"Highest Rating"}),s.jsx(Bt,{value:"lowest_rating",children:"Lowest Rating"})]})]})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:xe(Q(b,M),O).map(ae=>{var fe,we;return s.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs(Wr,{className:"w-8 h-8",children:[s.jsx(Qr,{src:ae.reviewer_avatar||void 0}),s.jsx(Hr,{className:"text-xs",children:ae.reviewer_name.charAt(0).toUpperCase()})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-sm",children:ae.reviewer_name}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(Lt,{className:"w-3 h-3"}),oe(ae.event_date)]}),ae.venue_name&&s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx(yr,{className:"w-3 h-3"}),ae.venue_name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[_e((fe=ae.category_average)!=null?fe:ne(ae)),s.jsx("span",{className:"text-sm font-medium ml-1",children:((we=ae.category_average)!=null?we:ne(ae)).toFixed(1)})]})]}),ae.review_text&&s.jsx("p",{className:"text-sm text-gray-700",children:ae.review_text}),ae.mood_tags&&ae.mood_tags.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:ae.mood_tags.map((ve,me)=>s.jsx("div",{style:{height:"25px",borderRadius:"999px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--neutral-100)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:ve},me))})]},ae.id)})})]})]})})]}),J.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-2xl font-semibold gradient-text",children:"Upcoming Events"}),s.jsxs(aa,{value:F,onValueChange:ae=>U(ae),children:[s.jsx(Gs,{className:"w-24 h-8 text-xs",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",borderRadius:"var(--radius-corner, 10px)"},onMouseEnter:ae=>{ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:ae=>{ae.currentTarget.style.borderColor="var(--neutral-200)"},onFocus:ae=>{ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onBlur:ae=>{ae.currentTarget.style.borderColor="var(--neutral-200)"},children:s.jsx(ia,{})}),s.jsxs(Ys,{children:[s.jsx(Bt,{value:"date",children:"Date"}),s.jsx(Bt,{value:"location",children:"Location"}),s.jsx(Bt,{value:"price",children:"Price"})]})]})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 w-full",children:J.map(ae=>s.jsx(sA,{event:{id:ae.id||"",title:ae.title||"Event",event_date:ae.event_date,venue_name:ae.venue_name,venue_city:ae.venue_city,venue_state:ae.venue_state,doors_time:ae.doors_time,price_range:ae.price_range,ticket_urls:ae.ticket_urls,ticket_available:ae.ticket_available,genres:ae.genres},onClick:()=>ee(ae)},ae.id))})]}),a.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ft,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Events Found"}),s.jsxs("p",{className:"text-muted-foreground mb-4",children:["No events found for ",o||"this artist","."]}),s.jsxs(ce,{onClick:()=>t(-1),children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})]}),s.jsx(Hl,{event:m,currentUserId:(n==null?void 0:n.id)||"",isOpen:g,onClose:()=>{x(!1),v(null)}})]})}delete nU.Icon.Default.prototype._getIconUrl;nU.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});function eBe({}){const{venueId:e}=sT(),t=ts(),r=Vc(),{user:n}=ws(),[a,i]=y.useState([]),[o,l]=y.useState(""),[c,d]=y.useState(""),[f,u]=y.useState(!0),[h,m]=y.useState(null),[v,g]=y.useState(null),[x,_]=y.useState(!1),[w,b]=y.useState({totalReviews:0,averageRating:0,loading:!0}),[N,S]=y.useState([]),[k,C]=y.useState(""),[A,R]=y.useState(""),[I,O]=y.useState(""),[z,M]=y.useState(""),[B,F]=y.useState(""),[U,H]=y.useState(""),[q,K]=y.useState(null),[Z,ne]=y.useState(""),[Y,X]=y.useState(!1),[se,de]=y.useState("newest"),[_e,xe]=y.useState("all"),[Q,oe]=y.useState(null),[ie,ee]=y.useState("date"),[G,J]=y.useState("asc"),[ae,fe]=y.useState(null);y.useEffect(()=>{ae&&o&&Zt.view("venue",ae,void 0,nA({id:ae,name:o,city:A,state:I}),ae)},[ae,o,A,I]);const we=Ae=>typeof Ae.rating=="number"?Ae.rating:0,ve=Ae=>E(this,null,function*(){var Ue;try{const{data:gt,error:Ce}=yield T.from("reviews").select(`
          id,
          user_id,
          event_id,
          rating,
          venue_rating,
          artist_performance_rating,
          production_rating,
          location_rating,
          value_rating,
          artist_performance_feedback,
          production_feedback,
          venue_feedback,
          location_feedback,
          value_feedback,
          ticket_price_paid,
          review_text,
          created_at,
          mood_tags,
          genre_tags,
          photos,
          was_there,
          is_public,
          is_draft
        `).eq("is_public",!0).eq("is_draft",!1).not("review_text","is",null).neq("review_text","ATTENDANCE_ONLY");if(Ce){console.error("Error fetching venue reviews:",Ce);return}const Ge=(gt==null?void 0:gt.map(Fe=>Fe.event_id).filter(Boolean))||[],Nt=new Map;if(Ge.length>0){const{data:Fe}=yield T.from("events").select("id, venue_uuid, artist_name, event_date, title, venue_city, venue_state").in("id",Ge);if(Fe){const ft=Fe.map(hr=>hr.venue_uuid).filter(Boolean);let Et=new Map;if(ft.length>0){const{data:hr}=yield T.from("venues").select("id, name").in("id",ft);hr==null||hr.forEach(dr=>{Et.set(dr.id,dr.name)})}Fe.forEach(hr=>{const dr=hr.venue_uuid?Et.get(hr.venue_uuid):null;Nt.set(hr.id,V(D({},hr),{venue_name:dr}))})}}const Tt=(gt||[]).filter(Fe=>{var Et;const ft=Nt.get(Fe.event_id);return ft&&((Et=ft.venue_name)==null?void 0:Et.toLowerCase().includes(Ae.toLowerCase()))}),at=(Tt==null?void 0:Tt.map(Fe=>Fe.user_id).filter(Boolean))||[],{data:ue}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",at),qe=(Tt==null?void 0:Tt.map(Fe=>{const ft=ue==null?void 0:ue.find(hr=>hr.user_id===Fe.user_id),Et=Nt.get(Fe.event_id);return{id:Fe.id,rating:Fe.rating,venue_rating:Fe.venue_rating,artist_performance_rating:Fe.artist_performance_rating,production_rating:Fe.production_rating,location_rating:Fe.location_rating,value_rating:Fe.value_rating,artist_performance_feedback:Fe.artist_performance_feedback,production_feedback:Fe.production_feedback,venue_feedback:Fe.venue_feedback,location_feedback:Fe.location_feedback,value_feedback:Fe.value_feedback,ticket_price_paid:Fe.ticket_price_paid,review_text:Fe.review_text,created_at:Fe.created_at,reviewer_name:(ft==null?void 0:ft.name)||"Anonymous",reviewer_avatar:(ft==null?void 0:ft.avatar_url)||null,event_title:(Et==null?void 0:Et.title)||"",event_date:(Et==null?void 0:Et.event_date)||"",artist_name:(Et==null?void 0:Et.artist_name)||"",mood_tags:Fe.mood_tags||[],genre_tags:Fe.genre_tags||[],photos:Array.isArray(Fe.photos)?Fe.photos:[],category_average:Fe.rating}}))||[],Ct=qe.map(Fe=>{var ft;return(ft=Fe.rating)!=null?ft:null}).filter(Fe=>typeof Fe=="number"&&Fe>0),ct=Ct.length,pt=ct>0?Ct.reduce((Fe,ft)=>Fe+ft,0)/ct:0;b({totalReviews:ct,averageRating:pt,loading:!1}),S(qe);let At=null;if(Ae)try{const{data:Fe,error:ft}=yield T.from("venues").select("id, name, url, image_url").ilike("name",`%${Ae}%`).limit(1).maybeSingle();!ft&&Fe?At=Fe:ft&&console.debug("Venue query failed (non-critical):",ft.message||ft)}catch(Fe){console.debug("Venue query exception (non-critical):",(Fe==null?void 0:Fe.message)||Fe)}At?(console.log(" Venue data found:",At),C(At.address||""),R(At.city||""),O(At.state||""),M(At.zip||""),F(""),H(At.url||""),K(null),ne(At.image_url||"")):(console.log(" No venue data found in database for:",Ae),Ae.toLowerCase().includes("masquerade")&&(C("695 North Ave NE"),R("Atlanta"),O("GA"),M("30308")));let yt="";if(At!=null&&At.address&&(At!=null&&At.city)&&(At!=null&&At.state))yt=`${At.address}, ${At.city}, ${At.state}${At.zip?` ${At.zip}`:""}`;else if(a.length>0){const Fe=a[0];Fe.venue_city&&Fe.venue_state&&(yt=`${Ae}, ${Fe.venue_city}, ${Fe.venue_state}`)}if(yt)try{if(yt.toLowerCase().includes("atlanta"))console.log(" Setting Atlanta coordinates for venue:",Ae),oe({lat:33.749,lng:-84.388});else{const Fe=(Ue=yt.split(",")[1])==null?void 0:Ue.trim().toLowerCase();if(Fe){const ft=Ua.searchCity(Fe);ft&&oe({lat:ft.lat,lng:ft.lng})}}}catch(Fe){console.error("Error getting venue coordinates:",Fe)}}catch(gt){console.error("Error fetching venue profile:",gt),b(Ce=>V(D({},Ce),{loading:!1}))}});y.useEffect(()=>{if(!e){m("No venue ID provided"),u(!1);return}Te()},[e]),y.useEffect(()=>{o&&ve(o)},[o]),y.useEffect(()=>{E(this,null,function*(){if(!Q&&a.length>0&&o){const Ue=a[0];if(Ue.venue_city&&Ue.venue_state){const gt=`${o}, ${Ue.venue_city}, ${Ue.venue_state}`;try{if(gt.toLowerCase().includes("atlanta"))console.log(" Setting Atlanta coordinates from events for venue:",o),oe({lat:33.749,lng:-84.388});else{const Ce=Ue.venue_city.toLowerCase(),Ge=Ua.searchCity(Ce);Ge&&oe({lat:Ge.lat,lng:Ge.lng})}}catch(Ce){console.error("Error getting coordinates from events:",Ce)}}}})},[a,o,Q]);const me=e?decodeURIComponent(e):"",Me=Ae=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(Ae),Te=()=>E(this,null,function*(){try{u(!0),m(null);let Ae=null,Ue=null,gt=me,Ce="Location TBD",Ge=null;if(e&&Me(e)){Ge=e;const{data:ue}=yield T.from("venues").select("id, name, state, street_address").eq("id",Ge).maybeSingle();if(ue){gt=ue.name;const qe=[ue.street_address,ue.state].filter(Boolean);Ce=qe.length>0?qe.join(", "):"Location TBD"}}else{let ue=null;const{data:qe}=yield T.from("venues").select("id, name, state, street_address").ilike("name",`%${me}%`).limit(5);if(qe&&qe.length>0&&(ue=qe.find(ct=>ct.name.toLowerCase()===me.toLowerCase())||qe[0]),ue){Ge=ue.id,fe(ue.id),gt=ue.name;const Ct=[ue.street_address,ue.state].filter(Boolean);Ce=Ct.length>0?Ct.join(", "):"Location TBD"}}if(Ge){const ue=yield T.from("events").select("*").eq("venue_id",Ge).order("event_date",{ascending:!0});Ae=ue.data,Ue=ue.error}else Ae=[],Ue=null,console.warn(`Venue not found: ${me}`);if(Ue)throw Ue;d(Ce);const Tt=[...(Ae||[]).map(ue=>V(D({},ue),{source:"manual"}))],at=Ve(Tt);if(at.sort((ue,qe)=>new Date(ue.event_date).getTime()-new Date(qe.event_date).getTime()),i(at),l(gt||me||"Unknown Venue"),at.length>0){const ue=at[0],qe=[ue.venue_city,ue.venue_state].filter(Boolean);d(qe.length>0?qe.join(", "):"Location TBD")}}catch(Ae){console.error("Error fetching venue events:",Ae),m("Failed to load venue events")}finally{u(!1)}}),Ve=Ae=>{const Ue=new Map;return Ae.filter(gt=>{var ue;const Ce=(gt.artist_name||"").toLowerCase().trim(),Nt=(gt.venue_name||`${gt.venue_city||""} ${gt.venue_state||""}`.trim()||gt.venue_uuid||"").toLowerCase().replace(/\s+/g," ").replace(/\bthe\s+/gi,"").replace(/[^\w\s]/g,"").trim(),Tt=((ue=gt.event_date)==null?void 0:ue.split("T")[0])||"",at=`${Ce}|${Nt}|${Tt}`;return Ue.has(at)?(Ue.get(at),!1):(Ue.set(at,gt),!0)})},le=Ae=>{const Ue=[],gt=Math.floor(Ae),Ce=Ae%1>=.5;for(let Nt=0;Nt<gt;Nt++)Ue.push(s.jsx(Xt,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},Nt));Ce&&Ue.push(s.jsx(Xt,{className:"w-4 h-4 fill-yellow-400/50 text-yellow-400"},"half"));const Ge=5-Math.ceil(Ae);for(let Nt=0;Nt<Ge;Nt++)Ue.push(s.jsx(Xt,{className:"w-4 h-4 text-gray-300"},`empty-${Nt}`));return Ue},Ke=(Ae,Ue)=>{const gt=[...Ae];switch(Ue){case"newest":return gt.sort((Ce,Ge)=>new Date(Ge.created_at).getTime()-new Date(Ce.created_at).getTime());case"oldest":return gt.sort((Ce,Ge)=>new Date(Ce.created_at).getTime()-new Date(Ge.created_at).getTime());case"highest_rating":return gt.sort((Ce,Ge)=>{var Nt,Tt,at,ue;return((Tt=(Nt=Ge.venue_rating)!=null?Nt:Ge.rating)!=null?Tt:0)-((ue=(at=Ce.venue_rating)!=null?at:Ce.rating)!=null?ue:0)});case"lowest_rating":return gt.sort((Ce,Ge)=>{var Nt,Tt,at,ue;return((Tt=(Nt=Ce.venue_rating)!=null?Nt:Ce.rating)!=null?Tt:0)-((ue=(at=Ge.venue_rating)!=null?at:Ge.rating)!=null?ue:0)});default:return gt}},De=(Ae,Ue)=>{if(Ue==="all")return Ae;const gt=parseInt(Ue.split("_")[0],10);return Ae.filter(Ce=>{var Nt,Tt;const Ge=(Tt=(Nt=Ce.venue_rating)!=null?Nt:Ce.rating)!=null?Tt:0;return Math.floor(Ge)===gt})},nt=Ae=>new Date(Ae).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),ze=Ae=>new Date(Ae)>=new Date,vt=Ae=>{g(Ae),_(!0)};if(f)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading venue events..."})]})})})});if(h)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:h}),s.jsxs(ce,{onClick:()=>t(-1),children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})})})});const sr=((Ae,Ue)=>[...Ae].sort((gt,Ce)=>{var Nt,Tt;let Ge=0;switch(Ue){case"date":Ge=new Date(gt.event_date).getTime()-new Date(Ce.event_date).getTime();break;case"artist":Ge=(gt.artist_name||"").localeCompare(Ce.artist_name||"");break;case"price":const at=parseFloat(((Nt=gt.price_range)==null?void 0:Nt.replace(/[^0-9.]/g,""))||"0"),ue=parseFloat(((Tt=Ce.price_range)==null?void 0:Tt.replace(/[^0-9.]/g,""))||"0");Ge=at-ue;break}return G==="asc"?Ge:-Ge}))(a.filter(Ae=>ze(Ae.event_date)),ie);return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50 overflow-x-hidden w-full max-w-full",children:[s.jsxs("div",{className:"container mx-auto px-4 py-8 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs(ce,{variant:"ghost",onClick:()=>{var Ue;const Ae=(Ue=r.state)==null?void 0:Ue.eventId;Ae&&localStorage.setItem("reopenEventId",Ae),window.history.length>1?t(-1):t("/")},className:"mb-4 hover-button",children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex-shrink-0",children:s.jsx(Io,{className:"w-6 h-6 text-white"})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("h1",{className:"text-2xl font-bold gradient-text break-words truncate",children:o||"Unknown Venue"})}),(n==null?void 0:n.id)&&o&&s.jsx(k1,{venueName:o,venueCity:A,venueState:I,userId:n.id,variant:"outline",size:"sm",showFollowerCount:!1,className:"flex-shrink-0"})]}),c&&s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("span",{className:"text-xs text-muted-foreground",children:"All events at this venue"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:""}),s.jsx("span",{className:"text-xs text-muted-foreground",children:c})]}),s.jsx("div",{className:"flex items-center gap-2 text-sm",children:s.jsxs("div",{style:{height:"25px",borderRadius:"999px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--brand-pink-050)",color:"var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[sr.length," Upcoming"]})})]}),s.jsxs("div",{className:"mb-8 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx(Ze,{children:s.jsxs(tt,{className:"p-3 text-center",children:[s.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:le(w.averageRating)}),s.jsx("div",{className:"text-xl font-bold text-gray-900",children:w.averageRating.toFixed(1)}),s.jsx("div",{className:"text-xs text-gray-600",children:"Average Rating"})]})}),s.jsx(Ze,{children:s.jsxs(tt,{className:"p-3 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-gray-900",children:w.totalReviews}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Reviews"})]})}),s.jsx(Ze,{children:s.jsxs(tt,{className:"p-3 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-pink-600",children:sr.length}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Events"})]})})]}),w.totalReviews>0&&s.jsx(Ze,{children:s.jsxs(tt,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"w-5 h-5 text-yellow-500"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Reviews"})]}),s.jsxs(ce,{variant:"ghost",onClick:()=>X(!Y),className:"flex items-center gap-1",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[Y?s.jsx(Lo,{size:16}):s.jsx(Aa,{size:16}),Y?"Hide":"View"," Reviews"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[le(w.averageRating),s.jsx("span",{className:"text-sm font-medium",children:w.averageRating.toFixed(1)}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",w.totalReviews," review",w.totalReviews!==1?"s":"",")"]})]}),Y&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(qy,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Filter by rating:"}),s.jsxs(aa,{value:_e,onValueChange:Ae=>xe(Ae),children:[s.jsx(Gs,{className:"w-32",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",borderRadius:"var(--radius-corner, 10px)"},onMouseEnter:Ae=>{Ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:Ae=>{Ae.currentTarget.style.borderColor="var(--neutral-200)"},onFocus:Ae=>{Ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onBlur:Ae=>{Ae.currentTarget.style.borderColor="var(--neutral-200)"},children:s.jsx(ia,{})}),s.jsxs(Ys,{children:[s.jsx(Bt,{value:"all",children:"All Ratings"}),s.jsx(Bt,{value:"5_star",children:"5 Stars"}),s.jsx(Bt,{value:"4_star",children:"4 Stars"}),s.jsx(Bt,{value:"3_star",children:"3 Stars"}),s.jsx(Bt,{value:"2_star",children:"2 Stars"}),s.jsx(Bt,{value:"1_star",children:"1 Star"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),s.jsxs(aa,{value:se,onValueChange:Ae=>de(Ae),children:[s.jsx(Gs,{className:"w-40",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",borderRadius:"var(--radius-corner, 10px)"},onMouseEnter:Ae=>{Ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:Ae=>{Ae.currentTarget.style.borderColor="var(--neutral-200)"},onFocus:Ae=>{Ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onBlur:Ae=>{Ae.currentTarget.style.borderColor="var(--neutral-200)"},children:s.jsx(ia,{})}),s.jsxs(Ys,{children:[s.jsx(Bt,{value:"newest",children:"Newest"}),s.jsx(Bt,{value:"oldest",children:"Oldest"}),s.jsx(Bt,{value:"highest_rating",children:"Highest Rating"}),s.jsx(Bt,{value:"lowest_rating",children:"Lowest Rating"})]})]})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:Ke(De(N,_e),se).map(Ae=>{var Ue,gt;return s.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs(Wr,{className:"w-8 h-8",children:[s.jsx(Qr,{src:Ae.reviewer_avatar||void 0}),s.jsx(Hr,{className:"text-xs",children:Ae.reviewer_name.charAt(0).toUpperCase()})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-sm",children:Ae.reviewer_name}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(Lt,{className:"w-3 h-3"}),nt(Ae.event_date)]}),Ae.artist_name&&s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx(Ft,{className:"w-3 h-3"}),Ae.artist_name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[le((Ue=Ae.category_average)!=null?Ue:we(Ae)),s.jsx("span",{className:"text-sm font-medium ml-1",children:((gt=Ae.category_average)!=null?gt:we(Ae)).toFixed(1)})]})]}),Ae.review_text&&s.jsx("p",{className:"text-sm text-gray-700",children:Ae.review_text}),typeof Ae.ticket_price_paid=="number"&&Ae.ticket_price_paid>0&&s.jsxs("div",{className:"text-xs text-gray-600 bg-gray-100 inline-flex px-2 py-1 rounded",children:["Ticket price (private): $",Ae.ticket_price_paid.toFixed(2)]}),[{label:"Artist performance",rating:Ae.artist_performance_rating,feedback:Ae.artist_performance_feedback},{label:"Production",rating:Ae.production_rating,feedback:Ae.production_feedback,recommendation:Ae.production_recommendation},{label:"Venue",rating:Ae.venue_rating,feedback:Ae.venue_feedback,recommendation:Ae.venue_recommendation},{label:"Location",rating:Ae.location_rating,feedback:Ae.location_feedback,recommendation:Ae.location_recommendation},{label:"Value",rating:Ae.value_rating,feedback:Ae.value_feedback,recommendation:Ae.value_recommendation}].filter(({rating:Ce,feedback:Ge})=>Ce||Ge).map(({label:Ce,rating:Ge,feedback:Nt})=>s.jsxs("div",{className:"text-sm border-l-4 border-blue-200 pl-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium text-gray-600",children:Ce}),typeof Ge=="number"&&s.jsx("span",{className:"text-xs text-gray-500",children:Ge.toFixed(1)})]}),Nt&&s.jsxs("div",{className:"text-xs text-gray-700 italic",children:["",Nt,""]})]},Ce)),Ae.mood_tags&&Ae.mood_tags.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:Ae.mood_tags.map((Ce,Ge)=>s.jsx("div",{style:{height:"25px",borderRadius:"999px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--neutral-100)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:Ce},Ge))})]},Ae.id)})})]})]})})]}),sr.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-2xl font-semibold gradient-text",children:"Upcoming Events"}),s.jsxs(aa,{value:ie,onValueChange:Ae=>ee(Ae),children:[s.jsx(Gs,{className:"w-24 h-8 text-xs",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",borderRadius:"var(--radius-corner, 10px)"},onMouseEnter:Ae=>{Ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:Ae=>{Ae.currentTarget.style.borderColor="var(--neutral-200)"},onFocus:Ae=>{Ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onBlur:Ae=>{Ae.currentTarget.style.borderColor="var(--neutral-200)"},children:s.jsx(ia,{})}),s.jsxs(Ys,{children:[s.jsx(Bt,{value:"date",children:"Date"}),s.jsx(Bt,{value:"artist",children:"Artist"}),s.jsx(Bt,{value:"price",children:"Price"})]})]})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 w-full",children:sr.map(Ae=>s.jsx(sA,{event:{id:Ae.id||"",title:Ae.title||"Event",event_date:Ae.event_date,venue_name:Ae.venue_name,venue_city:Ae.venue_city,venue_state:Ae.venue_state,doors_time:Ae.doors_time,price_range:Ae.price_range,ticket_urls:Ae.ticket_urls,ticket_available:Ae.ticket_available,genres:Ae.genres},onClick:()=>vt(Ae)},Ae.id))})]}),a.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Io,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Events Found"}),s.jsxs("p",{className:"text-muted-foreground mb-4",children:["No events found for ",o||"this venue","."]}),s.jsxs(ce,{onClick:()=>t(-1),children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})]}),s.jsx(Hl,{event:v,currentUserId:(n==null?void 0:n.id)||"",isOpen:x,onClose:()=>{_(!1),g(null)}})]})}const tBe=()=>{const{user:e,loading:t}=ws(),{toast:r}=Er(),[n,a]=y.useState(!0),[i,o]=y.useState(!1),[l,c]=y.useState(null),[d,f]=y.useState(null),[u,h]=y.useState("unknown"),[m,v]=y.useState(!1),[g,x]=y.useState(!1),[_,w]=y.useState("all_time");y.useState([]),y.useEffect(()=>{if(!t){if(!e){window.location.href="/";return}N()}},[e,t]),y.useEffect(()=>{if(e)if(l!==null){const R=E7(l),I=R==="spotify"?"spotify":R==="apple-music"?"apple-music":"unknown";h(I),I!=="unknown"?S():(a(!1),v(!0))}else l===null&&!g&&!n&&(x(!0),b())},[l,e]);const b=()=>E(void 0,null,function*(){e&&(a(!1),v(!0))}),N=()=>E(void 0,null,function*(){if(e)try{a(!0);const{data:R,error:I}=yield T.from("users").select("music_streaming_profile").eq("user_id",e.id).single();if(I&&I.code!=="PGRST116"){console.error("Error loading profile:",I),c(null),a(!1),v(!0);return}const O=(R==null?void 0:R.music_streaming_profile)||null;c(O)}catch(R){console.error("Error in loadUserProfile:",R),c(null),a(!1),v(!0)}}),S=R=>E(void 0,null,function*(){if(!e||u==="unknown"){a(!1),v(!0);return}a(!1),v(!0)}),k=()=>E(void 0,null,function*(){try{if(!Au.isConfigured()){r({title:"Spotify Not Configured",description:"Spotify integration is not available.",variant:"destructive"});return}yield Au.authenticate()}catch(R){console.error("Error connecting Spotify:",R),r({title:"Connection Failed",description:"Failed to connect to Spotify. Please try again.",variant:"destructive"})}}),C=()=>E(void 0,null,function*(){try{o(!0),r({title:"Connecting to Apple Music",description:"Please authorize in the popup window..."}),yield gg.authenticate(),jl.startSync("apple-music"),r({title:"Connected!",description:"Your stats are syncing in the background. You'll be notified when ready!"}),gg.syncProfileData().then(()=>{jl.completeSync(),S(_),v(!1)}).catch(R=>{console.error("Background sync error:",R),jl.errorSync(R.message||"Sync failed")}),setTimeout(()=>{window.location.href="/",localStorage.setItem("intendedView","feed")},1500)}catch(R){console.error("Error connecting Apple Music:",R),jl.errorSync(R instanceof Error?R.message:"Connection failed"),r({title:"Connection Failed",description:"Failed to connect to Apple Music. Please try again.",variant:"destructive"}),o(!1)}}),A=()=>E(void 0,null,function*(){if(!(!e||u==="unknown"))try{if(o(!0),r({title:"Syncing Stats",description:"Fetching comprehensive streaming data... This may take a moment."}),u==="spotify"){if(!Au.isAuthenticated()){r({title:"Not Connected",description:"Please connect your Spotify account first.",variant:"destructive"}),v(!0);return}yield Au.syncUserMusicPreferences()}else if(u==="apple-music"){if(!gg.checkStoredToken()){r({title:"Not Connected",description:"Please connect your Apple Music account first.",variant:"destructive"}),v(!0);return}const R=yield gg.generateProfileData();if(R){yield gg.uploadProfileData(R);const I=R.topArtists||[],O=R.topGenres||[],z={user_id:e.id,service_type:"apple-music",top_artists:I.map(M=>{var B;return{name:M.name||((B=M.attributes)==null?void 0:B.name)||"",popularity:M.popularity||0,id:M.id}}),top_genres:O.map(M=>({genre:typeof M=="string"?M:M.genre||"",count:typeof M=="string"?1:M.count||1})),total_tracks:R.totalTracks||0,unique_artists:I.length,total_listening_hours:R.totalListeningHours||0}}}yield S(_),v(!1),r({title:"Sync Complete",description:"Your streaming stats have been synced from your music service. Note: Stats are not stored permanently."})}catch(R){console.error("Error syncing stats:",R),r({title:"Sync Failed",description:"Failed to sync streaming stats. Please try again.",variant:"destructive"})}finally{o(!1)}});return t||n?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx("div",{className:"flex items-center justify-center py-20",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading streaming stats..."})]})})})}):e?m&&!d?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"flex items-center mb-6",children:s.jsxs(ce,{variant:"ghost",onClick:()=>{console.log(" StreamingStatsPage: Back button clicked"),window.location.href="/",localStorage.setItem("intendedView","profile")},children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Back to Profile"]})}),s.jsxs(Ze,{className:"max-w-2xl mx-auto",children:[s.jsx(kr,{children:s.jsxs(Lr,{className:"flex items-center gap-2 text-2xl",children:[s.jsx(Ft,{className:"w-6 h-6 text-pink-500"}),"Connect Your Streaming Service"]})}),s.jsxs(tt,{className:"text-center py-12 space-y-6",children:[s.jsx("div",{className:"w-20 h-20 bg-pink-100 rounded-full flex items-center justify-center mx-auto",children:s.jsx(Ft,{className:"w-10 h-10 text-pink-500"})}),s.jsx("h3",{className:"text-xl font-semibold",children:"Connect Your Music"}),s.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Connect your Spotify or Apple Music account to view your comprehensive streaming statistics and personalize your feed."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-8",children:[s.jsx(Ze,{className:"border-2 hover:border-green-500 transition-colors cursor-pointer",onClick:k,children:s.jsxs(tt,{className:"pt-6",children:[s.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Ft,{className:"w-6 h-6 text-white"})}),s.jsx("h4",{className:"font-semibold mb-2",children:"Connect Spotify"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"View your top artists, tracks, and listening habits"}),s.jsxs(ce,{className:"w-full bg-green-500 hover:bg-green-600",children:[s.jsx(RO,{className:"w-4 h-4 mr-2"}),"Connect Spotify"]})]})}),s.jsx(Ze,{className:"border-2 hover:border-red-500 transition-colors cursor-pointer",onClick:C,children:s.jsxs(tt,{className:"pt-6",children:[s.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Ft,{className:"w-6 h-6 text-white"})}),s.jsx("h4",{className:"font-semibold mb-2",children:"Connect Apple Music"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Sync your library and listening history"}),s.jsxs(ce,{className:"w-full bg-red-500 hover:bg-red-600",children:[s.jsx(RO,{className:"w-4 h-4 mr-2"}),"Connect Apple Music"]})]})})]})]})]})]})}):d||u!=="unknown"?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs(ce,{variant:"ghost",onClick:()=>{window.location.href="/",localStorage.setItem("intendedView","profile")},children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-3",children:[i&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(vi,{className:"w-4 h-4 animate-spin text-pink-500"}),s.jsx("span",{children:"Syncing your stats..."})]}),s.jsxs(ce,{onClick:A,disabled:i,variant:"outline",className:"bg-pink-50 hover:bg-pink-100 border-pink-200",children:[s.jsx(vi,{className:`w-4 h-4 mr-2 ${i?"animate-spin":""}`}),i?"Syncing...":"Refresh Stats"]})]})]}),s.jsx(Ze,{className:"mb-6",children:s.jsxs(tt,{className:"pt-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-1",children:"Time Period"}),(d==null?void 0:d.last_updated)&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.jsx("span",{className:"font-medium text-pink-600",children:"Last synced:"})," ",Rt(new Date(d.last_updated),"MMM d, yyyy h:mm a"),s.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Data is permanently stored)"})]})]})}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["last_day","last_week","last_month","last_3_months","last_6_months","last_year","last_3_years","last_5_years","all_time"].map(R=>{const I=d!==null,O=_===R;return s.jsxs(ce,{variant:O?"default":"outline",size:"sm",disabled:!I||n,onClick:()=>E(void 0,null,function*(){O||(w(R),a(!0),yield S())}),className:O?"bg-pink-500 hover:bg-pink-600 text-white":I?"hover:bg-pink-50":"opacity-50 cursor-not-allowed",children:[R==="last_day"&&"Day",R==="last_week"&&"Week",R==="last_month"&&"Month",R==="last_3_months"&&"3 Months",R==="last_6_months"&&"6 Months",R==="last_year"&&"Year",R==="last_3_years"&&"3 Years",R==="last_5_years"&&"5 Years",R==="all_time"&&"All Time"]},R)})})]})}),s.jsx(Ze,{className:"mb-6 border-2",children:s.jsx(kr,{children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center ${u==="spotify"?"bg-green-500":"bg-red-500"}`,children:s.jsx(Ft,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{children:[s.jsxs(Lr,{className:"text-3xl",children:[u==="spotify"?"Spotify":"Apple Music"," Streaming Stats"]}),d&&s.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Last updated: ",Rt(new Date(d.last_updated),"PPp")]})]})]})})})}),d?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsx(Ze,{children:s.jsx(tt,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx(ZQ,{className:"w-6 h-6 text-pink-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Tracks"}),s.jsx("p",{className:"text-3xl font-bold",children:d.total_tracks})]})]})})}),s.jsx(Ze,{children:s.jsx(tt,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx(Is,{className:"w-6 h-6 text-pink-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Unique Artists"}),s.jsx("p",{className:"text-3xl font-bold",children:d.unique_artists})]})]})})}),s.jsx(Ze,{children:s.jsx(tt,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx(Oa,{className:"w-6 h-6 text-pink-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Listening Hours"}),s.jsx("p",{className:"text-3xl font-bold",children:Math.round(d.total_listening_hours)})]})]})})}),s.jsx(Ze,{children:s.jsx(tt,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx(qd,{className:"w-6 h-6 text-pink-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Top Genres"}),s.jsx("p",{className:"text-3xl font-bold",children:d.top_genres.length})]})]})})})]}),s.jsxs(zi,{defaultValue:"artists",className:"space-y-4",children:[s.jsxs(wi,{className:"grid w-full grid-cols-4",children:[s.jsx(en,{value:"artists",children:"Top Artists"}),s.jsx(en,{value:"tracks",children:"Top Tracks"}),s.jsx(en,{value:"genres",children:"Top Genres"}),s.jsx(en,{value:"insights",children:"Insights"})]}),s.jsx(tn,{value:"artists",className:"space-y-4",children:s.jsxs(Ze,{children:[s.jsx(kr,{children:s.jsx(Lr,{children:"Your Top Artists"})}),s.jsx(tt,{children:d.top_artists.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.top_artists.slice(0,20).map((R,I)=>s.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-lg border hover:bg-muted/50 transition-colors",children:[s.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-pink-400 to-purple-500 flex items-center justify-center text-white font-bold text-lg",children:I+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-lg truncate",children:R.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Popularity: ",R.popularity,"/100"]})]})]},R.id||R.name))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ft,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4 opacity-50"}),s.jsx("p",{className:"text-muted-foreground",children:"No artist data available. Sync your stats to see your top artists."})]})})]})}),s.jsx(tn,{value:"tracks",className:"space-y-4",children:s.jsxs(Ze,{children:[s.jsx(kr,{children:s.jsx(Lr,{children:"Your Top Tracks"})}),s.jsx(tt,{children:d.top_tracks&&d.top_tracks.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.top_tracks.slice(0,30).map((R,I)=>s.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-lg border hover:bg-muted/50 transition-colors",children:[s.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-purple-400 to-pink-500 flex items-center justify-center text-white font-bold text-lg",children:I+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-lg truncate",children:R.name||"Unknown Track"}),s.jsx("p",{className:"text-sm text-muted-foreground truncate",children:R.artist||"Unknown Artist"}),R.popularity!==void 0&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Popularity: ",R.popularity,"/100"]})]})]},R.id||`${R.name}-${I}`))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(BQ,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4 opacity-50"}),s.jsx("p",{className:"text-muted-foreground",children:"No track data available. Sync your stats to see your top tracks."})]})})]})}),s.jsx(tn,{value:"genres",className:"space-y-4",children:s.jsxs(Ze,{children:[s.jsx(kr,{children:s.jsx(Lr,{children:"Your Top Genres"})}),s.jsx(tt,{children:d.top_genres.length>0?s.jsx("div",{className:"space-y-3",children:d.top_genres.map((R,I)=>s.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border hover:bg-muted/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-pink-100 flex items-center justify-center text-pink-600 font-bold",children:I+1}),s.jsx("span",{className:"font-semibold text-lg",children:R.genre})]}),s.jsxs(et,{variant:"secondary",className:"text-lg px-3 py-1",children:[R.count," ",R.count===1?"artist":"artists"]})]},R.genre))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(qd,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4 opacity-50"}),s.jsx("p",{className:"text-muted-foreground",children:"No genre data available. Sync your stats to see your top genres."})]})})]})}),s.jsx(tn,{value:"insights",className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs(Ze,{children:[s.jsx(kr,{children:s.jsxs(Lr,{className:"flex items-center gap-2",children:[s.jsx(qn,{className:"w-5 h-5"}),"Listening Activity"]})}),s.jsxs(tt,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Tracks"}),s.jsx("p",{className:"text-2xl font-bold",children:d.total_tracks})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Estimated Listening Time"}),s.jsxs("p",{className:"text-2xl font-bold",children:[Math.round(d.total_listening_hours)," hours"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Artist Diversity"}),s.jsxs("p",{className:"text-2xl font-bold",children:[d.unique_artists," unique artists"]})]})]})]}),s.jsxs(Ze,{children:[s.jsx(kr,{children:s.jsxs(Lr,{className:"flex items-center gap-2",children:[s.jsx(qQ,{className:"w-5 h-5"}),"Music Preferences"]})}),s.jsxs(tt,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Top Genre"}),d.top_genres.length>0?s.jsx(et,{variant:"default",className:"text-lg px-3 py-1",children:d.top_genres[0].genre}):s.jsx("p",{className:"text-muted-foreground",children:"No data"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Top Artist"}),d.top_artists.length>0?s.jsx("p",{className:"text-lg font-semibold",children:d.top_artists[0].name}):s.jsx("p",{className:"text-muted-foreground",children:"No data"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Genre Diversity"}),s.jsxs("p",{className:"text-2xl font-bold",children:[d.top_genres.length," genres"]})]})]})]})]})})]})]}):s.jsx(Ze,{children:s.jsxs(tt,{className:"py-12 text-center",children:[s.jsx("p",{className:"text-muted-foreground mb-4",children:"No stats available yet."}),s.jsxs(ce,{onClick:A,disabled:i,children:[s.jsx(vi,{className:`w-4 h-4 mr-2 ${i?"animate-spin":""}`}),i?"Syncing...":"Sync Your Stats"]})]})})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs(ce,{variant:"ghost",onClick:()=>{window.location.href="/",localStorage.setItem("intendedView","profile")},className:"mb-6",children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx(Ze,{children:s.jsx(tt,{className:"py-12 text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"Unable to load streaming stats."})})})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx("div",{className:"flex items-center justify-center py-20",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"Please log in to view streaming stats."})})})})})};function W$(){var oe;const e=ts(),{userId:t}=sT(),{user:r}=ws(),[n,a]=y.useState("artists"),[i,o]=y.useState([]),[l,c]=y.useState([]),[d,f]=y.useState(!0),[u,h]=y.useState(null),[m,v]=y.useState([]),[g,x]=y.useState(null),[_,w]=y.useState(null),[b,N]=y.useState(null),[S,k]=y.useState("events"),[C,A]=y.useState("date"),[R,I]=y.useState("asc"),[O,z]=y.useState("all"),M=t||(r==null?void 0:r.id)||"",B=!t||t===(r==null?void 0:r.id),F=((oe=r==null?void 0:r.user_metadata)==null?void 0:oe.name)||"User";y.useEffect(()=>{M&&(U(),H())},[M]),y.useEffect(()=>{(i.length>0||l.length>0)&&q()},[C,R,O]);const U=()=>E(this,null,function*(){try{f(!0),h(null);const ie=yield ki.getUserFollowedArtists(M),ee=yield Promise.all(ie.map(G=>E(this,null,function*(){try{const{data:J}=yield supabase.from("events").select("*").ilike("artist_name",`%${G.artist_name}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(50),ae=(J||[]).map(ve=>({id:ve.id,title:ve.title,artist_name:ve.artist_name||G.artist_name,venue_name:ve.venue_name,venue_id:ve.venue_id,venue_city:ve.venue_city,venue_state:ve.venue_state,venue_address:ve.venue_address,venue_zip:ve.venue_zip,event_date:ve.event_date,doors_time:ve.doors_time,description:ve.description,ticket_urls:ve.ticket_urls||[],price_range:ve.price_range,ticket_available:ve.ticket_available,genres:ve.genres,source:ve.source||"jambase"}));console.log(` Checking events for "${G.artist_name}":`,{totalEvents:ae.length,events:ae.map(ve=>({title:ve.title,artist:ve.artist_name,date:ve.event_date,source:ve.source}))});const fe=new Date,we=ae.filter(ve=>{var De,nt;const me=ve.event_date,Te=new Date(me)>fe,Ve=(De=ve.title)==null?void 0:De.toLowerCase().includes(G.artist_name.toLowerCase()),le=((nt=ve.artist_name)==null?void 0:nt.toLowerCase())===G.artist_name.toLowerCase(),Ke=Te&&(Ve||le);return!Ke&&Te&&console.log(` Event not matched for "${G.artist_name}":`,{title:ve.title,artistInEvent:ve.artist_name,titleContainsArtist:Ve,exactArtistMatch:le}),Ke});return console.log(` Filtered upcoming events for "${G.artist_name}":`,{count:we.length,events:we.map(ve=>({title:ve.title,date:ve.event_date,source:ve.source}))}),V(D({},G),{upcomingEvents:we})}catch(J){return console.warn(`Error loading events for artist ${G.artist_name}:`,J),V(D({},G),{upcomingEvents:[]})}})));o(ee)}catch(ie){console.error("Error loading followed artists:",ie),h("Failed to load followed artists")}finally{f(!1)}}),H=()=>E(this,null,function*(){try{const ie=yield Ou.getUserFollowedVenues(M),ee=yield Promise.all(ie.map(G=>E(this,null,function*(){try{const{data:J}=yield supabase.from("events").select("*").ilike("venue_name",`%${G.venue_name}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(50),ae=(J||[]).map(ve=>({id:ve.id,title:ve.title,artist_name:ve.artist_name||"Unknown Artist",venue_name:ve.venue_name,venue_id:ve.venue_id,venue_city:ve.venue_city,venue_state:ve.venue_state,venue_address:ve.venue_address,venue_zip:ve.venue_zip,event_date:ve.event_date,doors_time:ve.doors_time,description:ve.description,ticket_urls:ve.ticket_urls||[],price_range:ve.price_range,ticket_available:ve.ticket_available,genres:ve.genres,source:ve.source||"jambase"})),fe=new Date,we=ae.filter(ve=>new Date(ve.event_date)>fe);return console.log(` Filtered upcoming events for "${G.venue_name}":`,{count:we.length,events:we.map(ve=>({title:ve.title,date:ve.event_date,source:ve.source}))}),V(D({},G),{upcomingEvents:we})}catch(J){return console.warn(`Error loading events for venue ${G.venue_name}:`,J),V(D({},G),{upcomingEvents:[]})}})));c(ee)}catch(ie){console.error("Error loading followed venues:",ie)}});y.useEffect(()=>{(i.length>0||l.length>0)&&q()},[i,l]);const q=()=>{const ie=i.flatMap(fe=>fe.upcomingEvents.map(we=>V(D({},we),{source:"artist",sourceName:fe.artist_name}))),ee=l.flatMap(fe=>fe.upcomingEvents.map(we=>V(D({},we),{source:"venue",sourceName:fe.venue_name}))),G=[...ie,...ee],J=se(G),ae=de(J);v(ae)},K=ie=>{x(ie)},Z=ie=>{w(ie),N(null),x(null),k("artist")},ne=ie=>{N(ie),w(null),x(null),k("venue")},Y=(ie,ee)=>{if(ie==="artist"){const G=i.find(J=>J.artist_name===ee);G&&Z(G)}else if(ie==="venue"){const G=l.find(J=>J.venue_name===ee);G&&ne(G)}},X=()=>{localStorage.setItem("intendedView","profile"),e("/")},se=ie=>O==="all"?ie:ie.filter(ee=>ee.source===O),de=ie=>[...ie].sort((ee,G)=>{let J=0;switch(C){case"date":J=new Date(ee.event_date).getTime()-new Date(G.event_date).getTime();break;case"location":const ae=`${ee.venue_city}, ${ee.venue_state}`.toLowerCase(),fe=`${G.venue_city}, ${G.venue_state}`.toLowerCase();J=ae.localeCompare(fe);break;case"price":const we=ee.price_range||"",ve=G.price_range||"";J=we.localeCompare(ve);break}return R==="asc"?J:-J}),_e=()=>_?s.jsx("div",{className:"h-full overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Wr,{className:"w-16 h-16",children:[s.jsx(Qr,{src:_.artist_image_url}),s.jsx(Hr,{className:"bg-pink-100 text-pink-600",children:s.jsx(Ft,{className:"w-8 h-8"})})]}),s.jsxs("div",{children:[s.jsx("button",{className:"text-2xl font-bold text-left hover:text-pink-600 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 rounded",onClick:()=>{console.log(" Artist name clicked in header:",_.artist_name),e(`/artist/${_.artist_id||encodeURIComponent(_.artist_name)}`)},title:`Click to view ${_.artist_name}'s full profile`,children:_.artist_name}),s.jsxs("p",{className:"text-gray-600",children:["Following since ",Rt(new Date(_.created_at),"MMM d, yyyy")]})]})]}),s.jsxs(ce,{variant:"default",size:"sm",onClick:()=>{console.log(" Back to all events clicked from artist details"),k("events"),w(null)},className:"bg-pink-500 hover:bg-pink-600 text-white border-0 shadow-sm",children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Back to All Events"]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(Lt,{className:"w-5 h-5 text-pink-500"}),"Upcoming Events (",_.upcomingEvents.length,")"]}),_.upcomingEvents.length>0?s.jsx("div",{className:"space-y-4",children:de(_.upcomingEvents).map(ie=>s.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>K(ie),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("h4",{className:"font-medium text-lg",children:ie.title})}),ie.sourceName&&s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["via"," ",s.jsx("button",{onClick:ee=>{ee.stopPropagation(),Y(ie.source,ie.sourceName)},className:"text-pink-600 hover:text-pink-700 hover:underline cursor-pointer",children:ie.sourceName})]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"w-4 h-4"}),Rt(new Date(ie.event_date),"MMM d, yyyy")]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(yr,{className:"w-4 h-4"}),ie.venue_city,", ",ie.venue_state]})]}),ie.venue_address&&ie.venue_address!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-500 mb-2",children:ie.venue_address}),ie.description&&ie.description!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:ie.description})]}),s.jsx("div",{className:"flex flex-col items-end gap-2",children:ie.ticket_urls&&ie.ticket_urls.length>0&&s.jsx(io,{className:"w-4 h-4 text-pink-500"})})]})},ie.id))}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Lt,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:"No upcoming events found"})]})]})]})}):null,xe=()=>b?s.jsx("div",{className:"h-full overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(Wr,{className:"w-16 h-16",children:s.jsx(Hr,{className:"bg-blue-100 text-blue-600",children:s.jsx(Io,{className:"w-8 h-8"})})}),s.jsxs("div",{children:[s.jsx("button",{className:"text-2xl font-bold text-left hover:text-blue-600 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded",onClick:()=>{console.log(" Venue name clicked in header:",b.venue_name),e(`/venue/${encodeURIComponent(b.venue_name)}`)},title:`Click to view ${b.venue_name}'s full profile`,children:b.venue_name}),s.jsxs("p",{className:"text-gray-600",children:[b.venue_city,", ",b.venue_state]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Following since ",Rt(new Date(b.created_at),"MMM d, yyyy")]})]})]}),s.jsxs(ce,{variant:"default",size:"sm",onClick:()=>{k("events"),N(null)},className:"bg-blue-500 hover:bg-blue-600 text-white border-0 shadow-sm",children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Back to All Events"]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(Lt,{className:"w-5 h-5 text-blue-500"}),"Upcoming Events (",b.upcomingEvents.length,")"]}),b.upcomingEvents.length>0?s.jsx("div",{className:"space-y-4",children:de(b.upcomingEvents).map(ie=>s.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>K(ie),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("h4",{className:"font-medium text-lg",children:ie.title}),ie.artist_name&&s.jsx("p",{className:"text-sm text-gray-600",children:ie.artist_name})]}),s.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"w-4 h-4"}),Rt(new Date(ie.event_date),"MMM d, yyyy")]})}),ie.description&&ie.description!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:ie.description})]}),s.jsx("div",{className:"flex flex-col items-end gap-2",children:ie.ticket_urls&&ie.ticket_urls.length>0&&s.jsx(io,{className:"w-4 h-4 text-blue-500"})})]})},ie.id))}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Lt,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:"No upcoming events found"})]})]})]})}):null,Q=()=>m.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[s.jsx(Lt,{className:"w-16 h-16 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Upcoming Events"}),s.jsx("p",{className:"text-gray-500 mb-4",children:i.length===0&&l.length===0?B?"Start following artists and venues to see their upcoming events here!":"This user isn't following any artists or venues yet.":"None of your followed artists or venues have upcoming events at the moment."}),B&&i.length===0&&l.length===0&&s.jsxs(ce,{onClick:()=>e("/search"),className:"bg-pink-500 hover:bg-pink-600",children:[s.jsx(Ft,{className:"w-4 h-4 mr-2"}),"Discover Artists & Venues"]})]}):s.jsx("div",{className:"h-full overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Lt,{className:"w-6 h-6 text-pink-500"}),s.jsx("h2",{className:"text-xl font-bold",children:S==="artist"?`${_==null?void 0:_.artist_name}'s Events`:"Upcoming Events"}),s.jsx(et,{variant:"secondary",className:"bg-pink-100 text-pink-700",children:S==="artist"?_==null?void 0:_.upcomingEvents.length:m.length})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(qy,{className:"w-4 h-4 text-gray-500"}),s.jsxs(aa,{value:O,onValueChange:ie=>z(ie),children:[s.jsx(Gs,{className:"w-32 bg-white border border-gray-300 hover:border-pink-300 focus:border-pink-500",children:s.jsx(ia,{})}),s.jsxs(Ys,{className:"bg-white border border-gray-200 shadow-lg",children:[s.jsx(Bt,{value:"all",className:"hover:bg-pink-50 focus:bg-pink-50",children:"All"}),s.jsx(Bt,{value:"artists",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Artists"}),s.jsx(Bt,{value:"venues",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Venues"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(aa,{value:C,onValueChange:ie=>A(ie),children:[s.jsx(Gs,{className:"w-32 bg-white border border-gray-300 hover:border-pink-300 focus:border-pink-500",children:s.jsx(ia,{})}),s.jsxs(Ys,{className:"bg-white border border-gray-200 shadow-lg",children:[s.jsx(Bt,{value:"date",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Date"}),s.jsx(Bt,{value:"location",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Location"}),s.jsx(Bt,{value:"price",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Price"})]})]}),s.jsx(ce,{variant:"outline",size:"sm",onClick:()=>I(R==="asc"?"desc":"asc"),className:"px-2",children:R==="asc"?s.jsx(IQ,{className:"w-4 h-4"}):s.jsx(MQ,{className:"w-4 h-4"})})]}),S==="artist"&&s.jsxs(ce,{variant:"default",size:"sm",onClick:()=>{console.log(" Back to all events clicked"),k("events"),w(null)},className:"bg-pink-500 hover:bg-pink-600 text-white border-0 shadow-sm",children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Back to All Events"]})]})]}),s.jsx("div",{className:"space-y-4",children:(S==="artist"&&_?_.upcomingEvents:m).map(ie=>s.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>K(ie),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("h4",{className:"font-medium text-lg",children:ie.title})}),ie.sourceName&&s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["via"," ",s.jsx("button",{onClick:ee=>{ee.stopPropagation(),Y(ie.source,ie.sourceName)},className:"text-pink-600 hover:text-pink-700 hover:underline cursor-pointer",children:ie.sourceName})]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"w-4 h-4"}),Rt(new Date(ie.event_date),"MMM d, yyyy")]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(yr,{className:"w-4 h-4"}),ie.venue_city,", ",ie.venue_state]})]}),ie.venue_address&&ie.venue_address!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-500 mb-2",children:ie.venue_address}),ie.description&&ie.description!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:ie.description})]}),s.jsx("div",{className:"flex flex-col items-end gap-2",children:ie.ticket_urls&&ie.ticket_urls.length>0&&s.jsx(io,{className:"w-4 h-4 text-pink-500"})})]})},`${ie.id}-${ie.title}-${ie.artist_name}`))})]})});return d?s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx(fr,{className:"w-8 h-8 animate-spin text-pink-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading followed artists..."})]})})}):u?s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:u}),s.jsxs(ce,{onClick:X,variant:"outline",children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(ce,{variant:"ghost",size:"sm",onClick:X,className:"hover:bg-gray-100",children:[s.jsx(ks,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-3",children:[n==="artists"?s.jsx(Ft,{className:"w-6 h-6 text-pink-500"}):s.jsx(Io,{className:"w-6 h-6 text-blue-500"}),s.jsx("h1",{className:"text-2xl font-bold",children:B?"Following":`${F}'s Following`}),s.jsx(et,{variant:"secondary",className:"bg-gray-100 text-gray-700",children:i.length+l.length})]})]}),s.jsx(zi,{value:n,onValueChange:ie=>{a(ie),w(null),N(null),x(null),k("events")},children:s.jsxs(wi,{children:[s.jsxs(en,{value:"artists",className:"gap-2",children:[s.jsx(Ft,{className:"w-4 h-4"}),"Artists (",i.length,")"]}),s.jsxs(en,{value:"venues",className:"gap-2",children:[s.jsx(Io,{className:"w-4 h-4"}),"Venues (",l.length,")"]})]})})]})}),s.jsxs("div",{className:"flex h-[calc(100vh-80px)]",children:[s.jsxs("div",{className:"w-1/3 bg-white border-r border-gray-200 flex flex-col",children:[s.jsxs("div",{className:"p-4 border-b border-gray-200",children:[s.jsx("h2",{className:"font-semibold text-gray-900",children:n==="artists"?"Followed Artists":"Followed Venues"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:n==="artists"?`Click an artist to view their details  ${i.reduce((ie,ee)=>ie+ee.upcomingEvents.length,0)} upcoming events`:`Click a venue to view their details  ${l.reduce((ie,ee)=>ie+ee.upcomingEvents.length,0)} upcoming events`})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:n==="artists"?i.length===0?s.jsxs("div",{className:"p-4 text-center text-gray-500",children:[s.jsx(Ft,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"No artists followed"})]}):s.jsx("div",{className:"divide-y divide-gray-100",children:i.map(ie=>s.jsx("div",{"data-artist-id":ie.artist_id,className:`p-4 cursor-pointer transition-colors hover:bg-gray-50 ${(_==null?void 0:_.artist_id)===ie.artist_id?"bg-pink-50 border-r-2 border-pink-500":""}`,onClick:()=>Z(ie),children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Wr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(Qr,{src:ie.artist_image_url}),s.jsx(Hr,{className:"bg-pink-100 text-pink-600",children:s.jsx(Ft,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-medium text-gray-900 truncate",children:ie.artist_name}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsxs("p",{className:"text-xs text-gray-500",children:[ie.upcomingEvents.length," upcoming events"]}),ie.upcomingEvents.length>0&&s.jsx(et,{variant:"secondary",className:"text-xs bg-green-100 text-green-700",children:ie.upcomingEvents.length})]})]})]})},ie.artist_id))}):l.length===0?s.jsxs("div",{className:"p-4 text-center text-gray-500",children:[s.jsx(Io,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"No venues followed"})]}):s.jsx("div",{className:"divide-y divide-gray-100",children:l.map(ie=>s.jsx("div",{className:`p-4 cursor-pointer transition-colors hover:bg-gray-50 ${(b==null?void 0:b.id)===ie.id?"bg-blue-50 border-r-2 border-blue-500":""}`,onClick:()=>ne(ie),children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Wr,{className:"w-10 h-10 flex-shrink-0",children:s.jsx(Hr,{className:"bg-blue-100 text-blue-600",children:s.jsx(Io,{className:"w-5 h-5"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-medium text-gray-900 truncate",children:ie.venue_name}),s.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[ie.venue_city,", ",ie.venue_state]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsxs("p",{className:"text-xs text-gray-500",children:[ie.upcomingEvents.length," upcoming events"]}),ie.upcomingEvents.length>0&&s.jsx(et,{variant:"secondary",className:"text-xs bg-green-100 text-green-700",children:ie.upcomingEvents.length})]})]})]})},ie.id))})})]}),s.jsx("div",{className:"flex-1 bg-white",children:S==="artist"&&_?_e():S==="venue"&&b?xe():Q()})]}),g&&s.jsx(vn,{open:!!g,onOpenChange:()=>x(null),children:s.jsxs(hn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsx(Hn,{children:s.jsxs(Sn,{className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"w-5 h-5 text-pink-500"}),"Event Details"]})}),s.jsx("div",{className:"mt-4",children:s.jsx(U5,{event:g,currentUserId:(r==null?void 0:r.id)||"",showInterestButton:!1,showReviewButton:!1})})]})})]})}function rBe(){const{user:e,loading:t,sessionExpired:r}=ws(),{accountInfo:n,loading:a,isAdmin:i}=hf(),[o,l]=y.useState([]),[c,d]=y.useState(!0),[f,u]=y.useState(null),[h,m]=y.useState(""),[v,g]=y.useState(1),[x,_]=y.useState(0),[w,b]=y.useState(""),N=50,S=()=>{};y.useEffect(()=>{e&&i()&&k()},[e,v,w]);const k=()=>E(this,null,function*(){try{d(!0),u(null);const I=(v-1)*N;let O=T.from("users_complete").select("*",{count:"exact"}).order("created_at",{ascending:!1}).range(I,I+N-1);w&&(O=O.eq("account_type",w)),h&&(O=O.or(`name.ilike.%${h}%,username.ilike.%${h}%,instagram_handle.ilike.%${h}%`));const{data:z,error:M,count:B}=yield O;if(M)throw M;l(z||[]),_(B||0)}catch(I){console.error("Error fetching users:",I),u(I.message||"Failed to fetch users")}finally{d(!1)}}),C=()=>{E(this,null,function*(){try{d(!0),u(null);let O=T.from("users_complete").select("*",{count:"exact"}).order("created_at",{ascending:!1}).range(0,N-1);w&&(O=O.eq("account_type",w)),h&&(O=O.or(`name.ilike.%${h}%,username.ilike.%${h}%,instagram_handle.ilike.%${h}%`));const{data:z,error:M,count:B}=yield O;if(M)throw M;l(z||[]),_(B||0),g(1)}catch(O){console.error("Error fetching users:",O),u(O.message||"Failed to fetch users")}finally{d(!1)}})},A=()=>{const I=["ID","User ID","Name","Username","Email","Account Type","Verified","Subscription Tier","Moderation Status","Location","Created At","Last Active"],O=o.map(U=>[U.id,U.user_id,U.name||"",U.username||"","",U.account_type,U.verified?"Yes":"No",U.subscription_tier,U.moderation_status,`${U.location_city||""}${U.location_state?", "+U.location_state:""}`,new Date(U.created_at).toLocaleDateString(),U.last_active_at?new Date(U.last_active_at).toLocaleDateString():"Never"]),z=[I.join(","),...O.map(U=>U.map(H=>`"${H}"`).join(","))].join(`
`),M=new Blob([z],{type:"text/csv"}),B=URL.createObjectURL(M),F=document.createElement("a");F.href=B,F.download=`users-export-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(B)},R=Math.ceil(x/N);return t||a?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(vi,{className:"w-8 h-8 animate-spin text-pink-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):!e||r?s.jsx(L7,{onAuthSuccess:S}):i()?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(wl,{className:"w-8 h-8 text-pink-600"}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"})]}),s.jsx("p",{className:"text-gray-600",children:"Manage users and monitor platform activity"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:k,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50",children:[s.jsx(vi,{className:`w-4 h-4 ${c?"animate-spin":""}`}),"Refresh"]}),s.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2 bg-pink-600 hover:bg-pink-700 text-white rounded-lg transition-colors",children:[s.jsx(pp,{className:"w-4 h-4"}),"Export CSV"]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Vr,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.toLocaleString()})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(wl,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Verified Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter(I=>I.verified).length})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Vr,{className:"w-5 h-5 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Active Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter(I=>{if(!I.last_active_at)return!1;const O=new Date(I.last_active_at),z=new Date(Date.now()-7*24*60*60*1e3);return O>z}).length})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(wl,{className:"w-5 h-5 text-red-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Moderation Issues"})]}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter(I=>I.moderation_status!=="good_standing").length})]})]}),s.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm mb-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(Ho,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search by name, username, or Instagram handle...",value:h,onChange:I=>m(I.target.value),onKeyPress:I=>I.key==="Enter"&&C(),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent"})]})}),s.jsxs("select",{value:w,onChange:I=>{b(I.target.value),g(1)},className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"All Account Types"}),s.jsx("option",{value:"user",children:"User"}),s.jsx("option",{value:"creator",children:"Creator"}),s.jsx("option",{value:"business",children:"Business"}),s.jsx("option",{value:"admin",children:"Admin"})]}),s.jsx("button",{onClick:C,className:"px-6 py-2 bg-pink-600 hover:bg-pink-700 text-white rounded-lg transition-colors",children:"Search"})]})}),f&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-800",children:f})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:c?s.jsxs("div",{className:"p-12 text-center",children:[s.jsx(vi,{className:"w-8 h-8 animate-spin text-pink-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading users..."})]}):o.length===0?s.jsxs("div",{className:"p-12 text-center",children:[s.jsx(Vr,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"No users found"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subscription"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Active"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(I=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:I.avatar_url?s.jsx("img",{className:"h-10 w-10 rounded-full",src:I.avatar_url,alt:I.name}):s.jsx("div",{className:"h-10 w-10 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx("span",{className:"text-pink-600 font-medium",children:I.name.charAt(0).toUpperCase()})})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.name}),s.jsxs("div",{className:"text-sm text-gray-500",children:[I.username&&`@${I.username}`,I.instagram_handle&&`  ${I.instagram_handle}`]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${I.account_type==="admin"?"bg-red-100 text-red-800":I.account_type==="creator"?"bg-purple-100 text-purple-800":I.account_type==="business"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:I.account_type})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${I.moderation_status==="good_standing"?"bg-green-100 text-green-800":I.moderation_status==="warned"?"bg-yellow-100 text-yellow-800":I.moderation_status==="restricted"?"bg-orange-100 text-orange-800":I.moderation_status==="suspended"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:I.moderation_status.replace("_"," ")}),I.verified&&s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Verified"})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${I.subscription_tier==="enterprise"?"bg-purple-100 text-purple-800":I.subscription_tier==="professional"?"bg-blue-100 text-blue-800":I.subscription_tier==="premium"?"bg-pink-100 text-pink-800":"bg-gray-100 text-gray-800"}`,children:I.subscription_tier})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[I.location_city||"N/A",I.location_state&&`, ${I.location_state}`]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(I.created_at).toLocaleDateString()}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:I.last_active_at?new Date(I.last_active_at).toLocaleDateString():"Never"})]},I.id))})]})}),R>1&&s.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(v-1)*N+1," to ",Math.min(v*N,x)," of ",x," users"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>g(I=>Math.max(1,I-1)),disabled:v===1,className:"px-3 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:s.jsx(AP,{className:"w-4 h-4"})}),s.jsxs("span",{className:"px-4 py-2 text-sm text-gray-700",children:["Page ",v," of ",R]}),s.jsx("button",{onClick:()=>g(I=>Math.min(R,I+1)),disabled:v===R,className:"px-3 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:s.jsx(Uy,{className:"w-4 h-4"})})]})]})]})})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:s.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8 text-center",children:[s.jsx(wl,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"You need administrator privileges to access this page."}),s.jsx("button",{onClick:()=>window.location.href="/",className:"px-6 py-2 bg-pink-600 hover:bg-pink-700 text-white rounded-lg transition-colors",children:"Go to Home"})]})})}const nBe=()=>{const e=ts(),r=Vc().pathname,n=r==="/mobile-preview/home"||r==="/mobile-preview",a=r==="/mobile-preview/discover",i=r==="/mobile-preview/post",o=r==="/mobile-preview/messages",l=r==="/mobile-preview/profile",c=[{id:"home",label:"Home",icon:n?"houseSelected":"house",path:"/mobile-preview/home",isActive:n,useLucideForUnselected:!0,lucideIcon:OP},{id:"discover",label:"Discover",icon:a?"discoverSelected":"discover",path:"/mobile-preview/discover",isActive:a,useLucideForUnselected:!0,lucideIcon:RP},{id:"post",label:"Post",icon:"plus",path:"/mobile-preview/post",isActive:i,isCTA:!0},{id:"messages",label:"Messages",icon:o?"circleCommentSelected":"circleComment",path:"/mobile-preview/messages",isActive:o,useLucideForUnselected:!0,lucideIcon:Ln},{id:"profile",label:"Profile",icon:l?"userSelected":"user",path:"/mobile-preview/profile",isActive:l,useLucideForUnselected:!0,lucideIcon:Is}],d=(f,u,h)=>{if(h)window.scrollTo({top:0,behavior:"smooth"}),e(0);else{try{const m={home:"feed",discover:"discover",post:"post",messages:"chat",profile:"profile"};Zt.navigate(r,m[u]||u,{source:"bottom_nav"})}catch(m){console.error("Error tracking navigation:",m)}e(f)}};return s.jsx("nav",{className:"bottom-nav",role:"navigation","aria-label":"Main navigation",children:s.jsx("div",{className:"bottom-nav__container",children:c.map(f=>{if(f.isCTA)return s.jsx("button",{className:"bottom-nav__item bottom-nav__item--cta",onClick:()=>d(f.path,f.id,f.isActive),"aria-label":f.label,"aria-current":f.isActive?"page":void 0,type:"button",children:s.jsx(Re,{name:f.icon,size:24,alt:""})},f.id);if(f.useLucideForBoth&&f.lucideIcon){const u=f.lucideIcon;return s.jsx("button",{className:`bottom-nav__item ${f.isActive?"bottom-nav__item--active":""}`,onClick:()=>d(f.path,f.id,f.isActive),"aria-label":f.label,"aria-current":f.isActive?"page":void 0,type:"button",children:s.jsx(u,{size:24,strokeWidth:2,"aria-hidden":"true"})},f.id)}if(f.useLucideForUnselected&&f.lucideIcon&&!f.isActive){const u=f.lucideIcon;return s.jsx("button",{className:`bottom-nav__item ${f.isActive?"bottom-nav__item--active":""}`,onClick:()=>d(f.path,f.id,f.isActive),"aria-label":f.label,"aria-current":f.isActive?"page":void 0,type:"button",children:s.jsx(u,{size:24,strokeWidth:2,"aria-hidden":"true"})},f.id)}return s.jsx("button",{className:`bottom-nav__item ${f.isActive?"bottom-nav__item--active":""}`,onClick:()=>d(f.path,f.id,f.isActive),"aria-label":f.label,"aria-current":f.isActive?"page":void 0,type:"button",children:s.jsx(Re,{name:f.icon,size:24,alt:""})},f.id)})})})},sBe=({icon:e,heading:t,description:r,className:n=""})=>s.jsxs("div",{className:`empty-state ${n}`,children:[s.jsx("div",{className:"empty-state__icon",children:s.jsx(Re,{name:e,size:60,alt:""})}),s.jsx("h2",{className:"empty-state__heading",children:t}),s.jsx("p",{className:"empty-state__description",children:r})]}),hh=({value:e,interactive:t=!1,onChange:r,className:n=""})=>{const[a,i]=y.useState(null),[o,l]=y.useState(!1),c=y.useRef([]),d=y.useRef(null),f=Math.max(0,Math.min(5,e)),u=a!==null?a:f,h=(b,N)=>{if(!t||!r)return;const S=c.current[b];if(!S)return;const k=S.getBoundingClientRect(),C=N-k.left,A=k.width,R=C<A/2?.5:1,I=b+R;r(I)},m=(b,N)=>{var k;if(!t)return;const S="touches"in b?(k=b.touches[0])==null?void 0:k.clientX:b.clientX;S!==void 0&&(l(!0),h(N,S))},v=b=>{var B;if(!t||!o||!d.current)return;const N="touches"in b?(B=b.touches[0])==null?void 0:B.clientX:b.clientX;if(N===void 0)return;const S=d.current.getBoundingClientRect(),k=N-S.left,A=S.width/5,R=Math.floor(k/A),I=Math.max(0,Math.min(4,R)),z=(k-I*A)/A<.5?.5:1,M=I+z;r&&r(M),i(M)},g=()=>{t&&(l(!1),i(null))},x=(b,N)=>{if(!t)return;const S=c.current[b];if(!S)return;const k=S.getBoundingClientRect(),C=N-k.left,A=k.width,R=C<A/2?.5:1,I=b+R;i(I)},_=()=>{t&&!o&&i(null)};te.useEffect(()=>{if(!t)return;const b=C=>v(C),N=()=>g(),S=C=>v(C),k=()=>g();return o&&(window.addEventListener("mousemove",b),window.addEventListener("mouseup",N),window.addEventListener("touchmove",S,{passive:!1}),window.addEventListener("touchend",k)),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",N),window.removeEventListener("touchmove",S),window.removeEventListener("touchend",k)}},[t,o]);const w=b=>{const N=u-b,S=N>=1,k=N>=.5&&N<1,C=t?35:24,A={color:"var(--rating-star)",fill:"var(--rating-star)"},R={color:"var(--neutral-600)",fill:"none"},I=()=>k?s.jsxs("span",{style:{position:"relative",display:"inline-flex",width:`${C}px`,height:`${C}px`},children:[s.jsx(Xt,{size:C,style:R}),s.jsx("span",{style:{position:"absolute",top:0,left:0,width:"50%",height:"100%",overflow:"hidden"},children:s.jsx(Xt,{size:C,style:A})})]}):s.jsx(Xt,{size:C,style:S?A:R});return t?s.jsx("button",{ref:O=>{c.current[b]=O},className:"star-rating__star star-rating__star--interactive",onClick:O=>m(O,b),onMouseMove:O=>x(b,O.clientX),onMouseLeave:_,onTouchStart:O=>m(O,b),type:"button","aria-label":`Rate ${b+1} out of 5 stars`,children:I()},b):s.jsx("div",{className:"star-rating__star star-rating__star--display",children:I()},b)};return s.jsx("div",{ref:d,className:`star-rating ${n}`,role:t?"radiogroup":"img","aria-label":`Rating: ${f} out of 5 stars`,onMouseLeave:_,children:[0,1,2,3,4].map(b=>w(b))})},aBe=e=>{const t=new Date,r=typeof e=="string"?new Date(e):e;if(isNaN(r.getTime()))return"";const n=t.getTime()-r.getTime(),a=Math.floor(n/(1e3*60)),i=Math.floor(n/(1e3*60*60*24));if(a<24*60){const d=r.getHours(),f=r.getMinutes(),u=d>=12?"PM":"AM",h=d%12||12,m=f.toString().padStart(2,"0");return`${h}:${m} ${u}`}if(i<7)return["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"][r.getDay()];const o=r.getMonth()+1,l=r.getDate(),c=r.getFullYear().toString().slice(-2);return`${o}/${l}/${c}`},Mg=({name:e,lastMessage:t,lastMessageTimestamp:r,isGroupChat:n=!1,groupTag:a,avatarUrl:i,initial:o,onClick:l,onDelete:c})=>{const d=u=>{u.stopPropagation(),c&&c(u)},f=r?aBe(r):"";return s.jsxs("div",{className:"chat-list-item",onClick:l,role:"button",tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),l==null||l())},children:[s.jsx("div",{className:"chat-list-item__avatar",children:s.jsx(Su,{size:45,variant:i?"image":"musicIcon",imageUrl:i||void 0,initial:o,alt:e})}),s.jsxs("div",{className:"chat-list-item__content",children:[s.jsx("div",{className:"chat-list-item__name",children:e}),t&&s.jsx("div",{className:"chat-list-item__message",children:t}),n&&a&&s.jsx("div",{className:"chat-list-item__tag",children:a})]}),s.jsxs("div",{className:"chat-list-item__right",children:[c&&s.jsx("button",{className:"chat-list-item__delete",onClick:d,"aria-label":"Delete chat",type:"button",children:s.jsx(Re,{name:"trash",size:24,alt:"Delete"})}),f&&s.jsx("div",{className:"chat-list-item__timestamp",children:f})]})]})},kK=()=>{const e=ts();return s.jsx("div",{className:"component-showcase",children:s.jsxs("main",{className:"component-showcase__content",children:[s.jsxs("div",{className:"component-showcase__header",children:[s.jsx("h1",{className:"component-showcase__title",children:"Component Showcase"}),s.jsx("p",{className:"component-showcase__subtitle",children:"All design system components and variants"})]}),s.jsxs("section",{className:"component-group",style:{marginTop:"60px"},children:[s.jsx("h2",{className:"component-group__title",children:"Color Palette"}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Neutrals"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"neutral-0",value:"#FFFFFF",label:"Neutral 0"},{name:"neutral-50",value:"#FCFCFC",label:"Neutral 50"},{name:"neutral-100",value:"#F5F5F5",label:"Neutral 100"},{name:"neutral-200",value:"#E6E6E6",label:"Neutral 200"},{name:"neutral-400",value:"#8A8F98",label:"Neutral 400"},{name:"neutral-600",value:"#5D646F",label:"Neutral 600"},{name:"neutral-900",value:"#0E0E0E",label:"Neutral 900"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:t.value,border:t.name==="neutral-0"||t.name==="neutral-50"||t.name==="neutral-100"?"1px solid var(--neutral-200)":"none",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"12px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center"},children:t.value})]},t.name))})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Brand Pinks"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"brand-pink-050",value:"#FDF2F7",label:"Brand Pink 050"},{name:"brand-pink-500",value:"#CC2486",label:"Brand Pink 500"},{name:"brand-pink-600",value:"#951A6D",label:"Brand Pink 600"},{name:"brand-pink-700",value:"#7B1559",label:"Brand Pink 700"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:t.value,border:t.name==="brand-pink-050"?"1px solid var(--neutral-200)":"none",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"12px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center"},children:t.value})]},t.name))})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Status"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"status-success-050",value:"#E6F4ED",label:"Success 050"},{name:"status-success-500",value:"#2E8B63",label:"Success 500"},{name:"status-warning-050",value:"#FFF6D6",label:"Warning 050"},{name:"status-warning-500",value:"#B88900",label:"Warning 500"},{name:"status-error-050",value:"#FDECEA",label:"Error 050"},{name:"status-error-500",value:"#C62828",label:"Error 500"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:t.value,border:t.name.includes("050")?"1px solid var(--neutral-200)":"none",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"12px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center"},children:t.value})]},t.name))})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Info"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"info-blue-050",value:"#F0F6FE",label:"Info Blue 050"},{name:"info-blue-500",value:"#1F66EA",label:"Info Blue 500"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:t.value,border:t.name==="info-blue-050"?"1px solid var(--neutral-200)":"none",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"12px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center"},children:t.value})]},t.name))})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"States / Overlays"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"state-disabled-bg",value:"#E6E6E6",label:"Disabled BG"},{name:"state-disabled-text",value:"#8A8F98",label:"Disabled Text"},{name:"overlay-50",value:"rgba(14, 14, 14, 0.5)",label:"Overlay 50%"},{name:"overlay-20",value:"rgba(14, 14, 14, 0.2)",label:"Overlay 20%"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:t.value,border:t.name==="state-disabled-bg"?"1px solid var(--neutral-200)":"none",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)",position:"relative",overflow:"hidden"},children:(t.name==="overlay-50"||t.name==="overlay-20")&&s.jsx("div",{style:{position:"absolute",inset:0,backgroundImage:`
                          linear-gradient(45deg, #ccc 25%, transparent 25%),
                          linear-gradient(-45deg, #ccc 25%, transparent 25%),
                          linear-gradient(45deg, transparent 75%, #ccc 75%),
                          linear-gradient(-45deg, transparent 75%, #ccc 75%)
                        `,backgroundSize:"8px 8px",backgroundPosition:"0 0, 0 4px, 4px -4px, -4px 0px",opacity:.3}})}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"12px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center"},children:t.value})]},t.name))})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Rating"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"rating-star",value:"#FCDC5F",label:"Rating Star"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:t.value,borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"12px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center"},children:t.value})]},t.name))})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Gradients"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"gradient-brand",value:"linear-gradient(135deg, #CC2486 0%, #8D1FF4 100%)",label:"Brand Gradient"},{name:"gradient-soft",value:"linear-gradient(180deg, #FFFFFF 0%, #FDF2F7 100%)",label:"Soft Gradient"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"160px",height:"80px",background:t.value,border:t.name==="gradient-soft"?"1px solid var(--neutral-200)":"none",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"11px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center",wordBreak:"break-word",maxWidth:"160px"},children:t.value})]},t.name))})]})]}),s.jsxs("section",{className:"component-group",style:{marginTop:"60px"},children:[s.jsx("h2",{className:"component-group__title",children:"Demo Mode"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",color:"var(--neutral-600)",marginBottom:"24px",lineHeight:"1.5"},children:"Preview fully populated pages with realistic mock data. No login or network calls required."}),s.jsxs("div",{className:"component-variants",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px"},children:[s.jsx(Nn,{variant:"secondary",size:"standard",fullWidth:!0,onClick:()=>e("/mobile-preview/demo/home"),children:"Home Feed"}),s.jsx(Nn,{variant:"secondary",size:"standard",fullWidth:!0,onClick:()=>e("/mobile-preview/demo/discover"),children:"Discover"}),s.jsx(Nn,{variant:"secondary",size:"standard",fullWidth:!0,onClick:()=>e("/mobile-preview/demo/profile"),children:"Profile"}),s.jsx(Nn,{variant:"secondary",size:"standard",fullWidth:!0,onClick:()=>e("/mobile-preview/demo/messages"),children:"Messages"}),s.jsx(Nn,{variant:"secondary",size:"standard",fullWidth:!0,onClick:()=>e("/mobile-preview/demo/create-post"),children:"Create Post"})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"Icons"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Default (24px)"}),s.jsx(Re,{name:"house",size:24,alt:"Home"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Small (17px)"}),s.jsx(Re,{name:"heart",size:17,alt:"Heart"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Medium (35px)"}),s.jsx(Re,{name:"heart",size:35,alt:"Heart"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Large (60px)"}),s.jsx(Re,{name:"heart",size:60,alt:"Heart"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Selected Variants (24px)"}),s.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[s.jsx(Re,{name:"houseSelected",size:24,alt:"Home Selected"}),s.jsx(Re,{name:"discoverSelected",size:24,alt:"Discover Selected"}),s.jsx(Re,{name:"circleCommentSelected",size:24,alt:"Messages Selected"}),s.jsx(Re,{name:"userSelected",size:24,alt:"Profile Selected"})]})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Size Variants - Small (17px)"}),s.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[s.jsx(Re,{name:"smallMusic",size:17,alt:"Small Music"}),s.jsx(Re,{name:"smallLocation",size:17,alt:"Small Location"}),s.jsx(Re,{name:"smallCheck",size:17,alt:"Small Check"})]})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Size Variants - Medium (35px)"}),s.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[s.jsx(Re,{name:"mediumStar",size:35,alt:"Medium Star"}),s.jsx(Re,{name:"mediumMusic",size:35,alt:"Medium Music"}),s.jsx(Re,{name:"mediumLocation",size:35,alt:"Medium Location"}),s.jsx(Re,{name:"mediumSend",size:35,alt:"Medium Send"}),s.jsx(Re,{name:"mediumDollar",size:35,alt:"Medium Dollar"}),s.jsx(Re,{name:"mediumBuildings",size:35,alt:"Medium Buildings"}),s.jsx(Re,{name:"mediumShootingStar",size:35,alt:"Medium Shooting Star"}),s.jsx(Re,{name:"mediumMicrophone",size:35,alt:"Medium Microphone"}),s.jsx(Re,{name:"mediumEdit",size:35,alt:"Medium Edit"})]})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Size Variants - Large (60px)"}),s.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[s.jsx(Re,{name:"largeHeart",size:60,alt:"Large Heart"}),s.jsx(Re,{name:"largeStar",size:60,alt:"Large Star"}),s.jsx(Re,{name:"largeVideo",size:60,alt:"Large Video"}),s.jsx(Re,{name:"largeCamera",size:60,alt:"Large Camera"}),s.jsx(Re,{name:"largeMusic",size:60,alt:"Large Music"}),s.jsx(Re,{name:"largeMessaging",size:60,alt:"Large Messaging"})]})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Various Icons (All Normal Size)"}),s.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[s.jsx(Re,{name:"house",size:24,alt:"Home"}),s.jsx(Re,{name:"discover",size:24,alt:"Discover"}),s.jsx(Re,{name:"circleComment",size:24,alt:"Messages"}),s.jsx(Re,{name:"user",size:24,alt:"Profile"}),s.jsx(Re,{name:"plus",size:24,alt:"Post"}),s.jsx(Re,{name:"plusBox",size:24,alt:"Plus Box"}),s.jsx(Re,{name:"search",size:24,alt:"Search"}),s.jsx(Re,{name:"send",size:24,alt:"Send"}),s.jsx(Re,{name:"share",size:24,alt:"Share"}),s.jsx(Re,{name:"upload",size:24,alt:"Upload"}),s.jsx(Re,{name:"download",size:24,alt:"Download"}),s.jsx(Re,{name:"edit",size:24,alt:"Edit"}),s.jsx(Re,{name:"trash",size:24,alt:"Delete"}),s.jsx(Re,{name:"refresh",size:24,alt:"Refresh"}),s.jsx(Re,{name:"repeat",size:24,alt:"Repeat"}),s.jsx(Re,{name:"hamburgerMenu",size:24,alt:"Menu"}),s.jsx(Re,{name:"bell",size:24,alt:"Notifications"}),s.jsx(Re,{name:"settings",size:24,alt:"Settings"}),s.jsx(Re,{name:"filter",size:24,alt:"Filter"}),s.jsx(Re,{name:"sort",size:24,alt:"Sort"}),s.jsx(Re,{name:"sortFilter",size:24,alt:"Sort Filter"}),s.jsx(Re,{name:"x",size:24,alt:"Close"}),s.jsx(Re,{name:"check",size:24,alt:"Check"}),s.jsx(Re,{name:"checkMark",size:24,alt:"Check Mark"}),s.jsx(Re,{name:"circleCheck",size:24,alt:"Circle Check"}),s.jsx(Re,{name:"smallCheck",size:24,alt:"Small Check"}),s.jsx(Re,{name:"minus",size:24,alt:"Minus"}),s.jsx(Re,{name:"questionMark",size:24,alt:"Question"}),s.jsx(Re,{name:"infoCircle",size:24,alt:"Info"}),s.jsx(Re,{name:"exclamationTriangle",size:24,alt:"Warning"}),s.jsx(Re,{name:"arrowDown",size:24,alt:"Arrow Down"}),s.jsx(Re,{name:"arrowUp",size:24,alt:"Arrow Up"}),s.jsx(Re,{name:"left",size:24,alt:"Left"}),s.jsx(Re,{name:"leftArrow",size:24,alt:"Left Arrow"}),s.jsx(Re,{name:"right",size:24,alt:"Right"}),s.jsx(Re,{name:"up",size:24,alt:"Up"}),s.jsx(Re,{name:"upArrow",size:24,alt:"Up Arrow"}),s.jsx(Re,{name:"down",size:24,alt:"Down"}),s.jsx(Re,{name:"heart",size:24,alt:"Like"}),s.jsx(Re,{name:"thumbsUp",size:24,alt:"Thumbs Up"}),s.jsx(Re,{name:"star",size:24,alt:"Star"}),s.jsx(Re,{name:"image",size:24,alt:"Image"}),s.jsx(Re,{name:"photo",size:24,alt:"Photo"}),s.jsx(Re,{name:"video",size:24,alt:"Video"}),s.jsx(Re,{name:"music",size:24,alt:"Music"}),s.jsx(Re,{name:"location",size:24,alt:"Location"}),s.jsx(Re,{name:"calendar",size:24,alt:"Calendar"}),s.jsx(Re,{name:"ticket",size:24,alt:"Ticket"}),s.jsx(Re,{name:"clock",size:24,alt:"Clock"}),s.jsx(Re,{name:"envelope",size:24,alt:"Message"}),s.jsx(Re,{name:"squareComment",size:24,alt:"Comment"}),s.jsx(Re,{name:"atSymbol",size:24,alt:"Mention"}),s.jsx(Re,{name:"userPlus",size:24,alt:"Add User"}),s.jsx(Re,{name:"twoUsers",size:24,alt:"Users"}),s.jsx(Re,{name:"dollar",size:24,alt:"Dollar"}),s.jsx(Re,{name:"building",size:24,alt:"Building"}),s.jsx(Re,{name:"lock",size:24,alt:"Lock"}),s.jsx(Re,{name:"key",size:24,alt:"Key"}),s.jsx(Re,{name:"shield",size:24,alt:"Shield"}),s.jsx(Re,{name:"ban",size:24,alt:"Ban"}),s.jsx(Re,{name:"flag",size:24,alt:"Flag"}),s.jsx(Re,{name:"barChart",size:24,alt:"Bar Chart"}),s.jsx(Re,{name:"pieChart",size:24,alt:"Pie Chart"}),s.jsx(Re,{name:"trendingUp",size:24,alt:"Trending"}),s.jsx(Re,{name:"globe",size:24,alt:"Globe"}),s.jsx(Re,{name:"eye",size:24,alt:"View"}),s.jsx(Re,{name:"externalLink",size:24,alt:"External Link"}),s.jsx(Re,{name:"maximize",size:24,alt:"Maximize"}),s.jsx(Re,{name:"mousePointer",size:24,alt:"Pointer"}),s.jsx(Re,{name:"target",size:24,alt:"Target"}),s.jsx(Re,{name:"ribbonAward",size:24,alt:"Award"}),s.jsx(Re,{name:"logOut",size:24,alt:"Log Out"}),s.jsx(Re,{name:"music",size:24,alt:"Spotify"}),s.jsx(Re,{name:"music",size:24,alt:"Apple Music"}),s.jsx(Re,{name:"instagram",size:24,alt:"Instagram"})]})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"SynthButton"}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Primary"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only (Content-hugging)"}),s.jsx(Nn,{variant:"primary",children:"Primary Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only (Full-width)"}),s.jsx(Nn,{variant:"primary",fullWidth:!0,children:"Full Width Primary"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (Content-hugging)"}),s.jsx(Nn,{variant:"primary",icon:"heart",iconPosition:"left",children:"Like"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (Full-width)"}),s.jsx(Nn,{variant:"primary",icon:"heart",iconPosition:"left",fullWidth:!0,children:"Like"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (Content-hugging)"}),s.jsx(Nn,{variant:"primary",icon:"right",iconPosition:"right",children:"Next"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (Full-width)"}),s.jsx(Nn,{variant:"primary",icon:"right",iconPosition:"right",fullWidth:!0,children:"Next"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon Only (44x44)"}),s.jsx(Nn,{variant:"primary",size:"iconOnly",icon:"house","aria-label":"Home"})]})]})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Secondary"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only (Content-hugging)"}),s.jsx(Nn,{variant:"secondary",children:"Secondary Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only (Full-width)"}),s.jsx(Nn,{variant:"secondary",fullWidth:!0,children:"Full Width Secondary"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (Content-hugging)"}),s.jsx(Nn,{variant:"secondary",icon:"heart",iconPosition:"left",children:"Like"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (Full-width)"}),s.jsx(Nn,{variant:"secondary",icon:"heart",iconPosition:"left",fullWidth:!0,children:"Like"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (Content-hugging)"}),s.jsx(Nn,{variant:"secondary",icon:"right",iconPosition:"right",children:"Next"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (Full-width)"}),s.jsx(Nn,{variant:"secondary",icon:"right",iconPosition:"right",fullWidth:!0,children:"Next"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon Only (44x44)"}),s.jsx(Nn,{variant:"secondary",size:"iconOnly",icon:"house","aria-label":"Home"})]})]})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Tertiary (25px height, labels only, no full-width)"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only"}),s.jsx(Nn,{variant:"tertiary",children:"Tertiary Label"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (small icon)"}),s.jsx(Nn,{variant:"tertiary",icon:"star",iconPosition:"left",children:"Starred"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (small icon)"}),s.jsx(Nn,{variant:"tertiary",icon:"check",iconPosition:"right",children:"Verified"})]})]})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Disabled"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only (Content-hugging)"}),s.jsx(Nn,{variant:"disabled",children:"Disabled Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only (Full-width)"}),s.jsx(Nn,{variant:"disabled",fullWidth:!0,children:"Full Width Disabled"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (Content-hugging)"}),s.jsx(Nn,{variant:"disabled",icon:"heart",iconPosition:"left",children:"Like"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (Full-width)"}),s.jsx(Nn,{variant:"disabled",icon:"heart",iconPosition:"left",fullWidth:!0,children:"Like"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (Content-hugging)"}),s.jsx(Nn,{variant:"disabled",icon:"right",iconPosition:"right",children:"Next"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (Full-width)"}),s.jsx(Nn,{variant:"disabled",icon:"right",iconPosition:"right",fullWidth:!0,children:"Next"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon Only (44x44)"}),s.jsx(Nn,{variant:"disabled",size:"iconOnly",icon:"house","aria-label":"Home"})]})]})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Small Button (28px height) - Toggle Pattern"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Unselected State (Neutral surface + brand-pink border/text)"}),s.jsx("button",{style:{height:"var(--size-button-height-sm, 28px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",border:"2px solid var(--brand-pink-500)",backgroundColor:"var(--neutral-50)",color:"var(--brand-pink-500)",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 4px 0 var(--shadow-color)",marginTop:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-small, 12px)"},children:"Interested"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Selected State (Brand-pink background + inverse text)"}),s.jsx("button",{style:{height:"var(--size-button-height-sm, 28px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",border:"none",backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 4px 0 var(--shadow-color)",marginTop:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-small, 12px)"},children:"Interested"})]})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"UI Button (shadcn/ui variants)"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",color:"var(--neutral-600)",marginBottom:"24px",lineHeight:"1.5"},children:"Additional button variants from the UI component library. Use SynthButton for primary actions."}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Variants"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Default (Synth Primary)"}),s.jsx(ce,{variant:"default",children:"Default Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Secondary (Synth Secondary)"}),s.jsx(ce,{variant:"secondary",children:"Secondary Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Outline"}),s.jsx(ce,{variant:"outline",children:"Outline Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Ghost"}),s.jsx(ce,{variant:"ghost",children:"Ghost Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Link"}),s.jsx(ce,{variant:"link",children:"Link Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Destructive"}),s.jsx(ce,{variant:"destructive",children:"Destructive Button"})]})]})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Sizes"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Small (sm)"}),s.jsx(ce,{variant:"default",size:"sm",children:"Small Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Default"}),s.jsx(ce,{variant:"default",size:"default",children:"Default Size"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Large (lg)"}),s.jsx(ce,{variant:"default",size:"lg",children:"Large Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon"}),s.jsx(ce,{variant:"default",size:"icon",children:s.jsx(Re,{name:"house",size:16,alt:"Home"})})]})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"ProfilePicture"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"45px - Music Icon (centered)"}),s.jsx(Su,{size:45,variant:"musicIcon",alt:"Music"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"45px - Initial (body typography, bolded)"}),s.jsx(Su,{size:45,variant:"initial",initial:"F",alt:"User"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"75px - Initial (h1 typography, for user profile)"}),s.jsx(Su,{size:75,variant:"initial",initial:"F",alt:"User Profile"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"32px - Initial (meta typography, bolded, for chat)"}),s.jsx(Su,{size:32,variant:"initial",initial:"F",alt:"Chat User"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"45px - Image (replaces design, keeps size)"}),s.jsx(Su,{size:45,variant:"image",initial:"F",imageUrl:null,alt:"User with Image"})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"UserInfo"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"User Variant"}),s.jsx(fc,{variant:"user",name:"First Last",username:"username",initial:"F"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Artist Variant"}),s.jsx(fc,{variant:"artist",name:"First Last",initial:"F"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Chat Variant"}),s.jsx(fc,{variant:"chat",name:"First Last",initial:"F"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"UserProfile Variant"}),s.jsx(fc,{variant:"userProfile",name:"First Last",username:"username",initial:"F",followers:1234,following:567,events:89})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"IconText"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Left Icon"}),s.jsx(Bg,{text:"Home",icon:"house",iconPosition:"left"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Right Icon"}),s.jsx(Bg,{text:"Next",icon:"right",iconPosition:"right"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Clickable Left Icon"}),s.jsx(Bg,{text:"Click Me",icon:"heart",iconPosition:"left",onClick:()=>alert("Clicked!")})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Clickable Right Icon"}),s.jsx(Bg,{text:"Continue",icon:"right",iconPosition:"right",onClick:()=>alert("Clicked!")})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"MenuCategory"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Clickable Menu Item"}),s.jsx(Ru,{label:"Activity",icon:"bell",onPress:()=>alert("Activity clicked")})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Another Menu Item"}),s.jsx(Ru,{label:"Settings",icon:"settings",onPress:()=>alert("Settings clicked")})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Non-clickable"}),s.jsx(Ru,{label:"Info",icon:"infoCircle"})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"EmptyState"}),s.jsx("div",{className:"component-variants",children:s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Empty State Example"}),s.jsx(sBe,{icon:"music",heading:"No events yet",description:"Check back later for upcoming events"})]})})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"StarRating"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Display-only - 0 stars"}),s.jsx(hh,{value:0})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Display-only - 1 star"}),s.jsx(hh,{value:1})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Display-only - 2.5 stars"}),s.jsx(hh,{value:2.5})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Display-only - 3.5 stars"}),s.jsx(hh,{value:3.5})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Display-only - 5 stars"}),s.jsx(hh,{value:5})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Interactive - Tap to rate"}),s.jsx("p",{style:{fontSize:"var(--typography-meta-size, 16px)",color:"var(--color-dark-grey, #5D646F)",marginBottom:"6px",fontFamily:"var(--font-family)"},children:"tap or swipe/drag to rate"}),s.jsx(hh,{value:0,interactive:!0,onChange:t=>console.log("Rating changed:",t)})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"SearchBar"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant component-variant--search-bar",children:[s.jsx("p",{className:"component-variant__label",children:"Default (Full-width)"}),s.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:s.jsx(Ai,{placeholder:"Search"})})]}),s.jsxs("div",{className:"component-variant component-variant--search-bar",children:[s.jsx("p",{className:"component-variant__label",children:"With Value (shows X icon)"}),s.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:s.jsx(Ai,{value:"Sample search query",onChange:()=>{}})})]}),s.jsxs("div",{className:"component-variant component-variant--search-bar",children:[s.jsx("p",{className:"component-variant__label",children:"Popup Variant"}),s.jsx("div",{className:"popup-container",style:{padding:"20px",backgroundColor:"var(--neutral-50)",width:"100%",maxWidth:"100%"},children:s.jsx(Ai,{widthVariant:"popup",placeholder:"Search in popup"})})]}),s.jsxs("div",{className:"component-variant component-variant--search-bar",children:[s.jsx("p",{className:"component-variant__label",children:"Flex Variant (for Discover header)"}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",width:"100%",maxWidth:"100%"},children:[s.jsx(Ai,{widthVariant:"flex",placeholder:"Search"}),s.jsx("button",{style:{width:"44px",height:"44px",border:"1px solid var(--color-light-grey)",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"var(--color-off-white)"},"aria-label":"Menu",children:s.jsx(Re,{name:"hamburgerMenu",size:24,alt:""})})]})]}),s.jsxs("div",{className:"component-variant component-variant--search-bar",children:[s.jsx("p",{className:"component-variant__label",children:"Disabled"}),s.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:s.jsx(Ai,{placeholder:"Search",disabled:!0})})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"Chat Messages"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Message Layout (393px container example)"}),s.jsxs("div",{style:{maxWidth:"353px",width:"100%",margin:"0 auto",padding:"24px 0",backgroundColor:"var(--color-off-white, #FCFCFC)",borderRadius:"10px",paddingLeft:"20px",paddingRight:"20px"},children:[s.jsx("div",{className:"flex justify-center w-full",style:{marginBottom:"24px"},children:s.jsxs("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"#5D646F",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[s.jsx("span",{style:{fontWeight:"var(--typography-meta-weight, 700)"},children:"Monday"}),s.jsx("span",{style:{fontWeight:"var(--typography-meta-weight, 500)"},children:" at 8:03 PM"})]})}),s.jsx("div",{className:"flex flex-col",style:{alignItems:"flex-start",marginBottom:"24px"},children:s.jsxs("div",{className:"flex flex-col",style:{gap:"6px"},children:[s.jsx("div",{style:{maxWidth:"172px",padding:"12px",borderRadius:"10px",border:"1px solid var(--neutral-200)",backgroundColor:"var(--state-disabled-bg)",color:"var(--neutral-900)",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",margin:0},children:"Hey! How are you doing?"})}),s.jsx("div",{style:{maxWidth:"172px",padding:"12px",borderRadius:"10px",border:"1px solid var(--neutral-200)",backgroundColor:"var(--state-disabled-bg)",color:"var(--neutral-900)",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",margin:0},children:"Want to grab coffee later?"})}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",lineHeight:"var(--typography-meta-line-height, 1.5)",textAlign:"left",margin:0},children:"8:05 PM"})]})}),s.jsx("div",{className:"flex flex-col",style:{alignItems:"flex-end",marginBottom:"24px"},children:s.jsxs("div",{className:"flex flex-col",style:{gap:"6px"},children:[s.jsx("div",{style:{maxWidth:"172px",padding:"12px",borderRadius:"10px",border:"none",backgroundColor:"var(--brand-pink-500)",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",margin:0,color:"var(--neutral-50)"},children:"I'm doing great! Coffee sounds perfect."})}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",lineHeight:"var(--typography-meta-line-height, 1.5)",textAlign:"right",margin:0},children:"8:07 PM"})]})}),s.jsxs("div",{className:"flex flex-col",style:{alignItems:"flex-start"},children:[s.jsx("div",{style:{marginBottom:"6px"},children:s.jsx(fc,{variant:"chat",name:"John Doe",initial:"J"})}),s.jsxs("div",{className:"flex flex-col",style:{gap:"6px"},children:[s.jsx("div",{style:{maxWidth:"172px",padding:"12px",borderRadius:"10px",border:"1px solid var(--neutral-200)",backgroundColor:"var(--state-disabled-bg)",color:"var(--neutral-900)",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",margin:0},children:"This is a group chat message with user info above"})}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",lineHeight:"var(--typography-meta-line-height, 1.5)",textAlign:"left",margin:0},children:"8:10 PM"})]})]})]})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Spacing Rules"}),s.jsxs("ul",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",color:"var(--neutral-600)",paddingLeft:"20px",lineHeight:"1.6"},children:[s.jsx("li",{children:"6px between messages from same sender"}),s.jsx("li",{children:"24px between different senders"}),s.jsx("li",{children:"24px below session timestamp"}),s.jsx("li",{children:"6px above group chat user info"}),s.jsx("li",{children:"6px below last message for timestamp"})]})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"BottomNav"}),s.jsx("div",{className:"component-variants",children:s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Bottom Navigation (fixed at bottom)"}),s.jsx("p",{className:"component-variant__note",children:"See bottom of screen - this is a fixed component"})]})})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"MobileHeader"}),s.jsx("div",{className:"component-variants",children:s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Header with Hamburger Menu"}),s.jsx("p",{className:"component-variant__note",children:"See top of page - hamburger icon is in the header (no button styling)"})]})})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"SideMenu"}),s.jsx("div",{className:"component-variants",children:s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Side Menu Drawer"}),s.jsx("p",{className:"component-variant__note",children:"Click hamburger icon in header to open - this is a modal/drawer component"})]})})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"ChatListItem"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Individual Chat"}),s.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",padding:"20px 0"},children:s.jsx(Mg,{name:"First Last",lastMessage:"Last Message",lastMessageTimestamp:new Date,initial:"F",onClick:()=>console.log("Chat clicked"),onDelete:t=>{t.stopPropagation(),console.log("Delete clicked")}})})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Group Chat"}),s.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",padding:"20px 0"},children:s.jsx(Mg,{name:"Group Chat Name",lastMessage:"Last Message",lastMessageTimestamp:new Date,isGroupChat:!0,groupTag:"User Group",initial:"G",onClick:()=>console.log("Group chat clicked"),onDelete:t=>{t.stopPropagation(),console.log("Delete clicked")}})})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Timestamp Examples"}),s.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"12px",padding:"20px 0"},children:[s.jsx(Mg,{name:"Recent (2 hours ago)",lastMessage:"This message was sent 2 hours ago",lastMessageTimestamp:new Date(Date.now()-2*60*60*1e3),initial:"R"}),s.jsx(Mg,{name:"Yesterday",lastMessage:"This message was sent yesterday",lastMessageTimestamp:new Date(Date.now()-2*24*60*60*1e3),initial:"Y"}),s.jsx(Mg,{name:"Last Week",lastMessage:"This message was sent last week",lastMessageTimestamp:new Date(Date.now()-10*24*60*60*1e3),initial:"L"})]})]})]})]}),s.jsx("div",{style:{height:"112px"}})]})})},Yt="https://picsum.photos/400/300?random=1",Ot={id:"demo-user-123",user_id:"demo-user-123",name:"Alex Morgan",username:"alexmorgan",avatar_url:null,bio:"Music lover, concert enthusiast, always looking for the next great show!",instagram_handle:"@alexmorgan",created_at:"2024-01-15T00:00:00Z",is_public_profile:!0,account_type:"user",verified:!1,followers_count:127,following_count:89,reviews_count:23,events_attended:45},ma=[{id:"event-1",title:"Radiohead Live at Madison Square Garden",artist_name:"Radiohead",venue_name:"Madison Square Garden",venue_city:"New York",venue_state:"NY",event_date:"2024-06-15T20:00:00Z",price_range:"$75 - $250",ticket_urls:["https://example.com/tickets"],images:[{url:Yt,width:400,height:300,ratio:"16_9"}],poster_image_url:Yt,description:"An unforgettable night with Radiohead performing their greatest hits.",genres:["Alternative Rock","Electronic"],is_promoted:!1},{id:"event-2",title:"The Weeknd: After Hours Til Dawn Tour",artist_name:"The Weeknd",venue_name:"Barclays Center",venue_city:"Brooklyn",venue_state:"NY",event_date:"2025-03-15T19:30:00Z",price_range:"$100 - $350",ticket_urls:["https://example.com/tickets"],images:[{url:Yt,width:400,height:300,ratio:"16_9"}],poster_image_url:Yt,description:"Experience The Weeknd live with stunning visuals and production.",genres:["R&B","Pop"],is_promoted:!0},{id:"event-3",title:"Arctic Monkeys at Red Rocks",artist_name:"Arctic Monkeys",venue_name:"Red Rocks Amphitheatre",venue_city:"Morrison",venue_state:"CO",event_date:"2024-08-10T20:00:00Z",price_range:"$65 - $180",ticket_urls:["https://example.com/tickets"],images:[],poster_image_url:"https://picsum.photos/400/300?random=3",description:"Arctic Monkeys perform at the iconic Red Rocks venue.",genres:["Indie Rock","Alternative"],is_promoted:!1},{id:"event-4",title:"Billie Eilish: Happier Than Ever Tour",artist_name:"Billie Eilish",venue_name:"Hollywood Bowl",venue_city:"Los Angeles",venue_state:"CA",event_date:"2024-09-05T19:00:00Z",price_range:"$85 - $300",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=4",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=4",description:"Billie Eilish brings her unique sound to the Hollywood Bowl.",genres:["Pop","Alternative"],is_promoted:!1},{id:"event-5",title:"Tame Impala: Slow Rush Tour",artist_name:"Tame Impala",venue_name:"The Fillmore",venue_city:"San Francisco",venue_state:"CA",event_date:"2024-09-15T20:00:00Z",price_range:"$70 - $200",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=5",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=5",description:"Psychedelic rock at its finest with Tame Impala.",genres:["Psychedelic Rock","Indie"],is_promoted:!1},{id:"event-6",title:"Dua Lipa: Future Nostalgia Tour",artist_name:"Dua Lipa",venue_name:"TD Garden",venue_city:"Boston",venue_state:"MA",event_date:"2024-10-01T19:30:00Z",price_range:"$90 - $280",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=6",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=6",description:"Dua Lipa brings her dance-pop hits to Boston.",genres:["Pop","Dance"],is_promoted:!0},{id:"event-7",title:"The Strokes at Forest Hills Stadium",artist_name:"The Strokes",venue_name:"Forest Hills Stadium",venue_city:"Queens",venue_state:"NY",event_date:"2024-10-10T20:00:00Z",price_range:"$60 - $175",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=7",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=7",description:"The Strokes return to New York for an epic show.",genres:["Indie Rock","Alternative"],is_promoted:!1},{id:"event-8",title:"Lana Del Rey: Did You Know Tour",artist_name:"Lana Del Rey",venue_name:"Merriweather Post Pavilion",venue_city:"Columbia",venue_state:"MD",event_date:"2024-10-20T19:00:00Z",price_range:"$75 - $250",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=8",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=8",description:"Lana Del Rey's dreamy vocals in an outdoor setting.",genres:["Pop","Indie"],is_promoted:!1},{id:"event-9",title:"Phoenix: Alpha Zulu Tour",artist_name:"Phoenix",venue_name:"Brooklyn Steel",venue_city:"Brooklyn",venue_state:"NY",event_date:"2024-11-05T20:00:00Z",price_range:"$55 - $150",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=9",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=9",description:"French indie pop at its finest with Phoenix.",genres:["Indie Pop","Electronic"],is_promoted:!1},{id:"event-10",title:"Florence + The Machine: Dance Fever Tour",artist_name:"Florence + The Machine",venue_name:"Radio City Music Hall",venue_city:"New York",venue_state:"NY",event_date:"2024-11-15T20:00:00Z",price_range:"$80 - $220",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=10",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=10",description:"Florence Welch's powerful vocals in an iconic venue.",genres:["Indie Rock","Pop"],is_promoted:!1}],H$=[{id:"artist-radiohead",name:"Radiohead",image_url:Yt,genres:["Alternative Rock","Electronic"]},{id:"artist-theweeknd",name:"The Weeknd",image_url:Yt,genres:["R&B","Pop"]},{id:"artist-arcticmonkeys",name:"Arctic Monkeys",image_url:Yt,genres:["Indie Rock","Alternative"]},{id:"artist-billieeilish",name:"Billie Eilish",image_url:Yt,genres:["Pop","Alternative"]},{id:"artist-taylorswift",name:"Taylor Swift",image_url:Yt,genres:["Pop","Country"]}],G$=[{id:"venue-msg",name:"Madison Square Garden",identifier:"MSG",city:"New York",state:"NY",country:"US",image_url:Yt},{id:"venue-barclays",name:"Barclays Center",identifier:"BARCLAYS",city:"Brooklyn",state:"NY",country:"US",image_url:Yt},{id:"venue-redrocks",name:"Red Rocks Amphitheatre",identifier:"REDROCKS",city:"Morrison",state:"CO",country:"US",image_url:Yt},{id:"venue-hollywoodbowl",name:"Hollywood Bowl",identifier:"HWDBOWL",city:"Los Angeles",state:"CA",country:"US",image_url:Yt},{id:"venue-fillmore",name:"The Fillmore",identifier:"FILLMORESF",city:"San Francisco",state:"CA",country:"US",image_url:Yt}],qu=[{id:"review-1",user_id:Ot.id,event_id:"event-1",rating:5,artist_performance_rating:5,production_rating:4.5,venue_rating:4,location_rating:5,value_rating:4.5,review_text:"Absolutely incredible show! Radiohead delivered an amazing performance. The sound quality was perfect and the setlist was everything I hoped for. The venue was great too, though parking was a bit of a hassle.",artist_performance_feedback:"Thom Yorke was in top form, hitting every note perfectly.",production_feedback:"Lighting and visuals were stunning, really enhanced the experience.",venue_feedback:"Great acoustics, comfortable seating, but parking was expensive.",location_feedback:"Easy to get to via subway, lots of restaurants nearby.",value_feedback:"Worth every penny, would definitely go again.",photos:[Yt,Yt],is_public:!0,is_draft:!1,created_at:"2024-06-16T10:30:00Z",updated_at:"2024-06-16T10:30:00Z",likes_count:42,comments_count:8,shares_count:3,reaction_emoji:"",mood_tags:["energetic","emotional","memorable"],genre_tags:["alternative rock"],review_type:"event",was_there:!0,Event_date:new Date("2024-06-15")},{id:"review-2",user_id:Ot.id,event_id:"event-2",rating:4,artist_performance_rating:4.5,production_rating:5,venue_rating:4.5,location_rating:4,value_rating:3.5,review_text:"The Weeknd put on an amazing show! The production value was off the charts. My only complaint is that tickets were quite expensive, but the experience was worth it.",artist_performance_feedback:"Abel sounded incredible live, even better than the studio recordings.",production_feedback:"Best production I've ever seen - lasers, screens, everything was perfect.",venue_feedback:"Barclays Center is a great venue, good sightlines from everywhere.",location_feedback:"Brooklyn is always fun, lots to do before and after.",value_feedback:"Expensive but you get what you pay for - a top-tier production.",photos:[Yt],is_public:!0,is_draft:!1,created_at:"2024-07-21T14:20:00Z",likes_count:28,comments_count:5,shares_count:1,reaction_emoji:"",mood_tags:["spectacular","high-energy"],genre_tags:["r&b","pop"],review_type:"event",was_there:!0,Event_date:new Date("2024-07-20")},{id:"review-3",user_id:Ot.id,event_id:"event-3",rating:5,artist_performance_rating:5,production_rating:4,venue_rating:5,location_rating:5,value_rating:5,review_text:"Red Rocks is magical. Arctic Monkeys + this venue = perfection. The natural acoustics combined with their performance made for an unforgettable night.",artist_performance_feedback:"Alex Turner and the band were flawless.",production_feedback:"Simple but effective, let the music and venue shine.",venue_feedback:"Red Rocks is the best venue in the world, period.",location_feedback:"Beautiful location, great hiking nearby.",value_feedback:"Best value for money - incredible experience at a reasonable price.",photos:[Yt,Yt,Yt],is_public:!0,is_draft:!1,created_at:"2024-08-11T09:15:00Z",likes_count:67,comments_count:12,shares_count:5,reaction_emoji:"",mood_tags:["magical","peaceful","inspiring"],genre_tags:["indie rock"],review_type:"event",was_there:!0,Event_date:new Date("2024-08-10")},{id:"review-4",user_id:Ot.id,event_id:"event-4",rating:4,artist_performance_rating:null,production_rating:null,venue_rating:4.5,location_rating:4,value_rating:4,review_text:"The Hollywood Bowl is such a beautiful venue. The sound system is incredible and the atmosphere is unbeatable. Great staff too!",artist_performance_feedback:null,production_feedback:null,venue_feedback:"Amazing sound quality, comfortable seating, and helpful staff.",location_feedback:"Easy parking, beautiful location in the hills.",value_feedback:"Good value for such a premium venue experience.",photos:[Yt],is_public:!0,is_draft:!1,created_at:"2024-09-06T11:00:00Z",likes_count:15,comments_count:3,shares_count:1,reaction_emoji:"",mood_tags:["peaceful","beautiful"],genre_tags:[],venue_tags:["great-sound","beautiful-venue"],review_type:"venue",was_there:!0,Event_date:new Date("2024-09-05")},{id:"review-5",user_id:Ot.id,event_id:"event-5",rating:5,artist_performance_rating:5,production_rating:4.5,venue_rating:null,location_rating:null,value_rating:null,review_text:"Tame Impala's performance was absolutely mind-blowing. Kevin Parker's vocals and the band's energy were incredible. One of the best shows I've ever seen.",artist_performance_feedback:"Kevin Parker is a musical genius. The live versions were even better than the albums.",production_feedback:"The light show was mesmerizing and perfectly synced with the music.",venue_feedback:null,location_feedback:null,value_feedback:null,photos:[Yt,Yt],is_public:!0,is_draft:!1,created_at:"2024-09-16T16:30:00Z",likes_count:89,comments_count:15,shares_count:7,reaction_emoji:"",mood_tags:["mind-blowing","trippy","energetic"],genre_tags:["psychedelic rock"],artist_tags:["amazing-performance","great-vocals"],review_type:"artist",was_there:!0,Event_date:new Date("2024-09-15")},{id:"review-6",user_id:Ot.id,event_id:"event-6",rating:4,artist_performance_rating:4.5,production_rating:5,venue_rating:4,location_rating:3.5,value_rating:4,review_text:"Dua Lipa knows how to put on a show! The choreography was incredible and the energy was through the roof. TD Garden is a solid venue.",artist_performance_feedback:"Dua's stage presence is unmatched, and her vocals were spot-on.",production_feedback:"The dance numbers and visuals were top-notch.",venue_feedback:"Good venue, though the sound could be better in the upper levels.",location_feedback:"Boston traffic is always a challenge, but worth it.",value_feedback:"Fair pricing for the production value.",photos:[Yt],is_public:!0,is_draft:!1,created_at:"2024-10-02T12:00:00Z",likes_count:34,comments_count:6,shares_count:2,reaction_emoji:"",mood_tags:["high-energy","fun"],genre_tags:["pop","dance"],review_type:"event",was_there:!0,Event_date:new Date("2024-10-01")},{id:"review-7",user_id:Ot.id,event_id:"event-7",rating:5,artist_performance_rating:5,production_rating:4,venue_rating:4.5,location_rating:4.5,value_rating:4.5,review_text:"The Strokes at Forest Hills was everything I hoped for. Classic songs, great energy, and a perfect summer night.",artist_performance_feedback:"Julian Casablancas sounded amazing, and the band was tight.",production_feedback:"Simple setup that let the music speak for itself.",venue_feedback:"Forest Hills is a great outdoor venue with good sound.",location_feedback:"Queens is accessible and has great food options nearby.",value_feedback:"Great value for such an iconic band.",photos:[Yt,Yt],is_public:!0,is_draft:!1,created_at:"2024-10-11T10:30:00Z",likes_count:52,comments_count:9,shares_count:4,reaction_emoji:"",mood_tags:["nostalgic","energetic"],genre_tags:["indie rock"],review_type:"event",was_there:!0,Event_date:new Date("2024-10-10")},{id:"review-8",user_id:Ot.id,event_id:"event-8",rating:4,artist_performance_rating:4.5,production_rating:4,venue_rating:4.5,location_rating:5,value_rating:4,review_text:"Lana Del Rey's voice is even more beautiful live. The outdoor setting at Merriweather was perfect for her dreamy sound.",artist_performance_feedback:"Lana's vocals were ethereal and captivating.",production_feedback:"Simple but elegant staging that matched the music.",venue_feedback:"Merriweather is a beautiful outdoor venue with great acoustics.",location_feedback:"Beautiful park setting, easy parking, great atmosphere.",value_feedback:"Worth the drive from the city for this experience.",photos:[Yt],is_public:!0,is_draft:!1,created_at:"2024-10-21T14:00:00Z",likes_count:41,comments_count:7,shares_count:3,reaction_emoji:"",mood_tags:["dreamy","peaceful"],genre_tags:["pop","indie"],review_type:"event",was_there:!0,Event_date:new Date("2024-10-20")},{id:"review-9",user_id:Ot.id,event_id:"event-9",rating:4,artist_performance_rating:4.5,production_rating:4.5,venue_rating:4,location_rating:4,value_rating:4.5,review_text:"Phoenix always delivers! Great energy, amazing setlist, and Brooklyn Steel is the perfect venue for their sound.",artist_performance_feedback:"Thomas Mars and the band were on fire.",production_feedback:"Great light show and visuals.",venue_feedback:"Brooklyn Steel has great sound and intimate feel.",location_feedback:"Easy to get to, good food options nearby.",value_feedback:"Excellent value for such a great show.",photos:[Yt],is_public:!0,is_draft:!1,created_at:"2024-11-06T13:15:00Z",likes_count:29,comments_count:5,shares_count:2,reaction_emoji:"",mood_tags:["energetic","fun"],genre_tags:["indie pop"],review_type:"event",was_there:!0,Event_date:new Date("2024-11-05")},{id:"review-10",user_id:Ot.id,event_id:"event-10",rating:5,artist_performance_rating:5,production_rating:4.5,venue_rating:5,location_rating:5,value_rating:4.5,review_text:"Florence Welch is a force of nature. Her voice filled Radio City and the performance was absolutely transcendent.",artist_performance_feedback:"Florence's vocals are otherworldly. She hit every note perfectly.",production_feedback:"Beautiful staging that complemented the music perfectly.",venue_feedback:"Radio City is iconic and the sound was perfect.",location_feedback:"Perfect location in Manhattan, easy to get to.",value_feedback:"Worth every penny for this experience.",photos:[Yt,Yt],is_public:!0,is_draft:!1,created_at:"2024-11-16T11:30:00Z",likes_count:78,comments_count:14,shares_count:6,reaction_emoji:"",mood_tags:["transcendent","emotional","powerful"],genre_tags:["indie rock","pop"],review_type:"event",was_there:!0,Event_date:new Date("2024-11-15")},{id:"review-11",user_id:Ot.id,event_id:"event-1",rating:4,artist_performance_rating:4,production_rating:4.5,venue_rating:4.5,location_rating:4,value_rating:4,review_text:"Second time seeing Radiohead and they never disappoint. The setlist was perfect and the crowd energy was amazing.",artist_performance_feedback:"Great performance, though I wish they played more from OK Computer.",production_feedback:"The visuals were stunning and really enhanced the experience.",venue_feedback:"MSG is always a great venue, though it can get loud.",location_feedback:"Easy to get to, lots of options nearby.",value_feedback:"Good value for such a legendary band.",photos:[Yt],is_public:!0,is_draft:!1,created_at:"2024-06-20T15:00:00Z",likes_count:35,comments_count:6,shares_count:2,reaction_emoji:"",mood_tags:["nostalgic","energetic"],genre_tags:["alternative rock"],review_type:"event",was_there:!0,Event_date:new Date("2024-06-15")},{id:"review-12",user_id:Ot.id,event_id:"event-2",rating:5,artist_performance_rating:5,production_rating:5,venue_rating:4.5,location_rating:4.5,value_rating:4,review_text:"The Weeknd's show was absolutely spectacular. The production was unlike anything I've ever seen. Worth every dollar!",artist_performance_feedback:"Abel's voice is incredible live, even better than recordings.",production_feedback:"The stage design and visuals were mind-blowing.",venue_feedback:"Barclays Center handled the production perfectly.",location_feedback:"Brooklyn has great pre-show spots.",value_feedback:"Expensive but you get a full production experience.",photos:[Yt,Yt],is_public:!0,is_draft:!1,created_at:"2024-07-25T18:00:00Z",likes_count:56,comments_count:10,shares_count:4,reaction_emoji:"",mood_tags:["spectacular","high-energy"],genre_tags:["r&b","pop"],review_type:"event",was_there:!0,Event_date:new Date("2024-07-20")}],Na=[{user_id:"user-sarah-456",name:"Sarah Chen",avatar_url:Yt,username:"sarahchen",is_public_profile:!0,account_type:"user",verified:!1},{user_id:"user-mike-789",name:"Mike Johnson",avatar_url:Yt,username:"mikejohnson",is_public_profile:!0,account_type:"user",verified:!1},{user_id:"user-emma-101",name:"Emma Davis",avatar_url:Yt,username:"emmadavis",is_public_profile:!0,account_type:"user",verified:!1},{user_id:"user-chris-202",name:"Chris Wilson",avatar_url:Yt,username:"chriswilson",is_public_profile:!0,account_type:"user",verified:!1}],Y$=[{id:"chat-1",chat_name:"Sarah Chen",is_group_chat:!1,users:[Ot.id,"user-sarah-456"],latest_message:"Perfect! See you there!",latest_message_created_at:"2024-08-20T15:30:00Z",latest_message_sender_name:"Sarah Chen",created_at:"2024-08-15T10:00:00Z",updated_at:"2024-08-20T15:30:00Z",has_unread:!0,unread_count:2,entity_type:null,entity_id:null,is_verified:!1,member_count:2},{id:"chat-2",chat_name:"Radiohead Fans NYC",is_group_chat:!0,users:[Ot.id,"user-1","user-2","user-3","user-4"],latest_message:"Anyone want to grab drinks before the show?",latest_message_created_at:"2024-08-20T14:15:00Z",latest_message_sender_name:"Mike Johnson",created_at:"2024-07-01T00:00:00Z",updated_at:"2024-08-20T14:15:00Z",has_unread:!1,unread_count:0,entity_type:"event",entity_id:"event-1",is_verified:!0,member_count:5,event_image_url:Yt},{id:"chat-3",chat_name:"Content Showcase",is_group_chat:!0,users:[Ot.id,Na[0].user_id,Na[1].user_id],latest_message:"Check out this venue!",latest_message_created_at:"2024-08-21T16:00:00Z",latest_message_sender_name:Ot.name,created_at:"2024-08-21T10:00:00Z",updated_at:"2024-08-21T16:00:00Z",has_unread:!1,unread_count:0,entity_type:null,entity_id:null,is_verified:!1,member_count:3,event_image_url:null}],iBe={"chat-1":[{id:"msg-1",chat_id:"chat-1",sender_id:"user-sarah-456",sender_name:"Sarah Chen",sender_avatar:null,content:"Hey! Are you going to the Radiohead show next week?",created_at:"2024-08-18T10:00:00Z",message_type:"text"},{id:"msg-2",chat_id:"chat-1",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:null,content:"Yes! I got tickets in section 200. So excited!",created_at:"2024-08-18T10:05:00Z",message_type:"text"},{id:"msg-3",chat_id:"chat-1",sender_id:"user-sarah-456",sender_name:"Sarah Chen",sender_avatar:null,content:"Awesome! I'm in section 150. We should meet up before the show!",created_at:"2024-08-18T10:07:00Z",message_type:"text"},{id:"msg-4",chat_id:"chat-1",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:null,content:"Definitely! There's a great bar right across the street.",created_at:"2024-08-18T10:10:00Z",message_type:"text"},{id:"msg-5",chat_id:"chat-1",sender_id:"user-sarah-456",sender_name:"Sarah Chen",sender_avatar:null,content:"Perfect! See you there!",created_at:"2024-08-20T15:30:00Z",message_type:"text"}],"chat-2":[{id:"msg-6",chat_id:"chat-2",sender_id:"user-1",sender_name:"Mike Johnson",sender_avatar:null,content:"Hey everyone! Who's excited for the Radiohead show?",created_at:"2024-08-19T09:00:00Z",message_type:"text"},{id:"msg-7",chat_id:"chat-2",sender_id:"user-2",sender_name:"Emma Davis",sender_avatar:null,content:"So excited! This will be my first time seeing them live.",created_at:"2024-08-19T09:05:00Z",message_type:"text"},{id:"msg-8",chat_id:"chat-2",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:null,content:"You're in for a treat! I saw them last year and it was incredible.",created_at:"2024-08-19T09:10:00Z",message_type:"text"},{id:"msg-9",chat_id:"chat-2",sender_id:"user-3",sender_name:"Chris Wilson",sender_avatar:null,content:"Does anyone know what time doors open?",created_at:"2024-08-19T10:00:00Z",message_type:"text"},{id:"msg-10",chat_id:"chat-2",sender_id:"user-1",sender_name:"Mike Johnson",sender_avatar:null,content:"I think it's 7pm, but let me check the ticket.",created_at:"2024-08-19T10:05:00Z",message_type:"text"},{id:"msg-11",chat_id:"chat-2",sender_id:"user-1",sender_name:"Mike Johnson",sender_avatar:null,content:"Anyone want to grab drinks before the show?",created_at:"2024-08-20T14:15:00Z",message_type:"text"}],"chat-3":[{id:"msg-12",chat_id:"chat-3",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:Ot.avatar_url,content:"Hey! Check out this review I wrote",created_at:"2024-08-21T10:00:00Z",message_type:"review_share",shared_review_id:qu[0].id,metadata:{custom_message:"Check out this review I wrote"}},{id:"msg-13",chat_id:"chat-3",sender_id:Na[0].user_id,sender_name:Na[0].name,sender_avatar:Na[0].avatar_url,content:"Wow, that sounds amazing! I need to see Radiohead live.",created_at:"2024-08-21T10:05:00Z",message_type:"text"},{id:"msg-14",chat_id:"chat-3",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:Ot.avatar_url,content:"You should! Also, check out this event coming up",created_at:"2024-08-21T10:10:00Z",message_type:"event_share",shared_event_id:ma[1].id,metadata:{custom_message:"You should! Also, check out this event coming up"}},{id:"msg-15",chat_id:"chat-3",sender_id:Na[1].user_id,sender_name:Na[1].name,sender_avatar:Na[1].avatar_url,content:"The Weeknd is one of my favorite artists! Have you seen them live?",created_at:"2024-08-21T10:15:00Z",message_type:"text"},{id:"msg-16",chat_id:"chat-3",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:Ot.avatar_url,content:"Yes! They put on an incredible show. Here's the artist profile",created_at:"2024-08-21T10:20:00Z",message_type:"text",metadata:{shared_artist_id:H$[1].id,shared_artist_name:H$[1].name}},{id:"msg-17",chat_id:"chat-3",sender_id:Na[0].user_id,sender_name:Na[0].name,sender_avatar:Na[0].avatar_url,content:"That venue looks amazing! Where is it?",created_at:"2024-08-21T10:25:00Z",message_type:"text"},{id:"msg-18",chat_id:"chat-3",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:Ot.avatar_url,content:"It's in Brooklyn! Here's the venue",created_at:"2024-08-21T10:30:00Z",message_type:"text",metadata:{shared_venue_id:G$[1].id,shared_venue_name:G$[1].name}},{id:"msg-19",chat_id:"chat-3",sender_id:Na[1].user_id,sender_name:Na[1].name,sender_avatar:Na[1].avatar_url,content:"You should check out @sarahchen's profile, she has great taste in music!",created_at:"2024-08-21T10:35:00Z",message_type:"text",metadata:{shared_user_id:Na[0].user_id,shared_user_name:Na[0].name}},{id:"msg-20",chat_id:"chat-3",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:Ot.avatar_url,content:"Thanks for the recommendation! This group chat is great for sharing music finds.",created_at:"2024-08-21T16:00:00Z",message_type:"text"}]},oBe={users:[{id:"user-sarah-456",user_id:"user-sarah-456",name:"Sarah Chen",username:"sarahchen",avatar_url:null}],artists:[{id:"artist-radiohead",name:"Radiohead",image_url:Yt,jambase_artist_id:"demo-radiohead"}],events:[{id:"event-1",title:"Radiohead Live at Madison Square Garden",artist_name:"Radiohead",venue_name:"Madison Square Garden",venue_city:"New York",venue_state:"NY",event_date:"2024-06-15T20:00:00Z",poster_image_url:Yt}],venues:[{id:"venue-msg",name:"Madison Square Garden",image_url:Yt,city:"New York",state:"NY"}]},K$=[ma[1],ma[3],ma[5],ma[7],ma[9]],lBe=[ma[1],{id:"event-upcoming-1",title:"Phoenix: Alpha Zulu Tour",artist_name:"Phoenix",venue_name:"Brooklyn Steel",venue_city:"Brooklyn",venue_state:"NY",event_date:"2025-04-20T20:00:00Z",price_range:"$55 - $150",ticket_urls:["https://example.com/tickets"],images:[{url:Yt,width:400,height:300,ratio:"16_9"}],poster_image_url:Yt,description:"French indie pop at its finest with Phoenix.",genres:["Indie Pop","Electronic"],is_promoted:!1},{id:"event-upcoming-2",title:"Tame Impala: Slow Rush Tour",artist_name:"Tame Impala",venue_name:"The Fillmore",venue_city:"San Francisco",venue_state:"CA",event_date:"2025-05-10T20:00:00Z",price_range:"$70 - $200",ticket_urls:["https://example.com/tickets"],images:[{url:Yt,width:400,height:300,ratio:"16_9"}],poster_image_url:Yt,description:"Psychedelic rock at its finest with Tame Impala.",genres:["Psychedelic Rock","Indie"],is_promoted:!1},{id:"event-upcoming-3",title:"Arctic Monkeys at Red Rocks",artist_name:"Arctic Monkeys",venue_name:"Red Rocks Amphitheatre",venue_city:"Morrison",venue_state:"CO",event_date:"2025-06-15T20:00:00Z",price_range:"$65 - $180",ticket_urls:["https://example.com/tickets"],images:[{url:Yt,width:400,height:300,ratio:"16_9"}],poster_image_url:Yt,description:"Arctic Monkeys return to the iconic Red Rocks venue.",genres:["Indie Rock","Alternative"],is_promoted:!1}],cBe={user_id:Ot.id,fan_type:"jam_chaser",home_scene_id:null,join_year:2024,calculated_at:"2024-01-15T00:00:00Z",updated_at:"2024-11-20T00:00:00Z",home_scene:null,home_city:"New York"},dBe=[{id:"stamp-1",user_id:Ot.id,type:"city",entity_id:"new-york",entity_uuid:null,entity_name:"New York",unlocked_at:"2024-06-15T20:00:00Z",metadata:{count:15},rarity:"common"},{id:"stamp-2",user_id:Ot.id,type:"city",entity_id:"los-angeles",entity_uuid:null,entity_name:"Los Angeles",unlocked_at:"2024-09-05T19:00:00Z",metadata:{count:8},rarity:"common"},{id:"stamp-3",user_id:Ot.id,type:"venue",entity_id:null,entity_uuid:"venue-msg",entity_name:"Madison Square Garden",unlocked_at:"2024-06-15T20:00:00Z",metadata:{},rarity:"uncommon"},{id:"stamp-4",user_id:Ot.id,type:"venue",entity_id:null,entity_uuid:"venue-redrocks",entity_name:"Red Rocks Amphitheatre",unlocked_at:"2024-08-10T20:00:00Z",metadata:{},rarity:"legendary"},{id:"stamp-5",user_id:Ot.id,type:"artist",entity_id:null,entity_uuid:"artist-radiohead",entity_name:"Radiohead",unlocked_at:"2024-06-15T20:00:00Z",metadata:{},rarity:"uncommon"},{id:"stamp-6",user_id:Ot.id,type:"artist",entity_id:null,entity_uuid:"artist-arcticmonkeys",entity_name:"Arctic Monkeys",unlocked_at:"2024-08-10T20:00:00Z",metadata:{},rarity:"common"}],uBe=[{id:"ach-1",type:"shows_attended",name:"Concert Goer",description:"Attend 10 shows",icon:"",tier:"bronze",progress:45,goal:10,unlocked:!0,unlocked_at:"2024-06-20T00:00:00Z"},{id:"ach-2",type:"cities_visited",name:"World Traveler",description:"Visit 5 different cities",icon:"",tier:"silver",progress:12,goal:5,unlocked:!0,unlocked_at:"2024-08-15T00:00:00Z"},{id:"ach-3",type:"reviews_written",name:"Reviewer",description:"Write 20 reviews",icon:"",tier:"bronze",progress:23,goal:20,unlocked:!0,unlocked_at:"2024-10-01T00:00:00Z"},{id:"ach-4",type:"venues_visited",name:"Venue Explorer",description:"Visit 25 different venues",icon:"",tier:"gold",progress:25,goal:25,unlocked:!0,unlocked_at:"2024-11-15T00:00:00Z"},{id:"ach-5",type:"artists_seen",name:"Music Lover",description:"See 30 different artists",icon:"",tier:"silver",progress:38,goal:30,unlocked:!0,unlocked_at:"2024-09-10T00:00:00Z"},{id:"ach-6",type:"perfect_ratings",name:"Perfectionist",description:"Give 5 perfect 5-star ratings",icon:"",tier:"bronze",progress:3,goal:5,unlocked:!1}],fBe=[{id:"timeline-1",review_id:"review-1",is_pinned:!0,is_auto_selected:!1,significance:"First Radiohead show",description:"My first time seeing Radiohead live - absolutely magical!",Event_name:"Radiohead Live at Madison Square Garden",created_at:"2024-06-16T10:30:00Z",review:{id:"review-1",rating:5,review_text:"Absolutely incredible show! Radiohead delivered an amazing performance.",Event_date:"2024-06-15",event_id:"event-1"}},{id:"timeline-2",review_id:"review-3",is_pinned:!0,is_auto_selected:!1,significance:"Red Rocks milestone",description:"Bucket list venue checked off!",Event_name:"Arctic Monkeys at Red Rocks",created_at:"2024-08-11T09:15:00Z",review:{id:"review-3",rating:5,review_text:"Red Rocks is magical. Arctic Monkeys + this venue = perfection.",Event_date:"2024-08-10",event_id:"event-3"}},{id:"timeline-3",review_id:"review-7",is_pinned:!1,is_auto_selected:!0,significance:null,description:null,Event_name:"Taylor Swift: The Eras Tour",created_at:"2024-10-11T10:00:00Z",review:{id:"review-7",rating:5,review_text:"Taylor Swift's Eras Tour is an absolute spectacle!",Event_date:"2024-10-10",event_id:"event-5"}},{id:"timeline-4",review_id:"review-10",is_pinned:!1,is_auto_selected:!0,significance:null,description:null,Event_name:"Florence + The Machine: Dance Fever Tour",created_at:"2024-11-16T11:30:00Z",review:{id:"review-10",rating:5,review_text:"Florence Welch is a force of nature.",Event_date:"2024-11-15",event_id:"event-10"}},{id:"timeline-5",review_id:"review-2",is_pinned:!1,is_auto_selected:!0,significance:null,description:null,Event_name:"The Weeknd: After Hours Til Dawn Tour",created_at:"2024-07-21T14:20:00Z",review:{id:"review-2",rating:4,review_text:"The Weeknd put on an amazing show! The production value was off the charts.",Event_date:"2024-07-20",event_id:"event-2"}},{id:"timeline-6",review_id:"review-4",is_pinned:!1,is_auto_selected:!0,significance:null,description:null,Event_name:"Madison Square Garden Venue Review",created_at:"2024-03-01T18:00:00Z",review:{id:"review-4",rating:4,review_text:"Madison Square Garden is always a classic. Great atmosphere, but concessions are pricey.",Event_date:"2024-03-01",event_id:null}},{id:"timeline-7",review_id:"review-5",is_pinned:!1,is_auto_selected:!0,significance:null,description:null,Event_name:"Billie Eilish Artist Review",created_at:"2024-04-10T12:00:00Z",review:{id:"review-5",rating:5,review_text:"Billie Eilish is a phenomenal artist. Her stage presence and vocal control are unmatched.",Event_date:"2024-04-10",event_id:null}},{id:"timeline-8",review_id:"review-8",is_pinned:!1,is_auto_selected:!0,significance:null,description:null,Event_name:"Jazz Night at The Blue Note",created_at:"2024-05-26T13:00:00Z",review:{id:"review-8",rating:4,review_text:"The Blue Note always delivers a great jazz experience. Intimate setting, good drinks.",Event_date:"2024-05-25",event_id:"event-6"}}],hBe=[{id:"bucket-1",user_id:Ot.id,entity_type:"artist",entity_id:"artist-taylorswift",entity_name:"Taylor Swift",added_at:"2024-01-20T00:00:00Z",metadata:{},artist:{id:"artist-taylorswift",name:"Taylor Swift",image_url:Yt}},{id:"bucket-2",user_id:Ot.id,entity_type:"venue",entity_id:"venue-carnegie",entity_name:"Carnegie Hall",added_at:"2024-02-15T00:00:00Z",metadata:{},venue:{id:"venue-carnegie",name:"Carnegie Hall",image_url:Yt}},{id:"bucket-3",user_id:Ot.id,entity_type:"artist",entity_id:"artist-beyonce",entity_name:"Beyonc",added_at:"2024-03-10T00:00:00Z",metadata:{},artist:{id:"artist-beyonce",name:"Beyonc",image_url:Yt}},{id:"bucket-4",user_id:Ot.id,entity_type:"venue",entity_id:"venue-msg",entity_name:"Madison Square Garden",added_at:"2024-04-05T00:00:00Z",metadata:{},venue:{id:"venue-msg",name:"Madison Square Garden",image_url:Yt}},{id:"bucket-5",user_id:Ot.id,entity_type:"artist",entity_id:"artist-radiohead",entity_name:"Radiohead",added_at:"2024-05-01T00:00:00Z",metadata:{},artist:{id:"artist-radiohead",name:"Radiohead",image_url:Yt}},{id:"bucket-6",user_id:Ot.id,entity_type:"venue",entity_id:"venue-redrocks",entity_name:"Red Rocks Amphitheatre",added_at:"2024-05-15T00:00:00Z",metadata:{},venue:{id:"venue-redrocks",name:"Red Rocks Amphitheatre",image_url:Yt}},{id:"bucket-7",user_id:Ot.id,entity_type:"artist",entity_id:"artist-arcticmonkeys",entity_name:"Arctic Monkeys",added_at:"2024-06-01T00:00:00Z",metadata:{},artist:{id:"artist-arcticmonkeys",name:"Arctic Monkeys",image_url:Yt}},{id:"bucket-8",user_id:Ot.id,entity_type:"venue",entity_id:"venue-hollywoodbowl",entity_name:"Hollywood Bowl",added_at:"2024-06-20T00:00:00Z",metadata:{},venue:{id:"venue-hollywoodbowl",name:"Hollywood Bowl",image_url:Yt}},{id:"bucket-9",user_id:Ot.id,entity_type:"artist",entity_id:"artist-billieeilish",entity_name:"Billie Eilish",added_at:"2024-07-10T00:00:00Z",metadata:{},artist:{id:"artist-billieeilish",name:"Billie Eilish",image_url:Yt}},{id:"bucket-10",user_id:Ot.id,entity_type:"venue",entity_id:"venue-fillmore",entity_name:"The Fillmore",added_at:"2024-08-01T00:00:00Z",metadata:{},venue:{id:"venue-fillmore",name:"The Fillmore",image_url:Yt}}];qu[0],ma[0],qu[0].created_at,ma[1],qu[1],ma[1],qu[1].created_at;const mBe={id:"artist-radiohead",name:"Radiohead",image_url:Yt,genres:["Alternative Rock","Electronic"]},XS=[{id:"tour-event-1",title:"Radiohead Live at Madison Square Garden",artist_name:"Radiohead",venue_name:"Madison Square Garden",venue_city:"New York",venue_state:"NY",event_date:"2025-03-20T20:00:00Z",latitude:40.7505,longitude:-73.9934,price_range:"$75 - $250",ticket_urls:["https://example.com/tickets"],images:[{url:Yt,width:400,height:300,ratio:"16_9"}],poster_image_url:Yt,description:"Radiohead tour stop in New York",genres:["Alternative Rock","Electronic"]},{id:"tour-event-2",title:"Radiohead at Red Rocks",artist_name:"Radiohead",venue_name:"Red Rocks Amphitheatre",venue_city:"Morrison",venue_state:"CO",event_date:"2025-03-25T20:00:00Z",latitude:39.6654,longitude:-105.2056,price_range:"$65 - $180",ticket_urls:["https://example.com/tickets"],images:[{url:Yt,width:400,height:300,ratio:"16_9"}],poster_image_url:Yt,description:"Radiohead tour stop at Red Rocks",genres:["Alternative Rock","Electronic"]},{id:"tour-event-3",title:"Radiohead at Hollywood Bowl",artist_name:"Radiohead",venue_name:"Hollywood Bowl",venue_city:"Los Angeles",venue_state:"CA",event_date:"2025-04-01T19:00:00Z",latitude:34.1122,longitude:-118.3394,price_range:"$85 - $300",ticket_urls:["https://example.com/tickets"],images:[{url:Yt,width:400,height:300,ratio:"16_9"}],poster_image_url:Yt,description:"Radiohead tour stop in Los Angeles",genres:["Alternative Rock","Electronic"]}],pBe=[{id:"scene-1",name:"NYC Indie Rock Scene",slug:"nyc-indie-rock-scene",description:"The vibrant indie rock scene in New York City",short_description:"Vibrant indie rock in NYC",energy_level:"vibrant",era_start_year:2010,era_end_year:null,cultural_significance:"A thriving scene of independent rock artists",image_url:Yt,scene_url:null,color_theme:"#CC2486",participating_artists:["Radiohead","Arctic Monkeys","The Strokes"],participating_venues:["Madison Square Garden","Barclays Center","Brooklyn Steel"],participating_cities:["New York","Brooklyn"],participating_genres:["Indie Rock","Alternative"],participants:[{id:"p1",participant_type:"artist",artist_id:"artist-radiohead",artist_name:"Radiohead"},{id:"p2",participant_type:"artist",artist_id:"artist-arcticmonkeys",artist_name:"Arctic Monkeys"},{id:"p3",participant_type:"venue",venue_id:"venue-msg",venue_name:"Madison Square Garden"},{id:"p4",participant_type:"venue",venue_id:"venue-barclays",venue_name:"Barclays Center"}],discovery_threshold:3,completion_threshold:8,is_active:!0,is_featured:!0,sort_order:1,metadata:{},created_at:"2024-01-01T00:00:00Z",updated_at:"2024-11-20T00:00:00Z",upcomingEventsCount:5,activeReviewersCount:12,userProgress:{id:"progress-1",user_id:Ot.id,scene_id:"scene-1",discovery_state:"completed",artists_experienced:3,venues_experienced:2,cities_experienced:2,genres_experienced:2,events_experienced:8,progress_percentage:100,discovered_at:"2024-06-01T00:00:00Z",started_at:"2024-06-01T00:00:00Z",completed_at:"2024-10-15T00:00:00Z",last_activity_at:"2024-10-15T00:00:00Z",metadata:{}}},{id:"scene-2",name:"LA Electronic Scene",slug:"la-electronic-scene",description:"The electronic music scene in Los Angeles",short_description:"Electronic beats in LA",energy_level:"intense",era_start_year:2015,era_end_year:null,cultural_significance:"A growing electronic music community",image_url:Yt,scene_url:null,color_theme:"#9D4EDD",participating_artists:["The Weeknd","Billie Eilish","Tame Impala"],participating_venues:["Hollywood Bowl","The Fillmore"],participating_cities:["Los Angeles"],participating_genres:["Electronic","Pop","R&B"],participants:[{id:"p5",participant_type:"artist",artist_id:"artist-theweeknd",artist_name:"The Weeknd"},{id:"p6",participant_type:"artist",artist_id:"artist-billieeilish",artist_name:"Billie Eilish"},{id:"p7",participant_type:"venue",venue_id:"venue-hollywoodbowl",venue_name:"Hollywood Bowl"}],discovery_threshold:2,completion_threshold:6,is_active:!0,is_featured:!0,sort_order:2,metadata:{},created_at:"2024-01-01T00:00:00Z",updated_at:"2024-11-20T00:00:00Z",upcomingEventsCount:3,activeReviewersCount:8,userProgress:{id:"progress-2",user_id:Ot.id,scene_id:"scene-2",discovery_state:"in_progress",artists_experienced:2,venues_experienced:1,cities_experienced:1,genres_experienced:2,events_experienced:4,progress_percentage:67,discovered_at:"2024-08-01T00:00:00Z",started_at:"2024-08-01T00:00:00Z",completed_at:null,last_activity_at:"2024-11-10T00:00:00Z",metadata:{}}}],gBe=({menuOpen:e=!1,onMenuClick:t,onNavigate:r})=>{var _;ts();const[n,a]=y.useState("recommended"),[i,o]=y.useState(null),[l,c]=y.useState(!1),[d,f]=y.useState(!1),u=[{value:"recommended",label:"Hand Picked Events"},{value:"trending",label:"Trending"},{value:"friends",label:"Friends"},{value:"reviews",label:"Reviews"}],h=w=>{const b=ma.find(N=>N.id===w);b&&(o(b),f(!1),c(!0))},m=(w,b)=>E(void 0,null,function*(){console.log("Demo: Toggle interest",w,b),f(b)}),v=(w,b)=>E(void 0,null,function*(){console.log("Demo: Toggle attendance",w,b)}),g=ma.map(w=>({id:w.id,title:w.title,artist_name:w.artist_name,venue_name:w.venue_name,venue_city:w.venue_city,event_date:w.event_date,poster_image_url:w.poster_image_url,images:w.images,price_range:w.price_range,genres:w.genres,interested_count:Math.floor(Math.random()*50),user_is_interested:!1})),x=qu.slice(0,10).map(w=>{const b=ma.find(N=>N.id===w.event_id);return{id:w.id,author:{id:Ot.id,name:Ot.name,avatar_url:void 0},created_at:w.created_at,rating:w.rating,content:w.review_text||void 0,photos:w.photos||void 0,event_info:{artist_name:b==null?void 0:b.artist_name,venue_name:b==null?void 0:b.venue_name,event_date:b==null?void 0:b.event_date}}});return s.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--neutral-50)"},children:[s.jsx(Qo,{menuOpen:e,onMenuClick:t,children:s.jsx("div",{className:"flex justify-center w-full",children:s.jsxs(q1,{children:[s.jsx(V1,{asChild:!0,children:s.jsxs(ce,{variant:"outline",className:"flex items-center gap-2",style:{backgroundColor:"var(--neutral-50)",color:"var(--neutral-900)"},"data-tour":"feed-toggle",children:[s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},children:((_=u.find(w=>w.value===n))==null?void 0:_.label)||"Hand Picked Events"}),s.jsx(Aa,{className:"h-4 w-4",style:{color:"var(--neutral-900)"}})]})}),s.jsx(c0,{className:"",style:{backgroundColor:"var(--neutral-50)"},children:u.map(w=>s.jsx(Yi,{onClick:()=>a(w.value),children:w.label},w.value))})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto",style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:"calc(env(safe-area-inset-top, 0px) + 68px + 12px)",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[n==="recommended"&&s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:g.map((w,b)=>{var C,A,R,I,O,z;let N,S=!1;const k=w.images&&Array.isArray(w.images)&&w.images.length>0;if(w.poster_image_url)if(N=w.poster_image_url,w.id==="event-3")k||(S=!0);else{const M=((C=w.poster_image_url)==null?void 0:C.includes("/storage/v1/object/public/"))||((A=w.poster_image_url)==null?void 0:A.includes("review-photos"))||((R=w.poster_image_url)==null?void 0:R.includes("supabase.co/storage")),B=w.event_media_url&&w.poster_image_url===w.event_media_url,F=((I=w.poster_image_url)==null?void 0:I.includes("/Generic Images/"))||((O=w.poster_image_url)==null?void 0:O.includes("placeholder"))||((z=w.poster_image_url)==null?void 0:z.includes("picsum.photos")),U=k&&w.images.some(H=>(H==null?void 0:H.url)===w.poster_image_url);!k&&M&&!F&&!B&&!U&&(S=!0)}else if(k){const M=w.images.find(B=>(B==null?void 0:B.url)&&((B==null?void 0:B.ratio)==="16_9"||(B==null?void 0:B.width)&&B.width>1e3))||w.images.find(B=>B==null?void 0:B.url);N=M==null?void 0:M.url}return s.jsx(Ll,{event:{id:w.id||"",title:w.title||w.artist_name||"Event",artist_name:w.artist_name,venue_name:w.venue_name,event_date:w.event_date,venue_city:w.venue_city||void 0,image_url:N,poster_image_url:w.poster_image_url||void 0},interestedCount:(w.interested_count||0)+(w.user_is_interested?1:0),isInterested:w.user_is_interested||!1,isCommunityPhoto:S,onClick:()=>h(w.id)},`${w.id}-${b}`)})})}),n==="trending"&&s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:ma.slice(0,12).map(w=>{const b=w.images&&Array.isArray(w.images)&&w.images.length>0,N=w.id==="event-3"&&!b;return s.jsx(Ll,{event:{id:w.id,title:w.title,artist_name:w.artist_name,venue_name:w.venue_name,event_date:w.event_date,venue_city:w.venue_city,image_url:w.poster_image_url,poster_image_url:w.poster_image_url},isCommunityPhoto:N,onClick:()=>h(w.id)},w.id)})})}),n==="friends"&&s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:ma.slice(0,12).map(w=>{const b=w.images&&Array.isArray(w.images)&&w.images.length>0,N=w.id==="event-3"&&!b;return s.jsx(Ll,{event:{id:w.id,title:w.title,artist_name:w.artist_name,venue_name:w.venue_name,event_date:w.event_date,venue_city:w.venue_city,image_url:w.poster_image_url,poster_image_url:w.poster_image_url},isCommunityPhoto:N,onClick:()=>h(w.id)},w.id)})})}),n==="reviews"&&s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"space-y-3",children:x.map(w=>s.jsx(NK,{review:w,onClick:()=>console.log("Demo: Review clicked",w.id)},w.id))})})]}),i&&s.jsx(Hl,{event:i,currentUserId:Ot.id,isOpen:l,onClose:()=>c(!1),onInterestToggle:m,onAttendanceChange:v,isInterested:d,hasReviewed:!1})]})},vBe=e=>ya.divIcon({className:"custom-numbered-marker",html:`
      <div style="
        width: 32px;
        height: 32px;
        background: #ec4899;
        border: 3px solid white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 14px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      ">
        ${e}
      </div>
    `,iconSize:[32,32],iconAnchor:[16,16]}),yBe=({events:e})=>{const t=Rf();return y.useEffect(()=>{if(e.length===0)return;const r=ya.latLngBounds(e.map(n=>[n.latitude,n.longitude]));t.fitBounds(r,{padding:[50,50],maxZoom:10})},[t,e]),null},xBe=({currentUserId:e,filters:t,onNavigateToProfile:r,onNavigateToChat:n})=>{const a=ts(),[i,o]=y.useState("calendar"),[l,c]=y.useState(mBe),[d,f]=y.useState(XS),[u,h]=y.useState(()=>{const F=[...XS].sort((H,q)=>{const K=new Date(H.event_date).getTime(),Z=new Date(q.event_date).getTime();return K-Z}),U=[];for(let H=0;H<F.length-1;H++){const q=F[H],K=F[H+1];q.latitude&&q.longitude&&K.latitude&&K.longitude&&U.push({from:{lat:q.latitude,lng:q.longitude,city:q.venue_city},to:{lat:K.latitude,lng:K.longitude,city:K.venue_city}})}return U});y.useState([]);const[m,v]=y.useState(!1),[g,x]=y.useState(null),[_,w]=y.useState(!1),[b,N]=y.useState(new Date),[S,k]=y.useState(void 0),[C,A]=y.useState([]),R=F=>{k(F),A([])},I=F=>{x(F),w(!0)},O=d.reduce((F,U,H)=>{const q=`${U.latitude},${U.longitude}`;return F[q]||(F[q]={venueKey:q,latitude:U.latitude,longitude:U.longitude,venueName:U.venue_name,city:U.venue_city,number:Object.keys(F).length+1,events:[]}),F[q].events.push(U),F},{}),z=u.map(F=>({from:F.from,to:F.to})),M=[...d].sort((F,U)=>{const H=new Date(F.event_date).getTime(),q=new Date(U.event_date).getTime();return H-q}),B=()=>{if(d.length===0)return[40.7128,-74.006];const F=d.reduce((H,q)=>H+q.latitude,0)/d.length,U=d.reduce((H,q)=>H+q.longitude,0)/d.length;return[F,U]};return s.jsxs("div",{className:"mb-2 space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:"Discover Events"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Discover events by date, leaderboards, or artist tour"})]})}),s.jsxs(zi,{value:i,onValueChange:F=>o(F),children:[s.jsxs(wi,{className:"grid w-full grid-cols-3",children:[s.jsxs(en,{value:"calendar",className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"w-4 h-4"}),"Calendar"]}),s.jsxs(en,{value:"leaderboards",className:"flex items-center gap-2",children:[s.jsx(Vd,{className:"w-4 h-4"}),"Leaderboards"]}),s.jsxs(en,{value:"tour",className:"flex items-center gap-2",children:[s.jsx(Jk,{className:"w-4 h-4"}),"Tour Tracker"]})]}),s.jsx(tn,{value:"calendar",className:"mt-4",children:s.jsxs("div",{className:"space-y-4 flex flex-col items-center justify-center",children:[s.jsx("div",{className:"flex justify-center w-full",children:s.jsx(h0,{mode:"single",selected:S,onSelect:R,month:b,onMonthChange:N,className:"rounded-md border",numberOfMonths:1,disabled:F=>{const U=new Date;U.setHours(0,0,0,0);const H=new Date(F);return H.setHours(0,0,0,0),H<U}})}),S&&C.length===0&&s.jsxs("div",{className:"mt-4 text-center text-muted-foreground",children:[s.jsx("p",{children:"No events found for the selected date."}),s.jsx("p",{className:"text-xs mt-1",children:"Demo mode: Calendar is visible but no events are loaded."})]})]})}),s.jsx(tn,{value:"leaderboards",className:"mt-4",children:s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(Vd,{className:"w-12 h-12 mx-auto text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Leaderboards are still in development"})]})})}),s.jsx(tn,{value:"tour",className:"mt-4",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search for an Artist"}),s.jsx(b1,{onArtistSelect:F=>{c(F),f(XS)},placeholder:"Search for an artist to track their tour..."})]}),l&&s.jsx(Ze,{className:"overflow-hidden border-2 border-synth-pink/20 shadow-lg cursor-pointer hover:shadow-xl transition-shadow",onClick:()=>{const F=l.id||encodeURIComponent(l.name);a(`/artist/${F}`)},children:s.jsx("div",{className:"relative p-6",style:{background:"linear-gradient(135deg, rgba(255, 51, 153, 0.1) 0%, rgba(255, 51, 153, 0.05) 100%)"},children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:l.image_url?s.jsx("img",{src:l.image_url,alt:l.name,className:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-lg"}):s.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-synth-pink to-purple-500 flex items-center justify-center border-4 border-white shadow-lg",children:s.jsx(Ft,{className:"w-12 h-12 text-white"})})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2 truncate",children:l.name}),s.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[d.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"w-4 h-4 text-synth-pink"}),s.jsxs("span",{className:"text-sm font-medium text-foreground",children:[d.length," ",d.length===1?"Tour Date":"Tour Dates"]})]}),l.genres&&l.genres.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ft,{className:"w-4 h-4 text-synth-pink"}),s.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[l.genres.slice(0,3).map((F,U)=>s.jsx(et,{variant:"secondary",className:"text-xs bg-white/80 text-foreground border-synth-pink/20",children:F},U)),l.genres.length>3&&s.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",l.genres.length-3," more"]})]})]})]})]}),s.jsx(ce,{variant:"ghost",size:"sm",onClick:F=>{F.stopPropagation(),c(null),f([]),h([])},className:"flex-shrink-0 text-muted-foreground hover:text-foreground",children:s.jsx(Yr,{className:"w-4 h-4"})})]})})]})})}),m?s.jsx(Nc,{text:"Loading tour data...",size:"lg"}):l&&d.length>0?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"h-96 rounded-lg overflow-hidden border relative z-0",children:s.jsxs(a0,{center:B(),zoom:5,style:{height:"100%",width:"100%",zIndex:0},boundsOptions:{padding:[50,50]},children:[s.jsx(i0,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(yBe,{events:M}),z.map((F,U)=>{const H=F.from.lat,q=F.from.lng,K=F.to.lat,Z=F.to.lng,ne=K-H,Y=Z-q,X=H+ne*.85,se=q+Y*.85,xe=`
                        <svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
                          <g transform="translate(10,10) rotate(${Math.atan2(ne,Y)*180/Math.PI}) translate(-10,-10)">
                            <polygon points="10,2 4,16 16,16" fill="#ec4899" stroke="white" stroke-width="1.5"/>
                          </g>
                        </svg>
                      `;return s.jsxs(te.Fragment,{children:[s.jsx(oU,{positions:[[H,q],[K,Z]],pathOptions:{color:"#ec4899",weight:3,opacity:.7}}),s.jsx(gf,{position:[X,se],icon:ya.divIcon({className:"arrowhead-marker",html:xe,iconSize:[20,20],iconAnchor:[10,10]})})]},U)}),Object.values(O).map(F=>s.jsx(gf,{position:[F.latitude,F.longitude],icon:vBe(F.number),eventHandlers:{click:()=>{F.events.length>0&&I(F.events[0])}}},`${F.venueKey}-${F.number}`))]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Tour Dates"}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:M.map(F=>s.jsx(Ze,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>I(F),children:s.jsx(tt,{className:"p-4",children:s.jsx("div",{className:"flex items-start justify-between gap-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold mb-1",children:F.title}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-2",children:[s.jsx(yr,{className:"w-4 h-4"}),s.jsxs("span",{children:[F.venue_name,", ",F.venue_city]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:Rt(new Date(F.event_date),"EEEE, MMMM d, yyyy  h:mm a")})]})})})},F.id))})]})]}):s.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[s.jsx(Jk,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Select an artist to see their tour dates on the map"})]})]})})]}),s.jsx(vn,{open:_,onOpenChange:w,children:s.jsx(hn,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:g&&s.jsx(U5,{event:g,currentUserId:e,onClose:()=>w(!1)})})})]})},_Be=({menuOpen:e=!1,onMenuClick:t,onNavigate:r})=>{ts();const[n,a]=y.useState(""),[i,o]=y.useState(!1),[l,c]=y.useState(!1),[d,f]=y.useState(null),u=v=>{f(v),console.log("Demo: Vibe selected",v)},h=oBe,m={radiusMiles:30,latitude:40.7128,longitude:-74.006};return s.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--neutral-50)"},children:[s.jsx(Qo,{menuOpen:e,onMenuClick:t,children:s.jsx("div",{style:{display:"flex",alignItems:"center",gap:"6px",width:"100%",maxWidth:"100%"},children:s.jsx(Ai,{value:n,onChange:v=>{a(v),o(v.trim().length>=2)},placeholder:'Try "Radiohead"',widthVariant:"flex"})})}),s.jsxs("div",{className:"max-w-7xl mx-auto space-y-2",style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:"calc(env(safe-area-inset-top, 0px) + 68px + 12px)",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[s.jsxs("div",{className:"mb-2 flex items-center gap-2 flex-wrap overflow-x-auto pt-4",children:[s.jsxs(ce,{className:"bg-synth-pink hover:bg-synth-pink/90 gap-2 flex-shrink-0",style:{color:"var(--color-off-white, #FCFCFC)"},size:"sm",onClick:()=>c(!0),"data-tour":"discover-vibes",children:[s.jsx(Fl,{className:"h-4 w-4"}),"Browse Vibes"]}),s.jsxs(ce,{variant:"outline",size:"sm",className:"gap-2 flex-shrink-0",children:[s.jsx(yr,{className:"h-4 w-4"}),"Location"]})]}),i&&s.jsxs("div",{className:"space-y-4 pt-4",children:[h.users.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-[#0e0e0e] mb-3",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)"},children:"Users"}),s.jsx("div",{className:"space-y-2",children:h.users.map(v=>s.jsx(Ze,{className:"cursor-pointer hover:bg-gray-50",children:s.jsxs(tt,{className:"p-3 flex items-center gap-3",children:[s.jsx(Wr,{className:"w-10 h-10",children:s.jsx(Hr,{className:"bg-synth-beige/50",children:v.name.split(" ").map(g=>g[0]).join("")})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-[#0e0e0e]",children:v.name}),v.username&&s.jsxs("p",{className:"text-[#5d646f]",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:["@",v.username]})]})]})},v.id))})]}),h.artists.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-[#0e0e0e] mb-3",children:"Artists"}),s.jsx("div",{className:"space-y-2",children:h.artists.map(v=>s.jsx(Ze,{className:"cursor-pointer hover:bg-gray-50",children:s.jsxs(tt,{className:"p-3 flex items-center gap-3",children:[s.jsxs(Wr,{className:"w-10 h-10",children:[s.jsx(Qr,{src:v.image_url||void 0}),s.jsx(Hr,{className:"bg-synth-beige/50",children:v.name.substring(0,2).toUpperCase()})]}),s.jsx("div",{children:s.jsx("p",{className:"font-semibold text-[#0e0e0e]",children:v.name})})]})},v.id))})]}),h.events.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-[#0e0e0e] mb-3",children:"Events"}),s.jsx("div",{className:"grid grid-cols-2 gap-3",children:h.events.map(v=>s.jsx(Ll,{event:v,interestedCount:Math.floor(Math.random()*50),isInterested:!1,onClick:()=>console.log("Demo: Event clicked",v.id)},v.id))})]}),h.venues.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-[#0e0e0e] mb-3",children:"Venues"}),s.jsx("div",{className:"space-y-2",children:h.venues.map(v=>s.jsx(Ze,{className:"cursor-pointer hover:bg-gray-50",children:s.jsxs(tt,{className:"p-3 flex items-center gap-3",children:[s.jsxs(Wr,{className:"w-10 h-10",children:[s.jsx(Qr,{src:v.image_url||void 0}),s.jsx(Hr,{className:"bg-synth-beige/50",children:v.name.substring(0,2).toUpperCase()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-[#0e0e0e]",children:v.name}),s.jsxs("p",{className:"text-[#5d646f]",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[v.city,", ",v.state]})]})]})},v.id))})]})]}),!i&&s.jsxs(s.Fragment,{children:[s.jsx(xBe,{currentUserId:Ot.id,filters:m,onNavigateToProfile:v=>console.log("Demo: Navigate to profile",v),onNavigateToChat:v=>console.log("Demo: Navigate to chat",v)}),s.jsx("div",{className:"mt-8",children:s.jsx(zj,{title:"Scenes & Signals",description:"Music scenes defined by genre overlap, venue clusters, and co-attendance patterns",items:pBe.map(v=>s.jsx(wK,{scene:v,onClick:()=>console.log("Demo: Scene clicked",v.id)},v.id)),loading:!1,emptyMessage:"No scenes found",itemClassName:"w-[320px]"})})]})]}),s.jsx(_K,{isOpen:l,onClose:()=>c(!1),onSelectVibe:u,isMobile:!0})]})},wBe=({posts:e,onPostClick:t})=>{const r=n=>Array.from({length:5},(a,i)=>{const o=i+1,l=n>=o,c=!l&&n>=o-.5;return s.jsxs("div",{className:"relative w-3 h-3",children:[s.jsx(Xt,{className:`w-3 h-3 ${l?"text-yellow-400 fill-current":"text-gray-300"}`}),c&&s.jsx("div",{className:"absolute inset-0 overflow-hidden",style:{width:"50%"},children:s.jsx(Xt,{className:"w-3 h-3 text-yellow-400 fill-current"})})]},i)});return e.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ft,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-muted-foreground mb-2",children:"No Posts Yet"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Start attending events and writing reviews to build your profile!"})]}):s.jsx("div",{className:"grid grid-cols-3 gap-1 md:gap-2",children:e.map(n=>{const a=!!n.image,i=n.image||gA(`${n.id}-${n.title}-${n.date}`);return s.jsx(Ze,{className:"aspect-square cursor-pointer hover:shadow-md transition-shadow overflow-hidden",onClick:()=>t(n),children:s.jsxs(tt,{className:"p-0 h-full relative",children:[s.jsxs("div",{className:"relative w-full h-2/3 overflow-hidden",children:[s.jsx("img",{src:i,alt:n.title,className:`w-full h-full object-cover transition-transform duration-500 ${a?"":"scale-105"}`,loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/10 to-transparent","aria-hidden":"true"}),s.jsx("div",{className:"absolute top-2 right-2",children:n.badge&&s.jsx(et,{variant:"secondary",className:"text-xs",children:n.badge})})]}),s.jsxs("div",{className:"p-2 h-1/3 flex flex-col justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-xs truncate",children:n.title}),s.jsx("p",{className:"text-xs text-muted-foreground truncate",children:n.subtitle})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"w-3 h-3"}),s.jsx("span",{children:Rt(new Date(n.date),"MMM d, yyyy")})]}),n.type==="review"&&typeof n.rating=="number"&&s.jsx("div",{className:"flex items-center gap-0.5",children:r(n.rating)}),(n.likes||n.comments)&&s.jsxs("div",{className:"flex items-center gap-2",children:[n.likes&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(es,{className:"w-3 h-3"}),s.jsx("span",{children:n.likes})]}),n.comments&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ln,{className:"w-3 h-3"}),s.jsx("span",{children:n.comments})]})]})]})]})]})},n.id)})})},bBe=({isOpen:e,onClose:t,userId:r,userName:n,inline:a=!1,identity:i,stamps:o=[],achievements:l=[],timeline:c=[],bucketList:d=[]})=>{const[f,u]=y.useState("identity");if(!e&&!a)return null;const h=s.jsxs(s.Fragment,{children:[a&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold gradient-text",children:"Live Music Passport"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your curated, earned, and evolving snapshot of your live-music journey"})]}),s.jsxs(zi,{value:f,onValueChange:m=>u(m),className:`${a?"":"mt-4"} w-full max-w-full overflow-x-hidden`,children:[s.jsxs(wi,{className:"grid w-full max-w-full grid-cols-5 gap-0.5 p-0.5 overflow-x-hidden",children:[s.jsxs(en,{value:"identity",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(Is,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Identity"})]}),s.jsxs(en,{value:"stamps",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(Fl,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Stamps"})]}),s.jsxs(en,{value:"achievements",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(Mc,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Achievements"})]}),s.jsxs(en,{value:"timeline",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(Oa,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Timeline"})]}),s.jsxs(en,{value:"bucket",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(QQ,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Bucket List"})]})]}),s.jsx(tn,{value:"identity",className:"mt-4",children:i?s.jsx(Ze,{className:"border-2 border-synth-pink/20 bg-gradient-to-br from-white to-pink-50/30",children:s.jsxs(tt,{className:"p-6 space-y-4",children:[s.jsx(et,{variant:"secondary",className:"text-base px-4 py-2 bg-synth-pink/10 text-synth-pink border-synth-pink/30",children:i.fan_type==="jam_chaser"?"Jam Chaser":i.fan_type==="venue_purist"?"Venue Purist":i.fan_type==="scene_builder"?"Scene Builder":i.fan_type==="road_tripper"?"Road Tripper":i.fan_type==="genre_explorer"?"Genre Explorer":i.fan_type==="festival_fanatic"?"Festival Fanatic":"Music Lover"}),s.jsxs("div",{className:"text-sm space-y-2",children:[s.jsxs("p",{className:"font-medium",children:["Live since ",i.join_year]}),i.home_city&&s.jsxs("p",{className:"text-muted-foreground",children:["Home: ",i.home_city]})]})]})}):s.jsx(P7,{userId:r,userName:n})}),s.jsx(tn,{value:"stamps",className:"mt-4",children:s.jsx(T7,{stamps:o,achievements:l,loading:!1})}),s.jsx(tn,{value:"achievements",className:"mt-4 w-full max-w-full overflow-x-hidden",children:l.length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx("p",{children:"No achievements unlocked yet."}),s.jsx("p",{className:"text-xs mt-1",children:"Keep attending events and writing reviews to unlock achievements!"})]}):s.jsx("div",{className:"space-y-4",children:l.map(m=>s.jsx(Ze,{children:s.jsx(tt,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"text-3xl",children:m.icon}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"font-semibold",children:m.name}),m.tier&&s.jsx(et,{variant:m.tier==="gold"?"default":"secondary",children:m.tier})]}),s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:m.description}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{children:"Progress"}),s.jsxs("span",{children:[m.progress," / ",m.goal]})]}),s.jsx(Jv,{value:m.progress/m.goal*100,className:"h-2"})]})]})]})})},m.id||m.type))})}),s.jsx(tn,{value:"timeline",className:"mt-4",children:s.jsx(A7,{userId:r})}),s.jsx(tn,{value:"bucket",className:"mt-4",children:s.jsx(R7,{userId:r})})]})]});return a?h:s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsx("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:h})})},jBe=({menuOpen:e=!1,onMenuClick:t,onNavigate:r})=>{ts();const[n,a]=y.useState("my-events"),[i,o]=y.useState(!1),l=qu.map(d=>{const f=ma.find(h=>h.id===d.event_id),u=d.photos&&d.photos.length>0?d.photos[0]:void 0;return{id:d.id,type:"review",image:u,images:d.photos,title:(f==null?void 0:f.title)||"Event Review",subtitle:f?`${f.artist_name} at ${f.venue_name}`:"Concert Review",rating:d.rating,date:d.created_at,location:(f==null?void 0:f.venue_city)||void 0,likes:d.likes_count,comments:d.comments_count}}),c=i?K$.filter(d=>new Date(d.event_date)<new Date):lBe;return s.jsxs("div",{className:"min-h-screen w-full max-w-[393px] mx-auto overflow-x-hidden",style:{backgroundColor:"var(--neutral-50)"},children:[s.jsx(Qo,{menuOpen:e,onMenuClick:t,children:s.jsx("h1",{className:"font-bold truncate text-center",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--color-off-black, #0E0E0E)"},children:`@${Ot.username}`})}),s.jsxs("div",{className:"px-5",style:{paddingTop:"calc(env(safe-area-inset-top, 0px) + 68px + 12px)",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[s.jsx("div",{className:"mb-6 bg-gradient-to-br from-white via-pink-50/30 to-purple-50/20 p-4 sm:p-6 border border-pink-100/50 shadow-sm relative overflow-hidden w-full max-w-full",style:{borderRadius:"10px"},children:s.jsxs("div",{className:"flex flex-col items-center gap-4 mb-4 w-full max-w-full",children:[s.jsxs("div",{className:"flex items-center gap-3 w-full justify-center",children:[s.jsx("div",{className:"relative",children:s.jsxs(Wr,{className:"w-20 h-20 sm:w-24 sm:h-24 ring-4 ring-white shadow-lg",children:[s.jsx(Qr,{src:void 0}),s.jsx(Hr,{className:"text-3xl font-bold bg-gradient-to-br from-pink-500 to-purple-600",style:{color:"var(--color-off-white, #FCFCFC)"},children:Ot.name.charAt(0).toUpperCase()})]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h1",{className:"font-bold",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--color-off-black, #0E0E0E)"},children:Ot.name}),Ot.verified]})]}),s.jsxs("div",{className:"w-full max-w-full",children:[s.jsxs("div",{className:"flex items-center justify-center gap-6 mb-4 w-full max-w-full",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)"},children:Ot.followers_count}),s.jsx("p",{className:"font-medium",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--color-dark-grey, #5D646F)"},children:"Friends"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)"},children:Ot.reviews_count}),s.jsx("p",{className:"text-gray-600 font-medium",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:"Reviews"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)"},children:Ot.following_count}),s.jsx("p",{className:"text-gray-600 font-medium",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:"Following"})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full max-w-full justify-center",children:[s.jsxs(ce,{variant:"default",size:"sm",className:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 shadow-md",style:{color:"var(--color-off-white, #FCFCFC)"},children:[s.jsx(Ol,{className:"w-4 h-4 mr-2"}),"Edit Profile"]}),s.jsx(ce,{variant:"outline",size:"sm",style:{borderColor:"var(--color-light-grey, #C9C9C9)"},children:s.jsx(FP,{className:"w-4 h-4"})})]})]})]})}),s.jsxs(zi,{value:n,onValueChange:a,className:"w-full",children:[s.jsxs(wi,{className:"grid w-full grid-cols-3",children:[s.jsx(en,{value:"my-events",children:"My Events"}),s.jsx(en,{value:"interested",children:"Interested"}),s.jsx(en,{value:"passport",children:"Passport"})]}),s.jsx(tn,{value:"my-events",className:"mt-4 w-full max-w-full overflow-x-hidden",children:s.jsx(wBe,{posts:l,onPostClick:d=>console.log("Demo: Post clicked",d.id)})}),s.jsxs(tn,{value:"interested",className:"mt-4 w-full max-w-full overflow-x-hidden",children:[K$.length>0&&s.jsx("div",{className:"flex justify-center mb-4 w-full max-w-full",children:s.jsxs("div",{className:"bg-gray-100 p-1 flex w-full max-w-full",style:{borderRadius:"10px"},children:[s.jsx("button",{onClick:()=>o(!1),className:`px-4 py-2 font-medium transition-colors ${i?"":"shadow-sm"}`,children:"Upcoming"}),s.jsx("button",{onClick:()=>o(!0),className:`px-4 py-2 font-medium transition-colors ${i?"shadow-sm":""}`,style:{borderRadius:"10px"},children:"Past"})]})}),c.length===0?s.jsxs("div",{className:"flex flex-col gap-[6px] items-center justify-center py-12",style:{borderRadius:"10px",backgroundColor:"var(--color-off-white, #FCFCFC)"},children:[s.jsx(es,{className:"w-[60px] h-[60px] mx-auto",style:{color:"var(--color-dark-grey, #5D646F)"}}),s.jsxs("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:["No ",i?"Past":"Upcoming"," Events Yet"]}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Tap the heart on events to add them here."})]}):s.jsx("div",{className:"grid grid-cols-2 gap-3",children:c.map(d=>s.jsx(Ll,{event:d,interestedCount:Math.floor(Math.random()*50),isInterested:!0,onClick:()=>console.log("Demo: Event clicked",d.id)},d.id))})]}),s.jsx(tn,{value:"passport",className:"mt-4 mb-32 w-full max-w-full overflow-x-hidden",children:s.jsx(bBe,{isOpen:!0,onClose:()=>a("my-events"),userId:Ot.id,userName:Ot.name,inline:!0,identity:cBe,stamps:dBe,achievements:uBe,timeline:fBe,bucketList:hBe})})]})]})]})},NBe=({menuOpen:e=!1,onMenuClick:t,onNavigate:r})=>{const n=ts(),[a,i]=y.useState(null),[o,l]=y.useState(""),c=a?Y$.find(v=>v.id===a):null,d=a?iBe[a]||[]:[],f=()=>{a?i(null):r?r("home"):n("/mobile-preview/component-view")},u=v=>cde(v)?s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{fontWeight:700},children:"Today"})," ",s.jsxs("span",{style:{fontWeight:500},children:["at ",Rt(v,"h:mm a")]})]}):ude(v)?s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{fontWeight:700},children:"Yesterday"})," ",s.jsxs("span",{style:{fontWeight:500},children:["at ",Rt(v,"h:mm a")]})]}):lde(v,{weekStartsOn:0})?s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{fontWeight:700},children:Rt(v,"EEEE")})," ",s.jsxs("span",{style:{fontWeight:500},children:["at ",Rt(v,"h:mm a")]})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{fontWeight:700},children:Rt(v,"MMM d")})," ",s.jsxs("span",{style:{fontWeight:500},children:["at ",Rt(v,"h:mm a")]})]});if(!c)return s.jsx("div",{className:"flex min-h-screen w-full max-w-[393px] mx-auto",style:{backgroundColor:"var(--color-off-white, #FCFCFC)"},children:s.jsxs("div",{className:"w-full border-synth-black/10 backdrop-blur-md flex flex-col shadow-2xl",style:{backgroundColor:"rgba(252, 252, 252, 0.98)"},children:[s.jsx(Qo,{menuOpen:e,onMenuClick:t,children:s.jsx("h1",{className:"font-bold text-[24px] text-[#0e0e0e] leading-[normal]",children:"Messages"})}),s.jsx("div",{className:"flex-1 overflow-y-auto px-5",style:{paddingTop:"calc(env(safe-area-inset-top, 0px) + 68px + 12px)",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:s.jsx("div",{className:"space-y-2",children:Y$.map(v=>s.jsxs("div",{onClick:()=>i(v.id),className:"flex items-center gap-3 p-3 hover:bg-gray-50 cursor-pointer",style:{borderRadius:"10px"},children:[s.jsxs(Wr,{className:"w-12 h-12",children:[s.jsx(Qr,{src:v.event_image_url||void 0}),s.jsx(Hr,{className:"bg-synth-beige/50",children:v.is_group_chat?s.jsx(Vr,{className:"w-6 h-6 text-synth-black"}):v.chat_name.split(" ").map(g=>g[0]).join("").substring(0,2)})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h3",{className:"font-semibold text-[#0e0e0e] truncate",children:v.chat_name}),v.latest_message_created_at&&s.jsx("span",{className:"text-[#5d646f] flex-shrink-0 ml-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:Rt(gs(v.latest_message_created_at),"h:mm a")})]}),s.jsx("p",{className:"text-[#5d646f] truncate",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:v.latest_message})]}),v.has_unread&&s.jsx("div",{className:"w-2 h-2 bg-synth-pink rounded-full flex-shrink-0"})]},v.id))})})]})});const h=[];let m=[];return d.forEach((v,g)=>{const x=gs(v.created_at),_=g>0?d[g-1]:null,w=_?gs(_.created_at):null,b=_&&_.sender_id!==v.sender_id,N=w&&C2(x,w)>=30;b||N?(m.length>0&&h.push(m),m=[v]):m.push(v)}),m.length>0&&h.push(m),s.jsx("div",{className:"flex min-h-screen w-full max-w-[393px] mx-auto",style:{backgroundColor:"var(--color-off-white, #FCFCFC)"},children:s.jsxs("div",{className:"w-full flex flex-col min-h-0",style:{backgroundColor:"var(--color-off-white, #FCFCFC)"},children:[s.jsx(Qo,{menuOpen:e,onMenuClick:t,children:s.jsxs("div",{className:"flex items-center gap-[6px]",children:[s.jsx("button",{onClick:f,className:"w-6 h-6 flex items-center justify-center cursor-pointer",children:s.jsx(ks,{className:"w-6 h-6 text-[#0e0e0e]"})}),s.jsxs(Wr,{className:"w-8 h-8 flex-shrink-0",children:[s.jsx(Qr,{src:c.event_image_url||void 0}),s.jsx(Hr,{className:"bg-synth-beige/50 text-synth-black font-medium",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)"},children:c.is_group_chat?s.jsx(Vr,{className:"w-5 h-5"}):c.chat_name.split(" ").map(v=>v[0]).join("")})]}),s.jsx("h2",{className:"font-bold text-[24px] text-[#0e0e0e] leading-[normal]",children:c.chat_name})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto px-5",style:{paddingTop:"calc(env(safe-area-inset-top, 0px) + 68px + 12px)",paddingBottom:"var(--spacing-bottom-nav, 112px)",backgroundColor:"var(--color-off-white, #FCFCFC)"},children:s.jsx("div",{className:"flex flex-col",style:{maxWidth:"353px",margin:"0 auto"},children:h.map((v,g)=>{const x=v[0];v[v.length-1];const _=x.sender_id===Ot.id,w=gs(x.created_at),b=g===0||g>0&&C2(w,gs(h[g-1][h[g-1].length-1].created_at))>=30,N=c.is_group_chat&&x.sender_id!==Ot.id&&(g===0||h[g-1][0].sender_id!==x.sender_id);return s.jsxs("div",{className:`flex flex-col ${_?"items-end":"items-start"} ${g>0?"mt-[24px]":""}`,children:[b&&s.jsx("div",{className:"flex justify-center w-full mb-[24px]",children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"#5D646F",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:u(w)})}),N&&s.jsx("div",{className:"flex items-center gap-[6px]",style:{marginBottom:"6px"},children:s.jsx(fc,{name:x.sender_name,initial:x.sender_name.split(" ").map(S=>S[0]).join(""),imageUrl:x.sender_avatar||void 0,variant:"chat"})}),v.map((S,k)=>{const C=k===v.length-1;return s.jsxs("div",{className:`flex flex-col ${k>0?"mt-[6px]":""}`,children:[s.jsx("div",{className:"max-w-[172px] p-[12px]",style:{borderRadius:"10px",backgroundColor:S.sender_id===Ot.id?"var(--brand-pink-500)":"var(--state-disabled-bg)",border:S.sender_id===Ot.id?"none":"1px solid var(--neutral-200)"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",margin:0,color:S.sender_id===Ot.id?"var(--neutral-50)":"var(--neutral-900)"},children:S.content})}),C&&s.jsx("p",{className:`text-[16px] text-[var(--neutral-600)] font-normal leading-[normal] mt-[6px] ${_?"text-right":"text-left"}`,children:Rt(gs(S.created_at),"h:mm a")})]},S.id)})]},`group-${g}`)})})}),!c.is_group_chat&&s.jsx("div",{className:"border-t px-5 py-3",style:{borderColor:"var(--neutral-200)",backgroundColor:"var(--neutral-50)"},children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Nr,{value:o,onChange:v=>l(v.target.value),placeholder:"Type a message...",className:"flex-1",onKeyPress:v=>{v.key==="Enter"&&o.trim()&&(console.log("Demo: Send message",o),l(""))}}),s.jsx("button",{onClick:()=>{o.trim()&&(console.log("Demo: Send message",o),l(""))},className:"w-10 h-10 flex items-center justify-center bg-synth-pink",style:{borderRadius:"10px",color:"var(--neutral-50)"},children:s.jsx(qc,{className:"w-5 h-5"})})]})})]})})},SBe=({menuOpen:e=!1,onMenuClick:t,onNavigate:r})=>{const n=ts(),[a,i]=y.useState(!0),o=ma[0],l=()=>{r?r("home"):n("/mobile-preview/component-view")},c=()=>{i(!1),l()},d=()=>{console.log("Demo: Review submitted (no-op in demo mode)"),c()};return s.jsxs("div",{className:"min-h-screen bg-[#fcfcfc]",children:[s.jsx(Qo,{menuOpen:e,onMenuClick:t,children:s.jsx("h1",{className:"font-bold text-[24px] text-[#0e0e0e] leading-[normal]",children:"Create Review"})}),s.jsx(k7,{event:o,userId:Ot.id,isOpen:a,onClose:c,onReviewSubmitted:d})]})},kBe=()=>{const[e,t]=te.useState(!1);B9(e);const r=()=>{t(!e)},n=()=>{t(!1)};return s.jsxs("div",{className:"mobile-preview",children:[s.jsx(Qo,{menuOpen:e,onMenuClick:r}),s.jsx("main",{className:"mobile-preview__content",children:s.jsxs(m9,{children:[s.jsx(As,{index:!0,element:s.jsx(jse,{to:"component-view",replace:!0})}),s.jsx(As,{path:"component-view",element:s.jsx(kK,{})}),s.jsx(As,{path:"demo/home",element:s.jsx(gBe,{menuOpen:e,onMenuClick:r})}),s.jsx(As,{path:"demo/discover",element:s.jsx(_Be,{menuOpen:e,onMenuClick:r})}),s.jsx(As,{path:"demo/profile",element:s.jsx(jBe,{menuOpen:e,onMenuClick:r})}),s.jsx(As,{path:"demo/messages",element:s.jsx(NBe,{menuOpen:e,onMenuClick:r})}),s.jsx(As,{path:"demo/create-post",element:s.jsx(SBe,{menuOpen:e,onMenuClick:r})})]})}),s.jsx(nBe,{}),s.jsx(z9,{isOpen:e,onClose:n,onToggle:r})]})};function EBe(){const[e,t]=y.useState(""),[r,n]=y.useState(""),[a,i]=y.useState(!1),[o,l]=y.useState(null),c=ts(),d=Vc(),{toast:f}=Er();y.useEffect(()=>{const h=new URLSearchParams(d.hash.substring(1)),m=h.get("access_token"),v=h.get("type");l(!!(m&&v==="recovery"))},[d]);const u=h=>E(this,null,function*(){if(h.preventDefault(),e!==r){f({title:"Passwords do not match",description:"Please make sure both passwords are the same.",variant:"destructive"});return}if(e.length<6){f({title:"Password too short",description:"Password must be at least 6 characters long.",variant:"destructive"});return}i(!0);try{const{error:m}=yield T.auth.updateUser({password:e});if(m)throw m;f({title:"Password updated!",description:"Your password has been successfully reset."}),setTimeout(()=>{c("/")},2e3)}catch(m){console.error("Error resetting password:",m),f({title:"Error",description:m.message||"Failed to reset password. The link may have expired.",variant:"destructive"})}finally{i(!1)}});return o===null?s.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:s.jsx(Ze,{className:"w-full max-w-md",children:s.jsx(tt,{className:"p-6",children:s.jsx("div",{className:"text-center",children:"Checking reset link..."})})})}):o===!1?s.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:s.jsxs(Ze,{className:"w-full max-w-md",children:[s.jsxs(kr,{children:[s.jsx(Lr,{children:"Invalid Reset Link"}),s.jsx(zo,{children:"This password reset link is invalid or has expired."})]}),s.jsx(tt,{children:s.jsx(ce,{onClick:()=>c("/"),className:"w-full",children:"Go to Login"})})]})}):s.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:s.jsxs(Ze,{className:"w-full max-w-md",children:[s.jsxs(kr,{children:[s.jsx(Lr,{children:"Reset Your Password"}),s.jsx(zo,{children:"Enter your new password below."})]}),s.jsx(tt,{children:s.jsxs("form",{onSubmit:u,className:"space-y-4",children:[s.jsx("div",{children:s.jsx(Nr,{type:"password",placeholder:"New Password",value:e,onChange:h=>t(h.target.value),required:!0,minLength:6,className:"w-full"})}),s.jsx("div",{children:s.jsx(Nr,{type:"password",placeholder:"Confirm New Password",value:r,onChange:h=>n(h.target.value),required:!0,minLength:6,className:"w-full"})}),s.jsx(ce,{type:"submit",disabled:a,className:"w-full bg-[#FF3399] hover:bg-[#E6007A] text-white",children:a?"Resetting...":"Reset Password"})]})})]})})}const CBe=new Mne,PBe=()=>(console.log(" App component is rendering..."),s.jsx("div",{className:"synth-app",children:s.jsx(Ine,{client:CBe,children:s.jsxs(QP,{children:[s.jsx(Yee,{}),s.jsx(kte,{}),s.jsxs(Ese,{children:[s.jsx(Cse,{}),s.jsxs(m9,{children:[s.jsx(As,{path:"/",element:s.jsx(J8e,{})}),s.jsx(As,{path:"/admin",element:s.jsx(rBe,{})}),s.jsx(As,{path:"/artist/:artistId",element:s.jsx(Q8e,{})}),s.jsx(As,{path:"/venue/:venueId",element:s.jsx(eBe,{})}),s.jsx(As,{path:"/streaming-stats",element:s.jsx(tBe,{})}),s.jsx(As,{path:"/following",element:s.jsx(W$,{})}),s.jsx(As,{path:"/following/:userId",element:s.jsx(W$,{})}),s.jsx(As,{path:"/auth/spotify/callback",element:s.jsx(Zie,{})}),s.jsx(As,{path:"/reset-password",element:s.jsx(EBe,{})}),s.jsx(As,{path:"/components",element:s.jsx(kK,{})}),s.jsx(As,{path:"/mobile-preview/*",element:s.jsx(kBe,{})}),s.jsx(As,{path:"*",element:s.jsx(Pse,{})})]})]})]})})}));/*! Capacitor: https://capacitorjs.com/ - MIT License */var lp;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(lp||(lp={}));class JS extends Error{constructor(t,r,n){super(t),this.message=t,this.code=r,this.data=n}}const TBe=e=>{var t,r;return e!=null&&e.androidBridge?"android":!((r=(t=e==null?void 0:e.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},ABe=e=>{const t=e.CapacitorCustomPlatform||null,r=e.Capacitor||{},n=r.Plugins=r.Plugins||{},a=()=>t!==null?t.name:TBe(e),i=()=>a()!=="web",o=u=>{const h=d.get(u);return!!(h!=null&&h.platforms.has(a())||l(u))},l=u=>{var h;return(h=r.PluginHeaders)===null||h===void 0?void 0:h.find(m=>m.name===u)},c=u=>e.console.error(u),d=new Map,f=(u,h={})=>{const m=d.get(u);if(m)return console.warn(`Capacitor plugin "${u}" already registered. Cannot register plugins twice.`),m.proxy;const v=a(),g=l(u);let x;const _=()=>E(void 0,null,function*(){return!x&&v in h?x=typeof h[v]=="function"?x=yield h[v]():x=h[v]:t!==null&&!x&&"web"in h&&(x=typeof h.web=="function"?x=yield h.web():x=h.web),x}),w=(A,R)=>{var I,O;if(g){const z=g==null?void 0:g.methods.find(M=>R===M.name);if(z)return z.rtype==="promise"?M=>r.nativePromise(u,R.toString(),M):(M,B)=>r.nativeCallback(u,R.toString(),M,B);if(A)return(I=A[R])===null||I===void 0?void 0:I.bind(A)}else{if(A)return(O=A[R])===null||O===void 0?void 0:O.bind(A);throw new JS(`"${u}" plugin is not implemented on ${v}`,lp.Unimplemented)}},b=A=>{let R;const I=(...O)=>{const z=_().then(M=>{const B=w(M,A);if(B){const F=B(...O);return R=F==null?void 0:F.remove,F}else throw new JS(`"${u}.${A}()" is not implemented on ${v}`,lp.Unimplemented)});return A==="addListener"&&(z.remove=()=>E(void 0,null,function*(){return R()})),z};return I.toString=()=>`${A.toString()}() { [capacitor code] }`,Object.defineProperty(I,"name",{value:A,writable:!1,configurable:!1}),I},N=b("addListener"),S=b("removeListener"),k=(A,R)=>{const I=N({eventName:A},R),O=()=>E(void 0,null,function*(){const M=yield I;S({eventName:A,callbackId:M},R)}),z=new Promise(M=>I.then(()=>M({remove:O})));return z.remove=()=>E(void 0,null,function*(){console.warn("Using addListener() without 'await' is deprecated."),yield O()}),z},C=new Proxy({},{get(A,R){switch(R){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return g?k:N;case"removeListener":return S;default:return b(R)}}});return n[u]=C,d.set(u,{name:u,proxy:C,platforms:new Set([...Object.keys(h),...g?[v]:[]])}),C};return r.convertFileSrc||(r.convertFileSrc=u=>u),r.getPlatform=a,r.handleError=c,r.isNativePlatform=i,r.isPluginAvailable=o,r.registerPlugin=f,r.Exception=JS,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},RBe=e=>e.Capacitor=ABe(e),AC=RBe(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{}),Bj=AC.registerPlugin;class q5{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,r){let n=!1;this.listeners[t]||(this.listeners[t]=[],n=!0),this.listeners[t].push(r);const i=this.windowListeners[t];i&&!i.registered&&this.addWindowListener(i),n&&this.sendRetainedArgumentsForEvent(t);const o=()=>E(this,null,function*(){return this.removeListener(t,r)});return Promise.resolve({remove:o})}removeAllListeners(){return E(this,null,function*(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}})}notifyListeners(t,r,n){const a=this.listeners[t];if(!a){if(n){let i=this.retainedEventArguments[t];i||(i=[]),i.push(r),this.retainedEventArguments[t]=i}return}a.forEach(i=>i(r))}hasListeners(t){var r;return!!(!((r=this.listeners[t])===null||r===void 0)&&r.length)}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:n=>{this.notifyListeners(r,n)}}}unimplemented(t="not implemented"){return new AC.Exception(t,lp.Unimplemented)}unavailable(t="not available"){return new AC.Exception(t,lp.Unavailable)}removeListener(t,r){return E(this,null,function*(){const n=this.listeners[t];if(!n)return;const a=n.indexOf(r);this.listeners[t].splice(a,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])})}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const r=this.retainedEventArguments[t];r&&(delete this.retainedEventArguments[t],r.forEach(n=>{this.notifyListeners(t,n)}))}}const Z$=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),X$=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class OBe extends q5{getCookies(){return E(this,null,function*(){const t=document.cookie,r={};return t.split(";").forEach(n=>{if(n.length<=0)return;let[a,i]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=X$(a).trim(),i=X$(i).trim(),r[a]=i}),r})}setCookie(t){return E(this,null,function*(){try{const r=Z$(t.key),n=Z$(t.value),a=`; expires=${(t.expires||"").replace("expires=","")}`,i=(t.path||"/").replace("path=",""),o=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${n||""}${a}; path=${i}; ${o};`}catch(r){return Promise.reject(r)}})}deleteCookie(t){return E(this,null,function*(){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}})}clearCookies(){return E(this,null,function*(){try{const t=document.cookie.split(";")||[];for(const r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}})}clearAllCookies(){return E(this,null,function*(){try{yield this.clearCookies()}catch(t){return Promise.reject(t)}})}}Bj("CapacitorCookies",{web:()=>new OBe});const MBe=e=>E(void 0,null,function*(){return new Promise((t,r)=>{const n=new FileReader;n.onload=()=>{const a=n.result;t(a.indexOf(",")>=0?a.split(",")[1]:a)},n.onerror=a=>r(a),n.readAsDataURL(e)})}),DBe=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(a=>a.toLocaleLowerCase()).reduce((a,i,o)=>(a[i]=e[t[o]],a),{})},IBe=(e,t=!0)=>e?Object.entries(e).reduce((n,a)=>{const[i,o]=a;let l,c;return Array.isArray(o)?(c="",o.forEach(d=>{l=t?encodeURIComponent(d):d,c+=`${i}=${l}&`}),c.slice(0,-1)):(l=t?encodeURIComponent(o):o,c=`${i}=${l}`),`${n}&${c}`},"").substr(1):null,$Be=(e,t={})=>{const r=Object.assign({method:e.method||"GET",headers:e.headers},t),a=DBe(e.headers)["content-type"]||"";if(typeof e.data=="string")r.body=e.data;else if(a.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,l]of Object.entries(e.data||{}))i.set(o,l);r.body=i.toString()}else if(a.includes("multipart/form-data")||e.data instanceof FormData){const i=new FormData;if(e.data instanceof FormData)e.data.forEach((l,c)=>{i.append(c,l)});else for(const l of Object.keys(e.data))i.append(l,e.data[l]);r.body=i;const o=new Headers(r.headers);o.delete("content-type"),r.headers=o}else(a.includes("application/json")||typeof e.data=="object")&&(r.body=JSON.stringify(e.data));return r};class LBe extends q5{request(t){return E(this,null,function*(){const r=$Be(t,t.webFetchExtra),n=IBe(t.params,t.shouldEncodeUrlParams),a=n?`${t.url}?${n}`:t.url,i=yield fetch(a,r),o=i.headers.get("content-type")||"";let{responseType:l="text"}=i.ok?t:{};o.includes("application/json")&&(l="json");let c,d;switch(l){case"arraybuffer":case"blob":d=yield i.blob(),c=yield MBe(d);break;case"json":c=yield i.json();break;case"document":case"text":default:c=yield i.text()}const f={};return i.headers.forEach((u,h)=>{f[h]=u}),{data:c,headers:f,status:i.status,url:i.url}})}get(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))})}post(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))})}put(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))})}patch(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))})}delete(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))})}}Bj("CapacitorHttp",{web:()=>new LBe});var J$;(function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"})(J$||(J$={}));var Q$;(function(e){e.StatusBar="StatusBar",e.NavigationBar="NavigationBar"})(Q$||(Q$={}));class FBe extends q5{setStyle(){return E(this,null,function*(){this.unavailable("not available for web")})}setAnimation(){return E(this,null,function*(){this.unavailable("not available for web")})}show(){return E(this,null,function*(){this.unavailable("not available for web")})}hide(){return E(this,null,function*(){this.unavailable("not available for web")})}}Bj("SystemBars",{web:()=>new FBe});const zBe=Bj("SplashScreen",{web:()=>Rr(()=>import("./web-Dv-TagY4.js"),[],import.meta.url).then(e=>new e.SplashScreenWeb)});console.log(" Main.tsx is executing...");const w_=document.getElementById("root");console.log(" Root element:",w_);if(!w_)console.error(" Root element not found!");else{console.log(" Root element found, creating React root...");try{const e=_F(w_);console.log(" React root created, rendering App..."),e.render(s.jsx(PBe,{})),console.log(" App rendered successfully!"),window.Capacitor!==void 0&&setTimeout(()=>E(void 0,null,function*(){try{yield zBe.hide(),console.log(" Splash screen hidden")}catch(r){console.log(" Splash screen not available:",r)}}),1e3)}catch(e){console.error(" Error rendering React app:",e),w_.innerHTML="<h1>Error loading app</h1><p>Check console for details</p>"}}export{q5 as W,Rr as _,Bj as r,T as s};
