var TK=Object.defineProperty,AK=Object.defineProperties;var RK=Object.getOwnPropertyDescriptors;var Bx=Object.getOwnPropertySymbols;var UR=Object.prototype.hasOwnProperty,qR=Object.prototype.propertyIsEnumerable;var VR=e=>{throw TypeError(e)},Gp=Math.pow,zj=(e,t,r)=>t in e?TK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,M=(e,t)=>{for(var r in t||(t={}))UR.call(t,r)&&zj(e,r,t[r]);if(Bx)for(var r of Bx(t))qR.call(t,r)&&zj(e,r,t[r]);return e},H=(e,t)=>AK(e,RK(t));var me=(e,t)=>{var r={};for(var n in e)UR.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Bx)for(var n of Bx(e))t.indexOf(n)<0&&qR.call(e,n)&&(r[n]=e[n]);return r};var Cr=(e,t,r)=>zj(e,typeof t!="symbol"?t+"":t,r),Bj=(e,t,r)=>t.has(e)||VR("Cannot "+r);var rt=(e,t,r)=>(Bj(e,t,"read from private field"),r?r.call(e):t.get(e)),_n=(e,t,r)=>t.has(e)?VR("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Pr=(e,t,r,n)=>(Bj(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),_a=(e,t,r)=>(Bj(e,t,"access private method"),r);var Ux=(e,t,r,n)=>({set _(a){Pr(e,t,a,r)},get _(){return rt(e,t,n)}});var E=(e,t,r)=>new Promise((n,a)=>{var i=c=>{try{l(r.next(c))}catch(d){a(d)}},o=c=>{try{l(r.throw(c))}catch(d){a(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(i,o);l((r=r.apply(e,t)).next())});function OK(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var na=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function yn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function MK(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var $$={exports:{}},yb={},L$={exports:{}},on={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Py=Symbol.for("react.element"),DK=Symbol.for("react.portal"),IK=Symbol.for("react.fragment"),$K=Symbol.for("react.strict_mode"),LK=Symbol.for("react.profiler"),FK=Symbol.for("react.provider"),zK=Symbol.for("react.context"),BK=Symbol.for("react.forward_ref"),UK=Symbol.for("react.suspense"),qK=Symbol.for("react.memo"),VK=Symbol.for("react.lazy"),WR=Symbol.iterator;function WK(e){return e===null||typeof e!="object"?null:(e=WR&&e[WR]||e["@@iterator"],typeof e=="function"?e:null)}var F$={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z$=Object.assign,B$={};function np(e,t,r){this.props=e,this.context=t,this.refs=B$,this.updater=r||F$}np.prototype.isReactComponent={};np.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};np.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function U$(){}U$.prototype=np.prototype;function gC(e,t,r){this.props=e,this.context=t,this.refs=B$,this.updater=r||F$}var vC=gC.prototype=new U$;vC.constructor=gC;z$(vC,np.prototype);vC.isPureReactComponent=!0;var HR=Array.isArray,q$=Object.prototype.hasOwnProperty,yC={current:null},V$={key:!0,ref:!0,__self:!0,__source:!0};function W$(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)q$.call(t,n)&&!V$.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:Py,type:e,key:i,ref:o,props:a,_owner:yC.current}}function HK(e,t){return{$$typeof:Py,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function xC(e){return typeof e=="object"&&e!==null&&e.$$typeof===Py}function GK(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var GR=/\/+/g;function Uj(e,t){return typeof e=="object"&&e!==null&&e.key!=null?GK(""+e.key):t.toString(36)}function W0(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Py:case DK:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+Uj(o,0):n,HR(a)?(r="",e!=null&&(r=e.replace(GR,"$&/")+"/"),W0(a,t,r,"",function(d){return d})):a!=null&&(xC(a)&&(a=HK(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(GR,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",HR(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+Uj(i,l);o+=W0(i,t,r,c,a)}else if(c=WK(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+Uj(i,l++),o+=W0(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function qx(e,t,r){if(e==null)return e;var n=[],a=0;return W0(e,n,"","",function(i){return t.call(r,i,a++)}),n}function YK(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ga={current:null},H0={transition:null},KK={ReactCurrentDispatcher:Ga,ReactCurrentBatchConfig:H0,ReactCurrentOwner:yC};function H$(){throw Error("act(...) is not supported in production builds of React.")}on.Children={map:qx,forEach:function(e,t,r){qx(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return qx(e,function(){t++}),t},toArray:function(e){return qx(e,function(t){return t})||[]},only:function(e){if(!xC(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};on.Component=np;on.Fragment=IK;on.Profiler=LK;on.PureComponent=gC;on.StrictMode=$K;on.Suspense=UK;on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KK;on.act=H$;on.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=z$({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=yC.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)q$.call(t,c)&&!V$.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:Py,type:e.type,key:a,ref:i,props:n,_owner:o}};on.createContext=function(e){return e={$$typeof:zK,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:FK,_context:e},e.Consumer=e};on.createElement=W$;on.createFactory=function(e){var t=W$.bind(null,e);return t.type=e,t};on.createRef=function(){return{current:null}};on.forwardRef=function(e){return{$$typeof:BK,render:e}};on.isValidElement=xC;on.lazy=function(e){return{$$typeof:VK,_payload:{_status:-1,_result:e},_init:YK}};on.memo=function(e,t){return{$$typeof:qK,type:e,compare:t===void 0?null:t}};on.startTransition=function(e){var t=H0.transition;H0.transition={};try{e()}finally{H0.transition=t}};on.unstable_act=H$;on.useCallback=function(e,t){return Ga.current.useCallback(e,t)};on.useContext=function(e){return Ga.current.useContext(e)};on.useDebugValue=function(){};on.useDeferredValue=function(e){return Ga.current.useDeferredValue(e)};on.useEffect=function(e,t){return Ga.current.useEffect(e,t)};on.useId=function(){return Ga.current.useId()};on.useImperativeHandle=function(e,t,r){return Ga.current.useImperativeHandle(e,t,r)};on.useInsertionEffect=function(e,t){return Ga.current.useInsertionEffect(e,t)};on.useLayoutEffect=function(e,t){return Ga.current.useLayoutEffect(e,t)};on.useMemo=function(e,t){return Ga.current.useMemo(e,t)};on.useReducer=function(e,t,r){return Ga.current.useReducer(e,t,r)};on.useRef=function(e){return Ga.current.useRef(e)};on.useState=function(e){return Ga.current.useState(e)};on.useSyncExternalStore=function(e,t,r){return Ga.current.useSyncExternalStore(e,t,r)};on.useTransition=function(){return Ga.current.useTransition()};on.version="18.3.1";L$.exports=on;var x=L$.exports;const J=yn(x),_C=OK({__proto__:null,default:J},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZK=x,XK=Symbol.for("react.element"),JK=Symbol.for("react.fragment"),QK=Object.prototype.hasOwnProperty,eZ=ZK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tZ={key:!0,ref:!0,__self:!0,__source:!0};function G$(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)QK.call(t,n)&&!tZ.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:XK,type:e,key:i,ref:o,props:a,_owner:eZ.current}}yb.Fragment=JK;yb.jsx=G$;yb.jsxs=G$;$$.exports=yb;var s=$$.exports,Y$={exports:{}},Ii={},K$={exports:{}},Z$={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(q,K){var Z=q.length;q.push(K);e:for(;0<Z;){var Y=Z-1>>>1,Q=q[Y];if(0<a(Q,K))q[Y]=K,q[Z]=Q,Z=Y;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var K=q[0],Z=q.pop();if(Z!==K){q[0]=Z;e:for(var Y=0,Q=q.length,X=Q>>>1;Y<X;){var ne=2*(Y+1)-1,re=q[ne],ye=ne+1,ee=q[ye];if(0>a(re,Z))ye<Q&&0>a(ee,re)?(q[Y]=ee,q[ye]=Z,Y=ye):(q[Y]=re,q[ne]=Z,Y=ne);else if(ye<Q&&0>a(ee,Z))q[Y]=ee,q[ye]=Z,Y=ye;else break e}}return K}function a(q,K){var Z=q.sortIndex-K.sortIndex;return Z!==0?Z:q.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,f=null,h=3,p=!1,g=!1,v=!1,y=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(q){for(var K=r(d);K!==null;){if(K.callback===null)n(d);else if(K.startTime<=q)n(d),K.sortIndex=K.expirationTime,t(c,K);else break;K=r(d)}}function N(q){if(v=!1,b(q),!g)if(r(c)!==null)g=!0,U(S);else{var K=r(d);K!==null&&G(N,K.startTime-q)}}function S(q,K){g=!1,v&&(v=!1,_(A),A=-1),p=!0;var Z=h;try{for(b(K),f=r(c);f!==null&&(!(f.expirationTime>K)||q&&!O());){var Y=f.callback;if(typeof Y=="function"){f.callback=null,h=f.priorityLevel;var Q=Y(f.expirationTime<=K);K=e.unstable_now(),typeof Q=="function"?f.callback=Q:f===r(c)&&n(c),b(K)}else n(c);f=r(c)}if(f!==null)var X=!0;else{var ne=r(d);ne!==null&&G(N,ne.startTime-K),X=!1}return X}finally{f=null,h=Z,p=!1}}var k=!1,P=null,A=-1,R=5,$=-1;function O(){return!(e.unstable_now()-$<R)}function z(){if(P!==null){var q=e.unstable_now();$=q;var K=!0;try{K=P(!0,q)}finally{K?D():(k=!1,P=null)}}else k=!1}var D;if(typeof w=="function")D=function(){w(z)};else if(typeof MessageChannel!="undefined"){var B=new MessageChannel,F=B.port2;B.port1.onmessage=z,D=function(){F.postMessage(null)}}else D=function(){y(z,0)};function U(q){P=q,k||(k=!0,D())}function G(q,K){A=y(function(){q(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,U(S))},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(q){switch(h){case 1:case 2:case 3:var K=3;break;default:K=h}var Z=h;h=K;try{return q()}finally{h=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(q,K){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var Z=h;h=q;try{return K()}finally{h=Z}},e.unstable_scheduleCallback=function(q,K,Z){var Y=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?Y+Z:Y):Z=Y,q){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=Z+Q,q={id:u++,callback:K,priorityLevel:q,startTime:Z,expirationTime:Q,sortIndex:-1},Z>Y?(q.sortIndex=Z,t(d,q),r(c)===null&&q===r(d)&&(v?(_(A),A=-1):v=!0,G(N,Z-Y))):(q.sortIndex=Q,t(c,q),g||p||(g=!0,U(S))),q},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(q){var K=h;return function(){var Z=h;h=K;try{return q.apply(this,arguments)}finally{h=Z}}}})(Z$);K$.exports=Z$;var rZ=K$.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nZ=x,Di=rZ;function xt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var X$=new Set,ov={};function xh(e,t){cm(e,t),cm(e+"Capture",t)}function cm(e,t){for(ov[e]=t,e=0;e<t.length;e++)X$.add(t[e])}var kc=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),US=Object.prototype.hasOwnProperty,sZ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,YR={},KR={};function aZ(e){return US.call(KR,e)?!0:US.call(YR,e)?!1:sZ.test(e)?KR[e]=!0:(YR[e]=!0,!1)}function iZ(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function oZ(e,t,r,n){if(t===null||typeof t=="undefined"||iZ(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ya(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var va={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){va[e]=new Ya(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];va[t]=new Ya(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){va[e]=new Ya(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){va[e]=new Ya(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){va[e]=new Ya(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){va[e]=new Ya(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){va[e]=new Ya(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){va[e]=new Ya(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){va[e]=new Ya(e,5,!1,e.toLowerCase(),null,!1,!1)});var wC=/[\-:]([a-z])/g;function bC(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(wC,bC);va[t]=new Ya(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(wC,bC);va[t]=new Ya(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(wC,bC);va[t]=new Ya(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){va[e]=new Ya(e,1,!1,e.toLowerCase(),null,!1,!1)});va.xlinkHref=new Ya("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){va[e]=new Ya(e,1,!1,e.toLowerCase(),null,!0,!0)});function jC(e,t,r,n){var a=va.hasOwnProperty(t)?va[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(oZ(t,r,a,n)&&(r=null),n||a===null?aZ(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Lc=nZ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vx=Symbol.for("react.element"),mf=Symbol.for("react.portal"),pf=Symbol.for("react.fragment"),NC=Symbol.for("react.strict_mode"),qS=Symbol.for("react.profiler"),J$=Symbol.for("react.provider"),Q$=Symbol.for("react.context"),SC=Symbol.for("react.forward_ref"),VS=Symbol.for("react.suspense"),WS=Symbol.for("react.suspense_list"),kC=Symbol.for("react.memo"),sd=Symbol.for("react.lazy"),eL=Symbol.for("react.offscreen"),ZR=Symbol.iterator;function Yp(e){return e===null||typeof e!="object"?null:(e=ZR&&e[ZR]||e["@@iterator"],typeof e=="function"?e:null)}var cs=Object.assign,qj;function Pg(e){if(qj===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);qj=t&&t[1]||""}return`
`+qj+e}var Vj=!1;function Wj(e,t){if(!e||Vj)return"";Vj=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var c=`
`+a[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Vj=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Pg(e):""}function lZ(e){switch(e.tag){case 5:return Pg(e.type);case 16:return Pg("Lazy");case 13:return Pg("Suspense");case 19:return Pg("SuspenseList");case 0:case 2:case 15:return e=Wj(e.type,!1),e;case 11:return e=Wj(e.type.render,!1),e;case 1:return e=Wj(e.type,!0),e;default:return""}}function HS(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case pf:return"Fragment";case mf:return"Portal";case qS:return"Profiler";case NC:return"StrictMode";case VS:return"Suspense";case WS:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Q$:return(e.displayName||"Context")+".Consumer";case J$:return(e._context.displayName||"Context")+".Provider";case SC:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case kC:return t=e.displayName||null,t!==null?t:HS(e.type)||"Memo";case sd:t=e._payload,e=e._init;try{return HS(e(t))}catch(r){}}return null}function cZ(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return HS(t);case 8:return t===NC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Dd(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function tL(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function dZ(e){var t=tL(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r!="undefined"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Wx(e){e._valueTracker||(e._valueTracker=dZ(e))}function rL(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=tL(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function p_(e){if(e=e||(typeof document!="undefined"?document:void 0),typeof e=="undefined")return null;try{return e.activeElement||e.body}catch(t){return e.body}}function GS(e,t){var r=t.checked;return cs({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r!=null?r:e._wrapperState.initialChecked})}function XR(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Dd(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function nL(e,t){t=t.checked,t!=null&&jC(e,"checked",t,!1)}function YS(e,t){nL(e,t);var r=Dd(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?KS(e,t.type,r):t.hasOwnProperty("defaultValue")&&KS(e,t.type,Dd(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function JR(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function KS(e,t,r){(t!=="number"||p_(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Tg=Array.isArray;function Df(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Dd(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function ZS(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(xt(91));return cs({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function QR(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(xt(92));if(Tg(r)){if(1<r.length)throw Error(xt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Dd(r)}}function sL(e,t){var r=Dd(t.value),n=Dd(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function eO(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function aL(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function XS(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?aL(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Hx,iL=function(e){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Hx=Hx||document.createElement("div"),Hx.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Hx.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function lv(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var zg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uZ=["Webkit","ms","Moz","O"];Object.keys(zg).forEach(function(e){uZ.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),zg[t]=zg[e]})});function oL(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||zg.hasOwnProperty(e)&&zg[e]?(""+t).trim():t+"px"}function lL(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=oL(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var hZ=cs({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function JS(e,t){if(t){if(hZ[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(xt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(xt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(xt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(xt(62))}}function QS(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ek=null;function EC(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var tk=null,If=null,$f=null;function tO(e){if(e=Ry(e)){if(typeof tk!="function")throw Error(xt(280));var t=e.stateNode;t&&(t=jb(t),tk(e.stateNode,e.type,t))}}function cL(e){If?$f?$f.push(e):$f=[e]:If=e}function dL(){if(If){var e=If,t=$f;if($f=If=null,tO(e),t)for(e=0;e<t.length;e++)tO(t[e])}}function uL(e,t){return e(t)}function hL(){}var Hj=!1;function fL(e,t,r){if(Hj)return e(t,r);Hj=!0;try{return uL(e,t,r)}finally{Hj=!1,(If!==null||$f!==null)&&(hL(),dL())}}function cv(e,t){var r=e.stateNode;if(r===null)return null;var n=jb(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(xt(231,t,typeof r));return r}var rk=!1;if(kc)try{var Kp={};Object.defineProperty(Kp,"passive",{get:function(){rk=!0}}),window.addEventListener("test",Kp,Kp),window.removeEventListener("test",Kp,Kp)}catch(e){rk=!1}function fZ(e,t,r,n,a,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var Bg=!1,g_=null,v_=!1,nk=null,mZ={onError:function(e){Bg=!0,g_=e}};function pZ(e,t,r,n,a,i,o,l,c){Bg=!1,g_=null,fZ.apply(mZ,arguments)}function gZ(e,t,r,n,a,i,o,l,c){if(pZ.apply(this,arguments),Bg){if(Bg){var d=g_;Bg=!1,g_=null}else throw Error(xt(198));v_||(v_=!0,nk=d)}}function _h(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function mL(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function rO(e){if(_h(e)!==e)throw Error(xt(188))}function vZ(e){var t=e.alternate;if(!t){if(t=_h(e),t===null)throw Error(xt(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return rO(a),e;if(i===n)return rO(a),t;i=i.sibling}throw Error(xt(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(xt(189))}}if(r.alternate!==n)throw Error(xt(190))}if(r.tag!==3)throw Error(xt(188));return r.stateNode.current===r?e:t}function pL(e){return e=vZ(e),e!==null?gL(e):null}function gL(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=gL(e);if(t!==null)return t;e=e.sibling}return null}var vL=Di.unstable_scheduleCallback,nO=Di.unstable_cancelCallback,yZ=Di.unstable_shouldYield,xZ=Di.unstable_requestPaint,ws=Di.unstable_now,_Z=Di.unstable_getCurrentPriorityLevel,CC=Di.unstable_ImmediatePriority,yL=Di.unstable_UserBlockingPriority,y_=Di.unstable_NormalPriority,wZ=Di.unstable_LowPriority,xL=Di.unstable_IdlePriority,xb=null,kl=null;function bZ(e){if(kl&&typeof kl.onCommitFiberRoot=="function")try{kl.onCommitFiberRoot(xb,e,void 0,(e.current.flags&128)===128)}catch(t){}}var Fo=Math.clz32?Math.clz32:SZ,jZ=Math.log,NZ=Math.LN2;function SZ(e){return e>>>=0,e===0?32:31-(jZ(e)/NZ|0)|0}var Gx=64,Yx=4194304;function Ag(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function x_(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=Ag(l):(i&=o,i!==0&&(n=Ag(i)))}else o=r&~a,o!==0?n=Ag(o):i!==0&&(n=Ag(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Fo(t),a=1<<r,n|=e[r],t&=~a;return n}function kZ(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function EZ(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Fo(i),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=kZ(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function sk(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function _L(){var e=Gx;return Gx<<=1,!(Gx&4194240)&&(Gx=64),e}function Gj(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ty(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Fo(t),e[t]=r}function CZ(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Fo(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function PC(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Fo(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Tn=0;function wL(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var bL,TC,jL,NL,SL,ak=!1,Kx=[],jd=null,Nd=null,Sd=null,dv=new Map,uv=new Map,od=[],PZ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sO(e,t){switch(e){case"focusin":case"focusout":jd=null;break;case"dragenter":case"dragleave":Nd=null;break;case"mouseover":case"mouseout":Sd=null;break;case"pointerover":case"pointerout":dv.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":uv.delete(t.pointerId)}}function Zp(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Ry(t),t!==null&&TC(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function TZ(e,t,r,n,a){switch(t){case"focusin":return jd=Zp(jd,e,t,r,n,a),!0;case"dragenter":return Nd=Zp(Nd,e,t,r,n,a),!0;case"mouseover":return Sd=Zp(Sd,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return dv.set(i,Zp(dv.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,uv.set(i,Zp(uv.get(i)||null,e,t,r,n,a)),!0}return!1}function kL(e){var t=Su(e.target);if(t!==null){var r=_h(t);if(r!==null){if(t=r.tag,t===13){if(t=mL(r),t!==null){e.blockedOn=t,SL(e.priority,function(){jL(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function G0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=ik(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);ek=n,r.target.dispatchEvent(n),ek=null}else return t=Ry(r),t!==null&&TC(t),e.blockedOn=r,!1;t.shift()}return!0}function aO(e,t,r){G0(e)&&r.delete(t)}function AZ(){ak=!1,jd!==null&&G0(jd)&&(jd=null),Nd!==null&&G0(Nd)&&(Nd=null),Sd!==null&&G0(Sd)&&(Sd=null),dv.forEach(aO),uv.forEach(aO)}function Xp(e,t){e.blockedOn===t&&(e.blockedOn=null,ak||(ak=!0,Di.unstable_scheduleCallback(Di.unstable_NormalPriority,AZ)))}function hv(e){function t(a){return Xp(a,e)}if(0<Kx.length){Xp(Kx[0],e);for(var r=1;r<Kx.length;r++){var n=Kx[r];n.blockedOn===e&&(n.blockedOn=null)}}for(jd!==null&&Xp(jd,e),Nd!==null&&Xp(Nd,e),Sd!==null&&Xp(Sd,e),dv.forEach(t),uv.forEach(t),r=0;r<od.length;r++)n=od[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<od.length&&(r=od[0],r.blockedOn===null);)kL(r),r.blockedOn===null&&od.shift()}var Lf=Lc.ReactCurrentBatchConfig,__=!0;function RZ(e,t,r,n){var a=Tn,i=Lf.transition;Lf.transition=null;try{Tn=1,AC(e,t,r,n)}finally{Tn=a,Lf.transition=i}}function OZ(e,t,r,n){var a=Tn,i=Lf.transition;Lf.transition=null;try{Tn=4,AC(e,t,r,n)}finally{Tn=a,Lf.transition=i}}function AC(e,t,r,n){if(__){var a=ik(e,t,r,n);if(a===null)nN(e,t,n,w_,r),sO(e,n);else if(TZ(a,e,t,r,n))n.stopPropagation();else if(sO(e,n),t&4&&-1<PZ.indexOf(e)){for(;a!==null;){var i=Ry(a);if(i!==null&&bL(i),i=ik(e,t,r,n),i===null&&nN(e,t,n,w_,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else nN(e,t,n,null,r)}}var w_=null;function ik(e,t,r,n){if(w_=null,e=EC(n),e=Su(e),e!==null)if(t=_h(e),t===null)e=null;else if(r=t.tag,r===13){if(e=mL(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return w_=e,null}function EL(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_Z()){case CC:return 1;case yL:return 4;case y_:case wZ:return 16;case xL:return 536870912;default:return 16}default:return 16}}var vd=null,RC=null,Y0=null;function CL(){if(Y0)return Y0;var e,t=RC,r=t.length,n,a="value"in vd?vd.value:vd.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return Y0=a.slice(e,1<n?1-n:void 0)}function K0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Zx(){return!0}function iO(){return!1}function $i(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Zx:iO,this.isPropagationStopped=iO,this}return cs(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Zx)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Zx)},persist:function(){},isPersistent:Zx}),t}var sp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},OC=$i(sp),Ay=cs({},sp,{view:0,detail:0}),MZ=$i(Ay),Yj,Kj,Jp,_b=cs({},Ay,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:MC,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jp&&(Jp&&e.type==="mousemove"?(Yj=e.screenX-Jp.screenX,Kj=e.screenY-Jp.screenY):Kj=Yj=0,Jp=e),Yj)},movementY:function(e){return"movementY"in e?e.movementY:Kj}}),oO=$i(_b),DZ=cs({},_b,{dataTransfer:0}),IZ=$i(DZ),$Z=cs({},Ay,{relatedTarget:0}),Zj=$i($Z),LZ=cs({},sp,{animationName:0,elapsedTime:0,pseudoElement:0}),FZ=$i(LZ),zZ=cs({},sp,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),BZ=$i(zZ),UZ=cs({},sp,{data:0}),lO=$i(UZ),qZ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VZ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WZ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HZ(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=WZ[e])?!!t[e]:!1}function MC(){return HZ}var GZ=cs({},Ay,{key:function(e){if(e.key){var t=qZ[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=K0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?VZ[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:MC,charCode:function(e){return e.type==="keypress"?K0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?K0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),YZ=$i(GZ),KZ=cs({},_b,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cO=$i(KZ),ZZ=cs({},Ay,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:MC}),XZ=$i(ZZ),JZ=cs({},sp,{propertyName:0,elapsedTime:0,pseudoElement:0}),QZ=$i(JZ),eX=cs({},_b,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),tX=$i(eX),rX=[9,13,27,32],DC=kc&&"CompositionEvent"in window,Ug=null;kc&&"documentMode"in document&&(Ug=document.documentMode);var nX=kc&&"TextEvent"in window&&!Ug,PL=kc&&(!DC||Ug&&8<Ug&&11>=Ug),dO=" ",uO=!1;function TL(e,t){switch(e){case"keyup":return rX.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function AL(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var gf=!1;function sX(e,t){switch(e){case"compositionend":return AL(t);case"keypress":return t.which!==32?null:(uO=!0,dO);case"textInput":return e=t.data,e===dO&&uO?null:e;default:return null}}function aX(e,t){if(gf)return e==="compositionend"||!DC&&TL(e,t)?(e=CL(),Y0=RC=vd=null,gf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return PL&&t.locale!=="ko"?null:t.data;default:return null}}var iX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hO(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!iX[e.type]:t==="textarea"}function RL(e,t,r,n){cL(n),t=b_(t,"onChange"),0<t.length&&(r=new OC("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var qg=null,fv=null;function oX(e){qL(e,0)}function wb(e){var t=xf(e);if(rL(t))return e}function lX(e,t){if(e==="change")return t}var OL=!1;if(kc){var Xj;if(kc){var Jj="oninput"in document;if(!Jj){var fO=document.createElement("div");fO.setAttribute("oninput","return;"),Jj=typeof fO.oninput=="function"}Xj=Jj}else Xj=!1;OL=Xj&&(!document.documentMode||9<document.documentMode)}function mO(){qg&&(qg.detachEvent("onpropertychange",ML),fv=qg=null)}function ML(e){if(e.propertyName==="value"&&wb(fv)){var t=[];RL(t,fv,e,EC(e)),fL(oX,t)}}function cX(e,t,r){e==="focusin"?(mO(),qg=t,fv=r,qg.attachEvent("onpropertychange",ML)):e==="focusout"&&mO()}function dX(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return wb(fv)}function uX(e,t){if(e==="click")return wb(t)}function hX(e,t){if(e==="input"||e==="change")return wb(t)}function fX(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var qo=typeof Object.is=="function"?Object.is:fX;function mv(e,t){if(qo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!US.call(t,a)||!qo(e[a],t[a]))return!1}return!0}function pO(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function gO(e,t){var r=pO(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=pO(r)}}function DL(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?DL(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function IL(){for(var e=window,t=p_();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch(n){r=!1}if(r)e=t.contentWindow;else break;t=p_(e.document)}return t}function IC(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function mX(e){var t=IL(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&DL(r.ownerDocument.documentElement,r)){if(n!==null&&IC(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=gO(r,i);var o=gO(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pX=kc&&"documentMode"in document&&11>=document.documentMode,vf=null,ok=null,Vg=null,lk=!1;function vO(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;lk||vf==null||vf!==p_(n)||(n=vf,"selectionStart"in n&&IC(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Vg&&mv(Vg,n)||(Vg=n,n=b_(ok,"onSelect"),0<n.length&&(t=new OC("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=vf)))}function Xx(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var yf={animationend:Xx("Animation","AnimationEnd"),animationiteration:Xx("Animation","AnimationIteration"),animationstart:Xx("Animation","AnimationStart"),transitionend:Xx("Transition","TransitionEnd")},Qj={},$L={};kc&&($L=document.createElement("div").style,"AnimationEvent"in window||(delete yf.animationend.animation,delete yf.animationiteration.animation,delete yf.animationstart.animation),"TransitionEvent"in window||delete yf.transitionend.transition);function bb(e){if(Qj[e])return Qj[e];if(!yf[e])return e;var t=yf[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in $L)return Qj[e]=t[r];return e}var LL=bb("animationend"),FL=bb("animationiteration"),zL=bb("animationstart"),BL=bb("transitionend"),UL=new Map,yO="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hd(e,t){UL.set(e,t),xh(t,[e])}for(var eN=0;eN<yO.length;eN++){var tN=yO[eN],gX=tN.toLowerCase(),vX=tN[0].toUpperCase()+tN.slice(1);Hd(gX,"on"+vX)}Hd(LL,"onAnimationEnd");Hd(FL,"onAnimationIteration");Hd(zL,"onAnimationStart");Hd("dblclick","onDoubleClick");Hd("focusin","onFocus");Hd("focusout","onBlur");Hd(BL,"onTransitionEnd");cm("onMouseEnter",["mouseout","mouseover"]);cm("onMouseLeave",["mouseout","mouseover"]);cm("onPointerEnter",["pointerout","pointerover"]);cm("onPointerLeave",["pointerout","pointerover"]);xh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xh("onBeforeInput",["compositionend","keypress","textInput","paste"]);xh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yX=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rg));function xO(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,gZ(n,t,void 0,e),e.currentTarget=null}function qL(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;xO(a,l,d),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;xO(a,l,d),i=c}}}if(v_)throw e=nk,v_=!1,nk=null,e}function Kn(e,t){var r=t[fk];r===void 0&&(r=t[fk]=new Set);var n=e+"__bubble";r.has(n)||(VL(t,e,2,!1),r.add(n))}function rN(e,t,r){var n=0;t&&(n|=4),VL(r,e,n,t)}var Jx="_reactListening"+Math.random().toString(36).slice(2);function pv(e){if(!e[Jx]){e[Jx]=!0,X$.forEach(function(r){r!=="selectionchange"&&(yX.has(r)||rN(r,!1,e),rN(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Jx]||(t[Jx]=!0,rN("selectionchange",!1,t))}}function VL(e,t,r,n){switch(EL(t)){case 1:var a=RZ;break;case 4:a=OZ;break;default:a=AC}r=a.bind(null,t,r,e),a=void 0,!rk||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function nN(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=Su(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}fL(function(){var d=i,u=EC(r),f=[];e:{var h=UL.get(e);if(h!==void 0){var p=OC,g=e;switch(e){case"keypress":if(K0(r)===0)break e;case"keydown":case"keyup":p=YZ;break;case"focusin":g="focus",p=Zj;break;case"focusout":g="blur",p=Zj;break;case"beforeblur":case"afterblur":p=Zj;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=oO;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=IZ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=XZ;break;case LL:case FL:case zL:p=FZ;break;case BL:p=QZ;break;case"scroll":p=MZ;break;case"wheel":p=tX;break;case"copy":case"cut":case"paste":p=BZ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=cO}var v=(t&4)!==0,y=!v&&e==="scroll",_=v?h!==null?h+"Capture":null:h;v=[];for(var w=d,b;w!==null;){b=w;var N=b.stateNode;if(b.tag===5&&N!==null&&(b=N,_!==null&&(N=cv(w,_),N!=null&&v.push(gv(w,N,b)))),y)break;w=w.return}0<v.length&&(h=new p(h,g,null,r,u),f.push({event:h,listeners:v}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==ek&&(g=r.relatedTarget||r.fromElement)&&(Su(g)||g[Ec]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=d,g=g?Su(g):null,g!==null&&(y=_h(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=d),p!==g)){if(v=oO,N="onMouseLeave",_="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(v=cO,N="onPointerLeave",_="onPointerEnter",w="pointer"),y=p==null?h:xf(p),b=g==null?h:xf(g),h=new v(N,w+"leave",p,r,u),h.target=y,h.relatedTarget=b,N=null,Su(u)===d&&(v=new v(_,w+"enter",g,r,u),v.target=b,v.relatedTarget=y,N=v),y=N,p&&g)t:{for(v=p,_=g,w=0,b=v;b;b=qh(b))w++;for(b=0,N=_;N;N=qh(N))b++;for(;0<w-b;)v=qh(v),w--;for(;0<b-w;)_=qh(_),b--;for(;w--;){if(v===_||_!==null&&v===_.alternate)break t;v=qh(v),_=qh(_)}v=null}else v=null;p!==null&&_O(f,h,p,v,!1),g!==null&&y!==null&&_O(f,y,g,v,!0)}}e:{if(h=d?xf(d):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var S=lX;else if(hO(h))if(OL)S=hX;else{S=dX;var k=cX}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=uX);if(S&&(S=S(e,d))){RL(f,S,r,u);break e}k&&k(e,h,d),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&KS(h,"number",h.value)}switch(k=d?xf(d):window,e){case"focusin":(hO(k)||k.contentEditable==="true")&&(vf=k,ok=d,Vg=null);break;case"focusout":Vg=ok=vf=null;break;case"mousedown":lk=!0;break;case"contextmenu":case"mouseup":case"dragend":lk=!1,vO(f,r,u);break;case"selectionchange":if(pX)break;case"keydown":case"keyup":vO(f,r,u)}var P;if(DC)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else gf?TL(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(PL&&r.locale!=="ko"&&(gf||A!=="onCompositionStart"?A==="onCompositionEnd"&&gf&&(P=CL()):(vd=u,RC="value"in vd?vd.value:vd.textContent,gf=!0)),k=b_(d,A),0<k.length&&(A=new lO(A,e,null,r,u),f.push({event:A,listeners:k}),P?A.data=P:(P=AL(r),P!==null&&(A.data=P)))),(P=nX?sX(e,r):aX(e,r))&&(d=b_(d,"onBeforeInput"),0<d.length&&(u=new lO("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=P))}qL(f,t)})}function gv(e,t,r){return{instance:e,listener:t,currentTarget:r}}function b_(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=cv(e,r),i!=null&&n.unshift(gv(e,i,a)),i=cv(e,t),i!=null&&n.push(gv(e,i,a))),e=e.return}return n}function qh(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function _O(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,a?(c=cv(r,i),c!=null&&o.unshift(gv(r,c,l))):a||(c=cv(r,i),c!=null&&o.push(gv(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var xX=/\r\n?/g,_X=/\u0000|\uFFFD/g;function wO(e){return(typeof e=="string"?e:""+e).replace(xX,`
`).replace(_X,"")}function Qx(e,t,r){if(t=wO(t),wO(e)!==t&&r)throw Error(xt(425))}function j_(){}var ck=null,dk=null;function uk(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var hk=typeof setTimeout=="function"?setTimeout:void 0,wX=typeof clearTimeout=="function"?clearTimeout:void 0,bO=typeof Promise=="function"?Promise:void 0,bX=typeof queueMicrotask=="function"?queueMicrotask:typeof bO!="undefined"?function(e){return bO.resolve(null).then(e).catch(jX)}:hk;function jX(e){setTimeout(function(){throw e})}function sN(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),hv(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);hv(t)}function kd(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function jO(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ap=Math.random().toString(36).slice(2),ml="__reactFiber$"+ap,vv="__reactProps$"+ap,Ec="__reactContainer$"+ap,fk="__reactEvents$"+ap,NX="__reactListeners$"+ap,SX="__reactHandles$"+ap;function Su(e){var t=e[ml];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ec]||r[ml]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=jO(e);e!==null;){if(r=e[ml])return r;e=jO(e)}return t}e=r,r=e.parentNode}return null}function Ry(e){return e=e[ml]||e[Ec],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function xf(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(xt(33))}function jb(e){return e[vv]||null}var mk=[],_f=-1;function Gd(e){return{current:e}}function Jn(e){0>_f||(e.current=mk[_f],mk[_f]=null,_f--)}function Un(e,t){_f++,mk[_f]=e.current,e.current=t}var Id={},Ra=Gd(Id),ui=Gd(!1),Qu=Id;function dm(e,t){var r=e.type.contextTypes;if(!r)return Id;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function hi(e){return e=e.childContextTypes,e!=null}function N_(){Jn(ui),Jn(Ra)}function NO(e,t,r){if(Ra.current!==Id)throw Error(xt(168));Un(Ra,t),Un(ui,r)}function WL(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(xt(108,cZ(e)||"Unknown",a));return cs({},r,n)}function S_(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Id,Qu=Ra.current,Un(Ra,e),Un(ui,ui.current),!0}function SO(e,t,r){var n=e.stateNode;if(!n)throw Error(xt(169));r?(e=WL(e,t,Qu),n.__reactInternalMemoizedMergedChildContext=e,Jn(ui),Jn(Ra),Un(Ra,e)):Jn(ui),Un(ui,r)}var ac=null,Nb=!1,aN=!1;function HL(e){ac===null?ac=[e]:ac.push(e)}function kX(e){Nb=!0,HL(e)}function Yd(){if(!aN&&ac!==null){aN=!0;var e=0,t=Tn;try{var r=ac;for(Tn=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ac=null,Nb=!1}catch(a){throw ac!==null&&(ac=ac.slice(e+1)),vL(CC,Yd),a}finally{Tn=t,aN=!1}}return null}var wf=[],bf=0,k_=null,E_=0,Vi=[],Wi=0,eh=null,lc=1,cc="";function mu(e,t){wf[bf++]=E_,wf[bf++]=k_,k_=e,E_=t}function GL(e,t,r){Vi[Wi++]=lc,Vi[Wi++]=cc,Vi[Wi++]=eh,eh=e;var n=lc;e=cc;var a=32-Fo(n)-1;n&=~(1<<a),r+=1;var i=32-Fo(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,lc=1<<32-Fo(t)+a|r<<a|n,cc=i+e}else lc=1<<i|r<<a|n,cc=e}function $C(e){e.return!==null&&(mu(e,1),GL(e,1,0))}function LC(e){for(;e===k_;)k_=wf[--bf],wf[bf]=null,E_=wf[--bf],wf[bf]=null;for(;e===eh;)eh=Vi[--Wi],Vi[Wi]=null,cc=Vi[--Wi],Vi[Wi]=null,lc=Vi[--Wi],Vi[Wi]=null}var Oi=null,Ai=null,rs=!1,Ao=null;function YL(e,t){var r=Ji(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function kO(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Oi=e,Ai=kd(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Oi=e,Ai=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=eh!==null?{id:lc,overflow:cc}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ji(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Oi=e,Ai=null,!0):!1;default:return!1}}function pk(e){return(e.mode&1)!==0&&(e.flags&128)===0}function gk(e){if(rs){var t=Ai;if(t){var r=t;if(!kO(e,t)){if(pk(e))throw Error(xt(418));t=kd(r.nextSibling);var n=Oi;t&&kO(e,t)?YL(n,r):(e.flags=e.flags&-4097|2,rs=!1,Oi=e)}}else{if(pk(e))throw Error(xt(418));e.flags=e.flags&-4097|2,rs=!1,Oi=e}}}function EO(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Oi=e}function e0(e){if(e!==Oi)return!1;if(!rs)return EO(e),rs=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!uk(e.type,e.memoizedProps)),t&&(t=Ai)){if(pk(e))throw KL(),Error(xt(418));for(;t;)YL(e,t),t=kd(t.nextSibling)}if(EO(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(xt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ai=kd(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ai=null}}else Ai=Oi?kd(e.stateNode.nextSibling):null;return!0}function KL(){for(var e=Ai;e;)e=kd(e.nextSibling)}function um(){Ai=Oi=null,rs=!1}function FC(e){Ao===null?Ao=[e]:Ao.push(e)}var EX=Lc.ReactCurrentBatchConfig;function Qp(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(xt(309));var n=r.stateNode}if(!n)throw Error(xt(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(xt(284));if(!r._owner)throw Error(xt(290,e))}return e}function t0(e,t){throw e=Object.prototype.toString.call(t),Error(xt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function CO(e){var t=e._init;return t(e._payload)}function ZL(e){function t(_,w){if(e){var b=_.deletions;b===null?(_.deletions=[w],_.flags|=16):b.push(w)}}function r(_,w){if(!e)return null;for(;w!==null;)t(_,w),w=w.sibling;return null}function n(_,w){for(_=new Map;w!==null;)w.key!==null?_.set(w.key,w):_.set(w.index,w),w=w.sibling;return _}function a(_,w){return _=Td(_,w),_.index=0,_.sibling=null,_}function i(_,w,b){return _.index=b,e?(b=_.alternate,b!==null?(b=b.index,b<w?(_.flags|=2,w):b):(_.flags|=2,w)):(_.flags|=1048576,w)}function o(_){return e&&_.alternate===null&&(_.flags|=2),_}function l(_,w,b,N){return w===null||w.tag!==6?(w=hN(b,_.mode,N),w.return=_,w):(w=a(w,b),w.return=_,w)}function c(_,w,b,N){var S=b.type;return S===pf?u(_,w,b.props.children,N,b.key):w!==null&&(w.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===sd&&CO(S)===w.type)?(N=a(w,b.props),N.ref=Qp(_,w,b),N.return=_,N):(N=r_(b.type,b.key,b.props,null,_.mode,N),N.ref=Qp(_,w,b),N.return=_,N)}function d(_,w,b,N){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=fN(b,_.mode,N),w.return=_,w):(w=a(w,b.children||[]),w.return=_,w)}function u(_,w,b,N,S){return w===null||w.tag!==7?(w=Gu(b,_.mode,N,S),w.return=_,w):(w=a(w,b),w.return=_,w)}function f(_,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=hN(""+w,_.mode,b),w.return=_,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Vx:return b=r_(w.type,w.key,w.props,null,_.mode,b),b.ref=Qp(_,null,w),b.return=_,b;case mf:return w=fN(w,_.mode,b),w.return=_,w;case sd:var N=w._init;return f(_,N(w._payload),b)}if(Tg(w)||Yp(w))return w=Gu(w,_.mode,b,null),w.return=_,w;t0(_,w)}return null}function h(_,w,b,N){var S=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:l(_,w,""+b,N);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Vx:return b.key===S?c(_,w,b,N):null;case mf:return b.key===S?d(_,w,b,N):null;case sd:return S=b._init,h(_,w,S(b._payload),N)}if(Tg(b)||Yp(b))return S!==null?null:u(_,w,b,N,null);t0(_,b)}return null}function p(_,w,b,N,S){if(typeof N=="string"&&N!==""||typeof N=="number")return _=_.get(b)||null,l(w,_,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Vx:return _=_.get(N.key===null?b:N.key)||null,c(w,_,N,S);case mf:return _=_.get(N.key===null?b:N.key)||null,d(w,_,N,S);case sd:var k=N._init;return p(_,w,b,k(N._payload),S)}if(Tg(N)||Yp(N))return _=_.get(b)||null,u(w,_,N,S,null);t0(w,N)}return null}function g(_,w,b,N){for(var S=null,k=null,P=w,A=w=0,R=null;P!==null&&A<b.length;A++){P.index>A?(R=P,P=null):R=P.sibling;var $=h(_,P,b[A],N);if($===null){P===null&&(P=R);break}e&&P&&$.alternate===null&&t(_,P),w=i($,w,A),k===null?S=$:k.sibling=$,k=$,P=R}if(A===b.length)return r(_,P),rs&&mu(_,A),S;if(P===null){for(;A<b.length;A++)P=f(_,b[A],N),P!==null&&(w=i(P,w,A),k===null?S=P:k.sibling=P,k=P);return rs&&mu(_,A),S}for(P=n(_,P);A<b.length;A++)R=p(P,_,A,b[A],N),R!==null&&(e&&R.alternate!==null&&P.delete(R.key===null?A:R.key),w=i(R,w,A),k===null?S=R:k.sibling=R,k=R);return e&&P.forEach(function(O){return t(_,O)}),rs&&mu(_,A),S}function v(_,w,b,N){var S=Yp(b);if(typeof S!="function")throw Error(xt(150));if(b=S.call(b),b==null)throw Error(xt(151));for(var k=S=null,P=w,A=w=0,R=null,$=b.next();P!==null&&!$.done;A++,$=b.next()){P.index>A?(R=P,P=null):R=P.sibling;var O=h(_,P,$.value,N);if(O===null){P===null&&(P=R);break}e&&P&&O.alternate===null&&t(_,P),w=i(O,w,A),k===null?S=O:k.sibling=O,k=O,P=R}if($.done)return r(_,P),rs&&mu(_,A),S;if(P===null){for(;!$.done;A++,$=b.next())$=f(_,$.value,N),$!==null&&(w=i($,w,A),k===null?S=$:k.sibling=$,k=$);return rs&&mu(_,A),S}for(P=n(_,P);!$.done;A++,$=b.next())$=p(P,_,A,$.value,N),$!==null&&(e&&$.alternate!==null&&P.delete($.key===null?A:$.key),w=i($,w,A),k===null?S=$:k.sibling=$,k=$);return e&&P.forEach(function(z){return t(_,z)}),rs&&mu(_,A),S}function y(_,w,b,N){if(typeof b=="object"&&b!==null&&b.type===pf&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Vx:e:{for(var S=b.key,k=w;k!==null;){if(k.key===S){if(S=b.type,S===pf){if(k.tag===7){r(_,k.sibling),w=a(k,b.props.children),w.return=_,_=w;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===sd&&CO(S)===k.type){r(_,k.sibling),w=a(k,b.props),w.ref=Qp(_,k,b),w.return=_,_=w;break e}r(_,k);break}else t(_,k);k=k.sibling}b.type===pf?(w=Gu(b.props.children,_.mode,N,b.key),w.return=_,_=w):(N=r_(b.type,b.key,b.props,null,_.mode,N),N.ref=Qp(_,w,b),N.return=_,_=N)}return o(_);case mf:e:{for(k=b.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){r(_,w.sibling),w=a(w,b.children||[]),w.return=_,_=w;break e}else{r(_,w);break}else t(_,w);w=w.sibling}w=fN(b,_.mode,N),w.return=_,_=w}return o(_);case sd:return k=b._init,y(_,w,k(b._payload),N)}if(Tg(b))return g(_,w,b,N);if(Yp(b))return v(_,w,b,N);t0(_,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(r(_,w.sibling),w=a(w,b),w.return=_,_=w):(r(_,w),w=hN(b,_.mode,N),w.return=_,_=w),o(_)):r(_,w)}return y}var hm=ZL(!0),XL=ZL(!1),C_=Gd(null),P_=null,jf=null,zC=null;function BC(){zC=jf=P_=null}function UC(e){var t=C_.current;Jn(C_),e._currentValue=t}function vk(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ff(e,t){P_=e,zC=jf=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(li=!0),e.firstContext=null)}function lo(e){var t=e._currentValue;if(zC!==e)if(e={context:e,memoizedValue:t,next:null},jf===null){if(P_===null)throw Error(xt(308));jf=e,P_.dependencies={lanes:0,firstContext:e}}else jf=jf.next=e;return t}var ku=null;function qC(e){ku===null?ku=[e]:ku.push(e)}function JL(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,qC(t)):(r.next=a.next,a.next=r),t.interleaved=r,Cc(e,n)}function Cc(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ad=!1;function VC(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function QL(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function xc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ed(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,vn&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Cc(e,r)}return a=n.interleaved,a===null?(t.next=t,qC(n)):(t.next=a.next,a.next=t),n.interleaved=t,Cc(e,r)}function Z0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,PC(e,r)}}function PO(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function T_(e,t,r,n){var a=e.updateQueue;ad=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var f=a.baseState;o=0,u=d=c=null,l=i;do{var h=l.lane,p=l.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,v=l;switch(h=t,p=r,v.tag){case 1:if(g=v.payload,typeof g=="function"){f=g.call(p,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,h=typeof g=="function"?g.call(p,f,h):g,h==null)break e;f=cs({},f,h);break e;case 2:ad=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=p,c=f):u=u.next=p,o|=h;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;h=l,l=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(u===null&&(c=f),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);rh|=o,e.lanes=o,e.memoizedState=f}}function TO(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(xt(191,a));a.call(n)}}}var Oy={},El=Gd(Oy),yv=Gd(Oy),xv=Gd(Oy);function Eu(e){if(e===Oy)throw Error(xt(174));return e}function WC(e,t){switch(Un(xv,t),Un(yv,e),Un(El,Oy),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:XS(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=XS(t,e)}Jn(El),Un(El,t)}function fm(){Jn(El),Jn(yv),Jn(xv)}function e6(e){Eu(xv.current);var t=Eu(El.current),r=XS(t,e.type);t!==r&&(Un(yv,e),Un(El,r))}function HC(e){yv.current===e&&(Jn(El),Jn(yv))}var is=Gd(0);function A_(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var iN=[];function GC(){for(var e=0;e<iN.length;e++)iN[e]._workInProgressVersionPrimary=null;iN.length=0}var X0=Lc.ReactCurrentDispatcher,oN=Lc.ReactCurrentBatchConfig,th=0,ls=null,Us=null,Js=null,R_=!1,Wg=!1,_v=0,CX=0;function wa(){throw Error(xt(321))}function YC(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!qo(e[r],t[r]))return!1;return!0}function KC(e,t,r,n,a,i){if(th=i,ls=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,X0.current=e===null||e.memoizedState===null?RX:OX,e=r(n,a),Wg){i=0;do{if(Wg=!1,_v=0,25<=i)throw Error(xt(301));i+=1,Js=Us=null,t.updateQueue=null,X0.current=MX,e=r(n,a)}while(Wg)}if(X0.current=O_,t=Us!==null&&Us.next!==null,th=0,Js=Us=ls=null,R_=!1,t)throw Error(xt(300));return e}function ZC(){var e=_v!==0;return _v=0,e}function al(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Js===null?ls.memoizedState=Js=e:Js=Js.next=e,Js}function co(){if(Us===null){var e=ls.alternate;e=e!==null?e.memoizedState:null}else e=Us.next;var t=Js===null?ls.memoizedState:Js.next;if(t!==null)Js=t,Us=e;else{if(e===null)throw Error(xt(310));Us=e,e={memoizedState:Us.memoizedState,baseState:Us.baseState,baseQueue:Us.baseQueue,queue:Us.queue,next:null},Js===null?ls.memoizedState=Js=e:Js=Js.next=e}return Js}function wv(e,t){return typeof t=="function"?t(e):t}function lN(e){var t=co(),r=t.queue;if(r===null)throw Error(xt(311));r.lastRenderedReducer=e;var n=Us,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((th&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,ls.lanes|=u,rh|=u}d=d.next}while(d!==null&&d!==i);c===null?o=n:c.next=l,qo(n,t.memoizedState)||(li=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,ls.lanes|=i,rh|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function cN(e){var t=co(),r=t.queue;if(r===null)throw Error(xt(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);qo(i,t.memoizedState)||(li=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function t6(){}function r6(e,t){var r=ls,n=co(),a=t(),i=!qo(n.memoizedState,a);if(i&&(n.memoizedState=a,li=!0),n=n.queue,XC(a6.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Js!==null&&Js.memoizedState.tag&1){if(r.flags|=2048,bv(9,s6.bind(null,r,n,a,t),void 0,null),sa===null)throw Error(xt(349));th&30||n6(r,t,a)}return a}function n6(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ls.updateQueue,t===null?(t={lastEffect:null,stores:null},ls.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function s6(e,t,r,n){t.value=r,t.getSnapshot=n,i6(t)&&o6(e)}function a6(e,t,r){return r(function(){i6(t)&&o6(e)})}function i6(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!qo(e,r)}catch(n){return!0}}function o6(e){var t=Cc(e,1);t!==null&&zo(t,e,1,-1)}function AO(e){var t=al();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wv,lastRenderedState:e},t.queue=e,e=e.dispatch=AX.bind(null,ls,e),[t.memoizedState,e]}function bv(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ls.updateQueue,t===null?(t={lastEffect:null,stores:null},ls.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function l6(){return co().memoizedState}function J0(e,t,r,n){var a=al();ls.flags|=e,a.memoizedState=bv(1|t,r,void 0,n===void 0?null:n)}function Sb(e,t,r,n){var a=co();n=n===void 0?null:n;var i=void 0;if(Us!==null){var o=Us.memoizedState;if(i=o.destroy,n!==null&&YC(n,o.deps)){a.memoizedState=bv(t,r,i,n);return}}ls.flags|=e,a.memoizedState=bv(1|t,r,i,n)}function RO(e,t){return J0(8390656,8,e,t)}function XC(e,t){return Sb(2048,8,e,t)}function c6(e,t){return Sb(4,2,e,t)}function d6(e,t){return Sb(4,4,e,t)}function u6(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function h6(e,t,r){return r=r!=null?r.concat([e]):null,Sb(4,4,u6.bind(null,t,e),r)}function JC(){}function f6(e,t){var r=co();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&YC(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function m6(e,t){var r=co();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&YC(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function p6(e,t,r){return th&21?(qo(r,t)||(r=_L(),ls.lanes|=r,rh|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,li=!0),e.memoizedState=r)}function PX(e,t){var r=Tn;Tn=r!==0&&4>r?r:4,e(!0);var n=oN.transition;oN.transition={};try{e(!1),t()}finally{Tn=r,oN.transition=n}}function g6(){return co().memoizedState}function TX(e,t,r){var n=Pd(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},v6(e))y6(t,r);else if(r=JL(e,t,r,n),r!==null){var a=Va();zo(r,e,n,a),x6(r,t,n)}}function AX(e,t,r){var n=Pd(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(v6(e))y6(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,qo(l,o)){var c=t.interleaved;c===null?(a.next=a,qC(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch(d){}finally{}r=JL(e,t,a,n),r!==null&&(a=Va(),zo(r,e,n,a),x6(r,t,n))}}function v6(e){var t=e.alternate;return e===ls||t!==null&&t===ls}function y6(e,t){Wg=R_=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function x6(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,PC(e,r)}}var O_={readContext:lo,useCallback:wa,useContext:wa,useEffect:wa,useImperativeHandle:wa,useInsertionEffect:wa,useLayoutEffect:wa,useMemo:wa,useReducer:wa,useRef:wa,useState:wa,useDebugValue:wa,useDeferredValue:wa,useTransition:wa,useMutableSource:wa,useSyncExternalStore:wa,useId:wa,unstable_isNewReconciler:!1},RX={readContext:lo,useCallback:function(e,t){return al().memoizedState=[e,t===void 0?null:t],e},useContext:lo,useEffect:RO,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,J0(4194308,4,u6.bind(null,t,e),r)},useLayoutEffect:function(e,t){return J0(4194308,4,e,t)},useInsertionEffect:function(e,t){return J0(4,2,e,t)},useMemo:function(e,t){var r=al();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=al();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=TX.bind(null,ls,e),[n.memoizedState,e]},useRef:function(e){var t=al();return e={current:e},t.memoizedState=e},useState:AO,useDebugValue:JC,useDeferredValue:function(e){return al().memoizedState=e},useTransition:function(){var e=AO(!1),t=e[0];return e=PX.bind(null,e[1]),al().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ls,a=al();if(rs){if(r===void 0)throw Error(xt(407));r=r()}else{if(r=t(),sa===null)throw Error(xt(349));th&30||n6(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,RO(a6.bind(null,n,i,e),[e]),n.flags|=2048,bv(9,s6.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=al(),t=sa.identifierPrefix;if(rs){var r=cc,n=lc;r=(n&~(1<<32-Fo(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=_v++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=CX++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},OX={readContext:lo,useCallback:f6,useContext:lo,useEffect:XC,useImperativeHandle:h6,useInsertionEffect:c6,useLayoutEffect:d6,useMemo:m6,useReducer:lN,useRef:l6,useState:function(){return lN(wv)},useDebugValue:JC,useDeferredValue:function(e){var t=co();return p6(t,Us.memoizedState,e)},useTransition:function(){var e=lN(wv)[0],t=co().memoizedState;return[e,t]},useMutableSource:t6,useSyncExternalStore:r6,useId:g6,unstable_isNewReconciler:!1},MX={readContext:lo,useCallback:f6,useContext:lo,useEffect:XC,useImperativeHandle:h6,useInsertionEffect:c6,useLayoutEffect:d6,useMemo:m6,useReducer:cN,useRef:l6,useState:function(){return cN(wv)},useDebugValue:JC,useDeferredValue:function(e){var t=co();return Us===null?t.memoizedState=e:p6(t,Us.memoizedState,e)},useTransition:function(){var e=cN(wv)[0],t=co().memoizedState;return[e,t]},useMutableSource:t6,useSyncExternalStore:r6,useId:g6,unstable_isNewReconciler:!1};function jo(e,t){if(e&&e.defaultProps){t=cs({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function yk(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:cs({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var kb={isMounted:function(e){return(e=e._reactInternals)?_h(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Va(),a=Pd(e),i=xc(n,a);i.payload=t,r!=null&&(i.callback=r),t=Ed(e,i,a),t!==null&&(zo(t,e,a,n),Z0(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Va(),a=Pd(e),i=xc(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Ed(e,i,a),t!==null&&(zo(t,e,a,n),Z0(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Va(),n=Pd(e),a=xc(r,n);a.tag=2,t!=null&&(a.callback=t),t=Ed(e,a,n),t!==null&&(zo(t,e,n,r),Z0(t,e,n))}};function OO(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!mv(r,n)||!mv(a,i):!0}function _6(e,t,r){var n=!1,a=Id,i=t.contextType;return typeof i=="object"&&i!==null?i=lo(i):(a=hi(t)?Qu:Ra.current,n=t.contextTypes,i=(n=n!=null)?dm(e,a):Id),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=kb,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function MO(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&kb.enqueueReplaceState(t,t.state,null)}function xk(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},VC(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=lo(i):(i=hi(t)?Qu:Ra.current,a.context=dm(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(yk(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&kb.enqueueReplaceState(a,a.state,null),T_(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function mm(e,t){try{var r="",n=t;do r+=lZ(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function dN(e,t,r){return{value:e,source:null,stack:r!=null?r:null,digest:t!=null?t:null}}function _k(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var DX=typeof WeakMap=="function"?WeakMap:Map;function w6(e,t,r){r=xc(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){D_||(D_=!0,Tk=n),_k(e,t)},r}function b6(e,t,r){r=xc(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){_k(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){_k(e,t),typeof n!="function"&&(Cd===null?Cd=new Set([this]):Cd.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function DO(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new DX;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=KX.bind(null,e,t,r),t.then(e,e))}function IO(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function $O(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=xc(-1,1),t.tag=2,Ed(r,t,1))),r.lanes|=1),e)}var IX=Lc.ReactCurrentOwner,li=!1;function Fa(e,t,r,n){t.child=e===null?XL(t,null,r,n):hm(t,e.child,r,n)}function LO(e,t,r,n,a){r=r.render;var i=t.ref;return Ff(t,a),n=KC(e,t,r,n,i,a),r=ZC(),e!==null&&!li?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Pc(e,t,a)):(rs&&r&&$C(t),t.flags|=1,Fa(e,t,n,a),t.child)}function FO(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!iP(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,j6(e,t,i,n,a)):(e=r_(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:mv,r(o,n)&&e.ref===t.ref)return Pc(e,t,a)}return t.flags|=1,e=Td(i,n),e.ref=t.ref,e.return=t,t.child=e}function j6(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(mv(i,n)&&e.ref===t.ref)if(li=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(li=!0);else return t.lanes=e.lanes,Pc(e,t,a)}return wk(e,t,r,n,a)}function N6(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Un(Sf,Ei),Ei|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Un(Sf,Ei),Ei|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Un(Sf,Ei),Ei|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Un(Sf,Ei),Ei|=n;return Fa(e,t,a,r),t.child}function S6(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function wk(e,t,r,n,a){var i=hi(r)?Qu:Ra.current;return i=dm(t,i),Ff(t,a),r=KC(e,t,r,n,i,a),n=ZC(),e!==null&&!li?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Pc(e,t,a)):(rs&&n&&$C(t),t.flags|=1,Fa(e,t,r,a),t.child)}function zO(e,t,r,n,a){if(hi(r)){var i=!0;S_(t)}else i=!1;if(Ff(t,a),t.stateNode===null)Q0(e,t),_6(t,r,n),xk(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=lo(d):(d=hi(r)?Qu:Ra.current,d=dm(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==d)&&MO(t,o,n,d),ad=!1;var h=t.memoizedState;o.state=h,T_(t,n,o,a),c=t.memoizedState,l!==n||h!==c||ui.current||ad?(typeof u=="function"&&(yk(t,r,u,n),c=t.memoizedState),(l=ad||OO(t,r,l,n,h,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,QL(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:jo(t.type,l),o.props=d,f=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=lo(c):(c=hi(r)?Qu:Ra.current,c=dm(t,c));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&MO(t,o,n,c),ad=!1,h=t.memoizedState,o.state=h,T_(t,n,o,a);var g=t.memoizedState;l!==f||h!==g||ui.current||ad?(typeof p=="function"&&(yk(t,r,p,n),g=t.memoizedState),(d=ad||OO(t,r,d,n,h,g,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),o.props=n,o.state=g,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return bk(e,t,r,n,i,a)}function bk(e,t,r,n,a,i){S6(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&SO(t,r,!1),Pc(e,t,i);n=t.stateNode,IX.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=hm(t,e.child,null,i),t.child=hm(t,null,l,i)):Fa(e,t,l,i),t.memoizedState=n.state,a&&SO(t,r,!0),t.child}function k6(e){var t=e.stateNode;t.pendingContext?NO(e,t.pendingContext,t.pendingContext!==t.context):t.context&&NO(e,t.context,!1),WC(e,t.containerInfo)}function BO(e,t,r,n,a){return um(),FC(a),t.flags|=256,Fa(e,t,r,n),t.child}var jk={dehydrated:null,treeContext:null,retryLane:0};function Nk(e){return{baseLanes:e,cachePool:null,transitions:null}}function E6(e,t,r){var n=t.pendingProps,a=is.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Un(is,a&1),e===null)return gk(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Pb(o,n,0,null),e=Gu(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Nk(r),t.memoizedState=jk,e):QC(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return $X(e,t,o,n,l,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Td(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=Td(l,i):(i=Gu(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?Nk(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=jk,n}return i=e.child,e=i.sibling,n=Td(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function QC(e,t){return t=Pb({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function r0(e,t,r,n){return n!==null&&FC(n),hm(t,e.child,null,r),e=QC(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function $X(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=dN(Error(xt(422))),r0(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Pb({mode:"visible",children:n.children},a,0,null),i=Gu(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&hm(t,e.child,null,o),t.child.memoizedState=Nk(o),t.memoizedState=jk,i);if(!(t.mode&1))return r0(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(xt(419)),n=dN(i,n,void 0),r0(e,t,o,n)}if(l=(o&e.childLanes)!==0,li||l){if(n=sa,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Cc(e,a),zo(n,e,a,-1))}return aP(),n=dN(Error(xt(421))),r0(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=ZX.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Ai=kd(a.nextSibling),Oi=t,rs=!0,Ao=null,e!==null&&(Vi[Wi++]=lc,Vi[Wi++]=cc,Vi[Wi++]=eh,lc=e.id,cc=e.overflow,eh=t),t=QC(t,n.children),t.flags|=4096,t)}function UO(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),vk(e.return,t,r)}function uN(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function C6(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Fa(e,t,n.children,r),n=is.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&UO(e,r,t);else if(e.tag===19)UO(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Un(is,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&A_(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),uN(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&A_(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}uN(t,!0,r,null,i);break;case"together":uN(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Q0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Pc(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),rh|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(xt(153));if(t.child!==null){for(e=t.child,r=Td(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Td(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function LX(e,t,r){switch(t.tag){case 3:k6(t),um();break;case 5:e6(t);break;case 1:hi(t.type)&&S_(t);break;case 4:WC(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Un(C_,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Un(is,is.current&1),t.flags|=128,null):r&t.child.childLanes?E6(e,t,r):(Un(is,is.current&1),e=Pc(e,t,r),e!==null?e.sibling:null);Un(is,is.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return C6(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Un(is,is.current),n)break;return null;case 22:case 23:return t.lanes=0,N6(e,t,r)}return Pc(e,t,r)}var P6,Sk,T6,A6;P6=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Sk=function(){};T6=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Eu(El.current);var i=null;switch(r){case"input":a=GS(e,a),n=GS(e,n),i=[];break;case"select":a=cs({},a,{value:void 0}),n=cs({},n,{value:void 0}),i=[];break;case"textarea":a=ZS(e,a),n=ZS(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=j_)}JS(r,n);var o;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var l=a[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ov.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(l=a!=null?a[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ov.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Kn("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};A6=function(e,t,r,n){r!==n&&(t.flags|=4)};function eg(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ba(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function FX(e,t,r){var n=t.pendingProps;switch(LC(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ba(t),null;case 1:return hi(t.type)&&N_(),ba(t),null;case 3:return n=t.stateNode,fm(),Jn(ui),Jn(Ra),GC(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(e0(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ao!==null&&(Ok(Ao),Ao=null))),Sk(e,t),ba(t),null;case 5:HC(t);var a=Eu(xv.current);if(r=t.type,e!==null&&t.stateNode!=null)T6(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(xt(166));return ba(t),null}if(e=Eu(El.current),e0(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[ml]=t,n[vv]=i,e=(t.mode&1)!==0,r){case"dialog":Kn("cancel",n),Kn("close",n);break;case"iframe":case"object":case"embed":Kn("load",n);break;case"video":case"audio":for(a=0;a<Rg.length;a++)Kn(Rg[a],n);break;case"source":Kn("error",n);break;case"img":case"image":case"link":Kn("error",n),Kn("load",n);break;case"details":Kn("toggle",n);break;case"input":XR(n,i),Kn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Kn("invalid",n);break;case"textarea":QR(n,i),Kn("invalid",n)}JS(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Qx(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Qx(n.textContent,l,e),a=["children",""+l]):ov.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Kn("scroll",n)}switch(r){case"input":Wx(n),JR(n,i,!0);break;case"textarea":Wx(n),eO(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=j_)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=aL(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[ml]=t,e[vv]=n,P6(e,t,!1,!1),t.stateNode=e;e:{switch(o=QS(r,n),r){case"dialog":Kn("cancel",e),Kn("close",e),a=n;break;case"iframe":case"object":case"embed":Kn("load",e),a=n;break;case"video":case"audio":for(a=0;a<Rg.length;a++)Kn(Rg[a],e);a=n;break;case"source":Kn("error",e),a=n;break;case"img":case"image":case"link":Kn("error",e),Kn("load",e),a=n;break;case"details":Kn("toggle",e),a=n;break;case"input":XR(e,n),a=GS(e,n),Kn("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=cs({},n,{value:void 0}),Kn("invalid",e);break;case"textarea":QR(e,n),a=ZS(e,n),Kn("invalid",e);break;default:a=n}JS(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?lL(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&iL(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&lv(e,c):typeof c=="number"&&lv(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ov.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Kn("scroll",e):c!=null&&jC(e,i,c,o))}switch(r){case"input":Wx(e),JR(e,n,!1);break;case"textarea":Wx(e),eO(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Dd(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Df(e,!!n.multiple,i,!1):n.defaultValue!=null&&Df(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=j_)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ba(t),null;case 6:if(e&&t.stateNode!=null)A6(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(xt(166));if(r=Eu(xv.current),Eu(El.current),e0(t)){if(n=t.stateNode,r=t.memoizedProps,n[ml]=t,(i=n.nodeValue!==r)&&(e=Oi,e!==null))switch(e.tag){case 3:Qx(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Qx(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ml]=t,t.stateNode=n}return ba(t),null;case 13:if(Jn(is),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(rs&&Ai!==null&&t.mode&1&&!(t.flags&128))KL(),um(),t.flags|=98560,i=!1;else if(i=e0(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(xt(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(xt(317));i[ml]=t}else um(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ba(t),i=!1}else Ao!==null&&(Ok(Ao),Ao=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||is.current&1?Vs===0&&(Vs=3):aP())),t.updateQueue!==null&&(t.flags|=4),ba(t),null);case 4:return fm(),Sk(e,t),e===null&&pv(t.stateNode.containerInfo),ba(t),null;case 10:return UC(t.type._context),ba(t),null;case 17:return hi(t.type)&&N_(),ba(t),null;case 19:if(Jn(is),i=t.memoizedState,i===null)return ba(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)eg(i,!1);else{if(Vs!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=A_(e),o!==null){for(t.flags|=128,eg(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Un(is,is.current&1|2),t.child}e=e.sibling}i.tail!==null&&ws()>pm&&(t.flags|=128,n=!0,eg(i,!1),t.lanes=4194304)}else{if(!n)if(e=A_(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),eg(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!rs)return ba(t),null}else 2*ws()-i.renderingStartTime>pm&&r!==1073741824&&(t.flags|=128,n=!0,eg(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=ws(),t.sibling=null,r=is.current,Un(is,n?r&1|2:r&1),t):(ba(t),null);case 22:case 23:return sP(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ei&1073741824&&(ba(t),t.subtreeFlags&6&&(t.flags|=8192)):ba(t),null;case 24:return null;case 25:return null}throw Error(xt(156,t.tag))}function zX(e,t){switch(LC(t),t.tag){case 1:return hi(t.type)&&N_(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fm(),Jn(ui),Jn(Ra),GC(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return HC(t),null;case 13:if(Jn(is),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(xt(340));um()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Jn(is),null;case 4:return fm(),null;case 10:return UC(t.type._context),null;case 22:case 23:return sP(),null;case 24:return null;default:return null}}var n0=!1,Ea=!1,BX=typeof WeakSet=="function"?WeakSet:Set,Yt=null;function Nf(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){hs(e,t,n)}else r.current=null}function kk(e,t,r){try{r()}catch(n){hs(e,t,n)}}var qO=!1;function UX(e,t){if(ck=__,e=IL(),IC(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch(N){r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,f=e,h=null;t:for(;;){for(var p;f!==r||a!==0&&f.nodeType!==3||(l=o+a),f!==i||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++d===a&&(l=o),h===i&&++u===n&&(c=o),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(dk={focusedElem:e,selectionRange:r},__=!1,Yt=t;Yt!==null;)if(t=Yt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Yt=e;else for(;Yt!==null;){t=Yt;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,y=g.memoizedState,_=t.stateNode,w=_.getSnapshotBeforeUpdate(t.elementType===t.type?v:jo(t.type,v),y);_.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xt(163))}}catch(N){hs(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,Yt=e;break}Yt=t.return}return g=qO,qO=!1,g}function Hg(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&kk(t,r,i)}a=a.next}while(a!==n)}}function Eb(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Ek(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function R6(e){var t=e.alternate;t!==null&&(e.alternate=null,R6(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ml],delete t[vv],delete t[fk],delete t[NX],delete t[SX])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function O6(e){return e.tag===5||e.tag===3||e.tag===4}function VO(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||O6(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ck(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=j_));else if(n!==4&&(e=e.child,e!==null))for(Ck(e,t,r),e=e.sibling;e!==null;)Ck(e,t,r),e=e.sibling}function Pk(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Pk(e,t,r),e=e.sibling;e!==null;)Pk(e,t,r),e=e.sibling}var ua=null,Eo=!1;function Kc(e,t,r){for(r=r.child;r!==null;)M6(e,t,r),r=r.sibling}function M6(e,t,r){if(kl&&typeof kl.onCommitFiberUnmount=="function")try{kl.onCommitFiberUnmount(xb,r)}catch(l){}switch(r.tag){case 5:Ea||Nf(r,t);case 6:var n=ua,a=Eo;ua=null,Kc(e,t,r),ua=n,Eo=a,ua!==null&&(Eo?(e=ua,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ua.removeChild(r.stateNode));break;case 18:ua!==null&&(Eo?(e=ua,r=r.stateNode,e.nodeType===8?sN(e.parentNode,r):e.nodeType===1&&sN(e,r),hv(e)):sN(ua,r.stateNode));break;case 4:n=ua,a=Eo,ua=r.stateNode.containerInfo,Eo=!0,Kc(e,t,r),ua=n,Eo=a;break;case 0:case 11:case 14:case 15:if(!Ea&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&kk(r,t,o),a=a.next}while(a!==n)}Kc(e,t,r);break;case 1:if(!Ea&&(Nf(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){hs(r,t,l)}Kc(e,t,r);break;case 21:Kc(e,t,r);break;case 22:r.mode&1?(Ea=(n=Ea)||r.memoizedState!==null,Kc(e,t,r),Ea=n):Kc(e,t,r);break;default:Kc(e,t,r)}}function WO(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new BX),t.forEach(function(n){var a=XX.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function vo(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:ua=l.stateNode,Eo=!1;break e;case 3:ua=l.stateNode.containerInfo,Eo=!0;break e;case 4:ua=l.stateNode.containerInfo,Eo=!0;break e}l=l.return}if(ua===null)throw Error(xt(160));M6(i,o,a),ua=null,Eo=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){hs(a,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)D6(t,e),t=t.sibling}function D6(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vo(t,e),sl(e),n&4){try{Hg(3,e,e.return),Eb(3,e)}catch(v){hs(e,e.return,v)}try{Hg(5,e,e.return)}catch(v){hs(e,e.return,v)}}break;case 1:vo(t,e),sl(e),n&512&&r!==null&&Nf(r,r.return);break;case 5:if(vo(t,e),sl(e),n&512&&r!==null&&Nf(r,r.return),e.flags&32){var a=e.stateNode;try{lv(a,"")}catch(v){hs(e,e.return,v)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&nL(a,i),QS(l,o);var d=QS(l,i);for(o=0;o<c.length;o+=2){var u=c[o],f=c[o+1];u==="style"?lL(a,f):u==="dangerouslySetInnerHTML"?iL(a,f):u==="children"?lv(a,f):jC(a,u,f,d)}switch(l){case"input":YS(a,i);break;case"textarea":sL(a,i);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Df(a,!!i.multiple,p,!1):h!==!!i.multiple&&(i.defaultValue!=null?Df(a,!!i.multiple,i.defaultValue,!0):Df(a,!!i.multiple,i.multiple?[]:"",!1))}a[vv]=i}catch(v){hs(e,e.return,v)}}break;case 6:if(vo(t,e),sl(e),n&4){if(e.stateNode===null)throw Error(xt(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(v){hs(e,e.return,v)}}break;case 3:if(vo(t,e),sl(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{hv(t.containerInfo)}catch(v){hs(e,e.return,v)}break;case 4:vo(t,e),sl(e);break;case 13:vo(t,e),sl(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(rP=ws())),n&4&&WO(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Ea=(d=Ea)||u,vo(t,e),Ea=d):vo(t,e),sl(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(Yt=e,u=e.child;u!==null;){for(f=Yt=u;Yt!==null;){switch(h=Yt,p=h.child,h.tag){case 0:case 11:case 14:case 15:Hg(4,h,h.return);break;case 1:Nf(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(v){hs(n,r,v)}}break;case 5:Nf(h,h.return);break;case 22:if(h.memoizedState!==null){GO(f);continue}}p!==null?(p.return=h,Yt=p):GO(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=oL("display",o))}catch(v){hs(e,e.return,v)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(v){hs(e,e.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:vo(t,e),sl(e),n&4&&WO(e);break;case 21:break;default:vo(t,e),sl(e)}}function sl(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(O6(r)){var n=r;break e}r=r.return}throw Error(xt(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(lv(a,""),n.flags&=-33);var i=VO(e);Pk(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=VO(e);Ck(e,l,o);break;default:throw Error(xt(161))}}catch(c){hs(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function qX(e,t,r){Yt=e,I6(e)}function I6(e,t,r){for(var n=(e.mode&1)!==0;Yt!==null;){var a=Yt,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||n0;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||Ea;l=n0;var d=Ea;if(n0=o,(Ea=c)&&!d)for(Yt=a;Yt!==null;)o=Yt,c=o.child,o.tag===22&&o.memoizedState!==null?YO(a):c!==null?(c.return=o,Yt=c):YO(a);for(;i!==null;)Yt=i,I6(i),i=i.sibling;Yt=a,n0=l,Ea=d}HO(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Yt=i):HO(e)}}function HO(e){for(;Yt!==null;){var t=Yt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ea||Eb(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ea)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:jo(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&TO(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}TO(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&hv(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xt(163))}Ea||t.flags&512&&Ek(t)}catch(h){hs(t,t.return,h)}}if(t===e){Yt=null;break}if(r=t.sibling,r!==null){r.return=t.return,Yt=r;break}Yt=t.return}}function GO(e){for(;Yt!==null;){var t=Yt;if(t===e){Yt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Yt=r;break}Yt=t.return}}function YO(e){for(;Yt!==null;){var t=Yt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Eb(4,t)}catch(c){hs(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){hs(t,a,c)}}var i=t.return;try{Ek(t)}catch(c){hs(t,i,c)}break;case 5:var o=t.return;try{Ek(t)}catch(c){hs(t,o,c)}}}catch(c){hs(t,t.return,c)}if(t===e){Yt=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Yt=l;break}Yt=t.return}}var VX=Math.ceil,M_=Lc.ReactCurrentDispatcher,eP=Lc.ReactCurrentOwner,no=Lc.ReactCurrentBatchConfig,vn=0,sa=null,Es=null,pa=0,Ei=0,Sf=Gd(0),Vs=0,jv=null,rh=0,Cb=0,tP=0,Gg=null,si=null,rP=0,pm=1/0,nc=null,D_=!1,Tk=null,Cd=null,s0=!1,yd=null,I_=0,Yg=0,Ak=null,e_=-1,t_=0;function Va(){return vn&6?ws():e_!==-1?e_:e_=ws()}function Pd(e){return e.mode&1?vn&2&&pa!==0?pa&-pa:EX.transition!==null?(t_===0&&(t_=_L()),t_):(e=Tn,e!==0||(e=window.event,e=e===void 0?16:EL(e.type)),e):1}function zo(e,t,r,n){if(50<Yg)throw Yg=0,Ak=null,Error(xt(185));Ty(e,r,n),(!(vn&2)||e!==sa)&&(e===sa&&(!(vn&2)&&(Cb|=r),Vs===4&&ld(e,pa)),fi(e,n),r===1&&vn===0&&!(t.mode&1)&&(pm=ws()+500,Nb&&Yd()))}function fi(e,t){var r=e.callbackNode;EZ(e,t);var n=x_(e,e===sa?pa:0);if(n===0)r!==null&&nO(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&nO(r),t===1)e.tag===0?kX(KO.bind(null,e)):HL(KO.bind(null,e)),bX(function(){!(vn&6)&&Yd()}),r=null;else{switch(wL(n)){case 1:r=CC;break;case 4:r=yL;break;case 16:r=y_;break;case 536870912:r=xL;break;default:r=y_}r=V6(r,$6.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function $6(e,t){if(e_=-1,t_=0,vn&6)throw Error(xt(327));var r=e.callbackNode;if(zf()&&e.callbackNode!==r)return null;var n=x_(e,e===sa?pa:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=$_(e,n);else{t=n;var a=vn;vn|=2;var i=F6();(sa!==e||pa!==t)&&(nc=null,pm=ws()+500,Hu(e,t));do try{GX();break}catch(l){L6(e,l)}while(!0);BC(),M_.current=i,vn=a,Es!==null?t=0:(sa=null,pa=0,t=Vs)}if(t!==0){if(t===2&&(a=sk(e),a!==0&&(n=a,t=Rk(e,a))),t===1)throw r=jv,Hu(e,0),ld(e,n),fi(e,ws()),r;if(t===6)ld(e,n);else{if(a=e.current.alternate,!(n&30)&&!WX(a)&&(t=$_(e,n),t===2&&(i=sk(e),i!==0&&(n=i,t=Rk(e,i))),t===1))throw r=jv,Hu(e,0),ld(e,n),fi(e,ws()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(xt(345));case 2:pu(e,si,nc);break;case 3:if(ld(e,n),(n&130023424)===n&&(t=rP+500-ws(),10<t)){if(x_(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Va(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=hk(pu.bind(null,e,si,nc),t);break}pu(e,si,nc);break;case 4:if(ld(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-Fo(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=ws()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*VX(n/1960))-n,10<n){e.timeoutHandle=hk(pu.bind(null,e,si,nc),n);break}pu(e,si,nc);break;case 5:pu(e,si,nc);break;default:throw Error(xt(329))}}}return fi(e,ws()),e.callbackNode===r?$6.bind(null,e):null}function Rk(e,t){var r=Gg;return e.current.memoizedState.isDehydrated&&(Hu(e,t).flags|=256),e=$_(e,t),e!==2&&(t=si,si=r,t!==null&&Ok(t)),e}function Ok(e){si===null?si=e:si.push.apply(si,e)}function WX(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!qo(i(),a))return!1}catch(o){return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ld(e,t){for(t&=~tP,t&=~Cb,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Fo(t),n=1<<r;e[r]=-1,t&=~n}}function KO(e){if(vn&6)throw Error(xt(327));zf();var t=x_(e,0);if(!(t&1))return fi(e,ws()),null;var r=$_(e,t);if(e.tag!==0&&r===2){var n=sk(e);n!==0&&(t=n,r=Rk(e,n))}if(r===1)throw r=jv,Hu(e,0),ld(e,t),fi(e,ws()),r;if(r===6)throw Error(xt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,pu(e,si,nc),fi(e,ws()),null}function nP(e,t){var r=vn;vn|=1;try{return e(t)}finally{vn=r,vn===0&&(pm=ws()+500,Nb&&Yd())}}function nh(e){yd!==null&&yd.tag===0&&!(vn&6)&&zf();var t=vn;vn|=1;var r=no.transition,n=Tn;try{if(no.transition=null,Tn=1,e)return e()}finally{Tn=n,no.transition=r,vn=t,!(vn&6)&&Yd()}}function sP(){Ei=Sf.current,Jn(Sf)}function Hu(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,wX(r)),Es!==null)for(r=Es.return;r!==null;){var n=r;switch(LC(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&N_();break;case 3:fm(),Jn(ui),Jn(Ra),GC();break;case 5:HC(n);break;case 4:fm();break;case 13:Jn(is);break;case 19:Jn(is);break;case 10:UC(n.type._context);break;case 22:case 23:sP()}r=r.return}if(sa=e,Es=e=Td(e.current,null),pa=Ei=t,Vs=0,jv=null,tP=Cb=rh=0,si=Gg=null,ku!==null){for(t=0;t<ku.length;t++)if(r=ku[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}ku=null}return e}function L6(e,t){do{var r=Es;try{if(BC(),X0.current=O_,R_){for(var n=ls.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}R_=!1}if(th=0,Js=Us=ls=null,Wg=!1,_v=0,eP.current=null,r===null||r.return===null){Vs=1,jv=t,Es=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=pa,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=IO(o);if(p!==null){p.flags&=-257,$O(p,o,l,i,t),p.mode&1&&DO(i,d,t),t=p,c=d;var g=t.updateQueue;if(g===null){var v=new Set;v.add(c),t.updateQueue=v}else g.add(c);break e}else{if(!(t&1)){DO(i,d,t),aP();break e}c=Error(xt(426))}}else if(rs&&l.mode&1){var y=IO(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),$O(y,o,l,i,t),FC(mm(c,l));break e}}i=c=mm(c,l),Vs!==4&&(Vs=2),Gg===null?Gg=[i]:Gg.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var _=w6(i,c,t);PO(i,_);break e;case 1:l=c;var w=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Cd===null||!Cd.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var N=b6(i,l,t);PO(i,N);break e}}i=i.return}while(i!==null)}B6(r)}catch(S){t=S,Es===r&&r!==null&&(Es=r=r.return);continue}break}while(!0)}function F6(){var e=M_.current;return M_.current=O_,e===null?O_:e}function aP(){(Vs===0||Vs===3||Vs===2)&&(Vs=4),sa===null||!(rh&268435455)&&!(Cb&268435455)||ld(sa,pa)}function $_(e,t){var r=vn;vn|=2;var n=F6();(sa!==e||pa!==t)&&(nc=null,Hu(e,t));do try{HX();break}catch(a){L6(e,a)}while(!0);if(BC(),vn=r,M_.current=n,Es!==null)throw Error(xt(261));return sa=null,pa=0,Vs}function HX(){for(;Es!==null;)z6(Es)}function GX(){for(;Es!==null&&!yZ();)z6(Es)}function z6(e){var t=q6(e.alternate,e,Ei);e.memoizedProps=e.pendingProps,t===null?B6(e):Es=t,eP.current=null}function B6(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=zX(r,t),r!==null){r.flags&=32767,Es=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Vs=6,Es=null;return}}else if(r=FX(r,t,Ei),r!==null){Es=r;return}if(t=t.sibling,t!==null){Es=t;return}Es=t=e}while(t!==null);Vs===0&&(Vs=5)}function pu(e,t,r){var n=Tn,a=no.transition;try{no.transition=null,Tn=1,YX(e,t,r,n)}finally{no.transition=a,Tn=n}return null}function YX(e,t,r,n){do zf();while(yd!==null);if(vn&6)throw Error(xt(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(xt(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(CZ(e,i),e===sa&&(Es=sa=null,pa=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||s0||(s0=!0,V6(y_,function(){return zf(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=no.transition,no.transition=null;var o=Tn;Tn=1;var l=vn;vn|=4,eP.current=null,UX(e,r),D6(r,e),mX(dk),__=!!ck,dk=ck=null,e.current=r,qX(r),xZ(),vn=l,Tn=o,no.transition=i}else e.current=r;if(s0&&(s0=!1,yd=e,I_=a),i=e.pendingLanes,i===0&&(Cd=null),bZ(r.stateNode),fi(e,ws()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(D_)throw D_=!1,e=Tk,Tk=null,e;return I_&1&&e.tag!==0&&zf(),i=e.pendingLanes,i&1?e===Ak?Yg++:(Yg=0,Ak=e):Yg=0,Yd(),null}function zf(){if(yd!==null){var e=wL(I_),t=no.transition,r=Tn;try{if(no.transition=null,Tn=16>e?16:e,yd===null)var n=!1;else{if(e=yd,yd=null,I_=0,vn&6)throw Error(xt(331));var a=vn;for(vn|=4,Yt=e.current;Yt!==null;){var i=Yt,o=i.child;if(Yt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Yt=d;Yt!==null;){var u=Yt;switch(u.tag){case 0:case 11:case 15:Hg(8,u,i)}var f=u.child;if(f!==null)f.return=u,Yt=f;else for(;Yt!==null;){u=Yt;var h=u.sibling,p=u.return;if(R6(u),u===d){Yt=null;break}if(h!==null){h.return=p,Yt=h;break}Yt=p}}}var g=i.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var y=v.sibling;v.sibling=null,v=y}while(v!==null)}}Yt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Yt=o;else e:for(;Yt!==null;){if(i=Yt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Hg(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,Yt=_;break e}Yt=i.return}}var w=e.current;for(Yt=w;Yt!==null;){o=Yt;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,Yt=b;else e:for(o=w;Yt!==null;){if(l=Yt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Eb(9,l)}}catch(S){hs(l,l.return,S)}if(l===o){Yt=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,Yt=N;break e}Yt=l.return}}if(vn=a,Yd(),kl&&typeof kl.onPostCommitFiberRoot=="function")try{kl.onPostCommitFiberRoot(xb,e)}catch(S){}n=!0}return n}finally{Tn=r,no.transition=t}}return!1}function ZO(e,t,r){t=mm(r,t),t=w6(e,t,1),e=Ed(e,t,1),t=Va(),e!==null&&(Ty(e,1,t),fi(e,t))}function hs(e,t,r){if(e.tag===3)ZO(e,e,r);else for(;t!==null;){if(t.tag===3){ZO(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Cd===null||!Cd.has(n))){e=mm(r,e),e=b6(t,e,1),t=Ed(t,e,1),e=Va(),t!==null&&(Ty(t,1,e),fi(t,e));break}}t=t.return}}function KX(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Va(),e.pingedLanes|=e.suspendedLanes&r,sa===e&&(pa&r)===r&&(Vs===4||Vs===3&&(pa&130023424)===pa&&500>ws()-rP?Hu(e,0):tP|=r),fi(e,t)}function U6(e,t){t===0&&(e.mode&1?(t=Yx,Yx<<=1,!(Yx&130023424)&&(Yx=4194304)):t=1);var r=Va();e=Cc(e,t),e!==null&&(Ty(e,t,r),fi(e,r))}function ZX(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),U6(e,r)}function XX(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(xt(314))}n!==null&&n.delete(t),U6(e,r)}var q6;q6=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ui.current)li=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return li=!1,LX(e,t,r);li=!!(e.flags&131072)}else li=!1,rs&&t.flags&1048576&&GL(t,E_,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Q0(e,t),e=t.pendingProps;var a=dm(t,Ra.current);Ff(t,r),a=KC(null,t,n,e,a,r);var i=ZC();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,hi(n)?(i=!0,S_(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,VC(t),a.updater=kb,t.stateNode=a,a._reactInternals=t,xk(t,n,e,r),t=bk(null,t,n,!0,i,r)):(t.tag=0,rs&&i&&$C(t),Fa(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Q0(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=QX(n),e=jo(n,e),a){case 0:t=wk(null,t,n,e,r);break e;case 1:t=zO(null,t,n,e,r);break e;case 11:t=LO(null,t,n,e,r);break e;case 14:t=FO(null,t,n,jo(n.type,e),r);break e}throw Error(xt(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:jo(n,a),wk(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:jo(n,a),zO(e,t,n,a,r);case 3:e:{if(k6(t),e===null)throw Error(xt(387));n=t.pendingProps,i=t.memoizedState,a=i.element,QL(e,t),T_(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=mm(Error(xt(423)),t),t=BO(e,t,n,r,a);break e}else if(n!==a){a=mm(Error(xt(424)),t),t=BO(e,t,n,r,a);break e}else for(Ai=kd(t.stateNode.containerInfo.firstChild),Oi=t,rs=!0,Ao=null,r=XL(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(um(),n===a){t=Pc(e,t,r);break e}Fa(e,t,n,r)}t=t.child}return t;case 5:return e6(t),e===null&&gk(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,uk(n,a)?o=null:i!==null&&uk(n,i)&&(t.flags|=32),S6(e,t),Fa(e,t,o,r),t.child;case 6:return e===null&&gk(t),null;case 13:return E6(e,t,r);case 4:return WC(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=hm(t,null,n,r):Fa(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:jo(n,a),LO(e,t,n,a,r);case 7:return Fa(e,t,t.pendingProps,r),t.child;case 8:return Fa(e,t,t.pendingProps.children,r),t.child;case 12:return Fa(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,Un(C_,n._currentValue),n._currentValue=o,i!==null)if(qo(i.value,o)){if(i.children===a.children&&!ui.current){t=Pc(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=xc(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),vk(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(xt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),vk(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Fa(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Ff(t,r),a=lo(a),n=n(a),t.flags|=1,Fa(e,t,n,r),t.child;case 14:return n=t.type,a=jo(n,t.pendingProps),a=jo(n.type,a),FO(e,t,n,a,r);case 15:return j6(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:jo(n,a),Q0(e,t),t.tag=1,hi(n)?(e=!0,S_(t)):e=!1,Ff(t,r),_6(t,n,a),xk(t,n,a,r),bk(null,t,n,!0,e,r);case 19:return C6(e,t,r);case 22:return N6(e,t,r)}throw Error(xt(156,t.tag))};function V6(e,t){return vL(e,t)}function JX(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ji(e,t,r,n){return new JX(e,t,r,n)}function iP(e){return e=e.prototype,!(!e||!e.isReactComponent)}function QX(e){if(typeof e=="function")return iP(e)?1:0;if(e!=null){if(e=e.$$typeof,e===SC)return 11;if(e===kC)return 14}return 2}function Td(e,t){var r=e.alternate;return r===null?(r=Ji(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function r_(e,t,r,n,a,i){var o=2;if(n=e,typeof e=="function")iP(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case pf:return Gu(r.children,a,i,t);case NC:o=8,a|=8;break;case qS:return e=Ji(12,r,t,a|2),e.elementType=qS,e.lanes=i,e;case VS:return e=Ji(13,r,t,a),e.elementType=VS,e.lanes=i,e;case WS:return e=Ji(19,r,t,a),e.elementType=WS,e.lanes=i,e;case eL:return Pb(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case J$:o=10;break e;case Q$:o=9;break e;case SC:o=11;break e;case kC:o=14;break e;case sd:o=16,n=null;break e}throw Error(xt(130,e==null?e:typeof e,""))}return t=Ji(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Gu(e,t,r,n){return e=Ji(7,e,n,t),e.lanes=r,e}function Pb(e,t,r,n){return e=Ji(22,e,n,t),e.elementType=eL,e.lanes=r,e.stateNode={isHidden:!1},e}function hN(e,t,r){return e=Ji(6,e,null,t),e.lanes=r,e}function fN(e,t,r){return t=Ji(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function eJ(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gj(0),this.expirationTimes=Gj(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gj(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function oP(e,t,r,n,a,i,o,l,c){return e=new eJ(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ji(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},VC(i),e}function tJ(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mf,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function W6(e){if(!e)return Id;e=e._reactInternals;e:{if(_h(e)!==e||e.tag!==1)throw Error(xt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(hi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(xt(171))}if(e.tag===1){var r=e.type;if(hi(r))return WL(e,r,t)}return t}function H6(e,t,r,n,a,i,o,l,c){return e=oP(r,n,!0,e,a,i,o,l,c),e.context=W6(null),r=e.current,n=Va(),a=Pd(r),i=xc(n,a),i.callback=t!=null?t:null,Ed(r,i,a),e.current.lanes=a,Ty(e,a,n),fi(e,n),e}function Tb(e,t,r,n){var a=t.current,i=Va(),o=Pd(a);return r=W6(r),t.context===null?t.context=r:t.pendingContext=r,t=xc(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ed(a,t,o),e!==null&&(zo(e,a,o,i),Z0(e,a,o)),o}function L_(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function XO(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function lP(e,t){XO(e,t),(e=e.alternate)&&XO(e,t)}function rJ(){return null}var G6=typeof reportError=="function"?reportError:function(e){console.error(e)};function cP(e){this._internalRoot=e}Ab.prototype.render=cP.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(xt(409));Tb(e,t,null,null)};Ab.prototype.unmount=cP.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;nh(function(){Tb(null,e,null,null)}),t[Ec]=null}};function Ab(e){this._internalRoot=e}Ab.prototype.unstable_scheduleHydration=function(e){if(e){var t=NL();e={blockedOn:null,target:e,priority:t};for(var r=0;r<od.length&&t!==0&&t<od[r].priority;r++);od.splice(r,0,e),r===0&&kL(e)}};function dP(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Rb(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function JO(){}function nJ(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var d=L_(o);i.call(d)}}var o=H6(t,n,e,0,null,!1,!1,"",JO);return e._reactRootContainer=o,e[Ec]=o.current,pv(e.nodeType===8?e.parentNode:e),nh(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var d=L_(c);l.call(d)}}var c=oP(e,0,!1,null,null,!1,!1,"",JO);return e._reactRootContainer=c,e[Ec]=c.current,pv(e.nodeType===8?e.parentNode:e),nh(function(){Tb(t,c,r,n)}),c}function Ob(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var c=L_(o);l.call(c)}}Tb(t,o,e,a)}else o=nJ(r,t,e,a,n);return L_(o)}bL=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ag(t.pendingLanes);r!==0&&(PC(t,r|1),fi(t,ws()),!(vn&6)&&(pm=ws()+500,Yd()))}break;case 13:nh(function(){var n=Cc(e,1);if(n!==null){var a=Va();zo(n,e,1,a)}}),lP(e,1)}};TC=function(e){if(e.tag===13){var t=Cc(e,134217728);if(t!==null){var r=Va();zo(t,e,134217728,r)}lP(e,134217728)}};jL=function(e){if(e.tag===13){var t=Pd(e),r=Cc(e,t);if(r!==null){var n=Va();zo(r,e,t,n)}lP(e,t)}};NL=function(){return Tn};SL=function(e,t){var r=Tn;try{return Tn=e,t()}finally{Tn=r}};tk=function(e,t,r){switch(t){case"input":if(YS(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=jb(n);if(!a)throw Error(xt(90));rL(n),YS(n,a)}}}break;case"textarea":sL(e,r);break;case"select":t=r.value,t!=null&&Df(e,!!r.multiple,t,!1)}};uL=nP;hL=nh;var sJ={usingClientEntryPoint:!1,Events:[Ry,xf,jb,cL,dL,nP]},tg={findFiberByHostInstance:Su,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},aJ={bundleType:tg.bundleType,version:tg.version,rendererPackageName:tg.rendererPackageName,rendererConfig:tg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Lc.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=pL(e),e===null?null:e.stateNode},findFiberByHostInstance:tg.findFiberByHostInstance||rJ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"){var a0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!a0.isDisabled&&a0.supportsFiber)try{xb=a0.inject(aJ),kl=a0}catch(e){}}Ii.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sJ;Ii.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dP(t))throw Error(xt(200));return tJ(e,t,null,r)};Ii.createRoot=function(e,t){if(!dP(e))throw Error(xt(299));var r=!1,n="",a=G6;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=oP(e,1,!1,null,null,r,!1,n,a),e[Ec]=t.current,pv(e.nodeType===8?e.parentNode:e),new cP(t)};Ii.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(xt(188)):(e=Object.keys(e).join(","),Error(xt(268,e)));return e=pL(t),e=e===null?null:e.stateNode,e};Ii.flushSync=function(e){return nh(e)};Ii.hydrate=function(e,t,r){if(!Rb(t))throw Error(xt(200));return Ob(null,e,t,!0,r)};Ii.hydrateRoot=function(e,t,r){if(!dP(e))throw Error(xt(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=G6;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=H6(t,null,e,1,r!=null?r:null,a,!1,i,o),e[Ec]=t.current,pv(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Ab(t)};Ii.render=function(e,t,r){if(!Rb(t))throw Error(xt(200));return Ob(null,e,t,!1,r)};Ii.unmountComponentAtNode=function(e){if(!Rb(e))throw Error(xt(40));return e._reactRootContainer?(nh(function(){Ob(null,null,e,!1,function(){e._reactRootContainer=null,e[Ec]=null})}),!0):!1};Ii.unstable_batchedUpdates=nP;Ii.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Rb(r))throw Error(xt(200));if(e==null||e._reactInternals===void 0)throw Error(xt(38));return Ob(e,t,r,!1,n)};Ii.version="18.3.1-next-f1338f8080-20240426";function Y6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Y6)}catch(e){console.error(e)}}Y6(),Y$.exports=Ii;var so=Y$.exports;const Bf=yn(so);var K6,QO=so;K6=QO.createRoot,QO.hydrateRoot;const iJ=1,oJ=1e6;let mN=0;function lJ(){return mN=(mN+1)%Number.MAX_SAFE_INTEGER,mN.toString()}const pN=new Map,eM=e=>{if(pN.has(e))return;const t=setTimeout(()=>{pN.delete(e),Kg({type:"REMOVE_TOAST",toastId:e})},oJ);pN.set(e,t)},cJ=(e,t)=>{switch(t.type){case"ADD_TOAST":return H(M({},e),{toasts:[t.toast,...e.toasts].slice(0,iJ)});case"UPDATE_TOAST":return H(M({},e),{toasts:e.toasts.map(r=>r.id===t.toast.id?M(M({},r),t.toast):r)});case"DISMISS_TOAST":{const{toastId:r}=t;return r?eM(r):e.toasts.forEach(n=>{eM(n.id)}),H(M({},e),{toasts:e.toasts.map(n=>n.id===r||r===void 0?H(M({},n),{open:!1}):n)})}case"REMOVE_TOAST":return t.toastId===void 0?H(M({},e),{toasts:[]}):H(M({},e),{toasts:e.toasts.filter(r=>r.id!==t.toastId)})}},n_=[];let s_={toasts:[]};function Kg(e){s_=cJ(s_,e),n_.forEach(t=>{t(s_)})}function dJ(t){var e=me(t,[]);const r=lJ(),n=i=>Kg({type:"UPDATE_TOAST",toast:H(M({},i),{id:r})}),a=()=>Kg({type:"DISMISS_TOAST",toastId:r});return Kg({type:"ADD_TOAST",toast:H(M({},e),{id:r,open:!0,onOpenChange:i=>{i||a()}})}),{id:r,dismiss:a,update:n}}function Rr(){const[e,t]=x.useState(s_);return x.useEffect(()=>(n_.push(t),()=>{const r=n_.indexOf(t);r>-1&&n_.splice(r,1)}),[e]),H(M({},e),{toast:dJ,dismiss:r=>Kg({type:"DISMISS_TOAST",toastId:r})})}function pt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function tM(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Tc(...e){return t=>{let r=!1;const n=e.map(a=>{const i=tM(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():tM(e[a],null)}}}}function cr(...e){return x.useCallback(Tc(...e),e)}function uJ(e,t){const r=x.createContext(t),n=i=>{const d=i,{children:o}=d,l=me(d,["children"]),c=x.useMemo(()=>l,Object.values(l));return s.jsx(r.Provider,{value:c,children:o})};n.displayName=e+"Provider";function a(i){const o=x.useContext(r);if(o)return o;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[n,a]}function Os(e,t=[]){let r=[];function n(i,o){const l=x.createContext(o),c=r.length;r=[...r,o];const d=f=>{var w;const _=f,{scope:h,children:p}=_,g=me(_,["scope","children"]),v=((w=h==null?void 0:h[e])==null?void 0:w[c])||l,y=x.useMemo(()=>g,Object.values(g));return s.jsx(v.Provider,{value:y,children:p})};d.displayName=i+"Provider";function u(f,h){var v;const p=((v=h==null?void 0:h[e])==null?void 0:v[c])||l,g=x.useContext(p);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[d,u]}const a=()=>{const i=r.map(o=>x.createContext(o));return function(l){const c=(l==null?void 0:l[e])||i;return x.useMemo(()=>({[`__scope${e}`]:H(M({},l),{[e]:c})}),[l,c])}};return a.scopeName=e,[n,hJ(a,...t)]}function hJ(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:d})=>{const f=c(i)[`__scope${d}`];return M(M({},l),f)},{});return x.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function $d(e){const t=mJ(e),r=x.forwardRef((n,a)=>{const d=n,{children:i}=d,o=me(d,["children"]),l=x.Children.toArray(i),c=l.find(pJ);if(c){const u=c.props.children,f=l.map(h=>h===c?x.Children.count(u)>1?x.Children.only(null):x.isValidElement(u)?u.props.children:null:h);return s.jsx(t,H(M({},o),{ref:a,children:x.isValidElement(u)?x.cloneElement(u,void 0,f):null}))}return s.jsx(t,H(M({},o),{ref:a,children:i}))});return r.displayName=`${e}.Slot`,r}var fJ=$d("Slot");function mJ(e){const t=x.forwardRef((r,n)=>{const o=r,{children:a}=o,i=me(o,["children"]);if(x.isValidElement(a)){const l=vJ(a),c=gJ(i,a.props);return a.type!==x.Fragment&&(c.ref=n?Tc(n,l):l),x.cloneElement(a,c)}return x.Children.count(a)>1?x.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Z6=Symbol("radix.slottable");function X6(e){const t=({children:r})=>s.jsx(s.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=Z6,t}function pJ(e){return x.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Z6}function gJ(e,t){const r=M({},t);for(const n in t){const a=e[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{const c=i(...l);return a(...l),c}:a&&(r[n]=a):n==="style"?r[n]=M(M({},a),i):n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return M(M({},e),r)}function vJ(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function ip(e){const t=e+"CollectionProvider",[r,n]=Os(t),[a,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=v=>{const{scope:y,children:_}=v,w=J.useRef(null),b=J.useRef(new Map).current;return s.jsx(a,{scope:y,itemMap:b,collectionRef:w,children:_})};o.displayName=t;const l=e+"CollectionSlot",c=$d(l),d=J.forwardRef((v,y)=>{const{scope:_,children:w}=v,b=i(l,_),N=cr(y,b.collectionRef);return s.jsx(c,{ref:N,children:w})});d.displayName=l;const u=e+"CollectionItemSlot",f="data-radix-collection-item",h=$d(u),p=J.forwardRef((v,y)=>{const P=v,{scope:_,children:w}=P,b=me(P,["scope","children"]),N=J.useRef(null),S=cr(y,N),k=i(u,_);return J.useEffect(()=>(k.itemMap.set(N,M({ref:N},b)),()=>void k.itemMap.delete(N))),s.jsx(h,{[f]:"",ref:S,children:w})});p.displayName=u;function g(v){const y=i(e+"CollectionConsumer",v);return J.useCallback(()=>{const w=y.collectionRef.current;if(!w)return[];const b=Array.from(w.querySelectorAll(`[${f}]`));return Array.from(y.itemMap.values()).sort((k,P)=>b.indexOf(k.ref.current)-b.indexOf(P.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:o,Slot:d,ItemSlot:p},g,n]}var yJ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ct=yJ.reduce((e,t)=>{const r=$d(`Primitive.${t}`),n=x.forwardRef((a,i)=>{const d=a,{asChild:o}=d,l=me(d,["asChild"]),c=o?r:t;return typeof window!="undefined"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(c,H(M({},l),{ref:i}))});return n.displayName=`Primitive.${t}`,H(M({},e),{[t]:n})},{});function uP(e,t){e&&so.flushSync(()=>e.dispatchEvent(t))}function gs(e){const t=x.useRef(e);return x.useEffect(()=>{t.current=e}),x.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function xJ(e,t=globalThis==null?void 0:globalThis.document){const r=gs(e);x.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var _J="DismissableLayer",Mk="dismissableLayer.update",wJ="dismissableLayer.pointerDownOutside",bJ="dismissableLayer.focusOutside",rM,J6=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),wh=x.forwardRef((e,t)=>{var A;const P=e,{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:l}=P,c=me(P,["disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss"]),d=x.useContext(J6),[u,f]=x.useState(null),h=(A=u==null?void 0:u.ownerDocument)!=null?A:globalThis==null?void 0:globalThis.document,[,p]=x.useState({}),g=cr(t,R=>f(R)),v=Array.from(d.layers),[y]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),_=v.indexOf(y),w=u?v.indexOf(u):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,N=w>=_,S=NJ(R=>{const $=R.target,O=[...d.branches].some(z=>z.contains($));!N||O||(a==null||a(R),o==null||o(R),R.defaultPrevented||l==null||l())},h),k=SJ(R=>{const $=R.target;[...d.branches].some(z=>z.contains($))||(i==null||i(R),o==null||o(R),R.defaultPrevented||l==null||l())},h);return xJ(R=>{w===d.layers.size-1&&(n==null||n(R),!R.defaultPrevented&&l&&(R.preventDefault(),l()))},h),x.useEffect(()=>{if(u)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(rM=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),nM(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=rM)}},[u,h,r,d]),x.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),nM())},[u,d]),x.useEffect(()=>{const R=()=>p({});return document.addEventListener(Mk,R),()=>document.removeEventListener(Mk,R)},[]),s.jsx(Ct.div,H(M({},c),{ref:g,style:M({pointerEvents:b?N?"auto":"none":void 0},e.style),onFocusCapture:pt(e.onFocusCapture,k.onFocusCapture),onBlurCapture:pt(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:pt(e.onPointerDownCapture,S.onPointerDownCapture)}))});wh.displayName=_J;var jJ="DismissableLayerBranch",Q6=x.forwardRef((e,t)=>{const r=x.useContext(J6),n=x.useRef(null),a=cr(t,n);return x.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),s.jsx(Ct.div,H(M({},e),{ref:a}))});Q6.displayName=jJ;function NJ(e,t=globalThis==null?void 0:globalThis.document){const r=gs(e),n=x.useRef(!1),a=x.useRef(()=>{});return x.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){eF(wJ,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function SJ(e,t=globalThis==null?void 0:globalThis.document){const r=gs(e),n=x.useRef(!1);return x.useEffect(()=>{const a=i=>{i.target&&!n.current&&eF(bJ,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function nM(){const e=new CustomEvent(Mk);document.dispatchEvent(e)}function eF(e,t,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?uP(a,i):a.dispatchEvent(i)}var kJ=wh,EJ=Q6,vs=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},CJ="Portal",op=x.forwardRef((e,t)=>{var c;const l=e,{container:r}=l,n=me(l,["container"]),[a,i]=x.useState(!1);vs(()=>i(!0),[]);const o=r||a&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return o?Bf.createPortal(s.jsx(Ct.div,H(M({},n),{ref:t})),o):null});op.displayName=CJ;function PJ(e,t){return x.useReducer((r,n)=>{const a=t[r][n];return a!=null?a:r},e)}var Ys=e=>{const{present:t,children:r}=e,n=TJ(t),a=typeof r=="function"?r({present:n.isPresent}):x.Children.only(r),i=cr(n.ref,AJ(a));return typeof r=="function"||n.isPresent?x.cloneElement(a,{ref:i}):null};Ys.displayName="Presence";function TJ(e){const[t,r]=x.useState(),n=x.useRef(null),a=x.useRef(e),i=x.useRef("none"),o=e?"mounted":"unmounted",[l,c]=PJ(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const d=i0(n.current);i.current=l==="mounted"?d:"none"},[l]),vs(()=>{const d=n.current,u=a.current;if(u!==e){const h=i.current,p=i0(d);e?c("MOUNT"):p==="none"||(d==null?void 0:d.display)==="none"?c("UNMOUNT"):c(u&&h!==p?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),vs(()=>{var d;if(t){let u;const f=(d=t.ownerDocument.defaultView)!=null?d:window,h=g=>{const y=i0(n.current).includes(g.animationName);if(g.target===t&&y&&(c("ANIMATION_END"),!a.current)){const _=t.style.animationFillMode;t.style.animationFillMode="forwards",u=f.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=_)})}},p=g=>{g.target===t&&(i.current=i0(n.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{f.clearTimeout(u),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:x.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function i0(e){return(e==null?void 0:e.animationName)||"none"}function AJ(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var RJ=_C[" useInsertionEffect ".trim().toString()]||vs;function Wa({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,i,o]=OJ({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:a;{const u=x.useRef(e!==void 0);x.useEffect(()=>{const f=u.current;f!==l&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=l},[l,n])}const d=x.useCallback(u=>{var f;if(l){const h=MJ(u)?u(e):u;h!==e&&((f=o.current)==null||f.call(o,h))}else i(u)},[l,e,i,o]);return[c,d]}function OJ({defaultProp:e,onChange:t}){const[r,n]=x.useState(e),a=x.useRef(r),i=x.useRef(t);return RJ(()=>{i.current=t},[t]),x.useEffect(()=>{var o;a.current!==r&&((o=i.current)==null||o.call(i,r),a.current=r)},[r,a]),[r,n,i]}function MJ(e){return typeof e=="function"}var tF=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),DJ="VisuallyHidden",Mb=x.forwardRef((e,t)=>s.jsx(Ct.span,H(M({},e),{ref:t,style:M(M({},tF),e.style)})));Mb.displayName=DJ;var IJ=Mb,hP="ToastProvider",[fP,$J,LJ]=ip("Toast"),[rF,fBe]=Os("Toast",[LJ]),[FJ,Db]=rF(hP),nF=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:o}=e,[l,c]=x.useState(null),[d,u]=x.useState(0),f=x.useRef(!1),h=x.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${hP}\`. Expected non-empty \`string\`.`),s.jsx(fP.Provider,{scope:t,children:s.jsx(FJ,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:i,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:x.useCallback(()=>u(p=>p+1),[]),onToastRemove:x.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:h,children:o})})};nF.displayName=hP;var sF="ToastViewport",zJ=["F8"],Dk="toast.viewportPause",Ik="toast.viewportResume",aF=x.forwardRef((e,t)=>{const y=e,{__scopeToast:r,hotkey:n=zJ,label:a="Notifications ({hotkey})"}=y,i=me(y,["__scopeToast","hotkey","label"]),o=Db(sF,r),l=$J(r),c=x.useRef(null),d=x.useRef(null),u=x.useRef(null),f=x.useRef(null),h=cr(t,f,o.onViewportChange),p=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;x.useEffect(()=>{const _=w=>{var N;n.length!==0&&n.every(S=>w[S]||w.code===S)&&((N=f.current)==null||N.focus())};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[n]),x.useEffect(()=>{const _=c.current,w=f.current;if(g&&_&&w){const b=()=>{if(!o.isClosePausedRef.current){const P=new CustomEvent(Dk);w.dispatchEvent(P),o.isClosePausedRef.current=!0}},N=()=>{if(o.isClosePausedRef.current){const P=new CustomEvent(Ik);w.dispatchEvent(P),o.isClosePausedRef.current=!1}},S=P=>{!_.contains(P.relatedTarget)&&N()},k=()=>{_.contains(document.activeElement)||N()};return _.addEventListener("focusin",b),_.addEventListener("focusout",S),_.addEventListener("pointermove",b),_.addEventListener("pointerleave",k),window.addEventListener("blur",b),window.addEventListener("focus",N),()=>{_.removeEventListener("focusin",b),_.removeEventListener("focusout",S),_.removeEventListener("pointermove",b),_.removeEventListener("pointerleave",k),window.removeEventListener("blur",b),window.removeEventListener("focus",N)}}},[g,o.isClosePausedRef]);const v=x.useCallback(({tabbingDirection:_})=>{const b=l().map(N=>{const S=N.ref.current,k=[S,...QJ(S)];return _==="forwards"?k:k.reverse()});return(_==="forwards"?b.reverse():b).flat()},[l]);return x.useEffect(()=>{const _=f.current;if(_){const w=b=>{var k,P,A;const N=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!N){const R=document.activeElement,$=b.shiftKey;if(b.target===_&&$){(k=d.current)==null||k.focus();return}const D=v({tabbingDirection:$?"backwards":"forwards"}),B=D.findIndex(F=>F===R);gN(D.slice(B+1))?b.preventDefault():$?(P=d.current)==null||P.focus():(A=u.current)==null||A.focus()}};return _.addEventListener("keydown",w),()=>_.removeEventListener("keydown",w)}},[l,v]),s.jsxs(EJ,{ref:c,role:"region","aria-label":a.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&s.jsx($k,{ref:d,onFocusFromOutsideViewport:()=>{const _=v({tabbingDirection:"forwards"});gN(_)}}),s.jsx(fP.Slot,{scope:r,children:s.jsx(Ct.ol,H(M({tabIndex:-1},i),{ref:h}))}),g&&s.jsx($k,{ref:u,onFocusFromOutsideViewport:()=>{const _=v({tabbingDirection:"backwards"});gN(_)}})]})});aF.displayName=sF;var iF="ToastFocusProxy",$k=x.forwardRef((e,t)=>{const o=e,{__scopeToast:r,onFocusFromOutsideViewport:n}=o,a=me(o,["__scopeToast","onFocusFromOutsideViewport"]),i=Db(iF,r);return s.jsx(Mb,H(M({"aria-hidden":!0,tabIndex:0},a),{ref:t,style:{position:"fixed"},onFocus:l=>{var u;const c=l.relatedTarget;!((u=i.viewport)!=null&&u.contains(c))&&n()}}))});$k.displayName=iF;var My="Toast",BJ="toast.swipeStart",UJ="toast.swipeMove",qJ="toast.swipeCancel",VJ="toast.swipeEnd",oF=x.forwardRef((e,t)=>{const d=e,{forceMount:r,open:n,defaultOpen:a,onOpenChange:i}=d,o=me(d,["forceMount","open","defaultOpen","onOpenChange"]),[l,c]=Wa({prop:n,defaultProp:a!=null?a:!0,onChange:i,caller:My});return s.jsx(Ys,{present:r||l,children:s.jsx(GJ,H(M({open:l},o),{ref:t,onClose:()=>c(!1),onPause:gs(e.onPause),onResume:gs(e.onResume),onSwipeStart:pt(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:pt(e.onSwipeMove,u=>{const{x:f,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:pt(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:pt(e.onSwipeEnd,u=>{const{x:f,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})}))})});oF.displayName=My;var[WJ,HJ]=rF(My,{onClose(){}}),GJ=x.forwardRef((e,t)=>{const B=e,{__scopeToast:r,type:n="foreground",duration:a,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:u,onSwipeMove:f,onSwipeCancel:h,onSwipeEnd:p}=B,g=me(B,["__scopeToast","type","duration","open","onClose","onEscapeKeyDown","onPause","onResume","onSwipeStart","onSwipeMove","onSwipeCancel","onSwipeEnd"]),v=Db(My,r),[y,_]=x.useState(null),w=cr(t,F=>_(F)),b=x.useRef(null),N=x.useRef(null),S=a||v.duration,k=x.useRef(0),P=x.useRef(S),A=x.useRef(0),{onToastAdd:R,onToastRemove:$}=v,O=gs(()=>{var U;(y==null?void 0:y.contains(document.activeElement))&&((U=v.viewport)==null||U.focus()),o()}),z=x.useCallback(F=>{!F||F===1/0||(window.clearTimeout(A.current),k.current=new Date().getTime(),A.current=window.setTimeout(O,F))},[O]);x.useEffect(()=>{const F=v.viewport;if(F){const U=()=>{z(P.current),d==null||d()},G=()=>{const q=new Date().getTime()-k.current;P.current=P.current-q,window.clearTimeout(A.current),c==null||c()};return F.addEventListener(Dk,G),F.addEventListener(Ik,U),()=>{F.removeEventListener(Dk,G),F.removeEventListener(Ik,U)}}},[v.viewport,S,c,d,z]),x.useEffect(()=>{i&&!v.isClosePausedRef.current&&z(S)},[i,S,v.isClosePausedRef,z]),x.useEffect(()=>(R(),()=>$()),[R,$]);const D=x.useMemo(()=>y?mF(y):null,[y]);return v.viewport?s.jsxs(s.Fragment,{children:[D&&s.jsx(YJ,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:D}),s.jsx(WJ,{scope:r,onClose:O,children:so.createPortal(s.jsx(fP.ItemSlot,{scope:r,children:s.jsx(kJ,{asChild:!0,onEscapeKeyDown:pt(l,()=>{v.isFocusedToastEscapeKeyDownRef.current||O(),v.isFocusedToastEscapeKeyDownRef.current=!1}),children:s.jsx(Ct.li,H(M({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":v.swipeDirection},g),{ref:w,style:M({userSelect:"none",touchAction:"none"},e.style),onKeyDown:pt(e.onKeyDown,F=>{F.key==="Escape"&&(l==null||l(F.nativeEvent),F.nativeEvent.defaultPrevented||(v.isFocusedToastEscapeKeyDownRef.current=!0,O()))}),onPointerDown:pt(e.onPointerDown,F=>{F.button===0&&(b.current={x:F.clientX,y:F.clientY})}),onPointerMove:pt(e.onPointerMove,F=>{if(!b.current)return;const U=F.clientX-b.current.x,G=F.clientY-b.current.y,q=!!N.current,K=["left","right"].includes(v.swipeDirection),Z=["left","up"].includes(v.swipeDirection)?Math.min:Math.max,Y=K?Z(0,U):0,Q=K?0:Z(0,G),X=F.pointerType==="touch"?10:2,ne={x:Y,y:Q},re={originalEvent:F,delta:ne};q?(N.current=ne,o0(UJ,f,re,{discrete:!1})):sM(ne,v.swipeDirection,X)?(N.current=ne,o0(BJ,u,re,{discrete:!1}),F.target.setPointerCapture(F.pointerId)):(Math.abs(U)>X||Math.abs(G)>X)&&(b.current=null)}),onPointerUp:pt(e.onPointerUp,F=>{const U=N.current,G=F.target;if(G.hasPointerCapture(F.pointerId)&&G.releasePointerCapture(F.pointerId),N.current=null,b.current=null,U){const q=F.currentTarget,K={originalEvent:F,delta:U};sM(U,v.swipeDirection,v.swipeThreshold)?o0(VJ,p,K,{discrete:!0}):o0(qJ,h,K,{discrete:!0}),q.addEventListener("click",Z=>Z.preventDefault(),{once:!0})}})}))})}),v.viewport)})]}):null}),YJ=e=>{const d=e,{__scopeToast:t,children:r}=d,n=me(d,["__scopeToast","children"]),a=Db(My,t),[i,o]=x.useState(!1),[l,c]=x.useState(!1);return XJ(()=>o(!0)),x.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:s.jsx(op,{asChild:!0,children:s.jsx(Mb,H(M({},n),{children:i&&s.jsxs(s.Fragment,{children:[a.label," ",r]})}))})},KJ="ToastTitle",lF=x.forwardRef((e,t)=>{const a=e,{__scopeToast:r}=a,n=me(a,["__scopeToast"]);return s.jsx(Ct.div,H(M({},n),{ref:t}))});lF.displayName=KJ;var ZJ="ToastDescription",cF=x.forwardRef((e,t)=>{const a=e,{__scopeToast:r}=a,n=me(a,["__scopeToast"]);return s.jsx(Ct.div,H(M({},n),{ref:t}))});cF.displayName=ZJ;var dF="ToastAction",uF=x.forwardRef((e,t)=>{const a=e,{altText:r}=a,n=me(a,["altText"]);return r.trim()?s.jsx(fF,{altText:r,asChild:!0,children:s.jsx(mP,H(M({},n),{ref:t}))}):(console.error(`Invalid prop \`altText\` supplied to \`${dF}\`. Expected non-empty \`string\`.`),null)});uF.displayName=dF;var hF="ToastClose",mP=x.forwardRef((e,t)=>{const i=e,{__scopeToast:r}=i,n=me(i,["__scopeToast"]),a=HJ(hF,r);return s.jsx(fF,{asChild:!0,children:s.jsx(Ct.button,H(M({type:"button"},n),{ref:t,onClick:pt(e.onClick,a.onClose)}))})});mP.displayName=hF;var fF=x.forwardRef((e,t)=>{const i=e,{__scopeToast:r,altText:n}=i,a=me(i,["__scopeToast","altText"]);return s.jsx(Ct.div,H(M({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0},a),{ref:t}))});function mF(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),JJ(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const o=n.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...mF(n))}}),t}function o0(e,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?uP(a,i):a.dispatchEvent(i)}var sM=(e,t,r=0)=>{const n=Math.abs(e.x),a=Math.abs(e.y),i=n>a;return t==="left"||t==="right"?i&&n>r:!i&&a>r};function XJ(e=()=>{}){const t=gs(e);vs(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function JJ(e){return e.nodeType===e.ELEMENT_NODE}function QJ(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function gN(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var eQ=nF,pF=aF,gF=oF,vF=lF,yF=cF,xF=uF,_F=mP;function wF(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=wF(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function an(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=wF(e))&&(n&&(n+=" "),n+=t);return n}const aM=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,iM=an,lp=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return iM(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,o=Object.keys(a).map(d=>{const u=r==null?void 0:r[d],f=i==null?void 0:i[d];if(u===null)return null;const h=aM(u)||aM(f);return a[d][h]}),l=r&&Object.entries(r).reduce((d,u)=>{let[f,h]=u;return h===void 0||(d[f]=h),d},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,u)=>{let g=u,{class:f,className:h}=g,p=me(g,["class","className"]);return Object.entries(p).every(v=>{let[y,_]=v;return Array.isArray(_)?_.includes(M(M({},i),l)[y]):M(M({},i),l)[y]===_})?[...d,f,h]:d},[]);return iM(e,o,c,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tQ=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),bF=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rQ={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nQ=x.forwardRef((d,c)=>{var u=d,{color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o}=u,l=me(u,["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"]);return x.createElement("svg",M(H(M({ref:c},rQ),{width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:bF("lucide",a)}),l),[...o.map(([f,h])=>x.createElement(f,h)),...Array.isArray(i)?i:[i]])});/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=(e,t)=>{const r=x.forwardRef((o,i)=>{var l=o,{className:n}=l,a=me(l,["className"]);return x.createElement(nQ,M({ref:i,iconNode:t,className:bF(`lucide-${tQ(e)}`,n)},a))});return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=tt("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sQ=tt("ArrowDownUp",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aQ=tt("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=tt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=tt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iQ=tt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oQ=tt("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=tt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lk=tt("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ac=tt("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lQ=tt("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F_=tt("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cQ=tt("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ld=tt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dQ=tt("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=tt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=tt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nv=tt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fd=tt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ib=tt("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=tt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=tt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pP=tt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dy=tt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mo=tt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=tt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=tt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uQ=tt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hQ=tt("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fQ=tt("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mQ=tt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=tt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=tt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gP=tt("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pQ=tt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sh=tt("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gQ=tt("Disc",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=tt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=tt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vQ=tt("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yQ=tt("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=tt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xQ=tt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=tt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _Q=tt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iy=tt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=tt("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wQ=tt("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=tt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bQ=tt("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fk=tt("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jQ=tt("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NQ=tt("HeartOff",[["line",{x1:"2",y1:"2",x2:"22",y2:"22",key:"1w4vcy"}],["path",{d:"M16.5 16.5 12 21l-7-7c-1.5-1.45-3-3.2-3-5.5a5.5 5.5 0 0 1 2.14-4.35",key:"3mpagl"}],["path",{d:"M8.76 3.1c1.15.22 2.13.78 3.24 1.9 1.5-1.5 2.74-2 4.5-2A5.5 5.5 0 0 1 22 8.5c0 2.12-1.3 3.78-2.67 5.17",key:"1gh3v3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=tt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vP=tt("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kv=tt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yP=tt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xP=tt("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=tt("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SQ=tt("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kQ=tt("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=tt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ev=tt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=tt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=tt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=tt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=tt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EQ=tt("MapPinned",[["path",{d:"M18 8c0 3.613-3.869 7.429-5.393 8.795a1 1 0 0 1-1.214 0C9.87 15.429 6 11.613 6 8a6 6 0 0 1 12 0",key:"11u0oz"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M8.714 14h-3.71a1 1 0 0 0-.948.683l-2.004 6A1 1 0 0 0 3 22h18a1 1 0 0 0 .948-1.316l-2-6a1 1 0 0 0-.949-.684h-3.712",key:"q8zwxj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CQ=tt("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PQ=tt("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TQ=tt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=tt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kf=tt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AQ=tt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=tt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _P=tt("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RQ=tt("Music2",[["circle",{cx:"8",cy:"18",r:"4",key:"1fc0mg"}],["path",{d:"M12 18V2l7 4",key:"g04rme"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=tt("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wP=tt("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OQ=tt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=tt("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MQ=tt("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DQ=tt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=tt("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IQ=tt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vo=tt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=tt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=tt("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zk=tt("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bP=tt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=tt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fc=tt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jP=tt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zd=tt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Q=tt("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gl=tt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LQ=tt("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=tt("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _c=tt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FQ=tt("SquarePlus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zQ=tt("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=tt("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zi=tt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=tt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ml=tt("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=tt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=tt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=tt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NP=tt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bd=tt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=tt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=tt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=tt("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ad=tt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bk=tt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=tt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=tt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=tt("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=tt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uk=tt("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),SP="-",BQ=e=>{const t=qQ(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:o=>{const l=o.split(SP);return l[0]===""&&l.length!==1&&l.shift(),IF(l,t)||UQ(o)},getConflictingClassGroupIds:(o,l)=>{const c=r[o]||[];return l&&n[o]?[...c,...n[o]]:c}}},IF=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?IF(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(SP);return(o=t.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},lM=/^\[(.+)\]$/,UQ=e=>{if(lM.test(e)){const t=lM.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},qQ=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return WQ(Object.entries(e.classGroups),r).forEach(([i,o])=>{qk(o,n,i,t)}),n},qk=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:cM(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(VQ(a)){qk(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,o])=>{qk(o,cM(t,i),r,n)})})},cM=(e,t)=>{let r=e;return t.split(SP).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},VQ=e=>e.isThemeGetter,WQ=(e,t)=>t?e.map(([r,n])=>{const a=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[t+o,l])):i);return[r,a]}):e,HQ=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(i,o)=>{r.set(i,o),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return a(i,o),o},set(i,o){r.has(i)?r.set(i,o):a(i,o)}}},$F="!",GQ=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],i=t.length,o=l=>{const c=[];let d=0,u=0,f;for(let y=0;y<l.length;y++){let _=l[y];if(d===0){if(_===a&&(n||l.slice(y,y+i)===t)){c.push(l.slice(u,y)),u=y+i;continue}if(_==="/"){f=y;continue}}_==="["?d++:_==="]"&&d--}const h=c.length===0?l:l.substring(u),p=h.startsWith($F),g=p?h.substring(1):h,v=f&&f>u?f-u:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:v}};return r?l=>r({className:l,parseClassName:o}):o},YQ=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},KQ=e=>M({cache:HQ(e.cacheSize),parseClassName:GQ(e)},BQ(e)),ZQ=/\s+/,XQ=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,i=[],o=e.trim().split(ZQ);let l="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{modifiers:u,hasImportantModifier:f,baseClassName:h,maybePostfixModifierPosition:p}=r(d);let g=!!p,v=n(g?h.substring(0,p):h);if(!v){if(!g){l=d+(l.length>0?" "+l:l);continue}if(v=n(h),!v){l=d+(l.length>0?" "+l:l);continue}g=!1}const y=YQ(u).join(":"),_=f?y+$F:y,w=_+v;if(i.includes(w))continue;i.push(w);const b=a(v,g);for(let N=0;N<b.length;++N){const S=b[N];i.push(_+S)}l=d+(l.length>0?" "+l:l)}return l};function JQ(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=LF(t))&&(n&&(n+=" "),n+=r);return n}const LF=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=LF(e[n]))&&(r&&(r+=" "),r+=t);return r};function QQ(e,...t){let r,n,a,i=o;function o(c){const d=t.reduce((u,f)=>f(u),e());return r=KQ(d),n=r.cache.get,a=r.cache.set,i=l,l(c)}function l(c){const d=n(c);if(d)return d;const u=XQ(c,r);return a(c,u),u}return function(){return i(JQ.apply(null,arguments))}}const Yn=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},FF=/^\[(?:([a-z-]+):)?(.+)\]$/i,eee=/^\d+\/\d+$/,tee=new Set(["px","full","screen"]),ree=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,nee=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,see=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,aee=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,iee=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Kl=e=>Uf(e)||tee.has(e)||eee.test(e),Zc=e=>dp(e,"length",mee),Uf=e=>!!e&&!Number.isNaN(Number(e)),yN=e=>dp(e,"number",Uf),rg=e=>!!e&&Number.isInteger(Number(e)),oee=e=>e.endsWith("%")&&Uf(e.slice(0,-1)),Lr=e=>FF.test(e),Xc=e=>ree.test(e),lee=new Set(["length","size","percentage"]),cee=e=>dp(e,lee,zF),dee=e=>dp(e,"position",zF),uee=new Set(["image","url"]),hee=e=>dp(e,uee,gee),fee=e=>dp(e,"",pee),ng=()=>!0,dp=(e,t,r)=>{const n=FF.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},mee=e=>nee.test(e)&&!see.test(e),zF=()=>!1,pee=e=>aee.test(e),gee=e=>iee.test(e),vee=()=>{const e=Yn("colors"),t=Yn("spacing"),r=Yn("blur"),n=Yn("brightness"),a=Yn("borderColor"),i=Yn("borderRadius"),o=Yn("borderSpacing"),l=Yn("borderWidth"),c=Yn("contrast"),d=Yn("grayscale"),u=Yn("hueRotate"),f=Yn("invert"),h=Yn("gap"),p=Yn("gradientColorStops"),g=Yn("gradientColorStopPositions"),v=Yn("inset"),y=Yn("margin"),_=Yn("opacity"),w=Yn("padding"),b=Yn("saturate"),N=Yn("scale"),S=Yn("sepia"),k=Yn("skew"),P=Yn("space"),A=Yn("translate"),R=()=>["auto","contain","none"],$=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto",Lr,t],z=()=>[Lr,t],D=()=>["",Kl,Zc],B=()=>["auto",Uf,Lr],F=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],U=()=>["solid","dashed","dotted","double","none"],G=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],q=()=>["start","end","center","between","around","evenly","stretch"],K=()=>["","0",Lr],Z=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Y=()=>[Uf,Lr];return{cacheSize:500,separator:":",theme:{colors:[ng],spacing:[Kl,Zc],blur:["none","",Xc,Lr],brightness:Y(),borderColor:[e],borderRadius:["none","","full",Xc,Lr],borderSpacing:z(),borderWidth:D(),contrast:Y(),grayscale:K(),hueRotate:Y(),invert:K(),gap:z(),gradientColorStops:[e],gradientColorStopPositions:[oee,Zc],inset:O(),margin:O(),opacity:Y(),padding:z(),saturate:Y(),scale:Y(),sepia:K(),skew:Y(),space:z(),translate:z()},classGroups:{aspect:[{aspect:["auto","square","video",Lr]}],container:["container"],columns:[{columns:[Xc]}],"break-after":[{"break-after":Z()}],"break-before":[{"break-before":Z()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...F(),Lr]}],overflow:[{overflow:$()}],"overflow-x":[{"overflow-x":$()}],"overflow-y":[{"overflow-y":$()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",rg,Lr]}],basis:[{basis:O()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Lr]}],grow:[{grow:K()}],shrink:[{shrink:K()}],order:[{order:["first","last","none",rg,Lr]}],"grid-cols":[{"grid-cols":[ng]}],"col-start-end":[{col:["auto",{span:["full",rg,Lr]},Lr]}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":[ng]}],"row-start-end":[{row:["auto",{span:[rg,Lr]},Lr]}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Lr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Lr]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...q()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...q(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...q(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[P]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[P]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Lr,t]}],"min-w":[{"min-w":[Lr,t,"min","max","fit"]}],"max-w":[{"max-w":[Lr,t,"none","full","min","max","fit","prose",{screen:[Xc]},Xc]}],h:[{h:[Lr,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Lr,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Lr,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Lr,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Xc,Zc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",yN]}],"font-family":[{font:[ng]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Lr]}],"line-clamp":[{"line-clamp":["none",Uf,yN]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Kl,Lr]}],"list-image":[{"list-image":["none",Lr]}],"list-style-type":[{list:["none","disc","decimal",Lr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[_]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[_]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...U(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Kl,Zc]}],"underline-offset":[{"underline-offset":["auto",Kl,Lr]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:z()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Lr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Lr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[_]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...F(),dee]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",cee]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},hee]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[_]}],"border-style":[{border:[...U(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[_]}],"divide-style":[{divide:U()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...U()]}],"outline-offset":[{"outline-offset":[Kl,Lr]}],"outline-w":[{outline:[Kl,Zc]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:D()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[_]}],"ring-offset-w":[{"ring-offset":[Kl,Zc]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Xc,fee]}],"shadow-color":[{shadow:[ng]}],opacity:[{opacity:[_]}],"mix-blend":[{"mix-blend":[...G(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":G()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Xc,Lr]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[b]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[_]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Lr]}],duration:[{duration:Y()}],ease:[{ease:["linear","in","out","in-out",Lr]}],delay:[{delay:Y()}],animate:[{animate:["none","spin","ping","pulse","bounce",Lr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[rg,Lr]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Lr]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Lr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":z()}],"scroll-mx":[{"scroll-mx":z()}],"scroll-my":[{"scroll-my":z()}],"scroll-ms":[{"scroll-ms":z()}],"scroll-me":[{"scroll-me":z()}],"scroll-mt":[{"scroll-mt":z()}],"scroll-mr":[{"scroll-mr":z()}],"scroll-mb":[{"scroll-mb":z()}],"scroll-ml":[{"scroll-ml":z()}],"scroll-p":[{"scroll-p":z()}],"scroll-px":[{"scroll-px":z()}],"scroll-py":[{"scroll-py":z()}],"scroll-ps":[{"scroll-ps":z()}],"scroll-pe":[{"scroll-pe":z()}],"scroll-pt":[{"scroll-pt":z()}],"scroll-pr":[{"scroll-pr":z()}],"scroll-pb":[{"scroll-pb":z()}],"scroll-pl":[{"scroll-pl":z()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Lr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Kl,Zc,yN]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},yee=QQ(vee);function ke(...e){return yee(an(e))}const xee=eQ,BF=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(pF,M({ref:r,className:ke("fixed top-0 z-[3000] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e)},t))});BF.displayName=pF.displayName;const _ee=lp("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),UF=x.forwardRef((a,n)=>{var i=a,{className:e,variant:t}=i,r=me(i,["className","variant"]);return s.jsx(gF,M({ref:n,className:ke(_ee({variant:t}),e)},r))});UF.displayName=gF.displayName;const qF=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(xF,M({ref:r,className:ke("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e)},t))});qF.displayName=xF.displayName;const VF=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(_F,H(M({ref:r,className:ke("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":""},t),{children:s.jsx(Gr,{className:"h-4 w-4"})}))});VF.displayName=_F.displayName;const WF=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(vF,M({ref:r,className:ke("text-sm font-semibold",e)},t))});WF.displayName=vF.displayName;const HF=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(yF,M({ref:r,className:ke("text-sm opacity-90",e)},t))});HF.displayName=yF.displayName;function wee(){const{toasts:e}=Rr();return s.jsxs(xee,{children:[e.map(function(o){var l=o,{id:t,title:r,description:n,action:a}=l,i=me(l,["id","title","description","action"]);return s.jsxs(UF,H(M({},i),{children:[s.jsxs("div",{className:"grid gap-1",children:[r&&s.jsx(WF,{children:r}),n&&s.jsx(HF,{children:n})]}),a,s.jsx(VF,{})]}),t)}),s.jsx(BF,{})]})}var dM=["light","dark"],bee="(prefers-color-scheme: dark)",jee=x.createContext(void 0),Nee={setTheme:e=>{},themes:[]},See=()=>{var e;return(e=x.useContext(jee))!=null?e:Nee};x.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:i,value:o,attrs:l,nonce:c})=>{let d=i==="system",u=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${l.map(g=>`'${g}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,f=a?dM.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",h=(g,v=!1,y=!0)=>{let _=o?o[g]:g,w=v?g+"|| ''":`'${_}'`,b="";return a&&y&&!v&&dM.includes(g)&&(b+=`d.style.colorScheme = '${g}';`),r==="class"?v||_?b+=`c.add(${w})`:b+="null":_&&(b+=`d[s](n,${w})`),b},p=e?`!function(){${u}${h(e)}}()`:n?`!function(){try{${u}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${d})){var t='${bee}',m=window.matchMedia(t);if(m.media!==t||m.matches){${h("dark")}}else{${h("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${h(o?"x[e]":"e",!0)}}${d?"":"else{"+h(i,!1,!1)+"}"}${f}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${h(o?"x[e]":"e",!0)}}else{${h(i,!1,!1)};}${f}}catch(t){}}();`;return x.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:p}})});var kee=e=>{switch(e){case"success":return Pee;case"info":return Aee;case"warning":return Tee;case"error":return Ree;default:return null}},Eee=Array(12).fill(0),Cee=({visible:e,className:t})=>J.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},J.createElement("div",{className:"sonner-spinner"},Eee.map((r,n)=>J.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),Pee=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Tee=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Aee=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Ree=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Oee=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},J.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),J.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Mee=()=>{let[e,t]=J.useState(document.hidden);return J.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},Vk=1,Dee=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let l=e,{message:r}=l,n=me(l,["message"]),a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:Vk++,i=this.toasts.find(c=>c.id===a),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),i?this.toasts=this.toasts.map(c=>c.id===a?(this.publish(H(M(M({},c),e),{id:a,title:r})),H(M(M({},c),e),{id:a,dismissible:o,title:r})):c):this.addToast(H(M({title:r},n),{dismissible:o,id:a})),a},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create(H(M({},t),{message:e})),this.error=(e,t)=>this.create(H(M({},t),{message:e,type:"error"})),this.success=(e,t)=>this.create(H(M({},t),{type:"success",message:e})),this.info=(e,t)=>this.create(H(M({},t),{type:"info",message:e})),this.warning=(e,t)=>this.create(H(M({},t),{type:"warning",message:e})),this.loading=(e,t)=>this.create(H(M({},t),{type:"loading",message:e})),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create(H(M({},t),{promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0})));let n=e instanceof Promise?e:e(),a=r!==void 0,i,o=n.then(c=>E(this,null,function*(){if(i=["resolve",c],J.isValidElement(c))a=!1,this.create({id:r,type:"default",message:c});else if($ee(c)&&!c.ok){a=!1;let d=typeof t.error=="function"?yield t.error(`HTTP error! status: ${c.status}`):t.error,u=typeof t.description=="function"?yield t.description(`HTTP error! status: ${c.status}`):t.description;this.create({id:r,type:"error",message:d,description:u})}else if(t.success!==void 0){a=!1;let d=typeof t.success=="function"?yield t.success(c):t.success,u=typeof t.description=="function"?yield t.description(c):t.description;this.create({id:r,type:"success",message:d,description:u})}})).catch(c=>E(this,null,function*(){if(i=["reject",c],t.error!==void 0){a=!1;let d=typeof t.error=="function"?yield t.error(c):t.error,u=typeof t.description=="function"?yield t.description(c):t.description;this.create({id:r,type:"error",message:d,description:u})}})).finally(()=>{var c;a&&(this.dismiss(r),r=void 0),(c=t.finally)==null||c.call(t)}),l=()=>new Promise((c,d)=>o.then(()=>i[0]==="reject"?d(i[1]):c(i[1])).catch(d));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||Vk++;return this.create(M({jsx:e(r),id:r},t)),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},ti=new Dee,Iee=(e,t)=>{let r=(t==null?void 0:t.id)||Vk++;return ti.addToast(H(M({title:e},t),{id:r})),r},$ee=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Lee=Iee,Fee=()=>ti.toasts,zee=()=>ti.getActiveToasts();Object.assign(Lee,{success:ti.success,info:ti.info,warning:ti.warning,error:ti.error,custom:ti.custom,message:ti.message,promise:ti.promise,dismiss:ti.dismiss,loading:ti.loading},{getHistory:Fee,getToasts:zee});function Bee(e,{insertAt:t}={}){if(typeof document=="undefined")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}Bee(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function l0(e){return e.label!==void 0}var Uee=3,qee="32px",Vee="16px",uM=4e3,Wee=356,Hee=14,Gee=20,Yee=200;function yo(...e){return e.filter(Boolean).join(" ")}function Kee(e){let[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var Zee=e=>{var t,r,n,a,i,o,l,c,d,u,f;let{invert:h,toast:p,unstyled:g,interacting:v,setHeights:y,visibleToasts:_,heights:w,index:b,toasts:N,expanded:S,removeToast:k,defaultRichColors:P,closeButton:A,style:R,cancelButtonStyle:$,actionButtonStyle:O,className:z="",descriptionClassName:D="",duration:B,position:F,gap:U,loadingIcon:G,expandByDefault:q,classNames:K,icons:Z,closeButtonAriaLabel:Y="Close toast",pauseWhenPageIsHidden:Q}=e,[X,ne]=J.useState(null),[re,ye]=J.useState(null),[ee,de]=J.useState(!1),[xe,ie]=J.useState(!1),[se,V]=J.useState(!1),[ue,_e]=J.useState(!1),[ae,we]=J.useState(!1),[oe,ce]=J.useState(0),[Ae,Be]=J.useState(0),Xe=J.useRef(p.duration||B||uM),ge=J.useRef(null),We=J.useRef(null),Ue=b===0,at=b+1<=_,mt=p.type,Ye=p.dismissible!==!1,Ft=p.className||"",_t=p.descriptionClassName||"",Lt=J.useMemo(()=>w.findIndex(lt=>lt.toastId===p.id)||0,[w,p.id]),Oe=J.useMemo(()=>{var lt;return(lt=p.closeButton)!=null?lt:A},[p.closeButton,A]),qe=J.useMemo(()=>p.duration||B||uM,[p.duration,B]),Ne=J.useRef(0),Fe=J.useRef(0),ve=J.useRef(0),Me=J.useRef(null),[ze,ct]=F.split("-"),Et=J.useMemo(()=>w.reduce((lt,Qe,jt)=>jt>=Lt?lt:lt+Qe.height,0),[w,Lt]),gt=Mee(),St=p.invert||h,dr=mt==="loading";Fe.current=J.useMemo(()=>Lt*U+Et,[Lt,Et]),J.useEffect(()=>{Xe.current=qe},[qe]),J.useEffect(()=>{de(!0)},[]),J.useEffect(()=>{let lt=We.current;if(lt){let Qe=lt.getBoundingClientRect().height;return Be(Qe),y(jt=>[{toastId:p.id,height:Qe,position:p.position},...jt]),()=>y(jt=>jt.filter(ir=>ir.toastId!==p.id))}},[y,p.id]),J.useLayoutEffect(()=>{if(!ee)return;let lt=We.current,Qe=lt.style.height;lt.style.height="auto";let jt=lt.getBoundingClientRect().height;lt.style.height=Qe,Be(jt),y(ir=>ir.find(rr=>rr.toastId===p.id)?ir.map(rr=>rr.toastId===p.id?H(M({},rr),{height:jt}):rr):[{toastId:p.id,height:jt,position:p.position},...ir])},[ee,p.title,p.description,y,p.id]);let Sr=J.useCallback(()=>{ie(!0),ce(Fe.current),y(lt=>lt.filter(Qe=>Qe.toastId!==p.id)),setTimeout(()=>{k(p)},Yee)},[p,k,y,Fe]);J.useEffect(()=>{if(p.promise&&mt==="loading"||p.duration===1/0||p.type==="loading")return;let lt;return S||v||Q&&gt?(()=>{if(ve.current<Ne.current){let Qe=new Date().getTime()-Ne.current;Xe.current=Xe.current-Qe}ve.current=new Date().getTime()})():Xe.current!==1/0&&(Ne.current=new Date().getTime(),lt=setTimeout(()=>{var Qe;(Qe=p.onAutoClose)==null||Qe.call(p,p),Sr()},Xe.current)),()=>clearTimeout(lt)},[S,v,p,mt,Q,gt,Sr]),J.useEffect(()=>{p.delete&&Sr()},[Sr,p.delete]);function wt(){var lt,Qe,jt;return Z!=null&&Z.loading?J.createElement("div",{className:yo(K==null?void 0:K.loader,(lt=p==null?void 0:p.classNames)==null?void 0:lt.loader,"sonner-loader"),"data-visible":mt==="loading"},Z.loading):G?J.createElement("div",{className:yo(K==null?void 0:K.loader,(Qe=p==null?void 0:p.classNames)==null?void 0:Qe.loader,"sonner-loader"),"data-visible":mt==="loading"},G):J.createElement(Cee,{className:yo(K==null?void 0:K.loader,(jt=p==null?void 0:p.classNames)==null?void 0:jt.loader),visible:mt==="loading"})}return J.createElement("li",{tabIndex:0,ref:We,className:yo(z,Ft,K==null?void 0:K.toast,(t=p==null?void 0:p.classNames)==null?void 0:t.toast,K==null?void 0:K.default,K==null?void 0:K[mt],(r=p==null?void 0:p.classNames)==null?void 0:r[mt]),"data-sonner-toast":"","data-rich-colors":(n=p.richColors)!=null?n:P,"data-styled":!(p.jsx||p.unstyled||g),"data-mounted":ee,"data-promise":!!p.promise,"data-swiped":ae,"data-removed":xe,"data-visible":at,"data-y-position":ze,"data-x-position":ct,"data-index":b,"data-front":Ue,"data-swiping":se,"data-dismissible":Ye,"data-type":mt,"data-invert":St,"data-swipe-out":ue,"data-swipe-direction":re,"data-expanded":!!(S||q&&ee),style:M(M({"--index":b,"--toasts-before":b,"--z-index":N.length-b,"--offset":`${xe?oe:Fe.current}px`,"--initial-height":q?"auto":`${Ae}px`},R),p.style),onDragEnd:()=>{V(!1),ne(null),Me.current=null},onPointerDown:lt=>{dr||!Ye||(ge.current=new Date,ce(Fe.current),lt.target.setPointerCapture(lt.pointerId),lt.target.tagName!=="BUTTON"&&(V(!0),Me.current={x:lt.clientX,y:lt.clientY}))},onPointerUp:()=>{var lt,Qe,jt,ir;if(ue||!Ye)return;Me.current=null;let rr=Number(((lt=We.current)==null?void 0:lt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Ie=Number(((Qe=We.current)==null?void 0:Qe.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),At=new Date().getTime()-((jt=ge.current)==null?void 0:jt.getTime()),yt=X==="x"?rr:Ie,pe=Math.abs(yt)/At;if(Math.abs(yt)>=Gee||pe>.11){ce(Fe.current),(ir=p.onDismiss)==null||ir.call(p,p),ye(X==="x"?rr>0?"right":"left":Ie>0?"down":"up"),Sr(),_e(!0),we(!1);return}V(!1),ne(null)},onPointerMove:lt=>{var Qe,jt,ir,rr;if(!Me.current||!Ye||((Qe=window.getSelection())==null?void 0:Qe.toString().length)>0)return;let Ie=lt.clientY-Me.current.y,At=lt.clientX-Me.current.x,yt=(jt=e.swipeDirections)!=null?jt:Kee(F);!X&&(Math.abs(At)>1||Math.abs(Ie)>1)&&ne(Math.abs(At)>Math.abs(Ie)?"x":"y");let pe={x:0,y:0};X==="y"?(yt.includes("top")||yt.includes("bottom"))&&(yt.includes("top")&&Ie<0||yt.includes("bottom")&&Ie>0)&&(pe.y=Ie):X==="x"&&(yt.includes("left")||yt.includes("right"))&&(yt.includes("left")&&At<0||yt.includes("right")&&At>0)&&(pe.x=At),(Math.abs(pe.x)>0||Math.abs(pe.y)>0)&&we(!0),(ir=We.current)==null||ir.style.setProperty("--swipe-amount-x",`${pe.x}px`),(rr=We.current)==null||rr.style.setProperty("--swipe-amount-y",`${pe.y}px`)}},Oe&&!p.jsx?J.createElement("button",{"aria-label":Y,"data-disabled":dr,"data-close-button":!0,onClick:dr||!Ye?()=>{}:()=>{var lt;Sr(),(lt=p.onDismiss)==null||lt.call(p,p)},className:yo(K==null?void 0:K.closeButton,(a=p==null?void 0:p.classNames)==null?void 0:a.closeButton)},(i=Z==null?void 0:Z.close)!=null?i:Oee):null,p.jsx||x.isValidElement(p.title)?p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title:J.createElement(J.Fragment,null,mt||p.icon||p.promise?J.createElement("div",{"data-icon":"",className:yo(K==null?void 0:K.icon,(o=p==null?void 0:p.classNames)==null?void 0:o.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||wt():null,p.type!=="loading"?p.icon||(Z==null?void 0:Z[mt])||kee(mt):null):null,J.createElement("div",{"data-content":"",className:yo(K==null?void 0:K.content,(l=p==null?void 0:p.classNames)==null?void 0:l.content)},J.createElement("div",{"data-title":"",className:yo(K==null?void 0:K.title,(c=p==null?void 0:p.classNames)==null?void 0:c.title)},typeof p.title=="function"?p.title():p.title),p.description?J.createElement("div",{"data-description":"",className:yo(D,_t,K==null?void 0:K.description,(d=p==null?void 0:p.classNames)==null?void 0:d.description)},typeof p.description=="function"?p.description():p.description):null),x.isValidElement(p.cancel)?p.cancel:p.cancel&&l0(p.cancel)?J.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||$,onClick:lt=>{var Qe,jt;l0(p.cancel)&&Ye&&((jt=(Qe=p.cancel).onClick)==null||jt.call(Qe,lt),Sr())},className:yo(K==null?void 0:K.cancelButton,(u=p==null?void 0:p.classNames)==null?void 0:u.cancelButton)},p.cancel.label):null,x.isValidElement(p.action)?p.action:p.action&&l0(p.action)?J.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||O,onClick:lt=>{var Qe,jt;l0(p.action)&&((jt=(Qe=p.action).onClick)==null||jt.call(Qe,lt),!lt.defaultPrevented&&Sr())},className:yo(K==null?void 0:K.actionButton,(f=p==null?void 0:p.classNames)==null?void 0:f.actionButton)},p.action.label):null))};function hM(){if(typeof window=="undefined"||typeof document=="undefined")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Xee(e,t){let r={};return[e,t].forEach((n,a)=>{let i=a===1,o=i?"--mobile-offset":"--offset",l=i?Vee:qee;function c(d){["top","right","bottom","left"].forEach(u=>{r[`${o}-${u}`]=typeof d=="number"?`${d}px`:d})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(d=>{n[d]===void 0?r[`${o}-${d}`]=l:r[`${o}-${d}`]=typeof n[d]=="number"?`${n[d]}px`:n[d]}):c(l)}),r}var Jee=x.forwardRef(function(e,t){let{invert:r,position:n="bottom-right",hotkey:a=["altKey","KeyT"],expand:i,closeButton:o,className:l,offset:c,mobileOffset:d,theme:u="light",richColors:f,duration:h,style:p,visibleToasts:g=Uee,toastOptions:v,dir:y=hM(),gap:_=Hee,loadingIcon:w,icons:b,containerAriaLabel:N="Notifications",pauseWhenPageIsHidden:S}=e,[k,P]=J.useState([]),A=J.useMemo(()=>Array.from(new Set([n].concat(k.filter(Q=>Q.position).map(Q=>Q.position)))),[k,n]),[R,$]=J.useState([]),[O,z]=J.useState(!1),[D,B]=J.useState(!1),[F,U]=J.useState(u!=="system"?u:typeof window!="undefined"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),G=J.useRef(null),q=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),K=J.useRef(null),Z=J.useRef(!1),Y=J.useCallback(Q=>{P(X=>{var ne;return(ne=X.find(re=>re.id===Q.id))!=null&&ne.delete||ti.dismiss(Q.id),X.filter(({id:re})=>re!==Q.id)})},[]);return J.useEffect(()=>ti.subscribe(Q=>{if(Q.dismiss){P(X=>X.map(ne=>ne.id===Q.id?H(M({},ne),{delete:!0}):ne));return}setTimeout(()=>{Bf.flushSync(()=>{P(X=>{let ne=X.findIndex(re=>re.id===Q.id);return ne!==-1?[...X.slice(0,ne),M(M({},X[ne]),Q),...X.slice(ne+1)]:[Q,...X]})})})}),[]),J.useEffect(()=>{if(u!=="system"){U(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?U("dark"):U("light")),typeof window=="undefined")return;let Q=window.matchMedia("(prefers-color-scheme: dark)");try{Q.addEventListener("change",({matches:X})=>{U(X?"dark":"light")})}catch(X){Q.addListener(({matches:ne})=>{try{U(ne?"dark":"light")}catch(re){console.error(re)}})}},[u]),J.useEffect(()=>{k.length<=1&&z(!1)},[k]),J.useEffect(()=>{let Q=X=>{var ne,re;a.every(ye=>X[ye]||X.code===ye)&&(z(!0),(ne=G.current)==null||ne.focus()),X.code==="Escape"&&(document.activeElement===G.current||(re=G.current)!=null&&re.contains(document.activeElement))&&z(!1)};return document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)},[a]),J.useEffect(()=>{if(G.current)return()=>{K.current&&(K.current.focus({preventScroll:!0}),K.current=null,Z.current=!1)}},[G.current]),J.createElement("section",{ref:t,"aria-label":`${N} ${q}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},A.map((Q,X)=>{var ne;let[re,ye]=Q.split("-");return k.length?J.createElement("ol",{key:Q,dir:y==="auto"?hM():y,tabIndex:-1,ref:G,className:l,"data-sonner-toaster":!0,"data-theme":F,"data-y-position":re,"data-lifted":O&&k.length>1&&!i,"data-x-position":ye,style:M(M({"--front-toast-height":`${((ne=R[0])==null?void 0:ne.height)||0}px`,"--width":`${Wee}px`,"--gap":`${_}px`},p),Xee(c,d)),onBlur:ee=>{Z.current&&!ee.currentTarget.contains(ee.relatedTarget)&&(Z.current=!1,K.current&&(K.current.focus({preventScroll:!0}),K.current=null))},onFocus:ee=>{ee.target instanceof HTMLElement&&ee.target.dataset.dismissible==="false"||Z.current||(Z.current=!0,K.current=ee.relatedTarget)},onMouseEnter:()=>z(!0),onMouseMove:()=>z(!0),onMouseLeave:()=>{D||z(!1)},onDragEnd:()=>z(!1),onPointerDown:ee=>{ee.target instanceof HTMLElement&&ee.target.dataset.dismissible==="false"||B(!0)},onPointerUp:()=>B(!1)},k.filter(ee=>!ee.position&&X===0||ee.position===Q).map((ee,de)=>{var xe,ie;return J.createElement(Zee,{key:ee.id,icons:b,index:de,toast:ee,defaultRichColors:f,duration:(xe=v==null?void 0:v.duration)!=null?xe:h,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:r,visibleToasts:g,closeButton:(ie=v==null?void 0:v.closeButton)!=null?ie:o,interacting:D,position:Q,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,removeToast:Y,toasts:k.filter(se=>se.position==ee.position),heights:R.filter(se=>se.position==ee.position),setHeights:$,expandByDefault:i,gap:_,loadingIcon:w,expanded:O,pauseWhenPageIsHidden:S,swipeDirections:e.swipeDirections})})):null}))});const Qee=t=>{var e=me(t,[]);const{theme:r="system"}=See();return s.jsx(Jee,M({theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}}},e))};var ete=_C[" useId ".trim().toString()]||(()=>{}),tte=0;function Ps(e){const[t,r]=x.useState(ete());return vs(()=>{e||r(n=>n!=null?n:String(tte++))},[e]),e||(t?`radix-${t}`:"")}const rte=["top","right","bottom","left"],Ud=Math.min,Pi=Math.max,B_=Math.round,c0=Math.floor,Cl=e=>({x:e,y:e}),nte={left:"right",right:"left",bottom:"top",top:"bottom"},ste={start:"end",end:"start"};function Wk(e,t,r){return Pi(e,Ud(t,r))}function Rc(e,t){return typeof e=="function"?e(t):e}function Oc(e){return e.split("-")[0]}function up(e){return e.split("-")[1]}function kP(e){return e==="x"?"y":"x"}function EP(e){return e==="y"?"height":"width"}const ate=new Set(["top","bottom"]);function vl(e){return ate.has(Oc(e))?"y":"x"}function CP(e){return kP(vl(e))}function ite(e,t,r){r===void 0&&(r=!1);const n=up(e),a=CP(e),i=EP(a);let o=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=U_(o)),[o,U_(o)]}function ote(e){const t=U_(e);return[Hk(e),t,Hk(t)]}function Hk(e){return e.replace(/start|end/g,t=>ste[t])}const fM=["left","right"],mM=["right","left"],lte=["top","bottom"],cte=["bottom","top"];function dte(e,t,r){switch(e){case"top":case"bottom":return r?t?mM:fM:t?fM:mM;case"left":case"right":return t?lte:cte;default:return[]}}function ute(e,t,r,n){const a=up(e);let i=dte(Oc(e),r==="start",n);return a&&(i=i.map(o=>o+"-"+a),t&&(i=i.concat(i.map(Hk)))),i}function U_(e){return e.replace(/left|right|bottom|top/g,t=>nte[t])}function hte(e){return M({top:0,right:0,bottom:0,left:0},e)}function GF(e){return typeof e!="number"?hte(e):{top:e,right:e,bottom:e,left:e}}function q_(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function pM(e,t,r){let{reference:n,floating:a}=e;const i=vl(t),o=CP(t),l=EP(o),c=Oc(t),d=i==="y",u=n.x+n.width/2-a.width/2,f=n.y+n.height/2-a.height/2,h=n[l]/2-a[l]/2;let p;switch(c){case"top":p={x:u,y:n.y-a.height};break;case"bottom":p={x:u,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:f};break;case"left":p={x:n.x-a.width,y:f};break;default:p={x:n.x,y:n.y}}switch(up(t)){case"start":p[o]-=h*(r&&d?-1:1);break;case"end":p[o]+=h*(r&&d?-1:1);break}return p}const fte=(e,t,r)=>E(void 0,null,function*(){const{placement:n="bottom",strategy:a="absolute",middleware:i=[],platform:o}=r,l=i.filter(Boolean),c=yield o.isRTL==null?void 0:o.isRTL(t);let d=yield o.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:f}=pM(d,n,c),h=n,p={},g=0;for(let v=0;v<l.length;v++){const{name:y,fn:_}=l[v],{x:w,y:b,data:N,reset:S}=yield _({x:u,y:f,initialPlacement:n,placement:h,strategy:a,middlewareData:p,rects:d,platform:o,elements:{reference:e,floating:t}});u=w!=null?w:u,f=b!=null?b:f,p=H(M({},p),{[y]:M(M({},p[y]),N)}),S&&g<=50&&(g++,typeof S=="object"&&(S.placement&&(h=S.placement),S.rects&&(d=S.rects===!0?yield o.getElementRects({reference:e,floating:t,strategy:a}):S.rects),{x:u,y:f}=pM(d,h,c)),v=-1)}return{x:u,y:f,placement:h,strategy:a,middlewareData:p}});function Cv(e,t){return E(this,null,function*(){var r;t===void 0&&(t={});const{x:n,y:a,platform:i,rects:o,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:h=!1,padding:p=0}=Rc(t,e),g=GF(p),y=l[h?f==="floating"?"reference":"floating":f],_=q_(yield i.getClippingRect({element:(r=yield i.isElement==null?void 0:i.isElement(y))==null||r?y:y.contextElement||(yield i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:c})),w=f==="floating"?{x:n,y:a,width:o.floating.width,height:o.floating.height}:o.reference,b=yield i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating),N=(yield i.isElement==null?void 0:i.isElement(b))?(yield i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},S=q_(i.convertOffsetParentRelativeRectToViewportRelativeRect?yield i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:w,offsetParent:b,strategy:c}):w);return{top:(_.top-S.top+g.top)/N.y,bottom:(S.bottom-_.bottom+g.bottom)/N.y,left:(_.left-S.left+g.left)/N.x,right:(S.right-_.right+g.right)/N.x}})}const mte=e=>({name:"arrow",options:e,fn(r){return E(this,null,function*(){const{x:n,y:a,placement:i,rects:o,platform:l,elements:c,middlewareData:d}=r,{element:u,padding:f=0}=Rc(e,r)||{};if(u==null)return{};const h=GF(f),p={x:n,y:a},g=CP(i),v=EP(g),y=yield l.getDimensions(u),_=g==="y",w=_?"top":"left",b=_?"bottom":"right",N=_?"clientHeight":"clientWidth",S=o.reference[v]+o.reference[g]-p[g]-o.floating[v],k=p[g]-o.reference[g],P=yield l.getOffsetParent==null?void 0:l.getOffsetParent(u);let A=P?P[N]:0;(!A||!(yield l.isElement==null?void 0:l.isElement(P)))&&(A=c.floating[N]||o.floating[v]);const R=S/2-k/2,$=A/2-y[v]/2-1,O=Ud(h[w],$),z=Ud(h[b],$),D=O,B=A-y[v]-z,F=A/2-y[v]/2+R,U=Wk(D,F,B),G=!d.arrow&&up(i)!=null&&F!==U&&o.reference[v]/2-(F<D?O:z)-y[v]/2<0,q=G?F<D?F-D:F-B:0;return{[g]:p[g]+q,data:M({[g]:U,centerOffset:F-U-q},G&&{alignmentOffset:q}),reset:G}})}}),pte=function(e){return e===void 0&&(e={}),{name:"flip",options:e,fn(r){return E(this,null,function*(){var n,a;const{placement:i,middlewareData:o,rects:l,initialPlacement:c,platform:d,elements:u}=r,F=Rc(e,r),{mainAxis:f=!0,crossAxis:h=!0,fallbackPlacements:p,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:y=!0}=F,_=me(F,["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"]);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const w=Oc(i),b=vl(c),N=Oc(c)===c,S=yield d.isRTL==null?void 0:d.isRTL(u.floating),k=p||(N||!y?[U_(c)]:ote(c)),P=v!=="none";!p&&P&&k.push(...ute(c,y,v,S));const A=[c,...k],R=yield Cv(r,_),$=[];let O=((a=o.flip)==null?void 0:a.overflows)||[];if(f&&$.push(R[w]),h){const U=ite(i,l,S);$.push(R[U[0]],R[U[1]])}if(O=[...O,{placement:i,overflows:$}],!$.every(U=>U<=0)){var z,D;const U=(((z=o.flip)==null?void 0:z.index)||0)+1,G=A[U];if(G&&(!(h==="alignment"?b!==vl(G):!1)||O.every(Z=>Z.overflows[0]>0&&vl(Z.placement)===b)))return{data:{index:U,overflows:O},reset:{placement:G}};let q=(D=O.filter(K=>K.overflows[0]<=0).sort((K,Z)=>K.overflows[1]-Z.overflows[1])[0])==null?void 0:D.placement;if(!q)switch(g){case"bestFit":{var B;const K=(B=O.filter(Z=>{if(P){const Y=vl(Z.placement);return Y===b||Y==="y"}return!0}).map(Z=>[Z.placement,Z.overflows.filter(Y=>Y>0).reduce((Y,Q)=>Y+Q,0)]).sort((Z,Y)=>Z[1]-Y[1])[0])==null?void 0:B[0];K&&(q=K);break}case"initialPlacement":q=c;break}if(i!==q)return{reset:{placement:q}}}return{}})}}};function gM(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function vM(e){return rte.some(t=>e[t]>=0)}const gte=function(e){return e===void 0&&(e={}),{name:"hide",options:e,fn(r){return E(this,null,function*(){const{rects:n}=r,o=Rc(e,r),{strategy:a="referenceHidden"}=o,i=me(o,["strategy"]);switch(a){case"referenceHidden":{const l=yield Cv(r,H(M({},i),{elementContext:"reference"})),c=gM(l,n.reference);return{data:{referenceHiddenOffsets:c,referenceHidden:vM(c)}}}case"escaped":{const l=yield Cv(r,H(M({},i),{altBoundary:!0})),c=gM(l,n.floating);return{data:{escapedOffsets:c,escaped:vM(c)}}}default:return{}}})}}},YF=new Set(["left","top"]);function vte(e,t){return E(this,null,function*(){const{placement:r,platform:n,elements:a}=e,i=yield n.isRTL==null?void 0:n.isRTL(a.floating),o=Oc(r),l=up(r),c=vl(r)==="y",d=YF.has(o)?-1:1,u=i&&c?-1:1,f=Rc(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:g}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof g=="number"&&(p=l==="end"?g*-1:g),c?{x:p*u,y:h*d}:{x:h*d,y:p*u}})}const yte=function(e){return e===void 0&&(e=0),{name:"offset",options:e,fn(r){return E(this,null,function*(){var n,a;const{x:i,y:o,placement:l,middlewareData:c}=r,d=yield vte(r,e);return l===((n=c.offset)==null?void 0:n.placement)&&(a=c.arrow)!=null&&a.alignmentOffset?{}:{x:i+d.x,y:o+d.y,data:H(M({},d),{placement:l})}})}}},xte=function(e){return e===void 0&&(e={}),{name:"shift",options:e,fn(r){return E(this,null,function*(){const{x:n,y:a,placement:i}=r,_=Rc(e,r),{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:w=>{let{x:b,y:N}=w;return{x:b,y:N}}}}=_,d=me(_,["mainAxis","crossAxis","limiter"]),u={x:n,y:a},f=yield Cv(r,d),h=vl(Oc(i)),p=kP(h);let g=u[p],v=u[h];if(o){const w=p==="y"?"top":"left",b=p==="y"?"bottom":"right",N=g+f[w],S=g-f[b];g=Wk(N,g,S)}if(l){const w=h==="y"?"top":"left",b=h==="y"?"bottom":"right",N=v+f[w],S=v-f[b];v=Wk(N,v,S)}const y=c.fn(H(M({},r),{[p]:g,[h]:v}));return H(M({},y),{data:{x:y.x-n,y:y.y-a,enabled:{[p]:o,[h]:l}}})})}}},_te=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:i,middlewareData:o}=t,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=Rc(e,t),u={x:r,y:n},f=vl(a),h=kP(f);let p=u[h],g=u[f];const v=Rc(l,t),y=typeof v=="number"?{mainAxis:v,crossAxis:0}:M({mainAxis:0,crossAxis:0},v);if(c){const b=h==="y"?"height":"width",N=i.reference[h]-i.floating[b]+y.mainAxis,S=i.reference[h]+i.reference[b]-y.mainAxis;p<N?p=N:p>S&&(p=S)}if(d){var _,w;const b=h==="y"?"width":"height",N=YF.has(Oc(a)),S=i.reference[f]-i.floating[b]+(N&&((_=o.offset)==null?void 0:_[f])||0)+(N?0:y.crossAxis),k=i.reference[f]+i.reference[b]+(N?0:((w=o.offset)==null?void 0:w[f])||0)-(N?y.crossAxis:0);g<S?g=S:g>k&&(g=k)}return{[h]:p,[f]:g}}}},wte=function(e){return e===void 0&&(e={}),{name:"size",options:e,fn(r){return E(this,null,function*(){var n,a;const{placement:i,rects:o,platform:l,elements:c}=r,O=Rc(e,r),{apply:d=()=>{}}=O,u=me(O,["apply"]),f=yield Cv(r,u),h=Oc(i),p=up(i),g=vl(i)==="y",{width:v,height:y}=o.floating;let _,w;h==="top"||h==="bottom"?(_=h,w=p===((yield l.isRTL==null?void 0:l.isRTL(c.floating))?"start":"end")?"left":"right"):(w=h,_=p==="end"?"top":"bottom");const b=y-f.top-f.bottom,N=v-f.left-f.right,S=Ud(y-f[_],b),k=Ud(v-f[w],N),P=!r.middlewareData.shift;let A=S,R=k;if((n=r.middlewareData.shift)!=null&&n.enabled.x&&(R=N),(a=r.middlewareData.shift)!=null&&a.enabled.y&&(A=b),P&&!p){const z=Pi(f.left,0),D=Pi(f.right,0),B=Pi(f.top,0),F=Pi(f.bottom,0);g?R=v-2*(z!==0||D!==0?z+D:Pi(f.left,f.right)):A=y-2*(B!==0||F!==0?B+F:Pi(f.top,f.bottom))}yield d(H(M({},r),{availableWidth:R,availableHeight:A}));const $=yield l.getDimensions(c.floating);return v!==$.width||y!==$.height?{reset:{rects:!0}}:{}})}}};function $b(){return typeof window!="undefined"}function hp(e){return KF(e)?(e.nodeName||"").toLowerCase():"#document"}function Mi(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Fl(e){var t;return(t=(KF(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function KF(e){return $b()?e instanceof Node||e instanceof Mi(e).Node:!1}function Wo(e){return $b()?e instanceof Element||e instanceof Mi(e).Element:!1}function Il(e){return $b()?e instanceof HTMLElement||e instanceof Mi(e).HTMLElement:!1}function yM(e){return!$b()||typeof ShadowRoot=="undefined"?!1:e instanceof ShadowRoot||e instanceof Mi(e).ShadowRoot}const bte=new Set(["inline","contents"]);function $y(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=Ho(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!bte.has(a)}const jte=new Set(["table","td","th"]);function Nte(e){return jte.has(hp(e))}const Ste=[":popover-open",":modal"];function Lb(e){return Ste.some(t=>{try{return e.matches(t)}catch(r){return!1}})}const kte=["transform","translate","scale","rotate","perspective"],Ete=["transform","translate","scale","rotate","perspective","filter"],Cte=["paint","layout","strict","content"];function PP(e){const t=TP(),r=Wo(e)?Ho(e):e;return kte.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||Ete.some(n=>(r.willChange||"").includes(n))||Cte.some(n=>(r.contain||"").includes(n))}function Pte(e){let t=qd(e);for(;Il(t)&&!gm(t);){if(PP(t))return t;if(Lb(t))return null;t=qd(t)}return null}function TP(){return typeof CSS=="undefined"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Tte=new Set(["html","body","#document"]);function gm(e){return Tte.has(hp(e))}function Ho(e){return Mi(e).getComputedStyle(e)}function Fb(e){return Wo(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function qd(e){if(hp(e)==="html")return e;const t=e.assignedSlot||e.parentNode||yM(e)&&e.host||Fl(e);return yM(t)?t.host:t}function ZF(e){const t=qd(e);return gm(t)?e.ownerDocument?e.ownerDocument.body:e.body:Il(t)&&$y(t)?t:ZF(t)}function Pv(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=ZF(e),i=a===((n=e.ownerDocument)==null?void 0:n.body),o=Mi(a);if(i){const l=Gk(o);return t.concat(o,o.visualViewport||[],$y(a)?a:[],l&&r?Pv(l):[])}return t.concat(a,Pv(a,[],r))}function Gk(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function XF(e){const t=Ho(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Il(e),i=a?e.offsetWidth:r,o=a?e.offsetHeight:n,l=B_(r)!==i||B_(n)!==o;return l&&(r=i,n=o),{width:r,height:n,$:l}}function AP(e){return Wo(e)?e:e.contextElement}function qf(e){const t=AP(e);if(!Il(t))return Cl(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:i}=XF(t);let o=(i?B_(r.width):r.width)/n,l=(i?B_(r.height):r.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const Ate=Cl(0);function JF(e){const t=Mi(e);return!TP()||!t.visualViewport?Ate:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Rte(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Mi(e)?!1:t}function ah(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),i=AP(e);let o=Cl(1);t&&(n?Wo(n)&&(o=qf(n)):o=qf(e));const l=Rte(i,r,n)?JF(i):Cl(0);let c=(a.left+l.x)/o.x,d=(a.top+l.y)/o.y,u=a.width/o.x,f=a.height/o.y;if(i){const h=Mi(i),p=n&&Wo(n)?Mi(n):n;let g=h,v=Gk(g);for(;v&&n&&p!==g;){const y=qf(v),_=v.getBoundingClientRect(),w=Ho(v),b=_.left+(v.clientLeft+parseFloat(w.paddingLeft))*y.x,N=_.top+(v.clientTop+parseFloat(w.paddingTop))*y.y;c*=y.x,d*=y.y,u*=y.x,f*=y.y,c+=b,d+=N,g=Mi(v),v=Gk(g)}}return q_({width:u,height:f,x:c,y:d})}function RP(e,t){const r=Fb(e).scrollLeft;return t?t.left+r:ah(Fl(e)).left+r}function QF(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:RP(e,n)),i=n.top+t.scrollTop;return{x:a,y:i}}function Ote(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const i=a==="fixed",o=Fl(n),l=t?Lb(t.floating):!1;if(n===o||l&&i)return r;let c={scrollLeft:0,scrollTop:0},d=Cl(1);const u=Cl(0),f=Il(n);if((f||!f&&!i)&&((hp(n)!=="body"||$y(o))&&(c=Fb(n)),Il(n))){const p=ah(n);d=qf(n),u.x=p.x+n.clientLeft,u.y=p.y+n.clientTop}const h=o&&!f&&!i?QF(o,c,!0):Cl(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-c.scrollLeft*d.x+u.x+h.x,y:r.y*d.y-c.scrollTop*d.y+u.y+h.y}}function Mte(e){return Array.from(e.getClientRects())}function Dte(e){const t=Fl(e),r=Fb(e),n=e.ownerDocument.body,a=Pi(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=Pi(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+RP(e);const l=-r.scrollTop;return Ho(n).direction==="rtl"&&(o+=Pi(t.clientWidth,n.clientWidth)-a),{width:a,height:i,x:o,y:l}}function Ite(e,t){const r=Mi(e),n=Fl(e),a=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,l=0,c=0;if(a){i=a.width,o=a.height;const d=TP();(!d||d&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:i,height:o,x:l,y:c}}const $te=new Set(["absolute","fixed"]);function Lte(e,t){const r=ah(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,i=Il(e)?qf(e):Cl(1),o=e.clientWidth*i.x,l=e.clientHeight*i.y,c=a*i.x,d=n*i.y;return{width:o,height:l,x:c,y:d}}function xM(e,t,r){let n;if(t==="viewport")n=Ite(e,r);else if(t==="document")n=Dte(Fl(e));else if(Wo(t))n=Lte(t,r);else{const a=JF(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return q_(n)}function ez(e,t){const r=qd(e);return r===t||!Wo(r)||gm(r)?!1:Ho(r).position==="fixed"||ez(r,t)}function Fte(e,t){const r=t.get(e);if(r)return r;let n=Pv(e,[],!1).filter(l=>Wo(l)&&hp(l)!=="body"),a=null;const i=Ho(e).position==="fixed";let o=i?qd(e):e;for(;Wo(o)&&!gm(o);){const l=Ho(o),c=PP(o);!c&&l.position==="fixed"&&(a=null),(i?!c&&!a:!c&&l.position==="static"&&!!a&&$te.has(a.position)||$y(o)&&!c&&ez(e,o))?n=n.filter(u=>u!==o):a=l,o=qd(o)}return t.set(e,n),n}function zte(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const o=[...r==="clippingAncestors"?Lb(t)?[]:Fte(t,this._c):[].concat(r),n],l=o[0],c=o.reduce((d,u)=>{const f=xM(t,u,a);return d.top=Pi(f.top,d.top),d.right=Ud(f.right,d.right),d.bottom=Ud(f.bottom,d.bottom),d.left=Pi(f.left,d.left),d},xM(t,l,a));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function Bte(e){const{width:t,height:r}=XF(e);return{width:t,height:r}}function Ute(e,t,r){const n=Il(t),a=Fl(t),i=r==="fixed",o=ah(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=Cl(0);function d(){c.x=RP(a)}if(n||!n&&!i)if((hp(t)!=="body"||$y(a))&&(l=Fb(t)),n){const p=ah(t,!0,i,t);c.x=p.x+t.clientLeft,c.y=p.y+t.clientTop}else a&&d();i&&!n&&a&&d();const u=a&&!n&&!i?QF(a,l):Cl(0),f=o.left+l.scrollLeft-c.x-u.x,h=o.top+l.scrollTop-c.y-u.y;return{x:f,y:h,width:o.width,height:o.height}}function xN(e){return Ho(e).position==="static"}function _M(e,t){if(!Il(e)||Ho(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Fl(e)===r&&(r=r.ownerDocument.body),r}function tz(e,t){const r=Mi(e);if(Lb(e))return r;if(!Il(e)){let a=qd(e);for(;a&&!gm(a);){if(Wo(a)&&!xN(a))return a;a=qd(a)}return r}let n=_M(e,t);for(;n&&Nte(n)&&xN(n);)n=_M(n,t);return n&&gm(n)&&xN(n)&&!PP(n)?r:n||Pte(e)||r}const qte=function(e){return E(this,null,function*(){const t=this.getOffsetParent||tz,r=this.getDimensions,n=yield r(e.floating);return{reference:Ute(e.reference,yield t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}})};function Vte(e){return Ho(e).direction==="rtl"}const Wte={convertOffsetParentRelativeRectToViewportRelativeRect:Ote,getDocumentElement:Fl,getClippingRect:zte,getOffsetParent:tz,getElementRects:qte,getClientRects:Mte,getDimensions:Bte,getScale:qf,isElement:Wo,isRTL:Vte};function rz(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Hte(e,t){let r=null,n;const a=Fl(e);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const d=e.getBoundingClientRect(),{left:u,top:f,width:h,height:p}=d;if(l||t(),!h||!p)return;const g=c0(f),v=c0(a.clientWidth-(u+h)),y=c0(a.clientHeight-(f+p)),_=c0(u),b={rootMargin:-g+"px "+-v+"px "+-y+"px "+-_+"px",threshold:Pi(0,Ud(1,c))||1};let N=!0;function S(k){const P=k[0].intersectionRatio;if(P!==c){if(!N)return o();P?o(!1,P):n=setTimeout(()=>{o(!1,1e-7)},1e3)}P===1&&!rz(d,e.getBoundingClientRect())&&o(),N=!1}try{r=new IntersectionObserver(S,H(M({},b),{root:a.ownerDocument}))}catch(k){r=new IntersectionObserver(S,b)}r.observe(e)}return o(!0),i}function Gte(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,d=AP(e),u=a||i?[...d?Pv(d):[],...Pv(t)]:[];u.forEach(_=>{a&&_.addEventListener("scroll",r,{passive:!0}),i&&_.addEventListener("resize",r)});const f=d&&l?Hte(d,r):null;let h=-1,p=null;o&&(p=new ResizeObserver(_=>{let[w]=_;w&&w.target===d&&p&&(p.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=p)==null||b.observe(t)})),r()}),d&&!c&&p.observe(d),p.observe(t));let g,v=c?ah(e):null;c&&y();function y(){const _=ah(e);v&&!rz(v,_)&&r(),v=_,g=requestAnimationFrame(y)}return r(),()=>{var _;u.forEach(w=>{a&&w.removeEventListener("scroll",r),i&&w.removeEventListener("resize",r)}),f==null||f(),(_=p)==null||_.disconnect(),p=null,c&&cancelAnimationFrame(g)}}const Yte=yte,Kte=xte,Zte=pte,Xte=wte,Jte=gte,wM=mte,Qte=_te,ere=(e,t,r)=>{const n=new Map,a=M({platform:Wte},r),i=H(M({},a.platform),{_c:n});return fte(e,t,H(M({},a),{platform:i}))};var tre=typeof document!="undefined",rre=function(){},a_=tre?x.useLayoutEffect:rre;function V_(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!V_(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const i=a[n];if(!(i==="_owner"&&e.$$typeof)&&!V_(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function nz(e){return typeof window=="undefined"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function bM(e,t){const r=nz(e);return Math.round(t*r)/r}function _N(e){const t=x.useRef(e);return a_(()=>{t.current=e}),t}function nre(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[u,f]=x.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,p]=x.useState(n);V_(h,n)||p(n);const[g,v]=x.useState(null),[y,_]=x.useState(null),w=x.useCallback(q=>{q!==k.current&&(k.current=q,v(q))},[]),b=x.useCallback(q=>{q!==P.current&&(P.current=q,_(q))},[]),N=i||g,S=o||y,k=x.useRef(null),P=x.useRef(null),A=x.useRef(u),R=c!=null,$=_N(c),O=_N(a),z=_N(d),D=x.useCallback(()=>{if(!k.current||!P.current)return;const q={placement:t,strategy:r,middleware:h};O.current&&(q.platform=O.current),ere(k.current,P.current,q).then(K=>{const Z=H(M({},K),{isPositioned:z.current!==!1});B.current&&!V_(A.current,Z)&&(A.current=Z,so.flushSync(()=>{f(Z)}))})},[h,t,r,O,z]);a_(()=>{d===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,f(q=>H(M({},q),{isPositioned:!1})))},[d]);const B=x.useRef(!1);a_(()=>(B.current=!0,()=>{B.current=!1}),[]),a_(()=>{if(N&&(k.current=N),S&&(P.current=S),N&&S){if($.current)return $.current(N,S,D);D()}},[N,S,D,$,R]);const F=x.useMemo(()=>({reference:k,floating:P,setReference:w,setFloating:b}),[w,b]),U=x.useMemo(()=>({reference:N,floating:S}),[N,S]),G=x.useMemo(()=>{const q={position:r,left:0,top:0};if(!U.floating)return q;const K=bM(U.floating,u.x),Z=bM(U.floating,u.y);return l?M(H(M({},q),{transform:"translate("+K+"px, "+Z+"px)"}),nz(U.floating)>=1.5&&{willChange:"transform"}):{position:r,left:K,top:Z}},[r,l,U.floating,u.x,u.y]);return x.useMemo(()=>H(M({},u),{update:D,refs:F,elements:U,floatingStyles:G}),[u,D,F,U,G])}const sre=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?wM({element:n.current,padding:a}).fn(r):{}:n?wM({element:n,padding:a}).fn(r):{}}}},are=(e,t)=>H(M({},Yte(e)),{options:[e,t]}),ire=(e,t)=>H(M({},Kte(e)),{options:[e,t]}),ore=(e,t)=>H(M({},Qte(e)),{options:[e,t]}),lre=(e,t)=>H(M({},Zte(e)),{options:[e,t]}),cre=(e,t)=>H(M({},Xte(e)),{options:[e,t]}),dre=(e,t)=>H(M({},Jte(e)),{options:[e,t]}),ure=(e,t)=>H(M({},sre(e)),{options:[e,t]});var hre="Arrow",sz=x.forwardRef((e,t)=>{const o=e,{children:r,width:n=10,height:a=5}=o,i=me(o,["children","width","height"]);return s.jsx(Ct.svg,H(M({},i),{ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:s.jsx("polygon",{points:"0,0 30,0 15,10"})}))});sz.displayName=hre;var fre=sz;function zb(e){const[t,r]=x.useState(void 0);return vs(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,d=Array.isArray(c)?c[0]:c;o=d.inlineSize,l=d.blockSize}else o=e.offsetWidth,l=e.offsetHeight;r({width:o,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var OP="Popper",[az,Zd]=Os(OP),[mre,iz]=az(OP),oz=e=>{const{__scopePopper:t,children:r}=e,[n,a]=x.useState(null);return s.jsx(mre,{scope:t,anchor:n,onAnchorChange:a,children:r})};oz.displayName=OP;var lz="PopperAnchor",cz=x.forwardRef((e,t)=>{const c=e,{__scopePopper:r,virtualRef:n}=c,a=me(c,["__scopePopper","virtualRef"]),i=iz(lz,r),o=x.useRef(null),l=cr(t,o);return x.useEffect(()=>{i.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:s.jsx(Ct.div,H(M({},a),{ref:l}))});cz.displayName=lz;var MP="PopperContent",[pre,gre]=az(MP),dz=x.forwardRef((e,t)=>{var de,xe,ie,se,V,ue,_e,ae;const ee=e,{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:g}=ee,v=me(ee,["__scopePopper","side","sideOffset","align","alignOffset","arrowPadding","avoidCollisions","collisionBoundary","collisionPadding","sticky","hideWhenDetached","updatePositionStrategy","onPlaced"]),y=iz(MP,r),[_,w]=x.useState(null),b=cr(t,we=>w(we)),[N,S]=x.useState(null),k=zb(N),P=(de=k==null?void 0:k.width)!=null?de:0,A=(xe=k==null?void 0:k.height)!=null?xe:0,R=n+(i!=="center"?"-"+i:""),$=typeof u=="number"?u:M({top:0,right:0,bottom:0,left:0},u),O=Array.isArray(d)?d:[d],z=O.length>0,D={padding:$,boundary:O.filter(yre),altBoundary:z},{refs:B,floatingStyles:F,placement:U,isPositioned:G,middlewareData:q}=nre({strategy:"fixed",placement:R,whileElementsMounted:(...we)=>Gte(...we,{animationFrame:p==="always"}),elements:{reference:y.anchor},middleware:[are({mainAxis:a+A,alignmentAxis:o}),c&&ire(M({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?ore():void 0},D)),c&&lre(M({},D)),cre(H(M({},D),{apply:({elements:we,rects:oe,availableWidth:ce,availableHeight:Ae})=>{const{width:Be,height:Xe}=oe.reference,ge=we.floating.style;ge.setProperty("--radix-popper-available-width",`${ce}px`),ge.setProperty("--radix-popper-available-height",`${Ae}px`),ge.setProperty("--radix-popper-anchor-width",`${Be}px`),ge.setProperty("--radix-popper-anchor-height",`${Xe}px`)}})),N&&ure({element:N,padding:l}),xre({arrowWidth:P,arrowHeight:A}),h&&dre(M({strategy:"referenceHidden"},D))]}),[K,Z]=fz(U),Y=gs(g);vs(()=>{G&&(Y==null||Y())},[G,Y]);const Q=(ie=q.arrow)==null?void 0:ie.x,X=(se=q.arrow)==null?void 0:se.y,ne=((V=q.arrow)==null?void 0:V.centerOffset)!==0,[re,ye]=x.useState();return vs(()=>{_&&ye(window.getComputedStyle(_).zIndex)},[_]),s.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:M(H(M({},F),{transform:G?F.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:re,"--radix-popper-transform-origin":[(ue=q.transformOrigin)==null?void 0:ue.x,(_e=q.transformOrigin)==null?void 0:_e.y].join(" ")}),((ae=q.hide)==null?void 0:ae.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}),dir:e.dir,children:s.jsx(pre,{scope:r,placedSide:K,onArrowChange:S,arrowX:Q,arrowY:X,shouldHideArrow:ne,children:s.jsx(Ct.div,H(M({"data-side":K,"data-align":Z},v),{ref:b,style:H(M({},v.style),{animation:G?void 0:"none"})}))})})});dz.displayName=MP;var uz="PopperArrow",vre={top:"bottom",right:"left",bottom:"top",left:"right"},hz=x.forwardRef(function(t,r){const l=t,{__scopePopper:n}=l,a=me(l,["__scopePopper"]),i=gre(uz,n),o=vre[i.placedSide];return s.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:s.jsx(fre,H(M({},a),{ref:r,style:H(M({},a.style),{display:"block"})}))})});hz.displayName=uz;function yre(e){return e!==null}var xre=e=>({name:"transformOrigin",options:e,fn(t){var y,_,w,b,N;const{placement:r,rects:n,middlewareData:a}=t,o=((y=a.arrow)==null?void 0:y.centerOffset)!==0,l=o?0:e.arrowWidth,c=o?0:e.arrowHeight,[d,u]=fz(r),f={start:"0%",center:"50%",end:"100%"}[u],h=((w=(_=a.arrow)==null?void 0:_.x)!=null?w:0)+l/2,p=((N=(b=a.arrow)==null?void 0:b.y)!=null?N:0)+c/2;let g="",v="";return d==="bottom"?(g=o?f:`${h}px`,v=`${-c}px`):d==="top"?(g=o?f:`${h}px`,v=`${n.floating.height+c}px`):d==="right"?(g=`${-c}px`,v=o?f:`${p}px`):d==="left"&&(g=`${n.floating.width+c}px`,v=o?f:`${p}px`),{data:{x:g,y:v}}}});function fz(e){const[t,r="center"]=e.split("-");return[t,r]}var Bb=oz,Ly=cz,Ub=dz,qb=hz,[Vb,mBe]=Os("Tooltip",[Zd]),Wb=Zd(),mz="TooltipProvider",_re=700,Yk="tooltip.open",[wre,DP]=Vb(mz),pz=e=>{const{__scopeTooltip:t,delayDuration:r=_re,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:i}=e,o=x.useRef(!0),l=x.useRef(!1),c=x.useRef(0);return x.useEffect(()=>{const d=c.current;return()=>window.clearTimeout(d)},[]),s.jsx(wre,{scope:t,isOpenDelayedRef:o,delayDuration:r,onOpen:x.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:x.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:x.useCallback(d=>{l.current=d},[]),disableHoverableContent:a,children:i})};pz.displayName=mz;var Tv="Tooltip",[bre,Hb]=Vb(Tv),gz=e=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:a,onOpenChange:i,disableHoverableContent:o,delayDuration:l}=e,c=DP(Tv,e.__scopeTooltip),d=Wb(t),[u,f]=x.useState(null),h=Ps(),p=x.useRef(0),g=o!=null?o:c.disableHoverableContent,v=l!=null?l:c.delayDuration,y=x.useRef(!1),[_,w]=Wa({prop:n,defaultProp:a!=null?a:!1,onChange:P=>{P?(c.onOpen(),document.dispatchEvent(new CustomEvent(Yk))):c.onClose(),i==null||i(P)},caller:Tv}),b=x.useMemo(()=>_?y.current?"delayed-open":"instant-open":"closed",[_]),N=x.useCallback(()=>{window.clearTimeout(p.current),p.current=0,y.current=!1,w(!0)},[w]),S=x.useCallback(()=>{window.clearTimeout(p.current),p.current=0,w(!1)},[w]),k=x.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{y.current=!0,w(!0),p.current=0},v)},[v,w]);return x.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),s.jsx(Bb,H(M({},d),{children:s.jsx(bre,{scope:t,contentId:h,open:_,stateAttribute:b,trigger:u,onTriggerChange:f,onTriggerEnter:x.useCallback(()=>{c.isOpenDelayedRef.current?k():N()},[c.isOpenDelayedRef,k,N]),onTriggerLeave:x.useCallback(()=>{g?S():(window.clearTimeout(p.current),p.current=0)},[S,g]),onOpen:N,onClose:S,disableHoverableContent:g,children:r})}))};gz.displayName=Tv;var Kk="TooltipTrigger",vz=x.forwardRef((e,t)=>{const h=e,{__scopeTooltip:r}=h,n=me(h,["__scopeTooltip"]),a=Hb(Kk,r),i=DP(Kk,r),o=Wb(r),l=x.useRef(null),c=cr(t,l,a.onTriggerChange),d=x.useRef(!1),u=x.useRef(!1),f=x.useCallback(()=>d.current=!1,[]);return x.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),s.jsx(Ly,H(M({asChild:!0},o),{children:s.jsx(Ct.button,H(M({"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute},n),{ref:c,onPointerMove:pt(e.onPointerMove,p=>{p.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:pt(e.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:pt(e.onPointerDown,()=>{a.open&&a.onClose(),d.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:pt(e.onFocus,()=>{d.current||a.onOpen()}),onBlur:pt(e.onBlur,a.onClose),onClick:pt(e.onClick,a.onClose)}))}))});vz.displayName=Kk;var jre="TooltipPortal",[pBe,Nre]=Vb(jre,{forceMount:void 0}),vm="TooltipContent",yz=x.forwardRef((e,t)=>{const r=Nre(vm,e.__scopeTooltip),l=e,{forceMount:n=r.forceMount,side:a="top"}=l,i=me(l,["forceMount","side"]),o=Hb(vm,e.__scopeTooltip);return s.jsx(Ys,{present:n||o.open,children:o.disableHoverableContent?s.jsx(xz,H(M({side:a},i),{ref:t})):s.jsx(Sre,H(M({side:a},i),{ref:t}))})}),Sre=x.forwardRef((e,t)=>{const r=Hb(vm,e.__scopeTooltip),n=DP(vm,e.__scopeTooltip),a=x.useRef(null),i=cr(t,a),[o,l]=x.useState(null),{trigger:c,onClose:d}=r,u=a.current,{onPointerInTransitChange:f}=n,h=x.useCallback(()=>{l(null),f(!1)},[f]),p=x.useCallback((g,v)=>{const y=g.currentTarget,_={x:g.clientX,y:g.clientY},w=Tre(_,y.getBoundingClientRect()),b=Are(_,w),N=Rre(v.getBoundingClientRect()),S=Mre([...b,...N]);l(S),f(!0)},[f]);return x.useEffect(()=>()=>h(),[h]),x.useEffect(()=>{if(c&&u){const g=y=>p(y,u),v=y=>p(y,c);return c.addEventListener("pointerleave",g),u.addEventListener("pointerleave",v),()=>{c.removeEventListener("pointerleave",g),u.removeEventListener("pointerleave",v)}}},[c,u,p,h]),x.useEffect(()=>{if(o){const g=v=>{const y=v.target,_={x:v.clientX,y:v.clientY},w=(c==null?void 0:c.contains(y))||(u==null?void 0:u.contains(y)),b=!Ore(_,o);w?h():b&&(h(),d())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[c,u,o,d,h]),s.jsx(xz,H(M({},e),{ref:i}))}),[kre,Ere]=Vb(Tv,{isInside:!1}),Cre=X6("TooltipContent"),xz=x.forwardRef((e,t)=>{const f=e,{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o}=f,l=me(f,["__scopeTooltip","children","aria-label","onEscapeKeyDown","onPointerDownOutside"]),c=Hb(vm,r),d=Wb(r),{onClose:u}=c;return x.useEffect(()=>(document.addEventListener(Yk,u),()=>document.removeEventListener(Yk,u)),[u]),x.useEffect(()=>{if(c.trigger){const h=p=>{const g=p.target;g!=null&&g.contains(c.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[c.trigger,u]),s.jsx(wh,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:s.jsxs(Ub,H(M(M({"data-state":c.stateAttribute},d),l),{ref:t,style:H(M({},l.style),{"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}),children:[s.jsx(Cre,{children:n}),s.jsx(kre,{scope:r,isInside:!0,children:s.jsx(IJ,{id:c.contentId,role:"tooltip",children:a||n})})]}))})});yz.displayName=vm;var _z="TooltipArrow",Pre=x.forwardRef((e,t)=>{const o=e,{__scopeTooltip:r}=o,n=me(o,["__scopeTooltip"]),a=Wb(r);return Ere(_z,r).isInside?null:s.jsx(qb,H(M(M({},a),n),{ref:t}))});Pre.displayName=_z;function Tre(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,n,a,i)){case i:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function Are(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function Rre(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function Ore(e,t){const{x:r,y:n}=e;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],c=t[o],d=l.x,u=l.y,f=c.x,h=c.y;u>n!=h>n&&r<(f-d)*(n-u)/(h-u)+d&&(a=!a)}return a}function Mre(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),Dre(t)}function Dre(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var Ire=pz,$re=gz,Lre=vz,wz=yz;const IP=Ire,bz=$re,jz=Lre,$P=x.forwardRef((a,n)=>{var i=a,{className:e,sideOffset:t=4}=i,r=me(i,["className","sideOffset"]);return s.jsx(wz,M({ref:n,sideOffset:t,className:ke("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e)},r))});$P.displayName=wz.displayName;var Gb=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Yb=typeof window=="undefined"||"Deno"in globalThis;function No(){}function Fre(e,t){return typeof e=="function"?e(t):e}function zre(e){return typeof e=="number"&&e>=0&&e!==1/0}function Bre(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Zk(e,t){return typeof e=="function"?e(t):e}function Ure(e,t){return typeof e=="function"?e(t):e}function jM(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:i,queryKey:o,stale:l}=e;if(o){if(n){if(t.queryHash!==LP(o,t.options))return!1}else if(!Rv(t.queryKey,o))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||i&&!i(t))}function NM(e,t){const{exact:r,status:n,predicate:a,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Av(t.options.mutationKey)!==Av(i))return!1}else if(!Rv(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function LP(e,t){return((t==null?void 0:t.queryKeyHashFn)||Av)(e)}function Av(e){return JSON.stringify(e,(t,r)=>Xk(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function Rv(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Rv(e[r],t[r])):!1}function Nz(e,t){if(e===t)return e;const r=SM(e)&&SM(t);if(r||Xk(e)&&Xk(t)){const n=r?e:Object.keys(e),a=n.length,i=r?t:Object.keys(t),o=i.length,l=r?[]:{},c=new Set(n);let d=0;for(let u=0;u<o;u++){const f=r?u:i[u];(!r&&c.has(f)||r)&&e[f]===void 0&&t[f]===void 0?(l[f]=void 0,d++):(l[f]=Nz(e[f],t[f]),l[f]===e[f]&&e[f]!==void 0&&d++)}return a===o&&d===a?e:l}return t}function SM(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Xk(e){if(!kM(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!kM(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function kM(e){return Object.prototype.toString.call(e)==="[object Object]"}function qre(e){return new Promise(t=>{setTimeout(t,e)})}function Vre(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Nz(e,t):t}function Wre(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function Hre(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var FP=Symbol();function Sz(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===FP?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var zu,hd,tm,P$,Gre=(P$=class extends Gb{constructor(){super();_n(this,zu);_n(this,hd);_n(this,tm);Pr(this,tm,t=>{if(!Yb&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){rt(this,hd)||this.setEventListener(rt(this,tm))}onUnsubscribe(){var t;this.hasListeners()||((t=rt(this,hd))==null||t.call(this),Pr(this,hd,void 0))}setEventListener(t){var r;Pr(this,tm,t),(r=rt(this,hd))==null||r.call(this),Pr(this,hd,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){rt(this,zu)!==t&&(Pr(this,zu,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof rt(this,zu)=="boolean"?rt(this,zu):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},zu=new WeakMap,hd=new WeakMap,tm=new WeakMap,P$),kz=new Gre,rm,fd,nm,T$,Yre=(T$=class extends Gb{constructor(){super();_n(this,rm,!0);_n(this,fd);_n(this,nm);Pr(this,nm,t=>{if(!Yb&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){rt(this,fd)||this.setEventListener(rt(this,nm))}onUnsubscribe(){var t;this.hasListeners()||((t=rt(this,fd))==null||t.call(this),Pr(this,fd,void 0))}setEventListener(t){var r;Pr(this,nm,t),(r=rt(this,fd))==null||r.call(this),Pr(this,fd,t(this.setOnline.bind(this)))}setOnline(t){rt(this,rm)!==t&&(Pr(this,rm,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return rt(this,rm)}},rm=new WeakMap,fd=new WeakMap,nm=new WeakMap,T$),W_=new Yre;function Kre(){let e,t;const r=new Promise((a,i)=>{e=a,t=i});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}function Zre(e){return Math.min(1e3*Gp(2,e),3e4)}function Ez(e){return(e!=null?e:"online")==="online"?W_.isOnline():!0}var Cz=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function wN(e){return e instanceof Cz}function Pz(e){let t=!1,r=0,n=!1,a;const i=Kre(),o=v=>{var y;n||(h(new Cz(v)),(y=e.abort)==null||y.call(e))},l=()=>{t=!0},c=()=>{t=!1},d=()=>kz.isFocused()&&(e.networkMode==="always"||W_.isOnline())&&e.canRun(),u=()=>Ez(e.networkMode)&&e.canRun(),f=v=>{var y;n||(n=!0,(y=e.onSuccess)==null||y.call(e,v),a==null||a(),i.resolve(v))},h=v=>{var y;n||(n=!0,(y=e.onError)==null||y.call(e,v),a==null||a(),i.reject(v))},p=()=>new Promise(v=>{var y;a=_=>{(n||d())&&v(_)},(y=e.onPause)==null||y.call(e)}).then(()=>{var v;a=void 0,n||(v=e.onContinue)==null||v.call(e)}),g=()=>{if(n)return;let v;const y=r===0?e.initialPromise:void 0;try{v=y!=null?y:e.fn()}catch(_){v=Promise.reject(_)}Promise.resolve(v).then(f).catch(_=>{var k,P,A;if(n)return;const w=(k=e.retry)!=null?k:Yb?0:3,b=(P=e.retryDelay)!=null?P:Zre,N=typeof b=="function"?b(r,_):b,S=w===!0||typeof w=="number"&&r<w||typeof w=="function"&&w(r,_);if(t||!S){h(_);return}r++,(A=e.onFail)==null||A.call(e,r,_),qre(N).then(()=>d()?void 0:p()).then(()=>{t?h(_):g()})})};return{promise:i,cancel:o,continue:()=>(a==null||a(),i),cancelRetry:l,continueRetry:c,canStart:u,start:()=>(u()?g():p().then(g),i)}}var Xre=e=>setTimeout(e,0);function Jre(){let e=[],t=0,r=l=>{l()},n=l=>{l()},a=Xre;const i=l=>{t?e.push(l):a(()=>{r(l)})},o=()=>{const l=e;e=[],l.length&&a(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{a=l}}}var Ba=Jre(),Bu,A$,Tz=(A$=class{constructor(){_n(this,Bu)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),zre(this.gcTime)&&Pr(this,Bu,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e!=null?e:Yb?1/0:5*60*1e3)}clearGcTimeout(){rt(this,Bu)&&(clearTimeout(rt(this,Bu)),Pr(this,Bu,void 0))}},Bu=new WeakMap,A$),sm,Uu,qi,qu,Na,Ey,Vu,So,Ql,R$,Qre=(R$=class extends Tz{constructor(t){var r;super();_n(this,So);_n(this,sm);_n(this,Uu);_n(this,qi);_n(this,qu);_n(this,Na);_n(this,Ey);_n(this,Vu);Pr(this,Vu,!1),Pr(this,Ey,t.defaultOptions),this.setOptions(t.options),this.observers=[],Pr(this,qu,t.client),Pr(this,qi,rt(this,qu).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Pr(this,sm,tne(this.options)),this.state=(r=t.state)!=null?r:rt(this,sm),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=rt(this,Na))==null?void 0:t.promise}setOptions(t){this.options=M(M({},rt(this,Ey)),t),this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&rt(this,qi).remove(this)}setData(t,r){const n=Vre(this.state.data,t,this.options);return _a(this,So,Ql).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){_a(this,So,Ql).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=rt(this,Na))==null?void 0:n.promise;return(a=rt(this,Na))==null||a.cancel(t),r?r.then(No).catch(No):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(rt(this,sm))}isActive(){return this.observers.some(t=>Ure(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===FP||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Zk(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Bre(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=rt(this,Na))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=rt(this,Na))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),rt(this,qi).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(rt(this,Na)&&(rt(this,Vu)?rt(this,Na).cancel({revert:!0}):rt(this,Na).cancelRetry()),this.scheduleGc()),rt(this,qi).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||_a(this,So,Ql).call(this,{type:"invalidate"})}fetch(t,r){var d,u,f;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(rt(this,Na))return rt(this,Na).continueRetry(),rt(this,Na).promise}if(t&&this.setOptions(t),!this.options.queryFn){const h=this.observers.find(p=>p.options.queryFn);h&&this.setOptions(h.options)}const n=new AbortController,a=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(Pr(this,Vu,!0),n.signal)})},i=()=>{const h=Sz(this.options,r),g=(()=>{const v={client:rt(this,qu),queryKey:this.queryKey,meta:this.meta};return a(v),v})();return Pr(this,Vu,!1),this.options.persister?this.options.persister(h,g,this):h(g)},l=(()=>{const h={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:rt(this,qu),state:this.state,fetchFn:i};return a(h),h})();(d=this.options.behavior)==null||d.onFetch(l,this),Pr(this,Uu,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=l.fetchOptions)==null?void 0:u.meta))&&_a(this,So,Ql).call(this,{type:"fetch",meta:(f=l.fetchOptions)==null?void 0:f.meta});const c=h=>{var p,g,v,y;wN(h)&&h.silent||_a(this,So,Ql).call(this,{type:"error",error:h}),wN(h)||((g=(p=rt(this,qi).config).onError)==null||g.call(p,h,this),(y=(v=rt(this,qi).config).onSettled)==null||y.call(v,this.state.data,h,this)),this.scheduleGc()};return Pr(this,Na,Pz({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:h=>{var p,g,v,y;if(h===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(_){c(_);return}(g=(p=rt(this,qi).config).onSuccess)==null||g.call(p,h,this),(y=(v=rt(this,qi).config).onSettled)==null||y.call(v,h,this.state.error,this),this.scheduleGc()},onError:c,onFail:(h,p)=>{_a(this,So,Ql).call(this,{type:"failed",failureCount:h,error:p})},onPause:()=>{_a(this,So,Ql).call(this,{type:"pause"})},onContinue:()=>{_a(this,So,Ql).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),rt(this,Na).start()}},sm=new WeakMap,Uu=new WeakMap,qi=new WeakMap,qu=new WeakMap,Na=new WeakMap,Ey=new WeakMap,Vu=new WeakMap,So=new WeakSet,Ql=function(t){const r=n=>{var a,i;switch(t.type){case"failed":return H(M({},n),{fetchFailureCount:t.failureCount,fetchFailureReason:t.error});case"pause":return H(M({},n),{fetchStatus:"paused"});case"continue":return H(M({},n),{fetchStatus:"fetching"});case"fetch":return H(M(M({},n),ene(n.data,this.options)),{fetchMeta:(a=t.meta)!=null?a:null});case"success":return Pr(this,Uu,void 0),M(H(M({},n),{data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:(i=t.dataUpdatedAt)!=null?i:Date.now(),error:null,isInvalidated:!1,status:"success"}),!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null});case"error":const o=t.error;return wN(o)&&o.revert&&rt(this,Uu)?H(M({},rt(this,Uu)),{fetchStatus:"idle"}):H(M({},n),{error:o,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"});case"invalidate":return H(M({},n),{isInvalidated:!0});case"setState":return M(M({},n),t.state)}};this.state=r(this.state),Ba.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),rt(this,qi).notify({query:this,type:"updated",action:t})})},R$);function ene(e,t){return M({fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ez(t.networkMode)?"fetching":"paused"},e===void 0&&{error:null,status:"pending"})}function tne(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n!=null?n:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var cl,O$,rne=(O$=class extends Gb{constructor(t={}){super();_n(this,cl);this.config=t,Pr(this,cl,new Map)}build(t,r,n){var l;const a=r.queryKey,i=(l=r.queryHash)!=null?l:LP(a,r);let o=this.get(i);return o||(o=new Qre({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(o)),o}add(t){rt(this,cl).has(t.queryHash)||(rt(this,cl).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=rt(this,cl).get(t.queryHash);r&&(t.destroy(),r===t&&rt(this,cl).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ba.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return rt(this,cl).get(t)}getAll(){return[...rt(this,cl).values()]}find(t){const r=M({exact:!0},t);return this.getAll().find(n=>jM(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>jM(t,n)):r}notify(t){Ba.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Ba.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ba.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},cl=new WeakMap,O$),dl,La,Wu,ul,ed,M$,nne=(M$=class extends Tz{constructor(t){super();_n(this,ul);_n(this,dl);_n(this,La);_n(this,Wu);this.mutationId=t.mutationId,Pr(this,La,t.mutationCache),Pr(this,dl,[]),this.state=t.state||sne(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){rt(this,dl).includes(t)||(rt(this,dl).push(t),this.clearGcTimeout(),rt(this,La).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Pr(this,dl,rt(this,dl).filter(r=>r!==t)),this.scheduleGc(),rt(this,La).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){rt(this,dl).length||(this.state.status==="pending"?this.scheduleGc():rt(this,La).remove(this))}continue(){var t,r;return(r=(t=rt(this,Wu))==null?void 0:t.continue())!=null?r:this.execute(this.state.variables)}execute(t){return E(this,null,function*(){var i,o,l,c,d,u,f,h,p,g,v,y,_,w,b,N,S,k,P,A,R;const r=()=>{_a(this,ul,ed).call(this,{type:"continue"})};Pr(this,Wu,Pz({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:($,O)=>{_a(this,ul,ed).call(this,{type:"failed",failureCount:$,error:O})},onPause:()=>{_a(this,ul,ed).call(this,{type:"pause"})},onContinue:r,retry:(i=this.options.retry)!=null?i:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>rt(this,La).canRun(this)}));const n=this.state.status==="pending",a=!rt(this,Wu).canStart();try{if(n)r();else{_a(this,ul,ed).call(this,{type:"pending",variables:t,isPaused:a}),yield(l=(o=rt(this,La).config).onMutate)==null?void 0:l.call(o,t,this);const O=yield(d=(c=this.options).onMutate)==null?void 0:d.call(c,t);O!==this.state.context&&_a(this,ul,ed).call(this,{type:"pending",context:O,variables:t,isPaused:a})}const $=yield rt(this,Wu).start();return yield(f=(u=rt(this,La).config).onSuccess)==null?void 0:f.call(u,$,t,this.state.context,this),yield(p=(h=this.options).onSuccess)==null?void 0:p.call(h,$,t,this.state.context),yield(v=(g=rt(this,La).config).onSettled)==null?void 0:v.call(g,$,null,this.state.variables,this.state.context,this),yield(_=(y=this.options).onSettled)==null?void 0:_.call(y,$,null,t,this.state.context),_a(this,ul,ed).call(this,{type:"success",data:$}),$}catch($){try{throw yield(b=(w=rt(this,La).config).onError)==null?void 0:b.call(w,$,t,this.state.context,this),yield(S=(N=this.options).onError)==null?void 0:S.call(N,$,t,this.state.context),yield(P=(k=rt(this,La).config).onSettled)==null?void 0:P.call(k,void 0,$,this.state.variables,this.state.context,this),yield(R=(A=this.options).onSettled)==null?void 0:R.call(A,void 0,$,t,this.state.context),$}finally{_a(this,ul,ed).call(this,{type:"error",error:$})}}finally{rt(this,La).runNext(this)}})}},dl=new WeakMap,La=new WeakMap,Wu=new WeakMap,ul=new WeakSet,ed=function(t){const r=n=>{switch(t.type){case"failed":return H(M({},n),{failureCount:t.failureCount,failureReason:t.error});case"pause":return H(M({},n),{isPaused:!0});case"continue":return H(M({},n),{isPaused:!1});case"pending":return H(M({},n),{context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()});case"success":return H(M({},n),{data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1});case"error":return H(M({},n),{data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"})}};this.state=r(this.state),Ba.batch(()=>{rt(this,dl).forEach(n=>{n.onMutationUpdate(t)}),rt(this,La).notify({mutation:this,type:"updated",action:t})})},M$);function sne(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ic,ko,Cy,D$,ane=(D$=class extends Gb{constructor(t={}){super();_n(this,ic);_n(this,ko);_n(this,Cy);this.config=t,Pr(this,ic,new Set),Pr(this,ko,new Map),Pr(this,Cy,0)}build(t,r,n){const a=new nne({mutationCache:this,mutationId:++Ux(this,Cy)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){rt(this,ic).add(t);const r=d0(t);if(typeof r=="string"){const n=rt(this,ko).get(r);n?n.push(t):rt(this,ko).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(rt(this,ic).delete(t)){const r=d0(t);if(typeof r=="string"){const n=rt(this,ko).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&rt(this,ko).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=d0(t);if(typeof r=="string"){const n=rt(this,ko).get(r),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n,a;const r=d0(t);if(typeof r=="string"){const i=(n=rt(this,ko).get(r))==null?void 0:n.find(o=>o!==t&&o.state.isPaused);return(a=i==null?void 0:i.continue())!=null?a:Promise.resolve()}else return Promise.resolve()}clear(){Ba.batch(()=>{rt(this,ic).forEach(t=>{this.notify({type:"removed",mutation:t})}),rt(this,ic).clear(),rt(this,ko).clear()})}getAll(){return Array.from(rt(this,ic))}find(t){const r=M({exact:!0},t);return this.getAll().find(n=>NM(r,n))}findAll(t={}){return this.getAll().filter(r=>NM(t,r))}notify(t){Ba.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Ba.batch(()=>Promise.all(t.map(r=>r.continue().catch(No))))}},ic=new WeakMap,ko=new WeakMap,Cy=new WeakMap,D$);function d0(e){var t;return(t=e.options.scope)==null?void 0:t.id}function EM(e){return{onFetch:(t,r)=>{var u,f,h,p,g;const n=t.options,a=(h=(f=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:f.fetchMore)==null?void 0:h.direction,i=((p=t.state.data)==null?void 0:p.pages)||[],o=((g=t.state.data)==null?void 0:g.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=()=>E(this,null,function*(){var b;let v=!1;const y=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(t.signal.aborted?v=!0:t.signal.addEventListener("abort",()=>{v=!0}),t.signal)})},_=Sz(t.options,t.fetchOptions),w=(N,S,k)=>E(this,null,function*(){if(v)return Promise.reject();if(S==null&&N.pages.length)return Promise.resolve(N);const A=(()=>{const z={client:t.client,queryKey:t.queryKey,pageParam:S,direction:k?"backward":"forward",meta:t.options.meta};return y(z),z})(),R=yield _(A),{maxPages:$}=t.options,O=k?Hre:Wre;return{pages:O(N.pages,R,$),pageParams:O(N.pageParams,S,$)}});if(a&&i.length){const N=a==="backward",S=N?ine:CM,k={pages:i,pageParams:o},P=S(n,k);l=yield w(k,P,N)}else{const N=e!=null?e:i.length;do{const S=c===0?(b=o[0])!=null?b:n.initialPageParam:CM(n,l);if(c>0&&S==null)break;l=yield w(l,S),c++}while(c<N)}return l});t.options.persister?t.fetchFn=()=>{var v,y;return(y=(v=t.options).persister)==null?void 0:y.call(v,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=d}}}function CM(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function ine(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var us,md,pd,am,im,gd,om,lm,I$,one=(I$=class{constructor(e={}){_n(this,us);_n(this,md);_n(this,pd);_n(this,am);_n(this,im);_n(this,gd);_n(this,om);_n(this,lm);Pr(this,us,e.queryCache||new rne),Pr(this,md,e.mutationCache||new ane),Pr(this,pd,e.defaultOptions||{}),Pr(this,am,new Map),Pr(this,im,new Map),Pr(this,gd,0)}mount(){Ux(this,gd)._++,rt(this,gd)===1&&(Pr(this,om,kz.subscribe(e=>E(this,null,function*(){e&&(yield this.resumePausedMutations(),rt(this,us).onFocus())}))),Pr(this,lm,W_.subscribe(e=>E(this,null,function*(){e&&(yield this.resumePausedMutations(),rt(this,us).onOnline())}))))}unmount(){var e,t;Ux(this,gd)._--,rt(this,gd)===0&&((e=rt(this,om))==null||e.call(this),Pr(this,om,void 0),(t=rt(this,lm))==null||t.call(this),Pr(this,lm,void 0))}isFetching(e){return rt(this,us).findAll(H(M({},e),{fetchStatus:"fetching"})).length}isMutating(e){return rt(this,md).findAll(H(M({},e),{status:"pending"})).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=rt(this,us).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=rt(this,us).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Zk(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return rt(this,us).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=rt(this,us).get(n.queryHash),i=a==null?void 0:a.state.data,o=Fre(t,i);if(o!==void 0)return rt(this,us).build(this,n).setData(o,H(M({},r),{manual:!0}))}setQueriesData(e,t,r){return Ba.batch(()=>rt(this,us).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=rt(this,us).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=rt(this,us);Ba.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=rt(this,us);return Ba.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries(M({type:"active"},e),t)))}cancelQueries(e,t={}){const r=M({revert:!0},t),n=Ba.batch(()=>rt(this,us).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(No).catch(No)}invalidateQueries(e,t={}){return Ba.batch(()=>{var r,n;return rt(this,us).findAll(e).forEach(a=>{a.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries(H(M({},e),{type:(n=(r=e==null?void 0:e.refetchType)!=null?r:e==null?void 0:e.type)!=null?n:"active"}),t)})}refetchQueries(e,t={}){var a;const r=H(M({},t),{cancelRefetch:(a=t.cancelRefetch)!=null?a:!0}),n=Ba.batch(()=>rt(this,us).findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let o=i.fetch(void 0,r);return r.throwOnError||(o=o.catch(No)),i.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(No)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=rt(this,us).build(this,t);return r.isStaleByTime(Zk(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(No).catch(No)}fetchInfiniteQuery(e){return e.behavior=EM(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(No).catch(No)}ensureInfiniteQueryData(e){return e.behavior=EM(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return W_.isOnline()?rt(this,md).resumePausedMutations():Promise.resolve()}getQueryCache(){return rt(this,us)}getMutationCache(){return rt(this,md)}getDefaultOptions(){return rt(this,pd)}setDefaultOptions(e){Pr(this,pd,e)}setQueryDefaults(e,t){rt(this,am).set(Av(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...rt(this,am).values()],r={};return t.forEach(n=>{Rv(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){rt(this,im).set(Av(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...rt(this,im).values()],r={};return t.forEach(n=>{Rv(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t=H(M(M(M({},rt(this,pd).queries),this.getQueryDefaults(e.queryKey)),e),{_defaulted:!0});return t.queryHash||(t.queryHash=LP(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===FP&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:H(M(M(M({},rt(this,pd).mutations),(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey)),e),{_defaulted:!0})}clear(){rt(this,us).clear(),rt(this,md).clear()}},us=new WeakMap,md=new WeakMap,pd=new WeakMap,am=new WeakMap,im=new WeakMap,gd=new WeakMap,om=new WeakMap,lm=new WeakMap,I$),lne=x.createContext(void 0),cne=({client:e,children:t})=>(x.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),s.jsx(lne.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ov(){return Ov=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ov.apply(this,arguments)}var xd;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(xd||(xd={}));const PM="popstate";function dne(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:o,hash:l}=n.location;return Jk("",{pathname:i,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Rz(a)}return hne(t,r,null,e)}function Ts(e,t){if(e===!1||e===null||typeof e=="undefined")throw new Error(t)}function Az(e,t){if(!e){typeof console!="undefined"&&console.warn(t);try{throw new Error(t)}catch(r){}}}function une(){return Math.random().toString(36).substr(2,8)}function TM(e,t){return{usr:e.state,key:e.key,idx:t}}function Jk(e,t,r,n){return r===void 0&&(r=null),Ov({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?fp(t):t,{state:r,key:t&&t.key||n||une()})}function Rz(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function fp(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function hne(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,l=xd.Pop,c=null,d=u();d==null&&(d=0,o.replaceState(Ov({},o.state,{idx:d}),""));function u(){return(o.state||{idx:null}).idx}function f(){l=xd.Pop;let y=u(),_=y==null?null:y-d;d=y,c&&c({action:l,location:v.location,delta:_})}function h(y,_){l=xd.Push;let w=Jk(v.location,y,_);d=u()+1;let b=TM(w,d),N=v.createHref(w);try{o.pushState(b,"",N)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;a.location.assign(N)}i&&c&&c({action:l,location:v.location,delta:1})}function p(y,_){l=xd.Replace;let w=Jk(v.location,y,_);d=u();let b=TM(w,d),N=v.createHref(w);o.replaceState(b,"",N),i&&c&&c({action:l,location:v.location,delta:0})}function g(y){let _=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof y=="string"?y:Rz(y);return w=w.replace(/ $/,"%20"),Ts(_,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,_)}let v={get action(){return l},get location(){return e(a,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(PM,f),c=y,()=>{a.removeEventListener(PM,f),c=null}},createHref(y){return t(a,y)},createURL:g,encodeLocation(y){let _=g(y);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:h,replace:p,go(y){return o.go(y)}};return v}var AM;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(AM||(AM={}));function fne(e,t,r){return r===void 0&&(r="/"),mne(e,t,r,!1)}function mne(e,t,r,n){let a=typeof t=="string"?fp(t):t,i=Dz(a.pathname||"/",r);if(i==null)return null;let o=Oz(e);pne(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=kne(i);l=Nne(o[c],d,n)}return l}function Oz(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Ts(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Yu([n,c.relativePath]),u=r.concat(c);i.children&&i.children.length>0&&(Ts(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Oz(i.children,t,u,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:bne(d,i.index),routesMeta:u})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,o);else for(let c of Mz(i.path))a(i,o,c)}),t}function Mz(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=Mz(n.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function pne(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:jne(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const gne=/^:[\w-]+$/,vne=3,yne=2,xne=1,_ne=10,wne=-2,RM=e=>e==="*";function bne(e,t){let r=e.split("/"),n=r.length;return r.some(RM)&&(n+=wne),t&&(n+=yne),r.filter(a=>!RM(a)).reduce((a,i)=>a+(gne.test(i)?vne:i===""?xne:_ne),n)}function jne(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function Nne(e,t,r){let{routesMeta:n}=e,a={},i="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",f=OM({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),h=c.route;if(!f&&d&&r&&!n[n.length-1].route.index&&(f=OM({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:Yu([i,f.pathname]),pathnameBase:Tne(Yu([i,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(i=Yu([i,f.pathnameBase]))}return o}function OM(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Sne(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((d,u,f)=>{let{paramName:h,isOptional:p}=u;if(h==="*"){let v=l[f]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const g=l[f];return p&&!g?d[h]=void 0:d[h]=(g||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:e}}function Sne(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Az(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function kne(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Az(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Dz(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Ene(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?fp(e):e;return{pathname:r?r.startsWith("/")?r:Cne(r,t):t,search:Ane(n),hash:Rne(a)}}function Cne(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function bN(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Pne(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Iz(e,t){let r=Pne(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function $z(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=fp(e):(a=Ov({},e),Ts(!a.pathname||!a.pathname.includes("?"),bN("?","pathname","search",a)),Ts(!a.pathname||!a.pathname.includes("#"),bN("#","pathname","hash",a)),Ts(!a.search||!a.search.includes("#"),bN("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=r;else{let f=t.length-1;if(!n&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),f-=1;a.pathname=h.join("/")}l=f>=0?t[f]:"/"}let c=Ene(a,l),d=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const Yu=e=>e.join("/").replace(/\/\/+/g,"/"),Tne=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Ane=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Rne=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function One(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Lz=["post","put","patch","delete"];new Set(Lz);const Mne=["get",...Lz];new Set(Mne);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mv(){return Mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mv.apply(this,arguments)}const zP=x.createContext(null),Dne=x.createContext(null),Fy=x.createContext(null),Kb=x.createContext(null),Xd=x.createContext({outlet:null,matches:[],isDataRoute:!1}),Fz=x.createContext(null);function zy(){return x.useContext(Kb)!=null}function bh(){return zy()||Ts(!1),x.useContext(Kb).location}function zz(e){x.useContext(Fy).static||x.useLayoutEffect(e)}function as(){let{isDataRoute:e}=x.useContext(Xd);return e?Yne():Ine()}function Ine(){zy()||Ts(!1);let e=x.useContext(zP),{basename:t,future:r,navigator:n}=x.useContext(Fy),{matches:a}=x.useContext(Xd),{pathname:i}=bh(),o=JSON.stringify(Iz(a,r.v7_relativeSplatPath)),l=x.useRef(!1);return zz(()=>{l.current=!0}),x.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let f=$z(d,JSON.parse(o),i,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Yu([t,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[t,n,o,i,e])}function BP(){let{matches:e}=x.useContext(Xd),t=e[e.length-1];return t?t.params:{}}function $ne(e,t){return Lne(e,t)}function Lne(e,t,r,n){zy()||Ts(!1);let{navigator:a}=x.useContext(Fy),{matches:i}=x.useContext(Xd),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=bh(),u;if(t){var f;let y=typeof t=="string"?fp(t):t;c==="/"||(f=y.pathname)!=null&&f.startsWith(c)||Ts(!1),u=y}else u=d;let h=u.pathname||"/",p=h;if(c!=="/"){let y=c.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let g=fne(e,{pathname:p}),v=qne(g&&g.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:Yu([c,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Yu([c,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,r,n);return t&&v?x.createElement(Kb.Provider,{value:{location:Mv({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:xd.Pop}},v):v}function Fne(){let e=Gne(),t=One(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},t),r?x.createElement("pre",{style:a},r):null,null)}const zne=x.createElement(Fne,null);class Bne extends x.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?x.createElement(Xd.Provider,{value:this.props.routeContext},x.createElement(Fz.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Une(e){let{routeContext:t,match:r,children:n}=e,a=x.useContext(zP);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),x.createElement(Xd.Provider,{value:t},n)}function qne(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(a=r)==null?void 0:a.errors;if(l!=null){let u=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);u>=0||Ts(!1),o=o.slice(0,Math.min(o.length,u+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<o.length;u++){let f=o[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=u),f.route.id){let{loaderData:h,errors:p}=r,g=f.route.loader&&h[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||g){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((u,f,h)=>{let p,g=!1,v=null,y=null;r&&(p=l&&f.route.id?l[f.route.id]:void 0,v=f.route.errorElement||zne,c&&(d<0&&h===0?(g=!0,y=null):d===h&&(g=!0,y=f.route.hydrateFallbackElement||null)));let _=t.concat(o.slice(0,h+1)),w=()=>{let b;return p?b=v:g?b=y:f.route.Component?b=x.createElement(f.route.Component,null):f.route.element?b=f.route.element:b=u,x.createElement(Une,{match:f,routeContext:{outlet:u,matches:_,isDataRoute:r!=null},children:b})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?x.createElement(Bne,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:w(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):w()},null)}var Bz=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Bz||{}),H_=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(H_||{});function Vne(e){let t=x.useContext(zP);return t||Ts(!1),t}function Wne(e){let t=x.useContext(Dne);return t||Ts(!1),t}function Hne(e){let t=x.useContext(Xd);return t||Ts(!1),t}function Uz(e){let t=Hne(),r=t.matches[t.matches.length-1];return r.route.id||Ts(!1),r.route.id}function Gne(){var e;let t=x.useContext(Fz),r=Wne(H_.UseRouteError),n=Uz(H_.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Yne(){let{router:e}=Vne(Bz.UseNavigateStable),t=Uz(H_.UseNavigateStable),r=x.useRef(!1);return zz(()=>{r.current=!0}),x.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Mv({fromRouteId:t},i)))},[e,t])}function Kne(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Zne(e){let{to:t,replace:r,state:n,relative:a}=e;zy()||Ts(!1);let{future:i,static:o}=x.useContext(Fy),{matches:l}=x.useContext(Xd),{pathname:c}=bh(),d=as(),u=$z(t,Iz(l,i.v7_relativeSplatPath),c,a==="path"),f=JSON.stringify(u);return x.useEffect(()=>d(JSON.parse(f),{replace:r,state:n,relative:a}),[d,f,a,r,n]),null}function Bs(e){Ts(!1)}function Xne(e){let{basename:t="/",children:r=null,location:n,navigationType:a=xd.Pop,navigator:i,static:o=!1,future:l}=e;zy()&&Ts(!1);let c=t.replace(/^\/*/,"/"),d=x.useMemo(()=>({basename:c,navigator:i,static:o,future:Mv({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof n=="string"&&(n=fp(n));let{pathname:u="/",search:f="",hash:h="",state:p=null,key:g="default"}=n,v=x.useMemo(()=>{let y=Dz(u,c);return y==null?null:{location:{pathname:y,search:f,hash:h,state:p,key:g},navigationType:a}},[c,u,f,h,p,g,a]);return v==null?null:x.createElement(Fy.Provider,{value:d},x.createElement(Kb.Provider,{children:r,value:v}))}function qz(e){let{children:t,location:r}=e;return $ne(Qk(t),r)}new Promise(()=>{});function Qk(e,t){t===void 0&&(t=[]);let r=[];return x.Children.forEach(e,(n,a)=>{if(!x.isValidElement(n))return;let i=[...t,a];if(n.type===x.Fragment){r.push.apply(r,Qk(n.props.children,i));return}n.type!==Bs&&Ts(!1),!n.props.index||!n.props.children||Ts(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Qk(n.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Jne="6";try{window.__reactRouterVersion=Jne}catch(e){}const Qne="startTransition",MM=_C[Qne];function ese(e){let{basename:t,children:r,future:n,window:a}=e,i=x.useRef();i.current==null&&(i.current=dne({window:a,v5Compat:!0}));let o=i.current,[l,c]=x.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},u=x.useCallback(f=>{d&&MM?MM(()=>c(f)):c(f)},[c,d]);return x.useLayoutEffect(()=>o.listen(u),[o,u]),x.useEffect(()=>Kne(n),[n]),x.createElement(Xne,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}var DM;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(DM||(DM={}));var IM;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(IM||(IM={}));const tse=()=>{const e=bh();return x.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),s.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),s.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},rse="modulepreload",nse=function(e,t){return new URL(e,t).href},$M={},kn=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){const o=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(r.map(d=>{if(d=nse(d,n),d in $M)return;$M[d]=!0;const u=d.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(!!n)for(let g=o.length-1;g>=0;g--){const v=o[g];if(v.href===d&&(!u||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${f}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":rse,u||(p.as="script"),p.crossOrigin="",p.href=d,c&&p.setAttribute("nonce",c),document.head.appendChild(p),u)return new Promise((g,v)=>{p.addEventListener("load",g),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},sse=e=>{let t;return e?t=e:typeof fetch=="undefined"?t=(...r)=>kn(()=>E(void 0,null,function*(){const{default:n}=yield Promise.resolve().then(()=>mp);return{default:n}}),void 0,import.meta.url).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class UP extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class ase extends UP{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class LM extends UP{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class FM extends UP{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var e2;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(e2||(e2={}));var ise=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(f){o(f)}}function c(u){try{d(n.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class ose{constructor(t,{headers:r={},customFetch:n,region:a=e2.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=sse(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return ise(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=r;let l={},{region:c}=r;c||(c=this.region);const d=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let u;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob!="undefined"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData!="undefined"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const f=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),a),body:u}).catch(v=>{throw new ase(v)}),h=f.headers.get("x-relay-error");if(h&&h==="true")throw new LM(f);if(!f.ok)throw new FM(f);let p=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return p==="application/json"?g=yield f.json():p==="application/octet-stream"?g=yield f.blob():p==="text/event-stream"?g=f:p==="multipart/form-data"?g=yield f.formData():g=yield f.text(),{data:g,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof FM||a instanceof LM?a.context:void 0}}})}}var ai={},qP={},Zb={},By={},Xb={},Jb={},lse=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object")},ym=lse();const cse=ym.fetch,Vz=ym.fetch.bind(ym),Wz=ym.Headers,dse=ym.Request,use=ym.Response,mp=Object.freeze(Object.defineProperty({__proto__:null,Headers:Wz,Request:dse,Response:use,default:Vz,fetch:cse},Symbol.toStringTag,{value:"Module"})),hse=MK(mp);var Qb={};Object.defineProperty(Qb,"__esModule",{value:!0});let fse=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Qb.default=fse;var Hz=na&&na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Jb,"__esModule",{value:!0});const mse=Hz(hse),pse=Hz(Qb);let gse=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch=="undefined"?this.fetch=mse.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(i=>E(this,null,function*(){var o,l,c,d;let u=null,f=null,h=null,p=i.status,g=i.statusText;if(i.ok){if(this.method!=="HEAD"){const w=yield i.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?f=w:f=JSON.parse(w))}const y=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),_=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");y&&_&&_.length>1&&(h=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,h=null,p=406,g="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const y=yield i.text();try{u=JSON.parse(y),Array.isArray(u)&&i.status===404&&(f=[],u=null,p=200,g="OK")}catch(_){i.status===404&&y===""?(p=204,g="No Content"):u={message:y}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,p=200,g="OK"),u&&this.shouldThrowOnError)throw new pse.default(u)}return{error:u,data:f,count:h,status:p,statusText:g}}));return this.shouldThrowOnError||(a=a.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};Jb.default=gse;var vse=na&&na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xb,"__esModule",{value:!0});const yse=vse(Jb);let xse=class extends yse.default{select(t){let r=!1;const n=(t!=null?t:"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n=="undefined"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const i=typeof a=="undefined"?"offset":`${a}.offset`,o=typeof a=="undefined"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Xb.default=xse;var _se=na&&na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(By,"__esModule",{value:!0});const wse=_se(Xb);let bse=class extends wse.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};By.default=bse;var jse=na&&na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Zb,"__esModule",{value:!0});const sg=jse(By);let Nse=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let i=!1;const o=(t!=null?t:"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new sg.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var a;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new sg.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:i=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new sg.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:r}={}){var n;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new sg.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new sg.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Zb.default=Nse;var Gz=na&&na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qP,"__esModule",{value:!0});const Sse=Gz(Zb),kse=Gz(By);let Ese=class Yz{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new Sse.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Yz(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){var o;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;n||a?(l=n?"HEAD":"GET",Object.entries(r).filter(([f,h])=>h!==void 0).map(([f,h])=>[f,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([f,h])=>{c.searchParams.append(f,h)})):(l="POST",d=r);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new kse.default({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};qP.default=Ese;var pp=na&&na.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ai,"__esModule",{value:!0});ai.PostgrestError=ai.PostgrestBuilder=ai.PostgrestTransformBuilder=ai.PostgrestFilterBuilder=ai.PostgrestQueryBuilder=ai.PostgrestClient=void 0;const Kz=pp(qP);ai.PostgrestClient=Kz.default;const Zz=pp(Zb);ai.PostgrestQueryBuilder=Zz.default;const Xz=pp(By);ai.PostgrestFilterBuilder=Xz.default;const Jz=pp(Xb);ai.PostgrestTransformBuilder=Jz.default;const Qz=pp(Jb);ai.PostgrestBuilder=Qz.default;const e9=pp(Qb);ai.PostgrestError=e9.default;var Cse=ai.default={PostgrestClient:Kz.default,PostgrestQueryBuilder:Zz.default,PostgrestFilterBuilder:Xz.default,PostgrestTransformBuilder:Jz.default,PostgrestBuilder:Qz.default,PostgrestError:e9.default};const{PostgrestClient:Pse,PostgrestQueryBuilder:wBe,PostgrestFilterBuilder:bBe,PostgrestTransformBuilder:jBe,PostgrestBuilder:NBe,PostgrestError:SBe}=Cse;class Tse{static detectEnvironment(){var t;if(typeof WebSocket!="undefined")return{type:"native",constructor:WebSocket};if(typeof globalThis!="undefined"&&typeof globalThis.WebSocket!="undefined")return{type:"native",constructor:globalThis.WebSocket};if(typeof global!="undefined"&&typeof global.WebSocket!="undefined")return{type:"native",constructor:global.WebSocket};if(typeof globalThis!="undefined"&&typeof globalThis.WebSocketPair!="undefined"&&typeof globalThis.WebSocket=="undefined")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis!="undefined"&&globalThis.EdgeRuntime||typeof navigator!="undefined"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process!="undefined"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket!="undefined"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch(t){return!1}}}const Ase="2.15.5",Rse=`realtime-js/${Ase}`,Ose="1.0.0",t2=1e4,Mse=1e3,Dse=100;var Zg;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Zg||(Zg={}));var Ls;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ls||(Ls={}));var Co;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Co||(Co={}));var r2;(function(e){e.websocket="websocket"})(r2||(r2={}));var wu;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(wu||(wu={}));class Ise{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(t.slice(o,o+a));o=o+a;const c=n.decode(t.slice(o,o+i));o=o+i;const d=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class t9{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Fn;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Fn||(Fn={}));const zM=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,o)=>(i[o]=$se(o,e,t,a),i),{})},$se=(e,t,r,n)=>{const a=t.find(l=>l.name===e),i=a==null?void 0:a.type,o=r[e];return i&&!n.includes(i)?r9(i,o):n2(o)},r9=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Bse(t,r)}switch(e){case Fn.bool:return Lse(t);case Fn.float4:case Fn.float8:case Fn.int2:case Fn.int4:case Fn.int8:case Fn.numeric:case Fn.oid:return Fse(t);case Fn.json:case Fn.jsonb:return zse(t);case Fn.timestamp:return Use(t);case Fn.abstime:case Fn.date:case Fn.daterange:case Fn.int4range:case Fn.int8range:case Fn.money:case Fn.reltime:case Fn.text:case Fn.time:case Fn.timestamptz:case Fn.timetz:case Fn.tsrange:case Fn.tstzrange:return n2(t);default:return n2(t)}},n2=e=>e,Lse=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Fse=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},zse=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Bse=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch(l){i=o?o.split(","):[]}return i.map(l=>r9(t,l))}return e},Use=e=>typeof e=="string"?e.replace(" ","T"):e,n9=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class jN{constructor(t,r,n={},a=t2){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var BM;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(BM||(BM={}));class Xg{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Xg.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=Xg.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Xg.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(i,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const f=i[d];if(f){const h=u.map(y=>y.presence_ref),p=f.map(y=>y.presence_ref),g=u.filter(y=>p.indexOf(y.presence_ref)<0),v=f.filter(y=>h.indexOf(y.presence_ref)<0);g.length>0&&(l[d]=g),v.length>0&&(c[d]=v)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const f=t[l].map(p=>p.presence_ref),h=u.filter(p=>f.indexOf(p.presence_ref)<0);t[l].unshift(...h)}n(l,u,c)}),this.map(o,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),t[l]=d,a(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var UM;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(UM||(UM={}));var Jg;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Jg||(Jg={}));var sc;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(sc||(sc={}));class VP{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Ls.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new jN(this,Co.join,this.params,this.timeout),this.rejoinTimer=new t9(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ls.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ls.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Ls.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ls.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Ls.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Co.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new Xg(this),this.broadcastEndpointURL=n9(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Ls.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[Jg.PRESENCE]&&this.bindings[Jg.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,f={},h={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(p=>t==null?void 0:t(sc.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(sc.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",g=>E(this,[g],function*({postgres_changes:p}){var v;if(this.socket.setAuth(),p===void 0){t==null||t(sc.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,_=(v=y==null?void 0:y.length)!==null&&v!==void 0?v:0,w=[];for(let b=0;b<_;b++){const N=y[b],{filter:{event:S,schema:k,table:P,filter:A}}=N,R=p&&p[b];if(R&&R.event===S&&R.schema===k&&R.table===P&&R.filter===A)w.push(Object.assign(Object.assign({},N),{id:R.id}));else{this.unsubscribe(),this.state=Ls.errored,t==null||t(sc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(sc.SUBSCRIBED);return}})).receive("error",p=>{this.state=Ls.errored,t==null||t(sc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(sc.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(n){return E(this,arguments,function*(t,r={}){return yield this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)})}untrack(){return E(this,arguments,function*(t={}){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,r,n){return this.state===Ls.joined&&t===Jg.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}send(n){return E(this,arguments,function*(t,r={}){var a,i;if(!this._canPush()&&t.type==="broadcast"){const{event:o,payload:l}=t,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:l,private:this.private}]})};try{const u=yield this._fetchWithTimeout(this.broadcastEndpointURL,d,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return yield(i=u.body)===null||i===void 0?void 0:i.cancel(),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var l,c,d;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&o("ok"),u.receive("ok",()=>o("ok")),u.receive("error",()=>o("error")),u.receive("timeout",()=>o("timed out"))})})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ls.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Co.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new jN(this,Co.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ls.closed,this.bindings={}}_fetchWithTimeout(t,r,n){return E(this,null,function*(){const a=new AbortController,i=setTimeout(()=>a.abort(),n),o=yield this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),o})}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new jN(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Dse){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=Co;if(n&&[l,c,d,u].indexOf(o)>=0&&n!==this._joinRef())return;let h=this._onMessage(o,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(p=>{var g,v,y;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((y=(v=p.filter)===null||v===void 0?void 0:v.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(p=>p.callback(h,n)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var g,v,y,_,w,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const N=p.id,S=(g=p.filter)===null||g===void 0?void 0:g.event;return N&&((v=r.ids)===null||v===void 0?void 0:v.includes(N))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const N=(w=(_=p==null?void 0:p.filter)===null||_===void 0?void 0:_.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return N==="*"||N===((b=r==null?void 0:r.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:v,table:y,commit_timestamp:_,type:w,errors:b}=g;h=Object.assign(Object.assign({},{schema:v,table:y,commit_timestamp:_,eventType:w,new:{},old:{},errors:b}),this._getPayloadRecords(g))}p.callback(h,n)})}_isClosed(){return this.state===Ls.closed}_isJoined(){return this.state===Ls.joined}_isJoining(){return this.state===Ls.joining}_isLeaving(){return this.state===Ls.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&VP.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Co.close,{},t)}_onError(t){this._on(Co.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ls.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=zM(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=zM(t.columns,t.old_record)),r}}const NN=()=>{},u0={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},qse=[1e3,2e3,5e3,1e4],Vse=1e4,Wse=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Hse{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=t2,this.transport=null,this.heartbeatIntervalMs=u0.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=NN,this.ref=0,this.reconnectTimer=null,this.logger=NN,this.conn=null,this.sendBuffer=[],this.serializer=new Ise,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch=="undefined"?i=(...o)=>kn(()=>E(this,null,function*(){const{default:l}=yield Promise.resolve().then(()=>mp);return{default:l}}),void 0,import.meta.url).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${r2.websocket}`,this.httpEndpoint=n9(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Tse.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ose}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r!=null?r:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}removeChannel(t){return E(this,null,function*(){const r=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),r})}removeAllChannels(){return E(this,null,function*(){const t=yield Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t})}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Zg.connecting:return wu.Connecting;case Zg.open:return wu.Open;case Zg.closing:return wu.Closing;default:return wu.Closed}}isConnected(){return this.connectionState()===wu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new VP(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(t=null){return E(this,null,function*(){this._authPromise=this._performAuth(t);try{yield this._authPromise}finally{this._authPromise=null}})}sendHeartbeat(){return E(this,null,function*(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Mse,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},u0.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")})}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:i,ref:o}=r,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${n} ${a} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(a,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Co.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Wse],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}_performAuth(t=null){return E(this,null,function*(){let r;t?r=t:this.accessToken?r=yield this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:Rse};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Co.access_token,{access_token:r})}))})}_waitForAuthIfNeeded(){return E(this,null,function*(){this._authPromise&&(yield this._authPromise)})}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new t9(()=>E(this,null,function*(){setTimeout(()=>E(this,null,function*(){yield this._waitForAuthIfNeeded(),this.isConnected()||this.connect()}),u0.RECONNECT_DELAY)}),this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,i,o,l,c,d,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:t2,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:u0.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:NN,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:f=>qse[f-1]||Vse,this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(f,h)=>h(JSON.stringify(f)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window!="undefined"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class WP extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Fs(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Gse extends WP{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class s2 extends WP{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Yse=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(f){o(f)}}function c(u){try{d(n.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const s9=e=>{let t;return e?t=e:typeof fetch=="undefined"?t=(...r)=>kn(()=>E(void 0,null,function*(){const{default:n}=yield Promise.resolve().then(()=>mp);return{default:n}}),void 0,import.meta.url).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Kse=()=>Yse(void 0,void 0,void 0,function*(){return typeof Response=="undefined"?(yield kn(()=>Promise.resolve().then(()=>mp),void 0,import.meta.url)).Response:Response}),a2=e=>{if(Array.isArray(e))return e.map(r=>a2(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=a2(n)}),t},Zse=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var jh=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(f){o(f)}}function c(u){try{d(n.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const SN=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Xse=(e,t,r)=>jh(void 0,void 0,void 0,function*(){const n=yield Kse();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const i=e.status||500,o=(a==null?void 0:a.statusCode)||i+"";t(new Gse(SN(a),i,o))}).catch(a=>{t(new s2(SN(a),a))}):t(new s2(SN(e),e))}),Jse=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(Zse(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function Uy(e,t,r,n,a,i){return jh(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,Jse(t,n,a,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Xse(c,l,n))})})}function G_(e,t,r,n){return jh(this,void 0,void 0,function*(){return Uy(e,"GET",t,r,n)})}function il(e,t,r,n,a){return jh(this,void 0,void 0,function*(){return Uy(e,"POST",t,n,a,r)})}function i2(e,t,r,n,a){return jh(this,void 0,void 0,function*(){return Uy(e,"PUT",t,n,a,r)})}function Qse(e,t,r,n){return jh(this,void 0,void 0,function*(){return Uy(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function a9(e,t,r,n,a){return jh(this,void 0,void 0,function*(){return Uy(e,"DELETE",t,n,a,r)})}var $a=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(f){o(f)}}function c(u){try{d(n.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const eae={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},qM={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class tae{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=s9(a)}uploadOrUpdate(t,r,n,a){return $a(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},qM),a);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob!="undefined"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData!="undefined"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),f=yield(t=="PUT"?i2:il)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(i){if(Fs(i))return{data:null,error:i};throw i}})}upload(t,r,n){return $a(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return $a(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:qM.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob!="undefined"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData!="undefined"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const f=yield i2(this.fetch,l.toString(),c,{headers:u});return{data:{path:i,fullPath:f.Key},error:null}}catch(c){if(Fs(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return $a(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield il(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new WP("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(Fs(n))return{data:null,error:n};throw n}})}update(t,r,n){return $a(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return $a(this,void 0,void 0,function*(){try{return{data:yield il(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Fs(a))return{data:null,error:a};throw a}})}copy(t,r,n){return $a(this,void 0,void 0,function*(){try{return{data:{path:(yield il(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Fs(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return $a(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield il(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(Fs(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return $a(this,void 0,void 0,function*(){try{const a=yield il(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(Fs(a))return{data:null,error:a};throw a}})}download(t,r){return $a(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)!="undefined"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield G_(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Fs(l))return{data:null,error:l};throw l}})}info(t){return $a(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield G_(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:a2(n),error:null}}catch(n){if(Fs(n))return{data:null,error:n};throw n}})}exists(t){return $a(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Qse(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Fs(n)&&n instanceof s2){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const l=typeof(r==null?void 0:r.transform)!="undefined"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&a.push(c);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(t){return $a(this,void 0,void 0,function*(){try{return{data:yield a9(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Fs(r))return{data:null,error:r};throw r}})}list(t,r,n){return $a(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},eae),r),{prefix:t||""});return{data:yield il(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Fs(a))return{data:null,error:a};throw a}})}listV2(t,r){return $a(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield il(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Fs(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer!="undefined"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const rae="2.11.0",nae={"X-Client-Info":`storage-js/${rae}`};var Vh=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(f){o(f)}}function c(u){try{d(n.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class sae{constructor(t,r={},n,a){const i=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},nae),r),this.fetch=s9(n)}listBuckets(){return Vh(this,void 0,void 0,function*(){try{return{data:yield G_(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Fs(t))return{data:null,error:t};throw t}})}getBucket(t){return Vh(this,void 0,void 0,function*(){try{return{data:yield G_(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Fs(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Vh(this,void 0,void 0,function*(){try{return{data:yield il(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Fs(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Vh(this,void 0,void 0,function*(){try{return{data:yield i2(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Fs(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Vh(this,void 0,void 0,function*(){try{return{data:yield il(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Fs(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Vh(this,void 0,void 0,function*(){try{return{data:yield a9(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Fs(r))return{data:null,error:r};throw r}})}}class aae extends sae{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new tae(this.url,this.headers,t,this.fetch)}}const iae="2.57.2";let Mg="";typeof Deno!="undefined"?Mg="deno":typeof document!="undefined"?Mg="web":typeof navigator!="undefined"&&navigator.product==="ReactNative"?Mg="react-native":Mg="node";const oae={"X-Client-Info":`supabase-js-${Mg}/${iae}`},lae={headers:oae},cae={schema:"public"},dae={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},uae={};var hae=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(f){o(f)}}function c(u){try{d(n.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const fae=e=>{let t;return e?t=e:typeof fetch=="undefined"?t=Vz:t=fetch,(...r)=>t(...r)},mae=()=>typeof Headers=="undefined"?Wz:Headers,pae=(e,t,r)=>{const n=fae(r),a=mae();return(i,o)=>hae(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let d=new a(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},o),{headers:d}))})};var gae=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(f){o(f)}}function c(u){try{d(n.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};function vae(e){return e.endsWith("/")?e:e+"/"}function yae(e,t){var r,n;const{db:a,auth:i,realtime:o,global:l}=e,{db:c,auth:d,realtime:u,global:f}=t,h={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>gae(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const i9="2.71.1",cf=30*1e3,o2=3,kN=o2*cf,xae="http://localhost:9999",_ae="supabase.auth.token",wae={"X-Client-Info":`gotrue-js/${i9}`},l2="X-Supabase-Api-Version",o9={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},bae=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,jae=10*60*1e3;class HP extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Dr(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Nae extends HP{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Sae(e){return Dr(e)&&e.name==="AuthApiError"}class l9 extends HP{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Jd extends HP{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class td extends Jd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function kae(e){return Dr(e)&&e.name==="AuthSessionMissingError"}class h0 extends Jd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class f0 extends Jd{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class m0 extends Jd{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Eae(e){return Dr(e)&&e.name==="AuthImplicitGrantRedirectError"}class VM extends Jd{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class c2 extends Jd{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function EN(e){return Dr(e)&&e.name==="AuthRetryableFetchError"}class WM extends Jd{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class d2 extends Jd{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Y_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),HM=` 	
\r=`.split(""),Cae=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<HM.length;t+=1)e[HM[t].charCodeAt(0)]=-2;for(let t=0;t<Y_.length;t+=1)e[Y_[t].charCodeAt(0)]=t;return e})();function GM(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Y_[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Y_[n]),t.queuedBits-=6}}function c9(e,t,r){const n=Cae[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function YM(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{Aae(o,n,r)};for(let o=0;o<e.length;o+=1)c9(e.charCodeAt(o),a,i);return t.join("")}function Pae(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Tae(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}Pae(n,t)}}function Aae(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Rae(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)c9(e.charCodeAt(a),r,n);return new Uint8Array(t)}function Oae(e){const t=[];return Tae(e,r=>t.push(r)),new Uint8Array(t)}function Mae(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>GM(a,r,n)),GM(null,r,n),t.join("")}function Dae(e){return Math.round(Date.now()/1e3)+e}function Iae(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const _o=()=>typeof window!="undefined"&&typeof document!="undefined",cu={tested:!1,writable:!1},d9=()=>{if(!_o())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch(t){return!1}if(cu.tested)return cu.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),cu.tested=!0,cu.writable=!0}catch(t){cu.tested=!0,cu.writable=!1}return cu.writable};function $ae(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch(n){}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const u9=e=>{let t;return e?t=e:typeof fetch=="undefined"?t=(...r)=>kn(()=>E(void 0,null,function*(){const{default:n}=yield Promise.resolve().then(()=>mp);return{default:n}}),void 0,import.meta.url).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Lae=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",df=(e,t,r)=>E(void 0,null,function*(){yield e.setItem(t,JSON.stringify(r))}),du=(e,t)=>E(void 0,null,function*(){const r=yield e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(n){return r}}),Jc=(e,t)=>E(void 0,null,function*(){yield e.removeItem(t)});class e1{constructor(){this.promise=new e1.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}e1.promiseConstructor=Promise;function CN(e){const t=e.split(".");if(t.length!==3)throw new d2("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!bae.test(t[n]))throw new d2("JWT not in base64url format");return{header:JSON.parse(YM(t[0])),payload:JSON.parse(YM(t[1])),signature:Rae(t[2]),raw:{header:t[0],payload:t[1]}}}function Fae(e){return E(this,null,function*(){return yield new Promise(t=>{setTimeout(()=>t(null),e)})})}function zae(e,t){return new Promise((n,a)=>{E(this,null,function*(){for(let i=0;i<1/0;i++)try{const o=yield e(i);if(!t(i,null,o)){n(o);return}}catch(o){if(!t(i,o)){a(o);return}}})})}function Bae(e){return("0"+e.toString(16)).substr(-2)}function Uae(){const t=new Uint32Array(56);if(typeof crypto=="undefined"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,Bae).join("")}function qae(e){return E(this,null,function*(){const r=new TextEncoder().encode(e),n=yield crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")})}function Vae(e){return E(this,null,function*(){if(!(typeof crypto!="undefined"&&typeof crypto.subtle!="undefined"&&typeof TextEncoder!="undefined"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=yield qae(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}function Wh(e,t,r=!1){return E(this,null,function*(){const n=Uae();let a=n;r&&(a+="/PASSWORD_RECOVERY"),yield df(e,`${t}-code-verifier`,a);const i=yield Vae(n);return[i,n===i?"plain":"s256"]})}const Wae=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Hae(e){const t=e.headers.get(l2);if(!t||!t.match(Wae))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(r){return null}}function Gae(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Yae(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Kae=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Hh(e){if(!Kae.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function PN(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function KM(e){return JSON.parse(JSON.stringify(e))}var Zae=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const gu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Xae=[502,503,504];function ZM(e){return E(this,null,function*(){var t;if(!Lae(e))throw new c2(gu(e),0);if(Xae.includes(e.status))throw new c2(gu(e),e.status);let r;try{r=yield e.json()}catch(i){throw new l9(gu(i),i)}let n;const a=Hae(e);if(a&&a.getTime()>=o9["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new WM(gu(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new td}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new WM(gu(r),e.status,r.weak_password.reasons);throw new Nae(gu(r),e.status||500,n)})}const Jae=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};function nn(e,t,r,n){return E(this,null,function*(){var a;const i=Object.assign({},n==null?void 0:n.headers);i[l2]||(i[l2]=o9["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=yield Qae(e,t,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}})}function Qae(e,t,r,n,a,i){return E(this,null,function*(){const o=Jae(t,n,a,i);let l;try{l=yield e(r,Object.assign({},o))}catch(c){throw console.error(c),new c2(gu(c),0)}if(l.ok||(yield ZM(l)),n!=null&&n.noResolveJson)return l;try{return yield l.json()}catch(c){yield ZM(c)}})}function ec(e){var t;let r=null;nie(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Dae(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function XM(e){const t=ec(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function cd(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function eie(e){return{data:e,error:null}}function tie(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,o=Zae(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function rie(e){return e}function nie(e){return e.access_token&&e.refresh_token&&e.expires_in}const TN=["global","local","others"];var sie=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class aie{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=u9(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(n){return E(this,arguments,function*(t,r=TN[0]){if(TN.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${TN.join(", ")}`);try{return yield nn(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Dr(a))return{data:null,error:a};throw a}})}inviteUserByEmail(n){return E(this,arguments,function*(t,r={}){try{return yield nn(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:cd})}catch(a){if(Dr(a))return{data:{user:null},error:a};throw a}})}generateLink(t){return E(this,null,function*(){try{const{options:r}=t,n=sie(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),yield nn(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:tie,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Dr(r))return{data:{properties:null,user:null},error:r};throw r}})}createUser(t){return E(this,null,function*(){try{return yield nn(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:cd})}catch(r){if(Dr(r))return{data:{user:null},error:r};throw r}})}listUsers(t){return E(this,null,function*(){var r,n,a,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=yield nn(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:rie});if(u.error)throw u.error;const f=yield u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const v=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(g.split(";")[1].split("=")[1]);d[`${y}Page`]=v}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Dr(d))return{data:{users:[]},error:d};throw d}})}getUserById(t){return E(this,null,function*(){Hh(t);try{return yield nn(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:cd})}catch(r){if(Dr(r))return{data:{user:null},error:r};throw r}})}updateUserById(t,r){return E(this,null,function*(){Hh(t);try{return yield nn(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:cd})}catch(n){if(Dr(n))return{data:{user:null},error:n};throw n}})}deleteUser(t,r=!1){return E(this,null,function*(){Hh(t);try{return yield nn(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:cd})}catch(n){if(Dr(n))return{data:{user:null},error:n};throw n}})}_listFactors(t){return E(this,null,function*(){Hh(t.userId);try{const{data:r,error:n}=yield nn(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Dr(r))return{data:null,error:r};throw r}})}_deleteFactor(t){return E(this,null,function*(){Hh(t.userId),Hh(t.id);try{return{data:yield nn(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Dr(r))return{data:null,error:r};throw r}})}}function JM(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function iie(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){typeof self!="undefined"&&(self.globalThis=self)}}const Gh={debug:!!(globalThis&&d9()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class h9 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class oie extends h9{}function lie(e,t,r){return E(this,null,function*(){Gh.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Gh.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},a=>E(this,null,function*(){if(a){Gh.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return yield r()}finally{Gh.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Gh.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new oie(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Gh.debug)try{const i=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield r()}})))})}iie();const cie={url:xae,storageKey:_ae,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:wae,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};function QM(e,t,r){return E(this,null,function*(){return yield r()})}const Yh={};class Dv{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Dv.nextInstanceID,Dv.nextInstanceID+=1,this.instanceID>0&&_o()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},cie),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new aie({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=u9(a.fetch),this.lock=a.lock||QM,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:_o()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=lie:this.lock=QM,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:d9()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=JM(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=JM(this.memoryStorage)),_o()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",i=>E(this,null,function*(){this._debug("received broadcast notification from other tab or client",i),yield this._notifyAllSubscribers(i.data.event,i.data.session,!1)}))}this.initialize()}get jwks(){var t,r;return(r=(t=Yh[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Yh[this.storageKey]=Object.assign(Object.assign({},Yh[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Yh[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Yh[this.storageKey]=Object.assign(Object.assign({},Yh[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${i9}) ${new Date().toISOString()}`,...t),this}initialize(){return E(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=E(this,null,function*(){return yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._initialize()}))}),yield this.initializePromise)})}_initialize(){return E(this,null,function*(){var t;try{const r=$ae(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":(yield this._isPKCECallback(r))&&(n="pkce"),_o()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=yield this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Eae(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return yield this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),yield this._saveSession(o),setTimeout(()=>E(this,null,function*(){l==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",o):yield this._notifyAllSubscribers("SIGNED_IN",o)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(r){return Dr(r)?{error:r}:{error:new l9("Unexpected error during initialization",r)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(t){return E(this,null,function*(){var r,n,a;try{const i=yield nn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:ec}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Dr(i))return{data:{user:null,session:null},error:i};throw i}})}signUp(t){return E(this,null,function*(){var r,n,a;try{let i;if("email"in t){const{email:u,password:f,options:h}=t;let p=null,g=null;this.flowType==="pkce"&&([p,g]=yield Wh(this.storage,this.storageKey)),i=yield nn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:g},xform:ec})}else if("phone"in t){const{phone:u,password:f,options:h}=t;i=yield nn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ec})}else throw new f0("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Dr(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithPassword(t){return E(this,null,function*(){try{let r;if("email"in t){const{email:i,password:o,options:l}=t;r=yield nn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:XM})}else if("phone"in t){const{phone:i,password:o,options:l}=t;r=yield nn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:XM})}else throw new f0("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new h0}:(n.session&&(yield this._saveSession(n.session),yield this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Dr(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOAuth(t){return E(this,null,function*(){var r,n,a,i;return yield this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})})}exchangeCodeForSession(t){return E(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>E(this,null,function*(){return this._exchangeCodeForSession(t)}))})}signInWithWeb3(t){return E(this,null,function*(){const{chain:r}=t;if(r==="solana")return yield this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)})}signInWithSolana(t){return E(this,null,function*(){var r,n,a,i,o,l,c,d,u,f,h,p;let g,v;if("message"in t)g=t.message,v=t.signature;else{const{chain:y,wallet:_,statement:w,options:b}=t;let N;if(_o())if(typeof _=="object")N=_;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))N=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=_}const S=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in N&&N.signIn){const k=yield N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),w?{statement:w}:null));let P;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")P=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)P=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)g=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),v=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${S.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(a=(n=b==null?void 0:b.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((f=(u=b==null?void 0:b.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...b.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const k=yield N.signMessage(new TextEncoder().encode(g),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=k}}try{const{data:y,error:_}=yield nn(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Mae(v)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:ec});if(_)throw _;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new h0}:(y.session&&(yield this._saveSession(y.session),yield this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:_})}catch(y){if(Dr(y))return{data:{user:null,session:null},error:y};throw y}})}_exchangeCodeForSession(t){return E(this,null,function*(){const r=yield du(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r!=null?r:"").split("/");try{const{data:i,error:o}=yield nn(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:ec});if(yield Jc(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new h0}:(i.session&&(yield this._saveSession(i.session),yield this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a!=null?a:null}),error:o})}catch(i){if(Dr(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}})}signInWithIdToken(t){return E(this,null,function*(){try{const{options:r,provider:n,token:a,access_token:i,nonce:o}=t,l=yield nn(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ec}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new h0}:(c.session&&(yield this._saveSession(c.session),yield this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(Dr(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOtp(t){return E(this,null,function*(){var r,n,a,i,o;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=yield Wh(this.storage,this.storageKey));const{error:f}=yield nn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=yield nn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new f0("You must provide either an email or phone number.")}catch(l){if(Dr(l))return{data:{user:null,session:null},error:l};throw l}})}verifyOtp(t){return E(this,null,function*(){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=yield nn(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:ec});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(yield this._saveSession(c),yield this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Dr(a))return{data:{user:null,session:null},error:a};throw a}})}signInWithSSO(t){return E(this,null,function*(){var r,n,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=yield Wh(this.storage,this.storageKey)),yield nn(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:eie})}catch(i){if(Dr(i))return{data:null,error:i};throw i}})}reauthenticate(){return E(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return E(this,null,function*(){try{return yield this._useSession(t=>E(this,null,function*(){const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new td;const{error:a}=yield nn(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}}))}catch(t){if(Dr(t))return{data:{user:null,session:null},error:t};throw t}})}resend(t){return E(this,null,function*(){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:o}=yield nn(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:o,error:l}=yield nn(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new f0("You must provide either an email or phone number and a type")}catch(r){if(Dr(r))return{data:{user:null,session:null},error:r};throw r}})}getSession(){return E(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return this._useSession(r=>E(this,null,function*(){return r}))}))})}_acquireLock(t,r){return E(this,null,function*(){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=E(this,null,function*(){return yield n,yield r()});return this.pendingInLock.push(E(this,null,function*(){try{yield a}catch(i){}})),a}return yield this.lock(`lock:${this.storageKey}`,t,()=>E(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push(E(this,null,function*(){try{yield n}catch(a){}})),yield n;this.pendingInLock.length;){const a=[...this.pendingInLock];yield Promise.all(a),this.pendingInLock.splice(0,a.length)}return yield n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(t){return E(this,null,function*(){this._debug("#_useSession","begin");try{const r=yield this.__loadSession();return yield t(r)}finally{this._debug("#_useSession","end")}})}__loadSession(){return E(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=yield du(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<kN:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=yield du(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=PN()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{session:a,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(t){return E(this,null,function*(){return t?yield this._getUser(t):(yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._getUser()})))})}_getUser(t){return E(this,null,function*(){try{return t?yield nn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:cd}):yield this._useSession(r=>E(this,null,function*(){var n,a,i;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new td}:yield nn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:cd})}))}catch(r){if(Dr(r))return kae(r)&&(yield this._removeSession(),yield Jc(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}})}updateUser(n){return E(this,arguments,function*(t,r={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._updateUser(t,r)}))})}_updateUser(n){return E(this,arguments,function*(t,r={}){try{return yield this._useSession(a=>E(this,null,function*(){const{data:i,error:o}=a;if(o)throw o;if(!i.session)throw new td;const l=i.session;let c=null,d=null;this.flowType==="pkce"&&t.email!=null&&([c,d]=yield Wh(this.storage,this.storageKey));const{data:u,error:f}=yield nn(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:cd});if(f)throw f;return l.user=u.user,yield this._saveSession(l),yield this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}}))}catch(a){if(Dr(a))return{data:{user:null},error:a};throw a}})}setSession(t){return E(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._setSession(t)}))})}_setSession(t){return E(this,null,function*(){try{if(!t.access_token||!t.refresh_token)throw new td;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:o}=CN(t.access_token);if(o.exp&&(n=o.exp,a=n<=r),a){const{session:l,error:c}=yield this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=yield this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},yield this._saveSession(i),yield this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Dr(r))return{data:{session:null,user:null},error:r};throw r}})}refreshSession(t){return E(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._refreshSession(t)}))})}_refreshSession(t){return E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new td;const{session:a,error:i}=yield this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}}))}catch(r){if(Dr(r))return{data:{user:null,session:null},error:r};throw r}})}_getSessionFromURL(t,r){return E(this,null,function*(){try{if(!_o())throw new m0("No browser detected.");if(t.error||t.error_description||t.error_code)throw new m0(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new VM("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new m0("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new VM("No code detected.");const{data:w,error:b}=yield this._exchangeCodeForSession(t.code);if(b)throw b;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=t;if(!i||!l||!o||!d)throw new m0("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(l);let h=u+f;c&&(h=parseInt(c));const p=h-u;p*1e3<=cf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${f}s`);const g=h-f;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,u);const{data:v,error:y}=yield this._getUser(i);if(y)throw y;const _={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:h,refresh_token:o,token_type:d,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:_,redirectType:t.type},error:null}}catch(n){if(Dr(n))return{data:{session:null,redirectType:null},error:n};throw n}})}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}_isPKCECallback(t){return E(this,null,function*(){const r=yield du(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)})}signOut(){return E(this,arguments,function*(t={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._signOut(t)}))})}_signOut(){return E(this,arguments,function*({scope:t}={scope:"global"}){return yield this._useSession(r=>E(this,null,function*(){var n;const{data:a,error:i}=r;if(i)return{error:i};const o=(n=a.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=yield this.admin.signOut(o,t);if(l&&!(Sae(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(yield this._removeSession(),yield Jc(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))})}onAuthStateChange(t){const r=Iae(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),E(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){this._emitInitialSession(r)}))}),{data:{subscription:n}}}_emitInitialSession(t){return E(this,null,function*(){return yield this._useSession(r=>E(this,null,function*(){var n,a;try{const{data:{session:i},error:o}=r;if(o)throw o;yield(n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){yield(a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}}))})}resetPasswordForEmail(n){return E(this,arguments,function*(t,r={}){let a=null,i=null;this.flowType==="pkce"&&([a,i]=yield Wh(this.storage,this.storageKey,!0));try{return yield nn(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(Dr(o))return{data:null,error:o};throw o}})}getUserIdentities(){return E(this,null,function*(){var t;try{const{data:r,error:n}=yield this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Dr(r))return{data:null,error:r};throw r}})}linkIdentity(t){return E(this,null,function*(){var r;try{const{data:n,error:a}=yield this._useSession(i=>E(this,null,function*(){var o,l,c,d,u;const{data:f,error:h}=i;if(h)throw h;const p=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return yield nn(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})}));if(a)throw a;return _o()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Dr(n))return{data:{provider:t.provider,url:null},error:n};throw n}})}unlinkIdentity(t){return E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n,a;const{data:i,error:o}=r;if(o)throw o;return yield nn(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})}))}catch(r){if(Dr(r))return{data:null,error:r};throw r}})}_refreshAccessToken(t){return E(this,null,function*(){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return yield zae(a=>E(this,null,function*(){return a>0&&(yield Fae(200*Math.pow(2,a-1))),this._debug(r,"refreshing attempt",a),yield nn(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ec})}),(a,i)=>{const o=200*Math.pow(2,a);return i&&EN(i)&&Date.now()+o-n<cf})}catch(n){if(this._debug(r,"error",n),Dr(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}})}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}_handleProviderSignIn(t,r){return E(this,null,function*(){const n=yield this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),_o()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}})}_recoverAndRefresh(){return E(this,null,function*(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=yield du(this.storage,this.storageKey);if(a&&this.userStorage){let o=yield du(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},yield df(this.userStorage,this.storageKey+"-user",o)),a.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:PN()}else if(a&&!a.user&&!a.user){const o=yield du(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,yield Jc(this.storage,this.storageKey+"-user"),yield df(this.storage,this.storageKey,a)):a.user=PN()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&(yield this._removeSession());return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<kN;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${kN}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=yield this._callRefreshToken(a.refresh_token);o&&(console.error(o),EN(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),yield this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=yield this._getUser(a.access_token);!l&&(o!=null&&o.user)?(a.user=o.user,yield this._saveSession(a),yield this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else yield this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}})}_callRefreshToken(t){return E(this,null,function*(){var r,n;if(!t)throw new td;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new e1;const{data:i,error:o}=yield this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new td;yield this._saveSession(i.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),Dr(i)){const o={session:null,error:i};return EN(i)||(yield this._removeSession()),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}})}_notifyAllSubscribers(t,r,n=!0){return E(this,null,function*(){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(l=>E(this,null,function*(){try{yield l.callback(t,r)}catch(c){i.push(c)}}));if(yield Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}})}_saveSession(t){return E(this,null,function*(){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&(yield df(this.userStorage,this.storageKey+"-user",{user:r.user}));const a=Object.assign({},r);delete a.user;const i=KM(a);yield df(this.storage,this.storageKey,i)}else{const a=KM(r);yield df(this.storage,this.storageKey,a)}})}_removeSession(){return E(this,null,function*(){this._debug("#_removeSession()"),yield Jc(this.storage,this.storageKey),yield Jc(this.storage,this.storageKey+"-code-verifier"),yield Jc(this.storage,this.storageKey+"-user"),this.userStorage&&(yield Jc(this.userStorage,this.storageKey+"-user")),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&_o()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}_startAutoRefresh(){return E(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),cf);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno!="undefined"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(()=>E(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return E(this,null,function*(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)})}startAutoRefresh(){return E(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return E(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return E(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>E(this,null,function*(){try{const t=Date.now();try{return yield this._useSession(r=>E(this,null,function*(){const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/cf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${cf}ms, refresh threshold is ${o2} ticks`),a<=o2&&(yield this._callRefreshToken(n.refresh_token))}))}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(t){if(t.isAcquireTimeout||t instanceof h9)this._debug("auto refresh token tick lock not available");else throw t}})}_handleVisibilityChange(){return E(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!_o()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>E(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})}_onVisibilityChanged(t){return E(this,null,function*(){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(t,r,n){return E(this,null,function*(){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=yield Wh(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`})}_unenroll(t){return E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n;const{data:a,error:i}=r;return i?{data:null,error:i}:yield nn(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})}))}catch(r){if(Dr(r))return{data:null,error:r};throw r}})}_enroll(t){return E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n,a;const{data:i,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:d}=yield nn(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})}))}catch(r){if(Dr(r))return{data:null,error:r};throw r}})}_verify(t){return E(this,null,function*(){return this._acquireLock(-1,()=>E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:l}=yield nn(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})}))}catch(r){if(Dr(r))return{data:null,error:r};throw r}}))})}_challenge(t){return E(this,null,function*(){return this._acquireLock(-1,()=>E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n;const{data:a,error:i}=r;return i?{data:null,error:i}:yield nn(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})}))}catch(r){if(Dr(r))return{data:null,error:r};throw r}}))})}_challengeAndVerify(t){return E(this,null,function*(){const{data:r,error:n}=yield this._challenge({factorId:t.factorId});return n?{data:null,error:n}:yield this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})})}_listFactors(){return E(this,null,function*(){const{data:{user:t},error:r}=yield this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:a,phone:i},error:null}})}_getAuthenticatorAssuranceLevel(){return E(this,null,function*(){return this._acquireLock(-1,()=>E(this,null,function*(){return yield this._useSession(t=>E(this,null,function*(){var r,n;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=CN(a.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}))})}fetchJwk(n){return E(this,arguments,function*(t,r={keys:[]}){let a=r.keys.find(c=>c.kid===t);if(a)return a;const i=Date.now();if(a=this.jwks.keys.find(c=>c.kid===t),a&&this.jwks_cached_at+jae>i)return a;const{data:o,error:l}=yield nn(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=i,a=o.keys.find(c=>c.kid===t),!a)?null:a})}getClaims(n){return E(this,arguments,function*(t,r={}){try{let a=t;if(!a){const{data:g,error:v}=yield this.getSession();if(v||!g.session)return{data:null,error:v};a=g.session.access_token}const{header:i,payload:o,signature:l,raw:{header:c,payload:d}}=CN(a);r!=null&&r.allowExpired||Gae(o.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:yield this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:g}=yield this.getUser(a);if(g)throw g;return{data:{claims:o,header:i,signature:l},error:null}}const f=Yae(i.alg),h=yield crypto.subtle.importKey("jwk",u,f,!0,["verify"]);if(!(yield crypto.subtle.verify(f,h,l,Oae(`${c}.${d}`))))throw new d2("Invalid JWT signature");return{data:{claims:o,header:i,signature:l},error:null}}catch(a){if(Dr(a))return{data:null,error:a};throw a}})}}Dv.nextInstanceID=0;const die=Dv;class uie extends die{constructor(t){super(t)}}var hie=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(f){o(f)}}function c(u){try{d(n.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class fie{constructor(t,r,n){var a,i,o;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=vae(t),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:cae,realtime:uae,auth:Object.assign(Object.assign({},dae),{storageKey:d}),global:lae},f=yae(n!=null?n:{},u);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=f.auth)!==null&&o!==void 0?o:{},this.headers,f.global.fetch),this.fetch=pae(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new Pse(new URL("rest/v1",c).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new aae(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new ose(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return hie(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,storageKey:o,flowType:l,lock:c,debug:d},u,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new uie({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,flowType:l,lock:c,debug:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Hse(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const mie=(e,t,r)=>new fie(e,t,r);function pie(){if(typeof window!="undefined"||typeof process=="undefined")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}pie()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const gie="https://glpiolbrafqikqhnseto.supabase.co",vie="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdscGlvbGJyYWZxaWtxaG5zZXRvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5Mzc4MjQsImV4cCI6MjA3MjUxMzgyNH0.O5G3fW-YFtpACNqNfo_lsLK44F-3L3p69Ka-G2lSTLE",T=mie(gie,vie),yie=Object.freeze(Object.defineProperty({__proto__:null,supabase:T},Symbol.toStringTag,{value:"Module"})),e5=["view","click","like","share","interest","search","review","comment","navigate","form_submit","profile_update","swipe","follow","unfollow","attendance","ticket_click","streaming_top","streaming_recent"],t5=["event","artist","venue","review","user","profile","view","form","ticket_link","song","album","playlist","genre","scene","search"];class xie{constructor(){Cr(this,"sessionId");Cr(this,"eventQueue",[]);Cr(this,"batchTimeout",null);Cr(this,"BATCH_SIZE",10);Cr(this,"BATCH_DELAY",2e3);Cr(this,"sessionStartTime");Cr(this,"sessionInteractions",0);Cr(this,"sessionPageViews",0);Cr(this,"UUID_REGEX",/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i);this.sessionId=this.generateSessionId(),this.sessionStartTime=new Date}generateSessionId(){return crypto.randomUUID()}isValidUuid(t){return typeof t=="string"&&this.UUID_REGEX.test(t)}normalizeInteractionEvent(t){return t.entityId&&this.isValidUuid(t.entityId)&&!t.entityUuid?H(M({},t),{entityUuid:t.entityId}):t}validateInteractionData(t){const r=[],n=[];if(t.eventType?e5.includes(t.eventType)||r.push(`Invalid eventType: ${t.eventType}. Must be one of: ${e5.join(", ")}`):r.push("eventType is required"),t.entityType?t5.includes(t.entityType)||r.push(`Invalid entityType: ${t.entityType}. Must be one of: ${t5.join(", ")}`):r.push("entityType is required"),!["search","view","form","ticket_link","song","album","playlist","genre","scene"].includes(t.entityType)?!t.entityUuid&&!t.entityId&&r.push(`entityUuid or entityId is required for entityType: ${t.entityType}`):t.entityId||n.push(`No entity identifier provided for entityType: ${t.entityType}. Consider providing entityId for better tracking.`),t.metadata){const o=this.validateMetadata(t.entityType,t.metadata);o.isValid||r.push(...o.errors),n.push(...o.warnings)}return{isValid:r.length===0,errors:r,warnings:n}}validateMetadata(t,r){const n=[],a=[];switch(t){case"event":r.artist_name&&typeof r.artist_name!="string"&&n.push("artist_name must be a string"),r.venue_name&&typeof r.venue_name!="string"&&n.push("venue_name must be a string"),r.event_date&&!this.isValidDate(r.event_date)&&n.push("event_date must be a valid ISO date string");break;case"artist":r.artist_name&&typeof r.artist_name!="string"&&n.push("artist_name must be a string"),r.genres&&!Array.isArray(r.genres)&&n.push("genres must be an array");break;case"venue":r.venue_name&&typeof r.venue_name!="string"&&n.push("venue_name must be a string"),r.venue_city&&typeof r.venue_city!="string"&&n.push("venue_city must be a string"),r.venue_state&&typeof r.venue_state!="string"&&n.push("venue_state must be a string");break;case"review":r.rating&&(typeof r.rating!="number"||r.rating<1||r.rating>5)&&n.push("rating must be a number between 1 and 5"),r.review_text&&typeof r.review_text!="string"&&n.push("review_text must be a string");break;case"ticket_link":r.price&&typeof r.price!="number"&&n.push("price must be a number"),r.currency&&typeof r.currency!="string"&&n.push("currency must be a string");break}return{isValid:n.length===0,errors:n,warnings:a}}isValidDate(t){const r=new Date(t);return r instanceof Date&&!isNaN(r.getTime())}logError(t,r,n){return E(this,null,function*(){console.error(`[${t}]`,r,n)})}calculateSessionMetrics(){const t=Date.now()-this.sessionStartTime.getTime(),r=this.calculateEngagementScore(),n=this.sessionPageViews<=1?100:0;return{duration:t,interactionCount:this.sessionInteractions,engagementScore:r,pageViews:this.sessionPageViews,bounceRate:n}}calculateEngagementScore(){if(this.sessionInteractions===0)return 0;const r=(Date.now()-this.sessionStartTime.getTime())/(1e3*60);let n=Math.min(this.sessionInteractions*10,50);return r>5&&(n+=20),r>15&&(n+=20),r>30&&(n+=10),r<1&&(n*=.5),Math.min(Math.round(n),100)}logInteraction(t){return E(this,null,function*(){const r=this.normalizeInteractionEvent(t);try{const n=this.validateInteractionData(r);if(!n.isValid){yield this.logError("interaction_validation_error",new Error(n.errors.join(", ")),r),console.warn("Invalid interaction data:",n.errors);return}n.warnings.length>0&&console.warn("Interaction validation warnings:",n.warnings);const{data:{user:a}}=yield T.auth.getUser();if(!a){console.warn("No authenticated user for interaction logging");return}if(this.sessionInteractions++,r.eventType==="view"&&this.sessionPageViews++,!["search","view","form","ticket_link","song","album","playlist","genre","scene"].includes(r.entityType)&&!r.entityUuid){console.warn(`Skipping interaction: entity_type '${r.entityType}' requires entity_uuid but it was not provided`,r);return}console.debug("Interaction logged:",r)}catch(n){yield this.logError("interaction_logging_exception",n,r),console.error("Error logging interaction:",n)}})}queueInteraction(t){this.eventQueue.push(H(M({},t),{sessionId:t.sessionId||this.sessionId,timestamp:new Date().toISOString()})),this.eventQueue.length>=this.BATCH_SIZE?this.flushBatch():(this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(()=>{this.flushBatch()},this.BATCH_DELAY))}flushBatch(){return E(this,null,function*(){if(this.eventQueue.length===0)return;const t=[...this.eventQueue];this.eventQueue=[],this.batchTimeout&&(clearTimeout(this.batchTimeout),this.batchTimeout=null);const r=[];try{const{data:{user:n}}=yield T.auth.getUser();if(!n){console.warn("No authenticated user for batch logging");return}const a=[];for(const l of t){const c=this.normalizeInteractionEvent(l),d=this.validateInteractionData(c);d.isValid?(d.warnings.length>0&&console.warn("Interaction validation warnings:",d.warnings,c),r.push(c)):(a.push({event:c,errors:d.errors}),yield this.logError("interaction_validation_error",new Error(d.errors.join(", ")),c),console.warn("Invalid interaction in batch:",d.errors,c))}if(r.length===0){console.warn("No valid interactions in batch to insert"),a.length>0&&console.warn(`Skipped ${a.length} invalid interactions`);return}const i=["search","view","form","ticket_link","song","album","playlist","genre","scene"],o=r.filter(l=>!i.includes(l.entityType)&&!l.entityUuid?(console.warn(`Skipping interaction: entity_type '${l.entityType}' requires entity_uuid but it was not provided`,l),!1):!0).map(l=>({user_id:n.id,session_id:l.sessionId||this.sessionId,event_type:l.eventType,entity_type:l.entityType,entity_id:l.entityId||null,entity_uuid:l.entityUuid||null,metadata:l.metadata||{}}));console.debug(` Logged ${o.length} interactions (console only)`,o),a.length>0&&console.warn(` Skipped ${a.length} invalid interactions`)}catch(n){console.error("Error logging interaction batch:",n);for(const a of r)yield this.logError("interaction_logging_exception",n,a)}})}flush(){return E(this,null,function*(){yield this.flushBatch()})}startNewSession(){return this.sessionId=this.generateSessionId(),this.sessionStartTime=new Date,this.sessionInteractions=0,this.sessionPageViews=0,this.sessionId}getSessionMetrics(){return this.calculateSessionMetrics()}getSessionId(){return this.sessionId}}const zs=new xie,On={search:(e,t,r,n)=>{zs.queueInteraction({eventType:"search",entityType:t,entityId:r,metadata:M({query:e},n)})},click:(e,t,r)=>{zs.queueInteraction({eventType:"click",entityType:e,entityId:t,metadata:r})},like:(e,t,r,n)=>{zs.queueInteraction({eventType:"like",entityType:e,entityId:t,metadata:M({isLiked:r},n)})},share:(e,t,r,n)=>{zs.queueInteraction({eventType:"share",entityType:e,entityId:t,metadata:M({platform:r},n)})},comment:(e,t,r,n)=>{zs.queueInteraction({eventType:"comment",entityType:e,entityId:t,metadata:M({commentLength:r},n)})},review:(e,t,r,n,a)=>{zs.queueInteraction({eventType:"review",entityType:e,entityId:t,entityUuid:a||void 0,metadata:M({rating:r},n)})},interest:(e,t,r,n)=>{zs.queueInteraction({eventType:"interest",entityType:e,entityId:t,metadata:M({isInterested:r},n)})},swipe:(e,t,r,n)=>{zs.queueInteraction({eventType:"swipe",entityType:e,entityId:t,metadata:M({direction:r},n)})},view:(e,t,r,n)=>{zs.queueInteraction({eventType:"view",entityType:e,entityId:t,metadata:M({duration:r},n)})},trackFeedImpression:(e,t)=>{zs.queueInteraction({eventType:"view",entityType:"event",entityId:e,metadata:M({source:"feed",impression:!0},t)})},navigate:(e,t,r)=>{zs.queueInteraction({eventType:"navigate",entityType:"view",entityId:t,metadata:M({fromView:e},r)})},formSubmit:(e,t,r,n,a)=>{zs.queueInteraction({eventType:"form_submit",entityType:e,entityId:t,entityUuid:a||void 0,metadata:M({success:r},n)})},profileUpdate:(e,t,r)=>{zs.queueInteraction({eventType:"profile_update",entityType:"profile",entityId:t,metadata:M({field:e},r)})}};typeof window!="undefined"&&window.addEventListener("beforeunload",()=>{zs.flush()});const _ie=Object.freeze(Object.defineProperty({__proto__:null,interactionTracker:zs,trackInteraction:On},Symbol.toStringTag,{value:"Module"})),wie={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdscGlvbGJyYWZxaWtxaG5zZXRvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5Mzc4MjQsImV4cCI6MjA3MjUxMzgyNH0.O5G3fW-YFtpACNqNfo_lsLK44F-3L3p69Ka-G2lSTLE",VITE_SUPABASE_URL:"https://glpiolbrafqikqhnseto.supabase.co"},Nu=class Nu{constructor(){Cr(this,"accessToken",null);Cr(this,"config");const t="",r=typeof window!="undefined"?`${window.location.origin}/auth/spotify/callback`:"";console.log(" Spotify Config Debug:",{hasClientId:!!t,hasRedirectUri:!!r,clientIdLength:t.length,redirectUri:r,envMode:"production",allEnvKeys:Object.keys(wie)}),this.config={clientId:t,redirectUri:r,scopes:["user-read-private","user-read-email","user-top-read","user-read-recently-played","user-read-playback-state","user-read-currently-playing"]},console.error("Spotify config is missing. Ensure VITE_SPOTIFY_CLIENT_ID and VITE_SPOTIFY_REDIRECT_URI are set.")}static getInstance(){return Nu.instance||(Nu.instance=new Nu),Nu.instance}isConfigured(){return!!(this.config.clientId&&this.config.redirectUri)}authenticate(){return E(this,null,function*(){if(!this.config.clientId||!this.config.redirectUri)throw console.warn("Spotify not configured. Missing VITE_SPOTIFY_CLIENT_ID or VITE_SPOTIFY_REDIRECT_URI environment variables."),new Error("Spotify integration is not configured. Please contact the administrator.");const t=this.generateRandomString(16),r=this.generateRandomString(64),n=yield this.generateCodeChallenge(r);localStorage.setItem("spotify_auth_state",t),localStorage.setItem("spotify_code_verifier",r);const a=new URL("https://accounts.spotify.com/authorize");a.searchParams.append("client_id",this.config.clientId),a.searchParams.append("response_type","code"),a.searchParams.append("redirect_uri",this.config.redirectUri),a.searchParams.append("state",t),a.searchParams.append("scope",this.config.scopes.join(" ")),a.searchParams.append("code_challenge_method","S256"),a.searchParams.append("code_challenge",n);try{On.click("spotify",this.config.clientId,{action:"connect_start",scopes:this.config.scopes,redirectUri:this.config.redirectUri})}catch(i){}window.location.href=a.toString()})}reauthenticate(){console.log(" Forcing re-authentication..."),this.logout(),this.authenticate()}validateTokenAndReauthIfNeeded(){return E(this,null,function*(){if(!this.accessToken)return console.log(" No access token available"),!1;const t=new URLSearchParams(window.location.search);if(t.get("code")&&t.get("state"))return console.log(" Currently in auth callback, skipping token validation to avoid race condition"),!1;try{return console.log(" Validating token scopes..."),yield this.spotifyApiCall("/me"),console.log(" Token validation successful"),!0}catch(n){if(console.error(" Token validation failed:",n),n instanceof Error&&n.message.includes("403"))return console.log(" Token has insufficient scopes, clearing old token and forcing re-authentication..."),this.clearStoredData(),this.reauthenticate(),!1;throw n}})}handleAuthCallback(){return E(this,null,function*(){console.log(" Handling Spotify auth callback...");const t=new URLSearchParams(window.location.search),r=t.get("code"),n=t.get("state"),a=t.get("error");if(console.log(" Callback params:",{code:!!r,state:!!n,error:a}),a)throw console.error(" Authentication error:",a),new Error(`Authentication failed: ${a}`);if(!r||!n)return console.log(" No code or state in callback, not a Spotify auth"),!1;const i=localStorage.getItem("spotify_auth_state");if(console.log(" State validation:",{received:n,stored:i,match:n===i}),n!==i)if(console.error(" State mismatch detected"),console.log(" Attempting recovery..."),i){console.error(" State mismatch with stored state present"),console.log(" This might be due to a race condition - attempting token exchange anyway");try{return yield this.exchangeCodeForToken(r),console.log(" Token exchange successful despite state mismatch"),window.history.replaceState({},document.title,window.location.pathname),localStorage.removeItem("spotify_auth_state"),localStorage.removeItem("spotify_code_verifier"),!0}catch(o){throw console.error(" Token exchange failed:",o),new Error("Authentication state mismatch. Please try connecting to Spotify again.")}}else{console.log(" No stored state found - user may have navigated away during auth"),console.log(" Attempting to proceed with token exchange anyway...");try{return yield this.exchangeCodeForToken(r),console.log(" Token exchange successful despite state mismatch"),window.history.replaceState({},document.title,window.location.pathname),!0}catch(o){throw console.error(" Token exchange failed:",o),new Error("Authentication state mismatch. Please try connecting to Spotify again.")}}console.log(" State validated, exchanging code for token..."),yield this.exchangeCodeForToken(r),window.history.replaceState({},document.title,window.location.pathname);try{On.click("spotify","current_user",{action:"connect_success"})}catch(o){}return console.log(" Authentication completed successfully!"),!0})}syncUserMusicPreferences(){return E(this,null,function*(){var t;try{const[r,n,a]=yield Promise.all([this.getTopArtists("short_term",50,0).catch(()=>({items:[]})),this.getTopArtists("medium_term",50,0).catch(()=>({items:[]})),this.getTopArtists("long_term",50,0).catch(()=>({items:[]}))]),[i,o,l]=yield Promise.all([this.getTopTracks("short_term",50,0).catch(()=>({items:[]})),this.getTopTracks("medium_term",50,0).catch(()=>({items:[]})),this.getTopTracks("long_term",50,0).catch(()=>({items:[]}))]),c=yield this.getRecentlyPlayed(50).catch(()=>({items:[]})),d=yield this.getUserProfile().catch(()=>null),u=[...r.items,...n.items,...a.items],f=[...i.items,...o.items,...l.items];yield this.saveToStreamingProfiles({topArtists:u,topTracks:f,recentlyPlayed:c.items,userProfile:d});const h=(g,v)=>{zs.queueInteraction({eventType:"music_pref",entityType:"artist",entityId:g.id,metadata:{name:g.name,genres:g.genres,popularity:g.popularity,timeRange:v}})};r.items.forEach(g=>h(g,"short_term")),n.items.forEach(g=>h(g,"medium_term")),a.items.forEach(g=>h(g,"long_term"));const p=(g,v)=>{var y,_,w;zs.queueInteraction({eventType:"music_pref",entityType:"track",entityId:g.id,metadata:{name:g.name,album:(y=g.album)==null?void 0:y.name,artistNames:(_=g.artists)==null?void 0:_.map(b=>b.name),artistIds:(w=g.artists)==null?void 0:w.map(b=>b.id),popularity:g.popularity,timeRange:v}})};i.items.forEach(g=>p(g,"short_term")),o.items.forEach(g=>p(g,"medium_term")),l.items.forEach(g=>p(g,"long_term")),c.items.forEach(g=>{var y,_,w;const v=g.track;v&&zs.queueInteraction({eventType:"listen",entityType:"track",entityId:v.id,metadata:{name:v.name,album:(y=v.album)==null?void 0:y.name,artistNames:(_=v.artists)==null?void 0:_.map(b=>b.name),artistIds:(w=v.artists)==null?void 0:w.map(b=>b.id),played_at:g.played_at}})});try{yield zs.flush()}catch(g){(g==null?void 0:g.code)==="23505"&&((t=g==null?void 0:g.message)!=null&&t.includes("user_genre_interactions"))?console.warn("Some genre interactions were duplicates (this is expected during sync)"):console.error("Error flushing interactions:",g)}try{const{data:{user:g}}=yield T.auth.getUser();if(g){console.log(" Fetching comprehensive streaming data...");const[v,y,_]=yield Promise.all([this.getAllTopArtists("short_term").catch(()=>[]),this.getAllTopArtists("medium_term").catch(()=>[]),this.getAllTopArtists("long_term").catch(()=>[])]),[w,b,N]=yield Promise.all([this.getAllTopTracks("short_term").catch(()=>[]),this.getAllTopTracks("medium_term").catch(()=>[]),this.getAllTopTracks("long_term").catch(()=>[])]),S=yield Promise.all([this.getRecentlyPlayed(50,void 0,void 0).catch(()=>({items:[]})),this.getRecentlyPlayed(50,void 0,void 0).catch(()=>({items:[]})),this.getRecentlyPlayed(50,void 0,void 0).catch(()=>({items:[]})),this.getRecentlyPlayed(50,void 0,void 0).catch(()=>({items:[]}))]).then(k=>k.flatMap(R=>R.items||[]).filter((R,$,O)=>$===O.findIndex(z=>{var D,B;return((D=z.track)==null?void 0:D.id)===((B=R.track)==null?void 0:B.id)})).slice(0,200));console.log(" Stats table removed - stats not persisted. Fetched:",{short_term:{artists:v.length,tracks:w.length},medium_term:{artists:y.length,tracks:b.length},long_term:{artists:_.length,tracks:N.length},recently_played:S.length});try{const{streamingSyncService:k}=yield kn(()=>E(this,null,function*(){const{streamingSyncService:P}=yield Promise.resolve().then(()=>K_);return{streamingSyncService:P}}),void 0,import.meta.url);k.isSyncing()&&k.completeSync()}catch(k){console.warn("Could not notify sync service:",k)}}}catch(g){console.error("Error storing comprehensive Spotify stats:",g);try{const{streamingSyncService:v}=yield kn(()=>E(this,null,function*(){const{streamingSyncService:y}=yield Promise.resolve().then(()=>K_);return{streamingSyncService:y}}),void 0,import.meta.url);v.errorSync(g instanceof Error?g.message:"Unknown error")}catch(v){console.warn("Could not notify sync service of error:",v)}}On.click("spotify","current_user",{action:"sync_complete",artists_short:r.items.length,artists_medium:n.items.length,artists_long:a.items.length,tracks_short:i.items.length,tracks_medium:o.items.length,tracks_long:l.items.length,recently_played:c.items.length})}catch(r){console.error("Spotify sync error:",r)}})}saveToStreamingProfiles(t){return E(this,null,function*(){var r,n,a,i,o,l,c,d,u,f,h;try{const{data:{user:p}}=yield T.auth.getUser();if(!p){console.warn("No authenticated user for streaming profile save");return}const g={topArtists:t.topArtists,topTracks:t.topTracks,recentlyPlayed:t.recentlyPlayed,userProfile:t.userProfile,external_urls:(r=t.userProfile)==null?void 0:r.external_urls,followers:(n=t.userProfile)==null?void 0:n.followers,country:(a=t.userProfile)==null?void 0:a.country,display_name:(i=t.userProfile)==null?void 0:i.display_name,email:(o=t.userProfile)==null?void 0:o.email,images:(l=t.userProfile)==null?void 0:l.images,product:(c=t.userProfile)==null?void 0:c.product,type:(d=t.userProfile)==null?void 0:d.type,uri:(u=t.userProfile)==null?void 0:u.uri},{error:v}=yield T.from("streaming_profiles").upsert({user_id:p.id,service_type:"spotify",profile_data:g,sync_status:"completed",last_updated:new Date().toISOString()},{onConflict:"user_id,service_type",ignoreDuplicates:!1});if(v)if(v.code==="PGRST205")console.warn("Table streaming_profiles does not exist or RLS policy issue");else if(v.code==="23505"){const{error:y}=yield T.from("streaming_profiles").update({profile_data:g,sync_status:"completed",last_updated:new Date().toISOString()}).eq("user_id",p.id).eq("service_type","spotify");y?console.error("Error updating streaming profile:",y):console.log(" Updated streaming profile for user:",p.id)}else console.error("Error upserting streaming profile:",v);else console.log(" Upserted streaming profile for user:",p.id);if((h=(f=t.userProfile)==null?void 0:f.external_urls)!=null&&h.spotify){const{error:y}=yield T.from("users").update({music_streaming_profile:t.userProfile.external_urls.spotify,updated_at:new Date().toISOString()}).eq("user_id",p.id);y?console.warn("Warning: Failed to update user profile with Spotify URL:",y):console.log(" Updated user profile with Spotify URL")}}catch(p){console.error("Error saving to streaming profiles:",p)}})}checkStoredToken(){const t=localStorage.getItem("spotify_access_token"),r=localStorage.getItem("spotify_token_expiry");return t&&r&&Date.now()<parseInt(r)?(this.accessToken=t,console.log(" Found stored token, expires at:",new Date(parseInt(r)).toLocaleString()),!0):(console.log(" No valid stored token found"),!1)}ensureSession(){return E(this,null,function*(){const t=localStorage.getItem("spotify_access_token"),r=localStorage.getItem("spotify_token_expiry");if(t&&r){const n=parseInt(r);return Date.now()<n?(this.accessToken=t,!0):yield this.refreshToken()}return!1})}syncThisSessionLightly(){return E(this,null,function*(){try{yield Promise.all([this.getTopArtists("medium_term",10,0).catch(()=>null),this.getTopTracks("medium_term",10,0).catch(()=>null),this.getRecentlyPlayed(10).catch(()=>null)])}catch(t){console.warn("Light sync skipped:",t)}})}isAuthenticated(){return this.accessToken!==null}checkTokenScopes(){return E(this,null,function*(){try{console.log(" Checking Spotify token scopes..."),console.log(" Requested scopes:",this.config.scopes),console.log(" Access token present:",!!this.accessToken);try{const t=yield this.spotifyApiCall("/me");console.log(" User profile loaded successfully, basic scopes are working"),console.log(" User profile:",t.display_name)}catch(t){throw console.error(" User profile failed:",t),t}try{yield this.spotifyApiCall("/me/top/tracks?limit=1"),console.log(" user-top-read scope is working")}catch(t){console.warn(" user-top-read scope may be missing:",t)}try{yield this.spotifyApiCall("/me/player/recently-played?limit=1"),console.log(" user-read-recently-played scope is working")}catch(t){console.warn(" user-read-recently-played scope may be missing:",t)}return["user-read-private","user-read-email"]}catch(t){throw console.error(" Token scope check failed:",t),new Error("Unable to verify token scopes. Please reconnect to Spotify.")}})}logout(){console.log(" Logging out from Spotify..."),this.accessToken=null,localStorage.removeItem("spotify_access_token"),localStorage.removeItem("spotify_token_expiry"),localStorage.removeItem("spotify_refresh_token"),localStorage.removeItem("spotify_auth_state"),localStorage.removeItem("spotify_code_verifier"),console.log(" Spotify logout completed")}clearStoredData(){console.log(" Clearing all stored Spotify data..."),this.logout(),console.log(" All Spotify data cleared")}forceClearAndReauth(){console.log(" Force clearing all data and re-authenticating..."),this.clearStoredData(),typeof window!="undefined"&&alert("Clearing all Spotify data. Please reconnect with the new authentication method."),this.authenticate()}recoverFromStateMismatch(){console.log(" Recovering from state mismatch..."),this.clearStoredData(),typeof window!="undefined"&&confirm(`Spotify authentication session expired. This can happen if you navigated away during the connection process.

Would you like to try connecting again now?`)&&this.authenticate()}nuclearReset(){console.log(" NUCLEAR RESET: Clearing everything and forcing fresh start..."),["spotify_access_token","spotify_token_expiry","spotify_refresh_token","spotify_auth_state","spotify_code_verifier"].forEach(r=>{localStorage.removeItem(r),console.log(` Removed ${r}`)}),this.accessToken=null,typeof window!="undefined"&&(alert("Nuclear reset complete. All Spotify data cleared. Please refresh the page and reconnect."),window.location.reload())}exchangeCodeForToken(t){return E(this,null,function*(){const r=localStorage.getItem("spotify_code_verifier")||"";if(!this.config.clientId||!this.config.redirectUri)throw new Error("Spotify not configured for token exchange");const n=yield fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",code:t,redirect_uri:this.config.redirectUri,client_id:this.config.clientId,code_verifier:r})}),a=yield n.json();if(!n.ok)throw console.error(" Token exchange failed:",n.status,n.statusText),console.error("Response data:",a),new Error("Failed to exchange code for token");if(console.log(" Token exchange successful!"),console.log(" Granted scopes:",a.scope),console.log(" Token expires in:",a.expires_in,"seconds"),a.access_token){this.accessToken=a.access_token;const i=Date.now()+a.expires_in*1e3;localStorage.setItem("spotify_access_token",a.access_token),localStorage.setItem("spotify_token_expiry",i.toString()),a.refresh_token&&(localStorage.setItem("spotify_refresh_token",a.refresh_token),console.log(" Refresh token saved"))}else throw new Error("No access token received")})}refreshToken(){return E(this,null,function*(){const t=localStorage.getItem("spotify_refresh_token");if(!t)return this.logout(),!1;try{const n=yield(yield fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:t,client_id:this.config.clientId})})).json();if(n.access_token){this.accessToken=n.access_token;const a=Date.now()+n.expires_in*1e3;return localStorage.setItem("spotify_access_token",n.access_token),localStorage.setItem("spotify_token_expiry",a.toString()),!0}return!1}catch(r){return console.error("Token refresh error:",r),!1}})}spotifyApiCall(n){return E(this,arguments,function*(t,r={}){if(!this.accessToken)throw new Error("No access token available");const a=`https://api.spotify.com/v1${t}`,i=yield fetch(a,M({headers:M({Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"},r.headers)},r));if(i.status===401){if(yield this.refreshToken())return this.spotifyApiCall(t,r);throw this.logout(),new Error("Authentication failed")}if(i.status===429){const o=i.headers.get("Retry-After"),l=o?parseInt(o)*1e3:1e3;return yield new Promise(c=>setTimeout(c,l)),this.spotifyApiCall(t,r)}if(i.status===403)throw console.log(" 403 Forbidden detected, clearing all stored data..."),this.clearStoredData(),typeof window!="undefined"&&window.dispatchEvent(new CustomEvent("spotify-token-cleared")),new Error("Access forbidden. Please reconnect with proper permissions.");if(i.status===404)throw new Error("No data found. This might be because you haven't listened to enough music yet.");if(!i.ok){const o=yield i.text().catch(()=>"Unknown error");throw new Error(`Spotify API error: ${i.status} ${i.statusText} - ${o}`)}return i.json()})}getUserProfile(){return E(this,null,function*(){try{return yield this.spotifyApiCall("/me")}catch(t){throw console.error("Error fetching user profile:",t),t instanceof Error&&t.message.includes("403")?new Error("Insufficient permissions. Please reconnect with proper Spotify permissions."):t}})}getTopTracks(t="medium_term",r=20,n=0){return E(this,null,function*(){var o,l;if(r<1||r>50)throw new Error("Limit must be between 1 and 50");if(n<0)throw new Error("Offset must be 0 or greater");const a=new URLSearchParams({time_range:t,limit:r.toString(),offset:n.toString()}),i=yield this.spotifyApiCall(`/me/top/tracks?${a.toString()}`);try{On.view("spotify","current_user",void 0,{resource:"top_tracks",count:(l=(o=i.items)==null?void 0:o.length)!=null?l:0,timeRange:t})}catch(c){}return i})}getTopArtists(t="medium_term",r=20,n=0){return E(this,null,function*(){var o,l;if(r<1||r>50)throw new Error("Limit must be between 1 and 50");if(n<0)throw new Error("Offset must be 0 or greater");const a=new URLSearchParams({time_range:t,limit:r.toString(),offset:n.toString()}),i=yield this.spotifyApiCall(`/me/top/artists?${a.toString()}`);try{On.view("spotify","current_user",void 0,{resource:"top_artists",count:(l=(o=i.items)==null?void 0:o.length)!=null?l:0,timeRange:t})}catch(c){}return i})}getRecentlyPlayed(t=20,r,n){return E(this,null,function*(){var o,l;if(t<1||t>50)throw new Error("Limit must be between 1 and 50");const a=new URLSearchParams({limit:t.toString()});r!==void 0&&a.append("after",r.toString()),n!==void 0&&a.append("before",n.toString());const i=yield this.spotifyApiCall(`/me/player/recently-played?${a.toString()}`);try{On.view("spotify","current_user",void 0,{resource:"recently_played",count:(l=(o=i.items)==null?void 0:o.length)!=null?l:0})}catch(c){}return i})}getCurrentPlayback(){return E(this,null,function*(){try{return this.spotifyApiCall("/me/player")}catch(t){return console.log("No active player found"),null}})}getAllTopTracks(t="medium_term"){return E(this,null,function*(){const r=[];let n=0;const a=50;let i=!0;for(;i;)try{const o=yield this.getTopTracks(t,a,n);r.push(...o.items),i=o.next!==null,n+=a}catch(o){console.error("Error fetching top tracks:",o);break}return r})}getAllTopArtists(t="medium_term"){return E(this,null,function*(){const r=[];let n=0;const a=50;let i=!0;for(;i;)try{const o=yield this.getTopArtists(t,a,n);r.push(...o.items),i=o.next!==null,n+=a}catch(o){console.error("Error fetching top artists:",o);break}return r})}calculateListeningStats(t,r){const n=t.length;if(n===0)return{totalTracks:0,uniqueArtists:0,uniqueAlbums:0,totalHours:0,avgPopularity:0,topGenres:[]};const a=new Set(t.flatMap(f=>f.artists.map(h=>h.id))).size,i=new Set(t.map(f=>f.album.id)).size,o=Math.round(t.reduce((f,h)=>f+h.popularity,0)/n),l=t.reduce((f,h)=>f+h.duration_ms,0),c=Math.round(l/(1e3*60*60)*10)/10,d={};r.forEach(f=>{f.genres.forEach(h=>{d[h]=(d[h]||0)+1})});const u=Object.entries(d).sort(([,f],[,h])=>h-f).slice(0,5).map(([f])=>f);return{totalTracks:n,uniqueArtists:a,uniqueAlbums:i,totalHours:c,avgPopularity:o,topGenres:u}}formatDate(t){const n=new Date().getTime()-t.getTime(),a=Math.floor(n/(1e3*60)),i=Math.floor(n/(1e3*60*60)),o=Math.floor(n/(1e3*60*60*24));return a<60?`${a} minutes ago`:i<24?`${i} hours ago`:o<7?`${o} days ago`:t.toLocaleDateString()}generateRandomString(t){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let a=0;a<t;a++)n+=r.charAt(Math.floor(Math.random()*r.length));return n}generateCodeChallenge(t){return E(this,null,function*(){const n=new TextEncoder().encode(t),a=yield crypto.subtle.digest("SHA-256",n);return btoa(String.fromCharCode(...new Uint8Array(a))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}selfTest(){return E(this,null,function*(){var t,r,n,a;try{const i=yield this.getUserProfile(),o=yield this.getTopArtists("short_term",1,0),l=yield this.getRecentlyPlayed(1);return{ok:!0,profile:i.display_name,topArtists:(r=(t=o.items)==null?void 0:t.length)!=null?r:0,recentlyPlayed:(a=(n=l.items)==null?void 0:n.length)!=null?a:0}}catch(i){return{ok:!1,error:(i==null?void 0:i.message)||String(i)}}})}};Cr(Nu,"instance");let u2=Nu;const Cu=u2.getInstance();class bie{constructor(){Cr(this,"syncState",{status:"idle",serviceType:null,startedAt:null,completedAt:null,error:null});Cr(this,"listeners",[]);Cr(this,"checkInterval",null)}startSync(t){this.syncState={status:"syncing",serviceType:t,startedAt:Date.now(),completedAt:null,error:null},localStorage.setItem("streaming_sync_state",JSON.stringify(this.syncState)),this.notifyListeners(),this.startPolling()}completeSync(){this.syncState=H(M({},this.syncState),{status:"completed",completedAt:Date.now()}),localStorage.setItem("streaming_sync_state",JSON.stringify(this.syncState)),this.notifyListeners(),this.stopPolling()}errorSync(t){this.syncState=H(M({},this.syncState),{status:"error",completedAt:Date.now(),error:t}),localStorage.setItem("streaming_sync_state",JSON.stringify(this.syncState)),this.notifyListeners(),this.stopPolling()}getState(){return M({},this.syncState)}isSyncing(){return this.syncState.status==="syncing"}clearSync(){this.syncState={status:"idle",serviceType:null,startedAt:null,completedAt:null,error:null},localStorage.removeItem("streaming_sync_state"),this.notifyListeners(),this.stopPolling()}restoreState(){localStorage.removeItem("streaming_sync_state"),this.clearSync()}startPolling(){this.stopPolling(),this.syncState.status==="syncing"&&this.completeSync()}stopPolling(){this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)}subscribe(t){return this.listeners.push(t),t(this.getState()),()=>{const r=this.listeners.indexOf(t);r>-1&&this.listeners.splice(r,1)}}notifyListeners(){this.listeners.forEach(t=>t(this.getState()))}}const yl=new bie,K_=Object.freeze(Object.defineProperty({__proto__:null,streamingSyncService:yl},Symbol.toStringTag,{value:"Module"})),jie=()=>{const{toast:e}=Rr(),[t,r]=x.useState("connecting"),[n,a]=x.useState("");return x.useEffect(()=>{E(void 0,null,function*(){try{r("connecting"),(yield Cu.handleAuthCallback())?(yl.startSync("spotify"),Cu.syncUserMusicPreferences().catch(l=>{console.error("Background sync error:",l),yl.errorSync(l.message||"Sync failed")}),r("complete"),e({title:"Connected to Spotify",description:"Your stats are syncing in the background. You'll be notified when ready!"}),setTimeout(()=>{window.location.href="/",localStorage.setItem("intendedView","feed")},1500)):(r("error"),a("Authentication was not successful. Please try again."),e({title:"Connection Failed",description:"Failed to connect to Spotify. Please try again.",variant:"destructive"}),setTimeout(()=>{window.location.href="/"},2e3))}catch(o){console.error("Spotify callback error:",o),r("error");let l="Failed to connect to Spotify. Please try again.";o instanceof Error&&(o.message.includes("state mismatch")?l="Authentication session expired. Please try connecting again.":o.message.includes("Authentication failed")?l="Spotify authentication was cancelled or failed.":l=o.message),a(l),e({title:"Connection Failed",description:l,variant:"destructive"}),Cu.clearStoredData(),setTimeout(()=>{window.location.href="/"},2e3)}})},[e]),s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-white to-beige-50",children:s.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[t==="connecting"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Connecting to Spotify..."}),s.jsx("p",{className:"text-muted-foreground",children:"Please wait while we authenticate your account."})]}),t==="complete"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Successfully Connected!"}),s.jsx("p",{className:"text-muted-foreground mb-2",children:"Your stats are syncing in the background."}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"You'll be notified when they're ready. Redirecting to app..."})]}),t==="error"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("h2",{className:"text-xl font-semibold mb-2 text-red-600",children:"Connection Failed"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:n}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Redirecting to home..."})]})]})})},Nie="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M5.4885%2022.0003C4.11417%2022.0003%203%2020.857%203%2019.4453V9.17632C3%208.40049%203.34417%207.66549%203.93333%207.18132L10.7782%201.56032C11.2155%201.19817%2011.7655%201%2012.3333%201C12.9012%201%2013.4512%201.19817%2013.8885%201.56032L20.7322%207.18132C21.3225%207.66549%2021.6667%208.40049%2021.6667%209.17632V19.4453C21.6667%2020.857%2020.5525%2022.0003%2019.1782%2022.0003H5.4885Z'%20fill='%23CC2486'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M9%2021.75V15.3333C9%2014.7145%209.24583%2014.121%209.68342%2013.6834C10.121%2013.2458%2010.7145%2013%2011.3333%2013H12.5C13.1188%2013%2013.7123%2013.2458%2014.1499%2013.6834C14.5875%2014.121%2014.8333%2014.7145%2014.8333%2015.3333V21.75'%20stroke='%23FDF2F7'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",Sie="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_3690_6527)'%3e%3cpath%20d='M23%2012C23%2013.4445%2022.7155%2014.8749%2022.1627%2016.2095C21.6099%2017.5441%2020.7996%2018.7567%2019.7782%2019.7782C18.7567%2020.7996%2017.5441%2021.6099%2016.2095%2022.1627C14.8749%2022.7155%2013.4445%2023%2012%2023C10.5555%2023%209.12506%2022.7155%207.79048%2022.1627C6.4559%2021.6099%205.24327%2020.7996%204.22183%2019.7782C3.20038%2018.7567%202.39013%2017.5441%201.83733%2016.2095C1.28452%2014.8749%201%2013.4445%201%2012C1%209.08262%202.15893%206.28473%204.22183%204.22183C6.28473%202.15893%209.08262%201%2012%201C14.9174%201%2017.7153%202.15893%2019.7782%204.22183C21.8411%206.28473%2023%209.08262%2023%2012Z'%20fill='%23CC2486'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M7%2017L9.5%209.5L17%207L14.5%2014.5L7%2017Z'%20fill='%23FDF2F7'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_3690_6527'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",kie="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_3690_6539)'%3e%3cpath%20d='M12%2023C14.1756%2023%2016.3023%2022.3549%2018.1113%2021.1462C19.9202%2019.9375%2021.3301%2018.2195%2022.1627%2016.2095C22.9952%2014.1995%2023.2131%2011.9878%2022.7886%209.85401C22.3642%207.72022%2021.3165%205.76021%2019.7782%204.22183C18.2398%202.68345%2016.2798%201.6358%2014.146%201.21137C12.0122%200.78693%209.80047%201.00477%207.79048%201.83733C5.78049%202.66989%204.06253%204.07979%202.85383%205.88873C1.64514%207.69767%201%209.82441%201%2012C1%2013.76%201.41311%2015.4222%202.14889%2016.8974C2.70256%2018.0109%201.93256%2019.513%201.63922%2020.6093C1.57424%2020.8518%201.57422%2021.1071%201.63919%2021.3496C1.70415%2021.5921%201.83181%2021.8132%202.00931%2021.9907C2.18682%2022.1682%202.40792%2022.2958%202.6504%2022.3608C2.89288%2022.4258%203.14819%2022.4258%203.39067%2022.3608C4.487%2022.0674%205.98911%2021.2974%207.10255%2021.8523C8.62448%2022.608%2010.3008%2023.0008%2012%2023Z'%20fill='%23CC2486'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_3690_6539'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",Eie="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M16%205.125C16%206.21902%2015.5786%207.26823%2014.8284%208.04182C14.0783%208.8154%2013.0609%209.25%2012%209.25C10.9391%209.25%209.92172%208.8154%209.17157%208.04182C8.42143%207.26823%208%206.21902%208%205.125C8%204.03098%208.42143%202.98177%209.17157%202.20818C9.92172%201.4346%2010.9391%201%2012%201C13.0609%201%2014.0783%201.4346%2014.8284%202.20818C15.5786%202.98177%2016%204.03098%2016%205.125ZM22%2023C21.3667%2010.1671%202.63333%2010.1671%202%2023Z'%20fill='%23CC2486'/%3e%3cpath%20d='M22%2023C21.3667%2010.1671%202.63333%2010.1671%202%2023M16%205.125C16%206.21902%2015.5786%207.26823%2014.8284%208.04182C14.0783%208.8154%2013.0609%209.25%2012%209.25C10.9391%209.25%209.92172%208.8154%209.17157%208.04182C8.42143%207.26823%208%206.21902%208%205.125C8%204.03098%208.42143%202.98177%209.17157%202.20818C9.92172%201.4346%2010.9391%201%2012%201C13.0609%201%2014.0783%201.4346%2014.8284%202.20818C15.5786%202.98177%2016%204.03098%2016%205.125Z'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",Cie={houseSelected:Nie,discoverSelected:Sie,circleCommentSelected:kie,userSelected:Eie},Pie={x:"X",heart:"Heart",smallMusic:"Music",smallLocation:"MapPin",smallCheck:"Check",house:"Home",discover:"Compass",circleComment:"MessageCircle",user:"User",search:"Search",send:"Send",share:"Share2",upload:"Upload",download:"Download",edit:"SquarePen",trash:"Trash2",refresh:"RefreshCw",repeat:"Repeat",plus:"Plus",plusBox:"SquarePlus",hamburgerMenu:"Menu",bell:"Bell",settings:"Settings",filter:"Filter",sort:"ArrowDownUp",sortFilter:"SlidersHorizontal",check:"Check",checkMark:"Check",circleCheck:"CheckCircle2",minus:"Minus",questionMark:"CircleHelp",infoCircle:"Info",exclamationTriangle:"AlertTriangle",ellipsis:"Ellipsis",moreHorizontal:"Ellipsis",overflowMenu:"Ellipsis",arrowDown:"ArrowDown",arrowUp:"ArrowUp",left:"ChevronLeft",leftArrow:"ArrowLeft",right:"ChevronRight",up:"ChevronUp",upArrow:"ArrowUp",down:"ChevronDown",thumbsUp:"ThumbsUp",star:"Star",image:"Image",photo:"Camera",video:"Video",music:"Music",location:"MapPin",calendar:"Calendar",ticket:"Ticket",clock:"Clock",envelope:"Mail",squareComment:"MessageSquare",atSymbol:"AtSign",userPlus:"UserPlus",twoUsers:"Users",dollar:"DollarSign",building:"Building2",lock:"Lock",key:"Key",shield:"Shield",ban:"Ban",flag:"Flag",barChart:"BarChart3",pieChart:"PieChart",trendingUp:"TrendingUp",globe:"Globe",eye:"Eye",externalLink:"ExternalLink",maximize:"Maximize2",mousePointer:"MousePointer",target:"Target",route:"Route",ribbonAward:"Award",logOut:"LogOut",spotifyLogo:"Music",appleMusicLogo:"Music",instagram:"Instagram",mediumStar:"Star",mediumMusic:"Music",mediumLocation:"MapPin",mediumSend:"Send",mediumDollar:"DollarSign",mediumBuildings:"Building2",mediumShootingStar:"Sparkles",mediumMicrophone:"Mic",mediumEdit:"Pencil",largeHeart:"Heart",largeStar:"Star",largeVideo:"Video",largeCamera:"Camera",largeMusic:"Music",largeMessaging:"MessageCircle",fullStar:"Star",halfStar:"Star"},Tie=new Set(["houseSelected","discoverSelected","circleCommentSelected","userSelected"]);function f9(e){return Tie.has(e)}function Aie(e){return f9(e)?null:Pie[e]||null}const Rie={X:Gr,Heart:ns,Music:$t,MapPin:gr,Check:ta,Search:Uo,Send:Fc,Share2:zd,Upload:z_,Download:cp,SquarePen:_c,Trash2:Dl,RefreshCw:mi,Repeat:AF,Plus:Vo,SquarePlus:FQ,Menu:TQ,Bell:Ld,Settings:jP,Filter:Iy,ArrowDownUp:sQ,SlidersHorizontal:LQ,Minus:PF,CircleHelp:hQ,Info:yP,AlertTriangle:NP,CheckCircle2:uQ,Ellipsis:yQ,ArrowDown:jF,ArrowUp:NF,ChevronLeft:pP,ArrowLeft:Cs,ChevronRight:Dy,ChevronUp:Mo,ChevronDown:Ta,ThumbsUp:RF,Star:Qt,Image:kv,Camera:Nv,Video:DF,Home:vP,Compass:gP,Calendar:It,Ticket:Ml,Clock:ga,Mail:CF,MessageSquare:kf,AtSign:Lk,User:Rs,UserPlus:Ad,Users:zr,DollarSign:Ro,Building2:Yi,Lock:Ev,Key:kF,Shield:gl,Ban:F_,Flag:Qi,BarChart3:Fd,PieChart:Ib,TrendingUp:Bn,Globe:Ki,Eye:Kd,ExternalLink:Bo,Maximize2:PQ,MousePointer:_P,Target:Zi,Route:zk,Award:Ac,LogOut:EF,Instagram:xP,Sparkles:Ol,Mic:AQ,Pencil:MQ,MessageCircle:$n};function Oie(e){return Rie[e]||null}const Se=({name:e,size:t=24,color:r,alt:n,className:a})=>{const i=f9(e),o=i?Cie[e]:null;if(i)return o?s.jsx("img",{src:o,alt:n||`${e} icon`,width:t,height:t,className:`synth-icon ${a||""}`,style:{display:"block",flexShrink:0,margin:0,padding:0,verticalAlign:"middle",objectFit:"contain",objectPosition:"center"}}):(console.error(` Icon "${e}" not found in icons mapping`),s.jsx("span",{style:{display:"inline-block",width:`${t}px`,height:`${t}px`,backgroundColor:"#ff0000",color:"#fff",fontSize:"10px",textAlign:"center",lineHeight:`${t}px`},title:`Missing icon: ${e}`,children:"?"}));const l=Aie(e),c=l?Oie(l):null;return c?s.jsx("span",{className:`synth-icon ${a||""}`,style:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,margin:0,padding:0,verticalAlign:"middle",width:`${t}px`,height:`${t}px`,lineHeight:0,color:r||void 0},"aria-label":n||`${e} icon`,role:"img",children:s.jsx(c,{size:t,color:r||"currentColor",strokeWidth:2,"aria-hidden":"true"})}):(console.error(` Icon "${e}" not found in lucide-react mapping`),s.jsx("span",{style:{display:"inline-block",width:`${t}px`,height:`${t}px`,backgroundColor:"#ff0000",color:"#fff",fontSize:"10px",textAlign:"center",lineHeight:`${t}px`},title:`Missing icon: ${e}`,children:"?"}))},bu=({size:e,variant:t,initial:r,imageUrl:n,alt:a,className:i})=>{const o="profile-picture",l=`${o}--${e}`,c=`${o}--${t}`,d=[o,l,c,i].filter(Boolean).join(" "),u=()=>t==="image"&&n?s.jsx("img",{src:n,alt:a||"",className:"profile-picture__image"}):(t==="image"||t==="initial")&&r?s.jsx("span",{className:"profile-picture__initial","aria-hidden":a?void 0:!0,children:r.charAt(0).toUpperCase()}):s.jsx(Se,{name:"music",size:24,alt:a||"Music",className:"profile-picture__icon"});return s.jsx("div",{className:d,role:a?"img":void 0,"aria-label":a,children:u()})},oc=({name:e,username:t,initial:r,variant:n,followers:a,following:i,events:o,onFollowersClick:l,onFollowingClick:c,onEventsClick:d,imageUrl:u,className:f})=>{let h=45,p="initial";n==="artist"?(h=45,p="musicIcon"):n==="chat"?(h=32,p=u?"image":"initial"):n==="userProfile"?(h=75,p=u?"image":"initial"):(h=45,p=u?"image":"initial");const g=["user-info",`user-info--${n}`,f].filter(Boolean).join(" "),v=(n==="user"||n==="userProfile")&&t,y=n==="userProfile",_=[{key:"followers",label:"Followers",value:a},{key:"following",label:"Following",value:i},{key:"events",label:"Events",value:o}];return s.jsxs("div",{className:g,children:[s.jsx("div",{className:"user-info__avatar",children:s.jsx(bu,{size:h,variant:p,initial:r,imageUrl:u,alt:e})}),s.jsxs("div",{className:"user-info__content",children:[s.jsx("p",{className:"user-info__name",children:e}),v&&s.jsxs("p",{className:"user-info__username",children:["@",t]}),y&&s.jsx("div",{className:"user-info__stats","aria-label":"User statistics",children:_.map(w=>{var N;const b=()=>{w.key==="followers"&&l?l():w.key==="following"&&c?c():w.key==="events"&&d&&d()};return s.jsxs("button",{className:"user-info__stat",type:"button",onClick:b,style:{background:"none",border:"none",padding:0,cursor:l||c||d?"pointer":"default",textAlign:"center"},children:[s.jsx("span",{className:"user-info__stat-value",children:(N=w.value)!=null?N:0}),s.jsx("span",{className:"user-info__stat-label",children:w.label})]},w.key)})})]})]})},Sn=d=>{var u=d,{variant:e="primary",size:t,icon:r,iconPosition:n="left",fullWidth:a=!1,children:i,className:o="",disabled:l}=u,c=me(u,["variant","size","icon","iconPosition","fullWidth","children","className","disabled"]);const f=l||e==="disabled",h=f?"disabled":e,p=t||(e==="tertiary"?"tertiary":"standard"),g=e==="tertiary"?!1:a,v=e==="tertiary"?!1:p==="iconOnly";v&&!["primary","secondary","disabled"].includes(h)&&console.warn("Icon-only buttons are only allowed for primary, secondary, or disabled variants. Using standard size instead.");const y="synth-button",_=`synth-button--${h}`,w=`synth-button--${p}`,S=[y,_,w,g?"synth-button--full-width":"",v?"synth-button--icon-only":"",o].filter(Boolean).join(" "),k=()=>{switch(p){case"iconOnly":return 24;case"tertiary":return 16;case"standard":default:return 24}},P=()=>{if(!r)return null;const R=k();return s.jsx(Se,{name:r,size:R,className:"synth-button__icon"})},A=v||!i&&r&&p==="iconOnly";return s.jsx("button",H(M({type:"button",className:S,disabled:f,"aria-label":A&&!c["aria-label"]&&!i?r:c["aria-label"]},c),{children:A?P():s.jsxs(s.Fragment,{children:[r&&n==="left"&&P(),i&&s.jsx("span",{className:"synth-button__text",children:i}),r&&n==="right"&&P()]})}))},Dg=({text:e,icon:t,iconPosition:r,className:n="",onClick:a})=>{const i="icon-text",o=`icon-text--${r}`,c=[i,o,a?"icon-text--clickable":"",n].filter(Boolean).join(" "),d=s.jsxs(s.Fragment,{children:[r==="left"&&s.jsxs(s.Fragment,{children:[s.jsx(Se,{name:t,size:24,alt:"",className:"icon-text__icon"}),s.jsx("span",{className:"icon-text__text",children:e})]}),r==="right"&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"icon-text__text",children:e}),s.jsx(Se,{name:t,size:24,alt:"",className:"icon-text__icon"})]})]});return a?s.jsx("button",{className:c,onClick:a,type:"button","aria-label":e,children:d}):s.jsx("div",{className:c,children:d})},Pu=({label:e,icon:t,onPress:r,className:n=""})=>{const o=["menu-category",r?"menu-category--clickable":"",n].filter(Boolean).join(" "),l=s.jsx("div",{className:"menu-category__content",children:s.jsx(Dg,{text:e,icon:t,iconPosition:"left",className:"menu-category__icon-text"})});return r?s.jsx("button",{className:o,onClick:r,type:"button","aria-label":e,children:l}):s.jsx("div",{className:o,children:l})};class Z_{static refreshSignals(){return E(this,null,function*(){try{const{data:t,error:r}=yield T.rpc("refresh_user_preference_signals");return r?(console.error("Error refreshing preference signals:",r),{success:!1,error:r.message}):t&&t.success?(console.log(" Preference signals refreshed:",{signalsUpdated:t.signals_updated,timestamp:t.timestamp}),{success:!0,signalsUpdated:t.signals_updated}):{success:!1,error:"Unknown error"}}catch(t){return console.error("Exception refreshing preference signals:",t),{success:!1,error:t instanceof Error?t.message:"Unknown error"}}})}static shouldRefreshForSession(){const t=localStorage.getItem(this.SESSION_REFRESH_KEY);if(!t)return!0;const r=parseInt(t,10);return Date.now()-r>this.REFRESH_COOLDOWN_MS}static markRefreshed(){localStorage.setItem(this.SESSION_REFRESH_KEY,Date.now().toString())}static clearRefreshMarker(){localStorage.removeItem(this.SESSION_REFRESH_KEY)}static refreshIfNeeded(){return E(this,null,function*(){if(!this.shouldRefreshForSession()){console.log(" Skipping preference signals refresh (recently refreshed)");return}console.log(" Refreshing preference signals at session start..."),(yield this.refreshSignals()).success?this.markRefreshed():console.warn(" Preference signals refresh failed, will retry on next session")})}}Cr(Z_,"SESSION_REFRESH_KEY","preference_signals_refreshed"),Cr(Z_,"REFRESH_COOLDOWN_MS",60*60*1e3);function xs(){const[e,t]=x.useState(null),[r,n]=x.useState(null),[a,i]=x.useState(!0),[o,l]=x.useState(!1),c=x.useRef(null);return x.useEffect(()=>{E(this,null,function*(){try{const{data:{session:g},error:v}=yield T.auth.getSession();if(v)console.error("Error getting session:",v),l(!0),n(null),t(null);else if(g){const y=Math.floor(Date.now()/1e3);g.expires_at&&g.expires_at<y?(console.log("Initial session expired"),l(!0),n(null),t(null)):(l(!1),n(g),t(g.user),c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{Z_.refreshIfNeeded().catch(_=>{console.warn("Failed to refresh preference signals:",_)}),c.current=null},1e3))}else l(!1),n(null),t(null)}catch(g){console.error("Error in getInitialSession:",g),l(!0),n(null),t(null)}finally{i(!1)}});const h=setInterval(()=>E(this,null,function*(){try{const{data:{session:g},error:v}=yield T.auth.getSession();if(v)console.error("Error checking session:",v),l(!0),n(null),t(null);else if(g){const y=Math.floor(Date.now()/1e3);g.expires_at&&g.expires_at<y&&(console.log("Session expired during periodic check"),l(!0),n(null),t(null))}}catch(g){console.error("Error in periodic session check:",g)}}),5*60*1e3),{data:{subscription:p}}=T.auth.onAuthStateChange((g,v)=>E(this,null,function*(){var y;if(console.log("Auth state changed:",g,(y=v==null?void 0:v.user)==null?void 0:y.id),g==="SIGNED_OUT")console.log("User signed out"),l(!1),n(null),t(null);else if(g==="TOKEN_REFRESHED"&&!v)console.log("Session expired - no valid session after token refresh"),l(!0),n(null),t(null);else if(v){const _=Math.floor(Date.now()/1e3);v.expires_at&&v.expires_at<_?(console.log("Session expired - expires_at is in the past"),l(!0),n(null),t(null)):(console.log("Valid session found"),l(!1),n(v),t(v.user),(g==="SIGNED_IN"||g==="TOKEN_REFRESHED"||g==="INITIAL_SESSION")&&(c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{Z_.refreshIfNeeded().catch(w=>{console.warn("Failed to refresh preference signals:",w)}),c.current=null},1e3)))}else console.log("No session available"),l(!1),n(null),t(null);i(!1)}));return()=>{p.unsubscribe(),clearInterval(h),c.current&&(clearTimeout(c.current),c.current=null)}},[]),{user:e,session:r,loading:a,sessionExpired:o,signOut:()=>E(this,null,function*(){try{i(!0);const{error:f}=yield T.auth.signOut();f&&console.error("Error signing out:",f)}catch(f){console.error("Error in signOut:",f)}finally{i(!1)}}),resetSessionExpired:()=>{l(!1)}}}class Mie{constructor(){Cr(this,"cache",new Map);Cr(this,"maxSize",1e3)}get(t){const r=this.cache.get(t);return r?Date.now()-r.timestamp>r.ttl?(this.cache.delete(t),null):r.data:null}set(t,r,n){if(this.cache.size>=this.maxSize){const a=this.cache.keys().next().value;a&&this.cache.delete(a)}this.cache.set(t,{data:r,timestamp:Date.now(),ttl:n})}delete(t){this.cache.delete(t)}clear(){this.cache.clear()}clearPattern(t){const r=[];for(const n of this.cache.keys())n.startsWith(t)&&r.push(n);r.forEach(n=>this.cache.delete(n))}cleanup(){const t=Date.now(),r=[];for(const[n,a]of this.cache.entries())t-a.timestamp>a.ttl&&r.push(n);r.forEach(n=>this.cache.delete(n))}getStats(){const t=Date.now();let r=0,n=0;for(const a of this.cache.values())t-a.timestamp>a.ttl?r++:n++;return{total:this.cache.size,active:n,expired:r}}}const Do=new Mie;typeof window!="undefined"&&setInterval(()=>{Do.cleanup()},5*60*1e3);const h2={connectionDegree:(e,t)=>`connection_degree_${t}_${e}`,connectionInterests:e=>`connection_interests_${e}`,reviews:(e,t,r)=>`reviews_${e}_${t}_${r}`,chatPreviews:e=>`chat_previews_${e}`,userProfile:e=>`user_profile_${e}`,notifications:(e,t)=>`notifications_${e}_${t}`,messages:e=>`messages_${e}`},Iv={CONNECTION_DATA:10*60*1e3,REVIEWS:3*60*1e3,CHAT_PREVIEWS:2*60*1e3,USER_PROFILE:5*60*1e3,NOTIFICATIONS:2*60*1e3,MESSAGES:1*60*1e3},wn={log:(...e)=>{},warn:(...e)=>{},error:(...e)=>{console.error(...e)},info:(...e)=>{},debug:(...e)=>{}};function ih(){const{user:e}=xs(),[t,r]=x.useState(null),[n,a]=x.useState(!0),[i,o]=x.useState(null);x.useEffect(()=>{if(!e){r(null),a(!1);return}l()},[e]);const l=()=>E(this,null,function*(){if(e)try{a(!0),o(null);const v=h2.userProfile(e.id),y=Do.get(v);if(y){r(y),a(!1);return}const{data:_,error:w}=yield T.from("users_complete").select("account_type, subscription_tier, verified, verification_level, business_info").eq("user_id",e.id).single();if(w)wn.error(" useAccountType: Error fetching account info:",w),o(w.message),r({account_type:"user",subscription_tier:"free",verified:!1,verification_level:"none"});else{const b={account_type:_.account_type||"user",subscription_tier:_.subscription_tier||"free",verified:_.verified||!1,verification_level:_.verification_level||"none",business_info:_.business_info};r(b),Do.set(v,b,Iv.USER_PROFILE)}}catch(v){wn.error(" useAccountType: Error in fetchAccountInfo:",v),o("Failed to fetch account information"),r({account_type:"user",subscription_tier:"free",verified:!1,verification_level:"none"})}finally{a(!1)}});return{accountInfo:t,loading:n,error:i,hasAnalyticsAccess:()=>t?["creator","business","admin"].includes(t.account_type):!1,isAdmin:()=>(t==null?void 0:t.account_type)==="admin",isCreator:()=>(t==null?void 0:t.account_type)==="creator",isBusiness:()=>(t==null?void 0:t.account_type)==="business",isRegularUser:()=>(t==null?void 0:t.account_type)==="user",hasPremiumFeatures:()=>t?["premium","professional","enterprise"].includes(t.subscription_tier):!1,getAnalyticsDashboardRoute:()=>{if(!t)return null;switch(t.account_type){case"creator":return"/analytics/creator";case"business":return"/analytics/business";case"admin":return"/analytics/admin";default:return null}},refetch:l}}const He=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx("div",M({ref:r,className:ke("synth-card synth-hover-lift",e)},t))});He.displayName="Card";const Er=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx("div",M({ref:r,className:ke("flex flex-col space-y-1.5 p-6 relative",e)},t))});Er.displayName="CardHeader";const qr=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx("h3",M({ref:r,className:ke("text-2xl font-semibold leading-none tracking-tight synth-heading",e)},t))});qr.displayName="CardTitle";const uc=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx("p",M({ref:r,className:ke("text-sm text-muted-foreground synth-text",e)},t))});uc.displayName="CardDescription";const et=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx("div",M({ref:r,className:ke("p-6 pt-0 relative",e)},t))});et.displayName="CardContent";const Die=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx("div",M({ref:r,className:ke("flex items-center p-6 pt-0 relative",e)},t))});Die.displayName="CardFooter";const GP=lp("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 synth-focus",{variants:{variant:{default:"btn-synth-primary",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 hover:shadow-lg hover:shadow-destructive/25 hover:-translate-y-0.5",outline:"btn-synth-secondary",secondary:"btn-synth-secondary",ghost:"btn-ghost",link:"text-primary underline-offset-4 hover:underline",synth:"btn-synth-primary","synth-secondary":"btn-synth-secondary"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-lg px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),le=x.forwardRef((o,i)=>{var l=o,{className:e,variant:t,size:r,asChild:n=!1}=l,a=me(l,["className","variant","size","asChild"]);const c=n?fJ:"button";return s.jsx(c,M({className:ke(GP({variant:t,size:r,className:e})),ref:i},a))});le.displayName="Button";var YP="Progress",KP=100,[Iie,kBe]=Os(YP),[$ie,Lie]=Iie(YP),m9=x.forwardRef((e,t)=>{const u=e,{__scopeProgress:r,value:n=null,max:a,getValueLabel:i=Fie}=u,o=me(u,["__scopeProgress","value","max","getValueLabel"]);(a||a===0)&&!r5(a)&&console.error(zie(`${a}`,"Progress"));const l=r5(a)?a:KP;n!==null&&!n5(n,l)&&console.error(Bie(`${n}`,"Progress"));const c=n5(n,l)?n:null,d=X_(c)?i(c,l):void 0;return s.jsx($ie,{scope:r,value:c,max:l,children:s.jsx(Ct.div,H(M({"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":X_(c)?c:void 0,"aria-valuetext":d,role:"progressbar","data-state":v9(c,l),"data-value":c!=null?c:void 0,"data-max":l},o),{ref:t}))})});m9.displayName=YP;var p9="ProgressIndicator",g9=x.forwardRef((e,t)=>{var o;const i=e,{__scopeProgress:r}=i,n=me(i,["__scopeProgress"]),a=Lie(p9,r);return s.jsx(Ct.div,H(M({"data-state":v9(a.value,a.max),"data-value":(o=a.value)!=null?o:void 0,"data-max":a.max},n),{ref:t}))});g9.displayName=p9;function Fie(e,t){return`${Math.round(e/t*100)}%`}function v9(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function X_(e){return typeof e=="number"}function r5(e){return X_(e)&&!isNaN(e)&&e>0}function n5(e,t){return X_(e)&&!isNaN(e)&&e<=t&&e>=0}function zie(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${KP}\`.`}function Bie(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${KP} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var y9=m9,Uie=g9;const xm=x.forwardRef((a,n)=>{var i=a,{className:e,value:t}=i,r=me(i,["className","value"]);return s.jsx(y9,H(M({ref:n,className:ke("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e)},r),{children:s.jsx(Uie,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}))});xm.displayName=y9.displayName;const qie=lp("inline-flex items-center border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ke(a){var i=a,{className:e,variant:t,style:r}=i,n=me(i,["className","variant","style"]);return s.jsx("div",M({className:ke(qie({variant:t}),e),style:M({borderRadius:"var(--radius-corner, 10px)",height:"22px"},r)},n))}function Vie(e){switch(e){case"business":return{icon:$Q,colors:{from:"#3B82F6",to:"#2563EB",text:"text-blue-600"},label:"Verified Business",description:"This is a verified business account with confirmed venue or promoter credentials."};case"creator":return{icon:Qt,colors:{from:"#A855F7",to:"#9333EA",text:"text-purple-600"},label:"Verified Creator",description:"This is a verified creator account with confirmed artist or influencer credentials."};case"admin":return{icon:sh,colors:{from:"#F59E0B",to:"#D97706",text:"text-amber-600"},label:"Admin",description:"This is an official Synth platform administrator."};case"user":default:return{icon:dc,colors:{from:"#10B981",to:"#059669",text:"text-emerald-600"},label:"Verified User",description:"This user has met trust and safety criteria for verification."}}}function s5(e,t=0,r=0,n=0,a=0){const i={profileComplete:!!(e.name&&e.bio&&e.avatar_url&&e.birthday&&e.gender),streamingConnected:!!e.music_streaming_profile,hasReviews:t>=3,hasFriends:r>=10,hasEvents:n>=10,accountAge:e.created_at?new Date().getTime()-new Date(e.created_at).getTime()>=2592e6:!1,emailVerified:!0,hasAttended:a>=3},o=Object.values(i).filter(Boolean).length,l=Object.keys(i).length,c=Math.round(o/l*100),d=o>=4;return{score:c,criteriaMet:o,totalCriteria:l,criteria:i,isVerified:d}}function Wie(e){const t=["name","bio","avatar_url","birthday","gender"];let r=0;for(const n of t)e[n]&&r++;return Math.round(r/t.length*100)}function Hie(e,t,r){let n;return e==="profileComplete"&&t&&(n=Wie(t)),{profileComplete:{label:"Complete Profile",description:"Fill out your name, bio, avatar, birthday, and gender",target:n!==void 0?`${n}% complete`:"100% complete"},streamingConnected:{label:"Streaming Account",description:"Connect your Spotify or Apple Music account",target:"Connected"},hasReviews:{label:"Event Reviews",description:"Share your concert experiences by posting reviews",target:"3+ reviews"},hasFriends:{label:"Friend Network",description:"Build your network by connecting with other users",target:r!==void 0?`${r}+ friends`:"10+ friends"},hasEvents:{label:"Event Interests",description:"Show interest in concerts you want to attend",target:"10+ events"},accountAge:{label:"Account Age",description:"Be an active member of the community",target:"30+ days"},emailVerified:{label:"Email Verified",description:"Verify your email address",target:"Verified"},hasAttended:{label:"Event Attendance",description:"Attend and review concerts",target:"3+ attended"}}[e]}class J_{static checkVerificationStatus(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("users").select("account_type").eq("user_id",t).single();if(n||!r)throw new Error("User not found");const{data:a,error:i}=yield T.from("user_verifications").select("*").eq("user_id",t).single();if(r.account_type!=="user")return(i||!a)&&(yield T.from("user_verifications").upsert({user_id:t,verified:!0,verification_level:"premium",trust_score:100})),{verified:(a==null?void 0:a.verified)||!0,trustScore:(a==null?void 0:a.trust_score)||100,criteriaMet:8};const{count:o}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t),{count:l}=yield T.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`),{count:c}=yield T.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("user_id",t).in("relationship_type",["interested","going","maybe"]),{count:d}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("was_there",!0),{data:u,error:f}=yield T.from("users_complete").select("*").eq("user_id",t).single();if(f||!u)throw console.error("Error fetching profile for trust score calculation:",f),new Error("Profile not found for trust score calculation");const h=s5(u,o||0,l||0,c||0,d||0),{error:p}=yield T.from("user_verifications").upsert({user_id:t,trust_score:h.score,verification_criteria_met:h.criteria,verified:h.isVerified,verified_at:h.isVerified&&!(a!=null&&a.verified_at)?new Date().toISOString():a==null?void 0:a.verified_at});return p&&console.error("Error updating verification status:",p),{verified:h.isVerified,trustScore:h.score,criteriaMet:h.criteriaMet}}catch(r){throw console.error("Error checking verification status:",r),r}})}static getTrustScoreBreakdown(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("users_complete").select("*").eq("user_id",t).single();if(n||!r)throw new Error("Profile not found");const{count:a}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t),{count:i}=yield T.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`),{count:o}=yield T.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("user_id",t).in("relationship_type",["interested","going","maybe"]),{count:l}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("was_there",!0),c=s5(r,a||0,i||0,o||0,l||0);return H(M({},c),{profile:r,friendCount:i||0})}catch(r){throw console.error("Error getting trust score breakdown:",r),r}})}static refreshVerificationStatus(t){return E(this,null,function*(){yield this.checkVerificationStatus(t)})}static manuallyVerifyUser(t,r,n){return E(this,null,function*(){try{const{data:a}=yield T.from("users").select("account_type").eq("user_id",r).single();if((a==null?void 0:a.account_type)!=="admin")throw new Error("Only admins can manually verify users");const{error:i}=yield T.from("user_verifications").upsert({user_id:t,verified:n,verified_by:n?r:null,verified_at:n?new Date().toISOString():null});if(i)throw i}catch(a){throw console.error("Error manually verifying user:",a),a}})}static getUsersNearVerification(t=50){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("users").select(`
          *,
          user_verifications!inner (
            verified,
            trust_score,
            verification_level
          )
        `).eq("account_type","user").eq("user_verifications.verified",!1).gte("user_verifications.trust_score",40).order("user_verifications.trust_score",{ascending:!1}).limit(t);if(n)throw n;return r||[]}catch(r){throw console.error("Error getting users near verification:",r),r}})}}function Gie(e){const[t,r]=x.useState(null),[n,a]=x.useState(!0),[i,o]=x.useState(null);return x.useEffect(()=>{if(!e){r(null),a(!1);return}let l=!0;return E(this,null,function*(){try{a(!0);const d=yield J_.getTrustScoreBreakdown(e);if(!l)return;r(d),o(null)}catch(d){if(!l)return;o(d instanceof Error?d.message:"Unknown error")}finally{l&&a(!1)}}),()=>{l=!1}},[e]),{breakdown:t,loading:n,error:i}}function x9({userId:e,accountType:t,verified:r}){const{breakdown:n,loading:a,error:i}=Gie(e),[o,l]=x.useState(!1),{toast:c}=Rr();if(t!=="user")return r?s.jsxs(He,{children:[s.jsxs(Er,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ol,{className:"w-5 h-5 text-primary"}),s.jsx(qr,{children:"Verified Account"})]}),s.jsxs(uc,{children:["Your ",t," account is verified and trusted by the Synth community."]})]}),s.jsx(et,{children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(dc,{className:"w-16 h-16 text-green-500"})})})]}):s.jsx(He,{children:s.jsxs(Er,{children:[s.jsx(qr,{children:"Verification Status"}),s.jsx(uc,{children:"Verification details are not available for this account type."})]})});const d=()=>E(this,null,function*(){try{l(!0),yield J_.refreshVerificationStatus(e),c({title:"Status Updated",description:"Your verification status has been refreshed."})}catch(f){c({title:"Error",description:"Failed to refresh verification status.",variant:"destructive"})}finally{l(!1)}});if(a)return s.jsxs(He,{children:[s.jsx(Er,{children:s.jsx(qr,{children:"Verification Status"})}),s.jsx(et,{children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]});if(i||!n||!e)return s.jsx(He,{children:s.jsxs(Er,{children:[s.jsx(qr,{children:"Verification Status"}),s.jsx(uc,{children:"Verification details are currently unavailable."})]})});const u=n.criteriaMet/n.totalCriteria*100;return s.jsxs(He,{children:[s.jsx(Er,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs(qr,{className:"flex items-center gap-2",children:["Verification Status",r&&s.jsx(dc,{className:"w-5 h-5 text-green-500"})]}),s.jsx(uc,{children:r?"You are a verified member of the Synth community":"Complete criteria to earn verification"})]}),s.jsx(le,{variant:"ghost",size:"sm",onClick:d,disabled:o,children:s.jsx(mi,{className:`w-4 h-4 ${o?"animate-spin":""}`})})]})}),s.jsxs(et,{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Trust Score"}),s.jsxs("span",{className:"text-2xl font-bold text-primary",children:[n.score,"%"]})]}),s.jsx(xm,{value:u,className:"h-2"}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.criteriaMet," of ",n.totalCriteria," criteria met",!r&&n.criteriaMet<4&&s.jsxs(s.Fragment,{children:["  ",4-n.criteriaMet," more needed for verification"]})]})]}),r&&s.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(dc,{className:"w-8 h-8 text-green-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-green-900",children:"Verified User"}),s.jsx("p",{className:"text-sm text-green-700",children:"You have earned the trusted user badge"})]})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-semibold text-sm",children:"Verification Criteria"}),Object.entries(n.criteria).map(([f,h])=>{const p=Hie(f,n.profile,n.friendCount);return s.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg border ${h?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[s.jsx("div",{className:"flex-shrink-0 mt-0.5",children:h?s.jsx(dc,{className:"w-5 h-5 text-green-600"}):s.jsx(SF,{className:"w-5 h-5 text-gray-400"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("h5",{className:"font-medium text-sm",children:p.label}),s.jsx(Ke,{variant:h?"default":"secondary",className:"text-xs",children:p.target})]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:p.description})]})]},f)})]}),!r&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-sm text-blue-900 mb-2",children:"Tips to Get Verified"}),s.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[s.jsx("li",{children:" Complete your profile with all information"}),s.jsx("li",{children:" Connect your music streaming account"}),s.jsx("li",{children:" Post reviews for concerts you attend"}),s.jsx("li",{children:" Build your friend network"}),s.jsx("li",{children:" Mark concerts you're interested in"})]})]})]})]})}const _9=({isOpen:e,onClose:t,onToggle:r,onNavigateToNotifications:n,onNavigateToProfile:a,onNavigateToSettings:i,onNavigateToVerification:o,onSignOut:l})=>{var _;const c=as(),{user:d}=xs(),{accountInfo:u}=ih(),[f,h]=x.useState(null);x.useEffect(()=>{E(void 0,null,function*(){if(e){if(!d){h(null);return}try{const{data:b,error:N}=yield T.from("users").select("name, username, avatar_url").eq("user_id",d.id).maybeSingle();if(N&&N.code==="PGRST116"){const{data:S}=yield T.from("users").select("name, username, avatar_url").eq("id",d.id).maybeSingle();h(S||null)}else h(N?null:b||null)}catch(b){console.error("SideMenu: Error fetching user profile",b),h(null)}}})},[e,d]);const p=w=>{if(!w)return"?";const b=w.trim();return b?b[0].toUpperCase():"?"},g=w=>{w.target===w.currentTarget&&t()},v=()=>{t(),r&&r()},y=()=>E(void 0,null,function*(){if(t(),l)yield l();else{try{yield T.auth.signOut()}catch(w){console.error("Error signing out:",w)}c("/")}});return e?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"side-menu__overlay",onClick:g,"aria-hidden":"true"}),s.jsxs("aside",{className:"side-menu__drawer",role:"dialog","aria-modal":"true","aria-label":"Navigation menu",children:[s.jsx("div",{className:"side-menu__safe-area-spacer"}),s.jsx("div",{className:"side-menu__header-bar",children:s.jsx("button",{className:"side-menu__close-button",onClick:v,"aria-label":"Close menu",type:"button",children:s.jsx(Se,{name:"x",size:24,alt:""})})}),s.jsxs("div",{className:"side-menu__content",children:[s.jsx("div",{className:"side-menu__user-info-section",children:s.jsx(oc,{variant:"user",name:(f==null?void 0:f.name)||((_=d==null?void 0:d.email)==null?void 0:_.split("@")[0])||"User",username:(f==null?void 0:f.username)||void 0,initial:p((f==null?void 0:f.name)||(d==null?void 0:d.email)),imageUrl:(f==null?void 0:f.avatar_url)||void 0})}),s.jsxs("div",{className:"side-menu__list",children:[s.jsx(Pu,{label:"Notifications",icon:"bell",onPress:()=>{n==null||n(),t()}}),s.jsx(Pu,{label:"Event Timeline",icon:"music",onPress:()=>{a&&(sessionStorage.setItem("profileTab","timeline"),a(void 0,"timeline")),t()}}),s.jsx(Pu,{label:"Interested",icon:"heart",onPress:()=>{a&&(sessionStorage.setItem("profileTab","interested"),a(void 0,"interested")),t()}}),s.jsx(Pu,{label:"Settings",icon:"settings",onPress:()=>{i==null||i(),t()}})]}),d&&u&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"side-menu__section-divider","aria-hidden":"true"}),s.jsx("div",{className:"side-menu__verification-section",children:s.jsx(x9,{userId:d.id,accountType:u.account_type||"user",verified:u.verified||!1})}),s.jsx("div",{className:"side-menu__verification-divider","aria-hidden":"true"})]}),s.jsx("div",{className:"side-menu__logout-section",children:s.jsx(Sn,{variant:"primary",size:"standard",fullWidth:!0,onClick:y,children:"Log out"})})]})]})]}):null},a5=({currentView:e,onViewChange:t,onOpenEventReview:r})=>{const n=e==="feed",a=e==="search",i=e==="chat",o=e==="profile",l=[{id:"home",label:"Home",icon:n?"houseSelected":"house",onClick:()=>t("feed"),isActive:n},{id:"discover",label:"Discover",icon:a?"discoverSelected":"discover",onClick:()=>t("search"),isActive:a},{id:"post",label:"Post",icon:"plus",onClick:()=>{r?r():t("search")},isCTA:!0},{id:"messages",label:"Messages",icon:i?"circleCommentSelected":"circleComment",onClick:()=>t("chat"),isActive:i},{id:"profile",label:"Profile",icon:o?"userSelected":"user",onClick:()=>t("profile"),isActive:o}];return s.jsx("nav",{className:"bottom-nav",role:"navigation","aria-label":"Main navigation",children:s.jsx("div",{className:"bottom-nav__container",children:l.map(c=>c.isCTA?s.jsx("button",{className:"bottom-nav__item bottom-nav__item--cta",onClick:c.onClick,"aria-label":c.label,"aria-current":c.isActive?"page":void 0,type:"button",children:s.jsx(Se,{name:c.icon,size:24,alt:""})},c.id):s.jsx("button",{className:`bottom-nav__item ${c.isActive?"bottom-nav__item--active":""}`,onClick:c.onClick,"aria-label":c.label,"aria-current":c.isActive?"page":void 0,type:"button",children:s.jsx(Se,{name:c.icon,size:24,alt:""})},c.id))})})},w9=e=>{x.useEffect(()=>{if(e){const t=window.scrollY;return document.body.style.position="fixed",document.body.style.top=`-${t}px`,document.body.style.width="100%",document.body.style.overflow="hidden",()=>{document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,t)}}},[e])};var AN="focusScope.autoFocusOnMount",RN="focusScope.autoFocusOnUnmount",i5={bubbles:!1,cancelable:!0},Yie="FocusScope",qy=x.forwardRef((e,t)=>{const v=e,{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i}=v,o=me(v,["loop","trapped","onMountAutoFocus","onUnmountAutoFocus"]),[l,c]=x.useState(null),d=gs(a),u=gs(i),f=x.useRef(null),h=cr(t,y=>c(y)),p=x.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;x.useEffect(()=>{if(n){let y=function(N){if(p.paused||!l)return;const S=N.target;l.contains(S)?f.current=S:rd(f.current,{select:!0})},_=function(N){if(p.paused||!l)return;const S=N.relatedTarget;S!==null&&(l.contains(S)||rd(f.current,{select:!0}))},w=function(N){if(document.activeElement===document.body)for(const k of N)k.removedNodes.length>0&&rd(l)};document.addEventListener("focusin",y),document.addEventListener("focusout",_);const b=new MutationObserver(w);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",_),b.disconnect()}}},[n,l,p.paused]),x.useEffect(()=>{if(l){l5.add(p);const y=document.activeElement;if(!l.contains(y)){const w=new CustomEvent(AN,i5);l.addEventListener(AN,d),l.dispatchEvent(w),w.defaultPrevented||(Kie(eoe(b9(l)),{select:!0}),document.activeElement===y&&rd(l))}return()=>{l.removeEventListener(AN,d),setTimeout(()=>{const w=new CustomEvent(RN,i5);l.addEventListener(RN,u),l.dispatchEvent(w),w.defaultPrevented||rd(y!=null?y:document.body,{select:!0}),l.removeEventListener(RN,u),l5.remove(p)},0)}}},[l,d,u,p]);const g=x.useCallback(y=>{if(!r&&!n||p.paused)return;const _=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,w=document.activeElement;if(_&&w){const b=y.currentTarget,[N,S]=Zie(b);N&&S?!y.shiftKey&&w===S?(y.preventDefault(),r&&rd(N,{select:!0})):y.shiftKey&&w===N&&(y.preventDefault(),r&&rd(S,{select:!0})):w===b&&y.preventDefault()}},[r,n,p.paused]);return s.jsx(Ct.div,H(M({tabIndex:-1},o),{ref:h,onKeyDown:g}))});qy.displayName=Yie;function Kie(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(rd(n,{select:t}),document.activeElement!==r)return}function Zie(e){const t=b9(e),r=o5(t,e),n=o5(t.reverse(),e);return[r,n]}function b9(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function o5(e,t){for(const r of e)if(!Xie(r,{upTo:t}))return r}function Xie(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Jie(e){return e instanceof HTMLInputElement&&"select"in e}function rd(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Jie(e)&&t&&e.select()}}var l5=Qie();function Qie(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=c5(e,t),e.unshift(t)},remove(t){var r;e=c5(e,t),(r=e[0])==null||r.resume()}}}function c5(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function eoe(e){return e.filter(t=>t.tagName!=="A")}var ON=0;function t1(){x.useEffect(()=>{var t,r;const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=e[0])!=null?t:d5()),document.body.insertAdjacentElement("beforeend",(r=e[1])!=null?r:d5()),ON++,()=>{ON===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),ON--}},[])}function d5(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var pl=function(){return pl=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},pl.apply(this,arguments)};function j9(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function toe(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}var i_="right-scroll-bar-position",o_="width-before-scroll-bar",roe="with-scroll-bars-hidden",noe="--removed-body-scroll-bar-size";function MN(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function soe(e,t){var r=x.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var aoe=typeof window!="undefined"?x.useLayoutEffect:x.useEffect,u5=new WeakMap;function ioe(e,t){var r=soe(null,function(n){return e.forEach(function(a){return MN(a,n)})});return aoe(function(){var n=u5.get(r);if(n){var a=new Set(n),i=new Set(e),o=r.current;a.forEach(function(l){i.has(l)||MN(l,null)}),i.forEach(function(l){a.has(l)||MN(l,o)})}u5.set(r,e)},[e]),r}function ooe(e){return e}function loe(e,t){t===void 0&&(t=ooe);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var o=t(i,n);return r.push(o),function(){r=r.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(n=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(l){return i(l)},filter:function(){return r}}},assignMedium:function(i){n=!0;var o=[];if(r.length){var l=r;r=[],l.forEach(i),o=r}var c=function(){var u=o;o=[],u.forEach(i)},d=function(){return Promise.resolve().then(c)};d(),r={push:function(u){o.push(u),d()},filter:function(u){return o=o.filter(u),r}}}};return a}function coe(e){e===void 0&&(e={});var t=loe(null);return t.options=pl({async:!0,ssr:!1},e),t}var N9=function(e){var t=e.sideCar,r=j9(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return x.createElement(n,pl({},r))};N9.isSideCarExport=!0;function doe(e,t){return e.useMedium(t),N9}var S9=coe(),DN=function(){},r1=x.forwardRef(function(e,t){var r=x.useRef(null),n=x.useState({onScrollCapture:DN,onWheelCapture:DN,onTouchMoveCapture:DN}),a=n[0],i=n[1],o=e.forwardProps,l=e.children,c=e.className,d=e.removeScrollBar,u=e.enabled,f=e.shards,h=e.sideCar,p=e.noRelative,g=e.noIsolation,v=e.inert,y=e.allowPinchZoom,_=e.as,w=_===void 0?"div":_,b=e.gapMode,N=j9(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=h,k=ioe([r,t]),P=pl(pl({},N),a);return x.createElement(x.Fragment,null,u&&x.createElement(S,{sideCar:S9,removeScrollBar:d,shards:f,noRelative:p,noIsolation:g,inert:v,setCallbacks:i,allowPinchZoom:!!y,lockRef:r,gapMode:b}),o?x.cloneElement(x.Children.only(l),pl(pl({},P),{ref:k})):x.createElement(w,pl({},P,{className:c,ref:k}),l))});r1.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};r1.classNames={fullWidth:o_,zeroRight:i_};var uoe=function(){if(typeof __webpack_nonce__!="undefined")return __webpack_nonce__};function hoe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=uoe();return t&&e.setAttribute("nonce",t),e}function foe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function moe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var poe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=hoe())&&(foe(t,r),moe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},goe=function(){var e=poe();return function(t,r){x.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},k9=function(){var e=goe(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},voe={left:0,top:0,right:0,gap:0},IN=function(e){return parseInt(e||"",10)||0},yoe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[IN(r),IN(n),IN(a)]},xoe=function(e){if(e===void 0&&(e="margin"),typeof window=="undefined")return voe;var t=yoe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},_oe=k9(),Vf="data-scroll-locked",woe=function(e,t,r,n){var a=e.left,i=e.top,o=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(roe,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(Vf,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(i_,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(o_,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(i_," .").concat(i_,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(o_," .").concat(o_,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Vf,`] {
    `).concat(noe,": ").concat(l,`px;
  }
`)},h5=function(){var e=parseInt(document.body.getAttribute(Vf)||"0",10);return isFinite(e)?e:0},boe=function(){x.useEffect(function(){return document.body.setAttribute(Vf,(h5()+1).toString()),function(){var e=h5()-1;e<=0?document.body.removeAttribute(Vf):document.body.setAttribute(Vf,e.toString())}},[])},joe=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;boe();var i=x.useMemo(function(){return xoe(a)},[a]);return x.createElement(_oe,{styles:woe(i,!t,a,r?"":"!important")})},f2=!1;if(typeof window!="undefined")try{var p0=Object.defineProperty({},"passive",{get:function(){return f2=!0,!0}});window.addEventListener("test",p0,p0),window.removeEventListener("test",p0,p0)}catch(e){f2=!1}var Kh=f2?{passive:!1}:!1,Noe=function(e){return e.tagName==="TEXTAREA"},E9=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Noe(e)&&r[t]==="visible")},Soe=function(e){return E9(e,"overflowY")},koe=function(e){return E9(e,"overflowX")},f5=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot!="undefined"&&n instanceof ShadowRoot&&(n=n.host);var a=C9(e,n);if(a){var i=P9(e,n),o=i[1],l=i[2];if(o>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Eoe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Coe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},C9=function(e,t){return e==="v"?Soe(t):koe(t)},P9=function(e,t){return e==="v"?Eoe(t):Coe(t)},Poe=function(e,t){return e==="h"&&t==="rtl"?-1:1},Toe=function(e,t,r,n,a){var i=Poe(e,window.getComputedStyle(t).direction),o=i*n,l=r.target,c=t.contains(l),d=!1,u=o>0,f=0,h=0;do{if(!l)break;var p=P9(e,l),g=p[0],v=p[1],y=p[2],_=v-y-i*g;(g||_)&&C9(e,l)&&(f+=_,h+=g);var w=l.parentNode;l=w&&w.nodeType===Node.DOCUMENT_FRAGMENT_NODE?w.host:w}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(u&&(Math.abs(f)<1||!a)||!u&&(Math.abs(h)<1||!a))&&(d=!0),d},g0=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},m5=function(e){return[e.deltaX,e.deltaY]},p5=function(e){return e&&"current"in e?e.current:e},Aoe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Roe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Ooe=0,Zh=[];function Moe(e){var t=x.useRef([]),r=x.useRef([0,0]),n=x.useRef(),a=x.useState(Ooe++)[0],i=x.useState(k9)[0],o=x.useRef(e);x.useEffect(function(){o.current=e},[e]),x.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var v=toe([e.lockRef.current],(e.shards||[]).map(p5),!0).filter(Boolean);return v.forEach(function(y){return y.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),v.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var l=x.useCallback(function(v,y){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!o.current.allowPinchZoom;var _=g0(v),w=r.current,b="deltaX"in v?v.deltaX:w[0]-_[0],N="deltaY"in v?v.deltaY:w[1]-_[1],S,k=v.target,P=Math.abs(b)>Math.abs(N)?"h":"v";if("touches"in v&&P==="h"&&k.type==="range")return!1;var A=f5(P,k);if(!A)return!0;if(A?S=P:(S=P==="v"?"h":"v",A=f5(P,k)),!A)return!1;if(!n.current&&"changedTouches"in v&&(b||N)&&(n.current=S),!S)return!0;var R=n.current||S;return Toe(R,y,v,R==="h"?b:N,!0)},[]),c=x.useCallback(function(v){var y=v;if(!(!Zh.length||Zh[Zh.length-1]!==i)){var _="deltaY"in y?m5(y):g0(y),w=t.current.filter(function(S){return S.name===y.type&&(S.target===y.target||y.target===S.shadowParent)&&Aoe(S.delta,_)})[0];if(w&&w.should){y.cancelable&&y.preventDefault();return}if(!w){var b=(o.current.shards||[]).map(p5).filter(Boolean).filter(function(S){return S.contains(y.target)}),N=b.length>0?l(y,b[0]):!o.current.noIsolation;N&&y.cancelable&&y.preventDefault()}}},[]),d=x.useCallback(function(v,y,_,w){var b={name:v,delta:y,target:_,should:w,shadowParent:Doe(_)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(N){return N!==b})},1)},[]),u=x.useCallback(function(v){r.current=g0(v),n.current=void 0},[]),f=x.useCallback(function(v){d(v.type,m5(v),v.target,l(v,e.lockRef.current))},[]),h=x.useCallback(function(v){d(v.type,g0(v),v.target,l(v,e.lockRef.current))},[]);x.useEffect(function(){return Zh.push(i),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:h}),document.addEventListener("wheel",c,Kh),document.addEventListener("touchmove",c,Kh),document.addEventListener("touchstart",u,Kh),function(){Zh=Zh.filter(function(v){return v!==i}),document.removeEventListener("wheel",c,Kh),document.removeEventListener("touchmove",c,Kh),document.removeEventListener("touchstart",u,Kh)}},[]);var p=e.removeScrollBar,g=e.inert;return x.createElement(x.Fragment,null,g?x.createElement(i,{styles:Roe(a)}):null,p?x.createElement(joe,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function Doe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Ioe=doe(S9,Moe);var Vy=x.forwardRef(function(e,t){return x.createElement(r1,pl({},e,{ref:t,sideCar:Ioe}))});Vy.classNames=r1.classNames;var $oe=function(e){if(typeof document=="undefined")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Xh=new WeakMap,v0=new WeakMap,y0={},$N=0,T9=function(e){return e&&(e.host||T9(e.parentNode))},Loe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=T9(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Foe=function(e,t,r,n){var a=Loe(t,Array.isArray(e)?e:[e]);y0[r]||(y0[r]=new WeakMap);var i=y0[r],o=[],l=new Set,c=new Set(a),d=function(f){!f||l.has(f)||(l.add(f),d(f.parentNode))};a.forEach(d);var u=function(f){!f||c.has(f)||Array.prototype.forEach.call(f.children,function(h){if(l.has(h))u(h);else try{var p=h.getAttribute(n),g=p!==null&&p!=="false",v=(Xh.get(h)||0)+1,y=(i.get(h)||0)+1;Xh.set(h,v),i.set(h,y),o.push(h),v===1&&g&&v0.set(h,!0),y===1&&h.setAttribute(r,"true"),g||h.setAttribute(n,"true")}catch(_){console.error("aria-hidden: cannot operate on ",h,_)}})};return u(t),l.clear(),$N++,function(){o.forEach(function(f){var h=Xh.get(f)-1,p=i.get(f)-1;Xh.set(f,h),i.set(f,p),h||(v0.has(f)||f.removeAttribute(n),v0.delete(f)),p||f.removeAttribute(r)}),$N--,$N||(Xh=new WeakMap,Xh=new WeakMap,v0=new WeakMap,y0={})}},n1=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=$oe(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live]"))),Foe(n,a,r,"aria-hidden")):function(){return null}},s1="Dialog",[A9,R9]=Os(s1),[zoe,Zo]=A9(s1),O9=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:o=!0}=e,l=x.useRef(null),c=x.useRef(null),[d,u]=Wa({prop:n,defaultProp:a!=null?a:!1,onChange:i,caller:s1});return s.jsx(zoe,{scope:t,triggerRef:l,contentRef:c,contentId:Ps(),titleId:Ps(),descriptionId:Ps(),open:d,onOpenChange:u,onOpenToggle:x.useCallback(()=>u(f=>!f),[u]),modal:o,children:r})};O9.displayName=s1;var M9="DialogTrigger",D9=x.forwardRef((e,t)=>{const o=e,{__scopeDialog:r}=o,n=me(o,["__scopeDialog"]),a=Zo(M9,r),i=cr(t,a.triggerRef);return s.jsx(Ct.button,H(M({type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":JP(a.open)},n),{ref:i,onClick:pt(e.onClick,a.onOpenToggle)}))});D9.displayName=M9;var ZP="DialogPortal",[Boe,I9]=A9(ZP,{forceMount:void 0}),$9=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,i=Zo(ZP,t);return s.jsx(Boe,{scope:t,forceMount:r,children:x.Children.map(n,o=>s.jsx(Ys,{present:r||i.open,children:s.jsx(op,{asChild:!0,container:a,children:o})}))})};$9.displayName=ZP;var Q_="DialogOverlay",L9=x.forwardRef((e,t)=>{const r=I9(Q_,e.__scopeDialog),o=e,{forceMount:n=r.forceMount}=o,a=me(o,["forceMount"]),i=Zo(Q_,e.__scopeDialog);return i.modal?s.jsx(Ys,{present:n||i.open,children:s.jsx(qoe,H(M({},a),{ref:t}))}):null});L9.displayName=Q_;var Uoe=$d("DialogOverlay.RemoveScroll"),qoe=x.forwardRef((e,t)=>{const i=e,{__scopeDialog:r}=i,n=me(i,["__scopeDialog"]),a=Zo(Q_,r);return s.jsx(Vy,{as:Uoe,allowPinchZoom:!0,shards:[a.contentRef],children:s.jsx(Ct.div,H(M({"data-state":JP(a.open)},n),{ref:t,style:M({pointerEvents:"auto"},n.style)}))})}),oh="DialogContent",F9=x.forwardRef((e,t)=>{const r=I9(oh,e.__scopeDialog),o=e,{forceMount:n=r.forceMount}=o,a=me(o,["forceMount"]),i=Zo(oh,e.__scopeDialog);return s.jsx(Ys,{present:n||i.open,children:i.modal?s.jsx(Voe,H(M({},a),{ref:t})):s.jsx(Woe,H(M({},a),{ref:t}))})});F9.displayName=oh;var Voe=x.forwardRef((e,t)=>{const r=Zo(oh,e.__scopeDialog),n=x.useRef(null),a=cr(t,r.contentRef,n);return x.useEffect(()=>{const i=n.current;if(i)return n1(i)},[]),s.jsx(z9,H(M({},e),{ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:pt(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:pt(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:pt(e.onFocusOutside,i=>i.preventDefault())}))}),Woe=x.forwardRef((e,t)=>{const r=Zo(oh,e.__scopeDialog),n=x.useRef(!1),a=x.useRef(!1);return s.jsx(z9,H(M({},e),{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var c,d;(c=e.onInteractOutside)==null||c.call(e,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((d=r.triggerRef.current)==null?void 0:d.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}}))}),z9=x.forwardRef((e,t)=>{const u=e,{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i}=u,o=me(u,["__scopeDialog","trapFocus","onOpenAutoFocus","onCloseAutoFocus"]),l=Zo(oh,r),c=x.useRef(null),d=cr(t,c);return t1(),s.jsxs(s.Fragment,{children:[s.jsx(qy,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:s.jsx(wh,H(M({role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":JP(l.open)},o),{ref:d,onDismiss:()=>l.onOpenChange(!1)}))}),s.jsxs(s.Fragment,{children:[s.jsx(Goe,{titleId:l.titleId}),s.jsx(Koe,{contentRef:c,descriptionId:l.descriptionId})]})]})}),XP="DialogTitle",B9=x.forwardRef((e,t)=>{const i=e,{__scopeDialog:r}=i,n=me(i,["__scopeDialog"]),a=Zo(XP,r);return s.jsx(Ct.h2,H(M({id:a.titleId},n),{ref:t}))});B9.displayName=XP;var U9="DialogDescription",q9=x.forwardRef((e,t)=>{const i=e,{__scopeDialog:r}=i,n=me(i,["__scopeDialog"]),a=Zo(U9,r);return s.jsx(Ct.p,H(M({id:a.descriptionId},n),{ref:t}))});q9.displayName=U9;var V9="DialogClose",W9=x.forwardRef((e,t)=>{const i=e,{__scopeDialog:r}=i,n=me(i,["__scopeDialog"]),a=Zo(V9,r);return s.jsx(Ct.button,H(M({type:"button"},n),{ref:t,onClick:pt(e.onClick,()=>a.onOpenChange(!1))}))});W9.displayName=V9;function JP(e){return e?"open":"closed"}var H9="DialogTitleWarning",[Hoe,G9]=uJ(H9,{contentName:oh,titleName:XP,docsSlug:"dialog"}),Goe=({titleId:e})=>{const t=G9(H9),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return x.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},Yoe="DialogDescriptionWarning",Koe=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${G9(Yoe).contentName}}.`;return x.useEffect(()=>{var i;const a=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},a1=O9,Zoe=D9,i1=$9,gp=L9,vp=F9,Wy=B9,Hy=q9,o1=W9;const pn=a1,Xoe=i1,Y9=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(gp,M({ref:r,className:ke("fixed inset-0 z-[9999] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),style:M({backgroundColor:"var(--overlay-50, rgba(14, 14, 14, 0.5))"},t.style)},t))});Y9.displayName=gp.displayName;const dn=x.forwardRef((o,i)=>{var l=o,{className:e,children:t,hideCloseButton:r=!1,style:n}=l,a=me(l,["className","children","hideCloseButton","style"]);return s.jsxs(Xoe,{children:[s.jsx(Y9,{}),s.jsxs(vp,H(M({ref:i,className:ke("fixed z-[9999] grid gap-4 border bg-background shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg overflow-hidden flex flex-col",e),style:M({left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"calc(100vw - 40px)",maxWidth:"var(--size-popup-width, calc(100vw - 40px))",maxHeight:"calc(100vh - 40px)",backgroundColor:"var(--neutral-50)",border:"1px solid var(--neutral-200)",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 4px 12px 0 var(--shadow-color)",padding:0},n)},a),{children:[s.jsx("div",{style:{display:"flex",flexDirection:"column",height:"100%",maxHeight:"calc(100vh - 40px)",overflow:"hidden"},children:t}),!r&&s.jsxs(o1,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",style:{zIndex:10,width:"44px",height:"44px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"var(--neutral-50)",border:"1px solid var(--neutral-200)",borderRadius:"var(--radius-corner, 10px)",color:"var(--neutral-900)"},children:[s.jsx(Gr,{className:"h-5 w-5"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]}))]})});dn.displayName=vp.displayName;const Vn=r=>{var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("flex flex-col space-y-1.5",e),style:M({padding:"var(--spacing-grouped, 24px)",paddingBottom:"var(--spacing-small, 12px)",flexShrink:0},t.style)},t))};Vn.displayName="DialogHeader";const Nh=r=>{var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),style:M({padding:"var(--spacing-grouped, 24px)",paddingTop:"var(--spacing-small, 12px)",flexShrink:0},t.style)},t))};Nh.displayName="DialogFooter";const bn=x.forwardRef((a,n)=>{var i=a,{className:e,style:t}=i,r=me(i,["className","style"]);return s.jsx(Wy,M({ref:n,className:ke("leading-none tracking-tight",e),style:M({fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},t)},r))});bn.displayName=Wy.displayName;const os=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(Hy,M({ref:r,className:ke("text-sm text-muted-foreground",e)},t))});os.displayName=Hy.displayName;const K9=r=>{var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("flex-1 overflow-y-auto overflow-x-hidden",e),style:M({padding:"0 var(--spacing-grouped, 24px)",WebkitOverflowScrolling:"touch"},t.style)},t))};K9.displayName="DialogBody";var Z9={exports:{}},X9={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _m=x;function Joe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qoe=typeof Object.is=="function"?Object.is:Joe,ele=_m.useState,tle=_m.useEffect,rle=_m.useLayoutEffect,nle=_m.useDebugValue;function sle(e,t){var r=t(),n=ele({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return rle(function(){a.value=r,a.getSnapshot=t,LN(a)&&i({inst:a})},[e,r,t]),tle(function(){return LN(a)&&i({inst:a}),e(function(){LN(a)&&i({inst:a})})},[e]),nle(r),r}function LN(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Qoe(e,r)}catch(n){return!0}}function ale(e,t){return t()}var ile=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?ale:sle;X9.useSyncExternalStore=_m.useSyncExternalStore!==void 0?_m.useSyncExternalStore:ile;Z9.exports=X9;var ole=Z9.exports;function lle(){return ole.useSyncExternalStore(cle,()=>!0,()=>!1)}function cle(){return()=>{}}var QP="Avatar",[dle,EBe]=Os(QP),[ule,J9]=dle(QP),Q9=x.forwardRef((e,t)=>{const o=e,{__scopeAvatar:r}=o,n=me(o,["__scopeAvatar"]),[a,i]=x.useState("idle");return s.jsx(ule,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:i,children:s.jsx(Ct.span,H(M({},n),{ref:t}))})});Q9.displayName=QP;var e8="AvatarImage",t8=x.forwardRef((e,t)=>{const d=e,{__scopeAvatar:r,src:n,onLoadingStatusChange:a=()=>{}}=d,i=me(d,["__scopeAvatar","src","onLoadingStatusChange"]),o=J9(e8,r),l=hle(n,i),c=gs(u=>{a(u),o.onImageLoadingStatusChange(u)});return vs(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?s.jsx(Ct.img,H(M({},i),{ref:t,src:n})):null});t8.displayName=e8;var r8="AvatarFallback",n8=x.forwardRef((e,t)=>{const c=e,{__scopeAvatar:r,delayMs:n}=c,a=me(c,["__scopeAvatar","delayMs"]),i=J9(r8,r),[o,l]=x.useState(n===void 0);return x.useEffect(()=>{if(n!==void 0){const d=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(d)}},[n]),o&&i.imageLoadingStatus!=="loaded"?s.jsx(Ct.span,H(M({},a),{ref:t})):null});n8.displayName=r8;function g5(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function hle(e,{referrerPolicy:t,crossOrigin:r}){const n=lle(),a=x.useRef(null),i=n?(a.current||(a.current=new window.Image),a.current):null,[o,l]=x.useState(()=>g5(i,e));return vs(()=>{l(g5(i,e))},[i,e]),vs(()=>{const c=f=>()=>{l(f)};if(!i)return;const d=c("loaded"),u=c("error");return i.addEventListener("load",d),i.addEventListener("error",u),t&&(i.referrerPolicy=t),typeof r=="string"&&(i.crossOrigin=r),()=>{i.removeEventListener("load",d),i.removeEventListener("error",u)}},[i,r,t]),o}var s8=Q9,a8=t8,i8=n8;const Vr=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(s8,M({ref:r,className:ke("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e)},t))});Vr.displayName=s8.displayName;const sn=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(a8,M({ref:r,className:ke("aspect-square h-full w-full",e)},t))});sn.displayName=a8.displayName;const Wr=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(i8,M({ref:r,className:ke("flex h-full w-full items-center justify-center rounded-full bg-muted",e)},t))});Wr.displayName=i8.displayName;var fle=x.createContext(void 0);function Sh(e){const t=x.useContext(fle);return e||t||"ltr"}var FN="rovingFocusGroup.onEntryFocus",mle={bubbles:!1,cancelable:!0},Gy="RovingFocusGroup",[m2,o8,ple]=ip(Gy),[gle,l1]=Os(Gy,[ple]),[vle,yle]=gle(Gy),l8=x.forwardRef((e,t)=>s.jsx(m2.Provider,{scope:e.__scopeRovingFocusGroup,children:s.jsx(m2.Slot,{scope:e.__scopeRovingFocusGroup,children:s.jsx(xle,H(M({},e),{ref:t}))})}));l8.displayName=Gy;var xle=x.forwardRef((e,t)=>{const A=e,{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1}=A,f=me(A,["__scopeRovingFocusGroup","orientation","loop","dir","currentTabStopId","defaultCurrentTabStopId","onCurrentTabStopIdChange","onEntryFocus","preventScrollOnEntryFocus"]),h=x.useRef(null),p=cr(t,h),g=Sh(i),[v,y]=Wa({prop:o,defaultProp:l!=null?l:null,onChange:c,caller:Gy}),[_,w]=x.useState(!1),b=gs(d),N=o8(r),S=x.useRef(!1),[k,P]=x.useState(0);return x.useEffect(()=>{const R=h.current;if(R)return R.addEventListener(FN,b),()=>R.removeEventListener(FN,b)},[b]),s.jsx(vle,{scope:r,orientation:n,dir:g,loop:a,currentTabStopId:v,onItemFocus:x.useCallback(R=>y(R),[y]),onItemShiftTab:x.useCallback(()=>w(!0),[]),onFocusableItemAdd:x.useCallback(()=>P(R=>R+1),[]),onFocusableItemRemove:x.useCallback(()=>P(R=>R-1),[]),children:s.jsx(Ct.div,H(M({tabIndex:_||k===0?-1:0,"data-orientation":n},f),{ref:p,style:M({outline:"none"},e.style),onMouseDown:pt(e.onMouseDown,()=>{S.current=!0}),onFocus:pt(e.onFocus,R=>{const $=!S.current;if(R.target===R.currentTarget&&$&&!_){const O=new CustomEvent(FN,mle);if(R.currentTarget.dispatchEvent(O),!O.defaultPrevented){const z=N().filter(G=>G.focusable),D=z.find(G=>G.active),B=z.find(G=>G.id===v),U=[D,B,...z].filter(Boolean).map(G=>G.ref.current);u8(U,u)}}S.current=!1}),onBlur:pt(e.onBlur,()=>w(!1))}))})}),c8="RovingFocusGroupItem",d8=x.forwardRef((e,t)=>{const y=e,{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:i,children:o}=y,l=me(y,["__scopeRovingFocusGroup","focusable","active","tabStopId","children"]),c=Ps(),d=i||c,u=yle(c8,r),f=u.currentTabStopId===d,h=o8(r),{onFocusableItemAdd:p,onFocusableItemRemove:g,currentTabStopId:v}=u;return x.useEffect(()=>{if(n)return p(),()=>g()},[n,p,g]),s.jsx(m2.ItemSlot,{scope:r,id:d,focusable:n,active:a,children:s.jsx(Ct.span,H(M({tabIndex:f?0:-1,"data-orientation":u.orientation},l),{ref:t,onMouseDown:pt(e.onMouseDown,_=>{n?u.onItemFocus(d):_.preventDefault()}),onFocus:pt(e.onFocus,()=>u.onItemFocus(d)),onKeyDown:pt(e.onKeyDown,_=>{if(_.key==="Tab"&&_.shiftKey){u.onItemShiftTab();return}if(_.target!==_.currentTarget)return;const w=ble(_,u.orientation,u.dir);if(w!==void 0){if(_.metaKey||_.ctrlKey||_.altKey||_.shiftKey)return;_.preventDefault();let N=h().filter(S=>S.focusable).map(S=>S.ref.current);if(w==="last")N.reverse();else if(w==="prev"||w==="next"){w==="prev"&&N.reverse();const S=N.indexOf(_.currentTarget);N=u.loop?jle(N,S+1):N.slice(S+1)}setTimeout(()=>u8(N))}}),children:typeof o=="function"?o({isCurrentTabStop:f,hasTabStop:v!=null}):o}))})});d8.displayName=c8;var _le={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function wle(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ble(e,t,r){const n=wle(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return _le[n]}function u8(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function jle(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var h8=l8,f8=d8,c1="Tabs",[Nle,CBe]=Os(c1,[l1]),m8=l1(),[Sle,eT]=Nle(c1),p8=x.forwardRef((e,t)=>{const p=e,{__scopeTabs:r,value:n,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic"}=p,d=me(p,["__scopeTabs","value","onValueChange","defaultValue","orientation","dir","activationMode"]),u=Sh(l),[f,h]=Wa({prop:n,onChange:a,defaultProp:i!=null?i:"",caller:c1});return s.jsx(Sle,{scope:r,baseId:Ps(),value:f,onValueChange:h,orientation:o,dir:u,activationMode:c,children:s.jsx(Ct.div,H(M({dir:u,"data-orientation":o},d),{ref:t}))})});p8.displayName=c1;var g8="TabsList",v8=x.forwardRef((e,t)=>{const l=e,{__scopeTabs:r,loop:n=!0}=l,a=me(l,["__scopeTabs","loop"]),i=eT(g8,r),o=m8(r);return s.jsx(h8,H(M({asChild:!0},o),{orientation:i.orientation,dir:i.dir,loop:n,children:s.jsx(Ct.div,H(M({role:"tablist","aria-orientation":i.orientation},a),{ref:t}))}))});v8.displayName=g8;var y8="TabsTrigger",x8=x.forwardRef((e,t)=>{const f=e,{__scopeTabs:r,value:n,disabled:a=!1}=f,i=me(f,["__scopeTabs","value","disabled"]),o=eT(y8,r),l=m8(r),c=b8(o.baseId,n),d=j8(o.baseId,n),u=n===o.value;return s.jsx(f8,H(M({asChild:!0},l),{focusable:!a,active:u,children:s.jsx(Ct.button,H(M({type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c},i),{ref:t,onMouseDown:pt(e.onMouseDown,h=>{!a&&h.button===0&&h.ctrlKey===!1?o.onValueChange(n):h.preventDefault()}),onKeyDown:pt(e.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(n)}),onFocus:pt(e.onFocus,()=>{const h=o.activationMode!=="manual";!u&&!a&&h&&o.onValueChange(n)})}))}))});x8.displayName=y8;var _8="TabsContent",w8=x.forwardRef((e,t)=>{const h=e,{__scopeTabs:r,value:n,forceMount:a,children:i}=h,o=me(h,["__scopeTabs","value","forceMount","children"]),l=eT(_8,r),c=b8(l.baseId,n),d=j8(l.baseId,n),u=n===l.value,f=x.useRef(u);return x.useEffect(()=>{const p=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(p)},[]),s.jsx(Ys,{present:a||u,children:({present:p})=>s.jsx(Ct.div,H(M({"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!p,id:d,tabIndex:0},o),{ref:t,style:H(M({},e.style),{animationDuration:f.current?"0s":void 0}),children:p&&i}))})});w8.displayName=_8;function b8(e,t){return`${e}-trigger-${t}`}function j8(e,t){return`${e}-content-${t}`}var kle=p8,N8=v8,S8=x8,k8=w8;const Li=kle,yi=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(N8,M({ref:r,className:ke("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e)},t))});yi.displayName=N8.displayName;const Xr=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(S8,M({ref:r,className:ke("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e)},t))});Xr.displayName=S8.displayName;const Jr=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(k8,M({ref:r,className:ke("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e)},t))});Jr.displayName=k8.displayName;const ew=({size:e="md",className:t})=>{const r={sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16",xl:"w-24 h-24"};return s.jsx("div",{className:ke("inline-block",r[e],t),children:s.jsx("img",{src:"/Logos/Main logo black background.png",alt:"Synth Logo",className:"w-full h-full object-contain"})})};function zN(){return s.jsxs("div",{className:"synth-card relative w-full max-w-sm mx-auto overflow-hidden shadow-lg border border-white/20",role:"status","aria-label":"Loading content","aria-busy":"true",children:[s.jsxs("div",{className:"relative h-72 bg-gradient-to-br from-pink-50 via-white to-pink-100 animate-pulse",children:[s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx(ew,{size:"lg",className:"opacity-40 animate-breathe animate-float"})}),s.jsx("div",{className:"absolute top-4 left-4",children:s.jsx("div",{className:"w-20 h-6 bg-pink-200 animate-pulse rounded-full"})}),s.jsx("div",{className:"absolute top-4 right-4",children:s.jsx("div",{className:"w-16 h-6 bg-gradient-to-r from-pink-300 to-pink-400 animate-pulse rounded-full"})})]}),s.jsxs("div",{className:"p-6 space-y-5 bg-white",children:[s.jsxs("div",{children:[s.jsx("div",{className:"h-7 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-4/5 mb-3"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-50 to-white rounded animate-pulse w-3/4"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-50 to-white rounded animate-pulse w-1/2 mt-1"})]}),s.jsxs("div",{className:"space-y-3 bg-gradient-to-r from-pink-50/50 to-white rounded-xl p-4 border border-pink-100/50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 bg-pink-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-32"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 bg-pink-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-24"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 bg-pink-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-20"})]})]}),s.jsxs("div",{className:"flex gap-4 pt-2",children:[s.jsx("div",{className:"flex-1 h-14 bg-gradient-to-r from-gray-100 to-white rounded-lg animate-pulse border border-pink-100"}),s.jsx("div",{className:"flex-1 h-14 bg-gradient-to-r from-pink-200 to-pink-300 rounded-lg animate-pulse"})]})]}),s.jsx("span",{className:"sr-only",children:"Loading event details..."})]})}function E8({promotionTier:e,className:t=""}){const n=(i=>({icon:sh,text:"Promoted",className:"bg-gradient-to-r from-yellow-100 to-amber-100 text-yellow-800 border-yellow-300 hover:from-yellow-200 hover:to-amber-200 shadow-lg shadow-yellow-200/50",iconClassName:"text-yellow-600"}))(),a=n.icon;return s.jsxs(Ke,{variant:"secondary",className:`flex items-center gap-1 text-xs font-medium ${n.className} ${t}`,children:[s.jsx(a,{className:`w-3 h-3 ${n.iconClassName}`}),n.text]})}const Ele=({icon:e,title:t,description:r,action:n})=>s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6 text-center",children:[e&&s.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"var(--spacing-inline, 6px)"},children:s.jsx("div",{style:{color:"var(--neutral-600)"},children:e})}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,marginBottom:"var(--spacing-inline, 6px)",textAlign:"center"},children:t}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,maxWidth:"100%",textAlign:"center"},children:r}),n&&s.jsx("button",{onClick:n.onClick,className:"px-6 py-3 rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2",style:{marginTop:"var(--spacing-grouped, 24px)",backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},onMouseEnter:a=>{a.currentTarget.style.backgroundColor="var(--brand-pink-600)"},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="var(--brand-pink-500)"},onFocus:a=>{a.currentTarget.style.outline="2px solid var(--brand-pink-500)"},"aria-label":n.label,children:n.label})]});class v5{static getAvailableCities(t=1,r=1e3){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("city_centers").select("*").limit(r);return a?(console.warn(" city_centers table not available or has different structure, using events table:",a.message),yield this.getCitiesFromEvents(t,r)):!n||n.length===0?yield this.getCitiesFromEvents(t,r):n.map(i=>{const o=i.city_name||i.name||i.normalized_name||"";return{name:o,city_name:o,normalized_name:o,state:i.state||null,center_latitude:i.center_latitude?Number(i.center_latitude):i.latitude?Number(i.latitude):void 0,center_longitude:i.center_longitude?Number(i.center_longitude):i.longitude?Number(i.longitude):void 0,event_count:i.event_count||i.upcoming_events_count||0,aliases:[]}})}catch(n){return console.error("Error in getAvailableCities:",n),[]}})}static getCitiesFromEvents(t=1,r=1e3){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("events").select("venue_city, venue_state").not("venue_city","is",null).gte("event_date",new Date().toISOString());if(a)return console.error("Error fetching cities from events:",a),[];const i=new Map;return(n||[]).forEach(l=>{const c=l.venue_city?`${l.venue_city}${l.venue_state?`, ${l.venue_state}`:""}`:null;c&&i.set(c,(i.get(c)||0)+1)}),Array.from(i.entries()).filter(([l,c])=>c>=t).sort(([l,c],[d,u])=>u-c).slice(0,r).map(([l,c])=>l)}catch(n){return console.error("Error in getCitiesFromEvents:",n),[]}})}}function vr(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function gi(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Qs(e,t){const r=vr(e);return isNaN(t)?gi(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Go(e,t){const r=vr(e);if(isNaN(t))return gi(e,NaN);if(!t)return r;const n=r.getDate(),a=gi(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const i=a.getDate();return n>=i?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const tT=6048e5,Cle=864e5,rT=6e4,C8=36e5,x0=43200,y5=1440;let Ple={};function yp(){return Ple}function uo(e,t){var l,c,d,u,f,h,p,g;const r=yp(),n=(g=(p=(u=(d=t==null?void 0:t.weekStartsOn)!=null?d:(c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)!=null?u:r.weekStartsOn)!=null?p:(h=(f=r.locale)==null?void 0:f.options)==null?void 0:h.weekStartsOn)!=null?g:0,a=vr(e),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function lh(e){return uo(e,{weekStartsOn:1})}function P8(e){const t=vr(e),r=t.getFullYear(),n=gi(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=lh(n),i=gi(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=lh(i);return t.getTime()>=a.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function wm(e){const t=vr(e);return t.setHours(0,0,0,0),t}function bm(e){const t=vr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function xl(e,t){const r=wm(e),n=wm(t),a=+r-bm(r),i=+n-bm(n);return Math.round((a-i)/Cle)}function Tle(e){const t=P8(e),r=gi(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),lh(r)}function p2(e,t){const r=t*7;return Qs(e,r)}function Ale(e,t){return Go(e,t*12)}function Rle(e){let t;return e.forEach(function(r){const n=vr(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function Ole(e){let t;return e.forEach(r=>{const n=vr(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function l_(e,t){const r=vr(e),n=vr(t),a=r.getTime()-n.getTime();return a<0?-1:a>0?1:a}function d1(e){return gi(e,Date.now())}function Aa(e,t){const r=wm(e),n=wm(t);return+r==+n}function nT(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Mle(e){if(!nT(e)&&typeof e!="number")return!1;const t=vr(e);return!isNaN(Number(t))}function jm(e,t){const r=vr(e),n=vr(t),a=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return a*12+i}function Dle(e,t,r){const n=uo(e,r),a=uo(t,r),i=+n-bm(n),o=+a-bm(a);return Math.round((i-o)/tT)}function T8(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function A8(e,t){return+vr(e)-+vr(t)}function g2(e,t,r){const n=A8(e,t)/rT;return T8(r==null?void 0:r.roundingMethod)(n)}function Ile(e){const t=vr(e);return t.setHours(23,59,59,999),t}function u1(e){const t=vr(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function $le(e){const t=vr(e);return+Ile(t)==+u1(t)}function Lle(e,t){const r=vr(e),n=vr(t),a=l_(r,n),i=Math.abs(jm(r,n));let o;if(i<1)o=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*i);let l=l_(r,n)===-a;$le(vr(e))&&i===1&&l_(e,n)===1&&(l=!1),o=a*(i-Number(l))}return o===0?0:o}function Fle(e,t,r){const n=A8(e,t)/1e3;return T8(r==null?void 0:r.roundingMethod)(n)}function pi(e){const t=vr(e);return t.setDate(1),t.setHours(0,0,0,0),t}function R8(e){const t=vr(e),r=gi(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function sT(e,t){var l,c,d,u,f,h,p,g;const r=yp(),n=(g=(p=(u=(d=t==null?void 0:t.weekStartsOn)!=null?d:(c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)!=null?u:r.weekStartsOn)!=null?p:(h=(f=r.locale)==null?void 0:f.options)==null?void 0:h.weekStartsOn)!=null?g:0,a=vr(e),i=a.getDay(),o=(i<n?-7:0)+6-(i-n);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}function O8(e){return sT(e,{weekStartsOn:1})}const zle={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ble=(e,t,r)=>{let n;const a=zle[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function BN(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Ule={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},qle={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Vle={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Wle={date:BN({formats:Ule,defaultWidth:"full"}),time:BN({formats:qle,defaultWidth:"full"}),dateTime:BN({formats:Vle,defaultWidth:"full"})},Hle={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Gle=(e,t,r,n)=>Hle[e];function ag(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const Yle={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Kle={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Zle={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Xle={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Jle={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Qle={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ece=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},tce={ordinalNumber:ece,era:ag({values:Yle,defaultWidth:"wide"}),quarter:ag({values:Kle,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ag({values:Zle,defaultWidth:"wide"}),day:ag({values:Xle,defaultWidth:"wide"}),dayPeriod:ag({values:Jle,defaultWidth:"wide",formattingValues:Qle,defaultFormattingWidth:"wide"})};function ig(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const o=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?nce(l,f=>f.test(o)):rce(l,f=>f.test(o));let d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const u=t.slice(o.length);return{value:d,rest:u}}}function rce(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function nce(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function sce(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(a.length);return{value:o,rest:l}}}const ace=/^(\d+)(th|st|nd|rd)?/i,ice=/\d+/i,oce={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},lce={any:[/^b/i,/^(a|c)/i]},cce={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},dce={any:[/1/i,/2/i,/3/i,/4/i]},uce={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},hce={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},fce={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},mce={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},pce={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},gce={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},vce={ordinalNumber:sce({matchPattern:ace,parsePattern:ice,valueCallback:e=>parseInt(e,10)}),era:ig({matchPatterns:oce,defaultMatchWidth:"wide",parsePatterns:lce,defaultParseWidth:"any"}),quarter:ig({matchPatterns:cce,defaultMatchWidth:"wide",parsePatterns:dce,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ig({matchPatterns:uce,defaultMatchWidth:"wide",parsePatterns:hce,defaultParseWidth:"any"}),day:ig({matchPatterns:fce,defaultMatchWidth:"wide",parsePatterns:mce,defaultParseWidth:"any"}),dayPeriod:ig({matchPatterns:pce,defaultMatchWidth:"any",parsePatterns:gce,defaultParseWidth:"any"})},aT={code:"en-US",formatDistance:Ble,formatLong:Wle,formatRelative:Gle,localize:tce,match:vce,options:{weekStartsOn:0,firstWeekContainsDate:1}};function yce(e){const t=vr(e);return xl(t,R8(t))+1}function M8(e){const t=vr(e),r=+lh(t)-+Tle(t);return Math.round(r/tT)+1}function D8(e,t){var u,f,h,p,g,v,y,_;const r=vr(e),n=r.getFullYear(),a=yp(),i=(_=(y=(p=(h=t==null?void 0:t.firstWeekContainsDate)!=null?h:(f=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)!=null?p:a.firstWeekContainsDate)!=null?y:(v=(g=a.locale)==null?void 0:g.options)==null?void 0:v.firstWeekContainsDate)!=null?_:1,o=gi(e,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=uo(o,t),c=gi(e,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const d=uo(c,t);return r.getTime()>=l.getTime()?n+1:r.getTime()>=d.getTime()?n:n-1}function xce(e,t){var l,c,d,u,f,h,p,g;const r=yp(),n=(g=(p=(u=(d=t==null?void 0:t.firstWeekContainsDate)!=null?d:(c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)!=null?u:r.firstWeekContainsDate)!=null?p:(h=(f=r.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)!=null?g:1,a=D8(e,t),i=gi(e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),uo(i,t)}function I8(e,t){const r=vr(e),n=+uo(r,t)-+xce(r,t);return Math.round(n/tT)+1}function Pn(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Qc={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Pn(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Pn(r+1,2)},d(e,t){return Pn(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Pn(e.getHours()%12||12,t.length)},H(e,t){return Pn(e.getHours(),t.length)},m(e,t){return Pn(e.getMinutes(),t.length)},s(e,t){return Pn(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Pn(a,t.length)}},Jh={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},x5={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Qc.y(e,t)},Y:function(e,t,r,n){const a=D8(e,n),i=a>0?a:1-a;if(t==="YY"){const o=i%100;return Pn(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Pn(i,t.length)},R:function(e,t){const r=P8(e);return Pn(r,t.length)},u:function(e,t){const r=e.getFullYear();return Pn(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Pn(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Pn(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Qc.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Pn(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=I8(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Pn(a,t.length)},I:function(e,t,r){const n=M8(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Pn(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Qc.d(e,t)},D:function(e,t,r){const n=yce(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Pn(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Pn(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Pn(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Pn(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Jh.noon:n===0?a=Jh.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Jh.evening:n>=12?a=Jh.afternoon:n>=4?a=Jh.morning:a=Jh.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Qc.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Qc.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Pn(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Pn(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Qc.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Qc.s(e,t)},S:function(e,t){return Qc.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return w5(n);case"XXXX":case"XX":return vu(n);case"XXXXX":case"XXX":default:return vu(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return w5(n);case"xxxx":case"xx":return vu(n);case"xxxxx":case"xxx":default:return vu(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+_5(n,":");case"OOOO":default:return"GMT"+vu(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+_5(n,":");case"zzzz":default:return"GMT"+vu(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Pn(n,t.length)},T:function(e,t,r){const n=e.getTime();return Pn(n,t.length)}};function _5(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+Pn(i,2)}function w5(e,t){return e%60===0?(e>0?"-":"+")+Pn(Math.abs(e)/60,2):vu(e,t)}function vu(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Pn(Math.trunc(n/60),2),i=Pn(n%60,2);return r+a+t+i}const b5=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},$8=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},_ce=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return b5(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",b5(n,t)).replace("{{time}}",$8(a,t))},wce={p:$8,P:_ce},bce=/^D+$/,jce=/^Y+$/,Nce=["D","DD","YY","YYYY"];function Sce(e){return bce.test(e)}function kce(e){return jce.test(e)}function Ece(e,t,r){const n=Cce(e,t,r);if(console.warn(n),Nce.includes(e))throw new RangeError(n)}function Cce(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Pce=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Tce=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ace=/^'([^]*?)'?$/,Rce=/''/g,Oce=/[a-zA-Z]/;function Mt(e,t,r){var u,f,h,p,g,v,y,_,w,b,N,S,k,P,A,R,$,O;const n=yp(),a=(f=(u=r==null?void 0:r.locale)!=null?u:n.locale)!=null?f:aT,i=(b=(w=(v=(g=r==null?void 0:r.firstWeekContainsDate)!=null?g:(p=(h=r==null?void 0:r.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)!=null?v:n.firstWeekContainsDate)!=null?w:(_=(y=n.locale)==null?void 0:y.options)==null?void 0:_.firstWeekContainsDate)!=null?b:1,o=(O=($=(P=(k=r==null?void 0:r.weekStartsOn)!=null?k:(S=(N=r==null?void 0:r.locale)==null?void 0:N.options)==null?void 0:S.weekStartsOn)!=null?P:n.weekStartsOn)!=null?$:(R=(A=n.locale)==null?void 0:A.options)==null?void 0:R.weekStartsOn)!=null?O:0,l=vr(e);if(!Mle(l))throw new RangeError("Invalid time value");let c=t.match(Tce).map(z=>{const D=z[0];if(D==="p"||D==="P"){const B=wce[D];return B(z,a.formatLong)}return z}).join("").match(Pce).map(z=>{if(z==="''")return{isToken:!1,value:"'"};const D=z[0];if(D==="'")return{isToken:!1,value:Mce(z)};if(x5[D])return{isToken:!0,value:z};if(D.match(Oce))throw new RangeError("Format string contains an unescaped latin alphabet character `"+D+"`");return{isToken:!1,value:z}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return c.map(z=>{if(!z.isToken)return z.value;const D=z.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&kce(D)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Sce(D))&&Ece(D,t,String(e));const B=x5[D[0]];return B(l,D,a.localize,d)}).join("")}function Mce(e){const t=e.match(Ace);return t?t[1].replace(Rce,"'"):e}function Dce(e,t,r){var g,v;const n=yp(),a=(v=(g=r==null?void 0:r.locale)!=null?g:n.locale)!=null?v:aT,i=2520,o=l_(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o});let c,d;o>0?(c=vr(t),d=vr(e)):(c=vr(e),d=vr(t));const u=Fle(d,c),f=(bm(d)-bm(c))/1e3,h=Math.round((u-f)/60);let p;if(h<2)return r!=null&&r.includeSeconds?u<5?a.formatDistance("lessThanXSeconds",5,l):u<10?a.formatDistance("lessThanXSeconds",10,l):u<20?a.formatDistance("lessThanXSeconds",20,l):u<40?a.formatDistance("halfAMinute",0,l):u<60?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",1,l):h===0?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",h,l);if(h<45)return a.formatDistance("xMinutes",h,l);if(h<90)return a.formatDistance("aboutXHours",1,l);if(h<y5){const y=Math.round(h/60);return a.formatDistance("aboutXHours",y,l)}else{if(h<i)return a.formatDistance("xDays",1,l);if(h<x0){const y=Math.round(h/y5);return a.formatDistance("xDays",y,l)}else if(h<x0*2)return p=Math.round(h/x0),a.formatDistance("aboutXMonths",p,l)}if(p=Lle(d,c),p<12){const y=Math.round(h/x0);return a.formatDistance("xMonths",y,l)}else{const y=p%12,_=Math.trunc(p/12);return y<3?a.formatDistance("aboutXYears",_,l):y<9?a.formatDistance("overXYears",_,l):a.formatDistance("almostXYears",_+1,l)}}function tw(e,t){return Dce(e,d1(e),t)}function Ice(e){const t=vr(e),r=t.getFullYear(),n=t.getMonth(),a=gi(e,0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function $ce(e){return Math.trunc(+vr(e)/1e3)}function Lce(e){const t=vr(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function Fce(e,t){return Dle(Lce(e),pi(e),t)+1}function v2(e,t){const r=vr(e),n=vr(t);return r.getTime()>n.getTime()}function L8(e,t){const r=vr(e),n=vr(t);return+r<+n}function zce(e,t,r){const n=uo(e,r),a=uo(t,r);return+n==+a}function iT(e,t){const r=vr(e),n=vr(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function Bce(e,t){const r=vr(e),n=vr(t);return r.getFullYear()===n.getFullYear()}function Uce(e,t){return zce(e,d1(e),t)}function qce(e){return Aa(e,d1(e))}function Vce(e,t){const r=+vr(e),[n,a]=[+vr(t.start),+vr(t.end)].sort((i,o)=>i-o);return r>=n&&r<=a}function Qg(e,t){return Qs(e,-t)}function Wce(e){return Aa(e,Qg(d1(e),1))}function ms(e,t){const n=Kce(e);let a;if(n.date){const c=Zce(n.date,2);a=Xce(c.restDateString,c.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const i=a.getTime();let o=0,l;if(n.time&&(o=Jce(n.time),isNaN(o)))return new Date(NaN);if(n.timezone){if(l=Qce(n.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(i+o),d=new Date(0);return d.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),d.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),d}return new Date(i+o+l)}const _0={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Hce=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Gce=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Yce=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Kce(e){const t={},r=e.split(_0.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],_0.timeZoneDelimiter.test(t.date)&&(t.date=e.split(_0.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const a=_0.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function Zce(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?a:i*100,restDateString:e.slice((n[1]||n[2]).length)}}function Xce(e,t){if(t===null)return new Date(NaN);const r=e.match(Hce);if(!r)return new Date(NaN);const n=!!r[4],a=og(r[1]),i=og(r[2])-1,o=og(r[3]),l=og(r[4]),c=og(r[5])-1;if(n)return sde(t,l,c)?ede(t,l,c):new Date(NaN);{const d=new Date(0);return!rde(t,i,o)||!nde(t,a)?new Date(NaN):(d.setUTCFullYear(t,i,Math.max(a,o)),d)}}function og(e){return e?parseInt(e):1}function Jce(e){const t=e.match(Gce);if(!t)return NaN;const r=UN(t[1]),n=UN(t[2]),a=UN(t[3]);return ade(r,n,a)?r*C8+n*rT+a*1e3:NaN}function UN(e){return e&&parseFloat(e.replace(",","."))||0}function Qce(e){if(e==="Z")return 0;const t=e.match(Yce);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return ide(n,a)?r*(n*C8+a*rT):NaN}function ede(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,i=(t-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+i),n}const tde=[31,null,31,30,31,30,31,31,30,31,30,31];function F8(e){return e%400===0||e%4===0&&e%100!==0}function rde(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(tde[t]||(F8(e)?29:28))}function nde(e,t){return t>=1&&t<=(F8(e)?366:365)}function sde(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function ade(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function ide(e,t){return t>=0&&t<=59}function qN(e,t){const r=vr(e),n=r.getFullYear(),a=r.getDate(),i=gi(e,0);i.setFullYear(n,t,15),i.setHours(0,0,0,0);const o=Ice(i);return r.setMonth(t,Math.min(a,o)),r}function j5(e,t){const r=vr(e);return isNaN(+r)?gi(e,NaN):(r.setFullYear(t),r)}function oT(e){return E(this,null,function*(){try{const{data:t,error:r}=yield T.rpc("get_user_chats",{user_id:e});return r?(console.error("Error fetching user chats:",r),{data:null,error:r}):{data:t,error:null}}catch(t){return console.error("Error in fetchUserChats:",t),{data:null,error:t}}})}class uf{static getNotifications(){return E(this,arguments,function*(t={}){try{const{data:{user:r}}=yield T.auth.getUser();if(!r)throw new Error("User not authenticated");const n=!t.offset&&!t.type&&t.is_read===void 0,a=n?`notifications_${r.id}_${t.limit||50}`:null;if(n&&a){const i=Do.get(a);if(i)return i}try{let i=T.from("notifications_with_details").select("*",{count:"exact"}).eq("user_id",r.id).order("created_at",{ascending:!1});t.type&&(i=i.eq("type",t.type)),t.is_read!==void 0&&(i=i.eq("is_read",t.is_read));const o=t.limit||20,l=t.offset||0,c=Math.ceil(o*1.5);i=i.range(l,l+c-1);const{data:d,error:u,count:f}=yield i;if(u){const h=u.code||(u==null?void 0:u.statusCode)||(u==null?void 0:u.status),p=(u.message||String(u)||"").toLowerCase(),g=((u==null?void 0:u.details)||"").toLowerCase(),v=((u==null?void 0:u.hint)||"").toLowerCase();if(h==="PGRST205"||h==="42P01"||h===404||h==="404"||String(h)==="404"||(p==null?void 0:p.includes("notifications_with_details"))||(p==null?void 0:p.includes("does not exist"))||(p==null?void 0:p.includes("relation"))||(p==null?void 0:p.includes("not found"))||(p==null?void 0:p.includes("404"))||(g==null?void 0:g.includes("notifications_with_details"))||(v==null?void 0:v.includes("notifications_with_details"))||(u==null?void 0:u.status)===404||(u==null?void 0:u.statusCode)===404)return yield this.getNotificationsWithManualJoin(t);throw u}if(d!=null){const h=(d||[]).filter(w=>{var b;return w.type==="friend_request"&&((b=w.data)==null?void 0:b.request_id)});let p=new Set;if(h.length>0)try{const w=h.map(b=>b.data.request_id).filter(Boolean);if(w.length>0){const{data:b}=yield T.from("user_relationships").select("id").in("id",w).eq("relationship_type","friend").neq("status","pending");b&&(p=new Set(b.map(N=>N.id)))}}catch(w){}const _={notifications:(d||[]).map(w=>{var b;if(w.type==="friend_request"&&((b=w.data)!=null&&b.request_id)){const N=w.data.request_id;if(p.has(N))return null}return w}).filter(w=>w!==null).slice(0,o),total:f||0};return n&&a&&Do.set(a,_,Iv.NOTIFICATIONS),_}else return yield this.getNotificationsWithManualJoin(t)}catch(i){const o=(i==null?void 0:i.message)||String(i)||"",l=(i==null?void 0:i.code)||(i==null?void 0:i.statusCode)||(i==null?void 0:i.status);if(l==="PGRST205"||l==="42P01"||l===404||o!=null&&o.includes("notifications_with_details")||o!=null&&o.includes("does not exist")||o!=null&&o.includes("Not Found")||o!=null&&o.includes("404"))return yield this.getNotificationsWithManualJoin(t);throw i}}catch(r){throw console.error("Error fetching notifications:",r),new Error(`Failed to get notifications: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getNotificationsWithManualJoin(){return E(this,arguments,function*(t={}){const{data:{user:r}}=yield T.auth.getUser();if(!r)throw new Error("User not authenticated");let n=T.from("notifications").select("*",{count:"exact"}).eq("user_id",r.id).order("created_at",{ascending:!1});t.type&&(n=n.eq("type",t.type)),t.is_read!==void 0&&(n=n.eq("is_read",t.is_read));const a=t.limit||20,i=t.offset||0,o=Math.ceil(a*1.5);n=n.range(i,i+o-1);const{data:l,error:c,count:d}=yield n;if(c)throw c;if(!l||l.length===0)return{notifications:[],total:d||0};const u=l.filter(y=>{var _;return y.type==="friend_request"&&((_=y.data)==null?void 0:_.request_id)});let f=new Set;if(u.length>0)try{const y=u.map(_=>_.data.request_id).filter(Boolean);if(y.length>0){const{data:_}=yield T.from("user_relationships").select("id").in("id",y).eq("relationship_type","friend").neq("status","pending");_&&(f=new Set(_.map(w=>w.id)))}}catch(y){}const g=l.map(y=>{var _;if(y.type==="friend_request"&&((_=y.data)!=null&&_.request_id)){const w=y.data.request_id;if(f.has(w))return null}return y}).filter(y=>y!==null).slice(0,a);return g.length===0?{notifications:[],total:d||0}:{notifications:yield Promise.all(g.map(y=>E(this,null,function*(){const _=M({},y);if(y.actor_user_id)try{let w=null;const{data:b,error:N}=yield T.from("users").select("name, avatar_url").eq("user_id",y.actor_user_id).single();if(!N&&b)w=b;else{const{data:S,error:k}=yield T.from("profiles").select("name, avatar_url").eq("user_id",y.actor_user_id).single();!k&&S&&(w=S)}w&&(_.actor_name=w.name,_.actor_avatar=w.avatar_url)}catch(w){console.log("Could not fetch actor profile:",w)}if(y.review_id){const{data:w}=yield T.from("user_reviews").select("review_text, rating, event_id").eq("id",y.review_id).single();if(w&&(_.review_text=w.review_text,_.rating=w.rating,w.event_id)){const{data:b}=yield T.from("jambase_events").select("title, artist_name, venue_name").eq("id",w.event_id).single();b&&(_.event_title=b.title,_.artist_name=b.artist_name,_.venue_name=b.venue_name)}}return _}))),total:d||0}})}static enrichNotification(t){return E(this,null,function*(){const r=M({},t);if(t.actor_user_id)try{let n=null;const{data:a,error:i}=yield T.from("users").select("name, avatar_url").eq("user_id",t.actor_user_id).single();if(!i&&a)n=a;else{const{data:o,error:l}=yield T.from("profiles").select("name, avatar_url").eq("user_id",t.actor_user_id).single();!l&&o&&(n=o)}n&&(r.actor_name=n.name,r.actor_avatar=n.avatar_url)}catch(n){console.log("Could not fetch actor profile:",n)}if(t.review_id){const{data:n}=yield T.from("user_reviews").select("review_text, rating, event_id").eq("id",t.review_id).single();if(n&&(r.review_text=n.review_text,r.rating=n.rating,n.event_id)){const{data:a}=yield T.from("jambase_events").select("title, artist_name, venue_name").eq("id",n.event_id).single();a&&(r.event_title=a.title,r.artist_name=a.artist_name,r.venue_name=a.venue_name)}}return r})}static getUnreadNotifications(){return E(this,null,function*(){return(yield this.getNotifications({is_read:!1,limit:50})).notifications})}static getNotificationStats(){return E(this,null,function*(){var t;try{const{data:r,error:n}=yield T.from("notifications").select("type, is_read").eq("user_id",(t=(yield T.auth.getUser()).data.user)==null?void 0:t.id);if(n)throw n;const a={total:(r==null?void 0:r.length)||0,unread:(r==null?void 0:r.filter(i=>!i.is_read).length)||0,by_type:{friend_request:0,friend_accepted:0,match:0,message:0,review_liked:0,review_commented:0,comment_replied:0,event_interest:0,event_attendance_reminder:0,artist_followed:0,artist_new_event:0,artist_profile_updated:0,venue_new_event:0,venue_profile_updated:0,event_share:0,friend_rsvp_going:0,friend_rsvp_changed:0,friend_review_posted:0,friend_attended_same_event:0,event_reminder:0,group_chat_invite:0,trending_in_network:0,mutual_attendance:0,flag_reviewed:0,user_warned:0,user_restricted:0,user_suspended:0}};return r==null||r.forEach(i=>{a.by_type[i.type]++}),a}catch(r){throw console.error("Error fetching notification stats:",r),new Error(`Failed to get notification stats: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getUnreadCount(){return E(this,null,function*(){try{const{data:{user:t}}=yield T.auth.getUser();if(!t)return console.log("No user found, returning 0 unread count"),0;const r=`unread_count_${t.id}`,n=Do.get(r);if(n!==null)return n;const{data:a,error:i}=yield T.from("notifications").select("id, type, data, is_read").eq("user_id",t.id).eq("is_read",!1);if(i)return console.error("Error fetching notifications for unread count:",i),0;if(!a||a.length===0)return 0;const o=a.filter(u=>{var f;return u.type==="friend_request"&&((f=u.data)==null?void 0:f.request_id)});let l=new Set;if(o.length>0)try{const u=o.map(f=>f.data.request_id).filter(Boolean);if(u.length>0){const{data:f}=yield T.from("user_relationships").select("id").in("id",u).eq("relationship_type","friend").neq("status","pending");f&&(l=new Set(f.map(h=>h.id)))}}catch(u){}const d=a.filter(u=>{var f;if(u.type==="friend_request"&&((f=u.data)!=null&&f.request_id)){const h=u.data.request_id;return!l.has(h)}return!0}).length;return Do.set(r,d,Iv.NOTIFICATIONS),d}catch(t){return console.error("Error fetching unread count:",t),0}})}static markAsRead(t){return E(this,null,function*(){var r,n;try{const{error:a}=yield T.rpc("mark_notification_read",{notification_id:t});if(a){if(a.code==="PGRST202"||(r=a.message)!=null&&r.includes("Could not find the function")){console.log("Notification function not found, falling back to direct update");const{error:i}=yield T.from("notifications").update({is_read:!0}).eq("id",t).eq("user_id",(n=(yield T.auth.getUser()).data.user)==null?void 0:n.id);if(i)throw i;return}throw a}}catch(a){throw console.error("Error marking notification as read:",a),new Error(`Failed to mark notification as read: ${a instanceof Error?a.message:"Unknown error"}`)}})}static markAllAsRead(){return E(this,null,function*(){var t,r;try{const{error:n}=yield T.rpc("mark_all_notifications_read");if(n){if(n.code==="PGRST202"||(t=n.message)!=null&&t.includes("Could not find the function")){console.log("Notification function not found, falling back to direct update");const{error:a}=yield T.from("notifications").update({is_read:!0}).eq("user_id",(r=(yield T.auth.getUser()).data.user)==null?void 0:r.id).eq("is_read",!1);if(a)throw a;return}throw n}}catch(n){throw console.error("Error marking all notifications as read:",n),new Error(`Failed to mark all notifications as read: ${n instanceof Error?n.message:"Unknown error"}`)}})}static subscribeToNotifications(t,r,n){return E(this,null,function*(){const{data:{user:a}}=yield T.auth.getUser();if(!a)return console.error("Cannot subscribe to notifications: User not authenticated"),null;const i=a.id;return T.channel("notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${i}`},l=>E(this,null,function*(){try{let c=null;const{data:d,error:u}=yield T.from("notifications_with_details").select("*").eq("id",l.new.id).single();if(u){const f=u.code||(u==null?void 0:u.statusCode)||(u==null?void 0:u.status),h=(u.message||String(u)||"").toLowerCase();f==="PGRST205"||f==="42P01"||f===404||f==="404"||String(f)==="404"||(u==null?void 0:u.status)===404||(u==null?void 0:u.statusCode)===404||(h==null?void 0:h.includes("notifications_with_details"))||(h==null?void 0:h.includes("does not exist"))||(h==null?void 0:h.includes("not found"))||(h==null?void 0:h.includes("404"))||console.warn("Unexpected error fetching from notifications_with_details view:",u)}else d&&(c=d);if(!c){const{data:f}=yield T.from("notifications").select("*").eq("id",l.new.id).single();f&&(c=yield this.enrichNotification(f))}c&&t(c)}catch(c){console.error("Error fetching new notification details:",c)}})).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notifications",filter:`user_id=eq.${i}`},l=>E(this,null,function*(){try{let c=null;const{data:d,error:u}=yield T.from("notifications_with_details").select("*").eq("id",l.new.id).single();if(u){const f=u.code||(u==null?void 0:u.statusCode)||(u==null?void 0:u.status),h=(u.message||String(u)||"").toLowerCase();f==="PGRST205"||f==="42P01"||f===404||f==="404"||String(f)==="404"||(u==null?void 0:u.status)===404||(u==null?void 0:u.statusCode)===404||(h==null?void 0:h.includes("notifications_with_details"))||(h==null?void 0:h.includes("does not exist"))||(h==null?void 0:h.includes("not found"))||(h==null?void 0:h.includes("404"))||console.warn("Unexpected error fetching from notifications_with_details view:",u)}else d&&(c=d);if(!c){const{data:f}=yield T.from("notifications").select("*").eq("id",l.new.id).single();f&&(c=yield this.enrichNotification(f))}c&&r(c)}catch(c){console.error("Error fetching updated notification details:",c)}})).on("postgres_changes",{event:"DELETE",schema:"public",table:"notifications",filter:`user_id=eq.${i}`},l=>{n(l.old.id)}).subscribe()})}static unsubscribeFromNotifications(t){t&&T.removeChannel(t)}static getNotificationIcon(t){switch(t){case"friend_request":return"";case"friend_accepted":return"";case"review_liked":return"";case"review_commented":return"";case"comment_replied":return"";case"match":return"";case"message":return"";case"event_interest":return"";case"event_attendance_reminder":return"";case"artist_followed":return"";case"artist_new_event":return"";case"artist_profile_updated":return"";case"venue_new_event":return"";case"venue_profile_updated":return"";default:return""}}static getNotificationColor(t){switch(t){case"friend_request":return"bg-blue-100 text-blue-800 border-blue-200";case"friend_accepted":return"bg-green-100 text-green-800 border-green-200";case"review_liked":return"bg-red-100 text-red-800 border-red-200";case"review_commented":return"bg-purple-100 text-purple-800 border-purple-200";case"comment_replied":return"bg-orange-100 text-orange-800 border-orange-200";case"match":return"bg-pink-100 text-pink-800 border-pink-200";case"message":return"bg-indigo-100 text-indigo-800 border-indigo-200";case"event_interest":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"event_attendance_reminder":return"bg-teal-100 text-teal-800 border-teal-200";case"artist_followed":return"bg-purple-100 text-purple-800 border-purple-200";case"artist_new_event":return"bg-pink-100 text-pink-800 border-pink-200";case"artist_profile_updated":return"bg-indigo-100 text-indigo-800 border-indigo-200";case"venue_new_event":return"bg-blue-100 text-blue-800 border-blue-200";case"venue_profile_updated":return"bg-cyan-100 text-cyan-800 border-cyan-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}}static formatNotificationTime(t){const r=new Date,n=new Date(t),a=Math.floor((r.getTime()-n.getTime())/(1e3*60));return a<1?"Just now":a<60?`${a}m ago`:a<1440?`${Math.floor(a/60)}h ago`:`${Math.floor(a/1440)}d ago`}static handleAttendanceReminderAction(t,r,n){return E(this,null,function*(){try{const{data:{user:a}}=yield T.auth.getUser();if(!a)throw new Error("User not authenticated");const{UserEventService:i}=yield kn(()=>E(this,null,function*(){const{UserEventService:o}=yield Promise.resolve().then(()=>Kue);return{UserEventService:o}}),void 0,import.meta.url);yield i.markUserAttendance(a.id,r,n),yield this.markAsRead(t),console.log(` Attendance marked for event ${r}: ${n?"attended":"did not attend"}`)}catch(a){throw console.error("Error handling attendance reminder action:",a),new Error(`Failed to mark attendance: ${a instanceof Error?a.message:"Unknown error"}`)}})}static requiresAction(t){return["friend_request","event_attendance_reminder"].includes(t)}static getNotificationActions(t){switch(t){case"friend_request":return[{label:"Accept",action:"accept",variant:"success"},{label:"Decline",action:"decline",variant:"secondary"}];case"event_attendance_reminder":return[{label:"Yes, I attended",action:"attended",variant:"primary"},{label:"No, I didn't go",action:"not_attended",variant:"secondary"},{label:"Dismiss",action:"dismiss",variant:"secondary"}];default:return[]}}}function ode({onClick:e,className:t}){const[r,n]=x.useState(0),[a,i]=x.useState(!0);return x.useEffect(()=>{let o=null;const l=()=>E(this,null,function*(){try{const d=yield uf.getUnreadCount();console.log(" NotificationBell: Unread count loaded:",d),n(d)}catch(d){console.error("Error loading unread count:",d)}finally{i(!1)}}),c=()=>E(this,null,function*(){try{const{data:{user:d},error:u}=yield T.auth.getUser();if(u||!d){console.error("Error getting user for notification subscription:",u),i(!1);return}o=T.channel("notification-bell").on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`user_id=eq.${d.id}`},f=>{console.log(" NotificationBell: Notification change detected:",f.eventType),l()}).subscribe(f=>{f==="SUBSCRIBED"?console.log(" NotificationBell: Successfully subscribed to notifications"):f==="CHANNEL_ERROR"&&console.error(" NotificationBell: Channel subscription error")})}catch(d){console.error("Error setting up notification subscription:",d),i(!1)}});return l(),c(),()=>{o&&T.removeChannel(o)}},[]),a?s.jsx(le,{variant:"outline",size:"icon",className:ke("relative",t),disabled:!0,children:s.jsx(Ld,{className:"h-5 w-5"})}):s.jsxs(le,{variant:"outline",size:"icon",className:ke("relative",t),onClick:e,"aria-label":"Notifications",children:[s.jsx(Ld,{className:"h-5 w-5"}),r>0&&s.jsx(Ke,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 rounded-full p-0 flex items-center justify-center text-xs",children:r>99?"99+":r})]})}const lde=({currentUserId:e,onNavigateToNotifications:t,onNavigateToChat:r,className:n})=>{const[a,i]=x.useState(!1);return x.useEffect(()=>{let o=!1;const l=()=>E(void 0,null,function*(){try{const{data:d,error:u}=yield oT(e);if(u||o||!d)return;const{data:f}=yield T.from("chat_participants").select("chat_id, last_read_at").eq("user_id",e),h=new Map;f==null||f.forEach(p=>{h.set(p.chat_id,p.last_read_at)});for(const p of d){if(o)break;const g=h.get(p.id),v=T.from("messages").select("id").eq("chat_id",p.id).neq("sender_id",e).limit(1);g&&v.gt("created_at",g);const{data:y}=yield v.maybeSingle();if(y){o||i(!0);return}}o||i(!1)}catch(d){console.error("Error loading unread status:",d)}});l();const c=T.channel("page-actions-unread").on("postgres_changes",{event:"*",schema:"public",table:"messages"},l).subscribe();return()=>{o=!0,T.removeChannel(c)}},[e]),s.jsxs("div",{className:ke("flex items-center gap-2",n),children:[s.jsx(ode,{onClick:t,className:"h-10 w-10 rounded-full border-2 hover:bg-synth-pink/10 hover:border-synth-pink/50 transition-colors"}),s.jsxs(le,{variant:"outline",size:"icon",className:"h-10 w-10 rounded-full border-2 hover:bg-synth-pink/10 hover:border-synth-pink/50 transition-colors relative",onClick:()=>r==null?void 0:r(e),"aria-label":"Open chat",children:[s.jsx($n,{className:"h-5 w-5"}),a&&s.jsx("span",{className:"absolute -top-1 -right-1 bg-synth-pink rounded-full h-3 w-3 shadow-lg shadow-synth-pink/30 animate-pulse"})]})]})},cde=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,w0=e=>typeof e=="string"&&cde.test(e);class bs{static setEventReview(t,r,n,a,i){return E(this,null,function*(){var o,l,c,d,u,f,h,p,g,v,y,_,w,b,N,S,k,P;try{let A;if(n.Event_date&&(n.Event_date instanceof Date?A=n.Event_date.toISOString().split("T")[0]:typeof n.Event_date=="string"&&(A=n.Event_date)),!A&&r&&w0(r))try{const{data:q}=yield T.from("events").select("event_date").eq("id",r).maybeSingle();q!=null&&q.event_date&&(A=new Date(q.event_date).toISOString().split("T")[0])}catch(q){console.warn(" ReviewService: Could not fetch event date:",q)}const R=q=>{const K=Q=>Math.max(.5,Math.min(5,Q));if(typeof q.rating=="number"&&!Number.isNaN(q.rating))return Number(K(q.rating).toFixed(1));const Z=[q.artist_performance_rating,q.production_rating,q.venue_rating,q.location_rating,q.value_rating].filter(Q=>typeof Q=="number"&&Q>0);if(Z.length>0){const Q=Z.reduce((X,ne)=>X+ne,0)/Z.length;return Number(K(Q).toFixed(1))}const Y=[q.artist_rating].filter(Q=>typeof Q=="number"&&Q>0);return Y.length>0?K(Math.round(Y[0])):3},$=r?w0(r):!1,O=w0(a)?a:void 0,z=w0(i)?i:void 0;if(a&&!O&&console.warn(" ReviewService: Received non-UUID venueId parameter, ignoring",a),i&&!z&&console.warn(" ReviewService: Received non-UUID artistId parameter, ignoring",i),!$&&(!z||!O))throw new Error("Either eventId or both artistId and venueId must be provided");let D=null,B=null;if($){const q=yield T.from("reviews").select("id, is_draft").eq("user_id",t).eq("event_id",r).eq("is_draft",!1).maybeSingle(),K=yield T.from("reviews").select("id, is_draft").eq("user_id",t).eq("event_id",r).eq("is_draft",!0).maybeSingle(),Z=q.data,Y=K.data;if(console.log(" ReviewService: Checked for existing reviews by event_id:",{published:!!Z,published_id:Z==null?void 0:Z.id,draft:!!Y,draft_id:Y==null?void 0:Y.id}),Z){if(D=Z,B=q.error,Y){console.log(" ReviewService: Found both published review and draft - deleting draft:",Y.id);try{const{error:Q}=yield T.from("reviews").delete().eq("id",Y.id);Q?console.warn(" Failed to delete draft:",Q):console.log(" Deleted draft:",Y.id)}catch(Q){console.warn(" Error deleting draft:",Q)}}}else Y?(D=Y,B=K.error):(D=null,B=null)}else if(z&&O){const q=yield T.from("reviews").select("id, is_draft").eq("user_id",t).eq("artist_id",z).eq("venue_id",O).is("event_id",null).eq("is_draft",!1).maybeSingle(),K=yield T.from("reviews").select("id, is_draft").eq("user_id",t).eq("artist_id",z).eq("venue_id",O).is("event_id",null).eq("is_draft",!0).maybeSingle(),Z=q.data,Y=K.data;if(console.log(" ReviewService: Checked for existing reviews by artist_id + venue_id:",{published:!!Z,published_id:Z==null?void 0:Z.id,draft:!!Y,draft_id:Y==null?void 0:Y.id}),Z){if(D=Z,B=q.error,Y){console.log(" ReviewService: Found both published review and draft - deleting draft:",Y.id);try{const{error:Q}=yield T.from("reviews").delete().eq("id",Y.id);Q?console.warn(" Failed to delete draft:",Q):console.log(" Deleted draft:",Y.id)}catch(Q){console.warn(" Error deleting draft:",Q)}}}else Y?(D=Y,B=K.error):(D=null,B=null)}if(B&&B.code!=="PGRST116"&&B.status!==406)throw B;if(D){if(D.is_draft===!0){console.log(" ReviewService: Existing review is a draft - deleting it completely before creating published review:",D.id);try{const{error:K}=yield T.from("reviews").delete().eq("user_id",t).eq("event_id",r).eq("is_draft",!0);if(K)throw console.error(" Failed to delete draft before creating published review:",K),K;console.log(" Deleted draft completely - will create fresh published review"),D=null}catch(K){throw console.error(" Exception deleting draft:",K),K}}else if(console.log(" ReviewService: Existing review is already published - updating it:",D.id),$)try{let K=T.from("reviews").delete().eq("user_id",t).eq("is_draft",!0);$&&r?K=K.eq("event_id",r):z&&O&&(K=K.eq("artist_id",z).eq("venue_id",O).is("event_id",null));const{error:Z}=yield K;Z?console.warn(" Error deleting drafts before update:",Z):console.log(" Deleted all drafts before updating published review")}catch(K){console.warn(" Exception deleting drafts before update:",K)}if(D){console.log(" ReviewService: Updating existing published review:",D.id);const{data:K}=yield T.from("reviews").select("setlist, custom_setlist").eq("id",D.id).maybeSingle(),Z=H(M(H(M(M({},O?{venue_id:O}:{}),z?{artist_id:z}:{}),{review_text:n.review_text,is_public:n.is_public,is_draft:!1,draft_data:null,last_saved_at:null}),A?{Event_date:A}:{}),{artist_performance_rating:typeof n.artist_performance_rating=="number"&&!isNaN(n.artist_performance_rating)&&n.artist_performance_rating>0?Number(Math.max(.5,Math.min(5,n.artist_performance_rating)).toFixed(1)):void 0,production_rating:typeof n.production_rating=="number"&&!isNaN(n.production_rating)&&n.production_rating>0?Number(Math.max(.5,Math.min(5,n.production_rating)).toFixed(1)):void 0,venue_rating:typeof n.venue_rating=="number"&&!isNaN(n.venue_rating)&&n.venue_rating>0?Number(Math.max(.5,Math.min(5,n.venue_rating)).toFixed(1)):void 0,location_rating:typeof n.location_rating=="number"&&!isNaN(n.location_rating)&&n.location_rating>0?Number(Math.max(.5,Math.min(5,n.location_rating)).toFixed(1)):void 0,value_rating:typeof n.value_rating=="number"&&!isNaN(n.value_rating)&&n.value_rating>0?Number(Math.max(.5,Math.min(5,n.value_rating)).toFixed(1)):void 0,artist_performance_feedback:((o=n.artist_performance_feedback)==null?void 0:o.trim())||void 0,production_feedback:((l=n.production_feedback)==null?void 0:l.trim())||void 0,venue_feedback:((c=n.venue_feedback)==null?void 0:c.trim())||void 0,location_feedback:((d=n.location_feedback)==null?void 0:d.trim())||void 0,value_feedback:((u=n.value_feedback)==null?void 0:u.trim())||void 0,ticket_price_paid:n.ticket_price_paid,artist_rating:n.artist_rating,review_type:n.review_type,venue_tags:n.venue_tags,artist_tags:n.artist_tags,photos:n.photos,setlist:n.setlist!==void 0?n.setlist:(K==null?void 0:K.setlist)||null,custom_setlist:n.custom_setlist!==void 0?n.custom_setlist:(K==null?void 0:K.custom_setlist)||null,attendees:n.attendees,met_on_synth:n.met_on_synth,was_there:!0,updated_at:new Date().toISOString()});console.log(" ReviewService: Update payload category ratings:",{artist_performance_rating:Z.artist_performance_rating,production_rating:Z.production_rating,venue_rating:Z.venue_rating,location_rating:Z.location_rating,value_rating:Z.value_rating}),console.log(" ReviewService: Update payload category feedback:",{artist_performance_feedback:Z.artist_performance_feedback,production_feedback:Z.production_feedback,venue_feedback:Z.venue_feedback,location_feedback:Z.location_feedback,value_feedback:Z.value_feedback});let{error:Y}=yield T.from("reviews").update(Z).eq("id",D.id),Q=null;if(!Y){const X=yield T.from("reviews").select("*").eq("id",D.id).maybeSingle();Q=X.data,Y=X.error,console.log(" ReviewService: Updated review category ratings:",{artist_performance_rating:Q==null?void 0:Q.artist_performance_rating,production_rating:Q==null?void 0:Q.production_rating,venue_rating:Q==null?void 0:Q.venue_rating,location_rating:Q==null?void 0:Q.location_rating,value_rating:Q==null?void 0:Q.value_rating}),console.log(" ReviewService: Updated review category feedback:",{artist_performance_feedback:Q==null?void 0:Q.artist_performance_feedback,production_feedback:Q==null?void 0:Q.production_feedback,venue_feedback:Q==null?void 0:Q.venue_feedback,location_feedback:Q==null?void 0:Q.location_feedback,value_feedback:Q==null?void 0:Q.value_feedback})}if(Y){const X=H(M({},O?{venue_id:O}:{}),{rating:typeof n.rating=="number"?Number(n.rating.toFixed(1)):R(n),review_text:n.review_text,is_public:n.is_public,is_draft:!1,draft_data:null,last_saved_at:null,photos:n.photos,was_there:!0,updated_at:new Date().toISOString()}),ne=yield T.from("reviews").update(X).eq("id",D.id).select().single();Q=ne.data,Y=ne.error}if(Y)throw Y;if($&&Q)try{const X=yield T.from("reviews").select("id, is_draft").eq("id",Q.id).maybeSingle();X.data&&X.data.is_draft===!0&&(console.warn(" ReviewService: Draft flag still true after update, forcing is_draft = false"),yield T.from("reviews").update({is_draft:!1,draft_data:null,last_saved_at:null}).eq("id",Q.id));let ne=T.from("reviews").delete().eq("user_id",t).eq("is_draft",!0);$&&r?ne=ne.eq("event_id",r):z&&O&&(ne=ne.eq("artist_id",z).eq("venue_id",O).is("event_id",null));const re=yield ne;if(re.error)console.warn(" ReviewService: Failed to delete drafts after update:",re.error);else{const ye=((f=re.data)==null?void 0:f.length)||0;ye>0?console.log(` Deleted ${ye} draft review(s) after submitting review for event:`,r):console.log(" ReviewService: No drafts found to delete (review is now published)");let ee=T.from("reviews").select("id, is_draft").eq("user_id",t).eq("is_draft",!0);$&&r?ee=ee.eq("event_id",r):z&&O&&(ee=ee.eq("artist_id",z).eq("venue_id",O).is("event_id",null));const de=yield ee;de.data&&de.data.length>0?console.warn(` ReviewService: WARNING - ${de.data.length} draft(s) still exist after cleanup for event:`,r):console.log(" ReviewService: Verified - no drafts remain for this event")}}catch(X){console.warn(" ReviewService: Error during draft cleanup after update:",X)}return Q}}const F=H(M(H(M(M(M({user_id:t},$&&r?{event_id:r}:{}),O?{venue_id:O}:{}),z?{artist_id:z}:{}),{reaction_emoji:n.reaction_emoji,review_text:n.review_text,is_public:(h=n.is_public)!=null?h:!0,is_draft:!1}),A?{Event_date:A}:{}),{artist_performance_rating:typeof n.artist_performance_rating=="number"&&!isNaN(n.artist_performance_rating)&&n.artist_performance_rating>0?Number(Math.max(.5,Math.min(5,n.artist_performance_rating)).toFixed(1)):void 0,production_rating:typeof n.production_rating=="number"&&!isNaN(n.production_rating)&&n.production_rating>0?Number(Math.max(.5,Math.min(5,n.production_rating)).toFixed(1)):void 0,venue_rating:typeof n.venue_rating=="number"&&!isNaN(n.venue_rating)&&n.venue_rating>0?Number(Math.max(.5,Math.min(5,n.venue_rating)).toFixed(1)):void 0,location_rating:typeof n.location_rating=="number"&&!isNaN(n.location_rating)&&n.location_rating>0?Number(Math.max(.5,Math.min(5,n.location_rating)).toFixed(1)):void 0,value_rating:typeof n.value_rating=="number"&&!isNaN(n.value_rating)&&n.value_rating>0?Number(Math.max(.5,Math.min(5,n.value_rating)).toFixed(1)):void 0,artist_performance_feedback:((p=n.artist_performance_feedback)==null?void 0:p.trim())||void 0,production_feedback:((g=n.production_feedback)==null?void 0:g.trim())||void 0,venue_feedback:((v=n.venue_feedback)==null?void 0:v.trim())||void 0,location_feedback:((y=n.location_feedback)==null?void 0:y.trim())||void 0,value_feedback:((_=n.value_feedback)==null?void 0:_.trim())||void 0,ticket_price_paid:n.ticket_price_paid,artist_rating:n.artist_rating,review_type:n.review_type,venue_tags:n.venue_tags,artist_tags:n.artist_tags,photos:n.photos,setlist:n.setlist||null,attendees:n.attendees,met_on_synth:n.met_on_synth,was_there:!0});if(console.log(" ReviewService: Insert payload category ratings:",{artist_performance_rating:F.artist_performance_rating,production_rating:F.production_rating,venue_rating:F.venue_rating,location_rating:F.location_rating,value_rating:F.value_rating}),console.log(" ReviewService: Insert payload category feedback:",{artist_performance_feedback:F.artist_performance_feedback,production_feedback:F.production_feedback,venue_feedback:F.venue_feedback,location_feedback:F.location_feedback,value_feedback:F.value_feedback}),$&&r){console.log(" ReviewService: Checking event JamBase IDs for eventId:",r);const{data:q,error:K}=yield T.from("events_with_artist_venue").select("id, artist_id, artist_name_normalized, venue_id, venue_name_normalized").eq("id",r).single();if(K)console.error(" ReviewService: Error fetching event data:",K);else{console.log(" ReviewService: Event data:",q);const Z=q==null?void 0:q.artist_id;Z&&!z?(console.log(" ReviewService: Using JamBase artist_id from event:",Z),F.artist_id=Z):z?(console.log(" ReviewService: Using provided artistId parameter:",z),F.artist_id=z):console.log(" ReviewService: No artist_id found for event"),O?(console.log(" ReviewService: Using venueId parameter:",O),F.venue_id=O):a?console.warn(" ReviewService: Ignoring non-UUID venueId parameter",a):console.log(" ReviewService: No venueId parameter provided")}}else z&&(console.log(" ReviewService: Using provided artistId (no event):",z),F.artist_id=z),O&&(console.log(" ReviewService: Using provided venueId (no event):",O),F.venue_id=O);console.log(" ReviewService: Final insert payload:",H(M({},F),{category_ratings:{artist_performance_rating:F.artist_performance_rating,production_rating:F.production_rating,venue_rating:F.venue_rating,location_rating:F.location_rating,value_rating:F.value_rating},category_feedback:{artist_performance_feedback:F.artist_performance_feedback,production_feedback:F.production_feedback,venue_feedback:F.venue_feedback,location_feedback:F.location_feedback,value_feedback:F.value_feedback}}));let{data:U,error:G}=yield T.from("reviews").insert(F).select().maybeSingle();if(G){const q=G;if((q==null?void 0:q.code)==="23505"||/duplicate key/i.test((q==null?void 0:q.message)||"")){const K=yield T.from("reviews").update(F).eq("user_id",t).eq("event_id",r).select().maybeSingle();U=K.data,G=K.error}}if(G){const q=H(M(H(M({user_id:t,event_id:r},O?{venue_id:O}:{}),{review_text:n.review_text,is_public:(w=n.is_public)!=null?w:!0,is_draft:!1}),A?{Event_date:A}:{}),{artist_performance_rating:typeof n.artist_performance_rating=="number"&&!isNaN(n.artist_performance_rating)&&n.artist_performance_rating>0?Number(Math.max(.5,Math.min(5,n.artist_performance_rating)).toFixed(1)):void 0,production_rating:typeof n.production_rating=="number"&&!isNaN(n.production_rating)&&n.production_rating>0?Number(Math.max(.5,Math.min(5,n.production_rating)).toFixed(1)):void 0,venue_rating:typeof n.venue_rating=="number"&&!isNaN(n.venue_rating)&&n.venue_rating>0?Number(Math.max(.5,Math.min(5,n.venue_rating)).toFixed(1)):void 0,location_rating:typeof n.location_rating=="number"&&!isNaN(n.location_rating)&&n.location_rating>0?Number(Math.max(.5,Math.min(5,n.location_rating)).toFixed(1)):void 0,value_rating:typeof n.value_rating=="number"&&!isNaN(n.value_rating)&&n.value_rating>0?Number(Math.max(.5,Math.min(5,n.value_rating)).toFixed(1)):void 0,artist_performance_feedback:((b=n.artist_performance_feedback)==null?void 0:b.trim())||void 0,production_feedback:((N=n.production_feedback)==null?void 0:N.trim())||void 0,venue_feedback:((S=n.venue_feedback)==null?void 0:S.trim())||void 0,location_feedback:((k=n.location_feedback)==null?void 0:k.trim())||void 0,value_feedback:((P=n.value_feedback)==null?void 0:P.trim())||void 0,ticket_price_paid:n.ticket_price_paid,photos:n.photos,setlist:n.setlist||null,was_there:!0});console.error(" ReviewService: First insert failed, retrying with minimal insert. Error:",G);const K=yield T.from("reviews").insert(q).select().single();U=K.data,G=K.error}if(G)throw console.error(" ReviewService: Final insert/update error:",G),G;if(console.log(" ReviewService: Review saved successfully. Data:",U),console.log(" ReviewService: Saved category ratings:",{artist_performance_rating:U==null?void 0:U.artist_performance_rating,production_rating:U==null?void 0:U.production_rating,venue_rating:U==null?void 0:U.venue_rating,location_rating:U==null?void 0:U.location_rating,value_rating:U==null?void 0:U.value_rating}),console.log(" ReviewService: Saved category feedback:",{artist_performance_feedback:U==null?void 0:U.artist_performance_feedback,production_feedback:U==null?void 0:U.production_feedback,venue_feedback:U==null?void 0:U.venue_feedback,location_feedback:U==null?void 0:U.location_feedback,value_feedback:U==null?void 0:U.value_feedback}),$&&U)try{const{error:q,data:K}=yield T.from("reviews").delete().eq("user_id",t).eq("event_id",r).eq("is_draft",!0).select("id");if(q)console.error(" CRITICAL: Failed to delete drafts after creating review:",q);else{const Z=(K==null?void 0:K.length)||0;Z>0&&console.log(` NUCLEAR: Deleted ${Z} draft(s) after review creation`);const Y=yield T.from("reviews").select("id").eq("user_id",t).eq("event_id",r).eq("is_draft",!0);Y.data&&Y.data.length>0?(console.error(` CRITICAL ERROR: ${Y.data.length} draft(s) STILL EXIST after deletion!`,Y.data),yield T.from("reviews").delete().eq("user_id",t).eq("event_id",r).eq("is_draft",!0)):console.log(" Verified: All drafts deleted successfully")}}catch(q){console.error(" CRITICAL: Exception during draft cleanup:",q);try{yield T.from("reviews").delete().eq("user_id",t).eq("event_id",r).eq("is_draft",!0)}catch(K){console.error(" CRITICAL: Retry deletion also failed:",K)}}return U}catch(A){const R=A,$=(R==null?void 0:R.message)||(R==null?void 0:R.error_description)||(R==null?void 0:R.details)||(R==null?void 0:R.hint)||JSON.stringify(R);throw console.error("Error setting event review:",R),new Error(`Failed to set event review: ${$}`)}})}static getUserEventReview(t,r){return E(this,null,function*(){try{if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r))return console.log(" Invalid event ID format (not a UUID), skipping review lookup:",r),null;const{data:a,error:i}=yield T.from("reviews").select("*").eq("user_id",t).eq("event_id",r).single();if(i&&i.code!=="PGRST116")throw i;return a||null}catch(n){const a=n;return(a==null?void 0:a.code)!=="22P02"&&console.error("Error getting user event review:",n),null}})}static getPreviousVenueReview(t,r,n){return E(this,null,function*(){try{if(!r)return null;const a=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;if(!a.test(r))return null;const i=T.from("reviews").select("*").eq("user_id",t).eq("venue_id",r).eq("is_draft",!1).order("created_at",{ascending:!1});n&&a.test(n)&&i.neq("event_id",n);const{data:o,error:l}=yield i;return l&&l.code!=="PGRST116"?(console.error("Error getting previous venue review:",l),null):!o||o.length===0?null:o.find(d=>d.venue_rating!=null||d.location_rating!=null||d.venue_feedback||d.location_feedback)||null}catch(a){return console.error("Error getting previous venue review:",a),null}})}static getEventReviews(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select(`
          *,
          events_with_artist_venue:event_id (id, title, artist_name_normalized, venue_name_normalized, event_date),
          review_likes!left(id, user_id)
        `).eq("event_id",t).eq("is_public",!0);if(n&&n.sort((d,u)=>{const f=typeof d.rating=="number"?d.rating:0,h=typeof u.rating=="number"?u.rating:0;return h!==f?h-f:new Date(u.created_at).getTime()-new Date(d.created_at).getTime()}),a)throw a;let i=[];if(r){const{data:d}=yield T.from("engagements").select("entity_id").eq("user_id",r).eq("entity_type","review").eq("engagement_type","like").in("entity_id",(n==null?void 0:n.map(u=>u.id))||[]);i=(d==null?void 0:d.map(u=>u.entity_id))||[]}const o=(n||[]).map(d=>{var u,f,h,p,g,v;return H(M({},d),{artist_name:((u=d.events_with_artist_venue)==null?void 0:u.artist_name_normalized)||((f=d.events)==null?void 0:f.artist_name),artist_id:d.artist_id||null,venue_name:((h=d.events_with_artist_venue)==null?void 0:h.venue_name_normalized)||((p=d.events)==null?void 0:p.venue_name),venue_id:d.venue_id||null,is_liked_by_user:i.includes(d.id),user_like_id:i.includes(d.id)?(v=(g=d.review_likes)==null?void 0:g.find(y=>y.user_id===r))==null?void 0:v.id:void 0,review_type:d.review_type,is_public:d.is_public})}),l=o.length,c=l>0?o.reduce((d,u)=>d+u.rating,0)/l:0;return{reviews:o,averageRating:c,totalReviews:l}}catch(n){throw console.error("Error getting event reviews:",n),new Error(`Failed to get event reviews: ${n instanceof Error?n.message:"Unknown error"}`)}})}static getUserReviewHistory(t){return E(this,null,function*(){var r,n;try{console.log(" ReviewService: Getting user review history for userId:",t),console.log(" ReviewService: Starting query for userId:",t);const{count:a}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t);console.log(" ReviewService: Total reviews (including drafts) for user:",a);const{data:i,error:o,count:l}=yield T.from("reviews").select('*, "Event_date"',{count:"exact"}).eq("user_id",t).eq("is_draft",!1).order("created_at",{ascending:!1});if(i&&i.length>0&&(console.log(" ReviewService: First review column names:",Object.keys(i[0])),console.log(" ReviewService: First review Event_date check:",{hasEventDate:"event_date"in i[0],hasEventDateCapital:"Event_date"in i[0],event_date:i[0].event_date,Event_date:i[0].Event_date})),i&&i.sort((_,w)=>{const b=typeof _.rating=="number"?_.rating:0,N=typeof w.rating=="number"?w.rating:0;return N!==b?N-b:_.rank_order!=null&&w.rank_order!=null?_.rank_order-w.rank_order:_.rank_order!=null?-1:w.rank_order!=null?1:new Date(w.created_at).getTime()-new Date(_.created_at).getTime()}),console.log(" ReviewService: Query completed. Count:",l,"Data length:",i==null?void 0:i.length),i&&i.length>0&&console.log(" ReviewService: First review sample:",{id:i[0].id,user_id:i[0].user_id,event_id:i[0].event_id,is_draft:i[0].is_draft,was_there:i[0].was_there,review_text:(r=i[0].review_text)==null?void 0:r.substring(0,50)}),console.log(" ReviewService: Raw query result:",{dataLength:i==null?void 0:i.length,error:o,firstReview:i==null?void 0:i[0],userId:t}),o)throw console.error(" ReviewService: Query error:",o),o;if(!i||i.length===0)return console.warn(" ReviewService: No reviews found for user:",t),{reviews:[],total:0};const c=[...new Set((i||[]).map(_=>_.event_id).filter(Boolean))];console.log(" ReviewService: Event IDs to fetch:",c.length,c);let d={};const u=[...new Set((i||[]).map(_=>_.artist_id).filter(Boolean))],f=[...new Set((i||[]).map(_=>_.venue_id).filter(Boolean))];if(c.length>0){const{data:_,error:w}=yield T.from("events").select("id, title, artist_name, venue_name, artist_id, venue_id, event_date, doors_time, venue_city, venue_state, venue_zip").in("id",c);if(console.log(" ReviewService: Events query result:",{dataLength:_==null?void 0:_.length,error:w,firstEvent:_==null?void 0:_[0]}),!w&&_){const b=[...new Set(_.map(R=>R.artist_id).filter(Boolean))],N=[...new Set(_.map(R=>R.venue_id).filter(Boolean))],S=[...new Set([...b,...u])],k=[...new Set([...N,...f])];let P={};if(S.length>0){const{data:R}=yield T.from("artists").select("id, name, image_url").in("id",S);R&&(P=R.reduce(($,O)=>($[O.id]=O,$),{}))}let A={};if(k.length>0){const{data:R}=yield T.from("venues").select("id, name, image_url").in("id",k);R&&(A=R.reduce(($,O)=>($[O.id]=O,$),{}))}d=_.reduce((R,$)=>{var O,z;return R[$.id]=H(M({},$),{artist_name:((O=P[$.artist_id])==null?void 0:O.name)||$.artist_name,venue_name:((z=A[$.venue_id])==null?void 0:z.name)||$.venue_name,artist_id:$.artist_id,venue_id:$.venue_id}),R},{}),console.log(" ReviewService: Events map created with",Object.keys(d).length,"events"),console.log(" ReviewService: Sample event in map:",d[Object.keys(d)[0]])}else w&&console.error(" ReviewService: Error fetching events:",w)}else console.warn(" ReviewService: No event IDs found in reviews");let h={},p={};if(u.length>0){const{data:_}=yield T.from("artists").select("id, name, image_url").in("id",u);_&&(h=_.reduce((w,b)=>(w[b.id]=b,w),{}))}if(f.length>0){const{data:_}=yield T.from("venues").select("id, name, image_url").in("id",f);_&&(p=_.reduce((w,b)=>(w[b.id]=b,w),{}))}const g=i,v=(g||[]).filter(_=>!!(_.was_there===!0||_.review_text&&_.review_text!=="ATTENDANCE_ONLY"));console.log(" ReviewService: Total reviews fetched:",g==null?void 0:g.length),console.log(" ReviewService: Reviews after filtering:",v.length),console.log(" ReviewService: Sample filtered review:",v[0]?{id:v[0].id,user_id:v[0].user_id,event_id:v[0].event_id,was_there:v[0].was_there,review_text:v[0].review_text,hasEventInMap:!!d[v[0].event_id],eventTitle:(n=d[v[0].event_id])==null?void 0:n.title}:"No reviews");const y={reviews:v.map(_=>{var k,P;let b=_.event_id&&d[_.event_id]||null;!b&&(_.artist_id||_.venue_id)&&(b={id:null,title:null,artist_name:_.artist_id&&((k=h[_.artist_id])==null?void 0:k.name)||null,venue_name:_.venue_id&&((P=p[_.venue_id])==null?void 0:P.name)||null,artist_id:_.artist_id,venue_id:_.venue_id,event_date:null}),b&&(!b.artist_name||!b.venue_name)&&(!b.artist_name&&_.artist_id&&h[_.artist_id]&&(b.artist_name=h[_.artist_id].name,b.artist_id=_.artist_id),!b.venue_name&&_.venue_id&&p[_.venue_id]&&(b.venue_name=p[_.venue_id].name,b.venue_id=_.venue_id));let N;const S=_.Event_date||_.event_date;if(S){const[A,R,$]=S.split("-").map(Number);if(A&&R&&$){const O=new Date(A,R-1,$);isNaN(O.getTime())||(N=O)}}return{review:{id:_.id,user_id:_.user_id,event_id:_.event_id,artist_id:_.artist_id,venue_id:_.venue_id,rating:_.rating,rank_order:_.rank_order,review_type:_.review_type,review_text:_.review_text,photos:_.photos,videos:_.videos,setlist:_.setlist,mood_tags:_.mood_tags,genre_tags:_.genre_tags,context_tags:_.context_tags,artist_rating:_.artist_rating,artist_performance_rating:_.artist_performance_rating,production_rating:_.production_rating,venue_rating:_.venue_rating,location_rating:_.location_rating,value_rating:_.value_rating,artist_performance_feedback:_.artist_performance_feedback,production_feedback:_.production_feedback,venue_feedback:_.venue_feedback,location_feedback:_.location_feedback,value_feedback:_.value_feedback,Event_date:N,ticket_price_paid:_.ticket_price_paid,created_at:_.created_at,updated_at:_.updated_at,likes_count:_.likes_count,comments_count:_.comments_count,shares_count:_.shares_count,is_public:_.is_public,was_there:_.was_there,attendees:_.attendees,met_on_synth:_.met_on_synth},event:b}}),total:Array.isArray(g)?g.length:0};return console.log(" ReviewService: Processed result:",y),y}catch(a){throw console.error(" ReviewService: Error getting user review history:",a),new Error(`Failed to get user review history: ${a instanceof Error?a.message:"Unknown error"}`)}})}static setRankOrderForRatingGroup(t,r,n){return E(this,null,function*(){console.log(" Saving rank order:",{userId:t,rating:r,count:n.length});const a=Math.round(r*10)/10,i=n.map((o,l)=>({id:o,rank_order:l+1}));try{const{data:o,error:l}=yield T.from("reviews").select("id, rating, artist_performance_rating, production_rating, venue_rating, location_rating, value_rating").eq("user_id",t).eq("is_draft",!1);if(l)console.warn(" Could not fetch reviews to clear rank_order:",l);else if(o){const c=o.filter(d=>{const u=[d.artist_performance_rating,d.production_rating,d.venue_rating,d.location_rating,d.value_rating].filter(h=>typeof h=="number"&&h>0);if(u.length>0){const h=u.reduce((g,v)=>g+v,0)/u.length;return Math.round(h*10)/10===a}return(d.rating?Math.round(d.rating*10)/10:null)===a});for(const d of c)n.includes(d.id)||(yield T.from("reviews").update({rank_order:null}).eq("id",d.id).eq("user_id",t))}for(const c of i){console.log(`  Updating review ${c.id.slice(0,8)}...  rank_order = ${c.rank_order}`);const{error:d}=yield T.from("reviews").update({rank_order:c.rank_order}).eq("id",c.id).eq("user_id",t);if(d)throw console.error(` Error updating review ${c.id}:`,d),d}console.log(" All rankings saved successfully")}catch(o){throw console.error(" Error updating rank order group:",o),new Error(`Failed to update ranking: ${o instanceof Error?o.message:"Unknown error"}`)}})}static clearRankOnRatingChange(t){return E(this,null,function*(){try{const{error:r}=yield T.from("reviews").update({rank_order:null}).eq("id",t);if(r)throw r}catch(r){console.warn("Failed to clear rank_order on rating change",r)}})}static deleteEventReview(t,r){return E(this,null,function*(){try{console.log(" Deleting review:",{userId:t,reviewId:r});const{error:n}=yield T.from("reviews").delete().eq("id",r).eq("user_id",t);if(n)throw console.error("Error deleting review:",n),n;console.log(" Review deleted successfully")}catch(n){throw console.error("Error deleting __event review:",n),new Error(`Failed to delete event review: ${n instanceof Error?n.message:"Unknown error"}`)}})}static likeReview(t,r){return E(this,null,function*(){console.log(" ReviewService: likeReview called",{userId:t,reviewId:r});try{console.log(" ReviewService: Checking for existing like...");const{data:n,error:a}=yield T.from("engagements").select("id").eq("user_id",t).eq("entity_type","review").eq("entity_id",r).eq("engagement_type","like").maybeSingle();if(console.log(" ReviewService: Existing like check result:",{existingLike:n,checkError:a}),a&&a.code!=="PGRST116")throw console.error(" ReviewService: Error checking existing like:",a),a;if(n)return console.log(" ReviewService: User already liked this review, returning existing like"),n;console.log(" ReviewService: Inserting new like...");const{data:i,error:o}=yield T.from("engagements").insert({user_id:t,entity_type:"review",entity_id:r,engagement_type:"like"}).select().single();if(console.log(" ReviewService: Insert result:",{data:i,error:o}),o){if(console.error(" ReviewService: Error inserting like:",o),o.code==="23505"){console.log(" ReviewService: Duplicate key error, fetching existing like...");const{data:l}=yield T.from("engagements").select("*").eq("user_id",t).eq("entity_type","review").eq("entity_id",r).eq("engagement_type","like").single();return console.log(" ReviewService: Found existing like after duplicate error:",l),l}throw o}return console.log(" ReviewService: Like inserted successfully:",i),i}catch(n){throw console.error(" ReviewService: Error liking review:",n),new Error(`Failed to like review: ${n instanceof Error?n.message:"Unknown error"}`)}})}static unlikeReview(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("engagements").delete().eq("user_id",t).eq("entity_type","review").eq("entity_id",r).eq("engagement_type","like");if(n)throw n}catch(n){throw console.error("Error unliking review:",n),new Error(`Failed to unlike review: ${n instanceof Error?n.message:"Unknown error"}`)}})}static addComment(t,r,n,a){return E(this,null,function*(){try{const{data:i,error:o}=yield T.from("comments").insert({user_id:t,entity_type:"review",entity_id:r,comment_text:n,parent_comment_id:a}).select().single();if(o)throw o;return yield this.updateReviewCounts(r,"comments",1),i}catch(i){throw console.error("Error adding comment:",i),new Error(`Failed to add comment: ${i instanceof Error?i.message:"Unknown error"}`)}})}static getReviewComments(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("comments").select("*").eq("entity_type","review").eq("entity_id",t).order("created_at",{ascending:!0});if(n)throw n;if(!r||r.length===0)return[];const a=[...new Set(r.map(d=>d.user_id))],{data:i,error:o}=yield T.from("users").select("id, name, avatar_url, user_id").in("user_id",a);if(o)throw o;const l=new Map;return i==null||i.forEach(d=>{l.set(d.user_id,{id:d.id,name:d.name,avatar_url:d.avatar_url})}),r.map(d=>H(M({},d),{user:l.get(d.user_id)||{id:d.user_id,name:"Unknown User",avatar_url:void 0}}))}catch(r){throw console.error("Error getting review comments:",r),new Error(`Failed to get review comments: ${r instanceof Error?r.message:"Unknown error"}`)}})}static shareReview(t,r,n){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("engagements").insert({user_id:t,entity_type:"review",entity_id:r,engagement_type:"share",engagement_value:n||"unknown",metadata:{review_id:r,share_platform:n}}).select().single();if(i)throw i;return yield this.updateReviewCounts(r,"shares",1),a}catch(a){throw console.error("Error sharing review:",a),new Error(`Failed to share review: ${a instanceof Error?a.message:"Unknown error"}`)}})}static getPublicReviewsWithProfiles(t,r,n=20,a=0){return E(this,null,function*(){try{let i=T.from("reviews").select(`
          *,
          users:users!reviews_user_id_fkey (
            user_id,
            name,
            avatar_url,
            account_type
          )
          events_with_artist_venue:event_id (
            id,
            title,
            artist_name_normalized,
            venue_name_normalized,
            event_date
          )
        `,{count:"exact"}).eq("is_public",!0).eq("is_draft",!1).order("created_at",{ascending:!1}).range(a,a+n-1);t&&(i=i.eq("event_id",t)),r&&(i=i.eq("venue_id",r));const{data:o,error:l,count:c}=yield i;if(l)throw l;const d=(o||[]).map(h=>h.user_id).filter(Boolean),u=new Map;if(d.length>0){const{data:h}=yield T.from("user_verifications").select("user_id, verified").in("user_id",d);h==null||h.forEach(p=>{u.set(p.user_id,p.verified||!1)})}return{reviews:(o||[]).map(h=>{var p,g,v,y,_,w,b,N,S,k,P;return H(M({},h),{reviewer_name:(p=h.users)==null?void 0:p.name,reviewer_avatar:(g=h.users)==null?void 0:g.avatar_url,reviewer_verified:u.get(h.user_id)||!1,reviewer_account_type:(v=h.users)==null?void 0:v.account_type,event_title:((y=h.events_with_artist_venue)==null?void 0:y.title)||((_=h.events)==null?void 0:_.title),artist_name:((w=h.events_with_artist_venue)==null?void 0:w.artist_name_normalized)||((b=h.events)==null?void 0:b.artist_name),venue_name:((N=h.events_with_artist_venue)==null?void 0:N.venue_name_normalized)||((S=h.events)==null?void 0:S.venue_name),event_date:((k=h.events_with_artist_venue)==null?void 0:k.event_date)||((P=h.events)==null?void 0:P.event_date)})}),total:c||0}}catch(i){throw console.error("Error getting public reviews with profiles:",i),new Error(`Failed to get public reviews: ${i instanceof Error?i.message:"Unknown error"}`)}})}static updateReviewCounts(t,r,n){return E(this,null,function*(){try{const a=`${r}_count`;console.log(" ReviewService: Updating review counts",{reviewId:t,type:r,delta:n,column:a});const{data:i,error:o}=yield T.from("reviews").select("likes_count, comments_count, shares_count").eq("id",t).single();if(o){console.error(" ReviewService: Error fetching current counts:",o);return}const l=(i==null?void 0:i[a])||0,c=Math.max(0,l+n);console.log(" ReviewService: Updating count",{currentCount:l,nextCount:c});const{error:d}=yield T.from("reviews").update({[a]:c}).eq("id",t);d?console.error(" ReviewService: Error updating count:",d):console.log(" ReviewService: Successfully updated count")}catch(a){console.error(` ReviewService: Error updating ${r} count:`,a)}})}static getReviewEngagement(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("get_review_engagement",{review_id_param:t,user_id_param:r||null});if(!a&&n&&Array.isArray(n)&&n.length>0&&typeof n[0]=="object")return n[0];console.log(" ReviewService: RPC failed, using direct queries");const{data:i,error:o}=yield T.from("reviews").select("likes_count, comments_count, shares_count").eq("id",t).single();if(o)throw console.error(" ReviewService: Error fetching review data:",o),o;let l=!1;if(r){const{data:c,error:d}=yield T.from("engagements").select("id").eq("entity_type","review").eq("entity_id",t).eq("engagement_type","like").eq("user_id",r).maybeSingle();d?console.error(" ReviewService: Error checking like status:",d):l=!!c}return{likes_count:(i==null?void 0:i.likes_count)||0,comments_count:(i==null?void 0:i.comments_count)||0,shares_count:(i==null?void 0:i.shares_count)||0,is_liked_by_user:l}}catch(n){return console.warn("ReviewService.getReviewEngagement failed",n),null}})}static getReviewsEngagement(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select(`
          id, 
          likes_count, 
          comments_count, 
          shares_count,
          review_likes!left(id, user_id)
        `).in("id",t);if(a)throw a;const i={};return n==null||n.forEach(o=>{const l=Array.isArray(o.review_likes)?o.review_likes:[],c=r?l.some(d=>d.user_id===r):!1;i[o.id]={likes_count:o.likes_count||0,comments_count:o.comments_count||0,shares_count:o.shares_count||0,is_liked_by_user:c}}),i}catch(n){return console.warn("ReviewService.getReviewsEngagement failed",n),{}}})}static getPopularTags(t){return E(this,null,function*(){try{const r=`${t}_tags`,{data:n,error:a}=yield T.from("reviews").select(r).not(r,"is",null).eq("is_public",!0);if(a)throw a;const i={};return n==null||n.forEach(o=>{(o[r]||[]).forEach(c=>{i[c]=(i[c]||0)+1})}),Object.entries(i).map(([o,l])=>({tag:o,count:l})).sort((o,l)=>l.count-o.count).slice(0,20)}catch(r){return console.error("Error getting popular tags:",r),[]}})}static getVenueStats(t){return E(this,null,function*(){try{let r=t;if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)){const{data:o}=yield T.from("venues_with_external_ids").select("jambase_venue_id").eq("id",t).maybeSingle();o!=null&&o.jambase_venue_id&&(r=o.jambase_venue_id)}const{data:a,error:i}=yield T.rpc("get_venue_stats",{venue_jambase_id:r});if(i)throw i;return a[0]||{total_reviews:0,average_venue_rating:0,average_artist_rating:0,average_overall_rating:0,rating_distribution:{"1_star":0,"2_star":0,"3_star":0,"4_star":0,"5_star":0}}}catch(r){throw console.error("Error getting venue stats:",r),new Error(`Failed to get venue stats: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getPopularVenueTags(t){return E(this,null,function*(){try{let r=t;if(t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)){const{data:o}=yield T.from("venues_with_external_ids").select("jambase_venue_id").eq("id",t).maybeSingle();o!=null&&o.jambase_venue_id&&(r=o.jambase_venue_id)}const{data:n,error:a}=yield T.rpc("get_popular_venue_tags",r?{venue_jambase_id:r}:{});if(a)throw a;return n||[]}catch(r){return console.error("Error getting popular venue tags:",r),[]}})}static getVenueReviews(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select(`
          *,
          review_likes!left(id, user_id)
        `).eq("venue_id",t).eq("is_public",!0).order("created_at",{ascending:!1});if(a)throw a;let i=[];if(r){const{data:d}=yield T.from("engagements").select("entity_id").eq("user_id",r).eq("entity_type","review").eq("engagement_type","like").in("entity_id",(n==null?void 0:n.map(u=>u.id))||[]);i=(d==null?void 0:d.map(u=>u.entity_id))||[]}const o=(n||[]).map(d=>{var u,f;return H(M({},d),{is_liked_by_user:i.includes(d.id),user_like_id:i.includes(d.id)?(f=(u=d.review_likes)==null?void 0:u.find(h=>h.user_id===r))==null?void 0:f.id:void 0,review_type:d.review_type,is_public:d.is_public})}),l=o.length,c=l>0?o.reduce((d,u)=>d+u.rating,0)/l:0;return{reviews:o,averageRating:c,totalReviews:l}}catch(n){throw console.error("Error getting venue reviews:",n),new Error(`Failed to get venue reviews: ${n instanceof Error?n.message:"Unknown error"}`)}})}static getArtistReviews(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select(`
          *,
          review_likes!left(id, user_id)
        `).eq("artist_id",t).eq("is_public",!0).order("created_at",{ascending:!1});if(a)throw a;let i=[];if(r){const{data:d}=yield T.from("engagements").select("entity_id").eq("user_id",r).eq("entity_type","review").eq("engagement_type","like").in("entity_id",(n==null?void 0:n.map(u=>u.id))||[]);i=(d==null?void 0:d.map(u=>u.entity_id))||[]}const o=(n||[]).map(d=>{var u,f;return H(M({},d),{is_liked_by_user:i.includes(d.id),user_like_id:i.includes(d.id)?(f=(u=d.review_likes)==null?void 0:u.find(h=>h.user_id===r))==null?void 0:f.id:void 0,review_type:d.review_type,is_public:d.is_public})}),l=o.length,c=l>0?o.reduce((d,u)=>d+u.rating,0)/l:0;return{reviews:o,averageRating:c,totalReviews:l}}catch(n){throw console.error("Error getting artist reviews:",n),new Error(`Failed to get artist reviews: ${n instanceof Error?n.message:"Unknown error"}`)}})}static getArtistStats(t){return E(this,null,function*(){try{let r=t;if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)){const{data:o}=yield T.from("artists").select("jambase_artist_id").eq("id",t).single();o!=null&&o.jambase_artist_id&&(r=o.jambase_artist_id)}const{data:a,error:i}=yield T.rpc("get_artist_stats",{artist_jambase_id:r});if(i)throw i;return a[0]||{total_reviews:0,average_rating:0,rating_distribution:{"1_star":0,"2_star":0,"3_star":0,"4_star":0,"5_star":0}}}catch(r){throw console.error("Error getting artist stats:",r),new Error(`Failed to get artist stats: ${r instanceof Error?r.message:"Unknown error"}`)}})}}const Ar=x.forwardRef((a,n)=>{var i=a,{className:e,type:t}=i,r=me(i,["className","type"]);return s.jsx("input",M({type:t,className:ke("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n},r))});Ar.displayName="Input";var dde="Label",z8=x.forwardRef((e,t)=>s.jsx(Ct.label,H(M({},e),{ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}})));z8.displayName=dde;var B8=z8;const ude=lp("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ht=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(B8,M({ref:r,className:ke(ude(),e)},t))});Ht.displayName=B8.displayName;const hde=e=>{switch(e){case"1min":return 4;case"3min":return 6;case"5min":return 9;default:return 1}},Wf=8,N5={reviewDuration:null,selectedArtist:null,selectedVenue:null,eventDate:"",selectedSetlist:null,customSetlist:[],artistPerformanceRating:0,productionRating:0,venueRating:0,locationRating:0,valueRating:0,artistPerformanceFeedback:"",productionFeedback:"",venueFeedback:"",locationFeedback:"",valueFeedback:"",ticketPricePaid:"",rating:0,reviewText:"",photos:[],videos:[],attendees:[],metOnSynth:!1,isPublic:!0,reviewType:"event"};function fde(){const[e,t]=x.useState({currentStep:1,formData:N5,errors:{},isLoading:!1,isValid:!1}),r=v=>{switch(v){case"1min":return"quick";case"3min":return"standard";case"5min":return"detailed";default:return null}},n=v=>hde(v),a=x.useCallback((v,y)=>{const _={},w=r(y.reviewDuration);if(n(y.reviewDuration),v===1&&!y.reviewDuration)return _.reviewDuration="Please select how much time you want to spend",_;switch(w){case"quick":v===2?(y.selectedArtist||(_.selectedArtist="Please select an artist"),y.selectedVenue||(_.selectedVenue="Please select a venue"),y.eventDate||(_.eventDate="Please select a date")):v===3&&((!y.rating||y.rating<.5||y.rating>5)&&(_.rating="Please provide an overall rating (0.5 - 5 stars)"),!y.reviewText||y.reviewText.trim()===""?_.reviewText="Please share a brief description of your experience":y.reviewText.length>200&&(_.reviewText="Review text must be 200 characters or less for quick review"));break;case"standard":v===2?(y.selectedArtist||(_.selectedArtist="Please select an artist"),y.selectedVenue||(_.selectedVenue="Please select a venue"),y.eventDate||(_.eventDate="Please select a date")):v===3?(!y.artistPerformanceRating||y.artistPerformanceRating<.5||y.artistPerformanceRating>5)&&(_.artistPerformanceRating="Please rate the artist performance (0.5 - 5 stars)"):v===4?(!y.venueRating||y.venueRating<.5||y.venueRating>5)&&(_.venueRating="Please rate the venue (0.5 - 5 stars)"):v===5&&(!y.reviewText||y.reviewText.trim()===""?_.reviewText="Please share a description of your experience":y.reviewText.length>400&&(_.reviewText="Review text must be 400 characters or less for standard review"));break;case"detailed":v===2?(y.selectedArtist||(_.selectedArtist="Please select an artist"),y.selectedVenue||(_.selectedVenue="Please select a venue"),y.eventDate||(_.eventDate="Please select a date")):v===3?(!y.artistPerformanceRating||y.artistPerformanceRating<.5||y.artistPerformanceRating>5)&&(_.artistPerformanceRating="Please rate the artist performance (0.5 - 5 stars)"):v===4?(!y.productionRating||y.productionRating<.5||y.productionRating>5)&&(_.productionRating="Please rate the production quality (0.5 - 5 stars)"):v===5?(!y.venueRating||y.venueRating<.5||y.venueRating>5)&&(_.venueRating="Please rate the venue (0.5 - 5 stars)"):v===6?(!y.locationRating||y.locationRating<.5||y.locationRating>5)&&(_.locationRating="Please rate the location & logistics (0.5 - 5 stars)"):v===7?((!y.valueRating||y.valueRating<.5||y.valueRating>5)&&(_.valueRating="Please rate the value for the ticket (0.5 - 5 stars)"),y.ticketPricePaid&&Number.isNaN(Number(y.ticketPricePaid))?_.ticketPricePaid="Ticket price must be a valid number":y.ticketPricePaid&&Number(y.ticketPricePaid)<0&&(_.ticketPricePaid="Ticket price cannot be negative")):v===8&&(!y.reviewText||y.reviewText.trim()===""?_.reviewText="Please share a brief description of your experience":y.reviewText.length>500&&(_.reviewText="Review text must be 500 characters or less"));break}return _},[]),i=x.useCallback(v=>{const y=[];if(v.artistPerformanceRating&&v.artistPerformanceRating>0&&y.push(v.artistPerformanceRating),v.productionRating&&v.productionRating>0&&y.push(v.productionRating),v.venueRating&&v.venueRating>0&&y.push(v.venueRating),v.locationRating&&v.locationRating>0&&y.push(v.locationRating),v.valueRating&&v.valueRating>0&&y.push(v.valueRating),y.length===0)return 0;const _=y.reduce((w,b)=>w+b,0)/y.length;return Math.round(_*10)/10},[]),o=x.useCallback(v=>{console.log(" useReviewForm: updateFormData called with:",v),t(y=>{const _=M(M({},y.formData),v);console.log(" useReviewForm: Previous formData:",y.formData),console.log(" useReviewForm: New formData:",_),(v.artistPerformanceRating!==void 0||v.productionRating!==void 0||v.venueRating!==void 0||v.locationRating!==void 0||v.valueRating!==void 0)&&(_.rating=i(_));const w=a(y.currentStep,_),b=Object.keys(w).length===0;return console.log(" useReviewForm: Step validation errors:",w),console.log(" useReviewForm: Form is valid:",b),H(M({},y),{formData:_,errors:w,isValid:b})})},[a,i]),l=x.useCallback(()=>{t(v=>{const y=a(v.currentStep,v.formData);if(!(Object.keys(y).length===0))return H(M({},v),{errors:y});const w=n(v.formData.reviewDuration),b=w>0?w:Wf,N=Math.min(v.currentStep+1,b);return H(M({},v),{currentStep:N,errors:{},isValid:!0})})},[a]),c=x.useCallback(()=>{t(v=>H(M({},v),{currentStep:Math.max(v.currentStep-1,1),errors:{}}))},[]),d=x.useCallback(v=>{t(y=>{const _=n(y.formData.reviewDuration),w=_>0?_:Wf;return H(M({},y),{currentStep:Math.max(1,Math.min(v,w)),errors:{}})})},[]),u=x.useCallback(v=>{t(y=>H(M({},y),{isLoading:v}))},[]),f=x.useCallback(()=>{t({currentStep:1,formData:N5,errors:{},isLoading:!1,isValid:!1})},[]),h=x.useCallback(v=>{t(y=>{const _=M(M({},y.formData),v);(v.artistPerformanceRating!==void 0||v.productionRating!==void 0||v.venueRating!==void 0||v.locationRating!==void 0||v.valueRating!==void 0)&&(_.rating=i(_));const w=a(y.currentStep,_),b=Object.keys(w).length===0;return H(M({},y),{formData:_,errors:w,isValid:b})})},[a,i]),p=n(e.formData.reviewDuration),g=p>0?p:Wf;return H(M({},e),{updateFormData:o,nextStep:l,prevStep:c,setStep:d,setLoading:u,resetForm:f,setFormData:h,canProceed:e.isValid,canGoBack:e.currentStep>1,isLastStep:e.currentStep===g,totalSteps:g,currentFlow:r(e.formData.reviewDuration)})}function mde({reviewDuration:e,onSelectDuration:t}){const r=[{value:"1min",label:"1 Minute",subtitle:"Quick Review",description:"Overall rating + brief text",features:["Overall rating","Brief review text (200 chars)","Optional setlist"]},{value:"3min",label:"3 Minutes",subtitle:"Standard Review",description:"Key ratings + text + photos",features:["Overall rating","Artist Performance & Venue ratings","Review text (400 chars)","Optional photos","Optional setlist"]},{value:"5min",label:"5 Minutes",subtitle:"Detailed Review",description:"Full detailed review",features:["All 5 category ratings","Category feedback","Full review text (500 chars)","Photos & videos","Optional setlist","Optional ticket price"]}];return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("header",{className:"text-center space-y-2",children:[s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",textTransform:"uppercase",letterSpacing:"0.3em"},children:"Get Started"}),s.jsx("h2",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:"How much time do you want to spend?"}),s.jsx("p",{className:"max-w-xl mx-auto",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:"Choose the review style that works best for you."})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:r.map(n=>{const a=e===n.value;return s.jsxs("button",{type:"button",onClick:()=>t(n.value),className:ke("relative p-6 rounded-2xl border-2 text-left transition-all hover:scale-[1.02]"),style:{borderColor:a?"var(--brand-pink-500)":"var(--neutral-200)",background:a?"var(--brand-pink-050)":"var(--neutral-50)",boxShadow:a?"0 4px 4px 0 var(--shadow-color)":"none"},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx(ga,{className:"w-5 h-5",style:{color:a?"var(--brand-pink-500)":"var(--neutral-400)"}}),s.jsxs("div",{children:[s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)"},children:n.label}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:n.subtitle})]})]}),s.jsx("p",{className:"mb-4",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:n.description}),s.jsx("ul",{className:"space-y-1.5",children:n.features.map((i,o)=>s.jsxs("li",{className:"flex items-start gap-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsx("span",{style:{width:"var(--spacing-inline, 6px)",height:"var(--spacing-inline, 6px)",backgroundColor:"var(--brand-pink-500)",borderRadius:"999px",display:"inline-block",marginTop:"var(--spacing-inline, 6px)",flexShrink:0}}),s.jsx("span",{children:i})]},o))}),a&&s.jsx("div",{className:"absolute top-4 right-4",children:s.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--brand-pink-500)"},children:s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",style:{color:"var(--neutral-50)"},children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})})]},n.value)})})]})}const Xi=({value:e,onChange:t,placeholder:r="Search",onSubmit:n,widthVariant:a="full",className:i="",autoFocus:o=!1,disabled:l=!1,id:c,name:d,onFocus:u,onBlur:f})=>{const[h,p]=x.useState(""),g=x.useRef(null),v=e!==void 0?e:h,y=e!==void 0,_=A=>{const R=A.target.value;y||p(R),t==null||t(R)},w=()=>{var A;y||p(""),t==null||t(""),(A=g.current)==null||A.focus()},b=A=>{A.key==="Enter"&&n&&n(v)},N=v.length>0,S="synth-search-bar",k=`synth-search-bar--${a}`,P=[S,k,i].filter(Boolean).join(" ");return s.jsxs("div",{className:P,children:[s.jsx("div",{className:"synth-search-bar__icon-left","aria-hidden":"true",children:s.jsx(Se,{name:"search",size:24,alt:""})}),s.jsx("input",{ref:g,type:"text",value:v,onChange:_,onKeyDown:b,onFocus:u,onBlur:f,placeholder:r,disabled:l,autoFocus:o,id:c||`search-input-${Math.random().toString(36).substr(2,9)}`,name:d,className:"synth-search-bar__input","aria-label":r||"Search","aria-describedby":N?`${c||"search-input"}-clear-button`:void 0}),N&&s.jsx("button",{type:"button",onClick:w,className:"synth-search-bar__clear","aria-label":"Clear search",id:`${c||"search-input"}-clear-button`,children:s.jsx(Se,{name:"x",size:16,alt:"","aria-hidden":"true"})})]})};class Yy{static searchArtistsTrigram(t,r=20){return E(this,null,function*(){if(!t||t.length<2)return[];try{return yield this.getFuzzyMatchedResults(t,r)}catch(n){return console.error("Error in trigram search:",n),this.searchArtists(t,r,!1)}})}static searchArtists(t,r=20,n=!1,a=!0){return E(this,null,function*(){if(!t||t.length<2)return[];try{console.log(` Searching for artists: "${t}" (useApi: ${n}, useTrigram: ${a})`);let i=[];try{a?(i=yield this.searchArtistsTrigram(t,r),console.log(` Found ${i.length} artists using trigram search`)):(i=yield this.getFuzzyMatchedResults(t,r),console.log(` Found ${i.length} artists from local database`))}catch(l){if(console.warn("  Could not get fuzzy results from database:",l),a)try{i=yield this.getFuzzyMatchedResults(t,r),console.log(` Fallback: Found ${i.length} artists using client-side search`)}catch(c){console.warn("  Fallback search also failed:",c)}}if(!n)return console.log(` Returning ${i.length} results from local database (no API call)`),i;let o=[];try{a?(o=yield this.searchArtistsTrigram(t,r),console.log(` Final trigram search results: ${o.length}`)):(o=yield this.getFuzzyMatchedResults(t,r),console.log(` Final database results: ${o.length}`))}catch(l){if(console.warn("  Could not get final results from database:",l),a)try{o=yield this.getFuzzyMatchedResults(t,r),console.log(` Fallback final results: ${o.length}`)}catch(c){console.warn("  Fallback final search also failed:",c)}}return o.length>0?o:(console.log(" No results found in database"),[])}catch(i){return console.error(" Error in unified artist search:",i),[]}})}static searchTicketmasterAttractions(t,r){return E(this,null,function*(){return[]})}static searchJamBaseAPI(t,r){return E(this,null,function*(){return[]})}static getFallbackArtists(t,r){const i=[{id:"cage-the-elephant-1",name:"Cage The Elephant",identifier:"jambase:cage-the-elephant-1",image:"https://picsum.photos/300/300?random=1",genres:["alternative rock","indie rock","garage rock"],"x-bandOrMusician":"band","x-numUpcomingEvents":12},{id:"goose-1",name:"Goose",identifier:"jambase:goose-1",image:"https://picsum.photos/300/300?random=2",genres:["jam band","rock","funk"],"x-bandOrMusician":"band","x-numUpcomingEvents":25},{id:"phish-1",name:"Phish",identifier:"jambase:194164",image:"https://picsum.photos/300/300?random=3",genres:["rock","jam band","psychedelic rock"],"x-bandOrMusician":"band","x-numUpcomingEvents":12},{id:"dead-company-1",name:"Dead & Company",identifier:"jambase:123456",image:"https://picsum.photos/300/300?random=4",genres:["rock","jam band","psychedelic rock"],"x-bandOrMusician":"band","x-numUpcomingEvents":8},{id:"grateful-dead-1",name:"Grateful Dead",identifier:"jambase:789012",image:"https://picsum.photos/300/300?random=5",genres:["rock","jam band","psychedelic rock"],"x-bandOrMusician":"band","x-numUpcomingEvents":0},{id:"tame-impala-1",name:"Tame Impala",identifier:"jambase:345678",image:"https://picsum.photos/300/300?random=6",genres:["psychedelic rock","indie rock","electronic"],"x-bandOrMusician":"band","x-numUpcomingEvents":15},{id:"radiohead-1",name:"Radiohead",identifier:"jambase:901234",image:"https://picsum.photos/300/300?random=7",genres:["alternative rock","electronic","experimental"],"x-bandOrMusician":"band","x-numUpcomingEvents":6},{id:"taylor-swift-1",name:"Taylor Swift",identifier:"jambase:taylor-swift-1",image:"https://picsum.photos/300/300?random=8",genres:["pop","country","folk"],"x-bandOrMusician":"musician","x-numUpcomingEvents":50},{id:"drake-1",name:"Drake",identifier:"jambase:drake-1",image:"https://picsum.photos/300/300?random=9",genres:["hip-hop","r&b","pop"],"x-bandOrMusician":"musician","x-numUpcomingEvents":30},{id:"joe-russo-1",name:"Joe Russo",identifier:"jambase:joe-russo-1",image:"https://picsum.photos/300/300?random=10",genres:["rock","jam band","drummer"],"x-bandOrMusician":"musician","x-numUpcomingEvents":5},{id:"joe-russo-almost-dead-1",name:"Joe Russo's Almost Dead",identifier:"jambase:joe-russo-almost-dead-1",image:"https://picsum.photos/300/300?random=11",genres:["jam band","rock","grateful dead"],"x-bandOrMusician":"band","x-numUpcomingEvents":15}].map(o=>H(M({},o),{match_score:this.calculateFuzzyMatchScore(t,o.name)})).filter(o=>o.match_score>15).sort((o,l)=>l.match_score-o.match_score).slice(0,r);return console.log(` Fallback search for "${t}": ${i.length} matches found`),i}static populateArtistProfiles(t){return E(this,null,function*(){var n,a,i,o,l,c;const r=[];if(!t||t.length===0)return r;for(const d of t)try{const u=((n=d.identifier)==null?void 0:n.split(":")[1])||d.identifier||d.id;if(!u){console.warn(` Skipping artist ${d.name} - no identifier available`);continue}let f=null;try{const{data:v,error:y}=yield T.from("artists_with_external_ids").select("*").eq("jambase_artist_id",u).maybeSingle();v&&!y&&(f=v),y&&(y.code==="PGRST301"||y.status===406||((a=y.message)==null?void 0:a.includes("406"))||((i=y.message)==null?void 0:i.includes("Not Acceptable")))?console.warn(`  406 error checking artist ${d.name}, continuing anyway:`,y.message):y&&y.code!=="PGRST116"&&console.warn(`  Database error checking artist ${d.name}:`,y)}catch(v){console.warn(`  Exception checking artist ${d.name}:`,v)}if(f){console.log(`  Artist ${d.name} already exists in database`),r.push(f);continue}const h={name:d.name,identifier:d.identifier,url:d.url||null,image_url:d.image||null,date_published:new Date().toISOString(),date_modified:new Date().toISOString()};let p=null;try{const{data:v,error:y}=yield T.from("artists_with_external_ids").select("id").eq("jambase_artist_id",u).maybeSingle();v&&!y&&(p=v),y&&(y.code==="PGRST301"||y.status===406||((o=y.message)==null?void 0:o.includes("406"))||((l=y.message)==null?void 0:l.includes("Not Acceptable")))?(console.warn(`  406 error checking artist ${d.name} for update, will try insert:`,y.message),p=null):y&&y.code!=="PGRST116"&&console.warn(`  Error checking artist ${d.name}:`,y)}catch(v){console.warn(`  Exception checking artist ${d.name}:`,v),p=null}let g;if(p){const{data:v,error:y}=yield T.from("artists").update(h).eq("id",p.id).select().maybeSingle();if(y)console.error(` Error updating artist ${d.name}:`,y),g=p;else{g=v;try{yield T.from("external_entity_ids").upsert({entity_type:"artist",entity_uuid:g.id,source:"jambase",external_id:u},{onConflict:"entity_uuid,source,entity_type"}).select()}catch(_){}}}else{const{data:v,error:y}=yield T.from("artists").insert(h).select().maybeSingle();if(y)console.error(` Error inserting artist ${d.name}:`,y),g=null;else{g=v;try{yield T.from("external_entity_ids").insert({entity_type:"artist",entity_uuid:g.id,source:"jambase",external_id:u}).select()}catch(_){}}}if(!g){console.error(` Failed to save artist ${d.name}`);continue}console.log(` Saved artist ${d.name} to database`),r.push(g)}catch(u){console.error(` Error processing artist ${d.name}:`,u);const f=((c=d.identifier)==null?void 0:c.split(":")[1])||d.identifier||d.id;if(!f)continue;r.push({id:d.id||f,jambase_artist_id:f,name:d.name,description:d.description||`Artist: ${d.name}`,genres:d.genres||[],image_url:d.image,popularity_score:d["x-numUpcomingEvents"]||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),identifier:d.identifier||f,band_or_musician:d["x-bandOrMusician"]||"band",num_upcoming_events:d["x-numUpcomingEvents"]||0,last_synced_at:new Date().toISOString()});continue}return r})}static fetchFullArtistDetails(t){return E(this,null,function*(){throw new Error("JamBase API removed - use database queries instead")})}static getFuzzyMatchedResults(t,r){return E(this,null,function*(){try{const n=t.trim(),i=n.split(/\s+/).length===1&&n.length>0?`${n}%`:`%${n}%`,{data:o,error:l}=yield T.from("artists").select("id, name, identifier, image_url, genres, num_upcoming_events").ilike("name",i).limit(Math.max(r*5,100));if(l)return console.warn(`  Database error getting artists: ${l.message}`),[];if(!o||o.length===0)return console.log(" No artists found in database for artist search"),[];const c=o.filter(p=>typeof p=="object"&&p!==null&&typeof p.id=="string"&&typeof p.name=="string"),d=c.map(p=>p.id),u=c.filter(p=>!p.num_upcoming_events||p.num_upcoming_events===0),f=new Map;if(u.length>0){const p=new Date().toISOString(),{data:g,error:v}=yield T.from("events").select("artist_id").in("artist_id",u.map(y=>y.id)).gte("event_date",p);!v&&g&&g.forEach(y=>{if(y.artist_id){const _=f.get(y.artist_id)||0;f.set(y.artist_id,_+1)}})}return c.map(p=>{let g=p.num_upcoming_events||0;return g===0&&f.has(p.id)&&(g=f.get(p.id)||0),{id:p.id,name:p.name,identifier:p.identifier||`manual:${p.id}`,image_url:p.image_url||void 0,genres:p.genres||[],band_or_musician:"band",num_upcoming_events:g,match_score:this.calculateFuzzyMatchScore(t,p.name),is_from_database:!0}}).filter(p=>p.match_score>5).sort((p,g)=>g.match_score-p.match_score).slice(0,r)}catch(n){return console.error(" Error getting fuzzy matched results:",n),[]}})}static calculateFuzzyMatchScore(t,r){const n=t.toLowerCase().trim(),a=r.toLowerCase().trim();if(a===n)return 100;if(a.startsWith(n))return 95;if(a.includes(n)){const f=n.length/a.length;return f>=.3?85+Math.round(f*10):70+Math.round(f*15)}const i=n.split(/[\s']+/).filter(f=>f.length>0),o=a.split(/[\s']+/).filter(f=>f.length>0);if(i.length>1){let f=0;for(const h of i)o.includes(h)&&f++;if(f>=Math.ceil(i.length*.5))return 80+f/i.length*15}if(i.length===1&&o.includes(i[0]))return 85;let l=0;for(const f of i)for(const h of o)if(h.includes(f)||f.includes(h)){l++;break}if(l>0)return 50+l/i.length*30;const c=this.levenshteinDistance(n,a),d=Math.max(n.length,a.length),u=1-c/d;return u>.5?Math.round(u*60):0}static searchAllContent(t,r=20,n=!1){return E(this,null,function*(){try{console.log(` Searching all content for: "${t}" with limit: ${r} (useApi: ${n})`),console.log(` Searching artists with limit: ${Math.floor(r*.5)}`);const a=yield this.searchArtists(t,Math.floor(r*.5),n);console.log(` Searching events with limit: ${Math.floor(r*.3)}`);const i=yield this.searchEvents(t,Math.floor(r*.3));console.log(` Searching users with limit: ${Math.floor(r*.2)}`);const o=yield this.searchUsers(t,Math.floor(r*.2));return console.log(" Search results summary:",{artists:a.length,events:i.length,users:o.length}),{artists:a,events:i,users:o}}catch(a){return console.error(" Error searching all content:",a),{artists:[],events:[],users:[]}}})}static searchEvents(t,r){return E(this,null,function*(){try{console.log(` Searching events for: "${t}" with limit: ${r}`);const{data:n,error:a}=yield T.from("events").select("*").or(`artist_name.ilike.%${t}%,venue_name.ilike.%${t}%,title.ilike.%${t}%`).order("event_date",{ascending:!0}).limit(r);return a?(console.warn("  Error searching events:",a),[]):(console.log(` Found ${(n==null?void 0:n.length)||0} events:`,n==null?void 0:n.map(i=>i.title||i.artist_name)),n||[])}catch(n){return console.error(" Error searching events:",n),[]}})}static searchUsers(t,r){return E(this,null,function*(){try{console.log(` Searching users for: "${t}" with limit: ${r}`);const{data:n,error:a}=yield T.from("users").select("user_id, name, bio, avatar_url, instagram_handle").or(`name.ilike.%${t}%,bio.ilike.%${t}%,instagram_handle.ilike.%${t}%`).order("created_at",{ascending:!1}).limit(r);return a?(console.warn("  Error searching users:",a),[]):(console.log(` Found ${(n==null?void 0:n.length)||0} users:`,n==null?void 0:n.map(i=>i.name)),n||[])}catch(n){return console.error(" Error searching users:",n),[]}})}static levenshteinDistance(t,r){const n=Array(r.length+1).fill(null).map(()=>Array(t.length+1).fill(null));for(let a=0;a<=t.length;a++)n[0][a]=a;for(let a=0;a<=r.length;a++)n[a][0]=a;for(let a=1;a<=r.length;a++)for(let i=1;i<=t.length;i++){const o=t[i-1]===r[a-1]?0:1;n[a][i]=Math.min(n[a][i-1]+1,n[a-1][i]+1,n[a-1][i-1]+o)}return n[r.length][t.length]}static getArtistSuggestions(t,r=10){return E(this,null,function*(){return this.searchArtists(t,r)})}static getArtistById(t){return E(this,null,function*(){const{data:r,error:n}=yield T.from("artists_with_external_ids").select("*").eq("jambase_artist_id",t).maybeSingle();if(n){if(n.code==="PGRST116")return null;throw new Error(`Database error: ${n.message}`)}return r})}static getAllArtists(t=50){return E(this,null,function*(){const{data:r,error:n}=yield T.from("artists").select("*").order("created_at",{ascending:!1}).limit(t);if(n)throw new Error(`Database error: ${n.message}`);return r||[]})}static clearAllArtists(){return E(this,null,function*(){const{error:t}=yield T.from("artists").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw new Error(`Database error: ${t.message}`)})}static testJamBaseAPI(){return E(this,null,function*(){return{success:!1,message:"JamBase API has been removed. Use database queries instead."}})}}const pde=Object.freeze(Object.defineProperty({__proto__:null,UnifiedArtistSearchService:Yy},Symbol.toStringTag,{value:"Module"}));function h1({onArtistSelect:e,placeholder:t="Search for an artist...",className:r,hideClearButton:n=!1,onSearchStateChange:a}){const[i,o]=x.useState(""),[l,c]=x.useState(null),[d,u]=x.useState(!1),[f,h]=x.useState(!1),[p,g]=x.useState(-1),v=x.useRef(null);x.useEffect(()=>{if(!i.trim()){c(null),h(!1),a==null||a(!1);return}const k=setTimeout(()=>E(this,null,function*(){yield y(i)}),300);return()=>clearTimeout(k)},[i]),x.useEffect(()=>{const k=P=>{if(!(!f||!l))switch(P.key){case"ArrowDown":P.preventDefault(),g(A=>A<l.artists.length-1?A+1:A);break;case"ArrowUp":P.preventDefault(),g(A=>A>0?A-1:-1);break;case"Enter":P.preventDefault(),p>=0&&p<l.artists.length&&_(l.artists[p]);break;case"Escape":h(!1),g(-1);break}};return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)},[f,l,p]),x.useEffect(()=>{if(p>=0&&v.current){const k=v.current.children[p];k&&k.scrollIntoView({block:"nearest"})}},[p]);const y=k=>E(this,null,function*(){try{u(!0);const P=yield Yy.searchArtists(k,10),A={artists:P.map(R=>{var $;return{id:R.id,jambase_artist_id:(($=R.identifier)==null?void 0:$.replace("jambase:",""))||R.id,name:R.name,description:`${R.num_upcoming_events||0} upcoming events`,genres:R.genres||[],image_url:R.image_url,popularity_score:R.num_upcoming_events||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),source:R.is_from_database?"database":"jambase"}}),totalFound:P.length,query:k};c(A),h(!0),g(-1),a==null||a(!0)}catch(P){console.error("Artist search error:",P),c({artists:[],totalFound:0,query:k}),h(!0)}finally{u(!1)}}),_=k=>{try{On.click("artist",k.id||k.jambase_artist_id||k.name,{source:"artist_search_box",name:k.name})}catch(A){}e(k),o(k.name),h(!1),g(-1),a==null||a(!1);const P=document.getElementById("artist-search-input");P==null||P.blur()},w=()=>{l&&l.artists.length>0&&h(!0)},b=()=>{setTimeout(()=>{h(!1),g(-1),a==null||a(!1)},150)},N=()=>{o(""),c(null),h(!1),g(-1),a==null||a(!1);const k=document.getElementById("artist-search-input");k==null||k.focus()},S=(k=[])=>k.slice(0,3).join(", ");return s.jsxs("div",{className:ke("relative w-full",r),children:[s.jsxs("div",{className:"relative",children:[s.jsx(Xi,{id:"artist-search-input",name:"artistSearch",placeholder:t,value:i,onChange:k=>o(k),onFocus:w,onBlur:b,widthVariant:"full"}),s.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[d&&s.jsx(lr,{className:"w-4 h-4 animate-spin text-gray-400"}),i&&!d&&!n&&s.jsx(le,{type:"button",variant:"ghost",size:"sm",onClick:N,className:"h-6 w-6 p-0 hover:bg-gray-100",children:s.jsx(Gr,{className:"w-3 h-3"})})]})]}),f&&l&&s.jsx("div",{className:"absolute top-full left-0 right-0 z-[9999] mt-2 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",children:l.artists.length>0?s.jsxs("div",{ref:v,className:"max-h-[min(500px,calc(100vh-300px))] overflow-y-auto overscroll-contain synth-scrollbar",style:{scrollBehavior:"smooth"},children:[l.artists.map((k,P)=>s.jsxs("div",{className:ke("relative px-4 py-3 cursor-pointer transition-all duration-150","flex items-center gap-3","hover:bg-gray-50",p===P&&"bg-blue-50"),onClick:()=>_(k),onMouseEnter:()=>g(P),children:[p===P&&s.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-blue-500 rounded-r"}),s.jsx("div",{className:"flex-shrink-0",children:k.image_url?s.jsx("img",{src:k.image_url,alt:k.name,className:"w-12 h-12 rounded-full object-cover ring-2 ring-gray-100"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-pink-100 to-purple-100 flex items-center justify-center ring-2 ring-gray-100",children:s.jsx($t,{className:"w-6 h-6 text-pink-500"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm leading-tight truncate",children:k.name}),k.genres&&k.genres.length>0&&s.jsx("p",{className:"text-xs text-gray-500 mt-0.5 truncate",children:S(k.genres)})]})]},k.id)),l.totalFound>l.artists.length&&s.jsxs("div",{className:"sticky bottom-0 px-4 py-2 text-xs text-gray-500 text-center bg-gray-50 border-t border-gray-200",children:["Showing ",l.artists.length," of ",l.totalFound," artists"]})]}):s.jsxs("div",{className:"px-6 py-12 text-center text-gray-500",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:s.jsx($t,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No artists found"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Try a different search term"})]})})]})}class U8{static searchVenues(t,r=20,n=!1){return E(this,null,function*(){if(!t||t.length<2)return[];try{console.log(` Searching for venues: "${t}" (useApi: ${n})`);let a=[];try{a=yield this.getFuzzyMatchedResults(t,r),console.log(` Found ${a.length} venues from local database`)}catch(i){console.warn("  Could not get fuzzy results from database:",i)}if(!n)return console.log(` Returning ${a.length} results from local database (no API call)`),a;console.log(" Explicit search triggered - searching for new venues in database...");try{a=yield this.getFuzzyMatchedResults(t,r),console.log(` Final database results: ${a.length}`)}catch(i){console.warn("  Could not get final results from database:",i)}return a.length>0?a:(console.log(" No venues found in database"),[])}catch(a){return console.error(" Error in venue search:",a),[]}})}static searchJamBaseAPI(t,r){return E(this,null,function*(){return[]})}static getFallbackVenues(t,r){const n=[{id:"madison-square-garden",name:"Madison Square Garden",identifier:"jambase:msg-1",image:"https://picsum.photos/300/300?random=1",address:{streetAddress:"4 Pennsylvania Plaza",addressLocality:"New York",addressRegion:"NY",postalCode:"10001",addressCountry:"US"},geo:{latitude:40.7505,longitude:-73.9934},maximumAttendeeCapacity:20789,num_upcoming_events:25},{id:"hollywood-bowl",name:"Hollywood Bowl",identifier:"jambase:hb-1",image:"https://picsum.photos/300/300?random=2",address:{streetAddress:"2301 N Highland Ave",addressLocality:"Los Angeles",addressRegion:"CA",postalCode:"90068",addressCountry:"US"},geo:{latitude:34.1122,longitude:-118.339},maximumAttendeeCapacity:17500,num_upcoming_events:30},{id:"the-factory",name:"The Factory",identifier:"jambase:factory-1",image:"https://picsum.photos/300/300?random=3",address:{streetAddress:"123 Factory St",addressLocality:"St. Louis",addressRegion:"MO",postalCode:"63101",addressCountry:"US"},geo:{latitude:38.627,longitude:-90.1994},maximumAttendeeCapacity:2500,num_upcoming_events:15},{id:"red-rocks",name:"Red Rocks Amphitheatre",identifier:"jambase:rr-1",image:"https://picsum.photos/300/300?random=4",address:{streetAddress:"18300 W Alameda Pkwy",addressLocality:"Morrison",addressRegion:"CO",postalCode:"80465",addressCountry:"US"},geo:{latitude:39.6654,longitude:-105.2056},maximumAttendeeCapacity:9525,num_upcoming_events:40},{id:"brooklyn-bowl",name:"Brooklyn Bowl",identifier:"jambase:bb-1",image:"https://picsum.photos/300/300?random=5",address:{streetAddress:"61 Wythe Ave",addressLocality:"Brooklyn",addressRegion:"NY",postalCode:"11249",addressCountry:"US"},geo:{latitude:40.7214,longitude:-73.9575},maximumAttendeeCapacity:1200,num_upcoming_events:15},{id:"the-fillmore",name:"The Fillmore",identifier:"jambase:tf-1",image:"https://picsum.photos/300/300?random=6",address:{streetAddress:"1805 Geary Blvd",addressLocality:"San Francisco",addressRegion:"CA",postalCode:"94115",addressCountry:"US"},geo:{latitude:37.7849,longitude:-122.4334},maximumAttendeeCapacity:1250,num_upcoming_events:20},{id:"house-of-blues",name:"House of Blues",identifier:"jambase:hob-1",image:"https://picsum.photos/300/300?random=7",address:{streetAddress:"225 Decatur St",addressLocality:"New Orleans",addressRegion:"LA",postalCode:"70130",addressCountry:"US"},geo:{latitude:29.9584,longitude:-90.0644},maximumAttendeeCapacity:1e3,num_upcoming_events:18},{id:"radio-city-music-hall",name:"Radio City Music Hall",identifier:"jambase:rcmh-1",image:"https://picsum.photos/300/300?random=8",address:{streetAddress:"1260 6th Ave",addressLocality:"New York",addressRegion:"NY",postalCode:"10020",addressCountry:"US"},geo:{latitude:40.76,longitude:-73.9798},maximumAttendeeCapacity:6e3,num_upcoming_events:12},{id:"the-greek-theatre",name:"The Greek Theatre",identifier:"jambase:tgt-1",image:"https://picsum.photos/300/300?random=9",address:{streetAddress:"2700 N Vermont Ave",addressLocality:"Los Angeles",addressRegion:"CA",postalCode:"90027",addressCountry:"US"},geo:{latitude:34.1183,longitude:-118.3003},maximumAttendeeCapacity:5900,num_upcoming_events:22}],a=n.filter(i=>{var o,l,c,d;return i.name.toLowerCase().includes(t.toLowerCase())||((l=(o=i.address)==null?void 0:o.addressLocality)==null?void 0:l.toLowerCase().includes(t.toLowerCase()))||((d=(c=i.address)==null?void 0:c.addressRegion)==null?void 0:d.toLowerCase().includes(t.toLowerCase()))});return a.length===0?n.slice(0,r):a.slice(0,r)}static populateVenueProfiles(t){return E(this,null,function*(){var n,a,i,o,l,c,d,u,f;const r=[];if(!t||t.length===0)return r;for(const h of t)try{const p=((n=h.identifier)==null?void 0:n.split(":")[1])||h.identifier,{data:g,error:v}=yield T.from("venues_with_external_ids").select("*").eq("jambase_venue_id",p).maybeSingle();if(g&&!v){console.log(`  Venue ${h.name} already exists in database`),r.push(H(M({},g),{address:{streetAddress:g.address,addressLocality:g.city,addressRegion:g.state,postalCode:g.zip,addressCountry:g.country},geo:{latitude:g.latitude,longitude:g.longitude}}));continue}if(v&&(v.code==="PGRST116"||v.code==="42P01")){console.warn(`  venues table doesn't exist yet. Skipping database operations for ${h.name}`),r.push({id:h.id,jambase_venue_id:p,name:h.name,address:h.address,geo:h.geo,maximum_attendee_capacity:h.maximumAttendeeCapacity,num_upcoming_events:h["x-numUpcomingEvents"]||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),identifier:h.identifier});continue}if(v){console.warn(`  Database error checking venue ${h.name}:`,v),r.push({id:h.id,jambase_venue_id:p,name:h.name,address:h.address,geo:h.geo,maximum_attendee_capacity:h.maximumAttendeeCapacity,num_upcoming_events:h["x-numUpcomingEvents"]||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),identifier:h.identifier});continue}const y={name:h.name,identifier:h.identifier,address:((a=h.address)==null?void 0:a.streetAddress)||null,city:((i=h.address)==null?void 0:i.addressLocality)||null,state:((o=h.address)==null?void 0:o.addressRegion)||null,zip:((l=h.address)==null?void 0:l.postalCode)||null,country:((c=h.address)==null?void 0:c.addressCountry)||"US",latitude:((d=h.geo)==null?void 0:d.latitude)||null,longitude:((u=h.geo)==null?void 0:u.longitude)||null,image_url:h.image,url:h.url,date_published:new Date().toISOString(),date_modified:new Date().toISOString()},{data:_}=yield T.from("venues_with_external_ids").select("id").eq("jambase_venue_id",h.id).maybeSingle();let w;if(_){const{data:b,error:N}=yield T.from("venues").update(y).eq("id",_.id).select().single();if(N)console.error(` Error updating venue ${h.name}:`,N),w=_;else{w=b;try{yield T.from("external_entity_ids").upsert({entity_type:"venue",entity_uuid:w.id,source:"jambase",external_id:p},{onConflict:"entity_uuid,source,entity_type"}).select()}catch(S){}}}else{const{data:b,error:N}=yield T.from("venues").insert(y).select().single();if(N)console.error(` Error inserting venue ${h.name}:`,N),w=null;else{w=b;try{yield T.from("external_entity_ids").insert({entity_type:"venue",entity_uuid:w.id,source:"jambase",external_id:p}).select()}catch(S){}}}if(!w){console.error(` Failed to save venue ${h.name}`);continue}console.log(` Saved venue ${h.name} to database`),r.push(H(M({},w),{address:{streetAddress:w.address,addressLocality:w.city,addressRegion:w.state,postalCode:w.zip,addressCountry:w.country},geo:{latitude:w.latitude,longitude:w.longitude}}))}catch(p){console.error(` Error processing venue ${h.name}:`,p),r.push({id:h.id,jambase_venue_id:((f=h.identifier)==null?void 0:f.split(":")[1])||h.identifier,name:h.name,address:h.address,geo:h.geo,maximum_attendee_capacity:h.maximumAttendeeCapacity,num_upcoming_events:h["x-numUpcomingEvents"]||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),identifier:h.identifier,last_synced_at:new Date().toISOString()});continue}return r})}static getFuzzyMatchedResults(t,r){return E(this,null,function*(){try{const n=t.trim(),i=n.split(/\s+/).length===1&&n.length>0?`${n}%`:`%${n}%`,{data:o,error:l}=yield T.from("venues").select("*").ilike("name",i).order("num_upcoming_events",{ascending:!1,nullsFirst:!1}).limit(Math.max(r*5,100));return l?(l.code==="PGRST116"||l.code==="42P01"?console.warn("  venues table doesn't exist yet. Returning empty results for fuzzy matching."):console.warn(`  Database error getting venues: ${l.message}`),[]):!o||o.length===0?(console.log(" No venues found in database"),[]):Array.isArray(o)?o.filter(u=>typeof u=="object"&&u!==null&&typeof u.id=="string"&&typeof u.name=="string").map(u=>({id:u.id,name:u.name,identifier:u.identifier||`manual:${u.id}`,image_url:u.image_url||void 0,address:{streetAddress:u.street_address||void 0,addressLocality:void 0,addressRegion:u.state||void 0,postalCode:u.zip||void 0,addressCountry:u.country||void 0},geo:(()=>{if(u.geo)try{if(typeof u.geo=="object"&&u.geo!==null)return{latitude:u.geo.latitude||u.latitude,longitude:u.geo.longitude||u.longitude};if(typeof u.geo=="string"){const f=JSON.parse(u.geo);return{latitude:f.latitude||u.latitude,longitude:f.longitude||u.longitude}}}catch(f){}if(u.latitude&&u.longitude)return{latitude:u.latitude,longitude:u.longitude}})(),maximumAttendeeCapacity:u.maximum_attendee_capacity||void 0,num_upcoming_events:u.num_upcoming_events||0,match_score:this.calculateFuzzyMatchScore(t,u.name),is_from_database:!0})).filter(u=>u.match_score>5).sort((u,f)=>f.match_score!==u.match_score?f.match_score-u.match_score:(f.num_upcoming_events||0)-(u.num_upcoming_events||0)).slice(0,r):(console.warn("  Invalid venue data received from database"),[])}catch(n){return console.error(" Error getting fuzzy matched results:",n),[]}})}static calculateFuzzyMatchScore(t,r){const n=t.toLowerCase().trim(),a=r.toLowerCase().trim();if(a===n)return 100;if(a.startsWith(n))return 95;const i=n.split(/\s+/),o=a.split(/\s+/);let l=0;for(const h of i)o.includes(h)&&l++;if(l>0)return 85+l/i.length*10;if(a.includes(n))return 75;let c=0;for(const h of i)for(const p of o)if(p.includes(h)||h.includes(p)){c++;break}if(c>0)return 60+c/i.length*15;const d=this.levenshteinDistance(n,a),u=Math.max(n.length,a.length),f=1-d/u;return Math.round(f*50)}static levenshteinDistance(t,r){const n=Array(r.length+1).fill(null).map(()=>Array(t.length+1).fill(null));for(let a=0;a<=t.length;a++)n[0][a]=a;for(let a=0;a<=r.length;a++)n[a][0]=a;for(let a=1;a<=r.length;a++)for(let i=1;i<=t.length;i++){const o=t[i-1]===r[a-1]?0:1;n[a][i]=Math.min(n[a][i-1]+1,n[a-1][i]+1,n[a-1][i-1]+o)}return n[r.length][t.length]}static getVenueSuggestions(t,r=10){return E(this,null,function*(){return this.searchVenues(t,r)})}}function q8({onVenueSelect:e,placeholder:t="Search for a venue...",className:r,hideClearButton:n=!1,onSearchStateChange:a}){const[i,o]=x.useState(""),[l,c]=x.useState([]),[d,u]=x.useState(!1),[f,h]=x.useState(!1),[p,g]=x.useState(-1),v=x.useRef(null),y=x.useRef(null);x.useEffect(()=>{if(!i.trim()){c([]),h(!1),a==null||a(!1);return}const P=setTimeout(()=>E(this,null,function*(){yield _(i)}),300);return()=>clearTimeout(P)},[i]),x.useEffect(()=>{const P=A=>{if(!(!f||!l))switch(A.key){case"ArrowDown":A.preventDefault(),g(R=>R<l.length-1?R+1:R);break;case"ArrowUp":A.preventDefault(),g(R=>R>0?R-1:-1);break;case"Enter":A.preventDefault(),p>=0&&p<l.length&&w(l[p]);break;case"Escape":h(!1),g(-1);break}};return document.addEventListener("keydown",P),()=>document.removeEventListener("keydown",P)},[f,l,p]),x.useEffect(()=>{if(p>=0&&v.current){const P=v.current.children[p];P&&P.scrollIntoView({block:"nearest"})}},[p]);const _=P=>E(this,null,function*(){try{u(!0);const A=yield U8.searchVenues(P,10);c(A),h(!0),g(-1),a==null||a(!0)}catch(A){console.error("Venue search error:",A),c([]),h(!0)}finally{u(!1)}}),w=P=>{var R,$;try{On.click("venue",P.id||P.identifier||P.name,{source:"venue_search_box",name:P.name,city:(R=P.address)==null?void 0:R.addressLocality,state:($=P.address)==null?void 0:$.addressRegion})}catch(O){}e(P),o(P.name),h(!1),g(-1),a==null||a(!1);const A=document.getElementById("venue-search-input");A==null||A.blur()};x.useEffect(()=>{const P=A=>{const R=A.target,$=y.current;$&&!$.contains(R)&&(h(!1),g(-1),a==null||a(!1))};if(f){const A=setTimeout(()=>{document.addEventListener("mousedown",P)},100);return()=>{clearTimeout(A),document.removeEventListener("mousedown",P)}}},[f]);const b=()=>{l&&l.length>0&&h(!0)},N=P=>{var R;const A=P.relatedTarget;A&&((R=v.current)!=null&&R.contains(A))||setTimeout(()=>{h(!1),g(-1),a==null||a(!1)},100)},S=()=>{o(""),c([]),h(!1),g(-1),a==null||a(!1);const P=document.getElementById("venue-search-input");P==null||P.focus()},k=P=>{var R,$;const A=[];return(R=P.address)!=null&&R.addressLocality&&A.push(P.address.addressLocality),($=P.address)!=null&&$.addressRegion&&A.push(P.address.addressRegion),A.join(", ")};return s.jsxs("div",{ref:y,className:ke("relative w-full",r),children:[s.jsxs("div",{className:"relative",children:[s.jsx(SearchBar,{value:i,onChange:P=>o(P),placeholder:t,widthVariant:"full",id:"venue-search-input",name:"venueSearch",onFocus:b,onBlur:N}),s.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[d&&s.jsx(lr,{className:"w-4 h-4 animate-spin text-gray-400"}),i&&!d&&!n&&s.jsx(le,{type:"button",variant:"ghost",size:"sm",onClick:S,className:"h-6 w-6 p-0 hover:bg-gray-100",children:s.jsx(Gr,{className:"w-3 h-3"})})]})]}),f&&l&&s.jsx("div",{className:"absolute top-full left-0 right-0 z-[9999] mt-2 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",children:l.length>0?s.jsx("div",{ref:v,className:"max-h-[min(500px,calc(100vh-300px))] overflow-y-auto overscroll-contain synth-scrollbar",style:{scrollBehavior:"smooth"},children:l.map((P,A)=>s.jsxs("div",{className:ke("relative px-4 py-3 cursor-pointer transition-all duration-150","flex items-center gap-3","hover:bg-gray-50",p===A&&"bg-blue-50"),onClick:R=>{R.preventDefault(),R.stopPropagation(),w(P)},onMouseDown:R=>{R.preventDefault(),R.stopPropagation()},onMouseEnter:()=>g(A),children:[p===A&&s.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-blue-500 rounded-r"}),s.jsx("div",{className:"flex-shrink-0",children:P.image_url?s.jsx("img",{src:P.image_url,alt:P.name,className:"w-12 h-12 rounded-full object-cover ring-2 ring-gray-100"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-100 to-indigo-100 flex items-center justify-center ring-2 ring-gray-100",children:s.jsx(gr,{className:"w-6 h-6 text-blue-500"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm leading-tight truncate",children:P.name}),k(P)&&s.jsx("p",{className:"text-xs text-gray-500 mt-0.5 truncate",children:k(P)})]})]},P.id))}):s.jsxs("div",{className:"px-6 py-12 text-center text-gray-500",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:s.jsx(gr,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No venues found"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Try a different search term"})]})})]})}const lT=e=>{const t=new Date(e),r=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),a=new Date(r.getFullYear(),r.getMonth(),r.getDate());return n>=a?"upcoming":"past"},S5=e=>lT(e)==="past",V8=(e,t)=>e.filter(r=>lT(r.event_date)===t),gde=e=>V8(e,"upcoming"),vde=e=>V8(e,"past");function VN({formData:e,errors:t,onUpdateFormData:r,onClose:n}){const[a,i]=J.useState(""),[o,l]=J.useState([]),[c,d]=J.useState(!1),[u,f]=J.useState(!1);J.useEffect(()=>{const N=setTimeout(()=>E(this,null,function*(){const S=a.trim();if(S.length<2){l([]);return}try{d(!0);const{data:k,error:P}=yield T.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date, artist_id, venue_id").or(`artist_name_normalized.ilike.%${S}%,title.ilike.%${S}%,venue_name_normalized.ilike.%${S}%`).order("event_date",{ascending:!1}).limit(50);if(!P&&k){const R=k.filter($=>S5($.event_date)).sort(($,O)=>new Date(O.event_date).getTime()-new Date($.event_date).getTime());l(R),f(!0)}else l([]),f(!1)}finally{d(!1)}}),300);return()=>clearTimeout(N)},[a]);const h=N=>E(this,null,function*(){const S=N!=null&&N.event_date?String(N.event_date).split("T")[0]:"",k=(N==null?void 0:N.artist_name_normalized)||(N==null?void 0:N.artist_name),P=k?{id:N.artist_id||`manual-${k}`,name:k,is_from_database:!!N.artist_id}:null;let A=null;const R=(N==null?void 0:N.venue_name_normalized)||(N==null?void 0:N.venue_name);if(R)try{if(N.venue_id){const{data:O}=yield T.from("venues").select("id, name, identifier").eq("id",N.venue_id).single();O&&(A={id:O.id,name:O.name,identifier:O.identifier,is_from_database:!0})}A||(A={id:N.venue_id||`manual-${R}`,name:R,is_from_database:!!N.venue_id})}catch(O){console.error("Error looking up venue:",O);const z=(N==null?void 0:N.venue_name_normalized)||(N==null?void 0:N.venue_name)||"Unknown Venue";A={id:N.venue_id||`manual-${z}`,name:z,is_from_database:!1}}const $={reviewType:"event"};P&&($.selectedArtist=P),A&&($.selectedVenue=A),S&&($.eventDate=S),r($),f(!1),P&&_(!0),A&&b(!0)}),p=N=>{console.log(" Artist selected in EventDetailsStep:",{name:N.name,id:N.id}),r({selectedArtist:N}),_(!0)},g=N=>{console.log(" Venue selected in EventDetailsStep:",{name:N.name,id:N.id,is_from_database:N.is_from_database,identifier:N.identifier}),console.log(" Before update - formData.selectedVenue:",e.selectedVenue),console.log(" Before update - venueLocked:",w),r({selectedVenue:N}),console.log(" After update - setting venueLocked to true"),b(!0)},v=N=>{r({eventDate:N.target.value})},[y,_]=J.useState(!!e.selectedArtist),[w,b]=J.useState(!!e.selectedVenue);return console.log(" EventDetailsStep: Debug:",{hasSelectedArtist:!!e.selectedArtist,artistLocked:y,shouldShowButton:!e.selectedArtist||!y,hasSetlist:!!e.selectedSetlist}),J.useEffect(()=>{e.selectedArtist?_(!0):_(!1)},[e.selectedArtist]),J.useEffect(()=>{e.selectedVenue?b(!0):b(!1)},[e.selectedVenue]),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Ht,{className:"text-sm font-medium",children:"Quick search existing event (optional)"}),n&&s.jsx(le,{variant:"ghost",size:"sm",onClick:n,className:"h-8 w-8 p-0","aria-label":"Close",children:s.jsx(Gr,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Ar,{placeholder:"Search by artist, event title, or venue...","aria-label":"Quick search existing event",value:a,onChange:N=>i(N.target.value),onFocus:()=>{o.length>0&&f(!0)}}),u&&(o.length>0||c)&&s.jsxs("div",{className:"absolute z-20 mt-1 w-full max-h-64 overflow-auto rounded-md border bg-white shadow",children:[c&&s.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"Searching"}),!c&&o.map(N=>(lT(N.event_date),S5(N.event_date),s.jsxs("button",{type:"button",className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50 border-l-4 border-l-green-500 bg-green-50/30",onClick:()=>h(N),children:[s.jsx("div",{className:"font-medium text-gray-900",children:N.title||`${N.artist_name_normalized||N.artist_name||"Artist"} @ ${N.venue_name_normalized||N.venue_name||"Venue"}`}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center justify-between",children:[s.jsxs("span",{children:[N.artist_name_normalized||N.artist_name||"Artist","  ",N.venue_name_normalized||N.venue_name||"Venue","  ",new Date(N.event_date).toLocaleDateString()]}),s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Past Event"})]})]},N.id))),!c&&o.length===0&&s.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No past events found"})]})]})]}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Event Details"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Tell us about the concert you attended"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-start",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"artist",className:"text-sm font-medium",children:"Artist or Band *"}),!e.selectedArtist||!y?s.jsx(h1,{onArtistSelect:p,placeholder:"Search for an artist or band...",className:"w-full",hideClearButton:!!e.selectedArtist}):s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200",children:[s.jsx("div",{children:s.jsx("p",{className:"text-sm font-medium text-green-800",children:e.selectedArtist.name})}),s.jsx("button",{className:"text-xs text-red-600",onClick:()=>{r({selectedArtist:null}),_(!1)},children:""})]})}),t.selectedArtist&&s.jsx("p",{className:"text-sm text-red-600",children:t.selectedArtist})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"venue",className:"text-sm font-medium",children:"Venue *"}),(()=>{var N;return console.log(" Venue render check:",{hasSelectedVenue:!!e.selectedVenue,venueLocked:w,selectedVenueName:(N=e.selectedVenue)==null?void 0:N.name,shouldShowSearch:!e.selectedVenue||!w}),null})(),!e.selectedVenue||!w?s.jsx(q8,{onVenueSelect:g,placeholder:"Search for a venue...",className:"w-full",hideClearButton:!!e.selectedVenue}):s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-green-800",children:e.selectedVenue.name}),e.selectedVenue.address&&s.jsx("p",{className:"text-xs text-green-700",children:[e.selectedVenue.address.addressLocality,e.selectedVenue.address.addressRegion].filter(Boolean).join(", ")})]}),s.jsx("button",{className:"text-xs text-red-600",onClick:()=>{r({selectedVenue:null}),b(!1)},children:""})]}),t.selectedVenue&&s.jsx("p",{className:"text-sm text-red-600",children:t.selectedVenue})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ht,{htmlFor:"eventDate",className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(It,{className:"w-4 h-4"}),"Date *"]}),s.jsx(Ar,{id:"eventDate",type:"date",value:e.eventDate,onChange:v,className:"w-full",max:new Date().toISOString().split("T")[0]}),t.eventDate&&s.jsx("p",{className:"text-sm text-red-600",children:t.eventDate})]})]}),e.selectedArtist&&e.selectedVenue&&e.eventDate&&s.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[s.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Event Summary"}),s.jsxs("div",{className:"text-sm text-blue-800",children:[s.jsx("p",{children:s.jsx("button",{className:"font-bold hover:text-blue-600 hover:underline cursor-pointer",onClick:N=>{var k,P;N.preventDefault(),N.stopPropagation();const S=new CustomEvent("open-artist-card",{detail:{artistId:(k=e.selectedArtist)==null?void 0:k.id,artistName:(P=e.selectedArtist)==null?void 0:P.name}});document.dispatchEvent(S)},"aria-label":`View artist ${e.selectedArtist.name}`,children:e.selectedArtist.name})}),s.jsxs("p",{children:["at"," ",s.jsx("button",{className:"font-bold hover:text-blue-600 hover:underline cursor-pointer",onClick:N=>{var k,P;N.preventDefault(),N.stopPropagation();const S=new CustomEvent("open-venue-card",{detail:{venueId:(k=e.selectedVenue)==null?void 0:k.id,venueName:(P=e.selectedVenue)==null?void 0:P.name}});document.dispatchEvent(S)},"aria-label":`View venue ${e.selectedVenue.name}`,children:e.selectedVenue.name})]}),s.jsxs("p",{children:["on ",new Date(e.eventDate+"T12:00:00").toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})]})]})]})]})}const ys=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx("textarea",M({className:ke("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r},t))});ys.displayName="Textarea";function uu({config:e,formData:t,errors:r,onUpdateFormData:n,children:a,previousVenueReview:i}){var _;const[o,l]=x.useState(null),c=t[e.ratingKey],d=t[e.feedbackKey],u=(_=o!=null?o:c)!=null?_:0,f=i&&(e.ratingKey==="venueRating"||e.ratingKey==="locationRating"),h=()=>{if(!i||!f)return;const w={};if(e.ratingKey==="venueRating"){const b=i.venue_rating;if(b){const N=typeof b=="number"?b:parseFloat(String(b));!isNaN(N)&&N>0&&(w.venueRating=N)}i.venue_feedback&&(w.venueFeedback=i.venue_feedback)}else if(e.ratingKey==="locationRating"){const b=i.location_rating;if(b){const N=typeof b=="number"?b:parseFloat(String(b));!isNaN(N)&&N>0&&(w.locationRating=N)}i.location_feedback&&(w.locationFeedback=i.location_feedback)}n(w)},p=x.useMemo(()=>u?`${u.toFixed(1)} / 5.0`:"Not rated yet",[u]),g=w=>{n({[e.ratingKey]:w})},v=w=>{const b={};if(!d||d.trim().length===0)b[e.feedbackKey]=w.description||w.label;else{const N=d.trim(),S=w.description||w.label;b[e.feedbackKey]=N+(N?" ":"")+S}n(b)},y=w=>d&&(d.includes(w.label)||d.includes(w.description||""));return s.jsxs("div",{className:"space-y-6 w-full max-w-full overflow-x-hidden",children:[s.jsxs("header",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Step"}),s.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-900 break-words",children:e.title}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 max-w-full mx-auto break-words",children:e.subtitle})]}),s.jsx("section",{className:"bg-gradient-to-br from-pink-50 via-rose-50 to-fuchsia-50 border border-pink-200/60 rounded-2xl p-4 sm:p-6 shadow-sm text-center space-y-4 w-full max-w-full overflow-x-hidden",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-pink-600 font-semibold",children:"Your rating"}),s.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4 flex-wrap",children:[s.jsx("div",{className:"flex items-center flex-shrink-0",onMouseLeave:()=>l(null),children:Array.from({length:5},(w,b)=>{const N=b+1,S=N,k=N-.5,P=u>=S,A=!P&&u===k;return s.jsxs("div",{className:"relative w-8 h-8 sm:w-10 sm:h-10 cursor-pointer flex-shrink-0",children:[s.jsx(Qt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-300"}),(P||A)&&s.jsx("div",{className:ke("absolute left-0 top-0 h-full overflow-hidden pointer-events-none",P?"w-full":"w-1/2"),children:s.jsx(Qt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-pink-500 fill-current"})}),s.jsx("button",{type:"button","aria-label":`Set ${e.title} rating to ${k.toFixed(1)} stars`,className:"absolute left-0 top-0 h-full w-1/2",onMouseEnter:()=>l(k),onFocus:()=>l(k),onBlur:()=>l(null),onClick:()=>g(k)}),s.jsx("button",{type:"button","aria-label":`Set ${e.title} rating to ${S.toFixed(1)} stars`,className:"absolute right-0 top-0 h-full w-1/2",onMouseEnter:()=>l(S),onFocus:()=>l(S),onBlur:()=>l(null),onClick:()=>g(S)})]},b)})}),s.jsx("span",{className:"text-2xl sm:text-3xl font-extrabold text-gray-900 break-words",children:p})]}),e.helperText&&s.jsx("p",{className:"text-xs text-pink-500 break-words",children:e.helperText}),r[e.ratingKey]&&s.jsx("p",{className:"text-xs sm:text-sm text-red-600 break-words",children:r[e.ratingKey]})]})}),f&&s.jsx("section",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4 w-full max-w-full overflow-x-hidden",children:s.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-xs sm:text-sm font-medium text-blue-900 break-words",children:"Copy from previous review at this venue?"}),s.jsx("p",{className:"text-xs text-blue-700 mt-1 break-words",children:"You've reviewed this venue before. Copy your venue and location ratings and feedback."})]}),s.jsxs(le,{type:"button",variant:"outline",size:"sm",onClick:h,className:"sm:ml-4 border-blue-300 text-blue-700 hover:bg-blue-100 flex-shrink-0",children:[s.jsx(pQ,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),"Copy"]})]})}),s.jsxs("section",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[s.jsx(Ht,{htmlFor:`${e.ratingKey}-feedback`,className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:"Add a quick note (optional)"}),s.jsx(ys,{id:`${e.ratingKey}-feedback`,placeholder:"Share any highlights or watch-outs for future fans...",value:d,onChange:w=>n({[e.feedbackKey]:w.target.value}),rows:4,className:"resize-none text-sm sm:text-base w-full max-w-full min-w-0",maxLength:400}),s.jsxs("p",{className:"text-xs text-gray-400 text-right",children:[(d||"").length,"/400"]})]}),s.jsxs("section",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Need inspiration? Tap a vibe:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:e.suggestions.map(w=>s.jsx(le,{type:"button",variant:y(w)?"default":"outline",className:ke("px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm rounded-full border flex-shrink-0",w.sentiment==="positive"?"border-emerald-200 text-emerald-700 hover:bg-emerald-50":"border-rose-200 text-rose-700 hover:bg-rose-50",y(w)&&"bg-pink-500 text-white hover:bg-pink-600 border-transparent"),onClick:()=>v(w),children:w.label},w.id))})]}),a&&s.jsx("section",{className:"space-y-4 w-full max-w-full overflow-x-hidden",children:a})]})}class yde{constructor(){Cr(this,"DEFAULT_OPTIONS",{maxSizeMB:5,allowedTypes:["image/jpeg","image/jpg","image/png","image/webp","image/heic"],compressionQuality:.8})}uploadPhoto(i,o,l){return E(this,arguments,function*(t,r,n,a={}){var _,w,b;const c=M(M({},this.DEFAULT_OPTIONS),a);if(!((_=c.allowedTypes)!=null&&_.includes(t.type)))throw new Error(`Invalid file type. Allowed types: ${(w=c.allowedTypes)==null?void 0:w.join(", ")}`);const d=(c.maxSizeMB||5)*1024*1024;if(t.size>d)throw new Error(`File size exceeds ${c.maxSizeMB}MB limit. Current size: ${(t.size/1024/1024).toFixed(2)}MB`);const u=yield this.processImage(t,c),f=((b=t.name.split(".").pop())==null?void 0:b.toLowerCase())||"jpg",h=`${Date.now()}-${Math.random().toString(36).substring(7)}.${f}`,p=`${n}/${h}`,{data:g,error:v}=yield T.storage.from(r).upload(p,u,{cacheControl:"3600",upsert:!1});if(v)throw console.error("Upload error:",v),new Error(`Failed to upload photo: ${v.message}`);const{data:{publicUrl:y}}=T.storage.from(r).getPublicUrl(g.path);return{url:y,path:g.path}})}uploadPhotos(i,o,l){return E(this,arguments,function*(t,r,n,a={}){const c=t.map(d=>this.uploadPhoto(d,r,n,a));return Promise.all(c)})}deletePhoto(t,r){return E(this,null,function*(){const{error:n}=yield T.storage.from(t).remove([r]);if(n)throw console.error("Delete error:",n),new Error(`Failed to delete photo: ${n.message}`)})}deletePhotos(t,r){return E(this,null,function*(){const{error:n}=yield T.storage.from(t).remove(r);if(n)throw console.error("Delete error:",n),new Error(`Failed to delete photos: ${n.message}`)})}getPathFromUrl(t,r){try{return new URL(t).pathname.split(`/storage/v1/object/public/${r}/`)[1]||null}catch(n){return null}}processImage(t,r){return E(this,null,function*(){return t.size<5e5||r.compressionQuality===1?t:new Promise((n,a)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var c;const l=new Image;l.src=(c=o.target)==null?void 0:c.result,l.onload=()=>{const d=document.createElement("canvas");let u=l.width,f=l.height;const h=1920;(u>h||f>h)&&(u>f?(f=f/u*h,u=h):(u=u/f*h,f=h)),d.width=u,d.height=f;const p=d.getContext("2d");p==null||p.drawImage(l,0,0,u,f),d.toBlob(g=>{g?n(g):a(new Error("Failed to compress image"))},t.type,r.compressionQuality||.8)},l.onerror=()=>a(new Error("Failed to load image"))},i.onerror=()=>a(new Error("Failed to read file"))})})}validateImage(t,r={}){var i,o;const n=M(M({},this.DEFAULT_OPTIONS),r);if(!((i=n.allowedTypes)!=null&&i.includes(t.type)))return{valid:!1,error:`Invalid file type. Please use: ${(o=n.allowedTypes)==null?void 0:o.join(", ")}`};const a=(n.maxSizeMB||5)*1024*1024;return t.size>a?{valid:!1,error:`File too large. Maximum size: ${n.maxSizeMB}MB`}:{valid:!0}}uploadVideo(i,o,l){return E(this,arguments,function*(t,r,n,a={}){var y,_,w;const c=M({maxSizeMB:100,allowedTypes:["video/mp4","video/webm","video/quicktime","video/x-msvideo","video/3gpp","video/x-flv"]},a);if(!((y=c.allowedTypes)!=null&&y.includes(t.type)))throw new Error(`Invalid file type. Allowed types: ${(_=c.allowedTypes)==null?void 0:_.join(", ")}`);const d=(c.maxSizeMB||100)*1024*1024;if(t.size>d)throw new Error(`File size exceeds ${c.maxSizeMB}MB limit. Current size: ${(t.size/1024/1024).toFixed(2)}MB`);const u=((w=t.name.split(".").pop())==null?void 0:w.toLowerCase())||"mp4",f=`${Date.now()}-${Math.random().toString(36).substring(7)}.${u}`,h=`${n}/${f}`,{data:p,error:g}=yield T.storage.from(r).upload(h,t,{cacheControl:"3600",upsert:!1});if(g)throw console.error("Upload error:",g),new Error(`Failed to upload video: ${g.message}`);const{data:{publicUrl:v}}=T.storage.from(r).getPublicUrl(p.path);return{url:v,path:p.path}})}uploadVideos(i,o,l){return E(this,arguments,function*(t,r,n,a={}){const c=t.map(d=>this.uploadVideo(d,r,n,a));return Promise.all(c)})}deleteVideo(t,r){return E(this,null,function*(){const{error:n}=yield T.storage.from(t).remove([r]);if(n)throw console.error("Delete error:",n),new Error(`Failed to delete video: ${n.message}`)})}deleteVideos(t,r){return E(this,null,function*(){const{error:n}=yield T.storage.from(t).remove(r);if(n)throw console.error("Delete error:",n),new Error(`Failed to delete videos: ${n.message}`)})}validateVideo(t,r={}){var i,o;const n=M({maxSizeMB:100,allowedTypes:["video/mp4","video/webm","video/quicktime","video/x-msvideo","video/3gpp","video/x-flv"]},r);if(!((i=n.allowedTypes)!=null&&i.includes(t.type)))return{valid:!1,error:`Invalid file type. Please use: ${(o=n.allowedTypes)==null?void 0:o.join(", ")}`};const a=(n.maxSizeMB||100)*1024*1024;return t.size>a?{valid:!1,error:`File too large. Maximum size: ${n.maxSizeMB}MB`}:{valid:!0}}}const ii=new yde;function xde({value:e=[],onChange:t,userId:r,bucket:n,maxPhotos:a=5,maxSizeMB:i=5,label:o="Photos",helperText:l,className:c,disabled:d=!1}){const[u,f]=x.useState(!1),[h,p]=x.useState(0),g=x.useRef(null),{toast:v}=Rr(),y=b=>E(this,null,function*(){const N=Array.from(b.target.files||[]);if(N.length!==0){if(e.length+N.length>a){v({title:"Too many photos",description:`You can only upload up to ${a} photos`,variant:"destructive"});return}for(const S of N){const k=ii.validateImage(S,{maxSizeMB:i});if(!k.valid){v({title:"Invalid file",description:k.error,variant:"destructive"});return}}f(!0),p(0);try{const S=[];for(let k=0;k<N.length;k++){const P=yield ii.uploadPhoto(N[k],n,r,{maxSizeMB:i});S.push(P.url),p((k+1)/N.length*100)}t([...e,...S]),v({title:"Upload successful",description:`${N.length} photo${N.length>1?"s":""} uploaded`})}catch(S){console.error("Upload error:",S),v({title:"Upload failed",description:S instanceof Error?S.message:"Failed to upload photos",variant:"destructive"})}finally{f(!1),p(0),g.current&&(g.current.value="")}}}),_=(b,N)=>E(this,null,function*(){try{const S=ii.getPathFromUrl(b,n);S&&(yield ii.deletePhoto(n,S));const k=e.filter((P,A)=>A!==N);t(k),v({title:"Photo removed",description:"Photo deleted successfully"})}catch(S){console.error("Delete error:",S),v({title:"Delete failed",description:"Failed to delete photo",variant:"destructive"})}}),w=()=>{var b;(b=g.current)==null||b.click()};return s.jsxs("div",{className:ke("space-y-3",c),children:[o&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium",children:o}),l&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.map((b,N)=>s.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100 group",children:[s.jsx("img",{src:b,alt:`Photo ${N+1}`,className:"w-full h-full object-cover"}),s.jsx("button",{type:"button",onClick:()=>_(b,N),disabled:d||u,className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",children:s.jsx(Gr,{className:"w-4 h-4"})})]},b)),e.length<a&&s.jsx("button",{type:"button",onClick:w,disabled:d||u,className:ke("aspect-square rounded-lg border-2 border-dashed border-gray-300 hover:border-gray-400","flex flex-col items-center justify-center gap-2 transition-colors","disabled:opacity-50 disabled:cursor-not-allowed",u&&"border-primary"),children:u?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-6 h-6 animate-spin text-primary"}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[h.toFixed(0),"%"]})]}):s.jsxs(s.Fragment,{children:[s.jsx(Nv,{className:"w-6 h-6 text-gray-400"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"Add Photo"})]})})]}),s.jsx("input",{ref:g,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,image/heic",multiple:!0,onChange:y,className:"hidden",disabled:d||u}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.length," / ",a," photos  Max ",i,"MB per photo"]})]})}function _de({value:e,onChange:t,userId:r,bucket:n,maxSizeMB:a=25,label:i="Photo",helperText:o,className:l,disabled:c=!1,aspectRatio:d="square"}){const[u,f]=x.useState(!1),[h,p]=x.useState(!1),g=x.useRef(null),v=x.useRef(null),{toast:y}=Rr(),_=()=>{var k;(k=g.current)==null||k.click()},w=()=>{var k;(k=v.current)==null||k.click()},b=k=>E(this,null,function*(){var R;const P=(R=k.target.files)==null?void 0:R[0];if(!P)return;p(!1);const A=ii.validateImage(P,{maxSizeMB:a});if(!A.valid){y({title:"Invalid file",description:A.error,variant:"destructive"});return}f(!0);try{if(e){const O=ii.getPathFromUrl(e,n);O&&(yield ii.deletePhoto(n,O).catch(console.error))}const $=yield ii.uploadPhoto(P,n,r,{maxSizeMB:a});t($.url),y({title:"Upload successful",description:"Photo uploaded successfully"})}catch($){console.error("Upload error:",$),y({title:"Upload failed",description:$ instanceof Error?$.message:"Failed to upload photo",variant:"destructive"})}finally{f(!1),v.current&&(v.current.value=""),g.current&&(g.current.value="")}}),N=()=>E(this,null,function*(){if(e)try{const k=ii.getPathFromUrl(e,n);k&&(yield ii.deletePhoto(n,k)),t(null),y({title:"Photo removed",description:"Photo deleted successfully"})}catch(k){console.error("Delete error:",k),y({title:"Delete failed",description:"Failed to delete photo",variant:"destructive"})}}),S=()=>{var k;(k=v.current)==null||k.click()};return s.jsxs("div",{className:ke("space-y-3",l),children:[i&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium",children:i}),o&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:o})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:ke("relative w-24 h-24 bg-gray-100 overflow-hidden group",d==="circle"?"rounded-full":"rounded-lg"),children:e?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:e,alt:"Upload",className:"w-full h-full object-cover"}),s.jsx("button",{type:"button",onClick:N,disabled:c||u,className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",children:s.jsx(Gr,{className:"w-6 h-6 text-white"})})]}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(kv,{className:"w-8 h-8 text-gray-400"})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx(le,{type:"button",variant:"outline",onClick:S,disabled:c||u,className:"w-full",children:u?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Nv,{className:"w-4 h-4 mr-2"}),e?"Change Photo":"Upload Photo"]})}),o&&s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:o})]})]}),s.jsx("input",{ref:g,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,image/heic",onChange:b,className:"hidden",disabled:c||u,capture:"environment"}),s.jsx("input",{ref:v,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,image/heic",onChange:b,className:"hidden",disabled:c||u}),h&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4 text-center",children:"Choose Photo Source"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(le,{onClick:_,className:"w-full flex items-center justify-center gap-3 py-3",variant:"outline",disabled:c||u,children:[s.jsx(Nv,{className:"w-5 h-5"}),"Take Photo"]}),s.jsxs(le,{onClick:w,className:"w-full flex items-center justify-center gap-3 py-3",variant:"outline",disabled:c||u,children:[s.jsx(kv,{className:"w-5 h-5"}),"Choose from Gallery"]})]}),s.jsx(le,{onClick:()=>p(!1),variant:"ghost",className:"w-full mt-4",children:"Cancel"})]})})]})}function wde({value:e=[],onChange:t,userId:r,bucket:n,maxVideos:a=3,maxSizeMB:i=100,label:o="Videos",helperText:l,className:c,disabled:d=!1}){const[u,f]=x.useState(!1),[h,p]=x.useState(0),g=x.useRef(null),{toast:v}=Rr(),y=b=>E(this,null,function*(){const N=Array.from(b.target.files||[]);if(N.length!==0){if(e.length+N.length>a){v({title:"Too many videos",description:`You can only upload up to ${a} videos`,variant:"destructive"});return}for(const S of N){const k=ii.validateVideo(S,{maxSizeMB:i});if(!k.valid){v({title:"Invalid file",description:k.error,variant:"destructive"});return}}f(!0),p(0);try{const S=[];for(let k=0;k<N.length;k++){const P=yield ii.uploadVideo(N[k],n,r,{maxSizeMB:i});S.push(P.url),p((k+1)/N.length*100)}t([...e,...S]),v({title:"Upload successful",description:`${N.length} video${N.length>1?"s":""} uploaded`})}catch(S){console.error("Upload error:",S),v({title:"Upload failed",description:S instanceof Error?S.message:"Failed to upload videos",variant:"destructive"})}finally{f(!1),p(0),g.current&&(g.current.value="")}}}),_=(b,N)=>E(this,null,function*(){try{const S=ii.getPathFromUrl(b,n);S&&(yield ii.deleteVideo(n,S));const k=e.filter((P,A)=>A!==N);t(k),v({title:"Video removed",description:"Video deleted successfully"})}catch(S){console.error("Delete error:",S),v({title:"Delete failed",description:"Failed to delete video",variant:"destructive"})}}),w=()=>{var b;(b=g.current)==null||b.click()};return s.jsxs("div",{className:ke("space-y-3",c),children:[o&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium",children:o}),l&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.map((b,N)=>s.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100 group",children:[s.jsx("video",{src:b,className:"w-full h-full object-cover",muted:!0,playsInline:!0}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:s.jsx("div",{className:"bg-black/50 rounded-full p-2",children:s.jsx(IQ,{className:"w-6 h-6 text-white",fill:"white"})})}),s.jsx("button",{type:"button",onClick:()=>_(b,N),disabled:d||u,className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",children:s.jsx(Gr,{className:"w-4 h-4"})})]},b)),e.length<a&&s.jsx("button",{type:"button",onClick:w,disabled:d||u,className:ke("aspect-square rounded-lg border-2 border-dashed border-gray-300 hover:border-gray-400","flex flex-col items-center justify-center gap-2 transition-colors","disabled:opacity-50 disabled:cursor-not-allowed",u&&"border-primary"),children:u?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-6 h-6 animate-spin text-primary"}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[h.toFixed(0),"%"]})]}):s.jsxs(s.Fragment,{children:[s.jsx(DF,{className:"w-6 h-6 text-gray-400"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"Add Video"})]})})]}),s.jsx("input",{ref:g,type:"file",accept:"video/mp4,video/webm,video/quicktime,video/x-msvideo,video/3gpp,video/x-flv",multiple:!0,onChange:y,className:"hidden",disabled:d||u}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.length," / ",a," videos  Max ",i,"MB per video"]})]})}function bde({value:e,onChange:t,userId:r,metOnSynth:n,onMetOnSynthChange:a}){const[i,o]=x.useState(""),[l,c]=x.useState([]),[d,u]=x.useState(!1),[f,h]=x.useState(""),[p,g]=x.useState(""),v=x.useRef(null);x.useEffect(()=>{if(!i.trim()){c([]);return}const b=setTimeout(()=>E(this,null,function*(){u(!0);try{const{data:N,error:S}=yield T.from("users").select("user_id, name, avatar_url").ilike("name",`%${i}%`).neq("user_id",r).order("name",{ascending:!0}).limit(10);S?(console.error("Error searching users:",S),c([])):c(N||[])}catch(N){console.error("Error searching users:",N),c([])}finally{u(!1)}}),300);return()=>clearTimeout(b)},[i,r]),x.useEffect(()=>{const b=N=>{v.current&&!v.current.contains(N.target)&&o("")};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]);const y=b=>{const N={type:"user",user_id:b.user_id,name:b.name,avatar_url:b.avatar_url};e.some(k=>k.type==="user"&&k.user_id===b.user_id)||t([...e,N]),o("")},_=b=>{t(e.filter((N,S)=>S!==b))},w=()=>{if(!f.trim())return;const b={type:"phone",phone:f,name:p.trim()||void 0};e.some(S=>S.type==="phone"&&S.phone===f)||t([...e,b]),h(""),g("")};return s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"relative",ref:v,children:s.jsx(Xi,{value:i,onChange:b=>o(b),placeholder:"Search Synth users or invite by phone...",widthVariant:"full"})}),i&&s.jsx("div",{className:"w-full bg-white border-2 border-pink-200 rounded-lg shadow-2xl max-h-[500px] overflow-y-auto",children:d?s.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Searching..."}):l.length>0?s.jsxs(s.Fragment,{children:[l.map(b=>{const N=e.some(S=>S.type==="user"&&S.user_id===b.user_id);return s.jsxs("button",{onClick:()=>y(b),disabled:N,className:"w-full flex items-center gap-3 p-3 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsxs(Vr,{className:"h-10 w-10",children:[s.jsx(sn,{src:b.avatar_url,alt:b.name}),s.jsx(Wr,{children:b.name.charAt(0)})]}),s.jsx("div",{className:"flex-1 text-left",children:s.jsx("p",{className:"text-sm font-medium text-gray-900",children:b.name})}),N&&s.jsx("span",{className:"text-xs text-green-600",children:"Added"})]},b.user_id)}),s.jsxs("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[s.jsx(Ht,{className:"text-xs font-semibold text-gray-700 mb-2 block",children:"Add by Phone"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Input,{type:"tel",placeholder:"Phone: +1234567890",value:f,onChange:b=>h(b.target.value),className:"text-sm"}),s.jsx(Input,{type:"text",placeholder:"Name (optional)",value:p,onChange:b=>g(b.target.value),className:"text-sm"}),s.jsx(le,{size:"sm",onClick:w,disabled:!f.trim(),className:"w-full text-sm",children:"Add Contact"})]})]})]}):s.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"No users found. Use the phone option below to add them."})}),e.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:e.map((b,N)=>s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 rounded-full",children:[b.type==="user"?s.jsxs(s.Fragment,{children:[s.jsxs(Vr,{className:"h-6 w-6",children:[s.jsx(sn,{src:b.avatar_url,alt:b.name}),s.jsx(Wr,{children:b.name.charAt(0)})]}),s.jsx("span",{className:"text-sm text-gray-900",children:b.name})]}):s.jsxs(s.Fragment,{children:[s.jsx(DQ,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{className:"text-sm text-gray-900",children:b.name||b.phone})]}),s.jsx("button",{onClick:()=>_(N),className:"ml-1 text-gray-400 hover:text-gray-600",children:s.jsx(Gr,{className:"h-4 w-4"})})]},N))}),e.length>0&&e.some(b=>b.type==="user")&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",id:"metOnSynth",checked:n,onChange:b=>a(b.target.checked),className:"h-4 w-4 rounded border-gray-300 text-pink-600 focus:ring-pink-500"}),s.jsx(Ht,{htmlFor:"metOnSynth",className:"text-sm text-gray-700 cursor-pointer",children:"Did you meet or plan this on Synth?"})]})]})}function k5({formData:e,errors:t,onUpdateFormData:r,maxCharacters:n=500}){const{user:a}=xs(),i=e.reviewText.length,o=i>n*.8;return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("header",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Almost there"}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Share the story"}),s.jsx("p",{className:"text-sm text-gray-600 max-w-xl mx-auto",children:"Bring the show to life with a short recap and any photos you snapped."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(Ht,{htmlFor:"reviewText",className:"text-base font-semibold text-gray-900",children:"Overall Experience *"}),s.jsx(ys,{id:"reviewText",placeholder:"What made this night unforgettable? Any standout moments future fans should know?",value:e.reviewText,onChange:l=>r({reviewText:l.target.value}),rows:6,className:"resize-none text-base",maxLength:n}),s.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[s.jsx("span",{children:"Minimum 1-2 sentences is perfect."}),s.jsxs("span",{className:ke(o?"text-orange-600":"text-gray-500"),children:[i,"/",n]})]}),t.reviewText&&s.jsx("p",{className:"text-sm text-red-600",children:t.reviewText})]}),a&&s.jsx(xde,{value:e.photos||[],onChange:l=>r({photos:l}),userId:a.id,bucket:"review-photos",maxPhotos:5,maxSizeMB:5,label:"Photos (Optional)",helperText:"Add up to 5 photos to give fans a feel for the night."}),a&&s.jsx(wde,{value:e.videos||[],onChange:l=>r({videos:l}),userId:a.id,bucket:"review-videos",maxVideos:3,maxSizeMB:100,label:"Videos (Optional)",helperText:"Add videos from the event (max 100MB per video)"}),a&&s.jsx(He,{className:"border-2 border-pink-100 bg-gradient-to-br from-pink-50/50 to-purple-50/30",children:s.jsxs(et,{className:"p-8 pb-12",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[s.jsx(zr,{className:"w-6 h-6 text-pink-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Who tagged along? (Optional)"})]}),s.jsx(bde,{value:e.attendees,onChange:l=>r({attendees:l}),userId:a.id,metOnSynth:e.metOnSynth,onMetOnSynthChange:l=>r({metOnSynth:l})})]})})]})}var jde="Separator",E5="horizontal",Nde=["horizontal","vertical"],W8=x.forwardRef((e,t)=>{const c=e,{decorative:r,orientation:n=E5}=c,a=me(c,["decorative","orientation"]),i=Sde(n)?n:E5,l=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return s.jsx(Ct.div,H(M(M({"data-orientation":i},l),a),{ref:t}))});W8.displayName=jde;function Sde(e){return Nde.includes(e)}var H8=W8;const ll=x.forwardRef((i,a)=>{var o=i,{className:e,orientation:t="horizontal",decorative:r=!0}=o,n=me(o,["className","orientation","decorative"]);return s.jsx(H8,M({ref:a,decorative:r,orientation:t,className:ke("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e)},n))});ll.displayName=H8.displayName;const C5="https://synth-beta-testing.vercel.app",kde=()=>{if(typeof window=="undefined")return"http://localhost:3001";const e=window.location.hostname;return e==="localhost"||e.startsWith("127.0.0.1")||e.startsWith("192.168.")||e.startsWith("10.0.")||e.startsWith("172.")?"http://localhost:3001":window.Capacitor?"https://synth-beta-testing.vercel.app":""};class Hf{static searchSetlists(t){return E(this,null,function*(){const r=this.buildQueryString(t),a=`${kde()}/api/setlists/search?${r}`;try{console.log(" SetlistService: Making request to setlist.fm API via backend proxy:",a);const i=yield fetch(a,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!i.ok){if(i.status===404)return console.log(" No results from setlist.fm API"),null;throw new Error(`Backend API error: ${i.status} ${i.statusText}`)}const o=yield i.json();return!o.setlist||o.setlist.length===0?(console.log(" No results from setlist.fm API"),null):(console.log(" SetlistService: Received setlists from setlist.fm API:",o.setlist.length),o.setlist)}catch(i){console.error(" Error with setlist.fm API proxy:",i);const o=new Error("setlist-service-offline");throw o.name="SetlistServiceOfflineError",o}})}static buildQueryString(t){const r=new URLSearchParams;return t.artistName&&r.append("artistName",t.artistName),t.date&&r.append("date",t.date),t.venueName&&r.append("venueName",t.venueName),t.cityName&&r.append("cityName",t.cityName),t.stateCode&&r.append("stateCode",t.stateCode),r.toString()}static searchSetlistsViaServerless(t,r){return E(this,null,function*(){var n;try{const a=`/api/setlists/search?${r}`;console.log(" SetlistService: Trying serverless proxy:",a);const i=yield fetch(a,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!i.ok){if(i.status===404)return null;throw new Error(`Serverless proxy error: ${i.status} ${i.statusText}`)}if(!((n=i.headers.get("content-type"))!=null?n:"").includes("application/json"))return console.warn(" Serverless proxy returned non-JSON payload"),null;const l=yield i.json();return!l.setlist||l.setlist.length===0?null:(console.log(" SetlistService: Received setlists from serverless proxy:",l.setlist.length),l.setlist)}catch(a){return console.warn(" Serverless setlist proxy failed:",a),null}})}static searchSetlistsViaRemoteProxy(t,r){return E(this,null,function*(){var n,a;try{const i=`${C5}/api/setlists/search?${r}`;console.log(" SetlistService: Trying remote proxy:",i);const o=yield fetch(i,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!o.ok){if(o.status===404)return null;try{yield fetch(`${C5}/api/setlists/health`,{method:"GET"})}catch(h){console.warn(" Remote proxy health check failed:",h)}const d=yield fetch(i,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!d.ok)throw new Error(`Remote proxy error: ${d.status} ${d.statusText}`);if(!((n=d.headers.get("content-type"))!=null?n:"").includes("application/json"))return console.warn(" Remote proxy retry returned non-JSON payload"),null;const f=yield d.json();return!f.setlist||f.setlist.length===0?null:(console.log(" SetlistService: Received setlists from remote proxy (retry):",f.setlist.length),f.setlist)}if(!((a=o.headers.get("content-type"))!=null?a:"").includes("application/json"))return console.warn(" Remote proxy returned non-JSON payload"),null;const c=yield o.json();return!c.setlist||c.setlist.length===0?null:(console.log(" SetlistService: Received setlists from remote proxy:",c.setlist.length),c.setlist)}catch(i){return console.warn(" Remote setlist proxy failed:",i),null}})}static searchSetlistsFromDatabase(t){return E(this,null,function*(){try{let r=T.from("events").select("id, setlist, artist_id, venue_id, event_date").not("setlist","is",null);if(t.artistName){const{data:o}=yield T.from("artists").select("id").ilike("name",`%${t.artistName}%`).limit(1).maybeSingle();if(o!=null&&o.id)r=r.eq("artist_id",o.id);else return null}if(t.venueName){const{data:o}=yield T.from("venues").select("id").ilike("name",`%${t.venueName}%`).limit(1).maybeSingle();if(o!=null&&o.id)r=r.eq("venue_id",o.id);else return null}if(t.date){const o=t.date.trim();if(/^\d{4}-\d{2}-\d{2}$/.test(o)){const l=new Date(o+"T00:00:00Z"),c=new Date(o+"T23:59:59Z");r=r.gte("event_date",l.toISOString()).lte("event_date",c.toISOString())}else r=r.eq("event_date",o)}const{data:n,error:a}=yield r.limit(10);if(a)return console.error(" Supabase setlist fallback error:",a),null;if(!n||n.length===0)return null;const i=n.map(o=>o.setlist).filter(o=>!!o);return i.length===0?null:(console.log(" SetlistService: Served setlists from Supabase cache:",i.length),i)}catch(r){return console.error(" Supabase setlist fallback exception:",r),null}})}static getSetlistForEvent(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("events").select("setlist, setlist_enriched, setlist_song_count, setlist_fm_id, event_date").eq("id",t).single();if(n)throw n;return r!=null&&r.setlist?r.setlist:null}catch(r){return console.error("Error getting setlist for event:",r),null}})}static searchSetlistsByArtist(t,r){return E(this,null,function*(){return this.searchSetlists({artistName:t,date:r})})}static searchSetlistsByArtistAndVenue(t,r,n){return E(this,null,function*(){return this.searchSetlists({artistName:t,venueName:r,date:n})})}}function G8({isOpen:e,onClose:t,artistName:r,venueName:n,eventDate:a,onSetlistSelect:i}){const[o,l]=x.useState([]),[c,d]=x.useState(!1),[u,f]=x.useState(null),[h,p]=x.useState("none"),[g,v]=x.useState(null),{toast:y}=Rr();x.useEffect(()=>{e&&r&&_()},[e,r,n,a]);const _=()=>E(this,null,function*(){try{d(!0),f(null),p("none"),console.log(" SetlistModal: fetchSetlists called with:",{artistName:r,venueName:n,eventDate:a,eventDateType:typeof a});let S=[];if(n&&a)try{console.log(" Searching by artist, venue, and date:",{artistName:r,venueName:n,eventDate:a});const R=yield Hf.searchSetlistsByArtistAndVenue(r,n,a);R&&R.length>0&&(console.log(` Found ${R.length} results from venue+date search`),S=[...S,...R])}catch(R){console.warn(" Venue+date search failed:",R)}if(S.length>0){console.log(" Using venue+date results, skipping additional searches to avoid rate limits"),l(S),d(!1);return}if(a)try{console.log(" Searching by artist and date:",{artistName:r,eventDate:a});const R=yield Hf.searchSetlistsByArtist(r,a);R&&R.length>0&&(console.log(` Found ${R.length} results from artist+date search`),S=[...S,...R])}catch(R){console.warn(" Artist+date search failed:",R)}if(S.length>0){console.log(" Using artist+date results, skipping additional searches to avoid rate limits"),l(S),d(!1);return}try{console.log(" Searching by artist only:",{artistName:r});const R=yield Hf.searchSetlistsByArtist(r);R&&R.length>0&&(console.log(` Found ${R.length} results from artist-only search`),S=[...S,...R])}catch(R){console.warn(" Artist-only search failed:",R)}const k=S.filter(R=>{var B;const $=r.toLowerCase().trim(),O=(((B=R.artist)==null?void 0:B.name)||"").toLowerCase().trim();return O===$||O.split(" ")[0]===$&&O.length<=$.length+2});console.log(` Filtered ${S.length} results to ${k.length} matching artist name`),console.log(" Filtered results:",k.map(R=>{var $;return($=R.artist)==null?void 0:$.name}));const A=k.filter((R,$,O)=>$===O.findIndex(z=>z.setlistFmId===R.setlistFmId)).sort((R,$)=>{if(!a)return 0;const O=new Date(a),z=new Date(R.eventDate),D=new Date($.eventDate),B=z.toDateString()===O.toDateString(),F=D.toDateString()===O.toDateString();if(B&&!F)return-1;if(!B&&F)return 1;const U=Math.abs(z.getTime()-O.getTime()),G=Math.abs(D.getTime()-O.getTime());return U-G});if(console.log(" Final sorted setlists:",A.length),l(A),a&&A.length>0){const R=A.find($=>{const O=w($.eventDate),z=w(a)||new Date(a);return O?O.toDateString()===z.toDateString():!1});R&&(console.log(" Auto-selecting exact date match:",R.eventDate),v(R))}A.length===0&&(p("not-found"),f("We couldnt find official setlists for this artist. Feel free to add the songs manually below."))}catch(S){console.error("Error fetching setlists:",S),S instanceof Error&&S.name==="SetlistServiceOfflineError"?(p("offline"),f("Setlist import is offline. Start the local proxy or add the setlist manually in the form."),y({title:"Setlist import unavailable",description:"Run `npm run backend:dev` in another terminal or enter the songs manually.",variant:"destructive"})):(p("generic"),f("Failed to fetch setlists. Please try again."),y({title:"Error",description:"Failed to fetch setlists. Please try again.",variant:"destructive"}))}finally{d(!1)}}),w=S=>{if(!S)return null;try{if(S.includes("-")&&S.length===10){const P=S.split("-");if(P.length===3){if(P[0].length===2&&P[1].length===2&&P[2].length===4){const A=parseInt(P[2],10),R=parseInt(P[1],10)-1,$=parseInt(P[0],10);return new Date(A,R,$)}else if(P[0].length===4)return new Date(S)}}const k=new Date(S);if(!isNaN(k.getTime()))return k}catch(k){}return null},b=S=>{const k=w(S);return!k||isNaN(k.getTime())?(console.warn("Invalid date string:",S),"Date TBD"):k.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})},N=S=>{const k={};return S.forEach(P=>{k[P.setNumber]||(k[P.setNumber]=[]),k[P.setNumber].push(P)}),k};return e?s.jsx(pn,{open:e,onOpenChange:t,children:s.jsxs(dn,{className:"max-w-4xl w-[95vw] h-[90vh] max-h-[90vh] p-0 overflow-hidden flex flex-col",hideCloseButton:!0,children:[s.jsx(Vn,{className:"px-6 py-4 border-b border-gray-200 bg-white sticky top-0 z-10",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(bn,{className:"text-xl font-semibold",children:["Setlists for ",r]}),s.jsx(le,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0",children:s.jsx(Gr,{className:"h-4 w-4"})})]})}),s.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-6",children:[c&&s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(lr,{className:"h-8 w-8 animate-spin mr-3"}),s.jsx("span",{children:"Searching for setlists..."})]}),u&&!c&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx($t,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:h==="offline"?"Setlist Import Offline":h==="not-found"?"No Setlists Found":"Something Went Wrong"}),s.jsx("p",{className:"text-gray-600 mb-4 max-w-lg mx-auto whitespace-pre-wrap",children:u}),h==="offline"&&s.jsxs("div",{className:"bg-pink-50 border border-pink-100 rounded-lg p-4 text-left max-w-md mx-auto mb-6 text-sm text-pink-900",children:[s.jsx("p",{className:"font-medium mb-2",children:"To import from setlist.fm locally:"}),s.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[s.jsx("li",{children:"Open a new terminal window"}),s.jsxs("li",{children:["Run ",s.jsx("code",{className:"px-1 py-0.5 bg-white rounded border border-pink-200 text-xs",children:"npm run backend:dev"})]}),s.jsx("li",{children:"Keep it running while you use the import"})]}),s.jsx("p",{className:"mt-3",children:"Or close this modal and add the songs manually using the Add your own setlist section in the form."})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3",children:[s.jsx(le,{onClick:_,variant:"outline",children:"Try Again"}),s.jsx(le,{variant:"ghost",onClick:t,children:"Close & add manually"})]})]}),!c&&!u&&o.length>0&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Found ",o.length," setlist",o.length!==1?"s":""," for ",r]}),o.map((S,k)=>{const P=N(S.songs),A=(g==null?void 0:g.setlistFmId)===S.setlistFmId,R=w(S.eventDate),$=a?w(a)||new Date(a):null,O=a&&R&&$&&R.toDateString()===$.toDateString();return s.jsxs(He,{className:`overflow-hidden transition-all duration-200 ${A?"ring-2 ring-blue-500 shadow-lg":"hover:shadow-md"}`,children:[s.jsx(Er,{className:`bg-gradient-to-r from-purple-50 to-pink-50 ${A?"bg-gradient-to-r from-blue-50 to-indigo-50":""}`,children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(qr,{className:"text-lg",children:S.artist.name}),O&&s.jsx(Ke,{variant:"default",className:"bg-green-500 hover:bg-green-600",children:"Exact Match"}),A&&s.jsx(Ke,{variant:"default",className:"bg-blue-500 hover:bg-blue-600",children:"Selected"})]}),s.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(It,{className:"h-4 w-4"}),b(S.eventDate)]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(gr,{className:"h-4 w-4"}),S.venue.name,", ",S.venue.city,S.venue.state&&`, ${S.venue.state}`]}),S.tour&&s.jsx("div",{className:"text-purple-600 font-medium",children:S.tour})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs(Ke,{variant:"secondary",className:"mb-2",children:[S.songCount," songs"]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[Object.keys(P).length," set",Object.keys(P).length!==1?"s":""]})]})]})}),s.jsxs(et,{className:"p-6",children:[S.info&&s.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-800",children:S.info}),s.jsx("div",{className:"space-y-4",children:Object.entries(P).map(([z,D])=>{var B;return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ke,{variant:"outline",className:"font-medium",children:((B=D[0])==null?void 0:B.setName)||`Set ${z}`}),s.jsxs("span",{className:"text-sm text-gray-500",children:[D.length," song",D.length!==1?"s":""]})]}),s.jsx("div",{className:"space-y-1",children:D.map((F,U)=>s.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-500 w-8 text-right",children:[F.position,"."]}),s.jsx("span",{className:"text-sm flex-1",children:F.name}),F.cover&&s.jsx(Ke,{variant:"secondary",className:"text-xs",children:F.cover.artist}),F.tape&&s.jsx(Ke,{variant:"outline",className:"text-xs",children:"Tape"})]},U))}),parseInt(z)<Object.keys(P).length&&s.jsx(ll,{className:"my-4"})]},z)})}),s.jsx("div",{className:"mt-6 pt-4 border-t",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{variant:A?"default":"outline",size:"sm",onClick:()=>{v(S),i&&i(S),y({title:"Setlist Selected",description:`Selected setlist from ${S.venue.name} on ${b(S.eventDate)}`}),setTimeout(()=>{t()},1e3)},className:"flex-1",children:A?s.jsxs(s.Fragment,{children:[s.jsx($t,{className:"h-4 w-4 mr-2"}),"Selected"]}):s.jsxs(s.Fragment,{children:[s.jsx($t,{className:"h-4 w-4 mr-2"}),"Select This Setlist"]})}),s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>window.open(S.url,"_blank"),children:[s.jsx(Bo,{className:"h-4 w-4 mr-2"}),"View on Setlist.fm"]})]})})]})]},S.setlistFmId)})]})]})]})}):null}function y2({songs:e,onChange:t,className:r,disabled:n=!1}){const[a,i]=x.useState(!1),[o,l]=x.useState(null),[c,d]=x.useState({song_name:"",cover_artist:"",notes:""}),u=()=>{var _,w;if(!c.song_name.trim())return;const y={song_name:c.song_name.trim(),cover_artist:((_=c.cover_artist)==null?void 0:_.trim())||void 0,notes:((w=c.notes)==null?void 0:w.trim())||void 0,position:e.length+1};t([...e,y]),d({song_name:"",cover_artist:"",notes:""}),i(!1)},f=y=>{const _=e[y];d({song_name:_.song_name,cover_artist:_.cover_artist||"",notes:_.notes||""}),l(y),i(!0)},h=()=>{var _,w;if(o===null||!c.song_name.trim())return;const y=[...e];y[o]={song_name:c.song_name.trim(),cover_artist:((_=c.cover_artist)==null?void 0:_.trim())||void 0,notes:((w=c.notes)==null?void 0:w.trim())||void 0,position:o+1},t(y),d({song_name:"",cover_artist:"",notes:""}),l(null),i(!1)},p=()=>{d({song_name:"",cover_artist:"",notes:""}),l(null),i(!1)},g=y=>{const w=e.filter((b,N)=>N!==y).map((b,N)=>H(M({},b),{position:N+1}));t(w)},v=(y,_)=>{if(_==="up"&&y===0||_==="down"&&y===e.length-1)return;const w=_==="up"?y-1:y+1,b=[...e];[b[y],b[w]]=[b[w],b[y]];const N=b.map((S,k)=>H(M({},S),{position:k+1}));t(N)};return s.jsxs("div",{className:ke("space-y-3",r,n&&"opacity-50 pointer-events-none"),children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx($t,{className:ke("w-5 h-5",n?"text-gray-400":"text-purple-600")}),s.jsx(Ht,{className:ke("text-sm font-medium",n&&"text-gray-500"),children:n?"Custom Setlist (Disabled)":"Custom Setlist (Optional)"}),e.length>0&&s.jsxs(Ke,{variant:"secondary",className:ke(n?"bg-gray-100 text-gray-600":"bg-purple-100 text-purple-800"),children:[e.length," song",e.length!==1?"s":""]})]}),!a&&!n&&s.jsxs(le,{type:"button",variant:"outline",size:"sm",onClick:()=>i(!0),className:"text-purple-600 border-purple-300 hover:bg-purple-50",children:[s.jsx(Vo,{className:"w-4 h-4 mr-1"}),"Add Song"]})]}),s.jsx("p",{className:ke("text-xs",n?"text-gray-400":"text-gray-500"),children:n?"Custom setlist creation is disabled because an API setlist was selected.":"Create your own setlist for this show. Add songs in the order they were played."}),e.length>0&&s.jsx("div",{className:"space-y-2",children:e.map((y,_)=>s.jsx(He,{className:"border-purple-200 bg-purple-50/30",children:s.jsx(et,{className:"p-3",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs("div",{className:"flex flex-col gap-1 pt-1",children:[s.jsx("button",{type:"button",onClick:()=>v(_,"up"),disabled:_===0,className:"text-purple-400 hover:text-purple-600 disabled:opacity-30 disabled:cursor-not-allowed","aria-label":"Move up",children:s.jsx(Fk,{className:"w-4 h-4"})}),s.jsx("button",{type:"button",onClick:()=>v(_,"down"),disabled:_===e.length-1,className:"text-purple-400 hover:text-purple-600 disabled:opacity-30 disabled:cursor-not-allowed","aria-label":"Move down",children:s.jsx(Fk,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-purple-100 text-purple-700 font-semibold text-sm flex-shrink-0",children:_+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium text-purple-900",children:y.song_name}),y.cover_artist&&s.jsx("div",{className:"text-xs text-purple-600 mt-1",children:s.jsxs(Ke,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:["Cover: ",y.cover_artist]})}),y.notes&&s.jsxs("div",{className:"text-xs text-purple-700 mt-1 italic",children:['"',y.notes,'"']})]}),s.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[s.jsx(le,{type:"button",variant:"ghost",size:"sm",onClick:()=>f(_),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:s.jsx(TF,{className:"h-4 w-4"})}),s.jsx(le,{type:"button",variant:"ghost",size:"sm",onClick:()=>g(_),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:s.jsx(Dl,{className:"h-4 w-4"})})]})]})})},_))}),a&&s.jsxs(He,{className:"border-purple-300 bg-purple-50",children:[s.jsx(Er,{className:"pb-3",children:s.jsx("h4",{className:"text-sm font-semibold text-purple-900",children:o!==null?"Edit Song":"Add Song"})}),s.jsxs(et,{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"song_name",className:"text-xs font-medium text-purple-900",children:"Song Name *"}),s.jsx(Ar,{id:"song_name",value:c.song_name,onChange:y=>d(H(M({},c),{song_name:y.target.value})),placeholder:"Enter song name...",maxLength:200,className:"border-purple-200"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"cover_artist",className:"text-xs font-medium text-purple-900",children:"Cover Artist (Optional)"}),s.jsx(Ar,{id:"cover_artist",value:c.cover_artist,onChange:y=>d(H(M({},c),{cover_artist:y.target.value})),placeholder:"If this was a cover, enter original artist...",maxLength:100,className:"border-purple-200"}),s.jsx("p",{className:"text-xs text-purple-600",children:"Leave blank if it's an original by the performing artist"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"notes",className:"text-xs font-medium text-purple-900",children:"Special Notes (Optional)"}),s.jsx(ys,{id:"notes",value:c.notes,onChange:y=>d(H(M({},c),{notes:y.target.value})),placeholder:"Any special notes about this performance...",maxLength:300,rows:2,className:"border-purple-200 resize-none"}),s.jsx("p",{className:"text-xs text-purple-600",children:'E.g., "Extended guitar solo", "First time played live", "Crowd favorite"'})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs(le,{type:"button",onClick:o!==null?h:u,disabled:!c.song_name.trim(),className:"bg-purple-600 hover:bg-purple-700",children:[s.jsx(bP,{className:"w-4 h-4 mr-1"}),o!==null?"Save Changes":"Add Song"]}),s.jsxs(le,{type:"button",variant:"outline",onClick:p,className:"border-purple-300 text-purple-700 hover:bg-purple-50",children:[s.jsx(Gr,{className:"w-4 h-4 mr-1"}),"Cancel"]})]})]})]}),e.length===0&&!a&&s.jsxs("div",{className:"text-center py-6 border-2 border-dashed border-purple-200 rounded-lg bg-purple-50/30",children:[s.jsx($t,{className:"w-8 h-8 text-purple-300 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-purple-600 mb-2",children:"No songs added yet"}),s.jsxs(le,{type:"button",variant:"outline",size:"sm",onClick:()=>i(!0),className:"text-purple-600 border-purple-300 hover:bg-purple-50",children:[s.jsx(Vo,{className:"w-4 h-4 mr-1"}),"Add Your First Song"]})]})]})}function Ede({formData:e,errors:t,onUpdateFormData:r,artistName:n,venueName:a,eventDate:i}){var b,N,S;const[o,l]=x.useState(null),[c,d]=x.useState(!1),u=(b=o!=null?o:e.rating)!=null?b:0,f=e.reviewText.length,h=200,p=f>h*.8,g=k=>{r({selectedSetlist:k}),d(!1)},v=()=>{r({selectedSetlist:null})},y=k=>{r({customSetlist:k})},_=k=>{r({rating:k})},w=k=>{if(!k)return"";const P=new Date(k);return Number.isNaN(P.getTime())?"":P.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})};return s.jsxs("div",{className:"space-y-6 w-full max-w-full overflow-x-hidden",children:[s.jsxs("header",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Quick Review"}),s.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-900 break-words",children:"Share your experience"}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 max-w-full mx-auto break-words",children:"Rate the overall experience and share a brief recap."})]}),s.jsx("section",{className:"bg-gradient-to-br from-pink-50 via-rose-50 to-fuchsia-50 border border-pink-200/60 rounded-2xl p-4 sm:p-6 shadow-sm text-center space-y-4 w-full max-w-full overflow-x-hidden",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-pink-600 font-semibold",children:"Overall Rating"}),s.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4 flex-wrap",children:[s.jsx("div",{className:"flex items-center flex-shrink-0",onMouseLeave:()=>l(null),children:Array.from({length:5},(k,P)=>{const A=P+1,R=A,$=A-.5,O=u>=R,z=!O&&u===$;return s.jsxs("div",{className:"relative w-8 h-8 sm:w-10 sm:h-10 cursor-pointer flex-shrink-0",children:[s.jsx(Qt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-300"}),(O||z)&&s.jsx("div",{className:ke("absolute left-0 top-0 h-full overflow-hidden pointer-events-none",O?"w-full":"w-1/2"),children:s.jsx(Qt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-pink-500 fill-current"})}),s.jsx("button",{type:"button",className:"absolute inset-0",onMouseEnter:()=>l(R),onClick:()=>_(R),"aria-label":`Rate ${R} stars`}),s.jsx("button",{type:"button",className:"absolute inset-0 left-0 w-1/2",onMouseEnter:()=>l($),onClick:()=>_($),"aria-label":`Rate ${$} stars`})]},P)})}),s.jsx("span",{className:"text-base sm:text-lg font-semibold text-gray-700 break-words",children:u>0?`${u.toFixed(1)} / 5.0`:"Not rated yet"})]}),t.rating&&s.jsx("p",{className:"text-xs sm:text-sm text-red-600 break-words",children:t.rating})]})}),s.jsxs("div",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[s.jsx(Ht,{htmlFor:"reviewText",className:"text-sm sm:text-base font-semibold text-gray-900",children:"Brief Review *"}),s.jsx(ys,{id:"reviewText",placeholder:"What made this night memorable? Share a quick recap.",value:e.reviewText,onChange:k=>r({reviewText:k.target.value}),rows:4,className:"resize-none text-sm sm:text-base w-full max-w-full min-w-0",maxLength:h}),s.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[s.jsx("span",{className:"break-words",children:"Keep it brief - 1-2 sentences is perfect."}),s.jsxs("span",{className:ke(p?"text-orange-600":"text-gray-500","flex-shrink-0 ml-2"),children:[f,"/",h]})]}),t.reviewText&&s.jsx("p",{className:"text-xs sm:text-sm text-red-600 break-words",children:t.reviewText})]}),s.jsxs("div",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[s.jsx(Ht,{className:"text-sm sm:text-base font-semibold text-gray-900",children:"Setlist (Optional)"}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 break-words",children:"Add the setlist if you remember it"}),e.selectedSetlist?s.jsxs("div",{className:"p-3 sm:p-4 bg-pink-50 rounded-lg border border-pink-200 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx($t,{className:"w-4 h-4 sm:w-5 sm:h-5 text-pink-600 flex-shrink-0"}),s.jsx("span",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:"Setlist Selected"})]}),s.jsx(le,{type:"button",variant:"ghost",size:"sm",onClick:v,className:"h-8 w-8 p-0 flex-shrink-0",children:s.jsx(Gr,{className:"w-4 h-4"})})]}),s.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 break-words",children:[(N=e.selectedSetlist.artist)==null?void 0:N.name," - ",w(e.selectedSetlist.eventDate)]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.selectedSetlist.songCount||((S=e.selectedSetlist.songs)==null?void 0:S.length)||0," songs"]})]}):e.customSetlist.length>0?s.jsxs("div",{className:"p-3 sm:p-4 bg-pink-50 rounded-lg border border-pink-200 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx($t,{className:"w-4 h-4 sm:w-5 sm:h-5 text-pink-600 flex-shrink-0"}),s.jsx("span",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:"Custom Setlist"})]}),s.jsx(le,{type:"button",variant:"ghost",size:"sm",onClick:()=>r({customSetlist:[]}),className:"h-8 w-8 p-0 flex-shrink-0",children:s.jsx(Gr,{className:"w-4 h-4"})})]}),s.jsxs("p",{className:"text-xs sm:text-sm text-gray-600",children:[e.customSetlist.length," songs"]})]}):s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[s.jsxs(le,{type:"button",variant:"outline",onClick:()=>d(!0),className:"flex items-center justify-center gap-2 w-full sm:w-auto flex-shrink-0",children:[s.jsx($t,{className:"w-4 h-4"}),"Import from setlist.fm"]}),s.jsx(y2,{songs:e.customSetlist,onChange:y})]}),c&&n&&s.jsx(G8,{isOpen:c,onClose:()=>d(!1),artistName:n,venueName:a,eventDate:i,onSetlistSelect:g})]})]})}function WN({formData:e,errors:t,onUpdateFormData:r,onSubmit:n,isLoading:a,averageRating:i,categoryBreakdown:o}){var p,g,v,y,_,w,b,N;const l=S=>{r({isPublic:S})},c=S=>{if(!S)return"Date TBD";const k=new Date(S);return Number.isNaN(k.getTime())?"Date TBD":k.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},d=(S=0,k="sm")=>{const P=k==="lg"?"w-6 h-6":k==="md"?"w-5 h-5":"w-4 h-4",A=k==="lg"?"text-pink-200":"text-gray-300",R=k==="lg"?"text-white":"text-yellow-400";return Array.from({length:5},($,O)=>{const z=O+1,D=S>=z-.01,B=!D&&S>=z-.5&&S<z;return s.jsxs("div",{className:"relative",children:[s.jsx(Qt,{className:ke(P,D?`${R} fill-current drop-shadow`:A)}),B&&s.jsx("div",{className:"absolute inset-0 overflow-hidden w-1/2",children:s.jsx(Qt,{className:`${P} ${R} fill-current`})})]},O)})},u=Number.isFinite(i)&&i>0?Math.round(i*10)/10:0,f=u?u.toFixed(1):"",h=e.ticketPricePaid&&!Number.isNaN(Number(e.ticketPricePaid))?Number(e.ticketPricePaid).toFixed(2):null;return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Final Step"}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Review & Share"}),s.jsx("p",{className:"text-sm text-gray-600 max-w-2xl mx-auto",children:"Take a final look at your ratings, highlight anything fans should know, and choose who can see your review."})]}),s.jsx("section",{className:"rounded-3xl bg-gradient-to-br from-pink-500 via-rose-500 to-purple-500 text-white shadow-lg p-8 space-y-4",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.25em] text-white/80",children:"Average rating"}),s.jsxs("div",{className:"flex items-baseline gap-4 mt-2",children:[s.jsx("span",{className:"text-5xl font-bold tracking-tight",children:f}),s.jsx("div",{className:"flex items-center gap-1",children:d(u,"lg")})]}),s.jsx("p",{className:"text-sm text-white/80 mt-2",children:"Based on five categories of your concert experience."})]}),s.jsxs("div",{className:"flex flex-col items-start sm:items-end gap-2",children:[((p=e.selectedArtist)==null?void 0:p.name)&&((g=e.selectedVenue)==null?void 0:g.name)&&s.jsxs("div",{className:"text-sm font-medium",children:[(v=e.selectedArtist)==null?void 0:v.name," @ ",(y=e.selectedVenue)==null?void 0:y.name]}),e.eventDate&&s.jsxs("div",{className:"text-xs text-white/80 flex items-center gap-2",children:[s.jsx(It,{className:"w-4 h-4"}),c(e.eventDate)]})]})]})}),s.jsx("section",{className:"grid gap-4 md:grid-cols-2",children:o.map(S=>{var k;return s.jsx("div",{className:"rounded-xl border border-pink-100 bg-white shadow-sm p-4 space-y-3",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:S.label}),S.annotation&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:S.annotation})]}),s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsx("span",{className:"text-lg font-semibold text-gray-900",children:S.rating?S.rating.toFixed(1):""}),s.jsx("div",{className:"flex gap-0.5",children:d((k=S.rating)!=null?k:0,"sm")})]})]})},S.label)})}),s.jsx(He,{className:"border-gray-200 shadow-sm",children:s.jsxs(et,{className:"p-4",children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"What you're sharing"}),s.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[((_=e.selectedArtist)==null?void 0:_.name)&&((w=e.selectedVenue)==null?void 0:w.name)&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ta,{className:"w-4 h-4 text-green-500"}),s.jsxs("span",{children:[s.jsx("strong",{children:(b=e.selectedArtist)==null?void 0:b.name})," at"," ",s.jsx("strong",{children:(N=e.selectedVenue)==null?void 0:N.name})]})]}),e.eventDate&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ta,{className:"w-4 h-4 text-green-500"}),s.jsx("span",{children:c(e.eventDate)})]}),h&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ta,{className:"w-4 h-4 text-green-500"}),s.jsxs("span",{children:["Ticket price (kept private): $",h]})]}),e.reviewText&&s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(ta,{className:"w-4 h-4 text-green-500 mt-0.5"}),s.jsxs("span",{children:["Written story (",e.reviewText.length," characters)"]})]}),Array.isArray(e.photos)&&e.photos.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ta,{className:"w-4 h-4 text-green-500"}),s.jsxs("span",{children:[e.photos.length," photo",e.photos.length!==1?"s":""," attached"]})]})]})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(Ht,{className:"text-sm font-medium text-gray-900",children:"Who can see this review?"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"radio",id:"public",name:"privacy",checked:e.isPublic,onChange:()=>l(!0),className:"sr-only"}),s.jsxs("label",{htmlFor:"public",className:ke("flex items-center space-x-3 p-4 rounded-lg border-2 cursor-pointer transition-all duration-200",e.isPublic?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[s.jsx("div",{className:ke("w-5 h-5 rounded-full border-2 flex items-center justify-center",e.isPublic?"border-blue-500 bg-blue-500":"border-gray-300"),children:e.isPublic&&s.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ki,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-900",children:"Public"}),s.jsx(Ke,{variant:"secondary",className:"text-xs",children:"Recommended"})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Everyone can see your review. Help the community decide where to go."})]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"radio",id:"private",name:"privacy",checked:!e.isPublic,onChange:()=>l(!1),className:"sr-only"}),s.jsxs("label",{htmlFor:"private",className:ke("flex items-center space-x-3 p-4 rounded-lg border-2 cursor-pointer transition-all duration-200",e.isPublic?"border-gray-200 hover:border-gray-300":"border-blue-500 bg-blue-50"),children:[s.jsx("div",{className:ke("w-5 h-5 rounded-full border-2 flex items-center justify-center",e.isPublic?"border-gray-300":"border-blue-500 bg-blue-500"),children:!e.isPublic&&s.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ev,{className:"w-5 h-5 text-gray-600"}),s.jsx("span",{className:"font-medium text-gray-900",children:"Private"})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Only you can see this review. You can always share it later."})]})]})]})]})]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(yP,{className:"w-4 h-4 text-gray-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-gray-600",children:[s.jsx("p",{className:"font-medium mb-1",children:"About privacy:"}),s.jsxs("ul",{className:"space-y-1 text-xs",children:[s.jsx("li",{children:" Public reviews help the community discover amazing shows"}),s.jsx("li",{children:" You can change the privacy setting any time in your profile"}),s.jsx("li",{children:" Private reviews are only visible to you"}),s.jsx("li",{children:" All reviews follow Synths community guidelines"})]})]})]})}),s.jsxs("div",{className:"pt-6 pb-4",children:[s.jsx(le,{onClick:n,disabled:a,className:"w-full bg-pink-500 hover:bg-pink-600 text-white py-3 text-base font-medium",children:a?s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Submitting Review..."})]}):s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ta,{className:"w-5 h-5"}),s.jsx("span",{children:"Submit Review"})]})}),t.submit&&s.jsx("p",{className:"text-sm text-red-600 text-center mt-2",children:t.submit})]}),s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-xs text-gray-500",children:"By submitting, you agree to our terms of service and community guidelines."})})]})}function Cde({isOpen:e,onClose:t,userId:r,newReview:n,rating:a}){var $;console.log(" PostSubmitRankingModal MOUNTED/RENDERING with props:",{isOpen:e,userId:r==null?void 0:r.slice(0,8),newReviewId:($=n==null?void 0:n.id)==null?void 0:$.slice(0,8),rating:a});const[i,o]=x.useState([]),[l,c]=x.useState([]),[d,u]=x.useState(!0),[f,h]=x.useState(!1),[p,g]=x.useState(null),{toast:v}=Rr(),y=Math.round(a*10)/10;x.useEffect(()=>{var O;console.log(" PostSubmitRankingModal useEffect triggered:",{isOpen:e,userId:r==null?void 0:r.slice(0,8),rating:a,newReviewId:(O=n==null?void 0:n.id)==null?void 0:O.slice(0,8)}),e&&r?(console.log("   Conditions met, loading reviews..."),_()):console.log("   Conditions not met, skipping load")},[e,r,a]);const _=()=>E(this,null,function*(){u(!0);try{console.log(" Loading reviews for rating:",y,"userId:",r);const{reviews:O}=yield bs.getUserReviewHistory(r);console.log(" Total user reviews fetched:",O.length);const z=O.map(({review:D,event:B})=>H(M({},D),{event_title:B==null?void 0:B.title,artist_name:B==null?void 0:B.artist_name,venue_name:B==null?void 0:B.venue_name,event_date:B==null?void 0:B.event_date,effectiveRating:w(D),rank_order:D.rank_order||null})).filter(D=>{const B=Math.round(D.effectiveRating*10)/10,F=B===y;return console.log(`  Review ${D.id.slice(0,8)}: rating=${D.rating}, effective=${D.effectiveRating}, rounded=${B}, matches=${F}`),F});console.log(` Found ${z.length} reviews matching ${y}`),z.sort((D,B)=>D.rank_order!=null&&B.rank_order!=null?D.rank_order-B.rank_order:D.rank_order!=null?-1:B.rank_order!=null?1:new Date(B.created_at).getTime()-new Date(D.created_at).getTime()),o(z),c(z.map(D=>D.id))}catch(O){console.error(" Error loading reviews with same rating:",O),v({title:"Error",description:"Failed to load reviews for ranking",variant:"destructive"})}finally{u(!1)}}),w=O=>{const z=[O.artist_performance_rating,O.production_rating,O.venue_rating,O.location_rating,O.value_rating].filter(D=>typeof D=="number"&&D>0);if(z.length>0){const D=z.reduce((B,F)=>B+F,0)/z.length;return Math.round(D*10)/10}return O.rating||0};x.useEffect(()=>{console.log(" PostSubmitRankingModal state:",{isOpen:e,reviewsCount:i.length,displayRating:y,newReviewId:n.id})},[e,i.length,y,n.id]);const b=O=>{g(O)},N=(O,z)=>{if(O.preventDefault(),p===null||p===z)return;const D=[...l],B=D[p];D.splice(p,1),D.splice(z,0,B),c(D),g(z)},S=()=>{g(null)},k=(O,z)=>{console.log(" Moving review:",{index:O,direction:z,total:l.length});const D=z==="up"?O-1:O+1;if(D<0||D>=l.length){console.log(" Cannot move - out of bounds");return}const B=[...l],F=B[O];B[O]=B[D],B[D]=F,console.log(" New order:",B),c(B)},P=()=>E(this,null,function*(){h(!0);try{yield bs.setRankOrderForRatingGroup(r,y,l),v({title:"Rankings Saved! ",description:`Your ${y.toFixed(1)} reviews have been ranked.`}),t()}catch(O){console.error("Error saving rankings:",O),v({title:"Error",description:"Failed to save rankings. Please try again.",variant:"destructive"})}finally{h(!1)}}),A=()=>{t()},R=O=>i.find(z=>z.id===O);return d?s.jsx(pn,{open:e,onOpenChange:t,children:s.jsxs(dn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsx(Vn,{children:s.jsx(bn,{children:"Loading reviews..."})}),s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-pink-500 border-t-transparent rounded-full"})})]})}):!d&&i.length<=1?(console.log(" Only 1 or fewer reviews found, closing modal"),e&&setTimeout(()=>t(),100),null):s.jsx(pn,{open:e,onOpenChange:t,children:s.jsxs(dn,{className:"max-w-3xl max-h-[85vh] overflow-hidden flex flex-col",children:[s.jsxs(Vn,{children:[s.jsxs(bn,{className:"flex items-center gap-2",children:[s.jsx(Qt,{className:"w-5 h-5 text-yellow-400 fill-current"}),"Rank Your ",y.toFixed(1)," Reviews"]}),s.jsxs(os,{children:["You have ",i.length," reviews rated ",y.toFixed(1),". Drag to reorder them from your favorite (top) to least favorite (bottom). This helps us give you better recommendations!"]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto py-4 space-y-3",children:l.map((O,z)=>{const D=R(O);if(!D)return null;const B=D.id===n.id;return s.jsx(He,{draggable:!0,onDragStart:()=>b(z),onDragOver:F=>N(F,z),onDragEnd:S,className:ke("p-4 cursor-move transition-all",p===z&&"opacity-50",B&&"border-2 border-pink-500 bg-pink-50/50"),children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs("div",{className:"flex flex-col items-center justify-center pt-1",children:[s.jsx(Fk,{className:"w-5 h-5 text-gray-400"}),s.jsx("div",{className:"mt-1 flex items-center justify-center w-7 h-7 rounded-full bg-gray-100 text-sm font-semibold text-gray-700",children:z+1})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold text-gray-900 truncate",children:D.event_title||D.artist_name||"Concert"}),s.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm text-gray-600",children:[D.artist_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx($t,{className:"w-3.5 h-3.5"}),s.jsx("span",{className:"truncate",children:D.artist_name})]}),D.venue_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(gr,{className:"w-3.5 h-3.5"}),s.jsx("span",{className:"truncate",children:D.venue_name})]})]}),D.event_date&&s.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-gray-500",children:[s.jsx(It,{className:"w-3 h-3"}),s.jsx("span",{children:new Date(D.event_date).toLocaleDateString()})]}),D.review_text&&s.jsx("p",{className:"mt-2 text-sm text-gray-700 line-clamp-2",children:D.review_text})]}),B&&s.jsx("div",{className:"flex-shrink-0",children:s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-pink-100 text-pink-800",children:"New"})})]}),s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsx(le,{type:"button",variant:"outline",size:"sm",onClick:F=>{F.preventDefault(),F.stopPropagation(),k(z,"up")},disabled:z===0,className:"text-xs",children:" Move Up"}),s.jsx(le,{type:"button",variant:"outline",size:"sm",onClick:F=>{F.preventDefault(),F.stopPropagation(),k(z,"down")},disabled:z===l.length-1,className:"text-xs",children:" Move Down"})]})]})]})},D.id)})}),s.jsxs(Nh,{className:"gap-2",children:[s.jsx(le,{type:"button",variant:"outline",onClick:A,disabled:f,children:"Skip for Now"}),s.jsx(le,{type:"button",onClick:P,disabled:f,className:"bg-pink-500 hover:bg-pink-600",children:f?"Saving...":"Save Rankings"})]})]})})}const Pde=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,ju=e=>typeof e=="string"&&Pde.test(e),P5=e=>{var r,n;if(!e||typeof e!="object")return e;const t=M({},e);return"id"in t&&!ju(t.id)&&(typeof t.id=="string"&&(t.jambase_id=(r=t.jambase_id)!=null?r:t.id),t.id=null),"identifier"in t&&!ju(t.identifier)&&(t.jambase_identifier=(n=t.jambase_identifier)!=null?n:t.identifier),t};class Gf{static ensureEventArtistUuid(t,r){return E(this,null,function*(){var n,a,i;try{const{data:o,error:l}=yield T.from("events").select("id, artist_id, artist_name").eq("id",t).maybeSingle();if(l&&console.warn(" DraftReviewService: Failed to fetch event for artist resolution",l),o!=null&&o.artist_id){const f=o.artist_id.trim();if(ju(f))return f;{const{data:h}=yield T.from("artists_with_external_ids").select("id").eq("jambase_artist_id",f).maybeSingle();if(h!=null&&h.id)return h.id}}const c=r.selectedArtist||null;let d,u;if(c&&typeof c=="object"){const f=c.id;ju(f)&&(d=f),u=u||c.jambase_id||(typeof f=="string"&&!ju(f)?f:void 0)||(typeof c.identifier=="string"?(i=(a=(n=c.identifier).split)==null?void 0:a.call(n,":"))==null?void 0:i[1]:void 0)}if(!u&&(o!=null&&o.artist_id)){const f=o.artist_id.trim();ju(f)?d=f:f&&(u=f)}if(!d&&u){let f=yield T.from("artists_with_external_ids").select("id").eq("jambase_artist_id",u).limit(1);if(!f.error&&Array.isArray(f.data)&&f.data.length>0)d=f.data[0].id;else if(!f.error)try{const{UnifiedArtistSearchService:h}=yield kn(()=>E(this,null,function*(){const{UnifiedArtistSearchService:p}=yield Promise.resolve().then(()=>pde);return{UnifiedArtistSearchService:p}}),void 0,import.meta.url);yield h.searchArtists((c==null?void 0:c.name)||(o==null?void 0:o.artist_name)||"",20,!1),f=yield T.from("artists_with_external_ids").select("id").eq("jambase_artist_id",u).limit(1),!f.error&&Array.isArray(f.data)&&f.data.length>0&&(d=f.data[0].id)}catch(h){console.warn(" DraftReviewService: Artist search retry failed",h)}}if(d&&ju(d))return yield T.from("events").update({artist_uuid:d}).eq("id",t),d}catch(o){console.warn(" DraftReviewService: ensureEventArtistUuid encountered error",o)}})}static saveDraft(t,r,n){return E(this,null,function*(){try{if(console.log(" Saving draft:",{userId:t,eventId:r,draftData:n}),!t||!r)return console.error(" Missing required parameters:",{userId:t,eventId:r}),null;if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r))return console.error(" Event ID is not a valid UUID:",r),null;const{data:i,error:o}=yield T.from("reviews").select("id, is_draft").eq("user_id",t).eq("event_id",r).eq("is_draft",!1).maybeSingle();if(o&&o.code!=="PGRST116"&&console.error(" Error checking for existing published review:",o),i&&!i.is_draft)return console.log(" Draft save blocked: Published review already exists for this event"),console.log("   Published review ID:",i.id),null;const l=yield this.ensureEventArtistUuid(r,n),c=l?H(M({},n),{selectedArtist:n.selectedArtist?H(M({},n.selectedArtist),{id:l}):n.selectedArtist}):n,d=H(M({},c),{selectedArtist:P5(c.selectedArtist),selectedVenue:P5(c.selectedVenue)}),{data:u,error:f}=yield T.rpc("save_review_draft",{p_user_id:t,p_event_id:r,p_draft_data:d});return f?(console.error(" Error saving draft:",f),console.error(" Error details:",JSON.stringify(f,null,2)),null):(console.log(" Draft saved successfully:",u),u)}catch(a){return console.error(" Exception saving draft:",a),null}})}static getUserDrafts(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("get_user_draft_reviews",{p_user_id:t});return n?(console.error("Error fetching drafts:",n),[]):r||[]}catch(r){return console.error("Error fetching drafts:",r),[]}})}static publishDraft(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("publish_review_draft",{p_draft_id:t,p_final_data:r});return a?(console.error("Error publishing draft:",a),null):n}catch(n){return console.error("Error publishing draft:",n),null}})}static deleteDraft(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("delete_review_draft",{p_draft_id:t,p_user_id:r});return a?(console.error("Error deleting draft:",a),!1):n}catch(n){return console.error("Error deleting draft:",n),!1}})}static loadDraftForEvent(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select("draft_data").eq("user_id",t).eq("entity_type","event").eq("entity_id",r).eq("is_draft",!0).single();return a?(a.code==="PGRST116"||console.error("Error loading draft:",a),null):(n==null?void 0:n.draft_data)||null}catch(n){return console.error("Error loading draft:",n),null}})}static hasDraftForEvent(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select("id").eq("user_id",t).eq("event_id",r).eq("is_draft",!0).single();return a?(a.code==="PGRST116"||console.error("Error checking draft:",a),!1):!!n}catch(n){return console.error("Error checking draft:",n),!1}})}}function Tde({userId:e,eventId:t,formData:r,enabled:n=!0,debounceMs:a=2e3,onSave:i,onEventIdChange:o}){const l=x.useRef(),c=x.useRef(""),d=x.useRef(!1),u=x.useCallback(y=>y?/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(y):!1,[]),f=x.useCallback((y,_)=>E(this,null,function*(){if(!n||!e){console.log(" Auto-save skipped:",{enabled:n,userId:!!e});return}const w=_||t;if(!w||!u(w)){console.log(" Auto-save: No valid event ID yet, saving to localStorage as fallback");try{const N=`review_draft_${e}_new`;localStorage.setItem(N,JSON.stringify({data:y,timestamp:Date.now(),eventId:null})),i==null||i(!0),c.current=JSON.stringify(y)}catch(N){console.error("Auto-save to localStorage failed:",N),i==null||i(!1)}return}if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(w)){console.log(" Auto-save skipped: Invalid event ID format:",w);return}if(d.current){console.log(" Auto-save: Already saving, skipping...");return}try{d.current=!0,console.log(" Auto-saving draft to database:",{userId:e,eventId:w});const N=yield Gf.saveDraft(e,w,y);N?(console.log(" Auto-saved draft successfully:",N),i==null||i(!0),c.current=JSON.stringify(y)):(console.warn(" Auto-save returned null (may be expected)"),i==null||i(!1))}catch(N){console.error(" Auto-save to database failed:",N),i==null||i(!1)}finally{d.current=!1}}),[e,t,n,i,u]),h=x.useCallback(y=>{l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{f(y)},a)},[f,a]);x.useEffect(()=>{if(!n||!e)return;JSON.stringify(r)!==c.current&&Object.values(r).some(w=>Array.isArray(w)?w.length>0:typeof w=="object"&&w!==null?Object.keys(w).length>0:w!=null&&w!=="")&&h(r)},[r,h,n,e]),x.useEffect(()=>{if(!n||!e||!t||!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t))return;Object.values(r).some(w=>Array.isArray(w)?w.length>0:typeof w=="object"&&w!==null?Object.keys(w).length>0:w!=null&&w!=="")&&(console.log(" Event ID available, saving draft immediately"),l.current&&clearTimeout(l.current),f(r,t),o==null||o(t))},[t,n,e,r,f,o]),x.useEffect(()=>()=>{l.current&&clearTimeout(l.current)},[]);const p=x.useCallback(()=>E(this,null,function*(){console.log(" Manual save triggered:",{userId:e,eventId:t,hasFormData:!!r}),l.current&&clearTimeout(l.current),yield f(r,t||void 0)}),[f,r,e,t]),g=x.useCallback(y=>{try{const _=`review_draft_${e}_${y||"new"}`,w=localStorage.getItem(_);if(w){const b=JSON.parse(w);return console.log(" Loaded draft from localStorage:",_),b.data}}catch(_){console.error("Error loading draft from localStorage:",_)}return null},[e]),v=x.useCallback(y=>{try{const _=`review_draft_${e}_${y||"new"}`;localStorage.removeItem(_),console.log(" Cleared draft from localStorage:",_)}catch(_){console.error("Error clearing draft from localStorage:",_)}},[e]);return{manualSave:p,loadDraft:g,clearDraft:v}}function $v(e,[t,r]){return Math.min(r,Math.max(t,e))}function Ade(e,t){return x.useReducer((r,n)=>{const a=t[r][n];return a!=null?a:r},e)}var cT="ScrollArea",[Y8,PBe]=Os(cT),[Rde,fo]=Y8(cT),K8=x.forwardRef((e,t)=>{const O=e,{__scopeScrollArea:r,type:n="hover",dir:a,scrollHideDelay:i=600}=O,o=me(O,["__scopeScrollArea","type","dir","scrollHideDelay"]),[l,c]=x.useState(null),[d,u]=x.useState(null),[f,h]=x.useState(null),[p,g]=x.useState(null),[v,y]=x.useState(null),[_,w]=x.useState(0),[b,N]=x.useState(0),[S,k]=x.useState(!1),[P,A]=x.useState(!1),R=cr(t,z=>c(z)),$=Sh(a);return s.jsx(Rde,{scope:r,type:n,dir:$,scrollHideDelay:i,scrollArea:l,viewport:d,onViewportChange:u,content:f,onContentChange:h,scrollbarX:p,onScrollbarXChange:g,scrollbarXEnabled:S,onScrollbarXEnabledChange:k,scrollbarY:v,onScrollbarYChange:y,scrollbarYEnabled:P,onScrollbarYEnabledChange:A,onCornerWidthChange:w,onCornerHeightChange:N,children:s.jsx(Ct.div,H(M({dir:$},o),{ref:R,style:M({position:"relative","--radix-scroll-area-corner-width":_+"px","--radix-scroll-area-corner-height":b+"px"},e.style)}))})});K8.displayName=cT;var Z8="ScrollAreaViewport",X8=x.forwardRef((e,t)=>{const d=e,{__scopeScrollArea:r,children:n,nonce:a}=d,i=me(d,["__scopeScrollArea","children","nonce"]),o=fo(Z8,r),l=x.useRef(null),c=cr(t,l,o.onViewportChange);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),s.jsx(Ct.div,H(M({"data-radix-scroll-area-viewport":""},i),{ref:c,style:M({overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden"},e.style),children:s.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:n})}))]})});X8.displayName=Z8;var zl="ScrollAreaScrollbar",dT=x.forwardRef((e,t)=>{const c=e,{forceMount:r}=c,n=me(c,["forceMount"]),a=fo(zl,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,l=e.orientation==="horizontal";return x.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),a.type==="hover"?s.jsx(Ode,H(M({},n),{ref:t,forceMount:r})):a.type==="scroll"?s.jsx(Mde,H(M({},n),{ref:t,forceMount:r})):a.type==="auto"?s.jsx(J8,H(M({},n),{ref:t,forceMount:r})):a.type==="always"?s.jsx(uT,H(M({},n),{ref:t})):null});dT.displayName=zl;var Ode=x.forwardRef((e,t)=>{const l=e,{forceMount:r}=l,n=me(l,["forceMount"]),a=fo(zl,e.__scopeScrollArea),[i,o]=x.useState(!1);return x.useEffect(()=>{const c=a.scrollArea;let d=0;if(c){const u=()=>{window.clearTimeout(d),o(!0)},f=()=>{d=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return c.addEventListener("pointerenter",u),c.addEventListener("pointerleave",f),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",u),c.removeEventListener("pointerleave",f)}}},[a.scrollArea,a.scrollHideDelay]),s.jsx(Ys,{present:r||i,children:s.jsx(J8,H(M({"data-state":i?"visible":"hidden"},n),{ref:t}))})}),Mde=x.forwardRef((e,t)=>{const d=e,{forceMount:r}=d,n=me(d,["forceMount"]),a=fo(zl,e.__scopeScrollArea),i=e.orientation==="horizontal",o=m1(()=>c("SCROLL_END"),100),[l,c]=Ade("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return x.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,a.scrollHideDelay,c]),x.useEffect(()=>{const u=a.viewport,f=i?"scrollLeft":"scrollTop";if(u){let h=u[f];const p=()=>{const g=u[f];h!==g&&(c("SCROLL"),o()),h=g};return u.addEventListener("scroll",p),()=>u.removeEventListener("scroll",p)}},[a.viewport,i,c,o]),s.jsx(Ys,{present:r||l!=="hidden",children:s.jsx(uT,H(M({"data-state":l==="hidden"?"hidden":"visible"},n),{ref:t,onPointerEnter:pt(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:pt(e.onPointerLeave,()=>c("POINTER_LEAVE"))}))})}),J8=x.forwardRef((e,t)=>{const r=fo(zl,e.__scopeScrollArea),d=e,{forceMount:n}=d,a=me(d,["forceMount"]),[i,o]=x.useState(!1),l=e.orientation==="horizontal",c=m1(()=>{if(r.viewport){const u=r.viewport.offsetWidth<r.viewport.scrollWidth,f=r.viewport.offsetHeight<r.viewport.scrollHeight;o(l?u:f)}},10);return Nm(r.viewport,c),Nm(r.content,c),s.jsx(Ys,{present:n||i,children:s.jsx(uT,H(M({"data-state":i?"visible":"hidden"},a),{ref:t}))})}),uT=x.forwardRef((e,t)=>{const h=e,{orientation:r="vertical"}=h,n=me(h,["orientation"]),a=fo(zl,e.__scopeScrollArea),i=x.useRef(null),o=x.useRef(0),[l,c]=x.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=nB(l.viewport,l.content),u=H(M({},n),{sizes:l,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:p=>i.current=p,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:p=>o.current=p});function f(p,g){return zde(p,o.current,l,g)}return r==="horizontal"?s.jsx(Dde,H(M({},u),{ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const p=a.viewport.scrollLeft,g=T5(p,l,a.dir);i.current.style.transform=`translate3d(${g}px, 0, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollLeft=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollLeft=f(p,a.dir))}})):r==="vertical"?s.jsx(Ide,H(M({},u),{ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const p=a.viewport.scrollTop,g=T5(p,l);i.current.style.transform=`translate3d(0, ${g}px, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollTop=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollTop=f(p))}})):null}),Dde=x.forwardRef((e,t)=>{const u=e,{sizes:r,onSizesChange:n}=u,a=me(u,["sizes","onSizesChange"]),i=fo(zl,e.__scopeScrollArea),[o,l]=x.useState(),c=x.useRef(null),d=cr(t,c,i.onScrollbarXChange);return x.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),s.jsx(eB,H(M({"data-orientation":"horizontal"},a),{ref:d,sizes:r,style:M({bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":f1(r)+"px"},e.style),onThumbPointerDown:f=>e.onThumbPointerDown(f.x),onDragScroll:f=>e.onDragScroll(f.x),onWheelScroll:(f,h)=>{if(i.viewport){const p=i.viewport.scrollLeft+f.deltaX;e.onWheelScroll(p),aB(p,h)&&f.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:nw(o.paddingLeft),paddingEnd:nw(o.paddingRight)}})}}))}),Ide=x.forwardRef((e,t)=>{const u=e,{sizes:r,onSizesChange:n}=u,a=me(u,["sizes","onSizesChange"]),i=fo(zl,e.__scopeScrollArea),[o,l]=x.useState(),c=x.useRef(null),d=cr(t,c,i.onScrollbarYChange);return x.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),s.jsx(eB,H(M({"data-orientation":"vertical"},a),{ref:d,sizes:r,style:M({top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":f1(r)+"px"},e.style),onThumbPointerDown:f=>e.onThumbPointerDown(f.y),onDragScroll:f=>e.onDragScroll(f.y),onWheelScroll:(f,h)=>{if(i.viewport){const p=i.viewport.scrollTop+f.deltaY;e.onWheelScroll(p),aB(p,h)&&f.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:nw(o.paddingTop),paddingEnd:nw(o.paddingBottom)}})}}))}),[$de,Q8]=Y8(zl),eB=x.forwardRef((e,t)=>{const R=e,{__scopeScrollArea:r,sizes:n,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:u,onResize:f}=R,h=me(R,["__scopeScrollArea","sizes","hasThumb","onThumbChange","onThumbPointerUp","onThumbPointerDown","onThumbPositionChange","onDragScroll","onWheelScroll","onResize"]),p=fo(zl,r),[g,v]=x.useState(null),y=cr(t,$=>v($)),_=x.useRef(null),w=x.useRef(""),b=p.viewport,N=n.content-n.viewport,S=gs(u),k=gs(c),P=m1(f,10);function A($){if(_.current){const O=$.clientX-_.current.left,z=$.clientY-_.current.top;d({x:O,y:z})}}return x.useEffect(()=>{const $=O=>{const z=O.target;(g==null?void 0:g.contains(z))&&S(O,N)};return document.addEventListener("wheel",$,{passive:!1}),()=>document.removeEventListener("wheel",$,{passive:!1})},[b,g,N,S]),x.useEffect(k,[n,k]),Nm(g,P),Nm(p.content,P),s.jsx($de,{scope:r,scrollbar:g,hasThumb:a,onThumbChange:gs(i),onThumbPointerUp:gs(o),onThumbPositionChange:k,onThumbPointerDown:gs(l),children:s.jsx(Ct.div,H(M({},h),{ref:y,style:M({position:"absolute"},h.style),onPointerDown:pt(e.onPointerDown,$=>{$.button===0&&($.target.setPointerCapture($.pointerId),_.current=g.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),A($))}),onPointerMove:pt(e.onPointerMove,A),onPointerUp:pt(e.onPointerUp,$=>{const O=$.target;O.hasPointerCapture($.pointerId)&&O.releasePointerCapture($.pointerId),document.body.style.webkitUserSelect=w.current,p.viewport&&(p.viewport.style.scrollBehavior=""),_.current=null})}))})}),rw="ScrollAreaThumb",tB=x.forwardRef((e,t)=>{const i=e,{forceMount:r}=i,n=me(i,["forceMount"]),a=Q8(rw,e.__scopeScrollArea);return s.jsx(Ys,{present:r||a.hasThumb,children:s.jsx(Lde,M({ref:t},n))})}),Lde=x.forwardRef((e,t)=>{const f=e,{__scopeScrollArea:r,style:n}=f,a=me(f,["__scopeScrollArea","style"]),i=fo(rw,r),o=Q8(rw,r),{onThumbPositionChange:l}=o,c=cr(t,h=>o.onThumbChange(h)),d=x.useRef(void 0),u=m1(()=>{d.current&&(d.current(),d.current=void 0)},100);return x.useEffect(()=>{const h=i.viewport;if(h){const p=()=>{if(u(),!d.current){const g=Bde(h,l);d.current=g,l()}};return l(),h.addEventListener("scroll",p),()=>h.removeEventListener("scroll",p)}},[i.viewport,u,l]),s.jsx(Ct.div,H(M({"data-state":o.hasThumb?"visible":"hidden"},a),{ref:c,style:M({width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)"},n),onPointerDownCapture:pt(e.onPointerDownCapture,h=>{const g=h.target.getBoundingClientRect(),v=h.clientX-g.left,y=h.clientY-g.top;o.onThumbPointerDown({x:v,y})}),onPointerUp:pt(e.onPointerUp,o.onThumbPointerUp)}))});tB.displayName=rw;var hT="ScrollAreaCorner",rB=x.forwardRef((e,t)=>{const r=fo(hT,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?s.jsx(Fde,H(M({},e),{ref:t})):null});rB.displayName=hT;var Fde=x.forwardRef((e,t)=>{const u=e,{__scopeScrollArea:r}=u,n=me(u,["__scopeScrollArea"]),a=fo(hT,r),[i,o]=x.useState(0),[l,c]=x.useState(0),d=!!(i&&l);return Nm(a.scrollbarX,()=>{var h;const f=((h=a.scrollbarX)==null?void 0:h.offsetHeight)||0;a.onCornerHeightChange(f),c(f)}),Nm(a.scrollbarY,()=>{var h;const f=((h=a.scrollbarY)==null?void 0:h.offsetWidth)||0;a.onCornerWidthChange(f),o(f)}),d?s.jsx(Ct.div,H(M({},n),{ref:t,style:M({width:i,height:l,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0},e.style)})):null});function nw(e){return e?parseInt(e,10):0}function nB(e,t){const r=e/t;return isNaN(r)?0:r}function f1(e){const t=nB(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-r)*t;return Math.max(n,18)}function zde(e,t,r,n="ltr"){const a=f1(r),i=a/2,o=t||i,l=a-o,c=r.scrollbar.paddingStart+o,d=r.scrollbar.size-r.scrollbar.paddingEnd-l,u=r.content-r.viewport,f=n==="ltr"?[0,u]:[u*-1,0];return sB([c,d],f)(e)}function T5(e,t,r="ltr"){const n=f1(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-a,o=t.content-t.viewport,l=i-n,c=r==="ltr"?[0,o]:[o*-1,0],d=$v(e,c);return sB([0,o],[0,l])(d)}function sB(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function aB(e,t){return e>0&&e<t}var Bde=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return function a(){const i={left:e.scrollLeft,top:e.scrollTop},o=r.left!==i.left,l=r.top!==i.top;(o||l)&&t(),r=i,n=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(n)};function m1(e,t){const r=gs(e),n=x.useRef(0);return x.useEffect(()=>()=>window.clearTimeout(n.current),[]),x.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function Nm(e,t){const r=gs(t);vs(()=>{let n=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return a.observe(e),()=>{window.cancelAnimationFrame(n),a.unobserve(e)}}},[e,r])}var iB=K8,Ude=X8,qde=rB;const p1=x.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=me(i,["className","children"]);return s.jsxs(iB,H(M({ref:n,className:ke("relative overflow-hidden",e)},r),{children:[s.jsx(Ude,{className:"h-full w-full rounded-[inherit]",children:t}),s.jsx(fT,{}),s.jsx(qde,{})]}))});p1.displayName=iB.displayName;const fT=x.forwardRef((a,n)=>{var i=a,{className:e,orientation:t="vertical"}=i,r=me(i,["className","orientation"]);return s.jsx(dT,H(M({ref:n,orientation:t,className:ke("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e)},r),{children:s.jsx(tB,{className:"relative flex-1 rounded-full bg-border"})}))});fT.displayName=dT.displayName;function Vde({userId:e,onSelectDraft:t,onNewReview:r,currentMode:n}){const[a,i]=x.useState([]),[o,l]=x.useState(!1),[c,d]=x.useState(!1),{toast:u}=Rr(),f=()=>E(this,null,function*(){d(!0);try{const v=yield Gf.getUserDrafts(e);i(v)}catch(v){console.error("Error loading drafts:",v),u({title:"Error",description:"Failed to load draft reviews",variant:"destructive"})}finally{d(!1)}});x.useEffect(()=>{o&&f()},[o,e]);const h=v=>E(this,null,function*(){try{(yield Gf.deleteDraft(v,e))?(i(_=>_.filter(w=>w.id!==v)),u({title:"Draft Deleted",description:"Draft review has been deleted"})):u({title:"Error",description:"Failed to delete draft",variant:"destructive"})}catch(y){console.error("Error deleting draft:",y),u({title:"Error",description:"Failed to delete draft",variant:"destructive"})}}),p=v=>{t(v),l(!1)},g=v=>{var _,w;const y=[];return(_=v.selectedArtist)!=null&&_.name&&y.push(`Artist: ${v.selectedArtist.name}`),(w=v.selectedVenue)!=null&&w.name&&y.push(`Venue: ${v.selectedVenue.name}`),v.eventDate&&y.push(`Date: ${Mt(new Date(v.eventDate),"MMM d, yyyy")}`),v.performanceRating&&y.push(`Performance: ${v.performanceRating}/5`),v.venueRating&&y.push(`Venue: ${v.venueRating}/5`),v.overallExperienceRating&&y.push(`Overall: ${v.overallExperienceRating}/5`),v.reviewText&&y.push(`Review: ${v.reviewText.substring(0,50)}...`),y.length>0?y.join("  "):"Empty draft"};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsxs(le,{variant:n==="new"?"default":"outline",size:"sm",onClick:r,className:"flex items-center gap-2",children:[s.jsx(_c,{className:"w-4 h-4"}),"New Review"]}),s.jsxs(le,{variant:n==="draft"?"default":"outline",size:"sm",onClick:()=>l(!0),className:"flex items-center gap-2",children:[s.jsx(ga,{className:"w-4 h-4"}),"View Drafts",a.length>0&&s.jsx(Ke,{variant:"secondary",className:"ml-1",children:a.length})]})]}),s.jsx(pn,{open:o,onOpenChange:l,children:s.jsxs(dn,{className:"max-w-2xl max-h-[80vh]",children:[s.jsx(Vn,{children:s.jsxs(bn,{className:"flex items-center gap-2",children:[s.jsx(ga,{className:"w-5 h-5"}),"Draft Reviews"]})}),s.jsx(p1,{className:"max-h-[60vh]",children:c?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-sm text-gray-500",children:"Loading drafts..."})}):a.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(ga,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Draft Reviews"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"You don't have any draft reviews. Start writing a review to create your first draft."}),s.jsx(le,{onClick:r,children:"Create New Review"})]}):s.jsx("div",{className:"space-y-4",children:a.map(v=>s.jsxs(He,{className:"hover:shadow-md transition-shadow",children:[s.jsx(Er,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx(qr,{className:"text-base mb-1",children:v.event_title||"Untitled Event"}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[v.artist_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx($t,{className:"w-3 h-3"}),v.artist_name]}),v.venue_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(gr,{className:"w-3 h-3"}),v.venue_name]}),v.event_date&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(It,{className:"w-3 h-3"}),Mt(new Date(v.event_date),"MMM d, yyyy")]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>p(v),className:"flex items-center gap-1",children:[s.jsx(_c,{className:"w-3 h-3"}),"Continue"]}),s.jsx(le,{variant:"outline",size:"sm",onClick:()=>h(v.id),className:"flex items-center gap-1 text-red-600 hover:text-red-700",children:s.jsx(Dl,{className:"w-3 h-3"})})]})]})}),s.jsxs(et,{className:"pt-0",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-2",children:g(v.draft_data)}),s.jsxs("div",{className:"text-xs text-gray-400",children:["Last saved: ",Mt(new Date(v.last_saved_at),"MMM d, yyyy 'at' h:mm a")]})]})]},v.id))})})]})})]})}class Wde{static sendReviewInvitations(t,r,n){return E(this,null,function*(){try{console.log(" Sending SMS invitations:",{phoneNumbers:t,reviewId:r,senderName:n});const{error:a}=yield T.functions.invoke("send-review-invitations",{body:{phoneNumbers:t,reviewId:r,senderName:n,message:`${n} tagged you in a concert review on Synth! Check it out: https://synth.app/reviews/${r}`}});a?console.error("Error invoking SMS function:",a):console.log(" SMS invitations sent successfully")}catch(a){console.error("Failed to send SMS invitations:",a)}})}static validatePhoneNumber(t){return/^\+[1-9]\d{1,14}$/.test(t)}static formatPhoneNumber(t){const r=t.replace(/[^\d+]/g,"");return r.startsWith("+")?r:`+${r}`}}const Hde=[{id:"artist-electric",label:"Electric energy",description:"The band fed off the crowd with nonstop energy.",sentiment:"positive"},{id:"artist-tight",label:"Tight musicianship",description:"Flawless set and tight transitions all night.",sentiment:"positive"},{id:"artist-weak-vocals",label:"Vocals struggled",description:"Vocals were off pitch for most of the night.",sentiment:"negative"},{id:"artist-short-set",label:"Short setlist",description:"Felt too quickleft wanting a few more songs.",sentiment:"negative"}],Gde=[{id:"production-lights",label:"Insane light show",description:"Lighting design elevated every drop.",sentiment:"positive"},{id:"production-soundmix",label:"Crystal clear mix",description:"Sound mix was balanced and immersive.",sentiment:"positive"},{id:"production-feedback",label:"Feedback issues",description:"Persistent sound issues distracted from songs.",sentiment:"negative"},{id:"production-lag",label:"Stage delays",description:"Long pauses between songs killed the momentum.",sentiment:"negative"}],Yde=[{id:"venue-staff",label:"Staff was incredible",description:"Friendly staff kept lines moving smoothly.",sentiment:"positive"},{id:"venue-comfort",label:"Comfortable layout",description:"Plenty of space and easy sightlines.",sentiment:"positive"},{id:"venue-crowded",label:"Overcrowded",description:"Packed to the brim with no room to breathe.",sentiment:"negative"},{id:"venue-sound",label:"Muddy house sound",description:"Venue acoustics made everything sound muffled.",sentiment:"negative"}],Kde=[{id:"location-easy",label:"Easy transit",description:"Quick rideshare + plenty of parking nearby.",sentiment:"positive"},{id:"location-food",label:"Great pre-show spots",description:"Awesome food and bars in walking distance.",sentiment:"positive"},{id:"location-traffic",label:"Nightmare traffic",description:"Getting there and back took forever.",sentiment:"negative"},{id:"location-safety",label:"Felt unsafe",description:"Area felt sketchy walking back to the car.",sentiment:"negative"}],Zde=[{id:"value-worth-every-dollar",label:"Worth every dollar",description:"Totally justified the ticket price.",sentiment:"positive"},{id:"value-underpriced",label:"Steal of a night",description:"Felt like we paid half of what it was worth.",sentiment:"positive"},{id:"value-overpriced",label:"Overpriced",description:"Fun night, but tickets were overpriced.",sentiment:"negative"},{id:"value-hidden-fees",label:"Too many fees",description:"Fees and merch prices added up fast.",sentiment:"negative"}],HN=e=>{if(!e)return["Select time"];switch(e){case"quick":return["Select time","Event details","Quick review","Submit"];case"standard":return["Select time","Event details","Artist performance","Venue","Review content","Submit"];case"detailed":return["Select time","Event details","Artist performance","Production","Venue","Location","Value","Review content","Submit"];default:return[]}};function oB({event:e,userId:t,onSubmitted:r,onDeleted:n,onClose:a}){var Ft,_t,Lt,Oe,qe;const{toast:i}=Rr(),{formData:o,errors:l,isLoading:c,updateFormData:d,setLoading:u,resetForm:f,setFormData:h,currentStep:p,nextStep:g,prevStep:v,canProceed:y,canGoBack:_,isLastStep:w,totalSteps:b,currentFlow:N}=fde(),[S,k]=x.useState(null),[P]=x.useState([]),[A,R]=x.useState(!1),[$,O]=x.useState(null),[z,D]=x.useState(!1),[B,F]=x.useState(null),[U,G]=x.useState(!1);x.useEffect(()=>{G(!1)},[e==null?void 0:e.id]);const q=Ne=>Ne?/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Ne):!1,K=()=>{var Ne;return(Ne=e.id)!=null&&Ne.startsWith("new-review")||q(e.id)?e.id:""},[Z,Y]=x.useState(K()),[Q,X]=x.useState(null),[ne,re]=x.useState(!1),[ye,ee]=x.useState(null);x.useEffect(()=>{E(this,null,function*(){var ze;if(!((ze=o.selectedVenue)!=null&&ze.is_from_database)||!o.selectedVenue.id||!t||S){ee(null);return}const Fe=o.selectedVenue.id,ve=Z||e.id||"";if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Fe)){ee(null);return}try{const ct=yield bs.getPreviousVenueReview(t,Fe,ve);ee(ct)}catch(ct){console.error("Error checking for previous venue review:",ct),ee(null)}})},[(Ft=o.selectedVenue)==null?void 0:Ft.id,t,Z,e.id,S]);const de=Ne=>{if(!Ne)return"";const Fe=new Date(Ne);return Number.isNaN(Fe.getTime())?"":Fe.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},xe=Ne=>{d({selectedSetlist:Ne}),re(!1)},ie=()=>{d({selectedSetlist:null})},se=Ne=>{d({customSetlist:Ne})},{manualSave:V,loadDraft:ue,clearDraft:_e}=Tde({userId:t,eventId:Z||null,formData:o,enabled:!U,debounceMs:2e3,onSave:Ne=>{D(!1),Ne&&F(new Date)},onEventIdChange:Ne=>{Ne&&Ne!==Z&&Y(Ne)}}),ae=x.useMemo(()=>{var Fe,ve;const Ne=(Fe=o.selectedArtist)==null?void 0:Fe.name;return{2:{title:"Artist Performance",subtitle:Ne?`How did ${Ne} deliver live? Share your honest take.`:"How did the artist deliver live? Share your honest take.",ratingKey:"artistPerformanceRating",feedbackKey:"artistPerformanceFeedback",helperText:"Tap a star (half points allowed) to capture the performance.",suggestions:Hde},3:{title:"Production Quality",subtitle:"Lights, visuals, sound mix  did the production elevate the night?",ratingKey:"productionRating",feedbackKey:"productionFeedback",helperText:"Think about sound clarity, lighting, visuals, and pacing.",suggestions:Gde},4:{title:"Venue Experience",subtitle:(ve=o.selectedVenue)!=null&&ve.name?`What was ${o.selectedVenue.name} like to be in?`:"Consider the staff, comfort, lines, and vibe inside the venue.",ratingKey:"venueRating",feedbackKey:"venueFeedback",helperText:"Include staff vibes, comfort, and amenities.",suggestions:Yde},5:{title:"Location & Logistics",subtitle:"Getting there, getting home, nearby spots  how easy was the night?",ratingKey:"locationRating",feedbackKey:"locationFeedback",helperText:"Parking, transit, food options, safety  it all counts.",suggestions:Kde},6:{title:"Value for Ticket Price",subtitle:"Given what you paid, did the experience feel worth it?",ratingKey:"valueRating",feedbackKey:"valueFeedback",helperText:"Honest value helps fans budget for future shows.",suggestions:Zde}}},[(_t=o.selectedArtist)==null?void 0:_t.name,(Lt=o.selectedVenue)==null?void 0:Lt.name]);x.useEffect(()=>{E(this,null,function*(){var Fe,ve,Me,ze,ct,Et,gt,St,dr;if(!(!e||!t))try{const Sr=e==null?void 0:e.existing_review_id;let wt=null;if(Sr&&q(Sr)){const{data:lt,error:Qe}=yield T.from("reviews").select("*").eq("id",Sr).maybeSingle();lt&&!Qe&&(wt=lt)}else q(e.id)&&(wt=yield bs.getUserEventReview(t,e.id));if(!wt){const lt=ue(e.id);lt&&(console.log(" Loaded draft from localStorage for event:",e.id),h(lt))}if(wt){k(wt);let lt=null;if(e){const jt="artist_id"in e||"venue_id"in e;lt={artist_name:"artist_name"in e?e.artist_name:void 0,artist_id:jt&&"artist_id"in e?e.artist_id:void 0,venue_name:"venue_name"in e?e.venue_name:void 0,venue_id:jt&&"venue_id"in e?e.venue_id:void 0,event_date:"event_date"in e?e.event_date:void 0}}const Qe=lt!=null&&lt.event_date?String(lt.event_date).split("T")[0]:e!=null&&e.event_date?String(e.event_date).split("T")[0]:(wt.created_at||"").split("T")[0];h({selectedArtist:null,selectedVenue:null,eventDate:Qe,artistPerformanceRating:wt.artist_performance_rating||wt.rating,productionRating:wt.production_rating||wt.artist_performance_rating||wt.rating,venueRating:wt.venue_rating||wt.rating,locationRating:wt.location_rating||wt.venue_rating||wt.rating,valueRating:wt.value_rating||wt.rating,artistPerformanceFeedback:wt.artist_performance_feedback||"",productionFeedback:wt.production_feedback||"",venueFeedback:wt.venue_feedback||"",locationFeedback:wt.location_feedback||"",valueFeedback:wt.value_feedback||"",ticketPricePaid:wt.ticket_price_paid?String(wt.ticket_price_paid):"",rating:wt.rating,reviewText:wt.review_text||"",photos:wt.photos||[],videos:wt.videos||[],selectedSetlist:wt.setlist||null,customSetlist:wt.custom_setlist||[],isPublic:wt.is_public,reviewType:wt.review_type||"event"});try{const jt=(lt==null?void 0:lt.artist_name)||(e==null?void 0:e.artist_name)||((Fe=e==null?void 0:e.artist)==null?void 0:Fe.name),ir=(lt==null?void 0:lt.artist_id)||(e==null?void 0:e.artist_id)||((ve=e==null?void 0:e.artist)==null?void 0:ve.id),rr=(lt==null?void 0:lt.venue_name)||(e==null?void 0:e.venue_name)||((Me=e==null?void 0:e.venue)==null?void 0:Me.name),Ie=(lt==null?void 0:lt.venue_id)||wt.venue_id||((ze=e==null?void 0:e.venue)==null?void 0:ze.id),At=lt!=null&&lt.event_date?String(lt.event_date).split("T")[0]:e!=null&&e.event_date?String(e.event_date).split("T")[0]:null,yt=jt?{id:ir||`manual-${jt}`,name:jt,is_from_database:!!ir}:null,pe=rr?{id:Ie||`manual-${rr}`,name:rr,is_from_database:!!Ie}:null,De={selectedArtist:yt,selectedVenue:pe,selectedSetlist:e.setlist||((ct=e==null?void 0:e.existing_review)==null?void 0:ct.selectedSetlist)||null,eventDate:At||o.eventDate};console.log(" Pre-populating form data for edit:",{selectedArtist:yt,selectedVenue:pe,hasSetlist:!!De.selectedSetlist,eventDate:De.eventDate,eventDateFromEvent:At,eventDetails:lt}),h(De)}catch(jt){console.error(" Error pre-populating artist/venue:",jt)}}else{k(null),f(),G(!1);try{const lt=(e==null?void 0:e.artist_name)||((Et=e==null?void 0:e.artist)==null?void 0:Et.name),Qe=(e==null?void 0:e.artist_id)||((gt=e==null?void 0:e.artist)==null?void 0:gt.id)||void 0,jt=(e==null?void 0:e.venue_name)||((St=e==null?void 0:e.venue)==null?void 0:St.name),ir=(e==null?void 0:e.venue_id)||((dr=e==null?void 0:e.venue)==null?void 0:dr.id)||void 0,rr=(e==null?void 0:e.event_date)||(e==null?void 0:e.date)||void 0,Ie=lt?{id:Qe||`manual-${lt}`,name:lt,is_from_database:!!Qe}:null,At=jt?{id:ir||`manual-${jt}`,name:jt,is_from_database:!!ir}:null,yt=rr?String(rr).split("T")[0]:"";h(M(M(M({reviewType:"event"},Ie?{selectedArtist:Ie}:{}),At?{selectedVenue:At}:{}),yt?{eventDate:yt}:{}))}catch(lt){h({reviewType:"event"})}}}catch(Sr){console.error("Error loading review for single page form",Sr)}})},[e==null?void 0:e.id,t]);const we=()=>E(this,null,function*(){var wt,lt,Qe,jt,ir,rr,Ie,At,yt,pe,De,Le,bt,it,zt,Bt,Te,dt,mr,Mn,fe,Re,ot,vt,ut,Pe,Ge,Ee,ft,Pt,yr,un,hn,xn;if(!t){i({title:"Authentication Required",description:"Please log in to submit a review.",variant:"destructive"});return}const Ne=[];o.reviewType==="event"?(o.selectedArtist||Ne.push("Please select an artist"),o.selectedVenue||Ne.push("Please select a venue"),o.eventDate||Ne.push("Please select an event date")):o.reviewType==="venue"?o.selectedVenue||Ne.push("Please select a venue"):o.reviewType==="artist"&&(o.selectedArtist||Ne.push("Please select an artist"));const Fe=N||"detailed";if(Fe==="quick"?((!o.rating||o.rating<.5||o.rating>5)&&Ne.push("Please provide an overall rating (0.5 - 5 stars)"),!o.reviewText||o.reviewText.trim()===""?Ne.push("Please share a brief description of your experience"):o.reviewText.length>200&&Ne.push("Review text must be 200 characters or less for quick review")):Fe==="standard"?((!o.artistPerformanceRating||o.artistPerformanceRating<.5||o.artistPerformanceRating>5)&&Ne.push("Please rate the artist performance (0.5 - 5 stars)"),(!o.venueRating||o.venueRating<.5||o.venueRating>5)&&Ne.push("Please rate the venue (0.5 - 5 stars)"),!o.reviewText||o.reviewText.trim()===""?Ne.push("Please share a description of your experience"):o.reviewText.length>400&&Ne.push("Review text must be 400 characters or less for standard review")):([[o.artistPerformanceRating,"artist performance"],[o.productionRating,"production quality"],[o.venueRating,"venue"],[o.locationRating,"location & logistics"],[o.valueRating,"value for the ticket price"]].forEach(([hr,or])=>{!hr||hr===0?Ne.push(`Please rate the ${or}`):(hr<.5||hr>5)&&Ne.push(`The ${or} rating must be between 0.5 and 5.0 stars`)}),!o.reviewText||o.reviewText.trim()===""?Ne.push("Please share a brief description of your experience"):o.reviewText.length>500&&Ne.push("Review text must be 500 characters or less")),[[o.artistPerformanceFeedback,"Artist performance note must be 400 characters or less"],[o.productionFeedback,"Production note must be 400 characters or less"],[o.venueFeedback,"Venue note must be 400 characters or less"],[o.locationFeedback,"Location note must be 400 characters or less"],[o.valueFeedback,"Value note must be 400 characters or less"]].forEach(([Rt,hr])=>{Rt&&Rt.length>400&&Ne.push(hr)}),o.ticketPricePaid){const Rt=Number(o.ticketPricePaid);Number.isNaN(Rt)?Ne.push("Ticket price must be a valid number"):Rt<0&&Ne.push("Ticket price cannot be negative")}if(Ne.length>0){const Rt=Ne.length===1?Ne[0]:`Please complete the following:
 ${Ne.join(`
 `)}`;i({title:"Incomplete Review",description:Rt,variant:"destructive",duration:6e3});return}let Me=q(Z)?Z:q(e.id)?e.id:Z||e.id,ze;try{const Rt=o.selectedArtist||(e==null?void 0:e.artist)||null,hr=(Rt==null?void 0:Rt.id)||((Qe=(lt=(wt=Rt==null?void 0:Rt.identifier)==null?void 0:wt.split)==null?void 0:lt.call(wt,":"))==null?void 0:Qe[1]);if(console.log(" EventReviewForm: Artist resolution - candidate:",Rt,"jambaseArtistId:",hr),hr){if(console.log(" EventReviewForm: Looking up artist with jambaseArtistId:",hr),Rt!=null&&Rt.identifier){const{data:or}=yield T.from("artists").select("id").eq("identifier",Rt.identifier).limit(1).maybeSingle();or&&(ze=or.id,console.log(" EventReviewForm: Found existing artist by identifier:",ze))}if(!ze&&(Rt!=null&&Rt.name)){const{data:or}=yield T.from("artists").select("id").ilike("name",Rt.name).limit(1).maybeSingle();or&&(ze=or.id,console.log(" EventReviewForm: Found existing artist by name:",ze))}ze||console.log(" EventReviewForm: Artist not found in database")}}catch(Rt){}let ct=(jt=o.selectedVenue)!=null&&jt.is_from_database?o.selectedVenue.id:void 0;if(!ct&&o.selectedVenue)try{const Rt=o.selectedVenue.identifier,hr=typeof Rt=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Rt);let or;if(hr){const Gt=yield T.from("venues").select("id").eq("identifier",Rt).limit(1);or=Array.isArray(Gt.data)&&Gt.data.length>0?Gt.data[0].id:void 0}if(or)ct=or;else{const Gt=yield T.from("venues").select("id").ilike("name",`%${o.selectedVenue.name}%`).limit(1);or=Array.isArray(Gt.data)&&Gt.data.length>0?Gt.data[0].id:void 0,or&&(ct=or)}}catch(Rt){}ct&&!q(ct)&&(ct=void 0);const Et=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Me),gt=!Et||((ir=e==null?void 0:e.id)==null?void 0:ir.startsWith("new-review")),St=o.selectedArtist&&S&&o.selectedArtist.name!==(S.artist_name||(e==null?void 0:e.artist_name)),dr=o.selectedVenue&&S&&o.selectedVenue.name!==(S.venue_name||(e==null?void 0:e.venue_name)),Sr=gt||St||dr;if(Et&&!((rr=e==null?void 0:e.id)!=null&&rr.startsWith("new-review"))&&!Sr&&o.eventDate&&o.eventDate.trim()!=="")try{const Rt=new Date(o.eventDate+"T20:00:00Z");if(!isNaN(Rt.getTime())){const{data:hr}=yield T.from("events").select("event_date").eq("id",Me).single();if(hr){const or=new Date(hr.event_date),Gt=Rt;Math.abs((Gt.getTime()-or.getTime())/(1e3*60*60*24))>1&&(console.log(" Updating event date from",or,"to",Gt),yield T.from("events").update({event_date:Rt.toISOString()}).eq("id",Me))}}}catch(Rt){console.error(" Error updating event date:",Rt)}if(Sr)try{if(!o.eventDate||o.eventDate.trim()==="")throw new Error("Event date is required");const Rt=new Date(o.eventDate+"T20:00:00Z");if(isNaN(Rt.getTime()))throw new Error(`Invalid event date: ${o.eventDate}`);const hr=(Ie=o.selectedVenue)!=null&&Ie.is_from_database&&q(o.selectedVenue.id)?o.selectedVenue.id:null,or=(At=o.selectedArtist)==null?void 0:At.is_from_database,Gt=ze||(or&&q((yt=o.selectedArtist)==null?void 0:yt.id)?o.selectedArtist.id:null);let xr=H(M(M({title:`${((pe=o.selectedArtist)==null?void 0:pe.name)||"Concert"} at ${((De=o.selectedVenue)==null?void 0:De.name)||"Venue"}`},Gt?{artist_id:Gt}:{}),hr?{venue_id:hr}:{}),{venue_city:((bt=(Le=o.selectedVenue)==null?void 0:Le.address)==null?void 0:bt.addressLocality)||"Unknown",venue_state:((zt=(it=o.selectedVenue)==null?void 0:it.address)==null?void 0:zt.addressRegion)||"Unknown",event_date:Rt.toISOString(),description:`Concert by ${((Bt=o.selectedArtist)==null?void 0:Bt.name)||""} at ${((Te=o.selectedVenue)==null?void 0:Te.name)||""}`}),Xt={data:null,error:null};try{const{MissingEntityRequestService:jr}=yield kn(()=>E(this,null,function*(){const{MissingEntityRequestService:en}=yield import("./missingEntityRequestService-U8rBFeto.js");return{MissingEntityRequestService:en}}),[],import.meta.url);yield jr.submitRequest({entity_type:"event",entity_name:xr.title,entity_date:xr.event_date,entity_location:`${xr.venue_city}, ${xr.venue_state}`,additional_info:{artist_id:Gt,venue_id:hr}}),console.log(" Submitted request for missing event:",xr.title),i({title:"Event Request Submitted",description:"Your event request has been submitted for review. You can still write your review."}),Xt.data={id:`pending-${Date.now()}`}}catch(jr){console.error(" Error submitting event request:",jr),Xt.error=jr,i({title:"Request Submission Failed",description:"Could not submit event request, but you can still write your review.",variant:"destructive"})}if(!Xt.error&&ct?console.log(" EventReviewForm: VenueId resolved for ReviewService:",ct):console.log(" EventReviewForm: No venueId resolved:",{venueId:ct,hasError:!!Xt.error}),Xt.error)throw Xt.error;Me=Xt.data.id,Y(Xt.data.id),S&&(St||dr)&&(console.log(" EventReviewForm: Artist/venue changed, deleting old review and creating new one"),yield T.from("reviews").delete().eq("id",S.id),k(null))}catch(Rt){console.error("Error creating event:",Rt),i({title:"Error",description:"Failed to create event entry. Please try again.",variant:"destructive"});return}u(!0),G(!0);try{const Rt=P.length?`

Show rankings:
${P.slice().sort((nr,Or)=>Or.rating-nr.rating||nr.order-Or.order).map((nr,Or)=>`${Or+1}. ${nr.show_name||"Show"}${nr.show_date?` (${nr.show_date})`:""}${nr.venue_name?` @ ${nr.venue_name}`:""}  ${nr.rating}/5${P.filter(ln=>ln.rating===nr.rating).length>1?` [tie #${nr.order}]`:""}`).join(`
`)}
        `:"",hr=N||"detailed";let or;if(hr==="quick")or=typeof o.rating=="number"&&o.rating>0?o.rating:void 0;else if(hr==="standard"){const nr=[o.artistPerformanceRating,o.venueRating].filter(Or=>typeof Or=="number"&&Or>0);or=nr.length>0?Number((nr.reduce((Or,ln)=>Or+ln,0)/nr.length).toFixed(1)):typeof o.rating=="number"&&o.rating>0?o.rating:void 0}else{const nr=[o.artistPerformanceRating,o.productionRating,o.venueRating,o.locationRating,o.valueRating].filter(Or=>typeof Or=="number"&&Or>0);or=nr.length>0?Number((nr.reduce((Or,ln)=>Or+ln,0)/nr.length).toFixed(1)):typeof o.rating=="number"&&o.rating>0?o.rating:void 0}const Gt=o.ticketPricePaid?Number(o.ticketPricePaid):void 0;let xr;hr==="quick"?xr=typeof or=="number"&&or>0?Number(or.toFixed(1)):void 0:xr=typeof o.artistPerformanceRating=="number"&&o.artistPerformanceRating>0?Number(o.artistPerformanceRating.toFixed(1)):void 0;const Xt=typeof o.productionRating=="number"&&o.productionRating>0?Number(o.productionRating.toFixed(1)):void 0,jr=typeof o.venueRating=="number"&&o.venueRating>0?Number(o.venueRating.toFixed(1)):void 0,en=typeof o.locationRating=="number"&&o.locationRating>0?Number(o.locationRating.toFixed(1)):void 0,Hn=typeof o.valueRating=="number"&&o.valueRating>0?Number(o.valueRating.toFixed(1)):void 0,Tt=((dt=o.artistPerformanceFeedback)==null?void 0:dt.trim())||void 0,kr=((mr=o.productionFeedback)==null?void 0:mr.trim())||void 0,ds=((Mn=o.venueFeedback)==null?void 0:Mn.trim())||void 0,Oa=((fe=o.locationFeedback)==null?void 0:fe.trim())||void 0,Dn=((Re=o.valueFeedback)==null?void 0:Re.trim())||void 0,Hr={review_type:"event",rating:typeof or=="number"&&or>0?or:void 0,artist_performance_rating:xr,production_rating:Xt,venue_rating:jr,location_rating:en,value_rating:Hn,artist_performance_feedback:Tt,production_feedback:kr,venue_feedback:ds,location_feedback:Oa,value_feedback:Dn,ticket_price_paid:typeof Gt=="number"&&!Number.isNaN(Gt)?Gt:void 0,review_text:(o.reviewText.trim()+Rt).trim()||void 0,photos:o.photos&&o.photos.length>0?o.photos:void 0,videos:o.videos&&o.videos.length>0?o.videos:void 0,setlist:o.selectedSetlist!==void 0?o.selectedSetlist:(S==null?void 0:S.setlist)||void 0,custom_setlist:o.customSetlist&&o.customSetlist.length>0?o.customSetlist:void 0,is_public:o.isPublic};console.log(" EventReviewForm: Review data being saved:",{rating:Hr.rating,decimalAverage:or,hasSetlist:!!Hr.setlist,setlistData:Hr.setlist,formDataSelectedSetlist:o.selectedSetlist,hasCustomSetlist:!!Hr.custom_setlist,customSetlistSongCount:((ot=Hr.custom_setlist)==null?void 0:ot.length)||0,categoryRatings:{artist_performance_rating:Hr.artist_performance_rating,production_rating:Hr.production_rating,venue_rating:Hr.venue_rating,location_rating:Hr.location_rating,value_rating:Hr.value_rating},categoryFeedback:{artist_performance_feedback:Hr.artist_performance_feedback,production_feedback:Hr.production_feedback,venue_feedback:Hr.venue_feedback,location_feedback:Hr.location_feedback,value_feedback:Hr.value_feedback},formDataRatings:{artistPerformanceRating:o.artistPerformanceRating,productionRating:o.productionRating,venueRating:o.venueRating,locationRating:o.locationRating,valueRating:o.valueRating},formDataFeedback:{artistPerformanceFeedback:o.artistPerformanceFeedback,productionFeedback:o.productionFeedback,venueFeedback:o.venueFeedback,locationFeedback:o.locationFeedback,valueFeedback:o.valueFeedback}});let Br=(vt=o.selectedVenue)!=null&&vt.is_from_database?o.selectedVenue.id:void 0;if(!Br&&o.selectedVenue)try{const nr=o.selectedVenue.identifier,Or=typeof nr=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(nr);let ln;if(Or){const Cn=yield T.from("venues").select("id").eq("identifier",nr).limit(1);ln=Array.isArray(Cn.data)&&Cn.data.length>0?Cn.data[0].id:void 0}if(ln)Br=ln;else{const Cn=yield T.from("venues").select("id").ilike("name",`%${o.selectedVenue.name}%`).limit(1),js=Array.isArray(Cn.data)&&Cn.data.length>0?Cn.data[0].id:void 0;if(js)Br=js;else{const bi=`user-created-${Date.now()}`;if(!(yield T.from("venues").insert({jambase_venue_id:bi,name:o.selectedVenue.name,identifier:Or?nr:`user-created-${o.selectedVenue.name.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`,address:typeof o.selectedVenue.address=="string"?o.selectedVenue.address:((ut=o.selectedVenue.address)==null?void 0:ut.streetAddress)||null,city:((Pe=o.selectedVenue.address)==null?void 0:Pe.addressLocality)||null,state:((Ge=o.selectedVenue.address)==null?void 0:Ge.addressRegion)||null,zip:((Ee=o.selectedVenue.address)==null?void 0:Ee.postalCode)||null,country:((ft=o.selectedVenue.address)==null?void 0:ft.addressCountry)||"US",latitude:((Pt=o.selectedVenue.geo)==null?void 0:Pt.latitude)||null,longitude:((yr=o.selectedVenue.geo)==null?void 0:yr.longitude)||null,image_url:o.selectedVenue.image_url||null,url:o.selectedVenue.url||null,date_published:new Date().toISOString(),date_modified:new Date().toISOString()})).error){if(Or){const Ms=yield T.from("venues").select("id").eq("identifier",nr).limit(1);Array.isArray(Ms.data)&&Ms.data.length>0&&(Br=Ms.data[0].id)}if(!Br){const Ms=yield T.from("venues").select("id").ilike("name",`%${o.selectedVenue.name}%`).limit(1);Array.isArray(Ms.data)&&Ms.data.length>0&&(Br=Ms.data[0].id)}}}}}catch(nr){}Br&&!q(Br)&&(Br=void 0);const En=q(Me)?Me:void 0,$r=Br&&q(Br)?Br:void 0,Qn=ze&&q(ze)?ze:void 0;if(!En&&(!Qn||!$r))throw new Error("Unable to determine a valid event ID or artist+venue combination for this review.");let la;if(o.eventDate&&o.eventDate.trim()!==""){const nr=new Date(o.eventDate+"T00:00:00Z");isNaN(nr.getTime())||(la=nr)}else e!=null&&e.event_date&&(la=new Date(e.event_date));const wi=M(M({},Hr),la?{Event_date:la}:{}),In=yield bs.setEventReview(t,En,wi,$r,Qn);En&&_e(En);try{console.log(" EventReviewForm: Starting NUCLEAR draft deletion:",{eventId:En,artistId:Qn,venueId:$r});let nr=T.from("reviews").delete().eq("user_id",t).eq("is_draft",!0).select("id");En?nr=nr.eq("event_id",En):Qn&&$r&&(nr=nr.eq("artist_id",Qn).eq("venue_id",$r).is("event_id",null));const{error:Or,data:ln}=yield nr;if(Or)console.error(" EventReviewForm: First deletion failed:",Or);else{const js=(ln==null?void 0:ln.length)||0;console.log(` EventReviewForm: Deleted ${js} draft(s)`)}if((un=o.selectedArtist)!=null&&un.name&&((hn=o.selectedVenue)!=null&&hn.name)&&o.eventDate){console.log(" EventReviewForm: Looking for matching drafts by artist/venue/date...");const{data:js,error:bi}=yield T.from("reviews").select("id, event_id, draft_data, is_draft").eq("user_id",t).eq("is_draft",!0);if(!bi&&js){const xa=js.filter(Ms=>{var ou,Vc,ql,Wc;if(!Ms.draft_data)return!1;const _s=Ms.draft_data,Za=((ou=_s==null?void 0:_s.selectedArtist)==null?void 0:ou.name)||(_s==null?void 0:_s.artist_name),Nr=((Vc=_s==null?void 0:_s.selectedVenue)==null?void 0:Vc.name)||(_s==null?void 0:_s.venue_name),Ma=_s==null?void 0:_s.eventDate,fn=Za===((ql=o.selectedArtist)==null?void 0:ql.name)&&Nr===((Wc=o.selectedVenue)==null?void 0:Wc.name)&&Ma===o.eventDate;return fn&&console.log(` EventReviewForm: Found matching draft ${Ms.id} for same concert (different event_id)`),fn});for(const Ms of xa)console.log(` EventReviewForm: Deleting matching draft ${Ms.id}`),yield T.from("reviews").delete().eq("id",Ms.id);xa.length>0&&console.log(` EventReviewForm: Deleted ${xa.length} matching draft(s) for same concert`)}}yield new Promise(js=>setTimeout(js,200));const Cn=yield T.from("reviews").select("id, is_draft").eq("user_id",t).eq("event_id",Me).eq("is_draft",!0);Cn.data&&Cn.data.length>0?(console.error(` EventReviewForm: ${Cn.data.length} draft(s) STILL EXIST! Force deleting...`,Cn.data),yield T.from("reviews").delete().eq("user_id",t).eq("event_id",Me).eq("is_draft",!0)):console.log(" EventReviewForm: Verified - all drafts for this event successfully deleted")}catch(nr){console.error(" EventReviewForm: CRITICAL error during draft deletion:",nr)}try{const nr=In.id||"unknown",Or=q(In.id)?In.id:null;let ln,Cn,js=null;Qn?(ln="artist",Cn=Qn,js=Qn):$r?(ln="venue",Cn=$r,js=$r):En&&(ln="event",Cn=En,js=En);const bi={artist_performance_rating:Hr.artist_performance_rating,production_rating:Hr.production_rating,venue_rating:Hr.venue_rating,location_rating:Hr.location_rating,value_rating:Hr.value_rating,is_public:Hr.is_public,has_text:!!Hr.review_text,text_length:((xn=Hr.review_text)==null?void 0:xn.length)||0,reviewType:o.reviewType};ln&&Cn&&(bi.reviewed_entity_type=ln,bi.reviewed_entity_id=Cn),On.review("review",nr,Hr.rating,bi,Or);const xa={reviewType:o.reviewType};ln&&Cn&&(xa.reviewed_entity_type=ln,xa.reviewed_entity_id=Cn),On.formSubmit("review",nr,!0,xa,Or)}catch(nr){}if(i({title:S?"Review Updated":"Review Submitted! ",description:S?"Your review has been updated.":"Thanks for sharing your concert experience!"}),o.attendees&&o.attendees.length>0){const nr=o.attendees.filter(Or=>Or.type==="phone").map(Or=>Or.phone);if(nr.length>0)try{const{data:Or}=yield T.from("users").select("name").eq("user_id",t).single(),ln=(Or==null?void 0:Or.name)||"A friend";yield Wde.sendReviewInvitations(nr,In.id,ln)}catch(Or){console.error("Failed to send SMS invitations:",Or)}}if(S){if(r){console.log(" Calling onSubmitted callback immediately after edit");const nr=r(In);nr instanceof Promise&&(yield nr)}}else{console.log(" New review submitted, checking if we should show ranking modal"),console.log("  Review data:",{id:In.id,rating:In.rating,artist_performance_rating:In.artist_performance_rating,production_rating:In.production_rating,venue_rating:In.venue_rating,location_rating:In.location_rating,value_rating:In.value_rating});const nr=[In.artist_performance_rating,In.production_rating,In.venue_rating,In.location_rating,In.value_rating].filter(ln=>typeof ln=="number"&&ln>0),Or=nr.length===5?nr.reduce((ln,Cn)=>ln+Cn,0)/nr.length:In.rating;console.log("  Effective rating for modal:",Or),console.log("  Opening ranking modal with review ID:",In.id),console.log("   Deferring onSubmitted callback until ranking modal closes to avoid unmounting component"),O(In),setTimeout(()=>{R(!0),console.log("   Modal state updated:",{showRankingModal:!0,submittedReview:In.id})},100)}}catch(Rt){const hr=Rt instanceof Error?Rt.message:String(Rt);console.error("Error submitting review:",Rt),i({title:"Error",description:`Failed to submit review: ${hr}`,variant:"destructive"}),G(!1)}finally{u(!1)}}),oe=()=>E(this,null,function*(){console.log(" Ranking modal closing"),R(!1);const Ne=$;if(O(null),f(),G(!1),r&&Ne){console.log(" Calling onSubmitted callback after ranking modal close");const Fe=r(Ne);Fe instanceof Promise&&(yield Fe)}}),ce=()=>{const Ne=[o.artistPerformanceRating,o.productionRating,o.venueRating,o.locationRating,o.valueRating].filter(Fe=>typeof Fe=="number"&&Fe>0);return Ne.length>0?Ne.reduce((Fe,ve)=>Fe+ve,0)/Ne.length:o.rating},Ae=ce(),Be=b||Wf,Xe=Math.min(100,Math.max(0,Math.round(p/Be*100))),ge=HN(N||"detailed"),We=p<Be&&ge[p]?ge[p]:null,Ue=[{label:"Artist performance",rating:o.artistPerformanceRating,annotation:o.artistPerformanceFeedback},{label:"Production quality",rating:o.productionRating,annotation:o.productionFeedback},{label:"Venue experience",rating:o.venueRating,annotation:o.venueFeedback},{label:"Location & logistics",rating:o.locationRating,annotation:o.locationFeedback},{label:"Value for ticket",rating:o.valueRating,annotation:o.valueFeedback}],at=()=>{var Fe,ve,Me,ze;const Ne=((Fe=o.selectedArtist)==null?void 0:Fe.name)&&o.eventDate;return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs(le,{type:"button",variant:"outline",onClick:()=>re(!0),disabled:!Ne,className:"border-pink-200 text-pink-600 hover:bg-pink-50 w-full sm:w-auto",children:[s.jsx($t,{className:"w-4 h-4 mr-2"}),"Import from setlist.fm"]}),o.selectedSetlist&&s.jsx(le,{type:"button",variant:"ghost",onClick:ie,className:"text-gray-500 hover:text-gray-700 w-full sm:w-auto",children:"Clear setlist"})]}),!Ne&&s.jsx("p",{className:"text-xs text-gray-500",children:"Select an artist (and date if you know it) to search official setlists."}),o.selectedSetlist?s.jsxs("div",{className:"rounded-xl border border-pink-100 bg-pink-50/40 p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:((ve=o.selectedSetlist.artist)==null?void 0:ve.name)||((Me=o.selectedArtist)==null?void 0:Me.name)}),s.jsxs("p",{className:"text-xs text-gray-600",children:[(ze=o.selectedSetlist.venue)==null?void 0:ze.name,o.selectedSetlist.eventDate&&s.jsxs(s.Fragment,{children:["  ",de(o.selectedSetlist.eventDate)]})]})]}),s.jsxs(Ke,{variant:"secondary",className:"bg-white text-pink-600 border-pink-100",children:[o.selectedSetlist.songCount," songs"]})]}),s.jsx("ul",{className:"grid gap-1 text-xs text-gray-700 sm:grid-cols-2",children:(o.selectedSetlist.songs||[]).slice(0,8).map((ct,Et)=>{var gt;return s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsxs("span",{className:"font-medium text-pink-600",children:[Et+1,"."]}),s.jsxs("span",{className:"flex-1",children:[ct.name,((gt=ct.cover)==null?void 0:gt.artist)&&s.jsxs("span",{className:"block text-[11px] text-gray-500",children:["Cover: ",ct.cover.artist]})]})]},`${ct.name}-${Et}`)})}),Array.isArray(o.selectedSetlist.songs)&&o.selectedSetlist.songs.length>8&&s.jsxs("p",{className:"text-[11px] text-gray-500",children:["+",o.selectedSetlist.songs.length-8," more in the setlist"]})]}):s.jsx("p",{className:"text-xs text-gray-500",children:"Can't find it? Add your own setlist below so other fans know what was played."}),s.jsx(y2,{songs:o.customSetlist||[],onChange:se,disabled:!!o.selectedSetlist,className:"mt-2"})]})},mt=()=>{var Fe,ve,Me,ze;const Ne=!!((Fe=o.selectedArtist)!=null&&Fe.name);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[s.jsxs(le,{type:"button",variant:"outline",onClick:()=>re(!0),disabled:!Ne,className:"border-pink-200 text-pink-600 hover:bg-pink-50 w-full sm:w-auto",children:[s.jsx($t,{className:"w-4 h-4 mr-2"}),"Import from setlist.fm"]}),o.selectedSetlist&&s.jsx(le,{type:"button",variant:"ghost",onClick:ie,className:"text-gray-500 hover:text-gray-700 w-full sm:w-auto",children:"Clear setlist"})]}),!Ne&&s.jsx("p",{className:"text-xs text-gray-500",children:"Select an artist (and date if you know it) to search official setlists."}),o.selectedSetlist?s.jsxs("div",{className:"rounded-xl border border-pink-100 bg-pink-50/40 p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:((ve=o.selectedSetlist.artist)==null?void 0:ve.name)||((Me=o.selectedArtist)==null?void 0:Me.name)}),s.jsxs("p",{className:"text-xs text-gray-600",children:[(ze=o.selectedSetlist.venue)==null?void 0:ze.name,o.selectedSetlist.eventDate&&s.jsxs(s.Fragment,{children:["  ",de(o.selectedSetlist.eventDate)]})]})]}),s.jsxs(Ke,{variant:"secondary",className:"bg-white text-pink-600 border-pink-100",children:[o.selectedSetlist.songCount," songs"]})]}),s.jsx("ul",{className:"grid gap-1 text-xs text-gray-700 sm:grid-cols-2",children:(o.selectedSetlist.songs||[]).slice(0,8).map((ct,Et)=>{var gt;return s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsxs("span",{className:"font-medium text-pink-600",children:[Et+1,"."]}),s.jsxs("span",{className:"flex-1",children:[ct.name,((gt=ct.cover)==null?void 0:gt.artist)&&s.jsxs("span",{className:"block text-[11px] text-gray-500",children:["Cover: ",ct.cover.artist]})]})]},`${ct.name}-${Et}`)})}),Array.isArray(o.selectedSetlist.songs)&&o.selectedSetlist.songs.length>8&&s.jsxs("p",{className:"text-[11px] text-gray-500",children:["+",o.selectedSetlist.songs.length-8," more in the setlist"]})]}):s.jsx("p",{className:"text-xs text-gray-500",children:"Cant find it? Add your own setlist below so other fans know what was played."}),s.jsx(y2,{songs:o.customSetlist||[],onChange:se,disabled:!!o.selectedSetlist,className:"mt-2"})]})},Ye=()=>{var Fe,ve;const Ne=N||"detailed";if(p===1)return s.jsx(mde,{reviewDuration:o.reviewDuration,onSelectDuration:Me=>{d({reviewDuration:Me}),setTimeout(()=>g(),100)}});switch(Ne){case"quick":if(p===2)return s.jsx(VN,{formData:o,errors:l,onUpdateFormData:d});if(p===3)return s.jsx(Ede,{formData:o,errors:l,onUpdateFormData:d,artistName:(Fe=o.selectedArtist)==null?void 0:Fe.name,venueName:(ve=o.selectedVenue)==null?void 0:ve.name,eventDate:o.eventDate});if(p===4)return s.jsx(WN,{formData:o,errors:l,onUpdateFormData:d,onSubmit:we,isLoading:c,averageRating:o.rating,categoryBreakdown:[]});break;case"standard":if(p===2)return s.jsx(VN,{formData:o,errors:l,onUpdateFormData:d});if(p===3)return s.jsx(uu,{config:ae[2],formData:o,errors:l,onUpdateFormData:d,children:mt()});if(p===4)return s.jsx(uu,{config:ae[4],formData:o,errors:l,onUpdateFormData:d,previousVenueReview:ye});if(p===5)return s.jsxs(s.Fragment,{children:[s.jsx(k5,{formData:o,errors:l,onUpdateFormData:d,maxCharacters:400}),s.jsxs("div",{className:"mt-8 space-y-4",children:[s.jsx(Ht,{className:"text-base font-semibold text-gray-900",children:"Setlist (Optional)"}),at()]})]});if(p===6){const Me=o.artistPerformanceRating>0&&o.venueRating>0?(o.artistPerformanceRating+o.venueRating)/2:o.rating;return s.jsx(WN,{formData:o,errors:l,onUpdateFormData:d,onSubmit:we,isLoading:c,averageRating:Me,categoryBreakdown:[{label:"Artist Performance",rating:o.artistPerformanceRating},{label:"Venue",rating:o.venueRating}]})}break;case"detailed":if(p===2)return s.jsx(VN,{formData:o,errors:l,onUpdateFormData:d});if(p===3)return s.jsx(uu,{config:ae[2],formData:o,errors:l,onUpdateFormData:d,children:mt()});if(p===4)return s.jsx(uu,{config:ae[3],formData:o,errors:l,onUpdateFormData:d});if(p===5)return s.jsx(uu,{config:ae[4],formData:o,errors:l,onUpdateFormData:d,previousVenueReview:ye});if(p===6)return s.jsx(uu,{config:ae[5],formData:o,errors:l,onUpdateFormData:d,previousVenueReview:ye});if(p===7)return s.jsx(uu,{config:ae[6],formData:o,errors:l,onUpdateFormData:d,children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs(Ht,{htmlFor:"ticketPricePaid",className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Ro,{className:"w-4 h-4 text-pink-500"}),"What did you pay? (kept private)"]}),s.jsx(Ar,{id:"ticketPricePaid",type:"number",min:"0",step:"0.01",placeholder:"e.g. 78.50",value:o.ticketPricePaid,onChange:Me=>d({ticketPricePaid:Me.target.value})}),s.jsx("p",{className:"text-xs text-gray-500",children:"Only you can see this number. It helps calibrate value for other fans."})]})});if(p===8)return s.jsxs(s.Fragment,{children:[s.jsx(k5,{formData:o,errors:l,onUpdateFormData:d,maxCharacters:500}),s.jsxs("div",{className:"mt-8 space-y-4",children:[s.jsx(Ht,{className:"text-base font-semibold text-gray-900",children:"Setlist (Optional)"}),at()]})]});if(p===9)return s.jsx(WN,{formData:o,errors:l,onUpdateFormData:d,onSubmit:we,isLoading:c,averageRating:Ae,categoryBreakdown:Ue});break}return null};return console.log(" EventReviewForm render state:",{existingReview:!!S,isLoading:c,actualEventId:Z,hasFormData:!!o}),s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-6 space-y-6 sm:space-y-8 w-full max-w-full overflow-x-hidden",children:[!S&&s.jsx(Vde,{userId:t,onSelectDraft:Ne=>{X(Ne),Ne.draft_data&&h(Ne.draft_data),a&&a()},onNewReview:()=>{X(null),f(),G(!1)},currentMode:Q?"draft":"new"}),!S&&s.jsx("div",{className:"p-3 rounded-lg w-full max-w-full overflow-x-hidden",style:{backgroundColor:"var(--brand-pink-050)",border:"1px solid var(--brand-pink-500)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsxs("div",{className:"flex items-center gap-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)"},children:[s.jsx("div",{className:"flex-shrink-0",style:{width:"var(--spacing-inline, 6px)",height:"var(--spacing-inline, 6px)",backgroundColor:"var(--brand-pink-500)",borderRadius:"999px"}}),s.jsx("span",{className:"break-words",children:"Your progress is automatically saved locally"})]})}),s.jsx("div",{className:"space-y-3 sm:space-y-4 w-full max-w-full overflow-x-hidden",children:p!==1&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[s.jsxs("div",{className:"min-w-0",children:[s.jsxs("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:["Step ",p," of ",b||Wf]}),s.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mt-1 break-words",children:HN(N||"detailed")[p-1]||"Review"})]}),s.jsx("div",{className:"w-full sm:w-48 h-2 overflow-hidden flex-shrink-0",style:{backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all duration-300",style:{width:`${Xe}%`,backgroundColor:"var(--brand-pink-500)",borderRadius:"var(--radius-corner, 10px)"}})})]}),s.jsx("div",{className:"flex flex-wrap gap-2 w-full max-w-full overflow-x-hidden",children:HN(N||"detailed").map((Ne,Fe)=>{const ve=Fe+1,Me=ve===p,ze=ve<p;return s.jsxs("span",{className:ke("px-2 sm:px-3 py-1 rounded-full text-xs font-medium transition-colors flex-shrink-0",Me?"bg-pink-500 text-white shadow-sm":ze?"bg-pink-100 text-pink-700":"bg-gray-100 text-gray-500"),children:[ve,". ",Ne]},`${Ne}-${Fe}`)})})]})}),s.jsx("div",{className:"min-h-[420px] w-full max-w-full overflow-x-hidden",children:Ye()}),s.jsxs("div",{className:"space-y-3 sm:space-y-4 border-t pt-3 sm:pt-4 w-full max-w-full overflow-x-hidden",children:[s.jsx("div",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-center justify-between gap-2 w-full",children:[s.jsx(le,{variant:"ghost",onClick:v,disabled:!_,className:"flex-shrink-0",size:"sm",children:"Back"}),s.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500 flex-shrink-0",children:z?s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"animate-pulse flex-shrink-0",style:{width:"var(--spacing-inline, 6px)",height:"var(--spacing-inline, 6px)",backgroundColor:"var(--rating-star)",borderRadius:"999px"}}),s.jsx("span",{className:"whitespace-nowrap",children:"Auto-saving"})]}):B?s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"flex-shrink-0",style:{width:"var(--spacing-inline, 6px)",height:"var(--spacing-inline, 6px)",backgroundColor:"var(--status-success-500)",borderRadius:"999px"}}),s.jsxs("span",{className:"whitespace-nowrap hidden sm:inline",children:["Auto-saved ",B.toLocaleTimeString()]}),s.jsx("span",{className:"whitespace-nowrap sm:hidden",children:"Saved"})]}):s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"flex-shrink-0",style:{width:"var(--spacing-inline, 6px)",height:"var(--spacing-inline, 6px)",backgroundColor:"var(--neutral-400)",borderRadius:"999px"}}),s.jsx("span",{className:"whitespace-nowrap hidden sm:inline",children:"Auto-save active"}),s.jsx("span",{className:"whitespace-nowrap sm:hidden",children:"Saved"})]})}),p<(b||Wf)&&s.jsxs(le,{onClick:g,disabled:!y,className:"bg-pink-500 hover:bg-pink-600 flex-shrink-0",size:"sm",children:["Next",We?`: ${We}`:""]})]})}),S&&s.jsx("div",{className:"flex justify-end",children:s.jsx(le,{variant:"outline",onClick:()=>E(this,null,function*(){console.log(" Deleting review:",{reviewId:S==null?void 0:S.id,eventId:e.id,userId:t});try{if(!(S!=null&&S.id))throw new Error("No review ID found");yield bs.deleteEventReview(t,S.id),console.log(" Review deleted successfully");try{On.click("review",e.id,{action:"delete",source:"event_review_form"})}catch(Ne){}if(i({title:"Review Deleted",description:"Your review has been deleted."}),k(null),f(),G(!1),n){console.log(" Calling onDeleted callback");const Ne=n();Ne instanceof Promise&&(yield Ne)}}catch(Ne){console.error(" Error deleting review:",Ne);const Fe=Ne instanceof Error?Ne.message:"Unknown error";i({title:"Error",description:`Failed to delete review: ${Fe}`,variant:"destructive"})}}),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:"Delete Review"})})]})]}),s.jsx(G8,{isOpen:ne,onClose:()=>re(!1),artistName:((Oe=o.selectedArtist)==null?void 0:Oe.name)||"",venueName:((qe=o.selectedVenue)==null?void 0:qe.name)||void 0,eventDate:o.eventDate||void 0,onSetlistSelect:xe}),$&&s.jsx(Cde,{isOpen:A,onClose:oe,userId:t,newReview:$,rating:ce()})]})}function lB({event:e,userId:t,isOpen:r,onClose:n,onReviewSubmitted:a}){if(!e&&!r)return null;const i=()=>{n()},o=e&&"title"in e?e.title:e&&"event_name"in e?e.event_name:"Create Review";return s.jsx(pn,{open:r,onOpenChange:i,children:s.jsxs(dn,{children:[s.jsx(Vn,{children:s.jsx(bn,{children:o})}),s.jsx(K9,{children:s.jsx(oB,{event:e,userId:t,onSubmitted:l=>E(this,null,function*(){if(a){const c=a(l);c instanceof Promise&&(yield c)}n()}),onDeleted:()=>E(this,null,function*(){if(a){const l=a(null);l instanceof Promise&&(yield l)}n()})})})]})})}function mT({accountType:e,verified:t,size:r="md",className:n="",showTooltip:a=!0}){if(!t)return null;const i=Vie(e),o=i.icon,l={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"},c=s.jsx("div",{className:`inline-flex items-center justify-center ${l[r]} ${n}`,style:{background:`linear-gradient(135deg, ${i.colors.from}, ${i.colors.to})`,borderRadius:"50%",padding:"2px"},children:s.jsx(o,{className:"w-full h-full text-white",strokeWidth:2.5,fill:"white"})});return a?s.jsx(IP,{children:s.jsxs(bz,{children:[s.jsx(jz,{asChild:!0,children:c}),s.jsx($P,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"font-semibold",children:i.label}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1 max-w-[200px]",children:i.description})]})})]})}):c}class _d{static getShareTargets(t){return E(this,null,function*(){try{const{data:r,error:n}=yield oT(t);if(n)throw console.error("Error fetching share targets:",n),n;return(r||[]).map(i=>({id:i.id,name:i.chat_name,type:i.is_group_chat?"group":"direct",users:i.users||[],avatar_url:null}))}catch(r){throw console.error("Error getting share targets:",r),new Error(`Failed to get share targets: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getFriends(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_relationships").select("id, user_id, related_user_id, created_at").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`).order("created_at",{ascending:!1});if(n)throw console.error("Error fetching friends:",n),n;if(!r||r.length===0)return[];const a=r.map(l=>l.user_id===t?l.related_user_id:l.user_id),{data:i,error:o}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",a);if(o)throw console.error("Error fetching friend profiles:",o),o;return i||[]}catch(r){throw console.error("Error getting friends:",r),new Error(`Failed to get friends: ${r instanceof Error?r.message:"Unknown error"}`)}})}static shareEventToChat(t,r,n,a){return E(this,null,function*(){var i;try{const o=a||"Check out this event!",{data:l,error:c}=yield T.from("messages").insert({chat_id:r,sender_id:n,content:o,message_type:"event_share",shared_event_id:t,metadata:{custom_message:a,share_context:"in_app_share"}}).select("id, chat_id").single();if(c){if(console.error("Error creating share message:",c),c.code==="23503"||(i=c.message)!=null&&i.includes("foreign key")||c.code==="42703"){console.warn("FK constraint or column error, retrying without shared_event_id FK");const{data:d,error:u}=yield T.from("messages").insert({chat_id:r,sender_id:n,content:o,message_type:"event_share",shared_event_id:null,metadata:{custom_message:a,share_context:"in_app_share",event_id:t}}).select("id, chat_id").single();if(u)return{success:!1,error:"Failed to share event: "+(u.message||"Unknown error")};try{yield T.from("event_shares").insert({event_id:t,sharer_user_id:n,chat_id:r,message_id:d.id,share_type:"direct_chat"})}catch(f){console.warn("Failed to track event share in analytics (non-critical):",f)}return{success:!0,message_id:d.id,chat_id:d.chat_id}}return{success:!1,error:"Failed to share event: "+(c.message||"Unknown error")}}try{yield T.from("event_shares").insert({event_id:t,sharer_user_id:n,chat_id:r,message_id:l.id,share_type:"direct_chat"})}catch(d){console.warn("Failed to track event share in analytics (non-critical):",d)}return{success:!0,message_id:l.id,chat_id:l.chat_id}}catch(o){return console.error("Error sharing event to chat:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}})}static shareEventToMultipleChats(t,r,n,a){return E(this,null,function*(){const i=[];for(const c of r){const d=yield this.shareEventToChat(t,c,n,a);i.push(d)}const o=i.filter(c=>c.success).length,l=i.filter(c=>!c.success).length;return{successCount:o,failureCount:l,results:i}})}static shareEventToNewChat(t,r,n,a){return E(this,null,function*(){try{const{data:i,error:o}=yield T.rpc("create_direct_chat",{user1_id:n,user2_id:r});return o||!i?{success:!1,error:"Failed to create chat"}:yield this.shareEventToChat(t,i,n,a)}catch(i){return console.error("Error sharing event to new chat:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}})}static getEventShareStats(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_shares").select("share_type").eq("event_id",t);if(n)return console.error("Error fetching share stats:",n),{total_shares:0,direct_shares:0,group_shares:0};const a=(r==null?void 0:r.length)||0,i=(r==null?void 0:r.filter(l=>l.share_type==="direct_chat").length)||0,o=(r==null?void 0:r.filter(l=>l.share_type==="group_chat").length)||0;return{total_shares:a,direct_shares:i,group_shares:o}}catch(r){return console.error("Error getting event share stats:",r),{total_shares:0,direct_shares:0,group_shares:0}}})}static shareReviewToChat(t,r,n,a){return E(this,null,function*(){var i;try{const{data:o,error:l}=yield T.from("reviews").select("id, review_text, rating, event_id, user_id").eq("id",t).single();if(l||!o)return{success:!1,error:"Review not found"};const c=a||"Check out this review!",{data:d,error:u}=yield T.from("messages").insert({chat_id:r,sender_id:n,content:c,message_type:"review_share",shared_review_id:t,metadata:{custom_message:a,share_context:"in_app_share"}}).select("id, chat_id").single();if(u){if(console.error("Error creating review share message:",u),u.code==="23503"||(i=u.message)!=null&&i.includes("foreign key")||u.code==="42703"){console.warn("FK constraint or column error, retrying without shared_review_id FK");const{data:f,error:h}=yield T.from("messages").insert({chat_id:r,sender_id:n,content:c,message_type:"review_share",shared_review_id:null,metadata:{custom_message:a,share_context:"in_app_share",review_id:t}}).select("id, chat_id").single();return h?{success:!1,error:"Failed to share review: "+(h.message||"Unknown error")}:{success:!0,message_id:f.id,chat_id:f.chat_id}}return{success:!1,error:"Failed to share review: "+(u.message||"Unknown error")}}return{success:!0,message_id:d.id,chat_id:d.chat_id}}catch(o){return console.error("Error sharing review to chat:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}})}static shareReviewToMultipleChats(t,r,n,a){return E(this,null,function*(){const i=[];for(const c of r){const d=yield this.shareReviewToChat(t,c,n,a);i.push(d)}const o=i.filter(c=>c.success).length,l=i.filter(c=>!c.success).length;return{successCount:o,failureCount:l,results:i}})}static shareReviewToNewChat(t,r,n,a){return E(this,null,function*(){try{const{data:i,error:o}=yield T.rpc("create_direct_chat",{user1_id:n,user2_id:r});return o||!i?{success:!1,error:"Failed to create chat"}:yield this.shareReviewToChat(t,i,n,a)}catch(i){return console.error("Error sharing review to new chat:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}})}}class ev{static getBaseUrl(){return typeof window!="undefined"&&window.location?window.location.origin:"https://plusone.app"}static getEventUrl(t){return`${this.getBaseUrl()}/?event=${encodeURIComponent(t)}`}static getReviewUrl(t){return`${this.getBaseUrl()}/?review=${encodeURIComponent(t)}`}static shareEvent(t,r,n){return E(this,null,function*(){var i;const a=this.getEventUrl(t);try{navigator.share?yield navigator.share({title:r||"PlusOne Event",text:n,url:a}):(i=navigator.clipboard)!=null&&i.writeText&&(yield navigator.clipboard.writeText(a))}catch(o){}return a})}static shareReview(t,r,n){return E(this,null,function*(){var i;const a=this.getReviewUrl(t);try{navigator.share?yield navigator.share({title:r||"PlusOne Review",text:n,url:a}):(i=navigator.clipboard)!=null&&i.writeText&&(yield navigator.clipboard.writeText(a))}catch(o){}return a})}}function cB({review:e,currentUserId:t,isOpen:r,onClose:n,onShareComplete:a}){const[i,o]=x.useState([]),[l,c]=x.useState([]),[d,u]=x.useState(new Set);x.useState(new Set);const[f,h]=x.useState(""),[p,g]=x.useState(""),[v,y]=x.useState(!1),[_,w]=x.useState(!1),[b,N]=x.useState(!1),{toast:S}=Rr(),k=e.artist_name?`${e.artist_name}${e.venue_name?` at ${e.venue_name}`:""}`:e.venue_name||"Concert Review",P=()=>E(this,null,function*(){try{const F=yield ev.shareReview(e.id,"PlusOne Review",e.review_text||void 0);navigator.share?(yield navigator.share({title:`Review: ${k}`,text:e.review_text||"Check out this concert review!",url:F}),S({title:"Shared!",description:"Review shared successfully"})):(yield navigator.clipboard.writeText(F),S({title:"Link Copied!",description:"Review link copied to clipboard"}))}catch(F){F.name!=="AbortError"&&(console.error("Error sharing externally:",F),S({title:"Error",description:"Failed to share review",variant:"destructive"}))}});x.useEffect(()=>{r&&(A(),R(),N(!1))},[r,t]);const A=()=>E(this,null,function*(){try{y(!0);const F=yield _d.getShareTargets(t);o(F)}catch(F){console.error("Error loading share targets:",F),S({title:"Error",description:"Failed to load chats",variant:"destructive"})}finally{y(!1)}}),R=()=>E(this,null,function*(){try{const F=yield _d.getFriends(t);c(F)}catch(F){console.error("Error loading friends:",F)}}),$=F=>{u(U=>{const G=new Set(U);return G.has(F)?G.delete(F):G.add(F),G})},O=()=>E(this,null,function*(){if(d.size===0){S({title:"No chats selected",description:"Please select at least one chat to share with",variant:"destructive"});return}try{w(!0);const F=Array.from(d),U=F.filter(K=>!K.startsWith("friend-")),G=F.filter(K=>K.startsWith("friend-")).map(K=>K.replace("friend-",""));let q={successCount:0,errors:[]};if(U.length>0){const K=yield _d.shareReviewToMultipleChats(e.id,U,t,f||void 0);q.successCount+=K.successCount,q.errors.push(...K.results.filter(Z=>!Z.success).map(Z=>Z.error||"Unknown error"))}for(const K of G)try{const Z=yield _d.shareReviewToNewChat(e.id,K,t,f||void 0);Z.success?q.successCount+=1:q.errors.push(Z.error||"Failed to share with friend")}catch(Z){q.errors.push(`Failed to share with friend: ${Z}`)}if(q.successCount>0){try{yield bs.shareReview(t,e.id,"in_app_chat"),a&&a()}catch(K){console.warn("Failed to record share in analytics (non-critical):",K)}S({title:"Review Shared! ",description:`Successfully shared to ${q.successCount} chat${q.successCount>1?"s":""}`}),u(new Set),h(""),n()}q.errors.length>0&&S({title:"Partial Success",description:`${q.errors.length} share${q.errors.length>1?"s":""} failed`,variant:"destructive"})}catch(F){console.error("Error sharing review:",F),S({title:"Error",description:"Failed to share review",variant:"destructive"})}finally{w(!1)}}),z=i.filter(F=>F.name.toLowerCase().includes(p.toLowerCase())&&!F.name.toLowerCase().includes("direct chat")&&!F.name.toLowerCase().includes("dc direct")),D=l.filter(F=>F.name.toLowerCase().includes(p.toLowerCase())),B=[...z.map(F=>H(M({},F),{type:"group",isGroup:!0})),...D.map(F=>({id:`friend-${F.user_id}`,name:F.name,avatar_url:F.avatar_url,type:"friend",isGroup:!1,user_id:F.user_id}))];return s.jsx(pn,{open:r,onOpenChange:n,children:s.jsxs(dn,{className:"max-w-lg max-h-[85vh] overflow-hidden flex flex-col",children:[s.jsxs(Vn,{children:[s.jsx(bn,{className:"text-xl font-bold",children:"Share Review"}),s.jsxs(os,{children:['Share "',k,'" with your friends']})]}),s.jsxs("div",{className:"bg-gradient-to-r from-pink-50 to-purple-50 rounded-lg p-3 border border-pink-200",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((F,U)=>s.jsx(Qt,{className:`w-4 h-4 ${U<(e.rating||0)?"fill-pink-500 text-pink-500":"text-gray-300"}`},U))}),s.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:k})]}),e.review_text&&s.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:e.review_text})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(le,{onClick:P,variant:"outline",className:"h-auto py-4 border-pink-200 hover:bg-pink-50 flex flex-col items-center gap-2",children:[s.jsx(zd,{className:"w-6 h-6 text-pink-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Share Externally"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Phone, Apps, etc."})]}),s.jsxs(le,{onClick:()=>{N(!b),!b&&i.length===0&&l.length===0&&!v&&(A(),R())},variant:b?"default":"outline",className:`h-auto py-4 border-pink-200 flex flex-col items-center gap-2 ${b?"bg-pink-500 hover:bg-pink-600 text-white border-pink-500":"hover:bg-pink-50"}`,children:[s.jsx($n,{className:`w-6 h-6 ${b?"text-white":"text-pink-500"}`}),s.jsx("span",{className:"text-sm font-medium",children:"Share in Chat"}),s.jsx("span",{className:`text-xs ${b?"text-pink-100":"text-gray-500"}`,children:"Within Synth"})]})]}),b&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-1 mt-4 border-t pt-4",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Add a message (optional)"}),s.jsx(ys,{placeholder:"Check out this review! ",value:f,onChange:F=>h(F.target.value),rows:1,className:"resize-none text-sm"})]}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden mt-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx($n,{className:"w-5 h-5 text-pink-500"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Choose Chats"})]}),s.jsxs("div",{className:"relative mb-3",children:[s.jsx(Uo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx(Ar,{placeholder:"Search chats...",value:p,onChange:F=>g(F.target.value),className:"pl-10"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2",children:v?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(lr,{className:"w-6 h-6 animate-spin text-pink-500"})}):B.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx($n,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),s.jsx("p",{children:"No chats found"}),s.jsx("p",{className:"text-sm",children:"Start a conversation to share reviews"})]}):B.map(F=>{var U;return s.jsxs("div",{onClick:()=>$(F.id),className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all ${d.has(F.id)?"bg-pink-50 border-2 border-pink-300":"bg-white border border-gray-200 hover:border-pink-200"}`,children:[s.jsxs(Vr,{className:"w-10 h-10",children:[s.jsx(sn,{src:F.avatar_url||void 0}),s.jsx(Wr,{children:F.isGroup?s.jsx($n,{className:"w-5 h-5"}):F.name.split(" ").map(G=>G[0]).join("")})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:F.name}),s.jsx("p",{className:"text-xs text-gray-500",children:F.isGroup?`${((U=F.users)==null?void 0:U.length)||F.member_count||0} members`:"Direct message"})]}),d.has(F.id)&&s.jsx("div",{className:"w-6 h-6 rounded-full bg-pink-500 flex items-center justify-center",children:s.jsx(ta,{className:"w-4 h-4 text-white"})})]},F.id)})}),s.jsxs("div",{className:"mt-4 pt-4 border-t flex gap-2",children:[s.jsx(le,{onClick:n,variant:"outline",className:"flex-1",children:"Cancel"}),s.jsx(le,{onClick:O,disabled:d.size===0||_,className:"flex-1 bg-pink-500 hover:bg-pink-600 text-white",children:_?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-4 h-4 mr-2 animate-spin"}),"Sharing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Fc,{className:"w-4 h-4 mr-2"}),"Share (",d.size,")"]})})]})]})]})]})})}function A5({setlist:e,customSetlist:t,className:r,compact:n=!1,type:a}){var p,g,v,y;const[i,o]=x.useState(!1),l=a||(t?"custom":"api");if(!(l==="custom"?t:e))return null;if(l==="custom"){const _=t||[],w=_.length;return w===0?null:n?s.jsxs("div",{children:[s.jsxs("button",{className:ke("flex items-center justify-between gap-2 p-3 bg-purple-50 rounded-lg border border-purple-200 hover:bg-purple-100 transition-colors w-full",r),onClick:b=>{b.stopPropagation(),o(!i)},children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Rs,{className:"w-4 h-4 text-purple-600"}),s.jsxs("span",{className:"text-sm font-medium text-purple-800",children:["Custom Setlist  ",w," song",w!==1?"s":""]})]}),i?s.jsx(Mo,{className:"w-4 h-4 text-purple-600"}):s.jsx(Ta,{className:"w-4 h-4 text-purple-600"})]}),i&&s.jsx("div",{className:"mt-2 p-4 bg-white rounded-lg border border-purple-200",children:s.jsx("div",{className:"space-y-2",children:_.map((b,N)=>s.jsxs("div",{className:"flex items-start gap-3 p-2 bg-purple-50/30 rounded",children:[s.jsxs("span",{className:"text-sm font-medium text-purple-500 w-8 text-right flex-shrink-0",children:[b.position,"."]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 block",children:b.song_name}),b.cover_artist&&s.jsxs(Ke,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700 mt-1",children:["Cover: ",b.cover_artist]}),b.notes&&s.jsxs("p",{className:"text-xs text-gray-600 mt-1 italic",children:['"',b.notes,'"']})]})]},N))})})]}):s.jsxs(He,{className:ke("border-purple-300 bg-gradient-to-br from-purple-50 to-pink-50",r),children:[s.jsx(Er,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Rs,{className:"w-5 h-5 text-purple-600"}),s.jsx("h4",{className:"font-semibold text-purple-900",children:"Custom Setlist"}),s.jsxs(Ke,{variant:"secondary",className:"bg-purple-100 text-purple-800",children:[w," song",w!==1?"s":""]})]}),s.jsx("p",{className:"text-xs text-purple-600",children:"User-created setlist for this show"})]}),s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>o(!i),className:"text-purple-600 border-purple-300 hover:bg-purple-100",children:[i?s.jsx(Mo,{className:"w-4 h-4 mr-1"}):s.jsx(Ta,{className:"w-4 h-4 mr-1"}),i?"Hide":"Show"," Setlist"]})]})}),i&&s.jsx(et,{className:"pt-0",children:s.jsx("div",{className:"space-y-2",children:_.map((b,N)=>s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white/60 rounded border border-purple-100",children:[s.jsxs("span",{className:"text-sm font-medium text-purple-500 w-8 text-right flex-shrink-0",children:[b.position,"."]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("span",{className:"text-sm font-medium text-purple-900 block",children:b.song_name}),b.cover_artist&&s.jsx("div",{className:"mt-1",children:s.jsxs(Ke,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:["Cover: ",b.cover_artist]})}),b.notes&&s.jsxs("p",{className:"text-xs text-purple-700 mt-1 italic",children:['"',b.notes,'"']})]})]},N))})})]})}if(!e)return null;const d=_=>{try{return new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch(w){return _}},f=(_=>{const w={};return _.forEach(b=>{w[b.setNumber]||(w[b.setNumber]=[]),w[b.setNumber].push(b)}),w})(e.songs||[]),h=((p=e.songs)==null?void 0:p.length)||0;return n?s.jsxs("div",{children:[s.jsxs("button",{className:ke("flex items-center justify-between gap-2 p-3 bg-purple-50 rounded-lg border border-purple-200 hover:bg-purple-100 transition-colors w-full",r),onClick:_=>{_.stopPropagation(),o(!i)},children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx($t,{className:"w-4 h-4 text-purple-600"}),s.jsxs("span",{className:"text-sm font-medium text-purple-800",children:[h," songs  ",Object.keys(f).length," set",Object.keys(f).length!==1?"s":""]})]}),i?s.jsx(Mo,{className:"w-4 h-4 text-purple-600"}):s.jsx(Ta,{className:"w-4 h-4 text-purple-600"})]}),i&&s.jsx("div",{className:"mt-2 p-4 bg-white rounded-lg border border-purple-200",children:Object.entries(f).map(([_,w])=>s.jsxs("div",{className:"mb-4 last:mb-0",children:[s.jsxs("h5",{className:"text-sm font-bold text-purple-900 mb-2",children:["Set ",_," (",w.length," songs)"]}),s.jsx("div",{className:"space-y-1",children:w.map((b,N)=>s.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[s.jsxs("span",{className:"text-purple-400 font-medium w-6 text-right flex-shrink-0",children:[N+1,"."]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-gray-900",children:b.name}),b.info&&s.jsxs("span",{className:"text-gray-500 ml-2 text-xs",children:["(",b.info,")"]})]})]},N))})]},_))})]}):s.jsxs(He,{className:ke("border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50",r),children:[s.jsx(Er,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx($t,{className:"w-5 h-5 text-purple-600"}),s.jsx("h4",{className:"font-semibold text-purple-900",children:"Setlist"}),s.jsxs(Ke,{variant:"secondary",className:"bg-purple-100 text-purple-800",children:[h," songs"]})]}),s.jsxs("div",{className:"space-y-1 text-sm text-purple-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(It,{className:"h-3 w-3"}),d(e.eventDate)]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(gr,{className:"h-3 w-3"}),(g=e.venue)==null?void 0:g.name,", ",(v=e.venue)==null?void 0:v.city,((y=e.venue)==null?void 0:y.state)&&`, ${e.venue.state}`]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>o(!i),className:"text-purple-600 border-purple-300 hover:bg-purple-100",children:[i?s.jsx(Mo,{className:"w-4 h-4 mr-1"}):s.jsx(Ta,{className:"w-4 h-4 mr-1"}),i?"Hide":"Show"," Setlist"]}),e.url&&s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>window.open(e.url,"_blank"),className:"text-purple-600 border-purple-300 hover:bg-purple-100",children:[s.jsx(Bo,{className:"w-4 h-4 mr-1"}),"Setlist.fm"]})]})]})}),i&&s.jsxs(et,{className:"pt-0",children:[e.info&&s.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-800",children:e.info}),s.jsx("div",{className:"space-y-4",children:Object.entries(f).map(([_,w])=>{var b;return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ke,{variant:"outline",className:"font-medium border-purple-300 text-purple-700",children:((b=w[0])==null?void 0:b.setName)||`Set ${_}`}),s.jsxs("span",{className:"text-sm text-purple-600",children:[w.length," song",w.length!==1?"s":""]})]}),s.jsx("div",{className:"space-y-1",children:w.map((N,S)=>s.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white/60 rounded border border-purple-100",children:[s.jsxs("span",{className:"text-sm font-medium text-purple-500 w-8 text-right",children:[N.position,"."]}),s.jsx("span",{className:"text-sm flex-1 text-purple-900",children:N.name}),N.cover&&s.jsx(Ke,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:N.cover.artist}),N.tape&&s.jsx(Ke,{variant:"outline",className:"text-xs border-purple-300 text-purple-600",children:"Tape"})]},S))})]},_)})})]})]})}class Si{static setArtistFollow(t,r,n){return E(this,null,function*(){var a,i,o,l;try{const{error:c}=yield T.rpc("set_artist_follow",{p_artist_id:r,p_following:n});if(c&&(c.code==="42883"||c.code==="PGRST404"||c.code==="42P01"||((a=c.message)==null?void 0:a.includes("404"))||((i=c.message)==null?void 0:i.includes("does not exist"))||((o=c.message)==null?void 0:o.includes("function"))||((l=c.message)==null?void 0:l.includes("relation"))))if(console.warn(" RPC function set_artist_follow not available, using direct table operations"),n){const{data:u,error:f}=yield T.from("artists").select("id, name").eq("id",r).maybeSingle();if(f&&f.code!=="PGRST116")throw console.error("Error checking if artist exists:",f),new Error(`Failed to verify artist: ${f.message}`);if(!u)throw new Error(`Artist with ID ${r} does not exist. Please use setArtistFollowByName to create the artist first.`);const{error:h}=yield T.from("artist_follows").insert({user_id:t,artist_id:r});if(h&&h.code!=="23505")throw h}else{const{error:u}=yield T.from("artist_follows").delete().eq("user_id",t).eq("artist_id",r);if(u)throw u}else if(c)throw c;console.log(` Artist follow ${n?"added":"removed"}:`,{userId:t,artistId:r})}catch(c){throw console.error("Error setting artist follow:",c),new Error(`Failed to ${n?"follow":"unfollow"} artist: ${c instanceof Error?c.message:"Unknown error"}`)}})}static setArtistFollowByName(t,r,n,a=!0){return E(this,null,function*(){try{let i=null;if(!r||r.trim()==="")throw new Error("Cannot follow artist without a name");const o=r.trim(),{data:l,error:c}=yield T.from("artists").select("id, name").ilike("name",o).limit(1).maybeSingle();if(c&&console.warn("Error searching for existing artist:",c),l){if(i=l.id,!l.name){const{error:d}=yield T.from("artists").update({name:o,updated_at:new Date().toISOString()}).eq("id",i);d?console.warn("Failed to update artist name:",d):console.log(` Updated artist name to: ${o}`)}}else{const{data:d,error:u}=yield T.from("artists").insert({name:o,identifier:n||`manual:${o.toLowerCase().replace(/\s+/g,"-")}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("id, name").single();if(u)throw console.error("Error creating artist:",u),u;if(!d||!d.name)throw new Error("Failed to create artist - artist was created without a name");i=d.id,console.log(` Created artist: ${d.name} (ID: ${i})`)}if(!i)throw new Error("Failed to find or create artist");yield this.setArtistFollow(t,i,a)}catch(i){throw console.error("Error setting artist follow by name:",i),new Error(`Failed to ${a?"follow":"unfollow"} artist: ${i instanceof Error?i.message:"Unknown error"}`)}})}static isFollowingArtist(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("artist_follows").select("id").eq("user_id",r).eq("artist_id",t).maybeSingle();return a&&a.code!=="PGRST116"?(console.error("Error checking if following artist:",a),!1):!!n}catch(n){return console.error("Error checking if following artist:",n),!1}})}static getFollowerCount(t){return E(this,null,function*(){try{const{count:r,error:n}=yield T.from("artist_follows").select("*",{count:"exact",head:!0}).eq("artist_id",t);return n?(console.error("Error getting follower count:",n),0):r||0}catch(r){return console.error("Error getting follower count:",r),0}})}static getArtistFollowStats(t,r){return E(this,null,function*(){try{const[n,a]=yield Promise.all([this.getFollowerCount(t),r?this.isFollowingArtist(t,r):Promise.resolve(!1)]);return{follower_count:n,is_following:a}}catch(n){return console.error("Error getting artist follow stats:",n),{follower_count:0,is_following:!1}}})}static getArtistFollowStatsByName(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("artists").select("id").ilike("name",t).limit(1).maybeSingle();return a?(console.warn("Error searching for artist in getArtistFollowStatsByName:",a),{follower_count:0,is_following:!1}):n?yield this.getArtistFollowStats(n.id,r):{follower_count:0,is_following:!1}}catch(n){return console.error("Error getting artist follow stats by name:",n),{follower_count:0,is_following:!1}}})}static getUserFollowedArtists(t){return E(this,null,function*(){try{console.log(" Getting followed artists for user:",t);const{data:r,error:n}=yield T.from("artist_follows").select("id, artist_id, user_id, created_at, updated_at").eq("user_id",t).order("created_at",{ascending:!1});if(console.log(" ArtistFollowService query result:",{followsLength:(r==null?void 0:r.length)||0,error:n,firstFollow:r==null?void 0:r[0]}),n)return console.error(" Error fetching artist follows:",n),console.error(" Error details:",JSON.stringify(n,null,2)),[];if(!r||r.length===0)return console.log(" No artist follows found for user:",t),[];console.log(` Found ${r.length} artist follows`);const a=r.map(f=>f.artist_id).filter(Boolean);if(console.log("Artist IDs to fetch:",a.length),a.length===0)return[];const{data:i,error:o}=yield T.from("artists").select("id, name, image_url, identifier").in("id",a);if(o)return console.error("Error fetching artist details:",o),[];const l=new Map((i||[]).map(f=>[f.id,f])),c=[],d=r.map(f=>{const h=l.get(f.artist_id);return h||c.push(f.artist_id),{id:f.id,user_id:t,artist_id:f.artist_id,created_at:f.created_at,artist_name:(h==null?void 0:h.name)||null,artist_image_url:(h==null?void 0:h.image_url)||null,jambase_artist_id:(h==null?void 0:h.identifier)||null,num_upcoming_events:null,genres:null,user_name:null,user_avatar_url:null}});if(c.length>0){console.warn(` Found ${c.length} followed artists not in artists table, attempting fallback lookup...`);for(const f of c){let h=null;try{const{data:p}=yield T.from("events").select("artist_name, artist_id").eq("artist_id",f).limit(1).maybeSingle();if(p!=null&&p.artist_name&&(h=p.artist_name),!h){const{data:g}=yield T.from("events_with_artist_venue").select("artist_name_normalized, artist_id").eq("artist_id",f).limit(1).maybeSingle();g!=null&&g.artist_name_normalized&&(h=g.artist_name_normalized)}if(!h){const{data:g}=yield T.from("artists_with_external_ids").select("name, id").eq("id",f).maybeSingle();g!=null&&g.name&&(h=g.name)}if(h){const g=d.findIndex(v=>v.artist_id===f);if(g>=0){d[g].artist_name=h,console.log(` Found artist name: ${h} for ID: ${f}`);try{yield T.from("artists").upsert({id:f,name:h,updated_at:new Date().toISOString()},{onConflict:"id"}),console.log(` Created/updated artist record for: ${h}`)}catch(v){console.warn(" Failed to upsert artist record:",v)}}}else console.error(` Could not find artist name for ID: ${f} - this follow should be removed`)}catch(p){console.warn(` Fallback lookup failed for artist ID ${f}:`,p)}}}const u=d.filter(f=>f.artist_name!==null&&f.artist_name!=="");if(u.length<d.length){const f=d.length-u.length;console.warn(` Filtered out ${f} follows with missing artist data - these should be cleaned up`)}return console.log(" Followed artists fetched:",u.length),u}catch(r){return console.error("Error getting followed artists:",r),[]}})}static getArtistFollowers(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("artist_follows").select("id, user_id, artist_id, created_at, updated_at").eq("artist_id",t).order("created_at",{ascending:!1});if(n)throw n;if(!r||r.length===0)return[];const a=r.map(c=>c.user_id),[i,o]=yield Promise.all([T.from("users").select("user_id, name, avatar_url").in("user_id",a),T.from("artists").select("id, name, image_url, identifier").eq("id",t).maybeSingle()]),l=new Map((i.data||[]).map(c=>[c.user_id,c]));return r.map(c=>{var d,u,f,h,p;return{id:c.id,user_id:c.user_id,artist_id:c.artist_id,created_at:c.created_at,artist_name:((d=o.data)==null?void 0:d.name)||null,artist_image_url:((u=o.data)==null?void 0:u.image_url)||null,jambase_artist_id:((f=o.data)==null?void 0:f.identifier)||null,num_upcoming_events:null,genres:null,user_name:((h=l.get(c.user_id))==null?void 0:h.name)||null,user_avatar_url:((p=l.get(c.user_id))==null?void 0:p.avatar_url)||null}})}catch(r){throw console.error("Error getting artist followers:",r),new Error(`Failed to get artist followers: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getArtistUuidByJambaseId(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("get_entity_uuid_by_external_id",{p_external_id:t,p_source:"jambase",p_entity_type:"artist"});if(!n&&r)return r;const{data:a,error:i}=yield T.from("artists_with_external_ids").select("id").eq("jambase_artist_id",t).maybeSingle();if(i&&i.code!=="PGRST116")console.warn("Artists table query failed:",i);else if(a)return a.id;return null}catch(r){return console.error("Error getting artist UUID:",r),null}})}static getArtistUuidByName(t){return E(this,null,function*(){try{let{data:r,error:n}=yield T.from("artists").select("id").ilike("name",t).limit(1).maybeSingle();if(n&&n.code!=="PGRST116")console.warn("Artists table query failed:",n);else if(r)return r.id;return null}catch(r){return console.error("Error getting artist UUID by name:",r),null}})}static subscribeToArtistFollows(t,r){return T.channel("artist-follows").on("postgres_changes",{event:"INSERT",schema:"public",table:"artist_follows",filter:`user_id=eq.${t}`},a=>{r({id:a.new.id,user_id:a.new.user_id,artist_id:a.new.artist_id},"INSERT")}).on("postgres_changes",{event:"DELETE",schema:"public",table:"artist_follows",filter:`user_id=eq.${t}`},a=>{r({id:a.old.id,user_id:a.old.user_id,artist_id:a.old.artist_id},"DELETE")}).subscribe()}}class hc{static getOrCreateVerifiedChat(t,r,n){return E(this,null,function*(){try{console.log(" Calling get_or_create_verified_chat RPC:",{p_entity_type:t,p_entity_id:r,p_entity_name:n});const{data:a,error:i}=yield T.rpc("get_or_create_verified_chat",{p_entity_type:t,p_entity_id:r,p_entity_name:n});if(i)throw console.error(" Error getting/creating verified chat:",i),i;return console.log(" get_or_create_verified_chat RPC returned:",a),a}catch(a){throw console.error(" Error in getOrCreateVerifiedChat:",a),a}})}static joinVerifiedChat(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("join_verified_chat",{p_chat_id:t,p_user_id:r});if(a)throw console.error("Error joining verified chat:",a),a;return n}catch(n){throw console.error("Error in joinVerifiedChat:",n),n}})}static getVerifiedChatInfo(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("get_verified_chat_info",{p_entity_type:t,p_entity_id:r});if(a)throw console.error("Error getting verified chat info:",a),a;if(!n||n.length===0)return null;const i=n[0];return{chat_id:i.chat_id,chat_name:i.chat_name,member_count:i.member_count||0,last_activity_at:i.last_activity_at,is_user_member:i.is_user_member||!1,current_user_id:i.current_user_id}}catch(n){throw console.error("Error in getVerifiedChatInfo:",n),n}})}static isUserMember(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("chat_participants").select("user_id").eq("chat_id",t).eq("user_id",r).maybeSingle();return a?(console.error("Error checking user membership:",a),!1):!!n}catch(n){return console.error("Error in isUserMember:",n),!1}})}static joinOrOpenVerifiedChat(t,r,n,a){return E(this,null,function*(){try{console.log(" VerifiedChatService.joinOrOpenVerifiedChat called:",{entityType:t,entityId:r,entityName:n,userId:a});const i=yield this.getVerifiedChatInfo(t,r);console.log(" Chat info retrieved:",i);let o;return i!=null&&i.chat_id?(o=i.chat_id,console.log(" Chat exists, chatId:",o),i.is_user_member?console.log(" User already a member"):(console.log(" User not a member, joining chat..."),yield this.joinVerifiedChat(o,a),console.log(" User joined chat successfully"))):(console.log(" Chat does not exist, creating new verified chat..."),o=yield this.getOrCreateVerifiedChat(t,r,n),console.log(" Verified chat created, chatId:",o),console.log(" Joining newly created chat..."),yield this.joinVerifiedChat(o,a),console.log(" User joined newly created chat successfully")),console.log(" joinOrOpenVerifiedChat completed successfully, returning chatId:",o),o}catch(i){throw console.error(" Error in joinOrOpenVerifiedChat:",i),i}})}}const Xde=Object.freeze(Object.defineProperty({__proto__:null,VerifiedChatService:hc},Symbol.toStringTag,{value:"Module"}));function Ky({artistId:e,artistName:t,jambaseArtistId:r,userId:n,variant:a="outline",size:i="sm",showFollowerCount:o=!1,className:l,onFollowChange:c}){const[d,u]=x.useState(!1),[f,h]=x.useState(0),[p,g]=x.useState(!1),[v,y]=x.useState(e||null),[_,w]=x.useState(null),{toast:b}=Rr();x.useEffect(()=>{E(this,null,function*(){if(e){y(e),w(e);return}if(r){const k=yield Si.getArtistUuidByJambaseId(r);if(k){y(k),w(k);return}}if(t){const k=yield Si.getArtistUuidByName(t);if(k){y(k),w(k);return}}w(null)})},[e,r,t]),x.useEffect(()=>{E(this,null,function*(){if(n)try{let k;if(_&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(_))k=yield Si.getArtistFollowStats(_,n);else if(t)k=yield Si.getArtistFollowStatsByName(t,n);else return;u(k.is_following),h(k.follower_count)}catch(k){if(console.error("Error loading follow status:",k),t)try{const P=yield Si.getArtistFollowStatsByName(t,n);u(P.is_following),h(P.follower_count)}catch(P){console.error("Error in fallback follow status lookup:",P)}}})},[_,t,n]),x.useEffect(()=>{if(!n)return;const S=Si.subscribeToArtistFollows(n,(k,P)=>{if(_?k.artist_id===_:!1){const R=P==="INSERT";u(R),h($=>R?$+1:Math.max(0,$-1))}});return()=>{S.unsubscribe()}},[n,_,t]);const N=S=>E(this,null,function*(){var k;if(S.preventDefault(),S.stopPropagation(),!n){b({title:"Error",description:"Please log in to follow artists.",variant:"destructive"});return}g(!0);try{const P=!d;if(_)try{yield Si.setArtistFollow(n,_,P)}catch(A){if((k=A.message)!=null&&k.includes("does not exist")&&t)console.warn("Resolved artist ID does not exist, falling back to setArtistFollowByName"),yield Si.setArtistFollowByName(n,t,r,P);else throw A}else if(t)yield Si.setArtistFollowByName(n,t,r,P);else throw new Error("No artist information available");if(u(P),h(A=>P?A+1:Math.max(0,A-1)),P)try{console.log(" ArtistFollowButton: User followed artist, joining verified chat...",{artistId:_,artistName:t,jambaseArtistId:r,userId:n});const A=_||r||t||"";A?(yield hc.joinOrOpenVerifiedChat("artist",A,t||"Artist",n),console.log(" ArtistFollowButton: Successfully joined artist verified chat")):console.warn(" ArtistFollowButton: Could not determine entityId for chat join")}catch(A){console.error(" ArtistFollowButton: Error joining artist verified chat (non-fatal):",A)}b({title:P?"Following!":"Unfollowed",description:P?`You'll receive notifications when ${t||"this artist"} has new events or updates`:`You won't receive notifications from ${t||"this artist"} anymore`}),c==null||c(P)}catch(P){console.error("Error toggling follow:",P),b({title:"Error",description:`Failed to ${d?"unfollow":"follow"} artist`,variant:"destructive"})}finally{g(!1)}});return n?s.jsxs(le,{variant:d?"secondary":a,size:i,className:ke("gap-2",l),onClick:N,disabled:p,"data-artist-name":t,"data-testid":"artist-follow-button",children:[p?s.jsx(lr,{className:"h-4 w-4 animate-spin"}):d?s.jsx(Og,{className:"h-4 w-4"}):s.jsx(Ad,{className:"h-4 w-4"}),s.jsxs("span",{children:[d?"Following":"Follow",o&&f>0&&` (${f})`]})]}):(console.warn(" ArtistFollowButton: No userId provided, not rendering"),null)}class Tu{static normalizeVenueName(t){return t.trim()}static setVenueFollowByName(t,r,n,a,i=!0){return E(this,null,function*(){try{const o=this.normalizeVenueName(r);let l=null;if(l=yield this.getVenueIdByName(o,n,a),!l)throw new Error(`Venue not found: ${o}. Cannot follow venue that doesn't exist in database.`);if(i){const{error:c}=yield T.from("user_venue_relationships").insert({user_id:t,venue_id:l});if(c&&c.code!=="23505")throw c}else{const{error:c}=yield T.from("user_venue_relationships").delete().eq("user_id",t).eq("venue_id",l);if(c)throw c}console.log(` Venue follow ${i?"added":"removed"}:`,{userId:t,venueName:o,venueCity:n,venueState:a})}catch(o){throw console.error("Error setting venue follow:",o),new Error(`Failed to ${i?"follow":"unfollow"} venue: ${o instanceof Error?o.message:"Unknown error"}`)}})}static getVenueIdByName(t,r,n){return E(this,null,function*(){try{const a=this.normalizeVenueName(t);let i=T.from("venues").select("id, state").ilike("name",`%${a}%`).limit(10);n&&(i=i.ilike("state",`%${n}%`));const{data:o,error:l}=yield i;if(l)return console.warn("Error querying venues by name:",l),null;if(!o||o.length===0)return null;if(r){const c=o.map(u=>u.id),{data:d}=yield T.from("events").select("venue_id").in("venue_id",c).ilike("venue_city",`%${r}%`).limit(100);if(d&&d.length>0){const u=new Map;d.forEach(p=>{p.venue_id&&u.set(p.venue_id,(u.get(p.venue_id)||0)+1)});let f=0,h=null;if(u.forEach((p,g)=>{p>f&&(f=p,h=g)}),h)return h}}return o[0].id}catch(a){return console.error("Error getting venue ID by name:",a),null}})}static isFollowingVenueByName(t,r,n,a){return E(this,null,function*(){try{const i=this.normalizeVenueName(t);let o=T.from("venues").select("id").ilike("name",i);n&&(o=o.ilike("state",n));let{data:l}=yield o;if(r&&l&&l.length>0){const u=l.map(h=>h.id),{data:f}=yield T.from("events").select("venue_id").in("venue_id",u).ilike("venue_city",`%${r}%`).limit(100);if(f&&f.length>0){const h=new Set(f.map(p=>p.venue_id));l=l.filter(p=>h.has(p.id))}}if(!l||l.length===0)return!1;const c=l.map(u=>u.id),{count:d}=yield T.from("user_venue_relationships").select("*",{count:"exact",head:!0}).eq("user_id",a).in("venue_id",c);return(d||0)>0}catch(i){return!1}})}static getFollowerCountByName(t,r,n){return E(this,null,function*(){try{const a=this.normalizeVenueName(t);let i=T.from("venues").select("id").ilike("name",a);n&&(i=i.ilike("state",n));let{data:o}=yield i;if(r&&o&&o.length>0){const c=o.map(u=>u.id),{data:d}=yield T.from("events").select("venue_id").in("venue_id",c).ilike("venue_city",`%${r}%`).limit(100);if(d&&d.length>0){const u=new Set(d.map(f=>f.venue_id));o=o.filter(f=>u.has(f.id))}}let l=0;if(o&&o.length>0){const c=o.map(u=>u.id),{count:d}=yield T.from("user_venue_relationships").select("*",{count:"exact",head:!0}).in("venue_id",c);l+=d||0}return l}catch(a){return 0}})}static getVenueFollowStatsByName(t,r,n,a){return E(this,null,function*(){try{const[i,o]=yield Promise.all([this.getFollowerCountByName(t,r,n),a?this.isFollowingVenueByName(t,r,n,a):Promise.resolve(!1)]);return{follower_count:i,is_following:o}}catch(i){return console.error("Error getting venue follow stats:",i),{follower_count:0,is_following:!1}}})}static getUserFollowedVenues(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_venue_relationships").select("id, user_id, venue_id, created_at").eq("user_id",t).order("created_at",{ascending:!1});if(n)throw n;if(!r||r.length===0)return[];const a=[...new Set(r.map(l=>l.venue_id).filter(Boolean))],i=new Map;if(a.length>0){const{data:l}=yield T.from("venues").select("id, name, image_url, street_address, state, country, zip").in("id",a);l&&l.forEach(c=>{i.set(c.id,c)})}const{data:o}=yield T.from("users").select("user_id, name, avatar_url").eq("user_id",t).maybeSingle();return r.map(l=>{const c=i.get(l.venue_id);return{id:l.id,user_id:l.user_id,venue_id:l.venue_id,venue_name:(c==null?void 0:c.name)||null,venue_city:null,venue_state:(c==null?void 0:c.state)||null,venue_address:(c==null?void 0:c.street_address)||null,venue_image_url:(c==null?void 0:c.image_url)||null,num_upcoming_events:null,created_at:l.created_at,user_name:(o==null?void 0:o.name)||null,user_avatar_url:(o==null?void 0:o.avatar_url)||null}})}catch(r){return console.error("Error getting followed venues:",r),[]}})}static getVenueFollowersByName(t,r,n){return E(this,null,function*(){try{const a=this.normalizeVenueName(t);let i=T.from("venues").select("id, name, state").ilike("name",a);n&&(i=i.ilike("state",n));let{data:o,error:l}=yield i;if(r&&o&&o.length>0){const g=o.map(y=>y.id),{data:v}=yield T.from("events").select("venue_id").in("venue_id",g).ilike("venue_city",`%${r}%`).limit(100);if(v&&v.length>0){const y=new Set(v.map(_=>_.venue_id));o=o.filter(_=>y.has(_.id))}}if(l)throw l;if(!o||o.length===0)return[];const c=o.map(g=>g.id),{data:d,error:u}=yield T.from("user_venue_relationships").select("id, user_id, venue_id, created_at").in("venue_id",c).order("created_at",{ascending:!1});if(u)throw u;if(!d||d.length===0)return[];const f=[...new Set(d.map(g=>g.user_id).filter(Boolean))],h=new Map;if(f.length>0){const{data:g}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",f);g&&g.forEach(v=>{h.set(v.user_id,v)})}const p=new Map;return o.forEach(g=>{p.set(g.id,g)}),d.map(g=>{const v=p.get(g.venue_id)||{},y=h.get(g.user_id)||{};return{id:g.id,user_id:g.user_id,venue_id:g.venue_id,venue_name:v.name||null,venue_city:v.city||null,venue_state:v.state||null,venue_image_url:v.image_url||null,num_upcoming_events:null,created_at:g.created_at,user_name:y.name||null,user_avatar_url:y.avatar_url||null}})}catch(a){throw console.error("Error getting venue followers:",a),new Error(`Failed to get venue followers: ${a instanceof Error?a.message:"Unknown error"}`)}})}static subscribeToVenueFollows(t,r){return T.channel(`venue-follows-${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"user_venue_relationships",filter:`user_id=eq.${t}`},a=>{(()=>{T.from("venues").select("name, address, city, state").eq("id",a.new.venue_id).maybeSingle().then(({data:o})=>{const l={id:a.new.id,user_id:a.new.user_id,venue_name:(o==null?void 0:o.name)||null,venue_city:(o==null?void 0:o.city)||null,venue_state:(o==null?void 0:o.state)||null,created_at:a.new.created_at,updated_at:a.new.updated_at||a.new.created_at};r(l,"INSERT")}).catch(o=>{console.error("Error fetching venue details in realtime callback:",o);const l={id:a.new.id,user_id:a.new.user_id,venue_name:null,venue_city:null,venue_state:null,created_at:a.new.created_at,updated_at:a.new.updated_at||a.new.created_at};r(l,"INSERT")})})()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"user_venue_relationships",filter:`user_id=eq.${t}`},a=>{const i={id:a.old.id,user_id:a.old.user_id,venue_name:null,venue_city:null,venue_state:null,created_at:a.old.created_at,updated_at:a.old.updated_at||a.old.created_at};r(i,"DELETE")}).subscribe()}}function g1({venueName:e,venueCity:t,venueState:r,userId:n,variant:a="outline",size:i="sm",showFollowerCount:o=!1,className:l,onFollowChange:c}){const[d,u]=x.useState(!1),[f,h]=x.useState(0),[p,g]=x.useState(!1),{toast:v}=Rr();x.useEffect(()=>{E(this,null,function*(){if(!(!n||!e))try{const w=yield Tu.getVenueFollowStatsByName(e,t,r,n);u(w.is_following),h(w.follower_count)}catch(w){console.error("Error loading venue follow status:",w)}})},[e,t,r,n]),x.useEffect(()=>{if(!n)return;const _=Tu.subscribeToVenueFollows(n,(w,b)=>{var S,k;if(w.venue_name.toLowerCase()===e.toLowerCase()&&(!t||((S=w.venue_city)==null?void 0:S.toLowerCase())===t.toLowerCase())&&(!r||((k=w.venue_state)==null?void 0:k.toLowerCase())===r.toLowerCase())){const P=b==="INSERT";u(P),h(A=>P?A+1:Math.max(0,A-1))}});return()=>{_.unsubscribe()}},[n,e,t,r]);const y=_=>E(this,null,function*(){if(_.preventDefault(),_.stopPropagation(),!n){v({title:"Error",description:"Please log in to follow venues.",variant:"destructive"});return}if(!e){v({title:"Error",description:"Venue name is required.",variant:"destructive"});return}g(!0);try{const w=!d;let b=null;if(w&&(b=yield Tu.getVenueIdByName(e,t,r)),yield Tu.setVenueFollowByName(n,e,t,r,w),u(w),h(S=>w?S+1:Math.max(0,S-1)),w&&b)try{console.log(" VenueFollowButton: User followed venue, joining verified chat...",{venueId:b,venueName:e,venueCity:t,venueState:r,userId:n}),yield hc.joinOrOpenVerifiedChat("venue",b,e,n),console.log(" VenueFollowButton: Successfully joined venue verified chat")}catch(S){console.error(" VenueFollowButton: Error joining venue verified chat (non-fatal):",S)}else if(w&&!b)try{console.log(" VenueFollowButton: No venueId found, using venue name as entity_id"),yield hc.joinOrOpenVerifiedChat("venue",e,e,n),console.log(" VenueFollowButton: Successfully joined venue verified chat (using name)")}catch(S){console.error(" VenueFollowButton: Error joining venue verified chat with name (non-fatal):",S)}const N=t&&r?` in ${t}, ${r}`:t?` in ${t}`:"";v({title:w?"Following!":"Unfollowed",description:w?`You'll receive notifications when ${e}${N} has new events`:`You won't receive notifications from ${e}${N} anymore`}),c==null||c(w)}catch(w){console.error("Error toggling venue follow:",w),v({title:"Error",description:`Failed to ${d?"unfollow":"follow"} venue`,variant:"destructive"})}finally{g(!1)}});return n?e?s.jsxs(le,{variant:d?"secondary":a,size:i,className:ke("gap-2",l),onClick:y,disabled:p,"data-venue-name":e,"data-testid":"venue-follow-button",children:[p?s.jsx(lr,{className:"h-4 w-4 animate-spin"}):d?s.jsx(EQ,{className:"h-4 w-4"}):s.jsx(gr,{className:"h-4 w-4"}),s.jsxs("span",{children:[d?"Following":"Follow",o&&f>0&&` (${f})`]})]}):(console.warn(" VenueFollowButton: No venueName provided, not rendering"),null):(console.warn(" VenueFollowButton: No userId provided, not rendering"),null)}const Ef={spam:{label:"Spam",description:"Unwanted or repetitive content",icon:""},inappropriate_content:{label:"Inappropriate Content",description:"Offensive, explicit, or disturbing content",icon:""},harassment:{label:"Harassment or Bullying",description:"Targeting someone with hateful or threatening content",icon:""},misinformation:{label:"False Information",description:"Spreading false or misleading information",icon:""},copyright_violation:{label:"Copyright Violation",description:"Unauthorized use of copyrighted material",icon:""},fake_event:{label:"Fake or Fraudulent Event",description:"Event that doesn't exist or is misleading",icon:""},duplicate:{label:"Duplicate Content",description:"Same content posted multiple times",icon:""},other:{label:"Other",description:"Something else that violates guidelines",icon:""}};class Ku{static reportContent(t){return E(this,null,function*(){var r;try{const{data:{user:n},error:a}=yield T.auth.getUser();if(a||!n)throw new Error("User must be authenticated to report content");const o={spam:"spam",inappropriate_content:"inappropriate_content",harassment:"harassment",misinformation:"misinformation",copyright_violation:"copyright_violation",fake_event:"fake_content",duplicate:"spam",other:"other"}[t.flag_reason]||"other";let l=t.content_type;if(l==="comment"||l==="profile"||l==="message")if(l==="comment")l="review";else if(l==="profile")l="artist";else throw new Error(`Content type ${l} is not supported for moderation flags`);const{data:c,error:d}=yield T.from("users").select("user_id").eq("user_id",n.id).maybeSingle(),u=(c==null?void 0:c.user_id)||n.id,{data:f,error:h}=yield T.from("moderation_flags").insert({flagged_by_user_id:u,content_type:l,content_id:t.content_id,flag_reason:t.flag_reason,flag_category:o,additional_details:((r=t.flag_details)==null?void 0:r.trim())||null,status:"pending"}).select("id").single();if(h)throw h.code==="23505"?new Error("You have already reported this content"):h;return f.id}catch(n){throw console.error("Error reporting content:",n),n instanceof Error?n:new Error("Failed to report content")}})}static blockUser(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("block_user",{p_blocked_user_id:t.blocked_user_id,p_block_reason:t.block_reason||null});if(n)throw n;return r}catch(r){throw console.error("Error blocking user:",r),r}})}static unblockUser(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("unblock_user",{p_blocked_user_id:t});if(r)throw r}catch(r){throw console.error("Error unblocking user:",r),r}})}static isUserBlocked(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("is_user_blocked",{p_user_id:t,p_by_user_id:r||null});if(a)throw a;return n||!1}catch(n){return console.error("Error checking block status:",n),!1}})}static getBlockedUsers(){return E(this,null,function*(){try{const{data:t,error:r}=yield T.rpc("get_blocked_users");if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching blocked users:",t),t}})}static getUserReports(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const a=t||r.id,{data:i,error:o}=yield T.from("moderation_flags").select("*").eq("flagged_by_user_id",a).order("created_at",{ascending:!1});if(o)throw o;return i||[]}catch(r){throw console.error("Error fetching user reports:",r),r}})}static moderateContent(t,r,n,a=!0){return E(this,null,function*(){try{const{error:i}=yield T.rpc("moderate_content",{p_flag_id:t,p_action:r,p_review_notes:n||null,p_notify_user:a});if(i)throw i}catch(i){throw console.error("Error moderating content:",i),i}})}static getFlaggedContentDetails(t,r){return E(this,null,function*(){try{let n;switch(t){case"event":n=T.from("events").select("*").eq("id",r).single();break;case"review":n=T.from("reviews").select(`
              *,
              user:users!reviews_user_id_fkey(name, avatar_url)
            `).eq("id",r).single();break;case"comment":n=T.from("comments").select(`
              *,
              user:users!comments_user_id_fkey(name, avatar_url)
            `).eq("id",r).single();break;case"profile":n=T.from("users").select("*").eq("user_id",r).single();break;default:throw new Error("Unsupported content type")}const{data:a,error:i}=yield n;if(i)throw i;return a}catch(n){throw console.error("Error fetching content details:",n),n}})}static getFlagReasons(){return Ef}static getUserModerationStatus(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("users").select("moderation_status, warning_count, last_warned_at, suspended_until, ban_reason").eq("user_id",t).single();if(n)throw n;return r}catch(r){throw console.error("Error fetching moderation status:",r),r}})}static canReportContent(t,r){return E(this,null,function*(){try{const{data:{user:n}}=yield T.auth.getUser();if(!n)return!1;const{data:a,error:i}=yield T.from("moderation_flags").select("id").eq("flagged_by_user_id",n.id).eq("content_type",t).eq("content_id",r).single();return i&&i.code==="PGRST116"?!0:!a}catch(n){return console.error("Error checking report eligibility:",n),!1}})}static getContentTypeDisplayName(t){return{event:"Event",review:"Review",comment:"Comment",profile:"Profile",message:"Message"}[t]||t}}function v1({open:e,onClose:t,contentType:r,contentId:n,contentTitle:a,onReportSubmitted:i}){const{toast:o}=Rr(),[l,c]=x.useState(!1),[d,u]=x.useState(""),[f,h]=x.useState(""),p=v=>E(this,null,function*(){if(v.preventDefault(),!d){o({title:"Please select a reason",description:"Select why you're reporting this content",variant:"destructive"});return}c(!0);try{yield Ku.reportContent({content_type:r,content_id:n,flag_reason:d,flag_details:f.trim()||void 0}),o({title:"Report Submitted",description:"Thank you for helping keep our community safe. We'll review this report shortly."}),i==null||i(),g()}catch(y){console.error("Error submitting report:",y),o({title:"Error",description:y instanceof Error?y.message:"Failed to submit report",variant:"destructive"})}finally{c(!1)}}),g=()=>{l||(u(""),h(""),t())};return s.jsx(pn,{open:e,onOpenChange:g,children:s.jsxs(dn,{className:"sm:max-w-[550px] max-h-[90vh] flex flex-col",children:[s.jsxs(Vn,{className:"flex-shrink-0",children:[s.jsxs(bn,{className:"flex items-center gap-2",children:[s.jsx(Qi,{className:"h-5 w-5 text-red-600"}),"Report ",Ku.getContentTypeDisplayName(r)]}),s.jsx(os,{children:"Help us understand what's wrong with this content. Your report is anonymous."})]}),a&&s.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200 flex-shrink-0",children:s.jsx("p",{className:"text-sm text-gray-700 font-medium truncate",children:a})}),s.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs(Ht,{children:["Why are you reporting this? ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("div",{className:"space-y-2",children:Object.entries(Ef).map(([v,y])=>s.jsxs("label",{className:`flex items-start p-3 border rounded-lg cursor-pointer transition-colors ${d===v?"border-red-500 bg-red-50":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"reason",value:v,checked:d===v,onChange:_=>u(_.target.value),disabled:l,className:"mt-0.5 mr-3"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-lg",children:y.icon}),s.jsx("span",{className:"font-medium text-sm",children:y.label})]}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:y.description})]})]},v))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"details",children:"Additional Details (Optional)"}),s.jsx(ys,{id:"details",placeholder:"Provide any additional context that might help us review this report...",value:f,onChange:v=>h(v.target.value),disabled:l,rows:4}),s.jsx("p",{className:"text-xs text-gray-500",children:"Do not include personal information in your report."})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex gap-3",children:[s.jsx(Sv,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-900",children:[s.jsx("p",{className:"font-medium mb-1",children:"What happens next?"}),s.jsxs("ul",{className:"text-xs space-y-1 list-disc list-inside",children:[s.jsx("li",{children:"Your report will be reviewed by our moderation team"}),s.jsx("li",{children:"We may remove content that violates our guidelines"}),s.jsx("li",{children:"You'll receive a notification about the outcome"}),s.jsx("li",{children:"Reports are confidential and anonymous"})]})]})]})]})}),s.jsxs(Nh,{className:"flex-shrink-0 border-t pt-4",children:[s.jsx(le,{type:"button",variant:"outline",onClick:g,disabled:l,children:"Cancel"}),s.jsx(le,{type:"submit",variant:"destructive",disabled:l||!d,onClick:p,children:l?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-4 h-4 mr-2 animate-spin"}),"Submitting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Qi,{className:"w-4 h-4 mr-2"}),"Submit Report"]})})]})]})})}var y1="Collapsible",[Jde,dB]=Os(y1),[Qde,pT]=Jde(y1),uB=x.forwardRef((e,t)=>{const u=e,{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:i,onOpenChange:o}=u,l=me(u,["__scopeCollapsible","open","defaultOpen","disabled","onOpenChange"]),[c,d]=Wa({prop:n,defaultProp:a!=null?a:!1,onChange:o,caller:y1});return s.jsx(Qde,{scope:r,disabled:i,contentId:Ps(),open:c,onOpenToggle:x.useCallback(()=>d(f=>!f),[d]),children:s.jsx(Ct.div,H(M({"data-state":xT(c),"data-disabled":i?"":void 0},l),{ref:t}))})});uB.displayName=y1;var hB="CollapsibleTrigger",gT=x.forwardRef((e,t)=>{const i=e,{__scopeCollapsible:r}=i,n=me(i,["__scopeCollapsible"]),a=pT(hB,r);return s.jsx(Ct.button,H(M({type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":xT(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled},n),{ref:t,onClick:pt(e.onClick,a.onOpenToggle)}))});gT.displayName=hB;var vT="CollapsibleContent",yT=x.forwardRef((e,t)=>{const i=e,{forceMount:r}=i,n=me(i,["forceMount"]),a=pT(vT,e.__scopeCollapsible);return s.jsx(Ys,{present:r||a.open,children:({present:o})=>s.jsx(eue,H(M({},n),{ref:t,present:o}))})});yT.displayName=vT;var eue=x.forwardRef((e,t)=>{const w=e,{__scopeCollapsible:r,present:n,children:a}=w,i=me(w,["__scopeCollapsible","present","children"]),o=pT(vT,r),[l,c]=x.useState(n),d=x.useRef(null),u=cr(t,d),f=x.useRef(0),h=f.current,p=x.useRef(0),g=p.current,v=o.open||l,y=x.useRef(v),_=x.useRef(void 0);return x.useEffect(()=>{const b=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(b)},[]),vs(()=>{const b=d.current;if(b){_.current=_.current||{transitionDuration:b.style.transitionDuration,animationName:b.style.animationName},b.style.transitionDuration="0s",b.style.animationName="none";const N=b.getBoundingClientRect();f.current=N.height,p.current=N.width,y.current||(b.style.transitionDuration=_.current.transitionDuration,b.style.animationName=_.current.animationName),c(n)}},[o.open,n]),s.jsx(Ct.div,H(M({"data-state":xT(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!v},i),{ref:u,style:M({"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":g?`${g}px`:void 0},e.style),children:v&&a}))});function xT(e){return e?"open":"closed"}var fB=uB,tue=gT,rue=yT;const nue=fB,sue=gT,aue=yT;function sw({review:e,currentUserId:t,onLike:r,onComment:n,onShare:a,onEdit:i,onDelete:o,showEventInfo:l=!1,onReport:c,userProfile:d,followedArtists:u=[],followedVenues:f=[]}){var Et,gt,St,dr,Sr,wt,lt,Qe,jt,ir,rr,Ie,At,yt,pe,De,Le,bt,it,zt,Bt;const[h,p]=x.useState(null);x.useEffect(()=>{const Te=e.artist_performance_rating!=null||e.production_rating!=null||e.venue_rating!=null||e.location_rating!=null||e.value_rating!=null,mr=!!e.venue_feedback&&e.venue_rating==null;!Te||mr?(console.log(" BelliStyleReviewCard - Missing category ratings, fetching full review data for:",e.id),T.from("reviews").select("rating, artist_performance_rating, production_rating, venue_rating, location_rating, value_rating, artist_performance_feedback, production_feedback, venue_feedback, location_feedback, value_feedback").eq("id",e.id).single().then(({data:Mn,error:fe})=>{!fe&&Mn?(console.log(" BelliStyleReviewCard - Fetched review data:",Mn),p(Mn)):fe&&console.error(" BelliStyleReviewCard - Error fetching review data:",fe)})):console.log(" BelliStyleReviewCard - Full review object:",{id:e.id,venue_rating:e.venue_rating,artist_performance_rating:e.artist_performance_rating,production_rating:e.production_rating,location_rating:e.location_rating,value_rating:e.value_rating,rating:e.rating,allKeys:Object.keys(e)})},[e.id]);const[g,v]=x.useState(e.is_liked_by_user||!1),[y,_]=x.useState(e.likes_count),[w,b]=x.useState(!1),[N,S]=x.useState(!1),[k,P]=x.useState([]),[A,R]=x.useState(e.comments_count||0),[$,O]=x.useState(!1),[z,D]=x.useState(""),[B,F]=x.useState(!1);x.useState(!1);const U=Array.isArray(e==null?void 0:e.photos)?e.photos:[],[G,q]=x.useState(!1),[K,Z]=x.useState(0),[Y,Q]=x.useState(!1),[X,ne]=x.useState(!1),[re,ye]=x.useState(!1),{toast:ee}=Rr(),[de,xe]=x.useState(null),[ie,se]=x.useState("loading"),[V,ue]=x.useState(!1),_e=()=>E(this,null,function*(){if(!(!t||w)){b(!0);try{g?(yield bs.unlikeReview(t,e.id),_(Te=>Math.max(0,Te-1)),v(!1)):(yield bs.likeReview(t,e.id),_(Te=>Te+1),v(!0)),r&&r(e.id,!g)}catch(Te){console.error("Error toggling like:",Te),g?(_(dt=>dt+1),v(!0)):(_(dt=>Math.max(0,dt-1)),v(!1))}finally{b(!1)}}}),ae=()=>E(this,null,function*(){const Te=!N;if(S(Te),Te&&k.length===0)try{O(!0);const dt=yield bs.getReviewComments(e.id);P(dt),R(dt.length)}catch(dt){console.error("Error loading comments:",dt)}finally{O(!1)}}),we=()=>E(this,null,function*(){if(!(!t||!z.trim()||B))try{F(!0);const Te=yield bs.addComment(t,e.id,z.trim());P(dt=>[...dt,H(M({},Te),{user:{id:Te.user_id,name:(d==null?void 0:d.name)||"You",avatar_url:d==null?void 0:d.avatar_url}})]),D(""),R(dt=>dt+1)}finally{F(!1)}}),oe=()=>{a&&a(e.id),ye(!0)},ce=Te=>{Te.preventDefault(),Te.stopPropagation(),console.log("BelliStyleReviewCard: Edit button clicked",{reviewId:e.id}),i?i(e):console.warn("onEdit handler not provided to BelliStyleReviewCard")},Ae=()=>E(this,null,function*(){o&&window.confirm("Are you sure you want to delete this review?")&&o(e.id)}),Be=t&&e.user_id===t;h&&M(M({},e),h);const Xe=(Et=h==null?void 0:h.artist_performance_rating)!=null?Et:e.artist_performance_rating,ge=(gt=h==null?void 0:h.production_rating)!=null?gt:e.production_rating,We=(St=h==null?void 0:h.venue_rating)!=null?St:e.venue_rating,Ue=(dr=h==null?void 0:h.location_rating)!=null?dr:e.location_rating,at=(Sr=h==null?void 0:h.value_rating)!=null?Sr:e.value_rating,mt=[Xe,ge,We,Ue,at].filter(Te=>typeof Te=="number"&&!isNaN(Te)&&Te>0),Ye=mt.length>0?Number((mt.reduce((Te,dt)=>Te+dt,0)/mt.length).toFixed(1)):null,Ft=typeof e.rating=="string"?parseFloat(e.rating):typeof e.rating=="number"?e.rating:null,_t=h!=null&&h.rating?typeof h.rating=="string"?parseFloat(h.rating):h.rating:null,Lt=_t!=null&&!Number.isNaN(_t)&&_t>=0?_t:Ft!=null&&!Number.isNaN(Ft)&&Ft>=0?Ft:Ye!=null&&Ye>=0?Ye:null;x.useEffect(()=>{console.log(" Overall Rating Debug:",{reviewRating:e.rating,reviewRatingType:typeof e.rating,reviewRatingValue:Ft,computedAverage:Ye,categoryAverages:mt,overallRating:Lt,fetchedReviewData:!!h,willDisplay:Lt>0})},[e.rating,Ft,Ye,Lt,h]);const Oe=Te=>Te>=4.5?"ring-green-500":Te>=3.5?"ring-yellow-500":Te>=2.5?"ring-orange-500":"ring-red-500",qe=Te=>Te>=4.5?"from-green-400 to-green-600":Te>=3.5?"from-yellow-400 to-yellow-600":Te>=2.5?"from-orange-400 to-orange-600":"from-red-400 to-red-600",Ne=(Te,dt="sm")=>{const mr=dt==="sm"?"w-3 h-3":"w-4 h-4";return Array.from({length:5},(Mn,fe)=>{const Re=fe+1,ot=Te>=Re,vt=!ot&&Te>=Re-.5;return s.jsxs("div",{className:ke("relative",mr),children:[s.jsx(Qt,{className:ke(mr,"text-gray-300")}),(vt||ot)&&s.jsx("div",{className:ke("absolute left-0 top-0 h-full overflow-hidden pointer-events-none",ot?"w-full":"w-1/2"),children:s.jsx(Qt,{className:ke(mr,"text-yellow-400 fill-current")})})]},fe)})};x.useEffect(()=>{const Te=mr=>{mr.stopPropagation(),ae()},dt=document.getElementById(`belli-review-card-${e.id}`);return dt==null||dt.addEventListener("toggle-review-comments",Te),()=>dt==null?void 0:dt.removeEventListener("toggle-review-comments",Te)},[e.id,N,k.length]),x.useEffect(()=>{E(this,null,function*(){if(!t||!e.user_id||t===e.user_id){xe(null),se("none");return}try{const{data:dt,error:mr}=yield T.rpc("get_connection_info",{current_user_id:t,target_user_id:e.user_id});mr?(console.warn("Error fetching connection info:",mr),xe(null)):dt&&dt.length>0&&dt[0].degree<=3?xe({degree:dt[0].degree,label:dt[0].label,color:dt[0].color}):xe(null);const{data:Mn,error:fe}=yield T.from("user_relationships").select("id, user_id, related_user_id, status").eq("relationship_type","friend").eq("status","accepted").or(`and(user_id.eq.${t},related_user_id.eq.${e.user_id}),and(user_id.eq.${e.user_id},related_user_id.eq.${t})`).maybeSingle();if(fe&&fe.code!=="PGRST116"&&console.warn("Error checking friend status:",fe),Mn)se("friends");else{const{data:Re,error:ot}=yield T.from("user_relationships").select("id, user_id, related_user_id, status").eq("relationship_type","friend").eq("status","pending").or(`and(user_id.eq.${t},related_user_id.eq.${e.user_id}),and(user_id.eq.${e.user_id},related_user_id.eq.${t})`).maybeSingle();ot&&ot.code!=="PGRST116"&&console.warn("Error checking friend request:",ot),Re?Re.user_id===t?se("pending_sent"):se("pending_received"):se("none")}}catch(dt){console.error("Error fetching connection/friend info:",dt),xe(null),se("none")}})},[t,e.user_id]),x.useEffect(()=>{E(this,null,function*(){if(t)try{const dt=yield bs.getReviewEngagement(e.id,t);dt&&(_(dt.likes_count),R(dt.comments_count),v(dt.is_liked_by_user))}catch(dt){console.error("Error refreshing engagement data:",dt)}})},[e.id,t]);const Fe=Te=>{Z(Te),q(!0)},ve=()=>q(!1),Me=()=>E(this,null,function*(){if(!(!t||!e.user_id||V))try{ue(!0);const{data:Te,error:dt}=yield T.rpc("create_friend_request",{receiver_user_id:e.user_id});if(dt)throw dt;se("pending_sent"),ee({title:"Friend Request Sent! ",description:"Your friend request has been sent."})}catch(Te){console.error("Error sending friend request:",Te),ee({title:"Error",description:Te.message||"Failed to send friend request. Please try again.",variant:"destructive"})}finally{ue(!1)}}),ze=Te=>{Te&&Te.stopPropagation(),U.length&&Z(dt=>(dt-1+U.length)%U.length)},ct=Te=>{Te&&Te.stopPropagation(),U.length&&Z(dt=>(dt+1)%U.length)};return s.jsxs(He,{className:"w-full border-2 shadow-lg hover:shadow-xl transition-all duration-300 bg-gray-50 rounded-xl overflow-hidden",id:`belli-review-card-${e.id}`,children:[s.jsxs(Er,{className:"pb-4 bg-gradient-to-br from-gray-50 via-white to-gray-50 border-b-2 relative",children:[Lt!=null&&Lt>=0&&s.jsxs("div",{className:ke("absolute top-4 right-4 w-16 h-16 rounded-full flex flex-col items-center justify-center","bg-gradient-to-br shadow-lg",qe(Math.max(.5,Lt)),"text-white font-bold z-10"),children:[s.jsx("span",{className:"text-2xl leading-none",children:Lt.toFixed(1)}),s.jsx("div",{className:"flex items-center gap-0.5 mt-1",children:Array.from({length:5},(Te,dt)=>s.jsx(Qt,{className:ke("w-2 h-2",dt<Math.round(Lt)?"fill-white text-white":"text-white/40")},dt))})]}),s.jsxs("div",{className:"flex items-start gap-4 pr-20",children:[s.jsxs(Vr,{className:ke("w-14 h-14 ring-4",Oe(Lt)),children:[s.jsx(sn,{src:(d==null?void 0:d.avatar_url)||void 0,alt:(d==null?void 0:d.name)||"User"}),s.jsx(Wr,{className:"text-lg font-semibold bg-gradient-to-br from-[#FF3399] to-[#FF66B3] text-white",children:((wt=d==null?void 0:d.name)==null?void 0:wt.charAt(0).toUpperCase())||((lt=e.user_id)==null?void 0:lt.slice(0,1).toUpperCase())||"U"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1 flex-wrap gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:(d==null?void 0:d.name)||"User"}),(d==null?void 0:d.verified)&&(d==null?void 0:d.account_type)&&s.jsx(mT,{accountType:d.account_type,verified:d.verified,size:"md"}),t&&e.user_id!==t&&de&&de.degree<=3&&s.jsx(Ke,{className:ke("text-xs font-semibold px-2 py-0.5 border-2 border-black",de.color==="dark-green"?"bg-green-700 text-white hover:bg-green-800":de.color==="light-green"?"bg-green-400 text-green-900 hover:bg-green-500":de.color==="yellow"?"bg-yellow-400 text-yellow-900 hover:bg-yellow-500":de.color==="red"?"bg-red-500 text-white hover:bg-red-600":de.color==="blue"?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-500 text-white hover:bg-gray-600"),children:de.label})]}),t&&e.user_id!==t&&ie!=="friends"&&ie!=="pending_sent"&&ie!=="loading"&&s.jsxs(le,{size:"sm",variant:"outline",onClick:Te=>{Te.preventDefault(),Te.stopPropagation(),Me()},disabled:V,className:"h-7 text-xs px-2 gap-1",children:[s.jsx(Ad,{className:"w-3 h-3"}),V?"Sending...":ie==="pending_received"?"Pending":"Add Friend"]})]}),s.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:["Reviewed ",s.jsx("span",{className:"text-[#FF3399] font-semibold",children:e.artist_name||((Qe=e.event)==null?void 0:Qe.artist_name)||"Artist"}),(e.venue_name||((jt=e.event)==null?void 0:jt.venue_name))&&s.jsxs(s.Fragment,{children:[" ","at ",s.jsx("span",{className:"text-gray-800",children:e.venue_name||((ir=e.event)==null?void 0:ir.venue_name)})]})]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center gap-2",children:[s.jsx("span",{children:tw(new Date(e.created_at),{addSuffix:!0})}),e.venue_city&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(gr,{className:"w-3 h-3"}),e.venue_city,", ",e.venue_state]})]})]})]}),Be&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(le,{variant:"ghost",size:"sm",onClick:Te=>ce(Te),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"Edit review",children:s.jsx(_c,{className:"h-4 w-4"})}),s.jsx(le,{variant:"ghost",size:"sm",onClick:Ae,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:s.jsx(Dl,{className:"h-4 w-4"})})]})]})]}),s.jsxs(et,{className:"pt-5 px-5 pb-2",children:[e.review_text&&e.review_text!=="ATTENDANCE_ONLY"&&s.jsx("div",{className:"mb-4",children:s.jsx("p",{className:"text-base leading-relaxed text-gray-800",children:e.review_text})}),U.length>0&&s.jsx("div",{className:"mb-4",children:U.length===1?s.jsx("div",{className:"rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm",children:s.jsx("img",{src:U[0],alt:"Review photo",className:"w-full h-80 object-cover cursor-zoom-in hover:opacity-95 transition-opacity",loading:"lazy",onClick:Te=>{Te.stopPropagation(),Fe(0)}})}):s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx("div",{className:"col-span-2 row-span-2 rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm",children:s.jsx("img",{src:U[0],alt:"Review photo 1",className:"w-full h-full object-cover cursor-zoom-in hover:opacity-95 transition-opacity",loading:"lazy",onClick:Te=>{Te.stopPropagation(),Fe(0)}})}),U.slice(1,5).map((Te,dt)=>s.jsx("div",{className:"rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm aspect-square",children:s.jsx("img",{src:Te,alt:`Review photo ${dt+2}`,className:"w-full h-full object-cover cursor-zoom-in hover:opacity-95 transition-opacity",loading:"lazy",onClick:mr=>{mr.stopPropagation(),Fe(dt+1)}})},dt)),U.length>5&&s.jsxs("button",{onClick:Te=>{Te.stopPropagation(),Fe(5)},className:"rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm aspect-square bg-black/60 flex items-center justify-center text-white font-bold text-lg hover:bg-black/70 transition-colors",children:["+",U.length-5]})]})}),s.jsxs(nue,{open:X,onOpenChange:ne,children:[s.jsx(sue,{asChild:!0,children:s.jsxs(le,{variant:"outline",className:"w-full mb-3 flex items-center justify-between hover:bg-gray-50",onClick:Te=>{Te.stopPropagation(),ne(!X)},children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(Ol,{className:"w-4 h-4"}),"View Rating Details"]}),X?s.jsx(Mo,{className:"w-4 h-4"}):s.jsx(Ta,{className:"w-4 h-4"})]})}),s.jsx(aue,{className:"space-y-3 mb-4",children:[{label:"Artist Performance",rating:(rr=h==null?void 0:h.artist_performance_rating)!=null?rr:e.artist_performance_rating,feedback:(Ie=h==null?void 0:h.artist_performance_feedback)!=null?Ie:e.artist_performance_feedback,icon:RQ,border:"border-[#FF3399]",gradient:"from-[#FF3399]/5 to-[#FF3399]/10",iconColor:"text-[#FF3399]"},{label:"Production Quality",rating:(At=h==null?void 0:h.production_rating)!=null?At:e.production_rating,feedback:(yt=h==null?void 0:h.production_feedback)!=null?yt:e.production_feedback,icon:SQ,border:"border-purple-500",gradient:"from-purple-50 to-purple-50/30",iconColor:"text-purple-600"},{label:"Venue Experience",rating:(De=(pe=h==null?void 0:h.venue_rating)!=null?pe:e.venue_rating)!=null?De:void 0,feedback:(Le=h==null?void 0:h.venue_feedback)!=null?Le:e.venue_feedback,recommendation:e.venue_recommendation,icon:Yi,border:"border-blue-500",gradient:"from-blue-50 to-blue-50/30",iconColor:"text-blue-600"},{label:"Location & Logistics",rating:(bt=h==null?void 0:h.location_rating)!=null?bt:e.location_rating,feedback:(it=h==null?void 0:h.location_feedback)!=null?it:e.location_feedback,recommendation:e.location_recommendation,icon:gP,border:"border-emerald-500",gradient:"from-emerald-50 to-emerald-50/30",iconColor:"text-emerald-600"},{label:"Value for Ticket",rating:(zt=h==null?void 0:h.value_rating)!=null?zt:e.value_rating,feedback:(Bt=h==null?void 0:h.value_feedback)!=null?Bt:e.value_feedback,recommendation:e.value_recommendation,icon:Ro,border:"border-amber-500",gradient:"from-amber-50 to-amber-50/30",iconColor:"text-amber-600"}].map(Te=>{const dt=typeof Te.rating=="string"?parseFloat(Te.rating):Te.rating,mr=typeof dt=="number"&&!isNaN(dt)&&dt>0?dt:void 0;if(Te.label==="Venue Experience"&&console.log(" Venue Experience Debug:",{label:Te.label,rawRating:Te.rating,ratingValue:dt,resolvedRating:mr,reviewVenueRating:e.venue_rating,fetchedVenueRating:h==null?void 0:h.venue_rating,hasFeedback:!!Te.feedback}),!mr&&!Te.feedback)return null;const Mn=Te.icon;return s.jsxs("div",{className:ke("border-l-4 rounded-r-lg p-4 shadow-sm bg-gradient-to-r",Te.border,Te.gradient),children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Mn,{className:ke("w-5 h-5",Te.iconColor)}),s.jsx("span",{className:"text-sm font-bold text-gray-900",children:Te.label})]}),mr&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex items-center gap-0.5",children:Ne(mr,"md")}),s.jsx("span",{className:"text-lg font-bold text-gray-900",children:mr.toFixed(1)})]})]}),Te.feedback&&s.jsxs("p",{className:"text-sm text-gray-700 italic leading-relaxed",children:['"',Te.feedback,'"']})]},Te.label)})})]}),e.setlist&&s.jsx("div",{className:"mb-4",children:s.jsx(A5,{setlist:e.setlist,compact:!0,type:"api"})}),e.custom_setlist&&e.custom_setlist.length>0&&s.jsx("div",{className:"mb-4",children:s.jsx(A5,{customSetlist:e.custom_setlist,compact:!0,type:"custom"})}),s.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg border-2 border-gray-200",children:s.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[e.artist_name&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:ke("px-3 py-1.5 rounded-full font-medium text-sm transition-all shadow-sm flex items-center gap-1.5",u.includes(e.artist_name)?"bg-[#FF3399] text-white border-2 border-[#FF3399]":"bg-white border-2 border-[#FF3399]/30 hover:border-[#FF3399] hover:bg-[#FF3399]/5"),onClick:Te=>{Te.preventDefault(),Te.stopPropagation();const dt=e.artist_id||e.artist_uuid,mr=new CustomEvent("open-artist-card",{detail:{artistId:dt,artistName:e.artist_name}});document.dispatchEvent(mr)},"aria-label":`View artist ${e.artist_name}`,children:[u.includes(e.artist_name)&&s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})," ",e.artist_name]}),t&&s.jsx(Ky,{artistName:e.artist_name,userId:t,variant:"outline",size:"sm",showFollowerCount:!1,className:"h-8 text-xs border-2"})]}),e.venue_name&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:ke("px-3 py-1.5 rounded-full font-medium text-sm transition-all shadow-sm flex items-center gap-1.5",f.some(Te=>Te.name===e.venue_name&&(!Te.city||Te.city===e.venue_city)&&(!Te.state||Te.state===e.venue_state))?"bg-blue-600 text-white border-2 border-blue-600":"bg-white border-2 border-blue-200 hover:border-blue-400 hover:bg-blue-50"),onClick:Te=>{Te.preventDefault(),Te.stopPropagation();const dt=e.venue_id||e.venue_uuid,mr=new CustomEvent("open-venue-card",{detail:{venueId:dt,venueName:e.venue_name}});document.dispatchEvent(mr)},"aria-label":`View venue ${e.venue_name}`,children:[f.some(Te=>Te.name===e.venue_name&&(!Te.city||Te.city===e.venue_city)&&(!Te.state||Te.state===e.venue_state))&&s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})," ",e.venue_name]}),t&&s.jsx(g1,{venueName:e.venue_name,venueCity:e.venue_city,venueState:e.venue_state,userId:t,variant:"outline",size:"sm",showFollowerCount:!1,className:"h-8 text-xs border-2"})]})]})}),s.jsxs("div",{className:"flex items-center justify-between pt-3 pb-2 border-t-2",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(le,{variant:"ghost",size:"sm",onMouseDown:Te=>{Te.stopPropagation()},onClick:Te=>{Te.preventDefault(),Te.stopPropagation(),_e()},disabled:!t||w,className:ke("flex items-center gap-2 px-4 py-2 rounded-full font-medium transition-all",g?"bg-[#FF3399]/10 text-[#FF3399] hover:bg-[#FF3399]/20":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[s.jsx(RF,{className:ke("h-5 w-5",g&&"fill-current")}),s.jsx("span",{className:"font-semibold",children:y}),s.jsx("span",{className:"hidden sm:inline",children:"Helpful"})]}),s.jsxs(le,{variant:"ghost",size:"sm",onMouseDown:Te=>{Te.stopPropagation()},onClick:Te=>{Te.preventDefault(),Te.stopPropagation(),ae()},className:"flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium transition-all",children:[s.jsx($n,{className:"h-5 w-5"}),s.jsx("span",{className:"font-semibold",children:A}),s.jsx("span",{className:"hidden sm:inline",children:"Comments"})]}),s.jsxs(le,{variant:"ghost",size:"sm",onMouseDown:Te=>{Te.stopPropagation()},onClick:Te=>{Te.preventDefault(),Te.stopPropagation(),oe()},className:"flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium transition-all",children:[s.jsx(zd,{className:"h-5 w-5"}),s.jsx("span",{className:"hidden sm:inline",children:"Share"})]})]}),t&&!Be&&s.jsx(le,{variant:"ghost",size:"sm",onMouseDown:Te=>{Te.stopPropagation()},onClick:Te=>{Te.preventDefault(),Te.stopPropagation(),Q(!0)},className:"rounded-full p-2 text-gray-500 hover:text-red-600 hover:bg-red-50",title:"Report this review",children:s.jsx(Qi,{className:"h-5 w-5"})})]})]}),N&&s.jsx("div",{className:"px-5 pb-3 pt-3 border-t-2",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"font-bold text-gray-900 flex items-center gap-2",children:[s.jsx($n,{className:"w-5 h-5 text-[#FF3399]"}),"Comments (",A,")"]}),$?s.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[s.jsx(lr,{className:"h-4 w-4 animate-spin mr-2"}),"Loading comments"]}):k.length===0?s.jsx("div",{className:"text-sm text-gray-500 italic text-center py-4 bg-gray-50 rounded-lg",children:"No comments yet. Be the first to comment!"}):s.jsx("div",{className:"space-y-3",children:k.map(Te=>{var dt,mr,Mn,fe;return s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsxs(Vr,{className:"w-9 h-9",children:[s.jsx(sn,{src:((dt=Te.user)==null?void 0:dt.avatar_url)||void 0,alt:((mr=Te.user)==null?void 0:mr.name)||"User"}),s.jsx(Wr,{className:"text-xs bg-gradient-to-br from-[#FF3399] to-[#FF66B3] text-white",children:(((Mn=Te.user)==null?void 0:Mn.name)||"U").charAt(0).toUpperCase()})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:((fe=Te.user)==null?void 0:fe.name)||"User"}),s.jsx("span",{className:"text-xs text-gray-500",children:tw(new Date(Te.created_at),{addSuffix:!0})})]}),s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:Te.comment_text})]})]},Te.id)})}),s.jsxs("div",{className:"flex items-end gap-2 mt-4",children:[s.jsx(ys,{value:z,onChange:Te=>D(Te.target.value),placeholder:t?"Write a comment":"Sign in to comment",disabled:!t||B,className:"min-h-[60px] border-2 focus:border-[#FF3399] rounded-lg"}),s.jsx(le,{onClick:we,disabled:!t||B||!z.trim(),className:"bg-gradient-to-r from-[#FF3399] to-[#FF66B3] hover:from-[#FF66B3] hover:to-[#FF3399] text-white",size:"lg",children:B?s.jsx(lr,{className:"h-5 w-5 animate-spin"}):s.jsx(Fc,{className:"h-5 w-5"})})]})]})}),G&&U.length>0&&s.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center",onClick:ve,role:"dialog","aria-modal":"true",children:[s.jsx("button",{className:"absolute top-4 right-4 text-white/80 hover:text-white text-3xl w-12 h-12 flex items-center justify-center rounded-full hover:bg-white/10","aria-label":"Close",onClick:Te=>{Te.stopPropagation(),ve()},children:""}),U.length>1&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"absolute left-4 text-white/80 hover:text-white text-4xl w-12 h-12 flex items-center justify-center rounded-full hover:bg-white/10","aria-label":"Previous image",onClick:ze,children:""}),s.jsx("button",{className:"absolute right-4 text-white/80 hover:text-white text-4xl w-12 h-12 flex items-center justify-center rounded-full hover:bg-white/10","aria-label":"Next image",onClick:ct,children:""})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("img",{src:U[K],alt:`Review photo ${K+1}`,className:"max-h-[85vh] max-w-[90vw] object-contain rounded-lg shadow-2xl",onClick:Te=>Te.stopPropagation()}),s.jsxs("p",{className:"text-white/70 mt-4 text-sm",children:[K+1," / ",U.length]})]})]}),s.jsx(v1,{open:Y,onClose:()=>Q(!1),contentType:"review",contentId:e.id,contentTitle:`Review for ${e.artist_name} at ${e.venue_name}`,onReportSubmitted:()=>{Q(!1),c==null||c(e.id)}}),re&&t&&s.jsx(cB,{review:e,currentUserId:t,isOpen:re,onClose:()=>ye(!1)})]})}var Xo="Accordion",iue=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[_T,oue,lue]=ip(Xo),[x1,TBe]=Os(Xo,[lue,dB]),wT=dB(),mB=J.forwardRef((e,t)=>{const o=e,{type:r}=o,n=me(o,["type"]),a=n,i=n;return s.jsx(_T.Provider,{scope:e.__scopeAccordion,children:r==="multiple"?s.jsx(hue,H(M({},i),{ref:t})):s.jsx(uue,H(M({},a),{ref:t}))})});mB.displayName=Xo;var[pB,cue]=x1(Xo),[gB,due]=x1(Xo,{collapsible:!1}),uue=J.forwardRef((e,t)=>{const d=e,{value:r,defaultValue:n,onValueChange:a=()=>{},collapsible:i=!1}=d,o=me(d,["value","defaultValue","onValueChange","collapsible"]),[l,c]=Wa({prop:r,defaultProp:n!=null?n:"",onChange:a,caller:Xo});return s.jsx(pB,{scope:e.__scopeAccordion,value:J.useMemo(()=>l?[l]:[],[l]),onItemOpen:c,onItemClose:J.useCallback(()=>i&&c(""),[i,c]),children:s.jsx(gB,{scope:e.__scopeAccordion,collapsible:i,children:s.jsx(vB,H(M({},o),{ref:t}))})})}),hue=J.forwardRef((e,t)=>{const u=e,{value:r,defaultValue:n,onValueChange:a=()=>{}}=u,i=me(u,["value","defaultValue","onValueChange"]),[o,l]=Wa({prop:r,defaultProp:n!=null?n:[],onChange:a,caller:Xo}),c=J.useCallback(f=>l((h=[])=>[...h,f]),[l]),d=J.useCallback(f=>l((h=[])=>h.filter(p=>p!==f)),[l]);return s.jsx(pB,{scope:e.__scopeAccordion,value:o,onItemOpen:c,onItemClose:d,children:s.jsx(gB,{scope:e.__scopeAccordion,collapsible:!0,children:s.jsx(vB,H(M({},i),{ref:t}))})})}),[fue,_1]=x1(Xo),vB=J.forwardRef((e,t)=>{const p=e,{__scopeAccordion:r,disabled:n,dir:a,orientation:i="vertical"}=p,o=me(p,["__scopeAccordion","disabled","dir","orientation"]),l=J.useRef(null),c=cr(l,t),d=oue(r),f=Sh(a)==="ltr",h=pt(e.onKeyDown,g=>{var R;if(!iue.includes(g.key))return;const v=g.target,y=d().filter($=>{var O;return!((O=$.ref.current)!=null&&O.disabled)}),_=y.findIndex($=>$.ref.current===v),w=y.length;if(_===-1)return;g.preventDefault();let b=_;const N=0,S=w-1,k=()=>{b=_+1,b>S&&(b=N)},P=()=>{b=_-1,b<N&&(b=S)};switch(g.key){case"Home":b=N;break;case"End":b=S;break;case"ArrowRight":i==="horizontal"&&(f?k():P());break;case"ArrowDown":i==="vertical"&&k();break;case"ArrowLeft":i==="horizontal"&&(f?P():k());break;case"ArrowUp":i==="vertical"&&P();break}const A=b%w;(R=y[A].ref.current)==null||R.focus()});return s.jsx(fue,{scope:r,disabled:n,direction:a,orientation:i,children:s.jsx(_T.Slot,{scope:r,children:s.jsx(Ct.div,H(M({},o),{"data-orientation":i,ref:c,onKeyDown:n?void 0:h}))})})}),aw="AccordionItem",[mue,bT]=x1(aw),yB=J.forwardRef((e,t)=>{const f=e,{__scopeAccordion:r,value:n}=f,a=me(f,["__scopeAccordion","value"]),i=_1(aw,r),o=cue(aw,r),l=wT(r),c=Ps(),d=n&&o.value.includes(n)||!1,u=i.disabled||e.disabled;return s.jsx(mue,{scope:r,open:d,disabled:u,triggerId:c,children:s.jsx(fB,H(M(M({"data-orientation":i.orientation,"data-state":NB(d)},l),a),{ref:t,disabled:u,open:d,onOpenChange:h=>{h?o.onItemOpen(n):o.onItemClose(n)}}))})});yB.displayName=aw;var xB="AccordionHeader",_B=J.forwardRef((e,t)=>{const o=e,{__scopeAccordion:r}=o,n=me(o,["__scopeAccordion"]),a=_1(Xo,r),i=bT(xB,r);return s.jsx(Ct.h3,H(M({"data-orientation":a.orientation,"data-state":NB(i.open),"data-disabled":i.disabled?"":void 0},n),{ref:t}))});_B.displayName=xB;var x2="AccordionTrigger",wB=J.forwardRef((e,t)=>{const c=e,{__scopeAccordion:r}=c,n=me(c,["__scopeAccordion"]),a=_1(Xo,r),i=bT(x2,r),o=due(x2,r),l=wT(r);return s.jsx(_T.ItemSlot,{scope:r,children:s.jsx(tue,H(M(M({"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":a.orientation,id:i.triggerId},l),n),{ref:t}))})});wB.displayName=x2;var bB="AccordionContent",jB=J.forwardRef((e,t)=>{const l=e,{__scopeAccordion:r}=l,n=me(l,["__scopeAccordion"]),a=_1(Xo,r),i=bT(bB,r),o=wT(r);return s.jsx(rue,H(M(M({role:"region","aria-labelledby":i.triggerId,"data-orientation":a.orientation},o),n),{ref:t,style:M({"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)"},e.style)}))});jB.displayName=bB;function NB(e){return e?"open":"closed"}var pue=mB,gue=yB,vue=_B,SB=wB,kB=jB;const yue=pue,EB=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(gue,M({ref:r,className:ke("border-b",e)},t))});EB.displayName="AccordionItem";const CB=x.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=me(i,["className","children"]);return s.jsx(vue,{className:"flex",children:s.jsxs(SB,H(M({ref:n,className:ke("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e)},r),{children:[t,s.jsx(Ta,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]}))})});CB.displayName=SB.displayName;const PB=x.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=me(i,["className","children"]);return s.jsx(kB,H(M({ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"},r),{children:s.jsx("div",{className:ke("pb-4 pt-0",e),children:t})}))});PB.displayName=kB.displayName;class GN{static resolveInternalEventId(t){return E(this,null,function*(){if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t))return t;const{data:n}=yield T.from("events").select("id").eq("jambase_event_id",t).limit(1).single();return(n==null?void 0:n.id)||t})}static getEventComments(t,r=20,n=0){return E(this,null,function*(){const a=yield this.resolveInternalEventId(t),{count:i,error:o}=yield T.from("comments").select("*",{count:"exact",head:!0}).eq("entity_type","event").eq("entity_id",a);if(o&&o.code!=="PGRST205")throw o;const l=i||0,{data:c,error:d}=yield T.from("comments").select("*").eq("entity_type","event").eq("entity_id",a).order("created_at",{ascending:!0}).range(n,n+r-1);if(d){if(d.code==="PGRST205")return console.warn("comments table not found. Did you run the consolidation migration?"),{comments:[],total:0,hasMore:!1};throw d}if(!c||c.length===0)return{comments:[],total:l,hasMore:!1};const u=[...new Set(c.map(y=>y.user_id))],{data:f,error:h}=yield T.from("users").select("id, name, avatar_url, user_id").in("user_id",u);if(h)throw h;const p=new Map;f==null||f.forEach(y=>{p.set(y.user_id,{id:y.id,name:y.name,avatar_url:y.avatar_url||void 0})});const g=c.map(y=>{var _;return{id:y.id,user_id:y.user_id,event_id:y.event_id,parent_comment_id:(_=y.parent_comment_id)!=null?_:null,comment_text:y.comment_text,created_at:y.created_at,updated_at:y.updated_at,user:p.get(y.user_id)||{id:y.user_id,name:"Unknown User"}}}),v=n+c.length<l;return{comments:g,total:l,hasMore:v}})}static addEventComment(t,r,n,a){return E(this,null,function*(){const i=yield this.resolveInternalEventId(r),{data:o,error:l}=yield T.from("comments").insert({user_id:t,entity_type:"event",entity_id:i,comment_text:n,parent_comment_id:a}).select().single();if(l)throw l.code==="PGRST205"?new Error("Event comments are not yet enabled. Please apply the consolidation migration."):l;return o})}}function TB({eventId:e,isOpen:t,onClose:r,currentUserId:n,onCommentAdded:a,onCommentsLoaded:i}){const[o,l]=x.useState([]),[c,d]=x.useState(!1),[u,f]=x.useState(!1),[h,p]=x.useState(""),[g,v]=x.useState(null),[y,_]=x.useState(!1),[w,b]=x.useState(!1);x.useEffect(()=>{t&&e&&N()},[t,e]);const N=()=>E(this,null,function*(){if(e)try{d(!0),v(null);const P=yield GN.getEventComments(e,20,0);l(P.comments),_(P.hasMore),i&&i(P.comments.length)}catch(P){console.error("Failed to load event comments",P),v("Failed to load comments")}finally{d(!1)}}),S=()=>E(this,null,function*(){if(!(!e||w||!y))try{b(!0);const P=yield GN.getEventComments(e,20,o.length);l(A=>[...A,...P.comments]),_(P.hasMore)}catch(P){console.error("Failed to load more comments",P),v("Failed to load more comments")}finally{b(!1)}}),k=()=>E(this,null,function*(){if(!(!n||!e||!h.trim()||u))try{f(!0);const P=yield GN.addEventComment(n,e,h.trim());l(A=>[...A,H(M({},P),{user:{id:P.user_id,name:"You"}})]),p(""),a&&a()}catch(P){console.error("Failed to add comment",P),v("Failed to add comment")}finally{f(!1)}});return s.jsx(pn,{open:t,onOpenChange:P=>!P&&r(),children:s.jsxs(dn,{className:"sm:max-w-lg",children:[s.jsxs(Vn,{children:[s.jsx(bn,{children:"Event Comments"}),s.jsx(os,{children:"Discuss this event."})]}),s.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-1",children:[c?s.jsxs("div",{className:"flex items-center justify-center py-8 text-muted-foreground",children:[s.jsx(lr,{className:"h-5 w-5 animate-spin mr-2"})," Loading comments..."]}):g?s.jsx("div",{className:"text-sm text-red-600 py-4",children:g}):o.length===0?s.jsx("div",{className:"text-sm text-muted-foreground py-4",children:"No comments yet. Be the first to comment!"}):o.map(P=>s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs(Vr,{className:"h-8 w-8",children:[s.jsx(sn,{src:P.user.avatar_url||void 0}),s.jsx(Wr,{children:(P.user.name||"U").slice(0,2).toUpperCase()})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-sm font-medium text-foreground",children:P.user.name||"User"}),s.jsx("div",{className:"text-sm text-foreground whitespace-pre-wrap",children:P.comment_text}),s.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(P.created_at).toLocaleString()})]})]},P.id)),y&&!c&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(le,{variant:"outline",size:"sm",onClick:S,disabled:w,className:"text-sm",children:w?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"h-4 w-4 animate-spin mr-2"}),"Loading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ta,{className:"h-4 w-4 mr-2"}),"Load More Comments"]})})})]}),s.jsx("div",{className:"pt-2 border-t mt-2",children:s.jsxs("div",{className:"flex items-end gap-2",children:[s.jsx(ys,{value:h,onChange:P=>p(P.target.value),placeholder:n?"Write a comment":"Sign in to comment",disabled:!n||u,className:"min-h-[72px]"}),s.jsx(le,{onClick:k,disabled:!n||u||!h.trim(),className:"bg-pink-500 hover:bg-pink-600 text-white",children:u?s.jsx(lr,{className:"h-4 w-4 animate-spin"}):s.jsx(Fc,{className:"h-4 w-4"})})]})})]})})}function xue({eventId:e,onClick:t}){const[r,n]=x.useState(0),[a,i]=x.useState(!0);x.useEffect(()=>{o()},[e]);const o=()=>E(this,null,function*(){try{const{data:{user:l}}=yield T.auth.getUser();if(!l){i(!1);return}const{data:c}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${l.id},related_user_id.eq.${l.id}`);if(!c||c.length===0){i(!1);return}const d=c.map(h=>h.user_id===l.id?h.related_user_id:h.user_id),{data:u,error:f}=yield T.from("user_event_relationships").select("user_id").eq("event_id",e).eq("relationship_type","interested").in("user_id",d);if(!f&&u){n(u.length);return}if(f){console.error("Error loading friends interested from user_event_relationships:",f),n(0);return}n(0)}catch(l){console.error("Error loading friends interested:",l)}finally{i(!1)}});return a||r===0?null:s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--info-blue-050)",border:"2px solid var(--info-blue-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--info-blue-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",gap:"var(--spacing-inline, 6px)",cursor:t?"pointer":"default"},onClick:t,onMouseEnter:l=>{t&&(l.currentTarget.style.backgroundColor="var(--info-blue-050)",l.currentTarget.style.opacity="0.9")},onMouseLeave:l=>{t&&(l.currentTarget.style.backgroundColor="var(--info-blue-050)",l.currentTarget.style.opacity="1")},children:[s.jsx(zr,{size:16}),s.jsxs("span",{children:[r," friend",r!==1?"s":""," interested"]})]})}function _ue({eventId:e,className:t}){const[r,n]=x.useState(!1),[a,i]=x.useState(!0);x.useEffect(()=>{o()},[e]);const o=()=>E(this,null,function*(){var l;try{const c=new Date;c.setHours(c.getHours()-24);const{count:d,error:u}=yield T.from("interactions").select("id",{count:"exact",head:!0}).eq("entity_type","event").eq("entity_id",e).gte("occurred_at",c.toISOString());if(u){if(u.code==="PGRST205"||(l=u.message)!=null&&l.includes("does not exist"))return;throw u}n((d||0)>=20)}catch(c){console.debug("Trending status check failed (non-critical):",c)}finally{i(!1)}});return a||!r?null:s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",background:"linear-gradient(135deg, #f97316 0%, #ec4899 100%)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-50)",boxShadow:"0 4px 4px 0 var(--shadow-color)",gap:"var(--spacing-inline, 6px)"},className:t,children:[s.jsx(wQ,{size:16,style:{fill:"currentColor"}}),s.jsx("span",{children:"Trending"})]})}function wue({interestedCount:e,attendanceCount:t,className:r}){const a=(()=>{const o=e+(t||0);return o>=100?{tier:"mega",label:"Mega Popular",icon:sh,className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white"}:o>=50?{tier:"very",label:"Very Popular",icon:Ol,className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white"}:o>=20?{tier:"popular",label:"Popular",icon:Qt,className:"bg-blue-100 text-blue-800"}:null})();if(!a)return null;const i=a.icon;return s.jsxs(Ke,{className:`${a.className} ${r}`,children:[s.jsx(i,{className:"h-3 w-3 mr-1 fill-current"}),a.label]})}class YN{static recordSwipe(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{error:a}=yield T.from("engagements").insert({user_id:r.id,entity_type:"user",entity_id:t.swiped_user_id,engagement_type:"swipe",engagement_value:t.is_interested?"right":"left",metadata:{event_id:t.event_id,swiped_user_id:t.swiped_user_id,is_interested:t.is_interested}});if(a)throw a;t.is_interested&&(yield this.checkForMatch(r.id,t.swiped_user_id,t.event_id))}catch(r){throw console.error("Error recording swipe:",r),r}})}static checkForMatch(t,r,n){return E(this,null,function*(){var a,i;try{const{data:o}=yield T.from("engagements").select("*").eq("user_id",r).eq("entity_type","user").eq("entity_id",t).eq("engagement_type","swipe").eq("engagement_value","right").eq("metadata->>event_id",n).single();if(o){yield T.from("user_relationships").insert([{user_id:t,related_user_id:r,relationship_type:"match",status:"accepted",metadata:{event_id:n,matched_user_id:r}},{user_id:r,related_user_id:t,relationship_type:"match",status:"accepted",metadata:{event_id:n,matched_user_id:t}}]);const{data:l}=yield T.from("events_with_artist_venue").select("title, artist_name_normalized").eq("id",n).single(),[c,d]=yield Promise.all([T.from("users").select("name").eq("user_id",t).single(),T.from("users").select("name").eq("user_id",r).single()]),u=((a=c.data)==null?void 0:a.name)||"Someone",f=((i=d.data)==null?void 0:i.name)||"Someone",h=(l==null?void 0:l.title)||"an event",p=[{user_id:t,type:"match",title:" It's a Match!",message:`You and ${f} both want to meet up at ${h}!`,data:{match_user_id:r,match_user_name:f,event_id:n,event_title:h,event_artist:l==null?void 0:l.artist_name_normalized},actor_user_id:r},{user_id:r,type:"match",title:" It's a Match!",message:`You and ${u} both want to meet up at ${h}!`,data:{match_user_id:t,match_user_name:u,event_id:n,event_title:h,event_artist:l==null?void 0:l.artist_name_normalized},actor_user_id:t}];yield T.from("notifications").insert(p),yield this.createMatchChat(t,r,n)}}catch(o){console.error("Error checking for match:",o)}})}static getPotentialMatches(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:a,error:i}=yield T.from("user_event_relationships").select("user_id").eq("event_id",t).in("relationship_type",["interested","going","maybe"]).neq("user_id",r.id);if(i)throw i;if(!a||a.length===0)return[];const o=a.map(u=>u.user_id),{data:l,error:c}=yield T.from("users").select(`
          user_id,
          name,
          avatar_url,
          bio,
          music_streaming_profile,
          gender,
          birthday,
          instagram_handle
        `).in("user_id",o);if(c)throw c;return(yield Promise.all((l||[]).map(u=>E(this,null,function*(){if(!u)return null;const{data:f}=yield T.from("engagements").select("id").eq("user_id",r.id).eq("entity_type","user").eq("entity_id",u.user_id).eq("engagement_type","swipe").eq("metadata->>event_id",t).single();if(f)return null;const{data:h}=yield T.rpc("is_user_blocked",{p_user_id:u.user_id,p_by_user_id:r.id});if(h)return null;const p=yield this.calculateCompatibility(r.id,u.user_id),g=yield this.getSharedPreferences(r.id,u.user_id);return{user_id:u.user_id,name:u.name,avatar_url:u.avatar_url,bio:u.bio,gender:u.gender,birthday:u.birthday,instagram_handle:u.instagram_handle,compatibility_score:p,shared_artists:g.artists,shared_genres:g.genres,music_streaming_profile:u.music_streaming_profile}})))).filter(u=>u!==null)}catch(r){throw console.error("Error getting potential matches:",r),r}})}static calculateCompatibility(t,r){return E(this,null,function*(){var n,a;try{const[i,o]=yield Promise.all([T.from("user_preferences").select("music_preference_signals").eq("user_id",t).single(),T.from("user_preferences").select("music_preference_signals").eq("user_id",r).single()]),l=((n=i.data)==null?void 0:n.music_preference_signals)||[],c=((a=o.data)==null?void 0:a.music_preference_signals)||[];if(!l.length||!c.length)return 50;const d=l.filter(y=>y.preference_type==="artist").map(y=>y.preference_value.toLowerCase()),u=l.filter(y=>y.preference_type==="genre").map(y=>y.preference_value.toLowerCase()),f=c.filter(y=>y.preference_type==="artist").map(y=>y.preference_value.toLowerCase()),h=c.filter(y=>y.preference_type==="genre").map(y=>y.preference_value.toLowerCase()),p=this.calculateOverlap(d,f),g=this.calculateOverlap(u,h),v=p*.6+g*.4;return Math.round(Math.min(100,Math.max(0,v*100)))}catch(i){return console.error("Error calculating compatibility:",i),50}})}static calculateOverlap(t,r){if(!(t!=null&&t.length)||!(r!=null&&r.length))return 0;const n=new Set(t),a=new Set(r);return[...n].filter(o=>a.has(o)).length/Math.max(n.size,a.size)}static getSharedPreferences(t,r){return E(this,null,function*(){var n,a;try{const[i,o]=yield Promise.all([T.from("user_preferences").select("music_preference_signals").eq("user_id",t).single(),T.from("user_preferences").select("music_preference_signals").eq("user_id",r).single()]),l=((n=i.data)==null?void 0:n.music_preference_signals)||[],c=((a=o.data)==null?void 0:a.music_preference_signals)||[];if(!l.length||!c.length)return{artists:[],genres:[]};const d=l.filter(v=>v.preference_type==="artist").map(v=>v.preference_value),u=l.filter(v=>v.preference_type==="genre").map(v=>v.preference_value),f=c.filter(v=>v.preference_type==="artist").map(v=>v.preference_value),h=c.filter(v=>v.preference_type==="genre").map(v=>v.preference_value),p=d.filter(v=>f.some(y=>y.toLowerCase()===v.toLowerCase())),g=u.filter(v=>h.some(y=>y.toLowerCase()===v.toLowerCase()));return{artists:p.slice(0,5),genres:g.slice(0,3)}}catch(i){return console.error("Error getting shared preferences:",i),{artists:[],genres:[]}}})}static createMatchChat(t,r,n){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("chat_participants").select("chat_id").eq("user_id",t);if(i)throw new Error(`Failed to check existing chats for user1: ${i.message}`);const{data:o,error:l}=yield T.from("chat_participants").select("chat_id").eq("user_id",r);if(l)throw new Error(`Failed to check existing chats for user2: ${l.message}`);const c=new Set((a==null?void 0:a.map(_=>_.chat_id))||[]),d=new Set((o==null?void 0:o.map(_=>_.chat_id))||[]),u=[...c].filter(_=>d.has(_));if(u.length>0){const{data:_,error:w}=yield T.from("chats").select("id").in("id",u).eq("is_group_chat",!1).limit(1);if(w)console.error("Error checking for existing direct chat:",w);else if(_&&_.length>0)return}const{data:f}=yield T.from("events_with_artist_venue").select("title, artist_name_normalized").eq("id",n).single(),h=(f==null?void 0:f.title)||"Concert Chat",{data:p,error:g}=yield T.from("chats").insert({chat_name:h,is_group_chat:!1}).select().single();if(g||!p)throw new Error(`Failed to create chat: ${(g==null?void 0:g.message)||"Unknown error"}`);const{error:v}=yield T.from("chat_participants").insert([{chat_id:p.id,user_id:t},{chat_id:p.id,user_id:r}]);if(v){const{error:_}=yield T.from("chats").delete().eq("id",p.id);throw _?(console.error(`CRITICAL: Failed to cleanup orphaned chat ${p.id} after participant insert failure. Original error: ${v.message}. Cleanup error: ${_.message}`),new Error(`Failed to add participants to chat: ${v.message}. CRITICAL: Cleanup also failed - orphaned chat ${p.id} may exist: ${_.message}`)):new Error(`Failed to add participants to chat: ${v.message}`)}const{error:y}=yield T.from("messages").insert({chat_id:p.id,sender_id:t,content:` You matched! Start chatting about ${(f==null?void 0:f.title)||"the event"}!`});y&&console.warn("Failed to send welcome message, but chat was created successfully:",y)}catch(a){console.error("Error creating match chat:",a)}})}static getEventMatches(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:a,error:i}=yield T.from("user_relationships").select("*").eq("relationship_type","match").eq("user_id",r.id).eq("metadata->>event_id",t);if(i)throw i;return yield Promise.all((a||[]).map(l=>E(this,null,function*(){var h;const c=l.related_user_id,d=(h=l.metadata)==null?void 0:h.event_id,[u,f]=yield Promise.all([T.from("users").select("user_id, name, avatar_url, bio").eq("user_id",c).single(),d?T.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date").eq("id",d).single():Promise.resolve({data:null})]);return H(M({},l),{user1_id:l.user_id,user2_id:l.related_user_id,event_id:d||t,matched_user:u.data,event:f.data})})))}catch(r){throw console.error("Error getting event matches:",r),r}})}static getAllMatches(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{data:n,error:a}=yield T.from("user_relationships").select("*").eq("relationship_type","match").eq("user_id",t.id).order("created_at",{ascending:!1});if(a)throw a;return yield Promise.all((n||[]).map(o=>E(this,null,function*(){var f;const l=o.related_user_id,c=(f=o.metadata)==null?void 0:f.event_id,[d,u]=yield Promise.all([T.from("users").select("user_id, name, avatar_url, bio, music_streaming_profile").eq("user_id",l).single(),c?T.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date, images").eq("id",c).single():Promise.resolve({data:null})]);return H(M({},o),{user1_id:o.user_id,user2_id:o.related_user_id,event_id:c||"",matched_user:d.data,event:u.data})})))}catch(t){throw console.error("Error getting all matches:",t),t}})}static hasSwipedOn(t,r){return E(this,null,function*(){try{const{data:{user:n},error:a}=yield T.auth.getUser();if(a||!n)throw new Error("User not authenticated");const{data:i}=yield T.from("engagements").select("id").eq("user_id",n.id).eq("entity_type","user").eq("entity_id",r).eq("engagement_type","swipe").eq("metadata->>event_id",t).single();return!!i}catch(n){return!1}})}static getMatchCount(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)return 0;const{count:n,error:a}=yield T.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","match").eq("user_id",t.id);if(a)throw a;return n||0}catch(t){return console.error("Error getting match count:",t),0}})}static getNotifications(t=20){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:a,error:i}=yield T.from("notifications").select(`
          *,
          actor_profile:actor_user_id (
            name,
            avatar_url
          )
        `).eq("user_id",r.id).order("created_at",{ascending:!1}).limit(t);if(i)throw i;return a||[]}catch(r){throw console.error("Error getting notifications:",r),r}})}static markNotificationRead(t){return E(this,null,function*(){try{const{error:r}=yield T.from("notifications").update({is_read:!0}).eq("id",t);if(r)throw r}catch(r){throw console.error("Error marking notification as read:",r),r}})}static getUnreadNotificationCount(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{count:n,error:a}=yield T.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",t.id).eq("is_read",!1);if(a)throw a;return n||0}catch(t){return console.error("Error getting unread notification count:",t),0}})}static getChats(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{data:n,error:a}=yield T.from("chat_participants").select("chat_id").eq("user_id",t.id);if(a)throw a;const i=(n==null?void 0:n.map(c=>c.chat_id))||[];if(i.length===0)return[];const{data:o,error:l}=yield T.from("chats").select(`
          *,
          messages (
            id,
            message,
            sender_id,
            created_at
          )
        `).in("id",i).order("updated_at",{ascending:!1});if(l)throw l;if(o&&o.length>0){const c=o.map(f=>f.id),{data:d}=yield T.from("chat_participants").select("chat_id, user_id").in("chat_id",c),u=new Map;return d==null||d.forEach(f=>{const h=u.get(f.chat_id)||[];h.push(f.user_id),u.set(f.chat_id,h)}),o.map(f=>H(M({},f),{users:u.get(f.id)||[]}))}return[]}catch(t){throw console.error("Error getting chats:",t),t}})}static sendMessage(t,r){return E(this,null,function*(){try{const{data:{user:n},error:a}=yield T.auth.getUser();if(a||!n)throw new Error("User not authenticated");const{error:i}=yield T.from("messages").insert({chat_id:t,sender_id:n.id,content:r});if(i)throw i;yield T.from("chats").update({updated_at:new Date().toISOString()}).eq("id",t)}catch(n){throw console.error("Error sending message:",n),n}})}}class iw{static requestPermission(){return E(this,null,function*(){if(!this.isSupported)return console.log("Push notifications not supported"),!1;try{return this.permission=yield Notification.requestPermission(),this.permission==="granted"}catch(t){return console.error("Error requesting notification permission:",t),!1}})}static isEnabled(){return this.isSupported&&this.permission==="granted"}static showMatchNotification(t){if(!this.isEnabled())return;const r=new Notification(" It's a Match!",{body:`You and ${t.userName} both want to meet up at ${t.eventTitle}!`,icon:"/favicon.png",badge:"/favicon.png",tag:"match-notification",requireInteraction:!0,actions:[{action:"view",title:"View Match"},{action:"chat",title:"Start Chat"}]});r.onclick=()=>{window.focus(),window.location.href="/matches",r.close()}}static showMessageNotification(t){if(!this.isEnabled())return;const r=new Notification(`Message from ${t.senderName}`,{body:t.message,icon:"/favicon.png",badge:"/favicon.png",tag:`message-${t.chatId}`,requireInteraction:!1});r.onclick=()=>{window.focus(),window.location.href=`/chat/${t.chatId}`,r.close()}}static initialize(){return E(this,null,function*(){this.isSupported&&(this.permission=Notification.permission,this.permission==="default"&&console.log("Notification permission not set. Consider showing a UI prompt."))})}static subscribeToServiceWorker(){return E(this,null,function*(){if("serviceWorker"in navigator)try{const t=yield navigator.serviceWorker.register("/sw.js");console.log("Service Worker registered:",t)}catch(t){console.error("Service Worker registration failed:",t)}})}}Cr(iw,"isSupported","Notification"in window),Cr(iw,"permission","default");typeof window!="undefined"&&iw.initialize();function bue({eventId:e,eventTitle:t,interestedCount:r,onMatchCreated:n,onNavigateToProfile:a}){const{toast:i}=Rr(),[o,l]=x.useState([]),[c,d]=x.useState(0),[u,f]=x.useState(!0),[h,p]=x.useState(!1),[g,v]=x.useState(null);x.useEffect(()=>{y()},[e]);const y=()=>E(this,null,function*(){f(!0);try{const b=yield YN.getPotentialMatches(e);l(b),d(0)}catch(b){console.error("Error loading potential matches:",b),i({title:"Error",description:"Failed to load potential concert buddies",variant:"destructive"})}finally{f(!1)}}),_=b=>E(this,null,function*(){const N=o[c];if(!(!N||h)){p(!0),v(b?"right":"left");try{yield YN.recordSwipe({event_id:e,swiped_user_id:N.user_id,is_interested:b}),b&&((yield YN.getEventMatches(e)).find(P=>P.user1_id===N.user_id||P.user2_id===N.user_id)?(i({title:" It's a Match!",description:`You and ${N.name} both want to meet up!`}),iw.showMatchNotification({userName:N.name,eventTitle:t}),n&&n(N)):i({title:" Sent!",description:`If ${N.name} swipes right too, you'll match!`})),setTimeout(()=>{d(S=>S+1),v(null),p(!1)},300)}catch(S){console.error("Error swiping:",S),i({title:"Error",description:"Failed to record swipe",variant:"destructive"}),v(null),p(!1)}}});if(u)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(lr,{className:"h-8 w-8 animate-spin text-purple-600"})});if(o.length===0)return s.jsx(He,{children:s.jsxs(et,{className:"py-12 text-center",children:[s.jsx(ns,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),r===0?s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No One Going Yet"}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Be the first to show interest in this event! Share it with friends to meet people going."})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"All Caught Up!"}),s.jsx("p",{className:"text-gray-600 text-sm",children:"You've swiped through everyone going to this event. Check back later for new people!"})]})]})});if(c>=o.length)return s.jsx(He,{children:s.jsxs(et,{className:"py-12 text-center",children:[s.jsx(Ol,{className:"h-16 w-16 text-purple-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"All Done!"}),s.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"You've reviewed all people going to this event"}),s.jsx(le,{onClick:y,variant:"outline",children:"Check for New People"})]})});const w=o[c];return s.jsxs("div",{className:"max-w-md mx-auto",children:[s.jsxs("div",{className:"mb-4 flex items-center justify-between text-sm text-gray-600",children:[s.jsxs("span",{children:[c+1," of ",o.length]}),s.jsxs("span",{className:"text-purple-600 font-medium",children:["Meet People Going to ",t]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(He,{className:`transition-all duration-300 cursor-pointer hover:shadow-lg ${g==="left"?"translate-x-[-100%] opacity-0":g==="right"?"translate-x-[100%] opacity-0":""}`,onClick:b=>{b.stopPropagation(),a&&a(w.user_id)},children:s.jsxs(et,{className:"p-0",children:[s.jsx("div",{className:"relative h-96 bg-gradient-to-br from-purple-100 to-pink-100 rounded-t-lg",children:w.avatar_url?s.jsx("img",{src:w.avatar_url,alt:w.name,className:"w-full h-full object-cover rounded-t-lg"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx("span",{className:"text-8xl font-bold text-purple-300",children:w.name.charAt(0).toUpperCase()})})}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-1",children:w.name}),w.bio&&s.jsx("p",{className:"text-gray-700 text-sm",children:w.bio})]}),w.music_streaming_profile&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx($t,{className:"h-4 w-4"}),s.jsx("span",{children:"Has Spotify connected"})]}),w.shared_artists&&w.shared_artists.length>0&&s.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-sm font-medium text-purple-900 mb-2",children:"Shared Artists"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:w.shared_artists.slice(0,5).map((b,N)=>s.jsx(Ke,{variant:"outline",className:"text-xs",children:b},N))})]}),(w.gender||w.birthday||w.instagram_handle)&&s.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Profile Highlights"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.gender&&s.jsx(Ke,{variant:"outline",className:"text-xs",children:w.gender}),w.birthday&&(()=>{const b=new Date().getFullYear()-new Date(w.birthday).getFullYear();return s.jsxs(Ke,{variant:"outline",className:"text-xs",children:[b," years old"]})})(),w.instagram_handle&&s.jsxs(Ke,{variant:"outline",className:"text-xs",children:["@",w.instagram_handle]})]})]}),w.compatibility_score!==void 0&&s.jsx("div",{className:"text-center pt-2",children:s.jsx("p",{className:"text-xs text-gray-500",children:"Based on music taste and preferences"})})]})]})}),s.jsxs("div",{className:"flex items-center justify-center gap-8 mt-6",children:[s.jsx(le,{size:"lg",variant:"outline",onClick:()=>_(!1),disabled:h,className:"w-20 h-20 rounded-full border-2 border-red-300 hover:bg-red-50 hover:border-red-400",children:s.jsx(Gr,{className:"h-10 w-10 text-red-500"})}),s.jsx(le,{size:"lg",variant:"default",onClick:()=>_(!0),disabled:h,className:"w-24 h-24 rounded-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 shadow-lg",children:s.jsx(ns,{className:"h-12 w-12 fill-current"})})]}),s.jsxs("div",{className:"mt-6 text-center text-sm text-gray-600",children:[s.jsx("p",{children:"Swipe right if you'd like to meet up at this event"}),s.jsx("p",{className:"text-xs mt-1",children:"If they swipe right too, you'll match and can chat!"})]})]})]})}const lg={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"},jue={sm:"text-xs",md:"text-sm",lg:"text-base",xl:"text-lg"},Lv=({size:e="md",variant:t="spinner",text:r,fullPage:n=!1,inline:a=!1,className:i,background:o="blur"})=>{const l=()=>{switch(t){case"spinner":return s.jsx("div",{className:ke("relative",lg[e],"animate-spin rounded-full border-4 border-synth-pink/20","border-t-synth-pink border-r-synth-pink"),children:s.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-transparent border-t-synth-pink/40 animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})});case"pulse":return s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:ke("rounded-full bg-gradient-to-br from-synth-pink to-synth-pink-light","animate-pulse",lg[e]),style:{boxShadow:"0 0 20px rgba(255, 51, 153, 0.4)"}}),s.jsx("div",{className:ke("absolute inset-0 rounded-full bg-gradient-to-br from-synth-pink to-synth-pink-light","animate-ping opacity-75",lg[e])})]});case"dots":return s.jsx("div",{className:"flex items-center gap-2",children:[0,1,2].map(d=>s.jsx("div",{className:ke("rounded-full bg-synth-pink",e==="sm"?"w-1.5 h-1.5":e==="md"?"w-2 h-2":e==="lg"?"w-3 h-3":"w-4 h-4","animate-bounce"),style:{animationDelay:`${d*.15}s`,animationDuration:"0.6s"}},d))});case"logo":return s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:ke("flex items-center justify-center","rounded-full bg-gradient-to-br from-synth-pink/20 to-synth-pink-light/20","backdrop-blur-sm border-2 border-synth-pink/30",lg[e]),children:s.jsx($t,{className:ke("text-synth-pink animate-pulse",e==="sm"?"w-2 h-2":e==="md"?"w-4 h-4":e==="lg"?"w-6 h-6":"w-8 h-8")})}),s.jsx("div",{className:ke("absolute inset-0 rounded-full border-2 border-synth-pink/40","animate-ping",lg[e])})]});default:return null}},c=s.jsxs("div",{className:ke("flex flex-col items-center justify-center gap-3",i),children:[l(),r&&s.jsx("p",{className:ke("text-muted-foreground font-medium animate-pulse",jue[e]),children:r})]});return n?s.jsx("div",{className:ke("fixed inset-0 z-50 flex items-center justify-center",o==="blur"&&"bg-background/80 backdrop-blur-sm",o==="solid"&&"bg-background",o==="transparent"&&"bg-transparent"),children:s.jsx("div",{className:"text-center space-y-6",children:c})}):a?s.jsx("div",{className:ke("flex items-center justify-center py-8",i),children:c}):c},w1=({text:e="Loading...",showLogo:t=!1})=>s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-white via-synth-beige/30 to-white",children:s.jsxs("div",{className:"text-center space-y-6 px-4",children:[t&&s.jsx("div",{className:"w-32 h-32 mx-auto mb-4",children:s.jsxs("div",{className:"relative w-full h-full",children:[s.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-synth-pink/20 to-synth-pink-light/20 animate-pulse"}),s.jsx("div",{className:"absolute inset-2 rounded-full bg-gradient-to-br from-synth-pink to-synth-pink-light flex items-center justify-center",children:s.jsx($t,{className:"w-16 h-16 text-white"})}),s.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-synth-pink/40 animate-ping"})]})}),s.jsx(Lv,{variant:"spinner",size:"lg",text:e})]})}),Rd=({text:e,size:t="md",variant:r="spinner"})=>s.jsx(Lv,{variant:r,size:t,text:e,inline:!0});class Nue{static uploadPhoto(t){return E(this,null,function*(){throw new Error("Photo uploads are handled through reviews. Please add photos when creating or editing a review.")})}static getEventPhotos(t,r=20,n=0){return E(this,null,function*(){try{const{data:{user:a}}=yield T.auth.getUser(),{data:i,error:o}=yield T.from("event_media").select(`
          id,
          url,
          review_id,
          created_at,
          review:reviews!event_media_review_id_fkey (
            user_id,
            user:users!reviews_user_id_fkey (
              name,
              avatar_url
            )
          )
        `).eq("event_id",t).eq("media_type","photo").order("created_at",{ascending:!1}).range(n,n+r-1);return o?(console.warn("Error getting event photos from event_media:",o),[]):(i||[]).map(c=>{const d=c.review,u=d==null?void 0:d.user;return{id:c.id,event_id:t,photo_url:c.url,caption:void 0,likes_count:0,comments_count:0,is_featured:!1,user_id:(d==null?void 0:d.user_id)||"",user_name:(u==null?void 0:u.name)||"Unknown",user_avatar_url:(u==null?void 0:u.avatar_url)||null,user_has_liked:!1,created_at:c.created_at}})}catch(a){return console.error("Error getting event photos:",a),[]}})}static togglePhotoLike(t,r){return E(this,null,function*(){console.warn("Photo likes not supported - photos are part of reviews")})}static addComment(t,r){return E(this,null,function*(){throw new Error("Photo comments not supported - photos are part of reviews. Please comment on the review instead.")})}static getPhotoComments(t){return E(this,null,function*(){return[]})}static deletePhoto(t){return E(this,null,function*(){throw new Error("Photos are part of reviews. Please edit the review to remove photos.")})}static updateCaption(t,r){return E(this,null,function*(){throw new Error("Photo captions not supported - photos are part of reviews.")})}static getUserPhotos(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const a=t||r.id,{data:i,error:o}=yield T.from("reviews").select("id").eq("user_id",a).eq("is_public",!0).eq("is_draft",!1);if(o||!i||i.length===0)return[];const l=i.map(f=>f.id),{data:c,error:d}=yield T.from("event_media").select(`
          id,
          url,
          review_id,
          event_id,
          created_at,
          review:reviews!event_media_review_id_fkey (
            user:users!reviews_user_id_fkey (
              name,
              avatar_url
            )
          ),
          event:events (
            id,
            title,
            artist_name,
            event_date
          )
        `).in("review_id",l).eq("media_type","photo").order("created_at",{ascending:!1});return d?(console.warn("Error getting user photos from event_media:",d),[]):(c||[]).map(f=>{const h=f.review,p=h==null?void 0:h.user;return{id:f.id,event_id:f.event_id||"",photo_url:f.url,caption:void 0,likes_count:0,comments_count:0,is_featured:!1,user_id:(h==null?void 0:h.user_id)||a,user_name:(p==null?void 0:p.name)||"Unknown",user_avatar_url:(p==null?void 0:p.avatar_url)||null,user_has_liked:!1,created_at:f.created_at}})}catch(r){return console.error("Error getting user photos:",r),[]}})}static toggleFeatured(t,r){return E(this,null,function*(){throw new Error("Photo featuring not supported - photos are part of reviews.")})}}function Sue({eventId:e,eventTitle:t,canUpload:r=!0}){const{user:n}=xs(),{toast:a}=Rr(),[i,o]=x.useState([]),[l,c]=x.useState(!0);x.useEffect(()=>{d()},[e]);const d=()=>E(this,null,function*(){c(!0);try{const p=yield Nue.getEventPhotos(e,50);o(p)}catch(p){console.error("Error loading photos:",p),o([])}finally{c(!1)}}),u=p=>E(this,null,function*(){a({title:"Info",description:"Photos are part of reviews. Like the review instead."})}),f=p=>E(this,null,function*(){a({title:"Info",description:"Photos are part of reviews. Please edit the review to remove photos."})}),h=({photo:p})=>s.jsxs(He,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:p.photo_url,alt:p.caption||"Event photo",className:"w-full aspect-square object-cover cursor-pointer",onClick:()=>{}}),p.is_featured&&s.jsx(Ke,{className:"absolute top-2 right-2 bg-yellow-500",children:" Featured"})]}),s.jsxs(et,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p.user_avatar_url?s.jsx("img",{src:p.user_avatar_url,alt:p.user_name,className:"w-8 h-8 rounded-full"}):s.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center",children:s.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:p.user_name.charAt(0)})}),s.jsx("span",{className:"font-medium text-sm",children:p.user_name})]}),p.caption&&s.jsx("p",{className:"text-sm text-gray-700 mb-3",children:p.caption}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>u(),className:p.user_has_liked?"text-red-500":"text-gray-600",children:[s.jsx(ns,{className:`h-4 w-4 mr-1 ${p.user_has_liked?"fill-current":""}`}),p.likes_count]}),s.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>{a({title:"Info",description:"Photos are part of reviews. Comment on the review instead."})},className:"text-gray-600",children:[s.jsx($n,{className:"h-4 w-4 mr-1"}),p.comments_count]}),(n==null?void 0:n.id)===p.user_id&&s.jsx(le,{variant:"ghost",size:"sm",onClick:()=>f(),className:"text-gray-600 hover:text-red-600 ml-auto",children:s.jsx(Dl,{className:"h-4 w-4"})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(p.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})})]})]});return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold",children:"Event Photos"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[i.length," photo",i.length!==1?"s":""]})]}),r&&s.jsxs(le,{onClick:()=>{a({title:"Info",description:"Photos are added through reviews. Please create or edit a review to add photos."})},size:"sm",children:[s.jsx(z_,{className:"h-4 w-4 mr-2"}),"Upload Photo"]})]}),l?s.jsx(Rd,{text:"Loading photos...",size:"lg"}):i.length===0?s.jsx(He,{children:s.jsxs(et,{className:"py-12 text-center",children:[s.jsx(kv,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),s.jsx("h4",{className:"text-lg font-semibold mb-2",children:"No Photos Yet"}),s.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Be the first to share a photo from this event!"}),r&&s.jsxs(le,{onClick:()=>{a({title:"Info",description:"Photos are added through reviews. Please create or edit a review to add photos."})},children:[s.jsx(z_,{className:"h-4 w-4 mr-2"}),"Upload First Photo"]})]})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(p=>s.jsx(h,{photo:p},p.id))})]})}class kue{static createGroup(t){return E(this,null,function*(){var r;try{const{data:n,error:a}=yield T.rpc("create_event_group",{p_event_id:t.event_id,p_name:t.name,p_description:t.description||null,p_is_public:(r=t.is_public)!=null?r:!0,p_max_members:t.max_members||null});if(a)throw a;return n}catch(n){throw console.error("Error creating group:",n),n}})}static getEventGroups(t){return E(this,null,function*(){return[]})}static joinGroup(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("join_event_group",{p_group_id:t});if(r)throw r}catch(r){throw console.error("Error joining group:",r),r}})}static leaveGroup(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("leave_event_group",{p_group_id:t});if(r)throw r}catch(r){throw console.error("Error leaving group:",r),r}})}static getGroupMembers(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_group_members").select(`
          *,
          user:users!event_group_members_user_id_fkey (
            user_id,
            name,
            avatar_url,
            bio
          )
        `).eq("group_id",t).order("joined_at",{ascending:!0});if(n)throw n;return r||[]}catch(r){throw console.error("Error getting group members:",r),r}})}static getUserGroups(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{data:n,error:a}=yield T.from("event_group_members").select(`
          group:event_groups (
            *,
            event:events (
              id,
              title,
              artist_name,
              event_date,
              poster_image_url
            ),
            creator:users!event_groups_created_by_user_id_fkey (
              name,
              avatar_url
            )
          )
        `).eq("user_id",t.id).order("joined_at",{ascending:!1});if(a)throw a;return(n||[]).map(i=>i.group).filter(Boolean)}catch(t){throw console.error("Error getting user groups:",t),t}})}static updateGroup(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("event_groups").update(H(M({},r),{updated_at:new Date().toISOString()})).eq("id",t);if(n)throw n}catch(n){throw console.error("Error updating group:",n),n}})}static deleteGroup(t){return E(this,null,function*(){try{const{error:r}=yield T.from("event_groups").delete().eq("id",t);if(r)throw r}catch(r){throw console.error("Error deleting group:",r),r}})}static isMember(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)return!1;const{data:a}=yield T.from("event_group_members").select("id").eq("group_id",t).eq("user_id",r.id).single();return!!a}catch(r){return!1}})}static getGroup(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_groups").select(`
          *,
          event:jambase_events (
            id,
            title,
            artist_name,
            venue_name,
            event_date,
            poster_image_url
          ),
          creator:profiles!event_groups_created_by_user_id_fkey (
            name,
            avatar_url
          )
        `).eq("id",t).single();if(n)throw n;return r}catch(r){throw console.error("Error getting group:",r),r}})}}function Eue({open:e,onClose:t,event:r,onGroupCreated:n}){const{toast:a}=Rr(),[i,o]=x.useState(!1),[l,c]=x.useState({name:"",description:"",is_public:!0,max_members:""}),d=p=>{const{name:g,value:v}=p.target;c(y=>H(M({},y),{[g]:v}))},u=p=>E(this,null,function*(){if(p.preventDefault(),!l.name.trim()){a({title:"Group name required",description:"Please enter a name for your group",variant:"destructive"});return}o(!0);try{const g=yield kue.createGroup({event_id:r.id,name:l.name.trim(),description:l.description.trim()||void 0,is_public:l.is_public,max_members:l.max_members?parseInt(l.max_members):void 0});a({title:"Group Created! ",description:`${l.name} is ready for members`}),n==null||n(g),f()}catch(g){console.error("Error creating group:",g),a({title:"Error",description:g instanceof Error?g.message:"Failed to create group",variant:"destructive"})}finally{o(!1)}}),f=()=>{i||(c({name:"",description:"",is_public:!0,max_members:""}),t())},h=p=>new Date(p).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"});return s.jsx(pn,{open:e,onOpenChange:f,children:s.jsxs(dn,{className:"sm:max-w-[550px]",children:[s.jsxs(Vn,{children:[s.jsxs(bn,{className:"flex items-center gap-2",children:[s.jsx(zr,{className:"h-5 w-5 text-purple-600"}),"Create Event Group"]}),s.jsx(os,{children:"Start a community for this event. Chat, share plans, and meet up!"})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[s.jsx("p",{className:"font-semibold text-sm mb-1",children:r.title}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-700",children:[s.jsx(It,{className:"h-3 w-3"}),s.jsx("span",{children:h(r.event_date)})]})]}),s.jsxs("form",{onSubmit:u,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ht,{htmlFor:"name",children:["Group Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Ar,{id:"name",name:"name",placeholder:"e.g., Taylor Swift Squad, VIP Section Crew",value:l.name,onChange:d,disabled:i,maxLength:50})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"description",children:"Description (Optional)"}),s.jsx(ys,{id:"description",name:"description",placeholder:"What's this group about?",value:l.description,onChange:d,disabled:i,rows:3,maxLength:200})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(Ht,{children:"Privacy"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-start p-3 border rounded-lg cursor-pointer",children:[s.jsx("input",{type:"radio",name:"privacy",checked:l.is_public,onChange:()=>c(p=>H(M({},p),{is_public:!0})),disabled:i,className:"mt-0.5 mr-3"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ki,{className:"h-4 w-4 text-green-600"}),s.jsx("span",{className:"font-medium text-sm",children:"Public"})]}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Anyone can find and join this group"})]})]}),s.jsxs("label",{className:"flex items-start p-3 border rounded-lg cursor-pointer",children:[s.jsx("input",{type:"radio",name:"privacy",checked:!l.is_public,onChange:()=>c(p=>H(M({},p),{is_public:!1})),disabled:i,className:"mt-0.5 mr-3"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ev,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm",children:"Private"})]}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Only you can invite members"})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"max_members",children:"Max Members (Optional)"}),s.jsx(Ar,{id:"max_members",name:"max_members",type:"number",placeholder:"Leave blank for unlimited",value:l.max_members,onChange:d,disabled:i,min:"2",max:"100"})]}),s.jsxs(Nh,{children:[s.jsx(le,{type:"button",variant:"outline",onClick:f,disabled:i,children:"Cancel"}),s.jsx(le,{type:"submit",disabled:i||!l.name.trim(),children:i?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(zr,{className:"w-4 h-4 mr-2"}),"Create Group"]})})]})]})]})})}class Yf{static isUserVisible(t,r,n=!1){if(t.user_id===r||n)return!0;const a=t.avatar_url&&t.avatar_url.trim()!=="",i=t.is_public_profile===!0;return a&&i}static filterVisibleUsers(t,r,n=[]){return t.filter(a=>{const i=n.includes(a.user_id);return this.isUserVisible(a,r,i)})}static isVisibleInSearch(t,r,n=!1){return t.user_id===r,!0}static isVisibleForMatching(t,r,n=!1){if(t.user_id===r||n)return!0;const a=t.avatar_url&&t.avatar_url.trim()!=="",i=t.is_public_profile===!0;return a&&i}static formatLastActive(t){if(!t)return"Recently";try{const r=typeof t=="string"?new Date(t):t,a=new Date().getTime()-r.getTime(),i=Math.floor(a/(1e3*60)),o=Math.floor(a/(1e3*60*60)),l=Math.floor(a/(1e3*60*60*24));return i<1?"Just now":i<60?`${i}m ago`:o<24?`${o}h ago`:l<7?`${l}d ago`:tw(r,{addSuffix:!0})}catch(r){return console.error("Error formatting last active time:",r),"Recently"}}static updateLastActive(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("update_user_last_active",{user_id_param:t});r&&console.error("Error updating last active:",r)}catch(r){console.error("Failed to update last active:",r)}})}static getUserVisibilitySettings(t){return E(this,null,function*(){var r;try{const{data:n,error:a}=yield T.from("users").select("avatar_url, is_public_profile, last_active_at").eq("user_id",t).single();return a?(console.error("Error fetching visibility settings:",a),null):{has_avatar:!!(n!=null&&n.avatar_url),is_public_profile:(r=n==null?void 0:n.is_public_profile)!=null?r:!0,last_active_at:(n==null?void 0:n.last_active_at)||new Date().toISOString()}}catch(n){return console.error("Failed to fetch visibility settings:",n),null}})}static setProfileVisibility(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("users").update({is_public_profile:r}).eq("user_id",t);return n?(console.error("Error updating profile visibility:",n),!1):!0}catch(n){return console.error("Failed to update profile visibility:",n),!1}})}static hasProfilePicture(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("users").select("avatar_url").eq("user_id",t).single();return n?(console.error("Error checking profile picture:",n),!1):!!(r!=null&&r.avatar_url&&r.avatar_url.trim()!=="")}catch(r){return console.error("Failed to check profile picture:",r),!1}})}static getFriendIds(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);return n?(console.error("Error fetching friends:",n),[]):(r||[]).map(a=>a.user_id===t?a.related_user_id:a.user_id)}catch(r){return console.error("Failed to fetch friends:",r),[]}})}}const Cue=({friend:e,isOpen:t,onClose:r,onStartChat:n,onAddFriend:a,onUnfriend:i,onNavigateToProfile:o})=>t?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:9999},children:s.jsxs(He,{className:"w-full max-w-md max-h-[80vh] overflow-y-auto",children:[s.jsx(Er,{className:"pb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(qr,{className:"text-xl font-bold",children:"Profile"}),s.jsx(le,{variant:"ghost",size:"sm",onClick:r,className:"h-8 w-8 p-0",children:s.jsx(Gr,{className:"h-4 w-4"})})]})}),s.jsxs(et,{className:"space-y-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs(Vr,{className:"w-20 h-20 mx-auto mb-3",children:[s.jsx(sn,{src:e.avatar_url||void 0}),s.jsx(Wr,{className:"text-xl",children:e.name?e.name.split(" ").map(l=>l[0]).join(""):"F"})]}),s.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:e.name}),e.verified&&e.account_type&&s.jsx(mT,{accountType:e.account_type,verified:e.verified,size:"md"})]}),s.jsxs("p",{className:"text-gray-600 mb-2 text-sm",children:["@",e.username]}),(e.gender||e.birthday)&&s.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2 w-full",children:[e.gender&&s.jsx(Ke,{variant:"secondary",className:"text-xs",children:e.gender}),e.birthday&&s.jsx(Ke,{variant:"secondary",className:"text-xs",children:(()=>{const l=new Date(e.birthday),c=new Date;let d=c.getFullYear()-l.getFullYear();const u=c.getMonth()-l.getMonth();return(u<0||u===0&&c.getDate()<l.getDate())&&d--,`${d} years old`})()})]}),e.last_active_at&&s.jsxs(Ke,{variant:"secondary",className:"mb-2 flex items-center gap-1 text-xs mx-auto w-fit",children:[s.jsx(ga,{className:"w-3 h-3"}),Yf.formatLastActive(e.last_active_at)]}),s.jsxs(Ke,{variant:"secondary",className:"bg-blue-100 text-blue-800 text-xs",children:[s.jsx(Rs,{className:"w-3 h-3 mr-1"}),"Friend"]})]}),e.bio&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"About"}),s.jsx("p",{className:"text-gray-700 text-sm leading-relaxed px-2",children:e.bio})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx(It,{className:"w-3 h-3"}),s.jsxs("span",{children:["Member since ",(()=>{try{return Mt(ms(e.created_at),"MMMM yyyy")}catch(l){return e.created_at}})()]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Music Preferences"}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.jsxs(Ke,{variant:"outline",className:"text-xs",children:[s.jsx($t,{className:"w-3 h-3 mr-1"}),"Concert Lover"]}),s.jsxs(Ke,{variant:"outline",className:"text-xs",children:[s.jsx(ns,{className:"w-3 h-3 mr-1"}),"Live Music"]}),s.jsxs(Ke,{variant:"outline",className:"text-xs",children:[s.jsx(Qt,{className:"w-3 h-3 mr-1"}),"Music Enthusiast"]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Recent Activity"}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),s.jsx("span",{children:"Active now"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx($t,{className:"w-3 h-3"}),s.jsx("span",{children:"Recently reviewed a concert"})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-2 pt-3 border-t",children:[s.jsxs("div",{className:"flex gap-2",children:[a&&s.jsx(le,{variant:"outline",className:"flex-1 text-sm",size:"sm",onClick:l=>E(void 0,null,function*(){l.preventDefault(),l.stopPropagation(),console.log(" Add Friend button clicked for:",e.name,"ID:",e.user_id);try{yield a(e.user_id),console.log(" Add friend request completed")}catch(c){console.error(" Error in Add Friend:",c)}}),children:"Add Friend"}),s.jsxs(le,{variant:"outline",className:"flex-1 text-sm",size:"sm",onClick:l=>{l.preventDefault(),l.stopPropagation(),o&&(o(e.user_id),r())},children:[s.jsx(Rs,{className:"w-3 h-3 mr-1"}),"Full Profile"]}),s.jsxs(le,{className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white text-sm",size:"sm",onClick:l=>{l.preventDefault(),l.stopPropagation(),n&&n(e.user_id),r()},children:[s.jsx($n,{className:"w-3 h-3 mr-1"}),"Start Chat"]})]}),i&&s.jsxs(le,{variant:"destructive",className:"w-full text-sm",size:"sm",onClick:()=>E(void 0,null,function*(){try{yield i(e.user_id),r()}catch(l){console.error("Error unfriending user:",l)}}),children:[s.jsx(MF,{className:"w-3 h-3 mr-1"}),"Unfriend"]})]})]})]})}):null;function Fv(e){if(!e)return"";if(e.startsWith("$"))return e;if(e.includes("-")){const[t,r]=e.split("-");return`$${t.trim()}-$${r.trim()}`}return`$${e.trim()}`}function Pue(e){if(!e)return 0;const t=e.match(/\$?(\d+)/);return t?parseInt(t[1]):0}const AB=""+new URL("Synth_Placeholder-oP3veiyu.png",import.meta.url).href,Zl=e=>typeof e.rating=="number"?e.rating:0;function jT({artistName:e,venueName:t,artistId:r,venueId:n}){const[a,i]=x.useState({totalReviews:0,averageRating:0,loading:!0}),[o,l]=x.useState({totalReviews:0,averageRating:0,loading:!0}),[c,d]=x.useState([]),[u,f]=x.useState([]),[h,p]=x.useState("newest"),[g,v]=x.useState("newest"),[y,_]=x.useState(!1),[w,b]=x.useState(!1);x.useEffect(()=>{E(this,null,function*(){console.log(" ArtistVenueReviews - Searching for:",{artistName:e,venueName:t});try{let R=[];const{data:$}=yield T.from("artists").select("id, name").ilike("name",e).maybeSingle();if($){const{data:B,error:F}=yield T.from("events_with_artist_venue").select("id").eq("artist_id",$.id).limit(1e3);!F&&B&&(R=B)}if(R.length===0){const{data:B,error:F}=yield T.from("events_with_artist_venue").select("id").ilike("artist_name_normalized",`${e}%`).limit(500);!F&&B&&(R=B)}if(R.length===0){const{data:B,error:F}=yield T.from("events_with_artist_venue").select("id").ilike("artist_name_normalized",`%${e}%`).limit(500);if(F){console.error("Error fetching event IDs for artist:",F),i({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load artist reviews"});return}B&&(R=B)}const O=R.map(B=>B.id);if(O.length===0){i({totalReviews:0,averageRating:0,loading:!1});return}const{data:z,error:D}=yield T.from("reviews").select(`
            rating,
            review_text,
            created_at,
            event_id
          `).eq("is_public",!0).in("event_id",O);if(D)console.error("Error fetching artist reviews:",D),i({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load artist reviews"});else if(z&&z.length>0){const B=z.map(K=>Zl(K)).filter(K=>typeof K=="number"&&K>0),F=B.length,U=F>0?B.reduce((K,Z)=>K+Z,0)/F:0;i({totalReviews:F,averageRating:U,loading:!1});const{data:G,error:q}=yield T.from("reviews").select(`
              id,
              user_id,
              event_id,
              rating,
              artist_performance_rating,
              production_rating,
              venue_rating,
              location_rating,
              value_rating,
              artist_performance_feedback,
              production_feedback,
              venue_feedback,
              location_feedback,
              value_feedback,
              ticket_price_paid,
              review_text,
              created_at,
              mood_tags,
              genre_tags,
              reaction_emoji,
              photos
            `).eq("is_public",!0);if(!q&&G){const K=G.filter(re=>!0),Z=K.map(re=>re.user_id).filter(Boolean),{data:Y}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",Z),Q=K.map(re=>re.event_id).filter(Boolean),{data:X}=yield T.from("events_with_artist_venue").select("id, artist_id, venue_id, event_date, title, artist_name_normalized, venue_name_normalized").in("id",Q),ne=K.map(re=>{var xe,ie,se,V,ue,_e,ae,we,oe,ce,Ae;const ye=Y==null?void 0:Y.find(Be=>Be.user_id===re.user_id),ee=X==null?void 0:X.find(Be=>Be.id===re.event_id);return{id:re.id,rating:re.rating,artist_performance_rating:(xe=re.artist_performance_rating)!=null?xe:void 0,production_rating:(ie=re.production_rating)!=null?ie:void 0,venue_rating:(se=re.venue_rating)!=null?se:void 0,location_rating:(V=re.location_rating)!=null?V:void 0,value_rating:(ue=re.value_rating)!=null?ue:void 0,artist_performance_feedback:(_e=re.artist_performance_feedback)!=null?_e:void 0,production_feedback:(ae=re.production_feedback)!=null?ae:void 0,venue_feedback:(we=re.venue_feedback)!=null?we:void 0,location_feedback:(oe=re.location_feedback)!=null?oe:void 0,value_feedback:(ce=re.value_feedback)!=null?ce:void 0,ticket_price_paid:(Ae=re.ticket_price_paid)!=null?Ae:void 0,review_text:re.review_text,created_at:re.created_at,reviewer_name:(ye==null?void 0:ye.name)||"Anonymous",reviewer_avatar:(ye==null?void 0:ye.avatar_url)||null,event_title:(ee==null?void 0:ee.title)||"",event_date:(ee==null?void 0:ee.event_date)||"",mood_tags:re.mood_tags||[],genre_tags:re.genre_tags||[],reaction_emoji:re.reaction_emoji||null,artist_name:(ee==null?void 0:ee.artist_name_normalized)||"",venue_name:(ee==null?void 0:ee.venue_name_normalized)||"",photos:Array.isArray(re.photos)?re.photos:[],category_average:Zl(re)}}).filter(re=>re.artist_name&&re.artist_name.toLowerCase().includes(e.toLowerCase()));d(ne)}}else i({totalReviews:0,averageRating:0,loading:!1})}catch(R){console.error("Error fetching artist reviews:",R),i({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load artist reviews"}),d([])}try{const{data:R,error:$}=yield T.from("events_with_artist_venue").select("id").ilike("venue_name_normalized",`%${t}%`);if($){console.error("Error fetching event IDs for venue:",$),l({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load venue reviews"});return}const O=(R==null?void 0:R.map(U=>U.id))||[];if(O.length===0){l({totalReviews:0,averageRating:0,loading:!1});return}const{data:z,error:D}=yield T.from("reviews").select(`
            rating,
            review_text,
            created_at,
            event_id
          `).eq("is_public",!0).in("event_id",O),{data:B,error:F}=O.length>0?yield T.from("reviews").select(`
                id,
                event_id
              `).eq("is_public",!0).in("event_id",O):{data:[],error:null};if(D)console.error("Error fetching venue reviews:",D),l({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load venue reviews"});else if(z&&z.length>0){const U=z.map(Y=>Zl(Y)).filter(Y=>typeof Y=="number"&&Y>0),G=U.length,q=G>0?U.reduce((Y,Q)=>Y+Q,0)/G:0;l({totalReviews:G,averageRating:q,loading:!1});const{data:K,error:Z}=yield T.from("reviews").select(`
              id,
              user_id,
              event_id,
              rating,
              artist_performance_rating,
              production_rating,
              venue_rating,
              location_rating,
              value_rating,
              artist_performance_feedback,
              production_feedback,
              venue_feedback,
              location_feedback,
              value_feedback,
              ticket_price_paid,
              review_text,
              created_at,
              mood_tags,
              genre_tags,
              reaction_emoji,
              photos
            `).eq("is_public",!0);if(!Z&&K){const Y=K.filter(ee=>ee.venue_rating||ee.artist_performance_rating||ee.production_rating||ee.location_rating||ee.value_rating),Q=Y.map(ee=>ee.user_id).filter(Boolean),{data:X}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",Q),ne=Y.map(ee=>ee.event_id).filter(Boolean),{data:re}=yield T.from("events_with_artist_venue").select("id, artist_id, venue_id, event_date, title, artist_name_normalized, venue_name_normalized").in("id",ne),ye=Y.map(ee=>{var ie,se,V,ue,_e,ae,we,oe,ce,Ae,Be;const de=X==null?void 0:X.find(Xe=>Xe.user_id===ee.user_id),xe=re==null?void 0:re.find(Xe=>Xe.id===ee.event_id);return{id:ee.id,rating:ee.rating,artist_performance_rating:(ie=ee.artist_performance_rating)!=null?ie:void 0,production_rating:(se=ee.production_rating)!=null?se:void 0,venue_rating:(V=ee.venue_rating)!=null?V:void 0,location_rating:(ue=ee.location_rating)!=null?ue:void 0,value_rating:(_e=ee.value_rating)!=null?_e:void 0,artist_performance_feedback:(ae=ee.artist_performance_feedback)!=null?ae:void 0,production_feedback:(we=ee.production_feedback)!=null?we:void 0,venue_feedback:(oe=ee.venue_feedback)!=null?oe:void 0,location_feedback:(ce=ee.location_feedback)!=null?ce:void 0,value_feedback:(Ae=ee.value_feedback)!=null?Ae:void 0,ticket_price_paid:(Be=ee.ticket_price_paid)!=null?Be:void 0,review_text:ee.review_text,created_at:ee.created_at,reviewer_name:(de==null?void 0:de.name)||"Anonymous",reviewer_avatar:(de==null?void 0:de.avatar_url)||null,event_title:(xe==null?void 0:xe.title)||"",event_date:(xe==null?void 0:xe.event_date)||"",mood_tags:ee.mood_tags||[],genre_tags:ee.genre_tags||[],reaction_emoji:ee.reaction_emoji||null,artist_name:(xe==null?void 0:xe.artist_name)||"",venue_name:(xe==null?void 0:xe.venue_name)||"",photos:Array.isArray(ee.photos)?ee.photos:[],category_average:Zl(ee)}}).filter(ee=>{const de=ee.venue_name&&ee.venue_name.toLowerCase().includes(t.toLowerCase());return console.log(" Venue matching:",{reviewVenue:ee.venue_name,searchVenue:t,matches:de}),de});f(ye)}}else l({totalReviews:0,averageRating:0,loading:!1})}catch(R){console.error("Error fetching venue reviews:",R),l({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load venue reviews"}),f([])}})},[e,t]);const N=(A,R)=>{const $=[...A];switch(R){case"newest":return $.sort((O,z)=>new Date(z.created_at).getTime()-new Date(O.created_at).getTime());case"oldest":return $.sort((O,z)=>new Date(O.created_at).getTime()-new Date(z.created_at).getTime());case"highest_rating":return $.sort((O,z)=>{var F,U;const D=(F=O.category_average)!=null?F:Zl(O);return(((U=z.category_average)!=null?U:Zl(z))||0)-(D||0)});case"lowest_rating":return $.sort((O,z)=>{var F,U;const D=(F=O.category_average)!=null?F:Zl(O),B=(U=z.category_average)!=null?U:Zl(z);return(D||0)-(B||0)});default:return $}},S=A=>{const R=[],$=Math.floor(A),O=A%1>=.5;for(let D=0;D<$;D++)R.push(s.jsx(Qt,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},D));O&&R.push(s.jsx(Qt,{className:"w-4 h-4 fill-yellow-400/50 text-yellow-400"},"half"));const z=5-Math.ceil(A);for(let D=0;D<z;D++)R.push(s.jsx(Qt,{className:"w-4 h-4 text-gray-300"},`empty-${D}`));return R},k=A=>new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),P=(A,R=!0)=>{var O;const $=(O=A.category_average)!=null?O:Zl(A);return s.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("img",{src:A.reviewer_avatar||AB,alt:A.reviewer_name,className:"w-8 h-8 rounded-full"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-sm",children:A.reviewer_name}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(It,{className:"w-3 h-3"}),k(A.event_date)]}),R&&A.venue_name&&s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx(gr,{className:"w-3 h-3"}),A.venue_name]}),!R&&A.artist_name&&s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx($t,{className:"w-3 h-3"}),A.artist_name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[S($),s.jsx("span",{className:"text-sm font-medium ml-1",children:$.toFixed(1)})]})]}),A.review_text&&s.jsx("p",{className:"text-sm text-gray-700",children:A.review_text}),[{label:"Artist performance",rating:A.artist_performance_rating,feedback:A.artist_performance_feedback},{label:"Production",rating:A.production_rating,feedback:A.production_feedback},{label:"Venue",rating:A.venue_rating,feedback:A.venue_feedback},{label:"Location",rating:A.location_rating,feedback:A.location_feedback},{label:"Value",rating:A.value_rating,feedback:A.value_feedback}].filter(({rating:z,feedback:D})=>z||D).map(({label:z,rating:D,feedback:B})=>s.jsxs("div",{className:"text-sm border-l-4 border-pink-200 pl-2 mt-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium text-gray-600",children:z}),typeof D=="number"&&s.jsx("span",{className:"text-xs text-gray-500",children:D.toFixed(1)})]}),B&&s.jsxs("div",{className:"text-xs text-gray-700 italic",children:["",B,""]})]},z)),A.mood_tags&&A.mood_tags.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:A.mood_tags.map((z,D)=>s.jsx(Ke,{variant:"secondary",className:"text-xs",children:z},D))}),A.reaction_emoji&&s.jsx("div",{className:"text-lg",children:A.reaction_emoji})]},A.id)};return s.jsxs("div",{className:"space-y-6 mb-6",children:[s.jsxs(He,{className:"border-gray-200",children:[s.jsx(Er,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx($t,{className:"w-5 h-5 text-pink-500"}),s.jsx(qr,{className:"text-lg",children:"Artist Reviews"})]}),a.totalReviews>0&&s.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>_(!y),className:"flex items-center gap-1",children:[y?s.jsx(Mo,{className:"w-4 h-4"}):s.jsx(Ta,{className:"w-4 h-4"}),y?"Hide":"View"," Reviews"]})]})}),s.jsx(et,{className:"pt-0",children:a.loading?s.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."}):a.totalReviews>0?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[S(a.averageRating),s.jsx("span",{className:"text-sm font-medium",children:a.averageRating.toFixed(1)}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",a.totalReviews," review",a.totalReviews!==1?"s":"",")"]})]}),y&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),s.jsxs("select",{value:h,onChange:A=>p(A.target.value),className:"w-40 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500",children:[s.jsx("option",{value:"newest",children:"Newest"}),s.jsx("option",{value:"oldest",children:"Oldest"}),s.jsx("option",{value:"highest_rating",children:"Highest Rating"}),s.jsx("option",{value:"lowest_rating",children:"Lowest Rating"})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:N(c,h).map(A=>P(A,!0))})]})]}):s.jsxs("div",{className:"text-sm text-gray-500",children:["No reviews yet for ",e]})})]}),s.jsxs(He,{className:"border-gray-200",children:[s.jsx(Er,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(gr,{className:"w-5 h-5 text-pink-500"}),s.jsx(qr,{className:"text-lg",children:"Venue Reviews"})]}),o.totalReviews>0&&s.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>b(!w),className:"flex items-center gap-1",children:[w?s.jsx(Mo,{className:"w-4 h-4"}):s.jsx(Ta,{className:"w-4 h-4"}),w?"Hide":"View"," Reviews"]})]})}),s.jsx(et,{className:"pt-0",children:o.loading?s.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."}):o.totalReviews>0?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[S(o.averageRating),s.jsx("span",{className:"text-sm font-medium",children:o.averageRating.toFixed(1)}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",o.totalReviews," review",o.totalReviews!==1?"s":"",")"]})]}),w&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),s.jsxs("select",{value:g,onChange:A=>v(A.target.value),className:"w-40 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500",children:[s.jsx("option",{value:"newest",children:"Newest"}),s.jsx("option",{value:"oldest",children:"Oldest"}),s.jsx("option",{value:"highest_rating",children:"Highest Rating"}),s.jsx("option",{value:"lowest_rating",children:"Lowest Rating"})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:N(u,g).map(A=>P(A,!1))})]})]}):s.jsxs("div",{className:"text-sm text-gray-500",children:["No reviews yet for ",t]})})]})]})}function RB(e,t){const r=x.useRef(t);x.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}function Tue(e,t,r){t.center!==r.center&&e.setLatLng(t.center),t.radius!=null&&t.radius!==r.radius&&e.setRadius(t.radius)}const Aue=1;function Rue(e){return Object.freeze({__version:Aue,map:e})}function NT(e,t){return Object.freeze(M(M({},e),t))}const OB=x.createContext(null),MB=OB.Provider;function b1(){const e=x.useContext(OB);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function DB(e){function t(r,n){const{instance:a,context:i}=e(r).current;return x.useImperativeHandle(n,()=>a),r.children==null?null:J.createElement(MB,{value:i},r.children)}return x.forwardRef(t)}function Oue(e){function t(r,n){const[a,i]=x.useState(!1),{instance:o}=e(r,i).current;x.useImperativeHandle(n,()=>o),x.useEffect(function(){a&&o.update()},[o,a,r.children]);const l=o._contentNode;return l?so.createPortal(r.children,l):null}return x.forwardRef(t)}function Mue(e){function t(r,n){const{instance:a}=e(r).current;return x.useImperativeHandle(n,()=>a),null}return x.forwardRef(t)}function ST(e,t){const r=x.useRef();x.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function j1(e,t){var n;const r=(n=e.pane)!=null?n:t.pane;return r?H(M({},e),{pane:r}):e}function Due(e,t){return function(n,a){const i=b1(),o=e(j1(n,i),i);return RB(i.map,n.attribution),ST(o.current,n.eventHandlers),t(o.current,i,n,a),o}}var _2={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,n){n(t)})(na,function(r){var n="1.9.4";function a(m){var j,C,I,W;for(C=1,I=arguments.length;C<I;C++){W=arguments[C];for(j in W)m[j]=W[j]}return m}var i=Object.create||function(){function m(){}return function(j){return m.prototype=j,new m}}();function o(m,j){var C=Array.prototype.slice;if(m.bind)return m.bind.apply(m,C.call(arguments,1));var I=C.call(arguments,2);return function(){return m.apply(j,I.length?I.concat(C.call(arguments)):arguments)}}var l=0;function c(m){return"_leaflet_id"in m||(m._leaflet_id=++l),m._leaflet_id}function d(m,j,C){var I,W,te,be;return be=function(){I=!1,W&&(te.apply(C,W),W=!1)},te=function(){I?W=arguments:(m.apply(C,arguments),setTimeout(be,j),I=!0)},te}function u(m,j,C){var I=j[1],W=j[0],te=I-W;return m===I&&C?m:((m-W)%te+te)%te+W}function f(){return!1}function h(m,j){if(j===!1)return m;var C=Math.pow(10,j===void 0?6:j);return Math.round(m*C)/C}function p(m){return m.trim?m.trim():m.replace(/^\s+|\s+$/g,"")}function g(m){return p(m).split(/\s+/)}function v(m,j){Object.prototype.hasOwnProperty.call(m,"options")||(m.options=m.options?i(m.options):{});for(var C in j)m.options[C]=j[C];return m.options}function y(m,j,C){var I=[];for(var W in m)I.push(encodeURIComponent(C?W.toUpperCase():W)+"="+encodeURIComponent(m[W]));return(!j||j.indexOf("?")===-1?"?":"&")+I.join("&")}var _=/\{ *([\w_ -]+) *\}/g;function w(m,j){return m.replace(_,function(C,I){var W=j[I];if(W===void 0)throw new Error("No value provided for variable "+C);return typeof W=="function"&&(W=W(j)),W})}var b=Array.isArray||function(m){return Object.prototype.toString.call(m)==="[object Array]"};function N(m,j){for(var C=0;C<m.length;C++)if(m[C]===j)return C;return-1}var S="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function k(m){return window["webkit"+m]||window["moz"+m]||window["ms"+m]}var P=0;function A(m){var j=+new Date,C=Math.max(0,16-(j-P));return P=j+C,window.setTimeout(m,C)}var R=window.requestAnimationFrame||k("RequestAnimationFrame")||A,$=window.cancelAnimationFrame||k("CancelAnimationFrame")||k("CancelRequestAnimationFrame")||function(m){window.clearTimeout(m)};function O(m,j,C){if(C&&R===A)m.call(j);else return R.call(window,o(m,j))}function z(m){m&&$.call(window,m)}var D={__proto__:null,extend:a,create:i,bind:o,get lastId(){return l},stamp:c,throttle:d,wrapNum:u,falseFn:f,formatNum:h,trim:p,splitWords:g,setOptions:v,getParamString:y,template:w,isArray:b,indexOf:N,emptyImageUrl:S,requestFn:R,cancelFn:$,requestAnimFrame:O,cancelAnimFrame:z};function B(){}B.extend=function(m){var j=function(){v(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},C=j.__super__=this.prototype,I=i(C);I.constructor=j,j.prototype=I;for(var W in this)Object.prototype.hasOwnProperty.call(this,W)&&W!=="prototype"&&W!=="__super__"&&(j[W]=this[W]);return m.statics&&a(j,m.statics),m.includes&&(F(m.includes),a.apply(null,[I].concat(m.includes))),a(I,m),delete I.statics,delete I.includes,I.options&&(I.options=C.options?i(C.options):{},a(I.options,m.options)),I._initHooks=[],I.callInitHooks=function(){if(!this._initHooksCalled){C.callInitHooks&&C.callInitHooks.call(this),this._initHooksCalled=!0;for(var te=0,be=I._initHooks.length;te<be;te++)I._initHooks[te].call(this)}},j},B.include=function(m){var j=this.prototype.options;return a(this.prototype,m),m.options&&(this.prototype.options=j,this.mergeOptions(m.options)),this},B.mergeOptions=function(m){return a(this.prototype.options,m),this},B.addInitHook=function(m){var j=Array.prototype.slice.call(arguments,1),C=typeof m=="function"?m:function(){this[m].apply(this,j)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(C),this};function F(m){if(!(typeof L=="undefined"||!L||!L.Mixin)){m=b(m)?m:[m];for(var j=0;j<m.length;j++)m[j]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var U={on:function(m,j,C){if(typeof m=="object")for(var I in m)this._on(I,m[I],j);else{m=g(m);for(var W=0,te=m.length;W<te;W++)this._on(m[W],j,C)}return this},off:function(m,j,C){if(!arguments.length)delete this._events;else if(typeof m=="object")for(var I in m)this._off(I,m[I],j);else{m=g(m);for(var W=arguments.length===1,te=0,be=m.length;te<be;te++)W?this._off(m[te]):this._off(m[te],j,C)}return this},_on:function(m,j,C,I){if(typeof j!="function"){console.warn("wrong listener type: "+typeof j);return}if(this._listens(m,j,C)===!1){C===this&&(C=void 0);var W={fn:j,ctx:C};I&&(W.once=!0),this._events=this._events||{},this._events[m]=this._events[m]||[],this._events[m].push(W)}},_off:function(m,j,C){var I,W,te;if(this._events&&(I=this._events[m],!!I)){if(arguments.length===1){if(this._firingCount)for(W=0,te=I.length;W<te;W++)I[W].fn=f;delete this._events[m];return}if(typeof j!="function"){console.warn("wrong listener type: "+typeof j);return}var be=this._listens(m,j,C);if(be!==!1){var $e=I[be];this._firingCount&&($e.fn=f,this._events[m]=I=I.slice()),I.splice(be,1)}}},fire:function(m,j,C){if(!this.listens(m,C))return this;var I=a({},j,{type:m,target:this,sourceTarget:j&&j.sourceTarget||this});if(this._events){var W=this._events[m];if(W){this._firingCount=this._firingCount+1||1;for(var te=0,be=W.length;te<be;te++){var $e=W[te],Ve=$e.fn;$e.once&&this.off(m,Ve,$e.ctx),Ve.call($e.ctx||this,I)}this._firingCount--}}return C&&this._propagateEvent(I),this},listens:function(m,j,C,I){typeof m!="string"&&console.warn('"string" type argument expected');var W=j;typeof j!="function"&&(I=!!j,W=void 0,C=void 0);var te=this._events&&this._events[m];if(te&&te.length&&this._listens(m,W,C)!==!1)return!0;if(I){for(var be in this._eventParents)if(this._eventParents[be].listens(m,j,C,I))return!0}return!1},_listens:function(m,j,C){if(!this._events)return!1;var I=this._events[m]||[];if(!j)return!!I.length;C===this&&(C=void 0);for(var W=0,te=I.length;W<te;W++)if(I[W].fn===j&&I[W].ctx===C)return W;return!1},once:function(m,j,C){if(typeof m=="object")for(var I in m)this._on(I,m[I],j,!0);else{m=g(m);for(var W=0,te=m.length;W<te;W++)this._on(m[W],j,C,!0)}return this},addEventParent:function(m){return this._eventParents=this._eventParents||{},this._eventParents[c(m)]=m,this},removeEventParent:function(m){return this._eventParents&&delete this._eventParents[c(m)],this},_propagateEvent:function(m){for(var j in this._eventParents)this._eventParents[j].fire(m.type,a({layer:m.target,propagatedFrom:m.target},m),!0)}};U.addEventListener=U.on,U.removeEventListener=U.clearAllEventListeners=U.off,U.addOneTimeEventListener=U.once,U.fireEvent=U.fire,U.hasEventListeners=U.listens;var G=B.extend(U);function q(m,j,C){this.x=C?Math.round(m):m,this.y=C?Math.round(j):j}var K=Math.trunc||function(m){return m>0?Math.floor(m):Math.ceil(m)};q.prototype={clone:function(){return new q(this.x,this.y)},add:function(m){return this.clone()._add(Z(m))},_add:function(m){return this.x+=m.x,this.y+=m.y,this},subtract:function(m){return this.clone()._subtract(Z(m))},_subtract:function(m){return this.x-=m.x,this.y-=m.y,this},divideBy:function(m){return this.clone()._divideBy(m)},_divideBy:function(m){return this.x/=m,this.y/=m,this},multiplyBy:function(m){return this.clone()._multiplyBy(m)},_multiplyBy:function(m){return this.x*=m,this.y*=m,this},scaleBy:function(m){return new q(this.x*m.x,this.y*m.y)},unscaleBy:function(m){return new q(this.x/m.x,this.y/m.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=K(this.x),this.y=K(this.y),this},distanceTo:function(m){m=Z(m);var j=m.x-this.x,C=m.y-this.y;return Math.sqrt(j*j+C*C)},equals:function(m){return m=Z(m),m.x===this.x&&m.y===this.y},contains:function(m){return m=Z(m),Math.abs(m.x)<=Math.abs(this.x)&&Math.abs(m.y)<=Math.abs(this.y)},toString:function(){return"Point("+h(this.x)+", "+h(this.y)+")"}};function Z(m,j,C){return m instanceof q?m:b(m)?new q(m[0],m[1]):m==null?m:typeof m=="object"&&"x"in m&&"y"in m?new q(m.x,m.y):new q(m,j,C)}function Y(m,j){if(m)for(var C=j?[m,j]:m,I=0,W=C.length;I<W;I++)this.extend(C[I])}Y.prototype={extend:function(m){var j,C;if(!m)return this;if(m instanceof q||typeof m[0]=="number"||"x"in m)j=C=Z(m);else if(m=Q(m),j=m.min,C=m.max,!j||!C)return this;return!this.min&&!this.max?(this.min=j.clone(),this.max=C.clone()):(this.min.x=Math.min(j.x,this.min.x),this.max.x=Math.max(C.x,this.max.x),this.min.y=Math.min(j.y,this.min.y),this.max.y=Math.max(C.y,this.max.y)),this},getCenter:function(m){return Z((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,m)},getBottomLeft:function(){return Z(this.min.x,this.max.y)},getTopRight:function(){return Z(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(m){var j,C;return typeof m[0]=="number"||m instanceof q?m=Z(m):m=Q(m),m instanceof Y?(j=m.min,C=m.max):j=C=m,j.x>=this.min.x&&C.x<=this.max.x&&j.y>=this.min.y&&C.y<=this.max.y},intersects:function(m){m=Q(m);var j=this.min,C=this.max,I=m.min,W=m.max,te=W.x>=j.x&&I.x<=C.x,be=W.y>=j.y&&I.y<=C.y;return te&&be},overlaps:function(m){m=Q(m);var j=this.min,C=this.max,I=m.min,W=m.max,te=W.x>j.x&&I.x<C.x,be=W.y>j.y&&I.y<C.y;return te&&be},isValid:function(){return!!(this.min&&this.max)},pad:function(m){var j=this.min,C=this.max,I=Math.abs(j.x-C.x)*m,W=Math.abs(j.y-C.y)*m;return Q(Z(j.x-I,j.y-W),Z(C.x+I,C.y+W))},equals:function(m){return m?(m=Q(m),this.min.equals(m.getTopLeft())&&this.max.equals(m.getBottomRight())):!1}};function Q(m,j){return!m||m instanceof Y?m:new Y(m,j)}function X(m,j){if(m)for(var C=j?[m,j]:m,I=0,W=C.length;I<W;I++)this.extend(C[I])}X.prototype={extend:function(m){var j=this._southWest,C=this._northEast,I,W;if(m instanceof re)I=m,W=m;else if(m instanceof X){if(I=m._southWest,W=m._northEast,!I||!W)return this}else return m?this.extend(ye(m)||ne(m)):this;return!j&&!C?(this._southWest=new re(I.lat,I.lng),this._northEast=new re(W.lat,W.lng)):(j.lat=Math.min(I.lat,j.lat),j.lng=Math.min(I.lng,j.lng),C.lat=Math.max(W.lat,C.lat),C.lng=Math.max(W.lng,C.lng)),this},pad:function(m){var j=this._southWest,C=this._northEast,I=Math.abs(j.lat-C.lat)*m,W=Math.abs(j.lng-C.lng)*m;return new X(new re(j.lat-I,j.lng-W),new re(C.lat+I,C.lng+W))},getCenter:function(){return new re((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new re(this.getNorth(),this.getWest())},getSouthEast:function(){return new re(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(m){typeof m[0]=="number"||m instanceof re||"lat"in m?m=ye(m):m=ne(m);var j=this._southWest,C=this._northEast,I,W;return m instanceof X?(I=m.getSouthWest(),W=m.getNorthEast()):I=W=m,I.lat>=j.lat&&W.lat<=C.lat&&I.lng>=j.lng&&W.lng<=C.lng},intersects:function(m){m=ne(m);var j=this._southWest,C=this._northEast,I=m.getSouthWest(),W=m.getNorthEast(),te=W.lat>=j.lat&&I.lat<=C.lat,be=W.lng>=j.lng&&I.lng<=C.lng;return te&&be},overlaps:function(m){m=ne(m);var j=this._southWest,C=this._northEast,I=m.getSouthWest(),W=m.getNorthEast(),te=W.lat>j.lat&&I.lat<C.lat,be=W.lng>j.lng&&I.lng<C.lng;return te&&be},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(m,j){return m?(m=ne(m),this._southWest.equals(m.getSouthWest(),j)&&this._northEast.equals(m.getNorthEast(),j)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ne(m,j){return m instanceof X?m:new X(m,j)}function re(m,j,C){if(isNaN(m)||isNaN(j))throw new Error("Invalid LatLng object: ("+m+", "+j+")");this.lat=+m,this.lng=+j,C!==void 0&&(this.alt=+C)}re.prototype={equals:function(m,j){if(!m)return!1;m=ye(m);var C=Math.max(Math.abs(this.lat-m.lat),Math.abs(this.lng-m.lng));return C<=(j===void 0?1e-9:j)},toString:function(m){return"LatLng("+h(this.lat,m)+", "+h(this.lng,m)+")"},distanceTo:function(m){return de.distance(this,ye(m))},wrap:function(){return de.wrapLatLng(this)},toBounds:function(m){var j=180*m/40075017,C=j/Math.cos(Math.PI/180*this.lat);return ne([this.lat-j,this.lng-C],[this.lat+j,this.lng+C])},clone:function(){return new re(this.lat,this.lng,this.alt)}};function ye(m,j,C){return m instanceof re?m:b(m)&&typeof m[0]!="object"?m.length===3?new re(m[0],m[1],m[2]):m.length===2?new re(m[0],m[1]):null:m==null?m:typeof m=="object"&&"lat"in m?new re(m.lat,"lng"in m?m.lng:m.lon,m.alt):j===void 0?null:new re(m,j,C)}var ee={latLngToPoint:function(m,j){var C=this.projection.project(m),I=this.scale(j);return this.transformation._transform(C,I)},pointToLatLng:function(m,j){var C=this.scale(j),I=this.transformation.untransform(m,C);return this.projection.unproject(I)},project:function(m){return this.projection.project(m)},unproject:function(m){return this.projection.unproject(m)},scale:function(m){return 256*Math.pow(2,m)},zoom:function(m){return Math.log(m/256)/Math.LN2},getProjectedBounds:function(m){if(this.infinite)return null;var j=this.projection.bounds,C=this.scale(m),I=this.transformation.transform(j.min,C),W=this.transformation.transform(j.max,C);return new Y(I,W)},infinite:!1,wrapLatLng:function(m){var j=this.wrapLng?u(m.lng,this.wrapLng,!0):m.lng,C=this.wrapLat?u(m.lat,this.wrapLat,!0):m.lat,I=m.alt;return new re(C,j,I)},wrapLatLngBounds:function(m){var j=m.getCenter(),C=this.wrapLatLng(j),I=j.lat-C.lat,W=j.lng-C.lng;if(I===0&&W===0)return m;var te=m.getSouthWest(),be=m.getNorthEast(),$e=new re(te.lat-I,te.lng-W),Ve=new re(be.lat-I,be.lng-W);return new X($e,Ve)}},de=a({},ee,{wrapLng:[-180,180],R:6371e3,distance:function(m,j){var C=Math.PI/180,I=m.lat*C,W=j.lat*C,te=Math.sin((j.lat-m.lat)*C/2),be=Math.sin((j.lng-m.lng)*C/2),$e=te*te+Math.cos(I)*Math.cos(W)*be*be,Ve=2*Math.atan2(Math.sqrt($e),Math.sqrt(1-$e));return this.R*Ve}}),xe=6378137,ie={R:xe,MAX_LATITUDE:85.0511287798,project:function(m){var j=Math.PI/180,C=this.MAX_LATITUDE,I=Math.max(Math.min(C,m.lat),-C),W=Math.sin(I*j);return new q(this.R*m.lng*j,this.R*Math.log((1+W)/(1-W))/2)},unproject:function(m){var j=180/Math.PI;return new re((2*Math.atan(Math.exp(m.y/this.R))-Math.PI/2)*j,m.x*j/this.R)},bounds:function(){var m=xe*Math.PI;return new Y([-m,-m],[m,m])}()};function se(m,j,C,I){if(b(m)){this._a=m[0],this._b=m[1],this._c=m[2],this._d=m[3];return}this._a=m,this._b=j,this._c=C,this._d=I}se.prototype={transform:function(m,j){return this._transform(m.clone(),j)},_transform:function(m,j){return j=j||1,m.x=j*(this._a*m.x+this._b),m.y=j*(this._c*m.y+this._d),m},untransform:function(m,j){return j=j||1,new q((m.x/j-this._b)/this._a,(m.y/j-this._d)/this._c)}};function V(m,j,C,I){return new se(m,j,C,I)}var ue=a({},de,{code:"EPSG:3857",projection:ie,transformation:function(){var m=.5/(Math.PI*ie.R);return V(m,.5,-m,.5)}()}),_e=a({},ue,{code:"EPSG:900913"});function ae(m){return document.createElementNS("http://www.w3.org/2000/svg",m)}function we(m,j){var C="",I,W,te,be,$e,Ve;for(I=0,te=m.length;I<te;I++){for($e=m[I],W=0,be=$e.length;W<be;W++)Ve=$e[W],C+=(W?"L":"M")+Ve.x+" "+Ve.y;C+=j?Le.svg?"z":"x":""}return C||"M0 0"}var oe=document.documentElement.style,ce="ActiveXObject"in window,Ae=ce&&!document.addEventListener,Be="msLaunchUri"in navigator&&!("documentMode"in document),Xe=De("webkit"),ge=De("android"),We=De("android 2")||De("android 3"),Ue=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),at=ge&&De("Google")&&Ue<537&&!("AudioNode"in window),mt=!!window.opera,Ye=!Be&&De("chrome"),Ft=De("gecko")&&!Xe&&!mt&&!ce,_t=!Ye&&De("safari"),Lt=De("phantom"),Oe="OTransition"in oe,qe=navigator.platform.indexOf("Win")===0,Ne=ce&&"transition"in oe,Fe="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!We,ve="MozPerspective"in oe,Me=!window.L_DISABLE_3D&&(Ne||Fe||ve)&&!Oe&&!Lt,ze=typeof orientation!="undefined"||De("mobile"),ct=ze&&Xe,Et=ze&&Fe,gt=!window.PointerEvent&&window.MSPointerEvent,St=!!(window.PointerEvent||gt),dr="ontouchstart"in window||!!window.TouchEvent,Sr=!window.L_NO_TOUCH&&(dr||St),wt=ze&&mt,lt=ze&&Ft,Qe=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,jt=function(){var m=!1;try{var j=Object.defineProperty({},"passive",{get:function(){m=!0}});window.addEventListener("testPassiveEventSupport",f,j),window.removeEventListener("testPassiveEventSupport",f,j)}catch(C){}return m}(),ir=function(){return!!document.createElement("canvas").getContext}(),rr=!!(document.createElementNS&&ae("svg").createSVGRect),Ie=!!rr&&function(){var m=document.createElement("div");return m.innerHTML="<svg/>",(m.firstChild&&m.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),At=!rr&&function(){try{var m=document.createElement("div");m.innerHTML='<v:shape adj="1"/>';var j=m.firstChild;return j.style.behavior="url(#default#VML)",j&&typeof j.adj=="object"}catch(C){return!1}}(),yt=navigator.platform.indexOf("Mac")===0,pe=navigator.platform.indexOf("Linux")===0;function De(m){return navigator.userAgent.toLowerCase().indexOf(m)>=0}var Le={ie:ce,ielt9:Ae,edge:Be,webkit:Xe,android:ge,android23:We,androidStock:at,opera:mt,chrome:Ye,gecko:Ft,safari:_t,phantom:Lt,opera12:Oe,win:qe,ie3d:Ne,webkit3d:Fe,gecko3d:ve,any3d:Me,mobile:ze,mobileWebkit:ct,mobileWebkit3d:Et,msPointer:gt,pointer:St,touch:Sr,touchNative:dr,mobileOpera:wt,mobileGecko:lt,retina:Qe,passiveEvents:jt,canvas:ir,svg:rr,vml:At,inlineSvg:Ie,mac:yt,linux:pe},bt=Le.msPointer?"MSPointerDown":"pointerdown",it=Le.msPointer?"MSPointerMove":"pointermove",zt=Le.msPointer?"MSPointerUp":"pointerup",Bt=Le.msPointer?"MSPointerCancel":"pointercancel",Te={touchstart:bt,touchmove:it,touchend:zt,touchcancel:Bt},dt={touchstart:Ee,touchmove:Ge,touchend:Ge,touchcancel:Ge},mr={},Mn=!1;function fe(m,j,C){return j==="touchstart"&&Pe(),dt[j]?(C=dt[j].bind(this,C),m.addEventListener(Te[j],C,!1),C):(console.warn("wrong event specified:",j),f)}function Re(m,j,C){if(!Te[j]){console.warn("wrong event specified:",j);return}m.removeEventListener(Te[j],C,!1)}function ot(m){mr[m.pointerId]=m}function vt(m){mr[m.pointerId]&&(mr[m.pointerId]=m)}function ut(m){delete mr[m.pointerId]}function Pe(){Mn||(document.addEventListener(bt,ot,!0),document.addEventListener(it,vt,!0),document.addEventListener(zt,ut,!0),document.addEventListener(Bt,ut,!0),Mn=!0)}function Ge(m,j){if(j.pointerType!==(j.MSPOINTER_TYPE_MOUSE||"mouse")){j.touches=[];for(var C in mr)j.touches.push(mr[C]);j.changedTouches=[j],m(j)}}function Ee(m,j){j.MSPOINTER_TYPE_TOUCH&&j.pointerType===j.MSPOINTER_TYPE_TOUCH&&es(j),Ge(m,j)}function ft(m){var j={},C,I;for(I in m)C=m[I],j[I]=C&&C.bind?C.bind(m):C;return m=j,j.type="dblclick",j.detail=2,j.isTrusted=!1,j._simulated=!0,j}var Pt=200;function yr(m,j){m.addEventListener("dblclick",j);var C=0,I;function W(te){if(te.detail!==1){I=te.detail;return}if(!(te.pointerType==="mouse"||te.sourceCapabilities&&!te.sourceCapabilities.firesTouchEvents)){var be=Lp(te);if(!(be.some(function(Ve){return Ve instanceof HTMLLabelElement&&Ve.attributes.for})&&!be.some(function(Ve){return Ve instanceof HTMLInputElement||Ve instanceof HTMLSelectElement}))){var $e=Date.now();$e-C<=Pt?(I++,I===2&&j(ft(te))):I=1,C=$e}}}return m.addEventListener("click",W),{dblclick:j,simDblclick:W}}function un(m,j){m.removeEventListener("dblclick",j.dblclick),m.removeEventListener("click",j.simDblclick)}var hn=Br(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),xn=Br(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Rt=xn==="webkitTransition"||xn==="OTransition"?xn+"End":"transitionend";function hr(m){return typeof m=="string"?document.getElementById(m):m}function or(m,j){var C=m.style[j]||m.currentStyle&&m.currentStyle[j];if((!C||C==="auto")&&document.defaultView){var I=document.defaultView.getComputedStyle(m,null);C=I?I[j]:null}return C==="auto"?null:C}function Gt(m,j,C){var I=document.createElement(m);return I.className=j||"",C&&C.appendChild(I),I}function xr(m){var j=m.parentNode;j&&j.removeChild(m)}function Xt(m){for(;m.firstChild;)m.removeChild(m.firstChild)}function jr(m){var j=m.parentNode;j&&j.lastChild!==m&&j.appendChild(m)}function en(m){var j=m.parentNode;j&&j.firstChild!==m&&j.insertBefore(m,j.firstChild)}function Hn(m,j){if(m.classList!==void 0)return m.classList.contains(j);var C=Oa(m);return C.length>0&&new RegExp("(^|\\s)"+j+"(\\s|$)").test(C)}function Tt(m,j){if(m.classList!==void 0)for(var C=g(j),I=0,W=C.length;I<W;I++)m.classList.add(C[I]);else if(!Hn(m,j)){var te=Oa(m);ds(m,(te?te+" ":"")+j)}}function kr(m,j){m.classList!==void 0?m.classList.remove(j):ds(m,p((" "+Oa(m)+" ").replace(" "+j+" "," ")))}function ds(m,j){m.className.baseVal===void 0?m.className=j:m.className.baseVal=j}function Oa(m){return m.correspondingElement&&(m=m.correspondingElement),m.className.baseVal===void 0?m.className:m.className.baseVal}function Dn(m,j){"opacity"in m.style?m.style.opacity=j:"filter"in m.style&&Hr(m,j)}function Hr(m,j){var C=!1,I="DXImageTransform.Microsoft.Alpha";try{C=m.filters.item(I)}catch(W){if(j===1)return}j=Math.round(j*100),C?(C.Enabled=j!==100,C.Opacity=j):m.style.filter+=" progid:"+I+"(opacity="+j+")"}function Br(m){for(var j=document.documentElement.style,C=0;C<m.length;C++)if(m[C]in j)return m[C];return!1}function En(m,j,C){var I=j||new q(0,0);m.style[hn]=(Le.ie3d?"translate("+I.x+"px,"+I.y+"px)":"translate3d("+I.x+"px,"+I.y+"px,0)")+(C?" scale("+C+")":"")}function $r(m,j){m._leaflet_pos=j,Le.any3d?En(m,j):(m.style.left=j.x+"px",m.style.top=j.y+"px")}function Qn(m){return m._leaflet_pos||new q(0,0)}var la,wi,In;if("onselectstart"in document)la=function(){Nr(window,"selectstart",es)},wi=function(){fn(window,"selectstart",es)};else{var nr=Br(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);la=function(){if(nr){var m=document.documentElement.style;In=m[nr],m[nr]="none"}},wi=function(){nr&&(document.documentElement.style[nr]=In,In=void 0)}}function Or(){Nr(window,"dragstart",es)}function ln(){fn(window,"dragstart",es)}var Cn,js;function bi(m){for(;m.tabIndex===-1;)m=m.parentNode;m.style&&(xa(),Cn=m,js=m.style.outlineStyle,m.style.outlineStyle="none",Nr(window,"keydown",xa))}function xa(){Cn&&(Cn.style.outlineStyle=js,Cn=void 0,js=void 0,fn(window,"keydown",xa))}function Ms(m){do m=m.parentNode;while((!m.offsetWidth||!m.offsetHeight)&&m!==document.body);return m}function _s(m){var j=m.getBoundingClientRect();return{x:j.width/m.offsetWidth||1,y:j.height/m.offsetHeight||1,boundingClientRect:j}}var Za={__proto__:null,TRANSFORM:hn,TRANSITION:xn,TRANSITION_END:Rt,get:hr,getStyle:or,create:Gt,remove:xr,empty:Xt,toFront:jr,toBack:en,hasClass:Hn,addClass:Tt,removeClass:kr,setClass:ds,getClass:Oa,setOpacity:Dn,testProp:Br,setTransform:En,setPosition:$r,getPosition:Qn,get disableTextSelection(){return la},get enableTextSelection(){return wi},disableImageDrag:Or,enableImageDrag:ln,preventOutline:bi,restoreOutline:xa,getSizedParentNode:Ms,getScale:_s};function Nr(m,j,C,I){if(j&&typeof j=="object")for(var W in j)ql(m,W,j[W],C);else{j=g(j);for(var te=0,be=j.length;te<be;te++)ql(m,j[te],C,I)}return this}var Ma="_leaflet_events";function fn(m,j,C,I){if(arguments.length===1)ou(m),delete m[Ma];else if(j&&typeof j=="object")for(var W in j)Wc(m,W,j[W],C);else if(j=g(j),arguments.length===2)ou(m,function($e){return N(j,$e)!==-1});else for(var te=0,be=j.length;te<be;te++)Wc(m,j[te],C,I);return this}function ou(m,j){for(var C in m[Ma]){var I=C.split(/\d/)[0];(!j||j(I))&&Wc(m,I,null,null,C)}}var Vc={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ql(m,j,C,I){var W=j+c(C)+(I?"_"+c(I):"");if(m[Ma]&&m[Ma][W])return this;var te=function($e){return C.call(I||m,$e||window.event)},be=te;!Le.touchNative&&Le.pointer&&j.indexOf("touch")===0?te=fe(m,j,te):Le.touch&&j==="dblclick"?te=yr(m,te):"addEventListener"in m?j==="touchstart"||j==="touchmove"||j==="wheel"||j==="mousewheel"?m.addEventListener(Vc[j]||j,te,Le.passiveEvents?{passive:!1}:!1):j==="mouseenter"||j==="mouseleave"?(te=function($e){$e=$e||window.event,Dh(m,$e)&&be($e)},m.addEventListener(Vc[j],te,!1)):m.addEventListener(j,be,!1):m.attachEvent("on"+j,te),m[Ma]=m[Ma]||{},m[Ma][W]=te}function Wc(m,j,C,I,W){W=W||j+c(C)+(I?"_"+c(I):"");var te=m[Ma]&&m[Ma][W];if(!te)return this;!Le.touchNative&&Le.pointer&&j.indexOf("touch")===0?Re(m,j,te):Le.touch&&j==="dblclick"?un(m,te):"removeEventListener"in m?m.removeEventListener(Vc[j]||j,te,!1):m.detachEvent("on"+j,te),m[Ma][W]=null}function tl(m){return m.stopPropagation?m.stopPropagation():m.originalEvent?m.originalEvent._stopped=!0:m.cancelBubble=!0,this}function Mh(m){return ql(m,"wheel",tl),this}function Xa(m){return Nr(m,"mousedown touchstart dblclick contextmenu",tl),m._leaflet_disable_click=!0,this}function es(m){return m.preventDefault?m.preventDefault():m.returnValue=!1,this}function Vl(m){return es(m),tl(m),this}function Lp(m){if(m.composedPath)return m.composedPath();for(var j=[],C=m.target;C;)j.push(C),C=C.parentNode;return j}function bx(m,j){if(!j)return new q(m.clientX,m.clientY);var C=_s(j),I=C.boundingClientRect;return new q((m.clientX-I.left)/C.x-j.clientLeft,(m.clientY-I.top)/C.y-j.clientTop)}var Rj=Le.linux&&Le.chrome?window.devicePixelRatio:Le.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function jx(m){return Le.edge?m.wheelDeltaY/2:m.deltaY&&m.deltaMode===0?-m.deltaY/Rj:m.deltaY&&m.deltaMode===1?-m.deltaY*20:m.deltaY&&m.deltaMode===2?-m.deltaY*60:m.deltaX||m.deltaZ?0:m.wheelDelta?(m.wheelDeltaY||m.wheelDelta)/2:m.detail&&Math.abs(m.detail)<32765?-m.detail*20:m.detail?m.detail/-32765*60:0}function Dh(m,j){var C=j.relatedTarget;if(!C)return!0;try{for(;C&&C!==m;)C=C.parentNode}catch(I){return!1}return C!==m}var Nx={__proto__:null,on:Nr,off:fn,stopPropagation:tl,disableScrollPropagation:Mh,disableClickPropagation:Xa,preventDefault:es,stop:Vl,getPropagationPath:Lp,getMousePosition:bx,getWheelDelta:jx,isExternalTarget:Dh,addListener:Nr,removeListener:fn},Fp=G.extend({run:function(m,j,C,I){this.stop(),this._el=m,this._inProgress=!0,this._duration=C||.25,this._easeOutPower=1/Math.max(I||.5,.2),this._startPos=Qn(m),this._offset=j.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=O(this._animate,this),this._step()},_step:function(m){var j=+new Date-this._startTime,C=this._duration*1e3;j<C?this._runFrame(this._easeOut(j/C),m):(this._runFrame(1),this._complete())},_runFrame:function(m,j){var C=this._startPos.add(this._offset.multiplyBy(m));j&&C._round(),$r(this._el,C),this.fire("step")},_complete:function(){z(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(m){return 1-Math.pow(1-m,this._easeOutPower)}}),tn=G.extend({options:{crs:ue,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(m,j){j=v(this,j),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(m),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),j.maxBounds&&this.setMaxBounds(j.maxBounds),j.zoom!==void 0&&(this._zoom=this._limitZoom(j.zoom)),j.center&&j.zoom!==void 0&&this.setView(ye(j.center),j.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=xn&&Le.any3d&&!Le.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Nr(this._proxy,Rt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(m,j,C){if(j=j===void 0?this._zoom:this._limitZoom(j),m=this._limitCenter(ye(m),j,this.options.maxBounds),C=C||{},this._stop(),this._loaded&&!C.reset&&C!==!0){C.animate!==void 0&&(C.zoom=a({animate:C.animate},C.zoom),C.pan=a({animate:C.animate,duration:C.duration},C.pan));var I=this._zoom!==j?this._tryAnimatedZoom&&this._tryAnimatedZoom(m,j,C.zoom):this._tryAnimatedPan(m,C.pan);if(I)return clearTimeout(this._sizeTimer),this}return this._resetView(m,j,C.pan&&C.pan.noMoveStart),this},setZoom:function(m,j){return this._loaded?this.setView(this.getCenter(),m,{zoom:j}):(this._zoom=m,this)},zoomIn:function(m,j){return m=m||(Le.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+m,j)},zoomOut:function(m,j){return m=m||(Le.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-m,j)},setZoomAround:function(m,j,C){var I=this.getZoomScale(j),W=this.getSize().divideBy(2),te=m instanceof q?m:this.latLngToContainerPoint(m),be=te.subtract(W).multiplyBy(1-1/I),$e=this.containerPointToLatLng(W.add(be));return this.setView($e,j,{zoom:C})},_getBoundsCenterZoom:function(m,j){j=j||{},m=m.getBounds?m.getBounds():ne(m);var C=Z(j.paddingTopLeft||j.padding||[0,0]),I=Z(j.paddingBottomRight||j.padding||[0,0]),W=this.getBoundsZoom(m,!1,C.add(I));if(W=typeof j.maxZoom=="number"?Math.min(j.maxZoom,W):W,W===1/0)return{center:m.getCenter(),zoom:W};var te=I.subtract(C).divideBy(2),be=this.project(m.getSouthWest(),W),$e=this.project(m.getNorthEast(),W),Ve=this.unproject(be.add($e).divideBy(2).add(te),W);return{center:Ve,zoom:W}},fitBounds:function(m,j){if(m=ne(m),!m.isValid())throw new Error("Bounds are not valid.");var C=this._getBoundsCenterZoom(m,j);return this.setView(C.center,C.zoom,j)},fitWorld:function(m){return this.fitBounds([[-90,-180],[90,180]],m)},panTo:function(m,j){return this.setView(m,this._zoom,{pan:j})},panBy:function(m,j){if(m=Z(m).round(),j=j||{},!m.x&&!m.y)return this.fire("moveend");if(j.animate!==!0&&!this.getSize().contains(m))return this._resetView(this.unproject(this.project(this.getCenter()).add(m)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Fp,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),j.noMoveStart||this.fire("movestart"),j.animate!==!1){Tt(this._mapPane,"leaflet-pan-anim");var C=this._getMapPanePos().subtract(m).round();this._panAnim.run(this._mapPane,C,j.duration||.25,j.easeLinearity)}else this._rawPanBy(m),this.fire("move").fire("moveend");return this},flyTo:function(m,j,C){if(C=C||{},C.animate===!1||!Le.any3d)return this.setView(m,j,C);this._stop();var I=this.project(this.getCenter()),W=this.project(m),te=this.getSize(),be=this._zoom;m=ye(m),j=j===void 0?be:j;var $e=Math.max(te.x,te.y),Ve=$e*this.getZoomScale(be,j),ht=W.distanceTo(I)||1,Ut=1.42,pr=Ut*Ut;function Kr(Ss){var zx=Ss?-1:1,kK=Ss?Ve:$e,EK=Ve*Ve-$e*$e+zx*pr*pr*ht*ht,CK=2*kK*pr*ht,Fj=EK/CK,BR=Math.sqrt(Fj*Fj+1)-Fj,PK=BR<1e-9?-18:Math.log(BR);return PK}function Ia(Ss){return(Math.exp(Ss)-Math.exp(-Ss))/2}function Zs(Ss){return(Math.exp(Ss)+Math.exp(-Ss))/2}function Fi(Ss){return Ia(Ss)/Zs(Ss)}var Qa=Kr(0);function Uh(Ss){return $e*(Zs(Qa)/Zs(Qa+Ut*Ss))}function bK(Ss){return $e*(Zs(Qa)*Fi(Qa+Ut*Ss)-Ia(Qa))/pr}function jK(Ss){return 1-Math.pow(1-Ss,1.5)}var NK=Date.now(),FR=(Kr(1)-Qa)/Ut,SK=C.duration?1e3*C.duration:1e3*FR*.8;function zR(){var Ss=(Date.now()-NK)/SK,zx=jK(Ss)*FR;Ss<=1?(this._flyToFrame=O(zR,this),this._move(this.unproject(I.add(W.subtract(I).multiplyBy(bK(zx)/ht)),be),this.getScaleZoom($e/Uh(zx),be),{flyTo:!0})):this._move(m,j)._moveEnd(!0)}return this._moveStart(!0,C.noMoveStart),zR.call(this),this},flyToBounds:function(m,j){var C=this._getBoundsCenterZoom(m,j);return this.flyTo(C.center,C.zoom,j)},setMaxBounds:function(m){return m=ne(m),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),m.isValid()?(this.options.maxBounds=m,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(m){var j=this.options.minZoom;return this.options.minZoom=m,this._loaded&&j!==m&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(m):this},setMaxZoom:function(m){var j=this.options.maxZoom;return this.options.maxZoom=m,this._loaded&&j!==m&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(m):this},panInsideBounds:function(m,j){this._enforcingBounds=!0;var C=this.getCenter(),I=this._limitCenter(C,this._zoom,ne(m));return C.equals(I)||this.panTo(I,j),this._enforcingBounds=!1,this},panInside:function(m,j){j=j||{};var C=Z(j.paddingTopLeft||j.padding||[0,0]),I=Z(j.paddingBottomRight||j.padding||[0,0]),W=this.project(this.getCenter()),te=this.project(m),be=this.getPixelBounds(),$e=Q([be.min.add(C),be.max.subtract(I)]),Ve=$e.getSize();if(!$e.contains(te)){this._enforcingBounds=!0;var ht=te.subtract($e.getCenter()),Ut=$e.extend(te).getSize().subtract(Ve);W.x+=ht.x<0?-Ut.x:Ut.x,W.y+=ht.y<0?-Ut.y:Ut.y,this.panTo(this.unproject(W),j),this._enforcingBounds=!1}return this},invalidateSize:function(m){if(!this._loaded)return this;m=a({animate:!1,pan:!0},m===!0?{animate:!0}:m);var j=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var C=this.getSize(),I=j.divideBy(2).round(),W=C.divideBy(2).round(),te=I.subtract(W);return!te.x&&!te.y?this:(m.animate&&m.pan?this.panBy(te):(m.pan&&this._rawPanBy(te),this.fire("move"),m.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:j,newSize:C}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(m){if(m=this._locateOptions=a({timeout:1e4,watch:!1},m),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var j=o(this._handleGeolocationResponse,this),C=o(this._handleGeolocationError,this);return m.watch?this._locationWatchId=navigator.geolocation.watchPosition(j,C,m):navigator.geolocation.getCurrentPosition(j,C,m),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(m){if(this._container._leaflet_id){var j=m.code,C=m.message||(j===1?"permission denied":j===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:j,message:"Geolocation error: "+C+"."})}},_handleGeolocationResponse:function(m){if(this._container._leaflet_id){var j=m.coords.latitude,C=m.coords.longitude,I=new re(j,C),W=I.toBounds(m.coords.accuracy*2),te=this._locateOptions;if(te.setView){var be=this.getBoundsZoom(W);this.setView(I,te.maxZoom?Math.min(be,te.maxZoom):be)}var $e={latlng:I,bounds:W,timestamp:m.timestamp};for(var Ve in m.coords)typeof m.coords[Ve]=="number"&&($e[Ve]=m.coords[Ve]);this.fire("locationfound",$e)}},addHandler:function(m,j){if(!j)return this;var C=this[m]=new j(this);return this._handlers.push(C),this.options[m]&&C.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(j){this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),xr(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(z(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var m;for(m in this._layers)this._layers[m].remove();for(m in this._panes)xr(this._panes[m]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(m,j){var C="leaflet-pane"+(m?" leaflet-"+m.replace("Pane","")+"-pane":""),I=Gt("div",C,j||this._mapPane);return m&&(this._panes[m]=I),I},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var m=this.getPixelBounds(),j=this.unproject(m.getBottomLeft()),C=this.unproject(m.getTopRight());return new X(j,C)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(m,j,C){m=ne(m),C=Z(C||[0,0]);var I=this.getZoom()||0,W=this.getMinZoom(),te=this.getMaxZoom(),be=m.getNorthWest(),$e=m.getSouthEast(),Ve=this.getSize().subtract(C),ht=Q(this.project($e,I),this.project(be,I)).getSize(),Ut=Le.any3d?this.options.zoomSnap:1,pr=Ve.x/ht.x,Kr=Ve.y/ht.y,Ia=j?Math.max(pr,Kr):Math.min(pr,Kr);return I=this.getScaleZoom(Ia,I),Ut&&(I=Math.round(I/(Ut/100))*(Ut/100),I=j?Math.ceil(I/Ut)*Ut:Math.floor(I/Ut)*Ut),Math.max(W,Math.min(te,I))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(m,j){var C=this._getTopLeftPoint(m,j);return new Y(C,C.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(m){return this.options.crs.getProjectedBounds(m===void 0?this.getZoom():m)},getPane:function(m){return typeof m=="string"?this._panes[m]:m},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(m,j){var C=this.options.crs;return j=j===void 0?this._zoom:j,C.scale(m)/C.scale(j)},getScaleZoom:function(m,j){var C=this.options.crs;j=j===void 0?this._zoom:j;var I=C.zoom(m*C.scale(j));return isNaN(I)?1/0:I},project:function(m,j){return j=j===void 0?this._zoom:j,this.options.crs.latLngToPoint(ye(m),j)},unproject:function(m,j){return j=j===void 0?this._zoom:j,this.options.crs.pointToLatLng(Z(m),j)},layerPointToLatLng:function(m){var j=Z(m).add(this.getPixelOrigin());return this.unproject(j)},latLngToLayerPoint:function(m){var j=this.project(ye(m))._round();return j._subtract(this.getPixelOrigin())},wrapLatLng:function(m){return this.options.crs.wrapLatLng(ye(m))},wrapLatLngBounds:function(m){return this.options.crs.wrapLatLngBounds(ne(m))},distance:function(m,j){return this.options.crs.distance(ye(m),ye(j))},containerPointToLayerPoint:function(m){return Z(m).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(m){return Z(m).add(this._getMapPanePos())},containerPointToLatLng:function(m){var j=this.containerPointToLayerPoint(Z(m));return this.layerPointToLatLng(j)},latLngToContainerPoint:function(m){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ye(m)))},mouseEventToContainerPoint:function(m){return bx(m,this._container)},mouseEventToLayerPoint:function(m){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(m))},mouseEventToLatLng:function(m){return this.layerPointToLatLng(this.mouseEventToLayerPoint(m))},_initContainer:function(m){var j=this._container=hr(m);if(j){if(j._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Nr(j,"scroll",this._onScroll,this),this._containerId=c(j)},_initLayout:function(){var m=this._container;this._fadeAnimated=this.options.fadeAnimation&&Le.any3d,Tt(m,"leaflet-container"+(Le.touch?" leaflet-touch":"")+(Le.retina?" leaflet-retina":"")+(Le.ielt9?" leaflet-oldie":"")+(Le.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var j=or(m,"position");j!=="absolute"&&j!=="relative"&&j!=="fixed"&&j!=="sticky"&&(m.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var m=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),$r(this._mapPane,new q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Tt(m.markerPane,"leaflet-zoom-hide"),Tt(m.shadowPane,"leaflet-zoom-hide"))},_resetView:function(m,j,C){$r(this._mapPane,new q(0,0));var I=!this._loaded;this._loaded=!0,j=this._limitZoom(j),this.fire("viewprereset");var W=this._zoom!==j;this._moveStart(W,C)._move(m,j)._moveEnd(W),this.fire("viewreset"),I&&this.fire("load")},_moveStart:function(m,j){return m&&this.fire("zoomstart"),j||this.fire("movestart"),this},_move:function(m,j,C,I){j===void 0&&(j=this._zoom);var W=this._zoom!==j;return this._zoom=j,this._lastCenter=m,this._pixelOrigin=this._getNewPixelOrigin(m),I?C&&C.pinch&&this.fire("zoom",C):((W||C&&C.pinch)&&this.fire("zoom",C),this.fire("move",C)),this},_moveEnd:function(m){return m&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return z(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(m){$r(this._mapPane,this._getMapPanePos().subtract(m))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(m){this._targets={},this._targets[c(this._container)]=this;var j=m?fn:Nr;j(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&j(window,"resize",this._onResize,this),Le.any3d&&this.options.transform3DLimit&&(m?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){z(this._resizeRequest),this._resizeRequest=O(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var m=this._getMapPanePos();Math.max(Math.abs(m.x),Math.abs(m.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(m,j){for(var C=[],I,W=j==="mouseout"||j==="mouseover",te=m.target||m.srcElement,be=!1;te;){if(I=this._targets[c(te)],I&&(j==="click"||j==="preclick")&&this._draggableMoved(I)){be=!0;break}if(I&&I.listens(j,!0)&&(W&&!Dh(te,m)||(C.push(I),W))||te===this._container)break;te=te.parentNode}return!C.length&&!be&&!W&&this.listens(j,!0)&&(C=[this]),C},_isClickDisabled:function(m){for(;m&&m!==this._container;){if(m._leaflet_disable_click)return!0;m=m.parentNode}},_handleDOMEvent:function(m){var j=m.target||m.srcElement;if(!(!this._loaded||j._leaflet_disable_events||m.type==="click"&&this._isClickDisabled(j))){var C=m.type;C==="mousedown"&&bi(j),this._fireDOMEvent(m,C)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(m,j,C){if(m.type==="click"){var I=a({},m);I.type="preclick",this._fireDOMEvent(I,I.type,C)}var W=this._findEventTargets(m,j);if(C){for(var te=[],be=0;be<C.length;be++)C[be].listens(j,!0)&&te.push(C[be]);W=te.concat(W)}if(W.length){j==="contextmenu"&&es(m);var $e=W[0],Ve={originalEvent:m};if(m.type!=="keypress"&&m.type!=="keydown"&&m.type!=="keyup"){var ht=$e.getLatLng&&(!$e._radius||$e._radius<=10);Ve.containerPoint=ht?this.latLngToContainerPoint($e.getLatLng()):this.mouseEventToContainerPoint(m),Ve.layerPoint=this.containerPointToLayerPoint(Ve.containerPoint),Ve.latlng=ht?$e.getLatLng():this.layerPointToLatLng(Ve.layerPoint)}for(be=0;be<W.length;be++)if(W[be].fire(j,Ve,!0),Ve.originalEvent._stopped||W[be].options.bubblingMouseEvents===!1&&N(this._mouseEvents,j)!==-1)return}},_draggableMoved:function(m){return m=m.dragging&&m.dragging.enabled()?m:this,m.dragging&&m.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var m=0,j=this._handlers.length;m<j;m++)this._handlers[m].disable()},whenReady:function(m,j){return this._loaded?m.call(j||this,{target:this}):this.on("load",m,j),this},_getMapPanePos:function(){return Qn(this._mapPane)||new q(0,0)},_moved:function(){var m=this._getMapPanePos();return m&&!m.equals([0,0])},_getTopLeftPoint:function(m,j){var C=m&&j!==void 0?this._getNewPixelOrigin(m,j):this.getPixelOrigin();return C.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(m,j){var C=this.getSize()._divideBy(2);return this.project(m,j)._subtract(C)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(m,j,C){var I=this._getNewPixelOrigin(C,j);return this.project(m,j)._subtract(I)},_latLngBoundsToNewLayerBounds:function(m,j,C){var I=this._getNewPixelOrigin(C,j);return Q([this.project(m.getSouthWest(),j)._subtract(I),this.project(m.getNorthWest(),j)._subtract(I),this.project(m.getSouthEast(),j)._subtract(I),this.project(m.getNorthEast(),j)._subtract(I)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(m){return this.latLngToLayerPoint(m).subtract(this._getCenterLayerPoint())},_limitCenter:function(m,j,C){if(!C)return m;var I=this.project(m,j),W=this.getSize().divideBy(2),te=new Y(I.subtract(W),I.add(W)),be=this._getBoundsOffset(te,C,j);return Math.abs(be.x)<=1&&Math.abs(be.y)<=1?m:this.unproject(I.add(be),j)},_limitOffset:function(m,j){if(!j)return m;var C=this.getPixelBounds(),I=new Y(C.min.add(m),C.max.add(m));return m.add(this._getBoundsOffset(I,j))},_getBoundsOffset:function(m,j,C){var I=Q(this.project(j.getNorthEast(),C),this.project(j.getSouthWest(),C)),W=I.min.subtract(m.min),te=I.max.subtract(m.max),be=this._rebound(W.x,-te.x),$e=this._rebound(W.y,-te.y);return new q(be,$e)},_rebound:function(m,j){return m+j>0?Math.round(m-j)/2:Math.max(0,Math.ceil(m))-Math.max(0,Math.floor(j))},_limitZoom:function(m){var j=this.getMinZoom(),C=this.getMaxZoom(),I=Le.any3d?this.options.zoomSnap:1;return I&&(m=Math.round(m/I)*I),Math.max(j,Math.min(C,m))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){kr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(m,j){var C=this._getCenterOffset(m)._trunc();return(j&&j.animate)!==!0&&!this.getSize().contains(C)?!1:(this.panBy(C,j),!0)},_createAnimProxy:function(){var m=this._proxy=Gt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(m),this.on("zoomanim",function(j){var C=hn,I=this._proxy.style[C];En(this._proxy,this.project(j.center,j.zoom),this.getZoomScale(j.zoom,1)),I===this._proxy.style[C]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){xr(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var m=this.getCenter(),j=this.getZoom();En(this._proxy,this.project(m,j),this.getZoomScale(j,1))},_catchTransitionEnd:function(m){this._animatingZoom&&m.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(m,j,C){if(this._animatingZoom)return!0;if(C=C||{},!this._zoomAnimated||C.animate===!1||this._nothingToAnimate()||Math.abs(j-this._zoom)>this.options.zoomAnimationThreshold)return!1;var I=this.getZoomScale(j),W=this._getCenterOffset(m)._divideBy(1-1/I);return C.animate!==!0&&!this.getSize().contains(W)?!1:(O(function(){this._moveStart(!0,C.noMoveStart||!1)._animateZoom(m,j,!0)},this),!0)},_animateZoom:function(m,j,C,I){this._mapPane&&(C&&(this._animatingZoom=!0,this._animateToCenter=m,this._animateToZoom=j,Tt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:m,zoom:j,noUpdate:I}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&kr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Sx(m,j){return new tn(m,j)}var Ja=B.extend({options:{position:"topright"},initialize:function(m){v(this,m)},getPosition:function(){return this.options.position},setPosition:function(m){var j=this._map;return j&&j.removeControl(this),this.options.position=m,j&&j.addControl(this),this},getContainer:function(){return this._container},addTo:function(m){this.remove(),this._map=m;var j=this._container=this.onAdd(m),C=this.getPosition(),I=m._controlCorners[C];return Tt(j,"leaflet-control"),C.indexOf("bottom")!==-1?I.insertBefore(j,I.firstChild):I.appendChild(j),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(xr(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(m){this._map&&m&&m.screenX>0&&m.screenY>0&&this._map.getContainer().focus()}}),Hc=function(m){return new Ja(m)};tn.include({addControl:function(m){return m.addTo(this),this},removeControl:function(m){return m.remove(),this},_initControlPos:function(){var m=this._controlCorners={},j="leaflet-",C=this._controlContainer=Gt("div",j+"control-container",this._container);function I(W,te){var be=j+W+" "+j+te;m[W+te]=Gt("div",be,C)}I("top","left"),I("top","right"),I("bottom","left"),I("bottom","right")},_clearControlPos:function(){for(var m in this._controlCorners)xr(this._controlCorners[m]);xr(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var zp=Ja.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(m,j,C,I){return C<I?-1:I<C?1:0}},initialize:function(m,j,C){v(this,C),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var I in m)this._addLayer(m[I],I);for(I in j)this._addLayer(j[I],I,!0)},onAdd:function(m){this._initLayout(),this._update(),this._map=m,m.on("zoomend",this._checkDisabledLayers,this);for(var j=0;j<this._layers.length;j++)this._layers[j].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(m){return Ja.prototype.addTo.call(this,m),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var m=0;m<this._layers.length;m++)this._layers[m].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(m,j){return this._addLayer(m,j),this._map?this._update():this},addOverlay:function(m,j){return this._addLayer(m,j,!0),this._map?this._update():this},removeLayer:function(m){m.off("add remove",this._onLayerChange,this);var j=this._getLayer(c(m));return j&&this._layers.splice(this._layers.indexOf(j),1),this._map?this._update():this},expand:function(){Tt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var m=this._map.getSize().y-(this._container.offsetTop+50);return m<this._section.clientHeight?(Tt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=m+"px"):kr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return kr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var m="leaflet-control-layers",j=this._container=Gt("div",m),C=this.options.collapsed;j.setAttribute("aria-haspopup",!0),Xa(j),Mh(j);var I=this._section=Gt("section",m+"-list");C&&(this._map.on("click",this.collapse,this),Nr(j,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var W=this._layersLink=Gt("a",m+"-toggle",j);W.href="#",W.title="Layers",W.setAttribute("role","button"),Nr(W,{keydown:function(te){te.keyCode===13&&this._expandSafely()},click:function(te){es(te),this._expandSafely()}},this),C||this.expand(),this._baseLayersList=Gt("div",m+"-base",I),this._separator=Gt("div",m+"-separator",I),this._overlaysList=Gt("div",m+"-overlays",I),j.appendChild(I)},_getLayer:function(m){for(var j=0;j<this._layers.length;j++)if(this._layers[j]&&c(this._layers[j].layer)===m)return this._layers[j]},_addLayer:function(m,j,C){this._map&&m.on("add remove",this._onLayerChange,this),this._layers.push({layer:m,name:j,overlay:C}),this.options.sortLayers&&this._layers.sort(o(function(I,W){return this.options.sortFunction(I.layer,W.layer,I.name,W.name)},this)),this.options.autoZIndex&&m.setZIndex&&(this._lastZIndex++,m.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Xt(this._baseLayersList),Xt(this._overlaysList),this._layerControlInputs=[];var m,j,C,I,W=0;for(C=0;C<this._layers.length;C++)I=this._layers[C],this._addItem(I),j=j||I.overlay,m=m||!I.overlay,W+=I.overlay?0:1;return this.options.hideSingleBase&&(m=m&&W>1,this._baseLayersList.style.display=m?"":"none"),this._separator.style.display=j&&m?"":"none",this},_onLayerChange:function(m){this._handlingClick||this._update();var j=this._getLayer(c(m.target)),C=j.overlay?m.type==="add"?"overlayadd":"overlayremove":m.type==="add"?"baselayerchange":null;C&&this._map.fire(C,j)},_createRadioElement:function(m,j){var C='<input type="radio" class="leaflet-control-layers-selector" name="'+m+'"'+(j?' checked="checked"':"")+"/>",I=document.createElement("div");return I.innerHTML=C,I.firstChild},_addItem:function(m){var j=document.createElement("label"),C=this._map.hasLayer(m.layer),I;m.overlay?(I=document.createElement("input"),I.type="checkbox",I.className="leaflet-control-layers-selector",I.defaultChecked=C):I=this._createRadioElement("leaflet-base-layers_"+c(this),C),this._layerControlInputs.push(I),I.layerId=c(m.layer),Nr(I,"click",this._onInputClick,this);var W=document.createElement("span");W.innerHTML=" "+m.name;var te=document.createElement("span");j.appendChild(te),te.appendChild(I),te.appendChild(W);var be=m.overlay?this._overlaysList:this._baseLayersList;return be.appendChild(j),this._checkDisabledLayers(),j},_onInputClick:function(){if(!this._preventClick){var m=this._layerControlInputs,j,C,I=[],W=[];this._handlingClick=!0;for(var te=m.length-1;te>=0;te--)j=m[te],C=this._getLayer(j.layerId).layer,j.checked?I.push(C):j.checked||W.push(C);for(te=0;te<W.length;te++)this._map.hasLayer(W[te])&&this._map.removeLayer(W[te]);for(te=0;te<I.length;te++)this._map.hasLayer(I[te])||this._map.addLayer(I[te]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var m=this._layerControlInputs,j,C,I=this._map.getZoom(),W=m.length-1;W>=0;W--)j=m[W],C=this._getLayer(j.layerId).layer,j.disabled=C.options.minZoom!==void 0&&I<C.options.minZoom||C.options.maxZoom!==void 0&&I>C.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var m=this._section;this._preventClick=!0,Nr(m,"click",es),this.expand();var j=this;setTimeout(function(){fn(m,"click",es),j._preventClick=!1})}}),kx=function(m,j,C){return new zp(m,j,C)},Ih=Ja.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(m){var j="leaflet-control-zoom",C=Gt("div",j+" leaflet-bar"),I=this.options;return this._zoomInButton=this._createButton(I.zoomInText,I.zoomInTitle,j+"-in",C,this._zoomIn),this._zoomOutButton=this._createButton(I.zoomOutText,I.zoomOutTitle,j+"-out",C,this._zoomOut),this._updateDisabled(),m.on("zoomend zoomlevelschange",this._updateDisabled,this),C},onRemove:function(m){m.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(m){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(m.shiftKey?3:1))},_zoomOut:function(m){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(m.shiftKey?3:1))},_createButton:function(m,j,C,I,W){var te=Gt("a",C,I);return te.innerHTML=m,te.href="#",te.title=j,te.setAttribute("role","button"),te.setAttribute("aria-label",j),Xa(te),Nr(te,"click",Vl),Nr(te,"click",W,this),Nr(te,"click",this._refocusOnMap,this),te},_updateDisabled:function(){var m=this._map,j="leaflet-disabled";kr(this._zoomInButton,j),kr(this._zoomOutButton,j),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||m._zoom===m.getMinZoom())&&(Tt(this._zoomOutButton,j),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||m._zoom===m.getMaxZoom())&&(Tt(this._zoomInButton,j),this._zoomInButton.setAttribute("aria-disabled","true"))}});tn.mergeOptions({zoomControl:!0}),tn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ih,this.addControl(this.zoomControl))});var Ex=function(m){return new Ih(m)},he=Ja.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(m){var j="leaflet-control-scale",C=Gt("div",j),I=this.options;return this._addScales(I,j+"-line",C),m.on(I.updateWhenIdle?"moveend":"move",this._update,this),m.whenReady(this._update,this),C},onRemove:function(m){m.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(m,j,C){m.metric&&(this._mScale=Gt("div",j,C)),m.imperial&&(this._iScale=Gt("div",j,C))},_update:function(){var m=this._map,j=m.getSize().y/2,C=m.distance(m.containerPointToLatLng([0,j]),m.containerPointToLatLng([this.options.maxWidth,j]));this._updateScales(C)},_updateScales:function(m){this.options.metric&&m&&this._updateMetric(m),this.options.imperial&&m&&this._updateImperial(m)},_updateMetric:function(m){var j=this._getRoundNum(m),C=j<1e3?j+" m":j/1e3+" km";this._updateScale(this._mScale,C,j/m)},_updateImperial:function(m){var j=m*3.2808399,C,I,W;j>5280?(C=j/5280,I=this._getRoundNum(C),this._updateScale(this._iScale,I+" mi",I/C)):(W=this._getRoundNum(j),this._updateScale(this._iScale,W+" ft",W/j))},_updateScale:function(m,j,C){m.style.width=Math.round(this.options.maxWidth*C)+"px",m.innerHTML=j},_getRoundNum:function(m){var j=Math.pow(10,(Math.floor(m)+"").length-1),C=m/j;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:1,j*C}}),Ce=function(m){return new he(m)},st='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',je=Ja.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Le.inlineSvg?st+" ":"")+"Leaflet</a>"},initialize:function(m){v(this,m),this._attributions={}},onAdd:function(m){m.attributionControl=this,this._container=Gt("div","leaflet-control-attribution"),Xa(this._container);for(var j in m._layers)m._layers[j].getAttribution&&this.addAttribution(m._layers[j].getAttribution());return this._update(),m.on("layeradd",this._addAttribution,this),this._container},onRemove:function(m){m.off("layeradd",this._addAttribution,this)},_addAttribution:function(m){m.layer.getAttribution&&(this.addAttribution(m.layer.getAttribution()),m.layer.once("remove",function(){this.removeAttribution(m.layer.getAttribution())},this))},setPrefix:function(m){return this.options.prefix=m,this._update(),this},addAttribution:function(m){return m?(this._attributions[m]||(this._attributions[m]=0),this._attributions[m]++,this._update(),this):this},removeAttribution:function(m){return m?(this._attributions[m]&&(this._attributions[m]--,this._update()),this):this},_update:function(){if(this._map){var m=[];for(var j in this._attributions)this._attributions[j]&&m.push(j);var C=[];this.options.prefix&&C.push(this.options.prefix),m.length&&C.push(m.join(", ")),this._container.innerHTML=C.join(' <span aria-hidden="true">|</span> ')}}});tn.mergeOptions({attributionControl:!0}),tn.addInitHook(function(){this.options.attributionControl&&new je().addTo(this)});var sr=function(m){return new je(m)};Ja.Layers=zp,Ja.Zoom=Ih,Ja.Scale=he,Ja.Attribution=je,Hc.layers=kx,Hc.zoom=Ex,Hc.scale=Ce,Hc.attribution=sr;var kt=B.extend({initialize:function(m){this._map=m},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});kt.addTo=function(m,j){return m.addHandler(j,this),this};var Dt={Events:U},Vt=Le.touch?"touchstart mousedown":"mousedown",ur=G.extend({options:{clickTolerance:3},initialize:function(m,j,C,I){v(this,I),this._element=m,this._dragStartTarget=j||m,this._preventOutline=C},enable:function(){this._enabled||(Nr(this._dragStartTarget,Vt,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ur._dragging===this&&this.finishDrag(!0),fn(this._dragStartTarget,Vt,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(m){if(this._enabled&&(this._moved=!1,!Hn(this._element,"leaflet-zoom-anim"))){if(m.touches&&m.touches.length!==1){ur._dragging===this&&this.finishDrag();return}if(!(ur._dragging||m.shiftKey||m.which!==1&&m.button!==1&&!m.touches)&&(ur._dragging=this,this._preventOutline&&bi(this._element),Or(),la(),!this._moving)){this.fire("down");var j=m.touches?m.touches[0]:m,C=Ms(this._element);this._startPoint=new q(j.clientX,j.clientY),this._startPos=Qn(this._element),this._parentScale=_s(C);var I=m.type==="mousedown";Nr(document,I?"mousemove":"touchmove",this._onMove,this),Nr(document,I?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(m){if(this._enabled){if(m.touches&&m.touches.length>1){this._moved=!0;return}var j=m.touches&&m.touches.length===1?m.touches[0]:m,C=new q(j.clientX,j.clientY)._subtract(this._startPoint);!C.x&&!C.y||Math.abs(C.x)+Math.abs(C.y)<this.options.clickTolerance||(C.x/=this._parentScale.x,C.y/=this._parentScale.y,es(m),this._moved||(this.fire("dragstart"),this._moved=!0,Tt(document.body,"leaflet-dragging"),this._lastTarget=m.target||m.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Tt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(C),this._moving=!0,this._lastEvent=m,this._updatePosition())}},_updatePosition:function(){var m={originalEvent:this._lastEvent};this.fire("predrag",m),$r(this._element,this._newPos),this.fire("drag",m)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(m){kr(document.body,"leaflet-dragging"),this._lastTarget&&(kr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),fn(document,"mousemove touchmove",this._onMove,this),fn(document,"mouseup touchend touchcancel",this._onUp,this),ln(),wi();var j=this._moved&&this._moving;this._moving=!1,ur._dragging=!1,j&&this.fire("dragend",{noInertia:m,distance:this._newPos.distanceTo(this._startPos)})}});function Ur(m,j,C){var I,W=[1,4,2,8],te,be,$e,Ve,ht,Ut,pr,Kr;for(te=0,Ut=m.length;te<Ut;te++)m[te]._code=rl(m[te],j);for($e=0;$e<4;$e++){for(pr=W[$e],I=[],te=0,Ut=m.length,be=Ut-1;te<Ut;be=te++)Ve=m[te],ht=m[be],Ve._code&pr?ht._code&pr||(Kr=lu(ht,Ve,pr,j,C),Kr._code=rl(Kr,j),I.push(Kr)):(ht._code&pr&&(Kr=lu(ht,Ve,pr,j,C),Kr._code=rl(Kr,j),I.push(Kr)),I.push(Ve));m=I}return m}function _r(m,j){var C,I,W,te,be,$e,Ve,ht,Ut;if(!m||m.length===0)throw new Error("latlngs not passed");Da(m)||(console.warn("latlngs are not flat! Only the first ring will be used"),m=m[0]);var pr=ye([0,0]),Kr=ne(m),Ia=Kr.getNorthWest().distanceTo(Kr.getSouthWest())*Kr.getNorthEast().distanceTo(Kr.getNorthWest());Ia<1700&&(pr=cn(m));var Zs=m.length,Fi=[];for(C=0;C<Zs;C++){var Qa=ye(m[C]);Fi.push(j.project(ye([Qa.lat-pr.lat,Qa.lng-pr.lng])))}for($e=Ve=ht=0,C=0,I=Zs-1;C<Zs;I=C++)W=Fi[C],te=Fi[I],be=W.y*te.x-te.y*W.x,Ve+=(W.x+te.x)*be,ht+=(W.y+te.y)*be,$e+=be*3;$e===0?Ut=Fi[0]:Ut=[Ve/$e,ht/$e];var Uh=j.unproject(Z(Ut));return ye([Uh.lat+pr.lat,Uh.lng+pr.lng])}function cn(m){for(var j=0,C=0,I=0,W=0;W<m.length;W++){var te=ye(m[W]);j+=te.lat,C+=te.lng,I++}return ye([j/I,C/I])}var Ns={__proto__:null,clipPolygon:Ur,polygonCenter:_r,centroid:cn};function ar(m,j){if(!j||!m.length)return m.slice();var C=j*j;return m=ca(m,C),m=Mr(m,C),m}function rn(m,j,C){return Math.sqrt(Gc(m,j,C,!0))}function Gn(m,j,C){return Gc(m,j,C)}function Mr(m,j){var C=m.length,I=typeof Uint8Array!="undefined"?Uint8Array:Array,W=new I(C);W[0]=W[C-1]=1,er(m,W,j,0,C-1);var te,be=[];for(te=0;te<C;te++)W[te]&&be.push(m[te]);return be}function er(m,j,C,I,W){var te=0,be,$e,Ve;for($e=I+1;$e<=W-1;$e++)Ve=Gc(m[$e],m[I],m[W],!0),Ve>te&&(be=$e,te=Ve);te>C&&(j[be]=1,er(m,j,C,I,be),er(m,j,C,be,W))}function ca(m,j){for(var C=[m[0]],I=1,W=0,te=m.length;I<te;I++)Cx(m[I],m[W])>j&&(C.push(m[I]),W=I);return W<te-1&&C.push(m[te-1]),C}var wr;function Nn(m,j,C,I,W){var te=I?wr:rl(m,C),be=rl(j,C),$e,Ve,ht;for(wr=be;;){if(!(te|be))return[m,j];if(te&be)return!1;$e=te||be,Ve=lu(m,j,$e,C,W),ht=rl(Ve,C),$e===te?(m=Ve,te=ht):(j=Ve,be=ht)}}function lu(m,j,C,I,W){var te=j.x-m.x,be=j.y-m.y,$e=I.min,Ve=I.max,ht,Ut;return C&8?(ht=m.x+te*(Ve.y-m.y)/be,Ut=Ve.y):C&4?(ht=m.x+te*($e.y-m.y)/be,Ut=$e.y):C&2?(ht=Ve.x,Ut=m.y+be*(Ve.x-m.x)/te):C&1&&(ht=$e.x,Ut=m.y+be*($e.x-m.x)/te),new q(ht,Ut,W)}function rl(m,j){var C=0;return m.x<j.min.x?C|=1:m.x>j.max.x&&(C|=2),m.y<j.min.y?C|=4:m.y>j.max.y&&(C|=8),C}function Cx(m,j){var C=j.x-m.x,I=j.y-m.y;return C*C+I*I}function Gc(m,j,C,I){var W=j.x,te=j.y,be=C.x-W,$e=C.y-te,Ve=be*be+$e*$e,ht;return Ve>0&&(ht=((m.x-W)*be+(m.y-te)*$e)/Ve,ht>1?(W=C.x,te=C.y):ht>0&&(W+=be*ht,te+=$e*ht)),be=m.x-W,$e=m.y-te,I?be*be+$e*$e:new q(W,te)}function Da(m){return!b(m[0])||typeof m[0][0]!="object"&&typeof m[0][0]!="undefined"}function Bp(m){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Da(m)}function Up(m,j){var C,I,W,te,be,$e,Ve,ht;if(!m||m.length===0)throw new Error("latlngs not passed");Da(m)||(console.warn("latlngs are not flat! Only the first ring will be used"),m=m[0]);var Ut=ye([0,0]),pr=ne(m),Kr=pr.getNorthWest().distanceTo(pr.getSouthWest())*pr.getNorthEast().distanceTo(pr.getNorthWest());Kr<1700&&(Ut=cn(m));var Ia=m.length,Zs=[];for(C=0;C<Ia;C++){var Fi=ye(m[C]);Zs.push(j.project(ye([Fi.lat-Ut.lat,Fi.lng-Ut.lng])))}for(C=0,I=0;C<Ia-1;C++)I+=Zs[C].distanceTo(Zs[C+1])/2;if(I===0)ht=Zs[0];else for(C=0,te=0;C<Ia-1;C++)if(be=Zs[C],$e=Zs[C+1],W=be.distanceTo($e),te+=W,te>I){Ve=(te-I)/W,ht=[$e.x-Ve*($e.x-be.x),$e.y-Ve*($e.y-be.y)];break}var Qa=j.unproject(Z(ht));return ye([Qa.lat+Ut.lat,Qa.lng+Ut.lng])}var Px={__proto__:null,simplify:ar,pointToSegmentDistance:rn,closestPointOnSegment:Gn,clipSegment:Nn,_getEdgeIntersection:lu,_getBitCode:rl,_sqClosestPointOnSegment:Gc,isFlat:Da,_flat:Bp,polylineCenter:Up},Oj={project:function(m){return new q(m.lng,m.lat)},unproject:function(m){return new re(m.y,m.x)},bounds:new Y([-180,-90],[180,90])},Mj={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Y([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(m){var j=Math.PI/180,C=this.R,I=m.lat*j,W=this.R_MINOR/C,te=Math.sqrt(1-W*W),be=te*Math.sin(I),$e=Math.tan(Math.PI/4-I/2)/Math.pow((1-be)/(1+be),te/2);return I=-C*Math.log(Math.max($e,1e-10)),new q(m.lng*j*C,I)},unproject:function(m){for(var j=180/Math.PI,C=this.R,I=this.R_MINOR/C,W=Math.sqrt(1-I*I),te=Math.exp(-m.y/C),be=Math.PI/2-2*Math.atan(te),$e=0,Ve=.1,ht;$e<15&&Math.abs(Ve)>1e-7;$e++)ht=W*Math.sin(be),ht=Math.pow((1-ht)/(1+ht),W/2),Ve=Math.PI/2-2*Math.atan(te*ht)-be,be+=Ve;return new re(be*j,m.x*j/C)}},JY={__proto__:null,LonLat:Oj,Mercator:Mj,SphericalMercator:ie},QY=a({},de,{code:"EPSG:3395",projection:Mj,transformation:function(){var m=.5/(Math.PI*Mj.R);return V(m,.5,-m,.5)}()}),xR=a({},de,{code:"EPSG:4326",projection:Oj,transformation:V(1/180,1,-1/180,.5)}),eK=a({},ee,{projection:Oj,transformation:V(1,0,-1,0),scale:function(m){return Math.pow(2,m)},zoom:function(m){return Math.log(m)/Math.LN2},distance:function(m,j){var C=j.lng-m.lng,I=j.lat-m.lat;return Math.sqrt(C*C+I*I)},infinite:!0});ee.Earth=de,ee.EPSG3395=QY,ee.EPSG3857=ue,ee.EPSG900913=_e,ee.EPSG4326=xR,ee.Simple=eK;var go=G.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(m){return m.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(m){return m&&m.removeLayer(this),this},getPane:function(m){return this._map.getPane(m?this.options[m]||m:this.options.pane)},addInteractiveTarget:function(m){return this._map._targets[c(m)]=this,this},removeInteractiveTarget:function(m){return delete this._map._targets[c(m)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(m){var j=m.target;if(j.hasLayer(this)){if(this._map=j,this._zoomAnimated=j._zoomAnimated,this.getEvents){var C=this.getEvents();j.on(C,this),this.once("remove",function(){j.off(C,this)},this)}this.onAdd(j),this.fire("add"),j.fire("layeradd",{layer:this})}}});tn.include({addLayer:function(m){if(!m._layerAdd)throw new Error("The provided object is not a Layer.");var j=c(m);return this._layers[j]?this:(this._layers[j]=m,m._mapToAdd=this,m.beforeAdd&&m.beforeAdd(this),this.whenReady(m._layerAdd,m),this)},removeLayer:function(m){var j=c(m);return this._layers[j]?(this._loaded&&m.onRemove(this),delete this._layers[j],this._loaded&&(this.fire("layerremove",{layer:m}),m.fire("remove")),m._map=m._mapToAdd=null,this):this},hasLayer:function(m){return c(m)in this._layers},eachLayer:function(m,j){for(var C in this._layers)m.call(j,this._layers[C]);return this},_addLayers:function(m){m=m?b(m)?m:[m]:[];for(var j=0,C=m.length;j<C;j++)this.addLayer(m[j])},_addZoomLimit:function(m){(!isNaN(m.options.maxZoom)||!isNaN(m.options.minZoom))&&(this._zoomBoundLayers[c(m)]=m,this._updateZoomLevels())},_removeZoomLimit:function(m){var j=c(m);this._zoomBoundLayers[j]&&(delete this._zoomBoundLayers[j],this._updateZoomLevels())},_updateZoomLevels:function(){var m=1/0,j=-1/0,C=this._getZoomSpan();for(var I in this._zoomBoundLayers){var W=this._zoomBoundLayers[I].options;m=W.minZoom===void 0?m:Math.min(m,W.minZoom),j=W.maxZoom===void 0?j:Math.max(j,W.maxZoom)}this._layersMaxZoom=j===-1/0?void 0:j,this._layersMinZoom=m===1/0?void 0:m,C!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var $h=go.extend({initialize:function(m,j){v(this,j),this._layers={};var C,I;if(m)for(C=0,I=m.length;C<I;C++)this.addLayer(m[C])},addLayer:function(m){var j=this.getLayerId(m);return this._layers[j]=m,this._map&&this._map.addLayer(m),this},removeLayer:function(m){var j=m in this._layers?m:this.getLayerId(m);return this._map&&this._layers[j]&&this._map.removeLayer(this._layers[j]),delete this._layers[j],this},hasLayer:function(m){var j=typeof m=="number"?m:this.getLayerId(m);return j in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(m){var j=Array.prototype.slice.call(arguments,1),C,I;for(C in this._layers)I=this._layers[C],I[m]&&I[m].apply(I,j);return this},onAdd:function(m){this.eachLayer(m.addLayer,m)},onRemove:function(m){this.eachLayer(m.removeLayer,m)},eachLayer:function(m,j){for(var C in this._layers)m.call(j,this._layers[C]);return this},getLayer:function(m){return this._layers[m]},getLayers:function(){var m=[];return this.eachLayer(m.push,m),m},setZIndex:function(m){return this.invoke("setZIndex",m)},getLayerId:function(m){return c(m)}}),tK=function(m,j){return new $h(m,j)},Wl=$h.extend({addLayer:function(m){return this.hasLayer(m)?this:(m.addEventParent(this),$h.prototype.addLayer.call(this,m),this.fire("layeradd",{layer:m}))},removeLayer:function(m){return this.hasLayer(m)?(m in this._layers&&(m=this._layers[m]),m.removeEventParent(this),$h.prototype.removeLayer.call(this,m),this.fire("layerremove",{layer:m})):this},setStyle:function(m){return this.invoke("setStyle",m)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var m=new X;for(var j in this._layers){var C=this._layers[j];m.extend(C.getBounds?C.getBounds():C.getLatLng())}return m}}),rK=function(m,j){return new Wl(m,j)},Lh=B.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(m){v(this,m)},createIcon:function(m){return this._createIcon("icon",m)},createShadow:function(m){return this._createIcon("shadow",m)},_createIcon:function(m,j){var C=this._getIconUrl(m);if(!C){if(m==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var I=this._createImg(C,j&&j.tagName==="IMG"?j:null);return this._setIconStyles(I,m),(this.options.crossOrigin||this.options.crossOrigin==="")&&(I.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),I},_setIconStyles:function(m,j){var C=this.options,I=C[j+"Size"];typeof I=="number"&&(I=[I,I]);var W=Z(I),te=Z(j==="shadow"&&C.shadowAnchor||C.iconAnchor||W&&W.divideBy(2,!0));m.className="leaflet-marker-"+j+" "+(C.className||""),te&&(m.style.marginLeft=-te.x+"px",m.style.marginTop=-te.y+"px"),W&&(m.style.width=W.x+"px",m.style.height=W.y+"px")},_createImg:function(m,j){return j=j||document.createElement("img"),j.src=m,j},_getIconUrl:function(m){return Le.retina&&this.options[m+"RetinaUrl"]||this.options[m+"Url"]}});function nK(m){return new Lh(m)}var qp=Lh.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(m){return typeof qp.imagePath!="string"&&(qp.imagePath=this._detectIconPath()),(this.options.imagePath||qp.imagePath)+Lh.prototype._getIconUrl.call(this,m)},_stripUrl:function(m){var j=function(C,I,W){var te=I.exec(C);return te&&te[W]};return m=j(m,/^url\((['"])?(.+)\1\)$/,2),m&&j(m,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var m=Gt("div","leaflet-default-icon-path",document.body),j=or(m,"background-image")||or(m,"backgroundImage");if(document.body.removeChild(m),j=this._stripUrl(j),j)return j;var C=document.querySelector('link[href$="leaflet.css"]');return C?C.href.substring(0,C.href.length-11-1):""}}),_R=kt.extend({initialize:function(m){this._marker=m},addHooks:function(){var m=this._marker._icon;this._draggable||(this._draggable=new ur(m,m,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Tt(m,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&kr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(m){var j=this._marker,C=j._map,I=this._marker.options.autoPanSpeed,W=this._marker.options.autoPanPadding,te=Qn(j._icon),be=C.getPixelBounds(),$e=C.getPixelOrigin(),Ve=Q(be.min._subtract($e).add(W),be.max._subtract($e).subtract(W));if(!Ve.contains(te)){var ht=Z((Math.max(Ve.max.x,te.x)-Ve.max.x)/(be.max.x-Ve.max.x)-(Math.min(Ve.min.x,te.x)-Ve.min.x)/(be.min.x-Ve.min.x),(Math.max(Ve.max.y,te.y)-Ve.max.y)/(be.max.y-Ve.max.y)-(Math.min(Ve.min.y,te.y)-Ve.min.y)/(be.min.y-Ve.min.y)).multiplyBy(I);C.panBy(ht,{animate:!1}),this._draggable._newPos._add(ht),this._draggable._startPos._add(ht),$r(j._icon,this._draggable._newPos),this._onDrag(m),this._panRequest=O(this._adjustPan.bind(this,m))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(m){this._marker.options.autoPan&&(z(this._panRequest),this._panRequest=O(this._adjustPan.bind(this,m)))},_onDrag:function(m){var j=this._marker,C=j._shadow,I=Qn(j._icon),W=j._map.layerPointToLatLng(I);C&&$r(C,I),j._latlng=W,m.latlng=W,m.oldLatLng=this._oldLatLng,j.fire("move",m).fire("drag",m)},_onDragEnd:function(m){z(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",m)}}),Tx=go.extend({options:{icon:new qp,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(m,j){v(this,j),this._latlng=ye(m)},onAdd:function(m){this._zoomAnimated=this._zoomAnimated&&m.options.markerZoomAnimation,this._zoomAnimated&&m.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(m){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&m.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(m){var j=this._latlng;return this._latlng=ye(m),this.update(),this.fire("move",{oldLatLng:j,latlng:this._latlng})},setZIndexOffset:function(m){return this.options.zIndexOffset=m,this.update()},getIcon:function(){return this.options.icon},setIcon:function(m){return this.options.icon=m,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var m=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(m)}return this},_initIcon:function(){var m=this.options,j="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),C=m.icon.createIcon(this._icon),I=!1;C!==this._icon&&(this._icon&&this._removeIcon(),I=!0,m.title&&(C.title=m.title),C.tagName==="IMG"&&(C.alt=m.alt||"")),Tt(C,j),m.keyboard&&(C.tabIndex="0",C.setAttribute("role","button")),this._icon=C,m.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Nr(C,"focus",this._panOnFocus,this);var W=m.icon.createShadow(this._shadow),te=!1;W!==this._shadow&&(this._removeShadow(),te=!0),W&&(Tt(W,j),W.alt=""),this._shadow=W,m.opacity<1&&this._updateOpacity(),I&&this.getPane().appendChild(this._icon),this._initInteraction(),W&&te&&this.getPane(m.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&fn(this._icon,"focus",this._panOnFocus,this),xr(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&xr(this._shadow),this._shadow=null},_setPos:function(m){this._icon&&$r(this._icon,m),this._shadow&&$r(this._shadow,m),this._zIndex=m.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(m){this._icon&&(this._icon.style.zIndex=this._zIndex+m)},_animateZoom:function(m){var j=this._map._latLngToNewLayerPoint(this._latlng,m.zoom,m.center).round();this._setPos(j)},_initInteraction:function(){if(this.options.interactive&&(Tt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),_R)){var m=this.options.draggable;this.dragging&&(m=this.dragging.enabled(),this.dragging.disable()),this.dragging=new _R(this),m&&this.dragging.enable()}},setOpacity:function(m){return this.options.opacity=m,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var m=this.options.opacity;this._icon&&Dn(this._icon,m),this._shadow&&Dn(this._shadow,m)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var m=this._map;if(m){var j=this.options.icon.options,C=j.iconSize?Z(j.iconSize):Z(0,0),I=j.iconAnchor?Z(j.iconAnchor):Z(0,0);m.panInside(this._latlng,{paddingTopLeft:I,paddingBottomRight:C.subtract(I)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function sK(m,j){return new Tx(m,j)}var Yc=go.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(m){this._renderer=m.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(m){return v(this,m),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&m&&Object.prototype.hasOwnProperty.call(m,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ax=Yc.extend({options:{fill:!0,radius:10},initialize:function(m,j){v(this,j),this._latlng=ye(m),this._radius=this.options.radius},setLatLng:function(m){var j=this._latlng;return this._latlng=ye(m),this.redraw(),this.fire("move",{oldLatLng:j,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(m){return this.options.radius=this._radius=m,this.redraw()},getRadius:function(){return this._radius},setStyle:function(m){var j=m&&m.radius||this._radius;return Yc.prototype.setStyle.call(this,m),this.setRadius(j),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var m=this._radius,j=this._radiusY||m,C=this._clickTolerance(),I=[m+C,j+C];this._pxBounds=new Y(this._point.subtract(I),this._point.add(I))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(m){return m.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function aK(m,j){return new Ax(m,j)}var Dj=Ax.extend({initialize:function(m,j,C){if(typeof j=="number"&&(j=a({},C,{radius:j})),v(this,j),this._latlng=ye(m),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(m){return this._mRadius=m,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var m=[this._radius,this._radiusY||this._radius];return new X(this._map.layerPointToLatLng(this._point.subtract(m)),this._map.layerPointToLatLng(this._point.add(m)))},setStyle:Yc.prototype.setStyle,_project:function(){var m=this._latlng.lng,j=this._latlng.lat,C=this._map,I=C.options.crs;if(I.distance===de.distance){var W=Math.PI/180,te=this._mRadius/de.R/W,be=C.project([j+te,m]),$e=C.project([j-te,m]),Ve=be.add($e).divideBy(2),ht=C.unproject(Ve).lat,Ut=Math.acos((Math.cos(te*W)-Math.sin(j*W)*Math.sin(ht*W))/(Math.cos(j*W)*Math.cos(ht*W)))/W;(isNaN(Ut)||Ut===0)&&(Ut=te/Math.cos(Math.PI/180*j)),this._point=Ve.subtract(C.getPixelOrigin()),this._radius=isNaN(Ut)?0:Ve.x-C.project([ht,m-Ut]).x,this._radiusY=Ve.y-be.y}else{var pr=I.unproject(I.project(this._latlng).subtract([this._mRadius,0]));this._point=C.latLngToLayerPoint(this._latlng),this._radius=this._point.x-C.latLngToLayerPoint(pr).x}this._updateBounds()}});function iK(m,j,C){return new Dj(m,j,C)}var Hl=Yc.extend({options:{smoothFactor:1,noClip:!1},initialize:function(m,j){v(this,j),this._setLatLngs(m)},getLatLngs:function(){return this._latlngs},setLatLngs:function(m){return this._setLatLngs(m),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(m){for(var j=1/0,C=null,I=Gc,W,te,be=0,$e=this._parts.length;be<$e;be++)for(var Ve=this._parts[be],ht=1,Ut=Ve.length;ht<Ut;ht++){W=Ve[ht-1],te=Ve[ht];var pr=I(m,W,te,!0);pr<j&&(j=pr,C=I(m,W,te))}return C&&(C.distance=Math.sqrt(j)),C},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Up(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(m,j){return j=j||this._defaultShape(),m=ye(m),j.push(m),this._bounds.extend(m),this.redraw()},_setLatLngs:function(m){this._bounds=new X,this._latlngs=this._convertLatLngs(m)},_defaultShape:function(){return Da(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(m){for(var j=[],C=Da(m),I=0,W=m.length;I<W;I++)C?(j[I]=ye(m[I]),this._bounds.extend(j[I])):j[I]=this._convertLatLngs(m[I]);return j},_project:function(){var m=new Y;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,m),this._bounds.isValid()&&m.isValid()&&(this._rawPxBounds=m,this._updateBounds())},_updateBounds:function(){var m=this._clickTolerance(),j=new q(m,m);this._rawPxBounds&&(this._pxBounds=new Y([this._rawPxBounds.min.subtract(j),this._rawPxBounds.max.add(j)]))},_projectLatlngs:function(m,j,C){var I=m[0]instanceof re,W=m.length,te,be;if(I){for(be=[],te=0;te<W;te++)be[te]=this._map.latLngToLayerPoint(m[te]),C.extend(be[te]);j.push(be)}else for(te=0;te<W;te++)this._projectLatlngs(m[te],j,C)},_clipPoints:function(){var m=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(m))){if(this.options.noClip){this._parts=this._rings;return}var j=this._parts,C,I,W,te,be,$e,Ve;for(C=0,W=0,te=this._rings.length;C<te;C++)for(Ve=this._rings[C],I=0,be=Ve.length;I<be-1;I++)$e=Nn(Ve[I],Ve[I+1],m,I,!0),$e&&(j[W]=j[W]||[],j[W].push($e[0]),($e[1]!==Ve[I+1]||I===be-2)&&(j[W].push($e[1]),W++))}},_simplifyPoints:function(){for(var m=this._parts,j=this.options.smoothFactor,C=0,I=m.length;C<I;C++)m[C]=ar(m[C],j)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(m,j){var C,I,W,te,be,$e,Ve=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(m))return!1;for(C=0,te=this._parts.length;C<te;C++)for($e=this._parts[C],I=0,be=$e.length,W=be-1;I<be;W=I++)if(!(!j&&I===0)&&rn(m,$e[W],$e[I])<=Ve)return!0;return!1}});function oK(m,j){return new Hl(m,j)}Hl._flat=Bp;var Fh=Hl.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return _r(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(m){var j=Hl.prototype._convertLatLngs.call(this,m),C=j.length;return C>=2&&j[0]instanceof re&&j[0].equals(j[C-1])&&j.pop(),j},_setLatLngs:function(m){Hl.prototype._setLatLngs.call(this,m),Da(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Da(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var m=this._renderer._bounds,j=this.options.weight,C=new q(j,j);if(m=new Y(m.min.subtract(C),m.max.add(C)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(m))){if(this.options.noClip){this._parts=this._rings;return}for(var I=0,W=this._rings.length,te;I<W;I++)te=Ur(this._rings[I],m,!0),te.length&&this._parts.push(te)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(m){var j=!1,C,I,W,te,be,$e,Ve,ht;if(!this._pxBounds||!this._pxBounds.contains(m))return!1;for(te=0,Ve=this._parts.length;te<Ve;te++)for(C=this._parts[te],be=0,ht=C.length,$e=ht-1;be<ht;$e=be++)I=C[be],W=C[$e],I.y>m.y!=W.y>m.y&&m.x<(W.x-I.x)*(m.y-I.y)/(W.y-I.y)+I.x&&(j=!j);return j||Hl.prototype._containsPoint.call(this,m,!0)}});function lK(m,j){return new Fh(m,j)}var Gl=Wl.extend({initialize:function(m,j){v(this,j),this._layers={},m&&this.addData(m)},addData:function(m){var j=b(m)?m:m.features,C,I,W;if(j){for(C=0,I=j.length;C<I;C++)W=j[C],(W.geometries||W.geometry||W.features||W.coordinates)&&this.addData(W);return this}var te=this.options;if(te.filter&&!te.filter(m))return this;var be=Rx(m,te);return be?(be.feature=Dx(m),be.defaultOptions=be.options,this.resetStyle(be),te.onEachFeature&&te.onEachFeature(m,be),this.addLayer(be)):this},resetStyle:function(m){return m===void 0?this.eachLayer(this.resetStyle,this):(m.options=a({},m.defaultOptions),this._setLayerStyle(m,this.options.style),this)},setStyle:function(m){return this.eachLayer(function(j){this._setLayerStyle(j,m)},this)},_setLayerStyle:function(m,j){m.setStyle&&(typeof j=="function"&&(j=j(m.feature)),m.setStyle(j))}});function Rx(m,j){var C=m.type==="Feature"?m.geometry:m,I=C?C.coordinates:null,W=[],te=j&&j.pointToLayer,be=j&&j.coordsToLatLng||Ij,$e,Ve,ht,Ut;if(!I&&!C)return null;switch(C.type){case"Point":return $e=be(I),wR(te,m,$e,j);case"MultiPoint":for(ht=0,Ut=I.length;ht<Ut;ht++)$e=be(I[ht]),W.push(wR(te,m,$e,j));return new Wl(W);case"LineString":case"MultiLineString":return Ve=Ox(I,C.type==="LineString"?0:1,be),new Hl(Ve,j);case"Polygon":case"MultiPolygon":return Ve=Ox(I,C.type==="Polygon"?1:2,be),new Fh(Ve,j);case"GeometryCollection":for(ht=0,Ut=C.geometries.length;ht<Ut;ht++){var pr=Rx({geometry:C.geometries[ht],type:"Feature",properties:m.properties},j);pr&&W.push(pr)}return new Wl(W);case"FeatureCollection":for(ht=0,Ut=C.features.length;ht<Ut;ht++){var Kr=Rx(C.features[ht],j);Kr&&W.push(Kr)}return new Wl(W);default:throw new Error("Invalid GeoJSON object.")}}function wR(m,j,C,I){return m?m(j,C):new Tx(C,I&&I.markersInheritOptions&&I)}function Ij(m){return new re(m[1],m[0],m[2])}function Ox(m,j,C){for(var I=[],W=0,te=m.length,be;W<te;W++)be=j?Ox(m[W],j-1,C):(C||Ij)(m[W]),I.push(be);return I}function $j(m,j){return m=ye(m),m.alt!==void 0?[h(m.lng,j),h(m.lat,j),h(m.alt,j)]:[h(m.lng,j),h(m.lat,j)]}function Mx(m,j,C,I){for(var W=[],te=0,be=m.length;te<be;te++)W.push(j?Mx(m[te],Da(m[te])?0:j-1,C,I):$j(m[te],I));return!j&&C&&W.length>0&&W.push(W[0].slice()),W}function zh(m,j){return m.feature?a({},m.feature,{geometry:j}):Dx(j)}function Dx(m){return m.type==="Feature"||m.type==="FeatureCollection"?m:{type:"Feature",properties:{},geometry:m}}var Lj={toGeoJSON:function(m){return zh(this,{type:"Point",coordinates:$j(this.getLatLng(),m)})}};Tx.include(Lj),Dj.include(Lj),Ax.include(Lj),Hl.include({toGeoJSON:function(m){var j=!Da(this._latlngs),C=Mx(this._latlngs,j?1:0,!1,m);return zh(this,{type:(j?"Multi":"")+"LineString",coordinates:C})}}),Fh.include({toGeoJSON:function(m){var j=!Da(this._latlngs),C=j&&!Da(this._latlngs[0]),I=Mx(this._latlngs,C?2:j?1:0,!0,m);return j||(I=[I]),zh(this,{type:(C?"Multi":"")+"Polygon",coordinates:I})}}),$h.include({toMultiPoint:function(m){var j=[];return this.eachLayer(function(C){j.push(C.toGeoJSON(m).geometry.coordinates)}),zh(this,{type:"MultiPoint",coordinates:j})},toGeoJSON:function(m){var j=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(j==="MultiPoint")return this.toMultiPoint(m);var C=j==="GeometryCollection",I=[];return this.eachLayer(function(W){if(W.toGeoJSON){var te=W.toGeoJSON(m);if(C)I.push(te.geometry);else{var be=Dx(te);be.type==="FeatureCollection"?I.push.apply(I,be.features):I.push(be)}}}),C?zh(this,{geometries:I,type:"GeometryCollection"}):{type:"FeatureCollection",features:I}}});function bR(m,j){return new Gl(m,j)}var cK=bR,Ix=go.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(m,j,C){this._url=m,this._bounds=ne(j),v(this,C)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Tt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){xr(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(m){return this.options.opacity=m,this._image&&this._updateOpacity(),this},setStyle:function(m){return m.opacity&&this.setOpacity(m.opacity),this},bringToFront:function(){return this._map&&jr(this._image),this},bringToBack:function(){return this._map&&en(this._image),this},setUrl:function(m){return this._url=m,this._image&&(this._image.src=m),this},setBounds:function(m){return this._bounds=ne(m),this._map&&this._reset(),this},getEvents:function(){var m={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(m.zoomanim=this._animateZoom),m},setZIndex:function(m){return this.options.zIndex=m,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var m=this._url.tagName==="IMG",j=this._image=m?this._url:Gt("img");if(Tt(j,"leaflet-image-layer"),this._zoomAnimated&&Tt(j,"leaflet-zoom-animated"),this.options.className&&Tt(j,this.options.className),j.onselectstart=f,j.onmousemove=f,j.onload=o(this.fire,this,"load"),j.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(j.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),m){this._url=j.src;return}j.src=this._url,j.alt=this.options.alt},_animateZoom:function(m){var j=this._map.getZoomScale(m.zoom),C=this._map._latLngBoundsToNewLayerBounds(this._bounds,m.zoom,m.center).min;En(this._image,C,j)},_reset:function(){var m=this._image,j=new Y(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),C=j.getSize();$r(m,j.min),m.style.width=C.x+"px",m.style.height=C.y+"px"},_updateOpacity:function(){Dn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var m=this.options.errorOverlayUrl;m&&this._url!==m&&(this._url=m,this._image.src=m)},getCenter:function(){return this._bounds.getCenter()}}),dK=function(m,j,C){return new Ix(m,j,C)},jR=Ix.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var m=this._url.tagName==="VIDEO",j=this._image=m?this._url:Gt("video");if(Tt(j,"leaflet-image-layer"),this._zoomAnimated&&Tt(j,"leaflet-zoom-animated"),this.options.className&&Tt(j,this.options.className),j.onselectstart=f,j.onmousemove=f,j.onloadeddata=o(this.fire,this,"load"),m){for(var C=j.getElementsByTagName("source"),I=[],W=0;W<C.length;W++)I.push(C[W].src);this._url=C.length>0?I:[j.src];return}b(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(j.style,"objectFit")&&(j.style.objectFit="fill"),j.autoplay=!!this.options.autoplay,j.loop=!!this.options.loop,j.muted=!!this.options.muted,j.playsInline=!!this.options.playsInline;for(var te=0;te<this._url.length;te++){var be=Gt("source");be.src=this._url[te],j.appendChild(be)}}});function uK(m,j,C){return new jR(m,j,C)}var NR=Ix.extend({_initImage:function(){var m=this._image=this._url;Tt(m,"leaflet-image-layer"),this._zoomAnimated&&Tt(m,"leaflet-zoom-animated"),this.options.className&&Tt(m,this.options.className),m.onselectstart=f,m.onmousemove=f}});function hK(m,j,C){return new NR(m,j,C)}var nl=go.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(m,j){m&&(m instanceof re||b(m))?(this._latlng=ye(m),v(this,j)):(v(this,m),this._source=j),this.options.content&&(this._content=this.options.content)},openOn:function(m){return m=arguments.length?m:this._source._map,m.hasLayer(this)||m.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(m){return this._map?this.close():(arguments.length?this._source=m:m=this._source,this._prepareOpen(),this.openOn(m._map)),this},onAdd:function(m){this._zoomAnimated=m._zoomAnimated,this._container||this._initLayout(),m._fadeAnimated&&Dn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),m._fadeAnimated&&Dn(this._container,1),this.bringToFront(),this.options.interactive&&(Tt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(m){m._fadeAnimated?(Dn(this._container,0),this._removeTimeout=setTimeout(o(xr,void 0,this._container),200)):xr(this._container),this.options.interactive&&(kr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(m){return this._latlng=ye(m),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(m){return this._content=m,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var m={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(m.zoomanim=this._animateZoom),m},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&jr(this._container),this},bringToBack:function(){return this._map&&en(this._container),this},_prepareOpen:function(m){var j=this._source;if(!j._map)return!1;if(j instanceof Wl){j=null;var C=this._source._layers;for(var I in C)if(C[I]._map){j=C[I];break}if(!j)return!1;this._source=j}if(!m)if(j.getCenter)m=j.getCenter();else if(j.getLatLng)m=j.getLatLng();else if(j.getBounds)m=j.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(m),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var m=this._contentNode,j=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof j=="string")m.innerHTML=j;else{for(;m.hasChildNodes();)m.removeChild(m.firstChild);m.appendChild(j)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var m=this._map.latLngToLayerPoint(this._latlng),j=Z(this.options.offset),C=this._getAnchor();this._zoomAnimated?$r(this._container,m.add(C)):j=j.add(m).add(C);var I=this._containerBottom=-j.y,W=this._containerLeft=-Math.round(this._containerWidth/2)+j.x;this._container.style.bottom=I+"px",this._container.style.left=W+"px"}},_getAnchor:function(){return[0,0]}});tn.include({_initOverlay:function(m,j,C,I){var W=j;return W instanceof m||(W=new m(I).setContent(j)),C&&W.setLatLng(C),W}}),go.include({_initOverlay:function(m,j,C,I){var W=C;return W instanceof m?(v(W,I),W._source=this):(W=j&&!I?j:new m(I,this),W.setContent(C)),W}});var $x=nl.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(m){return m=arguments.length?m:this._source._map,!m.hasLayer(this)&&m._popup&&m._popup.options.autoClose&&m.removeLayer(m._popup),m._popup=this,nl.prototype.openOn.call(this,m)},onAdd:function(m){nl.prototype.onAdd.call(this,m),m.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Yc||this._source.on("preclick",tl))},onRemove:function(m){nl.prototype.onRemove.call(this,m),m.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Yc||this._source.off("preclick",tl))},getEvents:function(){var m=nl.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(m.preclick=this.close),this.options.keepInView&&(m.moveend=this._adjustPan),m},_initLayout:function(){var m="leaflet-popup",j=this._container=Gt("div",m+" "+(this.options.className||"")+" leaflet-zoom-animated"),C=this._wrapper=Gt("div",m+"-content-wrapper",j);if(this._contentNode=Gt("div",m+"-content",C),Xa(j),Mh(this._contentNode),Nr(j,"contextmenu",tl),this._tipContainer=Gt("div",m+"-tip-container",j),this._tip=Gt("div",m+"-tip",this._tipContainer),this.options.closeButton){var I=this._closeButton=Gt("a",m+"-close-button",j);I.setAttribute("role","button"),I.setAttribute("aria-label","Close popup"),I.href="#close",I.innerHTML='<span aria-hidden="true">&#215;</span>',Nr(I,"click",function(W){es(W),this.close()},this)}},_updateLayout:function(){var m=this._contentNode,j=m.style;j.width="",j.whiteSpace="nowrap";var C=m.offsetWidth;C=Math.min(C,this.options.maxWidth),C=Math.max(C,this.options.minWidth),j.width=C+1+"px",j.whiteSpace="",j.height="";var I=m.offsetHeight,W=this.options.maxHeight,te="leaflet-popup-scrolled";W&&I>W?(j.height=W+"px",Tt(m,te)):kr(m,te),this._containerWidth=this._container.offsetWidth},_animateZoom:function(m){var j=this._map._latLngToNewLayerPoint(this._latlng,m.zoom,m.center),C=this._getAnchor();$r(this._container,j.add(C))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var m=this._map,j=parseInt(or(this._container,"marginBottom"),10)||0,C=this._container.offsetHeight+j,I=this._containerWidth,W=new q(this._containerLeft,-C-this._containerBottom);W._add(Qn(this._container));var te=m.layerPointToContainerPoint(W),be=Z(this.options.autoPanPadding),$e=Z(this.options.autoPanPaddingTopLeft||be),Ve=Z(this.options.autoPanPaddingBottomRight||be),ht=m.getSize(),Ut=0,pr=0;te.x+I+Ve.x>ht.x&&(Ut=te.x+I-ht.x+Ve.x),te.x-Ut-$e.x<0&&(Ut=te.x-$e.x),te.y+C+Ve.y>ht.y&&(pr=te.y+C-ht.y+Ve.y),te.y-pr-$e.y<0&&(pr=te.y-$e.y),(Ut||pr)&&(this.options.keepInView&&(this._autopanning=!0),m.fire("autopanstart").panBy([Ut,pr]))}},_getAnchor:function(){return Z(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),fK=function(m,j){return new $x(m,j)};tn.mergeOptions({closePopupOnClick:!0}),tn.include({openPopup:function(m,j,C){return this._initOverlay($x,m,j,C).openOn(this),this},closePopup:function(m){return m=arguments.length?m:this._popup,m&&m.close(),this}}),go.include({bindPopup:function(m,j){return this._popup=this._initOverlay($x,this._popup,m,j),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(m){return this._popup&&(this instanceof Wl||(this._popup._source=this),this._popup._prepareOpen(m||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(m){return this._popup&&this._popup.setContent(m),this},getPopup:function(){return this._popup},_openPopup:function(m){if(!(!this._popup||!this._map)){Vl(m);var j=m.layer||m.target;if(this._popup._source===j&&!(j instanceof Yc)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(m.latlng);return}this._popup._source=j,this.openPopup(m.latlng)}},_movePopup:function(m){this._popup.setLatLng(m.latlng)},_onKeyPress:function(m){m.originalEvent.keyCode===13&&this._openPopup(m)}});var Lx=nl.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(m){nl.prototype.onAdd.call(this,m),this.setOpacity(this.options.opacity),m.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(m){nl.prototype.onRemove.call(this,m),m.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var m=nl.prototype.getEvents.call(this);return this.options.permanent||(m.preclick=this.close),m},_initLayout:function(){var m="leaflet-tooltip",j=m+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Gt("div",j),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(m){var j,C,I=this._map,W=this._container,te=I.latLngToContainerPoint(I.getCenter()),be=I.layerPointToContainerPoint(m),$e=this.options.direction,Ve=W.offsetWidth,ht=W.offsetHeight,Ut=Z(this.options.offset),pr=this._getAnchor();$e==="top"?(j=Ve/2,C=ht):$e==="bottom"?(j=Ve/2,C=0):$e==="center"?(j=Ve/2,C=ht/2):$e==="right"?(j=0,C=ht/2):$e==="left"?(j=Ve,C=ht/2):be.x<te.x?($e="right",j=0,C=ht/2):($e="left",j=Ve+(Ut.x+pr.x)*2,C=ht/2),m=m.subtract(Z(j,C,!0)).add(Ut).add(pr),kr(W,"leaflet-tooltip-right"),kr(W,"leaflet-tooltip-left"),kr(W,"leaflet-tooltip-top"),kr(W,"leaflet-tooltip-bottom"),Tt(W,"leaflet-tooltip-"+$e),$r(W,m)},_updatePosition:function(){var m=this._map.latLngToLayerPoint(this._latlng);this._setPosition(m)},setOpacity:function(m){this.options.opacity=m,this._container&&Dn(this._container,m)},_animateZoom:function(m){var j=this._map._latLngToNewLayerPoint(this._latlng,m.zoom,m.center);this._setPosition(j)},_getAnchor:function(){return Z(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),mK=function(m,j){return new Lx(m,j)};tn.include({openTooltip:function(m,j,C){return this._initOverlay(Lx,m,j,C).openOn(this),this},closeTooltip:function(m){return m.close(),this}}),go.include({bindTooltip:function(m,j){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Lx,this._tooltip,m,j),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(m){if(!(!m&&this._tooltipHandlersAdded)){var j=m?"off":"on",C={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?C.add=this._openTooltip:(C.mouseover=this._openTooltip,C.mouseout=this.closeTooltip,C.click=this._openTooltip,this._map?this._addFocusListeners():C.add=this._addFocusListeners),this._tooltip.options.sticky&&(C.mousemove=this._moveTooltip),this[j](C),this._tooltipHandlersAdded=!m}},openTooltip:function(m){return this._tooltip&&(this instanceof Wl||(this._tooltip._source=this),this._tooltip._prepareOpen(m)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(m){return this._tooltip&&this._tooltip.setContent(m),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(m){var j=typeof m.getElement=="function"&&m.getElement();j&&(Nr(j,"focus",function(){this._tooltip._source=m,this.openTooltip()},this),Nr(j,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(m){var j=typeof m.getElement=="function"&&m.getElement();j&&j.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(m){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var j=this;this._map.once("moveend",function(){j._openOnceFlag=!1,j._openTooltip(m)});return}this._tooltip._source=m.layer||m.target,this.openTooltip(this._tooltip.options.sticky?m.latlng:void 0)}},_moveTooltip:function(m){var j=m.latlng,C,I;this._tooltip.options.sticky&&m.originalEvent&&(C=this._map.mouseEventToContainerPoint(m.originalEvent),I=this._map.containerPointToLayerPoint(C),j=this._map.layerPointToLatLng(I)),this._tooltip.setLatLng(j)}});var SR=Lh.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(m){var j=m&&m.tagName==="DIV"?m:document.createElement("div"),C=this.options;if(C.html instanceof Element?(Xt(j),j.appendChild(C.html)):j.innerHTML=C.html!==!1?C.html:"",C.bgPos){var I=Z(C.bgPos);j.style.backgroundPosition=-I.x+"px "+-I.y+"px"}return this._setIconStyles(j,"icon"),j},createShadow:function(){return null}});function pK(m){return new SR(m)}Lh.Default=qp;var Vp=go.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Le.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(m){v(this,m)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(m){m._addZoomLimit(this)},onRemove:function(m){this._removeAllTiles(),xr(this._container),m._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(jr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(en(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(m){return this.options.opacity=m,this._updateOpacity(),this},setZIndex:function(m){return this.options.zIndex=m,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var m=this._clampZoom(this._map.getZoom());m!==this._tileZoom&&(this._tileZoom=m,this._updateLevels()),this._update()}return this},getEvents:function(){var m={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),m.move=this._onMove),this._zoomAnimated&&(m.zoomanim=this._animateZoom),m},createTile:function(){return document.createElement("div")},getTileSize:function(){var m=this.options.tileSize;return m instanceof q?m:new q(m,m)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(m){for(var j=this.getPane().children,C=-m(-1/0,1/0),I=0,W=j.length,te;I<W;I++)te=j[I].style.zIndex,j[I]!==this._container&&te&&(C=m(C,+te));isFinite(C)&&(this.options.zIndex=C+m(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Le.ielt9){Dn(this._container,this.options.opacity);var m=+new Date,j=!1,C=!1;for(var I in this._tiles){var W=this._tiles[I];if(!(!W.current||!W.loaded)){var te=Math.min(1,(m-W.loaded)/200);Dn(W.el,te),te<1?j=!0:(W.active?C=!0:this._onOpaqueTile(W),W.active=!0)}}C&&!this._noPrune&&this._pruneTiles(),j&&(z(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this))}},_onOpaqueTile:f,_initContainer:function(){this._container||(this._container=Gt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var m=this._tileZoom,j=this.options.maxZoom;if(m!==void 0){for(var C in this._levels)C=Number(C),this._levels[C].el.children.length||C===m?(this._levels[C].el.style.zIndex=j-Math.abs(m-C),this._onUpdateLevel(C)):(xr(this._levels[C].el),this._removeTilesAtZoom(C),this._onRemoveLevel(C),delete this._levels[C]);var I=this._levels[m],W=this._map;return I||(I=this._levels[m]={},I.el=Gt("div","leaflet-tile-container leaflet-zoom-animated",this._container),I.el.style.zIndex=j,I.origin=W.project(W.unproject(W.getPixelOrigin()),m).round(),I.zoom=m,this._setZoomTransform(I,W.getCenter(),W.getZoom()),f(I.el.offsetWidth),this._onCreateLevel(I)),this._level=I,I}},_onUpdateLevel:f,_onRemoveLevel:f,_onCreateLevel:f,_pruneTiles:function(){if(this._map){var m,j,C=this._map.getZoom();if(C>this.options.maxZoom||C<this.options.minZoom){this._removeAllTiles();return}for(m in this._tiles)j=this._tiles[m],j.retain=j.current;for(m in this._tiles)if(j=this._tiles[m],j.current&&!j.active){var I=j.coords;this._retainParent(I.x,I.y,I.z,I.z-5)||this._retainChildren(I.x,I.y,I.z,I.z+2)}for(m in this._tiles)this._tiles[m].retain||this._removeTile(m)}},_removeTilesAtZoom:function(m){for(var j in this._tiles)this._tiles[j].coords.z===m&&this._removeTile(j)},_removeAllTiles:function(){for(var m in this._tiles)this._removeTile(m)},_invalidateAll:function(){for(var m in this._levels)xr(this._levels[m].el),this._onRemoveLevel(Number(m)),delete this._levels[m];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(m,j,C,I){var W=Math.floor(m/2),te=Math.floor(j/2),be=C-1,$e=new q(+W,+te);$e.z=+be;var Ve=this._tileCoordsToKey($e),ht=this._tiles[Ve];return ht&&ht.active?(ht.retain=!0,!0):(ht&&ht.loaded&&(ht.retain=!0),be>I?this._retainParent(W,te,be,I):!1)},_retainChildren:function(m,j,C,I){for(var W=2*m;W<2*m+2;W++)for(var te=2*j;te<2*j+2;te++){var be=new q(W,te);be.z=C+1;var $e=this._tileCoordsToKey(be),Ve=this._tiles[$e];if(Ve&&Ve.active){Ve.retain=!0;continue}else Ve&&Ve.loaded&&(Ve.retain=!0);C+1<I&&this._retainChildren(W,te,C+1,I)}},_resetView:function(m){var j=m&&(m.pinch||m.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),j,j)},_animateZoom:function(m){this._setView(m.center,m.zoom,!0,m.noUpdate)},_clampZoom:function(m){var j=this.options;return j.minNativeZoom!==void 0&&m<j.minNativeZoom?j.minNativeZoom:j.maxNativeZoom!==void 0&&j.maxNativeZoom<m?j.maxNativeZoom:m},_setView:function(m,j,C,I){var W=Math.round(j);this.options.maxZoom!==void 0&&W>this.options.maxZoom||this.options.minZoom!==void 0&&W<this.options.minZoom?W=void 0:W=this._clampZoom(W);var te=this.options.updateWhenZooming&&W!==this._tileZoom;(!I||te)&&(this._tileZoom=W,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),W!==void 0&&this._update(m),C||this._pruneTiles(),this._noPrune=!!C),this._setZoomTransforms(m,j)},_setZoomTransforms:function(m,j){for(var C in this._levels)this._setZoomTransform(this._levels[C],m,j)},_setZoomTransform:function(m,j,C){var I=this._map.getZoomScale(C,m.zoom),W=m.origin.multiplyBy(I).subtract(this._map._getNewPixelOrigin(j,C)).round();Le.any3d?En(m.el,W,I):$r(m.el,W)},_resetGrid:function(){var m=this._map,j=m.options.crs,C=this._tileSize=this.getTileSize(),I=this._tileZoom,W=this._map.getPixelWorldBounds(this._tileZoom);W&&(this._globalTileRange=this._pxBoundsToTileRange(W)),this._wrapX=j.wrapLng&&!this.options.noWrap&&[Math.floor(m.project([0,j.wrapLng[0]],I).x/C.x),Math.ceil(m.project([0,j.wrapLng[1]],I).x/C.y)],this._wrapY=j.wrapLat&&!this.options.noWrap&&[Math.floor(m.project([j.wrapLat[0],0],I).y/C.x),Math.ceil(m.project([j.wrapLat[1],0],I).y/C.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(m){var j=this._map,C=j._animatingZoom?Math.max(j._animateToZoom,j.getZoom()):j.getZoom(),I=j.getZoomScale(C,this._tileZoom),W=j.project(m,this._tileZoom).floor(),te=j.getSize().divideBy(I*2);return new Y(W.subtract(te),W.add(te))},_update:function(m){var j=this._map;if(j){var C=this._clampZoom(j.getZoom());if(m===void 0&&(m=j.getCenter()),this._tileZoom!==void 0){var I=this._getTiledPixelBounds(m),W=this._pxBoundsToTileRange(I),te=W.getCenter(),be=[],$e=this.options.keepBuffer,Ve=new Y(W.getBottomLeft().subtract([$e,-$e]),W.getTopRight().add([$e,-$e]));if(!(isFinite(W.min.x)&&isFinite(W.min.y)&&isFinite(W.max.x)&&isFinite(W.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ht in this._tiles){var Ut=this._tiles[ht].coords;(Ut.z!==this._tileZoom||!Ve.contains(new q(Ut.x,Ut.y)))&&(this._tiles[ht].current=!1)}if(Math.abs(C-this._tileZoom)>1){this._setView(m,C);return}for(var pr=W.min.y;pr<=W.max.y;pr++)for(var Kr=W.min.x;Kr<=W.max.x;Kr++){var Ia=new q(Kr,pr);if(Ia.z=this._tileZoom,!!this._isValidTile(Ia)){var Zs=this._tiles[this._tileCoordsToKey(Ia)];Zs?Zs.current=!0:be.push(Ia)}}if(be.sort(function(Qa,Uh){return Qa.distanceTo(te)-Uh.distanceTo(te)}),be.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Fi=document.createDocumentFragment();for(Kr=0;Kr<be.length;Kr++)this._addTile(be[Kr],Fi);this._level.el.appendChild(Fi)}}}},_isValidTile:function(m){var j=this._map.options.crs;if(!j.infinite){var C=this._globalTileRange;if(!j.wrapLng&&(m.x<C.min.x||m.x>C.max.x)||!j.wrapLat&&(m.y<C.min.y||m.y>C.max.y))return!1}if(!this.options.bounds)return!0;var I=this._tileCoordsToBounds(m);return ne(this.options.bounds).overlaps(I)},_keyToBounds:function(m){return this._tileCoordsToBounds(this._keyToTileCoords(m))},_tileCoordsToNwSe:function(m){var j=this._map,C=this.getTileSize(),I=m.scaleBy(C),W=I.add(C),te=j.unproject(I,m.z),be=j.unproject(W,m.z);return[te,be]},_tileCoordsToBounds:function(m){var j=this._tileCoordsToNwSe(m),C=new X(j[0],j[1]);return this.options.noWrap||(C=this._map.wrapLatLngBounds(C)),C},_tileCoordsToKey:function(m){return m.x+":"+m.y+":"+m.z},_keyToTileCoords:function(m){var j=m.split(":"),C=new q(+j[0],+j[1]);return C.z=+j[2],C},_removeTile:function(m){var j=this._tiles[m];j&&(xr(j.el),delete this._tiles[m],this.fire("tileunload",{tile:j.el,coords:this._keyToTileCoords(m)}))},_initTile:function(m){Tt(m,"leaflet-tile");var j=this.getTileSize();m.style.width=j.x+"px",m.style.height=j.y+"px",m.onselectstart=f,m.onmousemove=f,Le.ielt9&&this.options.opacity<1&&Dn(m,this.options.opacity)},_addTile:function(m,j){var C=this._getTilePos(m),I=this._tileCoordsToKey(m),W=this.createTile(this._wrapCoords(m),o(this._tileReady,this,m));this._initTile(W),this.createTile.length<2&&O(o(this._tileReady,this,m,null,W)),$r(W,C),this._tiles[I]={el:W,coords:m,current:!0},j.appendChild(W),this.fire("tileloadstart",{tile:W,coords:m})},_tileReady:function(m,j,C){j&&this.fire("tileerror",{error:j,tile:C,coords:m});var I=this._tileCoordsToKey(m);C=this._tiles[I],C&&(C.loaded=+new Date,this._map._fadeAnimated?(Dn(C.el,0),z(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this)):(C.active=!0,this._pruneTiles()),j||(Tt(C.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:C.el,coords:m})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Le.ielt9||!this._map._fadeAnimated?O(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(m){return m.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(m){var j=new q(this._wrapX?u(m.x,this._wrapX):m.x,this._wrapY?u(m.y,this._wrapY):m.y);return j.z=m.z,j},_pxBoundsToTileRange:function(m){var j=this.getTileSize();return new Y(m.min.unscaleBy(j).floor(),m.max.unscaleBy(j).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var m in this._tiles)if(!this._tiles[m].loaded)return!1;return!0}});function gK(m){return new Vp(m)}var Bh=Vp.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(m,j){this._url=m,j=v(this,j),j.detectRetina&&Le.retina&&j.maxZoom>0?(j.tileSize=Math.floor(j.tileSize/2),j.zoomReverse?(j.zoomOffset--,j.minZoom=Math.min(j.maxZoom,j.minZoom+1)):(j.zoomOffset++,j.maxZoom=Math.max(j.minZoom,j.maxZoom-1)),j.minZoom=Math.max(0,j.minZoom)):j.zoomReverse?j.minZoom=Math.min(j.maxZoom,j.minZoom):j.maxZoom=Math.max(j.minZoom,j.maxZoom),typeof j.subdomains=="string"&&(j.subdomains=j.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(m,j){return this._url===m&&j===void 0&&(j=!0),this._url=m,j||this.redraw(),this},createTile:function(m,j){var C=document.createElement("img");return Nr(C,"load",o(this._tileOnLoad,this,j,C)),Nr(C,"error",o(this._tileOnError,this,j,C)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(C.referrerPolicy=this.options.referrerPolicy),C.alt="",C.src=this.getTileUrl(m),C},getTileUrl:function(m){var j={r:Le.retina?"@2x":"",s:this._getSubdomain(m),x:m.x,y:m.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var C=this._globalTileRange.max.y-m.y;this.options.tms&&(j.y=C),j["-y"]=C}return w(this._url,a(j,this.options))},_tileOnLoad:function(m,j){Le.ielt9?setTimeout(o(m,this,null,j),0):m(null,j)},_tileOnError:function(m,j,C){var I=this.options.errorTileUrl;I&&j.getAttribute("src")!==I&&(j.src=I),m(C,j)},_onTileRemove:function(m){m.tile.onload=null},_getZoomForUrl:function(){var m=this._tileZoom,j=this.options.maxZoom,C=this.options.zoomReverse,I=this.options.zoomOffset;return C&&(m=j-m),m+I},_getSubdomain:function(m){var j=Math.abs(m.x+m.y)%this.options.subdomains.length;return this.options.subdomains[j]},_abortLoading:function(){var m,j;for(m in this._tiles)if(this._tiles[m].coords.z!==this._tileZoom&&(j=this._tiles[m].el,j.onload=f,j.onerror=f,!j.complete)){j.src=S;var C=this._tiles[m].coords;xr(j),delete this._tiles[m],this.fire("tileabort",{tile:j,coords:C})}},_removeTile:function(m){var j=this._tiles[m];if(j)return j.el.setAttribute("src",S),Vp.prototype._removeTile.call(this,m)},_tileReady:function(m,j,C){if(!(!this._map||C&&C.getAttribute("src")===S))return Vp.prototype._tileReady.call(this,m,j,C)}});function kR(m,j){return new Bh(m,j)}var ER=Bh.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(m,j){this._url=m;var C=a({},this.defaultWmsParams);for(var I in j)I in this.options||(C[I]=j[I]);j=v(this,j);var W=j.detectRetina&&Le.retina?2:1,te=this.getTileSize();C.width=te.x*W,C.height=te.y*W,this.wmsParams=C},onAdd:function(m){this._crs=this.options.crs||m.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var j=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[j]=this._crs.code,Bh.prototype.onAdd.call(this,m)},getTileUrl:function(m){var j=this._tileCoordsToNwSe(m),C=this._crs,I=Q(C.project(j[0]),C.project(j[1])),W=I.min,te=I.max,be=(this._wmsVersion>=1.3&&this._crs===xR?[W.y,W.x,te.y,te.x]:[W.x,W.y,te.x,te.y]).join(","),$e=Bh.prototype.getTileUrl.call(this,m);return $e+y(this.wmsParams,$e,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+be},setParams:function(m,j){return a(this.wmsParams,m),j||this.redraw(),this}});function vK(m,j){return new ER(m,j)}Bh.WMS=ER,kR.wms=vK;var Yl=go.extend({options:{padding:.1},initialize:function(m){v(this,m),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Tt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var m={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(m.zoomanim=this._onAnimZoom),m},_onAnimZoom:function(m){this._updateTransform(m.center,m.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(m,j){var C=this._map.getZoomScale(j,this._zoom),I=this._map.getSize().multiplyBy(.5+this.options.padding),W=this._map.project(this._center,j),te=I.multiplyBy(-C).add(W).subtract(this._map._getNewPixelOrigin(m,j));Le.any3d?En(this._container,te,C):$r(this._container,te)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var m in this._layers)this._layers[m]._reset()},_onZoomEnd:function(){for(var m in this._layers)this._layers[m]._project()},_updatePaths:function(){for(var m in this._layers)this._layers[m]._update()},_update:function(){var m=this.options.padding,j=this._map.getSize(),C=this._map.containerPointToLayerPoint(j.multiplyBy(-m)).round();this._bounds=new Y(C,C.add(j.multiplyBy(1+m*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),CR=Yl.extend({options:{tolerance:0},getEvents:function(){var m=Yl.prototype.getEvents.call(this);return m.viewprereset=this._onViewPreReset,m},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Yl.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var m=this._container=document.createElement("canvas");Nr(m,"mousemove",this._onMouseMove,this),Nr(m,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Nr(m,"mouseout",this._handleMouseOut,this),m._leaflet_disable_events=!0,this._ctx=m.getContext("2d")},_destroyContainer:function(){z(this._redrawRequest),delete this._ctx,xr(this._container),fn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var m;this._redrawBounds=null;for(var j in this._layers)m=this._layers[j],m._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Yl.prototype._update.call(this);var m=this._bounds,j=this._container,C=m.getSize(),I=Le.retina?2:1;$r(j,m.min),j.width=I*C.x,j.height=I*C.y,j.style.width=C.x+"px",j.style.height=C.y+"px",Le.retina&&this._ctx.scale(2,2),this._ctx.translate(-m.min.x,-m.min.y),this.fire("update")}},_reset:function(){Yl.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(m){this._updateDashArray(m),this._layers[c(m)]=m;var j=m._order={layer:m,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=j),this._drawLast=j,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(m){this._requestRedraw(m)},_removePath:function(m){var j=m._order,C=j.next,I=j.prev;C?C.prev=I:this._drawLast=I,I?I.next=C:this._drawFirst=C,delete m._order,delete this._layers[c(m)],this._requestRedraw(m)},_updatePath:function(m){this._extendRedrawBounds(m),m._project(),m._update(),this._requestRedraw(m)},_updateStyle:function(m){this._updateDashArray(m),this._requestRedraw(m)},_updateDashArray:function(m){if(typeof m.options.dashArray=="string"){var j=m.options.dashArray.split(/[, ]+/),C=[],I,W;for(W=0;W<j.length;W++){if(I=Number(j[W]),isNaN(I))return;C.push(I)}m.options._dashArray=C}else m.options._dashArray=m.options.dashArray},_requestRedraw:function(m){this._map&&(this._extendRedrawBounds(m),this._redrawRequest=this._redrawRequest||O(this._redraw,this))},_extendRedrawBounds:function(m){if(m._pxBounds){var j=(m.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Y,this._redrawBounds.extend(m._pxBounds.min.subtract([j,j])),this._redrawBounds.extend(m._pxBounds.max.add([j,j]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var m=this._redrawBounds;if(m){var j=m.getSize();this._ctx.clearRect(m.min.x,m.min.y,j.x,j.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var m,j=this._redrawBounds;if(this._ctx.save(),j){var C=j.getSize();this._ctx.beginPath(),this._ctx.rect(j.min.x,j.min.y,C.x,C.y),this._ctx.clip()}this._drawing=!0;for(var I=this._drawFirst;I;I=I.next)m=I.layer,(!j||m._pxBounds&&m._pxBounds.intersects(j))&&m._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(m,j){if(this._drawing){var C,I,W,te,be=m._parts,$e=be.length,Ve=this._ctx;if($e){for(Ve.beginPath(),C=0;C<$e;C++){for(I=0,W=be[C].length;I<W;I++)te=be[C][I],Ve[I?"lineTo":"moveTo"](te.x,te.y);j&&Ve.closePath()}this._fillStroke(Ve,m)}}},_updateCircle:function(m){if(!(!this._drawing||m._empty())){var j=m._point,C=this._ctx,I=Math.max(Math.round(m._radius),1),W=(Math.max(Math.round(m._radiusY),1)||I)/I;W!==1&&(C.save(),C.scale(1,W)),C.beginPath(),C.arc(j.x,j.y/W,I,0,Math.PI*2,!1),W!==1&&C.restore(),this._fillStroke(C,m)}},_fillStroke:function(m,j){var C=j.options;C.fill&&(m.globalAlpha=C.fillOpacity,m.fillStyle=C.fillColor||C.color,m.fill(C.fillRule||"evenodd")),C.stroke&&C.weight!==0&&(m.setLineDash&&m.setLineDash(j.options&&j.options._dashArray||[]),m.globalAlpha=C.opacity,m.lineWidth=C.weight,m.strokeStyle=C.color,m.lineCap=C.lineCap,m.lineJoin=C.lineJoin,m.stroke())},_onClick:function(m){for(var j=this._map.mouseEventToLayerPoint(m),C,I,W=this._drawFirst;W;W=W.next)C=W.layer,C.options.interactive&&C._containsPoint(j)&&(!(m.type==="click"||m.type==="preclick")||!this._map._draggableMoved(C))&&(I=C);this._fireEvent(I?[I]:!1,m)},_onMouseMove:function(m){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var j=this._map.mouseEventToLayerPoint(m);this._handleMouseHover(m,j)}},_handleMouseOut:function(m){var j=this._hoveredLayer;j&&(kr(this._container,"leaflet-interactive"),this._fireEvent([j],m,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(m,j){if(!this._mouseHoverThrottled){for(var C,I,W=this._drawFirst;W;W=W.next)C=W.layer,C.options.interactive&&C._containsPoint(j)&&(I=C);I!==this._hoveredLayer&&(this._handleMouseOut(m),I&&(Tt(this._container,"leaflet-interactive"),this._fireEvent([I],m,"mouseover"),this._hoveredLayer=I)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,m),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(m,j,C){this._map._fireDOMEvent(j,C||j.type,m)},_bringToFront:function(m){var j=m._order;if(j){var C=j.next,I=j.prev;if(C)C.prev=I;else return;I?I.next=C:C&&(this._drawFirst=C),j.prev=this._drawLast,this._drawLast.next=j,j.next=null,this._drawLast=j,this._requestRedraw(m)}},_bringToBack:function(m){var j=m._order;if(j){var C=j.next,I=j.prev;if(I)I.next=C;else return;C?C.prev=I:I&&(this._drawLast=I),j.prev=null,j.next=this._drawFirst,this._drawFirst.prev=j,this._drawFirst=j,this._requestRedraw(m)}}});function PR(m){return Le.canvas?new CR(m):null}var Wp=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(m){return document.createElement("<lvml:"+m+' class="lvml">')}}catch(m){}return function(m){return document.createElement("<"+m+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),yK={_initContainer:function(){this._container=Gt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Yl.prototype._update.call(this),this.fire("update"))},_initPath:function(m){var j=m._container=Wp("shape");Tt(j,"leaflet-vml-shape "+(this.options.className||"")),j.coordsize="1 1",m._path=Wp("path"),j.appendChild(m._path),this._updateStyle(m),this._layers[c(m)]=m},_addPath:function(m){var j=m._container;this._container.appendChild(j),m.options.interactive&&m.addInteractiveTarget(j)},_removePath:function(m){var j=m._container;xr(j),m.removeInteractiveTarget(j),delete this._layers[c(m)]},_updateStyle:function(m){var j=m._stroke,C=m._fill,I=m.options,W=m._container;W.stroked=!!I.stroke,W.filled=!!I.fill,I.stroke?(j||(j=m._stroke=Wp("stroke")),W.appendChild(j),j.weight=I.weight+"px",j.color=I.color,j.opacity=I.opacity,I.dashArray?j.dashStyle=b(I.dashArray)?I.dashArray.join(" "):I.dashArray.replace(/( *, *)/g," "):j.dashStyle="",j.endcap=I.lineCap.replace("butt","flat"),j.joinstyle=I.lineJoin):j&&(W.removeChild(j),m._stroke=null),I.fill?(C||(C=m._fill=Wp("fill")),W.appendChild(C),C.color=I.fillColor||I.color,C.opacity=I.fillOpacity):C&&(W.removeChild(C),m._fill=null)},_updateCircle:function(m){var j=m._point.round(),C=Math.round(m._radius),I=Math.round(m._radiusY||C);this._setPath(m,m._empty()?"M0 0":"AL "+j.x+","+j.y+" "+C+","+I+" 0,"+65535*360)},_setPath:function(m,j){m._path.v=j},_bringToFront:function(m){jr(m._container)},_bringToBack:function(m){en(m._container)}},Fx=Le.vml?Wp:ae,Hp=Yl.extend({_initContainer:function(){this._container=Fx("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Fx("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){xr(this._container),fn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Yl.prototype._update.call(this);var m=this._bounds,j=m.getSize(),C=this._container;(!this._svgSize||!this._svgSize.equals(j))&&(this._svgSize=j,C.setAttribute("width",j.x),C.setAttribute("height",j.y)),$r(C,m.min),C.setAttribute("viewBox",[m.min.x,m.min.y,j.x,j.y].join(" ")),this.fire("update")}},_initPath:function(m){var j=m._path=Fx("path");m.options.className&&Tt(j,m.options.className),m.options.interactive&&Tt(j,"leaflet-interactive"),this._updateStyle(m),this._layers[c(m)]=m},_addPath:function(m){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(m._path),m.addInteractiveTarget(m._path)},_removePath:function(m){xr(m._path),m.removeInteractiveTarget(m._path),delete this._layers[c(m)]},_updatePath:function(m){m._project(),m._update()},_updateStyle:function(m){var j=m._path,C=m.options;j&&(C.stroke?(j.setAttribute("stroke",C.color),j.setAttribute("stroke-opacity",C.opacity),j.setAttribute("stroke-width",C.weight),j.setAttribute("stroke-linecap",C.lineCap),j.setAttribute("stroke-linejoin",C.lineJoin),C.dashArray?j.setAttribute("stroke-dasharray",C.dashArray):j.removeAttribute("stroke-dasharray"),C.dashOffset?j.setAttribute("stroke-dashoffset",C.dashOffset):j.removeAttribute("stroke-dashoffset")):j.setAttribute("stroke","none"),C.fill?(j.setAttribute("fill",C.fillColor||C.color),j.setAttribute("fill-opacity",C.fillOpacity),j.setAttribute("fill-rule",C.fillRule||"evenodd")):j.setAttribute("fill","none"))},_updatePoly:function(m,j){this._setPath(m,we(m._parts,j))},_updateCircle:function(m){var j=m._point,C=Math.max(Math.round(m._radius),1),I=Math.max(Math.round(m._radiusY),1)||C,W="a"+C+","+I+" 0 1,0 ",te=m._empty()?"M0 0":"M"+(j.x-C)+","+j.y+W+C*2+",0 "+W+-C*2+",0 ";this._setPath(m,te)},_setPath:function(m,j){m._path.setAttribute("d",j)},_bringToFront:function(m){jr(m._path)},_bringToBack:function(m){en(m._path)}});Le.vml&&Hp.include(yK);function TR(m){return Le.svg||Le.vml?new Hp(m):null}tn.include({getRenderer:function(m){var j=m.options.renderer||this._getPaneRenderer(m.options.pane)||this.options.renderer||this._renderer;return j||(j=this._renderer=this._createRenderer()),this.hasLayer(j)||this.addLayer(j),j},_getPaneRenderer:function(m){if(m==="overlayPane"||m===void 0)return!1;var j=this._paneRenderers[m];return j===void 0&&(j=this._createRenderer({pane:m}),this._paneRenderers[m]=j),j},_createRenderer:function(m){return this.options.preferCanvas&&PR(m)||TR(m)}});var AR=Fh.extend({initialize:function(m,j){Fh.prototype.initialize.call(this,this._boundsToLatLngs(m),j)},setBounds:function(m){return this.setLatLngs(this._boundsToLatLngs(m))},_boundsToLatLngs:function(m){return m=ne(m),[m.getSouthWest(),m.getNorthWest(),m.getNorthEast(),m.getSouthEast()]}});function xK(m,j){return new AR(m,j)}Hp.create=Fx,Hp.pointsToPath=we,Gl.geometryToLayer=Rx,Gl.coordsToLatLng=Ij,Gl.coordsToLatLngs=Ox,Gl.latLngToCoords=$j,Gl.latLngsToCoords=Mx,Gl.getFeature=zh,Gl.asFeature=Dx,tn.mergeOptions({boxZoom:!0});var RR=kt.extend({initialize:function(m){this._map=m,this._container=m._container,this._pane=m._panes.overlayPane,this._resetStateTimeout=0,m.on("unload",this._destroy,this)},addHooks:function(){Nr(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){fn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){xr(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(m){if(!m.shiftKey||m.which!==1&&m.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),la(),Or(),this._startPoint=this._map.mouseEventToContainerPoint(m),Nr(document,{contextmenu:Vl,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(m){this._moved||(this._moved=!0,this._box=Gt("div","leaflet-zoom-box",this._container),Tt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(m);var j=new Y(this._point,this._startPoint),C=j.getSize();$r(this._box,j.min),this._box.style.width=C.x+"px",this._box.style.height=C.y+"px"},_finish:function(){this._moved&&(xr(this._box),kr(this._container,"leaflet-crosshair")),wi(),ln(),fn(document,{contextmenu:Vl,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(m){if(!(m.which!==1&&m.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var j=new X(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(j).fire("boxzoomend",{boxZoomBounds:j})}},_onKeyDown:function(m){m.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});tn.addInitHook("addHandler","boxZoom",RR),tn.mergeOptions({doubleClickZoom:!0});var OR=kt.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(m){var j=this._map,C=j.getZoom(),I=j.options.zoomDelta,W=m.originalEvent.shiftKey?C-I:C+I;j.options.doubleClickZoom==="center"?j.setZoom(W):j.setZoomAround(m.containerPoint,W)}});tn.addInitHook("addHandler","doubleClickZoom",OR),tn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var MR=kt.extend({addHooks:function(){if(!this._draggable){var m=this._map;this._draggable=new ur(m._mapPane,m._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),m.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),m.on("zoomend",this._onZoomEnd,this),m.whenReady(this._onZoomEnd,this))}Tt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){kr(this._map._container,"leaflet-grab"),kr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var m=this._map;if(m._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var j=ne(this._map.options.maxBounds);this._offsetLimit=Q(this._map.latLngToContainerPoint(j.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(j.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;m.fire("movestart").fire("dragstart"),m.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(m){if(this._map.options.inertia){var j=this._lastTime=+new Date,C=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(C),this._times.push(j),this._prunePositions(j)}this._map.fire("move",m).fire("drag",m)},_prunePositions:function(m){for(;this._positions.length>1&&m-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var m=this._map.getSize().divideBy(2),j=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=j.subtract(m).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(m,j){return m-(m-j)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var m=this._draggable._newPos.subtract(this._draggable._startPos),j=this._offsetLimit;m.x<j.min.x&&(m.x=this._viscousLimit(m.x,j.min.x)),m.y<j.min.y&&(m.y=this._viscousLimit(m.y,j.min.y)),m.x>j.max.x&&(m.x=this._viscousLimit(m.x,j.max.x)),m.y>j.max.y&&(m.y=this._viscousLimit(m.y,j.max.y)),this._draggable._newPos=this._draggable._startPos.add(m)}},_onPreDragWrap:function(){var m=this._worldWidth,j=Math.round(m/2),C=this._initialWorldOffset,I=this._draggable._newPos.x,W=(I-j+C)%m+j-C,te=(I+j+C)%m-j-C,be=Math.abs(W+C)<Math.abs(te+C)?W:te;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=be},_onDragEnd:function(m){var j=this._map,C=j.options,I=!C.inertia||m.noInertia||this._times.length<2;if(j.fire("dragend",m),I)j.fire("moveend");else{this._prunePositions(+new Date);var W=this._lastPos.subtract(this._positions[0]),te=(this._lastTime-this._times[0])/1e3,be=C.easeLinearity,$e=W.multiplyBy(be/te),Ve=$e.distanceTo([0,0]),ht=Math.min(C.inertiaMaxSpeed,Ve),Ut=$e.multiplyBy(ht/Ve),pr=ht/(C.inertiaDeceleration*be),Kr=Ut.multiplyBy(-pr/2).round();!Kr.x&&!Kr.y?j.fire("moveend"):(Kr=j._limitOffset(Kr,j.options.maxBounds),O(function(){j.panBy(Kr,{duration:pr,easeLinearity:be,noMoveStart:!0,animate:!0})}))}}});tn.addInitHook("addHandler","dragging",MR),tn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var DR=kt.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(m){this._map=m,this._setPanDelta(m.options.keyboardPanDelta),this._setZoomDelta(m.options.zoomDelta)},addHooks:function(){var m=this._map._container;m.tabIndex<=0&&(m.tabIndex="0"),Nr(m,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),fn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var m=document.body,j=document.documentElement,C=m.scrollTop||j.scrollTop,I=m.scrollLeft||j.scrollLeft;this._map._container.focus(),window.scrollTo(I,C)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(m){var j=this._panKeys={},C=this.keyCodes,I,W;for(I=0,W=C.left.length;I<W;I++)j[C.left[I]]=[-1*m,0];for(I=0,W=C.right.length;I<W;I++)j[C.right[I]]=[m,0];for(I=0,W=C.down.length;I<W;I++)j[C.down[I]]=[0,m];for(I=0,W=C.up.length;I<W;I++)j[C.up[I]]=[0,-1*m]},_setZoomDelta:function(m){var j=this._zoomKeys={},C=this.keyCodes,I,W;for(I=0,W=C.zoomIn.length;I<W;I++)j[C.zoomIn[I]]=m;for(I=0,W=C.zoomOut.length;I<W;I++)j[C.zoomOut[I]]=-m},_addHooks:function(){Nr(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){fn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(m){if(!(m.altKey||m.ctrlKey||m.metaKey)){var j=m.keyCode,C=this._map,I;if(j in this._panKeys){if(!C._panAnim||!C._panAnim._inProgress)if(I=this._panKeys[j],m.shiftKey&&(I=Z(I).multiplyBy(3)),C.options.maxBounds&&(I=C._limitOffset(Z(I),C.options.maxBounds)),C.options.worldCopyJump){var W=C.wrapLatLng(C.unproject(C.project(C.getCenter()).add(I)));C.panTo(W)}else C.panBy(I)}else if(j in this._zoomKeys)C.setZoom(C.getZoom()+(m.shiftKey?3:1)*this._zoomKeys[j]);else if(j===27&&C._popup&&C._popup.options.closeOnEscapeKey)C.closePopup();else return;Vl(m)}}});tn.addInitHook("addHandler","keyboard",DR),tn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var IR=kt.extend({addHooks:function(){Nr(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){fn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(m){var j=jx(m),C=this._map.options.wheelDebounceTime;this._delta+=j,this._lastMousePos=this._map.mouseEventToContainerPoint(m),this._startTime||(this._startTime=+new Date);var I=Math.max(C-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),I),Vl(m)},_performZoom:function(){var m=this._map,j=m.getZoom(),C=this._map.options.zoomSnap||0;m._stop();var I=this._delta/(this._map.options.wheelPxPerZoomLevel*4),W=4*Math.log(2/(1+Math.exp(-Math.abs(I))))/Math.LN2,te=C?Math.ceil(W/C)*C:W,be=m._limitZoom(j+(this._delta>0?te:-te))-j;this._delta=0,this._startTime=null,be&&(m.options.scrollWheelZoom==="center"?m.setZoom(j+be):m.setZoomAround(this._lastMousePos,j+be))}});tn.addInitHook("addHandler","scrollWheelZoom",IR);var _K=600;tn.mergeOptions({tapHold:Le.touchNative&&Le.safari&&Le.mobile,tapTolerance:15});var $R=kt.extend({addHooks:function(){Nr(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){fn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(m){if(clearTimeout(this._holdTimeout),m.touches.length===1){var j=m.touches[0];this._startPos=this._newPos=new q(j.clientX,j.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Nr(document,"touchend",es),Nr(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",j))},this),_K),Nr(document,"touchend touchcancel contextmenu",this._cancel,this),Nr(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function m(){fn(document,"touchend",es),fn(document,"touchend touchcancel",m)},_cancel:function(){clearTimeout(this._holdTimeout),fn(document,"touchend touchcancel contextmenu",this._cancel,this),fn(document,"touchmove",this._onMove,this)},_onMove:function(m){var j=m.touches[0];this._newPos=new q(j.clientX,j.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(m,j){var C=new MouseEvent(m,{bubbles:!0,cancelable:!0,view:window,screenX:j.screenX,screenY:j.screenY,clientX:j.clientX,clientY:j.clientY});C._simulated=!0,j.target.dispatchEvent(C)}});tn.addInitHook("addHandler","tapHold",$R),tn.mergeOptions({touchZoom:Le.touch,bounceAtZoomLimits:!0});var LR=kt.extend({addHooks:function(){Tt(this._map._container,"leaflet-touch-zoom"),Nr(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){kr(this._map._container,"leaflet-touch-zoom"),fn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(m){var j=this._map;if(!(!m.touches||m.touches.length!==2||j._animatingZoom||this._zooming)){var C=j.mouseEventToContainerPoint(m.touches[0]),I=j.mouseEventToContainerPoint(m.touches[1]);this._centerPoint=j.getSize()._divideBy(2),this._startLatLng=j.containerPointToLatLng(this._centerPoint),j.options.touchZoom!=="center"&&(this._pinchStartLatLng=j.containerPointToLatLng(C.add(I)._divideBy(2))),this._startDist=C.distanceTo(I),this._startZoom=j.getZoom(),this._moved=!1,this._zooming=!0,j._stop(),Nr(document,"touchmove",this._onTouchMove,this),Nr(document,"touchend touchcancel",this._onTouchEnd,this),es(m)}},_onTouchMove:function(m){if(!(!m.touches||m.touches.length!==2||!this._zooming)){var j=this._map,C=j.mouseEventToContainerPoint(m.touches[0]),I=j.mouseEventToContainerPoint(m.touches[1]),W=C.distanceTo(I)/this._startDist;if(this._zoom=j.getScaleZoom(W,this._startZoom),!j.options.bounceAtZoomLimits&&(this._zoom<j.getMinZoom()&&W<1||this._zoom>j.getMaxZoom()&&W>1)&&(this._zoom=j._limitZoom(this._zoom)),j.options.touchZoom==="center"){if(this._center=this._startLatLng,W===1)return}else{var te=C._add(I)._divideBy(2)._subtract(this._centerPoint);if(W===1&&te.x===0&&te.y===0)return;this._center=j.unproject(j.project(this._pinchStartLatLng,this._zoom).subtract(te),this._zoom)}this._moved||(j._moveStart(!0,!1),this._moved=!0),z(this._animRequest);var be=o(j._move,j,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=O(be,this,!0),es(m)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,z(this._animRequest),fn(document,"touchmove",this._onTouchMove,this),fn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});tn.addInitHook("addHandler","touchZoom",LR),tn.BoxZoom=RR,tn.DoubleClickZoom=OR,tn.Drag=MR,tn.Keyboard=DR,tn.ScrollWheelZoom=IR,tn.TapHold=$R,tn.TouchZoom=LR,r.Bounds=Y,r.Browser=Le,r.CRS=ee,r.Canvas=CR,r.Circle=Dj,r.CircleMarker=Ax,r.Class=B,r.Control=Ja,r.DivIcon=SR,r.DivOverlay=nl,r.DomEvent=Nx,r.DomUtil=Za,r.Draggable=ur,r.Evented=G,r.FeatureGroup=Wl,r.GeoJSON=Gl,r.GridLayer=Vp,r.Handler=kt,r.Icon=Lh,r.ImageOverlay=Ix,r.LatLng=re,r.LatLngBounds=X,r.Layer=go,r.LayerGroup=$h,r.LineUtil=Px,r.Map=tn,r.Marker=Tx,r.Mixin=Dt,r.Path=Yc,r.Point=q,r.PolyUtil=Ns,r.Polygon=Fh,r.Polyline=Hl,r.Popup=$x,r.PosAnimation=Fp,r.Projection=JY,r.Rectangle=AR,r.Renderer=Yl,r.SVG=Hp,r.SVGOverlay=NR,r.TileLayer=Bh,r.Tooltip=Lx,r.Transformation=se,r.Util=D,r.VideoOverlay=jR,r.bind=o,r.bounds=Q,r.canvas=PR,r.circle=iK,r.circleMarker=aK,r.control=Hc,r.divIcon=pK,r.extend=a,r.featureGroup=rK,r.geoJSON=bR,r.geoJson=cK,r.gridLayer=gK,r.icon=nK,r.imageOverlay=dK,r.latLng=ye,r.latLngBounds=ne,r.layerGroup=tK,r.map=Sx,r.marker=sK,r.point=Z,r.polygon=lK,r.polyline=oK,r.popup=fK,r.rectangle=xK,r.setOptions=v,r.stamp=c,r.svg=TR,r.svgOverlay=hK,r.tileLayer=kR,r.tooltip=mK,r.transformation=V,r.version=n,r.videoOverlay=uK;var wK=window.L;r.noConflict=function(){return window.L=wK,this},window.L=r})})(_2,_2.exports);var ya=_2.exports;const IB=yn(ya);function Zy(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function N1(e,t){return t==null?function(n,a){const i=x.useRef();return i.current||(i.current=e(n,a)),i}:function(n,a){const i=x.useRef();i.current||(i.current=e(n,a));const o=x.useRef(n),{instance:l}=i.current;return x.useEffect(function(){o.current!==n&&(t(l,n,o.current),o.current=n)},[l,n,a]),i}}function $B(e,t){x.useEffect(function(){var a;return((a=t.layerContainer)!=null?a:t.map).addLayer(e.instance),function(){var o;(o=t.layerContainer)==null||o.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function LB(e){return function(r){const n=b1(),a=e(j1(r,n),n);return RB(n.map,r.attribution),ST(a.current,r.eventHandlers),$B(a.current,n),a}}function Iue(e,t){const r=x.useRef();x.useEffect(function(){var a;if(t.pathOptions!==r.current){const i=(a=t.pathOptions)!=null?a:{};e.instance.setStyle(i),r.current=i}},[e,t])}function $ue(e){return function(r){const n=b1(),a=e(j1(r,n),n);return ST(a.current,r.eventHandlers),$B(a.current,n),Iue(a.current,r),a}}function Lue(e,t){const r=N1(e,t),n=LB(r);return DB(n)}function Fue(e,t){const r=N1(e),n=Due(r,t);return Oue(n)}function FB(e,t){const r=N1(e,t),n=$ue(r);return DB(n)}function zue(e,t){const r=N1(e,t),n=LB(r);return Mue(n)}function Bue(e,t,r){const{opacity:n,zIndex:a}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),a!=null&&a!==r.zIndex&&e.setZIndex(a)}function kh(){return b1().map}const Uue=FB(function(i,a){var o=i,{center:t,children:r}=o,n=me(o,["center","children"]);const l=new ya.Circle(t,n);return Zy(l,NT(a,{overlayContainer:l}))},Tue);function w2(){return w2=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w2.apply(this,arguments)}function que(h,f){var p=h,{bounds:e,boundsOptions:t,center:r,children:n,className:a,id:i,placeholder:o,style:l,whenReady:c,zoom:d}=p,u=me(p,["bounds","boundsOptions","center","children","className","id","placeholder","style","whenReady","zoom"]);const[g]=x.useState({className:a,id:i,style:l}),[v,y]=x.useState(null);x.useImperativeHandle(f,()=>{var b;return(b=v==null?void 0:v.map)!=null?b:null},[v]);const _=x.useCallback(b=>{if(b!==null&&v===null){const N=new ya.Map(b,u);r!=null&&d!=null?N.setView(r,d):e!=null&&N.fitBounds(e,t),c!=null&&N.whenReady(c),y(Rue(N))}},[]);x.useEffect(()=>()=>{v==null||v.map.remove()},[v]);const w=v?J.createElement(MB,{value:v},n):o!=null?o:null;return J.createElement("div",w2({},g,{ref:_}),w)}const Xy=x.forwardRef(que),ch=Lue(function(a,n){var i=a,{position:t}=i,r=me(i,["position"]);const o=new ya.Marker(t,r);return Zy(o,NT(n,{overlayContainer:o}))},function(t,r,n){r.position!==n.position&&t.setLatLng(r.position),r.icon!=null&&r.icon!==n.icon&&t.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==n.zIndexOffset&&t.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==n.opacity&&t.setOpacity(r.opacity),t.dragging!=null&&r.draggable!==n.draggable&&(r.draggable===!0?t.dragging.enable():t.dragging.disable())}),zB=FB(function(a,n){var i=a,{positions:t}=i,r=me(i,["positions"]);const o=new ya.Polyline(t,r);return Zy(o,NT(n,{overlayContainer:o}))},function(t,r,n){r.positions!==n.positions&&t.setLatLngs(r.positions)}),BB=Fue(function(t,r){const n=new ya.Popup(t,r.overlayContainer);return Zy(n,r)},function(t,r,{position:n},a){x.useEffect(function(){const{instance:o}=t;function l(d){d.popup===o&&(o.update(),a(!0))}function c(d){d.popup===o&&a(!1)}return r.map.on({popupopen:l,popupclose:c}),r.overlayContainer==null?(n!=null&&o.setLatLng(n),o.openOn(r.map)):r.overlayContainer.bindPopup(o),function(){var u;r.map.off({popupopen:l,popupclose:c}),(u=r.overlayContainer)==null||u.unbindPopup(),r.map.removeLayer(o)}},[t,r,a,n])}),Jy=zue(function(a,n){var i=a,{url:t}=i,r=me(i,["url"]);const o=new ya.TileLayer(t,j1(r,n));return Zy(o,n)},function(t,r,n){Bue(t,r,n);const{url:a}=r;a!=null&&a!==n.url&&t.setUrl(a)}),UB="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",qB="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",VB="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",Vue=e=>{const t=new Map;return e.forEach(r=>{if(!r.latitude||!r.longitude)return;const n=Number(r.latitude),a=Number(r.longitude);if(isNaN(n)||isNaN(a))return;const i=r.venue_id||`${r.venue_name}-${n}-${a}`;t.has(i)?t.get(i).events.push(r):t.set(i,{venueId:r.venue_id||i,venueName:r.venue_name||"Unknown Venue",venueAddress:r.venue_address||"",venueCity:r.venue_city||"",venueState:r.venue_state||"",latitude:n,longitude:a,events:[r]})}),t.forEach(r=>{r.events.sort((n,a)=>{const i=new Date(n.event_date),o=new Date(a.event_date);return i.getTime()-o.getTime()})}),Array.from(t.values())},Wue=new ya.Icon({iconUrl:qB,iconRetinaUrl:UB,shadowUrl:VB,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41],className:"brand-pink-marker"}),Hue=({center:e,zoom:t})=>{const r=kh();return x.useEffect(()=>{r.setView(e,t)},[r,e,t]),null},Gue=({onMapMove:e})=>{const t=kh();return x.useEffect(()=>{if(!e)return;const r=()=>{const n=t.getBounds();e({north:n.getNorth(),south:n.getSouth(),east:n.getEast(),west:n.getWest()})};return r(),t.on("moveend",r),t.on("zoomend",r),()=>{t.off("moveend",r),t.off("zoomend",r)}},[t,e]),null},kT=({center:e,zoom:t,events:r,onEventClick:n,onMapMove:a,showRadius:i=!1,radiusMiles:o=30,onVenueClick:l})=>{const c=x.useRef(null),d=r.filter(f=>{if(!f)return!1;const h=Number(f.latitude),p=Number(f.longitude);return f.latitude!=null&&f.longitude!=null&&!Number.isNaN(h)&&!Number.isNaN(p)}),u=Vue(d);return s.jsxs("div",{className:"w-full h-full",children:[s.jsx("style",{children:`
        .custom-scrollbar::-webkit-scrollbar {
          width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: #f1f5f9;
          border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: #e2e8f0;
          border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: #cbd5e1;
        }
        .venue-popup .leaflet-popup-content {
          margin: 0;
          padding: 0;
          border-radius: 12px;
          overflow: hidden;
          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        /* Brand pink marker styling - using brand-pink-500 color */
        .brand-pink-marker img {
          filter: brightness(0) saturate(100%) invert(27%) sepia(93%) saturate(1352%) hue-rotate(300deg) brightness(0.85) contrast(0.9);
        }
      `}),s.jsxs(Xy,{center:e,zoom:t,style:{height:"100%",width:"100%"},ref:c,children:[s.jsx(Jy,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(Hue,{center:e,zoom:t}),s.jsx(Gue,{onMapMove:a}),i&&s.jsx(Uue,{center:e,radius:o*1609.34,pathOptions:{color:"#ec4899",fillColor:"#ec4899",fillOpacity:.1,weight:2,opacity:.6}}),u.map(f=>s.jsx(ch,{position:[f.latitude,f.longitude],icon:Wue,eventHandlers:{click:()=>{l&&l(f.venueId,f.venueName,f.latitude,f.longitude)}}},f.venueId))]})]})};class _l{static checkTableExists(){return E(this,null,function*(){return this.tableExistsCache!==null?this.tableExistsCache:this.tableCheckPromise?this.tableCheckPromise:(this.tableCheckPromise=E(this,null,function*(){var t,r;try{const{error:n}=yield T.from("event_promotions").select("id").limit(0),a=!n||n.code!=="PGRST205"&&n.code!=="42P01"&&!((t=n.message)!=null&&t.includes("does not exist"))&&!((r=n.message)!=null&&r.includes("Not Found"));return this.tableExistsCache=a,a}catch(n){return this.tableExistsCache=!1,!1}finally{this.tableCheckPromise=null}}),this.tableCheckPromise)})}static trackPromotionInteraction(t,r,n,a){return E(this,null,function*(){try{if(!(yield this.checkTableExists()))return;const{data:o,error:l}=yield T.from("event_promotions").select("id, impressions, clicks, conversions").eq("event_id",t).eq("promotion_status","active").lte("starts_at",new Date().toISOString()).gte("expires_at",new Date().toISOString());if(l||!o||o.length===0)return;for(const c of o){const d={};switch(n){case"view":d.impressions=(c.impressions||0)+1;break;case"click":d.clicks=(c.clicks||0)+1;break;case"conversion":d.conversions=(c.conversions||0)+1;break}if(Object.keys(d).length>0){const{error:u}=yield T.from("event_promotions").update(d).eq("id",c.id);u?console.error(`Error updating promotion ${c.id}:`,u):console.log(` Updated promotion ${c.id} ${n}:`,d)}}}catch(i){console.error("Error tracking promotion interaction:",i)}})}static getPromotionMetricsFromInteractions(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("event_promotions").select("*").eq("id",t).single();if(a||!n)throw new Error("Promotion not found");const{data:i,error:o}=yield T.from("interactions").select("event_type, entity_type, occurred_at").eq("entity_id",r).eq("entity_type","event").gte("occurred_at",n.starts_at).lte("occurred_at",n.expires_at);if(o)return console.error("Error fetching interactions for promotion metrics:",o),{impressions:n.impressions||0,clicks:n.clicks||0,conversions:n.conversions||0,ctr:0,conversion_rate:0};const l=(i==null?void 0:i.filter(h=>h.event_type==="view").length)||0,c=(i==null?void 0:i.filter(h=>h.event_type==="click").length)||0,d=(i==null?void 0:i.filter(h=>h.event_type==="click"&&h.entity_type==="ticket_link").length)||0,u=l>0?c/l*100:0,f=c>0?d/c*100:0;return{impressions:l,clicks:c,conversions:d,ctr:Math.round(u*100)/100,conversion_rate:Math.round(f*100)/100}}catch(n){return console.error("Error calculating promotion metrics from interactions:",n),{impressions:0,clicks:0,conversions:0,ctr:0,conversion_rate:0}}})}static syncPromotionMetrics(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select("event_id, starts_at, expires_at").eq("id",t).single();if(n||!r)throw new Error("Promotion not found");const a=yield this.getPromotionMetricsFromInteractions(t,r.event_id),{error:i}=yield T.from("event_promotions").update({impressions:a.impressions,clicks:a.clicks,conversions:a.conversions}).eq("id",t);i?console.error("Error syncing promotion metrics:",i):console.log(` Synced promotion ${t} metrics:`,a)}catch(r){console.error("Error syncing promotion metrics:",r)}})}}Cr(_l,"tableExistsCache",null),Cr(_l,"tableCheckPromise",null);const Yue=Object.freeze(Object.defineProperty({__proto__:null,PromotionTrackingService:_l},Symbol.toStringTag,{value:"Module"}));class Qr{static getUserInterestedEventIdSet(n){return E(this,arguments,function*(t,r=[]){const a=new Set;if(!t)return a;try{let i=T.from("user_event_relationships").select("event_id").eq("user_id",t).eq("relationship_type","interested");r.length>0&&(i=i.in("event_id",r));const{data:o,error:l}=yield i;if(!l&&o&&o.length>0)return o.forEach(c=>{c.event_id&&a.add(String(c.event_id))}),a;if(l)return console.error("Error loading interested events from user_event_relationships:",l),a}catch(i){return console.error("Error loading interested events from user_event_relationships:",i),a}return a})}static getInterestedCountsByEventId(t,r){return E(this,null,function*(){const n=new Map;if(t.length===0)return n;try{let a=T.from("user_event_relationships").select("event_id, user_id").eq("relationship_type","interested").in("event_id",t);r&&(a=a.neq("user_id",r));const{data:i,error:o}=yield a;if(!o&&i&&i.length>0)return i.forEach(l=>{if(!l.event_id)return;const c=String(l.event_id);n.set(c,(n.get(c)||0)+1)}),n;if(o)return console.error("Error loading interested counts from user_event_relationships:",o),n}catch(a){console.error("Error loading interested counts from user_event_relationships:",a)}return n})}static resolveEventIdentifiers(t){return E(this,null,function*(){if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)){const{data:i,error:o}=yield T.from("events").select("id, jambase_event_id").eq("id",t).maybeSingle();return o?{eventUuid:t,jambaseEventId:null}:{eventUuid:(i==null?void 0:i.id)||t,jambaseEventId:(i==null?void 0:i.jambase_event_id)||null}}const{data:n,error:a}=yield T.from("events").select("id, jambase_event_id").eq("jambase_event_id",t).maybeSingle();return a?{eventUuid:null,jambaseEventId:t}:{eventUuid:(n==null?void 0:n.id)||null,jambaseEventId:t}})}static setEventInterest(t,r,n){return E(this,null,function*(){try{console.log(" setEventInterest called with:",{userId:t,jambaseEventId:r,interested:n});const{eventUuid:a,jambaseEventId:i}=yield Qr.resolveEventIdentifiers(r);if(!a&&!i)throw new Error(`Event not found: ${r}`);const{data:o,error:l}=yield T.auth.getUser();l&&console.warn(" Error getting auth user:",l);const c=o==null?void 0:o.user;(c==null?void 0:c.id)!==t&&console.warn(" User ID mismatch: auth.uid() =",c==null?void 0:c.id,"but userId param =",t);let d=!1,u=null;if(a)if(n){const{error:y}=yield T.from("user_event_relationships").upsert({user_id:t,event_id:a,relationship_type:"interested"},{onConflict:"user_id,event_id,relationship_type"});y?u=y:d=!0}else{const{error:y}=yield T.from("user_event_relationships").delete().eq("user_id",t).eq("event_id",a).eq("relationship_type","interested");y?u=y:d=!0}if(!d){if(u)throw console.error("Interested write failed on user_event_relationships:",u),new Error(`Failed to set event interest: ${u.message||"Unknown error"}`);if(!a)throw new Error("Cannot set event interest: event UUID not found")}console.log(" Checking if relationship was saved:",{userId:t,eventUuid:a,interested:n}),yield new Promise(y=>setTimeout(y,300));const{data:f,error:h}=yield T.auth.getUser();h&&console.warn(" Error getting auth user:",h);const p=f==null?void 0:f.user,g=(p==null?void 0:p.id)||t;let v=null;if(a){const{data:y,error:_}=yield T.from("user_event_relationships").select("*").eq("user_id",g).eq("event_id",a).eq("relationship_type","interested").maybeSingle();_?console.error("Error checking user_event_relationships after write:",_):v=y}if(n&&a)try{console.log(" UserEventService: User expressed interest, joining verified chat...",{eventUuid:a,jambaseEventId:r,userId:t});const{data:y}=yield T.from("events").select("title, id").eq("id",a).maybeSingle(),_=(y==null?void 0:y.title)||"Event";yield hc.joinOrOpenVerifiedChat("event",a,_,t),console.log(" UserEventService: Successfully joined event verified chat")}catch(y){console.error(" UserEventService: Error joining event verified chat (non-fatal):",y)}try{On.interest("event",r,n),console.log(" Tracked interest interaction:",{jambaseEventId:r,interested:n})}catch(y){console.error("Error tracking interest interaction:",y)}return v||{}}catch(a){throw console.error("Error setting event interest:",a),new Error(`Failed to set event interest: ${a instanceof Error?a.message:"Unknown error"}`)}})}static removeEventInterest(t,r){return E(this,null,function*(){try{yield Qr.setEventInterest(t,r,!1);try{On.interest("event",r,!1,{action:"remove"})}catch(n){}}catch(n){throw console.error("Error removing event interest:",n),new Error(`Failed to remove event interest: ${n instanceof Error?n.message:"Unknown error"}`)}})}static isUserInterested(t,r){return E(this,null,function*(){try{const{eventUuid:n,jambaseEventId:a}=yield Qr.resolveEventIdentifiers(r),{data:i,error:o}=yield T.auth.getUser();o&&console.warn(" Error getting auth user:",o);const l=i==null?void 0:i.user,c=(l==null?void 0:l.id)||t;let d=null,u=null;if(n){const{data:f,error:h}=yield T.from("user_event_relationships").select("user_id, event_id").eq("user_id",c).eq("event_id",n).in("relationship_type",["interested","going","maybe"]).maybeSingle();d=f,u=h}return!u&&d?!0:(u&&console.error("Error checking event interest:",u),!1)}catch(n){return console.error("Error checking event interest:",n),!1}})}static getUserInterestedEvents(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.auth.getUser();n&&console.warn(" Error getting auth user:",n);const a=r==null?void 0:r.user,i=(a==null?void 0:a.id)||t,{data:o,error:l}=yield T.from("user_event_relationships").select("*").eq("user_id",i).in("relationship_type",["interested","going","maybe"]).order("created_at",{ascending:!1});if(l)throw console.error("Error loading user interested events from user_event_relationships:",l),l;if(o&&o.length>0){const c=o.map(g=>g.event_id).filter(Boolean);if(c.length===0)return{events:[],total:0};const{data:d,error:u}=yield T.from("events").select("*").in("id",c);if(u)throw u;const f=d||[],h=new Map(f.map(g=>[g.id,g])),p=o.map(g=>{const v=h.get(g.event_id)||null;return{interest:{id:g.id,user_id:g.user_id,jambase_event_id:(v==null?void 0:v.jambase_event_id)||null,created_at:g.created_at},event:v}}).filter(g=>g.event!==null);return{events:p,total:p.length}}return{events:[],total:0}}catch(r){throw console.error("Error getting user interested events:",r),new Error(`Failed to get user interested events: ${r instanceof Error?r.message:"Unknown error"}`)}})}static setEventReview(t,r,n){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("reviews").select("*").eq("user_id",t).eq("entity_type","event").eq("entity_id",r).maybeSingle();if(i)throw i;if(a){const{data:o,error:l}=yield T.from("reviews").update(H(M({},n),{updated_at:new Date().toISOString()})).eq("user_id",t).eq("entity_type","event").eq("entity_id",r).select().single();if(l)throw l;if(!o||typeof o!="object"||o.id===void 0)throw new Error("Failed to update event review");return o}else{const{data:o,error:l}=yield T.from("reviews").insert(M({user_id:t,entity_type:"event",entity_id:r},n)).select().single();if(l)throw l;if(!o||typeof o!="object"||o.id===void 0)throw new Error("Failed to create event review");return o}}catch(a){throw console.error("Error setting event review:",a),new Error(`Failed to set event review: ${a instanceof Error?a.message:"Unknown error"}`)}})}static getUserEventReview(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select("*").eq("user_id",t).eq("entity_type","event").eq("entity_id",r).single();if(a&&a.code!=="PGRST116")throw a;return!n||typeof n!="object"||n.id===void 0?null:n}catch(n){return console.error("Error getting user event review:",n),null}})}static getEventReviews(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("reviews").select(`
          id,
          user_id,
          entity_id,
          rating,
          review_text,
          created_at,
          user:users!reviews_user_id_fkey (
            user_id,
            name,
            avatar_url
          )
        `).eq("entity_type","event").eq("entity_id",t).order("created_at",{ascending:!1});if(n)throw new Error(`Failed to fetch event reviews: ${n.message}`);const a=r||[],i=a.length,o=i>0?a.reduce((l,c)=>l+c.rating,0)/i:0;return{reviews:a,averageRating:o,totalReviews:i}}catch(r){throw console.error("Error getting event reviews:",r),new Error(`Failed to get event reviews: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getUserEventHistory(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("reviews").select(`
          id,
          user_id,
          entity_id,
          rating,
          review_text,
          created_at,
          user:users!reviews_user_id_fkey (
            user_id,
            name,
            avatar_url
          ),
          event:events!reviews_entity_id_fkey(*)
        `).eq("user_id",t).eq("entity_type","event").order("created_at",{ascending:!1});if(n)throw new Error(`Failed to fetch user event history: ${n.message}`);return{reviews:r||[],total:(r==null?void 0:r.length)||0}}catch(r){throw console.error("Error getting user event history:",r),new Error(`Failed to get user event history: ${r instanceof Error?r.message:"Unknown error"}`)}})}static deleteEventReview(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("reviews").delete().eq("user_id",t).eq("entity_type","event").eq("entity_id",r);if(n)throw n}catch(n){throw console.error("Error deleting event review:",n),new Error(`Failed to delete event review: ${n instanceof Error?n.message:"Unknown error"}`)}})}static getUserUpcomingEvents(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.auth.getUser();n&&console.warn(" Error getting auth user:",n);const a=r==null?void 0:r.user,i=(a==null?void 0:a.id)||t,o=new Date;o.setHours(0,0,0,0);const l=o.toISOString().split("T")[0],{data:c,error:d}=yield T.from("user_event_relationships").select(`
          *,
          events:events!user_event_relationships_event_id_fkey!inner(*)
        `).eq("user_id",i).in("relationship_type",["interested","going","maybe"]).gte("events.event_date",l).order("events.event_date",{ascending:!0});if(d)throw new Error(`Failed to fetch upcoming events: ${d.message}`);return{events:(c||[]).map(u=>{const f=u.events;return{interest:{id:u.id,user_id:u.user_id,jambase_event_id:(f==null?void 0:f.jambase_event_id)||null,created_at:u.created_at},event:f}}),total:(c==null?void 0:c.length)||0}}catch(r){throw console.error("Error getting user upcoming events:",r),new Error(`Failed to get user upcoming events: ${r instanceof Error?r.message:"Unknown error"}`)}})}static markUserAttendance(t,r,n){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("reviews").select("id, was_there, review_text").eq("user_id",t).eq("entity_type","event").eq("entity_id",r).maybeSingle();if(i&&i.code!=="PGRST116")throw i;if(a)if(n){const{error:o}=yield T.from("reviews").update({was_there:n,updated_at:new Date().toISOString()}).eq("user_id",t).eq("entity_type","event").eq("entity_id",r);if(o)throw o}else if(a.review_text==="ATTENDANCE_ONLY"){console.log(" Deleting ATTENDANCE_ONLY record for:",{userId:t,eventId:r});const{error:o}=yield T.from("reviews").delete().eq("user_id",t).eq("event_id",r);if(o)throw console.error(" Error deleting ATTENDANCE_ONLY record:",o),o;console.log(" Successfully deleted ATTENDANCE_ONLY record")}else{const{error:o}=yield T.from("reviews").update({was_there:n,updated_at:new Date().toISOString()}).eq("user_id",t).eq("event_id",r);if(o)throw o}else if(n){console.log(" Creating ATTENDANCE_ONLY record for:",{userId:t,eventId:r,wasThere:n});const o={user_id:t,event_id:r,rating:1,review_text:"ATTENDANCE_ONLY",was_there:n,is_public:!1,is_draft:!1,likes_count:0,comments_count:0,shares_count:0,review_type:"event",artist_performance_rating:null,production_rating:null,venue_rating:null,location_rating:null,value_rating:null,artist_performance_feedback:null,production_feedback:null,venue_feedback:null,location_feedback:null,value_feedback:null,artist_performance_recommendation:null,production_recommendation:null,venue_recommendation:null,location_recommendation:null,value_recommendation:null,ticket_price_paid:null,rank_order:0};console.log(" ATTENDANCE_ONLY record data:",o);const{data:l,error:c}=yield T.from("reviews").insert(o).select("id, is_public, review_text").single();if(c)throw console.error(" Error creating ATTENDANCE_ONLY record:",c),c;if(console.log(" ATTENDANCE_ONLY record created:",l),l&&l.is_public===!0){console.error(" CRITICAL: ATTENDANCE_ONLY record was created as PUBLIC! This should not happen!"),console.error(" Record data:",l);const{error:d}=yield T.from("reviews").update({is_public:!1}).eq("id",l.id);d?console.error(" Failed to fix is_public flag:",d):console.log(" Fixed is_public flag for ATTENDANCE_ONLY record")}}try{On.interest("event",r,n,{action:"attendance"})}catch(o){}}catch(a){throw console.error("Error marking user attendance:",a),new Error(`Failed to mark attendance: ${a instanceof Error?a.message:"Unknown error"}`)}})}static getUserAttendance(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select("was_there, review_text, id, created_at").eq("user_id",t).eq("event_id",r).maybeSingle();if(console.log(" getUserAttendance:",{userId:t,eventId:r,data:n,error:a}),a&&a.code!=="PGRST116")throw a;if(n){const l=n.review_text&&n.review_text!=="ATTENDANCE_ONLY",c=!!n.was_there;return console.log(" Attendance check:",{hasReview:l,wasThere:c,reviewText:n.review_text,reviewId:n.id}),l&&!c?(console.log(" Auto-fixing attendance for review:",r),yield T.from("reviews").update({was_there:!0}).eq("user_id",t).eq("event_id",r),!0):c}console.log(" No review found, checking for any reviews for this user...");const{data:i,error:o}=yield T.from("reviews").select("id, event_id, review_text, was_there, created_at").eq("user_id",t).order("created_at",{ascending:!1}).limit(5);return console.log(" Recent reviews for user:",{allUserReviews:i,allError:o}),!1}catch(n){return console.error("Error checking user attendance:",n),!1}})}static getEventAttendanceCount(t){return E(this,null,function*(){try{const{count:r,error:n}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("event_id",t).eq("was_there",!0);if(n)throw n;return r||0}catch(r){return console.error("Error getting event attendance count:",r),0}})}static getEventAttendees(t,r=10){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select(`
          user_id,
          user:users!reviews_user_id_fkey(
            user_id,
            name,
            avatar_url
          )
        `).eq("event_id",t).eq("was_there",!0).limit(r);if(a)throw a;return(n||[]).map(i=>({user_id:i.user_id,name:i.profiles.name,avatar_url:i.profiles.avatar_url}))}catch(n){return console.error("Error getting event attendees:",n),[]}})}}const Kue=Object.freeze(Object.defineProperty({__proto__:null,UserEventService:Qr},Symbol.toStringTag,{value:"Module"}));function R5(e,t={}){var r,n,a,i,o,l,c,d,u,f,h;return M({event_id:e.id,artist_name:e.artist_name||((r=e.event_data)==null?void 0:r.artist_name),venue_name:e.venue_name||((n=e.event_data)==null?void 0:n.venue_name),venue_city:e.venue_city||((a=e.event_data)==null?void 0:a.venue_city),venue_state:e.venue_state||((i=e.event_data)==null?void 0:i.venue_state),event_date:e.event_date||((o=e.event_data)==null?void 0:o.event_date),price_range:e.price_range||((l=e.event_data)==null?void 0:l.price_range),has_ticket_urls:!!((c=e.ticket_urls)!=null&&c.length||(u=(d=e.event_data)==null?void 0:d.ticket_urls)!=null&&u.length),has_setlist:!!(e.setlist||(f=e.event_data)!=null&&f.setlist),genres:e.genres||((h=e.event_data)==null?void 0:h.genres)},t)}function cg(e){const t=new Date().getTime(),n=new Date(e).getTime()-t;return Math.ceil(n/(1e3*60*60*24))}function Zue(e){const t=new URLSearchParams;return t.set("utm_source",e.source||"synth"),t.set("utm_medium",e.medium||"app"),t.set("utm_campaign",e.campaign||"event_discovery"),e.content&&t.set("utm_content",e.content),e.term&&t.set("utm_term",e.term),t}function Xue(e,t){try{const r=new URL(e);return Zue({source:"synth",medium:"app",campaign:"event_modal",content:`event_${t.eventId}`,term:t.userId}).forEach((a,i)=>{r.searchParams.set(i,a)}),t.userId&&r.searchParams.set("synth_user_id",t.userId),r.searchParams.set("synth_event_id",t.eventId),r.toString()}catch(r){return console.error("Error adding UTM parameters:",r),e}}function Jue(e){try{const r=new URL(e).hostname.replace("www.",""),n={"ticketmaster.com":"Ticketmaster","stubhub.com":"StubHub","seatgeek.com":"SeatGeek","viagogo.com":"Viagogo","eventbrite.com":"Eventbrite","axs.com":"AXS","ticketfly.com":"Ticketfly","etix.com":"Etix","ticketweb.com":"TicketWeb","universe.com":"Universe"};for(const[a,i]of Object.entries(n))if(r.includes(a))return i;return r.split(".")[0]}catch(t){return"unknown"}}function S1({entityType:e,entityId:t,entityName:r,currentUserId:n,onChatOpen:a,className:i,variant:o="default"}){const[l,c]=x.useState(null),[d,u]=x.useState(!1),[f,h]=x.useState(!1),{toast:p}=Rr();x.useEffect(()=>{console.log(" VerifiedChatBadge: Component mounted/updated",{entityType:e,entityId:t,entityName:r,currentUserId:n}),g()},[e,t,n]);const g=()=>E(this,null,function*(){try{console.log(" VerifiedChatBadge: Loading chat info...",{entityType:e,entityId:t,entityName:r}),u(!0);let w=yield hc.getVerifiedChatInfo(e,t);if(console.log(" VerifiedChatBadge: Initial chat info check:",w),!w||!w.chat_id){console.log(" VerifiedChatBadge: Chat does not exist, creating verified chat...");try{const b=yield hc.getOrCreateVerifiedChat(e,t,r);console.log(" VerifiedChatBadge: Verified chat created, chatId:",b),w=yield hc.getVerifiedChatInfo(e,t),console.log(" VerifiedChatBadge: Chat info after creation:",w)}catch(b){console.error(" VerifiedChatBadge: Error creating verified chat:",b)}}c(w)}catch(w){console.error(" VerifiedChatBadge: Error loading chat info:",w)}finally{u(!1)}}),v=()=>E(this,null,function*(){if(console.log(" VerifiedChatBadge: handleJoinOrOpen called",{entityType:e,entityId:t,entityName:r,currentUserId:n,hasOnChatOpen:!!a}),!n){console.log(" VerifiedChatBadge: No currentUserId, showing sign in toast"),p({title:"Please sign in",description:"You need to be signed in to join chats",variant:"destructive"});return}try{h(!0),console.log(" VerifiedChatBadge: Calling joinOrOpenVerifiedChat...");const w=yield hc.joinOrOpenVerifiedChat(e,t,r,n);console.log(" VerifiedChatBadge: joinOrOpenVerifiedChat returned chatId:",w),console.log(" VerifiedChatBadge: Reloading chat info..."),yield g(),console.log(" VerifiedChatBadge: Chat info reloaded"),a?(console.log(" VerifiedChatBadge: Calling onChatOpen callback with chatId:",w),a(w)):(console.log(" VerifiedChatBadge: No onChatOpen callback, showing toast"),p({title:"Chat opened",description:"You can now participate in the chat"})),console.log(" VerifiedChatBadge: handleJoinOrOpen completed successfully")}catch(w){console.error(" VerifiedChatBadge: Error joining/opening chat:",w),p({title:"Error",description:"Failed to join chat. Please try again.",variant:"destructive"})}finally{h(!1)}}),y=()=>{if(!(l!=null&&l.last_activity_at))return null;try{const w=new Date(l.last_activity_at);return tw(w,{addSuffix:!0})}catch(w){return null}},_=()=>{if(!(l!=null&&l.last_activity_at))return!1;try{const w=new Date(l.last_activity_at);return(Date.now()-w.getTime())/(1e3*60*60)<24}catch(w){return!1}};return o==="compact"?s.jsxs(le,{variant:"ghost",size:"sm",onClick:v,disabled:f||d,className:ke("h-8 px-2",i),children:[f||d?s.jsx(lr,{className:"h-4 w-4 animate-spin"}):s.jsx(kf,{className:"h-4 w-4"}),l!=null&&l.member_count?s.jsx("span",{className:"ml-1 text-xs",children:l.member_count}):null]}):s.jsxs("div",{className:ke("flex items-center gap-2",i),children:[d?s.jsxs(le,{variant:"outline",size:"sm",disabled:!0,children:[s.jsx(lr,{className:"h-4 w-4 animate-spin mr-2"}),"Loading..."]}):l!=null&&l.chat_id?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-100)",border:"2px solid var(--neutral-200)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)",boxShadow:"0 4px 4px 0 var(--shadow-color)",gap:"var(--spacing-inline, 6px)"},children:[s.jsx(kf,{size:16,style:{color:"var(--brand-pink-500)"}}),s.jsxs("span",{children:[l.member_count||0," ",l.member_count===1?"member":"members"]}),_()&&s.jsx("span",{style:{height:"6px",width:"6px",borderRadius:"50%",backgroundColor:"#2E8B63",flexShrink:0},title:"Active"})]}),s.jsx(le,{variant:l.is_user_member?"default":"outline",size:"sm",onClick:v,disabled:f,className:"h-8",children:f?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"h-3.5 w-3.5 animate-spin mr-1.5"}),"Joining..."]}):l.is_user_member?s.jsxs(s.Fragment,{children:[s.jsx(kf,{className:"h-3.5 w-3.5 mr-1.5"}),"Open Chat"]}):s.jsxs(s.Fragment,{children:[s.jsx(zr,{className:"h-3.5 w-3.5 mr-1.5"}),"Join Chat"]})})]}):s.jsx(le,{variant:"outline",size:"sm",onClick:v,disabled:f,className:"h-8",children:f?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"h-3.5 w-3.5 animate-spin mr-1.5"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(kf,{className:"h-3.5 w-3.5 mr-1.5"}),"Start Chat"]})}),(l==null?void 0:l.last_activity_at)&&y()&&s.jsx("span",{className:"text-xs text-muted-foreground hidden sm:inline",children:y()})]})}function Bl({event:e,currentUserId:t,isOpen:r,onClose:n,onInterestToggle:a,onReview:i,onAttendanceChange:o,isInterested:l=!1,hasReviewed:c=!1,onNavigateToProfile:d,onNavigateToChat:u}){const f=as(),[h,p]=x.useState(e),[g,v]=x.useState(!1),[y,_]=x.useState(l),[w,b]=x.useState(null),[N,S]=x.useState(!1),[k,P]=x.useState(null);x.useState(!1),x.useState([]),x.useState(1),x.useState(0);const[A,R]=x.useState(!1),[$,O]=x.useState(!1),[z,D]=x.useState(!1),[B,F]=x.useState(!1),[U,G]=x.useState(!1),[q,K]=x.useState(!1),[Z,Y]=x.useState(!1),[Q,X]=x.useState(!1),[ne,re]=x.useState([]),[ye,ee]=x.useState(null),[de,xe]=x.useState(!1),ie=x.useRef(!1),[se,V]=x.useState(null),[ue,_e]=x.useState(null),[ae,we]=x.useState(!1),{toast:oe}=Rr(),{isCreator:ce,isAdmin:Ae,isBusiness:Be}=ih(),Xe=x.useRef(null),ge=x.useRef(!1);x.useEffect(()=>{p(e),ie.current=!1},[e,ce,Ae]),x.useEffect(()=>{r&&(h!=null&&h.id)&&t&&!ie.current&&(ie.current=!0,We())},[r,h==null?void 0:h.id,t]),x.useEffect(()=>{_(l)},[l]);const We=()=>E(this,null,function*(){if(!(!(h!=null&&h.id)||!t||de))try{xe(!0);const{VerifiedChatService:ve}=yield kn(()=>E(this,null,function*(){const{VerifiedChatService:ct}=yield Promise.resolve().then(()=>Xde);return{VerifiedChatService:ct}}),void 0,import.meta.url),Me=yield ve.getOrCreateVerifiedChat("event",h.id,h.title||"Event"),ze=yield ve.getVerifiedChatInfo("event",h.id);ee(ze)}catch(ve){console.error("Error loading verified chat:",ve),ie.current=!1}finally{xe(!1)}});if(x.useEffect(()=>{var ve;if(r&&(h!=null&&h.id)){Xe.current=Date.now(),ge.current=!1;const Me=R5(h,{source:"event_modal",has_ticket_urls:!!((ve=h.ticket_urls)!=null&&ve.length),has_setlist:!!h.setlist,price_range:h.price_range,days_until_event:h.event_date?cg(h.event_date):void 0});On.view("event",h.id,void 0,Me)}return()=>{if(Xe.current&&(h!=null&&h.id)){const Me=Math.floor((Date.now()-Xe.current)/1e3);On.view("event",h.id,Me,{source:"event_modal_close",duration_seconds:Me,interacted:ge.current}),Xe.current=null}}},[r,h==null?void 0:h.id]),x.useEffect(()=>{var ve;if(r&&(h!=null&&h.id)){Xe.current=Date.now(),ge.current=!1;const Me=R5(h,{source:"event_modal",has_ticket_urls:!!((ve=h.ticket_urls)!=null&&ve.length),has_setlist:!!h.setlist,price_range:h.price_range,days_until_event:h.event_date?cg(h.event_date):void 0});On.view("event",h.id,void 0,Me)}return()=>{if(Xe.current&&(h!=null&&h.id)){const Me=Math.floor((Date.now()-Xe.current)/1e3);On.view("event",h.id,Me,{source:"event_modal_close",duration_seconds:Me,interacted:ge.current}),Xe.current=null}}},[r,h==null?void 0:h.id]),x.useEffect(()=>{r&&e&&(p(e),v(!1))},[r,e]),x.useEffect(()=>{h&&r&&new Date(h.event_date)<new Date&&Oe()},[h==null?void 0:h.id,r,t]),x.useEffect(()=>{if(!h||!r)return;const ve=new Date(h.event_date)<new Date,Me=h.setlist,ze=Me&&Me!==null&&typeof Me=="object"&&Object.keys(Me).length>0&&(Array.isArray(Me)||Me.songs&&Array.isArray(Me.songs)||Me.setlist&&Array.isArray(Me.setlist)),ct=h.setlist_enriched===!0;ve&&!ze&&!ct&&h.artist_name&&E(this,null,function*(){F(!0);try{const gt=new Date(h.event_date),St=`${String(gt.getDate()).padStart(2,"0")}-${String(gt.getMonth()+1).padStart(2,"0")}-${gt.getFullYear()}`;let dr=null;if(dr=yield Hf.searchSetlists({artistName:h.artist_name,date:St,venueName:h.venue_name,cityName:h.venue_city,stateCode:h.venue_state}),(!dr||dr.length===0)&&(dr=yield Hf.searchSetlists({artistName:h.artist_name,date:St})),(!dr||dr.length===0)&&(dr=yield Hf.searchSetlists({artistName:h.artist_name})),dr&&dr.length>0){let Sr=dr.find(wt=>{var rr,Ie;const lt=new Date(wt.eventDate),Qe=new Date(h.event_date),jt=lt.toDateString()===Qe.toDateString(),ir=wt.venue.name.toLowerCase().includes(((rr=h.venue_name)==null?void 0:rr.toLowerCase())||"")||((Ie=h.venue_name)==null?void 0:Ie.toLowerCase().includes(wt.venue.name.toLowerCase()));return jt&&ir});Sr||(Sr=dr.find(wt=>{const lt=new Date(wt.eventDate),Qe=new Date(h.event_date);return lt.toDateString()===Qe.toDateString()})),Sr||(Sr=dr[0]),p(wt=>wt&&H(M({},wt),{setlist:Sr,setlist_enriched:!0,setlist_song_count:Sr.songCount||0,setlist_fm_id:Sr.setlistFmId,setlist_fm_url:Sr.url,setlist_source:"setlist.fm",setlist_last_updated:new Date().toISOString()}))}}catch(gt){console.error("Error fetching setlist from setlist.fm:",gt)}finally{F(!1)}})},[h==null?void 0:h.id,h==null?void 0:h.event_date,h==null?void 0:h.artist_name,h==null?void 0:h.venue_name,r]),x.useEffect(()=>{E(this,null,function*(){var Me;if(h!=null&&h.id)try{const ze=yield Qr.getInterestedCountsByEventId([h.id],t);b((Me=ze.get(h.id))!=null?Me:0)}catch(ze){console.error(" Error fetching interested count:",ze),b(null)}})},[h==null?void 0:h.id,t]),!h)return null;const Ue=ve=>new Date(ve).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),at=ve=>new Date(ve).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),mt=ve=>ve?new Date(ve).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):null,Ye=new Date(h.event_date)<new Date,Ft=new Date(h.event_date)>=new Date,_t=()=>{const ve=[h.venue_city,h.venue_state].filter(Boolean);return ve.length>0?ve.join(", "):"Location TBD"},Lt=()=>h.venue_address?h.venue_address:_t(),Oe=()=>E(this,null,function*(){try{if(we(!0),!(h!=null&&h.id)||!t){V(!1),_e(0);return}const ve=yield Qr.getUserAttendance(t,h.id);V(ve);const Me=yield Qr.getEventAttendanceCount(h.id);_e(Me)}catch(ve){console.error("Error loading attendance data:",ve),V(!1),_e(0)}finally{we(!1)}}),qe=()=>E(this,null,function*(){try{we(!0);const ve=!se;if(!(h!=null&&h.id))throw new Error("Event ID is missing");yield Qr.markUserAttendance(t,h.id,ve),V(ve);const Me=yield Qr.getEventAttendanceCount(h.id);_e(Me),o&&o(h.id,ve),oe({title:ve?"Marked as attended!":"Removed attendance",description:ve?"You've marked that you were at this event. Add a review to share your experience!":"You've removed your attendance for this event"}),yield Oe()}catch(ve){console.error("Error toggling attendance:",ve),oe({title:"Error",description:"Failed to update attendance",variant:"destructive"})}finally{we(!1)}}),Ne=()=>{h.artist_name&&(On.click("artist",h.artist_name,{source:"event_modal",event_id:h.id,artist_name:h.artist_name,from_view:window.location.pathname}),On.click("event",h.id,{source:"event_modal_artist_click",artist_name:h.artist_name,venue_name:h.venue_name,event_date:h.event_date,genres:h.genres,price_range:h.price_range,days_until_event:h.event_date?cg(h.event_date):void 0}),_l.trackPromotionInteraction(h.id,t||"","click",{source:"event_modal_artist_click",artist_name:h.artist_name,venue_name:h.venue_name}),ge.current=!0,n(),f(`/artist/${encodeURIComponent(h.artist_name)}`,{state:{fromFeed:window.location.pathname,eventId:h.id}}))},Fe=()=>{h.venue_name&&(On.click("venue",h.venue_name,{source:"event_modal",event_id:h.id,venue_name:h.venue_name,venue_city:h.venue_city,venue_state:h.venue_state,from_view:window.location.pathname}),On.click("event",h.id,{source:"event_modal_venue_click",artist_name:h.artist_name,venue_name:h.venue_name,event_date:h.event_date,genres:h.genres,price_range:h.price_range,days_until_event:h.event_date?cg(h.event_date):void 0}),_l.trackPromotionInteraction(h.id,t||"","click",{source:"event_modal_venue_click",artist_name:h.artist_name,venue_name:h.venue_name}),ge.current=!0,n(),f(`/venue/${encodeURIComponent(h.venue_name)}`,{state:{fromFeed:window.location.pathname,eventId:h.id}}))};return r?s.jsxs("div",{className:"fixed inset-0 z-50 bg-[#fcfcfc] overflow-y-auto overflow-x-hidden w-full max-w-full",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))",pointerEvents:"auto"},children:[s.jsxs("div",{className:"bg-[#fcfcfc] border-b border-gray-200 w-full max-w-full",children:[s.jsx("div",{style:{paddingTop:"var(--spacing-grouped, 24px)",paddingBottom:"var(--spacing-small, 12px)",paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)"},children:s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx("h1",{className:"text-lg font-bold leading-tight flex-1 min-w-0 pr-2 break-words",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:h.title}),s.jsx("button",{onClick:n,className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",style:{width:"44px",height:"44px"},children:s.jsx(Gr,{size:24})})]})}),s.jsxs("div",{style:{paddingBottom:"var(--spacing-small, 12px)",paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)"},children:[s.jsxs("div",{className:"mb-2 flex gap-1.5 flex-wrap",children:[Ft&&a&&s.jsxs(le,{variant:y?"default":"outline",type:"button",onClick:()=>E(this,null,function*(){console.log("Interest button clicked",{currentState:y,eventId:h==null?void 0:h.id});const ve=!y;_(ve),ve&&_l.trackPromotionInteraction(h.id,t||"","conversion",{source:"event_modal_interest_button",action:"interested"});try{yield a==null?void 0:a(h.id,ve)}catch(Me){console.error("Error toggling interest:",Me),_(!ve)}}),style:{fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",height:"var(--size-button-height-sm, 28px)",borderRadius:"var(--radius-corner, 10px)",border:y?"none":"2px solid var(--brand-pink-500)",backgroundColor:y?"var(--brand-pink-500)":"var(--neutral-50)",color:y?"var(--neutral-0)":"var(--brand-pink-500)",transition:"all 0.2s ease",boxShadow:"0 4px 4px 0 var(--shadow-color)",pointerEvents:"auto",zIndex:10,position:"relative"},onMouseEnter:ve=>{y?ve.currentTarget.style.backgroundColor="var(--brand-pink-600)":(ve.currentTarget.style.backgroundColor="var(--brand-pink-050)",ve.currentTarget.style.borderColor="var(--brand-pink-600)")},onMouseLeave:ve=>{y?ve.currentTarget.style.backgroundColor="var(--brand-pink-500)":(ve.currentTarget.style.backgroundColor="var(--neutral-50)",ve.currentTarget.style.borderColor="var(--brand-pink-500)")},children:[s.jsx(ns,{size:16,className:`mr-1 ${y?"fill-current":""}`}),y?"Interested":"I'm Interested"]}),s.jsxs(le,{type:"button",variant:"secondary",size:"sm",onClick:ve=>{ve.preventDefault(),ve.stopPropagation(),console.log("Report button clicked",{eventId:h==null?void 0:h.id}),h!=null&&h.id?(console.log("Opening report modal, current state:",$),O(!0),console.log("Report modal should now be open")):oe({title:"Error",description:"Unable to report this content",variant:"destructive"})},style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",pointerEvents:"auto",zIndex:100,position:"relative"},children:[s.jsx(Qi,{size:16,style:{color:"var(--brand-pink-500)"}}),s.jsx("span",{children:"Report"})]})]}),s.jsxs("div",{className:"flex items-center gap-1.5 mb-3 flex-wrap",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsx(It,{size:16,style:{color:"var(--neutral-600)"}}),s.jsx("span",{children:Ue(h.event_date)}),s.jsx("span",{children:""}),s.jsx(ga,{size:16,style:{color:"var(--neutral-600)"}}),s.jsx("span",{children:at(h.event_date)}),h.doors_time&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{children:["Doors: ",mt(h.doors_time)]})]}),(()=>{var Et,gt;const ve=h,Me=ve==null?void 0:ve.price_range,ze=(Et=ve==null?void 0:ve.ticket_price_min)!=null?Et:ve==null?void 0:ve.price_min,ct=(gt=ve==null?void 0:ve.ticket_price_max)!=null?gt:ve==null?void 0:ve.price_max;if(Me||ze||ct){let St="";return Me?St=Fv(Me):ze&&ct?St=`$${ze} - $${ct}`:ze?St=`$${ze}+`:ct&&(St=`Up to $${ct}`),s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsx(Ml,{size:16,style:{color:"var(--neutral-600)"}}),s.jsx("span",{style:{fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)"},children:St})]})}return null})()]}),Ye&&a&&y&&s.jsxs(le,{variant:"secondary",type:"button",onClick:()=>{console.log("Remove interest button clicked"),a(h.id,!1)},style:{pointerEvents:"auto",zIndex:10},children:[s.jsx(Gr,{size:16,style:{marginRight:"var(--spacing-inline, 6px)"}}),"Remove Interest"]})]})]}),s.jsxs("div",{className:`flex flex-col px-4 pb-28 w-full max-w-full overflow-x-hidden ${N?"pb-40":""}`,id:"event-details-desc",style:{paddingTop:"var(--spacing-small, 12px)"},children:[s.jsxs("div",{className:"flex flex-wrap gap-1.5",style:{marginBottom:"var(--spacing-grouped, 24px)"},children:[Ye&&s.jsx("div",{style:{height:"22px",borderRadius:"var(--radius-corner, 10px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--neutral-100)",border:"2px solid var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",boxShadow:"0 4px 4px 0 var(--shadow-color)"},children:"Past Event"}),Ft&&s.jsx("div",{style:{height:"22px",borderRadius:"var(--radius-corner, 10px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",color:"var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",boxShadow:"0 4px 4px 0 var(--shadow-color)"},children:"Upcoming"}),s.jsx(_ue,{eventId:h.id}),s.jsx(xue,{eventId:h.id}),s.jsx(wue,{interestedCount:w||0,attendanceCount:ue||0})]}),s.jsxs("div",{className:"flex flex-col gap-3 mb-3",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 w-full",children:[s.jsxs("h3",{className:"text-sm font-semibold mb-1.5 flex items-center gap-1.5",children:[s.jsx($t,{size:16,className:"flex-shrink-0"}),s.jsx("span",{children:"Artist"})]}),s.jsx("div",{className:"font-medium text-sm cursor-pointer hover:text-pink-600 transition-colors break-words",onClick:Ne,title:"Click to view all events for this artist",children:h.artist_name}),h.genres&&h.genres.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-1.5",children:h.genres.slice(0,3).map((ve,Me)=>s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-100)",border:"2px solid var(--neutral-200)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)",boxShadow:"0 4px 4px 0 var(--shadow-color)"},children:ve},Me))})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 w-full",children:[s.jsxs("h3",{className:"text-sm font-semibold mb-1.5 flex items-center gap-1.5",children:[s.jsx(gr,{size:16,className:"flex-shrink-0"}),s.jsx("span",{children:"Venue"})]}),s.jsx("div",{className:"font-medium text-sm mb-1 cursor-pointer hover:text-pink-600 transition-colors break-words",onClick:Fe,title:"Click to view all events at this venue",children:h.venue_name}),s.jsx("div",{className:"text-muted-foreground text-xs break-words",children:Lt()}),h.venue_zip&&s.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["ZIP: ",h.venue_zip]})]})]}),s.jsx(jT,{artistName:h.artist_name,venueName:h.venue_name,artistId:h.artist_id,venueId:h.venue_id}),s.jsxs("div",{className:"mt-4 space-y-3",children:[s.jsxs("div",{className:"flex gap-1 border-b pb-2 flex-wrap",children:[s.jsx(le,{variant:Z?"default":"ghost",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:Z?"var(--neutral-50)":void 0},onClick:()=>{Y(!Z),K(!1),G(!1)},children:s.jsx("span",{style:{color:Z?"var(--neutral-50)":void 0},children:" Photos"})}),s.jsxs(le,{variant:q?"default":"ghost",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",whiteSpace:"nowrap",color:q?"var(--neutral-50)":void 0},onClick:()=>{K(!q),Y(!1),G(!1)},children:[s.jsx(zr,{size:16,style:{marginRight:"var(--spacing-inline, 6px)",color:q?"var(--neutral-50)":void 0}}),s.jsxs("span",{style:{color:q?"var(--neutral-50)":void 0},children:["Groups (",ne.length+(ye!=null&&ye.chat_id?1:0),")"]})]}),Ft&&s.jsxs(le,{variant:U?"default":"ghost",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",whiteSpace:"nowrap",color:U?"var(--neutral-50)":void 0},onClick:()=>{G(!U),Y(!1),K(!1)},children:[s.jsx(ns,{size:16,style:{marginRight:"var(--spacing-inline, 6px)",flexShrink:0,color:U?"var(--neutral-50)":void 0}}),s.jsxs("span",{style:{color:U?"var(--neutral-50)":void 0},children:["Meet (",w!==null?w:0,")"]})]})]}),Z&&s.jsx(Sue,{eventId:h.id,eventTitle:h.title,canUpload:Ye}),q&&s.jsx("div",{className:"flex items-center justify-center py-24",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx($n,{size:60,className:"mx-auto text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Verified chats are coming soon!"})]})}),U&&s.jsx(bue,H(M({eventId:h.id,eventTitle:h.title},w!==null&&{interestedCount:w}),{onMatchCreated:ve=>{oe({title:"New Match! ",description:`You matched with ${ve.name}!`})},onNavigateToProfile:ve=>{d&&(d(ve),n())}}))]}),(()=>{const ve=h==null?void 0:h.setlist,Me=ve&&ve!==null&&typeof ve=="object"&&Object.keys(ve).length>0&&(Array.isArray(ve)||ve.songs&&Array.isArray(ve.songs)||ve.setlist&&Array.isArray(ve.setlist)),ze=(h==null?void 0:h.setlist_enriched)===!0,ct=(h==null?void 0:h.setlist_song_count)&&h.setlist_song_count>0;return Ye&&(Me||ze||ct||B)})()&&s.jsx(yue,{type:"single",collapsible:!0,value:z?"setlist":"",onValueChange:ve=>D(ve==="setlist"),className:"mb-6",children:s.jsxs(EB,{value:"setlist",className:"border border-purple-200 rounded-lg",children:[s.jsx(CB,{className:"px-6 py-4 hover:no-underline",children:s.jsxs("div",{className:"flex items-center gap-3 w-full",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center",children:s.jsx($t,{size:24,className:"text-white"})}),s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("h3",{className:"text-lg font-bold text-purple-900",children:"Setlist from this Show"}),s.jsxs("p",{className:"text-sm text-purple-700",children:[(()=>{if(h.setlist_song_count&&h.setlist_song_count>0)return h.setlist_song_count;const ve=h.setlist;return ve&&ve.songs?ve.songs.length:"Multiple"})()," songs performed"]})]}),h.setlist_fm_url&&s.jsx(le,{variant:"outline",size:"sm",asChild:!0,className:"border-purple-300 hover:bg-purple-100",onClick:ve=>ve.stopPropagation(),children:s.jsxs("a",{href:h.setlist_fm_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1",children:[s.jsx("span",{children:"View on setlist.fm"}),s.jsx(ExternalLink,{size:16})]})})]})}),s.jsx(PB,{className:"px-6 pb-6 max-h-96 overflow-y-auto",children:B?s.jsxs("div",{className:"text-center py-8",children:[s.jsx($t,{size:35,className:"text-purple-500 mx-auto mb-3 animate-pulse"}),s.jsx("p",{className:"text-purple-700",children:"Loading setlist from setlist.fm..."})]}):(()=>{const ve=h.setlist;let Me=[];return ve&&typeof ve=="object"&&(Array.isArray(ve)?Me=ve:ve.songs&&Array.isArray(ve.songs)?Me=ve.songs:ve.setlist&&Array.isArray(ve.setlist)&&(Me=ve.setlist)),!Me||Me.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx("p",{className:"text-purple-700",children:"Setlist data is available but in an unexpected format."}),s.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Data keys: ",ve?Object.keys(ve).join(", "):"none"]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Setlist type: ",typeof ve]})]}):s.jsxs("div",{className:"space-y-4",children:[Array.from(new Set(Me.map(ze=>ze.setNumber||1))).map(ze=>{var gt;const ct=Me.filter(St=>(St.setNumber||1)===ze),Et=((gt=ct[0])==null?void 0:gt.setName)||`Set ${ze}`;return s.jsxs("div",{className:"bg-white/70 rounded-lg p-4",children:[s.jsxs("h4",{className:"font-semibold text-purple-900 mb-3 flex items-center gap-2",children:[s.jsx($t,{size:16}),Et]}),s.jsx("div",{className:"space-y-1",children:ct.map((St,dr)=>s.jsxs("div",{className:"flex items-start gap-3 py-1",children:[s.jsxs("span",{className:"text-purple-600 font-medium min-w-[28px] text-sm",children:[St.position||dr+1,"."]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("span",{className:"text-gray-900 text-sm font-medium",children:St.name||St.title||St.song||"Unknown Song"}),St.cover&&s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-100)",border:"2px solid var(--neutral-200)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)",boxShadow:"0 4px 4px 0 var(--shadow-color)"},children:[St.cover.artist||St.cover," cover"]})]}),(St.info||St.notes)&&s.jsx("p",{className:"text-xs text-gray-600 mt-1 italic",children:St.info||St.notes})]})]},St.position||dr))})]},ze)}),ve.info&&s.jsx("div",{className:"bg-purple-100/50 rounded-lg p-3 mt-4",children:s.jsxs("p",{className:"text-sm text-purple-900",children:[s.jsx("span",{className:"font-semibold",children:"Note:"})," ",ve.info]})}),ve.tour&&s.jsx("div",{className:"bg-blue-100/50 rounded-lg p-3 mt-4",children:s.jsxs("p",{className:"text-sm text-blue-900",children:[s.jsx("span",{className:"font-semibold",children:"Tour:"})," ",ve.tour]})})]})})()})]})}),Ye&&s.jsxs("div",{className:"mb-6 rounded-md border p-4",style:{backgroundColor:"var(--neutral-100)",borderColor:"var(--neutral-200)"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--neutral-200)"},children:s.jsx(zr,{size:16,style:{color:"var(--neutral-900)"}})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",style:{color:"var(--neutral-900)"},children:"Event Attendance"}),s.jsx("p",{className:"text-sm",style:{color:"var(--neutral-600)"},children:ae?"Loading...":ue===null?"Loading attendance...":ue===0?"No one has marked attendance yet":`${ue} person${ue===1?"":"s"} attended this event`})]})]}),s.jsx(le,{size:"default",variant:"secondary",onClick:qe,disabled:ae,style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:ae?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):se?s.jsxs(s.Fragment,{children:[s.jsx(zr,{size:16,className:"mr-2"}),"I was there"]}):s.jsxs(s.Fragment,{children:[s.jsx(zr,{size:16,className:"mr-2"}),"I was there"]})})]}),se&&s.jsx("div",{className:"text-sm rounded-lg p-2",style:{color:"var(--neutral-600)",backgroundColor:"var(--neutral-100)"},children:" You've marked that you attended this event"})]}),Ft&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Location"}),h.latitude!=null&&h.longitude!=null&&!Number.isNaN(Number(h.latitude))&&!Number.isNaN(Number(h.longitude))?s.jsx("div",{className:"rounded-lg overflow-hidden border h-[400px]",children:s.jsx(kT,{center:[Number(h.latitude),Number(h.longitude)],zoom:13,events:[e],onEventClick:()=>{}})}):s.jsx("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center h-[400px]",children:s.jsxs("div",{className:"text-center text-gray-500",children:[s.jsx(gr,{size:35,className:"mx-auto mb-2"}),s.jsx("p",{children:"Location not available"})]})})]}),s.jsx("div",{className:`pt-3 border-t ${N?"mt-2":"mt-4"} w-full max-w-full overflow-x-hidden`,children:Ye?s.jsx("div",{className:"flex flex-wrap items-center gap-2 w-full",children:i&&s.jsxs(le,{variant:c?"default":"outline",size:"sm",onClick:()=>i(h.id),className:`text-xs px-3 py-1 h-7 ${c?"bg-yellow-500 hover:bg-yellow-600 text-white":"hover:bg-yellow-50 hover:text-yellow-600 hover:border-yellow-300"}`,children:[c?s.jsx(Qt,{size:16,className:"mr-1 fill-current"}):s.jsx(Qt,{size:16,className:"mr-1"}),s.jsx("span",{className:"text-xs",children:c?"Reviewed":"I Was There!"})]})}):s.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full",children:[s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>R(!0),className:"text-xs px-3 py-1 h-7",children:[s.jsx(kf,{size:16,className:"mr-1 flex-shrink-0"}),s.jsx("span",{className:"text-xs",children:"Comments"})]}),(()=>{var Et,gt;const ve=h,Me=ve==null?void 0:ve.price_range,ze=(Et=ve==null?void 0:ve.ticket_price_min)!=null?Et:ve==null?void 0:ve.price_min,ct=(gt=ve==null?void 0:ve.ticket_price_max)!=null?gt:ve==null?void 0:ve.price_max;if(Me||ze||ct){let St="";return Me?St=Fv(Me):ze&&ct?St=`$${ze}-$${ct}`:ze?St=`$${ze}+`:ct&&(St=`$${ct}`),s.jsxs("div",{className:"text-xs flex items-center",children:[s.jsx("span",{className:"text-muted-foreground",children:"Price: "}),s.jsx("span",{className:"font-medium",children:St})]})}return null})(),t&&(h==null?void 0:h.id)&&s.jsx("div",{className:"flex items-center flex-shrink-0",children:s.jsx(S1,{entityType:"event",entityId:h.id,entityName:h.title||"Event",currentUserId:t,onChatOpen:ve=>{console.log(" EventDetailsModal: Chat opened, navigating to chat:",ve),u?u(ve):window.location.href=`/chats?chatId=${ve}`}})})]}),s.jsx("div",{className:"flex flex-wrap items-center gap-2 w-full",children:(h.ticket_urls&&h.ticket_urls.length>0||h.ticket_url)&&s.jsxs(le,{variant:"default",size:"sm",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-0)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",height:"var(--size-button-height-sm, 28px)",borderRadius:"var(--radius-corner, 10px)",border:"none",display:"flex",alignItems:"center",gap:"var(--spacing-inline, 6px)",transition:"all 0.2s ease",boxShadow:"0 4px 4px 0 var(--shadow-color)"},onMouseEnter:ve=>{ve.currentTarget.style.backgroundColor="var(--brand-pink-600)"},onMouseLeave:ve=>{ve.currentTarget.style.backgroundColor="var(--brand-pink-500)"},onClick:()=>{var Et;const ve=((Et=h.ticket_urls)==null?void 0:Et[0])||h.ticket_url,Me=Jue(ve),ze=h.event_date?cg(h.event_date):void 0;On.click("ticket_link",h.id,{ticket_url:ve,ticket_provider:Me,price_range:h.price_range,event_date:h.event_date,artist_name:h.artist_name,venue_name:h.venue_name,days_until_event:ze,source:"event_modal",user_interested:y}),_l.trackPromotionInteraction(h.id,t||"","click",{source:"event_modal_ticket_click",ticket_url:ve,ticket_provider:Me}),ge.current=!0;const ct=Xue(ve,{eventId:h.id,userId:t,source:"event_modal"});window.open(ct,"_blank","noopener,noreferrer")},children:[s.jsx(Ml,{size:16,style:{flexShrink:0,color:"var(--neutral-50)"}}),s.jsx("span",{style:{color:"var(--neutral-50)"},children:"Get Tickets"})]})})]})}),s.jsx("div",{className:`${N?"h-20":"h-2"}`})]}),N&&k&&s.jsx(Cue,{friend:k,isOpen:N,onClose:()=>S(!1),onStartChat:ve=>{if(u)u(ve),n();else{const Me=new CustomEvent("start-chat",{detail:{friendUserId:ve,eventId:h.id}});window.dispatchEvent(Me)}S(!1)},onNavigateToProfile:ve=>{d&&(d(ve),n())},onAddFriend:ve=>E(this,null,function*(){try{const{error:Me}=yield T.rpc("create_friend_request",{receiver_user_id:ve});if(Me)throw Me;console.log(" Friend request sent successfully")}catch(Me){console.error(" Failed to send friend request:",Me)}})}),s.jsx(TB,{eventId:h.id,isOpen:A,onClose:()=>R(!1),currentUserId:t}),(h==null?void 0:h.id)&&s.jsx(v1,{open:$,onClose:()=>{console.log("Closing report modal"),O(!1)},contentType:"event",contentId:h.id,contentTitle:h.title||"Event",onReportSubmitted:()=>{console.log("Report submitted, closing modal"),O(!1),oe({title:"Report Submitted",description:"Thank you for helping keep our community safe"})}}),s.jsx(Eue,{open:Q,onClose:()=>X(!1),event:{id:h.id,title:h.title,artist_name:h.artist_name,event_date:h.event_date},onGroupCreated:ve=>{X(!1),oe({title:"Group Created! ",description:"Your event group is ready"})}})]}):null}function Que({reviewId:e,isOpen:t,onClose:r,currentUserId:n,onCommentAdded:a,onCommentsLoaded:i}){const[o,l]=x.useState([]),[c,d]=x.useState(!1),[u,f]=x.useState(!1),[h,p]=x.useState(""),[g,v]=x.useState(null);x.useEffect(()=>{t&&e&&y()},[t,e]);const y=()=>E(this,null,function*(){if(e)try{d(!0),v(null);const b=yield bs.getReviewComments(e);l(b),i&&i(b.length)}catch(b){console.error("Failed to load review comments",b),v("Failed to load comments")}finally{d(!1)}}),_=()=>E(this,null,function*(){if(!(!n||!e||!h.trim()||u))try{f(!0),v(null);const b=yield bs.addComment(n,e,h.trim()),N=H(M({},b),{user:{id:n,name:"You",avatar_url:void 0}});l(S=>[...S,N]),p(""),a&&a()}catch(b){console.error("Failed to add comment",b),v("Failed to add comment")}finally{f(!1)}}),w=b=>{b.key==="Enter"&&(b.ctrlKey||b.metaKey)&&(b.preventDefault(),_())};return s.jsx(pn,{open:t,onOpenChange:r,children:s.jsxs(dn,{className:"max-w-2xl w-[95vw] h-[85dvh] max-h-[85dvh] md:max-h-[80vh] p-0 overflow-hidden flex flex-col",children:[s.jsxs(Vn,{className:"px-4 py-3 border-b border-gray-200 bg-white sticky top-0 z-10",children:[s.jsx(bn,{children:"Review Comments"}),s.jsx(os,{children:"Share your thoughts about this review"})]}),s.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto px-4 py-4 space-y-4",children:c?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(lr,{className:"h-6 w-6 animate-spin mr-2"}),s.jsx("span",{children:"Loading comments..."})]}):g?s.jsxs("div",{className:"text-center py-8 text-red-600",children:[s.jsx("p",{children:g}),s.jsx(le,{variant:"outline",onClick:y,className:"mt-2",children:"Try Again"})]}):o.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx("p",{children:"No comments yet."}),s.jsx("p",{className:"text-sm",children:"Be the first to share your thoughts!"})]}):s.jsx("div",{className:"space-y-4",children:o.map(b=>s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsxs(Vr,{className:"w-8 h-8",children:[s.jsx(sn,{src:b.user.avatar_url}),s.jsx(Wr,{className:"text-xs",children:(b.user.name||"U").slice(0,2).toUpperCase()})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"font-medium text-sm",children:b.user.name||"User"}),s.jsx("span",{className:"text-xs text-gray-500",children:new Date(b.created_at).toLocaleString()})]}),s.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:b.comment_text})]})]},b.id))})}),s.jsxs("div",{className:"border-t border-gray-200 p-4 bg-white",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ys,{value:h,onChange:b=>p(b.target.value),onKeyDown:w,placeholder:n?"Write a comment...":"Sign in to comment",disabled:!n||u,className:"min-h-[60px] resize-none"}),s.jsx(le,{onClick:_,disabled:!n||u||!h.trim(),className:"px-3",children:u?s.jsx(lr,{className:"h-4 w-4 animate-spin"}):s.jsx(Fc,{className:"h-4 w-4"})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Press Ctrl+Enter to submit"})]})]})})}class ehe{static resolveInternalEventId(t){return E(this,null,function*(){if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t))return t;const{data:n}=yield T.from("events").select("id").eq("jambase_event_id",t).limit(1).single();return(n==null?void 0:n.id)||t})}static likeEvent(t,r){return E(this,null,function*(){const n=yield this.resolveInternalEventId(r);if(yield this.isLikedByUser(t,r)){const{data:l}=yield T.from("engagements").select("*").eq("user_id",t).eq("entity_type","event").eq("entity_id",n).eq("engagement_type","like").single();return l}const{data:i,error:o}=yield T.from("engagements").insert({user_id:t,entity_type:"event",entity_id:n,engagement_type:"like"}).select("*").single();if(o){if(o.code==="PGRST205")return console.warn("event_likes table not found. Add migration to enable event likes."),null;if(o.code==="23505"||o.status===409){const{data:l}=yield T.from("event_likes").select("*").eq("user_id",t).eq("event_id",n).single();return l}throw o}return i})}static unlikeEvent(t,r){return E(this,null,function*(){const n=yield this.resolveInternalEventId(r),{error:a}=yield T.from("engagements").delete().eq("user_id",t).eq("entity_type","event").eq("entity_id",n).eq("engagement_type","like");if(a){if(a.code==="PGRST205")return;throw a}})}static getEventLikers(t){return E(this,null,function*(){const r=yield this.resolveInternalEventId(t),{data:n,error:a}=yield T.from("engagements").select("user_id").eq("entity_type","event").eq("entity_id",r).eq("engagement_type","like");if(a){if(a.code==="PGRST205")return[];throw a}const i=(n||[]).map(c=>c.user_id);if(i.length===0)return[];const{data:o,error:l}=yield T.from("users").select("id, user_id, name, avatar_url").in("user_id",i);if(l)throw l;return o||[]})}static isLikedByUser(t,r){return E(this,null,function*(){try{const n=yield this.resolveInternalEventId(r),{data:a,error:i}=yield T.from("engagements").select("id").eq("user_id",t).eq("entity_type","event").eq("entity_id",n).eq("engagement_type","like").limit(1).maybeSingle();if(i){if(i.code==="PGRST205")return!1;throw i}return!!a}catch(n){return console.error("Error checking if event is liked by user:",n),!1}})}}function the({eventId:e,isOpen:t,onClose:r}){const[n,a]=x.useState([]),[i,o]=x.useState(!1);return x.useEffect(()=>{!t||!e||E(this,null,function*(){o(!0);try{const l=yield ehe.getEventLikers(e);a(l)}finally{o(!1)}})},[t,e]),s.jsx(pn,{open:t,onOpenChange:l=>!l&&r(),children:s.jsxs(dn,{className:"sm:max-w-md",children:[s.jsxs(Vn,{children:[s.jsx(bn,{children:"Likes"}),s.jsx(os,{children:"People who liked this event"})]}),s.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-1",children:i?s.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading"}):n.length===0?s.jsx("div",{className:"text-sm text-muted-foreground",children:"No likes yet."}):n.map(l=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Vr,{className:"h-8 w-8",children:[s.jsx(sn,{src:l.avatar_url||void 0}),s.jsx(Wr,{children:(l.name||"U").slice(0,2).toUpperCase()})]}),s.jsx("div",{className:"text-sm",children:l.name||"User"})]},l.user_id))})]})})}function ET({event:e,currentUserId:t,isOpen:r,onClose:n}){x.useState("all");const[a,i]=x.useState([]),[o,l]=x.useState([]),[c,d]=x.useState(new Set);x.useState(new Set);const[u,f]=x.useState(""),[h,p]=x.useState(""),[g,v]=x.useState(!1),[y,_]=x.useState(!1),[w,b]=x.useState(!1),{toast:N}=Rr(),S=()=>E(this,null,function*(){try{const D=yield ev.shareEvent(e.id,e.title,e.description||void 0);navigator.share?(yield navigator.share({title:e.title,text:e.description||"Check out this concert!",url:D}),N({title:"Shared!",description:"Event shared successfully"})):(yield navigator.clipboard.writeText(D),N({title:"Link Copied!",description:"Event link copied to clipboard"}))}catch(D){D.name!=="AbortError"&&(console.error("Error sharing externally:",D),N({title:"Error",description:"Failed to share event",variant:"destructive"}))}});x.useEffect(()=>{r&&(k(),P(),b(!1))},[r,t]);const k=()=>E(this,null,function*(){try{v(!0);const D=yield _d.getShareTargets(t);i(D)}catch(D){console.error("Error loading share targets:",D),N({title:"Error",description:"Failed to load chats",variant:"destructive"})}finally{v(!1)}}),P=()=>E(this,null,function*(){try{const D=yield _d.getFriends(t);l(D)}catch(D){console.error("Error loading friends:",D)}}),A=D=>{d(B=>{const F=new Set(B);return F.has(D)?F.delete(D):F.add(D),F})},R=()=>E(this,null,function*(){if(c.size===0){N({title:"No chats selected",description:"Please select at least one chat to share with",variant:"destructive"});return}try{_(!0);const D=Array.from(c),B=D.filter(G=>!G.startsWith("friend-")),F=D.filter(G=>G.startsWith("friend-")).map(G=>G.replace("friend-",""));let U={successCount:0,errors:[]};if(B.length>0){const G=yield _d.shareEventToMultipleChats(e.id,B,t,u||void 0);U.successCount+=G.successCount,U.errors.push(...G.results.filter(q=>!q.success).map(q=>q.error||"Unknown error"))}for(const G of F)try{const q=yield _d.shareEventToNewChat(e.id,G,t,u||void 0);q.success?U.successCount+=1:U.errors.push(q.error||"Failed to share with friend")}catch(q){U.errors.push(`Failed to share with friend: ${q}`)}U.successCount>0&&(N({title:"Event Shared! ",description:`Successfully shared to ${U.successCount} chat${U.successCount>1?"s":""}`}),d(new Set),f(""),n()),U.errors.length>0&&N({title:"Partial Success",description:`${U.errors.length} share${U.errors.length>1?"s":""} failed`,variant:"destructive"})}catch(D){console.error("Error sharing event:",D),N({title:"Error",description:"Failed to share event",variant:"destructive"})}finally{_(!1)}}),$=a.filter(D=>D.name.toLowerCase().includes(h.toLowerCase())&&!D.name.toLowerCase().includes("direct chat")&&!D.name.toLowerCase().includes("dc direct")),O=o.filter(D=>D.name.toLowerCase().includes(h.toLowerCase())),z=[...$.map(D=>H(M({},D),{type:"group",isGroup:!0})),...O.map(D=>({id:`friend-${D.user_id}`,name:D.name,avatar_url:D.avatar_url,type:"friend",isGroup:!1,user_id:D.user_id}))];return s.jsx(pn,{open:r,onOpenChange:n,children:s.jsxs(dn,{className:"max-w-lg max-h-[85vh] overflow-hidden flex flex-col",children:[s.jsxs(Vn,{children:[s.jsx(bn,{className:"text-xl font-bold",children:"Share Event"}),s.jsxs(os,{children:['Share "',e.title,'" with your friends']})]}),s.jsxs("div",{className:"bg-gradient-to-r from-pink-50 to-purple-50 rounded-lg p-3 border border-pink-200",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:e.title}),s.jsxs("p",{className:"text-xs text-gray-600",children:[e.venue_name,"  ",new Date(e.event_date).toLocaleDateString()]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(le,{onClick:S,variant:"outline",className:"h-auto py-4 border-pink-200 hover:bg-pink-50 flex flex-col items-center gap-2",children:[s.jsx(zd,{className:"w-6 h-6 text-pink-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Share Externally"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Phone, Apps, etc."})]}),s.jsxs(le,{onClick:()=>{b(!w),!w&&a.length===0&&o.length===0&&!g&&(k(),P())},variant:w?"default":"outline",className:`h-auto py-4 border-pink-200 flex flex-col items-center gap-2 ${w?"bg-pink-500 hover:bg-pink-600 text-white border-pink-500":"hover:bg-pink-50"}`,children:[s.jsx($n,{className:`w-6 h-6 ${w?"text-white":"text-pink-500"}`}),s.jsx("span",{className:"text-sm font-medium",children:"Share in Chat"}),s.jsx("span",{className:`text-xs ${w?"text-pink-100":"text-gray-500"}`,children:"Within Synth"})]})]}),w&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-1 mt-4 border-t pt-4",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Add a message (optional)"}),s.jsx(ys,{placeholder:"Let's go to this show together! ",value:u,onChange:D=>f(D.target.value),rows:1,className:"resize-none text-sm"})]}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden mt-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx($n,{className:"w-5 h-5 text-pink-500"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Choose Chats"})]}),s.jsxs("div",{className:"relative mb-3",children:[s.jsx(Uo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx(Ar,{placeholder:"Search chats...",value:h,onChange:D=>p(D.target.value),className:"pl-10"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2",children:g?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(lr,{className:"w-6 h-6 animate-spin text-pink-500"})}):z.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx($n,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),s.jsx("p",{children:"No chats found"}),s.jsx("p",{className:"text-sm",children:"Start a conversation to share events"})]}):z.map(D=>{var B;return s.jsxs("div",{onClick:()=>A(D.id),className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all ${c.has(D.id)?"bg-pink-50 border-2 border-pink-300":"bg-white border border-gray-200 hover:border-pink-200"}`,children:[s.jsxs(Vr,{className:"w-10 h-10",children:[s.jsx(sn,{src:D.avatar_url||void 0}),s.jsx(Wr,{children:D.isGroup?s.jsx(zr,{className:"w-5 h-5"}):D.name.split(" ").map(F=>F[0]).join("")})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:D.name}),s.jsx("p",{className:"text-xs text-gray-500",children:D.isGroup?`${((B=D.users)==null?void 0:B.length)||D.member_count||0} members`:"Direct message"})]}),c.has(D.id)&&s.jsx("div",{className:"w-6 h-6 rounded-full bg-pink-500 flex items-center justify-center",children:s.jsx(ta,{className:"w-4 h-4 text-white"})})]},D.id)})}),s.jsxs("div",{className:"mt-4 pt-4 border-t flex gap-2",children:[s.jsx(le,{onClick:n,variant:"outline",className:"flex-1",children:"Cancel"}),s.jsx(le,{onClick:R,disabled:c.size===0||y,className:"flex-1 bg-pink-500 hover:bg-pink-600 text-white",children:y?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-4 h-4 mr-2 animate-spin"}),"Sharing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Fc,{className:"w-4 h-4 mr-2"}),"Share (",c.size,")"]})})]})]})]})]})})}function k1(e){const t=x.useRef({value:e,previous:e});return x.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var rhe=[" ","Enter","ArrowUp","ArrowDown"],nhe=[" ","Enter"],dh="Select",[E1,C1,she]=ip(dh),[xp,ABe]=Os(dh,[she,Zd]),P1=Zd(),[ahe,Qd]=xp(dh),[ihe,ohe]=xp(dh),WB=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:f,disabled:h,required:p,form:g}=e,v=P1(t),[y,_]=x.useState(null),[w,b]=x.useState(null),[N,S]=x.useState(!1),k=Sh(d),[P,A]=Wa({prop:n,defaultProp:a!=null?a:!1,onChange:i,caller:dh}),[R,$]=Wa({prop:o,defaultProp:l,onChange:c,caller:dh}),O=x.useRef(null),z=y?g||!!y.closest("form"):!0,[D,B]=x.useState(new Set),F=Array.from(D).map(U=>U.props.value).join(";");return s.jsx(Bb,H(M({},v),{children:s.jsxs(ahe,{required:p,scope:t,trigger:y,onTriggerChange:_,valueNode:w,onValueNodeChange:b,valueNodeHasChildren:N,onValueNodeHasChildrenChange:S,contentId:Ps(),value:R,onValueChange:$,open:P,onOpenChange:A,dir:k,triggerPointerDownPosRef:O,disabled:h,children:[s.jsx(E1.Provider,{scope:t,children:s.jsx(ihe,{scope:e.__scopeSelect,onNativeOptionAdd:x.useCallback(U=>{B(G=>new Set(G).add(U))},[]),onNativeOptionRemove:x.useCallback(U=>{B(G=>{const q=new Set(G);return q.delete(U),q})},[]),children:r})}),z?s.jsxs(pU,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:f,value:R,onChange:U=>$(U.target.value),disabled:h,form:g,children:[R===void 0?s.jsx("option",{value:""}):null,Array.from(D)]},F):null]})}))};WB.displayName=dh;var HB="SelectTrigger",GB=x.forwardRef((e,t)=>{const v=e,{__scopeSelect:r,disabled:n=!1}=v,a=me(v,["__scopeSelect","disabled"]),i=P1(r),o=Qd(HB,r),l=o.disabled||n,c=cr(t,o.onTriggerChange),d=C1(r),u=x.useRef("touch"),[f,h,p]=vU(y=>{const _=d().filter(N=>!N.disabled),w=_.find(N=>N.value===o.value),b=yU(_,y,w);b!==void 0&&o.onValueChange(b.value)}),g=y=>{l||(o.onOpenChange(!0),p()),y&&(o.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return s.jsx(Ly,H(M({asChild:!0},i),{children:s.jsx(Ct.button,H(M({type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":gU(o.value)?"":void 0},a),{ref:c,onClick:pt(a.onClick,y=>{y.currentTarget.focus(),u.current!=="mouse"&&g(y)}),onPointerDown:pt(a.onPointerDown,y=>{u.current=y.pointerType;const _=y.target;_.hasPointerCapture(y.pointerId)&&_.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(g(y),y.preventDefault())}),onKeyDown:pt(a.onKeyDown,y=>{const _=f.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&h(y.key),!(_&&y.key===" ")&&rhe.includes(y.key)&&(g(),y.preventDefault())})}))}))});GB.displayName=HB;var YB="SelectValue",KB=x.forwardRef((e,t)=>{const h=e,{__scopeSelect:r,className:n,style:a,children:i,placeholder:o=""}=h,l=me(h,["__scopeSelect","className","style","children","placeholder"]),c=Qd(YB,r),{onValueNodeHasChildrenChange:d}=c,u=i!==void 0,f=cr(t,c.onValueNodeChange);return vs(()=>{d(u)},[d,u]),s.jsx(Ct.span,H(M({},l),{ref:f,style:{pointerEvents:"none"},children:gU(c.value)?s.jsx(s.Fragment,{children:o}):i}))});KB.displayName=YB;var lhe="SelectIcon",ZB=x.forwardRef((e,t)=>{const i=e,{__scopeSelect:r,children:n}=i,a=me(i,["__scopeSelect","children"]);return s.jsx(Ct.span,H(M({"aria-hidden":!0},a),{ref:t,children:n||""}))});ZB.displayName=lhe;var che="SelectPortal",XB=e=>s.jsx(op,M({asChild:!0},e));XB.displayName=che;var uh="SelectContent",JB=x.forwardRef((e,t)=>{const r=Qd(uh,e.__scopeSelect),[n,a]=x.useState();if(vs(()=>{a(new DocumentFragment)},[]),!r.open){const i=n;return i?so.createPortal(s.jsx(QB,{scope:e.__scopeSelect,children:s.jsx(E1.Slot,{scope:e.__scopeSelect,children:s.jsx("div",{children:e.children})})}),i):null}return s.jsx(eU,H(M({},e),{ref:t}))});JB.displayName=uh;var bo=10,[QB,eu]=xp(uh),dhe="SelectContentImpl",uhe=$d("SelectContent.RemoveScroll"),eU=x.forwardRef((e,t)=>{const ee=e,{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:h,collisionPadding:p,sticky:g,hideWhenDetached:v,avoidCollisions:y}=ee,_=me(ee,["__scopeSelect","position","onCloseAutoFocus","onEscapeKeyDown","onPointerDownOutside","side","sideOffset","align","alignOffset","arrowPadding","collisionBoundary","collisionPadding","sticky","hideWhenDetached","avoidCollisions"]),w=Qd(uh,r),[b,N]=x.useState(null),[S,k]=x.useState(null),P=cr(t,de=>N(de)),[A,R]=x.useState(null),[$,O]=x.useState(null),z=C1(r),[D,B]=x.useState(!1),F=x.useRef(!1);x.useEffect(()=>{if(b)return n1(b)},[b]),t1();const U=x.useCallback(de=>{const[xe,...ie]=z().map(ue=>ue.ref.current),[se]=ie.slice(-1),V=document.activeElement;for(const ue of de)if(ue===V||(ue==null||ue.scrollIntoView({block:"nearest"}),ue===xe&&S&&(S.scrollTop=0),ue===se&&S&&(S.scrollTop=S.scrollHeight),ue==null||ue.focus(),document.activeElement!==V))return},[z,S]),G=x.useCallback(()=>U([A,b]),[U,A,b]);x.useEffect(()=>{D&&G()},[D,G]);const{onOpenChange:q,triggerPointerDownPosRef:K}=w;x.useEffect(()=>{if(b){let de={x:0,y:0};const xe=se=>{var V,ue,_e,ae;de={x:Math.abs(Math.round(se.pageX)-((ue=(V=K.current)==null?void 0:V.x)!=null?ue:0)),y:Math.abs(Math.round(se.pageY)-((ae=(_e=K.current)==null?void 0:_e.y)!=null?ae:0))}},ie=se=>{de.x<=10&&de.y<=10?se.preventDefault():b.contains(se.target)||q(!1),document.removeEventListener("pointermove",xe),K.current=null};return K.current!==null&&(document.addEventListener("pointermove",xe),document.addEventListener("pointerup",ie,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",xe),document.removeEventListener("pointerup",ie,{capture:!0})}}},[b,q,K]),x.useEffect(()=>{const de=()=>q(!1);return window.addEventListener("blur",de),window.addEventListener("resize",de),()=>{window.removeEventListener("blur",de),window.removeEventListener("resize",de)}},[q]);const[Z,Y]=vU(de=>{const xe=z().filter(V=>!V.disabled),ie=xe.find(V=>V.ref.current===document.activeElement),se=yU(xe,de,ie);se&&setTimeout(()=>se.ref.current.focus())}),Q=x.useCallback((de,xe,ie)=>{const se=!F.current&&!ie;(w.value!==void 0&&w.value===xe||se)&&(R(de),se&&(F.current=!0))},[w.value]),X=x.useCallback(()=>b==null?void 0:b.focus(),[b]),ne=x.useCallback((de,xe,ie)=>{const se=!F.current&&!ie;(w.value!==void 0&&w.value===xe||se)&&O(de)},[w.value]),re=n==="popper"?b2:tU,ye=re===b2?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:h,collisionPadding:p,sticky:g,hideWhenDetached:v,avoidCollisions:y}:{};return s.jsx(QB,{scope:r,content:b,viewport:S,onViewportChange:k,itemRefCallback:Q,selectedItem:A,onItemLeave:X,itemTextRefCallback:ne,focusSelectedItem:G,selectedItemText:$,position:n,isPositioned:D,searchRef:Z,children:s.jsx(Vy,{as:uhe,allowPinchZoom:!0,children:s.jsx(qy,{asChild:!0,trapped:w.open,onMountAutoFocus:de=>{de.preventDefault()},onUnmountAutoFocus:pt(a,de=>{var xe;(xe=w.trigger)==null||xe.focus({preventScroll:!0}),de.preventDefault()}),children:s.jsx(wh,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:de=>de.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:s.jsx(re,H(M(M({role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:de=>de.preventDefault()},_),ye),{onPlaced:()=>B(!0),ref:P,style:M({display:"flex",flexDirection:"column",outline:"none"},_.style),onKeyDown:pt(_.onKeyDown,de=>{const xe=de.ctrlKey||de.altKey||de.metaKey;if(de.key==="Tab"&&de.preventDefault(),!xe&&de.key.length===1&&Y(de.key),["ArrowUp","ArrowDown","Home","End"].includes(de.key)){let se=z().filter(V=>!V.disabled).map(V=>V.ref.current);if(["ArrowUp","End"].includes(de.key)&&(se=se.slice().reverse()),["ArrowUp","ArrowDown"].includes(de.key)){const V=de.target,ue=se.indexOf(V);se=se.slice(ue+1)}setTimeout(()=>U(se)),de.preventDefault()}})}))})})})})});eU.displayName=dhe;var hhe="SelectItemAlignedPosition",tU=x.forwardRef((e,t)=>{const P=e,{__scopeSelect:r,onPlaced:n}=P,a=me(P,["__scopeSelect","onPlaced"]),i=Qd(uh,r),o=eu(uh,r),[l,c]=x.useState(null),[d,u]=x.useState(null),f=cr(t,A=>u(A)),h=C1(r),p=x.useRef(!1),g=x.useRef(!0),{viewport:v,selectedItem:y,selectedItemText:_,focusSelectedItem:w}=o,b=x.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&d&&v&&y&&_){const A=i.trigger.getBoundingClientRect(),R=d.getBoundingClientRect(),$=i.valueNode.getBoundingClientRect(),O=_.getBoundingClientRect();if(i.dir!=="rtl"){const V=O.left-R.left,ue=$.left-V,_e=A.left-ue,ae=A.width+_e,we=Math.max(ae,R.width),oe=window.innerWidth-bo,ce=$v(ue,[bo,Math.max(bo,oe-we)]);l.style.minWidth=ae+"px",l.style.left=ce+"px"}else{const V=R.right-O.right,ue=window.innerWidth-$.right-V,_e=window.innerWidth-A.right-ue,ae=A.width+_e,we=Math.max(ae,R.width),oe=window.innerWidth-bo,ce=$v(ue,[bo,Math.max(bo,oe-we)]);l.style.minWidth=ae+"px",l.style.right=ce+"px"}const z=h(),D=window.innerHeight-bo*2,B=v.scrollHeight,F=window.getComputedStyle(d),U=parseInt(F.borderTopWidth,10),G=parseInt(F.paddingTop,10),q=parseInt(F.borderBottomWidth,10),K=parseInt(F.paddingBottom,10),Z=U+G+B+K+q,Y=Math.min(y.offsetHeight*5,Z),Q=window.getComputedStyle(v),X=parseInt(Q.paddingTop,10),ne=parseInt(Q.paddingBottom,10),re=A.top+A.height/2-bo,ye=D-re,ee=y.offsetHeight/2,de=y.offsetTop+ee,xe=U+G+de,ie=Z-xe;if(xe<=re){const V=z.length>0&&y===z[z.length-1].ref.current;l.style.bottom="0px";const ue=d.clientHeight-v.offsetTop-v.offsetHeight,_e=Math.max(ye,ee+(V?ne:0)+ue+q),ae=xe+_e;l.style.height=ae+"px"}else{const V=z.length>0&&y===z[0].ref.current;l.style.top="0px";const _e=Math.max(re,U+v.offsetTop+(V?X:0)+ee)+ie;l.style.height=_e+"px",v.scrollTop=xe-re+v.offsetTop}l.style.margin=`${bo}px 0`,l.style.minHeight=Y+"px",l.style.maxHeight=D+"px",n==null||n(),requestAnimationFrame(()=>p.current=!0)}},[h,i.trigger,i.valueNode,l,d,v,y,_,i.dir,n]);vs(()=>b(),[b]);const[N,S]=x.useState();vs(()=>{d&&S(window.getComputedStyle(d).zIndex)},[d]);const k=x.useCallback(A=>{A&&g.current===!0&&(b(),w==null||w(),g.current=!1)},[b,w]);return s.jsx(mhe,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:p,onScrollButtonChange:k,children:s.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:N},children:s.jsx(Ct.div,H(M({},a),{ref:f,style:M({boxSizing:"border-box",maxHeight:"100%"},a.style)}))})})});tU.displayName=hhe;var fhe="SelectPopperPosition",b2=x.forwardRef((e,t)=>{const l=e,{__scopeSelect:r,align:n="start",collisionPadding:a=bo}=l,i=me(l,["__scopeSelect","align","collisionPadding"]),o=P1(r);return s.jsx(Ub,H(M(M({},o),i),{ref:t,align:n,collisionPadding:a,style:H(M({boxSizing:"border-box"},i.style),{"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"})}))});b2.displayName=fhe;var[mhe,CT]=xp(uh,{}),j2="SelectViewport",rU=x.forwardRef((e,t)=>{const d=e,{__scopeSelect:r,nonce:n}=d,a=me(d,["__scopeSelect","nonce"]),i=eu(j2,r),o=CT(j2,r),l=cr(t,i.onViewportChange),c=x.useRef(0);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),s.jsx(E1.Slot,{scope:r,children:s.jsx(Ct.div,H(M({"data-radix-select-viewport":"",role:"presentation"},a),{ref:l,style:M({position:"relative",flex:1,overflow:"hidden auto"},a.style),onScroll:pt(a.onScroll,u=>{const f=u.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:p}=o;if(p!=null&&p.current&&h){const g=Math.abs(c.current-f.scrollTop);if(g>0){const v=window.innerHeight-bo*2,y=parseFloat(h.style.minHeight),_=parseFloat(h.style.height),w=Math.max(y,_);if(w<v){const b=w+g,N=Math.min(v,b),S=b-N;h.style.height=N+"px",h.style.bottom==="0px"&&(f.scrollTop=S>0?S:0,h.style.justifyContent="flex-end")}}}c.current=f.scrollTop})}))})]})});rU.displayName=j2;var nU="SelectGroup",[phe,ghe]=xp(nU),vhe=x.forwardRef((e,t)=>{const i=e,{__scopeSelect:r}=i,n=me(i,["__scopeSelect"]),a=Ps();return s.jsx(phe,{scope:r,id:a,children:s.jsx(Ct.div,H(M({role:"group","aria-labelledby":a},n),{ref:t}))})});vhe.displayName=nU;var sU="SelectLabel",aU=x.forwardRef((e,t)=>{const i=e,{__scopeSelect:r}=i,n=me(i,["__scopeSelect"]),a=ghe(sU,r);return s.jsx(Ct.div,H(M({id:a.id},n),{ref:t}))});aU.displayName=sU;var ow="SelectItem",[yhe,iU]=xp(ow),oU=x.forwardRef((e,t)=>{const w=e,{__scopeSelect:r,value:n,disabled:a=!1,textValue:i}=w,o=me(w,["__scopeSelect","value","disabled","textValue"]),l=Qd(ow,r),c=eu(ow,r),d=l.value===n,[u,f]=x.useState(i!=null?i:""),[h,p]=x.useState(!1),g=cr(t,b=>{var N;return(N=c.itemRefCallback)==null?void 0:N.call(c,b,n,a)}),v=Ps(),y=x.useRef("touch"),_=()=>{a||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return s.jsx(yhe,{scope:r,value:n,disabled:a,textId:v,isSelected:d,onItemTextChange:x.useCallback(b=>{f(N=>{var S;return N||((S=b==null?void 0:b.textContent)!=null?S:"").trim()})},[]),children:s.jsx(E1.ItemSlot,{scope:r,value:n,disabled:a,textValue:u,children:s.jsx(Ct.div,H(M({role:"option","aria-labelledby":v,"data-highlighted":h?"":void 0,"aria-selected":d&&h,"data-state":d?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1},o),{ref:g,onFocus:pt(o.onFocus,()=>p(!0)),onBlur:pt(o.onBlur,()=>p(!1)),onClick:pt(o.onClick,()=>{y.current!=="mouse"&&_()}),onPointerUp:pt(o.onPointerUp,()=>{y.current==="mouse"&&_()}),onPointerDown:pt(o.onPointerDown,b=>{y.current=b.pointerType}),onPointerMove:pt(o.onPointerMove,b=>{var N;y.current=b.pointerType,a?(N=c.onItemLeave)==null||N.call(c):y.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:pt(o.onPointerLeave,b=>{var N;b.currentTarget===document.activeElement&&((N=c.onItemLeave)==null||N.call(c))}),onKeyDown:pt(o.onKeyDown,b=>{var S;((S=c.searchRef)==null?void 0:S.current)!==""&&b.key===" "||(nhe.includes(b.key)&&_(),b.key===" "&&b.preventDefault())})}))})})});oU.displayName=ow;var Ig="SelectItemText",lU=x.forwardRef((e,t)=>{const _=e,{__scopeSelect:r,className:n,style:a}=_,i=me(_,["__scopeSelect","className","style"]),o=Qd(Ig,r),l=eu(Ig,r),c=iU(Ig,r),d=ohe(Ig,r),[u,f]=x.useState(null),h=cr(t,w=>f(w),c.onItemTextChange,w=>{var b;return(b=l.itemTextRefCallback)==null?void 0:b.call(l,w,c.value,c.disabled)}),p=u==null?void 0:u.textContent,g=x.useMemo(()=>s.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:v,onNativeOptionRemove:y}=d;return vs(()=>(v(g),()=>y(g)),[v,y,g]),s.jsxs(s.Fragment,{children:[s.jsx(Ct.span,H(M({id:c.textId},i),{ref:h})),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?so.createPortal(i.children,o.valueNode):null]})});lU.displayName=Ig;var cU="SelectItemIndicator",dU=x.forwardRef((e,t)=>{const i=e,{__scopeSelect:r}=i,n=me(i,["__scopeSelect"]);return iU(cU,r).isSelected?s.jsx(Ct.span,H(M({"aria-hidden":!0},n),{ref:t})):null});dU.displayName=cU;var N2="SelectScrollUpButton",uU=x.forwardRef((e,t)=>{const r=eu(N2,e.__scopeSelect),n=CT(N2,e.__scopeSelect),[a,i]=x.useState(!1),o=cr(t,n.onScrollButtonChange);return vs(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollTop>0;i(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?s.jsx(fU,H(M({},e),{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}})):null});uU.displayName=N2;var S2="SelectScrollDownButton",hU=x.forwardRef((e,t)=>{const r=eu(S2,e.__scopeSelect),n=CT(S2,e.__scopeSelect),[a,i]=x.useState(!1),o=cr(t,n.onScrollButtonChange);return vs(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;i(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?s.jsx(fU,H(M({},e),{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}})):null});hU.displayName=S2;var fU=x.forwardRef((e,t)=>{const d=e,{__scopeSelect:r,onAutoScroll:n}=d,a=me(d,["__scopeSelect","onAutoScroll"]),i=eu("SelectScrollButton",r),o=x.useRef(null),l=C1(r),c=x.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return x.useEffect(()=>()=>c(),[c]),vs(()=>{var f;const u=l().find(h=>h.ref.current===document.activeElement);(f=u==null?void 0:u.ref.current)==null||f.scrollIntoView({block:"nearest"})},[l]),s.jsx(Ct.div,H(M({"aria-hidden":!0},a),{ref:t,style:M({flexShrink:0},a.style),onPointerDown:pt(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:pt(a.onPointerMove,()=>{var u;(u=i.onItemLeave)==null||u.call(i),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:pt(a.onPointerLeave,()=>{c()})}))}),xhe="SelectSeparator",mU=x.forwardRef((e,t)=>{const a=e,{__scopeSelect:r}=a,n=me(a,["__scopeSelect"]);return s.jsx(Ct.div,H(M({"aria-hidden":!0},n),{ref:t}))});mU.displayName=xhe;var k2="SelectArrow",_he=x.forwardRef((e,t)=>{const l=e,{__scopeSelect:r}=l,n=me(l,["__scopeSelect"]),a=P1(r),i=Qd(k2,r),o=eu(k2,r);return i.open&&o.position==="popper"?s.jsx(qb,H(M(M({},a),n),{ref:t})):null});_he.displayName=k2;var whe="SelectBubbleInput",pU=x.forwardRef((a,n)=>{var i=a,{__scopeSelect:e,value:t}=i,r=me(i,["__scopeSelect","value"]);const o=x.useRef(null),l=cr(n,o),c=k1(t);return x.useEffect(()=>{const d=o.current;if(!d)return;const u=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(u,"value").set;if(c!==t&&h){const p=new Event("change",{bubbles:!0});h.call(d,t),d.dispatchEvent(p)}},[c,t]),s.jsx(Ct.select,H(M({},r),{style:M(M({},tF),r.style),ref:l,defaultValue:t}))});pU.displayName=whe;function gU(e){return e===""||e===void 0}function vU(e){const t=gs(e),r=x.useRef(""),n=x.useRef(0),a=x.useCallback(o=>{const l=r.current+o;t(l),function c(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),i=x.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return x.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,i]}function yU(e,t,r){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=bhe(e,Math.max(i,0));a.length===1&&(o=o.filter(d=>d!==r));const c=o.find(d=>d.textValue.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function bhe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var jhe=WB,xU=GB,Nhe=KB,She=ZB,khe=XB,_U=JB,Ehe=rU,wU=aU,bU=oU,Che=lU,Phe=dU,jU=uU,NU=hU,SU=mU;const aa=jhe,ia=Nhe,Hs=x.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=me(i,["className","children"]);return s.jsxs(xU,H(M({ref:n,className:ke("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e)},r),{children:[t,s.jsx(She,{asChild:!0,children:s.jsx(Ta,{className:"h-4 w-4 opacity-50"})})]}))});Hs.displayName=xU.displayName;const kU=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(jU,H(M({ref:r,className:ke("flex cursor-default items-center justify-center py-1",e)},t),{children:s.jsx(Mo,{className:"h-4 w-4"})}))});kU.displayName=jU.displayName;const EU=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(NU,H(M({ref:r,className:ke("flex cursor-default items-center justify-center py-1",e)},t),{children:s.jsx(Ta,{className:"h-4 w-4"})}))});EU.displayName=NU.displayName;const Gs=x.forwardRef((i,a)=>{var o=i,{className:e,children:t,position:r="popper"}=o,n=me(o,["className","children","position"]);return s.jsx(khe,{children:s.jsxs(_U,H(M({ref:a,className:ke("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),style:M({backgroundColor:"var(--neutral-50)",color:"var(--neutral-900)",borderColor:"var(--neutral-200)"},n.style),position:r},n),{children:[s.jsx(kU,{}),s.jsx(Ehe,{className:ke("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),s.jsx(EU,{})]}))})});Gs.displayName=_U.displayName;const The=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(wU,M({ref:r,className:ke("py-1.5 pl-8 pr-2 text-sm font-semibold",e)},t))});The.displayName=wU.displayName;const qt=x.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=me(i,["className","children"]);return s.jsxs(bU,H(M({ref:n,className:ke("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),style:M({fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},r.style)},r),{children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(Phe,{children:s.jsx(ta,{className:"h-4 w-4"})})}),s.jsx(Che,{children:t})]}))});qt.displayName=bU.displayName;const Ahe=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(SU,M({ref:r,className:ke("-mx-1 my-1 h-px bg-muted",e)},t))});Ahe.displayName=SU.displayName;class Rhe{static flagContent(t){return E(this,null,function*(){var r;try{const{data:{user:n},error:a}=yield T.auth.getUser();if(a||!n)throw new Error("User must be authenticated to flag content");const{data:i,error:o}=yield T.from("users").select("user_id").eq("user_id",n.id).maybeSingle(),l=(i==null?void 0:i.user_id)||n.id,{data:c,error:d}=yield T.from("moderation_flags").insert({flagged_by_user_id:l,content_type:t.content_type,content_id:t.content_id,flag_reason:t.flag_reason.trim(),flag_category:t.flag_category||null,additional_details:((r=t.additional_details)==null?void 0:r.trim())||null,status:"pending"}).select().single();if(d)throw d.code==="23505"?new Error("You have already flagged this content"):(console.error("Database error flagging content:",d),d);return c}catch(n){throw console.error("Error flagging content:",n),n instanceof Error?n:new Error("Failed to flag content")}})}static hasUserFlagged(t,r,n){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("moderation_flags").select("id").eq("flagged_by_user_id",t).eq("content_type",r).eq("content_id",n).maybeSingle();if(i&&i.code!=="PGRST116")throw i;return!!a}catch(a){return console.error("Error checking if user flagged content:",a),!1}})}static getFlagsForContent(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("moderation_flags").select("*").eq("content_type",t).eq("content_id",r).order("created_at",{ascending:!1});if(a)throw a;return n||[]}catch(n){return console.error("Error getting flags for content:",n),[]}})}}const CU=({isOpen:e,onClose:t,contentType:r,contentId:n,contentTitle:a})=>{const[i,o]=x.useState(""),[l,c]=x.useState(""),[d,u]=x.useState(""),[f,h]=x.useState(!1),{toast:p}=Rr(),g=[{value:"spam",label:"Spam"},{value:"harassment",label:"Harassment"},{value:"inappropriate_content",label:"Inappropriate Content"},{value:"misinformation",label:"Misinformation"},{value:"copyright_violation",label:"Copyright Violation"},{value:"fake_content",label:"Fake Content"},{value:"other",label:"Other"}],v=()=>E(void 0,null,function*(){if(!i||!l.trim()){p({title:"Missing Information",description:"Please select a category and provide a reason for flagging.",variant:"destructive"});return}h(!0);try{yield Rhe.flagContent({content_type:r,content_id:n,flag_reason:l.trim(),flag_category:i,additional_details:d.trim()||void 0}),p({title:"Content Flagged",description:"Thank you for reporting this. Our team will review it shortly."}),o(""),c(""),u(""),t()}catch(_){console.error("Error flagging content:",_),p({title:"Error",description:_.message||"Failed to flag content. Please try again.",variant:"destructive"})}finally{h(!1)}}),y={event:"Event",review:"Review",artist:"Artist",venue:"Venue"};return s.jsx(pn,{open:e,onOpenChange:t,children:s.jsxs(dn,{className:"sm:max-w-[500px]",children:[s.jsxs(Vn,{children:[s.jsxs(bn,{className:"flex items-center gap-2",children:[s.jsx(Qi,{className:"w-5 h-5 text-red-500"}),"Flag ",y[r]]}),s.jsxs(os,{children:[a&&s.jsx("span",{className:"font-semibold",children:a}),s.jsx("br",{}),"Help us keep the community safe by reporting content that violates our guidelines."]})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"flag-category",children:"Category *"}),s.jsxs(aa,{value:i,onValueChange:o,children:[s.jsx(Hs,{id:"flag-category",children:s.jsx(ia,{placeholder:"Select a category"})}),s.jsx(Gs,{children:g.map(_=>s.jsx(qt,{value:_.value,children:_.label},_.value))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"flag-reason",children:"Reason *"}),s.jsx(ys,{id:"flag-reason",placeholder:"Please describe why you're flagging this content...",value:l,onChange:_=>c(_.target.value),rows:4,className:"resize-none"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"additional-details",children:"Additional Details (Optional)"}),s.jsx(ys,{id:"additional-details",placeholder:"Any additional information that might help us review this...",value:d,onChange:_=>u(_.target.value),rows:3,className:"resize-none"})]})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(le,{variant:"outline",onClick:t,disabled:f,children:"Cancel"}),s.jsx(le,{onClick:v,disabled:f,children:f?"Submitting...":"Submit Flag"})]})]})})},Ohe={threshold:.5,rootMargin:"0px",trackOnce:!0,debounce:500};function Mhe(e,t,r={}){const n=x.useRef(null),a=x.useRef(new Set),i=x.useRef(new Map),o=M(M({},Ohe),r);return x.useEffect(()=>{const c=new IntersectionObserver(d=>{d.forEach(u=>{const f=u.target.getAttribute("data-track-id");if(f)if(u.isIntersecting){if(o.trackOnce&&a.current.has(f))return;const h=i.current.get(f);h&&clearTimeout(h);const p=setTimeout(()=>{const g=t.find(v=>v.id===f);g&&(On.view(e,f,void 0,H(M({},g.metadata),{viewport_time:Date.now(),tracked_via:"intersection_observer_list"})),a.current.add(f)),i.current.delete(f)},o.debounce);i.current.set(f,p)}else{const h=i.current.get(f);h&&(clearTimeout(h),i.current.delete(f))}})},{threshold:o.threshold,rootMargin:o.rootMargin});return n.current=c,()=>{i.current.forEach(d=>clearTimeout(d)),i.current.clear(),c.disconnect()}},[e,t,o.threshold,o.rootMargin,o.debounce,o.trackOnce]),x.useCallback((c,d)=>{!c||!n.current||(c.setAttribute("data-track-id",d),n.current.observe(c))},[])}const ra=e=>!e||typeof e!="string"?"":e.toLowerCase().trim().replace(/\bdc\b/g,"district of columbia").replace(/\bd\.c\.\b/g,"district of columbia").replace(/\bd c\b/g,"district of columbia").replace(/\bny\b/g,"new york").replace(/\bn\.y\.\b/g,"new york").replace(/\bnyc\b/g,"new york city").replace(/\bla\b/g,"los angeles").replace(/\bl\.a\.\b/g,"los angeles").replace(/\bsf\b/g,"san francisco").replace(/\bs\.f\.\b/g,"san francisco").replace(/\bchi\b/g,"chicago").replace(/\bchi\.\b/g,"chicago").replace(/\bmia\b/g,"miami").replace(/\bmia\.\b/g,"miami").replace(/\bsea\b/g,"seattle").replace(/\bsea\.\b/g,"seattle").replace(/\bphx\b/g,"phoenix").replace(/\bphx\.\b/g,"phoenix").replace(/\bden\b/g,"denver").replace(/\bden\.\b/g,"denver").replace(/\bvegas\b/g,"las vegas").replace(/\blv\b/g,"las vegas").replace(/\bl\.v\.\b/g,"las vegas").replace(/\s+/g," ").replace(/[^\w\s]/g,"").trim(),PU=e=>{const t=e.map(r=>ra(r));if(t.some(r=>r.includes("washington")&&r.includes("district of columbia"))){const r=e.find(n=>n.toLowerCase().includes("washington")&&(n.toLowerCase().includes("dc")||n.toLowerCase().includes("d.c.")||n.toLowerCase().includes("d c")));if(r)return r}if(t.some(r=>r.includes("new york"))){const r=e.find(a=>a.toLowerCase().includes("nyc"));if(r)return r;const n=e.find(a=>a.toLowerCase().includes("new york"));if(n)return n}if(t.some(r=>r.includes("los angeles"))){const r=e.find(n=>n.toLowerCase().includes("los angeles"));if(r)return r}return e.sort((r,n)=>r.length!==n.length?r.length-n.length:r.localeCompare(n))[0]},Cf=e=>{if(!e||e.length===0)return[];const t=new Map;e.forEach(a=>{if(!a||typeof a!="string")return;const i=ra(a);i&&(t.has(i)||t.set(i,[]),t.get(i).push(a))});const r=[];return t.forEach((a,i)=>{const o=PU(a);r.push(o)}),r.some(a=>ra(a).includes("washington")&&(a.toLowerCase().includes("dc")||a.toLowerCase().includes("d.c")))?r.filter(a=>!(ra(a).includes("washington")&&!a.toLowerCase().includes("dc")&&!a.toLowerCase().includes("d.c"))):r},c_=e=>{if(!e||typeof e!="string")return"";const t=e.trim(),r={sea:"Seattle",den:"Denver",nyc:"New York",ny:"New York",la:"Los Angeles",sf:"San Francisco",chi:"Chicago",mia:"Miami",phx:"Phoenix",lv:"Las Vegas",vegas:"Las Vegas",dc:"Washington DC","d.c.":"Washington DC","d c":"Washington DC",washington:"Washington DC"},n=t.toLowerCase();if(r[n])return r[n];const a=t.match(/^(.+?),\s*([A-Z]{2})$/);return a?a[1].trim():t.split(" ").map(i=>i.charAt(0).toUpperCase()+i.slice(1).toLowerCase()).join(" ")},O5=Object.freeze(Object.defineProperty({__proto__:null,deduplicateCities:Cf,formatCityNameForDisplay:c_,getCanonicalCityName:PU,normalizeCityName:ra},Symbol.toStringTag,{value:"Module"})),M5=50;new Date(0).toISOString();class Kf{static getPersonalizedFeedV3(t,r=50,n=0,a){return E(this,null,function*(){var c,d,u,f,h;const i=typeof performance!="undefined"?performance.now():Date.now(),o=yield this.normalizeFilters(a),l={p_user_id:t,p_limit:r,p_offset:n,p_city_lat:(d=(c=o.cityCoordinates)==null?void 0:c.lat)!=null?d:null,p_city_lng:(f=(u=o.cityCoordinates)==null?void 0:u.lng)!=null?f:null,p_radius_miles:o.radiusMiles};try{console.log(" Calling get_personalized_feed_v3 with payload:",l);const{data:p,error:g}=yield T.rpc("get_personalized_feed_v3",l);if(g)throw g.code==="42P01"||g.code==="PGRST204"||g.code==="PGRST116"||(h=g.message)!=null&&h.includes("does not exist")?(console.warn(" get_personalized_feed_v3 RPC function not found"),g):(console.error(" get_personalized_feed_v3 error:",{code:g.code,message:g.message,details:g.details,hint:g.hint,error:g}),g);const v=(p!=null?p:[]).map(w=>({id:String(w.id),type:w.type,score:Number(w.score)||0,payload:w.payload||{},context:w.context||{},created_at:w.created_at||new Date().toISOString()})),_=(typeof performance!="undefined"?performance.now():Date.now())-i;return console.log(" Unified feed v3 (RPC):",{userId:t,itemCount:v.length,types:v.reduce((w,b)=>(w[b.type]=(w[b.type]||0)+1,w),{}),loadTimeMs:Math.round(_)}),{items:v,has_more:v.length===r}}catch(p){throw console.error(" get_personalized_feed_v3 exception:",p),p}})}static getPersonalizedFeed(t,r=50,n=0,a=!1,i){return E(this,null,function*(){var f,h,p,g,v,y,_,w,b,N,S,k,P,A,R,$,O,z;const o=typeof performance!="undefined"?performance.now():Date.now(),l=yield this.normalizeFilters(i),c=n===0&&!a,d=c?`personalized_feed_${t}_${r}_${(f=l.cityCoordinates)==null?void 0:f.lat}_${(h=l.cityCoordinates)==null?void 0:h.lng}_${(p=l.genres)==null?void 0:p.join(",")}_${l.followingOnly}`:null;if(c&&d){const D=Do.get(d);if(D)return wn.log(" Personalized feed (cached):",{count:D.length,userId:t}),D}const u={p_user_id:t,p_limit:r,p_offset:n,p_city_lat:(v=(g=l.cityCoordinates)==null?void 0:g.lat)!=null?v:null,p_city_lng:(_=(y=l.cityCoordinates)==null?void 0:y.lng)!=null?_:null,p_radius_miles:(w=l.radiusMiles)!=null?w:50};try{wn.debug(" Calling get_personalized_feed_v3 with payload:",u);const{data:D,error:B}=yield T.rpc("get_personalized_feed_v3",u);if(B)return B.code==="42P01"||B.code==="PGRST204"||B.code==="PGRST116"||(b=B.message)!=null&&b.includes("does not exist")||(N=B.message)!=null&&N.includes("Could not find the function")?(wn.warn(" get_personalized_feed_v3 RPC function not found, using fallback feed"),this.getFallbackFeed(t,r,n,a,l)):B.code==="400"||B.code==="PGRST202"?(wn.error(" get_personalized_feed_v3 parameter/signature mismatch:",{code:B.code,message:B.message,hint:B.hint,payload:u}),wn.warn(" Falling back to basic feed due to function signature mismatch"),this.getFallbackFeed(t,r,n,a,l)):(wn.error(" get_personalized_feed_v3 error:",B),this.getFallbackFeed(t,r,n,a,l));const F=(D!=null?D:[]).filter(Z=>Z.type==="event").map(Z=>{var Q,X,ne,re,ye,ee,de,xe,ie,se,V,ue,_e,ae,we,oe,ce,Ae,Be,Xe,ge,We,Ue,at,mt,Ye,Ft,_t,Lt;const Y=Z.payload||{};return{event_id:Y.event_id||Z.id||"",title:(Q=Y.title)!=null?Q:null,artist_name:(X=Y.artist_name)!=null?X:null,artist_id:(ne=Y.artist_id)!=null?ne:null,artist_uuid:(re=Y.artist_uuid)!=null?re:null,venue_name:(ye=Y.venue_name)!=null?ye:null,venue_id:(ee=Y.venue_id)!=null?ee:null,venue_uuid:(de=Y.venue_uuid)!=null?de:null,venue_city:(xe=Y.venue_city)!=null?xe:null,venue_state:(ie=Y.venue_state)!=null?ie:null,venue_address:(se=Y.venue_address)!=null?se:null,venue_zip:(V=Y.venue_zip)!=null?V:null,event_date:Y.event_date,doors_time:(ue=Y.doors_time)!=null?ue:null,description:(_e=Y.description)!=null?_e:null,genres:Array.isArray(Y.genres)?Y.genres:[],latitude:(ae=Y.latitude)!=null?ae:null,longitude:(we=Y.longitude)!=null?we:null,ticket_urls:Array.isArray(Y.ticket_urls)?Y.ticket_urls:[],ticket_available:(oe=Y.ticket_available)!=null?oe:null,price_range:(ce=Y.price_range)!=null?ce:null,ticket_price_min:(Ae=Y.ticket_price_min)!=null?Ae:null,ticket_price_max:(Be=Y.ticket_price_max)!=null?Be:null,relevance_score:(Xe=Z.score)!=null?Xe:null,friend_interest_count:(ge=Y.friend_interest_count)!=null?ge:null,total_interest_count:(We=Y.interested_count)!=null?We:null,is_promoted:(Ue=Y.is_promoted)!=null?Ue:null,promotion_tier:(at=Y.promotion_tier)!=null?at:null,distance_miles:(mt=Y.distance_miles)!=null?mt:null,poster_image_url:(Ye=Y.poster_image_url)!=null?Ye:null,images:(Ft=Y.images)!=null?Ft:null,created_at:(_t=Z.created_at)!=null?_t:null,updated_at:(Lt=Y.updated_at)!=null?Lt:null}});wn.debug(" RPC v3 response (events only):",{rawDataCount:(S=D==null?void 0:D.length)!=null?S:0,eventCount:F.length,sampleEvent:F[0]?{title:F[0].title,venue_city:F[0].venue_city,event_date:F[0].event_date,genres:F[0].genres,event_date_parsed:F[0].event_date?new Date(F[0].event_date).toISOString():null,isPast:F[0].event_date?new Date(F[0].event_date).getTime()<Date.now():null}:null,filters:l.debugSummary,allEventTypes:(D==null?void 0:D.map(Z=>Z.type))||[],cityCoordinates:l.cityCoordinates,cleanedCities:l.cleanedCities,originalCities:l.originalCities});const U=this.applyClientSideFilters(F,l,a);wn.debug(" After client-side filtering:",{filteredCount:U.length,removedCount:F.length-U.length,sampleRemoved:F.length>U.length&&F[0]?{title:F[0].title,event_date:F[0].event_date,venue_city:F[0].venue_city,genres:F[0].genres}:null});const G=U.map(Z=>this.mapRowToEvent(Z));if(U.length===0&&n===0){const Z=F.slice(0,3).map(Y=>{const Q=Y.event_date?new Date(Y.event_date):null,X=l.dateStart,ne=l.dateEnd;let re=null;if((X||ne)&&Q){const ye=Q.getUTCFullYear(),ee=Q.getUTCMonth(),de=Q.getUTCDate();if(X){const xe=new Date(X),ie=xe.getUTCFullYear(),se=xe.getUTCMonth(),V=xe.getUTCDate();re=H(M({},re),{beforeStart:ye<ie||ye===ie&&ee<se||ye===ie&&ee===se&&de<V,startDate:`${ie}-${String(se+1).padStart(2,"0")}-${String(V).padStart(2,"0")}`})}if(ne){const xe=new Date(ne),ie=xe.getUTCFullYear(),se=xe.getUTCMonth(),V=xe.getUTCDate();re=H(M({},re),{afterEnd:ye>ie||ye===ie&&ee>se||ye===ie&&ee===se&&de>V,endDate:`${ie}-${String(se+1).padStart(2,"0")}-${String(V).padStart(2,"0")}`,eventDate:`${ye}-${String(ee+1).padStart(2,"0")}-${String(de).padStart(2,"0")}`})}}return{title:Y.title,event_date:Y.event_date,event_date_parsed:Q==null?void 0:Q.toISOString(),venue_city:Y.venue_city,genres:Y.genres,isPast:Q?Q.getTime()<Date.now():null,dateRangeCheck:re}});return wn.warn(" RPC returned no events at offset 0  falling back to basic feed.",{rawDataCount:(k=D==null?void 0:D.length)!=null?k:0,mappedRowsCount:F.length,filteredCount:U.length,sampleEvents:Z,activeFilters:{includePast:a,hasCityFilter:!l.cityCoordinates&&!!((P=l.cleanedCities)!=null&&P.length||(A=l.originalCities)!=null&&A.length),hasCityCoordinates:!!l.cityCoordinates,hasGenreFilter:!!((R=l.genres)!=null&&R.length),hasDateRange:!!(l.dateStart||l.dateEnd),dateRange:l.dateStart||l.dateEnd?{start:($=l.dateStart)==null?void 0:$.toISOString(),end:(O=l.dateEnd)==null?void 0:O.toISOString()}:null,hasDaysOfWeek:!!((z=l.daysOfWeek)!=null&&z.length)}}),this.getFallbackFeed(t,r,n,a,l)}const K=(typeof performance!="undefined"?performance.now():Date.now())-o;return c&&d&&Do.set(d,G,Iv.REVIEWS),wn.log(" Personalized feed (RPC):",{userId:t,count:G.length,limit:r,offset:n,loadTimeMs:Math.round(K),cached:c&&!!d}),G}catch(D){return wn.error(" get_personalized_feed_v2 exception:",D),this.getFallbackFeed(t,r,n,a,l)}})}static getFallbackFeed(t,r,n,a,i){return E(this,null,function*(){var o,l,c,d;try{let u=T.from("events").select("*").order("event_date",{ascending:!0}).range(n,n+r-1);if(a||(u=u.gte("event_date",new Date().toISOString())),(o=i.genres)!=null&&o.length&&(u=u.overlaps("genres",i.genres)),i.cleanedCities&&i.cleanedCities.length>0){const v=[];i.cleanedCities.forEach(y=>{v.push(`venue_city.ilike.%${y}%`),(y.includes("washington")||y.includes("district"))&&(v.push("venue_city.ilike.%Washington%"),v.push("venue_city.ilike.%DC%"),v.push("venue_city.ilike.%D.C%"))}),v.length>0&&(u=u.or(v.join(",")))}else if(i.originalCities&&i.originalCities.length>0){const v=[];i.originalCities.forEach(y=>{var w;const _=(w=y.split(",")[0])==null?void 0:w.trim();_&&v.push(`venue_city.ilike.%${_}%`)}),v.length>0&&(u=u.or(v.join(",")))}i.dateStartIso&&(u=u.gte("event_date",i.dateStartIso)),i.dateEndIso&&(u=u.lte("event_date",i.dateEndIso));const{data:f,error:h}=yield u;if(h)return wn.error(" Fallback feed query error:",h),[];let p=(f!=null?f:[]).map(v=>{var y,_,w,b,N,S,k;return{event_id:v.id,title:v.title,artist_name:v.artist_name,artist_id:v.artist_id,artist_uuid:(y=v.artist_uuid)!=null?y:null,venue_name:v.venue_name,venue_id:v.venue_id,venue_city:v.venue_city,venue_state:v.venue_state,venue_address:v.venue_address,venue_zip:v.venue_zip,event_date:v.event_date,doors_time:v.doors_time,description:v.description,genres:v.genres,latitude:v.latitude,longitude:v.longitude,ticket_urls:v.ticket_urls,ticket_available:v.ticket_available,price_range:v.price_range,ticket_price_min:(_=v.ticket_price_min)!=null?_:v.price_min,ticket_price_max:(w=v.ticket_price_max)!=null?w:v.price_max,relevance_score:0,friend_interest_count:0,total_interest_count:0,is_promoted:(b=v.is_promoted)!=null?b:!1,promotion_tier:(N=v.promotion_tier)!=null?N:null,distance_miles:null,poster_image_url:(S=v.poster_image_url)!=null?S:null,images:(k=v.images)!=null?k:null,created_at:v.created_at,updated_at:v.updated_at}});if(((l=i.cityCoordinates)==null?void 0:l.lat)!==void 0&&((c=i.cityCoordinates)==null?void 0:c.lng)!==void 0){const{lat:v,lng:y}=i.cityCoordinates,_=(d=i.radiusMiles)!=null?d:M5;p=p.map(w=>{var N;if(w.latitude==null||w.longitude==null)return w;const b=this.calculateDistanceMiles(typeof w.latitude=="string"?Number(w.latitude):w.latitude,typeof w.longitude=="string"?Number(w.longitude):w.longitude,v,y);return H(M({},w),{distance_miles:Number.isFinite(b)?b:(N=w.distance_miles)!=null?N:null})}).filter(w=>{if(w.distance_miles==null)return!0;const b=typeof w.distance_miles=="string"?Number(w.distance_miles):w.distance_miles;return Number.isFinite(b)?b<=_:!0})}let g=this.applyClientSideFilters(p,i,a);if(i.followingOnly){const{followedUuidSet:v,followedJambaseSet:y,followedNameSet:_}=yield this.getFollowedArtistIdentifiers(t);if(v.size===0&&y.size===0&&_.size===0)return[];g=g.filter(w=>{const b=w.artist_uuid?String(w.artist_uuid).toLowerCase():null,N=w.artist_id?String(w.artist_id).toLowerCase():null,S=w.artist_name?w.artist_name.toLowerCase().trim():null;return!!(b&&v.has(b)||N&&y.has(N)||S&&_.has(S))})}return g.map(v=>this.mapRowToEvent(v))}catch(u){return wn.error(" Fallback feed exception:",u),[]}})}static getFollowedArtistIdentifiers(t){return E(this,null,function*(){const r=new Set,n=new Set,a=new Set;try{const{data:i,error:o}=yield T.from("artist_follows").select("artist_id").eq("user_id",t);if(o)return wn.warn(" Unable to load artist_follows for fallback filter:",o),{followedUuidSet:r,followedJambaseSet:n,followedNameSet:a};const l=(i!=null?i:[]).map(c=>c.artist_id?String(c.artist_id):null).filter(c=>!!c);if(l.forEach(c=>r.add(c.toLowerCase())),l.length>0){const{data:c,error:d}=yield T.from("artists_with_external_ids").select("id, jambase_artist_id, name").in("id",l);if(d)wn.warn(" Unable to load artists for fallback filter:",d);else for(const u of c!=null?c:[])u.jambase_artist_id&&n.add(String(u.jambase_artist_id).toLowerCase()),u.name&&a.add(String(u.name).toLowerCase().trim())}}catch(i){}return{followedUuidSet:r,followedJambaseSet:n,followedNameSet:a}})}static getUserMusicProfile(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("get_user_music_profile_summary",{p_user_id:t});if(n)throw n;return!r||typeof r!="object"?null:r}catch(r){return wn.error(" Error fetching music profile:",r),null}})}static getUserTopGenres(t,r=10){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("get_user_top_genres",{p_user_id:t,p_limit:r});if(a)throw a;return Array.isArray(n)?n:[]}catch(n){return wn.error(" Error fetching top genres:",n),[]}})}static getUserTopArtists(t,r=20){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("get_user_top_artists",{p_user_id:t,p_limit:r});if(a)throw a;return Array.isArray(n)?n:[]}catch(n){return wn.error(" Error fetching top artists:",n),[]}})}static userHasMusicData(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_preferences").select("music_preference_signals").eq("user_id",t).maybeSingle();if(n)throw n;const a=(r==null?void 0:r.music_preference_signals)||[];return Array.isArray(a)&&a.length>0}catch(r){return wn.error(" Error checking music data:",r),!1}})}static getEventRelevanceScore(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("calculate_event_relevance_score",{p_user_id:t,p_event_id:r});if(a)throw a;return n||0}catch(n){return wn.error(" Error calculating relevance:",n),0}})}static mapRowToEvent(t){var l,c,d,u,f,h,p,g,v,y,_,w,b,N,S,k,P,A,R,$,O,z;const r=new Date().toISOString(),n=t.latitude!==null&&t.latitude!==void 0?Number(t.latitude):null,a=t.longitude!==null&&t.longitude!==void 0?Number(t.longitude):null,i=t.distance_miles!==null&&t.distance_miles!==void 0?Number(t.distance_miles):null,o=Array.isArray(t.ticket_urls)?t.ticket_urls:[];return{id:t.event_id,jambase_event_id:t.event_id,title:(l=t.title)!=null?l:"Untitled Event",artist_name:(c=t.artist_name)!=null?c:"Unknown Artist",artist_id:(d=t.artist_id)!=null?d:null,venue_name:(u=t.venue_name)!=null?u:"Unknown Venue",venue_id:(f=t.venue_id)!=null?f:null,venue_city:(h=t.venue_city)!=null?h:null,venue_state:(p=t.venue_state)!=null?p:null,venue_address:(g=t.venue_address)!=null?g:null,venue_zip:(v=t.venue_zip)!=null?v:null,event_date:t.event_date,doors_time:(y=t.doors_time)!=null?y:null,description:(_=t.description)!=null?_:null,genres:(w=t.genres)!=null?w:[],latitude:n,longitude:a,ticket_urls:o,ticket_available:(b=t.ticket_available)!=null?b:o.length>0,price_range:(N=t.price_range)!=null?N:null,ticket_price_min:t.ticket_price_min!==void 0&&t.ticket_price_min!==null?Number(t.ticket_price_min):null,ticket_price_max:t.ticket_price_max!==void 0&&t.ticket_price_max!==null?Number(t.ticket_price_max):null,ticket_url:o.length>0?o[0]:null,setlist:null,setlist_enriched:!1,setlist_song_count:null,setlist_fm_id:null,setlist_fm_url:null,setlist_source:null,setlist_last_updated:null,tour_name:null,created_at:(S=t.created_at)!=null?S:r,updated_at:(k=t.updated_at)!=null?k:r,relevance_score:(P=t.relevance_score)!=null?P:0,user_is_interested:void 0,interested_count:(A=t.total_interest_count)!=null?A:0,friends_interested_count:(R=t.friend_interest_count)!=null?R:0,artist_frequency_rank:void 0,diversity_penalty:void 0,is_promoted:($=t.is_promoted)!=null?$:!1,promotion_tier:t.promotion_tier==="basic"||t.promotion_tier==="premium"||t.promotion_tier==="featured"?t.promotion_tier:null,active_promotion_id:null,distance_miles:i,poster_image_url:(O=t.poster_image_url)!=null?O:null,images:(z=t.images)!=null?z:null}}static normalizeFilters(t){return E(this,null,function*(){var h,p,g,v,y,_,w,b,N,S,k;const r=(p=(h=t==null?void 0:t.selectedCities)==null?void 0:h.map(P=>{var A;return(A=P.split(",")[0])==null?void 0:A.trim()}).filter(Boolean).map(P=>ra(P||"")))!=null?p:void 0,n=(v=(g=t==null?void 0:t.city)!=null?g:r==null?void 0:r[0])!=null?v:null,a=n?ra(n):null,i=t!=null&&t.genres&&t.genres.length>0?t.genres:void 0,o=t!=null&&t.daysOfWeek&&t.daysOfWeek.length>0?t.daysOfWeek:void 0,l=(t==null?void 0:t.filterByFollowing)==="following",c=(y=t==null?void 0:t.dateRange)==null?void 0:y.from,d=(_=t==null?void 0:t.dateRange)==null?void 0:_.to,u=(w=t==null?void 0:t.radiusMiles)!=null?w:M5;let f=null;if(n)try{const{RadiusSearchService:P}=yield kn(()=>E(this,null,function*(){const{RadiusSearchService:A}=yield Promise.resolve().then(()=>P2);return{RadiusSearchService:A}}),void 0,import.meta.url);f=yield P.getCityCoordinates(n),f?wn.log(` Found coordinates for "${n}":`,f):wn.warn(` No coordinates found for city: "${n}"`)}catch(P){wn.error("Error looking up city coordinates:",P)}return{genres:i,cleanedCities:r,originalCities:(b=t==null?void 0:t.selectedCities)!=null?b:[],city:a,cityCoordinates:f,radiusMiles:u,dateStartIso:c?c.toISOString():void 0,dateEndIso:d?d.toISOString():void 0,dateStart:c,dateEnd:d,daysOfWeek:o,followingOnly:l,debugSummary:{city:a,radius:u,genres:(N=i==null?void 0:i.length)!=null?N:0,citiesSelected:(S=r==null?void 0:r.length)!=null?S:0,daysOfWeek:(k=o==null?void 0:o.length)!=null?k:0,followingOnly:l}}})}static applyClientSideFilters(t,r,n){var l;let a=t;const i=t.length;if(!n&&!r.cityCoordinates&&!r.dateStart&&!r.dateEnd){const c=Date.now(),d=a.length;a=a.filter(u=>{if(!u.event_date)return!0;const f=Date.parse(u.event_date);return Number.isNaN(f)?!0:f>=c}),a.length<d&&wn.debug(` Date filter removed ${d-a.length} past events`)}if(!r.cityCoordinates){const c=r.cleanedCities&&r.cleanedCities.length>0?r.cleanedCities:r.originalCities&&r.originalCities.length>0?r.originalCities:void 0;if(c&&c.length>0){const d=h=>ra(h||"").replace(/\s+/g," ").trim(),u=new Set(c.map(d)),f=a.length;a=a.filter(h=>{const p=h.venue_city?d(h.venue_city):"",g=u.has(p);return!g&&f>0&&wn.debug(` City filter removing event: "${h.title}" (city: "${h.venue_city}" -> normalized: "${p}", allowed: ${Array.from(u).join(", ")})`),g}),a.length<f&&wn.debug(` City filter removed ${f-a.length} events (allowed cities: ${Array.from(u).join(", ")})`)}}if(r.genres&&r.genres.length>0){const c=new Set(r.genres.map(u=>u.toLowerCase())),d=a.length;a=a.filter(u=>!u.genres||u.genres.length===0?!1:u.genres.some(f=>c.has(f.toLowerCase()))),a.length<d&&wn.debug(` Genre filter removed ${d-a.length} events`)}if((r.dateStart||r.dateEnd)&&!r.cityCoordinates){const c=a.length,d=r.dateStart?new Date(r.dateStart):null;d&&d.setUTCHours(0,0,0,0);const u=r.dateEnd?new Date(r.dateEnd):null;u&&u.setUTCHours(23,59,59,999),a=a.filter(f=>{if(!f.event_date)return!0;const h=Date.parse(f.event_date);if(Number.isNaN(h))return!0;const p=new Date(h);return!(d&&p.getTime()<d.getTime()||u&&p.getTime()>u.getTime())}),a.length<c&&wn.debug(` Date range filter removed ${c-a.length} events`)}if((l=r.daysOfWeek)!=null&&l.length){const c=new Set(r.daysOfWeek),d=a.length;a=a.filter(u=>{if(!u.event_date)return!0;const f=new Date(u.event_date);return Number.isNaN(f.getTime())?!0:c.has(f.getDay())}),a.length<d&&wn.debug(` Days of week filter removed ${d-a.length} events`)}return a.length<i&&wn.debug(` Client-side filters: ${i}  ${a.length} events (removed ${i-a.length})`),a}static calculateDistanceMiles(t,r,n,a){const o=f=>f*(Math.PI/180),l=o(n-t),c=o(a-r),d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(o(t))*Math.cos(o(n))*Math.sin(c/2)*Math.sin(c/2);return 3959*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}static mapRpcRowToFeedRow(t){var n,a,i,o,l,c,d,u,f,h,p,g,v,y,_,w,b,N,S,k,P,A,R,$,O,z,D,B,F,U,G,q,K;const r=Array.isArray(t.ticket_urls)?t.ticket_urls:t.ticket_url?[t.ticket_url]:[];return{event_id:String((a=(n=t.event_id)!=null?n:t.id)!=null?a:""),title:(i=t.title)!=null?i:null,artist_name:(o=t.artist_name)!=null?o:null,artist_id:(l=t.artist_id)!=null?l:null,artist_uuid:(c=t.artist_uuid)!=null?c:null,venue_name:(d=t.venue_name)!=null?d:null,venue_id:(u=t.venue_id)!=null?u:null,venue_uuid:(f=t.venue_uuid)!=null?f:null,venue_city:(h=t.venue_city)!=null?h:null,venue_state:(p=t.venue_state)!=null?p:null,venue_address:(g=t.venue_address)!=null?g:null,venue_zip:(v=t.venue_zip)!=null?v:null,event_date:t.event_date,doors_time:(y=t.doors_time)!=null?y:null,description:(_=t.description)!=null?_:null,genres:Array.isArray(t.genres)?t.genres:[],latitude:(w=t.latitude)!=null?w:null,longitude:(b=t.longitude)!=null?b:null,ticket_urls:r,ticket_available:(S=t.ticket_available)!=null?S:r.length>0?!0:(N=t.ticket_available)!=null?N:null,price_range:(k=t.price_range)!=null?k:null,ticket_price_min:(P=t.ticket_price_min)!=null?P:null,ticket_price_max:(A=t.ticket_price_max)!=null?A:null,relevance_score:(R=t.relevance_score)!=null?R:null,friend_interest_count:(O=($=t.friend_interest_count)!=null?$:t.friends_interested_count)!=null?O:null,total_interest_count:(D=(z=t.total_interest_count)!=null?z:t.interested_count)!=null?D:null,is_promoted:(B=t.is_promoted)!=null?B:null,promotion_tier:(F=t.promotion_tier)!=null?F:null,distance_miles:(U=t.distance_miles)!=null?U:null,poster_image_url:(G=t.poster_image_url)!=null?G:null,created_at:(q=t.created_at)!=null?q:null,updated_at:(K=t.updated_at)!=null?K:null}}}class D5{static getFriendsReviews(t,r=20,n=0){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(i)throw i;if(!a||a.length===0)return[];const o=a.map(d=>d.user_id===t?d.related_user_id:d.user_id),{data:l,error:c}=yield T.from("reviews").select(`
          *,
          user:users!reviews_user_id_fkey (
            name,
            avatar_url,
            verified,
            account_type
          ),
          events (
            id,
            title,
            venue_name,
            event_date,
            artist_name,
            artist_id
          )
        `).in("user_id",o).eq("is_public",!0).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).range(n,n+r-1);if(c)throw c;return(l||[]).map(d=>{var f,h,p;const u=d.events;return{id:`friends-review-${d.id}`,type:"review",review_id:d.id,title:`${((f=d.user)==null?void 0:f.name)||"Friend"}'s Review`,content:d.review_text||"",author:{id:d.user_id,name:((h=d.user)==null?void 0:h.name)||"Anonymous",avatar_url:(p=d.user)==null?void 0:p.avatar_url},created_at:d.created_at,updated_at:d.updated_at,rating:d.rating,is_public:!0,photos:d.photos||void 0,setlist:d.setlist||void 0,likes_count:d.likes_count||0,comments_count:d.comments_count||0,shares_count:d.shares_count||0,artist_performance_rating:d.artist_performance_rating,production_rating:d.production_rating,venue_rating:d.venue_rating,location_rating:d.location_rating,value_rating:d.value_rating,artist_performance_feedback:d.artist_performance_feedback,production_feedback:d.production_feedback,venue_feedback:d.venue_feedback,location_feedback:d.location_feedback,value_feedback:d.value_feedback,event_info:{event_name:(u==null?void 0:u.title)||"Concert Review",venue_name:(u==null?void 0:u.venue_name)||"Unknown Venue",event_date:(u==null?void 0:u.event_date)||d.created_at,artist_name:u==null?void 0:u.artist_name,artist_id:u==null?void 0:u.artist_id},relevance_score:this.calculateFriendReviewRelevance(d,1)}})}catch(a){return console.error("Error fetching friends reviews:",a),[]}})}static getFriendsPlusOneReviews(t,r=20,n=0){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(i)throw i;if(!a||a.length===0)return[];const o=a.map(p=>p.user_id===t?p.related_user_id:p.user_id),{data:l,error:c}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").in("user_id",o);if(c)throw c;const d=(l||[]).map(p=>p.user_id===t?p.related_user_id:p.user_id).filter(p=>!o.includes(p)&&p!==t),u=[...o,...d];if(u.length===0)return[];const{data:f,error:h}=yield T.from("reviews").select(`
          *,
          user:users!reviews_user_id_fkey (
            name,
            avatar_url,
            verified,
            account_type
          ),
          events (
            id,
            title,
            venue_name,
            event_date,
            artist_name,
            artist_id
          )
        `).in("user_id",u).eq("is_public",!0).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).range(n,n+r-1);if(h)throw h;return(f||[]).map(p=>{var _,w,b;const v=o.includes(p.user_id)?1:2,y=p.events;return{id:`friends-plus-one-review-${p.id}`,type:"review",review_id:p.id,title:`${((_=p.user)==null?void 0:_.name)||"Friend"}'s Review`,content:p.review_text||"",author:{id:p.user_id,name:((w=p.profiles)==null?void 0:w.name)||"Anonymous",avatar_url:(b=p.profiles)==null?void 0:b.avatar_url},created_at:p.created_at,updated_at:p.updated_at,rating:p.rating,is_public:!0,photos:p.photos||void 0,setlist:p.setlist||void 0,likes_count:p.likes_count||0,comments_count:p.comments_count||0,shares_count:p.shares_count||0,event_info:{event_name:(y==null?void 0:y.title)||"Concert Review",venue_name:(y==null?void 0:y.venue_name)||"Unknown Venue",event_date:(y==null?void 0:y.event_date)||p.created_at,artist_name:y==null?void 0:y.artist_name,artist_id:y==null?void 0:y.artist_id},relevance_score:this.calculateFriendReviewRelevance(p,v)}})}catch(a){return console.error("Error fetching friends plus one reviews:",a),[]}})}static getFriendActivity(t,r=10){return E(this,null,function*(){try{const n=yield this.getFriendsReviews(t,Math.floor(r*.7),0),{data:a,error:i}=yield T.from("notifications").select("id, type, title, message, data, created_at").eq("user_id",t).in("type",["friend_accepted"]).order("created_at",{ascending:!1}).limit(5);if(i)return console.error("Error fetching friend notifications:",i),n.slice(0,r);const o=[...n];return a&&a.length>0&&a.forEach(l=>{o.push({id:`friend-activity-${l.id}`,type:"friend_activity",title:l.title,content:l.message,author:{id:"system",name:"Synth",avatar_url:void 0},created_at:l.created_at,relevance_score:.8})}),o.slice(0,r)}catch(n){return console.error("Error fetching friend activity:",n),[]}})}static calculateFriendReviewRelevance(t,r){let n=.5;r===1?n+=.4:r===2&&(n+=.2);const a=Math.floor((Date.now()-new Date(t.created_at).getTime())/(1e3*60*60*24));return a<=7?n+=.2:a<=30&&(n+=.1),t.review_text&&t.review_text.length>50&&(n+=.1),t.photos&&t.photos.length>0&&(n+=.1),t.rating>=4&&(n+=.1),Math.min(n,1)}static getFriendCount(t){return E(this,null,function*(){try{const{count:r,error:n}=yield T.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(n)throw n;return r||0}catch(r){return console.error("Error getting friend count:",r),0}})}static areFriends(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("user_relationships").select("id").eq("relationship_type","friend").eq("status","accepted").or(`and(user_id.eq.${t},related_user_id.eq.${r}),and(user_id.eq.${r},related_user_id.eq.${t})`).single();if(a&&a.code!=="PGRST116")throw a;return!!n}catch(n){return console.error("Error checking friendship:",n),!1}})}static getConnectionDegreeReviews(t,r=20,n=0){return E(this,null,function*(){try{if(n===0){const l=h2.reviews(t,r,n),c=Do.get(l);if(c)return c}const{data:a,error:i}=yield T.rpc("get_connection_degree_reviews",{p_user_id:t,p_limit:r,p_offset:n});if(i){console.warn(" RPC function get_connection_degree_reviews failed, using direct query with connection functions"),console.warn("Error details:",{code:i.code,message:i.message,details:i.details});try{const[l,c]=yield Promise.all([T.rpc("get_first_degree_connections",{target_user_id:t}),T.rpc("get_second_degree_connections",{target_user_id:t})]),d=(l.data||[]).map(g=>g.connected_user_id),u=(c.data||[]).map(g=>g.connected_user_id),f=[...d,...u];if(f.length===0)return[];const{data:h,error:p}=yield T.from("reviews").select(`
              *,
              users:user_id (
                user_id,
                name,
                avatar_url,
                verified,
                account_type
              ),
              events (
                id,
                title,
                venue_name,
                event_date,
                artist_name
              )
            `).in("user_id",f).eq("is_public",!0).eq("is_draft",!1).not("review_text","is",null).order("created_at",{ascending:!1}).range(n,n+r-1);return p?(console.warn("Direct reviews query failed, returning empty array:",p),[]):(h||[]).map(g=>{const v=d.includes(g.user_id)?1:2,y=g.users||{},_=g.events||{};return{id:`review-${g.id}`,type:"review",review_id:g.id,title:`${y.name||"User"}'s Review`,content:g.review_text||"",author:{id:g.user_id,name:y.name||"Anonymous",avatar_url:y.avatar_url,verified:y.verified,account_type:y.account_type},created_at:g.created_at,updated_at:g.updated_at,rating:g.rating,is_public:g.is_public,photos:g.photos||void 0,setlist:g.setlist||void 0,likes_count:g.likes_count||0,comments_count:g.comments_count||0,shares_count:g.shares_count||0,artist_performance_rating:g.artist_performance_rating,production_rating:g.production_rating,venue_rating:g.venue_rating,location_rating:g.location_rating,value_rating:g.value_rating,artist_performance_feedback:g.artist_performance_feedback,production_feedback:g.production_feedback,venue_feedback:g.venue_feedback,location_feedback:g.location_feedback,value_feedback:g.value_feedback,event_info:{event_name:_.title||"Concert Review",venue_name:_.venue_name||"Unknown Venue",event_date:_.event_date||g.created_at,artist_name:_.artist_name,artist_id:_.artist_id},connection_degree:v,connection_type_label:v===1?"Friend":"Mutual Friend",relevance_score:this.calculateFriendReviewRelevance(g,v)}})}catch(l){return console.warn("Error in fallback query, returning empty array:",l),[]}}const o=(a||[]).map(l=>this.transformConnectionReview(l));if(n===0){const l=h2.reviews(t,r,n);Do.set(l,o,Iv.REVIEWS)}return o}catch(a){return console.error("Error fetching connection degree reviews:",a),this.getFriendsPlusOneReviews(t,r,n)}})}static transformConnectionReview(t){return{id:`connection-review-${t.review_id}`,type:"review",review_id:t.review_id,title:`${t.reviewer_name||"User"}'s Review`,content:t.review_text||t.content||"",author:{id:t.reviewer_id,name:t.reviewer_name||"Anonymous",avatar_url:t.reviewer_avatar,verified:t.reviewer_verified,account_type:t.reviewer_account_type},created_at:t.created_at,updated_at:t.updated_at,rating:t.rating,is_public:t.is_public,photos:t.photos||void 0,setlist:t.setlist||void 0,likes_count:t.likes_count||0,comments_count:t.comments_count||0,shares_count:t.shares_count||0,event_info:{event_name:t.event_title||"Concert Review",venue_name:t.venue_name||"Unknown Venue",event_date:t.Event_date||t.event_date||t.event_date||t.created_at,artist_name:t.artist_name,artist_id:t.artist_id},connection_degree:t.connection_degree,connection_type_label:t.connection_type_label,connection_color:t.connection_color,relevance_score:this.calculateFriendReviewRelevance(t,t.connection_degree||3)}}static fetchEventsByIds(t){return E(this,null,function*(){const r=new Map,n=Array.from(new Set(t));if(n.length===0)return r;try{const{data:a,error:i}=yield T.from("events").select("id, title, artist_name, artist_id, venue_name, venue_id, event_date, venue_city, venue_state").in("id",n);if(i)return console.warn(" Unable to load events for friend reviews:",i),r;for(const o of a!=null?a:[])o.id&&r.set(o.id,o)}catch(a){console.warn(" Unexpected error while loading events for friend reviews:",a)}return r})}}class KN{static getFeedItems(t){return E(this,null,function*(){const{userId:r,limit:n=50,offset:a=0,userLocation:i,includePrivateReviews:o=!0,feedType:l="all",filters:c}=t;try{switch(l){case"friends":case"friends_plus_one":return yield D5.getConnectionDegreeReviews(r,n,a);case"public_only":return yield this.getPublicReviews(r,n);case"all":default:return yield this.getUnifiedFeed(t)}}catch(d){throw console.error("Error fetching unified feed:",d),new Error(`Failed to fetch feed: ${d instanceof Error?d.message:"Unknown error"}`)}})}static getUnifiedFeed(t){return E(this,null,function*(){const{userId:r,limit:n=50,offset:a=0,userLocation:i,includePrivateReviews:o=!0,filters:l}=t;try{const c=[];if(o){const g=yield this.getUserReviews(r);c.push(...g)}try{const g=yield D5.getConnectionDegreeReviews(r,n);c.push(...g)}catch(g){console.warn("Error fetching connection degree reviews, falling back to public reviews:",g);const v=yield this.getPublicReviews(r,n);c.push(...v)}const d=yield this.getRecentEvents(i,20,r,a,l);c.push(...d);const u=yield this.getFriendActivity(r,10);c.push(...u);const f=this.deduplicateFeedItems(c),h=this.sortByRelevanceAndTime(f,i);return this.enforceArtistDiversity(h,1).slice(a,a+n)}catch(c){throw console.error("Error fetching unified feed:",c),new Error(`Failed to fetch feed: ${c instanceof Error?c.message:"Unknown error"}`)}})}static getUserReviews(t){return E(this,null,function*(){try{const{data:r}=yield T.from("users").select("name, avatar_url, verified, account_type").eq("user_id",t).single(),{data:n,error:a}=yield T.from("reviews").select("*").eq("user_id",t).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).limit(20);if(a)throw a;const i=yield this.fetchEventsByIds((n||[]).map(o=>o.event_id).filter(o=>!!o));return(n||[]).map(o=>{const l=o.event_id?i.get(o.event_id):null,c=Array.isArray(o.events)?o.events[0]:o.events,d=o.setlist||(c==null?void 0:c.setlist)||(l==null?void 0:l.setlist);return console.log(" getUserReviews: Processing review:",{reviewId:o.id,hasUserReviewSetlist:!!o.setlist,hasEventSetlist:!!(c!=null&&c.setlist||l!=null&&l.setlist),setlistToUse:!!d}),{id:`review-${o.id}`,type:"review",review_id:o.id,title:(c==null?void 0:c.title)||(l==null?void 0:l.title)||(o.is_public?"Your Public Review":"Your Private Review"),content:o.review_text||"",author:{id:t,name:(r==null?void 0:r.name)||"You",avatar_url:r==null?void 0:r.avatar_url,verified:r==null?void 0:r.verified,account_type:r==null?void 0:r.account_type},created_at:o.created_at,updated_at:o.updated_at,rating:o.rating,is_public:o.is_public,photos:o.photos||void 0,setlist:d||void 0,artist_performance_rating:o.artist_performance_rating,production_rating:o.production_rating,venue_rating:o.venue_rating,location_rating:o.location_rating,value_rating:o.value_rating,artist_performance_feedback:o.artist_performance_feedback,production_feedback:o.production_feedback,venue_feedback:o.venue_feedback,location_feedback:o.location_feedback,value_feedback:o.value_feedback,likes_count:o.likes_count||0,comments_count:o.comments_count||0,shares_count:o.shares_count||0,event_info:{event_name:(c==null?void 0:c.title)||(l==null?void 0:l.title)||"Concert Review",venue_name:(c==null?void 0:c.venue_name)||(l==null?void 0:l.venue_name)||"Unknown Venue",event_date:o.Event_date||o.event_date||(c==null?void 0:c.event_date)||(l==null?void 0:l.event_date)||o.created_at,artist_name:(c==null?void 0:c.artist_name)||(l==null?void 0:l.artist_name),artist_id:(c==null?void 0:c.artist_id)||(l==null?void 0:l.artist_id)},relevance_score:this.calculateReviewRelevance(o,!0)}})}catch(r){return console.error("Error fetching user reviews:",r),[]}})}static fetchEventsByIds(t){return E(this,null,function*(){const r=new Map,n=Array.from(new Set(t));if(n.length===0)return r;try{const{data:a,error:i}=yield T.from("events").select("id, title, artist_name, artist_id, venue_name, venue_id, event_date, venue_city, venue_state, setlist").in("id",n);if(i)return console.warn(" Unable to load events for reviews:",i),r;for(const o of a!=null?a:[])o.id&&r.set(o.id,o)}catch(a){console.warn(" Unexpected error while loading events for reviews:",a)}return r})}static fetchUsersByIds(t){return E(this,null,function*(){const r=new Map,n=Array.from(new Set(t));if(n.length===0)return r;try{const{data:a,error:i}=yield T.from("users").select("user_id, name, avatar_url, verified, account_type").in("user_id",n);if(i)return console.warn(" Unable to load users for reviews:",i),r;for(const o of a!=null?a:[])o.user_id&&r.set(o.user_id,o)}catch(a){console.warn(" Unexpected error while loading users for reviews:",a)}return r})}static getPublicReviews(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select("*").neq("user_id",t).eq("is_public",!0).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).limit(r);if(a)throw a;const i=yield this.fetchEventsByIds((n||[]).map(l=>l.event_id).filter(l=>!!l)),o=yield this.fetchUsersByIds((n||[]).map(l=>l.user_id).filter(l=>!!l));return(n||[]).map(l=>{const c=l.event_id?i.get(l.event_id):null,d=l.user_id?o.get(l.user_id):null;return{id:`public-review-${l.id}`,type:"review",review_id:l.id,title:`${(d==null?void 0:d.name)||"Someone"}'s Review`,content:l.review_text||"",author:{id:l.user_id,name:(d==null?void 0:d.name)||"Anonymous",avatar_url:d==null?void 0:d.avatar_url,verified:d==null?void 0:d.verified,account_type:d==null?void 0:d.account_type},created_at:l.created_at,rating:l.rating,is_public:!0,photos:l.photos||void 0,setlist:(c==null?void 0:c.setlist)||void 0,likes_count:l.likes_count||0,comments_count:l.comments_count||0,shares_count:l.shares_count||0,event_info:{event_name:(c==null?void 0:c.title)||"Concert Review",venue_name:(c==null?void 0:c.venue_name)||"Unknown Venue",event_date:(c==null?void 0:c.event_date)||l.created_at,artist_name:c==null?void 0:c.artist_name,artist_id:l.artist_id},relevance_score:this.calculateReviewRelevance(l,!1)}})}catch(n){return console.error("Error fetching public reviews:",n),[]}})}static getRecentEvents(t,r=20,n,a=0,i){return E(this,null,function*(){var o,l;try{if(n){console.log(" Attempting personalized feed for user:",n);try{const g=yield Kf.getPersonalizedFeed(n,r,a,!1,i),v=g.length>0&&g.some(_=>_.relevance_score!==void 0&&_.relevance_score!==null);return v||g.length===0||a>0?(g.length>0?console.log(" Using PERSONALIZED feed:",{count:g.length,topScore:(o=g[0])==null?void 0:o.relevance_score,topArtist:(l=g[0])==null?void 0:l.artist_name,hasScores:v,scores:g.slice(0,5).map(_=>({artist:_.artist_name,score:_.relevance_score}))}):console.log(" Using PERSONALIZED feed (empty - end of results at this offset):",{offset:a,limit:r,reason:a>0?"pagination":"no personalized events available"}),g.map(_=>this.transformPersonalizedEventToFeedItem(_,t))):(console.warn(" Personalized feed returned events without scores at offset 0. Using anyway (scores may be 0/null but still personalized)."),g.map(_=>this.transformPersonalizedEventToFeedItem(_,t)))}catch(g){console.warn(" Personalized feed failed, falling back to standard:",g)}}console.log(" Using STANDARD feed (no personalization)");let c=T.from("events").select("*").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0});const d=Math.max(r*2,40);c=c.limit(d);const{data:u,error:f}=yield c;if(f)throw f;let h=u||[];if(h.length<r&&a===0){console.log(` Standard feed: Only got ${h.length} events, fetching more to reach ${r}...`);const{data:g}=yield T.from("events").select("*").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(r*3);g&&g.length>h.length&&(h=g,console.log(` Standard feed: Got ${h.length} events from expanded query`))}let p=(h||[]).map(g=>{const v={id:`event-${g.id}`,type:"event",title:g.title,content:g.description||`${g.artist_name} is performing at ${g.venue_name}`,author:{id:"system",name:"",avatar_url:void 0},created_at:g.created_at||g.event_date,event_data:M(M(M(M(M({id:g.id,jambase_event_id:g.jambase_event_id,title:g.title,artist_name:g.artist_name,artist_id:g.artist_id||"",venue_name:g.venue_name,venue_id:g.venue_id||"",event_date:g.event_date,doors_time:g.doors_time,description:g.description,genres:g.genres,venue_address:g.venue_address,venue_city:g.venue_city,venue_state:g.venue_state,venue_zip:g.venue_zip,latitude:g.latitude?Number(g.latitude):void 0,longitude:g.longitude?Number(g.longitude):void 0,ticket_available:g.ticket_available,price_range:g.price_range,ticket_urls:g.ticket_urls||(g.ticket_url?[g.ticket_url]:[]),setlist:g.setlist,setlist_enriched:g.setlist_enriched,setlist_song_count:g.setlist_song_count,setlist_fm_id:g.setlist_fm_id,setlist_fm_url:g.setlist_fm_url,tour_name:g.tour_name,created_at:g.created_at,updated_at:g.updated_at},g.price_min&&{ticket_price_min:g.price_min}),g.price_max&&{ticket_price_max:g.price_max}),g.ticket_url&&{ticket_url:g.ticket_url}),g.price_min&&{price_min:g.price_min}),g.price_max&&{price_max:g.price_max}),event_info:{event_name:g.title,venue_name:g.venue_name,event_date:g.event_date,artist_name:g.artist_name,artist_id:g.artist_id},location:g.latitude&&g.longitude?{lat:Number(g.latitude),lng:Number(g.longitude),venue_name:g.venue_name,venue_address:g.venue_address}:void 0,relevance_score:this.calculateEventRelevance(g,t)};return t&&v.location&&(v.distance_miles=this.calculateDistance(t.lat,t.lng,v.location.lat,v.location.lng)),v});return t&&(p=p.filter(g=>!g.distance_miles||g.distance_miles<=50).slice(0,r)),p}catch(c){return console.error("Error fetching recent events:",c),[]}})}static transformPersonalizedEventToFeedItem(t,r){var o,l,c;const n=t.id||t.event_id||t.jambase_event_id,a=H(M({},t),{id:n,ticket_price_min:(o=t.ticket_price_min)!=null?o:null,ticket_price_max:(l=t.ticket_price_max)!=null?l:null,ticket_url:(c=t.ticket_url)!=null?c:null}),i={id:`event-${n||"unknown"}`,type:"event",title:t.title,content:t.description||`${t.artist_name} is performing at ${t.venue_name}`,author:{id:"system",name:"",avatar_url:void 0},created_at:t.created_at,event_data:a,event_info:{event_name:t.title,venue_name:t.venue_name,event_date:t.event_date,artist_name:t.artist_name,artist_id:t.artist_id||void 0},location:t.latitude&&t.longitude?{lat:Number(t.latitude),lng:Number(t.longitude),venue_name:t.venue_name,venue_address:t.venue_address||void 0}:void 0,relevance_score:(t.relevance_score||0)/100};return r&&i.location&&(i.distance_miles=this.calculateDistance(r.lat,r.lng,i.location.lat,i.location.lng)),i}static getFriendActivity(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("user_relationships").select("id, user_id, related_user_id, created_at").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`).order("created_at",{ascending:!1}).limit(r);if(a)throw a;if(!n||n.length===0)return[];const i=n.map(d=>d.user_id===t?d.related_user_id:d.user_id),{data:o,error:l}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",i);if(l)return console.error("Error fetching friend profiles:",l),[];const c=new Map((o==null?void 0:o.map(d=>[d.user_id,d]))||[]);return n.map(d=>{const u=d.user_id===t?d.related_user_id:d.user_id,f=c.get(u);return{id:`friend-activity-${d.id}`,type:"friend_activity",title:`You're now friends with ${(f==null?void 0:f.name)||"someone"}!`,content:"Start chatting and discover concerts together.",author:{id:u,name:(f==null?void 0:f.name)||"Unknown",avatar_url:f==null?void 0:f.avatar_url},created_at:d.created_at,relevance_score:this.calculateFriendActivityRelevance(d)}})}catch(n){return console.error("Error fetching friend activity:",n),[]}})}static sortByRelevanceAndTime(t,r){return t.sort((n,a)=>{const i=a.relevance_score-n.relevance_score;if(Math.abs(i)>.1)return i;const o=new Date(n.created_at).getTime();return new Date(a.created_at).getTime()-o})}static calculateReviewRelevance(t,r){let n=r?.9:.5;t.is_public&&!r&&(n+=.2);const a=(Date.now()-new Date(t.created_at).getTime())/(1e3*60*60*24);a<1?n+=.3:a<7?n+=.2:a<30&&(n+=.1);const i=(t.likes_count||0)+(t.comments_count||0);return n+=Math.min(i*.05,.3),Math.min(n,1)}static calculateEventRelevance(t,r){let n=.6;const i=(new Date(t.event_date).getTime()-Date.now())/(1e3*60*60*24);return i>=0&&i<=30?n+=.3:i>30&&i<=90&&(n+=.2),t.latitude&&t.longitude&&(n+=.1),t.ticket_available&&(n+=.1),Math.min(n,1)}static calculateFriendActivityRelevance(t){let r=.7;const n=(Date.now()-new Date(t.created_at).getTime())/(1e3*60*60*24);return n<1?r+=.2:n<7&&(r+=.1),Math.min(r,1)}static calculateDistance(t,r,n,a){const o=this.toRadians(n-t),l=this.toRadians(a-r),c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(this.toRadians(t))*Math.cos(this.toRadians(n))*Math.sin(l/2)*Math.sin(l/2);return 3959*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}static toRadians(t){return t*(Math.PI/180)}static deduplicateFeedItems(t){var i,o,l,c,d,u,f;const r=new Set,n=[],a=[];for(const h of t){let p=null;if(h.type==="event"&&((i=h.event_data)!=null&&i.id)&&(p=`id-${String(h.event_data.id)}`),!p&&h.type==="event"){const g=(((o=h.event_info)==null?void 0:o.artist_name)||h.title||"").toLowerCase().trim().replace(/\s+/g," ").replace(/[^\w\s]/g,""),v=(((l=h.event_info)==null?void 0:l.venue_name)||((c=h.event_data)==null?void 0:c.venue_name)||"").toLowerCase().trim().replace(/\s+/g," ").replace(/\bthe\s+/gi,"").replace(/\bo2\s+/gi,"").replace(/[^\w\s]/g,""),y=(d=h.event_info)!=null&&d.event_date?h.event_info.event_date.split("T")[0]:(u=h.event_data)!=null&&u.event_date?h.event_data.event_date.split("T")[0]:"";g&&v&&y&&(p=`match-${g}|${v}|${y}`)}if(!p){n.push(h);continue}if(!r.has(p))r.add(p),n.push(h);else{a.push(p);const g=((f=h.event_info)==null?void 0:f.event_name)||h.title||"Unknown";console.log(` Duplicate event filtered: ${g} (key: ${p})`)}}return a.length>0&&console.log(` Deduplication: Removed ${a.length} duplicate event(s) from feed`),n}static enforceArtistDiversity(t,r){var i,o;const n=new Map,a=[];for(const l of t){const c=(((i=l.event_info)==null?void 0:i.artist_name)||((o=l.event_data)==null?void 0:o.artist_name)||"").toString();if(!c){a.push(l);continue}const d=c.toLowerCase().trim().replace(/\s+/g," ").replace(/[^[\w\s]]/g,""),u=n.get(d)||0;u<r&&(a.push(l),n.set(d,u+1))}return a}}const Dhe=new ya.Icon({iconUrl:qB,iconRetinaUrl:UB,shadowUrl:VB,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),Ihe=({center:e,zoom:t,onCenterChange:r})=>{const n=kh(),a=x.useRef(!1),i=x.useRef(e),o=x.useRef(t);return x.useEffect(()=>{const l=Math.abs(i.current[0]-e[0])>1e-4||Math.abs(i.current[1]-e[1])>1e-4,c=o.current!==t;(l||c)&&!a.current&&(i.current=e,o.current=t,n.setView(e,t,{animate:!1}))},[n,e,t]),x.useEffect(()=>{const l=()=>{a.current=!0},c=()=>{const d=n.getCenter();r&&r([d.lat,d.lng]),setTimeout(()=>{a.current=!1},300)};return n.on("movestart",l),n.on("dragstart",l),n.on("zoomstart",l),n.on("wheel",l),n.on("moveend",c),n.on("dragend",c),n.on("zoomend",c),()=>{n.off("movestart",l),n.off("dragstart",l),n.off("zoomstart",l),n.off("wheel",l),n.off("moveend",c),n.off("dragend",c),n.off("zoomend",c)}},[n,r]),null},$he=({events:e,onBoundsChange:t})=>{const r=kh(),n=x.useRef(null),a=x.useRef(e),i=x.useRef(t);return x.useEffect(()=>{a.current=e,i.current=t},[e,t]),x.useEffect(()=>{const o=()=>{const c=r.getBounds(),d={north:c.getNorth(),south:c.getSouth(),east:c.getEast(),west:c.getWest()},u=`${d.north.toFixed(4)}_${d.south.toFixed(4)}_${d.east.toFixed(4)}_${d.west.toFixed(4)}`;if(n.current===u)return;n.current=u;const f=a.current.filter(h=>{if(!h.latitude||!h.longitude)return!1;const p=Number(h.latitude),g=Number(h.longitude);return Number.isNaN(p)||Number.isNaN(g)?!1:p>=d.south&&p<=d.north&&g>=d.west&&g<=d.east});i.current&&i.current(f)};r.on("moveend",o),r.on("zoomend",o);const l=setTimeout(o,100);return()=>{clearTimeout(l),r.off("moveend",o),r.off("zoomend",o)}},[r]),null},TU=({center:e,zoom:t,events:r,onEventClick:n,onMapCenterChange:a})=>{const i=x.useRef(null),[o,l]=x.useState([]),c=r.filter(u=>{const f=Number(u.latitude),h=Number(u.longitude);return u.latitude!=null&&u.longitude!=null&&!Number.isNaN(f)&&!Number.isNaN(h)}),d=o.length>0?o:c;return s.jsx("div",{className:"w-full h-full",children:s.jsxs(Xy,{center:e,zoom:t,style:{height:"100%",width:"100%"},ref:i,scrollWheelZoom:!0,wheelPxPerZoomLevel:60,children:[s.jsx(Jy,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(Ihe,{center:e,zoom:t,onCenterChange:a}),s.jsx($he,{events:c,onBoundsChange:l}),d.map(u=>s.jsx(ch,{position:[Number(u.latitude),Number(u.longitude)],icon:Dhe,children:s.jsx(BB,{maxWidth:300,className:"event-popup",children:s.jsxs("div",{className:"p-2",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-sm text-gray-900 mb-1 truncate",children:u.title}),s.jsx("p",{className:"text-sm text-blue-600 font-medium mb-1",children:u.artist_name})]}),s.jsxs(Ke,{variant:"outline",className:"text-xs ml-2",children:[s.jsx($t,{className:"w-3 h-3 mr-1"}),"Event"]})]}),s.jsxs("div",{className:"space-y-2 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx(gr,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:u.venue_name})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx(It,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{children:(()=>{try{return Mt(ms(u.event_date),"MMM d, yyyy h:mm a")}catch(f){return u.event_date}})()})]}),u.venue_address&&s.jsxs("p",{className:"text-xs text-gray-500 line-clamp-2",children:[u.venue_address,u.venue_city&&`, ${u.venue_city}`,u.venue_state&&`, ${u.venue_state}`]}),u.genres&&u.genres.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:u.genres.slice(0,3).map((f,h)=>s.jsx(Ke,{variant:"secondary",className:"text-xs",children:f},h))}),u.price_range&&s.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-600",children:[s.jsx(Ml,{className:"w-3 h-3"}),s.jsx("span",{children:Fv(u.price_range)})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{size:"sm",onClick:f=>{f.stopPropagation(),n(u)},className:"flex-1 text-xs bg-pink-500 hover:bg-pink-600",children:[s.jsx($t,{className:"w-3 h-3 mr-1"}),"Review"]}),u.ticket_urls&&u.ticket_urls.length>0&&s.jsxs(le,{size:"sm",variant:"outline",onClick:f=>{f.stopPropagation(),window.open(u.ticket_urls[0],"_blank")},className:"text-xs",children:[s.jsx(Ml,{className:"w-3 h-3 mr-1"}),"Tickets"]})]})]})})},u.id))]})})};var E2=["Enter"," "],Lhe=["ArrowDown","PageUp","Home"],AU=["ArrowUp","PageDown","End"],Fhe=[...Lhe,...AU],zhe={ltr:[...E2,"ArrowRight"],rtl:[...E2,"ArrowLeft"]},Bhe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Qy="Menu",[zv,Uhe,qhe]=ip(Qy),[Eh,RU]=Os(Qy,[qhe,Zd,l1]),T1=Zd(),OU=l1(),[Vhe,Ch]=Eh(Qy),[Whe,ex]=Eh(Qy),MU=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:i,modal:o=!0}=e,l=T1(t),[c,d]=x.useState(null),u=x.useRef(!1),f=gs(i),h=Sh(a);return x.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),s.jsx(Bb,H(M({},l),{children:s.jsx(Vhe,{scope:t,open:r,onOpenChange:f,content:c,onContentChange:d,children:s.jsx(Whe,{scope:t,onClose:x.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:u,dir:h,modal:o,children:n})})}))};MU.displayName=Qy;var Hhe="MenuAnchor",PT=x.forwardRef((e,t)=>{const i=e,{__scopeMenu:r}=i,n=me(i,["__scopeMenu"]),a=T1(r);return s.jsx(Ly,H(M(M({},a),n),{ref:t}))});PT.displayName=Hhe;var TT="MenuPortal",[Ghe,DU]=Eh(TT,{forceMount:void 0}),IU=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,i=Ch(TT,t);return s.jsx(Ghe,{scope:t,forceMount:r,children:s.jsx(Ys,{present:r||i.open,children:s.jsx(op,{asChild:!0,container:a,children:n})})})};IU.displayName=TT;var ao="MenuContent",[Yhe,AT]=Eh(ao),$U=x.forwardRef((e,t)=>{const r=DU(ao,e.__scopeMenu),l=e,{forceMount:n=r.forceMount}=l,a=me(l,["forceMount"]),i=Ch(ao,e.__scopeMenu),o=ex(ao,e.__scopeMenu);return s.jsx(zv.Provider,{scope:e.__scopeMenu,children:s.jsx(Ys,{present:n||i.open,children:s.jsx(zv.Slot,{scope:e.__scopeMenu,children:o.modal?s.jsx(Khe,H(M({},a),{ref:t})):s.jsx(Zhe,H(M({},a),{ref:t}))})})})}),Khe=x.forwardRef((e,t)=>{const r=Ch(ao,e.__scopeMenu),n=x.useRef(null),a=cr(t,n);return x.useEffect(()=>{const i=n.current;if(i)return n1(i)},[]),s.jsx(RT,H(M({},e),{ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:pt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)}))}),Zhe=x.forwardRef((e,t)=>{const r=Ch(ao,e.__scopeMenu);return s.jsx(RT,H(M({},e),{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)}))}),Xhe=$d("MenuContent.ScrollLock"),RT=x.forwardRef((e,t)=>{const K=e,{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:h,onDismiss:p,disableOutsideScroll:g}=K,v=me(K,["__scopeMenu","loop","trapFocus","onOpenAutoFocus","onCloseAutoFocus","disableOutsidePointerEvents","onEntryFocus","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss","disableOutsideScroll"]),y=Ch(ao,r),_=ex(ao,r),w=T1(r),b=OU(r),N=Uhe(r),[S,k]=x.useState(null),P=x.useRef(null),A=cr(t,P,y.onContentChange),R=x.useRef(0),$=x.useRef(""),O=x.useRef(0),z=x.useRef(null),D=x.useRef("right"),B=x.useRef(0),F=g?Vy:x.Fragment,U=g?{as:Xhe,allowPinchZoom:!0}:void 0,G=Z=>{var de,xe;const Y=$.current+Z,Q=N().filter(ie=>!ie.disabled),X=document.activeElement,ne=(de=Q.find(ie=>ie.ref.current===X))==null?void 0:de.textValue,re=Q.map(ie=>ie.textValue),ye=cfe(re,Y,ne),ee=(xe=Q.find(ie=>ie.textValue===ye))==null?void 0:xe.ref.current;(function ie(se){$.current=se,window.clearTimeout(R.current),se!==""&&(R.current=window.setTimeout(()=>ie(""),1e3))})(Y),ee&&setTimeout(()=>ee.focus())};x.useEffect(()=>()=>window.clearTimeout(R.current),[]),t1();const q=x.useCallback(Z=>{var Q,X;return D.current===((Q=z.current)==null?void 0:Q.side)&&ufe(Z,(X=z.current)==null?void 0:X.area)},[]);return s.jsx(Yhe,{scope:r,searchRef:$,onItemEnter:x.useCallback(Z=>{q(Z)&&Z.preventDefault()},[q]),onItemLeave:x.useCallback(Z=>{var Y;q(Z)||((Y=P.current)==null||Y.focus(),k(null))},[q]),onTriggerLeave:x.useCallback(Z=>{q(Z)&&Z.preventDefault()},[q]),pointerGraceTimerRef:O,onPointerGraceIntentChange:x.useCallback(Z=>{z.current=Z},[]),children:s.jsx(F,H(M({},U),{children:s.jsx(qy,{asChild:!0,trapped:a,onMountAutoFocus:pt(i,Z=>{var Y;Z.preventDefault(),(Y=P.current)==null||Y.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:s.jsx(wh,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:h,onDismiss:p,children:s.jsx(h8,H(M({asChild:!0},b),{dir:_.dir,orientation:"vertical",loop:n,currentTabStopId:S,onCurrentTabStopIdChange:k,onEntryFocus:pt(c,Z=>{_.isUsingKeyboardRef.current||Z.preventDefault()}),preventScrollOnEntryFocus:!0,children:s.jsx(Ub,H(M(M({role:"menu","aria-orientation":"vertical","data-state":QU(y.open),"data-radix-menu-content":"",dir:_.dir},w),v),{ref:A,style:M({outline:"none"},v.style),onKeyDown:pt(v.onKeyDown,Z=>{const Q=Z.target.closest("[data-radix-menu-content]")===Z.currentTarget,X=Z.ctrlKey||Z.altKey||Z.metaKey,ne=Z.key.length===1;Q&&(Z.key==="Tab"&&Z.preventDefault(),!X&&ne&&G(Z.key));const re=P.current;if(Z.target!==re||!Fhe.includes(Z.key))return;Z.preventDefault();const ee=N().filter(de=>!de.disabled).map(de=>de.ref.current);AU.includes(Z.key)&&ee.reverse(),ofe(ee)}),onBlur:pt(e.onBlur,Z=>{Z.currentTarget.contains(Z.target)||(window.clearTimeout(R.current),$.current="")}),onPointerMove:pt(e.onPointerMove,Bv(Z=>{const Y=Z.target,Q=B.current!==Z.clientX;if(Z.currentTarget.contains(Y)&&Q){const X=Z.clientX>B.current?"right":"left";D.current=X,B.current=Z.clientX}}))}))}))})})}))})});$U.displayName=ao;var Jhe="MenuGroup",OT=x.forwardRef((e,t)=>{const a=e,{__scopeMenu:r}=a,n=me(a,["__scopeMenu"]);return s.jsx(Ct.div,H(M({role:"group"},n),{ref:t}))});OT.displayName=Jhe;var Qhe="MenuLabel",LU=x.forwardRef((e,t)=>{const a=e,{__scopeMenu:r}=a,n=me(a,["__scopeMenu"]);return s.jsx(Ct.div,H(M({},n),{ref:t}))});LU.displayName=Qhe;var lw="MenuItem",I5="menu.itemSelect",A1=x.forwardRef((e,t)=>{const f=e,{disabled:r=!1,onSelect:n}=f,a=me(f,["disabled","onSelect"]),i=x.useRef(null),o=ex(lw,e.__scopeMenu),l=AT(lw,e.__scopeMenu),c=cr(t,i),d=x.useRef(!1),u=()=>{const h=i.current;if(!r&&h){const p=new CustomEvent(I5,{bubbles:!0,cancelable:!0});h.addEventListener(I5,g=>n==null?void 0:n(g),{once:!0}),uP(h,p),p.defaultPrevented?d.current=!1:o.onClose()}};return s.jsx(FU,H(M({},a),{ref:c,disabled:r,onClick:pt(e.onClick,u),onPointerDown:h=>{var p;(p=e.onPointerDown)==null||p.call(e,h),d.current=!0},onPointerUp:pt(e.onPointerUp,h=>{var p;d.current||(p=h.currentTarget)==null||p.click()}),onKeyDown:pt(e.onKeyDown,h=>{const p=l.searchRef.current!=="";r||p&&h.key===" "||E2.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})}))});A1.displayName=lw;var FU=x.forwardRef((e,t)=>{const g=e,{__scopeMenu:r,disabled:n=!1,textValue:a}=g,i=me(g,["__scopeMenu","disabled","textValue"]),o=AT(lw,r),l=OU(r),c=x.useRef(null),d=cr(t,c),[u,f]=x.useState(!1),[h,p]=x.useState("");return x.useEffect(()=>{var y;const v=c.current;v&&p(((y=v.textContent)!=null?y:"").trim())},[i.children]),s.jsx(zv.ItemSlot,{scope:r,disabled:n,textValue:a!=null?a:h,children:s.jsx(f8,H(M({asChild:!0},l),{focusable:!n,children:s.jsx(Ct.div,H(M({role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0},i),{ref:d,onPointerMove:pt(e.onPointerMove,Bv(v=>{n?o.onItemLeave(v):(o.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:pt(e.onPointerLeave,Bv(v=>o.onItemLeave(v))),onFocus:pt(e.onFocus,()=>f(!0)),onBlur:pt(e.onBlur,()=>f(!1))}))}))})}),efe="MenuCheckboxItem",zU=x.forwardRef((e,t)=>{const i=e,{checked:r=!1,onCheckedChange:n}=i,a=me(i,["checked","onCheckedChange"]);return s.jsx(WU,{scope:e.__scopeMenu,checked:r,children:s.jsx(A1,H(M({role:"menuitemcheckbox","aria-checked":cw(r)?"mixed":r},a),{ref:t,"data-state":DT(r),onSelect:pt(a.onSelect,()=>n==null?void 0:n(cw(r)?!0:!r),{checkForDefaultPrevented:!1})}))})});zU.displayName=efe;var BU="MenuRadioGroup",[tfe,rfe]=Eh(BU,{value:void 0,onValueChange:()=>{}}),UU=x.forwardRef((e,t)=>{const o=e,{value:r,onValueChange:n}=o,a=me(o,["value","onValueChange"]),i=gs(n);return s.jsx(tfe,{scope:e.__scopeMenu,value:r,onValueChange:i,children:s.jsx(OT,H(M({},a),{ref:t}))})});UU.displayName=BU;var qU="MenuRadioItem",VU=x.forwardRef((e,t)=>{const o=e,{value:r}=o,n=me(o,["value"]),a=rfe(qU,e.__scopeMenu),i=r===a.value;return s.jsx(WU,{scope:e.__scopeMenu,checked:i,children:s.jsx(A1,H(M({role:"menuitemradio","aria-checked":i},n),{ref:t,"data-state":DT(i),onSelect:pt(n.onSelect,()=>{var l;return(l=a.onValueChange)==null?void 0:l.call(a,r)},{checkForDefaultPrevented:!1})}))})});VU.displayName=qU;var MT="MenuItemIndicator",[WU,nfe]=Eh(MT,{checked:!1}),HU=x.forwardRef((e,t)=>{const o=e,{__scopeMenu:r,forceMount:n}=o,a=me(o,["__scopeMenu","forceMount"]),i=nfe(MT,r);return s.jsx(Ys,{present:n||cw(i.checked)||i.checked===!0,children:s.jsx(Ct.span,H(M({},a),{ref:t,"data-state":DT(i.checked)}))})});HU.displayName=MT;var sfe="MenuSeparator",GU=x.forwardRef((e,t)=>{const a=e,{__scopeMenu:r}=a,n=me(a,["__scopeMenu"]);return s.jsx(Ct.div,H(M({role:"separator","aria-orientation":"horizontal"},n),{ref:t}))});GU.displayName=sfe;var afe="MenuArrow",YU=x.forwardRef((e,t)=>{const i=e,{__scopeMenu:r}=i,n=me(i,["__scopeMenu"]),a=T1(r);return s.jsx(qb,H(M(M({},a),n),{ref:t}))});YU.displayName=afe;var ife="MenuSub",[RBe,KU]=Eh(ife),$g="MenuSubTrigger",ZU=x.forwardRef((e,t)=>{const r=Ch($g,e.__scopeMenu),n=ex($g,e.__scopeMenu),a=KU($g,e.__scopeMenu),i=AT($g,e.__scopeMenu),o=x.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,d={__scopeMenu:e.__scopeMenu},u=x.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return x.useEffect(()=>u,[u]),x.useEffect(()=>{const f=l.current;return()=>{window.clearTimeout(f),c(null)}},[l,c]),s.jsx(PT,H(M({asChild:!0},d),{children:s.jsx(FU,H(M({id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":QU(r.open)},e),{ref:Tc(t,a.onTriggerChange),onClick:f=>{var h;(h=e.onClick)==null||h.call(e,f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:pt(e.onPointerMove,Bv(f=>{i.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!r.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:pt(e.onPointerLeave,Bv(f=>{var p,g;u();const h=(p=r.content)==null?void 0:p.getBoundingClientRect();if(h){const v=(g=r.content)==null?void 0:g.dataset.side,y=v==="right",_=y?-5:5,w=h[y?"left":"right"],b=h[y?"right":"left"];i.onPointerGraceIntentChange({area:[{x:f.clientX+_,y:f.clientY},{x:w,y:h.top},{x:b,y:h.top},{x:b,y:h.bottom},{x:w,y:h.bottom}],side:v}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:pt(e.onKeyDown,f=>{var p;const h=i.searchRef.current!=="";e.disabled||h&&f.key===" "||zhe[n.dir].includes(f.key)&&(r.onOpenChange(!0),(p=r.content)==null||p.focus(),f.preventDefault())})}))}))});ZU.displayName=$g;var XU="MenuSubContent",JU=x.forwardRef((e,t)=>{const r=DU(ao,e.__scopeMenu),u=e,{forceMount:n=r.forceMount}=u,a=me(u,["forceMount"]),i=Ch(ao,e.__scopeMenu),o=ex(ao,e.__scopeMenu),l=KU(XU,e.__scopeMenu),c=x.useRef(null),d=cr(t,c);return s.jsx(zv.Provider,{scope:e.__scopeMenu,children:s.jsx(Ys,{present:n||i.open,children:s.jsx(zv.Slot,{scope:e.__scopeMenu,children:s.jsx(RT,H(M({id:l.contentId,"aria-labelledby":l.triggerId},a),{ref:d,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:pt(e.onFocusOutside,f=>{f.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:pt(e.onEscapeKeyDown,f=>{o.onClose(),f.preventDefault()}),onKeyDown:pt(e.onKeyDown,f=>{var g;const h=f.currentTarget.contains(f.target),p=Bhe[o.dir].includes(f.key);h&&p&&(i.onOpenChange(!1),(g=l.trigger)==null||g.focus(),f.preventDefault())})}))})})})});JU.displayName=XU;function QU(e){return e?"open":"closed"}function cw(e){return e==="indeterminate"}function DT(e){return cw(e)?"indeterminate":e?"checked":"unchecked"}function ofe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function lfe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function cfe(e,t,r){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=lfe(e,Math.max(i,0));a.length===1&&(o=o.filter(d=>d!==r));const c=o.find(d=>d.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function dfe(e,t){const{x:r,y:n}=e;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],c=t[o],d=l.x,u=l.y,f=c.x,h=c.y;u>n!=h>n&&r<(f-d)*(n-u)/(h-u)+d&&(a=!a)}return a}function ufe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return dfe(r,t)}function Bv(e){return t=>t.pointerType==="mouse"?e(t):void 0}var hfe=MU,ffe=PT,mfe=IU,pfe=$U,gfe=OT,vfe=LU,yfe=A1,xfe=zU,_fe=UU,wfe=VU,bfe=HU,jfe=GU,Nfe=YU,Sfe=ZU,kfe=JU,R1="DropdownMenu",[Efe,OBe]=Os(R1,[RU]),Ka=RU(),[Cfe,eq]=Efe(R1),tq=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:i,onOpenChange:o,modal:l=!0}=e,c=Ka(t),d=x.useRef(null),[u,f]=Wa({prop:a,defaultProp:i!=null?i:!1,onChange:o,caller:R1});return s.jsx(Cfe,{scope:t,triggerId:Ps(),triggerRef:d,contentId:Ps(),open:u,onOpenChange:f,onOpenToggle:x.useCallback(()=>f(h=>!h),[f]),modal:l,children:s.jsx(hfe,H(M({},c),{open:u,onOpenChange:f,dir:n,modal:l,children:r}))})};tq.displayName=R1;var rq="DropdownMenuTrigger",nq=x.forwardRef((e,t)=>{const l=e,{__scopeDropdownMenu:r,disabled:n=!1}=l,a=me(l,["__scopeDropdownMenu","disabled"]),i=eq(rq,r),o=Ka(r);return s.jsx(ffe,H(M({asChild:!0},o),{children:s.jsx(Ct.button,H(M({type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n},a),{ref:Tc(t,i.triggerRef),onPointerDown:pt(e.onPointerDown,c=>{!n&&c.button===0&&c.ctrlKey===!1&&(i.onOpenToggle(),i.open||c.preventDefault())}),onKeyDown:pt(e.onKeyDown,c=>{n||(["Enter"," "].includes(c.key)&&i.onOpenToggle(),c.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(c.key)&&c.preventDefault())})}))}))});nq.displayName=rq;var Pfe="DropdownMenuPortal",sq=e=>{const a=e,{__scopeDropdownMenu:t}=a,r=me(a,["__scopeDropdownMenu"]),n=Ka(t);return s.jsx(mfe,M(M({},n),r))};sq.displayName=Pfe;var aq="DropdownMenuContent",iq=x.forwardRef((e,t)=>{const l=e,{__scopeDropdownMenu:r}=l,n=me(l,["__scopeDropdownMenu"]),a=eq(aq,r),i=Ka(r),o=x.useRef(!1);return s.jsx(pfe,H(M(M({id:a.contentId,"aria-labelledby":a.triggerId},i),n),{ref:t,onCloseAutoFocus:pt(e.onCloseAutoFocus,c=>{var d;o.current||(d=a.triggerRef.current)==null||d.focus(),o.current=!1,c.preventDefault()}),onInteractOutside:pt(e.onInteractOutside,c=>{const d=c.detail.originalEvent,u=d.button===0&&d.ctrlKey===!0,f=d.button===2||u;(!a.modal||f)&&(o.current=!0)}),style:H(M({},e.style),{"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))});iq.displayName=aq;var Tfe="DropdownMenuGroup",Afe=x.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=me(i,["__scopeDropdownMenu"]),a=Ka(r);return s.jsx(gfe,H(M(M({},a),n),{ref:t}))});Afe.displayName=Tfe;var Rfe="DropdownMenuLabel",oq=x.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=me(i,["__scopeDropdownMenu"]),a=Ka(r);return s.jsx(vfe,H(M(M({},a),n),{ref:t}))});oq.displayName=Rfe;var Ofe="DropdownMenuItem",lq=x.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=me(i,["__scopeDropdownMenu"]),a=Ka(r);return s.jsx(yfe,H(M(M({},a),n),{ref:t}))});lq.displayName=Ofe;var Mfe="DropdownMenuCheckboxItem",cq=x.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=me(i,["__scopeDropdownMenu"]),a=Ka(r);return s.jsx(xfe,H(M(M({},a),n),{ref:t}))});cq.displayName=Mfe;var Dfe="DropdownMenuRadioGroup",Ife=x.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=me(i,["__scopeDropdownMenu"]),a=Ka(r);return s.jsx(_fe,H(M(M({},a),n),{ref:t}))});Ife.displayName=Dfe;var $fe="DropdownMenuRadioItem",dq=x.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=me(i,["__scopeDropdownMenu"]),a=Ka(r);return s.jsx(wfe,H(M(M({},a),n),{ref:t}))});dq.displayName=$fe;var Lfe="DropdownMenuItemIndicator",uq=x.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=me(i,["__scopeDropdownMenu"]),a=Ka(r);return s.jsx(bfe,H(M(M({},a),n),{ref:t}))});uq.displayName=Lfe;var Ffe="DropdownMenuSeparator",hq=x.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=me(i,["__scopeDropdownMenu"]),a=Ka(r);return s.jsx(jfe,H(M(M({},a),n),{ref:t}))});hq.displayName=Ffe;var zfe="DropdownMenuArrow",Bfe=x.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=me(i,["__scopeDropdownMenu"]),a=Ka(r);return s.jsx(Nfe,H(M(M({},a),n),{ref:t}))});Bfe.displayName=zfe;var Ufe="DropdownMenuSubTrigger",fq=x.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=me(i,["__scopeDropdownMenu"]),a=Ka(r);return s.jsx(Sfe,H(M(M({},a),n),{ref:t}))});fq.displayName=Ufe;var qfe="DropdownMenuSubContent",mq=x.forwardRef((e,t)=>{const i=e,{__scopeDropdownMenu:r}=i,n=me(i,["__scopeDropdownMenu"]),a=Ka(r);return s.jsx(kfe,H(M(M({},a),n),{ref:t,style:H(M({},e.style),{"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))});mq.displayName=qfe;var Vfe=tq,Wfe=nq,Hfe=sq,pq=iq,gq=oq,vq=lq,yq=cq,xq=dq,_q=uq,wq=hq,bq=fq,jq=mq;const O1=Vfe,M1=Wfe,Gfe=x.forwardRef((i,a)=>{var o=i,{className:e,inset:t,children:r}=o,n=me(o,["className","inset","children"]);return s.jsxs(bq,H(M({ref:a,className:ke("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e)},n),{children:[r,s.jsx(Dy,{className:"ml-auto h-4 w-4"})]}))});Gfe.displayName=bq.displayName;const Yfe=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(jq,M({ref:r,className:ke("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e)},t))});Yfe.displayName=jq.displayName;const tx=x.forwardRef((a,n)=>{var i=a,{className:e,sideOffset:t=4}=i,r=me(i,["className","sideOffset"]);return s.jsx(Hfe,{children:s.jsx(pq,M({ref:n,sideOffset:t,className:ke("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e)},r))})});tx.displayName=pq.displayName;const Hi=x.forwardRef((a,n)=>{var i=a,{className:e,inset:t}=i,r=me(i,["className","inset"]);return s.jsx(vq,M({ref:n,className:ke("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e)},r))});Hi.displayName=vq.displayName;const Kfe=x.forwardRef((i,a)=>{var o=i,{className:e,children:t,checked:r}=o,n=me(o,["className","children","checked"]);return s.jsxs(yq,H(M({ref:a,className:ke("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r},n),{children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(_q,{children:s.jsx(ta,{className:"h-4 w-4"})})}),t]}))});Kfe.displayName=yq.displayName;const Zfe=x.forwardRef((a,n)=>{var i=a,{className:e,children:t}=i,r=me(i,["className","children"]);return s.jsxs(xq,H(M({ref:n,className:ke("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e)},r),{children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(_q,{children:s.jsx(SF,{className:"h-2 w-2 fill-current"})})}),t]}))});Zfe.displayName=xq.displayName;const Xfe=x.forwardRef((a,n)=>{var i=a,{className:e,inset:t}=i,r=me(i,["className","inset"]);return s.jsx(gq,M({ref:n,className:ke("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e)},r))});Xfe.displayName=gq.displayName;const d_=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(wq,M({ref:r,className:ke("-mx-1 my-1 h-px bg-muted",e)},t))});d_.displayName=wq.displayName;class Au{static getFriends(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_relationships").select("id, user_id, related_user_id, created_at").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`).order("created_at",{ascending:!1});if(n)return console.error("Error fetching friends:",n),[];if(!r||r.length===0)return[];const a=new Set;r.forEach(d=>{const u=d.user_id===t?d.related_user_id:d.user_id;u&&u!==t&&a.add(String(u))});const i=Array.from(a);if(i.length===0)return[];const{data:o,error:l}=yield T.from("users").select("id, name, avatar_url, bio, user_id, created_at").in("user_id",i);if(l)return console.error("Error fetching friend profiles:",l),[];const c=new Map;return r.forEach(d=>{const u=d.user_id===t?String(d.related_user_id):String(d.user_id);if(c.has(u)||u===t)return;const f=o==null?void 0:o.find(h=>String(h.user_id)===u);c.set(u,{id:(f==null?void 0:f.id)||u,user_id:u,name:(f==null?void 0:f.name)||"Unknown User",username:((f==null?void 0:f.name)||"unknown").toLowerCase().replace(/\s+/g,""),avatar_url:(f==null?void 0:f.avatar_url)||null,bio:(f==null?void 0:f.bio)||null,friendship_id:d.id,created_at:d.created_at})}),Array.from(c.values())}catch(r){return console.error("Error getting friends:",r),[]}})}static unfriendUser(t){return E(this,null,function*(){var r,n;try{const{error:a}=yield T.rpc("unfriend_user",{friend_user_id:t});if(a){if((r=a.message)!=null&&r.includes("Friendship does not exist")||a.code==="P0001"){console.log("Friendship already removed or does not exist:",t);return}throw console.error("Error unfriending user:",a),a}}catch(a){if((n=a==null?void 0:a.message)!=null&&n.includes("Friendship does not exist")||(a==null?void 0:a.code)==="P0001"){console.log("Friendship already removed or does not exist:",t);return}throw console.error("Error in unfriendUser:",a),a}})}static cancelFriendRequest(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("cancel_friend_request",{request_id:t});if(r)throw console.error("Error cancelling friend request:",r),r}catch(r){throw console.error("Error in cancelFriendRequest:",r),r}})}static getPendingRequestId(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("user_relationships").select("id").eq("user_id",t).eq("related_user_id",r).eq("relationship_type","friend").eq("status","pending").single();return a?(a.code==="PGRST116"||console.error("Error getting pending request ID:",a),null):(n==null?void 0:n.id)||null}catch(n){return console.error("Error in getPendingRequestId:",n),null}})}static getRecommendedFriends(t,r=10){return E(this,null,function*(){try{const[n,a]=yield Promise.all([T.rpc("get_second_degree_connections",{target_user_id:t}),T.rpc("get_third_degree_connections",{target_user_id:t})]);n.error&&console.error("Error fetching second degree connections:",n.error),a.error&&console.error("Error fetching third degree connections:",a.error);const i=n.data||[],o=a.data||[],l=[];return i.forEach(d=>{l.push({user_id:d.connected_user_id,name:d.name||"Unknown User",avatar_url:d.avatar_url||null,verified:d.is_public_profile!==!1,connection_depth:2,mutual_friends_count:d.mutual_friends_count||0})}),o.forEach(d=>{l.push({user_id:d.connected_user_id,name:d.name||"Unknown User",avatar_url:d.avatar_url||null,verified:d.is_public_profile!==!1,connection_depth:3,mutual_friends_count:d.mutual_friends_count||0})}),l.sort((d,u)=>d.mutual_friends_count!==u.mutual_friends_count?u.mutual_friends_count-d.mutual_friends_count:d.connection_depth-u.connection_depth),Array.from(new Map(l.map(d=>[d.user_id,d])).values()).slice(0,r)}catch(n){return console.error("Error getting recommended friends:",n),[]}})}}const Yo=({menuOpen:e=!1,onMenuClick:t,children:r})=>s.jsx("header",{className:"mobile-header",role:"banner",children:s.jsxs("div",{className:"mobile-header__container",children:[s.jsx("div",{className:"mobile-header__center",children:r}),s.jsx("button",{className:"mobile-header__menu-button",onClick:t,"aria-label":e?"Close menu":"Open menu","aria-expanded":e,type:"button",children:e?s.jsx(Se,{name:"x",size:24,alt:""}):s.jsx(Se,{name:"hamburgerMenu",size:24,alt:""})})]})});function Jfe({eventId:e,customMessage:t,onEventClick:r,onInterestToggle:n,onAttendanceToggle:a,currentUserId:i,className:o="",refreshTrigger:l}){const[c,d]=x.useState(null),[u,f]=x.useState(!0),[h,p]=x.useState(!1),[g,v]=x.useState(!1),[y,_]=x.useState(!1),[w,b]=x.useState(!1);x.useEffect(()=>{k()},[e]),x.useEffect(()=>{c&&i&&(N(),S())},[c,i]),x.useEffect(()=>{l&&c&&i&&(N(),S())},[l,c,i]);const N=()=>E(this,null,function*(){if(!(!c||!i))try{console.log(" checkInterest called with:",{eventId:c.id,currentUserId:i});const O=yield Qr.isUserInterested(i,c.id);console.log(" checkInterest result:",{interested:O}),p(O)}catch(O){console.log(" checkInterest error:",O),p(!1)}}),S=()=>E(this,null,function*(){if(!(!c||!i))try{const{data:O,error:z}=yield T.from("reviews").select("was_there").eq("user_id",i).eq("event_id",c.id).maybeSingle();if(z){if(z.code==="PGRST116"||z.code==="406"){_(!1);return}console.error("Error checking attendance:",z),_(!1);return}_(O?!!O.was_there:!1)}catch(O){console.error("Error checking attendance:",O),_(!1)}}),k=()=>E(this,null,function*(){try{f(!0);const{data:O,error:z}=yield T.from("events").select("*").eq("id",e).single();if(z){console.error("Error loading shared event:",z);return}d(O)}catch(O){console.error("Error loading shared event:",O)}finally{f(!1)}}),P=O=>{try{return Mt(ms(O),"EEE, MMM d, yyyy")}catch(z){return O}},A=O=>{try{return Mt(ms(O),"h:mm a")}catch(z){return""}},R=c?new Date(c.event_date)<new Date:!1,$=c?new Date(c.event_date)>=new Date:!1;return u?s.jsx(He,{className:`p-4 bg-gradient-to-r from-pink-50 to-purple-50 border-pink-200 animate-pulse ${o}`,children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-pink-200 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-pink-200 rounded w-1/2"}),s.jsx("div",{className:"h-3 bg-pink-200 rounded w-2/3"})]})}):c?s.jsxs(He,{className:`overflow-hidden bg-gradient-to-br from-white via-pink-50/30 to-purple-50/30 border-2 border-pink-200 hover:border-pink-300 transition-all duration-200 hover:shadow-lg cursor-pointer ${o}`,onClick:()=>r==null?void 0:r(c),children:[s.jsxs("div",{className:"bg-gradient-to-r from-pink-500 to-purple-600 p-3 flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:s.jsx($t,{className:"w-5 h-5 text-white"})}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-white text-xs font-medium",children:"Shared Event"})}),$&&s.jsx(Ke,{className:"bg-green-500 text-white text-xs",children:"Upcoming"}),R&&s.jsx(Ke,{variant:"secondary",className:"text-xs",children:"Past Event"})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[t&&s.jsx("div",{className:"bg-white/80 rounded-lg p-3 border border-pink-200",children:s.jsxs("p",{className:"text-sm text-gray-700 italic",children:['"',t,'"']})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-gray-900 leading-tight mb-1",children:c.title}),s.jsx("p",{className:"text-pink-600 font-semibold text-sm",children:c.artist_name})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[s.jsx(It,{className:"w-4 h-4 text-pink-500"}),s.jsx("span",{className:"font-medium",children:P(c.event_date)}),s.jsx("span",{className:"text-gray-400",children:""}),s.jsx("span",{children:A(c.event_date)})]}),s.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-700",children:[s.jsx(gr,{className:"w-4 h-4 text-pink-500 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:c.venue_name}),s.jsx("p",{className:"text-xs text-gray-500",children:[c.venue_city,c.venue_state].filter(Boolean).join(", ")})]})]}),c.genres&&c.genres.length>0&&s.jsxs("div",{className:"flex flex-wrap gap-1",children:[c.genres.slice(0,3).map((O,z)=>s.jsx(Ke,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:O},z)),c.genres.length>3&&s.jsxs(Ke,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:["+",c.genres.length-3]})]}),c.price_range&&s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Price: "}),s.jsx("span",{className:"font-semibold text-gray-900",children:c.price_range})]}),s.jsxs("div",{className:"pt-2 border-t border-pink-100 flex gap-2",children:[$&&i&&n&&s.jsxs(le,{size:"sm",disabled:g,className:`flex-1 ${h?"bg-green-500 hover:bg-green-600":"bg-pink-500 hover:bg-pink-600"} text-white`,onClick:O=>E(this,null,function*(){O.stopPropagation(),v(!0);try{const z=!h;console.log(" Interest button clicked:",{eventId:c.id,newInterestState:z,currentUserId:i}),yield n(c.id,z),p(z)}catch(z){console.error("Error toggling interest:",z)}finally{v(!1)}}),children:[s.jsx(ns,{className:`w-3 h-3 mr-1 ${h?"fill-current":""}`}),h?"Interested!":"I'm Interested"]}),R&&i&&a&&s.jsxs(le,{size:"sm",disabled:w,className:`flex-1 ${y?"bg-blue-500 hover:bg-blue-600":"bg-yellow-500 hover:bg-yellow-600"} text-white`,onClick:O=>E(this,null,function*(){O.stopPropagation(),b(!0);try{const z=!y;yield a(c.id,z),_(z)}catch(z){console.error("Error toggling attendance:",z)}finally{b(!1)}}),children:[w?s.jsx("div",{className:"w-3 h-3 mr-1 animate-spin rounded-full border-b-2 border-white"}):s.jsx(Qt,{className:`w-3 h-3 mr-1 ${y?"fill-current":""}`}),w?"Updating...":y?"I Was There!":"I Was There"]}),c.ticket_urls&&c.ticket_urls.length>0&&$&&s.jsx(le,{size:"sm",variant:"outline",className:"flex-1 border-blue-300 text-blue-700 hover:bg-blue-50",asChild:!0,onClick:O=>O.stopPropagation(),children:s.jsxs("a",{href:c.ticket_urls[0],target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-1",children:[s.jsx(Ml,{className:"w-3 h-3"}),"Tickets",s.jsx(Bo,{className:"w-3 h-3"})]})})]}),s.jsx(le,{variant:"ghost",size:"sm",className:"w-full text-pink-600 hover:text-pink-700 hover:bg-pink-50",onClick:()=>r==null?void 0:r(c),children:"View Full Details "})]})]}):s.jsx(He,{className:`p-4 bg-gray-50 border-gray-200 ${o}`,children:s.jsx("p",{className:"text-sm text-gray-500",children:"Event not found"})})}function Qfe({reviewId:e,customMessage:t,onReviewClick:r,currentUserId:n,className:a="",metadata:i}){const[o,l]=x.useState(null),[c,d]=x.useState(!0),[u,f]=x.useState("User"),[h,p]=x.useState(null);x.useEffect(()=>{g()},[e]);const g=()=>E(this,null,function*(){try{d(!0);const{data:w,error:b}=yield T.from("reviews").select(`
          id,
          user_id,
          event_id,
          rating,
          review_text,
          photos,
          created_at,
          updated_at,
          likes_count,
          comments_count,
          shares_count
        `).eq("id",e).single();if(b){console.error("Error loading review:",b),d(!1);return}if(!w){d(!1);return}let N="User",S=null;if(w.user_id){const{data:$}=yield T.from("users").select("user_id, name, avatar_url").eq("user_id",w.user_id).single();$&&(N=$.name||"User",S=$.avatar_url||null)}let k="",P="",A="";if(w.event_id){const{data:$}=yield T.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date").eq("id",w.event_id).single();$&&(k=$.artist_name_normalized||"",P=$.venue_name_normalized||"",A=$.title||"")}const R={id:w.id,user_id:w.user_id,event_id:w.event_id||"",rating:w.rating||0,review_text:w.review_text||"",is_public:!0,created_at:w.created_at,updated_at:w.updated_at||w.created_at,likes_count:w.likes_count||0,comments_count:w.comments_count||0,shares_count:w.shares_count||0,is_liked_by_user:!1,reaction_emoji:"",photos:Array.isArray(w.photos)?w.photos:[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:k,artist_id:"",venue_name:P,venue_id:""};l(R),f(N),p(S)}catch(w){console.error("Error loading review:",w)}finally{d(!1)}});if(c)return s.jsx(He,{className:`p-4 bg-gradient-to-r from-pink-50 to-purple-50 border-pink-200 animate-pulse ${a}`,children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-pink-200 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-pink-200 rounded w-1/2"}),s.jsx("div",{className:"h-3 bg-pink-200 rounded w-2/3"})]})});if(!o)return s.jsx(He,{className:`p-4 bg-gray-50 border-gray-200 ${a}`,children:s.jsx("p",{className:"text-sm text-gray-500",children:"Review not found"})});const v=o.artist_name&&o.venue_name?`${o.artist_name} at ${o.venue_name}`:o.artist_name||o.venue_name||"Concert Review",y=o.review_text?o.review_text.length>100?o.review_text.substring(0,100)+"...":o.review_text:"No review text",_=o.created_at?Mt(ms(o.created_at),"MMM d, yyyy"):"";return s.jsxs(He,{className:`overflow-hidden bg-gradient-to-br from-white via-pink-50/30 to-purple-50/30 border-2 border-pink-200 hover:border-pink-300 transition-all duration-200 hover:shadow-lg cursor-pointer ${a}`,onClick:()=>r==null?void 0:r(o),children:[s.jsxs("div",{className:"bg-gradient-to-r from-pink-500 to-purple-600 p-3 flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:s.jsx(Qt,{className:"w-5 h-5 text-white fill-white"})}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-white text-xs font-medium",children:"Shared Review"})})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[t&&s.jsx("div",{className:"bg-white/80 rounded-lg p-3 border border-pink-200",children:s.jsx("p",{className:"text-sm text-gray-700",children:t})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-pink-400 to-purple-500 flex items-center justify-center text-white text-xs font-semibold overflow-hidden",children:h?s.jsx("img",{src:h,alt:u,className:"w-full h-full object-cover"}):s.jsx(Rs,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:u}),_&&s.jsx("p",{className:"text-xs text-gray-500",children:_})]})]}),s.jsx("div",{children:s.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-1",children:v})}),o.rating>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(w,b)=>{const N=b+1,S=N<=Math.floor(o.rating||0),k=!S&&N-.5<=(o.rating||0);return s.jsxs("div",{className:"relative w-4 h-4",children:[s.jsx(Qt,{className:`w-4 h-4 ${S||k?"text-yellow-400 fill-yellow-400":"text-gray-300"}`}),k&&s.jsx("div",{className:"absolute left-0 top-0 h-full w-1/2 overflow-hidden pointer-events-none",children:s.jsx(Qt,{className:"w-4 h-4 text-yellow-400 fill-yellow-400"})})]},b)})}),s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[o.rating,"/5"]})]}),s.jsx("div",{className:"bg-white/60 rounded-lg p-3 border border-pink-100",children:s.jsx("p",{className:"text-sm text-gray-700 line-clamp-3",children:y})}),(o.artist_name||o.venue_name)&&s.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-gray-600",children:[o.artist_name&&s.jsxs(Ke,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:[s.jsx($t,{className:"w-3 h-3 mr-1"}),o.artist_name]}),o.venue_name&&s.jsxs(Ke,{variant:"secondary",className:"bg-blue-100 text-blue-800 border-blue-200",children:[s.jsx(gr,{className:"w-3 h-3 mr-1"}),o.venue_name]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 pt-2 border-t border-pink-100",children:[s.jsxs("span",{children:[o.likes_count||0," likes"]}),s.jsxs("span",{children:[o.comments_count||0," comments"]})]})]})]})}const Nq=({currentUserId:e,onBack:t,menuOpen:r=!1,onMenuClick:n,hideHeader:a=!1})=>{var lt,Qe,jt,ir,rr,Ie,At,yt;const[i,o]=x.useState([]),[l,c]=x.useState(null),[d,u]=x.useState([]),[f,h]=x.useState(""),[p,g]=x.useState([]),[v,y]=x.useState(!1),[_,w]=x.useState(new Map),[b,N]=x.useState(!1),[S,k]=x.useState(""),[P,A]=x.useState([]);x.useState("");const[R,$]=x.useState(!0);x.useState(!1),x.useState("");const{toast:O}=Rr(),[z,D]=x.useState(!1),[B,F]=x.useState(null),[U,G]=x.useState(!1),[q,K]=x.useState(0),[Z,Y]=x.useState(!1),[Q,X]=x.useState(null),[ne,re]=x.useState(!1),[ye,ee]=x.useState(null),[de,xe]=x.useState(new Set);x.useState(!1);const[ie,se]=x.useState([]),[V,ue]=x.useState(!1),[_e,ae]=x.useState(null),[we,oe]=x.useState(!1),ce=x.useRef(null);x.useEffect(()=>{We(),Ue()},[e]),x.useEffect(()=>{console.log(" users changed:",p),console.log(" users length:",p.length)},[p]),x.useEffect(()=>{console.log(" selectedChat changed:",l),console.log(" selectedChat exists:",!!l),console.log(" selectedChat id:",l==null?void 0:l.id)},[l]),x.useEffect(()=>{l&&(at(l.id),Me(l.id),ze(l.id),Fe(l.id))},[l]),x.useEffect(()=>{if(!l)return;const pe=T.channel(`chat-messages-${l.id}`).on("postgres_changes",{event:"*",schema:"public",table:"messages",filter:`chat_id=eq.${l.id}`},De=>{console.log(" Real-time message update:",De),(De.eventType==="INSERT"||De.eventType==="UPDATE"||De.eventType==="DELETE")&&(at(l.id),We())}).subscribe(De=>{De==="SUBSCRIBED"?console.log(" Subscribed to messages for chat:",l.id):De==="CHANNEL_ERROR"&&console.error(" Error subscribing to messages")});return()=>{T.removeChannel(pe)}},[l==null?void 0:l.id]),x.useEffect(()=>{if(!e)return;const pe=T.channel("chat-list-updates").on("postgres_changes",{event:"*",schema:"public",table:"chats"},De=>{console.log(" Real-time chat update:",De);const Le=De.new,bt=De.old,it=(Le==null?void 0:Le.users)||(bt==null?void 0:bt.users)||[];Array.isArray(it)&&it.includes(e)&&We()}).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},De=>{console.log(" New message in any chat:",De),We()}).subscribe(De=>{De==="SUBSCRIBED"?console.log(" Subscribed to chat list updates"):De==="CHANNEL_ERROR"&&console.error(" Error subscribing to chat list")});return()=>{T.removeChannel(pe)}},[e]),x.useEffect(()=>{v&&Ue()},[v]);const Ae=pe=>E(void 0,null,function*(){F(pe);try{const De=yield Qr.isUserInterested(e,pe.id);G(De)}catch(De){console.error("Error checking interest:",De),G(!1)}D(!0)}),Be=(pe,De)=>E(void 0,null,function*(){try{yield Qr.setEventInterest(e,pe,De),G(De),K(Le=>Le+1),O({title:De?"Added to interested events!":"Removed from interested events",description:De?"This event will appear in your profile":"Event removed from your interested list"})}catch(Le){console.error("Error toggling interest:",Le),O({title:"Error",description:"Failed to update interest",variant:"destructive"})}}),Xe=pe=>E(void 0,null,function*(){let De="User",Le;if(pe.user_id)try{const{data:it,error:zt}=yield T.from("users").select("user_id, name, avatar_url").eq("user_id",pe.user_id).maybeSingle();!zt&&it&&(De=it.name||"User",Le=it.avatar_url||void 0)}catch(it){console.error("Error fetching author information:",it)}const bt={id:pe.id,type:"review",review_id:pe.id,title:pe.artist_name&&pe.venue_name?`${pe.artist_name} at ${pe.venue_name}`:pe.artist_name||pe.venue_name||"Concert Review",content:pe.review_text||"",author:{id:pe.user_id,name:De,avatar_url:Le},created_at:pe.created_at,rating:pe.rating,photos:pe.photos||[],likes_count:pe.likes_count||0,comments_count:pe.comments_count||0,shares_count:pe.shares_count||0,is_liked:pe.is_liked_by_user||!1,event_info:{artist_name:pe.artist_name,venue_name:pe.venue_name,artist_id:pe.artist_id,venue_id:pe.venue_id},relevance_score:0};X(bt),Y(!0),re(!0),ee(null);try{const{data:it,error:zt}=yield T.from("reviews").select(`
            photos,
            videos,
            artist_performance_rating,
            production_rating,
            venue_rating,
            venue_rating,
            location_rating,
            value_rating,
            artist_performance_feedback,
            production_feedback,
            venue_feedback,
            location_feedback,
            value_feedback,
            mood_tags,
            genre_tags,
            context_tags,
            venue_tags,
            artist_tags,
            reaction_emoji,
            review_text
          `).eq("id",pe.id).maybeSingle();if(zt){console.error("Error fetching review details:",zt),ee(null),re(!1);return}it&&ee({photos:Array.isArray(it.photos)?it.photos:[],videos:Array.isArray(it.videos)?it.videos:[],categoryRatings:{performance:typeof it.performance_rating=="number"?it.performance_rating:void 0,venue:typeof it.venue_rating=="number"?it.venue_rating:void 0,overallExperience:typeof it.overall_experience_rating=="number"?it.overall_experience_rating:void 0},categoryTexts:{performance:it.performance_review_text||void 0,venue:it.venue_review_text||void 0,overallExperience:it.overall_experience_review_text||void 0},moodTags:Array.isArray(it.mood_tags)&&it.mood_tags.length>0?it.mood_tags:void 0,genreTags:Array.isArray(it.genre_tags)&&it.genre_tags.length>0?it.genre_tags:void 0,contextTags:Array.isArray(it.context_tags)&&it.context_tags.length>0?it.context_tags:void 0,venueTags:Array.isArray(it.venue_tags)&&it.venue_tags.length>0?it.venue_tags:void 0,artistTags:Array.isArray(it.artist_tags)&&it.artist_tags.length>0?it.artist_tags:void 0,reactionEmoji:it.reaction_emoji||void 0})}catch(it){console.error("Error fetching review details:",it),ee(null)}finally{re(!1)}}),ge=(pe,De)=>E(void 0,null,function*(){try{yield Qr.markUserAttendance(e,pe,De),O({title:De?"Marked as attended!":"Removed attendance",description:De?"This event will appear in your attended events":"Attendance removed"})}catch(Le){console.error("Error toggling attendance:",Le),O({title:"Error",description:"Failed to update attendance",variant:"destructive"})}}),We=()=>E(void 0,null,function*(){try{const{data:pe,error:De}=yield oT(e);if(De){console.error("Error fetching chats:",De);return}const{data:Le}=yield T.from("chat_participants").select("chat_id, last_read_at").eq("user_id",e),bt=new Map;Le==null||Le.forEach(fe=>{bt.set(fe.chat_id,fe.last_read_at)});const zt=(yield Promise.all((pe||[]).map(fe=>E(void 0,null,function*(){try{const Re=bt.get(fe.id),ot=T.from("messages").select("id").eq("chat_id",fe.id).neq("sender_id",e).limit(1);Re&&ot.gt("created_at",Re);const{data:vt}=yield ot.maybeSingle();return H(M({},fe),{has_unread:!!vt,unread_count:0})}catch(Re){return console.error("Error checking unread status for chat:",fe.id,Re),H(M({},fe),{has_unread:!1,unread_count:0})}})))).sort((fe,Re)=>{if(fe.has_unread&&!Re.has_unread)return-1;if(!fe.has_unread&&Re.has_unread)return 1;const ot=fe.latest_message_created_at?new Date(fe.latest_message_created_at).getTime():0;return(Re.latest_message_created_at?new Date(Re.latest_message_created_at).getTime():0)-ot}),Bt=zt.filter(fe=>fe.is_group_chat).map(fe=>fe.id),Te=new Map;if(console.log(" fetchChats: Group chat IDs:",Bt),Bt.length>0){const{data:fe,error:Re}=yield T.from("chats").select("id, entity_type, entity_uuid").in("id",Bt);console.log(" fetchChats: Chat entities:",fe,"Error:",Re);const ot=(fe==null?void 0:fe.filter(vt=>vt.entity_type==="event"&&vt.entity_uuid))||[];if(console.log(" fetchChats: Event chats:",ot),ot.length>0){const vt=ot.map(Ee=>Ee.entity_uuid).filter(Boolean);console.log(" fetchChats: Event IDs:",vt);const{data:ut,error:Pe}=yield T.from("events").select("id, artist_id").in("id",vt);console.log(" fetchChats: Events with artist_id:",ut,"Error:",Pe);const Ge=[...new Set(ut==null?void 0:ut.map(Ee=>Ee.artist_id).filter(Boolean))];if(console.log(" fetchChats: Artist UUIDs:",Ge),Ge.length>0){const{data:Ee,error:ft}=yield T.from("artists").select("id, image_url").in("id",Ge);if(console.log(" fetchChats: Artists fetched by UUID:",Ee,"Error:",ft),Ee&&Ee.length>0){const Pt=new Map;Ee.forEach(yr=>{yr.image_url&&yr.id&&(Pt.set(yr.id,yr.image_url),console.log(` Mapped artist UUID: ${yr.id} -> image_url: ${yr.image_url}`))}),console.log(" fetchChats: Artist image map:",Array.from(Pt.entries())),ut==null||ut.forEach(yr=>{const un=ot.find(hn=>hn.entity_uuid===yr.id);if(un&&yr.artist_id){const hn=Pt.get(yr.artist_id);console.log(` fetchChats: Mapping chat ${un.id} to artist image:`,{eventId:yr.id,artist_id:yr.artist_id,imageUrl:hn}),hn&&Te.set(un.id,{entity_type:un.entity_type,entity_uuid:un.entity_uuid,event_image_url:hn})}}),console.log(" fetchChats: Final entityDataMap:",Array.from(Te.entries()))}else console.log(" fetchChats: No artists found for UUIDs:",Ge)}}}const dt=zt.map(fe=>{var vt,ut,Pe,Ge,Ee,ft,Pt,yr,un,hn,xn,Rt,hr;const Re=fe,ot=Te.get(fe.id);return H(M({},fe),{latest_message_id:(vt=fe.latest_message_id)!=null?vt:null,latest_message:(ut=fe.latest_message)!=null?ut:null,latest_message_created_at:(Pe=fe.latest_message_created_at)!=null?Pe:null,latest_message_sender_name:(Ge=fe.latest_message_sender_name)!=null?Ge:null,group_admin_id:(Ee=fe.group_admin_id)!=null?Ee:null,member_count:(ft=Re.member_count)!=null?ft:null,entity_type:(yr=(Pt=ot==null?void 0:ot.entity_type)!=null?Pt:Re.entity_type)!=null?yr:null,entity_uuid:(hn=(un=ot==null?void 0:ot.entity_uuid)!=null?un:Re.entity_uuid)!=null?hn:null,event_image_url:(xn=ot==null?void 0:ot.event_image_url)!=null?xn:null,created_at:(Rt=fe.created_at)!=null?Rt:new Date().toISOString(),updated_at:(hr=fe.updated_at)!=null?hr:new Date().toISOString()})});o(dt);const mr=zt.filter(fe=>!fe.is_group_chat).map(fe=>fe.id);if(mr.length>0){const{data:fe,error:Re}=yield T.from("chat_participants").select("chat_id, user_id").in("chat_id",mr).neq("user_id",e);Re&&console.error("Error fetching chat participants for direct chats:",Re);const ot=new Map,vt=new Set;if(fe==null||fe.forEach(ut=>{ot.set(ut.chat_id,ut.user_id),vt.add(ut.user_id)}),w(ot),vt.size>0){const ut=Array.from(vt).filter(Pe=>!p.some(Ge=>Ge.user_id===Pe));if(ut.length>0){const{data:Pe}=yield T.from("users").select("user_id, name, avatar_url, bio").in("user_id",ut);Pe&&Pe.length>0&&g(Ge=>{const Ee=new Set(Ge.map(Pt=>Pt.user_id)),ft=Pe.filter(Pt=>!Ee.has(Pt.user_id));return[...Ge,...ft]})}}}const Mn=new Set;for(const fe of zt)fe.is_group_chat&&(yield qe(fe.id))&&Mn.add(fe.id);xe(Mn)}catch(pe){console.error("Error fetching chats:",pe)}finally{setTimeout(()=>{$(!1)},800)}}),Ue=()=>E(void 0,null,function*(){try{console.log(" Current user ID:",e),console.log(" User ID type:",typeof e);const pe=yield Au.getFriends(e);console.log(" Friends fetched successfully:",pe),console.log(" Number of friends:",pe.length),g(pe)}catch(pe){console.error("Error fetching friends:",pe),g([])}}),at=pe=>E(void 0,null,function*(){try{const{data:De,error:Le}=yield T.from("messages").select(`
          id,
          chat_id,
          sender_id,
          content,
          created_at,
          message_type,
          shared_event_id,
          shared_review_id,
          metadata
        `).eq("chat_id",pe).order("created_at",{ascending:!0});if(Le){console.error("Error fetching messages:",Le);return}const bt=[...new Set((De||[]).map(Bt=>Bt.sender_id))],{data:it}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",bt),zt=(De||[]).map(Bt=>{const Te=it==null?void 0:it.find(dt=>dt.user_id===Bt.sender_id);return{id:Bt.id,chat_id:Bt.chat_id,sender_id:Bt.sender_id,content:Bt.content,created_at:Bt.created_at,sender_name:(Te==null?void 0:Te.name)||"Unknown",sender_avatar:(Te==null?void 0:Te.avatar_url)||null,message_type:Bt.message_type||"text",shared_event_id:Bt.shared_event_id,shared_review_id:Bt.shared_review_id,metadata:Bt.metadata}});u(zt.map(Bt=>H(M({},Bt),{message_type:Bt.message_type==="text"||Bt.message_type==="event_share"||Bt.message_type==="review_share"||Bt.message_type==="system"?Bt.message_type:"text"}))),setTimeout(()=>{var Bt;(Bt=ce.current)==null||Bt.scrollIntoView({behavior:"smooth"})},100)}catch(De){console.error("Error fetching messages:",De)}});x.useEffect(()=>{d.length>0&&setTimeout(()=>{var pe;(pe=ce.current)==null||pe.scrollIntoView({behavior:"smooth"})},100)},[d.length]);const mt=()=>E(void 0,null,function*(){if(!f.trim()||!l)return;const pe=f.trim();h("");try{const{data:De,error:Le}=yield T.from("messages").insert({chat_id:l.id,sender_id:e,content:pe}).select().single();if(Le){console.error("Error sending message:",Le),h(pe),O({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"});return}at(l.id),O({title:"Message Sent! ",description:"Your message has been delivered"})}catch(De){console.error("Error sending message:",De),O({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"})}}),Ye=pe=>E(void 0,null,function*(){try{if(console.log("Creating direct chat between:",e,"and",pe),!p.some(it=>it.user_id===pe)){O({title:"Not Friends Yet",description:"You can only chat with people who have accepted your friend request.",variant:"destructive"});return}const{data:Le,error:bt}=yield T.rpc("create_direct_chat",{user1_id:e,user2_id:pe});if(bt){console.error("Error creating direct chat:",bt),O({title:"Error",description:"Failed to create chat. Please try again.",variant:"destructive"});return}We(),y(!1),O({title:"Chat Created! ",description:"You can now start chatting!"})}catch(De){console.error("Error creating direct chat:",De),O({title:"Error",description:"Failed to create chat. Please try again.",variant:"destructive"})}}),Ft=pe=>E(void 0,null,function*(){try{const{error:De}=yield T.from("chats").delete().eq("id",pe);if(De){console.error("Error deleting chat:",De),O({title:"Error",description:"Failed to delete chat. Please try again.",variant:"destructive"});return}o(Le=>Le.filter(bt=>bt.id!==pe)),(l==null?void 0:l.id)===pe&&(c(null),u([])),O({title:"Chat Deleted",description:"Chat has been removed."})}catch(De){console.error("Error deleting chat:",De),O({title:"Error",description:"Failed to delete chat. Please try again.",variant:"destructive"})}}),_t=p.filter(pe=>pe.name.toLowerCase().includes(S.toLowerCase())),Lt=pe=>{if(pe.is_group_chat)return"";const De=_.get(pe.id);return De||Array.isArray(pe.users)&&pe.users.find(Le=>Le!==e)||""},Oe=pe=>{if(pe.is_group_chat)return(pe.chat_name||"Group Chat").replace(/\s+Group\s+Chat\s*$/,"");const De=Lt(pe);if(!De)return pe.chat_name||"Unknown User";const Le=p.find(bt=>bt.user_id===De);return(Le==null?void 0:Le.name)||"Unknown User"},qe=pe=>E(void 0,null,function*(){return!1}),Ne=pe=>{if(pe.is_group_chat){const bt=pe.event_image_url;return console.log(" getChatAvatar for group chat:",{chatId:pe.id,chatName:pe.chat_name,event_image_url:bt,entity_type:pe.entity_type,entity_uuid:pe.entity_uuid}),bt||null}const De=Lt(pe);if(!De)return null;const Le=p.find(bt=>bt.user_id===De);return(Le==null?void 0:Le.avatar_url)||null},Fe=pe=>E(void 0,null,function*(){try{const{error:De}=yield T.rpc("mark_chat_as_read",{p_chat_id:pe});De&&console.error("Error updating last_read_at:",De),o(Le=>Le.map(bt=>bt.id===pe?H(M({},bt),{has_unread:!1,unread_count:0}):bt))}catch(De){console.error("Error marking chat as read:",De)}}),ve=pe=>{if(!pe)return"";const De=ms(pe),Le=new Date,bt=new Date(Le.getFullYear(),Le.getMonth(),Le.getDate()),it=new Date(bt);it.setDate(it.getDate()-1);const zt=new Date(De.getFullYear(),De.getMonth(),De.getDate());return zt.getTime()===bt.getTime()?Mt(De,"h:mm a"):zt.getTime()===it.getTime()?`Yesterday ${Mt(De,"h:mm a")}`:Math.floor((bt.getTime()-zt.getTime())/864e5)<7?`${Mt(De,"EEEE")} ${Mt(De,"h:mm a")}`:Mt(De,"MMM d, h:mm a")},Me=pe=>E(void 0,null,function*(){try{const{data:De,error:Le}=yield T.from("chat_participants").select(`
          id,
          user_id,
          joined_at,
          last_read_at,
          is_admin,
          notifications_enabled,
          users!user_id(
            user_id,
            name,
            avatar_url,
            bio,
            account_type
          )
        `).eq("chat_id",pe).order("joined_at",{ascending:!0});if(Le){console.error("Error fetching chat participants:",Le);return}if(!De||De.length===0){se([]);return}const bt=De.map(Bt=>Bt.user_id).filter(Boolean),it=new Map;if(bt.length>0){const{data:Bt}=yield T.from("user_verifications").select("user_id, verified").in("user_id",bt);Bt&&Bt.forEach(Te=>{it.set(Te.user_id,Te.verified||!1)})}const zt=De.map(Bt=>{const Te=Bt.users;if(!Te)return null;const dt=it.get(Bt.user_id)||!1;return{id:Bt.id,user_id:Bt.user_id,name:Te.name||"Unknown User",avatar_url:Te.avatar_url||null,bio:Te.bio||null,verified:dt,account_type:Te.account_type||null,joined_at:Bt.joined_at,last_read_at:Bt.last_read_at,is_admin:Bt.is_admin||!1,notifications_enabled:Bt.notifications_enabled!==!1}}).filter(Boolean);se(zt)}catch(De){console.error("Error fetching chat participants:",De)}}),ze=pe=>E(void 0,null,function*(){var De;try{const{data:Le,error:bt}=yield T.from("messages").select("shared_event_id, metadata").eq("chat_id",pe).eq("message_type","event_share").order("created_at",{ascending:!1}).limit(1).maybeSingle(),it=(Le==null?void 0:Le.shared_event_id)||((De=Le==null?void 0:Le.metadata)==null?void 0:De.event_id);if(!bt&&it){const{data:zt,error:Bt}=yield T.from("events_with_artist_venue").select("id, title, event_date, images, artist_name_normalized, venue_name_normalized").eq("id",it).maybeSingle();if(!Bt&&zt){ae(H(M({},zt),{artist_name:zt.artist_name_normalized,venue_name:zt.venue_name_normalized}));return}}}catch(Le){}}),ct=()=>{!l||!l.is_group_chat||(Me(l.id),oe(!0))},Et=pe=>{O({title:"View Profile",description:"Profile view functionality will be implemented soon"})},gt=pe=>{O({title:"Block User",description:"Block user functionality will be implemented soon"})},St=()=>{ue(!V),O({title:V?"Notifications Unmuted":"Notifications Muted",description:V?"You will receive notifications for this chat":"You will not receive notifications for this chat"})},dr=()=>{_e&&(F(_e),D(!0))},Sr=()=>E(void 0,null,function*(){if(!(!l||!window.confirm(`Are you sure you want to delete this ${l.is_group_chat?"group":"chat"}? This action cannot be undone.`)))try{const{error:De}=yield T.from("chats").delete().eq("id",l.id);if(De){console.error("Error deleting chat:",De),O({title:"Error",description:"Failed to delete chat",variant:"destructive"});return}c(null),We(),O({title:"Chat Deleted",description:"The chat has been removed"})}catch(De){console.error("Error deleting chat:",De),O({title:"Error",description:"Failed to delete chat",variant:"destructive"})}}),wt=()=>{const pe=[];let De=[];d.forEach((it,zt)=>{const Bt=zt>0?d[zt-1]:null;Bt&&Bt.sender_id===it.sender_id&&Bt.message_type===it.message_type&&(it.message_type==="text"||it.message_type==="event_share"||it.message_type==="review_share")?De.push(it):(De.length>0&&pe.push(De),De=[it])}),De.length>0&&pe.push(De);const Le=[];let bt=[];return pe.forEach((it,zt)=>{const Bt=it[0],Te=zt>0?pe[zt-1]:null,dt=Te?Te[Te.length-1]:null;dt&&g2(ms(Bt.created_at),ms(dt.created_at))>=30?(bt.length>0&&Le.push(bt),bt=[it]):bt.push(it)}),bt.length>0&&Le.push(bt),Le.map((it,zt)=>{const Te=it[0][0],dt=ms(Te.created_at),mr=new Date,Mn=Qg(mr,7),fe=Vce(dt,{start:Mn,end:mr});return s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{className:"flex justify-center w-full",style:{marginBottom:"var(--spacing-grouped, 24px)"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:fe?s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{fontWeight:"var(--typography-meta-weight, 700)"},children:Mt(dt,"EEEE")}),s.jsxs("span",{style:{fontWeight:"var(--typography-meta-weight, 500)"},children:[" at ",Mt(dt,"h:mm a")]})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{fontWeight:"var(--typography-meta-weight, 700)"},children:Mt(dt,"MMM d")}),s.jsxs("span",{style:{fontWeight:"var(--typography-meta-weight, 500)"},children:[" at ",Mt(dt,"h:mm a")]})]})})}),it.map((Re,ot)=>{const vt=Re[0],ut=ot>0?it[ot-1]:null,Pe=ut?ut[ut.length-1]:null,Ge=(l==null?void 0:l.is_group_chat)&&vt.sender_id!==e&&(Pe===null||Pe.sender_id!==vt.sender_id||Pe.message_type!=="text"&&Pe.message_type!=="review_share"&&Pe.message_type!=="event_share"),Ee=vt.sender_id===e;return s.jsxs("div",{className:"flex flex-col",style:{alignItems:Ee?"flex-end":"flex-start",marginTop:ut?"var(--spacing-grouped, 24px)":"0"},children:[Ge&&s.jsx("div",{style:{marginBottom:"var(--spacing-inline, 6px)"},children:s.jsx(oc,{variant:"chat",name:vt.sender_name,initial:vt.sender_name.split(" ").map(ft=>ft[0]).join("").substring(0,1),imageUrl:vt.sender_avatar||null})}),s.jsx("div",{className:"flex flex-col",style:{gap:"var(--spacing-inline, 6px)"},children:Re.map((ft,Pt)=>{var un,hn,xn,Rt,hr,or;const yr=Pt===Re.length-1;return s.jsxs("div",{className:"flex flex-col",style:{gap:yr?"var(--spacing-inline, 6px)":"0"},children:[ft.message_type==="review_share"&&(ft.shared_review_id||(un=ft.metadata)!=null&&un.review_id)?s.jsx(Qfe,{reviewId:ft.shared_review_id||((hn=ft.metadata)==null?void 0:hn.review_id),customMessage:(xn=ft.metadata)==null?void 0:xn.custom_message,onReviewClick:Xe,currentUserId:e,metadata:ft.metadata}):ft.message_type==="event_share"&&(ft.shared_event_id||(Rt=ft.metadata)!=null&&Rt.event_id)?s.jsx(Jfe,{eventId:ft.shared_event_id||((hr=ft.metadata)==null?void 0:hr.event_id),customMessage:(or=ft.metadata)==null?void 0:or.custom_message,onEventClick:Ae,onInterestToggle:Be,onAttendanceToggle:ge,currentUserId:e,refreshTrigger:q}):s.jsx("div",{style:{maxWidth:"172px",padding:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",border:ft.sender_id===e?"none":"1px solid var(--neutral-200)",backgroundColor:ft.sender_id===e?"var(--brand-pink-500)":"var(--neutral-100)",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",margin:0,color:ft.sender_id===e?"var(--neutral-50)":"var(--neutral-900)"},children:ft.content})}),yr&&s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",lineHeight:"var(--typography-meta-line-height, 1.5)",textAlign:Ee?"right":"left",margin:0},children:Mt(ms(ft.created_at),"h:mm a")})]},ft.id)})})]},`group-${zt}-${ot}`)})]},`session-${zt}`)})};return R?s.jsx(w1,{text:"Loading messages..."}):s.jsxs("div",{className:"flex min-h-screen w-full max-w-[393px] mx-auto",style:{backgroundColor:"var(--neutral-50)"},children:[!a&&s.jsx(Yo,{menuOpen:r,onMenuClick:n,children:s.jsx("h1",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",color:"var(--neutral-900)"},children:"Messages"})}),!l&&s.jsxs("div",{className:"w-full flex flex-col",children:[s.jsx("div",{style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:a?"calc(env(safe-area-inset-top, 0px) + var(--spacing-small, 12px))":"calc(env(safe-area-inset-top, 0px) + 68px + var(--spacing-small, 12px))",paddingBottom:0},children:s.jsx(Sn,{variant:"primary",size:"standard",fullWidth:!0,icon:"plus",iconPosition:"right",onClick:pe=>{pe.preventDefault(),console.log(" Button clicked! Opening user search"),y(!0)},children:"New Chat"})}),i.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center min-h-full",style:{gap:"var(--spacing-big-section, 60px)",padding:"var(--spacing-small, 12px)",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[s.jsxs("div",{className:"flex flex-col items-center justify-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx($n,{size:60,strokeWidth:2,style:{color:"var(--neutral-600)"}}),s.jsx("h2",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No Conversations Yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Start chatting with your friends!"})]}),s.jsx("div",{className:"border-[3px] rounded-[12px] p-3 min-h-[110px] flex items-center justify-center",style:{width:"calc(100vw - 40px)",backgroundColor:"var(--brand-pink-050)",borderColor:"var(--brand-pink-700)"},children:s.jsxs("ul",{className:"list-disc text-[16px] font-normal leading-[normal] space-y-0 ml-6",style:{color:"var(--neutral-900)"},children:[s.jsx("li",{className:"mb-0",children:s.jsx("span",{children:"Send friend requests first"})}),s.jsx("li",{className:"mb-0",children:s.jsx("span",{children:"Wait for them to accept"})}),s.jsx("li",{children:s.jsx("span",{children:"Then start chatting!"})})]})})]}):s.jsx("div",{style:{paddingTop:0,paddingBottom:"var(--spacing-bottom-nav, 112px)",display:"flex",flexDirection:"column"},children:i.map((pe,De)=>s.jsx("div",{className:"cursor-pointer transition-colors",style:{padding:"var(--spacing-grouped, 24px)",paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",borderBottom:De<i.length-1?"1px solid var(--neutral-200)":"none",backgroundColor:(l==null?void 0:l.id)===pe.id?"var(--neutral-100)":"transparent"},onClick:()=>c(pe),onMouseEnter:Le=>{(l==null?void 0:l.id)!==pe.id&&(Le.currentTarget.style.backgroundColor="var(--neutral-100)")},onMouseLeave:Le=>{(l==null?void 0:l.id)!==pe.id&&(Le.currentTarget.style.backgroundColor="transparent")},children:s.jsxs("div",{className:"flex items-center gap-3",children:[pe.has_unread?s.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0 animate-pulse",style:{backgroundColor:"var(--brand-pink-500)"}}):s.jsx("div",{className:"w-3 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 flex items-center gap-4 cursor-pointer min-w-0",children:[s.jsxs(Vr,{className:"w-12 h-12 flex-shrink-0",children:[s.jsx(sn,{src:Ne(pe)||void 0}),s.jsx(Wr,{className:"font-medium",style:{backgroundImage:"var(--gradient-brand)",color:"var(--neutral-50)"},children:pe.is_group_chat?s.jsx(zr,{className:"w-6 h-6"}):Oe(pe).split(" ").map(Le=>Le[0]).join("")})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[s.jsx("h3",{className:"font-semibold break-words",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)"},children:Oe(pe)}),pe.latest_message_created_at&&s.jsx("span",{className:"text-xs flex-shrink-0 font-medium whitespace-nowrap",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:ve(pe.latest_message_created_at)})]}),s.jsx("p",{className:"text-sm break-words mb-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:pe.latest_message?s.jsxs("span",{children:[s.jsxs("span",{className:"font-medium",children:[pe.latest_message_sender_name,":"]})," ",pe.latest_message]}):s.jsx("span",{style:{color:"var(--neutral-600)"},children:"No messages yet"})}),pe.is_group_chat&&pe.is_verified&&s.jsx("div",{className:"flex items-center gap-2 mt-2",children:s.jsxs(Ke,{variant:"default",className:"text-xs font-medium",style:{backgroundColor:"var(--status-success-050)",color:"var(--status-success-500)",border:"1px solid var(--status-success-500)"},children:[s.jsx(gl,{className:"w-3 h-3 mr-1"}),"Verified ",pe.entity_type?pe.entity_type.charAt(0).toUpperCase()+pe.entity_type.slice(1):"Chat"]})})]})]}),s.jsx(le,{variant:"ghost",size:"sm",onClick:Le=>{Le.stopPropagation(),Ft(pe.id)},className:"hover:text-red-500 hover:bg-red-50 p-2 flex-shrink-0 rounded-lg transition-all duration-200",style:{color:"var(--neutral-600)"},children:s.jsx(Dl,{className:"w-4 h-4"})})]})},pe.id))})]}),l&&s.jsx("div",{className:"w-full flex flex-col min-h-0",style:{backgroundColor:"var(--neutral-50)"},children:s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"h-[44px] flex items-center justify-between",style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",backgroundColor:"var(--neutral-50)",boxShadow:"0px 4px 4px 0px var(--shadow-color)"},children:[s.jsxs("div",{className:"flex items-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx("button",{onClick:()=>c(null),className:"w-6 h-6 flex items-center justify-center cursor-pointer",children:s.jsx(Cs,{className:"w-6 h-6",style:{color:"var(--neutral-900)"}})}),s.jsxs(Vr,{className:"w-8 h-8 flex-shrink-0",children:[s.jsx(sn,{src:Ne(l)||void 0}),s.jsx(Wr,{className:"font-medium text-base",style:{backgroundImage:"var(--gradient-brand)",color:"var(--neutral-50)"},children:l.is_group_chat?s.jsx(zr,{className:"w-5 h-5"}):Oe(l).split(" ").map(pe=>pe[0]).join("")})]}),s.jsx("h2",{className:"font-bold text-[24px] leading-[normal]",style:{color:"var(--neutral-900)"},children:Oe(l)})]}),s.jsxs(O1,{children:[s.jsx(M1,{asChild:!0,children:s.jsx(le,{variant:"ghost",style:{width:"var(--size-input-height, 44px)",height:"var(--size-input-height, 44px)",padding:0,display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(vQ,{size:24,style:{color:"var(--neutral-900)"}})})}),s.jsxs(tx,{align:"end",className:"w-56",children:[l.is_group_chat&&s.jsxs(s.Fragment,{children:[s.jsxs(Hi,{onClick:ct,children:[s.jsx(zr,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"View Users"})]}),s.jsx(d_,{})]}),s.jsxs(Hi,{onClick:()=>Et(Lt(l)),children:[s.jsx(Rs,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"View Profile"})]}),s.jsxs(Hi,{onClick:()=>gt(Lt(l)),children:[s.jsx(Bk,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Block User"})]}),s.jsxs(Hi,{onClick:St,children:[V?s.jsx(Ld,{className:"mr-2 h-4 w-4"}):s.jsx(cQ,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:V?"Unmute Notifications":"Mute Notifications"})]}),_e&&s.jsxs(s.Fragment,{children:[s.jsx(d_,{}),s.jsxs(Hi,{onClick:dr,children:[s.jsx(It,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"View Event"})]})]}),s.jsx(d_,{}),s.jsxs(Hi,{onClick:Sr,className:"text-red-600 focus:text-red-600",children:[s.jsx(Dl,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Delete Chat"})]})]})]})]}),s.jsx("div",{style:{maxWidth:"353px",width:"100%",margin:"0 auto",paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:a?"calc(env(safe-area-inset-top, 0px) + var(--spacing-small, 12px))":"calc(env(safe-area-inset-top, 0px) + 68px + var(--spacing-small, 12px))",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:l.is_group_chat?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsxs("div",{className:"flex flex-col items-center justify-center",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx($n,{size:60,className:"mx-auto",style:{color:"var(--neutral-600)"}}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"Coming Soon"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Group chats are still in development"})]})}):d.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full",style:{gap:"var(--spacing-inline, 6px)"},children:[s.jsx($n,{size:60,strokeWidth:2,style:{color:"var(--neutral-600)"}}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No Messages Yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Start the conversation!"})]}):s.jsxs("div",{className:"flex flex-col",style:{paddingTop:"var(--spacing-grouped, 24px)",paddingBottom:"var(--spacing-grouped, 24px)"},children:[wt(),s.jsx("div",{ref:ce})]})}),!l.is_group_chat&&s.jsx("div",{style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingBottom:"var(--spacing-screen-margin-x, 20px)",backgroundColor:"var(--neutral-50)"},children:s.jsxs("div",{className:"border-2 rounded-[10px] flex items-center justify-between h-[44px] pl-5 pr-[1px]",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)"},children:[s.jsx(Input,{value:f,onChange:pe=>h(pe.target.value),placeholder:"Type a message...",onKeyPress:pe=>pe.key==="Enter"&&mt(),className:"bg-transparent border-0 flex-1 h-full text-[16px] focus-visible:ring-0 focus-visible:ring-offset-0 px-0",style:{color:"var(--neutral-600)"},id:"chat-message-input","aria-label":"Type a message","aria-describedby":"chat-send-button"}),s.jsx(le,{onClick:mt,disabled:!f.trim(),className:"h-[44px] w-[44px] p-0 rounded-br-[10px] rounded-tr-[10px] rounded-bl-0 rounded-tl-0 disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0",style:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},onMouseEnter:pe=>{pe.currentTarget.disabled||(pe.currentTarget.style.backgroundColor="var(--brand-pink-600)")},onMouseLeave:pe=>{pe.currentTarget.style.backgroundColor="var(--brand-pink-500)"},id:"chat-send-button","aria-label":"Send message","aria-describedby":f.trim()?void 0:"chat-send-disabled-hint",children:s.jsx(Fc,{className:"w-[22px] h-[22px]",style:{color:"var(--neutral-50)"},"aria-hidden":"true"})}),!f.trim()&&s.jsx("span",{id:"chat-send-disabled-hint",className:"sr-only",children:"Message input is empty"})]})})]})}),v&&s.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[9999]",style:{backgroundColor:"var(--overlay-50)"},children:s.jsxs("div",{className:"border rounded-[10px] h-[452px] flex flex-col p-3 relative",style:{width:"calc(100vw - 40px)",backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",boxShadow:"0px 4px 4px 0px var(--shadow-color)"},children:[s.jsx("button",{onClick:()=>{y(!1),A([]),k("")},className:"absolute top-3 right-3 w-6 h-6 flex items-center justify-center cursor-pointer rounded transition-colors",style:{color:"var(--neutral-900)"},onMouseEnter:pe=>{pe.currentTarget.style.backgroundColor="var(--neutral-100)"},onMouseLeave:pe=>{pe.currentTarget.style.backgroundColor="transparent"},children:s.jsx(Gr,{className:"w-5 h-5",style:{color:"var(--neutral-900)"}})}),s.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[s.jsx("h2",{className:"font-bold text-[20px] leading-[normal]",style:{color:"var(--neutral-900)"},children:"Select Users to Chat With"}),s.jsx("div",{className:"w-full",children:s.jsx(Xi,{placeholder:"Search users...",value:S,onChange:pe=>k(pe),widthVariant:"full"})}),s.jsx("div",{className:"flex flex-col h-[235px] overflow-y-auto overflow-x-hidden",style:{gap:"var(--spacing-small, 12px)"},children:_t.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center",style:{gap:"var(--spacing-inline, 6px)",paddingTop:"var(--spacing-grouped, 24px)",paddingBottom:"var(--spacing-grouped, 24px)"},children:[s.jsx(zr,{className:"w-[60px] h-[60px] mx-auto",style:{color:"var(--neutral-600)"}}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No friends to chat with yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"You need to be friends with someone before you can chat with them."})]}):_t.map(pe=>{const De=P.some(Le=>Le.user_id===pe.user_id);return s.jsxs("div",{className:"border rounded-[10px] shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)] h-[60px] cursor-pointer flex items-center px-[7px] gap-[45px] transition-all ",style:{borderColor:"var(--brand-pink-500)",backgroundColor:De?"var(--brand-pink-050)":"var(--neutral-50)"},onClick:()=>{Ye(pe.user_id),y(!1),A([]),k("")},children:[s.jsxs("div",{className:"flex items-center gap-[6px] flex-1 min-w-0",children:[s.jsxs(Vr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(sn,{src:pe.avatar_url||void 0}),s.jsx(Wr,{className:"bg-synth-beige/50 text-synth-black font-medium text-sm",children:pe.name.split(" ").map(Le=>Le[0]).join("")})]}),s.jsxs("div",{className:"flex flex-col gap-[6px] justify-center min-w-0 flex-1",children:[s.jsx("p",{className:"font-bold text-[20px] leading-[normal] truncate",style:{color:"var(--neutral-900)"},children:pe.name}),pe.bio&&s.jsx("p",{className:"font-normal text-[16px] leading-[normal] truncate",style:{color:"var(--neutral-600)"},children:pe.bio})]})]}),s.jsx(Dy,{className:"w-6 h-6 flex-shrink-0",style:{color:"var(--neutral-900)"}})]},pe.user_id)})})]})]})}),b&&s.jsx("div",{className:"fixed inset-0 backdrop-blur-sm flex items-center justify-center z-[9999]",style:{backgroundColor:"var(--overlay-50)"},children:s.jsxs("div",{className:"rounded-3xl p-8 w-full max-w-lg mx-4 shadow-2xl border-2",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",boxShadow:"0 25px 50px -12px var(--shadow-color)"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--neutral-900)"},children:"Create Group Chat"}),s.jsx(le,{variant:"ghost",size:"sm",onClick:()=>N(!1),className:"rounded-xl h-9 w-9 p-0",onMouseEnter:pe=>{pe.currentTarget.style.backgroundColor="var(--neutral-100)"},onMouseLeave:pe=>{pe.currentTarget.style.backgroundColor="transparent"},children:s.jsx(Gr,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex items-center justify-center py-16",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx($n,{className:"w-12 h-12 mx-auto text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Group chats are still in development"})]})}),s.jsx(le,{onClick:()=>N(!1),className:"w-full shadow-lg hover:shadow-xl rounded-xl py-6 font-semibold text-base transition-all duration-300",style:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},onMouseEnter:pe=>{pe.currentTarget.style.backgroundColor="var(--brand-pink-600)"},onMouseLeave:pe=>{pe.currentTarget.style.backgroundColor="var(--brand-pink-500)"},children:"Close"})]})}),Z&&Q&&s.jsx(pn,{open:Z,onOpenChange:pe=>{Y(pe),pe||(X(null),ee(null),re(!1))},children:s.jsxs(dn,{className:"max-w-6xl w-[95vw] h-[95vh] max-h-[95vh] p-0 overflow-hidden flex flex-col",hideCloseButton:!0,children:[s.jsx(bn,{className:"sr-only",children:"Review Details"}),s.jsx(os,{className:"sr-only",children:"Review details"}),s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",style:{borderColor:"var(--neutral-200)",backgroundColor:"var(--neutral-50)"},children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Vr,{className:"w-10 h-10",children:[s.jsx(sn,{src:((lt=Q.author)==null?void 0:lt.avatar_url)||void 0}),s.jsx(Wr,{style:{backgroundImage:"var(--gradient-brand)",color:"var(--neutral-50)"},children:((jt=(Qe=Q.author)==null?void 0:Qe.name)==null?void 0:jt.charAt(0))||"U"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("span",{className:"font-semibold",children:((ir=Q.author)==null?void 0:ir.name)||"User"})}),s.jsx("div",{className:"text-xs",style:{color:"var(--neutral-600)"},children:new Date(Q.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]}),s.jsx(le,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>Y(!1),children:s.jsx(Gr,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s.jsxs("div",{className:"flex-1 bg-black flex items-center justify-center min-h-0 relative",children:[ye!=null&&ye.photos&&ye.photos.length>0||Q.photos&&Q.photos.length>0?s.jsx("img",{src:(ye==null?void 0:ye.photos[0])||((rr=Q.photos)==null?void 0:rr[0]),alt:"Review photo",className:"max-w-full max-h-full object-contain"}):s.jsxs("div",{className:"text-center",style:{color:"var(--neutral-50)"},children:[s.jsxs("div",{className:"text-6xl font-bold mb-4",children:[s.jsx("span",{className:"text-pink-500",children:"S"}),"ynth"]}),s.jsx("div",{className:"w-32 h-0.5 bg-white mx-auto mb-4"}),s.jsx("div",{className:"text-sm opacity-80",children:"Concert Review"})]}),(ye==null?void 0:ye.reactionEmoji)&&s.jsx("div",{className:"absolute top-4 right-4 text-4xl bg-white/20 backdrop-blur-sm rounded-full w-16 h-16 flex items-center justify-center",children:ye.reactionEmoji})]}),s.jsx("div",{className:"flex-1 flex flex-col bg-white overflow-y-auto",children:ne?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsxs("div",{className:"text-center",children:[s.jsx(lr,{className:"h-8 w-8 animate-spin text-indigo-500 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Loading review details..."})]})}):s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:((Ie=Q.event_info)==null?void 0:Ie.event_name)||Q.title||"Concert Review"}),s.jsx("div",{className:"flex flex-wrap items-center gap-2 text-sm text-gray-600 mb-3",children:((At=Q.event_info)==null?void 0:At.artist_name)&&s.jsx(Ke,{variant:"secondary",className:"cursor-pointer hover:bg-indigo-100",children:Q.event_info.artist_name})}),((yt=Q.event_info)==null?void 0:yt.venue_name)&&s.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[s.jsx(gr,{className:"w-4 h-4"}),s.jsx("span",{children:Q.event_info.venue_name})]})]}),Q.rating&&s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(pe,De)=>{const Le=De+1,bt=Q.rating||0,it=Le<=Math.floor(bt),zt=!it&&Le-.5<=bt;return s.jsxs("div",{className:"relative w-6 h-6",children:[s.jsx(Qt,{className:"w-6 h-6 text-gray-300"}),(zt||it)&&s.jsx("div",{className:`absolute left-0 top-0 h-full overflow-hidden pointer-events-none ${it?"w-full":"w-1/2"}`,children:s.jsx(Qt,{className:"w-6 h-6 text-yellow-500 fill-yellow-500"})})]},De)})}),s.jsxs("span",{className:"text-lg font-semibold",children:[Q.rating,"/5"]})]}),Q.content&&s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold mb-2 text-gray-900",children:"Review"}),s.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:Q.content})]}),s.jsxs("div",{className:"flex items-center gap-6 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[s.jsx(ns,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:Q.likes_count||0})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[s.jsx($n,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:Q.comments_count||0})]})]})]})})]})]})}),B&&s.jsx(Bl,{event:B,currentUserId:e,isOpen:z,onClose:()=>{D(!1),F(null),K(pe=>pe+1)},onInterestToggle:Be,isInterested:U}),we&&l&&l.is_group_chat&&s.jsx(pn,{open:we,onOpenChange:oe,children:s.jsxs(dn,{className:"max-w-[393px] max-h-[80vh] overflow-y-auto",style:{backgroundColor:"var(--neutral-50)"},children:[s.jsxs(DialogHeader,{children:[s.jsxs(bn,{className:"text-[20px] font-bold",style:{color:"var(--neutral-900)"},children:["Group Members (",ie.length,")"]}),s.jsx(os,{className:"text-[16px]",style:{color:"var(--neutral-600)"},children:"Members of this group chat"})]}),s.jsx("div",{className:"space-y-3 mt-4",children:ie.length===0?s.jsxs("div",{className:"flex flex-col gap-[6px] items-center justify-center py-8",children:[s.jsx(zr,{className:"w-[60px] h-[60px] mx-auto",style:{color:"var(--neutral-600)"}}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"No members found"})]}):ie.map(pe=>{const De=pe.user_id===e,Le=pe.is_admin;return s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-[10px] transition-colors",style:{borderColor:"var(--neutral-200)",backgroundColor:"var(--neutral-100)"},children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 cursor-pointer",onClick:()=>{Et(pe.user_id),oe(!1)},children:[s.jsxs(Vr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(sn,{src:pe.avatar_url||void 0}),s.jsx(Wr,{className:"font-medium",style:{backgroundImage:"var(--gradient-brand)",color:"var(--neutral-50)"},children:pe.name.split(" ").map(bt=>bt[0]).join("")})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h3",{className:"font-semibold text-[16px] truncate",style:{color:"var(--neutral-900)"},children:[pe.name,De&&s.jsx("span",{className:"text-[14px] font-normal ml-1",style:{color:"var(--neutral-600)"},children:"(You)"})]}),pe.verified&&s.jsx(Ke,{variant:"default",className:"text-[10px]",style:{backgroundColor:"var(--status-success-500)",color:"var(--neutral-50)"},children:" Verified"})]}),pe.bio&&s.jsx("p",{className:"text-[14px] truncate mt-1",style:{color:"var(--neutral-600)"},children:pe.bio}),s.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[Le&&s.jsx(Ke,{variant:"default",className:"text-[12px]",style:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},children:"Admin"}),s.jsxs("span",{className:"text-[12px]",style:{color:"var(--neutral-600)"},children:["Joined ",Mt(ms(pe.joined_at),"MMM d, yyyy")]})]})]})]}),!De&&s.jsx(le,{variant:"ghost",size:"sm",onClick:bt=>{bt.stopPropagation(),Et(pe.user_id),oe(!1)},className:"p-2 flex-shrink-0",style:{color:"var(--neutral-600)"},onMouseEnter:bt=>{bt.currentTarget.style.color="var(--brand-pink-500)",bt.currentTarget.style.backgroundColor="var(--brand-pink-050)"},onMouseLeave:bt=>{bt.currentTarget.style.color="var(--neutral-600)",bt.currentTarget.style.backgroundColor="transparent"},children:s.jsx(Rs,{className:"w-4 h-4"})})]},pe.id||pe.user_id)})})]})})]})};class Pf{static fetchAllNews(){return E(this,null,function*(){const t=this.getCachedNews();if(t)return console.log(" Using cached news articles"),t;console.log(" Fetching fresh news articles from RSS feeds");const r=[],n=this.SOURCES.map(i=>this.fetchFromSource(i));return(yield Promise.allSettled(n)).forEach((i,o)=>{i.status==="fulfilled"?(r.push(...i.value),console.log(` ${this.SOURCES[o].displayName}: ${i.value.length} articles`)):console.error(` ${this.SOURCES[o].displayName}: ${i.reason}`)}),r.sort((i,o)=>new Date(o.pubDate).getTime()-new Date(i.pubDate).getTime()),this.cacheNews(r),r})}static fetchFromSource(t){return E(this,null,function*(){try{const r=`https://api.allorigins.win/raw?url=${encodeURIComponent(t.url)}`,n=yield fetch(r);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const a=yield n.text();return this.parseRSSFeed(a,t)}catch(r){return console.error(`Error fetching from ${t.displayName}:`,r),[]}})}static parseRSSFeed(t,r){const n=[];try{const i=new DOMParser().parseFromString(t,"text/xml"),o=i.querySelector("parsererror");if(o)throw new Error(`XML parsing error: ${o.textContent}`);i.querySelectorAll("item").forEach((c,d)=>{var u,f,h,p,g,v,y,_,w,b,N,S,k,P,A;try{const R=((f=(u=c.querySelector("title"))==null?void 0:u.textContent)==null?void 0:f.trim())||"",$=((p=(h=c.querySelector("description"))==null?void 0:h.textContent)==null?void 0:p.trim())||"",O=((v=(g=c.querySelector("link"))==null?void 0:g.textContent)==null?void 0:v.trim())||"",z=((_=(y=c.querySelector("pubDate"))==null?void 0:y.textContent)==null?void 0:_.trim())||"",D=((b=(w=c.querySelector("author"))==null?void 0:w.textContent)==null?void 0:b.trim())||((S=(N=c.querySelector("dc\\:creator"))==null?void 0:N.textContent)==null?void 0:S.trim())||((P=(k=c.querySelector("creator"))==null?void 0:k.textContent)==null?void 0:P.trim())||"";let B="";const F=c.querySelector("media\\:content"),U=c.querySelector("enclosure");if(F)B=F.getAttribute("url")||"";else if(U&&((A=U.getAttribute("type"))!=null&&A.startsWith("image/")))B=U.getAttribute("url")||"";else{const G=$.match(/<img[^>]+src="([^"]+)"/i);G&&(B=G[1])}R&&O&&this.isMusicRelated(R,$)&&n.push({id:`${r.name}-${d}-${Date.now()}`,title:this.cleanText(R),description:this.cleanText($),link:O,pubDate:this.parseDate(z),source:r.displayName,imageUrl:B||void 0,author:D||void 0})}catch(R){console.error(`Error parsing item ${d} from ${r.displayName}:`,R)}})}catch(a){console.error(`Error parsing RSS feed from ${r.displayName}:`,a)}return n}static isMusicRelated(t,r){const n=`${t} ${r}`.toLowerCase(),a=["music","song","album","artist","band","concert","tour","live music","musician","singer","guitarist","drummer","bassist","pianist","vocalist","rock","pop","hip hop","rap","jazz","blues","country","electronic","indie","alternative","metal","punk","reggae","soul","r&b","folk","festival","gig","venue","music video","single","ep","soundtrack","record label","music producer","dj","remix","cover","collaboration","music industry","streaming","spotify","apple music","billboard","grammy","mtv","music awards","chart","top 40","radio","playlist"],i=["game","gaming","video game","xbox","playstation","nintendo","movie","film","tv show","television","series","netflix","sports","football","basketball","soccer","baseball","tennis","politics","election","president","government","political","technology","tech","computer","software","hardware","iphone","business","economy","finance","stock","market","crypto","food","restaurant","recipe","cooking","chef","fashion","clothing","style","beauty","makeup","travel","vacation","hotel","flight","tourism"];for(const o of i)if(n.includes(o))return console.log(` Filtered out non-music article: "${t}" (keyword: ${o})`),!1;for(const o of a)if(n.includes(o))return console.log(` Music article found: "${t}" (keyword: ${o})`),!0;return console.log(` Unclear content filtered out: "${t}"`),!1}static cleanText(t){return t.replace(/<[^>]*>/g,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&nbsp;/g," ").trim()}static parseDate(t){try{const r=new Date(t);return isNaN(r.getTime())?new Date().toISOString():r.toISOString()}catch(r){return console.error("Error parsing date:",t,r),new Date().toISOString()}}static getCachedNews(){try{const t=localStorage.getItem("news-cache");if(!t)return null;const r=JSON.parse(t);return Date.now()<r.expiresAt?r.articles:(localStorage.removeItem("news-cache"),null)}catch(t){return console.error("Error reading news cache:",t),localStorage.removeItem("news-cache"),null}}static cacheNews(t){try{const r=Date.now(),n={articles:t,timestamp:r,expiresAt:r+this.CACHE_DURATION};localStorage.setItem("news-cache",JSON.stringify(n)),console.log(` Cached ${t.length} news articles for ${this.CACHE_DURATION/1e3/60} minutes`)}catch(r){console.error("Error caching news:",r)}}static getSources(){return this.SOURCES.map(t=>M({},t))}static filterBySource(t,r){if(r==="all")return t;const n=this.SOURCES.find(a=>a.name===r);return n?t.filter(a=>a.source===n.displayName):t}static clearCache(){localStorage.removeItem("news-cache"),console.log(" News cache cleared - will fetch fresh articles with music filtering")}static scoreArticleRelevance(t,r,n){let a=0;const i=`${t.title} ${t.description}`.toLowerCase();for(const u of r)if(i.includes(u.artist_name.toLowerCase())){a+=Math.min(u.score*1.5,60),console.log(` Artist match: "${u.artist_name}" in "${t.title}" (+${Math.min(u.score*1.5,60)} pts)`);break}let o=0,l=0;const c=[];for(const u of n)i.includes(u.genre.toLowerCase())&&(o+=u.score,l++,c.push(u.genre));if(l>0){const u=Math.min(o/l*1.33,40);a+=u,console.log(` Genre match: [${c.join(", ")}] in "${t.title}" (+${u.toFixed(1)} pts)`)}const d=Math.min(a,100);return d>0&&console.log(` Article scored: "${t.title}" = ${d.toFixed(1)}/100`),d}static getPersonalizedNews(t){return E(this,null,function*(){var r,n,a,i,o;try{console.log(" Fetching personalized news for user:",t);const l=yield this.fetchAllNews();if(!(yield Kf.userHasMusicData(t)))return console.log(" No music data for user, returning all news sorted by date"),l;const d=yield Kf.getUserTopArtists(t,50),u=yield Kf.getUserTopGenres(t,20);if(console.log(" User music profile:",{artists:d.length,genres:u.length,topArtist:(r=d[0])==null?void 0:r.artist_name,topGenre:(n=u[0])==null?void 0:n.genre}),d.length===0&&u.length===0)return console.log(" No artist/genre preferences found, returning all news"),l;const h=l.map(p=>{const g=this.scoreArticleRelevance(p,d,u);return H(M({},p),{relevance_score:g})}).sort((p,g)=>g.relevance_score!==p.relevance_score?(g.relevance_score||0)-(p.relevance_score||0):new Date(g.pubDate).getTime()-new Date(p.pubDate).getTime());return console.log(" Personalized news complete:",{total:h.length,topScore:(i=(a=h[0])==null?void 0:a.relevance_score)==null?void 0:i.toFixed(1),topArticle:(o=h[0])==null?void 0:o.title,personalizedCount:h.filter(p=>(p.relevance_score||0)>0).length}),h}catch(l){return console.error(" Error in personalized news:",l),this.fetchAllNews()}})}}Cr(Pf,"CACHE_DURATION",5*60*1e3),Cr(Pf,"SOURCES",[{name:"pitchfork",url:"https://pitchfork.com/rss/news/",displayName:"Pitchfork"},{name:"rollingstone",url:"https://www.rollingstone.com/music/rss/",displayName:"Rolling Stone"},{name:"nme",url:"https://www.nme.com/music/feed/",displayName:"NME"},{name:"billboard",url:"https://www.billboard.com/feed/rss",displayName:"Billboard"}]);function eme({article:e,className:t=""}){const r=i=>{try{const o=ms(i),c=Math.abs(new Date().getTime()-o.getTime())/(1e3*60*60);return c<24?Mt(o,"h:mm a"):c<168?Mt(o,"EEEE"):Mt(o,"MMM d")}catch(o){return"Recent"}},n=(i,o=150)=>i.length<=o?i:i.substring(0,o).trim()+"...",a=()=>{window.open(e.link,"_blank","noopener,noreferrer")};return s.jsxs(He,{className:`overflow-hidden hover:shadow-md transition-all duration-200 cursor-pointer group ${t}`,children:[e.imageUrl&&s.jsx("div",{className:"h-48 w-full overflow-hidden bg-gray-100",children:s.jsx("img",{src:e.imageUrl,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",loading:"lazy",onError:i=>{const o=i.target;o.style.display="none",o.parentElement.style.display="none"}})}),s.jsxs(et,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Ke,{variant:"secondary",className:"flex items-center gap-1 text-xs bg-pink-100 text-pink-700 hover:bg-pink-200",children:[s.jsx(wP,{className:"w-3 h-3"}),e.source]}),e.relevance_score&&e.relevance_score>50&&s.jsxs(Ke,{variant:"secondary",className:"flex items-center gap-1 text-xs bg-gradient-to-r from-purple-100 to-pink-100 text-purple-700 border-purple-200",children:[s.jsx(Qt,{className:"w-3 h-3 fill-purple-500"}),"For You"]})]}),s.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[s.jsx(It,{className:"w-3 h-3"}),r(e.pubDate)]})]}),s.jsx("h3",{className:"font-semibold text-lg mb-2 line-clamp-2 text-gray-900 group-hover:text-pink-600 transition-colors",children:e.title}),e.description&&s.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-3 leading-relaxed",children:n(e.description)}),e.author&&s.jsxs("div",{className:"flex items-center gap-1 mb-3 text-xs text-gray-500",children:[s.jsx(Rs,{className:"w-3 h-3"}),s.jsx("span",{children:e.author})]}),s.jsxs(le,{onClick:a,variant:"outline",size:"sm",className:"w-full border-pink-200 text-pink-600 hover:bg-pink-50 hover:border-pink-300 transition-colors",children:[s.jsx(Bo,{className:"w-4 h-4 mr-2"}),"Read More"]})]})]})}function tme({className:e=""}){return s.jsxs(He,{className:`overflow-hidden ${e}`,children:[s.jsx("div",{className:"h-48 w-full bg-gray-200 animate-pulse"}),s.jsxs(et,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"h-5 w-20 bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"})]}),s.jsxs("div",{className:"space-y-2 mb-2",children:[s.jsx("div",{className:"h-5 w-full bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-5 w-3/4 bg-gray-200 rounded animate-pulse"})]}),s.jsxs("div",{className:"space-y-2 mb-3",children:[s.jsx("div",{className:"h-3 w-full bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-3 w-full bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-3 w-2/3 bg-gray-200 rounded animate-pulse"})]}),s.jsx("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse mb-3"}),s.jsx("div",{className:"h-8 w-full bg-gray-200 rounded animate-pulse"})]})]})}function rme({artist:e,events:t,totalEvents:r,source:n,userId:a,onBack:i,onViewAllEvents:o,showAllEvents:l=!1,className:c}){const[d,u]=J.useState(a);J.useEffect(()=>{a||T.auth.getUser().then(({data:_})=>{var w;u((w=_.user)==null?void 0:w.id)})},[a]);const f=t.filter(_=>new Date(_.event_date)>new Date),h=l?f:f.slice(0,10),p=_=>new Date(_).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),g=_=>new Date(_).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),v=_=>_?new Date(_).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):null,y=_=>{const w=[_.venue_city,_.venue_state].filter(Boolean);return w.length>0?w.join(", "):"Location TBD"};return s.jsxs("div",{className:ke("w-full max-w-4xl mx-auto space-y-6 overflow-x-hidden",c),children:[i&&s.jsx(le,{variant:"ghost",onClick:i,className:"mb-4",children:" Back to Search"}),s.jsx(He,{children:s.jsx(Er,{children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsxs(Vr,{className:"w-20 h-20",children:[s.jsx(sn,{src:e.image_url||void 0}),s.jsx(Wr,{className:"text-2xl",children:s.jsx($t,{className:"w-10 h-10"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[s.jsx(qr,{className:"text-3xl",children:e.name}),s.jsx("div",{className:"flex items-center gap-2",children:d&&s.jsxs(s.Fragment,{children:[s.jsx(S1,{entityType:"artist",entityId:e.id||e.jambase_artist_id,entityName:e.name,currentUserId:d,onChatOpen:_=>{window.location.href=`/chats?chatId=${_}`},variant:"compact"}),s.jsx(Ky,{artistName:e.name,jambaseArtistId:e.jambase_artist_id,userId:d,variant:"outline",size:"default",showFollowerCount:!0})]})})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jambase_artist_id&&s.jsxs(Ke,{variant:"outline",className:"flex items-center gap-1",children:[s.jsx(Bo,{className:"w-3 h-3"}),"JamBase Verified"]}),s.jsx(Ke,{variant:"secondary",children:n==="api"?"Live Data":"Cached Data"})]}),e.description&&s.jsx("p",{className:"text-muted-foreground leading-relaxed mb-4",children:e.description}),e.genres&&e.genres.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsx("div",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Genres"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:e.genres.map((_,w)=>s.jsx(Ke,{variant:"secondary",className:"text-xs",children:_},w))})]}),s.jsxs("div",{className:"flex items-center gap-6 text-sm text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(It,{className:"w-4 h-4"}),s.jsxs("span",{children:[r," total events"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ga,{className:"w-4 h-4"}),s.jsxs("span",{children:[f.length," upcoming"]})]}),e.popularity_score&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Qt,{className:"w-4 h-4 text-yellow-400 fill-current"}),s.jsxs("span",{children:["Score: ",e.popularity_score]})]})]})]})]})})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Events"}),o&&r>t.length&&s.jsxs(le,{variant:"outline",onClick:o,children:["View All ",r," Events"]})]}),f.length>0&&s.jsxs("div",{className:"w-full overflow-x-hidden",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[s.jsx(It,{className:"w-5 h-5"}),"Upcoming Events (",f.length,")"]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 w-full max-w-full overflow-x-hidden",children:h.map(_=>s.jsx(He,{className:"hover:bg-muted/50 cursor-pointer w-full max-w-full min-w-0 overflow-hidden",children:s.jsx(et,{className:"p-2",children:s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"font-medium text-xs break-words",children:p(_.event_date)}),s.jsxs("div",{className:"text-xs text-muted-foreground break-words",children:[g(_.event_date),_.doors_time&&s.jsxs("span",{className:"ml-1 block",children:["Doors: ",v(_.doors_time)]})]}),s.jsx("div",{className:"font-medium text-xs truncate min-w-0",title:_.venue_name,children:_.venue_name||"Venue TBD"}),s.jsx("div",{className:"text-xs text-muted-foreground truncate min-w-0",children:y(_)}),_.price_range?s.jsxs("div",{className:"font-medium text-xs",children:["$",_.price_range]}):s.jsx("div",{className:"text-muted-foreground text-xs",children:"Price TBD"}),_.ticket_available&&_.ticket_urls&&_.ticket_urls.length>0?s.jsx(le,{variant:"outline",size:"sm",asChild:!0,className:"text-blue-600 hover:text-blue-700 text-xs px-1.5 py-0.5 h-5 mt-1 w-full",children:s.jsxs("a",{href:_.ticket_urls[0],target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-1",children:[s.jsx(Ml,{className:"w-2.5 h-2.5"}),s.jsx("span",{className:"text-xs",children:"Buy"})]})}):null,s.jsx(Ke,{variant:"default",className:"text-xs mt-1 w-full text-center",children:"Upcoming"})]})})},_.jambase_event_id))}),!l&&f.length>10&&s.jsx("div",{className:"mt-2",children:s.jsxs(le,{variant:"outline",onClick:o,className:"w-full",children:["Show ",f.length-10," More Upcoming Events"]})}),l&&f.length>10&&s.jsx("div",{className:"mt-2",children:s.jsx(le,{variant:"outline",onClick:()=>o==null?void 0:o(),className:"w-full",children:"Show Less (Back to 10 events)"})})]}),t.length===0&&s.jsx(He,{children:s.jsxs(et,{className:"text-center py-12",children:[s.jsx($t,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Events Found"}),s.jsxs("p",{className:"text-muted-foreground",children:["No events found for ",e.name,". This could mean:"]}),s.jsxs("ul",{className:"text-sm text-muted-foreground mt-2 space-y-1",children:[s.jsx("li",{children:" The artist has no upcoming or recent events"}),s.jsx("li",{children:" The artist name might be spelled differently"}),s.jsx("li",{children:" The events might not be in our database yet"})]})]})})]})]})}function nme({venueId:e,venueName:t,onClose:r}){var f,h,p,g;const[n,a]=x.useState(null),[i,o]=x.useState([]),[l,c]=x.useState([]),[d,u]=x.useState(null);return x.useEffect(()=>{T.auth.getUser().then(({data:v})=>{var y;u(((y=v.user)==null?void 0:y.id)||null)})},[]),x.useEffect(()=>{E(this,null,function*(){try{if(e){const{data:v}=yield T.from("venues").select("latitude, longitude").eq("id",e).single();v!=null&&v.latitude&&(v!=null&&v.longitude)&&a({lat:v.latitude,lng:v.longitude})}}catch(v){}try{if(e){const v=yield bs.getVenueReviews(e);o(v.reviews||[])}}catch(v){}try{const v=yield fetch(`/api/jambase/venues/upcoming?name=${encodeURIComponent(t)}`);if(v.ok){const y=yield v.json();c(Array.isArray(y==null?void 0:y.events)?y.events.slice(0,5):[])}}catch(v){}})},[e,t]),s.jsx(He,{className:"border-gray-200",children:s.jsxs(et,{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1 flex-1",children:[s.jsx("h3",{className:"text-base font-semibold",children:t}),n&&s.jsxs("div",{className:"text-xs text-gray-600 flex items-center gap-1",children:[s.jsx(gr,{className:"w-3 h-3"}),s.jsxs("span",{children:[(f=n.lat)==null?void 0:f.toFixed(3),", ",(h=n.lng)==null?void 0:h.toFixed(3)]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[d&&e&&s.jsx(S1,{entityType:"venue",entityId:e,entityName:t,currentUserId:d,onChatOpen:v=>{window.location.href=`/chats?chatId=${v}`},variant:"compact"}),r&&s.jsx(le,{variant:"ghost",size:"sm",onClick:r,children:""})]})]}),s.jsx("div",{className:"w-full h-40 rounded border flex items-center justify-center text-sm text-gray-500",children:n?`Map: ${(p=n.lat)==null?void 0:p.toFixed(3)}, ${(g=n.lng)==null?void 0:g.toFixed(3)}`:"Map location unavailable"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium mb-2",children:"Recent Reviews"}),i.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No venue reviews yet."}):s.jsx("div",{className:"space-y-2",children:i.slice(0,3).map(v=>s.jsxs("div",{className:"text-sm text-gray-700 flex items-center gap-2",children:[s.jsx(Qt,{className:"w-3 h-3 text-yellow-400 fill-current"}),s.jsxs("span",{children:[v.rating,"/5"]}),s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"truncate",children:v.review_text||"No text"})]},v.id))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium mb-2",children:"Upcoming Events"}),l.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No upcoming events found."}):s.jsx("div",{className:"space-y-2",children:l.map((v,y)=>s.jsxs("div",{className:"text-sm text-gray-700 flex items-center gap-2",children:[s.jsx(It,{className:"w-3 h-3"}),s.jsx("span",{className:"truncate",children:v.title||v.name||"Event"})]},y))})]})]})})}function sme({followedArtists:e,followedVenues:t,artistName:r,venueName:n,venueCity:a,venueState:i}){const o=r&&e.includes(r),l=n&&t.some(c=>c.name===n&&(!c.city||c.city===a)&&(!c.state||c.state===i));return!o&&!l?null:o&&l?s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsxs(Ke,{className:"bg-[#FF3399] text-white text-xs px-2 py-0.5 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"Following Artist"})]}),s.jsxs(Ke,{className:"bg-blue-600 text-white text-xs px-2 py-0.5 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"Following Venue"})]})]}):o?s.jsxs(Ke,{className:"bg-[#FF3399] text-white text-xs px-2 py-1 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"Following Artist"})]}):l?s.jsxs(Ke,{className:"bg-blue-600 text-white text-xs px-2 py-1 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"Following Venue"})]}):null}var br=function(){return br=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},br.apply(this,arguments)};function ame(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Sq(e,t,r){for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function rx(e){return e.mode==="multiple"}function nx(e){return e.mode==="range"}function D1(e){return e.mode==="single"}var ime={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function ome(e,t){return Mt(e,"LLLL y",t)}function lme(e,t){return Mt(e,"d",t)}function cme(e,t){return Mt(e,"LLLL",t)}function dme(e){return"".concat(e)}function ume(e,t){return Mt(e,"cccccc",t)}function hme(e,t){return Mt(e,"yyyy",t)}var fme=Object.freeze({__proto__:null,formatCaption:ome,formatDay:lme,formatMonthCaption:cme,formatWeekNumber:dme,formatWeekdayName:ume,formatYearCaption:hme}),mme=function(e,t,r){return Mt(e,"do MMMM (EEEE)",r)},pme=function(){return"Month: "},gme=function(){return"Go to next month"},vme=function(){return"Go to previous month"},yme=function(e,t){return Mt(e,"cccc",t)},xme=function(e){return"Week n. ".concat(e)},_me=function(){return"Year: "},wme=Object.freeze({__proto__:null,labelDay:mme,labelMonthDropdown:pme,labelNext:gme,labelPrevious:vme,labelWeekNumber:xme,labelWeekday:yme,labelYearDropdown:_me});function bme(){var e="buttons",t=ime,r=aT,n={},a={},i=1,o={},l=new Date;return{captionLayout:e,classNames:t,formatters:fme,labels:wme,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:i,styles:o,today:l,mode:"default"}}function jme(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,i=e.fromDate,o=e.toDate;return n?i=pi(n):t&&(i=new Date(t,0,1)),a?o=u1(a):r&&(o=new Date(r,11,31)),{fromDate:i?wm(i):void 0,toDate:o?wm(o):void 0}}var kq=x.createContext(void 0);function Nme(e){var t,r=e.initialProps,n=bme(),a=jme(r),i=a.fromDate,o=a.toDate,l=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;l!=="buttons"&&(!i||!o)&&(l="buttons");var c;(D1(r)||rx(r)||nx(r))&&(c=r.onSelect);var d=br(br(br({},n),r),{captionLayout:l,classNames:br(br({},n.classNames),r.classNames),components:br({},r.components),formatters:br(br({},n.formatters),r.formatters),fromDate:i,labels:br(br({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:br(br({},n.modifiers),r.modifiers),modifiersClassNames:br(br({},n.modifiersClassNames),r.modifiersClassNames),onSelect:c,styles:br(br({},n.styles),r.styles),toDate:o});return s.jsx(kq.Provider,{value:d,children:e.children})}function Wn(){var e=x.useContext(kq);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function Eq(e){var t=Wn(),r=t.locale,n=t.classNames,a=t.styles,i=t.formatters.formatCaption;return s.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:i(e.displayMonth,{locale:r})})}function Sme(e){return s.jsx("svg",br({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:s.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Cq(e){var t,r,n=e.onChange,a=e.value,i=e.children,o=e.caption,l=e.className,c=e.style,d=Wn(),u=(r=(t=d.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:Sme;return s.jsxs("div",{className:l,style:c,children:[s.jsx("span",{className:d.classNames.vhidden,children:e["aria-label"]}),s.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:d.classNames.dropdown,style:d.styles.dropdown,value:a,onChange:n,children:i}),s.jsxs("div",{className:d.classNames.caption_label,style:d.styles.caption_label,"aria-hidden":"true",children:[o,s.jsx(u,{className:d.classNames.dropdown_icon,style:d.styles.dropdown_icon})]})]})}function kme(e){var t,r=Wn(),n=r.fromDate,a=r.toDate,i=r.styles,o=r.locale,l=r.formatters.formatMonthCaption,c=r.classNames,d=r.components,u=r.labels.labelMonthDropdown;if(!n)return s.jsx(s.Fragment,{});if(!a)return s.jsx(s.Fragment,{});var f=[];if(Bce(n,a))for(var h=pi(n),p=n.getMonth();p<=a.getMonth();p++)f.push(qN(h,p));else for(var h=pi(new Date),p=0;p<=11;p++)f.push(qN(h,p));var g=function(y){var _=Number(y.target.value),w=qN(pi(e.displayMonth),_);e.onChange(w)},v=(t=d==null?void 0:d.Dropdown)!==null&&t!==void 0?t:Cq;return s.jsx(v,{name:"months","aria-label":u(),className:c.dropdown_month,style:i.dropdown_month,onChange:g,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:o}),children:f.map(function(y){return s.jsx("option",{value:y.getMonth(),children:l(y,{locale:o})},y.getMonth())})})}function Eme(e){var t,r=e.displayMonth,n=Wn(),a=n.fromDate,i=n.toDate,o=n.locale,l=n.styles,c=n.classNames,d=n.components,u=n.formatters.formatYearCaption,f=n.labels.labelYearDropdown,h=[];if(!a)return s.jsx(s.Fragment,{});if(!i)return s.jsx(s.Fragment,{});for(var p=a.getFullYear(),g=i.getFullYear(),v=p;v<=g;v++)h.push(j5(R8(new Date),v));var y=function(w){var b=j5(pi(r),Number(w.target.value));e.onChange(b)},_=(t=d==null?void 0:d.Dropdown)!==null&&t!==void 0?t:Cq;return s.jsx(_,{name:"years","aria-label":f(),className:c.dropdown_year,style:l.dropdown_year,onChange:y,value:r.getFullYear(),caption:u(r,{locale:o}),children:h.map(function(w){return s.jsx("option",{value:w.getFullYear(),children:u(w,{locale:o})},w.getFullYear())})})}function Cme(e,t){var r=x.useState(e),n=r[0],a=r[1],i=t===void 0?n:t;return[i,a]}function Pme(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,i=e.toDate,o=e.fromDate,l=e.numberOfMonths,c=l===void 0?1:l;if(i&&jm(i,a)<0){var d=-1*(c-1);a=Go(i,d)}return o&&jm(a,o)<0&&(a=o),pi(a)}function Tme(){var e=Wn(),t=Pme(e),r=Cme(t,e.month),n=r[0],a=r[1],i=function(o){var l;if(!e.disableNavigation){var c=pi(o);a(c),(l=e.onMonthChange)===null||l===void 0||l.call(e,c)}};return[n,i]}function Ame(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=pi(e),i=pi(Go(a,n)),o=jm(i,a),l=[],c=0;c<o;c++){var d=Go(a,c);l.push(d)}return r&&(l=l.reverse()),l}function Rme(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,i=a===void 0?1:a,o=n?i:1,l=pi(e);if(!r)return Go(l,o);var c=jm(r,e);if(!(c<i))return Go(l,o)}}function Ome(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,i=a===void 0?1:a,o=n?i:1,l=pi(e);if(!r)return Go(l,-o);var c=jm(l,r);if(!(c<=0))return Go(l,-o)}}var Pq=x.createContext(void 0);function Mme(e){var t=Wn(),r=Tme(),n=r[0],a=r[1],i=Ame(n,t),o=Rme(n,t),l=Ome(n,t),c=function(f){return i.some(function(h){return iT(f,h)})},d=function(f,h){c(f)||(h&&L8(f,h)?a(Go(f,1+t.numberOfMonths*-1)):a(f))},u={currentMonth:n,displayMonths:i,goToMonth:a,goToDate:d,previousMonth:l,nextMonth:o,isDateDisplayed:c};return s.jsx(Pq.Provider,{value:u,children:e.children})}function sx(){var e=x.useContext(Pq);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function $5(e){var t,r=Wn(),n=r.classNames,a=r.styles,i=r.components,o=sx().goToMonth,l=function(u){o(Go(u,e.displayIndex?-e.displayIndex:0))},c=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:Eq,d=s.jsx(c,{id:e.id,displayMonth:e.displayMonth});return s.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[s.jsx("div",{className:n.vhidden,children:d}),s.jsx(kme,{onChange:l,displayMonth:e.displayMonth}),s.jsx(Eme,{onChange:l,displayMonth:e.displayMonth})]})}function Dme(e){return s.jsx("svg",br({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:s.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Ime(e){return s.jsx("svg",br({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:s.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var dw=x.forwardRef(function(e,t){var r=Wn(),n=r.classNames,a=r.styles,i=[n.button_reset,n.button];e.className&&i.push(e.className);var o=i.join(" "),l=br(br({},a.button_reset),a.button);return e.style&&Object.assign(l,e.style),s.jsx("button",br({},e,{ref:t,type:"button",className:o,style:l}))});function $me(e){var t,r,n=Wn(),a=n.dir,i=n.locale,o=n.classNames,l=n.styles,c=n.labels,d=c.labelPrevious,u=c.labelNext,f=n.components;if(!e.nextMonth&&!e.previousMonth)return s.jsx(s.Fragment,{});var h=d(e.previousMonth,{locale:i}),p=[o.nav_button,o.nav_button_previous].join(" "),g=u(e.nextMonth,{locale:i}),v=[o.nav_button,o.nav_button_next].join(" "),y=(t=f==null?void 0:f.IconRight)!==null&&t!==void 0?t:Ime,_=(r=f==null?void 0:f.IconLeft)!==null&&r!==void 0?r:Dme;return s.jsxs("div",{className:o.nav,style:l.nav,children:[!e.hidePrevious&&s.jsx(dw,{name:"previous-month","aria-label":h,className:p,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?s.jsx(y,{className:o.nav_icon,style:l.nav_icon}):s.jsx(_,{className:o.nav_icon,style:l.nav_icon})}),!e.hideNext&&s.jsx(dw,{name:"next-month","aria-label":g,className:v,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?s.jsx(_,{className:o.nav_icon,style:l.nav_icon}):s.jsx(y,{className:o.nav_icon,style:l.nav_icon})})]})}function L5(e){var t=Wn().numberOfMonths,r=sx(),n=r.previousMonth,a=r.nextMonth,i=r.goToMonth,o=r.displayMonths,l=o.findIndex(function(g){return iT(e.displayMonth,g)}),c=l===0,d=l===o.length-1,u=t>1&&(c||!d),f=t>1&&(d||!c),h=function(){n&&i(n)},p=function(){a&&i(a)};return s.jsx($me,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:f,nextMonth:a,previousMonth:n,onPreviousClick:h,onNextClick:p})}function Lme(e){var t,r=Wn(),n=r.classNames,a=r.disableNavigation,i=r.styles,o=r.captionLayout,l=r.components,c=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:Eq,d;return a?d=s.jsx(c,{id:e.id,displayMonth:e.displayMonth}):o==="dropdown"?d=s.jsx($5,{displayMonth:e.displayMonth,id:e.id}):o==="dropdown-buttons"?d=s.jsxs(s.Fragment,{children:[s.jsx($5,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),s.jsx(L5,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):d=s.jsxs(s.Fragment,{children:[s.jsx(c,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),s.jsx(L5,{displayMonth:e.displayMonth,id:e.id})]}),s.jsx("div",{className:n.caption,style:i.caption,children:d})}function Fme(e){var t=Wn(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?s.jsx("tfoot",{className:a,style:n.tfoot,children:s.jsx("tr",{children:s.jsx("td",{colSpan:8,children:r})})}):s.jsx(s.Fragment,{})}function zme(e,t,r){for(var n=r?lh(new Date):uo(new Date,{locale:e,weekStartsOn:t}),a=[],i=0;i<7;i++){var o=Qs(n,i);a.push(o)}return a}function Bme(){var e=Wn(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,i=e.weekStartsOn,o=e.ISOWeek,l=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,d=zme(a,i,o);return s.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&s.jsx("td",{style:r.head_cell,className:t.head_cell}),d.map(function(u,f){return s.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":c(u,{locale:a}),children:l(u,{locale:a})},f)})]})}function Ume(){var e,t=Wn(),r=t.classNames,n=t.styles,a=t.components,i=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:Bme;return s.jsx("thead",{style:n.head,className:r.head,children:s.jsx(i,{})})}function qme(e){var t=Wn(),r=t.locale,n=t.formatters.formatDay;return s.jsx(s.Fragment,{children:n(e.date,{locale:r})})}var IT=x.createContext(void 0);function Vme(e){if(!rx(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return s.jsx(IT.Provider,{value:t,children:e.children})}return s.jsx(Wme,{initialProps:e.initialProps,children:e.children})}function Wme(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,i=t.max,o=function(d,u,f){var h,p;(h=t.onDayClick)===null||h===void 0||h.call(t,d,u,f);var g=!!(u.selected&&a&&(n==null?void 0:n.length)===a);if(!g){var v=!!(!u.selected&&i&&(n==null?void 0:n.length)===i);if(!v){var y=n?Sq([],n):[];if(u.selected){var _=y.findIndex(function(w){return Aa(d,w)});y.splice(_,1)}else y.push(d);(p=t.onSelect)===null||p===void 0||p.call(t,y,d,u,f)}}},l={disabled:[]};n&&l.disabled.push(function(d){var u=i&&n.length>i-1,f=n.some(function(h){return Aa(h,d)});return!!(u&&!f)});var c={selected:n,onDayClick:o,modifiers:l};return s.jsx(IT.Provider,{value:c,children:r})}function $T(){var e=x.useContext(IT);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function Hme(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?Aa(a,e)&&Aa(n,e)?void 0:Aa(a,e)?{from:a,to:void 0}:Aa(n,e)?void 0:v2(n,e)?{from:e,to:a}:{from:n,to:e}:a?v2(e,a)?{from:a,to:e}:{from:e,to:a}:n?L8(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var LT=x.createContext(void 0);function Gme(e){if(!nx(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return s.jsx(LT.Provider,{value:t,children:e.children})}return s.jsx(Yme,{initialProps:e.initialProps,children:e.children})}function Yme(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},i=a.from,o=a.to,l=t.min,c=t.max,d=function(p,g,v){var y,_;(y=t.onDayClick)===null||y===void 0||y.call(t,p,g,v);var w=Hme(p,n);(_=t.onSelect)===null||_===void 0||_.call(t,w,p,g,v)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(u.range_start=[i],o?(u.range_end=[o],Aa(i,o)||(u.range_middle=[{after:i,before:o}])):u.range_end=[i]):o&&(u.range_start=[o],u.range_end=[o]),l&&(i&&!o&&u.disabled.push({after:Qg(i,l-1),before:Qs(i,l-1)}),i&&o&&u.disabled.push({after:i,before:Qs(i,l-1)}),!i&&o&&u.disabled.push({after:Qg(o,l-1),before:Qs(o,l-1)})),c){if(i&&!o&&(u.disabled.push({before:Qs(i,-c+1)}),u.disabled.push({after:Qs(i,c-1)})),i&&o){var f=xl(o,i)+1,h=c-f;u.disabled.push({before:Qg(i,h)}),u.disabled.push({after:Qs(o,h)})}!i&&o&&(u.disabled.push({before:Qs(o,-c+1)}),u.disabled.push({after:Qs(o,c-1)}))}return s.jsx(LT.Provider,{value:{selected:n,onDayClick:d,modifiers:u},children:r})}function FT(){var e=x.useContext(LT);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function u_(e){return Array.isArray(e)?Sq([],e):e!==void 0?[e]:[]}function Kme(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=u_(a)}),t}var Ko;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Ko||(Ko={}));var Zme=Ko.Selected,Xl=Ko.Disabled,Xme=Ko.Hidden,Jme=Ko.Today,ZN=Ko.RangeEnd,XN=Ko.RangeMiddle,JN=Ko.RangeStart,Qme=Ko.Outside;function epe(e,t,r){var n,a=(n={},n[Zme]=u_(e.selected),n[Xl]=u_(e.disabled),n[Xme]=u_(e.hidden),n[Jme]=[e.today],n[ZN]=[],n[XN]=[],n[JN]=[],n[Qme]=[],n);return e.fromDate&&a[Xl].push({before:e.fromDate}),e.toDate&&a[Xl].push({after:e.toDate}),rx(e)?a[Xl]=a[Xl].concat(t.modifiers[Xl]):nx(e)&&(a[Xl]=a[Xl].concat(r.modifiers[Xl]),a[JN]=r.modifiers[JN],a[XN]=r.modifiers[XN],a[ZN]=r.modifiers[ZN]),a}var Tq=x.createContext(void 0);function tpe(e){var t=Wn(),r=$T(),n=FT(),a=epe(t,r,n),i=Kme(t.modifiers),o=br(br({},a),i);return s.jsx(Tq.Provider,{value:o,children:e.children})}function Aq(){var e=x.useContext(Tq);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function rpe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function npe(e){return!!(e&&typeof e=="object"&&"from"in e)}function spe(e){return!!(e&&typeof e=="object"&&"after"in e)}function ape(e){return!!(e&&typeof e=="object"&&"before"in e)}function ipe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function ope(e,t){var r,n=t.from,a=t.to;if(n&&a){var i=xl(a,n)<0;i&&(r=[a,n],n=r[0],a=r[1]);var o=xl(e,n)>=0&&xl(a,e)>=0;return o}return a?Aa(a,e):n?Aa(n,e):!1}function lpe(e){return nT(e)}function cpe(e){return Array.isArray(e)&&e.every(nT)}function dpe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(lpe(r))return Aa(e,r);if(cpe(r))return r.includes(e);if(npe(r))return ope(e,r);if(ipe(r))return r.dayOfWeek.includes(e.getDay());if(rpe(r)){var n=xl(r.before,e),a=xl(r.after,e),i=n>0,o=a<0,l=v2(r.before,r.after);return l?o&&i:i||o}return spe(r)?xl(e,r.after)>0:ape(r)?xl(r.before,e)>0:typeof r=="function"?r(e):!1})}function zT(e,t,r){var n=Object.keys(t).reduce(function(i,o){var l=t[o];return dpe(e,l)&&i.push(o),i},[]),a={};return n.forEach(function(i){return a[i]=!0}),r&&!iT(e,r)&&(a.outside=!0),a}function upe(e,t){for(var r=pi(e[0]),n=u1(e[e.length-1]),a,i,o=r;o<=n;){var l=zT(o,t),c=!l.disabled&&!l.hidden;if(!c){o=Qs(o,1);continue}if(l.selected)return o;l.today&&!i&&(i=o),a||(a=o),o=Qs(o,1)}return i||a}var hpe=365;function Rq(e,t){var r=t.moveBy,n=t.direction,a=t.context,i=t.modifiers,o=t.retry,l=o===void 0?{count:0,lastFocused:e}:o,c=a.weekStartsOn,d=a.fromDate,u=a.toDate,f=a.locale,h={day:Qs,week:p2,month:Go,year:Ale,startOfWeek:function(y){return a.ISOWeek?lh(y):uo(y,{locale:f,weekStartsOn:c})},endOfWeek:function(y){return a.ISOWeek?O8(y):sT(y,{locale:f,weekStartsOn:c})}},p=h[r](e,n==="after"?1:-1);n==="before"&&d?p=Rle([d,p]):n==="after"&&u&&(p=Ole([u,p]));var g=!0;if(i){var v=zT(p,i);g=!v.disabled&&!v.hidden}return g?p:l.count>hpe?l.lastFocused:Rq(p,{moveBy:r,direction:n,context:a,modifiers:i,retry:br(br({},l),{count:l.count+1})})}var Oq=x.createContext(void 0);function fpe(e){var t=sx(),r=Aq(),n=x.useState(),a=n[0],i=n[1],o=x.useState(),l=o[0],c=o[1],d=upe(t.displayMonths,r),u=(a!=null?a:l&&t.isDateDisplayed(l))?l:d,f=function(){c(a),i(void 0)},h=function(y){i(y)},p=Wn(),g=function(y,_){if(a){var w=Rq(a,{moveBy:y,direction:_,context:p,modifiers:r});Aa(a,w)||(t.goToDate(w,a),h(w))}},v={focusedDay:a,focusTarget:u,blur:f,focus:h,focusDayAfter:function(){return g("day","after")},focusDayBefore:function(){return g("day","before")},focusWeekAfter:function(){return g("week","after")},focusWeekBefore:function(){return g("week","before")},focusMonthBefore:function(){return g("month","before")},focusMonthAfter:function(){return g("month","after")},focusYearBefore:function(){return g("year","before")},focusYearAfter:function(){return g("year","after")},focusStartOfWeek:function(){return g("startOfWeek","before")},focusEndOfWeek:function(){return g("endOfWeek","after")}};return s.jsx(Oq.Provider,{value:v,children:e.children})}function BT(){var e=x.useContext(Oq);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function mpe(e,t){var r=Aq(),n=zT(e,r,t);return n}var UT=x.createContext(void 0);function ppe(e){if(!D1(e.initialProps)){var t={selected:void 0};return s.jsx(UT.Provider,{value:t,children:e.children})}return s.jsx(gpe,{initialProps:e.initialProps,children:e.children})}function gpe(e){var t=e.initialProps,r=e.children,n=function(i,o,l){var c,d,u;if((c=t.onDayClick)===null||c===void 0||c.call(t,i,o,l),o.selected&&!t.required){(d=t.onSelect)===null||d===void 0||d.call(t,void 0,i,o,l);return}(u=t.onSelect)===null||u===void 0||u.call(t,i,i,o,l)},a={selected:t.selected,onDayClick:n};return s.jsx(UT.Provider,{value:a,children:r})}function Mq(){var e=x.useContext(UT);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function vpe(e,t){var r=Wn(),n=Mq(),a=$T(),i=FT(),o=BT(),l=o.focusDayAfter,c=o.focusDayBefore,d=o.focusWeekAfter,u=o.focusWeekBefore,f=o.blur,h=o.focus,p=o.focusMonthBefore,g=o.focusMonthAfter,v=o.focusYearBefore,y=o.focusYearAfter,_=o.focusStartOfWeek,w=o.focusEndOfWeek,b=function(G){var q,K,Z,Y;D1(r)?(q=n.onDayClick)===null||q===void 0||q.call(n,e,t,G):rx(r)?(K=a.onDayClick)===null||K===void 0||K.call(a,e,t,G):nx(r)?(Z=i.onDayClick)===null||Z===void 0||Z.call(i,e,t,G):(Y=r.onDayClick)===null||Y===void 0||Y.call(r,e,t,G)},N=function(G){var q;h(e),(q=r.onDayFocus)===null||q===void 0||q.call(r,e,t,G)},S=function(G){var q;f(),(q=r.onDayBlur)===null||q===void 0||q.call(r,e,t,G)},k=function(G){var q;(q=r.onDayMouseEnter)===null||q===void 0||q.call(r,e,t,G)},P=function(G){var q;(q=r.onDayMouseLeave)===null||q===void 0||q.call(r,e,t,G)},A=function(G){var q;(q=r.onDayPointerEnter)===null||q===void 0||q.call(r,e,t,G)},R=function(G){var q;(q=r.onDayPointerLeave)===null||q===void 0||q.call(r,e,t,G)},$=function(G){var q;(q=r.onDayTouchCancel)===null||q===void 0||q.call(r,e,t,G)},O=function(G){var q;(q=r.onDayTouchEnd)===null||q===void 0||q.call(r,e,t,G)},z=function(G){var q;(q=r.onDayTouchMove)===null||q===void 0||q.call(r,e,t,G)},D=function(G){var q;(q=r.onDayTouchStart)===null||q===void 0||q.call(r,e,t,G)},B=function(G){var q;(q=r.onDayKeyUp)===null||q===void 0||q.call(r,e,t,G)},F=function(G){var q;switch(G.key){case"ArrowLeft":G.preventDefault(),G.stopPropagation(),r.dir==="rtl"?l():c();break;case"ArrowRight":G.preventDefault(),G.stopPropagation(),r.dir==="rtl"?c():l();break;case"ArrowDown":G.preventDefault(),G.stopPropagation(),d();break;case"ArrowUp":G.preventDefault(),G.stopPropagation(),u();break;case"PageUp":G.preventDefault(),G.stopPropagation(),G.shiftKey?v():p();break;case"PageDown":G.preventDefault(),G.stopPropagation(),G.shiftKey?y():g();break;case"Home":G.preventDefault(),G.stopPropagation(),_();break;case"End":G.preventDefault(),G.stopPropagation(),w();break}(q=r.onDayKeyDown)===null||q===void 0||q.call(r,e,t,G)},U={onClick:b,onFocus:N,onBlur:S,onKeyDown:F,onKeyUp:B,onMouseEnter:k,onMouseLeave:P,onPointerEnter:A,onPointerLeave:R,onTouchCancel:$,onTouchEnd:O,onTouchMove:z,onTouchStart:D};return U}function ype(){var e=Wn(),t=Mq(),r=$T(),n=FT(),a=D1(e)?t.selected:rx(e)?r.selected:nx(e)?n.selected:void 0;return a}function xpe(e){return Object.values(Ko).includes(e)}function _pe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if(xpe(n)){var i=e.classNames["day_".concat(n)];i&&r.push(i)}}),r}function wpe(e,t){var r=br({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=br(br({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function bpe(e,t,r){var n,a,i,o=Wn(),l=BT(),c=mpe(e,t),d=vpe(e,c),u=ype(),f=!!(o.onDayClick||o.mode!=="default");x.useEffect(function(){var k;c.outside||l.focusedDay&&f&&Aa(l.focusedDay,e)&&((k=r.current)===null||k===void 0||k.focus())},[l.focusedDay,e,r,f,c.outside]);var h=_pe(o,c).join(" "),p=wpe(o,c),g=!!(c.outside&&!o.showOutsideDays||c.hidden),v=(i=(a=o.components)===null||a===void 0?void 0:a.DayContent)!==null&&i!==void 0?i:qme,y=s.jsx(v,{date:e,displayMonth:t,activeModifiers:c}),_={style:p,className:h,children:y,role:"gridcell"},w=l.focusTarget&&Aa(l.focusTarget,e)&&!c.outside,b=l.focusedDay&&Aa(l.focusedDay,e),N=br(br(br({},_),(n={disabled:c.disabled,role:"gridcell"},n["aria-selected"]=c.selected,n.tabIndex=b||w?0:-1,n)),d),S={isButton:f,isHidden:g,activeModifiers:c,selectedDays:u,buttonProps:N,divProps:_};return S}function jpe(e){var t=x.useRef(null),r=bpe(e.date,e.displayMonth,t);return r.isHidden?s.jsx("div",{role:"gridcell"}):r.isButton?s.jsx(dw,br({name:"day",ref:t},r.buttonProps)):s.jsx("div",br({},r.divProps))}function Npe(e){var t=e.number,r=e.dates,n=Wn(),a=n.onWeekNumberClick,i=n.styles,o=n.classNames,l=n.locale,c=n.labels.labelWeekNumber,d=n.formatters.formatWeekNumber,u=d(Number(t),{locale:l});if(!a)return s.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:u});var f=c(Number(t),{locale:l}),h=function(p){a(t,r,p)};return s.jsx(dw,{name:"week-number","aria-label":f,className:o.weeknumber,style:i.weeknumber,onClick:h,children:u})}function Spe(e){var t,r,n=Wn(),a=n.styles,i=n.classNames,o=n.showWeekNumber,l=n.components,c=(t=l==null?void 0:l.Day)!==null&&t!==void 0?t:jpe,d=(r=l==null?void 0:l.WeekNumber)!==null&&r!==void 0?r:Npe,u;return o&&(u=s.jsx("td",{className:i.cell,style:a.cell,children:s.jsx(d,{number:e.weekNumber,dates:e.dates})})),s.jsxs("tr",{className:i.row,style:a.row,children:[u,e.dates.map(function(f){return s.jsx("td",{className:i.cell,style:a.cell,role:"presentation",children:s.jsx(c,{displayMonth:e.displayMonth,date:f})},$ce(f))})]})}function F5(e,t,r){for(var n=r!=null&&r.ISOWeek?O8(t):sT(t,r),a=r!=null&&r.ISOWeek?lh(e):uo(e,r),i=xl(n,a),o=[],l=0;l<=i;l++)o.push(Qs(a,l));var c=o.reduce(function(d,u){var f=r!=null&&r.ISOWeek?M8(u):I8(u,r),h=d.find(function(p){return p.weekNumber===f});return h?(h.dates.push(u),d):(d.push({weekNumber:f,dates:[u]}),d)},[]);return c}function kpe(e,t){var r=F5(pi(e),u1(e),t);if(t!=null&&t.useFixedWeeks){var n=Fce(e,t);if(n<6){var a=r[r.length-1],i=a.dates[a.dates.length-1],o=p2(i,6-n),l=F5(p2(i,1),o,t);r.push.apply(r,l)}}return r}function Epe(e){var t,r,n,a=Wn(),i=a.locale,o=a.classNames,l=a.styles,c=a.hideHead,d=a.fixedWeeks,u=a.components,f=a.weekStartsOn,h=a.firstWeekContainsDate,p=a.ISOWeek,g=kpe(e.displayMonth,{useFixedWeeks:!!d,ISOWeek:p,locale:i,weekStartsOn:f,firstWeekContainsDate:h}),v=(t=u==null?void 0:u.Head)!==null&&t!==void 0?t:Ume,y=(r=u==null?void 0:u.Row)!==null&&r!==void 0?r:Spe,_=(n=u==null?void 0:u.Footer)!==null&&n!==void 0?n:Fme;return s.jsxs("table",{id:e.id,className:o.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!c&&s.jsx(v,{}),s.jsx("tbody",{className:o.tbody,style:l.tbody,children:g.map(function(w){return s.jsx(y,{displayMonth:e.displayMonth,dates:w.dates,weekNumber:w.weekNumber},w.weekNumber)})}),s.jsx(_,{displayMonth:e.displayMonth})]})}function Cpe(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}var Ppe=Cpe()?x.useLayoutEffect:x.useEffect,QN=!1,Tpe=0;function z5(){return"react-day-picker-".concat(++Tpe)}function Ape(e){var t,r=e!=null?e:QN?z5():null,n=x.useState(r),a=n[0],i=n[1];return Ppe(function(){a===null&&i(z5())},[]),x.useEffect(function(){QN===!1&&(QN=!0)},[]),(t=e!=null?e:a)!==null&&t!==void 0?t:void 0}function Rpe(e){var t,r,n=Wn(),a=n.dir,i=n.classNames,o=n.styles,l=n.components,c=sx().displayMonths,d=Ape(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),u=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,f=[i.month],h=o.month,p=e.displayIndex===0,g=e.displayIndex===c.length-1,v=!p&&!g;a==="rtl"&&(t=[p,g],g=t[0],p=t[1]),p&&(f.push(i.caption_start),h=br(br({},h),o.caption_start)),g&&(f.push(i.caption_end),h=br(br({},h),o.caption_end)),v&&(f.push(i.caption_between),h=br(br({},h),o.caption_between));var y=(r=l==null?void 0:l.Caption)!==null&&r!==void 0?r:Lme;return s.jsxs("div",{className:f.join(" "),style:h,children:[s.jsx(y,{id:d,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),s.jsx(Epe,{id:u,"aria-labelledby":d,displayMonth:e.displayMonth})]},e.displayIndex)}function Ope(e){var t=Wn(),r=t.classNames,n=t.styles;return s.jsx("div",{className:r.months,style:n.months,children:e.children})}function Mpe(e){var t,r,n=e.initialProps,a=Wn(),i=BT(),o=sx(),l=x.useState(!1),c=l[0],d=l[1];x.useEffect(function(){a.initialFocus&&i.focusTarget&&(c||(i.focus(i.focusTarget),d(!0)))},[a.initialFocus,c,i.focus,i.focusTarget,i]);var u=[a.classNames.root,a.className];a.numberOfMonths>1&&u.push(a.classNames.multiple_months),a.showWeekNumber&&u.push(a.classNames.with_weeknumber);var f=br(br({},a.styles.root),a.style),h=Object.keys(n).filter(function(g){return g.startsWith("data-")}).reduce(function(g,v){var y;return br(br({},g),(y={},y[v]=n[v],y))},{}),p=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:Ope;return s.jsx("div",br({className:u.join(" "),style:f,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},h,{children:s.jsx(p,{children:o.displayMonths.map(function(g,v){return s.jsx(Rpe,{displayIndex:v,displayMonth:g},v)})})}))}function Dpe(e){var t=e.children,r=ame(e,["children"]);return s.jsx(Nme,{initialProps:r,children:s.jsx(Mme,{children:s.jsx(ppe,{initialProps:r,children:s.jsx(Vme,{initialProps:r,children:s.jsx(Gme,{initialProps:r,children:s.jsx(tpe,{children:s.jsx(fpe,{children:t})})})})})})})}function Ipe(e){return s.jsx(Dpe,br({},e,{children:s.jsx(Mpe,{initialProps:e})}))}function ax(a){var i=a,{className:e,classNames:t,showOutsideDays:r=!0}=i,n=me(i,["className","classNames","showOutsideDays"]);return s.jsx(Ipe,M({showOutsideDays:r,className:ke("p-3",e),classNames:M({months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"",nav:"space-x-1 flex items-center",nav_button:"h-7 w-7 bg-transparent p-0",nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"rounded-md w-9",row:"flex w-full mt-2",cell:"h-9 w-9 text-center p-0 relative focus-within:relative focus-within:z-20",day:"h-9 w-9 p-0 aria-selected:opacity-100",day_range_end:"day-range-end",day_selected:"",day_today:"",day_outside:"day-outside",day_disabled:"",day_range_middle:"",day_hidden:"invisible"},t),styles:{caption_label:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},nav_button:{backgroundColor:"transparent",border:"none",boxShadow:"none",outline:"none",color:"var(--neutral-900)"},head_cell:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},day:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)",backgroundColor:"transparent",border:"none"}},modifiersStyles:{selected:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},today:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},disabled:{color:"var(--neutral-400)"},outside:{color:"var(--neutral-400)"}},components:{IconLeft:l=>{var o=me(l,[]);return s.jsx(pP,{size:16,style:{color:"var(--neutral-900)"}})},IconRight:l=>{var o=me(l,[]);return s.jsx(Dy,{size:16,style:{color:"var(--neutral-900)"}})}}},n))}ax.displayName="Calendar";var I1="Popover",[Dq,MBe]=Os(I1,[Zd]),ix=Zd(),[$pe,tu]=Dq(I1),Iq=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:o=!1}=e,l=ix(t),c=x.useRef(null),[d,u]=x.useState(!1),[f,h]=Wa({prop:n,defaultProp:a!=null?a:!1,onChange:i,caller:I1});return s.jsx(Bb,H(M({},l),{children:s.jsx($pe,{scope:t,contentId:Ps(),triggerRef:c,open:f,onOpenChange:h,onOpenToggle:x.useCallback(()=>h(p=>!p),[h]),hasCustomAnchor:d,onCustomAnchorAdd:x.useCallback(()=>u(!0),[]),onCustomAnchorRemove:x.useCallback(()=>u(!1),[]),modal:o,children:r})}))};Iq.displayName=I1;var $q="PopoverAnchor",Lpe=x.forwardRef((e,t)=>{const c=e,{__scopePopover:r}=c,n=me(c,["__scopePopover"]),a=tu($q,r),i=ix(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=a;return x.useEffect(()=>(o(),()=>l()),[o,l]),s.jsx(Ly,H(M(M({},i),n),{ref:t}))});Lpe.displayName=$q;var Lq="PopoverTrigger",Fq=x.forwardRef((e,t)=>{const c=e,{__scopePopover:r}=c,n=me(c,["__scopePopover"]),a=tu(Lq,r),i=ix(r),o=cr(t,a.triggerRef),l=s.jsx(Ct.button,H(M({type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Vq(a.open)},n),{ref:o,onClick:pt(e.onClick,a.onOpenToggle)}));return a.hasCustomAnchor?l:s.jsx(Ly,H(M({asChild:!0},i),{children:l}))});Fq.displayName=Lq;var qT="PopoverPortal",[Fpe,zpe]=Dq(qT,{forceMount:void 0}),zq=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,i=tu(qT,t);return s.jsx(Fpe,{scope:t,forceMount:r,children:s.jsx(Ys,{present:r||i.open,children:s.jsx(op,{asChild:!0,container:a,children:n})})})};zq.displayName=qT;var Sm="PopoverContent",Bq=x.forwardRef((e,t)=>{const r=zpe(Sm,e.__scopePopover),o=e,{forceMount:n=r.forceMount}=o,a=me(o,["forceMount"]),i=tu(Sm,e.__scopePopover);return s.jsx(Ys,{present:n||i.open,children:i.modal?s.jsx(Upe,H(M({},a),{ref:t})):s.jsx(qpe,H(M({},a),{ref:t}))})});Bq.displayName=Sm;var Bpe=$d("PopoverContent.RemoveScroll"),Upe=x.forwardRef((e,t)=>{const r=tu(Sm,e.__scopePopover),n=x.useRef(null),a=cr(t,n),i=x.useRef(!1);return x.useEffect(()=>{const o=n.current;if(o)return n1(o)},[]),s.jsx(Vy,{as:Bpe,allowPinchZoom:!0,children:s.jsx(Uq,H(M({},e),{ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:pt(e.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:pt(e.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;i.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:pt(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})}))})}),qpe=x.forwardRef((e,t)=>{const r=tu(Sm,e.__scopePopover),n=x.useRef(!1),a=x.useRef(!1);return s.jsx(Uq,H(M({},e),{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var c,d;(c=e.onInteractOutside)==null||c.call(e,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((d=r.triggerRef.current)==null?void 0:d.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}}))}),Uq=x.forwardRef((e,t)=>{const g=e,{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u}=g,f=me(g,["__scopePopover","trapFocus","onOpenAutoFocus","onCloseAutoFocus","disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside"]),h=tu(Sm,r),p=ix(r);return t1(),s.jsx(qy,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:s.jsx(wh,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>h.onOpenChange(!1),children:s.jsx(Ub,H(M(M({"data-state":Vq(h.open),role:"dialog",id:h.contentId},p),f),{ref:t,style:H(M({},f.style),{"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"})}))})})}),qq="PopoverClose",Vpe=x.forwardRef((e,t)=>{const i=e,{__scopePopover:r}=i,n=me(i,["__scopePopover"]),a=tu(qq,r);return s.jsx(Ct.button,H(M({type:"button"},n),{ref:t,onClick:pt(e.onClick,()=>a.onOpenChange(!1))}))});Vpe.displayName=qq;var Wpe="PopoverArrow",Hpe=x.forwardRef((e,t)=>{const i=e,{__scopePopover:r}=i,n=me(i,["__scopePopover"]),a=ix(r);return s.jsx(qb,H(M(M({},a),n),{ref:t}))});Hpe.displayName=Wpe;function Vq(e){return e?"open":"closed"}var Gpe=Iq,Ype=Fq,Kpe=zq,Wq=Bq;const fc=Gpe,mc=Ype,wl=x.forwardRef((i,a)=>{var o=i,{className:e,align:t="center",sideOffset:r=4}=o,n=me(o,["className","align","sideOffset"]);return s.jsx(Kpe,{children:s.jsx(Wq,M({ref:a,align:t,sideOffset:r,className:ke("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e)},n))})});wl.displayName=Wq.displayName;var $1="Checkbox",[Zpe,DBe]=Os($1),[Xpe,VT]=Zpe($1);function Jpe(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:a,disabled:i,form:o,name:l,onCheckedChange:c,required:d,value:u="on",internal_do_not_use_render:f}=e,[h,p]=Wa({prop:r,defaultProp:a!=null?a:!1,onChange:c,caller:$1}),[g,v]=x.useState(null),[y,_]=x.useState(null),w=x.useRef(!1),b=g?!!o||!!g.closest("form"):!0,N={checked:h,disabled:i,setChecked:p,control:g,setControl:v,name:l,form:o,value:u,hasConsumerStoppedPropagationRef:w,required:d,defaultChecked:Od(a)?!1:a,isFormControl:b,bubbleInput:y,setBubbleInput:_};return s.jsx(Xpe,H(M({scope:t},N),{children:Qpe(f)?f(N):n}))}var Hq="CheckboxTrigger",Gq=x.forwardRef((i,a)=>{var o=i,{__scopeCheckbox:e,onKeyDown:t,onClick:r}=o,n=me(o,["__scopeCheckbox","onKeyDown","onClick"]);const{control:l,value:c,disabled:d,checked:u,required:f,setControl:h,setChecked:p,hasConsumerStoppedPropagationRef:g,isFormControl:v,bubbleInput:y}=VT(Hq,e),_=cr(a,h),w=x.useRef(u);return x.useEffect(()=>{const b=l==null?void 0:l.form;if(b){const N=()=>p(w.current);return b.addEventListener("reset",N),()=>b.removeEventListener("reset",N)}},[l,p]),s.jsx(Ct.button,H(M({type:"button",role:"checkbox","aria-checked":Od(u)?"mixed":u,"aria-required":f,"data-state":Jq(u),"data-disabled":d?"":void 0,disabled:d,value:c},n),{ref:_,onKeyDown:pt(t,b=>{b.key==="Enter"&&b.preventDefault()}),onClick:pt(r,b=>{p(N=>Od(N)?!0:!N),y&&v&&(g.current=b.isPropagationStopped(),g.current||b.stopPropagation())})}))});Gq.displayName=Hq;var WT=x.forwardRef((e,t)=>{const h=e,{__scopeCheckbox:r,name:n,checked:a,defaultChecked:i,required:o,disabled:l,value:c,onCheckedChange:d,form:u}=h,f=me(h,["__scopeCheckbox","name","checked","defaultChecked","required","disabled","value","onCheckedChange","form"]);return s.jsx(Jpe,{__scopeCheckbox:r,checked:a,defaultChecked:i,disabled:l,required:o,onCheckedChange:d,name:n,form:u,value:c,internal_do_not_use_render:({isFormControl:p})=>s.jsxs(s.Fragment,{children:[s.jsx(Gq,H(M({},f),{ref:t,__scopeCheckbox:r})),p&&s.jsx(Xq,{__scopeCheckbox:r})]})})});WT.displayName=$1;var Yq="CheckboxIndicator",Kq=x.forwardRef((e,t)=>{const o=e,{__scopeCheckbox:r,forceMount:n}=o,a=me(o,["__scopeCheckbox","forceMount"]),i=VT(Yq,r);return s.jsx(Ys,{present:n||Od(i.checked)||i.checked===!0,children:s.jsx(Ct.span,H(M({"data-state":Jq(i.checked),"data-disabled":i.disabled?"":void 0},a),{ref:t,style:M({pointerEvents:"none"},e.style)}))})});Kq.displayName=Yq;var Zq="CheckboxBubbleInput",Xq=x.forwardRef((n,r)=>{var a=n,{__scopeCheckbox:e}=a,t=me(a,["__scopeCheckbox"]);const{control:i,hasConsumerStoppedPropagationRef:o,checked:l,defaultChecked:c,required:d,disabled:u,name:f,value:h,form:p,bubbleInput:g,setBubbleInput:v}=VT(Zq,e),y=cr(r,v),_=k1(l),w=zb(i);x.useEffect(()=>{const N=g;if(!N)return;const S=window.HTMLInputElement.prototype,P=Object.getOwnPropertyDescriptor(S,"checked").set,A=!o.current;if(_!==l&&P){const R=new Event("click",{bubbles:A});N.indeterminate=Od(l),P.call(N,Od(l)?!1:l),N.dispatchEvent(R)}},[g,_,l,o]);const b=x.useRef(Od(l)?!1:l);return s.jsx(Ct.input,H(M({type:"checkbox","aria-hidden":!0,defaultChecked:c!=null?c:b.current,required:d,disabled:u,name:f,value:h,form:p},t),{tabIndex:-1,ref:y,style:H(M(M({},t.style),w),{position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"})}))});Xq.displayName=Zq;function Qpe(e){return typeof e=="function"}function Od(e){return e==="indeterminate"}function Jq(e){return Od(e)?"indeterminate":e?"checked":"unchecked"}const uw=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(WT,H(M({ref:r,className:ke("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e)},t),{children:s.jsx(Kq,{className:ke("flex items-center justify-center text-current"),children:s.jsx(ta,{className:"h-4 w-4"})})}))});uw.displayName=WT.displayName;const ege=["Rock","Pop","Hip-Hop","Electronic","Jazz","Classical","Country","R&B","Reggae","Folk","Blues","Alternative","Indie","Punk","Metal","Funk","Soul","Gospel","Latin","World"],tge=({filters:e,onFiltersChange:t,availableGenres:r=ege,availableCities:n=[],className:a="",onOverlayChange:i,onClearVenueSelection:o})=>{var de,xe,ie;const[l,c]=x.useState(e.selectedCities||[]),[d,u]=x.useState(!1),[f,h]=x.useState(""),[p,g]=x.useState(!1),[v,y]=x.useState(!1),[_,w]=x.useState(""),[b,N]=x.useState([]),[S,k]=x.useState(!1),[P,A]=x.useState(!1);x.useEffect(()=>{if(e.selectedCities&&e.selectedCities.length>0){const se=Cf(e.selectedCities);(se.length!==e.selectedCities.length||!se.every((V,ue)=>V===e.selectedCities[ue]))&&t(H(M({},e),{selectedCities:se}))}},[e.selectedCities]),x.useEffect(()=>{v&&R()},[v]);const R=()=>E(void 0,null,function*(){k(!0);try{const{data:se,error:V}=yield T.rpc("get_available_cities_for_filter",{min_event_count:1,limit_count:500});if(V){console.warn("Error loading cities from database function, falling back to direct query:",V);const{data:ue,error:_e}=yield T.from("events").select("display_city, venue_state").not("display_city","is",null).gte("event_date",new Date().toISOString());if(_e)throw _e;const ae=new Map;(ue||[]).forEach(oe=>{var Xe,ge;const ce=(Xe=oe.display_city)==null?void 0:Xe.trim(),Ae=((ge=oe.venue_state)==null?void 0:ge.trim())||"",Be=`${ce}|${Ae}`;ce&&(ae.has(Be)||ae.set(Be,{state:Ae,count:0}),ae.get(Be).count++)});const we=Array.from(ae.entries()).map(([oe,ce])=>{const Ae=oe.split("|")[0];return{city:c_(Ae),state:ce.state,eventCount:ce.count}}).sort((oe,ce)=>ce.eventCount-oe.eventCount);N(we)}else{const ue=(se||[]).map(ce=>({city:ce.city_name,state:ce.state||"",eventCount:Number(ce.event_count)})),_e=ce=>{if(!ce)return"";const Ae=ce.trim().toUpperCase();return Ae==="DC"||Ae==="D.C."||Ae==="DISTRICT OF COLUMBIA"?"DC":ce.trim()},ae=ce=>{let Ae=ce.trim().toLowerCase();return Ae=Ae.replace(/\s+dc$/,""),Ae=Ae.replace(/\s+d\.c\.$/,""),Ae=Ae.replace(/\s+/g," "),Ae},we=new Map;ue.forEach(ce=>{const Ae=ae(ce.city),Be=_e(ce.state),Xe=`${Ae}|${Be}`;if(!we.has(Xe))we.set(Xe,ce);else{const ge=we.get(Xe);(ce.eventCount>ge.eventCount||ce.eventCount===ge.eventCount&&ce.state&&!ge.state)&&we.set(Xe,ce)}});const oe=Array.from(we.values()).map(ce=>H(M({},ce),{city:c_(ce.city)})).sort((ce,Ae)=>Ae.eventCount-ce.eventCount);N(oe)}}catch(se){console.error("Error loading cities:",se),N([])}finally{k(!1)}}),$=se=>{var ue,_e,ae,we;const V=((ue=se==null?void 0:se.genres)!=null?ue:p)||((_e=se==null?void 0:se.locations)!=null?_e:v)||((ae=se==null?void 0:se.date)!=null?ae:d)||((we=se==null?void 0:se.daysOfWeek)!=null?we:P);i&&i(V)},O=se=>{const V=e.genres.includes(se)?e.genres.filter(ue=>ue!==se):[...e.genres,se];t(H(M({},e),{genres:V}))},z=()=>{if(_.trim()&&!e.genres.includes(_.trim())){const se=[...e.genres,_.trim()];t(H(M({},e),{genres:se})),w("")}},D=se=>{se.key==="Enter"&&z()},B=()=>{const se=Cf(l);t(H(M({},e),{selectedCities:se}))},F=()=>{c([]),t(H(M({},e),{selectedCities:[]}))},U=se=>{const V={from:se.from?(()=>{const ue=new Date(se.from);return ue.setHours(0,0,0,0),ue})():void 0,to:se.to?(()=>{const ue=new Date(se.to);return ue.setHours(23,59,59,999),ue})():void 0};if(V.from&&!V.to){const ue=new Date(V.from);ue.setHours(23,59,59,999),V.to=ue}else if(!V.from&&V.to){const ue=new Date(V.to);ue.setHours(0,0,0,0),V.from=ue}t(H(M({},e),{dateRange:V})),V.from&&V.to&&u(!1)},G=()=>{t(H(M({},e),{dateRange:{from:void 0,to:void 0}}))},q=se=>{const V={from:(()=>{const ue=new Date(se.from);return ue.setHours(0,0,0,0),ue})(),to:(()=>{const ue=new Date(se.to);return ue.setHours(23,59,59,999),ue})()};t(H(M({},e),{dateRange:V})),u(!1)},K=()=>{if(!e.dateRange.from||!e.dateRange.to)return null;const se=ee(),V=e.dateRange.from,ue=e.dateRange.to,_e=oe=>{const ce=new Date(oe);return ce.setHours(0,0,0,0),ce.getTime()},ae=_e(V),we=_e(ue);return se.find(oe=>{const ce=_e(oe.value.from),Ae=_e(oe.value.to);return ce===ae&&Ae===we})},Z=se=>{const V=e.daysOfWeek.includes(se)?e.daysOfWeek.filter(ue=>ue!==se):[...e.daysOfWeek,se];t(H(M({},e),{daysOfWeek:V}))},Y=()=>{const se=[0,1,2,3,4];if(se.every(ue=>e.daysOfWeek.includes(ue)))t(H(M({},e),{daysOfWeek:e.daysOfWeek.filter(ue=>!se.includes(ue))}));else{const ue=[...new Set([...e.daysOfWeek,...se])];t(H(M({},e),{daysOfWeek:ue}))}},Q=()=>{const se=[5,6];if(se.every(ue=>e.daysOfWeek.includes(ue)))t(H(M({},e),{daysOfWeek:e.daysOfWeek.filter(ue=>!se.includes(ue))}));else{const ue=[...new Set([...e.daysOfWeek,...se])];t(H(M({},e),{daysOfWeek:ue}))}},X=()=>{t({genres:[],selectedCities:[],dateRange:{from:void 0,to:void 0},showFilters:e.showFilters,radiusMiles:e.radiusMiles,filterByFollowing:"all",daysOfWeek:[]}),c([]),o&&o()},ne=e.genres.length>0||e.selectedCities&&e.selectedCities.length>0||e.dateRange.from||e.dateRange.to||e.filterByFollowing==="following"||e.daysOfWeek.length>0;x.useMemo(()=>b.slice(0,10),[b]);const re=x.useMemo(()=>{const se=f.trim().toLowerCase(),V=b.length>0?b:(n||[]).map(ue=>({city:ue,state:"",eventCount:0}));return se?V.filter(ue=>{const _e=typeof ue=="string"?ue:ue.city,ae=typeof ue=="string"?"":ue.state,we=ra(_e),oe=ae.toLowerCase().trim(),ce=ra(se);return we.includes(ce)||oe.includes(ce)||_e.toLowerCase().includes(se)||ae.toLowerCase().includes(se)}):V},[b,n,f]),ye=()=>{if(e.dateRange.from&&e.dateRange.to){const se=e.dateRange.from.toDateString(),V=e.dateRange.to.toDateString();return se===V?Mt(e.dateRange.from,"MMM d, yyyy"):`${Mt(e.dateRange.from,"MMM d")} - ${Mt(e.dateRange.to,"MMM d")}`}else{if(e.dateRange.from)return Mt(e.dateRange.from,"MMM d, yyyy");if(e.dateRange.to)return`Until ${Mt(e.dateRange.to,"MMM d, yyyy")}`}return"Calendar"},ee=()=>{const se=new Date;se.setHours(0,0,0,0);const V=new Date(se);V.setHours(23,59,59,999);const ue=Qs(se,7);ue.setHours(23,59,59,999);const _e=Qs(se,30);_e.setHours(23,59,59,999);const ae=Qs(se,90);return ae.setHours(23,59,59,999),[{label:"Today",value:{from:new Date(se),to:V}},{label:"This Week",value:{from:new Date(se),to:ue}},{label:"This Month",value:{from:new Date(se),to:_e}},{label:"Next 3 Months",value:{from:new Date(se),to:ae}}]};return s.jsxs("div",{className:ke("space-y-4",a),children:[s.jsxs("div",{className:"flex items-center gap-2 bg-white/60 backdrop-blur-sm rounded-2xl p-4 border border-white/20 overflow-x-auto",children:[s.jsxs(fc,{open:p,onOpenChange:se=>{g(se),$({genres:se})},children:[s.jsx(mc,{asChild:!0,children:s.jsxs(le,{variant:"outline",size:"sm",className:"rounded-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0",children:[s.jsx($t,{className:"h-4 w-4 mr-1"}),"Genres",e.genres.length>0&&s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",marginLeft:"var(--spacing-inline, 6px)"},children:e.genres.length})]})}),s.jsx(wl,{className:"w-80 z-[60] bg-white/95 backdrop-blur-md border border-gray-200/50 rounded-2xl shadow-xl",children:s.jsxs("div",{className:"space-y-4 p-2",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(se=>s.jsx(Ke,{variant:e.genres.includes(se)?"default":"outline",className:`cursor-pointer transition-all duration-200 ${e.genres.includes(se)?"bg-synth-pink text-white hover:bg-synth-pink-dark":"hover:bg-synth-pink/10 hover:text-synth-pink hover:border-synth-pink/30"}`,onClick:()=>O(se),children:se},se))}),s.jsx("div",{className:"border-t border-gray-200/50 pt-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",placeholder:"Other: _____",value:_,onChange:se=>w(se.target.value),onKeyPress:D,className:"synth-input flex-1 h-9 text-sm"}),s.jsx(le,{size:"sm",onClick:z,disabled:!_.trim()||e.genres.includes(_.trim()),className:"h-9 px-4",children:"Add"})]})})]})})]}),s.jsxs(fc,{open:v,onOpenChange:se=>{y(se),$({locations:se})},children:[s.jsx(mc,{asChild:!0,children:s.jsxs(le,{variant:"outline",size:"sm",className:"rounded-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0",children:[s.jsx(gr,{className:"h-4 w-4 mr-1"}),"Locations",(((de=e.selectedCities)==null?void 0:de.length)||0)>0&&s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",marginLeft:"var(--spacing-inline, 6px)"},children:e.selectedCities.length})]})}),s.jsx(wl,{className:"w-96 z-[60] bg-white/95 backdrop-blur-md border border-gray-200/50 rounded-2xl shadow-xl",children:s.jsxs("div",{className:"space-y-4 p-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Xi,{value:f,onChange:se=>h(se),placeholder:"Search cities...",widthVariant:"full",className:"h-9"})}),s.jsx(le,{size:"sm",onClick:B,disabled:l.length===(((xe=e.selectedCities)==null?void 0:xe.length)||0)&&l.every(se=>e.selectedCities.includes(se)),children:"Apply"}),e.selectedCities&&e.selectedCities.length>0&&s.jsx(le,{size:"sm",variant:"outline",onClick:F,children:s.jsx(Gr,{className:"h-4 w-4"})})]}),(l.length>0||e.selectedCities&&e.selectedCities.length>0)&&s.jsxs("div",{className:"border-t border-gray-200/50 pt-3 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Search Radius"}),s.jsxs("span",{className:"text-sm text-gray-600",children:[e.radiusMiles," miles"]})]}),s.jsx("input",{type:"range",min:"5",max:"100",step:"5",value:e.radiusMiles||25,onChange:se=>{t(H(M({},e),{radiusMiles:parseInt(se.target.value,10)}))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-synth-pink"}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[s.jsx("span",{children:"5 mi"}),s.jsx("span",{children:"25 mi"}),s.jsx("span",{children:"50 mi"}),s.jsx("span",{children:"100 mi"})]})]}),s.jsxs("div",{className:"max-h-48 overflow-auto pr-1 space-y-1 synth-scrollbar",children:[S?s.jsxs("div",{className:"flex items-center justify-center py-4",children:[s.jsx(lr,{className:"h-4 w-4 animate-spin mr-2"}),s.jsx("span",{className:"text-sm text-gray-600",children:"Loading cities..."})]}):re.map((se,V)=>{let ue=typeof se=="string"?se:se.city,_e=typeof se=="string"?"":se.state;const ae=ue.match(/^(.+?),\s*([A-Z]{2})$/);ae&&(ue=ae[1].trim(),_e=ae[2].trim()||_e);const we=c_(ue),oe=_e?_e.trim().toUpperCase().replace(/\./g,""):"",ce=we,Ae=l.some(Xe=>{const ge=Xe.includes(",")?Xe.split(",")[0].trim():Xe,We=ra(ge),Ue=ra(we);return We===Ue}),Be=oe?`${we}-${oe}-${V}`:`${we}-${V}`;return s.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer select-none p-2 rounded-lg hover:bg-synth-pink/5 transition-colors",children:[s.jsx(uw,{checked:Ae,onCheckedChange:Xe=>{if(!!Xe)c(We=>{const Ue=[...We,ce];return Cf(Ue)});else{const We=ra(we);c(Ue=>Ue.filter(at=>{const mt=at.includes(",")?at.split(",")[0].trim():at;return ra(mt)!==We}))}}}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium truncate",children:we}),oe&&s.jsx("div",{className:"text-xs text-gray-500 truncate",children:oe})]})]},Be)}),!S&&re.length===0&&s.jsx("div",{className:"text-xs text-muted-foreground text-center py-4",children:f?`No cities found for "${f}"`:"No cities available"})]})]})})]}),s.jsxs(fc,{open:P,onOpenChange:se=>{A(se),$({daysOfWeek:se})},children:[s.jsx(mc,{asChild:!0,children:s.jsxs(le,{variant:"outline",size:"sm",className:"rounded-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0",children:[s.jsx(It,{className:"h-4 w-4 mr-1"}),"Days",e.daysOfWeek.length>0&&s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",marginLeft:"var(--spacing-inline, 6px)"},children:e.daysOfWeek.length})]})}),s.jsx(wl,{className:"w-80 z-[60] bg-white/95 backdrop-blur-md border border-gray-200/50 rounded-2xl shadow-xl",children:s.jsxs("div",{className:"space-y-4 p-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{variant:"outline",size:"sm",onClick:Y,className:ke("flex-1 text-xs",[0,1,2,3,4].every(se=>e.daysOfWeek.includes(se))?"bg-synth-pink text-white hover:bg-synth-pink-dark":"bg-white/80 border-synth-pink/20 hover:border-synth-pink/40"),children:"Weekdays"}),s.jsx(le,{variant:"outline",size:"sm",onClick:Q,className:ke("flex-1 text-xs",[5,6].every(se=>e.daysOfWeek.includes(se))?"bg-synth-pink text-white hover:bg-synth-pink-dark":"bg-white/80 border-synth-pink/20 hover:border-synth-pink/40"),children:"Weekend"})]}),s.jsx("div",{className:"grid grid-cols-7 gap-2",children:[{label:"Su",value:0},{label:"M",value:1},{label:"T",value:2},{label:"W",value:3},{label:"Th",value:4},{label:"F",value:5},{label:"Sa",value:6}].map(se=>s.jsx(le,{variant:"outline",size:"sm",onClick:()=>Z(se.value),className:ke("h-10 p-0 text-xs font-medium",e.daysOfWeek.includes(se.value)?"bg-synth-pink text-white hover:bg-synth-pink-dark border-synth-pink":"bg-white/80 border-gray-300 hover:border-synth-pink/40 hover:bg-synth-pink/10"),children:se.label},se.value))}),e.daysOfWeek.length>0&&s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>t(H(M({},e),{daysOfWeek:[]})),className:"w-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40",children:[s.jsx(Gr,{className:"h-4 w-4 mr-1"}),"Clear Days"]})]})})]}),s.jsxs(fc,{open:d,onOpenChange:se=>{u(se),$({date:se})},children:[s.jsx(mc,{asChild:!0,children:s.jsxs(le,{variant:"outline",size:"sm",className:"rounded-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0 max-w-[180px]",children:[s.jsx(It,{className:"h-4 w-4 mr-1 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:K()?(ie=K())==null?void 0:ie.label:e.dateRange.from||e.dateRange.to?ye():"Calendar"}),(e.dateRange.from||e.dateRange.to)&&s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",marginLeft:"var(--spacing-inline, 6px)",flexShrink:0},children:K()?"Range":"Custom"})]})}),s.jsx(wl,{className:"w-auto p-4 z-[60] bg-white/95 backdrop-blur-md border border-gray-200/50 rounded-2xl shadow-xl",align:"start",children:s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:ee().map(se=>{var ue;const V=((ue=K())==null?void 0:ue.label)===se.label;return s.jsxs(le,{variant:V?"default":"outline",size:"sm",onClick:()=>q(se.value),className:`text-xs ${V?"bg-synth-pink text-white hover:bg-synth-pink-dark":"bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40"}`,children:[s.jsx(ga,{className:"h-3 w-3 mr-1"}),se.label]},se.label)})}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("span",{className:"w-full border-t"})}),s.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:s.jsx("span",{className:"bg-white px-2 text-gray-500",children:"Or select custom dates"})})]}),s.jsx(ax,{initialFocus:!0,mode:"range",defaultMonth:e.dateRange.from||new Date,selected:e.dateRange.from?{from:e.dateRange.from,to:e.dateRange.to||e.dateRange.from}:void 0,onSelect:se=>{if(se)if(se.from&&se.to&&se.from.getTime()===se.to.getTime()){const V=new Date(se.from);V.setHours(0,0,0,0);const ue=new Date(se.from);ue.setHours(23,59,59,999),U({from:V,to:ue})}else U(se)},numberOfMonths:2,disabled:se=>{const V=new Date;V.setHours(0,0,0,0);const ue=new Date(se);return ue.setHours(0,0,0,0),ue<V}}),(e.dateRange.from||e.dateRange.to)&&s.jsxs(le,{variant:"outline",size:"sm",onClick:G,className:"bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40",children:[s.jsx(Gr,{className:"h-4 w-4 mr-1"}),"Clear Date"]})]})})]}),s.jsxs(le,{variant:e.filterByFollowing==="following"?"default":"outline",size:"sm",onClick:()=>t(H(M({},e),{filterByFollowing:e.filterByFollowing==="following"?"all":"following"})),className:`rounded-full backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0 ${e.filterByFollowing==="following"?"bg-synth-pink text-white":"bg-white/80"}`,children:[s.jsx(zr,{className:"h-4 w-4 mr-1"}),"Following"]}),ne&&s.jsxs(le,{variant:"ghost",size:"sm",onClick:X,className:"text-muted-foreground hover:text-foreground bg-white/60 backdrop-blur-sm border border-white/20 hover:bg-white/80 flex-shrink-0",children:[s.jsx(Gr,{className:"h-4 w-4 mr-1"}),"Clear all"]})]}),ne&&s.jsxs("div",{className:"flex flex-wrap gap-2 bg-white/40 backdrop-blur-sm rounded-2xl p-3 border border-white/20",children:[e.genres.map(se=>s.jsxs(Ke,{variant:"secondary",className:"flex items-center gap-1 bg-synth-pink/20 text-synth-pink border-synth-pink/30 hover:bg-synth-pink/30 transition-colors",children:[s.jsx($t,{className:"h-3 w-3"}),se,s.jsx(Gr,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>O(se)})]},se)),Cf(e.selectedCities||[]).map((se,V)=>s.jsxs(Ke,{variant:"secondary",className:"flex items-center gap-1 bg-synth-beige/30 text-synth-black border-synth-beige-dark hover:bg-synth-beige/50 transition-colors",children:[s.jsx(gr,{className:"h-3 w-3"}),se,s.jsx(Gr,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>t(H(M({},e),{selectedCities:(e.selectedCities||[]).filter(ue=>ue!==se)}))})]},`selected-city-${se}-${V}`)),(e.dateRange.from||e.dateRange.to)&&s.jsxs(Ke,{variant:"secondary",className:"flex items-center gap-1 bg-synth-pink/20 text-synth-pink border-synth-pink/30 hover:bg-synth-pink/30 transition-colors",children:[s.jsx(It,{className:"h-3 w-3"}),ye(),s.jsx(Gr,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:G})]}),e.daysOfWeek.length>0&&s.jsxs(Ke,{variant:"secondary",className:"flex items-center gap-1 bg-synth-beige/30 text-synth-black border-synth-beige-dark hover:bg-synth-beige/50 transition-colors",children:[s.jsx(It,{className:"h-3 w-3"}),e.daysOfWeek.length===7?"All Days":e.daysOfWeek.sort().map(se=>["Su","M","T","W","Th","F","Sa"][se]).join(", "),s.jsx(Gr,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>t(H(M({},e),{daysOfWeek:[]}))})]})]})]})},rge=({suggestions:e,onUserClick:t,onDismiss:r,onAddFriend:n})=>{const[a,i]=x.useState(new Set);x.useEffect(()=>{E(void 0,null,function*(){if(e.length!==0)try{const{data:{user:d}}=yield T.auth.getUser();if(!d)return;const u=e.map(y=>y.user_id),{data:f,error:h}=yield T.from("user_relationships").select("related_user_id").eq("user_id",d.id).eq("relationship_type","friend").eq("status","pending").in("related_user_id",u);h&&console.error("Error checking sent friend requests:",h);const{data:p,error:g}=yield T.from("user_relationships").select("user_id").eq("related_user_id",d.id).eq("relationship_type","friend").eq("status","pending").in("user_id",u);g&&console.error("Error checking received friend requests:",g);const v=new Set;f&&f.forEach(y=>v.add(y.related_user_id)),p&&p.forEach(y=>v.add(y.user_id)),v.size>0&&i(v)}catch(d){console.error("Error checking friend requests:",d)}})},[e]);const o=c=>E(void 0,null,function*(){var d,u;if(!a.has(c))try{n&&(yield n(c),i(f=>new Set(f).add(c)))}catch(f){console.error("Error sending friend request:",f),((d=f==null?void 0:f.message)!=null&&d.includes("already sent")||(u=f==null?void 0:f.message)!=null&&u.includes("Friend request already sent"))&&i(h=>new Set(h).add(c))}});if(e.length===0)return null;const l=c=>c.split(" ").map(d=>d[0]).join("").toUpperCase().slice(0,2);return s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 px-1",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-synth-black",children:"Who You Should Know"}),s.jsx("p",{className:"text-sm text-synth-black/60",children:"People you may know"})]}),r&&s.jsx(le,{variant:"ghost",size:"sm",onClick:r,className:"h-8 w-8 p-0",children:s.jsx(Gr,{className:"h-4 w-4"})})]}),s.jsxs(p1,{className:"w-full",children:[s.jsx("div",{className:"flex space-x-4 pb-4 pt-1",children:e.map(c=>{var d;return s.jsxs("div",{className:"flex flex-col items-center min-w-[120px] max-w-[120px] group cursor-pointer",onClick:()=>t==null?void 0:t(c.user_id),children:[s.jsxs("div",{className:"relative mb-2 mt-1",children:[s.jsxs(Vr,{className:"h-16 w-16 ring-2 ring-synth-pink/20 group-hover:ring-synth-pink/40 transition-all",children:[s.jsx(sn,{src:c.avatar_url||void 0,alt:c.name}),s.jsx(Wr,{className:"bg-synth-pink/10 text-synth-pink",children:l(c.name)})]}),c.verified&&s.jsx("div",{className:"absolute -bottom-1 -right-1 bg-synth-pink rounded-full p-0.5",children:s.jsx(lQ,{className:"h-3 w-3 text-white"})})]}),s.jsx("p",{className:"text-sm font-medium text-synth-black text-center truncate w-full mb-1",children:c.name}),s.jsxs("div",{className:"text-xs text-synth-black/60 text-center space-y-0.5",children:[c.mutual_friends_count>0&&s.jsxs("p",{children:[c.mutual_friends_count," mutual friend",c.mutual_friends_count!==1?"s":""]}),((d=c.shared_genres_count)!=null?d:0)>0&&s.jsxs("p",{children:[c.shared_genres_count," shared genre",c.shared_genres_count!==1?"s":""]})]}),n&&s.jsx(le,{size:"sm",variant:(a.has(c.user_id),"outline"),className:ke("mt-2 h-7 text-xs w-full",a.has(c.user_id)&&"border-synth-pink/30 bg-synth-pink/5"),disabled:a.has(c.user_id),onClick:u=>{u.stopPropagation(),o(c.user_id)},children:a.has(c.user_id)?s.jsxs(s.Fragment,{children:[s.jsx(ta,{className:"h-3 w-3 mr-1"}),"Requested"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ad,{className:"h-3 w-3 mr-1"}),"Add"]})})]},c.user_id)})}),s.jsx(fT,{orientation:"horizontal"})]})]})};function Qq(e,t,r,n){const i=b0(r-e),o=b0(n-t),l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(b0(e))*Math.cos(b0(r))*Math.sin(o/2)*Math.sin(o/2),d=3959*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)));return Math.round(d*100)/100}function b0(e){return e*(Math.PI/180)}function eV(e){if(e.length===0)return[39.8283,-98.5795];if(e.length===1)return e[0];const t=e.reduce((n,[a])=>n+a,0),r=e.reduce((n,[,a])=>n+a,0);return[t/e.length,r/e.length]}function tV(e,t=.1){if(e.length===0)return{north:40,south:39,east:-97,west:-99};const r=e.map(([a])=>a),n=e.map(([,a])=>a);return{north:Math.max(...r)+t,south:Math.min(...r)-t,east:Math.max(...n)+t,west:Math.min(...n)-t}}function rV(e){const t=e.north-e.south,r=e.east-e.west,n=Math.max(t,r);return n>50?4:n>20?5:n>10?6:n>5?7:n>2?8:n>1?9:n>.5?10:n>.2?11:n>.1?12:n>.05?13:n>.02?14:n>.01?15:16}function C2(e,t,r,n){return e.filter(a=>a.latitude!=null&&a.longitude!=null&&!Number.isNaN(Number(a.latitude))&&!Number.isNaN(Number(a.longitude))).map(a=>{const i=Qq(t,r,Number(a.latitude),Number(a.longitude));return H(M({},a),{distance_miles:i})}).filter(a=>a.distance_miles<=n).sort((a,i)=>a.distance_miles-i.distance_miles)}const nge=Object.freeze(Object.defineProperty({__proto__:null,calculateBounds:tV,calculateCenter:eV,calculateDistance:Qq,calculateZoomLevel:rV,filterEventsByRadius:C2},Symbol.toStringTag,{value:"Module"}));class HT{static getEventsNearZip(t){return E(this,null,function*(){try{const{zipCode:r,radiusMiles:n=25,limit:a=100}=t;if(!r)throw new Error("Zip code is required");const i=yield this.getZipCoordinates(r);if(!i)return[];const o=n/69,l=n/(69*Math.cos(i.lat*Math.PI/180)),{data:c,error:d}=yield T.from("events").select("*").gte("event_date",new Date().toISOString()).gte("latitude",i.lat-o).lte("latitude",i.lat+o).gte("longitude",i.lng-l).lte("longitude",i.lng+l).not("latitude","is",null).not("longitude","is",null).limit(500);if(d)throw d;const u=(c||[]).map(h=>({id:h.id,jambase_event_id:h.jambase_event_id,title:h.title,artist_name:h.artist_name,artist_id:h.artist_id||"",venue_name:h.venue_name,venue_id:h.venue_id||"",event_date:h.event_date,doors_time:h.doors_time,description:h.description,genres:h.genres,venue_address:h.venue_address,venue_city:h.venue_city,venue_state:h.venue_state,venue_zip:h.venue_zip,latitude:h.latitude,longitude:h.longitude,ticket_available:h.ticket_available,price_range:h.price_range,ticket_urls:h.ticket_urls,setlist:h.setlist,tour_name:h.tour_name,created_at:h.created_at,updated_at:h.updated_at}));return C2(u,i.lat,i.lng,n).slice(0,a)}catch(r){return[]}})}static getEventsNearCity(t){return E(this,null,function*(){try{const{city:r,state:n,radiusMiles:a=25,limit:i=100}=t;if(!r)throw new Error("City is required");const o=yield this.getCityCoordinates(r,n);if(!o)return[];const l=a/69,c=a/(69*Math.cos(o.lat*Math.PI/180)),{data:d,error:u}=yield T.from("events").select("*").gte("event_date",new Date().toISOString()).gte("latitude",o.lat-l).lte("latitude",o.lat+l).gte("longitude",o.lng-c).lte("longitude",o.lng+c).not("latitude","is",null).not("longitude","is",null).limit(500);if(u)throw u;const f=(d||[]).map(p=>({id:p.id,jambase_event_id:p.jambase_event_id,title:p.title,artist_name:p.artist_name,artist_id:p.artist_id||"",venue_name:p.venue_name,venue_id:p.venue_id||"",event_date:p.event_date,doors_time:p.doors_time,description:p.description,genres:p.genres,venue_address:p.venue_address,venue_city:p.venue_city,venue_state:p.venue_state,venue_zip:p.venue_zip,latitude:p.latitude,longitude:p.longitude,ticket_available:p.ticket_available,price_range:p.price_range,ticket_urls:p.ticket_urls,setlist:p.setlist,tour_name:p.tour_name,created_at:p.created_at,updated_at:p.updated_at}));return C2(f,o.lat,o.lng,a).slice(0,i)}catch(r){return[]}})}static getZipsNearCity(t,r,n=25){return E(this,null,function*(){try{let a=T.from("events").select("venue_zip, venue_city, venue_state, latitude, longitude").eq("venue_city",t).gte("event_date",new Date().toISOString()).not("venue_zip","is",null);r&&(a=a.eq("venue_state",r));const{data:i,error:o}=yield a;if(o)throw o;const l=new Map;return(i||[]).forEach(c=>{c.venue_zip&&c.venue_zip!==""&&l.set(c.venue_zip,{zip_code:c.venue_zip,city:c.venue_city,state:c.venue_state,latitude:c.latitude,longitude:c.longitude,distance_miles:0})}),Array.from(l.values())}catch(a){return[]}})}static getZipCoordinates(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("events").select("latitude, longitude").eq("venue_zip",t).not("latitude","is",null).not("longitude","is",null).limit(1).single();if(n)throw n;return r?{lat:Number(r.latitude),lng:Number(r.longitude)}:null}catch(r){return null}})}static getCityCoordinates(t,r){return E(this,null,function*(){var n;try{const a=ra(t),i=r?r.toLowerCase().trim():null,o=age(a,i),l=new Set(o.map(v=>ra(v)));let c=T.from("city_centers").select("normalized_name, state, center_latitude, center_longitude, aliases, event_count");if(o.length>0){const v=o.map(w=>`normalized_name.ilike.%${w}%`).join(","),y=o.map(w=>`aliases.cs.{${w}}`).join(","),_=[v,y].filter(Boolean).join(",");_&&(c=c.or(_))}const{data:d,error:u}=yield c.limit(10);if(!u&&d&&d.length>0){const y=(n=d.map(_=>({match:_,score:ige(_,l,i)})).sort((_,w)=>w.score-_.score)[0])==null?void 0:n.match;if(y&&y.center_latitude&&y.center_longitude)return{lat:Number(y.center_latitude),lng:Number(y.center_longitude)}}let f=T.from("events").select("latitude, longitude, venue_city, venue_state").ilike("venue_city",`%${a}%`).not("latitude","is",null).not("longitude","is",null);r&&(f=f.ilike("venue_state",`%${r.toLowerCase().trim()}%`));const{data:h,error:p}=yield f.limit(5);if(!p&&h&&h.length>0){const v=h.filter(y=>y.latitude!=null&&y.longitude!=null&&!Number.isNaN(Number(y.latitude))&&!Number.isNaN(Number(y.longitude)));if(v.length>0){const y=v.reduce((w,b)=>w+Number(b.latitude),0)/v.length,_=v.reduce((w,b)=>w+Number(b.longitude),0)/v.length;return{lat:y,lng:_}}}const g=[...o,a];for(const v of g){const y=v.replace(/\s+/g," ").trim();if(y&&this.CITY_COORDINATES[y])return this.CITY_COORDINATES[y]}return null}catch(a){return console.error("Error getting city coordinates:",a),null}})}static searchEventsByLocation(t,r=25,n=100){return E(this,null,function*(){if(/^\d{5}(-\d{4})?$/.test(t.trim()))return this.getEventsNearZip({zipCode:t.trim(),radiusMiles:r,limit:n});{const[i,o]=t.split(",").map(l=>l.trim());return this.getEventsNearCity({city:i,state:o||void 0,radiusMiles:r,limit:n})}})}static getMapConfigForEvents(t,r){const n=t.filter(c=>c.latitude!=null&&c.longitude!=null&&!Number.isNaN(Number(c.latitude))&&!Number.isNaN(Number(c.longitude)));if(n.length===0)return{center:r||[39.8283,-98.5795],zoom:4};if(n.length===1)return{center:[Number(n[0].latitude),Number(n[0].longitude)],zoom:12};const a=n.map(c=>[Number(c.latitude),Number(c.longitude)]),i=eV(a),o=tV(a,.05),l=rV(o);return{center:i,zoom:l,bounds:o}}static getEventsNearZipWithRPC(t){return E(this,null,function*(){try{const{zipCode:r,radiusMiles:n=25,limit:a=100}=t;if(!r)throw new Error("Zip code is required");try{const{data:i,error:o}=yield T.rpc("get_events_near_zip_improved",{search_zip:r,radius_miles:n});if(!o&&i)return i.slice(0,a).map(l=>({id:l.id,jambase_event_id:l.jambase_event_id,title:l.title,artist_name:l.artist_name,artist_id:l.artist_id||"",venue_name:l.venue_name,venue_id:l.venue_id||"",event_date:l.event_date,doors_time:l.doors_time,description:l.description,genres:l.genres,venue_address:l.venue_address,venue_city:l.venue_city,venue_state:l.venue_state,venue_zip:l.venue_zip,latitude:l.latitude,longitude:l.longitude,ticket_available:l.ticket_available,price_range:l.price_range,ticket_urls:l.ticket_urls,setlist:l.setlist,tour_name:l.tour_name,created_at:l.created_at,updated_at:l.updated_at,distance_miles:l.distance_miles}))}catch(i){}return this.getEventsNearZip(t)}catch(r){return[]}})}}Cr(HT,"CITY_COORDINATES",{washington:{lat:38.9072,lng:-77.0369},"washington dc":{lat:38.9072,lng:-77.0369},"new york":{lat:40.7128,lng:-74.006},"los angeles":{lat:34.0522,lng:-118.2437},chicago:{lat:41.8781,lng:-87.6298},houston:{lat:29.7604,lng:-95.3698},phoenix:{lat:33.4484,lng:-112.074},philadelphia:{lat:39.9526,lng:-75.1652},"san antonio":{lat:29.4241,lng:-98.4936},"san diego":{lat:32.7157,lng:-117.1611},dallas:{lat:32.7767,lng:-96.797},"san jose":{lat:37.3382,lng:-121.8863},austin:{lat:30.2672,lng:-97.7431},jacksonville:{lat:30.3322,lng:-81.6557},"san francisco":{lat:37.7749,lng:-122.4194},columbus:{lat:39.9612,lng:-82.9988},"fort worth":{lat:32.7555,lng:-97.3308},indianapolis:{lat:39.7684,lng:-86.1581},charlotte:{lat:35.2271,lng:-80.8431},seattle:{lat:47.6062,lng:-122.3321},denver:{lat:39.7392,lng:-104.9903},boston:{lat:42.3601,lng:-71.0589},detroit:{lat:42.3314,lng:-83.0458},nashville:{lat:36.1627,lng:-86.7816},portland:{lat:45.5152,lng:-122.6784},"las vegas":{lat:36.1699,lng:-115.1398},memphis:{lat:35.1495,lng:-90.049},louisville:{lat:38.2527,lng:-85.7585},baltimore:{lat:39.2904,lng:-76.6122},milwaukee:{lat:43.0389,lng:-87.9065},albuquerque:{lat:35.0844,lng:-106.6504},tucson:{lat:32.2226,lng:-110.9747},fresno:{lat:36.7378,lng:-119.7871},sacramento:{lat:38.5816,lng:-121.4944},"kansas city":{lat:39.0997,lng:-94.5786},mesa:{lat:33.4152,lng:-111.8315},atlanta:{lat:33.749,lng:-84.388},omaha:{lat:41.2565,lng:-95.9345},"colorado springs":{lat:38.8339,lng:-104.8214},raleigh:{lat:35.7796,lng:-78.6382},miami:{lat:25.7617,lng:-80.1918},"long beach":{lat:33.7701,lng:-118.1937},"virginia beach":{lat:36.8529,lng:-75.978},oakland:{lat:37.8044,lng:-122.2712},minneapolis:{lat:44.9778,lng:-93.265},tulsa:{lat:36.154,lng:-95.9928},arlington:{lat:32.7357,lng:-97.1081},tampa:{lat:27.9506,lng:-82.4572}});const sge=["district of columbia","city","county","borough","metro area","metropolitan area","municipality","township","parish"];function age(e,t){const r=new Set,n=e.replace(/\s+/g," ").trim();n&&r.add(n);const a=t?t.toLowerCase().trim():null;a&&(r.add(a),n.endsWith(a)&&r.add(n.slice(0,-a.length).trim())),sge.forEach(o=>{n.endsWith(` ${o}`)&&r.add(n.slice(0,-o.length).trim())});const i=n.split(" ").filter(Boolean);return i.length>1&&(r.add(i.slice(0,i.length-1).join(" ")),r.add(i.slice(0,Math.min(i.length,2)).join(" ")),r.add(i[0])),!r.has("washington")&&n.includes("washington")&&(r.add("washington"),r.add("washington dc")),Array.from(r).map(o=>o.replace(/\s+/g," ").trim()).filter(Boolean)}function ige(e,t,r){let n=0;const a=ra(e.normalized_name||"");t.has(a)&&(n+=50),Array.isArray(e.aliases)&&e.aliases.map(l=>ra(l)).some(l=>t.has(l))&&(n+=40);const i=e.state?e.state.toLowerCase().trim():null;return r&&i&&(i===r||i===r.replace(/\s+/g,""))&&(n+=20),typeof e.event_count=="number"&&(n+=Math.min(e.event_count,500)),n}const P2=Object.freeze(Object.defineProperty({__proto__:null,RadiusSearchService:HT},Symbol.toStringTag,{value:"Module"})),B5=[39.8283,-98.5795],eS=["events","reviews","news"],oge={events:{label:"Events",icon:It},reviews:{label:"Reviews",icon:Qt},news:{label:"News",icon:wP}},lge=({currentUserId:e,onBack:t,onNavigateToNotifications:r,onViewChange:n,onNavigateToProfile:a,onNavigateToChat:i,headerTitle:o,headerSubtitle:l,visibleSections:c,enableMap:d,sectionLayout:u="tabs",onHighlightUpdate:f,embedded:h=!1,showSectionTabs:p=!0})=>{var Dh,Nx,Fp,tn,Sx,Ja,Hc,zp,kx,Ih,Ex;const g=x.useRef(!1);!g.current&&e&&(console.log(" UnifiedFeed initialized:",{currentUserId:e,hasCurrentUserId:!!e,onNavigateToProfile:!!a,onNavigateToChat:!!i}),g.current=!0);const v=x.useMemo(()=>{if(!c||c.length===0)return eS;const he=c.filter(Ce=>eS.includes(Ce));return he.length>0?he:eS},[c]),y=v.length,_=u==="stacked",w=y===1?"grid-cols-1":y===2?"grid-cols-2":"grid-cols-3",b=h,N=b?"w-full":"min-h-screen bg-[#f9fafb]",S=b?{}:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},k=b?"w-full space-y-0":"max-w-4xl mx-auto p-6 space-y-8",P=b?"mb-0":"mb-8",A=o!=null?o:"Feed",R=l!=null?l:"Discover reviews and events from friends and the community",$=A.trim(),O=R.trim(),z=$.length>0,D=O.length>0,B=z||D,F=d!=null?d:!0,[U,G]=x.useState([]),[q,K]=x.useState(!0),[Z,Y]=x.useState(!1),[Q,X]=x.useState(!0),[ne,re]=x.useState(!0),[ye,ee]=x.useState(!1),[de,xe]=x.useState(null),[ie,se]=x.useState(),[V,ue]=x.useState(!1),[_e,ae]=x.useState(B5),[we,oe]=x.useState(!1),{toast:ce}=Rr(),{sessionExpired:Ae}=xs(),Be=as(),[Xe,ge]=x.useState(!1),[We,Ue]=x.useState(null),[at,mt]=x.useState(!1),[Ye,Ft]=x.useState(null),[_t,Lt]=x.useState(null),[Oe,qe]=x.useState(null),[Ne,Fe]=x.useState(null);x.useState("review"),x.useState(!1),x.useState(null),x.useState(!1);const[ve,Me]=x.useState(!1),[ze,ct]=x.useState(null),[Et,gt]=x.useState("relevance"),[St,dr]=x.useState("desc"),Sr=typeof window!="undefined"&&localStorage.getItem("feedFilter")==="following"?(localStorage.removeItem("feedFilter"),"following"):"all",[wt,lt]=x.useState(Sr),[Qe,jt]=x.useState({genres:[],selectedCities:[],dateRange:{from:void 0,to:void 0},showFilters:!1,radiusMiles:30,filterByFollowing:Sr,daysOfWeek:[]}),[ir,rr]=x.useState(Qe),[Ie,At]=x.useState([]),yt=x.useRef(!1),pe=x.useRef(!1),De=x.useRef(null),[Le,bt]=x.useState(0);x.useState({}),x.useState({}),x.useState({}),x.useState({});const[it,zt]=x.useState(new Set),[Bt,Te]=x.useState(new Set),[dt,mr]=x.useState(new Set),[Mn,fe]=x.useState(!1),[Re,ot]=x.useState(null),[vt,ut]=x.useState([]),[Pe,Ge]=x.useState([]),[Ee,ft]=x.useState(!1),[Pt,yr]=x.useState(!1),[un,hn]=x.useState(null),[xn,Rt]=x.useState(!1),[hr,or]=x.useState(null),[Gt,xr]=x.useState([]),[Xt,jr]=x.useState(!1),[en,Hn]=x.useState("all"),[Tt,kr]=x.useState(()=>{var he;return(he=v[0])!=null?he:"events"}),[ds,Oa]=x.useState([]),[Dn,Hr]=x.useState(!1);x.useEffect(()=>{var he;_||v.includes(Tt)||kr((he=v[0])!=null?he:"events")},[v,Tt,_]);const[Br,En]=x.useState({open:!1,artist:null}),[$r,Qn]=x.useState({open:!1,venueId:null,venueName:""}),[la,wi]=x.useState(!1);x.useEffect(()=>{E(void 0,null,function*(){if(!(!Br.open||!Br.artist)&&!(Br.events&&Br.events.length>0)){wi(!0);try{const Ce=Br.artist.name,{data:st,error:je}=yield T.from("events").select("*").ilike("artist_name",`%${Ce}%`).order("event_date",{ascending:!0}).limit(200);if(je){console.error("Error fetching events:",je);return}const kt=[...(st||[]).map(Vt=>H(M({},Vt),{source:"manual"}))],Dt=In(kt);Dt.sort((Vt,ur)=>new Date(Vt.event_date).getTime()-new Date(ur.event_date).getTime()),En(Vt=>H(M({},Vt),{events:Dt,totalEvents:Dt.length}))}catch(Ce){console.error("Error fetching artist dialog events:",Ce)}finally{wi(!1)}}})},[Br.open,(Dh=Br.artist)==null?void 0:Dh.name]);const In=he=>{const Ce=new Map;return he.filter(st=>{var Vt;const je=(st.artist_name||"").toLowerCase().trim(),sr=(st.venue_name||"").toLowerCase().replace(/\s+/g," ").replace(/\bthe\s+/gi,"").replace(/[^\w\s]/g,"").trim(),kt=((Vt=st.event_date)==null?void 0:Vt.split("T")[0])||"",Dt=`${je}|${sr}|${kt}`;return Ce.has(Dt)?(Ce.get(Dt),!1):(Ce.set(Dt,st),!0)})},nr=()=>E(void 0,null,function*(){jr(!0);try{const he=yield Pf.getPersonalizedNews(e);xr(he);const Ce=he.filter(st=>(st.relevance_score||0)>0).length;ce({title:"News updated",description:Ce>0?`Loaded ${he.length} articles (${Ce} personalized for you)`:`Loaded ${he.length} articles`})}catch(he){console.error("Error fetching news:",he),ce({title:"Error",description:"Failed to load news articles",variant:"destructive"})}finally{jr(!1)}}),Or=he=>{kr(he),he==="news"&&v.includes("news")&&(Pf.clearCache(),nr()),he==="reviews"&&v.includes("reviews")&&ln()},ln=()=>E(void 0,null,function*(){if(!(Dn||ds.length>0)){Hr(!0);try{const he=yield Au.getRecommendedFriends(e,10);Oa(he)}catch(he){console.error("Error loading recommended friends:",he)}finally{Hr(!1)}}}),Cn=he=>E(void 0,null,function*(){try{const{error:Ce}=yield T.rpc("create_friend_request",{receiver_user_id:he});if(Ce)throw Ce;ce({title:"Friend Request Sent! ",description:"Your friend request has been sent."})}catch(Ce){throw console.error("Error sending friend request:",Ce),ce({title:"Error",description:Ce.message||"Failed to send friend request. Please try again.",variant:"destructive"}),Ce}});x.useEffect(()=>{if(Ae){K(!1),re(!1);return}if(!e){re(!1);return}E(void 0,null,function*(){try{const{data:Ce}=yield T.from("users").select("location_city").eq("user_id",e).maybeSingle();if(Ce!=null&&Ce.location_city&&!pe.current){const st=Ce.location_city.trim();console.log(" User location_city from profile:",st);let je=st;try{const Dt=yield v5.getAvailableCities(1,1e3);if(Dt&&Dt.length>0){const Vt=st.toLowerCase().trim();let ur=Dt.find(Ur=>{var _r;return((_r=Ur.city_name)==null?void 0:_r.toLowerCase().trim())===Vt});ur||(ur=Dt.find(Ur=>{var _r,cn;return((_r=Ur.city_name)==null?void 0:_r.toLowerCase().includes(Vt))||Vt.includes(((cn=Ur.city_name)==null?void 0:cn.toLowerCase())||"")})),!ur&&(Vt.includes("washington")||Vt.includes("dc")||Vt.includes("district"))&&(ur=Dt.find(Ur=>{var cn;const _r=((cn=Ur.city_name)==null?void 0:cn.toLowerCase())||"";return _r.includes("washington")&&(_r.includes("dc")||Ur.state==="DC")||Ur.state==="DC"&&_r.includes("washington")})),!ur&&(Vt==="dc"||Vt==="district of columbia")&&(ur=Dt.find(Ur=>{var _r;return Ur.state==="DC"&&((_r=Ur.city_name)==null?void 0:_r.toLowerCase().includes("washington"))})),ur?(je=typeof ur=="object"&&ur!==null&&"city_name"in ur?ur.city_name:typeof ur=="string"?ur:st,console.log(" Matched user city to database city:",st,"",je)):(console.warn(" Could not match user city to available cities. Using raw city name:",st),je=st)}}catch(Dt){console.warn(" Could not load available cities. Using raw city name:",Dt),je=st}console.log(" Auto-applying city filter from profile:",je);const sr=Cf([je]),kt={genres:[],selectedCities:sr,dateRange:{from:void 0,to:void 0},daysOfWeek:[],filterByFollowing:"all",showFilters:!1,radiusMiles:50};if(rr(kt),jt(kt),je)try{const Dt=yield HT.getCityCoordinates(je);Dt&&(console.log("Got city coordinates:",Dt),se(Dt),ae([Dt.lat,Dt.lng]))}catch(Dt){console.warn("Could not get city coordinates:",Dt)}yt.current=!0,console.log(" Initial load with auto-applied city filter:",je),bt(0),re(!1),Za(0,!1,!1,kt),Promise.all([Nr(),js(),ql()]).catch(Dt=>console.warn("Error loading parallel data:",Dt));return}}catch(Ce){console.warn(" Error loading user city from profile:",Ce)}re(!1),Promise.all([Promise.resolve(Za(0,!1)),Nr(),js(),ql(),ln(),Ma()]).catch(Ce=>console.warn("Error loading parallel data:",Ce))})},[Ae,e]),x.useEffect(()=>{E(void 0,null,function*(){if(ie&&!yt.current&&!(Qe.selectedCities&&Qe.selectedCities.length>0))try{const Ce=yield v5.getAvailableCities(1,200);if(!Array.isArray(Ce)||Ce.length===0)return;const st=Vt=>Vt*(Math.PI/180),je=(Vt,ur,Ur,_r)=>{const Ns=st(Ur-Vt),ar=st(_r-ur),rn=Gp(Math.sin(Ns/2),2)+Math.cos(st(Vt))*Math.cos(st(Ur))*Gp(Math.sin(ar/2),2);return 2*3959*Math.atan2(Math.sqrt(rn),Math.sqrt(1-rn))};let sr=Ce[0],kt=1/0;for(const Vt of Ce){const ur=je(ie.lat,ie.lng,Number(Vt.center_latitude),Number(Vt.center_longitude));ur<kt&&(kt=ur,sr=Vt)}const Dt=sr.city_name;if(Dt){yt.current=!0;const{deduplicateCities:Vt}=yield kn(()=>E(void 0,null,function*(){const{deduplicateCities:_r}=yield Promise.resolve().then(()=>O5);return{deduplicateCities:_r}}),void 0,import.meta.url),ur=Vt([Dt]),Ur=H(M({},Qe),{selectedCities:ur});jt(Ur),rr(Ur),bt(0),Za(0,!1)}}catch(Ce){}})},[ie,Qe.selectedCities]),x.useEffect(()=>()=>{De.current&&clearTimeout(De.current)},[]),x.useEffect(()=>{const he=st=>{const je=st.detail||{},sr=je.venueId||je.venueName;sr&&Be(`/venue/${encodeURIComponent(sr)}`)},Ce=st=>E(void 0,null,function*(){const je=st.detail||{};if(je.artistName){const sr=je.artistId&&je.artistId!=="manual"?je.artistId:encodeURIComponent(je.artistName);Be(`/artist/${sr}`)}});return document.addEventListener("open-venue-card",he),document.addEventListener("open-artist-card",Ce),()=>{document.removeEventListener("open-venue-card",he),document.removeEventListener("open-artist-card",Ce)}},[Be]);const js=()=>E(void 0,null,function*(){if(e){ft(!0);try{const he=yield Si.getUserFollowedArtists(e);ut(he.map(st=>st.artist_name));const Ce=yield Tu.getUserFollowedVenues(e);Ge(Ce.map(st=>({name:st.venue_name,city:st.venue_city,state:st.venue_state})))}catch(he){console.error("Error loading followed data:",he)}finally{ft(!1)}}});x.useEffect(()=>{const he=localStorage.getItem("reopenEventId");if(console.log(" UnifiedFeed: Checking for reopenEventId in localStorage:",he),console.log(" UnifiedFeed: feedItems.length:",U.length),he&&U.length>0){console.log(" UnifiedFeed: Looking for event with id:",he);const Ce=U.find(st=>{var je;return st.type==="event"&&((je=st.event_data)==null?void 0:je.id)===he});console.log(" UnifiedFeed: Found eventItem:",Ce),Ce&&Ce.event_data&&(console.log(" UnifiedFeed: Re-opening modal for event:",Ce.event_data),Ue(Ce.event_data),ge(!0),localStorage.removeItem("reopenEventId"))}},[U]),x.useEffect(()=>{(()=>{const Ce=localStorage.getItem("selectedEvent");if(Ce)try{const st=JSON.parse(Ce);console.log(" UnifiedFeed: Opening event from localStorage:",st),Ue(st),ge(!0),localStorage.removeItem("selectedEvent")}catch(st){console.error("Error parsing selectedEvent from localStorage:",st),localStorage.removeItem("selectedEvent")}})()},[]),x.useEffect(()=>{if(!e||U.length===0)return;const he=U.filter(je=>{var sr;return je.type==="event"&&((sr=je.event_data)==null?void 0:sr.id)});he.length===0||he.map(je=>je.event_data.id).filter(Boolean).filter(je=>!dt.has(je)).length===0||Ma()},[U,e,dt]);const bi=he=>{const Ce=Xa.find(st=>{var je;return st.type==="event"&&((je=st.event_data)==null?void 0:je.id)===he.id});Ce!=null&&Ce.event_data?Ue(Ce.event_data):Ue(he),ge(!0),oe(!1)},xa=he=>E(void 0,null,function*(){if(!e)return;const Ce=it.has(he.id),st=new Set(it);Ce?st.delete(he.id):st.add(he.id),zt(st);try{yield On.like(he.type,he.review_id||he.id,!!e)}catch(je){console.error("Error tracking like:",je)}}),Ms=he=>E(void 0,null,function*(){const Ce=Bt.has(he.id),st=new Set(Bt);Ce?st.delete(he.id):st.add(he.id),Te(st)}),_s=he=>{const Ce=ms(he),je=Math.floor((new Date().getTime()-Ce.getTime())/1e3);return je<60?`${je}s`:je<3600?`${Math.floor(je/60)}m`:je<86400?`${Math.floor(je/3600)}h`:`${Math.floor(je/86400)}d`};x.useEffect(()=>{const he=()=>{window.innerHeight+document.documentElement.scrollTop>=document.documentElement.offsetHeight-1e3&&!Z&&Q&&Za(U.length)};return window.addEventListener("scroll",he),()=>window.removeEventListener("scroll",he)},[Z,Q,U.length]);const Za=(he=0,Ce=!1,st=!1,je)=>E(void 0,null,function*(){try{const sr=je!=null?je:Qe,kt=st?je!=null?je:ir:sr,Dt=kt.genres&&kt.genres.length>0||kt.selectedCities&&kt.selectedCities.length>0||kt.dateRange.from||kt.dateRange.to||kt.daysOfWeek&&kt.daysOfWeek.length>0||kt.filterByFollowing==="following",Vt=Ce?0:he;console.log(" loadFeedData called with offset:",Vt,"isRefresh:",Ce,"isFilterUpdate:",st,"hasActiveFilters:",Dt),st?(K(!1),Y(!0),X(!0)):he===0&&!Ce?(K(!0),G([]),X(!0)):Ce?K(!0):Y(!0);const{deduplicateCities:ur}=yield kn(()=>E(void 0,null,function*(){const{deduplicateCities:er}=yield Promise.resolve().then(()=>O5);return{deduplicateCities:er}}),void 0,import.meta.url),Ur=kt.selectedCities&&kt.selectedCities.length>0?ur(kt.selectedCities):void 0,_r={genres:kt.genres&&kt.genres.length>0?kt.genres:void 0,selectedCities:Ur,dateRange:kt.dateRange.from||kt.dateRange.to?kt.dateRange:void 0,daysOfWeek:kt.daysOfWeek&&kt.daysOfWeek.length>0?kt.daysOfWeek:void 0,filterByFollowing:kt.filterByFollowing!=="all"?kt.filterByFollowing:void 0,radiusMiles:kt.radiusMiles!==void 0?kt.radiusMiles:void 0},cn=_r.genres||_r.selectedCities||_r.dateRange||_r.daysOfWeek||_r.filterByFollowing?_r:void 0,ar=(yield KN.getFeedItems({userId:e,limit:20,offset:Vt,includePrivateReviews:!0,filters:cn})).filter(er=>!(er.type==="review"&&(er.deleted_at||er.is_deleted||!er.content&&(!er.photos||er.photos.length===0)||er.content==="ATTENDANCE_ONLY"||er.content==="[deleted]"||er.content==="DELETED")));if(st)G(ar),bt(0);else if(he===0&&!Ce)G(ar);else if(Ce)if(ar.length>0)G(ar),bt(0);else{console.log(" Refresh: No items at current offset, resetting to 0..."),bt(0);const ca=(yield KN.getFeedItems({userId:e,limit:20,offset:0,includePrivateReviews:!0})).filter(wr=>!(wr.type==="review"&&(wr.deleted_at||wr.is_deleted||!wr.content&&(!wr.photos||wr.photos.length===0)||wr.content==="ATTENDANCE_ONLY"||wr.content==="[deleted]"||wr.content==="DELETED")));ca.length>0?(G(ca),bt(0)):console.warn(" Refresh: No items found even at offset 0, keeping existing feed")}else G(er=>[...er,...ar]);const rn=ar.filter(er=>er.type==="event"),Mr=ar.length>=20||rn.length>=20;console.log(` Loaded ${ar.length} items (${rn.length} events), hasMore: ${Mr}`),X(Mr)}catch(sr){if(console.error("Error loading feed data:",sr),Ce&&U.length===0){console.log(" Refresh failed with no items, retrying from offset 0...");try{const Dt=(yield KN.getFeedItems({userId:e,limit:20,offset:0,includePrivateReviews:!0})).filter(Vt=>!(Vt.type==="review"&&(Vt.deleted_at||Vt.is_deleted||!Vt.content&&(!Vt.photos||Vt.photos.length===0)||Vt.content==="ATTENDANCE_ONLY"||Vt.content==="[deleted]"||Vt.content==="DELETED")));if(Dt.length>0){G(Dt),bt(20);return}}catch(kt){console.error("Retry also failed:",kt)}}ce({title:"Error",description:"Failed to load feed data. Please try again.",variant:"destructive"})}finally{console.log(" Setting loading to false"),K(!1),Y(!1)}}),Nr=()=>E(void 0,null,function*(){try{console.log("Loading upcoming events...")}catch(he){console.error("Error loading upcoming events:",he)}}),Ma=()=>E(void 0,null,function*(){if(e)try{const he=yield Qr.getUserInterestedEventIdSet(e);mr(he),console.log(" Loaded all interested events:",he.size,"events")}catch(he){console.error("Error loading all interested events:",he)}}),fn=he=>E(void 0,null,function*(){var Ce,st,je,sr,kt;try{if(he.type==="event"&&he.event_data)try{yield On.click("share",he.event_data.id,{source:"feed_event_card",artist_name:he.event_data.artist_name,venue_name:he.event_data.venue_name})}catch(Dt){console.error("Error tracking share:",Dt)}if(he.type==="event"&&he.event_data)hn(he.event_data),yr(!0);else if(he.type==="review"){const Dt={id:he.review_id||he.id,user_id:((Ce=he.author)==null?void 0:Ce.id)||e,event_id:he.event_id||"",rating:typeof he.rating=="number"?he.rating:he.artist_performance_rating||0,review_text:he.content||"",is_public:!0,created_at:he.created_at,updated_at:he.updated_at||he.created_at,likes_count:he.likes_count||0,comments_count:he.comments_count||0,shares_count:he.shares_count||0,is_liked_by_user:it.has(he.id),reaction_emoji:"",photos:he.photos||[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:(st=he.event_info)==null?void 0:st.artist_name,artist_id:(je=he.event_info)==null?void 0:je.artist_id,venue_name:(sr=he.event_info)==null?void 0:sr.venue_name,venue_id:(kt=he.event_info)==null?void 0:kt.venue_id};or(Dt),Rt(!0)}else{const Dt=`Check out this ${he.type}: ${he.title}`;yield navigator.clipboard.writeText(Dt),ce({title:"Shared!",description:"Link copied to clipboard"})}}catch(Dt){console.error("Error sharing item:",Dt)}}),ou=he=>E(void 0,null,function*(){if(!e||!he.event_data)return;const st=!dt.has(he.event_data.id);st?dt.add(he.event_data.id):dt.delete(he.event_data.id),mr(new Set(dt));try{yield Qr.setEventInterest(e,he.event_data.id,st),ce({title:st?"You're interested!":"Interest removed",description:st?"We'll notify you about this event":"You'll no longer receive notifications for this event"})}catch(je){console.error("Error toggling interest:",je),st?dt.delete(he.event_data.id):dt.add(he.event_data.id),mr(new Set(dt)),ce({title:"Error",description:"Failed to update interest",variant:"destructive"})}}),Vc=he=>[...he].sort((Ce,st)=>{var sr,kt,Dt,Vt;let je=0;switch(Et){case"date":{const _r=Ce.type==="event"&&((sr=Ce.event_data)!=null&&sr.event_date)?new Date(Ce.event_data.event_date).getTime():new Date(Ce.created_at).getTime(),cn=st.type==="event"&&((kt=st.event_data)!=null&&kt.event_date)?new Date(st.event_data.event_date).getTime():new Date(st.created_at).getTime();je=_r-cn;break}case"price":{const _r=Mh(Ce),cn=Mh(st);je=_r-cn;break}case"popularity":{const _r=(Ce.likes_count||0)+(Ce.comments_count||0)+(Ce.shares_count||0),cn=(st.likes_count||0)+(st.comments_count||0)+(st.shares_count||0);je=_r-cn;break}case"distance":{const _r=Ce.distance_miles||1/0,cn=st.distance_miles||1/0;je=_r-cn;break}case"relevance":default:const ur=(Dt=Ce.relevance_score)!=null?Dt:0,Ur=(Vt=st.relevance_score)!=null?Vt:0;je=ur-Ur;break}return St==="asc"?je:-je}),ql=()=>E(void 0,null,function*(){try{const{data:he,error:Ce}=yield T.from("events").select("venue_city").not("venue_city","is",null);if(Ce)throw Ce;const st=Array.from(new Set((he||[]).map(je=>je.venue_city.trim()).filter(Boolean))).sort();At(st)}catch(he){console.error("Failed to load cities:",he),At([])}}),Wc=x.useMemo(()=>{const he=new Set;return U.forEach(Ce=>{var st;Ce.type==="event"&&((st=Ce.event_data)!=null&&st.genres)&&Ce.event_data.genres.forEach(je=>he.add(je))}),Array.from(he).sort()},[U]),tl=x.useMemo(()=>{let he=[...U];if(Qe.filterByFollowing==="following"){const Ce=he.filter(sr=>sr.type==="event"),st=he.filter(sr=>sr.type!=="event");return[...Ce.filter(sr=>{if(!sr.event_data)return!1;const kt=sr.event_data;return kt.artist_name&&vt.includes(kt.artist_name)?!0:kt.venue_name?Pe.some(Dt=>Dt.name===kt.venue_name&&(!Dt.city||Dt.city===kt.venue_city)&&(!Dt.state||Dt.state===kt.venue_state)):!1}),...st]}return he},[U,Qe.filterByFollowing,vt,Pe]);x.useEffect(()=>{rr(Qe)},[Qe]);const Mh=he=>{var Ce;return he.type==="event"&&((Ce=he.event_data)!=null&&Ce.price_range)?Pue(he.event_data.price_range):0},Xa=x.useMemo(()=>Vc(tl),[tl,Et,St]),es=x.useMemo(()=>Xa.filter(he=>he.type==="event"&&!!he.event_data).map(he=>{var sr,kt,Dt,Vt,ur,Ur,_r,cn,Ns,ar,rn,Gn,Mr,er,ca,wr,Nn,lu,rl,Cx,Gc,Da,Bp,Up,Px;const Ce=he.event_data,st=Ce.latitude!=null?Number(Ce.latitude):void 0,je=Ce.longitude!=null?Number(Ce.longitude):void 0;return{id:Ce.id,jambase_event_id:(sr=Ce.jambase_event_id)!=null?sr:Ce.id,title:(Dt=(kt=Ce.title)!=null?kt:Ce.artist_name)!=null?Dt:"Untitled Event",artist_name:(Vt=Ce.artist_name)!=null?Vt:"",artist_id:(ur=Ce.artist_id)!=null?ur:"",venue_name:(Ur=Ce.venue_name)!=null?Ur:"",venue_id:(_r=Ce.venue_id)!=null?_r:"",event_date:Ce.event_date,doors_time:Ce.doors_time,description:Ce.description,genres:(cn=Ce.genres)!=null?cn:[],venue_address:Ce.venue_address,venue_city:Ce.venue_city,venue_state:Ce.venue_state,venue_zip:Ce.venue_zip,latitude:st,longitude:je,ticket_available:Ce.ticket_available,price_range:Ce.price_range,ticket_urls:(Ns=Ce.ticket_urls)!=null?Ns:Ce.ticket_url?[Ce.ticket_url]:[],poster_image_url:(ar=Ce.poster_image_url)!=null?ar:null,setlist:(rn=Ce.setlist)!=null?rn:null,setlist_enriched:(Gn=Ce.setlist_enriched)!=null?Gn:!1,setlist_song_count:(Mr=Ce.setlist_song_count)!=null?Mr:null,setlist_fm_id:(er=Ce.setlist_fm_id)!=null?er:null,setlist_fm_url:(ca=Ce.setlist_fm_url)!=null?ca:null,setlist_source:(wr=Ce.setlist_source)!=null?wr:null,setlist_last_updated:(Nn=Ce.setlist_last_updated)!=null?Nn:null,tour_name:(lu=Ce.tour_name)!=null?lu:null,created_at:(rl=Ce.created_at)!=null?rl:null,updated_at:(Cx=Ce.updated_at)!=null?Cx:null,is_promoted:(Gc=Ce.is_promoted)!=null?Gc:!1,promotion_tier:(Da=Ce.promotion_tier)!=null?Da:null,active_promotion_id:(Bp=Ce.active_promotion_id)!=null?Bp:null,ticket_price_min:(Up=Ce.ticket_price_min)!=null?Up:null,ticket_price_max:(Px=Ce.ticket_price_max)!=null?Px:null}}).filter(he=>typeof he.latitude=="number"&&typeof he.longitude=="number"),[Xa]),Vl=es.length>1?6:9,Lp=x.useMemo(()=>{var je,sr,kt,Dt;const he=Xa.find(Vt=>Vt.type==="event"&&!!Vt.event_data);if(!he||!he.event_data)return null;const Ce=he.event_data,st=Ce.poster_image_url||(Array.isArray(Ce.images)?(je=Ce.images.find(Vt=>Vt==null?void 0:Vt.url))==null?void 0:je.url:void 0)||null;return{eventId:Ce.id||he.id,title:Ce.title||he.title||Ce.artist_name||"Upcoming Event",artistName:Ce.artist_name||((sr=he.event_info)==null?void 0:sr.artist_name),venueName:Ce.venue_name||((kt=he.event_info)==null?void 0:kt.venue_name),eventDate:Ce.event_date||((Dt=he.event_info)==null?void 0:Dt.event_date),imageUrl:st,distanceMiles:he.distance_miles,eventData:Ce}},[Xa]);x.useEffect(()=>{f&&f(Lp)},[Lp,f]),x.useEffect(()=>{if(we)return;const he=es.find(Ce=>typeof Ce.latitude=="number"&&typeof Ce.longitude=="number");he&&typeof he.latitude=="number"&&typeof he.longitude=="number"?ae([he.latitude,he.longitude]):ae(B5)},[es,we]);const bx=x.useMemo(()=>Xa.filter(he=>he.type==="event").map((he,Ce)=>{var st,je,sr,kt,Dt;return{id:((st=he.event_data)==null?void 0:st.id)||he.id,metadata:{source:"feed",position:Ce,feed_tab:Tt,feed_type:wt,artist_name:((je=he.event_data)==null?void 0:je.artist_name)||((sr=he.event_info)==null?void 0:sr.artist_name),venue_name:((kt=he.event_data)==null?void 0:kt.venue_name)||((Dt=he.event_info)==null?void 0:Dt.venue_name),distance_miles:he.distance_miles,relevance_score:he.relevance_score}}}),[Xa,Tt,wt]),Rj=Mhe("event",bx,{threshold:.5,trackOnce:!0,debounce:500}),jx=({item:he})=>{var je,sr;const[Ce,st]=x.useState(null);return x.useEffect(()=>{E(void 0,null,function*(){var kt,Dt,Vt;try{if(Array.isArray(he.photos)&&he.photos.length>0){console.log("ReviewHeroImage: Using item photos:",he.photos[0]),st(he.photos[0]);return}const ur=((kt=he.event_info)==null?void 0:kt.artist_name)||"";if(!ur){console.log("ReviewHeroImage: No artist name, setting null"),st(null);return}const{data:Ur}=yield T.from("events").select("id").ilike("artist_name",`%${ur}%`).limit(20);if(Ur&&Ur.length>0){const _r=Ur.map(ar=>ar.id),cn=yield T.from("reviews").select("photos").not("photos","is",null).in("event_id",_r).order("likes_count",{ascending:!1}).limit(1),Ns=Array.isArray(cn.data)&&((Vt=(Dt=cn.data[0])==null?void 0:Dt.photos)==null?void 0:Vt[0]);if(Ns){console.log("ReviewHeroImage: Using artist review photo:",Ns),st(Ns);return}}st(null)}catch(ur){console.error("ReviewHeroImage: Error resolving image:",ur),st(null)}})},[he.id,he.photos,(je=he.event_info)==null?void 0:je.artist_name]),Ce?s.jsx("div",{className:"h-44 w-full overflow-hidden rounded-t-lg",children:s.jsx("img",{src:Ce,alt:((sr=he.event_info)==null?void 0:sr.event_name)||he.title,className:"w-full h-full object-cover",loading:"lazy"})}):null};return q||ne?(console.log(" Showing skeleton loading state",{loading:q,isInitializing:ne}),s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6 w-full",children:[s.jsx(zN,{}),s.jsx(zN,{}),s.jsx(zN,{})]})})):s.jsxs("div",{className:N,style:S,children:[s.jsxs("div",{className:k,children:[B&&s.jsx("div",{className:P,children:s.jsxs("div",{children:[z&&s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:$}),D&&s.jsx("p",{className:"text-gray-600 mt-2",children:O})]})}),s.jsxs(Li,{value:Tt,onValueChange:he=>Or(he),children:[p!==!1&&s.jsx(yi,{className:`grid w-full ${b?"mb-1 mt-0":"mb-6"} bg-white/60 backdrop-blur-sm border border-white/20 rounded-2xl p-1 ${w}`,children:v.map(he=>{const{label:Ce,icon:st}=oge[he];return s.jsxs(Xr,{value:he,className:"flex items-center gap-2 data-[state=active]:bg-synth-pink data-[state=active]:text-white rounded-xl",children:[s.jsx(st,{className:"w-4 h-4"}),Ce]},he)})}),Tt==="events"&&v.includes("events")&&s.jsxs("div",{className:`${b?"mb-1 pt-0":"mb-6"} flex flex-col gap-2 md:flex-row md:items-center md:justify-between`,children:[s.jsx("div",{className:`${b?"flex-1":"md:flex-1"}`,children:s.jsx(tge,{filters:ir,onFiltersChange:he=>{console.log(" Filter change detected:",he),pe.current=!0,yt.current=!0,rr(he),De.current&&clearTimeout(De.current),De.current=setTimeout(()=>{console.log(" Applying debounced filters, regenerating personalized feed..."),jt(he),bt(0),e&&Za(0,!1,!0,he)},400)},availableGenres:Wc,availableCities:Ie,onOverlayChange:he=>rr(Ce=>H(M({},Ce),{showFilters:he})),className:b?"space-y-0":""})}),b&&r&&i&&s.jsx("div",{className:"flex items-center gap-2 flex-shrink-0 -mt-1",children:s.jsx(lde,{currentUserId:e,onNavigateToNotifications:r,onNavigateToChat:i,className:"flex-shrink-0"})}),!b&&F&&s.jsxs(le,{variant:"outline",size:"sm",className:"md:self-start",onClick:()=>oe(!0),disabled:es.length===0,children:[s.jsx(CQ,{className:"h-4 w-4 mr-2"}),"Map View"]})]}),v.includes("events")&&s.jsxs(Jr,{value:"events",className:"mt-0 space-y-4",children:[s.jsx("div",{className:"space-y-4",children:Xa.filter(he=>he.type==="event").map((he,Ce)=>{var st,je,sr,kt,Dt,Vt,ur,Ur,_r,cn,Ns;return s.jsx(He,{className:ke("cursor-pointer overflow-hidden group",((st=he.event_data)==null?void 0:st.is_promoted)&&"ring-2 ring-yellow-400/50 shadow-lg shadow-yellow-200/30 border-yellow-200/50"),ref:ar=>{var rn;return ar&&Rj(ar,((rn=he.event_data)==null?void 0:rn.id)||he.id)},"data-tour":Ce===0?"event-card":void 0,onClick:ar=>E(void 0,null,function*(){if(!ar.defaultPrevented&&he.event_data){const{PromotionTrackingService:rn}=yield kn(()=>E(void 0,null,function*(){const{PromotionTrackingService:Gn}=yield Promise.resolve().then(()=>Yue);return{PromotionTrackingService:Gn}}),void 0,import.meta.url);rn.trackPromotionInteraction(he.event_data.id,e,"click",{source:"feed_event_card_click",artist_name:he.event_data.artist_name,venue_name:he.event_data.venue_name}),Ue(he.event_data);try{const Gn=yield Qr.isUserInterested(e,he.event_data.id);mt(Gn)}catch(Gn){mt(!1)}ge(!0)}}),children:s.jsxs(et,{className:"p-6",children:[he.type!=="event"&&s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Vr,{className:"w-10 h-10 ring-2 ring-synth-pink/20",children:[s.jsx(sn,{src:((je=he.author)==null?void 0:je.avatar_url)||void 0}),s.jsx(Wr,{className:"text-sm font-semibold bg-synth-pink/10 text-synth-pink",children:((kt=(sr=he.author)==null?void 0:sr.name)==null?void 0:kt.split(" ").map(ar=>ar[0]).join(""))||"U"})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-sm text-gray-900",children:((Dt=he.author)==null?void 0:Dt.name)||"Anonymous"}),s.jsx("p",{className:"text-xs text-gray-500",children:he.type.charAt(0).toUpperCase()+he.type.slice(1)})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(Ke,{className:"synth-badge text-xs",children:[s.jsx(It,{className:"w-3 h-3 mr-1"}),he.type.charAt(0).toUpperCase()+he.type.slice(1)]})})]}),s.jsx("div",{className:"mb-4",children:s.jsx(jx,{item:he})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h2",{className:"font-bold text-lg text-gray-900",children:he.title}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(sme,{followedArtists:vt,followedVenues:Pe,artistName:(Vt=he.event_data)==null?void 0:Vt.artist_name,venueName:(ur=he.event_data)==null?void 0:ur.venue_name,venueCity:(Ur=he.event_data)==null?void 0:Ur.venue_city,venueState:(_r=he.event_data)==null?void 0:_r.venue_state}),((cn=he.event_data)==null?void 0:cn.is_promoted)&&((Ns=he.event_data)==null?void 0:Ns.promotion_tier)&&s.jsx(E8,{promotionTier:he.event_data.promotion_tier})]})]}),he.event_data&&s.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(gr,{className:"w-4 h-4 text-synth-pink"}),s.jsx("span",{children:he.event_data.venue_name}),he.event_data.venue_city&&s.jsxs("span",{className:"text-gray-500",children:[" ",he.event_data.venue_city]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(It,{className:"w-4 h-4 text-synth-pink"}),s.jsx("span",{children:Mt(ms(he.event_data.event_date),"EEEE, MMMM d, yyyy")})]}),(()=>{var er,ca;const ar=he.event_data,rn=ar==null?void 0:ar.price_range,Gn=(er=ar==null?void 0:ar.ticket_price_min)!=null?er:ar==null?void 0:ar.price_min,Mr=(ca=ar==null?void 0:ar.ticket_price_max)!=null?ca:ar==null?void 0:ar.price_max;if(rn||Gn||Mr){let wr="";return rn?wr=Fv(rn):Gn&&Mr?wr=`$${Gn} - $${Mr}`:Gn?wr=`$${Gn}+`:Mr&&(wr=`Up to $${Mr}`),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ml,{className:"w-4 h-4 text-synth-pink"}),s.jsx("span",{className:"font-medium",children:wr})]})}return null})()]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[he.type==="event"&&he.event_data?s.jsxs("button",{onClick:ar=>{ar.stopPropagation(),ou(he)},className:`flex items-center gap-1 text-sm transition-colors px-3 py-1 rounded-md ${dt.has(he.event_data.id)?"bg-pink-500 text-white hover:bg-pink-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[s.jsx(ns,{className:`w-4 h-4 ${dt.has(he.event_data.id)?"fill-current":""}`}),s.jsx("span",{children:dt.has(he.event_data.id)?"Interested":"I'm Interested"})]}):s.jsxs("button",{onClick:ar=>{ar.stopPropagation(),xa(he)},className:`flex items-center gap-1 text-sm transition-colors ${it.has(he.id)?"text-red-500":"text-gray-500 hover:text-red-500"}`,children:[s.jsx(ns,{className:`w-4 h-4 ${it.has(he.id)?"fill-current":""}`}),s.jsx("span",{children:he.likes_count||0})]}),s.jsxs("button",{onClick:ar=>{var rn;ar.stopPropagation(),Ft(((rn=he.event_data)==null?void 0:rn.id)||he.id)},className:"flex items-center gap-1 text-sm text-gray-500 hover:text-blue-500 transition-colors",children:[s.jsx($n,{className:"w-4 h-4"}),s.jsx("span",{children:he.comments_count||0})]}),s.jsxs("button",{onClick:ar=>{ar.stopPropagation(),fn(he)},className:"flex items-center gap-1 text-sm text-gray-500 hover:text-green-500 transition-colors",children:[s.jsx(zd,{className:"w-4 h-4"}),s.jsx("span",{children:"Share"})]})]}),s.jsx("div",{className:"text-xs text-gray-400",children:_s(he.created_at)})]})]})]})},`event-${he.id}-${Ce}`)})}),U.length>0&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-6 mt-6",children:[!Q&&s.jsx("p",{className:"text-gray-500 text-sm mb-3",children:"You're all caught up! "}),s.jsx(le,{onClick:()=>Za(U.length),disabled:Z||!Q,className:ke("text-white shadow-lg px-6 py-2",Q?"bg-synth-pink hover:bg-synth-pink-dark":"bg-gray-400 cursor-not-allowed"),children:Z?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"h-4 w-4 mr-2 animate-spin"}),"Loading more events..."]}):Q?s.jsx(s.Fragment,{children:"Load more (20 events)"}):s.jsx(s.Fragment,{children:"You're all caught up"})})]})]}),v.includes("reviews")&&s.jsx(Jr,{value:"reviews",className:"mt-6",children:U.filter(he=>he.type==="review"&&!he.deleted_at&&!he.is_deleted).length===0?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"flex flex-col gap-[6px] items-center justify-center",children:[s.jsx(Qt,{className:"w-[60px] h-[60px]",style:{color:"var(--neutral-600)"}}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No reviews yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Be the first to share a concert review!"})]})}):s.jsx("div",{className:"space-y-6",children:(()=>{const he=U.filter(je=>je.type==="review"&&!je.deleted_at&&!je.is_deleted),Ce=he.slice(0,3),st=he.slice(3);return s.jsxs(s.Fragment,{children:[Ce.map((je,sr)=>{var kt,Dt,Vt,ur,Ur,_r,cn,Ns,ar,rn,Gn;return console.log(" Review item author data:",{id:je.id,authorName:(kt=je.author)==null?void 0:kt.name,avatarUrl:(Dt=je.author)==null?void 0:Dt.avatar_url,authorId:(Vt=je.author)==null?void 0:Vt.id,fullAuthor:je.author}),s.jsx(sw,{review:{id:je.review_id||je.id,user_id:((ur=je.author)==null?void 0:ur.id)||e,event_id:je.event_id||"",rating:typeof je.rating=="number"?je.rating:(Ur=typeof je.rating=="string"?parseFloat(je.rating):null)!=null?Ur:0,review_text:je.content||"",is_public:!0,created_at:je.created_at,updated_at:je.updated_at||je.created_at,likes_count:je.likes_count||0,comments_count:je.comments_count||0,shares_count:je.shares_count||0,is_liked_by_user:it.has(je.id),reaction_emoji:je.reaction_emoji||"",photos:je.photos||[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:(_r=je.event_info)==null?void 0:_r.artist_name,venue_name:(cn=je.event_info)==null?void 0:cn.venue_name,artist_performance_rating:je.artist_performance_rating,production_rating:je.production_rating,venue_rating:je.venue_rating,location_rating:je.location_rating,value_rating:je.value_rating,artist_performance_feedback:je.artist_performance_feedback,production_feedback:je.production_feedback,venue_feedback:je.venue_feedback,location_feedback:je.location_feedback,value_feedback:je.value_feedback,ticket_price_paid:je.ticket_price_paid,setlist:je.setlist,custom_setlist:je.custom_setlist,connection_degree:je.connection_degree,connection_type_label:je.connection_type_label},currentUserId:e,onLike:(Mr,er)=>{console.log(" BelliStyle onLike:",{reviewId:Mr,isLiked:er,itemId:je.id}),zt(er?ca=>new Set([...ca,je.id]):ca=>{const wr=new Set(ca);return wr.delete(je.id),wr})},onComment:()=>Lt(je.review_id||je.id),onShare:Mr=>{fn(je)},onEdit:()=>{console.log("Edit button clicked for review:",je.review_id||je.id),console.log("Full item data:",je),E(void 0,null,function*(){try{const{data:er,error:ca}=yield T.from("reviews").select(`
                              *,
                              events!inner (
                                id,
                                title,
                                artist_name,
                                artist_id,
                                venue_name,
                                venue_id,
                                venue_city,
                                venue_state,
                                venue_zip,
                                venue_address,
                                event_date,
                                doors_time,
                                description,
                                genres,
                                price_range,
                                ticket_urls,
                                setlist
                              )
                            `).eq("id",je.review_id||je.id).single();if(ca){console.error("Error fetching review:",ca);return}if(er&&er.events){const wr=er.events,Nn=er;console.log(" Setting up edit modal with event data:",{eventId:wr.id,artistName:wr.artist_name,venueName:wr.venue_name,hasSetlist:!!wr.setlist,reviewId:Nn.id}),xe({id:wr.id,jambase_event_id:wr.jambase_event_id,title:wr.title||"Concert Review",artist_name:wr.artist_name,artist_id:wr.artist_id,venue_name:wr.venue_name,venue_id:wr.venue_id,event_date:wr.event_date,doors_time:wr.doors_time,description:wr.description,genres:wr.genres,venue_city:wr.venue_city,venue_state:wr.venue_state,venue_zip:wr.venue_zip,venue_address:wr.venue_address,price_range:wr.price_range,ticket_urls:wr.ticket_urls,setlist:wr.setlist,existing_review_id:Nn.id,existing_review:{rating:Nn.rating,review_text:Nn.review_text,artist_performance_rating:Nn.artist_performance_rating,production_rating:Nn.production_rating,venue_rating:Nn.venue_rating,location_rating:Nn.location_rating,value_rating:Nn.value_rating,artist_performance_feedback:Nn.artist_performance_feedback,production_feedback:Nn.production_feedback,venue_feedback:Nn.venue_feedback,location_feedback:Nn.location_feedback,value_feedback:Nn.value_feedback,ticket_price_paid:Nn.ticket_price_paid,reaction_emoji:Nn.reaction_emoji,is_public:Nn.is_public,review_type:Nn.review_type,photos:Nn.photos,custom_setlist:Nn.custom_setlist,selectedSetlist:wr.setlist,venue_tags:Nn.venue_tags,artist_tags:Nn.artist_tags,mood_tags:Nn.mood_tags,genre_tags:Nn.genre_tags,context_tags:Nn.context_tags}}),ee(!0)}}catch(er){console.error("Error loading review data for edit:",er)}})},onDelete:Mr=>E(void 0,null,function*(){try{yield bs.deleteEventReview(e,Mr),Za(0),ce({title:"Review Deleted",description:"Your review has been deleted."})}catch(er){console.error("Error deleting review:",er),ce({title:"Error",description:"Failed to delete review.",variant:"destructive"})}}),onReport:()=>Fe(je.id),userProfile:{name:((Ns=je.author)==null?void 0:Ns.name)||"User",avatar_url:((ar=je.author)==null?void 0:ar.avatar_url)||void 0,verified:(rn=je.author)==null?void 0:rn.verified,account_type:(Gn=je.author)==null?void 0:Gn.account_type},followedArtists:vt,followedVenues:Pe},`${je.id}-${sr}`)}),ds.length>0&&s.jsx(rge,{suggestions:ds,onUserClick:je=>a==null?void 0:a(je),onAddFriend:Cn}),st.map((je,sr)=>{var kt,Dt,Vt,ur,Ur,_r,cn,Ns;return s.jsx(sw,{review:{id:je.review_id||je.id,user_id:((kt=je.author)==null?void 0:kt.id)||e,event_id:je.event_id||"",rating:typeof je.rating=="number"?je.rating:(Dt=typeof je.rating=="string"?parseFloat(je.rating):null)!=null?Dt:0,review_text:je.content||"",is_public:!0,created_at:je.created_at,updated_at:je.updated_at||je.created_at,likes_count:je.likes_count||0,comments_count:je.comments_count||0,shares_count:je.shares_count||0,is_liked_by_user:it.has(je.id),reaction_emoji:je.reaction_emoji||"",photos:je.photos||[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:(Vt=je.event_info)==null?void 0:Vt.artist_name,venue_name:(ur=je.event_info)==null?void 0:ur.venue_name,artist_performance_rating:je.artist_performance_rating,production_rating:je.production_rating,venue_rating:je.venue_rating,location_rating:je.location_rating,value_rating:je.value_rating,artist_performance_feedback:je.artist_performance_feedback,production_feedback:je.production_feedback,venue_feedback:je.venue_feedback,location_feedback:je.location_feedback,value_feedback:je.value_feedback,ticket_price_paid:je.ticket_price_paid,setlist:je.setlist,custom_setlist:je.custom_setlist,connection_degree:je.connection_degree,connection_type_label:je.connection_type_label},currentUserId:e,onLike:(ar,rn)=>{zt(rn?Gn=>new Set([...Gn,je.id]):Gn=>{const Mr=new Set(Gn);return Mr.delete(je.id),Mr})},onComment:()=>Lt(je.review_id||je.id),onShare:ar=>fn(je),onEdit:()=>{E(void 0,null,function*(){try{const{data:rn,error:Gn}=yield T.from("reviews").select(`
                                    *,
                                    events!inner (
                                      id, title, artist_name, artist_id, venue_name, venue_id,
                                      venue_city, venue_state, venue_zip, venue_address,
                                      event_date, doors_time, description, genres,
                                      price_range, ticket_urls, setlist
                                    )
                                  `).eq("id",je.review_id||je.id).single();if(Gn||!rn||!rn.events)return;const Mr=rn.events,er=rn;xe({id:Mr.id,jambase_event_id:Mr.jambase_event_id,title:Mr.title||"Concert Review",artist_name:Mr.artist_name,artist_id:Mr.artist_id,venue_name:Mr.venue_name,venue_id:Mr.venue_id,event_date:Mr.event_date,doors_time:Mr.doors_time,description:Mr.description,genres:Mr.genres,venue_city:Mr.venue_city,venue_state:Mr.venue_state,venue_zip:Mr.venue_zip,venue_address:Mr.venue_address,price_range:Mr.price_range,ticket_urls:Mr.ticket_urls,setlist:Mr.setlist,existing_review_id:er.id,existing_review:{rating:er.rating,review_text:er.review_text,artist_performance_rating:er.artist_performance_rating,production_rating:er.production_rating,venue_rating:er.venue_rating,location_rating:er.location_rating,value_rating:er.value_rating,artist_performance_feedback:er.artist_performance_feedback,production_feedback:er.production_feedback,venue_feedback:er.venue_feedback,location_feedback:er.location_feedback,value_feedback:er.value_feedback,ticket_price_paid:er.ticket_price_paid,reaction_emoji:er.reaction_emoji,is_public:er.is_public,review_type:er.review_type,photos:er.photos,custom_setlist:er.custom_setlist,selectedSetlist:Mr.setlist,venue_tags:er.venue_tags,artist_tags:er.artist_tags,mood_tags:er.mood_tags,genre_tags:er.genre_tags,context_tags:er.context_tags}}),ee(!0)}catch(rn){console.error("Error loading review data for edit:",rn)}})},onDelete:ar=>E(void 0,null,function*(){try{yield bs.deleteEventReview(e,ar),Za(0),ce({title:"Review Deleted",description:"Your review has been deleted."})}catch(rn){console.error("Error deleting review:",rn),ce({title:"Error",description:"Failed to delete review.",variant:"destructive"})}}),onReport:()=>Fe(je.id),userProfile:{name:((Ur=je.author)==null?void 0:Ur.name)||"User",avatar_url:((_r=je.author)==null?void 0:_r.avatar_url)||void 0,verified:(cn=je.author)==null?void 0:cn.verified,account_type:(Ns=je.author)==null?void 0:Ns.account_type},followedArtists:vt,followedVenues:Pe},`${je.id}-${sr+3}`)})]})})()})}),v.includes("news")&&s.jsxs(Jr,{value:"news",className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Music News"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("select",{value:en,onChange:he=>Hn(he.target.value),className:"px-3 py-1 text-sm border border-gray-200 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-pink-500",children:[s.jsx("option",{value:"all",children:"All Sources"}),s.jsx("option",{value:"pitchfork",children:"Pitchfork"}),s.jsx("option",{value:"rollingstone",children:"Rolling Stone"}),s.jsx("option",{value:"nme",children:"NME"}),s.jsx("option",{value:"billboard",children:"Billboard"})]}),s.jsx(le,{onClick:()=>{Pf.clearCache(),nr()},variant:"outline",size:"sm",disabled:Xt,className:"text-pink-600 border-pink-200 hover:bg-pink-50",children:Xt?s.jsx("div",{className:"w-4 h-4 animate-spin rounded-full border-2 border-pink-500 border-t-transparent"}):"Refresh"})]})]}),Xt&&Gt.length===0&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((he,Ce)=>s.jsx(tme,{},Ce))}),!Xt&&Gt.length>0&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Pf.filterBySource(Gt,en).map(he=>s.jsx(eme,{article:he},he.id))}),!Xt&&Gt.length===0&&s.jsx(Ele,{icon:s.jsx(wP,{className:"w-[60px] h-[60px]",style:{color:"var(--neutral-600)"}}),title:"No news articles found",description:"Check back later for the latest music news and updates!"})]})]}),F&&s.jsx(pn,{open:we,onOpenChange:oe,children:s.jsxs(dn,{className:"sm:max-w-[900px] w-full h-[80vh]",children:[s.jsxs(Vn,{children:[s.jsx(bn,{children:"Events Map"}),s.jsx(os,{children:"Explore upcoming events from your feed on an interactive map."})]}),es.length>0?s.jsx("div",{className:"h-[calc(80vh-120px)] w-full",children:s.jsx(TU,{center:_e,zoom:Vl,events:es,onEventClick:bi,onMapCenterChange:he=>ae(he)})}):s.jsx("div",{className:"flex h-[calc(80vh-120px)] items-center justify-center rounded-lg border border-dashed border-muted-foreground/40",children:s.jsx("p",{className:"px-6 text-center text-sm text-muted-foreground",children:"No events in your feed have location data yet. Try adjusting your filters or check back soon."})})]})})]}),s.jsx("div",{style:{height:"0px"}}),ye&&s.jsx(lB,{isOpen:ye,onClose:()=>ee(!1),event:de,userId:e,onReviewSubmitted:()=>{ee(!1),Za()}}),Xe&&We&&s.jsx(Bl,{isOpen:Xe,onClose:()=>ge(!1),event:We,currentUserId:e,onReview:()=>{We&&(xe(We),ee(!0))},onInterestToggle:(he,Ce)=>E(void 0,null,function*(){try{yield Qr.setEventInterest(e,he,Ce),mt(Ce),G(st=>st.map(je=>{var sr;return je.type==="event"&&((sr=je.event_data)==null?void 0:sr.id)===he?H(M({},je),{event_data:H(M({},je.event_data),{isInterested:Ce})}):je})),setTimeout(()=>{Za(0,!1)},500),ce({title:Ce?"Event Added!":"Event Removed",description:Ce?"You're now interested in this event":"You're no longer interested in this event"})}catch(st){console.error("Failed to toggle interest from feed modal",st),ce({title:"Error",description:"Failed to update your interest. Please try again.",variant:"destructive"})}}),onAttendanceChange:(he,Ce)=>{console.log(" Attendance changed in feed:",he,Ce),Ce&&G(st=>st.map(je=>{var sr;return je.type==="event"&&((sr=je.event_data)==null?void 0:sr.id)===he?H(M({},je),{event_data:H(M({},je.event_data),{isInterested:!1,hasAttended:!0})}):je}))},isInterested:at,onNavigateToProfile:a,onNavigateToChat:i}),Ye&&s.jsx(TB,{eventId:Ye,isOpen:!!Ye,onClose:()=>Ft(null)}),_t&&s.jsx(Que,{reviewId:_t,isOpen:!!_t,onClose:()=>Lt(null)}),Oe&&s.jsx(the,{eventId:Oe,isOpen:!!Oe,onClose:()=>qe(null)}),Pt&&un&&s.jsx(ET,{event:un,currentUserId:e,isOpen:Pt,onClose:()=>yr(!1)}),xn&&hr&&s.jsx(cB,{review:hr,currentUserId:e,isOpen:xn,onClose:()=>{Rt(!1),or(null)}}),V&&s.jsx(Nq,{currentUserId:e,onBack:()=>ue(!1)}),ve&&ze&&s.jsx(pn,{open:ve,onOpenChange:Me,children:s.jsxs(dn,{className:"max-w-5xl w-[90vw] h-[90vh] max-h-[90vh] p-0 overflow-hidden flex",children:[s.jsx(bn,{className:"sr-only",children:"Review Details"}),s.jsxs(os,{className:"sr-only",children:["Review details for ",((Nx=ze.event_info)==null?void 0:Nx.artist_name)||"artist"]}),s.jsx("div",{className:"flex-1 bg-black flex items-center justify-center min-h-0",children:ze.photos&&ze.photos.length>0?s.jsx("img",{src:ze.photos[0],alt:"Review photo",className:"max-w-full max-h-full object-contain"}):s.jsxs("div",{className:"text-center text-white",children:[s.jsxs("div",{className:"text-6xl font-bold mb-4",children:[s.jsx("span",{className:"text-pink-500",children:"S"}),"ynth"]}),s.jsx("div",{className:"w-32 h-0.5 bg-white mx-auto mb-4"}),s.jsx("div",{className:"text-sm opacity-80",children:"Concert Review"})]})}),s.jsxs("div",{className:"flex-1 flex flex-col bg-white",children:[s.jsx("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white text-sm font-bold",children:((tn=(Fp=ze.author)==null?void 0:Fp.name)==null?void 0:tn.charAt(0))||"U"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold text-sm",children:((Sx=ze.author)==null?void 0:Sx.name)||"User"}),s.jsx("div",{className:"text-xs text-gray-500",children:new Date(ze.created_at).toLocaleDateString()})]})]})}),s.jsxs("div",{className:"flex-1 p-4 space-y-4 overflow-y-auto",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("div",{className:"flex items-start justify-between mb-3",children:s.jsxs("div",{className:"flex-1",children:[s.jsx("h2",{className:"text-lg font-semibold mb-1",children:((Ja=ze.event_info)==null?void 0:Ja.event_name)||"Concert Review"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[(Hc=ze.event_info)==null?void 0:Hc.artist_name,"  ",(zp=ze.event_info)!=null&&zp.event_date?new Date(ze.event_info.event_date).toLocaleDateString():"Date unknown"]}),((kx=ze.event_info)==null?void 0:kx.venue_name)&&s.jsx("p",{className:"text-sm text-gray-500",children:ze.event_info.venue_name})]})}),s.jsx("div",{className:"flex items-center gap-2",children:(Ih=ze.event_info)!=null&&Ih.event_date&&new Date(ze.event_info.event_date)<new Date?s.jsxs(Ke,{variant:"secondary",className:"text-xs bg-gray-100 text-gray-700",children:[s.jsx(It,{className:"w-3 h-3 mr-1"}),"Past Event"]}):s.jsxs(Ke,{variant:"secondary",className:"text-xs bg-blue-100 text-blue-700",children:[s.jsx(It,{className:"w-3 h-3 mr-1"}),"Upcoming"]})})]}),ze.rating&&s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("div",{className:"flex items-center gap-1",children:[Array.from({length:5},(he,Ce)=>s.jsx(Qt,{className:`w-5 h-5 ${Ce<Math.floor(ze.rating)?"text-yellow-500 fill-yellow-500":"text-gray-300"}`},Ce)),s.jsxs("span",{className:"text-sm font-medium ml-1",children:[ze.rating,"/5"]})]})}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Review"}),s.jsx("p",{className:"text-gray-700 leading-relaxed",children:ze.content||"No review text available."})]}),s.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-gray-200",children:[s.jsxs("button",{onClick:()=>xa(ze),className:`flex items-center gap-2 transition-colors ${it.has(ze.id)?"text-red-500":"text-gray-700 hover:text-red-500"}`,children:[s.jsx(ns,{className:`w-5 h-5 ${it.has(ze.id)?"fill-current":""}`}),s.jsxs("span",{children:[ze.likes_count||0," likes"]})]}),s.jsxs("button",{onClick:()=>Lt(ze.review_id||ze.id),className:"flex items-center gap-2 text-gray-700 hover:text-blue-500 transition-colors",children:[s.jsx($n,{className:"w-5 h-5"}),s.jsxs("span",{children:[ze.comments_count||0," comments"]})]}),s.jsxs("button",{onClick:()=>fn(ze),className:"flex items-center gap-2 text-gray-700 hover:text-green-500 transition-colors",children:[s.jsx(zd,{className:"w-5 h-5"}),s.jsx("span",{children:"Share"})]}),s.jsxs("button",{onClick:()=>Ms(ze),className:`flex items-center gap-2 transition-colors ${Bt.has(ze.id)?"text-yellow-500":"text-gray-700 hover:text-yellow-500"}`,children:[s.jsx(dQ,{className:`w-5 h-5 ${Bt.has(ze.id)?"fill-current":""}`}),s.jsx("span",{children:"Save"})]})]})]})]})]})}),s.jsx(pn,{open:Br.open,onOpenChange:he=>En({open:he,artist:null,events:void 0,totalEvents:void 0}),children:s.jsxs(dn,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(bn,{className:"sr-only",children:"Artist Profile"}),s.jsxs(os,{className:"sr-only",children:["Artist profile for ",((Ex=Br.artist)==null?void 0:Ex.name)||"artist"]}),Br.artist&&(la?s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(lr,{className:"w-6 h-6 animate-spin text-pink-500"}),s.jsx("span",{className:"ml-2",children:"Loading events..."})]}):s.jsx(rme,{artist:Br.artist,events:Br.events||[],totalEvents:Br.totalEvents||0,source:Br.events&&Br.events.length>0?"api":"database",userId:e,onBack:()=>En({open:!1,artist:null,events:void 0,totalEvents:void 0}),showAllEvents:!0}))]})}),s.jsx(pn,{open:$r.open,onOpenChange:he=>Qn({open:he,venueId:null,venueName:""}),children:s.jsxs(dn,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(bn,{className:"sr-only",children:"Venue Profile"}),s.jsxs(os,{className:"sr-only",children:["Venue profile for ",$r.venueName||"venue"]}),s.jsx(nme,{venueId:$r.venueId,venueName:$r.venueName,onClose:()=>Qn({open:!1,venueId:null,venueName:""})})]})}),Re&&s.jsx(CU,{isOpen:Mn,onClose:()=>{fe(!1),ot(null)},contentType:"event",contentId:Re.id,contentTitle:Re.title})]})},cge=({isOpen:e,onClose:t,type:r,friends:n,count:a,onStartChat:i,onViewProfile:o,onUnfriend:l})=>{const c=r==="friends"?"Friends":r==="followers"?"Followers":"Following";return s.jsx(pn,{open:e,onOpenChange:t,children:s.jsxs(dn,{className:"sm:max-w-lg w-[95vw] max-h-[80vh] flex flex-col",children:[s.jsx(Vn,{className:"flex-shrink-0",children:s.jsx(bn,{className:"text-center",children:c})}),s.jsx(p1,{className:"flex-1 max-h-[60vh]",children:s.jsx("div",{className:"space-y-2 py-2",children:n.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Rs,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:r==="friends"?"No friends yet":r==="followers"?"No followers yet":"Not following anyone yet"})]}):n.map(d=>s.jsxs("div",{className:"flex items-center gap-3 hover:bg-muted/40 rounded-lg p-3 transition-colors mx-2",children:[s.jsxs(Vr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(sn,{src:d.avatar_url||void 0}),s.jsx(Wr,{className:"text-sm",children:d.name?d.name.split(" ").map(u=>u[0]).join(""):"U"})]}),s.jsxs("div",{className:"flex-1 min-w-0 mr-2",onClick:()=>o&&o(d),children:[s.jsx("p",{className:"font-semibold text-sm truncate",children:d.name}),s.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["@",d.username]}),d.bio&&s.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:d.bio})]}),s.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[o&&s.jsx(le,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 hover:bg-gray-100",onClick:u=>{u.stopPropagation(),o(d)},children:s.jsx(Kd,{className:"w-4 h-4"})}),i&&s.jsx(le,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 hover:bg-gray-100",onClick:u=>{u.stopPropagation(),i(d.user_id)},children:s.jsx($n,{className:"w-4 h-4"})}),l&&r==="friends"&&s.jsx(le,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",onClick:u=>E(void 0,null,function*(){u.stopPropagation();try{yield l(d.user_id)}catch(f){console.error("Error unfriending user:",f)}}),children:s.jsx(MF,{className:"w-4 h-4"})})]})]},d.id))})})]})})};function dge({isOpen:e,onClose:t,userId:r,profileName:n,isOwnProfile:a=!1,onNavigateToProfile:i}){const o=as(),[l,c]=x.useState([]),[d,u]=x.useState([]),[f,h]=x.useState([]),[p,g]=x.useState(!0),[v,y]=x.useState(null),[_,w]=x.useState("users");x.useEffect(()=>{e&&r?(console.log(" FollowingModal: Loading following for user:",r),b()):(c([]),u([]),h([]),g(!0))},[e,r]);const b=()=>E(this,null,function*(){try{g(!0),y(null),console.log(" FollowingModal: Fetching users, artists and venues for user:",r);const[P,A,R]=yield Promise.all([T.from("user_relationships").select("related_user_id, created_at").eq("user_id",r).eq("relationship_type","follow").order("created_at",{ascending:!1}),Si.getUserFollowedArtists(r),Tu.getUserFollowedVenues(r)]);if(P.error)console.error("Error fetching followed users:",P.error);else{const D=(P.data||[]).map(B=>B.related_user_id).filter(Boolean);if(D.length>0){const{data:B,error:F}=yield T.from("users").select("id, user_id, name, username, avatar_url, bio").in("user_id",D);if(F)console.error("Error fetching user profiles:",F);else{const U=(B||[]).sort((G,q)=>(G.name||"").localeCompare(q.name||"",void 0,{sensitivity:"base"})).map(G=>({id:G.id,user_id:G.user_id,name:G.name||"Unknown User",username:G.username,avatar_url:G.avatar_url,bio:G.bio}));c(U),console.log(" FollowingModal: Set users:",U.length)}}}console.log(" FollowingModal: Received artists:",A.length,"venues:",R.length),console.log(" FollowingModal: Artist details:",A.map(D=>({name:D.artist_name,id:D.artist_id})));const $=A.filter(D=>D.artist_name&&D.artist_name.trim()!=="");$.length<A.length&&console.warn(` Filtered out ${A.length-$.length} artists without names`);const O=[...$].sort((D,B)=>(D.artist_name||"").localeCompare(B.artist_name||"",void 0,{sensitivity:"base"})),z=[...R].sort((D,B)=>(D.venue_name||"").localeCompare(B.venue_name||"",void 0,{sensitivity:"base"}));u(O),h(z),console.log(" FollowingModal: Set artists:",O.length,"venues:",z.length)}catch(P){console.error(" FollowingModal: Error loading following:",P),y("Failed to load following")}finally{g(!1)}}),N=P=>{if(!P.artist_name)return;const A=P.artist_id&&P.artist_id!=="manual"?P.artist_id:encodeURIComponent(P.artist_name);o(`/artist/${A}`),t()},S=P=>{if(!P.venue_name)return;const A=P.venue_id||encodeURIComponent(P.venue_name);o(`/venue/${A}`),t()},k=P=>{i&&i(P.user_id),t()};return l.length+d.length+f.length,s.jsx(pn,{open:e,onOpenChange:t,children:s.jsxs(dn,{className:"sm:max-w-lg w-[95vw] max-h-[80vh] flex flex-col p-0 max-w-[393px] mx-auto",children:[s.jsxs(Vn,{className:"flex-shrink-0 px-6 pt-6 pb-4 border-b relative",children:[s.jsx(bn,{className:"text-center text-lg font-semibold",children:"Following"}),s.jsx("button",{onClick:t,className:"absolute right-4 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full bg-[#cc2486] flex items-center justify-center hover:bg-[#b01f75] transition-colors","aria-label":"Close",children:s.jsx(Gr,{className:"w-4 h-4 text-white"})})]}),s.jsxs(Li,{value:_,onValueChange:P=>w(P),className:"flex-1 flex flex-col min-h-0",children:[s.jsxs(yi,{className:"w-full grid grid-cols-3 rounded-none border-b",children:[s.jsxs(Xr,{value:"users",className:"rounded-none",children:["Users (",l.length,")"]}),s.jsxs(Xr,{value:"artists",className:"rounded-none",children:["Artists (",d.length,")"]}),s.jsxs(Xr,{value:"venues",className:"rounded-none",children:["Venues (",f.length,")"]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4 min-h-0",children:p?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(lr,{className:"w-6 h-6 animate-spin text-[#cc2486] mr-2"}),s.jsx("span",{className:"text-muted-foreground",children:"Loading..."})]}):v?s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-red-600",children:v})}):s.jsxs(s.Fragment,{children:[s.jsx(Jr,{value:"users",className:"mt-0 space-y-2",children:l.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Rs,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:a?"Not following any users yet":`${n} is not following any users yet`})]}):l.map(P=>s.jsxs("div",{className:"flex items-center gap-3 hover:bg-muted/40 rounded-lg p-3 transition-colors mx-2",onClick:()=>k(P),children:[s.jsxs(Vr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(sn,{src:P.avatar_url||void 0}),s.jsx(Wr,{className:"text-sm",children:P.name?P.name.split(" ").map(A=>A[0]).join(""):"U"})]}),s.jsxs("div",{className:"flex-1 min-w-0 mr-2",children:[s.jsx("p",{className:"font-semibold text-sm truncate",children:P.name}),P.username?s.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["@",P.username]}):null,P.bio&&s.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:P.bio})]})]},P.user_id))}),s.jsx(Jr,{value:"artists",className:"mt-0 space-y-2",children:d.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx($t,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:a?"Not following any artists yet":`${n} is not following any artists yet`})]}):d.map(P=>s.jsxs("div",{className:"flex items-center gap-3 hover:bg-[rgba(201,201,201,0.2)] rounded-lg p-3 transition-colors cursor-pointer",onClick:()=>N(P),children:[s.jsxs(Vr,{className:"w-12 h-12 flex-shrink-0",children:[P.artist_image_url?s.jsx(sn,{src:P.artist_image_url,alt:P.artist_name||"Artist"}):null,s.jsx(Wr,{className:"bg-[#fdf2f7]",children:s.jsx($t,{className:"w-6 h-6 text-[#cc2486]"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-base truncate",children:P.artist_name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Artist"})]})]},P.artist_id||P.artist_name))}),s.jsx(Jr,{value:"venues",className:"mt-0 space-y-2",children:f.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(gr,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:a?"Not following any venues yet":`${n} is not following any venues yet`})]}):f.map(P=>s.jsxs("div",{className:"flex items-center gap-3 hover:bg-[rgba(201,201,201,0.2)] rounded-lg p-3 transition-colors cursor-pointer",onClick:()=>S(P),children:[s.jsxs(Vr,{className:"w-12 h-12 flex-shrink-0",children:[P.venue_image_url?s.jsx(sn,{src:P.venue_image_url,alt:P.venue_name||"Venue"}):null,s.jsx(Wr,{className:"bg-[#fdf2f7]",children:s.jsx(gr,{className:"w-6 h-6 text-[#cc2486]"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-base truncate",children:P.venue_name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:P.venue_state||"Venue"})]})]},P.venue_id||P.venue_name))})]})})]})]})})}function uge({children:e}){const[t,r]=x.useState(!1);return x.useEffect(()=>{const n=()=>{r(window.innerWidth<768)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),t?s.jsx("div",{className:"flex justify-center py-4",children:s.jsxs("div",{className:"relative w-full max-w-[420px] rounded-3xl border border-gray-200 bg-[#fcfcfc] shadow-lg overflow-hidden",children:[s.jsxs("div",{className:"h-[47px] bg-[#fcfcfc] border-b border-gray-200 flex items-end justify-center px-3 pt-1",children:[s.jsx("div",{className:"flex-1 flex items-center",children:s.jsx("span",{className:"text-[13px] font-semibold text-black ml-1",children:"9:41"})}),s.jsx("div",{className:"flex-1 flex justify-center",children:s.jsx("div",{className:"bg-black h-[28px] w-[108px] rounded-full"})}),s.jsxs("div",{className:"flex-1 flex justify-end items-center gap-1 text-black/80 text-[10px]",children:[s.jsx("div",{className:"w-4 h-[10px] bg-gradient-to-r from-black/10 to-black rounded-[3px]"}),s.jsx("div",{className:"w-4 h-[10px] bg-gradient-to-r from-black/10 to-black rounded-[3px]"}),s.jsx("div",{className:"w-6 h-[10px] border border-black rounded-[3px] flex items-center justify-end pr-[1px]",children:s.jsx("div",{className:"h-[7px] w-[9px] bg-black rounded-[2px]"})})]})]}),s.jsx("div",{className:"max-h-[calc(100vh-140px)] overflow-y-auto px-4 pb-24 pt-4",children:e}),s.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-3 flex justify-center",children:s.jsxs("div",{className:"pointer-events-auto flex items-center justify-between gap-6 rounded-2xl border border-gray-200 bg-[#f9d7e4] px-6 py-3 shadow-md w-[90%] max-w-[360px]",children:[s.jsxs("button",{type:"button",className:"flex flex-col items-center text-xs text-[#cc2486]",children:[s.jsx(vP,{className:"w-5 h-5"}),s.jsx("span",{className:"mt-1",children:"Home"})]}),s.jsxs("button",{type:"button",className:"flex flex-col items-center text-xs text-[#cc2486]",children:[s.jsx(Uo,{className:"w-5 h-5"}),s.jsx("span",{className:"mt-1",children:"Search"})]}),s.jsx("button",{type:"button",className:"flex items-center justify-center rounded-full bg-[#cc2486] text-white w-[70px] h-10 shadow-sm",children:s.jsx(Vo,{className:"w-5 h-5"})}),s.jsxs("button",{type:"button",className:"flex flex-col items-center text-xs text-[#cc2486]",children:[s.jsx($n,{className:"w-5 h-5"}),s.jsx("span",{className:"mt-1",children:"Feed"})]}),s.jsxs("button",{type:"button",className:"flex flex-col items-center text-xs text-[#cc2486]",children:[s.jsx(Rs,{className:"w-5 h-5"}),s.jsx("span",{className:"mt-1",children:"Profile"})]})]})})]})}):s.jsx("div",{className:"flex justify-center py-6",children:s.jsx("div",{className:"w-full max-w-3xl rounded-xl border border-gray-200 bg-[#fcfcfc] shadow-md max-h-[80vh] overflow-y-auto px-6 pb-6 pt-4",children:e})})}function nV({event:e,userId:t,isOpen:r,onClose:n,onReviewSubmitted:a}){if(!e)return null;const i=()=>{n()};return s.jsx(pn,{open:r,onOpenChange:i,children:s.jsx(dn,{className:"max-w-4xl w-[98vw] h-[90dvh] max-h-[90dvh] p-0 overflow-hidden flex flex-col bg-transparent border-none shadow-none",hideCloseButton:!0,children:s.jsx(uge,{children:s.jsx(oB,{event:e,userId:t,onSubmitted:o=>E(this,null,function*(){if(a){const l=a(o);l instanceof Promise&&(yield l)}n()}),onDeleted:()=>E(this,null,function*(){if(a){const o=a(null);o instanceof Promise&&(yield o)}n()}),onClose:n})})})})}class hge{constructor(){Cr(this,"developerToken","");Cr(this,"musicKit",null);Cr(this,"userToken",null);Cr(this,"storefront","us");this.init()}init(){return E(this,null,function*(){yield this.loadMusicKit()})}loadMusicKit(){return E(this,null,function*(){if(typeof window!="undefined")if(window.MusicKit)this.configureMusicKit();else return new Promise((t,r)=>{const n=document.createElement("script");n.src="https://js-cdn.music.apple.com/musickit/v1/musickit.js",n.onload=()=>{this.configureMusicKit(),t()},n.onerror=r,document.head.appendChild(n)})})}configureMusicKit(){if(!this.developerToken){console.warn("Apple Music developer token not configured");return}try{window.MusicKit.configure({developerToken:this.developerToken,app:{name:"PlusOne Event Crew",build:"1.0.0"}}),this.musicKit=window.MusicKit.getInstance()}catch(t){console.error("MusicKit configuration error:",t)}}authenticate(){return E(this,null,function*(){if(!this.musicKit)throw new Error("MusicKit not initialized");yield this.musicKit.authorize(),this.musicKit.isAuthorized&&(this.userToken=this.musicKit.musicUserToken,yield this.getUserStorefront(),setTimeout(()=>{this.autoSync().catch(console.error)},2e3))})}checkStoredToken(){var t;return((t=this.musicKit)==null?void 0:t.isAuthorized)||!1}logout(){this.musicKit&&this.musicKit.unauthorize(),this.userToken=null}appleMusicApiCall(n){return E(this,arguments,function*(t,r={}){if(!this.userToken&&!t.includes("/catalog/"))throw new Error("User token required for library access");const i=`https://api.music.apple.com/v1${t}`,o={Authorization:`Bearer ${this.developerToken}`,"Content-Type":"application/json"};this.userToken&&!t.includes("/catalog/")&&(o["Music-User-Token"]=this.userToken);const l=yield fetch(i,M({headers:o},r));if(!l.ok)throw new Error(`Apple Music API error: ${l.status} ${l.statusText}`);return l.json()})}getUserStorefront(){return E(this,null,function*(){try{const t=yield this.appleMusicApiCall("/me/storefront");return t.data&&t.data.length>0?(this.storefront=t.data[0].id,t.data[0]):null}catch(t){return console.error("Error getting user storefront:",t),null}})}getLibrarySongs(t=100){return E(this,null,function*(){return this.appleMusicApiCall(`/me/library/songs?limit=${t}`)})}getLibraryArtists(t=100){return E(this,null,function*(){return this.appleMusicApiCall(`/me/library/artists?limit=${t}`)})}getLibraryAlbums(t=100){return E(this,null,function*(){return this.appleMusicApiCall(`/me/library/albums?limit=${t}`)})}getRecentlyPlayed(t=30){return E(this,null,function*(){return this.appleMusicApiCall(`/me/recent/played/tracks?limit=${t}`)})}getReplayData(){return E(this,null,function*(){try{return this.appleMusicApiCall("/me/library/replay")}catch(t){return console.log("Replay data not available or accessible"),null}})}getHeavyRotation(){return E(this,null,function*(){try{return this.appleMusicApiCall("/me/history/heavy-rotation")}catch(t){return console.log("Heavy rotation data not available"),null}})}getRecommendations(){return E(this,null,function*(){try{return this.appleMusicApiCall("/me/recommendations")}catch(t){return console.log("Recommendations not available"),null}})}getCharts(t="songs,albums,artists",r=20){return E(this,null,function*(){return this.appleMusicApiCall(`/catalog/${this.storefront}/charts?types=${t}&limit=${r}`)})}getLibraryPlaylist(t=100){return E(this,null,function*(){try{return this.appleMusicApiCall(`/me/library/playlists?limit=${t}`)}catch(r){return console.log("Library playlists not available"),null}})}getLibraryStats(){return E(this,null,function*(){try{const[t,r,n,a]=yield Promise.allSettled([this.getLibrarySongs(1e3),this.getLibraryArtists(1e3),this.getLibraryAlbums(1e3),this.getLibraryPlaylist(1e3)]),i=t.status==="fulfilled"?t.value.data:[],o=r.status==="fulfilled"?r.value.data:[],l=n.status==="fulfilled"?n.value.data:[],c=a.status==="fulfilled"?a.value.data:[];return{totalSongs:i.length,totalArtists:o.length,totalAlbums:l.length,totalPlaylists:c.length,songs:i,artists:o,albums:l,playlists:c}}catch(t){return console.error("Error getting library stats:",t),null}})}processLibraryData(t,r){if(!t||!Array.isArray(t))return[];let n=[...t];switch(r){case"last-week":n=t.slice(0,20);break;case"last-month":n=t.slice(0,30);break;case"last-6-months":n=t.slice(0,50);break;default:n=t.slice(0,20)}return n}calculateListeningStats(t,r){const n=t.length,a=r.length,i=new Set;t.forEach(h=>{h.attributes.albumName&&i.add(h.attributes.albumName)});const o=i.size,l=t.reduce((h,p)=>h+(p.attributes.durationInMillis||0),0),c=Math.round(l/(1e3*60*60)*10)/10,d=n>0?Math.round(l/n/1e3):0,u={};[...t,...r].forEach(h=>{(h.attributes.genreNames||[]).forEach(g=>{u[g]=(u[g]||0)+1})});const f=Object.entries(u).sort(([,h],[,p])=>p-h).slice(0,5).map(([h])=>h);return{totalTracks:n,uniqueArtists:a,uniqueAlbums:o,totalHours:c,avgDuration:d,topGenres:f}}formatDuration(t){if(!t)return"";const r=Math.floor(t/6e4),n=Math.floor(t%6e4/1e3);return`${r}:${n.toString().padStart(2,"0")}`}formatDate(t){const n=(new Date().getTime()-t.getTime())/(1e3*60*60);return n<1?"Just now":n<24?`${Math.floor(n)} hours ago`:n<168?`${Math.floor(n/24)} days ago`:t.toLocaleDateString()}getArtworkUrl(t,r=300,n=300){return t!=null&&t.url?t.url.replace("{w}",r.toString()).replace("{h}",n.toString()):""}generateProfileData(){return E(this,null,function*(){try{if(!this.userToken)throw new Error("User not authenticated");const t=yield this.getLibraryStats();if(!t)throw new Error("Failed to get library stats");const[r,n]=yield Promise.allSettled([this.getRecentlyPlayed(50),this.getUserStorefront()]),a=r.status==="fulfilled"?r.value.data:[],i=n.status==="fulfilled"?n.value:null,o=this.calculateListeningStats(t.songs,t.artists),l=this.processLibraryData(t.songs,"last-month").slice(0,20),c=this.processLibraryData(t.artists,"last-month").slice(0,20),d=this.processLibraryData(t.albums,"last-month").slice(0,20);return{storefront:(i==null?void 0:i.id)||"us",libraryStats:t,topTracks:l,topArtists:c,topAlbums:d,recentlyPlayed:a,topGenres:o.topGenres,listeningTime:o.totalHours,lastUpdated:new Date().toISOString()}}catch(t){return console.error("Error generating profile data:",t),null}})}uploadProfileData(t){return E(this,null,function*(){try{const r=yield this.getCurrentUserId(),n=typeof window!="undefined"?window.location.origin:"",a=yield fetch(`${n}/api/user/streaming-profile`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"apple-music",data:t,userId:r||"anonymous"})});if(!a.ok){const o=yield a.json().catch(()=>({}));throw new Error(`Upload failed: ${a.status} ${a.statusText} - ${o.error||"Unknown error"}`)}const i=yield a.json();console.log("Profile data uploaded successfully:",i);try{const o=yield this.getCurrentUserId();if(o&&t){const l=t.topArtists||[],c=t.topGenres||[],d={user_id:o,service_type:"apple-music",top_artists:l.map(u=>{var f;return{name:u.name||((f=u.attributes)==null?void 0:f.name)||"",popularity:u.popularity||0,id:u.id}}),top_genres:c.map(u=>({genre:typeof u=="string"?u:u.genre||"",count:typeof u=="string"?1:u.count||1})),total_tracks:t.totalTracks||0,unique_artists:l.length,total_listening_hours:t.totalListeningHours||0};console.log(" Stats table removed - stats not persisted");try{const{streamingSyncService:u}=yield kn(()=>E(this,null,function*(){const{streamingSyncService:f}=yield Promise.resolve().then(()=>K_);return{streamingSyncService:f}}),void 0,import.meta.url);u.isSyncing()&&u.completeSync()}catch(u){console.warn("Could not notify sync service:",u)}}}catch(o){console.error("Error storing Apple Music stats:",o);try{const{streamingSyncService:l}=yield kn(()=>E(this,null,function*(){const{streamingSyncService:c}=yield Promise.resolve().then(()=>K_);return{streamingSyncService:c}}),void 0,import.meta.url);l.errorSync(o instanceof Error?o.message:"Unknown error")}catch(l){console.warn("Could not notify sync service of error:",l)}}return!0}catch(r){return console.error("Error uploading profile data:",r),!1}})}getCurrentUserId(){return E(this,null,function*(){try{const{supabase:t}=yield kn(()=>E(this,null,function*(){const{supabase:n}=yield Promise.resolve().then(()=>yie);return{supabase:n}}),void 0,import.meta.url),{data:{user:r}}=yield t.auth.getUser();return(r==null?void 0:r.id)||null}catch(t){return console.error("Error getting current user:",t),null}})}syncProfileData(){return E(this,null,function*(){try{const t=yield this.generateProfileData();return t?yield this.uploadProfileData(t):!1}catch(t){return console.error("Error syncing profile data:",t),!1}})}shouldSync(){const t=localStorage.getItem("apple-music-last-sync");if(!t)return!0;const r=new Date(t);return(new Date().getTime()-r.getTime())/(1e3*60*60)>=24}markSyncCompleted(){localStorage.setItem("apple-music-last-sync",new Date().toISOString())}autoSync(){return E(this,null,function*(){if(!this.shouldSync()){console.log("Apple Music profile sync not needed yet");return}console.log("Starting Apple Music profile sync..."),(yield this.syncProfileData())?(this.markSyncCompleted(),console.log("Apple Music profile sync completed successfully")):console.log("Apple Music profile sync failed")})}}const dg=new hge,sV=e=>{if(!e)return"unknown";const t=e.toLowerCase();return t.includes("spotify.com")||t.includes("open.spotify")||t.startsWith("spotify:")||/^[a-zA-Z0-9_]{1,}$/.test(e)?"spotify":t.includes("music.apple.com")||t.includes("apple.com/music")||t.includes("applemusic")||t.includes("apple music")?"apple-music":"unknown"};class fge{static getUserStats(t,r=30){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("event_type, entity_type").eq("user_id",t).gte("occurred_at",new Date(Date.now()-r*24*60*60*1e3).toISOString());if(a)throw a;const i={events_viewed:(n==null?void 0:n.filter(d=>d.event_type==="view"&&d.entity_type==="event").length)||0,events_clicked:(n==null?void 0:n.filter(d=>d.event_type==="click"&&d.entity_type==="event").length)||0,events_interested:0,events_attended:0,reviews_written:0,reviews_liked:(n==null?void 0:n.filter(d=>d.event_type==="like"&&d.entity_type==="review").length)||0,ticket_clicks:(n==null?void 0:n.filter(d=>d.event_type==="click"&&d.entity_type==="ticket_link").length)||0,searches_performed:(n==null?void 0:n.filter(d=>d.event_type==="search").length)||0,friends_count:0},[o,l,c]=yield Promise.all([T.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("user_id",t).in("relationship_type",["interested","going","maybe"]),T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY"),T.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","friend").or(`user_id.eq.${t},related_user_id.eq.${t}`)]);return i.events_interested=o.count||0,i.reviews_written=l.count||0,i.friends_count=c.count||0,i}catch(n){throw console.error("Error fetching user stats:",n),n}})}static getTopArtists(t,r=5){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("metadata").eq("user_id",t).not("metadata->artist_name","is",null).gte("occurred_at",new Date(Date.now()-7776e6).toISOString());if(a)throw a;const i=new Map;return n==null||n.forEach(l=>{var d;const c=(d=l.metadata)==null?void 0:d.artist_name;c&&i.set(c,(i.get(c)||0)+1)}),Array.from(i.entries()).map(([l,c])=>({artist_name:l,interaction_count:c,reviews_written:0})).sort((l,c)=>c.interaction_count-l.interaction_count).slice(0,r)}catch(n){return console.error("Error fetching top artists:",n),[]}})}static getTopVenues(t,r=5){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("metadata").eq("user_id",t).not("metadata->venue_name","is",null).gte("occurred_at",new Date(Date.now()-7776e6).toISOString());if(a)throw a;const i=new Map;return n==null||n.forEach(o=>{var u,f,h;const l=(u=o.metadata)==null?void 0:u.venue_name,c=(f=o.metadata)==null?void 0:f.venue_city,d=(h=o.metadata)==null?void 0:h.venue_state;if(l){const p=i.get(l)||{count:0};i.set(l,{count:p.count+1,city:c||p.city,state:d||p.state})}}),Array.from(i.entries()).map(([o,l])=>({venue_name:o,venue_city:l.city,venue_state:l.state,interaction_count:l.count})).sort((o,l)=>l.interaction_count-o.interaction_count).slice(0,r)}catch(n){return console.error("Error fetching top venues:",n),[]}})}static getReviewStats(t){return E(this,null,function*(){var r;try{const{data:n,error:a}=yield T.from("reviews").select("id, rating, likes_count, comments_count, event_id").eq("user_id",t).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").order("likes_count",{ascending:!1});if(a)throw a;const i=[...new Set((n||[]).map(d=>d.event_id).filter(Boolean))];let o={};if(i.length>0){const{data:d,error:u}=yield T.from("events").select("id, title").in("id",i);!u&&d&&(o=d.reduce((f,h)=>(f[h.id]=h,f),{}))}const l=(n||[]).map(d=>H(M({},d),{event:d.event_id&&o[d.event_id]||null}));if(!l||l.length===0)return{review_count:0,avg_rating:0,total_likes:0,total_comments:0};const c={review_count:l.length,avg_rating:l.reduce((d,u)=>d+u.rating,0)/l.length,total_likes:l.reduce((d,u)=>d+(u.likes_count||0),0),total_comments:l.reduce((d,u)=>d+(u.comments_count||0),0)};return l[0]&&l[0].likes_count>0&&(c.most_liked_review={id:l[0].id,event_name:((r=l[0].event)==null?void 0:r.title)||"Unknown Event",likes_count:l[0].likes_count}),c}catch(n){return console.error("Error fetching review stats:",n),{review_count:0,avg_rating:0,total_likes:0,total_comments:0}}})}static getGenreBreakdown(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("interactions").select("metadata").eq("user_id",t).eq("entity_type","event").not("metadata->genres","is",null);if(n)throw n;const a=new Map;let i=0;return r==null||r.forEach(o=>{var c;(((c=o.metadata)==null?void 0:c.genres)||[]).forEach(d=>{a.set(d,(a.get(d)||0)+1),i++})}),Array.from(a.entries()).map(([o,l])=>({genre:o,count:l,percentage:Math.round(l/i*100)})).sort((o,l)=>l.count-o.count).slice(0,5)}catch(r){return console.error("Error fetching genre breakdown:",r),[]}})}static getActualAttendedEventsCount(t){return E(this,null,function*(){try{const{count:r}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY"),{count:n}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_draft",!0),{count:a}=yield T.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("review_text","ATTENDANCE_ONLY"),i=(r||0)+(n||0)+(a||0);return console.log(` Attended events: ${r||0} reviews + ${n||0} drafts + ${a||0} attendance-only = ${i}`),i}catch(r){return console.error("Error getting actual attended events count:",r),0}})}static getActualUniqueVenuesCount(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("reviews").select(`
          id, 
          is_draft, 
          review_text, 
          events!inner(
            id,
            title, 
            venues(name),
            artists(name)
          )
        `).eq("user_id",t);if(n)return console.error("Error fetching reviews for venue count:",n),0;if(!r||r.length===0)return 0;const a=new Set,i=[];r.forEach(c=>{var p,g;const d=c.events,u=((p=d==null?void 0:d.venues)==null?void 0:p.name)||null,f=((g=d==null?void 0:d.artists)==null?void 0:g.name)||null,h=(d==null?void 0:d.title)||null;if(u){a.add(u);let v="completed";c.is_draft?v="draft":c.review_text==="ATTENDANCE_ONLY"&&(v="attendance-only"),i.push({venue:u,event:h||`${f} concert`,type:v})}});const o=a.size;console.log(` Unique venues: ${o} from ${(r==null?void 0:r.length)||0} total attended events`),console.log(" Venue details:",i),console.log(" Unique venue names:",Array.from(a));const l=i.filter(c=>c.venue==="Ameris Bank Amphitheatre");if(l.length>0){console.log(" PROBLEM FOUND: Incorrect venue data:",l),console.log(" This venue should be removed or corrected in the database");const c=Array.from(a).filter(d=>d!=="Ameris Bank Amphitheatre");return console.log(` Corrected unique venues (excluding problematic): ${c.length}`),console.log(" Corrected venue names:",c),c.length}return o}catch(r){return console.error("Error getting actual unique venues count:",r),0}})}static getActualInterestedEventsCount(t){return E(this,null,function*(){try{const{count:r}=yield T.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("user_id",t).in("relationship_type",["interested","going","maybe"]),n=r||0;return console.log(` Interested events: ${n}`),n}catch(r){return console.error("Error getting actual interested events count:",r),0}})}static getUserAchievements(t){return E(this,null,function*(){try{const[r,n,a,i]=yield Promise.all([this.getUserStats(t,365),this.getReviewStats(t),this.getTopVenues(t,20),this.getGenreBreakdown(t)]),o=yield this.getActualAttendedEventsCount(t);console.log(" Actual attended events count:",o);const l=yield this.getActualUniqueVenuesCount(t);console.log(" Actual unique venues count:",l);const c=yield this.getActualInterestedEventsCount(t);console.log(" Actual interested events count:",c);const d=[{id:"concert_enthusiast",name:"Concert Enthusiast",description:"Attend 10+ events",icon:"",progress:o,goal:10,unlocked:o>=10,category:"events"},{id:"trusted_reviewer",name:"Trusted Reviewer",description:"Write 5+ reviews with 20+ total likes",icon:"",progress:n.review_count>=5&&n.total_likes>=20?1:0,goal:1,unlocked:n.review_count>=5&&n.total_likes>=20,category:"reviews"},{id:"genre_explorer",name:"Genre Explorer",description:"Review events from 5+ different genres",icon:"",progress:i.length,goal:5,unlocked:i.length>=5,category:"exploration"},{id:"local_expert",name:"Local Expert",description:"Attend events at 10+ different venues",icon:"",progress:l,goal:10,unlocked:l>=10,category:"exploration"},{id:"social_butterfly",name:"Social Butterfly",description:"Connect with 20+ friends",icon:"",progress:r.friends_count,goal:20,unlocked:r.friends_count>=20,category:"social"},{id:"super_fan",name:"Super Fan",description:"Follow 15+ artists",icon:"",progress:0,goal:15,unlocked:!1,category:"social"},{id:"review_master",name:"Review Master",description:"Write 25+ reviews",icon:"",progress:n.review_count,goal:25,unlocked:n.review_count>=25,category:"reviews"},{id:"influencer",name:"Influencer",description:"Get 100+ likes on your reviews",icon:"",progress:n.total_likes,goal:100,unlocked:n.total_likes>=100,category:"reviews"},{id:"early_bird",name:"Early Bird",description:"Mark interested in 50+ events",icon:"",progress:c,goal:50,unlocked:c>=50,category:"events"},{id:"ticket_hunter",name:"Ticket Hunter",description:"Click 100+ ticket links",icon:"",progress:r.ticket_clicks,goal:100,unlocked:r.ticket_clicks>=100,category:"events"}],u=yield this.getArtistFollowsCount(t),f=d.findIndex(h=>h.id==="super_fan");return f!==-1&&(d[f].progress=u||0,d[f].unlocked=(u||0)>=15),d}catch(r){return console.error("Error calculating achievements:",r),[]}})}static getActivityTimeline(t,r=30){return E(this,null,function*(){try{return console.log("Activity timeline not available yet - analytics tables not deployed"),[]}catch(n){return console.error("Error fetching activity timeline:",n),[]}})}static exportUserData(t){return E(this,null,function*(){try{const[r,n,a,i,o]=yield Promise.all([this.getUserStats(t,365),this.getTopArtists(t,20),this.getTopVenues(t,20),this.getReviewStats(t),this.getUserAchievements(t)]);let l=`Synth User Analytics Export
`;return l+=`Generated: ${new Date().toISOString()}

`,l+=`SUMMARY STATS (Last 365 days)
`,l+=`Metric,Value
`,l+=`Events Viewed,${r.events_viewed}
`,l+=`Events Clicked,${r.events_clicked}
`,l+=`Events Interested,${r.events_interested}
`,l+=`Events Attended,${r.events_attended}
`,l+=`Reviews Written,${r.reviews_written}
`,l+=`Ticket Clicks,${r.ticket_clicks}
`,l+=`Friends,${r.friends_count}

`,l+=`TOP ARTISTS
`,l+=`Artist,Interactions
`,n.forEach(c=>l+=`${c.artist_name},${c.interaction_count}
`),l+=`
`,l+=`TOP VENUES
`,l+=`Venue,City,State,Interactions
`,a.forEach(c=>l+=`${c.venue_name},${c.venue_city||""},${c.venue_state||""},${c.interaction_count}
`),l+=`
`,l+=`REVIEW STATS
`,l+=`Total Reviews,Average Rating,Total Likes,Total Comments
`,l+=`${i.review_count},${i.avg_rating.toFixed(2)},${i.total_likes},${i.total_comments}

`,l+=`ACHIEVEMENTS
`,l+=`Achievement,Progress,Goal,Unlocked
`,o.forEach(c=>l+=`${c.name},${c.progress},${c.goal},${c.unlocked}
`),l}catch(r){throw console.error("Error exporting user data:",r),r}})}static getArtistFollowsCount(t){return E(this,null,function*(){try{console.log(` Getting artist follows count for user: ${t}`);const{count:r,error:n}=yield T.from("artist_follows").select("*",{count:"exact",head:!0}).eq("user_id",t);console.log(` Count query result: count=${r}, error=`,n);const{data:a,error:i}=yield T.from("artist_follows").select("id, artist_id, user_id, created_at").eq("user_id",t);if(console.log(` Data query result: data.length=${(a==null?void 0:a.length)||0}, error=`,i),a&&a.length>0&&console.log(" First follow record:",a[0]),n)return console.error(" Artist follows count query error:",n),console.error(" Error details:",JSON.stringify(n,null,2)),!i&&a?(console.log(` Using data length as fallback: ${a.length}`),a.length):0;const o=r!=null?r:(a==null?void 0:a.length)||0;if(console.log(` Artist follows count: ${o} (count query: ${r}, data length: ${(a==null?void 0:a.length)||0})`),o>0&&a&&a.length>0){const l=a.map(c=>c.followed_entity_id).filter(Boolean);if(l.length>0){const{data:c,error:d}=yield T.from("artists").select("id, name").in("id",l);if(!d&&c){const u=c.map(f=>f.name||"Unknown Artist");console.log(` Followed artist names (${c.length}):`,u)}else d&&console.warn(" Could not fetch artist names:",d)}}return o}catch(r){return console.error(" Error getting artist follows count:",r),0}})}static getVenueFollowsCount(t){return E(this,null,function*(){try{console.log(` Getting venue follows count for user: ${t}`);const{count:r,data:n,error:a}=yield T.from("user_venue_relationships").select("*",{count:"exact"}).eq("user_id",t);if(a)return console.error(" Venue follows query error:",a),0;const i=r||(n==null?void 0:n.length)||0;if(console.log(` Venue follows count from user_venue_relationships table: ${i} (from count: ${r}, from data.length: ${n==null?void 0:n.length})`),i>0&&n&&n.length>0){const o=n.map(l=>l.venue_id).filter(Boolean);if(o.length>0){const l=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,c=o.filter(h=>l.test(String(h)));let d=[],u=null;if(c.length>0){const h=yield T.from("venues").select("name").in("id",c);d=h.data||[],u=h.error}const f=o.filter(h=>!l.test(String(h)));if(f.length>0&&!u){const{data:h,error:p}=yield T.from("venues").select("name").in("name",f);!p&&h&&(d=[...d,...h])}if(!u&&d&&d.length>0){const h=d.map(p=>p.name||"Unknown Venue");console.log(" Followed venue names:",h)}else{const h=o.map(p=>p);console.log(" Followed venue IDs/names (could not find in venues table):",h)}}}else console.log(` No venue follows found for user ${t}`);return i}catch(r){return console.error("Error getting venue follows count:",r),0}})}static hasPremium(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_subscriptions").select("subscription_tier, subscription_expires_at, status").eq("user_id",t).single();return n?(console.error("Error checking premium status:",n),!1):r?r.subscription_tier&&r.subscription_tier!=="free"&&r.status==="active"&&(!r.subscription_expires_at||new Date(r.subscription_expires_at)>new Date):!1}catch(r){return console.error("Error checking premium status:",r),!1}})}static trackSubscriptionChange(t,r,n,a){return E(this,null,function*(){try{const{trackInteraction:i}=yield kn(()=>E(this,null,function*(){const{trackInteraction:o}=yield Promise.resolve().then(()=>_ie);return{trackInteraction:o}}),void 0,import.meta.url);yield i.profileUpdate("subscription_tier",t,{oldTier:r,newTier:n,changeType:a,revenueImpact:this.calculateRevenueImpact(r,n),timestamp:new Date().toISOString()})}catch(i){console.error("Error tracking subscription change:",i)}})}static calculateRevenueImpact(t,r){const n={free:0,premium:4.99,professional:9.99,enterprise:19.99},a=n[t]||0;return(n[r]||0)-a}static getSubscriptionAnalytics(t){return E(this,null,function*(){try{const{data:r}=yield T.from("user_subscriptions").select("subscription_tier, subscription_started_at, subscription_expires_at").eq("user_id",t).single(),{data:n}=yield T.from("interactions").select("*").eq("user_id",t).eq("event_type","profile_update").eq("entity_type","profile").contains("metadata",{field:"subscription_tier"}).order("occurred_at",{ascending:!0}),a=(n==null?void 0:n.map(o=>{const l=o.metadata;return{date:o.occurred_at,tier:(l==null?void 0:l.newTier)||"unknown",changeType:(l==null?void 0:l.changeType)||"unknown",revenueImpact:(l==null?void 0:l.revenueImpact)||0}}))||[],i=a.reduce((o,l)=>o+l.revenueImpact,0);return{currentTier:(r==null?void 0:r.subscription_tier)||"free",subscriptionStartDate:(r==null?void 0:r.subscription_started_at)||null,subscriptionExpiryDate:(r==null?void 0:r.subscription_expires_at)||null,totalRevenue:i,subscriptionHistory:a}}catch(r){return console.error("Error getting subscription analytics:",r),{currentTier:"free",totalRevenue:0,subscriptionHistory:[]}}})}}function mge({open:e,onClose:t,user:r,isBlocked:n=!1,onBlockToggled:a}){const{toast:i}=Rr(),[o,l]=x.useState(!1),[c,d]=x.useState(""),u=()=>E(this,null,function*(){l(!0);try{n?(yield Ku.unblockUser(r.id),i({title:"User Unblocked",description:`You can now see content from ${r.name}`})):(yield Ku.blockUser({blocked_user_id:r.id,block_reason:c.trim()||void 0}),i({title:"User Blocked",description:`You won't see content from ${r.name} anymore`})),a==null||a(),f()}catch(h){console.error("Error toggling block:",h),i({title:"Error",description:h instanceof Error?h.message:"Failed to update block status",variant:"destructive"})}finally{l(!1)}}),f=()=>{o||(d(""),t())};return s.jsx(pn,{open:e,onOpenChange:f,children:s.jsxs(dn,{className:"sm:max-w-[500px]",children:[s.jsxs(Vn,{children:[s.jsx(bn,{className:"flex items-center gap-2",children:n?s.jsxs(s.Fragment,{children:[s.jsx(Bk,{className:"h-5 w-5 text-gray-600"}),"Unblock User"]}):s.jsxs(s.Fragment,{children:[s.jsx(F_,{className:"h-5 w-5 text-red-600"}),"Block User"]})}),s.jsx(os,{children:n?"You will start seeing content from this user again":"You won't see content from this user anymore"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 flex items-center gap-3",children:[r.avatar_url?s.jsx("img",{src:r.avatar_url,alt:r.name,className:"w-12 h-12 rounded-full object-cover"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center",children:s.jsx("span",{className:"text-purple-600 font-semibold text-lg",children:r.name.charAt(0).toUpperCase()})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:r.name}),s.jsx("p",{className:"text-sm text-gray-600",children:n?"Currently blocked":"Will be blocked"})]})]}),!n&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"reason",children:"Reason for blocking (Optional, for your reference)"}),s.jsx(ys,{id:"reason",placeholder:"Why are you blocking this user?",value:c,onChange:h=>d(h.target.value),disabled:o,rows:3})]}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex gap-3",children:[s.jsx(Sv,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-yellow-900",children:[s.jsx("p",{className:"font-medium mb-1",children:"When you block someone:"}),s.jsxs("ul",{className:"text-xs space-y-1 list-disc list-inside",children:[s.jsx("li",{children:"You won't see their events, reviews, or comments"}),s.jsx("li",{children:"They won't be able to see your content"}),s.jsx("li",{children:"They won't be notified that you blocked them"}),s.jsx("li",{children:"You can unblock them at any time"})]})]})]})]}),n&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex gap-3",children:[s.jsx(Sv,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-900",children:[s.jsx("p",{className:"font-medium mb-1",children:"When you unblock someone:"}),s.jsxs("ul",{className:"text-xs space-y-1 list-disc list-inside",children:[s.jsx("li",{children:"You'll start seeing their content again"}),s.jsx("li",{children:"They'll be able to see your content"}),s.jsx("li",{children:"You can interact with each other normally"})]})]})]}),s.jsxs(Nh,{children:[s.jsx(le,{type:"button",variant:"outline",onClick:f,disabled:o,children:"Cancel"}),s.jsx(le,{onClick:u,variant:n?"default":"destructive",disabled:o,children:o?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-4 h-4 mr-2 animate-spin"}),n?"Unblocking...":"Blocking..."]}):s.jsx(s.Fragment,{children:n?s.jsxs(s.Fragment,{children:[s.jsx(Bk,{className:"w-4 h-4 mr-2"}),"Unblock User"]}):s.jsxs(s.Fragment,{children:[s.jsx(F_,{className:"w-4 h-4 mr-2"}),"Block User"]})})})]})]})})}function pge({draftCount:e,onClick:t}){return e<=0?null:s.jsxs("button",{type:"button",onClick:t,className:"relative w-full overflow-hidden rounded-2xl shadow-md bg-gradient-to-br from-[#0e0e0e] via-[#1a1a1a] to-[#3b0b22] text-left focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 focus:ring-offset-background",children:[s.jsx("div",{className:"absolute inset-0 opacity-40 bg-[radial-gradient(circle_at_top,_rgba(255,51,153,0.85),_transparent_55%),_radial-gradient(circle_at_bottom,_rgba(186,104,200,0.8),_transparent_55%)]"}),s.jsxs("div",{className:"relative px-4 py-6 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium tracking-[0.18em] uppercase text-pink-200/90",children:"Drafts"}),s.jsxs("p",{className:"mt-1 text-2xl font-semibold text-white drop-shadow",children:[e," in progress"]}),s.jsx("p",{className:"mt-1 text-xs text-pink-100/90",children:"Tap to jump into your unreviewed shows and drafts."})]}),s.jsxs("div",{className:"ml-4 flex flex-col items-end gap-1 text-[11px] text-pink-100/80",children:[s.jsx("span",{className:"px-2 py-1 rounded-full bg-pink-500/30 border border-pink-300/40",children:"Keep the streak"}),s.jsx("span",{className:"px-2 py-1 rounded-full bg-white/10 border border-white/20",children:"Autosave on"})]})]})]})}const gge="https://www.jambase.com/wp-content/uploads/2021/08/jambase-default-band-image-bw-1480x832.png",aV=AB;function Pl(e){return e?e.includes("jambase-default-band-image-bw-1480x832.png")||e===gge||e.includes("jambase.com/wp-content/uploads/2021/08/jambase-default-band-image-bw-1480x832.png")?aV:e:null}const T2=["/Generic Images/1.jpeg","/Generic Images/2.jpeg","/Generic Images/3.jpeg","/Generic Images/4.jpeg","/Generic Images/5.jpeg","/Generic Images/6.jpg","/Generic Images/7.jpg","/Generic Images/8.jpg","/Generic Images/9.webp","/Generic Images/10.jpeg","/Generic Images/11.jpeg","/Generic Images/12.jpeg","/Generic Images/13.jpeg","/Generic Images/14.jpeg","/Generic Images/15.jpeg","/Generic Images/16.jpg","/Generic Images/17.jpeg","/Generic Images/18.jpeg","/Generic Images/19.jpeg","/Generic Images/20.jpeg"],tS=T2.length;function vge(e){let t=0;for(let r=0;r<e.length;r+=1)t=(t<<5)-t+e.charCodeAt(r),t|=0;return Math.abs(t)}function GT(e){if(tS===0)return aV;if(!e){const r=Math.floor(Math.random()*tS);return encodeURI(T2[r])}const t=vge(e)%tS;return encodeURI(T2[t])}function U5({review:e,ratingValue:t,stars:r,onSelectReview:n,renderStars:a}){const i=e.event||{},o=e.jambase_events||{},l=i.artist_name||o.artist_name||i.artist_name_normalized||"Unknown Artist",c=i.venue_name||o.venue_name||i.venue_name_normalized||"Unknown Venue";let d;const u=e.Event_date||e.event_date;u&&(u instanceof Date?d=u.toISOString().split("T")[0]:typeof u=="string"&&(d=u)),d||(d=i.event_date||e.created_at);const f=(i==null?void 0:i.artist_id)||e.artist_id||(o==null?void 0:o.artist_id)||null,h=Array.isArray(e.photos)&&e.photos.length>0,p=h?e.photos[0]:void 0,[g,v]=x.useState(null);x.useEffect(()=>{!p&&f&&T.from("artists").select("image_url").eq("id",f).maybeSingle().then(({data:w,error:b})=>{!b&&(w!=null&&w.image_url)&&v(w.image_url)})},[p,f]);const y=`${e.id}-${l}-${c}-${d||""}`,_=p||g||GT(y);return s.jsxs("button",{type:"button",onClick:()=>n==null?void 0:n(e),className:"w-40 shrink-0 text-left overflow-hidden flex flex-col h-auto min-h-0",style:{backgroundColor:"var(--neutral-50)",border:"1px solid var(--neutral-200)",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)",transition:"all 0.2s ease"},onMouseEnter:w=>{w.currentTarget.style.boxShadow="0 4px 8px 0 var(--shadow-color)"},onMouseLeave:w=>{w.currentTarget.style.boxShadow="0 2px 4px 0 var(--shadow-color)"},children:[s.jsxs("div",{className:"relative h-20 w-full overflow-hidden shrink-0",children:[s.jsx("img",{src:_,alt:`${l} at ${c}`,className:`w-full h-full object-cover transition-transform duration-500 ${h?"":"scale-105"}`,loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 via-black/10 to-transparent","aria-hidden":"true"})]}),s.jsxs("div",{className:"px-3 py-2 space-y-1 flex flex-col flex-grow min-h-0",children:[s.jsx("div",{className:"h-8 min-h-[2rem] flex items-center",children:s.jsx("p",{className:"text-sm font-bold text-gray-900 break-words leading-tight line-clamp-2",children:l})}),s.jsx("p",{className:"text-xs text-gray-600 break-words leading-tight",children:c}),s.jsx("p",{className:"text-[11px] text-gray-400 leading-tight shrink-0",children:d?(()=>{const[w,b,N]=d.split("-").map(Number);return w&&b&&N?new Date(w,b-1,N).toLocaleDateString():d})():""}),t>0?s.jsxs("div",{className:"flex items-center justify-between mt-1 shrink-0",children:[a(t),s.jsxs("span",{className:"text-xs font-semibold text-gray-800",children:[Math.round(t*10)/10,""]})]}):s.jsx("div",{className:"mt-1 shrink-0",children:s.jsx("span",{className:"text-xs text-gray-500",children:"No rating"})})]})]},e.id)}function yge({reviews:e,onSelectReview:t}){const r=x.useMemo(()=>{const o={1:[],2:[],3:[],4:[],5:[]},l=[];for(const u of e||[]){if(u.review_text==="ATTENDANCE_ONLY"&&!u.was_there)continue;const f=typeof u.category_average=="number"?u.category_average:u.category_average===null||u.category_average===void 0?null:typeof u.rating=="number"?u.rating:u.rating===null||u.rating===void 0?null:0;if(f==null){l.push(u);continue}if(!f||f<=0)continue;const h=Math.floor(f);h>=1&&h<=5&&o[h].push(u)}[5,4,3,2,1].forEach(u=>{const f=o[u]||[];o[u]=f.slice().sort((h,p)=>{var b,N;const g=S=>typeof(S==null?void 0:S.category_average)=="number"?S.category_average:typeof(S==null?void 0:S.rating)=="number"?S.rating:u,v=g(h),y=g(p);if(y!==v)return y-v;const _=(h==null?void 0:h.Event_date)||(h==null?void 0:h.event_date)||((b=h==null?void 0:h.event)==null?void 0:b.event_date)||(h==null?void 0:h.created_at),w=(p==null?void 0:p.Event_date)||(p==null?void 0:p.event_date)||((N=p==null?void 0:p.event)==null?void 0:N.event_date)||(p==null?void 0:p.created_at);return new Date(w).getTime()-new Date(_).getTime()})});const d=l.slice().sort((u,f)=>{var g,v;const h=(u==null?void 0:u.Event_date)||(u==null?void 0:u.event_date)||((g=u==null?void 0:u.event)==null?void 0:g.event_date)||(u==null?void 0:u.created_at),p=(f==null?void 0:f.Event_date)||(f==null?void 0:f.event_date)||((v=f==null?void 0:f.event)==null?void 0:v.event_date)||(f==null?void 0:f.created_at);return new Date(p).getTime()-new Date(h).getTime()});return{buckets:o,unrated:d}},[e]),n=o=>{const l=Math.floor(o*2)/2;return s.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5},(c,d)=>{const u=d+1,f=l>=u,h=!f&&l>=u-.5;return s.jsxs("div",{className:"relative w-3 h-3",children:[s.jsx(Qt,{className:`w-3 h-3 ${f?"text-yellow-400 fill-yellow-400":"text-gray-300"}`}),h&&s.jsx("div",{className:"absolute inset-0 overflow-hidden",style:{width:"50%"},children:s.jsx(Qt,{className:"w-3 h-3 text-yellow-400 fill-yellow-400"})})]},d)})})},a=[{stars:5,label:"5 Star Reviews"},{stars:4,label:"4 Star Reviews"},{stars:3,label:"3 Star Reviews"},{stars:2,label:"2 Star Reviews"},{stars:1,label:"1 Star Reviews"}];return a.some(({stars:o})=>r.buckets[o].length>0)||r.unrated.length>0?s.jsxs("div",{className:"space-y-6 mb-8",children:[a.map(({stars:o,label:l})=>{const c=r.buckets[o];return!c||c.length===0?null:s.jsxs("section",{className:"space-y-2",children:[s.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:[l," ",s.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",c.length,")"]})]}),s.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:c.map(d=>{const u=typeof d.category_average=="number"?d.category_average:typeof d.rating=="number"?d.rating:o;return s.jsx(U5,{review:d,ratingValue:u,stars:o,onSelectReview:t,renderStars:n},d.id)})})]},o)}),r.unrated.length>0&&s.jsxs("section",{className:"space-y-2",children:[s.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:["Unrated Reviews ",s.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",r.unrated.length,")"]})]}),s.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:r.unrated.map(o=>s.jsx(U5,{review:o,ratingValue:0,stars:0,onSelectReview:t,renderStars:n},o.id))})]})]}):null}class Io{static getPassportProgress(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("passport_entries").select("*").eq("user_id",t).order("unlocked_at",{ascending:!1});if(n)throw n;const a=r||[];return{cities:a.filter(i=>i.type==="city"),venues:a.filter(i=>i.type==="venue"),artists:a.filter(i=>i.type==="artist"),scenes:a.filter(i=>i.type==="scene"),totalCount:a.length}}catch(r){return console.error("Error fetching passport progress:",r),{cities:[],venues:[],artists:[],scenes:[],totalCount:0}}})}static unlockPassportEntry(t,r,n,a,i,o){return E(this,null,function*(){try{const{data:l,error:c}=yield T.from("passport_entries").insert({user_id:t,type:r,entity_id:n,entity_uuid:i||null,entity_name:a,metadata:o||{}}).select().single();if(c){if(c.code==="23505"){let d=T.from("passport_entries").select("*").eq("user_id",t).eq("type",r);if(i)d=d.eq("entity_uuid",i);else if(n)d=d.eq("entity_id",n);else return console.warn("PassportService: Cannot fetch duplicate entry - both entityUuid and entityId are null"),null;const{data:u,error:f}=yield d.single();return f?(console.warn("PassportService: Error fetching duplicate entry:",f),null):u}throw c}return l}catch(l){return console.error("Error unlocking passport entry:",l),null}})}static getCitiesVisited(t){return E(this,null,function*(){try{const{count:r}=yield T.from("passport_entries").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("type","city");return r||0}catch(r){return console.error("Error counting cities:",r),0}})}static getIconicVenuesUnlocked(t){return E(this,null,function*(){try{const{count:r}=yield T.from("passport_entries").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("type","venue");return r||0}catch(r){return console.error("Error counting venues:",r),0}})}static getArtistMilestones(t){return E(this,null,function*(){try{const{count:r}=yield T.from("passport_entries").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("type","artist");return r||0}catch(r){return console.error("Error counting artists:",r),0}})}static getSceneParticipation(t){return E(this,null,function*(){try{const{count:r}=yield T.from("passport_entries").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("type","scene");return r||0}catch(r){return console.error("Error counting scenes:",r),0}})}static getNextToUnlock(t){return E(this,null,function*(){var r;try{const n=[],a=yield this.getPassportProgress(t),{data:i}=yield T.from("users").select("location_city, location_state").eq("user_id",t).single();if(i!=null&&i.location_city){const l=new Set(a.cities.map(d=>{var u;return(u=d.entity_id)==null?void 0:u.toLowerCase()})),c=`${i.location_city.toLowerCase()}_${(i.location_state||"").toLowerCase()}`;l.has(c)||n.push({type:"city",entity_name:i.location_city,hint:`Review an event in ${i.location_city} to unlock this city`,progress:a.cities.length,goal:a.cities.length+1})}const{data:o}=yield T.from("events").select("artist_id, artists!inner(name)").gte("event_date",new Date().toISOString()).not("artist_id","is",null).limit(10);if(o&&o.length>0){const l=new Set(a.artists.map(d=>d.entity_id)),c=o.find(d=>{var f;const u=d.artist_id||((f=d.artists)==null?void 0:f.id);return u&&!l.has(u)});if(c){const d=((r=c.artists)==null?void 0:r.name)||"Unknown Artist";n.push({type:"artist",entity_name:d,hint:`Attend a show by ${d} to unlock this artist`,progress:a.artists.length,goal:a.artists.length+1})}}return n.slice(0,3)}catch(n){return console.error("Error getting next to unlock:",n),[]}})}static getPassportIdentity(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("passport_identity").select("*, home_scene:scenes(*)").eq("user_id",t).single();if(n&&n.code!=="PGRST116")throw n;return r}catch(r){return console.error("Error fetching passport identity:",r),null}})}static getStampsByRarity(t,r){return E(this,null,function*(){try{let n=T.from("passport_entries").select("*").eq("user_id",t).order("unlocked_at",{ascending:!1});r&&(n=n.eq("rarity",r));const{data:a,error:i}=yield n;if(i)throw i;return a||[]}catch(n){return console.error("Error fetching stamps by rarity:",n),[]}})}static getTimeline(t,r=20){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("passport_timeline").select("*, review:reviews(*)").eq("user_id",t).order("created_at",{ascending:!1}).limit(r);if(a)throw a;return n||[]}catch(n){return console.error("Error fetching timeline:",n),[]}})}static pinTimelineEvent(t,r){return E(this,null,function*(){try{const{count:n}=yield T.from("passport_timeline").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_pinned",!0);if(n&&n>=5)throw new Error("Maximum of 5 pinned timeline items allowed");const{data:a,error:i}=yield T.from("passport_timeline").upsert({user_id:t,review_id:r,is_pinned:!0,updated_at:new Date().toISOString()},{onConflict:"user_id,review_id"}).select().single();if(i)throw i;return a}catch(n){throw console.error("Error pinning timeline event:",n),n}})}static unpinTimelineEvent(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("passport_timeline").update({is_pinned:!1}).eq("id",r).eq("user_id",t);if(n)throw n}catch(n){throw console.error("Error unpinning timeline event:",n),n}})}static addTimelineMilestone(t,r,n,a){return E(this,null,function*(){var i,o,l,c;try{const{data:d,error:u}=yield T.from("reviews").select(`
          id,
          event_id,
          artist_id,
          venue_id,
          events:event_id (
            artist_id,
            venue_id
          )
        `).eq("id",r).eq("user_id",t).single();if(u||!d)throw new Error("Review not found");const f=((i=d.events)==null?void 0:i.artist_id)||d.artist_id,h=((o=d.events)==null?void 0:o.venue_id)||d.venue_id;let p=null;if(f||h){const[y,_]=yield Promise.all([f?T.from("artists").select("name").eq("id",f).single():Promise.resolve({data:null}),h?T.from("venues").select("name").eq("id",h).single():Promise.resolve({data:null})]),w=(l=y.data)==null?void 0:l.name,b=(c=_.data)==null?void 0:c.name;w&&b?p=`${w} @ ${b}`:w?p=w:b&&(p=b)}const{data:g,error:v}=yield T.from("passport_timeline").upsert({user_id:t,review_id:r,significance:n,description:a||null,Event_name:p,is_auto_selected:!1,updated_at:new Date().toISOString()},{onConflict:"user_id,review_id"}).select().single();if(v)throw v;return g}catch(d){throw console.error("Error adding timeline milestone:",d),d}})}static updateTimelineMilestone(t,r,n,a){return E(this,null,function*(){try{const{data:i,error:o}=yield T.from("passport_timeline").update({significance:n,description:a!==void 0?a:null,updated_at:new Date().toISOString()}).eq("id",r).eq("user_id",t).select().single();if(o)throw o;return i}catch(i){throw console.error("Error updating timeline milestone:",i),i}})}static deleteTimelineEntry(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("passport_timeline").delete().eq("id",r).eq("user_id",t);if(n)throw n}catch(n){throw console.error("Error deleting timeline entry:",n),n}})}static getUserReviewsForTimeline(t,r=100){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("reviews").select(`
          id,
          rating,
          review_text,
          created_at,
          event_id,
          artist_id,
          venue_id,
          "Event_date"
        `).eq("user_id",t).eq("is_draft",!1).order("created_at",{ascending:!1}).limit(r);if(a)throw a;return n?yield Promise.all(n.map(o=>E(this,null,function*(){let l=null,c=null,d=null,u=null;if(o.event_id){const{data:h}=yield T.from("events").select("artist_uuid, venue_uuid").eq("id",o.event_id).single();d=(h==null?void 0:h.artist_uuid)||o.artist_id,u=(h==null?void 0:h.venue_uuid)||o.venue_id}else d=o.artist_id,u=o.venue_id;if(d){const{data:h}=yield T.from("artists").select("name").eq("id",d).single();l=(h==null?void 0:h.name)||null}if(u){const{data:h}=yield T.from("venues").select("name").eq("id",u).single();c=(h==null?void 0:h.name)||null}const f=l&&c?`${l} @ ${c}`:l||c||"Event";return H(M({},o),{event:{id:o.event_id||null,title:f,artist_name:l,venue_name:c,event_date:o.Event_date||o.created_at}})}))):[]}catch(n){return console.error("Error fetching user reviews for timeline:",n),[]}})}static getTasteMap(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("passport_taste_map").select("*").eq("user_id",t).maybeSingle();if(n&&n.code!=="PGRST116")throw n;return r}catch(r){return console.error("Error fetching taste map:",r),null}})}static calculateAndUpdateIdentity(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("recalculate_passport_data",{p_user_id:t});if(r)throw r;return!0}catch(r){return console.error("Error recalculating passport identity:",r),!1}})}}class j0{static getFanType(t){return E(this,null,function*(){try{const r=yield this.getIdentity(t);if(r!=null&&r.fan_type)return r.fan_type;yield this.calculateIdentity(t);const n=yield this.getIdentity(t);return(n==null?void 0:n.fan_type)||null}catch(r){return console.error("Error getting fan type:",r),null}})}static getHomeScene(t){return E(this,null,function*(){try{const r=yield this.getIdentity(t);return(r==null?void 0:r.home_scene)||null}catch(r){return console.error("Error getting home scene:",r),null}})}static getJoinYear(t){return E(this,null,function*(){try{const r=yield this.getIdentity(t);return(r==null?void 0:r.join_year)||null}catch(r){return console.error("Error getting join year:",r),null}})}static getIdentity(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("passport_identity").select("*").eq("user_id",t).single();if(n&&n.code!=="PGRST116")throw n;if(!r)return null;const{data:a,error:i}=yield T.from("users").select("location_city").eq("user_id",t).single();return i&&console.error("Error fetching user location_city:",i),H(M({},r),{home_scene:null,home_city:(a==null?void 0:a.location_city)||null})}catch(r){return console.error("Error fetching passport identity:",r),null}})}static calculateIdentity(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("update_passport_identity",{p_user_id:t});if(r)throw r;return!0}catch(r){return console.error("Error calculating identity:",r),!1}})}static calculateHomeScene(t){return E(this,null,function*(){return!0})}static getFanTypeDisplay(t){return{jam_chaser:{name:"Jam Chaser",description:"High artist loyalty, following favorite acts across multiple shows"},venue_purist:{name:"Venue Purist",description:"Prefers returning to favorite venues, values consistency and atmosphere"},scene_builder:{name:"Scene Builder",description:"Active participant across multiple music scenes, connects communities"},road_tripper:{name:"Road Tripper",description:"Explores diverse cities and regions, music is a journey"},genre_explorer:{name:"Genre Explorer",description:"Diverse musical tastes, always discovering new sounds"},festival_fanatic:{name:"Festival Fanatic",description:"Loves the festival experience, thrives on variety and community"}}[t||""]||{name:"Music Fan",description:"Building your live music journey"}}}function hw(r){var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("animate-pulse rounded-md bg-muted",e)},t))}const xge=()=>ya.divIcon({className:"travel-tracker-marker",html:`<div style="
      background-color: #FF3399;
      color: white;
      border: 3px solid white;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    "></div>`,iconSize:[32,32],iconAnchor:[16,32]}),_ge=({reviews:e})=>{const t=kh();return x.useEffect(()=>{if(e.length!==0)try{const r=ya.latLngBounds(e.map(n=>[n.latitude,n.longitude]));r.isValid()&&t.fitBounds(r,{padding:[50,50]})}catch(r){console.error("Error fitting map bounds:",r)}},[t,e]),null},wge=({userId:e})=>{var u,f,h,p;const[t,r]=x.useState([]),[n,a]=x.useState(!0),[i,o]=x.useState(null),[l,c]=x.useState([39.8283,-98.5795]);x.useEffect(()=>{d()},[e]);const d=()=>E(void 0,null,function*(){a(!0);try{const{data:g,error:v}=yield T.from("reviews").select(`
          id,
          event_id,
          venue_id,
          rating,
          review_text,
          created_at,
          Event_date,
          photos,
          mood_tags,
          genre_tags,
          venues:venue_id (
            id,
            name,
            latitude,
            longitude,
            state,
            street_address
          )
        `).eq("user_id",e).eq("is_draft",!1).not("venue_id","is",null).order("Event_date",{ascending:!1});if(v)throw v;const y=(g||[]).map(_=>{const w=Array.isArray(_.venues)?_.venues[0]:_.venues;if(!w)return null;const b=w.latitude?Number(w.latitude):null,N=w.longitude?Number(w.longitude):null;return b&&N&&!isNaN(b)&&!isNaN(N)&&b>=-90&&b<=90&&N>=-180&&N<=180?{id:_.id,event_id:_.event_id,venue_id:_.venue_id,rating:_.rating,review_text:_.review_text,created_at:_.created_at,Event_date:_.Event_date||_.created_at,venue_name:w.name||null,artist_name:null,event_title:null,latitude:b,longitude:N,venue_city:null,venue_state:w.state||null,photos:_.photos||null,mood_tags:_.mood_tags||null,genre_tags:_.genre_tags||null}:null}).filter(_=>_!==null);if(r(y),y.length>0){const _=y.reduce((b,N)=>b+N.latitude,0)/y.length,w=y.reduce((b,N)=>b+N.longitude,0)/y.length;c([_,w])}}catch(g){console.error("Error loading travel data:",g)}finally{a(!1)}});return n?s.jsxs("div",{style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:"var(--spacing-small, 12px)",paddingBottom:"var(--spacing-small, 12px)"},children:[s.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:"var(--spacing-small, 12px)"},children:[s.jsx(gr,{size:24,style:{color:"var(--brand-pink-500)"}}),s.jsx("h2",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)",margin:0},children:"Travel Tracker"})]}),s.jsx(hw,{className:"h-96 w-full",style:{borderRadius:"var(--radius-corner, 10px)"}})]}):t.length===0?s.jsxs("div",{style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:"var(--spacing-small, 12px)",paddingBottom:"var(--spacing-small, 12px)"},children:[s.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:"var(--spacing-small, 12px)"},children:[s.jsx(gr,{size:24,style:{color:"var(--brand-pink-500)"}}),s.jsx("h2",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)",margin:0},children:"Travel Tracker"})]}),s.jsxs("div",{className:"flex flex-col items-center justify-center",style:{gap:"var(--spacing-inline, 6px)",paddingTop:"var(--spacing-big-section, 60px)",paddingBottom:"var(--spacing-big-section, 60px)"},children:[s.jsx(gr,{size:60,style:{color:"var(--neutral-600)"}}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No shows tracked yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Start reviewing shows to see your travel map!"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:"var(--spacing-small, 12px)",paddingBottom:"var(--spacing-small, 12px)"},children:[s.jsxs("div",{className:"flex items-center justify-between",style:{marginBottom:"var(--spacing-small, 12px)"},children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(gr,{size:24,style:{color:"var(--brand-pink-500)"}}),s.jsx("h2",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)",margin:0},children:"Travel Tracker"})]}),s.jsxs(Ke,{variant:"secondary",style:{backgroundColor:"var(--neutral-100)",color:"var(--neutral-900)",border:"1px solid var(--neutral-200)"},children:[t.length," ",t.length===1?"show":"shows"]})]}),s.jsx("div",{children:s.jsx("div",{className:"h-96 rounded-lg overflow-hidden border relative z-0",children:s.jsxs(Xy,{center:l,zoom:4,style:{height:"100%",width:"100%",zIndex:0},children:[s.jsx(Jy,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(_ge,{reviews:t}),t.map(g=>s.jsx(ch,{position:[g.latitude,g.longitude],icon:xge(),eventHandlers:{click:()=>{o(g)}},children:s.jsx(BB,{maxWidth:300,children:s.jsxs("div",{className:"p-2",children:[s.jsx("div",{className:"font-semibold text-sm mb-1",children:g.venue_name||"Show"}),g.venue_state&&s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:g.venue_state}),s.jsx("div",{className:"text-xs text-gray-500 mb-2",children:Mt(new Date(g.Event_date),"MMM d, yyyy")}),g.rating&&s.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[s.jsx(Qt,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"}),s.jsx("span",{children:g.rating.toFixed(1)})]}),s.jsx("button",{onClick:()=>o(g),className:"mt-2 text-xs text-synth-pink hover:underline",children:"View Review "})]})})},g.id))]})})})]}),s.jsx(pn,{open:!!i,onOpenChange:()=>o(null),children:s.jsx(dn,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:i&&s.jsxs(s.Fragment,{children:[s.jsx(Vn,{children:s.jsxs(bn,{className:"flex items-center gap-2",children:[s.jsx($t,{className:"w-5 h-5 text-synth-pink"}),i.venue_name||"Show Review"]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[i.venue_name&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(gr,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{className:"font-medium",children:i.venue_name}),i.venue_state&&s.jsx("span",{className:"text-muted-foreground",children:i.venue_state})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(It,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{children:Mt(new Date(i.Event_date),"MMMM d, yyyy")})]}),i.rating&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Qt,{className:"w-5 h-5 fill-yellow-400 text-yellow-400"}),s.jsx("span",{className:"text-lg font-semibold",children:i.rating.toFixed(1)})]})]}),i.review_text&&s.jsx("div",{className:"pt-2 border-t",children:s.jsx("p",{className:"text-sm whitespace-pre-wrap",children:i.review_text})}),(((u=i.mood_tags)==null?void 0:u.length)||((f=i.genre_tags)==null?void 0:f.length))&&s.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t",children:[(h=i.mood_tags)==null?void 0:h.map((g,v)=>s.jsx(Ke,{variant:"secondary",className:"text-xs",children:g},`mood-${v}`)),(p=i.genre_tags)==null?void 0:p.map((g,v)=>s.jsx(Ke,{variant:"outline",className:"text-xs",children:g},`genre-${v}`))]}),i.photos&&i.photos.length>0&&s.jsx("div",{className:"pt-2 border-t",children:s.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.photos.slice(0,4).map((g,v)=>s.jsx("img",{src:g,alt:`Review photo ${v+1}`,className:"w-full h-32 object-cover rounded-lg"},v))})})]})]})})})]})},iV=({userId:e,userName:t})=>{const[r,n]=x.useState(null),[a,i]=x.useState(!0);x.useEffect(()=>{o()},[e]);const o=()=>E(void 0,null,function*(){i(!0);try{let c=yield j0.getIdentity(e);c||(yield j0.calculateIdentity(e),c=yield j0.getIdentity(e)),n(c)}catch(c){console.error("Error loading passport identity:",c)}finally{i(!1)}});if(a)return s.jsxs("div",{className:"space-y-4",children:[s.jsx(hw,{className:"h-32 w-full"}),s.jsx(hw,{className:"h-24 w-full"})]});if(!r)return s.jsx(He,{children:s.jsx(et,{className:"p-6 text-center text-muted-foreground",children:s.jsx("p",{children:"Identity calculation in progress..."})})});const l=j0.getFanTypeDisplay(r.fan_type);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs(He,{className:"border-2 border-synth-pink/20 bg-gradient-to-br from-white to-pink-50/30",children:[s.jsx(Er,{children:s.jsxs(qr,{className:"text-2xl font-bold flex items-center gap-2",children:[s.jsx($t,{className:"w-6 h-6 text-synth-pink"}),t?`${t}'s`:"Your"," Passport"]})}),s.jsxs(et,{children:[s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-small, 12px)"},children:[s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",width:"fit-content"},children:l.name}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0},children:l.description})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-small, 12px)",marginTop:"var(--spacing-small, 12px)"},children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(It,{className:"w-4 h-4 text-muted-foreground"}),s.jsxs("span",{className:"font-medium",children:["Live since ",r.join_year]})]}),r.home_city&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(gr,{className:"w-4 h-4 text-muted-foreground"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"font-medium",children:"Home Scene: "}),s.jsx("span",{className:"text-muted-foreground",children:r.home_city})]})]}),!r.home_city&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(gr,{className:"w-4 h-4"}),s.jsx("span",{children:"No location set"})]})]})]})]}),s.jsx(wge,{userId:e})]})},bge=e=>{switch(e){case"legendary":return{border:"border-purple-400",bg:"bg-gradient-to-br from-purple-50/90 to-pink-50/90",badge:"bg-purple-100 text-purple-800 border-purple-300",icon:s.jsx(Se,{name:"ribbonAward",size:16})};case"uncommon":return{border:"border-blue-400",bg:"bg-gradient-to-br from-blue-50/90 to-cyan-50/90",badge:"bg-blue-100 text-blue-800 border-blue-300",icon:s.jsx(Se,{name:"mediumShootingStar",size:16})};default:return{border:"border-yellow-300",bg:"bg-gradient-to-br from-yellow-50/80 to-amber-50/80",badge:"bg-yellow-100 text-yellow-800 border-yellow-300",icon:s.jsx(Se,{name:"check",size:16})}}},jge=({entry:e,onClick:t,className:r,showProgress:n=!1,progress:a,goal:i})=>{var f;x.useState(!1);const o=!!e.unlocked_at,l=a&&i?Math.min(a/i*100,100):0,c=bge(e.rarity),d=()=>{if(!e.metadata)return null;if(e.type==="festival"&&e.metadata.years_attended){const h=e.metadata.years_attended;return s.jsxs("p",{className:"text-xs text-muted-foreground mb-1",children:["Attended ",h.length," ",h.length===1?"time":"times"," (",h.join(", "),")"]})}return e.type==="artist_milestone"&&e.metadata.show_count?s.jsxs("p",{className:"text-xs text-muted-foreground mb-1",children:[e.metadata.show_count," shows",e.metadata.year_span>=3&&`  ${e.metadata.year_span} years`]}):e.type==="era"&&e.metadata.event_count?s.jsxs("p",{className:"text-xs text-muted-foreground mb-1",children:[e.metadata.event_count," events  ",e.metadata.year_span," years"]}):null},u=s.jsxs(He,{className:ke("cursor-pointer transition-all hover:shadow-md relative overflow-hidden",o?`border-2 ${c.border} ${c.bg}`:"border-gray-200 bg-gray-50 opacity-75",r),onClick:t,children:[s.jsxs(et,{className:"p-4",children:[s.jsx("div",{className:"flex items-start justify-between mb-2",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[s.jsx("h4",{className:"font-semibold text-sm",children:e.entity_name}),o&&e.rarity&&s.jsxs(Ke,{variant:"outline",className:ke("text-xs",c.badge),children:[c.icon,s.jsx("span",{className:"ml-1 capitalize",children:e.rarity})]}),o&&!e.rarity&&s.jsxs(Ke,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 text-xs",children:[s.jsx(Se,{name:"check",size:16,className:"mr-1"}),"Unlocked"]}),!o&&s.jsx(Se,{name:"lock",size:16,color:"var(--neutral-400)"})]}),d(),((f=e.metadata)==null?void 0:f.description)&&s.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:e.metadata.description}),o&&e.unlocked_at&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Unlocked ",Mt(new Date(e.unlocked_at),"MMM d, yyyy")]})]})}),n&&!o&&a!==void 0&&i!==void 0&&s.jsxs("div",{className:"mt-3 space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-muted-foreground",children:"Progress"}),s.jsxs("span",{className:"font-semibold",children:[a,"/",i]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:s.jsx("div",{className:"bg-synth-pink h-1.5 rounded-full transition-all",style:{width:`${l}%`}})})]})]}),o&&s.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[s.jsx("div",{className:ke("absolute top-0 left-0 w-8 h-8 border-t-2 border-l-2 rounded-tl-lg",c.border)}),s.jsx("div",{className:ke("absolute top-0 right-0 w-8 h-8 border-t-2 border-r-2 rounded-tr-lg",c.border)}),s.jsx("div",{className:ke("absolute bottom-0 left-0 w-8 h-8 border-b-2 border-l-2 rounded-bl-lg",c.border)}),s.jsx("div",{className:ke("absolute bottom-0 right-0 w-8 h-8 border-b-2 border-r-2 rounded-br-lg",c.border)})]})]});return e.cultural_context&&o?s.jsx(IP,{children:s.jsxs(bz,{children:[s.jsx(jz,{asChild:!0,children:u}),s.jsx($P,{className:"max-w-xs",children:s.jsx("p",{className:"text-sm",children:e.cultural_context})})]})}):u},oV=({stamps:e,achievements:t=[],loading:r=!1})=>{var h,p,g,v;const[n,a]=x.useState("all"),[i,o]=x.useState("all"),l=e.reduce((y,_)=>(y[_.type]||(y[_.type]=[]),y[_.type].push(_),y),{}),c=t.filter(y=>y.unlocked),d=e.filter(y=>!(n!=="all"&&y.type!==n||i!=="all"&&y.rarity!==i)),u={all:e.length,city:((h=l.city)==null?void 0:h.length)||0,venue:((p=l.venue)==null?void 0:p.length)||0,artist:((g=l.artist)==null?void 0:g.length)||0,scene:((v=l.scene)==null?void 0:v.length)||0,completed_achievements:c.length},f={all:e.length,common:e.filter(y=>y.rarity==="common").length,uncommon:e.filter(y=>y.rarity==="uncommon").length,legendary:e.filter(y=>y.rarity==="legendary").length};return r?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading stamps..."}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsxs(aa,{value:n,onValueChange:a,children:[s.jsx(Hs,{className:"w-[180px] bg-white",children:s.jsx(ia,{placeholder:"Filter by type"})}),s.jsxs(Gs,{className:"bg-white",children:[s.jsxs(qt,{value:"all",children:["All Types (",u.all,")"]}),s.jsxs(qt,{value:"city",children:["Cities (",u.city,")"]}),s.jsxs(qt,{value:"venue",children:["Venues (",u.venue,")"]}),s.jsxs(qt,{value:"artist",children:["Artists (",u.artist,")"]}),s.jsxs(qt,{value:"scene",children:["Scenes (",u.scene,")"]}),s.jsxs(qt,{value:"completed_achievements",children:["Completed Achievements (",u.completed_achievements,")"]})]})]}),n!=="completed_achievements"&&s.jsxs(aa,{value:i,onValueChange:o,children:[s.jsx(Hs,{className:"w-[180px] bg-white",children:s.jsx(ia,{placeholder:"Filter by rarity"})}),s.jsxs(Gs,{className:"bg-white",children:[s.jsxs(qt,{value:"all",children:["All Rarities (",f.all,")"]}),s.jsxs(qt,{value:"common",children:["Common (",f.common,")"]}),s.jsxs(qt,{value:"uncommon",children:["Uncommon (",f.uncommon,")"]}),s.jsxs(qt,{value:"legendary",children:["Legendary (",f.legendary,")"]})]})]})]}),n==="completed_achievements"?c.length===0?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:s.jsx("p",{children:"No completed achievements yet."})}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(y=>{const _={gold:"border-yellow-200 bg-yellow-50",silver:"border-gray-200 bg-gray-50",bronze:"border-orange-200 bg-orange-50"};return s.jsx(He,{className:`border-2 ${_[y.tier||"bronze"]}`,children:s.jsx(et,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"text-3xl",children:y.icon}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h4",{className:"font-semibold",children:y.name.replace(/\s+\([^)]+\)$/,"")}),s.jsx(Ac,{className:"w-4 h-4 text-muted-foreground"})]}),s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:y.description}),y.unlocked_at&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Unlocked ",new Date(y.unlocked_at).toLocaleDateString()]})]})]})})},y.id||y.type)})}):d.length===0?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:s.jsx("p",{children:"No stamps found with selected filters."})}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(y=>s.jsx(jge,{entry:y},y.id))})]})},q5=({isOpen:e,onClose:t,userId:r,existingReviewId:n,existingSignificance:a,existingDescription:i,onSuccess:o})=>{var $,O,z,D,B;const[l,c]=x.useState([]),[d,u]=x.useState(n||""),[f,h]=x.useState("best_setlist"),[p,g]=x.useState(a||""),[v,y]=x.useState(""),[_,w]=x.useState(!1),[b,N]=x.useState(!1),{toast:S}=Rr();x.useEffect(()=>{if(e&&(k(),n)){u(n);const F=a||"";F.toLowerCase().includes("best setlist")?(h("best_setlist"),g(i||"")):F.toLowerCase().includes("first time seeing")?(h("first_favorite_artist"),g(i||"")):F.toLowerCase().includes("first time at")?(h("first_favorite_venue"),g(i||"")):(h("custom"),y(F||""),g(i||""))}},[e,n,a,i]);const k=()=>E(void 0,null,function*(){N(!0);try{const F=yield Io.getUserReviewsForTimeline(r,100);c(F)}catch(F){console.error("Error loading reviews:",F),S({title:"Error",description:"Failed to load reviews",variant:"destructive"})}finally{N(!1)}}),P=()=>E(void 0,null,function*(){var K,Z;if(!n&&!d){S({title:"Selection required",description:"Please select a review",variant:"destructive"});return}const F=n||d;if(!F)return;const U=l.find(Y=>Y.id===F);let G="",q=null;if(f==="best_setlist")G="Best setlist",q=p.trim()||null;else if(f==="first_favorite_artist")G="First time seeing "+(((K=U==null?void 0:U.event)==null?void 0:K.artist_name)||"this artist"),q=p.trim()||null;else if(f==="first_favorite_venue")G="First time at "+(((Z=U==null?void 0:U.event)==null?void 0:Z.venue_name)||"this venue"),q=p.trim()||null;else if(f==="custom"){if(!v.trim()){S({title:"Milestone name required",description:"Please name your custom milestone",variant:"destructive"});return}G=v.trim(),q=p.trim()||null}w(!0);try{if(n){const Q=(yield Io.getTimeline(r,1e3)).find(X=>X.review_id===n);if(!Q)throw new Error("Timeline entry not found");yield Io.updateTimelineMilestone(r,Q.id,G,q)}else yield Io.addTimelineMilestone(r,d,G,q);S({title:"Success",description:"Timeline milestone added successfully"}),o(),A()}catch(Y){console.error("Error saving timeline milestone:",Y),S({title:"Error",description:"Failed to save timeline milestone",variant:"destructive"})}finally{w(!1)}}),A=()=>{_||(u(""),h("best_setlist"),g(""),y(""),t())},R=l.find(F=>F.id===d);return s.jsx(pn,{open:e,onOpenChange:F=>{!F&&!_&&A()},children:s.jsxs(dn,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Vn,{children:[s.jsx(bn,{children:n?"Edit Timeline Milestone":"Add Timeline Milestone"}),s.jsx(os,{children:"Mark a special moment in your music journey. Choose a review and tell us why it's significant."})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[!n&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"review",children:"Select Review"}),b?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(lr,{className:"h-6 w-6 animate-spin text-synth-pink"})}):s.jsxs(aa,{value:d,onValueChange:u,children:[s.jsx(Hs,{id:"review",children:s.jsx(ia,{placeholder:"Choose a review..."})}),s.jsx(Gs,{className:"z-[10000] bg-white",children:l.map(F=>{var U,G,q;return s.jsx(qt,{value:F.id,children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("span",{className:"font-medium",children:[((U=F.event)==null?void 0:U.artist_name)||"Unknown Artist"," @ ",((G=F.event)==null?void 0:G.venue_name)||"Unknown Venue"]}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:[(q=F.event)!=null&&q.event_date?Mt(new Date(F.event.event_date),"MMM d, yyyy"):Mt(new Date(F.created_at),"MMM d, yyyy"),F.rating&&`  ${F.rating.toFixed(1)}`]})]})},F.id)})})]}),R&&s.jsxs("div",{className:"mt-2 p-3 bg-muted rounded-lg",children:[s.jsxs("div",{className:"text-sm font-medium",children:[($=R.event)==null?void 0:$.artist_name," @ ",(O=R.event)==null?void 0:O.venue_name]}),s.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:(z=R.event)!=null&&z.event_date?Mt(new Date(R.event.event_date),"MMM d, yyyy"):Mt(new Date(R.created_at),"MMM d, yyyy")}),R.review_text&&s.jsx("div",{className:"text-sm mt-2 line-clamp-2",children:R.review_text})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"milestone-type",children:"What makes this moment significant?"}),s.jsxs(aa,{value:f,onValueChange:F=>{h(F),F!=="custom"&&(y(""),g(""))},children:[s.jsx(Hs,{id:"milestone-type",children:s.jsx(ia,{})}),s.jsxs(Gs,{className:"z-[10000] bg-white",children:[s.jsx(qt,{value:"best_setlist",children:"Best Setlist"}),s.jsx(qt,{value:"first_favorite_artist",children:"First Time Seeing Favorite Artist"}),s.jsx(qt,{value:"first_favorite_venue",children:"First Time at Favorite Venue"}),s.jsx(qt,{value:"custom",children:"Custom Milestone"})]})]})]}),f==="custom"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"custom-milestone-name",children:"Milestone Name"}),s.jsx(Ar,{id:"custom-milestone-name",placeholder:"e.g., First festival, Best encore, Special guest appearance...",value:v,onChange:F=>y(F.target.value),maxLength:100}),s.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[v.length,"/100"]})]}),(f==="custom"||f==="best_setlist")&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"significance",children:f==="best_setlist"?"Why was this the best setlist?":"Description (optional)"}),s.jsx(ys,{id:"significance",placeholder:f==="best_setlist"?"Tell us what made this setlist stand out...":"Describe why this moment is significant...",value:p,onChange:F=>g(F.target.value),rows:4,maxLength:500}),s.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[p.length,"/500"]})]}),f==="first_favorite_artist"&&R&&s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-blue-900",children:["This will mark this as your first time seeing ",s.jsx("strong",{children:((D=R.event)==null?void 0:D.artist_name)||"this artist"})," as your favorite artist."]})}),f==="first_favorite_venue"&&R&&s.jsx("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-purple-900",children:["This will mark this as your first time at ",s.jsx("strong",{children:((B=R.event)==null?void 0:B.venue_name)||"this venue"})," as your favorite venue."]})})]}),s.jsxs(Nh,{children:[s.jsx(le,{type:"button",variant:"outline",onClick:A,disabled:_,children:"Cancel"}),s.jsx(le,{type:"button",onClick:P,disabled:_||!n&&!d,children:_?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):n?"Update":"Add to Timeline"})]})]})})},lV=({userId:e})=>{const[t,r]=x.useState([]),[n,a]=x.useState(!0),[i,o]=x.useState(0),[l,c]=x.useState(!1),[d,u]=x.useState(null),{toast:f}=Rr();x.useEffect(()=>{h()},[e]);const h=()=>E(void 0,null,function*(){a(!0);try{const b=yield Io.getTimeline(e);r(b),o(b.filter(N=>N.is_pinned).length)}catch(b){console.error("Error loading timeline:",b)}finally{a(!1)}}),p=(b,N)=>E(void 0,null,function*(){try{if(N)yield Io.unpinTimelineEvent(e,b),f({title:"Unpinned",description:"Event removed from pinned timeline"});else{if(i>=5){f({title:"Maximum pins reached",description:"You can pin a maximum of 5 timeline events",variant:"destructive"});return}const S=t.find(k=>k.id===b);S!=null&&S.review_id&&(yield Io.pinTimelineEvent(e,S.review_id),f({title:"Pinned",description:"Event pinned to timeline"}))}yield h()}catch(S){console.error("Error toggling pin:",S),f({title:"Error",description:"Failed to update pin status",variant:"destructive"})}}),g=b=>{if(!b.significance)return{icon:Ol,color:"text-synth-pink",bg:"bg-synth-pink/10"};const N=b.significance.toLowerCase();return N.includes("first review")?{icon:Uk,color:"text-yellow-600",bg:"bg-yellow-100"}:N.includes("first time seeing")?{icon:$t,color:"text-blue-600",bg:"bg-blue-100"}:N.includes("first time at")?{icon:gr,color:"text-purple-600",bg:"bg-purple-100"}:N.includes("best setlist")?{icon:_Q,color:"text-indigo-600",bg:"bg-indigo-100"}:{icon:Qt,color:"text-pink-600",bg:"bg-pink-100"}},v=x.useMemo(()=>[...t].sort((b,N)=>b.is_pinned&&!N.is_pinned?-1:!b.is_pinned&&N.is_pinned?1:new Date(N.created_at).getTime()-new Date(b.created_at).getTime()),[t]);if(n)return s.jsx("div",{className:"space-y-4",children:[...Array(3)].map((b,N)=>s.jsx(hw,{className:"h-32 w-full"},N))});const y=()=>{u(null),c(!0)},_=b=>{u(b),c(!0)},w=()=>{h()};return t.length===0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[s.jsx(Ol,{className:"w-12 h-12 mx-auto mb-4",style:{color:"var(--neutral-600)"}}),s.jsx("p",{className:"font-medium",children:"No timeline highlights yet."}),s.jsx("p",{className:"text-sm mt-2",children:"Mark special moments in your music journey."}),s.jsxs(le,{onClick:y,className:"mt-4",variant:"default",children:["Add Your First Milestone",s.jsx(Vo,{className:"w-4 h-4 ml-2"})]})]}),s.jsx(q5,{isOpen:l,onClose:()=>c(!1),userId:e,existingReviewId:(d==null?void 0:d.review_id)||void 0,existingSignificance:(d==null?void 0:d.significance)||void 0,existingDescription:(d==null?void 0:d.description)||void 0,onSuccess:w})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"mb-6 flex justify-end",children:s.jsxs(le,{onClick:y,variant:"outline",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[s.jsx(Vo,{size:16,style:{marginRight:"var(--spacing-inline, 6px)"}}),"Add Milestone"]})}),s.jsx("div",{className:"absolute left-7 sm:left-9 top-0 bottom-0 w-0.5 bg-gradient-to-b from-synth-pink/30 via-synth-pink/40 to-synth-pink/20"}),s.jsx("div",{className:"space-y-8",children:v.map((b,N)=>{var R,$,O;const S=g(b),k=S.icon,P=(R=b.review)!=null&&R.Event_date?new Date(b.review.Event_date):new Date(b.created_at),A=!b.is_auto_selected;return s.jsxs("div",{className:"relative pl-16 sm:pl-20",children:[s.jsxs("div",{className:"absolute left-0 top-0 flex flex-col items-end pr-2 w-14 sm:w-16",children:[s.jsxs("div",{className:ke("mb-2 px-1.5 py-0.5 rounded text-[10px] sm:text-xs font-semibold whitespace-nowrap shadow-sm text-center w-full",b.is_pinned?"bg-synth-pink text-white":"bg-gray-100 text-gray-700"),children:[s.jsx("div",{className:"leading-tight",children:Mt(P,"MMM")}),s.jsx("div",{className:"leading-tight font-bold",children:Mt(P,"d")}),s.jsx("div",{className:"leading-tight text-[9px] sm:text-[10px] opacity-75",children:Mt(P,"yyyy")})]}),s.jsx("div",{className:ke("w-8 h-8 sm:w-10 sm:h-10 rounded-full border-2 border-white shadow-lg flex items-center justify-center z-10 transition-all duration-300 mx-auto",b.is_pinned?"bg-synth-pink ring-4 ring-synth-pink/30 scale-110 shadow-xl shadow-synth-pink/40":`${S.bg} ring-2 ring-white/80`),children:s.jsx(k,{className:ke("w-4 h-4 sm:w-5 sm:h-5",b.is_pinned?"text-white":S.color)})})]}),s.jsxs(He,{className:ke("relative overflow-hidden transition-all duration-300 hover:shadow-xl w-full max-w-full",b.is_pinned?"border-2 border-synth-pink shadow-lg shadow-synth-pink/20 bg-gradient-to-br from-white to-synth-pink/5":"border border-gray-200 bg-white hover:border-synth-pink/30"),children:[s.jsx(et,{className:"p-4 sm:p-6",children:s.jsxs("div",{className:"flex items-start justify-between gap-3 sm:gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0 overflow-x-hidden",children:[b.significance&&s.jsx("div",{className:"mb-3 sm:mb-4",children:s.jsxs("div",{className:ke("inline-flex items-center gap-1.5 sm:gap-2 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg font-bold text-sm sm:text-base mb-2 sm:mb-3 break-words",b.is_pinned?"bg-synth-pink/10 text-synth-pink border-2 border-synth-pink/30":`${S.bg} ${S.color} border-2 border-current/20`),children:[s.jsx(k,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),s.jsx("span",{className:"break-words",children:b.significance})]})}),b.Event_name&&s.jsx("h4",{className:"font-bold text-base sm:text-lg text-gray-900 mb-2 sm:mb-3 break-words",children:b.Event_name}),(($=b.review)==null?void 0:$.rating)&&s.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 mb-3 sm:mb-4",children:[[...Array(5)].map((z,D)=>s.jsx(Qt,{className:ke("w-4 h-4 sm:w-5 sm:h-5 transition-colors flex-shrink-0",D<Math.round(b.review.rating)?"fill-yellow-400 text-yellow-400":"fill-gray-200 text-gray-200")},D)),s.jsx("span",{className:"text-xs sm:text-sm font-semibold text-gray-700 ml-1 flex-shrink-0",children:b.review.rating.toFixed(1)})]}),((O=b.review)==null?void 0:O.review_text)&&s.jsx("p",{className:"text-xs sm:text-sm text-gray-700 leading-relaxed line-clamp-3 break-words",children:b.review.review_text})]}),s.jsxs("div",{className:"flex flex-col items-end gap-2 shrink-0",children:[b.is_pinned&&s.jsxs(Ke,{className:"bg-synth-pink text-white border-0 text-xs",children:[s.jsx(vN,{className:"w-3 h-3 mr-1 fill-current"}),"Pinned"]}),s.jsxs("div",{className:"flex gap-1",children:[A&&s.jsx(le,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full text-gray-400 hover:text-synth-pink hover:bg-synth-pink/5",onClick:()=>_(b),title:"Edit milestone",children:s.jsx(TF,{className:"w-4 h-4"})}),s.jsx(le,{variant:"ghost",size:"sm",className:ke("h-8 w-8 p-0 rounded-full transition-all",b.is_pinned?"text-synth-pink hover:bg-synth-pink/10":"text-gray-400 hover:text-synth-pink hover:bg-synth-pink/5"),onClick:()=>p(b.id,b.is_pinned),disabled:!b.is_pinned&&i>=5,title:b.is_pinned?"Unpin":"Pin to timeline",children:b.is_pinned?s.jsx(vN,{className:"w-4 h-4 fill-current"}):s.jsx(vN,{className:"w-4 h-4"})})]})]})]})}),b.is_pinned&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-synth-pink via-synth-pink-light to-transparent"})]})]},b.id)})})]}),s.jsx(q5,{isOpen:l,onClose:()=>c(!1),userId:e,existingReviewId:(d==null?void 0:d.review_id)||void 0,existingSignificance:(d==null?void 0:d.significance)||void 0,existingDescription:(d==null?void 0:d.description)||void 0,onSuccess:w})]})};class N0{static getBucketList(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("bucket_list").select("*").eq("user_id",t).order("added_at",{ascending:!1});if(n)throw n;return yield Promise.all((r||[]).map(i=>E(this,null,function*(){if(i.entity_type==="artist"){const{data:o}=yield T.from("artists").select("id, name, image_url").eq("id",i.entity_id).single();return H(M({},i),{artist:o||void 0})}else if(i.entity_type==="venue"){const{data:o}=yield T.from("venues").select("id, name, image_url").eq("id",i.entity_id).single();return H(M({},i),{venue:o||void 0})}return i})))}catch(r){return console.error("Error fetching bucket list:",r),[]}})}static addArtist(t,r,n){return E(this,null,function*(){try{const{error:a}=yield T.from("bucket_list").insert({user_id:t,entity_type:"artist",entity_id:r,entity_name:n});if(a){if(a.code==="23505")return!0;throw a}return!0}catch(a){return console.error("Error adding artist to bucket list:",a),!1}})}static addVenue(t,r,n){return E(this,null,function*(){try{const{error:a}=yield T.from("bucket_list").insert({user_id:t,entity_type:"venue",entity_id:r,entity_name:n});if(a){if(a.code==="23505")return!0;throw a}return!0}catch(a){return console.error("Error adding venue to bucket list:",a),!1}})}static removeItem(t,r){return E(this,null,function*(){try{const{error:n}=yield T.from("bucket_list").delete().eq("id",r).eq("user_id",t);if(n)throw n;return!0}catch(n){return console.error("Error removing item from bucket list:",n),!1}})}static removeEntity(t,r,n){return E(this,null,function*(){try{const{error:a}=yield T.from("bucket_list").delete().eq("user_id",t).eq("entity_type",r).eq("entity_id",n);if(a)throw a;return!0}catch(a){return console.error("Error removing entity from bucket list:",a),!1}})}static isInBucketList(t,r,n){return E(this,null,function*(){try{const{data:a,error:i}=yield T.from("bucket_list").select("id").eq("user_id",t).eq("entity_type",r).eq("entity_id",n).single();if(i&&i.code!=="PGRST116")throw i;return!!a}catch(a){return console.error("Error checking bucket list:",a),!1}})}static searchBucketList(t,r,n=50){return E(this,null,function*(){try{if(!r.trim())return yield this.getBucketList(t);const{data:a,error:i}=yield T.rpc("search_bucket_list",{p_user_id:t,p_search_query:r.trim(),p_limit:n});if(i)throw i;return(a||[]).map(o=>({id:o.id,user_id:o.user_id,entity_type:o.entity_type,entity_id:o.entity_id,entity_name:o.entity_name,added_at:o.added_at,metadata:o.metadata||{},artist:o.artist_id?{id:o.artist_id,name:o.artist_name||o.entity_name,image_url:o.artist_image_url||void 0}:void 0,venue:o.venue_id?{id:o.venue_id,name:o.venue_name||o.entity_name,image_url:o.venue_image_url||void 0}:void 0}))}catch(a){return console.error("Error searching bucket list:",a),[]}})}}const cV=({userId:e})=>{const[t,r]=x.useState([]),[n,a]=x.useState(!0),[i,o]=x.useState(!1),[l,c]=x.useState(!1),[d,u]=x.useState(!1),[f,h]=x.useState(!1);x.useEffect(()=>{p()},[e]);const p=()=>E(void 0,null,function*(){a(!0);try{const w=yield N0.getBucketList(e);r(w)}catch(w){console.error("Error loading bucket list:",w)}finally{a(!1)}}),g=w=>E(void 0,null,function*(){u(!0);try{(yield N0.addArtist(e,w.id,w.name))&&(o(!1),yield p())}catch(b){console.error("Error adding artist:",b)}finally{u(!1)}}),v=w=>E(void 0,null,function*(){u(!0);try{(yield N0.addVenue(e,w.id,w.name))&&(c(!1),yield p())}catch(b){console.error("Error adding venue:",b)}finally{u(!1)}}),y=w=>E(void 0,null,function*(){try{(yield N0.removeItem(e,w))&&(yield p())}catch(b){console.error("Error removing item:",b)}}),_=w=>{w.entity_type==="artist"?window.dispatchEvent(new CustomEvent("open-artist-card",{detail:{artistId:w.entity_id,artistName:w.entity_name}})):w.entity_type==="venue"&&window.dispatchEvent(new CustomEvent("open-venue-card",{detail:{venueId:w.entity_id,venueName:w.entity_name}}))};return n?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(lr,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):s.jsxs("div",{className:"space-y-4 overflow-visible",children:[s.jsx(He,{className:f?"mb-4":"",style:{overflow:"visible"},children:s.jsxs(et,{className:"p-4",style:{overflow:"visible"},children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[s.jsxs(le,{variant:"outline",onClick:()=>{o(!i),c(!1),h(!1)},className:"flex-1",children:[s.jsx(Vo,{className:"w-4 h-4 mr-2"}),"Add Artist"]}),s.jsxs(le,{variant:"outline",onClick:()=>{c(!l),o(!1),h(!1)},className:"flex-1",children:[s.jsx(Vo,{className:"w-4 h-4 mr-2"}),"Add Venue"]})]}),i&&s.jsxs("div",{className:"mt-4 relative",style:{zIndex:1e3},children:[s.jsx(h1,{onArtistSelect:g,placeholder:"Search for an artist to add...",onSearchStateChange:h}),d&&s.jsxs("div",{className:"flex items-center justify-center mt-2",children:[s.jsx(lr,{className:"w-4 h-4 animate-spin text-muted-foreground mr-2"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"Adding..."})]})]}),l&&s.jsxs("div",{className:"mt-4 relative",style:{zIndex:1e3},children:[s.jsx(q8,{onVenueSelect:v,placeholder:"Search for a venue to add...",onSearchStateChange:h}),d&&s.jsxs("div",{className:"flex items-center justify-center mt-2",children:[s.jsx(lr,{className:"w-4 h-4 animate-spin text-muted-foreground mr-2"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"Adding..."})]})]})]})}),!f&&s.jsx(s.Fragment,{children:t.length===0?s.jsx(He,{children:s.jsxs(et,{className:"p-8 text-center",children:[s.jsx("p",{className:"text-muted-foreground mb-2",children:"Your bucket list is empty"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Add artists or venues to get notified when new shows are announced!"})]})}):s.jsx("div",{className:"max-h-[600px] overflow-y-auto pr-2 space-y-3",children:t.map(w=>{var b,N,S,k;return s.jsx(He,{className:"cursor-pointer hover:shadow-md transition-shadow border-2 hover:border-synth-pink/50",onClick:()=>_(w),children:s.jsx(et,{className:"p-3",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Vr,{className:"h-10 w-10 flex-shrink-0",children:w.entity_type==="artist"&&((b=w.artist)!=null&&b.image_url)||w.entity_type==="venue"&&((N=w.venue)!=null&&N.image_url)?s.jsx(sn,{src:w.entity_type==="artist"?(S=w.artist)==null?void 0:S.image_url:(k=w.venue)==null?void 0:k.image_url,alt:w.entity_name}):s.jsx(Wr,{className:"text-xs",children:w.entity_type==="artist"?s.jsx($t,{className:"w-5 h-5"}):s.jsx(Yi,{className:"w-5 h-5"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("h4",{className:"font-semibold text-sm truncate",children:w.entity_name}),s.jsx(le,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 flex-shrink-0 hover:bg-red-100 hover:text-red-600",onClick:P=>{P.stopPropagation(),y(w.id)},children:s.jsx(Gr,{className:"w-3 h-3"})})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx(Ke,{variant:"secondary",className:`text-xs ${w.entity_type==="artist"?"bg-pink-100 text-pink-700":"bg-blue-100 text-blue-700"}`,children:w.entity_type==="artist"?s.jsxs(s.Fragment,{children:[s.jsx($t,{className:"w-2.5 h-2.5 mr-1"}),"Artist"]}):s.jsxs(s.Fragment,{children:[s.jsx(Yi,{className:"w-2.5 h-2.5 mr-1"}),"Venue"]})}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:["Added ",new Date(w.added_at).toLocaleDateString()]})]})]})]})})},w.id)})})})]})};class Nge{static getBehavioralAchievements(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("achievements").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(n)throw n;const{data:a,error:i}=yield T.from("user_achievement_progress").select("*").eq("user_id",t);if(i)throw i;const o=new Map;(a||[]).forEach(c=>{o.set(c.achievement_id,c)});const l=[];return(r||[]).forEach(c=>{const d=o.get(c.id),u=(d==null?void 0:d.current_progress)||0,f=(d==null?void 0:d.highest_tier_achieved)||null,h=parseInt(String(c.bronze_goal))||0,p=parseInt(String(c.silver_goal))||0,g=parseInt(String(c.gold_goal))||0;let v=!1,y=h,_=null,w,b=c.bronze_requirement;f==="gold"?(v=!0,_="gold",y=g,b=c.gold_requirement,w=d==null?void 0:d.gold_achieved_at):f==="silver"?(v=!0,_="silver",y=p,b=c.silver_requirement,w=d==null?void 0:d.silver_achieved_at):f==="bronze"?(v=!0,_="bronze",y=h,b=c.bronze_requirement,w=d==null?void 0:d.bronze_achieved_at):(y=h,_=null,b=c.bronze_requirement);const N=this.getIconForAchievement(c.achievement_key,c.category);l.push({id:c.id,type:c.achievement_key,name:c.name,description:b,icon:N,tier:_||void 0,progress:u,goal:y,unlocked:v,unlocked_at:w,metadata:(d==null?void 0:d.progress_metadata)||{}})}),l.sort((c,d)=>{if(c.unlocked!==d.unlocked)return c.unlocked?-1:1;if(c.unlocked&&d.unlocked){const u={gold:0,silver:1,bronze:2},f=c.tier||"bronze",h=d.tier||"bronze",p=(u[f]||2)-(u[h]||2);if(p!==0)return p}return(d.progress||0)-(c.progress||0)})}catch(r){return console.error("Error fetching behavioral achievements:",r),[]}})}static getIconForAchievement(t,r){const n={genre_curator:"",genre_specialist:"",bucket_list_starter:"",intentional_explorer:"",return_engagement:"",new_blood:"",festival_attendance:"",artist_devotee:"",venue_regular:"",go_with_friends:"",venue_hopper:"",scene_explorer:"",city_crosser:"",era_walker:"",first_through_door:"",trusted_voice:"",deep_cut_reviewer:"",scene_regular:"",road_tripper:"",venue_loyalist:"",genre_blender:"",memory_maker:"",early_adopter:"",connector:"",passport_complete:""};return n[t]?n[t]:{exploration:"",specialization:"",milestones:"",discovery:"",loyalty:"",social:""}[r]||""}static checkAndUnlockAchievements(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("check_all_achievements",{p_user_id:t});if(r)throw r}catch(r){console.error("Error checking achievements:",r)}})}static mapAchievementToDisplay(t){const r=this.getAchievementInfo(t.achievement_type,t.tier);return{id:t.id,type:t.achievement_type,name:r.name,description:r.description,icon:r.icon,tier:t.tier,progress:t.progress||0,goal:t.goal||0,unlocked:!!t.unlocked_at,unlocked_at:t.unlocked_at,metadata:t.metadata}}static getAchievementInfo(t,r){const n=r?` (${r.charAt(0).toUpperCase()+r.slice(1)})`:"";return{venue_hopper:{name:"Venue Hopper"+n,description:r==="gold"?"Attend shows at 15 different venues":r==="silver"?"Attend shows at 7 different venues":"Attend shows at 3 different venues",icon:""},scene_explorer:{name:"Scene Explorer"+n,description:r==="gold"?"Engage with 7 distinct scenes":r==="silver"?"Engage with 4 distinct scenes":"Engage with 2 distinct scenes",icon:""},city_crosser:{name:"City Crosser"+n,description:r==="gold"?"Attend shows in 10 cities":r==="silver"?"Attend shows in 5 cities":"Attend shows in 2 cities",icon:""},era_walker:{name:"Era Walker"+n,description:r==="gold"?"Attend shows from 5 different eras":r==="silver"?"Attend shows from 3 different eras":"Attend shows from 2 different eras",icon:""},first_through_door:{name:"First Through the Door"+n,description:r==="gold"?"Attend 6 emerging-artist shows":r==="silver"?"Attend 3 emerging-artist shows":"Attend 1 emerging-artist show",icon:""},trusted_voice:{name:"Trusted Voice"+n,description:r==="gold"?"Reviews saved by others 25 times":r==="silver"?"Reviews saved by others 10 times":"Reviews saved by others 3 times",icon:""},deep_cut_reviewer:{name:"Deep Cut Reviewer"+n,description:r==="gold"?"Review 10 non-headliner performances":r==="silver"?"Review 5 non-headliner performances":"Review 2 non-headliner performances",icon:""},scene_regular:{name:"Scene Regular"+n,description:r==="gold"?"Attend 10 events in the same scene":r==="silver"?"Attend 6 events in the same scene":"Attend 3 events in the same scene",icon:""},road_tripper:{name:"Road Tripper"+n,description:r==="gold"?"Attend 6 out-of-town shows":r==="silver"?"Attend 3 out-of-town shows":"Attend 1 out-of-town show",icon:""},venue_loyalist:{name:"Venue Loyalist"+n,description:r==="gold"?"Attend 10 shows at the same venue":r==="silver"?"Attend 6 shows at the same venue":"Attend 3 shows at the same venue",icon:""},genre_blender:{name:"Genre Blender"+n,description:r==="gold"?"Attend shows across 6 genres":r==="silver"?"Attend shows across 4 genres":"Attend shows across 2 genres",icon:""},memory_maker:{name:"Memory Maker"+n,description:r==="gold"?"Pin 5 defining shows to your passport":r==="silver"?"Pin 3 defining shows to your passport":"Pin 1 defining show to your passport",icon:""},early_adopter:{name:"Early Adopter"+n,description:r==="gold"?"Attend 5 shows early after joining":r==="silver"?"Attend 3 shows early after joining":"Attend a show shortly after joining",icon:""},connector:{name:"Connector"+n,description:r==="gold"?"Attend 10 shows with friends":r==="silver"?"Attend 5 shows with friends":"Attend 2 shows with friends",icon:""},passport_complete:{name:"Passport Complete"+n,description:r==="gold"?"Unlock all 15 achievements":r==="silver"?"Unlock 10 achievements":"Unlock 5 achievements",icon:""}}[t]||{name:"Achievement"+n,description:"Awarded for your musical journey",icon:""}}}const Sge=({isOpen:e,onClose:t,userId:r,userName:n,inline:a=!1})=>{const[i,o]=x.useState({cities:[],venues:[],artists:[],scenes:[],totalCount:0}),[l,c]=x.useState([]),[d,u]=x.useState([]),[f,h]=x.useState([]),[p,g]=x.useState(!0),[v,y]=x.useState("identity");x.useEffect(()=>{(e||a)&&_()},[e,a,r]);const _=()=>E(void 0,null,function*(){g(!0);try{const[b,N,S,k]=yield Promise.all([Io.getPassportProgress(r),Io.getStampsByRarity(r),Nge.getBehavioralAchievements(r),Io.getNextToUnlock(r)]);o(b),c(N),u(S),h(k)}catch(b){console.error("Error loading passport data:",b)}finally{g(!1)}});if(!e)return null;const w=s.jsxs(s.Fragment,{children:[a&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold gradient-text",children:"Live Music Passport"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your curated, earned, and evolving snapshot of your live-music journey"})]}),p?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Se,{name:"refresh",size:24,className:"animate-spin",color:"var(--neutral-600)"})}):s.jsxs(Li,{value:v,onValueChange:b=>y(b),className:`${a?"":"mt-4"} w-full max-w-full overflow-x-hidden`,children:[s.jsxs(yi,{className:"grid w-full max-w-full grid-cols-5 gap-0.5 p-0.5 overflow-x-hidden",children:[s.jsxs(Xr,{value:"identity",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(Se,{name:"user",size:16,className:"flex-shrink-0",color:"var(--neutral-900)"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Identity"})]}),s.jsxs(Xr,{value:"stamps",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(Se,{name:"mediumShootingStar",size:16,className:"flex-shrink-0",color:"var(--neutral-900)"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Stamps"})]}),s.jsxs(Xr,{value:"achievements",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(Se,{name:"ribbonAward",size:16,className:"flex-shrink-0",color:"var(--neutral-900)"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Achievements"})]}),s.jsxs(Xr,{value:"timeline",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(Se,{name:"clock",size:16,className:"flex-shrink-0",color:"var(--neutral-900)"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Timeline"})]}),s.jsxs(Xr,{value:"bucket",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(Se,{name:"checkMark",size:16,className:"flex-shrink-0",color:"var(--neutral-900)"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Bucket List"})]})]}),s.jsx(Jr,{value:"identity",className:"mt-4",children:s.jsx(iV,{userId:r,userName:n})}),s.jsx(Jr,{value:"stamps",className:"mt-4",children:s.jsx(oV,{stamps:l,achievements:d,loading:p})}),s.jsx(Jr,{value:"achievements",className:"mt-4 w-full max-w-full overflow-x-hidden",children:d.length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx("p",{children:"No achievements unlocked yet."}),s.jsx("p",{className:"text-xs mt-1",children:"Keep attending events and writing reviews to unlock achievements!"})]}):s.jsx("div",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:d.map(b=>{const N=b.goal>0?Math.min(b.progress/b.goal*100,100):0;return s.jsxs("div",{className:`flex gap-[6px] items-center px-6 py-3 rounded-[10px] shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)] w-full max-w-full ${b.unlocked?"bg-[#fcfcfc] border border-[#5d646f]":"bg-[rgba(201,201,201,0.5)] border border-[#5d646f]"}`,children:[s.jsx("p",{className:"font-bold text-[35px] leading-[normal] flex-shrink-0",children:b.icon||""}),s.jsxs("div",{className:"flex flex-col gap-[6px] items-start justify-center flex-1 min-w-0",children:[s.jsx("p",{className:"font-bold leading-[normal] text-[20px] text-black break-words",children:b.name}),s.jsx("p",{className:"font-normal leading-[normal] text-[#5d646f] text-[16px] break-words whitespace-pre-wrap",children:b.description}),b.unlocked?s.jsxs("div",{className:"bg-[#fdf2f7] flex gap-3 h-[22px] items-center px-3 py-3 rounded-[10px] shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)] mt-1",children:[s.jsx("svg",{width:"15",height:"12",viewBox:"0 0 15 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-[17px] h-[17px]",children:s.jsx("path",{d:"M1 6L5 10L14 1",stroke:"#b00056",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),s.jsx("p",{className:"font-normal leading-[normal] text-[16px] text-[#b00056]",children:"Unlocked"})]}):s.jsxs("div",{className:"w-full mt-1",children:[s.jsx("div",{className:"bg-[rgba(201,201,201,0.5)] border border-[#5d646f] h-[10px] rounded-[10px] overflow-hidden relative w-full mb-1",children:s.jsx("div",{className:"absolute bg-[#cc2486] border border-[#5d646f] h-[10px] rounded-l-[10px]",style:{width:`${N}%`}})}),s.jsxs("p",{className:"font-normal leading-[normal] text-[#5d646f] text-[16px] text-right w-full",children:[b.progress,"/",b.goal]})]})]})]},b.id||b.type)})})}),s.jsx(Jr,{value:"timeline",className:"mt-4",children:s.jsx(lV,{userId:r})}),s.jsx(Jr,{value:"bucket",className:"mt-4 relative overflow-visible",children:s.jsx(cV,{userId:r})})]})]});return a?s.jsx("div",{className:"w-full",children:w}):s.jsx(pn,{open:e,onOpenChange:t,children:s.jsxs(dn,{className:"max-w-5xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Vn,{children:[s.jsx(bn,{children:"Live Music Passport"}),s.jsx(os,{children:"Your curated, earned, and evolving snapshot of your live-music journey"})]}),w]})})},kge=({currentUserId:e,profileUserId:t,onBack:r,onEdit:n,onSettings:a,onSignOut:i,onNavigateToProfile:o,onNavigateToChat:l,onNavigateToNotifications:c,menuOpen:d=!1,onMenuClick:u,hideHeader:f=!1})=>{var Te,dt,mr,Mn;const[h,p]=x.useState(null),[g,v]=x.useState([]),[y,_]=x.useState(!0),[w,b]=x.useState(!1),[N,S]=x.useState(!1),[k,P]=x.useState([]),[A,R]=x.useState(0),[$,O]=x.useState(null),[z,D]=x.useState([]),[B,F]=x.useState("my-events"),[U,G]=x.useState(!1),[q,K]=x.useState([]),[Z,Y]=x.useState(!1),[Q,X]=x.useState([]),[ne,re]=x.useState(!1),[ye,ee]=x.useState(!0),[de,xe]=x.useState(null),[ie,se]=x.useState(!1),[V,ue]=x.useState(!1),[_e,ae]=x.useState(null),[we,oe]=x.useState(!1),[ce,Ae]=x.useState(!1),[Be,Xe]=x.useState(!1),[ge,We]=x.useState(!1),[Ue,at]=x.useState("friends"),[mt,Ye]=x.useState(!1),[Ft,_t]=x.useState("none"),[Lt,Oe]=x.useState(null),[qe,Ne]=x.useState(0),[Fe,ve]=x.useState({cities:0,venues:0,artists:0,scenes:0}),{toast:Me}=Rr(),{user:ze,sessionExpired:ct}=xs(),Et=as(),gt=t||e,St=!t||t===e;x.useEffect(()=>{if(console.log(" ProfileView: useEffect triggered with:",{targetUserId:gt,sessionExpired:ct,user:ze==null?void 0:ze.id,hasUser:!!ze}),ct){console.log(" ProfileView: Session expired, skipping data fetch"),_(!1);return}if(!ze){console.log(" ProfileView: User not available yet, waiting...");return}const fe=setTimeout(()=>{console.log(" ProfileView: User is available, fetching data..."),_(!0),console.log(" ProfileView: Loading state set to TRUE"),E(void 0,null,function*(){try{console.log(" ProfileView: fetchData function called - parallelizing queries"),yield Promise.all([dr(),Sr(),lt(),Qe(),rr(),At(),yt(),Ie(),pe(),St?Promise.resolve():De()]),console.log(" ProfileView: All data fetched successfully")}catch(ot){console.error(" ProfileView: Error fetching data:",ot)}finally{_(!1),console.log(" ProfileView: Loading state set to FALSE")}})},300);return()=>clearTimeout(fe)},[gt,ct,ze]),x.useEffect(()=>{B==="interested"&&gt&&(console.log(" ProfileView: User switched to interested tab, refreshing events..."),Sr())},[B,gt]),x.useEffect(()=>{if(window.location.hash.substring(1)==="spotify"){F("spotify");return}if(St){const Re=sessionStorage.getItem("profileTab");Re&&["timeline","interested","passport"].includes(Re)&&(F(Re==="timeline"?"passport":Re),sessionStorage.removeItem("profileTab"))}},[St]),x.useEffect(()=>{if(St){const fe=sessionStorage.getItem("profileTab");fe&&["timeline","interested","passport"].includes(fe)&&(F(fe==="timeline"?"passport":fe),sessionStorage.removeItem("profileTab"))}},[St]),x.useEffect(()=>{if(!ze){ee(!0);return}if(ze.id===e){ee(!0);return}E(void 0,null,function*(){try{const{data:fe}=yield T.from("user_relationships").select("id").eq("relationship_type","friend").eq("status","accepted").or(`and(user_id.eq.${ze.id},related_user_id.eq.${e}),and(user_id.eq.${e},related_user_id.eq.${ze.id}))`).limit(1);ee(Array.isArray(fe)?fe.length>0:!1)}catch(fe){ee(!0)}})},[ze,e]);const dr=()=>E(void 0,null,function*(){var fe,Re,ot,vt,ut,Pe;try{if(console.log(" ProfileView: Starting profile fetch..."),console.log(" ProfileView: sessionExpired:",ct),console.log(" ProfileView: user:",ze),console.log(" ProfileView: currentUserId:",e),ct||!ze){console.log(" Session expired or no user, skipping profile fetch");return}console.log(" Fetching profile for user:",gt),console.log("ProfileView: Fetching profile for user:",gt);const Ge=Rt=>E(void 0,null,function*(){return console.log(`ProfileView: Attempting profile lookup by ${Rt}`),yield T.from("users").select("*").eq(Rt,gt).maybeSingle()});let Ee=null;const{data:ft,error:Pt}=yield Ge("user_id");if(console.log("ProfileView: Profile query result (user_id):",{data:ft,error:Pt}),Pt&&Pt.code!=="PGRST116"){if(console.error("Profile query error:",Pt),console.error("Error code:",Pt.code),console.error("Error message:",Pt.message),console.error("Error details:",Pt.details),(fe=Pt.message)!=null&&fe.includes("invalid")||(Re=Pt.message)!=null&&Re.includes("API key")||(ot=Pt.message)!=null&&ot.includes("JWT")||(vt=Pt.message)!=null&&vt.includes("expired")){console.error("Session error in ProfileView:",Pt),Me({title:"Session Expired",description:"Your session has expired. Please sign in again.",variant:"destructive"});return}}else Ee=ft;if(!Ee){const{data:Rt,error:hr}=yield Ge("id");if(console.log("ProfileView: Profile query result (id):",{fallbackData:Rt,fallbackError:hr}),hr&&hr.code!=="PGRST116")throw hr;Ee=Rt}if(Ee){console.log("Profile found:",Ee),p(Ee);return}console.log("No profile found for user:",e),console.log("Creating default profile for user:",e);const{data:{user:yr}}=yield T.auth.getUser(),un=((ut=yr==null?void 0:yr.user_metadata)==null?void 0:ut.name)||((Pe=yr==null?void 0:yr.email)==null?void 0:Pe.split("@")[0])||"New User";console.log("Creating profile with name:",un);const{data:hn,error:xn}=yield T.from("users").insert({user_id:e,name:un,bio:"Music lover looking to connect at events!",instagram_handle:null,music_streaming_profile:null}).select().single();console.log("Profile creation result:",{newProfile:hn,insertError:xn}),xn?(console.error("Error creating profile:",xn),console.error("Insert error details:",xn.details),console.error("Insert error hint:",xn.hint),p({id:"temp",user_id:e,name:un,avatar_url:null,bio:"Music lover looking to connect at events!",instagram_handle:null,music_streaming_profile:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})):hn&&(console.log("Profile created successfully:",hn),p(hn))}catch(Ge){console.error("Error fetching profile:",Ge),p({id:"temp",user_id:e,name:"New User",avatar_url:null,bio:null,instagram_handle:null,music_streaming_profile:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}}),Sr=()=>E(void 0,null,function*(){try{if(console.log(" ProfileView: fetchUserEvents called for user:",gt),ct||!ze){console.log("Session expired or no user, skipping user events fetch");return}console.log(" ProfileView: Fetching user events from database...");let Re=(yield Qr.getUserInterestedEvents(gt)).events.map(Ge=>Ge.event).filter(Boolean);console.log(" ProfileView: Database query returned:",Re==null?void 0:Re.length,"events");const{data:ot}=yield T.from("reviews").select("event_id").eq("user_id",gt).eq("was_there",!0),vt=new Set((ot==null?void 0:ot.map(Ge=>Ge.event_id))||[]),Pe=((Re==null?void 0:Re.map(Ge=>{var yr,un,hn,xn,Rt,hr,or,Gt,xr,Xt,jr,en,Hn,Tt,kr,ds,Oa,Dn,Hr,Br,En,$r,Qn,la,wi;const Ee=Ge,ft=Ge;console.log("ProfileView: Processing event in getUserEvents:",{title:Ee==null?void 0:Ee.title,artist_name:Ee==null?void 0:Ee.artist_name,venue_name:Ee==null?void 0:Ee.venue_name,poster_image_url:ft==null?void 0:ft.poster_image_url,images:ft==null?void 0:ft.images}),(yr=Ee==null?void 0:Ee.title)!=null&&yr.includes("Anotha")&&console.log("ProfileView: Found Anotha event in getUserEvents:",{item:Ge,jambaseEvent:Ee,title:Ee==null?void 0:Ee.title,artist_name:Ee==null?void 0:Ee.artist_name,venue_name:Ee==null?void 0:Ee.venue_name,venue_city:Ee==null?void 0:Ee.venue_city,venue_state:Ee==null?void 0:Ee.venue_state});const Pt={id:(un=Ee==null?void 0:Ee.id)!=null?un:"",jambase_event_id:(xn=(hn=Ee==null?void 0:Ee.jambase_event_id)!=null?hn:Ee==null?void 0:Ee.id)!=null?xn:"",title:(Rt=Ee==null?void 0:Ee.title)!=null?Rt:"",artist_name:(hr=Ee==null?void 0:Ee.artist_name)!=null?hr:"",artist_id:(or=Ee==null?void 0:Ee.artist_id)!=null?or:null,venue_name:(Gt=Ee==null?void 0:Ee.venue_name)!=null?Gt:"",venue_id:(xr=Ee==null?void 0:Ee.venue_id)!=null?xr:null,venue_address:(Xt=Ee==null?void 0:Ee.venue_address)!=null?Xt:null,venue_city:(jr=Ee==null?void 0:Ee.venue_city)!=null?jr:null,venue_state:(en=Ee==null?void 0:Ee.venue_state)!=null?en:null,venue_zip:(Hn=Ee==null?void 0:Ee.venue_zip)!=null?Hn:null,event_date:(Tt=Ee==null?void 0:Ee.event_date)!=null?Tt:"",doors_time:(kr=Ee==null?void 0:Ee.doors_time)!=null?kr:null,description:(ds=Ee==null?void 0:Ee.description)!=null?ds:null,genres:Array.isArray(Ee==null?void 0:Ee.genres)?Ee.genres:[],latitude:(Oa=Ee==null?void 0:Ee.latitude)!=null?Oa:null,longitude:(Dn=Ee==null?void 0:Ee.longitude)!=null?Dn:null,ticket_available:!!(Ee!=null&&Ee.ticket_available),price_range:(Hr=Ee==null?void 0:Ee.price_range)!=null?Hr:null,ticket_urls:(Ee==null?void 0:Ee.ticket_urls)||[],poster_image_url:(Br=ft==null?void 0:ft.poster_image_url)!=null?Br:null,event_media_url:(En=ft==null?void 0:ft.event_media_url)!=null?En:null,images:($r=ft==null?void 0:ft.images)!=null?$r:null,media_urls:(Qn=ft==null?void 0:ft.media_urls)!=null?Qn:null,setlist:null,setlist_enriched:null,setlist_song_count:null,setlist_fm_id:null,setlist_fm_url:null,setlist_source:null,setlist_last_updated:null,tour_name:(la=Ee==null?void 0:Ee.tour_name)!=null?la:null,created_at:Ge.created_at,updated_at:Ge.created_at};return(wi=Ee==null?void 0:Ee.title)!=null&&wi.includes("Anotha")&&console.log("ProfileView: Processed Anotha event:",{processedEvent:Pt,title:Pt.title,artist_name:Pt.artist_name,venue_name:Pt.venue_name,venue_city:Pt.venue_city,venue_state:Pt.venue_state}),Pt}))||[]).filter(Ge=>!vt.has(Ge.id));console.log("ProfileView: Final filtered events:",Pe.map(Ge=>({title:Ge.title,artist_name:Ge.artist_name,venue_name:Ge.venue_name}))),v(Pe),console.log(" ProfileView: fetchUserEvents completed successfully")}catch(fe){console.error(" ProfileView: Error fetching user events:",fe),v([])}finally{_(!1)}}),wt=w?vde(g):gde(g),lt=()=>E(void 0,null,function*(){var fe;try{if(ct||!ze){console.log("Session expired or no user, skipping reviews fetch");return}console.log(" ProfileView: Fetching reviews for user:",gt),console.log(" ProfileView: isViewingOwnProfile:",St),console.log(" ProfileView: Session user:",ze==null?void 0:ze.id);let Re;try{Re=yield bs.getUserReviewHistory(gt),console.log(" ProfileView: Raw review data:",Re),console.log(" ProfileView: Number of reviews in result:",Re.reviews.length),Re.reviews.length>0&&console.log(" ProfileView: First review event data:",{reviewId:Re.reviews[0].review.id,eventId:Re.reviews[0].review.event_id,event:Re.reviews[0].event,eventTitle:(fe=Re.reviews[0].event)==null?void 0:fe.title})}catch(Pe){console.error(" ProfileView: Error calling ReviewService.getUserReviewHistory:",Pe),P([]);return}const ot=Re.reviews.filter(Pe=>!(!St&&!Pe.review.is_public||Pe.review.review_text==="ATTENDANCE_ONLY"&&!Pe.review.was_there)).map(Pe=>{var ft,Pt,yr,un,hn,xn,Rt,hr,or,Gt,xr,Xt;let Ge;const Ee=Pe.review.Event_date||Pe.review.event_date;if(Ee){if(Ee instanceof Date)Ge=Ee;else if(typeof Ee=="string"){const[jr,en,Hn]=Ee.split("-").map(Number);if(jr&&en&&Hn){const Tt=new Date(jr,en-1,Hn);isNaN(Tt.getTime())||(Ge=Tt)}}}return{id:Pe.review.id,user_id:Pe.review.user_id,event_id:Pe.review.event_id,artist_id:Pe.review.artist_id,venue_id:Pe.review.venue_id,rating:Pe.review.rating,rank_order:Pe.review.rank_order,artist_performance_rating:Pe.review.artist_performance_rating,production_rating:Pe.review.production_rating,venue_rating:Pe.review.venue_rating,location_rating:Pe.review.location_rating,value_rating:Pe.review.value_rating,review_text:Pe.review.review_text,reaction_emoji:Pe.review.reaction_emoji,artist_performance_feedback:Pe.review.artist_performance_feedback,production_feedback:Pe.review.production_feedback,venue_feedback:Pe.review.venue_feedback,location_feedback:Pe.review.location_feedback,value_feedback:Pe.review.value_feedback,photos:Pe.review.photos||[],videos:Pe.review.videos||[],setlist:Pe.review.setlist,is_public:Pe.review.is_public,is_draft:Pe.review.is_draft||!1,was_there:Pe.review.was_there,created_at:Pe.review.created_at,ticket_price_paid:Pe.review.ticket_price_paid,category_average:jt(Pe.review),Event_date:Ge,event_date:Ge,artist_name:(ft=Pe.event)==null?void 0:ft.artist_name,venue_name:(Pt=Pe.event)==null?void 0:Pt.venue_name,jambase_events:Pe.event||null,event:{event_name:((yr=Pe.event)==null?void 0:yr.title)||((un=Pe.event)!=null&&un.artist_name&&((hn=Pe.event)!=null&&hn.venue_name)?`${Pe.event.artist_name} at ${Pe.event.venue_name}`:((xn=Pe.event)==null?void 0:xn.event_name)||"Concert Review"),location:((Rt=Pe.event)==null?void 0:Rt.venue_name)||"Unknown Venue",artist_name:(hr=Pe.event)==null?void 0:hr.artist_name,venue_name:(or=Pe.event)==null?void 0:or.venue_name,event_date:Ge?Ge.toISOString().split("T")[0]:((Gt=Pe.event)==null?void 0:Gt.event_date)||Pe.review.created_at,event_time:((xr=Pe.event)==null?void 0:xr.event_time)||((Xt=Pe.event)==null?void 0:Xt.doors_time)||"TBD",_fullEvent:Pe.event||null}}});console.log(" ProfileView: Transformed reviews:",ot),console.log(" ProfileView: Number of transformed reviews:",ot.length);const vt=ot.filter(Pe=>Pe.setlist);console.log(" ProfileView: Reviews with setlist:",vt.length,vt);const ut=ot.filter(Pe=>!(Pe.review_text==="ATTENDANCE_ONLY"&&!Pe.was_there));console.log(" ProfileView: Reviews for PostsGrid:",ut.length),console.log(" ProfileView: Reviews for PostsGrid (first 3):",ut.slice(0,3).map(Pe=>{var Ge;return{id:Pe.id,event_name:(Ge=Pe.event)==null?void 0:Ge.event_name,review_text:Pe.review_text,was_there:Pe.was_there}})),P(ot)}catch(Re){console.error(" ProfileView: Error fetching reviews:",Re),P([])}}),Qe=()=>E(void 0,null,function*(){try{console.log(" ProfileView: Fetching reviews count for user:",gt);let fe=T.from("reviews").select("id, was_there, review_text, is_public",{count:"exact"}).eq("user_id",gt).eq("is_draft",!1);St||(fe=fe.eq("is_public",!0));const{data:Re,count:ot,error:vt}=yield fe;if(vt){console.error(" ProfileView: Error fetching reviews count:",vt),R(0);return}const Pe=(Re||[]).filter(Ge=>!!(Ge.was_there===!0||Ge.review_text&&Ge.review_text!=="ATTENDANCE_ONLY")).length;console.log(" ProfileView: Reviews count (raw):",ot),console.log(" ProfileView: Reviews count (filtered):",Pe),R(Pe)}catch(fe){console.error(" ProfileView: Error fetching reviews count:",fe),R(0)}}),jt=fe=>{if(typeof fe.rating=="number")return fe.rating;if(typeof fe.rating=="string"){const Re=parseFloat(fe.rating);return isNaN(Re)?null:Re}return fe.rating===null||fe.rating===void 0?null:fe.rating==="good"?5:fe.rating==="okay"?3:fe.rating==="bad"?1:null},ir=fe=>{const Re=jt(fe);return parseFloat(Re.toFixed(1))},rr=()=>E(void 0,null,function*(){try{if(ct||!ze){console.log("Session expired or no user, skipping friends fetch");return}const fe=yield Au.getFriends(gt);D(fe)}catch(fe){console.warn("Warning: Error fetching friends:",fe),D([])}}),Ie=()=>E(void 0,null,function*(){try{if(ct||!ze){console.log("Session expired or no user, skipping followed artists count fetch");return}console.log(" ProfileView: Fetching artist follows count for user:",gt),console.log(" ProfileView: Current authenticated user:",ze==null?void 0:ze.id);const fe=yield fge.getArtistFollowsCount(gt);console.log(" ProfileView: Artist follows count:",fe);const Re=yield Si.getUserFollowedArtists(gt);console.log(" ProfileView: Followed artists array length:",Re.length),console.log(" ProfileView: Artist names:",Re.map(vt=>vt.artist_name));const ot=fe!==Re.length?Re.length:fe;fe!==Re.length&&console.warn(` ProfileView: Count mismatch! Service count: ${fe}, Array length: ${Re.length}. Using array length.`),Ne(ot),console.log(" ProfileView: Final artist follows count set to:",ot)}catch(fe){console.error("Error fetching followed artists count:",fe),Ne(0)}}),At=()=>E(void 0,null,function*(){try{if(ct||!ze){console.log("Session expired or no user, skipping attended events fetch");return}console.log(" ProfileView: Fetching attended events for user:",gt),Y(!0);const{data:fe,error:Re}=yield T.from("reviews").select(`
          id, 
          event_id, 
          rating, 
          review_text, 
          was_there, 
          is_public, 
          created_at, 
          updated_at
        `).eq("user_id",gt).eq("is_draft",!1).order("created_at",{ascending:!1});if(Re){console.error("Error fetching attended events:",Re),K([]);return}if(!fe||fe.length===0){K([]);return}const ot=fe.map(Pt=>Pt.event_id).filter(Boolean),vt=new Map;if(ot.length>0){const{data:Pt}=yield T.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date, venue_city, venue_state, setlist").in("id",ot);Pt&&Pt.forEach(yr=>{vt.set(yr.id,yr)})}const ut=fe.map(Pt=>H(M({},Pt),{events:vt.get(Pt.event_id)}));console.log(" ProfileView: Attended events data (raw):",ut),console.log(" ProfileView: Total attended events fetched (raw):",ut==null?void 0:ut.length);const Pe=(ut||[]).filter(Pt=>!!(Pt.was_there===!0||Pt.review_text&&Pt.review_text!=="ATTENDANCE_ONLY"));console.log(" ProfileView: Attended events data (filtered):",Pe),console.log(" ProfileView: Total attended events fetched (filtered):",Pe==null?void 0:Pe.length);const Ge=(Pe==null?void 0:Pe.filter(Pt=>Pt.review_text&&Pt.review_text!=="ATTENDANCE_ONLY").length)||0,Ee=(Pe==null?void 0:Pe.filter(Pt=>Pt.review_text==="ATTENDANCE_ONLY").length)||0,ft=(Pe==null?void 0:Pe.filter(Pt=>!Pt.review_text).length)||0;if(console.log(" Event breakdown:"),console.log(`   With reviews: ${Ge}`),console.log(`   Attendance only: ${Ee}`),console.log(`   No review: ${ft}`),console.log(`   Total: ${Pe==null?void 0:Pe.length}`),Pe&&Pe.length>0){const Pt=Pe.map(yr=>H(M({},yr),{jambase_events:yr.events||null}));K(Pt)}else K([])}catch(fe){console.error("Error fetching attended events:",fe),K([])}finally{Y(!1)}}),yt=()=>E(void 0,null,function*(){var fe,Re,ot,vt,ut,Pe,Ge;try{if(ct||!ze){console.log("Session expired or no user, skipping draft reviews fetch");return}if(console.log(" ProfileView: Fetching draft reviews for user:",gt),re(!0),!St){X([]);return}const{data:Ee,error:ft}=yield T.from("reviews").select("id, event_id, is_draft, draft_data, last_saved_at").eq("user_id",gt).eq("is_draft",!0);ft&&console.error(" ProfileView: Error fetching drafts directly:",ft),console.log(" ProfileView: All drafts from database (direct query):",(Ee==null?void 0:Ee.length)||0);const Pt=yield Gf.getUserDrafts(gt);console.log(" ProfileView: Drafts from RPC function:",(Pt==null?void 0:Pt.length)||0);const{data:yr}=yield T.from("reviews").select(`
          event_id,
          event:events!inner(
            id,
            artist_id,
            venue_id,
            event_date
          )
        `).eq("user_id",gt).eq("is_draft",!1).not("review_text","is",null).neq("review_text","ATTENDANCE_ONLY"),un=new Set((yr||[]).map(Xt=>Xt.event_id).filter(Boolean)),hn=Array.from(un);let xn=new Map;if(hn.length>0){const{data:Xt}=yield T.from("events_with_artist_venue").select("id, artist_name_normalized, venue_name_normalized").in("id",hn);Xt&&Xt.forEach(jr=>{xn.set(jr.id,{artist_name:jr.artist_name_normalized||"",venue_name:jr.venue_name_normalized||""})})}const Rt=new Map;(yr||[]).forEach(Xt=>{if(Xt.event){const jr=xn.get(Xt.event.id),en=(jr==null?void 0:jr.artist_name)||"",Hn=(jr==null?void 0:jr.venue_name)||"",Tt=`${en.toLowerCase().trim()}|${Hn.toLowerCase().trim()}|${Xt.event.event_date}`;Rt.set(Tt,Xt)}}),console.log(" ProfileView: Published review event IDs:",Array.from(un)),console.log(" ProfileView: Published reviews by concert:",Rt.size);const hr=Xt=>{if(!Xt)return null;try{return new Date(Xt).toISOString().split("T")[0]}catch(jr){return Xt}},or=[],Gt=[];for(const Xt of Pt||[]){if(!Xt.event_id){console.log(" ProfileView: Draft has no event_id:",Xt.id);continue}let jr=!1,en="";if(un.has(Xt.event_id))jr=!0,en=`published review exists for event ${Xt.event_id}`;else{const Tt=Xt.artist_name||((Re=(fe=Xt.draft_data)==null?void 0:fe.selectedArtist)==null?void 0:Re.name),kr=Xt.venue_name||((vt=(ot=Xt.draft_data)==null?void 0:ot.selectedVenue)==null?void 0:vt.name),ds=Xt.event_date||((ut=Xt.draft_data)==null?void 0:ut.eventDate);if(Tt&&kr&&ds){const Oa=hr(ds),Dn=Tt.toLowerCase().trim(),Hr=kr.toLowerCase().trim();for(const[Br]of Rt.entries()){const[En,$r,Qn]=Br.split("|"),la=hr(Qn);if(En===Dn&&$r===Hr&&la===Oa){jr=!0,en=`published review exists for same concert (${Tt} at ${kr})`;break}}}}jr?(or.push(Xt.id),console.log(` ProfileView: Marked draft ${Xt.id} for deletion - ${en}`)):Gt.push(Xt)}if(or.length>0){console.log(` ProfileView: Deleting ${or.length} orphaned draft(s)...`);const Xt=or.map(Tt=>E(void 0,null,function*(){try{const{error:kr}=yield T.from("reviews").delete().eq("id",Tt);return kr?(console.error(` ProfileView: Failed to delete orphaned draft ${Tt}:`,kr),{success:!1,draftId:Tt,error:kr}):(console.log(` ProfileView: Successfully deleted orphaned draft ${Tt}`),{success:!0,draftId:Tt})}catch(kr){return console.error(` ProfileView: Exception deleting orphaned draft ${Tt}:`,kr),{success:!1,draftId:Tt,error:kr}}})),jr=yield Promise.all(Xt),en=jr.filter(Tt=>Tt.success).length,Hn=jr.filter(Tt=>!Tt.success);if(Hn.length>0){console.error(` ProfileView: Failed to delete ${Hn.length} draft(s):`,Hn);const Tt=new Set(Hn.map(ds=>ds.draftId)),kr=(Pt||[]).filter(ds=>Tt.has(ds.id));Gt.push(...kr)}console.log(` ProfileView: Deletion complete - ${en} successful, ${Hn.length} failed`)}const xr=Gt;if(Ee)for(const Xt of Ee){let jr=!1;if(Xt.event_id&&un.has(Xt.event_id)&&(console.log(` ProfileView: Found orphaned draft ${Xt.id} in database (same event_id) - deleting`),jr=!0),!jr&&Xt.draft_data){const en=Xt.draft_data,Hn=(Pe=en==null?void 0:en.selectedArtist)==null?void 0:Pe.name,Tt=(Ge=en==null?void 0:en.selectedVenue)==null?void 0:Ge.name,kr=en==null?void 0:en.eventDate;if(Hn&&Tt&&kr){const ds=Dn=>{if(!Dn)return null;try{return new Date(Dn).toISOString().split("T")[0]}catch(Hr){return Dn}},Oa=ds(kr);for(const[Dn]of Rt.entries()){const[Hr,Br,En]=Dn.split("|"),$r=ds(En);if(Hr===Hn&&Br===Tt&&$r===Oa){console.log(` ProfileView: Found orphaned draft ${Xt.id} in database (same concert) - deleting`),jr=!0;break}}}}jr&&(yield T.from("reviews").delete().eq("id",Xt.id))}console.log(" ProfileView: Draft reviews data (final):",xr),console.log(" ProfileView: Total valid draft reviews (after filtering):",xr==null?void 0:xr.length),X(xr)}catch(Ee){console.error("Error fetching draft reviews:",Ee),X([])}finally{re(!1)}}),pe=()=>E(void 0,null,function*(){try{if(ct||!ze||!St)return;const fe=yield Io.getPassportProgress(gt);ve({cities:fe.cities.length,venues:fe.venues.length,artists:fe.artists.length,scenes:fe.scenes.length})}catch(fe){console.error("Error loading passport summary:",fe)}}),De=()=>E(void 0,null,function*(){try{if(ct||!ze||St)return;const{data:fe,error:Re}=yield T.from("user_relationships").select("id, status").eq("relationship_type","friend").or(`and(user_id.eq.${e},related_user_id.eq.${gt}),and(user_id.eq.${gt},related_user_id.eq.${e})`).in("status",["accepted"]).limit(1);if(Re){console.warn("Warning: Could not check friendship status:",Re);return}if(fe&&fe.length>0){_t("friends");return}const{data:ot,error:vt}=yield T.from("user_relationships").select("id").eq("user_id",e).eq("related_user_id",gt).eq("relationship_type","friend").eq("status","pending").limit(1);if(vt){console.warn("Warning: Could not check sent friend requests:",vt);return}if(ot&&ot.length>0){_t("pending_sent"),Oe(ot[0].id);return}const{data:ut,error:Pe}=yield T.from("user_relationships").select("id").eq("user_id",gt).eq("related_user_id",e).eq("relationship_type","friend").eq("status","pending").limit(1);if(Pe){console.warn("Warning: Could not check received friend requests:",Pe);return}if(ut&&ut.length>0){_t("pending_received");return}_t("none")}catch(fe){console.warn("Warning: Error checking friend status:",fe),_t("none")}}),Le=()=>E(void 0,null,function*(){try{if(ct||!ze||St)return;console.log("Sending friend request to:",gt);const{data:fe,error:Re}=yield T.rpc("create_friend_request",{receiver_user_id:gt});if(Re)throw console.error("Error creating friend request:",Re),Re;let ot=null;fe?ot=fe:ot=yield Au.getPendingRequestId(e,gt),Oe(ot),_t("pending_sent"),Me({title:"Friend Request Sent! ",description:"Your friend request has been sent and they'll be notified."})}catch(fe){console.error("Error sending friend request:",fe),Me({title:"Error",description:fe.message||"Failed to send friend request. Please try again.",variant:"destructive"})}}),bt=fe=>E(void 0,null,function*(){var Re;try{if(ct||!ze)return;console.log("Unfriending user:",fe),yield Au.unfriendUser(fe),D(ot=>ot.filter(vt=>vt.user_id!==fe)),gt===fe&&_t("none"),yield rr(),Me({title:"Friend Removed",description:"You are no longer friends with this person."})}catch(ot){if(console.error("Error unfriending user:",ot),(Re=ot==null?void 0:ot.message)!=null&&Re.includes("Friendship does not exist")){D(vt=>vt.filter(ut=>ut.user_id!==fe)),gt===fe&&_t("none"),yield rr();return}throw Me({title:"Error",description:ot.message||"Failed to unfriend user. Please try again.",variant:"destructive"}),ot}}),it=fe=>E(void 0,null,function*(){if(S(!1),O(null),fe!=null&&fe.event_id)try{console.log(" ProfileView: NUCLEAR deletion of drafts for event:",fe.event_id);const{error:Re}=yield T.from("reviews").delete().eq("user_id",e).eq("event_id",fe.event_id).eq("is_draft",!0);Re?console.error(" ProfileView: Failed to delete drafts:",Re):console.log(" ProfileView: Deleted all drafts for event:",fe.event_id)}catch(Re){console.error(" ProfileView: Exception deleting drafts:",Re)}yield new Promise(Re=>setTimeout(Re,1e3)),yield Promise.all([lt(),At(),yt()]),Me({title:"Review Added",description:"Your concert review has been added!"})}),zt=fe=>{var Re,ot,vt,ut,Pe,Ge,Ee,ft;O({id:fe.event_id,title:((Re=fe.event)==null?void 0:Re.event_name)||"Concert Review",venue_name:((ot=fe.event)==null?void 0:ot.venue_name)||((vt=fe.event)==null?void 0:vt.location)||"Unknown Venue",event_date:fe.Event_date||fe.event_date||((ut=fe.event)==null?void 0:ut.event_date)||fe.created_at,artist_name:((Pe=fe.event)==null?void 0:Pe.artist_name)||"Unknown Artist",existing_review_id:fe.id,existing_review:{rating:fe.rating,review_text:fe.review_text,artist_performance_rating:fe.artist_performance_rating,production_rating:fe.production_rating,venue_rating:fe.venue_rating,location_rating:fe.location_rating,value_rating:fe.value_rating,artist_performance_feedback:fe.artist_performance_feedback,production_feedback:fe.production_feedback,venue_feedback:fe.venue_feedback,location_feedback:fe.location_feedback,value_feedback:fe.value_feedback,ticket_price_paid:fe.ticket_price_paid,reaction_emoji:fe.reaction_emoji,is_public:fe.is_public,review_type:fe.review_type,event_date:fe.Event_date||fe.event_date||((Ge=fe.event)==null?void 0:Ge.event_date)||fe.created_at,artist_name:(Ee=fe.event)==null?void 0:Ee.artist_name,venue_name:(ft=fe.event)==null?void 0:ft.venue_name,venue_id:fe.venue_id}}),S(!0)},Bt=fe=>E(void 0,null,function*(){try{console.log(" ProfileView: Deleting review:",{userId:e,reviewId:fe}),yield bs.deleteEventReview(e,fe),console.log(" ProfileView: Review deleted successfully"),lt(),Me({title:"Review Deleted",description:"Your review has been deleted."})}catch(Re){console.error(" ProfileView: Error deleting review:",Re),Me({title:"Error",description:`Failed to delete review: ${Re instanceof Error?Re.message:"Unknown error"}`,variant:"destructive"})}});return y||!h?s.jsx(w1,{text:"Loading profile..."}):h?(console.log(" ProfileView: Rendering profile for:",h.name),s.jsxs("div",{className:"min-h-screen w-full max-w-[393px] mx-auto overflow-x-hidden",style:{backgroundColor:"var(--neutral-50)"},children:[!f&&s.jsx(Yo,{menuOpen:d,onMenuClick:u,children:s.jsx("h1",{className:"font-bold truncate text-center",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:h.username?`@${h.username}`:h.name})}),s.jsxs("div",{className:"w-full max-w-full overflow-x-hidden",style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:f?"calc(env(safe-area-inset-top, 0px) + var(--spacing-small, 12px))":"calc(env(safe-area-inset-top, 0px) + 68px + var(--spacing-small, 12px))",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[s.jsxs("div",{className:"mb-6 relative w-full max-w-full",style:{padding:"var(--spacing-grouped, 24px) 0",border:"none"},children:[s.jsxs("div",{className:"flex flex-col items-center gap-4 mb-4 w-full max-w-full",children:[s.jsx("div",{className:"w-full flex justify-center",children:s.jsxs("div",{className:"relative",style:{display:"flex",alignItems:"flex-start",gap:"6px"},children:[s.jsxs("div",{className:"relative",children:[s.jsx(oc,{variant:"userProfile",name:h.name,username:h.username||void 0,initial:h.name.charAt(0).toUpperCase(),imageUrl:h.avatar_url,followers:z.length,following:qe,events:A,onFollowersClick:()=>{at("friends"),We(!0)},onFollowingClick:()=>Ye(!0)}),!St&&h.last_active_at&&s.jsx("div",{className:"absolute bottom-0 left-0 w-6 h-6 rounded-full border-2",style:{backgroundColor:"var(--status-success-500)",borderColor:"var(--neutral-50)"},children:s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:"var(--neutral-50)"}})})})]}),h.verified&&h.account_type&&s.jsx("div",{style:{marginTop:"2px"},children:s.jsx(mT,{accountType:h.account_type,verified:h.verified,size:"lg"})})]})}),!St&&h.last_active_at&&s.jsx("div",{className:"w-full flex justify-center",children:s.jsxs(Ke,{variant:"secondary",className:"flex items-center gap-1 bg-green-100 text-green-700 border-green-200",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[s.jsx(ga,{size:16}),Yf.formatLastActive(h.last_active_at)]})}),s.jsx("div",{className:"w-full max-w-full",children:s.jsx("div",{className:"flex flex-wrap items-center gap-2 w-full max-w-full",children:St?s.jsxs(s.Fragment,{children:[s.jsxs(le,{onClick:n,variant:"default",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",boxShadow:"0 4px 4px 0 var(--shadow-color)",border:"none"},onMouseEnter:fe=>{fe.currentTarget.style.backgroundColor="var(--brand-pink-600)"},onMouseLeave:fe=>{fe.currentTarget.style.backgroundColor="var(--brand-pink-500)"},children:[s.jsx(_c,{size:16,style:{marginRight:"var(--spacing-inline, 6px)",color:"var(--neutral-50)"}}),s.jsx("span",{style:{color:"var(--neutral-50)"},children:"Edit Profile"})]}),s.jsx(le,{onClick:a,variant:"secondary",size:"icon",style:{width:"44px",height:"44px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"var(--neutral-50)",border:"2px solid var(--neutral-200)",color:"var(--neutral-900)"},"aria-label":"Profile settings",children:s.jsx(jP,{size:24,style:{color:"var(--neutral-900)"}})})]}):s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[Ft==="none"&&s.jsxs(le,{onClick:Le,variant:"default",size:"sm",className:"shadow-md",style:{backgroundColor:"var(--status-success-500)",color:"var(--neutral-50)"},onMouseEnter:fe=>{fe.currentTarget.style.opacity="0.9"},onMouseLeave:fe=>{fe.currentTarget.style.opacity="1"},"aria-label":"Send friend request",children:[s.jsx(Vo,{size:16,className:"mr-2"}),"Add Friend"]}),Ft==="pending_sent"&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(le,{disabled:!0,variant:"outline",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderColor:"var(--neutral-200)",color:"var(--neutral-600)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:"Friend Request Sent"}),s.jsx(le,{onClick:()=>E(void 0,null,function*(){if(!Lt){Me({title:"Cannot Cancel",description:"Request ID not available. Please refresh the page.",variant:"destructive"});return}try{yield Au.cancelFriendRequest(Lt),_t("none"),Oe(null),Me({title:"Request Cancelled",description:"Friend request has been cancelled."})}catch(fe){Me({title:"Error",description:fe.message||"Failed to cancel request.",variant:"destructive"})}}),disabled:!Lt,variant:"outline",size:"sm",className:"disabled:opacity-50 disabled:cursor-not-allowed",style:{borderColor:"var(--neutral-200)",color:"var(--neutral-600)"},title:Lt?"Cancel friend request":"Request ID not available",children:"Cancel"})]}),Ft==="pending_received"&&s.jsx(le,{disabled:!0,variant:"outline",size:"sm",style:{borderColor:"var(--info-blue-500)",color:"var(--info-blue-500)",backgroundColor:"var(--state-disabled-bg)",cursor:"not-allowed"},"aria-label":"Friend request already sent","aria-disabled":"true",children:"Respond to Request"}),Ft==="friends"&&s.jsx(le,{onClick:()=>bt(gt),variant:"outline",size:"sm",className:"border",style:{color:"var(--status-error-500)",borderColor:"var(--status-error-500)"},onMouseEnter:fe=>{fe.currentTarget.style.backgroundColor="var(--status-error-050)",fe.currentTarget.style.color="var(--status-error-500)"},onMouseLeave:fe=>{fe.currentTarget.style.backgroundColor="transparent",fe.currentTarget.style.color="var(--status-error-500)"},"aria-label":"Unfriend user",children:"Unfriend"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(le,{variant:"ghost",size:"sm",onClick:()=>Ae(!0),className:"p-2",style:{color:"var(--neutral-600)"},onMouseEnter:fe=>{fe.currentTarget.style.color="var(--status-error-500)",fe.currentTarget.style.backgroundColor="var(--status-error-050)"},onMouseLeave:fe=>{fe.currentTarget.style.color="var(--neutral-600)",fe.currentTarget.style.backgroundColor="transparent"},"aria-label":"Block user",children:s.jsx(F_,{size:16})}),s.jsx(le,{variant:"ghost",size:"sm",onClick:()=>oe(!0),className:"p-2",style:{color:"var(--neutral-600)"},onMouseEnter:fe=>{fe.currentTarget.style.color="var(--status-error-500)",fe.currentTarget.style.backgroundColor="var(--status-error-050)"},onMouseLeave:fe=>{fe.currentTarget.style.color="var(--neutral-600)",fe.currentTarget.style.backgroundColor="transparent"},"aria-label":"Block user",children:s.jsx(Qi,{size:16})})]})]})})})]}),s.jsxs("div",{style:{paddingTop:"var(--spacing-grouped, 24px)"},children:[h.bio&&s.jsx("div",{className:"mb-4",children:s.jsx("p",{className:"leading-relaxed",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:h.bio})}),s.jsxs("div",{className:"flex flex-wrap gap-3",children:[h.instagram_handle&&s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>window.open(`https://instagram.com/${h.instagram_handle}`,"_blank"),style:{borderColor:"var(--neutral-200)",color:"var(--neutral-900)"},children:[s.jsx(xP,{size:16,className:"mr-2"}),"@",h.instagram_handle]}),!St&&h.music_streaming_profile&&(()=>{const fe=sV(h.music_streaming_profile),Re=fe==="spotify",ot=fe==="apple-music";let vt=h.music_streaming_profile,ut=h.music_streaming_profile;return Re?(vt=h.music_streaming_profile.startsWith("http")?h.music_streaming_profile:`https://open.spotify.com/user/${h.music_streaming_profile}`,ut="Spotify Profile"):ot&&(vt=(h.music_streaming_profile.startsWith("http"),h.music_streaming_profile),ut="Apple Music Profile"),s.jsxs(le,{variant:"outline",onClick:()=>window.open(vt,"_blank"),style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[s.jsx($t,{size:16,style:{marginRight:"var(--spacing-inline, 6px)"}}),ut]})})()]}),s.jsx("div",{"aria-hidden":"true",style:{height:"1px",backgroundColor:"var(--neutral-200)",width:"100%",marginTop:"var(--spacing-grouped, 24px)"}})]})]}),St&&!ne&&Array.isArray(Q)&&Q.length>0&&s.jsx("div",{className:"mb-6",children:s.jsx(pge,{draftCount:Q.length,onClick:()=>G("unreviewed")})}),s.jsxs(Li,{value:B,onValueChange:F,className:"w-full",children:[s.jsxs(yi,{className:`glass-card inner-glow grid w-full max-w-full mb-4 p-1 floating-shadow overflow-x-hidden ${ye?"grid-cols-3":"grid-cols-2"}`,children:[s.jsxs(Xr,{value:"my-events",className:"flex items-center gap-2",children:[s.jsx(It,{className:"w-4 h-4"}),"Events"]}),ye&&s.jsxs(Xr,{value:"interested",className:"flex items-center gap-2",children:[s.jsx(ns,{size:16}),"Interested"]}),s.jsxs(Xr,{value:"passport",className:"flex items-center gap-2",children:[s.jsx(Ol,{size:16}),"Passport"]})]}),s.jsxs(Jr,{value:"my-events",className:"mt-4 mb-32 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"flex flex-col gap-3 mb-4 p-2 w-full max-w-full",children:[s.jsx("h3",{className:"gradient-text font-semibold",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)"},children:St?"My Events":`${(h==null?void 0:h.name)||"User"}'s Events`}),St&&s.jsxs("div",{className:"flex flex-col gap-2 w-full max-w-full",children:[s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:"View mode:"}),s.jsxs("div",{className:"flex w-full max-w-full overflow-x-auto",style:{padding:"var(--spacing-inline, 6px)",gap:"var(--spacing-inline, 6px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-100)",border:"1px solid var(--neutral-200)"},children:[s.jsx("button",{onClick:()=>G(!1),className:"transition-colors",style:{paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",height:"var(--size-button-height, 36px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",backgroundColor:U?"transparent":"var(--neutral-50)",color:U?"var(--neutral-600)":"var(--neutral-900)"},children:"Reviews"}),s.jsx("button",{onClick:()=>G(!0),className:"transition-colors",style:{paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",height:"var(--size-button-height, 36px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",backgroundColor:U?"var(--neutral-50)":"transparent",color:U?"var(--neutral-900)":"var(--neutral-600)"},children:"Rankings"}),s.jsx("button",{onClick:()=>G("unreviewed"),className:"transition-colors",style:{paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",height:"var(--size-button-height, 36px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",backgroundColor:U==="unreviewed"?"var(--neutral-50)":"transparent",color:U==="unreviewed"?"var(--neutral-900)":"var(--neutral-600)"},children:"Unreviewed"})]})]})]}),U===!1&&s.jsx(yge,{reviews:k,onSelectReview:fe=>{ae(fe),ue(!0)}}),U===!0&&St&&s.jsx("div",{className:"space-y-6",children:Array.from(new Set(k.filter(Re=>Re.review_text!=="ATTENDANCE_ONLY").map(Re=>{const ot=ir(Re);return Math.round(ot*10)/10}))).sort((Re,ot)=>ot-Re).map(Re=>{const ot=k.filter(vt=>{if(vt.review_text==="ATTENDANCE_ONLY")return!1;const ut=ir(vt),Pe=Math.round(ut*10)/10;return Math.abs(Pe-Re)<.01});return ot.length===0?null:s.jsxs("div",{children:[s.jsxs("div",{className:"font-semibold mb-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[Re.toFixed(1),""]}),s.jsx("div",{className:"divide-y",style:{backgroundColor:"var(--neutral-50)",border:"1px solid var(--neutral-200)",borderRadius:"var(--radius-corner, 10px)",padding:"var(--spacing-small, 12px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"},children:ot.sort((vt,ut)=>{var Ee,ft;const Pe=(Ee=vt.rank_order)!=null?Ee:9999,Ge=(ft=ut.rank_order)!=null?ft:9999;return Pe!==Ge?Pe-Ge:new Date(ut.created_at).getTime()-new Date(vt.created_at).getTime()}).map((vt,ut)=>s.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{borderBottom:ut<ot.length-1?"1px solid var(--neutral-200)":"none"},onClick:()=>{ae(vt),ue(!0)},onMouseEnter:Pe=>{Pe.currentTarget.style.backgroundColor="var(--neutral-100)"},onMouseLeave:Pe=>{Pe.currentTarget.style.backgroundColor="transparent"},children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-6 w-6 rounded-full flex items-center justify-center border",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",backgroundColor:"var(--neutral-50)"},children:ut+1}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:vt.event.event_name}),s.jsx("div",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:(()=>{const Pe=vt.Event_date||(vt.event_date instanceof Date?vt.event_date:vt.event_date?new Date(vt.event_date):null)||(vt.event.event_date?new Date(vt.event.event_date):null);return Pe?Pe.toLocaleDateString():""})()})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[ut>0&&s.jsx(le,{size:"icon",variant:"ghost",onClick:Pe=>{Pe.stopPropagation();const Ge=ot.slice().sort((ft,Pt)=>(ft.rank_order||9999)-(Pt.rank_order||9999)),Ee=Ge.findIndex(ft=>ft.id===vt.id);if(Ee>0){const[ft]=Ge.splice(Ee,1);Ge.splice(Ee-1,0,ft),E(void 0,null,function*(){yield bs.setRankOrderForRatingGroup(e,Re,Ge.map(Pt=>Pt.id)),lt()})}},children:""}),ut<ot.length-1&&s.jsx(le,{size:"icon",variant:"ghost",onClick:Pe=>{Pe.stopPropagation();const Ge=ot.slice().sort((ft,Pt)=>(ft.rank_order||9999)-(Pt.rank_order||9999)),Ee=Ge.findIndex(ft=>ft.id===vt.id);if(Ee!==-1&&Ee<Ge.length-1){const[ft]=Ge.splice(Ee,1);Ge.splice(Ee+1,0,ft),E(void 0,null,function*(){yield bs.setRankOrderForRatingGroup(e,Re,Ge.map(Pt=>Pt.id)),lt()})}},children:""})]})]},vt.id))})]},Re)})}),U==="unreviewed"&&St&&s.jsx("div",{className:"space-y-4",children:Z||ne?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-3"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:"Loading unreviewed events and drafts..."})]}):(()=>{const fe=q.filter(ut=>ut.review_text==="ATTENDANCE_ONLY"),Re=new Set(k.filter(ut=>{const Pe=ut.is_draft===!0,Ge=ut.review_text==="ATTENDANCE_ONLY",Ee=ut.review_text&&ut.review_text.trim().length>0;return!Pe&&Ee&&!Ge}).map(ut=>ut.event_id).filter(Boolean)),ot=Q.filter(ut=>{const Pe=ut.event_id;return Pe?!Re.has(Pe):!1}),vt=[...fe.map(ut=>({type:"unreviewed",data:ut})),...ot.map(ut=>({type:"draft",data:ut}))];return vt.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(It,{className:"w-16 h-16 mx-auto mb-4",style:{color:"var(--neutral-200)"},"aria-hidden":"true"}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",marginBottom:"var(--spacing-small, 12px)"},children:"All Caught Up!"}),s.jsx("p",{className:"mb-4",style:{color:"var(--neutral-600)"},children:"You've reviewed all the events you've attended and have no draft reviews. Great job!"})]}):s.jsx("div",{className:"space-y-4",children:vt.map(ut=>{if(ut.type==="unreviewed"){const Pe=ut.data,Ge=Pe.jambase_events;return s.jsx(He,{className:"overflow-hidden cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{const Ee=Ge.jambase_event||Ge,ft=H(M({},Ee),{id:Ee.id||Ge.id||Pe.event_id,title:Ee.title||Ge.title||"Unknown Event",artist_name:Ee.artist_name||Ge.artist_name||"Unknown Artist",venue_name:Ee.venue_name||Ge.venue_name||"Unknown Venue",event_date:Ee.event_date||Ge.event_date||new Date().toISOString(),venue_city:Ee.venue_city||Ge.venue_city||null,venue_state:Ee.venue_state||Ge.venue_state||null,setlist:Ee.setlist||Ge.setlist||null,setlist_song_count:Ee.setlist_song_count||Ge.setlist_song_count||null,setlist_fm_url:Ee.setlist_fm_url||Ge.setlist_fm_url||null});console.log("ProfileView: Complete event data for modal:",{originalEvent:Ge,completeEvent:ft,attendanceEventId:Pe.event_id}),xe(ft),se(!0)},children:s.jsxs(et,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-lg font-semibold mb-2",style:{color:"var(--neutral-900)"},children:Ge.title}),s.jsxs("div",{className:"flex items-center gap-4 text-sm mb-3",style:{color:"var(--neutral-600)"},children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx($t,{className:"w-4 h-4"}),s.jsx("span",{children:Ge.artist_name})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(gr,{className:"w-4 h-4"}),s.jsx("span",{children:Ge.venue_name}),Ge.venue_city&&s.jsxs("span",{style:{color:"var(--neutral-400)"},children:[" ",Ge.venue_city,", ",Ge.venue_state]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(It,{className:"w-4 h-4"}),s.jsx("span",{children:new Date(Ge.event_date).toLocaleDateString()})]})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(Ke,{variant:"outline",className:"text-orange-600 border-orange-300",children:[s.jsx(It,{className:"w-3 h-3 mr-1"}),"Needs Review"]})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs",style:{color:"var(--neutral-600)"},children:["Attended on ",new Date(Pe.created_at).toLocaleDateString()]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(le,{size:"sm",variant:"outline",onClick:Ee=>{Ee.stopPropagation();const ft=Ge.jambase_event||Ge,Pt=H(M({},ft),{id:ft.id||Ge.id||Pe.event_id,title:ft.title||Ge.title||"Unknown Event",artist_name:ft.artist_name||Ge.artist_name||"Unknown Artist",venue_name:ft.venue_name||Ge.venue_name||"Unknown Venue",event_date:ft.event_date||Ge.event_date||new Date().toISOString(),venue_city:ft.venue_city||Ge.venue_city||null,venue_state:ft.venue_state||Ge.venue_state||null,setlist:ft.setlist||Ge.setlist||null,setlist_song_count:ft.setlist_song_count||Ge.setlist_song_count||null,setlist_fm_url:ft.setlist_fm_url||Ge.setlist_fm_url||null});xe(Pt),se(!0)},children:[s.jsx(Bo,{className:"w-4 h-4 mr-2"}),"View Event"]}),s.jsxs(le,{size:"sm",onClick:Ee=>{Ee.stopPropagation(),O(Ge),S(!0)},className:"bg-primary hover:bg-primary/90",children:[s.jsx(Qt,{className:"w-4 h-4 mr-2"}),"Add Review"]})]})]})]})},`unreviewed-${Pe.id}`)}else if(ut.type==="draft"){const Pe=ut.data;return s.jsx(He,{className:"overflow-hidden cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{const Ge={id:Pe.event_id,title:Pe.event_title||"Draft Review",artist_name:Pe.artist_name||"Unknown Artist",venue_name:Pe.venue_name||"Unknown Venue",event_date:Pe.event_date||new Date().toISOString(),venue_city:null,venue_state:null,setlist:null,setlist_song_count:null,setlist_fm_url:null};O(Ge),S(!0)},children:s.jsxs(et,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-lg font-semibold mb-2",style:{color:"var(--neutral-900)"},children:Pe.event_title||"Draft Review"}),s.jsxs("div",{className:"flex items-center gap-4 text-sm mb-3",style:{color:"var(--neutral-600)"},children:[Pe.artist_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx($t,{className:"w-4 h-4"}),s.jsx("span",{children:Pe.artist_name})]}),Pe.venue_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(gr,{className:"w-4 h-4"}),s.jsx("span",{children:Pe.venue_name})]}),Pe.event_date&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(It,{className:"w-4 h-4"}),s.jsx("span",{children:new Date(Pe.event_date).toLocaleDateString()})]})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(Ke,{variant:"outline",style:{color:"var(--info-blue-500)",borderColor:"var(--info-blue-500)"},children:[s.jsx(_c,{className:"w-3 h-3 mr-1"}),"Draft"]})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs",style:{color:"var(--neutral-600)"},children:["Last saved: ",Pe.last_saved_at?new Date(Pe.last_saved_at).toLocaleDateString():"Unknown"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(le,{size:"sm",onClick:Ge=>{Ge.stopPropagation();const Ee={id:Pe.event_id,title:Pe.event_title||"Draft Review",artist_name:Pe.artist_name||"Unknown Artist",venue_name:Pe.venue_name||"Unknown Venue",event_date:Pe.event_date||new Date().toISOString(),venue_city:null,venue_state:null,setlist:null,setlist_song_count:null,setlist_fm_url:null};O(Ee),S(!0)},className:"",style:{backgroundColor:"var(--info-blue-500)",color:"var(--neutral-50)"},onMouseEnter:Ge=>{Ge.currentTarget.style.backgroundColor="var(--info-blue-500)"},onMouseLeave:Ge=>{Ge.currentTarget.style.backgroundColor="var(--info-blue-500)"},children:[s.jsx(_c,{className:"w-4 h-4 mr-2"}),"Continue Draft"]}),s.jsx(le,{size:"sm",variant:"outline",onClick:Ge=>E(void 0,null,function*(){if(Ge.stopPropagation(),confirm("Are you sure you want to delete this draft? This action cannot be undone."))try{if(yield Gf.deleteDraft(Pe.id,e)){const ft=yield Gf.getUserDrafts(e);X(ft||[]),Me({title:"Draft Deleted",description:"The draft has been deleted successfully."})}else Me({title:"Error",description:"Failed to delete draft. Please try again.",variant:"destructive"})}catch(Ee){console.error("Error deleting draft:",Ee),Me({title:"Error",description:"Failed to delete draft. Please try again.",variant:"destructive"})}}),className:"border",style:{color:"var(--status-error-500)",borderColor:"var(--status-error-500)"},onMouseEnter:Ge=>{Ge.currentTarget.style.backgroundColor="var(--status-error-050)",Ge.currentTarget.style.color="var(--status-error-500)"},onMouseLeave:Ge=>{Ge.currentTarget.style.backgroundColor="transparent",Ge.currentTarget.style.color="var(--status-error-500)"},children:s.jsx(Dl,{className:"w-4 h-4"})})]})]})]})},`draft-${Pe.id}`)}return null})})})()})]}),ye&&s.jsxs(Jr,{value:"interested",className:"mt-4 w-full max-w-full overflow-x-hidden",children:[g.length>0&&s.jsx("div",{className:"flex justify-center mb-4 w-full max-w-full",children:s.jsxs("div",{className:"p-1 flex w-full max-w-full",style:{borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-50)"},children:[s.jsx("button",{onClick:()=>b(!1),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${w?"":"shadow-sm"}`,children:"Upcoming"}),s.jsx("button",{onClick:()=>b(!0),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${w?"shadow-sm":""}`,children:"Past"})]})}),g.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12",style:{borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-50)",gap:"var(--spacing-inline, 6px)"},children:[s.jsx(ns,{className:"w-[60px] h-[60px] mx-auto",style:{color:"var(--neutral-600)"}}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No Interested Events Yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Tap the heart on events to add them here."})]}):wt.length===0?s.jsxs("div",{className:"text-center py-12",style:{borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--neutral-100)"},children:[s.jsx(ns,{className:"w-12 h-12 mx-auto mb-3",style:{color:"var(--neutral-400)"}}),s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)"},children:w?"No Past Events":"No Upcoming Events"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:w?"You haven't marked any past events as interested.":"You don't have any upcoming events marked as interested."})]}):s.jsx("div",{className:"grid grid-cols-3 gap-1 w-full max-w-full",children:wt.sort((fe,Re)=>new Date(fe.event_date).getTime()-new Date(Re.event_date).getTime()).slice(0,9).map(fe=>s.jsx("div",{className:`aspect-square cursor-pointer rounded-md overflow-hidden border hover:shadow-md transition-shadow relative ${w?"opacity-75":""}`,style:{backgroundColor:"var(--neutral-50)"},onClick:()=>{console.log("ProfileView: Event data being passed to modal from interested events:",fe);const Re=H(M({},fe),{id:fe.id||fe.jambase_event_id,title:fe.title||"Unknown Event",artist_name:fe.artist_name||"Unknown Artist",venue_name:fe.venue_name||"Unknown Venue",event_date:fe.event_date||new Date().toISOString(),venue_city:fe.venue_city||null,venue_state:fe.venue_state||null,setlist:fe.setlist||null,setlist_song_count:fe.setlist_song_count||null,setlist_fm_url:fe.setlist_fm_url||null});console.log("ProfileView: Complete event data for modal from interested events:",{originalEvent:fe,completeEvent:Re,artist_name:Re.artist_name,venue_name:Re.venue_name,venue_city:Re.venue_city,venue_state:Re.venue_state}),xe(Re),se(!0)},children:s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"h-2/3 w-full relative overflow-hidden bg-gradient-to-br from-pink-400 to-pink-600",children:[(()=>{const Re=fe;let ot;if(Re!=null&&Re.poster_image_url)ot=Pl(Re.poster_image_url);else if(Re!=null&&Re.images&&Array.isArray(Re.images)&&Re.images.length>0){const vt=Re.images.find(ut=>(ut==null?void 0:ut.url)&&((ut==null?void 0:ut.ratio)==="16_9"||(ut==null?void 0:ut.width)&&ut.width>1e3))||Re.images.find(ut=>ut==null?void 0:ut.url);ot=vt!=null&&vt.url?Pl(vt.url):void 0}else Re!=null&&Re.media_urls&&Array.isArray(Re.media_urls)&&Re.media_urls.length>0?ot=Re.media_urls[0]:Re!=null&&Re.event_media_url&&(ot=Re.event_media_url);return ot?s.jsx("img",{src:ot,alt:fe.title,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(ns,{className:"w-1/3 h-1/3 text-white"})})})(),!w&&s.jsx("div",{className:"absolute top-1 right-1 text-[8px] px-1 py-0.5 rounded font-medium",style:{backgroundColor:"var(--neutral-50)",color:"var(--neutral-900)"},children:"Interested"}),w&&s.jsx("div",{className:"absolute top-1 right-1 text-[8px] px-1 py-0.5 rounded font-medium",style:{backgroundColor:"var(--neutral-50)",color:"var(--neutral-900)"},children:"Past"})]}),s.jsxs("div",{className:"p-2 flex-1 flex flex-col justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-xs truncate",children:fe.title}),s.jsx("p",{className:"text-xs text-muted-foreground truncate",children:fe.venue_name})]}),s.jsxs("div",{className:"text-[10px] text-muted-foreground flex items-center justify-between",children:[s.jsx("span",{children:new Date(fe.event_date).toLocaleDateString(void 0,{month:"short",day:"numeric"})}),s.jsx("span",{className:"truncate",children:[fe.venue_city,fe.venue_state].filter(Boolean).join(", ")})]})]})]})},fe.id))})]}),s.jsx(Jr,{value:"passport",className:"mt-4 mb-32 w-full max-w-full overflow-x-hidden",children:s.jsx(Sge,{isOpen:!0,onClose:()=>F("my-events"),userId:gt,userName:(h==null?void 0:h.name)||void 0,inline:!0})})]})]}),s.jsx(nV,{event:$,userId:e,isOpen:N,onClose:()=>{S(!1),O(null)},onReviewSubmitted:it}),V&&_e&&s.jsx(pn,{open:V,onOpenChange:ue,children:s.jsxs(dn,{className:"max-w-5xl w-[90vw] h-[90vh] max-h-[90vh] p-0 overflow-hidden bg-transparent border-none shadow-none",children:[s.jsxs(Vn,{className:"sr-only",children:[s.jsx(bn,{children:"Review"}),s.jsx(os,{children:"View concert review details"})]}),s.jsx("div",{className:"w-full h-full overflow-y-auto p-2",children:s.jsx(sw,{review:{id:_e.id,user_id:_e.user_id||(h==null?void 0:h.user_id)||"",event_id:_e.event_id||"",rating:_e.rating||0,review_text:_e.review_text||"",is_public:(Te=_e.is_public)!=null?Te:!0,created_at:_e.created_at,updated_at:_e.updated_at||_e.created_at,likes_count:_e.likes_count||0,comments_count:_e.comments_count||0,shares_count:_e.shares_count||0,is_liked_by_user:_e.is_liked_by_user||!1,reaction_emoji:_e.reaction_emoji||"",photos:_e.photos||[],videos:_e.videos||[],mood_tags:_e.mood_tags||[],genre_tags:_e.genre_tags||[],context_tags:_e.context_tags||[],artist_name:(dt=_e.jambase_events)==null?void 0:dt.artist_name,venue_name:(mr=_e.jambase_events)==null?void 0:mr.venue_name,artist_performance_rating:_e.artist_performance_rating,production_rating:_e.production_rating,venue_rating:_e.venue_rating,location_rating:_e.location_rating,value_rating:_e.value_rating,artist_performance_feedback:_e.artist_performance_feedback,production_feedback:_e.production_feedback,venue_feedback:_e.venue_feedback,location_feedback:_e.location_feedback,value_feedback:_e.value_feedback,ticket_price_paid:_e.ticket_price_paid,setlist:_e.setlist||((Mn=_e.jambase_events)==null?void 0:Mn.setlist),custom_setlist:_e.custom_setlist},currentUserId:e,onLike:(fe,Re)=>E(void 0,null,function*(){console.log(" ProfileView BelliStyle onLike:",{reviewId:fe,isLiked:Re})}),onComment:()=>{console.log("Comment on review from ProfileView")},onShare:()=>{console.log("Share review from ProfileView")},onEdit:()=>{ue(!1),zt(_e)},onDelete:()=>E(void 0,null,function*(){window.confirm("Are you sure you want to delete this review?")&&(yield Bt(_e.id),ue(!1),ae(null))}),userProfile:{name:(h==null?void 0:h.name)||"User",avatar_url:h==null?void 0:h.avatar_url,verified:h==null?void 0:h.verified,account_type:h==null?void 0:h.account_type}})})]})}),s.jsx(cge,{isOpen:!!ge,onClose:()=>We(!1),type:"friends",friends:Array.isArray(z)?z:[],count:Array.isArray(z)?z.length:0,onStartChat:fe=>{console.log("Start chat with friend:",fe),l&&l(fe)},onViewProfile:fe=>{const Re=new CustomEvent("open-user-profile",{detail:{userId:fe.user_id}});window.dispatchEvent(Re),We(!1)},onUnfriend:bt}),h&&s.jsx(dge,{isOpen:mt,onClose:()=>Ye(!1),userId:gt,profileName:h.name,isOwnProfile:St,onNavigateToProfile:o}),ie&&de&&s.jsx(Bl,{event:(console.log(" ProfileView: Event data being passed to EventDetailsModal:",{event:de,hasSetlist:de.setlist,hasSetlistEnriched:de.setlist_enriched,setlistSongCount:de.setlist_song_count}),de),currentUserId:e,isOpen:ie,onClose:()=>se(!1),isInterested:!0,onInterestToggle:(fe,Re)=>E(void 0,null,function*(){console.log(" Interest toggled in profile view:",fe,Re);try{yield Qr.setEventInterest(e,fe,Re),Re||se(!1),yield Sr(),Me({title:Re?"Interest Added":"Interest Removed",description:Re?"You're now interested in this event":"You've removed this event from your interested list"})}catch(ot){console.error("Error toggling event interest:",ot),Me({title:"Error",description:"Failed to update interest",variant:"destructive"})}}),onNavigateToProfile:o,onNavigateToChat:l,onAttendanceChange:(fe,Re)=>E(void 0,null,function*(){console.log(" Attendance changed in profile view:",fe,Re),yield Promise.all([Sr(),At()])})}),!St&&h&&s.jsx(v1,{open:we,onClose:()=>oe(!1),contentType:"profile",contentId:gt,contentTitle:`${h.name}'s profile`,onReportSubmitted:()=>{oe(!1),Me({title:"Report Submitted",description:"Thank you for helping keep our community safe"})}}),!St&&h&&s.jsx(mge,{open:ce,onClose:()=>Ae(!1),user:{id:gt,name:h.name,avatar_url:h.avatar_url||void 0},isBlocked:Be,onBlockToggled:()=>{Ae(!1),Xe(!Be),Me({title:Be?"User Unblocked":"User Blocked",description:Be?`You can now see content from ${h.name}`:`You won't see content from ${h.name} anymore`})}})]})):(console.log(" ProfileView: No profile data available after loading"),console.log(" ProfileView: Loading state:",y),console.log(" ProfileView: Current user ID:",e),s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"font-bold mb-4",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)"},children:"Profile not found"}),s.jsx("p",{className:"mb-4",style:{color:"var(--neutral-600)"},children:"Unable to load profile data. Please try again."}),s.jsxs(le,{onClick:()=>{window.history.length>1?Et(-1):r()},children:[s.jsx(Cs,{size:16,className:"mr-2"}),"Back"]})]})}))},Ege=({currentUserId:e,onBack:t,onSave:r})=>{const[n,a]=x.useState(null),[i,o]=x.useState(!0),[l,c]=x.useState(!1),[d,u]=x.useState({name:"",bio:"",instagram_handle:"",music_streaming_profile:"",avatar_url:null,gender:"",birthday:""}),{toast:f}=Rr();x.useEffect(()=>{h()},[e]);const h=()=>E(void 0,null,function*(){try{console.log("Fetching profile for user:",e);const v="id, user_id, name, avatar_url, bio, instagram_handle, music_streaming_profile, gender, birthday, created_at, updated_at",y=N=>E(void 0,null,function*(){return console.log(`ProfileEdit: Attempting profile lookup by ${N}`),yield T.from("users").select(v).eq(N,e).maybeSingle()});let _=null;const{data:w,error:b}=yield y("user_id");if(b&&b.code!=="PGRST116")throw console.error("Profile fetch error:",b),console.error("Error code:",b.code),console.error("Error message:",b.message),console.error("Error details:",b.details),b;if(_=w,!_){const{data:N,error:S}=yield y("id");if(S&&S.code!=="PGRST116")throw console.error("Profile fetch fallback error:",S),S;_=N}if(!_){console.log("No profile found, will create one when user saves"),u({name:"",bio:"",instagram_handle:"",music_streaming_profile:"",avatar_url:null,gender:"",birthday:""}),o(!1);return}console.log("Profile data received:",_),a(_),u({name:_.name||"",bio:_.bio||"",instagram_handle:_.instagram_handle||"",music_streaming_profile:_.music_streaming_profile||"",avatar_url:_.avatar_url||null,gender:_.gender||"",birthday:_.birthday||""})}catch(v){console.error("Error fetching profile:",v),f({title:"Error",description:"Failed to load profile",variant:"destructive"})}finally{o(!1)}}),p=()=>E(void 0,null,function*(){if(console.log("Save button clicked, form data:",d),!d.name.trim()){f({title:"Error",description:"Name is required",variant:"destructive"});return}c(!0);try{const v={user_id:e,name:d.name.trim(),bio:d.bio.trim()||null,instagram_handle:d.instagram_handle.trim()||null,music_streaming_profile:d.music_streaming_profile.trim()||null,avatar_url:d.avatar_url||null,gender:d.gender.trim()||null,birthday:d.birthday.trim()||null,updated_at:new Date().toISOString()};console.log("Saving profile with data:",v);let y;if(n&&n.id?(console.log("Updating existing profile"),y=yield T.from("users").update(v).eq("user_id",e).select().single()):(console.log("Creating new profile"),y=yield T.from("users").insert(v).select().single()),y.error)throw console.error("Profile save error:",y.error),y.error;console.log("Profile saved successfully:",y.data),f({title:"Success",description:"Profile saved successfully"}),r()}catch(v){console.error("Error saving profile:",v),f({title:"Error",description:`Failed to save profile: ${v.message}`,variant:"destructive"})}finally{c(!1)}}),g=(v,y)=>{u(_=>H(M({},_),{[v]:y}))};return i?s.jsx(w1,{text:"Loading profile..."}):s.jsx("div",{className:"p-4 bg-gray-50",children:s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx(le,{variant:"ghost",size:"icon",onClick:t,children:s.jsx(Cs,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Edit Profile"}),s.jsx("p",{className:"text-muted-foreground",children:"Update your profile information"})]})]}),s.jsxs(He,{children:[s.jsx(Er,{children:s.jsxs(qr,{className:"flex items-center gap-2",children:[s.jsx(Rs,{className:"w-5 h-5"}),"Profile Information"]})}),s.jsxs(et,{className:"space-y-6",children:[s.jsx(_de,{value:d.avatar_url,onChange:v=>E(void 0,null,function*(){if(g("avatar_url",v||""),v&&n&&n.id)try{yield T.from("users").update({avatar_url:v}).eq("user_id",e),a(H(M({},n),{avatar_url:v}))}catch(y){console.error("Error auto-saving avatar:",y)}}),userId:e,bucket:"profile-avatars",maxSizeMB:25,label:"Profile Picture",helperText:"Upload a photo to personalize your profile. Max 25MB. Your avatar saves automatically.",aspectRatio:"circle"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"name",children:"Name *"}),s.jsx(Ar,{id:"name",value:d.name,onChange:v=>g("name",v.target.value),placeholder:"Enter your name",maxLength:50})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"bio",children:"Bio"}),s.jsx(ys,{id:"bio",value:d.bio,onChange:v=>g("bio",v.target.value),placeholder:"Tell people about yourself...",maxLength:200,rows:3}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[d.bio.length,"/200 characters"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ht,{htmlFor:"instagram",className:"flex items-center gap-2",children:[s.jsx(xP,{className:"w-4 h-4"}),"Instagram Handle"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-muted-foreground",children:"@"}),s.jsx(Ar,{id:"instagram",value:d.instagram_handle,onChange:v=>g("instagram_handle",v.target.value.replace("@","")),placeholder:"username",maxLength:100})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your Instagram profile will be linked when people view your profile"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ht,{htmlFor:"music-streaming",className:"flex items-center gap-2",children:[s.jsx($t,{className:"w-4 h-4"}),"Music Streaming Profile"]}),s.jsx(Ar,{id:"music-streaming",value:d.music_streaming_profile,onChange:v=>g("music_streaming_profile",v.target.value),placeholder:"https://open.spotify.com/user/yourusername or @username",maxLength:200}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Share your Spotify, Apple Music, or other streaming profile link. Will display as a clickable link on your profile."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ht,{htmlFor:"gender",className:"flex items-center gap-2",children:[s.jsx(zr,{className:"w-4 h-4"}),"Gender"]}),s.jsxs(aa,{value:d.gender||void 0,onValueChange:v=>g("gender",v),children:[s.jsx(Hs,{children:s.jsx(ia,{placeholder:"Select your gender (optional)"})}),s.jsxs(Gs,{children:[s.jsx(qt,{value:"male",children:"Male"}),s.jsx(qt,{value:"female",children:"Female"}),s.jsx(qt,{value:"non-binary",children:"Non-binary"}),s.jsx(qt,{value:"prefer-not-to-say",children:"Prefer not to say"}),s.jsx(qt,{value:"other",children:"Other"}),s.jsx(qt,{value:"not-specified",children:"Not specified"})]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your gender will be shown to other users interested in the same events for trust and safety"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ht,{htmlFor:"birthday",className:"flex items-center gap-2",children:[s.jsx(It,{className:"w-4 h-4"}),"Birthday"]}),s.jsx(Ar,{id:"birthday",type:"date",value:d.birthday,onChange:v=>g("birthday",v.target.value),max:(()=>{const v=new Date;return v.setFullYear(v.getFullYear()-13),v.toISOString().split("T")[0]})()}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your age (not exact birthday) will be shown to other users interested in the same events. You must be at least 13 years old."})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsxs(le,{onClick:p,disabled:l||!d.name.trim(),className:"flex-1",children:[s.jsx(bP,{className:"w-4 h-4 mr-2"}),l?"Saving...":"Save Changes"]}),s.jsx(le,{variant:"outline",onClick:t,children:"Cancel"})]})]})]})]})})},Cge=`
  @keyframes elegant-shift {
    0% { background-position: 0% 50%; }
    25% { background-position: 100% 50%; }
    50% { background-position: 100% 100%; }
    75% { background-position: 0% 100%; }
    100% { background-position: 0% 50%; }
  }
`;if(typeof document!="undefined"){const e=document.createElement("style");e.textContent=Cge,document.head.appendChild(e)}function dV({onAuthSuccess:e}){const[t,r]=x.useState(""),[n,a]=x.useState(""),[i,o]=x.useState(""),[l,c]=x.useState(!1),{toast:d}=Rr(),u=h=>E(this,null,function*(){h.preventDefault(),c(!0);try{const{error:p}=yield T.auth.signUp({email:t,password:n,options:{emailRedirectTo:"https://synth-beta-testing.vercel.app/#onboarding",data:{name:i}}});if(p)throw p;d({title:"Check your email!",description:"We sent you a confirmation link."})}catch(p){d({title:"Sign up failed",description:p.message,variant:"destructive"})}finally{c(!1)}}),f=h=>E(this,null,function*(){h.preventDefault(),c(!0);try{const{error:p}=yield T.auth.signInWithPassword({email:t,password:n});if(p)throw p;d({title:"Welcome back!",description:"You're now signed in."}),e()}catch(p){d({title:"Sign in failed",description:p.message,variant:"destructive"})}finally{c(!1)}});return s.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{background:"linear-gradient(45deg, #fdf2f8 0%, #ffffff 25%, #fce7f3 50%, #ffffff 75%, #fdf2f8 100%)",backgroundSize:"400% 400%",animation:"elegant-shift 20s ease infinite"},children:s.jsxs(He,{className:"w-full max-w-md bg-white/90 backdrop-blur-lg rounded-3xl shadow-xl border-0",children:[s.jsxs(Er,{className:"text-center pb-8",children:[s.jsx("div",{className:"flex justify-center mb-6",children:s.jsx("img",{src:"/Logos/Main logo black background.png",alt:"Synth Logo",className:"w-20 h-20 rounded-2xl"})}),s.jsx(qr,{className:"text-3xl font-bold text-black mb-2",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Synth"}),s.jsx(uc,{className:"text-[#666666] text-base",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Connect with people at events you love"})]}),s.jsx(et,{className:"px-10 pb-10",children:s.jsxs(Li,{defaultValue:"signin",children:[s.jsxs(yi,{className:"grid w-full grid-cols-2 bg-[#F5F5DC] rounded-xl p-1",children:[s.jsx(Xr,{value:"signin",className:"data-[state=active]:bg-white data-[state=active]:text-black text-[#666666] font-medium rounded-lg transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Sign In"}),s.jsx(Xr,{value:"signup",className:"data-[state=active]:bg-white data-[state=active]:text-black text-[#666666] font-medium rounded-lg transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Sign Up"})]}),s.jsx(Jr,{value:"signin",className:"mt-6",children:s.jsxs("form",{onSubmit:f,className:"space-y-6",children:[s.jsx("div",{children:s.jsx(Ar,{id:"signin-email",name:"signinEmail",type:"email",placeholder:"Email",value:t,onChange:h=>r(h.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx("div",{children:s.jsx(Ar,{id:"signin-password",name:"signinPassword",type:"password",placeholder:"Password",value:n,onChange:h=>a(h.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx(le,{type:"submit",disabled:l,className:"w-full bg-[#FF3399] hover:bg-[#E6007A] text-white font-semibold py-3 px-6 rounded-lg transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:l?"Signing in...":"Sign In"})]})}),s.jsx(Jr,{value:"signup",className:"mt-6",children:s.jsxs("form",{onSubmit:u,className:"space-y-6",children:[s.jsx("div",{children:s.jsx(Ar,{id:"signup-name",name:"signupName",type:"text",placeholder:"Your name",value:i,onChange:h=>o(h.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx("div",{children:s.jsx(Ar,{id:"signup-email",name:"signupEmail",type:"email",placeholder:"Email",value:t,onChange:h=>r(h.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx("div",{children:s.jsx(Ar,{id:"signup-password",name:"signupPassword",type:"password",placeholder:"Password (min 6 characters)",value:n,onChange:h=>a(h.target.value),required:!0,minLength:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx(le,{type:"submit",disabled:l,className:"w-full bg-[#FF3399] hover:bg-[#E6007A] text-white font-semibold py-3 px-6 rounded-lg transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:l?"Creating account...":"Sign Up"})]})})]})})]})})}var L1="Switch",[Pge,IBe]=Os(L1),[Tge,Age]=Pge(L1),uV=x.forwardRef((e,t)=>{const b=e,{__scopeSwitch:r,name:n,checked:a,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:d,form:u}=b,f=me(b,["__scopeSwitch","name","checked","defaultChecked","required","disabled","value","onCheckedChange","form"]),[h,p]=x.useState(null),g=cr(t,N=>p(N)),v=x.useRef(!1),y=h?u||!!h.closest("form"):!0,[_,w]=Wa({prop:a,defaultProp:i!=null?i:!1,onChange:d,caller:L1});return s.jsxs(Tge,{scope:r,checked:_,disabled:l,children:[s.jsx(Ct.button,H(M({type:"button",role:"switch","aria-checked":_,"aria-required":o,"data-state":pV(_),"data-disabled":l?"":void 0,disabled:l,value:c},f),{ref:g,onClick:pt(e.onClick,N=>{w(S=>!S),y&&(v.current=N.isPropagationStopped(),v.current||N.stopPropagation())})})),y&&s.jsx(mV,{control:h,bubbles:!v.current,name:n,value:c,checked:_,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"}})]})});uV.displayName=L1;var hV="SwitchThumb",fV=x.forwardRef((e,t)=>{const i=e,{__scopeSwitch:r}=i,n=me(i,["__scopeSwitch"]),a=Age(hV,r);return s.jsx(Ct.span,H(M({"data-state":pV(a.checked),"data-disabled":a.disabled?"":void 0},n),{ref:t}))});fV.displayName=hV;var Rge="SwitchBubbleInput",mV=x.forwardRef((o,i)=>{var l=o,{__scopeSwitch:e,control:t,checked:r,bubbles:n=!0}=l,a=me(l,["__scopeSwitch","control","checked","bubbles"]);const c=x.useRef(null),d=cr(c,i),u=k1(r),f=zb(t);return x.useEffect(()=>{const h=c.current;if(!h)return;const p=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(p,"checked").set;if(u!==r&&v){const y=new Event("click",{bubbles:n});v.call(h,r),h.dispatchEvent(y)}},[u,r,n]),s.jsx("input",H(M({type:"checkbox","aria-hidden":!0,defaultChecked:r},a),{tabIndex:-1,ref:d,style:H(M(M({},a.style),f),{position:"absolute",pointerEvents:"none",opacity:0,margin:0})}))});mV.displayName=Rge;function pV(e){return e?"checked":"unchecked"}var gV=uV,Oge=fV;const tv=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(gV,H(M({className:ke("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e)},t),{ref:r,children:s.jsx(Oge,{className:ke("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}))});tv.displayName=gV.displayName;class S0{static getUserMusicTags(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_preferences").select("preferred_genres, preferred_artists, music_preference_signals").eq("user_id",t).maybeSingle();if(n&&n.code!=="PGRST116")throw n;if(!r)return[];const a=(r.preferred_genres||[]).map(l=>({id:`${t}-genre-${l}`,user_id:t,tag_type:"genre",tag_value:l,tag_source:"manual",weight:5,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),i=r.preferred_artists||[];let o=[];if(i.length>0){const{data:l}=yield T.from("artists").select("id, name").in("id",i);l&&(o=l.map(c=>({id:`${t}-artist-${c.id}`,user_id:t,tag_type:"artist",tag_value:c.name,tag_source:"manual",weight:5,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})))}return[...a,...o]}catch(r){return console.error("Error fetching user music tags:",r),[]}})}static getUserMusicTagsByType(t,r){return E(this,null,function*(){try{return(yield this.getUserMusicTags(t)).filter(a=>a.tag_type===r)}catch(n){return console.error(`Error fetching ${r} tags:`,n),[]}})}static addMusicTag(t,r){return E(this,null,function*(){try{const{data:n}=yield T.from("user_preferences").select("preferred_genres, preferred_artists, id").eq("user_id",t).maybeSingle(),a=(n==null?void 0:n.preferred_genres)||[],i=(n==null?void 0:n.preferred_artists)||[];let o;if(r.tag_type==="genre")a.includes(r.tag_value)||a.push(r.tag_value),o={preferred_genres:a,preferred_artists:i,updated_at:new Date().toISOString()};else{let d=null;const{data:u,error:f}=yield T.from("artists").select("id, name").ilike("name",r.tag_value).limit(1).maybeSingle();if(f&&f.code!=="PGRST116"&&console.warn(`Error searching for artist "${r.tag_value}":`,f),u)d=u.id;else try{const{MissingEntityRequestService:h}=yield kn(()=>E(this,null,function*(){const{MissingEntityRequestService:p}=yield import("./missingEntityRequestService-U8rBFeto.js");return{MissingEntityRequestService:p}}),[],import.meta.url);yield h.submitRequest({entity_type:"artist",entity_name:r.tag_value}),console.log(` Submitted request for missing artist: "${r.tag_value}"`)}catch(h){console.warn(`Error submitting artist request "${r.tag_value}":`,h)}d&&!i.includes(d)&&i.push(d),o={preferred_genres:a,preferred_artists:i,updated_at:new Date().toISOString()}}let l,c;if(n){const d=yield T.from("user_preferences").update(o).eq("user_id",t).select().single();l=d.data,c=d.error}else{const d=yield T.from("user_preferences").insert(M({user_id:t},o)).select().single();l=d.data,c=d.error}if(c)throw c;return{id:`${t}-${r.tag_type}-${r.tag_value}`,user_id:t,tag_type:r.tag_type,tag_value:r.tag_value,tag_source:r.tag_source||"manual",weight:r.weight||5,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}catch(n){return console.error("Error adding music tag:",n),null}})}static removeMusicTag(t){return E(this,null,function*(){try{const r=t.split("-");if(r.length<3)return console.error("Invalid tag ID format:",t),!1;const n=r[0],a=r[1],i=r.slice(2).join("-");return yield this.removeMusicTagByValue(n,a,i)}catch(r){return console.error("Error removing music tag:",r),!1}})}static removeMusicTagByValue(t,r,n){return E(this,null,function*(){try{const{data:a}=yield T.from("user_preferences").select("preferred_genres, preferred_artists").eq("user_id",t).maybeSingle();if(!a)return!0;let i=a.preferred_genres||[],o=a.preferred_artists||[];if(r==="genre")i=i.filter(c=>c!==n);else{const{data:c}=yield T.from("artists").select("id").eq("name",n).maybeSingle();c?o=o.filter(d=>d!==c.id):console.warn(` Artist "${n}" not found in database, cannot remove`)}const{error:l}=yield T.from("user_preferences").update({preferred_genres:i,preferred_artists:o,updated_at:new Date().toISOString()}).eq("user_id",t);if(l)throw l;return!0}catch(a){return console.error("Error removing music tag by value:",a),!1}})}static bulkUpdateMusicTags(t,r){return E(this,null,function*(){try{const n=r.filter(d=>d.tag_type==="genre").map(d=>d.tag_value),a=r.filter(d=>d.tag_type==="artist").map(d=>d.tag_value),i=[];if(a.length>0)for(const d of a)try{const{data:u,error:f}=yield T.from("artists").select("id, name").ilike("name",d).limit(1).maybeSingle();if(f&&f.code!=="PGRST116"){console.warn(`Error searching for artist "${d}":`,f);continue}if(u)i.includes(u.id)||i.push(u.id);else{const h=d.toLowerCase().replace(/\s+/g,"-"),p=`manual:${h}-${Date.now()}`,{data:g,error:v}=yield T.from("artists").insert({name:d,identifier:h,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("id").single();if(v){console.warn(`Error creating artist "${d}":`,v);continue}g&&(yield T.from("external_entity_ids").insert({entity_type:"artist",entity_uuid:g.id,source:"manual",external_id:p}).catch(()=>{}),i.push(g.id),console.log(` Created new artist: "${d}" (${g.id})`))}}catch(u){console.error(`Error processing artist "${d}":`,u)}const{data:o,error:l}=yield T.from("user_preferences").select("id").eq("user_id",t).maybeSingle();if(l&&l.code!=="PGRST116")throw l;const c={preferred_genres:n||[],preferred_artists:i,updated_at:new Date().toISOString()};if(o){const{error:d}=yield T.from("user_preferences").update(c).eq("user_id",t);if(d)throw d}else{const{error:d}=yield T.from("user_preferences").insert({user_id:t,preferred_genres:n||[],preferred_artists:i,updated_at:new Date().toISOString()});if(d)throw d}return!0}catch(n){return console.error("Error bulk updating music tags:",n),!1}})}static syncSpotifyTags(t,r){return E(this,null,function*(){try{const{data:n}=yield T.from("user_preferences").select("preferred_genres, preferred_artists, music_preference_signals, id").eq("user_id",t).maybeSingle();let a=(n==null?void 0:n.preferred_genres)||[],i=(n==null?void 0:n.preferred_artists)||[];const o=(n==null?void 0:n.music_preference_signals)||{},l=r.filter(h=>h.tag_type==="artist").map(h=>h.tag_value),c=[];if(l.length>0)for(const h of l)try{const{data:p,error:g}=yield T.from("artists").select("id, name").ilike("name",h).limit(1).maybeSingle();if(g&&g.code!=="PGRST116"){console.warn(`Error searching for Spotify artist "${h}":`,g);continue}if(p)c.includes(p.id)||c.push(p.id);else{const v=h.toLowerCase().replace(/\s+/g,"-"),{data:y,error:_}=yield T.from("artists").insert({name:h,jambase_artist_id:`spotify:${v}-${Date.now()}`,identifier:v,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("id").single();if(_){console.warn(`Error creating Spotify artist "${h}":`,_);continue}y&&(c.push(y.id),console.log(` Created new Spotify artist: "${h}" (${y.id})`))}}catch(p){console.error(`Error processing Spotify artist "${h}":`,p)}r.forEach(h=>{h.tag_type==="genre"&&(a.includes(h.tag_value)||a.push(h.tag_value))});const d=[...new Set([...i,...c])],u={preferred_genres:a,preferred_artists:d,music_preference_signals:o,updated_at:new Date().toISOString()};let f;if(n?f=(yield T.from("user_preferences").update(u).eq("user_id",t)).error:f=(yield T.from("user_preferences").insert(M({user_id:t},u))).error,f)throw f;return!0}catch(n){return console.error("Error syncing Spotify tags:",n),!1}})}static updateTagWeight(t,r){return E(this,null,function*(){try{const n=t.split("-");if(n.length<3)return console.error("Invalid tag ID format:",t),!1;const a=n[0],i=n[1],o=n.slice(2).join("-"),{data:l}=yield T.from("user_preferences").select("music_preference_signals").eq("user_id",a).single(),c=(l==null?void 0:l.music_preference_signals)||{},d=`${i}_${o}`;c[d]=H(M({},c[d]),{weight:r});const{error:u}=yield T.from("user_preferences").update({music_preference_signals:c,updated_at:new Date().toISOString()}).eq("user_id",a);if(u)throw u;return!0}catch(n){return console.error("Error updating tag weight:",n),!1}})}static getMusicPreferencesSummary(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("user_preferences").select("preferred_genres, preferred_artists, music_preference_signals").eq("user_id",t).maybeSingle();if(n&&n.code!=="PGRST116")throw n;const a=(r==null?void 0:r.preferred_genres)||[],i=(r==null?void 0:r.preferred_artists)||[],o=(r==null?void 0:r.music_preference_signals)||{};let l=[];if(i.length>0){const{data:d}=yield T.from("artists").select("name").in("id",i);d&&(l=d.map(u=>u.name))}const c=Object.keys(o).some(d=>{var u;return typeof o[d]=="object"&&((u=o[d])==null?void 0:u.source)==="spotify"});return{genres:a,artists:l,hasSpotify:c}}catch(r){return console.error("Error getting music preferences summary:",r),{genres:[],artists:[],hasSpotify:!1}}})}}const vV=["Rock","Pop","Hip Hop","Rap","Electronic","Jazz","Classical","Indie","R&B","Soul","Country","Metal","Folk","Punk","Blues","Reggae","EDM","House","Techno","Dubstep","Trance","Drum & Bass","Ambient","Alternative","Grunge","Hard Rock","Progressive Rock","Psychedelic Rock","Trap","Grime","Afrobeat","Disco","Funk","Dance","Latin","Reggaeton","K-Pop","Salsa","Bossa Nova","Gospel","Bluegrass","Ska","Emo","Screamo","Shoegaze","Post-Rock","Industrial","Experimental","Lo-Fi","Other"],Mge=({onClose:e})=>{const{user:t}=xs(),{toast:r}=Rr(),[n,a]=x.useState(null),[i,o]=x.useState([]),[l,c]=x.useState(!0),[d,u]=x.useState(!1),[f,h]=x.useState({location_city:"",gender:"",birthday:"",bio:"",similar_users_notifications:!0}),[p,g]=x.useState({genres:[],artists:[],customGenres:[],customArtists:[]});x.useEffect(()=>{t!=null&&t.id&&v()},[t==null?void 0:t.id]);const v=()=>E(void 0,null,function*(){var b;if(t!=null&&t.id)try{const{data:N,error:S}=yield T.from("users").select("*").eq("user_id",t.id).single();if(S&&S.code!=="PGRST116")throw S;N&&(a(N),h({location_city:N.location_city||"",gender:N.gender||"",birthday:N.birthday||"",bio:N.bio||"",similar_users_notifications:(b=N.similar_users_notifications)!=null?b:!0}));const k=yield S0.getUserMusicTags(t.id);o(k);const P=k.filter(R=>R.tag_type==="genre").map(R=>R.tag_value),A=k.filter(R=>R.tag_type==="artist").map(R=>R.tag_value);g(R=>H(M({},R),{genres:P,artists:A}))}catch(N){console.error("Error fetching user data:",N),r({title:"Error",description:"Failed to load your preferences",variant:"destructive"})}finally{c(!1)}}),y=(b,N)=>{h(S=>H(M({},S),{[b]:N}))},_=(b,N,S)=>E(void 0,null,function*(){if(t!=null&&t.id)try{if(S)yield S0.addMusicTag(t.id,{tag_type:b,tag_value:N,tag_source:"manual",weight:5});else{const R=i.find($=>$.tag_type===b&&$.tag_value===N);R&&(yield S0.removeMusicTag(t.id,R.id))}const k=yield S0.getUserMusicTags(t.id);o(k);const P=k.filter(R=>R.tag_type==="genre").map(R=>R.tag_value),A=k.filter(R=>R.tag_type==="artist").map(R=>R.tag_value);g(R=>H(M({},R),{genres:P,artists:A}))}catch(k){console.error("Error updating music tag:",k),r({title:"Error",description:"Failed to update music preferences",variant:"destructive"})}}),w=()=>E(void 0,null,function*(){if(t!=null&&t.id){u(!0);try{const{error:b}=yield T.from("users").update({location_city:f.location_city.trim()||null,gender:f.gender.trim()||null,birthday:f.birthday.trim()||null,bio:f.bio.trim()||null,similar_users_notifications:f.similar_users_notifications,updated_at:new Date().toISOString()}).eq("user_id",t.id);if(b)throw b;r({title:"Success",description:"Your preferences have been saved"}),e&&e()}catch(b){console.error("Error saving preferences:",b),r({title:"Error",description:"Failed to save preferences",variant:"destructive"})}finally{u(!1)}}});return l?s.jsx("div",{className:"flex items-center justify-center p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading preferences..."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(Rs,{className:"w-5 h-5 text-primary"}),"Profile & Preferences"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your profile information and personalization settings"})]}),s.jsx(ll,{}),s.jsxs(He,{children:[s.jsx(Er,{className:"pb-3",children:s.jsxs(qr,{className:"text-base flex items-center gap-2",children:[s.jsx(gr,{className:"w-4 h-4"}),"Location"]})}),s.jsx(et,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"location",children:"City"}),s.jsx(Ar,{id:"location",value:f.location_city,onChange:b=>y("location_city",b.target.value),placeholder:"Enter your city",maxLength:100,className:"bg-white"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Used for local event discovery and recommendations"})]})})]}),s.jsxs(He,{children:[s.jsx(Er,{className:"pb-3",children:s.jsxs(qr,{className:"text-base flex items-center gap-2",children:[s.jsx(zr,{className:"w-4 h-4"}),"Demographics"]})}),s.jsxs(et,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"gender",children:"Gender"}),s.jsxs(aa,{value:f.gender||void 0,onValueChange:b=>y("gender",b),children:[s.jsx(Hs,{className:"bg-white",children:s.jsx(ia,{placeholder:"Select your gender (optional)"})}),s.jsxs(Gs,{className:"bg-white",children:[s.jsx(qt,{value:"male",children:"Male"}),s.jsx(qt,{value:"female",children:"Female"}),s.jsx(qt,{value:"non-binary",children:"Non-binary"}),s.jsx(qt,{value:"prefer-not-to-say",children:"Prefer not to say"}),s.jsx(qt,{value:"other",children:"Other"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"birthday",children:"Birthday"}),s.jsx(Ar,{id:"birthday",type:"date",value:f.birthday,onChange:b=>y("birthday",b.target.value),max:(()=>{const b=new Date;return b.setFullYear(b.getFullYear()-13),b.toISOString().split("T")[0]})(),className:"bg-white"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your age (not exact birthday) helps with event recommendations and safety"})]})]})]}),s.jsxs(He,{children:[s.jsx(Er,{className:"pb-3",children:s.jsxs(qr,{className:"text-base flex items-center gap-2",children:[s.jsx(OQ,{className:"w-4 h-4"}),"Bio"]})}),s.jsx(et,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"bio",children:"About You"}),s.jsx(ys,{id:"bio",value:f.bio,onChange:b=>y("bio",b.target.value),placeholder:"Tell people about yourself...",maxLength:200,rows:3,className:"bg-white"}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[f.bio.length,"/200 characters"]})]})})]}),s.jsxs(He,{children:[s.jsx(Er,{className:"pb-3",children:s.jsxs(qr,{className:"text-base flex items-center gap-2",children:[s.jsx($t,{className:"w-4 h-4"}),"Music Preferences"]})}),s.jsxs(et,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Ht,{className:"text-sm font-medium",children:"Favorite Genres"}),s.jsxs(Ke,{variant:"secondary",children:[p.genres.length,"/7"]})]}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:vV.slice(0,20).map(b=>s.jsx(le,{type:"button",variant:p.genres.includes(b)?"default":"outline",size:"sm",onClick:()=>_("genre",b,!p.genres.includes(b)),disabled:!p.genres.includes(b)&&p.genres.length>=7,className:"justify-start text-xs",children:b},b))}),p.genres.length>=7&&s.jsx("p",{className:"text-xs text-amber-600",children:"Maximum of 7 genres selected"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Ht,{className:"text-sm font-medium",children:"Favorite Artists"}),s.jsxs(Ke,{variant:"secondary",children:[p.artists.length,"/15"]})]}),p.artists.length>0?s.jsx("div",{className:"flex flex-wrap gap-2",children:p.artists.map(b=>s.jsxs(Ke,{variant:"secondary",className:"flex items-center gap-1",children:[b,s.jsx("button",{type:"button",onClick:()=>_("artist",b,!1),className:"ml-1 text-xs hover:text-destructive",children:""})]},b))}):s.jsx("p",{className:"text-sm text-muted-foreground",children:"Add artists by searching for them in the search bar or during onboarding"})]})]})]}),s.jsxs(He,{children:[s.jsx(Er,{className:"pb-3",children:s.jsxs(qr,{className:"text-base flex items-center gap-2",children:[s.jsx(Ld,{className:"w-4 h-4"}),"Notifications"]})}),s.jsx(et,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:"Similar Users Notifications"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Get notified when similar users (age, gender, interests) show interest in events"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Helps you connect with people who share your interests and demographics"})]}),s.jsx(tv,{checked:f.similar_users_notifications,onCheckedChange:b=>y("similar_users_notifications",b)})]})})]}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsxs(le,{onClick:w,disabled:d,className:"min-w-[120px]",children:[s.jsx(bP,{className:"w-4 h-4 mr-2"}),d?"Saving...":"Save Changes"]})})]})};function yV(e){return E(this,null,function*(){try{const{data:t,error:r}=yield T.from("user_settings_preferences").select("*").eq("user_id",e).single();if(r){if(r.code==="PGRST116")return yield xV(e);throw console.error("Error fetching user settings preferences:",r),r}return t}catch(t){return console.error("Failed to get user settings preferences:",t),null}})}function Dge(){return E(this,null,function*(){try{const{data:{user:e}}=yield T.auth.getUser();if(!e)throw new Error("No authenticated user");return yield yV(e.id)}catch(e){return console.error("Failed to get current user settings preferences:",e),null}})}function Ige(e,t){return E(this,null,function*(){try{yield $ge(e);const{data:r,error:n}=yield T.from("user_settings_preferences").update(t).eq("user_id",e).select().single();if(n)throw console.error("Error updating user settings preferences:",n),n;return r}catch(r){return console.error("Failed to update user settings preferences:",r),null}})}function rS(e){return E(this,null,function*(){try{const{data:{user:t}}=yield T.auth.getUser();if(!t)throw new Error("No authenticated user");return yield Ige(t.id,e)}catch(t){return console.error("Failed to update current user settings preferences:",t),null}})}function xV(e){return E(this,null,function*(){try{const{data:t,error:r}=yield T.from("user_settings_preferences").insert({user_id:e,enable_push_notifications:!0,enable_emails:!0,is_public_profile:!0}).select().single();if(r)throw console.error("Error creating user settings preferences:",r),r;return t}catch(t){return console.error("Failed to create user settings preferences:",t),null}})}function $ge(e){return E(this,null,function*(){try{let t=yield yV(e);return t||(t=yield xV(e)),t}catch(t){return console.error("Failed to ensure user settings preferences exist:",t),null}})}const Lge=({isOpen:e,onClose:t,onSignOut:r,userEmail:n})=>{const[a,i]=x.useState(!1),[o,l]=x.useState("menu"),[c,d]=x.useState(!1),[u,f]=x.useState(!1),[h,p]=x.useState(""),[g,v]=x.useState(!0),[y,_]=x.useState(!1),[w,b]=x.useState(!0),[N,S]=x.useState("user"),[k,P]=x.useState(!1),[A,R]=x.useState(!0),[$,O]=x.useState(!0),[z,D]=x.useState(!1),{toast:B}=Rr(),{user:F}=xs(),U=()=>E(void 0,null,function*(){i(!0);try{yield r(),t(),B({title:"Signed out successfully",description:"You've been signed out of your account."})}catch(ne){console.error("Error signing out:",ne),B({title:"Error",description:"Failed to sign out. Please try again.",variant:"destructive"})}finally{i(!1)}}),G=()=>{l("menu"),p(""),t()},q=()=>{l("menu"),p("")},K=()=>E(void 0,null,function*(){if(!n){B({title:"Error",description:"No email address found for this account.",variant:"destructive"});return}d(!0);try{const{error:ne}=yield T.auth.resetPasswordForEmail(n,{redirectTo:"https://synth-beta-testing.vercel.app/reset-password"});if(ne)throw ne;B({title:"Password reset email sent",description:"Check your email for instructions to reset your password."})}catch(ne){console.error("Error sending password reset:",ne),B({title:"Error",description:ne.message||"Failed to send password reset email.",variant:"destructive"})}finally{d(!1)}}),Z=()=>E(void 0,null,function*(){if(!h.trim()){B({title:"Error",description:"Please enter a new email address.",variant:"destructive"});return}if(h===n){B({title:"Error",description:"The new email address must be different from your current email.",variant:"destructive"});return}f(!0);try{const{error:ne}=yield T.auth.updateUser({email:h});if(ne)throw ne;B({title:"Email change confirmation sent",description:`Check ${h} for a confirmation link to complete the change.`}),p("")}catch(ne){console.error("Error changing email:",ne),B({title:"Error",description:ne.message||"Failed to send email change confirmation.",variant:"destructive"})}finally{f(!1)}}),Y=ne=>E(void 0,null,function*(){if(F!=null&&F.id){_(!0);try{if(ne&&!(yield Yf.hasProfilePicture(F.id))){B({title:"Profile Picture Required",description:"You must upload a profile picture before making your profile public. Go to Edit Profile to add a photo.",variant:"destructive"}),_(!1);return}if(yield Yf.setProfileVisibility(F.id,ne))yield rS({is_public_profile:ne}),v(ne),B({title:ne?"Profile is now public":"Profile is now private",description:ne?"Your profile is visible to all users.":"Your profile is only visible to your friends."});else throw new Error("Failed to update visibility")}catch(re){console.error("Error toggling profile visibility:",re),B({title:"Error",description:"Failed to update profile visibility. Please try again.",variant:"destructive"})}finally{_(!1)}}}),Q=ne=>E(void 0,null,function*(){if(F!=null&&F.id){D(!0);try{if(yield rS({enable_push_notifications:ne}))R(ne),B({title:ne?"Push notifications enabled":"Push notifications disabled",description:ne?"You will receive push notifications.":"Push notifications are now disabled."});else throw new Error("Failed to update preferences")}catch(re){console.error("Error toggling push notifications:",re),B({title:"Error",description:"Failed to update push notification preferences. Please try again.",variant:"destructive"})}finally{D(!1)}}}),X=ne=>E(void 0,null,function*(){if(F!=null&&F.id){D(!0);try{if(yield rS({enable_emails:ne}))O(ne),B({title:ne?"Email notifications enabled":"Email notifications disabled",description:ne?"You will receive email notifications.":"Email notifications are now disabled."});else throw new Error("Failed to update preferences")}catch(re){console.error("Error toggling email notifications:",re),B({title:"Error",description:"Failed to update email preferences. Please try again.",variant:"destructive"})}finally{D(!1)}}});return x.useEffect(()=>{e&&(F!=null&&F.id)&&(Yf.getUserVisibilitySettings(F.id).then(ne=>{ne&&(v(ne.is_public_profile),b(ne.has_avatar))}).catch(ne=>{console.error("Error loading visibility settings:",ne),v(!0),b(!0)}),D(!0),Dge().then(ne=>{ne&&(R(ne.enable_push_notifications),O(ne.enable_emails),ne.is_public_profile!==void 0&&v(ne.is_public_profile))}).catch(ne=>{console.error("Error loading user settings preferences:",ne)}).finally(()=>{D(!1)}),T.from("users").select("account_type, verified").eq("user_id",F.id).single().then(({data:ne})=>{ne&&(S(ne.account_type||"user"),P(ne.verified||!1))}))},[e,F==null?void 0:F.id]),s.jsx(pn,{open:e,onOpenChange:G,children:s.jsxs(dn,{className:"max-w-md w-[95vw] max-h-[90vh] overflow-y-auto",children:[s.jsx(Vn,{children:s.jsxs(bn,{className:"flex items-center gap-2",children:[o!=="menu"&&s.jsx(le,{variant:"ghost",size:"sm",onClick:q,className:"mr-2 -ml-2",children:" Back"}),o==="menu"&&s.jsx(gl,{className:"w-5 h-5"}),o==="menu"?"Settings":o==="onboarding-preferences"?"Profile & Preferences":o==="security-actions"?"Security Actions":o==="verification"?"Verification Status":"Settings"]})}),o==="menu"?s.jsxs("div",{className:"space-y-4",children:[n&&s.jsx("div",{className:"p-3 bg-muted/50 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Rs,{className:"w-4 h-4"}),s.jsxs("span",{children:["Signed in as: ",n]})]})}),s.jsx(ll,{}),s.jsx("div",{className:"p-4 bg-muted/30 rounded-lg border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[g?s.jsx(Kd,{className:"w-5 h-5 text-primary mt-0.5"}):s.jsx(xQ,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:"Public Profile"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:g?"Your profile is visible to all users":"Your profile is only visible to friends"}),!w&&s.jsxs("div",{className:"text-xs text-amber-600 mt-1 flex items-center gap-1",children:[s.jsx(Sv,{className:"w-3 h-3"}),"Profile picture required to make profile public"]})]})]}),s.jsx(tv,{checked:g,onCheckedChange:Y,disabled:y})]})}),s.jsx(ll,{}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"p-4 bg-muted/30 rounded-lg border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[s.jsx(Ld,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:"Push Notifications"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:A?"You will receive push notifications":"Push notifications are disabled"})]})]}),s.jsx(tv,{checked:A,onCheckedChange:Q,disabled:z})]})}),s.jsx("div",{className:"p-4 bg-muted/30 rounded-lg border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[s.jsx(CF,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:"Email Notifications"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:$?"You will receive email notifications":"Email notifications are disabled"})]})]}),s.jsx(tv,{checked:$,onCheckedChange:X,disabled:z})]})})]}),s.jsx(ll,{}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(le,{variant:"ghost",className:"w-full justify-start gap-3 h-12",onClick:()=>l("onboarding-preferences"),children:[s.jsx(Rs,{className:"w-5 h-5"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-medium",children:"Profile & Preferences"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Manage your profile information and preferences"})]})]}),s.jsxs(le,{variant:"ghost",className:"w-full justify-start gap-3 h-12",onClick:()=>l("security-actions"),children:[s.jsx(gl,{className:"w-5 h-5"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-medium",children:"Security Actions"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Change password, email, and security settings"})]})]}),s.jsxs(le,{variant:"ghost",className:"w-full justify-start gap-3 h-12",onClick:()=>l("verification"),children:[s.jsx(dc,{className:"w-5 h-5"}),s.jsxs("div",{className:"text-left",children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:["Verification Status",k&&s.jsx("span",{className:"text-xs text-green-600",children:" Verified"})]}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Track your verification progress"})]})]})]}),s.jsx(ll,{}),s.jsxs(le,{variant:"destructive",className:"w-full gap-3 h-12",onClick:U,disabled:a,children:[s.jsx(EF,{className:"w-5 h-5"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-medium",children:a?"Signing out...":"Sign Out"}),s.jsx("div",{className:"text-sm opacity-80",children:a?"Please wait...":"Sign out of your account"})]})]})]}):o==="onboarding-preferences"?s.jsx(Mge,{onClose:q}):o==="verification"?s.jsx("div",{className:"p-4",children:(F==null?void 0:F.id)&&s.jsx(x9,{userId:F.id,accountType:N,verified:k})}):o==="security-actions"?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(gl,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Security Actions"})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your account security settings"})]}),s.jsx(ll,{}),n&&s.jsx("div",{className:"p-3 bg-muted/50 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Lk,{className:"w-4 h-4"}),s.jsxs("span",{children:["Current email: ",s.jsx("strong",{children:n})]})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[s.jsx(Lk,{className:"w-5 h-5"}),"Change Email Address"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Change your email address. You'll receive a confirmation email at the new address."}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx(Ht,{htmlFor:"new-email",children:"New Email Address"}),s.jsx(Ar,{id:"new-email",type:"email",placeholder:"Enter new email address",value:h,onChange:ne=>p(ne.target.value),disabled:u})]}),s.jsx(le,{onClick:Z,disabled:u||!h.trim(),className:"w-full",children:u?"Sending...":"Send Email Change Confirmation"})]})]}),s.jsx(ll,{}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[s.jsx(kF,{className:"w-5 h-5"}),"Reset Password"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Send a password reset link to your email address."}),s.jsx(le,{variant:"outline",onClick:K,disabled:c,className:"w-full",children:c?"Sending...":"Send Password Reset Email"})]}),s.jsx(ll,{}),s.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(yP,{className:"w-4 h-4 text-blue-600 mt-0.5"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"About Security Emails"}),s.jsx("p",{className:"text-blue-700",children:"All security emails are sent automatically and cannot be disabled for your account protection. Check your email (including spam folder) for confirmation links."})]})]})})]}):null]})})};function ug(){return s.jsx("div",{className:"bg-white rounded-xl p-4 border border-white/20 shadow-sm animate-pulse",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-100 to-pink-200 rounded-full flex items-center justify-center",children:s.jsx(ew,{size:"sm",className:"opacity-30 animate-breathe"})}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-3/4"}),s.jsx("div",{className:"h-3 bg-gradient-to-r from-pink-50 to-white rounded animate-pulse w-1/2"}),s.jsx("div",{className:"h-3 bg-gradient-to-r from-pink-50 to-white rounded animate-pulse w-1/4"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-pink-200 to-pink-300 rounded-full animate-pulse"}),s.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-gray-100 to-white rounded-full animate-pulse"})]})]})})}const Fge=({currentUserId:e,onBack:t,onNavigateToProfile:r,onNavigateToEvent:n,onNavigateToArtist:a,onNavigateToVenue:i})=>{const[o,l]=x.useState([]),[c,d]=x.useState(!0),[u,f]=x.useState(0),{toast:h}=Rr(),{sessionExpired:p}=xs();x.useEffect(()=>{if(p){d(!1);return}g()},[e,p]);const g=()=>E(void 0,null,function*(){try{if(p){console.log("Session expired, skipping notifications fetch"),d(!1);return}const[A,R]=yield Promise.all([uf.getNotifications({limit:50}),uf.getUnreadCount()]);l(A.notifications),f(R)}catch(A){console.error("Error fetching notifications:",A),h({title:"Error",description:"Failed to load notifications. Please try again.",variant:"destructive"}),l([]),f(0)}finally{d(!1)}}),v=A=>E(void 0,null,function*(){try{yield uf.markAsRead(A),l($=>$.map(O=>O.id===A?H(M({},O),{is_read:!0}):O));const R=yield uf.getUnreadCount();f(R)}catch(R){console.error("Error marking notification as read:",R),h({title:"Error",description:"Failed to mark notification as read",variant:"destructive"})}}),y=()=>E(void 0,null,function*(){try{yield uf.markAllAsRead(),yield g(),h({title:"All notifications marked as read",description:"You're all caught up!"})}catch(A){console.error("Error marking all notifications as read:",A),h({title:"Error",description:"Failed to mark all notifications as read",variant:"destructive"})}}),_=A=>E(void 0,null,function*(){var R;try{const{data:$,error:O}=yield T.from("user_relationships").select("status").eq("id",A).eq("relationship_type","friend").single();if(O){const z=O.message||"";if(O.code==="PGRST301"||O.code==="42501"||z.includes("406")||z.includes("Not Acceptable")){console.log(" RLS restriction, cannot check status directly");const{data:{user:D}}=yield T.auth.getUser();if(D){const{data:B}=yield T.from("notifications").select("data").eq("type","friend_request").eq("user_id",D.id).eq("data->>request_id",A).single();if((R=B==null?void 0:B.data)!=null&&R.sender_id){const F=B.data.sender_id,{data:U}=yield T.from("user_relationships").select("user_id, related_user_id, status").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${D.id},related_user_id.eq.${D.id}`);if(U&&U.length>0&&U.find(q=>q.user_id===D.id&&q.related_user_id===F||q.user_id===F&&q.related_user_id===D.id))return"accepted"}}return"unknown"}return console.log(" Request not found:",O),"not_found"}return($==null?void 0:$.status)||"not_found"}catch($){return console.error("Error checking friend request status:",$),"not_found"}}),w=A=>E(void 0,null,function*(){try{const{data:R,error:$}=yield T.from("notifications").select("id, data").eq("type","friend_request").eq("user_id",e);if($)throw console.error("Could not fetch notifications for deletion:",$),new Error(`Failed to fetch notifications: ${$.message}`);const O=(R==null?void 0:R.filter(B=>{var U;const F=(U=B.data)==null?void 0:U.request_id;return F==null||A==null?F===A:String(F)===String(A)}))||[];if(O.length===0){console.log("No matching notification found to delete");return}const z=O.map(B=>B.id),{error:D}=yield T.from("notifications").delete().in("id",z);if(D)throw console.error("Could not delete notification:",D),new Error(`Failed to delete notification: ${D.message}`);console.log(` Deleted ${z.length} friend request notification(s)`)}catch(R){throw console.error("Error deleting notification:",R),R}}),b=A=>E(void 0,null,function*(){var R,$,O,z;if(console.log(" Accepting friend request:",A),!A){h({title:"Error",description:"Invalid friend request. Please refresh and try again.",variant:"destructive"});return}try{const D=typeof A=="string"?A:String(A);console.log(" Converted request ID:",D);const{error:B}=yield T.rpc("accept_friend_request",{request_id:D});if(console.log(" Accept friend request result:",B),B){if(console.error("Error accepting friend request:",B),B.code==="23505"||(R=B.message)!=null&&R.includes("duplicate key")||($=B.message)!=null&&$.includes("unique constraint")){console.log(" Friendship already exists, treating as success"),l(F=>F.filter(U=>{var q;const G=(q=U.data)==null?void 0:q.request_id;return G==null||A==null?G!==A:String(G)!==String(A)}));try{yield w(A)}catch(F){console.error("Failed to delete notification, but continuing:",F)}yield new Promise(F=>setTimeout(F,500)),yield g(),h({title:"Already Friends! ",description:"You're already friends with this person."});return}if((O=B.message)!=null&&O.includes("not found")||(z=B.message)!=null&&z.includes("already processed")){const F=yield _(A);h(F==="accepted"?{title:"Already Friends! ",description:"You're already friends with this person."}:{title:"Request Already Processed",description:"This friend request has already been handled."}),l(U=>U.filter(G=>{var K;const q=(K=G.data)==null?void 0:K.request_id;return q==null||A==null?q!==A:String(q)!==String(A)}));try{yield w(A)}catch(U){console.error("Failed to delete notification, but continuing:",U)}yield new Promise(U=>setTimeout(U,500)),yield g();return}throw B}l(F=>F.filter(U=>{var q;const G=(q=U.data)==null?void 0:q.request_id;return G==null||A==null?G!==A:String(G)!==String(A)}));try{yield w(A)}catch(F){console.error("Failed to delete notification, but continuing:",F)}yield new Promise(F=>setTimeout(F,500)),yield g(),h({title:"Friend Request Accepted! ",description:"You're now friends!"})}catch(D){console.error("Error accepting friend request:",D),h({title:"Error",description:D.message||"Failed to accept friend request. Please try again.",variant:"destructive"})}}),N=A=>E(void 0,null,function*(){var R,$;if(console.log(" Declining friend request:",A),!A){h({title:"Error",description:"Invalid friend request. Please refresh and try again.",variant:"destructive"});return}console.log(" Debug: Declining friend request with ID:",A);try{const{error:O}=yield T.rpc("decline_friend_request",{request_id:A});if(console.log(" Decline friend request result:",O),O){if(console.error("Error declining friend request:",O),(R=O.message)!=null&&R.includes("not found")||($=O.message)!=null&&$.includes("already processed")){h({title:"Request Already Processed",description:"This friend request has already been handled.",variant:"destructive"}),l(z=>z.filter(D=>{var F;const B=(F=D.data)==null?void 0:F.request_id;return B==null||A==null?B!==A:String(B)!==String(A)}));try{yield w(A)}catch(z){console.error("Failed to delete notification, but continuing:",z)}yield new Promise(z=>setTimeout(z,500)),yield g();return}throw O}l(z=>z.filter(D=>{var F;const B=(F=D.data)==null?void 0:F.request_id;return B==null||A==null?B!==A:String(B)!==String(A)}));try{yield w(A)}catch(z){console.error("Failed to delete notification, but continuing:",z)}yield new Promise(z=>setTimeout(z,500)),yield g(),h({title:"Friend Request Declined",description:"The friend request has been declined."})}catch(O){console.error("Error declining friend request:",O),h({title:"Error",description:O.message||"Failed to decline friend request. Please try again.",variant:"destructive"})}}),S=A=>{switch(A){case"friend_request":return s.jsx(Ad,{className:"w-4 h-4"});case"event_interest":return s.jsx(ns,{className:"w-4 h-4"});case"review_like":return s.jsx(Qt,{className:"w-4 h-4"});case"review_comment":return s.jsx($n,{className:"w-4 h-4"});case"event_reminder":return s.jsx(It,{className:"w-4 h-4"});default:return s.jsx(Ld,{className:"w-4 h-4"})}},k=A=>{const R=new Date(A),O=Math.floor((new Date().getTime()-R.getTime())/(1e3*60));return O<1?"Just now":O<60?`${O}m ago`:O<1440?`${Math.floor(O/60)}h ago`:`${Math.floor(O/1440)}d ago`},P=A=>E(void 0,null,function*(){if(A.type==="friend_request"){yield v(A.id);return}v(A.id);const R=A.data;switch(A.type){case"artist_new_event":case"artist_profile_updated":R!=null&&R.event_id&&n?n(R.event_id):R!=null&&R.artist_id&&a?a(R.artist_id):A.artist_name&&a&&a(A.artist_name);break;case"venue_new_event":case"venue_profile_updated":A.venue_name&&i?i(A.venue_name):R!=null&&R.venue_name&&i&&i(R.venue_name),R!=null&&R.event_id&&n&&n(R.event_id);break;case"event_interest":case"event_attendance_reminder":case"event_reminder":case"friend_rsvp_going":case"friend_rsvp_changed":case"friend_review_posted":case"friend_attended_same_event":R!=null&&R.event_id&&n?n(R.event_id):A.event_title&&console.log("Navigate to event:",A.event_title);break;case"friend_request":case"friend_accepted":R!=null&&R.sender_id&&r?r(R.sender_id):R!=null&&R.friend_id&&r?r(R.friend_id):A.actor_user_id&&r&&r(A.actor_user_id);break;case"review_liked":case"review_commented":case"comment_replied":if(R!=null&&R.event_id&&n)n(R.event_id);else if(A.review_id)try{const{data:$}=yield T.from("reviews").select("event_id").eq("id",A.review_id).single();$!=null&&$.event_id&&n&&n($.event_id)}catch($){console.error("Error fetching review event:",$)}break}});return c?s.jsx("div",{className:"min-h-screen synth-gradient-card p-4 pb-20",children:s.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[s.jsx("div",{className:"glass-card inner-glow text-center space-y-3 p-4 mb-6 floating-shadow",children:s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx(ew,{size:"md",className:"hover-icon animate-breathe"}),s.jsx("div",{className:"h-8 bg-gray-200 rounded animate-pulse w-36"})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(ug,{}),s.jsx(ug,{}),s.jsx(ug,{}),s.jsx(ug,{}),s.jsx(ug,{})]})]})}):s.jsx("div",{className:"min-h-screen synth-gradient-card p-4 pb-20",children:s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsx("div",{className:"glass-card inner-glow text-center space-y-3 p-4 mb-6 floating-shadow",children:s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx(le,{variant:"ghost",size:"sm",onClick:t,className:"hover-button absolute left-4",children:s.jsx(Cs,{className:"w-4 h-4 hover-icon"})}),s.jsx(ew,{size:"md",className:"hover-icon"}),s.jsx("h1",{className:"gradient-text text-2xl font-bold",children:"Notifications"}),u>0&&s.jsxs(Ke,{variant:"default",className:"gradient-badge",children:[u," unread"]})]})}),o.length>0&&u>0&&s.jsx("div",{className:"glass-card inner-glow p-4 mb-6 floating-shadow",children:s.jsxs(le,{variant:"outline",size:"sm",onClick:y,className:"hover-button w-full border-gray-200 hover:border-pink-400 hover:text-pink-500",children:[s.jsx(ta,{className:"w-4 h-4 mr-2 hover-icon"}),"Mark all as read"]})}),o.length===0?s.jsx(He,{className:"glass-card inner-glow floating-shadow",children:s.jsxs(et,{className:"text-center py-12",children:[s.jsx(Ld,{className:"w-12 h-12 mx-auto mb-4 hover-icon",style:{background:"linear-gradient(135deg, #ec4899, #f472b6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}}),s.jsx("h3",{className:"text-lg font-semibold mb-2 gradient-text",children:"No notifications yet"}),s.jsx("p",{className:"text-gray-500",children:"When you get friend requests, event updates, or review activity, they'll appear here."})]})}):s.jsx("div",{className:"space-y-3",children:o.map(A=>s.jsx(He,{className:`glass-card inner-glow hover-card cursor-pointer floating-shadow ${A.is_read?"":"border-pink-300"}`,onClick:()=>P(A),children:s.jsx(et,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 hover-icon",children:J.cloneElement(S(A.type),{style:{background:"linear-gradient(135deg, #ec4899, #f472b6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h4",{className:"font-semibold text-sm truncate gradient-text",children:A.title}),!A.is_read&&s.jsx("div",{className:"w-2 h-2 gradient-badge rounded-full flex-shrink-0"})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:A.message}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-500 bg-white/30 px-2 py-1 rounded backdrop-blur-sm",children:k(A.created_at)}),A.type==="friend_request"&&s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{size:"sm",variant:"default",className:"hover-button gradient-button h-6 px-2",onClick:R=>E(void 0,null,function*(){var $;R.stopPropagation(),R.preventDefault(),yield b(($=A.data)==null?void 0:$.request_id)}),children:[s.jsx(ta,{className:"w-3 h-3 mr-1 hover-icon"}),"Accept"]}),s.jsxs(le,{size:"sm",variant:"outline",className:"hover-button h-6 px-2 border-gray-200 hover:border-red-400 hover:text-red-500",onClick:R=>E(void 0,null,function*(){var $;R.stopPropagation(),R.preventDefault(),yield N(($=A.data)==null?void 0:$.request_id)}),children:[s.jsx(Gr,{className:"w-3 h-3 mr-1 hover-icon"}),"Decline"]})]})]})]})]})})},A.id))})]})})};class h_{static createEvent(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{MissingEntityRequestService:a}=yield kn(()=>E(this,null,function*(){const{MissingEntityRequestService:o}=yield import("./missingEntityRequestService-U8rBFeto.js");return{MissingEntityRequestService:o}}),[],import.meta.url);return{id:(yield a.submitRequest({entity_type:"event",entity_name:t.title,entity_description:t.artist_name&&t.venue_name?`${t.artist_name} at ${t.venue_name}`:void 0,entity_date:t.event_date,entity_location:t.venue_name,entity_image_url:t.poster_image_url,additional_info:{artist_name:t.artist_name,venue_name:t.venue_name,latitude:t.latitude,longitude:t.longitude,video_url:t.video_url,age_restriction:t.age_restriction,accessibility_info:t.accessibility_info,parking_info:t.parking_info,venue_capacity:t.venue_capacity,estimated_attendance:t.estimated_attendance,media_urls:t.media_urls}})).id,title:t.title,status:"pending",message:"Your event request has been submitted for review."}}catch(r){throw console.error("Error submitting event request:",r),r}})}static getMyCreatedEvents(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{data:n,error:a}=yield T.from("events").select("*").eq("created_by_user_id",t.id).order("created_at",{ascending:!1});if(a)throw a;return n||[]}catch(t){throw console.error("Error fetching created events:",t),t}})}static updateEvent(t,r){return E(this,null,function*(){try{const{data:{user:n},error:a}=yield T.auth.getUser();if(a||!n)throw new Error("User not authenticated");const{data:i,error:o}=yield T.from("events").select("created_by_user_id").eq("id",t).single();if(o)throw o;if(i.created_by_user_id!==n.id)throw new Error("You can only update events you created");const{data:l,error:c}=yield T.from("events").update(H(M({},r),{updated_at:new Date().toISOString()})).eq("id",t).select().single();if(c)throw c;return l}catch(n){throw console.error("Error updating event:",n),n}})}static deleteEvent(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield T.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:a,error:i}=yield T.from("events").select("created_by_user_id").eq("id",t).single();if(i)throw i;if(a.created_by_user_id!==r.id)throw new Error("You can only delete events you created");const{error:o}=yield T.from("events").delete().eq("id",t);if(o)throw o}catch(r){throw console.error("Error deleting event:",r),r}})}static canCreateEvents(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield T.auth.getUser();if(r||!t)return!1;const{data:n,error:a}=yield T.from("users").select("account_type").eq("user_id",t.id).single();return a?!1:["business","creator","admin"].includes(n.account_type)}catch(t){return console.error("Error checking create permissions:",t),!1}})}}function zge({open:e,onClose:t,onEventCreated:r,prefilledData:n}){const[a,i]=x.useState(!1),[o,l]=x.useState(M({title:"",artist_name:"",venue_name:"",event_date:"",latitude:void 0,longitude:void 0,poster_image_url:"",video_url:"",age_restriction:"",accessibility_info:"",parking_info:"",venue_capacity:void 0,estimated_attendance:void 0,media_urls:[]},n)),{toast:c}=Rr(),d=(h,p)=>{l(g=>H(M({},g),{[h]:p}))},u=h=>E(this,null,function*(){if(h.preventDefault(),!o.title.trim()){c({title:"Title required",description:"Please enter an event title.",variant:"destructive"});return}i(!0);try{const p=yield h_.createEvent(o);c({title:"Event created!",description:"Your event has been created successfully."}),r==null||r(p),f()}catch(p){console.error("Error creating event:",p),c({title:"Creation failed",description:p instanceof Error?p.message:"Failed to create event",variant:"destructive"})}finally{i(!1)}}),f=()=>{a||(l(M({title:"",artist_name:"",venue_name:"",event_date:"",latitude:void 0,longitude:void 0,poster_image_url:"",video_url:"",age_restriction:"",accessibility_info:"",parking_info:"",venue_capacity:void 0,estimated_attendance:void 0,media_urls:[]},n)),t())};return s.jsx(pn,{open:e,onOpenChange:f,children:s.jsxs(dn,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[s.jsxs(Vn,{children:[s.jsxs(bn,{className:"flex items-center gap-2",children:[s.jsx(It,{className:"h-5 w-5 text-purple-600"}),"Create New Event"]}),s.jsx(os,{children:"Create a new event for your audience. Fill in the details below."})]}),s.jsxs("form",{onSubmit:u,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx($t,{className:"h-5 w-5"}),"Basic Information"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"title",children:"Event Title *"}),s.jsx(Ar,{id:"title",value:o.title,onChange:h=>d("title",h.target.value),placeholder:"e.g., Summer Music Festival 2024",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"artist_name",children:"Artist/Performer"}),s.jsx(Ar,{id:"artist_name",value:o.artist_name||"",onChange:h=>d("artist_name",h.target.value),placeholder:"e.g., The Rolling Stones"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"venue_name",children:"Venue"}),s.jsx(Ar,{id:"venue_name",value:o.venue_name||"",onChange:h=>d("venue_name",h.target.value),placeholder:"e.g., Madison Square Garden"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"event_date",children:"Event Date & Time"}),s.jsx(Ar,{id:"event_date",type:"datetime-local",value:o.event_date||"",onChange:h=>d("event_date",h.target.value)})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(gr,{className:"h-5 w-5"}),"Location Details"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"latitude",children:"Latitude"}),s.jsx(Ar,{id:"latitude",type:"number",step:"any",value:o.latitude||"",onChange:h=>d("latitude",h.target.value?parseFloat(h.target.value):void 0),placeholder:"40.7128"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"longitude",children:"Longitude"}),s.jsx(Ar,{id:"longitude",type:"number",step:"any",value:o.longitude||"",onChange:h=>d("longitude",h.target.value?parseFloat(h.target.value):void 0),placeholder:"-74.0060"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(zr,{className:"h-5 w-5"}),"Additional Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"venue_capacity",children:"Venue Capacity"}),s.jsx(Ar,{id:"venue_capacity",type:"number",value:o.venue_capacity||"",onChange:h=>d("venue_capacity",h.target.value?parseInt(h.target.value):void 0),placeholder:"5000"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"estimated_attendance",children:"Estimated Attendance"}),s.jsx(Ar,{id:"estimated_attendance",type:"number",value:o.estimated_attendance||"",onChange:h=>d("estimated_attendance",h.target.value?parseInt(h.target.value):void 0),placeholder:"3000"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"age_restriction",children:"Age Restriction"}),s.jsx(Ar,{id:"age_restriction",value:o.age_restriction||"",onChange:h=>d("age_restriction",h.target.value),placeholder:"e.g., 18+, All Ages, 21+"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"accessibility_info",children:"Accessibility Information"}),s.jsx(ys,{id:"accessibility_info",value:o.accessibility_info||"",onChange:h=>d("accessibility_info",h.target.value),placeholder:"Information about accessibility features...",rows:3})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"parking_info",children:"Parking Information"}),s.jsx(ys,{id:"parking_info",value:o.parking_info||"",onChange:h=>d("parking_info",h.target.value),placeholder:"Information about parking options...",rows:3})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx($t,{className:"h-5 w-5"}),"Media"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"poster_image_url",children:"Poster Image URL"}),s.jsx(Ar,{id:"poster_image_url",value:o.poster_image_url||"",onChange:h=>d("poster_image_url",h.target.value),placeholder:"https://example.com/poster.jpg"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"video_url",children:"Video URL"}),s.jsx(Ar,{id:"video_url",value:o.video_url||"",onChange:h=>d("video_url",h.target.value),placeholder:"https://youtube.com/watch?v=..."})]})]})]}),s.jsxs(Nh,{children:[s.jsx(le,{type:"button",variant:"outline",onClick:f,disabled:a,children:"Cancel"}),s.jsx(le,{type:"submit",onClick:u,disabled:a,className:"bg-purple-600 hover:bg-purple-700",children:a?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(It,{className:"w-4 h-4 mr-2"}),"Create Event"]})})]})]})})}function Bge(){ih();const{toast:e}=Rr(),[t,r]=x.useState([]),[n,a]=x.useState(!0),[i,o]=x.useState(!1),[l,c]=x.useState(!1);ih(),x.useEffect(()=>{d(),u()},[]);const d=()=>E(this,null,function*(){try{a(!0);const y=yield h_.getMyCreatedEvents();r(y)}catch(y){console.error("Error loading events:",y),e({title:"Error loading events",description:"Failed to load your created events.",variant:"destructive"})}finally{a(!1)}}),u=()=>E(this,null,function*(){try{const y=yield h_.canCreateEvents();c(y)}catch(y){console.error("Error checking permissions:",y),c(!1)}}),f=y=>{r(_=>[y,..._])},h=y=>E(this,null,function*(){if(confirm("Are you sure you want to delete this event? This action cannot be undone."))try{yield h_.deleteEvent(y),r(_=>_.filter(w=>w.id!==y)),e({title:"Event deleted",description:"The event has been deleted successfully."})}catch(_){console.error("Error deleting event:",_),e({title:"Delete failed",description:_ instanceof Error?_.message:"Failed to delete event",variant:"destructive"})}}),p=y=>new Date(y).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),g=y=>new Date(y).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),v=({event:y})=>s.jsxs(He,{className:"hover:shadow-lg transition-shadow",children:[s.jsx(Er,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx(qr,{className:"text-lg mb-2",children:y.title}),y.artist_name&&s.jsx("p",{className:"text-purple-600 font-medium mb-1",children:y.artist_name}),y.venue_name&&s.jsxs("div",{className:"flex items-center gap-1 text-gray-600 text-sm",children:[s.jsx(gr,{className:"h-4 w-4"}),s.jsx("span",{children:y.venue_name})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{variant:"outline",size:"sm",onClick:()=>{e({title:"Edit Event",description:"Event editing features coming soon!"})},children:s.jsx(_c,{className:"h-4 w-4"})}),s.jsx(le,{variant:"outline",size:"sm",onClick:()=>h(y.id),className:"text-red-600 hover:text-red-700 hover:border-red-300",children:s.jsx(Dl,{className:"h-4 w-4"})})]})]})}),s.jsx(et,{className:"pt-0",children:s.jsxs("div",{className:"space-y-2",children:[y.event_date&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(It,{className:"h-4 w-4"}),s.jsx("span",{children:p(y.event_date)}),s.jsx(ga,{className:"h-4 w-4 ml-2"}),s.jsx("span",{children:g(y.event_date)})]}),(y.venue_capacity||y.estimated_attendance)&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(zr,{className:"h-4 w-4"}),y.venue_capacity&&s.jsxs("span",{children:["Capacity: ",y.venue_capacity.toLocaleString()]}),y.venue_capacity&&y.estimated_attendance&&s.jsx("span",{children:""}),y.estimated_attendance&&s.jsxs("span",{children:["Est. Attendance: ",y.estimated_attendance.toLocaleString()]})]}),y.age_restriction&&s.jsx(Ke,{variant:"outline",className:"text-xs",children:y.age_restriction})]})})]});return l?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Events"}),s.jsx("p",{className:"text-gray-600",children:"Manage your created events"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{variant:"outline",onClick:d,disabled:n,children:[s.jsx(mi,{className:`h-4 w-4 mr-2 ${n?"animate-spin":""}`}),"Refresh"]}),s.jsxs(le,{onClick:()=>o(!0),children:[s.jsx(Vo,{className:"h-4 w-4 mr-2"}),"Create Event"]})]})]})}),n?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(lr,{className:"h-8 w-8 animate-spin text-purple-600"})}):s.jsx("div",{className:"space-y-4",children:t.length===0?s.jsx(He,{children:s.jsxs(et,{className:"py-12 text-center",children:[s.jsx(It,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"You haven't created any events yet"}),s.jsxs(le,{onClick:()=>o(!0),children:[s.jsx(Vo,{className:"h-4 w-4 mr-2"}),"Create Your First Event"]})]})}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(It,{className:"h-5 w-5"}),"Created Events (",t.length,")"]})}),s.jsx("div",{className:"space-y-3",children:t.map(y=>s.jsx(v,{event:y},y.id))})]})}),s.jsx(zge,{open:i,onClose:()=>o(!1),onEventCreated:f})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsx("div",{className:"max-w-4xl mx-auto",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"My Events"}),s.jsx("p",{className:"text-gray-600 mb-8",children:"Only business, creator, and admin accounts can create events."}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-blue-900 mb-2",children:"What you can do:"}),s.jsxs("ul",{className:"text-blue-800 space-y-1",children:[s.jsx("li",{children:" Express interest in events"}),s.jsx("li",{children:" Meet people going to the same events"}),s.jsx("li",{children:" Chat with matched users"}),s.jsx("li",{children:" Leave reviews and ratings"})]})]})]})})})}const Uge=lp("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),YT=x.forwardRef((a,n)=>{var i=a,{className:e,variant:t}=i,r=me(i,["className","variant"]);return s.jsx("div",M({ref:n,role:"alert",className:ke(Uge({variant:t}),e)},r))});YT.displayName="Alert";const qge=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx("h5",M({ref:r,className:ke("mb-1 font-medium leading-none tracking-tight",e)},t))});qge.displayName="AlertTitle";const KT=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx("div",M({ref:r,className:ke("text-sm [&_p]:leading-relaxed",e)},t))});KT.displayName="AlertDescription";const V5="onboarding_reminder_dismissed",Vge=3*24*60*60*1e3,Wge=({onComplete:e})=>{const[t,r]=x.useState(!1);x.useEffect(()=>{const i=localStorage.getItem(V5);if(i){const o=parseInt(i,10);if(Date.now()-o<Vge)return}r(!0)},[]);const n=()=>{localStorage.setItem(V5,Date.now().toString()),r(!1)},a=()=>{r(!1),e()};return t?s.jsx(YT,{className:"rounded-none border-x-0 border-t-0 bg-gradient-to-r from-primary/10 to-accent/10",children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs(KT,{className:"flex-1 text-sm",children:[s.jsx("strong",{className:"font-semibold",children:"Complete your profile"})," to get personalized event recommendations and connect with people who share your music taste."]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(le,{size:"sm",onClick:a,children:"Complete Profile"}),s.jsxs(le,{size:"sm",variant:"ghost",onClick:n,className:"h-8 w-8 p-0",children:[s.jsx(Gr,{className:"w-4 h-4"}),s.jsx("span",{className:"sr-only",children:"Dismiss"})]})]})]})}):null};function _V(e){return t=>typeof t===e}var Hge=_V("function"),Gge=e=>e===null,W5=e=>Object.prototype.toString.call(e).slice(8,-1)==="RegExp",H5=e=>!Yge(e)&&!Gge(e)&&(Hge(e)||typeof e=="object"),Yge=_V("undefined");function Kge(e,t){const{length:r}=e;if(r!==t.length)return!1;for(let n=r;n--!==0;)if(!Ua(e[n],t[n]))return!1;return!0}function Zge(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new DataView(e.buffer),n=new DataView(t.buffer);let a=e.byteLength;for(;a--;)if(r.getUint8(a)!==n.getUint8(a))return!1;return!0}function Xge(e,t){if(e.size!==t.size)return!1;for(const r of e.entries())if(!t.has(r[0]))return!1;for(const r of e.entries())if(!Ua(r[1],t.get(r[0])))return!1;return!0}function Jge(e,t){if(e.size!==t.size)return!1;for(const r of e.entries())if(!t.has(r[0]))return!1;return!0}function Ua(e,t){if(e===t)return!0;if(e&&H5(e)&&t&&H5(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return Kge(e,t);if(e instanceof Map&&t instanceof Map)return Xge(e,t);if(e instanceof Set&&t instanceof Set)return Jge(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return Zge(e,t);if(W5(e)&&W5(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let a=r.length;a--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[a]))return!1;for(let a=r.length;a--!==0;){const i=r[a];if(!(i==="_owner"&&e.$$typeof)&&!Ua(e[i],t[i]))return!1}return!0}return Number.isNaN(e)&&Number.isNaN(t)?!0:e===t}var Qge=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],eve=["bigint","boolean","null","number","string","symbol","undefined"];function F1(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(/HTML\w+Element/.test(t))return"HTMLElement";if(tve(t))return t}function Jo(e){return t=>F1(t)===e}function tve(e){return Qge.includes(e)}function _p(e){return t=>typeof t===e}function rve(e){return eve.includes(e)}var nve=["innerHTML","ownerDocument","style","attributes","nodeValue"];function Wt(e){if(e===null)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(Wt.array(e))return"Array";if(Wt.plainFunction(e))return"Function";const t=F1(e);return t||"Object"}Wt.array=Array.isArray;Wt.arrayOf=(e,t)=>!Wt.array(e)&&!Wt.function(t)?!1:e.every(r=>t(r));Wt.asyncGeneratorFunction=e=>F1(e)==="AsyncGeneratorFunction";Wt.asyncFunction=Jo("AsyncFunction");Wt.bigint=_p("bigint");Wt.boolean=e=>e===!0||e===!1;Wt.date=Jo("Date");Wt.defined=e=>!Wt.undefined(e);Wt.domElement=e=>Wt.object(e)&&!Wt.plainObject(e)&&e.nodeType===1&&Wt.string(e.nodeName)&&nve.every(t=>t in e);Wt.empty=e=>Wt.string(e)&&e.length===0||Wt.array(e)&&e.length===0||Wt.object(e)&&!Wt.map(e)&&!Wt.set(e)&&Object.keys(e).length===0||Wt.set(e)&&e.size===0||Wt.map(e)&&e.size===0;Wt.error=Jo("Error");Wt.function=_p("function");Wt.generator=e=>Wt.iterable(e)&&Wt.function(e.next)&&Wt.function(e.throw);Wt.generatorFunction=Jo("GeneratorFunction");Wt.instanceOf=(e,t)=>!e||!t?!1:Object.getPrototypeOf(e)===t.prototype;Wt.iterable=e=>!Wt.nullOrUndefined(e)&&Wt.function(e[Symbol.iterator]);Wt.map=Jo("Map");Wt.nan=e=>Number.isNaN(e);Wt.null=e=>e===null;Wt.nullOrUndefined=e=>Wt.null(e)||Wt.undefined(e);Wt.number=e=>_p("number")(e)&&!Wt.nan(e);Wt.numericString=e=>Wt.string(e)&&e.length>0&&!Number.isNaN(Number(e));Wt.object=e=>!Wt.nullOrUndefined(e)&&(Wt.function(e)||typeof e=="object");Wt.oneOf=(e,t)=>Wt.array(e)?e.indexOf(t)>-1:!1;Wt.plainFunction=Jo("Function");Wt.plainObject=e=>{if(F1(e)!=="Object")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.getPrototypeOf({})};Wt.primitive=e=>Wt.null(e)||rve(typeof e);Wt.promise=Jo("Promise");Wt.propertyOf=(e,t,r)=>{if(!Wt.object(e)||!t)return!1;const n=e[t];return Wt.function(r)?r(n):Wt.defined(n)};Wt.regexp=Jo("RegExp");Wt.set=Jo("Set");Wt.string=_p("string");Wt.symbol=_p("symbol");Wt.undefined=_p("undefined");Wt.weakMap=Jo("WeakMap");Wt.weakSet=Jo("WeakSet");var Jt=Wt;function sve(...e){return e.every(t=>Jt.string(t)||Jt.array(t)||Jt.plainObject(t))}function ave(e,t,r){return wV(e,t)?[e,t].every(Jt.array)?!e.some(X5(r))&&t.some(X5(r)):[e,t].every(Jt.plainObject)?!Object.entries(e).some(Z5(r))&&Object.entries(t).some(Z5(r)):t===r:!1}function G5(e,t,r){const{actual:n,key:a,previous:i,type:o}=r,l=bl(e,a),c=bl(t,a);let d=[l,c].every(Jt.number)&&(o==="increased"?l<c:l>c);return Jt.undefined(n)||(d=d&&c===n),Jt.undefined(i)||(d=d&&l===i),d}function Y5(e,t,r){const{key:n,type:a,value:i}=r,o=bl(e,n),l=bl(t,n),c=a==="added"?o:l,d=a==="added"?l:o;if(!Jt.nullOrUndefined(i)){if(Jt.defined(c)){if(Jt.array(c)||Jt.plainObject(c))return ave(c,d,i)}else return Ua(d,i);return!1}return[o,l].every(Jt.array)?!d.every(ZT(c)):[o,l].every(Jt.plainObject)?ive(Object.keys(c),Object.keys(d)):![o,l].every(u=>Jt.primitive(u)&&Jt.defined(u))&&(a==="added"?!Jt.defined(o)&&Jt.defined(l):Jt.defined(o)&&!Jt.defined(l))}function K5(e,t,{key:r}={}){let n=bl(e,r),a=bl(t,r);if(!wV(n,a))throw new TypeError("Inputs have different types");if(!sve(n,a))throw new TypeError("Inputs don't have length");return[n,a].every(Jt.plainObject)&&(n=Object.keys(n),a=Object.keys(a)),[n,a]}function Z5(e){return([t,r])=>Jt.array(e)?Ua(e,r)||e.some(n=>Ua(n,r)||Jt.array(r)&&ZT(r)(n)):Jt.plainObject(e)&&e[t]?!!e[t]&&Ua(e[t],r):Ua(e,r)}function ive(e,t){return t.some(r=>!e.includes(r))}function X5(e){return t=>Jt.array(e)?e.some(r=>Ua(r,t)||Jt.array(t)&&ZT(t)(r)):Ua(e,t)}function hg(e,t){return Jt.array(e)?e.some(r=>Ua(r,t)):Ua(e,t)}function ZT(e){return t=>e.some(r=>Ua(r,t))}function wV(...e){return e.every(Jt.array)||e.every(Jt.number)||e.every(Jt.plainObject)||e.every(Jt.string)}function bl(e,t){return Jt.plainObject(e)||Jt.array(e)?Jt.string(t)?t.split(".").reduce((n,a)=>n&&n[a],e):Jt.number(t)?e[t]:e:e}function fw(e,t){if([e,t].some(Jt.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every(u=>Jt.plainObject(u)||Jt.array(u)))throw new Error("Expected plain objects or array");return{added:(u,f)=>{try{return Y5(e,t,{key:u,type:"added",value:f})}catch(h){return!1}},changed:(u,f,h)=>{try{const p=bl(e,u),g=bl(t,u),v=Jt.defined(f),y=Jt.defined(h);if(v||y){const _=y?hg(h,p):!hg(f,p),w=hg(f,g);return _&&w}return[p,g].every(Jt.array)||[p,g].every(Jt.plainObject)?!Ua(p,g):p!==g}catch(p){return!1}},changedFrom:(u,f,h)=>{if(!Jt.defined(u))return!1;try{const p=bl(e,u),g=bl(t,u),v=Jt.defined(h);return hg(f,p)&&(v?hg(h,g):!v)}catch(p){return!1}},decreased:(u,f,h)=>{if(!Jt.defined(u))return!1;try{return G5(e,t,{key:u,actual:f,previous:h,type:"decreased"})}catch(p){return!1}},emptied:u=>{try{const[f,h]=K5(e,t,{key:u});return!!f.length&&!h.length}catch(f){return!1}},filled:u=>{try{const[f,h]=K5(e,t,{key:u});return!f.length&&!!h.length}catch(f){return!1}},increased:(u,f,h)=>{if(!Jt.defined(u))return!1;try{return G5(e,t,{key:u,actual:f,previous:h,type:"increased"})}catch(p){return!1}},removed:(u,f)=>{try{return Y5(e,t,{key:u,type:"removed",value:f})}catch(h){return!1}}}}var ove=new Error("Element already at target scroll position"),lve=new Error("Scroll cancelled"),cve=Math.min,J5=Date.now,dve={left:Q5("scrollLeft"),top:Q5("scrollTop")};function Q5(e){return function(r,n,a,i){a=a||{},typeof a=="function"&&(i=a,a={}),typeof i!="function"&&(i=hve);var o=J5(),l=r[e],c=a.ease||uve,d=isNaN(a.duration)?350:+a.duration,u=!1;return l===n?i(ove,r[e]):requestAnimationFrame(h),f;function f(){u=!0}function h(p){if(u)return i(lve,r[e]);var g=J5(),v=cve(1,(g-o)/d),y=c(v);r[e]=y*(n-l)+l,v<1?requestAnimationFrame(h):requestAnimationFrame(function(){i(null,r[e])})}}}function uve(e){return .5*(1-Math.cos(Math.PI*e))}function hve(){}const fve=yn(dve);var bV={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.Scrollparent=r()})(na,function(){function t(n){var a=getComputedStyle(n,null).getPropertyValue("overflow");return a.indexOf("scroll")>-1||a.indexOf("auto")>-1}function r(n){if(n instanceof HTMLElement||n instanceof SVGElement){for(var a=n.parentNode;a.parentNode;){if(t(a))return a;a=a.parentNode}return document.scrollingElement||document.documentElement}}return r})})(bV);var mve=bV.exports;const jV=yn(mve);var pve=function(e){return Object.prototype.hasOwnProperty.call(e,"props")},gve=function(e,t){return e+Uv(t)},Uv=function(e){return e===null||typeof e=="boolean"||typeof e=="undefined"?"":typeof e=="number"?e.toString():typeof e=="string"?e:Array.isArray(e)?e.reduce(gve,""):pve(e)&&Object.prototype.hasOwnProperty.call(e.props,"children")?Uv(e.props.children):""};Uv.default=Uv;var vve=Uv;const e4=yn(vve);var yve=function(t){return xve(t)&&!_ve(t)};function xve(e){return!!e&&typeof e=="object"}function _ve(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||jve(e)}var wve=typeof Symbol=="function"&&Symbol.for,bve=wve?Symbol.for("react.element"):60103;function jve(e){return e.$$typeof===bve}function Nve(e){return Array.isArray(e)?[]:{}}function qv(e,t){return t.clone!==!1&&t.isMergeableObject(e)?km(Nve(e),e,t):e}function Sve(e,t,r){return e.concat(t).map(function(n){return qv(n,r)})}function kve(e,t){if(!t.customMerge)return km;var r=t.customMerge(e);return typeof r=="function"?r:km}function Eve(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}function t4(e){return Object.keys(e).concat(Eve(e))}function NV(e,t){try{return t in e}catch(r){return!1}}function Cve(e,t){return NV(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function Pve(e,t,r){var n={};return r.isMergeableObject(e)&&t4(e).forEach(function(a){n[a]=qv(e[a],r)}),t4(t).forEach(function(a){Cve(e,a)||(NV(e,a)&&r.isMergeableObject(t[a])?n[a]=kve(a,r)(e[a],t[a],r):n[a]=qv(t[a],r))}),n}function km(e,t,r){r=r||{},r.arrayMerge=r.arrayMerge||Sve,r.isMergeableObject=r.isMergeableObject||yve,r.cloneUnlessOtherwiseSpecified=qv;var n=Array.isArray(t),a=Array.isArray(e),i=n===a;return i?n?r.arrayMerge(e,t,r):Pve(e,t,r):qv(t,r)}km.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(n,a){return km(n,a,r)},{})};var Tve=km,Ave=Tve;const $o=yn(Ave);var SV={exports:{}},Rve="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ove=Rve,Mve=Ove;function kV(){}function EV(){}EV.resetWarningCache=kV;var Dve=function(){function e(n,a,i,o,l,c){if(c!==Mve){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:EV,resetWarningCache:kV};return r.PropTypes=r,r};SV.exports=Dve();var Ive=SV.exports;const nt=yn(Ive);/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.16.1
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ox=typeof window!="undefined"&&typeof document!="undefined"&&typeof navigator!="undefined",$ve=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(ox&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}();function Lve(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then(function(){t=!1,e()}))}}function Fve(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},$ve))}}var zve=ox&&window.Promise,Bve=zve?Lve:Fve;function CV(e){var t={};return e&&t.toString.call(e)==="[object Function]"}function Ph(e,t){if(e.nodeType!==1)return[];var r=e.ownerDocument.defaultView,n=r.getComputedStyle(e,null);return t?n[t]:n}function XT(e){return e.nodeName==="HTML"?e:e.parentNode||e.host}function lx(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=Ph(e),r=t.overflow,n=t.overflowX,a=t.overflowY;return/(auto|scroll|overlay)/.test(r+a+n)?e:lx(XT(e))}function PV(e){return e&&e.referenceNode?e.referenceNode:e}var r4=ox&&!!(window.MSInputMethodContext&&document.documentMode),n4=ox&&/MSIE 10/.test(navigator.userAgent);function wp(e){return e===11?r4:e===10?n4:r4||n4}function Em(e){if(!e)return document.documentElement;for(var t=wp(10)?document.body:null,r=e.offsetParent||null;r===t&&e.nextElementSibling;)r=(e=e.nextElementSibling).offsetParent;var n=r&&r.nodeName;return!n||n==="BODY"||n==="HTML"?e?e.ownerDocument.documentElement:document.documentElement:["TH","TD","TABLE"].indexOf(r.nodeName)!==-1&&Ph(r,"position")==="static"?Em(r):r}function Uve(e){var t=e.nodeName;return t==="BODY"?!1:t==="HTML"||Em(e.firstElementChild)===e}function A2(e){return e.parentNode!==null?A2(e.parentNode):e}function mw(e,t){if(!e||!e.nodeType||!t||!t.nodeType)return document.documentElement;var r=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,n=r?e:t,a=r?t:e,i=document.createRange();i.setStart(n,0),i.setEnd(a,0);var o=i.commonAncestorContainer;if(e!==o&&t!==o||n.contains(a))return Uve(o)?o:Em(o);var l=A2(e);return l.host?mw(l.host,t):mw(e,A2(t).host)}function Cm(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top",r=t==="top"?"scrollTop":"scrollLeft",n=e.nodeName;if(n==="BODY"||n==="HTML"){var a=e.ownerDocument.documentElement,i=e.ownerDocument.scrollingElement||a;return i[r]}return e[r]}function qve(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=Cm(t,"top"),a=Cm(t,"left"),i=r?-1:1;return e.top+=n*i,e.bottom+=n*i,e.left+=a*i,e.right+=a*i,e}function s4(e,t){var r=t==="x"?"Left":"Top",n=r==="Left"?"Right":"Bottom";return parseFloat(e["border"+r+"Width"])+parseFloat(e["border"+n+"Width"])}function a4(e,t,r,n){return Math.max(t["offset"+e],t["scroll"+e],r["client"+e],r["offset"+e],r["scroll"+e],wp(10)?parseInt(r["offset"+e])+parseInt(n["margin"+(e==="Height"?"Top":"Left")])+parseInt(n["margin"+(e==="Height"?"Bottom":"Right")]):0)}function TV(e){var t=e.body,r=e.documentElement,n=wp(10)&&getComputedStyle(r);return{height:a4("Height",t,r,n),width:a4("Width",t,r,n)}}var Vve=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Wve=function(){function e(t,r){for(var n=0;n<r.length;n++){var a=r[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),Pm=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},eo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function Vd(e){return eo({},e,{right:e.left+e.width,bottom:e.top+e.height})}function R2(e){var t={};try{if(wp(10)){t=e.getBoundingClientRect();var r=Cm(e,"top"),n=Cm(e,"left");t.top+=r,t.left+=n,t.bottom+=r,t.right+=n}else t=e.getBoundingClientRect()}catch(f){}var a={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},i=e.nodeName==="HTML"?TV(e.ownerDocument):{},o=i.width||e.clientWidth||a.width,l=i.height||e.clientHeight||a.height,c=e.offsetWidth-o,d=e.offsetHeight-l;if(c||d){var u=Ph(e);c-=s4(u,"x"),d-=s4(u,"y"),a.width-=c,a.height-=d}return Vd(a)}function JT(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=wp(10),a=t.nodeName==="HTML",i=R2(e),o=R2(t),l=lx(e),c=Ph(t),d=parseFloat(c.borderTopWidth),u=parseFloat(c.borderLeftWidth);r&&a&&(o.top=Math.max(o.top,0),o.left=Math.max(o.left,0));var f=Vd({top:i.top-o.top-d,left:i.left-o.left-u,width:i.width,height:i.height});if(f.marginTop=0,f.marginLeft=0,!n&&a){var h=parseFloat(c.marginTop),p=parseFloat(c.marginLeft);f.top-=d-h,f.bottom-=d-h,f.left-=u-p,f.right-=u-p,f.marginTop=h,f.marginLeft=p}return(n&&!r?t.contains(l):t===l&&l.nodeName!=="BODY")&&(f=qve(f,t)),f}function Hve(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=e.ownerDocument.documentElement,n=JT(e,r),a=Math.max(r.clientWidth,window.innerWidth||0),i=Math.max(r.clientHeight,window.innerHeight||0),o=t?0:Cm(r),l=t?0:Cm(r,"left"),c={top:o-n.top+n.marginTop,left:l-n.left+n.marginLeft,width:a,height:i};return Vd(c)}function AV(e){var t=e.nodeName;if(t==="BODY"||t==="HTML")return!1;if(Ph(e,"position")==="fixed")return!0;var r=XT(e);return r?AV(r):!1}function RV(e){if(!e||!e.parentElement||wp())return document.documentElement;for(var t=e.parentElement;t&&Ph(t,"transform")==="none";)t=t.parentElement;return t||document.documentElement}function QT(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,i={top:0,left:0},o=a?RV(e):mw(e,PV(t));if(n==="viewport")i=Hve(o,a);else{var l=void 0;n==="scrollParent"?(l=lx(XT(t)),l.nodeName==="BODY"&&(l=e.ownerDocument.documentElement)):n==="window"?l=e.ownerDocument.documentElement:l=n;var c=JT(l,o,a);if(l.nodeName==="HTML"&&!AV(o)){var d=TV(e.ownerDocument),u=d.height,f=d.width;i.top+=c.top-c.marginTop,i.bottom=u+c.top,i.left+=c.left-c.marginLeft,i.right=f+c.left}else i=c}r=r||0;var h=typeof r=="number";return i.left+=h?r:r.left||0,i.top+=h?r:r.top||0,i.right-=h?r:r.right||0,i.bottom-=h?r:r.bottom||0,i}function Gve(e){var t=e.width,r=e.height;return t*r}function OV(e,t,r,n,a){var i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(e.indexOf("auto")===-1)return e;var o=QT(r,n,i,a),l={top:{width:o.width,height:t.top-o.top},right:{width:o.right-t.right,height:o.height},bottom:{width:o.width,height:o.bottom-t.bottom},left:{width:t.left-o.left,height:o.height}},c=Object.keys(l).map(function(h){return eo({key:h},l[h],{area:Gve(l[h])})}).sort(function(h,p){return p.area-h.area}),d=c.filter(function(h){var p=h.width,g=h.height;return p>=r.clientWidth&&g>=r.clientHeight}),u=d.length>0?d[0].key:c[0].key,f=e.split("-")[1];return u+(f?"-"+f:"")}function MV(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a=n?RV(t):mw(t,PV(r));return JT(r,a,n)}function DV(e){var t=e.ownerDocument.defaultView,r=t.getComputedStyle(e),n=parseFloat(r.marginTop||0)+parseFloat(r.marginBottom||0),a=parseFloat(r.marginLeft||0)+parseFloat(r.marginRight||0),i={width:e.offsetWidth+a,height:e.offsetHeight+n};return i}function pw(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,function(r){return t[r]})}function IV(e,t,r){r=r.split("-")[0];var n=DV(e),a={width:n.width,height:n.height},i=["right","left"].indexOf(r)!==-1,o=i?"top":"left",l=i?"left":"top",c=i?"height":"width",d=i?"width":"height";return a[o]=t[o]+t[c]/2-n[c]/2,r===l?a[l]=t[l]-n[d]:a[l]=t[pw(l)],a}function cx(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function Yve(e,t,r){if(Array.prototype.findIndex)return e.findIndex(function(a){return a[t]===r});var n=cx(e,function(a){return a[t]===r});return e.indexOf(n)}function $V(e,t,r){var n=r===void 0?e:e.slice(0,Yve(e,"name",r));return n.forEach(function(a){a.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var i=a.function||a.fn;a.enabled&&CV(i)&&(t.offsets.popper=Vd(t.offsets.popper),t.offsets.reference=Vd(t.offsets.reference),t=i(t,a))}),t}function Kve(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=MV(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=OV(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=IV(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=$V(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function LV(e,t){return e.some(function(r){var n=r.name,a=r.enabled;return a&&n===t})}function eA(e){for(var t=[!1,"ms","Webkit","Moz","O"],r=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<t.length;n++){var a=t[n],i=a?""+a+r:e;if(typeof document.body.style[i]!="undefined")return i}return null}function Zve(){return this.state.isDestroyed=!0,LV(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[eA("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function FV(e){var t=e.ownerDocument;return t?t.defaultView:window}function zV(e,t,r,n){var a=e.nodeName==="BODY",i=a?e.ownerDocument.defaultView:e;i.addEventListener(t,r,{passive:!0}),a||zV(lx(i.parentNode),t,r,n),n.push(i)}function Xve(e,t,r,n){r.updateBound=n,FV(e).addEventListener("resize",r.updateBound,{passive:!0});var a=lx(e);return zV(a,"scroll",r.updateBound,r.scrollParents),r.scrollElement=a,r.eventsEnabled=!0,r}function Jve(){this.state.eventsEnabled||(this.state=Xve(this.reference,this.options,this.state,this.scheduleUpdate))}function Qve(e,t){return FV(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach(function(r){r.removeEventListener("scroll",t.updateBound)}),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t}function eye(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=Qve(this.reference,this.state))}function tA(e){return e!==""&&!isNaN(parseFloat(e))&&isFinite(e)}function O2(e,t){Object.keys(t).forEach(function(r){var n="";["width","height","top","right","bottom","left"].indexOf(r)!==-1&&tA(t[r])&&(n="px"),e.style[r]=t[r]+n})}function tye(e,t){Object.keys(t).forEach(function(r){var n=t[r];n!==!1?e.setAttribute(r,t[r]):e.removeAttribute(r)})}function rye(e){return O2(e.instance.popper,e.styles),tye(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&O2(e.arrowElement,e.arrowStyles),e}function nye(e,t,r,n,a){var i=MV(a,t,e,r.positionFixed),o=OV(r.placement,i,t,e,r.modifiers.flip.boundariesElement,r.modifiers.flip.padding);return t.setAttribute("x-placement",o),O2(t,{position:r.positionFixed?"fixed":"absolute"}),r}function sye(e,t){var r=e.offsets,n=r.popper,a=r.reference,i=Math.round,o=Math.floor,l=function(_){return _},c=i(a.width),d=i(n.width),u=["left","right"].indexOf(e.placement)!==-1,f=e.placement.indexOf("-")!==-1,h=c%2===d%2,p=c%2===1&&d%2===1,g=t?u||f||h?i:o:l,v=t?i:l;return{left:g(p&&!f&&t?n.left-1:n.left),top:v(n.top),bottom:v(n.bottom),right:g(n.right)}}var aye=ox&&/Firefox/i.test(navigator.userAgent);function iye(e,t){var r=t.x,n=t.y,a=e.offsets.popper,i=cx(e.instance.modifiers,function(b){return b.name==="applyStyle"}).gpuAcceleration;i!==void 0&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var o=i!==void 0?i:t.gpuAcceleration,l=Em(e.instance.popper),c=R2(l),d={position:a.position},u=sye(e,window.devicePixelRatio<2||!aye),f=r==="bottom"?"top":"bottom",h=n==="right"?"left":"right",p=eA("transform"),g=void 0,v=void 0;if(f==="bottom"?l.nodeName==="HTML"?v=-l.clientHeight+u.bottom:v=-c.height+u.bottom:v=u.top,h==="right"?l.nodeName==="HTML"?g=-l.clientWidth+u.right:g=-c.width+u.right:g=u.left,o&&p)d[p]="translate3d("+g+"px, "+v+"px, 0)",d[f]=0,d[h]=0,d.willChange="transform";else{var y=f==="bottom"?-1:1,_=h==="right"?-1:1;d[f]=v*y,d[h]=g*_,d.willChange=f+", "+h}var w={"x-placement":e.placement};return e.attributes=eo({},w,e.attributes),e.styles=eo({},d,e.styles),e.arrowStyles=eo({},e.offsets.arrow,e.arrowStyles),e}function BV(e,t,r){var n=cx(e,function(l){var c=l.name;return c===t}),a=!!n&&e.some(function(l){return l.name===r&&l.enabled&&l.order<n.order});if(!a){var i="`"+t+"`",o="`"+r+"`";console.warn(o+" modifier is required by "+i+" modifier in order to work, be sure to include it before "+i+"!")}return a}function oye(e,t){var r;if(!BV(e.instance.modifiers,"arrow","keepTogether"))return e;var n=t.element;if(typeof n=="string"){if(n=e.instance.popper.querySelector(n),!n)return e}else if(!e.instance.popper.contains(n))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var a=e.placement.split("-")[0],i=e.offsets,o=i.popper,l=i.reference,c=["left","right"].indexOf(a)!==-1,d=c?"height":"width",u=c?"Top":"Left",f=u.toLowerCase(),h=c?"left":"top",p=c?"bottom":"right",g=DV(n)[d];l[p]-g<o[f]&&(e.offsets.popper[f]-=o[f]-(l[p]-g)),l[f]+g>o[p]&&(e.offsets.popper[f]+=l[f]+g-o[p]),e.offsets.popper=Vd(e.offsets.popper);var v=l[f]+l[d]/2-g/2,y=Ph(e.instance.popper),_=parseFloat(y["margin"+u]),w=parseFloat(y["border"+u+"Width"]),b=v-e.offsets.popper[f]-_-w;return b=Math.max(Math.min(o[d]-g,b),0),e.arrowElement=n,e.offsets.arrow=(r={},Pm(r,f,Math.round(b)),Pm(r,h,""),r),e}function lye(e){return e==="end"?"start":e==="start"?"end":e}var UV=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],nS=UV.slice(3);function i4(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=nS.indexOf(e),n=nS.slice(r+1).concat(nS.slice(0,r));return t?n.reverse():n}var sS={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function cye(e,t){if(LV(e.instance.modifiers,"inner")||e.flipped&&e.placement===e.originalPlacement)return e;var r=QT(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),n=e.placement.split("-")[0],a=pw(n),i=e.placement.split("-")[1]||"",o=[];switch(t.behavior){case sS.FLIP:o=[n,a];break;case sS.CLOCKWISE:o=i4(n);break;case sS.COUNTERCLOCKWISE:o=i4(n,!0);break;default:o=t.behavior}return o.forEach(function(l,c){if(n!==l||o.length===c+1)return e;n=e.placement.split("-")[0],a=pw(n);var d=e.offsets.popper,u=e.offsets.reference,f=Math.floor,h=n==="left"&&f(d.right)>f(u.left)||n==="right"&&f(d.left)<f(u.right)||n==="top"&&f(d.bottom)>f(u.top)||n==="bottom"&&f(d.top)<f(u.bottom),p=f(d.left)<f(r.left),g=f(d.right)>f(r.right),v=f(d.top)<f(r.top),y=f(d.bottom)>f(r.bottom),_=n==="left"&&p||n==="right"&&g||n==="top"&&v||n==="bottom"&&y,w=["top","bottom"].indexOf(n)!==-1,b=!!t.flipVariations&&(w&&i==="start"&&p||w&&i==="end"&&g||!w&&i==="start"&&v||!w&&i==="end"&&y),N=!!t.flipVariationsByContent&&(w&&i==="start"&&g||w&&i==="end"&&p||!w&&i==="start"&&y||!w&&i==="end"&&v),S=b||N;(h||_||S)&&(e.flipped=!0,(h||_)&&(n=o[c+1]),S&&(i=lye(i)),e.placement=n+(i?"-"+i:""),e.offsets.popper=eo({},e.offsets.popper,IV(e.instance.popper,e.offsets.reference,e.placement)),e=$V(e.instance.modifiers,e,"flip"))}),e}function dye(e){var t=e.offsets,r=t.popper,n=t.reference,a=e.placement.split("-")[0],i=Math.floor,o=["top","bottom"].indexOf(a)!==-1,l=o?"right":"bottom",c=o?"left":"top",d=o?"width":"height";return r[l]<i(n[c])&&(e.offsets.popper[c]=i(n[c])-r[d]),r[c]>i(n[l])&&(e.offsets.popper[c]=i(n[l])),e}function uye(e,t,r,n){var a=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),i=+a[1],o=a[2];if(!i)return e;if(o.indexOf("%")===0){var l=void 0;switch(o){case"%p":l=r;break;case"%":case"%r":default:l=n}var c=Vd(l);return c[t]/100*i}else if(o==="vh"||o==="vw"){var d=void 0;return o==="vh"?d=Math.max(document.documentElement.clientHeight,window.innerHeight||0):d=Math.max(document.documentElement.clientWidth,window.innerWidth||0),d/100*i}else return i}function hye(e,t,r,n){var a=[0,0],i=["right","left"].indexOf(n)!==-1,o=e.split(/(\+|\-)/).map(function(u){return u.trim()}),l=o.indexOf(cx(o,function(u){return u.search(/,|\s/)!==-1}));o[l]&&o[l].indexOf(",")===-1&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var c=/\s*,\s*|\s+/,d=l!==-1?[o.slice(0,l).concat([o[l].split(c)[0]]),[o[l].split(c)[1]].concat(o.slice(l+1))]:[o];return d=d.map(function(u,f){var h=(f===1?!i:i)?"height":"width",p=!1;return u.reduce(function(g,v){return g[g.length-1]===""&&["+","-"].indexOf(v)!==-1?(g[g.length-1]=v,p=!0,g):p?(g[g.length-1]+=v,p=!1,g):g.concat(v)},[]).map(function(g){return uye(g,h,t,r)})}),d.forEach(function(u,f){u.forEach(function(h,p){tA(h)&&(a[f]+=h*(u[p-1]==="-"?-1:1))})}),a}function fye(e,t){var r=t.offset,n=e.placement,a=e.offsets,i=a.popper,o=a.reference,l=n.split("-")[0],c=void 0;return tA(+r)?c=[+r,0]:c=hye(r,i,o,l),l==="left"?(i.top+=c[0],i.left-=c[1]):l==="right"?(i.top+=c[0],i.left+=c[1]):l==="top"?(i.left+=c[0],i.top-=c[1]):l==="bottom"&&(i.left+=c[0],i.top+=c[1]),e.popper=i,e}function mye(e,t){var r=t.boundariesElement||Em(e.instance.popper);e.instance.reference===r&&(r=Em(r));var n=eA("transform"),a=e.instance.popper.style,i=a.top,o=a.left,l=a[n];a.top="",a.left="",a[n]="";var c=QT(e.instance.popper,e.instance.reference,t.padding,r,e.positionFixed);a.top=i,a.left=o,a[n]=l,t.boundaries=c;var d=t.priority,u=e.offsets.popper,f={primary:function(p){var g=u[p];return u[p]<c[p]&&!t.escapeWithReference&&(g=Math.max(u[p],c[p])),Pm({},p,g)},secondary:function(p){var g=p==="right"?"left":"top",v=u[g];return u[p]>c[p]&&!t.escapeWithReference&&(v=Math.min(u[g],c[p]-(p==="right"?u.width:u.height))),Pm({},g,v)}};return d.forEach(function(h){var p=["left","top"].indexOf(h)!==-1?"primary":"secondary";u=eo({},u,f[p](h))}),e.offsets.popper=u,e}function pye(e){var t=e.placement,r=t.split("-")[0],n=t.split("-")[1];if(n){var a=e.offsets,i=a.reference,o=a.popper,l=["bottom","top"].indexOf(r)!==-1,c=l?"left":"top",d=l?"width":"height",u={start:Pm({},c,i[c]),end:Pm({},c,i[c]+i[d]-o[d])};e.offsets.popper=eo({},o,u[n])}return e}function gye(e){if(!BV(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,r=cx(e.instance.modifiers,function(n){return n.name==="preventOverflow"}).boundaries;if(t.bottom<r.top||t.left>r.right||t.top>r.bottom||t.right<r.left){if(e.hide===!0)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(e.hide===!1)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}function vye(e){var t=e.placement,r=t.split("-")[0],n=e.offsets,a=n.popper,i=n.reference,o=["left","right"].indexOf(r)!==-1,l=["top","left"].indexOf(r)===-1;return a[o?"left":"top"]=i[r]-(l?a[o?"width":"height"]:0),e.placement=pw(t),e.offsets.popper=Vd(a),e}var yye={shift:{order:100,enabled:!0,fn:pye},offset:{order:200,enabled:!0,fn:fye,offset:0},preventOverflow:{order:300,enabled:!0,fn:mye,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:dye},arrow:{order:500,enabled:!0,fn:oye,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:cye,behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:vye},hide:{order:800,enabled:!0,fn:gye},computeStyle:{order:850,enabled:!0,fn:iye,gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:rye,onLoad:nye,gpuAcceleration:void 0}},xye={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:yye},Vv=function(){function e(t,r){var n=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Vve(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(n.update)},this.update=Bve(this.update.bind(this)),this.options=eo({},e.Defaults,a),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=r&&r.jquery?r[0]:r,this.options.modifiers={},Object.keys(eo({},e.Defaults.modifiers,a.modifiers)).forEach(function(o){n.options.modifiers[o]=eo({},e.Defaults.modifiers[o]||{},a.modifiers?a.modifiers[o]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(o){return eo({name:o},n.options.modifiers[o])}).sort(function(o,l){return o.order-l.order}),this.modifiers.forEach(function(o){o.enabled&&CV(o.onLoad)&&o.onLoad(n.reference,n.popper,n.options,o,n.state)}),this.update();var i=this.options.eventsEnabled;i&&this.enableEventListeners(),this.state.eventsEnabled=i}return Wve(e,[{key:"update",value:function(){return Kve.call(this)}},{key:"destroy",value:function(){return Zve.call(this)}},{key:"enableEventListeners",value:function(){return Jve.call(this)}},{key:"disableEventListeners",value:function(){return eye.call(this)}}]),e}();Vv.Utils=(typeof window!="undefined"?window:global).PopperUtils;Vv.placements=UV;Vv.Defaults=xye;var _ye=["innerHTML","ownerDocument","style","attributes","nodeValue"],wye=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],bye=["bigint","boolean","null","number","string","symbol","undefined"];function z1(e){var t=Object.prototype.toString.call(e).slice(8,-1);if(/HTML\w+Element/.test(t))return"HTMLElement";if(jye(t))return t}function Qo(e){return function(t){return z1(t)===e}}function jye(e){return wye.includes(e)}function bp(e){return function(t){return typeof t===e}}function Nye(e){return bye.includes(e)}function Ze(e){if(e===null)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(Ze.array(e))return"Array";if(Ze.plainFunction(e))return"Function";var t=z1(e);return t||"Object"}Ze.array=Array.isArray;Ze.arrayOf=function(e,t){return!Ze.array(e)&&!Ze.function(t)?!1:e.every(function(r){return t(r)})};Ze.asyncGeneratorFunction=function(e){return z1(e)==="AsyncGeneratorFunction"};Ze.asyncFunction=Qo("AsyncFunction");Ze.bigint=bp("bigint");Ze.boolean=function(e){return e===!0||e===!1};Ze.date=Qo("Date");Ze.defined=function(e){return!Ze.undefined(e)};Ze.domElement=function(e){return Ze.object(e)&&!Ze.plainObject(e)&&e.nodeType===1&&Ze.string(e.nodeName)&&_ye.every(function(t){return t in e})};Ze.empty=function(e){return Ze.string(e)&&e.length===0||Ze.array(e)&&e.length===0||Ze.object(e)&&!Ze.map(e)&&!Ze.set(e)&&Object.keys(e).length===0||Ze.set(e)&&e.size===0||Ze.map(e)&&e.size===0};Ze.error=Qo("Error");Ze.function=bp("function");Ze.generator=function(e){return Ze.iterable(e)&&Ze.function(e.next)&&Ze.function(e.throw)};Ze.generatorFunction=Qo("GeneratorFunction");Ze.instanceOf=function(e,t){return!e||!t?!1:Object.getPrototypeOf(e)===t.prototype};Ze.iterable=function(e){return!Ze.nullOrUndefined(e)&&Ze.function(e[Symbol.iterator])};Ze.map=Qo("Map");Ze.nan=function(e){return Number.isNaN(e)};Ze.null=function(e){return e===null};Ze.nullOrUndefined=function(e){return Ze.null(e)||Ze.undefined(e)};Ze.number=function(e){return bp("number")(e)&&!Ze.nan(e)};Ze.numericString=function(e){return Ze.string(e)&&e.length>0&&!Number.isNaN(Number(e))};Ze.object=function(e){return!Ze.nullOrUndefined(e)&&(Ze.function(e)||typeof e=="object")};Ze.oneOf=function(e,t){return Ze.array(e)?e.indexOf(t)>-1:!1};Ze.plainFunction=Qo("Function");Ze.plainObject=function(e){if(z1(e)!=="Object")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.getPrototypeOf({})};Ze.primitive=function(e){return Ze.null(e)||Nye(typeof e)};Ze.promise=Qo("Promise");Ze.propertyOf=function(e,t,r){if(!Ze.object(e)||!t)return!1;var n=e[t];return Ze.function(r)?r(n):Ze.defined(n)};Ze.regexp=Qo("RegExp");Ze.set=Qo("Set");Ze.string=bp("string");Ze.symbol=bp("symbol");Ze.undefined=bp("undefined");Ze.weakMap=Qo("WeakMap");Ze.weakSet=Qo("WeakSet");function qV(e){return function(t){return typeof t===e}}var Sye=qV("function"),kye=function(e){return e===null},o4=function(e){return Object.prototype.toString.call(e).slice(8,-1)==="RegExp"},l4=function(e){return!Eye(e)&&!kye(e)&&(Sye(e)||typeof e=="object")},Eye=qV("undefined"),M2=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function Cye(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=r;n--!==0;)if(!ci(e[n],t[n]))return!1;return!0}function Pye(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=new DataView(e.buffer),n=new DataView(t.buffer),a=e.byteLength;a--;)if(r.getUint8(a)!==n.getUint8(a))return!1;return!0}function Tye(e,t){var r,n,a,i;if(e.size!==t.size)return!1;try{for(var o=M2(e.entries()),l=o.next();!l.done;l=o.next()){var c=l.value;if(!t.has(c[0]))return!1}}catch(f){r={error:f}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}try{for(var d=M2(e.entries()),u=d.next();!u.done;u=d.next()){var c=u.value;if(!ci(c[1],t.get(c[0])))return!1}}catch(f){a={error:f}}finally{try{u&&!u.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}return!0}function Aye(e,t){var r,n;if(e.size!==t.size)return!1;try{for(var a=M2(e.entries()),i=a.next();!i.done;i=a.next()){var o=i.value;if(!t.has(o[0]))return!1}}catch(l){r={error:l}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!0}function ci(e,t){if(e===t)return!0;if(e&&l4(e)&&t&&l4(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return Cye(e,t);if(e instanceof Map&&t instanceof Map)return Tye(e,t);if(e instanceof Set&&t instanceof Set)return Aye(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return Pye(e,t);if(o4(e)&&o4(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=r.length;a--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[a]))return!1;for(var a=r.length;a--!==0;){var i=r[a];if(!(i==="_owner"&&e.$$typeof)&&!ci(e[i],t[i]))return!1}return!0}return Number.isNaN(e)&&Number.isNaN(t)?!0:e===t}function Rye(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(function(r){return Ze.string(r)||Ze.array(r)||Ze.plainObject(r)})}function Oye(e,t,r){return VV(e,t)?[e,t].every(Ze.array)?!e.some(f4(r))&&t.some(f4(r)):[e,t].every(Ze.plainObject)?!Object.entries(e).some(h4(r))&&Object.entries(t).some(h4(r)):t===r:!1}function c4(e,t,r){var n=r.actual,a=r.key,i=r.previous,o=r.type,l=jl(e,a),c=jl(t,a),d=[l,c].every(Ze.number)&&(o==="increased"?l<c:l>c);return Ze.undefined(n)||(d=d&&c===n),Ze.undefined(i)||(d=d&&l===i),d}function d4(e,t,r){var n=r.key,a=r.type,i=r.value,o=jl(e,n),l=jl(t,n),c=a==="added"?o:l,d=a==="added"?l:o;if(!Ze.nullOrUndefined(i)){if(Ze.defined(c)){if(Ze.array(c)||Ze.plainObject(c))return Oye(c,d,i)}else return ci(d,i);return!1}return[o,l].every(Ze.array)?!d.every(rA(c)):[o,l].every(Ze.plainObject)?Mye(Object.keys(c),Object.keys(d)):![o,l].every(function(u){return Ze.primitive(u)&&Ze.defined(u)})&&(a==="added"?!Ze.defined(o)&&Ze.defined(l):Ze.defined(o)&&!Ze.defined(l))}function u4(e,t,r){var n=r===void 0?{}:r,a=n.key,i=jl(e,a),o=jl(t,a);if(!VV(i,o))throw new TypeError("Inputs have different types");if(!Rye(i,o))throw new TypeError("Inputs don't have length");return[i,o].every(Ze.plainObject)&&(i=Object.keys(i),o=Object.keys(o)),[i,o]}function h4(e){return function(t){var r=t[0],n=t[1];return Ze.array(e)?ci(e,n)||e.some(function(a){return ci(a,n)||Ze.array(n)&&rA(n)(a)}):Ze.plainObject(e)&&e[r]?!!e[r]&&ci(e[r],n):ci(e,n)}}function Mye(e,t){return t.some(function(r){return!e.includes(r)})}function f4(e){return function(t){return Ze.array(e)?e.some(function(r){return ci(r,t)||Ze.array(t)&&rA(t)(r)}):ci(e,t)}}function fg(e,t){return Ze.array(e)?e.some(function(r){return ci(r,t)}):ci(e,t)}function rA(e){return function(t){return e.some(function(r){return ci(r,t)})}}function VV(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(Ze.array)||e.every(Ze.number)||e.every(Ze.plainObject)||e.every(Ze.string)}function jl(e,t){if(Ze.plainObject(e)||Ze.array(e)){if(Ze.string(t)){var r=t.split(".");return r.reduce(function(n,a){return n&&n[a]},e)}return Ze.number(t)?e[t]:e}return e}function Dye(e,t){if([e,t].some(Ze.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every(function(f){return Ze.plainObject(f)||Ze.array(f)}))throw new Error("Expected plain objects or array");var r=function(f,h){try{return d4(e,t,{key:f,type:"added",value:h})}catch(p){return!1}},n=function(f,h,p){try{var g=jl(e,f),v=jl(t,f),y=Ze.defined(h),_=Ze.defined(p);if(y||_){var w=_?fg(p,g):!fg(h,g),b=fg(h,v);return w&&b}return[g,v].every(Ze.array)||[g,v].every(Ze.plainObject)?!ci(g,v):g!==v}catch(N){return!1}},a=function(f,h,p){if(!Ze.defined(f))return!1;try{var g=jl(e,f),v=jl(t,f),y=Ze.defined(p);return fg(h,g)&&(y?fg(p,v):!y)}catch(_){return!1}},i=function(f,h){return Ze.defined(f)?n(f,h):!1},o=function(f,h,p){if(!Ze.defined(f))return!1;try{return c4(e,t,{key:f,actual:h,previous:p,type:"decreased"})}catch(g){return!1}},l=function(f){try{var h=u4(e,t,{key:f}),p=h[0],g=h[1];return!!p.length&&!g.length}catch(v){return!1}},c=function(f){try{var h=u4(e,t,{key:f}),p=h[0],g=h[1];return!p.length&&!!g.length}catch(v){return!1}},d=function(f,h,p){if(!Ze.defined(f))return!1;try{return c4(e,t,{key:f,actual:h,previous:p,type:"increased"})}catch(g){return!1}},u=function(f,h){try{return d4(e,t,{key:f,type:"removed",value:h})}catch(p){return!1}};return{added:r,changed:n,changedFrom:a,changedTo:i,decreased:o,emptied:l,filled:c,increased:d,removed:u}}function m4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ts(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m4(Object(r),!0).forEach(function(n){ka(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dx(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Iye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HV(n.key),n)}}function ux(e,t,r){return t&&Iye(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ka(e,t,r){return t=HV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hx(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D2(e,t)}function gw(e){return gw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gw(e)}function D2(e,t){return D2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},D2(e,t)}function $ye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Lye(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function WV(e,t){if(e==null)return{};var r=Lye(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fye(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tc(e)}function fx(e){var t=$ye();return function(){var n=gw(e),a;if(t){var i=gw(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Fye(this,a)}}function zye(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HV(e){var t=zye(e,"string");return typeof t=="symbol"?t:String(t)}var Bye={flip:{padding:20},preventOverflow:{padding:10}},Uye="The typeValidator argument must be a function with the signature function(props, propName, componentName).",qye="The error message is optional, but must be a string if provided.";function Vye(e,t,r,n){return typeof e=="boolean"?e:typeof e=="function"?e(t,r,n):e?!!e:!1}function Wye(e,t){return Object.hasOwnProperty.call(e,t)}function Hye(e,t,r,n){return new Error("Required ".concat(e[t]," `").concat(t,"` was not specified in `").concat(r,"`."))}function Gye(e,t){if(typeof e!="function")throw new TypeError(Uye);if(t&&typeof t!="string")throw new TypeError(qye)}function p4(e,t,r){return Gye(e,r),function(n,a,i){for(var o=arguments.length,l=new Array(o>3?o-3:0),c=3;c<o;c++)l[c-3]=arguments[c];return Vye(t,n,a,i)?Wye(n,a)?e.apply(void 0,[n,a,i].concat(l)):Hye(n,a,i):e.apply(void 0,[n,a,i].concat(l))}}var mn={INIT:"init",IDLE:"idle",OPENING:"opening",OPEN:"open",CLOSING:"closing",ERROR:"error"},mg=Bf.createPortal!==void 0;function hl(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}function aS(){return"ontouchstart"in window&&/Mobi/.test(navigator.userAgent)}function k0(e){var t=e.title,r=e.data,n=e.warn,a=n===void 0?!1:n,i=e.debug,o=i===void 0?!1:i,l=a?console.warn||console.error:console.log;o&&t&&r&&(console.groupCollapsed("%creact-floater: ".concat(t),"color: #9b00ff; font-weight: bold; font-size: 12px;"),Array.isArray(r)?r.forEach(function(c){Ze.plainObject(c)&&c.key?l.apply(console,[c.key,c.value]):l.apply(console,[c])}):l.apply(console,[r]),console.groupEnd())}function Yye(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;e.addEventListener(t,r,n)}function Kye(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;e.removeEventListener(t,r,n)}function Zye(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a;a=function(o){r(o),Kye(e,t,a)},Yye(e,t,a,n)}function g4(){}var GV=function(e){hx(r,e);var t=fx(r);function r(){return dx(this,r),t.apply(this,arguments)}return ux(r,[{key:"componentDidMount",value:function(){hl()&&(this.node||this.appendNode(),mg||this.renderPortal())}},{key:"componentDidUpdate",value:function(){hl()&&(mg||this.renderPortal())}},{key:"componentWillUnmount",value:function(){!hl()||!this.node||(mg||Bf.unmountComponentAtNode(this.node),this.node&&this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=void 0))}},{key:"appendNode",value:function(){var a=this.props,i=a.id,o=a.zIndex;this.node||(this.node=document.createElement("div"),i&&(this.node.id=i),o&&(this.node.style.zIndex=o),document.body.appendChild(this.node))}},{key:"renderPortal",value:function(){if(!hl())return null;var a=this.props,i=a.children,o=a.setRef;if(this.node||this.appendNode(),mg)return Bf.createPortal(i,this.node);var l=Bf.unstable_renderSubtreeIntoContainer(this,i.length>1?J.createElement("div",null,i):i[0],this.node);return o(l),null}},{key:"renderReact16",value:function(){var a=this.props,i=a.hasChildren,o=a.placement,l=a.target;return i?this.renderPortal():l||o==="center"?this.renderPortal():null}},{key:"render",value:function(){return mg?this.renderReact16():null}}]),r}(J.Component);ka(GV,"propTypes",{children:nt.oneOfType([nt.element,nt.array]),hasChildren:nt.bool,id:nt.oneOfType([nt.string,nt.number]),placement:nt.string,setRef:nt.func.isRequired,target:nt.oneOfType([nt.object,nt.string]),zIndex:nt.number});var YV=function(e){hx(r,e);var t=fx(r);function r(){return dx(this,r),t.apply(this,arguments)}return ux(r,[{key:"parentStyle",get:function(){var a=this.props,i=a.placement,o=a.styles,l=o.arrow.length,c={pointerEvents:"none",position:"absolute",width:"100%"};return i.startsWith("top")?(c.bottom=0,c.left=0,c.right=0,c.height=l):i.startsWith("bottom")?(c.left=0,c.right=0,c.top=0,c.height=l):i.startsWith("left")?(c.right=0,c.top=0,c.bottom=0):i.startsWith("right")&&(c.left=0,c.top=0),c}},{key:"render",value:function(){var a=this.props,i=a.placement,o=a.setArrowRef,l=a.styles,c=l.arrow,d=c.color,u=c.display,f=c.length,h=c.margin,p=c.position,g=c.spread,v={display:u,position:p},y,_=g,w=f;return i.startsWith("top")?(y="0,0 ".concat(_/2,",").concat(w," ").concat(_,",0"),v.bottom=0,v.marginLeft=h,v.marginRight=h):i.startsWith("bottom")?(y="".concat(_,",").concat(w," ").concat(_/2,",0 0,").concat(w),v.top=0,v.marginLeft=h,v.marginRight=h):i.startsWith("left")?(w=g,_=f,y="0,0 ".concat(_,",").concat(w/2," 0,").concat(w),v.right=0,v.marginTop=h,v.marginBottom=h):i.startsWith("right")&&(w=g,_=f,y="".concat(_,",").concat(w," ").concat(_,",0 0,").concat(w/2),v.left=0,v.marginTop=h,v.marginBottom=h),J.createElement("div",{className:"__floater__arrow",style:this.parentStyle},J.createElement("span",{ref:o,style:v},J.createElement("svg",{width:_,height:w,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},J.createElement("polygon",{points:y,fill:d}))))}}]),r}(J.Component);ka(YV,"propTypes",{placement:nt.string.isRequired,setArrowRef:nt.func.isRequired,styles:nt.object.isRequired});var Xye=["color","height","width"];function KV(e){var t=e.handleClick,r=e.styles,n=r.color,a=r.height,i=r.width,o=WV(r,Xye);return J.createElement("button",{"aria-label":"close",onClick:t,style:o,type:"button"},J.createElement("svg",{width:"".concat(i,"px"),height:"".concat(a,"px"),viewBox:"0 0 18 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid"},J.createElement("g",null,J.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:n}))))}KV.propTypes={handleClick:nt.func.isRequired,styles:nt.object.isRequired};function ZV(e){var t=e.content,r=e.footer,n=e.handleClick,a=e.open,i=e.positionWrapper,o=e.showCloseButton,l=e.title,c=e.styles,d={content:J.isValidElement(t)?t:J.createElement("div",{className:"__floater__content",style:c.content},t)};return l&&(d.title=J.isValidElement(l)?l:J.createElement("div",{className:"__floater__title",style:c.title},l)),r&&(d.footer=J.isValidElement(r)?r:J.createElement("div",{className:"__floater__footer",style:c.footer},r)),(o||i)&&!Ze.boolean(a)&&(d.close=J.createElement(KV,{styles:c.close,handleClick:n})),J.createElement("div",{className:"__floater__container",style:c.container},d.close,d.title,d.content,d.footer)}ZV.propTypes={content:nt.node.isRequired,footer:nt.node,handleClick:nt.func.isRequired,open:nt.bool,positionWrapper:nt.bool.isRequired,showCloseButton:nt.bool.isRequired,styles:nt.object.isRequired,title:nt.node};var XV=function(e){hx(r,e);var t=fx(r);function r(){return dx(this,r),t.apply(this,arguments)}return ux(r,[{key:"style",get:function(){var a=this.props,i=a.disableAnimation,o=a.component,l=a.placement,c=a.hideArrow,d=a.status,u=a.styles,f=u.arrow.length,h=u.floater,p=u.floaterCentered,g=u.floaterClosing,v=u.floaterOpening,y=u.floaterWithAnimation,_=u.floaterWithComponent,w={};return c||(l.startsWith("top")?w.padding="0 0 ".concat(f,"px"):l.startsWith("bottom")?w.padding="".concat(f,"px 0 0"):l.startsWith("left")?w.padding="0 ".concat(f,"px 0 0"):l.startsWith("right")&&(w.padding="0 0 0 ".concat(f,"px"))),[mn.OPENING,mn.OPEN].indexOf(d)!==-1&&(w=ts(ts({},w),v)),d===mn.CLOSING&&(w=ts(ts({},w),g)),d===mn.OPEN&&!i&&(w=ts(ts({},w),y)),l==="center"&&(w=ts(ts({},w),p)),o&&(w=ts(ts({},w),_)),ts(ts({},h),w)}},{key:"render",value:function(){var a=this.props,i=a.component,o=a.handleClick,l=a.hideArrow,c=a.setFloaterRef,d=a.status,u={},f=["__floater"];return i?J.isValidElement(i)?u.content=J.cloneElement(i,{closeFn:o}):u.content=i({closeFn:o}):u.content=J.createElement(ZV,this.props),d===mn.OPEN&&f.push("__floater__open"),l||(u.arrow=J.createElement(YV,this.props)),J.createElement("div",{ref:c,className:f.join(" "),style:this.style},J.createElement("div",{className:"__floater__body"},u.content,u.arrow))}}]),r}(J.Component);ka(XV,"propTypes",{component:nt.oneOfType([nt.func,nt.element]),content:nt.node,disableAnimation:nt.bool.isRequired,footer:nt.node,handleClick:nt.func.isRequired,hideArrow:nt.bool.isRequired,open:nt.bool,placement:nt.string.isRequired,positionWrapper:nt.bool.isRequired,setArrowRef:nt.func.isRequired,setFloaterRef:nt.func.isRequired,showCloseButton:nt.bool,status:nt.string.isRequired,styles:nt.object.isRequired,title:nt.node});var JV=function(e){hx(r,e);var t=fx(r);function r(){return dx(this,r),t.apply(this,arguments)}return ux(r,[{key:"render",value:function(){var a=this.props,i=a.children,o=a.handleClick,l=a.handleMouseEnter,c=a.handleMouseLeave,d=a.setChildRef,u=a.setWrapperRef,f=a.style,h=a.styles,p;if(i)if(J.Children.count(i)===1)if(!J.isValidElement(i))p=J.createElement("span",null,i);else{var g=Ze.function(i.type)?"innerRef":"ref";p=J.cloneElement(J.Children.only(i),ka({},g,d))}else p=i;return p?J.createElement("span",{ref:u,style:ts(ts({},h),f),onClick:o,onMouseEnter:l,onMouseLeave:c},p):null}}]),r}(J.Component);ka(JV,"propTypes",{children:nt.node,handleClick:nt.func.isRequired,handleMouseEnter:nt.func.isRequired,handleMouseLeave:nt.func.isRequired,setChildRef:nt.func.isRequired,setWrapperRef:nt.func.isRequired,style:nt.object,styles:nt.object.isRequired});var Jye={zIndex:100};function Qye(e){var t=$o(Jye,e.options||{});return{wrapper:{cursor:"help",display:"inline-flex",flexDirection:"column",zIndex:t.zIndex},wrapperPosition:{left:-1e3,position:"absolute",top:-1e3,visibility:"hidden"},floater:{display:"inline-block",filter:"drop-shadow(0 0 3px rgba(0, 0, 0, 0.3))",maxWidth:300,opacity:0,position:"relative",transition:"opacity 0.3s",visibility:"hidden",zIndex:t.zIndex},floaterOpening:{opacity:1,visibility:"visible"},floaterWithAnimation:{opacity:1,transition:"opacity 0.3s, transform 0.2s",visibility:"visible"},floaterWithComponent:{maxWidth:"100%"},floaterClosing:{opacity:0,visibility:"visible"},floaterCentered:{left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)"},container:{backgroundColor:"#fff",color:"#666",minHeight:60,minWidth:200,padding:20,position:"relative",zIndex:10},title:{borderBottom:"1px solid #555",color:"#555",fontSize:18,marginBottom:5,paddingBottom:6,paddingRight:18},content:{fontSize:15},close:{backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",fontSize:0,height:15,outline:"none",padding:10,position:"absolute",right:0,top:0,width:15,WebkitAppearance:"none"},footer:{borderTop:"1px solid #ccc",fontSize:13,marginTop:10,paddingTop:5},arrow:{color:"#fff",display:"inline-flex",length:16,margin:8,position:"absolute",spread:32},options:t}}var exe=["arrow","flip","offset"],txe=["position","top","right","bottom","left"],nA=function(e){hx(r,e);var t=fx(r);function r(n){var a;return dx(this,r),a=t.call(this,n),ka(tc(a),"setArrowRef",function(i){a.arrowRef=i}),ka(tc(a),"setChildRef",function(i){a.childRef=i}),ka(tc(a),"setFloaterRef",function(i){a.floaterRef=i}),ka(tc(a),"setWrapperRef",function(i){a.wrapperRef=i}),ka(tc(a),"handleTransitionEnd",function(){var i=a.state.status,o=a.props.callback;a.wrapperPopper&&a.wrapperPopper.instance.update(),a.setState({status:i===mn.OPENING?mn.OPEN:mn.IDLE},function(){var l=a.state.status;o(l===mn.OPEN?"open":"close",a.props)})}),ka(tc(a),"handleClick",function(){var i=a.props,o=i.event,l=i.open;if(!Ze.boolean(l)){var c=a.state,d=c.positionWrapper,u=c.status;(a.event==="click"||a.event==="hover"&&d)&&(k0({title:"click",data:[{event:o,status:u===mn.OPEN?"closing":"opening"}],debug:a.debug}),a.toggle())}}),ka(tc(a),"handleMouseEnter",function(){var i=a.props,o=i.event,l=i.open;if(!(Ze.boolean(l)||aS())){var c=a.state.status;a.event==="hover"&&c===mn.IDLE&&(k0({title:"mouseEnter",data:[{key:"originalEvent",value:o}],debug:a.debug}),clearTimeout(a.eventDelayTimeout),a.toggle())}}),ka(tc(a),"handleMouseLeave",function(){var i=a.props,o=i.event,l=i.eventDelay,c=i.open;if(!(Ze.boolean(c)||aS())){var d=a.state,u=d.status,f=d.positionWrapper;a.event==="hover"&&(k0({title:"mouseLeave",data:[{key:"originalEvent",value:o}],debug:a.debug}),l?[mn.OPENING,mn.OPEN].indexOf(u)!==-1&&!f&&!a.eventDelayTimeout&&(a.eventDelayTimeout=setTimeout(function(){delete a.eventDelayTimeout,a.toggle()},l*1e3)):a.toggle(mn.IDLE))}}),a.state={currentPlacement:n.placement,needsUpdate:!1,positionWrapper:n.wrapperOptions.position&&!!n.target,status:mn.INIT,statusWrapper:mn.INIT},a._isMounted=!1,a.hasMounted=!1,hl()&&window.addEventListener("load",function(){a.popper&&a.popper.instance.update(),a.wrapperPopper&&a.wrapperPopper.instance.update()}),a}return ux(r,[{key:"componentDidMount",value:function(){if(hl()){var a=this.state.positionWrapper,i=this.props,o=i.children,l=i.open,c=i.target;this._isMounted=!0,k0({title:"init",data:{hasChildren:!!o,hasTarget:!!c,isControlled:Ze.boolean(l),positionWrapper:a,target:this.target,floater:this.floaterRef},debug:this.debug}),this.hasMounted||(this.initPopper(),this.hasMounted=!0),!o&&c&&Ze.boolean(l)}}},{key:"componentDidUpdate",value:function(a,i){if(hl()){var o=this.props,l=o.autoOpen,c=o.open,d=o.target,u=o.wrapperOptions,f=Dye(i,this.state),h=f.changedFrom,p=f.changed;if(a.open!==c){var g;Ze.boolean(c)&&(g=c?mn.OPENING:mn.CLOSING),this.toggle(g)}(a.wrapperOptions.position!==u.position||a.target!==d)&&this.changeWrapperPosition(this.props),p("status",mn.IDLE)&&c?this.toggle(mn.OPEN):h("status",mn.INIT,mn.IDLE)&&l&&this.toggle(mn.OPEN),this.popper&&p("status",mn.OPENING)&&this.popper.instance.update(),this.floaterRef&&(p("status",mn.OPENING)||p("status",mn.CLOSING))&&Zye(this.floaterRef,"transitionend",this.handleTransitionEnd),p("needsUpdate",!0)&&this.rebuildPopper()}}},{key:"componentWillUnmount",value:function(){hl()&&(this._isMounted=!1,this.popper&&this.popper.instance.destroy(),this.wrapperPopper&&this.wrapperPopper.instance.destroy())}},{key:"initPopper",value:function(){var a=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.target,o=this.state.positionWrapper,l=this.props,c=l.disableFlip,d=l.getPopper,u=l.hideArrow,f=l.offset,h=l.placement,p=l.wrapperOptions,g=h==="top"||h==="bottom"?"flip":["right","bottom-end","top-end","left","top-start","bottom-start"];if(h==="center")this.setState({status:mn.IDLE});else if(i&&this.floaterRef){var v=this.options,y=v.arrow,_=v.flip,w=v.offset,b=WV(v,exe);new Vv(i,this.floaterRef,{placement:h,modifiers:ts({arrow:ts({enabled:!u,element:this.arrowRef},y),flip:ts({enabled:!c,behavior:g},_),offset:ts({offset:"0, ".concat(f,"px")},w)},b),onCreate:function(k){var P;if(a.popper=k,!((P=a.floaterRef)!==null&&P!==void 0&&P.isConnected)){a.setState({needsUpdate:!0});return}d(k,"floater"),a._isMounted&&a.setState({currentPlacement:k.placement,status:mn.IDLE}),h!==k.placement&&setTimeout(function(){k.instance.update()},1)},onUpdate:function(k){a.popper=k;var P=a.state.currentPlacement;a._isMounted&&k.placement!==P&&a.setState({currentPlacement:k.placement})}})}if(o){var N=Ze.undefined(p.offset)?0:p.offset;new Vv(this.target,this.wrapperRef,{placement:p.placement||h,modifiers:{arrow:{enabled:!1},offset:{offset:"0, ".concat(N,"px")},flip:{enabled:!1}},onCreate:function(k){a.wrapperPopper=k,a._isMounted&&a.setState({statusWrapper:mn.IDLE}),d(k,"wrapper"),h!==k.placement&&setTimeout(function(){k.instance.update()},1)}})}}},{key:"rebuildPopper",value:function(){var a=this;this.floaterRefInterval=setInterval(function(){var i;(i=a.floaterRef)!==null&&i!==void 0&&i.isConnected&&(clearInterval(a.floaterRefInterval),a.setState({needsUpdate:!1}),a.initPopper())},50)}},{key:"changeWrapperPosition",value:function(a){var i=a.target,o=a.wrapperOptions;this.setState({positionWrapper:o.position&&!!i})}},{key:"toggle",value:function(a){var i=this.state.status,o=i===mn.OPEN?mn.CLOSING:mn.OPENING;Ze.undefined(a)||(o=a),this.setState({status:o})}},{key:"debug",get:function(){var a=this.props.debug;return a||hl()&&"ReactFloaterDebug"in window&&!!window.ReactFloaterDebug}},{key:"event",get:function(){var a=this.props,i=a.disableHoverToClick,o=a.event;return o==="hover"&&aS()&&!i?"click":o}},{key:"options",get:function(){var a=this.props.options;return $o(Bye,a||{})}},{key:"styles",get:function(){var a=this,i=this.state,o=i.status,l=i.positionWrapper,c=i.statusWrapper,d=this.props.styles,u=$o(Qye(d),d);if(l){var f;[mn.IDLE].indexOf(o)===-1||[mn.IDLE].indexOf(c)===-1?f=u.wrapperPosition:f=this.wrapperPopper.styles,u.wrapper=ts(ts({},u.wrapper),f)}if(this.target){var h=window.getComputedStyle(this.target);this.wrapperStyles?u.wrapper=ts(ts({},u.wrapper),this.wrapperStyles):["relative","static"].indexOf(h.position)===-1&&(this.wrapperStyles={},l||(txe.forEach(function(p){a.wrapperStyles[p]=h[p]}),u.wrapper=ts(ts({},u.wrapper),this.wrapperStyles),this.target.style.position="relative",this.target.style.top="auto",this.target.style.right="auto",this.target.style.bottom="auto",this.target.style.left="auto"))}return u}},{key:"target",get:function(){if(!hl())return null;var a=this.props.target;return a?Ze.domElement(a)?a:document.querySelector(a):this.childRef||this.wrapperRef}},{key:"render",value:function(){var a=this.state,i=a.currentPlacement,o=a.positionWrapper,l=a.status,c=this.props,d=c.children,u=c.component,f=c.content,h=c.disableAnimation,p=c.footer,g=c.hideArrow,v=c.id,y=c.open,_=c.showCloseButton,w=c.style,b=c.target,N=c.title,S=J.createElement(JV,{handleClick:this.handleClick,handleMouseEnter:this.handleMouseEnter,handleMouseLeave:this.handleMouseLeave,setChildRef:this.setChildRef,setWrapperRef:this.setWrapperRef,style:w,styles:this.styles.wrapper},d),k={};return o?k.wrapperInPortal=S:k.wrapperAsChildren=S,J.createElement("span",null,J.createElement(GV,{hasChildren:!!d,id:v,placement:i,setRef:this.setFloaterRef,target:b,zIndex:this.styles.options.zIndex},J.createElement(XV,{component:u,content:f,disableAnimation:h,footer:p,handleClick:this.handleClick,hideArrow:g||i==="center",open:y,placement:i,positionWrapper:o,setArrowRef:this.setArrowRef,setFloaterRef:this.setFloaterRef,showCloseButton:_,status:l,styles:this.styles,title:N}),k.wrapperInPortal),k.wrapperAsChildren)}}]),r}(J.Component);ka(nA,"propTypes",{autoOpen:nt.bool,callback:nt.func,children:nt.node,component:p4(nt.oneOfType([nt.func,nt.element]),function(e){return!e.content}),content:p4(nt.node,function(e){return!e.component}),debug:nt.bool,disableAnimation:nt.bool,disableFlip:nt.bool,disableHoverToClick:nt.bool,event:nt.oneOf(["hover","click"]),eventDelay:nt.number,footer:nt.node,getPopper:nt.func,hideArrow:nt.bool,id:nt.oneOfType([nt.string,nt.number]),offset:nt.number,open:nt.bool,options:nt.object,placement:nt.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto","center"]),showCloseButton:nt.bool,style:nt.object,styles:nt.object,target:nt.oneOfType([nt.object,nt.string]),title:nt.node,wrapperOptions:nt.shape({offset:nt.number,placement:nt.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto"]),position:nt.bool})});ka(nA,"defaultProps",{autoOpen:!1,callback:g4,debug:!1,disableAnimation:!1,disableFlip:!1,disableHoverToClick:!1,event:"click",eventDelay:.4,getPopper:g4,hideArrow:!1,offset:15,placement:"bottom",showCloseButton:!1,styles:{},target:null,wrapperOptions:{position:!1}});var rxe=Object.defineProperty,nxe=(e,t,r)=>t in e?rxe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,tr=(e,t,r)=>nxe(e,typeof t!="symbol"?t+"":t,r),gn={INIT:"init",START:"start",STOP:"stop",RESET:"reset",PREV:"prev",NEXT:"next",GO:"go",CLOSE:"close",SKIP:"skip",UPDATE:"update"},qs={TOUR_START:"tour:start",STEP_BEFORE:"step:before",BEACON:"beacon",TOOLTIP:"tooltip",STEP_AFTER:"step:after",TOUR_END:"tour:end",TOUR_STATUS:"tour:status",TARGET_NOT_FOUND:"error:target_not_found",ERROR:"error"},Tr={INIT:"init",READY:"ready",BEACON:"beacon",TOOLTIP:"tooltip",COMPLETE:"complete",ERROR:"error"},Zr={IDLE:"idle",READY:"ready",WAITING:"waiting",RUNNING:"running",PAUSED:"paused",SKIPPED:"skipped",FINISHED:"finished",ERROR:"error"};function dd(){var e;return!!(typeof window!="undefined"&&((e=window.document)!=null&&e.createElement))}function QV(e){return e?e.getBoundingClientRect():null}function sxe(e=!1){const{body:t,documentElement:r}=document;if(!t||!r)return 0;if(e){const n=[t.scrollHeight,t.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight].sort((i,o)=>i-o),a=Math.floor(n.length/2);return n.length%2===0?(n[a-1]+n[a])/2:n[a]}return Math.max(t.scrollHeight,t.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight)}function pc(e){if(typeof e=="string")try{return document.querySelector(e)}catch(t){return null}return e}function axe(e){return!e||e.nodeType!==1?null:getComputedStyle(e)}function Wv(e,t,r){if(!e)return Ru();const n=jV(e);if(n){if(n.isSameNode(Ru()))return r?document:Ru();if(!(n.scrollHeight>n.offsetHeight)&&!t)return n.style.overflow="initial",Ru()}return n}function B1(e,t){if(!e)return!1;const r=Wv(e,t);return r?!r.isSameNode(Ru()):!1}function ixe(e){return e.offsetParent!==document.body}function Tm(e,t="fixed"){if(!e||!(e instanceof HTMLElement))return!1;const{nodeName:r}=e,n=axe(e);return r==="BODY"||r==="HTML"?!1:n&&n.position===t?!0:e.parentNode?Tm(e.parentNode,t):!1}function oxe(e){var t;if(!e)return!1;let r=e;for(;r&&r!==document.body;){if(r instanceof HTMLElement){const{display:n,visibility:a}=getComputedStyle(r);if(n==="none"||a==="hidden")return!1}r=(t=r.parentElement)!=null?t:null}return!0}function lxe(e,t,r){var n,a,i;const o=QV(e),l=Wv(e,r),c=B1(e,r),d=Tm(e);let u=0,f=(n=o==null?void 0:o.top)!=null?n:0;if(c&&d){const h=(a=e==null?void 0:e.offsetTop)!=null?a:0,p=(i=l==null?void 0:l.scrollTop)!=null?i:0;f=h-p}else l instanceof HTMLElement&&(u=l.scrollTop,!c&&!Tm(e)&&(f+=u),l.isSameNode(Ru())||(f+=Ru().scrollTop));return Math.floor(f-t)}function cxe(e,t,r){var n;if(!e)return 0;const{offsetTop:a=0,scrollTop:i=0}=(n=jV(e))!=null?n:{};let o=e.getBoundingClientRect().top+i;a&&(B1(e,r)||ixe(e))&&(o-=a);const l=Math.floor(o-t);return l<0?0:l}function Ru(){var e;return(e=document.scrollingElement)!=null?e:document.documentElement}function dxe(e,t){const{duration:r,element:n}=t;return new Promise((a,i)=>{const{scrollTop:o}=n,l=e>o?e-o:o-e;fve.top(n,e,{duration:l<100?50:r},c=>c&&c.message!=="Element already at target scroll position"?i(c):a())})}var pg=so.createPortal!==void 0;function e7(e=navigator.userAgent){let t=e;return typeof window=="undefined"?t="node":document.documentMode?t="ie":/Edge/.test(e)?t="edge":window.opera||e.includes(" OPR/")?t="opera":typeof window.InstallTrigger!="undefined"?t="firefox":window.chrome?t="chrome":/(Version\/([\d._]+).*Safari|CriOS|FxiOS| Mobile\/)/.test(e)&&(t="safari"),t}function f_(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function fl(e,t={}){const{defaultValue:r,step:n,steps:a}=t;let i=e4(e);if(i)(i.includes("{step}")||i.includes("{steps}"))&&n&&a&&(i=i.replace("{step}",n.toString()).replace("{steps}",a.toString()));else if(x.isValidElement(e)&&!Object.values(e.props).length&&f_(e.type)==="function"){const o=e.type({});i=fl(o,t)}else i=e4(r);return i}function uxe(e,t){return!Jt.plainObject(e)||!Jt.array(t)?!1:Object.keys(e).every(r=>t.includes(r))}function hxe(e){const t=/^#?([\da-f])([\da-f])([\da-f])$/i,r=e.replace(t,(a,i,o,l)=>i+i+o+o+l+l),n=/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i.exec(r);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:[]}function v4(e){return e.disableBeacon||e.placement==="center"}function y4(){return!["chrome","safari","firefox","opera"].includes(e7())}function hh({data:e,debug:t=!1,title:r,warn:n=!1}){const a=n?console.warn||console.error:console.log;t&&(r&&e?(console.groupCollapsed(`%creact-joyride: ${r}`,"color: #ff0044; font-weight: bold; font-size: 12px;"),Array.isArray(e)?e.forEach(i=>{Jt.plainObject(i)&&i.key?a.apply(console,[i.key,i.value]):a.apply(console,[i])}):a.apply(console,[e]),console.groupEnd()):console.error("Missing title or data props"))}function fxe(e){return Object.keys(e)}function t7(e,...t){if(!Jt.plainObject(e))throw new TypeError("Expected an object");const r={};for(const n in e)({}).hasOwnProperty.call(e,n)&&(t.includes(n)||(r[n]=e[n]));return r}function mxe(e,...t){if(!Jt.plainObject(e))throw new TypeError("Expected an object");if(!t.length)return e;const r={};for(const n in e)({}).hasOwnProperty.call(e,n)&&t.includes(n)&&(r[n]=e[n]);return r}function I2(e,t,r){const n=i=>i.replace("{step}",String(t)).replace("{steps}",String(r));if(f_(e)==="string")return n(e);if(!x.isValidElement(e))return e;const{children:a}=e.props;if(f_(a)==="string"&&a.includes("{step}"))return x.cloneElement(e,{children:n(a)});if(Array.isArray(a))return x.cloneElement(e,{children:a.map(i=>typeof i=="string"?n(i):I2(i,t,r))});if(f_(e.type)==="function"&&!Object.values(e.props).length){const i=e.type({});return I2(i,t,r)}return e}function pxe(e){const{isFirstStep:t,lifecycle:r,previousLifecycle:n,scrollToFirstStep:a,step:i,target:o}=e;return!i.disableScrolling&&(!t||a||r===Tr.TOOLTIP)&&i.placement!=="center"&&(!i.isFixed||!Tm(o))&&n!==r&&[Tr.BEACON,Tr.TOOLTIP].includes(r)}var gxe={options:{preventOverflow:{boundariesElement:"scrollParent"}},wrapperOptions:{offset:-18,position:!0}},r7={back:"Back",close:"Close",last:"Last",next:"Next",nextLabelWithProgress:"Next (Step {step} of {steps})",open:"Open the dialog",skip:"Skip"},vxe={event:"click",placement:"bottom",offset:10,disableBeacon:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrollParentFix:!1,disableScrolling:!1,hideBackButton:!1,hideCloseButton:!1,hideFooter:!1,isFixed:!1,locale:r7,showProgress:!1,showSkipButton:!1,spotlightClicks:!1,spotlightPadding:10},yxe={continuous:!1,debug:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrolling:!1,disableScrollParentFix:!1,getHelpers:void 0,hideBackButton:!1,run:!0,scrollOffset:20,scrollDuration:300,scrollToFirstStep:!1,showSkipButton:!1,showProgress:!1,spotlightClicks:!1,spotlightPadding:10,steps:[]},xxe={arrowColor:"#fff",backgroundColor:"#fff",beaconSize:36,overlayColor:"rgba(0, 0, 0, 0.5)",primaryColor:"#f04",spotlightShadow:"0 0 15px rgba(0, 0, 0, 0.5)",textColor:"#333",width:380,zIndex:100},gg={backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",cursor:"pointer",fontSize:16,lineHeight:1,padding:8,WebkitAppearance:"none"},x4={borderRadius:4,position:"absolute"};function _xe(e,t){var r,n,a,i,o;const{floaterProps:l,styles:c}=e,d=$o((r=t.floaterProps)!=null?r:{},l!=null?l:{}),u=$o(c!=null?c:{},(n=t.styles)!=null?n:{}),f=$o(xxe,u.options||{}),h=t.placement==="center"||t.disableBeacon;let{width:p}=f;window.innerWidth>480&&(p=380),"width"in f&&(p=typeof f.width=="number"&&window.innerWidth<f.width?window.innerWidth-30:f.width);const g={bottom:0,left:0,overflow:"hidden",position:"absolute",right:0,top:0,zIndex:f.zIndex},v={beacon:H(M({},gg),{display:h?"none":"inline-block",height:f.beaconSize,position:"relative",width:f.beaconSize,zIndex:f.zIndex}),beaconInner:{animation:"joyride-beacon-inner 1.2s infinite ease-in-out",backgroundColor:f.primaryColor,borderRadius:"50%",display:"block",height:"50%",left:"50%",opacity:.7,position:"absolute",top:"50%",transform:"translate(-50%, -50%)",width:"50%"},beaconOuter:{animation:"joyride-beacon-outer 1.2s infinite ease-in-out",backgroundColor:`rgba(${hxe(f.primaryColor).join(",")}, 0.2)`,border:`2px solid ${f.primaryColor}`,borderRadius:"50%",boxSizing:"border-box",display:"block",height:"100%",left:0,opacity:.9,position:"absolute",top:0,transformOrigin:"center",width:"100%"},tooltip:{backgroundColor:f.backgroundColor,borderRadius:5,boxSizing:"border-box",color:f.textColor,fontSize:16,maxWidth:"100%",padding:15,position:"relative",width:p},tooltipContainer:{lineHeight:1.4,textAlign:"center"},tooltipTitle:{fontSize:18,margin:0},tooltipContent:{padding:"20px 10px"},tooltipFooter:{alignItems:"center",display:"flex",justifyContent:"flex-end",marginTop:15},tooltipFooterSpacer:{flex:1},buttonNext:H(M({},gg),{backgroundColor:f.primaryColor,borderRadius:4,color:"#fff"}),buttonBack:H(M({},gg),{color:f.primaryColor,marginLeft:"auto",marginRight:5}),buttonClose:H(M({},gg),{color:f.textColor,height:14,padding:15,position:"absolute",right:0,top:0,width:14}),buttonSkip:H(M({},gg),{color:f.textColor,fontSize:14}),overlay:H(M({},g),{backgroundColor:f.overlayColor,mixBlendMode:"hard-light"}),overlayLegacy:M({},g),overlayLegacyCenter:H(M({},g),{backgroundColor:f.overlayColor}),spotlight:H(M({},x4),{backgroundColor:"gray"}),spotlightLegacy:H(M({},x4),{boxShadow:`0 0 0 9999px ${f.overlayColor}, ${f.spotlightShadow}`}),floaterStyles:{arrow:{color:(o=(i=(a=d==null?void 0:d.styles)==null?void 0:a.arrow)==null?void 0:i.color)!=null?o:f.arrowColor},options:{zIndex:f.zIndex+100}},options:f};return $o(v,u)}function wxe(e){return mxe(e,"beaconComponent","disableCloseOnEsc","disableOverlay","disableOverlayClose","disableScrolling","disableScrollParentFix","floaterProps","hideBackButton","hideCloseButton","locale","showProgress","showSkipButton","spotlightClicks","spotlightPadding","styles","tooltipComponent")}function Qh(e,t){var r,n,a,i,o,l;const c=t!=null?t:{},d=$o.all([vxe,wxe(e),c],{isMergeableObject:Jt.plainObject}),u=_xe(e,d),f=B1(pc(d.target),d.disableScrollParentFix),h=$o.all([gxe,(r=e.floaterProps)!=null?r:{},(n=d.floaterProps)!=null?n:{}]);return h.offset=d.offset,h.styles=$o((a=h.styles)!=null?a:{},u.floaterStyles),h.offset+=(o=(i=e.spotlightPadding)!=null?i:d.spotlightPadding)!=null?o:0,d.placementBeacon&&h.wrapperOptions&&(h.wrapperOptions.placement=d.placementBeacon),f&&h.options.preventOverflow&&(h.options.preventOverflow.boundariesElement="window"),H(M({},d),{locale:$o.all([r7,(l=e.locale)!=null?l:{},d.locale||{}]),floaterProps:h,styles:t7(u,"floaterStyles")})}function n7(e,t=!1){return Jt.plainObject(e)?e.target?!0:(hh({title:"validateStep",data:"target is missing from the step",warn:!0,debug:t}),!1):(hh({title:"validateStep",data:"step must be an object",warn:!0,debug:t}),!1)}function _4(e,t=!1){return Jt.array(e)?e.every(r=>n7(r,t)):(hh({title:"validateSteps",data:"steps must be an array",warn:!0,debug:t}),!1)}var s7={action:"init",controlled:!1,index:0,lifecycle:Tr.INIT,origin:null,size:0,status:Zr.IDLE},w4=fxe(t7(s7,"controlled","size")),bxe=class{constructor(e){tr(this,"beaconPopper"),tr(this,"tooltipPopper"),tr(this,"data",new Map),tr(this,"listener"),tr(this,"store",new Map),tr(this,"addListener",a=>{this.listener=a}),tr(this,"setSteps",a=>{const{size:i,status:o}=this.getState(),l={size:a.length,status:o};this.data.set("steps",a),o===Zr.WAITING&&!i&&a.length&&(l.status=Zr.RUNNING),this.setState(l)}),tr(this,"getPopper",a=>a==="beacon"?this.beaconPopper:this.tooltipPopper),tr(this,"setPopper",(a,i)=>{a==="beacon"?this.beaconPopper=i:this.tooltipPopper=i}),tr(this,"cleanupPoppers",()=>{this.beaconPopper=null,this.tooltipPopper=null}),tr(this,"close",(a=null)=>{const{index:i,status:o}=this.getState();o===Zr.RUNNING&&this.setState(M({},this.getNextState({action:gn.CLOSE,index:i+1,origin:a})))}),tr(this,"go",a=>{const{controlled:i,status:o}=this.getState();if(i||o!==Zr.RUNNING)return;const l=this.getSteps()[a];this.setState(H(M({},this.getNextState({action:gn.GO,index:a})),{status:l?o:Zr.FINISHED}))}),tr(this,"info",()=>this.getState()),tr(this,"next",()=>{const{index:a,status:i}=this.getState();i===Zr.RUNNING&&this.setState(this.getNextState({action:gn.NEXT,index:a+1}))}),tr(this,"open",()=>{const{status:a}=this.getState();a===Zr.RUNNING&&this.setState(M({},this.getNextState({action:gn.UPDATE,lifecycle:Tr.TOOLTIP})))}),tr(this,"prev",()=>{const{index:a,status:i}=this.getState();i===Zr.RUNNING&&this.setState(M({},this.getNextState({action:gn.PREV,index:a-1})))}),tr(this,"reset",(a=!1)=>{const{controlled:i}=this.getState();i||this.setState(H(M({},this.getNextState({action:gn.RESET,index:0})),{status:a?Zr.RUNNING:Zr.READY}))}),tr(this,"skip",()=>{const{status:a}=this.getState();a===Zr.RUNNING&&this.setState({action:gn.SKIP,lifecycle:Tr.INIT,status:Zr.SKIPPED})}),tr(this,"start",a=>{const{index:i,size:o}=this.getState();this.setState(H(M({},this.getNextState({action:gn.START,index:Jt.number(a)?a:i},!0)),{status:o?Zr.RUNNING:Zr.WAITING}))}),tr(this,"stop",(a=!1)=>{const{index:i,status:o}=this.getState();[Zr.FINISHED,Zr.SKIPPED].includes(o)||this.setState(H(M({},this.getNextState({action:gn.STOP,index:i+(a?1:0)})),{status:Zr.PAUSED}))}),tr(this,"update",a=>{var i,o;if(!uxe(a,w4))throw new Error(`State is not valid. Valid keys: ${w4.join(", ")}`);this.setState(M({},this.getNextState(H(M(M({},this.getState()),a),{action:(i=a.action)!=null?i:gn.UPDATE,origin:(o=a.origin)!=null?o:null}),!0)))});const{continuous:t=!1,stepIndex:r,steps:n=[]}=e!=null?e:{};this.setState({action:gn.INIT,controlled:Jt.number(r),continuous:t,index:Jt.number(r)?r:0,lifecycle:Tr.INIT,origin:null,status:n.length?Zr.READY:Zr.IDLE},!0),this.beaconPopper=null,this.tooltipPopper=null,this.listener=null,this.setSteps(n)}getState(){return this.store.size?{action:this.store.get("action")||"",controlled:this.store.get("controlled")||!1,index:parseInt(this.store.get("index"),10),lifecycle:this.store.get("lifecycle")||"",origin:this.store.get("origin")||null,size:this.store.get("size")||0,status:this.store.get("status")||""}:M({},s7)}getNextState(e,t=!1){var r,n,a,i,o;const{action:l,controlled:c,index:d,size:u,status:f}=this.getState(),h=Jt.number(e.index)?e.index:d,p=c&&!t?d:Math.min(Math.max(h,0),u);return{action:(r=e.action)!=null?r:l,controlled:c,index:p,lifecycle:(n=e.lifecycle)!=null?n:Tr.INIT,origin:(a=e.origin)!=null?a:null,size:(i=e.size)!=null?i:u,status:p===u?Zr.FINISHED:(o=e.status)!=null?o:f}}getSteps(){const e=this.data.get("steps");return Array.isArray(e)?e:[]}hasUpdatedState(e){const t=JSON.stringify(e),r=JSON.stringify(this.getState());return t!==r}setState(e,t=!1){const r=this.getState(),{action:n,index:a,lifecycle:i,origin:o=null,size:l,status:c}=M(M({},r),e);this.store.set("action",n),this.store.set("index",a),this.store.set("lifecycle",i),this.store.set("origin",o),this.store.set("size",l),this.store.set("status",c),t&&(this.store.set("controlled",e.controlled),this.store.set("continuous",e.continuous)),this.listener&&this.hasUpdatedState(r)&&this.listener(this.getState())}getHelpers(){return{close:this.close,go:this.go,info:this.info,next:this.next,open:this.open,prev:this.prev,reset:this.reset,skip:this.skip}}};function jxe(e){return new bxe(e)}function Nxe({styles:e}){return x.createElement("div",{key:"JoyrideSpotlight",className:"react-joyride__spotlight","data-test-id":"spotlight",style:e})}var Sxe=Nxe,kxe=class extends x.Component{constructor(){super(...arguments),tr(this,"isActive",!1),tr(this,"resizeTimeout"),tr(this,"scrollTimeout"),tr(this,"scrollParent"),tr(this,"state",{isScrolling:!1,mouseOverSpotlight:!1,showSpotlight:!0}),tr(this,"hideSpotlight",()=>{const{continuous:e,disableOverlay:t,lifecycle:r}=this.props,n=[Tr.INIT,Tr.BEACON,Tr.COMPLETE,Tr.ERROR];return t||(e?n.includes(r):r!==Tr.TOOLTIP)}),tr(this,"handleMouseMove",e=>{const{mouseOverSpotlight:t}=this.state,{height:r,left:n,position:a,top:i,width:o}=this.spotlightStyles,l=a==="fixed"?e.clientY:e.pageY,c=a==="fixed"?e.clientX:e.pageX,d=l>=i&&l<=i+r,f=c>=n&&c<=n+o&&d;f!==t&&this.updateState({mouseOverSpotlight:f})}),tr(this,"handleScroll",()=>{const{target:e}=this.props,t=pc(e);if(this.scrollParent!==document){const{isScrolling:r}=this.state;r||this.updateState({isScrolling:!0,showSpotlight:!1}),clearTimeout(this.scrollTimeout),this.scrollTimeout=window.setTimeout(()=>{this.updateState({isScrolling:!1,showSpotlight:!0})},50)}else Tm(t,"sticky")&&this.updateState({})}),tr(this,"handleResize",()=>{clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(()=>{this.isActive&&this.forceUpdate()},100)})}componentDidMount(){const{debug:e,disableScrolling:t,disableScrollParentFix:r=!1,target:n}=this.props,a=pc(n);this.scrollParent=Wv(a!=null?a:document.body,r,!0),this.isActive=!0,window.addEventListener("resize",this.handleResize)}componentDidUpdate(e){var t;const{disableScrollParentFix:r,lifecycle:n,spotlightClicks:a,target:i}=this.props,{changed:o}=fw(e,this.props);if(o("target")||o("disableScrollParentFix")){const l=pc(i);this.scrollParent=Wv(l!=null?l:document.body,r,!0)}o("lifecycle",Tr.TOOLTIP)&&((t=this.scrollParent)==null||t.addEventListener("scroll",this.handleScroll,{passive:!0}),setTimeout(()=>{const{isScrolling:l}=this.state;l||this.updateState({showSpotlight:!0})},100)),(o("spotlightClicks")||o("disableOverlay")||o("lifecycle"))&&(a&&n===Tr.TOOLTIP?window.addEventListener("mousemove",this.handleMouseMove,!1):n!==Tr.TOOLTIP&&window.removeEventListener("mousemove",this.handleMouseMove))}componentWillUnmount(){var e;this.isActive=!1,window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("resize",this.handleResize),clearTimeout(this.resizeTimeout),clearTimeout(this.scrollTimeout),(e=this.scrollParent)==null||e.removeEventListener("scroll",this.handleScroll)}get overlayStyles(){const{mouseOverSpotlight:e}=this.state,{disableOverlayClose:t,placement:r,styles:n}=this.props;let a=n.overlay;return y4()&&(a=r==="center"?n.overlayLegacyCenter:n.overlayLegacy),M({cursor:t?"default":"pointer",height:sxe(),pointerEvents:e?"none":"auto"},a)}get spotlightStyles(){var e,t,r;const{showSpotlight:n}=this.state,{disableScrollParentFix:a=!1,spotlightClicks:i,spotlightPadding:o=0,styles:l,target:c}=this.props,d=pc(c),u=QV(d),f=Tm(d),h=lxe(d,o,a);return H(M({},y4()?l.spotlightLegacy:l.spotlight),{height:Math.round(((e=u==null?void 0:u.height)!=null?e:0)+o*2),left:Math.round(((t=u==null?void 0:u.left)!=null?t:0)-o),opacity:n?1:0,pointerEvents:i?"none":"auto",position:f?"fixed":"absolute",top:h,transition:"opacity 0.2s",width:Math.round(((r=u==null?void 0:u.width)!=null?r:0)+o*2)})}updateState(e){this.isActive&&this.setState(t=>M(M({},t),e))}render(){const{showSpotlight:e}=this.state,{onClickOverlay:t,placement:r}=this.props,{hideSpotlight:n,overlayStyles:a,spotlightStyles:i}=this;if(n())return null;let o=r!=="center"&&e&&x.createElement(Sxe,{styles:i});if(e7()==="safari"){const l=a,{mixBlendMode:c,zIndex:d}=l,u=me(l,["mixBlendMode","zIndex"]);o=x.createElement("div",{style:M({},u)},o),delete a.backgroundColor}return x.createElement("div",{className:"react-joyride__overlay","data-test-id":"overlay",onClick:t,role:"presentation",style:a},o)}},Exe=class extends x.Component{constructor(){super(...arguments),tr(this,"node",null)}componentDidMount(){const{id:e}=this.props;dd()&&(this.node=document.createElement("div"),this.node.id=e,document.body.appendChild(this.node),pg||this.renderReact15())}componentDidUpdate(){dd()&&(pg||this.renderReact15())}componentWillUnmount(){!dd()||!this.node||(pg||so.unmountComponentAtNode(this.node),this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=null))}renderReact15(){if(!dd())return;const{children:e}=this.props;this.node&&so.unstable_renderSubtreeIntoContainer(this,e,this.node)}renderReact16(){if(!dd()||!pg)return null;const{children:e}=this.props;return this.node?so.createPortal(e,this.node):null}render(){return pg?this.renderReact16():null}},Cxe=class{constructor(e,t){if(tr(this,"element"),tr(this,"options"),tr(this,"canBeTabbed",r=>{const{tabIndex:n}=r;return n===null||n<0?!1:this.canHaveFocus(r)}),tr(this,"canHaveFocus",r=>{const n=/input|select|textarea|button|object/,a=r.nodeName.toLowerCase();return(n.test(a)&&!r.getAttribute("disabled")||a==="a"&&!!r.getAttribute("href"))&&this.isVisible(r)}),tr(this,"findValidTabElements",()=>[].slice.call(this.element.querySelectorAll("*"),0).filter(this.canBeTabbed)),tr(this,"handleKeyDown",r=>{const{code:n="Tab"}=this.options;r.code===n&&this.interceptTab(r)}),tr(this,"interceptTab",r=>{r.preventDefault();const n=this.findValidTabElements(),{shiftKey:a}=r;if(!n.length)return;let i=document.activeElement?n.indexOf(document.activeElement):0;i===-1||!a&&i+1===n.length?i=0:a&&i===0?i=n.length-1:i+=a?-1:1,n[i].focus()}),tr(this,"isHidden",r=>{const n=r.offsetWidth<=0&&r.offsetHeight<=0,a=window.getComputedStyle(r);return n&&!r.innerHTML?!0:n&&a.getPropertyValue("overflow")!=="visible"||a.getPropertyValue("display")==="none"}),tr(this,"isVisible",r=>{let n=r;for(;n;)if(n instanceof HTMLElement){if(n===document.body)break;if(this.isHidden(n))return!1;n=n.parentNode}return!0}),tr(this,"removeScope",()=>{window.removeEventListener("keydown",this.handleKeyDown)}),tr(this,"checkFocus",r=>{document.activeElement!==r&&(r.focus(),window.requestAnimationFrame(()=>this.checkFocus(r)))}),tr(this,"setFocus",()=>{const{selector:r}=this.options;if(!r)return;const n=this.element.querySelector(r);n&&window.requestAnimationFrame(()=>this.checkFocus(n))}),!(e instanceof HTMLElement))throw new TypeError("Invalid parameter: element must be an HTMLElement");this.element=e,this.options=t,window.addEventListener("keydown",this.handleKeyDown,!1),this.setFocus()}},Pxe=class extends x.Component{constructor(e){if(super(e),tr(this,"beacon",null),tr(this,"setBeaconRef",a=>{this.beacon=a}),e.beaconComponent)return;const t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.id="joyride-beacon-animation",e.nonce&&r.setAttribute("nonce",e.nonce),r.appendChild(document.createTextNode(`
        @keyframes joyride-beacon-inner {
          20% {
            opacity: 0.9;
          }
        
          90% {
            opacity: 0.7;
          }
        }
        
        @keyframes joyride-beacon-outer {
          0% {
            transform: scale(1);
          }
        
          45% {
            opacity: 0.7;
            transform: scale(0.75);
          }
        
          100% {
            opacity: 0.9;
            transform: scale(1);
          }
        }
      `)),t.appendChild(r)}componentDidMount(){const{shouldFocus:e}=this.props;setTimeout(()=>{Jt.domElement(this.beacon)&&e&&this.beacon.focus()},0)}componentWillUnmount(){const e=document.getElementById("joyride-beacon-animation");e!=null&&e.parentNode&&e.parentNode.removeChild(e)}render(){const{beaconComponent:e,continuous:t,index:r,isLastStep:n,locale:a,onClickOrHover:i,size:o,step:l,styles:c}=this.props,d=fl(a.open),u={"aria-label":d,onClick:i,onMouseEnter:i,ref:this.setBeaconRef,title:d};let f;if(e){const h=e;f=x.createElement(h,M({continuous:t,index:r,isLastStep:n,size:o,step:l},u))}else f=x.createElement("button",M({key:"JoyrideBeacon",className:"react-joyride__beacon","data-test-id":"button-beacon",style:c.beacon,type:"button"},u),x.createElement("span",{style:c.beaconInner}),x.createElement("span",{style:c.beaconOuter}));return f}};function Txe(r){var n=r,{styles:e}=n,t=me(n,["styles"]);const c=e,{color:a,height:i,width:o}=c,l=me(c,["color","height","width"]);return J.createElement("button",M({style:l,type:"button"},t),J.createElement("svg",{height:typeof i=="number"?`${i}px`:i,preserveAspectRatio:"xMidYMid",version:"1.1",viewBox:"0 0 18 18",width:typeof o=="number"?`${o}px`:o,xmlns:"http://www.w3.org/2000/svg"},J.createElement("g",null,J.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:a}))))}var Axe=Txe;function Rxe(e){const{backProps:t,closeProps:r,index:n,isLastStep:a,primaryProps:i,skipProps:o,step:l,tooltipProps:c}=e,{content:d,hideBackButton:u,hideCloseButton:f,hideFooter:h,showSkipButton:p,styles:g,title:v}=l,y={};return y.primary=x.createElement("button",M({"data-test-id":"button-primary",style:g.buttonNext,type:"button"},i)),p&&!a&&(y.skip=x.createElement("button",M({"aria-live":"off","data-test-id":"button-skip",style:g.buttonSkip,type:"button"},o))),!u&&n>0&&(y.back=x.createElement("button",M({"data-test-id":"button-back",style:g.buttonBack,type:"button"},t))),y.close=!f&&x.createElement(Axe,M({"data-test-id":"button-close",styles:g.buttonClose},r)),x.createElement("div",M({key:"JoyrideTooltip","aria-label":fl(v!=null?v:d),className:"react-joyride__tooltip",style:g.tooltip},c),x.createElement("div",{style:g.tooltipContainer},v&&x.createElement("h1",{"aria-label":fl(v),style:g.tooltipTitle},v),x.createElement("div",{style:g.tooltipContent},d)),!h&&x.createElement("div",{style:g.tooltipFooter},x.createElement("div",{style:g.tooltipFooterSpacer},y.skip),y.back,y.primary),y.close)}var Oxe=Rxe,Mxe=class extends x.Component{constructor(){super(...arguments),tr(this,"handleClickBack",e=>{e.preventDefault();const{helpers:t}=this.props;t.prev()}),tr(this,"handleClickClose",e=>{e.preventDefault();const{helpers:t}=this.props;t.close("button_close")}),tr(this,"handleClickPrimary",e=>{e.preventDefault();const{continuous:t,helpers:r}=this.props;if(!t){r.close("button_primary");return}r.next()}),tr(this,"handleClickSkip",e=>{e.preventDefault();const{helpers:t}=this.props;t.skip()}),tr(this,"getElementsProps",()=>{const{continuous:e,index:t,isLastStep:r,setTooltipRef:n,size:a,step:i}=this.props,{back:o,close:l,last:c,next:d,nextLabelWithProgress:u,skip:f}=i.locale,h=fl(o),p=fl(l),g=fl(c),v=fl(d),y=fl(f);let _=l,w=p;if(e){if(_=d,w=v,i.showProgress&&!r){const b=fl(u,{step:t+1,steps:a});_=I2(u,t+1,a),w=b}r&&(_=c,w=g)}return{backProps:{"aria-label":h,children:o,"data-action":"back",onClick:this.handleClickBack,role:"button",title:h},closeProps:{"aria-label":p,children:l,"data-action":"close",onClick:this.handleClickClose,role:"button",title:p},primaryProps:{"aria-label":w,children:_,"data-action":"primary",onClick:this.handleClickPrimary,role:"button",title:w},skipProps:{"aria-label":y,children:f,"data-action":"skip",onClick:this.handleClickSkip,role:"button",title:y},tooltipProps:{"aria-modal":!0,ref:n,role:"alertdialog"}}})}render(){const{continuous:e,index:t,isLastStep:r,setTooltipRef:n,size:a,step:i}=this.props,u=i,{beaconComponent:o,tooltipComponent:l}=u,c=me(u,["beaconComponent","tooltipComponent"]);let d;if(l){const f=H(M({},this.getElementsProps()),{continuous:e,index:t,isLastStep:r,size:a,step:c,setTooltipRef:n}),h=l;d=x.createElement(h,M({},f))}else d=x.createElement(Oxe,H(M({},this.getElementsProps()),{continuous:e,index:t,isLastStep:r,size:a,step:i}));return d}},Dxe=class extends x.Component{constructor(){super(...arguments),tr(this,"scope",null),tr(this,"tooltip",null),tr(this,"handleClickHoverBeacon",e=>{const{step:t,store:r}=this.props;e.type==="mouseenter"&&t.event!=="hover"||r.update({lifecycle:Tr.TOOLTIP})}),tr(this,"setTooltipRef",e=>{this.tooltip=e}),tr(this,"setPopper",(e,t)=>{var r;const{action:n,lifecycle:a,step:i,store:o}=this.props;t==="wrapper"?o.setPopper("beacon",e):o.setPopper("tooltip",e),o.getPopper("beacon")&&(o.getPopper("tooltip")||i.placement==="center")&&a===Tr.INIT&&o.update({action:n,lifecycle:Tr.READY}),(r=i.floaterProps)!=null&&r.getPopper&&i.floaterProps.getPopper(e,t)}),tr(this,"renderTooltip",e=>{const{continuous:t,helpers:r,index:n,size:a,step:i}=this.props;return x.createElement(Mxe,M({continuous:t,helpers:r,index:n,isLastStep:n+1===a,setTooltipRef:this.setTooltipRef,size:a,step:i},e))})}componentDidMount(){const{debug:e,index:t}=this.props;hh({title:`step:${t}`,data:[{key:"props",value:this.props}],debug:e})}componentDidUpdate(e){var t;const{action:r,callback:n,continuous:a,controlled:i,debug:o,helpers:l,index:c,lifecycle:d,shouldScroll:u,status:f,step:h,store:p}=this.props,{changed:g,changedFrom:v}=fw(e,this.props),y=l.info(),_=a&&r!==gn.CLOSE&&(c>0||r===gn.PREV),w=g("action")||g("index")||g("lifecycle")||g("status"),b=v("lifecycle",[Tr.TOOLTIP,Tr.INIT],Tr.INIT),N=g("action",[gn.NEXT,gn.PREV,gn.SKIP,gn.CLOSE]),S=i&&c===e.index;if(N&&(b||S)&&n(H(M({},y),{index:e.index,lifecycle:Tr.COMPLETE,step:e.step,type:qs.STEP_AFTER})),h.placement==="center"&&f===Zr.RUNNING&&g("index")&&r!==gn.START&&d===Tr.INIT&&p.update({lifecycle:Tr.READY}),w){const k=pc(h.target),P=!!k;P&&oxe(k)?(v("status",Zr.READY,Zr.RUNNING)||v("lifecycle",Tr.INIT,Tr.READY))&&n(H(M({},y),{step:h,type:qs.STEP_BEFORE})):(console.warn(P?"Target not visible":"Target not mounted",h),n(H(M({},y),{type:qs.TARGET_NOT_FOUND,step:h})),i||p.update({index:c+(r===gn.PREV?-1:1)}))}v("lifecycle",Tr.INIT,Tr.READY)&&p.update({lifecycle:v4(h)||_?Tr.TOOLTIP:Tr.BEACON}),g("index")&&hh({title:`step:${d}`,data:[{key:"props",value:this.props}],debug:o}),g("lifecycle",Tr.BEACON)&&n(H(M({},y),{step:h,type:qs.BEACON})),g("lifecycle",Tr.TOOLTIP)&&(n(H(M({},y),{step:h,type:qs.TOOLTIP})),u&&this.tooltip&&(this.scope=new Cxe(this.tooltip,{selector:"[data-action=primary]"}),this.scope.setFocus())),v("lifecycle",[Tr.TOOLTIP,Tr.INIT],Tr.INIT)&&((t=this.scope)==null||t.removeScope(),p.cleanupPoppers())}componentWillUnmount(){var e;(e=this.scope)==null||e.removeScope()}get open(){const{lifecycle:e,step:t}=this.props;return v4(t)||e===Tr.TOOLTIP}render(){const{continuous:e,debug:t,index:r,nonce:n,shouldScroll:a,size:i,step:o}=this.props,l=pc(o.target);return!n7(o)||!Jt.domElement(l)?null:x.createElement("div",{key:`JoyrideStep-${r}`,className:"react-joyride__step"},x.createElement(nA,H(M({},o.floaterProps),{component:this.renderTooltip,debug:t,getPopper:this.setPopper,id:`react-joyride-step-${r}`,open:this.open,placement:o.placement,target:o.target}),x.createElement(Pxe,{beaconComponent:o.beaconComponent,continuous:e,index:r,isLastStep:r+1===i,locale:o.locale,nonce:n,onClickOrHover:this.handleClickHoverBeacon,shouldFocus:a,size:i,step:o,styles:o.styles})))}},a7=class extends x.Component{constructor(e){super(e),tr(this,"helpers"),tr(this,"store"),tr(this,"callback",o=>{const{callback:l}=this.props;Jt.function(l)&&l(o)}),tr(this,"handleKeyboard",o=>{const{index:l,lifecycle:c}=this.state,{steps:d}=this.props,u=d[l];c===Tr.TOOLTIP&&o.code==="Escape"&&u&&!u.disableCloseOnEsc&&this.store.close("keyboard")}),tr(this,"handleClickOverlay",()=>{const{index:o}=this.state,{steps:l}=this.props;Qh(this.props,l[o]).disableOverlayClose||this.helpers.close("overlay")}),tr(this,"syncState",o=>{this.setState(o)});const{debug:t,getHelpers:r,run:n=!0,stepIndex:a}=e;this.store=jxe(H(M({},e),{controlled:n&&Jt.number(a)})),this.helpers=this.store.getHelpers();const{addListener:i}=this.store;hh({title:"init",data:[{key:"props",value:this.props},{key:"state",value:this.state}],debug:t}),i(this.syncState),r&&r(this.helpers),this.state=this.store.getState()}componentDidMount(){if(!dd())return;const{debug:e,disableCloseOnEsc:t,run:r,steps:n}=this.props,{start:a}=this.store;_4(n,e)&&r&&a(),t||document.body.addEventListener("keydown",this.handleKeyboard,{passive:!0})}componentDidUpdate(e,t){if(!dd())return;const{action:r,controlled:n,index:a,status:i}=this.state,{debug:o,run:l,stepIndex:c,steps:d}=this.props,{stepIndex:u,steps:f}=e,{reset:h,setSteps:p,start:g,stop:v,update:y}=this.store,{changed:_}=fw(e,this.props),{changed:w,changedFrom:b}=fw(t,this.state),N=Qh(this.props,d[a]),S=!Ua(f,d),k=Jt.number(c)&&_("stepIndex"),P=pc(N.target);if(S&&(_4(d,o)?p(d):console.warn("Steps are not valid",d)),_("run")&&(l?g(c):v()),k){let $=Jt.number(u)&&u<c?gn.NEXT:gn.PREV;r===gn.STOP&&($=gn.START),[Zr.FINISHED,Zr.SKIPPED].includes(i)||y({action:r===gn.CLOSE?gn.CLOSE:$,index:c,lifecycle:Tr.INIT})}!n&&i===Zr.RUNNING&&a===0&&!P&&(this.store.update({index:a+1}),this.callback(H(M({},this.state),{type:qs.TARGET_NOT_FOUND,step:N})));const A=H(M({},this.state),{index:a,step:N});if(w("action",[gn.NEXT,gn.PREV,gn.SKIP,gn.CLOSE])&&w("status",Zr.PAUSED)){const $=Qh(this.props,d[t.index]);this.callback(H(M({},A),{index:t.index,lifecycle:Tr.COMPLETE,step:$,type:qs.STEP_AFTER}))}if(w("status",[Zr.FINISHED,Zr.SKIPPED])){const $=Qh(this.props,d[t.index]);n||this.callback(H(M({},A),{index:t.index,lifecycle:Tr.COMPLETE,step:$,type:qs.STEP_AFTER})),this.callback(H(M({},A),{type:qs.TOUR_END,step:$,index:t.index})),h()}else b("status",[Zr.IDLE,Zr.READY],Zr.RUNNING)?this.callback(H(M({},A),{type:qs.TOUR_START})):(w("status")||w("action",gn.RESET))&&this.callback(H(M({},A),{type:qs.TOUR_STATUS}));this.scrollToStep(t)}componentWillUnmount(){const{disableCloseOnEsc:e}=this.props;e||document.body.removeEventListener("keydown",this.handleKeyboard)}scrollToStep(e){const{index:t,lifecycle:r,status:n}=this.state,{debug:a,disableScrollParentFix:i=!1,scrollDuration:o,scrollOffset:l=20,scrollToFirstStep:c=!1,steps:d}=this.props,u=Qh(this.props,d[t]),f=pc(u.target),h=pxe({isFirstStep:t===0,lifecycle:r,previousLifecycle:e.lifecycle,scrollToFirstStep:c,step:u,target:f});if(n===Zr.RUNNING&&h){const p=B1(f,i),g=Wv(f,i);let v=Math.floor(cxe(f,l,i))||0;hh({title:"scrollToStep",data:[{key:"index",value:t},{key:"lifecycle",value:r},{key:"status",value:n}],debug:a});const y=this.store.getPopper("beacon"),_=this.store.getPopper("tooltip");if(r===Tr.BEACON&&y){const{offsets:w,placement:b}=y;!["bottom"].includes(b)&&!p&&(v=Math.floor(w.popper.top-l))}else if(r===Tr.TOOLTIP&&_){const{flipped:w,offsets:b,placement:N}=_;["top","right","left"].includes(N)&&!w&&!p?v=Math.floor(b.popper.top-l):v-=u.spotlightPadding}v=v>=0?v:0,n===Zr.RUNNING&&dxe(v,{element:g,duration:o}).then(()=>{setTimeout(()=>{var w;(w=this.store.getPopper("tooltip"))==null||w.instance.update()},10)})}}render(){if(!dd())return null;const{index:e,lifecycle:t,status:r}=this.state,{continuous:n=!1,debug:a=!1,nonce:i,scrollToFirstStep:o=!1,steps:l}=this.props,c=r===Zr.RUNNING,d={};if(c&&l[e]){const u=Qh(this.props,l[e]);d.step=x.createElement(Dxe,H(M({},this.state),{callback:this.callback,continuous:n,debug:a,helpers:this.helpers,nonce:i,shouldScroll:!u.disableScrolling&&(e!==0||o),step:u,store:this.store})),d.overlay=x.createElement(Exe,{id:"react-joyride-portal"},x.createElement(kxe,H(M({},u),{continuous:n,debug:a,lifecycle:t,onClickOverlay:this.handleClickOverlay})))}return x.createElement("div",{className:"react-joyride"},d.step,d.overlay)}};tr(a7,"defaultProps",yxe);var Ixe=a7;class Ou{static checkOnboardingStatus(t){return E(this,null,function*(){var r,n,a,i;try{const{data:o,error:l}=yield T.from("users").select("onboarding_completed, onboarding_skipped, tour_completed").eq("user_id",t).single();if(l){if(l.code==="42703"||(r=l.message)!=null&&r.includes("does not exist"))return console.warn("Onboarding columns not found in users table, returning defaults"),{onboarding_completed:!1,onboarding_skipped:!1,tour_completed:!1};throw l}return{onboarding_completed:(n=o==null?void 0:o.onboarding_completed)!=null?n:!1,onboarding_skipped:(a=o==null?void 0:o.onboarding_skipped)!=null?a:!1,tour_completed:(i=o==null?void 0:o.tour_completed)!=null?i:!1}}catch(o){return console.error("Error checking onboarding status:",o),{onboarding_completed:!1,onboarding_skipped:!1,tour_completed:!1}}})}static saveProfileSetup(t,r){return E(this,null,function*(){var n,i,o,l;try{const c={updated_at:new Date().toISOString()};r.username!==void 0&&(c.username=String(r.username).toLowerCase().trim()),r.birthday!==void 0&&(c.birthday=r.birthday),r.gender!==void 0&&(c.gender=r.gender),r.bio!==void 0&&(c.bio=r.bio),r.avatar_url!==void 0&&(c.avatar_url=r.avatar_url),r.location_city!==void 0&&(c.location_city=r.location_city);const{error:d}=yield T.from("users").update(c).eq("user_id",t);if(d){if(d.code==="PGRST204"||(n=d.message)!=null&&n.includes("does not exist")){console.warn("Some columns not found, trying without them:",d.message);const a=c,{username:u,location_city:f}=a,h=me(a,["username","location_city"]),{error:p}=yield T.from("users").update(h).eq("user_id",t);if(p)throw p.code==="23505"&&((i=p.message)!=null&&i.includes("username"))?new Error("Username is already taken"):p;return!0}throw d.code==="23505"&&((o=d.message)!=null&&o.includes("username"))?new Error("Username is already taken"):d}return!0}catch(c){if(console.error("Error saving profile setup:",c),(l=c==null?void 0:c.message)!=null&&l.includes("Username is already taken"))throw c;return!1}})}static requestAccountUpgrade(t,r,n){return E(this,null,function*(){try{const{error:a}=yield T.from("account_upgrade_requests").insert({user_id:t,requested_account_type:r,business_info:n,status:"pending"});if(a)throw a;return!0}catch(a){return console.error("Error requesting account upgrade:",a),!1}})}static skipOnboarding(t){return E(this,null,function*(){var r;try{const{error:n}=yield T.from("users").update({onboarding_skipped:!0,updated_at:new Date().toISOString()}).eq("user_id",t);if(n){if(n.code==="42703"||(r=n.message)!=null&&r.includes("does not exist"))return console.warn("onboarding_skipped column not found, skipping update"),!0;throw n}return!0}catch(n){return console.error("Error skipping onboarding:",n),!1}})}static completeOnboarding(t){return E(this,null,function*(){var r;try{const{error:n}=yield T.from("users").update({onboarding_completed:!0,onboarding_skipped:!1,updated_at:new Date().toISOString()}).eq("user_id",t);if(n){if(n.code==="42703"||(r=n.message)!=null&&r.includes("does not exist"))return console.warn("onboarding_completed column not found, skipping update"),!0;throw n}return!0}catch(n){return console.error("Error completing onboarding:",n),!1}})}static completeTour(t){return E(this,null,function*(){var r;try{const{error:n}=yield T.from("users").update({tour_completed:!0,updated_at:new Date().toISOString()}).eq("user_id",t);if(n){if(n.code==="42703"||(r=n.message)!=null&&r.includes("does not exist"))return console.warn("tour_completed column not found, skipping update"),!0;throw n}return!0}catch(n){return console.error("Error completing tour:",n),!1}})}static hasPendingUpgradeRequest(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("account_upgrade_requests").select("id, status").eq("user_id",t).eq("status","pending").maybeSingle();if(n)throw n;return r!==null}catch(r){return console.error("Error checking pending upgrade request:",r),!1}})}static saveMusicPreferences(t,r,n){return E(this,null,function*(){try{const a=[],i=new Date().toISOString();if(r.forEach((o,l)=>{const c=Math.max(10-l,1);a.push({user_id:t,signal_type:"genre_manual_preference",entity_type:"genre",entity_id:null,entity_name:o,signal_weight:c,genre:o,context:{source:"onboarding",order:l+1},occurred_at:i,created_at:i,updated_at:i})}),n.forEach((o,l)=>{const c=Math.max(10-l,1);a.push({user_id:t,signal_type:"artist_manual_preference",entity_type:"artist",entity_id:o.id||null,entity_name:o.name,signal_weight:c,genre:null,context:{source:"onboarding",order:l+1},occurred_at:i,created_at:i,updated_at:i})}),a.length>0){const{error:o}=yield T.from("user_preference_signals").insert(a);if(o)return console.error("Error saving music preferences:",o),!1}return!0}catch(a){return console.error("Error saving music preferences:",a),!1}})}}const ef=(e,t=8e3,r=50)=>new Promise((n,a)=>{const i=Date.now(),o=document.querySelector(e);if(o&&o.offsetParent!==null&&o.getBoundingClientRect().width>0){n(o);return}const l=new MutationObserver(()=>{const d=document.querySelector(e);if(d){const u=d.getBoundingClientRect();if(d.offsetParent!==null&&u.width>0&&u.height>0){l.disconnect(),n(d);return}}if(Date.now()-i>=t){l.disconnect(),a(new Error(`Timeout waiting for element: ${e}`));return}});l.observe(document.body,{childList:!0,subtree:!0,attributes:!1});const c=setInterval(()=>{const d=document.querySelector(e);if(d){const u=d.getBoundingClientRect();if(d.offsetParent!==null&&u.width>0&&u.height>0){clearInterval(c),l.disconnect(),n(d);return}}Date.now()-i>=t&&(clearInterval(c),l.disconnect(),a(new Error(`Timeout waiting for element: ${e}`)))},r)}),$xe=({run:e,onFinish:t,onViewChange:r})=>{const{user:n}=xs(),[a,i]=x.useState(e),[o,l]=x.useState(void 0),[c,d]=x.useState(!1),[u,f]=x.useState(""),h=J.useRef(null);x.useEffect(()=>{i(e),e||(l(void 0),d(!1),f(""))},[e]),x.useEffect(()=>{if(a&&o===2){const v=setInterval(()=>{(document.querySelector("[data-joyride]")||document.querySelector(".react-joyride__tooltip")||document.querySelector('[role="dialog"]'))&&(console.log("Step 3 tooltip detected, clearing stepIndex for button clicks"),l(void 0),clearInterval(v))},50);return setTimeout(()=>{clearInterval(v),o===2&&(console.log("Timeout clearing stepIndex"),l(void 0))},2e3),()=>clearInterval(v)}},[a,o]),x.useEffect(()=>{a&&h.current===2&&o===void 0&&(console.log("Resuming tour at step 3, setting stepIndex briefly"),l(2),setTimeout(()=>{console.log("Clearing stepIndex after resume"),l(void 0),h.current=null},50))},[a,o]),x.useEffect(()=>{a&&h.current===4&&o===void 0&&(console.log("Resuming tour at step 5, setting stepIndex briefly"),l(4),setTimeout(()=>{console.log("Clearing stepIndex after resume step 5"),l(void 0),h.current=null},50))},[a,o]),x.useEffect(()=>{a&&h.current===5&&o===void 0&&(console.log("Resuming tour at step 6, setting stepIndex briefly"),l(5),setTimeout(()=>{console.log("Clearing stepIndex after resume step 6"),l(void 0),h.current=null},50))},[a,o]);const p=[{target:"body",content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Welcome to Synth! "}),s.jsx("p",{children:"Let's take a quick tour of the app to help you discover shows, connect with friends, and share your concert experiences."})]}),placement:"center",disableBeacon:!0,before:()=>{r&&r("feed")}},{target:'[data-tour="feed-toggle"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Toggle Your Feed"}),s.jsx("p",{children:"Switch between different feed types: Hand Picked Events, Trending Events, Friends Interested, and more. Each feed shows you different perspectives on what's happening."})]}),placement:"bottom",disableBeacon:!0,before:()=>E(void 0,null,function*(){r&&r("feed"),yield new Promise(v=>setTimeout(v,300)),yield new Promise(v=>requestAnimationFrame(v));try{(yield ef('[data-tour="feed-toggle"]',5e3)).scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(y=>setTimeout(y,400))}catch(v){throw console.error("Step 2: Element not found:",v),v}})},{target:'[data-tour="discover-vibes"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Discover by Vibes"}),s.jsx("p",{children:"Browse Vibes lets you explore events by mood and scene. You can also use the Map & Calendar view to see events by location and date. Try different vibes to find shows that match your energy!"})]}),placement:"bottom",disableBeacon:!0,before:()=>E(void 0,null,function*(){console.log("Step 3 before: Checking if discover view is ready"),r&&r("search"),yield new Promise(_=>setTimeout(_,200)),yield new Promise(_=>requestAnimationFrame(_)),yield new Promise(_=>requestAnimationFrame(_)),console.log("Step 3 before: Waiting for element...");const v=yield ef('[data-tour="discover-vibes"]',1e4);console.log("Step 3 before: Element found!",v),v.scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(_=>setTimeout(_,400));const y=v.getBoundingClientRect();if(y.width===0||y.height===0||v.offsetParent===null)throw console.error("Step 3 before: Element not visible!",y),new Error("Target element not visible");console.log("Step 3 before: Element verified and ready")})},{target:'[data-tour="create-review"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Share Your Experience"}),s.jsx("p",{children:"Tap the pink plus button to create a review for any show you've attended. Share photos, rate the performance, and let your friends know what you thought!"})]}),placement:"top",disableBeacon:!0,before:()=>E(void 0,null,function*(){r&&r("feed"),yield new Promise(v=>setTimeout(v,300)),yield new Promise(v=>requestAnimationFrame(v));try{(yield ef('[data-tour="create-review"]',5e3)).scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(y=>setTimeout(y,400))}catch(v){throw console.error("Step 4: Element not found:",v),v}})},{target:'[data-tour="chat"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Connect with Friends"}),s.jsx("p",{children:"Use the messages icon to chat with friends, join group conversations about shows, and stay connected with your concert community."})]}),placement:"top",disableBeacon:!0,before:()=>E(void 0,null,function*(){console.log("Step 5 before: Verifying chat view is loaded");try{Array.from(document.querySelectorAll("h1")).find(_=>{var w;return((w=_.textContent)==null?void 0:w.trim())==="Messages"})||(console.warn("Step 5 before: Messages heading not found, waiting..."),yield new Promise(_=>setTimeout(_,300))),console.log("Step 5 before: Waiting for chat navigation button...");const y=yield ef('[data-tour="chat"]',8e3);console.log("Step 5 before: Chat navigation button found!"),y.scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(_=>setTimeout(_,400))}catch(v){console.error("Step 5: Element not found:",v)}})},{target:'[data-tour="profile-passport"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Your Live Music Passport"}),s.jsx("p",{children:"Check out your profile and Live Music Passport! See your identity, stamps, achievements, timeline, and bucket list. Track your concert journey all in one place."})]}),placement:"top",disableBeacon:!0,before:()=>E(void 0,null,function*(){console.log("Step 6 before: Navigating to profile view"),r&&r("profile"),yield new Promise(v=>setTimeout(v,400)),yield new Promise(v=>requestAnimationFrame(v)),yield new Promise(v=>requestAnimationFrame(v));try{console.log("Step 6 before: Waiting for profile-passport element...");const v=yield ef('[data-tour="profile-passport"]',6e3);console.log("Step 6 before: Profile-passport element found!"),v.scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(y=>setTimeout(y,400))}catch(v){console.error("Step 6: Element not found:",v)}})},{target:"body",content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"You're All Set! "}),s.jsx("p",{children:"You've completed the tour! Start exploring shows, connecting with friends, and sharing your concert experiences. Have fun!"})]}),placement:"center",disableBeacon:!0,before:()=>E(void 0,null,function*(){r&&r("feed"),yield new Promise(v=>setTimeout(v,500))})}],g=v=>E(void 0,null,function*(){const{status:y,type:_,index:w,action:b}=v;if(_===qs.STEP_AFTER&&b===gn.NEXT&&w===1&&r){console.log("Step 2 completed: Pausing tour to load discover view"),i(!1),d(!0),f("Loading discover page..."),r("search"),yield new Promise(N=>setTimeout(N,300)),yield new Promise(N=>requestAnimationFrame(N)),yield new Promise(N=>requestAnimationFrame(N));try{yield ef('[data-tour="discover-vibes"]',15e3),console.log("Step 3 target is ready, resuming tour"),yield new Promise(N=>setTimeout(N,300)),h.current=2,d(!1),f(""),l(void 0),yield new Promise(N=>setTimeout(N,100)),i(!0)}catch(N){console.error("Step 3 target not ready, resuming anyway:",N),d(!1),f(""),l(void 0),yield new Promise(S=>setTimeout(S,100)),i(!0)}return}if(_===qs.STEP_BEFORE&&w===2&&(console.log("Step 3 shown, immediately clearing stepIndex to enable buttons"),l(void 0),setTimeout(()=>{const N=document.querySelector('[data-test-id="button-primary"]');N&&(console.log("Button found, ensuring it is clickable"),N.style.pointerEvents="auto",N.style.cursor="pointer")},0)),_===qs.STEP_AFTER&&w===2&&o===2&&(console.log("Step 3 completed, clearing stepIndex"),l(void 0)),_===qs.STEP_BEFORE&&w===4&&(console.log("Step 5 shown, immediately clearing stepIndex to enable buttons"),l(void 0),setTimeout(()=>{const N=['[data-action="primary"]','[data-test-id="button-primary"]','button[class*="buttonNext"]','button:contains("Next")',".react-joyride__tooltip button:last-child",'.react-joyride__tooltip [role="button"]:last-child','button[aria-label*="Next"]'],S=new Set;for(const A of N)try{Array.from(document.querySelectorAll(A)).forEach($=>{if(S.has($))return;const O=$.textContent||"";(O.includes("Next")||O.includes("Step 5"))&&(console.log(`Step 5 button found with selector: ${A}`),S.add($),$.style.pointerEvents="auto",$.style.cursor="pointer",$.style.zIndex="99999",$.style.position="relative",$.removeAttribute("disabled"),$ instanceof HTMLButtonElement&&($.disabled=!1,$.setAttribute("aria-disabled","false")))})}catch(R){}Array.from(document.querySelectorAll("button")).forEach(A=>{if(S.has(A))return;const R=A.textContent||"";R.includes("Next")&&R.includes("Step 5")&&(console.log("Step 5 button found by text search"),S.add(A),A.style.pointerEvents="auto",A.style.cursor="pointer",A.style.zIndex="99999",A.style.position="relative",A.disabled=!1,A.removeAttribute("disabled"),A.setAttribute("aria-disabled","false"))}),document.querySelectorAll('[class*="overlay"]').forEach(A=>{A.style.pointerEvents="none",A.style.zIndex="1"})},0),setTimeout(()=>{l(void 0),Array.from(document.querySelectorAll("button")).forEach(S=>{(S.textContent||"").includes("Next")&&(S.style.pointerEvents="auto !important",S.style.cursor="pointer !important",S.disabled=!1)})},100)),_===qs.STEP_AFTER&&w===4&&o===4&&(console.log("Step 5 completed, clearing stepIndex"),l(void 0)),_===qs.STEP_AFTER&&b===gn.NEXT&&w===4&&r){console.log("Step 5 completed: Pausing tour to load profile view"),i(!1),d(!0),f("Loading Profile page..."),r("profile");try{console.log("Step 5 completed: Waiting for profile view to load..."),yield new Promise(k=>setTimeout(k,500)),yield new Promise(k=>requestAnimationFrame(k)),yield new Promise(k=>requestAnimationFrame(k)),yield new Promise(k=>requestAnimationFrame(k));let N=!1,S=0;for(;!N&&S<100;){if(document.querySelector('[data-tour="profile-passport"]')){console.log("Profile view is ready, resuming tour"),N=!0;break}yield new Promise(P=>setTimeout(P,100)),S++}N||console.warn("Profile view loading timeout, proceeding anyway"),yield new Promise(k=>setTimeout(k,500)),d(!1),f(""),h.current=5,l(void 0),yield new Promise(k=>setTimeout(k,100)),i(!0),setTimeout(()=>{h.current=null},200)}catch(N){console.error("Profile view loading error:",N),d(!1),f(""),h.current=5,l(void 0),yield new Promise(S=>setTimeout(S,100)),i(!0),setTimeout(()=>{h.current=null},200)}return}if(_===qs.STEP_AFTER&&b===gn.NEXT&&w===3&&r){console.log("Step 4 completed: Pausing tour to load chat view"),i(!1),d(!0),f("Loading Chat page..."),r("chat");try{console.log("Step 4 completed: Waiting for chat view to load..."),yield new Promise(k=>setTimeout(k,500)),yield new Promise(k=>requestAnimationFrame(k)),yield new Promise(k=>requestAnimationFrame(k)),yield new Promise(k=>requestAnimationFrame(k));let N=!1,S=0;for(;!N&&S<100;){if(Array.from(document.querySelectorAll("h1")).find(P=>{var A;return((A=P.textContent)==null?void 0:A.trim())==="Messages"})){console.log("Chat view is ready, resuming tour"),N=!0;break}yield new Promise(P=>setTimeout(P,100)),S++}N||console.warn("Chat view loading timeout, proceeding anyway"),yield new Promise(k=>setTimeout(k,500)),d(!1),f(""),h.current=4,l(void 0),yield new Promise(k=>setTimeout(k,100)),i(!0),setTimeout(()=>{l(void 0),h.current=null},200)}catch(N){console.error("Chat view loading error:",N),d(!1),f(""),h.current=4,l(void 0),yield new Promise(S=>setTimeout(S,100)),i(!0),setTimeout(()=>{l(void 0),h.current=null},200)}return}(y===Zr.FINISHED||y===Zr.SKIPPED)&&(i(!1),l(void 0),d(!1),f(""),n&&(yield Ou.completeTour(n.id)),t()),_===qs.TARGET_NOT_FOUND&&console.error("Joyride: Target not found for step",w,v)});return c?s.jsx("div",{className:"fixed inset-0 z-[9999] bg-[#fcfcfc] flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#cc2486] mx-auto"}),s.jsx("p",{className:"text-lg font-medium text-gray-700",children:u})]})}):a?s.jsx(Ixe,H(M({steps:p,run:a},typeof o=="number"?{stepIndex:o}:{}),{continuous:!0,disableScrolling:!1,showProgress:!0,showSkipButton:!0,spotlightClicks:!0,callback:g,disableOverlayClose:!1,styles:{options:{primaryColor:"#cc2486",textColor:"#0e0e0e",backgroundColor:"#fcfcfc",arrowColor:"#fcfcfc",overlayColor:"rgba(0, 0, 0, 0)",zIndex:1e4,width:"max(320px, min(393px, 90vw))"},tooltip:{borderRadius:12,padding:20,maxWidth:"393px",fontSize:"14px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},tooltipContainer:{textAlign:"left"},buttonNext:{backgroundColor:"#cc2486",borderRadius:8,fontSize:14,padding:"10px 20px",fontWeight:600,color:"#fff",border:"none",outline:"none",cursor:"pointer !important",pointerEvents:"auto !important",zIndex:10001},buttonBack:{color:"#5d646f",fontSize:14,marginRight:10,border:"none",outline:"none"},buttonSkip:{color:"#5d646f",fontSize:14,border:"none",outline:"none"},overlay:{mixBlendMode:"normal",backgroundColor:"rgba(0, 0, 0, 0)",cursor:"default",pointerEvents:"none"},spotlight:{borderRadius:12,boxShadow:"0 0 0 4px rgba(204, 36, 134, 0.6), 0 0 30px rgba(204, 36, 134, 0.4)",backgroundColor:"transparent"},spotlightLegacy:{borderRadius:12}},locale:{back:"Back",close:"Close",last:"Finish",next:"Next",skip:"Skip Tour"}})):null},Lxe=({initialData:e,onNext:t,onSkip:r})=>{const[n,a]=x.useState({username:(e==null?void 0:e.username)||"",location_city:(e==null?void 0:e.location_city)||"",birthday:(e==null?void 0:e.birthday)||"",gender:(e==null?void 0:e.gender)||"",bio:(e==null?void 0:e.bio)||"",avatar_url:(e==null?void 0:e.avatar_url)||""}),[i,o]=x.useState({}),[l,c]=x.useState(!1),[d,u]=x.useState(!1),f=x.useRef(null),{user:h}=xs(),{toast:p}=Rr(),g=w=>E(void 0,null,function*(){var k;const b=(k=w.target.files)==null?void 0:k[0];if(!b||!h)return;if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(b.type)){p({title:"Invalid file type",description:"Please select a JPEG, PNG, or WebP image.",variant:"destructive"});return}const S=5*1024*1024;if(b.size>S){p({title:"File too large",description:"Please select an image smaller than 5MB.",variant:"destructive"});return}c(!0);try{const P=b.name.split(".").pop(),A=`${h.id}/${Date.now()}.${P}`,{data:R,error:$}=yield T.storage.from("profile-avatars").upload(A,b,{cacheControl:"3600",upsert:!1});if($)throw $;const{data:O}=T.storage.from("profile-avatars").getPublicUrl(R.path);a(H(M({},n),{avatar_url:O.publicUrl})),p({title:"Photo uploaded",description:"Your profile photo has been uploaded successfully."})}catch(P){console.error("Upload error:",P),p({title:"Upload failed",description:"Failed to upload photo. Please try again.",variant:"destructive"})}finally{c(!1)}}),v=w=>E(void 0,null,function*(){if(!w.trim())return!1;try{const{data:b,error:N}=yield T.from("users").select("username").eq("username",w.toLowerCase().trim()).limit(1);return N&&N.code!=="PGRST116"?(console.warn("Error checking username:",N),!0):!b||b.length===0}catch(b){return console.error("Error checking username availability:",b),!0}}),y=()=>E(void 0,null,function*(){const w=n.username.trim();if(!w){o(H(M({},i),{username:""}));return}if(!/^[a-zA-Z0-9_]{3,20}$/.test(w)){o(H(M({},i),{username:"Username must be 3-20 characters, letters, numbers, and underscores only"}));return}u(!0);const N=yield v(w);u(!1),o(N?H(M({},i),{username:""}):H(M({},i),{username:"This username is already taken"}))}),_=w=>E(void 0,null,function*(){w.preventDefault();const b={},N=n.username.trim();if(!N)b.username="Username is required";else if(!/^[a-zA-Z0-9_]{3,20}$/.test(N))b.username="Username must be 3-20 characters, letters, numbers, and underscores only";else{u(!0);const k=yield v(N);u(!1),k||(b.username="This username is already taken")}if(n.location_city.trim()||(b.location_city="City is required"),!n.birthday)b.birthday="Birthday is required";else{const S=new Date(n.birthday),k=new Date,P=k.getFullYear()-S.getFullYear(),A=k.getMonth()-S.getMonth();A<0||A===0&&k.getDate()<S.getDate()?P-1<13&&(b.birthday="You must be at least 13 years old"):P<13&&(b.birthday="You must be at least 13 years old")}if(n.bio.length>120&&(b.bio="Bio must be 120 characters or less"),Object.keys(b).length>0){o(b);return}t(n)});return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Welcome to Synth!"}),s.jsx("p",{className:"text-muted-foreground",children:"Let's set up your profile to personalize your experience"})]}),s.jsxs("form",{onSubmit:_,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ht,{htmlFor:"username",children:["Username ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Ar,{id:"username",placeholder:"e.g., musiclover123",value:n.username,onChange:w=>{const b=w.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"");a(H(M({},n),{username:b})),i.username&&o(H(M({},i),{username:""}))},onBlur:y,maxLength:20,className:`bg-white ${i.username?"border-destructive":""}`}),d&&s.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:s.jsx(lr,{className:"w-4 h-4 animate-spin text-muted-foreground"})})]}),i.username&&s.jsx("p",{className:"text-sm text-destructive",children:i.username}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your unique username (3-20 characters, letters, numbers, and underscores only)"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{children:"Profile Photo (Optional)"}),s.jsxs("div",{className:"flex items-center gap-4",children:[n.avatar_url?s.jsx("img",{src:n.avatar_url,alt:"Profile",className:"w-20 h-20 rounded-full object-cover"}):s.jsx("div",{className:"w-20 h-20 rounded-full bg-muted flex items-center justify-center",children:s.jsx(z_,{className:"w-8 h-8 text-muted-foreground"})}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("input",{ref:f,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:g,className:"hidden"}),s.jsx(le,{type:"button",variant:"outline",onClick:()=>{var w;return(w=f.current)==null?void 0:w.click()},disabled:l,className:"w-full",children:l?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Nv,{className:"w-4 h-4 mr-2"}),"Upload Photo"]})}),s.jsx(Ar,{type:"url",placeholder:"Or paste image URL",value:n.avatar_url,onChange:w=>a(H(M({},n),{avatar_url:w.target.value})),disabled:l,className:"bg-white"})]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"You can add a photo now or skip and add it later"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ht,{htmlFor:"location_city",children:["City ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsx(Ar,{id:"location_city",placeholder:"e.g., Los Angeles, CA",value:n.location_city,onChange:w=>a(H(M({},n),{location_city:w.target.value})),className:`bg-white ${i.location_city?"border-destructive":""}`}),i.location_city&&s.jsx("p",{className:"text-sm text-destructive",children:i.location_city}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"We'll show you events happening near you"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ht,{htmlFor:"birthday",children:["Birthday ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsx(Ar,{id:"birthday",type:"date",value:n.birthday,onChange:w=>a(H(M({},n),{birthday:w.target.value})),className:`bg-white ${i.birthday?"border-destructive":""}`}),i.birthday&&s.jsx("p",{className:"text-sm text-destructive",children:i.birthday}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your age will be displayed to other users, but not your exact birthday"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"gender",children:"Gender (Optional)"}),s.jsxs(aa,{value:n.gender,onValueChange:w=>a(H(M({},n),{gender:w})),children:[s.jsx(Hs,{className:"bg-white",children:s.jsx(ia,{placeholder:"Select your gender"})}),s.jsxs(Gs,{className:"bg-white",children:[s.jsx(qt,{value:"male",children:"Male"}),s.jsx(qt,{value:"female",children:"Female"}),s.jsx(qt,{value:"non-binary",children:"Non-binary"}),s.jsx(qt,{value:"prefer-not-to-say",children:"Prefer not to say"}),s.jsx(qt,{value:"other",children:"Other"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ht,{htmlFor:"bio",children:"Bio (Optional)"}),s.jsx(ys,{id:"bio",placeholder:"Tell us a bit about yourself...",value:n.bio,onChange:w=>a(H(M({},n),{bio:w.target.value})),maxLength:120,className:`bg-white ${i.bio?"border-destructive":""}`}),s.jsxs("p",{className:"text-xs text-muted-foreground text-right",children:[n.bio.length,"/120 characters"]}),i.bio&&s.jsx("p",{className:"text-sm text-destructive",children:i.bio})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(le,{type:"button",variant:"ghost",onClick:r,className:"flex-1",children:"Skip"}),s.jsx(le,{type:"submit",className:"flex-1",children:"Continue"})]})]})]})};var b4=1,Fxe=.9,zxe=.8,Bxe=.17,iS=.1,oS=.999,Uxe=.9999,qxe=.99,Vxe=/[\\\/_+.#"@\[\(\{&]/,Wxe=/[\\\/_+.#"@\[\(\{&]/g,Hxe=/[\s-]/,i7=/[\s-]/g;function $2(e,t,r,n,a,i,o){if(i===t.length)return a===e.length?b4:qxe;var l=`${a},${i}`;if(o[l]!==void 0)return o[l];for(var c=n.charAt(i),d=r.indexOf(c,a),u=0,f,h,p,g;d>=0;)f=$2(e,t,r,n,d+1,i+1,o),f>u&&(d===a?f*=b4:Vxe.test(e.charAt(d-1))?(f*=zxe,p=e.slice(a,d-1).match(Wxe),p&&a>0&&(f*=Math.pow(oS,p.length))):Hxe.test(e.charAt(d-1))?(f*=Fxe,g=e.slice(a,d-1).match(i7),g&&a>0&&(f*=Math.pow(oS,g.length))):(f*=Bxe,a>0&&(f*=Math.pow(oS,d-a))),e.charAt(d)!==t.charAt(i)&&(f*=Uxe)),(f<iS&&r.charAt(d-1)===n.charAt(i+1)||n.charAt(i+1)===n.charAt(i)&&r.charAt(d-1)!==n.charAt(i))&&(h=$2(e,t,r,n,d+1,i+2,o),h*iS>f&&(f=h*iS)),f>u&&(u=f),d=r.indexOf(c,d+1);return o[l]=u,u}function j4(e){return e.toLowerCase().replace(i7," ")}function Gxe(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,$2(e,t,j4(e),j4(t),0,0,{})}var vg='[cmdk-group=""]',lS='[cmdk-group-items=""]',Yxe='[cmdk-group-heading=""]',o7='[cmdk-item=""]',N4=`${o7}:not([aria-disabled="true"])`,L2="cmdk-item-select",hf="data-value",Kxe=(e,t,r)=>Gxe(e,t,r),l7=x.createContext(void 0),mx=()=>x.useContext(l7),c7=x.createContext(void 0),sA=()=>x.useContext(c7),d7=x.createContext(void 0),u7=x.forwardRef((e,t)=>{let r=ff(()=>{var X,ne;return{search:"",value:(ne=(X=e.value)!=null?X:e.defaultValue)!=null?ne:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=ff(()=>new Set),a=ff(()=>new Map),i=ff(()=>new Map),o=ff(()=>new Set),l=h7(e),Q=e,{label:c,children:d,value:u,onValueChange:f,filter:h,shouldFilter:p,loop:g,disablePointerSelection:v=!1,vimBindings:y=!0}=Q,_=me(Q,["label","children","value","onValueChange","filter","shouldFilter","loop","disablePointerSelection","vimBindings"]),w=Ps(),b=Ps(),N=Ps(),S=x.useRef(null),k=i0e();fh(()=>{if(u!==void 0){let X=u.trim();r.current.value=X,P.emit()}},[u]),fh(()=>{k(6,D)},[]);let P=x.useMemo(()=>({subscribe:X=>(o.current.add(X),()=>o.current.delete(X)),snapshot:()=>r.current,setState:(X,ne,re)=>{var ye,ee,de,xe;if(!Object.is(r.current[X],ne)){if(r.current[X]=ne,X==="search")z(),$(),k(1,O);else if(X==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let ie=document.getElementById(N);ie?ie.focus():(ye=document.getElementById(w))==null||ye.focus()}if(k(7,()=>{var ie;r.current.selectedItemId=(ie=B())==null?void 0:ie.id,P.emit()}),re||k(5,D),((ee=l.current)==null?void 0:ee.value)!==void 0){let ie=ne!=null?ne:"";(xe=(de=l.current).onValueChange)==null||xe.call(de,ie);return}}P.emit()}},emit:()=>{o.current.forEach(X=>X())}}),[]),A=x.useMemo(()=>({value:(X,ne,re)=>{var ye;ne!==((ye=i.current.get(X))==null?void 0:ye.value)&&(i.current.set(X,{value:ne,keywords:re}),r.current.filtered.items.set(X,R(ne,re)),k(2,()=>{$(),P.emit()}))},item:(X,ne)=>(n.current.add(X),ne&&(a.current.has(ne)?a.current.get(ne).add(X):a.current.set(ne,new Set([X]))),k(3,()=>{z(),$(),r.current.value||O(),P.emit()}),()=>{i.current.delete(X),n.current.delete(X),r.current.filtered.items.delete(X);let re=B();k(4,()=>{z(),(re==null?void 0:re.getAttribute("id"))===X&&O(),P.emit()})}),group:X=>(a.current.has(X)||a.current.set(X,new Set),()=>{i.current.delete(X),a.current.delete(X)}),filter:()=>l.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:w,inputId:N,labelId:b,listInnerRef:S}),[]);function R(X,ne){var re,ye;let ee=(ye=(re=l.current)==null?void 0:re.filter)!=null?ye:Kxe;return X?ee(X,r.current.search,ne):0}function $(){if(!r.current.search||l.current.shouldFilter===!1)return;let X=r.current.filtered.items,ne=[];r.current.filtered.groups.forEach(ye=>{let ee=a.current.get(ye),de=0;ee.forEach(xe=>{let ie=X.get(xe);de=Math.max(ie,de)}),ne.push([ye,de])});let re=S.current;F().sort((ye,ee)=>{var de,xe;let ie=ye.getAttribute("id"),se=ee.getAttribute("id");return((de=X.get(se))!=null?de:0)-((xe=X.get(ie))!=null?xe:0)}).forEach(ye=>{let ee=ye.closest(lS);ee?ee.appendChild(ye.parentElement===ee?ye:ye.closest(`${lS} > *`)):re.appendChild(ye.parentElement===re?ye:ye.closest(`${lS} > *`))}),ne.sort((ye,ee)=>ee[1]-ye[1]).forEach(ye=>{var ee;let de=(ee=S.current)==null?void 0:ee.querySelector(`${vg}[${hf}="${encodeURIComponent(ye[0])}"]`);de==null||de.parentElement.appendChild(de)})}function O(){let X=F().find(re=>re.getAttribute("aria-disabled")!=="true"),ne=X==null?void 0:X.getAttribute(hf);P.setState("value",ne||void 0)}function z(){var X,ne,re,ye;if(!r.current.search||l.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let ee=0;for(let de of n.current){let xe=(ne=(X=i.current.get(de))==null?void 0:X.value)!=null?ne:"",ie=(ye=(re=i.current.get(de))==null?void 0:re.keywords)!=null?ye:[],se=R(xe,ie);r.current.filtered.items.set(de,se),se>0&&ee++}for(let[de,xe]of a.current)for(let ie of xe)if(r.current.filtered.items.get(ie)>0){r.current.filtered.groups.add(de);break}r.current.filtered.count=ee}function D(){var X,ne,re;let ye=B();ye&&(((X=ye.parentElement)==null?void 0:X.firstChild)===ye&&((re=(ne=ye.closest(vg))==null?void 0:ne.querySelector(Yxe))==null||re.scrollIntoView({block:"nearest"})),ye.scrollIntoView({block:"nearest"}))}function B(){var X;return(X=S.current)==null?void 0:X.querySelector(`${o7}[aria-selected="true"]`)}function F(){var X;return Array.from(((X=S.current)==null?void 0:X.querySelectorAll(N4))||[])}function U(X){let ne=F()[X];ne&&P.setState("value",ne.getAttribute(hf))}function G(X){var ne;let re=B(),ye=F(),ee=ye.findIndex(xe=>xe===re),de=ye[ee+X];(ne=l.current)!=null&&ne.loop&&(de=ee+X<0?ye[ye.length-1]:ee+X===ye.length?ye[0]:ye[ee+X]),de&&P.setState("value",de.getAttribute(hf))}function q(X){let ne=B(),re=ne==null?void 0:ne.closest(vg),ye;for(;re&&!ye;)re=X>0?s0e(re,vg):a0e(re,vg),ye=re==null?void 0:re.querySelector(N4);ye?P.setState("value",ye.getAttribute(hf)):G(X)}let K=()=>U(F().length-1),Z=X=>{X.preventDefault(),X.metaKey?K():X.altKey?q(1):G(1)},Y=X=>{X.preventDefault(),X.metaKey?U(0):X.altKey?q(-1):G(-1)};return x.createElement(Ct.div,H(M({ref:t,tabIndex:-1},_),{"cmdk-root":"",onKeyDown:X=>{var ne;(ne=_.onKeyDown)==null||ne.call(_,X);let re=X.nativeEvent.isComposing||X.keyCode===229;if(!(X.defaultPrevented||re))switch(X.key){case"n":case"j":{y&&X.ctrlKey&&Z(X);break}case"ArrowDown":{Z(X);break}case"p":case"k":{y&&X.ctrlKey&&Y(X);break}case"ArrowUp":{Y(X);break}case"Home":{X.preventDefault(),U(0);break}case"End":{X.preventDefault(),K();break}case"Enter":{X.preventDefault();let ye=B();if(ye){let ee=new Event(L2);ye.dispatchEvent(ee)}}}}}),x.createElement("label",{"cmdk-label":"",htmlFor:A.inputId,id:A.labelId,style:l0e},c),U1(e,X=>x.createElement(c7.Provider,{value:P},x.createElement(l7.Provider,{value:A},X))))}),Zxe=x.forwardRef((e,t)=>{var r,n;let a=Ps(),i=x.useRef(null),o=x.useContext(d7),l=mx(),c=h7(e),d=(n=(r=c.current)==null?void 0:r.forceMount)!=null?n:o==null?void 0:o.forceMount;fh(()=>{if(!d)return l.item(a,o==null?void 0:o.id)},[d]);let u=f7(a,i,[e.value,e.children,i],e.keywords),f=sA(),h=Wd(P=>P.value&&P.value===u.current),p=Wd(P=>d||l.filter()===!1?!0:P.search?P.filtered.items.get(a)>0:!0);x.useEffect(()=>{let P=i.current;if(!(!P||e.disabled))return P.addEventListener(L2,g),()=>P.removeEventListener(L2,g)},[p,e.onSelect,e.disabled]);function g(){var P,A;v(),(A=(P=c.current).onSelect)==null||A.call(P,u.current)}function v(){f.setState("value",u.current,!0)}if(!p)return null;let k=e,{disabled:y,value:_,onSelect:w,forceMount:b,keywords:N}=k,S=me(k,["disabled","value","onSelect","forceMount","keywords"]);return x.createElement(Ct.div,H(M({ref:Tc(i,t)},S),{id:a,"cmdk-item":"",role:"option","aria-disabled":!!y,"aria-selected":!!h,"data-disabled":!!y,"data-selected":!!h,onPointerMove:y||l.getDisablePointerSelection()?void 0:v,onClick:y?void 0:g}),e.children)}),Xxe=x.forwardRef((e,t)=>{let p=e,{heading:r,children:n,forceMount:a}=p,i=me(p,["heading","children","forceMount"]),o=Ps(),l=x.useRef(null),c=x.useRef(null),d=Ps(),u=mx(),f=Wd(g=>a||u.filter()===!1?!0:g.search?g.filtered.groups.has(o):!0);fh(()=>u.group(o),[]),f7(o,l,[e.value,e.heading,c]);let h=x.useMemo(()=>({id:o,forceMount:a}),[a]);return x.createElement(Ct.div,H(M({ref:Tc(l,t)},i),{"cmdk-group":"",role:"presentation",hidden:f?void 0:!0}),r&&x.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:d},r),U1(e,g=>x.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?d:void 0},x.createElement(d7.Provider,{value:h},g))))}),Jxe=x.forwardRef((e,t)=>{let o=e,{alwaysRender:r}=o,n=me(o,["alwaysRender"]),a=x.useRef(null),i=Wd(l=>!l.search);return!r&&!i?null:x.createElement(Ct.div,H(M({ref:Tc(a,t)},n),{"cmdk-separator":"",role:"separator"}))}),Qxe=x.forwardRef((e,t)=>{let d=e,{onValueChange:r}=d,n=me(d,["onValueChange"]),a=e.value!=null,i=sA(),o=Wd(u=>u.search),l=Wd(u=>u.selectedItemId),c=mx();return x.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),x.createElement(Ct.input,H(M({ref:t},n),{"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:a?e.value:o,onChange:u=>{a||i.setState("search",u.target.value),r==null||r(u.target.value)}}))}),e0e=x.forwardRef((e,t)=>{let d=e,{children:r,label:n="Suggestions"}=d,a=me(d,["children","label"]),i=x.useRef(null),o=x.useRef(null),l=Wd(u=>u.selectedItemId),c=mx();return x.useEffect(()=>{if(o.current&&i.current){let u=o.current,f=i.current,h,p=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let g=u.offsetHeight;f.style.setProperty("--cmdk-list-height",g.toFixed(1)+"px")})});return p.observe(u),()=>{cancelAnimationFrame(h),p.unobserve(u)}}},[]),x.createElement(Ct.div,H(M({ref:Tc(i,t)},a),{"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":n,id:c.listId}),U1(e,u=>x.createElement("div",{ref:Tc(o,c.listInnerRef),"cmdk-list-sizer":""},u)))}),t0e=x.forwardRef((e,t)=>{let c=e,{open:r,onOpenChange:n,overlayClassName:a,contentClassName:i,container:o}=c,l=me(c,["open","onOpenChange","overlayClassName","contentClassName","container"]);return x.createElement(a1,{open:r,onOpenChange:n},x.createElement(i1,{container:o},x.createElement(gp,{"cmdk-overlay":"",className:a}),x.createElement(vp,{"aria-label":e.label,"cmdk-dialog":"",className:i},x.createElement(u7,M({ref:t},l)))))}),r0e=x.forwardRef((e,t)=>Wd(r=>r.filtered.count===0)?x.createElement(Ct.div,H(M({ref:t},e),{"cmdk-empty":"",role:"presentation"})):null),n0e=x.forwardRef((e,t)=>{let o=e,{progress:r,children:n,label:a="Loading..."}=o,i=me(o,["progress","children","label"]);return x.createElement(Ct.div,H(M({ref:t},i),{"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a}),U1(e,l=>x.createElement("div",{"aria-hidden":!0},l)))}),xi=Object.assign(u7,{List:e0e,Item:Zxe,Input:Qxe,Group:Xxe,Separator:Jxe,Dialog:t0e,Empty:r0e,Loading:n0e});function s0e(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function a0e(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function h7(e){let t=x.useRef(e);return fh(()=>{t.current=e}),t}var fh=typeof window=="undefined"?x.useEffect:x.useLayoutEffect;function ff(e){let t=x.useRef();return t.current===void 0&&(t.current=e()),t}function Wd(e){let t=sA(),r=()=>e(t.snapshot());return x.useSyncExternalStore(t.subscribe,r,r)}function f7(e,t,r,n=[]){let a=x.useRef(),i=mx();return fh(()=>{var o;let l=(()=>{var d;for(let u of r){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(d=u.current.textContent)==null?void 0:d.trim():a.current}})(),c=n.map(d=>d.trim());i.value(e,l,c),(o=t.current)==null||o.setAttribute(hf,l),a.current=l}),a}var i0e=()=>{let[e,t]=x.useState(),r=ff(()=>new Map);return fh(()=>{r.current.forEach(n=>n()),r.current=new Map},[e]),(n,a)=>{r.current.set(n,a),t({})}};function o0e(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function U1({asChild:e,children:t},r){return e&&x.isValidElement(t)?x.cloneElement(o0e(t),{ref:t.ref},r(t.props.children)):r(t)}var l0e={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const m7=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(xi,M({ref:r,className:ke("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e)},t))});m7.displayName=xi.displayName;const p7=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[s.jsx(Uo,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),s.jsx(xi.Input,M({ref:r,className:ke("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e)},t))]})});p7.displayName=xi.Input.displayName;const c0e=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(xi.List,M({ref:r,className:ke("max-h-[300px] overflow-y-auto overflow-x-hidden",e)},t))});c0e.displayName=xi.List.displayName;const g7=x.forwardRef((e,t)=>s.jsx(xi.Empty,M({ref:t,className:"py-6 text-center text-sm"},e)));g7.displayName=xi.Empty.displayName;const v7=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(xi.Group,M({ref:r,className:ke("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e)},t))});v7.displayName=xi.Group.displayName;const d0e=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(xi.Separator,M({ref:r,className:ke("-mx-1 h-px bg-border",e)},t))});d0e.displayName=xi.Separator.displayName;const y7=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(xi.Item,M({ref:r,className:ke("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e)},t))});y7.displayName=xi.Item.displayName;const u0e=({onNext:e,onBack:t,onSkip:r})=>{const[n,a]=x.useState([]),[i,o]=x.useState([]),[l,c]=x.useState(""),[d,u]=x.useState(""),[f,h]=x.useState(!1),[p,g]=x.useState({}),[v,y]=x.useState([]),[_,w]=x.useState(!1),[b,N]=x.useState(!1),S=x.useRef(null),k=D=>{if(n.length>=7){g(H(M({},p),{genres:"Maximum 7 genres allowed"}));return}n.includes(D)||(a([...n,D]),g(H(M({},p),{genres:""}))),h(!1)},P=()=>{const D=l.trim();if(D){if(n.length>=7){g(H(M({},p),{genres:"Maximum 7 genres allowed"}));return}n.includes(D)||(a([...n,D]),c(""),g(H(M({},p),{genres:""})))}},A=D=>{a(n.filter(B=>B!==D)),g(H(M({},p),{genres:""}))};x.useEffect(()=>{if(d.trim().length<2){y([]),N(!1);return}return S.current&&clearTimeout(S.current),S.current=setTimeout(()=>E(void 0,null,function*(){w(!0);try{const D=yield Yy.searchArtistsTrigram(d.trim(),5);y(D),N(D.length>0)}catch(D){console.error("Error searching artists:",D),y([])}finally{w(!1)}}),300),()=>{S.current&&clearTimeout(S.current)}},[d]);const R=D=>{if(i.length>=15){g(H(M({},p),{artists:"Maximum 15 artists allowed"}));return}i.includes(D.name)||(o([...i,D.name]),u(""),y([]),N(!1),g(H(M({},p),{artists:""})))},$=()=>{const D=d.trim();if(D){if(i.length>=15){g(H(M({},p),{artists:"Maximum 15 artists allowed"}));return}i.includes(D)||(o([...i,D]),u(""),y([]),N(!1),g(H(M({},p),{artists:""})))}},O=D=>{o(i.filter(B=>B!==D)),g(H(M({},p),{artists:""}))},z=()=>{const D={};if(n.length<3&&(D.genres="Please select at least 3 genres"),i.length<3&&(D.artists="Please add at least 3 artists"),Object.keys(D).length>0){g(D);return}e({genres:n,artists:i})};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Tell us about your music taste"}),s.jsx("p",{className:"text-muted-foreground",children:"This helps us recommend events and connect you with like-minded people"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Ht,{className:"flex items-center gap-2",children:[s.jsx($t,{className:"w-4 h-4"}),"Favorite Genres",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[n.length,"/7 (min 3)"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(fc,{open:f,onOpenChange:h,children:[s.jsx(mc,{asChild:!0,children:s.jsx(le,{variant:"outline",className:"w-full justify-start bg-white",children:"Select genres..."})}),s.jsx(wl,{className:"w-full p-0 bg-white",align:"start",children:s.jsxs(m7,{className:"bg-white",children:[s.jsx(p7,{placeholder:"Search genres...",className:"bg-white"}),s.jsx(g7,{children:"No genre found."}),s.jsx(v7,{className:"max-h-64 overflow-auto bg-white",children:vV.filter(D=>!n.includes(D)).map(D=>s.jsx(y7,{onSelect:()=>k(D),className:"hover:bg-gray-100",children:D},D))})]})})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Ar,{placeholder:"Or type a custom genre...",value:l,onChange:D=>c(D.target.value),onKeyDown:D=>{D.key==="Enter"&&(D.preventDefault(),P())},className:"bg-white"}),s.jsx(le,{type:"button",onClick:P,variant:"secondary",children:"Add"})]})]}),n.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:n.map((D,B)=>s.jsxs(Ke,{variant:B<3?"default":"secondary",className:"px-3 py-1",children:[D,s.jsx("button",{type:"button",onClick:()=>A(D),className:"ml-2 hover:text-destructive",children:s.jsx(Gr,{className:"w-3 h-3"})})]},D))}),n.length>0&&s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your top 3 genres get higher weight in recommendations"}),p.genres&&s.jsx("p",{className:"text-sm text-destructive",children:p.genres})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Ht,{className:"flex items-center gap-2",children:[s.jsx(Rs,{className:"w-4 h-4"}),"Favorite Artists",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[i.length,"/15 (min 3)"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(Ar,{placeholder:"Type an artist name...",value:d,onChange:D=>u(D.target.value),onKeyDown:D=>{D.key==="Enter"&&(D.preventDefault(),v.length>0&&b?R(v[0]):$())},onFocus:()=>{v.length>0&&d.trim().length>=2&&N(!0)},onBlur:()=>{setTimeout(()=>N(!1),200)},className:"bg-white"}),_&&s.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:s.jsx(lr,{className:"w-4 h-4 animate-spin text-muted-foreground"})})]}),s.jsx(le,{type:"button",onClick:$,variant:"secondary",children:"Add"})]}),b&&v.length>0&&s.jsx("div",{className:"border rounded-md bg-white shadow-md max-h-48 overflow-auto z-10",onMouseDown:D=>D.preventDefault(),children:v.map(D=>s.jsxs("button",{type:"button",onClick:()=>R(D),className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",children:[s.jsx("span",{className:"flex-1",children:D.name}),D.genres&&D.genres.length>0&&s.jsx("span",{className:"text-xs text-muted-foreground",children:D.genres[0]})]},D.id))})]}),i.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:i.map((D,B)=>s.jsxs(Ke,{variant:B<3?"default":"secondary",className:"px-3 py-1",children:[D,s.jsx("button",{type:"button",onClick:()=>O(D),className:"ml-2 hover:text-destructive",children:s.jsx(Gr,{className:"w-3 h-3"})})]},D))}),i.length>0&&s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your top 3 artists get higher weight in recommendations"}),p.artists&&s.jsx("p",{className:"text-sm text-destructive",children:p.artists})]}),s.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg p-4 text-sm",children:s.jsxs("p",{className:"text-blue-700 dark:text-blue-300",children:[" ",s.jsx("strong",{children:"Tip:"})," You can also connect your Spotify account later to automatically sync your music preferences!"]})}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(le,{type:"button",variant:"ghost",onClick:t,className:"flex-1",children:"Back"}),s.jsx(le,{type:"button",variant:"outline",onClick:r,className:"flex-1",children:"Skip"}),s.jsx(le,{onClick:z,className:"flex-1",children:"Complete Setup"})]})]})};var x7="AlertDialog",[h0e,$Be]=Os(x7,[R9]),zc=R9(),_7=e=>{const a=e,{__scopeAlertDialog:t}=a,r=me(a,["__scopeAlertDialog"]),n=zc(t);return s.jsx(a1,H(M(M({},n),r),{modal:!0}))};_7.displayName=x7;var f0e="AlertDialogTrigger",m0e=x.forwardRef((e,t)=>{const i=e,{__scopeAlertDialog:r}=i,n=me(i,["__scopeAlertDialog"]),a=zc(r);return s.jsx(Zoe,H(M(M({},a),n),{ref:t}))});m0e.displayName=f0e;var p0e="AlertDialogPortal",w7=e=>{const a=e,{__scopeAlertDialog:t}=a,r=me(a,["__scopeAlertDialog"]),n=zc(t);return s.jsx(i1,M(M({},n),r))};w7.displayName=p0e;var g0e="AlertDialogOverlay",b7=x.forwardRef((e,t)=>{const i=e,{__scopeAlertDialog:r}=i,n=me(i,["__scopeAlertDialog"]),a=zc(r);return s.jsx(gp,H(M(M({},a),n),{ref:t}))});b7.displayName=g0e;var Zf="AlertDialogContent",[v0e,y0e]=h0e(Zf),x0e=X6("AlertDialogContent"),j7=x.forwardRef((e,t)=>{const d=e,{__scopeAlertDialog:r,children:n}=d,a=me(d,["__scopeAlertDialog","children"]),i=zc(r),o=x.useRef(null),l=cr(t,o),c=x.useRef(null);return s.jsx(Hoe,{contentName:Zf,titleName:N7,docsSlug:"alert-dialog",children:s.jsx(v0e,{scope:r,cancelRef:c,children:s.jsxs(vp,H(M(M({role:"alertdialog"},i),a),{ref:l,onOpenAutoFocus:pt(a.onOpenAutoFocus,u=>{var f;u.preventDefault(),(f=c.current)==null||f.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[s.jsx(x0e,{children:n}),s.jsx(w0e,{contentRef:o})]}))})})});j7.displayName=Zf;var N7="AlertDialogTitle",S7=x.forwardRef((e,t)=>{const i=e,{__scopeAlertDialog:r}=i,n=me(i,["__scopeAlertDialog"]),a=zc(r);return s.jsx(Wy,H(M(M({},a),n),{ref:t}))});S7.displayName=N7;var k7="AlertDialogDescription",E7=x.forwardRef((e,t)=>{const i=e,{__scopeAlertDialog:r}=i,n=me(i,["__scopeAlertDialog"]),a=zc(r);return s.jsx(Hy,H(M(M({},a),n),{ref:t}))});E7.displayName=k7;var _0e="AlertDialogAction",C7=x.forwardRef((e,t)=>{const i=e,{__scopeAlertDialog:r}=i,n=me(i,["__scopeAlertDialog"]),a=zc(r);return s.jsx(o1,H(M(M({},a),n),{ref:t}))});C7.displayName=_0e;var P7="AlertDialogCancel",T7=x.forwardRef((e,t)=>{const l=e,{__scopeAlertDialog:r}=l,n=me(l,["__scopeAlertDialog"]),{cancelRef:a}=y0e(P7,r),i=zc(r),o=cr(t,a);return s.jsx(o1,H(M(M({},i),n),{ref:o}))});T7.displayName=P7;var w0e=({contentRef:e})=>{const t=`\`${Zf}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Zf}\` by passing a \`${k7}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Zf}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return x.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},b0e=_7,j0e=w7,A7=b7,R7=j7,O7=C7,M7=T7,D7=S7,I7=E7;const N0e=b0e,S0e=j0e,$7=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(A7,H(M({className:ke("fixed inset-0 z-[9999] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),style:M({backgroundColor:"var(--overlay-50, rgba(14, 14, 14, 0.5))"},t.style)},t),{ref:r}))});$7.displayName=A7.displayName;const L7=x.forwardRef((a,n)=>{var i=a,{className:e,style:t}=i,r=me(i,["className","style"]);return s.jsxs(S0e,{children:[s.jsx($7,{}),s.jsx(R7,M({ref:n,className:ke("fixed z-[9999] grid gap-4 border bg-background shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg",e),style:M({left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"calc(100vw - 40px)",maxWidth:"var(--size-popup-width, calc(100vw - 40px))",maxHeight:"calc(100vh - 40px)",backgroundColor:"var(--neutral-50)",border:"1px solid var(--neutral-200)",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 4px 12px 0 var(--shadow-color)",padding:"var(--spacing-grouped, 24px)"},t)},r))]})});L7.displayName=R7.displayName;const F7=r=>{var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("flex flex-col space-y-2 text-center sm:text-left",e)},t))};F7.displayName="AlertDialogHeader";const z7=r=>{var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e)},t))};z7.displayName="AlertDialogFooter";const B7=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(D7,M({ref:r,className:ke("text-lg font-semibold",e)},t))});B7.displayName=D7.displayName;const U7=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(I7,M({ref:r,className:ke("text-sm text-muted-foreground",e)},t))});U7.displayName=I7.displayName;const q7=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(O7,M({ref:r,className:ke(GP(),e)},t))});q7.displayName=O7.displayName;const V7=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(M7,M({ref:r,className:ke(GP({variant:"outline"}),"mt-2 sm:mt-0",e)},t))});V7.displayName=M7.displayName;const k0e=({open:e,onOpenChange:t,onConfirmSkip:r})=>s.jsx(N0e,{open:e,onOpenChange:t,children:s.jsxs(L7,{children:[s.jsxs(F7,{children:[s.jsx(B7,{children:"Skip profile setup?"}),s.jsxs(U7,{className:"space-y-3",children:[s.jsx("p",{children:"Completing your profile helps us personalize your experience:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[s.jsx("li",{children:"Discover events that match your music taste"}),s.jsx("li",{children:"Connect with people who share your interests"}),s.jsx("li",{children:"Get better recommendations based on your preferences"})]}),s.jsx("p",{className:"text-sm font-medium",children:"You can always complete this later from your profile settings."})]})]}),s.jsxs(z7,{children:[s.jsx(V7,{children:"Continue Setup"}),s.jsx(q7,{onClick:r,children:"Skip for Now"})]})]})}),E0e=({onComplete:e})=>{const[t,r]=x.useState(1),[n,a]=x.useState(!1),[i,o]=x.useState(!1),{user:l}=xs(),{toast:c}=Rr(),[d,u]=x.useState({}),f=2,h=t/f*100,p=_=>E(void 0,null,function*(){if(l){o(!0);try{(yield Ou.saveProfileSetup(l.id,_))?(u(_),r(2)):c({title:"Error",description:"Failed to save profile data. Please try again.",variant:"destructive"})}catch(w){const b=(w==null?void 0:w.message)||"An error occurred. Please try again.";c({title:"Error",description:b,variant:"destructive"})}finally{o(!1)}}}),g=_=>E(void 0,null,function*(){if(l){o(!0);try{const w=[];for(const N of _.artists)try{const S=yield Yy.searchArtistsTrigram(N,1);if(S.length>0&&S[0].name.toLowerCase()===N.toLowerCase())w.push({name:S[0].name,id:S[0].id});else{w.push({name:N});try{const{MissingEntityRequestService:k}=yield kn(()=>E(void 0,null,function*(){const{MissingEntityRequestService:P}=yield import("./missingEntityRequestService-U8rBFeto.js");return{MissingEntityRequestService:P}}),[],import.meta.url);yield k.submitRequest({entity_type:"artist",entity_name:N})}catch(k){console.warn("Error submitting missing artist request:",k)}}}catch(S){console.warn(`Error searching for artist "${N}":`,S),w.push({name:N})}if(!(yield Ou.saveMusicPreferences(l.id,_.genres,w))){c({title:"Error",description:"Failed to save music preferences.",variant:"destructive"}),o(!1);return}yield Ou.completeOnboarding(l.id),c({title:"Welcome to Synth!",description:"Your profile is all set up. Let's explore the app!"}),e()}catch(w){console.error("Error in handleMusicTags:",w),c({title:"Error",description:"An error occurred. Please try again.",variant:"destructive"})}finally{o(!1)}}}),v=()=>{a(!0)},y=()=>E(void 0,null,function*(){if(l){o(!0);try{yield Ou.skipOnboarding(l.id),c({title:"Onboarding Skipped",description:"You can complete your profile anytime from settings."}),e()}catch(_){c({title:"Error",description:"An error occurred. Please try again.",variant:"destructive"})}finally{o(!1),a(!1)}}});return s.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-primary/10 to-accent/10",children:[s.jsx(He,{className:"w-full max-w-2xl",children:s.jsxs(et,{className:"p-6 md:p-8",children:[s.jsxs("div",{className:"mb-8 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Step ",t," of ",f]}),s.jsxs("span",{children:[Math.round(h),"% complete"]})]}),s.jsx(xm,{value:h})]}),i?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto"}),s.jsx("p",{className:"text-muted-foreground",children:"Saving your information..."})]})}):s.jsxs(s.Fragment,{children:[t===1&&s.jsx(Lxe,{initialData:d,onNext:p,onSkip:v}),t===2&&s.jsx(u0e,{onNext:g,onBack:()=>r(1),onSkip:v})]})]})}),s.jsx(k0e,{open:n,onOpenChange:a,onConfirmSkip:y})]})};function C0e(){const{user:e}=xs(),t=x.useRef(0),r=x.useRef(null),n=2*60*1e3,a=()=>E(this,null,function*(){if(!(e!=null&&e.id))return;const i=Date.now();if(!(i-t.current<n))try{yield Yf.updateLastActive(e.id),t.current=i,console.log(" Activity tracked: last_active_at updated")}catch(l){console.error("Failed to track activity:",l)}});return x.useEffect(()=>{if(e!=null&&e.id)return a(),r.current=setInterval(()=>{a()},5*60*1e3),()=>{r.current&&clearInterval(r.current)}},[e==null?void 0:e.id]),x.useEffect(()=>{const i=()=>{document.visibilityState==="visible"&&a()};return document.addEventListener("visibilitychange",i),()=>{document.removeEventListener("visibilitychange",i)}},[e==null?void 0:e.id]),{trackActivity:a}}class ps{static getAllProfiles(){return E(this,null,function*(){try{const{data:t,error:r}=yield T.rpc("get_all_profiles_for_analytics");if(r)throw console.error("Error getting all profiles for analytics:",r),r;return t||[]}catch(t){throw console.error("Error in getAllProfiles:",t),t}})}static getProfilesByAccountType(t){return E(this,null,function*(){try{return(yield this.getAllProfiles()).filter(n=>n.account_type===t)}catch(r){throw console.error("Error getting profiles by account type:",r),r}})}static getAllUserInteractions(t,r,n){return E(this,null,function*(){try{let a=T.from("interactions").select("*");t&&t.length>0&&(a=a.in("entity_id",t)),r&&r.length>0&&(a=a.in("event_type",r)),n&&n.length>0&&(a=a.in("entity_type",n));const{data:i,error:o}=yield a;if(o)throw console.error("Error getting user interactions for analytics:",o),o;return i||[]}catch(a){throw console.error("Error in getAllUserInteractions:",a),a}})}static getAllUserReviews(t){return E(this,null,function*(){try{let r=T.from("reviews").select("*").eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY");t&&t.length>0&&(r=r.in("event_id",t));const{data:n,error:a}=yield r;if(a)throw console.error("Error getting user reviews for analytics:",a),a;return n||[]}catch(r){throw console.error("Error in getAllUserReviews:",r),r}})}static getAllInterestedUsers(t){return E(this,null,function*(){try{let r=T.from("user_event_relationships").select("*").in("relationship_type",["interested","going","maybe"]);t&&t.length>0&&(r=r.in("event_id",t));const{data:n,error:a}=yield r;if(a)throw console.error("Error getting interested users for analytics:",a),a;return n||[]}catch(r){throw console.error("Error in getAllInterestedUsers:",r),r}})}static getAllFriendships(){return E(this,null,function*(){try{const{data:t,error:r}=yield T.from("user_relationships").select("*").eq("relationship_type","friend").eq("status","accepted");if(r)throw console.error("Error getting friendships for analytics:",r),r;return t||[]}catch(t){throw console.error("Error in getAllFriendships:",t),t}})}static getProfileById(t){return E(this,null,function*(){try{return(yield this.getAllProfiles()).find(n=>n.user_id===t)||null}catch(r){throw console.error("Error getting profile by ID:",r),r}})}static getProfilesByBusinessInfo(t){return E(this,null,function*(){try{return(yield this.getAllProfiles()).filter(n=>{if(!n.business_info)return!1;for(const[a,i]of Object.entries(t))if(n.business_info[a]!==i)return!1;return!0})}catch(r){throw console.error("Error getting profiles by business info:",r),r}})}}class tf{static getCreatorStats(t){return E(this,null,function*(){try{const{count:r}=yield T.from("artist_follows").select("*",{count:"exact",head:!0}).eq("artist_id",t);console.log(" CreatorAnalyticsService: Searching for events with creatorId:",t);const{data:n,error:a}=yield T.from("events").select("id, title, artist_name, venue_name, event_date, created_by_user_id").eq("created_by_user_id",t);if(a&&console.error(" CreatorAnalyticsService: Error fetching events:",a),console.log(" CreatorAnalyticsService: Found events for creator",t,":",(n==null?void 0:n.length)||0),n&&n.length>0)console.log(" CreatorAnalyticsService: Event details:",n.map(w=>({id:w.id,title:w.title,created_by:w.created_by_user_id})));else{console.log(" CreatorAnalyticsService: No events found. Let me check all events in database...");const{data:w,error:b}=yield T.from("events").select("id, title, artist_name, created_by_user_id").limit(10);b?console.error(" CreatorAnalyticsService: Error fetching all events:",b):console.log(" CreatorAnalyticsService: Sample events in database:",w==null?void 0:w.map(N=>({id:N.id,title:N.title,created_by:N.created_by_user_id})))}if(!n||n.length===0)return console.log(" CreatorAnalyticsService: No events found for creator",t),{total_followers:r||0,engagement_rate:0,total_event_views:0,total_reviews:0,profile_visits:0,ticket_clicks:0,fan_growth_rate:0,top_venue_performance:0};const i=n.map(w=>w.id),o=yield ps.getAllUserInteractions(i,void 0,["event"]);console.log(" CreatorAnalyticsService: Found interactions for events:",(o==null?void 0:o.length)||0),o&&o.length>0&&console.log(" CreatorAnalyticsService: Interaction details:",o.map(w=>({event_type:w.event_type,entity_id:w.entity_id,user_id:w.user_id})));const{data:l}=yield T.from("reviews").select(`
          *,
          event:events!inner(id, artist_name)
        `).in("event_id",i);console.log(" CreatorAnalyticsService: Found reviews for events:",(l==null?void 0:l.length)||0);const c=r||0,d=(o==null?void 0:o.filter(w=>w.event_type==="view").length)||0,u=(l==null?void 0:l.length)||0,f=(o==null?void 0:o.filter(w=>w.event_type==="profile_visit").length)||0,h=(o==null?void 0:o.filter(w=>w.event_type==="click_ticket").length)||0,p=d+f+h,g=c>0?p/c*100:0,_={total_followers:c,engagement_rate:Math.round(g*100)/100,total_event_views:d,total_reviews:u,profile_visits:f,ticket_clicks:h,fan_growth_rate:0,top_venue_performance:0};return console.log(" CreatorAnalyticsService: Final stats for creator",t,":",_),_}catch(r){return console.error("Error getting creator stats:",r),{total_followers:0,engagement_rate:0,total_event_views:0,total_reviews:0,profile_visits:0,ticket_clicks:0,fan_growth_rate:0,top_venue_performance:0}}})}static getFanInsights(t){return E(this,null,function*(){try{const{data:r}=yield T.from("events").select("*").eq("created_by_user_id",t);if(!r||r.length===0)return[];const n=r.map(l=>l.id),a=yield ps.getAllUserInteractions(n,void 0,["event"]),i=new Map;return r.forEach(l=>{const c=l.venue_name;i.has(c)||i.set(c,{eventCount:0,totalViews:0,interactions:[]}),i.get(c).eventCount++}),a==null||a.forEach(l=>{const c=r.find(d=>d.id===l.entity_id);if(c){const d=c.venue_name,u=i.get(d);u&&(u.interactions.push(l),l.event_type==="view"&&u.totalViews++)}}),Array.from(i.entries()).map(([l,c])=>{const d=c.eventCount>0?c.totalViews/c.eventCount:0,u=c.interactions.length>0?c.interactions.length/c.eventCount:0;return{venue_name:l,event_count:c.eventCount,total_views:c.totalViews,engagement_score:Math.round(d*100)/100,fan_density:Math.round(u*100)/100}}).sort((l,c)=>c.engagement_score-l.engagement_score)}catch(r){return console.error("Error getting fan insights:",r),[]}})}static getGeographicInsights(t){return E(this,null,function*(){try{const{data:r}=yield T.from("events").select("*").eq("created_by_user_id",t);if(!r||r.length===0)return[];const n=r.map(l=>l.id),a=yield ps.getAllUserInteractions(n,void 0,["event"]),i=new Map;return r.forEach(l=>{const c=`${l.venue_city||"Unknown"}, ${l.venue_state||"Unknown"}`;i.has(c)||i.set(c,{eventCount:0,fanCount:0,interactions:[]}),i.get(c).eventCount++}),a==null||a.forEach(l=>{const c=r.find(d=>d.id===l.entity_id);if(c){const d=`${c.venue_city||"Unknown"}, ${c.venue_state||"Unknown"}`,u=i.get(d);u&&(u.interactions.push(l),u.interactions.some(f=>f.user_id===l.user_id)||u.fanCount++)}}),Array.from(i.entries()).map(([l,c])=>{const[d,u]=l.split(", "),f=c.fanCount>0?c.interactions.length/c.fanCount*100:0;return{city:d.trim(),state:u.trim(),fan_count:c.fanCount,event_count:c.eventCount,engagement_rate:Math.round(f*100)/100}}).sort((l,c)=>c.fan_count-l.fan_count)}catch(r){return console.error("Error getting geographic insights:",r),[]}})}static getContentPerformance(t,r=30){return E(this,null,function*(){try{const n=new Date;n.setDate(n.getDate()-r);const{data:a}=yield T.from("events").select("id").eq("created_by_user_id",t);if(!a||a.length===0)return[];const i=a.map(d=>d.id),{data:o}=yield T.from("interactions").select("*").eq("entity_type","event").in("entity_id",i).gte("occurred_at",n.toISOString()),l=new Map;return o==null||o.forEach(d=>{const u=new Date(d.created_at).toISOString().split("T")[0];l.has(u)||l.set(u,{eventViews:0,profileVisits:0,followerGains:0,interactions:[]});const f=l.get(u);f.interactions.push(d),d.event_type==="view"?f.eventViews++:d.event_type==="profile_visit"&&f.profileVisits++}),Array.from(l.entries()).map(([d,u])=>{const f=u.interactions.length>0?u.interactions.length/10*100:0;return{date:d,event_views:u.eventViews,profile_visits:u.profileVisits,follower_gains:u.followerGains,engagement_rate:Math.round(f*100)/100}}).sort((d,u)=>new Date(d.date).getTime()-new Date(u.date).getTime())}catch(n){return console.error("Error getting content performance:",n),[]}})}static getCreatorAchievements(t){return E(this,null,function*(){try{const r=yield this.getCreatorStats(t),n=yield this.getFanInsights(t);return[{id:"first_follower",name:"First Fan",description:"Get your first follower",icon:"",progress:Math.min(r.total_followers,1),goal:1,unlocked:r.total_followers>=1,category:"follower"},{id:"growing_audience",name:"Growing Audience",description:"Reach 100 followers",icon:"",progress:Math.min(r.total_followers,100),goal:100,unlocked:r.total_followers>=100,category:"follower"},{id:"popular_creator",name:"Popular Creator",description:"Reach 1,000 followers",icon:"",progress:Math.min(r.total_followers,1e3),goal:1e3,unlocked:r.total_followers>=1e3,category:"follower"},{id:"engaging_content",name:"Engaging Content",description:"Achieve 10% engagement rate",icon:"",progress:Math.min(r.engagement_rate,10),goal:10,unlocked:r.engagement_rate>=10,category:"engagement"},{id:"highly_engaging",name:"Highly Engaging",description:"Achieve 25% engagement rate",icon:"",progress:Math.min(r.engagement_rate,25),goal:25,unlocked:r.engagement_rate>=25,category:"engagement"},{id:"venue_favorite",name:"Venue Favorite",description:"Perform at 5 different venues",icon:"",progress:Math.min(n.length,5),goal:5,unlocked:n.length>=5,category:"venue"},{id:"touring_artist",name:"Touring Artist",description:"Perform at 10 different venues",icon:"",progress:Math.min(n.length,10),goal:10,unlocked:n.length>=10,category:"venue"},{id:"reviewed_performer",name:"Reviewed Performer",description:"Get 10 reviews from fans",icon:"",progress:Math.min(r.total_reviews,10),goal:10,unlocked:r.total_reviews>=10,category:"engagement"},{id:"fan_favorite",name:"Fan Favorite",description:"Get 50 reviews from fans",icon:"",progress:Math.min(r.total_reviews,50),goal:50,unlocked:r.total_reviews>=50,category:"engagement"},{id:"ticket_seller",name:"Ticket Seller",description:"Generate 100 ticket clicks",icon:"",progress:Math.min(r.ticket_clicks,100),goal:100,unlocked:r.ticket_clicks>=100,category:"revenue"}]}catch(r){return console.error("Error getting creator achievements:",r),[]}})}static exportCreatorData(t){return E(this,null,function*(){const[r,n,a,i,o]=yield Promise.all([this.getCreatorStats(t),this.getFanInsights(t),this.getGeographicInsights(t),this.getContentPerformance(t),this.getCreatorAchievements(t)]);return{stats:r,fanInsights:n,geographicInsights:a,contentPerformance:i,achievements:o}})}}function oi({title:e,value:t,change:r,changePercent:n,trend:a,icon:i,subtitle:o,className:l,valuePrefix:c="",valueSuffix:d=""}){const u=()=>!a||a==="neutral"?s.jsx(PF,{className:"w-4 h-4"}):a==="up"?s.jsx(NF,{className:"w-4 h-4"}):s.jsx(jF,{className:"w-4 h-4"}),f=()=>!a||a==="neutral"?"text-gray-500":a==="up"?"text-green-600":"text-red-600",h=p=>typeof p=="number"?p.toLocaleString():p;return s.jsxs(He,{className:ke("glass-card inner-glow floating-shadow",l),children:[s.jsx(Er,{className:"pb-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(qr,{className:"text-sm font-medium text-gray-600",children:e}),i&&s.jsx("div",{className:"text-synth-pink",children:i})]})}),s.jsx(et,{children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:[c,h(t),d]}),(r!==void 0||n!==void 0)&&s.jsxs("div",{className:ke("flex items-center gap-1 text-sm",f()),children:[u(),s.jsxs("span",{className:"font-medium",children:[r!==void 0&&`${r>0?"+":""}${r}`,n!==void 0&&` (${n>0?"+":""}${n}%)`]}),o&&s.jsx("span",{className:"text-gray-500 ml-1",children:o})]}),!r&&!n&&o&&s.jsx("div",{className:"text-sm text-gray-500",children:o})]})})]})}function aA({name:e,description:t,icon:r,progress:n,goal:a,unlocked:i,unlockedAt:o,className:l,compact:c=!1}){const d=Math.min(n/a*100,100);return c?s.jsxs("div",{className:ke("flex items-center gap-3 p-3 rounded-lg border transition-all",i?"bg-gradient-to-r from-yellow-50 to-amber-50 border-yellow-200":"bg-gray-50 border-gray-200 opacity-60",l),children:[s.jsx("div",{className:"text-3xl",children:r}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-semibold text-sm text-gray-900",children:e}),i&&s.jsxs(Ke,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 text-xs",children:[s.jsx(ta,{className:"w-3 h-3 mr-1"}),"Unlocked"]}),!i&&s.jsx(Ev,{className:"w-3 h-3 text-gray-400"})]}),s.jsx("p",{className:"text-xs text-gray-600",children:t}),!i&&s.jsxs("div",{className:"mt-1",children:[s.jsx(xm,{value:d,className:"h-1"}),s.jsxs("span",{className:"text-xs text-gray-500",children:[n,"/",a]})]})]})]}):s.jsx(He,{className:ke("overflow-hidden transition-all hover:shadow-md",i?"glass-card border-2 border-yellow-300 bg-gradient-to-br from-yellow-50/80 to-amber-50/80":"bg-white border-gray-200 opacity-75",l),children:s.jsxs(et,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:ke("text-5xl",i?"animate-bounce":"grayscale"),children:r}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:e}),s.jsx("p",{className:"text-sm text-gray-600",children:t})]})]}),i?s.jsxs(Ke,{className:"bg-yellow-500 text-white border-0",children:[s.jsx(ta,{className:"w-4 h-4 mr-1"}),"Unlocked!"]}):s.jsxs("div",{className:"flex items-center gap-1 text-gray-400",children:[s.jsx(Ev,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Locked"})]})]}),!i&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Progress"}),s.jsxs("span",{className:"font-semibold text-gray-900",children:[n,"/",a," (",Math.round(d),"%)"]})]}),s.jsx(xm,{value:d,className:"h-2"})]}),i&&o&&s.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:["Unlocked on ",new Date(o).toLocaleDateString()]})]})})}function to(){return s.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm animate-pulse",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3"}),s.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded-full"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6"})]}),s.jsxs("div",{className:"flex items-center gap-2 pt-4",children:[s.jsx("div",{className:"h-10 bg-gray-200 rounded w-1/4"}),s.jsx("div",{className:"h-10 bg-gray-200 rounded w-1/4"})]})]})})}function W7({stages:e,title:t="Conversion Funnel",showOptimizationTips:r=!0,className:n=""}){var u,f;const a=h=>h>=1e6?`${(h/1e6).toFixed(1)}M`:h>=1e3?`${(h/1e3).toFixed(1)}K`:h.toString(),i=h=>{const p=["from-blue-500 to-blue-600","from-purple-500 to-purple-600","from-pink-500 to-pink-600","from-green-500 to-green-600","from-yellow-500 to-yellow-600"];return p[h%p.length]},o=h=>h>70?"high":h>40?"medium":"low",l=h=>{switch(h){case"high":return"text-red-600 bg-red-50";case"medium":return"text-yellow-600 bg-yellow-50";case"low":return"text-green-600 bg-green-50"}},c=((u=e[0])==null?void 0:u.users_entered)||0,d=((f=e[e.length-1])==null?void 0:f.conversion_rate)||0;return s.jsxs(He,{className:`glass-card inner-glow ${n}`,children:[s.jsx(Er,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(qr,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Zi,{className:"w-5 h-5 text-synth-pink"}),t]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Ke,{variant:"outline",className:"text-blue-600 border-blue-200",children:[a(c)," Total Users"]}),s.jsxs(Ke,{variant:"outline",className:"text-green-600 border-green-200",children:[d.toFixed(1),"% Final Conversion"]})]})]})}),s.jsxs(et,{className:"space-y-4",children:[s.jsx("div",{className:"space-y-3",children:e.map((h,p)=>{const g=p===e.length-1,v=o(h.drop_off_rate),y=i(h.stage_order);return s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"flex items-center gap-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:h.stage_name}),s.jsxs(Ke,{variant:"outline",className:`text-xs ${l(v)}`,children:[h.conversion_rate.toFixed(1),"% conversion"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[a(h.users_entered),"  ",a(h.users_completed)]}),s.jsxs("p",{className:"text-xs text-gray-600",children:[h.average_time_spent.toFixed(1),"m avg time"]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-full h-8 bg-gray-200 rounded-lg overflow-hidden",children:s.jsx("div",{className:`h-full bg-gradient-to-r ${y} transition-all duration-500`,style:{width:`${h.users_completed/h.users_entered*100}%`}})}),h.drop_off_rate>0&&s.jsxs("div",{className:"absolute top-0 right-0 flex items-center gap-1",children:[s.jsx(OF,{className:"w-4 h-4 text-red-500"}),s.jsxs("span",{className:"text-xs text-red-600 font-medium",children:["-",h.drop_off_rate.toFixed(1),"%"]})]})]}),h.revenue_attributed>0&&s.jsx("div",{className:"mt-2 flex items-center gap-2",children:s.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["$",h.revenue_attributed.toFixed(0)," revenue"]})})]})}),!g&&s.jsx("div",{className:"flex justify-center my-2",children:s.jsx(iQ,{className:"w-4 h-4 text-gray-400"})})]},h.stage_name)})}),r&&s.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(NP,{className:"w-4 h-4 text-yellow-600"}),s.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Optimization Opportunities"})]}),s.jsxs("div",{className:"space-y-2",children:[e.filter(h=>h.drop_off_rate>40).map((h,p)=>s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full mt-2 flex-shrink-0"}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-xs font-medium text-gray-900",children:[h.stage_name," Stage"]}),s.jsxs("p",{className:"text-xs text-gray-600",children:[h.drop_off_rate.toFixed(1),"% drop-off rate - ",h.optimization_opportunities[0]]})]})]},p)),e.filter(h=>h.drop_off_rate>40).length===0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(dc,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-xs text-green-700",children:"Great! No significant drop-off issues detected."})]})]})]}),s.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Key Actions Across Funnel"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:Array.from(new Set(e.flatMap(h=>h.key_actions))).slice(0,6).map((h,p)=>s.jsx(Ke,{variant:"secondary",className:"text-xs",children:h},p))})]})]})]})}function H7({sources:e,totalRevenue:t,title:r="Revenue Attribution",showConfidenceScores:n=!0,showTrends:a=!0,className:i=""}){var f,h;const o=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(p),l=p=>p>=.8?"text-green-600 bg-green-50":p>=.6?"text-yellow-600 bg-yellow-50":p>=.4?"text-orange-600 bg-orange-50":"text-red-600 bg-red-50",c=p=>p>=.8?"High":p>=.6?"Medium":p>=.4?"Low":"Very Low",d=p=>{const g=["from-blue-500 to-blue-600","from-green-500 to-green-600","from-purple-500 to-purple-600","from-pink-500 to-pink-600","from-yellow-500 to-yellow-600","from-indigo-500 to-indigo-600"];return g[p%g.length]},u=p=>p?s.jsxs("div",{className:`flex items-center gap-1 ${p>0?"text-green-600":"text-red-600"}`,children:[s.jsx(Bn,{className:`w-3 h-3 ${p<0?"rotate-180":""}`}),s.jsxs("span",{className:"text-xs",children:[Math.abs(p).toFixed(1),"%"]})]}):null;return s.jsxs(He,{className:`glass-card inner-glow ${i}`,children:[s.jsx(Er,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(qr,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Ro,{className:"w-5 h-5 text-synth-pink"}),r]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o(t)}),s.jsx("p",{className:"text-sm text-gray-600",children:"Total Revenue"})]})]})}),s.jsxs(et,{className:"space-y-4",children:[s.jsx("div",{className:"space-y-3",children:e.map((p,g)=>s.jsxs("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-gray-100 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-10 h-10 bg-gradient-to-r ${d(g)} rounded-full flex items-center justify-center`,children:s.jsx(Ro,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 capitalize",children:p.source}),s.jsxs("p",{className:"text-sm text-gray-600",children:[p.attribution_window,"h attribution window"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-gray-900",children:o(p.revenue)}),s.jsxs("p",{className:"text-sm text-gray-600",children:[p.percentage.toFixed(1),"% of total"]})]})]}),s.jsx("div",{className:"mb-3",children:s.jsx("div",{className:"w-full h-3 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full bg-gradient-to-r ${d(g)} transition-all duration-500`,style:{width:`${p.percentage}%`}})})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[n&&s.jsxs(Ke,{variant:"outline",className:`text-xs ${l(p.confidence_score)}`,children:[c(p.confidence_score)," Confidence"]}),a&&u(p.trend)]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:"text-xs text-gray-600",children:["Confidence: ",(p.confidence_score*100).toFixed(0),"%"]})})]})]},p.source))}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[s.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Ib,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Top Source"})]}),s.jsx("p",{className:"text-lg font-bold text-blue-900",children:((f=e[0])==null?void 0:f.source)||"N/A"}),s.jsxs("p",{className:"text-xs text-blue-700",children:[(h=e[0])==null?void 0:h.percentage.toFixed(1),"% of revenue"]})]}),s.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Fd,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-900",children:"Avg Confidence"})]}),s.jsxs("p",{className:"text-lg font-bold text-green-900",children:[(e.reduce((p,g)=>p+g.confidence_score,0)/e.length*100).toFixed(0),"%"]}),s.jsx("p",{className:"text-xs text-green-700",children:"Data quality score"})]})]}),e.some(p=>p.confidence_score<.5)&&s.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Sv,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-900",children:"Data Quality Notice"})]}),s.jsx("p",{className:"text-xs text-yellow-800 mt-1",children:"Some revenue sources have low confidence scores. Consider improving data collection for more accurate attribution."})]}),s.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Attribution Insights"}),s.jsx("div",{className:"space-y-1",children:e.filter(p=>p.percentage>20).map((p,g)=>s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("span",{className:"text-gray-700",children:[p.source," drives ",p.percentage.toFixed(1),"% of revenue"]}),s.jsxs("span",{className:"text-gray-600",children:[p.attribution_window,"h window"]})]},g))})]})]})]})}function G7({metrics:e,title:t="Engagement Score",showBreakdown:r=!0,previousScore:n,className:a=""}){const i=f=>f>=80?"text-green-600":f>=60?"text-yellow-600":f>=40?"text-orange-600":"text-red-600",o=f=>f>=80?"Excellent":f>=60?"Good":f>=40?"Fair":"Poor",l=f=>f>=80?"Outstanding engagement! Users are highly active and invested.":f>=60?"Good engagement levels. Room for improvement in some areas.":f>=40?"Moderate engagement. Focus on improving user experience.":"Low engagement. Significant improvements needed to retain users.",d=n?((f,h)=>{if(!h)return{value:0,isPositive:!0};const p=f-h;return{value:Math.abs(p),isPositive:p>=0}})(e.score,n):null,u=e.score/100*180;return s.jsxs(He,{className:`glass-card inner-glow ${a}`,children:[s.jsx(Er,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(qr,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(wo,{className:"w-5 h-5 text-synth-pink"}),t]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ke,{variant:"outline",className:`${i(e.score)} border-current`,children:o(e.score)}),d&&s.jsxs("div",{className:`flex items-center gap-1 text-xs ${d.isPositive?"text-green-600":"text-red-600"}`,children:[s.jsx(Bn,{className:`w-3 h-3 ${d.isPositive?"":"rotate-180"}`}),d.value.toFixed(0)," pts"]})]})]})}),s.jsxs(et,{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-center",children:s.jsxs("div",{className:"relative w-48 h-24",children:[s.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 200 100",children:[s.jsx("path",{d:"M 20 80 A 60 60 0 0 1 180 80",stroke:"#e5e7eb",strokeWidth:"12",fill:"none",strokeLinecap:"round"}),s.jsx("path",{d:"M 20 80 A 60 60 0 0 1 180 80",stroke:e.score>=80?"#10b981":e.score>=60?"#f59e0b":e.score>=40?"#f97316":"#ef4444",strokeWidth:"12",fill:"none",strokeLinecap:"round",strokeDasharray:`${u*1.05} 314`,strokeDashoffset:"157",className:"transition-all duration-1000 ease-out"})]}),s.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[s.jsx("div",{className:`text-3xl font-bold ${i(e.score)}`,children:e.score}),s.jsx("div",{className:"text-sm text-gray-600",children:"/ 100"})]})]})}),s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-sm text-gray-700",children:l(e.score)})}),r&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Engagement Breakdown"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 rounded-lg",children:[s.jsx(ga,{className:"w-4 h-4 text-blue-600"}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.floor(e.sessionDuration/6e4),"m"]}),s.jsx("p",{className:"text-xs text-gray-600",children:"Session Time"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 rounded-lg",children:[s.jsx(_P,{className:"w-4 h-4 text-green-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.interactionCount}),s.jsx("p",{className:"text-xs text-gray-600",children:"Interactions"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 rounded-lg",children:[s.jsx(Kd,{className:"w-3 h-3 text-gray-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-900",children:e.pageViews}),s.jsx("p",{className:"text-xs text-gray-600",children:"Views"})]})]}),s.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 rounded-lg",children:[s.jsx(ns,{className:"w-3 h-3 text-gray-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-900",children:e.likes}),s.jsx("p",{className:"text-xs text-gray-600",children:"Likes"})]})]}),s.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 rounded-lg",children:[s.jsx(wo,{className:"w-3 h-3 text-gray-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-900",children:e.shares}),s.jsx("p",{className:"text-xs text-gray-600",children:"Shares"})]})]})]}),e.bounceRate>70&&s.jsxs("div",{className:"p-2 bg-red-50 border border-red-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),s.jsxs("span",{className:"text-xs font-medium text-red-900",children:["High bounce rate: ",e.bounceRate.toFixed(1),"%"]})]}),s.jsx("p",{className:"text-xs text-red-700 mt-1",children:"Consider improving content relevance and user experience"})]})]}),s.jsxs("div",{className:"p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Improvement Suggestions"}),s.jsxs("div",{className:"space-y-1",children:[e.score<60&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full"}),s.jsx("span",{className:"text-xs text-gray-700",children:"Increase session duration by improving content quality"})]}),e.interactionCount<5&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full"}),s.jsx("span",{className:"text-xs text-gray-700",children:"Add more interactive elements to boost engagement"})]}),e.bounceRate>50&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full"}),s.jsx("span",{className:"text-xs text-gray-700",children:"Optimize page load times and content relevance"})]}),e.score>=80&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-xs text-green-700",children:"Excellent engagement! Keep up the great work"})]})]})]})]})]})}function Y7({data:e,title:t="Trend Analysis",valueLabel:r="Value",showTrend:n=!0,showForecast:a=!1,className:i=""}){var v;const o=y=>y>=1e6?`${(y/1e6).toFixed(1)}M`:y>=1e3?`${(y/1e3).toFixed(1)}K`:y.toString(),l=y=>new Date(y).toLocaleDateString("en-US",{month:"short",day:"numeric"}),c=y=>{if(y.length<2)return{direction:"flat",percentage:0};const _=y[0].value,b=(y[y.length-1].value-_)/_*100;return Math.abs(b)<1?{direction:"flat",percentage:0}:{direction:b>0?"up":"down",percentage:Math.abs(b)}},d=()=>Math.max(...e.map(y=>y.value)),u=()=>Math.min(...e.map(y=>y.value)),f=(y,_,w)=>_===w?50:(y-w)/(_-w)*100,h=c(e),p=d(),g=u();return s.jsxs(He,{className:`glass-card inner-glow ${i}`,children:[s.jsx(Er,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(qr,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Fd,{className:"w-5 h-5 text-synth-pink"}),t]}),n&&s.jsxs("div",{className:"flex items-center gap-2",children:[h.direction==="up"&&s.jsxs(Ke,{variant:"outline",className:"text-green-600 border-green-200",children:[s.jsx(Bn,{className:"w-3 h-3 mr-1"}),"+",h.percentage.toFixed(1),"%"]}),h.direction==="down"&&s.jsxs(Ke,{variant:"outline",className:"text-red-600 border-red-200",children:[s.jsx(OF,{className:"w-3 h-3 mr-1"}),"-",h.percentage.toFixed(1),"%"]}),h.direction==="flat"&&s.jsxs(Ke,{variant:"outline",className:"text-gray-600 border-gray-200",children:[s.jsx(Zi,{className:"w-3 h-3 mr-1"}),"Stable"]})]})]})}),s.jsxs(et,{className:"space-y-4",children:[s.jsxs("div",{className:"relative h-48 bg-gradient-to-b from-gray-50 to-white rounded-lg p-4",children:[s.jsx("div",{className:"absolute inset-4",children:[0,25,50,75,100].map((y,_)=>s.jsx("div",{className:"absolute w-full border-t border-gray-200",style:{top:`${y}%`}},_))}),s.jsxs("svg",{className:"absolute inset-4 w-full h-full",children:[s.jsx("polyline",{fill:"none",stroke:"#8b5cf6",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",points:e.map((y,_)=>{const w=_/(e.length-1)*100,b=100-f(y.value,p,g);return`${w},${b}`}).join(" ")}),e.map((y,_)=>{const w=_/(e.length-1)*100,b=100-f(y.value,p,g);return s.jsx("circle",{cx:w,cy:b,r:"4",fill:"#8b5cf6",className:"hover:r-6 transition-all duration-200"},_)})]}),s.jsxs("div",{className:"absolute left-0 top-4 bottom-4 flex flex-col justify-between text-xs text-gray-600",children:[s.jsx("span",{children:o(p)}),s.jsx("span",{children:o((p+g)/2)}),s.jsx("span",{children:o(g)})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-blue-900",children:o(((v=e[e.length-1])==null?void 0:v.value)||0)}),s.jsx("div",{className:"text-xs text-blue-700",children:"Current"})]}),s.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-green-900",children:o(p)}),s.jsx("div",{className:"text-xs text-green-700",children:"Peak"})]}),s.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-purple-900",children:o(e.reduce((y,_)=>y+_.value,0)/e.length)}),s.jsx("div",{className:"text-xs text-purple-700",children:"Average"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Recent Data"}),s.jsx("div",{className:"space-y-1",children:e.slice(-5).map((y,_)=>s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-gray-600",children:l(y.date)}),s.jsx("span",{className:"font-medium text-gray-900",children:o(y.value)}),y.label&&s.jsx("span",{className:"text-gray-500",children:y.label})]},_))})]}),n&&s.jsxs("div",{className:"p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(It,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Trend Analysis"})]}),s.jsxs("p",{className:"text-xs text-gray-700",children:[h.direction==="up"&&`Showing ${h.percentage.toFixed(1)}% growth over the period`,h.direction==="down"&&`Showing ${h.percentage.toFixed(1)}% decline over the period`,h.direction==="flat"&&"Values have remained relatively stable"]})]})]})]})}class vi{static logError(t,r,n,a="medium",i="unknown"){return E(this,null,function*(){const o=typeof r=="string"?r:r.message;console.error(`[${a.toUpperCase()}] ${t}:`,o,n)})}static logValidationError(t,r,n){return E(this,null,function*(){yield this.logError(`validation_error: ${t}`,`Validation failed: ${r.join(", ")}`,{validation_errors:r,invalid_data:n},"medium","validation")})}static logNetworkError(t,r,n,a){return E(this,null,function*(){yield this.logError(`network_error: ${t}`,r,{url:n,status_code:a},"high","network")})}static logDatabaseError(t,r,n,a){return E(this,null,function*(){yield this.logError(`database_error: ${t}`,r,{query:n,table:a},"high","database")})}static logAuthError(t,r,n){return E(this,null,function*(){yield this.logError(`auth_error: ${t}`,r,{user_id:n},"medium","authentication")})}static logBusinessLogicError(t,r,n){return E(this,null,function*(){yield this.logError(`business_logic_error: ${t}`,r,n,"medium","business_logic")})}static getErrorStats(t=24){return E(this,null,function*(){return{total_errors:0,errors_by_category:{},errors_by_severity:{},recent_errors:[],error_rate:0}})}static getErrorsByCategory(t,r=50){return E(this,null,function*(){return[]})}static getCriticalErrors(t=20){return E(this,null,function*(){return[]})}static resolveError(t,r){return E(this,null,function*(){return!1})}static getErrorTrends(t=7){return E(this,null,function*(){return[]})}static getErrorCategories(){return this.ERROR_CATEGORIES}static getSeverityLevels(){return this.SEVERITY_LEVELS}}Cr(vi,"ERROR_CATEGORIES",{validation:"Data validation errors",network:"Network and API errors",database:"Database operation errors",authentication:"User authentication errors",business_logic:"Application logic errors",unknown:"Uncategorized errors"}),Cr(vi,"SEVERITY_LEVELS",{low:"Minor issues, non-blocking",medium:"Moderate issues, may affect functionality",high:"Serious issues, significant impact",critical:"Critical issues, system-breaking"});const ki=vi.logError.bind(vi);vi.logValidationError.bind(vi);vi.logNetworkError.bind(vi);vi.logDatabaseError.bind(vi);vi.logAuthError.bind(vi);vi.logBusinessLogicError.bind(vi);class iA{static analyzeFunnel(t,r,n){return E(this,null,function*(){try{const{data:a}=yield T.from("users").select("user_id").eq("account_type",t);if(!a||a.length===0)return this.createEmptyFunnel(t);const i=a.map(v=>v.user_id),{data:o,error:l}=yield T.from("interactions").select("*").in("user_id",i).gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString()).order("occurred_at",{ascending:!0});if(l)return yield ki("funnel_analysis_error",l,{userType:t,timeRange:r}),this.createEmptyFunnel(t);if(!o)return this.createEmptyFunnel(t);const c=yield this.analyzeFunnelStages(o,t),d=new Set(o.map(v=>v.user_id)).size,u=this.calculateOverallConversionRate(c),f=this.calculateTotalRevenue(c),h=this.calculateAverageTimeToConversion(o),p=this.identifyTopDropOffStages(c),g=this.generateRecommendations(c,t);return{funnel_id:`${t}_funnel_${Date.now()}`,funnel_name:`${t.charAt(0).toUpperCase()+t.slice(1)} Conversion Funnel`,total_users:d,overall_conversion_rate:u,stages:c,total_revenue:f,average_time_to_conversion:h,top_drop_off_stages:p,recommendations:g}}catch(a){return yield ki("funnel_analysis_exception",a,{userType:t,timeRange:r}),this.createEmptyFunnel(t)}})}static trackUserJourney(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("*").eq("user_id",t).gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString()).order("occurred_at",{ascending:!0});if(a)return yield ki("user_journey_tracking_error",a,{userId:t,timeRange:r}),[];if(!n||n.length===0)return[];const i=this.groupInteractionsBySession(n),o=[];for(const l of i){const c=this.analyzeUserJourney(t,l);o.push(c)}return o}catch(n){return yield ki("user_journey_tracking_exception",n,{userId:t,timeRange:r}),[]}})}static compareFunnels(t,r){return E(this,null,function*(){const n=r.overall_conversion_rate-t.overall_conversion_rate,a=r.total_revenue-t.total_revenue,i=t.average_time_to_conversion-r.average_time_to_conversion;return{funnel_a:t,funnel_b:r,improvement_metrics:{conversion_rate_improvement:Math.round(n*100)/100,revenue_improvement:Math.round(a*100)/100,time_improvement:Math.round(i*100)/100}}})}static getOptimizationRecommendations(t){return E(this,null,function*(){const r=[];for(const n of t.top_drop_off_stages)n.drop_off_rate>50&&r.push({priority:"high",category:"conversion",title:`Reduce Drop-off at ${n.stage} Stage`,description:`${n.users_lost} users are dropping off at the ${n.stage} stage (${n.drop_off_rate}% drop-off rate)`,expected_impact:`Could improve conversion by ${Math.round(n.drop_off_rate*.3)}%`,implementation_effort:"medium"});return t.overall_conversion_rate<5&&r.push({priority:"high",category:"conversion",title:"Improve Overall Conversion Rate",description:`Current conversion rate is ${t.overall_conversion_rate}%, which is below industry standards`,expected_impact:"Could double conversion rate with optimization",implementation_effort:"high"}),t.average_time_to_conversion>7&&r.push({priority:"medium",category:"engagement",title:"Reduce Time to Conversion",description:`Average time to conversion is ${t.average_time_to_conversion} days`,expected_impact:"Could reduce time to conversion by 30-50%",implementation_effort:"medium"}),r})}static analyzeFunnelStages(t,r){return E(this,null,function*(){const n=[],a=Object.values(this.FUNNEL_STAGES);for(const i of a){const o=t.filter(v=>i.events.includes(v.event_type)),l=new Set(o.map(v=>v.user_id)).size,c=this.calculateUsersCompleted(o,i.order),d=l>0?c/l*100:0,u=l>0?(l-c)/l*100:0,f=this.calculateAverageTimeSpent(o),h=this.calculateStageRevenue(o),p=this.identifyKeyActions(o),g=this.identifyOptimizationOpportunities(i,o);n.push({stage_name:i.name,stage_order:i.order,users_entered:l,users_completed:c,conversion_rate:Math.round(d*100)/100,drop_off_rate:Math.round(u*100)/100,average_time_spent:Math.round(f*100)/100,revenue_attributed:Math.round(h*100)/100,key_actions:p,optimization_opportunities:g})}return n})}static calculateUsersCompleted(t,r){const n=this.getNextStageEvents(r),a=t.filter(i=>n.includes(i.event_type));return new Set(a.map(i=>i.user_id)).size}static getNextStageEvents(t){const n=Object.values(this.FUNNEL_STAGES).find(a=>a.order===t+1);return n?n.events:[]}static calculateAverageTimeSpent(t){if(t.length===0)return 0;const n=this.groupInteractionsBySession(t).map(a=>{const i=new Date(a[0].occurred_at);return(new Date(a[a.length-1].occurred_at).getTime()-i.getTime())/(1e3*60)});return n.reduce((a,i)=>a+i,0)/n.length}static calculateStageRevenue(t){return t.filter(r=>r.event_type==="ticket_click"||r.event_type==="form_submit"),0}static identifyKeyActions(t){const r={};return t.forEach(n=>{r[n.event_type]=(r[n.event_type]||0)+1}),Object.entries(r).sort(([,n],[,a])=>a-n).slice(0,3).map(([n])=>n)}static identifyOptimizationOpportunities(t,r){const n=[];return r.length===0?(n.push("No user activity in this stage - consider improving discovery"),n):(this.calculateStageConversionRate(r)<20&&n.push("Low conversion rate - consider improving user experience"),this.calculateAverageTimeSpent(r)>10&&n.push("Users spending too much time - consider simplifying the process"),n)}static calculateStageConversionRate(t){const r=new Set(t.map(a=>a.user_id)).size,n=new Set(t.filter(a=>a.event_type==="ticket_click"||a.event_type==="form_submit").map(a=>a.user_id)).size;return r>0?n/r*100:0}static groupInteractionsBySession(t){const r={};return t.forEach(n=>{const a=n.session_id||"default";r[a]||(r[a]=[]),r[a].push(n)}),Object.values(r)}static analyzeUserJourney(t,r){const n=r[0].occurred_at,a=r[r.length-1].occurred_at,i=new Date(a).getTime()-new Date(n).getTime(),o=this.identifyStagesCompleted(r),l=this.checkConversionAchieved(r),c=this.calculateJourneyRevenue(r),d=r.map(u=>({timestamp:u.occurred_at,stage:this.mapEventToStage(u.event_type),action:u.event_type,entity_id:u.entity_id,metadata:u.metadata}));return{user_id:t,journey_id:r[0].session_id||crypto.randomUUID(),start_time:n,end_time:a,stages_completed:o,total_duration:i,conversion_achieved:l,revenue_generated:c,touchpoints:d}}static identifyStagesCompleted(t){const r=new Set;return t.forEach(n=>{const a=this.mapEventToStage(n.event_type);a&&r.add(a)}),Array.from(r)}static mapEventToStage(t){for(const[r,n]of Object.entries(this.FUNNEL_STAGES))if(n.events.includes(t))return r;return null}static checkConversionAchieved(t){return t.some(r=>r.event_type==="ticket_click"||r.event_type==="form_submit")}static calculateJourneyRevenue(t){return t.filter(n=>n.event_type==="ticket_click"||n.event_type==="form_submit").length*50}static calculateOverallConversionRate(t){if(t.length===0)return 0;const r=t[0],n=t[t.length-1];return r.users_entered>0?n.users_completed/r.users_entered*100:0}static calculateTotalRevenue(t){return t.reduce((r,n)=>r+n.revenue_attributed,0)}static calculateAverageTimeToConversion(t){const n=this.groupInteractionsBySession(t).filter(i=>i.some(o=>o.event_type==="ticket_click"||o.event_type==="form_submit"));return n.length===0?0:n.reduce((i,o)=>{const l=new Date(o[0].occurred_at),c=new Date(o[o.length-1].occurred_at);return i+(c.getTime()-l.getTime())},0)/(n.length*(1e3*60*60*24))}static identifyTopDropOffStages(t){return t.map(r=>({stage:r.stage_name,drop_off_rate:r.drop_off_rate,users_lost:r.users_entered-r.users_completed})).sort((r,n)=>n.drop_off_rate-r.drop_off_rate).slice(0,3)}static generateRecommendations(t,r){const n=[],a=t.filter(o=>o.drop_off_rate>50);a.length>0&&n.push(`Focus on reducing drop-off in ${a.map(o=>o.stage_name).join(", ")} stages`);const i=t.filter(o=>o.conversion_rate<20);return i.length>0&&n.push(`Improve conversion rates in ${i.map(o=>o.stage_name).join(", ")} stages`),r==="user"?(n.push("Consider implementing social proof and user testimonials"),n.push("Add personalized recommendations based on music taste")):r==="creator"?(n.push("Provide detailed analytics and performance metrics"),n.push("Offer exclusive content and early access features")):r==="business"&&(n.push("Showcase venue capacity and past successful events"),n.push("Provide detailed ROI and revenue projections")),n}static createEmptyFunnel(t){return{funnel_id:`${t}_funnel_empty`,funnel_name:`${t.charAt(0).toUpperCase()+t.slice(1)} Conversion Funnel`,total_users:0,overall_conversion_rate:0,stages:[],total_revenue:0,average_time_to_conversion:0,top_drop_off_stages:[],recommendations:["No data available for analysis"]}}}Cr(iA,"FUNNEL_STAGES",{discovery:{name:"Discovery",order:1,events:["view","search","navigate"],description:"User discovers content or platform"},interest:{name:"Interest",order:2,events:["interest","like","follow","share"],description:"User shows interest in content"},consideration:{name:"Consideration",order:3,events:["click","navigate","view"],description:"User considers taking action"},conversion:{name:"Conversion",order:4,events:["ticket_click","form_submit","profile_update"],description:"User completes desired action"}});class Tf{static calculateTicketRevenue(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("*").eq("user_id",t).eq("event_type","click").eq("entity_type","ticket_link").gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString());if(a)return yield ki("revenue_calculation_error",a,{userId:t,timeRange:r}),[];const i=[];for(const o of n||[]){const l=this.estimateTicketPrice(o.metadata),c=this.calculateConfidenceScore(o.metadata);i.push({id:crypto.randomUUID(),interaction_id:o.id,revenue_type:"ticket_click",estimated_amount:l,currency:"USD",attribution_window_hours:this.ATTRIBUTION_WINDOWS.ticket_click,confidence_score:c,user_id:t,entity_id:o.entity_id,entity_type:o.entity_type,created_at:new Date().toISOString(),metadata:{original_click:o,estimation_method:"ticket_click_analysis"}})}return i}catch(n){return yield ki("ticket_revenue_calculation_error",n,{userId:t,timeRange:r}),[]}})}static calculateSubscriptionRevenue(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("*").eq("user_id",t).in("event_type",["profile_update","form_submit"]).gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString());if(a)return yield ki("subscription_revenue_calculation_error",a,{userId:t,timeRange:r}),[];const i=[],o=(n==null?void 0:n.filter(l=>{const c=l.metadata;return(c==null?void 0:c.field)==="subscription_tier"||(c==null?void 0:c.formType)==="subscription"}))||[];for(const l of o){const c=this.estimateSubscriptionValue(l.metadata),d=this.calculateSubscriptionConfidence(l.metadata);i.push({id:crypto.randomUUID(),interaction_id:l.id,revenue_type:"subscription",estimated_amount:c,currency:"USD",attribution_window_hours:this.ATTRIBUTION_WINDOWS.subscription,confidence_score:d,user_id:t,entity_id:l.entity_id,entity_type:l.entity_type,created_at:new Date().toISOString(),metadata:{original_interaction:l,estimation_method:"subscription_analysis"}})}return i}catch(n){return yield ki("subscription_revenue_calculation_error",n,{userId:t,timeRange:r}),[]}})}static calculateAffiliateRevenue(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("interactions").select("*").eq("user_id",t).eq("event_type","share").gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString());if(a)return yield ki("affiliate_revenue_calculation_error",a,{userId:t,timeRange:r}),[];const i=[];for(const o of n||[]){const l=this.estimateAffiliateCommission(o.metadata),c=this.calculateAffiliateConfidence(o.metadata);l>0&&i.push({id:crypto.randomUUID(),interaction_id:o.id,revenue_type:"affiliate",estimated_amount:l,currency:"USD",attribution_window_hours:this.ATTRIBUTION_WINDOWS.affiliate,confidence_score:c,user_id:t,entity_id:o.entity_id,entity_type:o.entity_type,created_at:new Date().toISOString(),metadata:{original_share:o,estimation_method:"affiliate_analysis"}})}return i}catch(n){return yield ki("affiliate_revenue_calculation_error",n,{userId:t,timeRange:r}),[]}})}static getUserRevenueMetrics(t,r){return E(this,null,function*(){try{return{total_revenue:0,revenue_by_type:{},conversion_rate:0,average_order_value:0,revenue_per_user:0,top_revenue_sources:[]}}catch(n){return yield ki("revenue_metrics_calculation_error",n,{userId:t,timeRange:r}),{total_revenue:0,revenue_by_type:{},conversion_rate:0,average_order_value:0,revenue_per_user:0,top_revenue_sources:[]}}})}static analyzeConversionFunnel(t,r){return E(this,null,function*(){try{const{data:n}=yield T.from("interactions").select("*").eq("user_id",t).gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString());if(!n)return[];const a=[{name:"discovery",events:["view","search"]},{name:"interest",events:["interest","like","follow"]},{name:"consideration",events:["click","navigate"]},{name:"conversion",events:["ticket_click","form_submit"]}],i=[];let o=0;for(let l=0;l<a.length;l++){const c=a[l],d=n.filter(g=>c.events.includes(g.event_type)),u=new Set(d.map(g=>g.user_id)).size,f=o>0?u/o*100:100,h=o>0?(o-u)/o*100:0;i.push({stage:c.name,users:u,conversion_rate:Math.round(f*100)/100,drop_off_rate:Math.round(h*100)/100,revenue_attributed:Math.round(0*100)/100}),o=u}return i}catch(n){return yield ki("conversion_funnel_analysis_error",n,{userId:t,timeRange:r}),[]}})}static getRevenueTrends(t,r="day"){return E(this,null,function*(){try{const{data:n}=yield T.from("interactions").select("*").gte("occurred_at",t.start.toISOString()).lte("occurred_at",t.end.toISOString()).in("event_type",["click","ticket_click","form_submit"]);if(!n)return[];const a={};return n.forEach(i=>{const o=new Date(i.occurred_at);let l;switch(r){case"day":l=o.toISOString().split("T")[0];break;case"week":const c=new Date(o);c.setDate(o.getDate()-o.getDay()),l=c.toISOString().split("T")[0];break;case"month":l=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`;break;default:l=o.toISOString().split("T")[0]}a[l]||(a[l]={revenue:0,conversions:0,interactions:0}),a[l].interactions++,i.event_type==="ticket_click"&&(a[l].conversions++,a[l].revenue+=0)}),Object.entries(a).map(([i,o])=>({date:i,revenue:o.revenue,conversions:o.conversions,conversion_rate:o.interactions>0?o.conversions/o.interactions*100:0,average_order_value:o.conversions>0?o.revenue/o.conversions:0})).sort((i,o)=>i.date.localeCompare(o.date))}catch(n){return yield ki("revenue_trends_calculation_error",n,{timeRange:t,groupBy:r}),[]}})}static estimateTicketPrice(t){return t!=null&&t.price&&typeof t.price=="number"?t.price:this.ESTIMATED_TICKET_PRICE}static estimateSubscriptionValue(t){switch((t==null?void 0:t.newTier)||(t==null?void 0:t.subscription_tier)){case"premium":return this.ESTIMATED_SUBSCRIPTION_PRICE;case"professional":return this.ESTIMATED_SUBSCRIPTION_PRICE*2;case"enterprise":return this.ESTIMATED_SUBSCRIPTION_PRICE*5;default:return 0}}static estimateAffiliateCommission(t){const r=t==null?void 0:t.platform;return r==="instagram"||r==="twitter"||r==="facebook"?this.ESTIMATED_TICKET_PRICE*this.ESTIMATED_AFFILIATE_COMMISSION:0}static calculateConfidenceScore(t){let r=.5;return t!=null&&t.price&&(r+=.3),t!=null&&t.venue_name&&(r+=.1),t!=null&&t.artist_name&&(r+=.1),Math.min(r,1)}static calculateSubscriptionConfidence(t){let r=.3;return t!=null&&t.newTier&&(r+=.4),t!=null&&t.oldTier&&(r+=.2),t!=null&&t.changeType&&(r+=.1),Math.min(r,1)}static calculateAffiliateConfidence(t){let r=.2;return t!=null&&t.platform&&(r+=.3),t!=null&&t.reach&&(r+=.2),t!=null&&t.engagement&&(r+=.3),Math.min(r,1)}}Cr(Tf,"ESTIMATED_TICKET_PRICE",50),Cr(Tf,"ESTIMATED_SUBSCRIPTION_PRICE",4.99),Cr(Tf,"ESTIMATED_AFFILIATE_COMMISSION",.05),Cr(Tf,"ATTRIBUTION_WINDOWS",{ticket_click:24,subscription:30*24,affiliate:7*24});class Gi{static getUserPromotions(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select(`
          *,
          event:jambase_events!event_promotions_event_id_fkey(
            id,
            title,
            artist_name,
            venue_name,
            event_date,
            poster_image_url
          )
        `).eq("promoted_by_user_id",t).order("created_at",{ascending:!1});if(n)throw n;if(r&&r.length>0)for(const i of r)try{yield _l.syncPromotionMetrics(i.id)}catch(o){console.error(`Error syncing metrics for promotion ${i.id}:`,o)}const a=(r==null?void 0:r.map(i=>i.event_id))||[];if(a.length>0){const i=yield ps.getAllUserInteractions(a,void 0,["event"]),o=yield ps.getAllInterestedUsers(a);for(const l of r){const c=(i==null?void 0:i.filter(p=>p.entity_id===l.event_id))||[],d=(o==null?void 0:o.filter(p=>p.jambase_event_id===l.event_id))||[],u=c.filter(p=>p.event_type==="view").length,f=c.filter(p=>p.event_type==="click").length,h=d.length;l.impressions=u,l.clicks=f,l.conversions=h}}return r||[]}catch(r){throw console.error("Error fetching user promotions:",r),r}})}static getPromotionMetrics(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select(`
          *,
          event:jambase_events!event_promotions_event_id_fkey(
            id,
            title,
            artist_name,
            venue_name,
            event_date
          )
        `).eq("id",t).single();if(n)throw n;if(!r)return null;const a=r.impressions>0?r.clicks/r.impressions*100:0,i=r.clicks>0?r.conversions/r.clicks*100:0,o=r.clicks>0?r.price_paid/r.clicks:0,l=r.conversions>0?r.price_paid/r.conversions:0,d=r.conversions*25,u=d>0?(d-r.price_paid)/r.price_paid*100:-100;return{promotion_id:r.id,event_title:r.event.title,tier:r.promotion_tier,impressions:r.impressions,clicks:r.clicks,conversions:r.conversions,ctr:Math.round(a*100)/100,conversion_rate:Math.round(i*100)/100,cost_per_click:Math.round(o*100)/100,cost_per_conversion:Math.round(l*100)/100,roi:Math.round(u*100)/100,revenue_attributed:Math.round(d*100)/100}}catch(r){throw console.error("Error fetching promotion metrics:",r),r}})}static getPromotionPerformanceComparison(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select(`
          *,
          event:jambase_events!event_promotions_event_id_fkey(
            id,
            title,
            artist_name,
            venue_name,
            event_date
          )
        `).eq("promoted_by_user_id",t).order("created_at",{ascending:!1});if(n)throw n;if(r&&r.length>0)for(const i of r)try{yield _l.syncPromotionMetrics(i.id)}catch(o){console.error(`Error syncing metrics for promotion ${i.id}:`,o)}const a=(r==null?void 0:r.map(i=>i.event_id))||[];if(a.length>0){const i=yield ps.getAllUserInteractions(a,void 0,["event"]),o=yield ps.getAllInterestedUsers(a);for(const l of r){const c=(i==null?void 0:i.filter(p=>p.entity_id===l.event_id))||[],d=(o==null?void 0:o.filter(p=>p.jambase_event_id===l.event_id))||[],u=c.filter(p=>p.event_type==="view").length,f=c.filter(p=>p.event_type==="click").length,h=d.length;l.impressions=u,l.clicks=f,l.conversions=h}}return r?r.map(i=>{const o=i.impressions>0?i.clicks/i.impressions*100:0,l=i.clicks>0?i.conversions/i.clicks*100:0,c=i.clicks>0?i.price_paid/i.clicks:0,d=i.conversions>0?i.price_paid/i.conversions:0,u=Math.ceil((new Date(i.expires_at).getTime()-new Date(i.starts_at).getTime())/(1e3*60*60*24)),h=i.conversions*25,p=h>0?(h-i.price_paid)/i.price_paid*100:-100;return{promotion_id:i.id,event_title:i.event.title,tier:i.promotion_tier,duration_days:u,total_spend:i.price_paid,impressions:i.impressions,clicks:i.clicks,conversions:i.conversions,ctr:Math.round(o*100)/100,conversion_rate:Math.round(l*100)/100,cost_per_click:Math.round(c*100)/100,cost_per_conversion:Math.round(d*100)/100,roi:Math.round(p*100)/100}}):[]}catch(r){throw console.error("Error fetching promotion comparison:",r),r}})}static getPromotionROI(t){return E(this,null,function*(){try{const r=yield this.getPromotionMetrics(t);if(!r)throw new Error("Promotion not found");const n=r.cost_per_conversion*r.conversions,a=r.revenue_attributed-n,i=Math.ceil(n/25);return{roi:r.roi,revenue_attributed:r.revenue_attributed,cost:n,profit:a,break_even_conversions:i}}catch(r){throw console.error("Error calculating promotion ROI:",r),r}})}static getPromotionTrends(t,r=30){return E(this,null,function*(){try{const n=new Date;n.setDate(n.getDate()-r);const{data:a,error:i}=yield T.from("event_promotions").select("event_id, price_paid, created_at").eq("promoted_by_user_id",t).gte("created_at",n.toISOString()).order("created_at",{ascending:!0});if(i)throw i;if(!a||a.length===0)return[];const o=a.map(u=>u.event_id),l=yield ps.getAllUserInteractions(o,void 0,["event"]),c=yield ps.getAllInterestedUsers(o),d=new Map;for(let u=0;u<r;u++){const f=new Date;f.setDate(f.getDate()-u);const h=f.toISOString().split("T")[0];d.set(h,{impressions:0,clicks:0,conversions:0,spend:0})}for(const u of a){const f=u.created_at.split("T")[0],h=(l==null?void 0:l.filter(w=>w.entity_id===u.event_id))||[],p=(c==null?void 0:c.filter(w=>w.jambase_event_id===u.event_id))||[],g=h.filter(w=>w.event_type==="view").length,v=h.filter(w=>w.event_type==="click").length,y=p.length,_=d.get(f)||{impressions:0,clicks:0,conversions:0,spend:0};d.set(f,{impressions:_.impressions+g,clicks:_.clicks+v,conversions:_.conversions+y,spend:_.spend+(u.price_paid||0)})}return Array.from(d.entries()).map(([u,f])=>M({date:u},f))}catch(n){throw console.error("Error fetching promotion trends:",n),n}})}static getActivePromotions(t=10){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select(`
          *,
          event:jambase_events!event_promotions_event_id_fkey(
            id,
            title,
            artist_name,
            venue_name,
            event_date,
            poster_image_url
          )
        `).eq("promotion_status","active").lte("starts_at",new Date().toISOString()).gte("expires_at",new Date().toISOString()).order("created_at",{ascending:!1}).limit(t);if(n)throw n;return r||[]}catch(r){throw console.error("Error fetching active promotions:",r),r}})}}function K7({userId:e,enabled:t=!0}){const[r,n]=x.useState(!1),[a,i]=x.useState(null);return x.useEffect(()=>{if(!t||!e)return;const o=T.channel("promotion_analytics").on("postgres_changes",{event:"*",schema:"public",table:"event_promotions",filter:`promoted_by_user_id=eq.${e}`},l=>{console.log("Promotion data changed:",l),i(new Date),n(!0),setTimeout(()=>n(!1),5e3)}).on("postgres_changes",{event:"*",schema:"public",table:"jambase_events",filter:"active_promotion_id=is.not.null"},l=>{console.log("Event promotion status changed:",l),i(new Date),n(!0),setTimeout(()=>n(!1),5e3)}).subscribe();return()=>{T.removeChannel(o)}},[e,t]),{isLive:r,lastUpdate:a}}var P0e=Array.isArray,_i=P0e,T0e=typeof na=="object"&&na&&na.Object===Object&&na,Z7=T0e,A0e=Z7,R0e=typeof self=="object"&&self&&self.Object===Object&&self,O0e=A0e||R0e||Function("return this")(),Ul=O0e,M0e=Ul,D0e=M0e.Symbol,px=D0e,S4=px,X7=Object.prototype,I0e=X7.hasOwnProperty,$0e=X7.toString,yg=S4?S4.toStringTag:void 0;function L0e(e){var t=I0e.call(e,yg),r=e[yg];try{e[yg]=void 0;var n=!0}catch(i){}var a=$0e.call(e);return n&&(t?e[yg]=r:delete e[yg]),a}var F0e=L0e,z0e=Object.prototype,B0e=z0e.toString;function U0e(e){return B0e.call(e)}var q0e=U0e,k4=px,V0e=F0e,W0e=q0e,H0e="[object Null]",G0e="[object Undefined]",E4=k4?k4.toStringTag:void 0;function Y0e(e){return e==null?e===void 0?G0e:H0e:E4&&E4 in Object(e)?V0e(e):W0e(e)}var Bc=Y0e;function K0e(e){return e!=null&&typeof e=="object"}var Uc=K0e,Z0e=Bc,X0e=Uc,J0e="[object Symbol]";function Q0e(e){return typeof e=="symbol"||X0e(e)&&Z0e(e)==J0e}var jp=Q0e,e_e=_i,t_e=jp,r_e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n_e=/^\w*$/;function s_e(e,t){if(e_e(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||t_e(e)?!0:n_e.test(e)||!r_e.test(e)||t!=null&&e in Object(t)}var oA=s_e;function a_e(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ru=a_e;const Np=yn(ru);var i_e=Bc,o_e=ru,l_e="[object AsyncFunction]",c_e="[object Function]",d_e="[object GeneratorFunction]",u_e="[object Proxy]";function h_e(e){if(!o_e(e))return!1;var t=i_e(e);return t==c_e||t==d_e||t==l_e||t==u_e}var lA=h_e;const Ir=yn(lA);var f_e=Ul,m_e=f_e["__core-js_shared__"],p_e=m_e,cS=p_e,C4=function(){var e=/[^.]+$/.exec(cS&&cS.keys&&cS.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function g_e(e){return!!C4&&C4 in e}var v_e=g_e,y_e=Function.prototype,x_e=y_e.toString;function __e(e){if(e!=null){try{return x_e.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var J7=__e,w_e=lA,b_e=v_e,j_e=ru,N_e=J7,S_e=/[\\^$.*+?()[\]{}|]/g,k_e=/^\[object .+?Constructor\]$/,E_e=Function.prototype,C_e=Object.prototype,P_e=E_e.toString,T_e=C_e.hasOwnProperty,A_e=RegExp("^"+P_e.call(T_e).replace(S_e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function R_e(e){if(!j_e(e)||b_e(e))return!1;var t=w_e(e)?A_e:k_e;return t.test(N_e(e))}var O_e=R_e;function M_e(e,t){return e==null?void 0:e[t]}var D_e=M_e,I_e=O_e,$_e=D_e;function L_e(e,t){var r=$_e(e,t);return I_e(r)?r:void 0}var Th=L_e,F_e=Th,z_e=F_e(Object,"create"),q1=z_e,P4=q1;function B_e(){this.__data__=P4?P4(null):{},this.size=0}var U_e=B_e;function q_e(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var V_e=q_e,W_e=q1,H_e="__lodash_hash_undefined__",G_e=Object.prototype,Y_e=G_e.hasOwnProperty;function K_e(e){var t=this.__data__;if(W_e){var r=t[e];return r===H_e?void 0:r}return Y_e.call(t,e)?t[e]:void 0}var Z_e=K_e,X_e=q1,J_e=Object.prototype,Q_e=J_e.hasOwnProperty;function ewe(e){var t=this.__data__;return X_e?t[e]!==void 0:Q_e.call(t,e)}var twe=ewe,rwe=q1,nwe="__lodash_hash_undefined__";function swe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=rwe&&t===void 0?nwe:t,this}var awe=swe,iwe=U_e,owe=V_e,lwe=Z_e,cwe=twe,dwe=awe;function Sp(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Sp.prototype.clear=iwe;Sp.prototype.delete=owe;Sp.prototype.get=lwe;Sp.prototype.has=cwe;Sp.prototype.set=dwe;var uwe=Sp;function hwe(){this.__data__=[],this.size=0}var fwe=hwe;function mwe(e,t){return e===t||e!==e&&t!==t}var cA=mwe,pwe=cA;function gwe(e,t){for(var r=e.length;r--;)if(pwe(e[r][0],t))return r;return-1}var V1=gwe,vwe=V1,ywe=Array.prototype,xwe=ywe.splice;function _we(e){var t=this.__data__,r=vwe(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():xwe.call(t,r,1),--this.size,!0}var wwe=_we,bwe=V1;function jwe(e){var t=this.__data__,r=bwe(t,e);return r<0?void 0:t[r][1]}var Nwe=jwe,Swe=V1;function kwe(e){return Swe(this.__data__,e)>-1}var Ewe=kwe,Cwe=V1;function Pwe(e,t){var r=this.__data__,n=Cwe(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var Twe=Pwe,Awe=fwe,Rwe=wwe,Owe=Nwe,Mwe=Ewe,Dwe=Twe;function kp(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}kp.prototype.clear=Awe;kp.prototype.delete=Rwe;kp.prototype.get=Owe;kp.prototype.has=Mwe;kp.prototype.set=Dwe;var W1=kp,Iwe=Th,$we=Ul,Lwe=Iwe($we,"Map"),dA=Lwe,T4=uwe,Fwe=W1,zwe=dA;function Bwe(){this.size=0,this.__data__={hash:new T4,map:new(zwe||Fwe),string:new T4}}var Uwe=Bwe;function qwe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Vwe=qwe,Wwe=Vwe;function Hwe(e,t){var r=e.__data__;return Wwe(t)?r[typeof t=="string"?"string":"hash"]:r.map}var H1=Hwe,Gwe=H1;function Ywe(e){var t=Gwe(this,e).delete(e);return this.size-=t?1:0,t}var Kwe=Ywe,Zwe=H1;function Xwe(e){return Zwe(this,e).get(e)}var Jwe=Xwe,Qwe=H1;function ebe(e){return Qwe(this,e).has(e)}var tbe=ebe,rbe=H1;function nbe(e,t){var r=rbe(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var sbe=nbe,abe=Uwe,ibe=Kwe,obe=Jwe,lbe=tbe,cbe=sbe;function Ep(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ep.prototype.clear=abe;Ep.prototype.delete=ibe;Ep.prototype.get=obe;Ep.prototype.has=lbe;Ep.prototype.set=cbe;var uA=Ep,Q7=uA,dbe="Expected a function";function hA(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(dbe);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(hA.Cache||Q7),r}hA.Cache=Q7;var eW=hA;const ube=yn(eW);var hbe=eW,fbe=500;function mbe(e){var t=hbe(e,function(n){return r.size===fbe&&r.clear(),n}),r=t.cache;return t}var pbe=mbe,gbe=pbe,vbe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ybe=/\\(\\)?/g,xbe=gbe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(vbe,function(r,n,a,i){t.push(a?i.replace(ybe,"$1"):n||r)}),t}),_be=xbe;function wbe(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var fA=wbe,A4=px,bbe=fA,jbe=_i,Nbe=jp,Sbe=1/0,R4=A4?A4.prototype:void 0,O4=R4?R4.toString:void 0;function tW(e){if(typeof e=="string")return e;if(jbe(e))return bbe(e,tW)+"";if(Nbe(e))return O4?O4.call(e):"";var t=e+"";return t=="0"&&1/e==-Sbe?"-0":t}var kbe=tW,Ebe=kbe;function Cbe(e){return e==null?"":Ebe(e)}var rW=Cbe,Pbe=_i,Tbe=oA,Abe=_be,Rbe=rW;function Obe(e,t){return Pbe(e)?e:Tbe(e,t)?[e]:Abe(Rbe(e))}var nW=Obe,Mbe=jp,Dbe=1/0;function Ibe(e){if(typeof e=="string"||Mbe(e))return e;var t=e+"";return t=="0"&&1/e==-Dbe?"-0":t}var G1=Ibe,$be=nW,Lbe=G1;function Fbe(e,t){t=$be(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[Lbe(t[r++])];return r&&r==n?e:void 0}var mA=Fbe,zbe=mA;function Bbe(e,t,r){var n=e==null?void 0:zbe(e,t);return n===void 0?r:n}var sW=Bbe;const io=yn(sW);function Ube(e){return e==null}var qbe=Ube;const Yr=yn(qbe);var Vbe=Bc,Wbe=_i,Hbe=Uc,Gbe="[object String]";function Ybe(e){return typeof e=="string"||!Wbe(e)&&Hbe(e)&&Vbe(e)==Gbe}var Kbe=Ybe;const mh=yn(Kbe);var aW={exports:{}},An={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pA=Symbol.for("react.element"),gA=Symbol.for("react.portal"),Y1=Symbol.for("react.fragment"),K1=Symbol.for("react.strict_mode"),Z1=Symbol.for("react.profiler"),X1=Symbol.for("react.provider"),J1=Symbol.for("react.context"),Zbe=Symbol.for("react.server_context"),Q1=Symbol.for("react.forward_ref"),ej=Symbol.for("react.suspense"),tj=Symbol.for("react.suspense_list"),rj=Symbol.for("react.memo"),nj=Symbol.for("react.lazy"),Xbe=Symbol.for("react.offscreen"),iW;iW=Symbol.for("react.module.reference");function mo(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case pA:switch(e=e.type,e){case Y1:case Z1:case K1:case ej:case tj:return e;default:switch(e=e&&e.$$typeof,e){case Zbe:case J1:case Q1:case nj:case rj:case X1:return e;default:return t}}case gA:return t}}}An.ContextConsumer=J1;An.ContextProvider=X1;An.Element=pA;An.ForwardRef=Q1;An.Fragment=Y1;An.Lazy=nj;An.Memo=rj;An.Portal=gA;An.Profiler=Z1;An.StrictMode=K1;An.Suspense=ej;An.SuspenseList=tj;An.isAsyncMode=function(){return!1};An.isConcurrentMode=function(){return!1};An.isContextConsumer=function(e){return mo(e)===J1};An.isContextProvider=function(e){return mo(e)===X1};An.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===pA};An.isForwardRef=function(e){return mo(e)===Q1};An.isFragment=function(e){return mo(e)===Y1};An.isLazy=function(e){return mo(e)===nj};An.isMemo=function(e){return mo(e)===rj};An.isPortal=function(e){return mo(e)===gA};An.isProfiler=function(e){return mo(e)===Z1};An.isStrictMode=function(e){return mo(e)===K1};An.isSuspense=function(e){return mo(e)===ej};An.isSuspenseList=function(e){return mo(e)===tj};An.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Y1||e===Z1||e===K1||e===ej||e===tj||e===Xbe||typeof e=="object"&&e!==null&&(e.$$typeof===nj||e.$$typeof===rj||e.$$typeof===X1||e.$$typeof===J1||e.$$typeof===Q1||e.$$typeof===iW||e.getModuleId!==void 0)};An.typeOf=mo;aW.exports=An;var Jbe=aW.exports,Qbe=Bc,e1e=Uc,t1e="[object Number]";function r1e(e){return typeof e=="number"||e1e(e)&&Qbe(e)==t1e}var oW=r1e;const n1e=yn(oW);var s1e=oW;function a1e(e){return s1e(e)&&e!=+e}var i1e=a1e;const Cp=yn(i1e);var Lo=function(t){return t===0?0:t>0?1:-1},Mu=function(t){return mh(t)&&t.indexOf("%")===t.length-1},Nt=function(t){return n1e(t)&&!Cp(t)},o1e=function(t){return Yr(t)},Ws=function(t){return Nt(t)||mh(t)},l1e=0,Pp=function(t){var r=++l1e;return"".concat(t||"").concat(r)},ph=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Nt(t)&&!mh(t))return n;var i;if(Mu(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return Cp(i)&&(i=n),a&&i>r&&(i=r),i},ud=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},c1e=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},ha=function(t,r){return Nt(t)&&Nt(r)?function(n){return t+n*(r-t)}:function(){return r}};function vw(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):io(n,t))===r})}var d1e=function(t,r){return Nt(t)&&Nt(r)?t-r:mh(t)&&mh(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function Xf(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function F2(e){"@babel/helpers - typeof";return F2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F2(e)}var u1e=["viewBox","children"],h1e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],M4=["points","pathLength"],dS={svg:u1e,polygon:M4,polyline:M4},vA=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],yw=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(x.isValidElement(t)&&(n=t.props),!Np(n))return null;var a={};return Object.keys(n).forEach(function(i){vA.includes(i)&&(a[i]=r||function(o){return n[i](n,o)})}),a},f1e=function(t,r,n){return function(a){return t(r,n,a),null}},xw=function(t,r,n){if(!Np(t)||F2(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var o=t[i];vA.includes(i)&&typeof o=="function"&&(a||(a={}),a[i]=f1e(o,r,n))}),a},m1e=["children"],p1e=["children"];function D4(e,t){if(e==null)return{};var r=g1e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function g1e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function z2(e){"@babel/helpers - typeof";return z2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z2(e)}var I4={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},wc=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},$4=null,uS=null,yA=function e(t){if(t===$4&&Array.isArray(uS))return uS;var r=[];return x.Children.forEach(t,function(n){Yr(n)||(Jbe.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),uS=r,$4=t,r};function oo(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return wc(a)}):n=[wc(t)],yA(e).forEach(function(a){var i=io(a,"type.displayName")||io(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function Ci(e,t){var r=oo(e,t);return r&&r[0]}var L4=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!Nt(n)||n<=0||!Nt(a)||a<=0)},v1e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],y1e=function(t){return t&&t.type&&mh(t.type)&&v1e.indexOf(t.type)>=0},lW=function(t){return t&&z2(t)==="object"&&"clipDot"in t},x1e=function(t,r,n,a){var i,o=(i=dS==null?void 0:dS[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!Ir(t)&&(a&&o.includes(r)||h1e.includes(r))||n&&vA.includes(r)},Fr=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(x.isValidElement(t)&&(a=t.props),!Np(a))return null;var i={};return Object.keys(a).forEach(function(o){var l;x1e((l=a)===null||l===void 0?void 0:l[o],o,r,n)&&(i[o]=a[o])}),i},B2=function e(t,r){if(t===r)return!0;var n=x.Children.count(t);if(n!==x.Children.count(r))return!1;if(n===0)return!0;if(n===1)return F4(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!F4(i,o))return!1}return!0},F4=function(t,r){if(Yr(t)&&Yr(r))return!0;if(!Yr(t)&&!Yr(r)){var n=t.props||{},a=n.children,i=D4(n,m1e),o=r.props||{},l=o.children,c=D4(o,p1e);return a&&l?Xf(i,c)&&B2(a,l):!a&&!l?Xf(i,c):!1}return!1},z4=function(t,r){var n=[],a={};return yA(t).forEach(function(i,o){if(y1e(i))n.push(i);else if(i){var l=wc(i.type),c=r[l]||{},d=c.handler,u=c.once;if(d&&(!u||!a[l])){var f=d(i,l,o);n.push(f),a[l]=!0}}}),n},_1e=function(t){var r=t&&t.type;return r&&I4[r]?I4[r]:null},w1e=function(t,r){return yA(r).indexOf(t)},b1e=["children","width","height","viewBox","className","style","title","desc"];function U2(){return U2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U2.apply(this,arguments)}function j1e(e,t){if(e==null)return{};var r=N1e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function N1e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function q2(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,o=e.style,l=e.title,c=e.desc,d=j1e(e,b1e),u=a||{width:r,height:n,x:0,y:0},f=an("recharts-surface",i);return J.createElement("svg",U2({},Fr(d,!0,"svg"),{className:f,width:r,height:n,style:o,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),J.createElement("title",null,l),J.createElement("desc",null,c),t)}var S1e=["children","className"];function V2(){return V2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},V2.apply(this,arguments)}function k1e(e,t){if(e==null)return{};var r=E1e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function E1e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var qn=J.forwardRef(function(e,t){var r=e.children,n=e.className,a=k1e(e,S1e),i=an("recharts-layer",n);return J.createElement("g",V2({className:i},Fr(a,!0),{ref:t}),r)}),bc=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function C1e(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var P1e=C1e,T1e=P1e;function A1e(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:T1e(e,t,r)}var R1e=A1e,O1e="\\ud800-\\udfff",M1e="\\u0300-\\u036f",D1e="\\ufe20-\\ufe2f",I1e="\\u20d0-\\u20ff",$1e=M1e+D1e+I1e,L1e="\\ufe0e\\ufe0f",F1e="\\u200d",z1e=RegExp("["+F1e+O1e+$1e+L1e+"]");function B1e(e){return z1e.test(e)}var cW=B1e;function U1e(e){return e.split("")}var q1e=U1e,dW="\\ud800-\\udfff",V1e="\\u0300-\\u036f",W1e="\\ufe20-\\ufe2f",H1e="\\u20d0-\\u20ff",G1e=V1e+W1e+H1e,Y1e="\\ufe0e\\ufe0f",K1e="["+dW+"]",W2="["+G1e+"]",H2="\\ud83c[\\udffb-\\udfff]",Z1e="(?:"+W2+"|"+H2+")",uW="[^"+dW+"]",hW="(?:\\ud83c[\\udde6-\\uddff]){2}",fW="[\\ud800-\\udbff][\\udc00-\\udfff]",X1e="\\u200d",mW=Z1e+"?",pW="["+Y1e+"]?",J1e="(?:"+X1e+"(?:"+[uW,hW,fW].join("|")+")"+pW+mW+")*",Q1e=pW+mW+J1e,eje="(?:"+[uW+W2+"?",W2,hW,fW,K1e].join("|")+")",tje=RegExp(H2+"(?="+H2+")|"+eje+Q1e,"g");function rje(e){return e.match(tje)||[]}var nje=rje,sje=q1e,aje=cW,ije=nje;function oje(e){return aje(e)?ije(e):sje(e)}var lje=oje,cje=R1e,dje=cW,uje=lje,hje=rW;function fje(e){return function(t){t=hje(t);var r=dje(t)?uje(t):void 0,n=r?r[0]:t.charAt(0),a=r?cje(r,1).join(""):t.slice(1);return n[e]()+a}}var mje=fje,pje=mje,gje=pje("toUpperCase"),vje=gje;const sj=yn(vje);function zn(e){return function(){return e}}const gW=Math.cos,_w=Math.sin,el=Math.sqrt,ww=Math.PI,aj=2*ww,G2=Math.PI,Y2=2*G2,yu=1e-6,yje=Y2-yu;function vW(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function xje(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return vW;const r=Gp(10,t);return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class _je{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?vW:xje(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=n-t,d=a-r,u=o-t,f=l-r,h=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>yu)if(!(Math.abs(f*c-d*u)>yu)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-o,g=a-l,v=c*c+d*d,y=p*p+g*g,_=Math.sqrt(v),w=Math.sqrt(h),b=i*Math.tan((G2-Math.acos((v+h-y)/(2*_*w)))/2),N=b/w,S=b/_;Math.abs(N-1)>yu&&this._append`L${t+N*u},${r+N*f}`,this._append`A${i},${i},0,0,${+(f*p>u*g)},${this._x1=t+S*c},${this._y1=r+S*d}`}}arc(t,r,n,a,i,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),d=t+l,u=r+c,f=1^o,h=o?a-i:i-a;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>yu||Math.abs(this._y1-u)>yu)&&this._append`L${d},${u}`,n&&(h<0&&(h=h%Y2+Y2),h>yje?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=d},${this._y1=u}`:h>yu&&this._append`A${n},${n},0,${+(h>=G2)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function xA(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new _je(t)}function _A(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function yW(e){this._context=e}yW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function ij(e){return new yW(e)}function xW(e){return e[0]}function _W(e){return e[1]}function wW(e,t){var r=zn(!0),n=null,a=ij,i=null,o=xA(l);e=typeof e=="function"?e:e===void 0?xW:zn(e),t=typeof t=="function"?t:t===void 0?_W:zn(t);function l(c){var d,u=(c=_A(c)).length,f,h=!1,p;for(n==null&&(i=a(p=o())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(f,d,c),+t(f,d,c));if(p)return i=null,p+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:zn(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:zn(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:zn(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function E0(e,t,r){var n=null,a=zn(!0),i=null,o=ij,l=null,c=xA(d);e=typeof e=="function"?e:e===void 0?xW:zn(+e),t=typeof t=="function"?t:zn(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?_W:zn(+r);function d(f){var h,p,g,v=(f=_A(f)).length,y,_=!1,w,b=new Array(v),N=new Array(v);for(i==null&&(l=o(w=c())),h=0;h<=v;++h){if(!(h<v&&a(y=f[h],h,f))===_)if(_=!_)p=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),g=h-1;g>=p;--g)l.point(b[g],N[g]);l.lineEnd(),l.areaEnd()}_&&(b[h]=+e(y,h,f),N[h]=+t(y,h,f),l.point(n?+n(y,h,f):b[h],r?+r(y,h,f):N[h]))}if(w)return l=null,w+""||null}function u(){return wW().defined(a).curve(o).context(i)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:zn(+f),n=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:zn(+f),d):e},d.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:zn(+f),d):n},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:zn(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:zn(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:zn(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(n).y(t)},d.defined=function(f){return arguments.length?(a=typeof f=="function"?f:zn(!!f),d):a},d.curve=function(f){return arguments.length?(o=f,i!=null&&(l=o(i)),d):o},d.context=function(f){return arguments.length?(f==null?i=l=null:l=o(i=f),d):i},d}class bW{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function wje(e){return new bW(e,!0)}function bje(e){return new bW(e,!1)}const wA={draw(e,t){const r=el(t/ww);e.moveTo(r,0),e.arc(0,0,r,0,aj)}},jje={draw(e,t){const r=el(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},jW=el(1/3),Nje=jW*2,Sje={draw(e,t){const r=el(t/Nje),n=r*jW;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},kje={draw(e,t){const r=el(t),n=-r/2;e.rect(n,n,r,r)}},Eje=.8908130915292852,NW=_w(ww/10)/_w(7*ww/10),Cje=_w(aj/10)*NW,Pje=-gW(aj/10)*NW,Tje={draw(e,t){const r=el(t*Eje),n=Cje*r,a=Pje*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const o=aj*i/5,l=gW(o),c=_w(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},hS=el(3),Aje={draw(e,t){const r=-el(t/(hS*3));e.moveTo(0,r*2),e.lineTo(-hS*r,-r),e.lineTo(hS*r,-r),e.closePath()}},zi=-.5,Bi=el(3)/2,K2=1/el(12),Rje=(K2/2+1)*3,Oje={draw(e,t){const r=el(t/Rje),n=r/2,a=r*K2,i=n,o=r*K2+r,l=-i,c=o;e.moveTo(n,a),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(zi*n-Bi*a,Bi*n+zi*a),e.lineTo(zi*i-Bi*o,Bi*i+zi*o),e.lineTo(zi*l-Bi*c,Bi*l+zi*c),e.lineTo(zi*n+Bi*a,zi*a-Bi*n),e.lineTo(zi*i+Bi*o,zi*o-Bi*i),e.lineTo(zi*l+Bi*c,zi*c-Bi*l),e.closePath()}};function Mje(e,t){let r=null,n=xA(a);e=typeof e=="function"?e:zn(e||wA),t=typeof t=="function"?t:zn(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:zn(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:zn(+i),a):t},a.context=function(i){return arguments.length?(r=i==null?null:i,a):r},a}function bw(){}function jw(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function SW(e){this._context=e}SW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:jw(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:jw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Dje(e){return new SW(e)}function kW(e){this._context=e}kW.prototype={areaStart:bw,areaEnd:bw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:jw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Ije(e){return new kW(e)}function EW(e){this._context=e}EW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:jw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function $je(e){return new EW(e)}function CW(e){this._context=e}CW.prototype={areaStart:bw,areaEnd:bw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Lje(e){return new CW(e)}function B4(e){return e<0?-1:1}function U4(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),l=(i*a+o*n)/(n+a);return(B4(i)+B4(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function q4(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function fS(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,o-l*r,i,o)}function Nw(e){this._context=e}Nw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:fS(this,this._t0,q4(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,fS(this,q4(this,r=U4(this,e,t)),r);break;default:fS(this,this._t0,r=U4(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function PW(e){this._context=new TW(e)}(PW.prototype=Object.create(Nw.prototype)).point=function(e,t){Nw.prototype.point.call(this,t,e)};function TW(e){this._context=e}TW.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function Fje(e){return new Nw(e)}function zje(e){return new PW(e)}function AW(e){this._context=e}AW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=V4(e),a=V4(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function V4(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function Bje(e){return new AW(e)}function oj(e,t){this._context=e,this._t=t}oj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function Uje(e){return new oj(e,.5)}function qje(e){return new oj(e,0)}function Vje(e){return new oj(e,1)}function Am(e,t){if((o=e.length)>1)for(var r=1,n,a,i=e[t[0]],o,l=i.length;r<o;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Z2(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Wje(e,t){return e[t]}function Hje(e){const t=[];return t.key=e,t}function Gje(){var e=zn([]),t=Z2,r=Am,n=Wje;function a(i){var o=Array.from(e.apply(this,arguments),Hje),l,c=o.length,d=-1,u;for(const f of i)for(l=0,++d;l<c;++l)(o[l][d]=[0,+n(f,o[l].key,d,i)]).data=f;for(l=0,u=_A(t(o));l<c;++l)o[u[l]].index=l;return r(o,u),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:zn(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:zn(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Z2:typeof i=="function"?i:zn(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i==null?Am:i,a):r},a}function Yje(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}Am(e,t)}}function Kje(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var o=0,l=0;o<a;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}Am(e,t)}}function Zje(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var l=0,c=0,d=0;l<o;++l){for(var u=e[t[l]],f=u[n][1]||0,h=u[n-1][1]||0,p=(f-h)/2,g=0;g<l;++g){var v=e[t[g]],y=v[n][1]||0,_=v[n-1][1]||0;p+=y-_}c+=f,d+=p*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=d/c)}a[n-1][1]+=a[n-1][0]=r,Am(e,t)}}function Hv(e){"@babel/helpers - typeof";return Hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hv(e)}var Xje=["type","size","sizeType"];function X2(){return X2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},X2.apply(this,arguments)}function W4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function H4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W4(Object(r),!0).forEach(function(n){Jje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jje(e,t,r){return t=Qje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qje(e){var t=eNe(e,"string");return Hv(t)=="symbol"?t:t+""}function eNe(e,t){if(Hv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tNe(e,t){if(e==null)return{};var r=rNe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var RW={symbolCircle:wA,symbolCross:jje,symbolDiamond:Sje,symbolSquare:kje,symbolStar:Tje,symbolTriangle:Aje,symbolWye:Oje},nNe=Math.PI/180,sNe=function(t){var r="symbol".concat(sj(t));return RW[r]||wA},aNe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*nNe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},iNe=function(t,r){RW["symbol".concat(sj(t))]=r},bA=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,o=t.sizeType,l=o===void 0?"area":o,c=tNe(t,Xje),d=H4(H4({},c),{},{type:n,size:i,sizeType:l}),u=function(){var y=sNe(n),_=Mje().type(y).size(aNe(i,l,n));return _()},f=d.className,h=d.cx,p=d.cy,g=Fr(d,!0);return h===+h&&p===+p&&i===+i?J.createElement("path",X2({},g,{className:an("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(p,")"),d:u()})):null};bA.registerSymbol=iNe;function Rm(e){"@babel/helpers - typeof";return Rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rm(e)}function J2(){return J2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},J2.apply(this,arguments)}function G4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oNe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G4(Object(r),!0).forEach(function(n){Gv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cNe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MW(n.key),n)}}function dNe(e,t,r){return t&&cNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function uNe(e,t,r){return t=Sw(t),hNe(e,OW()?Reflect.construct(t,r||[],Sw(e).constructor):t.apply(e,r))}function hNe(e,t){if(t&&(Rm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fNe(e)}function fNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(OW=function(){return!!e})()}function Sw(e){return Sw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sw(e)}function mNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q2(e,t)}function Q2(e,t){return Q2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Q2(e,t)}function Gv(e,t,r){return t=MW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MW(e){var t=pNe(e,"string");return Rm(t)=="symbol"?t:t+""}function pNe(e,t){if(Rm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ui=32,jA=function(e){function t(){return lNe(this,t),uNe(this,t,arguments)}return mNe(t,e),dNe(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=Ui/2,o=Ui/6,l=Ui/3,c=n.inactive?a:n.color;if(n.type==="plainline")return J.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:Ui,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return J.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(Ui,"M").concat(2*l,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return J.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Ui/8,"h").concat(Ui,"v").concat(Ui*3/4,"h").concat(-Ui,"z"),className:"recharts-legend-icon"});if(J.isValidElement(n.legendIcon)){var d=oNe({},n);return delete d.legendIcon,J.cloneElement(n.legendIcon,d)}return J.createElement(bA,{fill:c,cx:i,cy:i,size:Ui,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,o=a.iconSize,l=a.layout,c=a.formatter,d=a.inactiveColor,u={x:0,y:0,width:Ui,height:Ui},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(p,g){var v=p.formatter||c,y=an(Gv(Gv({"recharts-legend-item":!0},"legend-item-".concat(g),!0),"inactive",p.inactive));if(p.type==="none")return null;var _=Ir(p.value)?null:p.value;bc(!Ir(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var w=p.inactive?d:p.color;return J.createElement("li",J2({className:y,style:f,key:"legend-item-".concat(g)},xw(n.props,p,g)),J.createElement(q2,{width:o,height:o,viewBox:u,style:h},n.renderIcon(p)),J.createElement("span",{className:"recharts-legend-item-text",style:{color:w}},v?v(_,p,g):_))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,o=n.align;if(!a||!a.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return J.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(x.PureComponent);Gv(jA,"displayName","Legend");Gv(jA,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var gNe=W1;function vNe(){this.__data__=new gNe,this.size=0}var yNe=vNe;function xNe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var _Ne=xNe;function wNe(e){return this.__data__.get(e)}var bNe=wNe;function jNe(e){return this.__data__.has(e)}var NNe=jNe,SNe=W1,kNe=dA,ENe=uA,CNe=200;function PNe(e,t){var r=this.__data__;if(r instanceof SNe){var n=r.__data__;if(!kNe||n.length<CNe-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ENe(n)}return r.set(e,t),this.size=r.size,this}var TNe=PNe,ANe=W1,RNe=yNe,ONe=_Ne,MNe=bNe,DNe=NNe,INe=TNe;function Tp(e){var t=this.__data__=new ANe(e);this.size=t.size}Tp.prototype.clear=RNe;Tp.prototype.delete=ONe;Tp.prototype.get=MNe;Tp.prototype.has=DNe;Tp.prototype.set=INe;var DW=Tp,$Ne="__lodash_hash_undefined__";function LNe(e){return this.__data__.set(e,$Ne),this}var FNe=LNe;function zNe(e){return this.__data__.has(e)}var BNe=zNe,UNe=uA,qNe=FNe,VNe=BNe;function kw(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new UNe;++t<r;)this.add(e[t])}kw.prototype.add=kw.prototype.push=qNe;kw.prototype.has=VNe;var IW=kw;function WNe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var $W=WNe;function HNe(e,t){return e.has(t)}var LW=HNe,GNe=IW,YNe=$W,KNe=LW,ZNe=1,XNe=2;function JNe(e,t,r,n,a,i){var o=r&ZNe,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var d=i.get(e),u=i.get(t);if(d&&u)return d==t&&u==e;var f=-1,h=!0,p=r&XNe?new GNe:void 0;for(i.set(e,t),i.set(t,e);++f<l;){var g=e[f],v=t[f];if(n)var y=o?n(v,g,f,t,e,i):n(g,v,f,e,t,i);if(y!==void 0){if(y)continue;h=!1;break}if(p){if(!YNe(t,function(_,w){if(!KNe(p,w)&&(g===_||a(g,_,r,n,i)))return p.push(w)})){h=!1;break}}else if(!(g===v||a(g,v,r,n,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var FW=JNe,QNe=Ul,eSe=QNe.Uint8Array,tSe=eSe;function rSe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var nSe=rSe;function sSe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var NA=sSe,Y4=px,K4=tSe,aSe=cA,iSe=FW,oSe=nSe,lSe=NA,cSe=1,dSe=2,uSe="[object Boolean]",hSe="[object Date]",fSe="[object Error]",mSe="[object Map]",pSe="[object Number]",gSe="[object RegExp]",vSe="[object Set]",ySe="[object String]",xSe="[object Symbol]",_Se="[object ArrayBuffer]",wSe="[object DataView]",Z4=Y4?Y4.prototype:void 0,mS=Z4?Z4.valueOf:void 0;function bSe(e,t,r,n,a,i,o){switch(r){case wSe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _Se:return!(e.byteLength!=t.byteLength||!i(new K4(e),new K4(t)));case uSe:case hSe:case pSe:return aSe(+e,+t);case fSe:return e.name==t.name&&e.message==t.message;case gSe:case ySe:return e==t+"";case mSe:var l=oSe;case vSe:var c=n&cSe;if(l||(l=lSe),e.size!=t.size&&!c)return!1;var d=o.get(e);if(d)return d==t;n|=dSe,o.set(e,t);var u=iSe(l(e),l(t),n,a,i,o);return o.delete(e),u;case xSe:if(mS)return mS.call(e)==mS.call(t)}return!1}var jSe=bSe;function NSe(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var zW=NSe,SSe=zW,kSe=_i;function ESe(e,t,r){var n=t(e);return kSe(e)?n:SSe(n,r(e))}var CSe=ESe;function PSe(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}var TSe=PSe;function ASe(){return[]}var RSe=ASe,OSe=TSe,MSe=RSe,DSe=Object.prototype,ISe=DSe.propertyIsEnumerable,X4=Object.getOwnPropertySymbols,$Se=X4?function(e){return e==null?[]:(e=Object(e),OSe(X4(e),function(t){return ISe.call(e,t)}))}:MSe,LSe=$Se;function FSe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var zSe=FSe,BSe=Bc,USe=Uc,qSe="[object Arguments]";function VSe(e){return USe(e)&&BSe(e)==qSe}var WSe=VSe,J4=WSe,HSe=Uc,BW=Object.prototype,GSe=BW.hasOwnProperty,YSe=BW.propertyIsEnumerable,KSe=J4(function(){return arguments}())?J4:function(e){return HSe(e)&&GSe.call(e,"callee")&&!YSe.call(e,"callee")},SA=KSe,Ew={exports:{}};function ZSe(){return!1}var XSe=ZSe;Ew.exports;(function(e,t){var r=Ul,n=XSe,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===a,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d})(Ew,Ew.exports);var UW=Ew.exports,JSe=9007199254740991,QSe=/^(?:0|[1-9]\d*)$/;function eke(e,t){var r=typeof e;return t=t==null?JSe:t,!!t&&(r=="number"||r!="symbol"&&QSe.test(e))&&e>-1&&e%1==0&&e<t}var kA=eke,tke=9007199254740991;function rke(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=tke}var EA=rke,nke=Bc,ske=EA,ake=Uc,ike="[object Arguments]",oke="[object Array]",lke="[object Boolean]",cke="[object Date]",dke="[object Error]",uke="[object Function]",hke="[object Map]",fke="[object Number]",mke="[object Object]",pke="[object RegExp]",gke="[object Set]",vke="[object String]",yke="[object WeakMap]",xke="[object ArrayBuffer]",_ke="[object DataView]",wke="[object Float32Array]",bke="[object Float64Array]",jke="[object Int8Array]",Nke="[object Int16Array]",Ske="[object Int32Array]",kke="[object Uint8Array]",Eke="[object Uint8ClampedArray]",Cke="[object Uint16Array]",Pke="[object Uint32Array]",Zn={};Zn[wke]=Zn[bke]=Zn[jke]=Zn[Nke]=Zn[Ske]=Zn[kke]=Zn[Eke]=Zn[Cke]=Zn[Pke]=!0;Zn[ike]=Zn[oke]=Zn[xke]=Zn[lke]=Zn[_ke]=Zn[cke]=Zn[dke]=Zn[uke]=Zn[hke]=Zn[fke]=Zn[mke]=Zn[pke]=Zn[gke]=Zn[vke]=Zn[yke]=!1;function Tke(e){return ake(e)&&ske(e.length)&&!!Zn[nke(e)]}var Ake=Tke;function Rke(e){return function(t){return e(t)}}var qW=Rke,Cw={exports:{}};Cw.exports;(function(e,t){var r=Z7,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,o=i&&r.process,l=function(){try{var c=a&&a.require&&a.require("util").types;return c||o&&o.binding&&o.binding("util")}catch(d){}}();e.exports=l})(Cw,Cw.exports);var Oke=Cw.exports,Mke=Ake,Dke=qW,Q4=Oke,e3=Q4&&Q4.isTypedArray,Ike=e3?Dke(e3):Mke,VW=Ike,$ke=zSe,Lke=SA,Fke=_i,zke=UW,Bke=kA,Uke=VW,qke=Object.prototype,Vke=qke.hasOwnProperty;function Wke(e,t){var r=Fke(e),n=!r&&Lke(e),a=!r&&!n&&zke(e),i=!r&&!n&&!a&&Uke(e),o=r||n||a||i,l=o?$ke(e.length,String):[],c=l.length;for(var d in e)(t||Vke.call(e,d))&&!(o&&(d=="length"||a&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||Bke(d,c)))&&l.push(d);return l}var Hke=Wke,Gke=Object.prototype;function Yke(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Gke;return e===r}var Kke=Yke;function Zke(e,t){return function(r){return e(t(r))}}var WW=Zke,Xke=WW,Jke=Xke(Object.keys,Object),Qke=Jke,e2e=Kke,t2e=Qke,r2e=Object.prototype,n2e=r2e.hasOwnProperty;function s2e(e){if(!e2e(e))return t2e(e);var t=[];for(var r in Object(e))n2e.call(e,r)&&r!="constructor"&&t.push(r);return t}var a2e=s2e,i2e=lA,o2e=EA;function l2e(e){return e!=null&&o2e(e.length)&&!i2e(e)}var gx=l2e,c2e=Hke,d2e=a2e,u2e=gx;function h2e(e){return u2e(e)?c2e(e):d2e(e)}var lj=h2e,f2e=CSe,m2e=LSe,p2e=lj;function g2e(e){return f2e(e,p2e,m2e)}var v2e=g2e,t3=v2e,y2e=1,x2e=Object.prototype,_2e=x2e.hasOwnProperty;function w2e(e,t,r,n,a,i){var o=r&y2e,l=t3(e),c=l.length,d=t3(t),u=d.length;if(c!=u&&!o)return!1;for(var f=c;f--;){var h=l[f];if(!(o?h in t:_2e.call(t,h)))return!1}var p=i.get(e),g=i.get(t);if(p&&g)return p==t&&g==e;var v=!0;i.set(e,t),i.set(t,e);for(var y=o;++f<c;){h=l[f];var _=e[h],w=t[h];if(n)var b=o?n(w,_,h,t,e,i):n(_,w,h,e,t,i);if(!(b===void 0?_===w||a(_,w,r,n,i):b)){v=!1;break}y||(y=h=="constructor")}if(v&&!y){var N=e.constructor,S=t.constructor;N!=S&&"constructor"in e&&"constructor"in t&&!(typeof N=="function"&&N instanceof N&&typeof S=="function"&&S instanceof S)&&(v=!1)}return i.delete(e),i.delete(t),v}var b2e=w2e,j2e=Th,N2e=Ul,S2e=j2e(N2e,"DataView"),k2e=S2e,E2e=Th,C2e=Ul,P2e=E2e(C2e,"Promise"),T2e=P2e,A2e=Th,R2e=Ul,O2e=A2e(R2e,"Set"),HW=O2e,M2e=Th,D2e=Ul,I2e=M2e(D2e,"WeakMap"),$2e=I2e,eE=k2e,tE=dA,rE=T2e,nE=HW,sE=$2e,GW=Bc,Ap=J7,r3="[object Map]",L2e="[object Object]",n3="[object Promise]",s3="[object Set]",a3="[object WeakMap]",i3="[object DataView]",F2e=Ap(eE),z2e=Ap(tE),B2e=Ap(rE),U2e=Ap(nE),q2e=Ap(sE),xu=GW;(eE&&xu(new eE(new ArrayBuffer(1)))!=i3||tE&&xu(new tE)!=r3||rE&&xu(rE.resolve())!=n3||nE&&xu(new nE)!=s3||sE&&xu(new sE)!=a3)&&(xu=function(e){var t=GW(e),r=t==L2e?e.constructor:void 0,n=r?Ap(r):"";if(n)switch(n){case F2e:return i3;case z2e:return r3;case B2e:return n3;case U2e:return s3;case q2e:return a3}return t});var V2e=xu,pS=DW,W2e=FW,H2e=jSe,G2e=b2e,o3=V2e,l3=_i,c3=UW,Y2e=VW,K2e=1,d3="[object Arguments]",u3="[object Array]",C0="[object Object]",Z2e=Object.prototype,h3=Z2e.hasOwnProperty;function X2e(e,t,r,n,a,i){var o=l3(e),l=l3(t),c=o?u3:o3(e),d=l?u3:o3(t);c=c==d3?C0:c,d=d==d3?C0:d;var u=c==C0,f=d==C0,h=c==d;if(h&&c3(e)){if(!c3(t))return!1;o=!0,u=!1}if(h&&!u)return i||(i=new pS),o||Y2e(e)?W2e(e,t,r,n,a,i):H2e(e,t,c,r,n,a,i);if(!(r&K2e)){var p=u&&h3.call(e,"__wrapped__"),g=f&&h3.call(t,"__wrapped__");if(p||g){var v=p?e.value():e,y=g?t.value():t;return i||(i=new pS),a(v,y,r,n,i)}}return h?(i||(i=new pS),G2e(e,t,r,n,a,i)):!1}var J2e=X2e,Q2e=J2e,f3=Uc;function YW(e,t,r,n,a){return e===t?!0:e==null||t==null||!f3(e)&&!f3(t)?e!==e&&t!==t:Q2e(e,t,r,n,YW,a)}var CA=YW,eEe=DW,tEe=CA,rEe=1,nEe=2;function sEe(e,t,r,n){var a=r.length,i=a,o=!n;if(e==null)return!i;for(e=Object(e);a--;){var l=r[a];if(o&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++a<i;){l=r[a];var c=l[0],d=e[c],u=l[1];if(o&&l[2]){if(d===void 0&&!(c in e))return!1}else{var f=new eEe;if(n)var h=n(d,u,c,e,t,f);if(!(h===void 0?tEe(u,d,rEe|nEe,n,f):h))return!1}}return!0}var aEe=sEe,iEe=ru;function oEe(e){return e===e&&!iEe(e)}var KW=oEe,lEe=KW,cEe=lj;function dEe(e){for(var t=cEe(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,lEe(a)]}return t}var uEe=dEe;function hEe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var ZW=hEe,fEe=aEe,mEe=uEe,pEe=ZW;function gEe(e){var t=mEe(e);return t.length==1&&t[0][2]?pEe(t[0][0],t[0][1]):function(r){return r===e||fEe(r,e,t)}}var vEe=gEe;function yEe(e,t){return e!=null&&t in Object(e)}var xEe=yEe,_Ee=nW,wEe=SA,bEe=_i,jEe=kA,NEe=EA,SEe=G1;function kEe(e,t,r){t=_Ee(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var o=SEe(t[n]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&NEe(a)&&jEe(o,a)&&(bEe(e)||wEe(e)))}var EEe=kEe,CEe=xEe,PEe=EEe;function TEe(e,t){return e!=null&&PEe(e,t,CEe)}var AEe=TEe,REe=CA,OEe=sW,MEe=AEe,DEe=oA,IEe=KW,$Ee=ZW,LEe=G1,FEe=1,zEe=2;function BEe(e,t){return DEe(e)&&IEe(t)?$Ee(LEe(e),t):function(r){var n=OEe(r,e);return n===void 0&&n===t?MEe(r,e):REe(t,n,FEe|zEe)}}var UEe=BEe;function qEe(e){return e}var Rp=qEe;function VEe(e){return function(t){return t==null?void 0:t[e]}}var WEe=VEe,HEe=mA;function GEe(e){return function(t){return HEe(t,e)}}var YEe=GEe,KEe=WEe,ZEe=YEe,XEe=oA,JEe=G1;function QEe(e){return XEe(e)?KEe(JEe(e)):ZEe(e)}var eCe=QEe,tCe=vEe,rCe=UEe,nCe=Rp,sCe=_i,aCe=eCe;function iCe(e){return typeof e=="function"?e:e==null?nCe:typeof e=="object"?sCe(e)?rCe(e[0],e[1]):tCe(e):aCe(e)}var nu=iCe;function oCe(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var XW=oCe;function lCe(e){return e!==e}var cCe=lCe;function dCe(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var uCe=dCe,hCe=XW,fCe=cCe,mCe=uCe;function pCe(e,t,r){return t===t?mCe(e,t,r):hCe(e,fCe,r)}var gCe=pCe,vCe=gCe;function yCe(e,t){var r=e==null?0:e.length;return!!r&&vCe(e,t,0)>-1}var xCe=yCe;function _Ce(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var wCe=_Ce;function bCe(){}var jCe=bCe,gS=HW,NCe=jCe,SCe=NA,kCe=1/0,ECe=gS&&1/SCe(new gS([,-0]))[1]==kCe?function(e){return new gS(e)}:NCe,CCe=ECe,PCe=IW,TCe=xCe,ACe=wCe,RCe=LW,OCe=CCe,MCe=NA,DCe=200;function ICe(e,t,r){var n=-1,a=TCe,i=e.length,o=!0,l=[],c=l;if(r)o=!1,a=ACe;else if(i>=DCe){var d=t?null:OCe(e);if(d)return MCe(d);o=!1,a=RCe,c=new PCe}else c=t?[]:l;e:for(;++n<i;){var u=e[n],f=t?t(u):u;if(u=r||u!==0?u:0,o&&f===f){for(var h=c.length;h--;)if(c[h]===f)continue e;t&&c.push(f),l.push(u)}else a(c,f,r)||(c!==l&&c.push(f),l.push(u))}return l}var $Ce=ICe,LCe=nu,FCe=$Ce;function zCe(e,t){return e&&e.length?FCe(e,LCe(t)):[]}var BCe=zCe;const m3=yn(BCe);function JW(e,t,r){return t===!0?m3(e,r):Ir(t)?m3(e,t):e}function Om(e){"@babel/helpers - typeof";return Om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Om(e)}var UCe=["ref"];function p3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p3(Object(r),!0).forEach(function(n){cj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eH(n.key),n)}}function VCe(e,t,r){return t&&g3(e.prototype,t),r&&g3(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WCe(e,t,r){return t=Pw(t),HCe(e,QW()?Reflect.construct(t,r||[],Pw(e).constructor):t.apply(e,r))}function HCe(e,t){if(t&&(Om(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GCe(e)}function GCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(QW=function(){return!!e})()}function Pw(e){return Pw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pw(e)}function YCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aE(e,t)}function aE(e,t){return aE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},aE(e,t)}function cj(e,t,r){return t=eH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eH(e){var t=KCe(e,"string");return Om(t)=="symbol"?t:t+""}function KCe(e,t){if(Om(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Om(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZCe(e,t){if(e==null)return{};var r=XCe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function XCe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function JCe(e){return e.value}function QCe(e,t){if(J.isValidElement(e))return J.cloneElement(e,t);if(typeof e=="function")return J.createElement(e,t);t.ref;var r=ZCe(t,UCe);return J.createElement(jA,r)}var v3=1,Zu=function(e){function t(){var r;qCe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=WCe(this,t,[].concat(a)),cj(r,"lastBoundingBox",{width:-1,height:-1}),r}return YCe(t,e),VCe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>v3||Math.abs(a.height-this.lastBoundingBox.height)>v3)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Jl({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,o=a.align,l=a.verticalAlign,c=a.margin,d=a.chartWidth,u=a.chartHeight,f,h;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&i==="vertical"){var p=this.getBBoxSnapshot();f={left:((d||0)-p.width)/2}}else f=o==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var g=this.getBBoxSnapshot();h={top:((u||0)-g.height)/2}}else h=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return Jl(Jl({},f),h)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,o=a.width,l=a.height,c=a.wrapperStyle,d=a.payloadUniqBy,u=a.payload,f=Jl(Jl({position:"absolute",width:o||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return J.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(p){n.wrapperNode=p}},QCe(i,Jl(Jl({},this.props),{},{payload:JW(u,d,JCe)})))}}],[{key:"getWithHeight",value:function(n,a){var i=Jl(Jl({},this.defaultProps),n.props),o=i.layout;return o==="vertical"&&Nt(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||a}:null}}])}(x.PureComponent);cj(Zu,"displayName","Legend");cj(Zu,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var y3=px,ePe=SA,tPe=_i,x3=y3?y3.isConcatSpreadable:void 0;function rPe(e){return tPe(e)||ePe(e)||!!(x3&&e&&e[x3])}var nPe=rPe,sPe=zW,aPe=nPe;function tH(e,t,r,n,a){var i=-1,o=e.length;for(r||(r=aPe),a||(a=[]);++i<o;){var l=e[i];t>0&&r(l)?t>1?tH(l,t-1,r,n,a):sPe(a,l):n||(a[a.length]=l)}return a}var rH=tH;function iPe(e){return function(t,r,n){for(var a=-1,i=Object(t),o=n(t),l=o.length;l--;){var c=o[e?l:++a];if(r(i[c],c,i)===!1)break}return t}}var oPe=iPe,lPe=oPe,cPe=lPe(),dPe=cPe,uPe=dPe,hPe=lj;function fPe(e,t){return e&&uPe(e,t,hPe)}var nH=fPe,mPe=gx;function pPe(e,t){return function(r,n){if(r==null)return r;if(!mPe(r))return e(r,n);for(var a=r.length,i=t?a:-1,o=Object(r);(t?i--:++i<a)&&n(o[i],i,o)!==!1;);return r}}var gPe=pPe,vPe=nH,yPe=gPe,xPe=yPe(vPe),PA=xPe,_Pe=PA,wPe=gx;function bPe(e,t){var r=-1,n=wPe(e)?Array(e.length):[];return _Pe(e,function(a,i,o){n[++r]=t(a,i,o)}),n}var sH=bPe;function jPe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var NPe=jPe,_3=jp;function SPe(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=_3(e),o=t!==void 0,l=t===null,c=t===t,d=_3(t);if(!l&&!d&&!i&&e>t||i&&o&&c&&!l&&!d||n&&o&&c||!r&&c||!a)return 1;if(!n&&!i&&!d&&e<t||d&&r&&a&&!n&&!i||l&&r&&a||!o&&a||!c)return-1}return 0}var kPe=SPe,EPe=kPe;function CPe(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,o=a.length,l=r.length;++n<o;){var c=EPe(a[n],i[n]);if(c){if(n>=l)return c;var d=r[n];return c*(d=="desc"?-1:1)}}return e.index-t.index}var PPe=CPe,vS=fA,TPe=mA,APe=nu,RPe=sH,OPe=NPe,MPe=qW,DPe=PPe,IPe=Rp,$Pe=_i;function LPe(e,t,r){t.length?t=vS(t,function(i){return $Pe(i)?function(o){return TPe(o,i.length===1?i[0]:i)}:i}):t=[IPe];var n=-1;t=vS(t,MPe(APe));var a=RPe(e,function(i,o,l){var c=vS(t,function(d){return d(i)});return{criteria:c,index:++n,value:i}});return OPe(a,function(i,o){return DPe(i,o,r)})}var FPe=LPe;function zPe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var BPe=zPe,UPe=BPe,w3=Math.max;function qPe(e,t,r){return t=w3(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=w3(n.length-t,0),o=Array(i);++a<i;)o[a]=n[t+a];a=-1;for(var l=Array(t+1);++a<t;)l[a]=n[a];return l[t]=r(o),UPe(e,this,l)}}var VPe=qPe;function WPe(e){return function(){return e}}var HPe=WPe,GPe=Th,YPe=function(){try{var e=GPe(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),aH=YPe,KPe=HPe,b3=aH,ZPe=Rp,XPe=b3?function(e,t){return b3(e,"toString",{configurable:!0,enumerable:!1,value:KPe(t),writable:!0})}:ZPe,JPe=XPe,QPe=800,eTe=16,tTe=Date.now;function rTe(e){var t=0,r=0;return function(){var n=tTe(),a=eTe-(n-r);if(r=n,a>0){if(++t>=QPe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var nTe=rTe,sTe=JPe,aTe=nTe,iTe=aTe(sTe),oTe=iTe,lTe=Rp,cTe=VPe,dTe=oTe;function uTe(e,t){return dTe(cTe(e,t,lTe),e+"")}var hTe=uTe,fTe=cA,mTe=gx,pTe=kA,gTe=ru;function vTe(e,t,r){if(!gTe(r))return!1;var n=typeof t;return(n=="number"?mTe(r)&&pTe(t,r.length):n=="string"&&t in r)?fTe(r[t],e):!1}var dj=vTe,yTe=rH,xTe=FPe,_Te=hTe,j3=dj,wTe=_Te(function(e,t){if(e==null)return[];var r=t.length;return r>1&&j3(e,t[0],t[1])?t=[]:r>2&&j3(t[0],t[1],t[2])&&(t=[t[0]]),xTe(e,yTe(t,1),[])}),bTe=wTe;const TA=yn(bTe);function Yv(e){"@babel/helpers - typeof";return Yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yv(e)}function iE(){return iE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iE.apply(this,arguments)}function jTe(e,t){return ETe(e)||kTe(e,t)||STe(e,t)||NTe()}function NTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function STe(e,t){if(e){if(typeof e=="string")return N3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N3(e,t)}}function N3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kTe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function ETe(e){if(Array.isArray(e))return e}function S3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S3(Object(r),!0).forEach(function(n){CTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CTe(e,t,r){return t=PTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PTe(e){var t=TTe(e,"string");return Yv(t)=="symbol"?t:t+""}function TTe(e,t){if(Yv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ATe(e){return Array.isArray(e)&&Ws(e[0])&&Ws(e[1])?e.join(" ~ "):e}var RTe=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,o=t.itemStyle,l=o===void 0?{}:o,c=t.labelStyle,d=c===void 0?{}:c,u=t.payload,f=t.formatter,h=t.itemSorter,p=t.wrapperClassName,g=t.labelClassName,v=t.label,y=t.labelFormatter,_=t.accessibilityLayer,w=_===void 0?!1:_,b=function(){if(u&&u.length){var z={padding:0,margin:0},D=(h?TA(u,h):u).map(function(B,F){if(B.type==="none")return null;var U=yS({display:"block",paddingTop:4,paddingBottom:4,color:B.color||"#000"},l),G=B.formatter||f||ATe,q=B.value,K=B.name,Z=q,Y=K;if(G&&Z!=null&&Y!=null){var Q=G(q,K,B,F,u);if(Array.isArray(Q)){var X=jTe(Q,2);Z=X[0],Y=X[1]}else Z=Q}return J.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(F),style:U},Ws(Y)?J.createElement("span",{className:"recharts-tooltip-item-name"},Y):null,Ws(Y)?J.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,J.createElement("span",{className:"recharts-tooltip-item-value"},Z),J.createElement("span",{className:"recharts-tooltip-item-unit"},B.unit||""))});return J.createElement("ul",{className:"recharts-tooltip-item-list",style:z},D)}return null},N=yS({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),S=yS({margin:0},d),k=!Yr(v),P=k?v:"",A=an("recharts-default-tooltip",p),R=an("recharts-tooltip-label",g);k&&y&&u!==void 0&&u!==null&&(P=y(v,u));var $=w?{role:"status","aria-live":"assertive"}:{};return J.createElement("div",iE({className:A,style:N},$),J.createElement("p",{className:R,style:S},J.isValidElement(P)?P:"".concat(P)),b())};function Kv(e){"@babel/helpers - typeof";return Kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kv(e)}function P0(e,t,r){return t=OTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OTe(e){var t=MTe(e,"string");return Kv(t)=="symbol"?t:t+""}function MTe(e,t){if(Kv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xg="recharts-tooltip-wrapper",DTe={visibility:"hidden"};function ITe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return an(xg,P0(P0(P0(P0({},"".concat(xg,"-right"),Nt(r)&&t&&Nt(t.x)&&r>=t.x),"".concat(xg,"-left"),Nt(r)&&t&&Nt(t.x)&&r<t.x),"".concat(xg,"-bottom"),Nt(n)&&t&&Nt(t.y)&&n>=t.y),"".concat(xg,"-top"),Nt(n)&&t&&Nt(t.y)&&n<t.y))}function k3(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,o=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,d=e.viewBoxDimension;if(i&&Nt(i[n]))return i[n];var u=r[n]-l-a,f=r[n]+a;if(t[n])return o[n]?u:f;if(o[n]){var h=u,p=c[n];return h<p?Math.max(f,c[n]):Math.max(u,c[n])}var g=f+l,v=c[n]+d;return g>v?Math.max(u,c[n]):Math.max(f,c[n])}function $Te(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function LTe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,o=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,d,u,f;return o.height>0&&o.width>0&&r?(u=k3({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=k3({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),d=$Te({translateX:u,translateY:f,useTranslate3d:l})):d=DTe,{cssProperties:d,cssClasses:ITe({translateX:u,translateY:f,coordinate:r})}}function Mm(e){"@babel/helpers - typeof";return Mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mm(e)}function E3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function C3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E3(Object(r),!0).forEach(function(n){lE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zTe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oH(n.key),n)}}function BTe(e,t,r){return t&&zTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function UTe(e,t,r){return t=Tw(t),qTe(e,iH()?Reflect.construct(t,r||[],Tw(e).constructor):t.apply(e,r))}function qTe(e,t){if(t&&(Mm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VTe(e)}function VTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(iH=function(){return!!e})()}function Tw(e){return Tw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tw(e)}function WTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oE(e,t)}function oE(e,t){return oE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},oE(e,t)}function lE(e,t,r){return t=oH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oH(e){var t=HTe(e,"string");return Mm(t)=="symbol"?t:t+""}function HTe(e,t){if(Mm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P3=1,GTe=function(e){function t(){var r;FTe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=UTe(this,t,[].concat(a)),lE(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),lE(r,"handleKeyDown",function(o){if(o.key==="Escape"){var l,c,d,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(d=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&d!==void 0?d:0}})}}),r}return WTe(t,e),BTe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>P3||Math.abs(n.height-this.state.lastBoundingBox.height)>P3)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,d=a.children,u=a.coordinate,f=a.hasPayload,h=a.isAnimationActive,p=a.offset,g=a.position,v=a.reverseDirection,y=a.useTranslate3d,_=a.viewBox,w=a.wrapperStyle,b=LTe({allowEscapeViewBox:o,coordinate:u,offsetTopLeft:p,position:g,reverseDirection:v,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:_}),N=b.cssClasses,S=b.cssProperties,k=C3(C3({transition:h&&i?"transform ".concat(l,"ms ").concat(c):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},w);return J.createElement("div",{tabIndex:-1,className:N,style:k,ref:function(A){n.wrapperNode=A}},d)}}])}(x.PureComponent),YTe=function(){return!(typeof window!="undefined"&&window.document&&window.document.createElement&&window.setTimeout)},Tl={isSsr:YTe(),get:function(t){return Tl[t]},set:function(t,r){if(typeof t=="string")Tl[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(a){Tl[a]=t[a]})}}};function Dm(e){"@babel/helpers - typeof";return Dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dm(e)}function T3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function A3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T3(Object(r),!0).forEach(function(n){AA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZTe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cH(n.key),n)}}function XTe(e,t,r){return t&&ZTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function JTe(e,t,r){return t=Aw(t),QTe(e,lH()?Reflect.construct(t,r||[],Aw(e).constructor):t.apply(e,r))}function QTe(e,t){if(t&&(Dm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eAe(e)}function eAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(lH=function(){return!!e})()}function Aw(e){return Aw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Aw(e)}function tAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cE(e,t)}function cE(e,t){return cE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},cE(e,t)}function AA(e,t,r){return t=cH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cH(e){var t=rAe(e,"string");return Dm(t)=="symbol"?t:t+""}function rAe(e,t){if(Dm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nAe(e){return e.dataKey}function sAe(e,t){return J.isValidElement(e)?J.cloneElement(e,t):typeof e=="function"?J.createElement(e,t):J.createElement(RTe,t)}var ea=function(e){function t(){return KTe(this,t),JTe(this,t,arguments)}return tAe(t,e),XTe(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,d=a.content,u=a.coordinate,f=a.filterNull,h=a.isAnimationActive,p=a.offset,g=a.payload,v=a.payloadUniqBy,y=a.position,_=a.reverseDirection,w=a.useTranslate3d,b=a.viewBox,N=a.wrapperStyle,S=g!=null?g:[];f&&S.length&&(S=JW(g.filter(function(P){return P.value!=null&&(P.hide!==!0||n.props.includeHidden)}),v,nAe));var k=S.length>0;return J.createElement(GTe,{allowEscapeViewBox:o,animationDuration:l,animationEasing:c,isAnimationActive:h,active:i,coordinate:u,hasPayload:k,offset:p,position:y,reverseDirection:_,useTranslate3d:w,viewBox:b,wrapperStyle:N},sAe(d,A3(A3({},this.props),{},{payload:S})))}}])}(x.PureComponent);AA(ea,"displayName","Tooltip");AA(ea,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Tl.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var aAe=Ul,iAe=function(){return aAe.Date.now()},oAe=iAe,lAe=/\s/;function cAe(e){for(var t=e.length;t--&&lAe.test(e.charAt(t)););return t}var dAe=cAe,uAe=dAe,hAe=/^\s+/;function fAe(e){return e&&e.slice(0,uAe(e)+1).replace(hAe,"")}var mAe=fAe,pAe=mAe,R3=ru,gAe=jp,O3=NaN,vAe=/^[-+]0x[0-9a-f]+$/i,yAe=/^0b[01]+$/i,xAe=/^0o[0-7]+$/i,_Ae=parseInt;function wAe(e){if(typeof e=="number")return e;if(gAe(e))return O3;if(R3(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=R3(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=pAe(e);var r=yAe.test(e);return r||xAe.test(e)?_Ae(e.slice(2),r?2:8):vAe.test(e)?O3:+e}var dH=wAe,bAe=ru,xS=oAe,M3=dH,jAe="Expected a function",NAe=Math.max,SAe=Math.min;function kAe(e,t,r){var n,a,i,o,l,c,d=0,u=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(jAe);t=M3(t)||0,bAe(r)&&(u=!!r.leading,f="maxWait"in r,i=f?NAe(M3(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h);function p(k){var P=n,A=a;return n=a=void 0,d=k,o=e.apply(A,P),o}function g(k){return d=k,l=setTimeout(_,t),u?p(k):o}function v(k){var P=k-c,A=k-d,R=t-P;return f?SAe(R,i-A):R}function y(k){var P=k-c,A=k-d;return c===void 0||P>=t||P<0||f&&A>=i}function _(){var k=xS();if(y(k))return w(k);l=setTimeout(_,v(k))}function w(k){return l=void 0,h&&n?p(k):(n=a=void 0,o)}function b(){l!==void 0&&clearTimeout(l),d=0,n=c=a=l=void 0}function N(){return l===void 0?o:w(xS())}function S(){var k=xS(),P=y(k);if(n=arguments,a=this,c=k,P){if(l===void 0)return g(c);if(f)return clearTimeout(l),l=setTimeout(_,t),p(c)}return l===void 0&&(l=setTimeout(_,t)),o}return S.cancel=b,S.flush=N,S}var EAe=kAe,CAe=EAe,PAe=ru,TAe="Expected a function";function AAe(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(TAe);return PAe(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),CAe(e,t,{leading:n,maxWait:t,trailing:a})}var RAe=AAe;const uH=yn(RAe);function Zv(e){"@babel/helpers - typeof";return Zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zv(e)}function D3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function T0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D3(Object(r),!0).forEach(function(n){OAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OAe(e,t,r){return t=MAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MAe(e){var t=DAe(e,"string");return Zv(t)=="symbol"?t:t+""}function DAe(e,t){if(Zv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IAe(e,t){return zAe(e)||FAe(e,t)||LAe(e,t)||$Ae()}function $Ae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LAe(e,t){if(e){if(typeof e=="string")return I3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I3(e,t)}}function I3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FAe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function zAe(e){if(Array.isArray(e))return e}var rc=x.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,o=i===void 0?"100%":i,l=e.height,c=l===void 0?"100%":l,d=e.minWidth,u=d===void 0?0:d,f=e.minHeight,h=e.maxHeight,p=e.children,g=e.debounce,v=g===void 0?0:g,y=e.id,_=e.className,w=e.onResize,b=e.style,N=b===void 0?{}:b,S=x.useRef(null),k=x.useRef();k.current=w,x.useImperativeHandle(t,function(){return Object.defineProperty(S.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),S.current},configurable:!0})});var P=x.useState({containerWidth:a.width,containerHeight:a.height}),A=IAe(P,2),R=A[0],$=A[1],O=x.useCallback(function(D,B){$(function(F){var U=Math.round(D),G=Math.round(B);return F.containerWidth===U&&F.containerHeight===G?F:{containerWidth:U,containerHeight:G}})},[]);x.useEffect(function(){var D=function(K){var Z,Y=K[0].contentRect,Q=Y.width,X=Y.height;O(Q,X),(Z=k.current)===null||Z===void 0||Z.call(k,Q,X)};v>0&&(D=uH(D,v,{trailing:!0,leading:!1}));var B=new ResizeObserver(D),F=S.current.getBoundingClientRect(),U=F.width,G=F.height;return O(U,G),B.observe(S.current),function(){B.disconnect()}},[O,v]);var z=x.useMemo(function(){var D=R.containerWidth,B=R.containerHeight;if(D<0||B<0)return null;bc(Mu(o)||Mu(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,c),bc(!r||r>0,"The aspect(%s) must be greater than zero.",r);var F=Mu(o)?D:o,U=Mu(c)?B:c;r&&r>0&&(F?U=F/r:U&&(F=U*r),h&&U>h&&(U=h)),bc(F>0||U>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,F,U,o,c,u,f,r);var G=!Array.isArray(p)&&wc(p.type).endsWith("Chart");return J.Children.map(p,function(q){return J.isValidElement(q)?x.cloneElement(q,T0({width:F,height:U},G?{style:T0({height:"100%",width:"100%",maxHeight:U,maxWidth:F},q.props.style)}:{})):q})},[r,p,c,h,f,u,R,o]);return J.createElement("div",{id:y?"".concat(y):void 0,className:an("recharts-responsive-container",_),style:T0(T0({},N),{},{width:o,height:c,minWidth:u,minHeight:f,maxHeight:h}),ref:S},z)}),hH=function(t){return null};hH.displayName="Cell";function Xv(e){"@babel/helpers - typeof";return Xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xv(e)}function $3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$3(Object(r),!0).forEach(function(n){BAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BAe(e,t,r){return t=UAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UAe(e){var t=qAe(e,"string");return Xv(t)=="symbol"?t:t+""}function qAe(e,t){if(Xv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rf={widthCache:{},cacheCount:0},VAe=2e3,WAe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},L3="recharts_measurement_span";function HAe(e){var t=dE({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var rv=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Tl.isSsr)return{width:0,height:0};var n=HAe(r),a=JSON.stringify({text:t,copyStyle:n});if(rf.widthCache[a])return rf.widthCache[a];try{var i=document.getElementById(L3);i||(i=document.createElement("span"),i.setAttribute("id",L3),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=dE(dE({},WAe),n);Object.assign(i.style,o),i.textContent="".concat(t);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return rf.widthCache[a]=c,++rf.cacheCount>VAe&&(rf.cacheCount=0,rf.widthCache={}),c}catch(d){return{width:0,height:0}}},GAe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Jv(e){"@babel/helpers - typeof";return Jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jv(e)}function Rw(e,t){return XAe(e)||ZAe(e,t)||KAe(e,t)||YAe()}function YAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KAe(e,t){if(e){if(typeof e=="string")return F3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F3(e,t)}}function F3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZAe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function XAe(e){if(Array.isArray(e))return e}function JAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eRe(n.key),n)}}function QAe(e,t,r){return t&&z3(e.prototype,t),r&&z3(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eRe(e){var t=tRe(e,"string");return Jv(t)=="symbol"?t:t+""}function tRe(e,t){if(Jv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var B3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,U3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,rRe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,nRe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,fH={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},sRe=Object.keys(fH),Af="NaN";function aRe(e,t){return e*fH[t]}var A0=function(){function e(t,r){JAe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!rRe.test(r)&&(this.num=NaN,this.unit=""),sRe.includes(r)&&(this.num=aRe(t,r),this.unit="px")}return QAe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=nRe.exec(r))!==null&&n!==void 0?n:[],i=Rw(a,3),o=i[1],l=i[2];return new e(parseFloat(o),l!=null?l:"")}}])}();function mH(e){if(e.includes(Af))return Af;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=B3.exec(t))!==null&&r!==void 0?r:[],a=Rw(n,4),i=a[1],o=a[2],l=a[3],c=A0.parse(i!=null?i:""),d=A0.parse(l!=null?l:""),u=o==="*"?c.multiply(d):c.divide(d);if(u.isNaN())return Af;t=t.replace(B3,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,h=(f=U3.exec(t))!==null&&f!==void 0?f:[],p=Rw(h,4),g=p[1],v=p[2],y=p[3],_=A0.parse(g!=null?g:""),w=A0.parse(y!=null?y:""),b=v==="+"?_.add(w):_.subtract(w);if(b.isNaN())return Af;t=t.replace(U3,b.toString())}return t}var q3=/\(([^()]*)\)/;function iRe(e){for(var t=e;t.includes("(");){var r=q3.exec(t),n=Rw(r,2),a=n[1];t=t.replace(q3,mH(a))}return t}function oRe(e){var t=e.replace(/\s+/g,"");return t=iRe(t),t=mH(t),t}function lRe(e){try{return oRe(e)}catch(t){return Af}}function _S(e){var t=lRe(e.slice(5,-1));return t===Af?"":t}var cRe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],dRe=["dx","dy","angle","className","breakAll"];function uE(){return uE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uE.apply(this,arguments)}function V3(e,t){if(e==null)return{};var r=uRe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function W3(e,t){return pRe(e)||mRe(e,t)||fRe(e,t)||hRe()}function hRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fRe(e,t){if(e){if(typeof e=="string")return H3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H3(e,t)}}function H3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mRe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function pRe(e){if(Array.isArray(e))return e}var pH=/[ \f\n\r\t\v\u2028\u2029]+/,gH=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];Yr(r)||(n?i=r.toString().split(""):i=r.toString().split(pH));var o=i.map(function(c){return{word:c,width:rv(c,a).width}}),l=n?0:rv("",a).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch(c){return null}},gRe=function(t,r,n,a,i){var o=t.maxLines,l=t.children,c=t.style,d=t.breakAll,u=Nt(o),f=l,h=function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return F.reduce(function(U,G){var q=G.word,K=G.width,Z=U[U.length-1];if(Z&&(a==null||i||Z.width+K+n<Number(a)))Z.words.push(q),Z.width+=K+n;else{var Y={words:[q],width:K};U.push(Y)}return U},[])},p=h(r),g=function(F){return F.reduce(function(U,G){return U.width>G.width?U:G})};if(!u)return p;for(var v="",y=function(F){var U=f.slice(0,F),G=gH({breakAll:d,style:c,children:U+v}).wordsWithComputedWidth,q=h(G),K=q.length>o||g(q).width>Number(a);return[K,q]},_=0,w=f.length-1,b=0,N;_<=w&&b<=f.length-1;){var S=Math.floor((_+w)/2),k=S-1,P=y(k),A=W3(P,2),R=A[0],$=A[1],O=y(S),z=W3(O,1),D=z[0];if(!R&&!D&&(_=S+1),R&&D&&(w=S-1),!R&&D){N=$;break}b++}return N||p},G3=function(t){var r=Yr(t)?[]:t.toString().split(pH);return[{words:r}]},vRe=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,o=t.breakAll,l=t.maxLines;if((r||n)&&!Tl.isSsr){var c,d,u=gH({breakAll:o,children:a,style:i});if(u){var f=u.wordsWithComputedWidth,h=u.spaceWidth;c=f,d=h}else return G3(a);return gRe({breakAll:o,children:a,maxLines:l,style:i},c,d,r,n)}return G3(a)},Y3="#808080",Ow=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.lineHeight,l=o===void 0?"1em":o,c=t.capHeight,d=c===void 0?"0.71em":c,u=t.scaleToFit,f=u===void 0?!1:u,h=t.textAnchor,p=h===void 0?"start":h,g=t.verticalAnchor,v=g===void 0?"end":g,y=t.fill,_=y===void 0?Y3:y,w=V3(t,cRe),b=x.useMemo(function(){return vRe({breakAll:w.breakAll,children:w.children,maxLines:w.maxLines,scaleToFit:f,style:w.style,width:w.width})},[w.breakAll,w.children,w.maxLines,f,w.style,w.width]),N=w.dx,S=w.dy,k=w.angle,P=w.className,A=w.breakAll,R=V3(w,dRe);if(!Ws(n)||!Ws(i))return null;var $=n+(Nt(N)?N:0),O=i+(Nt(S)?S:0),z;switch(v){case"start":z=_S("calc(".concat(d,")"));break;case"middle":z=_S("calc(".concat((b.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:z=_S("calc(".concat(b.length-1," * -").concat(l,")"));break}var D=[];if(f){var B=b[0].width,F=w.width;D.push("scale(".concat((Nt(F)?F/B:1)/B,")"))}return k&&D.push("rotate(".concat(k,", ").concat($,", ").concat(O,")")),D.length&&(R.transform=D.join(" ")),J.createElement("text",uE({},Fr(R,!0),{x:$,y:O,className:an("recharts-text",P),textAnchor:p,fill:_.includes("url")?Y3:_}),b.map(function(U,G){var q=U.words.join(A?"":" ");return J.createElement("tspan",{x:$,dy:G===0?z:l,key:"".concat(q,"-").concat(G)},q)}))};function Md(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function yRe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function RA(e){let t,r,n;e.length!==2?(t=Md,r=(l,c)=>Md(e(l),c),n=(l,c)=>e(l)-c):(t=e===Md||e===yRe?e:xRe,r=e,n=e);function a(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function o(l,c,d=0,u=l.length){const f=a(l,c,d,u-1);return f>d&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:o,right:i}}function xRe(){return 0}function vH(e){return e===null?NaN:+e}function*_Re(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const wRe=RA(Md),vx=wRe.right;RA(vH).center;class K3 extends Map{constructor(t,r=NRe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(Z3(this,t))}has(t){return super.has(Z3(this,t))}set(t,r){return super.set(bRe(this,t),r)}delete(t){return super.delete(jRe(this,t))}}function Z3({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function bRe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function jRe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function NRe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function SRe(e=Md){if(e===Md)return yH;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function yH(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const kRe=Math.sqrt(50),ERe=Math.sqrt(10),CRe=Math.sqrt(2);function Mw(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=kRe?10:i>=ERe?5:i>=CRe?2:1;let l,c,d;return a<0?(d=Math.pow(10,-a)/o,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,a)*o,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?Mw(e,t,r*2):[l,c,d]}function hE(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,o]=n?Mw(t,e,r):Mw(e,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(o<0)for(let d=0;d<l;++d)c[d]=(i-d)/-o;else for(let d=0;d<l;++d)c[d]=(i-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(a+d)/-o;else for(let d=0;d<l;++d)c[d]=(a+d)*o;return c}function fE(e,t,r){return t=+t,e=+e,r=+r,Mw(e,t,r)[2]}function mE(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?fE(t,e,r):fE(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function X3(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function J3(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function xH(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?yH:SRe(a);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),p=Math.max(r,Math.floor(t-d*f/c+h)),g=Math.min(n,Math.floor(t+(c-d)*f/c+h));xH(e,t,p,g,a)}const i=e[t];let o=r,l=n;for(_g(e,r,t),a(e[n],i)>0&&_g(e,r,n);o<l;){for(_g(e,o,l),++o,--l;a(e[o],i)<0;)++o;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?_g(e,r,l):(++l,_g(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function _g(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function PRe(e,t,r){if(e=Float64Array.from(_Re(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return J3(e);if(t>=1)return X3(e);var n,a=(n-1)*t,i=Math.floor(a),o=X3(xH(e,i).subarray(0,i+1)),l=J3(e.subarray(i+1));return o+(l-o)*(a-i)}}function TRe(e,t,r=vH){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return o+(l-o)*(a-i)}}function ARe(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function po(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function qc(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const pE=Symbol("implicit");function OA(){var e=new K3,t=[],r=[],n=pE;function a(i){let o=e.get(i);if(o===void 0){if(n!==pE)return n;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new K3;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return OA(t,r).unknown(n)},po.apply(a,arguments),a}function Qv(){var e=OA().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,o,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var h=t().length,p=a<n,g=p?a:n,v=p?n:a;i=(v-g)/Math.max(1,h-c+d*2),l&&(i=Math.floor(i)),g+=(v-g-i*(h-c))*u,o=i*(1-c),l&&(g=Math.round(g),o=Math.round(o));var y=ARe(h).map(function(_){return g+i*_});return r(p?y.reverse():y)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,d=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(d=+h,f()):d},e.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),f()):u},e.copy=function(){return Qv(t(),[n,a]).round(l).paddingInner(c).paddingOuter(d).align(u)},po.apply(f(),arguments)}function _H(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return _H(t())},e}function nv(){return _H(Qv.apply(null,arguments).paddingInner(1))}function MA(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function wH(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function yx(){}var ey=.7,Dw=1/ey,Jf="\\s*([+-]?\\d+)\\s*",ty="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Al="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",RRe=/^#([0-9a-f]{3,8})$/,ORe=new RegExp(`^rgb\\(${Jf},${Jf},${Jf}\\)$`),MRe=new RegExp(`^rgb\\(${Al},${Al},${Al}\\)$`),DRe=new RegExp(`^rgba\\(${Jf},${Jf},${Jf},${ty}\\)$`),IRe=new RegExp(`^rgba\\(${Al},${Al},${Al},${ty}\\)$`),$Re=new RegExp(`^hsl\\(${ty},${Al},${Al}\\)$`),LRe=new RegExp(`^hsla\\(${ty},${Al},${Al},${ty}\\)$`),Q3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};MA(yx,ry,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:eD,formatHex:eD,formatHex8:FRe,formatHsl:zRe,formatRgb:tD,toString:tD});function eD(){return this.rgb().formatHex()}function FRe(){return this.rgb().formatHex8()}function zRe(){return bH(this).formatHsl()}function tD(){return this.rgb().formatRgb()}function ry(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=RRe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?rD(t):r===3?new di(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?R0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?R0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ORe.exec(e))?new di(t[1],t[2],t[3],1):(t=MRe.exec(e))?new di(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=DRe.exec(e))?R0(t[1],t[2],t[3],t[4]):(t=IRe.exec(e))?R0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=$Re.exec(e))?aD(t[1],t[2]/100,t[3]/100,1):(t=LRe.exec(e))?aD(t[1],t[2]/100,t[3]/100,t[4]):Q3.hasOwnProperty(e)?rD(Q3[e]):e==="transparent"?new di(NaN,NaN,NaN,0):null}function rD(e){return new di(e>>16&255,e>>8&255,e&255,1)}function R0(e,t,r,n){return n<=0&&(e=t=r=NaN),new di(e,t,r,n)}function BRe(e){return e instanceof yx||(e=ry(e)),e?(e=e.rgb(),new di(e.r,e.g,e.b,e.opacity)):new di}function gE(e,t,r,n){return arguments.length===1?BRe(e):new di(e,t,r,n==null?1:n)}function di(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}MA(di,gE,wH(yx,{brighter(e){return e=e==null?Dw:Math.pow(Dw,e),new di(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ey:Math.pow(ey,e),new di(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new di(Xu(this.r),Xu(this.g),Xu(this.b),Iw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:nD,formatHex:nD,formatHex8:URe,formatRgb:sD,toString:sD}));function nD(){return`#${Du(this.r)}${Du(this.g)}${Du(this.b)}`}function URe(){return`#${Du(this.r)}${Du(this.g)}${Du(this.b)}${Du((isNaN(this.opacity)?1:this.opacity)*255)}`}function sD(){const e=Iw(this.opacity);return`${e===1?"rgb(":"rgba("}${Xu(this.r)}, ${Xu(this.g)}, ${Xu(this.b)}${e===1?")":`, ${e})`}`}function Iw(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Xu(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Du(e){return e=Xu(e),(e<16?"0":"")+e.toString(16)}function aD(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Oo(e,t,r,n)}function bH(e){if(e instanceof Oo)return new Oo(e.h,e.s,e.l,e.opacity);if(e instanceof yx||(e=ry(e)),!e)return new Oo;if(e instanceof Oo)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=NaN,l=i-a,c=(i+a)/2;return l?(t===i?o=(r-n)/l+(r<n)*6:r===i?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?i+a:2-i-a,o*=60):l=c>0&&c<1?0:o,new Oo(o,l,c,e.opacity)}function qRe(e,t,r,n){return arguments.length===1?bH(e):new Oo(e,t,r,n==null?1:n)}function Oo(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}MA(Oo,qRe,wH(yx,{brighter(e){return e=e==null?Dw:Math.pow(Dw,e),new Oo(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ey:Math.pow(ey,e),new Oo(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new di(wS(e>=240?e-240:e+120,a,n),wS(e,a,n),wS(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Oo(iD(this.h),O0(this.s),O0(this.l),Iw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Iw(this.opacity);return`${e===1?"hsl(":"hsla("}${iD(this.h)}, ${O0(this.s)*100}%, ${O0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function iD(e){return e=(e||0)%360,e<0?e+360:e}function O0(e){return Math.max(0,Math.min(1,e||0))}function wS(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const DA=e=>()=>e;function VRe(e,t){return function(r){return e+r*t}}function WRe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function HRe(e){return(e=+e)==1?jH:function(t,r){return r-t?WRe(t,r,e):DA(isNaN(t)?r:t)}}function jH(e,t){var r=t-e;return r?VRe(e,r):DA(isNaN(e)?t:e)}const oD=function e(t){var r=HRe(t);function n(a,i){var o=r((a=gE(a)).r,(i=gE(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),d=jH(a.opacity,i.opacity);return function(u){return a.r=o(u),a.g=l(u),a.b=c(u),a.opacity=d(u),a+""}}return n.gamma=e,n}(1);function GRe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function YRe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function KRe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=Op(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<n;++o)i[o]=a[o](l);return i}}function ZRe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function $w(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function XRe(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Op(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var vE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,bS=new RegExp(vE.source,"g");function JRe(e){return function(){return e}}function QRe(e){return function(t){return e(t)+""}}function eOe(e,t){var r=vE.lastIndex=bS.lastIndex=0,n,a,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=vE.exec(e))&&(a=bS.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:$w(n,a)})),r=bS.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?QRe(c[0].x):JRe(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function Op(e,t){var r=typeof t,n;return t==null||r==="boolean"?DA(t):(r==="number"?$w:r==="string"?(n=ry(t))?(t=n,oD):eOe:t instanceof ry?oD:t instanceof Date?ZRe:YRe(t)?GRe:Array.isArray(t)?KRe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?XRe:$w)(e,t)}function IA(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function tOe(e,t){t===void 0&&(t=e,e=Op);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[l](o-l)}}function rOe(e){return function(){return e}}function Lw(e){return+e}var lD=[0,1];function qa(e){return e}function yE(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:rOe(isNaN(t)?NaN:.5)}function nOe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function sOe(e,t,r){var n=e[0],a=e[1],i=t[0],o=t[1];return a<n?(n=yE(a,n),i=r(o,i)):(n=yE(n,a),i=r(i,o)),function(l){return i(n(l))}}function aOe(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=yE(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var c=vx(e,l,1,n)-1;return i[c](a[c](l))}}function xx(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function uj(){var e=lD,t=lD,r=Op,n,a,i,o=qa,l,c,d;function u(){var h=Math.min(e.length,t.length);return o!==qa&&(o=nOe(e[0],e[h-1])),l=h>2?aOe:sOe,c=d=null,f}function f(h){return h==null||isNaN(h=+h)?i:(c||(c=l(e.map(n),t,r)))(n(o(h)))}return f.invert=function(h){return o(a((d||(d=l(t,e.map(n),$w)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Lw),u()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),u()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=IA,u()},f.clamp=function(h){return arguments.length?(o=h?!0:qa,u()):o!==qa},f.interpolate=function(h){return arguments.length?(r=h,u()):r},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,p){return n=h,a=p,u()}}function $A(){return uj()(qa,qa)}function iOe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Fw(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Im(e){return e=Fw(Math.abs(e)),e?e[1]:NaN}function oOe(e,t){return function(r,n){for(var a=r.length,i=[],o=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function lOe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var cOe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ny(e){if(!(t=cOe.exec(e)))throw new Error("invalid format: "+e);var t;return new LA({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ny.prototype=LA.prototype;function LA(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}LA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function dOe(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var NH;function uOe(e,t){var r=Fw(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(NH=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Fw(e,Math.max(0,t+i-1))[0]}function cD(e,t){var r=Fw(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const dD={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:iOe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>cD(e*100,t),r:cD,s:uOe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function uD(e){return e}var hD=Array.prototype.map,fD=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function hOe(e){var t=e.grouping===void 0||e.thousands===void 0?uD:oOe(hD.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?uD:lOe(hD.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=ny(f);var h=f.fill,p=f.align,g=f.sign,v=f.symbol,y=f.zero,_=f.width,w=f.comma,b=f.precision,N=f.trim,S=f.type;S==="n"?(w=!0,S="g"):dD[S]||(b===void 0&&(b=12),N=!0,S="g"),(y||h==="0"&&p==="=")&&(y=!0,h="0",p="=");var k=v==="$"?r:v==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",P=v==="$"?n:/[%p]/.test(S)?o:"",A=dD[S],R=/[defgprs%]/.test(S);b=b===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function $(O){var z=k,D=P,B,F,U;if(S==="c")D=A(O)+D,O="";else{O=+O;var G=O<0||1/O<0;if(O=isNaN(O)?c:A(Math.abs(O),b),N&&(O=dOe(O)),G&&+O==0&&g!=="+"&&(G=!1),z=(G?g==="("?g:l:g==="-"||g==="("?"":g)+z,D=(S==="s"?fD[8+NH/3]:"")+D+(G&&g==="("?")":""),R){for(B=-1,F=O.length;++B<F;)if(U=O.charCodeAt(B),48>U||U>57){D=(U===46?a+O.slice(B+1):O.slice(B))+D,O=O.slice(0,B);break}}}w&&!y&&(O=t(O,1/0));var q=z.length+O.length+D.length,K=q<_?new Array(_-q+1).join(h):"";switch(w&&y&&(O=t(K+O,K.length?_-D.length:1/0),K=""),p){case"<":O=z+O+D+K;break;case"=":O=z+K+O+D;break;case"^":O=K.slice(0,q=K.length>>1)+z+O+D+K.slice(q);break;default:O=K+z+O+D;break}return i(O)}return $.toString=function(){return f+""},$}function u(f,h){var p=d((f=ny(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(Im(h)/3)))*3,v=Math.pow(10,-g),y=fD[8+g/3];return function(_){return p(v*_)+y}}return{format:d,formatPrefix:u}}var M0,FA,SH;fOe({thousands:",",grouping:[3],currency:["$",""]});function fOe(e){return M0=hOe(e),FA=M0.format,SH=M0.formatPrefix,M0}function mOe(e){return Math.max(0,-Im(Math.abs(e)))}function pOe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Im(t)/3)))*3-Im(Math.abs(e)))}function gOe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Im(t)-Im(e))+1}function kH(e,t,r,n){var a=mE(e,t,r),i;switch(n=ny(n==null?",f":n),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=pOe(a,o))&&(n.precision=i),SH(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=gOe(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=mOe(a))&&(n.precision=i-(n.type==="%")*2);break}}return FA(n)}function su(e){var t=e.domain;return e.ticks=function(r){var n=t();return hE(n[0],n[n.length-1],r==null?10:r)},e.tickFormat=function(r,n){var a=t();return kH(a[0],a[a.length-1],r==null?10:r,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,o=n[a],l=n[i],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=a,a=i,i=d);u-- >0;){if(d=fE(o,l,r),d===c)return n[a]=o,n[i]=l,t(n);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function zw(){var e=$A();return e.copy=function(){return xx(e,zw())},po.apply(e,arguments),su(e)}function EH(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Lw),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return EH(e).unknown(t)},e=arguments.length?Array.from(e,Lw):[0,1],su(r)}function CH(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),e[r]=t.floor(a),e[n]=t.ceil(i),e}function mD(e){return Math.log(e)}function pD(e){return Math.exp(e)}function vOe(e){return-Math.log(-e)}function yOe(e){return-Math.exp(-e)}function xOe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function _Oe(e){return e===10?xOe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function wOe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function gD(e){return(t,r)=>-e(-t,r)}function zA(e){const t=e(mD,pD),r=t.domain;let n=10,a,i;function o(){return a=wOe(n),i=_Oe(n),r()[0]<0?(a=gD(a),i=gD(i),e(vOe,yOe)):e(mD,pD),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let h=a(d),p=a(u),g,v;const y=l==null?10:+l;let _=[];if(!(n%1)&&p-h<y){if(h=Math.floor(h),p=Math.ceil(p),d>0){for(;h<=p;++h)for(g=1;g<n;++g)if(v=h<0?g/i(-h):g*i(h),!(v<d)){if(v>u)break;_.push(v)}}else for(;h<=p;++h)for(g=n-1;g>=1;--g)if(v=h>0?g/i(-h):g*i(h),!(v<d)){if(v>u)break;_.push(v)}_.length*2<y&&(_=hE(d,u,y))}else _=hE(h,p,Math.min(p-h,y)).map(i);return f?_.reverse():_},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=ny(c)).precision==null&&(c.trim=!0),c=FA(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return u=>{let f=u/i(Math.round(a(u)));return f*n<n-.5&&(f*=n),f<=d?c(u):""}},t.nice=()=>r(CH(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function PH(){const e=zA(uj()).domain([1,10]);return e.copy=()=>xx(e,PH()).base(e.base()),po.apply(e,arguments),e}function vD(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function yD(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function BA(e){var t=1,r=e(vD(t),yD(t));return r.constant=function(n){return arguments.length?e(vD(t=+n),yD(t)):t},su(r)}function TH(){var e=BA(uj());return e.copy=function(){return xx(e,TH()).constant(e.constant())},po.apply(e,arguments)}function xD(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function bOe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function jOe(e){return e<0?-e*e:e*e}function UA(e){var t=e(qa,qa),r=1;function n(){return r===1?e(qa,qa):r===.5?e(bOe,jOe):e(xD(r),xD(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},su(t)}function qA(){var e=UA(uj());return e.copy=function(){return xx(e,qA()).exponent(e.exponent())},po.apply(e,arguments),e}function NOe(){return qA.apply(null,arguments).exponent(.5)}function _D(e){return Math.sign(e)*e*e}function SOe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function AH(){var e=$A(),t=[0,1],r=!1,n;function a(i){var o=SOe(e(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return e.invert(_D(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Lw)).map(_D)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return AH(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},po.apply(a,arguments),su(a)}function RH(){var e=[],t=[],r=[],n;function a(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=TRe(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?n:t[vx(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Md),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return RH().domain(e).range(t).unknown(n)},po.apply(i,arguments)}function OH(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function o(c){return c!=null&&c<=c?a[vx(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var d=a.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return OH().domain([e,t]).range(a).unknown(i)},po.apply(su(o),arguments)}function MH(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[vx(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return MH().domain(e).range(t).unknown(r)},po.apply(a,arguments)}const jS=new Date,NS=new Date;function Ks(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),l=a.ceil(i);return i-o<l-i?o:l},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<o);return c},a.filter=i=>Ks(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>(jS.setTime(+i),NS.setTime(+o),e(jS),e(NS),Math.floor(r(jS,NS))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const Bw=Ks(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Bw.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ks(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Bw);Bw.range;const gc=1e3,ro=gc*60,vc=ro*60,Mc=vc*24,VA=Mc*7,wD=Mc*30,SS=Mc*365,Iu=Ks(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*gc)},(e,t)=>(t-e)/gc,e=>e.getUTCSeconds());Iu.range;const WA=Ks(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*gc)},(e,t)=>{e.setTime(+e+t*ro)},(e,t)=>(t-e)/ro,e=>e.getMinutes());WA.range;const HA=Ks(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ro)},(e,t)=>(t-e)/ro,e=>e.getUTCMinutes());HA.range;const GA=Ks(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*gc-e.getMinutes()*ro)},(e,t)=>{e.setTime(+e+t*vc)},(e,t)=>(t-e)/vc,e=>e.getHours());GA.range;const YA=Ks(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*vc)},(e,t)=>(t-e)/vc,e=>e.getUTCHours());YA.range;const _x=Ks(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ro)/Mc,e=>e.getDate()-1);_x.range;const hj=Ks(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Mc,e=>e.getUTCDate()-1);hj.range;const DH=Ks(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Mc,e=>Math.floor(e/Mc));DH.range;function Ah(e){return Ks(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*ro)/VA)}const fj=Ah(0),Uw=Ah(1),kOe=Ah(2),EOe=Ah(3),$m=Ah(4),COe=Ah(5),POe=Ah(6);fj.range;Uw.range;kOe.range;EOe.range;$m.range;COe.range;POe.range;function Rh(e){return Ks(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/VA)}const mj=Rh(0),qw=Rh(1),TOe=Rh(2),AOe=Rh(3),Lm=Rh(4),ROe=Rh(5),OOe=Rh(6);mj.range;qw.range;TOe.range;AOe.range;Lm.range;ROe.range;OOe.range;const KA=Ks(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());KA.range;const ZA=Ks(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());ZA.range;const Dc=Ks(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Dc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ks(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Dc.range;const Ic=Ks(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Ic.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ks(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Ic.range;function IH(e,t,r,n,a,i){const o=[[Iu,1,gc],[Iu,5,5*gc],[Iu,15,15*gc],[Iu,30,30*gc],[i,1,ro],[i,5,5*ro],[i,15,15*ro],[i,30,30*ro],[a,1,vc],[a,3,3*vc],[a,6,6*vc],[a,12,12*vc],[n,1,Mc],[n,2,2*Mc],[r,1,VA],[t,1,wD],[t,3,3*wD],[e,1,SS]];function l(d,u,f){const h=u<d;h&&([d,u]=[u,d]);const p=f&&typeof f.range=="function"?f:c(d,u,f),g=p?p.range(d,+u+1):[];return h?g.reverse():g}function c(d,u,f){const h=Math.abs(u-d)/f,p=RA(([,,y])=>y).right(o,h);if(p===o.length)return e.every(mE(d/SS,u/SS,f));if(p===0)return Bw.every(Math.max(mE(d,u,f),1));const[g,v]=o[h/o[p-1][2]<o[p][2]/h?p-1:p];return g.every(v)}return[l,c]}const[MOe,DOe]=IH(Ic,ZA,mj,DH,YA,HA),[IOe,$Oe]=IH(Dc,KA,fj,_x,GA,WA);function kS(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ES(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function wg(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function LOe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,d=bg(a),u=jg(a),f=bg(i),h=jg(i),p=bg(o),g=jg(o),v=bg(l),y=jg(l),_=bg(c),w=jg(c),b={a:G,A:q,b:K,B:Z,c:null,d:ED,e:ED,f:oMe,g:vMe,G:xMe,H:sMe,I:aMe,j:iMe,L:$H,m:lMe,M:cMe,p:Y,q:Q,Q:TD,s:AD,S:dMe,u:uMe,U:hMe,V:fMe,w:mMe,W:pMe,x:null,X:null,y:gMe,Y:yMe,Z:_Me,"%":PD},N={a:X,A:ne,b:re,B:ye,c:null,d:CD,e:CD,f:NMe,g:MMe,G:IMe,H:wMe,I:bMe,j:jMe,L:FH,m:SMe,M:kMe,p:ee,q:de,Q:TD,s:AD,S:EMe,u:CMe,U:PMe,V:TMe,w:AMe,W:RMe,x:null,X:null,y:OMe,Y:DMe,Z:$Me,"%":PD},S={a:$,A:O,b:z,B:D,c:B,d:SD,e:SD,f:eMe,g:ND,G:jD,H:kD,I:kD,j:ZOe,L:QOe,m:KOe,M:XOe,p:R,q:YOe,Q:rMe,s:nMe,S:JOe,u:qOe,U:VOe,V:WOe,w:UOe,W:HOe,x:F,X:U,y:ND,Y:jD,Z:GOe,"%":tMe};b.x=k(r,b),b.X=k(n,b),b.c=k(t,b),N.x=k(r,N),N.X=k(n,N),N.c=k(t,N);function k(xe,ie){return function(se){var V=[],ue=-1,_e=0,ae=xe.length,we,oe,ce;for(se instanceof Date||(se=new Date(+se));++ue<ae;)xe.charCodeAt(ue)===37&&(V.push(xe.slice(_e,ue)),(oe=bD[we=xe.charAt(++ue)])!=null?we=xe.charAt(++ue):oe=we==="e"?" ":"0",(ce=ie[we])&&(we=ce(se,oe)),V.push(we),_e=ue+1);return V.push(xe.slice(_e,ue)),V.join("")}}function P(xe,ie){return function(se){var V=wg(1900,void 0,1),ue=A(V,xe,se+="",0),_e,ae;if(ue!=se.length)return null;if("Q"in V)return new Date(V.Q);if("s"in V)return new Date(V.s*1e3+("L"in V?V.L:0));if(ie&&!("Z"in V)&&(V.Z=0),"p"in V&&(V.H=V.H%12+V.p*12),V.m===void 0&&(V.m="q"in V?V.q:0),"V"in V){if(V.V<1||V.V>53)return null;"w"in V||(V.w=1),"Z"in V?(_e=ES(wg(V.y,0,1)),ae=_e.getUTCDay(),_e=ae>4||ae===0?qw.ceil(_e):qw(_e),_e=hj.offset(_e,(V.V-1)*7),V.y=_e.getUTCFullYear(),V.m=_e.getUTCMonth(),V.d=_e.getUTCDate()+(V.w+6)%7):(_e=kS(wg(V.y,0,1)),ae=_e.getDay(),_e=ae>4||ae===0?Uw.ceil(_e):Uw(_e),_e=_x.offset(_e,(V.V-1)*7),V.y=_e.getFullYear(),V.m=_e.getMonth(),V.d=_e.getDate()+(V.w+6)%7)}else("W"in V||"U"in V)&&("w"in V||(V.w="u"in V?V.u%7:"W"in V?1:0),ae="Z"in V?ES(wg(V.y,0,1)).getUTCDay():kS(wg(V.y,0,1)).getDay(),V.m=0,V.d="W"in V?(V.w+6)%7+V.W*7-(ae+5)%7:V.w+V.U*7-(ae+6)%7);return"Z"in V?(V.H+=V.Z/100|0,V.M+=V.Z%100,ES(V)):kS(V)}}function A(xe,ie,se,V){for(var ue=0,_e=ie.length,ae=se.length,we,oe;ue<_e;){if(V>=ae)return-1;if(we=ie.charCodeAt(ue++),we===37){if(we=ie.charAt(ue++),oe=S[we in bD?ie.charAt(ue++):we],!oe||(V=oe(xe,se,V))<0)return-1}else if(we!=se.charCodeAt(V++))return-1}return V}function R(xe,ie,se){var V=d.exec(ie.slice(se));return V?(xe.p=u.get(V[0].toLowerCase()),se+V[0].length):-1}function $(xe,ie,se){var V=p.exec(ie.slice(se));return V?(xe.w=g.get(V[0].toLowerCase()),se+V[0].length):-1}function O(xe,ie,se){var V=f.exec(ie.slice(se));return V?(xe.w=h.get(V[0].toLowerCase()),se+V[0].length):-1}function z(xe,ie,se){var V=_.exec(ie.slice(se));return V?(xe.m=w.get(V[0].toLowerCase()),se+V[0].length):-1}function D(xe,ie,se){var V=v.exec(ie.slice(se));return V?(xe.m=y.get(V[0].toLowerCase()),se+V[0].length):-1}function B(xe,ie,se){return A(xe,t,ie,se)}function F(xe,ie,se){return A(xe,r,ie,se)}function U(xe,ie,se){return A(xe,n,ie,se)}function G(xe){return o[xe.getDay()]}function q(xe){return i[xe.getDay()]}function K(xe){return c[xe.getMonth()]}function Z(xe){return l[xe.getMonth()]}function Y(xe){return a[+(xe.getHours()>=12)]}function Q(xe){return 1+~~(xe.getMonth()/3)}function X(xe){return o[xe.getUTCDay()]}function ne(xe){return i[xe.getUTCDay()]}function re(xe){return c[xe.getUTCMonth()]}function ye(xe){return l[xe.getUTCMonth()]}function ee(xe){return a[+(xe.getUTCHours()>=12)]}function de(xe){return 1+~~(xe.getUTCMonth()/3)}return{format:function(xe){var ie=k(xe+="",b);return ie.toString=function(){return xe},ie},parse:function(xe){var ie=P(xe+="",!1);return ie.toString=function(){return xe},ie},utcFormat:function(xe){var ie=k(xe+="",N);return ie.toString=function(){return xe},ie},utcParse:function(xe){var ie=P(xe+="",!0);return ie.toString=function(){return xe},ie}}}var bD={"-":"",_:" ",0:"0"},oa=/^\s*\d+/,FOe=/^%/,zOe=/[\\^$*+?|[\]().{}]/g;function jn(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function BOe(e){return e.replace(zOe,"\\$&")}function bg(e){return new RegExp("^(?:"+e.map(BOe).join("|")+")","i")}function jg(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function UOe(e,t,r){var n=oa.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function qOe(e,t,r){var n=oa.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function VOe(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function WOe(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function HOe(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function jD(e,t,r){var n=oa.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function ND(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function GOe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function YOe(e,t,r){var n=oa.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function KOe(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function SD(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function ZOe(e,t,r){var n=oa.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function kD(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function XOe(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function JOe(e,t,r){var n=oa.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function QOe(e,t,r){var n=oa.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function eMe(e,t,r){var n=oa.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function tMe(e,t,r){var n=FOe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function rMe(e,t,r){var n=oa.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function nMe(e,t,r){var n=oa.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function ED(e,t){return jn(e.getDate(),t,2)}function sMe(e,t){return jn(e.getHours(),t,2)}function aMe(e,t){return jn(e.getHours()%12||12,t,2)}function iMe(e,t){return jn(1+_x.count(Dc(e),e),t,3)}function $H(e,t){return jn(e.getMilliseconds(),t,3)}function oMe(e,t){return $H(e,t)+"000"}function lMe(e,t){return jn(e.getMonth()+1,t,2)}function cMe(e,t){return jn(e.getMinutes(),t,2)}function dMe(e,t){return jn(e.getSeconds(),t,2)}function uMe(e){var t=e.getDay();return t===0?7:t}function hMe(e,t){return jn(fj.count(Dc(e)-1,e),t,2)}function LH(e){var t=e.getDay();return t>=4||t===0?$m(e):$m.ceil(e)}function fMe(e,t){return e=LH(e),jn($m.count(Dc(e),e)+(Dc(e).getDay()===4),t,2)}function mMe(e){return e.getDay()}function pMe(e,t){return jn(Uw.count(Dc(e)-1,e),t,2)}function gMe(e,t){return jn(e.getFullYear()%100,t,2)}function vMe(e,t){return e=LH(e),jn(e.getFullYear()%100,t,2)}function yMe(e,t){return jn(e.getFullYear()%1e4,t,4)}function xMe(e,t){var r=e.getDay();return e=r>=4||r===0?$m(e):$m.ceil(e),jn(e.getFullYear()%1e4,t,4)}function _Me(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+jn(t/60|0,"0",2)+jn(t%60,"0",2)}function CD(e,t){return jn(e.getUTCDate(),t,2)}function wMe(e,t){return jn(e.getUTCHours(),t,2)}function bMe(e,t){return jn(e.getUTCHours()%12||12,t,2)}function jMe(e,t){return jn(1+hj.count(Ic(e),e),t,3)}function FH(e,t){return jn(e.getUTCMilliseconds(),t,3)}function NMe(e,t){return FH(e,t)+"000"}function SMe(e,t){return jn(e.getUTCMonth()+1,t,2)}function kMe(e,t){return jn(e.getUTCMinutes(),t,2)}function EMe(e,t){return jn(e.getUTCSeconds(),t,2)}function CMe(e){var t=e.getUTCDay();return t===0?7:t}function PMe(e,t){return jn(mj.count(Ic(e)-1,e),t,2)}function zH(e){var t=e.getUTCDay();return t>=4||t===0?Lm(e):Lm.ceil(e)}function TMe(e,t){return e=zH(e),jn(Lm.count(Ic(e),e)+(Ic(e).getUTCDay()===4),t,2)}function AMe(e){return e.getUTCDay()}function RMe(e,t){return jn(qw.count(Ic(e)-1,e),t,2)}function OMe(e,t){return jn(e.getUTCFullYear()%100,t,2)}function MMe(e,t){return e=zH(e),jn(e.getUTCFullYear()%100,t,2)}function DMe(e,t){return jn(e.getUTCFullYear()%1e4,t,4)}function IMe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Lm(e):Lm.ceil(e),jn(e.getUTCFullYear()%1e4,t,4)}function $Me(){return"+0000"}function PD(){return"%"}function TD(e){return+e}function AD(e){return Math.floor(+e/1e3)}var nf,BH,UH;LMe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function LMe(e){return nf=LOe(e),BH=nf.format,nf.parse,UH=nf.utcFormat,nf.utcParse,nf}function FMe(e){return new Date(e)}function zMe(e){return e instanceof Date?+e:+new Date(+e)}function XA(e,t,r,n,a,i,o,l,c,d){var u=$A(),f=u.invert,h=u.domain,p=d(".%L"),g=d(":%S"),v=d("%I:%M"),y=d("%I %p"),_=d("%a %d"),w=d("%b %d"),b=d("%B"),N=d("%Y");function S(k){return(c(k)<k?p:l(k)<k?g:o(k)<k?v:i(k)<k?y:n(k)<k?a(k)<k?_:w:r(k)<k?b:N)(k)}return u.invert=function(k){return new Date(f(k))},u.domain=function(k){return arguments.length?h(Array.from(k,zMe)):h().map(FMe)},u.ticks=function(k){var P=h();return e(P[0],P[P.length-1],k==null?10:k)},u.tickFormat=function(k,P){return P==null?S:d(P)},u.nice=function(k){var P=h();return(!k||typeof k.range!="function")&&(k=t(P[0],P[P.length-1],k==null?10:k)),k?h(CH(P,k)):u},u.copy=function(){return xx(u,XA(e,t,r,n,a,i,o,l,c,d))},u}function BMe(){return po.apply(XA(IOe,$Oe,Dc,KA,fj,_x,GA,WA,Iu,BH).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function UMe(){return po.apply(XA(MOe,DOe,Ic,ZA,mj,hj,YA,HA,Iu,UH).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function pj(){var e=0,t=1,r,n,a,i,o=qa,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:o(a===0?.5:(f=(i(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(o=f,d):o};function u(f){return function(h){var p,g;return arguments.length?([p,g]=h,o=f(p,g),d):[o(0),o(1)]}}return d.range=u(Op),d.rangeRound=u(IA),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),d}}function au(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function qH(){var e=su(pj()(qa));return e.copy=function(){return au(e,qH())},qc.apply(e,arguments)}function VH(){var e=zA(pj()).domain([1,10]);return e.copy=function(){return au(e,VH()).base(e.base())},qc.apply(e,arguments)}function WH(){var e=BA(pj());return e.copy=function(){return au(e,WH()).constant(e.constant())},qc.apply(e,arguments)}function JA(){var e=UA(pj());return e.copy=function(){return au(e,JA()).exponent(e.exponent())},qc.apply(e,arguments)}function qMe(){return JA.apply(null,arguments).exponent(.5)}function HH(){var e=[],t=qa;function r(n){if(n!=null&&!isNaN(n=+n))return t((vx(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Md),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>PRe(e,i/n))},r.copy=function(){return HH(t).domain(e)},qc.apply(r,arguments)}function gj(){var e=0,t=.5,r=1,n=1,a,i,o,l,c,d=qa,u,f=!1,h;function p(v){return isNaN(v=+v)?h:(v=.5+((v=+u(v))-i)*(n*v<n*i?l:c),d(f?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t,r]=v,a=u(e=+e),i=u(t=+t),o=u(r=+r),l=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,p):[e,t,r]},p.clamp=function(v){return arguments.length?(f=!!v,p):f},p.interpolator=function(v){return arguments.length?(d=v,p):d};function g(v){return function(y){var _,w,b;return arguments.length?([_,w,b]=y,d=tOe(v,[_,w,b]),p):[d(0),d(.5),d(1)]}}return p.range=g(Op),p.rangeRound=g(IA),p.unknown=function(v){return arguments.length?(h=v,p):h},function(v){return u=v,a=v(e),i=v(t),o=v(r),l=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,p}}function GH(){var e=su(gj()(qa));return e.copy=function(){return au(e,GH())},qc.apply(e,arguments)}function YH(){var e=zA(gj()).domain([.1,1,10]);return e.copy=function(){return au(e,YH()).base(e.base())},qc.apply(e,arguments)}function KH(){var e=BA(gj());return e.copy=function(){return au(e,KH()).constant(e.constant())},qc.apply(e,arguments)}function QA(){var e=UA(gj());return e.copy=function(){return au(e,QA()).exponent(e.exponent())},qc.apply(e,arguments)}function VMe(){return QA.apply(null,arguments).exponent(.5)}const RD=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Qv,scaleDiverging:GH,scaleDivergingLog:YH,scaleDivergingPow:QA,scaleDivergingSqrt:VMe,scaleDivergingSymlog:KH,scaleIdentity:EH,scaleImplicit:pE,scaleLinear:zw,scaleLog:PH,scaleOrdinal:OA,scalePoint:nv,scalePow:qA,scaleQuantile:RH,scaleQuantize:OH,scaleRadial:AH,scaleSequential:qH,scaleSequentialLog:VH,scaleSequentialPow:JA,scaleSequentialQuantile:HH,scaleSequentialSqrt:qMe,scaleSequentialSymlog:WH,scaleSqrt:NOe,scaleSymlog:TH,scaleThreshold:MH,scaleTime:BMe,scaleUtc:UMe,tickFormat:kH},Symbol.toStringTag,{value:"Module"}));var WMe=jp;function HMe(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],o=t(i);if(o!=null&&(l===void 0?o===o&&!WMe(o):r(o,l)))var l=o,c=i}return c}var ZH=HMe;function GMe(e,t){return e>t}var YMe=GMe,KMe=ZH,ZMe=YMe,XMe=Rp;function JMe(e){return e&&e.length?KMe(e,XMe,ZMe):void 0}var QMe=JMe;const wd=yn(QMe);function e5e(e,t){return e<t}var t5e=e5e,r5e=ZH,n5e=t5e,s5e=Rp;function a5e(e){return e&&e.length?r5e(e,s5e,n5e):void 0}var i5e=a5e;const vj=yn(i5e);var o5e=fA,l5e=nu,c5e=sH,d5e=_i;function u5e(e,t){var r=d5e(e)?o5e:c5e;return r(e,l5e(t))}var h5e=u5e,f5e=rH,m5e=h5e;function p5e(e,t){return f5e(m5e(e,t),1)}var g5e=p5e;const v5e=yn(g5e);var y5e=CA;function x5e(e,t){return y5e(e,t)}var _5e=x5e;const Fm=yn(_5e);var Mp=1e9,w5e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},tR,ss=!0,ho="[DecimalError] ",Ju=ho+"Invalid argument: ",eR=ho+"Exponent out of range: ",Dp=Math.floor,_u=Math.pow,b5e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ti,Xs=1e7,Xn=7,XH=9007199254740991,Vw=Dp(XH/Xn),Zt={};Zt.absoluteValue=Zt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Zt.comparedTo=Zt.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Zt.decimalPlaces=Zt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Xn;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Zt.dividedBy=Zt.div=function(e){return jc(this,new this.constructor(e))};Zt.dividedToIntegerBy=Zt.idiv=function(e){var t=this,r=t.constructor;return Ln(jc(t,new r(e),0,1),r.precision)};Zt.equals=Zt.eq=function(e){return!this.cmp(e)};Zt.exponent=function(){return As(this)};Zt.greaterThan=Zt.gt=function(e){return this.cmp(e)>0};Zt.greaterThanOrEqualTo=Zt.gte=function(e){return this.cmp(e)>=0};Zt.isInteger=Zt.isint=function(){return this.e>this.d.length-2};Zt.isNegative=Zt.isneg=function(){return this.s<0};Zt.isPositive=Zt.ispos=function(){return this.s>0};Zt.isZero=function(){return this.s===0};Zt.lessThan=Zt.lt=function(e){return this.cmp(e)<0};Zt.lessThanOrEqualTo=Zt.lte=function(e){return this.cmp(e)<1};Zt.logarithm=Zt.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ti))throw Error(ho+"NaN");if(r.s<1)throw Error(ho+(r.s?"NaN":"-Infinity"));return r.eq(Ti)?new n(0):(ss=!1,t=jc(sy(r,i),sy(e,i),i),ss=!0,Ln(t,a))};Zt.minus=Zt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?eG(t,e):JH(t,(e.s=-e.s,e))};Zt.modulo=Zt.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(ho+"NaN");return r.s?(ss=!1,t=jc(r,e,0,1).times(e),ss=!0,r.minus(t)):Ln(new n(r),a)};Zt.naturalExponential=Zt.exp=function(){return QH(this)};Zt.naturalLogarithm=Zt.ln=function(){return sy(this)};Zt.negated=Zt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Zt.plus=Zt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?JH(t,e):eG(t,(e.s=-e.s,e))};Zt.precision=Zt.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ju+e);if(t=As(a)+1,n=a.d.length-1,r=n*Xn+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Zt.squareRoot=Zt.sqrt=function(){var e,t,r,n,a,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(ho+"NaN")}for(e=As(l),ss=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=Nl(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Dp((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(i=n,n=i.plus(jc(l,i,o+2)).times(.5),Nl(i.d).slice(0,o)===(t=Nl(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(Ln(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;o+=4}return ss=!0,Ln(n,r)};Zt.times=Zt.mul=function(e){var t,r,n,a,i,o,l,c,d,u=this,f=u.constructor,h=u.d,p=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,c=h.length,d=p.length,c<d&&(i=h,h=p,p=i,o=c,c=d,d=o),i=[],o=c+d,n=o;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+p[n]*h[a-n-1]+t,i[a--]=l%Xs|0,t=l/Xs|0;i[a]=(i[a]+t)%Xs|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,ss?Ln(e,f.precision):e};Zt.toDecimalPlaces=Zt.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:($l(e,0,Mp),t===void 0?t=n.rounding:$l(t,0,8),Ln(r,e+As(r)+1,t))};Zt.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=gh(n,!0):($l(e,0,Mp),t===void 0?t=a.rounding:$l(t,0,8),n=Ln(new a(n),e+1,t),r=gh(n,!0,e+1)),r};Zt.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?gh(a):($l(e,0,Mp),t===void 0?t=i.rounding:$l(t,0,8),n=Ln(new i(a),e+As(a)+1,t),r=gh(n.abs(),!1,e+As(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Zt.toInteger=Zt.toint=function(){var e=this,t=e.constructor;return Ln(new t(e),As(e)+1,t.rounding)};Zt.toNumber=function(){return+this};Zt.toPower=Zt.pow=function(e){var t,r,n,a,i,o,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(Ti);if(l=new c(l),!l.s){if(e.s<1)throw Error(ho+"Infinity");return l}if(l.eq(Ti))return l;if(n=c.precision,e.eq(Ti))return Ln(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,i=l.s,o){if((r=u<0?-u:u)<=XH){for(a=new c(Ti),t=Math.ceil(n/Xn+4),ss=!1;r%2&&(a=a.times(l),MD(a.d,t)),r=Dp(r/2),r!==0;)l=l.times(l),MD(l.d,t);return ss=!0,e.s<0?new c(Ti).div(a):Ln(a,n)}}else if(i<0)throw Error(ho+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,ss=!1,a=e.times(sy(l,n+d)),ss=!0,a=QH(a),a.s=i,a};Zt.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=As(a),n=gh(a,r<=i.toExpNeg||r>=i.toExpPos)):($l(e,1,Mp),t===void 0?t=i.rounding:$l(t,0,8),a=Ln(new i(a),e,t),r=As(a),n=gh(a,e<=r||r<=i.toExpNeg,e)),n};Zt.toSignificantDigits=Zt.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):($l(e,1,Mp),t===void 0?t=n.rounding:$l(t,0,8)),Ln(new n(r),e,t)};Zt.toString=Zt.valueOf=Zt.val=Zt.toJSON=Zt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=As(e),r=e.constructor;return gh(e,t<=r.toExpNeg||t>=r.toExpPos)};function JH(e,t){var r,n,a,i,o,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),ss?Ln(t,f):t;if(c=e.d,d=t.d,o=e.e,a=t.e,c=c.slice(),i=o-a,i){for(i<0?(n=c,i=-i,l=d.length):(n=d,a=o,l=c.length),o=Math.ceil(f/Xn),l=o>l?o+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,n=d,d=c,c=n),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/Xs|0,c[i]%=Xs;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,ss?Ln(t,f):t}function $l(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Ju+e)}function Nl(e){var t,r,n,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)n=e[t]+"",r=Xn-n.length,r&&(i+=id(r)),i+=n;o=e[t],n=o+"",r=Xn-n.length,r&&(i+=id(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var jc=function(){function e(n,a){var i,o=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+o,n[l]=i%Xs|0,o=i/Xs|0;return o&&n.unshift(o),n}function t(n,a,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*Xs+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var l,c,d,u,f,h,p,g,v,y,_,w,b,N,S,k,P,A,R=n.constructor,$=n.s==a.s?1:-1,O=n.d,z=a.d;if(!n.s)return new R(n);if(!a.s)throw Error(ho+"Division by zero");for(c=n.e-a.e,P=z.length,S=O.length,p=new R($),g=p.d=[],d=0;z[d]==(O[d]||0);)++d;if(z[d]>(O[d]||0)&&--c,i==null?w=i=R.precision:o?w=i+(As(n)-As(a))+1:w=i,w<0)return new R(0);if(w=w/Xn+2|0,d=0,P==1)for(u=0,z=z[0],w++;(d<S||u)&&w--;d++)b=u*Xs+(O[d]||0),g[d]=b/z|0,u=b%z|0;else{for(u=Xs/(z[0]+1)|0,u>1&&(z=e(z,u),O=e(O,u),P=z.length,S=O.length),N=P,v=O.slice(0,P),y=v.length;y<P;)v[y++]=0;A=z.slice(),A.unshift(0),k=z[0],z[1]>=Xs/2&&++k;do u=0,l=t(z,v,P,y),l<0?(_=v[0],P!=y&&(_=_*Xs+(v[1]||0)),u=_/k|0,u>1?(u>=Xs&&(u=Xs-1),f=e(z,u),h=f.length,y=v.length,l=t(f,v,h,y),l==1&&(u--,r(f,P<h?A:z,h))):(u==0&&(l=u=1),f=z.slice()),h=f.length,h<y&&f.unshift(0),r(v,f,y),l==-1&&(y=v.length,l=t(z,v,P,y),l<1&&(u++,r(v,P<y?A:z,y))),y=v.length):l===0&&(u++,v=[0]),g[d++]=u,l&&v[0]?v[y++]=O[N]||0:(v=[O[N]],y=1);while((N++<S||v[0]!==void 0)&&w--)}return g[0]||g.shift(),p.e=c,Ln(p,o?i+As(p)+1:i)}}();function QH(e,t){var r,n,a,i,o,l,c=0,d=0,u=e.constructor,f=u.precision;if(As(e)>16)throw Error(eR+As(e));if(!e.s)return new u(Ti);for(t==null?(ss=!1,l=f):l=t,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(n=Math.log(_u(2,d))/Math.LN10*2+5|0,l+=n,r=a=i=new u(Ti),u.precision=l;;){if(a=Ln(a.times(e),l),r=r.times(++c),o=i.plus(jc(a,r,l)),Nl(o.d).slice(0,l)===Nl(i.d).slice(0,l)){for(;d--;)i=Ln(i.times(i),l);return u.precision=f,t==null?(ss=!0,Ln(i,f)):i}i=o}}function As(e){for(var t=e.e*Xn,r=e.d[0];r>=10;r/=10)t++;return t}function CS(e,t,r){if(t>e.LN10.sd())throw ss=!0,r&&(e.precision=r),Error(ho+"LN10 precision limit exceeded");return Ln(new e(e.LN10),t)}function id(e){for(var t="";e--;)t+="0";return t}function sy(e,t){var r,n,a,i,o,l,c,d,u,f=1,h=10,p=e,g=p.d,v=p.constructor,y=v.precision;if(p.s<1)throw Error(ho+(p.s?"NaN":"-Infinity"));if(p.eq(Ti))return new v(0);if(t==null?(ss=!1,d=y):d=t,p.eq(10))return t==null&&(ss=!0),CS(v,d);if(d+=h,v.precision=d,r=Nl(g),n=r.charAt(0),i=As(p),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=Nl(p.d),n=r.charAt(0),f++;i=As(p),n>1?(p=new v("0."+r),i++):p=new v(n+"."+r.slice(1))}else return c=CS(v,d+2,y).times(i+""),p=sy(new v(n+"."+r.slice(1)),d-h).plus(c),v.precision=y,t==null?(ss=!0,Ln(p,y)):p;for(l=o=p=jc(p.minus(Ti),p.plus(Ti),d),u=Ln(p.times(p),d),a=3;;){if(o=Ln(o.times(u),d),c=l.plus(jc(o,new v(a),d)),Nl(c.d).slice(0,d)===Nl(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(CS(v,d+2,y).times(i+""))),l=jc(l,new v(f),d),v.precision=y,t==null?(ss=!0,Ln(l,y)):l;l=c,a+=2}}function OD(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Dp(r/Xn),e.d=[],n=(r+1)%Xn,r<0&&(n+=Xn),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Xn;n<a;)e.d.push(+t.slice(n,n+=Xn));t=t.slice(n),n=Xn-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),ss&&(e.e>Vw||e.e<-Vw))throw Error(eR+r)}else e.s=0,e.e=0,e.d=[0];return e}function Ln(e,t,r){var n,a,i,o,l,c,d,u,f=e.d;for(o=1,i=f[0];i>=10;i/=10)o++;if(n=t-o,n<0)n+=Xn,a=t,d=f[u=0];else{if(u=Math.ceil((n+1)/Xn),i=f.length,u>=i)return e;for(d=i=f[u],o=1;i>=10;i/=10)o++;n%=Xn,a=n-Xn+o}if(r!==void 0&&(i=_u(10,o-a-1),l=d/i%10|0,c=t<0||f[u+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?d/_u(10,o-a):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=As(e),f.length=1,t=t-i-1,f[0]=_u(10,(Xn-t%Xn)%Xn),e.e=Dp(-t/Xn)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=u,i=1,u--):(f.length=u+1,i=_u(10,Xn-n),f[u]=a>0?(d/_u(10,o-a)%_u(10,a)|0)*i:0),c)for(;;)if(u==0){(f[0]+=i)==Xs&&(f[0]=1,++e.e);break}else{if(f[u]+=i,f[u]!=Xs)break;f[u--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(ss&&(e.e>Vw||e.e<-Vw))throw Error(eR+As(e));return e}function eG(e,t){var r,n,a,i,o,l,c,d,u,f,h=e.constructor,p=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),ss?Ln(t,p):t;if(c=e.d,f=t.d,n=t.e,d=e.e,c=c.slice(),o=d-n,o){for(u=o<0,u?(r=c,o=-o,l=f.length):(r=f,n=d,l=c.length),a=Math.max(Math.ceil(p/Xn),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,u=a<l,u&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){u=c[a]<f[a];break}o=0}for(u&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>o;){if(c[--a]<f[a]){for(i=a;i&&c[--i]===0;)c[i]=Xs-1;--c[i],c[a]+=Xs}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,ss?Ln(t,p):t):new h(0)}function gh(e,t,r){var n,a=As(e),i=Nl(e.d),o=i.length;return t?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+id(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+id(-a-1)+i,r&&(n=r-o)>0&&(i+=id(n))):a>=o?(i+=id(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+id(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=id(n))),e.s<0?"-"+i:i}function MD(e,t){if(e.length>t)return e.length=t,!0}function tG(e){var t,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Ju+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return OD(o,i.toString())}else if(typeof i!="string")throw Error(Ju+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,b5e.test(i))OD(o,i);else throw Error(Ju+i)}if(a.prototype=Zt,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=tG,a.config=a.set=j5e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function j5e(e){if(!e||typeof e!="object")throw Error(ho+"Object expected");var t,r,n,a=["precision",1,Mp,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Dp(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Ju+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Ju+r+": "+n);return this}var tR=tG(w5e);Ti=new tR(1);const Rn=tR;function N5e(e){return C5e(e)||E5e(e)||k5e(e)||S5e()}function S5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k5e(e,t){if(e){if(typeof e=="string")return xE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xE(e,t)}}function E5e(e){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function C5e(e){if(Array.isArray(e))return xE(e)}function xE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var P5e=function(t){return t},rG={"@@functional/placeholder":!0},nG=function(t){return t===rG},DD=function(t){return function r(){return arguments.length===0||arguments.length===1&&nG(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},T5e=function e(t,r){return t===1?r:DD(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=a.filter(function(l){return l!==rG}).length;return o>=t?r.apply(void 0,a):e(t-o,DD(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=a.map(function(f){return nG(f)?c.shift():f});return r.apply(void 0,N5e(u).concat(c))}))})},yj=function(t){return T5e(t.length,t)},_E=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},A5e=yj(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),R5e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return P5e;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},wE=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},sG=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r&&i.every(function(l,c){return l===r[c]})||(r=i,n=t.apply(void 0,i)),n}};function O5e(e){var t;return e===0?t=1:t=Math.floor(new Rn(e).abs().log(10).toNumber())+1,t}function M5e(e,t,r){for(var n=new Rn(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var D5e=yj(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),I5e=yj(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),$5e=yj(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const xj={rangeStep:M5e,getDigitCount:O5e,interpolateNumber:D5e,uninterpolateNumber:I5e,uninterpolateTruncation:$5e};function bE(e){return z5e(e)||F5e(e)||aG(e)||L5e()}function L5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function F5e(e){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function z5e(e){if(Array.isArray(e))return jE(e)}function ay(e,t){return q5e(e)||U5e(e,t)||aG(e,t)||B5e()}function B5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aG(e,t){if(e){if(typeof e=="string")return jE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jE(e,t)}}function jE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function U5e(e,t){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var o=e[Symbol.iterator](),l;!(n=(l=o.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){a=!0,i=c}finally{try{!n&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function q5e(e){if(Array.isArray(e))return e}function iG(e){var t=ay(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function oG(e,t,r){if(e.lte(0))return new Rn(0);var n=xj.getDigitCount(e.toNumber()),a=new Rn(10).pow(n),i=e.div(a),o=n!==1?.05:.1,l=new Rn(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return t?c:new Rn(Math.ceil(c))}function V5e(e,t,r){var n=1,a=new Rn(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new Rn(10).pow(xj.getDigitCount(e)-1),a=new Rn(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new Rn(Math.floor(e)))}else e===0?a=new Rn(Math.floor((t-1)/2)):r||(a=new Rn(Math.floor(e)));var o=Math.floor((t-1)/2),l=R5e(A5e(function(c){return a.add(new Rn(c-o).mul(n)).toNumber()}),_E);return l(0,t)}function lG(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Rn(0),tickMin:new Rn(0),tickMax:new Rn(0)};var i=oG(new Rn(t).sub(e).div(r-1),n,a),o;e<=0&&t>=0?o=new Rn(0):(o=new Rn(e).add(t).div(2),o=o.sub(new Rn(o).mod(i)));var l=Math.ceil(o.sub(e).div(i).toNumber()),c=Math.ceil(new Rn(t).sub(o).div(i).toNumber()),d=l+c+1;return d>r?lG(e,t,r,n,a+1):(d<r&&(c=t>0?c+(r-d):c,l=t>0?l:l+(r-d)),{step:i,tickMin:o.sub(new Rn(l).mul(i)),tickMax:o.add(new Rn(c).mul(i))})}function W5e(e){var t=ay(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),l=iG([r,n]),c=ay(l,2),d=c[0],u=c[1];if(d===-1/0||u===1/0){var f=u===1/0?[d].concat(bE(_E(0,a-1).map(function(){return 1/0}))):[].concat(bE(_E(0,a-1).map(function(){return-1/0})),[u]);return r>n?wE(f):f}if(d===u)return V5e(d,a,i);var h=lG(d,u,o,i),p=h.step,g=h.tickMin,v=h.tickMax,y=xj.rangeStep(g,v.add(new Rn(.1).mul(p)),p);return r>n?wE(y):y}function H5e(e,t){var r=ay(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=iG([n,a]),l=ay(o,2),c=l[0],d=l[1];if(c===-1/0||d===1/0)return[n,a];if(c===d)return[c];var u=Math.max(t,2),f=oG(new Rn(d).sub(c).div(u-1),i,0),h=[].concat(bE(xj.rangeStep(new Rn(c),new Rn(d).sub(new Rn(.99).mul(f)),f)),[d]);return n>a?wE(h):h}var G5e=sG(W5e),Y5e=sG(H5e),K5e="Invariant failed";function vh(e,t){throw new Error(K5e)}var Z5e=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function zm(e){"@babel/helpers - typeof";return zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zm(e)}function Ww(){return Ww=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ww.apply(this,arguments)}function X5e(e,t){return t4e(e)||e4e(e,t)||Q5e(e,t)||J5e()}function J5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q5e(e,t){if(e){if(typeof e=="string")return ID(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ID(e,t)}}function ID(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function e4e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function t4e(e){if(Array.isArray(e))return e}function r4e(e,t){if(e==null)return{};var r=n4e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function n4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function s4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a4e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uG(n.key),n)}}function i4e(e,t,r){return t&&a4e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function o4e(e,t,r){return t=Hw(t),l4e(e,cG()?Reflect.construct(t,r||[],Hw(e).constructor):t.apply(e,r))}function l4e(e,t){if(t&&(zm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c4e(e)}function c4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(cG=function(){return!!e})()}function Hw(e){return Hw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hw(e)}function d4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NE(e,t)}function NE(e,t){return NE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},NE(e,t)}function dG(e,t,r){return t=uG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uG(e){var t=u4e(e,"string");return zm(t)=="symbol"?t:t+""}function u4e(e,t){if(zm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wx=function(e){function t(){return s4e(this,t),o4e(this,t,arguments)}return d4e(t,e),i4e(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,o=n.width,l=n.dataKey,c=n.data,d=n.dataPointFormatter,u=n.xAxis,f=n.yAxis,h=r4e(n,Z5e),p=Fr(h,!1);this.props.direction==="x"&&u.type!=="number"&&vh();var g=c.map(function(v){var y=d(v,l),_=y.x,w=y.y,b=y.value,N=y.errorVal;if(!N)return null;var S=[],k,P;if(Array.isArray(N)){var A=X5e(N,2);k=A[0],P=A[1]}else k=P=N;if(i==="vertical"){var R=u.scale,$=w+a,O=$+o,z=$-o,D=R(b-k),B=R(b+P);S.push({x1:B,y1:O,x2:B,y2:z}),S.push({x1:D,y1:$,x2:B,y2:$}),S.push({x1:D,y1:O,x2:D,y2:z})}else if(i==="horizontal"){var F=f.scale,U=_+a,G=U-o,q=U+o,K=F(b-k),Z=F(b+P);S.push({x1:G,y1:Z,x2:q,y2:Z}),S.push({x1:U,y1:K,x2:U,y2:Z}),S.push({x1:G,y1:K,x2:q,y2:K})}return J.createElement(qn,Ww({className:"recharts-errorBar",key:"bar-".concat(S.map(function(Y){return"".concat(Y.x1,"-").concat(Y.x2,"-").concat(Y.y1,"-").concat(Y.y2)}))},p),S.map(function(Y){return J.createElement("line",Ww({},Y,{key:"line-".concat(Y.x1,"-").concat(Y.x2,"-").concat(Y.y1,"-").concat(Y.y2)}))}))});return J.createElement(qn,{className:"recharts-errorBars"},g)}}])}(J.Component);dG(wx,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});dG(wx,"displayName","ErrorBar");function iy(e){"@babel/helpers - typeof";return iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iy(e)}function $D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$D(Object(r),!0).forEach(function(n){h4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$D(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function h4e(e,t,r){return t=f4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f4e(e){var t=m4e(e,"string");return iy(t)=="symbol"?t:t+""}function m4e(e,t){if(iy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hG=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,o=Ci(r,Zu);if(!o)return null;var l=Zu.defaultProps,c=l!==void 0?hu(hu({},l),o.props):{},d;return o.props&&o.props.payload?d=o.props&&o.props.payload:i==="children"?d=(n||[]).reduce(function(u,f){var h=f.item,p=f.props,g=p.sectors||p.data||[];return u.concat(g.map(function(v){return{type:o.props.iconType||h.props.legendType,value:v.name,color:v.fill,payload:v}}))},[]):d=(n||[]).map(function(u){var f=u.item,h=f.type.defaultProps,p=h!==void 0?hu(hu({},h),f.props):{},g=p.dataKey,v=p.name,y=p.legendType,_=p.hide;return{inactive:_,dataKey:g,type:c.iconType||y||"square",color:rR(f),value:v||g,payload:p}}),hu(hu(hu({},c),Zu.getWithHeight(o,a)),{},{payload:d,item:o})};function oy(e){"@babel/helpers - typeof";return oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oy(e)}function LD(e){return y4e(e)||v4e(e)||g4e(e)||p4e()}function p4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g4e(e,t){if(e){if(typeof e=="string")return SE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SE(e,t)}}function v4e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function y4e(e){if(Array.isArray(e))return SE(e)}function SE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FD(Object(r),!0).forEach(function(n){Qf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qf(e,t,r){return t=x4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x4e(e){var t=_4e(e,"string");return oy(t)=="symbol"?t:t+""}function _4e(e,t){if(oy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ha(e,t,r){return Yr(e)||Yr(t)?r:Ws(t)?io(e,t,r):Ir(t)?t(e):r}function sv(e,t,r,n){var a=v5e(e,function(l){return Ha(l,t)});if(r==="number"){var i=a.filter(function(l){return Nt(l)||parseFloat(l)});return i.length?[vj(i),wd(i)]:[1/0,-1/0]}var o=n?a.filter(function(l){return!Yr(l)}):a;return o.map(function(l){return Ws(l)||l instanceof Date?l:""})}var w4e=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,l=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,d=0;d<l;d++){var u=d>0?a[d-1].coordinate:a[l-1].coordinate,f=a[d].coordinate,h=d>=l-1?a[0].coordinate:a[d+1].coordinate,p=void 0;if(Lo(f-u)!==Lo(h-f)){var g=[];if(Lo(h-f)===Lo(c[1]-c[0])){p=h;var v=f+c[1]-c[0];g[0]=Math.min(v,(v+u)/2),g[1]=Math.max(v,(v+u)/2)}else{p=u;var y=h+c[1]-c[0];g[0]=Math.min(f,(y+f)/2),g[1]=Math.max(f,(y+f)/2)}var _=[Math.min(f,(p+f)/2),Math.max(f,(p+f)/2)];if(t>_[0]&&t<=_[1]||t>=g[0]&&t<=g[1]){o=a[d].index;break}}else{var w=Math.min(u,h),b=Math.max(u,h);if(t>(w+f)/2&&t<=(b+f)/2){o=a[d].index;break}}}else for(var N=0;N<l;N++)if(N===0&&t<=(n[N].coordinate+n[N+1].coordinate)/2||N>0&&N<l-1&&t>(n[N].coordinate+n[N-1].coordinate)/2&&t<=(n[N].coordinate+n[N+1].coordinate)/2||N===l-1&&t>(n[N].coordinate+n[N-1].coordinate)/2){o=n[N].index;break}return o},rR=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?fs(fs({},t.type.defaultProps),t.props):t.props,o=i.stroke,l=i.fill,c;switch(a){case"Line":c=o;break;case"Area":case"Radar":c=o&&o!=="none"?o:l;break;default:c=l;break}return c},b4e=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var o={},l=Object.keys(i),c=0,d=l.length;c<d;c++)for(var u=i[l[c]].stackGroups,f=Object.keys(u),h=0,p=f.length;h<p;h++){var g=u[f[h]],v=g.items,y=g.cateAxisId,_=v.filter(function(P){return wc(P.type).indexOf("Bar")>=0});if(_&&_.length){var w=_[0].type.defaultProps,b=w!==void 0?fs(fs({},w),_[0].props):_[0].props,N=b.barSize,S=b[y];o[S]||(o[S]=[]);var k=Yr(N)?r:N;o[S].push({item:_[0],stackList:_.slice(1),barSize:Yr(k)?void 0:ph(k,n,0)})}}return o},j4e=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,l=t.maxBarSize,c=o.length;if(c<1)return null;var d=ph(r,a,0,!0),u,f=[];if(o[0].barSize===+o[0].barSize){var h=!1,p=a/c,g=o.reduce(function(N,S){return N+S.barSize||0},0);g+=(c-1)*d,g>=a&&(g-=(c-1)*d,d=0),g>=a&&p>0&&(h=!0,p*=.9,g=c*p);var v=(a-g)/2>>0,y={offset:v-d,size:0};u=o.reduce(function(N,S){var k={item:S.item,position:{offset:y.offset+y.size+d,size:h?p:S.barSize}},P=[].concat(LD(N),[k]);return y=P[P.length-1].position,S.stackList&&S.stackList.length&&S.stackList.forEach(function(A){P.push({item:A,position:y})}),P},f)}else{var _=ph(n,a,0,!0);a-2*_-(c-1)*d<=0&&(d=0);var w=(a-2*_-(c-1)*d)/c;w>1&&(w>>=0);var b=l===+l?Math.min(w,l):w;u=o.reduce(function(N,S,k){var P=[].concat(LD(N),[{item:S.item,position:{offset:_+(w+d)*k+(w-b)/2,size:b}}]);return S.stackList&&S.stackList.length&&S.stackList.forEach(function(A){P.push({item:A,position:P[P.length-1].position})}),P},f)}return u},N4e=function(t,r,n,a){var i=n.children,o=n.width,l=n.margin,c=o-(l.left||0)-(l.right||0),d=hG({children:i,legendWidth:c});if(d){var u=a||{},f=u.width,h=u.height,p=d.align,g=d.verticalAlign,v=d.layout;if((v==="vertical"||v==="horizontal"&&g==="middle")&&p!=="center"&&Nt(t[p]))return fs(fs({},t),{},Qf({},p,t[p]+(f||0)));if((v==="horizontal"||v==="vertical"&&p==="center")&&g!=="middle"&&Nt(t[g]))return fs(fs({},t),{},Qf({},g,t[g]+(h||0)))}return t},S4e=function(t,r,n){return Yr(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},fG=function(t,r,n,a,i){var o=r.props.children,l=oo(o,wx).filter(function(d){return S4e(a,i,d.props.direction)});if(l&&l.length){var c=l.map(function(d){return d.props.dataKey});return t.reduce(function(d,u){var f=Ha(u,n);if(Yr(f))return d;var h=Array.isArray(f)?[vj(f),wd(f)]:[f,f],p=c.reduce(function(g,v){var y=Ha(u,v,0),_=h[0]-Math.abs(Array.isArray(y)?y[0]:y),w=h[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(_,g[0]),Math.max(w,g[1])]},[1/0,-1/0]);return[Math.min(p[0],d[0]),Math.max(p[1],d[1])]},[1/0,-1/0])}return null},k4e=function(t,r,n,a,i){var o=r.map(function(l){return fG(t,l,n,i,a)}).filter(function(l){return!Yr(l)});return o&&o.length?o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},mG=function(t,r,n,a,i){var o=r.map(function(c){var d=c.props.dataKey;return n==="number"&&d&&fG(t,c,d,a)||sv(t,d,n,i)});if(n==="number")return o.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);var l={};return o.reduce(function(c,d){for(var u=0,f=d.length;u<f;u++)l[d[u]]||(l[d[u]]=!0,c.push(d[u]));return c},[])},pG=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},gG=function(t,r,n,a){if(a)return t.map(function(c){return c.coordinate});var i,o,l=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===n&&(o=!0),c.coordinate});return i||l.push(r),o||l.push(n),l},yc=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,o=t.type,l=t.range,c=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,d=(r||n)&&o==="category"&&a.bandwidth?a.bandwidth()/c:0;if(d=t.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?Lo(l[0]-l[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(f){var h=i?i.indexOf(f):f;return{coordinate:a(h)+d,value:f,offset:d}});return u.filter(function(f){return!Cp(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,h){return{coordinate:a(f)+d,value:f,index:h,offset:d}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(f){return{coordinate:a(f)+d,value:f,offset:d}}):a.domain().map(function(f,h){return{coordinate:a(f)+d,value:i?i[f]:f,index:h,offset:d}})},PS=new WeakMap,D0=function(t,r){if(typeof r!="function")return t;PS.has(t)||PS.set(t,new WeakMap);var n=PS.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},E4e=function(t,r,n){var a=t.scale,i=t.type,o=t.layout,l=t.axisType;if(a==="auto")return o==="radial"&&l==="radiusAxis"?{scale:Qv(),realScaleType:"band"}:o==="radial"&&l==="angleAxis"?{scale:zw(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:nv(),realScaleType:"point"}:i==="category"?{scale:Qv(),realScaleType:"band"}:{scale:zw(),realScaleType:"linear"};if(mh(a)){var c="scale".concat(sj(a));return{scale:(RD[c]||nv)(),realScaleType:RD[c]?c:"point"}}return Ir(a)?{scale:a}:{scale:nv(),realScaleType:"point"}},zD=1e-4,C4e=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-zD,o=Math.max(a[0],a[1])+zD,l=t(r[0]),c=t(r[n-1]);(l<i||l>o||c<i||c>o)&&t.domain([r[0],r[n-1]])}},P4e=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},T4e=function(t,r){if(!r||r.length!==2||!Nt(r[0])||!Nt(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!Nt(t[0])||t[0]<n)&&(i[0]=n),(!Nt(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},A4e=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0,l=0;l<r;++l){var c=Cp(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=i,t[l][n][1]=i+c,i=t[l][n][1]):(t[l][n][0]=o,t[l][n][1]=o+c,o=t[l][n][1])}},R4e=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0;o<r;++o){var l=Cp(t[o][n][1])?t[o][n][0]:t[o][n][1];l>=0?(t[o][n][0]=i,t[o][n][1]=i+l,i=t[o][n][1]):(t[o][n][0]=0,t[o][n][1]=0)}},O4e={sign:A4e,expand:Yje,none:Am,silhouette:Kje,wiggle:Zje,positive:R4e},M4e=function(t,r,n){var a=r.map(function(l){return l.props.dataKey}),i=O4e[n],o=Gje().keys(a).value(function(l,c){return+Ha(l,c,0)}).order(Z2).offset(i);return o(t)},D4e=function(t,r,n,a,i,o){if(!t)return null;var l=o?r.reverse():r,c={},d=l.reduce(function(f,h){var p,g=(p=h.type)!==null&&p!==void 0&&p.defaultProps?fs(fs({},h.type.defaultProps),h.props):h.props,v=g.stackId,y=g.hide;if(y)return f;var _=g[n],w=f[_]||{hasStack:!1,stackGroups:{}};if(Ws(v)){var b=w.stackGroups[v]||{numericAxisId:n,cateAxisId:a,items:[]};b.items.push(h),w.hasStack=!0,w.stackGroups[v]=b}else w.stackGroups[Pp("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[h]};return fs(fs({},f),{},Qf({},_,w))},c),u={};return Object.keys(d).reduce(function(f,h){var p=d[h];if(p.hasStack){var g={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(v,y){var _=p.stackGroups[y];return fs(fs({},v),{},Qf({},y,{numericAxisId:n,cateAxisId:a,items:_.items,stackedData:M4e(t,_.items,i)}))},g)}return fs(fs({},f),{},Qf({},h,p))},u)},I4e=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,o=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var d=t.domain();if(!d.length)return null;var u=G5e(d,i,l);return t.domain([vj(u),wd(u)]),{niceTicks:u}}if(i&&a==="number"){var f=t.domain(),h=Y5e(f,i,l);return{niceTicks:h}}return null};function Gw(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,o=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Yr(a[t.dataKey])){var l=vw(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=Ha(a,Yr(o)?t.dataKey:o);return Yr(c)?null:t.scale(c)}var BD=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,o=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+a:null;var c=Ha(o,r.dataKey,r.domain[l]);return Yr(c)?null:r.scale(c)-i/2+a},$4e=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},L4e=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?fs(fs({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(Ws(i)){var o=r[i];if(o){var l=o.items.indexOf(t);return l>=0?o.stackedData[l]:null}}return null},F4e=function(t){return t.reduce(function(r,n){return[vj(n.concat([r[0]]).filter(Nt)),wd(n.concat([r[1]]).filter(Nt))]},[1/0,-1/0])},vG=function(t,r,n){return Object.keys(t).reduce(function(a,i){var o=t[i],l=o.stackedData,c=l.reduce(function(d,u){var f=F4e(u.slice(r,n+1));return[Math.min(d[0],f[0]),Math.max(d[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},UD=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,qD=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,kE=function(t,r,n){if(Ir(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(Nt(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(UD.test(t[0])){var i=+UD.exec(t[0])[1];a[0]=r[0]-i}else Ir(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Nt(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(qD.test(t[1])){var o=+qD.exec(t[1])[1];a[1]=r[1]+o}else Ir(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},Yw=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=TA(r,function(f){return f.coordinate}),o=1/0,l=1,c=i.length;l<c;l++){var d=i[l],u=i[l-1];o=Math.min((d.coordinate||0)-(u.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},VD=function(t,r,n){return!t||!t.length||Fm(t,io(n,"type.defaultProps.domain"))?r:t},yG=function(t,r){var n=t.type.defaultProps?fs(fs({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,o=n.unit,l=n.formatter,c=n.tooltipType,d=n.chartType,u=n.hide;return fs(fs({},Fr(t,!1)),{},{dataKey:a,unit:o,formatter:l,name:i||a,color:rR(t),value:Ha(r,a),type:c,payload:r,chartType:d,hide:u})};function ly(e){"@babel/helpers - typeof";return ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ly(e)}function WD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function HD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WD(Object(r),!0).forEach(function(n){z4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z4e(e,t,r){return t=B4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B4e(e){var t=U4e(e,"string");return ly(t)=="symbol"?t:t+""}function U4e(e,t){if(ly(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ly(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kw=Math.PI/180,q4e=function(t){return t*180/Math.PI},ma=function(t,r,n,a){return{x:t+Math.cos(-Kw*a)*n,y:r+Math.sin(-Kw*a)*n}},V4e=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-o,2))},W4e=function(t,r){var n=t.x,a=t.y,i=r.cx,o=r.cy,l=V4e({x:n,y:a},{x:i,y:o});if(l<=0)return{radius:l};var c=(n-i)/l,d=Math.acos(c);return a>o&&(d=2*Math.PI-d),{radius:l,angle:q4e(d),angleInRadian:d}},H4e=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return{startAngle:r-o*360,endAngle:n-o*360}},G4e=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),o=Math.floor(a/360),l=Math.min(i,o);return t+l*360},GD=function(t,r){var n=t.x,a=t.y,i=W4e({x:n,y:a},r),o=i.radius,l=i.angle,c=r.innerRadius,d=r.outerRadius;if(o<c||o>d)return!1;if(o===0)return!0;var u=H4e(r),f=u.startAngle,h=u.endAngle,p=l,g;if(f<=h){for(;p>h;)p-=360;for(;p<f;)p+=360;g=p>=f&&p<=h}else{for(;p>f;)p-=360;for(;p<h;)p+=360;g=p>=h&&p<=f}return g?HD(HD({},r),{},{radius:o,angle:G4e(p,r)}):null};function cy(e){"@babel/helpers - typeof";return cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cy(e)}var Y4e=["offset"];function K4e(e){return Q4e(e)||J4e(e)||X4e(e)||Z4e()}function Z4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X4e(e,t){if(e){if(typeof e=="string")return EE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EE(e,t)}}function J4e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Q4e(e){if(Array.isArray(e))return EE(e)}function EE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function e3e(e,t){if(e==null)return{};var r=t3e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function t3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function YD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YD(Object(r),!0).forEach(function(n){r3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r3e(e,t,r){return t=n3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n3e(e){var t=s3e(e,"string");return cy(t)=="symbol"?t:t+""}function s3e(e,t){if(cy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dy(){return dy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dy.apply(this,arguments)}var a3e=function(t){var r=t.value,n=t.formatter,a=Yr(t.children)?r:t.children;return Ir(n)?n(a):a},i3e=function(t,r){var n=Lo(r-t),a=Math.min(Math.abs(r-t),360);return n*a},o3e=function(t,r,n){var a=t.position,i=t.viewBox,o=t.offset,l=t.className,c=i,d=c.cx,u=c.cy,f=c.innerRadius,h=c.outerRadius,p=c.startAngle,g=c.endAngle,v=c.clockWise,y=(f+h)/2,_=i3e(p,g),w=_>=0?1:-1,b,N;a==="insideStart"?(b=p+w*o,N=v):a==="insideEnd"?(b=g-w*o,N=!v):a==="end"&&(b=g+w*o,N=v),N=_<=0?N:!N;var S=ma(d,u,y,b),k=ma(d,u,y,b+(N?1:-1)*359),P="M".concat(S.x,",").concat(S.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(N?0:1,`,
    `).concat(k.x,",").concat(k.y),A=Yr(t.id)?Pp("recharts-radial-line-"):t.id;return J.createElement("text",dy({},n,{dominantBaseline:"central",className:an("recharts-radial-bar-label",l)}),J.createElement("defs",null,J.createElement("path",{id:A,d:P})),J.createElement("textPath",{xlinkHref:"#".concat(A)},r))},l3e=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,o=i.cx,l=i.cy,c=i.innerRadius,d=i.outerRadius,u=i.startAngle,f=i.endAngle,h=(u+f)/2;if(a==="outside"){var p=ma(o,l,d+n,h),g=p.x,v=p.y;return{x:g,y:v,textAnchor:g>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"end"};var y=(c+d)/2,_=ma(o,l,y,h),w=_.x,b=_.y;return{x:w,y:b,textAnchor:"middle",verticalAnchor:"middle"}},c3e=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,o=r,l=o.x,c=o.y,d=o.width,u=o.height,f=u>=0?1:-1,h=f*a,p=f>0?"end":"start",g=f>0?"start":"end",v=d>=0?1:-1,y=v*a,_=v>0?"end":"start",w=v>0?"start":"end";if(i==="top"){var b={x:l+d/2,y:c-f*a,textAnchor:"middle",verticalAnchor:p};return $s($s({},b),n?{height:Math.max(c-n.y,0),width:d}:{})}if(i==="bottom"){var N={x:l+d/2,y:c+u+h,textAnchor:"middle",verticalAnchor:g};return $s($s({},N),n?{height:Math.max(n.y+n.height-(c+u),0),width:d}:{})}if(i==="left"){var S={x:l-y,y:c+u/2,textAnchor:_,verticalAnchor:"middle"};return $s($s({},S),n?{width:Math.max(S.x-n.x,0),height:u}:{})}if(i==="right"){var k={x:l+d+y,y:c+u/2,textAnchor:w,verticalAnchor:"middle"};return $s($s({},k),n?{width:Math.max(n.x+n.width-k.x,0),height:u}:{})}var P=n?{width:d,height:u}:{};return i==="insideLeft"?$s({x:l+y,y:c+u/2,textAnchor:w,verticalAnchor:"middle"},P):i==="insideRight"?$s({x:l+d-y,y:c+u/2,textAnchor:_,verticalAnchor:"middle"},P):i==="insideTop"?$s({x:l+d/2,y:c+h,textAnchor:"middle",verticalAnchor:g},P):i==="insideBottom"?$s({x:l+d/2,y:c+u-h,textAnchor:"middle",verticalAnchor:p},P):i==="insideTopLeft"?$s({x:l+y,y:c+h,textAnchor:w,verticalAnchor:g},P):i==="insideTopRight"?$s({x:l+d-y,y:c+h,textAnchor:_,verticalAnchor:g},P):i==="insideBottomLeft"?$s({x:l+y,y:c+u-h,textAnchor:w,verticalAnchor:p},P):i==="insideBottomRight"?$s({x:l+d-y,y:c+u-h,textAnchor:_,verticalAnchor:p},P):Np(i)&&(Nt(i.x)||Mu(i.x))&&(Nt(i.y)||Mu(i.y))?$s({x:l+ph(i.x,d),y:c+ph(i.y,u),textAnchor:"end",verticalAnchor:"end"},P):$s({x:l+d/2,y:c+u/2,textAnchor:"middle",verticalAnchor:"middle"},P)},d3e=function(t){return"cx"in t&&Nt(t.cx)};function Ca(e){var t=e.offset,r=t===void 0?5:t,n=e3e(e,Y4e),a=$s({offset:r},n),i=a.viewBox,o=a.position,l=a.value,c=a.children,d=a.content,u=a.className,f=u===void 0?"":u,h=a.textBreakAll;if(!i||Yr(l)&&Yr(c)&&!x.isValidElement(d)&&!Ir(d))return null;if(x.isValidElement(d))return x.cloneElement(d,a);var p;if(Ir(d)){if(p=x.createElement(d,a),x.isValidElement(p))return p}else p=a3e(a);var g=d3e(i),v=Fr(a,!0);if(g&&(o==="insideStart"||o==="insideEnd"||o==="end"))return o3e(a,p,v);var y=g?l3e(a):c3e(a);return J.createElement(Ow,dy({className:an("recharts-label",f)},v,y,{breakAll:h}),p)}Ca.displayName="Label";var xG=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,o=t.endAngle,l=t.r,c=t.radius,d=t.innerRadius,u=t.outerRadius,f=t.x,h=t.y,p=t.top,g=t.left,v=t.width,y=t.height,_=t.clockWise,w=t.labelViewBox;if(w)return w;if(Nt(v)&&Nt(y)){if(Nt(f)&&Nt(h))return{x:f,y:h,width:v,height:y};if(Nt(p)&&Nt(g))return{x:p,y:g,width:v,height:y}}return Nt(f)&&Nt(h)?{x:f,y:h,width:0,height:0}:Nt(r)&&Nt(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:o||a||0,innerRadius:d||0,outerRadius:u||c||l||0,clockWise:_}:t.viewBox?t.viewBox:{}},u3e=function(t,r){return t?t===!0?J.createElement(Ca,{key:"label-implicit",viewBox:r}):Ws(t)?J.createElement(Ca,{key:"label-implicit",viewBox:r,value:t}):x.isValidElement(t)?t.type===Ca?x.cloneElement(t,{key:"label-implicit",viewBox:r}):J.createElement(Ca,{key:"label-implicit",content:t,viewBox:r}):Ir(t)?J.createElement(Ca,{key:"label-implicit",content:t,viewBox:r}):Np(t)?J.createElement(Ca,dy({viewBox:r},t,{key:"label-implicit"})):null:null},h3e=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=xG(t),o=oo(a,Ca).map(function(c,d){return x.cloneElement(c,{viewBox:r||i,key:"label-".concat(d)})});if(!n)return o;var l=u3e(t.label,r||i);return[l].concat(K4e(o))};Ca.parseViewBox=xG;Ca.renderCallByParent=h3e;function f3e(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var m3e=f3e;const p3e=yn(m3e);function uy(e){"@babel/helpers - typeof";return uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uy(e)}var g3e=["valueAccessor"],v3e=["data","dataKey","clockWise","id","textBreakAll"];function y3e(e){return b3e(e)||w3e(e)||_3e(e)||x3e()}function x3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _3e(e,t){if(e){if(typeof e=="string")return CE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CE(e,t)}}function w3e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function b3e(e){if(Array.isArray(e))return CE(e)}function CE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zw(){return Zw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zw.apply(this,arguments)}function KD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ZD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KD(Object(r),!0).forEach(function(n){j3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function j3e(e,t,r){return t=N3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N3e(e){var t=S3e(e,"string");return uy(t)=="symbol"?t:t+""}function S3e(e,t){if(uy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XD(e,t){if(e==null)return{};var r=k3e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function k3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var E3e=function(t){return Array.isArray(t.value)?p3e(t.value):t.value};function Nc(e){var t=e.valueAccessor,r=t===void 0?E3e:t,n=XD(e,g3e),a=n.data,i=n.dataKey,o=n.clockWise,l=n.id,c=n.textBreakAll,d=XD(n,v3e);return!a||!a.length?null:J.createElement(qn,{className:"recharts-label-list"},a.map(function(u,f){var h=Yr(i)?r(u,f):Ha(u&&u.payload,i),p=Yr(l)?{}:{id:"".concat(l,"-").concat(f)};return J.createElement(Ca,Zw({},Fr(u,!0),d,p,{parentViewBox:u.parentViewBox,value:h,textBreakAll:c,viewBox:Ca.parseViewBox(Yr(o)?u:ZD(ZD({},u),{},{clockWise:o})),key:"label-".concat(f),index:f}))}))}Nc.displayName="LabelList";function C3e(e,t){return e?e===!0?J.createElement(Nc,{key:"labelList-implicit",data:t}):J.isValidElement(e)||Ir(e)?J.createElement(Nc,{key:"labelList-implicit",data:t,content:e}):Np(e)?J.createElement(Nc,Zw({data:t},e,{key:"labelList-implicit"})):null:null}function P3e(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=oo(n,Nc).map(function(o,l){return x.cloneElement(o,{data:t,key:"labelList-".concat(l)})});if(!r)return a;var i=C3e(e.label,t);return[i].concat(y3e(a))}Nc.renderCallByParent=P3e;function hy(e){"@babel/helpers - typeof";return hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hy(e)}function PE(){return PE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},PE.apply(this,arguments)}function JD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function QD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JD(Object(r),!0).forEach(function(n){T3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T3e(e,t,r){return t=A3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A3e(e){var t=R3e(e,"string");return hy(t)=="symbol"?t:t+""}function R3e(e,t){if(hy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var O3e=function(t,r){var n=Lo(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},I0=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,o=t.sign,l=t.isExternal,c=t.cornerRadius,d=t.cornerIsExternal,u=c*(l?1:-1)+a,f=Math.asin(c/u)/Kw,h=d?i:i+o*f,p=ma(r,n,u,h),g=ma(r,n,a,h),v=d?i-o*f:i,y=ma(r,n,u*Math.cos(f*Kw),v);return{center:p,circleTangency:g,lineTangency:y,theta:f}},_G=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.startAngle,l=t.endAngle,c=O3e(o,l),d=o+c,u=ma(r,n,i,o),f=ma(r,n,i,d),h="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>d),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(a>0){var p=ma(r,n,a,o),g=ma(r,n,a,d);h+="L ".concat(g.x,",").concat(g.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=d),`,
            `).concat(p.x,",").concat(p.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},M3e=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,f=Lo(u-d),h=I0({cx:r,cy:n,radius:i,angle:d,sign:f,cornerRadius:o,cornerIsExternal:c}),p=h.circleTangency,g=h.lineTangency,v=h.theta,y=I0({cx:r,cy:n,radius:i,angle:u,sign:-f,cornerRadius:o,cornerIsExternal:c}),_=y.circleTangency,w=y.lineTangency,b=y.theta,N=c?Math.abs(d-u):Math.abs(d-u)-v-b;if(N<0)return l?"M ".concat(g.x,",").concat(g.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):_G({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:u});var S="M ".concat(g.x,",").concat(g.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(N>180),",").concat(+(f<0),",").concat(_.x,",").concat(_.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(w.x,",").concat(w.y,`
  `);if(a>0){var k=I0({cx:r,cy:n,radius:a,angle:d,sign:f,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),P=k.circleTangency,A=k.lineTangency,R=k.theta,$=I0({cx:r,cy:n,radius:a,angle:u,sign:-f,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),O=$.circleTangency,z=$.lineTangency,D=$.theta,B=c?Math.abs(d-u):Math.abs(d-u)-R-D;if(B<0&&o===0)return"".concat(S,"L").concat(r,",").concat(n,"Z");S+="L".concat(z.x,",").concat(z.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(O.x,",").concat(O.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(B>180),",").concat(+(f>0),",").concat(P.x,",").concat(P.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(A.x,",").concat(A.y,"Z")}else S+="L".concat(r,",").concat(n,"Z");return S},D3e={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},wG=function(t){var r=QD(QD({},D3e),t),n=r.cx,a=r.cy,i=r.innerRadius,o=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,d=r.cornerIsExternal,u=r.startAngle,f=r.endAngle,h=r.className;if(o<i||u===f)return null;var p=an("recharts-sector",h),g=o-i,v=ph(l,g,0,!0),y;return v>0&&Math.abs(u-f)<360?y=M3e({cx:n,cy:a,innerRadius:i,outerRadius:o,cornerRadius:Math.min(v,g/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f}):y=_G({cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:u,endAngle:f}),J.createElement("path",PE({},Fr(r,!0),{className:p,d:y,role:"img"}))};function fy(e){"@babel/helpers - typeof";return fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fy(e)}function TE(){return TE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},TE.apply(this,arguments)}function eI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eI(Object(r),!0).forEach(function(n){I3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I3e(e,t,r){return t=$3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $3e(e){var t=L3e(e,"string");return fy(t)=="symbol"?t:t+""}function L3e(e,t){if(fy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rI={curveBasisClosed:Ije,curveBasisOpen:$je,curveBasis:Dje,curveBumpX:wje,curveBumpY:bje,curveLinearClosed:Lje,curveLinear:ij,curveMonotoneX:Fje,curveMonotoneY:zje,curveNatural:Bje,curveStep:Uje,curveStepAfter:Vje,curveStepBefore:qje},$0=function(t){return t.x===+t.x&&t.y===+t.y},Ng=function(t){return t.x},Sg=function(t){return t.y},F3e=function(t,r){if(Ir(t))return t;var n="curve".concat(sj(t));return(n==="curveMonotone"||n==="curveBump")&&r?rI["".concat(n).concat(r==="vertical"?"Y":"X")]:rI[n]||ij},z3e=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,o=t.baseLine,l=t.layout,c=t.connectNulls,d=c===void 0?!1:c,u=F3e(n,l),f=d?i.filter(function(v){return $0(v)}):i,h;if(Array.isArray(o)){var p=d?o.filter(function(v){return $0(v)}):o,g=f.map(function(v,y){return tI(tI({},v),{},{base:p[y]})});return l==="vertical"?h=E0().y(Sg).x1(Ng).x0(function(v){return v.base.x}):h=E0().x(Ng).y1(Sg).y0(function(v){return v.base.y}),h.defined($0).curve(u),h(g)}return l==="vertical"&&Nt(o)?h=E0().y(Sg).x1(Ng).x0(o):Nt(o)?h=E0().x(Ng).y1(Sg).y0(o):h=wW().x(Ng).y(Sg),h.defined($0).curve(u),h(f)},em=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var o=n&&n.length?z3e(t):a;return x.createElement("path",TE({},Fr(t,!1),yw(t),{className:an("recharts-curve",r),d:o,ref:i}))},B3e=Object.getOwnPropertyNames,U3e=Object.getOwnPropertySymbols,q3e=Object.prototype.hasOwnProperty;function nI(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function L0(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var i=a.cache,o=i.get(r),l=i.get(n);if(o&&l)return o===n&&l===r;i.set(r,n),i.set(n,r);var c=e(r,n,a);return i.delete(r),i.delete(n),c}}function sI(e){return B3e(e).concat(U3e(e))}var V3e=Object.hasOwn||function(e,t){return q3e.call(e,t)};function Oh(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var W3e="__v",H3e="__o",G3e="_owner",aI=Object.getOwnPropertyDescriptor,iI=Object.keys;function Y3e(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function K3e(e,t){return Oh(e.getTime(),t.getTime())}function Z3e(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function X3e(e,t){return e===t}function oI(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.entries(),o,l,c=0;(o=i.next())&&!o.done;){for(var d=t.entries(),u=!1,f=0;(l=d.next())&&!l.done;){if(a[f]){f++;continue}var h=o.value,p=l.value;if(r.equals(h[0],p[0],c,f,e,t,r)&&r.equals(h[1],p[1],h[0],p[0],e,t,r)){u=a[f]=!0;break}f++}if(!u)return!1;c++}return!0}var J3e=Oh;function Q3e(e,t,r){var n=iI(e),a=n.length;if(iI(t).length!==a)return!1;for(;a-- >0;)if(!bG(e,t,r,n[a]))return!1;return!0}function kg(e,t,r){var n=sI(e),a=n.length;if(sI(t).length!==a)return!1;for(var i,o,l;a-- >0;)if(i=n[a],!bG(e,t,r,i)||(o=aI(e,i),l=aI(t,i),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function eDe(e,t){return Oh(e.valueOf(),t.valueOf())}function tDe(e,t){return e.source===t.source&&e.flags===t.flags}function lI(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.values(),o,l;(o=i.next())&&!o.done;){for(var c=t.values(),d=!1,u=0;(l=c.next())&&!l.done;){if(!a[u]&&r.equals(o.value,l.value,o.value,l.value,e,t,r)){d=a[u]=!0;break}u++}if(!d)return!1}return!0}function rDe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function nDe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function bG(e,t,r,n){return(n===G3e||n===H3e||n===W3e)&&(e.$$typeof||t.$$typeof)?!0:V3e(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var sDe="[object Arguments]",aDe="[object Boolean]",iDe="[object Date]",oDe="[object Error]",lDe="[object Map]",cDe="[object Number]",dDe="[object Object]",uDe="[object RegExp]",hDe="[object Set]",fDe="[object String]",mDe="[object URL]",pDe=Array.isArray,cI=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,dI=Object.assign,gDe=Object.prototype.toString.call.bind(Object.prototype.toString);function vDe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,o=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,u=e.areSetsEqual,f=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(g,v,y){if(g===v)return!0;if(g==null||v==null)return!1;var _=typeof g;if(_!==typeof v)return!1;if(_!=="object")return _==="number"?o(g,v,y):_==="function"?a(g,v,y):!1;var w=g.constructor;if(w!==v.constructor)return!1;if(w===Object)return l(g,v,y);if(pDe(g))return t(g,v,y);if(cI!=null&&cI(g))return f(g,v,y);if(w===Date)return r(g,v,y);if(w===RegExp)return d(g,v,y);if(w===Map)return i(g,v,y);if(w===Set)return u(g,v,y);var b=gDe(g);return b===iDe?r(g,v,y):b===uDe?d(g,v,y):b===lDe?i(g,v,y):b===hDe?u(g,v,y):b===dDe?typeof g.then!="function"&&typeof v.then!="function"&&l(g,v,y):b===mDe?h(g,v,y):b===oDe?n(g,v,y):b===sDe?l(g,v,y):b===aDe||b===cDe||b===fDe?c(g,v,y):!1}}function yDe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?kg:Y3e,areDatesEqual:K3e,areErrorsEqual:Z3e,areFunctionsEqual:X3e,areMapsEqual:n?nI(oI,kg):oI,areNumbersEqual:J3e,areObjectsEqual:n?kg:Q3e,arePrimitiveWrappersEqual:eDe,areRegExpsEqual:tDe,areSetsEqual:n?nI(lI,kg):lI,areTypedArraysEqual:n?kg:rDe,areUrlsEqual:nDe};if(r&&(a=dI({},a,r(a))),t){var i=L0(a.areArraysEqual),o=L0(a.areMapsEqual),l=L0(a.areObjectsEqual),c=L0(a.areSetsEqual);a=dI({},a,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:c})}return a}function xDe(e){return function(t,r,n,a,i,o,l){return e(t,r,l)}}function _De(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(c,d){var u=n(),f=u.cache,h=f===void 0?t?new WeakMap:void 0:f,p=u.meta;return r(c,d,{cache:h,equals:a,meta:p,strict:i})};if(t)return function(c,d){return r(c,d,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var o={cache:void 0,equals:a,meta:void 0,strict:i};return function(c,d){return r(c,d,o)}}var wDe=iu();iu({strict:!0});iu({circular:!0});iu({circular:!0,strict:!0});iu({createInternalComparator:function(){return Oh}});iu({strict:!0,createInternalComparator:function(){return Oh}});iu({circular:!0,createInternalComparator:function(){return Oh}});iu({circular:!0,createInternalComparator:function(){return Oh},strict:!0});function iu(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,o=i===void 0?!1:i,l=yDe(e),c=vDe(l),d=n?n(c):xDe(c);return _De({circular:r,comparator:c,createState:a,equals:d,strict:o})}function bDe(e){typeof requestAnimationFrame!="undefined"&&requestAnimationFrame(e)}function uI(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):bDe(a)};requestAnimationFrame(n)}function AE(e){"@babel/helpers - typeof";return AE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AE(e)}function jDe(e){return EDe(e)||kDe(e)||SDe(e)||NDe()}function NDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SDe(e,t){if(e){if(typeof e=="string")return hI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hI(e,t)}}function hI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kDe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EDe(e){if(Array.isArray(e))return e}function CDe(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,l=jDe(o),c=l[0],d=l.slice(1);if(typeof c=="number"){uI(a.bind(null,d),c);return}a(c),uI(a.bind(null,d));return}AE(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function my(e){"@babel/helpers - typeof";return my=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},my(e)}function fI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fI(Object(r),!0).forEach(function(n){jG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jG(e,t,r){return t=PDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PDe(e){var t=TDe(e,"string");return my(t)==="symbol"?t:String(t)}function TDe(e,t){if(my(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(my(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ADe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},RDe=function(t){return t},ODe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},av=function(t,r){return Object.keys(r).reduce(function(n,a){return mI(mI({},n),{},jG({},a,t(a,r[a])))},{})},pI=function(t,r,n){return t.map(function(a){return"".concat(ODe(a)," ").concat(r,"ms ").concat(n)}).join(",")};function MDe(e,t){return $De(e)||IDe(e,t)||NG(e,t)||DDe()}function DDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IDe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function $De(e){if(Array.isArray(e))return e}function LDe(e){return BDe(e)||zDe(e)||NG(e)||FDe()}function FDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NG(e,t){if(e){if(typeof e=="string")return RE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RE(e,t)}}function zDe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BDe(e){if(Array.isArray(e))return RE(e)}function RE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Xw=1e-4,SG=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},kG=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},gI=function(t,r){return function(n){var a=SG(t,r);return kG(a,n)}},UDe=function(t,r){return function(n){var a=SG(t,r),i=[].concat(LDe(a.map(function(o,l){return o*l}).slice(1)),[0]);return kG(i,n)}},vI=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],o=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,o=1,l=1;break;case"ease":a=.25,i=.1,o=.25,l=1;break;case"ease-in":a=.42,i=0,o=1,l=1;break;case"ease-out":a=.42,i=0,o=.58,l=1;break;case"ease-in-out":a=0,i=0,o=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var d=c[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),u=MDe(d,4);a=u[0],i=u[1],o=u[2],l=u[3]}}}var f=gI(a,o),h=gI(i,l),p=UDe(a,o),g=function(_){return _>1?1:_<0?0:_},v=function(_){for(var w=_>1?1:_,b=w,N=0;N<8;++N){var S=f(b)-w,k=p(b);if(Math.abs(S-w)<Xw||k<Xw)return h(b);b=g(b-S/k)}return h(b)};return v.isStepper=!1,v},qDe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,o=t.dt,l=o===void 0?17:o,c=function(u,f,h){var p=-(u-f)*n,g=h*i,v=h+(p-g)*l/1e3,y=h*l/1e3+u;return Math.abs(y-f)<Xw&&Math.abs(v)<Xw?[f,0]:[y,v]};return c.isStepper=!0,c.dt=l,c},VDe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return vI(a);case"spring":return qDe();default:if(a.split("(")[0]==="cubic-bezier")return vI(a)}return typeof a=="function"?a:null};function py(e){"@babel/helpers - typeof";return py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},py(e)}function yI(e){return GDe(e)||HDe(e)||EG(e)||WDe()}function WDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HDe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function GDe(e){if(Array.isArray(e))return ME(e)}function xI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function da(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xI(Object(r),!0).forEach(function(n){OE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OE(e,t,r){return t=YDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YDe(e){var t=KDe(e,"string");return py(t)==="symbol"?t:String(t)}function KDe(e,t){if(py(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(py(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZDe(e,t){return QDe(e)||JDe(e,t)||EG(e,t)||XDe()}function XDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EG(e,t){if(e){if(typeof e=="string")return ME(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ME(e,t)}}function ME(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JDe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function QDe(e){if(Array.isArray(e))return e}var Jw=function(t,r,n){return t+(r-t)*n},DE=function(t){var r=t.from,n=t.to;return r!==n},eIe=function e(t,r,n){var a=av(function(i,o){if(DE(o)){var l=t(o.from,o.to,o.velocity),c=ZDe(l,2),d=c[0],u=c[1];return da(da({},o),{},{from:d,velocity:u})}return o},r);return n<1?av(function(i,o){return DE(o)?da(da({},o),{},{velocity:Jw(o.velocity,a[i].velocity,n),from:Jw(o.from,a[i].from,n)}):o},r):e(t,a,n-1)};const tIe=function(e,t,r,n,a){var i=ADe(e,t),o=i.reduce(function(y,_){return da(da({},y),{},OE({},_,[e[_],t[_]]))},{}),l=i.reduce(function(y,_){return da(da({},y),{},OE({},_,{from:e[_],velocity:0,to:t[_]}))},{}),c=-1,d,u,f=function(){return null},h=function(){return av(function(_,w){return w.from},l)},p=function(){return!Object.values(l).filter(DE).length},g=function(_){d||(d=_);var w=_-d,b=w/r.dt;l=eIe(r,l,b),a(da(da(da({},e),t),h())),d=_,p()||(c=requestAnimationFrame(f))},v=function(_){u||(u=_);var w=(_-u)/n,b=av(function(S,k){return Jw.apply(void 0,yI(k).concat([r(w)]))},o);if(a(da(da(da({},e),t),b)),w<1)c=requestAnimationFrame(f);else{var N=av(function(S,k){return Jw.apply(void 0,yI(k).concat([r(1)]))},o);a(da(da(da({},e),t),N))}};return f=r.isStepper?g:v,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}};function Bm(e){"@babel/helpers - typeof";return Bm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bm(e)}var rIe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function nIe(e,t){if(e==null)return{};var r=sIe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function sIe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function TS(e){return lIe(e)||oIe(e)||iIe(e)||aIe()}function aIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iIe(e,t){if(e){if(typeof e=="string")return IE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IE(e,t)}}function oIe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lIe(e){if(Array.isArray(e))return IE(e)}function IE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_I(Object(r),!0).forEach(function(n){Lg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_I(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lg(e,t,r){return t=CG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dIe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CG(n.key),n)}}function uIe(e,t,r){return t&&dIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function CG(e){var t=hIe(e,"string");return Bm(t)==="symbol"?t:String(t)}function hIe(e,t){if(Bm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$E(e,t)}function $E(e,t){return $E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$E(e,t)}function mIe(e){var t=pIe();return function(){var n=Qw(e),a;if(t){var i=Qw(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return LE(this,a)}}function LE(e,t){if(t&&(Bm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FE(e)}function FE(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pIe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Qw(e){return Qw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qw(e)}var Ll=function(e){fIe(r,e);var t=mIe(r);function r(n,a){var i;cIe(this,r),i=t.call(this,n,a);var o=i.props,l=o.isActive,c=o.attributeName,d=o.from,u=o.to,f=o.steps,h=o.children,p=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(FE(i)),i.changeStyle=i.changeStyle.bind(FE(i)),!l||p<=0)return i.state={style:{}},typeof h=="function"&&(i.state={style:u}),LE(i);if(f&&f.length)i.state={style:f[0].style};else if(d){if(typeof h=="function")return i.state={style:d},LE(i);i.state={style:c?Lg({},c,d):d}}else i.state={style:{}};return i}return uIe(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,o=a.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,o=i.isActive,l=i.canBegin,c=i.attributeName,d=i.shouldReAnimate,u=i.to,f=i.from,h=this.state.style;if(l){if(!o){var p={style:c?Lg({},c,u):u};this.state&&h&&(c&&h[c]!==u||!c&&h!==u)&&this.setState(p);return}if(!(wDe(a.to,u)&&a.canBegin&&a.isActive)){var g=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var v=g||d?f:a.to;if(this.state&&h){var y={style:c?Lg({},c,v):v};(c&&h[c]!==v||!c&&h!==v)&&this.setState(y)}this.runAnimation(xo(xo({},this.props),{},{from:v,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,o=a.from,l=a.to,c=a.duration,d=a.easing,u=a.begin,f=a.onAnimationEnd,h=a.onAnimationStart,p=tIe(o,l,VDe(d),c,this.changeStyle),g=function(){i.stopJSAnimation=p()};this.manager.start([h,u,g,c,f])}},{key:"runStepAnimation",value:function(a){var i=this,o=a.steps,l=a.begin,c=a.onAnimationStart,d=o[0],u=d.style,f=d.duration,h=f===void 0?0:f,p=function(v,y,_){if(_===0)return v;var w=y.duration,b=y.easing,N=b===void 0?"ease":b,S=y.style,k=y.properties,P=y.onAnimationEnd,A=_>0?o[_-1]:y,R=k||Object.keys(S);if(typeof N=="function"||N==="spring")return[].concat(TS(v),[i.runJSAnimation.bind(i,{from:A.style,to:S,duration:w,easing:N}),w]);var $=pI(R,w,N),O=xo(xo(xo({},A.style),S),{},{transition:$});return[].concat(TS(v),[O,w,P]).filter(RDe)};return this.manager.start([c].concat(TS(o.reduce(p,[u,Math.max(h,l)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=CDe());var i=a.begin,o=a.duration,l=a.attributeName,c=a.to,d=a.easing,u=a.onAnimationStart,f=a.onAnimationEnd,h=a.steps,p=a.children,g=this.manager;if(this.unSubscribe=g.subscribe(this.handleStyleChange),typeof d=="function"||typeof p=="function"||d==="spring"){this.runJSAnimation(a);return}if(h.length>1){this.runStepAnimation(a);return}var v=l?Lg({},l,c):c,y=pI(Object.keys(v),o,d);g.start([u,i,xo(xo({},v),{},{transition:y}),o,f])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var l=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var c=nIe(a,rIe),d=x.Children.count(i),u=this.state.style;if(typeof i=="function")return i(u);if(!l||d===0||o<=0)return i;var f=function(p){var g=p.props,v=g.style,y=v===void 0?{}:v,_=g.className,w=x.cloneElement(p,xo(xo({},c),{},{style:xo(xo({},y),u),className:_}));return w};return d===1?f(x.Children.only(i)):J.createElement("div",null,x.Children.map(i,function(h){return f(h)}))}}]),r}(x.PureComponent);Ll.displayName="Animate";Ll.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Ll.propTypes={from:nt.oneOfType([nt.object,nt.string]),to:nt.oneOfType([nt.object,nt.string]),attributeName:nt.string,duration:nt.number,begin:nt.number,easing:nt.oneOfType([nt.string,nt.func]),steps:nt.arrayOf(nt.shape({duration:nt.number.isRequired,style:nt.object.isRequired,easing:nt.oneOfType([nt.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),nt.func]),properties:nt.arrayOf("string"),onAnimationEnd:nt.func})),children:nt.oneOfType([nt.node,nt.func]),isActive:nt.bool,canBegin:nt.bool,onAnimationEnd:nt.func,shouldReAnimate:nt.bool,onAnimationStart:nt.func,onAnimationReStart:nt.func};function gy(e){"@babel/helpers - typeof";return gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gy(e)}function eb(){return eb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eb.apply(this,arguments)}function gIe(e,t){return _Ie(e)||xIe(e,t)||yIe(e,t)||vIe()}function vIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yIe(e,t){if(e){if(typeof e=="string")return wI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wI(e,t)}}function wI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xIe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function _Ie(e){if(Array.isArray(e))return e}function bI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bI(Object(r),!0).forEach(function(n){wIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wIe(e,t,r){return t=bIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bIe(e){var t=jIe(e,"string");return gy(t)=="symbol"?t:t+""}function jIe(e,t){if(gy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NI=function(t,r,n,a,i){var o=Math.min(Math.abs(n)/2,Math.abs(a)/2),l=a>=0?1:-1,c=n>=0?1:-1,d=a>=0&&n>=0||a<0&&n<0?1:0,u;if(o>0&&i instanceof Array){for(var f=[0,0,0,0],h=0,p=4;h<p;h++)f[h]=i[h]>o?o:i[h];u="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(d,",").concat(t+c*f[0],",").concat(r)),u+="L ".concat(t+n-c*f[1],",").concat(r),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(d,`,
        `).concat(t+n,",").concat(r+l*f[1])),u+="L ".concat(t+n,",").concat(r+a-l*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(d,`,
        `).concat(t+n-c*f[2],",").concat(r+a)),u+="L ".concat(t+c*f[3],",").concat(r+a),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+a-l*f[3])),u+="Z"}else if(o>0&&i===+i&&i>0){var g=Math.min(o,i);u="M ".concat(t,",").concat(r+l*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(d,",").concat(t+c*g,",").concat(r,`
            L `).concat(t+n-c*g,",").concat(r,`
            A `).concat(g,",").concat(g,",0,0,").concat(d,",").concat(t+n,",").concat(r+l*g,`
            L `).concat(t+n,",").concat(r+a-l*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(d,",").concat(t+n-c*g,",").concat(r+a,`
            L `).concat(t+c*g,",").concat(r+a,`
            A `).concat(g,",").concat(g,",0,0,").concat(d,",").concat(t,",").concat(r+a-l*g," Z")}else u="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return u},NIe=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,o=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var d=Math.min(i,i+l),u=Math.max(i,i+l),f=Math.min(o,o+c),h=Math.max(o,o+c);return n>=d&&n<=u&&a>=f&&a<=h}return!1},SIe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},nR=function(t){var r=jI(jI({},SIe),t),n=x.useRef(),a=x.useState(-1),i=gIe(a,2),o=i[0],l=i[1];x.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var N=n.current.getTotalLength();N&&l(N)}catch(S){}},[]);var c=r.x,d=r.y,u=r.width,f=r.height,h=r.radius,p=r.className,g=r.animationEasing,v=r.animationDuration,y=r.animationBegin,_=r.isAnimationActive,w=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||u===0||f===0)return null;var b=an("recharts-rectangle",p);return w?J.createElement(Ll,{canBegin:o>0,from:{width:u,height:f,x:c,y:d},to:{width:u,height:f,x:c,y:d},duration:v,animationEasing:g,isActive:w},function(N){var S=N.width,k=N.height,P=N.x,A=N.y;return J.createElement(Ll,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:v,isActive:_,easing:g},J.createElement("path",eb({},Fr(r,!0),{className:b,d:NI(P,A,S,k,h),ref:n})))}):J.createElement("path",eb({},Fr(r,!0),{className:b,d:NI(c,d,u,f,h)}))};function zE(){return zE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zE.apply(this,arguments)}var _j=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,o=an("recharts-dot",i);return r===+r&&n===+n&&a===+a?x.createElement("circle",zE({},Fr(t,!1),yw(t),{className:o,cx:r,cy:n,r:a})):null};function vy(e){"@babel/helpers - typeof";return vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vy(e)}var kIe=["x","y","top","left","width","height","className"];function BE(){return BE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BE.apply(this,arguments)}function SI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function EIe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SI(Object(r),!0).forEach(function(n){CIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CIe(e,t,r){return t=PIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PIe(e){var t=TIe(e,"string");return vy(t)=="symbol"?t:t+""}function TIe(e,t){if(vy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AIe(e,t){if(e==null)return{};var r=RIe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function RIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var OIe=function(t,r,n,a,i,o){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(n)},MIe=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.top,l=o===void 0?0:o,c=t.left,d=c===void 0?0:c,u=t.width,f=u===void 0?0:u,h=t.height,p=h===void 0?0:h,g=t.className,v=AIe(t,kIe),y=EIe({x:n,y:i,top:l,left:d,width:f,height:p},v);return!Nt(n)||!Nt(i)||!Nt(f)||!Nt(p)||!Nt(l)||!Nt(d)?null:J.createElement("path",BE({},Fr(y,!0),{className:an("recharts-cross",g),d:OIe(n,i,f,p,l,d)}))},DIe=WW,IIe=DIe(Object.getPrototypeOf,Object),$Ie=IIe,LIe=Bc,FIe=$Ie,zIe=Uc,BIe="[object Object]",UIe=Function.prototype,qIe=Object.prototype,PG=UIe.toString,VIe=qIe.hasOwnProperty,WIe=PG.call(Object);function HIe(e){if(!zIe(e)||LIe(e)!=BIe)return!1;var t=FIe(e);if(t===null)return!0;var r=VIe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&PG.call(r)==WIe}var GIe=HIe;const YIe=yn(GIe);var KIe=Bc,ZIe=Uc,XIe="[object Boolean]";function JIe(e){return e===!0||e===!1||ZIe(e)&&KIe(e)==XIe}var QIe=JIe;const e$e=yn(QIe);function yy(e){"@babel/helpers - typeof";return yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yy(e)}function tb(){return tb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tb.apply(this,arguments)}function t$e(e,t){return a$e(e)||s$e(e,t)||n$e(e,t)||r$e()}function r$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n$e(e,t){if(e){if(typeof e=="string")return kI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kI(e,t)}}function kI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s$e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function a$e(e){if(Array.isArray(e))return e}function EI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function CI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EI(Object(r),!0).forEach(function(n){i$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i$e(e,t,r){return t=o$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o$e(e){var t=l$e(e,"string");return yy(t)=="symbol"?t:t+""}function l$e(e,t){if(yy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PI=function(t,r,n,a,i){var o=n-a,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-o/2,",").concat(r+i),l+="L ".concat(t+n-o/2-a,",").concat(r+i),l+="L ".concat(t,",").concat(r," Z"),l},c$e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},d$e=function(t){var r=CI(CI({},c$e),t),n=x.useRef(),a=x.useState(-1),i=t$e(a,2),o=i[0],l=i[1];x.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var b=n.current.getTotalLength();b&&l(b)}catch(N){}},[]);var c=r.x,d=r.y,u=r.upperWidth,f=r.lowerWidth,h=r.height,p=r.className,g=r.animationEasing,v=r.animationDuration,y=r.animationBegin,_=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||h!==+h||u===0&&f===0||h===0)return null;var w=an("recharts-trapezoid",p);return _?J.createElement(Ll,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:h,x:c,y:d},to:{upperWidth:u,lowerWidth:f,height:h,x:c,y:d},duration:v,animationEasing:g,isActive:_},function(b){var N=b.upperWidth,S=b.lowerWidth,k=b.height,P=b.x,A=b.y;return J.createElement(Ll,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:v,easing:g},J.createElement("path",tb({},Fr(r,!0),{className:w,d:PI(P,A,N,S,k),ref:n})))}):J.createElement("g",null,J.createElement("path",tb({},Fr(r,!0),{className:w,d:PI(c,d,u,f,h)})))},u$e=["option","shapeType","propTransformer","activeClassName","isActive"];function xy(e){"@babel/helpers - typeof";return xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xy(e)}function h$e(e,t){if(e==null)return{};var r=f$e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function f$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function TI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TI(Object(r),!0).forEach(function(n){m$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m$e(e,t,r){return t=p$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p$e(e){var t=g$e(e,"string");return xy(t)=="symbol"?t:t+""}function g$e(e,t){if(xy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function v$e(e,t){return rb(rb({},t),e)}function y$e(e,t){return e==="symbols"}function AI(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return J.createElement(nR,r);case"trapezoid":return J.createElement(d$e,r);case"sector":return J.createElement(wG,r);case"symbols":if(y$e(t))return J.createElement(bA,r);break;default:return null}}function x$e(e){return x.isValidElement(e)?e.props:e}function _$e(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?v$e:n,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,l=e.isActive,c=h$e(e,u$e),d;if(x.isValidElement(t))d=x.cloneElement(t,rb(rb({},c),x$e(t)));else if(Ir(t))d=t(c);else if(YIe(t)&&!e$e(t)){var u=a(t,c);d=J.createElement(AI,{shapeType:r,elementProps:u})}else{var f=c;d=J.createElement(AI,{shapeType:r,elementProps:f})}return l?J.createElement(qn,{className:o},d):d}function wj(e,t){return t!=null&&"trapezoids"in e.props}function bj(e,t){return t!=null&&"sectors"in e.props}function _y(e,t){return t!=null&&"points"in e.props}function w$e(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function b$e(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function j$e(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function N$e(e,t){var r;return wj(e,t)?r=w$e:bj(e,t)?r=b$e:_y(e,t)&&(r=j$e),r}function S$e(e,t){var r;return wj(e,t)?r="trapezoids":bj(e,t)?r="sectors":_y(e,t)&&(r="points"),r}function k$e(e,t){if(wj(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(bj(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return _y(e,t)?t.payload:{}}function E$e(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=S$e(r,t),i=k$e(r,t),o=n.filter(function(c,d){var u=Fm(i,c),f=r.props[a].filter(function(g){var v=N$e(r,t);return v(g,t)}),h=r.props[a].indexOf(f[f.length-1]),p=d===h;return u&&p}),l=n.indexOf(o[o.length-1]);return l}var C$e=Math.ceil,P$e=Math.max;function T$e(e,t,r,n){for(var a=-1,i=P$e(C$e((t-e)/(r||1)),0),o=Array(i);i--;)o[n?i:++a]=e,e+=r;return o}var A$e=T$e,R$e=dH,RI=1/0,O$e=17976931348623157e292;function M$e(e){if(!e)return e===0?e:0;if(e=R$e(e),e===RI||e===-RI){var t=e<0?-1:1;return t*O$e}return e===e?e:0}var TG=M$e,D$e=A$e,I$e=dj,AS=TG;function $$e(e){return function(t,r,n){return n&&typeof n!="number"&&I$e(t,r,n)&&(r=n=void 0),t=AS(t),r===void 0?(r=t,t=0):r=AS(r),n=n===void 0?t<r?1:-1:AS(n),D$e(t,r,n,e)}}var L$e=$$e,F$e=L$e,z$e=F$e(),B$e=z$e;const nb=yn(B$e);function wy(e){"@babel/helpers - typeof";return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wy(e)}function OI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function MI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OI(Object(r),!0).forEach(function(n){AG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AG(e,t,r){return t=U$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U$e(e){var t=q$e(e,"string");return wy(t)=="symbol"?t:t+""}function q$e(e,t){if(wy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var V$e=["Webkit","Moz","O","ms"],W$e=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=V$e.reduce(function(i,o){return MI(MI({},i),{},AG({},o+n,r))},{});return a[t]=r,a};function Um(e){"@babel/helpers - typeof";return Um=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Um(e)}function sb(){return sb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sb.apply(this,arguments)}function DI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DI(Object(r),!0).forEach(function(n){Ni(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function H$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function II(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OG(n.key),n)}}function G$e(e,t,r){return t&&II(e.prototype,t),r&&II(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y$e(e,t,r){return t=ab(t),K$e(e,RG()?Reflect.construct(t,r||[],ab(e).constructor):t.apply(e,r))}function K$e(e,t){if(t&&(Um(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Z$e(e)}function Z$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(RG=function(){return!!e})()}function ab(e){return ab=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ab(e)}function X$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UE(e,t)}function UE(e,t){return UE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},UE(e,t)}function Ni(e,t,r){return t=OG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OG(e){var t=J$e(e,"string");return Um(t)=="symbol"?t:t+""}function J$e(e,t){if(Um(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Um(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q$e=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,o=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,d=nv().domain(nb(0,c)).range([i,i+o-l]),u=d.domain().map(function(f){return d(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(n),endX:d(a),scale:d,scaleValues:u}},$I=function(t){return t.changedTouches&&!!t.changedTouches.length},qm=function(e){function t(r){var n;return H$e(this,t),n=Y$e(this,t,[r]),Ni(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),Ni(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),Ni(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,o=a.onDragEnd,l=a.startIndex;o==null||o({endIndex:i,startIndex:l})}),n.detachDragEndListener()}),Ni(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Ni(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Ni(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Ni(n,"handleSlideDragStart",function(a){var i=$I(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return X$e(t,e),G$e(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,o=this.state.scaleValues,l=this.props,c=l.gap,d=l.data,u=d.length-1,f=Math.min(a,i),h=Math.max(a,i),p=t.getIndexInRange(o,f),g=t.getIndexInRange(o,h);return{startIndex:p-p%c,endIndex:g===u?u:g-g%c}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,o=a.tickFormatter,l=a.dataKey,c=Ha(i[n],l,n);return Ir(o)?o(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,o=a.startX,l=a.endX,c=this.props,d=c.x,u=c.width,f=c.travellerWidth,h=c.startIndex,p=c.endIndex,g=c.onChange,v=n.pageX-i;v>0?v=Math.min(v,d+u-f-l,d+u-f-o):v<0&&(v=Math.max(v,d-o,d-l));var y=this.getIndex({startX:o+v,endX:l+v});(y.startIndex!==h||y.endIndex!==p)&&g&&g(y),this.setState({startX:o+v,endX:l+v,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=$I(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,o=a.movingTravellerId,l=a.endX,c=a.startX,d=this.state[o],u=this.props,f=u.x,h=u.width,p=u.travellerWidth,g=u.onChange,v=u.gap,y=u.data,_={startX:this.state.startX,endX:this.state.endX},w=n.pageX-i;w>0?w=Math.min(w,f+h-p-d):w<0&&(w=Math.max(w,f-d)),_[o]=d+w;var b=this.getIndex(_),N=b.startIndex,S=b.endIndex,k=function(){var A=y.length-1;return o==="startX"&&(l>c?N%v===0:S%v===0)||l<c&&S===A||o==="endX"&&(l>c?S%v===0:N%v===0)||l>c&&S===A};this.setState(Ni(Ni({},o,d+w),"brushMoveStartX",n.pageX),function(){g&&k()&&g(b)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,o=this.state,l=o.scaleValues,c=o.startX,d=o.endX,u=this.state[a],f=l.indexOf(u);if(f!==-1){var h=f+n;if(!(h===-1||h>=l.length)){var p=l[h];a==="startX"&&p>=d||a==="endX"&&p<=c||this.setState(Ni({},a,p),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,l=n.height,c=n.fill,d=n.stroke;return J.createElement("rect",{stroke:d,fill:c,x:a,y:i,width:o,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,l=n.height,c=n.data,d=n.children,u=n.padding,f=x.Children.only(d);return f?J.cloneElement(f,{x:a,y:i,width:o,height:l,margin:u,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,o,l=this,c=this.props,d=c.y,u=c.travellerWidth,f=c.height,h=c.traveller,p=c.ariaLabel,g=c.data,v=c.startIndex,y=c.endIndex,_=Math.max(n,this.props.x),w=RS(RS({},Fr(this.props,!1)),{},{x:_,y:d,width:u,height:f}),b=p||"Min value: ".concat((i=g[v])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=g[y])===null||o===void 0?void 0:o.name);return J.createElement(qn,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(S){["ArrowLeft","ArrowRight"].includes(S.key)&&(S.preventDefault(),S.stopPropagation(),l.handleTravellerMoveKeyboard(S.key==="ArrowRight"?1:-1,a))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,w))}},{key:"renderSlide",value:function(n,a){var i=this.props,o=i.y,l=i.height,c=i.stroke,d=i.travellerWidth,u=Math.min(n,a)+d,f=Math.max(Math.abs(a-n)-d,0);return J.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:u,y:o,width:f,height:l})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,o=n.y,l=n.height,c=n.travellerWidth,d=n.stroke,u=this.state,f=u.startX,h=u.endX,p=5,g={pointerEvents:"none",fill:d};return J.createElement(qn,{className:"recharts-brush-texts"},J.createElement(Ow,sb({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,h)-p,y:o+l/2},g),this.getTextOfTick(a)),J.createElement(Ow,sb({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,h)+c+p,y:o+l/2},g),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,o=n.children,l=n.x,c=n.y,d=n.width,u=n.height,f=n.alwaysShowText,h=this.state,p=h.startX,g=h.endX,v=h.isTextActive,y=h.isSlideMoving,_=h.isTravellerMoving,w=h.isTravellerFocused;if(!a||!a.length||!Nt(l)||!Nt(c)||!Nt(d)||!Nt(u)||d<=0||u<=0)return null;var b=an("recharts-brush",i),N=J.Children.count(o)===1,S=W$e("userSelect","none");return J.createElement(qn,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:S},this.renderBackground(),N&&this.renderPanorama(),this.renderSlide(p,g),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(g,"endX"),(v||y||_||w||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,o=n.width,l=n.height,c=n.stroke,d=Math.floor(i+l/2)-1;return J.createElement(J.Fragment,null,J.createElement("rect",{x:a,y:i,width:o,height:l,fill:c,stroke:"none"}),J.createElement("line",{x1:a+1,y1:d,x2:a+o-1,y2:d,fill:"none",stroke:"#fff"}),J.createElement("line",{x1:a+1,y1:d+2,x2:a+o-1,y2:d+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return J.isValidElement(n)?i=J.cloneElement(n,a):Ir(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,o=n.width,l=n.x,c=n.travellerWidth,d=n.updateId,u=n.startIndex,f=n.endIndex;if(i!==a.prevData||d!==a.prevUpdateId)return RS({prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:o},i&&i.length?Q$e({data:i,width:o,x:l,travellerWidth:c,startIndex:u,endIndex:f}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||l!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([l,l+o-c]);var h=a.scale.domain().map(function(p){return a.scale(p)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:o,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,o=0,l=i-1;l-o>1;){var c=Math.floor((o+l)/2);n[c]>a?l=c:o=c}return a>=n[l]?l:o}}])}(x.PureComponent);Ni(qm,"displayName","Brush");Ni(qm,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var eLe=PA;function tLe(e,t){var r;return eLe(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var rLe=tLe,nLe=$W,sLe=nu,aLe=rLe,iLe=_i,oLe=dj;function lLe(e,t,r){var n=iLe(e)?nLe:aLe;return r&&oLe(e,t,r)&&(t=void 0),n(e,sLe(t))}var cLe=lLe;const dLe=yn(cLe);var Rl=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},LI=aH;function uLe(e,t,r){t=="__proto__"&&LI?LI(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var hLe=uLe,fLe=hLe,mLe=nH,pLe=nu;function gLe(e,t){var r={};return t=pLe(t),mLe(e,function(n,a,i){fLe(r,a,t(n,a,i))}),r}var vLe=gLe;const yLe=yn(vLe);function xLe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var _Le=xLe,wLe=PA;function bLe(e,t){var r=!0;return wLe(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var jLe=bLe,NLe=_Le,SLe=jLe,kLe=nu,ELe=_i,CLe=dj;function PLe(e,t,r){var n=ELe(e)?NLe:SLe;return r&&CLe(e,t,r)&&(t=void 0),n(e,kLe(t))}var TLe=PLe;const MG=yn(TLe);var ALe=["x","y"];function by(e){"@babel/helpers - typeof";return by=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},by(e)}function qE(){return qE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qE.apply(this,arguments)}function FI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Eg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FI(Object(r),!0).forEach(function(n){RLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RLe(e,t,r){return t=OLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OLe(e){var t=MLe(e,"string");return by(t)=="symbol"?t:t+""}function MLe(e,t){if(by(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(by(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DLe(e,t){if(e==null)return{};var r=ILe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ILe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function $Le(e,t){var r=e.x,n=e.y,a=DLe(e,ALe),i="".concat(r),o=parseInt(i,10),l="".concat(n),c=parseInt(l,10),d="".concat(t.height||a.height),u=parseInt(d,10),f="".concat(t.width||a.width),h=parseInt(f,10);return Eg(Eg(Eg(Eg(Eg({},t),a),o?{x:o}:{}),c?{y:c}:{}),{},{height:u,width:h,name:t.name,radius:t.radius})}function zI(e){return J.createElement(_$e,qE({shapeType:"rectangle",propTransformer:$Le,activeClassName:"recharts-active-bar"},e))}var LLe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=Nt(n)||o1e(n);return i?t(n,a):(i||vh(),r)}},FLe=["value","background"],DG;function Vm(e){"@babel/helpers - typeof";return Vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vm(e)}function zLe(e,t){if(e==null)return{};var r=BLe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function BLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ib(){return ib=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ib.apply(this,arguments)}function BI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ks(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BI(Object(r),!0).forEach(function(n){bd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ULe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$G(n.key),n)}}function qLe(e,t,r){return t&&UI(e.prototype,t),r&&UI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VLe(e,t,r){return t=ob(t),WLe(e,IG()?Reflect.construct(t,r||[],ob(e).constructor):t.apply(e,r))}function WLe(e,t){if(t&&(Vm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HLe(e)}function HLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(IG=function(){return!!e})()}function ob(e){return ob=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ob(e)}function GLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VE(e,t)}function VE(e,t){return VE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},VE(e,t)}function bd(e,t,r){return t=$G(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $G(e){var t=YLe(e,"string");return Vm(t)=="symbol"?t:t+""}function YLe(e,t){if(Vm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ri=function(e){function t(){var r;ULe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=VLe(this,t,[].concat(a)),bd(r,"state",{isAnimationFinished:!1}),bd(r,"id",Pp("recharts-bar-")),bd(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),bd(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return GLe(t,e),qLe(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,o=i.shape,l=i.dataKey,c=i.activeIndex,d=i.activeBar,u=Fr(this.props,!1);return n&&n.map(function(f,h){var p=h===c,g=p?d:o,v=ks(ks(ks({},u),f),{},{isActive:p,option:g,index:h,dataKey:l,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return J.createElement(qn,ib({className:"recharts-bar-rectangle"},xw(a.props,f,h),{key:"rectangle-".concat(f==null?void 0:f.x,"-").concat(f==null?void 0:f.y,"-").concat(f==null?void 0:f.value,"-").concat(h)}),J.createElement(zI,v))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,o=a.layout,l=a.isAnimationActive,c=a.animationBegin,d=a.animationDuration,u=a.animationEasing,f=a.animationId,h=this.state.prevData;return J.createElement(Ll,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var g=p.t,v=i.map(function(y,_){var w=h&&h[_];if(w){var b=ha(w.x,y.x),N=ha(w.y,y.y),S=ha(w.width,y.width),k=ha(w.height,y.height);return ks(ks({},y),{},{x:b(g),y:N(g),width:S(g),height:k(g)})}if(o==="horizontal"){var P=ha(0,y.height),A=P(g);return ks(ks({},y),{},{y:y.y+y.height-A,height:A})}var R=ha(0,y.width),$=R(g);return ks(ks({},y),{},{width:$})});return J.createElement(qn,null,n.renderRectanglesStatically(v))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,o=this.state.prevData;return i&&a&&a.length&&(!o||!Fm(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,o=a.dataKey,l=a.activeIndex,c=Fr(this.props.background,!1);return i.map(function(d,u){d.value;var f=d.background,h=zLe(d,FLe);if(!f)return null;var p=ks(ks(ks(ks(ks({},h),{},{fill:"#eee"},f),c),xw(n.props,d,u)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:u,className:"recharts-bar-background-rectangle"});return J.createElement(zI,ib({key:"background-bar-".concat(u),option:n.props.background,isActive:u===l},p))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,l=i.xAxis,c=i.yAxis,d=i.layout,u=i.children,f=oo(u,wx);if(!f)return null;var h=d==="vertical"?o[0].height/2:o[0].width/2,p=function(y,_){var w=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:w,errorVal:Ha(y,_)}},g={clipPath:n?"url(#clipPath-".concat(a,")"):null};return J.createElement(qn,g,f.map(function(v){return J.cloneElement(v,{key:"error-bar-".concat(a,"-").concat(v.props.dataKey),data:o,xAxis:l,yAxis:c,layout:d,offset:h,dataPointFormatter:p})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,o=n.className,l=n.xAxis,c=n.yAxis,d=n.left,u=n.top,f=n.width,h=n.height,p=n.isAnimationActive,g=n.background,v=n.id;if(a||!i||!i.length)return null;var y=this.state.isAnimationFinished,_=an("recharts-bar",o),w=l&&l.allowDataOverflow,b=c&&c.allowDataOverflow,N=w||b,S=Yr(v)?this.id:v;return J.createElement(qn,{className:_},w||b?J.createElement("defs",null,J.createElement("clipPath",{id:"clipPath-".concat(S)},J.createElement("rect",{x:w?d:d-f/2,y:b?u:u-h/2,width:w?f:f*2,height:b?h:h*2}))):null,J.createElement(qn,{className:"recharts-bar-rectangles",clipPath:N?"url(#clipPath-".concat(S,")"):null},g?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(N,S),(!p||y)&&Nc.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(x.PureComponent);DG=Ri;bd(Ri,"displayName","Bar");bd(Ri,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Tl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});bd(Ri,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,o=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,h=e.offset,p=P4e(n,r);if(!p)return null;var g=t.layout,v=r.type.defaultProps,y=v!==void 0?ks(ks({},v),r.props):r.props,_=y.dataKey,w=y.children,b=y.minPointSize,N=g==="horizontal"?o:i,S=d?N.scale.domain():null,k=$4e({numericAxis:N}),P=oo(w,hH),A=f.map(function(R,$){var O,z,D,B,F,U;d?O=T4e(d[u+$],S):(O=Ha(R,_),Array.isArray(O)||(O=[k,O]));var G=LLe(b,DG.defaultProps.minPointSize)(O[1],$);if(g==="horizontal"){var q,K=[o.scale(O[0]),o.scale(O[1])],Z=K[0],Y=K[1];z=BD({axis:i,ticks:l,bandSize:a,offset:p.offset,entry:R,index:$}),D=(q=Y!=null?Y:Z)!==null&&q!==void 0?q:void 0,B=p.size;var Q=Z-Y;if(F=Number.isNaN(Q)?0:Q,U={x:z,y:o.y,width:B,height:o.height},Math.abs(G)>0&&Math.abs(F)<Math.abs(G)){var X=Lo(F||G)*(Math.abs(G)-Math.abs(F));D-=X,F+=X}}else{var ne=[i.scale(O[0]),i.scale(O[1])],re=ne[0],ye=ne[1];if(z=re,D=BD({axis:o,ticks:c,bandSize:a,offset:p.offset,entry:R,index:$}),B=ye-re,F=p.size,U={x:i.x,y:D,width:i.width,height:F},Math.abs(G)>0&&Math.abs(B)<Math.abs(G)){var ee=Lo(B||G)*(Math.abs(G)-Math.abs(B));B+=ee}}return ks(ks(ks({},R),{},{x:z,y:D,width:B,height:F,value:d?O:O[1],payload:R,background:U},P&&P[$]&&P[$].props),{},{tooltipPayload:[yG(r,R)],tooltipPosition:{x:z+B/2,y:D+F/2}})});return ks({data:A,layout:g},h)});function jy(e){"@babel/helpers - typeof";return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jy(e)}function KLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LG(n.key),n)}}function ZLe(e,t,r){return t&&qI(e.prototype,t),r&&qI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Po(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VI(Object(r),!0).forEach(function(n){jj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jj(e,t,r){return t=LG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LG(e){var t=XLe(e,"string");return jy(t)=="symbol"?t:t+""}function XLe(e,t){if(jy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sR=function(t,r,n,a,i){var o=t.width,l=t.height,c=t.layout,d=t.children,u=Object.keys(r),f={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},h=!!Ci(d,Ri);return u.reduce(function(p,g){var v=r[g],y=v.orientation,_=v.domain,w=v.padding,b=w===void 0?{}:w,N=v.mirror,S=v.reversed,k="".concat(y).concat(N?"Mirror":""),P,A,R,$,O;if(v.type==="number"&&(v.padding==="gap"||v.padding==="no-gap")){var z=_[1]-_[0],D=1/0,B=v.categoricalDomain.sort(d1e);if(B.forEach(function(ne,re){re>0&&(D=Math.min((ne||0)-(B[re-1]||0),D))}),Number.isFinite(D)){var F=D/z,U=v.layout==="vertical"?n.height:n.width;if(v.padding==="gap"&&(P=F*U/2),v.padding==="no-gap"){var G=ph(t.barCategoryGap,F*U),q=F*U/2;P=q-G-(q-G)/U*G}}}a==="xAxis"?A=[n.left+(b.left||0)+(P||0),n.left+n.width-(b.right||0)-(P||0)]:a==="yAxis"?A=c==="horizontal"?[n.top+n.height-(b.bottom||0),n.top+(b.top||0)]:[n.top+(b.top||0)+(P||0),n.top+n.height-(b.bottom||0)-(P||0)]:A=v.range,S&&(A=[A[1],A[0]]);var K=E4e(v,i,h),Z=K.scale,Y=K.realScaleType;Z.domain(_).range(A),C4e(Z);var Q=I4e(Z,Po(Po({},v),{},{realScaleType:Y}));a==="xAxis"?(O=y==="top"&&!N||y==="bottom"&&N,R=n.left,$=f[k]-O*v.height):a==="yAxis"&&(O=y==="left"&&!N||y==="right"&&N,R=f[k]-O*v.width,$=n.top);var X=Po(Po(Po({},v),Q),{},{realScaleType:Y,x:R,y:$,scale:Z,width:a==="xAxis"?n.width:v.width,height:a==="yAxis"?n.height:v.height});return X.bandSize=Yw(X,Q),!v.hide&&a==="xAxis"?f[k]+=(O?-1:1)*X.height:v.hide||(f[k]+=(O?-1:1)*X.width),Po(Po({},p),{},jj({},g,X))},{})},FG=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return{x:Math.min(n,i),y:Math.min(a,o),width:Math.abs(i-n),height:Math.abs(o-a)}},JLe=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return FG({x:r,y:n},{x:a,y:i})},zG=function(){function e(t){KLe(this,e),this.scale=t}return ZLe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(a){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();jj(zG,"EPS",1e-4);var aR=function(t){var r=Object.keys(t).reduce(function(n,a){return Po(Po({},n),{},jj({},a,zG.create(t[a])))},{});return Po(Po({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,l=i.position;return yLe(a,function(c,d){return r[d].apply(c,{bandAware:o,position:l})})},isInRange:function(a){return MG(a,function(i,o){return r[o].isInRange(i)})}})};function QLe(e){return(e%180+180)%180}var e6e=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=QLe(a),o=i*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},t6e=nu,r6e=gx,n6e=lj;function s6e(e){return function(t,r,n){var a=Object(t);if(!r6e(t)){var i=t6e(r);t=n6e(t),r=function(l){return i(a[l],l,a)}}var o=e(t,r,n);return o>-1?a[i?t[o]:o]:void 0}}var a6e=s6e,i6e=TG;function o6e(e){var t=i6e(e),r=t%1;return t===t?r?t-r:t:0}var l6e=o6e,c6e=XW,d6e=nu,u6e=l6e,h6e=Math.max;function f6e(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:u6e(r);return a<0&&(a=h6e(n+a,0)),c6e(e,d6e(t),a)}var m6e=f6e,p6e=a6e,g6e=m6e,v6e=p6e(g6e),y6e=v6e;const x6e=yn(y6e);var _6e=ube(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),iR=x.createContext(void 0),oR=x.createContext(void 0),BG=x.createContext(void 0),UG=x.createContext({}),qG=x.createContext(void 0),VG=x.createContext(0),WG=x.createContext(0),WI=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,o=t.clipPathId,l=t.children,c=t.width,d=t.height,u=_6e(i);return J.createElement(iR.Provider,{value:n},J.createElement(oR.Provider,{value:a},J.createElement(UG.Provider,{value:i},J.createElement(BG.Provider,{value:u},J.createElement(qG.Provider,{value:o},J.createElement(VG.Provider,{value:d},J.createElement(WG.Provider,{value:c},l)))))))},w6e=function(){return x.useContext(qG)},HG=function(t){var r=x.useContext(iR);r==null&&vh();var n=r[t];return n==null&&vh(),n},b6e=function(){var t=x.useContext(iR);return ud(t)},j6e=function(){var t=x.useContext(oR),r=x6e(t,function(n){return MG(n.domain,Number.isFinite)});return r||ud(t)},GG=function(t){var r=x.useContext(oR);r==null&&vh();var n=r[t];return n==null&&vh(),n},N6e=function(){var t=x.useContext(BG);return t},S6e=function(){return x.useContext(UG)},lR=function(){return x.useContext(WG)},cR=function(){return x.useContext(VG)};function Wm(e){"@babel/helpers - typeof";return Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wm(e)}function k6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E6e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KG(n.key),n)}}function C6e(e,t,r){return t&&E6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function P6e(e,t,r){return t=lb(t),T6e(e,YG()?Reflect.construct(t,r||[],lb(e).constructor):t.apply(e,r))}function T6e(e,t){if(t&&(Wm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return A6e(e)}function A6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(YG=function(){return!!e})()}function lb(e){return lb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lb(e)}function R6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WE(e,t)}function WE(e,t){return WE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},WE(e,t)}function HI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function GI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HI(Object(r),!0).forEach(function(n){dR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dR(e,t,r){return t=KG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KG(e){var t=O6e(e,"string");return Wm(t)=="symbol"?t:t+""}function O6e(e,t){if(Wm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function M6e(e,t){return L6e(e)||$6e(e,t)||I6e(e,t)||D6e()}function D6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I6e(e,t){if(e){if(typeof e=="string")return YI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YI(e,t)}}function YI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $6e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function L6e(e){if(Array.isArray(e))return e}function HE(){return HE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HE.apply(this,arguments)}var F6e=function(t,r){var n;return J.isValidElement(t)?n=J.cloneElement(t,r):Ir(t)?n=t(r):n=J.createElement("line",HE({},r,{className:"recharts-reference-line-line"})),n},z6e=function(t,r,n,a,i,o,l,c,d){var u=i.x,f=i.y,h=i.width,p=i.height;if(n){var g=d.y,v=t.y.apply(g,{position:o});if(Rl(d,"discard")&&!t.y.isInRange(v))return null;var y=[{x:u+h,y:v},{x:u,y:v}];return c==="left"?y.reverse():y}if(r){var _=d.x,w=t.x.apply(_,{position:o});if(Rl(d,"discard")&&!t.x.isInRange(w))return null;var b=[{x:w,y:f+p},{x:w,y:f}];return l==="top"?b.reverse():b}if(a){var N=d.segment,S=N.map(function(k){return t.apply(k,{position:o})});return Rl(d,"discard")&&dLe(S,function(k){return!t.isInRange(k)})?null:S}return null};function B6e(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,o=e.shape,l=e.className,c=e.alwaysShow,d=w6e(),u=HG(a),f=GG(i),h=N6e();if(!d||!h)return null;bc(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=aR({x:u.scale,y:f.scale}),g=Ws(t),v=Ws(r),y=n&&n.length===2,_=z6e(p,g,v,y,h,e.position,u.orientation,f.orientation,e);if(!_)return null;var w=M6e(_,2),b=w[0],N=b.x,S=b.y,k=w[1],P=k.x,A=k.y,R=Rl(e,"hidden")?"url(#".concat(d,")"):void 0,$=GI(GI({clipPath:R},Fr(e,!0)),{},{x1:N,y1:S,x2:P,y2:A});return J.createElement(qn,{className:an("recharts-reference-line",l)},F6e(o,$),Ca.renderCallByParent(e,JLe({x1:N,y1:S,x2:P,y2:A})))}var uR=function(e){function t(){return k6e(this,t),P6e(this,t,arguments)}return R6e(t,e),C6e(t,[{key:"render",value:function(){return J.createElement(B6e,this.props)}}])}(J.Component);dR(uR,"displayName","ReferenceLine");dR(uR,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function GE(){return GE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GE.apply(this,arguments)}function Hm(e){"@babel/helpers - typeof";return Hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hm(e)}function KI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ZI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KI(Object(r),!0).forEach(function(n){Nj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q6e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XG(n.key),n)}}function V6e(e,t,r){return t&&q6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function W6e(e,t,r){return t=cb(t),H6e(e,ZG()?Reflect.construct(t,r||[],cb(e).constructor):t.apply(e,r))}function H6e(e,t){if(t&&(Hm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G6e(e)}function G6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ZG=function(){return!!e})()}function cb(e){return cb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cb(e)}function Y6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YE(e,t)}function YE(e,t){return YE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},YE(e,t)}function Nj(e,t,r){return t=XG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XG(e){var t=K6e(e,"string");return Hm(t)=="symbol"?t:t+""}function K6e(e,t){if(Hm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Z6e=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,o=aR({x:a.scale,y:i.scale}),l=o.apply({x:r,y:n},{bandAware:!0});return Rl(t,"discard")&&!o.isInRange(l)?null:l},Sj=function(e){function t(){return U6e(this,t),W6e(this,t,arguments)}return Y6e(t,e),V6e(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,o=n.r,l=n.alwaysShow,c=n.clipPathId,d=Ws(a),u=Ws(i);if(bc(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!d||!u)return null;var f=Z6e(this.props);if(!f)return null;var h=f.x,p=f.y,g=this.props,v=g.shape,y=g.className,_=Rl(this.props,"hidden")?"url(#".concat(c,")"):void 0,w=ZI(ZI({clipPath:_},Fr(this.props,!0)),{},{cx:h,cy:p});return J.createElement(qn,{className:an("recharts-reference-dot",y)},t.renderDot(v,w),Ca.renderCallByParent(this.props,{x:h-o,y:p-o,width:2*o,height:2*o}))}}])}(J.Component);Nj(Sj,"displayName","ReferenceDot");Nj(Sj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Nj(Sj,"renderDot",function(e,t){var r;return J.isValidElement(e)?r=J.cloneElement(e,t):Ir(e)?r=e(t):r=J.createElement(_j,GE({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function KE(){return KE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KE.apply(this,arguments)}function Gm(e){"@babel/helpers - typeof";return Gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gm(e)}function XI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function JI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XI(Object(r),!0).forEach(function(n){kj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J6e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QG(n.key),n)}}function Q6e(e,t,r){return t&&J6e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function eFe(e,t,r){return t=db(t),tFe(e,JG()?Reflect.construct(t,r||[],db(e).constructor):t.apply(e,r))}function tFe(e,t){if(t&&(Gm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rFe(e)}function rFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(JG=function(){return!!e})()}function db(e){return db=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},db(e)}function nFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZE(e,t)}function ZE(e,t){return ZE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ZE(e,t)}function kj(e,t,r){return t=QG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QG(e){var t=sFe(e,"string");return Gm(t)=="symbol"?t:t+""}function sFe(e,t){if(Gm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aFe=function(t,r,n,a,i){var o=i.x1,l=i.x2,c=i.y1,d=i.y2,u=i.xAxis,f=i.yAxis;if(!u||!f)return null;var h=aR({x:u.scale,y:f.scale}),p={x:t?h.x.apply(o,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(c,{position:"start"}):h.y.rangeMin},g={x:r?h.x.apply(l,{position:"end"}):h.x.rangeMax,y:a?h.y.apply(d,{position:"end"}):h.y.rangeMax};return Rl(i,"discard")&&(!h.isInRange(p)||!h.isInRange(g))?null:FG(p,g)},Ej=function(e){function t(){return X6e(this,t),eFe(this,t,arguments)}return nFe(t,e),Q6e(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,o=n.y1,l=n.y2,c=n.className,d=n.alwaysShow,u=n.clipPathId;bc(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=Ws(a),h=Ws(i),p=Ws(o),g=Ws(l),v=this.props.shape;if(!f&&!h&&!p&&!g&&!v)return null;var y=aFe(f,h,p,g,this.props);if(!y&&!v)return null;var _=Rl(this.props,"hidden")?"url(#".concat(u,")"):void 0;return J.createElement(qn,{className:an("recharts-reference-area",c)},t.renderRect(v,JI(JI({clipPath:_},Fr(this.props,!0)),y)),Ca.renderCallByParent(this.props,y))}}])}(J.Component);kj(Ej,"displayName","ReferenceArea");kj(Ej,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});kj(Ej,"renderRect",function(e,t){var r;return J.isValidElement(e)?r=J.cloneElement(e,t):Ir(e)?r=e(t):r=J.createElement(nR,KE({},t,{className:"recharts-reference-area-rect"})),r});function eY(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function iFe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return e6e(n,r)}function oFe(e,t,r){var n=r==="width",a=e.x,i=e.y,o=e.width,l=e.height;return t===1?{start:n?a:i,end:n?a+o:i+l}:{start:n?a+o:i+l,end:n?a:i}}function ub(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function lFe(e,t){return eY(e,t+1)}function cFe(e,t,r,n,a){for(var i=(n||[]).slice(),o=t.start,l=t.end,c=0,d=1,u=o,f=function(){var g=n==null?void 0:n[c];if(g===void 0)return{v:eY(n,d)};var v=c,y,_=function(){return y===void 0&&(y=r(g,v)),y},w=g.coordinate,b=c===0||ub(e,w,_,u,l);b||(c=0,u=o,d+=1),b&&(u=w+e*(_()/2+a),c+=d)},h;d<=i.length;)if(h=f(),h)return h.v;return[]}function Ny(e){"@babel/helpers - typeof";return Ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ny(e)}function QI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QI(Object(r),!0).forEach(function(n){dFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dFe(e,t,r){return t=uFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uFe(e){var t=hFe(e,"string");return Ny(t)=="symbol"?t:t+""}function hFe(e,t){if(Ny(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ny(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fFe(e,t,r,n,a){for(var i=(n||[]).slice(),o=i.length,l=t.start,c=t.end,d=function(h){var p=i[h],g,v=function(){return g===void 0&&(g=r(p,h)),g};if(h===o-1){var y=e*(p.coordinate+e*v()/2-c);i[h]=p=Sa(Sa({},p),{},{tickCoord:y>0?p.coordinate-y*e:p.coordinate})}else i[h]=p=Sa(Sa({},p),{},{tickCoord:p.coordinate});var _=ub(e,p.tickCoord,v,l,c);_&&(c=p.tickCoord-e*(v()/2+a),i[h]=Sa(Sa({},p),{},{isShow:!0}))},u=o-1;u>=0;u--)d(u);return i}function mFe(e,t,r,n,a,i){var o=(n||[]).slice(),l=o.length,c=t.start,d=t.end;if(i){var u=n[l-1],f=r(u,l-1),h=e*(u.coordinate+e*f/2-d);o[l-1]=u=Sa(Sa({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate});var p=ub(e,u.tickCoord,function(){return f},c,d);p&&(d=u.tickCoord-e*(f/2+a),o[l-1]=Sa(Sa({},u),{},{isShow:!0}))}for(var g=i?l-1:l,v=function(w){var b=o[w],N,S=function(){return N===void 0&&(N=r(b,w)),N};if(w===0){var k=e*(b.coordinate-e*S()/2-c);o[w]=b=Sa(Sa({},b),{},{tickCoord:k<0?b.coordinate-k*e:b.coordinate})}else o[w]=b=Sa(Sa({},b),{},{tickCoord:b.coordinate});var P=ub(e,b.tickCoord,S,c,d);P&&(c=b.tickCoord+e*(S()/2+a),o[w]=Sa(Sa({},b),{},{isShow:!0}))},y=0;y<g;y++)v(y);return o}function hR(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,o=e.minTickGap,l=e.orientation,c=e.interval,d=e.tickFormatter,u=e.unit,f=e.angle;if(!a||!a.length||!n)return[];if(Nt(c)||Tl.isSsr)return lFe(a,typeof c=="number"&&Nt(c)?c:0);var h=[],p=l==="top"||l==="bottom"?"width":"height",g=u&&p==="width"?rv(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},v=function(b,N){var S=Ir(d)?d(b.value,N):b.value;return p==="width"?iFe(rv(S,{fontSize:t,letterSpacing:r}),g,f):rv(S,{fontSize:t,letterSpacing:r})[p]},y=a.length>=2?Lo(a[1].coordinate-a[0].coordinate):1,_=oFe(i,y,p);return c==="equidistantPreserveStart"?cFe(y,_,v,a,o):(c==="preserveStart"||c==="preserveStartEnd"?h=mFe(y,_,v,a,o,c==="preserveStartEnd"):h=fFe(y,_,v,a,o),h.filter(function(w){return w.isShow}))}var pFe=["viewBox"],gFe=["viewBox"],vFe=["ticks"];function Ym(e){"@babel/helpers - typeof";return Ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ym(e)}function Rf(){return Rf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rf.apply(this,arguments)}function e$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ds(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e$(Object(r),!0).forEach(function(n){fR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OS(e,t){if(e==null)return{};var r=yFe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yFe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function xFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rY(n.key),n)}}function _Fe(e,t,r){return t&&t$(e.prototype,t),r&&t$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wFe(e,t,r){return t=hb(t),bFe(e,tY()?Reflect.construct(t,r||[],hb(e).constructor):t.apply(e,r))}function bFe(e,t){if(t&&(Ym(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jFe(e)}function jFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(tY=function(){return!!e})()}function hb(e){return hb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hb(e)}function NFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XE(e,t)}function XE(e,t){return XE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},XE(e,t)}function fR(e,t,r){return t=rY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rY(e){var t=SFe(e,"string");return Ym(t)=="symbol"?t:t+""}function SFe(e,t){if(Ym(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ym(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ip=function(e){function t(r){var n;return xFe(this,t),n=wFe(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return NFe(t,e),_Fe(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,o=OS(n,pFe),l=this.props,c=l.viewBox,d=OS(l,gFe);return!Xf(i,c)||!Xf(o,d)||!Xf(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,o=a.y,l=a.width,c=a.height,d=a.orientation,u=a.tickSize,f=a.mirror,h=a.tickMargin,p,g,v,y,_,w,b=f?-1:1,N=n.tickSize||u,S=Nt(n.tickCoord)?n.tickCoord:n.coordinate;switch(d){case"top":p=g=n.coordinate,y=o+ +!f*c,v=y-b*N,w=v-b*h,_=S;break;case"left":v=y=n.coordinate,g=i+ +!f*l,p=g-b*N,_=p-b*h,w=S;break;case"right":v=y=n.coordinate,g=i+ +f*l,p=g+b*N,_=p+b*h,w=S;break;default:p=g=n.coordinate,y=o+ +f*c,v=y+b*N,w=v+b*h,_=S;break}return{line:{x1:p,y1:v,x2:g,y2:y},tick:{x:_,y:w}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o;switch(a){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,l=n.height,c=n.orientation,d=n.mirror,u=n.axisLine,f=Ds(Ds(Ds({},Fr(this.props,!1)),Fr(u,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var h=+(c==="top"&&!d||c==="bottom"&&d);f=Ds(Ds({},f),{},{x1:a,y1:i+h*l,x2:a+o,y2:i+h*l})}else{var p=+(c==="left"&&!d||c==="right"&&d);f=Ds(Ds({},f),{},{x1:a+p*o,y1:i,x2:a+p*o,y2:i+l})}return J.createElement("line",Rf({},f,{className:an("recharts-cartesian-axis-line",io(u,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var o=this,l=this.props,c=l.tickLine,d=l.stroke,u=l.tick,f=l.tickFormatter,h=l.unit,p=hR(Ds(Ds({},this.props),{},{ticks:n}),a,i),g=this.getTickTextAnchor(),v=this.getTickVerticalAnchor(),y=Fr(this.props,!1),_=Fr(u,!1),w=Ds(Ds({},y),{},{fill:"none"},Fr(c,!1)),b=p.map(function(N,S){var k=o.getTickLineCoord(N),P=k.line,A=k.tick,R=Ds(Ds(Ds(Ds({textAnchor:g,verticalAnchor:v},y),{},{stroke:"none",fill:d},_),A),{},{index:S,payload:N,visibleTicksCount:p.length,tickFormatter:f});return J.createElement(qn,Rf({className:"recharts-cartesian-axis-tick",key:"tick-".concat(N.value,"-").concat(N.coordinate,"-").concat(N.tickCoord)},xw(o.props,N,S)),c&&J.createElement("line",Rf({},w,P,{className:an("recharts-cartesian-axis-tick-line",io(c,"className"))})),u&&t.renderTickItem(u,R,"".concat(Ir(f)?f(N.value,S):N.value).concat(h||"")))});return J.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,o=a.width,l=a.height,c=a.ticksGenerator,d=a.className,u=a.hide;if(u)return null;var f=this.props,h=f.ticks,p=OS(f,vFe),g=h;return Ir(c)&&(g=h&&h.length>0?c(this.props):c(p)),o<=0||l<=0||!g||!g.length?null:J.createElement(qn,{className:an("recharts-cartesian-axis",d),ref:function(y){n.layerReference=y}},i&&this.renderAxisLine(),this.renderTicks(g,this.state.fontSize,this.state.letterSpacing),Ca.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var o,l=an(a.className,"recharts-cartesian-axis-tick-value");return J.isValidElement(n)?o=J.cloneElement(n,Ds(Ds({},a),{},{className:l})):Ir(n)?o=n(Ds(Ds({},a),{},{className:l})):o=J.createElement(Ow,Rf({},a,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(x.Component);fR(Ip,"displayName","CartesianAxis");fR(Ip,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var kFe=["x1","y1","x2","y2","key"],EFe=["offset"];function yh(e){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}function r$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r$(Object(r),!0).forEach(function(n){CFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CFe(e,t,r){return t=PFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PFe(e){var t=TFe(e,"string");return yh(t)=="symbol"?t:t+""}function TFe(e,t){if(yh(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yh(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $u(){return $u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$u.apply(this,arguments)}function n$(e,t){if(e==null)return{};var r=AFe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function AFe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var RFe=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,o=t.width,l=t.height,c=t.ry;return J.createElement("rect",{x:a,y:i,ry:c,width:o,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function nY(e,t){var r;if(J.isValidElement(e))r=J.cloneElement(e,t);else if(Ir(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,o=t.y2,l=t.key,c=n$(t,kFe),d=Fr(c,!1);d.offset;var u=n$(d,EFe);r=J.createElement("line",$u({},u,{x1:n,y1:a,x2:i,y2:o,fill:"none",key:l}))}return r}function OFe(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(l,c){var d=Pa(Pa({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return nY(a,d)});return J.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function MFe(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(l,c){var d=Pa(Pa({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return nY(a,d)});return J.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function DFe(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,o=e.height,l=e.horizontalPoints,c=e.horizontal,d=c===void 0?!0:c;if(!d||!t||!t.length)return null;var u=l.map(function(h){return Math.round(h+a-a)}).sort(function(h,p){return h-p});a!==u[0]&&u.unshift(0);var f=u.map(function(h,p){var g=!u[p+1],v=g?a+o-h:u[p+1]-h;if(v<=0)return null;var y=p%t.length;return J.createElement("rect",{key:"react-".concat(p),y:h,x:n,height:v,width:i,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return J.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function IFe(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,o=e.y,l=e.width,c=e.height,d=e.verticalPoints;if(!r||!n||!n.length)return null;var u=d.map(function(h){return Math.round(h+i-i)}).sort(function(h,p){return h-p});i!==u[0]&&u.unshift(0);var f=u.map(function(h,p){var g=!u[p+1],v=g?i+l-h:u[p+1]-h;if(v<=0)return null;var y=p%n.length;return J.createElement("rect",{key:"react-".concat(p),x:h,y:o,width:v,height:c,stroke:"none",fill:n[y],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return J.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var $Fe=function(t,r){var n=t.xAxis,a=t.width,i=t.height,o=t.offset;return gG(hR(Pa(Pa(Pa({},Ip.defaultProps),n),{},{ticks:yc(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.left,o.left+o.width,r)},LFe=function(t,r){var n=t.yAxis,a=t.width,i=t.height,o=t.offset;return gG(hR(Pa(Pa(Pa({},Ip.defaultProps),n),{},{ticks:yc(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.top,o.top+o.height,r)},sf={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function ol(e){var t,r,n,a,i,o,l=lR(),c=cR(),d=S6e(),u=Pa(Pa({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:sf.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:sf.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:sf.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:sf.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:sf.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:sf.verticalFill,x:Nt(e.x)?e.x:d.left,y:Nt(e.y)?e.y:d.top,width:Nt(e.width)?e.width:d.width,height:Nt(e.height)?e.height:d.height}),f=u.x,h=u.y,p=u.width,g=u.height,v=u.syncWithTicks,y=u.horizontalValues,_=u.verticalValues,w=b6e(),b=j6e();if(!Nt(p)||p<=0||!Nt(g)||g<=0||!Nt(f)||f!==+f||!Nt(h)||h!==+h)return null;var N=u.verticalCoordinatesGenerator||$Fe,S=u.horizontalCoordinatesGenerator||LFe,k=u.horizontalPoints,P=u.verticalPoints;if((!k||!k.length)&&Ir(S)){var A=y&&y.length,R=S({yAxis:b?Pa(Pa({},b),{},{ticks:A?y:b.ticks}):void 0,width:l,height:c,offset:d},A?!0:v);bc(Array.isArray(R),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(yh(R),"]")),Array.isArray(R)&&(k=R)}if((!P||!P.length)&&Ir(N)){var $=_&&_.length,O=N({xAxis:w?Pa(Pa({},w),{},{ticks:$?_:w.ticks}):void 0,width:l,height:c,offset:d},$?!0:v);bc(Array.isArray(O),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(yh(O),"]")),Array.isArray(O)&&(P=O)}return J.createElement("g",{className:"recharts-cartesian-grid"},J.createElement(RFe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),J.createElement(OFe,$u({},u,{offset:d,horizontalPoints:k,xAxis:w,yAxis:b})),J.createElement(MFe,$u({},u,{offset:d,verticalPoints:P,xAxis:w,yAxis:b})),J.createElement(DFe,$u({},u,{horizontalPoints:k})),J.createElement(IFe,$u({},u,{verticalPoints:P})))}ol.displayName="CartesianGrid";var FFe=["type","layout","connectNulls","ref"],zFe=["key"];function Km(e){"@babel/helpers - typeof";return Km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Km(e)}function s$(e,t){if(e==null)return{};var r=BFe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function BFe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function iv(){return iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iv.apply(this,arguments)}function a$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ji(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a$(Object(r),!0).forEach(function(n){To(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function af(e){return WFe(e)||VFe(e)||qFe(e)||UFe()}function UFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qFe(e,t){if(e){if(typeof e=="string")return JE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JE(e,t)}}function VFe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WFe(e){if(Array.isArray(e))return JE(e)}function JE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aY(n.key),n)}}function GFe(e,t,r){return t&&i$(e.prototype,t),r&&i$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YFe(e,t,r){return t=fb(t),KFe(e,sY()?Reflect.construct(t,r||[],fb(e).constructor):t.apply(e,r))}function KFe(e,t){if(t&&(Km(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZFe(e)}function ZFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(sY=function(){return!!e})()}function fb(e){return fb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fb(e)}function XFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QE(e,t)}function QE(e,t){return QE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},QE(e,t)}function To(e,t,r){return t=aY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aY(e){var t=JFe(e,"string");return Km(t)=="symbol"?t:t+""}function JFe(e,t){if(Km(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Km(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zm=function(e){function t(){var r;HFe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=YFe(this,t,[].concat(a)),To(r,"state",{isAnimationFinished:!0,totalLength:0}),To(r,"generateSimpleStrokeDasharray",function(o,l){return"".concat(l,"px ").concat(o-l,"px")}),To(r,"getStrokeDasharray",function(o,l,c){var d=c.reduce(function(_,w){return _+w});if(!d)return r.generateSimpleStrokeDasharray(l,o);for(var u=Math.floor(o/d),f=o%d,h=l-o,p=[],g=0,v=0;g<c.length;v+=c[g],++g)if(v+c[g]>f){p=[].concat(af(c.slice(0,g)),[f-v]);break}var y=p.length%2===0?[0,h]:[h];return[].concat(af(t.repeat(c,u)),af(p),y).map(function(_){return"".concat(_,"px")}).join(", ")}),To(r,"id",Pp("recharts-line-")),To(r,"pathRef",function(o){r.mainCurve=o}),To(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),To(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return XFe(t,e),GFe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch(a){return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,l=i.xAxis,c=i.yAxis,d=i.layout,u=i.children,f=oo(u,wx);if(!f)return null;var h=function(v,y){return{x:v.x,y:v.y,value:v.value,errorVal:Ha(v.payload,y)}},p={clipPath:n?"url(#clipPath-".concat(a,")"):null};return J.createElement(qn,p,f.map(function(g){return J.cloneElement(g,{key:"bar-".concat(g.props.dataKey),data:o,xAxis:l,yAxis:c,layout:d,dataPointFormatter:h})}))}},{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,d=l.points,u=l.dataKey,f=Fr(this.props,!1),h=Fr(c,!0),p=d.map(function(v,y){var _=ji(ji(ji({key:"dot-".concat(y),r:3},f),h),{},{index:y,cx:v.x,cy:v.y,value:v.value,dataKey:u,payload:v.payload,points:d});return t.renderDotItem(c,_)}),g={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return J.createElement(qn,iv({className:"recharts-line-dots",key:"dots"},g),p)}},{key:"renderCurveStatically",value:function(n,a,i,o){var l=this.props,c=l.type,d=l.layout,u=l.connectNulls;l.ref;var f=s$(l,FFe),h=ji(ji(ji({},Fr(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},o),{},{type:c,layout:d,connectNulls:u});return J.createElement(em,iv({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,o=this.props,l=o.points,c=o.strokeDasharray,d=o.isAnimationActive,u=o.animationBegin,f=o.animationDuration,h=o.animationEasing,p=o.animationId,g=o.animateNewValues,v=o.width,y=o.height,_=this.state,w=_.prevPoints,b=_.totalLength;return J.createElement(Ll,{begin:u,duration:f,isActive:d,easing:h,from:{t:0},to:{t:1},key:"line-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(N){var S=N.t;if(w){var k=w.length/l.length,P=l.map(function(z,D){var B=Math.floor(D*k);if(w[B]){var F=w[B],U=ha(F.x,z.x),G=ha(F.y,z.y);return ji(ji({},z),{},{x:U(S),y:G(S)})}if(g){var q=ha(v*2,z.x),K=ha(y/2,z.y);return ji(ji({},z),{},{x:q(S),y:K(S)})}return ji(ji({},z),{},{x:z.x,y:z.y})});return i.renderCurveStatically(P,n,a)}var A=ha(0,b),R=A(S),$;if(c){var O="".concat(c).split(/[,\s]+/gim).map(function(z){return parseFloat(z)});$=i.getStrokeDasharray(R,b,O)}else $=i.generateSimpleStrokeDasharray(b,R);return i.renderCurveStatically(l,n,a,{strokeDasharray:$})})}},{key:"renderCurve",value:function(n,a){var i=this.props,o=i.points,l=i.isAnimationActive,c=this.state,d=c.prevPoints,u=c.totalLength;return l&&o&&o.length&&(!d&&u>0||!Fm(d,o))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(o,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,l=a.points,c=a.className,d=a.xAxis,u=a.yAxis,f=a.top,h=a.left,p=a.width,g=a.height,v=a.isAnimationActive,y=a.id;if(i||!l||!l.length)return null;var _=this.state.isAnimationFinished,w=l.length===1,b=an("recharts-line",c),N=d&&d.allowDataOverflow,S=u&&u.allowDataOverflow,k=N||S,P=Yr(y)?this.id:y,A=(n=Fr(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},R=A.r,$=R===void 0?3:R,O=A.strokeWidth,z=O===void 0?2:O,D=lW(o)?o:{},B=D.clipDot,F=B===void 0?!0:B,U=$*2+z;return J.createElement(qn,{className:b},N||S?J.createElement("defs",null,J.createElement("clipPath",{id:"clipPath-".concat(P)},J.createElement("rect",{x:N?h:h-p/2,y:S?f:f-g/2,width:N?p:p*2,height:S?g:g*2})),!F&&J.createElement("clipPath",{id:"clipPath-dots-".concat(P)},J.createElement("rect",{x:h-U/2,y:f-U/2,width:p+U,height:g+U}))):null,!w&&this.renderCurve(k,P),this.renderErrorBar(k,P),(w||o)&&this.renderDots(k,F,P),(!v||_)&&Nc.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(af(n),[0]):n,o=[],l=0;l<a;++l)o=[].concat(af(o),af(i));return o}},{key:"renderDotItem",value:function(n,a){var i;if(J.isValidElement(n))i=J.cloneElement(n,a);else if(Ir(n))i=n(a);else{var o=a.key,l=s$(a,zFe),c=an("recharts-line-dot",typeof n!="boolean"?n.className:"");i=J.createElement(_j,iv({key:o},l,{className:c}))}return i}}])}(x.PureComponent);To(Zm,"displayName","Line");To(Zm,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Tl.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});To(Zm,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,o=e.dataKey,l=e.bandSize,c=e.displayedData,d=e.offset,u=t.layout,f=c.map(function(h,p){var g=Ha(h,o);return u==="horizontal"?{x:Gw({axis:r,ticks:a,bandSize:l,entry:h,index:p}),y:Yr(g)?null:n.scale(g),value:g,payload:h}:{x:Yr(g)?null:r.scale(g),y:Gw({axis:n,ticks:i,bandSize:l,entry:h,index:p}),value:g,payload:h}});return ji({points:f,layout:u},d)});var QFe=["layout","type","stroke","connectNulls","isRange","ref"],eze=["key"],iY;function Xm(e){"@babel/helpers - typeof";return Xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xm(e)}function oY(e,t){if(e==null)return{};var r=tze(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Lu(){return Lu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lu.apply(this,arguments)}function o$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o$(Object(r),!0).forEach(function(n){Sl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cY(n.key),n)}}function nze(e,t,r){return t&&l$(e.prototype,t),r&&l$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sze(e,t,r){return t=mb(t),aze(e,lY()?Reflect.construct(t,r||[],mb(e).constructor):t.apply(e,r))}function aze(e,t){if(t&&(Xm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ize(e)}function ize(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(lY=function(){return!!e})()}function mb(e){return mb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mb(e)}function oze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eC(e,t)}function eC(e,t){return eC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},eC(e,t)}function Sl(e,t,r){return t=cY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cY(e){var t=lze(e,"string");return Xm(t)=="symbol"?t:t+""}function lze(e,t){if(Xm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $c=function(e){function t(){var r;rze(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=sze(this,t,[].concat(a)),Sl(r,"state",{isAnimationFinished:!0}),Sl(r,"id",Pp("recharts-area-")),Sl(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Ir(o)&&o()}),Sl(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Ir(o)&&o()}),r}return oze(t,e),nze(t,[{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(o&&!l)return null;var c=this.props,d=c.dot,u=c.points,f=c.dataKey,h=Fr(this.props,!1),p=Fr(d,!0),g=u.map(function(y,_){var w=nd(nd(nd({key:"dot-".concat(_),r:3},h),p),{},{index:_,cx:y.x,cy:y.y,dataKey:f,value:y.value,payload:y.payload,points:u});return t.renderDotItem(d,w)}),v={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return J.createElement(qn,Lu({className:"recharts-area-dots"},v),g)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,l=a.strokeWidth,c=o[0].x,d=o[o.length-1].x,u=n*Math.abs(c-d),f=wd(o.map(function(h){return h.y||0}));return Nt(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(wd(i.map(function(h){return h.y||0})),f)),Nt(f)?J.createElement("rect",{x:c<d?c:c-u,y:0,width:u,height:Math.floor(f+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,l=a.strokeWidth,c=o[0].y,d=o[o.length-1].y,u=n*Math.abs(c-d),f=wd(o.map(function(h){return h.x||0}));return Nt(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(wd(i.map(function(h){return h.x||0})),f)),Nt(f)?J.createElement("rect",{x:0,y:c<d?c:c-u,width:f+(l?parseInt("".concat(l),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,i,o){var l=this.props,c=l.layout,d=l.type,u=l.stroke,f=l.connectNulls,h=l.isRange;l.ref;var p=oY(l,QFe);return J.createElement(qn,{clipPath:i?"url(#clipPath-".concat(o,")"):null},J.createElement(em,Lu({},Fr(p,!0),{points:n,connectNulls:f,type:d,baseLine:a,layout:c,stroke:"none",className:"recharts-area-area"})),u!=="none"&&J.createElement(em,Lu({},Fr(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:n})),u!=="none"&&h&&J.createElement(em,Lu({},Fr(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var i=this,o=this.props,l=o.points,c=o.baseLine,d=o.isAnimationActive,u=o.animationBegin,f=o.animationDuration,h=o.animationEasing,p=o.animationId,g=this.state,v=g.prevPoints,y=g.prevBaseLine;return J.createElement(Ll,{begin:u,duration:f,isActive:d,easing:h,from:{t:0},to:{t:1},key:"area-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(_){var w=_.t;if(v){var b=v.length/l.length,N=l.map(function(A,R){var $=Math.floor(R*b);if(v[$]){var O=v[$],z=ha(O.x,A.x),D=ha(O.y,A.y);return nd(nd({},A),{},{x:z(w),y:D(w)})}return A}),S;if(Nt(c)&&typeof c=="number"){var k=ha(y,c);S=k(w)}else if(Yr(c)||Cp(c)){var P=ha(y,0);S=P(w)}else S=c.map(function(A,R){var $=Math.floor(R*b);if(y[$]){var O=y[$],z=ha(O.x,A.x),D=ha(O.y,A.y);return nd(nd({},A),{},{x:z(w),y:D(w)})}return A});return i.renderAreaStatically(N,S,n,a)}return J.createElement(qn,null,J.createElement("defs",null,J.createElement("clipPath",{id:"animationClipPath-".concat(a)},i.renderClipRect(w))),J.createElement(qn,{clipPath:"url(#animationClipPath-".concat(a,")")},i.renderAreaStatically(l,c,n,a)))})}},{key:"renderArea",value:function(n,a){var i=this.props,o=i.points,l=i.baseLine,c=i.isAnimationActive,d=this.state,u=d.prevPoints,f=d.prevBaseLine,h=d.totalLength;return c&&o&&o.length&&(!u&&h>0||!Fm(u,o)||!Fm(f,l))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(o,l,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,l=a.points,c=a.className,d=a.top,u=a.left,f=a.xAxis,h=a.yAxis,p=a.width,g=a.height,v=a.isAnimationActive,y=a.id;if(i||!l||!l.length)return null;var _=this.state.isAnimationFinished,w=l.length===1,b=an("recharts-area",c),N=f&&f.allowDataOverflow,S=h&&h.allowDataOverflow,k=N||S,P=Yr(y)?this.id:y,A=(n=Fr(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},R=A.r,$=R===void 0?3:R,O=A.strokeWidth,z=O===void 0?2:O,D=lW(o)?o:{},B=D.clipDot,F=B===void 0?!0:B,U=$*2+z;return J.createElement(qn,{className:b},N||S?J.createElement("defs",null,J.createElement("clipPath",{id:"clipPath-".concat(P)},J.createElement("rect",{x:N?u:u-p/2,y:S?d:d-g/2,width:N?p:p*2,height:S?g:g*2})),!F&&J.createElement("clipPath",{id:"clipPath-dots-".concat(P)},J.createElement("rect",{x:u-U/2,y:d-U/2,width:p+U,height:g+U}))):null,w?null:this.renderArea(k,P),(o||w)&&this.renderDots(k,F,P),(!v||_)&&Nc.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(x.PureComponent);iY=$c;Sl($c,"displayName","Area");Sl($c,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Tl.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Sl($c,"getBaseValue",function(e,t,r,n){var a=e.layout,i=e.baseValue,o=t.props.baseValue,l=o!=null?o:i;if(Nt(l)&&typeof l=="number")return l;var c=a==="horizontal"?n:r,d=c.scale.domain();if(c.type==="number"){var u=Math.max(d[0],d[1]),f=Math.min(d[0],d[1]);return l==="dataMin"?f:l==="dataMax"||u<0?u:Math.max(Math.min(d[0],d[1]),0)}return l==="dataMin"?d[0]:l==="dataMax"?d[1]:d[0]});Sl($c,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,l=e.bandSize,c=e.dataKey,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,h=e.offset,p=t.layout,g=d&&d.length,v=iY.getBaseValue(t,r,n,a),y=p==="horizontal",_=!1,w=f.map(function(N,S){var k;g?k=d[u+S]:(k=Ha(N,c),Array.isArray(k)?_=!0:k=[v,k]);var P=k[1]==null||g&&Ha(N,c)==null;return y?{x:Gw({axis:n,ticks:i,bandSize:l,entry:N,index:S}),y:P?null:a.scale(k[1]),value:k,payload:N}:{x:P?null:n.scale(k[1]),y:Gw({axis:a,ticks:o,bandSize:l,entry:N,index:S}),value:k,payload:N}}),b;return g||_?b=w.map(function(N){var S=Array.isArray(N.value)?N.value[0]:null;return y?{x:N.x,y:S!=null&&N.y!=null?a.scale(S):null}:{x:S!=null?n.scale(S):null,y:N.y}}):b=y?a.scale(v):n.scale(v),nd({points:w,baseLine:b,layout:p,isRange:_},h)});Sl($c,"renderDotItem",function(e,t){var r;if(J.isValidElement(e))r=J.cloneElement(e,t);else if(Ir(e))r=e(t);else{var n=an("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,i=oY(t,eze);r=J.createElement(_j,Lu({},i,{key:a,className:n}))}return r});function Jm(e){"@babel/helpers - typeof";return Jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jm(e)}function cze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hY(n.key),n)}}function uze(e,t,r){return t&&dze(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function hze(e,t,r){return t=pb(t),fze(e,dY()?Reflect.construct(t,r||[],pb(e).constructor):t.apply(e,r))}function fze(e,t){if(t&&(Jm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mze(e)}function mze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(dY=function(){return!!e})()}function pb(e){return pb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pb(e)}function pze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tC(e,t)}function tC(e,t){return tC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},tC(e,t)}function uY(e,t,r){return t=hY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hY(e){var t=gze(e,"string");return Jm(t)=="symbol"?t:t+""}function gze(e,t){if(Jm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rC(){return rC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rC.apply(this,arguments)}function vze(e){var t=e.xAxisId,r=lR(),n=cR(),a=HG(t);return a==null?null:x.createElement(Ip,rC({},a,{className:an("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(o){return yc(o,!0)}}))}var ri=function(e){function t(){return cze(this,t),hze(this,t,arguments)}return pze(t,e),uze(t,[{key:"render",value:function(){return x.createElement(vze,this.props)}}])}(x.Component);uY(ri,"displayName","XAxis");uY(ri,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Qm(e){"@babel/helpers - typeof";return Qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qm(e)}function yze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pY(n.key),n)}}function _ze(e,t,r){return t&&xze(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function wze(e,t,r){return t=gb(t),bze(e,fY()?Reflect.construct(t,r||[],gb(e).constructor):t.apply(e,r))}function bze(e,t){if(t&&(Qm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jze(e)}function jze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(fY=function(){return!!e})()}function gb(e){return gb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gb(e)}function Nze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nC(e,t)}function nC(e,t){return nC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},nC(e,t)}function mY(e,t,r){return t=pY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pY(e){var t=Sze(e,"string");return Qm(t)=="symbol"?t:t+""}function Sze(e,t){if(Qm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sC(){return sC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sC.apply(this,arguments)}var kze=function(t){var r=t.yAxisId,n=lR(),a=cR(),i=GG(r);return i==null?null:x.createElement(Ip,sC({},i,{className:an("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(l){return yc(l,!0)}}))},ni=function(e){function t(){return yze(this,t),wze(this,t,arguments)}return Nze(t,e),_ze(t,[{key:"render",value:function(){return x.createElement(kze,this.props)}}])}(x.Component);mY(ni,"displayName","YAxis");mY(ni,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function c$(e){return Tze(e)||Pze(e)||Cze(e)||Eze()}function Eze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cze(e,t){if(e){if(typeof e=="string")return aC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aC(e,t)}}function Pze(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tze(e){if(Array.isArray(e))return aC(e)}function aC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var iC=function(t,r,n,a,i){var o=oo(t,uR),l=oo(t,Sj),c=[].concat(c$(o),c$(l)),d=oo(t,Ej),u="".concat(a,"Id"),f=a[0],h=r;if(c.length&&(h=c.reduce(function(v,y){if(y.props[u]===n&&Rl(y.props,"extendDomain")&&Nt(y.props[f])){var _=y.props[f];return[Math.min(v[0],_),Math.max(v[1],_)]}return v},h)),d.length){var p="".concat(f,"1"),g="".concat(f,"2");h=d.reduce(function(v,y){if(y.props[u]===n&&Rl(y.props,"extendDomain")&&Nt(y.props[p])&&Nt(y.props[g])){var _=y.props[p],w=y.props[g];return[Math.min(v[0],_,w),Math.max(v[1],_,w)]}return v},h)}return i&&i.length&&(h=i.reduce(function(v,y){return Nt(y)?[Math.min(v[0],y),Math.max(v[1],y)]:v},h)),h},gY={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function i(c,d,u,f,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new a(u,f||c,h),g=r?r+d:d;return c._events[g]?c._events[g].fn?c._events[g]=[c._events[g],p]:c._events[g].push(p):(c._events[g]=p,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,p=f.length,g=new Array(p);h<p;h++)g[h]=f[h].fn;return g},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,h,p,g){var v=r?r+d:d;if(!this._events[v])return!1;var y=this._events[v],_=arguments.length,w,b;if(y.fn){switch(y.once&&this.removeListener(d,y.fn,void 0,!0),_){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,f),!0;case 4:return y.fn.call(y.context,u,f,h),!0;case 5:return y.fn.call(y.context,u,f,h,p),!0;case 6:return y.fn.call(y.context,u,f,h,p,g),!0}for(b=1,w=new Array(_-1);b<_;b++)w[b-1]=arguments[b];y.fn.apply(y.context,w)}else{var N=y.length,S;for(b=0;b<N;b++)switch(y[b].once&&this.removeListener(d,y[b].fn,void 0,!0),_){case 1:y[b].fn.call(y[b].context);break;case 2:y[b].fn.call(y[b].context,u);break;case 3:y[b].fn.call(y[b].context,u,f);break;case 4:y[b].fn.call(y[b].context,u,f,h);break;default:if(!w)for(S=1,w=new Array(_-1);S<_;S++)w[S-1]=arguments[S];y[b].fn.apply(y[b].context,w)}}return!0},l.prototype.on=function(d,u,f){return i(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return i(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,h){var p=r?r+d:d;if(!this._events[p])return this;if(!u)return o(this,p),this;var g=this._events[p];if(g.fn)g.fn===u&&(!h||g.once)&&(!f||g.context===f)&&o(this,p);else{for(var v=0,y=[],_=g.length;v<_;v++)(g[v].fn!==u||h&&!g[v].once||f&&g[v].context!==f)&&y.push(g[v]);y.length?this._events[p]=y.length===1?y[0]:y:o(this,p)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(gY);var Aze=gY.exports;const Rze=yn(Aze);var MS=new Rze,DS="recharts.syncMouseEvents";function Sy(e){"@babel/helpers - typeof";return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sy(e)}function Oze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vY(n.key),n)}}function Dze(e,t,r){return t&&Mze(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function IS(e,t,r){return t=vY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vY(e){var t=Ize(e,"string");return Sy(t)=="symbol"?t:t+""}function Ize(e,t){if(Sy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var $ze=function(){function e(){Oze(this,e),IS(this,"activeIndex",0),IS(this,"coordinateList",[]),IS(this,"layout","horizontal")}return Dze(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,o=r.container,l=o===void 0?null:o,c=r.layout,d=c===void 0?null:c,u=r.offset,f=u===void 0?null:u,h=r.mouseHandlerCallback,p=h===void 0?null:h;this.coordinateList=(n=i!=null?i:this.coordinateList)!==null&&n!==void 0?n:[],this.container=l!=null?l:this.container,this.layout=d!=null?d:this.layout,this.offset=f!=null?f:this.offset,this.mouseHandlerCallback=p!=null?p:this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,o=a.y,l=a.height,c=this.coordinateList[this.activeIndex].coordinate,d=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=i+c+d,h=o+this.offset.top+l/2+u;this.mouseHandlerCallback({pageX:f,pageY:h})}}}])}();function Lze(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&Nt(n)&&Nt(a))return!0}return!1}function Fze(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function yY(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,o=ma(t,r,n,a),l=ma(t,r,n,i);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function zze(e,t,r){var n,a,i,o;if(e==="horizontal")n=t.x,i=n,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,d=t.innerRadius,u=t.outerRadius,f=t.angle,h=ma(l,c,d,f),p=ma(l,c,u,f);n=h.x,a=h.y,i=p.x,o=p.y}else return yY(t);return[{x:n,y:a},{x:i,y:o}]}function ky(e){"@babel/helpers - typeof";return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ky(e)}function d$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function F0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d$(Object(r),!0).forEach(function(n){Bze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bze(e,t,r){return t=Uze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uze(e){var t=qze(e,"string");return ky(t)=="symbol"?t:t+""}function qze(e,t){if(ky(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ky(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vze(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,o=e.activeCoordinate,l=e.activePayload,c=e.offset,d=e.activeTooltipIndex,u=e.tooltipAxisBandSize,f=e.layout,h=e.chartName,p=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!p||!i||!o||h!=="ScatterChart"&&a!=="axis")return null;var g,v=em;if(h==="ScatterChart")g=o,v=MIe;else if(h==="BarChart")g=Fze(f,o,c,u),v=nR;else if(f==="radial"){var y=yY(o),_=y.cx,w=y.cy,b=y.radius,N=y.startAngle,S=y.endAngle;g={cx:_,cy:w,startAngle:N,endAngle:S,innerRadius:b,outerRadius:b},v=wG}else g={points:zze(f,o,c)},v=em;var k=F0(F0(F0(F0({stroke:"#ccc",pointerEvents:"none"},c),g),Fr(p,!1)),{},{payload:l,payloadIndex:d,className:an("recharts-tooltip-cursor",p.className)});return x.isValidElement(p)?x.cloneElement(p,k):x.createElement(v,k)}var Wze=["item"],Hze=["children","className","width","height","style","compact","title","desc"];function ep(e){"@babel/helpers - typeof";return ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ep(e)}function Of(){return Of=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Of.apply(this,arguments)}function u$(e,t){return Kze(e)||Yze(e,t)||_Y(e,t)||Gze()}function Gze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yze(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function Kze(e){if(Array.isArray(e))return e}function h$(e,t){if(e==null)return{};var r=Zze(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Zze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Xze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wY(n.key),n)}}function Qze(e,t,r){return t&&Jze(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function e9e(e,t,r){return t=vb(t),t9e(e,xY()?Reflect.construct(t,r||[],vb(e).constructor):t.apply(e,r))}function t9e(e,t){if(t&&(ep(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r9e(e)}function r9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(xY=function(){return!!e})()}function vb(e){return vb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vb(e)}function n9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oC(e,t)}function oC(e,t){return oC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},oC(e,t)}function tp(e){return i9e(e)||a9e(e)||_Y(e)||s9e()}function s9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Y(e,t){if(e){if(typeof e=="string")return lC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lC(e,t)}}function a9e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function i9e(e){if(Array.isArray(e))return lC(e)}function lC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Je(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f$(Object(r),!0).forEach(function(n){fr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fr(e,t,r){return t=wY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wY(e){var t=o9e(e,"string");return ep(t)=="symbol"?t:t+""}function o9e(e,t){if(ep(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ep(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l9e={xAxis:["bottom","top"],yAxis:["left","right"]},c9e={width:"100%",height:"100%"},bY={x:0,y:0};function z0(e){return e}var d9e=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},u9e=function(t,r,n,a){var i=r.find(function(u){return u&&u.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,l=a.radius;return Je(Je(Je({},a),ma(a.cx,a.cy,l,o)),{},{angle:o,radius:l})}var c=i.coordinate,d=a.angle;return Je(Je(Je({},a),ma(a.cx,a.cy,c,d)),{},{angle:d,radius:c})}return bY},Cj=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,o=(n!=null?n:[]).reduce(function(l,c){var d=c.props.data;return d&&d.length?[].concat(tp(l),tp(d)):l},[]);return o.length>0?o:t&&t.length&&Nt(a)&&Nt(i)?t.slice(a,i+1):[]};function jY(e){return e==="number"?[0,"auto"]:void 0}var cC=function(t,r,n,a){var i=t.graphicalItems,o=t.tooltipAxis,l=Cj(r,t);return n<0||!i||!i.length||n>=l.length?null:i.reduce(function(c,d){var u,f=(u=d.props.data)!==null&&u!==void 0?u:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(o.dataKey&&!o.allowDuplicatedCategory){var p=f===void 0?l:f;h=vw(p,o.dataKey,a)}else h=f&&f[n]||l[n];return h?[].concat(tp(c),[yG(d,h)]):c},[])},m$=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},o=d9e(i,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,d=t.tooltipTicks,u=w4e(o,l,d,c);if(u>=0&&d){var f=d[u]&&d[u].value,h=cC(t,r,u,f),p=u9e(n,l,u,i);return{activeTooltipIndex:u,activeLabel:f,activePayload:h,activeCoordinate:p}}return null},h9e=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,h=t.stackOffset,p=pG(u,i);return n.reduce(function(g,v){var y,_=v.type.defaultProps!==void 0?Je(Je({},v.type.defaultProps),v.props):v.props,w=_.type,b=_.dataKey,N=_.allowDataOverflow,S=_.allowDuplicatedCategory,k=_.scale,P=_.ticks,A=_.includeHidden,R=_[o];if(g[R])return g;var $=Cj(t.data,{graphicalItems:a.filter(function(Q){var X,ne=o in Q.props?Q.props[o]:(X=Q.type.defaultProps)===null||X===void 0?void 0:X[o];return ne===R}),dataStartIndex:c,dataEndIndex:d}),O=$.length,z,D,B;Lze(_.domain,N,w)&&(z=kE(_.domain,null,N),p&&(w==="number"||k!=="auto")&&(B=sv($,b,"category")));var F=jY(w);if(!z||z.length===0){var U,G=(U=_.domain)!==null&&U!==void 0?U:F;if(b){if(z=sv($,b,w),w==="category"&&p){var q=c1e(z);S&&q?(D=z,z=nb(0,O)):S||(z=VD(G,z,v).reduce(function(Q,X){return Q.indexOf(X)>=0?Q:[].concat(tp(Q),[X])},[]))}else if(w==="category")S?z=z.filter(function(Q){return Q!==""&&!Yr(Q)}):z=VD(G,z,v).reduce(function(Q,X){return Q.indexOf(X)>=0||X===""||Yr(X)?Q:[].concat(tp(Q),[X])},[]);else if(w==="number"){var K=k4e($,a.filter(function(Q){var X,ne,re=o in Q.props?Q.props[o]:(X=Q.type.defaultProps)===null||X===void 0?void 0:X[o],ye="hide"in Q.props?Q.props.hide:(ne=Q.type.defaultProps)===null||ne===void 0?void 0:ne.hide;return re===R&&(A||!ye)}),b,i,u);K&&(z=K)}p&&(w==="number"||k!=="auto")&&(B=sv($,b,"category"))}else p?z=nb(0,O):l&&l[R]&&l[R].hasStack&&w==="number"?z=h==="expand"?[0,1]:vG(l[R].stackGroups,c,d):z=mG($,a.filter(function(Q){var X=o in Q.props?Q.props[o]:Q.type.defaultProps[o],ne="hide"in Q.props?Q.props.hide:Q.type.defaultProps.hide;return X===R&&(A||!ne)}),w,u,!0);if(w==="number")z=iC(f,z,R,i,P),G&&(z=kE(G,z,N));else if(w==="category"&&G){var Z=G,Y=z.every(function(Q){return Z.indexOf(Q)>=0});Y&&(z=Z)}}return Je(Je({},g),{},fr({},R,Je(Je({},_),{},{axisType:i,domain:z,categoricalDomain:B,duplicateDomain:D,originalDomain:(y=_.domain)!==null&&y!==void 0?y:F,isCategorical:p,layout:u})))},{})},f9e=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,h=Cj(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:d}),p=h.length,g=pG(u,i),v=-1;return n.reduce(function(y,_){var w=_.type.defaultProps!==void 0?Je(Je({},_.type.defaultProps),_.props):_.props,b=w[o],N=jY("number");if(!y[b]){v++;var S;return g?S=nb(0,p):l&&l[b]&&l[b].hasStack?(S=vG(l[b].stackGroups,c,d),S=iC(f,S,b,i)):(S=kE(N,mG(h,n.filter(function(k){var P,A,R=o in k.props?k.props[o]:(P=k.type.defaultProps)===null||P===void 0?void 0:P[o],$="hide"in k.props?k.props.hide:(A=k.type.defaultProps)===null||A===void 0?void 0:A.hide;return R===b&&!$}),"number",u),a.defaultProps.allowDataOverflow),S=iC(f,S,b,i)),Je(Je({},y),{},fr({},b,Je(Je({axisType:i},a.defaultProps),{},{hide:!0,orientation:io(l9e,"".concat(i,".").concat(v%2),null),domain:S,originalDomain:N,isCategorical:g,layout:u})))}return y},{})},m9e=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.children,f="".concat(a,"Id"),h=oo(u,i),p={};return h&&h.length?p=h9e(t,{axes:h,graphicalItems:o,axisType:a,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):o&&o.length&&(p=f9e(t,{Axis:i,graphicalItems:o,axisType:a,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),p},p9e=function(t){var r=ud(t),n=yc(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:TA(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Yw(r,n)}},p$=function(t){var r=t.children,n=t.defaultShowTooltip,a=Ci(r,qm),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},g9e=function(t){return!t||!t.length?!1:t.some(function(r){var n=wc(r&&r.type);return n&&n.indexOf("Bar")>=0})},g$=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},v9e=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,l=t.yAxisMap,c=l===void 0?{}:l,d=n.width,u=n.height,f=n.children,h=n.margin||{},p=Ci(f,qm),g=Ci(f,Zu),v=Object.keys(c).reduce(function(S,k){var P=c[k],A=P.orientation;return!P.mirror&&!P.hide?Je(Je({},S),{},fr({},A,S[A]+P.width)):S},{left:h.left||0,right:h.right||0}),y=Object.keys(o).reduce(function(S,k){var P=o[k],A=P.orientation;return!P.mirror&&!P.hide?Je(Je({},S),{},fr({},A,io(S,"".concat(A))+P.height)):S},{top:h.top||0,bottom:h.bottom||0}),_=Je(Je({},y),v),w=_.bottom;p&&(_.bottom+=p.props.height||qm.defaultProps.height),g&&r&&(_=N4e(_,a,n,r));var b=d-_.left-_.right,N=u-_.top-_.bottom;return Je(Je({brushBottom:w},_),{},{width:Math.max(b,0),height:Math.max(N,0)})},y9e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},mR=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,o=t.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=t.axisComponents,d=t.legendContent,u=t.formatAxisMap,f=t.defaultProps,h=function(_,w){var b=w.graphicalItems,N=w.stackGroups,S=w.offset,k=w.updateId,P=w.dataStartIndex,A=w.dataEndIndex,R=_.barSize,$=_.layout,O=_.barGap,z=_.barCategoryGap,D=_.maxBarSize,B=g$($),F=B.numericAxisName,U=B.cateAxisName,G=g9e(b),q=[];return b.forEach(function(K,Z){var Y=Cj(_.data,{graphicalItems:[K],dataStartIndex:P,dataEndIndex:A}),Q=K.type.defaultProps!==void 0?Je(Je({},K.type.defaultProps),K.props):K.props,X=Q.dataKey,ne=Q.maxBarSize,re=Q["".concat(F,"Id")],ye=Q["".concat(U,"Id")],ee={},de=c.reduce(function(Xe,ge){var We=w["".concat(ge.axisType,"Map")],Ue=Q["".concat(ge.axisType,"Id")];We&&We[Ue]||ge.axisType==="zAxis"||vh();var at=We[Ue];return Je(Je({},Xe),{},fr(fr({},ge.axisType,at),"".concat(ge.axisType,"Ticks"),yc(at)))},ee),xe=de[U],ie=de["".concat(U,"Ticks")],se=N&&N[re]&&N[re].hasStack&&L4e(K,N[re].stackGroups),V=wc(K.type).indexOf("Bar")>=0,ue=Yw(xe,ie),_e=[],ae=G&&b4e({barSize:R,stackGroups:N,totalSize:y9e(de,U)});if(V){var we,oe,ce=Yr(ne)?D:ne,Ae=(we=(oe=Yw(xe,ie,!0))!==null&&oe!==void 0?oe:ce)!==null&&we!==void 0?we:0;_e=j4e({barGap:O,barCategoryGap:z,bandSize:Ae!==ue?Ae:ue,sizeList:ae[ye],maxBarSize:ce}),Ae!==ue&&(_e=_e.map(function(Xe){return Je(Je({},Xe),{},{position:Je(Je({},Xe.position),{},{offset:Xe.position.offset-Ae/2})})}))}var Be=K&&K.type&&K.type.getComposedData;Be&&q.push({props:Je(Je({},Be(Je(Je({},de),{},{displayedData:Y,props:_,dataKey:X,item:K,bandSize:ue,barPosition:_e,offset:S,stackedData:se,layout:$,dataStartIndex:P,dataEndIndex:A}))),{},fr(fr(fr({key:K.key||"item-".concat(Z)},F,de[F]),U,de[U]),"animationId",k)),childIndex:w1e(K,_.children),item:K})}),q},p=function(_,w){var b=_.props,N=_.dataStartIndex,S=_.dataEndIndex,k=_.updateId;if(!L4({props:b}))return null;var P=b.children,A=b.layout,R=b.stackOffset,$=b.data,O=b.reverseStackOrder,z=g$(A),D=z.numericAxisName,B=z.cateAxisName,F=oo(P,n),U=D4e($,F,"".concat(D,"Id"),"".concat(B,"Id"),R,O),G=c.reduce(function(Q,X){var ne="".concat(X.axisType,"Map");return Je(Je({},Q),{},fr({},ne,m9e(b,Je(Je({},X),{},{graphicalItems:F,stackGroups:X.axisType===D&&U,dataStartIndex:N,dataEndIndex:S}))))},{}),q=v9e(Je(Je({},G),{},{props:b,graphicalItems:F}),w==null?void 0:w.legendBBox);Object.keys(G).forEach(function(Q){G[Q]=u(b,G[Q],q,Q.replace("Map",""),r)});var K=G["".concat(B,"Map")],Z=p9e(K),Y=h(b,Je(Je({},G),{},{dataStartIndex:N,dataEndIndex:S,updateId:k,graphicalItems:F,stackGroups:U,offset:q}));return Je(Je({formattedGraphicalItems:Y,graphicalItems:F,offset:q,stackGroups:U},Z),G)},g=function(y){function _(w){var b,N,S;return Xze(this,_),S=e9e(this,_,[w]),fr(S,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),fr(S,"accessibilityManager",new $ze),fr(S,"handleLegendBBoxUpdate",function(k){if(k){var P=S.state,A=P.dataStartIndex,R=P.dataEndIndex,$=P.updateId;S.setState(Je({legendBBox:k},p({props:S.props,dataStartIndex:A,dataEndIndex:R,updateId:$},Je(Je({},S.state),{},{legendBBox:k}))))}}),fr(S,"handleReceiveSyncEvent",function(k,P,A){if(S.props.syncId===k){if(A===S.eventEmitterSymbol&&typeof S.props.syncMethod!="function")return;S.applySyncEvent(P)}}),fr(S,"handleBrushChange",function(k){var P=k.startIndex,A=k.endIndex;if(P!==S.state.dataStartIndex||A!==S.state.dataEndIndex){var R=S.state.updateId;S.setState(function(){return Je({dataStartIndex:P,dataEndIndex:A},p({props:S.props,dataStartIndex:P,dataEndIndex:A,updateId:R},S.state))}),S.triggerSyncEvent({dataStartIndex:P,dataEndIndex:A})}}),fr(S,"handleMouseEnter",function(k){var P=S.getMouseInfo(k);if(P){var A=Je(Je({},P),{},{isTooltipActive:!0});S.setState(A),S.triggerSyncEvent(A);var R=S.props.onMouseEnter;Ir(R)&&R(A,k)}}),fr(S,"triggeredAfterMouseMove",function(k){var P=S.getMouseInfo(k),A=P?Je(Je({},P),{},{isTooltipActive:!0}):{isTooltipActive:!1};S.setState(A),S.triggerSyncEvent(A);var R=S.props.onMouseMove;Ir(R)&&R(A,k)}),fr(S,"handleItemMouseEnter",function(k){S.setState(function(){return{isTooltipActive:!0,activeItem:k,activePayload:k.tooltipPayload,activeCoordinate:k.tooltipPosition||{x:k.cx,y:k.cy}}})}),fr(S,"handleItemMouseLeave",function(){S.setState(function(){return{isTooltipActive:!1}})}),fr(S,"handleMouseMove",function(k){k.persist(),S.throttleTriggeredAfterMouseMove(k)}),fr(S,"handleMouseLeave",function(k){S.throttleTriggeredAfterMouseMove.cancel();var P={isTooltipActive:!1};S.setState(P),S.triggerSyncEvent(P);var A=S.props.onMouseLeave;Ir(A)&&A(P,k)}),fr(S,"handleOuterEvent",function(k){var P=_1e(k),A=io(S.props,"".concat(P));if(P&&Ir(A)){var R,$;/.*touch.*/i.test(P)?$=S.getMouseInfo(k.changedTouches[0]):$=S.getMouseInfo(k),A((R=$)!==null&&R!==void 0?R:{},k)}}),fr(S,"handleClick",function(k){var P=S.getMouseInfo(k);if(P){var A=Je(Je({},P),{},{isTooltipActive:!0});S.setState(A),S.triggerSyncEvent(A);var R=S.props.onClick;Ir(R)&&R(A,k)}}),fr(S,"handleMouseDown",function(k){var P=S.props.onMouseDown;if(Ir(P)){var A=S.getMouseInfo(k);P(A,k)}}),fr(S,"handleMouseUp",function(k){var P=S.props.onMouseUp;if(Ir(P)){var A=S.getMouseInfo(k);P(A,k)}}),fr(S,"handleTouchMove",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&S.throttleTriggeredAfterMouseMove(k.changedTouches[0])}),fr(S,"handleTouchStart",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&S.handleMouseDown(k.changedTouches[0])}),fr(S,"handleTouchEnd",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&S.handleMouseUp(k.changedTouches[0])}),fr(S,"handleDoubleClick",function(k){var P=S.props.onDoubleClick;if(Ir(P)){var A=S.getMouseInfo(k);P(A,k)}}),fr(S,"handleContextMenu",function(k){var P=S.props.onContextMenu;if(Ir(P)){var A=S.getMouseInfo(k);P(A,k)}}),fr(S,"triggerSyncEvent",function(k){S.props.syncId!==void 0&&MS.emit(DS,S.props.syncId,k,S.eventEmitterSymbol)}),fr(S,"applySyncEvent",function(k){var P=S.props,A=P.layout,R=P.syncMethod,$=S.state.updateId,O=k.dataStartIndex,z=k.dataEndIndex;if(k.dataStartIndex!==void 0||k.dataEndIndex!==void 0)S.setState(Je({dataStartIndex:O,dataEndIndex:z},p({props:S.props,dataStartIndex:O,dataEndIndex:z,updateId:$},S.state)));else if(k.activeTooltipIndex!==void 0){var D=k.chartX,B=k.chartY,F=k.activeTooltipIndex,U=S.state,G=U.offset,q=U.tooltipTicks;if(!G)return;if(typeof R=="function")F=R(q,k);else if(R==="value"){F=-1;for(var K=0;K<q.length;K++)if(q[K].value===k.activeLabel){F=K;break}}var Z=Je(Je({},G),{},{x:G.left,y:G.top}),Y=Math.min(D,Z.x+Z.width),Q=Math.min(B,Z.y+Z.height),X=q[F]&&q[F].value,ne=cC(S.state,S.props.data,F),re=q[F]?{x:A==="horizontal"?q[F].coordinate:Y,y:A==="horizontal"?Q:q[F].coordinate}:bY;S.setState(Je(Je({},k),{},{activeLabel:X,activeCoordinate:re,activePayload:ne,activeTooltipIndex:F}))}else S.setState(k)}),fr(S,"renderCursor",function(k){var P,A=S.state,R=A.isTooltipActive,$=A.activeCoordinate,O=A.activePayload,z=A.offset,D=A.activeTooltipIndex,B=A.tooltipAxisBandSize,F=S.getTooltipEventType(),U=(P=k.props.active)!==null&&P!==void 0?P:R,G=S.props.layout,q=k.key||"_recharts-cursor";return J.createElement(Vze,{key:q,activeCoordinate:$,activePayload:O,activeTooltipIndex:D,chartName:r,element:k,isActive:U,layout:G,offset:z,tooltipAxisBandSize:B,tooltipEventType:F})}),fr(S,"renderPolarAxis",function(k,P,A){var R=io(k,"type.axisType"),$=io(S.state,"".concat(R,"Map")),O=k.type.defaultProps,z=O!==void 0?Je(Je({},O),k.props):k.props,D=$&&$[z["".concat(R,"Id")]];return x.cloneElement(k,Je(Je({},D),{},{className:an(R,D.className),key:k.key||"".concat(P,"-").concat(A),ticks:yc(D,!0)}))}),fr(S,"renderPolarGrid",function(k){var P=k.props,A=P.radialLines,R=P.polarAngles,$=P.polarRadius,O=S.state,z=O.radiusAxisMap,D=O.angleAxisMap,B=ud(z),F=ud(D),U=F.cx,G=F.cy,q=F.innerRadius,K=F.outerRadius;return x.cloneElement(k,{polarAngles:Array.isArray(R)?R:yc(F,!0).map(function(Z){return Z.coordinate}),polarRadius:Array.isArray($)?$:yc(B,!0).map(function(Z){return Z.coordinate}),cx:U,cy:G,innerRadius:q,outerRadius:K,key:k.key||"polar-grid",radialLines:A})}),fr(S,"renderLegend",function(){var k=S.state.formattedGraphicalItems,P=S.props,A=P.children,R=P.width,$=P.height,O=S.props.margin||{},z=R-(O.left||0)-(O.right||0),D=hG({children:A,formattedGraphicalItems:k,legendWidth:z,legendContent:d});if(!D)return null;var B=D.item,F=h$(D,Wze);return x.cloneElement(B,Je(Je({},F),{},{chartWidth:R,chartHeight:$,margin:O,onBBoxUpdate:S.handleLegendBBoxUpdate}))}),fr(S,"renderTooltip",function(){var k,P=S.props,A=P.children,R=P.accessibilityLayer,$=Ci(A,ea);if(!$)return null;var O=S.state,z=O.isTooltipActive,D=O.activeCoordinate,B=O.activePayload,F=O.activeLabel,U=O.offset,G=(k=$.props.active)!==null&&k!==void 0?k:z;return x.cloneElement($,{viewBox:Je(Je({},U),{},{x:U.left,y:U.top}),active:G,label:F,payload:G?B:[],coordinate:D,accessibilityLayer:R})}),fr(S,"renderBrush",function(k){var P=S.props,A=P.margin,R=P.data,$=S.state,O=$.offset,z=$.dataStartIndex,D=$.dataEndIndex,B=$.updateId;return x.cloneElement(k,{key:k.key||"_recharts-brush",onChange:D0(S.handleBrushChange,k.props.onChange),data:R,x:Nt(k.props.x)?k.props.x:O.left,y:Nt(k.props.y)?k.props.y:O.top+O.height+O.brushBottom-(A.bottom||0),width:Nt(k.props.width)?k.props.width:O.width,startIndex:z,endIndex:D,updateId:"brush-".concat(B)})}),fr(S,"renderReferenceElement",function(k,P,A){if(!k)return null;var R=S,$=R.clipPathId,O=S.state,z=O.xAxisMap,D=O.yAxisMap,B=O.offset,F=k.type.defaultProps||{},U=k.props,G=U.xAxisId,q=G===void 0?F.xAxisId:G,K=U.yAxisId,Z=K===void 0?F.yAxisId:K;return x.cloneElement(k,{key:k.key||"".concat(P,"-").concat(A),xAxis:z[q],yAxis:D[Z],viewBox:{x:B.left,y:B.top,width:B.width,height:B.height},clipPathId:$})}),fr(S,"renderActivePoints",function(k){var P=k.item,A=k.activePoint,R=k.basePoint,$=k.childIndex,O=k.isRange,z=[],D=P.props.key,B=P.item.type.defaultProps!==void 0?Je(Je({},P.item.type.defaultProps),P.item.props):P.item.props,F=B.activeDot,U=B.dataKey,G=Je(Je({index:$,dataKey:U,cx:A.x,cy:A.y,r:4,fill:rR(P.item),strokeWidth:2,stroke:"#fff",payload:A.payload,value:A.value},Fr(F,!1)),yw(F));return z.push(_.renderActiveDot(F,G,"".concat(D,"-activePoint-").concat($))),R?z.push(_.renderActiveDot(F,Je(Je({},G),{},{cx:R.x,cy:R.y}),"".concat(D,"-basePoint-").concat($))):O&&z.push(null),z}),fr(S,"renderGraphicChild",function(k,P,A){var R=S.filterFormatItem(k,P,A);if(!R)return null;var $=S.getTooltipEventType(),O=S.state,z=O.isTooltipActive,D=O.tooltipAxis,B=O.activeTooltipIndex,F=O.activeLabel,U=S.props.children,G=Ci(U,ea),q=R.props,K=q.points,Z=q.isRange,Y=q.baseLine,Q=R.item.type.defaultProps!==void 0?Je(Je({},R.item.type.defaultProps),R.item.props):R.item.props,X=Q.activeDot,ne=Q.hide,re=Q.activeBar,ye=Q.activeShape,ee=!!(!ne&&z&&G&&(X||re||ye)),de={};$!=="axis"&&G&&G.props.trigger==="click"?de={onClick:D0(S.handleItemMouseEnter,k.props.onClick)}:$!=="axis"&&(de={onMouseLeave:D0(S.handleItemMouseLeave,k.props.onMouseLeave),onMouseEnter:D0(S.handleItemMouseEnter,k.props.onMouseEnter)});var xe=x.cloneElement(k,Je(Je({},R.props),de));function ie(ge){return typeof D.dataKey=="function"?D.dataKey(ge.payload):null}if(ee)if(B>=0){var se,V;if(D.dataKey&&!D.allowDuplicatedCategory){var ue=typeof D.dataKey=="function"?ie:"payload.".concat(D.dataKey.toString());se=vw(K,ue,F),V=Z&&Y&&vw(Y,ue,F)}else se=K==null?void 0:K[B],V=Z&&Y&&Y[B];if(ye||re){var _e=k.props.activeIndex!==void 0?k.props.activeIndex:B;return[x.cloneElement(k,Je(Je(Je({},R.props),de),{},{activeIndex:_e})),null,null]}if(!Yr(se))return[xe].concat(tp(S.renderActivePoints({item:R,activePoint:se,basePoint:V,childIndex:B,isRange:Z})))}else{var ae,we=(ae=S.getItemByXY(S.state.activeCoordinate))!==null&&ae!==void 0?ae:{graphicalItem:xe},oe=we.graphicalItem,ce=oe.item,Ae=ce===void 0?k:ce,Be=oe.childIndex,Xe=Je(Je(Je({},R.props),de),{},{activeIndex:Be});return[x.cloneElement(Ae,Xe),null,null]}return Z?[xe,null,null]:[xe,null]}),fr(S,"renderCustomized",function(k,P,A){return x.cloneElement(k,Je(Je({key:"recharts-customized-".concat(A)},S.props),S.state))}),fr(S,"renderMap",{CartesianGrid:{handler:z0,once:!0},ReferenceArea:{handler:S.renderReferenceElement},ReferenceLine:{handler:z0},ReferenceDot:{handler:S.renderReferenceElement},XAxis:{handler:z0},YAxis:{handler:z0},Brush:{handler:S.renderBrush,once:!0},Bar:{handler:S.renderGraphicChild},Line:{handler:S.renderGraphicChild},Area:{handler:S.renderGraphicChild},Radar:{handler:S.renderGraphicChild},RadialBar:{handler:S.renderGraphicChild},Scatter:{handler:S.renderGraphicChild},Pie:{handler:S.renderGraphicChild},Funnel:{handler:S.renderGraphicChild},Tooltip:{handler:S.renderCursor,once:!0},PolarGrid:{handler:S.renderPolarGrid,once:!0},PolarAngleAxis:{handler:S.renderPolarAxis},PolarRadiusAxis:{handler:S.renderPolarAxis},Customized:{handler:S.renderCustomized}}),S.clipPathId="".concat((b=w.id)!==null&&b!==void 0?b:Pp("recharts"),"-clip"),S.throttleTriggeredAfterMouseMove=uH(S.triggeredAfterMouseMove,(N=w.throttleDelay)!==null&&N!==void 0?N:1e3/60),S.state={},S}return n9e(_,y),Qze(_,[{key:"componentDidMount",value:function(){var b,N;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(N=this.props.margin.top)!==null&&N!==void 0?N:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,N=b.children,S=b.data,k=b.height,P=b.layout,A=Ci(N,ea);if(A){var R=A.props.defaultIndex;if(!(typeof R!="number"||R<0||R>this.state.tooltipTicks.length-1)){var $=this.state.tooltipTicks[R]&&this.state.tooltipTicks[R].value,O=cC(this.state,S,R,$),z=this.state.tooltipTicks[R].coordinate,D=(this.state.offset.top+k)/2,B=P==="horizontal",F=B?{x:z,y:D}:{y:z,x:D},U=this.state.formattedGraphicalItems.find(function(q){var K=q.item;return K.type.name==="Scatter"});U&&(F=Je(Je({},F),U.props.points[R].tooltipPosition),O=U.props.points[R].tooltipPayload);var G={activeTooltipIndex:R,isTooltipActive:!0,activeLabel:$,activePayload:O,activeCoordinate:F};this.setState(G),this.renderCursor(A),this.accessibilityManager.setIndex(R)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,N){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==N.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var S,k;this.accessibilityManager.setDetails({offset:{left:(S=this.props.margin.left)!==null&&S!==void 0?S:0,top:(k=this.props.margin.top)!==null&&k!==void 0?k:0}})}return null}},{key:"componentDidUpdate",value:function(b){B2([Ci(b.children,ea)],[Ci(this.props.children,ea)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=Ci(this.props.children,ea);if(b&&typeof b.props.shared=="boolean"){var N=b.props.shared?"axis":"item";return l.indexOf(N)>=0?N:i}return i}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var N=this.container,S=N.getBoundingClientRect(),k=GAe(S),P={chartX:Math.round(b.pageX-k.left),chartY:Math.round(b.pageY-k.top)},A=S.width/N.offsetWidth||1,R=this.inRange(P.chartX,P.chartY,A);if(!R)return null;var $=this.state,O=$.xAxisMap,z=$.yAxisMap,D=this.getTooltipEventType(),B=m$(this.state,this.props.data,this.props.layout,R);if(D!=="axis"&&O&&z){var F=ud(O).scale,U=ud(z).scale,G=F&&F.invert?F.invert(P.chartX):null,q=U&&U.invert?U.invert(P.chartY):null;return Je(Je({},P),{},{xValue:G,yValue:q},B)}return B?Je(Je({},P),B):null}},{key:"inRange",value:function(b,N){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,k=this.props.layout,P=b/S,A=N/S;if(k==="horizontal"||k==="vertical"){var R=this.state.offset,$=P>=R.left&&P<=R.left+R.width&&A>=R.top&&A<=R.top+R.height;return $?{x:P,y:A}:null}var O=this.state,z=O.angleAxisMap,D=O.radiusAxisMap;if(z&&D){var B=ud(z);return GD({x:P,y:A},B)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,N=this.getTooltipEventType(),S=Ci(b,ea),k={};S&&N==="axis"&&(S.props.trigger==="click"?k={onClick:this.handleClick}:k={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var P=yw(this.props,this.handleOuterEvent);return Je(Je({},P),k)}},{key:"addListener",value:function(){MS.on(DS,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){MS.removeListener(DS,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,N,S){for(var k=this.state.formattedGraphicalItems,P=0,A=k.length;P<A;P++){var R=k[P];if(R.item===b||R.props.key===b.key||N===wc(R.item.type)&&S===R.childIndex)return R}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,N=this.state.offset,S=N.left,k=N.top,P=N.height,A=N.width;return J.createElement("defs",null,J.createElement("clipPath",{id:b},J.createElement("rect",{x:S,y:k,height:P,width:A})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(N,S){var k=u$(S,2),P=k[0],A=k[1];return Je(Je({},N),{},fr({},P,A.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(N,S){var k=u$(S,2),P=k[0],A=k[1];return Je(Je({},N),{},fr({},P,A.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var N;return(N=this.state.xAxisMap)===null||N===void 0||(N=N[b])===null||N===void 0?void 0:N.scale}},{key:"getYScaleByAxisId",value:function(b){var N;return(N=this.state.yAxisMap)===null||N===void 0||(N=N[b])===null||N===void 0?void 0:N.scale}},{key:"getItemByXY",value:function(b){var N=this.state,S=N.formattedGraphicalItems,k=N.activeItem;if(S&&S.length)for(var P=0,A=S.length;P<A;P++){var R=S[P],$=R.props,O=R.item,z=O.type.defaultProps!==void 0?Je(Je({},O.type.defaultProps),O.props):O.props,D=wc(O.type);if(D==="Bar"){var B=($.data||[]).find(function(q){return NIe(b,q)});if(B)return{graphicalItem:R,payload:B}}else if(D==="RadialBar"){var F=($.data||[]).find(function(q){return GD(b,q)});if(F)return{graphicalItem:R,payload:F}}else if(wj(R,k)||bj(R,k)||_y(R,k)){var U=E$e({graphicalItem:R,activeTooltipItem:k,itemData:z.data}),G=z.activeIndex===void 0?U:z.activeIndex;return{graphicalItem:Je(Je({},R),{},{childIndex:G}),payload:_y(R,k)?z.data[U]:R.props.data[U]}}}return null}},{key:"render",value:function(){var b=this;if(!L4(this))return null;var N=this.props,S=N.children,k=N.className,P=N.width,A=N.height,R=N.style,$=N.compact,O=N.title,z=N.desc,D=h$(N,Hze),B=Fr(D,!1);if($)return J.createElement(WI,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},J.createElement(q2,Of({},B,{width:P,height:A,title:O,desc:z}),this.renderClipPath(),z4(S,this.renderMap)));if(this.props.accessibilityLayer){var F,U;B.tabIndex=(F=this.props.tabIndex)!==null&&F!==void 0?F:0,B.role=(U=this.props.role)!==null&&U!==void 0?U:"application",B.onKeyDown=function(q){b.accessibilityManager.keyboardEvent(q)},B.onFocus=function(){b.accessibilityManager.focus()}}var G=this.parseEventsOfWrapper();return J.createElement(WI,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},J.createElement("div",Of({className:an("recharts-wrapper",k),style:Je({position:"relative",cursor:"default",width:P,height:A},R)},G,{ref:function(K){b.container=K}}),J.createElement(q2,Of({},B,{width:P,height:A,title:O,desc:z,style:c9e}),this.renderClipPath(),z4(S,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(x.Component);fr(g,"displayName",r),fr(g,"defaultProps",Je({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),fr(g,"getDerivedStateFromProps",function(y,_){var w=y.dataKey,b=y.data,N=y.children,S=y.width,k=y.height,P=y.layout,A=y.stackOffset,R=y.margin,$=_.dataStartIndex,O=_.dataEndIndex;if(_.updateId===void 0){var z=p$(y);return Je(Je(Je({},z),{},{updateId:0},p(Je(Je({props:y},z),{},{updateId:0}),_)),{},{prevDataKey:w,prevData:b,prevWidth:S,prevHeight:k,prevLayout:P,prevStackOffset:A,prevMargin:R,prevChildren:N})}if(w!==_.prevDataKey||b!==_.prevData||S!==_.prevWidth||k!==_.prevHeight||P!==_.prevLayout||A!==_.prevStackOffset||!Xf(R,_.prevMargin)){var D=p$(y),B={chartX:_.chartX,chartY:_.chartY,isTooltipActive:_.isTooltipActive},F=Je(Je({},m$(_,b,P)),{},{updateId:_.updateId+1}),U=Je(Je(Je({},D),B),F);return Je(Je(Je({},U),p(Je({props:y},U),_)),{},{prevDataKey:w,prevData:b,prevWidth:S,prevHeight:k,prevLayout:P,prevStackOffset:A,prevMargin:R,prevChildren:N})}if(!B2(N,_.prevChildren)){var G,q,K,Z,Y=Ci(N,qm),Q=Y&&(G=(q=Y.props)===null||q===void 0?void 0:q.startIndex)!==null&&G!==void 0?G:$,X=Y&&(K=(Z=Y.props)===null||Z===void 0?void 0:Z.endIndex)!==null&&K!==void 0?K:O,ne=Q!==$||X!==O,re=!Yr(b),ye=re&&!ne?_.updateId:_.updateId+1;return Je(Je({updateId:ye},p(Je(Je({props:y},_),{},{updateId:ye,dataStartIndex:Q,dataEndIndex:X}),_)),{},{prevChildren:N,dataStartIndex:Q,dataEndIndex:X})}return null}),fr(g,"renderActiveDot",function(y,_,w){var b;return x.isValidElement(y)?b=x.cloneElement(y,_):Ir(y)?b=y(_):b=J.createElement(_j,_),J.createElement(qn,{className:"recharts-active-dot",key:w},b)});var v=x.forwardRef(function(_,w){return J.createElement(g,Of({},_,{ref:w}))});return v.displayName=g.displayName,v},v$=mR({chartName:"LineChart",GraphicalChild:Zm,axisComponents:[{axisType:"xAxis",AxisComp:ri},{axisType:"yAxis",AxisComp:ni}],formatAxisMap:sR}),Fg=mR({chartName:"BarChart",GraphicalChild:Ri,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:ri},{axisType:"yAxis",AxisComp:ni}],formatAxisMap:sR}),y$=mR({chartName:"AreaChart",GraphicalChild:$c,axisComponents:[{axisType:"xAxis",AxisComp:ri},{axisType:"yAxis",AxisComp:ni}],formatAxisMap:sR});function NY({data:e,className:t=""}){if(!e||e.length===0)return s.jsxs(He,{className:t,children:[s.jsx(Er,{children:s.jsxs(qr,{className:"flex items-center gap-2",children:[s.jsx(Bn,{className:"h-5 w-5"}),"Promotion Performance"]})}),s.jsx(et,{children:s.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500",children:"No performance data available"})})]});const r=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"});return s.jsxs(He,{className:t,children:[s.jsx(Er,{children:s.jsxs(qr,{className:"flex items-center gap-2",children:[s.jsx(Bn,{className:"h-5 w-5"}),"Promotion Performance Over Time"]})}),s.jsx(et,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),s.jsx("span",{children:"Impressions"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded"}),s.jsx("span",{children:"Clicks"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),s.jsx("span",{children:"Conversions"})]})]}),s.jsx("div",{className:"h-64 w-full",children:s.jsx(rc,{width:"100%",height:"100%",children:s.jsxs(Fg,{data:e,margin:{top:20,right:30,left:20,bottom:5},children:[s.jsx(ol,{strokeDasharray:"3 3"}),s.jsx(ri,{dataKey:"date",tickFormatter:r,angle:-45,textAnchor:"end",height:60}),s.jsx(ni,{}),s.jsx(ea,{formatter:(n,a)=>[n.toLocaleString(),a],labelFormatter:n=>`Date: ${r(n)}`}),s.jsx(Zu,{}),s.jsx(Ri,{dataKey:"impressions",fill:"#3b82f6",name:"Impressions"}),s.jsx(Ri,{dataKey:"clicks",fill:"#8b5cf6",name:"Clicks"}),s.jsx(Ri,{dataKey:"conversions",fill:"#10b981",name:"Conversions"})]})})}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-4 border-t",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600 mb-1",children:[s.jsx(Kd,{className:"h-4 w-4"}),s.jsx("span",{children:"Total Impressions"})]}),s.jsx("p",{className:"text-lg font-semibold",children:e.reduce((n,a)=>n+a.impressions,0).toLocaleString()})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600 mb-1",children:[s.jsx(_P,{className:"h-4 w-4"}),s.jsx("span",{children:"Total Clicks"})]}),s.jsx("p",{className:"text-lg font-semibold",children:e.reduce((n,a)=>n+a.clicks,0).toLocaleString()})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600 mb-1",children:[s.jsx(Zi,{className:"h-4 w-4"}),s.jsx("span",{children:"Total Conversions"})]}),s.jsx("p",{className:"text-lg font-semibold",children:e.reduce((n,a)=>n+a.conversions,0).toLocaleString()})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600 mb-1",children:s.jsx("span",{children:"Total Spend"})}),s.jsxs("p",{className:"text-lg font-semibold",children:["$",e.reduce((n,a)=>n+a.spend,0).toLocaleString()]})]})]})]})})]})}function x9e(){const{user:e}=xs(),[t,r]=x.useState(!0),[n,a]=x.useState(null),[i,o]=x.useState([]),[l,c]=x.useState([]),[d,u]=x.useState([]),[f,h]=x.useState([]),[p,g]=x.useState("overview"),[v,y]=x.useState(!1),_=()=>E(this,null,function*(){if(e){y(!0);try{console.log(" CreatorAnalyticsDashboard: Loading promotion data...");const[Y,Q,X]=yield Promise.all([Gi.getUserPromotions(e.id),Gi.getPromotionPerformanceComparison(e.id),Gi.getPromotionTrends(e.id,30)]);console.log(" CreatorAnalyticsDashboard: Promotion data loaded:",{promotions:Y.length,comparisons:Q.length,trends:X.length}),O(Y),D(Q),F(X)}catch(Y){console.error("Error loading promotion data:",Y)}finally{y(!1)}}}),[w,b]=x.useState(null),[N,S]=x.useState(null),[k,P]=x.useState([]),[A,R]=x.useState(null),[$,O]=x.useState([]),[z,D]=x.useState([]),[B,F]=x.useState([]),{isLive:U,lastUpdate:G}=K7({userId:(e==null?void 0:e.id)||"",enabled:!!e});x.useEffect(()=>{e&&q()},[e]),x.useEffect(()=>{p==="promotions"&&e&&_()},[p,e]);const q=()=>E(this,null,function*(){if(e)try{r(!0);const Y=e.id;console.log(" CreatorAnalyticsDashboard: Fetching data for creatorId:",Y);const[Q,X,ne,re,ye]=yield Promise.all([tf.getCreatorStats(Y),tf.getFanInsights(Y),tf.getGeographicInsights(Y),tf.getContentPerformance(Y),tf.getCreatorAchievements(Y)]);a(Q),o(X),c(ne),u(re),h(ye),yield K(Y)}catch(Y){console.error("Error fetching creator data:",Y)}finally{r(!1)}}),K=Y=>E(this,null,function*(){try{const Q={start:new Date(Date.now()-2592e6),end:new Date},X=yield iA.analyzeFunnel("creator",Q);b(X);const ne=yield Tf.getUserRevenueMetrics(Y,Q);S(ne);const re=d.map(ie=>({date:ie.date,value:ie.follower_gains,label:"New Followers"}));P(re);const ye={score:(n==null?void 0:n.engagement_rate)||0,sessionDuration:0,interactionCount:(n==null?void 0:n.total_event_views)||0,pageViews:(n==null?void 0:n.total_event_views)||0,likes:(n==null?void 0:n.total_reviews)||0,shares:0,comments:0,bounceRate:0};R(ye);const[ee,de,xe]=yield Promise.all([Gi.getUserPromotions(Y),Gi.getPromotionPerformanceComparison(Y),Gi.getPromotionTrends(Y,30)]);O(ee),D(de),F(xe)}catch(Q){console.error("Error loading enhanced analytics:",Q)}}),Z=()=>E(this,null,function*(){if(e)try{const Y=yield tf.exportCreatorData(e.id),Q=new Blob([JSON.stringify(Y,null,2)],{type:"application/json"}),X=URL.createObjectURL(Q),ne=document.createElement("a");ne.href=X,ne.download=`creator-analytics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(ne),ne.click(),document.body.removeChild(ne),URL.revokeObjectURL(X)}catch(Y){console.error("Error exporting data:",Y)}});return t?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsx(to,{})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((Y,Q)=>s.jsx(to,{},Q))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(to,{}),s.jsx(to,{})]})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(sh,{className:"w-8 h-8 text-purple-600"}),s.jsx("h1",{className:"gradient-text text-3xl font-bold",children:"Creator Analytics"})]}),s.jsx("p",{className:"text-gray-600",children:"Track your fan engagement, content performance, and growth metrics"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:Z,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[s.jsx(cp,{className:"w-4 h-4"}),"Export Data"]}),s.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all",children:"Upgrade to Pro"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(oi,{title:"Total Followers",value:(n==null?void 0:n.total_followers)||0,icon:s.jsx(zr,{className:"w-6 h-6"}),trend:(n==null?void 0:n.fan_growth_rate)>0?"up":(n==null?void 0:n.fan_growth_rate)<0?"down":"neutral",subtitle:"growth this month"}),s.jsx(oi,{title:"Engagement Rate",value:`${(n==null?void 0:n.engagement_rate)||0}%`,icon:s.jsx(Bn,{className:"w-6 h-6"}),trend:"neutral",subtitle:"interactions per follower"}),s.jsx(oi,{title:"Event Views",value:(n==null?void 0:n.total_event_views)||0,icon:s.jsx(Kd,{className:"w-6 h-6"}),trend:"neutral",subtitle:"total views"}),s.jsx(oi,{title:"Fan Reviews",value:(n==null?void 0:n.total_reviews)||0,icon:s.jsx(Qt,{className:"w-6 h-6"}),trend:"neutral",subtitle:"reviews received"})]}),s.jsx("div",{className:"mb-8",children:s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:Fd},{id:"fans",label:"Fan Insights",icon:zr},{id:"content",label:"Content Performance",icon:It},{id:"promotions",label:"Promotions",icon:Bn},{id:"achievements",label:"Achievements",icon:Bd}].map(Y=>s.jsxs("button",{onClick:()=>g(Y.id),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${p===Y.id?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(Y.icon,{className:"w-4 h-4"}),Y.label]},Y.id))})})}),p==="overview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[A&&s.jsx(G7,{metrics:A,title:"Creator Engagement Score",showBreakdown:!0}),k.length>0&&s.jsx(Y7,{data:k,title:"Follower Growth",valueLabel:"New Followers",showTrend:!0})]}),w&&w.stages.length>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Bn,{className:"w-5 h-5 text-synth-pink"}),"Fan Conversion Funnel"]}),s.jsx(W7,{stages:w.stages,title:"Fan Journey Analysis",showOptimizationTips:!0})]}),N&&N.total_revenue>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Qt,{className:"w-5 h-5 text-synth-pink"}),"Revenue Attribution"]}),s.jsx(H7,{sources:N.top_revenue_sources.map(Y=>({source:Y.source,revenue:Y.revenue,percentage:Y.percentage,confidence_score:.8,attribution_window:24})),totalRevenue:N.total_revenue,title:"Revenue Sources",showConfidenceScores:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(gr,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Venues"})]}),i.length>0?s.jsx("div",{className:"space-y-3",children:i.slice(0,5).map((Y,Q)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center text-sm font-semibold text-purple-600",children:Q+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:Y.venue_name}),s.jsxs("p",{className:"text-sm text-gray-500",children:[Y.event_count," events"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:Y.total_views}),s.jsx("p",{className:"text-sm text-gray-500",children:"views"})]})]},Y.venue_name))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(gr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No venue data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Ki,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Geographic Reach"})]}),l.length>0?s.jsx("div",{className:"space-y-3",children:l.slice(0,5).map((Y,Q)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm font-semibold text-blue-600",children:Q+1}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900",children:[Y.city,", ",Y.state]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[Y.event_count," events"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:Y.fan_count}),s.jsx("p",{className:"text-sm text-gray-500",children:"fans"})]})]},`${Y.city}-${Y.state}`))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ki,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]})]})]}),p==="fans"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Venue Performance"}),i.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Venue"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Events"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Views"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Engagement"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Fan Density"})]})}),s.jsx("tbody",{children:i.map(Y=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:Y.venue_name}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.event_count}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.total_views}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.engagement_score}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.fan_density})]},Y.venue_name))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(zr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No fan insights available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Geographic Distribution"}),l.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Location"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Fans"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Events"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Engagement"})]})}),s.jsx("tbody",{children:l.map(Y=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsxs("td",{className:"py-3 px-4 font-medium text-gray-900",children:[Y.city,", ",Y.state]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.fan_count}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.event_count}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[Y.engagement_rate,"%"]})]},`${Y.city}-${Y.state}`))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ki,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]})]}),p==="content"&&s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Content Performance"}),d.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Date"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Event Views"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Profile Visits"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Follower Gains"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Engagement"})]})}),s.jsx("tbody",{children:d.map(Y=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:new Date(Y.date).toLocaleDateString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.event_views}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.profile_visits}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:Y.follower_gains}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[Y.engagement_rate,"%"]})]},Y.date))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(It,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No content performance data available"})]})]}),p==="achievements"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[s.jsx(Bd,{className:"w-8 h-8 text-yellow-500"}),s.jsx("h2",{className:"gradient-text text-2xl font-bold",children:"Creator Achievements"})]}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Track your milestones as a creator and artist"})]}),["follower","engagement","venue","revenue"].map(Y=>{const Q=f.filter(ne=>ne.category===Y),X={follower:"Follower Milestones",engagement:"Engagement Goals",venue:"Venue Performance",revenue:"Revenue Targets"};return s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Ac,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:X[Y]})]}),Q.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Q.map(ne=>s.jsx(aA,{name:ne.name,description:ne.description,icon:ne.icon,progress:ne.progress,goal:ne.goal,unlocked:ne.unlocked,unlockedAt:ne.unlockedAt,compact:!0},ne.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ac,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No achievements in this category yet"})]})]},Y)})]}),p==="promotions"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Promotion Analytics"}),U&&s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live"]})]}),s.jsx("p",{className:"text-gray-600",children:"Track your event promotion performance and ROI"}),G&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Last updated: ",G.toLocaleTimeString()]})]})}),$.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Bn,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Promotions Yet"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Start promoting your events to see detailed analytics here"}),s.jsx("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Promote Your First Event"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:$.slice(0,3).map(Y=>s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold text-lg truncate",children:Y.event.title}),s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${Y.promotion_tier==="featured"?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800":Y.promotion_tier==="premium"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:Y.promotion_tier})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Impressions"}),s.jsx("p",{className:"text-xl font-bold",children:Y.impressions.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Clicks"}),s.jsx("p",{className:"text-xl font-bold",children:Y.clicks.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Conversions"}),s.jsx("p",{className:"text-xl font-bold text-green-600",children:Y.conversions.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"CTR"}),s.jsxs("p",{className:"text-xl font-bold",children:[(Y.clicks/Y.impressions*100).toFixed(1),"%"]})]})]})]},Y.id))}),s.jsx(NY,{data:B.map(Y=>({date:Y.date,impressions:Y.impressions||0,clicks:Y.clicks||0,conversions:Y.conversions||0,spend:Y.spend||0})),className:"bg-white rounded-xl shadow-sm border"}),z.length>0&&s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Promotion Comparison"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b",children:[s.jsx("th",{className:"text-left py-2",children:"Event"}),s.jsx("th",{className:"text-left py-2",children:"Tier"}),s.jsx("th",{className:"text-left py-2",children:"Impressions"}),s.jsx("th",{className:"text-left py-2",children:"Clicks"}),s.jsx("th",{className:"text-left py-2",children:"Conversions"}),s.jsx("th",{className:"text-left py-2",children:"CTR"}),s.jsx("th",{className:"text-left py-2",children:"ROI"})]})}),s.jsx("tbody",{children:z.slice(0,5).map(Y=>s.jsxs("tr",{className:"border-b",children:[s.jsx("td",{className:"py-2 font-medium truncate max-w-32",children:Y.event_title}),s.jsx("td",{className:"py-2",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs ${Y.tier==="featured"?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800":Y.tier==="premium"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:Y.tier})}),s.jsx("td",{className:"py-2",children:Y.impressions.toLocaleString()}),s.jsx("td",{className:"py-2",children:Y.clicks.toLocaleString()}),s.jsx("td",{className:"py-2",children:Y.conversions.toLocaleString()}),s.jsxs("td",{className:"py-2",children:[Y.ctr.toFixed(1),"%"]}),s.jsx("td",{className:"py-2",children:s.jsxs("span",{className:`font-semibold ${Y.roi>=0?"text-green-600":"text-red-600"}`,children:[Y.roi>=0?"+":"",Y.roi.toFixed(1),"%"]})})]},Y.promotion_id))})]})})]})]})]})]})})}class fu{static getBusinessStats(t){return E(this,null,function*(){try{console.log(" BusinessAnalyticsService: Getting business stats for user:",t);const{data:r,error:n}=yield T.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published");if(n)throw console.error("Error fetching business events:",n),n;if(console.log(" BusinessAnalyticsService: Found events:",(r==null?void 0:r.length)||0),!r||r.length===0)return console.log(" BusinessAnalyticsService: No events found, returning default stats"),{total_events:0,total_attendees:0,total_revenue:0,conversion_rate:0,customer_satisfaction:0,repeat_customer_rate:0,avg_event_attendance:0,revenue_growth_rate:0};const a=r.map(N=>N.id),i=yield ps.getAllUserInteractions(a,void 0,["event"]),o=yield ps.getAllUserReviews(a),l=yield ps.getAllInterestedUsers(a),c=r.length,d=(i==null?void 0:i.filter(N=>N.event_type==="view").length)||0,u=(i==null?void 0:i.filter(N=>N.event_type==="click_ticket").length)||0,f=(o==null?void 0:o.length)||0,h=(l==null?void 0:l.length)||0,p=d>0?u/d*100:0,g=(o==null?void 0:o.length)>0?o.reduce((N,S)=>N+(S.rating||0),0)/o.length:0,v=new Set((l==null?void 0:l.map(N=>N.user_id))||[]),y=Array.from(v).filter(N=>(l==null?void 0:l.filter(S=>S.user_id===N).length)>1).length,_=v.size>0?y/v.size*100:0,w=c>0?h/c:0;return{total_events:c,total_attendees:h,total_revenue:0,conversion_rate:Math.round(p*100)/100,customer_satisfaction:Math.round(g*100)/100,repeat_customer_rate:Math.round(_*100)/100,avg_event_attendance:Math.round(w*100)/100,revenue_growth_rate:0}}catch(r){return console.error("Error getting business stats:",r),{total_events:0,total_attendees:0,total_revenue:0,conversion_rate:0,customer_satisfaction:0,repeat_customer_rate:0,avg_event_attendance:0,revenue_growth_rate:0}}})}static getEventPerformance(t){return E(this,null,function*(){try{console.log(" BusinessAnalyticsService: Getting event performance for user:",t);const{data:r,error:n}=yield T.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published");if(n)throw console.error("Error fetching business events for performance:",n),n;if(console.log(" BusinessAnalyticsService: Found events for performance:",(r==null?void 0:r.length)||0),!r||r.length===0)return console.log(" BusinessAnalyticsService: No events found for performance, returning empty array"),[];const a=r.map(d=>d.id),i=yield ps.getAllUserInteractions(a,void 0,["event"]),o=yield ps.getAllUserReviews(a),l=yield ps.getAllInterestedUsers(a);return r.map(d=>{const u=(i==null?void 0:i.filter(w=>w.entity_id===d.id))||[],f=(o==null?void 0:o.filter(w=>w.event_id===d.id))||[],h=(l==null?void 0:l.filter(w=>w.event_id===d.id))||[],p=u.filter(w=>w.event_type==="view").length,g=u.filter(w=>w.event_type==="click_ticket").length,v=f.length>0?f.reduce((w,b)=>w+(b.rating||0),0)/f.length:0,y=0,_=p>0?h.length/p*100:0;return{event_id:d.id,title:d.title,artist_name:d.artist_name,event_date:d.event_date,venue_name:d.venue_name,total_views:p,total_interested:h.length,ticket_clicks:g,reviews_count:f.length,avg_rating:Math.round(v*100)/100,revenue_generated:y,attendance_rate:Math.round(_*100)/100}}).sort((d,u)=>u.revenue_generated-d.revenue_generated)}catch(r){return console.error("Error getting event performance:",r),[]}})}static getCustomerInsights(t){return E(this,null,function*(){try{console.log(" BusinessAnalyticsService: Getting customer insights for user:",t);const{data:r,error:n}=yield T.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published");if(n)throw console.error("Error fetching business events for customer insights:",n),n;if(console.log(" BusinessAnalyticsService: Found events for customer insights:",(r==null?void 0:r.length)||0),!r||r.length===0)return console.log(" BusinessAnalyticsService: No events found for customer insights, returning empty array"),[];const a=r.map(f=>f.id),{data:i}=yield T.from("user_event_relationships").select("*").in("relationship_type",["interested","going","maybe"]).in("event_id",a),{data:o}=yield T.from("reviews").select("*").in("event_id",a),l=new Map,c=new Map;return i==null||i.forEach(f=>{const h=l.get(f.user_id)||0;l.set(f.user_id,h+1)}),o==null||o.forEach(f=>{c.has(f.user_id)||c.set(f.user_id,[]),c.get(f.user_id).push(f.rating||0)}),Object.entries({"New Customers":{min:1,max:1},"Regular Customers":{min:2,max:4},"VIP Customers":{min:5,max:1/0}}).map(([f,h])=>{const p=Array.from(l.entries()).filter(([k,P])=>P>=h.min&&P<=h.max),g=l.size,v=p.length,y=g>0?v/g*100:0,_=v>0?p.reduce((k,[P,A])=>k+A,0)/v:0,w=_*50,b=p.map(([k,P])=>c.get(k)||[]),N=b.length>0?b.reduce((k,P)=>k+P.reduce((A,R)=>A+R,0)/P.length,0)/b.length:0,S=_*20+N*10;return{customer_segment:f,count:v,percentage:Math.round(y*100)/100,avg_events_attended:Math.round(_*100)/100,avg_spending:Math.round(w*100)/100,loyalty_score:Math.round(S*100)/100}})}catch(r){return console.error("Error getting customer insights:",r),[]}})}static getRevenueInsights(t,r=30){return E(this,null,function*(){try{const n=new Date;n.setDate(n.getDate()-r);const{data:a,error:i}=yield T.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published").gte("event_date",n.toISOString());if(i)throw console.error("Error fetching business events for revenue insights:",i),i;if(console.log(" BusinessAnalyticsService: Found events for revenue insights:",(a==null?void 0:a.length)||0),!a||a.length===0)return[];const o=a.map(u=>u.id),{data:l}=yield T.from("interactions").select("*").in("entity_id",o).eq("entity_type","event").gte("created_at",n.toISOString()),c=new Map;return l==null||l.forEach(u=>{const f=new Date(u.created_at).toISOString().split("T")[0];c.has(f)||c.set(f,{revenue:0,ticketClicks:0,views:0});const h=c.get(f);u.event_type==="view"?h.views++:u.event_type==="click_ticket"&&(h.ticketClicks++,h.revenue+=0)}),Array.from(c.entries()).map(([u,f])=>{const h=f.views>0?f.ticketClicks/f.views*100:0,p=f.ticketClicks>0?f.revenue/f.ticketClicks:0;return{date:u,revenue:f.revenue,ticket_clicks:f.ticketClicks,conversion_rate:Math.round(h*100)/100,avg_ticket_price:Math.round(p*100)/100}}).sort((u,f)=>new Date(u.date).getTime()-new Date(f.date).getTime())}catch(n){return console.error("Error getting revenue insights:",n),[]}})}static getArtistPerformance(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published");if(n)throw console.error("Error fetching business events for artist performance:",n),n;if(console.log(" BusinessAnalyticsService: Found events for artist performance:",(r==null?void 0:r.length)||0),!r||r.length===0)return[];const a=r.map(p=>p.id),[i,o,l]=yield Promise.all([T.from("interactions").select("*").in("entity_id",a).eq("entity_type","event"),T.from("reviews").select("*").in("event_id",a),T.from("user_event_relationships").select("*").in("relationship_type",["interested","going","maybe"]).in("event_id",a)]),c=i.data||[],d=o.data||[],u=l.data||[],f=new Map;return r.forEach(p=>{const g=p.artist_name;f.has(g)||f.set(g,{events:[],interactions:[],reviews:[],interested:[]}),f.get(g).events.push(p)}),c.forEach(p=>{var v;const g=r.find(y=>y.id===p.entity_id);g&&((v=f.get(g.artist_name))==null||v.interactions.push(p))}),d.forEach(p=>{var v;const g=r.find(y=>y.id===p.event_id);g&&((v=f.get(g.artist_name))==null||v.reviews.push(p))}),u.forEach(p=>{var v;const g=r.find(y=>y.id===p.event_id);g&&((v=f.get(g.artist_name))==null||v.interested.push(p))}),Array.from(f.entries()).map(([p,g])=>{const v=g.events.length,y=g.interactions.filter(P=>P.event_type==="view").length,_=g.interactions.filter(P=>P.event_type==="click_ticket").length*50,w=g.reviews.length>0?g.reviews.reduce((P,A)=>P+(A.rating||0),0)/g.reviews.length:0,b=w*20,N=new Set(g.interested.map(P=>P.user_id)),S=Array.from(N).filter(P=>g.interested.filter(A=>A.user_id===P).length>1).length,k=N.size>0?S/N.size*100:0;return{artist_name:p,events_count:v,total_views:y,avg_rating:Math.round(w*100)/100,total_revenue:_,customer_satisfaction:Math.round(b*100)/100,repeat_rate:Math.round(k*100)/100}}).sort((p,g)=>g.total_revenue-p.total_revenue)}catch(r){return console.error("Error getting artist performance:",r),[]}})}static getBusinessAchievements(t){return E(this,null,function*(){try{const r=yield this.getBusinessStats(t),n=yield this.getEventPerformance(t),a=yield this.getCustomerInsights(t);return[{id:"first_event",name:"First Event",description:"Host your first event",icon:"",progress:Math.min(r.total_events,1),goal:1,unlocked:r.total_events>=1,category:"events"},{id:"busy_venue",name:"Busy Venue",description:"Host 10 events",icon:"",progress:Math.min(r.total_events,10),goal:10,unlocked:r.total_events>=10,category:"events"},{id:"event_venue",name:"Event Venue",description:"Host 50 events",icon:"",progress:Math.min(r.total_events,50),goal:50,unlocked:r.total_events>=50,category:"events"},{id:"first_revenue",name:"First Revenue",description:"Generate $1,000 in ticket revenue",icon:"",progress:Math.min(r.total_revenue,1e3),goal:1e3,unlocked:r.total_revenue>=1e3,category:"revenue"},{id:"revenue_generator",name:"Revenue Generator",description:"Generate $10,000 in ticket revenue",icon:"",progress:Math.min(r.total_revenue,1e4),goal:1e4,unlocked:r.total_revenue>=1e4,category:"revenue"},{id:"high_conversion",name:"High Conversion",description:"Achieve 10% conversion rate",icon:"",progress:Math.min(r.conversion_rate,10),goal:10,unlocked:r.conversion_rate>=10,category:"growth"},{id:"customer_satisfaction",name:"Customer Satisfaction",description:"Achieve 4.5+ average rating",icon:"",progress:Math.min(r.customer_satisfaction,4.5),goal:4.5,unlocked:r.customer_satisfaction>=4.5,category:"customers"},{id:"loyal_customers",name:"Loyal Customers",description:"Achieve 30% repeat customer rate",icon:"",progress:Math.min(r.repeat_customer_rate,30),goal:30,unlocked:r.repeat_customer_rate>=30,category:"customers"},{id:"popular_venue",name:"Popular Venue",description:"Attract 1,000 total attendees",icon:"",progress:Math.min(r.total_attendees,1e3),goal:1e3,unlocked:r.total_attendees>=1e3,category:"growth"},{id:"successful_business",name:"Successful Business",description:"Generate $50,000 in total revenue",icon:"",progress:Math.min(r.total_revenue,5e4),goal:5e4,unlocked:r.total_revenue>=5e4,category:"revenue"}]}catch(r){return console.error("Error getting business achievements:",r),[]}})}static exportBusinessData(t){return E(this,null,function*(){const[r,n,a,i,o,l]=yield Promise.all([this.getBusinessStats(t),this.getEventPerformance(t),this.getCustomerInsights(t),this.getRevenueInsights(t),this.getArtistPerformance(t),this.getBusinessAchievements(t)]);return{stats:r,eventPerformance:n,customerInsights:a,revenueInsights:i,artistPerformance:o,achievements:l}})}}class $S{static getVIPCustomers(t,r=50){return E(this,null,function*(){try{console.log(" VIPAnalyticsService: Getting VIP customers for user:",t);const{data:n,error:a}=yield T.from("events").select("id").eq("created_by_user_id",t);if(a)throw console.error("Error fetching user events for VIP analysis:",a),a;if(!n||n.length===0)return console.log(" VIPAnalyticsService: No events found, returning empty VIP list"),[];const i=n.map(_=>_.id),{data:o,error:l}=yield T.from("interactions").select("user_id, event_type, entity_type, occurred_at").in("entity_id",i).eq("entity_type","event");if(l)throw console.error("Error fetching interactions for VIP analysis:",l),l;const{data:c,error:d}=yield T.from("user_event_relationships").select("user_id, event_id").in("relationship_type",["interested","going","maybe"]).in("event_id",i);if(d)throw console.error("Error fetching interested users for VIP analysis:",d),d;const{data:u,error:f}=yield T.from("reviews").select("user_id, event_id, review_text, rating, created_at").in("event_id",i).eq("is_draft",!1);if(f)throw console.error("Error fetching reviews for VIP analysis:",f),f;const h=[...new Set([...(o==null?void 0:o.map(_=>_.user_id))||[],...(c==null?void 0:c.map(_=>_.user_id))||[],...(u==null?void 0:u.map(_=>_.user_id))||[]])];if(h.length===0)return console.log(" VIPAnalyticsService: No users found, returning empty VIP list"),[];const g=(yield ps.getAllProfiles()).filter(_=>h.includes(_.user_id)),v=[];for(const _ of g||[]){const w=(o==null?void 0:o.filter(O=>O.user_id===_.user_id))||[],b=(c==null?void 0:c.filter(O=>O.user_id===_.user_id))||[],N=(u==null?void 0:u.filter(O=>O.user_id===_.user_id))||[],S=0,k=b.length,P=N.length,A=w.length;let R=0;R+=Math.min(S*5,30),R+=Math.min(k*2,20),R+=Math.min(P*4,20),R+=Math.min(A*.5,15);const $=_.subscription_tier==="premium"?15:_.subscription_tier==="professional"?12:_.subscription_tier==="enterprise"?15:0;if(R+=$,R>=20){const O=Math.floor((Date.now()-new Date(_.created_at).getTime())/864e5),z=w.length>0?w.sort((B,F)=>new Date(F.occurred_at).getTime()-new Date(B.occurred_at).getTime())[0].occurred_at:_.created_at;let D;R>=80?D="platinum":R>=60?D="gold":R>=40?D="silver":D="bronze",v.push({user_id:_.user_id,email:"",display_name:_.name||"Anonymous User",vip_score:Math.round(R),vip_tier:D,total_events_attended:S,total_events_interested:k,total_reviews_written:P,total_spending:0,subscription_tier:_.subscription_tier||"free",account_age_days:O,last_activity:z,engagement_score:Math.round(A/Math.max(O,1)*100)/100})}}const y=v.sort((_,w)=>w.vip_score-_.vip_score);return console.log(" VIPAnalyticsService: Found VIP customers:",y.length),y.slice(0,r)}catch(n){throw console.error("Error getting VIP customers:",n),n}})}static getVIPMetrics(t){return E(this,null,function*(){try{console.log(" VIPAnalyticsService: Getting VIP metrics for user:",t);const r=yield this.getVIPCustomers(t,1e3);if(r.length===0)return{total_vip_customers:0,vip_by_tier:{bronze:0,silver:0,gold:0,platinum:0},vip_growth_rate:0,avg_vip_score:0,vip_retention_rate:0,vip_revenue_contribution:0};const n=r.reduce((d,u)=>(d[u.vip_tier]++,d),{bronze:0,silver:0,gold:0,platinum:0}),a=r.reduce((d,u)=>d+u.vip_score,0)/r.length,i=new Date(Date.now()-30*24*60*60*1e3),l=r.filter(d=>new Date(d.last_activity)>i).length/r.length*100,c=r.reduce((d,u)=>d+u.total_spending,0);return console.log(" VIPAnalyticsService: VIP metrics calculated:",{total:r.length,tiers:n,avgScore:Math.round(a),retention:Math.round(l)}),{total_vip_customers:r.length,vip_by_tier:n,vip_growth_rate:0,avg_vip_score:Math.round(a*100)/100,vip_retention_rate:Math.round(l*100)/100,vip_revenue_contribution:c}}catch(r){throw console.error("Error getting VIP metrics:",r),r}})}static getVIPTrends(t,r=30){return E(this,null,function*(){try{console.log(" VIPAnalyticsService: Getting VIP trends for user:",t);const n=[],a=new Date;for(let i=r-1;i>=0;i--){const o=new Date(a);o.setDate(o.getDate()-i),n.push({date:o.toISOString().split("T")[0],total_vips:Math.floor(Math.random()*10)+5,new_vips:Math.floor(Math.random()*3),vip_revenue:Math.floor(Math.random()*1e3)+500})}return console.log(" VIPAnalyticsService: VIP trends generated:",n.length,"days"),n}catch(n){throw console.error("Error getting VIP trends:",n),n}})}}function _9e(e){return E(this,null,function*(){try{console.log(" Syncing all promotion metrics for user:",e);const{data:t,error:r}=yield T.from("event_promotions").select("id, event_id").eq("promoted_by_user_id",e);if(r){console.error("Error fetching user promotions:",r);return}if(!t||t.length===0){console.log("No promotions found for user");return}console.log(`Found ${t.length} promotions to sync`);for(const n of t)try{yield _l.syncPromotionMetrics(n.id),console.log(` Synced promotion ${n.id}`)}catch(a){console.error(` Error syncing promotion ${n.id}:`,a)}console.log(" All promotion metrics synced successfully!")}catch(t){console.error("Error syncing user promotions:",t)}})}function w9e(){const{user:e}=xs(),[t,r]=x.useState(!0),[n,a]=x.useState(null),[i,o]=x.useState([]),[l,c]=x.useState([]),[d,u]=x.useState([]),[f,h]=x.useState([]),[p,g]=x.useState([]),[v,y]=x.useState("overview"),[_,w]=x.useState(!1),b=()=>E(this,null,function*(){if(e){w(!0);try{console.log(" BusinessAnalyticsDashboard: Loading promotion data...");const[V,ue,_e]=yield Promise.allSettled([Gi.getUserPromotions(e.id),Gi.getPromotionPerformanceComparison(e.id),Gi.getPromotionTrends(e.id,30)]).then(ae=>ae.map(we=>we.status==="fulfilled"?we.value:[]));console.log(" BusinessAnalyticsDashboard: Promotion data loaded:",{promotions:V.length,comparisons:ue.length,trends:_e.length}),B(V),U(ue),q(_e)}catch(V){console.error("Error loading promotion data:",V)}finally{w(!1)}}}),N=()=>E(this,null,function*(){if(e){ye(!0);try{console.log(" BusinessAnalyticsDashboard: Loading VIP data...");const[V,ue,_e]=yield Promise.allSettled([$S.getVIPCustomers(e.id,20),$S.getVIPMetrics(e.id),$S.getVIPTrends(e.id,30)]).then(ae=>ae.map(we=>we.status==="fulfilled"?we.value:[]));console.log(" BusinessAnalyticsDashboard: VIP data loaded:",{customers:Array.isArray(V)?V.length:0,metrics:ue,trends:Array.isArray(_e)?_e.length:0}),Z(Array.isArray(V)?V:[]),Q(ue&&typeof ue=="object"&&!Array.isArray(ue)?ue:null),ne(Array.isArray(_e)?_e:[])}catch(V){console.error("Error loading VIP data:",V)}finally{ye(!1)}}}),[S,k]=x.useState(null),[P,A]=x.useState(null),[R,$]=x.useState([]),[O,z]=x.useState(null),[D,B]=x.useState([]),[F,U]=x.useState([]),[G,q]=x.useState([]),[K,Z]=x.useState([]),[Y,Q]=x.useState(null),[X,ne]=x.useState([]),[re,ye]=x.useState(!1),{isLive:ee,lastUpdate:de}=K7({userId:(e==null?void 0:e.id)||"",enabled:!!e});x.useEffect(()=>{e&&xe()},[e]),x.useEffect(()=>{v==="promotions"&&e&&b()},[v,e]),x.useEffect(()=>{v==="customers"&&e&&N()},[v,e]);const xe=()=>E(this,null,function*(){if(e)try{r(!0),console.log(" BusinessAnalyticsDashboard: Fetching business data for user:",e.id),console.log(" BusinessAnalyticsDashboard: Loading analytics for user:",e.id);const[V,ue,_e,ae,we,oe]=yield Promise.all([fu.getBusinessStats(e.id),fu.getEventPerformance(e.id),fu.getCustomerInsights(e.id),fu.getRevenueInsights(e.id),fu.getArtistPerformance(e.id),fu.getBusinessAchievements(e.id)]);a(V),o(ue),c(_e),u(ae),h(we),g(oe),yield ie()}catch(V){console.error("Error fetching business data:",V)}finally{r(!1)}}),ie=()=>E(this,null,function*(){try{const V={start:new Date(Date.now()-2592e6),end:new Date},ue=yield iA.analyzeFunnel("business",V);k(ue);const _e=yield Tf.getUserRevenueMetrics((e==null?void 0:e.id)||"",V);A(_e);const ae=d.map(oe=>({date:oe.date,value:oe.revenue,label:"Daily Revenue"}));$(ae);const we={score:(n==null?void 0:n.conversion_rate)||0,sessionDuration:0,interactionCount:(n==null?void 0:n.total_events)||0,pageViews:(n==null?void 0:n.total_events)||0,likes:(n==null?void 0:n.customer_satisfaction)||0,shares:0,comments:0,bounceRate:0};if(z(we),e){const[oe,ce,Ae]=yield Promise.all([Gi.getUserPromotions(e.id),Gi.getPromotionPerformanceComparison(e.id),Gi.getPromotionTrends(e.id,30)]);B(oe),U(ce),q(Ae)}}catch(V){console.error("Error loading enhanced analytics:",V)}}),se=()=>E(this,null,function*(){if(e)try{const ue=yield fu.exportBusinessData("Sample Venue"),_e=new Blob([JSON.stringify(ue,null,2)],{type:"application/json"}),ae=URL.createObjectURL(_e),we=document.createElement("a");we.href=ae,we.download=`business-analytics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(we),we.click(),document.body.removeChild(we),URL.revokeObjectURL(ae)}catch(V){console.error("Error exporting data:",V)}});return t?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsx(to,{})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((V,ue)=>s.jsx(to,{},ue))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(to,{}),s.jsx(to,{})]})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(Yi,{className:"w-8 h-8 text-blue-600"}),s.jsx("h1",{className:"gradient-text text-3xl font-bold",children:"Business Analytics"})]}),s.jsx("p",{className:"text-gray-600",children:"Track your venue performance, revenue, and customer insights"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:se,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[s.jsx(cp,{className:"w-4 h-4"}),"Export Data"]}),s.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all",children:"Upgrade to Pro"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(oi,{title:"Total Events",value:(n==null?void 0:n.total_events)||0,icon:s.jsx(It,{className:"w-6 h-6"}),trend:"neutral"}),s.jsx(oi,{title:"Total Revenue",value:`$${((n==null?void 0:n.total_revenue)||0).toLocaleString()}`,icon:s.jsx(Ro,{className:"w-6 h-6"}),trend:(n==null?void 0:n.revenue_growth_rate)>0?"up":(n==null?void 0:n.revenue_growth_rate)<0?"down":"neutral"}),s.jsx(oi,{title:"Conversion Rate",value:`${(n==null?void 0:n.conversion_rate)||0}%`,icon:s.jsx(Zi,{className:"w-6 h-6"}),trend:"neutral"}),s.jsx(oi,{title:"Customer Satisfaction",value:`${(n==null?void 0:n.customer_satisfaction)||0}/5`,icon:s.jsx(Qt,{className:"w-6 h-6"}),trend:"neutral"})]}),s.jsx("div",{className:"mb-8",children:s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:Fd},{id:"revenue",label:"Revenue",icon:Ro},{id:"customers",label:"Customers",icon:zr},{id:"events",label:"Events",icon:It},{id:"promotions",label:"Promotions",icon:Bn},{id:"achievements",label:"Achievements",icon:Bd}].map(V=>s.jsxs("button",{onClick:()=>y(V.id),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${v===V.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(V.icon,{className:"w-4 h-4"}),V.label]},V.id))})})}),v==="overview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[O&&s.jsx(G7,{metrics:O,title:"Business Performance Score",showBreakdown:!0}),R.length>0&&s.jsx(Y7,{data:R,title:"Revenue Trends",valueLabel:"Daily Revenue",showTrend:!0})]}),S&&S.stages.length>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Zi,{className:"w-5 h-5 text-synth-pink"}),"Customer Conversion Funnel"]}),s.jsx(W7,{stages:S.stages,title:"Customer Journey Analysis",showOptimizationTips:!0})]}),P&&P.total_revenue>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Ro,{className:"w-5 h-5 text-synth-pink"}),"Revenue Attribution"]}),s.jsx(H7,{sources:P.top_revenue_sources.map(V=>({source:V.source,revenue:V.revenue,percentage:V.percentage,confidence_score:.8,attribution_window:24})),totalRevenue:P.total_revenue,title:"Revenue Sources",showConfidenceScores:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Bn,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Performing Events"})]}),i.length>0?s.jsx("div",{className:"space-y-3",children:i.slice(0,5).map((V,ue)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm font-semibold text-blue-600",children:ue+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:V.title}),s.jsx("p",{className:"text-sm text-gray-500",children:V.artist_name})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-semibold text-gray-900",children:["$",V.revenue_generated]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[V.total_views," views"]})]})]},V.event_id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(It,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 mb-2",children:"No events created yet"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Create your first event to see performance analytics"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Ib,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Customer Segments"})]}),l.length>0?s.jsx("div",{className:"space-y-3",children:l.map((V,ue)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center text-sm font-semibold text-green-600",children:ue+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:V.customer_segment}),s.jsxs("p",{className:"text-sm text-gray-500",children:[V.avg_events_attended," avg events"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:V.count}),s.jsxs("p",{className:"text-sm text-gray-500",children:[V.percentage,"%"]})]})]},V.customer_segment))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(zr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 mb-2",children:"No customer data yet"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Customer insights will appear as people interact with your events"})]})]})]})]}),v==="revenue"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ro,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Total Revenue"})]}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:["$",((n==null?void 0:n.total_revenue)||0).toLocaleString()]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Zi,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Conversion Rate"})]}),s.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:[(n==null?void 0:n.conversion_rate)||0,"%"]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Bn,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Avg Ticket Price"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:"$50"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Revenue Trends"}),d.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Date"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Revenue"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Ticket Clicks"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Conversion Rate"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Avg Price"})]})}),s.jsx("tbody",{children:d.slice(-10).map(V=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:new Date(V.date).toLocaleDateString()}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",V.revenue]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:V.ticket_clicks}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[V.conversion_rate,"%"]}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",V.avg_ticket_price]})]},V.date))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ro,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No revenue data available"})]})]})]}),v==="customers"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(zr,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Attendees"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:((n==null?void 0:n.total_attendees)||0).toLocaleString()})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(AF,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Repeat Rate"})]}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[(n==null?void 0:n.repeat_customer_rate)||0,"%"]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Qt,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"Satisfaction"})]}),s.jsxs("p",{className:"text-2xl font-bold text-yellow-900",children:[(n==null?void 0:n.customer_satisfaction)||0,"/5"]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Customer Segmentation"}),l.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Segment"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Count"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Percentage"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Avg Events"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Avg Spending"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Loyalty Score"})]})}),s.jsx("tbody",{children:l.map(V=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:V.customer_segment}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:V.count}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[V.percentage,"%"]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:V.avg_events_attended}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",V.avg_spending]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:V.loyalty_score})]},V.customer_segment))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(zr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No customer data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"VIP Customers"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Your most engaged and valuable customers"})]}),s.jsxs("button",{onClick:N,disabled:re,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors flex items-center gap-2",children:[s.jsx(mi,{className:`w-4 h-4 ${re?"animate-spin":""}`}),"Refresh"]})]}),re?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(lr,{className:"w-8 h-8 animate-spin text-purple-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading VIP customers..."})]}):K.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(sh,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No VIP Customers Yet"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"VIP customers will appear as people engage more with your events"}),s.jsx("p",{className:"text-sm text-gray-400",children:"VIP status is based on event attendance, reviews, and engagement"})]}):s.jsxs("div",{className:"space-y-6",children:[Y&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(sh,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-700",children:"Total VIPs"})]}),s.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:Y.total_vip_customers})]}),s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Bn,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Avg Score"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Y.avg_vip_score})]}),s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(zr,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-700",children:"Retention"})]}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[Y.vip_retention_rate,"%"]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Ro,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Revenue"})]}),s.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:["$",Y.vip_revenue_contribution]})]})]}),Y&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"VIP Tier Distribution"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(Y.vip_by_tier).map(([V,ue])=>s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`w-12 h-12 rounded-full mx-auto mb-2 flex items-center justify-center text-white font-bold ${V==="platinum"?"bg-gradient-to-r from-gray-400 to-gray-600":V==="gold"?"bg-gradient-to-r from-yellow-400 to-yellow-600":V==="silver"?"bg-gradient-to-r from-gray-300 to-gray-500":"bg-gradient-to-r from-orange-400 to-orange-600"}`,children:V.charAt(0).toUpperCase()}),s.jsx("p",{className:"text-sm font-medium text-gray-900 capitalize",children:V}),s.jsx("p",{className:"text-lg font-bold text-gray-700",children:ue})]},V))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Top VIP Customers"}),s.jsx("div",{className:"space-y-3",children:K.slice(0,10).map((V,ue)=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold ${V.vip_tier==="platinum"?"bg-gradient-to-r from-gray-400 to-gray-600":V.vip_tier==="gold"?"bg-gradient-to-r from-yellow-400 to-yellow-600":V.vip_tier==="silver"?"bg-gradient-to-r from-gray-300 to-gray-500":"bg-gradient-to-r from-orange-400 to-orange-600"}`,children:ue+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:V.display_name}),s.jsxs("p",{className:"text-sm text-gray-500 capitalize",children:[V.vip_tier," VIP  ",V.engagement_score," engagement"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-semibold text-gray-900",children:[V.vip_score," pts"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[V.total_events_attended," events"]})]})]},V.user_id))})]})]})]})]}),v==="events"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Event Performance"}),i.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Event"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Artist"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Date"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Views"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Interested"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Revenue"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Rating"})]})}),s.jsx("tbody",{children:i.map(V=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:V.title}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:V.artist_name}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:new Date(V.event_date).toLocaleDateString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:V.total_views}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:V.total_interested}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",V.revenue_generated]}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[V.avg_rating,"/5"]})]},V.event_id))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(It,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No event data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Artist Performance"}),f.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Artist"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Events"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Views"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Revenue"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Rating"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Repeat Rate"})]})}),s.jsx("tbody",{children:f.map(V=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:V.artist_name}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:V.events_count}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:V.total_views}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",V.total_revenue]}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[V.avg_rating,"/5"]}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[V.repeat_rate,"%"]})]},V.artist_name))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Bn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No artist performance data available"})]})]})]}),v==="achievements"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[s.jsx(Bd,{className:"w-8 h-8 text-yellow-500"}),s.jsx("h2",{className:"gradient-text text-2xl font-bold",children:"Business Achievements"})]}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Track your business milestones and growth metrics"})]}),["events","revenue","customers","growth"].map(V=>{const ue=p.filter(ae=>ae.category===V),_e={events:"Event Hosting",revenue:"Revenue Goals",customers:"Customer Satisfaction",growth:"Growth Metrics"};return s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Ac,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:_e[V]})]}),ue.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ue.map(ae=>s.jsx(aA,{name:ae.name,description:ae.description,icon:ae.icon,progress:ae.progress,goal:ae.goal,unlocked:ae.unlocked,unlockedAt:ae.unlockedAt,compact:!0},ae.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ac,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No achievements in this category yet"})]})]},V)})]}),v==="promotions"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Promotion Analytics"}),ee&&s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live"]})]}),s.jsx("p",{className:"text-gray-600",children:"Track your venue's event promotion performance and ROI"}),de&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Last updated: ",de.toLocaleTimeString()]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>E(this,null,function*(){e&&(yield _9e(e.id),yield b())}),className:"px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded-lg transition-colors flex items-center gap-2",children:[s.jsx(Bn,{className:"w-4 h-4"}),"Sync Metrics"]}),s.jsxs("button",{onClick:b,disabled:_,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors flex items-center gap-2",children:[s.jsx(mi,{className:`w-4 h-4 ${_?"animate-spin":""}`}),"Refresh"]})]})]}),_?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(lr,{className:"w-8 h-8 animate-spin text-purple-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading promotion data..."})]}):D.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Bn,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Promotions Yet"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Start promoting your venue's events to see detailed analytics here"}),s.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Promote Your First Event"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:D.slice(0,3).map(V=>s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold text-lg truncate",children:V.event.title}),s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${V.promotion_tier==="featured"?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800":V.promotion_tier==="premium"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:V.promotion_tier})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Impressions"}),s.jsx("p",{className:"text-xl font-bold",children:V.impressions.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Clicks"}),s.jsx("p",{className:"text-xl font-bold",children:V.clicks.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Conversions"}),s.jsx("p",{className:"text-xl font-bold text-green-600",children:V.conversions.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"CTR"}),s.jsxs("p",{className:"text-xl font-bold",children:[(V.clicks/V.impressions*100).toFixed(1),"%"]})]})]})]},V.id))}),s.jsx(NY,{data:G.map(V=>({date:V.date,impressions:V.impressions||0,clicks:V.clicks||0,conversions:V.conversions||0,spend:V.spend||0})),className:"bg-white rounded-xl shadow-sm border"}),F.length>0&&s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Promotion Comparison"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b",children:[s.jsx("th",{className:"text-left py-2",children:"Event"}),s.jsx("th",{className:"text-left py-2",children:"Tier"}),s.jsx("th",{className:"text-left py-2",children:"Impressions"}),s.jsx("th",{className:"text-left py-2",children:"Clicks"}),s.jsx("th",{className:"text-left py-2",children:"Conversions"}),s.jsx("th",{className:"text-left py-2",children:"CTR"}),s.jsx("th",{className:"text-left py-2",children:"ROI"})]})}),s.jsx("tbody",{children:F.slice(0,5).map(V=>s.jsxs("tr",{className:"border-b",children:[s.jsx("td",{className:"py-2 font-medium truncate max-w-32",children:V.event_title}),s.jsx("td",{className:"py-2",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs ${V.tier==="featured"?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800":V.tier==="premium"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:V.tier})}),s.jsx("td",{className:"py-2",children:V.impressions.toLocaleString()}),s.jsx("td",{className:"py-2",children:V.clicks.toLocaleString()}),s.jsx("td",{className:"py-2",children:V.conversions.toLocaleString()}),s.jsxs("td",{className:"py-2",children:[V.ctr.toFixed(1),"%"]}),s.jsx("td",{className:"py-2",children:s.jsxs("span",{className:`font-semibold ${V.roi>=0?"text-green-600":"text-red-600"}`,children:[V.roi>=0?"+":"",V.roi.toFixed(1),"%"]})})]},V.promotion_id))})]})})]})]})]})]})})}class Is{static getPlatformStats(){return E(this,null,function*(){try{const{count:t}=yield T.from("users").select("*",{count:"exact",head:!0}),{count:r}=yield T.from("events").select("*",{count:"exact",head:!0}),a=(yield ps.getAllUserInteractions()).length,i=new Date;i.setHours(0,0,0,0);const o=new Date(i);o.setHours(23,59,59,999);const{count:l}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("last_active_at",i.toISOString()).lte("last_active_at",o.toISOString()),c=new Date;c.setDate(c.getDate()-29),c.setHours(0,0,0,0);const{count:d}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("last_active_at",c.toISOString()),u=new Date;u.setDate(1);const{count:f}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("created_at",u.toISOString()),h=new Date;h.setMonth(h.getMonth()-1),h.setDate(1);const{count:p}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("created_at",h.toISOString()).lt("created_at",u.toISOString()),g=p>0?(f-p)/p*100:0;return{total_users:t||0,total_events:r||0,total_interactions:a||0,active_users_today:l||0,daily_active_users:l||0,monthly_active_users:d||0,new_users_this_month:f||0,platform_growth_rate:g,average_session_duration:0}}catch(t){return console.error("Error getting platform stats:",t),{total_users:0,total_events:0,total_interactions:0,active_users_today:0,daily_active_users:0,monthly_active_users:0,new_users_this_month:0,platform_growth_rate:0,average_session_duration:0}}})}static getUserGrowth(t=30){return E(this,null,function*(){try{const r=new Date;r.setDate(r.getDate()-t);const{data:n}=yield T.from("users").select("created_at").gte("created_at",r.toISOString()),{data:a}=yield T.from("interactions").select("user_id, created_at").gte("created_at",r.toISOString()),i=new Map;n==null||n.forEach(c=>{const d=new Date(c.created_at).toISOString().split("T")[0];i.has(d)||i.set(d,{newUsers:0,activeUsers:new Set,totalUsers:0}),i.get(d).newUsers++}),a==null||a.forEach(c=>{const d=new Date(c.created_at).toISOString().split("T")[0];i.has(d)||i.set(d,{newUsers:0,activeUsers:new Set,totalUsers:0}),i.get(d).activeUsers.add(c.user_id)});let o=0;const l=[];return Array.from(i.entries()).sort((c,d)=>c[0].localeCompare(d[0])).forEach(([c,d])=>{o+=d.newUsers;const u=d.activeUsers.size,f=o>0?u/o*100:0;l.push({date:c,new_users:d.newUsers,active_users:u,total_users:o,retention_rate:Math.round(f*100)/100})}),l}catch(r){return console.error("Error getting user growth:",r),[]}})}static getEngagementMetrics(){return E(this,null,function*(){try{const{data:t}=yield T.from("interactions").select("*"),r=(t==null?void 0:t.filter(u=>u.event_type==="view").length)||0,n=(t==null?void 0:t.filter(u=>u.event_type==="search").length)||0,a=(t==null?void 0:t.filter(u=>u.event_type==="click_ticket").length)||0,{count:i}=yield T.from("reviews").select("*",{count:"exact",head:!0}),l=new Set((t==null?void 0:t.map(u=>u.user_id))||[]).size;return{total_page_views:r,total_sessions:l,average_session_duration:0,bounce_rate:0,events_viewed:r,searches_performed:n,reviews_written:i||0,tickets_clicked:a}}catch(t){return console.error("Error getting engagement metrics:",t),{total_page_views:0,total_sessions:0,average_session_duration:0,bounce_rate:0,events_viewed:0,searches_performed:0,reviews_written:0,tickets_clicked:0}}})}static getActiveUserMetrics(){return E(this,null,function*(){try{const t=yield ps.getAllUserInteractions(),r=new Map;t.forEach(D=>{const B=D.user_id;r.set(B,(r.get(B)||0)+1)});const n=Array.from(r.entries()).filter(([D,B])=>B>=10).map(([D])=>D),a=n.length,i=new Date,o=new Date(i);o.setDate(o.getDate()-7);const l=new Date(i);l.setDate(l.getDate()-30);const c=new Date(i);c.setDate(c.getDate()-90);const d=new Set,u=new Set,f=new Set;t.forEach(D=>{if(n.includes(D.user_id)){const B=new Date(D.occurred_at);B>=c&&f.add(D.user_id),B>=l&&u.add(D.user_id),B>=o&&d.add(D.user_id)}});const h=n.reduce((D,B)=>D+(r.get(B)||0),0),p=a>0?h/a:0,{data:g}=yield T.from("users").select("user_id, location_city, created_at").in("user_id",n),v=new Map;g==null||g.forEach(D=>{const B=D.location_city||"Unknown";v.has(B)||v.set(B,{users:0,newUsers:0});const F=v.get(B);F.users++;const U=new Date(D.created_at),G=new Date;G.setDate(G.getDate()-30),U>=G&&F.newUsers++});const y=Array.from(v.entries()).map(([D,B])=>({country:"USA",city:D,users:B.users,events:0,revenue:0,growth_rate:B.users>0?B.newUsers/B.users*100:0})).sort((D,B)=>B.users-D.users).slice(0,20),{data:_}=yield T.from("users").select("user_id, verified, trust_score, verification_criteria_met").in("user_id",n),w=(_==null?void 0:_.filter(D=>D.verified).length)||0,b=(_==null?void 0:_.reduce((D,B)=>D+(B.trust_score||0),0))||0,N=(_==null?void 0:_.length)>0?b/_.length:0,S=(_==null?void 0:_.reduce((D,B)=>{const F=B.verification_criteria_met||{};return D+Object.values(F).filter(Boolean).length},0))||0,k=(_==null?void 0:_.length)>0?S/_.length:0,P=(_==null?void 0:_.filter(D=>(D.trust_score||0)>=40&&!D.verified).length)||0,A=(g==null?void 0:g.reduce((D,B)=>{const F=(i.getTime()-new Date(B.created_at).getTime())/864e5;return D+F},0))||0,R=(g==null?void 0:g.length)>0?A/g.length:0,$=yield this.getDAUOverTime(30),O=yield this.getWeeklyActiveUsers(12),z=yield this.getMAUOverTime(12);return{total_active_users:a,active_users_7d:d.size,active_users_30d:u.size,active_users_90d:f.size,avg_interactions_per_active_user:Math.round(p*100)/100,avg_account_age_days:Math.round(R*100)/100,geographic_distribution:y,verification_stats:{total_verified:w,avg_trust_score:Math.round(N*100)/100,avg_verification_progress:Math.round(k*100)/100,users_near_verification:P},time_series_data:{daily:$,weekly:O,monthly:z}}}catch(t){return console.error("Error getting active user metrics:",t),{total_active_users:0,active_users_7d:0,active_users_30d:0,active_users_90d:0,avg_interactions_per_active_user:0,avg_account_age_days:0,geographic_distribution:[],verification_stats:{total_verified:0,avg_trust_score:0,avg_verification_progress:0,users_near_verification:0},time_series_data:{daily:[],weekly:[],monthly:[]}}}})}static getWeeklyActiveUsers(t=12){return E(this,null,function*(){try{const r=new Date;r.setDate(r.getDate()-t*7),r.setHours(0,0,0,0);const{data:n}=yield T.from("interactions").select("user_id, occurred_at").gte("occurred_at",r.toISOString()),a=new Map;return n==null||n.forEach(o=>{const l=new Date(o.occurred_at),c=new Date(l);c.setDate(l.getDate()-l.getDay()),c.setHours(0,0,0,0);const d=c.toISOString().split("T")[0];a.has(d)||a.set(d,new Set),a.get(d).add(o.user_id)}),Array.from(a.entries()).map(([o,l])=>({date:o,value:l.size})).sort((o,l)=>o.date.localeCompare(l.date))}catch(r){return console.error("Error getting weekly active users:",r),[]}})}static getContentMetrics(){return E(this,null,function*(){try{const[t,r,n,a]=yield Promise.all([T.from("events").select("*",{count:"exact",head:!0}),T.from("artists").select("*",{count:"exact",head:!0}),T.from("venues").select("*",{count:"exact",head:!0}),T.from("reviews").select("*",{count:"exact",head:!0})]),i=new Date;i.setDate(1);const{count:o}=yield T.from("events").select("*",{count:"exact",head:!0}).gte("created_at",i.toISOString()),{data:l}=yield T.from("reviews").select("rating").not("rating","is",null),c=(l==null?void 0:l.length)>0?l.reduce((u,f)=>u+(f.rating||0),0)/l.length:0;return{total_events:t.count||0,events_this_month:o||0,total_artists:r.count||0,total_venues:n.count||0,total_reviews:a.count||0,average_event_rating:Math.round(c*100)/100,content_growth_rate:0}}catch(t){return console.error("Error getting content metrics:",t),{total_events:0,events_this_month:0,total_artists:0,total_venues:0,total_reviews:0,average_event_rating:0,content_growth_rate:0}}})}static getFeatureUsage(){return E(this,null,function*(){try{const t=yield ps.getAllUserInteractions(),r={"view:event":{name:"Event Views",category:"Event Discovery"},"click:event":{name:"Event Clicks",category:"Event Discovery"},"interest:event":{name:"Event Interest/RSVP",category:"Event Engagement"},"attendance:event":{name:"Event Attendance",category:"Event Engagement"},"share:event":{name:"Event Shares",category:"Social"},"view:artist":{name:"Artist Views",category:"Content Discovery"},"click:artist":{name:"Artist Clicks",category:"Content Discovery"},"view:venue":{name:"Venue Views",category:"Content Discovery"},"click:venue":{name:"Venue Clicks",category:"Content Discovery"},"review:event":{name:"Event Reviews",category:"Content Creation"},"review:artist":{name:"Artist Reviews",category:"Content Creation"},"review:venue":{name:"Venue Reviews",category:"Content Creation"},"like:review":{name:"Review Likes",category:"Social Engagement"},search:{name:"Search",category:"Discovery"},"click:ticket":{name:"Ticket Clicks",category:"Event Engagement"},"click:ticket_link":{name:"Ticket Link Clicks",category:"Event Engagement"},"follow:artist":{name:"Artist Follows",category:"Social"},"follow:user":{name:"User Follows",category:"Social"},navigate:{name:"Navigation",category:"Platform Usage"},profile_update:{name:"Profile Updates",category:"Profile Management"},"view:spotify":{name:"Spotify Integration",category:"Music Integration"},"click:spotify":{name:"Spotify Clicks",category:"Music Integration"}},n=new Map,a=new Date,i=new Date(a);i.setDate(i.getDate()-7);const o=new Date(a);o.setDate(o.getDate()-30),t.forEach(u=>{const f=`${u.event_type}:${u.entity_type}`,h=r[f]||{name:`${u.event_type} (${u.entity_type})`,category:"Other"};n.has(h.name)||n.set(h.name,{totalUses:0,uniqueUsers:new Set,usesLast7d:0,usesLast30d:0,usesLast7dUsers:new Set,usesLast30dUsers:new Set});const p=n.get(h.name);p.totalUses++,p.uniqueUsers.add(u.user_id);const g=new Date(u.occurred_at);g>=o&&(p.usesLast30d++,p.usesLast30dUsers.add(u.user_id)),g>=i&&(p.usesLast7d++,p.usesLast7dUsers.add(u.user_id))});const l=new Date(a);l.setDate(l.getDate()-14);const c=new Map;return t.forEach(u=>{const f=`${u.event_type}:${u.entity_type}`,h=r[f];if(h){const p=new Date(u.occurred_at);p>=l&&p<i&&c.set(h.name,(c.get(h.name)||0)+1)}}),Array.from(n.entries()).map(([u,f])=>{const h=Object.values(r).find(v=>v.name===u)||{name:u,category:"Other"},p=c.get(u)||0,g=p>0?(f.usesLast7d-p)/p*100:0;return{feature_name:u,feature_category:h.category,total_uses:f.totalUses,unique_users:f.uniqueUsers.size,uses_last_7d:f.usesLast7d,uses_last_30d:f.usesLast30d,avg_uses_per_user:f.uniqueUsers.size>0?f.totalUses/f.uniqueUsers.size:0,growth_rate:Math.round(g*100)/100}}).sort((u,f)=>f.total_uses-u.total_uses)}catch(t){return console.error("Error getting feature usage:",t),[]}})}static getUserSegments(){return E(this,null,function*(){try{const{data:t}=yield T.from("users").select("user_id, created_at"),{data:r}=yield T.from("interactions").select("user_id, created_at"),n=new Map;return r==null||r.forEach(o=>{const l=o.user_id;n.has(l)||n.set(l,{sessions:0,daysActive:new Set});const c=n.get(l);c.sessions++,c.daysActive.add(new Date(o.created_at).toISOString().split("T")[0])}),Object.entries({"New Users":{minSessions:0,maxSessions:5},"Active Users":{minSessions:6,maxSessions:20},"Power Users":{minSessions:21,maxSessions:1/0}}).map(([o,l])=>{const c=Array.from(n.entries()).filter(([g,v])=>v.sessions>=l.minSessions&&v.sessions<=l.maxSessions),d=c.length,u=n.size,f=u>0?d/u*100:0,h=d>0?c.reduce((g,[v,y])=>g+y.sessions,0)/d:0,p=d>0?c.reduce((g,[v,y])=>g+y.daysActive.size,0)/d/30*100:0;return{segment:o,count:d,percentage:Math.round(f*100)/100,avg_sessions:Math.round(h*100)/100,retention_rate:Math.round(p*100)/100}})}catch(t){return console.error("Error getting user segments:",t),[]}})}static getGeographicDistribution(){return E(this,null,function*(){try{const{data:t}=yield T.from("users").select("user_id, location_city, created_at");if(!t||t.length===0)return[];const r=new Map;t.forEach(l=>{const c=l.location_city||"Unknown";r.has(c)||r.set(c,{users:0,events:0,newUsers:0});const d=r.get(c);d.users++;const u=new Date(l.created_at),f=new Date;f.setDate(f.getDate()-30),u>=f&&d.newUsers++});const a=(yield T.from("events").select("*",{count:"exact",head:!0})).count||0,i=t.length;return r.forEach((l,c)=>{l.events=Math.round(l.users/i*a)}),Array.from(r.entries()).map(([l,c])=>{const d=c.users>0?c.newUsers/c.users*100:0;return{country:"USA",city:l,users:c.users,events:c.events,revenue:0,growth_rate:Math.round(d*100)/100}}).sort((l,c)=>c.users-l.users).slice(0,20)}catch(t){return console.error("Error getting geographic distribution:",t),[]}})}static getDAUOverTime(t=30){return E(this,null,function*(){var r;try{const n=new Date;n.setDate(n.getDate()-t),n.setHours(0,0,0,0);const{data:a}=yield T.from("interactions").select("user_id, occurred_at").gte("occurred_at",n.toISOString()),i=new Map;a==null||a.forEach(u=>{const f=new Date(u.occurred_at).toISOString().split("T")[0];i.has(f)||i.set(f,new Set),i.get(f).add(u.user_id)});const{data:o}=yield T.from("users").select("user_id, last_active_at").not("last_active_at","is",null).gte("last_active_at",n.toISOString());o==null||o.forEach(u=>{const f=new Date(u.last_active_at).toISOString().split("T")[0];i.has(f)||i.set(f,new Set),i.get(f).add(u.user_id)});const l=[],c=new Date(n),d=new Date;for(d.setHours(23,59,59,999);c<=d;){const u=c.toISOString().split("T")[0],f=((r=i.get(u))==null?void 0:r.size)||0;l.push({date:u,value:f}),c.setDate(c.getDate()+1)}return l}catch(n){return console.error("Error getting DAU over time:",n),[]}})}static getMAUOverTime(t=12){return E(this,null,function*(){var r;try{const n=new Date;n.setMonth(n.getMonth()-t),n.setDate(1),n.setHours(0,0,0,0);const{data:a}=yield T.from("interactions").select("user_id, occurred_at").gte("occurred_at",n.toISOString()),{data:i}=yield T.from("users").select("user_id, last_active_at").not("last_active_at","is",null).gte("last_active_at",n.toISOString()),o=new Map;a==null||a.forEach(d=>{const u=new Date(d.occurred_at),f=`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}`;o.has(f)||o.set(f,new Set),o.get(f).add(d.user_id)}),i==null||i.forEach(d=>{const u=new Date(d.last_active_at),f=`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}`;o.has(f)||o.set(f,new Set),o.get(f).add(d.user_id)});const l=[],c=new Date(n);for(;c<=new Date;){const d=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}`,u=((r=o.get(d))==null?void 0:r.size)||0;l.push({date:d,value:u}),c.setMonth(c.getMonth()+1)}return l}catch(n){return console.error("Error getting MAU over time:",n),[]}})}static getNewUsersOverTime(t=30){return E(this,null,function*(){try{const r=new Date;r.setDate(r.getDate()-t),r.setHours(0,0,0,0);const{data:n}=yield T.from("users").select("created_at").gte("created_at",r.toISOString()),a=new Map;n==null||n.forEach(c=>{const d=new Date(c.created_at).toISOString().split("T")[0];a.set(d,(a.get(d)||0)+1)});const i=[],o=new Date(r),l=new Date;for(l.setHours(23,59,59,999);o<=l;){const c=o.toISOString().split("T")[0];i.push({date:c,value:a.get(c)||0}),o.setDate(o.getDate()+1)}return i}catch(r){return console.error("Error getting new users over time:",r),[]}})}static getUserStats(){return E(this,null,function*(){try{const t=new Date,r=new Date(t);r.setDate(r.getDate()-7);const n=new Date(t);n.setDate(n.getDate()-30);const{count:a}=yield T.from("users").select("*",{count:"exact",head:!0}),{count:i}=yield T.from("users").select("*",{count:"exact",head:!0}).eq("verified",!0),{count:o}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("last_active_at",r.toISOString()),{count:l}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("last_active_at",n.toISOString()),{count:c}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("created_at",r.toISOString()),{count:d}=yield T.from("users").select("*",{count:"exact",head:!0}).gte("created_at",n.toISOString()),{data:u}=yield T.from("users").select("created_at"),f=u&&u.length>0?u.reduce((y,_)=>{const w=(t.getTime()-new Date(_.created_at).getTime())/864e5;return y+w},0)/u.length:0,{data:h}=yield T.from("reviews").select("user_id").eq("is_draft",!1),p=new Set((h==null?void 0:h.map(y=>y.user_id))||[]).size,{data:g}=yield T.from("user_relationships").eq("relationship_type","friend").eq("status","accepted").select("user_id, related_user_id"),v=new Set([...(g==null?void 0:g.map(y=>y.user_id))||[],...(g==null?void 0:g.map(y=>y.related_user_id))||[]]).size;return{total_users:a||0,verified_users:i||0,active_users_7d:o||0,active_users_30d:l||0,new_users_7d:c||0,new_users_30d:d||0,avg_account_age_days:Math.round(f*100)/100,users_with_reviews:p,users_with_friends:v}}catch(t){return console.error("Error getting user stats:",t),{total_users:0,verified_users:0,active_users_7d:0,active_users_30d:0,new_users_7d:0,new_users_30d:0,avg_account_age_days:0,users_with_reviews:0,users_with_friends:0}}})}static getAdminAchievements(){return E(this,null,function*(){try{const t=yield this.getPlatformStats(),r=yield this.getContentMetrics();return[{id:"first_users",name:"First Users",description:"Reach 100 total users",icon:"",progress:Math.min(t.total_users,100),goal:100,unlocked:t.total_users>=100,category:"users"},{id:"growing_platform",name:"Growing Platform",description:"Reach 1,000 total users",icon:"",progress:Math.min(t.total_users,1e3),goal:1e3,unlocked:t.total_users>=1e3,category:"users"},{id:"popular_platform",name:"Popular Platform",description:"Reach 10,000 total users",icon:"",progress:Math.min(t.total_users,1e4),goal:1e4,unlocked:t.total_users>=1e4,category:"users"},{id:"content_creator",name:"Content Creator",description:"Host 100 events on the platform",icon:"",progress:Math.min(r.total_events,100),goal:100,unlocked:r.total_events>=100,category:"content"},{id:"event_platform",name:"Event Platform",description:"Host 1,000 events on the platform",icon:"",progress:Math.min(r.total_events,1e3),goal:1e3,unlocked:r.total_events>=1e3,category:"content"},{id:"high_engagement",name:"High Engagement",description:"Achieve 10,000 total interactions",icon:"",progress:Math.min(t.total_interactions,1e4),goal:1e4,unlocked:t.total_interactions>=1e4,category:"platform"},{id:"viral_platform",name:"Viral Platform",description:"Achieve 100,000 total interactions",icon:"",progress:Math.min(t.total_interactions,1e5),goal:1e5,unlocked:t.total_interactions>=1e5,category:"platform"}]}catch(t){return console.error("Error getting admin achievements:",t),[]}})}static getNorthStarMetric(){return E(this,null,function*(){try{const t=new Date,r=new Date(t.getFullYear(),t.getMonth(),1),n=new Date(t.getFullYear(),t.getMonth()-1,1),a=new Date(t.getFullYear(),t.getMonth(),0),{data:i}=yield T.from("interactions").select("user_id, event_type, entity_type, entity_id, metadata").gte("occurred_at",r.toISOString()).in("event_type",["interest","share","attendance"]).eq("entity_type","event"),{data:o}=yield T.from("interactions").select("user_id, event_type, entity_type, entity_id, metadata").gte("occurred_at",n.toISOString()).lt("occurred_at",a.toISOString()).in("event_type",["interest","share","attendance"]).eq("entity_type","event"),{data:l}=yield T.from("user_event_relationships").in("relationship_type",["going","maybe"]).select("user_id, event_id, relationship_type").gte("created_at",r.toISOString()),{data:c}=yield T.from("user_event_relationships").in("relationship_type",["going","maybe"]).select("user_id, event_id, relationship_type").gte("created_at",n.toISOString()).lt("created_at",a.toISOString()),d=b=>{var N,S,k,P,A,R;return(b==null?void 0:b.entity_id)||((N=b==null?void 0:b.metadata)==null?void 0:N.event_id)||((S=b==null?void 0:b.metadata)==null?void 0:S.eventId)||((P=(k=b==null?void 0:b.metadata)==null?void 0:k.event)==null?void 0:P.id)||((A=b==null?void 0:b.metadata)==null?void 0:A.jambase_event_id)||((R=b==null?void 0:b.metadata)==null?void 0:R.jambaseEventId)||null},u=(b,N,S=!1)=>{const k=new Map,P=new Set,A=new Set;let R=0;const $=S?{saves:0,rsvps:0,shares:0}:null,O=(z,D,B)=>{if(!z)return;const F=D==="interest"?"save":D,U=`${z}:${F}:${B||"unknown"}`;A.has(U)||(A.add(U),P.add(z),k.set(z,(k.get(z)||0)+1),R+=1,$&&(F==="save"?$.saves+=1:F==="share"?$.shares+=1:F==="rsvp"&&($.rsvps+=1)))};return b==null||b.forEach(z=>{const D=d(z);O(z.user_id,z.event_type,D)}),N==null||N.forEach(z=>{O(z.user_id,"rsvp",z.event_id)}),{userScores:k,engagedCount:P.size,totalIntents:R,breakdown:$||{saves:0,rsvps:0,shares:0}}},f=u(i,l,!0),h=u(o,c,!1),p=f.engagedCount,g=h.engagedCount,v=p>0?f.totalIntents/p:0,y=g>0?h.totalIntents/g:0,_=y>0?(v-y)/y*100:0,w=Array.from(f.userScores.entries()).sort((b,N)=>N[1]-b[1]).slice(0,5).map(([b,N])=>({user_id:b,user_name:`User ${b.slice(0,8)}`,eci_score:N}));if(w.length>0){const b=w.map(S=>S.user_id),{data:N}=yield T.from("users").select("user_id, name").in("user_id",b);N==null||N.forEach(S=>{const k=w.find(P=>P.user_id===S.user_id);k&&(k.user_name=S.name||`User ${S.user_id.slice(0,8)}`)})}return{eci_per_user:Math.round(v*100)/100,total_engaged_users:p,total_concert_intents:f.totalIntents,monthly_growth_rate:Math.round(_*100)/100,breakdown:f.breakdown,top_engaged_users:w}}catch(t){return console.error("Error calculating North Star Metric:",t),{eci_per_user:0,total_engaged_users:0,total_concert_intents:0,monthly_growth_rate:0,breakdown:{saves:0,rsvps:0,shares:0},top_engaged_users:[]}}})}static getFeatureAdoptionFunnel(){return E(this,null,function*(){try{const t=yield ps.getAllUserInteractions(),r=[{name:"Event Interest/RSVP",eventType:"interest",entityType:"event"},{name:"Event Reviews",eventType:"review",entityType:"event"},{name:"Event Shares",eventType:"share",entityType:"event"},{name:"Search",eventType:"search",entityType:"search"},{name:"Ticket Clicks",eventType:"click_ticket",entityType:"ticket_link"}],n=new Date,a=new Date(n);a.setDate(a.getDate()-30);const i=new Date(n);i.setDate(i.getDate()-60);const o=[];for(const l of r){const c=new Set,d=new Set,u=new Set,f=new Set,h=t.filter(N=>N.event_type===l.eventType&&(l.entityType==="search"||N.entity_type===l.entityType)),p=new Map,g=new Map,v=new Map;h.forEach(N=>{const S=N.user_id,k=new Date(N.occurred_at);p.set(S,(p.get(S)||0)+1),(!g.has(S)||k<g.get(S))&&g.set(S,k),(!v.has(S)||k>v.get(S))&&v.set(S,k)}),p.forEach((N,S)=>{const k=g.get(S),P=v.get(S);c.add(S),N>=1&&N<=2?d.add(S):N>=3&&N<=10?u.add(S):N>10&&P>=a&&f.add(S)});const y=c.size,_=d.size,w=u.size,b=f.size;o.push({feature_name:l.name,discovery_count:y,trial_count:_,adoption_count:w,retention_count:b,discovery_to_trial_rate:y>0?_/y*100:0,trial_to_adoption_rate:_>0?w/_*100:0,adoption_to_retention_rate:w>0?b/w*100:0})}return o}catch(t){return console.error("Error getting feature adoption funnel:",t),[]}})}static getSessionAnalytics(){return E(this,null,function*(){try{const t=yield ps.getAllUserInteractions(),r=new Map;t.forEach(_=>{const w=_.session_id||"no-session",b=new Date(_.occurred_at);r.has(w)||r.set(w,{startTime:b,endTime:b,pageViews:0,userId:_.user_id});const N=r.get(w);b<N.startTime&&(N.startTime=b),b>N.endTime&&(N.endTime=b),_.event_type==="view"&&N.pageViews++});const n=[],a=[];r.forEach(_=>{const w=(_.endTime.getTime()-_.startTime.getTime())/6e4;n.push(w),a.push(_.pageViews||1)});const i=r.size,o=n.length>0?n.reduce((_,w)=>_+w,0)/n.length:0,l=a.length>0?a.reduce((_,w)=>_+w,0)/a.length:0,c=new Date,d=new Date(c);d.setDate(d.getDate()-7);const u=new Date(c);u.setDate(u.getDate()-30);const f=Array.from(r.values()).filter(_=>_.startTime>=d).length,h=Array.from(r.values()).filter(_=>_.startTime>=u).length,p=Array.from(r.values()).filter(_=>_.pageViews<=1).length,g=i>0?p/i*100:0,v=new Map;r.forEach(_=>{const w=_.startTime.getHours();v.set(w,(v.get(w)||0)+1)});const y=Array.from({length:24},(_,w)=>({hour:w,session_count:v.get(w)||0}));return{total_sessions:i,avg_session_duration_minutes:Math.round(o*100)/100,avg_pages_per_session:Math.round(l*100)/100,sessions_last_7d:f,sessions_last_30d:h,bounce_rate:Math.round(g*100)/100,sessions_by_hour:y}}catch(t){return console.error("Error getting session analytics:",t),{total_sessions:0,avg_session_duration_minutes:0,avg_pages_per_session:0,sessions_last_7d:0,sessions_last_30d:0,bounce_rate:0,sessions_by_hour:[]}}})}static getSocialGraphMetrics(){return E(this,null,function*(){try{const{data:t}=yield T.from("user_relationships").eq("relationship_type","friend").eq("status","accepted").select("user_id, related_user_id, created_at"),{count:r}=yield T.from("users").select("*",{count:"exact",head:!0}),n=new Map,a=new Set;t==null||t.forEach(b=>{n.set(b.user_id,(n.get(b.user_id)||0)+1),n.set(b.related_user_id,(n.get(b.related_user_id)||0)+1),a.add(b.user_id),a.add(b.related_user_id)});const i=(t==null?void 0:t.length)||0,o=a.size,l=(r||0)-o,c=Array.from(n.values()).reduce((b,N)=>b+N,0),d=o>0?c/o:0,u=o>0?i/o:0,f=o>1?o*(o-1)/2:0,h=f>0?i/f*100:0,p=new Date,g=new Date(p);g.setDate(g.getDate()-30);const v=new Date(p);v.setDate(v.getDate()-60);const y=(t==null?void 0:t.filter(b=>new Date(b.created_at)>=g).length)||0,_=(t==null?void 0:t.filter(b=>{const N=new Date(b.created_at);return N>=v&&N<g}).length)||0,w=_>0?(y-_)/_*100:0;return{total_connections:i,avg_connections_per_user:Math.round(d*100)/100,users_with_connections:o,users_without_connections:l,connection_growth_rate:Math.round(w*100)/100,avg_connection_degree:Math.round(u*100)/100,network_density:Math.round(h*100)/100}}catch(t){return console.error("Error getting social graph metrics:",t),{total_connections:0,avg_connections_per_user:0,users_with_connections:0,users_without_connections:0,connection_growth_rate:0,avg_connection_degree:0,network_density:0}}})}static getSearchEffectiveness(){return E(this,null,function*(){try{const t=yield ps.getAllUserInteractions(),r=t.filter(_=>_.event_type==="search"),n=new Set(r.map(_=>_.user_id)),a=new Date,i=new Date(a);i.setDate(i.getDate()-7);const o=new Date(a);o.setDate(o.getDate()-30);const l=r.filter(_=>new Date(_.occurred_at)>=i).length,c=r.filter(_=>new Date(_.occurred_at)>=o).length,d=new Map;r.forEach(_=>{var N,S;const w=((N=_.metadata)==null?void 0:N.query)||((S=_.metadata)==null?void 0:S.search_query)||"unknown";d.has(w)||d.set(w,{count:0,clicks:0,interests:0,searchers:new Set});const b=d.get(w);b.count++,b.searchers.add(_.user_id)}),r.forEach(_=>{var P,A;const w=new Date(_.occurred_at),b=_.user_id,N=((P=_.metadata)==null?void 0:P.query)||((A=_.metadata)==null?void 0:A.search_query)||"unknown",S=new Date(w.getTime()+5*60*1e3),k=t.filter(R=>R.user_id===b&&new Date(R.occurred_at)>=w&&new Date(R.occurred_at)<=S&&(R.event_type==="click"||R.event_type==="interest"));if(k.length>0){const R=d.get(N);R&&k.forEach($=>{$.event_type==="click"?R.clicks++:$.event_type==="interest"&&R.interests++})}});const u=Array.from(d.entries()).map(([_,w])=>({query:_,count:w.count,click_rate:w.count>0?w.clicks/w.count*100:0})).sort((_,w)=>w.count-_.count).slice(0,10),f=Array.from(d.values()).reduce((_,w)=>_+w.clicks,0),h=r.length>0?f/r.length*100:0,p=Array.from(d.values()).reduce((_,w)=>_+w.interests,0),g=r.length>0?p/r.length*100:0,v=new Map;r.forEach(_=>{var k;const w=((k=_.metadata)==null?void 0:k.category)||_.entity_type||"general";v.has(w)||v.set(w,{count:0,successes:0}),v.get(w).count++;const b=new Date(_.occurred_at),N=new Date(b.getTime()+5*60*1e3);t.some(P=>P.user_id===_.user_id&&new Date(P.occurred_at)>=b&&new Date(P.occurred_at)<=N&&(P.event_type==="click"||P.event_type==="interest"))&&v.get(w).successes++});const y=Array.from(v.entries()).map(([_,w])=>({category:_,count:w.count,success_rate:w.count>0?w.successes/w.count*100:0})).sort((_,w)=>w.count-_.count);return{total_searches:r.length,unique_searchers:n.size,searches_last_7d:l,searches_last_30d:c,search_to_click_rate:Math.round(h*100)/100,search_to_interest_rate:Math.round(g*100)/100,top_queries:u.map(_=>H(M({},_),{click_rate:Math.round(_.click_rate*100)/100})),searches_by_category:y.map(_=>H(M({},_),{success_rate:Math.round(_.success_rate*100)/100}))}}catch(t){return console.error("Error getting search effectiveness:",t),{total_searches:0,unique_searchers:0,searches_last_7d:0,searches_last_30d:0,search_to_click_rate:0,search_to_interest_rate:0,top_queries:[],searches_by_category:[]}}})}static exportAdminData(){return E(this,null,function*(){const[t,r,n,a,i,o,l,c,d,u,f,h,p,g]=yield Promise.all([this.getPlatformStats(),this.getUserGrowth(),this.getEngagementMetrics(),this.getContentMetrics(),this.getActiveUserMetrics(),this.getFeatureUsage(),this.getFeatureAdoptionFunnel(),this.getSessionAnalytics(),this.getSocialGraphMetrics(),this.getSearchEffectiveness(),this.getUserSegments(),this.getGeographicDistribution(),this.getAdminAchievements(),this.getNorthStarMetric()]);return{platformStats:t,userGrowth:r,engagementMetrics:n,contentMetrics:a,activeUserMetrics:i,featureUsage:o,featureAdoptionFunnel:l,sessionAnalytics:c,socialGraphMetrics:d,searchEffectiveness:u,userSegments:f,geographicDistribution:h,achievements:p,northStarMetric:g}})}}function b9e(){var R,$,O,z,D;const{isAdmin:e,accountInfo:t,loading:r}=ih(),{toast:n}=Rr(),[a,i]=x.useState(!0),[o,l]=x.useState([]),[c,d]=x.useState([]),[u,f]=x.useState(null),[h,p]=x.useState(""),[g,v]=x.useState(!1),[y,_]=x.useState(null);x.useEffect(()=>{if(console.log(" AdminModerationPanel: useEffect triggered"),console.log(" AdminModerationPanel: accountLoading:",r),console.log(" AdminModerationPanel: accountInfo:",t),console.log(" AdminModerationPanel: isAdmin() check:",e()),r){console.log(" AdminModerationPanel: Account still loading, waiting...");return}e()?(console.log(" AdminModerationPanel: User is admin, calling loadFlags()"),w()):console.log(" AdminModerationPanel: User is NOT admin, skipping loadFlags()")},[r,t]);const w=()=>E(this,null,function*(){var B;i(!0);try{console.log(" AdminModerationPanel: Loading flags..."),console.log(" AdminModerationPanel: isAdmin() result:",e());const{data:F,error:U}=yield T.from("moderation_flags").select("id, flag_status, flag_reason, created_at").order("created_at",{ascending:!1});if(console.log(" AdminModerationPanel: All flags in database:",F),console.log(" AdminModerationPanel: All flags error:",U),F&&Array.isArray(F)){const X=F.reduce((ne,re)=>(ne[re.flag_status]=(ne[re.flag_status]||0)+1,ne),{});console.log(" AdminModerationPanel: Flags by status:",X)}console.log(" AdminModerationPanel: Trying direct pending flags query...");const{data:G,error:q}=yield T.from("moderation_flags").select("*").eq("flag_status","pending").order("created_at",{ascending:!0});console.log(" AdminModerationPanel: Direct pending flags query result:",G),console.log(" AdminModerationPanel: Direct pending flags query error:",q);let K=G||[];if(K.length>0){const X=K.map(re=>re.flagged_by_user_id);console.log(" AdminModerationPanel: Fetching profiles for pending flags user IDs:",X);const{data:ne}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",X);console.log(" AdminModerationPanel: Profiles for pending flags:",ne),K=K.map(re=>H(M({},re),{flagger:ne==null?void 0:ne.find(ye=>ye.user_id===re.flagged_by_user_id)}))}const{data:Z,error:Y}=yield T.from("moderation_flags").select("*").neq("flag_status","pending").order("reviewed_at",{ascending:!1});console.log(" AdminModerationPanel: Reviewed flags from DB:",Z),console.log(" AdminModerationPanel: Reviewed flags error:",Y);let Q=Z||[];if(Q.length>0){const X=Q.map(re=>re.flagged_by_user_id);console.log(" AdminModerationPanel: Fetching profiles for reviewed flags user IDs:",X);const{data:ne}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",X);console.log(" AdminModerationPanel: Profiles for reviewed flags:",ne),Q=Q.map(re=>H(M({},re),{flagger:ne==null?void 0:ne.find(ye=>ye.user_id===re.flagged_by_user_id)}))}console.log(" AdminModerationPanel: Raw pending flags response:",K),console.log(" AdminModerationPanel: Raw reviewed flags response:",Q),console.log(" AdminModerationPanel: Pending flags type:",typeof K),console.log(" AdminModerationPanel: Pending flags is array:",Array.isArray(K)),console.log(" AdminModerationPanel: Pending flags length:",(K==null?void 0:K.length)||"undefined"),console.log(" AdminModerationPanel: Reviewed flags length:",(Q==null?void 0:Q.length)||"undefined"),K&&Array.isArray(K)&&(console.log(" AdminModerationPanel: Individual pending flags:"),K.forEach((X,ne)=>{console.log(`  [${ne}] Flag ID: ${X.id}, Status: ${X.flag_status}, Reason: ${X.flag_reason}`)})),l(K),d(Q.slice(0,20)),console.log(" AdminModerationPanel: State updated - pendingFlags.length:",(K==null?void 0:K.length)||0),console.log(" AdminModerationPanel: State updated - reviewedFlags.length:",((B=Q==null?void 0:Q.slice(0,20))==null?void 0:B.length)||0)}catch(F){console.error(" AdminModerationPanel: Error loading flags:",F),console.error(" AdminModerationPanel: Error details:",JSON.stringify(F,null,2)),n({title:"Error",description:"Failed to load moderation flags",variant:"destructive"})}finally{i(!1),console.log(" AdminModerationPanel: Loading completed")}}),b=B=>E(this,null,function*(){try{const F=yield Ku.getFlaggedContentDetails(B.content_type,B.content_id);_(F)}catch(F){console.error("Error loading content preview:",F),_(null)}}),N=B=>{f(B),p(""),b(B)},S=B=>E(this,null,function*(){if(u){v(!0);try{yield Ku.moderateContent(u.id,B,h.trim()||void 0,!0),n({title:"Content Moderated",description:`Successfully ${B==="remove"?"removed":B==="warn"?"warned about":"dismissed"} the flagged content`}),f(null),_(null),p(""),w()}catch(F){console.error("Error moderating content:",F),n({title:"Error",description:"Failed to moderate content",variant:"destructive"})}finally{v(!1)}}}),k=B=>new Date(B).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),P=B=>{const F={pending:"default",resolved:"secondary",dismissed:"outline"};return s.jsx(Ke,{variant:F[B]||"default",className:"capitalize",children:B})},A=({flag:B,onClick:F,isSelected:U})=>{var G,q,K;return s.jsx(He,{className:`cursor-pointer transition-all hover:shadow-md ${U?"border-purple-500 bg-purple-50":""}`,onClick:()=>F(B),children:s.jsx(et,{className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-2xl",children:((G=Ef[B.flag_reason])==null?void 0:G.icon)||""}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-semibold text-sm",children:((q=Ef[B.flag_reason])==null?void 0:q.label)||B.flag_reason}),s.jsx("p",{className:"text-xs text-gray-600 capitalize",children:Ku.getContentTypeDisplayName(B.content_type)})]})]}),B.flag_details&&s.jsxs("p",{className:"text-sm text-gray-700 line-clamp-2 mb-2",children:['"',B.flag_details,'"']}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[s.jsxs("span",{children:["By ",((K=B.flagger)==null?void 0:K.name)||"Unknown"]}),s.jsx("span",{children:""}),s.jsx("span",{children:k(B.created_at)})]})]}),P(B.flag_status)]})})})};return e()?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Content Moderation"}),s.jsx("p",{className:"text-gray-600",children:"Review and moderate flagged content"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs(Li,{defaultValue:"pending",children:[s.jsxs(yi,{className:"w-full",children:[s.jsxs(Xr,{value:"pending",className:"flex-1",children:["Pending (",o.length,")"]}),s.jsx(Xr,{value:"reviewed",className:"flex-1",children:"Reviewed"})]}),s.jsx(Jr,{value:"pending",className:"space-y-3 mt-4",children:a?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(lr,{className:"h-8 w-8 animate-spin text-purple-600"})}):o.length===0?s.jsx(He,{className:"border-dashed border-2 border-gray-200",children:s.jsxs(et,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(Qi,{className:"h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Pending Flags"}),s.jsx("p",{className:"text-sm text-gray-500 text-center max-w-sm",children:"There are no content flags waiting for review. Great job keeping the community safe! "})]})}):o.map(B=>s.jsx(A,{flag:B,onClick:N,isSelected:(u==null?void 0:u.id)===B.id},B.id))}),s.jsx(Jr,{value:"reviewed",className:"space-y-3 mt-4",children:c.length===0?s.jsx(He,{className:"border-dashed border-2 border-gray-200",children:s.jsxs(et,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(Qi,{className:"h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Reviewed Flags"}),s.jsx("p",{className:"text-sm text-gray-500 text-center max-w-sm",children:"No content flags have been reviewed yet. This is where completed moderation actions will appear."})]})}):c.map(B=>s.jsx(A,{flag:B,onClick:N,isSelected:!1},B.id))})]})}),s.jsx("div",{className:"lg:col-span-2",children:u?s.jsxs(He,{children:[s.jsxs(Er,{children:[s.jsx(qr,{children:"Review Flagged Content"}),s.jsx(uc,{children:(R=Ef[u.flag_reason])==null?void 0:R.description})]}),s.jsxs(et,{className:"space-y-4",children:[s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qi,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-semibold text-red-900",children:($=Ef[u.flag_reason])==null?void 0:$.label}),s.jsx("p",{className:"text-sm text-red-800 mt-1",children:u.flag_details}),s.jsxs("p",{className:"text-xs text-red-700 mt-2",children:["Reported by ",(O=u.flagger)==null?void 0:O.name," on ",k(u.created_at)]})]})]})}),y&&s.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[s.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[s.jsx(Kd,{className:"h-4 w-4"}),"Content Preview"]}),s.jsxs("div",{className:"text-sm space-y-2",children:[u.content_type==="event"&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Title:"})," ",y.title]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Artist:"})," ",y.artist_name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Description:"})," ",y.description]})]}),u.content_type==="review"&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"By:"})," ",(z=y.user)==null?void 0:z.name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Rating:"})," ",y.rating,"/5"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Review:"})," ",y.review]})]}),u.content_type==="comment"&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"By:"})," ",(D=y.user)==null?void 0:D.name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Comment:"})," ",y.comment]})]})]})]}),u.flag_status==="pending"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Review Notes (Optional)"}),s.jsx(ys,{placeholder:"Add notes about your decision...",value:h,onChange:B=>p(B.target.value),disabled:g,rows:3})]}),u.flag_status==="pending"?s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(le,{variant:"destructive",onClick:()=>S("remove"),disabled:g,className:"flex-1",children:[g?s.jsx(lr,{className:"h-4 w-4 mr-2 animate-spin"}):s.jsx(Dl,{className:"h-4 w-4 mr-2"}),"Remove Content"]}),s.jsxs(le,{variant:"outline",onClick:()=>S("warn"),disabled:g,className:"flex-1 border-yellow-500 text-yellow-700 hover:bg-yellow-50",children:[s.jsx(NP,{className:"h-4 w-4 mr-2"}),"Warn User"]}),s.jsxs(le,{variant:"outline",onClick:()=>S("dismiss"),disabled:g,className:"flex-1",children:[s.jsx(Gr,{className:"h-4 w-4 mr-2"}),"Dismiss"]})]}):s.jsxs("div",{className:"bg-gray-100 rounded-lg p-4",children:[s.jsx("p",{className:"font-semibold",children:"This flag has been reviewed"}),u.action_taken&&s.jsxs("p",{className:"text-sm text-gray-700 mt-1",children:["Action taken: ",s.jsx("span",{className:"font-medium capitalize",children:u.action_taken})]}),u.review_notes&&s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:u.review_notes})]})]})]}):s.jsx(He,{children:s.jsxs(et,{className:"py-12 text-center",children:[s.jsx(Qi,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"Select a flag to review"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Choose a flagged content item from the list to begin moderation"})]})})})]})]}):s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsx("p",{className:"text-gray-600",children:"Access denied. Admin privileges required."})})}function j9e({currentUserId:e}){const[t,r]=x.useState([]),[n,a]=x.useState([]),[i,o]=x.useState(!0),[l,c]=x.useState(null),[d,u]=x.useState(""),[f,h]=x.useState("all"),[p,g]=x.useState("score"),{toast:v}=Rr();x.useEffect(()=>{y()},[]),x.useEffect(()=>{let N=[...t];d&&(N=N.filter(S=>S.name.toLowerCase().includes(d.toLowerCase()))),f!=="all"&&(N=N.filter(S=>f==="verified"?S.verified:!S.verified)),N.sort((S,k)=>p==="score"?(k.trust_score||0)-(S.trust_score||0):new Date(k.created_at).getTime()-new Date(S.created_at).getTime()),a(N)},[t,d,f,p]);const y=()=>E(this,null,function*(){try{o(!0);const N=yield J_.getUsersNearVerification(50);r(N)}catch(N){console.error("Error fetching users:",N),v({title:"Error",description:"Failed to load users near verification.",variant:"destructive"})}finally{o(!1)}}),_=(N,S)=>E(this,null,function*(){try{c(N),yield J_.manuallyVerifyUser(N,e,S),v({title:"Success",description:`User ${S?"verified":"unverified"} successfully.`}),yield y()}catch(k){console.error("Error verifying user:",k),v({title:"Error",description:"Failed to update user verification status.",variant:"destructive"})}finally{c(null)}}),w=N=>N?Object.values(N).filter(Boolean).length:0,b=()=>{const N=[["Name","Trust Score","Criteria Met","Verified","Account Age","Created At"].join(","),...n.map(A=>[A.name,A.trust_score||0,`${w(A.verification_criteria_met)}/8`,A.verified?"Yes":"No",Math.floor((Date.now()-new Date(A.created_at).getTime())/864e5),new Date(A.created_at).toLocaleDateString()].join(","))].join(`
`),S=new Blob([N],{type:"text/csv"}),k=window.URL.createObjectURL(S),P=document.createElement("a");P.href=k,P.download=`verification-stats-${new Date().toISOString().split("T")[0]}.csv`,P.click(),window.URL.revokeObjectURL(k)};return i?s.jsxs(He,{children:[s.jsxs(Er,{children:[s.jsx(qr,{children:"Verification Management"}),s.jsx(uc,{children:"Manage user verification requests"})]}),s.jsx(et,{children:s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(He,{children:[s.jsxs(Er,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs(qr,{className:"flex items-center gap-2",children:[s.jsx(Bn,{className:"w-5 h-5"}),"Verification Management"]}),s.jsx(uc,{children:"Users close to verification threshold (40%+ trust score)"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{variant:"outline",size:"sm",onClick:b,disabled:n.length===0,children:[s.jsx(cp,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),s.jsxs(le,{variant:"outline",size:"sm",onClick:y,disabled:i,children:[s.jsx(mi,{className:`w-4 h-4 mr-2 ${i?"animate-spin":""}`}),"Refresh"]})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Uo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx(Ar,{placeholder:"Search by name...",value:d,onChange:N=>u(N.target.value),className:"pl-10"})]}),s.jsxs(aa,{value:f,onValueChange:N=>h(N),children:[s.jsxs(Hs,{className:"w-[180px]",children:[s.jsx(Iy,{className:"w-4 h-4 mr-2"}),s.jsx(ia,{placeholder:"Filter status"})]}),s.jsxs(Gs,{children:[s.jsx(qt,{value:"all",children:"All Users"}),s.jsx(qt,{value:"verified",children:"Verified"}),s.jsx(qt,{value:"unverified",children:"Unverified"})]})]}),s.jsxs(aa,{value:p,onValueChange:N=>g(N),children:[s.jsx(Hs,{className:"w-[180px]",children:s.jsx(ia,{placeholder:"Sort by"})}),s.jsxs(Gs,{children:[s.jsx(qt,{value:"score",children:"Trust Score"}),s.jsx(qt,{value:"date",children:"Join Date"})]})]})]})]}),s.jsx(et,{children:n.length===0?s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:t.length===0?"No users near verification threshold":"No users match your filters"})}):s.jsx("div",{className:"space-y-4",children:n.map(N=>{const S=w(N.verification_criteria_met),k=8,P=l===N.user_id;return s.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsxs(Vr,{className:"w-12 h-12",children:[s.jsx(sn,{src:N.avatar_url||void 0}),s.jsx(Wr,{children:N.name.charAt(0).toUpperCase()})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h4",{className:"font-semibold truncate",children:N.name}),N.verified&&s.jsx(Ke,{variant:"default",className:"text-xs",children:"Verified"}),s.jsx(Ke,{variant:"secondary",className:"text-xs",children:N.account_type})]}),s.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Trust Score: ",N.trust_score,"%"]}),s.jsxs("span",{children:["Criteria: ",S,"/",k]}),s.jsxs("span",{children:["Member since ",Mt(new Date(N.created_at),"MMM yyyy")]})]}),s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:N.verification_criteria_met&&Object.entries(N.verification_criteria_met).map(([A,R])=>R?s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:A},A):null)})]}),s.jsx("div",{className:"flex items-center gap-2",children:N.verified?s.jsx(le,{variant:"outline",size:"sm",onClick:()=>_(N.user_id,!1),disabled:P,children:P?s.jsx(mi,{className:"w-4 h-4 animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(mQ,{className:"w-4 h-4 mr-2"}),"Unverify"]})}):s.jsx(le,{variant:"default",size:"sm",onClick:()=>_(N.user_id,!0),disabled:P,children:P?s.jsx(mi,{className:"w-4 h-4 animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(dc,{className:"w-4 h-4 mr-2"}),"Verify"]})})})]},N.id)})})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(He,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-primary",children:t.length}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Near Verification"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"40%+ trust score"})]})})}),s.jsx(He,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600",children:t.filter(N=>N.verified).length}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Verified"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:t.length>0?`${Math.round(t.filter(N=>N.verified).length/t.length*100)}% conversion`:"0% conversion"})]})})}),s.jsx(He,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-amber-600",children:t.filter(N=>!N.verified).length}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Pending Review"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Awaiting criteria"})]})})}),s.jsx(He,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[Math.round(t.reduce((N,S)=>N+S.trust_score,0)/t.length)||0,"%"]}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Avg Trust Score"}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Range: ",Math.min(...t.map(N=>N.trust_score)),"% - ",Math.max(...t.map(N=>N.trust_score)),"%"]})]})})})]})]})}function N9e(){const{user:e}=xs(),[t,r]=x.useState(!0),[n,a]=x.useState(null),[i,o]=x.useState([]),[l,c]=x.useState(null),[d,u]=x.useState(null),[f,h]=x.useState([]),[p,g]=x.useState([]),[v,y]=x.useState([]),[_,w]=x.useState(null),[b,N]=x.useState([]),[S,k]=x.useState([]),[P,A]=x.useState([]),[R,$]=x.useState(null),[O,z]=x.useState(null),[D,B]=x.useState([]),[F,U]=x.useState([]),[G,q]=x.useState(null),[K,Z]=x.useState(null),[Y,Q]=x.useState(null),[X,ne]=x.useState("overview");x.useEffect(()=>{console.log(" AdminAnalyticsDashboard: activeTab changed to:",X)},[X]),x.useEffect(()=>{e&&re()},[e]);const re=()=>E(this,null,function*(){if(e)try{r(!0);const[ee,de,xe,ie,se,V,ue,_e,ae,we,oe,ce,Ae,Be,Xe,ge,We,Ue]=yield Promise.all([Is.getPlatformStats(),Is.getUserGrowth(),Is.getEngagementMetrics(),Is.getContentMetrics(),Is.getUserSegments(),Is.getGeographicDistribution(),Is.getAdminAchievements(),Is.getNorthStarMetric(),Is.getDAUOverTime(30),Is.getMAUOverTime(12),Is.getNewUsersOverTime(30),Is.getUserStats(),Is.getActiveUserMetrics(),Is.getFeatureUsage(),Is.getFeatureAdoptionFunnel(),Is.getSessionAnalytics(),Is.getSocialGraphMetrics(),Is.getSearchEffectiveness()]);a(ee),o(de),c(xe),u(ie),h(se),g(V),y(ue),w(_e),N(ae),k(we),A(oe),$(ce),z(Ae),B(Be),U(Xe),q(ge),Z(We),Q(Ue)}catch(ee){console.error("Error fetching admin data:",ee)}finally{r(!1)}}),ye=()=>E(this,null,function*(){if(e)try{const ee=yield Is.exportAdminData(),de=new Blob([JSON.stringify(ee,null,2)],{type:"application/json"}),xe=URL.createObjectURL(de),ie=document.createElement("a");ie.href=xe,ie.download=`admin-analytics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),URL.revokeObjectURL(xe)}catch(ee){console.error("Error exporting data:",ee)}});return t?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsx(to,{})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((ee,de)=>s.jsx(to,{},de))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(to,{}),s.jsx(to,{})]})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(gl,{className:"w-8 h-8 text-red-600"}),s.jsx("h1",{className:"gradient-text text-3xl font-bold",children:"Admin Analytics"})]}),s.jsx("p",{className:"text-gray-600",children:"Platform-wide analytics, system health, and business intelligence"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:ye,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[s.jsx(cp,{className:"w-4 h-4"}),"Export Data"]}),s.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-red-600 to-orange-600 text-white rounded-lg hover:from-red-700 hover:to-orange-700 transition-all",children:"System Settings"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(oi,{title:"North Star: ECI/U",value:(_==null?void 0:_.eci_per_user)||0,icon:s.jsx(Zi,{className:"w-6 h-6"}),trend:(_==null?void 0:_.monthly_growth_rate)>0?"up":(_==null?void 0:_.monthly_growth_rate)<0?"down":"neutral",subtitle:"concert intents per user"}),s.jsx(oi,{title:"Total Users",value:(n==null?void 0:n.total_users)||0,icon:s.jsx(zr,{className:"w-6 h-6"}),trend:(n==null?void 0:n.platform_growth_rate)>0?"up":(n==null?void 0:n.platform_growth_rate)<0?"down":"neutral"}),s.jsx(oi,{title:"Daily Active Users",value:(n==null?void 0:n.daily_active_users)||0,icon:s.jsx(wo,{className:"w-6 h-6"}),subtitle:"active today"}),s.jsx(oi,{title:"Monthly Active Users",value:(n==null?void 0:n.monthly_active_users)||0,icon:s.jsx(Bn,{className:"w-6 h-6"}),subtitle:"last 30 days"}),s.jsx(oi,{title:"Active Users (10+ interactions)",value:(O==null?void 0:O.total_active_users)||0,icon:s.jsx(Og,{className:"w-6 h-6"}),subtitle:"users with 10+ interactions"}),s.jsx(oi,{title:"Total Events",value:(n==null?void 0:n.total_events)||0,icon:s.jsx(It,{className:"w-6 h-6"}),trend:(d==null?void 0:d.content_growth_rate)>0?"up":(d==null?void 0:d.content_growth_rate)<0?"down":"neutral",subtitle:"events this month"})]}),s.jsx("div",{className:"mb-8",children:s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:Fd},{id:"users",label:"Users",icon:zr},{id:"active-users",label:"Active Users",icon:Og},{id:"content",label:"Content",icon:It},{id:"moderation",label:"Moderation",icon:Qi},{id:"achievements",label:"Achievements",icon:Bd}].map(ee=>s.jsxs("button",{onClick:()=>{console.log(" AdminAnalyticsDashboard: Tab clicked:",ee.id),ne(ee.id)},className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${X===ee.id?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(ee.icon,{className:"w-4 h-4"}),ee.label]},ee.id))})})}),X==="overview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gradient-to-r from-pink-50 to-red-50 rounded-xl p-6 shadow-sm border border-pink-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-gradient-to-r from-pink-500 to-red-500 rounded-lg",children:s.jsx(Zi,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"North Star Metric"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Engaged Concert Intent per User (ECI/U)"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-pink-600 mb-1",children:(_==null?void 0:_.eci_per_user)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Average ECI per User"}),s.jsx("div",{className:"text-xs text-gray-500",children:"This month"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:(_==null?void 0:_.total_engaged_users)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Engaged Users"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Active this month"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600 mb-1",children:(_==null?void 0:_.total_concert_intents)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Total Concert Intents"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Saves + RSVPs + Shares"})]})]}),s.jsxs("div",{className:"mt-6 pt-6 border-t border-pink-200",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Intent Breakdown"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[s.jsx("div",{className:"text-lg font-semibold text-pink-600",children:(_==null?void 0:_.breakdown.saves)||0}),s.jsx("div",{className:"text-xs text-gray-600",children:"Saves"})]}),s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[s.jsx("div",{className:"text-lg font-semibold text-blue-600",children:(_==null?void 0:_.breakdown.rsvps)||0}),s.jsx("div",{className:"text-xs text-gray-600",children:"RSVPs"})]}),s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[s.jsx("div",{className:"text-lg font-semibold text-purple-600",children:(_==null?void 0:_.breakdown.shares)||0}),s.jsx("div",{className:"text-xs text-gray-600",children:"Shares"})]})]})]}),(_==null?void 0:_.top_engaged_users)&&_.top_engaged_users.length>0&&s.jsxs("div",{className:"mt-6 pt-6 border-t border-pink-200",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Engaged Users"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:_.top_engaged_users.slice(0,6).map((ee,de)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-pink-400 to-red-400 rounded-full flex items-center justify-center text-white text-xs font-bold",children:de+1}),s.jsx("span",{className:"text-sm font-medium text-gray-900 truncate",children:ee.user_name})]}),s.jsxs("div",{className:"text-sm font-semibold text-pink-600",children:[ee.eci_score," ECI"]})]},ee.user_id))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Kd,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Page Views"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(l==null?void 0:l.total_page_views)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Uo,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Searches"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:(l==null?void 0:l.searches_performed)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Qt,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"Reviews"})]}),s.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:(l==null?void 0:l.reviews_written)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ml,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Ticket Clicks"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:(l==null?void 0:l.tickets_clicked)||0})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(Uk,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Feature Usage"})]}),D.length>0?s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Feature"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Category"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Total Uses"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Unique Users"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Last 7d"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Last 30d"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Growth"})]})}),s.jsx("tbody",{children:D.slice(0,15).map((ee,de)=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:ee.feature_name}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs bg-purple-100 text-purple-700",children:ee.feature_category})}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ee.total_uses.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ee.unique_users.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ee.uses_last_7d.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ee.uses_last_30d.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("span",{className:`font-semibold ${ee.growth_rate>0?"text-green-600":ee.growth_rate<0?"text-red-600":"text-gray-600"}`,children:[ee.growth_rate>0?"+":"",ee.growth_rate.toFixed(1),"%"]})})]},ee.feature_name))})]})})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Uk,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No feature usage data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(Zi,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Feature Adoption Funnel"})]}),F.length>0?s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Feature"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Discovery"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Trial"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Adoption"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Retention"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"DiscoveryTrial"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"TrialAdoption"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"AdoptionRetention"})]})}),s.jsx("tbody",{children:F.map(ee=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:ee.feature_name}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ee.discovery_count.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ee.trial_count.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ee.adoption_count.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ee.retention_count.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("span",{className:"font-semibold text-blue-600",children:[ee.discovery_to_trial_rate.toFixed(1),"%"]})}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("span",{className:"font-semibold text-green-600",children:[ee.trial_to_adoption_rate.toFixed(1),"%"]})}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("span",{className:"font-semibold text-purple-600",children:[ee.adoption_to_retention_rate.toFixed(1),"%"]})})]},ee.feature_name))})]})})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Zi,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No feature adoption data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(Uo,{className:"w-5 h-5 text-green-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Search Effectiveness"})]}),Y?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Total Searches"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Y.total_searches.toLocaleString()})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"SearchClick Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[Y.search_to_click_rate.toFixed(1),"%"]})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-purple-900 mb-1",children:"SearchInterest Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[Y.search_to_interest_rate.toFixed(1),"%"]})]}),s.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-orange-900 mb-1",children:"Unique Searchers"}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:Y.unique_searchers.toLocaleString()})]})]}),Y.top_queries.length>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Search Queries"}),s.jsx("div",{className:"space-y-2",children:Y.top_queries.slice(0,10).map((ee,de)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-green-400 to-blue-400 rounded-full flex items-center justify-center text-white text-xs font-bold",children:de+1}),s.jsx("span",{className:"font-medium text-gray-900",children:ee.query})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[ee.count," searches"]}),s.jsxs("span",{className:"text-sm font-semibold text-green-600",children:[ee.click_rate.toFixed(1),"% click rate"]})]})]},de))})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Uo,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No search data available"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Segments"}),f.length>0?s.jsx("div",{className:"space-y-3",children:f.map(ee=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:ee.segment}),s.jsxs("p",{className:"text-sm text-gray-500",children:[ee.avg_sessions," avg sessions"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:ee.count}),s.jsxs("p",{className:"text-sm text-gray-500",children:[ee.percentage,"%"]})]})]},ee.segment))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(zr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No user segment data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Geographic Distribution"}),p.length>0?s.jsx("div",{className:"space-y-3",children:p.slice(0,5).map(ee=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:ee.country}),s.jsxs("p",{className:"text-sm text-gray-500",children:[ee.events," events"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:ee.users}),s.jsx("p",{className:"text-sm text-gray-500",children:"users"})]})]},ee.country))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ki,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]})]})]}),X==="users"&&s.jsxs("div",{className:"space-y-6",children:[R&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(zr,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:R.total_users.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"All registered users"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Og,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Verified Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:R.verified_users.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:R.total_users>0?`${Math.round(R.verified_users/R.total_users*100)}% verified`:"0% verified"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(wo,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Active (7d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:R.active_users_7d.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Active in last 7 days"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ad,{className:"w-4 h-4 text-pink-600"}),s.jsx("span",{className:"text-sm font-medium text-pink-600",children:"New (7d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-pink-900",children:R.new_users_7d.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"New users this week"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Bn,{className:"w-4 h-4 text-orange-600"}),s.jsx("span",{className:"text-sm font-medium text-orange-600",children:"Active (30d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:R.active_users_30d.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Active in last 30 days"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Qt,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"With Reviews"})]}),s.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:R.users_with_reviews.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Users who wrote reviews"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(ns,{className:"w-4 h-4 text-red-600"}),s.jsx("span",{className:"text-sm font-medium text-red-600",children:"With Friends"})]}),s.jsx("p",{className:"text-2xl font-bold text-red-900",children:R.users_with_friends.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Users with connections"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(It,{className:"w-4 h-4 text-indigo-600"}),s.jsx("span",{className:"text-sm font-medium text-indigo-600",children:"Avg Account Age"})]}),s.jsx("p",{className:"text-2xl font-bold text-indigo-900",children:Math.round(R.avg_account_age_days)}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Days since registration"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Daily Active Users (DAU)"}),s.jsx(wo,{className:"w-5 h-5 text-blue-600"})]}),b.length>0?s.jsx(rc,{width:"100%",height:300,children:s.jsxs(y$,{data:b,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"dauGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),s.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),s.jsx(ol,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ri,{dataKey:"date",stroke:"#6b7280",tickFormatter:ee=>{const de=new Date(ee);return`${de.getMonth()+1}/${de.getDate()}`}}),s.jsx(ni,{stroke:"#6b7280"}),s.jsx(ea,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},labelFormatter:ee=>new Date(ee).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),s.jsx($c,{type:"monotone",dataKey:"value",stroke:"#3b82f6",fillOpacity:1,fill:"url(#dauGradient)",name:"Active Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(wo,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No DAU data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Monthly Active Users (MAU)"}),s.jsx(Bn,{className:"w-5 h-5 text-green-600"})]}),S.length>0?s.jsx(rc,{width:"100%",height:300,children:s.jsxs(v$,{data:S,children:[s.jsx(ol,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ri,{dataKey:"date",stroke:"#6b7280",tickFormatter:ee=>{const[de,xe]=ee.split("-");return`${xe}/${de.slice(2)}`}}),s.jsx(ni,{stroke:"#6b7280"}),s.jsx(ea,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},labelFormatter:ee=>{const[de,xe]=ee.split("-");return new Date(parseInt(de),parseInt(xe)-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}}),s.jsx(Zm,{type:"monotone",dataKey:"value",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",r:4},name:"Active Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Bn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No MAU data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"New Users Over Time"}),s.jsx(Ad,{className:"w-5 h-5 text-pink-600"})]}),P.length>0?s.jsx(rc,{width:"100%",height:300,children:s.jsxs(Fg,{data:P,children:[s.jsx(ol,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ri,{dataKey:"date",stroke:"#6b7280",tickFormatter:ee=>{const de=new Date(ee);return`${de.getMonth()+1}/${de.getDate()}`}}),s.jsx(ni,{stroke:"#6b7280"}),s.jsx(ea,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},labelFormatter:ee=>new Date(ee).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),s.jsx(Ri,{dataKey:"value",fill:"#ec4899",radius:[8,8,0,0],name:"New Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ad,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No new users data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"User Geography"}),s.jsx(Ki,{className:"w-5 h-5 text-indigo-600"})]}),p.length>0?s.jsxs("div",{className:"space-y-4",children:[s.jsx(rc,{width:"100%",height:300,children:s.jsxs(Fg,{data:p.slice(0,10),layout:"vertical",children:[s.jsx(ol,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ri,{type:"number",stroke:"#6b7280"}),s.jsx(ni,{type:"category",dataKey:"city",stroke:"#6b7280",width:120}),s.jsx(ea,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:ee=>[ee.toLocaleString(),"Users"]}),s.jsx(Ri,{dataKey:"users",fill:"#6366f1",radius:[0,8,8,0],name:"Users"})]})}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Cities by User Count"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:p.slice(0,12).map((ee,de)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-indigo-400 to-purple-400 rounded-full flex items-center justify-center text-white text-xs font-bold",children:de+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:ee.city||"Unknown"}),s.jsx("p",{className:"text-xs text-gray-500",children:ee.country})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:ee.users.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500",children:"users"})]})]},`${ee.city||"Unknown"}-${ee.country}-${de}`))})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ki,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Segmentation"}),f.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Segment"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Count"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Percentage"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Avg Sessions"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Retention"})]})}),s.jsx("tbody",{children:f.map(ee=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:ee.segment}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ee.count}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[ee.percentage,"%"]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ee.avg_sessions}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[ee.retention_rate,"%"]})]},ee.segment))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ib,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No user segment data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(wo,{className:"w-5 h-5 text-indigo-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Session Analytics"})]}),G?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Total Sessions"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:G.total_sessions.toLocaleString()}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"All time"})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Avg Duration"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[G.avg_session_duration_minutes.toFixed(1)," min"]}),s.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Per session"})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-purple-900 mb-1",children:"Avg Pages"}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:G.avg_pages_per_session.toFixed(1)}),s.jsx("p",{className:"text-xs text-purple-700 mt-1",children:"Per session"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-orange-900 mb-1",children:"Sessions (7d)"}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:G.sessions_last_7d.toLocaleString()})]}),s.jsxs("div",{className:"bg-pink-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-pink-900 mb-1",children:"Sessions (30d)"}),s.jsx("p",{className:"text-2xl font-bold text-pink-900",children:G.sessions_last_30d.toLocaleString()})]}),s.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-red-900 mb-1",children:"Bounce Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-red-900",children:[G.bounce_rate.toFixed(1),"%"]}),s.jsx("p",{className:"text-xs text-red-700 mt-1",children:"1 page view only"})]})]}),G.sessions_by_hour.length>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Sessions by Hour of Day"}),s.jsx(rc,{width:"100%",height:250,children:s.jsxs(Fg,{data:G.sessions_by_hour,children:[s.jsx(ol,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ri,{dataKey:"hour",stroke:"#6b7280",tickFormatter:ee=>`${ee%24}:00`}),s.jsx(ni,{stroke:"#6b7280"}),s.jsx(ea,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},labelFormatter:ee=>`${ee}:00`,formatter:ee=>[ee.toLocaleString(),"Sessions"]}),s.jsx(Ri,{dataKey:"session_count",fill:"#6366f1",radius:[8,8,0,0],name:"Sessions"})]})})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(wo,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No session data available"})]})]})]}),X==="content"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(It,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Events"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(d==null?void 0:d.total_events)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(zr,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Total Artists"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:(d==null?void 0:d.total_artists)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(sh,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Total Venues"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:(d==null?void 0:d.total_venues)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Qt,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"Avg Rating"})]}),s.jsxs("p",{className:"text-2xl font-bold text-yellow-900",children:[(d==null?void 0:d.average_event_rating)||0,"/5"]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Content Statistics"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Events This Month"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(d==null?void 0:d.events_this_month)||0}),s.jsx("p",{className:"text-xs text-blue-700",children:"New events added"})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Total Reviews"}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:(d==null?void 0:d.total_reviews)||0}),s.jsx("p",{className:"text-xs text-green-700",children:"User reviews written"})]})]})]})]}),X==="achievements"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[s.jsx(Bd,{className:"w-8 h-8 text-yellow-500"}),s.jsx("h2",{className:"gradient-text text-2xl font-bold",children:"Platform Achievements"})]}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Track your platform milestones and growth metrics"})]}),["users","content","platform"].map(ee=>{const de=v.filter(ie=>ie.category===ee),xe={users:"User Growth",content:"Content Creation",platform:"Platform Engagement"};return s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Ac,{className:"w-5 h-5 text-red-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:xe[ee]})]}),de.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:de.map(ie=>s.jsx(aA,{name:ie.name,description:ie.description,icon:ie.icon,progress:ie.progress,goal:ie.goal,unlocked:ie.unlocked,unlockedAt:ie.unlockedAt,compact:!0},ie.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ac,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No achievements in this category yet"})]})]},ee)})]}),X==="active-users"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Og,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Active Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(O==null?void 0:O.total_active_users)||0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"10+ interactions"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(wo,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Active (7d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:(O==null?void 0:O.active_users_7d)||0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Last 7 days"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Bn,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Active (30d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:(O==null?void 0:O.active_users_30d)||0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Last 30 days"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Zi,{className:"w-4 h-4 text-orange-600"}),s.jsx("span",{className:"text-sm font-medium text-orange-600",children:"Avg Interactions"})]}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:(O==null?void 0:O.avg_interactions_per_active_user)||0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Per active user"})]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-xl p-6 shadow-sm border border-green-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(dc,{className:"w-6 h-6 text-green-600"}),s.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Verification Statistics"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600 mb-1",children:(O==null?void 0:O.verification_stats.total_verified)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Verified Users"}),s.jsx("div",{className:"text-xs text-gray-500",children:(O==null?void 0:O.total_active_users)>0?`${Math.round(O.verification_stats.total_verified/O.total_active_users*100)}% of active users`:"0%"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:[(O==null?void 0:O.verification_stats.avg_trust_score)||0,"%"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Avg Trust Score"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Across active users"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold text-purple-600 mb-1",children:[(O==null?void 0:O.verification_stats.avg_verification_progress)||0,"/8"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Avg Progress"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Criteria met"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-1",children:(O==null?void 0:O.verification_stats.users_near_verification)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Near Verification"}),s.jsx("div",{className:"text-xs text-gray-500",children:"40%+ trust score"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(ns,{className:"w-5 h-5 text-pink-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Social Graph Metrics"})]}),K?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-pink-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-pink-900 mb-1",children:"Total Connections"}),s.jsx("p",{className:"text-2xl font-bold text-pink-900",children:K.total_connections.toLocaleString()}),s.jsx("p",{className:"text-xs text-pink-700 mt-1",children:"Friendships"})]}),s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Avg Connections"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:K.avg_connections_per_user.toFixed(1)}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Per user"})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Network Density"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[K.network_density.toFixed(2),"%"]}),s.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Connectedness"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-purple-900 mb-1",children:"With Connections"}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:K.users_with_connections.toLocaleString()})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Without Connections"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:K.users_without_connections.toLocaleString()})]}),s.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-orange-900 mb-1",children:"Avg Degree"}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:K.avg_connection_degree.toFixed(1)})]}),s.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-indigo-900 mb-1",children:"Growth Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-indigo-900",children:[K.connection_growth_rate>0?"+":"",K.connection_growth_rate.toFixed(1),"%"]})]})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(ns,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No social graph data available"})]})]}),e&&s.jsx("div",{className:"bg-white rounded-xl shadow-sm",children:s.jsx(j9e,{currentUserId:e.id})}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Geographic Distribution"}),s.jsx(Ki,{className:"w-5 h-5 text-indigo-600"})]}),O!=null&&O.geographic_distribution&&O.geographic_distribution.length>0?s.jsxs("div",{className:"space-y-4",children:[s.jsx(rc,{width:"100%",height:300,children:s.jsxs(Fg,{data:O.geographic_distribution.slice(0,10),layout:"vertical",children:[s.jsx(ol,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ri,{type:"number",stroke:"#6b7280"}),s.jsx(ni,{type:"category",dataKey:"city",stroke:"#6b7280",width:120}),s.jsx(ea,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:ee=>[ee.toLocaleString(),"Users"]}),s.jsx(Ri,{dataKey:"users",fill:"#6366f1",radius:[0,8,8,0],name:"Users"})]})}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Cities by Active Users"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:O.geographic_distribution.slice(0,12).map((ee,de)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-indigo-400 to-purple-400 rounded-full flex items-center justify-center text-white text-xs font-bold",children:de+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:ee.city||"Unknown"}),s.jsx("p",{className:"text-xs text-gray-500",children:ee.country})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:ee.users.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500",children:"users"})]})]},`${ee.city||"Unknown"}-${ee.country}-${de}`))})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ki,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Daily Active Users"}),s.jsx(wo,{className:"w-5 h-5 text-blue-600"})]}),O!=null&&O.time_series_data.daily&&O.time_series_data.daily.length>0?s.jsx(rc,{width:"100%",height:250,children:s.jsxs(y$,{data:O.time_series_data.daily,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"dauGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),s.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),s.jsx(ol,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ri,{dataKey:"date",stroke:"#6b7280",tickFormatter:ee=>{const de=new Date(ee);return`${de.getMonth()+1}/${de.getDate()}`}}),s.jsx(ni,{stroke:"#6b7280"}),s.jsx(ea,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),s.jsx($c,{type:"monotone",dataKey:"value",stroke:"#3b82f6",fillOpacity:1,fill:"url(#dauGradient)",name:"Active Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(wo,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Active Users"}),s.jsx(Bn,{className:"w-5 h-5 text-green-600"})]}),O!=null&&O.time_series_data.weekly&&O.time_series_data.weekly.length>0?s.jsx(rc,{width:"100%",height:250,children:s.jsxs(v$,{data:O.time_series_data.weekly,children:[s.jsx(ol,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(ri,{dataKey:"date",stroke:"#6b7280",tickFormatter:ee=>{const de=new Date(ee);return`${de.getMonth()+1}/${de.getDate()}`}}),s.jsx(ni,{stroke:"#6b7280"}),s.jsx(ea,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),s.jsx(Zm,{type:"monotone",dataKey:"value",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",r:4},name:"Active Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Bn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No data available"})]})]})]})]}),X==="moderation"&&s.jsxs("div",{className:"space-y-6",children:[(console.log(" AdminAnalyticsDashboard: Rendering moderation tab, activeTab:",X),null),s.jsx(b9e,{})]})]})})}var SY=["PageUp","PageDown"],kY=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],EY={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},$p="Slider",[dC,S9e,k9e]=ip($p),[CY,LBe]=Os($p,[k9e]),[E9e,Pj]=CY($p),PY=x.forwardRef((e,t)=>{const O=e,{name:r,min:n=0,max:a=100,step:i=1,orientation:o="horizontal",disabled:l=!1,minStepsBetweenThumbs:c=0,defaultValue:d=[n],value:u,onValueChange:f=()=>{},onValueCommit:h=()=>{},inverted:p=!1,form:g}=O,v=me(O,["name","min","max","step","orientation","disabled","minStepsBetweenThumbs","defaultValue","value","onValueChange","onValueCommit","inverted","form"]),y=x.useRef(new Set),_=x.useRef(0),b=o==="horizontal"?C9e:P9e,[N=[],S]=Wa({prop:u,defaultProp:d,onChange:z=>{var B;(B=[...y.current][_.current])==null||B.focus(),f(z)}}),k=x.useRef(N);function P(z){const D=M9e(N,z);$(z,D)}function A(z){$(z,_.current)}function R(){const z=k.current[_.current];N[_.current]!==z&&h(N)}function $(z,D,{commit:B}={commit:!1}){const F=L9e(i),U=F9e(Math.round((z-n)/i)*i+n,F),G=$v(U,[n,a]);S((q=[])=>{const K=R9e(q,G,D);if($9e(K,c*i)){_.current=K.indexOf(G);const Z=String(K)!==String(q);return Z&&B&&h(K),Z?K:q}else return q})}return s.jsx(E9e,{scope:e.__scopeSlider,name:r,disabled:l,min:n,max:a,valueIndexToChangeRef:_,thumbs:y.current,values:N,orientation:o,form:g,children:s.jsx(dC.Provider,{scope:e.__scopeSlider,children:s.jsx(dC.Slot,{scope:e.__scopeSlider,children:s.jsx(b,H(M({"aria-disabled":l,"data-disabled":l?"":void 0},v),{ref:t,onPointerDown:pt(v.onPointerDown,()=>{l||(k.current=N)}),min:n,max:a,inverted:p,onSlideStart:l?void 0:P,onSlideMove:l?void 0:A,onSlideEnd:l?void 0:R,onHomeKeyDown:()=>!l&&$(n,0,{commit:!0}),onEndKeyDown:()=>!l&&$(a,N.length-1,{commit:!0}),onStepKeyDown:({event:z,direction:D})=>{if(!l){const U=SY.includes(z.key)||z.shiftKey&&kY.includes(z.key)?10:1,G=_.current,q=N[G],K=i*U*D;$(q+K,G,{commit:!0})}}}))})})})});PY.displayName=$p;var[TY,AY]=CY($p,{startEdge:"left",endEdge:"right",size:"width",direction:1}),C9e=x.forwardRef((e,t)=>{const b=e,{min:r,max:n,dir:a,inverted:i,onSlideStart:o,onSlideMove:l,onSlideEnd:c,onStepKeyDown:d}=b,u=me(b,["min","max","dir","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"]),[f,h]=x.useState(null),p=cr(t,N=>h(N)),g=x.useRef(void 0),v=Sh(a),y=v==="ltr",_=y&&!i||!y&&i;function w(N){const S=g.current||f.getBoundingClientRect(),k=[0,S.width],A=pR(k,_?[r,n]:[n,r]);return g.current=S,A(N-S.left)}return s.jsx(TY,{scope:e.__scopeSlider,startEdge:_?"left":"right",endEdge:_?"right":"left",direction:_?1:-1,size:"width",children:s.jsx(RY,H(M({dir:v,"data-orientation":"horizontal"},u),{ref:p,style:H(M({},u.style),{"--radix-slider-thumb-transform":"translateX(-50%)"}),onSlideStart:N=>{const S=w(N.clientX);o==null||o(S)},onSlideMove:N=>{const S=w(N.clientX);l==null||l(S)},onSlideEnd:()=>{g.current=void 0,c==null||c()},onStepKeyDown:N=>{const k=EY[_?"from-left":"from-right"].includes(N.key);d==null||d({event:N,direction:k?-1:1})}}))})}),P9e=x.forwardRef((e,t)=>{const v=e,{min:r,max:n,inverted:a,onSlideStart:i,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c}=v,d=me(v,["min","max","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"]),u=x.useRef(null),f=cr(t,u),h=x.useRef(void 0),p=!a;function g(y){const _=h.current||u.current.getBoundingClientRect(),w=[0,_.height],N=pR(w,p?[n,r]:[r,n]);return h.current=_,N(y-_.top)}return s.jsx(TY,{scope:e.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:s.jsx(RY,H(M({"data-orientation":"vertical"},d),{ref:f,style:H(M({},d.style),{"--radix-slider-thumb-transform":"translateY(50%)"}),onSlideStart:y=>{const _=g(y.clientY);i==null||i(_)},onSlideMove:y=>{const _=g(y.clientY);o==null||o(_)},onSlideEnd:()=>{h.current=void 0,l==null||l()},onStepKeyDown:y=>{const w=EY[p?"from-bottom":"from-top"].includes(y.key);c==null||c({event:y,direction:w?-1:1})}}))})}),RY=x.forwardRef((e,t)=>{const f=e,{__scopeSlider:r,onSlideStart:n,onSlideMove:a,onSlideEnd:i,onHomeKeyDown:o,onEndKeyDown:l,onStepKeyDown:c}=f,d=me(f,["__scopeSlider","onSlideStart","onSlideMove","onSlideEnd","onHomeKeyDown","onEndKeyDown","onStepKeyDown"]),u=Pj($p,r);return s.jsx(Ct.span,H(M({},d),{ref:t,onKeyDown:pt(e.onKeyDown,h=>{h.key==="Home"?(o(h),h.preventDefault()):h.key==="End"?(l(h),h.preventDefault()):SY.concat(kY).includes(h.key)&&(c(h),h.preventDefault())}),onPointerDown:pt(e.onPointerDown,h=>{const p=h.target;p.setPointerCapture(h.pointerId),h.preventDefault(),u.thumbs.has(p)?p.focus():n(h)}),onPointerMove:pt(e.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&a(h)}),onPointerUp:pt(e.onPointerUp,h=>{const p=h.target;p.hasPointerCapture(h.pointerId)&&(p.releasePointerCapture(h.pointerId),i(h))})}))}),OY="SliderTrack",MY=x.forwardRef((e,t)=>{const i=e,{__scopeSlider:r}=i,n=me(i,["__scopeSlider"]),a=Pj(OY,r);return s.jsx(Ct.span,H(M({"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation},n),{ref:t}))});MY.displayName=OY;var uC="SliderRange",DY=x.forwardRef((e,t)=>{const h=e,{__scopeSlider:r}=h,n=me(h,["__scopeSlider"]),a=Pj(uC,r),i=AY(uC,r),o=x.useRef(null),l=cr(t,o),c=a.values.length,d=a.values.map(p=>LY(p,a.min,a.max)),u=c>1?Math.min(...d):0,f=100-Math.max(...d);return s.jsx(Ct.span,H(M({"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0},n),{ref:l,style:H(M({},e.style),{[i.startEdge]:u+"%",[i.endEdge]:f+"%"})}))});DY.displayName=uC;var hC="SliderThumb",IY=x.forwardRef((e,t)=>{const r=S9e(e.__scopeSlider),[n,a]=x.useState(null),i=cr(t,l=>a(l)),o=x.useMemo(()=>n?r().findIndex(l=>l.ref.current===n):-1,[r,n]);return s.jsx(T9e,H(M({},e),{ref:i,index:o}))}),T9e=x.forwardRef((e,t)=>{const w=e,{__scopeSlider:r,index:n,name:a}=w,i=me(w,["__scopeSlider","index","name"]),o=Pj(hC,r),l=AY(hC,r),[c,d]=x.useState(null),u=cr(t,b=>d(b)),f=c?o.form||!!c.closest("form"):!0,h=zb(c),p=o.values[n],g=p===void 0?0:LY(p,o.min,o.max),v=O9e(n,o.values.length),y=h==null?void 0:h[l.size],_=y?D9e(y,g,l.direction):0;return x.useEffect(()=>{if(c)return o.thumbs.add(c),()=>{o.thumbs.delete(c)}},[c,o.thumbs]),s.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[l.startEdge]:`calc(${g}% + ${_}px)`},children:[s.jsx(dC.ItemSlot,{scope:e.__scopeSlider,children:s.jsx(Ct.span,H(M({role:"slider","aria-label":e["aria-label"]||v,"aria-valuemin":o.min,"aria-valuenow":p,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0},i),{ref:u,style:p===void 0?{display:"none"}:e.style,onFocus:pt(e.onFocus,()=>{o.valueIndexToChangeRef.current=n})}))}),f&&s.jsx($Y,{name:a!=null?a:o.name?o.name+(o.values.length>1?"[]":""):void 0,form:o.form,value:p},n)]})});IY.displayName=hC;var A9e="RadioBubbleInput",$Y=x.forwardRef((a,n)=>{var i=a,{__scopeSlider:e,value:t}=i,r=me(i,["__scopeSlider","value"]);const o=x.useRef(null),l=cr(o,n),c=k1(t);return x.useEffect(()=>{const d=o.current;if(!d)return;const u=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(u,"value").set;if(c!==t&&h){const p=new Event("input",{bubbles:!0});h.call(d,t),d.dispatchEvent(p)}},[c,t]),s.jsx(Ct.input,H(M({style:{display:"none"}},r),{ref:l,defaultValue:t}))});$Y.displayName=A9e;function R9e(e=[],t,r){const n=[...e];return n[r]=t,n.sort((a,i)=>a-i)}function LY(e,t,r){const i=100/(r-t)*(e-t);return $v(i,[0,100])}function O9e(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function M9e(e,t){if(e.length===1)return 0;const r=e.map(a=>Math.abs(a-t)),n=Math.min(...r);return r.indexOf(n)}function D9e(e,t,r){const n=e/2,i=pR([0,50],[0,n]);return(n-i(t)*r)*r}function I9e(e){return e.slice(0,-1).map((t,r)=>e[r+1]-t)}function $9e(e,t){if(t>0){const r=I9e(e);return Math.min(...r)>=t}return!0}function pR(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function L9e(e){return(String(e).split(".")[1]||"").length}function F9e(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}var FY=PY,z9e=MY,B9e=DY,U9e=IY;const zY=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsxs(FY,H(M({ref:r,className:ke("relative flex w-full touch-none select-none items-center",e)},t),{children:[s.jsx(z9e,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:s.jsx(B9e,{className:"absolute h-full bg-primary"})}),s.jsx(U9e,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}))});zY.displayName=FY.displayName;const LS=["all","users","artists","events","venues"],of=2,B0=()=>({users:[],artists:[],events:[],venues:[]}),q9e=[{key:"all",label:"All",icon:bQ,emptyMessage:"No results found."},{key:"users",label:"Users",icon:zr,emptyMessage:"No users match that search yet."},{key:"artists",label:"Artists",icon:$t,emptyMessage:"No artists found. Try a different spelling?"},{key:"events",label:"Events",icon:It,emptyMessage:"No upcoming events match that search."},{key:"venues",label:"Venues",icon:gr,emptyMessage:"No venues found. Try another location or name."}],V9e=({userId:e,allowedTabs:t,showMap:r=!0,layout:n="full",mode:a="full",showResults:i=!0,headerTitle:o,headerDescription:l,headerAccessory:c,showHelperText:d=!0,initialSearchQuery:u="",hideSearchInput:f=!1,onSearchStateChange:h,onNavigateToProfile:p,onNavigateToChat:g,onEventClick:v})=>{var Xe;const y=n==="compact",_=a==="embedded",w=i,b=x.useMemo(()=>{if(!t||t.length===0)return LS;const ge=t.filter(We=>LS.includes(We));return ge.length>0?ge:LS},[t]),[N,S]=x.useState(u),[k,P]=x.useState(""),[A,R]=x.useState(()=>{var ge;return(ge=b[0])!=null?ge:"all"}),[$,O]=x.useState(B0),[z,D]=x.useState({all:!1,users:!1,artists:!1,events:!1,venues:!1}),[B,F]=x.useState({}),[U,G]=x.useState({all:{page:1,hasMore:!1},users:{page:1,hasMore:!1},artists:{page:1,hasMore:!1},events:{page:1,hasMore:!1},venues:{page:1,hasMore:!1}}),q=20,[K,Z]=x.useState([]),[Y,Q]=x.useState([39.8283,-98.5795]),[X,ne]=x.useState(!1),re=x.useMemo(()=>q9e.filter(({key:ge})=>b.includes(ge)),[b]),ye=re.length,ee=ye>=4?"grid-cols-4":ye===3?"grid-cols-3":ye===2?"grid-cols-2":"grid-cols-1";x.useEffect(()=>{var ge;b.includes(A)||R((ge=b[0])!=null?ge:"users")},[b,A]),x.useEffect(()=>{u!==N&&S(u)},[u]),x.useEffect(()=>{const ge=setTimeout(()=>P(N.trim()),300);return()=>clearTimeout(ge)},[N]),x.useEffect(()=>{k.length>=of&&(G({all:{page:1,hasMore:!1},users:{page:1,hasMore:!1},artists:{page:1,hasMore:!1},events:{page:1,hasMore:!1},venues:{page:1,hasMore:!1}}),O(B0()))},[k]),x.useEffect(()=>{if(k.length<of){O(B0()),F({}),D({all:!1,users:!1,artists:!1,events:!1,venues:!1});return}let ge=!1;return E(void 0,null,function*(){var Ne;D({all:!0,users:!0,artists:!0,events:!0,venues:!0}),F({});const Ue=((Ne=U[A])==null?void 0:Ne.page)||1,at=q,mt=(Ue-1)*at,Ye=at*Ue,Ft=at*Ue,[_t,Lt,Oe,qe]=yield Promise.all([W9e(k,e,at,mt),Yy.searchArtists(k,Ye+1,!1),H9e(k,at,mt),U8.searchVenues(k,Ft+1,!1)]);if(!ge){const Fe=_t.length===at,ve=Lt.length>Ye,Me=Oe.length===at,ze=qe.length>Ft,ct=Ue===1?0:$.artists.length,Et=Ue===1?0:$.venues.length,gt=Lt.slice(ct,ct+at),St=qe.slice(Et,Et+at);O(dr=>({users:Ue===1?_t:[...dr.users,..._t],artists:Ue===1?Lt.slice(0,at):[...dr.artists,...gt],events:Ue===1?Oe:[...dr.events,...Oe],venues:Ue===1?qe.slice(0,at):[...dr.venues,...St]})),G(dr=>H(M({},dr),{all:{page:Ue,hasMore:Fe||ve||Me||ze},users:{page:Ue,hasMore:Fe},artists:{page:Ue,hasMore:ve},events:{page:Ue,hasMore:Me},venues:{page:Ue,hasMore:ze}})),D({all:!1,users:!1,artists:!1,events:!1,venues:!1})}}).catch(()=>{ge||(O(B0()),F({[A]:"Something went wrong. Please try again."}),D({all:!1,users:!1,artists:!1,events:!1,venues:!1}))}),()=>{ge=!0}},[k,e,A,(Xe=U[A])==null?void 0:Xe.page]),x.useEffect(()=>{r&&de()},[r]);const de=()=>E(void 0,null,function*(){try{ne(!0);const{data:ge,error:We}=yield T.from("events").select("venue_id, venue_name, venue_city, venue_state, latitude, longitude").not("latitude","is",null).not("longitude","is",null).limit(1e3);if(We){console.error("Error loading venues for map:",We);return}if(ge){const Ue=new Map;ge.forEach(Ye=>{var qe,Ne,Fe;const Ft=typeof Ye.latitude=="number"?Ye.latitude:Number(Ye.latitude),_t=typeof Ye.longitude=="number"?Ye.longitude:Number(Ye.longitude);if(!Number.isFinite(Ft)||!Number.isFinite(_t))return;const Lt=(Ne=(qe=Ye.venue_id)!=null?qe:Ye.venue_name)!=null?Ne:`venue-${Ft}-${_t}`,Oe=Ue.get(Lt);if(Oe){Oe.count+=1;return}Ue.set(Lt,{id:Lt,name:(Fe=Ye.venue_name)!=null?Fe:"Unknown Venue",city:Ye.venue_city,state:Ye.venue_state,latitude:Ft,longitude:_t,count:1})});const at=Array.from(Ue.values()).slice(0,500);Z(at);const mt=at[0];mt&&Q([mt.latitude,mt.longitude])}}finally{ne(!1)}}),xe=A==="all"?[...$.users.slice(0,3),...$.artists.slice(0,3),...$.events.slice(0,3),...$.venues.slice(0,3)]:$[A],ie=z[A],se=B[A],V=x.useMemo(()=>d?N?N.trim().length<of?"Type at least 2 characters to see results.":null:"Search for artists, events, venues, or people.":null,[N,d]);x.useEffect(()=>{h==null||h({query:N,debouncedQuery:k})},[N,k,h]);const ue=_?"w-full":`${y?"":"min-h-screen"} bg-background`,_e=_?`w-full ${y?"space-y-2":"space-y-4"}`:`max-w-5xl mx-auto px-4 ${y?"py-4 space-y-6":"py-8 space-y-8"}`,we=(o!=null?o:"Search").trim(),oe=we.length>0,Ae=(l!=null?l:"Find friends, discover artists, and track upcoming shows  all in one place.").trim(),Be=!y&&Ae.length>0;return s.jsx("div",{className:ue,children:s.jsxs("div",{className:_e,children:[s.jsxs("div",{className:_&&y?"space-y-1":`${y?"space-y-2":"space-y-4"}`,children:[oe&&s.jsx("h1",{className:`${y?"text-2xl font-semibold":"text-3xl font-bold"} text-foreground`,children:we}),Be&&s.jsx("p",{className:"text-muted-foreground",children:Ae}),!f&&s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Xi,{value:N,onChange:ge=>S(ge),placeholder:'Try "Radiohead"',widthVariant:"flex",id:"global-search"})}),c&&s.jsx("div",{className:"flex-shrink-0",children:c})]}),V&&s.jsx("p",{className:`${y?"text-xs":"text-sm"} text-muted-foreground`,"aria-live":"polite",children:V})]}),w&&r&&k.length<of&&s.jsx(He,{className:"border border-dashed border-muted-foreground/40 bg-muted/10",children:s.jsxs(et,{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Explore venues on the map"}),s.jsx(Ke,{variant:"secondary",className:"text-xs",children:X?"Loading":`${K.length.toLocaleString()} venues`})]}),X&&K.length===0?s.jsxs("div",{className:"flex h-[360px] items-center justify-center text-muted-foreground",children:[s.jsx(lr,{className:"h-5 w-5 animate-spin mr-2"}),"Loading venues"]}):K.length===0?s.jsx("div",{className:"flex h-[360px] items-center justify-center text-muted-foreground text-sm",children:"No venues with map data yet. Add some favorites or try searching above."}):s.jsx("div",{className:"h-[420px] rounded-2xl overflow-hidden",children:s.jsx(TU,{center:Y,zoom:4,events:K.map(ge=>({id:ge.id,jambase_event_id:ge.id,title:ge.name,artist_name:ge.city?`${ge.name}`:ge.name,artist_id:"",venue_name:ge.name,venue_id:ge.id,event_date:new Date().toISOString(),latitude:ge.latitude,longitude:ge.longitude})),onEventClick:()=>{}})})]})}),w&&k.length>=of&&re.length>0&&s.jsxs(Li,{value:A,onValueChange:ge=>R(ge),children:[s.jsx(yi,{className:`grid w-full md:w-auto md:inline-flex bg-muted/60 ${ee}`,children:re.map(({key:ge,label:We,icon:Ue})=>s.jsxs(Xr,{value:ge,className:"flex items-center gap-2",children:[s.jsx(Ue,{className:"h-4 w-4"}),s.jsx("span",{children:We})]},ge))}),re.map(({key:ge,emptyMessage:We})=>s.jsx(Jr,{value:ge,className:"mt-6 space-y-4",children:A===ge&&s.jsxs(s.Fragment,{children:[ie&&s.jsxs("div",{className:"flex items-center justify-center py-16 text-muted-foreground",children:[s.jsx(lr,{className:"h-6 w-6 animate-spin mr-2"}),"Searching ",ge,"..."]}),!ie&&se&&s.jsx(YT,{variant:"destructive",children:s.jsx(KT,{children:se})}),!ie&&!se&&k.length>=of&&(A==="all"?$.users.length===0&&$.artists.length===0&&$.events.length===0&&$.venues.length===0:xe.length===0)&&s.jsxs("div",{className:"flex flex-col gap-[6px] items-center justify-center p-12 text-center",children:[s.jsx(Uo,{className:"w-[60px] h-[60px]",style:{color:"var(--color-dark-grey, #5D646F)"}}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:We})]}),!ie&&(A==="all"?$.users.length>0||$.artists.length>0||$.events.length>0||$.venues.length>0:xe.length>0)&&s.jsxs("div",{className:"space-y-4",children:[ge==="all"&&s.jsx(X9e,{results:$,onNavigateToProfile:p,onEventClick:v,onTabChange:R}),ge==="users"&&s.jsxs(s.Fragment,{children:[s.jsx(G9e,{results:$.users,onNavigateToProfile:p}),U.users.hasMore&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(le,{variant:"outline",onClick:()=>G(Ue=>H(M({},Ue),{users:H(M({},Ue.users),{page:Ue.users.page+1})})),disabled:z.users,children:z.users?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Load More"})})]}),ge==="artists"&&s.jsxs(s.Fragment,{children:[s.jsx(Y9e,{results:$.artists}),U.artists.hasMore&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(le,{variant:"outline",onClick:()=>G(Ue=>H(M({},Ue),{artists:H(M({},Ue.artists),{page:Ue.artists.page+1})})),disabled:z.artists,children:z.artists?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Load More"})})]}),ge==="events"&&s.jsxs(s.Fragment,{children:[s.jsx(K9e,{results:$.events,onEventClick:v}),U.events.hasMore&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(le,{variant:"outline",onClick:()=>G(Ue=>H(M({},Ue),{events:H(M({},Ue.events),{page:Ue.events.page+1})})),disabled:z.events,children:z.events?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Load More"})})]}),ge==="venues"&&s.jsxs(s.Fragment,{children:[s.jsx(Z9e,{results:$.venues}),U.venues.hasMore&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(le,{variant:"outline",onClick:()=>G(Ue=>H(M({},Ue),{venues:H(M({},Ue.venues),{page:Ue.venues.page+1})})),disabled:z.venues,children:z.venues?s.jsxs(s.Fragment,{children:[s.jsx(lr,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Load More"})})]})]})]})},ge))]})]})})},W9e=(e,t,r=25,n=0)=>E(void 0,null,function*(){try{const a=e.trim(),o=a.split(/\s+/).length===1&&a.length>0?`${a}%`:`%${a}%`,{data:l,error:c}=yield T.from("users").select("user_id, name, avatar_url, bio, account_type").ilike("name",o).neq("user_id",t).order("name",{ascending:!0}).range(n,n+r-1);return c?(console.error("Error searching users:",c),[]):(l||[]).map(d=>({id:d.user_id,name:d.name,username:d.name,avatar_url:d.avatar_url,bio:d.bio,verified:!1,account_type:d.account_type}))}catch(a){return console.error("Error searching users:",a),[]}}),H9e=(e,t=25,r=0)=>E(void 0,null,function*(){try{const n=e.trim(),i=n.split(/\s+/).length===1&&n.length>0?`${n}%`:`%${n}%`,{data:o,error:l}=yield T.from("events").select(`
        id,
        title,
        event_date,
        images,
        event_media_url,
        media_urls,
        artist_id,
        venue_id,
        artists(id, name),
        venues(id, name)
      `).ilike("title",i).order("event_date",{ascending:!0}).range(r,r+t-1);return l?(console.error("Error searching events:",l),[]):(o||[]).map(c=>{var h,p,g;let d=null;if(c.event_media_url)d=c.event_media_url;else if(Array.isArray(c.media_urls)&&c.media_urls.length>0)d=c.media_urls[0];else if(Array.isArray(c.images)&&c.images.length>0){const v=c.images.find(y=>y==null?void 0:y.url);d=(h=v==null?void 0:v.url)!=null?h:null}const u=((p=c.artists)==null?void 0:p.name)||null,f=((g=c.venues)==null?void 0:g.name)||null;return{id:c.id,title:c.title,artistName:u,venueName:f,eventDate:c.event_date,imageUrl:d}})}catch(n){return console.error("Error searching events:",n),[]}}),G9e=({results:e,onNavigateToProfile:t})=>s.jsx(s.Fragment,{children:e.map(r=>{var n;return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>t==null?void 0:t(r.id),children:s.jsxs(et,{className:"p-4 flex items-center gap-4",children:[s.jsx(Vr,{className:"h-12 w-12",children:r.avatar_url?s.jsx(sn,{src:r.avatar_url,alt:r.name}):s.jsx(Wr,{children:(n=r.name)==null?void 0:n.slice(0,2).toUpperCase()})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-semibold truncate",children:r.name}),r.verified&&s.jsx(Ke,{variant:"outline",children:"Verified"})]}),r.username&&s.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:["@",r.username]}),r.bio&&s.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mt-1",children:r.bio})]})]})},r.id)})}),Y9e=({results:e})=>{const t=as();return console.log(" ArtistResults - Artists with images:",e.map(r=>({name:r.name,hasImage:!!r.image_url,imageUrl:r.image_url}))),s.jsx(s.Fragment,{children:e.map(r=>{const n=r.image_url&&r.image_url.trim().length>0;return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>t(`/artist/${encodeURIComponent(r.name)}`),children:s.jsxs(et,{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0 relative",children:n?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:r.image_url,alt:r.name,className:"h-12 w-12 rounded-full object-cover",onError:a=>{console.warn(` Failed to load image for artist "${r.name}": ${r.image_url}`);const i=a.currentTarget;i.style.display="none";const o=i.nextElementSibling;o&&o.classList.remove("hidden")},onLoad:()=>{console.log(` Loaded image for "${r.name}": ${r.image_url}`)}}),s.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center hidden",children:s.jsx($t,{className:"h-5 w-5 text-muted-foreground"})})]}):s.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center",children:s.jsx($t,{className:"h-5 w-5 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold truncate",children:r.name}),r.genres&&r.genres.length>0&&s.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:r.genres.slice(0,3).map(a=>s.jsx(Ke,{variant:"secondary",className:"text-xs",children:a},a))}),typeof r.num_upcoming_events=="number"&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[r.num_upcoming_events," upcoming ",r.num_upcoming_events===1?"show":"shows"]})]})]})},r.id)})})},K9e=({results:e,onEventClick:t})=>(as(),s.jsx(s.Fragment,{children:e.map(r=>{var a,i,o,l;const n=(()=>{if(!r.eventDate)return null;try{return Mt(ms(r.eventDate),"MMM d, yyyy  h:mm a")}catch(c){return r.eventDate}})();return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>{t?t(r):r.id&&window.dispatchEvent(new CustomEvent("open-event-details",{detail:{event:r,eventId:r.id}}))},children:s.jsxs(et,{className:"p-4 flex items-center gap-4",children:[s.jsxs("div",{className:"flex-shrink-0",children:[r.imageUrl?s.jsx("img",{src:r.imageUrl,alt:(i=(a=r.title)!=null?a:r.artistName)!=null?i:"Event",className:"h-16 w-16 rounded-lg object-cover",onError:c=>{var d;c.currentTarget.style.display="none",(d=c.currentTarget.nextElementSibling)==null||d.classList.remove("hidden")}}):null,s.jsx("div",{className:`h-16 w-16 rounded-lg bg-muted flex items-center justify-center ${r.imageUrl?"hidden":""}`,children:s.jsx(It,{className:"h-5 w-5 text-muted-foreground"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold truncate",children:(l=(o=r.title)!=null?o:r.artistName)!=null?l:"Untitled Event"}),s.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-0.5",children:[r.artistName&&s.jsx("p",{children:r.artistName}),r.venueName&&s.jsx("p",{children:r.venueName}),n&&s.jsx("p",{children:n})]})]})]})},r.id)})})),Z9e=({results:e})=>{const t=as();return s.jsx(s.Fragment,{children:e.map(r=>{var n,a;return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>t(`/venue/${encodeURIComponent(r.name)}`),children:s.jsxs(et,{className:"p-4 flex items-start gap-4",children:[s.jsxs("div",{className:"flex-shrink-0",children:[r.image_url?s.jsx("img",{src:r.image_url,alt:r.name,className:"h-12 w-12 rounded-lg object-cover",onError:i=>{var o;i.currentTarget.style.display="none",(o=i.currentTarget.nextElementSibling)==null||o.classList.remove("hidden")}}):null,s.jsx("div",{className:`h-12 w-12 rounded-lg bg-muted flex items-center justify-center ${r.image_url?"hidden":""}`,children:s.jsx(gr,{className:"h-5 w-5 text-muted-foreground"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold truncate",children:r.name}),(((n=r.address)==null?void 0:n.addressRegion)||((a=r.address)==null?void 0:a.addressCountry))&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.address.addressRegion||"",r.address.addressRegion&&r.address.addressCountry?", ":"",r.address.addressCountry||""]}),typeof r.num_upcoming_events=="number"&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[r.num_upcoming_events," upcoming ",r.num_upcoming_events===1?"show":"shows"]})]})]})},r.id)})})},X9e=({results:e,onNavigateToProfile:t,onEventClick:r,onTabChange:n})=>(e.users.length+e.artists.length+e.events.length+e.venues.length,s.jsxs("div",{className:"space-y-6",children:[s.jsx(He,{children:s.jsxs(et,{className:"p-4",children:[s.jsx("h3",{className:"font-semibold mb-4",children:"Search Results"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 p-3 rounded-lg transition-colors",onClick:()=>n("users"),children:[s.jsx("div",{className:"text-2xl font-bold",children:e.users.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Users"})]}),s.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 p-3 rounded-lg transition-colors",onClick:()=>n("artists"),children:[s.jsx("div",{className:"text-2xl font-bold",children:e.artists.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Artists"})]}),s.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 p-3 rounded-lg transition-colors",onClick:()=>n("events"),children:[s.jsx("div",{className:"text-2xl font-bold",children:e.events.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Events"})]}),s.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 p-3 rounded-lg transition-colors",onClick:()=>n("venues"),children:[s.jsx("div",{className:"text-2xl font-bold",children:e.venues.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Venues"})]})]})]})}),e.users.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold",children:"Users"}),s.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>n("users"),children:["View all (",e.users.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:e.users.slice(0,3).map(a=>{var i;return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>t==null?void 0:t(a.id),children:s.jsxs(et,{className:"p-3 flex items-center gap-3",children:[s.jsx(Vr,{className:"h-10 w-10",children:a.avatar_url?s.jsx(sn,{src:a.avatar_url,alt:a.name}):s.jsx(Wr,{children:(i=a.name)==null?void 0:i.slice(0,2).toUpperCase()})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-semibold text-sm truncate",children:a.name}),a.verified&&s.jsx(Ke,{variant:"outline",className:"text-xs",children:"Verified"})]}),a.bio&&s.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1 mt-0.5",children:a.bio})]})]})},a.id)})})]}),e.artists.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold",children:"Artists"}),s.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>n("artists"),children:["View all (",e.artists.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:e.artists.slice(0,3).map(a=>s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>n("artists"),children:s.jsxs(et,{className:"p-3 flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:a.image_url?s.jsx("img",{src:a.image_url,alt:a.name,className:"h-10 w-10 rounded-full object-cover"}):s.jsx("div",{className:"h-10 w-10 rounded-full bg-muted flex items-center justify-center",children:s.jsx($t,{className:"h-5 w-5 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h5",{className:"font-semibold text-sm truncate",children:a.name}),a.genres&&a.genres.length>0&&s.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:a.genres.slice(0,2).map(i=>s.jsx(Ke,{variant:"secondary",className:"text-xs",children:i},i))})]})]})},a.id))})]}),e.events.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold",children:"Events"}),s.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>n("events"),children:["View all (",e.events.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:e.events.slice(0,3).map(a=>{var o,l,c,d;const i=(()=>{if(!a.eventDate)return null;try{return Mt(ms(a.eventDate),"MMM d, yyyy")}catch(u){return a.eventDate}})();return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>r==null?void 0:r(a),children:s.jsxs(et,{className:"p-3 flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:a.imageUrl?s.jsx("img",{src:a.imageUrl,alt:(l=(o=a.title)!=null?o:a.artistName)!=null?l:"Event",className:"h-12 w-12 rounded-lg object-cover"}):s.jsx("div",{className:"h-12 w-12 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(It,{className:"h-5 w-5 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h5",{className:"font-semibold text-sm truncate",children:(d=(c=a.title)!=null?c:a.artistName)!=null?d:"Untitled Event"}),s.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5",children:[a.artistName&&s.jsx("p",{className:"truncate",children:a.artistName}),i&&s.jsx("p",{children:i})]})]})]})},a.id)})})]}),e.venues.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold",children:"Venues"}),s.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>n("venues"),children:["View all (",e.venues.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:e.venues.slice(0,3).map(a=>{var i,o;return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>n("venues"),children:s.jsxs(et,{className:"p-3 flex items-center gap-3",children:[s.jsxs("div",{className:"flex-shrink-0",children:[a.image_url?s.jsx("img",{src:a.image_url,alt:a.name,className:"h-10 w-10 rounded-lg object-cover",onError:l=>{var c;l.currentTarget.style.display="none",(c=l.currentTarget.nextElementSibling)==null||c.classList.remove("hidden")}}):null,s.jsx("div",{className:`h-10 w-10 rounded-lg bg-muted flex items-center justify-center ${a.image_url?"hidden":""}`,children:s.jsx(gr,{className:"h-4 w-4 text-muted-foreground"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h5",{className:"font-semibold text-sm truncate",children:a.name}),(((i=a.address)==null?void 0:i.addressRegion)||((o=a.address)==null?void 0:o.addressCountry))&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[a.address.addressRegion||"",a.address.addressRegion&&a.address.addressCountry?", ":"",a.address.addressCountry||""]})]})]})},a.id)})})]})]})),J9e=a1,Q9e=i1,BY=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(gp,H(M({className:ke("fixed inset-0 z-[9999] bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e)},t),{ref:r}))});BY.displayName=gp.displayName;const e8e=lp("fixed z-[9999] gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),UY=x.forwardRef((i,a)=>{var o=i,{side:e="right",className:t,children:r}=o,n=me(o,["side","className","children"]);return s.jsxs(Q9e,{children:[s.jsx(BY,{}),s.jsxs(vp,H(M({ref:a,className:ke(e8e({side:e}),t)},n),{children:[r,s.jsxs(o1,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[s.jsx(Gr,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]}))]})});UY.displayName=vp.displayName;const qY=r=>{var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("flex flex-col space-y-2 text-center sm:text-left",e)},t))};qY.displayName="SheetHeader";const VY=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(Wy,M({ref:r,className:ke("text-lg font-semibold text-foreground",e)},t))});VY.displayName=Wy.displayName;const WY=x.forwardRef((n,r)=>{var a=n,{className:e}=a,t=me(a,["className"]);return s.jsx(Hy,M({ref:r,className:ke("text-sm text-muted-foreground",e)},t))});WY.displayName=Hy.displayName;const U0=({title:e,description:t,icon:r,onClick:n,className:a})=>s.jsx(He,{className:ke("cursor-pointer transition-all hover:shadow-md hover:scale-[1.02]",a),onClick:n,children:s.jsx(et,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--brand-pink-050)"},children:s.jsx(r,{name:icon,size:16,color:"var(--brand-pink-500)"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold text-sm mb-1",children:e}),s.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:t})]})]})})}),q0=[{id:"similar-artists",title:"Similar to Artists You Love",description:"Events by artists similar to ones you've seen",icon:"music",category:"taste"},{id:"last-5-attended",title:"Based on Your Last 5 Shows",description:"Recommendations from your recent attendance",icon:"calendar",category:"taste"},{id:"similar-taste-users",title:"Highly Rated by Similar Tastes",description:"Events loved by users with similar music taste",icon:"twoUsers",category:"taste"},{id:"this-weekend",title:"This Weekend",description:"Shows happening this Saturday and Sunday",icon:"calendar",category:"context"},{id:"under-25",title:"Under $25",description:"Affordable shows under $25",icon:"dollar",category:"context"},{id:"small-venues",title:"Small Venues",description:"Intimate shows at smaller venues",icon:"building",category:"context"},{id:"late-shows",title:"Late Shows",description:"Shows starting after 10 PM",icon:"clock",category:"context"},{id:"up-and-coming",title:"Up-and-Coming Artists",description:"Artists with fewer than 10 reviews",icon:"trendingUp",category:"discovery"},{id:"less-than-10-reviews",title:"Events with <10 Reviews",description:"Be among the first to review these shows",icon:"mediumShootingStar",category:"discovery"},{id:"highest-rated-month",title:"Highest-Rated This Month",description:"Events rated 4.5+ stars this month",icon:"star",category:"opinion"},{id:"best-venues",title:"Best Venues",description:"Events at venues rated 4+ stars",icon:"ribbonAward",category:"opinion"},{id:"best-value",title:"Best Value",description:"Events rated highly for value-for-price",icon:"target",category:"opinion"}],HY=({isOpen:e,onClose:t,onSelectVibe:r,isMobile:n=!1})=>{const a=u=>{r(u),t()},i=q0.filter(u=>u.category==="taste"),o=q0.filter(u=>u.category==="context"),l=q0.filter(u=>u.category==="discovery"),c=q0.filter(u=>u.category==="opinion"),d=s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold mb-2",children:"Start with a Vibe"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose a curated entry point to discover events through different perspectives"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:"By Taste"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:i.map(u=>s.jsx(U0,{title:u.title,description:u.description,icon:u.icon,onClick:()=>a(u.id)},u.id))})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:"By Context"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:o.map(u=>s.jsx(U0,{title:u.title,description:u.description,icon:u.icon,onClick:()=>a(u.id)},u.id))})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:"By Discovery Energy"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:l.map(u=>s.jsx(U0,{title:u.title,description:u.description,icon:u.icon,onClick:()=>a(u.id)},u.id))})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:"By Opinion"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:c.map(u=>s.jsx(U0,{title:u.title,description:u.description,icon:u.icon,onClick:()=>a(u.id)},u.id))})]})]});return n?s.jsx(J9e,{open:e,onOpenChange:t,children:s.jsxs(UY,{side:"bottom",className:"h-[90vh] overflow-y-auto",children:[s.jsxs(qY,{children:[s.jsx(VY,{children:"Browse by Vibe"}),s.jsx(WY,{children:"Choose a curated entry point to discover events"})]}),s.jsx("div",{className:"mt-6",children:d})]})}):s.jsx(pn,{open:e,onOpenChange:t,children:s.jsxs(dn,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Vn,{children:[s.jsx(bn,{children:"Browse by Vibe"}),s.jsx(os,{children:"Choose a curated entry point to discover events through different perspectives"})]}),s.jsx("div",{className:"mt-4",children:d})]})})};class ei{static applyFilters(t,r){var n,a,i,o;if(!r)return t;if((n=r.dateRange)!=null&&n.from&&(t=t.gte("event_date",r.dateRange.from.toISOString())),(a=r.dateRange)!=null&&a.to&&(t=t.lte("event_date",r.dateRange.to.toISOString())),!((i=r.dateRange)!=null&&i.from)&&!((o=r.dateRange)!=null&&o.to)&&(t=t.gte("event_date",new Date().toISOString())),r.genres&&r.genres.length>0&&(t=t.overlaps("genres",r.genres)),r.cities&&r.cities.length>0){const l=r.cities.map(c=>`venue_city.ilike.%${c}%`).join(",");t=t.or(l)}else if(r.latitude&&r.longitude&&r.radiusMiles){const l=r.radiusMiles/69,c=r.radiusMiles/(69*Math.cos(r.latitude*Math.PI/180));t=t.not("latitude","is",null).not("longitude","is",null).gte("latitude",r.latitude-l).lte("latitude",r.latitude+l).gte("longitude",r.longitude-c).lte("longitude",r.longitude+c)}return t}static getSimilarArtists(t,r=20,n){return E(this,null,function*(){try{console.log(" [VIBE] getSimilarArtists - Starting");const a=new Date;a.setDate(a.getDate()-90),console.log(` [VIBE] getSimilarArtists - Using recency filter: last 90 days (since ${a.toISOString()})`);const{data:i}=yield T.from("reviews").select("events:event_id(artist_name)").eq("user_id",t).eq("is_draft",!1).not("events.artist_name","is",null).gte("created_at",a.toISOString()).order("created_at",{ascending:!1}).limit(50);console.log(` [VIBE] getSimilarArtists - Fetched ${(i==null?void 0:i.length)||0} reviews from last 90 days`);const o=new Set((i||[]).map(d=>{var u;return(u=d.events)==null?void 0:u.artist_name}).filter(Boolean));if(console.log(` [VIBE] getSimilarArtists - Found ${o.size} unique artists from reviews`),o.size===0)return console.log(" [VIBE] getSimilarArtists - No artists found, returning empty"),{events:[],title:"Similar to Artists You Love",description:"We need more data about your music taste to show similar artists.",totalCount:0};let l=T.from("events").select("*").in("artist_name",Array.from(o));l=ei.applyFilters(l,n);const{data:c}=yield l.order("event_date",{ascending:!0}).limit(r);return console.log(` [VIBE] getSimilarArtists - Found ${(c==null?void 0:c.length)||0} events, returning results`),{events:c||[],title:"Similar to Artists You Love",description:"Events by artists you've seen live",totalCount:(c==null?void 0:c.length)||0}}catch(a){return console.error("Error getting similar artists:",a),{events:[],title:"Similar to Artists You Love",description:"Unable to load similar artists.",totalCount:0}}})}static getLast5Attended(t,r=20,n){return E(this,null,function*(){try{console.log(" [VIBE] getLast5Attended - Starting");const{data:a}=yield T.from("reviews").select("events:event_id(artist_name, genres, venue_name)").eq("user_id",t).eq("is_draft",!1).eq("was_there",!0).order("created_at",{ascending:!1}).limit(5);if(console.log(` [VIBE] getLast5Attended - Fetched ${(a==null?void 0:a.length)||0} recent attended events`),!a||a.length===0)return{events:[],title:"Based on Your Last 5 Shows",description:"Attend and review events to get personalized recommendations.",totalCount:0};const i=new Set;a.forEach(c=>{var d;(d=c.events)!=null&&d.genres&&c.events.genres.forEach(u=>i.add(u))});let o=T.from("events").select("*").overlaps("genres",Array.from(i));o=ei.applyFilters(o,n);const{data:l}=yield o.order("event_date",{ascending:!0}).limit(r);return{events:l||[],title:"Based on Your Last 5 Shows",description:"Events similar to shows you've recently attended",totalCount:(l==null?void 0:l.length)||0}}catch(a){return console.error("Error getting last 5 attended:",a),{events:[],title:"Based on Your Last 5 Shows",description:"Unable to load recommendations.",totalCount:0}}})}static getSimilarTasteUsers(t,r=20,n){return E(this,null,function*(){try{console.log(" [VIBE] getSimilarTasteUsers - Starting");const a=new Date;a.setDate(a.getDate()-90),console.log(` [VIBE] getSimilarTasteUsers - Using recency filter: last 90 days (since ${a.toISOString()})`);const{data:i}=yield T.from("reviews").select("events:event_id(genres)").eq("user_id",t).eq("is_draft",!1).not("events.genres","is",null).gte("created_at",a.toISOString()).order("created_at",{ascending:!1}).limit(50);console.log(` [VIBE] getSimilarTasteUsers - Fetched ${(i==null?void 0:i.length)||0} user reviews from last 90 days`);const o=new Set;if((i||[]).forEach(h=>{var p;(p=h.events)!=null&&p.genres&&h.events.genres.forEach(g=>o.add(g))}),console.log(` [VIBE] getSimilarTasteUsers - Found ${o.size} unique genres from user reviews`),o.size===0)return console.log(" [VIBE] getSimilarTasteUsers - No genres found, returning empty"),{events:[],title:"Highly Rated by Similar Tastes",description:"We need more data about your music taste.",totalCount:0};const{data:l}=yield T.from("reviews").select("event_id").gte("rating",4).eq("is_draft",!1).gte("created_at",a.toISOString()).order("created_at",{ascending:!1}).limit(500);if(console.log(` [VIBE] getSimilarTasteUsers - Fetched ${(l==null?void 0:l.length)||0} high-rated reviews (4+) from last 90 days`),!l||l.length===0)return console.log(" [VIBE] getSimilarTasteUsers - No high-rated reviews found, returning empty"),{events:[],title:"Highly Rated by Similar Tastes",description:"No highly rated events found",totalCount:0};const c=[...new Set(l.map(h=>h.event_id))];console.log(` [VIBE] getSimilarTasteUsers - Found ${c.length} unique high-rated events`);let d=T.from("events").select("*").in("id",c).overlaps("genres",Array.from(o));d=ei.applyFilters(d,n);const{data:u}=yield d.order("event_date",{ascending:!0}).limit(r);console.log(` [VIBE] getSimilarTasteUsers - Found ${(u==null?void 0:u.length)||0} events matching genres`);const f=new Map;return(u||[]).forEach(h=>{f.has(h.id)||f.set(h.id,h)}),console.log(` [VIBE] getSimilarTasteUsers - Returning ${f.size} deduplicated events`),{events:Array.from(f.values()),title:"Highly Rated by Similar Tastes",description:"Events rated 4+ stars by users who like similar genres",totalCount:f.size}}catch(a){return console.error("Error getting similar taste users:",a),{events:[],title:"Highly Rated by Similar Tastes",description:"Unable to load recommendations.",totalCount:0}}})}static getThisWeekend(t=20,r){return E(this,null,function*(){try{const n=new Date,a=new Date(n);a.setDate(n.getDate()+(6-n.getDay())%7),a.setHours(0,0,0,0);const i=new Date(a);i.setDate(a.getDate()+1),i.setHours(23,59,59,999);let o=T.from("events").select("*").gte("event_date",a.toISOString()).lte("event_date",i.toISOString());const l=r&&H(M({},r),{dateRange:{from:a,to:i}});o=ei.applyFilters(o,l);const{data:c}=yield o.order("event_date",{ascending:!0}).limit(t);return{events:c||[],title:"This Weekend",description:`Events happening ${a.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${i.toLocaleDateString("en-US",{month:"short",day:"numeric"})}`,totalCount:(c==null?void 0:c.length)||0}}catch(n){return console.error("Error getting weekend events:",n),{events:[],title:"This Weekend",description:"Unable to load weekend events.",totalCount:0}}})}static getUnder25(t=20,r){return E(this,null,function*(){try{let n=T.from("events").select("*").or("price_min.lte.25,price_max.lte.25");n=ei.applyFilters(n,r);const{data:a}=yield n.order("event_date",{ascending:!0}).limit(t);return{events:a||[],title:"Under $25",description:"Affordable shows under $25",totalCount:(a==null?void 0:a.length)||0}}catch(n){return console.error("Error getting under $25 events:",n),{events:[],title:"Under $25",description:"Unable to load affordable events.",totalCount:0}}})}static getSmallVenues(t=20,r){return E(this,null,function*(){try{const{data:n}=yield T.from("venues").select("id").not("maximum_attendee_capacity","is",null).lt("maximum_attendee_capacity",500).limit(100);if(!n||n.length===0)return{events:[],title:"Small Venues",description:"Intimate shows at smaller venues",totalCount:0};const a=n.map(l=>l.id);let i=T.from("events").select("*").in("venue_jambase_id",a);i=ei.applyFilters(i,r);const{data:o}=yield i.order("event_date",{ascending:!0}).limit(t);return{events:o||[],title:"Small Venues",description:"Intimate shows at smaller venues (< 500 capacity)",totalCount:(o==null?void 0:o.length)||0}}catch(n){return console.error("Error getting small venues:",n),{events:[],title:"Small Venues",description:"Unable to load small venue events.",totalCount:0}}})}static getLateShows(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getLateShows - Starting");const n=new Date;new Date(n).setHours(22,0,0,0);let i=T.from("events").select("*").not("doors_time","is",null);i=ei.applyFilters(i,r);const{data:o}=yield i.order("event_date",{ascending:!0}).limit(t*3);console.log(` [VIBE] getLateShows - Fetched ${(o==null?void 0:o.length)||0} events with doors_time`);const l=(o||[]).filter(c=>{if(!c.doors_time)return!1;const d=new Date(c.doors_time),u=d.getHours()>=22;return u&&console.log(` [VIBE] getLateShows - Found late show: ${c.title} at ${d.toLocaleTimeString()}`),u}).slice(0,t);return console.log(` [VIBE] getLateShows - Filtered to ${l.length} late shows (doors_time >= 22:00)`),{events:l,title:"Late Shows",description:"Shows starting after 10 PM",totalCount:l.length}}catch(n){return console.error("Error getting late shows:",n),{events:[],title:"Late Shows",description:"Unable to load late shows.",totalCount:0}}})}static getUpAndComing(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getUpAndComing - Starting");const n=new Date;n.setDate(n.getDate()-180),console.log(` [VIBE] getUpAndComing - Using recency filter: last 180 days (since ${n.toISOString()})`);const{data:a}=yield T.from("reviews").select("events:event_id(artist_name)").eq("is_draft",!1).not("events.artist_name","is",null).gte("created_at",n.toISOString()).order("created_at",{ascending:!1}).limit(2e3);console.log(` [VIBE] getUpAndComing - Fetched ${(a==null?void 0:a.length)||0} reviews from last 180 days`);const i=new Map;(a||[]).forEach(d=>{var f;const u=(f=d.events)==null?void 0:f.artist_name;u&&i.set(u,(i.get(u)||0)+1)}),console.log(` [VIBE] getUpAndComing - Found ${i.size} unique artists with reviews`);const o=Array.from(i.entries()).filter(([d,u])=>u<10).map(([d])=>d);if(console.log(` [VIBE] getUpAndComing - Found ${o.length} artists with <10 reviews`),o.length===0)return{events:[],title:"Up-and-Coming Artists",description:"Artists with fewer than 10 reviews",totalCount:0};let l=T.from("events").select("*").in("artist_name",o.slice(0,50));l=ei.applyFilters(l,r);const{data:c}=yield l.order("event_date",{ascending:!0}).limit(t);return console.log(` [VIBE] getUpAndComing - Found ${(c==null?void 0:c.length)||0} events for up-and-coming artists`),{events:c||[],title:"Up-and-Coming Artists",description:"Artists with fewer than 10 reviews - discover them early",totalCount:(c==null?void 0:c.length)||0}}catch(n){return console.error("Error getting up-and-coming artists:",n),{events:[],title:"Up-and-Coming Artists",description:"Unable to load up-and-coming artists.",totalCount:0}}})}static getLessThan10Reviews(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getLessThan10Reviews - Starting");const n=new Date;n.setDate(n.getDate()-180),console.log(` [VIBE] getLessThan10Reviews - Using recency filter: last 180 days (since ${n.toISOString()})`);const{data:a}=yield T.from("reviews").select("event_id").eq("is_draft",!1).gte("created_at",n.toISOString()).order("created_at",{ascending:!1}).limit(2e3);console.log(` [VIBE] getLessThan10Reviews - Fetched ${(a==null?void 0:a.length)||0} reviews from last 180 days`);const i=new Map;(a||[]).forEach(d=>{i.set(d.event_id,(i.get(d.event_id)||0)+1)}),console.log(` [VIBE] getLessThan10Reviews - Found ${i.size} unique events with reviews`);let o=T.from("events").select("*");o=ei.applyFilters(o,r);const{data:l}=yield o.order("event_date",{ascending:!0}).limit(t*2),c=(l||[]).filter(d=>(i.get(d.id)||0)<10).slice(0,t);return console.log(` [VIBE] getLessThan10Reviews - Filtered to ${c.length} events with <10 reviews`),{events:c,title:"Events with <10 Reviews",description:"Be among the first to review these shows",totalCount:c.length}}catch(n){return console.error("Error getting events with <10 reviews:",n),{events:[],title:"Events with <10 Reviews",description:"Unable to load events.",totalCount:0}}})}static getHighestRatedMonth(t=20,r){return E(this,null,function*(){var n,a;try{console.log(" [VIBE] getHighestRatedMonth - Starting");const i=new Date,o=new Date(i.getFullYear(),i.getMonth(),1),l=new Date(i.getFullYear(),i.getMonth()+1,0,23,59,59);console.log(` [VIBE] getHighestRatedMonth - Filtering reviews from ${o.toISOString()} to ${l.toISOString()}`);const{data:c}=yield T.from("reviews").select("event_id").gte("rating",4.5).eq("is_draft",!1).gte("created_at",o.toISOString()).lte("created_at",l.toISOString()).order("created_at",{ascending:!1}).limit(500);if(console.log(` [VIBE] getHighestRatedMonth - Fetched ${(c==null?void 0:c.length)||0} reviews with rating >= 4.5 this month`),!c||c.length===0)return{events:[],title:"Highest-Rated This Month",description:"No highly rated events this month",totalCount:0};const d=[...new Set(c.map(g=>g.event_id))];console.log(` [VIBE] getHighestRatedMonth - Found ${d.length} unique events with rating >= 4.5 this month`);let u=T.from("events").select("*").gte("event_date",o.toISOString()).lte("event_date",l.toISOString()).in("id",d);const f=r?H(M({},r),{dateRange:{from:(n=r.dateRange)!=null&&n.from&&r.dateRange.from>o?r.dateRange.from:o,to:(a=r.dateRange)!=null&&a.to&&r.dateRange.to<l?r.dateRange.to:l}}):{dateRange:{from:o,to:l}};u=ei.applyFilters(u,f);const{data:h}=yield u.order("event_date",{ascending:!0}).limit(t);console.log(` [VIBE] getHighestRatedMonth - Found ${(h==null?void 0:h.length)||0} events matching filters`);const p=new Map;return(h||[]).forEach(g=>{p.has(g.id)||p.set(g.id,g)}),console.log(` [VIBE] getHighestRatedMonth - Returning ${p.size} deduplicated events`),{events:Array.from(p.values()),title:"Highest-Rated This Month",description:"Events rated 4.5+ stars this month",totalCount:p.size}}catch(i){return console.error("Error getting highest-rated month:",i),{events:[],title:"Highest-Rated This Month",description:"Unable to load highest-rated events.",totalCount:0}}})}static getBestVenues(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getBestVenues - Starting");const n=new Date;n.setDate(n.getDate()-180),console.log(` [VIBE] getBestVenues - Using recency filter: last 180 days (since ${n.toISOString()})`);const{data:a}=yield T.from("reviews").select("event_id, venue_rating_new, venue_rating").eq("is_draft",!1).gte("created_at",n.toISOString()).order("created_at",{ascending:!1}).limit(1e3);if(console.log(` [VIBE] getBestVenues - Fetched ${(a==null?void 0:a.length)||0} reviews from last 180 days`),!a||a.length===0)return{events:[],title:"Best Venues",description:"No highly rated venues found",totalCount:0};const i=a.filter(p=>{const g=p.venue_rating_new||p.venue_rating;return g&&g>=4});if(console.log(` [VIBE] getBestVenues - Found ${i.length} reviews with rating >= 4`),i.length===0)return console.log(" [VIBE] getBestVenues - No high-rated reviews found, returning empty"),{events:[],title:"Best Venues",description:"No highly rated venues found",totalCount:0};const o=[...new Set(i.map(p=>p.event_id))];console.log(` [VIBE] getBestVenues - Found ${o.length} unique events with high venue ratings`);const{data:l}=yield T.from("events").select("id, venue_jambase_id, venue_name").in("id",o);console.log(` [VIBE] getBestVenues - Fetched ${(l==null?void 0:l.length)||0} event details`);const c=new Map,d=new Map((l||[]).map(p=>[p.id,p]));i.forEach(p=>{const g=d.get(p.event_id);if(!g)return;const v=g.venue_jambase_id,y=g.venue_name,_=p.venue_rating_new||p.venue_rating;if(v&&y&&_){const w=c.get(v)||{name:y,avgRating:0,count:0};w.avgRating=(w.avgRating*w.count+_)/(w.count+1),w.count+=1,c.set(v,w)}});const u=Array.from(c.entries()).sort(([p,g],[v,y])=>y.avgRating-g.avgRating).slice(0,20).map(([p])=>p);if(u.length===0)return{events:[],title:"Best Venues",description:"No highly rated venues found",totalCount:0};let f=T.from("events").select("*").in("venue_jambase_id",u);f=ei.applyFilters(f,r);const{data:h}=yield f.order("event_date",{ascending:!0}).limit(t);return console.log(` [VIBE] getBestVenues - Found ${(h==null?void 0:h.length)||0} events at best venues`),{events:h||[],title:"Best Venues",description:"Events at venues rated 4+ stars",totalCount:(h==null?void 0:h.length)||0}}catch(n){return console.error("Error getting best venues:",n),{events:[],title:"Best Venues",description:"Unable to load best venue events.",totalCount:0}}})}static getBestValue(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getBestValue - Starting");const n=new Date;n.setDate(n.getDate()-90),console.log(` [VIBE] getBestValue - Using recency filter: last 90 days (since ${n.toISOString()})`);const{data:a}=yield T.from("reviews").select("event_id").gte("value_rating",4).eq("is_draft",!1).not("value_rating","is",null).gte("created_at",n.toISOString()).order("created_at",{ascending:!1}).limit(500);if(console.log(` [VIBE] getBestValue - Fetched ${(a==null?void 0:a.length)||0} reviews with value_rating >= 4 from last 90 days`),!a||a.length===0)return console.log(" [VIBE] getBestValue - No high-value reviews found, returning empty"),{events:[],title:"Best Value",description:"No high value events found",totalCount:0};const i=[...new Set(a.map(d=>d.event_id))];console.log(` [VIBE] getBestValue - Found ${i.length} unique events with high value ratings`);let o=T.from("events").select("*").in("id",i);o=ei.applyFilters(o,r);const{data:l}=yield o.order("event_date",{ascending:!0}).limit(t);console.log(` [VIBE] getBestValue - Found ${(l==null?void 0:l.length)||0} events matching filters`);const c=new Map;return(l||[]).forEach(d=>{c.has(d.id)||c.set(d.id,d)}),console.log(` [VIBE] getBestValue - Returning ${c.size} deduplicated events`),{events:Array.from(c.values()),title:"Best Value",description:"Events rated highly for value-for-price",totalCount:c.size}}catch(n){return console.error("Error getting best value:",n),{events:[],title:"Best Value",description:"Unable to load best value events.",totalCount:0}}})}static executeVibe(t,r,n=20,a){return E(this,null,function*(){switch(console.log(` [VIBE] executeVibe - Executing vibe: ${t} for user: ${r}, limit: ${n}`),a&&console.log(" [VIBE] executeVibe - Filters:",JSON.stringify(a,null,2)),t){case"similar-artists":return this.getSimilarArtists(r,n,a);case"last-5-attended":return this.getLast5Attended(r,n,a);case"similar-taste-users":return this.getSimilarTasteUsers(r,n,a);case"this-weekend":return this.getThisWeekend(n,a);case"under-25":return this.getUnder25(n,a);case"small-venues":return this.getSmallVenues(n,a);case"late-shows":return this.getLateShows(n,a);case"up-and-coming":return this.getUpAndComing(n,a);case"less-than-10-reviews":return this.getLessThan10Reviews(n,a);case"highest-rated-month":return this.getHighestRatedMonth(n,a);case"best-venues":return this.getBestVenues(n,a);case"best-value":return this.getBestValue(n,a);default:return{events:[],title:"Unknown Vibe",description:"Unknown vibe type",totalCount:0}}})}}const gR=({event:e,onClick:t,socialProofCount:r,reasonLabel:n,className:a})=>{var c,d,u;const i=f=>{try{return Mt(new Date(f),"MMM d")}catch(h){return""}},o=((d=(c=e.images)==null?void 0:c[0])==null?void 0:d.url)||e.event_media_url||((u=e.media_urls)==null?void 0:u[0]),l=o?Pl(o):null;return s.jsxs(He,{className:ke("w-[280px] cursor-pointer transition-all hover:shadow-lg overflow-hidden",a),onClick:t,children:[l&&s.jsx("div",{className:"w-full h-32 bg-gray-200 overflow-hidden",children:s.jsx("img",{src:l,alt:e.title||e.artist_name||"Event",className:"w-full h-full object-cover"})}),s.jsxs(et,{className:"p-3",children:[s.jsx("h4",{className:"font-semibold text-sm mb-1 line-clamp-1",children:e.title||e.artist_name||"Event"}),e.artist_name&&s.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:e.artist_name}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-2 flex-wrap",children:[e.event_date&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Se,{name:"calendar",size:16}),s.jsx("span",{children:i(e.event_date)})]}),(e.venue_city||e.venue_state)&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Se,{name:"location",size:16}),s.jsx("span",{className:"line-clamp-1",children:e.venue_city?e.venue_state?`${e.venue_city}, ${e.venue_state}`:e.venue_city:e.venue_state||""})]}),(e.price_min||e.price_max||e.price_range)&&s.jsx("div",{className:"flex items-center gap-1 text-xs font-medium text-foreground",children:e.price_range||(e.price_min&&e.price_max?`$${e.price_min}${e.price_min!==e.price_max?`-$${e.price_max}`:""}`:e.price_min?`$${e.price_min}+`:e.price_max?`Up to $${e.price_max}`:"")})]}),(r!==void 0||n)&&s.jsxs("div",{className:"flex items-center gap-2",children:[r!==void 0&&r>0&&s.jsxs(Ke,{variant:"secondary",className:"text-xs",children:[r," ",r===1?"person":"people"]}),n&&s.jsx("span",{className:"text-xs text-muted-foreground",children:n})]})]})]})},t8e=["Rock","Pop","Hip-Hop","Electronic","Jazz","Classical","Country","R&B","Reggae","Folk","Blues","Alternative","Indie","Punk","Metal","Funk","Soul","Gospel","Latin","World"],r8e=({vibeType:e,userId:t,filters:r,onBack:n,onNavigateToProfile:a,onNavigateToChat:i})=>{var se,V,ue,_e,ae,we,oe;const[o,l]=x.useState(null),[c,d]=x.useState(!0),[u,f]=x.useState(1),[h,p]=x.useState(null),[g,v]=x.useState(!1),[y,_]=x.useState(!1),[w,b]=x.useState(new Set),[N,S]=x.useState(r||{}),[k,P]=x.useState(!1),[A,R]=x.useState(!1),[$,O]=x.useState(!1),[z,D]=x.useState([]),[B,F]=x.useState([]),[U,G]=x.useState(!1),q=20;x.useEffect(()=>{$&&K()},[$]),x.useEffect(()=>{ye(),re()},[e,t,N]);const K=()=>E(void 0,null,function*(){G(!0);try{const{data:ce}=yield T.from("events").select("venue_city, venue_state").gte("event_date",new Date().toISOString()).not("venue_city","is",null).limit(1e3),Ae=new Map;(ce||[]).forEach(Be=>{if(Be.venue_city){const Xe=`${Be.venue_city}, ${Be.venue_state||""}`.trim(),ge=Ae.get(Xe);ge?ge.eventCount+=1:Ae.set(Xe,{city:Be.venue_city,state:Be.venue_state||"",eventCount:1})}}),F(Array.from(Ae.values()).sort((Be,Xe)=>Xe.eventCount-Be.eventCount).slice(0,50))}catch(ce){console.error("Error loading cities:",ce)}finally{G(!1)}}),Z=ce=>{var Be;const Ae=(Be=N.genres)!=null&&Be.includes(ce)?N.genres.filter(Xe=>Xe!==ce):[...N.genres||[],ce];S(H(M({},N),{genres:Ae}))},Y=()=>{S(H(M({},N),{cities:z})),O(!1)},Q=ce=>{D(Ae=>Ae.includes(ce)?Ae.filter(Be=>Be!==ce):[...Ae,ce])},X=()=>{S({dateRange:void 0,genres:[],cities:[],radiusMiles:r==null?void 0:r.radiusMiles,latitude:r==null?void 0:r.latitude,longitude:r==null?void 0:r.longitude}),D([])},ne=!!((se=N.dateRange)!=null&&se.from||(V=N.dateRange)!=null&&V.to||N.genres&&N.genres.length>0||N.cities&&N.cities.length>0),re=()=>E(void 0,null,function*(){try{const ce=yield Qr.getUserInterestedEventIdSet(t);b(ce)}catch(ce){console.error("Error loading interested events:",ce)}}),ye=()=>E(void 0,null,function*(){d(!0);try{const ce=yield ei.executeVibe(e,t,q*3,N);l(ce),f(1)}catch(ce){console.error("Error loading vibe results:",ce),l({events:[],title:"Error",description:"Unable to load results",totalCount:0})}finally{d(!1)}}),ee=ce=>E(void 0,null,function*(){try{const{data:Ae}=yield T.from("events").select("*").eq("id",ce.id).single();if(Ae){p(Ae);const Be=yield Qr.isUserInterested(t,Ae.id);_(Be),v(!0)}else p(ce),_(w.has(ce.id||"")),v(!0)}catch(Ae){console.error("Error fetching event details:",Ae),p(ce),_(w.has(ce.id||"")),v(!0)}}),de=(ce,Ae)=>E(void 0,null,function*(){try{yield Qr.setEventInterest(t,ce,Ae),b(Be=>{const Xe=new Set(Be);return Ae?Xe.add(ce):Xe.delete(ce),Xe}),_(Ae)}catch(Be){console.error("Error toggling interest:",Be)}}),xe=(o==null?void 0:o.events.slice(0,u*q))||[],ie=o?xe.length<o.events.length:!1;return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsxs("div",{className:"max-w-6xl mx-auto px-4 pt-4 pb-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs(le,{variant:"ghost",size:"sm",onClick:n,className:"mb-4",children:[s.jsx(Se,{name:"leftArrow",size:16,className:"mr-2",color:"var(--neutral-900)"}),"Back to Discover"]}),o&&s.jsxs(s.Fragment,{children:[s.jsx("h1",{className:"text-2xl font-bold mb-2",children:o.title}),s.jsx("p",{className:"text-muted-foreground",children:o.description})]})]}),s.jsxs("div",{className:"mb-6 flex items-center gap-2 flex-wrap",children:[s.jsxs(fc,{open:k,onOpenChange:P,children:[s.jsx(mc,{asChild:!0,children:s.jsx(le,{variant:"outline",size:"sm",className:"p-2 flex-shrink-0",children:s.jsx(Se,{name:"calendar",size:16,color:"var(--neutral-900)"})})}),s.jsx(wl,{className:"w-auto p-0 bg-white",align:"start",children:s.jsx(ax,{mode:"range",selected:{from:(ue=N.dateRange)==null?void 0:ue.from,to:(_e=N.dateRange)==null?void 0:_e.to},onSelect:ce=>{S(H(M({},N),{dateRange:ce})),ce!=null&&ce.from&&(ce!=null&&ce.to)&&P(!1)},numberOfMonths:2})})]}),s.jsxs(fc,{open:A,onOpenChange:R,children:[s.jsx(mc,{asChild:!0,children:s.jsxs(le,{variant:"outline",size:"sm",className:"p-2 relative flex-shrink-0",children:[s.jsx(Se,{name:"music",size:16,color:"var(--neutral-900)"}),N.genres&&N.genres.length>0&&s.jsx(Ke,{variant:"secondary",className:"absolute -top-1 -right-1 h-4 min-w-4 px-1 text-xs flex items-center justify-center",children:N.genres.length})]})}),s.jsx(wl,{className:"w-80 bg-white",align:"start",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"font-semibold text-sm mb-2",children:"Select Genres"}),s.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-64 overflow-y-auto",children:t8e.map(ce=>{var Ae;return s.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer p-2 rounded hover:bg-accent",children:[s.jsx(uw,{checked:((Ae=N.genres)==null?void 0:Ae.includes(ce))||!1,onCheckedChange:()=>Z(ce)}),s.jsx("span",{children:ce})]},ce)})})]})})]}),s.jsxs(fc,{open:$,onOpenChange:ce=>{O(ce),ce&&D(N.cities||[])},children:[s.jsx(mc,{asChild:!0,children:s.jsxs(le,{variant:"outline",size:"sm",className:"p-2 relative flex-shrink-0",children:[s.jsx(Se,{name:"location",size:16,color:"var(--neutral-900)"}),N.cities&&N.cities.length>0&&s.jsx(Ke,{variant:"secondary",className:"absolute -top-1 -right-1 h-4 min-w-4 px-1 text-xs flex items-center justify-center",children:N.cities.length})]})}),s.jsx(wl,{className:"w-80 bg-white",align:"start",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"font-semibold text-sm mb-2",children:"Select Cities"}),U?s.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading cities..."}):s.jsx("div",{className:"max-h-64 overflow-y-auto space-y-1",children:B.map((ce,Ae)=>{const Be=ce.state?`${ce.city}, ${ce.state}`:ce.city,Xe=z.includes(Be);return s.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer p-2 rounded hover:bg-accent",children:[s.jsx(uw,{checked:Xe,onCheckedChange:()=>Q(Be)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:ce.city}),ce.state&&s.jsx("div",{className:"text-xs text-muted-foreground",children:ce.state})]}),s.jsx("div",{className:"text-xs text-muted-foreground",children:ce.eventCount})]},`${Be}-${Ae}`)})}),s.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[s.jsx(le,{size:"sm",onClick:Y,className:"flex-1",children:"Apply"}),s.jsx(le,{size:"sm",variant:"outline",onClick:()=>{D([]),S(H(M({},N),{cities:[]}))},children:"Clear"})]})]})})]}),ne&&s.jsx(le,{variant:"ghost",size:"sm",onClick:X,className:"p-2 text-muted-foreground hover:text-foreground flex-shrink-0",children:s.jsx(Se,{name:"x",size:16,color:"var(--neutral-900)"})})]}),ne&&s.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-4",children:[((ae=N.dateRange)==null?void 0:ae.from)&&s.jsxs(Ke,{variant:"secondary",className:"gap-1",children:["Date: ",Mt(N.dateRange.from,"MMM d"),N.dateRange.to&&` - ${Mt(N.dateRange.to,"MMM d")}`,s.jsx("button",{onClick:()=>S(H(M({},N),{dateRange:void 0})),className:"ml-1 hover:text-destructive",children:s.jsx(Se,{name:"x",size:16,color:"var(--neutral-900)"})})]}),(we=N.genres)==null?void 0:we.map(ce=>s.jsxs(Ke,{variant:"secondary",className:"gap-1",children:[ce,s.jsx("button",{onClick:()=>Z(ce),className:"ml-1 hover:text-destructive",children:s.jsx(Se,{name:"x",size:16,color:"var(--neutral-900)"})})]},ce)),(oe=N.cities)==null?void 0:oe.map(ce=>s.jsxs(Ke,{variant:"secondary",className:"gap-1",children:[ce,s.jsx("button",{onClick:()=>{var Ae;S(H(M({},N),{cities:(Ae=N.cities)==null?void 0:Ae.filter(Be=>Be!==ce)}))},className:"ml-1 hover:text-destructive",children:s.jsx(Se,{name:"x",size:16,color:"var(--neutral-900)"})})]},ce))]}),c?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Se,{name:"refresh",size:24,className:"animate-spin",color:"var(--neutral-600)"})}):o&&o.events.length===0?s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:"No events found for this vibe."})}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:xe.map(ce=>s.jsx(gR,{event:ce,onClick:()=>ee(ce),socialProofCount:void 0},ce.id))}),ie&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(le,{variant:"outline",onClick:()=>f(ce=>ce+1),children:"Load More"})}),!ie&&o&&o.events.length>0&&s.jsxs("div",{className:"text-center py-4 text-sm text-muted-foreground",children:["Showing all ",o.events.length," events"]})]})]}),g&&h&&s.jsx(Bl,{isOpen:g,onClose:()=>{v(!1),p(null)},event:h,currentUserId:t,isInterested:y,onInterestToggle:de,onReview:()=>{console.log("Review event:",h.id)},onNavigateToProfile:a,onNavigateToChat:i})]})},Tj=({title:e,description:t,items:r,loading:n=!1,emptyMessage:a="No items to display",className:i,itemClassName:o,showTitle:l=!0})=>n?s.jsxs("div",{className:ke("space-y-2",i),children:[l&&e&&s.jsxs("div",{children:[s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:e}),t&&s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:t})]}),s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(Se,{name:"refresh",size:24,className:"animate-spin",color:"var(--neutral-600)"})})]}):r.length===0?s.jsxs("div",{className:ke("space-y-2",i),children:[l&&e&&s.jsxs("div",{children:[s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:e}),t&&s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:t})]}),s.jsx("div",{className:"py-8",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",textAlign:"center"},children:s.jsx("p",{children:a})})]}):s.jsxs("div",{className:ke("space-y-2",i),children:[l&&e&&s.jsxs("div",{children:[s.jsx("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--neutral-900)"},children:e}),t&&s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:t})]}),s.jsx("div",{className:"overflow-x-auto pb-2 -mx-4 px-4 scrollbar-hide",children:s.jsx("div",{className:"flex gap-4 items-stretch",style:{width:"max-content",minWidth:"100%",justifyContent:"center"},children:r.map((c,d)=>s.jsx("div",{className:ke("flex-shrink-0 h-full",o),children:c},d))})})]});class n8e{static getEventsByArtist(t,r,n=10){return E(this,null,function*(){try{const a=yield Kf.getUserTopArtists(t,20);if(!a.some(c=>c.artist_name.toLowerCase()===r.toLowerCase())){const{data:c}=yield T.from("events").select("*").ilike("artist_name",`%${r}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(n);return(c||[]).map(d=>H(M({},d),{reason:`Because you like ${r}`,sourceArtist:r}))}const o=a.filter(c=>c.artist_name.toLowerCase()===r.toLowerCase()).flatMap(c=>c.genres||[]);if(o.length===0){const{data:c}=yield T.from("events").select("*").ilike("artist_name",`%${r}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(n);return(c||[]).map(d=>H(M({},d),{reason:`Because you like ${r}`,sourceArtist:r}))}const{data:l}=yield T.from("events").select("*").gte("event_date",new Date().toISOString()).overlaps("genres",o).not("artist_name","ilike",`%${r}%`).order("event_date",{ascending:!0}).limit(n);return(l||[]).map(c=>H(M({},c),{reason:`Similar to ${r}`,sourceArtist:r}))}catch(a){return console.error("Error getting events by artist:",a),[]}})}static getEventsByVenue(t,r,n=10){return E(this,null,function*(){try{const{data:a}=yield T.from("events").select("*").ilike("venue_name",`%${r}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(n);return(a||[]).map(i=>H(M({},i),{reason:`At ${r} (you rated this venue highly)`,sourceVenue:r}))}catch(a){return console.error("Error getting events by venue:",a),[]}})}static getEventsByGenre(t,r,n=10){return E(this,null,function*(){try{const{data:a}=yield T.from("events").select("*").gte("event_date",new Date().toISOString()).contains("genres",[r]).order("event_date",{ascending:!0}).limit(n);return(a||[]).map(i=>H(M({},i),{reason:`Because you attend ${r} shows`,sourceGenre:r}))}catch(a){return console.error("Error getting events by genre:",a),[]}})}static getAllBecauseYouLike(t){return E(this,null,function*(){try{const r=[],n=yield Kf.getUserTopArtists(t,5);for(const h of n.slice(0,3)){const p=yield this.getEventsByArtist(t,h.artist_name,10);p.length>0&&r.push({title:`Because you like ${h.artist_name}`,events:p,type:"artist"})}const{data:a,error:i}=yield T.from("reviews").select("venue_rating, event_id").eq("user_id",t).eq("is_draft",!1).gte("venue_rating",4).not("venue_rating","is",null).limit(10);if(i)return console.warn("Error fetching venue reviews:",i),r;if(!a||a.length===0)return r;const o=a.map(h=>h.event_id).filter(Boolean),l=new Map;if(o.length>0){const{data:h}=yield T.from("events").select("id, venue_name").in("id",o);(h||[]).forEach(p=>{p.venue_name&&l.set(p.id,p.venue_name)})}const c=new Set;a.forEach(h=>{const p=l.get(h.event_id);p&&c.add(p)});for(const h of Array.from(c).slice(0,2)){const p=yield this.getEventsByVenue(t,h,10);p.length>0&&r.push({title:`At ${h} (you rated this venue highly)`,events:p,type:"venue"})}const{data:d}=yield T.from("reviews").select("events:event_id(genres)").eq("user_id",t).eq("is_draft",!1).not("events.genres","is",null).limit(20),u=new Map;(d||[]).forEach(h=>{var p;(p=h.events)!=null&&p.genres&&h.events.genres.forEach(g=>{u.set(g,(u.get(g)||0)+1)})});const f=Array.from(u.entries()).sort(([h,p],[g,v])=>v-p).slice(0,2).map(([h])=>h);for(const h of f){const p=yield this.getEventsByGenre(t,h,10);p.length>0&&r.push({title:`Because you attend ${h} shows`,events:p,type:"genre"})}return r}catch(r){return console.error("Error getting all because you like:",r),[]}})}static dismissRecommendation(t,r,n){return E(this,null,function*(){try{const{data:a}=yield T.from("users").select("dismissed_recommendations").eq("user_id",t).single(),i=(a==null?void 0:a.dismissed_recommendations)||[],o=`${r}:${n}`;i.includes(o)||(yield T.from("users").update({dismissed_recommendations:[...i,o]}).eq("user_id",t))}catch(a){console.error("Error dismissing recommendation:",a)}})}}const s8e=({currentUserId:e,onNavigateToProfile:t,onNavigateToChat:r})=>{const[n,a]=x.useState([]),[i,o]=x.useState(!0),[l,c]=x.useState(new Set),[d,u]=x.useState(null),[f,h]=x.useState(!1),[p,g]=x.useState(!1),[v,y]=x.useState(new Set);x.useEffect(()=>{b(),_(),w()},[e]);const _=()=>E(void 0,null,function*(){try{const A=yield Qr.getUserInterestedEventIdSet(e);y(A)}catch(A){console.error("Error loading interested events:",A)}}),w=()=>E(void 0,null,function*(){try{const{data:A}=yield T.from("users").select("dismissed_recommendations").eq("user_id",e).single();A!=null&&A.dismissed_recommendations&&c(new Set(A.dismissed_recommendations))}catch(A){console.error("Error loading dismissed carousels:",A)}}),b=()=>E(void 0,null,function*(){o(!0);try{const A=yield n8e.getAllBecauseYouLike(e);a(A)}catch(A){console.error("Error loading because you like carousels:",A),a([])}finally{o(!1)}}),N=A=>E(void 0,null,function*(){try{const R=`${A.type}:${A.title}`;c(z=>new Set(z).add(R));const{data:$}=yield T.from("users").select("dismissed_recommendations").eq("user_id",e).single(),O=($==null?void 0:$.dismissed_recommendations)||[];O.includes(R)||(yield T.from("users").update({dismissed_recommendations:[...O,R]}).eq("user_id",e)),a(z=>z.filter(D=>D.title!==A.title))}catch(R){console.error("Error dismissing carousel:",R)}}),S=A=>E(void 0,null,function*(){try{const{data:R}=yield T.from("events").select("*").eq("id",A.id).single();if(R){u(R);const $=yield Qr.isUserInterested(e,R.id);g($),h(!0)}else u(A),g(v.has(A.id||"")),h(!0)}catch(R){console.error("Error fetching event details:",R),u(A),g(v.has(A.id||"")),h(!0)}}),k=(A,R)=>E(void 0,null,function*(){try{yield Qr.setEventInterest(e,A,R),y($=>{const O=new Set($);return R?O.add(A):O.delete(A),O}),g(R)}catch($){console.error("Error toggling interest:",$)}}),P=n.filter(A=>{const R=`${A.type}:${A.title}`;return!l.has(R)});return P.length===0&&!i?null:s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-6",children:P.map(A=>s.jsxs("div",{className:"relative",children:[s.jsx(Tj,{title:A.title,items:A.events.slice(0,10).map(R=>s.jsx(gR,{event:R,onClick:()=>S(R)},R.id)),loading:i,emptyMessage:`No events found for ${A.title}`}),s.jsx(le,{variant:"ghost",size:"sm",className:"absolute top-0 right-0",onClick:()=>N(A),children:s.jsx(Se,{name:"x",size:16,color:"var(--neutral-900)"})})]},A.title))}),f&&d&&s.jsx(Bl,{isOpen:f,onClose:()=>{h(!1),u(null)},event:d,currentUserId:e,isInterested:p,onInterestToggle:k,onReview:()=>{console.log("Review event:",d.id)},onNavigateToProfile:t,onNavigateToChat:r})]})},GY=({scene:e,onClick:t,className:r})=>{var d,u,f,h,p;const n=e.userProgress,a=((d=e.participants)==null?void 0:d.length)||(((u=e.participating_artists)==null?void 0:u.length)||0)+(((f=e.participating_venues)==null?void 0:f.length)||0)+(((h=e.participating_cities)==null?void 0:h.length)||0)+(((p=e.participating_genres)==null?void 0:p.length)||0),i=n?(n.artists_experienced||0)+(n.venues_experienced||0)+(n.cities_experienced||0)+(n.genres_experienced||0):0,o=a,l=i,c=o>0?Math.min(l/o*100,100):0;return s.jsxs(He,{className:ke("cursor-pointer transition-all hover:shadow-lg flex flex-col h-full min-h-[400px] w-[320px] flex-shrink-0",r),onClick:t,children:[s.jsxs(Er,{className:"pb-2",children:[s.jsx(qr,{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)"},children:e.name}),e.short_description&&s.jsx("p",{className:"mt-1 line-clamp-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:e.short_description})]}),s.jsxs(et,{className:"flex-1 flex flex-col space-y-3",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:"Progress"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[l,"/",o," participants"]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"8px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all duration-300",style:{width:`${c}%`,background:"var(--gradient-brand)",borderRadius:c>=100?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:c>0?"4px":"0"}})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:"Participants"}),e.participants&&e.participants.length>0?s.jsxs(s.Fragment,{children:[(()=>{const g=e.participants.filter(v=>v.participant_type==="artist"&&v.artist_name);return g.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Se,{name:"music",size:16,color:"var(--neutral-600)"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:["Artists (",g.length,")"]})]}),s.jsxs("p",{className:"line-clamp-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[g.slice(0,3).map(v=>v.artist_name).filter(Boolean).join(", "),g.length>3&&` +${g.length-3}`]})]})})(),(()=>{const g=e.participants.filter(v=>v.participant_type==="venue"&&v.venue_name);return g.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Se,{name:"location",size:16,color:"var(--neutral-600)"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:["Venues (",g.length,")"]})]}),s.jsxs("p",{className:"line-clamp-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[g.slice(0,3).map(v=>v.venue_name).filter(Boolean).join(", "),g.length>3&&` +${g.length-3}`]})]})})()]}):s.jsxs(s.Fragment,{children:[e.participating_venues&&e.participating_venues.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Se,{name:"location",size:16,color:"var(--neutral-600)"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:["Venues (",e.participating_venues.length,")"]})]}),s.jsxs("p",{className:"line-clamp-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[e.participating_venues.slice(0,3).join(", "),e.participating_venues.length>3&&` +${e.participating_venues.length-3}`]})]}),e.participating_artists&&e.participating_artists.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Se,{name:"music",size:16,color:"var(--neutral-600)"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:["Artists (",e.participating_artists.length,")"]})]}),s.jsxs("p",{className:"line-clamp-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[e.participating_artists.slice(0,3).join(", "),e.participating_artists.length>3&&` +${e.participating_artists.length-3}`]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-2 border-t mt-auto",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Se,{name:"calendar",size:16,color:"var(--neutral-600)"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[e.upcomingEventsCount||0," upcoming"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Se,{name:"twoUsers",size:16,color:"var(--neutral-600)"}),s.jsxs("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[e.activeReviewersCount||0," reviewers"]})]})]})]})]})};class YY{static getScenes(t=10,r){return E(this,null,function*(){try{let n=T.from("scenes").select("*").eq("is_active",!0).order("sort_order",{ascending:!0}).order("is_featured",{ascending:!1}).limit(t);const{data:a,error:i}=yield n;if(i)throw i;if(!a||a.length===0)return[];let o=new Map;if(r)try{const v=a.map(w=>w.id),{data:y,error:_}=yield T.from("user_scene_progress").select("*").eq("user_id",r).in("scene_id",v);!_&&y&&y.forEach(w=>{o.set(w.scene_id,w)})}catch(v){}const l=a.map(v=>v.id),{data:c}=yield T.from("scene_participants").select(`
          id,
          scene_id,
          participant_type,
          artist_id,
          venue_id,
          text_value
        `).in("scene_id",l),d=[...new Set((c==null?void 0:c.filter(v=>v.artist_id).map(v=>v.artist_id))||[])],u=[...new Set((c==null?void 0:c.filter(v=>v.venue_id).map(v=>v.venue_id))||[])],f=new Map;if(d.length>0){const{data:v}=yield T.from("artists").select("id, name").in("id",d);v==null||v.forEach(y=>f.set(y.id,y.name))}const h=new Map;if(u.length>0){const{data:v}=yield T.from("venues").select("id, name").in("id",u);v==null||v.forEach(y=>h.set(y.id,y.name))}const p=new Map;return c&&c.forEach(v=>{p.has(v.scene_id)||p.set(v.scene_id,[]),p.get(v.scene_id).push({id:v.id,participant_type:v.participant_type,artist_id:v.artist_id,venue_id:v.venue_id,text_value:v.text_value,artist_name:v.artist_id?f.get(v.artist_id):void 0,venue_name:v.venue_id?h.get(v.venue_id):void 0})}),yield Promise.all(a.map(v=>E(this,null,function*(){const y=p.get(v.id)||[],_=y.filter(P=>P.participant_type==="artist"&&P.artist_id).map(P=>P.artist_id),w=y.filter(P=>P.participant_type==="venue"&&P.venue_id).map(P=>P.venue_id),b=y.filter(P=>P.participant_type==="city"&&P.text_value).map(P=>P.text_value),N=y.filter(P=>P.participant_type==="genre"&&P.text_value).map(P=>P.text_value),S=yield this.getUpcomingEventsCount(H(M({},v),{participating_artists:_,participating_venues:w,participating_cities:b,participating_genres:N})),k=yield this.getActiveReviewersCount(v.id,N);return H(M({},v),{participants:y,participating_artists:_,participating_venues:w,participating_cities:b,participating_genres:N,upcomingEventsCount:S,activeReviewersCount:k,userProgress:o.get(v.id)})})))}catch(n){return console.error("Error getting scenes:",n),[]}})}static getActiveReviewersCount(t,r){return E(this,null,function*(){try{const{data:n}=yield T.from("scenes").select("*").eq("id",t).single();if(!n)return 0;let a=T.from("events").select("id").gte("event_date",new Date().toISOString());n.participating_artists&&n.participating_artists.length>0&&(a=a.in("artist_id",n.participating_artists).not("artist_id","is",null)),n.participating_venues&&n.participating_venues.length>0&&(a=a.in("venue_id",n.participating_venues).not("venue_id","is",null)),n.participating_cities&&n.participating_cities.length>0&&(a=a.in("venue_city",n.participating_cities)),r&&r.length>0&&(a=a.overlaps("genres",r));const{data:i}=yield a.limit(100);if(!i||i.length===0)return 0;const o=i.map(d=>d.id),{count:l,error:c}=yield T.from("reviews").select("user_id",{count:"exact",head:!0}).in("event_id",o).eq("is_draft",!1).eq("was_there",!0);if(c)throw c;return l||0}catch(n){return console.error("Error counting active reviewers:",n),0}})}static getUpcomingEventsCount(t){return E(this,null,function*(){try{let r=T.from("events").select("id",{count:"exact",head:!0}).gte("event_date",new Date().toISOString());t.participating_artists&&t.participating_artists.length>0&&(r=r.in("artist_id",t.participating_artists).not("artist_id","is",null)),t.participating_venues&&t.participating_venues.length>0&&(r=r.in("venue_id",t.participating_venues).not("venue_id","is",null)),t.participating_cities&&t.participating_cities.length>0&&(r=r.in("venue_city",t.participating_cities)),t.participating_genres&&t.participating_genres.length>0&&(r=r.overlaps("genres",t.participating_genres));const{count:n,error:a}=yield r;if(a)throw a;return n||0}catch(r){return console.error("Error counting upcoming events:",r),0}})}static getUserSceneProgress(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("user_scene_progress").select("*").eq("user_id",t).eq("scene_id",r).maybeSingle();return a?a.code==="PGRST116"?null:a.code==="PGRST301"||a.status===406?(console.warn("RLS blocking access to user_scene_progress:",{code:a.code,status:a.status,message:a.message}),null):(console.warn("Error getting user scene progress:",a),null):n}catch(n){return console.warn("Error getting user scene progress:",n),null}})}static refreshSceneProgress(t,r){return E(this,null,function*(){try{const{error:n}=yield T.rpc("calculate_scene_progress",{p_user_id:t,p_scene_id:r});return n?(console.warn("Scene progress calculation failed (non-critical):",n),!1):!0}catch(n){return console.warn("Error refreshing scene progress (non-critical):",n),!1}})}static getAllUserSceneProgress(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("get_all_user_scene_progress",{p_user_id:t});if(!n&&r)return r;n&&n.status!==406&&console.warn("RPC function error (non-critical):",n);const{data:a,error:i}=yield T.from("user_scene_progress").select("*").eq("user_id",t).order("last_activity_at",{ascending:!1});return i?i.code==="PGRST301"||i.status===406?[]:(console.warn("Error getting all user scene progress:",i),[]):a||[]}catch(r){return console.warn("Error getting all user scene progress:",r),[]}})}static generateScenes(t=10){return E(this,null,function*(){return this.getScenes(t)})}static getSceneDetails(t,r){return E(this,null,function*(){try{const{data:n,error:a}=yield T.from("scenes").select("*").eq("id",t).eq("is_active",!0).single();if(a||!n)return null;let i=null;if(r)try{i=yield this.getUserSceneProgress(r,t)}catch(O){}const{data:o}=yield T.from("scene_participants").select(`
          id,
          participant_type,
          artist_id,
          venue_id,
          text_value
        `).eq("scene_id",t),l=[...new Set((o==null?void 0:o.filter(O=>O.artist_id).map(O=>O.artist_id))||[])],c=[...new Set((o==null?void 0:o.filter(O=>O.venue_id).map(O=>O.venue_id))||[])],d=new Map;if(l.length>0){const{data:O}=yield T.from("artists").select("id, name, identifier").in("id",l);O==null||O.forEach(z=>d.set(z.id,{name:z.name,identifier:z.identifier}))}const u=new Map;if(c.length>0){const{data:O}=yield T.from("venues").select("id, name, identifier").in("id",c);O==null||O.forEach(z=>u.set(z.id,{name:z.name,identifier:z.identifier}))}const f=[],h=[],p=[],g=[],v=[];o&&o.forEach(O=>{var z,D;if(v.push({id:O.id,participant_type:O.participant_type,artist_id:O.artist_id,venue_id:O.venue_id,text_value:O.text_value,artist_name:O.artist_id?(z=d.get(O.artist_id))==null?void 0:z.name:void 0,venue_name:O.venue_id?(D=u.get(O.venue_id))==null?void 0:D.name:void 0}),O.participant_type==="artist"&&O.artist_id){const B=d.get(O.artist_id);B!=null&&B.identifier&&f.push(B.identifier)}else if(O.participant_type==="venue"&&O.venue_id){const B=u.get(O.venue_id);B!=null&&B.identifier&&h.push(B.identifier)}else O.participant_type==="city"&&O.text_value?p.push(O.text_value):O.participant_type==="genre"&&O.text_value&&g.push(O.text_value)});const y=[],_=new Set,w=[];if(f.length>0){const O=T.from("events").select("*").gte("event_date",new Date().toISOString()).not("artist_id","is",null).order("event_date",{ascending:!0}).limit(200).then(({data:z,error:D})=>{if(D)throw D;return z?z.filter(F=>F.artist_id?f.some(U=>{if(F.artist_id===U)return!0;const G=F.artist_id.replace(/^jambase:/,""),q=U.replace(/^jambase:/,"");return G===q}):!1):[]});y.push(O)}if(h.length>0){const O=v.filter(D=>D.participant_type==="venue"&&D.venue_name).map(D=>D.venue_name).filter(Boolean),z=T.from("events").select("*").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(500).then(({data:D,error:B})=>{if(B)throw B;return D?D.filter(U=>U.venue_id&&h.some(q=>{if(U.venue_id===q)return!0;const K=U.venue_id.replace(/^jambase:/,""),Z=q.replace(/^jambase:/,"");return K===Z})?!0:U.venue_name&&O.length>0?O.some(G=>{var Z;const q=(Z=U.venue_name)==null?void 0:Z.toLowerCase().trim(),K=G==null?void 0:G.toLowerCase().trim();return!q||!K?!1:q===K||q.includes(K)||K.includes(q)}):!1):[]});y.push(z)}if(p.length>0){const O=T.from("events").select("*").gte("event_date",new Date().toISOString()).in("venue_city",p).order("event_date",{ascending:!0}).limit(50);y.push(O)}if(g.length>0){const O=T.from("events").select("*").gte("event_date",new Date().toISOString()).overlaps("genres",g).order("event_date",{ascending:!0}).limit(50);y.push(O)}if(y.length>0)try{(yield Promise.all(y)).forEach((z,D)=>{let B=[];Array.isArray(z)?B=z:z&&typeof z=="object"&&"data"in z&&(B=z.data||[]),B.forEach(F=>{F&&F.id&&!_.has(F.id)&&(_.add(F.id),w.push(F))})})}catch(O){console.error("Error fetching scene events:",O)}const b=w.sort((O,z)=>new Date(O.event_date).getTime()-new Date(z.event_date).getTime()).slice(0,20),N=(b||[]).map(O=>O.id);let S=T.from("reviews").select("user_id, event_id").eq("is_draft",!1).eq("was_there",!0).limit(100);N.length>0?S=S.in("event_id",N):S=S.eq("event_id","00000000-0000-0000-0000-000000000000");const{data:k}=yield S,P=[...new Set((k||[]).map(O=>O.user_id))],{data:A}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",P.length>0?P:[""]),R=new Map,$=new Map((A||[]).map(O=>[O.user_id,O]));return(k||[]).forEach(O=>{const z=O.user_id,D=$.get(z);if(z&&D){const B=R.get(z)||{user_id:z,name:D.name||"User",avatar_url:D.avatar_url,review_count:0};B.review_count+=1,R.set(z,B)}}),H(M({},n),{participants:v,participating_artists:f,participating_venues:h,participating_cities:p,participating_genres:g,userProgress:i||void 0,upcomingEvents:b||[],activeReviewers:Array.from(R.values()).sort((O,z)=>z.review_count-O.review_count).slice(0,10)})}catch(n){return console.error("Error getting scene details:",n),null}})}static getSceneEvents(t,r=20){return E(this,null,function*(){try{const n=yield this.getSceneDetails(t);return n?n.upcomingEvents.slice(0,r):[]}catch(n){return console.error("Error getting scene events:",n),[]}})}static getSceneReviewers(t){return E(this,null,function*(){try{const r=yield this.getSceneDetails(t);return r?r.activeReviewers:[]}catch(r){return console.error("Error getting scene reviewers:",r),[]}})}}const a8e=({isOpen:e,onClose:t,artistId:r,artistName:n,currentUserId:a})=>{const i=as(),[o,l]=x.useState(null),[c,d]=x.useState(0),[u,f]=x.useState(0),[h,p]=x.useState(0),[g,v]=x.useState(null),[y,_]=x.useState(0),[w,b]=x.useState(!0);x.useEffect(()=>{e&&N()},[e,r,n]);const N=()=>E(void 0,null,function*(){var S;try{b(!0);const{data:k}=yield T.from("artists").select("id, name, image_url").eq("id",r).maybeSingle();k!=null&&k.image_url&&l(k.image_url);const{data:P}=yield T.from("events").select("id, event_date, images").eq("artist_id",r);if(P){d(P.length);const R=new Date,$=P.filter(O=>new Date(O.event_date)>=R).length;if(f($),p(P.length-$),!o){const O=P.find(z=>z.images&&Array.isArray(z.images)&&z.images.length>0);if(O!=null&&O.images){const z=(S=O.images.find(D=>D==null?void 0:D.url))==null?void 0:S.url;z&&l(z)}}}const A=(P==null?void 0:P.map(R=>R.id))||[];if(A.length>0){const{data:R}=yield T.from("reviews").select("rating").in("event_id",A).eq("is_public",!0).eq("is_draft",!1);if(R&&R.length>0){const $=R.reduce((O,z)=>O+(z.rating||0),0)/R.length;v($),_(R.length)}}}catch(k){console.error("Error loading artist data:",k)}finally{b(!1)}});return e?s.jsxs("div",{className:"fixed inset-0 z-50 bg-[#fcfcfc] overflow-y-auto overflow-x-hidden w-full max-w-full",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},children:[s.jsx("div",{className:"bg-[#fcfcfc] border-b border-gray-200 w-full max-w-full",children:s.jsxs("div",{className:"px-4 py-3 flex items-center justify-between gap-2",children:[s.jsx("h1",{className:"text-lg font-bold flex-1 pr-2 break-words min-w-0",children:n}),s.jsx("button",{onClick:t,className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",children:s.jsx(Se,{name:"x",size:24,color:"var(--neutral-900)"})})]})}),s.jsx("div",{className:"px-4 py-4 w-full max-w-full overflow-x-hidden",children:w?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start gap-3 w-full",children:[o?s.jsx("img",{src:o,alt:n,className:"w-16 h-16 rounded-full object-cover flex-shrink-0"}):s.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center flex-shrink-0",children:s.jsx(Se,{name:"music",size:35,color:"var(--neutral-600)"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-lg font-bold mb-2 break-words",children:n}),g!==null&&s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"flex items-center",children:Array.from({length:5}).map((S,k)=>s.jsx(Qt,{size:16,style:{color:k<Math.floor(g)?"var(--color-yellow)":"var(--neutral-300)",fill:k<Math.floor(g)?"var(--color-yellow)":"none"}},k))}),s.jsx("span",{className:"text-sm font-medium",children:g.toFixed(1)}),y>0&&s.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",y," ",y===1?"review":"reviews",")"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-3 flex-wrap",children:[s.jsx(Ky,{artistName:n,artistId:r,userId:a}),s.jsx(le,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>{i(`/artist/${encodeURIComponent(n)}`),t()},children:"View All Events"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 w-full",children:[s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:c}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Events"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:u}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Upcoming"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:h}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Past"})]})]}),y>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-4",children:"Reviews"}),s.jsx(jT,{artistName:n,artistId:r})]}),s.jsx(le,{variant:"outline",className:"w-full",onClick:()=>{i(`/artist/${encodeURIComponent(n)}`),t()},children:"View Full Artist Page"})]})})]}):null},i8e=({isOpen:e,onClose:t,venueId:r,venueName:n,currentUserId:a})=>{const i=as(),[o,l]=x.useState(null),[c,d]=x.useState(null),[u,f]=x.useState(null),[h,p]=x.useState(null),[g,v]=x.useState(0),[y,_]=x.useState(0),[w,b]=x.useState(0),[N,S]=x.useState(null),[k,P]=x.useState(0),[A,R]=x.useState(!0);x.useEffect(()=>{e&&$()},[e,r,n]);const $=()=>E(void 0,null,function*(){try{R(!0);const{data:O,error:z}=yield T.from("events").select("id, event_date, venue_city, venue_state, latitude, longitude").eq("venue_id",r).limit(100);z&&console.warn("Error fetching venue events:",z);try{const{data:B}=yield T.from("venues").select("id, name, state, latitude, longitude, street_address, zip, country").eq("id",r).maybeSingle();B&&(B.state&&!c&&d(B.state),B.latitude&&!u&&f(Number(B.latitude)),B.longitude&&!h&&p(Number(B.longitude)))}catch(B){console.warn("Could not fetch venue details (non-critical):",B)}if(O&&O.length>0){v(O.length);const B=new Date,F=O.filter(G=>new Date(G.event_date)>=B).length;_(F),b(O.length-F);const U=O[0];U.venue_city&&l(U.venue_city),U.venue_state&&d(U.venue_state),U.latitude&&f(Number(U.latitude)),U.longitude&&p(Number(U.longitude))}if(O&&O.length>0){v(O.length);const B=new Date,F=O.filter(U=>new Date(U.event_date)>=B).length;if(_(F),b(O.length-F),!o||!c){const U=O[0];U.venue_city&&!o&&l(U.venue_city),U.venue_state&&!c&&d(U.venue_state),U.latitude&&!u&&f(Number(U.latitude)),U.longitude&&!h&&p(Number(U.longitude))}}const D=(O==null?void 0:O.map(B=>B.id))||[];if(D.length>0){const{data:B}=yield T.from("reviews").select("venue_rating, rating").in("event_id",D).eq("is_public",!0).eq("is_draft",!1);if(B&&B.length>0){const F=B.map(U=>U.venue_rating||U.rating).filter(U=>typeof U=="number"&&!isNaN(U)&&U>0);if(F.length>0){const U=F.reduce((G,q)=>G+q,0)/F.length;S(U)}else S(null);P(F.length)}}}catch(O){console.error("Error loading venue data:",O)}finally{R(!1)}});return e?s.jsxs("div",{className:"fixed inset-0 z-50 bg-[#fcfcfc] overflow-y-auto overflow-x-hidden w-full max-w-full",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},children:[s.jsx("div",{className:"bg-[#fcfcfc] border-b border-gray-200 w-full max-w-full",children:s.jsxs("div",{className:"px-4 py-3 flex items-center justify-between gap-2",children:[s.jsx("h1",{className:"text-lg font-bold flex-1 pr-2 break-words min-w-0",children:n}),s.jsx("button",{onClick:t,className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",children:s.jsx(Se,{name:"x",size:24,color:"var(--neutral-900)"})})]})}),s.jsx("div",{className:"px-4 py-4 w-full max-w-full overflow-x-hidden",children:A?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start gap-3 w-full",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center flex-shrink-0",children:s.jsx(Se,{name:"location",size:35,color:"var(--neutral-600)"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-lg font-bold mb-2 break-words",children:n}),(o||c)&&s.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground mb-2",children:[s.jsx(Se,{name:"location",size:16,color:"var(--neutral-600)"}),s.jsx("span",{children:[o,c].filter(Boolean).join(", ")})]}),N!==null&&s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"flex items-center",children:Array.from({length:5}).map((O,z)=>s.jsx(Qt,{size:16,style:{color:z<Math.floor(N)?"var(--color-yellow)":"var(--neutral-300)",fill:z<Math.floor(N)?"var(--color-yellow)":"none"}},z))}),s.jsx("span",{className:"text-sm font-medium",children:N.toFixed(1)}),k>0&&s.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",k," ",k===1?"review":"reviews",")"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-3 flex-wrap",children:[s.jsx(g1,{venueName:n,venueCity:o||void 0,venueState:c||void 0,userId:a}),s.jsx(le,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>{i(`/venue/${encodeURIComponent(n)}`),t()},children:"View All Events"})]})]})]}),u&&h&&s.jsx("div",{className:"h-64 rounded-lg overflow-hidden border",children:s.jsx(kT,{center:[u,h],zoom:15,events:[{id:r,jambase_event_id:r,title:n,artist_name:n,artist_id:"",venue_name:n,venue_id:r,event_date:new Date().toISOString(),latitude:u,longitude:h}],onEventClick:()=>{}})}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 w-full",children:[s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:g}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Events"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:y}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Upcoming"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:w}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Past"})]})]}),k>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-4",children:"Reviews"}),s.jsx(jT,{artistName:"",venueName:n,venueId:r})]}),s.jsx(le,{variant:"outline",className:"w-full",onClick:()=>{i(`/venue/${encodeURIComponent(n)}`),t()},children:"View Full Venue Page"})]})})]}):null},o8e=({sceneId:e,userId:t,onBack:r,onNavigateToProfile:n,onNavigateToChat:a})=>{var ce,Ae,Be,Xe;const i=as(),[o,l]=x.useState(null),[c,d]=x.useState(!0),[u,f]=x.useState(null),[h,p]=x.useState(!1),[g,v]=x.useState(!1),[y,_]=x.useState(new Set),[w,b]=x.useState(new Set),[N,S]=x.useState(new Map),[k,P]=x.useState(new Map),[A,R]=x.useState(!1),[$,O]=x.useState(!1),[z,D]=x.useState(null),[B,F]=x.useState(""),[U,G]=x.useState(null),[q,K]=x.useState("");x.useEffect(()=>{re(),Z()},[e,t]),x.useEffect(()=>{o&&(Y(),Q(),X())},[o,t]);const Z=()=>E(void 0,null,function*(){try{const ge=yield Qr.getUserInterestedEventIdSet(t);_(ge)}catch(ge){console.error("Error loading interested events:",ge)}}),Y=()=>E(void 0,null,function*(){if(o!=null&&o.participants)try{const ge=o.participants.filter(mt=>mt.participant_type==="artist"&&mt.artist_id).map(mt=>mt.artist_id),We=o.participants.filter(mt=>mt.participant_type==="venue"&&mt.venue_id).map(mt=>mt.venue_id),Ue=new Set;if(ge.length>0){const mt=new Set(ge),{data:Ye}=yield T.from("passport_entries").select("entity_id, entity_uuid").eq("user_id",t).eq("type","artist").in("entity_uuid",ge),Ft=new Map;yield Promise.all(ge.map(Ne=>E(void 0,null,function*(){const{data:Fe}=yield T.rpc("get_external_id",{p_entity_uuid:Ne,p_source:"jambase",p_entity_type:"artist"});Fe&&Ft.set(Ne,Fe)})));const _t=Array.from(Ft.values()),Lt=new Set;_t.forEach(Ne=>{Lt.add(Ne),Lt.add(`jambase:${Ne}`)});let Oe=[];if(_t.length>0){const{data:Ne}=yield T.from("passport_entries").select("entity_id, entity_uuid").eq("user_id",t).eq("type","artist").is("entity_uuid",null);Oe=(Ne||[]).filter(Fe=>{if(!Fe.entity_id)return!1;const ve=Fe.entity_id.replace(/^jambase:/,"");return Lt.has(Fe.entity_id)||Lt.has(ve)})}[...Ye||[],...Oe].forEach(Ne=>{var Fe;if(Ne.entity_uuid&&mt.has(Ne.entity_uuid))Ue.add(`artist:${Ne.entity_uuid}`);else if(Ne.entity_id){const ve=Ne.entity_id.replace(/^jambase:/,""),Me=(Fe=Array.from(Ft.entries()).find(([ze,ct])=>ct===ve||`jambase:${ct}`===Ne.entity_id))==null?void 0:Fe[0];Me&&Ue.add(`artist:${Me}`)}})}if(We.length>0){const mt=new Set(We),{data:Ye}=yield T.from("passport_entries").select("entity_id, entity_uuid").eq("user_id",t).eq("type","venue").in("entity_uuid",We),Ft=new Map;yield Promise.all(We.map(Ne=>E(void 0,null,function*(){const{data:Fe}=yield T.rpc("get_external_id",{p_entity_uuid:Ne,p_source:"jambase",p_entity_type:"venue"});Fe&&Ft.set(Ne,Fe)})));const _t=Array.from(Ft.values()),Lt=new Set;_t.forEach(Ne=>{Lt.add(Ne),Lt.add(`jambase:${Ne}`)});let Oe=[];if(_t.length>0){const{data:Ne}=yield T.from("passport_entries").select("entity_id, entity_uuid").eq("user_id",t).eq("type","venue").is("entity_uuid",null);Oe=(Ne||[]).filter(Fe=>{if(!Fe.entity_id)return!1;const ve=Fe.entity_id.replace(/^jambase:/,"");return Lt.has(Fe.entity_id)||Lt.has(ve)})}[...Ye||[],...Oe].forEach(Ne=>{var Fe;if(Ne.entity_uuid&&mt.has(Ne.entity_uuid))Ue.add(`venue:${Ne.entity_uuid}`);else if(Ne.entity_id){const ve=Ne.entity_id.replace(/^jambase:/,""),Me=(Fe=Array.from(Ft.entries()).find(([ze,ct])=>ct===ve||`jambase:${ct}`===Ne.entity_id))==null?void 0:Fe[0];Me&&Ue.add(`venue:${Me}`)}})}const at=o.participants.filter(mt=>mt.participant_type==="city"&&mt.text_value).map(mt=>mt.text_value);if(at.length>0){const{data:mt}=yield T.from("passport_entries").select("entity_name").eq("user_id",t).eq("type","city").in("entity_name",at);mt==null||mt.forEach(Ye=>Ue.add(`city:${Ye.entity_name}`))}b(Ue)}catch(ge){console.error("Error loading participant experience:",ge)}}),Q=()=>E(void 0,null,function*(){if(!(o!=null&&o.participants))return;const ge=new Map,We=new Date().toISOString();try{yield Promise.all(o.participants.map(Ue=>E(void 0,null,function*(){let at=0;const mt=`${Ue.participant_type}:${Ue.artist_id||Ue.venue_id||Ue.text_value}`;try{if(Ue.participant_type==="artist"&&Ue.artist_id){const{count:Ye}=yield T.from("events").select("id",{count:"exact",head:!0}).gte("event_date",We).eq("artist_id",Ue.artist_id);at=Ye||0}else if(Ue.participant_type==="venue"&&Ue.venue_id){const{count:Ye}=yield T.from("events").select("id",{count:"exact",head:!0}).gte("event_date",We).eq("venue_id",Ue.venue_id);at=Ye||0}else if(Ue.participant_type==="city"&&Ue.text_value){const{count:Ye}=yield T.from("events").select("id",{count:"exact",head:!0}).gte("event_date",We).eq("venue_city",Ue.text_value);at=Ye||0}ge.set(mt,at)}catch(Ye){console.error(`Error loading event count for ${mt}:`,Ye),ge.set(mt,0)}}))),S(ge)}catch(Ue){console.error("Error loading participant event counts:",Ue)}}),X=()=>E(void 0,null,function*(){if(!(o!=null&&o.participants))return;const ge=new Map;try{const We=o.participants.filter(at=>at.participant_type==="artist"&&at.artist_id).map(at=>at.artist_id);if(We.length>0){const{data:at}=yield T.from("artists").select("id, image_url").in("id",We);at==null||at.forEach(mt=>{mt.image_url&&ge.set(`artist:${mt.id}`,mt.image_url)})}const Ue=o.participants.filter(at=>at.participant_type==="venue"&&at.venue_id).map(at=>at.venue_id);if(Ue.length>0){const{data:at}=yield T.from("venues").select("id, image_url").in("id",Ue);at==null||at.forEach(mt=>{mt.image_url&&ge.set(`venue:${mt.id}`,mt.image_url)})}P(ge)}catch(We){console.error("Error loading participant images:",We)}}),ne=ge=>{ge.type==="artist"&&ge.participantId?i(`/artist/${ge.participantId}`):ge.type==="venue"&&ge.participantId?i(`/venue/${ge.participantId}`):ge.type==="artist"&&ge.name?i(`/artist/${encodeURIComponent(ge.name)}`):ge.type==="venue"&&ge.name&&i(`/venue/${encodeURIComponent(ge.name)}`)},re=()=>E(void 0,null,function*(){d(!0);try{const ge=yield YY.getSceneDetails(e,t);l(ge)}catch(ge){console.error("Error loading scene details:",ge)}finally{d(!1)}}),ye=ge=>E(void 0,null,function*(){try{const{data:We}=yield T.from("events").select("*").eq("id",ge.id).single();if(We){f(We);const Ue=yield Qr.isUserInterested(t,We.id);v(Ue),p(!0)}else f(ge),v(y.has(ge.id||"")),p(!0)}catch(We){console.error("Error fetching event details:",We),f(ge),v(y.has(ge.id||"")),p(!0)}}),ee=(ge,We)=>E(void 0,null,function*(){try{yield Qr.setEventInterest(t,ge,We),_(Ue=>{const at=new Set(Ue);return We?at.add(ge):at.delete(ge),at}),v(We)}catch(Ue){console.error("Error toggling interest:",Ue)}});if(c)return s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx(Se,{name:"refresh",size:24,className:"animate-spin",color:"var(--neutral-600)"})});if(!o)return s.jsx("div",{className:"min-h-screen bg-background",children:s.jsxs("div",{className:"max-w-6xl mx-auto px-4 pt-4 pb-6",children:[s.jsxs(le,{variant:"ghost",onClick:()=>{window.history.length>1?i(-1):r()},className:"mb-4",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[s.jsx(Se,{name:"leftArrow",size:16,style:{marginRight:"var(--spacing-inline, 6px)"},color:"var(--neutral-900)"}),"Back to Discover"]}),s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:"Scene not found"})})]})});const de=o.userProgress,xe=de&&de.discovery_state!=="undiscovered",ie=((ce=o.participants)==null?void 0:ce.filter(ge=>ge.participant_type==="venue"&&ge.venue_name))||[],se=((Ae=o.participants)==null?void 0:Ae.filter(ge=>ge.participant_type==="artist"&&ge.artist_name))||[],V=((Be=o.participants)==null?void 0:Be.filter(ge=>ge.participant_type==="genre"&&ge.text_value))||[],ue=((Xe=o.participants)==null?void 0:Xe.filter(ge=>ge.participant_type==="city"&&ge.text_value))||[],_e=se.length,ae=ie.length,we=ue.length,oe=V.length;return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/20",children:[s.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 pt-4 pb-12",children:[s.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>{window.history.length>1?i(-1):r()},className:"mb-6",children:[s.jsx(Se,{name:"leftArrow",size:16,className:"mr-2",color:"var(--neutral-900)"}),"Back to Discover"]}),s.jsxs("div",{className:"mb-8",children:[(o.image_url||o.scene_url)&&s.jsx("div",{className:"w-full h-80 rounded-2xl overflow-hidden mb-6 shadow-lg",children:s.jsx("img",{src:o.image_url||o.scene_url||"",alt:o.name,className:"w-full h-full object-cover"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h1",{className:"text-4xl font-bold tracking-tight",children:o.name}),o.short_description&&s.jsx("p",{className:"text-xl text-muted-foreground font-medium",children:o.short_description}),o.description&&s.jsx("p",{className:"text-base text-muted-foreground leading-relaxed max-w-3xl",children:o.description})]})]}),xe&&s.jsx(He,{className:"mb-8 border-2 border-synth-pink/20 shadow-lg",children:s.jsxs(et,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"p-2 rounded-lg bg-synth-pink/10",children:s.jsx(Se,{name:"trendingUp",size:24,color:"var(--brand-pink-500)"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Your Progress"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Track your journey through this scene"})]}),s.jsx(Ke,{variant:de.discovery_state==="completed"?"default":"secondary",className:"text-sm px-3 py-1",children:de.discovery_state.replace("_"," ")})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Overall Progress"}),s.jsxs("span",{className:"text-lg font-bold text-synth-pink",children:[de.progress_percentage,"%"]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"12px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${de.progress_percentage}%`,background:"var(--gradient-brand)",borderRadius:de.progress_percentage>=100?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:de.progress_percentage>0?"4px":"0"}})})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[_e>0&&s.jsxs("div",{className:"p-4 rounded-lg bg-muted/50 border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Se,{name:"music",size:16,color:"var(--neutral-600)"}),s.jsx("span",{className:"text-sm font-medium",children:"Artists"})]}),s.jsxs("span",{className:"text-sm font-bold",children:[de.artists_experienced,"/",_e]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"8px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all",style:{width:`${_e>0?de.artists_experienced/_e*100:0}%`,backgroundColor:"var(--brand-pink-500)",borderRadius:de.artists_experienced/_e>=1?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:de.artists_experienced/_e>0?"4px":"0"}})})]}),ae>0&&s.jsxs("div",{className:"p-4 rounded-lg bg-muted/50 border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Se,{name:"location",size:16,color:"var(--neutral-600)"}),s.jsx("span",{className:"text-sm font-medium",children:"Venues"})]}),s.jsxs("span",{className:"text-sm font-bold",children:[de.venues_experienced,"/",ae]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"8px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all",style:{width:`${ae>0?de.venues_experienced/ae*100:0}%`,backgroundColor:"var(--brand-pink-500)",borderRadius:de.venues_experienced/ae>=1?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:de.venues_experienced/ae>0?"4px":"0"}})})]}),we>0&&s.jsxs("div",{className:"p-4 rounded-lg bg-muted/50 border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Se,{name:"location",size:16,color:"var(--neutral-600)"}),s.jsx("span",{className:"text-sm font-medium",children:"Cities"})]}),s.jsxs("span",{className:"text-sm font-bold",children:[de.cities_experienced,"/",we]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"8px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all",style:{width:`${we>0?de.cities_experienced/we*100:0}%`,backgroundColor:"var(--brand-pink-500)",borderRadius:de.cities_experienced/we>=1?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:de.cities_experienced/we>0?"4px":"0"}})})]}),oe>0&&s.jsxs("div",{className:"p-4 rounded-lg bg-muted/50 border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Se,{name:"mediumShootingStar",size:16,color:"var(--neutral-600)"}),s.jsx("span",{className:"text-sm font-medium",children:"Genres"})]}),s.jsxs("span",{className:"text-sm font-bold",children:[de.genres_experienced,"/",oe]})]}),s.jsx("div",{className:"w-full overflow-hidden",style:{height:"8px",backgroundColor:"var(--neutral-100)",borderRadius:"var(--radius-corner, 10px)"},children:s.jsx("div",{className:"h-full transition-all",style:{width:`${oe>0?de.genres_experienced/oe*100:0}%`,backgroundColor:"var(--brand-pink-500)",borderRadius:de.genres_experienced/oe>=1?"var(--radius-corner, 10px)":"var(--radius-corner, 10px) 0 0 var(--radius-corner, 10px)",minWidth:de.genres_experienced/oe>0?"4px":"0"}})})]})]}),de.events_experienced>0&&s.jsxs("div",{className:"mt-4 p-3 rounded-lg bg-synth-pink/10 border border-synth-pink/20 flex items-center gap-3",children:[s.jsx(Se,{name:"circleCheck",size:24,className:"flex-shrink-0",color:"var(--brand-pink-500)"}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium",children:[s.jsx("span",{className:"text-synth-pink font-bold",children:de.events_experienced})," events attended"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Keep exploring to complete this scene!"})]})]})]})}),s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[s.jsx(Se,{name:"mediumShootingStar",size:24,color:"var(--brand-pink-500)"}),s.jsx("h2",{className:"text-2xl font-bold",children:"Participants"})]}),s.jsxs("div",{className:"space-y-3",children:[ie.map(ge=>{const We=`venue:${ge.venue_id}`,Ue=w.has(We),at=N.get(We)||0,mt=k.get(We);return s.jsx(He,{className:"cursor-pointer transition-all hover:shadow-lg",style:{border:"1px solid var(--neutral-200)"},onClick:()=>ne({type:"venue",name:ge.venue_name||"",id:ge.id,participantId:ge.venue_id}),children:s.jsx(et,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:mt?s.jsx("img",{src:mt,alt:ge.venue_name,className:"w-16 h-16 rounded-lg object-cover"}):s.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Se,{name:"location",size:35,color:"var(--neutral-600)"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"truncate",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h3-size, 18px)",fontWeight:"var(--typography-h3-weight, 600)",lineHeight:"var(--typography-h3-line-height, 1.4)",color:"var(--neutral-900)"},children:ge.venue_name}),Ue&&s.jsx(Se,{name:"circleCheck",size:24,className:"flex-shrink-0",color:"var(--status-success-500)"})]}),s.jsxs("div",{className:"flex items-center gap-4",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Se,{name:"calendar",size:24,color:"var(--neutral-600)"}),at," ",at===1?"upcoming event":"upcoming events"]}),s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:Ue?"var(--brand-pink-050)":"var(--neutral-100)",border:Ue?"2px solid var(--brand-pink-500)":"2px solid var(--neutral-200)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:Ue?"var(--brand-pink-500)":"var(--neutral-900)",boxShadow:"0 4px 4px 0 var(--shadow-color)"},children:Ue?"Experienced":"Not Experienced"})]})]})]})})},ge.id)}),se.map(ge=>{const We=`artist:${ge.artist_id}`,Ue=w.has(We),at=N.get(We)||0,mt=k.get(We);return s.jsx(He,{className:"cursor-pointer transition-all hover:shadow-lg",style:{border:"1px solid var(--neutral-200)"},onClick:()=>ne({type:"artist",name:ge.artist_name||"",id:ge.id,participantId:ge.artist_id}),children:s.jsx(et,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:mt?s.jsx("img",{src:mt,alt:ge.artist_name,className:"w-16 h-16 rounded-lg object-cover"}):s.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Se,{name:"music",size:35,color:"var(--neutral-600)"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"truncate",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h3-size, 18px)",fontWeight:"var(--typography-h3-weight, 600)",lineHeight:"var(--typography-h3-line-height, 1.4)",color:"var(--neutral-900)"},children:ge.artist_name}),Ue&&s.jsx(Se,{name:"circleCheck",size:24,className:"flex-shrink-0",color:"var(--status-success-500)"})]}),s.jsxs("div",{className:"flex items-center gap-4",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Se,{name:"calendar",size:24,color:"var(--neutral-600)"}),at," ",at===1?"upcoming event":"upcoming events"]}),s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:Ue?"var(--brand-pink-050)":"var(--neutral-100)",border:Ue?"2px solid var(--brand-pink-500)":"2px solid var(--neutral-200)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:Ue?"var(--brand-pink-500)":"var(--neutral-900)",boxShadow:"0 4px 4px 0 var(--shadow-color)"},children:Ue?"Experienced":"Not Experienced"})]})]})]})})},ge.id)}),ue.map(ge=>{const We=`city:${ge.text_value}`,Ue=w.has(We),at=N.get(We)||0;return s.jsx(He,{className:"cursor-pointer transition-all hover:shadow-lg",style:{border:"1px solid var(--neutral-200)"},onClick:()=>ne({type:"city",name:ge.text_value||"",id:ge.id,textValue:ge.text_value}),children:s.jsx(et,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Se,{name:"location",size:35,color:"var(--neutral-600)"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"truncate",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h3-size, 18px)",fontWeight:"var(--typography-h3-weight, 600)",lineHeight:"var(--typography-h3-line-height, 1.4)",color:"var(--neutral-900)"},children:ge.text_value}),Ue&&s.jsx(Se,{name:"circleCheck",size:24,className:"flex-shrink-0",color:"var(--status-success-500)"})]}),s.jsxs("div",{className:"flex items-center gap-4",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Se,{name:"calendar",size:24,color:"var(--neutral-600)"}),at," ",at===1?"upcoming event":"upcoming events"]}),s.jsx("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:Ue?"var(--brand-pink-050)":"var(--neutral-100)",border:Ue?"2px solid var(--brand-pink-500)":"2px solid var(--neutral-200)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:Ue?"var(--brand-pink-500)":"var(--neutral-900)",boxShadow:"0 4px 4px 0 var(--shadow-color)"},children:Ue?"Experienced":"Not Experienced"})]})]})]})})},ge.id)}),V.map(ge=>{const We=`genre:${ge.text_value}`,Ue=N.get(We)||0;return s.jsx(He,{className:"cursor-pointer transition-all hover:shadow-lg border-2 border-muted",onClick:()=>ne({type:"genre",name:ge.text_value||"",id:ge.id,textValue:ge.text_value}),children:s.jsx(et,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Se,{name:"mediumShootingStar",size:35,color:"var(--neutral-600)"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"flex items-center gap-2 mb-1",children:s.jsx("h3",{className:"truncate",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h3-size, 18px)",fontWeight:"var(--typography-h3-weight, 600)",lineHeight:"var(--typography-h3-line-height, 1.4)",color:"var(--neutral-900)"},children:ge.text_value})}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Se,{name:"calendar",size:16,color:"var(--neutral-900)"}),Ue," ",Ue===1?"upcoming event":"upcoming events"]}),s.jsx(Ke,{variant:"secondary",className:"text-xs",children:"Genre"})]})]})]})})},ge.id)})]})]}),o.upcomingEvents.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Se,{name:"calendar",size:24,color:"var(--brand-pink-500)"}),s.jsxs("h2",{className:"text-2xl font-bold",children:["Upcoming Events (",o.upcomingEvents.length,")"]})]}),s.jsx(Tj,{title:"",showTitle:!1,items:o.upcomingEvents.map(ge=>s.jsx(gR,{event:ge,onClick:()=>ye(ge)},ge.id)),emptyMessage:"No upcoming events"})]}),o.activeReviewers.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Se,{name:"twoUsers",size:24,color:"var(--brand-pink-500)"}),s.jsxs("h2",{className:"text-2xl font-bold",children:["Active Reviewers (",o.activeReviewers.length,")"]})]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:o.activeReviewers.map(ge=>s.jsx(He,{className:"cursor-pointer hover:shadow-md transition-all hover:border-synth-pink/50",onClick:()=>n==null?void 0:n(ge.user_id),children:s.jsx(et,{className:"p-4",children:s.jsxs("div",{className:"flex flex-col items-center text-center space-y-2",children:[s.jsxs(Vr,{className:"w-12 h-12",children:[s.jsx(sn,{src:ge.avatar_url||void 0}),s.jsx(Wr,{className:"bg-synth-pink/10 text-synth-pink",children:ge.name.charAt(0).toUpperCase()})]}),s.jsxs("div",{className:"w-full",children:[s.jsx("p",{className:"text-sm font-medium truncate",children:ge.name}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[ge.review_count," ",ge.review_count===1?"review":"reviews"]})]})]})})},ge.user_id))})]})]}),h&&u&&s.jsx(Bl,{isOpen:h,onClose:()=>{p(!1),f(null)},event:u,currentUserId:t,isInterested:g,onInterestToggle:ee,onReview:()=>{console.log("Review event:",u.id)},onNavigateToProfile:n,onNavigateToChat:a}),z&&s.jsx(a8e,{isOpen:A,onClose:()=>{R(!1),D(null),F("")},artistId:z,artistName:B,currentUserId:t}),U&&s.jsx(i8e,{isOpen:$,onClose:()=>{O(!1),G(null),K("")},venueId:U,venueName:q,currentUserId:t})]})},l8e=({currentUserId:e,onNavigateToProfile:t,onNavigateToChat:r})=>{const[n,a]=x.useState([]),[i,o]=x.useState(!0),[l,c]=x.useState(null);x.useEffect(()=>{d()},[e]);const d=()=>E(void 0,null,function*(){o(!0);try{const h=yield YY.getScenes(10,e);a(h)}catch(h){console.error("Error loading scenes:",h),a([])}finally{o(!1)}}),u=h=>{c(h)},f=()=>{c(null)};return l?s.jsx(o8e,{sceneId:l,userId:e,onBack:f,onNavigateToProfile:t,onNavigateToChat:r}):n.length===0&&!i?null:s.jsx(Tj,{title:"Scenes & Signals",description:"Music scenes defined by genre overlap, venue clusters, and co-attendance patterns",items:n.map(h=>s.jsx(GY,{scene:h,onClick:()=>u(h.id)},h.id)),loading:i,emptyMessage:"No scenes found",itemClassName:"w-[320px]"})};class FS{static getArtistTourEvents(t){return E(this,null,function*(){try{console.log(` [TOUR_TRACKER] Fetching tour events for artist ID: ${t}`);const{data:r,error:n}=yield T.from("artists").select("id, name, identifier").eq("id",t).single();if(n||!r)return console.error(" [TOUR_TRACKER] Artist not found:",n),[];console.log(` [TOUR_TRACKER] Found artist: ${r.name} (UUID: ${r.id}, Identifier: ${r.identifier})`);const{data:a,error:i}=yield T.from("events").select("*").eq("artist_id",r.id).gte("event_date",new Date().toISOString()).not("latitude","is",null).not("longitude","is",null).order("event_date",{ascending:!0});if(i)throw console.error(" [TOUR_TRACKER] Error fetching events:",i),i;return console.log(` [TOUR_TRACKER] Found ${(a==null?void 0:a.length)||0} upcoming events for ${r.name}`),(a||[]).map(o=>H(M({},o),{latitude:Number(o.latitude),longitude:Number(o.longitude),venue_city:o.venue_city||"",venue_state:o.venue_state||void 0}))}catch(r){return console.error("Error fetching artist tour events:",r),[]}})}static calculateTourRoute(t){const r=[...t].sort((a,i)=>{const o=new Date(a.event_date).getTime(),l=new Date(i.event_date).getTime();return o-l}),n=[];for(let a=0;a<r.length-1;a++){const i=r[a],o=r[a+1];i.latitude&&i.longitude&&o.latitude&&o.longitude&&n.push({from:{lat:i.latitude,lng:i.longitude,city:`${i.venue_city}${i.venue_state?`, ${i.venue_state}`:""}`},to:{lat:o.latitude,lng:o.longitude,city:`${o.venue_city}${o.venue_state?`, ${o.venue_state}`:""}`}})}return{events:r,route:n}}static getArtistGroupChats(t,r){return E(this,null,function*(){try{const n=[],{data:a}=yield T.from("artists").select("id, name, identifier").eq("id",t).single();if(!a)return console.warn(` [TOUR_TRACKER] Artist not found for ID: ${t}`),[];const i=a.name,{data:o,error:l}=yield T.from("chats").select("id, chat_name, users").ilike("chat_name",`%${i}%`).eq("is_group_chat",!0);if(!l&&o)for(const d of o){const u=Array.isArray(d.users)?d.users.length:0;n.push({id:d.id,name:d.chat_name||"Unnamed Chat",chat_id:d.id,member_count:u})}const{data:c}=yield T.from("events").select("id, title").eq("artist_id",a.id).gte("event_date",new Date().toISOString()).limit(10);if(c)for(const d of c){const{data:u}=yield T.from("chats").select("id, chat_name, users").ilike("chat_name",`%${d.title}%`).eq("is_group_chat",!0);if(u){for(const f of u)if(!n.find(h=>h.id===f.id)){const h=Array.isArray(f.users)?f.users.length:0;n.push({id:f.id,name:f.chat_name||"Unnamed Chat",chat_id:f.id,event_id:d.id,member_count:h})}}}return n}catch(n){return console.error("Error fetching artist group chats:",n),[]}})}}class c8e{constructor(){Cr(this,"pendingRequests",new Map);Cr(this,"REQUEST_TIMEOUT",3e4)}deduplicate(t,r){return E(this,null,function*(){this.cleanupExpiredRequests();const n=this.pendingRequests.get(t);if(n)return console.log(` Request deduplication: Reusing pending request for key: ${t}`),n.promise;console.log(` Request deduplication: Creating new request for key: ${t}`);const a=r().finally(()=>{this.pendingRequests.delete(t)});return this.pendingRequests.set(t,{promise:a,timestamp:Date.now()}),a})}cleanupExpiredRequests(){const t=Date.now();for(const[r,n]of this.pendingRequests.entries())t-n.timestamp>this.REQUEST_TIMEOUT&&(console.log(` Request deduplication: Cleaning up expired request for key: ${r}`),this.pendingRequests.delete(r))}clear(){console.log(` Request deduplication: Clearing ${this.pendingRequests.size} pending requests`),this.pendingRequests.clear()}getPendingCount(){return this.pendingRequests.size}}const d8e=new c8e,u8e={events:e=>`events_${e.userId||"anonymous"}_${e.limit||20}_${e.offset||0}`,promotions:e=>`promotions_${e.userId||"anonymous"}_${e.tier||"all"}_${e.limit||10}`,profile:e=>`profile_${e}`,reviews:e=>`reviews_${e.eventId||"all"}_${e.userId||"anonymous"}_${e.limit||20}`,friends:e=>`friends_${e}`,search:e=>`search_${e.query}_${e.type||"all"}_${e.limit||20}`,location:e=>`location_${e.lat}_${e.lng}_${e.radius||25}`},x$={basic:{name:"Basic",price:49.99,duration_days:7,features:["Homepage promotion","Search boost","Basic analytics","7-day duration"],color:"blue"},premium:{name:"Premium",price:149.99,duration_days:14,features:["Homepage featured section","Priority in search","Advanced analytics","Social media sharing","14-day duration"],color:"purple"},featured:{name:"Featured",price:499.99,duration_days:30,features:["Top homepage placement","Email newsletter feature","Premium badge","Full analytics suite","Dedicated support","30-day duration"],color:"gold"}};class h8e{static createPromotion(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("promote_event",{p_event_id:t.event_id,p_promotion_tier:t.promotion_tier,p_starts_at:t.starts_at,p_expires_at:t.expires_at,p_target_cities:t.target_cities||null,p_target_genres:t.target_genres||null});if(n)throw n;return r}catch(r){throw console.error("Error creating promotion:",r),r}})}static getUserPromotions(t){return E(this,null,function*(){const r=u8e.promotions({userId:t});return d8e.deduplicate(r,()=>E(this,null,function*(){try{const{data:{user:n},error:a}=yield T.auth.getUser();if(a||!n)throw new Error("User not authenticated");const i=t||n.id,{data:o,error:l}=yield T.from("event_promotions").select(`
            *,
            event:events(
              id,
              title,
              artist_name,
              venue_name,
              event_date,
              poster_image_url
            )
          `).eq("promoted_by_user_id",i).order("created_at",{ascending:!1});if(l)throw l;return o||[]}catch(n){throw console.error("Error fetching user promotions:",n),n}}))})}static getActivePromotions(t,r=10){return E(this,null,function*(){try{let n=T.from("event_promotions").select(`
          *,
          event:events(*)
        `).eq("promotion_status","active").lte("starts_at",new Date().toISOString()).gte("expires_at",new Date().toISOString()).order("created_at",{ascending:!1}).limit(r);t&&(n=n.eq("promotion_tier",t));const{data:a,error:i}=yield n;if(i)throw i;return a||[]}catch(n){throw console.error("Error fetching active promotions:",n),n}})}static getPromotion(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select(`
          *,
          event:events(*)
        `).eq("id",t).single();if(n)throw n;return r}catch(r){throw console.error("Error fetching promotion:",r),r}})}static getPendingPromotions(){return E(this,null,function*(){try{const{data:t,error:r}=yield T.from("event_promotions").select(`
          *,
          event:jambase_events(
            id,
            title,
            artist_name,
            venue_name,
            event_date,
            poster_image_url
          ),
          promoter:users!event_promotions_promoted_by_user_id_fkey(
            user_id,
            name,
            avatar_url,
            account_type
          )
        `).eq("promotion_status","pending").order("created_at",{ascending:!0});if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching pending promotions:",t),t}})}static reviewPromotion(t,r,n,a){return E(this,null,function*(){try{const{error:i}=yield T.rpc("review_event_promotion",{p_promotion_id:t,p_approved:r,p_admin_notes:n||null,p_rejection_reason:a||null});if(i)throw i}catch(i){throw console.error("Error reviewing promotion:",i),i}})}static cancelPromotion(t){return E(this,null,function*(){try{const{error:r}=yield T.from("event_promotions").update({promotion_status:"paused",updated_at:new Date().toISOString()}).eq("id",t);if(r)throw r}catch(r){throw console.error("Error canceling promotion:",r),r}})}static trackImpression(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("increment",{table_name:"event_promotions",row_id:t,column_name:"impressions"});if(r){const{data:n}=yield T.from("event_promotions").select("impressions").eq("id",t).single();n&&(yield T.from("event_promotions").update({impressions:(n.impressions||0)+1}).eq("id",t))}}catch(r){console.error("Error tracking impression:",r)}})}static trackClick(t){return E(this,null,function*(){try{const{data:r}=yield T.from("event_promotions").select("clicks").eq("id",t).single();r&&(yield T.from("event_promotions").update({clicks:(r.clicks||0)+1}).eq("id",t))}catch(r){console.error("Error tracking click:",r)}})}static trackConversion(t){return E(this,null,function*(){try{const{data:r}=yield T.from("event_promotions").select("conversions").eq("id",t).single();r&&(yield T.from("event_promotions").update({conversions:(r.conversions||0)+1}).eq("id",t))}catch(r){console.error("Error tracking conversion:",r)}})}static getPromotionAnalytics(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.from("event_promotions").select("impressions, clicks, conversions, price_paid").eq("id",t).single();if(n)throw n;const a=r.impressions>0?r.clicks/r.impressions*100:0,i=r.clicks>0?r.conversions/r.clicks*100:0,o=r.clicks>0?r.price_paid/r.clicks:0,l=r.conversions>0?r.price_paid/r.conversions:0;return H(M({},r),{ctr:a.toFixed(2),conversion_rate:i.toFixed(2),cost_per_click:o.toFixed(2),cost_per_conversion:l.toFixed(2)})}catch(r){throw console.error("Error fetching promotion analytics:",r),r}})}static getPromotionPricing(t){return x$[t].price}static getPromotionTierInfo(t){return x$[t]}static canPromoteEvent(t){return E(this,null,function*(){try{const{data:{user:r}}=yield T.auth.getUser();if(!r)return!1;const{data:n}=yield T.from("events").select("created_by_user_id").eq("id",t).single();return n?n.created_by_user_id===r.id:!1}catch(r){return console.error("Error checking promotion eligibility:",r),!1}})}}function f8e({promotionId:e,enabled:t=!0,threshold:r=1}){const n=x.useRef(null),a=x.useRef(null),i=x.useRef(!1),o=`promotion_impression_${e}`,l=x.useCallback(()=>E(this,null,function*(){if(!t||i.current)return;if(sessionStorage.getItem(o)){i.current=!0;return}try{yield h8e.trackImpression(e),sessionStorage.setItem(o,"true"),i.current=!0}catch(d){console.error("Error tracking promotion impression:",d)}}),[e,t,o]);return x.useEffect(()=>{if(!t||!n.current)return;const c=n.current;let d;const u=h=>{h[0].isIntersecting?a.current=Date.now():a.current=null};d=new IntersectionObserver(u,{threshold:.5,rootMargin:"0px"}),d.observe(c);const f=setInterval(()=>{a.current&&!i.current&&(Date.now()-a.current)/1e3>=r&&l()},500);return()=>{d.disconnect(),clearInterval(f)}},[t,r,l]),n}function m8e(e){return!e||e.trim()===""||e==="NULL"?"Venue TBD":e.trim()}function KY(e,t){const r=[];return e&&e.trim()!==""&&e!=="NULL"&&r.push(e.trim()),t&&t.trim()!==""&&t!=="NULL"&&r.push(t.trim()),r.length>0?r.join(", "):""}function p8e(e,t,r,n){const a=[];e&&e.trim()!==""&&e!=="NULL"&&a.push(e.trim());const i=KY(t,r);return i&&a.push(i),n&&n.trim()!==""&&n!=="NULL"&&a.push(n.trim()),a.length>0?a.join(", "):""}function vR({event:e,onInterestToggle:t,onReview:r,isInterested:n=!1,hasReviewed:a=!1,showInterestButton:i=!0,showReviewButton:o=!0,currentUserId:l,onOpenInterestedUsers:c,className:d,onClick:u}){const[f,h]=x.useState(!1),[p,g]=x.useState(null),[v,y]=x.useState(null),[_,w]=x.useState(!1),{toast:b}=Rr(),N=f8e({promotionId:e.active_promotion_id||"",enabled:e.is_promoted&&!!e.active_promotion_id}),S=U=>new Date(U).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),k=U=>new Date(U).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),P=U=>U?new Date(U).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):null,A=new Date(e.event_date)<new Date,R=new Date(e.event_date)>=new Date,$=U=>E(this,null,function*(){if(U.stopPropagation(),!(!t||f)){h(!0);try{yield t(e.id,!n)}catch(G){console.error("Error toggling interest:",G)}finally{h(!1)}}}),O=U=>{U.stopPropagation(),r&&r(e.id)},z=m8e(e.venue_name),D=KY(e.venue_city,e.venue_state),B=p8e(e.venue_address,e.venue_city,e.venue_state,e.venue_zip);x.useEffect(()=>{E(this,null,function*(){var G;try{const q=yield Qr.getInterestedCountsByEventId([e.id],l||void 0);g((G=q.get(e.id))!=null?G:0)}catch(q){console.error("Error fetching interested count:",q),g(null)}})},[e.id,l]),x.useEffect(()=>{E(this,null,function*(){var U,G,q,K;try{if(e.images&&Array.isArray(e.images)&&e.images.length>0){const Q=e.images.find(X=>X.url&&(X.ratio==="16_9"||X.width&&X.width>1e3))||e.images.find(X=>X.url);if(Q!=null&&Q.url){y(Pl(Q.url)||null);return}}const Z=yield T.from("reviews").select("photos").eq("event_id",e.id).not("photos","is",null).order("likes_count",{ascending:!1}).limit(1),Y=Array.isArray(Z.data)&&((G=(U=Z.data[0])==null?void 0:U.photos)==null?void 0:G[0]);if(Y){y(Pl(Y)||null);return}if(e.artist_name&&e.id){const Q=yield T.from("reviews").select("photos").not("photos","is",null).eq("event_id",e.id).order("likes_count",{ascending:!1}).limit(1),X=Array.isArray(Q.data)&&((K=(q=Q.data[0])==null?void 0:q.photos)==null?void 0:K[0]);if(X){y(Pl(X)||null);return}}}catch(Z){console.error("Error resolving event image:",Z)}y(null)})},[e.id,e.artist_id,e.artist_name,e.images]);const F=()=>{if(!e.ticket_urls||e.ticket_urls.length===0)return null;const U=["stubhub","vividseats","seatgeek","ticketmaster","axs"],G=e.ticket_urls.map(q=>({url:q,l:q.toLowerCase()}));for(const q of U){const K=G.find(Z=>Z.l.includes(q));if(K)return K.url}return e.ticket_urls[0]};return s.jsxs(He,{ref:N,className:ke("w-full transition-all duration-200 hover:shadow-lg",e.is_promoted&&"ring-2 ring-yellow-400/50 shadow-lg shadow-yellow-200/30 border-yellow-200/50",d),onClick:u,children:[v&&s.jsxs("div",{className:"h-48 w-full overflow-hidden rounded-t-lg relative",children:[s.jsx("img",{src:v,alt:e.title,className:"w-full h-full object-cover",loading:"lazy",onError:U=>{console.warn("Failed to load event image:",v),y(null)}}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/10 to-transparent pointer-events-none"})]}),s.jsx(Er,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx(qr,{className:"text-lg leading-tight mb-2",children:e.title}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-2",children:[s.jsx(It,{className:"w-4 h-4"}),s.jsx("span",{children:S(e.event_date)}),s.jsx("span",{children:""}),s.jsx(ga,{className:"w-4 h-4"}),s.jsx("span",{children:k(e.event_date)}),e.doors_time&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{children:["Doors: ",P(e.doors_time)]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[e.is_promoted&&e.promotion_tier&&s.jsx(E8,{promotionTier:e.promotion_tier}),A&&s.jsx(Ke,{variant:"secondary",className:"text-xs",children:"Past Event"}),R&&s.jsx(Ke,{variant:"default",className:"text-xs",children:"Upcoming"})]})]})}),s.jsxs(et,{className:"pt-0 space-y-4",children:[z&&s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(gr,{className:"w-4 h-4 text-muted-foreground mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"font-medium text-sm",children:z}),l&&e.venue_name&&e.venue_name!=="Venue TBD"&&s.jsx(g1,{venueName:e.venue_name,venueCity:e.venue_city,venueState:e.venue_state,userId:l,variant:"ghost",size:"sm",showFollowerCount:!1,className:"h-6 text-xs"})]}),B&&s.jsx("div",{className:"text-sm text-muted-foreground",children:B}),!B&&D&&s.jsx("div",{className:"text-sm text-muted-foreground",children:D})]})]}),e.latitude!=null&&e.longitude!=null&&!Number.isNaN(Number(e.latitude))&&!Number.isNaN(Number(e.longitude))&&s.jsx("div",{className:"h-40 rounded-md overflow-hidden border border-gray-100",children:s.jsx(kT,{center:[Number(e.latitude),Number(e.longitude)],zoom:12,events:[e],onEventClick:()=>{}})}),e.description&&s.jsx("div",{className:"text-sm text-muted-foreground leading-relaxed",children:e.description.length>200?`${e.description.substring(0,200)}...`:e.description}),e.artist_name&&s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx(Ke,{variant:"outline",className:"text-xs",children:e.artist_name})}),l&&s.jsx(Ky,{artistId:e.artist_id,artistName:e.artist_name,userId:l,variant:"ghost",size:"sm",showFollowerCount:!1,className:"h-7 text-xs"})]}),e.genres&&e.genres.length>0&&s.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.genres.slice(0,4).map((U,G)=>s.jsx(Ke,{variant:"secondary",className:"text-xs",children:U},G)),e.genres.length>4&&s.jsxs(Ke,{variant:"secondary",className:"text-xs",children:["+",e.genres.length-4," more"]})]}),e.tour_name&&s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Tour: "}),s.jsx("span",{className:"font-medium",children:e.tour_name})]}),e.price_range&&s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Price: "}),s.jsx("span",{className:"font-medium",children:Fv(e.price_range)})]}),l&&s.jsx("div",{className:"flex items-center justify-start pt-2 pb-2 border-t border-gray-100",children:s.jsx(S1,{entityType:"event",entityId:e.id,entityName:e.title,currentUserId:l,onChatOpen:U=>{window.location.href=`/chats?chatId=${U}`}})}),s.jsxs("div",{className:"flex items-center justify-between pt-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[R&&i&&t&&s.jsxs(le,{variant:n?"default":"outline",size:"sm",onClick:$,disabled:f,className:ke("transition-colors",n?"bg-red-500 hover:bg-red-600 text-white":"hover:bg-red-50 hover:text-red-600 hover:border-red-300"),children:[n?s.jsx(ns,{className:"w-4 h-4 mr-1 fill-current"}):s.jsx(NQ,{className:"w-4 h-4 mr-1"}),n?"Interested":"Interested?"]}),A&&o&&r&&s.jsxs(le,{variant:a?"default":"outline",size:"sm",onClick:O,className:ke("transition-colors",a?"bg-yellow-500 hover:bg-yellow-600 text-white":"hover:bg-yellow-50 hover:text-yellow-600 hover:border-yellow-300"),children:[a?s.jsx(Qt,{className:"w-4 h-4 mr-1 fill-current"}):s.jsx(zQ,{className:"w-4 h-4 mr-1"}),a?"Reviewed":"I Was There"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(O1,{children:[s.jsx(M1,{asChild:!0,children:s.jsxs(le,{variant:"ghost",size:"sm",onClick:U=>{U.stopPropagation()},className:"text-pink-600 hover:text-pink-700 hover:bg-pink-50",children:[s.jsx(zd,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline ml-1",children:"Share"})]})}),s.jsxs(tx,{align:"end",className:"w-52 bg-white/95 backdrop-blur-sm border shadow-lg z-50",children:[l&&s.jsxs(Hi,{onClick:U=>{U.stopPropagation(),w(!0)},className:"cursor-pointer bg-white hover:bg-gray-50",children:[s.jsx(zr,{className:"w-4 h-4 mr-2"}),"Share with Synth Friends"]}),s.jsxs(Hi,{onClick:U=>E(this,null,function*(){U.stopPropagation();try{const G=yield ev.shareEvent(e.id,e.title,e.description||void 0);navigator.share?yield navigator.share({title:e.title,text:e.description||"Check out this event!",url:G}):(yield navigator.clipboard.writeText(G),b({title:"Link copied",description:G}))}catch(G){try{const q=yield ev.shareEvent(e.id,e.title,e.description||void 0);yield navigator.clipboard.writeText(q),b({title:"Link copied",description:q})}catch(q){b({title:"Error",description:"Failed to share",variant:"destructive"})}}}),className:"cursor-pointer bg-white hover:bg-gray-50",children:[s.jsx(Ki,{className:"w-4 h-4 mr-2"}),"Share"]}),s.jsxs(Hi,{onClick:U=>E(this,null,function*(){U.stopPropagation();try{const G=yield ev.shareEvent(e.id,e.title,e.description||void 0);yield navigator.clipboard.writeText(G),b({title:"Link copied",description:G})}catch(G){b({title:"Error",description:"Failed to copy link",variant:"destructive"})}}),className:"cursor-pointer bg-white hover:bg-gray-50",children:[s.jsx(zd,{className:"w-4 h-4 mr-2"}),"Copy Link"]})]})]}),e.ticket_urls&&e.ticket_urls.length>0&&s.jsx(le,{variant:"ghost",size:"sm",asChild:!0,className:"text-blue-600 hover:text-blue-700",children:s.jsxs("a",{href:F()||e.ticket_urls[0],target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1",onClick:()=>{try{On.click("ticket",e.id,{providerUrl:F()||e.ticket_urls[0]})}catch(U){}},children:[s.jsx(Ml,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Tickets"}),s.jsx(Bo,{className:"w-3 h-3"})]})})]})]}),s.jsxs("div",{className:"mt-3 flex items-center justify-between rounded-md border p-2",children:[s.jsx("div",{className:"text-sm text-muted-foreground",children:p===null?"Loading people going":`${p} others are interested`}),c&&s.jsx(le,{size:"sm",variant:"outline",onClick:()=>c(e.id),children:"Meet people going"})]}),e.setlist&&s.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[s.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Setlist Preview:"}),s.jsx("div",{className:"text-sm",children:typeof e.setlist=="string"?e.setlist.substring(0,100)+"...":JSON.stringify(e.setlist).substring(0,100)+"..."})]})]}),l&&s.jsx(ET,{event:e,currentUserId:l,isOpen:_,onClose:()=>w(!1)})]})}const Sc=({event:e,interestedCount:t=0,isInterested:r=!1,isCommunityPhoto:n=!1,onInterestClick:a,onShareClick:i,onClick:o,className:l})=>{const c=e.poster_image_url||e.image_url,d=c?Pl(c):null;return e.event_date&&new Date(e.event_date),s.jsxs("div",{className:ke("flex flex-col rounded-lg overflow-hidden","hover:shadow-lg transition-all duration-200","relative group cursor-pointer",l),style:{backgroundColor:"var(--neutral-100)",border:"1px solid var(--neutral-200)"},onClick:o,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),o==null||o())},tabIndex:0,role:"button","aria-label":`View event: ${e.title}`,children:[s.jsx("div",{className:"relative w-full aspect-square",style:{outline:"none"},children:d?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:d,alt:e.title,className:"w-full h-full object-cover"}),n&&s.jsx("div",{className:"absolute top-2 right-2 flex items-center","aria-hidden":"true",style:{display:"flex",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",alignItems:"center",gap:"var(--spacing-small, 12px)",borderRadius:"10px",background:"var(--neutral-50)",boxShadow:"0 4px 4px 0 var(--shadow-color)"},children:s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-medium-weight, 500)",color:"var(--neutral-900)",lineHeight:"1",whiteSpace:"nowrap"},children:"Community Photo"})})]}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",style:{backgroundColor:"var(--neutral-100)"},children:s.jsx("div",{className:"text-center px-2",children:s.jsx("p",{className:"text-xs font-semibold line-clamp-2",style:{color:"var(--brand-pink-500)"},children:e.title})})})}),s.jsxs("div",{className:"px-2",style:{backgroundColor:"var(--neutral-50)",paddingTop:"var(--spacing-small, 12px)",paddingBottom:"var(--spacing-small, 12px)",display:"flex",flexDirection:"column",flexGrow:1},children:[s.jsx("p",{className:"text-sm font-semibold line-clamp-2 leading-tight",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",marginBottom:"var(--spacing-inline, 6px)"},children:e.title}),s.jsxs("div",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[t," interested"]}),s.jsxs("div",{className:"flex items-center justify-between",style:{width:"100%",marginTop:"auto",paddingTop:"var(--spacing-small, 12px)"},children:[s.jsxs("button",{onClick:u=>{u.stopPropagation(),a==null||a(u)},style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",border:r?"none":"2px solid var(--brand-pink-500)",backgroundColor:r?"var(--brand-pink-500)":"var(--neutral-50)",color:r?"var(--neutral-50)":"var(--brand-pink-500)",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 4px 0 var(--shadow-color)",display:"flex",alignItems:"center",gap:"var(--spacing-inline, 6px)"},onMouseEnter:u=>{r?u.currentTarget.style.backgroundColor="var(--brand-pink-600)":(u.currentTarget.style.backgroundColor="var(--brand-pink-050)",u.currentTarget.style.borderColor="var(--brand-pink-600)")},onMouseLeave:u=>{r?u.currentTarget.style.backgroundColor="var(--brand-pink-500)":(u.currentTarget.style.backgroundColor="var(--neutral-50)",u.currentTarget.style.borderColor="var(--brand-pink-500)")},"aria-label":r?"Remove interest":"Mark as interested",children:["Interested",r&&s.jsx(ta,{size:16,style:{color:"var(--neutral-50)",flexShrink:0},"aria-hidden":"true"})]}),s.jsx("button",{onClick:u=>{u.stopPropagation(),i==null||i(u)},style:{width:"44px",height:"44px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent",border:"none",cursor:"pointer",borderRadius:"var(--radius-corner, 10px)",color:"var(--neutral-900)",transition:"background-color 0.2s ease"},onMouseEnter:u=>{u.currentTarget.style.backgroundColor="var(--brand-pink-050)"},onMouseLeave:u=>{u.currentTarget.style.backgroundColor="transparent"},"aria-label":"Share event",children:s.jsx(Fc,{size:24,strokeWidth:2})})]})]})]})},g8e=e=>ya.divIcon({className:"numbered-marker",html:`<div style="
      background-color: #ec4899;
      color: white;
      border: 2px solid white;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    ">${e}</div>`,iconSize:[32,32],iconAnchor:[16,16]}),v8e=({events:e})=>{const t=kh();return x.useEffect(()=>{if(e.length===0)return;const r=ya.latLngBounds(e.map(n=>[n.latitude,n.longitude]));r.isValid()&&t.fitBounds(r,{padding:[50,50]})},[t,e]),null},y8e=({currentUserId:e,filters:t,onNavigateToProfile:r,onNavigateToChat:n})=>{const a=as(),[i,o]=x.useState("calendar"),[l,c]=x.useState(new Date),[d,u]=x.useState(new Map),[f,h]=x.useState(void 0),[p,g]=x.useState([]),[v,y]=x.useState(!1),[_,w]=x.useState(null),[b,N]=x.useState([]),[S,k]=x.useState([]),[P,A]=x.useState([]),[R,$]=x.useState(!1),[O,z]=x.useState(null),[D,B]=x.useState(!1),[F,U]=x.useState(new Set),[G,q]=x.useState(new Map),K=x.useRef(""),Z=x.useRef(!1),Y=x.useCallback(()=>E(void 0,null,function*(){y(!0);try{const V=new Date;V.setHours(0,0,0,0),console.log(" [CALENDAR] Loading upcoming events with optimized spatial filtering");let ue=[];if(t!=null&&t.latitude&&(t!=null&&t.longitude)&&(t!=null&&t.radiusMiles)){console.log(" [CALENDAR] Using RPC function with spatial index");const{data:ae,error:we}=yield T.rpc("get_calendar_events",{p_latitude:t.latitude,p_longitude:t.longitude,p_radius_miles:t.radiusMiles,p_min_date:V.toISOString(),p_genres:t!=null&&t.genres&&t.genres.length>0?t.genres:null,p_limit:1500});if(we)throw we;ue=ae||[],console.log(` [CALENDAR] Loaded ${ue.length} events within ${t.radiusMiles} miles (using spatial index)`)}else if(t!=null&&t.cities&&t.cities.length>0){let ae=T.from("events").select("*").gte("event_date",V.toISOString()).in("venue_city",t.cities);t!=null&&t.genres&&t.genres.length>0&&(ae=ae.overlaps("genres",t.genres),console.log(" [CALENDAR] Applied genre filters:",t.genres));const{data:we,error:oe}=yield ae.order("event_date",{ascending:!0}).limit(1e4);if(oe)throw oe;ue=we||[],console.log(" [CALENDAR] City filter:",ue.length,"events")}else{console.log(" [CALENDAR] Using RPC function without location filter");const{data:ae,error:we}=yield T.rpc("get_calendar_events",{p_latitude:null,p_longitude:null,p_radius_miles:null,p_min_date:V.toISOString(),p_genres:t!=null&&t.genres&&t.genres.length>0?t.genres:null,p_limit:1e4});if(we)throw we;ue=ae||[],console.log(" [CALENDAR] No location filter:",ue.length,"events")}console.log(` [CALENDAR] Final count: ${ue.length} events`);const _e=new Map;ue.forEach(ae=>{const we=new Date(ae.event_date),oe=Mt(we,"yyyy-MM-dd");_e.has(oe)||_e.set(oe,[]),_e.get(oe).push(ae)}),console.log(` [CALENDAR] Grouped events into ${_e.size} unique dates`),u(_e)}catch(V){console.error("Error loading calendar events:",V)}finally{y(!1)}}),[t==null?void 0:t.latitude,t==null?void 0:t.longitude,t==null?void 0:t.radiusMiles,t==null?void 0:t.cities,t==null?void 0:t.genres]);x.useEffect(()=>{if(i!=="calendar")return;const V=JSON.stringify({lat:t==null?void 0:t.latitude,lng:t==null?void 0:t.longitude,radius:t==null?void 0:t.radiusMiles,cities:t==null?void 0:t.cities,genres:t==null?void 0:t.genres});if(V===K.current)return;const ue=(t==null?void 0:t.latitude)&&(t==null?void 0:t.longitude)&&(t==null?void 0:t.radiusMiles),_e=(t==null?void 0:t.cities)&&t.cities.length>0;if(!ue&&!_e&&Z.current){console.log(" [CALENDAR] Skipping load - filters cleared but we already have data");return}if(!ue&&!_e&&!Z.current){console.log(" [CALENDAR] Skipping initial load - waiting for filters to be set");return}K.current=V,Z.current=!0,Y()},[i,t==null?void 0:t.latitude,t==null?void 0:t.longitude,t==null?void 0:t.radiusMiles,t==null?void 0:t.cities,t==null?void 0:t.genres,Y]),x.useEffect(()=>{i==="tour"&&_&&Q()},[i,_]);const Q=()=>E(void 0,null,function*(){if(!(!_||!_.id)){$(!0);try{const V=yield FS.getArtistTourEvents(_.id);N(V);const ue=FS.calculateTourRoute(V);k(ue.route);const _e=yield FS.getArtistGroupChats(_.id,e);A(_e),e&&V.length>0&&(yield X(V.map(ae=>ae.id)))}catch(V){console.error("Error loading tour data:",V)}finally{$(!1)}}}),X=V=>E(void 0,null,function*(){if(!(!e||V.length===0))try{const ue=yield Qr.getUserInterestedEventIdSet(e,V);U(ue);const _e=yield Qr.getInterestedCountsByEventId(V);q(_e)}catch(ue){console.error("Error loading interested data:",ue)}}),ne=V=>{if(h(V),!V){g([]);return}};x.useEffect(()=>{if(!f){g([]);return}const V=Mt(f,"yyyy-MM-dd"),_e=[...d.get(V)||[]].sort((ae,we)=>new Date(ae.event_date).getTime()-new Date(we.event_date).getTime());g(_e)},[d,f]);const re=V=>{const ue=Mt(V,"yyyy-MM-dd");return d.get(ue)||[]},ye=V=>{z(V),B(!0)},ee=b.length>0?[...b].sort((V,ue)=>new Date(V.event_date).getTime()-new Date(ue.event_date).getTime()):[],de=V=>`${V.venue_name||""}|${V.venue_city||""}|${V.venue_state||""}`.toLowerCase(),xe=J.useMemo(()=>{if(ee.length===0)return[];const V=[],ue=new Set;let _e=1;for(const ae of ee){const we=de(ae);if(V.findIndex(ce=>ce.venueKey===we)===-1)V.push({venueKey:we,venueName:ae.venue_name||"Unknown Venue",venueCity:ae.venue_city||"",venueState:ae.venue_state,latitude:ae.latitude,longitude:ae.longitude,number:_e++,events:[ae],firstEventDate:new Date(ae.event_date)}),ue.add(we);else{const ce=V[V.length-1];ce.venueKey===we?ce.events.push(ae):V.push({venueKey:we,venueName:ae.venue_name||"Unknown Venue",venueCity:ae.venue_city||"",venueState:ae.venue_state,latitude:ae.latitude,longitude:ae.longitude,number:_e++,events:[ae],firstEventDate:new Date(ae.event_date)})}}return V},[ee]);J.useMemo(()=>{const V=new Map;return xe.forEach(ue=>{ue.events.forEach(_e=>{V.set(_e.id,ue.number)})}),V},[xe]);const ie=J.useMemo(()=>{if(xe.length<2)return[];const V=[];for(let ue=0;ue<xe.length-1;ue++){const _e=xe[ue],ae=xe[ue+1];V.push({from:{lat:_e.latitude,lng:_e.longitude,city:`${_e.venueCity}${_e.venueState?`, ${_e.venueState}`:""}`},to:{lat:ae.latitude,lng:ae.longitude,city:`${ae.venueCity}${ae.venueState?`, ${ae.venueState}`:""}`}})}return V},[xe]),se=()=>{if(b.length===0)return[39.8283,-98.5795];const V=b.reduce((_e,ae)=>_e+ae.latitude,0)/b.length,ue=b.reduce((_e,ae)=>_e+ae.longitude,0)/b.length;return[V,ue]};return s.jsxs("div",{className:"mb-2 space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:"Discover Events"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Discover events by date, leaderboards, or artist tour"})]})}),s.jsxs(Li,{value:i,onValueChange:V=>o(V),children:[s.jsxs(yi,{className:"grid w-full grid-cols-3",children:[s.jsxs(Xr,{value:"calendar",className:"flex items-center gap-2",children:[s.jsx(Se,{name:"calendar",size:16}),"Calendar"]}),s.jsxs(Xr,{value:"leaderboards",className:"flex items-center gap-2",children:[s.jsx(Se,{name:"ribbonAward",size:16}),"Leaderboards"]}),s.jsxs(Xr,{value:"tour",className:"flex items-center gap-2",children:[s.jsx(Se,{name:"route",size:16}),"Tour Tracker"]})]}),s.jsx(Jr,{value:"calendar",className:"mt-4",children:v?s.jsx(Rd,{text:"Loading calendar...",size:"lg"}):s.jsxs("div",{className:"space-y-4 flex flex-col items-center justify-center",children:[s.jsx("div",{className:"flex justify-center w-full",children:s.jsx(ax,{mode:"single",selected:f,onSelect:ne,month:l,onMonthChange:c,className:"rounded-md border",numberOfMonths:1,disabled:V=>{const ue=new Date;ue.setHours(0,0,0,0);const _e=new Date(V);return _e.setHours(0,0,0,0),_e<ue},modifiers:{hasEvents:V=>re(V).length>0},modifiersClassNames:{hasEvents:"bg-synth-pink/20 border-synth-pink"}})}),f&&p.length>0&&s.jsxs("div",{className:"mt-4 space-y-2 w-full max-w-2xl",children:[s.jsxs("h3",{className:"font-semibold",children:["Events on ",Mt(f,"MMMM d, yyyy")]}),s.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto",children:p.map(V=>s.jsx(He,{className:"cursor-pointer hover:shadow-md",onClick:()=>ye(V),children:s.jsx(et,{className:"p-4",children:s.jsx("div",{className:"flex items-start justify-between",children:s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold",children:V.title}),s.jsx("p",{className:"text-sm text-muted-foreground",children:V.venue_name}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:Mt(new Date(V.event_date),"MMMM d, yyyy  h:mm a")})]})})})},V.id))})]}),f&&p.length===0&&!v&&s.jsx("div",{className:"mt-4 text-center text-muted-foreground",children:s.jsx("p",{children:"No events found for the selected date."})})]})}),s.jsx(Jr,{value:"leaderboards",className:"mt-4",children:s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(Se,{name:"ribbonAward",size:60,className:"mx-auto",color:"var(--neutral-600)"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Leaderboards are still in development"})]})})}),s.jsx(Jr,{value:"tour",className:"mt-4",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search for an Artist"}),s.jsx(h1,{onArtistSelect:V=>w(V),placeholder:"Search for an artist to track their tour..."})]}),_&&s.jsx(He,{className:"overflow-hidden border-2 border-synth-pink/20 shadow-lg cursor-pointer hover:shadow-xl transition-shadow",onClick:()=>{const V=_.id||encodeURIComponent(_.name);a(`/artist/${V}`)},children:s.jsx("div",{className:"relative p-6",style:{background:"linear-gradient(135deg, rgba(255, 51, 153, 0.1) 0%, rgba(255, 51, 153, 0.05) 100%)"},children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex-shrink-0",children:[_.image_url?s.jsx("img",{src:_.image_url,alt:_.name,className:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-lg",onError:V=>{var _e;const ue=V.target;ue.style.display="none",(_e=ue.nextElementSibling)==null||_e.classList.remove("hidden")}}):null,!_.image_url&&s.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-synth-pink to-purple-500 flex items-center justify-center border-4 border-white shadow-lg",children:s.jsx(Se,{name:"music",size:60,color:"var(--neutral-50)"})})]}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2 truncate",children:_.name}),s.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[b.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Se,{name:"calendar",size:16,color:"var(--brand-pink-500)"}),s.jsxs("span",{className:"text-sm font-medium text-foreground",children:[b.length," ",b.length===1?"Tour Date":"Tour Dates"]})]}),_.genres&&_.genres.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Se,{name:"music",size:16,color:"var(--brand-pink-500)"}),s.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[_.genres.slice(0,3).map((V,ue)=>s.jsx(Ke,{variant:"secondary",className:"text-xs bg-white/80 text-foreground border-synth-pink/20",children:V},ue)),_.genres.length>3&&s.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",_.genres.length-3," more"]})]})]})]})]}),s.jsx(le,{variant:"ghost",size:"sm",onClick:V=>{V.stopPropagation(),w(null),N([]),k([]),A([])},className:"flex-shrink-0 text-muted-foreground hover:text-foreground",children:s.jsx(Se,{name:"x",size:16,color:"var(--neutral-600)"})})]})})]})})}),R?s.jsx(Rd,{text:"Loading tour data...",size:"lg"}):_&&b.length>0?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"h-96 rounded-lg overflow-hidden border relative z-0",children:s.jsxs(Xy,{center:se(),zoom:5,style:{height:"100%",width:"100%",zIndex:0},boundsOptions:{padding:[50,50]},children:[s.jsx(Jy,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(v8e,{events:ee}),ie.map((V,ue)=>{const _e=V.from.lat,ae=V.from.lng,we=V.to.lat,oe=V.to.lng,ce=we-_e,Ae=oe-ae,Be=_e+ce*.85,Xe=ae+Ae*.85,Ue=`
                        <svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
                          <g transform="translate(10,10) rotate(${Math.atan2(ce,Ae)*180/Math.PI}) translate(-10,-10)">
                            <polygon points="10,2 4,16 16,16" fill="#ec4899" stroke="white" stroke-width="1.5"/>
                          </g>
                        </svg>
                      `;return s.jsxs(J.Fragment,{children:[s.jsx(zB,{positions:[[_e,ae],[we,oe]],pathOptions:{color:"#ec4899",weight:3,opacity:.7}}),s.jsx(ch,{position:[Be,Xe],icon:ya.divIcon({className:"arrowhead-marker",html:Ue,iconSize:[20,20],iconAnchor:[10,10]})})]},ue)}),xe.map(V=>s.jsx(ch,{position:[V.latitude,V.longitude],icon:g8e(V.number),eventHandlers:{click:()=>{V.events.length>0&&ye(V.events[0])}}},`${V.venueKey}-${V.number}`))]})}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("h3",{className:"font-semibold mb-3",children:["Tour Dates (",ee.length,")"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 max-h-96 overflow-y-auto",children:ee.map(V=>{var ae,we,oe,ce;const ue=F.has(V.id),_e=G.get(V.id)||0;return s.jsx(Sc,{event:{id:V.id,title:V.title||"",artist_name:V.artist_name,venue_name:V.venue_name,event_date:V.event_date,venue_city:V.venue_city,image_url:(we=(ae=V.images)==null?void 0:ae[0])==null?void 0:we.url,poster_image_url:(ce=(oe=V.images)==null?void 0:oe[0])==null?void 0:ce.url},interestedCount:_e,isInterested:ue,onInterestClick:Ae=>E(void 0,null,function*(){if(Ae.stopPropagation(),!e)return;const Be=!ue;U(Xe=>{const ge=new Set(Xe);return Be?ge.add(V.id):ge.delete(V.id),ge});try{yield Qr.setEventInterest(e,V.id,Be),q(Xe=>{const ge=new Map(Xe),We=ge.get(V.id)||0;return ge.set(V.id,Be?We+1:Math.max(0,We-1)),ge})}catch(Xe){console.error("Error toggling interest:",Xe),U(ge=>{const We=new Set(ge);return ue?We.add(V.id):We.delete(V.id),We})}}),onClick:()=>ye(V)},V.id)})})]}),P.length>0&&s.jsxs("div",{className:"mt-4",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Related Group Chats"}),s.jsx("div",{className:"grid grid-cols-1 gap-2",children:P.map(V=>s.jsx(He,{className:"cursor-pointer hover:shadow-md",onClick:()=>n&&V.chat_id&&n(V.chat_id),children:s.jsx(et,{className:"p-4",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold",children:V.name}),V.member_count!==void 0&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[V.member_count," members"]})]})})})},V.id))})]})]}):_?s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsxs("p",{children:["No upcoming events found for ",_.name]})}):s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:"Search for an artist to see their tour route"})})]})})]}),s.jsx(pn,{open:D,onOpenChange:B,children:s.jsx(dn,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:O&&s.jsx(vR,{event:O,currentUserId:e,onInterestToggle:()=>E(void 0,null,function*(){}),onReview:()=>E(void 0,null,function*(){}),isInterested:!1,hasReviewed:!1,showInterestButton:!0,showReviewButton:!0})})})]})},Mf=class Mf{static searchCity(t){const r=t.toLowerCase().trim();return this.CITY_COORDINATES[r]||null}static getAllCities(){return Object.values(this.CITY_COORDINATES)}static searchEventsByLocation(t){return E(this,null,function*(){try{const{latitude:r,longitude:n,radius:a,limit:i=50,startDate:o,endDate:l}=t,c=a/69,d=a/(69*Math.cos(r*Math.PI/180)),u=r-c,f=r+c,h=n-d,p=n+d;let g=T.from("events").select("*").not("latitude","is",null).not("longitude","is",null).gte("latitude",u).lte("latitude",f).gte("longitude",h).lte("longitude",p).gte("event_date",new Date().toISOString());o&&(g=g.gte("event_date",o)),l&&(g=g.lte("event_date",l)),!o&&!l&&(g=g.gte("event_date",new Date().toISOString()));const{data:v,error:y}=yield g.order("event_date",{ascending:!0}).limit(i);if(y)throw y;return(v||[]).map(b=>({id:b.id,jambase_event_id:b.jambase_event_id,title:b.title,artist_name:b.artist_name,artist_id:b.artist_id||"",venue_name:b.venue_name,venue_id:b.venue_id||"",event_date:b.event_date,doors_time:b.doors_time,description:b.description,genres:b.genres,venue_address:b.venue_address,venue_city:b.venue_city,venue_state:b.venue_state,venue_zip:b.venue_zip,latitude:b.latitude?Number(b.latitude):void 0,longitude:b.longitude?Number(b.longitude):void 0,ticket_available:b.ticket_available,price_range:b.price_range,ticket_urls:b.ticket_urls,setlist:b.setlist,tour_name:b.tour_name,created_at:b.created_at,updated_at:b.updated_at})).map(b=>H(M({},b),{distance:Mf.calculateDistance(r,n,b.latitude||0,b.longitude||0)})).filter(b=>b.distance<=a).sort((b,N)=>b.distance-N.distance)}catch(r){throw console.error("Error searching events by location:",r),new Error(`Failed to search events by location: ${r instanceof Error?r.message:"Unknown error"}`)}})}static calculateDistance(t,r,n,a){const o=f=>f*(Math.PI/180),l=o(n-t),c=o(a-r),d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(o(t))*Math.cos(o(n))*Math.sin(c/2)*Math.sin(c/2);return 3959*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}static toRadians(t){return t*(Math.PI/180)}static getCurrentLocation(){return E(this,null,function*(){return new Promise((t,r)=>{if(!navigator.geolocation){r(new Error("Geolocation is not supported by this browser"));return}navigator.geolocation.getCurrentPosition(n=>{t({latitude:n.coords.latitude,longitude:n.coords.longitude})},n=>{r(new Error(`Failed to get location: ${n.message}`))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})})})}static reverseGeocode(t,r){return E(this,null,function*(){try{let n=null;const a=Object.values(this.CITY_COORDINATES);for(const l of a){const c=Mf.calculateDistance(t,r,l.lat,l.lng);(!n||c<n.distance)&&(n={name:l.state?`${l.name}, ${l.state}`:l.name,distance:c})}if(n&&n.distance<=25)return n.name;const i=yield fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${t}&lon=${r}&zoom=10&addressdetails=1`,{headers:{"User-Agent":"Synth-App/1.0"}});if(!i.ok)return console.warn("Reverse geocoding API failed, using nearest city fallback"),(n==null?void 0:n.name)||null;const o=yield i.json();if(o&&o.address){const l=o.address.city||o.address.town||o.address.village||o.address.municipality,c=o.address.state;if(l)return c?`${l}, ${c}`:l}return(n==null?void 0:n.name)||null}catch(n){console.error("Error in reverse geocoding:",n);let a=null;const i=Object.values(this.CITY_COORDINATES);for(const o of i){const l=Mf.calculateDistance(t,r,o.lat,o.lng);(!a||l<a.distance)&&(a={name:o.state?`${o.name}, ${o.state}`:o.name,distance:l})}return(a==null?void 0:a.name)||null}})}static searchEventsByCity(t,r=25,n=50){return E(this,null,function*(){const a=this.searchCity(t);return a?{events:yield this.searchEventsByLocation({latitude:a.lat,longitude:a.lng,radius:r,limit:n}),city:a}:{events:[],city:null}})}};Cr(Mf,"CITY_COORDINATES",{"new york":{name:"New York",lat:40.7128,lng:-74.006,state:"NY"},"los angeles":{name:"Los Angeles",lat:34.0522,lng:-118.2437,state:"CA"},chicago:{name:"Chicago",lat:41.8781,lng:-87.6298,state:"IL"},houston:{name:"Houston",lat:29.7604,lng:-95.3698,state:"TX"},phoenix:{name:"Phoenix",lat:33.4484,lng:-112.074,state:"AZ"},philadelphia:{name:"Philadelphia",lat:39.9526,lng:-75.1652,state:"PA"},"san antonio":{name:"San Antonio",lat:29.4241,lng:-98.4936,state:"TX"},"san diego":{name:"San Diego",lat:32.7157,lng:-117.1611,state:"CA"},dallas:{name:"Dallas",lat:32.7767,lng:-96.797,state:"TX"},austin:{name:"Austin",lat:30.2672,lng:-97.7431,state:"TX"},"washington dc":{name:"Washington DC",lat:38.9072,lng:-77.0369,state:"DC"},boston:{name:"Boston",lat:42.3601,lng:-71.0589,state:"MA"},denver:{name:"Denver",lat:39.7392,lng:-104.9903,state:"CO"},seattle:{name:"Seattle",lat:47.6062,lng:-122.3321,state:"WA"},"san francisco":{name:"San Francisco",lat:37.7749,lng:-122.4194,state:"CA"},miami:{name:"Miami",lat:25.7617,lng:-80.1918,state:"FL"},atlanta:{name:"Atlanta",lat:33.749,lng:-84.388,state:"GA"},nashville:{name:"Nashville",lat:36.1627,lng:-86.7816,state:"TN"},portland:{name:"Portland",lat:45.5152,lng:-122.6784,state:"OR"},"las vegas":{name:"Las Vegas",lat:36.1699,lng:-115.1398,state:"NV"},detroit:{name:"Detroit",lat:42.3314,lng:-83.0458,state:"MI"},memphis:{name:"Memphis",lat:35.1495,lng:-90.049,state:"TN"},baltimore:{name:"Baltimore",lat:39.2904,lng:-76.6122,state:"MD"},milwaukee:{name:"Milwaukee",lat:43.0389,lng:-87.9065,state:"WI"},albuquerque:{name:"Albuquerque",lat:35.0844,lng:-106.6504,state:"NM"},tucson:{name:"Tucson",lat:32.2226,lng:-110.9747,state:"AZ"},fresno:{name:"Fresno",lat:36.7378,lng:-119.7871,state:"CA"},sacramento:{name:"Sacramento",lat:38.5816,lng:-121.4944,state:"CA"},"kansas city":{name:"Kansas City",lat:39.0997,lng:-94.5786,state:"MO"},mesa:{name:"Mesa",lat:33.4152,lng:-111.8315,state:"AZ"},"virginia beach":{name:"Virginia Beach",lat:36.8529,lng:-75.978,state:"VA"},omaha:{name:"Omaha",lat:41.2524,lng:-95.998,state:"NE"},"colorado springs":{name:"Colorado Springs",lat:38.8339,lng:-104.8214,state:"CO"},raleigh:{name:"Raleigh",lat:35.7796,lng:-78.6382,state:"NC"},"long beach":{name:"Long Beach",lat:33.7701,lng:-118.1937,state:"CA"}});let za=Mf;const fC=Object.freeze(Object.defineProperty({__proto__:null,LocationService:za},Symbol.toStringTag,{value:"Module"})),x8e=({currentUserId:e,onBack:t,onNavigateToNotifications:r,onNavigateToProfile:n,onNavigateToChat:a,onViewChange:i,menuOpen:o=!1,onMenuClick:l,hideHeader:c=!1})=>{const[d,u]=x.useState(""),[f,h]=x.useState(!1),[p,g]=x.useState(!1),[v,y]=x.useState(null),[_,w]=x.useState(!1),[b,N]=x.useState({radiusMiles:30}),[S,k]=x.useState(!1),[P,A]=x.useState(""),[R,$]=x.useState(""),[O,z]=x.useState(!1),[D,B]=x.useState(null);x.useEffect(()=>{const X=()=>{w(window.innerWidth<768)};return X(),window.addEventListener("resize",X),()=>window.removeEventListener("resize",X)},[]),x.useEffect(()=>{F()},[e]);const F=()=>E(void 0,null,function*(){try{const{data:X}=yield T.from("users").select("latitude, longitude, location_city").eq("user_id",e).single();if(X!=null&&X.latitude&&(X!=null&&X.longitude)){const ne={latitude:X.latitude,longitude:X.longitude};B(ne),N(re=>H(M({},re),{latitude:ne.latitude,longitude:ne.longitude,radiusMiles:30})),$(X.location_city||"Current Location")}else try{const ne=yield za.getCurrentLocation();B(ne),N(re=>H(M({},re),{latitude:ne.latitude,longitude:ne.longitude,radiusMiles:30}));try{const re=yield za.reverseGeocode(ne.latitude,ne.longitude);$(re||"Current Location")}catch(re){console.error("Error reverse geocoding:",re),$("Current Location")}}catch(ne){console.error("Error getting current location:",ne)}}catch(X){console.error("Error loading user location:",X);try{const ne=yield za.getCurrentLocation();B(ne),N(re=>H(M({},re),{latitude:ne.latitude,longitude:ne.longitude,radiusMiles:30}));try{const re=yield za.reverseGeocode(ne.latitude,ne.longitude);$(re||"Current Location")}catch(re){console.error("Error reverse geocoding:",re),$("Current Location")}}catch(ne){console.error("Error getting current location:",ne)}}}),U=X=>{y(X)},G=()=>{y(null)},q=()=>E(void 0,null,function*(){z(!0);try{const X=yield za.getCurrentLocation();B(X),N(H(M({},b),{latitude:X.latitude,longitude:X.longitude,radiusMiles:b.radiusMiles||30}));try{const ne=yield za.reverseGeocode(X.latitude,X.longitude);$(ne||"Current Location")}catch(ne){console.error("Error reverse geocoding:",ne),$("Current Location")}k(!1)}catch(X){console.error("Error getting current location:",X),alert("Failed to get your current location. Please try again or enter a city name.")}finally{z(!1)}}),K=()=>{const X=P.trim();if(!X)return;const ne=za.searchCity(X);ne?(N(H(M({},b),{latitude:ne.lat,longitude:ne.lng,radiusMiles:b.radiusMiles||30})),$(ne.state?`${ne.name}, ${ne.state}`:ne.name),A(""),k(!1)):alert(`City "${X}" not found. Please try a major city name.`)},Z=X=>{N(H(M({},b),{radiusMiles:X[0]}))},Y=()=>{N(H(M({},b),{latitude:void 0,longitude:void 0,radiusMiles:30})),$("")},Q=!!(b.latitude&&b.longitude);return v?s.jsx(r8e,{vibeType:v,userId:e,filters:b,onBack:G,onNavigateToProfile:n,onNavigateToChat:a}):s.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--neutral-50)",overflow:"visible"},children:[!c&&s.jsx(Yo,{menuOpen:o,onMenuClick:l,children:s.jsx("div",{style:{display:"flex",alignItems:"center",gap:"6px",width:"100%",maxWidth:"100%"},children:s.jsx(Xi,{value:d,onChange:X=>{u(X),h(X.trim().length>=2)},placeholder:'Try "Radiohead"',widthVariant:"flex"})})}),s.jsxs("div",{className:"max-w-7xl mx-auto space-y-2",style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:c?"calc(env(safe-area-inset-top, 0px) + var(--spacing-small, 12px))":"calc(env(safe-area-inset-top, 0px) + 68px + var(--spacing-small, 12px))",paddingBottom:"var(--spacing-bottom-nav, 112px)",overflow:"visible",minHeight:"auto"},children:[s.jsxs("div",{className:"mb-2 flex items-center gap-2 flex-wrap",children:[s.jsxs(le,{onClick:()=>g(!0),className:"gap-2 flex-shrink-0",style:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},onMouseEnter:X=>{X.currentTarget.style.backgroundColor="var(--brand-pink-600)"},onMouseLeave:X=>{X.currentTarget.style.backgroundColor="var(--brand-pink-500)"},size:"sm","data-tour":"discover-vibes",children:[s.jsx(Se,{name:"mediumShootingStar",size:16,color:"var(--neutral-50)"}),"Browse Vibes"]}),s.jsxs(fc,{open:S,onOpenChange:k,children:[s.jsx(mc,{asChild:!0,children:s.jsxs(le,{variant:"outline",className:"gap-2 flex-shrink-0",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[s.jsx(Se,{name:"location",size:16,color:"var(--neutral-900)"}),s.jsx("span",{style:{color:"var(--neutral-900)"},children:"Location"})]})}),s.jsx(wl,{className:"w-80",style:{backgroundColor:"var(--neutral-50)"},align:"start",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"font-semibold text-sm",children:"Set Location"}),s.jsx(le,{onClick:q,disabled:O,variant:"outline",className:"w-full",size:"sm",children:O?s.jsxs(s.Fragment,{children:[s.jsx(Se,{name:"refresh",size:16,className:"mr-2 animate-spin",color:"var(--neutral-900)"}),"Getting location..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Se,{name:"location",size:16,className:"mr-2",color:"var(--neutral-900)"}),"Use Current Location"]})}),s.jsx("div",{className:"text-sm text-center",style:{color:"var(--neutral-600)"},children:"or"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ar,{placeholder:"Enter city name (e.g., New York, Los Angeles)",value:P,onChange:X=>A(X.target.value),onKeyDown:X=>{X.key==="Enter"&&K()}}),s.jsx(le,{onClick:K,disabled:!P.trim(),className:"w-full",size:"sm",children:"Search City"})]}),Q&&s.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("span",{children:["Radius: ",b.radiusMiles||30," miles"]}),s.jsx("span",{style:{color:"var(--neutral-600)"},children:"Max: 50"})]}),s.jsx(zY,{value:[b.radiusMiles||30],onValueChange:Z,min:1,max:50,step:1,className:"w-full"})]}),Q&&s.jsx(le,{onClick:Y,variant:"ghost",size:"sm",className:"w-full",children:"Clear Location"})]})})]})]}),Q&&s.jsx("div",{className:"mb-2",children:s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",height:"22px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",backgroundColor:"var(--brand-pink-050)",border:"2px solid var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--brand-pink-500)",boxShadow:"0 4px 4px 0 var(--shadow-color)",gap:"var(--spacing-inline, 6px)"},children:[s.jsx(Se,{name:"location",size:16,color:"var(--neutral-900)"}),s.jsxs("span",{children:[R||"Location"," (",b.radiusMiles||30," mi radius)"]}),s.jsx("button",{onClick:Y,style:{background:"none",border:"none",padding:0,cursor:"pointer",display:"flex",alignItems:"center",marginLeft:"var(--spacing-inline, 6px)"},className:"ml-2 hover:text-destructive",children:s.jsx(Se,{name:"x",size:16,color:"var(--neutral-900)"})})]})}),f&&s.jsx("div",{className:"mt-4",children:s.jsx(V9e,{userId:e,allowedTabs:["artists","venues","users","events"],showMap:!1,layout:"compact",mode:"embedded",headerTitle:"",headerDescription:"",showHelperText:!1,initialSearchQuery:d,hideSearchInput:!0,showResults:!0,onNavigateToProfile:n,onNavigateToChat:a})}),!f&&s.jsxs(s.Fragment,{children:[s.jsx(s8e,{currentUserId:e,onNavigateToProfile:n,onNavigateToChat:a}),s.jsx(y8e,{currentUserId:e,filters:b,onNavigateToProfile:n,onNavigateToChat:a}),s.jsx("div",{className:"mt-8",children:s.jsx(l8e,{currentUserId:e,onNavigateToProfile:n,onNavigateToChat:a})})]})]}),s.jsx(HY,{isOpen:p,onClose:()=>g(!1),onSelectVibe:U,isMobile:_})]})};class V0{static getFirstDegreeNetworkEvents(t,r=20){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("get_first_degree_connections",{target_user_id:t});if(a)throw a;if(!n||n.length===0)return[];const i=n.map(g=>g.connected_user_id),{data:o,error:l}=yield T.from("user_event_relationships").select(`
          user_id,
          event_id,
          relationship_type,
          created_at,
          users:user_id (
            user_id,
            name,
            avatar_url
          )
        `).in("user_id",i).in("relationship_type",["interest","going","maybe"]).order("created_at",{ascending:!1}).limit(r*10);if(l)throw l;if(!o||o.length===0)return[];const c=[...new Set((o||[]).map(g=>g.event_id))];if(c.length===0)return[];const{data:d,error:u}=yield T.from("events").select("id, title, venue_city, event_date, images, artist_id, artists(name), venue_id, venues(name)").in("id",c);if(u)throw u;const f=new Map((d||[]).map(g=>[g.id,g])),h=new Map;(o||[]).forEach(g=>{const v=g.event_id;h.has(v)||h.set(v,[]),h.get(v).push(g)});const p=[];return h.forEach((g,v)=>{var b,N,S;const y=f.get(v);if(!y)return;const _=g[0],w=_.users;p.push({event_id:y.id,title:y.title||((b=y.artists)==null?void 0:b.name)||"Event",artist_name:((N=y.artists)==null?void 0:N.name)||"Unknown Artist",venue_name:((S=y.venues)==null?void 0:S.name)||"Unknown Venue",venue_city:y.venue_city||void 0,event_date:y.event_date,friend_id:(w==null?void 0:w.user_id)||_.user_id,friend_name:(w==null?void 0:w.name)||"Friend",friend_avatar:(w==null?void 0:w.avatar_url)||null,action_type:"interested",connection_degree:1,created_at:_.created_at,images:y.images,interested_count:g.length})}),p.sort((g,v)=>new Date(v.created_at).getTime()-new Date(g.created_at).getTime()).slice(0,r)}catch(n){return console.error("Error fetching first-degree network events:",n),[]}})}static getSecondDegreeNetworkEvents(t,r=15){return E(this,null,function*(){try{const{data:n,error:a}=yield T.rpc("get_second_degree_connections",{target_user_id:t});if(a)throw a;if(!n||n.length===0)return[];const i=n.map(h=>h.connected_user_id),{data:o,error:l}=yield T.from("user_event_relationships").select(`
          event_id,
          relationship_type,
          users:user_id (
            user_id,
            name,
            avatar_url
          )
        `).in("user_id",i).in("relationship_type",["interest","going","maybe"]);if(l)throw l;if(!o||o.length===0)return[];const c=new Map;(o||[]).forEach(h=>{const p=h.event_id,g=c.get(p)||{count:0,users:[]};g.count+=1,g.users.push(h.users),c.set(p,g)});const d=Array.from(c.entries()).sort((h,p)=>p[1].count-h[1].count).slice(0,r).map(([h])=>h);if(d.length===0)return[];const{data:u,error:f}=yield T.from("events").select("id, title, venue_city, event_date, images, artist_id, artists(name), venue_id, venues(name)").in("id",d);if(f)throw f;return(u||[]).map(h=>{var v,y,_,w;const p=c.get(h.id),g=(v=p==null?void 0:p.users)==null?void 0:v[0];return{event_id:h.id,title:h.title||((y=h.artists)==null?void 0:y.name)||"Event",artist_name:((_=h.artists)==null?void 0:_.name)||"Unknown Artist",venue_name:((w=h.venues)==null?void 0:w.name)||"Unknown Venue",venue_city:h.venue_city||void 0,event_date:h.event_date,friend_id:(g==null?void 0:g.user_id)||"",friend_name:(g==null?void 0:g.name)||"Friend",friend_avatar:(g==null?void 0:g.avatar_url)||null,action_type:"interested",connection_degree:2,created_at:new Date().toISOString(),images:h.images,interested_count:(p==null?void 0:p.count)||0}})}catch(n){return console.error("Error fetching second-degree network events:",n),[]}})}static getTrendingEvents(t,r,n,a=50,i=20,o){return E(this,null,function*(){console.log(" [TRENDING SERVICE] getTrendingEvents called:",{userId:t,cityLat:r,cityLng:n,radiusMiles:a,limit:i,city:o});try{console.log(" [TRENDING SERVICE] Fetching user_event_relationships...");const{data:l,error:c}=yield T.from("user_event_relationships").select("event_id").eq("relationship_type","interest");if(c)throw console.error(" [TRENDING SERVICE] Error fetching interests:",c),c;console.log(" [TRENDING SERVICE] Fetched interests:",{count:(l==null?void 0:l.length)||0});const d=new Map;(l||[]).forEach(D=>{const B=D.event_id;d.set(B,(d.get(B)||0)+1)}),console.log(" [TRENDING SERVICE] Interested counts calculated:",{uniqueEvents:d.size}),console.log(" [TRENDING SERVICE] Fetching reviews...");const{data:u,error:f}=yield T.from("reviews").select("event_id").eq("is_public",!0);if(f)throw console.error(" [TRENDING SERVICE] Error fetching reviews:",f),f;console.log(" [TRENDING SERVICE] Fetched reviews:",{count:(u==null?void 0:u.length)||0,reviews:u==null?void 0:u.map(D=>({id:D.id,event_id:D.event_id,artist_id:D.artist_id,venue_id:D.venue_id,rating:D.rating,created_at:D.created_at}))});const h=[...new Set((u||[]).map(D=>D.event_id).filter(D=>D!=null))];console.log(" [TRENDING SERVICE] Review event IDs:",{count:h.length,ids:h});const p=[...new Set((u||[]).map(D=>D.artist_id).filter(D=>D!=null))],g=[...new Set((u||[]).map(D=>D.venue_id).filter(D=>D!=null))];console.log(" [TRENDING SERVICE] Review artist/venue IDs:",{artistIds:p.length,venueIds:g.length});let v=new Map;if(h.length>0){console.log(" [TRENDING SERVICE] Fetching events for reviews (checking dates)...");const{data:D,error:B}=yield T.from("events").select("id, title, event_date, venue_city, latitude, longitude, artist_id, artists(name), venue_id, venues(name)").in("id",h);if(B)console.error(" [TRENDING SERVICE] Error fetching events for reviews:",B);else{const F=new Date().toISOString(),U=(D==null?void 0:D.filter(q=>q.event_date>=F))||[],G=(D==null?void 0:D.filter(q=>q.event_date<F))||[];console.log(" [TRENDING SERVICE] Events with reviews:",{total:(D==null?void 0:D.length)||0,upcoming:U.length,past:G.length,events:D==null?void 0:D.map(q=>({id:q.id,title:q.title,event_date:q.event_date,isUpcoming:q.event_date>=F}))})}!B&&D&&((D||[]).forEach(F=>{var G,q;const U=((G=F.artists)==null?void 0:G.name)||((q=F.title)==null?void 0:q.split(" at ")[0])||F.title||"Unknown Artist";if(U){const K=(u||[]).filter(Z=>Z.event_id===F.id).length;v.set(U,(v.get(U)||0)+K)}}),console.log(" [TRENDING SERVICE] Artist review counts:",Object.fromEntries(v)))}const y=Array.from(v.entries()).sort((D,B)=>B[1]-D[1]).slice(0,10).map(([D])=>D),_=Array.from(d.keys()),w=h,b=Array.from(new Set([..._,...w]));if(console.log(" [TRENDING SERVICE] Event IDs combined:",{fromInterests:_.length,fromReviews:w.length,total:b.length}),b.length===0){console.log(" [TRENDING SERVICE] No events with interests or reviews, trying fallback to recent upcoming events...");let D=T.from("events").select("id, title, venue_city, venue_state, event_date, event_media_url, latitude, longitude, genres, artist_id, artists(name), venue_id, venues(name)").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0});if(r&&n&&a){const G=a/69*1.1,q=a/(69*Math.cos(r*Math.PI/180))*1.1;D=D.not("latitude","is",null).not("longitude","is",null).gte("latitude",r-G).lte("latitude",r+G).gte("longitude",n-q).lte("longitude",n+q).limit(300)}else D=D.limit(i*3);const{data:B,error:F}=yield D;if(F)return console.error(" [TRENDING SERVICE] Error fetching fallback events:",F),[];if(!B||B.length===0)return console.log(" [TRENDING SERVICE] No fallback events found either"),[];console.log(" [TRENDING SERVICE] Using fallback events (before exact distance filter):",{count:B.length});let U=B;if(r&&n&&a&&B){const{LocationService:G}=yield kn(()=>E(this,null,function*(){const{LocationService:q}=yield Promise.resolve().then(()=>fC);return{LocationService:q}}),void 0,import.meta.url);U=B.filter(q=>!q.latitude||!q.longitude?!1:G.calculateDistance(r,n,Number(q.latitude),Number(q.longitude))<=a),console.log(" [TRENDING SERVICE] After exact distance filter:",{before:B.length,after:U.length})}return U.slice(0,i).map(G=>{var q,K,Z;return{event_id:G.id,title:G.title||((q=G.artists)==null?void 0:q.name)||"Event",artist_name:((K=G.artists)==null?void 0:K.name)||"Unknown Artist",venue_name:((Z=G.venues)==null?void 0:Z.name)||"Unknown Venue",venue_city:G.venue_city||void 0,event_date:G.event_date,trending_score:0,save_velocity:0,attendance_markings:0,network_overlap:0,trending_label:void 0,event_media_url:G.event_media_url||void 0}})}console.log(" [TRENDING SERVICE] Fetching event details for",b.length,"events...");const N=new Date().toISOString();console.log(" [TRENDING SERVICE] Filtering for events after:",N);let S=T.from("events").select("id, title, venue_city, venue_state, event_date, event_media_url, latitude, longitude, genres, artist_id, artists(name), venue_id, venues(name)").in("id",b).gte("event_date",N);if(r&&n&&a){const D=a/69*1.1,B=a/(69*Math.cos(r*Math.PI/180))*1.1;S=S.gte("latitude",r-D).lte("latitude",r+D).gte("longitude",n-B).lte("longitude",n+B),console.log(" [TRENDING SERVICE] Applied bounding box filter:",{cityLat:r,cityLng:n,radiusMiles:a,latDelta:D,lngDelta:B})}const{data:k,error:P}=yield S.order("event_date",{ascending:!0}).limit(i*3);if(P)throw console.error(" [TRENDING SERVICE] Error fetching events:",P),P;console.log(" [TRENDING SERVICE] Fetched events:",{count:(k==null?void 0:k.length)||0,events:k==null?void 0:k.map(D=>({id:D.id,title:D.title,event_date:D.event_date,venue_city:D.venue_city,hasCoords:!!(D.latitude&&D.longitude)}))});let A=k||[];if(r&&n&&a&&k){console.log(" [TRENDING SERVICE] Applying exact distance filter...");const{LocationService:D}=yield kn(()=>E(this,null,function*(){const{LocationService:B}=yield Promise.resolve().then(()=>fC);return{LocationService:B}}),void 0,import.meta.url);A=k.filter(B=>{if(!B.latitude||!B.longitude)return console.log(" [TRENDING SERVICE] Event missing coordinates:",B.id,B.title),!1;const F=D.calculateDistance(r,n,Number(B.latitude),Number(B.longitude)),U=F<=a;return U||console.log(" [TRENDING SERVICE] Event outside radius:",B.id,B.title,{distance:F,radiusMiles:a}),U}),console.log(" [TRENDING SERVICE] After exact distance filter:",{before:k.length,after:A.length,radiusMiles:a})}else console.log(" [TRENDING SERVICE] Skipping distance filter:",{cityLat:r,cityLng:n,radiusMiles:a,hasEvents:!!k});const R=new Map;(u||[]).forEach(D=>{D.event_id&&R.set(D.event_id,(R.get(D.event_id)||0)+1)});const $=new Map;(u||[]).forEach(D=>{if(D.event_id&&D.rating){const B=$.get(D.event_id)||{sum:0,count:0};$.set(D.event_id,{sum:B.sum+Number(D.rating),count:B.count+1})}});const O=new Map;$.forEach((D,B)=>{O.set(B,D.sum/D.count)}),console.log(" [TRENDING SERVICE] Calculating trending scores...");const z=A.map(D=>{var ne,re,ye;const B=d.get(D.id)||0,F=R.get(D.id)||0,U=O.get(D.id)||0,G=((ne=D.artists)==null?void 0:ne.name)||((re=D.title)==null?void 0:re.split(" at ")[0])||"Unknown Artist",q=v.get(G)||0,K=y.includes(G),Z=B*3,Y=F>0?F*2+U*5+(K?q*2:0):0,Q=Z+Y;let X="";return B>=15?X=" Very Hot":B>=10?X=" Trending":F>=10&&U>=4?X=" Highly Reviewed":K&&(B>=5||F>=3)?X=" Popular":B>=5?X=" Getting Attention":F>=5&&(X=" Well Reviewed"),{event_id:D.id,title:D.title||G||"Event",artist_name:G,venue_name:((ye=D.venues)==null?void 0:ye.name)||"Unknown Venue",venue_city:D.venue_city||void 0,event_date:D.event_date,trending_score:Q,save_velocity:B,attendance_markings:0,network_overlap:0,trending_label:X||void 0,event_media_url:D.event_media_url||void 0}}).filter(D=>D.trending_score>0).sort((D,B)=>B.trending_score-D.trending_score).slice(0,i);return console.log(" [TRENDING SERVICE] Final trending events:",{count:z.length,events:z}),z}catch(l){return console.error(" [TRENDING SERVICE] Error fetching trending events:",l),[]}})}static getEventLists(t,r=5){return E(this,null,function*(){try{const n=[],{data:a,error:i}=yield T.from("reviews").select("event_id, rating").eq("user_id",t).gte("rating",4).order("rating",{ascending:!1}).limit(10);if(!i&&a&&a.length>0){const l=a.map(d=>d.event_id),{data:c}=yield T.from("events").select("id, title, venue_city, event_date, images, genres, artist_id, artists(name), venue_id, venues(name)").in("id",l).gte("event_date",new Date().toISOString()).limit(10);c&&c.length>0&&n.push({id:"user-top-rated",title:"Shows I'd See Again",description:"Based on your highest-rated reviews",list_type:"user_created",events:c.map(d=>{var u,f,h;return{id:d.id,title:d.title||((u=d.artists)==null?void 0:u.name)||"Event",artist_name:((f=d.artists)==null?void 0:f.name)||"Unknown Artist",venue_name:((h=d.venues)==null?void 0:h.name)||"Unknown Venue",event_date:d.event_date,genres:d.genres||[]}}),created_at:new Date().toISOString()})}const o=yield this.getFriendIds(t);if(o.length>0){const{data:l}=yield T.from("reviews").select("event_id, rating").in("user_id",o).gte("rating",4).order("rating",{ascending:!1}).limit(10);if(l&&l.length>0){const c=l.map(u=>u.event_id),{data:d}=yield T.from("events").select("id, title, venue_city, event_date, images, genres, artist_id, artists(name), venue_id, venues(name)").in("id",c).gte("event_date",new Date().toISOString()).lte("event_date",new Date(Date.now()+7*24*60*60*1e3).toISOString()).limit(10);d&&d.length>0&&n.push({id:"network-weekend",title:"Top Rated This Weekend in Your Network",description:"Highly rated by your friends",list_type:"system_generated",events:d.map(u=>({id:u.id,title:u.title||u.artist_name||"Event",artist_name:u.artist_name||"Unknown Artist",venue_name:u.venue_name||"Unknown Venue",event_date:u.event_date,genres:u.genres||[]})),created_at:new Date().toISOString()})}}return n.slice(0,r)}catch(n){return console.error("Error fetching event lists:",n),[]}})}static getNetworkReviews(t,r=20){return E(this,null,function*(){try{console.log(" [NETWORK_REVIEWS] Fetching network reviews for user:",t);const{data:n,error:a}=yield T.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(a)throw console.error(" [NETWORK_REVIEWS] Error fetching friends:",a),a;if(console.log(" [NETWORK_REVIEWS] Found friends:",(n==null?void 0:n.length)||0),!n||n.length===0)return console.log(" [NETWORK_REVIEWS] No friends found, returning empty array"),[];const i=n.map(_=>_.user_id===t?_.related_user_id:_.user_id);console.log(" [NETWORK_REVIEWS] Friend IDs:",i);const{data:o,error:l}=yield T.from("reviews").select(`
          id,
          user_id,
          event_id,
          artist_id,
          venue_id,
          rating,
          review_text,
          photos,
          created_at,
          events (
            id,
            title,
            event_date,
            artist_id,
            venue_id
          )
        `).in("user_id",i).eq("is_public",!0).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).limit(r);if(l)throw console.error(" [NETWORK_REVIEWS] Error fetching reviews:",l),l;if(console.log(" [NETWORK_REVIEWS] Found reviews:",(o==null?void 0:o.length)||0),!o||o.length===0)return console.log(" [NETWORK_REVIEWS] No reviews found, returning empty array"),[];const c=[...new Set(o.map(_=>_.user_id))],{data:d,error:u}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",c);if(u)throw console.error(" [NETWORK_REVIEWS] Error fetching users:",u),u;const f=new Map;d==null||d.forEach(_=>f.set(_.user_id,_));const h=new Set,p=new Set;o.forEach(_=>{var w,b;_.artist_id&&h.add(_.artist_id),_.venue_id&&p.add(_.venue_id),(w=_.events)!=null&&w.artist_id&&h.add(_.events.artist_id),(b=_.events)!=null&&b.venue_id&&p.add(_.events.venue_id)});const g=new Map,v=new Map;if(h.size>0){const{data:_}=yield T.from("artists").select("id, name").in("id",Array.from(h));_==null||_.forEach(w=>g.set(w.id,w.name))}if(p.size>0){const{data:_}=yield T.from("venues").select("id, name").in("id",Array.from(p));_==null||_.forEach(w=>v.set(w.id,w.name))}return o.filter(_=>f.has(_.user_id)).map(_=>{var P,A,R;const w=f.get(_.user_id),b=_.artist_id||((P=_.events)==null?void 0:P.artist_id),N=_.venue_id||((A=_.events)==null?void 0:A.venue_id),S=b?g.get(b):void 0,k=N?v.get(N):void 0;return{id:_.id,author:{id:w.user_id,name:w.name||"User",avatar_url:w.avatar_url||void 0},created_at:_.created_at,rating:_.rating||void 0,content:_.review_text||void 0,photos:_.photos||void 0,event_info:{artist_name:S||void 0,venue_name:k||void 0,event_date:((R=_.events)==null?void 0:R.event_date)||void 0},connection_degree:1}})}catch(n){return console.error("Error fetching network reviews:",n),[]}})}static getFriendIds(t){return E(this,null,function*(){try{const{data:r,error:n}=yield T.rpc("get_first_degree_connections",{target_user_id:t});if(n)throw n;return(r||[]).map(a=>a.connected_user_id)}catch(r){return console.error("Error getting friend IDs:",r),[]}})}}const ZY=({review:e,onClick:t,className:r})=>{var f,h,p;const n=e.author.name||"User",a=((f=e.event_info)==null?void 0:f.artist_name)||"Artist",i=((h=e.event_info)==null?void 0:h.venue_name)||"Venue",o=e.Event_date||e.event_date,l=o?Mt(new Date(o),"MMM d, yyyy"):(p=e.event_info)!=null&&p.event_date?Mt(new Date(e.event_info.event_date),"MMM d, yyyy"):e.created_at?Mt(new Date(e.created_at),"MMM d, yyyy"):"",c=e.rating||0,d=e.content||"",u=e.photos||[];return s.jsxs("div",{onClick:t,className:ke("bg-white border border-gray-200 rounded-lg p-2 cursor-pointer hover:shadow-md transition-shadow",r),children:[s.jsx("div",{className:"mb-1.5",children:s.jsxs("p",{className:"text-xs font-semibold text-gray-900 leading-tight",children:[s.jsx("span",{className:"font-bold",children:n})," reviewed ",s.jsx("span",{className:"font-bold",children:a}),i&&s.jsxs(s.Fragment,{children:[" at ",s.jsx("span",{className:"font-bold",children:i})]}),l&&s.jsxs(s.Fragment,{children:[" on ",s.jsx("span",{className:"font-bold",children:l})]})]})}),c>0&&s.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[s.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5}).map((g,v)=>s.jsx(Qt,{className:ke("w-3 h-3",v<Math.floor(c)?"fill-synth-pink text-synth-pink":"text-gray-300"),strokeWidth:1.5},v))}),s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:c.toFixed(1)})]}),d&&s.jsx("p",{className:"text-xs text-gray-700 mb-1.5 line-clamp-2 leading-tight",children:d}),u.length>0&&s.jsxs("div",{className:"flex gap-1.5 overflow-x-auto scrollbar-hide",children:[u.slice(0,2).map((g,v)=>s.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded overflow-hidden bg-gray-100",children:s.jsx("img",{src:g,alt:`Review photo ${v+1}`,className:"w-full h-full object-cover",onError:y=>{y.target.style.display="none"}})},v)),u.length>2&&s.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded bg-gray-100 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(kv,{className:"w-4 h-4 text-gray-400 mx-auto"}),s.jsxs("span",{className:"text-[9px] text-gray-500",children:["+",u.length-2]})]})})]})]})};class _8e{static getFeed(t,r=20,n=0,a,i=!1){return E(this,null,function*(){var o,l,c,d,u;try{console.log(" PreferencesV4Feed: Fetching feed for user:",t,{limit:r,offset:n,filters:a,skipFollowing:i});let f=(o=a==null?void 0:a.city)!=null?o:null;if(a!=null&&a.latitude&&(a!=null&&a.longitude)&&!f)try{const{LocationService:y}=yield kn(()=>E(this,null,function*(){const{LocationService:w}=yield Promise.resolve().then(()=>fC);return{LocationService:w}}),void 0,import.meta.url),_=yield y.reverseGeocode(a.latitude,a.longitude);_&&(f=_.split(",")[0].trim(),console.log(` Reverse geocoded ${a.latitude},${a.longitude} to city: ${f}`))}catch(y){console.error("Error reverse geocoding for feed filter:",y)}const{data:h,error:p}=yield T.rpc("get_preferences_v4_feed",{p_user_id:t,p_limit:r,p_offset:n,p_include_past:(l=a==null?void 0:a.includePast)!=null?l:!1,p_city_filter:f,p_state_filter:(c=a==null?void 0:a.state)!=null?c:null,p_max_days_ahead:(d=a==null?void 0:a.maxDaysAhead)!=null?d:90,p_skip_following:i,p_radius_miles:(u=a==null?void 0:a.radiusMiles)!=null?u:null});if(p)throw console.error(" PreferencesV4Feed: Error fetching feed:",p),p;if(!h||h.length===0)return console.log(" PreferencesV4Feed: No events found"),{events:[],hasMore:!1};let g=h.map(y=>{var _,w,b,N;return{id:y.event_id,jambase_event_id:y.jambase_event_id,title:y.title||y.artist_name||"Event",artist_name:y.artist_name||"Unknown Artist",artist_id:y.artist_id,venue_name:y.venue_name||"Unknown Venue",venue_id:y.venue_id,event_date:y.event_date,doors_time:y.doors_time,description:y.description,genres:y.genres||[],venue_address:y.venue_address,venue_city:y.venue_city,venue_state:y.venue_state,venue_zip:y.venue_zip,latitude:y.latitude?Number(y.latitude):null,longitude:y.longitude?Number(y.longitude):null,ticket_available:(_=y.ticket_available)!=null?_:!0,price_range:y.price_range,ticket_urls:y.ticket_urls||[],setlist:y.setlist,setlist_enriched:y.setlist_enriched,setlist_song_count:y.setlist_song_count,setlist_fm_id:y.setlist_fm_id,setlist_fm_url:y.setlist_fm_url,setlist_source:y.setlist_source,setlist_last_updated:y.setlist_last_updated,tour_name:y.tour_name,poster_image_url:y.event_media_url||null,created_at:y.created_at,updated_at:y.updated_at,relevance_score:y.relevance_score?Number(y.relevance_score):void 0,user_is_interested:(w=y.user_is_interested)!=null?w:!1,interested_count:(b=y.interested_count)!=null?b:0,friends_interested_count:(N=y.friends_interested_count)!=null?N:0,recommendation_reason:y.recommendation_reason||void 0,recommendation_context:y.recommendation_context||void 0}});if(a!=null&&a.genres&&a.genres.length>0&&(g=g.filter(y=>{const _=y.genres||[];return a.genres.some(w=>_.some(b=>b.toLowerCase().includes(w.toLowerCase())||w.toLowerCase().includes(b.toLowerCase())))})),a!=null&&a.dateRange){const{from:y,to:_}=a.dateRange;(y||_)&&(g=g.filter(w=>{if(!w.event_date)return!1;const b=new Date(w.event_date);if(y&&b<y)return!1;if(_){const N=new Date(_);if(N.setHours(23,59,59,999),b>N)return!1}return!0}))}if(a!=null&&a.latitude&&(a!=null&&a.longitude)&&(a!=null&&a.radiusMiles)&&a.radiusMiles<50){const{filterEventsByRadius:y}=yield kn(()=>E(this,null,function*(){const{filterEventsByRadius:w}=yield Promise.resolve().then(()=>nge);return{filterEventsByRadius:w}}),void 0,import.meta.url),_=g.length;g=y(g,a.latitude,a.longitude,a.radiusMiles),console.log(` Client-side radius filter: ${_} -> ${g.length} events (${a.radiusMiles}mi radius)`)}const v=h.length===r&&g.length>0;return console.log(` PreferencesV4Feed: Found ${g.length} events`,{hasMore:v,avgScore:g.length>0?g.reduce((y,_)=>y+(_.relevance_score||0),0)/g.length:0}),{events:g,hasMore:v}}catch(f){return console.error(" PreferencesV4Feed: Error in getFeed:",f),{events:[],hasMore:!1}}})}static getFeedPaginated(t,r=0,n=20,a,i=!1){return E(this,null,function*(){const o=r*n;return this.getFeed(t,n,o,a,i)})}}const w8e=({userId:e,onEventClick:t,filters:r,className:n,filterControls:a})=>{const[i,o]=x.useState([]),[l,c]=x.useState(!0),[d,u]=x.useState(!1),[f,h]=x.useState(!0),[p,g]=x.useState(0),[v,y]=x.useState(null),[_,w]=x.useState(!1),[b,N]=x.useState(new Set),[S,k]=x.useState(!1),[P,A]=x.useState(null),[R,$]=x.useState(!1),[O,z]=x.useState(null),{toast:D}=Rr(),B=20,F=5*60*1e3,U="recommendations_",G=(re,ye)=>{var se,V,ue,_e,ae,we,oe,ce,Ae,Be;if(!ye)return`${U}${re}_default`;const ee="selectedCities"in ye?ye:null,de=ee?null:ye;let xe;ee!=null&&ee.dateRange?xe={from:(se=ee.dateRange.from)==null?void 0:se.toISOString(),to:(V=ee.dateRange.to)==null?void 0:V.toISOString()}:de!=null&&de.dateRange&&(xe={from:(ue=de.dateRange.from)==null?void 0:ue.toISOString(),to:(_e=de.dateRange.to)==null?void 0:_e.toISOString()});const ie=JSON.stringify({city:(we=(ae=ee==null?void 0:ee.selectedCities)==null?void 0:ae[0])!=null?we:de==null?void 0:de.city,latitude:(oe=ee==null?void 0:ee.latitude)!=null?oe:de==null?void 0:de.latitude,longitude:(ce=ee==null?void 0:ee.longitude)!=null?ce:de==null?void 0:de.longitude,genres:(Ae=ee==null?void 0:ee.genres)!=null?Ae:de==null?void 0:de.genres,radiusMiles:(Be=ee==null?void 0:ee.radiusMiles)!=null?Be:de==null?void 0:de.radiusMiles,dateRange:xe,includePast:de==null?void 0:de.includePast,maxDaysAhead:de==null?void 0:de.maxDaysAhead});return`${U}${re}_${ie}`},q=re=>{try{const ye=localStorage.getItem(re);if(!ye)return null;const{events:ee,timestamp:de}=JSON.parse(ye);return Date.now()-de>F?(localStorage.removeItem(re),null):ee}catch(ye){return console.warn("Error reading cache:",ye),null}},K=(re,ye)=>{const ee={events:ye,timestamp:Date.now()};try{localStorage.setItem(re,JSON.stringify(ee))}catch(de){console.warn("Error saving cache:",de);try{const xe=[];for(let ie=0;ie<localStorage.length;ie++){const se=localStorage.key(ie);se&&se.startsWith(U)&&xe.push(se)}xe.forEach(ie=>localStorage.removeItem(ie)),localStorage.setItem(re,JSON.stringify(ee))}catch(xe){console.warn("Could not clear cache:",xe)}}},Z=()=>E(void 0,null,function*(){if(e)try{const re=yield Qr.getUserInterestedEventIdSet(e);N(re),console.log(" PreferencesV4FeedSection: Loaded all interested events:",re.size)}catch(re){console.error("Error loading all interested events:",re)}});x.useEffect(()=>{e&&Z()},[e]);const Y=(re,ye)=>E(void 0,null,function*(){if(ye.stopPropagation(),!e)return;const de=!b.has(re);N(xe=>{const ie=new Set(xe);return de?ie.add(re):ie.delete(re),ie});try{yield Qr.setEventInterest(e,re,de),o(xe=>xe.map(ie=>ie.id===re?H(M({},ie),{user_is_interested:de}):ie)),D({title:de?"You're interested!":"Interest removed",description:de?"We'll notify you about this event":"You'll no longer receive notifications for this event"})}catch(xe){console.error("Error toggling interest:",xe),N(ie=>{const se=new Set(ie);return de?se.delete(re):se.add(re),se}),D({title:"Error",description:"Failed to update interest",variant:"destructive"})}}),Q=(re,ye)=>{ye.stopPropagation(),A(re),k(!0)},X=(re=0,ye=!1,ee,de=!1)=>E(void 0,null,function*(){var ie,se,V;let xe=!1;try{let ue;if(r)if("genres"in r&&"selectedCities"in r){const oe=r,ce=oe.selectedCities&&oe.selectedCities.length>0?oe.selectedCities[0]:void 0;ce?ue={city:ce,genres:oe.genres,dateRange:oe.dateRange,includePast:!1,maxDaysAhead:(ie=oe.dateRange)!=null&&ie.to?Math.ceil((oe.dateRange.to.getTime()-new Date().getTime())/(1e3*60*60*24)):90,radiusMiles:oe.radiusMiles}:oe.latitude&&oe.longitude?ue={latitude:oe.latitude,longitude:oe.longitude,genres:oe.genres,dateRange:oe.dateRange,includePast:!1,maxDaysAhead:(se=oe.dateRange)!=null&&se.to?Math.ceil((oe.dateRange.to.getTime()-new Date().getTime())/(1e3*60*60*24)):90,radiusMiles:oe.radiusMiles}:ue={genres:oe.genres,dateRange:oe.dateRange,includePast:!1,maxDaysAhead:(V=oe.dateRange)!=null&&V.to?Math.ceil((oe.dateRange.to.getTime()-new Date().getTime())/(1e3*60*60*24)):90,radiusMiles:oe.radiusMiles}}else ue=r;const _e=G(e,ue||r);let ae=null;re===0&&!de&&!ye?(ae=q(_e),ae&&ae.length>0?(console.log(" Loading cached recommendations:",ae.length,"events"),o(ae),c(!1),y(null),xe=!0):(o([]),c(!0))):re===0&&!ye?(o([]),c(!0)):re>0&&u(!0),y(null);const we=yield _8e.getFeedPaginated(e,re,B,ue,ee!==void 0?ee:_);ye?o(oe=>{const ce=new Set(oe.map(Be=>Be.id)),Ae=we.events.filter(Be=>!ce.has(Be.id));return[...oe,...Ae]}):(o(we.events),re===0&&we.events.length>0&&K(_e,we.events)),h(we.hasMore),g(re)}catch(ue){console.error("Error loading Preferences V4 feed:",ue),xe?(console.log(" Background fetch failed, keeping cached data"),y(null)):(y("Failed to load recommendations"),c(!1))}finally{(!xe||re>0)&&c(!1),u(!1)}});if(x.useEffect(()=>{X(0,!1)},[e,r&&"city"in r?r.city:void 0,r&&"selectedCities"in r?r.selectedCities:void 0,r&&"latitude"in r?r.latitude:void 0,r&&"longitude"in r?r.longitude:void 0,r&&"radiusMiles"in r?r.radiusMiles:void 0,r&&"genres"in r?r.genres:void 0,r&&"dateRange"in r?r.dateRange:void 0,r&&"includePast"in r?r.includePast:void 0,r&&"maxDaysAhead"in r?r.maxDaysAhead:void 0]),l&&i.length===0&&p===0)return s.jsx("div",{className:n,children:s.jsx(Rd,{text:"Loading recommendations...",size:"md"})});if(v&&i.length===0)return s.jsxs("div",{className:`text-center py-6 text-muted-foreground text-sm ${n}`,children:[s.jsx("p",{children:v}),s.jsx(le,{variant:"outline",size:"sm",onClick:()=>X(0,!1),className:"mt-2",children:"Try Again"})]});const ne=()=>{!d&&f&&X(p+1,!0)};return s.jsxs("div",{className:`space-y-4 ${n}`,children:[i.length>0?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:i.map((re,ye)=>{var se,V,ue,_e,ae,we;let ee,de=!1;const xe=re.images&&Array.isArray(re.images)&&re.images.length>0;if(re.poster_image_url){ee=Pl(re.poster_image_url);const oe=((se=re.poster_image_url)==null?void 0:se.includes("/storage/v1/object/public/"))||((V=re.poster_image_url)==null?void 0:V.includes("review-photos"))||((ue=re.poster_image_url)==null?void 0:ue.includes("supabase.co/storage")),ce=re.event_media_url&&re.poster_image_url===re.event_media_url,Ae=((_e=re.poster_image_url)==null?void 0:_e.includes("/Generic Images/"))||((ae=re.poster_image_url)==null?void 0:ae.includes("placeholder"))||((we=re.poster_image_url)==null?void 0:we.includes("picsum.photos")),Be=xe&&re.images.some(Xe=>(Xe==null?void 0:Xe.url)===re.poster_image_url);!xe&&oe&&!Ae&&!ce&&!Be&&(de=!0)}else if(xe){const oe=re.images.find(ce=>(ce==null?void 0:ce.url)&&((ce==null?void 0:ce.ratio)==="16_9"||(ce==null?void 0:ce.width)&&ce.width>1e3))||re.images.find(ce=>ce==null?void 0:ce.url);ee=oe!=null&&oe.url?Pl(oe.url):void 0}const ie=`${re.id||"event"}-${ye}`;return s.jsx(Sc,{event:{id:re.id||"",title:re.title||re.artist_name||"Event",artist_name:re.artist_name,venue_name:re.venue_name,event_date:re.event_date,venue_city:re.venue_city||void 0,image_url:ee,poster_image_url:re.poster_image_url||void 0},interestedCount:(re.interested_count||0)+(b.has(re.id)||re.user_is_interested?1:0),isInterested:b.has(re.id)||re.user_is_interested||!1,isCommunityPhoto:de,onInterestClick:oe=>Y(re.id,oe),onShareClick:oe=>Q(re,oe),onClick:()=>t==null?void 0:t(re.id)},ie)})}):s.jsxs("div",{className:"text-center py-6 text-muted-foreground text-sm",children:[s.jsx("p",{children:"No personalized recommendations yet."}),s.jsx("p",{className:"text-xs mt-1",children:"Start following artists or marking events as interested!"})]}),i.length>0&&f&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(le,{variant:"outline",size:"sm",onClick:ne,disabled:d,className:"flex items-center gap-2",children:d?s.jsxs(s.Fragment,{children:[s.jsx(Lv,{variant:"spinner",size:"sm"}),"Loading..."]}):"Load More"})}),P&&s.jsx(ET,{event:P,currentUserId:e,isOpen:S,onClose:()=>{k(!1),A(null)}}),R&&O&&s.jsx(v1,{open:R,onClose:()=>{console.log("Closing flag modal"),$(!1),z(null)},contentType:"event",contentId:O.id,contentTitle:O.title||"Event",onReportSubmitted:()=>{console.log("Report submitted"),$(!1),z(null),D({title:"Report Submitted",description:"Thank you for helping keep our community safe"})}})]})},b8e=({currentUserId:e,onNavigateToProfile:t,onNavigateToEvent:r,onNavigateToArtist:n,onNavigateToVenue:a,onNavigateToChat:i,onNavigateToNotifications:o,onViewChange:l,menuOpen:c=!1,onMenuClick:d,hideHeader:u=!1})=>{var Sr,wt,lt,Qe,jt,ir,rr;const[f,h]=x.useState(null);x.useState("next_30_days");const[p,g]=x.useState(null),[v,y]=x.useState({genres:[],selectedCities:[],dateRange:{},showFilters:!1,radiusMiles:50,filterByFollowing:"all",daysOfWeek:[]});x.useRef(!1),x.useState(["Rock","Pop","Hip-Hop","Electronic","Jazz","Classical","Country","R&B","Reggae","Folk","Blues","Alternative","Indie","Punk","Metal","Funk","Soul","Gospel","Latin","World"]);const[_,w]=x.useState([]);x.useState([]);const[b,N]=x.useState([]),[S,k]=x.useState([]),[P,A]=x.useState([]);x.useState([]);const[R,$]=x.useState([]),[O,z]=x.useState(0),[D,B]=x.useState(0),[F,U]=x.useState(!0),[G,q]=x.useState(!0);x.useState([]),x.useState(new Set),x.useState(new Set),x.useState(new Set);const[K,Z]=x.useState(new Set),[Y,Q]=x.useState([]);x.useState(!0);const[X,ne]=x.useState(!0),[re,ye]=x.useState(!0);x.useState(!0);const[ee,de]=x.useState(!0);x.useState(!1);const[xe,ie]=x.useState(!1),[se,V]=x.useState([]),[ue,_e]=x.useState(!1),[ae,we]=x.useState(null),[oe,ce]=x.useState("recommended"),[Ae,Be]=x.useState(!1),[Xe,ge]=x.useState(null),[We,Ue]=x.useState(null),[at,mt]=x.useState(!1),[Ye,Ft]=x.useState(!1),[_t,Lt]=x.useState(null),[Oe,qe]=x.useState(!1);x.useState([]),x.useEffect(()=>{Fe(),Ne()},[e]),x.useEffect(()=>{const Ie=()=>E(void 0,null,function*(){try{const yt=localStorage.getItem("selectedEvent");if(yt){const pe=JSON.parse(yt);if(localStorage.removeItem("selectedEvent"),Ue(pe),pe.id){const De=yield Qr.isUserInterested(e,pe.id);Ft(De)}setTimeout(()=>{mt(!0)},50)}}catch(yt){console.error("Error loading selectedEvent from localStorage:",yt),localStorage.removeItem("selectedEvent")}});Ie();const At=yt=>{const pe=yt.detail;pe!=null&&pe.event&&Ie()};return window.addEventListener("open-event-details",At),()=>{window.removeEventListener("open-event-details",At)}},[e]),x.useEffect(()=>{E(void 0,null,function*(){try{const{data:At}=yield T.rpc("get_available_cities_for_filter",{min_event_count:1,limit_count:500});At&&w(At.map(yt=>yt.city_name))}catch(At){console.error("Error loading cities:",At)}})},[]),x.useEffect(()=>{console.log(" [HOME FEED] Feed type changed:",oe),oe==="trending"?(console.log(" [HOME FEED] Loading trending events..."),ct(!0)):oe==="friends"?ve(!0):oe==="group-chats"?(gt(),Et()):oe==="reviews"&&Me()},[oe]),x.useEffect(()=>{const Ie=document.querySelector('[data-tour="feed-toggle"]');Ie&&(Ie.style.borderColor=Ae?"var(--brand-pink-500)":"var(--neutral-200)")},[Ae]),x.useEffect(()=>{oe==="trending"&&ct(!0)},[v.genres,v.selectedCities,v.dateRange]);const Ne=()=>E(void 0,null,function*(){try{let Ie=null,At=null;try{Ie=yield za.getCurrentLocation();const zt=yield za.reverseGeocode(Ie.latitude,Ie.longitude);zt&&(At=zt)}catch(zt){console.error("Error getting current location:",zt)}const{data:yt}=yield T.from("users").select("location_city, latitude, longitude").eq("user_id",e).single();let pe,De,Le;if(yt!=null&&yt.location_city){pe=yt.location_city;try{const{RadiusSearchService:zt}=yield kn(()=>E(void 0,null,function*(){const{RadiusSearchService:Te}=yield Promise.resolve().then(()=>P2);return{RadiusSearchService:Te}}),void 0,import.meta.url),Bt=yield zt.getCityCoordinates(yt.location_city);Bt&&(De=Bt.lat,Le=Bt.lng)}catch(zt){console.error("Error converting city to coordinates:",zt)}}else if(yt!=null&&yt.latitude&&(yt!=null&&yt.longitude)){De=yt.latitude,Le=yt.longitude;try{const zt=yield za.reverseGeocode(yt.latitude,yt.longitude);zt&&(pe=zt)}catch(zt){console.error("Error reverse geocoding specified location:",zt)}}const bt=De||(Ie==null?void 0:Ie.latitude),it=Le||(Ie==null?void 0:Ie.longitude);bt&&it?(ge({latitude:bt,longitude:it,radiusMiles:50,locationName:At,specifiedLocationName:pe,specifiedLatitude:De,specifiedLongitude:Le}),y(zt=>H(M({},zt),{latitude:bt,longitude:it,radiusMiles:zt.radiusMiles||50,selectedCities:[]}))):Ie&&(ge({latitude:Ie.latitude,longitude:Ie.longitude,radiusMiles:50,locationName:At}),y(zt=>H(M({},zt),{latitude:Ie.latitude,longitude:Ie.longitude,radiusMiles:zt.radiusMiles||50,selectedCities:[]})))}catch(Ie){console.error("Error loading feed location:",Ie)}}),Fe=()=>E(void 0,null,function*(){try{const{data:Ie,error:At}=yield T.from("users").select("location_city").eq("user_id",e).single();if(At)throw At;if(Ie!=null&&Ie.location_city){h(Ie.location_city);try{const{RadiusSearchService:yt}=yield kn(()=>E(void 0,null,function*(){const{RadiusSearchService:De}=yield Promise.resolve().then(()=>P2);return{RadiusSearchService:De}}),void 0,import.meta.url),pe=yield yt.getCityCoordinates(Ie.location_city);pe&&g(pe)}catch(yt){console.error("Error getting city coordinates:",yt)}}else h(null)}catch(Ie){console.error("Error loading user city:",Ie),h(null)}}),ve=(Ie=!1)=>E(void 0,null,function*(){Ie&&(B(0),ne(!0));try{const[yt,pe]=yield Promise.all([V0.getFirstDegreeNetworkEvents(e,(D+1)*10),V0.getSecondDegreeNetworkEvents(e,(D+1)*8)]);Ie?(N(yt.slice(0,10)),k(pe.slice(0,8))):(N(Le=>[...Le,...yt.slice(D*10,(D+1)*10)]),k(Le=>[...Le,...pe.slice(D*8,(D+1)*8)]));const De=yt.length+pe.length;q(De>(D+1)*18)}catch(At){console.error("Error loading network events:",At),Ie&&(N([]),k([]))}finally{ne(!1)}}),Me=()=>E(void 0,null,function*(){ye(!0);try{const Ie=yield V0.getNetworkReviews(e,20);A(Ie)}catch(Ie){console.error("Error loading reviews:",Ie),A([])}finally{ye(!1)}}),ze=Ie=>{console.log(" [FILTER] applyFiltersToEvents called:",{eventCount:Ie.length,filters:{selectedCities:v.selectedCities,dateRange:v.dateRange,genres:v.genres}});const At=Ie.filter((yt,pe)=>{if(v.dateRange.from||v.dateRange.to){if(!yt.event_date)return console.log(` [FILTER] Event ${pe} filtered out: no event_date`),!1;const De=new Date(yt.event_date);if(v.dateRange.from&&De<v.dateRange.from)return console.log(` [FILTER] Event ${pe} filtered out: before date range`,De),!1;if(v.dateRange.to){const Le=new Date(v.dateRange.to);if(Le.setHours(23,59,59,999),De>Le)return console.log(` [FILTER] Event ${pe} filtered out: after date range`,De),!1}}if(v.genres&&v.genres.length>0){const De=(yt.genres||[]).map(bt=>bt.toLowerCase());if(De.length===0)return console.log(` [FILTER] Event ${pe} filtered out: no genres`),!1;if(!v.genres.some(bt=>De.some(it=>it.includes(bt.toLowerCase())||bt.toLowerCase().includes(it))))return console.log(` [FILTER] Event ${pe} filtered out: genre mismatch`,{eventGenres:De,filterGenres:v.genres}),!1}return!0});return console.log(" [FILTER] applyFiltersToEvents result:",{inputCount:Ie.length,outputCount:At.length}),At},ct=(Ie=!1)=>E(void 0,null,function*(){console.log(" [TRENDING] loadTrendingEvents called",{reset:Ie,trendingPage:O,cityCoordinates:p}),Ie&&(z(0),de(!0));try{console.log(" [TRENDING] Calling getTrendingEvents with params:",{userId:e,cityLat:p==null?void 0:p.lat,cityLng:p==null?void 0:p.lng,radiusMiles:50,limit:(O+1)*12,activeCity:f});const yt=yield V0.getTrendingEvents(e,p==null?void 0:p.lat,p==null?void 0:p.lng,50,(O+1)*12,f||void 0);console.log(" [TRENDING] getTrendingEvents returned:",{eventCount:yt.length,events:yt});const pe=ze(yt);console.log(" [TRENDING] After applying filters:",{filteredCount:pe.length}),Ie?($(pe.slice(0,12)),console.log(" [TRENDING] Set trending events (reset):",pe.slice(0,12).length)):$(De=>{const Le=[...De,...pe.slice(O*12,(O+1)*12)];return console.log(" [TRENDING] Set trending events (append):",{prevCount:De.length,newCount:Le.length}),Le}),U(pe.length>(O+1)*12),console.log(" [TRENDING] Load complete:",{hasMore:pe.length>(O+1)*12})}catch(At){console.error(" [TRENDING] Error loading trending events:",At),Ie&&$([])}finally{de(!1),console.log(" [TRENDING] Loading state set to false")}}),Et=()=>E(void 0,null,function*(){try{const Ie=yield Au.getRecommendedFriends(e);V(Ie)}catch(Ie){console.error("Error loading friend suggestions for rail:",Ie),V([])}}),gt=()=>E(void 0,null,function*(){ie(!0);try{console.log(" Loading recommended chats for user:",e);const{data:Ie,error:At}=yield T.rpc("get_recommended_chats",{p_user_id:e,p_limit:20,p_offset:0,p_radius_miles:50});if(At)throw console.error(" Error calling get_recommended_chats:",At),At;console.log(" Raw recommended chats from RPC:",Ie);const yt=(Ie||[]).filter(pe=>!K.has(pe.chat_id)).map(pe=>{let De=0;if(pe.member_count!=null&&pe.member_count!==void 0){const Le=pe.member_count;if(typeof Le=="number")De=Math.max(0,Math.floor(Le));else{const bt=String(Le).replace(/[^0-9]/g,""),it=parseInt(bt,10);!isNaN(it)&&it>=0&&(De=it)}}return De=Number(De),(isNaN(De)||De<0)&&(De=0),{id:pe.chat_id,chat_name:pe.chat_name||pe.entity_name||"Unnamed Group",member_count:De,friends_in_chat_count:0,entity_type:pe.entity_type,entity_name:pe.entity_name,entity_image_url:pe.entity_image_url,relevance_score:pe.relevance_score,distance_miles:pe.distance_miles}});console.log(" Loaded recommended chats:",yt.length),console.log(" Member counts:",yt.map(pe=>({id:pe.id,name:pe.chat_name,member_count:pe.member_count,type:typeof pe.member_count}))),Q(yt)}catch(Ie){console.error(" Error loading recommended group chats:",Ie),Q([])}finally{ie(!1)}}),St=Ie=>E(void 0,null,function*(){try{const{data:At}=yield T.from("events").select("*").eq("id",Ie).single();if(At){Ue(At);const yt=yield Qr.isUserInterested(e,At.id);Ft(yt),mt(!0)}}catch(At){console.error("Error fetching event details:",At)}}),dr=[{value:"recommended",label:"Hand Picked Events"},{value:"trending",label:"Trending Events"},{value:"friends",label:"Friends Interested"},{value:"group-chats",label:"Recommended Group Chats"},{value:"reviews",label:"Reviews"}];return s.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--neutral-50)"},children:[!u&&s.jsx(Yo,{menuOpen:c,onMenuClick:d,children:s.jsx("div",{style:{width:"100%",paddingLeft:"var(--spacing-screen-margin-x, 20px)",display:"flex",justifyContent:"flex-start"},children:s.jsxs(O1,{open:Ae,onOpenChange:Be,children:[s.jsx(M1,{asChild:!0,children:s.jsxs(le,{variant:"outline",className:"flex items-center gap-2",style:{backgroundColor:"var(--neutral-50)",borderColor:Ae?"var(--brand-pink-500)":"var(--neutral-200)",borderWidth:"2px",borderStyle:"solid",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",transition:"border-color 0.2s ease"},onMouseEnter:Ie=>{Ie.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:Ie=>{!Ie.currentTarget.matches(":focus-visible")&&!Ae&&(Ie.currentTarget.style.borderColor="var(--neutral-200)")},onFocus:Ie=>{Ie.currentTarget.style.borderColor="var(--brand-pink-500)",Ie.currentTarget.style.outline="2px solid var(--brand-pink-500)",Ie.currentTarget.style.outlineOffset="2px"},onBlur:Ie=>{Ie.currentTarget.style.outline="none",Ae||(Ie.currentTarget.style.borderColor="var(--neutral-200)")},"data-tour":"feed-toggle",children:[s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},children:((Sr=dr.find(Ie=>Ie.value===oe))==null?void 0:Sr.label)||"Hand Picked Events"}),s.jsx(Ta,{className:"h-4 w-4",style:{color:"var(--neutral-900)"}})]})}),s.jsx(tx,{style:{backgroundColor:"var(--neutral-50)",border:"2px solid var(--neutral-200)",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 4px 4px 0 var(--shadow-color)",padding:"var(--spacing-inline, 6px)",minWidth:"200px"},children:dr.map(Ie=>s.jsx(Hi,{onClick:()=>ce(Ie.value),style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)",padding:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",cursor:"pointer"},onMouseEnter:At=>{At.currentTarget.style.backgroundColor="var(--brand-pink-050)"},onMouseLeave:At=>{At.currentTarget.style.backgroundColor="transparent"},children:Ie.label},Ie.value))})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto",style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:u?"calc(env(safe-area-inset-top, 0px) + var(--spacing-small, 12px))":"calc(env(safe-area-inset-top, 0px) + 68px + var(--spacing-small, 12px))",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[Xe&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"flex items-center justify-end gap-2",style:{marginBottom:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-screen-margin-x, 20px)"},children:[s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-bold-weight, 700)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},children:"Radius:"}),s.jsx("select",{value:Xe.radiusMiles,onChange:Ie=>{const At=parseInt(Ie.target.value,10);ge(yt=>yt?H(M({},yt),{radiusMiles:At}):null),y(yt=>H(M({},yt),{radiusMiles:At}))},className:"rounded px-2 py-1 focus:outline-none focus:ring-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",border:"1px solid var(--neutral-200)",backgroundColor:"var(--neutral-50)",color:"var(--neutral-900)"},children:[1,5,10,15,20,25,30,40,50].map(Ie=>s.jsxs("option",{value:Ie,style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[Ie," mi"]},Ie))})]})}),oe==="recommended"&&s.jsx(w8e,{userId:e,onEventClick:St,filters:v}),oe==="trending"&&s.jsx("div",{className:"space-y-4",children:ee&&R.length===0?s.jsx(Rd,{text:"Loading trending events...",size:"md"}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:R.map(Ie=>s.jsx(Sc,{event:{id:Ie.event_id,title:Ie.title,artist_name:Ie.artist_name,venue_name:Ie.venue_name,event_date:Ie.event_date,venue_city:Ie.venue_city||void 0,image_url:Pl(Ie.event_media_url)||void 0},onClick:()=>St(Ie.event_id)},Ie.event_id))}),F&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(le,{variant:"outline",onClick:()=>{z(Ie=>Ie+1),ct(!1)},disabled:ee,children:ee?s.jsxs(s.Fragment,{children:[s.jsx(Lv,{variant:"spinner",size:"sm"}),"Loading..."]}):"Load More"})})]})}),oe==="friends"&&s.jsx("div",{className:"space-y-4",children:X&&b.length===0&&S.length===0?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Rd,{})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:[...b,...S].map(Ie=>s.jsx(Sc,{event:{id:Ie.event_id,title:Ie.title,artist_name:Ie.artist_name,venue_name:Ie.venue_name,event_date:Ie.event_date,venue_city:Ie.venue_city||void 0},onClick:()=>St(Ie.event_id)},Ie.event_id))}),G&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(le,{variant:"outline",onClick:()=>{B(Ie=>Ie+1),ve(!1)},disabled:X,children:X?s.jsxs(s.Fragment,{children:[s.jsx(Lv,{variant:"spinner",size:"sm"}),"Loading..."]}):"Load More"})})]})}),oe==="group-chats"&&s.jsx("div",{className:"flex items-center justify-center py-24",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx($n,{className:"w-12 h-12 mx-auto",style:{color:"var(--neutral-600)"}}),s.jsx("h3",{className:"font-semibold",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)"},children:"Coming Soon"}),s.jsx("p",{className:"text-muted-foreground",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:"Group chats are still in development"})]})}),!1,oe==="reviews"&&s.jsx("div",{className:"space-y-4",children:re?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Rd,{})}):P.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center",style:{gap:"var(--spacing-inline, 6px)",paddingTop:"var(--spacing-grouped, 24px)",paddingBottom:"var(--spacing-grouped, 24px)"},children:[s.jsx(Se,{name:"squareComment",size:60,alt:"",style:{color:"var(--neutral-600)"}}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:"No reviews yet"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Be the first to review an event!"})]}):s.jsx("div",{className:"space-y-3",children:P.map(Ie=>s.jsx(ZY,{review:{id:Ie.id,author:{id:Ie.author.id,name:Ie.author.name,avatar_url:Ie.author.avatar_url},created_at:Ie.created_at,rating:Ie.rating,content:Ie.content,photos:Ie.photos,event_info:Ie.event_info},onClick:()=>{var yt;const At={id:Ie.id,type:"review",title:((yt=Ie.event_info)==null?void 0:yt.artist_name)||"Review",author:Ie.author,created_at:Ie.created_at,content:Ie.content,rating:Ie.rating,photos:Ie.photos,event_info:Ie.event_info,relevance_score:0};Lt(At),qe(!0)}},Ie.id))})})]}),at&&We&&s.jsx(Bl,{isOpen:at,onClose:()=>{mt(!1),Ue(null)},event:We,currentUserId:e,isInterested:Ye,onInterestToggle:(Ie,At)=>E(void 0,null,function*(){try{yield Qr.setEventInterest(e,Ie,At),Ft(At)}catch(yt){console.error("Error toggling interest:",yt)}}),onReview:()=>{console.log("Review event:",We.id)},onNavigateToProfile:t,onNavigateToChat:i}),Oe&&_t&&s.jsx(pn,{open:Oe,onOpenChange:qe,children:s.jsxs(dn,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(bn,{className:"sr-only",children:"Review Details"}),s.jsxs(os,{className:"sr-only",children:["Detailed view of ",_t.author.name,"'s review"]}),s.jsx(sw,{review:{id:_t.review_id||_t.id,user_id:_t.author.id,event_id:((wt=_t.event_info)==null?void 0:wt.event_id)||"",rating:_t.rating||0,review_text:_t.content||"",is_public:(lt=_t.is_public)!=null?lt:!0,created_at:_t.created_at,updated_at:_t.updated_at||_t.created_at,likes_count:_t.likes_count||0,comments_count:_t.comments_count||0,shares_count:_t.shares_count||0,is_liked_by_user:_t.is_liked||!1,reaction_emoji:"",photos:_t.photos||[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:(Qe=_t.event_info)==null?void 0:Qe.artist_name,artist_id:(jt=_t.event_info)==null?void 0:jt.artist_id,venue_name:(ir=_t.event_info)==null?void 0:ir.venue_name,venue_id:(rr=_t.event_info)==null?void 0:rr.venue_id,artist_performance_rating:_t.artist_performance_rating,production_rating:_t.production_rating,venue_rating:_t.venue_rating,location_rating:_t.location_rating,value_rating:_t.value_rating,artist_performance_feedback:_t.artist_performance_feedback,production_feedback:_t.production_feedback,venue_feedback:_t.venue_feedback,location_feedback:_t.location_feedback,value_feedback:_t.value_feedback},currentUserId:e,onLike:()=>E(void 0,null,function*(){}),onComment:()=>{},onShare:()=>{},userProfile:{name:_t.author.name,avatar_url:_t.author.avatar_url,verified:_t.author.verified,account_type:_t.author.account_type}})]})}),ae&&s.jsx(CU,{isOpen:ue,onClose:()=>{_e(!1),we(null)},contentType:"event",contentId:ae.id,contentTitle:ae.title})]})};class mC{static registerToken(t,r="ios",n,a){return E(this,null,function*(){try{const{error:i}=yield T.rpc("register_device_token",{p_device_token:t,p_platform:r,p_device_id:n,p_app_version:a});if(i)throw i;console.log(" Device token registered successfully")}catch(i){throw console.error(" Error registering device token:",i),i}})}static unregisterToken(t){return E(this,null,function*(){try{const{error:r}=yield T.rpc("unregister_device_token",{p_device_token:t});if(r)throw r;console.log(" Device token unregistered successfully")}catch(r){console.error(" Error unregistering device token:",r)}})}static getStoredToken(){return typeof window=="undefined"?null:localStorage.getItem("device_token")}static storeToken(t){typeof window!="undefined"&&localStorage.setItem("device_token",t)}static initialize(){return E(this,null,function*(){var r;if(this.initialized){console.log("Push notifications already initialized");return}if(typeof window=="undefined"){console.log("Window not available, skipping push notification initialization");return}if(!((r=window.Capacitor)==null?void 0:r.isNativePlatform())){console.log("Not on native platform, skipping push notification initialization");return}try{const n=yield kn(()=>import("./index-Ky90nsId.js"),[],import.meta.url).catch(()=>null);if(!n||!n.PushNotifications){console.log(" Capacitor push notifications plugin not available (this is normal in web/desktop)");return}const{PushNotifications:a}=n;if((yield a.requestPermissions()).receive==="granted")yield a.register(),console.log(" Push notifications registered");else{console.log(" Push notification permission denied");return}a.addListener("registration",o=>E(this,null,function*(){var c;console.log(" Device token received:",o.value),this.storeToken(o.value);const l=((c=window.Capacitor)==null?void 0:c.getPlatform())==="ios"?(yield kn(()=>E(this,null,function*(){const{App:d}=yield import("./index-BpYUZ-CK.js");return{App:d}}),[],import.meta.url)).App.getInfo().then(d=>d.version):void 0;yield this.registerToken(o.value,"ios",void 0,yield l)})),a.addListener("registrationError",o=>{console.error(" Push notification registration error:",o)}),a.addListener("pushNotificationReceived",o=>{console.log(" Push notification received:",o)}),a.addListener("pushNotificationActionPerformed",o=>E(this,null,function*(){console.log(" Push notification action performed:",o);const l=o.notification.data;l!=null&&l.type&&(yield this.handleNotificationNavigation(l))})),window.addEventListener("DeviceTokenReceived",o=>E(this,null,function*(){var c,d;const l=((c=o.detail)==null?void 0:c.token)||((d=o.detail)==null?void 0:d.token);l&&(console.log(" Device token received via native event:",l),this.storeToken(l),yield this.registerToken(l,"ios"))})),window.addEventListener("PushNotificationTapped",o=>E(this,null,function*(){const l=o.detail||o.detail;l&&(yield this.handleNotificationNavigation(l))})),this.initialized=!0,console.log(" Push notification service initialized")}catch(n){console.error(" Error initializing push notifications:",n)}})}static handleNotificationNavigation(t){return E(this,null,function*(){try{const{type:r,chat_id:n,event_id:a,sender_id:i}=t;switch(r){case"friend_request":i&&(window.location.href=`/profile/${i}`);break;case"message":n&&(window.location.href=`/chat/${n}`);break;case"event_interest":case"event_reminder_1_week":case"event_reminder_3_days":case"event_reminder_1_day":case"event_reminder_day_after":case"artist_new_event":case"venue_new_event":(a||t.event_id)&&(window.location.href=`/event/${a||t.event_id}`);break;default:window.location.href="/notifications"}}catch(r){console.error("Error handling notification navigation:",r)}})}static cleanup(){return E(this,null,function*(){const t=this.getStoredToken();t&&(yield this.unregisterToken(t),localStorage.removeItem("device_token")),this.initialized=!1})}}Cr(mC,"initialized",!1);const j8e=({onSignOut:e})=>{const[t,r]=x.useState("feed"),[n,a]=x.useState([]),[i,o]=x.useState(void 0),[l,c]=x.useState(void 0),[d,u]=x.useState(void 0),[f,h]=x.useState(!1),[p,g]=x.useState(!1),{toast:v}=Rr(),{user:y,session:_,loading:w,sessionExpired:b,signOut:N,resetSessionExpired:S}=xs(),{accountInfo:k}=ih();C0e(),x.useEffect(()=>{yl.restoreState();const oe=yl.subscribe(ce=>{if(ce.status==="completed"&&ce.serviceType){const Ae=ce.serviceType==="spotify"?"Spotify":"Apple Music";v({title:" Stats Ready!",description:`Your ${Ae} streaming stats have been synced and are ready to view.`,action:s.jsx(qF,{altText:"View stats",onClick:()=>{window.location.href="/streaming-stats",localStorage.setItem("intendedView","profile")},className:"",style:{backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)"},onMouseEnter:Be=>{Be.currentTarget.style.backgroundColor="var(--brand-pink-600)"},onMouseLeave:Be=>{Be.currentTarget.style.backgroundColor="var(--brand-pink-500)"},children:"View Stats"})}),setTimeout(()=>{yl.clearSync()},1e3)}else ce.status==="error"&&v({title:"Sync Error",description:`Failed to sync your ${ce.serviceType==="spotify"?"Spotify":"Apple Music"} stats: ${ce.error||"Unknown error"}`,variant:"destructive"})});return()=>{oe()}},[v]),x.useEffect(()=>{!w&&y&&E(void 0,null,function*(){if(!y)return;const ce=yield Ou.checkOnboardingStatus(y.id);ce&&(!ce.onboarding_completed&&!ce.onboarding_skipped?r("onboarding"):ce.onboarding_skipped&&!ce.onboarding_completed?h(!0):ce.onboarding_completed&&!ce.tour_completed&&t==="feed"&&setTimeout(()=>g(!0),1500))})},[y,w,t]),x.useEffect(()=>(!w&&y&&mC.initialize().catch(oe=>{console.error("Failed to initialize push notifications:",oe)}),()=>{y||mC.cleanup().catch(oe=>{console.error("Failed to cleanup push notifications:",oe)})}),[y,w]),x.useEffect(()=>{U();const oe=window.location.hash;oe==="#onboarding"?(r("onboarding"),window.history.replaceState(null,"",window.location.pathname)):oe==="#profile"&&(r("profile"),window.history.replaceState(null,"",window.location.pathname));const ce=localStorage.getItem("intendedView");ce&&["feed","search","profile","onboarding"].includes(ce)&&(r(ce),localStorage.removeItem("intendedView"));const Ae=ge=>{(ge.ctrlKey||ge.metaKey)&&ge.key==="l"&&(ge.preventDefault(),A(!0))};window.addEventListener("keydown",Ae);const Be=ge=>{const We=ge.detail;We!=null&&We.userId&&(o(We.userId),r("profile"))},Xe=ge=>E(void 0,null,function*(){const We=ge.detail;if(We!=null&&We.event)localStorage.setItem("selectedEvent",JSON.stringify(We.event)),r("feed");else if(We!=null&&We.eventId)try{const{data:Ue,error:at}=yield T.from("events").select("*").eq("id",We.eventId).single();Ue&&!at&&(localStorage.setItem("selectedEvent",JSON.stringify(Ue)),r("feed"))}catch(Ue){console.error("Error fetching event:",Ue)}});return window.addEventListener("open-user-profile",Be),window.addEventListener("open-event-details",Xe),()=>{window.removeEventListener("keydown",Ae),window.removeEventListener("open-user-profile",Be),window.removeEventListener("open-event-details",Xe)}},[]),x.useEffect(()=>{b&&(v({title:"Session Expired",description:"Your session has expired. Please sign in again.",variant:"destructive"}),r("feed"),A(!0))},[b,v]),x.useEffect(()=>{const oe=ce=>{var Ae,Be;(Be=(Ae=ce.detail)==null?void 0:Ae.message)!=null&&Be.includes("Invalid API key")&&(A(!0),v({title:"Configuration Error",description:"Please check your Supabase configuration and sign in again.",variant:"destructive"}))};return window.addEventListener("api-error",oe),()=>window.removeEventListener("api-error",oe)},[v]);const[P,A]=x.useState(!1),[R,$]=x.useState(!1),[O,z]=x.useState(!1),[D,B]=x.useState(!1);w9(D);const F=()=>E(void 0,null,function*(){A(!1),S()}),U=()=>E(void 0,null,function*(){try{if(b||!y)return;const{data:oe,error:ce}=yield T.from("events").select("*").order("event_date",{ascending:!0});if(ce)throw ce;const Ae=(oe||[]).map(Be=>({id:Be.id,title:Be.title||Be.event_name||"Untitled Event",venue:Be.venue||Be.location||"Unknown Venue",date:Be.event_date||Be.date||new Date().toISOString().split("T")[0],time:Be.event_time||Be.time||"TBD",category:"music",description:Be.description||"No description available",image:Be.image||GT(Be.id||Be.title||Be.event_name||"synth-event"),price:Be.event_price||void 0,attendeeCount:Math.floor(Math.random()*100)+1}));a(Ae)}catch(oe){v({title:"Error",description:"Failed to load events",variant:"destructive"})}}),G=oe=>{r(oe),oe==="profile"?t==="profile"&&o(void 0):o(void 0),oe!=="chat"&&c(void 0)},q=()=>{r("profile-edit")},K=()=>{$(!0)},Z=()=>{r("profile")},Y=()=>E(void 0,null,function*(){try{yield N(),A(!1),$(!1),v({title:"Signed out",description:"You've been successfully signed out."})}catch(oe){v({title:"Error",description:"Failed to sign out. Please try again.",variant:"destructive"})}}),Q=()=>{window.history.length>1?window.history.back():(r("feed"),c(void 0))},X=()=>{r("notifications")},ne=oe=>E(void 0,null,function*(){try{const{data:ce,error:Ae}=yield T.from("events").select("*").eq("id",oe).single();if(Ae){console.error("Error fetching event:",Ae),v({title:"Error",description:"Failed to load event details",variant:"destructive"});return}ce&&(localStorage.setItem("selectedEvent",JSON.stringify(ce)),r("feed"),window.dispatchEvent(new CustomEvent("open-event-details",{detail:{event:ce}})))}catch(ce){console.error("Error navigating to event:",ce),v({title:"Error",description:"Failed to load event",variant:"destructive"})}}),re=oe=>{window.location.href=`/artist/${encodeURIComponent(oe)}`},ye=oe=>{window.location.href=`/venue/${encodeURIComponent(oe)}`},ee=(oe,ce)=>{r("profile"),ce?sessionStorage.setItem("profileTab",ce):sessionStorage.removeItem("profileTab"),o(oe)},de=oe=>{oe.includes("-")&&oe.length===36?(u(oe),c(void 0)):(c(oe),u(void 0)),r("chat")},xe=()=>{B(!D)},ie=()=>{B(!1)},se=()=>E(void 0,null,function*(){if(r("feed"),h(!1),y){const oe=yield Ou.checkOnboardingStatus(y.id);oe&&!oe.tour_completed&&setTimeout(()=>g(!0),1e3)}}),V=()=>{g(!1)};if(w)return s.jsx(w1,{text:"Loading Synth..."});if(P||b||!(y!=null&&y.id))return s.jsx(dV,{onAuthSuccess:F});const ue=!1,_e=()=>{switch(t){case"onboarding":return s.jsx(E0e,{onComplete:se});case"feed":return s.jsx(b8e,{currentUserId:y.id,onNavigateToNotifications:X,onNavigateToProfile:ee,onNavigateToEvent:ne,onNavigateToArtist:re,onNavigateToVenue:ye,onNavigateToChat:de,onViewChange:G,menuOpen:D,onMenuClick:xe});case"search":return s.jsx(x8e,{currentUserId:y.id,onBack:Q,onNavigateToProfile:ee,onNavigateToChat:de,onNavigateToNotifications:X,onViewChange:G,menuOpen:D,onMenuClick:xe});case"profile":return s.jsx(kge,{currentUserId:y.id,profileUserId:i,onBack:Q,onEdit:q,onSettings:K,onSignOut:Y,onNavigateToProfile:ee,onNavigateToChat:de,onNavigateToNotifications:X,menuOpen:D,onMenuClick:xe});case"profile-edit":return s.jsx(Ege,{currentUserId:y.id,onBack:()=>r("profile"),onSave:Z});case"notifications":return s.jsx(Fge,{currentUserId:y.id,onBack:Q,onNavigateToProfile:ee,onNavigateToEvent:ne,onNavigateToArtist:re,onNavigateToVenue:ye});case"chat":return s.jsx(Nq,{currentUserId:y.id,onBack:Q,menuOpen:D,onMenuClick:xe,hideHeader:we});case"analytics":if(!k)return s.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"var(--neutral-50)"},children:s.jsx("div",{className:"text-center",children:s.jsx("p",{style:{color:"var(--neutral-600)"},children:"Loading account information..."})})});switch(console.log(" MainApp: Account info for analytics:",k),console.log(" MainApp: Account type:",k.account_type),k.account_type){case"creator":return console.log(" MainApp: Rendering CreatorAnalyticsDashboard"),s.jsx(x9e,{});case"business":return console.log(" MainApp: Rendering BusinessAnalyticsDashboard"),s.jsx(w9e,{});case"admin":return console.log(" MainApp: Rendering AdminAnalyticsDashboard"),s.jsx(N9e,{});default:return console.log(" MainApp: Unknown account type, showing not available message"),s.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"var(--neutral-50)"},children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{style:{color:"var(--neutral-600)"},children:"Analytics not available for your account type."}),s.jsxs("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",marginTop:"var(--spacing-small, 12px)"},children:["Account type: ",k.account_type]})]})})}case"events":return s.jsx("div",{className:"min-h-screen p-6",style:{backgroundColor:"var(--neutral-50)"},children:s.jsx(Bge,{})});default:return s.jsx(lge,{currentUserId:y.id,onBack:Q,onViewChange:G,onNavigateToNotifications:X,onNavigateToProfile:ee,onNavigateToChat:de})}};if(t==="onboarding")return _e();const ae=["feed","search","profile","chat"].includes(t),we=O;return s.jsxs("div",{className:"min-h-screen",style:{paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))",backgroundColor:"var(--neutral-50)"},children:[f&&!we&&s.jsx(Wge,{onComplete:()=>r("onboarding")}),ue,s.jsx("div",{style:{paddingBottom:we?"0":"var(--spacing-bottom-nav, 112px)"},children:_e()}),!we&&ae&&s.jsx(a5,{currentView:t,onViewChange:G,onOpenEventReview:()=>z(!0)}),!we&&!ae&&t!=="profile-edit"&&s.jsx(a5,{currentView:t,onViewChange:G,onOpenEventReview:()=>z(!0)}),s.jsx(_9,{isOpen:D,onClose:ie,onToggle:xe,onNavigateToNotifications:X,onNavigateToProfile:ee,onNavigateToSettings:()=>$(!0),onNavigateToVerification:()=>{ee(void 0,"timeline")},onSignOut:Y}),s.jsx(Lge,{isOpen:R,onClose:()=>$(!1),onSignOut:Y,userEmail:y==null?void 0:y.email}),(y==null?void 0:y.id)&&s.jsx(lB,{isOpen:O,onClose:()=>z(!1),event:{id:"new-review"},userId:y.id,onReviewSubmitted:()=>{z(!1)}}),s.jsx($xe,{run:p,onFinish:V,onViewChange:G})]})},N8e=()=>(console.log(" App component is rendering..."),s.jsx(j8e,{}));function S8e({}){const{artistId:e}=BP(),t=as(),r=bh(),{user:n}=xs(),[a,i]=x.useState([]),[o,l]=x.useState(""),[c,d]=x.useState(!0),[u,f]=x.useState(null),h=ae=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(ae),[p,g]=x.useState(null),[v,y]=x.useState(!1),[_,w]=x.useState({totalReviews:0,averageRating:0,loading:!0}),[b,N]=x.useState([]),[S,k]=x.useState(""),[P,A]=x.useState(""),[R,$]=x.useState(!1),[O,z]=x.useState("newest"),[D,B]=x.useState("all"),[F,U]=x.useState("date"),[G,q]=x.useState("asc"),K=ae=>typeof ae.rating=="number"?ae.rating:0,Z=ae=>E(this,null,function*(){try{let we=null,oe=ae?decodeURIComponent(ae):"",ce=null;if(ae&&h(ae)){we=ae;const{data:qe}=yield T.from("artists").select("id, name, image_url").eq("id",we).maybeSingle();if(qe)ce={name:qe.name,image_url:qe.image_url},l(qe.name),qe.image_url&&A(qe.image_url);else{const{data:Ne}=yield T.from("events").select("artist_name, artist_id").eq("artist_id",we).limit(1).maybeSingle();if(Ne!=null&&Ne.artist_name)l(Ne.artist_name);else{const{data:Fe}=yield T.from("artists_with_external_ids").select("name").eq("id",we).limit(1).maybeSingle();Fe!=null&&Fe.name&&l(Fe.name)}}}else{const{data:qe}=yield T.from("artists").select("id, name, image_url").ilike("name",`%${oe}%`).limit(1).maybeSingle();qe?(we=qe.id,ce={name:qe.name,image_url:qe.image_url},l(qe.name),qe.image_url&&A(qe.image_url)):l(oe)}let Ae=[];if(we){const{data:qe,error:Ne}=yield T.from("events").select("id").eq("artist_id",we).limit(1e3);!Ne&&qe&&(Ae=qe)}if(Ae.length===0&&oe){const{data:qe,error:Ne}=yield T.from("events").select("id").ilike("artist_name",`${oe}%`).limit(500);!Ne&&qe&&(Ae=qe)}if(Ae.length===0&&oe){const{data:qe,error:Ne}=yield T.from("events").select("id").ilike("artist_name",`%${oe}%`).limit(500);if(Ne){console.error("Error fetching event IDs for artist:",Ne);return}qe&&(Ae=qe)}const Be=Ae.map(qe=>qe.id);if(Be.length===0){if(!P&&o&&!(ce!=null&&ce.image_url)){const{data:qe}=yield T.from("artists").select("id, name, identifier, image_url").ilike("name",o).maybeSingle();qe!=null&&qe.image_url&&A(qe.image_url)}w({totalReviews:0,averageRating:0,loading:!1}),N([]);return}const{data:Xe,error:ge}=yield T.from("reviews").select(`
          id,
          user_id,
          event_id,
          rating,
          review_text,
          created_at,
          mood_tags,
          genre_tags,
          photos
        `).eq("is_public",!0).eq("is_draft",!1).in("event_id",Be);if(ge){console.error("Error fetching artist reviews:",ge);return}const We=(Xe==null?void 0:Xe.map(qe=>qe.event_id).filter(Boolean))||[],Ue=new Map,at=new Map;if(We.length>0){const{data:qe}=yield T.from("events").select("id, venue_name, event_date, title, artist_id").in("id",We),Ne=[...new Set((qe==null?void 0:qe.map(Fe=>Fe.artist_id).filter(Boolean))||[])];if(Ne.length>0){const{data:Fe}=yield T.from("artists").select("id, name").in("id",Ne);Fe==null||Fe.forEach(ve=>at.set(ve.id,ve.name))}qe&&qe.forEach(Fe=>{Ue.set(Fe.id,Fe)})}const mt=(Xe==null?void 0:Xe.map(qe=>qe.user_id).filter(Boolean))||[],{data:Ye}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",mt),Ft=(Xe==null?void 0:Xe.map(qe=>{const Ne=Ye==null?void 0:Ye.find(Me=>Me.user_id===qe.user_id),Fe=Ue.get(qe.event_id),ve=Fe!=null&&Fe.artist_id?at.get(Fe.artist_id):"";return{id:qe.id,user_id:qe.user_id,event_id:qe.event_id,rating:qe.rating,review_text:qe.review_text,created_at:qe.created_at,reviewer_name:(Ne==null?void 0:Ne.name)||"Anonymous",reviewer_avatar:(Ne==null?void 0:Ne.avatar_url)||null,event_title:(Fe==null?void 0:Fe.title)||"",event_date:(Fe==null?void 0:Fe.event_date)||"",venue_name:(Fe==null?void 0:Fe.venue_name)||"",artist_name:ve||"",mood_tags:qe.mood_tags||[],genre_tags:qe.genre_tags||[],photos:qe.photos||[],category_average:K(qe)}}))||[],_t=Ft.map(qe=>{var Ne;return(Ne=qe.category_average)!=null?Ne:K(qe)}).filter(qe=>typeof qe=="number"&&qe>0),Lt=_t.length,Oe=Lt>0?_t.reduce((qe,Ne)=>qe+Ne,0)/Lt:0;if(w({totalReviews:Lt,averageRating:Oe,loading:!1}),N(Ft),!P&&o&&!(ce!=null&&ce.image_url)){const{data:qe}=yield T.from("artists").select("id, name, identifier, image_url").ilike("name",o).maybeSingle();qe&&(k(""),qe.image_url&&A(qe.image_url))}else k("");if(!P&&o&&!(ce!=null&&ce.image_url)){const{data:qe}=yield T.from("artists").select("id, name, identifier, image_url").eq("name",o).maybeSingle();qe!=null&&qe.image_url&&A(qe.image_url)}}catch(we){console.error("Error fetching artist profile:",we),w(oe=>H(M({},oe),{loading:!1}))}});x.useEffect(()=>{if(!e){f("No artist ID provided"),d(!1);return}Q()},[e]),x.useEffect(()=>{e&&Z(e)},[e]);const Y=e?decodeURIComponent(e):"",Q=()=>E(this,null,function*(){try{d(!0),f(null);const ae=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(Y);let we=Y,oe=Y;if(ae){const{data:Ye,error:Ft}=yield T.from("artists").select("id, name, image_url, jambase_artist_id").eq("id",Y).maybeSingle();!Ft&&Ye?(Ye.jambase_artist_id&&(oe=Ye.jambase_artist_id),Ye.name&&(we=Ye.name),console.log(" Found artist from UUID:",{name:we,jambaseId:oe}),Ye.image_url&&A(Ye.image_url)):console.warn(" Could not find artist by UUID, will try to use as JamBase ID")}let ce=null,Ae=null;if(ae){const Ye=yield T.from("events").select("*").eq("artist_id",Y).order("event_date",{ascending:!0});ce=Ye.data,Ae=Ye.error}if(!ce||ce.length===0){const{data:Ye,error:Ft}=yield T.from("artists").select("id, name").ilike("name",we).maybeSingle();if(!Ft&&(Ye!=null&&Ye.id)){const{data:_t,error:Lt}=yield T.from("events").select("*").eq("artist_id",Ye.id).order("event_date",{ascending:!0});!Lt&&_t&&_t.length>0?(ce=_t,Ae=null,we=Ye.name):ce||(ce=_t||[],Ae=Lt)}else ce||(ce=[],Ae=null)}if(Ae)throw Ae;if(ae&&Y&&!we){const{data:Ye}=yield T.from("artists").select("name").eq("id",Y).maybeSingle();Ye!=null&&Ye.name&&(we=Ye.name)}const Be=[...new Set((ce||[]).map(Ye=>Ye.artist_id).filter(Boolean))],Xe=new Map;if(Be.length>0){const{data:Ye}=yield T.from("artists").select("id, name").in("id",Be);Ye==null||Ye.forEach(Ft=>Xe.set(Ft.id,Ft.name))}const We=[...(ce||[]).map(Ye=>H(M({},Ye),{artist_name:Xe.get(Ye.artist_id)||we||"",source:Ye.source||"jambase"}))],Ue=X(We);Ue.sort((Ye,Ft)=>new Date(Ye.event_date).getTime()-new Date(Ft.event_date).getTime()),i(Ue);let at=we;if((!at||at===Y)&&ae&&Y){const{data:Ye}=yield T.from("artists").select("name").eq("id",Y).maybeSingle();Ye!=null&&Ye.name&&(at=Ye.name)}if((!at||at===Y||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(at))&&Y){const{data:Ye}=yield T.from("events").select("artist_name, artist_id").or(`artist_id.eq.${Y},artist_name.ilike.%${Y}%`).limit(1).maybeSingle();if(Ye!=null&&Ye.artist_name)at=Ye.artist_name;else if(ae&&Y){const{data:Ft}=yield T.from("artists_with_external_ids").select("name").eq("id",Y).limit(1).maybeSingle();Ft!=null&&Ft.name&&(at=Ft.name)}}at&&at!==Y&&!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(at)?l(at):Y&&!ae&&l(Y);let mt=!1;if(ae&&Y){const{data:Ye}=yield T.from("artists").select("id, name, image_url, jambase_artist_id").eq("id",Y).maybeSingle();Ye!=null&&Ye.image_url&&(A(Ye.image_url),mt=!0)}if(!mt&&at){const{data:Ye}=yield T.from("artists").select("id, name, image_url, jambase_artist_id").ilike("name",at).maybeSingle();Ye!=null&&Ye.image_url&&A(Ye.image_url)}}catch(ae){console.error("Error fetching artist events:",ae),f("Failed to load artist events")}finally{d(!1)}}),X=ae=>{const we=new Map;return ae.filter(oe=>{var We;const Ae=(oe.artist_name||"").toLowerCase().trim(),Be=(oe.venue_name||"").toLowerCase().replace(/\s+/g," ").replace(/\bthe\s+/gi,"").replace(/[^\w\s]/g,"").trim(),Xe=((We=oe.event_date)==null?void 0:We.split("T")[0])||"",ge=`${Ae}|${Be}|${Xe}`;return we.has(ge)?!1:(we.set(ge,oe),!0)})},ne=ae=>new Date(ae).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),re=ae=>new Date(ae).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),ye=ae=>{const we=[],oe=Math.floor(ae),ce=ae%1>=.5;for(let Be=0;Be<oe;Be++)we.push(s.jsx(Qt,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},Be));ce&&we.push(s.jsx(Qt,{className:"w-4 h-4 fill-yellow-400/50 text-yellow-400"},"half"));const Ae=5-Math.ceil(ae);for(let Be=0;Be<Ae;Be++)we.push(s.jsx(Qt,{className:"w-4 h-4 text-gray-300"},`empty-${Be}`));return we},ee=(ae,we)=>{const oe=[...ae];switch(we){case"newest":return oe.sort((ce,Ae)=>new Date(Ae.created_at).getTime()-new Date(ce.created_at).getTime());case"oldest":return oe.sort((ce,Ae)=>new Date(ce.created_at).getTime()-new Date(Ae.created_at).getTime());case"highest_rating":return oe.sort((ce,Ae)=>{var ge,We;const Be=(ge=ce.category_average)!=null?ge:K(ce);return(((We=Ae.category_average)!=null?We:K(Ae))||0)-(Be||0)});case"lowest_rating":return oe.sort((ce,Ae)=>{var ge,We;const Be=(ge=ce.category_average)!=null?ge:K(ce),Xe=(We=Ae.category_average)!=null?We:K(Ae);return(Be||0)-(Xe||0)});default:return oe}},de=(ae,we)=>{if(we==="all")return ae;const oe=parseInt(we.split("_")[0]);return ae.filter(ce=>{var Be;const Ae=(Be=ce.category_average)!=null?Be:K(ce);return Math.floor(Ae)===oe})},xe=ae=>new Date(ae).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),ie=ae=>new Date(ae)>=new Date,se=ae=>{const we=[ae.venue_city,ae.venue_state].filter(Boolean);return we.length>0?we.join(", "):"Location TBD"},V=ae=>{g(ae),y(!0)};if(c)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading artist events..."})]})})})});if(u)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:u}),s.jsxs(le,{onClick:()=>t(-1),children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})})})});const _e=((ae,we)=>[...ae].sort((oe,ce)=>{var Be,Xe;let Ae=0;switch(we){case"date":Ae=new Date(oe.event_date).getTime()-new Date(ce.event_date).getTime();break;case"location":const ge=`${oe.venue_city||""}, ${oe.venue_state||""}`.trim(),We=`${ce.venue_city||""}, ${ce.venue_state||""}`.trim();Ae=ge.localeCompare(We);break;case"price":const Ue=parseFloat(((Be=oe.price_range)==null?void 0:Be.replace(/[^0-9.]/g,""))||"0"),at=parseFloat(((Xe=ce.price_range)==null?void 0:Xe.replace(/[^0-9.]/g,""))||"0");Ae=Ue-at;break}return G==="asc"?Ae:-Ae}))(a.filter(ae=>ie(ae.event_date)),F);return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50 overflow-x-hidden w-full max-w-full",children:[s.jsxs("div",{className:"container mx-auto px-4 py-8 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs(le,{variant:"ghost",onClick:()=>{var we;const ae=(we=r.state)==null?void 0:we.eventId;ae&&localStorage.setItem("reopenEventId",ae),window.history.length>1?t(-1):t("/")},className:"mb-4 hover-button",children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex-shrink-0",children:s.jsx($t,{className:"w-6 h-6 text-white"})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("h1",{className:"text-2xl font-bold gradient-text break-words truncate",children:o||(e?decodeURIComponent(e):"Artist")})}),(n==null?void 0:n.id)&&s.jsx(Ky,{artistName:o,userId:n.id,variant:"outline",size:"sm",showFollowerCount:!1,className:"flex-shrink-0"})]}),o&&s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsxs(le,{variant:"outline",onClick:()=>window.open(`https://open.spotify.com/search/${encodeURIComponent(o)}`,"_blank"),style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},className:"flex items-center gap-1.5",children:[s.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:"#1DB954",borderRadius:"var(--radius-corner, 10px)",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx("span",{style:{color:"white",fontSize:"10px",fontWeight:"bold"},children:""})}),s.jsx("span",{children:"Spotify"})]}),s.jsxs(le,{variant:"outline",onClick:()=>window.open(`https://music.apple.com/search?term=${encodeURIComponent(o)}`,"_blank"),style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},className:"flex items-center gap-1.5",children:[s.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:"#000000",borderRadius:"var(--radius-corner, 10px)",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx("span",{style:{color:"white",fontSize:"10px",fontWeight:"bold"},children:""})}),s.jsx("span",{children:"Apple Music"})]}),s.jsx("span",{className:"text-xs text-muted-foreground ml-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:"All events for this artist"})]}),s.jsx("div",{className:"flex items-center gap-2 text-sm",children:s.jsxs("div",{style:{height:"22px",borderRadius:"999px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--brand-pink-050)",color:"var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[_e.length," Upcoming"]})})]}),s.jsxs("div",{className:"mb-8 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx(He,{children:s.jsxs(et,{className:"p-3 text-center",children:[s.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:ye(_.averageRating)}),s.jsx("div",{className:"text-xl font-bold text-gray-900",children:_.averageRating.toFixed(1)}),s.jsx("div",{className:"text-xs text-gray-600",children:"Average Rating"})]})}),s.jsx(He,{children:s.jsxs(et,{className:"p-3 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-gray-900",children:_.totalReviews}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Reviews"})]})}),s.jsx(He,{children:s.jsxs(et,{className:"p-3 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-pink-600",children:_e.length}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Events"})]})})]}),S&&s.jsx(He,{children:s.jsxs(et,{className:"p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["About ",o]}),s.jsx("p",{className:"text-gray-700 leading-relaxed",children:S})]})}),_.totalReviews>0&&s.jsx(He,{children:s.jsxs(et,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Qt,{className:"w-5 h-5 text-yellow-500"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Reviews"})]}),s.jsxs(le,{variant:"ghost",onClick:()=>$(!R),className:"flex items-center gap-1",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[R?s.jsx(Mo,{size:16}):s.jsx(Ta,{size:16}),R?"Hide":"View"," Reviews"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[ye(_.averageRating),s.jsx("span",{className:"text-sm font-medium",children:_.averageRating.toFixed(1)}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",_.totalReviews," review",_.totalReviews!==1?"s":"",")"]})]}),R&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Iy,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Filter by rating:"}),s.jsxs(aa,{value:D,onValueChange:ae=>B(ae),children:[s.jsx(Hs,{className:"w-32",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",borderRadius:"var(--radius-corner, 10px)"},onMouseEnter:ae=>{ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:ae=>{ae.currentTarget.style.borderColor="var(--neutral-200)"},onFocus:ae=>{ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onBlur:ae=>{ae.currentTarget.style.borderColor="var(--neutral-200)"},children:s.jsx(ia,{})}),s.jsxs(Gs,{children:[s.jsx(qt,{value:"all",children:"All Ratings"}),s.jsx(qt,{value:"5_star",children:"5 Stars"}),s.jsx(qt,{value:"4_star",children:"4 Stars"}),s.jsx(qt,{value:"3_star",children:"3 Stars"}),s.jsx(qt,{value:"2_star",children:"2 Stars"}),s.jsx(qt,{value:"1_star",children:"1 Star"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),s.jsxs(aa,{value:O,onValueChange:ae=>z(ae),children:[s.jsx(Hs,{className:"w-40",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",borderRadius:"var(--radius-corner, 10px)"},onMouseEnter:ae=>{ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:ae=>{ae.currentTarget.style.borderColor="var(--neutral-200)"},onFocus:ae=>{ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onBlur:ae=>{ae.currentTarget.style.borderColor="var(--neutral-200)"},children:s.jsx(ia,{})}),s.jsxs(Gs,{children:[s.jsx(qt,{value:"newest",children:"Newest"}),s.jsx(qt,{value:"oldest",children:"Oldest"}),s.jsx(qt,{value:"highest_rating",children:"Highest Rating"}),s.jsx(qt,{value:"lowest_rating",children:"Lowest Rating"})]})]})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:ee(de(b,D),O).map(ae=>{var we,oe;return s.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs(Vr,{className:"w-8 h-8",children:[s.jsx(sn,{src:ae.reviewer_avatar||void 0}),s.jsx(Wr,{className:"text-xs",children:ae.reviewer_name.charAt(0).toUpperCase()})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-sm",children:ae.reviewer_name}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(It,{className:"w-3 h-3"}),xe(ae.event_date)]}),ae.venue_name&&s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx(gr,{className:"w-3 h-3"}),ae.venue_name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[ye((we=ae.category_average)!=null?we:K(ae)),s.jsx("span",{className:"text-sm font-medium ml-1",children:((oe=ae.category_average)!=null?oe:K(ae)).toFixed(1)})]})]}),ae.review_text&&s.jsx("p",{className:"text-sm text-gray-700",children:ae.review_text}),ae.mood_tags&&ae.mood_tags.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:ae.mood_tags.map((ce,Ae)=>s.jsx("div",{style:{height:"22px",borderRadius:"999px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--neutral-100)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:ce},Ae))})]},ae.id)})})]})]})})]}),_e.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-2xl font-semibold gradient-text",children:"Upcoming Events"}),s.jsxs(aa,{value:F,onValueChange:ae=>U(ae),children:[s.jsx(Hs,{className:"w-24 h-8 text-xs",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",borderRadius:"var(--radius-corner, 10px)"},onMouseEnter:ae=>{ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:ae=>{ae.currentTarget.style.borderColor="var(--neutral-200)"},onFocus:ae=>{ae.currentTarget.style.borderColor="var(--brand-pink-500)"},onBlur:ae=>{ae.currentTarget.style.borderColor="var(--neutral-200)"},children:s.jsx(ia,{})}),s.jsxs(Gs,{children:[s.jsx(qt,{value:"date",children:"Date"}),s.jsx(qt,{value:"location",children:"Location"}),s.jsx(qt,{value:"price",children:"Price"})]})]})]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 w-full max-w-full overflow-x-hidden",children:_e.map(ae=>s.jsx(He,{className:"overflow-hidden cursor-pointer w-full max-w-full min-w-0 hover:shadow-md transition-shadow",onClick:()=>V(ae),children:s.jsxs("div",{className:"p-2 w-full max-w-full overflow-x-hidden",children:[s.jsx("h3",{className:"mb-1 line-clamp-2 break-words",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",minHeight:"40px"},children:ae.title}),s.jsxs("div",{className:"space-y-1 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsx(It,{size:16,style:{color:"var(--neutral-600)"}}),s.jsx("span",{className:"truncate",children:ne(ae.event_date)})]}),s.jsxs("div",{className:"flex items-center gap-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsx(ga,{size:16,style:{color:"var(--neutral-600)"}}),s.jsx("span",{className:"truncate",children:re(ae.event_date)})]}),s.jsxs("div",{className:"flex items-center gap-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsx(gr,{size:16,style:{color:"var(--neutral-600)"}}),s.jsx("span",{className:"truncate",children:se(ae)})]})]}),ae.genres&&ae.genres.length>0&&s.jsx("div",{className:"flex flex-wrap gap-0.5",children:ae.genres.slice(0,2).map((we,oe)=>s.jsx("div",{style:{height:"22px",borderRadius:"999px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--neutral-100)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:we},oe))})]})},ae.id))})]}),a.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx($t,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Events Found"}),s.jsxs("p",{className:"text-muted-foreground mb-4",children:["No events found for ",o||"this artist","."]}),s.jsxs(le,{onClick:()=>t(-1),children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})]}),s.jsx(Bl,{event:p,currentUserId:(n==null?void 0:n.id)||"",isOpen:v,onClose:()=>{y(!1),g(null)}})]})}delete IB.Icon.Default.prototype._getIconUrl;IB.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});function k8e({}){const{venueId:e}=BP(),t=as(),r=bh(),{user:n}=xs(),[a,i]=x.useState([]),[o,l]=x.useState(""),[c,d]=x.useState(""),[u,f]=x.useState(!0),[h,p]=x.useState(null),[g,v]=x.useState(null),[y,_]=x.useState(!1),[w,b]=x.useState({totalReviews:0,averageRating:0,loading:!0}),[N,S]=x.useState([]),[k,P]=x.useState(""),[A,R]=x.useState(""),[$,O]=x.useState(""),[z,D]=x.useState(""),[B,F]=x.useState(""),[U,G]=x.useState(""),[q,K]=x.useState(null),[Z,Y]=x.useState(""),[Q,X]=x.useState(!1),[ne,re]=x.useState("newest"),[ye,ee]=x.useState("all"),[de,xe]=x.useState(null),[ie,se]=x.useState("date"),[V,ue]=x.useState("asc"),_e=Oe=>typeof Oe.rating=="number"?Oe.rating:0,ae=Oe=>E(this,null,function*(){var qe;try{const{data:Ne,error:Fe}=yield T.from("reviews").select(`
          id,
          user_id,
          event_id,
          rating,
          venue_rating,
          artist_performance_rating,
          production_rating,
          location_rating,
          value_rating,
          artist_performance_feedback,
          production_feedback,
          venue_feedback,
          location_feedback,
          value_feedback,
          ticket_price_paid,
          review_text,
          created_at,
          mood_tags,
          genre_tags,
          photos,
          was_there,
          is_public,
          is_draft
        `).eq("is_public",!0).eq("is_draft",!1).not("review_text","is",null).neq("review_text","ATTENDANCE_ONLY");if(Fe){console.error("Error fetching venue reviews:",Fe);return}const ve=(Ne==null?void 0:Ne.map(Qe=>Qe.event_id).filter(Boolean))||[],Me=new Map;if(ve.length>0){const{data:Qe}=yield T.from("events").select("id, venue_uuid, artist_name, event_date, title, venue_city, venue_state").in("id",ve);if(Qe){const jt=Qe.map(rr=>rr.venue_uuid).filter(Boolean);let ir=new Map;if(jt.length>0){const{data:rr}=yield T.from("venues").select("id, name").in("id",jt);rr==null||rr.forEach(Ie=>{ir.set(Ie.id,Ie.name)})}Qe.forEach(rr=>{const Ie=rr.venue_uuid?ir.get(rr.venue_uuid):null;Me.set(rr.id,H(M({},rr),{venue_name:Ie}))})}}const ze=(Ne||[]).filter(Qe=>{var ir;const jt=Me.get(Qe.event_id);return jt&&((ir=jt.venue_name)==null?void 0:ir.toLowerCase().includes(Oe.toLowerCase()))}),ct=(ze==null?void 0:ze.map(Qe=>Qe.user_id).filter(Boolean))||[],{data:Et}=yield T.from("users").select("user_id, name, avatar_url").in("user_id",ct),gt=(ze==null?void 0:ze.map(Qe=>{const jt=Et==null?void 0:Et.find(rr=>rr.user_id===Qe.user_id),ir=Me.get(Qe.event_id);return{id:Qe.id,rating:Qe.rating,venue_rating:Qe.venue_rating,artist_performance_rating:Qe.artist_performance_rating,production_rating:Qe.production_rating,location_rating:Qe.location_rating,value_rating:Qe.value_rating,artist_performance_feedback:Qe.artist_performance_feedback,production_feedback:Qe.production_feedback,venue_feedback:Qe.venue_feedback,location_feedback:Qe.location_feedback,value_feedback:Qe.value_feedback,ticket_price_paid:Qe.ticket_price_paid,review_text:Qe.review_text,created_at:Qe.created_at,reviewer_name:(jt==null?void 0:jt.name)||"Anonymous",reviewer_avatar:(jt==null?void 0:jt.avatar_url)||null,event_title:(ir==null?void 0:ir.title)||"",event_date:(ir==null?void 0:ir.event_date)||"",artist_name:(ir==null?void 0:ir.artist_name)||"",mood_tags:Qe.mood_tags||[],genre_tags:Qe.genre_tags||[],photos:Array.isArray(Qe.photos)?Qe.photos:[],category_average:Qe.rating}}))||[],St=gt.map(Qe=>{var jt;return(jt=Qe.rating)!=null?jt:null}).filter(Qe=>typeof Qe=="number"&&Qe>0),dr=St.length,Sr=dr>0?St.reduce((Qe,jt)=>Qe+jt,0)/dr:0;b({totalReviews:dr,averageRating:Sr,loading:!1}),S(gt);let wt=null;if(Oe)try{const{data:Qe,error:jt}=yield T.from("venues").select("id, name, url, image_url").ilike("name",`%${Oe}%`).limit(1).maybeSingle();!jt&&Qe?wt=Qe:jt&&console.debug("Venue query failed (non-critical):",jt.message||jt)}catch(Qe){console.debug("Venue query exception (non-critical):",(Qe==null?void 0:Qe.message)||Qe)}wt?(console.log(" Venue data found:",wt),P(wt.address||""),R(wt.city||""),O(wt.state||""),D(wt.zip||""),F(""),G(wt.url||""),K(null),Y(wt.image_url||"")):(console.log(" No venue data found in database for:",Oe),Oe.toLowerCase().includes("masquerade")&&(P("695 North Ave NE"),R("Atlanta"),O("GA"),D("30308")));let lt="";if(wt!=null&&wt.address&&(wt!=null&&wt.city)&&(wt!=null&&wt.state))lt=`${wt.address}, ${wt.city}, ${wt.state}${wt.zip?` ${wt.zip}`:""}`;else if(a.length>0){const Qe=a[0];Qe.venue_city&&Qe.venue_state&&(lt=`${Oe}, ${Qe.venue_city}, ${Qe.venue_state}`)}if(lt)try{if(lt.toLowerCase().includes("atlanta"))console.log(" Setting Atlanta coordinates for venue:",Oe),xe({lat:33.749,lng:-84.388});else{const Qe=(qe=lt.split(",")[1])==null?void 0:qe.trim().toLowerCase();if(Qe){const jt=za.searchCity(Qe);jt&&xe({lat:jt.lat,lng:jt.lng})}}}catch(Qe){console.error("Error getting venue coordinates:",Qe)}}catch(Ne){console.error("Error fetching venue profile:",Ne),b(Fe=>H(M({},Fe),{loading:!1}))}});x.useEffect(()=>{if(!e){p("No venue ID provided"),f(!1);return}ce()},[e]),x.useEffect(()=>{o&&ae(o)},[o]),x.useEffect(()=>{E(this,null,function*(){if(!de&&a.length>0&&o){const qe=a[0];if(qe.venue_city&&qe.venue_state){const Ne=`${o}, ${qe.venue_city}, ${qe.venue_state}`;try{if(Ne.toLowerCase().includes("atlanta"))console.log(" Setting Atlanta coordinates from events for venue:",o),xe({lat:33.749,lng:-84.388});else{const Fe=qe.venue_city.toLowerCase(),ve=za.searchCity(Fe);ve&&xe({lat:ve.lat,lng:ve.lng})}}catch(Fe){console.error("Error getting coordinates from events:",Fe)}}}})},[a,o,de]);const we=e?decodeURIComponent(e):"",oe=Oe=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(Oe),ce=()=>E(this,null,function*(){try{f(!0),p(null);let Oe=null,qe=null,Ne=we,Fe="Location TBD",ve=null;if(e&&oe(e)){ve=e;const{data:Et}=yield T.from("venues").select("id, name, state, street_address").eq("id",ve).maybeSingle();if(Et){Ne=Et.name;const gt=[Et.street_address,Et.state].filter(Boolean);Fe=gt.length>0?gt.join(", "):"Location TBD"}}else{let Et=null;const{data:gt}=yield T.from("venues").select("id, name, state, street_address").ilike("name",`%${we}%`).limit(5);if(gt&&gt.length>0&&(Et=gt.find(dr=>dr.name.toLowerCase()===we.toLowerCase())||gt[0]),Et){ve=Et.id,Ne=Et.name;const St=[Et.street_address,Et.state].filter(Boolean);Fe=St.length>0?St.join(", "):"Location TBD"}}if(ve){const Et=yield T.from("events").select("*").eq("venue_id",ve).order("event_date",{ascending:!0});Oe=Et.data,qe=Et.error}else Oe=[],qe=null,console.warn(`Venue not found: ${we}`);if(qe)throw qe;d(Fe);const ze=[...(Oe||[]).map(Et=>H(M({},Et),{source:"manual"}))],ct=Ae(ze);if(ct.sort((Et,gt)=>new Date(Et.event_date).getTime()-new Date(gt.event_date).getTime()),i(ct),l(Ne||we||"Unknown Venue"),ct.length>0){const Et=ct[0],gt=[Et.venue_city,Et.venue_state].filter(Boolean);d(gt.length>0?gt.join(", "):"Location TBD")}}catch(Oe){console.error("Error fetching venue events:",Oe),p("Failed to load venue events")}finally{f(!1)}}),Ae=Oe=>{const qe=new Map;return Oe.filter(Ne=>{var Et;const Fe=(Ne.artist_name||"").toLowerCase().trim(),Me=(Ne.venue_name||`${Ne.venue_city||""} ${Ne.venue_state||""}`.trim()||Ne.venue_uuid||"").toLowerCase().replace(/\s+/g," ").replace(/\bthe\s+/gi,"").replace(/[^\w\s]/g,"").trim(),ze=((Et=Ne.event_date)==null?void 0:Et.split("T")[0])||"",ct=`${Fe}|${Me}|${ze}`;return qe.has(ct)?(qe.get(ct),!1):(qe.set(ct,Ne),!0)})},Be=Oe=>new Date(Oe).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),Xe=Oe=>new Date(Oe).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),ge=Oe=>{const qe=[],Ne=Math.floor(Oe),Fe=Oe%1>=.5;for(let Me=0;Me<Ne;Me++)qe.push(s.jsx(Qt,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},Me));Fe&&qe.push(s.jsx(Qt,{className:"w-4 h-4 fill-yellow-400/50 text-yellow-400"},"half"));const ve=5-Math.ceil(Oe);for(let Me=0;Me<ve;Me++)qe.push(s.jsx(Qt,{className:"w-4 h-4 text-gray-300"},`empty-${Me}`));return qe},We=(Oe,qe)=>{const Ne=[...Oe];switch(qe){case"newest":return Ne.sort((Fe,ve)=>new Date(ve.created_at).getTime()-new Date(Fe.created_at).getTime());case"oldest":return Ne.sort((Fe,ve)=>new Date(Fe.created_at).getTime()-new Date(ve.created_at).getTime());case"highest_rating":return Ne.sort((Fe,ve)=>{var Me,ze,ct,Et;return((ze=(Me=ve.venue_rating)!=null?Me:ve.rating)!=null?ze:0)-((Et=(ct=Fe.venue_rating)!=null?ct:Fe.rating)!=null?Et:0)});case"lowest_rating":return Ne.sort((Fe,ve)=>{var Me,ze,ct,Et;return((ze=(Me=Fe.venue_rating)!=null?Me:Fe.rating)!=null?ze:0)-((Et=(ct=ve.venue_rating)!=null?ct:ve.rating)!=null?Et:0)});default:return Ne}},Ue=(Oe,qe)=>{if(qe==="all")return Oe;const Ne=parseInt(qe.split("_")[0],10);return Oe.filter(Fe=>{var Me,ze;const ve=(ze=(Me=Fe.venue_rating)!=null?Me:Fe.rating)!=null?ze:0;return Math.floor(ve)===Ne})},at=Oe=>new Date(Oe).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),mt=Oe=>new Date(Oe)>=new Date,Ye=Oe=>{const qe=[Oe.venue_city,Oe.venue_state].filter(Boolean);return qe.length>0?qe.join(", "):"Location TBD"},Ft=Oe=>{v(Oe),_(!0)};if(u)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading venue events..."})]})})})});if(h)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:h}),s.jsxs(le,{onClick:()=>t(-1),children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})})})});const Lt=((Oe,qe)=>[...Oe].sort((Ne,Fe)=>{var Me,ze;let ve=0;switch(qe){case"date":ve=new Date(Ne.event_date).getTime()-new Date(Fe.event_date).getTime();break;case"artist":ve=(Ne.artist_name||"").localeCompare(Fe.artist_name||"");break;case"price":const ct=parseFloat(((Me=Ne.price_range)==null?void 0:Me.replace(/[^0-9.]/g,""))||"0"),Et=parseFloat(((ze=Fe.price_range)==null?void 0:ze.replace(/[^0-9.]/g,""))||"0");ve=ct-Et;break}return V==="asc"?ve:-ve}))(a.filter(Oe=>mt(Oe.event_date)),ie);return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50 overflow-x-hidden w-full max-w-full",children:[s.jsxs("div",{className:"container mx-auto px-4 py-8 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs(le,{variant:"ghost",onClick:()=>{var qe;const Oe=(qe=r.state)==null?void 0:qe.eventId;Oe&&localStorage.setItem("reopenEventId",Oe),window.history.length>1?t(-1):t("/")},className:"mb-4 hover-button",children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex-shrink-0",children:s.jsx(Yi,{className:"w-6 h-6 text-white"})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("h1",{className:"text-2xl font-bold gradient-text break-words truncate",children:o||"Unknown Venue"})}),(n==null?void 0:n.id)&&o&&s.jsx(g1,{venueName:o,venueCity:A,venueState:$,userId:n.id,variant:"outline",size:"sm",showFollowerCount:!1,className:"flex-shrink-0"})]}),c&&s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("span",{className:"text-xs text-muted-foreground",children:"All events at this venue"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:""}),s.jsx("span",{className:"text-xs text-muted-foreground",children:c})]}),s.jsx("div",{className:"flex items-center gap-2 text-sm",children:s.jsxs("div",{style:{height:"22px",borderRadius:"999px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--brand-pink-050)",color:"var(--brand-pink-500)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[Lt.length," Upcoming"]})})]}),s.jsxs("div",{className:"mb-8 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx(He,{children:s.jsxs(et,{className:"p-3 text-center",children:[s.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:ge(w.averageRating)}),s.jsx("div",{className:"text-xl font-bold text-gray-900",children:w.averageRating.toFixed(1)}),s.jsx("div",{className:"text-xs text-gray-600",children:"Average Rating"})]})}),s.jsx(He,{children:s.jsxs(et,{className:"p-3 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-gray-900",children:w.totalReviews}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Reviews"})]})}),s.jsx(He,{children:s.jsxs(et,{className:"p-3 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-pink-600",children:Lt.length}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Events"})]})})]}),w.totalReviews>0&&s.jsx(He,{children:s.jsxs(et,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Qt,{className:"w-5 h-5 text-yellow-500"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Reviews"})]}),s.jsxs(le,{variant:"ghost",onClick:()=>X(!Q),className:"flex items-center gap-1",style:{height:"var(--size-button-height, 36px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[Q?s.jsx(Mo,{size:16}):s.jsx(Ta,{size:16}),Q?"Hide":"View"," Reviews"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[ge(w.averageRating),s.jsx("span",{className:"text-sm font-medium",children:w.averageRating.toFixed(1)}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",w.totalReviews," review",w.totalReviews!==1?"s":"",")"]})]}),Q&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Iy,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Filter by rating:"}),s.jsxs(aa,{value:ye,onValueChange:Oe=>ee(Oe),children:[s.jsx(Hs,{className:"w-32",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",borderRadius:"var(--radius-corner, 10px)"},onMouseEnter:Oe=>{Oe.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:Oe=>{Oe.currentTarget.style.borderColor="var(--neutral-200)"},onFocus:Oe=>{Oe.currentTarget.style.borderColor="var(--brand-pink-500)"},onBlur:Oe=>{Oe.currentTarget.style.borderColor="var(--neutral-200)"},children:s.jsx(ia,{})}),s.jsxs(Gs,{children:[s.jsx(qt,{value:"all",children:"All Ratings"}),s.jsx(qt,{value:"5_star",children:"5 Stars"}),s.jsx(qt,{value:"4_star",children:"4 Stars"}),s.jsx(qt,{value:"3_star",children:"3 Stars"}),s.jsx(qt,{value:"2_star",children:"2 Stars"}),s.jsx(qt,{value:"1_star",children:"1 Star"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),s.jsxs(aa,{value:ne,onValueChange:Oe=>re(Oe),children:[s.jsx(Hs,{className:"w-40",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",borderRadius:"var(--radius-corner, 10px)"},onMouseEnter:Oe=>{Oe.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:Oe=>{Oe.currentTarget.style.borderColor="var(--neutral-200)"},onFocus:Oe=>{Oe.currentTarget.style.borderColor="var(--brand-pink-500)"},onBlur:Oe=>{Oe.currentTarget.style.borderColor="var(--neutral-200)"},children:s.jsx(ia,{})}),s.jsxs(Gs,{children:[s.jsx(qt,{value:"newest",children:"Newest"}),s.jsx(qt,{value:"oldest",children:"Oldest"}),s.jsx(qt,{value:"highest_rating",children:"Highest Rating"}),s.jsx(qt,{value:"lowest_rating",children:"Lowest Rating"})]})]})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:We(Ue(N,ye),ne).map(Oe=>{var qe,Ne;return s.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs(Vr,{className:"w-8 h-8",children:[s.jsx(sn,{src:Oe.reviewer_avatar||void 0}),s.jsx(Wr,{className:"text-xs",children:Oe.reviewer_name.charAt(0).toUpperCase()})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-sm",children:Oe.reviewer_name}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(It,{className:"w-3 h-3"}),at(Oe.event_date)]}),Oe.artist_name&&s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx($t,{className:"w-3 h-3"}),Oe.artist_name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[ge((qe=Oe.category_average)!=null?qe:_e(Oe)),s.jsx("span",{className:"text-sm font-medium ml-1",children:((Ne=Oe.category_average)!=null?Ne:_e(Oe)).toFixed(1)})]})]}),Oe.review_text&&s.jsx("p",{className:"text-sm text-gray-700",children:Oe.review_text}),typeof Oe.ticket_price_paid=="number"&&Oe.ticket_price_paid>0&&s.jsxs("div",{className:"text-xs text-gray-600 bg-gray-100 inline-flex px-2 py-1 rounded",children:["Ticket price (private): $",Oe.ticket_price_paid.toFixed(2)]}),[{label:"Artist performance",rating:Oe.artist_performance_rating,feedback:Oe.artist_performance_feedback},{label:"Production",rating:Oe.production_rating,feedback:Oe.production_feedback,recommendation:Oe.production_recommendation},{label:"Venue",rating:Oe.venue_rating,feedback:Oe.venue_feedback,recommendation:Oe.venue_recommendation},{label:"Location",rating:Oe.location_rating,feedback:Oe.location_feedback,recommendation:Oe.location_recommendation},{label:"Value",rating:Oe.value_rating,feedback:Oe.value_feedback,recommendation:Oe.value_recommendation}].filter(({rating:Fe,feedback:ve})=>Fe||ve).map(({label:Fe,rating:ve,feedback:Me})=>s.jsxs("div",{className:"text-sm border-l-4 border-blue-200 pl-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium text-gray-600",children:Fe}),typeof ve=="number"&&s.jsx("span",{className:"text-xs text-gray-500",children:ve.toFixed(1)})]}),Me&&s.jsxs("div",{className:"text-xs text-gray-700 italic",children:["",Me,""]})]},Fe)),Oe.mood_tags&&Oe.mood_tags.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:Oe.mood_tags.map((Fe,ve)=>s.jsx("div",{style:{height:"22px",borderRadius:"999px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--neutral-100)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:Fe},ve))})]},Oe.id)})})]})]})})]}),Lt.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-2xl font-semibold gradient-text",children:"Upcoming Events"}),s.jsxs(aa,{value:ie,onValueChange:Oe=>se(Oe),children:[s.jsx(Hs,{className:"w-24 h-8 text-xs",style:{backgroundColor:"var(--neutral-50)",borderColor:"var(--neutral-200)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",borderRadius:"var(--radius-corner, 10px)"},onMouseEnter:Oe=>{Oe.currentTarget.style.borderColor="var(--brand-pink-500)"},onMouseLeave:Oe=>{Oe.currentTarget.style.borderColor="var(--neutral-200)"},onFocus:Oe=>{Oe.currentTarget.style.borderColor="var(--brand-pink-500)"},onBlur:Oe=>{Oe.currentTarget.style.borderColor="var(--neutral-200)"},children:s.jsx(ia,{})}),s.jsxs(Gs,{children:[s.jsx(qt,{value:"date",children:"Date"}),s.jsx(qt,{value:"artist",children:"Artist"}),s.jsx(qt,{value:"price",children:"Price"})]})]})]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 w-full max-w-full overflow-x-hidden",children:Lt.map(Oe=>s.jsx(He,{className:"overflow-hidden cursor-pointer w-full max-w-full min-w-0 hover:shadow-md transition-shadow",onClick:()=>Ft(Oe),children:s.jsxs("div",{className:"p-2 w-full max-w-full overflow-x-hidden",children:[s.jsx("h3",{className:"mb-1 line-clamp-2 break-words",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",minHeight:"40px"},children:Oe.title}),s.jsxs("div",{className:"space-y-1 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsx(It,{size:16,style:{color:"var(--neutral-600)"}}),s.jsx("span",{className:"truncate",children:Be(Oe.event_date)})]}),s.jsxs("div",{className:"flex items-center gap-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsx(ga,{size:16,style:{color:"var(--neutral-600)"}}),s.jsx("span",{className:"truncate",children:Xe(Oe.event_date)})]}),s.jsxs("div",{className:"flex items-center gap-1",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)"},children:[s.jsx(gr,{size:16,style:{color:"var(--neutral-600)"}}),s.jsx("span",{className:"truncate",children:Ye(Oe)})]})]}),Oe.genres&&Oe.genres.length>0&&s.jsx("div",{className:"flex flex-wrap gap-0.5",children:Oe.genres.slice(0,2).map((qe,Ne)=>s.jsx("div",{style:{height:"22px",borderRadius:"999px",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",display:"inline-flex",alignItems:"center",backgroundColor:"var(--neutral-100)",color:"var(--neutral-900)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:qe},Ne))})]})},Oe.id))})]}),a.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Yi,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Events Found"}),s.jsxs("p",{className:"text-muted-foreground mb-4",children:["No events found for ",o||"this venue","."]}),s.jsxs(le,{onClick:()=>t(-1),children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})]}),s.jsx(Bl,{event:g,currentUserId:(n==null?void 0:n.id)||"",isOpen:y,onClose:()=>{_(!1),v(null)}})]})}const E8e=()=>{const{user:e,loading:t}=xs(),{toast:r}=Rr(),[n,a]=x.useState(!0),[i,o]=x.useState(!1),[l,c]=x.useState(null),[d,u]=x.useState(null),[f,h]=x.useState("unknown"),[p,g]=x.useState(!1),[v,y]=x.useState(!1),[_,w]=x.useState("all_time");x.useState([]),x.useEffect(()=>{if(!t){if(!e){window.location.href="/";return}N()}},[e,t]),x.useEffect(()=>{if(e)if(l!==null){const R=sV(l),$=R==="spotify"?"spotify":R==="apple-music"?"apple-music":"unknown";h($),$!=="unknown"?S():(a(!1),g(!0))}else l===null&&!v&&!n&&(y(!0),b())},[l,e]);const b=()=>E(void 0,null,function*(){e&&(a(!1),g(!0))}),N=()=>E(void 0,null,function*(){if(e)try{a(!0);const{data:R,error:$}=yield T.from("users").select("music_streaming_profile").eq("user_id",e.id).single();if($&&$.code!=="PGRST116"){console.error("Error loading profile:",$),c(null),a(!1),g(!0);return}const O=(R==null?void 0:R.music_streaming_profile)||null;c(O)}catch(R){console.error("Error in loadUserProfile:",R),c(null),a(!1),g(!0)}}),S=R=>E(void 0,null,function*(){if(!e||f==="unknown"){a(!1),g(!0);return}a(!1),g(!0)}),k=()=>E(void 0,null,function*(){try{if(!Cu.isConfigured()){r({title:"Spotify Not Configured",description:"Spotify integration is not available.",variant:"destructive"});return}yield Cu.authenticate()}catch(R){console.error("Error connecting Spotify:",R),r({title:"Connection Failed",description:"Failed to connect to Spotify. Please try again.",variant:"destructive"})}}),P=()=>E(void 0,null,function*(){try{o(!0),r({title:"Connecting to Apple Music",description:"Please authorize in the popup window..."}),yield dg.authenticate(),yl.startSync("apple-music"),r({title:"Connected!",description:"Your stats are syncing in the background. You'll be notified when ready!"}),dg.syncProfileData().then(()=>{yl.completeSync(),S(_),g(!1)}).catch(R=>{console.error("Background sync error:",R),yl.errorSync(R.message||"Sync failed")}),setTimeout(()=>{window.location.href="/",localStorage.setItem("intendedView","feed")},1500)}catch(R){console.error("Error connecting Apple Music:",R),yl.errorSync(R instanceof Error?R.message:"Connection failed"),r({title:"Connection Failed",description:"Failed to connect to Apple Music. Please try again.",variant:"destructive"}),o(!1)}}),A=()=>E(void 0,null,function*(){if(!(!e||f==="unknown"))try{if(o(!0),r({title:"Syncing Stats",description:"Fetching comprehensive streaming data... This may take a moment."}),f==="spotify"){if(!Cu.isAuthenticated()){r({title:"Not Connected",description:"Please connect your Spotify account first.",variant:"destructive"}),g(!0);return}yield Cu.syncUserMusicPreferences()}else if(f==="apple-music"){if(!dg.checkStoredToken()){r({title:"Not Connected",description:"Please connect your Apple Music account first.",variant:"destructive"}),g(!0);return}const R=yield dg.generateProfileData();if(R){yield dg.uploadProfileData(R);const $=R.topArtists||[],O=R.topGenres||[],z={user_id:e.id,service_type:"apple-music",top_artists:$.map(D=>{var B;return{name:D.name||((B=D.attributes)==null?void 0:B.name)||"",popularity:D.popularity||0,id:D.id}}),top_genres:O.map(D=>({genre:typeof D=="string"?D:D.genre||"",count:typeof D=="string"?1:D.count||1})),total_tracks:R.totalTracks||0,unique_artists:$.length,total_listening_hours:R.totalListeningHours||0}}}yield S(_),g(!1),r({title:"Sync Complete",description:"Your streaming stats have been synced from your music service. Note: Stats are not stored permanently."})}catch(R){console.error("Error syncing stats:",R),r({title:"Sync Failed",description:"Failed to sync streaming stats. Please try again.",variant:"destructive"})}finally{o(!1)}});return t||n?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx("div",{className:"flex items-center justify-center py-20",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading streaming stats..."})]})})})}):e?p&&!d?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"flex items-center mb-6",children:s.jsxs(le,{variant:"ghost",onClick:()=>{console.log(" StreamingStatsPage: Back button clicked"),window.location.href="/",localStorage.setItem("intendedView","profile")},children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Back to Profile"]})}),s.jsxs(He,{className:"max-w-2xl mx-auto",children:[s.jsx(Er,{children:s.jsxs(qr,{className:"flex items-center gap-2 text-2xl",children:[s.jsx($t,{className:"w-6 h-6 text-pink-500"}),"Connect Your Streaming Service"]})}),s.jsxs(et,{className:"text-center py-12 space-y-6",children:[s.jsx("div",{className:"w-20 h-20 bg-pink-100 rounded-full flex items-center justify-center mx-auto",children:s.jsx($t,{className:"w-10 h-10 text-pink-500"})}),s.jsx("h3",{className:"text-xl font-semibold",children:"Connect Your Music"}),s.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Connect your Spotify or Apple Music account to view your comprehensive streaming statistics and personalize your feed."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-8",children:[s.jsx(He,{className:"border-2 hover:border-green-500 transition-colors cursor-pointer",onClick:k,children:s.jsxs(et,{className:"pt-6",children:[s.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx($t,{className:"w-6 h-6 text-white"})}),s.jsx("h4",{className:"font-semibold mb-2",children:"Connect Spotify"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"View your top artists, tracks, and listening habits"}),s.jsxs(le,{className:"w-full bg-green-500 hover:bg-green-600",children:[s.jsx(oM,{className:"w-4 h-4 mr-2"}),"Connect Spotify"]})]})}),s.jsx(He,{className:"border-2 hover:border-red-500 transition-colors cursor-pointer",onClick:P,children:s.jsxs(et,{className:"pt-6",children:[s.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx($t,{className:"w-6 h-6 text-white"})}),s.jsx("h4",{className:"font-semibold mb-2",children:"Connect Apple Music"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Sync your library and listening history"}),s.jsxs(le,{className:"w-full bg-red-500 hover:bg-red-600",children:[s.jsx(oM,{className:"w-4 h-4 mr-2"}),"Connect Apple Music"]})]})})]})]})]})]})}):d||f!=="unknown"?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs(le,{variant:"ghost",onClick:()=>{window.location.href="/",localStorage.setItem("intendedView","profile")},children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-3",children:[i&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(mi,{className:"w-4 h-4 animate-spin text-pink-500"}),s.jsx("span",{children:"Syncing your stats..."})]}),s.jsxs(le,{onClick:A,disabled:i,variant:"outline",className:"bg-pink-50 hover:bg-pink-100 border-pink-200",children:[s.jsx(mi,{className:`w-4 h-4 mr-2 ${i?"animate-spin":""}`}),i?"Syncing...":"Refresh Stats"]})]})]}),s.jsx(He,{className:"mb-6",children:s.jsxs(et,{className:"pt-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-1",children:"Time Period"}),(d==null?void 0:d.last_updated)&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.jsx("span",{className:"font-medium text-pink-600",children:"Last synced:"})," ",Mt(new Date(d.last_updated),"MMM d, yyyy h:mm a"),s.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Data is permanently stored)"})]})]})}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["last_day","last_week","last_month","last_3_months","last_6_months","last_year","last_3_years","last_5_years","all_time"].map(R=>{const $=d!==null,O=_===R;return s.jsxs(le,{variant:O?"default":"outline",size:"sm",disabled:!$||n,onClick:()=>E(void 0,null,function*(){O||(w(R),a(!0),yield S())}),className:O?"bg-pink-500 hover:bg-pink-600 text-white":$?"hover:bg-pink-50":"opacity-50 cursor-not-allowed",children:[R==="last_day"&&"Day",R==="last_week"&&"Week",R==="last_month"&&"Month",R==="last_3_months"&&"3 Months",R==="last_6_months"&&"6 Months",R==="last_year"&&"Year",R==="last_3_years"&&"3 Years",R==="last_5_years"&&"5 Years",R==="all_time"&&"All Time"]},R)})})]})}),s.jsx(He,{className:"mb-6 border-2",children:s.jsx(Er,{children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center ${f==="spotify"?"bg-green-500":"bg-red-500"}`,children:s.jsx($t,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{children:[s.jsxs(qr,{className:"text-3xl",children:[f==="spotify"?"Spotify":"Apple Music"," Streaming Stats"]}),d&&s.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Last updated: ",Mt(new Date(d.last_updated),"PPp")]})]})]})})})}),d?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsx(He,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx(jQ,{className:"w-6 h-6 text-pink-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Tracks"}),s.jsx("p",{className:"text-3xl font-bold",children:d.total_tracks})]})]})})}),s.jsx(He,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx(Rs,{className:"w-6 h-6 text-pink-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Unique Artists"}),s.jsx("p",{className:"text-3xl font-bold",children:d.unique_artists})]})]})})}),s.jsx(He,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx(ga,{className:"w-6 h-6 text-pink-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Listening Hours"}),s.jsx("p",{className:"text-3xl font-bold",children:Math.round(d.total_listening_hours)})]})]})})}),s.jsx(He,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx(Fd,{className:"w-6 h-6 text-pink-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Top Genres"}),s.jsx("p",{className:"text-3xl font-bold",children:d.top_genres.length})]})]})})})]}),s.jsxs(Li,{defaultValue:"artists",className:"space-y-4",children:[s.jsxs(yi,{className:"grid w-full grid-cols-4",children:[s.jsx(Xr,{value:"artists",children:"Top Artists"}),s.jsx(Xr,{value:"tracks",children:"Top Tracks"}),s.jsx(Xr,{value:"genres",children:"Top Genres"}),s.jsx(Xr,{value:"insights",children:"Insights"})]}),s.jsx(Jr,{value:"artists",className:"space-y-4",children:s.jsxs(He,{children:[s.jsx(Er,{children:s.jsx(qr,{children:"Your Top Artists"})}),s.jsx(et,{children:d.top_artists.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.top_artists.slice(0,20).map((R,$)=>s.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-lg border hover:bg-muted/50 transition-colors",children:[s.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-pink-400 to-purple-500 flex items-center justify-center text-white font-bold text-lg",children:$+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-lg truncate",children:R.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Popularity: ",R.popularity,"/100"]})]})]},R.id||R.name))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx($t,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4 opacity-50"}),s.jsx("p",{className:"text-muted-foreground",children:"No artist data available. Sync your stats to see your top artists."})]})})]})}),s.jsx(Jr,{value:"tracks",className:"space-y-4",children:s.jsxs(He,{children:[s.jsx(Er,{children:s.jsx(qr,{children:"Your Top Tracks"})}),s.jsx(et,{children:d.top_tracks&&d.top_tracks.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.top_tracks.slice(0,30).map((R,$)=>s.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-lg border hover:bg-muted/50 transition-colors",children:[s.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-purple-400 to-pink-500 flex items-center justify-center text-white font-bold text-lg",children:$+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-lg truncate",children:R.name||"Unknown Track"}),s.jsx("p",{className:"text-sm text-muted-foreground truncate",children:R.artist||"Unknown Artist"}),R.popularity!==void 0&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Popularity: ",R.popularity,"/100"]})]})]},R.id||`${R.name}-${$}`))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(fQ,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4 opacity-50"}),s.jsx("p",{className:"text-muted-foreground",children:"No track data available. Sync your stats to see your top tracks."})]})})]})}),s.jsx(Jr,{value:"genres",className:"space-y-4",children:s.jsxs(He,{children:[s.jsx(Er,{children:s.jsx(qr,{children:"Your Top Genres"})}),s.jsx(et,{children:d.top_genres.length>0?s.jsx("div",{className:"space-y-3",children:d.top_genres.map((R,$)=>s.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border hover:bg-muted/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-pink-100 flex items-center justify-center text-pink-600 font-bold",children:$+1}),s.jsx("span",{className:"font-semibold text-lg",children:R.genre})]}),s.jsxs(Ke,{variant:"secondary",className:"text-lg px-3 py-1",children:[R.count," ",R.count===1?"artist":"artists"]})]},R.genre))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Fd,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4 opacity-50"}),s.jsx("p",{className:"text-muted-foreground",children:"No genre data available. Sync your stats to see your top genres."})]})})]})}),s.jsx(Jr,{value:"insights",className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs(He,{children:[s.jsx(Er,{children:s.jsxs(qr,{className:"flex items-center gap-2",children:[s.jsx(Bn,{className:"w-5 h-5"}),"Listening Activity"]})}),s.jsxs(et,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Tracks"}),s.jsx("p",{className:"text-2xl font-bold",children:d.total_tracks})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Estimated Listening Time"}),s.jsxs("p",{className:"text-2xl font-bold",children:[Math.round(d.total_listening_hours)," hours"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Artist Diversity"}),s.jsxs("p",{className:"text-2xl font-bold",children:[d.unique_artists," unique artists"]})]})]})]}),s.jsxs(He,{children:[s.jsx(Er,{children:s.jsxs(qr,{className:"flex items-center gap-2",children:[s.jsx(gQ,{className:"w-5 h-5"}),"Music Preferences"]})}),s.jsxs(et,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Top Genre"}),d.top_genres.length>0?s.jsx(Ke,{variant:"default",className:"text-lg px-3 py-1",children:d.top_genres[0].genre}):s.jsx("p",{className:"text-muted-foreground",children:"No data"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Top Artist"}),d.top_artists.length>0?s.jsx("p",{className:"text-lg font-semibold",children:d.top_artists[0].name}):s.jsx("p",{className:"text-muted-foreground",children:"No data"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Genre Diversity"}),s.jsxs("p",{className:"text-2xl font-bold",children:[d.top_genres.length," genres"]})]})]})]})]})})]})]}):s.jsx(He,{children:s.jsxs(et,{className:"py-12 text-center",children:[s.jsx("p",{className:"text-muted-foreground mb-4",children:"No stats available yet."}),s.jsxs(le,{onClick:A,disabled:i,children:[s.jsx(mi,{className:`w-4 h-4 mr-2 ${i?"animate-spin":""}`}),i?"Syncing...":"Sync Your Stats"]})]})})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs(le,{variant:"ghost",onClick:()=>{window.location.href="/",localStorage.setItem("intendedView","profile")},className:"mb-6",children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx(He,{children:s.jsx(et,{className:"py-12 text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"Unable to load streaming stats."})})})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx("div",{className:"flex items-center justify-center py-20",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"Please log in to view streaming stats."})})})})})};function _$(){var xe;const e=as(),{userId:t}=BP(),{user:r}=xs(),[n,a]=x.useState("artists"),[i,o]=x.useState([]),[l,c]=x.useState([]),[d,u]=x.useState(!0),[f,h]=x.useState(null),[p,g]=x.useState([]),[v,y]=x.useState(null),[_,w]=x.useState(null),[b,N]=x.useState(null),[S,k]=x.useState("events"),[P,A]=x.useState("date"),[R,$]=x.useState("asc"),[O,z]=x.useState("all"),D=t||(r==null?void 0:r.id)||"",B=!t||t===(r==null?void 0:r.id),F=((xe=r==null?void 0:r.user_metadata)==null?void 0:xe.name)||"User";x.useEffect(()=>{D&&(U(),G())},[D]),x.useEffect(()=>{(i.length>0||l.length>0)&&q()},[P,R,O]);const U=()=>E(this,null,function*(){try{u(!0),h(null);const ie=yield Si.getUserFollowedArtists(D),se=yield Promise.all(ie.map(V=>E(this,null,function*(){try{const{data:ue}=yield supabase.from("events").select("*").ilike("artist_name",`%${V.artist_name}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(50),_e=(ue||[]).map(oe=>({id:oe.id,title:oe.title,artist_name:oe.artist_name||V.artist_name,venue_name:oe.venue_name,venue_id:oe.venue_id,venue_city:oe.venue_city,venue_state:oe.venue_state,venue_address:oe.venue_address,venue_zip:oe.venue_zip,event_date:oe.event_date,doors_time:oe.doors_time,description:oe.description,ticket_urls:oe.ticket_urls||[],price_range:oe.price_range,ticket_available:oe.ticket_available,genres:oe.genres,source:oe.source||"jambase"}));console.log(` Checking events for "${V.artist_name}":`,{totalEvents:_e.length,events:_e.map(oe=>({title:oe.title,artist:oe.artist_name,date:oe.event_date,source:oe.source}))});const ae=new Date,we=_e.filter(oe=>{var Ue,at;const ce=oe.event_date,Be=new Date(ce)>ae,Xe=(Ue=oe.title)==null?void 0:Ue.toLowerCase().includes(V.artist_name.toLowerCase()),ge=((at=oe.artist_name)==null?void 0:at.toLowerCase())===V.artist_name.toLowerCase(),We=Be&&(Xe||ge);return!We&&Be&&console.log(` Event not matched for "${V.artist_name}":`,{title:oe.title,artistInEvent:oe.artist_name,titleContainsArtist:Xe,exactArtistMatch:ge}),We});return console.log(` Filtered upcoming events for "${V.artist_name}":`,{count:we.length,events:we.map(oe=>({title:oe.title,date:oe.event_date,source:oe.source}))}),H(M({},V),{upcomingEvents:we})}catch(ue){return console.warn(`Error loading events for artist ${V.artist_name}:`,ue),H(M({},V),{upcomingEvents:[]})}})));o(se)}catch(ie){console.error("Error loading followed artists:",ie),h("Failed to load followed artists")}finally{u(!1)}}),G=()=>E(this,null,function*(){try{const ie=yield Tu.getUserFollowedVenues(D),se=yield Promise.all(ie.map(V=>E(this,null,function*(){try{const{data:ue}=yield supabase.from("events").select("*").ilike("venue_name",`%${V.venue_name}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(50),_e=(ue||[]).map(oe=>({id:oe.id,title:oe.title,artist_name:oe.artist_name||"Unknown Artist",venue_name:oe.venue_name,venue_id:oe.venue_id,venue_city:oe.venue_city,venue_state:oe.venue_state,venue_address:oe.venue_address,venue_zip:oe.venue_zip,event_date:oe.event_date,doors_time:oe.doors_time,description:oe.description,ticket_urls:oe.ticket_urls||[],price_range:oe.price_range,ticket_available:oe.ticket_available,genres:oe.genres,source:oe.source||"jambase"})),ae=new Date,we=_e.filter(oe=>new Date(oe.event_date)>ae);return console.log(` Filtered upcoming events for "${V.venue_name}":`,{count:we.length,events:we.map(oe=>({title:oe.title,date:oe.event_date,source:oe.source}))}),H(M({},V),{upcomingEvents:we})}catch(ue){return console.warn(`Error loading events for venue ${V.venue_name}:`,ue),H(M({},V),{upcomingEvents:[]})}})));c(se)}catch(ie){console.error("Error loading followed venues:",ie)}});x.useEffect(()=>{(i.length>0||l.length>0)&&q()},[i,l]);const q=()=>{const ie=i.flatMap(ae=>ae.upcomingEvents.map(we=>H(M({},we),{source:"artist",sourceName:ae.artist_name}))),se=l.flatMap(ae=>ae.upcomingEvents.map(we=>H(M({},we),{source:"venue",sourceName:ae.venue_name}))),V=[...ie,...se],ue=ne(V),_e=re(ue);g(_e)},K=ie=>{y(ie)},Z=ie=>{w(ie),N(null),y(null),k("artist")},Y=ie=>{N(ie),w(null),y(null),k("venue")},Q=(ie,se)=>{if(ie==="artist"){const V=i.find(ue=>ue.artist_name===se);V&&Z(V)}else if(ie==="venue"){const V=l.find(ue=>ue.venue_name===se);V&&Y(V)}},X=()=>{localStorage.setItem("intendedView","profile"),e("/")},ne=ie=>O==="all"?ie:ie.filter(se=>se.source===O),re=ie=>[...ie].sort((se,V)=>{let ue=0;switch(P){case"date":ue=new Date(se.event_date).getTime()-new Date(V.event_date).getTime();break;case"location":const _e=`${se.venue_city}, ${se.venue_state}`.toLowerCase(),ae=`${V.venue_city}, ${V.venue_state}`.toLowerCase();ue=_e.localeCompare(ae);break;case"price":const we=se.price_range||"",oe=V.price_range||"";ue=we.localeCompare(oe);break}return R==="asc"?ue:-ue}),ye=()=>_?s.jsx("div",{className:"h-full overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Vr,{className:"w-16 h-16",children:[s.jsx(sn,{src:_.artist_image_url}),s.jsx(Wr,{className:"bg-pink-100 text-pink-600",children:s.jsx($t,{className:"w-8 h-8"})})]}),s.jsxs("div",{children:[s.jsx("button",{className:"text-2xl font-bold text-left hover:text-pink-600 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 rounded",onClick:()=>{console.log(" Artist name clicked in header:",_.artist_name),e(`/artist/${_.artist_id||encodeURIComponent(_.artist_name)}`)},title:`Click to view ${_.artist_name}'s full profile`,children:_.artist_name}),s.jsxs("p",{className:"text-gray-600",children:["Following since ",Mt(new Date(_.created_at),"MMM d, yyyy")]})]})]}),s.jsxs(le,{variant:"default",size:"sm",onClick:()=>{console.log(" Back to all events clicked from artist details"),k("events"),w(null)},className:"bg-pink-500 hover:bg-pink-600 text-white border-0 shadow-sm",children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Back to All Events"]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(It,{className:"w-5 h-5 text-pink-500"}),"Upcoming Events (",_.upcomingEvents.length,")"]}),_.upcomingEvents.length>0?s.jsx("div",{className:"space-y-4",children:re(_.upcomingEvents).map(ie=>s.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>K(ie),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("h4",{className:"font-medium text-lg",children:ie.title})}),ie.sourceName&&s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["via"," ",s.jsx("button",{onClick:se=>{se.stopPropagation(),Q(ie.source,ie.sourceName)},className:"text-pink-600 hover:text-pink-700 hover:underline cursor-pointer",children:ie.sourceName})]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(It,{className:"w-4 h-4"}),Mt(new Date(ie.event_date),"MMM d, yyyy")]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(gr,{className:"w-4 h-4"}),ie.venue_city,", ",ie.venue_state]})]}),ie.venue_address&&ie.venue_address!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-500 mb-2",children:ie.venue_address}),ie.description&&ie.description!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:ie.description})]}),s.jsx("div",{className:"flex flex-col items-end gap-2",children:ie.ticket_urls&&ie.ticket_urls.length>0&&s.jsx(Bo,{className:"w-4 h-4 text-pink-500"})})]})},ie.id))}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(It,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:"No upcoming events found"})]})]})]})}):null,ee=()=>b?s.jsx("div",{className:"h-full overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(Vr,{className:"w-16 h-16",children:s.jsx(Wr,{className:"bg-blue-100 text-blue-600",children:s.jsx(Yi,{className:"w-8 h-8"})})}),s.jsxs("div",{children:[s.jsx("button",{className:"text-2xl font-bold text-left hover:text-blue-600 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded",onClick:()=>{console.log(" Venue name clicked in header:",b.venue_name),e(`/venue/${encodeURIComponent(b.venue_name)}`)},title:`Click to view ${b.venue_name}'s full profile`,children:b.venue_name}),s.jsxs("p",{className:"text-gray-600",children:[b.venue_city,", ",b.venue_state]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Following since ",Mt(new Date(b.created_at),"MMM d, yyyy")]})]})]}),s.jsxs(le,{variant:"default",size:"sm",onClick:()=>{k("events"),N(null)},className:"bg-blue-500 hover:bg-blue-600 text-white border-0 shadow-sm",children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Back to All Events"]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(It,{className:"w-5 h-5 text-blue-500"}),"Upcoming Events (",b.upcomingEvents.length,")"]}),b.upcomingEvents.length>0?s.jsx("div",{className:"space-y-4",children:re(b.upcomingEvents).map(ie=>s.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>K(ie),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("h4",{className:"font-medium text-lg",children:ie.title}),ie.artist_name&&s.jsx("p",{className:"text-sm text-gray-600",children:ie.artist_name})]}),s.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(It,{className:"w-4 h-4"}),Mt(new Date(ie.event_date),"MMM d, yyyy")]})}),ie.description&&ie.description!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:ie.description})]}),s.jsx("div",{className:"flex flex-col items-end gap-2",children:ie.ticket_urls&&ie.ticket_urls.length>0&&s.jsx(Bo,{className:"w-4 h-4 text-blue-500"})})]})},ie.id))}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(It,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:"No upcoming events found"})]})]})]})}):null,de=()=>p.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[s.jsx(It,{className:"w-16 h-16 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Upcoming Events"}),s.jsx("p",{className:"text-gray-500 mb-4",children:i.length===0&&l.length===0?B?"Start following artists and venues to see their upcoming events here!":"This user isn't following any artists or venues yet.":"None of your followed artists or venues have upcoming events at the moment."}),B&&i.length===0&&l.length===0&&s.jsxs(le,{onClick:()=>e("/search"),className:"bg-pink-500 hover:bg-pink-600",children:[s.jsx($t,{className:"w-4 h-4 mr-2"}),"Discover Artists & Venues"]})]}):s.jsx("div",{className:"h-full overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(It,{className:"w-6 h-6 text-pink-500"}),s.jsx("h2",{className:"text-xl font-bold",children:S==="artist"?`${_==null?void 0:_.artist_name}'s Events`:"Upcoming Events"}),s.jsx(Ke,{variant:"secondary",className:"bg-pink-100 text-pink-700",children:S==="artist"?_==null?void 0:_.upcomingEvents.length:p.length})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Iy,{className:"w-4 h-4 text-gray-500"}),s.jsxs(aa,{value:O,onValueChange:ie=>z(ie),children:[s.jsx(Hs,{className:"w-32 bg-white border border-gray-300 hover:border-pink-300 focus:border-pink-500",children:s.jsx(ia,{})}),s.jsxs(Gs,{className:"bg-white border border-gray-200 shadow-lg",children:[s.jsx(qt,{value:"all",className:"hover:bg-pink-50 focus:bg-pink-50",children:"All"}),s.jsx(qt,{value:"artists",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Artists"}),s.jsx(qt,{value:"venues",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Venues"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(aa,{value:P,onValueChange:ie=>A(ie),children:[s.jsx(Hs,{className:"w-32 bg-white border border-gray-300 hover:border-pink-300 focus:border-pink-500",children:s.jsx(ia,{})}),s.jsxs(Gs,{className:"bg-white border border-gray-200 shadow-lg",children:[s.jsx(qt,{value:"date",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Date"}),s.jsx(qt,{value:"location",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Location"}),s.jsx(qt,{value:"price",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Price"})]})]}),s.jsx(le,{variant:"outline",size:"sm",onClick:()=>$(R==="asc"?"desc":"asc"),className:"px-2",children:R==="asc"?s.jsx(oQ,{className:"w-4 h-4"}):s.jsx(aQ,{className:"w-4 h-4"})})]}),S==="artist"&&s.jsxs(le,{variant:"default",size:"sm",onClick:()=>{console.log(" Back to all events clicked"),k("events"),w(null)},className:"bg-pink-500 hover:bg-pink-600 text-white border-0 shadow-sm",children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Back to All Events"]})]})]}),s.jsx("div",{className:"space-y-4",children:(S==="artist"&&_?_.upcomingEvents:p).map(ie=>s.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>K(ie),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("h4",{className:"font-medium text-lg",children:ie.title})}),ie.sourceName&&s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["via"," ",s.jsx("button",{onClick:se=>{se.stopPropagation(),Q(ie.source,ie.sourceName)},className:"text-pink-600 hover:text-pink-700 hover:underline cursor-pointer",children:ie.sourceName})]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(It,{className:"w-4 h-4"}),Mt(new Date(ie.event_date),"MMM d, yyyy")]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(gr,{className:"w-4 h-4"}),ie.venue_city,", ",ie.venue_state]})]}),ie.venue_address&&ie.venue_address!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-500 mb-2",children:ie.venue_address}),ie.description&&ie.description!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:ie.description})]}),s.jsx("div",{className:"flex flex-col items-end gap-2",children:ie.ticket_urls&&ie.ticket_urls.length>0&&s.jsx(Bo,{className:"w-4 h-4 text-pink-500"})})]})},`${ie.id}-${ie.title}-${ie.artist_name}`))})]})});return d?s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx(lr,{className:"w-8 h-8 animate-spin text-pink-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading followed artists..."})]})})}):f?s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:f}),s.jsxs(le,{onClick:X,variant:"outline",children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(le,{variant:"ghost",size:"sm",onClick:X,className:"hover:bg-gray-100",children:[s.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-3",children:[n==="artists"?s.jsx($t,{className:"w-6 h-6 text-pink-500"}):s.jsx(Yi,{className:"w-6 h-6 text-blue-500"}),s.jsx("h1",{className:"text-2xl font-bold",children:B?"Following":`${F}'s Following`}),s.jsx(Ke,{variant:"secondary",className:"bg-gray-100 text-gray-700",children:i.length+l.length})]})]}),s.jsx(Li,{value:n,onValueChange:ie=>{a(ie),w(null),N(null),y(null),k("events")},children:s.jsxs(yi,{children:[s.jsxs(Xr,{value:"artists",className:"gap-2",children:[s.jsx($t,{className:"w-4 h-4"}),"Artists (",i.length,")"]}),s.jsxs(Xr,{value:"venues",className:"gap-2",children:[s.jsx(Yi,{className:"w-4 h-4"}),"Venues (",l.length,")"]})]})})]})}),s.jsxs("div",{className:"flex h-[calc(100vh-80px)]",children:[s.jsxs("div",{className:"w-1/3 bg-white border-r border-gray-200 flex flex-col",children:[s.jsxs("div",{className:"p-4 border-b border-gray-200",children:[s.jsx("h2",{className:"font-semibold text-gray-900",children:n==="artists"?"Followed Artists":"Followed Venues"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:n==="artists"?`Click an artist to view their details  ${i.reduce((ie,se)=>ie+se.upcomingEvents.length,0)} upcoming events`:`Click a venue to view their details  ${l.reduce((ie,se)=>ie+se.upcomingEvents.length,0)} upcoming events`})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:n==="artists"?i.length===0?s.jsxs("div",{className:"p-4 text-center text-gray-500",children:[s.jsx($t,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"No artists followed"})]}):s.jsx("div",{className:"divide-y divide-gray-100",children:i.map(ie=>s.jsx("div",{"data-artist-id":ie.artist_id,className:`p-4 cursor-pointer transition-colors hover:bg-gray-50 ${(_==null?void 0:_.artist_id)===ie.artist_id?"bg-pink-50 border-r-2 border-pink-500":""}`,onClick:()=>Z(ie),children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Vr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(sn,{src:ie.artist_image_url}),s.jsx(Wr,{className:"bg-pink-100 text-pink-600",children:s.jsx($t,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-medium text-gray-900 truncate",children:ie.artist_name}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsxs("p",{className:"text-xs text-gray-500",children:[ie.upcomingEvents.length," upcoming events"]}),ie.upcomingEvents.length>0&&s.jsx(Ke,{variant:"secondary",className:"text-xs bg-green-100 text-green-700",children:ie.upcomingEvents.length})]})]})]})},ie.artist_id))}):l.length===0?s.jsxs("div",{className:"p-4 text-center text-gray-500",children:[s.jsx(Yi,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"No venues followed"})]}):s.jsx("div",{className:"divide-y divide-gray-100",children:l.map(ie=>s.jsx("div",{className:`p-4 cursor-pointer transition-colors hover:bg-gray-50 ${(b==null?void 0:b.id)===ie.id?"bg-blue-50 border-r-2 border-blue-500":""}`,onClick:()=>Y(ie),children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Vr,{className:"w-10 h-10 flex-shrink-0",children:s.jsx(Wr,{className:"bg-blue-100 text-blue-600",children:s.jsx(Yi,{className:"w-5 h-5"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-medium text-gray-900 truncate",children:ie.venue_name}),s.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[ie.venue_city,", ",ie.venue_state]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsxs("p",{className:"text-xs text-gray-500",children:[ie.upcomingEvents.length," upcoming events"]}),ie.upcomingEvents.length>0&&s.jsx(Ke,{variant:"secondary",className:"text-xs bg-green-100 text-green-700",children:ie.upcomingEvents.length})]})]})]})},ie.id))})})]}),s.jsx("div",{className:"flex-1 bg-white",children:S==="artist"&&_?ye():S==="venue"&&b?ee():de()})]}),v&&s.jsx(pn,{open:!!v,onOpenChange:()=>y(null),children:s.jsxs(dn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsx(Vn,{children:s.jsxs(bn,{className:"flex items-center gap-2",children:[s.jsx(It,{className:"w-5 h-5 text-pink-500"}),"Event Details"]})}),s.jsx("div",{className:"mt-4",children:s.jsx(vR,{event:v,currentUserId:(r==null?void 0:r.id)||"",showInterestButton:!1,showReviewButton:!1})})]})})]})}function C8e(){const{user:e,loading:t,sessionExpired:r}=xs(),{accountInfo:n,loading:a,isAdmin:i}=ih(),[o,l]=x.useState([]),[c,d]=x.useState(!0),[u,f]=x.useState(null),[h,p]=x.useState(""),[g,v]=x.useState(1),[y,_]=x.useState(0),[w,b]=x.useState(""),N=50,S=()=>{};x.useEffect(()=>{e&&i()&&k()},[e,g,w]);const k=()=>E(this,null,function*(){try{d(!0),f(null);const $=(g-1)*N;let O=T.from("users_complete").select("*",{count:"exact"}).order("created_at",{ascending:!1}).range($,$+N-1);w&&(O=O.eq("account_type",w)),h&&(O=O.or(`name.ilike.%${h}%,username.ilike.%${h}%,instagram_handle.ilike.%${h}%`));const{data:z,error:D,count:B}=yield O;if(D)throw D;l(z||[]),_(B||0)}catch($){console.error("Error fetching users:",$),f($.message||"Failed to fetch users")}finally{d(!1)}}),P=()=>{E(this,null,function*(){try{d(!0),f(null);let O=T.from("users_complete").select("*",{count:"exact"}).order("created_at",{ascending:!1}).range(0,N-1);w&&(O=O.eq("account_type",w)),h&&(O=O.or(`name.ilike.%${h}%,username.ilike.%${h}%,instagram_handle.ilike.%${h}%`));const{data:z,error:D,count:B}=yield O;if(D)throw D;l(z||[]),_(B||0),v(1)}catch(O){console.error("Error fetching users:",O),f(O.message||"Failed to fetch users")}finally{d(!1)}})},A=()=>{const $=["ID","User ID","Name","Username","Email","Account Type","Verified","Subscription Tier","Moderation Status","Location","Created At","Last Active"],O=o.map(U=>[U.id,U.user_id,U.name||"",U.username||"","",U.account_type,U.verified?"Yes":"No",U.subscription_tier,U.moderation_status,`${U.location_city||""}${U.location_state?", "+U.location_state:""}`,new Date(U.created_at).toLocaleDateString(),U.last_active_at?new Date(U.last_active_at).toLocaleDateString():"Never"]),z=[$.join(","),...O.map(U=>U.map(G=>`"${G}"`).join(","))].join(`
`),D=new Blob([z],{type:"text/csv"}),B=URL.createObjectURL(D),F=document.createElement("a");F.href=B,F.download=`users-export-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(B)},R=Math.ceil(y/N);return t||a?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(mi,{className:"w-8 h-8 animate-spin text-pink-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):!e||r?s.jsx(dV,{onAuthSuccess:S}):i()?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(gl,{className:"w-8 h-8 text-pink-600"}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"})]}),s.jsx("p",{className:"text-gray-600",children:"Manage users and monitor platform activity"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:k,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50",children:[s.jsx(mi,{className:`w-4 h-4 ${c?"animate-spin":""}`}),"Refresh"]}),s.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2 bg-pink-600 hover:bg-pink-700 text-white rounded-lg transition-colors",children:[s.jsx(cp,{className:"w-4 h-4"}),"Export CSV"]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(zr,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:y.toLocaleString()})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(gl,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Verified Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter($=>$.verified).length})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(zr,{className:"w-5 h-5 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Active Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter($=>{if(!$.last_active_at)return!1;const O=new Date($.last_active_at),z=new Date(Date.now()-7*24*60*60*1e3);return O>z}).length})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(gl,{className:"w-5 h-5 text-red-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Moderation Issues"})]}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter($=>$.moderation_status!=="good_standing").length})]})]}),s.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm mb-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(Uo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search by name, username, or Instagram handle...",value:h,onChange:$=>p($.target.value),onKeyPress:$=>$.key==="Enter"&&P(),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent"})]})}),s.jsxs("select",{value:w,onChange:$=>{b($.target.value),v(1)},className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"All Account Types"}),s.jsx("option",{value:"user",children:"User"}),s.jsx("option",{value:"creator",children:"Creator"}),s.jsx("option",{value:"business",children:"Business"}),s.jsx("option",{value:"admin",children:"Admin"})]}),s.jsx("button",{onClick:P,className:"px-6 py-2 bg-pink-600 hover:bg-pink-700 text-white rounded-lg transition-colors",children:"Search"})]})}),u&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-800",children:u})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:c?s.jsxs("div",{className:"p-12 text-center",children:[s.jsx(mi,{className:"w-8 h-8 animate-spin text-pink-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading users..."})]}):o.length===0?s.jsxs("div",{className:"p-12 text-center",children:[s.jsx(zr,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"No users found"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subscription"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Active"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map($=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:$.avatar_url?s.jsx("img",{className:"h-10 w-10 rounded-full",src:$.avatar_url,alt:$.name}):s.jsx("div",{className:"h-10 w-10 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx("span",{className:"text-pink-600 font-medium",children:$.name.charAt(0).toUpperCase()})})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:$.name}),s.jsxs("div",{className:"text-sm text-gray-500",children:[$.username&&`@${$.username}`,$.instagram_handle&&`  ${$.instagram_handle}`]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${$.account_type==="admin"?"bg-red-100 text-red-800":$.account_type==="creator"?"bg-purple-100 text-purple-800":$.account_type==="business"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:$.account_type})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${$.moderation_status==="good_standing"?"bg-green-100 text-green-800":$.moderation_status==="warned"?"bg-yellow-100 text-yellow-800":$.moderation_status==="restricted"?"bg-orange-100 text-orange-800":$.moderation_status==="suspended"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:$.moderation_status.replace("_"," ")}),$.verified&&s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Verified"})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${$.subscription_tier==="enterprise"?"bg-purple-100 text-purple-800":$.subscription_tier==="professional"?"bg-blue-100 text-blue-800":$.subscription_tier==="premium"?"bg-pink-100 text-pink-800":"bg-gray-100 text-gray-800"}`,children:$.subscription_tier})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[$.location_city||"N/A",$.location_state&&`, ${$.location_state}`]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date($.created_at).toLocaleDateString()}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:$.last_active_at?new Date($.last_active_at).toLocaleDateString():"Never"})]},$.id))})]})}),R>1&&s.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(g-1)*N+1," to ",Math.min(g*N,y)," of ",y," users"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>v($=>Math.max(1,$-1)),disabled:g===1,className:"px-3 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:s.jsx(pP,{className:"w-4 h-4"})}),s.jsxs("span",{className:"px-4 py-2 text-sm text-gray-700",children:["Page ",g," of ",R]}),s.jsx("button",{onClick:()=>v($=>Math.min(R,$+1)),disabled:g===R,className:"px-3 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:s.jsx(Dy,{className:"w-4 h-4"})})]})]})]})})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:s.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8 text-center",children:[s.jsx(gl,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"You need administrator privileges to access this page."}),s.jsx("button",{onClick:()=>window.location.href="/",className:"px-6 py-2 bg-pink-600 hover:bg-pink-700 text-white rounded-lg transition-colors",children:"Go to Home"})]})})}const P8e=()=>{const e=as(),r=bh().pathname,n=r==="/mobile-preview/home"||r==="/mobile-preview",a=r==="/mobile-preview/discover",i=r==="/mobile-preview/post",o=r==="/mobile-preview/messages",l=r==="/mobile-preview/profile",c=[{id:"home",label:"Home",icon:n?"houseSelected":"house",path:"/mobile-preview/home",isActive:n,useLucideForUnselected:!0,lucideIcon:vP},{id:"discover",label:"Discover",icon:a?"discoverSelected":"discover",path:"/mobile-preview/discover",isActive:a,useLucideForUnselected:!0,lucideIcon:gP},{id:"post",label:"Post",icon:"plus",path:"/mobile-preview/post",isActive:i,isCTA:!0},{id:"messages",label:"Messages",icon:o?"circleCommentSelected":"circleComment",path:"/mobile-preview/messages",isActive:o,useLucideForUnselected:!0,lucideIcon:$n},{id:"profile",label:"Profile",icon:l?"userSelected":"user",path:"/mobile-preview/profile",isActive:l,useLucideForUnselected:!0,lucideIcon:Rs}],d=u=>{e(u)};return s.jsx("nav",{className:"bottom-nav",role:"navigation","aria-label":"Main navigation",children:s.jsx("div",{className:"bottom-nav__container",children:c.map(u=>{if(u.isCTA)return s.jsx("button",{className:"bottom-nav__item bottom-nav__item--cta",onClick:()=>d(u.path),"aria-label":u.label,"aria-current":u.isActive?"page":void 0,type:"button",children:s.jsx(Se,{name:u.icon,size:24,alt:""})},u.id);if(u.useLucideForBoth&&u.lucideIcon){const f=u.lucideIcon;return s.jsx("button",{className:`bottom-nav__item ${u.isActive?"bottom-nav__item--active":""}`,onClick:()=>d(u.path),"aria-label":u.label,"aria-current":u.isActive?"page":void 0,type:"button",children:s.jsx(f,{size:24,strokeWidth:2,"aria-hidden":"true"})},u.id)}if(u.useLucideForUnselected&&u.lucideIcon&&!u.isActive){const f=u.lucideIcon;return s.jsx("button",{className:`bottom-nav__item ${u.isActive?"bottom-nav__item--active":""}`,onClick:()=>d(u.path),"aria-label":u.label,"aria-current":u.isActive?"page":void 0,type:"button",children:s.jsx(f,{size:24,strokeWidth:2,"aria-hidden":"true"})},u.id)}return s.jsx("button",{className:`bottom-nav__item ${u.isActive?"bottom-nav__item--active":""}`,onClick:()=>d(u.path),"aria-label":u.label,"aria-current":u.isActive?"page":void 0,type:"button",children:s.jsx(Se,{name:u.icon,size:24,alt:""})},u.id)})})})},T8e=({icon:e,heading:t,description:r,className:n=""})=>s.jsxs("div",{className:`empty-state ${n}`,children:[s.jsx("div",{className:"empty-state__icon",children:s.jsx(Se,{name:e,size:60,alt:""})}),s.jsx("h2",{className:"empty-state__heading",children:t}),s.jsx("p",{className:"empty-state__description",children:r})]}),lf=({value:e,interactive:t=!1,onChange:r,className:n=""})=>{const[a,i]=x.useState(null),[o,l]=x.useState(!1),c=x.useRef([]),d=x.useRef(null),u=Math.max(0,Math.min(5,e)),f=a!==null?a:u,h=(b,N)=>{if(!t||!r)return;const S=c.current[b];if(!S)return;const k=S.getBoundingClientRect(),P=N-k.left,A=k.width,R=P<A/2?.5:1,$=b+R;r($)},p=(b,N)=>{var k;if(!t)return;const S="touches"in b?(k=b.touches[0])==null?void 0:k.clientX:b.clientX;S!==void 0&&(l(!0),h(N,S))},g=b=>{var B;if(!t||!o||!d.current)return;const N="touches"in b?(B=b.touches[0])==null?void 0:B.clientX:b.clientX;if(N===void 0)return;const S=d.current.getBoundingClientRect(),k=N-S.left,A=S.width/5,R=Math.floor(k/A),$=Math.max(0,Math.min(4,R)),z=(k-$*A)/A<.5?.5:1,D=$+z;r&&r(D),i(D)},v=()=>{t&&(l(!1),i(null))},y=(b,N)=>{if(!t)return;const S=c.current[b];if(!S)return;const k=S.getBoundingClientRect(),P=N-k.left,A=k.width,R=P<A/2?.5:1,$=b+R;i($)},_=()=>{t&&!o&&i(null)};J.useEffect(()=>{if(!t)return;const b=P=>g(P),N=()=>v(),S=P=>g(P),k=()=>v();return o&&(window.addEventListener("mousemove",b),window.addEventListener("mouseup",N),window.addEventListener("touchmove",S,{passive:!1}),window.addEventListener("touchend",k)),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",N),window.removeEventListener("touchmove",S),window.removeEventListener("touchend",k)}},[t,o]);const w=b=>{const N=f-b,S=N>=1,k=N>=.5&&N<1,P=t?35:24,A={color:"var(--rating-star)",fill:"var(--rating-star)"},R={color:"var(--neutral-600)",fill:"none"},$=()=>k?s.jsxs("span",{style:{position:"relative",display:"inline-flex",width:`${P}px`,height:`${P}px`},children:[s.jsx(Qt,{size:P,style:R}),s.jsx("span",{style:{position:"absolute",top:0,left:0,width:"50%",height:"100%",overflow:"hidden"},children:s.jsx(Qt,{size:P,style:A})})]}):s.jsx(Qt,{size:P,style:S?A:R});return t?s.jsx("button",{ref:O=>{c.current[b]=O},className:"star-rating__star star-rating__star--interactive",onClick:O=>p(O,b),onMouseMove:O=>y(b,O.clientX),onMouseLeave:_,onTouchStart:O=>p(O,b),type:"button","aria-label":`Rate ${b+1} out of 5 stars`,children:$()},b):s.jsx("div",{className:"star-rating__star star-rating__star--display",children:$()},b)};return s.jsx("div",{ref:d,className:`star-rating ${n}`,role:t?"radiogroup":"img","aria-label":`Rating: ${u} out of 5 stars`,onMouseLeave:_,children:[0,1,2,3,4].map(b=>w(b))})},A8e=e=>{const t=new Date,r=typeof e=="string"?new Date(e):e;if(isNaN(r.getTime()))return"";const n=t.getTime()-r.getTime(),a=Math.floor(n/(1e3*60)),i=Math.floor(n/(1e3*60*60*24));if(a<24*60){const d=r.getHours(),u=r.getMinutes(),f=d>=12?"PM":"AM",h=d%12||12,p=u.toString().padStart(2,"0");return`${h}:${p} ${f}`}if(i<7)return["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"][r.getDay()];const o=r.getMonth()+1,l=r.getDate(),c=r.getFullYear().toString().slice(-2);return`${o}/${l}/${c}`},Cg=({name:e,lastMessage:t,lastMessageTimestamp:r,isGroupChat:n=!1,groupTag:a,avatarUrl:i,initial:o,onClick:l,onDelete:c})=>{const d=f=>{f.stopPropagation(),c&&c(f)},u=r?A8e(r):"";return s.jsxs("div",{className:"chat-list-item",onClick:l,role:"button",tabIndex:0,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),l==null||l())},children:[s.jsx("div",{className:"chat-list-item__avatar",children:s.jsx(bu,{size:45,variant:i?"image":"musicIcon",imageUrl:i||void 0,initial:o,alt:e})}),s.jsxs("div",{className:"chat-list-item__content",children:[s.jsx("div",{className:"chat-list-item__name",children:e}),t&&s.jsx("div",{className:"chat-list-item__message",children:t}),n&&a&&s.jsx("div",{className:"chat-list-item__tag",children:a})]}),s.jsxs("div",{className:"chat-list-item__right",children:[c&&s.jsx("button",{className:"chat-list-item__delete",onClick:d,"aria-label":"Delete chat",type:"button",children:s.jsx(Se,{name:"trash",size:24,alt:"Delete"})}),u&&s.jsx("div",{className:"chat-list-item__timestamp",children:u})]})]})},XY=()=>{const e=as();return s.jsx("div",{className:"component-showcase",children:s.jsxs("main",{className:"component-showcase__content",children:[s.jsxs("div",{className:"component-showcase__header",children:[s.jsx("h1",{className:"component-showcase__title",children:"Component Showcase"}),s.jsx("p",{className:"component-showcase__subtitle",children:"All design system components and variants"})]}),s.jsxs("section",{className:"component-group",style:{marginTop:"60px"},children:[s.jsx("h2",{className:"component-group__title",children:"Color Palette"}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Neutrals"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"neutral-0",value:"#FFFFFF",label:"Neutral 0"},{name:"neutral-50",value:"#FCFCFC",label:"Neutral 50"},{name:"neutral-100",value:"#F5F5F5",label:"Neutral 100"},{name:"neutral-200",value:"#E6E6E6",label:"Neutral 200"},{name:"neutral-400",value:"#8A8F98",label:"Neutral 400"},{name:"neutral-600",value:"#5D646F",label:"Neutral 600"},{name:"neutral-900",value:"#0E0E0E",label:"Neutral 900"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:t.value,border:t.name==="neutral-0"||t.name==="neutral-50"||t.name==="neutral-100"?"1px solid var(--neutral-200)":"none",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"12px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center"},children:t.value})]},t.name))})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Brand Pinks"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"brand-pink-050",value:"#FDF2F7",label:"Brand Pink 050"},{name:"brand-pink-500",value:"#CC2486",label:"Brand Pink 500"},{name:"brand-pink-600",value:"#951A6D",label:"Brand Pink 600"},{name:"brand-pink-700",value:"#7B1559",label:"Brand Pink 700"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:t.value,border:t.name==="brand-pink-050"?"1px solid var(--neutral-200)":"none",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"12px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center"},children:t.value})]},t.name))})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Status"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"status-success-050",value:"#E6F4ED",label:"Success 050"},{name:"status-success-500",value:"#2E8B63",label:"Success 500"},{name:"status-warning-050",value:"#FFF6D6",label:"Warning 050"},{name:"status-warning-500",value:"#B88900",label:"Warning 500"},{name:"status-error-050",value:"#FDECEA",label:"Error 050"},{name:"status-error-500",value:"#C62828",label:"Error 500"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:t.value,border:t.name.includes("050")?"1px solid var(--neutral-200)":"none",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"12px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center"},children:t.value})]},t.name))})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Info"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"info-blue-050",value:"#F0F6FE",label:"Info Blue 050"},{name:"info-blue-500",value:"#1F66EA",label:"Info Blue 500"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:t.value,border:t.name==="info-blue-050"?"1px solid var(--neutral-200)":"none",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"12px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center"},children:t.value})]},t.name))})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"States / Overlays"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"state-disabled-bg",value:"#E6E6E6",label:"Disabled BG"},{name:"state-disabled-text",value:"#8A8F98",label:"Disabled Text"},{name:"overlay-50",value:"rgba(14, 14, 14, 0.5)",label:"Overlay 50%"},{name:"overlay-20",value:"rgba(14, 14, 14, 0.2)",label:"Overlay 20%"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:t.value,border:t.name==="state-disabled-bg"?"1px solid var(--neutral-200)":"none",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)",position:"relative",overflow:"hidden"},children:(t.name==="overlay-50"||t.name==="overlay-20")&&s.jsx("div",{style:{position:"absolute",inset:0,backgroundImage:`
                          linear-gradient(45deg, #ccc 25%, transparent 25%),
                          linear-gradient(-45deg, #ccc 25%, transparent 25%),
                          linear-gradient(45deg, transparent 75%, #ccc 75%),
                          linear-gradient(-45deg, transparent 75%, #ccc 75%)
                        `,backgroundSize:"8px 8px",backgroundPosition:"0 0, 0 4px, 4px -4px, -4px 0px",opacity:.3}})}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"12px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center"},children:t.value})]},t.name))})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Rating"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"rating-star",value:"#FCDC5F",label:"Rating Star"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:t.value,borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"12px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center"},children:t.value})]},t.name))})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Gradients"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-grouped, 24px)"},children:[{name:"gradient-brand",value:"linear-gradient(135deg, #CC2486 0%, #8D1FF4 100%)",label:"Brand Gradient"},{name:"gradient-soft",value:"linear-gradient(180deg, #FFFFFF 0%, #FDF2F7 100%)",label:"Soft Gradient"}].map(t=>s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-inline, 6px)"},children:[s.jsx("div",{style:{width:"160px",height:"80px",background:t.value,border:t.name==="gradient-soft"?"1px solid var(--neutral-200)":"none",borderRadius:"var(--radius-corner, 10px)",boxShadow:"0 2px 4px 0 var(--shadow-color)"}}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-900)",textAlign:"center"},children:t.label}),s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"11px",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",textAlign:"center",wordBreak:"break-word",maxWidth:"160px"},children:t.value})]},t.name))})]})]}),s.jsxs("section",{className:"component-group",style:{marginTop:"60px"},children:[s.jsx("h2",{className:"component-group__title",children:"Demo Mode"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",color:"var(--neutral-600)",marginBottom:"24px",lineHeight:"1.5"},children:"Preview fully populated pages with realistic mock data. No login or network calls required."}),s.jsxs("div",{className:"component-variants",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px"},children:[s.jsx(Sn,{variant:"secondary",size:"standard",fullWidth:!0,onClick:()=>e("/mobile-preview/demo/home"),children:"Home Feed"}),s.jsx(Sn,{variant:"secondary",size:"standard",fullWidth:!0,onClick:()=>e("/mobile-preview/demo/discover"),children:"Discover"}),s.jsx(Sn,{variant:"secondary",size:"standard",fullWidth:!0,onClick:()=>e("/mobile-preview/demo/profile"),children:"Profile"}),s.jsx(Sn,{variant:"secondary",size:"standard",fullWidth:!0,onClick:()=>e("/mobile-preview/demo/messages"),children:"Messages"}),s.jsx(Sn,{variant:"secondary",size:"standard",fullWidth:!0,onClick:()=>e("/mobile-preview/demo/create-post"),children:"Create Post"})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"Icons"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Default (24px)"}),s.jsx(Se,{name:"house",size:24,alt:"Home"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Small (17px)"}),s.jsx(Se,{name:"heart",size:17,alt:"Heart"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Medium (35px)"}),s.jsx(Se,{name:"heart",size:35,alt:"Heart"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Large (60px)"}),s.jsx(Se,{name:"heart",size:60,alt:"Heart"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Selected Variants (24px)"}),s.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[s.jsx(Se,{name:"houseSelected",size:24,alt:"Home Selected"}),s.jsx(Se,{name:"discoverSelected",size:24,alt:"Discover Selected"}),s.jsx(Se,{name:"circleCommentSelected",size:24,alt:"Messages Selected"}),s.jsx(Se,{name:"userSelected",size:24,alt:"Profile Selected"})]})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Size Variants - Small (17px)"}),s.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[s.jsx(Se,{name:"smallMusic",size:17,alt:"Small Music"}),s.jsx(Se,{name:"smallLocation",size:17,alt:"Small Location"}),s.jsx(Se,{name:"smallCheck",size:17,alt:"Small Check"})]})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Size Variants - Medium (35px)"}),s.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[s.jsx(Se,{name:"mediumStar",size:35,alt:"Medium Star"}),s.jsx(Se,{name:"mediumMusic",size:35,alt:"Medium Music"}),s.jsx(Se,{name:"mediumLocation",size:35,alt:"Medium Location"}),s.jsx(Se,{name:"mediumSend",size:35,alt:"Medium Send"}),s.jsx(Se,{name:"mediumDollar",size:35,alt:"Medium Dollar"}),s.jsx(Se,{name:"mediumBuildings",size:35,alt:"Medium Buildings"}),s.jsx(Se,{name:"mediumShootingStar",size:35,alt:"Medium Shooting Star"}),s.jsx(Se,{name:"mediumMicrophone",size:35,alt:"Medium Microphone"}),s.jsx(Se,{name:"mediumEdit",size:35,alt:"Medium Edit"})]})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Size Variants - Large (60px)"}),s.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[s.jsx(Se,{name:"largeHeart",size:60,alt:"Large Heart"}),s.jsx(Se,{name:"largeStar",size:60,alt:"Large Star"}),s.jsx(Se,{name:"largeVideo",size:60,alt:"Large Video"}),s.jsx(Se,{name:"largeCamera",size:60,alt:"Large Camera"}),s.jsx(Se,{name:"largeMusic",size:60,alt:"Large Music"}),s.jsx(Se,{name:"largeMessaging",size:60,alt:"Large Messaging"})]})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Various Icons (All Normal Size)"}),s.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[s.jsx(Se,{name:"house",size:24,alt:"Home"}),s.jsx(Se,{name:"discover",size:24,alt:"Discover"}),s.jsx(Se,{name:"circleComment",size:24,alt:"Messages"}),s.jsx(Se,{name:"user",size:24,alt:"Profile"}),s.jsx(Se,{name:"plus",size:24,alt:"Post"}),s.jsx(Se,{name:"plusBox",size:24,alt:"Plus Box"}),s.jsx(Se,{name:"search",size:24,alt:"Search"}),s.jsx(Se,{name:"send",size:24,alt:"Send"}),s.jsx(Se,{name:"share",size:24,alt:"Share"}),s.jsx(Se,{name:"upload",size:24,alt:"Upload"}),s.jsx(Se,{name:"download",size:24,alt:"Download"}),s.jsx(Se,{name:"edit",size:24,alt:"Edit"}),s.jsx(Se,{name:"trash",size:24,alt:"Delete"}),s.jsx(Se,{name:"refresh",size:24,alt:"Refresh"}),s.jsx(Se,{name:"repeat",size:24,alt:"Repeat"}),s.jsx(Se,{name:"hamburgerMenu",size:24,alt:"Menu"}),s.jsx(Se,{name:"bell",size:24,alt:"Notifications"}),s.jsx(Se,{name:"settings",size:24,alt:"Settings"}),s.jsx(Se,{name:"filter",size:24,alt:"Filter"}),s.jsx(Se,{name:"sort",size:24,alt:"Sort"}),s.jsx(Se,{name:"sortFilter",size:24,alt:"Sort Filter"}),s.jsx(Se,{name:"x",size:24,alt:"Close"}),s.jsx(Se,{name:"check",size:24,alt:"Check"}),s.jsx(Se,{name:"checkMark",size:24,alt:"Check Mark"}),s.jsx(Se,{name:"circleCheck",size:24,alt:"Circle Check"}),s.jsx(Se,{name:"smallCheck",size:24,alt:"Small Check"}),s.jsx(Se,{name:"minus",size:24,alt:"Minus"}),s.jsx(Se,{name:"questionMark",size:24,alt:"Question"}),s.jsx(Se,{name:"infoCircle",size:24,alt:"Info"}),s.jsx(Se,{name:"exclamationTriangle",size:24,alt:"Warning"}),s.jsx(Se,{name:"arrowDown",size:24,alt:"Arrow Down"}),s.jsx(Se,{name:"arrowUp",size:24,alt:"Arrow Up"}),s.jsx(Se,{name:"left",size:24,alt:"Left"}),s.jsx(Se,{name:"leftArrow",size:24,alt:"Left Arrow"}),s.jsx(Se,{name:"right",size:24,alt:"Right"}),s.jsx(Se,{name:"up",size:24,alt:"Up"}),s.jsx(Se,{name:"upArrow",size:24,alt:"Up Arrow"}),s.jsx(Se,{name:"down",size:24,alt:"Down"}),s.jsx(Se,{name:"heart",size:24,alt:"Like"}),s.jsx(Se,{name:"thumbsUp",size:24,alt:"Thumbs Up"}),s.jsx(Se,{name:"star",size:24,alt:"Star"}),s.jsx(Se,{name:"image",size:24,alt:"Image"}),s.jsx(Se,{name:"photo",size:24,alt:"Photo"}),s.jsx(Se,{name:"video",size:24,alt:"Video"}),s.jsx(Se,{name:"music",size:24,alt:"Music"}),s.jsx(Se,{name:"location",size:24,alt:"Location"}),s.jsx(Se,{name:"calendar",size:24,alt:"Calendar"}),s.jsx(Se,{name:"ticket",size:24,alt:"Ticket"}),s.jsx(Se,{name:"clock",size:24,alt:"Clock"}),s.jsx(Se,{name:"envelope",size:24,alt:"Message"}),s.jsx(Se,{name:"squareComment",size:24,alt:"Comment"}),s.jsx(Se,{name:"atSymbol",size:24,alt:"Mention"}),s.jsx(Se,{name:"userPlus",size:24,alt:"Add User"}),s.jsx(Se,{name:"twoUsers",size:24,alt:"Users"}),s.jsx(Se,{name:"dollar",size:24,alt:"Dollar"}),s.jsx(Se,{name:"building",size:24,alt:"Building"}),s.jsx(Se,{name:"lock",size:24,alt:"Lock"}),s.jsx(Se,{name:"key",size:24,alt:"Key"}),s.jsx(Se,{name:"shield",size:24,alt:"Shield"}),s.jsx(Se,{name:"ban",size:24,alt:"Ban"}),s.jsx(Se,{name:"flag",size:24,alt:"Flag"}),s.jsx(Se,{name:"barChart",size:24,alt:"Bar Chart"}),s.jsx(Se,{name:"pieChart",size:24,alt:"Pie Chart"}),s.jsx(Se,{name:"trendingUp",size:24,alt:"Trending"}),s.jsx(Se,{name:"globe",size:24,alt:"Globe"}),s.jsx(Se,{name:"eye",size:24,alt:"View"}),s.jsx(Se,{name:"externalLink",size:24,alt:"External Link"}),s.jsx(Se,{name:"maximize",size:24,alt:"Maximize"}),s.jsx(Se,{name:"mousePointer",size:24,alt:"Pointer"}),s.jsx(Se,{name:"target",size:24,alt:"Target"}),s.jsx(Se,{name:"ribbonAward",size:24,alt:"Award"}),s.jsx(Se,{name:"logOut",size:24,alt:"Log Out"}),s.jsx(Se,{name:"music",size:24,alt:"Spotify"}),s.jsx(Se,{name:"music",size:24,alt:"Apple Music"}),s.jsx(Se,{name:"instagram",size:24,alt:"Instagram"})]})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"SynthButton"}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Primary"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only (Content-hugging)"}),s.jsx(Sn,{variant:"primary",children:"Primary Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only (Full-width)"}),s.jsx(Sn,{variant:"primary",fullWidth:!0,children:"Full Width Primary"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (Content-hugging)"}),s.jsx(Sn,{variant:"primary",icon:"heart",iconPosition:"left",children:"Like"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (Full-width)"}),s.jsx(Sn,{variant:"primary",icon:"heart",iconPosition:"left",fullWidth:!0,children:"Like"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (Content-hugging)"}),s.jsx(Sn,{variant:"primary",icon:"right",iconPosition:"right",children:"Next"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (Full-width)"}),s.jsx(Sn,{variant:"primary",icon:"right",iconPosition:"right",fullWidth:!0,children:"Next"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon Only (44x44)"}),s.jsx(Sn,{variant:"primary",size:"iconOnly",icon:"house","aria-label":"Home"})]})]})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Secondary"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only (Content-hugging)"}),s.jsx(Sn,{variant:"secondary",children:"Secondary Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only (Full-width)"}),s.jsx(Sn,{variant:"secondary",fullWidth:!0,children:"Full Width Secondary"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (Content-hugging)"}),s.jsx(Sn,{variant:"secondary",icon:"heart",iconPosition:"left",children:"Like"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (Full-width)"}),s.jsx(Sn,{variant:"secondary",icon:"heart",iconPosition:"left",fullWidth:!0,children:"Like"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (Content-hugging)"}),s.jsx(Sn,{variant:"secondary",icon:"right",iconPosition:"right",children:"Next"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (Full-width)"}),s.jsx(Sn,{variant:"secondary",icon:"right",iconPosition:"right",fullWidth:!0,children:"Next"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon Only (44x44)"}),s.jsx(Sn,{variant:"secondary",size:"iconOnly",icon:"house","aria-label":"Home"})]})]})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Tertiary (22px height, labels only, no full-width)"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only"}),s.jsx(Sn,{variant:"tertiary",children:"Tertiary Label"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (small icon)"}),s.jsx(Sn,{variant:"tertiary",icon:"star",iconPosition:"left",children:"Starred"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (small icon)"}),s.jsx(Sn,{variant:"tertiary",icon:"check",iconPosition:"right",children:"Verified"})]})]})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Disabled"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only (Content-hugging)"}),s.jsx(Sn,{variant:"disabled",children:"Disabled Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text Only (Full-width)"}),s.jsx(Sn,{variant:"disabled",fullWidth:!0,children:"Full Width Disabled"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (Content-hugging)"}),s.jsx(Sn,{variant:"disabled",icon:"heart",iconPosition:"left",children:"Like"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon + Text Left (Full-width)"}),s.jsx(Sn,{variant:"disabled",icon:"heart",iconPosition:"left",fullWidth:!0,children:"Like"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (Content-hugging)"}),s.jsx(Sn,{variant:"disabled",icon:"right",iconPosition:"right",children:"Next"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Text + Icon Right (Full-width)"}),s.jsx(Sn,{variant:"disabled",icon:"right",iconPosition:"right",fullWidth:!0,children:"Next"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon Only (44x44)"}),s.jsx(Sn,{variant:"disabled",size:"iconOnly",icon:"house","aria-label":"Home"})]})]})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Small Button (28px height) - Toggle Pattern"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Unselected State (Neutral surface + brand-pink border/text)"}),s.jsx("button",{style:{height:"var(--size-button-height-sm, 28px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",border:"2px solid var(--brand-pink-500)",backgroundColor:"var(--neutral-50)",color:"var(--brand-pink-500)",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 4px 0 var(--shadow-color)",marginTop:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-small, 12px)"},children:"Interested"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Selected State (Brand-pink background + inverse text)"}),s.jsx("button",{style:{height:"var(--size-button-height-sm, 28px)",paddingLeft:"var(--spacing-small, 12px)",paddingRight:"var(--spacing-small, 12px)",borderRadius:"var(--radius-corner, 10px)",fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",border:"none",backgroundColor:"var(--brand-pink-500)",color:"var(--neutral-50)",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 4px 0 var(--shadow-color)",marginTop:"var(--spacing-small, 12px)",marginBottom:"var(--spacing-small, 12px)"},children:"Interested"})]})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"UI Button (shadcn/ui variants)"}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",color:"var(--neutral-600)",marginBottom:"24px",lineHeight:"1.5"},children:"Additional button variants from the UI component library. Use SynthButton for primary actions."}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Variants"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Default (Synth Primary)"}),s.jsx(le,{variant:"default",children:"Default Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Secondary (Synth Secondary)"}),s.jsx(le,{variant:"secondary",children:"Secondary Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Outline"}),s.jsx(le,{variant:"outline",children:"Outline Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Ghost"}),s.jsx(le,{variant:"ghost",children:"Ghost Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Link"}),s.jsx(le,{variant:"link",children:"Link Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Destructive"}),s.jsx(le,{variant:"destructive",children:"Destructive Button"})]})]})]}),s.jsxs("div",{className:"component-subgroup",children:[s.jsx("h3",{className:"component-subgroup__title",children:"Sizes"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Small (sm)"}),s.jsx(le,{variant:"default",size:"sm",children:"Small Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Default"}),s.jsx(le,{variant:"default",size:"default",children:"Default Size"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Large (lg)"}),s.jsx(le,{variant:"default",size:"lg",children:"Large Button"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Icon"}),s.jsx(le,{variant:"default",size:"icon",children:s.jsx(Se,{name:"house",size:16,alt:"Home"})})]})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"ProfilePicture"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"45px - Music Icon (centered)"}),s.jsx(bu,{size:45,variant:"musicIcon",alt:"Music"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"45px - Initial (body typography, bolded)"}),s.jsx(bu,{size:45,variant:"initial",initial:"F",alt:"User"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"75px - Initial (h1 typography, for user profile)"}),s.jsx(bu,{size:75,variant:"initial",initial:"F",alt:"User Profile"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"32px - Initial (meta typography, bolded, for chat)"}),s.jsx(bu,{size:32,variant:"initial",initial:"F",alt:"Chat User"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"45px - Image (replaces design, keeps size)"}),s.jsx(bu,{size:45,variant:"image",initial:"F",imageUrl:null,alt:"User with Image"})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"UserInfo"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"User Variant"}),s.jsx(oc,{variant:"user",name:"First Last",username:"username",initial:"F"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Artist Variant"}),s.jsx(oc,{variant:"artist",name:"First Last",initial:"F"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Chat Variant"}),s.jsx(oc,{variant:"chat",name:"First Last",initial:"F"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"UserProfile Variant"}),s.jsx(oc,{variant:"userProfile",name:"First Last",username:"username",initial:"F",followers:1234,following:567,events:89})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"IconText"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Left Icon"}),s.jsx(Dg,{text:"Home",icon:"house",iconPosition:"left"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Right Icon"}),s.jsx(Dg,{text:"Next",icon:"right",iconPosition:"right"})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Clickable Left Icon"}),s.jsx(Dg,{text:"Click Me",icon:"heart",iconPosition:"left",onClick:()=>alert("Clicked!")})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Clickable Right Icon"}),s.jsx(Dg,{text:"Continue",icon:"right",iconPosition:"right",onClick:()=>alert("Clicked!")})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"MenuCategory"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Clickable Menu Item"}),s.jsx(Pu,{label:"Activity",icon:"bell",onPress:()=>alert("Activity clicked")})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Another Menu Item"}),s.jsx(Pu,{label:"Settings",icon:"settings",onPress:()=>alert("Settings clicked")})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Non-clickable"}),s.jsx(Pu,{label:"Info",icon:"infoCircle"})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"EmptyState"}),s.jsx("div",{className:"component-variants",children:s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Empty State Example"}),s.jsx(T8e,{icon:"music",heading:"No events yet",description:"Check back later for upcoming events"})]})})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"StarRating"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Display-only - 0 stars"}),s.jsx(lf,{value:0})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Display-only - 1 star"}),s.jsx(lf,{value:1})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Display-only - 2.5 stars"}),s.jsx(lf,{value:2.5})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Display-only - 3.5 stars"}),s.jsx(lf,{value:3.5})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Display-only - 5 stars"}),s.jsx(lf,{value:5})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Interactive - Tap to rate"}),s.jsx("p",{style:{fontSize:"var(--typography-meta-size, 16px)",color:"var(--color-dark-grey, #5D646F)",marginBottom:"6px",fontFamily:"var(--font-family)"},children:"tap or swipe/drag to rate"}),s.jsx(lf,{value:0,interactive:!0,onChange:t=>console.log("Rating changed:",t)})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"SearchBar"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant component-variant--search-bar",children:[s.jsx("p",{className:"component-variant__label",children:"Default (Full-width)"}),s.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:s.jsx(Xi,{placeholder:"Search"})})]}),s.jsxs("div",{className:"component-variant component-variant--search-bar",children:[s.jsx("p",{className:"component-variant__label",children:"With Value (shows X icon)"}),s.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:s.jsx(Xi,{value:"Sample search query",onChange:()=>{}})})]}),s.jsxs("div",{className:"component-variant component-variant--search-bar",children:[s.jsx("p",{className:"component-variant__label",children:"Popup Variant"}),s.jsx("div",{className:"popup-container",style:{padding:"20px",backgroundColor:"var(--neutral-50)",width:"100%",maxWidth:"100%"},children:s.jsx(Xi,{widthVariant:"popup",placeholder:"Search in popup"})})]}),s.jsxs("div",{className:"component-variant component-variant--search-bar",children:[s.jsx("p",{className:"component-variant__label",children:"Flex Variant (for Discover header)"}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",width:"100%",maxWidth:"100%"},children:[s.jsx(Xi,{widthVariant:"flex",placeholder:"Search"}),s.jsx("button",{style:{width:"44px",height:"44px",border:"1px solid var(--color-light-grey)",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"var(--color-off-white)"},"aria-label":"Menu",children:s.jsx(Se,{name:"hamburgerMenu",size:24,alt:""})})]})]}),s.jsxs("div",{className:"component-variant component-variant--search-bar",children:[s.jsx("p",{className:"component-variant__label",children:"Disabled"}),s.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:s.jsx(Xi,{placeholder:"Search",disabled:!0})})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"Chat Messages"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Message Layout (393px container example)"}),s.jsxs("div",{style:{maxWidth:"353px",width:"100%",margin:"0 auto",padding:"24px 0",backgroundColor:"var(--color-off-white, #FCFCFC)",borderRadius:"10px",paddingLeft:"20px",paddingRight:"20px"},children:[s.jsx("div",{className:"flex justify-center w-full",style:{marginBottom:"24px"},children:s.jsxs("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"#5D646F",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[s.jsx("span",{style:{fontWeight:"var(--typography-meta-weight, 700)"},children:"Monday"}),s.jsx("span",{style:{fontWeight:"var(--typography-meta-weight, 500)"},children:" at 8:03 PM"})]})}),s.jsx("div",{className:"flex flex-col",style:{alignItems:"flex-start",marginBottom:"24px"},children:s.jsxs("div",{className:"flex flex-col",style:{gap:"6px"},children:[s.jsx("div",{style:{maxWidth:"172px",padding:"12px",borderRadius:"10px",border:"1px solid var(--neutral-200)",backgroundColor:"var(--state-disabled-bg)",color:"var(--neutral-900)",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",margin:0},children:"Hey! How are you doing?"})}),s.jsx("div",{style:{maxWidth:"172px",padding:"12px",borderRadius:"10px",border:"1px solid var(--neutral-200)",backgroundColor:"var(--state-disabled-bg)",color:"var(--neutral-900)",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",margin:0},children:"Want to grab coffee later?"})}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",lineHeight:"var(--typography-meta-line-height, 1.5)",textAlign:"left",margin:0},children:"8:05 PM"})]})}),s.jsx("div",{className:"flex flex-col",style:{alignItems:"flex-end",marginBottom:"24px"},children:s.jsxs("div",{className:"flex flex-col",style:{gap:"6px"},children:[s.jsx("div",{style:{maxWidth:"172px",padding:"12px",borderRadius:"10px",border:"none",backgroundColor:"var(--brand-pink-500)",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",margin:0,color:"var(--neutral-50)"},children:"I'm doing great! Coffee sounds perfect."})}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",lineHeight:"var(--typography-meta-line-height, 1.5)",textAlign:"right",margin:0},children:"8:07 PM"})]})}),s.jsxs("div",{className:"flex flex-col",style:{alignItems:"flex-start"},children:[s.jsx("div",{style:{marginBottom:"6px"},children:s.jsx(oc,{variant:"chat",name:"John Doe",initial:"J"})}),s.jsxs("div",{className:"flex flex-col",style:{gap:"6px"},children:[s.jsx("div",{style:{maxWidth:"172px",padding:"12px",borderRadius:"10px",border:"1px solid var(--neutral-200)",backgroundColor:"var(--state-disabled-bg)",color:"var(--neutral-900)",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",margin:0},children:"This is a group chat message with user info above"})}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"var(--neutral-600)",lineHeight:"var(--typography-meta-line-height, 1.5)",textAlign:"left",margin:0},children:"8:10 PM"})]})]})]})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Spacing Rules"}),s.jsxs("ul",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",color:"var(--neutral-600)",paddingLeft:"20px",lineHeight:"1.6"},children:[s.jsx("li",{children:"6px between messages from same sender"}),s.jsx("li",{children:"24px between different senders"}),s.jsx("li",{children:"24px below session timestamp"}),s.jsx("li",{children:"6px above group chat user info"}),s.jsx("li",{children:"6px below last message for timestamp"})]})]})]})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"BottomNav"}),s.jsx("div",{className:"component-variants",children:s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Bottom Navigation (fixed at bottom)"}),s.jsx("p",{className:"component-variant__note",children:"See bottom of screen - this is a fixed component"})]})})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"MobileHeader"}),s.jsx("div",{className:"component-variants",children:s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Header with Hamburger Menu"}),s.jsx("p",{className:"component-variant__note",children:"See top of page - hamburger icon is in the header (no button styling)"})]})})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"SideMenu"}),s.jsx("div",{className:"component-variants",children:s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Side Menu Drawer"}),s.jsx("p",{className:"component-variant__note",children:"Click hamburger icon in header to open - this is a modal/drawer component"})]})})]}),s.jsxs("section",{className:"component-group",children:[s.jsx("h2",{className:"component-group__title",children:"ChatListItem"}),s.jsxs("div",{className:"component-variants",children:[s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Individual Chat"}),s.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",padding:"20px 0"},children:s.jsx(Cg,{name:"First Last",lastMessage:"Last Message",lastMessageTimestamp:new Date,initial:"F",onClick:()=>console.log("Chat clicked"),onDelete:t=>{t.stopPropagation(),console.log("Delete clicked")}})})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Group Chat"}),s.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",padding:"20px 0"},children:s.jsx(Cg,{name:"Group Chat Name",lastMessage:"Last Message",lastMessageTimestamp:new Date,isGroupChat:!0,groupTag:"User Group",initial:"G",onClick:()=>console.log("Group chat clicked"),onDelete:t=>{t.stopPropagation(),console.log("Delete clicked")}})})]}),s.jsxs("div",{className:"component-variant",children:[s.jsx("p",{className:"component-variant__label",children:"Timestamp Examples"}),s.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"12px",padding:"20px 0"},children:[s.jsx(Cg,{name:"Recent (2 hours ago)",lastMessage:"This message was sent 2 hours ago",lastMessageTimestamp:new Date(Date.now()-2*60*60*1e3),initial:"R"}),s.jsx(Cg,{name:"Yesterday",lastMessage:"This message was sent yesterday",lastMessageTimestamp:new Date(Date.now()-2*24*60*60*1e3),initial:"Y"}),s.jsx(Cg,{name:"Last Week",lastMessage:"This message was sent last week",lastMessageTimestamp:new Date(Date.now()-10*24*60*60*1e3),initial:"L"})]})]})]})]}),s.jsx("div",{style:{height:"112px"}})]})})},Kt="https://picsum.photos/400/300?random=1",Ot={id:"demo-user-123",user_id:"demo-user-123",name:"Alex Morgan",username:"alexmorgan",avatar_url:null,bio:"Music lover, concert enthusiast, always looking for the next great show!",instagram_handle:"@alexmorgan",created_at:"2024-01-15T00:00:00Z",is_public_profile:!0,account_type:"user",verified:!1,followers_count:127,following_count:89,reviews_count:23,events_attended:45},fa=[{id:"event-1",title:"Radiohead Live at Madison Square Garden",artist_name:"Radiohead",venue_name:"Madison Square Garden",venue_city:"New York",venue_state:"NY",event_date:"2024-06-15T20:00:00Z",price_range:"$75 - $250",ticket_urls:["https://example.com/tickets"],images:[{url:Kt,width:400,height:300,ratio:"16_9"}],poster_image_url:Kt,description:"An unforgettable night with Radiohead performing their greatest hits.",genres:["Alternative Rock","Electronic"],is_promoted:!1},{id:"event-2",title:"The Weeknd: After Hours Til Dawn Tour",artist_name:"The Weeknd",venue_name:"Barclays Center",venue_city:"Brooklyn",venue_state:"NY",event_date:"2025-03-15T19:30:00Z",price_range:"$100 - $350",ticket_urls:["https://example.com/tickets"],images:[{url:Kt,width:400,height:300,ratio:"16_9"}],poster_image_url:Kt,description:"Experience The Weeknd live with stunning visuals and production.",genres:["R&B","Pop"],is_promoted:!0},{id:"event-3",title:"Arctic Monkeys at Red Rocks",artist_name:"Arctic Monkeys",venue_name:"Red Rocks Amphitheatre",venue_city:"Morrison",venue_state:"CO",event_date:"2024-08-10T20:00:00Z",price_range:"$65 - $180",ticket_urls:["https://example.com/tickets"],images:[],poster_image_url:"https://picsum.photos/400/300?random=3",description:"Arctic Monkeys perform at the iconic Red Rocks venue.",genres:["Indie Rock","Alternative"],is_promoted:!1},{id:"event-4",title:"Billie Eilish: Happier Than Ever Tour",artist_name:"Billie Eilish",venue_name:"Hollywood Bowl",venue_city:"Los Angeles",venue_state:"CA",event_date:"2024-09-05T19:00:00Z",price_range:"$85 - $300",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=4",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=4",description:"Billie Eilish brings her unique sound to the Hollywood Bowl.",genres:["Pop","Alternative"],is_promoted:!1},{id:"event-5",title:"Tame Impala: Slow Rush Tour",artist_name:"Tame Impala",venue_name:"The Fillmore",venue_city:"San Francisco",venue_state:"CA",event_date:"2024-09-15T20:00:00Z",price_range:"$70 - $200",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=5",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=5",description:"Psychedelic rock at its finest with Tame Impala.",genres:["Psychedelic Rock","Indie"],is_promoted:!1},{id:"event-6",title:"Dua Lipa: Future Nostalgia Tour",artist_name:"Dua Lipa",venue_name:"TD Garden",venue_city:"Boston",venue_state:"MA",event_date:"2024-10-01T19:30:00Z",price_range:"$90 - $280",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=6",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=6",description:"Dua Lipa brings her dance-pop hits to Boston.",genres:["Pop","Dance"],is_promoted:!0},{id:"event-7",title:"The Strokes at Forest Hills Stadium",artist_name:"The Strokes",venue_name:"Forest Hills Stadium",venue_city:"Queens",venue_state:"NY",event_date:"2024-10-10T20:00:00Z",price_range:"$60 - $175",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=7",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=7",description:"The Strokes return to New York for an epic show.",genres:["Indie Rock","Alternative"],is_promoted:!1},{id:"event-8",title:"Lana Del Rey: Did You Know Tour",artist_name:"Lana Del Rey",venue_name:"Merriweather Post Pavilion",venue_city:"Columbia",venue_state:"MD",event_date:"2024-10-20T19:00:00Z",price_range:"$75 - $250",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=8",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=8",description:"Lana Del Rey's dreamy vocals in an outdoor setting.",genres:["Pop","Indie"],is_promoted:!1},{id:"event-9",title:"Phoenix: Alpha Zulu Tour",artist_name:"Phoenix",venue_name:"Brooklyn Steel",venue_city:"Brooklyn",venue_state:"NY",event_date:"2024-11-05T20:00:00Z",price_range:"$55 - $150",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=9",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=9",description:"French indie pop at its finest with Phoenix.",genres:["Indie Pop","Electronic"],is_promoted:!1},{id:"event-10",title:"Florence + The Machine: Dance Fever Tour",artist_name:"Florence + The Machine",venue_name:"Radio City Music Hall",venue_city:"New York",venue_state:"NY",event_date:"2024-11-15T20:00:00Z",price_range:"$80 - $220",ticket_urls:["https://example.com/tickets"],images:[{url:"https://picsum.photos/400/300?random=10",width:400,height:300,ratio:"16_9"}],poster_image_url:"https://picsum.photos/400/300?random=10",description:"Florence Welch's powerful vocals in an iconic venue.",genres:["Indie Rock","Pop"],is_promoted:!1}],w$=[{id:"artist-radiohead",name:"Radiohead",image_url:Kt,genres:["Alternative Rock","Electronic"]},{id:"artist-theweeknd",name:"The Weeknd",image_url:Kt,genres:["R&B","Pop"]},{id:"artist-arcticmonkeys",name:"Arctic Monkeys",image_url:Kt,genres:["Indie Rock","Alternative"]},{id:"artist-billieeilish",name:"Billie Eilish",image_url:Kt,genres:["Pop","Alternative"]},{id:"artist-taylorswift",name:"Taylor Swift",image_url:Kt,genres:["Pop","Country"]}],b$=[{id:"venue-msg",name:"Madison Square Garden",identifier:"MSG",city:"New York",state:"NY",country:"US",image_url:Kt},{id:"venue-barclays",name:"Barclays Center",identifier:"BARCLAYS",city:"Brooklyn",state:"NY",country:"US",image_url:Kt},{id:"venue-redrocks",name:"Red Rocks Amphitheatre",identifier:"REDROCKS",city:"Morrison",state:"CO",country:"US",image_url:Kt},{id:"venue-hollywoodbowl",name:"Hollywood Bowl",identifier:"HWDBOWL",city:"Los Angeles",state:"CA",country:"US",image_url:Kt},{id:"venue-fillmore",name:"The Fillmore",identifier:"FILLMORESF",city:"San Francisco",state:"CA",country:"US",image_url:Kt}],Fu=[{id:"review-1",user_id:Ot.id,event_id:"event-1",rating:5,artist_performance_rating:5,production_rating:4.5,venue_rating:4,location_rating:5,value_rating:4.5,review_text:"Absolutely incredible show! Radiohead delivered an amazing performance. The sound quality was perfect and the setlist was everything I hoped for. The venue was great too, though parking was a bit of a hassle.",artist_performance_feedback:"Thom Yorke was in top form, hitting every note perfectly.",production_feedback:"Lighting and visuals were stunning, really enhanced the experience.",venue_feedback:"Great acoustics, comfortable seating, but parking was expensive.",location_feedback:"Easy to get to via subway, lots of restaurants nearby.",value_feedback:"Worth every penny, would definitely go again.",photos:[Kt,Kt],is_public:!0,is_draft:!1,created_at:"2024-06-16T10:30:00Z",updated_at:"2024-06-16T10:30:00Z",likes_count:42,comments_count:8,shares_count:3,reaction_emoji:"",mood_tags:["energetic","emotional","memorable"],genre_tags:["alternative rock"],review_type:"event",was_there:!0,Event_date:new Date("2024-06-15")},{id:"review-2",user_id:Ot.id,event_id:"event-2",rating:4,artist_performance_rating:4.5,production_rating:5,venue_rating:4.5,location_rating:4,value_rating:3.5,review_text:"The Weeknd put on an amazing show! The production value was off the charts. My only complaint is that tickets were quite expensive, but the experience was worth it.",artist_performance_feedback:"Abel sounded incredible live, even better than the studio recordings.",production_feedback:"Best production I've ever seen - lasers, screens, everything was perfect.",venue_feedback:"Barclays Center is a great venue, good sightlines from everywhere.",location_feedback:"Brooklyn is always fun, lots to do before and after.",value_feedback:"Expensive but you get what you pay for - a top-tier production.",photos:[Kt],is_public:!0,is_draft:!1,created_at:"2024-07-21T14:20:00Z",likes_count:28,comments_count:5,shares_count:1,reaction_emoji:"",mood_tags:["spectacular","high-energy"],genre_tags:["r&b","pop"],review_type:"event",was_there:!0,Event_date:new Date("2024-07-20")},{id:"review-3",user_id:Ot.id,event_id:"event-3",rating:5,artist_performance_rating:5,production_rating:4,venue_rating:5,location_rating:5,value_rating:5,review_text:"Red Rocks is magical. Arctic Monkeys + this venue = perfection. The natural acoustics combined with their performance made for an unforgettable night.",artist_performance_feedback:"Alex Turner and the band were flawless.",production_feedback:"Simple but effective, let the music and venue shine.",venue_feedback:"Red Rocks is the best venue in the world, period.",location_feedback:"Beautiful location, great hiking nearby.",value_feedback:"Best value for money - incredible experience at a reasonable price.",photos:[Kt,Kt,Kt],is_public:!0,is_draft:!1,created_at:"2024-08-11T09:15:00Z",likes_count:67,comments_count:12,shares_count:5,reaction_emoji:"",mood_tags:["magical","peaceful","inspiring"],genre_tags:["indie rock"],review_type:"event",was_there:!0,Event_date:new Date("2024-08-10")},{id:"review-4",user_id:Ot.id,event_id:"event-4",rating:4,artist_performance_rating:null,production_rating:null,venue_rating:4.5,location_rating:4,value_rating:4,review_text:"The Hollywood Bowl is such a beautiful venue. The sound system is incredible and the atmosphere is unbeatable. Great staff too!",artist_performance_feedback:null,production_feedback:null,venue_feedback:"Amazing sound quality, comfortable seating, and helpful staff.",location_feedback:"Easy parking, beautiful location in the hills.",value_feedback:"Good value for such a premium venue experience.",photos:[Kt],is_public:!0,is_draft:!1,created_at:"2024-09-06T11:00:00Z",likes_count:15,comments_count:3,shares_count:1,reaction_emoji:"",mood_tags:["peaceful","beautiful"],genre_tags:[],venue_tags:["great-sound","beautiful-venue"],review_type:"venue",was_there:!0,Event_date:new Date("2024-09-05")},{id:"review-5",user_id:Ot.id,event_id:"event-5",rating:5,artist_performance_rating:5,production_rating:4.5,venue_rating:null,location_rating:null,value_rating:null,review_text:"Tame Impala's performance was absolutely mind-blowing. Kevin Parker's vocals and the band's energy were incredible. One of the best shows I've ever seen.",artist_performance_feedback:"Kevin Parker is a musical genius. The live versions were even better than the albums.",production_feedback:"The light show was mesmerizing and perfectly synced with the music.",venue_feedback:null,location_feedback:null,value_feedback:null,photos:[Kt,Kt],is_public:!0,is_draft:!1,created_at:"2024-09-16T16:30:00Z",likes_count:89,comments_count:15,shares_count:7,reaction_emoji:"",mood_tags:["mind-blowing","trippy","energetic"],genre_tags:["psychedelic rock"],artist_tags:["amazing-performance","great-vocals"],review_type:"artist",was_there:!0,Event_date:new Date("2024-09-15")},{id:"review-6",user_id:Ot.id,event_id:"event-6",rating:4,artist_performance_rating:4.5,production_rating:5,venue_rating:4,location_rating:3.5,value_rating:4,review_text:"Dua Lipa knows how to put on a show! The choreography was incredible and the energy was through the roof. TD Garden is a solid venue.",artist_performance_feedback:"Dua's stage presence is unmatched, and her vocals were spot-on.",production_feedback:"The dance numbers and visuals were top-notch.",venue_feedback:"Good venue, though the sound could be better in the upper levels.",location_feedback:"Boston traffic is always a challenge, but worth it.",value_feedback:"Fair pricing for the production value.",photos:[Kt],is_public:!0,is_draft:!1,created_at:"2024-10-02T12:00:00Z",likes_count:34,comments_count:6,shares_count:2,reaction_emoji:"",mood_tags:["high-energy","fun"],genre_tags:["pop","dance"],review_type:"event",was_there:!0,Event_date:new Date("2024-10-01")},{id:"review-7",user_id:Ot.id,event_id:"event-7",rating:5,artist_performance_rating:5,production_rating:4,venue_rating:4.5,location_rating:4.5,value_rating:4.5,review_text:"The Strokes at Forest Hills was everything I hoped for. Classic songs, great energy, and a perfect summer night.",artist_performance_feedback:"Julian Casablancas sounded amazing, and the band was tight.",production_feedback:"Simple setup that let the music speak for itself.",venue_feedback:"Forest Hills is a great outdoor venue with good sound.",location_feedback:"Queens is accessible and has great food options nearby.",value_feedback:"Great value for such an iconic band.",photos:[Kt,Kt],is_public:!0,is_draft:!1,created_at:"2024-10-11T10:30:00Z",likes_count:52,comments_count:9,shares_count:4,reaction_emoji:"",mood_tags:["nostalgic","energetic"],genre_tags:["indie rock"],review_type:"event",was_there:!0,Event_date:new Date("2024-10-10")},{id:"review-8",user_id:Ot.id,event_id:"event-8",rating:4,artist_performance_rating:4.5,production_rating:4,venue_rating:4.5,location_rating:5,value_rating:4,review_text:"Lana Del Rey's voice is even more beautiful live. The outdoor setting at Merriweather was perfect for her dreamy sound.",artist_performance_feedback:"Lana's vocals were ethereal and captivating.",production_feedback:"Simple but elegant staging that matched the music.",venue_feedback:"Merriweather is a beautiful outdoor venue with great acoustics.",location_feedback:"Beautiful park setting, easy parking, great atmosphere.",value_feedback:"Worth the drive from the city for this experience.",photos:[Kt],is_public:!0,is_draft:!1,created_at:"2024-10-21T14:00:00Z",likes_count:41,comments_count:7,shares_count:3,reaction_emoji:"",mood_tags:["dreamy","peaceful"],genre_tags:["pop","indie"],review_type:"event",was_there:!0,Event_date:new Date("2024-10-20")},{id:"review-9",user_id:Ot.id,event_id:"event-9",rating:4,artist_performance_rating:4.5,production_rating:4.5,venue_rating:4,location_rating:4,value_rating:4.5,review_text:"Phoenix always delivers! Great energy, amazing setlist, and Brooklyn Steel is the perfect venue for their sound.",artist_performance_feedback:"Thomas Mars and the band were on fire.",production_feedback:"Great light show and visuals.",venue_feedback:"Brooklyn Steel has great sound and intimate feel.",location_feedback:"Easy to get to, good food options nearby.",value_feedback:"Excellent value for such a great show.",photos:[Kt],is_public:!0,is_draft:!1,created_at:"2024-11-06T13:15:00Z",likes_count:29,comments_count:5,shares_count:2,reaction_emoji:"",mood_tags:["energetic","fun"],genre_tags:["indie pop"],review_type:"event",was_there:!0,Event_date:new Date("2024-11-05")},{id:"review-10",user_id:Ot.id,event_id:"event-10",rating:5,artist_performance_rating:5,production_rating:4.5,venue_rating:5,location_rating:5,value_rating:4.5,review_text:"Florence Welch is a force of nature. Her voice filled Radio City and the performance was absolutely transcendent.",artist_performance_feedback:"Florence's vocals are otherworldly. She hit every note perfectly.",production_feedback:"Beautiful staging that complemented the music perfectly.",venue_feedback:"Radio City is iconic and the sound was perfect.",location_feedback:"Perfect location in Manhattan, easy to get to.",value_feedback:"Worth every penny for this experience.",photos:[Kt,Kt],is_public:!0,is_draft:!1,created_at:"2024-11-16T11:30:00Z",likes_count:78,comments_count:14,shares_count:6,reaction_emoji:"",mood_tags:["transcendent","emotional","powerful"],genre_tags:["indie rock","pop"],review_type:"event",was_there:!0,Event_date:new Date("2024-11-15")},{id:"review-11",user_id:Ot.id,event_id:"event-1",rating:4,artist_performance_rating:4,production_rating:4.5,venue_rating:4.5,location_rating:4,value_rating:4,review_text:"Second time seeing Radiohead and they never disappoint. The setlist was perfect and the crowd energy was amazing.",artist_performance_feedback:"Great performance, though I wish they played more from OK Computer.",production_feedback:"The visuals were stunning and really enhanced the experience.",venue_feedback:"MSG is always a great venue, though it can get loud.",location_feedback:"Easy to get to, lots of options nearby.",value_feedback:"Good value for such a legendary band.",photos:[Kt],is_public:!0,is_draft:!1,created_at:"2024-06-20T15:00:00Z",likes_count:35,comments_count:6,shares_count:2,reaction_emoji:"",mood_tags:["nostalgic","energetic"],genre_tags:["alternative rock"],review_type:"event",was_there:!0,Event_date:new Date("2024-06-15")},{id:"review-12",user_id:Ot.id,event_id:"event-2",rating:5,artist_performance_rating:5,production_rating:5,venue_rating:4.5,location_rating:4.5,value_rating:4,review_text:"The Weeknd's show was absolutely spectacular. The production was unlike anything I've ever seen. Worth every dollar!",artist_performance_feedback:"Abel's voice is incredible live, even better than recordings.",production_feedback:"The stage design and visuals were mind-blowing.",venue_feedback:"Barclays Center handled the production perfectly.",location_feedback:"Brooklyn has great pre-show spots.",value_feedback:"Expensive but you get a full production experience.",photos:[Kt,Kt],is_public:!0,is_draft:!1,created_at:"2024-07-25T18:00:00Z",likes_count:56,comments_count:10,shares_count:4,reaction_emoji:"",mood_tags:["spectacular","high-energy"],genre_tags:["r&b","pop"],review_type:"event",was_there:!0,Event_date:new Date("2024-07-20")}],ja=[{user_id:"user-sarah-456",name:"Sarah Chen",avatar_url:Kt,username:"sarahchen",is_public_profile:!0,account_type:"user",verified:!1},{user_id:"user-mike-789",name:"Mike Johnson",avatar_url:Kt,username:"mikejohnson",is_public_profile:!0,account_type:"user",verified:!1},{user_id:"user-emma-101",name:"Emma Davis",avatar_url:Kt,username:"emmadavis",is_public_profile:!0,account_type:"user",verified:!1},{user_id:"user-chris-202",name:"Chris Wilson",avatar_url:Kt,username:"chriswilson",is_public_profile:!0,account_type:"user",verified:!1}],j$=[{id:"chat-1",chat_name:"Sarah Chen",is_group_chat:!1,users:[Ot.id,"user-sarah-456"],latest_message:"Perfect! See you there!",latest_message_created_at:"2024-08-20T15:30:00Z",latest_message_sender_name:"Sarah Chen",created_at:"2024-08-15T10:00:00Z",updated_at:"2024-08-20T15:30:00Z",has_unread:!0,unread_count:2,entity_type:null,entity_id:null,is_verified:!1,member_count:2},{id:"chat-2",chat_name:"Radiohead Fans NYC",is_group_chat:!0,users:[Ot.id,"user-1","user-2","user-3","user-4"],latest_message:"Anyone want to grab drinks before the show?",latest_message_created_at:"2024-08-20T14:15:00Z",latest_message_sender_name:"Mike Johnson",created_at:"2024-07-01T00:00:00Z",updated_at:"2024-08-20T14:15:00Z",has_unread:!1,unread_count:0,entity_type:"event",entity_id:"event-1",is_verified:!0,member_count:5,event_image_url:Kt},{id:"chat-3",chat_name:"Content Showcase",is_group_chat:!0,users:[Ot.id,ja[0].user_id,ja[1].user_id],latest_message:"Check out this venue!",latest_message_created_at:"2024-08-21T16:00:00Z",latest_message_sender_name:Ot.name,created_at:"2024-08-21T10:00:00Z",updated_at:"2024-08-21T16:00:00Z",has_unread:!1,unread_count:0,entity_type:null,entity_id:null,is_verified:!1,member_count:3,event_image_url:null}],R8e={"chat-1":[{id:"msg-1",chat_id:"chat-1",sender_id:"user-sarah-456",sender_name:"Sarah Chen",sender_avatar:null,content:"Hey! Are you going to the Radiohead show next week?",created_at:"2024-08-18T10:00:00Z",message_type:"text"},{id:"msg-2",chat_id:"chat-1",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:null,content:"Yes! I got tickets in section 200. So excited!",created_at:"2024-08-18T10:05:00Z",message_type:"text"},{id:"msg-3",chat_id:"chat-1",sender_id:"user-sarah-456",sender_name:"Sarah Chen",sender_avatar:null,content:"Awesome! I'm in section 150. We should meet up before the show!",created_at:"2024-08-18T10:07:00Z",message_type:"text"},{id:"msg-4",chat_id:"chat-1",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:null,content:"Definitely! There's a great bar right across the street.",created_at:"2024-08-18T10:10:00Z",message_type:"text"},{id:"msg-5",chat_id:"chat-1",sender_id:"user-sarah-456",sender_name:"Sarah Chen",sender_avatar:null,content:"Perfect! See you there!",created_at:"2024-08-20T15:30:00Z",message_type:"text"}],"chat-2":[{id:"msg-6",chat_id:"chat-2",sender_id:"user-1",sender_name:"Mike Johnson",sender_avatar:null,content:"Hey everyone! Who's excited for the Radiohead show?",created_at:"2024-08-19T09:00:00Z",message_type:"text"},{id:"msg-7",chat_id:"chat-2",sender_id:"user-2",sender_name:"Emma Davis",sender_avatar:null,content:"So excited! This will be my first time seeing them live.",created_at:"2024-08-19T09:05:00Z",message_type:"text"},{id:"msg-8",chat_id:"chat-2",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:null,content:"You're in for a treat! I saw them last year and it was incredible.",created_at:"2024-08-19T09:10:00Z",message_type:"text"},{id:"msg-9",chat_id:"chat-2",sender_id:"user-3",sender_name:"Chris Wilson",sender_avatar:null,content:"Does anyone know what time doors open?",created_at:"2024-08-19T10:00:00Z",message_type:"text"},{id:"msg-10",chat_id:"chat-2",sender_id:"user-1",sender_name:"Mike Johnson",sender_avatar:null,content:"I think it's 7pm, but let me check the ticket.",created_at:"2024-08-19T10:05:00Z",message_type:"text"},{id:"msg-11",chat_id:"chat-2",sender_id:"user-1",sender_name:"Mike Johnson",sender_avatar:null,content:"Anyone want to grab drinks before the show?",created_at:"2024-08-20T14:15:00Z",message_type:"text"}],"chat-3":[{id:"msg-12",chat_id:"chat-3",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:Ot.avatar_url,content:"Hey! Check out this review I wrote",created_at:"2024-08-21T10:00:00Z",message_type:"review_share",shared_review_id:Fu[0].id,metadata:{custom_message:"Check out this review I wrote"}},{id:"msg-13",chat_id:"chat-3",sender_id:ja[0].user_id,sender_name:ja[0].name,sender_avatar:ja[0].avatar_url,content:"Wow, that sounds amazing! I need to see Radiohead live.",created_at:"2024-08-21T10:05:00Z",message_type:"text"},{id:"msg-14",chat_id:"chat-3",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:Ot.avatar_url,content:"You should! Also, check out this event coming up",created_at:"2024-08-21T10:10:00Z",message_type:"event_share",shared_event_id:fa[1].id,metadata:{custom_message:"You should! Also, check out this event coming up"}},{id:"msg-15",chat_id:"chat-3",sender_id:ja[1].user_id,sender_name:ja[1].name,sender_avatar:ja[1].avatar_url,content:"The Weeknd is one of my favorite artists! Have you seen them live?",created_at:"2024-08-21T10:15:00Z",message_type:"text"},{id:"msg-16",chat_id:"chat-3",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:Ot.avatar_url,content:"Yes! They put on an incredible show. Here's the artist profile",created_at:"2024-08-21T10:20:00Z",message_type:"text",metadata:{shared_artist_id:w$[1].id,shared_artist_name:w$[1].name}},{id:"msg-17",chat_id:"chat-3",sender_id:ja[0].user_id,sender_name:ja[0].name,sender_avatar:ja[0].avatar_url,content:"That venue looks amazing! Where is it?",created_at:"2024-08-21T10:25:00Z",message_type:"text"},{id:"msg-18",chat_id:"chat-3",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:Ot.avatar_url,content:"It's in Brooklyn! Here's the venue",created_at:"2024-08-21T10:30:00Z",message_type:"text",metadata:{shared_venue_id:b$[1].id,shared_venue_name:b$[1].name}},{id:"msg-19",chat_id:"chat-3",sender_id:ja[1].user_id,sender_name:ja[1].name,sender_avatar:ja[1].avatar_url,content:"You should check out @sarahchen's profile, she has great taste in music!",created_at:"2024-08-21T10:35:00Z",message_type:"text",metadata:{shared_user_id:ja[0].user_id,shared_user_name:ja[0].name}},{id:"msg-20",chat_id:"chat-3",sender_id:Ot.id,sender_name:Ot.name,sender_avatar:Ot.avatar_url,content:"Thanks for the recommendation! This group chat is great for sharing music finds.",created_at:"2024-08-21T16:00:00Z",message_type:"text"}]},O8e={users:[{id:"user-sarah-456",user_id:"user-sarah-456",name:"Sarah Chen",username:"sarahchen",avatar_url:null}],artists:[{id:"artist-radiohead",name:"Radiohead",image_url:Kt,jambase_artist_id:"demo-radiohead"}],events:[{id:"event-1",title:"Radiohead Live at Madison Square Garden",artist_name:"Radiohead",venue_name:"Madison Square Garden",venue_city:"New York",venue_state:"NY",event_date:"2024-06-15T20:00:00Z",poster_image_url:Kt}],venues:[{id:"venue-msg",name:"Madison Square Garden",image_url:Kt,city:"New York",state:"NY"}]},N$=[fa[1],fa[3],fa[5],fa[7],fa[9]],M8e=[fa[1],{id:"event-upcoming-1",title:"Phoenix: Alpha Zulu Tour",artist_name:"Phoenix",venue_name:"Brooklyn Steel",venue_city:"Brooklyn",venue_state:"NY",event_date:"2025-04-20T20:00:00Z",price_range:"$55 - $150",ticket_urls:["https://example.com/tickets"],images:[{url:Kt,width:400,height:300,ratio:"16_9"}],poster_image_url:Kt,description:"French indie pop at its finest with Phoenix.",genres:["Indie Pop","Electronic"],is_promoted:!1},{id:"event-upcoming-2",title:"Tame Impala: Slow Rush Tour",artist_name:"Tame Impala",venue_name:"The Fillmore",venue_city:"San Francisco",venue_state:"CA",event_date:"2025-05-10T20:00:00Z",price_range:"$70 - $200",ticket_urls:["https://example.com/tickets"],images:[{url:Kt,width:400,height:300,ratio:"16_9"}],poster_image_url:Kt,description:"Psychedelic rock at its finest with Tame Impala.",genres:["Psychedelic Rock","Indie"],is_promoted:!1},{id:"event-upcoming-3",title:"Arctic Monkeys at Red Rocks",artist_name:"Arctic Monkeys",venue_name:"Red Rocks Amphitheatre",venue_city:"Morrison",venue_state:"CO",event_date:"2025-06-15T20:00:00Z",price_range:"$65 - $180",ticket_urls:["https://example.com/tickets"],images:[{url:Kt,width:400,height:300,ratio:"16_9"}],poster_image_url:Kt,description:"Arctic Monkeys return to the iconic Red Rocks venue.",genres:["Indie Rock","Alternative"],is_promoted:!1}],D8e={user_id:Ot.id,fan_type:"jam_chaser",home_scene_id:null,join_year:2024,calculated_at:"2024-01-15T00:00:00Z",updated_at:"2024-11-20T00:00:00Z",home_scene:null,home_city:"New York"},I8e=[{id:"stamp-1",user_id:Ot.id,type:"city",entity_id:"new-york",entity_uuid:null,entity_name:"New York",unlocked_at:"2024-06-15T20:00:00Z",metadata:{count:15},rarity:"common"},{id:"stamp-2",user_id:Ot.id,type:"city",entity_id:"los-angeles",entity_uuid:null,entity_name:"Los Angeles",unlocked_at:"2024-09-05T19:00:00Z",metadata:{count:8},rarity:"common"},{id:"stamp-3",user_id:Ot.id,type:"venue",entity_id:null,entity_uuid:"venue-msg",entity_name:"Madison Square Garden",unlocked_at:"2024-06-15T20:00:00Z",metadata:{},rarity:"uncommon"},{id:"stamp-4",user_id:Ot.id,type:"venue",entity_id:null,entity_uuid:"venue-redrocks",entity_name:"Red Rocks Amphitheatre",unlocked_at:"2024-08-10T20:00:00Z",metadata:{},rarity:"legendary"},{id:"stamp-5",user_id:Ot.id,type:"artist",entity_id:null,entity_uuid:"artist-radiohead",entity_name:"Radiohead",unlocked_at:"2024-06-15T20:00:00Z",metadata:{},rarity:"uncommon"},{id:"stamp-6",user_id:Ot.id,type:"artist",entity_id:null,entity_uuid:"artist-arcticmonkeys",entity_name:"Arctic Monkeys",unlocked_at:"2024-08-10T20:00:00Z",metadata:{},rarity:"common"}],$8e=[{id:"ach-1",type:"shows_attended",name:"Concert Goer",description:"Attend 10 shows",icon:"",tier:"bronze",progress:45,goal:10,unlocked:!0,unlocked_at:"2024-06-20T00:00:00Z"},{id:"ach-2",type:"cities_visited",name:"World Traveler",description:"Visit 5 different cities",icon:"",tier:"silver",progress:12,goal:5,unlocked:!0,unlocked_at:"2024-08-15T00:00:00Z"},{id:"ach-3",type:"reviews_written",name:"Reviewer",description:"Write 20 reviews",icon:"",tier:"bronze",progress:23,goal:20,unlocked:!0,unlocked_at:"2024-10-01T00:00:00Z"},{id:"ach-4",type:"venues_visited",name:"Venue Explorer",description:"Visit 25 different venues",icon:"",tier:"gold",progress:25,goal:25,unlocked:!0,unlocked_at:"2024-11-15T00:00:00Z"},{id:"ach-5",type:"artists_seen",name:"Music Lover",description:"See 30 different artists",icon:"",tier:"silver",progress:38,goal:30,unlocked:!0,unlocked_at:"2024-09-10T00:00:00Z"},{id:"ach-6",type:"perfect_ratings",name:"Perfectionist",description:"Give 5 perfect 5-star ratings",icon:"",tier:"bronze",progress:3,goal:5,unlocked:!1}],L8e=[{id:"timeline-1",review_id:"review-1",is_pinned:!0,is_auto_selected:!1,significance:"First Radiohead show",description:"My first time seeing Radiohead live - absolutely magical!",Event_name:"Radiohead Live at Madison Square Garden",created_at:"2024-06-16T10:30:00Z",review:{id:"review-1",rating:5,review_text:"Absolutely incredible show! Radiohead delivered an amazing performance.",Event_date:"2024-06-15",event_id:"event-1"}},{id:"timeline-2",review_id:"review-3",is_pinned:!0,is_auto_selected:!1,significance:"Red Rocks milestone",description:"Bucket list venue checked off!",Event_name:"Arctic Monkeys at Red Rocks",created_at:"2024-08-11T09:15:00Z",review:{id:"review-3",rating:5,review_text:"Red Rocks is magical. Arctic Monkeys + this venue = perfection.",Event_date:"2024-08-10",event_id:"event-3"}},{id:"timeline-3",review_id:"review-7",is_pinned:!1,is_auto_selected:!0,significance:null,description:null,Event_name:"Taylor Swift: The Eras Tour",created_at:"2024-10-11T10:00:00Z",review:{id:"review-7",rating:5,review_text:"Taylor Swift's Eras Tour is an absolute spectacle!",Event_date:"2024-10-10",event_id:"event-5"}},{id:"timeline-4",review_id:"review-10",is_pinned:!1,is_auto_selected:!0,significance:null,description:null,Event_name:"Florence + The Machine: Dance Fever Tour",created_at:"2024-11-16T11:30:00Z",review:{id:"review-10",rating:5,review_text:"Florence Welch is a force of nature.",Event_date:"2024-11-15",event_id:"event-10"}},{id:"timeline-5",review_id:"review-2",is_pinned:!1,is_auto_selected:!0,significance:null,description:null,Event_name:"The Weeknd: After Hours Til Dawn Tour",created_at:"2024-07-21T14:20:00Z",review:{id:"review-2",rating:4,review_text:"The Weeknd put on an amazing show! The production value was off the charts.",Event_date:"2024-07-20",event_id:"event-2"}},{id:"timeline-6",review_id:"review-4",is_pinned:!1,is_auto_selected:!0,significance:null,description:null,Event_name:"Madison Square Garden Venue Review",created_at:"2024-03-01T18:00:00Z",review:{id:"review-4",rating:4,review_text:"Madison Square Garden is always a classic. Great atmosphere, but concessions are pricey.",Event_date:"2024-03-01",event_id:null}},{id:"timeline-7",review_id:"review-5",is_pinned:!1,is_auto_selected:!0,significance:null,description:null,Event_name:"Billie Eilish Artist Review",created_at:"2024-04-10T12:00:00Z",review:{id:"review-5",rating:5,review_text:"Billie Eilish is a phenomenal artist. Her stage presence and vocal control are unmatched.",Event_date:"2024-04-10",event_id:null}},{id:"timeline-8",review_id:"review-8",is_pinned:!1,is_auto_selected:!0,significance:null,description:null,Event_name:"Jazz Night at The Blue Note",created_at:"2024-05-26T13:00:00Z",review:{id:"review-8",rating:4,review_text:"The Blue Note always delivers a great jazz experience. Intimate setting, good drinks.",Event_date:"2024-05-25",event_id:"event-6"}}],F8e=[{id:"bucket-1",user_id:Ot.id,entity_type:"artist",entity_id:"artist-taylorswift",entity_name:"Taylor Swift",added_at:"2024-01-20T00:00:00Z",metadata:{},artist:{id:"artist-taylorswift",name:"Taylor Swift",image_url:Kt}},{id:"bucket-2",user_id:Ot.id,entity_type:"venue",entity_id:"venue-carnegie",entity_name:"Carnegie Hall",added_at:"2024-02-15T00:00:00Z",metadata:{},venue:{id:"venue-carnegie",name:"Carnegie Hall",image_url:Kt}},{id:"bucket-3",user_id:Ot.id,entity_type:"artist",entity_id:"artist-beyonce",entity_name:"Beyonc",added_at:"2024-03-10T00:00:00Z",metadata:{},artist:{id:"artist-beyonce",name:"Beyonc",image_url:Kt}},{id:"bucket-4",user_id:Ot.id,entity_type:"venue",entity_id:"venue-msg",entity_name:"Madison Square Garden",added_at:"2024-04-05T00:00:00Z",metadata:{},venue:{id:"venue-msg",name:"Madison Square Garden",image_url:Kt}},{id:"bucket-5",user_id:Ot.id,entity_type:"artist",entity_id:"artist-radiohead",entity_name:"Radiohead",added_at:"2024-05-01T00:00:00Z",metadata:{},artist:{id:"artist-radiohead",name:"Radiohead",image_url:Kt}},{id:"bucket-6",user_id:Ot.id,entity_type:"venue",entity_id:"venue-redrocks",entity_name:"Red Rocks Amphitheatre",added_at:"2024-05-15T00:00:00Z",metadata:{},venue:{id:"venue-redrocks",name:"Red Rocks Amphitheatre",image_url:Kt}},{id:"bucket-7",user_id:Ot.id,entity_type:"artist",entity_id:"artist-arcticmonkeys",entity_name:"Arctic Monkeys",added_at:"2024-06-01T00:00:00Z",metadata:{},artist:{id:"artist-arcticmonkeys",name:"Arctic Monkeys",image_url:Kt}},{id:"bucket-8",user_id:Ot.id,entity_type:"venue",entity_id:"venue-hollywoodbowl",entity_name:"Hollywood Bowl",added_at:"2024-06-20T00:00:00Z",metadata:{},venue:{id:"venue-hollywoodbowl",name:"Hollywood Bowl",image_url:Kt}},{id:"bucket-9",user_id:Ot.id,entity_type:"artist",entity_id:"artist-billieeilish",entity_name:"Billie Eilish",added_at:"2024-07-10T00:00:00Z",metadata:{},artist:{id:"artist-billieeilish",name:"Billie Eilish",image_url:Kt}},{id:"bucket-10",user_id:Ot.id,entity_type:"venue",entity_id:"venue-fillmore",entity_name:"The Fillmore",added_at:"2024-08-01T00:00:00Z",metadata:{},venue:{id:"venue-fillmore",name:"The Fillmore",image_url:Kt}}];Fu[0],fa[0],Fu[0].created_at,fa[1],Fu[1],fa[1],Fu[1].created_at;const z8e={id:"artist-radiohead",name:"Radiohead",image_url:Kt,genres:["Alternative Rock","Electronic"]},zS=[{id:"tour-event-1",title:"Radiohead Live at Madison Square Garden",artist_name:"Radiohead",venue_name:"Madison Square Garden",venue_city:"New York",venue_state:"NY",event_date:"2025-03-20T20:00:00Z",latitude:40.7505,longitude:-73.9934,price_range:"$75 - $250",ticket_urls:["https://example.com/tickets"],images:[{url:Kt,width:400,height:300,ratio:"16_9"}],poster_image_url:Kt,description:"Radiohead tour stop in New York",genres:["Alternative Rock","Electronic"]},{id:"tour-event-2",title:"Radiohead at Red Rocks",artist_name:"Radiohead",venue_name:"Red Rocks Amphitheatre",venue_city:"Morrison",venue_state:"CO",event_date:"2025-03-25T20:00:00Z",latitude:39.6654,longitude:-105.2056,price_range:"$65 - $180",ticket_urls:["https://example.com/tickets"],images:[{url:Kt,width:400,height:300,ratio:"16_9"}],poster_image_url:Kt,description:"Radiohead tour stop at Red Rocks",genres:["Alternative Rock","Electronic"]},{id:"tour-event-3",title:"Radiohead at Hollywood Bowl",artist_name:"Radiohead",venue_name:"Hollywood Bowl",venue_city:"Los Angeles",venue_state:"CA",event_date:"2025-04-01T19:00:00Z",latitude:34.1122,longitude:-118.3394,price_range:"$85 - $300",ticket_urls:["https://example.com/tickets"],images:[{url:Kt,width:400,height:300,ratio:"16_9"}],poster_image_url:Kt,description:"Radiohead tour stop in Los Angeles",genres:["Alternative Rock","Electronic"]}],B8e=[{id:"scene-1",name:"NYC Indie Rock Scene",slug:"nyc-indie-rock-scene",description:"The vibrant indie rock scene in New York City",short_description:"Vibrant indie rock in NYC",energy_level:"vibrant",era_start_year:2010,era_end_year:null,cultural_significance:"A thriving scene of independent rock artists",image_url:Kt,scene_url:null,color_theme:"#CC2486",participating_artists:["Radiohead","Arctic Monkeys","The Strokes"],participating_venues:["Madison Square Garden","Barclays Center","Brooklyn Steel"],participating_cities:["New York","Brooklyn"],participating_genres:["Indie Rock","Alternative"],participants:[{id:"p1",participant_type:"artist",artist_id:"artist-radiohead",artist_name:"Radiohead"},{id:"p2",participant_type:"artist",artist_id:"artist-arcticmonkeys",artist_name:"Arctic Monkeys"},{id:"p3",participant_type:"venue",venue_id:"venue-msg",venue_name:"Madison Square Garden"},{id:"p4",participant_type:"venue",venue_id:"venue-barclays",venue_name:"Barclays Center"}],discovery_threshold:3,completion_threshold:8,is_active:!0,is_featured:!0,sort_order:1,metadata:{},created_at:"2024-01-01T00:00:00Z",updated_at:"2024-11-20T00:00:00Z",upcomingEventsCount:5,activeReviewersCount:12,userProgress:{id:"progress-1",user_id:Ot.id,scene_id:"scene-1",discovery_state:"completed",artists_experienced:3,venues_experienced:2,cities_experienced:2,genres_experienced:2,events_experienced:8,progress_percentage:100,discovered_at:"2024-06-01T00:00:00Z",started_at:"2024-06-01T00:00:00Z",completed_at:"2024-10-15T00:00:00Z",last_activity_at:"2024-10-15T00:00:00Z",metadata:{}}},{id:"scene-2",name:"LA Electronic Scene",slug:"la-electronic-scene",description:"The electronic music scene in Los Angeles",short_description:"Electronic beats in LA",energy_level:"intense",era_start_year:2015,era_end_year:null,cultural_significance:"A growing electronic music community",image_url:Kt,scene_url:null,color_theme:"#9D4EDD",participating_artists:["The Weeknd","Billie Eilish","Tame Impala"],participating_venues:["Hollywood Bowl","The Fillmore"],participating_cities:["Los Angeles"],participating_genres:["Electronic","Pop","R&B"],participants:[{id:"p5",participant_type:"artist",artist_id:"artist-theweeknd",artist_name:"The Weeknd"},{id:"p6",participant_type:"artist",artist_id:"artist-billieeilish",artist_name:"Billie Eilish"},{id:"p7",participant_type:"venue",venue_id:"venue-hollywoodbowl",venue_name:"Hollywood Bowl"}],discovery_threshold:2,completion_threshold:6,is_active:!0,is_featured:!0,sort_order:2,metadata:{},created_at:"2024-01-01T00:00:00Z",updated_at:"2024-11-20T00:00:00Z",upcomingEventsCount:3,activeReviewersCount:8,userProgress:{id:"progress-2",user_id:Ot.id,scene_id:"scene-2",discovery_state:"in_progress",artists_experienced:2,venues_experienced:1,cities_experienced:1,genres_experienced:2,events_experienced:4,progress_percentage:67,discovered_at:"2024-08-01T00:00:00Z",started_at:"2024-08-01T00:00:00Z",completed_at:null,last_activity_at:"2024-11-10T00:00:00Z",metadata:{}}}],U8e=({menuOpen:e=!1,onMenuClick:t,onNavigate:r})=>{var _;as();const[n,a]=x.useState("recommended"),[i,o]=x.useState(null),[l,c]=x.useState(!1),[d,u]=x.useState(!1),f=[{value:"recommended",label:"Hand Picked Events"},{value:"trending",label:"Trending"},{value:"friends",label:"Friends"},{value:"reviews",label:"Reviews"}],h=w=>{const b=fa.find(N=>N.id===w);b&&(o(b),u(!1),c(!0))},p=(w,b)=>E(void 0,null,function*(){console.log("Demo: Toggle interest",w,b),u(b)}),g=(w,b)=>E(void 0,null,function*(){console.log("Demo: Toggle attendance",w,b)}),v=fa.map(w=>({id:w.id,title:w.title,artist_name:w.artist_name,venue_name:w.venue_name,venue_city:w.venue_city,event_date:w.event_date,poster_image_url:w.poster_image_url,images:w.images,price_range:w.price_range,genres:w.genres,interested_count:Math.floor(Math.random()*50),user_is_interested:!1})),y=Fu.slice(0,10).map(w=>{const b=fa.find(N=>N.id===w.event_id);return{id:w.id,author:{id:Ot.id,name:Ot.name,avatar_url:void 0},created_at:w.created_at,rating:w.rating,content:w.review_text||void 0,photos:w.photos||void 0,event_info:{artist_name:b==null?void 0:b.artist_name,venue_name:b==null?void 0:b.venue_name,event_date:b==null?void 0:b.event_date}}});return s.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--neutral-50)"},children:[s.jsx(Yo,{menuOpen:e,onMenuClick:t,children:s.jsx("div",{className:"flex justify-center w-full",children:s.jsxs(O1,{children:[s.jsx(M1,{asChild:!0,children:s.jsxs(le,{variant:"outline",className:"flex items-center gap-2",style:{backgroundColor:"var(--neutral-50)",color:"var(--neutral-900)"},"data-tour":"feed-toggle",children:[s.jsx("span",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-900)"},children:((_=f.find(w=>w.value===n))==null?void 0:_.label)||"Hand Picked Events"}),s.jsx(Ta,{className:"h-4 w-4",style:{color:"var(--neutral-900)"}})]})}),s.jsx(tx,{className:"",style:{backgroundColor:"var(--neutral-50)"},children:f.map(w=>s.jsx(Hi,{onClick:()=>a(w.value),children:w.label},w.value))})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto",style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:"calc(env(safe-area-inset-top, 0px) + 68px + 12px)",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[n==="recommended"&&s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:v.map((w,b)=>{var P,A,R,$,O,z;let N,S=!1;const k=w.images&&Array.isArray(w.images)&&w.images.length>0;if(w.poster_image_url)if(N=w.poster_image_url,w.id==="event-3")k||(S=!0);else{const D=((P=w.poster_image_url)==null?void 0:P.includes("/storage/v1/object/public/"))||((A=w.poster_image_url)==null?void 0:A.includes("review-photos"))||((R=w.poster_image_url)==null?void 0:R.includes("supabase.co/storage")),B=w.event_media_url&&w.poster_image_url===w.event_media_url,F=(($=w.poster_image_url)==null?void 0:$.includes("/Generic Images/"))||((O=w.poster_image_url)==null?void 0:O.includes("placeholder"))||((z=w.poster_image_url)==null?void 0:z.includes("picsum.photos")),U=k&&w.images.some(G=>(G==null?void 0:G.url)===w.poster_image_url);!k&&D&&!F&&!B&&!U&&(S=!0)}else if(k){const D=w.images.find(B=>(B==null?void 0:B.url)&&((B==null?void 0:B.ratio)==="16_9"||(B==null?void 0:B.width)&&B.width>1e3))||w.images.find(B=>B==null?void 0:B.url);N=D==null?void 0:D.url}return s.jsx(Sc,{event:{id:w.id||"",title:w.title||w.artist_name||"Event",artist_name:w.artist_name,venue_name:w.venue_name,event_date:w.event_date,venue_city:w.venue_city||void 0,image_url:N,poster_image_url:w.poster_image_url||void 0},interestedCount:(w.interested_count||0)+(w.user_is_interested?1:0),isInterested:w.user_is_interested||!1,isCommunityPhoto:S,onClick:()=>h(w.id)},`${w.id}-${b}`)})})}),n==="trending"&&s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:fa.slice(0,12).map(w=>{const b=w.images&&Array.isArray(w.images)&&w.images.length>0,N=w.id==="event-3"&&!b;return s.jsx(Sc,{event:{id:w.id,title:w.title,artist_name:w.artist_name,venue_name:w.venue_name,event_date:w.event_date,venue_city:w.venue_city,image_url:w.poster_image_url,poster_image_url:w.poster_image_url},isCommunityPhoto:N,onClick:()=>h(w.id)},w.id)})})}),n==="friends"&&s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:fa.slice(0,12).map(w=>{const b=w.images&&Array.isArray(w.images)&&w.images.length>0,N=w.id==="event-3"&&!b;return s.jsx(Sc,{event:{id:w.id,title:w.title,artist_name:w.artist_name,venue_name:w.venue_name,event_date:w.event_date,venue_city:w.venue_city,image_url:w.poster_image_url,poster_image_url:w.poster_image_url},isCommunityPhoto:N,onClick:()=>h(w.id)},w.id)})})}),n==="reviews"&&s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"space-y-3",children:y.map(w=>s.jsx(ZY,{review:w,onClick:()=>console.log("Demo: Review clicked",w.id)},w.id))})})]}),i&&s.jsx(Bl,{event:i,currentUserId:Ot.id,isOpen:l,onClose:()=>c(!1),onInterestToggle:p,onAttendanceChange:g,isInterested:d,hasReviewed:!1})]})},q8e=e=>ya.divIcon({className:"custom-numbered-marker",html:`
      <div style="
        width: 32px;
        height: 32px;
        background: #ec4899;
        border: 3px solid white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 14px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      ">
        ${e}
      </div>
    `,iconSize:[32,32],iconAnchor:[16,16]}),V8e=({events:e})=>{const t=kh();return x.useEffect(()=>{if(e.length===0)return;const r=ya.latLngBounds(e.map(n=>[n.latitude,n.longitude]));t.fitBounds(r,{padding:[50,50],maxZoom:10})},[t,e]),null},W8e=({currentUserId:e,filters:t,onNavigateToProfile:r,onNavigateToChat:n})=>{const a=as(),[i,o]=x.useState("calendar"),[l,c]=x.useState(z8e),[d,u]=x.useState(zS),[f,h]=x.useState(()=>{const F=[...zS].sort((G,q)=>{const K=new Date(G.event_date).getTime(),Z=new Date(q.event_date).getTime();return K-Z}),U=[];for(let G=0;G<F.length-1;G++){const q=F[G],K=F[G+1];q.latitude&&q.longitude&&K.latitude&&K.longitude&&U.push({from:{lat:q.latitude,lng:q.longitude,city:q.venue_city},to:{lat:K.latitude,lng:K.longitude,city:K.venue_city}})}return U});x.useState([]);const[p,g]=x.useState(!1),[v,y]=x.useState(null),[_,w]=x.useState(!1),[b,N]=x.useState(new Date),[S,k]=x.useState(void 0),[P,A]=x.useState([]),R=F=>{k(F),A([])},$=F=>{y(F),w(!0)},O=d.reduce((F,U,G)=>{const q=`${U.latitude},${U.longitude}`;return F[q]||(F[q]={venueKey:q,latitude:U.latitude,longitude:U.longitude,venueName:U.venue_name,city:U.venue_city,number:Object.keys(F).length+1,events:[]}),F[q].events.push(U),F},{}),z=f.map(F=>({from:F.from,to:F.to})),D=[...d].sort((F,U)=>{const G=new Date(F.event_date).getTime(),q=new Date(U.event_date).getTime();return G-q}),B=()=>{if(d.length===0)return[40.7128,-74.006];const F=d.reduce((G,q)=>G+q.latitude,0)/d.length,U=d.reduce((G,q)=>G+q.longitude,0)/d.length;return[F,U]};return s.jsxs("div",{className:"mb-2 space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:"Discover Events"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Discover events by date, leaderboards, or artist tour"})]})}),s.jsxs(Li,{value:i,onValueChange:F=>o(F),children:[s.jsxs(yi,{className:"grid w-full grid-cols-3",children:[s.jsxs(Xr,{value:"calendar",className:"flex items-center gap-2",children:[s.jsx(It,{className:"w-4 h-4"}),"Calendar"]}),s.jsxs(Xr,{value:"leaderboards",className:"flex items-center gap-2",children:[s.jsx(Bd,{className:"w-4 h-4"}),"Leaderboards"]}),s.jsxs(Xr,{value:"tour",className:"flex items-center gap-2",children:[s.jsx(zk,{className:"w-4 h-4"}),"Tour Tracker"]})]}),s.jsx(Jr,{value:"calendar",className:"mt-4",children:s.jsxs("div",{className:"space-y-4 flex flex-col items-center justify-center",children:[s.jsx("div",{className:"flex justify-center w-full",children:s.jsx(ax,{mode:"single",selected:S,onSelect:R,month:b,onMonthChange:N,className:"rounded-md border",numberOfMonths:1,disabled:F=>{const U=new Date;U.setHours(0,0,0,0);const G=new Date(F);return G.setHours(0,0,0,0),G<U}})}),S&&P.length===0&&s.jsxs("div",{className:"mt-4 text-center text-muted-foreground",children:[s.jsx("p",{children:"No events found for the selected date."}),s.jsx("p",{className:"text-xs mt-1",children:"Demo mode: Calendar is visible but no events are loaded."})]})]})}),s.jsx(Jr,{value:"leaderboards",className:"mt-4",children:s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(Bd,{className:"w-12 h-12 mx-auto text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Leaderboards are still in development"})]})})}),s.jsx(Jr,{value:"tour",className:"mt-4",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search for an Artist"}),s.jsx(h1,{onArtistSelect:F=>{c(F),u(zS)},placeholder:"Search for an artist to track their tour..."})]}),l&&s.jsx(He,{className:"overflow-hidden border-2 border-synth-pink/20 shadow-lg cursor-pointer hover:shadow-xl transition-shadow",onClick:()=>{const F=l.id||encodeURIComponent(l.name);a(`/artist/${F}`)},children:s.jsx("div",{className:"relative p-6",style:{background:"linear-gradient(135deg, rgba(255, 51, 153, 0.1) 0%, rgba(255, 51, 153, 0.05) 100%)"},children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:l.image_url?s.jsx("img",{src:l.image_url,alt:l.name,className:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-lg"}):s.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-synth-pink to-purple-500 flex items-center justify-center border-4 border-white shadow-lg",children:s.jsx($t,{className:"w-12 h-12 text-white"})})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2 truncate",children:l.name}),s.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[d.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(It,{className:"w-4 h-4 text-synth-pink"}),s.jsxs("span",{className:"text-sm font-medium text-foreground",children:[d.length," ",d.length===1?"Tour Date":"Tour Dates"]})]}),l.genres&&l.genres.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx($t,{className:"w-4 h-4 text-synth-pink"}),s.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[l.genres.slice(0,3).map((F,U)=>s.jsx(Ke,{variant:"secondary",className:"text-xs bg-white/80 text-foreground border-synth-pink/20",children:F},U)),l.genres.length>3&&s.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",l.genres.length-3," more"]})]})]})]})]}),s.jsx(le,{variant:"ghost",size:"sm",onClick:F=>{F.stopPropagation(),c(null),u([]),h([])},className:"flex-shrink-0 text-muted-foreground hover:text-foreground",children:s.jsx(Gr,{className:"w-4 h-4"})})]})})]})})}),p?s.jsx(Rd,{text:"Loading tour data...",size:"lg"}):l&&d.length>0?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"h-96 rounded-lg overflow-hidden border relative z-0",children:s.jsxs(Xy,{center:B(),zoom:5,style:{height:"100%",width:"100%",zIndex:0},boundsOptions:{padding:[50,50]},children:[s.jsx(Jy,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(V8e,{events:D}),z.map((F,U)=>{const G=F.from.lat,q=F.from.lng,K=F.to.lat,Z=F.to.lng,Y=K-G,Q=Z-q,X=G+Y*.85,ne=q+Q*.85,ee=`
                        <svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
                          <g transform="translate(10,10) rotate(${Math.atan2(Y,Q)*180/Math.PI}) translate(-10,-10)">
                            <polygon points="10,2 4,16 16,16" fill="#ec4899" stroke="white" stroke-width="1.5"/>
                          </g>
                        </svg>
                      `;return s.jsxs(J.Fragment,{children:[s.jsx(zB,{positions:[[G,q],[K,Z]],pathOptions:{color:"#ec4899",weight:3,opacity:.7}}),s.jsx(ch,{position:[X,ne],icon:ya.divIcon({className:"arrowhead-marker",html:ee,iconSize:[20,20],iconAnchor:[10,10]})})]},U)}),Object.values(O).map(F=>s.jsx(ch,{position:[F.latitude,F.longitude],icon:q8e(F.number),eventHandlers:{click:()=>{F.events.length>0&&$(F.events[0])}}},`${F.venueKey}-${F.number}`))]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Tour Dates"}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:D.map(F=>s.jsx(He,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>$(F),children:s.jsx(et,{className:"p-4",children:s.jsx("div",{className:"flex items-start justify-between gap-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold mb-1",children:F.title}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-2",children:[s.jsx(gr,{className:"w-4 h-4"}),s.jsxs("span",{children:[F.venue_name,", ",F.venue_city]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:Mt(new Date(F.event_date),"EEEE, MMMM d, yyyy  h:mm a")})]})})})},F.id))})]})]}):s.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[s.jsx(zk,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Select an artist to see their tour dates on the map"})]})]})})]}),s.jsx(pn,{open:_,onOpenChange:w,children:s.jsx(dn,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:v&&s.jsx(vR,{event:v,currentUserId:e,onClose:()=>w(!1)})})})]})},H8e=({menuOpen:e=!1,onMenuClick:t,onNavigate:r})=>{as();const[n,a]=x.useState(""),[i,o]=x.useState(!1),[l,c]=x.useState(!1),[d,u]=x.useState(null),f=g=>{u(g),console.log("Demo: Vibe selected",g)},h=O8e,p={radiusMiles:30,latitude:40.7128,longitude:-74.006};return s.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--neutral-50)"},children:[s.jsx(Yo,{menuOpen:e,onMenuClick:t,children:s.jsx("div",{style:{display:"flex",alignItems:"center",gap:"6px",width:"100%",maxWidth:"100%"},children:s.jsx(Xi,{value:n,onChange:g=>{a(g),o(g.trim().length>=2)},placeholder:'Try "Radiohead"',widthVariant:"flex"})})}),s.jsxs("div",{className:"max-w-7xl mx-auto space-y-2",style:{paddingLeft:"var(--spacing-screen-margin-x, 20px)",paddingRight:"var(--spacing-screen-margin-x, 20px)",paddingTop:"calc(env(safe-area-inset-top, 0px) + 68px + 12px)",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[s.jsxs("div",{className:"mb-2 flex items-center gap-2 flex-wrap overflow-x-auto pt-4",children:[s.jsxs(le,{className:"bg-synth-pink hover:bg-synth-pink/90 gap-2 flex-shrink-0",style:{color:"var(--color-off-white, #FCFCFC)"},size:"sm",onClick:()=>c(!0),"data-tour":"discover-vibes",children:[s.jsx(Ol,{className:"h-4 w-4"}),"Browse Vibes"]}),s.jsxs(le,{variant:"outline",size:"sm",className:"gap-2 flex-shrink-0",children:[s.jsx(gr,{className:"h-4 w-4"}),"Location"]})]}),i&&s.jsxs("div",{className:"space-y-4 pt-4",children:[h.users.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-[#0e0e0e] mb-3",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)"},children:"Users"}),s.jsx("div",{className:"space-y-2",children:h.users.map(g=>s.jsx(He,{className:"cursor-pointer hover:bg-gray-50",children:s.jsxs(et,{className:"p-3 flex items-center gap-3",children:[s.jsx(Vr,{className:"w-10 h-10",children:s.jsx(Wr,{className:"bg-synth-beige/50",children:g.name.split(" ").map(v=>v[0]).join("")})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-[#0e0e0e]",children:g.name}),g.username&&s.jsxs("p",{className:"text-[#5d646f]",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:["@",g.username]})]})]})},g.id))})]}),h.artists.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-[#0e0e0e] mb-3",children:"Artists"}),s.jsx("div",{className:"space-y-2",children:h.artists.map(g=>s.jsx(He,{className:"cursor-pointer hover:bg-gray-50",children:s.jsxs(et,{className:"p-3 flex items-center gap-3",children:[s.jsxs(Vr,{className:"w-10 h-10",children:[s.jsx(sn,{src:g.image_url||void 0}),s.jsx(Wr,{className:"bg-synth-beige/50",children:g.name.substring(0,2).toUpperCase()})]}),s.jsx("div",{children:s.jsx("p",{className:"font-semibold text-[#0e0e0e]",children:g.name})})]})},g.id))})]}),h.events.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-[#0e0e0e] mb-3",children:"Events"}),s.jsx("div",{className:"grid grid-cols-2 gap-3",children:h.events.map(g=>s.jsx(Sc,{event:g,interestedCount:Math.floor(Math.random()*50),isInterested:!1,onClick:()=>console.log("Demo: Event clicked",g.id)},g.id))})]}),h.venues.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-[#0e0e0e] mb-3",children:"Venues"}),s.jsx("div",{className:"space-y-2",children:h.venues.map(g=>s.jsx(He,{className:"cursor-pointer hover:bg-gray-50",children:s.jsxs(et,{className:"p-3 flex items-center gap-3",children:[s.jsxs(Vr,{className:"w-10 h-10",children:[s.jsx(sn,{src:g.image_url||void 0}),s.jsx(Wr,{className:"bg-synth-beige/50",children:g.name.substring(0,2).toUpperCase()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-[#0e0e0e]",children:g.name}),s.jsxs("p",{className:"text-[#5d646f]",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:[g.city,", ",g.state]})]})]})},g.id))})]})]}),!i&&s.jsxs(s.Fragment,{children:[s.jsx(W8e,{currentUserId:Ot.id,filters:p,onNavigateToProfile:g=>console.log("Demo: Navigate to profile",g),onNavigateToChat:g=>console.log("Demo: Navigate to chat",g)}),s.jsx("div",{className:"mt-8",children:s.jsx(Tj,{title:"Scenes & Signals",description:"Music scenes defined by genre overlap, venue clusters, and co-attendance patterns",items:B8e.map(g=>s.jsx(GY,{scene:g,onClick:()=>console.log("Demo: Scene clicked",g.id)},g.id)),loading:!1,emptyMessage:"No scenes found",itemClassName:"w-[320px]"})})]})]}),s.jsx(HY,{isOpen:l,onClose:()=>c(!1),onSelectVibe:f,isMobile:!0})]})},G8e=({posts:e,onPostClick:t})=>{const r=n=>Array.from({length:5},(a,i)=>{const o=i+1,l=n>=o,c=!l&&n>=o-.5;return s.jsxs("div",{className:"relative w-3 h-3",children:[s.jsx(Qt,{className:`w-3 h-3 ${l?"text-yellow-400 fill-current":"text-gray-300"}`}),c&&s.jsx("div",{className:"absolute inset-0 overflow-hidden",style:{width:"50%"},children:s.jsx(Qt,{className:"w-3 h-3 text-yellow-400 fill-current"})})]},i)});return e.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx($t,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-muted-foreground mb-2",children:"No Posts Yet"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Start attending events and writing reviews to build your profile!"})]}):s.jsx("div",{className:"grid grid-cols-3 gap-1 md:gap-2",children:e.map(n=>{const a=!!n.image,i=n.image||GT(`${n.id}-${n.title}-${n.date}`);return s.jsx(He,{className:"aspect-square cursor-pointer hover:shadow-md transition-shadow overflow-hidden",onClick:()=>t(n),children:s.jsxs(et,{className:"p-0 h-full relative",children:[s.jsxs("div",{className:"relative w-full h-2/3 overflow-hidden",children:[s.jsx("img",{src:i,alt:n.title,className:`w-full h-full object-cover transition-transform duration-500 ${a?"":"scale-105"}`,loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/10 to-transparent","aria-hidden":"true"}),s.jsx("div",{className:"absolute top-2 right-2",children:n.badge&&s.jsx(Ke,{variant:"secondary",className:"text-xs",children:n.badge})})]}),s.jsxs("div",{className:"p-2 h-1/3 flex flex-col justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-xs truncate",children:n.title}),s.jsx("p",{className:"text-xs text-muted-foreground truncate",children:n.subtitle})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(It,{className:"w-3 h-3"}),s.jsx("span",{children:Mt(new Date(n.date),"MMM d, yyyy")})]}),n.type==="review"&&typeof n.rating=="number"&&s.jsx("div",{className:"flex items-center gap-0.5",children:r(n.rating)}),(n.likes||n.comments)&&s.jsxs("div",{className:"flex items-center gap-2",children:[n.likes&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ns,{className:"w-3 h-3"}),s.jsx("span",{children:n.likes})]}),n.comments&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx($n,{className:"w-3 h-3"}),s.jsx("span",{children:n.comments})]})]})]})]})]})},n.id)})})},Y8e=({isOpen:e,onClose:t,userId:r,userName:n,inline:a=!1,identity:i,stamps:o=[],achievements:l=[],timeline:c=[],bucketList:d=[]})=>{const[u,f]=x.useState("identity");if(!e&&!a)return null;const h=s.jsxs(s.Fragment,{children:[a&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold gradient-text",children:"Live Music Passport"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your curated, earned, and evolving snapshot of your live-music journey"})]}),s.jsxs(Li,{value:u,onValueChange:p=>f(p),className:`${a?"":"mt-4"} w-full max-w-full overflow-x-hidden`,children:[s.jsxs(yi,{className:"grid w-full max-w-full grid-cols-5 gap-0.5 p-0.5 overflow-x-hidden",children:[s.jsxs(Xr,{value:"identity",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(Rs,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Identity"})]}),s.jsxs(Xr,{value:"stamps",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(Ol,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Stamps"})]}),s.jsxs(Xr,{value:"achievements",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(Ac,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Achievements"})]}),s.jsxs(Xr,{value:"timeline",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(ga,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Timeline"})]}),s.jsxs(Xr,{value:"bucket",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(kQ,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Bucket List"})]})]}),s.jsx(Jr,{value:"identity",className:"mt-4",children:i?s.jsx(He,{className:"border-2 border-synth-pink/20 bg-gradient-to-br from-white to-pink-50/30",children:s.jsxs(et,{className:"p-6 space-y-4",children:[s.jsx(Ke,{variant:"secondary",className:"text-base px-4 py-2 bg-synth-pink/10 text-synth-pink border-synth-pink/30",children:i.fan_type==="jam_chaser"?"Jam Chaser":i.fan_type==="venue_purist"?"Venue Purist":i.fan_type==="scene_builder"?"Scene Builder":i.fan_type==="road_tripper"?"Road Tripper":i.fan_type==="genre_explorer"?"Genre Explorer":i.fan_type==="festival_fanatic"?"Festival Fanatic":"Music Lover"}),s.jsxs("div",{className:"text-sm space-y-2",children:[s.jsxs("p",{className:"font-medium",children:["Live since ",i.join_year]}),i.home_city&&s.jsxs("p",{className:"text-muted-foreground",children:["Home: ",i.home_city]})]})]})}):s.jsx(iV,{userId:r,userName:n})}),s.jsx(Jr,{value:"stamps",className:"mt-4",children:s.jsx(oV,{stamps:o,achievements:l,loading:!1})}),s.jsx(Jr,{value:"achievements",className:"mt-4 w-full max-w-full overflow-x-hidden",children:l.length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx("p",{children:"No achievements unlocked yet."}),s.jsx("p",{className:"text-xs mt-1",children:"Keep attending events and writing reviews to unlock achievements!"})]}):s.jsx("div",{className:"space-y-4",children:l.map(p=>s.jsx(He,{children:s.jsx(et,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"text-3xl",children:p.icon}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"font-semibold",children:p.name}),p.tier&&s.jsx(Ke,{variant:p.tier==="gold"?"default":"secondary",children:p.tier})]}),s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:p.description}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{children:"Progress"}),s.jsxs("span",{children:[p.progress," / ",p.goal]})]}),s.jsx(xm,{value:p.progress/p.goal*100,className:"h-2"})]})]})]})})},p.id||p.type))})}),s.jsx(Jr,{value:"timeline",className:"mt-4",children:s.jsx(lV,{userId:r})}),s.jsx(Jr,{value:"bucket",className:"mt-4",children:s.jsx(cV,{userId:r})})]})]});return a?h:s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsx("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:h})})},K8e=({menuOpen:e=!1,onMenuClick:t,onNavigate:r})=>{as();const[n,a]=x.useState("my-events"),[i,o]=x.useState(!1),l=Fu.map(d=>{const u=fa.find(h=>h.id===d.event_id),f=d.photos&&d.photos.length>0?d.photos[0]:void 0;return{id:d.id,type:"review",image:f,images:d.photos,title:(u==null?void 0:u.title)||"Event Review",subtitle:u?`${u.artist_name} at ${u.venue_name}`:"Concert Review",rating:d.rating,date:d.created_at,location:(u==null?void 0:u.venue_city)||void 0,likes:d.likes_count,comments:d.comments_count}}),c=i?N$.filter(d=>new Date(d.event_date)<new Date):M8e;return s.jsxs("div",{className:"min-h-screen w-full max-w-[393px] mx-auto overflow-x-hidden",style:{backgroundColor:"var(--neutral-50)"},children:[s.jsx(Yo,{menuOpen:e,onMenuClick:t,children:s.jsx("h1",{className:"font-bold truncate text-center",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--color-off-black, #0E0E0E)"},children:`@${Ot.username}`})}),s.jsxs("div",{className:"px-5",style:{paddingTop:"calc(env(safe-area-inset-top, 0px) + 68px + 12px)",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:[s.jsx("div",{className:"mb-6 bg-gradient-to-br from-white via-pink-50/30 to-purple-50/20 p-4 sm:p-6 border border-pink-100/50 shadow-sm relative overflow-hidden w-full max-w-full",style:{borderRadius:"10px"},children:s.jsxs("div",{className:"flex flex-col items-center gap-4 mb-4 w-full max-w-full",children:[s.jsxs("div",{className:"flex items-center gap-3 w-full justify-center",children:[s.jsx("div",{className:"relative",children:s.jsxs(Vr,{className:"w-20 h-20 sm:w-24 sm:h-24 ring-4 ring-white shadow-lg",children:[s.jsx(sn,{src:void 0}),s.jsx(Wr,{className:"text-3xl font-bold bg-gradient-to-br from-pink-500 to-purple-600",style:{color:"var(--color-off-white, #FCFCFC)"},children:Ot.name.charAt(0).toUpperCase()})]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h1",{className:"font-bold",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)",color:"var(--color-off-black, #0E0E0E)"},children:Ot.name}),Ot.verified]})]}),s.jsxs("div",{className:"w-full max-w-full",children:[s.jsxs("div",{className:"flex items-center justify-center gap-6 mb-4 w-full max-w-full",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)"},children:Ot.followers_count}),s.jsx("p",{className:"font-medium",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--color-dark-grey, #5D646F)"},children:"Friends"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)"},children:Ot.reviews_count}),s.jsx("p",{className:"text-gray-600 font-medium",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:"Reviews"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-h2-size, 24px)",fontWeight:"var(--typography-h2-weight, 700)",lineHeight:"var(--typography-h2-line-height, 1.3)"},children:Ot.following_count}),s.jsx("p",{className:"text-gray-600 font-medium",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:"Following"})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full max-w-full justify-center",children:[s.jsxs(le,{variant:"default",size:"sm",className:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 shadow-md",style:{color:"var(--color-off-white, #FCFCFC)"},children:[s.jsx(_c,{className:"w-4 h-4 mr-2"}),"Edit Profile"]}),s.jsx(le,{variant:"outline",size:"sm",style:{borderColor:"var(--color-light-grey, #C9C9C9)"},children:s.jsx(jP,{className:"w-4 h-4"})})]})]})]})}),s.jsxs(Li,{value:n,onValueChange:a,className:"w-full",children:[s.jsxs(yi,{className:"grid w-full grid-cols-3",children:[s.jsx(Xr,{value:"my-events",children:"My Events"}),s.jsx(Xr,{value:"interested",children:"Interested"}),s.jsx(Xr,{value:"passport",children:"Passport"})]}),s.jsx(Jr,{value:"my-events",className:"mt-4 w-full max-w-full overflow-x-hidden",children:s.jsx(G8e,{posts:l,onPostClick:d=>console.log("Demo: Post clicked",d.id)})}),s.jsxs(Jr,{value:"interested",className:"mt-4 w-full max-w-full overflow-x-hidden",children:[N$.length>0&&s.jsx("div",{className:"flex justify-center mb-4 w-full max-w-full",children:s.jsxs("div",{className:"bg-gray-100 p-1 flex w-full max-w-full",style:{borderRadius:"10px"},children:[s.jsx("button",{onClick:()=>o(!1),className:`px-4 py-2 font-medium transition-colors ${i?"":"shadow-sm"}`,children:"Upcoming"}),s.jsx("button",{onClick:()=>o(!0),className:`px-4 py-2 font-medium transition-colors ${i?"shadow-sm":""}`,style:{borderRadius:"10px"},children:"Past"})]})}),c.length===0?s.jsxs("div",{className:"flex flex-col gap-[6px] items-center justify-center py-12",style:{borderRadius:"10px",backgroundColor:"var(--color-off-white, #FCFCFC)"},children:[s.jsx(ns,{className:"w-[60px] h-[60px] mx-auto",style:{color:"var(--color-dark-grey, #5D646F)"}}),s.jsxs("h3",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",color:"var(--neutral-900)",margin:0,textAlign:"center"},children:["No ",i?"Past":"Upcoming"," Events Yet"]}),s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)",color:"var(--neutral-600)",margin:0,textAlign:"center"},children:"Tap the heart on events to add them here."})]}):s.jsx("div",{className:"grid grid-cols-2 gap-3",children:c.map(d=>s.jsx(Sc,{event:d,interestedCount:Math.floor(Math.random()*50),isInterested:!0,onClick:()=>console.log("Demo: Event clicked",d.id)},d.id))})]}),s.jsx(Jr,{value:"passport",className:"mt-4 mb-32 w-full max-w-full overflow-x-hidden",children:s.jsx(Y8e,{isOpen:!0,onClose:()=>a("my-events"),userId:Ot.id,userName:Ot.name,inline:!0,identity:D8e,stamps:I8e,achievements:$8e,timeline:L8e,bucketList:F8e})})]})]})]})},Z8e=({menuOpen:e=!1,onMenuClick:t,onNavigate:r})=>{const n=as(),[a,i]=x.useState(null),[o,l]=x.useState(""),c=a?j$.find(g=>g.id===a):null,d=a?R8e[a]||[]:[],u=()=>{a?i(null):r?r("home"):n("/mobile-preview/component-view")},f=g=>qce(g)?s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{fontWeight:700},children:"Today"})," ",s.jsxs("span",{style:{fontWeight:500},children:["at ",Mt(g,"h:mm a")]})]}):Wce(g)?s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{fontWeight:700},children:"Yesterday"})," ",s.jsxs("span",{style:{fontWeight:500},children:["at ",Mt(g,"h:mm a")]})]}):Uce(g,{weekStartsOn:0})?s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{fontWeight:700},children:Mt(g,"EEEE")})," ",s.jsxs("span",{style:{fontWeight:500},children:["at ",Mt(g,"h:mm a")]})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{style:{fontWeight:700},children:Mt(g,"MMM d")})," ",s.jsxs("span",{style:{fontWeight:500},children:["at ",Mt(g,"h:mm a")]})]});if(!c)return s.jsx("div",{className:"flex min-h-screen w-full max-w-[393px] mx-auto",style:{backgroundColor:"var(--color-off-white, #FCFCFC)"},children:s.jsxs("div",{className:"w-full border-synth-black/10 backdrop-blur-md flex flex-col shadow-2xl",style:{backgroundColor:"rgba(252, 252, 252, 0.98)"},children:[s.jsx(Yo,{menuOpen:e,onMenuClick:t,children:s.jsx("h1",{className:"font-bold text-[24px] text-[#0e0e0e] leading-[normal]",children:"Messages"})}),s.jsx("div",{className:"flex-1 overflow-y-auto px-5",style:{paddingTop:"calc(env(safe-area-inset-top, 0px) + 68px + 12px)",paddingBottom:"var(--spacing-bottom-nav, 112px)"},children:s.jsx("div",{className:"space-y-2",children:j$.map(g=>s.jsxs("div",{onClick:()=>i(g.id),className:"flex items-center gap-3 p-3 hover:bg-gray-50 cursor-pointer",style:{borderRadius:"10px"},children:[s.jsxs(Vr,{className:"w-12 h-12",children:[s.jsx(sn,{src:g.event_image_url||void 0}),s.jsx(Wr,{className:"bg-synth-beige/50",children:g.is_group_chat?s.jsx(zr,{className:"w-6 h-6 text-synth-black"}):g.chat_name.split(" ").map(v=>v[0]).join("").substring(0,2)})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h3",{className:"font-semibold text-[#0e0e0e] truncate",children:g.chat_name}),g.latest_message_created_at&&s.jsx("span",{className:"text-[#5d646f] flex-shrink-0 ml-2",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:Mt(ms(g.latest_message_created_at),"h:mm a")})]}),s.jsx("p",{className:"text-[#5d646f] truncate",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:g.latest_message})]}),g.has_unread&&s.jsx("div",{className:"w-2 h-2 bg-synth-pink rounded-full flex-shrink-0"})]},g.id))})})]})});const h=[];let p=[];return d.forEach((g,v)=>{const y=ms(g.created_at),_=v>0?d[v-1]:null,w=_?ms(_.created_at):null,b=_&&_.sender_id!==g.sender_id,N=w&&g2(y,w)>=30;b||N?(p.length>0&&h.push(p),p=[g]):p.push(g)}),p.length>0&&h.push(p),s.jsx("div",{className:"flex min-h-screen w-full max-w-[393px] mx-auto",style:{backgroundColor:"var(--color-off-white, #FCFCFC)"},children:s.jsxs("div",{className:"w-full flex flex-col min-h-0",style:{backgroundColor:"var(--color-off-white, #FCFCFC)"},children:[s.jsx(Yo,{menuOpen:e,onMenuClick:t,children:s.jsxs("div",{className:"flex items-center gap-[6px]",children:[s.jsx("button",{onClick:u,className:"w-6 h-6 flex items-center justify-center cursor-pointer",children:s.jsx(Cs,{className:"w-6 h-6 text-[#0e0e0e]"})}),s.jsxs(Vr,{className:"w-8 h-8 flex-shrink-0",children:[s.jsx(sn,{src:c.event_image_url||void 0}),s.jsx(Wr,{className:"bg-synth-beige/50 text-synth-black font-medium",style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)"},children:c.is_group_chat?s.jsx(zr,{className:"w-5 h-5"}):c.chat_name.split(" ").map(g=>g[0]).join("")})]}),s.jsx("h2",{className:"font-bold text-[24px] text-[#0e0e0e] leading-[normal]",children:c.chat_name})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto px-5",style:{paddingTop:"calc(env(safe-area-inset-top, 0px) + 68px + 12px)",paddingBottom:"var(--spacing-bottom-nav, 112px)",backgroundColor:"var(--color-off-white, #FCFCFC)"},children:s.jsx("div",{className:"flex flex-col",style:{maxWidth:"353px",margin:"0 auto"},children:h.map((g,v)=>{const y=g[0];g[g.length-1];const _=y.sender_id===Ot.id,w=ms(y.created_at),b=v===0||v>0&&g2(w,ms(h[v-1][h[v-1].length-1].created_at))>=30,N=c.is_group_chat&&y.sender_id!==Ot.id&&(v===0||h[v-1][0].sender_id!==y.sender_id);return s.jsxs("div",{className:`flex flex-col ${_?"items-end":"items-start"} ${v>0?"mt-[24px]":""}`,children:[b&&s.jsx("div",{className:"flex justify-center w-full mb-[24px]",children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-meta-size, 16px)",fontWeight:"var(--typography-meta-weight, 500)",color:"#5D646F",lineHeight:"var(--typography-meta-line-height, 1.5)"},children:f(w)})}),N&&s.jsx("div",{className:"flex items-center gap-[6px]",style:{marginBottom:"6px"},children:s.jsx(oc,{name:y.sender_name,initial:y.sender_name.split(" ").map(S=>S[0]).join(""),imageUrl:y.sender_avatar||void 0,variant:"chat"})}),g.map((S,k)=>{const P=k===g.length-1;return s.jsxs("div",{className:`flex flex-col ${k>0?"mt-[6px]":""}`,children:[s.jsx("div",{className:"max-w-[172px] p-[12px]",style:{borderRadius:"10px",backgroundColor:S.sender_id===Ot.id?"var(--brand-pink-500)":"var(--state-disabled-bg)",border:S.sender_id===Ot.id?"none":"1px solid var(--neutral-200)"},children:s.jsx("p",{style:{fontFamily:"var(--font-family)",fontSize:"var(--typography-body-size, 20px)",fontWeight:"var(--typography-body-weight, 500)",lineHeight:"var(--typography-body-line-height, 1.5)",margin:0,color:S.sender_id===Ot.id?"var(--neutral-50)":"var(--neutral-900)"},children:S.content})}),P&&s.jsx("p",{className:`text-[16px] text-[var(--neutral-600)] font-normal leading-[normal] mt-[6px] ${_?"text-right":"text-left"}`,children:Mt(ms(S.created_at),"h:mm a")})]},S.id)})]},`group-${v}`)})})}),!c.is_group_chat&&s.jsx("div",{className:"border-t px-5 py-3",style:{borderColor:"var(--neutral-200)",backgroundColor:"var(--neutral-50)"},children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ar,{value:o,onChange:g=>l(g.target.value),placeholder:"Type a message...",className:"flex-1",onKeyPress:g=>{g.key==="Enter"&&o.trim()&&(console.log("Demo: Send message",o),l(""))}}),s.jsx("button",{onClick:()=>{o.trim()&&(console.log("Demo: Send message",o),l(""))},className:"w-10 h-10 flex items-center justify-center bg-synth-pink",style:{borderRadius:"10px",color:"var(--neutral-50)"},children:s.jsx(Fc,{className:"w-5 h-5"})})]})})]})})},X8e=({menuOpen:e=!1,onMenuClick:t,onNavigate:r})=>{const n=as(),[a,i]=x.useState(!0),o=fa[0],l=()=>{r?r("home"):n("/mobile-preview/component-view")},c=()=>{i(!1),l()},d=()=>{console.log("Demo: Review submitted (no-op in demo mode)"),c()};return s.jsxs("div",{className:"min-h-screen bg-[#fcfcfc]",children:[s.jsx(Yo,{menuOpen:e,onMenuClick:t,children:s.jsx("h1",{className:"font-bold text-[24px] text-[#0e0e0e] leading-[normal]",children:"Create Review"})}),s.jsx(nV,{event:o,userId:Ot.id,isOpen:a,onClose:c,onReviewSubmitted:d})]})},J8e=()=>{const[e,t]=J.useState(!1);w9(e);const r=()=>{t(!e)},n=()=>{t(!1)};return s.jsxs("div",{className:"mobile-preview",children:[s.jsx(Yo,{menuOpen:e,onMenuClick:r}),s.jsx("main",{className:"mobile-preview__content",children:s.jsxs(qz,{children:[s.jsx(Bs,{index:!0,element:s.jsx(Zne,{to:"component-view",replace:!0})}),s.jsx(Bs,{path:"component-view",element:s.jsx(XY,{})}),s.jsx(Bs,{path:"demo/home",element:s.jsx(U8e,{menuOpen:e,onMenuClick:r})}),s.jsx(Bs,{path:"demo/discover",element:s.jsx(H8e,{menuOpen:e,onMenuClick:r})}),s.jsx(Bs,{path:"demo/profile",element:s.jsx(K8e,{menuOpen:e,onMenuClick:r})}),s.jsx(Bs,{path:"demo/messages",element:s.jsx(Z8e,{menuOpen:e,onMenuClick:r})}),s.jsx(Bs,{path:"demo/create-post",element:s.jsx(X8e,{menuOpen:e,onMenuClick:r})})]})}),s.jsx(P8e,{}),s.jsx(_9,{isOpen:e,onClose:n,onToggle:r})]})},Q8e=new one,eBe=()=>(console.log(" App component is rendering..."),s.jsx("div",{className:"synth-app",children:s.jsx(cne,{client:Q8e,children:s.jsxs(IP,{children:[s.jsx(wee,{}),s.jsx(Qee,{}),s.jsx(ese,{children:s.jsxs(qz,{children:[s.jsx(Bs,{path:"/",element:s.jsx(N8e,{})}),s.jsx(Bs,{path:"/admin",element:s.jsx(C8e,{})}),s.jsx(Bs,{path:"/artist/:artistId",element:s.jsx(S8e,{})}),s.jsx(Bs,{path:"/venue/:venueId",element:s.jsx(k8e,{})}),s.jsx(Bs,{path:"/streaming-stats",element:s.jsx(E8e,{})}),s.jsx(Bs,{path:"/following",element:s.jsx(_$,{})}),s.jsx(Bs,{path:"/following/:userId",element:s.jsx(_$,{})}),s.jsx(Bs,{path:"/auth/spotify/callback",element:s.jsx(jie,{})}),s.jsx(Bs,{path:"/components",element:s.jsx(XY,{})}),s.jsx(Bs,{path:"/mobile-preview/*",element:s.jsx(J8e,{})}),s.jsx(Bs,{path:"*",element:s.jsx(tse,{})})]})})]})})}));/*! Capacitor: https://capacitorjs.com/ - MIT License */var rp;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(rp||(rp={}));class BS extends Error{constructor(t,r,n){super(t),this.message=t,this.code=r,this.data=n}}const tBe=e=>{var t,r;return e!=null&&e.androidBridge?"android":!((r=(t=e==null?void 0:e.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},rBe=e=>{const t=e.CapacitorCustomPlatform||null,r=e.Capacitor||{},n=r.Plugins=r.Plugins||{},a=()=>t!==null?t.name:tBe(e),i=()=>a()!=="web",o=f=>{const h=d.get(f);return!!(h!=null&&h.platforms.has(a())||l(f))},l=f=>{var h;return(h=r.PluginHeaders)===null||h===void 0?void 0:h.find(p=>p.name===f)},c=f=>e.console.error(f),d=new Map,u=(f,h={})=>{const p=d.get(f);if(p)return console.warn(`Capacitor plugin "${f}" already registered. Cannot register plugins twice.`),p.proxy;const g=a(),v=l(f);let y;const _=()=>E(void 0,null,function*(){return!y&&g in h?y=typeof h[g]=="function"?y=yield h[g]():y=h[g]:t!==null&&!y&&"web"in h&&(y=typeof h.web=="function"?y=yield h.web():y=h.web),y}),w=(A,R)=>{var $,O;if(v){const z=v==null?void 0:v.methods.find(D=>R===D.name);if(z)return z.rtype==="promise"?D=>r.nativePromise(f,R.toString(),D):(D,B)=>r.nativeCallback(f,R.toString(),D,B);if(A)return($=A[R])===null||$===void 0?void 0:$.bind(A)}else{if(A)return(O=A[R])===null||O===void 0?void 0:O.bind(A);throw new BS(`"${f}" plugin is not implemented on ${g}`,rp.Unimplemented)}},b=A=>{let R;const $=(...O)=>{const z=_().then(D=>{const B=w(D,A);if(B){const F=B(...O);return R=F==null?void 0:F.remove,F}else throw new BS(`"${f}.${A}()" is not implemented on ${g}`,rp.Unimplemented)});return A==="addListener"&&(z.remove=()=>E(void 0,null,function*(){return R()})),z};return $.toString=()=>`${A.toString()}() { [capacitor code] }`,Object.defineProperty($,"name",{value:A,writable:!1,configurable:!1}),$},N=b("addListener"),S=b("removeListener"),k=(A,R)=>{const $=N({eventName:A},R),O=()=>E(void 0,null,function*(){const D=yield $;S({eventName:A,callbackId:D},R)}),z=new Promise(D=>$.then(()=>D({remove:O})));return z.remove=()=>E(void 0,null,function*(){console.warn("Using addListener() without 'await' is deprecated."),yield O()}),z},P=new Proxy({},{get(A,R){switch(R){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return v?k:N;case"removeListener":return S;default:return b(R)}}});return n[f]=P,d.set(f,{name:f,proxy:P,platforms:new Set([...Object.keys(h),...v?[g]:[]])}),P};return r.convertFileSrc||(r.convertFileSrc=f=>f),r.getPlatform=a,r.handleError=c,r.isNativePlatform=i,r.isPluginAvailable=o,r.registerPlugin=u,r.Exception=BS,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},nBe=e=>e.Capacitor=rBe(e),pC=nBe(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{}),Aj=pC.registerPlugin;class yR{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,r){let n=!1;this.listeners[t]||(this.listeners[t]=[],n=!0),this.listeners[t].push(r);const i=this.windowListeners[t];i&&!i.registered&&this.addWindowListener(i),n&&this.sendRetainedArgumentsForEvent(t);const o=()=>E(this,null,function*(){return this.removeListener(t,r)});return Promise.resolve({remove:o})}removeAllListeners(){return E(this,null,function*(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}})}notifyListeners(t,r,n){const a=this.listeners[t];if(!a){if(n){let i=this.retainedEventArguments[t];i||(i=[]),i.push(r),this.retainedEventArguments[t]=i}return}a.forEach(i=>i(r))}hasListeners(t){var r;return!!(!((r=this.listeners[t])===null||r===void 0)&&r.length)}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:n=>{this.notifyListeners(r,n)}}}unimplemented(t="not implemented"){return new pC.Exception(t,rp.Unimplemented)}unavailable(t="not available"){return new pC.Exception(t,rp.Unavailable)}removeListener(t,r){return E(this,null,function*(){const n=this.listeners[t];if(!n)return;const a=n.indexOf(r);this.listeners[t].splice(a,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])})}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const r=this.retainedEventArguments[t];r&&(delete this.retainedEventArguments[t],r.forEach(n=>{this.notifyListeners(t,n)}))}}const S$=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),k$=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class sBe extends yR{getCookies(){return E(this,null,function*(){const t=document.cookie,r={};return t.split(";").forEach(n=>{if(n.length<=0)return;let[a,i]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=k$(a).trim(),i=k$(i).trim(),r[a]=i}),r})}setCookie(t){return E(this,null,function*(){try{const r=S$(t.key),n=S$(t.value),a=`; expires=${(t.expires||"").replace("expires=","")}`,i=(t.path||"/").replace("path=",""),o=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${n||""}${a}; path=${i}; ${o};`}catch(r){return Promise.reject(r)}})}deleteCookie(t){return E(this,null,function*(){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}})}clearCookies(){return E(this,null,function*(){try{const t=document.cookie.split(";")||[];for(const r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}})}clearAllCookies(){return E(this,null,function*(){try{yield this.clearCookies()}catch(t){return Promise.reject(t)}})}}Aj("CapacitorCookies",{web:()=>new sBe});const aBe=e=>E(void 0,null,function*(){return new Promise((t,r)=>{const n=new FileReader;n.onload=()=>{const a=n.result;t(a.indexOf(",")>=0?a.split(",")[1]:a)},n.onerror=a=>r(a),n.readAsDataURL(e)})}),iBe=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(a=>a.toLocaleLowerCase()).reduce((a,i,o)=>(a[i]=e[t[o]],a),{})},oBe=(e,t=!0)=>e?Object.entries(e).reduce((n,a)=>{const[i,o]=a;let l,c;return Array.isArray(o)?(c="",o.forEach(d=>{l=t?encodeURIComponent(d):d,c+=`${i}=${l}&`}),c.slice(0,-1)):(l=t?encodeURIComponent(o):o,c=`${i}=${l}`),`${n}&${c}`},"").substr(1):null,lBe=(e,t={})=>{const r=Object.assign({method:e.method||"GET",headers:e.headers},t),a=iBe(e.headers)["content-type"]||"";if(typeof e.data=="string")r.body=e.data;else if(a.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,l]of Object.entries(e.data||{}))i.set(o,l);r.body=i.toString()}else if(a.includes("multipart/form-data")||e.data instanceof FormData){const i=new FormData;if(e.data instanceof FormData)e.data.forEach((l,c)=>{i.append(c,l)});else for(const l of Object.keys(e.data))i.append(l,e.data[l]);r.body=i;const o=new Headers(r.headers);o.delete("content-type"),r.headers=o}else(a.includes("application/json")||typeof e.data=="object")&&(r.body=JSON.stringify(e.data));return r};class cBe extends yR{request(t){return E(this,null,function*(){const r=lBe(t,t.webFetchExtra),n=oBe(t.params,t.shouldEncodeUrlParams),a=n?`${t.url}?${n}`:t.url,i=yield fetch(a,r),o=i.headers.get("content-type")||"";let{responseType:l="text"}=i.ok?t:{};o.includes("application/json")&&(l="json");let c,d;switch(l){case"arraybuffer":case"blob":d=yield i.blob(),c=yield aBe(d);break;case"json":c=yield i.json();break;case"document":case"text":default:c=yield i.text()}const u={};return i.headers.forEach((f,h)=>{u[h]=f}),{data:c,headers:u,status:i.status,url:i.url}})}get(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))})}post(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))})}put(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))})}patch(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))})}delete(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))})}}Aj("CapacitorHttp",{web:()=>new cBe});var E$;(function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"})(E$||(E$={}));var C$;(function(e){e.StatusBar="StatusBar",e.NavigationBar="NavigationBar"})(C$||(C$={}));class dBe extends yR{setStyle(){return E(this,null,function*(){this.unavailable("not available for web")})}setAnimation(){return E(this,null,function*(){this.unavailable("not available for web")})}show(){return E(this,null,function*(){this.unavailable("not available for web")})}hide(){return E(this,null,function*(){this.unavailable("not available for web")})}}Aj("SystemBars",{web:()=>new dBe});const uBe=Aj("SplashScreen",{web:()=>kn(()=>import("./web-CYZm_dnI.js"),[],import.meta.url).then(e=>new e.SplashScreenWeb)});console.log(" Main.tsx is executing...");const m_=document.getElementById("root");console.log(" Root element:",m_);if(!m_)console.error(" Root element not found!");else{console.log(" Root element found, creating React root...");try{const e=K6(m_);console.log(" React root created, rendering App..."),e.render(s.jsx(eBe,{})),console.log(" App rendered successfully!"),window.Capacitor!==void 0&&setTimeout(()=>E(void 0,null,function*(){try{yield uBe.hide(),console.log(" Splash screen hidden")}catch(r){console.log(" Splash screen not available:",r)}}),1e3)}catch(e){console.error(" Error rendering React app:",e),m_.innerHTML="<h1>Error loading app</h1><p>Check console for details</p>"}}export{yR as W,kn as _,Aj as r,T as s};
