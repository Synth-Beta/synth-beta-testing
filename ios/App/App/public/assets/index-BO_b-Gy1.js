var GY=Object.defineProperty,YY=Object.defineProperties;var KY=Object.getOwnPropertyDescriptors;var xx=Object.getOwnPropertySymbols;var p6=Object.prototype.hasOwnProperty,g6=Object.prototype.propertyIsEnumerable;var v6=e=>{throw TypeError(e)},Tp=Math.pow,_b=(e,t,r)=>t in e?GY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,M=(e,t)=>{for(var r in t||(t={}))p6.call(t,r)&&_b(e,r,t[r]);if(xx)for(var r of xx(t))g6.call(t,r)&&_b(e,r,t[r]);return e},W=(e,t)=>YY(e,KY(t));var me=(e,t)=>{var r={};for(var n in e)p6.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&xx)for(var n of xx(e))t.indexOf(n)<0&&g6.call(e,n)&&(r[n]=e[n]);return r};var _r=(e,t,r)=>_b(e,typeof t!="symbol"?t+"":t,r),wb=(e,t,r)=>t.has(e)||v6("Cannot "+r);var it=(e,t,r)=>(wb(e,t,"read from private field"),r?r.call(e):t.get(e)),nn=(e,t,r)=>t.has(e)?v6("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),wr=(e,t,r,n)=>(wb(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),fi=(e,t,r)=>(wb(e,t,"access private method"),r);var yx=(e,t,r,n)=>({set _(i){wr(e,t,i,r)},get _(){return it(e,t,n)}});var E=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},o=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,o);l((r=r.apply(e,t)).next())});function ZY(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Ks=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function rn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function XY(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var cR={exports:{}},Q_={},dR={exports:{}},Fr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hv=Symbol.for("react.element"),JY=Symbol.for("react.portal"),QY=Symbol.for("react.fragment"),eK=Symbol.for("react.strict_mode"),tK=Symbol.for("react.profiler"),rK=Symbol.for("react.provider"),nK=Symbol.for("react.context"),sK=Symbol.for("react.forward_ref"),iK=Symbol.for("react.suspense"),aK=Symbol.for("react.memo"),oK=Symbol.for("react.lazy"),x6=Symbol.iterator;function lK(e){return e===null||typeof e!="object"?null:(e=x6&&e[x6]||e["@@iterator"],typeof e=="function"?e:null)}var uR={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fR=Object.assign,hR={};function Fm(e,t,r){this.props=e,this.context=t,this.refs=hR,this.updater=r||uR}Fm.prototype.isReactComponent={};Fm.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Fm.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function mR(){}mR.prototype=Fm.prototype;function Y5(e,t,r){this.props=e,this.context=t,this.refs=hR,this.updater=r||uR}var K5=Y5.prototype=new mR;K5.constructor=Y5;fR(K5,Fm.prototype);K5.isPureReactComponent=!0;var y6=Array.isArray,pR=Object.prototype.hasOwnProperty,Z5={current:null},gR={key:!0,ref:!0,__self:!0,__source:!0};function vR(e,t,r){var n,i={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)pR.call(t,n)&&!gR.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:hv,type:e,key:a,ref:o,props:i,_owner:Z5.current}}function cK(e,t){return{$$typeof:hv,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function X5(e){return typeof e=="object"&&e!==null&&e.$$typeof===hv}function dK(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var _6=/\/+/g;function bb(e,t){return typeof e=="object"&&e!==null&&e.key!=null?dK(""+e.key):t.toString(36)}function Ny(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case hv:case JY:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+bb(o,0):n,y6(i)?(r="",e!=null&&(r=e.replace(_6,"$&/")+"/"),Ny(i,t,r,"",function(d){return d})):i!=null&&(X5(i)&&(i=cK(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(_6,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",y6(e))for(var l=0;l<e.length;l++){a=e[l];var c=n+bb(a,l);o+=Ny(a,t,r,c,i)}else if(c=lK(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=n+bb(a,l++),o+=Ny(a,t,r,c,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function _x(e,t,r){if(e==null)return e;var n=[],i=0;return Ny(e,n,"","",function(a){return t.call(r,a,i++)}),n}function uK(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $i={current:null},Sy={transition:null},fK={ReactCurrentDispatcher:$i,ReactCurrentBatchConfig:Sy,ReactCurrentOwner:Z5};function xR(){throw Error("act(...) is not supported in production builds of React.")}Fr.Children={map:_x,forEach:function(e,t,r){_x(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return _x(e,function(){t++}),t},toArray:function(e){return _x(e,function(t){return t})||[]},only:function(e){if(!X5(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Fr.Component=Fm;Fr.Fragment=QY;Fr.Profiler=tK;Fr.PureComponent=Y5;Fr.StrictMode=eK;Fr.Suspense=iK;Fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fK;Fr.act=xR;Fr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=fR({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=Z5.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)pR.call(t,c)&&!gR.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:hv,type:e.type,key:i,ref:a,props:n,_owner:o}};Fr.createContext=function(e){return e={$$typeof:nK,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:rK,_context:e},e.Consumer=e};Fr.createElement=vR;Fr.createFactory=function(e){var t=vR.bind(null,e);return t.type=e,t};Fr.createRef=function(){return{current:null}};Fr.forwardRef=function(e){return{$$typeof:sK,render:e}};Fr.isValidElement=X5;Fr.lazy=function(e){return{$$typeof:oK,_payload:{_status:-1,_result:e},_init:uK}};Fr.memo=function(e,t){return{$$typeof:aK,type:e,compare:t===void 0?null:t}};Fr.startTransition=function(e){var t=Sy.transition;Sy.transition={};try{e()}finally{Sy.transition=t}};Fr.unstable_act=xR;Fr.useCallback=function(e,t){return $i.current.useCallback(e,t)};Fr.useContext=function(e){return $i.current.useContext(e)};Fr.useDebugValue=function(){};Fr.useDeferredValue=function(e){return $i.current.useDeferredValue(e)};Fr.useEffect=function(e,t){return $i.current.useEffect(e,t)};Fr.useId=function(){return $i.current.useId()};Fr.useImperativeHandle=function(e,t,r){return $i.current.useImperativeHandle(e,t,r)};Fr.useInsertionEffect=function(e,t){return $i.current.useInsertionEffect(e,t)};Fr.useLayoutEffect=function(e,t){return $i.current.useLayoutEffect(e,t)};Fr.useMemo=function(e,t){return $i.current.useMemo(e,t)};Fr.useReducer=function(e,t,r){return $i.current.useReducer(e,t,r)};Fr.useRef=function(e){return $i.current.useRef(e)};Fr.useState=function(e){return $i.current.useState(e)};Fr.useSyncExternalStore=function(e,t,r){return $i.current.useSyncExternalStore(e,t,r)};Fr.useTransition=function(){return $i.current.useTransition()};Fr.version="18.3.1";dR.exports=Fr;var y=dR.exports;const Q=rn(y),J5=ZY({__proto__:null,default:Q},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hK=y,mK=Symbol.for("react.element"),pK=Symbol.for("react.fragment"),gK=Object.prototype.hasOwnProperty,vK=hK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xK={key:!0,ref:!0,__self:!0,__source:!0};function yR(e,t,r){var n,i={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)gK.call(t,n)&&!xK.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:mK,type:e,key:a,ref:o,props:i,_owner:vK.current}}Q_.Fragment=pK;Q_.jsx=yR;Q_.jsxs=yR;cR.exports=Q_;var s=cR.exports,_R={exports:{}},Pa={},wR={exports:{}},bR={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(z,K){var Z=z.length;z.push(K);e:for(;0<Z;){var G=Z-1>>>1,X=z[G];if(0<i(X,K))z[G]=K,z[Z]=X,Z=G;else break e}}function r(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var K=z[0],Z=z.pop();if(Z!==K){z[0]=Z;e:for(var G=0,X=z.length,te=X>>>1;G<te;){var se=2*(G+1)-1,ue=z[se],ye=se+1,ne=z[ye];if(0>i(ue,Z))ye<X&&0>i(ne,ue)?(z[G]=ne,z[ye]=Z,G=ye):(z[G]=ue,z[se]=Z,G=se);else if(ye<X&&0>i(ne,Z))z[G]=ne,z[ye]=Z,G=ye;else break e}}return K}function i(z,K){var Z=z.sortIndex-K.sortIndex;return Z!==0?Z:z.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,f=3,p=!1,x=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(z){for(var K=r(d);K!==null;){if(K.callback===null)n(d);else if(K.startTime<=z)n(d),K.sortIndex=K.expirationTime,t(c,K);else break;K=r(d)}}function N(z){if(g=!1,b(z),!x)if(r(c)!==null)x=!0,V(S);else{var K=r(d);K!==null&&Y(N,K.startTime-z)}}function S(z,K){x=!1,g&&(g=!1,_(A),A=-1),p=!0;var Z=f;try{for(b(K),h=r(c);h!==null&&(!(h.expirationTime>K)||z&&!R());){var G=h.callback;if(typeof G=="function"){h.callback=null,f=h.priorityLevel;var X=G(h.expirationTime<=K);K=e.unstable_now(),typeof X=="function"?h.callback=X:h===r(c)&&n(c),b(K)}else n(c);h=r(c)}if(h!==null)var te=!0;else{var se=r(d);se!==null&&Y(N,se.startTime-K),te=!1}return te}finally{h=null,f=Z,p=!1}}var k=!1,O=null,A=-1,T=5,$=-1;function R(){return!(e.unstable_now()-$<T)}function F(){if(O!==null){var z=e.unstable_now();$=z;var K=!0;try{K=O(!0,z)}finally{K?D():(k=!1,O=null)}}else k=!1}var D;if(typeof w=="function")D=function(){w(F)};else if(typeof MessageChannel!="undefined"){var B=new MessageChannel,U=B.port2;B.port1.onmessage=F,D=function(){U.postMessage(null)}}else D=function(){v(F,0)};function V(z){O=z,k||(k=!0,D())}function Y(z,K){A=v(function(){z(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,V(S))},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(z){switch(f){case 1:case 2:case 3:var K=3;break;default:K=f}var Z=f;f=K;try{return z()}finally{f=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,K){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Z=f;f=z;try{return K()}finally{f=Z}},e.unstable_scheduleCallback=function(z,K,Z){var G=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?G+Z:G):Z=G,z){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=Z+X,z={id:u++,callback:K,priorityLevel:z,startTime:Z,expirationTime:X,sortIndex:-1},Z>G?(z.sortIndex=Z,t(d,z),r(c)===null&&z===r(d)&&(g?(_(A),A=-1):g=!0,Y(N,Z-G))):(z.sortIndex=X,t(c,z),x||p||(x=!0,V(S))),z},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(z){var K=f;return function(){var Z=f;f=K;try{return z.apply(this,arguments)}finally{f=Z}}}})(bR);wR.exports=bR;var yK=wR.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _K=y,Ea=yK;function xt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jR=new Set,V0={};function sf(e,t){Hh(e,t),Hh(e+"Capture",t)}function Hh(e,t){for(V0[e]=t,e=0;e<t.length;e++)jR.add(t[e])}var hc=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),bN=Object.prototype.hasOwnProperty,wK=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w6={},b6={};function bK(e){return bN.call(b6,e)?!0:bN.call(w6,e)?!1:wK.test(e)?b6[e]=!0:(w6[e]=!0,!1)}function jK(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function NK(e,t,r,n){if(t===null||typeof t=="undefined"||jK(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Li(e,t,r,n,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var oi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){oi[e]=new Li(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];oi[t]=new Li(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){oi[e]=new Li(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){oi[e]=new Li(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){oi[e]=new Li(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){oi[e]=new Li(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){oi[e]=new Li(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){oi[e]=new Li(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){oi[e]=new Li(e,5,!1,e.toLowerCase(),null,!1,!1)});var Q5=/[\-:]([a-z])/g;function ek(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Q5,ek);oi[t]=new Li(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Q5,ek);oi[t]=new Li(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Q5,ek);oi[t]=new Li(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){oi[e]=new Li(e,1,!1,e.toLowerCase(),null,!1,!1)});oi.xlinkHref=new Li("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){oi[e]=new Li(e,1,!1,e.toLowerCase(),null,!0,!0)});function tk(e,t,r,n){var i=oi.hasOwnProperty(t)?oi[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(NK(t,r,i,n)&&(r=null),n||i===null?bK(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var kc=_K.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wx=Symbol.for("react.element"),Jf=Symbol.for("react.portal"),Qf=Symbol.for("react.fragment"),rk=Symbol.for("react.strict_mode"),jN=Symbol.for("react.profiler"),NR=Symbol.for("react.provider"),SR=Symbol.for("react.context"),nk=Symbol.for("react.forward_ref"),NN=Symbol.for("react.suspense"),SN=Symbol.for("react.suspense_list"),sk=Symbol.for("react.memo"),Gc=Symbol.for("react.lazy"),kR=Symbol.for("react.offscreen"),j6=Symbol.iterator;function Op(e){return e===null||typeof e!="object"?null:(e=j6&&e[j6]||e["@@iterator"],typeof e=="function"?e:null)}var Xn=Object.assign,jb;function f0(e){if(jb===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);jb=t&&t[1]||""}return`
`+jb+e}var Nb=!1;function Sb(e,t){if(!e||Nb)return"";Nb=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),a=n.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Nb=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?f0(e):""}function SK(e){switch(e.tag){case 5:return f0(e.type);case 16:return f0("Lazy");case 13:return f0("Suspense");case 19:return f0("SuspenseList");case 0:case 2:case 15:return e=Sb(e.type,!1),e;case 11:return e=Sb(e.type.render,!1),e;case 1:return e=Sb(e.type,!0),e;default:return""}}function kN(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Qf:return"Fragment";case Jf:return"Portal";case jN:return"Profiler";case rk:return"StrictMode";case NN:return"Suspense";case SN:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case SR:return(e.displayName||"Context")+".Consumer";case NR:return(e._context.displayName||"Context")+".Provider";case nk:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case sk:return t=e.displayName||null,t!==null?t:kN(e.type)||"Memo";case Gc:t=e._payload,e=e._init;try{return kN(e(t))}catch(r){}}return null}function kK(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kN(t);case 8:return t===rk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function bd(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ER(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function EK(e){var t=ER(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r!="undefined"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bx(e){e._valueTracker||(e._valueTracker=EK(e))}function CR(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ER(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Yy(e){if(e=e||(typeof document!="undefined"?document:void 0),typeof e=="undefined")return null;try{return e.activeElement||e.body}catch(t){return e.body}}function EN(e,t){var r=t.checked;return Xn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r!=null?r:e._wrapperState.initialChecked})}function N6(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=bd(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function PR(e,t){t=t.checked,t!=null&&tk(e,"checked",t,!1)}function CN(e,t){PR(e,t);var r=bd(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?PN(e,t.type,r):t.hasOwnProperty("defaultValue")&&PN(e,t.type,bd(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function S6(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function PN(e,t,r){(t!=="number"||Yy(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var h0=Array.isArray;function xh(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+bd(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function AN(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(xt(91));return Xn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function k6(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(xt(92));if(h0(r)){if(1<r.length)throw Error(xt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:bd(r)}}function AR(e,t){var r=bd(t.value),n=bd(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function E6(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function TR(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function TN(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?TR(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var jx,OR=function(e){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(jx=jx||document.createElement("div"),jx.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=jx.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function q0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var j0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},CK=["Webkit","ms","Moz","O"];Object.keys(j0).forEach(function(e){CK.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),j0[t]=j0[e]})});function RR(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||j0.hasOwnProperty(e)&&j0[e]?(""+t).trim():t+"px"}function MR(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=RR(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var PK=Xn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ON(e,t){if(t){if(PK[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(xt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(xt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(xt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(xt(62))}}function RN(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var MN=null;function ik(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var DN=null,yh=null,_h=null;function C6(e){if(e=gv(e)){if(typeof DN!="function")throw Error(xt(280));var t=e.stateNode;t&&(t=sw(t),DN(e.stateNode,e.type,t))}}function DR(e){yh?_h?_h.push(e):_h=[e]:yh=e}function IR(){if(yh){var e=yh,t=_h;if(_h=yh=null,C6(e),t)for(e=0;e<t.length;e++)C6(t[e])}}function $R(e,t){return e(t)}function LR(){}var kb=!1;function FR(e,t,r){if(kb)return e(t,r);kb=!0;try{return $R(e,t,r)}finally{kb=!1,(yh!==null||_h!==null)&&(LR(),IR())}}function W0(e,t){var r=e.stateNode;if(r===null)return null;var n=sw(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(xt(231,t,typeof r));return r}var IN=!1;if(hc)try{var Rp={};Object.defineProperty(Rp,"passive",{get:function(){IN=!0}}),window.addEventListener("test",Rp,Rp),window.removeEventListener("test",Rp,Rp)}catch(e){IN=!1}function AK(e,t,r,n,i,a,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var N0=!1,Ky=null,Zy=!1,$N=null,TK={onError:function(e){N0=!0,Ky=e}};function OK(e,t,r,n,i,a,o,l,c){N0=!1,Ky=null,AK.apply(TK,arguments)}function RK(e,t,r,n,i,a,o,l,c){if(OK.apply(this,arguments),N0){if(N0){var d=Ky;N0=!1,Ky=null}else throw Error(xt(198));Zy||(Zy=!0,$N=d)}}function af(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function UR(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function P6(e){if(af(e)!==e)throw Error(xt(188))}function MK(e){var t=e.alternate;if(!t){if(t=af(e),t===null)throw Error(xt(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return P6(i),e;if(a===n)return P6(i),t;a=a.sibling}throw Error(xt(188))}if(r.return!==n.return)r=i,n=a;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o)throw Error(xt(189))}}if(r.alternate!==n)throw Error(xt(190))}if(r.tag!==3)throw Error(xt(188));return r.stateNode.current===r?e:t}function BR(e){return e=MK(e),e!==null?zR(e):null}function zR(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=zR(e);if(t!==null)return t;e=e.sibling}return null}var VR=Ea.unstable_scheduleCallback,A6=Ea.unstable_cancelCallback,DK=Ea.unstable_shouldYield,IK=Ea.unstable_requestPaint,ds=Ea.unstable_now,$K=Ea.unstable_getCurrentPriorityLevel,ak=Ea.unstable_ImmediatePriority,qR=Ea.unstable_UserBlockingPriority,Xy=Ea.unstable_NormalPriority,LK=Ea.unstable_LowPriority,WR=Ea.unstable_IdlePriority,ew=null,gl=null;function FK(e){if(gl&&typeof gl.onCommitFiberRoot=="function")try{gl.onCommitFiberRoot(ew,e,void 0,(e.current.flags&128)===128)}catch(t){}}var To=Math.clz32?Math.clz32:zK,UK=Math.log,BK=Math.LN2;function zK(e){return e>>>=0,e===0?32:31-(UK(e)/BK|0)|0}var Nx=64,Sx=4194304;function m0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Jy(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=m0(l):(a&=o,a!==0&&(n=m0(a)))}else o=r&~i,o!==0?n=m0(o):a!==0&&(n=m0(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-To(t),i=1<<r,n|=e[r],t&=~i;return n}function VK(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qK(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-To(a),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=VK(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function LN(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function HR(){var e=Nx;return Nx<<=1,!(Nx&4194240)&&(Nx=64),e}function Eb(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function mv(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-To(t),e[t]=r}function WK(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-To(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function ok(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-To(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var pn=0;function GR(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var YR,lk,KR,ZR,XR,FN=!1,kx=[],ud=null,fd=null,hd=null,H0=new Map,G0=new Map,Zc=[],HK="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function T6(e,t){switch(e){case"focusin":case"focusout":ud=null;break;case"dragenter":case"dragleave":fd=null;break;case"mouseover":case"mouseout":hd=null;break;case"pointerover":case"pointerout":H0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":G0.delete(t.pointerId)}}function Mp(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=gv(t),t!==null&&lk(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function GK(e,t,r,n,i){switch(t){case"focusin":return ud=Mp(ud,e,t,r,n,i),!0;case"dragenter":return fd=Mp(fd,e,t,r,n,i),!0;case"mouseover":return hd=Mp(hd,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return H0.set(a,Mp(H0.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,G0.set(a,Mp(G0.get(a)||null,e,t,r,n,i)),!0}return!1}function JR(e){var t=ou(e.target);if(t!==null){var r=af(t);if(r!==null){if(t=r.tag,t===13){if(t=UR(r),t!==null){e.blockedOn=t,XR(e.priority,function(){KR(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ky(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=UN(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);MN=n,r.target.dispatchEvent(n),MN=null}else return t=gv(r),t!==null&&lk(t),e.blockedOn=r,!1;t.shift()}return!0}function O6(e,t,r){ky(e)&&r.delete(t)}function YK(){FN=!1,ud!==null&&ky(ud)&&(ud=null),fd!==null&&ky(fd)&&(fd=null),hd!==null&&ky(hd)&&(hd=null),H0.forEach(O6),G0.forEach(O6)}function Dp(e,t){e.blockedOn===t&&(e.blockedOn=null,FN||(FN=!0,Ea.unstable_scheduleCallback(Ea.unstable_NormalPriority,YK)))}function Y0(e){function t(i){return Dp(i,e)}if(0<kx.length){Dp(kx[0],e);for(var r=1;r<kx.length;r++){var n=kx[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ud!==null&&Dp(ud,e),fd!==null&&Dp(fd,e),hd!==null&&Dp(hd,e),H0.forEach(t),G0.forEach(t),r=0;r<Zc.length;r++)n=Zc[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Zc.length&&(r=Zc[0],r.blockedOn===null);)JR(r),r.blockedOn===null&&Zc.shift()}var wh=kc.ReactCurrentBatchConfig,Qy=!0;function KK(e,t,r,n){var i=pn,a=wh.transition;wh.transition=null;try{pn=1,ck(e,t,r,n)}finally{pn=i,wh.transition=a}}function ZK(e,t,r,n){var i=pn,a=wh.transition;wh.transition=null;try{pn=4,ck(e,t,r,n)}finally{pn=i,wh.transition=a}}function ck(e,t,r,n){if(Qy){var i=UN(e,t,r,n);if(i===null)$b(e,t,n,e2,r),T6(e,n);else if(GK(i,e,t,r,n))n.stopPropagation();else if(T6(e,n),t&4&&-1<HK.indexOf(e)){for(;i!==null;){var a=gv(i);if(a!==null&&YR(a),a=UN(e,t,r,n),a===null&&$b(e,t,n,e2,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else $b(e,t,n,null,r)}}var e2=null;function UN(e,t,r,n){if(e2=null,e=ik(n),e=ou(e),e!==null)if(t=af(e),t===null)e=null;else if(r=t.tag,r===13){if(e=UR(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return e2=e,null}function QR(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($K()){case ak:return 1;case qR:return 4;case Xy:case LK:return 16;case WR:return 536870912;default:return 16}default:return 16}}var ad=null,dk=null,Ey=null;function eM(){if(Ey)return Ey;var e,t=dk,r=t.length,n,i="value"in ad?ad.value:ad.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[a-n];n++);return Ey=i.slice(e,1<n?1-n:void 0)}function Cy(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ex(){return!0}function R6(){return!1}function Aa(e){function t(r,n,i,a,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Ex:R6,this.isPropagationStopped=R6,this}return Xn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ex)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ex)},persist:function(){},isPersistent:Ex}),t}var Um={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uk=Aa(Um),pv=Xn({},Um,{view:0,detail:0}),XK=Aa(pv),Cb,Pb,Ip,tw=Xn({},pv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fk,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ip&&(Ip&&e.type==="mousemove"?(Cb=e.screenX-Ip.screenX,Pb=e.screenY-Ip.screenY):Pb=Cb=0,Ip=e),Cb)},movementY:function(e){return"movementY"in e?e.movementY:Pb}}),M6=Aa(tw),JK=Xn({},tw,{dataTransfer:0}),QK=Aa(JK),eZ=Xn({},pv,{relatedTarget:0}),Ab=Aa(eZ),tZ=Xn({},Um,{animationName:0,elapsedTime:0,pseudoElement:0}),rZ=Aa(tZ),nZ=Xn({},Um,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),sZ=Aa(nZ),iZ=Xn({},Um,{data:0}),D6=Aa(iZ),aZ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oZ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lZ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cZ(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=lZ[e])?!!t[e]:!1}function fk(){return cZ}var dZ=Xn({},pv,{key:function(e){if(e.key){var t=aZ[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Cy(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?oZ[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fk,charCode:function(e){return e.type==="keypress"?Cy(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Cy(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),uZ=Aa(dZ),fZ=Xn({},tw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),I6=Aa(fZ),hZ=Xn({},pv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fk}),mZ=Aa(hZ),pZ=Xn({},Um,{propertyName:0,elapsedTime:0,pseudoElement:0}),gZ=Aa(pZ),vZ=Xn({},tw,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xZ=Aa(vZ),yZ=[9,13,27,32],hk=hc&&"CompositionEvent"in window,S0=null;hc&&"documentMode"in document&&(S0=document.documentMode);var _Z=hc&&"TextEvent"in window&&!S0,tM=hc&&(!hk||S0&&8<S0&&11>=S0),$6=" ",L6=!1;function rM(e,t){switch(e){case"keyup":return yZ.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nM(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var eh=!1;function wZ(e,t){switch(e){case"compositionend":return nM(t);case"keypress":return t.which!==32?null:(L6=!0,$6);case"textInput":return e=t.data,e===$6&&L6?null:e;default:return null}}function bZ(e,t){if(eh)return e==="compositionend"||!hk&&rM(e,t)?(e=eM(),Ey=dk=ad=null,eh=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return tM&&t.locale!=="ko"?null:t.data;default:return null}}var jZ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function F6(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!jZ[e.type]:t==="textarea"}function sM(e,t,r,n){DR(n),t=t2(t,"onChange"),0<t.length&&(r=new uk("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var k0=null,K0=null;function NZ(e){pM(e,0)}function rw(e){var t=nh(e);if(CR(t))return e}function SZ(e,t){if(e==="change")return t}var iM=!1;if(hc){var Tb;if(hc){var Ob="oninput"in document;if(!Ob){var U6=document.createElement("div");U6.setAttribute("oninput","return;"),Ob=typeof U6.oninput=="function"}Tb=Ob}else Tb=!1;iM=Tb&&(!document.documentMode||9<document.documentMode)}function B6(){k0&&(k0.detachEvent("onpropertychange",aM),K0=k0=null)}function aM(e){if(e.propertyName==="value"&&rw(K0)){var t=[];sM(t,K0,e,ik(e)),FR(NZ,t)}}function kZ(e,t,r){e==="focusin"?(B6(),k0=t,K0=r,k0.attachEvent("onpropertychange",aM)):e==="focusout"&&B6()}function EZ(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return rw(K0)}function CZ(e,t){if(e==="click")return rw(t)}function PZ(e,t){if(e==="input"||e==="change")return rw(t)}function AZ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ro=typeof Object.is=="function"?Object.is:AZ;function Z0(e,t){if(Ro(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!bN.call(t,i)||!Ro(e[i],t[i]))return!1}return!0}function z6(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function V6(e,t){var r=z6(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=z6(r)}}function oM(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?oM(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function lM(){for(var e=window,t=Yy();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch(n){r=!1}if(r)e=t.contentWindow;else break;t=Yy(e.document)}return t}function mk(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function TZ(e){var t=lM(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&oM(r.ownerDocument.documentElement,r)){if(n!==null&&mk(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=V6(r,a);var o=V6(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var OZ=hc&&"documentMode"in document&&11>=document.documentMode,th=null,BN=null,E0=null,zN=!1;function q6(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;zN||th==null||th!==Yy(n)||(n=th,"selectionStart"in n&&mk(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),E0&&Z0(E0,n)||(E0=n,n=t2(BN,"onSelect"),0<n.length&&(t=new uk("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=th)))}function Cx(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var rh={animationend:Cx("Animation","AnimationEnd"),animationiteration:Cx("Animation","AnimationIteration"),animationstart:Cx("Animation","AnimationStart"),transitionend:Cx("Transition","TransitionEnd")},Rb={},cM={};hc&&(cM=document.createElement("div").style,"AnimationEvent"in window||(delete rh.animationend.animation,delete rh.animationiteration.animation,delete rh.animationstart.animation),"TransitionEvent"in window||delete rh.transitionend.transition);function nw(e){if(Rb[e])return Rb[e];if(!rh[e])return e;var t=rh[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in cM)return Rb[e]=t[r];return e}var dM=nw("animationend"),uM=nw("animationiteration"),fM=nw("animationstart"),hM=nw("transitionend"),mM=new Map,W6="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ad(e,t){mM.set(e,t),sf(t,[e])}for(var Mb=0;Mb<W6.length;Mb++){var Db=W6[Mb],RZ=Db.toLowerCase(),MZ=Db[0].toUpperCase()+Db.slice(1);Ad(RZ,"on"+MZ)}Ad(dM,"onAnimationEnd");Ad(uM,"onAnimationIteration");Ad(fM,"onAnimationStart");Ad("dblclick","onDoubleClick");Ad("focusin","onFocus");Ad("focusout","onBlur");Ad(hM,"onTransitionEnd");Hh("onMouseEnter",["mouseout","mouseover"]);Hh("onMouseLeave",["mouseout","mouseover"]);Hh("onPointerEnter",["pointerout","pointerover"]);Hh("onPointerLeave",["pointerout","pointerover"]);sf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sf("onBeforeInput",["compositionend","keypress","textInput","paste"]);sf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var p0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DZ=new Set("cancel close invalid load scroll toggle".split(" ").concat(p0));function H6(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,RK(n,t,void 0,e),e.currentTarget=null}function pM(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==a&&i.isPropagationStopped())break e;H6(i,l,d),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==a&&i.isPropagationStopped())break e;H6(i,l,d),a=c}}}if(Zy)throw e=$N,Zy=!1,$N=null,e}function $n(e,t){var r=t[GN];r===void 0&&(r=t[GN]=new Set);var n=e+"__bubble";r.has(n)||(gM(t,e,2,!1),r.add(n))}function Ib(e,t,r){var n=0;t&&(n|=4),gM(r,e,n,t)}var Px="_reactListening"+Math.random().toString(36).slice(2);function X0(e){if(!e[Px]){e[Px]=!0,jR.forEach(function(r){r!=="selectionchange"&&(DZ.has(r)||Ib(r,!1,e),Ib(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Px]||(t[Px]=!0,Ib("selectionchange",!1,t))}}function gM(e,t,r,n){switch(QR(t)){case 1:var i=KK;break;case 4:i=ZK;break;default:i=ck}r=i.bind(null,t,r,e),i=void 0,!IN||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function $b(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=ou(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}FR(function(){var d=a,u=ik(r),h=[];e:{var f=mM.get(e);if(f!==void 0){var p=uk,x=e;switch(e){case"keypress":if(Cy(r)===0)break e;case"keydown":case"keyup":p=uZ;break;case"focusin":x="focus",p=Ab;break;case"focusout":x="blur",p=Ab;break;case"beforeblur":case"afterblur":p=Ab;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=M6;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=QK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=mZ;break;case dM:case uM:case fM:p=rZ;break;case hM:p=gZ;break;case"scroll":p=XK;break;case"wheel":p=xZ;break;case"copy":case"cut":case"paste":p=sZ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=I6}var g=(t&4)!==0,v=!g&&e==="scroll",_=g?f!==null?f+"Capture":null:f;g=[];for(var w=d,b;w!==null;){b=w;var N=b.stateNode;if(b.tag===5&&N!==null&&(b=N,_!==null&&(N=W0(w,_),N!=null&&g.push(J0(w,N,b)))),v)break;w=w.return}0<g.length&&(f=new p(f,x,null,r,u),h.push({event:f,listeners:g}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&r!==MN&&(x=r.relatedTarget||r.fromElement)&&(ou(x)||x[mc]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=d,x=x?ou(x):null,x!==null&&(v=af(x),x!==v||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=d),p!==x)){if(g=M6,N="onMouseLeave",_="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(g=I6,N="onPointerLeave",_="onPointerEnter",w="pointer"),v=p==null?f:nh(p),b=x==null?f:nh(x),f=new g(N,w+"leave",p,r,u),f.target=v,f.relatedTarget=b,N=null,ou(u)===d&&(g=new g(_,w+"enter",x,r,u),g.target=b,g.relatedTarget=v,N=g),v=N,p&&x)t:{for(g=p,_=x,w=0,b=g;b;b=Pf(b))w++;for(b=0,N=_;N;N=Pf(N))b++;for(;0<w-b;)g=Pf(g),w--;for(;0<b-w;)_=Pf(_),b--;for(;w--;){if(g===_||_!==null&&g===_.alternate)break t;g=Pf(g),_=Pf(_)}g=null}else g=null;p!==null&&G6(h,f,p,g,!1),x!==null&&v!==null&&G6(h,v,x,g,!0)}}e:{if(f=d?nh(d):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var S=SZ;else if(F6(f))if(iM)S=PZ;else{S=EZ;var k=kZ}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(S=CZ);if(S&&(S=S(e,d))){sM(h,S,r,u);break e}k&&k(e,f,d),e==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&PN(f,"number",f.value)}switch(k=d?nh(d):window,e){case"focusin":(F6(k)||k.contentEditable==="true")&&(th=k,BN=d,E0=null);break;case"focusout":E0=BN=th=null;break;case"mousedown":zN=!0;break;case"contextmenu":case"mouseup":case"dragend":zN=!1,q6(h,r,u);break;case"selectionchange":if(OZ)break;case"keydown":case"keyup":q6(h,r,u)}var O;if(hk)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else eh?rM(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(tM&&r.locale!=="ko"&&(eh||A!=="onCompositionStart"?A==="onCompositionEnd"&&eh&&(O=eM()):(ad=u,dk="value"in ad?ad.value:ad.textContent,eh=!0)),k=t2(d,A),0<k.length&&(A=new D6(A,e,null,r,u),h.push({event:A,listeners:k}),O?A.data=O:(O=nM(r),O!==null&&(A.data=O)))),(O=_Z?wZ(e,r):bZ(e,r))&&(d=t2(d,"onBeforeInput"),0<d.length&&(u=new D6("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:d}),u.data=O))}pM(h,t)})}function J0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function t2(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=W0(e,r),a!=null&&n.unshift(J0(e,a,i)),a=W0(e,t),a!=null&&n.push(J0(e,a,i))),e=e.return}return n}function Pf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function G6(e,t,r,n,i){for(var a=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,i?(c=W0(r,a),c!=null&&o.unshift(J0(r,c,l))):i||(c=W0(r,a),c!=null&&o.push(J0(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var IZ=/\r\n?/g,$Z=/\u0000|\uFFFD/g;function Y6(e){return(typeof e=="string"?e:""+e).replace(IZ,`
`).replace($Z,"")}function Ax(e,t,r){if(t=Y6(t),Y6(e)!==t&&r)throw Error(xt(425))}function r2(){}var VN=null,qN=null;function WN(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var HN=typeof setTimeout=="function"?setTimeout:void 0,LZ=typeof clearTimeout=="function"?clearTimeout:void 0,K6=typeof Promise=="function"?Promise:void 0,FZ=typeof queueMicrotask=="function"?queueMicrotask:typeof K6!="undefined"?function(e){return K6.resolve(null).then(e).catch(UZ)}:HN;function UZ(e){setTimeout(function(){throw e})}function Lb(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Y0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Y0(t)}function md(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Z6(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Bm=Math.random().toString(36).slice(2),sl="__reactFiber$"+Bm,Q0="__reactProps$"+Bm,mc="__reactContainer$"+Bm,GN="__reactEvents$"+Bm,BZ="__reactListeners$"+Bm,zZ="__reactHandles$"+Bm;function ou(e){var t=e[sl];if(t)return t;for(var r=e.parentNode;r;){if(t=r[mc]||r[sl]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Z6(e);e!==null;){if(r=e[sl])return r;e=Z6(e)}return t}e=r,r=e.parentNode}return null}function gv(e){return e=e[sl]||e[mc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function nh(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(xt(33))}function sw(e){return e[Q0]||null}var YN=[],sh=-1;function Td(e){return{current:e}}function Un(e){0>sh||(e.current=YN[sh],YN[sh]=null,sh--)}function An(e,t){sh++,YN[sh]=e.current,e.current=t}var jd={},wi=Td(jd),na=Td(!1),Du=jd;function Gh(e,t){var r=e.type.contextTypes;if(!r)return jd;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function sa(e){return e=e.childContextTypes,e!=null}function n2(){Un(na),Un(wi)}function X6(e,t,r){if(wi.current!==jd)throw Error(xt(168));An(wi,t),An(na,r)}function vM(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(xt(108,kK(e)||"Unknown",i));return Xn({},r,n)}function s2(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||jd,Du=wi.current,An(wi,e),An(na,na.current),!0}function J6(e,t,r){var n=e.stateNode;if(!n)throw Error(xt(169));r?(e=vM(e,t,Du),n.__reactInternalMemoizedMergedChildContext=e,Un(na),Un(wi),An(wi,e)):Un(na),An(na,r)}var Yl=null,iw=!1,Fb=!1;function xM(e){Yl===null?Yl=[e]:Yl.push(e)}function VZ(e){iw=!0,xM(e)}function Od(){if(!Fb&&Yl!==null){Fb=!0;var e=0,t=pn;try{var r=Yl;for(pn=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Yl=null,iw=!1}catch(i){throw Yl!==null&&(Yl=Yl.slice(e+1)),VR(ak,Od),i}finally{pn=t,Fb=!1}}return null}var ih=[],ah=0,i2=null,a2=0,La=[],Fa=0,Iu=null,Zl=1,Xl="";function Xd(e,t){ih[ah++]=a2,ih[ah++]=i2,i2=e,a2=t}function yM(e,t,r){La[Fa++]=Zl,La[Fa++]=Xl,La[Fa++]=Iu,Iu=e;var n=Zl;e=Xl;var i=32-To(n)-1;n&=~(1<<i),r+=1;var a=32-To(t)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Zl=1<<32-To(t)+i|r<<i|n,Xl=a+e}else Zl=1<<a|r<<i|n,Xl=e}function pk(e){e.return!==null&&(Xd(e,1),yM(e,1,0))}function gk(e){for(;e===i2;)i2=ih[--ah],ih[ah]=null,a2=ih[--ah],ih[ah]=null;for(;e===Iu;)Iu=La[--Fa],La[Fa]=null,Xl=La[--Fa],La[Fa]=null,Zl=La[--Fa],La[Fa]=null}var Na=null,ba=null,qn=!1,wo=null;function _M(e,t){var r=za(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Q6(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Na=e,ba=md(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Na=e,ba=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Iu!==null?{id:Zl,overflow:Xl}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=za(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Na=e,ba=null,!0):!1;default:return!1}}function KN(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ZN(e){if(qn){var t=ba;if(t){var r=t;if(!Q6(e,t)){if(KN(e))throw Error(xt(418));t=md(r.nextSibling);var n=Na;t&&Q6(e,t)?_M(n,r):(e.flags=e.flags&-4097|2,qn=!1,Na=e)}}else{if(KN(e))throw Error(xt(418));e.flags=e.flags&-4097|2,qn=!1,Na=e}}}function eP(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Na=e}function Tx(e){if(e!==Na)return!1;if(!qn)return eP(e),qn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!WN(e.type,e.memoizedProps)),t&&(t=ba)){if(KN(e))throw wM(),Error(xt(418));for(;t;)_M(e,t),t=md(t.nextSibling)}if(eP(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(xt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ba=md(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ba=null}}else ba=Na?md(e.stateNode.nextSibling):null;return!0}function wM(){for(var e=ba;e;)e=md(e.nextSibling)}function Yh(){ba=Na=null,qn=!1}function vk(e){wo===null?wo=[e]:wo.push(e)}var qZ=kc.ReactCurrentBatchConfig;function $p(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(xt(309));var n=r.stateNode}if(!n)throw Error(xt(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(xt(284));if(!r._owner)throw Error(xt(290,e))}return e}function Ox(e,t){throw e=Object.prototype.toString.call(t),Error(xt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function tP(e){var t=e._init;return t(e._payload)}function bM(e){function t(_,w){if(e){var b=_.deletions;b===null?(_.deletions=[w],_.flags|=16):b.push(w)}}function r(_,w){if(!e)return null;for(;w!==null;)t(_,w),w=w.sibling;return null}function n(_,w){for(_=new Map;w!==null;)w.key!==null?_.set(w.key,w):_.set(w.index,w),w=w.sibling;return _}function i(_,w){return _=xd(_,w),_.index=0,_.sibling=null,_}function a(_,w,b){return _.index=b,e?(b=_.alternate,b!==null?(b=b.index,b<w?(_.flags|=2,w):b):(_.flags|=2,w)):(_.flags|=1048576,w)}function o(_){return e&&_.alternate===null&&(_.flags|=2),_}function l(_,w,b,N){return w===null||w.tag!==6?(w=Hb(b,_.mode,N),w.return=_,w):(w=i(w,b),w.return=_,w)}function c(_,w,b,N){var S=b.type;return S===Qf?u(_,w,b.props.children,N,b.key):w!==null&&(w.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Gc&&tP(S)===w.type)?(N=i(w,b.props),N.ref=$p(_,w,b),N.return=_,N):(N=Dy(b.type,b.key,b.props,null,_.mode,N),N.ref=$p(_,w,b),N.return=_,N)}function d(_,w,b,N){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=Gb(b,_.mode,N),w.return=_,w):(w=i(w,b.children||[]),w.return=_,w)}function u(_,w,b,N,S){return w===null||w.tag!==7?(w=Eu(b,_.mode,N,S),w.return=_,w):(w=i(w,b),w.return=_,w)}function h(_,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Hb(""+w,_.mode,b),w.return=_,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case wx:return b=Dy(w.type,w.key,w.props,null,_.mode,b),b.ref=$p(_,null,w),b.return=_,b;case Jf:return w=Gb(w,_.mode,b),w.return=_,w;case Gc:var N=w._init;return h(_,N(w._payload),b)}if(h0(w)||Op(w))return w=Eu(w,_.mode,b,null),w.return=_,w;Ox(_,w)}return null}function f(_,w,b,N){var S=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:l(_,w,""+b,N);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case wx:return b.key===S?c(_,w,b,N):null;case Jf:return b.key===S?d(_,w,b,N):null;case Gc:return S=b._init,f(_,w,S(b._payload),N)}if(h0(b)||Op(b))return S!==null?null:u(_,w,b,N,null);Ox(_,b)}return null}function p(_,w,b,N,S){if(typeof N=="string"&&N!==""||typeof N=="number")return _=_.get(b)||null,l(w,_,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case wx:return _=_.get(N.key===null?b:N.key)||null,c(w,_,N,S);case Jf:return _=_.get(N.key===null?b:N.key)||null,d(w,_,N,S);case Gc:var k=N._init;return p(_,w,b,k(N._payload),S)}if(h0(N)||Op(N))return _=_.get(b)||null,u(w,_,N,S,null);Ox(w,N)}return null}function x(_,w,b,N){for(var S=null,k=null,O=w,A=w=0,T=null;O!==null&&A<b.length;A++){O.index>A?(T=O,O=null):T=O.sibling;var $=f(_,O,b[A],N);if($===null){O===null&&(O=T);break}e&&O&&$.alternate===null&&t(_,O),w=a($,w,A),k===null?S=$:k.sibling=$,k=$,O=T}if(A===b.length)return r(_,O),qn&&Xd(_,A),S;if(O===null){for(;A<b.length;A++)O=h(_,b[A],N),O!==null&&(w=a(O,w,A),k===null?S=O:k.sibling=O,k=O);return qn&&Xd(_,A),S}for(O=n(_,O);A<b.length;A++)T=p(O,_,A,b[A],N),T!==null&&(e&&T.alternate!==null&&O.delete(T.key===null?A:T.key),w=a(T,w,A),k===null?S=T:k.sibling=T,k=T);return e&&O.forEach(function(R){return t(_,R)}),qn&&Xd(_,A),S}function g(_,w,b,N){var S=Op(b);if(typeof S!="function")throw Error(xt(150));if(b=S.call(b),b==null)throw Error(xt(151));for(var k=S=null,O=w,A=w=0,T=null,$=b.next();O!==null&&!$.done;A++,$=b.next()){O.index>A?(T=O,O=null):T=O.sibling;var R=f(_,O,$.value,N);if(R===null){O===null&&(O=T);break}e&&O&&R.alternate===null&&t(_,O),w=a(R,w,A),k===null?S=R:k.sibling=R,k=R,O=T}if($.done)return r(_,O),qn&&Xd(_,A),S;if(O===null){for(;!$.done;A++,$=b.next())$=h(_,$.value,N),$!==null&&(w=a($,w,A),k===null?S=$:k.sibling=$,k=$);return qn&&Xd(_,A),S}for(O=n(_,O);!$.done;A++,$=b.next())$=p(O,_,A,$.value,N),$!==null&&(e&&$.alternate!==null&&O.delete($.key===null?A:$.key),w=a($,w,A),k===null?S=$:k.sibling=$,k=$);return e&&O.forEach(function(F){return t(_,F)}),qn&&Xd(_,A),S}function v(_,w,b,N){if(typeof b=="object"&&b!==null&&b.type===Qf&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case wx:e:{for(var S=b.key,k=w;k!==null;){if(k.key===S){if(S=b.type,S===Qf){if(k.tag===7){r(_,k.sibling),w=i(k,b.props.children),w.return=_,_=w;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Gc&&tP(S)===k.type){r(_,k.sibling),w=i(k,b.props),w.ref=$p(_,k,b),w.return=_,_=w;break e}r(_,k);break}else t(_,k);k=k.sibling}b.type===Qf?(w=Eu(b.props.children,_.mode,N,b.key),w.return=_,_=w):(N=Dy(b.type,b.key,b.props,null,_.mode,N),N.ref=$p(_,w,b),N.return=_,_=N)}return o(_);case Jf:e:{for(k=b.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){r(_,w.sibling),w=i(w,b.children||[]),w.return=_,_=w;break e}else{r(_,w);break}else t(_,w);w=w.sibling}w=Gb(b,_.mode,N),w.return=_,_=w}return o(_);case Gc:return k=b._init,v(_,w,k(b._payload),N)}if(h0(b))return x(_,w,b,N);if(Op(b))return g(_,w,b,N);Ox(_,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(r(_,w.sibling),w=i(w,b),w.return=_,_=w):(r(_,w),w=Hb(b,_.mode,N),w.return=_,_=w),o(_)):r(_,w)}return v}var Kh=bM(!0),jM=bM(!1),o2=Td(null),l2=null,oh=null,xk=null;function yk(){xk=oh=l2=null}function _k(e){var t=o2.current;Un(o2),e._currentValue=t}function XN(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function bh(e,t){l2=e,xk=oh=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ji=!0),e.firstContext=null)}function Ja(e){var t=e._currentValue;if(xk!==e)if(e={context:e,memoizedValue:t,next:null},oh===null){if(l2===null)throw Error(xt(308));oh=e,l2.dependencies={lanes:0,firstContext:e}}else oh=oh.next=e;return t}var lu=null;function wk(e){lu===null?lu=[e]:lu.push(e)}function NM(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,wk(t)):(r.next=i.next,i.next=r),t.interleaved=r,pc(e,n)}function pc(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Yc=!1;function bk(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function SM(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function lc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function pd(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,en&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,pc(e,r)}return i=n.interleaved,i===null?(t.next=t,wk(n)):(t.next=i.next,i.next=t),n.interleaved=t,pc(e,r)}function Py(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ok(e,r)}}function rP(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function c2(e,t,r,n){var i=e.updateQueue;Yc=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?a=d:o.next=d,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(a!==null){var h=i.baseState;o=0,u=d=c=null,l=a;do{var f=l.lane,p=l.eventTime;if((n&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,g=l;switch(f=t,p=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){h=x.call(p,h,f);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,f=typeof x=="function"?x.call(p,h,f):x,f==null)break e;h=Xn({},h,f);break e;case 2:Yc=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=i.effects,f===null?i.effects=[l]:f.push(l))}else p={eventTime:p,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=p,c=h):u=u.next=p,o|=f;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;f=l,l=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(c=h),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);Lu|=o,e.lanes=o,e.memoizedState=h}}function nP(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(xt(191,i));i.call(n)}}}var vv={},vl=Td(vv),eg=Td(vv),tg=Td(vv);function cu(e){if(e===vv)throw Error(xt(174));return e}function jk(e,t){switch(An(tg,t),An(eg,e),An(vl,vv),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:TN(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=TN(t,e)}Un(vl),An(vl,t)}function Zh(){Un(vl),Un(eg),Un(tg)}function kM(e){cu(tg.current);var t=cu(vl.current),r=TN(t,e.type);t!==r&&(An(eg,e),An(vl,r))}function Nk(e){eg.current===e&&(Un(vl),Un(eg))}var Yn=Td(0);function d2(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ub=[];function Sk(){for(var e=0;e<Ub.length;e++)Ub[e]._workInProgressVersionPrimary=null;Ub.length=0}var Ay=kc.ReactCurrentDispatcher,Bb=kc.ReactCurrentBatchConfig,$u=0,Zn=null,Ts=null,Vs=null,u2=!1,C0=!1,rg=0,WZ=0;function hi(){throw Error(xt(321))}function kk(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ro(e[r],t[r]))return!1;return!0}function Ek(e,t,r,n,i,a){if($u=a,Zn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ay.current=e===null||e.memoizedState===null?KZ:ZZ,e=r(n,i),C0){a=0;do{if(C0=!1,rg=0,25<=a)throw Error(xt(301));a+=1,Vs=Ts=null,t.updateQueue=null,Ay.current=XZ,e=r(n,i)}while(C0)}if(Ay.current=f2,t=Ts!==null&&Ts.next!==null,$u=0,Vs=Ts=Zn=null,u2=!1,t)throw Error(xt(300));return e}function Ck(){var e=rg!==0;return rg=0,e}function Ko(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vs===null?Zn.memoizedState=Vs=e:Vs=Vs.next=e,Vs}function Qa(){if(Ts===null){var e=Zn.alternate;e=e!==null?e.memoizedState:null}else e=Ts.next;var t=Vs===null?Zn.memoizedState:Vs.next;if(t!==null)Vs=t,Ts=e;else{if(e===null)throw Error(xt(310));Ts=e,e={memoizedState:Ts.memoizedState,baseState:Ts.baseState,baseQueue:Ts.baseQueue,queue:Ts.queue,next:null},Vs===null?Zn.memoizedState=Vs=e:Vs=Vs.next=e}return Vs}function ng(e,t){return typeof t=="function"?t(e):t}function zb(e){var t=Qa(),r=t.queue;if(r===null)throw Error(xt(311));r.lastRenderedReducer=e;var n=Ts,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var l=o=null,c=null,d=a;do{var u=d.lane;if(($u&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=h,o=n):c=c.next=h,Zn.lanes|=u,Lu|=u}d=d.next}while(d!==null&&d!==a);c===null?o=n:c.next=l,Ro(n,t.memoizedState)||(Ji=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,Zn.lanes|=a,Lu|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Vb(e){var t=Qa(),r=t.queue;if(r===null)throw Error(xt(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Ro(a,t.memoizedState)||(Ji=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function EM(){}function CM(e,t){var r=Zn,n=Qa(),i=t(),a=!Ro(n.memoizedState,i);if(a&&(n.memoizedState=i,Ji=!0),n=n.queue,Pk(TM.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Vs!==null&&Vs.memoizedState.tag&1){if(r.flags|=2048,sg(9,AM.bind(null,r,n,i,t),void 0,null),Zs===null)throw Error(xt(349));$u&30||PM(r,t,i)}return i}function PM(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Zn.updateQueue,t===null?(t={lastEffect:null,stores:null},Zn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function AM(e,t,r,n){t.value=r,t.getSnapshot=n,OM(t)&&RM(e)}function TM(e,t,r){return r(function(){OM(t)&&RM(e)})}function OM(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ro(e,r)}catch(n){return!0}}function RM(e){var t=pc(e,1);t!==null&&Oo(t,e,1,-1)}function sP(e){var t=Ko();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ng,lastRenderedState:e},t.queue=e,e=e.dispatch=YZ.bind(null,Zn,e),[t.memoizedState,e]}function sg(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Zn.updateQueue,t===null?(t={lastEffect:null,stores:null},Zn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function MM(){return Qa().memoizedState}function Ty(e,t,r,n){var i=Ko();Zn.flags|=e,i.memoizedState=sg(1|t,r,void 0,n===void 0?null:n)}function aw(e,t,r,n){var i=Qa();n=n===void 0?null:n;var a=void 0;if(Ts!==null){var o=Ts.memoizedState;if(a=o.destroy,n!==null&&kk(n,o.deps)){i.memoizedState=sg(t,r,a,n);return}}Zn.flags|=e,i.memoizedState=sg(1|t,r,a,n)}function iP(e,t){return Ty(8390656,8,e,t)}function Pk(e,t){return aw(2048,8,e,t)}function DM(e,t){return aw(4,2,e,t)}function IM(e,t){return aw(4,4,e,t)}function $M(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function LM(e,t,r){return r=r!=null?r.concat([e]):null,aw(4,4,$M.bind(null,t,e),r)}function Ak(){}function FM(e,t){var r=Qa();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kk(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function UM(e,t){var r=Qa();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kk(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function BM(e,t,r){return $u&21?(Ro(r,t)||(r=HR(),Zn.lanes|=r,Lu|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ji=!0),e.memoizedState=r)}function HZ(e,t){var r=pn;pn=r!==0&&4>r?r:4,e(!0);var n=Bb.transition;Bb.transition={};try{e(!1),t()}finally{pn=r,Bb.transition=n}}function zM(){return Qa().memoizedState}function GZ(e,t,r){var n=vd(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},VM(e))qM(t,r);else if(r=NM(e,t,r,n),r!==null){var i=Ri();Oo(r,e,n,i),WM(r,t,n)}}function YZ(e,t,r){var n=vd(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(VM(e))qM(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,r);if(i.hasEagerState=!0,i.eagerState=l,Ro(l,o)){var c=t.interleaved;c===null?(i.next=i,wk(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch(d){}finally{}r=NM(e,t,i,n),r!==null&&(i=Ri(),Oo(r,e,n,i),WM(r,t,n))}}function VM(e){var t=e.alternate;return e===Zn||t!==null&&t===Zn}function qM(e,t){C0=u2=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function WM(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ok(e,r)}}var f2={readContext:Ja,useCallback:hi,useContext:hi,useEffect:hi,useImperativeHandle:hi,useInsertionEffect:hi,useLayoutEffect:hi,useMemo:hi,useReducer:hi,useRef:hi,useState:hi,useDebugValue:hi,useDeferredValue:hi,useTransition:hi,useMutableSource:hi,useSyncExternalStore:hi,useId:hi,unstable_isNewReconciler:!1},KZ={readContext:Ja,useCallback:function(e,t){return Ko().memoizedState=[e,t===void 0?null:t],e},useContext:Ja,useEffect:iP,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Ty(4194308,4,$M.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ty(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ty(4,2,e,t)},useMemo:function(e,t){var r=Ko();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ko();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=GZ.bind(null,Zn,e),[n.memoizedState,e]},useRef:function(e){var t=Ko();return e={current:e},t.memoizedState=e},useState:sP,useDebugValue:Ak,useDeferredValue:function(e){return Ko().memoizedState=e},useTransition:function(){var e=sP(!1),t=e[0];return e=HZ.bind(null,e[1]),Ko().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Zn,i=Ko();if(qn){if(r===void 0)throw Error(xt(407));r=r()}else{if(r=t(),Zs===null)throw Error(xt(349));$u&30||PM(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,iP(TM.bind(null,n,a,e),[e]),n.flags|=2048,sg(9,AM.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Ko(),t=Zs.identifierPrefix;if(qn){var r=Xl,n=Zl;r=(n&~(1<<32-To(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=rg++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=WZ++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ZZ={readContext:Ja,useCallback:FM,useContext:Ja,useEffect:Pk,useImperativeHandle:LM,useInsertionEffect:DM,useLayoutEffect:IM,useMemo:UM,useReducer:zb,useRef:MM,useState:function(){return zb(ng)},useDebugValue:Ak,useDeferredValue:function(e){var t=Qa();return BM(t,Ts.memoizedState,e)},useTransition:function(){var e=zb(ng)[0],t=Qa().memoizedState;return[e,t]},useMutableSource:EM,useSyncExternalStore:CM,useId:zM,unstable_isNewReconciler:!1},XZ={readContext:Ja,useCallback:FM,useContext:Ja,useEffect:Pk,useImperativeHandle:LM,useInsertionEffect:DM,useLayoutEffect:IM,useMemo:UM,useReducer:Vb,useRef:MM,useState:function(){return Vb(ng)},useDebugValue:Ak,useDeferredValue:function(e){var t=Qa();return Ts===null?t.memoizedState=e:BM(t,Ts.memoizedState,e)},useTransition:function(){var e=Vb(ng)[0],t=Qa().memoizedState;return[e,t]},useMutableSource:EM,useSyncExternalStore:CM,useId:zM,unstable_isNewReconciler:!1};function ho(e,t){if(e&&e.defaultProps){t=Xn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function JN(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Xn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ow={isMounted:function(e){return(e=e._reactInternals)?af(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ri(),i=vd(e),a=lc(n,i);a.payload=t,r!=null&&(a.callback=r),t=pd(e,a,i),t!==null&&(Oo(t,e,i,n),Py(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ri(),i=vd(e),a=lc(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=pd(e,a,i),t!==null&&(Oo(t,e,i,n),Py(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ri(),n=vd(e),i=lc(r,n);i.tag=2,t!=null&&(i.callback=t),t=pd(e,i,n),t!==null&&(Oo(t,e,n,r),Py(t,e,n))}};function aP(e,t,r,n,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!Z0(r,n)||!Z0(i,a):!0}function HM(e,t,r){var n=!1,i=jd,a=t.contextType;return typeof a=="object"&&a!==null?a=Ja(a):(i=sa(t)?Du:wi.current,n=t.contextTypes,a=(n=n!=null)?Gh(e,i):jd),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ow,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function oP(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ow.enqueueReplaceState(t,t.state,null)}function QN(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},bk(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Ja(a):(a=sa(t)?Du:wi.current,i.context=Gh(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(JN(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&ow.enqueueReplaceState(i,i.state,null),c2(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Xh(e,t){try{var r="",n=t;do r+=SK(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function qb(e,t,r){return{value:e,source:null,stack:r!=null?r:null,digest:t!=null?t:null}}function e3(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var JZ=typeof WeakMap=="function"?WeakMap:Map;function GM(e,t,r){r=lc(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){m2||(m2=!0,d3=n),e3(e,t)},r}function YM(e,t,r){r=lc(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){e3(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){e3(e,t),typeof n!="function"&&(gd===null?gd=new Set([this]):gd.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function lP(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new JZ;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=fX.bind(null,e,t,r),t.then(e,e))}function cP(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function dP(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=lc(-1,1),t.tag=2,pd(r,t,1))),r.lanes|=1),e)}var QZ=kc.ReactCurrentOwner,Ji=!1;function Ci(e,t,r,n){t.child=e===null?jM(t,null,r,n):Kh(t,e.child,r,n)}function uP(e,t,r,n,i){r=r.render;var a=t.ref;return bh(t,i),n=Ek(e,t,r,n,a,i),r=Ck(),e!==null&&!Ji?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,gc(e,t,i)):(qn&&r&&pk(t),t.flags|=1,Ci(e,t,n,i),t.child)}function fP(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!Lk(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,KM(e,t,a,n,i)):(e=Dy(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:Z0,r(o,n)&&e.ref===t.ref)return gc(e,t,i)}return t.flags|=1,e=xd(a,n),e.ref=t.ref,e.return=t,t.child=e}function KM(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(Z0(a,n)&&e.ref===t.ref)if(Ji=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(Ji=!0);else return t.lanes=e.lanes,gc(e,t,i)}return t3(e,t,r,n,i)}function ZM(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},An(ch,xa),xa|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,An(ch,xa),xa|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,An(ch,xa),xa|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,An(ch,xa),xa|=n;return Ci(e,t,i,r),t.child}function XM(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function t3(e,t,r,n,i){var a=sa(r)?Du:wi.current;return a=Gh(t,a),bh(t,i),r=Ek(e,t,r,n,a,i),n=Ck(),e!==null&&!Ji?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,gc(e,t,i)):(qn&&n&&pk(t),t.flags|=1,Ci(e,t,r,i),t.child)}function hP(e,t,r,n,i){if(sa(r)){var a=!0;s2(t)}else a=!1;if(bh(t,i),t.stateNode===null)Oy(e,t),HM(t,r,n),QN(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=Ja(d):(d=sa(r)?Du:wi.current,d=Gh(t,d));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==d)&&oP(t,o,n,d),Yc=!1;var f=t.memoizedState;o.state=f,c2(t,n,o,i),c=t.memoizedState,l!==n||f!==c||na.current||Yc?(typeof u=="function"&&(JN(t,r,u,n),c=t.memoizedState),(l=Yc||aP(t,r,l,n,f,c,d))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,SM(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:ho(t.type,l),o.props=d,h=t.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Ja(c):(c=sa(r)?Du:wi.current,c=Gh(t,c));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&oP(t,o,n,c),Yc=!1,f=t.memoizedState,o.state=f,c2(t,n,o,i);var x=t.memoizedState;l!==h||f!==x||na.current||Yc?(typeof p=="function"&&(JN(t,r,p,n),x=t.memoizedState),(d=Yc||aP(t,r,d,n,f,x,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),o.props=n,o.state=x,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return r3(e,t,r,n,a,i)}function r3(e,t,r,n,i,a){XM(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&J6(t,r,!1),gc(e,t,a);n=t.stateNode,QZ.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Kh(t,e.child,null,a),t.child=Kh(t,null,l,a)):Ci(e,t,l,a),t.memoizedState=n.state,i&&J6(t,r,!0),t.child}function JM(e){var t=e.stateNode;t.pendingContext?X6(e,t.pendingContext,t.pendingContext!==t.context):t.context&&X6(e,t.context,!1),jk(e,t.containerInfo)}function mP(e,t,r,n,i){return Yh(),vk(i),t.flags|=256,Ci(e,t,r,n),t.child}var n3={dehydrated:null,treeContext:null,retryLane:0};function s3(e){return{baseLanes:e,cachePool:null,transitions:null}}function QM(e,t,r){var n=t.pendingProps,i=Yn.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),An(Yn,i&1),e===null)return ZN(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=dw(o,n,0,null),e=Eu(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=s3(r),t.memoizedState=n3,e):Tk(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return eX(e,t,o,n,l,i,r);if(a){a=n.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=xd(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=xd(l,a):(a=Eu(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?s3(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=n3,n}return a=e.child,e=a.sibling,n=xd(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Tk(e,t){return t=dw({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Rx(e,t,r,n){return n!==null&&vk(n),Kh(t,e.child,null,r),e=Tk(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function eX(e,t,r,n,i,a,o){if(r)return t.flags&256?(t.flags&=-257,n=qb(Error(xt(422))),Rx(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=dw({mode:"visible",children:n.children},i,0,null),a=Eu(a,i,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Kh(t,e.child,null,o),t.child.memoizedState=s3(o),t.memoizedState=n3,a);if(!(t.mode&1))return Rx(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(xt(419)),n=qb(a,n,void 0),Rx(e,t,o,n)}if(l=(o&e.childLanes)!==0,Ji||l){if(n=Zs,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,pc(e,i),Oo(n,e,i,-1))}return $k(),n=qb(Error(xt(421))),Rx(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=hX.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,ba=md(i.nextSibling),Na=t,qn=!0,wo=null,e!==null&&(La[Fa++]=Zl,La[Fa++]=Xl,La[Fa++]=Iu,Zl=e.id,Xl=e.overflow,Iu=t),t=Tk(t,n.children),t.flags|=4096,t)}function pP(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),XN(e.return,t,r)}function Wb(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function eD(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(Ci(e,t,n.children,r),n=Yn.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&pP(e,r,t);else if(e.tag===19)pP(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(An(Yn,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&d2(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Wb(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&d2(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Wb(t,!0,r,null,a);break;case"together":Wb(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Oy(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function gc(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Lu|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(xt(153));if(t.child!==null){for(e=t.child,r=xd(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=xd(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function tX(e,t,r){switch(t.tag){case 3:JM(t),Yh();break;case 5:kM(t);break;case 1:sa(t.type)&&s2(t);break;case 4:jk(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;An(o2,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(An(Yn,Yn.current&1),t.flags|=128,null):r&t.child.childLanes?QM(e,t,r):(An(Yn,Yn.current&1),e=gc(e,t,r),e!==null?e.sibling:null);An(Yn,Yn.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return eD(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),An(Yn,Yn.current),n)break;return null;case 22:case 23:return t.lanes=0,ZM(e,t,r)}return gc(e,t,r)}var tD,i3,rD,nD;tD=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};i3=function(){};rD=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,cu(vl.current);var a=null;switch(r){case"input":i=EN(e,i),n=EN(e,n),a=[];break;case"select":i=Xn({},i,{value:void 0}),n=Xn({},n,{value:void 0}),a=[];break;case"textarea":i=AN(e,i),n=AN(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=r2)}ON(r,n);var o;r=null;for(d in i)if(!n.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(V0.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in n){var c=n[d];if(l=i!=null?i[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(V0.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&$n("scroll",e),a||l===c||(a=[])):(a=a||[]).push(d,c))}r&&(a=a||[]).push("style",r);var d=a;(t.updateQueue=d)&&(t.flags|=4)}};nD=function(e,t,r,n){r!==n&&(t.flags|=4)};function Lp(e,t){if(!qn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function mi(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function rX(e,t,r){var n=t.pendingProps;switch(gk(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mi(t),null;case 1:return sa(t.type)&&n2(),mi(t),null;case 3:return n=t.stateNode,Zh(),Un(na),Un(wi),Sk(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Tx(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,wo!==null&&(h3(wo),wo=null))),i3(e,t),mi(t),null;case 5:Nk(t);var i=cu(tg.current);if(r=t.type,e!==null&&t.stateNode!=null)rD(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(xt(166));return mi(t),null}if(e=cu(vl.current),Tx(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[sl]=t,n[Q0]=a,e=(t.mode&1)!==0,r){case"dialog":$n("cancel",n),$n("close",n);break;case"iframe":case"object":case"embed":$n("load",n);break;case"video":case"audio":for(i=0;i<p0.length;i++)$n(p0[i],n);break;case"source":$n("error",n);break;case"img":case"image":case"link":$n("error",n),$n("load",n);break;case"details":$n("toggle",n);break;case"input":N6(n,a),$n("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},$n("invalid",n);break;case"textarea":k6(n,a),$n("invalid",n)}ON(r,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&Ax(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Ax(n.textContent,l,e),i=["children",""+l]):V0.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&$n("scroll",n)}switch(r){case"input":bx(n),S6(n,a,!0);break;case"textarea":bx(n),E6(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=r2)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=TR(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[sl]=t,e[Q0]=n,tD(e,t,!1,!1),t.stateNode=e;e:{switch(o=RN(r,n),r){case"dialog":$n("cancel",e),$n("close",e),i=n;break;case"iframe":case"object":case"embed":$n("load",e),i=n;break;case"video":case"audio":for(i=0;i<p0.length;i++)$n(p0[i],e);i=n;break;case"source":$n("error",e),i=n;break;case"img":case"image":case"link":$n("error",e),$n("load",e),i=n;break;case"details":$n("toggle",e),i=n;break;case"input":N6(e,n),i=EN(e,n),$n("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Xn({},n,{value:void 0}),$n("invalid",e);break;case"textarea":k6(e,n),i=AN(e,n),$n("invalid",e);break;default:i=n}ON(r,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?MR(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&OR(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&q0(e,c):typeof c=="number"&&q0(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(V0.hasOwnProperty(a)?c!=null&&a==="onScroll"&&$n("scroll",e):c!=null&&tk(e,a,c,o))}switch(r){case"input":bx(e),S6(e,n,!1);break;case"textarea":bx(e),E6(e);break;case"option":n.value!=null&&e.setAttribute("value",""+bd(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?xh(e,!!n.multiple,a,!1):n.defaultValue!=null&&xh(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=r2)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return mi(t),null;case 6:if(e&&t.stateNode!=null)nD(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(xt(166));if(r=cu(tg.current),cu(vl.current),Tx(t)){if(n=t.stateNode,r=t.memoizedProps,n[sl]=t,(a=n.nodeValue!==r)&&(e=Na,e!==null))switch(e.tag){case 3:Ax(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ax(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[sl]=t,t.stateNode=n}return mi(t),null;case 13:if(Un(Yn),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(qn&&ba!==null&&t.mode&1&&!(t.flags&128))wM(),Yh(),t.flags|=98560,a=!1;else if(a=Tx(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(xt(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(xt(317));a[sl]=t}else Yh(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;mi(t),a=!1}else wo!==null&&(h3(wo),wo=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Yn.current&1?Rs===0&&(Rs=3):$k())),t.updateQueue!==null&&(t.flags|=4),mi(t),null);case 4:return Zh(),i3(e,t),e===null&&X0(t.stateNode.containerInfo),mi(t),null;case 10:return _k(t.type._context),mi(t),null;case 17:return sa(t.type)&&n2(),mi(t),null;case 19:if(Un(Yn),a=t.memoizedState,a===null)return mi(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)Lp(a,!1);else{if(Rs!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=d2(e),o!==null){for(t.flags|=128,Lp(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return An(Yn,Yn.current&1|2),t.child}e=e.sibling}a.tail!==null&&ds()>Jh&&(t.flags|=128,n=!0,Lp(a,!1),t.lanes=4194304)}else{if(!n)if(e=d2(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Lp(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!qn)return mi(t),null}else 2*ds()-a.renderingStartTime>Jh&&r!==1073741824&&(t.flags|=128,n=!0,Lp(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=ds(),t.sibling=null,r=Yn.current,An(Yn,n?r&1|2:r&1),t):(mi(t),null);case 22:case 23:return Ik(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?xa&1073741824&&(mi(t),t.subtreeFlags&6&&(t.flags|=8192)):mi(t),null;case 24:return null;case 25:return null}throw Error(xt(156,t.tag))}function nX(e,t){switch(gk(t),t.tag){case 1:return sa(t.type)&&n2(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Zh(),Un(na),Un(wi),Sk(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Nk(t),null;case 13:if(Un(Yn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(xt(340));Yh()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Un(Yn),null;case 4:return Zh(),null;case 10:return _k(t.type._context),null;case 22:case 23:return Ik(),null;case 24:return null;default:return null}}var Mx=!1,xi=!1,sX=typeof WeakSet=="function"?WeakSet:Set,zt=null;function lh(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ts(e,t,n)}else r.current=null}function a3(e,t,r){try{r()}catch(n){ts(e,t,n)}}var gP=!1;function iX(e,t){if(VN=Qy,e=lM(),mk(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch(N){r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,f=null;t:for(;;){for(var p;h!==r||i!==0&&h.nodeType!==3||(l=o+i),h!==a||n!==0&&h.nodeType!==3||(c=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===e)break t;if(f===r&&++d===i&&(l=o),f===a&&++u===n&&(c=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(qN={focusedElem:e,selectionRange:r},Qy=!1,zt=t;zt!==null;)if(t=zt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,zt=e;else for(;zt!==null;){t=zt;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,v=x.memoizedState,_=t.stateNode,w=_.getSnapshotBeforeUpdate(t.elementType===t.type?g:ho(t.type,g),v);_.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xt(163))}}catch(N){ts(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,zt=e;break}zt=t.return}return x=gP,gP=!1,x}function P0(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&a3(t,r,a)}i=i.next}while(i!==n)}}function lw(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function o3(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function sD(e){var t=e.alternate;t!==null&&(e.alternate=null,sD(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[sl],delete t[Q0],delete t[GN],delete t[BZ],delete t[zZ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function iD(e){return e.tag===5||e.tag===3||e.tag===4}function vP(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||iD(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function l3(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=r2));else if(n!==4&&(e=e.child,e!==null))for(l3(e,t,r),e=e.sibling;e!==null;)l3(e,t,r),e=e.sibling}function c3(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(c3(e,t,r),e=e.sibling;e!==null;)c3(e,t,r),e=e.sibling}var ri=null,vo=!1;function Lc(e,t,r){for(r=r.child;r!==null;)aD(e,t,r),r=r.sibling}function aD(e,t,r){if(gl&&typeof gl.onCommitFiberUnmount=="function")try{gl.onCommitFiberUnmount(ew,r)}catch(l){}switch(r.tag){case 5:xi||lh(r,t);case 6:var n=ri,i=vo;ri=null,Lc(e,t,r),ri=n,vo=i,ri!==null&&(vo?(e=ri,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ri.removeChild(r.stateNode));break;case 18:ri!==null&&(vo?(e=ri,r=r.stateNode,e.nodeType===8?Lb(e.parentNode,r):e.nodeType===1&&Lb(e,r),Y0(e)):Lb(ri,r.stateNode));break;case 4:n=ri,i=vo,ri=r.stateNode.containerInfo,vo=!0,Lc(e,t,r),ri=n,vo=i;break;case 0:case 11:case 14:case 15:if(!xi&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&a3(r,t,o),i=i.next}while(i!==n)}Lc(e,t,r);break;case 1:if(!xi&&(lh(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){ts(r,t,l)}Lc(e,t,r);break;case 21:Lc(e,t,r);break;case 22:r.mode&1?(xi=(n=xi)||r.memoizedState!==null,Lc(e,t,r),xi=n):Lc(e,t,r);break;default:Lc(e,t,r)}}function xP(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new sX),t.forEach(function(n){var i=mX.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ao(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:ri=l.stateNode,vo=!1;break e;case 3:ri=l.stateNode.containerInfo,vo=!0;break e;case 4:ri=l.stateNode.containerInfo,vo=!0;break e}l=l.return}if(ri===null)throw Error(xt(160));aD(a,o,i),ri=null,vo=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){ts(i,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)oD(t,e),t=t.sibling}function oD(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ao(t,e),Yo(e),n&4){try{P0(3,e,e.return),lw(3,e)}catch(g){ts(e,e.return,g)}try{P0(5,e,e.return)}catch(g){ts(e,e.return,g)}}break;case 1:ao(t,e),Yo(e),n&512&&r!==null&&lh(r,r.return);break;case 5:if(ao(t,e),Yo(e),n&512&&r!==null&&lh(r,r.return),e.flags&32){var i=e.stateNode;try{q0(i,"")}catch(g){ts(e,e.return,g)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&PR(i,a),RN(l,o);var d=RN(l,a);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];u==="style"?MR(i,h):u==="dangerouslySetInnerHTML"?OR(i,h):u==="children"?q0(i,h):tk(i,u,h,d)}switch(l){case"input":CN(i,a);break;case"textarea":AR(i,a);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?xh(i,!!a.multiple,p,!1):f!==!!a.multiple&&(a.defaultValue!=null?xh(i,!!a.multiple,a.defaultValue,!0):xh(i,!!a.multiple,a.multiple?[]:"",!1))}i[Q0]=a}catch(g){ts(e,e.return,g)}}break;case 6:if(ao(t,e),Yo(e),n&4){if(e.stateNode===null)throw Error(xt(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){ts(e,e.return,g)}}break;case 3:if(ao(t,e),Yo(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Y0(t.containerInfo)}catch(g){ts(e,e.return,g)}break;case 4:ao(t,e),Yo(e);break;case 13:ao(t,e),Yo(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Mk=ds())),n&4&&xP(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(xi=(d=xi)||u,ao(t,e),xi=d):ao(t,e),Yo(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(zt=e,u=e.child;u!==null;){for(h=zt=u;zt!==null;){switch(f=zt,p=f.child,f.tag){case 0:case 11:case 14:case 15:P0(4,f,f.return);break;case 1:lh(f,f.return);var x=f.stateNode;if(typeof x.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(g){ts(n,r,g)}}break;case 5:lh(f,f.return);break;case 22:if(f.memoizedState!==null){_P(h);continue}}p!==null?(p.return=f,zt=p):_P(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{i=h.stateNode,d?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=RR("display",o))}catch(g){ts(e,e.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){ts(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ao(t,e),Yo(e),n&4&&xP(e);break;case 21:break;default:ao(t,e),Yo(e)}}function Yo(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(iD(r)){var n=r;break e}r=r.return}throw Error(xt(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(q0(i,""),n.flags&=-33);var a=vP(e);c3(e,a,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=vP(e);l3(e,l,o);break;default:throw Error(xt(161))}}catch(c){ts(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function aX(e,t,r){zt=e,lD(e)}function lD(e,t,r){for(var n=(e.mode&1)!==0;zt!==null;){var i=zt,a=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Mx;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||xi;l=Mx;var d=xi;if(Mx=o,(xi=c)&&!d)for(zt=i;zt!==null;)o=zt,c=o.child,o.tag===22&&o.memoizedState!==null?wP(i):c!==null?(c.return=o,zt=c):wP(i);for(;a!==null;)zt=a,lD(a),a=a.sibling;zt=i,Mx=l,xi=d}yP(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,zt=a):yP(e)}}function yP(e){for(;zt!==null;){var t=zt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:xi||lw(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!xi)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ho(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&nP(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}nP(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Y0(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xt(163))}xi||t.flags&512&&o3(t)}catch(f){ts(t,t.return,f)}}if(t===e){zt=null;break}if(r=t.sibling,r!==null){r.return=t.return,zt=r;break}zt=t.return}}function _P(e){for(;zt!==null;){var t=zt;if(t===e){zt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,zt=r;break}zt=t.return}}function wP(e){for(;zt!==null;){var t=zt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{lw(4,t)}catch(c){ts(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){ts(t,i,c)}}var a=t.return;try{o3(t)}catch(c){ts(t,a,c)}break;case 5:var o=t.return;try{o3(t)}catch(c){ts(t,o,c)}}}catch(c){ts(t,t.return,c)}if(t===e){zt=null;break}var l=t.sibling;if(l!==null){l.return=t.return,zt=l;break}zt=t.return}}var oX=Math.ceil,h2=kc.ReactCurrentDispatcher,Ok=kc.ReactCurrentOwner,Ga=kc.ReactCurrentBatchConfig,en=0,Zs=null,ys=null,ii=0,xa=0,ch=Td(0),Rs=0,ig=null,Lu=0,cw=0,Rk=0,A0=null,Yi=null,Mk=0,Jh=1/0,Hl=null,m2=!1,d3=null,gd=null,Dx=!1,od=null,p2=0,T0=0,u3=null,Ry=-1,My=0;function Ri(){return en&6?ds():Ry!==-1?Ry:Ry=ds()}function vd(e){return e.mode&1?en&2&&ii!==0?ii&-ii:qZ.transition!==null?(My===0&&(My=HR()),My):(e=pn,e!==0||(e=window.event,e=e===void 0?16:QR(e.type)),e):1}function Oo(e,t,r,n){if(50<T0)throw T0=0,u3=null,Error(xt(185));mv(e,r,n),(!(en&2)||e!==Zs)&&(e===Zs&&(!(en&2)&&(cw|=r),Rs===4&&Xc(e,ii)),ia(e,n),r===1&&en===0&&!(t.mode&1)&&(Jh=ds()+500,iw&&Od()))}function ia(e,t){var r=e.callbackNode;qK(e,t);var n=Jy(e,e===Zs?ii:0);if(n===0)r!==null&&A6(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&A6(r),t===1)e.tag===0?VZ(bP.bind(null,e)):xM(bP.bind(null,e)),FZ(function(){!(en&6)&&Od()}),r=null;else{switch(GR(n)){case 1:r=ak;break;case 4:r=qR;break;case 16:r=Xy;break;case 536870912:r=WR;break;default:r=Xy}r=gD(r,cD.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function cD(e,t){if(Ry=-1,My=0,en&6)throw Error(xt(327));var r=e.callbackNode;if(jh()&&e.callbackNode!==r)return null;var n=Jy(e,e===Zs?ii:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=g2(e,n);else{t=n;var i=en;en|=2;var a=uD();(Zs!==e||ii!==t)&&(Hl=null,Jh=ds()+500,ku(e,t));do try{dX();break}catch(l){dD(e,l)}while(!0);yk(),h2.current=a,en=i,ys!==null?t=0:(Zs=null,ii=0,t=Rs)}if(t!==0){if(t===2&&(i=LN(e),i!==0&&(n=i,t=f3(e,i))),t===1)throw r=ig,ku(e,0),Xc(e,n),ia(e,ds()),r;if(t===6)Xc(e,n);else{if(i=e.current.alternate,!(n&30)&&!lX(i)&&(t=g2(e,n),t===2&&(a=LN(e),a!==0&&(n=a,t=f3(e,a))),t===1))throw r=ig,ku(e,0),Xc(e,n),ia(e,ds()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(xt(345));case 2:Jd(e,Yi,Hl);break;case 3:if(Xc(e,n),(n&130023424)===n&&(t=Mk+500-ds(),10<t)){if(Jy(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Ri(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=HN(Jd.bind(null,e,Yi,Hl),t);break}Jd(e,Yi,Hl);break;case 4:if(Xc(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-To(n);a=1<<o,o=t[o],o>i&&(i=o),n&=~a}if(n=i,n=ds()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*oX(n/1960))-n,10<n){e.timeoutHandle=HN(Jd.bind(null,e,Yi,Hl),n);break}Jd(e,Yi,Hl);break;case 5:Jd(e,Yi,Hl);break;default:throw Error(xt(329))}}}return ia(e,ds()),e.callbackNode===r?cD.bind(null,e):null}function f3(e,t){var r=A0;return e.current.memoizedState.isDehydrated&&(ku(e,t).flags|=256),e=g2(e,t),e!==2&&(t=Yi,Yi=r,t!==null&&h3(t)),e}function h3(e){Yi===null?Yi=e:Yi.push.apply(Yi,e)}function lX(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Ro(a(),i))return!1}catch(o){return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xc(e,t){for(t&=~Rk,t&=~cw,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-To(t),n=1<<r;e[r]=-1,t&=~n}}function bP(e){if(en&6)throw Error(xt(327));jh();var t=Jy(e,0);if(!(t&1))return ia(e,ds()),null;var r=g2(e,t);if(e.tag!==0&&r===2){var n=LN(e);n!==0&&(t=n,r=f3(e,n))}if(r===1)throw r=ig,ku(e,0),Xc(e,t),ia(e,ds()),r;if(r===6)throw Error(xt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Jd(e,Yi,Hl),ia(e,ds()),null}function Dk(e,t){var r=en;en|=1;try{return e(t)}finally{en=r,en===0&&(Jh=ds()+500,iw&&Od())}}function Fu(e){od!==null&&od.tag===0&&!(en&6)&&jh();var t=en;en|=1;var r=Ga.transition,n=pn;try{if(Ga.transition=null,pn=1,e)return e()}finally{pn=n,Ga.transition=r,en=t,!(en&6)&&Od()}}function Ik(){xa=ch.current,Un(ch)}function ku(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,LZ(r)),ys!==null)for(r=ys.return;r!==null;){var n=r;switch(gk(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&n2();break;case 3:Zh(),Un(na),Un(wi),Sk();break;case 5:Nk(n);break;case 4:Zh();break;case 13:Un(Yn);break;case 19:Un(Yn);break;case 10:_k(n.type._context);break;case 22:case 23:Ik()}r=r.return}if(Zs=e,ys=e=xd(e.current,null),ii=xa=t,Rs=0,ig=null,Rk=cw=Lu=0,Yi=A0=null,lu!==null){for(t=0;t<lu.length;t++)if(r=lu[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=i,n.next=o}r.pending=n}lu=null}return e}function dD(e,t){do{var r=ys;try{if(yk(),Ay.current=f2,u2){for(var n=Zn.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}u2=!1}if($u=0,Vs=Ts=Zn=null,C0=!1,rg=0,Ok.current=null,r===null||r.return===null){Rs=1,ig=t,ys=null;break}e:{var a=e,o=r.return,l=r,c=t;if(t=ii,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=cP(o);if(p!==null){p.flags&=-257,dP(p,o,l,a,t),p.mode&1&&lP(a,d,t),t=p,c=d;var x=t.updateQueue;if(x===null){var g=new Set;g.add(c),t.updateQueue=g}else x.add(c);break e}else{if(!(t&1)){lP(a,d,t),$k();break e}c=Error(xt(426))}}else if(qn&&l.mode&1){var v=cP(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),dP(v,o,l,a,t),vk(Xh(c,l));break e}}a=c=Xh(c,l),Rs!==4&&(Rs=2),A0===null?A0=[a]:A0.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var _=GM(a,c,t);rP(a,_);break e;case 1:l=c;var w=a.type,b=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(gd===null||!gd.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t;var N=YM(a,l,t);rP(a,N);break e}}a=a.return}while(a!==null)}hD(r)}catch(S){t=S,ys===r&&r!==null&&(ys=r=r.return);continue}break}while(!0)}function uD(){var e=h2.current;return h2.current=f2,e===null?f2:e}function $k(){(Rs===0||Rs===3||Rs===2)&&(Rs=4),Zs===null||!(Lu&268435455)&&!(cw&268435455)||Xc(Zs,ii)}function g2(e,t){var r=en;en|=2;var n=uD();(Zs!==e||ii!==t)&&(Hl=null,ku(e,t));do try{cX();break}catch(i){dD(e,i)}while(!0);if(yk(),en=r,h2.current=n,ys!==null)throw Error(xt(261));return Zs=null,ii=0,Rs}function cX(){for(;ys!==null;)fD(ys)}function dX(){for(;ys!==null&&!DK();)fD(ys)}function fD(e){var t=pD(e.alternate,e,xa);e.memoizedProps=e.pendingProps,t===null?hD(e):ys=t,Ok.current=null}function hD(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=nX(r,t),r!==null){r.flags&=32767,ys=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Rs=6,ys=null;return}}else if(r=rX(r,t,xa),r!==null){ys=r;return}if(t=t.sibling,t!==null){ys=t;return}ys=t=e}while(t!==null);Rs===0&&(Rs=5)}function Jd(e,t,r){var n=pn,i=Ga.transition;try{Ga.transition=null,pn=1,uX(e,t,r,n)}finally{Ga.transition=i,pn=n}return null}function uX(e,t,r,n){do jh();while(od!==null);if(en&6)throw Error(xt(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(xt(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(WK(e,a),e===Zs&&(ys=Zs=null,ii=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Dx||(Dx=!0,gD(Xy,function(){return jh(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Ga.transition,Ga.transition=null;var o=pn;pn=1;var l=en;en|=4,Ok.current=null,iX(e,r),oD(r,e),TZ(qN),Qy=!!VN,qN=VN=null,e.current=r,aX(r),IK(),en=l,pn=o,Ga.transition=a}else e.current=r;if(Dx&&(Dx=!1,od=e,p2=i),a=e.pendingLanes,a===0&&(gd=null),FK(r.stateNode),ia(e,ds()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(m2)throw m2=!1,e=d3,d3=null,e;return p2&1&&e.tag!==0&&jh(),a=e.pendingLanes,a&1?e===u3?T0++:(T0=0,u3=e):T0=0,Od(),null}function jh(){if(od!==null){var e=GR(p2),t=Ga.transition,r=pn;try{if(Ga.transition=null,pn=16>e?16:e,od===null)var n=!1;else{if(e=od,od=null,p2=0,en&6)throw Error(xt(331));var i=en;for(en|=4,zt=e.current;zt!==null;){var a=zt,o=a.child;if(zt.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(zt=d;zt!==null;){var u=zt;switch(u.tag){case 0:case 11:case 15:P0(8,u,a)}var h=u.child;if(h!==null)h.return=u,zt=h;else for(;zt!==null;){u=zt;var f=u.sibling,p=u.return;if(sD(u),u===d){zt=null;break}if(f!==null){f.return=p,zt=f;break}zt=p}}}var x=a.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}zt=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,zt=o;else e:for(;zt!==null;){if(a=zt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:P0(9,a,a.return)}var _=a.sibling;if(_!==null){_.return=a.return,zt=_;break e}zt=a.return}}var w=e.current;for(zt=w;zt!==null;){o=zt;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,zt=b;else e:for(o=w;zt!==null;){if(l=zt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:lw(9,l)}}catch(S){ts(l,l.return,S)}if(l===o){zt=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,zt=N;break e}zt=l.return}}if(en=i,Od(),gl&&typeof gl.onPostCommitFiberRoot=="function")try{gl.onPostCommitFiberRoot(ew,e)}catch(S){}n=!0}return n}finally{pn=r,Ga.transition=t}}return!1}function jP(e,t,r){t=Xh(r,t),t=GM(e,t,1),e=pd(e,t,1),t=Ri(),e!==null&&(mv(e,1,t),ia(e,t))}function ts(e,t,r){if(e.tag===3)jP(e,e,r);else for(;t!==null;){if(t.tag===3){jP(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(gd===null||!gd.has(n))){e=Xh(r,e),e=YM(t,e,1),t=pd(t,e,1),e=Ri(),t!==null&&(mv(t,1,e),ia(t,e));break}}t=t.return}}function fX(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ri(),e.pingedLanes|=e.suspendedLanes&r,Zs===e&&(ii&r)===r&&(Rs===4||Rs===3&&(ii&130023424)===ii&&500>ds()-Mk?ku(e,0):Rk|=r),ia(e,t)}function mD(e,t){t===0&&(e.mode&1?(t=Sx,Sx<<=1,!(Sx&130023424)&&(Sx=4194304)):t=1);var r=Ri();e=pc(e,t),e!==null&&(mv(e,t,r),ia(e,r))}function hX(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),mD(e,r)}function mX(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(xt(314))}n!==null&&n.delete(t),mD(e,r)}var pD;pD=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||na.current)Ji=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ji=!1,tX(e,t,r);Ji=!!(e.flags&131072)}else Ji=!1,qn&&t.flags&1048576&&yM(t,a2,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Oy(e,t),e=t.pendingProps;var i=Gh(t,wi.current);bh(t,r),i=Ek(null,t,n,e,i,r);var a=Ck();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,sa(n)?(a=!0,s2(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,bk(t),i.updater=ow,t.stateNode=i,i._reactInternals=t,QN(t,n,e,r),t=r3(null,t,n,!0,a,r)):(t.tag=0,qn&&a&&pk(t),Ci(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Oy(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=gX(n),e=ho(n,e),i){case 0:t=t3(null,t,n,e,r);break e;case 1:t=hP(null,t,n,e,r);break e;case 11:t=uP(null,t,n,e,r);break e;case 14:t=fP(null,t,n,ho(n.type,e),r);break e}throw Error(xt(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ho(n,i),t3(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ho(n,i),hP(e,t,n,i,r);case 3:e:{if(JM(t),e===null)throw Error(xt(387));n=t.pendingProps,a=t.memoizedState,i=a.element,SM(e,t),c2(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Xh(Error(xt(423)),t),t=mP(e,t,n,r,i);break e}else if(n!==i){i=Xh(Error(xt(424)),t),t=mP(e,t,n,r,i);break e}else for(ba=md(t.stateNode.containerInfo.firstChild),Na=t,qn=!0,wo=null,r=jM(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Yh(),n===i){t=gc(e,t,r);break e}Ci(e,t,n,r)}t=t.child}return t;case 5:return kM(t),e===null&&ZN(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,WN(n,i)?o=null:a!==null&&WN(n,a)&&(t.flags|=32),XM(e,t),Ci(e,t,o,r),t.child;case 6:return e===null&&ZN(t),null;case 13:return QM(e,t,r);case 4:return jk(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Kh(t,null,n,r):Ci(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ho(n,i),uP(e,t,n,i,r);case 7:return Ci(e,t,t.pendingProps,r),t.child;case 8:return Ci(e,t,t.pendingProps.children,r),t.child;case 12:return Ci(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,An(o2,n._currentValue),n._currentValue=o,a!==null)if(Ro(a.value,o)){if(a.children===i.children&&!na.current){t=gc(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=lc(-1,r&-r),c.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),XN(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(xt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),XN(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Ci(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,bh(t,r),i=Ja(i),n=n(i),t.flags|=1,Ci(e,t,n,r),t.child;case 14:return n=t.type,i=ho(n,t.pendingProps),i=ho(n.type,i),fP(e,t,n,i,r);case 15:return KM(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ho(n,i),Oy(e,t),t.tag=1,sa(n)?(e=!0,s2(t)):e=!1,bh(t,r),HM(t,n,i),QN(t,n,i,r),r3(null,t,n,!0,e,r);case 19:return eD(e,t,r);case 22:return ZM(e,t,r)}throw Error(xt(156,t.tag))};function gD(e,t){return VR(e,t)}function pX(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function za(e,t,r,n){return new pX(e,t,r,n)}function Lk(e){return e=e.prototype,!(!e||!e.isReactComponent)}function gX(e){if(typeof e=="function")return Lk(e)?1:0;if(e!=null){if(e=e.$$typeof,e===nk)return 11;if(e===sk)return 14}return 2}function xd(e,t){var r=e.alternate;return r===null?(r=za(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Dy(e,t,r,n,i,a){var o=2;if(n=e,typeof e=="function")Lk(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Qf:return Eu(r.children,i,a,t);case rk:o=8,i|=8;break;case jN:return e=za(12,r,t,i|2),e.elementType=jN,e.lanes=a,e;case NN:return e=za(13,r,t,i),e.elementType=NN,e.lanes=a,e;case SN:return e=za(19,r,t,i),e.elementType=SN,e.lanes=a,e;case kR:return dw(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case NR:o=10;break e;case SR:o=9;break e;case nk:o=11;break e;case sk:o=14;break e;case Gc:o=16,n=null;break e}throw Error(xt(130,e==null?e:typeof e,""))}return t=za(o,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function Eu(e,t,r,n){return e=za(7,e,n,t),e.lanes=r,e}function dw(e,t,r,n){return e=za(22,e,n,t),e.elementType=kR,e.lanes=r,e.stateNode={isHidden:!1},e}function Hb(e,t,r){return e=za(6,e,null,t),e.lanes=r,e}function Gb(e,t,r){return t=za(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function vX(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Eb(0),this.expirationTimes=Eb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Eb(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Fk(e,t,r,n,i,a,o,l,c){return e=new vX(e,t,r,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=za(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},bk(a),e}function xX(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Jf,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function vD(e){if(!e)return jd;e=e._reactInternals;e:{if(af(e)!==e||e.tag!==1)throw Error(xt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(sa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(xt(171))}if(e.tag===1){var r=e.type;if(sa(r))return vM(e,r,t)}return t}function xD(e,t,r,n,i,a,o,l,c){return e=Fk(r,n,!0,e,i,a,o,l,c),e.context=vD(null),r=e.current,n=Ri(),i=vd(r),a=lc(n,i),a.callback=t!=null?t:null,pd(r,a,i),e.current.lanes=i,mv(e,i,n),ia(e,n),e}function uw(e,t,r,n){var i=t.current,a=Ri(),o=vd(i);return r=vD(r),t.context===null?t.context=r:t.pendingContext=r,t=lc(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=pd(i,t,o),e!==null&&(Oo(e,i,o,a),Py(e,i,o)),o}function v2(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function NP(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Uk(e,t){NP(e,t),(e=e.alternate)&&NP(e,t)}function yX(){return null}var yD=typeof reportError=="function"?reportError:function(e){console.error(e)};function Bk(e){this._internalRoot=e}fw.prototype.render=Bk.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(xt(409));uw(e,t,null,null)};fw.prototype.unmount=Bk.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Fu(function(){uw(null,e,null,null)}),t[mc]=null}};function fw(e){this._internalRoot=e}fw.prototype.unstable_scheduleHydration=function(e){if(e){var t=ZR();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Zc.length&&t!==0&&t<Zc[r].priority;r++);Zc.splice(r,0,e),r===0&&JR(e)}};function zk(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function hw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function SP(){}function _X(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var d=v2(o);a.call(d)}}var o=xD(t,n,e,0,null,!1,!1,"",SP);return e._reactRootContainer=o,e[mc]=o.current,X0(e.nodeType===8?e.parentNode:e),Fu(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var d=v2(c);l.call(d)}}var c=Fk(e,0,!1,null,null,!1,!1,"",SP);return e._reactRootContainer=c,e[mc]=c.current,X0(e.nodeType===8?e.parentNode:e),Fu(function(){uw(t,c,r,n)}),c}function mw(e,t,r,n,i){var a=r._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var c=v2(o);l.call(c)}}uw(t,o,e,i)}else o=_X(r,t,e,i,n);return v2(o)}YR=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=m0(t.pendingLanes);r!==0&&(ok(t,r|1),ia(t,ds()),!(en&6)&&(Jh=ds()+500,Od()))}break;case 13:Fu(function(){var n=pc(e,1);if(n!==null){var i=Ri();Oo(n,e,1,i)}}),Uk(e,1)}};lk=function(e){if(e.tag===13){var t=pc(e,134217728);if(t!==null){var r=Ri();Oo(t,e,134217728,r)}Uk(e,134217728)}};KR=function(e){if(e.tag===13){var t=vd(e),r=pc(e,t);if(r!==null){var n=Ri();Oo(r,e,t,n)}Uk(e,t)}};ZR=function(){return pn};XR=function(e,t){var r=pn;try{return pn=e,t()}finally{pn=r}};DN=function(e,t,r){switch(t){case"input":if(CN(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=sw(n);if(!i)throw Error(xt(90));CR(n),CN(n,i)}}}break;case"textarea":AR(e,r);break;case"select":t=r.value,t!=null&&xh(e,!!r.multiple,t,!1)}};$R=Dk;LR=Fu;var wX={usingClientEntryPoint:!1,Events:[gv,nh,sw,DR,IR,Dk]},Fp={findFiberByHostInstance:ou,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bX={bundleType:Fp.bundleType,version:Fp.version,rendererPackageName:Fp.rendererPackageName,rendererConfig:Fp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:kc.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=BR(e),e===null?null:e.stateNode},findFiberByHostInstance:Fp.findFiberByHostInstance||yX,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"){var Ix=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ix.isDisabled&&Ix.supportsFiber)try{ew=Ix.inject(bX),gl=Ix}catch(e){}}Pa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wX;Pa.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zk(t))throw Error(xt(200));return xX(e,t,null,r)};Pa.createRoot=function(e,t){if(!zk(e))throw Error(xt(299));var r=!1,n="",i=yD;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Fk(e,1,!1,null,null,r,!1,n,i),e[mc]=t.current,X0(e.nodeType===8?e.parentNode:e),new Bk(t)};Pa.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(xt(188)):(e=Object.keys(e).join(","),Error(xt(268,e)));return e=BR(t),e=e===null?null:e.stateNode,e};Pa.flushSync=function(e){return Fu(e)};Pa.hydrate=function(e,t,r){if(!hw(t))throw Error(xt(200));return mw(null,e,t,!0,r)};Pa.hydrateRoot=function(e,t,r){if(!zk(e))throw Error(xt(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",o=yD;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=xD(t,null,e,1,r!=null?r:null,i,!1,a,o),e[mc]=t.current,X0(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new fw(t)};Pa.render=function(e,t,r){if(!hw(t))throw Error(xt(200));return mw(null,e,t,!1,r)};Pa.unmountComponentAtNode=function(e){if(!hw(e))throw Error(xt(40));return e._reactRootContainer?(Fu(function(){mw(null,null,e,!1,function(){e._reactRootContainer=null,e[mc]=null})}),!0):!1};Pa.unstable_batchedUpdates=Dk;Pa.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!hw(r))throw Error(xt(200));if(e==null||e._reactInternals===void 0)throw Error(xt(38));return mw(e,t,r,!1,n)};Pa.version="18.3.1-next-f1338f8080-20240426";function _D(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_D)}catch(e){console.error(e)}}_D(),_R.exports=Pa;var Ya=_R.exports;const Nh=rn(Ya);var wD,kP=Ya;wD=kP.createRoot,kP.hydrateRoot;const jX=1,NX=1e6;let Yb=0;function SX(){return Yb=(Yb+1)%Number.MAX_SAFE_INTEGER,Yb.toString()}const Kb=new Map,EP=e=>{if(Kb.has(e))return;const t=setTimeout(()=>{Kb.delete(e),O0({type:"REMOVE_TOAST",toastId:e})},NX);Kb.set(e,t)},kX=(e,t)=>{switch(t.type){case"ADD_TOAST":return W(M({},e),{toasts:[t.toast,...e.toasts].slice(0,jX)});case"UPDATE_TOAST":return W(M({},e),{toasts:e.toasts.map(r=>r.id===t.toast.id?M(M({},r),t.toast):r)});case"DISMISS_TOAST":{const{toastId:r}=t;return r?EP(r):e.toasts.forEach(n=>{EP(n.id)}),W(M({},e),{toasts:e.toasts.map(n=>n.id===r||r===void 0?W(M({},n),{open:!1}):n)})}case"REMOVE_TOAST":return t.toastId===void 0?W(M({},e),{toasts:[]}):W(M({},e),{toasts:e.toasts.filter(r=>r.id!==t.toastId)})}},Iy=[];let $y={toasts:[]};function O0(e){$y=kX($y,e),Iy.forEach(t=>{t($y)})}function EX(t){var e=me(t,[]);const r=SX(),n=a=>O0({type:"UPDATE_TOAST",toast:W(M({},a),{id:r})}),i=()=>O0({type:"DISMISS_TOAST",toastId:r});return O0({type:"ADD_TOAST",toast:W(M({},e),{id:r,open:!0,onOpenChange:a=>{a||i()}})}),{id:r,dismiss:i,update:n}}function jr(){const[e,t]=y.useState($y);return y.useEffect(()=>(Iy.push(t),()=>{const r=Iy.indexOf(t);r>-1&&Iy.splice(r,1)}),[e]),W(M({},e),{toast:EX,dismiss:r=>O0({type:"DISMISS_TOAST",toastId:r})})}function mt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(i){if(e==null||e(i),r===!1||!i.defaultPrevented)return t==null?void 0:t(i)}}function CP(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function vc(...e){return t=>{let r=!1;const n=e.map(i=>{const a=CP(i,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let i=0;i<n.length;i++){const a=n[i];typeof a=="function"?a():CP(e[i],null)}}}}function sr(...e){return y.useCallback(vc(...e),e)}function CX(e,t){const r=y.createContext(t),n=a=>{const d=a,{children:o}=d,l=me(d,["children"]),c=y.useMemo(()=>l,Object.values(l));return s.jsx(r.Provider,{value:c,children:o})};n.displayName=e+"Provider";function i(a){const o=y.useContext(r);if(o)return o;if(t!==void 0)return t;throw new Error(`\`${a}\` must be used within \`${e}\``)}return[n,i]}function js(e,t=[]){let r=[];function n(a,o){const l=y.createContext(o),c=r.length;r=[...r,o];const d=h=>{var w;const _=h,{scope:f,children:p}=_,x=me(_,["scope","children"]),g=((w=f==null?void 0:f[e])==null?void 0:w[c])||l,v=y.useMemo(()=>x,Object.values(x));return s.jsx(g.Provider,{value:v,children:p})};d.displayName=a+"Provider";function u(h,f){var g;const p=((g=f==null?void 0:f[e])==null?void 0:g[c])||l,x=y.useContext(p);if(x)return x;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${a}\``)}return[d,u]}const i=()=>{const a=r.map(o=>y.createContext(o));return function(l){const c=(l==null?void 0:l[e])||a;return y.useMemo(()=>({[`__scope${e}`]:W(M({},l),{[e]:c})}),[l,c])}};return i.scopeName=e,[n,PX(i,...t)]}function PX(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(a){const o=n.reduce((l,{useScope:c,scopeName:d})=>{const h=c(a)[`__scope${d}`];return M(M({},l),h)},{});return y.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function Nd(e){const t=TX(e),r=y.forwardRef((n,i)=>{const d=n,{children:a}=d,o=me(d,["children"]),l=y.Children.toArray(a),c=l.find(OX);if(c){const u=c.props.children,h=l.map(f=>f===c?y.Children.count(u)>1?y.Children.only(null):y.isValidElement(u)?u.props.children:null:f);return s.jsx(t,W(M({},o),{ref:i,children:y.isValidElement(u)?y.cloneElement(u,void 0,h):null}))}return s.jsx(t,W(M({},o),{ref:i,children:a}))});return r.displayName=`${e}.Slot`,r}var AX=Nd("Slot");function TX(e){const t=y.forwardRef((r,n)=>{const o=r,{children:i}=o,a=me(o,["children"]);if(y.isValidElement(i)){const l=MX(i),c=RX(a,i.props);return i.type!==y.Fragment&&(c.ref=n?vc(n,l):l),y.cloneElement(i,c)}return y.Children.count(i)>1?y.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var bD=Symbol("radix.slottable");function jD(e){const t=({children:r})=>s.jsx(s.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=bD,t}function OX(e){return y.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===bD}function RX(e,t){const r=M({},t);for(const n in t){const i=e[n],a=t[n];/^on[A-Z]/.test(n)?i&&a?r[n]=(...l)=>{const c=a(...l);return i(...l),c}:i&&(r[n]=i):n==="style"?r[n]=M(M({},i),a):n==="className"&&(r[n]=[i,a].filter(Boolean).join(" "))}return M(M({},e),r)}function MX(e){var n,i;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function zm(e){const t=e+"CollectionProvider",[r,n]=js(t),[i,a]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=g=>{const{scope:v,children:_}=g,w=Q.useRef(null),b=Q.useRef(new Map).current;return s.jsx(i,{scope:v,itemMap:b,collectionRef:w,children:_})};o.displayName=t;const l=e+"CollectionSlot",c=Nd(l),d=Q.forwardRef((g,v)=>{const{scope:_,children:w}=g,b=a(l,_),N=sr(v,b.collectionRef);return s.jsx(c,{ref:N,children:w})});d.displayName=l;const u=e+"CollectionItemSlot",h="data-radix-collection-item",f=Nd(u),p=Q.forwardRef((g,v)=>{const O=g,{scope:_,children:w}=O,b=me(O,["scope","children"]),N=Q.useRef(null),S=sr(v,N),k=a(u,_);return Q.useEffect(()=>(k.itemMap.set(N,M({ref:N},b)),()=>void k.itemMap.delete(N))),s.jsx(f,{[h]:"",ref:S,children:w})});p.displayName=u;function x(g){const v=a(e+"CollectionConsumer",g);return Q.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const b=Array.from(w.querySelectorAll(`[${h}]`));return Array.from(v.itemMap.values()).sort((k,O)=>b.indexOf(k.ref.current)-b.indexOf(O.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:d,ItemSlot:p},x,n]}var DX=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Nt=DX.reduce((e,t)=>{const r=Nd(`Primitive.${t}`),n=y.forwardRef((i,a)=>{const d=i,{asChild:o}=d,l=me(d,["asChild"]),c=o?r:t;return typeof window!="undefined"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(c,W(M({},l),{ref:a}))});return n.displayName=`Primitive.${t}`,W(M({},e),{[t]:n})},{});function Vk(e,t){e&&Ya.flushSync(()=>e.dispatchEvent(t))}function ss(e){const t=y.useRef(e);return y.useEffect(()=>{t.current=e}),y.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function IX(e,t=globalThis==null?void 0:globalThis.document){const r=ss(e);y.useEffect(()=>{const n=i=>{i.key==="Escape"&&r(i)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var $X="DismissableLayer",m3="dismissableLayer.update",LX="dismissableLayer.pointerDownOutside",FX="dismissableLayer.focusOutside",PP,ND=y.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),of=y.forwardRef((e,t)=>{var A;const O=e,{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:a,onInteractOutside:o,onDismiss:l}=O,c=me(O,["disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss"]),d=y.useContext(ND),[u,h]=y.useState(null),f=(A=u==null?void 0:u.ownerDocument)!=null?A:globalThis==null?void 0:globalThis.document,[,p]=y.useState({}),x=sr(t,T=>h(T)),g=Array.from(d.layers),[v]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),_=g.indexOf(v),w=u?g.indexOf(u):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,N=w>=_,S=BX(T=>{const $=T.target,R=[...d.branches].some(F=>F.contains($));!N||R||(i==null||i(T),o==null||o(T),T.defaultPrevented||l==null||l())},f),k=zX(T=>{const $=T.target;[...d.branches].some(F=>F.contains($))||(a==null||a(T),o==null||o(T),T.defaultPrevented||l==null||l())},f);return IX(T=>{w===d.layers.size-1&&(n==null||n(T),!T.defaultPrevented&&l&&(T.preventDefault(),l()))},f),y.useEffect(()=>{if(u)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(PP=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),AP(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=PP)}},[u,f,r,d]),y.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),AP())},[u,d]),y.useEffect(()=>{const T=()=>p({});return document.addEventListener(m3,T),()=>document.removeEventListener(m3,T)},[]),s.jsx(Nt.div,W(M({},c),{ref:x,style:M({pointerEvents:b?N?"auto":"none":void 0},e.style),onFocusCapture:mt(e.onFocusCapture,k.onFocusCapture),onBlurCapture:mt(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:mt(e.onPointerDownCapture,S.onPointerDownCapture)}))});of.displayName=$X;var UX="DismissableLayerBranch",SD=y.forwardRef((e,t)=>{const r=y.useContext(ND),n=y.useRef(null),i=sr(t,n);return y.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),s.jsx(Nt.div,W(M({},e),{ref:i}))});SD.displayName=UX;function BX(e,t=globalThis==null?void 0:globalThis.document){const r=ss(e),n=y.useRef(!1),i=y.useRef(()=>{});return y.useEffect(()=>{const a=l=>{if(l.target&&!n.current){let c=function(){kD(LX,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=c,t.addEventListener("click",i.current,{once:!0})):c()}else t.removeEventListener("click",i.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",a),t.removeEventListener("click",i.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function zX(e,t=globalThis==null?void 0:globalThis.document){const r=ss(e),n=y.useRef(!1);return y.useEffect(()=>{const i=a=>{a.target&&!n.current&&kD(FX,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function AP(){const e=new CustomEvent(m3);document.dispatchEvent(e)}function kD(e,t,r,{discrete:n}){const i=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?Vk(i,a):i.dispatchEvent(a)}var VX=of,qX=SD,is=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},WX="Portal",Vm=y.forwardRef((e,t)=>{var c;const l=e,{container:r}=l,n=me(l,["container"]),[i,a]=y.useState(!1);is(()=>a(!0),[]);const o=r||i&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return o?Nh.createPortal(s.jsx(Nt.div,W(M({},n),{ref:t})),o):null});Vm.displayName=WX;function HX(e,t){return y.useReducer((r,n)=>{const i=t[r][n];return i!=null?i:r},e)}var $s=e=>{const{present:t,children:r}=e,n=GX(t),i=typeof r=="function"?r({present:n.isPresent}):y.Children.only(r),a=sr(n.ref,YX(i));return typeof r=="function"||n.isPresent?y.cloneElement(i,{ref:a}):null};$s.displayName="Presence";function GX(e){const[t,r]=y.useState(),n=y.useRef(null),i=y.useRef(e),a=y.useRef("none"),o=e?"mounted":"unmounted",[l,c]=HX(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const d=$x(n.current);a.current=l==="mounted"?d:"none"},[l]),is(()=>{const d=n.current,u=i.current;if(u!==e){const f=a.current,p=$x(d);e?c("MOUNT"):p==="none"||(d==null?void 0:d.display)==="none"?c("UNMOUNT"):c(u&&f!==p?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,c]),is(()=>{var d;if(t){let u;const h=(d=t.ownerDocument.defaultView)!=null?d:window,f=x=>{const v=$x(n.current).includes(x.animationName);if(x.target===t&&v&&(c("ANIMATION_END"),!i.current)){const _=t.style.animationFillMode;t.style.animationFillMode="forwards",u=h.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=_)})}},p=x=>{x.target===t&&(a.current=$x(n.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{h.clearTimeout(u),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:y.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function $x(e){return(e==null?void 0:e.animationName)||"none"}function YX(e){var n,i;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var KX=J5[" useInsertionEffect ".trim().toString()]||is;function Di({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[i,a,o]=ZX({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:i;{const u=y.useRef(e!==void 0);y.useEffect(()=>{const h=u.current;h!==l&&console.warn(`${n} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=l},[l,n])}const d=y.useCallback(u=>{var h;if(l){const f=XX(u)?u(e):u;f!==e&&((h=o.current)==null||h.call(o,f))}else a(u)},[l,e,a,o]);return[c,d]}function ZX({defaultProp:e,onChange:t}){const[r,n]=y.useState(e),i=y.useRef(r),a=y.useRef(t);return KX(()=>{a.current=t},[t]),y.useEffect(()=>{var o;i.current!==r&&((o=a.current)==null||o.call(a,r),i.current=r)},[r,i]),[r,n,a]}function XX(e){return typeof e=="function"}var ED=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),JX="VisuallyHidden",pw=y.forwardRef((e,t)=>s.jsx(Nt.span,W(M({},e),{ref:t,style:M(M({},ED),e.style)})));pw.displayName=JX;var QX=pw,qk="ToastProvider",[Wk,eJ,tJ]=zm("Toast"),[CD,lFe]=js("Toast",[tJ]),[rJ,gw]=CD(qk),PD=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:i="right",swipeThreshold:a=50,children:o}=e,[l,c]=y.useState(null),[d,u]=y.useState(0),h=y.useRef(!1),f=y.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${qk}\`. Expected non-empty \`string\`.`),s.jsx(Wk.Provider,{scope:t,children:s.jsx(rJ,{scope:t,label:r,duration:n,swipeDirection:i,swipeThreshold:a,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:y.useCallback(()=>u(p=>p+1),[]),onToastRemove:y.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};PD.displayName=qk;var AD="ToastViewport",nJ=["F8"],p3="toast.viewportPause",g3="toast.viewportResume",TD=y.forwardRef((e,t)=>{const v=e,{__scopeToast:r,hotkey:n=nJ,label:i="Notifications ({hotkey})"}=v,a=me(v,["__scopeToast","hotkey","label"]),o=gw(AD,r),l=eJ(r),c=y.useRef(null),d=y.useRef(null),u=y.useRef(null),h=y.useRef(null),f=sr(t,h,o.onViewportChange),p=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),x=o.toastCount>0;y.useEffect(()=>{const _=w=>{var N;n.length!==0&&n.every(S=>w[S]||w.code===S)&&((N=h.current)==null||N.focus())};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[n]),y.useEffect(()=>{const _=c.current,w=h.current;if(x&&_&&w){const b=()=>{if(!o.isClosePausedRef.current){const O=new CustomEvent(p3);w.dispatchEvent(O),o.isClosePausedRef.current=!0}},N=()=>{if(o.isClosePausedRef.current){const O=new CustomEvent(g3);w.dispatchEvent(O),o.isClosePausedRef.current=!1}},S=O=>{!_.contains(O.relatedTarget)&&N()},k=()=>{_.contains(document.activeElement)||N()};return _.addEventListener("focusin",b),_.addEventListener("focusout",S),_.addEventListener("pointermove",b),_.addEventListener("pointerleave",k),window.addEventListener("blur",b),window.addEventListener("focus",N),()=>{_.removeEventListener("focusin",b),_.removeEventListener("focusout",S),_.removeEventListener("pointermove",b),_.removeEventListener("pointerleave",k),window.removeEventListener("blur",b),window.removeEventListener("focus",N)}}},[x,o.isClosePausedRef]);const g=y.useCallback(({tabbingDirection:_})=>{const b=l().map(N=>{const S=N.ref.current,k=[S,...gJ(S)];return _==="forwards"?k:k.reverse()});return(_==="forwards"?b.reverse():b).flat()},[l]);return y.useEffect(()=>{const _=h.current;if(_){const w=b=>{var k,O,A;const N=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!N){const T=document.activeElement,$=b.shiftKey;if(b.target===_&&$){(k=d.current)==null||k.focus();return}const D=g({tabbingDirection:$?"backwards":"forwards"}),B=D.findIndex(U=>U===T);Zb(D.slice(B+1))?b.preventDefault():$?(O=d.current)==null||O.focus():(A=u.current)==null||A.focus()}};return _.addEventListener("keydown",w),()=>_.removeEventListener("keydown",w)}},[l,g]),s.jsxs(qX,{ref:c,role:"region","aria-label":i.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:x?void 0:"none"},children:[x&&s.jsx(v3,{ref:d,onFocusFromOutsideViewport:()=>{const _=g({tabbingDirection:"forwards"});Zb(_)}}),s.jsx(Wk.Slot,{scope:r,children:s.jsx(Nt.ol,W(M({tabIndex:-1},a),{ref:f}))}),x&&s.jsx(v3,{ref:u,onFocusFromOutsideViewport:()=>{const _=g({tabbingDirection:"backwards"});Zb(_)}})]})});TD.displayName=AD;var OD="ToastFocusProxy",v3=y.forwardRef((e,t)=>{const o=e,{__scopeToast:r,onFocusFromOutsideViewport:n}=o,i=me(o,["__scopeToast","onFocusFromOutsideViewport"]),a=gw(OD,r);return s.jsx(pw,W(M({"aria-hidden":!0,tabIndex:0},i),{ref:t,style:{position:"fixed"},onFocus:l=>{var u;const c=l.relatedTarget;!((u=a.viewport)!=null&&u.contains(c))&&n()}}))});v3.displayName=OD;var xv="Toast",sJ="toast.swipeStart",iJ="toast.swipeMove",aJ="toast.swipeCancel",oJ="toast.swipeEnd",RD=y.forwardRef((e,t)=>{const d=e,{forceMount:r,open:n,defaultOpen:i,onOpenChange:a}=d,o=me(d,["forceMount","open","defaultOpen","onOpenChange"]),[l,c]=Di({prop:n,defaultProp:i!=null?i:!0,onChange:a,caller:xv});return s.jsx($s,{present:r||l,children:s.jsx(dJ,W(M({open:l},o),{ref:t,onClose:()=>c(!1),onPause:ss(e.onPause),onResume:ss(e.onResume),onSwipeStart:mt(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:mt(e.onSwipeMove,u=>{const{x:h,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${h}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:mt(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:mt(e.onSwipeEnd,u=>{const{x:h,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${h}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),c(!1)})}))})});RD.displayName=xv;var[lJ,cJ]=CD(xv,{onClose(){}}),dJ=y.forwardRef((e,t)=>{const B=e,{__scopeToast:r,type:n="foreground",duration:i,open:a,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:p}=B,x=me(B,["__scopeToast","type","duration","open","onClose","onEscapeKeyDown","onPause","onResume","onSwipeStart","onSwipeMove","onSwipeCancel","onSwipeEnd"]),g=gw(xv,r),[v,_]=y.useState(null),w=sr(t,U=>_(U)),b=y.useRef(null),N=y.useRef(null),S=i||g.duration,k=y.useRef(0),O=y.useRef(S),A=y.useRef(0),{onToastAdd:T,onToastRemove:$}=g,R=ss(()=>{var V;(v==null?void 0:v.contains(document.activeElement))&&((V=g.viewport)==null||V.focus()),o()}),F=y.useCallback(U=>{!U||U===1/0||(window.clearTimeout(A.current),k.current=new Date().getTime(),A.current=window.setTimeout(R,U))},[R]);y.useEffect(()=>{const U=g.viewport;if(U){const V=()=>{F(O.current),d==null||d()},Y=()=>{const z=new Date().getTime()-k.current;O.current=O.current-z,window.clearTimeout(A.current),c==null||c()};return U.addEventListener(p3,Y),U.addEventListener(g3,V),()=>{U.removeEventListener(p3,Y),U.removeEventListener(g3,V)}}},[g.viewport,S,c,d,F]),y.useEffect(()=>{a&&!g.isClosePausedRef.current&&F(S)},[a,S,g.isClosePausedRef,F]),y.useEffect(()=>(T(),()=>$()),[T,$]);const D=y.useMemo(()=>v?UD(v):null,[v]);return g.viewport?s.jsxs(s.Fragment,{children:[D&&s.jsx(uJ,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:D}),s.jsx(lJ,{scope:r,onClose:R,children:Ya.createPortal(s.jsx(Wk.ItemSlot,{scope:r,children:s.jsx(VX,{asChild:!0,onEscapeKeyDown:mt(l,()=>{g.isFocusedToastEscapeKeyDownRef.current||R(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:s.jsx(Nt.li,W(M({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":a?"open":"closed","data-swipe-direction":g.swipeDirection},x),{ref:w,style:M({userSelect:"none",touchAction:"none"},e.style),onKeyDown:mt(e.onKeyDown,U=>{U.key==="Escape"&&(l==null||l(U.nativeEvent),U.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,R()))}),onPointerDown:mt(e.onPointerDown,U=>{U.button===0&&(b.current={x:U.clientX,y:U.clientY})}),onPointerMove:mt(e.onPointerMove,U=>{if(!b.current)return;const V=U.clientX-b.current.x,Y=U.clientY-b.current.y,z=!!N.current,K=["left","right"].includes(g.swipeDirection),Z=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,G=K?Z(0,V):0,X=K?0:Z(0,Y),te=U.pointerType==="touch"?10:2,se={x:G,y:X},ue={originalEvent:U,delta:se};z?(N.current=se,Lx(iJ,h,ue,{discrete:!1})):TP(se,g.swipeDirection,te)?(N.current=se,Lx(sJ,u,ue,{discrete:!1}),U.target.setPointerCapture(U.pointerId)):(Math.abs(V)>te||Math.abs(Y)>te)&&(b.current=null)}),onPointerUp:mt(e.onPointerUp,U=>{const V=N.current,Y=U.target;if(Y.hasPointerCapture(U.pointerId)&&Y.releasePointerCapture(U.pointerId),N.current=null,b.current=null,V){const z=U.currentTarget,K={originalEvent:U,delta:V};TP(V,g.swipeDirection,g.swipeThreshold)?Lx(oJ,p,K,{discrete:!0}):Lx(aJ,f,K,{discrete:!0}),z.addEventListener("click",Z=>Z.preventDefault(),{once:!0})}})}))})}),g.viewport)})]}):null}),uJ=e=>{const d=e,{__scopeToast:t,children:r}=d,n=me(d,["__scopeToast","children"]),i=gw(xv,t),[a,o]=y.useState(!1),[l,c]=y.useState(!1);return mJ(()=>o(!0)),y.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:s.jsx(Vm,{asChild:!0,children:s.jsx(pw,W(M({},n),{children:a&&s.jsxs(s.Fragment,{children:[i.label," ",r]})}))})},fJ="ToastTitle",MD=y.forwardRef((e,t)=>{const i=e,{__scopeToast:r}=i,n=me(i,["__scopeToast"]);return s.jsx(Nt.div,W(M({},n),{ref:t}))});MD.displayName=fJ;var hJ="ToastDescription",DD=y.forwardRef((e,t)=>{const i=e,{__scopeToast:r}=i,n=me(i,["__scopeToast"]);return s.jsx(Nt.div,W(M({},n),{ref:t}))});DD.displayName=hJ;var ID="ToastAction",$D=y.forwardRef((e,t)=>{const i=e,{altText:r}=i,n=me(i,["altText"]);return r.trim()?s.jsx(FD,{altText:r,asChild:!0,children:s.jsx(Hk,W(M({},n),{ref:t}))}):(console.error(`Invalid prop \`altText\` supplied to \`${ID}\`. Expected non-empty \`string\`.`),null)});$D.displayName=ID;var LD="ToastClose",Hk=y.forwardRef((e,t)=>{const a=e,{__scopeToast:r}=a,n=me(a,["__scopeToast"]),i=cJ(LD,r);return s.jsx(FD,{asChild:!0,children:s.jsx(Nt.button,W(M({type:"button"},n),{ref:t,onClick:mt(e.onClick,i.onClose)}))})});Hk.displayName=LD;var FD=y.forwardRef((e,t)=>{const a=e,{__scopeToast:r,altText:n}=a,i=me(a,["__scopeToast","altText"]);return s.jsx(Nt.div,W(M({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0},i),{ref:t}))});function UD(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),pJ(n)){const i=n.ariaHidden||n.hidden||n.style.display==="none",a=n.dataset.radixToastAnnounceExclude==="";if(!i)if(a){const o=n.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...UD(n))}}),t}function Lx(e,t,r,{discrete:n}){const i=r.originalEvent.currentTarget,a=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?Vk(i,a):i.dispatchEvent(a)}var TP=(e,t,r=0)=>{const n=Math.abs(e.x),i=Math.abs(e.y),a=n>i;return t==="left"||t==="right"?a&&n>r:!a&&i>r};function mJ(e=()=>{}){const t=ss(e);is(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function pJ(e){return e.nodeType===e.ELEMENT_NODE}function gJ(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Zb(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var vJ=PD,BD=TD,zD=RD,VD=MD,qD=DD,WD=$D,HD=Hk;function GD(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=GD(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Lr(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=GD(e))&&(n&&(n+=" "),n+=t);return n}const OP=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,RP=Lr,qm=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return RP(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:i,defaultVariants:a}=t,o=Object.keys(i).map(d=>{const u=r==null?void 0:r[d],h=a==null?void 0:a[d];if(u===null)return null;const f=OP(u)||OP(h);return i[d][f]}),l=r&&Object.entries(r).reduce((d,u)=>{let[h,f]=u;return f===void 0||(d[h]=f),d},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,u)=>{let x=u,{class:h,className:f}=x,p=me(x,["class","className"]);return Object.entries(p).every(g=>{let[v,_]=g;return Array.isArray(_)?_.includes(M(M({},a),l)[v]):M(M({},a),l)[v]===_})?[...d,h,f]:d},[]);return RP(e,o,c,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xJ=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),YD=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yJ={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _J=y.forwardRef((d,c)=>{var u=d,{color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:o}=u,l=me(u,["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"]);return y.createElement("svg",M(W(M({ref:c},yJ),{width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:YD("lucide",i)}),l),[...o.map(([h,f])=>y.createElement(h,f)),...Array.isArray(a)?a:[a]])});/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=(e,t)=>{const r=y.forwardRef((o,a)=>{var l=o,{className:n}=l,i=me(l,["className"]);return y.createElement(_J,M({ref:a,iconNode:t,className:YD(`lucide-${xJ(e)}`,n)},i))});return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=ot("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wJ=ot("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bJ=ot("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=ot("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jJ=ot("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NJ=ot("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SJ=ot("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=ot("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bl=ot("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kJ=ot("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=ot("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EJ=ot("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uu=ot("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CJ=ot("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=ot("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=ot("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=ot("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=ot("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gk=ot("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=ot("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=ot("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KD=ot("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vw=ot("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=ot("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=ot("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jl=ot("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fx=ot("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PJ=ot("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AJ=ot("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZD=ot("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=ot("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TJ=ot("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OJ=ot("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zu=ot("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RJ=ot("Disc",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=ot("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yv=ot("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MJ=ot("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=ot("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DJ=ot("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lf=ot("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IJ=ot("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xw=ot("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=ot("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $J=ot("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=ot("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LJ=ot("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=ot("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FJ=ot("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UJ=ot("HeartOff",[["line",{x1:"2",y1:"2",x2:"22",y2:"22",key:"1w4vcy"}],["path",{d:"M16.5 16.5 12 21l-7-7c-1.5-1.45-3-3.2-3-5.5a5.5 5.5 0 0 1 2.14-4.35",key:"3mpagl"}],["path",{d:"M8.76 3.1c1.15.22 2.13.78 3.24 1.9 1.5-1.5 2.74-2 4.5-2A5.5 5.5 0 0 1 22 8.5c0 2.12-1.3 3.78-2.67 5.17",key:"1gh3v3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=ot("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BJ=ot("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=ot("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XD=ot("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JD=ot("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zJ=ot("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VJ=ot("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qJ=ot("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=ot("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=ot("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DP=ot("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WJ=ot("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HJ=ot("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=ot("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GJ=ot("MapPinned",[["path",{d:"M18 8c0 3.613-3.869 7.429-5.393 8.795a1 1 0 0 1-1.214 0C9.87 15.429 6 11.613 6 8a6 6 0 0 1 12 0",key:"11u0oz"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M8.714 14h-3.71a1 1 0 0 0-.948.683l-2.004 6A1 1 0 0 0 3 22h18a1 1 0 0 0 .948-1.316l-2-6a1 1 0 0 0-.949-.684h-3.712",key:"q8zwxj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YJ=ot("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=ot("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g0=ot("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KJ=ot("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QD=ot("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZJ=ot("Music2",[["circle",{cx:"8",cy:"18",r:"4",key:"1fc0mg"}],["path",{d:"M12 18V2l7 4",key:"g04rme"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=ot("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk=ot("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XJ=ot("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=ot("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JJ=ot("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xb=ot("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QJ=ot("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=ot("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=ot("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eQ=ot("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tQ=ot("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=ot("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mi=ot("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=ot("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rQ=ot("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=ot("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nQ=ot("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ql=ot("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=ot("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cu=ot("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sQ=ot("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=ot("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=ot("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iQ=ot("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=ot("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=ot("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=ot("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=ot("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=ot("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=ot("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=ot("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v0=ot("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=ot("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pu=ot("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=ot("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=ot("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=ot("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aQ=ot("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=ot("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=ot("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Zk="-",oQ=e=>{const t=cQ(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:o=>{const l=o.split(Zk);return l[0]===""&&l.length!==1&&l.shift(),sI(l,t)||lQ(o)},getConflictingClassGroupIds:(o,l)=>{const c=r[o]||[];return l&&n[o]?[...c,...n[o]]:c}}},sI=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),i=n?sI(e.slice(1),n):void 0;if(i)return i;if(t.validators.length===0)return;const a=e.join(Zk);return(o=t.validators.find(({validator:l})=>l(a)))==null?void 0:o.classGroupId},IP=/^\[(.+)\]$/,lQ=e=>{if(IP.test(e)){const t=IP.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},cQ=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return uQ(Object.entries(e.classGroups),r).forEach(([a,o])=>{b3(o,n,a,t)}),n},b3=(e,t,r,n)=>{e.forEach(i=>{if(typeof i=="string"){const a=i===""?t:$P(t,i);a.classGroupId=r;return}if(typeof i=="function"){if(dQ(i)){b3(i(n),t,r,n);return}t.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,o])=>{b3(o,$P(t,a),r,n)})})},$P=(e,t)=>{let r=e;return t.split(Zk).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},dQ=e=>e.isThemeGetter,uQ=(e,t)=>t?e.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?t+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([o,l])=>[t+o,l])):a);return[r,i]}):e,fQ=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const i=(a,o)=>{r.set(a,o),t++,t>e&&(t=0,n=r,r=new Map)};return{get(a){let o=r.get(a);if(o!==void 0)return o;if((o=n.get(a))!==void 0)return i(a,o),o},set(a,o){r.has(a)?r.set(a,o):i(a,o)}}},iI="!",hQ=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,i=t[0],a=t.length,o=l=>{const c=[];let d=0,u=0,h;for(let v=0;v<l.length;v++){let _=l[v];if(d===0){if(_===i&&(n||l.slice(v,v+a)===t)){c.push(l.slice(u,v)),u=v+a;continue}if(_==="/"){h=v;continue}}_==="["?d++:_==="]"&&d--}const f=c.length===0?l:l.substring(u),p=f.startsWith(iI),x=p?f.substring(1):f,g=h&&h>u?h-u:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:x,maybePostfixModifierPosition:g}};return r?l=>r({className:l,parseClassName:o}):o},mQ=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},pQ=e=>M({cache:fQ(e.cacheSize),parseClassName:hQ(e)},oQ(e)),gQ=/\s+/,vQ=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=t,a=[],o=e.trim().split(gQ);let l="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{modifiers:u,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=r(d);let x=!!p,g=n(x?f.substring(0,p):f);if(!g){if(!x){l=d+(l.length>0?" "+l:l);continue}if(g=n(f),!g){l=d+(l.length>0?" "+l:l);continue}x=!1}const v=mQ(u).join(":"),_=h?v+iI:v,w=_+g;if(a.includes(w))continue;a.push(w);const b=i(g,x);for(let N=0;N<b.length;++N){const S=b[N];a.push(_+S)}l=d+(l.length>0?" "+l:l)}return l};function xQ(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=aI(t))&&(n&&(n+=" "),n+=r);return n}const aI=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=aI(e[n]))&&(r&&(r+=" "),r+=t);return r};function yQ(e,...t){let r,n,i,a=o;function o(c){const d=t.reduce((u,h)=>h(u),e());return r=pQ(d),n=r.cache.get,i=r.cache.set,a=l,l(c)}function l(c){const d=n(c);if(d)return d;const u=vQ(c,r);return i(c,u),u}return function(){return a(xQ.apply(null,arguments))}}const In=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},oI=/^\[(?:([a-z-]+):)?(.+)\]$/i,_Q=/^\d+\/\d+$/,wQ=new Set(["px","full","screen"]),bQ=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,jQ=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,NQ=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,SQ=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,kQ=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ll=e=>Sh(e)||wQ.has(e)||_Q.test(e),Fc=e=>Wm(e,"length",MQ),Sh=e=>!!e&&!Number.isNaN(Number(e)),Jb=e=>Wm(e,"number",Sh),Up=e=>!!e&&Number.isInteger(Number(e)),EQ=e=>e.endsWith("%")&&Sh(e.slice(0,-1)),Er=e=>oI.test(e),Uc=e=>bQ.test(e),CQ=new Set(["length","size","percentage"]),PQ=e=>Wm(e,CQ,lI),AQ=e=>Wm(e,"position",lI),TQ=new Set(["image","url"]),OQ=e=>Wm(e,TQ,IQ),RQ=e=>Wm(e,"",DQ),Bp=()=>!0,Wm=(e,t,r)=>{const n=oI.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},MQ=e=>jQ.test(e)&&!NQ.test(e),lI=()=>!1,DQ=e=>SQ.test(e),IQ=e=>kQ.test(e),$Q=()=>{const e=In("colors"),t=In("spacing"),r=In("blur"),n=In("brightness"),i=In("borderColor"),a=In("borderRadius"),o=In("borderSpacing"),l=In("borderWidth"),c=In("contrast"),d=In("grayscale"),u=In("hueRotate"),h=In("invert"),f=In("gap"),p=In("gradientColorStops"),x=In("gradientColorStopPositions"),g=In("inset"),v=In("margin"),_=In("opacity"),w=In("padding"),b=In("saturate"),N=In("scale"),S=In("sepia"),k=In("skew"),O=In("space"),A=In("translate"),T=()=>["auto","contain","none"],$=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto",Er,t],F=()=>[Er,t],D=()=>["",Ll,Fc],B=()=>["auto",Sh,Er],U=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],V=()=>["solid","dashed","dotted","double","none"],Y=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],z=()=>["start","end","center","between","around","evenly","stretch"],K=()=>["","0",Er],Z=()=>["auto","avoid","all","avoid-page","page","left","right","column"],G=()=>[Sh,Er];return{cacheSize:500,separator:":",theme:{colors:[Bp],spacing:[Ll,Fc],blur:["none","",Uc,Er],brightness:G(),borderColor:[e],borderRadius:["none","","full",Uc,Er],borderSpacing:F(),borderWidth:D(),contrast:G(),grayscale:K(),hueRotate:G(),invert:K(),gap:F(),gradientColorStops:[e],gradientColorStopPositions:[EQ,Fc],inset:R(),margin:R(),opacity:G(),padding:F(),saturate:G(),scale:G(),sepia:K(),skew:G(),space:F(),translate:F()},classGroups:{aspect:[{aspect:["auto","square","video",Er]}],container:["container"],columns:[{columns:[Uc]}],"break-after":[{"break-after":Z()}],"break-before":[{"break-before":Z()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...U(),Er]}],overflow:[{overflow:$()}],"overflow-x":[{"overflow-x":$()}],"overflow-y":[{"overflow-y":$()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Up,Er]}],basis:[{basis:R()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Er]}],grow:[{grow:K()}],shrink:[{shrink:K()}],order:[{order:["first","last","none",Up,Er]}],"grid-cols":[{"grid-cols":[Bp]}],"col-start-end":[{col:["auto",{span:["full",Up,Er]},Er]}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":[Bp]}],"row-start-end":[{row:["auto",{span:[Up,Er]},Er]}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Er]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Er]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...z()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...z(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...z(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[O]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[O]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Er,t]}],"min-w":[{"min-w":[Er,t,"min","max","fit"]}],"max-w":[{"max-w":[Er,t,"none","full","min","max","fit","prose",{screen:[Uc]},Uc]}],h:[{h:[Er,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Er,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Er,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Er,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Uc,Fc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Jb]}],"font-family":[{font:[Bp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Er]}],"line-clamp":[{"line-clamp":["none",Sh,Jb]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ll,Er]}],"list-image":[{"list-image":["none",Er]}],"list-style-type":[{list:["none","disc","decimal",Er]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[_]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[_]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...V(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ll,Fc]}],"underline-offset":[{"underline-offset":["auto",Ll,Er]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:F()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Er]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Er]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[_]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...U(),AQ]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",PQ]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},OQ]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[_]}],"border-style":[{border:[...V(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[_]}],"divide-style":[{divide:V()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...V()]}],"outline-offset":[{"outline-offset":[Ll,Er]}],"outline-w":[{outline:[Ll,Fc]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:D()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[_]}],"ring-offset-w":[{"ring-offset":[Ll,Fc]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Uc,RQ]}],"shadow-color":[{shadow:[Bp]}],opacity:[{opacity:[_]}],"mix-blend":[{"mix-blend":[...Y(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Y()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Uc,Er]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[_]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Er]}],duration:[{duration:G()}],ease:[{ease:["linear","in","out","in-out",Er]}],delay:[{delay:G()}],animate:[{animate:["none","spin","ping","pulse","bounce",Er]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[Up,Er]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Er]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Er]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":F()}],"scroll-mx":[{"scroll-mx":F()}],"scroll-my":[{"scroll-my":F()}],"scroll-ms":[{"scroll-ms":F()}],"scroll-me":[{"scroll-me":F()}],"scroll-mt":[{"scroll-mt":F()}],"scroll-mr":[{"scroll-mr":F()}],"scroll-mb":[{"scroll-mb":F()}],"scroll-ml":[{"scroll-ml":F()}],"scroll-p":[{"scroll-p":F()}],"scroll-px":[{"scroll-px":F()}],"scroll-py":[{"scroll-py":F()}],"scroll-ps":[{"scroll-ps":F()}],"scroll-pe":[{"scroll-pe":F()}],"scroll-pt":[{"scroll-pt":F()}],"scroll-pr":[{"scroll-pr":F()}],"scroll-pb":[{"scroll-pb":F()}],"scroll-pl":[{"scroll-pl":F()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Er]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Ll,Fc,Jb]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},LQ=yQ($Q);function ke(...e){return LQ(Lr(e))}const FQ=vJ,cI=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(BD,M({ref:r,className:ke("fixed top-0 z-[3000] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e)},t))});cI.displayName=BD.displayName;const UQ=qm("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),dI=y.forwardRef((i,n)=>{var a=i,{className:e,variant:t}=a,r=me(a,["className","variant"]);return s.jsx(zD,M({ref:n,className:ke(UQ({variant:t}),e)},r))});dI.displayName=zD.displayName;const uI=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(WD,M({ref:r,className:ke("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e)},t))});uI.displayName=WD.displayName;const fI=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(HD,W(M({ref:r,className:ke("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":""},t),{children:s.jsx(pr,{className:"h-4 w-4"})}))});fI.displayName=HD.displayName;const hI=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(VD,M({ref:r,className:ke("text-sm font-semibold",e)},t))});hI.displayName=VD.displayName;const mI=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(qD,M({ref:r,className:ke("text-sm opacity-90",e)},t))});mI.displayName=qD.displayName;function BQ(){const{toasts:e}=jr();return s.jsxs(FQ,{children:[e.map(function(o){var l=o,{id:t,title:r,description:n,action:i}=l,a=me(l,["id","title","description","action"]);return s.jsxs(dI,W(M({},a),{children:[s.jsxs("div",{className:"grid gap-1",children:[r&&s.jsx(hI,{children:r}),n&&s.jsx(mI,{children:n})]}),i,s.jsx(fI,{})]}),t)}),s.jsx(cI,{})]})}var LP=["light","dark"],zQ="(prefers-color-scheme: dark)",VQ=y.createContext(void 0),qQ={setTheme:e=>{},themes:[]},WQ=()=>{var e;return(e=y.useContext(VQ))!=null?e:qQ};y.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:i,defaultTheme:a,value:o,attrs:l,nonce:c})=>{let d=a==="system",u=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${l.map(x=>`'${x}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,h=i?LP.includes(a)&&a?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${a}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(x,g=!1,v=!0)=>{let _=o?o[x]:x,w=g?x+"|| ''":`'${_}'`,b="";return i&&v&&!g&&LP.includes(x)&&(b+=`d.style.colorScheme = '${x}';`),r==="class"?g||_?b+=`c.add(${w})`:b+="null":_&&(b+=`d[s](n,${w})`),b},p=e?`!function(){${u}${f(e)}}()`:n?`!function(){try{${u}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${d})){var t='${zQ}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${d?"":"else{"+f(a,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(a,!1,!1)};}${h}}catch(t){}}();`;return y.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:p}})});var HQ=e=>{switch(e){case"success":return KQ;case"info":return XQ;case"warning":return ZQ;case"error":return JQ;default:return null}},GQ=Array(12).fill(0),YQ=({visible:e,className:t})=>Q.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Q.createElement("div",{className:"sonner-spinner"},GQ.map((r,n)=>Q.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),KQ=Q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Q.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),ZQ=Q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Q.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),XQ=Q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Q.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),JQ=Q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Q.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),QQ=Q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Q.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Q.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),eee=()=>{let[e,t]=Q.useState(document.hidden);return Q.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},j3=1,tee=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let l=e,{message:r}=l,n=me(l,["message"]),i=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:j3++,a=this.toasts.find(c=>c.id===i),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(c=>c.id===i?(this.publish(W(M(M({},c),e),{id:i,title:r})),W(M(M({},c),e),{id:i,dismissible:o,title:r})):c):this.addToast(W(M({title:r},n),{dismissible:o,id:i})),i},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create(W(M({},t),{message:e})),this.error=(e,t)=>this.create(W(M({},t),{message:e,type:"error"})),this.success=(e,t)=>this.create(W(M({},t),{type:"success",message:e})),this.info=(e,t)=>this.create(W(M({},t),{type:"info",message:e})),this.warning=(e,t)=>this.create(W(M({},t),{type:"warning",message:e})),this.loading=(e,t)=>this.create(W(M({},t),{type:"loading",message:e})),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create(W(M({},t),{promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0})));let n=e instanceof Promise?e:e(),i=r!==void 0,a,o=n.then(c=>E(this,null,function*(){if(a=["resolve",c],Q.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(nee(c)&&!c.ok){i=!1;let d=typeof t.error=="function"?yield t.error(`HTTP error! status: ${c.status}`):t.error,u=typeof t.description=="function"?yield t.description(`HTTP error! status: ${c.status}`):t.description;this.create({id:r,type:"error",message:d,description:u})}else if(t.success!==void 0){i=!1;let d=typeof t.success=="function"?yield t.success(c):t.success,u=typeof t.description=="function"?yield t.description(c):t.description;this.create({id:r,type:"success",message:d,description:u})}})).catch(c=>E(this,null,function*(){if(a=["reject",c],t.error!==void 0){i=!1;let d=typeof t.error=="function"?yield t.error(c):t.error,u=typeof t.description=="function"?yield t.description(c):t.description;this.create({id:r,type:"error",message:d,description:u})}})).finally(()=>{var c;i&&(this.dismiss(r),r=void 0),(c=t.finally)==null||c.call(t)}),l=()=>new Promise((c,d)=>o.then(()=>a[0]==="reject"?d(a[1]):c(a[1])).catch(d));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||j3++;return this.create(M({jsx:e(r),id:r},t)),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Wi=new tee,ree=(e,t)=>{let r=(t==null?void 0:t.id)||j3++;return Wi.addToast(W(M({title:e},t),{id:r})),r},nee=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",see=ree,iee=()=>Wi.toasts,aee=()=>Wi.getActiveToasts();Object.assign(see,{success:Wi.success,info:Wi.info,warning:Wi.warning,error:Wi.error,custom:Wi.custom,message:Wi.message,promise:Wi.promise,dismiss:Wi.dismiss,loading:Wi.loading},{getHistory:iee,getToasts:aee});function oee(e,{insertAt:t}={}){if(typeof document=="undefined")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}oee(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Ux(e){return e.label!==void 0}var lee=3,cee="32px",dee="16px",FP=4e3,uee=356,fee=14,hee=20,mee=200;function oo(...e){return e.filter(Boolean).join(" ")}function pee(e){let[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var gee=e=>{var t,r,n,i,a,o,l,c,d,u,h;let{invert:f,toast:p,unstyled:x,interacting:g,setHeights:v,visibleToasts:_,heights:w,index:b,toasts:N,expanded:S,removeToast:k,defaultRichColors:O,closeButton:A,style:T,cancelButtonStyle:$,actionButtonStyle:R,className:F="",descriptionClassName:D="",duration:B,position:U,gap:V,loadingIcon:Y,expandByDefault:z,classNames:K,icons:Z,closeButtonAriaLabel:G="Close toast",pauseWhenPageIsHidden:X}=e,[te,se]=Q.useState(null),[ue,ye]=Q.useState(null),[ne,xe]=Q.useState(!1),[ge,ie]=Q.useState(!1),[ee,H]=Q.useState(!1),[le,Se]=Q.useState(!1),[ae,fe]=Q.useState(!1),[he,pe]=Q.useState(0),[Ae,qe]=Q.useState(0),Fe=Q.useRef(p.duration||B||FP),ve=Q.useRef(null),rt=Q.useRef(null),Ve=b===0,lt=b+1<=_,ut=p.type,Ze=p.dismissible!==!1,qt=p.className||"",lr=p.descriptionClassName||"",Ge=Q.useMemo(()=>w.findIndex(Ie=>Ie.toastId===p.id)||0,[w,p.id]),Le=Q.useMemo(()=>{var Ie;return(Ie=p.closeButton)!=null?Ie:A},[p.closeButton,A]),yt=Q.useMemo(()=>p.duration||B||FP,[p.duration,B]),Ne=Q.useRef(0),Oe=Q.useRef(0),ce=Q.useRef(0),Ee=Q.useRef(null),[Qe,vt]=U.split("-"),wt=Q.useMemo(()=>w.reduce((Ie,Ue,dt)=>dt>=Ge?Ie:Ie+Ue.height,0),[w,Ge]),Ht=eee(),Rt=p.invert||f,Te=ut==="loading";Oe.current=Q.useMemo(()=>Ge*V+wt,[Ge,wt]),Q.useEffect(()=>{Fe.current=yt},[yt]),Q.useEffect(()=>{xe(!0)},[]),Q.useEffect(()=>{let Ie=rt.current;if(Ie){let Ue=Ie.getBoundingClientRect().height;return qe(Ue),v(dt=>[{toastId:p.id,height:Ue,position:p.position},...dt]),()=>v(dt=>dt.filter(be=>be.toastId!==p.id))}},[v,p.id]),Q.useLayoutEffect(()=>{if(!ne)return;let Ie=rt.current,Ue=Ie.style.height;Ie.style.height="auto";let dt=Ie.getBoundingClientRect().height;Ie.style.height=Ue,qe(dt),v(be=>be.find(Re=>Re.toastId===p.id)?be.map(Re=>Re.toastId===p.id?W(M({},Re),{height:dt}):Re):[{toastId:p.id,height:dt,position:p.position},...be])},[ne,p.title,p.description,v,p.id]);let bt=Q.useCallback(()=>{ie(!0),pe(Oe.current),v(Ie=>Ie.filter(Ue=>Ue.toastId!==p.id)),setTimeout(()=>{k(p)},mee)},[p,k,v,Oe]);Q.useEffect(()=>{if(p.promise&&ut==="loading"||p.duration===1/0||p.type==="loading")return;let Ie;return S||g||X&&Ht?(()=>{if(ce.current<Ne.current){let Ue=new Date().getTime()-Ne.current;Fe.current=Fe.current-Ue}ce.current=new Date().getTime()})():Fe.current!==1/0&&(Ne.current=new Date().getTime(),Ie=setTimeout(()=>{var Ue;(Ue=p.onAutoClose)==null||Ue.call(p,p),bt()},Fe.current)),()=>clearTimeout(Ie)},[S,g,p,ut,X,Ht,bt]),Q.useEffect(()=>{p.delete&&bt()},[bt,p.delete]);function $e(){var Ie,Ue,dt;return Z!=null&&Z.loading?Q.createElement("div",{className:oo(K==null?void 0:K.loader,(Ie=p==null?void 0:p.classNames)==null?void 0:Ie.loader,"sonner-loader"),"data-visible":ut==="loading"},Z.loading):Y?Q.createElement("div",{className:oo(K==null?void 0:K.loader,(Ue=p==null?void 0:p.classNames)==null?void 0:Ue.loader,"sonner-loader"),"data-visible":ut==="loading"},Y):Q.createElement(YQ,{className:oo(K==null?void 0:K.loader,(dt=p==null?void 0:p.classNames)==null?void 0:dt.loader),visible:ut==="loading"})}return Q.createElement("li",{tabIndex:0,ref:rt,className:oo(F,qt,K==null?void 0:K.toast,(t=p==null?void 0:p.classNames)==null?void 0:t.toast,K==null?void 0:K.default,K==null?void 0:K[ut],(r=p==null?void 0:p.classNames)==null?void 0:r[ut]),"data-sonner-toast":"","data-rich-colors":(n=p.richColors)!=null?n:O,"data-styled":!(p.jsx||p.unstyled||x),"data-mounted":ne,"data-promise":!!p.promise,"data-swiped":ae,"data-removed":ge,"data-visible":lt,"data-y-position":Qe,"data-x-position":vt,"data-index":b,"data-front":Ve,"data-swiping":ee,"data-dismissible":Ze,"data-type":ut,"data-invert":Rt,"data-swipe-out":le,"data-swipe-direction":ue,"data-expanded":!!(S||z&&ne),style:M(M({"--index":b,"--toasts-before":b,"--z-index":N.length-b,"--offset":`${ge?he:Oe.current}px`,"--initial-height":z?"auto":`${Ae}px`},T),p.style),onDragEnd:()=>{H(!1),se(null),Ee.current=null},onPointerDown:Ie=>{Te||!Ze||(ve.current=new Date,pe(Oe.current),Ie.target.setPointerCapture(Ie.pointerId),Ie.target.tagName!=="BUTTON"&&(H(!0),Ee.current={x:Ie.clientX,y:Ie.clientY}))},onPointerUp:()=>{var Ie,Ue,dt,be;if(le||!Ze)return;Ee.current=null;let Re=Number(((Ie=rt.current)==null?void 0:Ie.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),We=Number(((Ue=rt.current)==null?void 0:Ue.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),St=new Date().getTime()-((dt=ve.current)==null?void 0:dt.getTime()),Ye=te==="x"?Re:We,ir=Math.abs(Ye)/St;if(Math.abs(Ye)>=hee||ir>.11){pe(Oe.current),(be=p.onDismiss)==null||be.call(p,p),ye(te==="x"?Re>0?"right":"left":We>0?"down":"up"),bt(),Se(!0),fe(!1);return}H(!1),se(null)},onPointerMove:Ie=>{var Ue,dt,be,Re;if(!Ee.current||!Ze||((Ue=window.getSelection())==null?void 0:Ue.toString().length)>0)return;let We=Ie.clientY-Ee.current.y,St=Ie.clientX-Ee.current.x,Ye=(dt=e.swipeDirections)!=null?dt:pee(U);!te&&(Math.abs(St)>1||Math.abs(We)>1)&&se(Math.abs(St)>Math.abs(We)?"x":"y");let ir={x:0,y:0};te==="y"?(Ye.includes("top")||Ye.includes("bottom"))&&(Ye.includes("top")&&We<0||Ye.includes("bottom")&&We>0)&&(ir.y=We):te==="x"&&(Ye.includes("left")||Ye.includes("right"))&&(Ye.includes("left")&&St<0||Ye.includes("right")&&St>0)&&(ir.x=St),(Math.abs(ir.x)>0||Math.abs(ir.y)>0)&&fe(!0),(be=rt.current)==null||be.style.setProperty("--swipe-amount-x",`${ir.x}px`),(Re=rt.current)==null||Re.style.setProperty("--swipe-amount-y",`${ir.y}px`)}},Le&&!p.jsx?Q.createElement("button",{"aria-label":G,"data-disabled":Te,"data-close-button":!0,onClick:Te||!Ze?()=>{}:()=>{var Ie;bt(),(Ie=p.onDismiss)==null||Ie.call(p,p)},className:oo(K==null?void 0:K.closeButton,(i=p==null?void 0:p.classNames)==null?void 0:i.closeButton)},(a=Z==null?void 0:Z.close)!=null?a:QQ):null,p.jsx||y.isValidElement(p.title)?p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title:Q.createElement(Q.Fragment,null,ut||p.icon||p.promise?Q.createElement("div",{"data-icon":"",className:oo(K==null?void 0:K.icon,(o=p==null?void 0:p.classNames)==null?void 0:o.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||$e():null,p.type!=="loading"?p.icon||(Z==null?void 0:Z[ut])||HQ(ut):null):null,Q.createElement("div",{"data-content":"",className:oo(K==null?void 0:K.content,(l=p==null?void 0:p.classNames)==null?void 0:l.content)},Q.createElement("div",{"data-title":"",className:oo(K==null?void 0:K.title,(c=p==null?void 0:p.classNames)==null?void 0:c.title)},typeof p.title=="function"?p.title():p.title),p.description?Q.createElement("div",{"data-description":"",className:oo(D,lr,K==null?void 0:K.description,(d=p==null?void 0:p.classNames)==null?void 0:d.description)},typeof p.description=="function"?p.description():p.description):null),y.isValidElement(p.cancel)?p.cancel:p.cancel&&Ux(p.cancel)?Q.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||$,onClick:Ie=>{var Ue,dt;Ux(p.cancel)&&Ze&&((dt=(Ue=p.cancel).onClick)==null||dt.call(Ue,Ie),bt())},className:oo(K==null?void 0:K.cancelButton,(u=p==null?void 0:p.classNames)==null?void 0:u.cancelButton)},p.cancel.label):null,y.isValidElement(p.action)?p.action:p.action&&Ux(p.action)?Q.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||R,onClick:Ie=>{var Ue,dt;Ux(p.action)&&((dt=(Ue=p.action).onClick)==null||dt.call(Ue,Ie),!Ie.defaultPrevented&&bt())},className:oo(K==null?void 0:K.actionButton,(h=p==null?void 0:p.classNames)==null?void 0:h.actionButton)},p.action.label):null))};function UP(){if(typeof window=="undefined"||typeof document=="undefined")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function vee(e,t){let r={};return[e,t].forEach((n,i)=>{let a=i===1,o=a?"--mobile-offset":"--offset",l=a?dee:cee;function c(d){["top","right","bottom","left"].forEach(u=>{r[`${o}-${u}`]=typeof d=="number"?`${d}px`:d})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(d=>{n[d]===void 0?r[`${o}-${d}`]=l:r[`${o}-${d}`]=typeof n[d]=="number"?`${n[d]}px`:n[d]}):c(l)}),r}var xee=y.forwardRef(function(e,t){let{invert:r,position:n="bottom-right",hotkey:i=["altKey","KeyT"],expand:a,closeButton:o,className:l,offset:c,mobileOffset:d,theme:u="light",richColors:h,duration:f,style:p,visibleToasts:x=lee,toastOptions:g,dir:v=UP(),gap:_=fee,loadingIcon:w,icons:b,containerAriaLabel:N="Notifications",pauseWhenPageIsHidden:S}=e,[k,O]=Q.useState([]),A=Q.useMemo(()=>Array.from(new Set([n].concat(k.filter(X=>X.position).map(X=>X.position)))),[k,n]),[T,$]=Q.useState([]),[R,F]=Q.useState(!1),[D,B]=Q.useState(!1),[U,V]=Q.useState(u!=="system"?u:typeof window!="undefined"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Y=Q.useRef(null),z=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),K=Q.useRef(null),Z=Q.useRef(!1),G=Q.useCallback(X=>{O(te=>{var se;return(se=te.find(ue=>ue.id===X.id))!=null&&se.delete||Wi.dismiss(X.id),te.filter(({id:ue})=>ue!==X.id)})},[]);return Q.useEffect(()=>Wi.subscribe(X=>{if(X.dismiss){O(te=>te.map(se=>se.id===X.id?W(M({},se),{delete:!0}):se));return}setTimeout(()=>{Nh.flushSync(()=>{O(te=>{let se=te.findIndex(ue=>ue.id===X.id);return se!==-1?[...te.slice(0,se),M(M({},te[se]),X),...te.slice(se+1)]:[X,...te]})})})}),[]),Q.useEffect(()=>{if(u!=="system"){V(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?V("dark"):V("light")),typeof window=="undefined")return;let X=window.matchMedia("(prefers-color-scheme: dark)");try{X.addEventListener("change",({matches:te})=>{V(te?"dark":"light")})}catch(te){X.addListener(({matches:se})=>{try{V(se?"dark":"light")}catch(ue){console.error(ue)}})}},[u]),Q.useEffect(()=>{k.length<=1&&F(!1)},[k]),Q.useEffect(()=>{let X=te=>{var se,ue;i.every(ye=>te[ye]||te.code===ye)&&(F(!0),(se=Y.current)==null||se.focus()),te.code==="Escape"&&(document.activeElement===Y.current||(ue=Y.current)!=null&&ue.contains(document.activeElement))&&F(!1)};return document.addEventListener("keydown",X),()=>document.removeEventListener("keydown",X)},[i]),Q.useEffect(()=>{if(Y.current)return()=>{K.current&&(K.current.focus({preventScroll:!0}),K.current=null,Z.current=!1)}},[Y.current]),Q.createElement("section",{ref:t,"aria-label":`${N} ${z}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},A.map((X,te)=>{var se;let[ue,ye]=X.split("-");return k.length?Q.createElement("ol",{key:X,dir:v==="auto"?UP():v,tabIndex:-1,ref:Y,className:l,"data-sonner-toaster":!0,"data-theme":U,"data-y-position":ue,"data-lifted":R&&k.length>1&&!a,"data-x-position":ye,style:M(M({"--front-toast-height":`${((se=T[0])==null?void 0:se.height)||0}px`,"--width":`${uee}px`,"--gap":`${_}px`},p),vee(c,d)),onBlur:ne=>{Z.current&&!ne.currentTarget.contains(ne.relatedTarget)&&(Z.current=!1,K.current&&(K.current.focus({preventScroll:!0}),K.current=null))},onFocus:ne=>{ne.target instanceof HTMLElement&&ne.target.dataset.dismissible==="false"||Z.current||(Z.current=!0,K.current=ne.relatedTarget)},onMouseEnter:()=>F(!0),onMouseMove:()=>F(!0),onMouseLeave:()=>{D||F(!1)},onDragEnd:()=>F(!1),onPointerDown:ne=>{ne.target instanceof HTMLElement&&ne.target.dataset.dismissible==="false"||B(!0)},onPointerUp:()=>B(!1)},k.filter(ne=>!ne.position&&te===0||ne.position===X).map((ne,xe)=>{var ge,ie;return Q.createElement(gee,{key:ne.id,icons:b,index:xe,toast:ne,defaultRichColors:h,duration:(ge=g==null?void 0:g.duration)!=null?ge:f,className:g==null?void 0:g.className,descriptionClassName:g==null?void 0:g.descriptionClassName,invert:r,visibleToasts:x,closeButton:(ie=g==null?void 0:g.closeButton)!=null?ie:o,interacting:D,position:X,style:g==null?void 0:g.style,unstyled:g==null?void 0:g.unstyled,classNames:g==null?void 0:g.classNames,cancelButtonStyle:g==null?void 0:g.cancelButtonStyle,actionButtonStyle:g==null?void 0:g.actionButtonStyle,removeToast:G,toasts:k.filter(ee=>ee.position==ne.position),heights:T.filter(ee=>ee.position==ne.position),setHeights:$,expandByDefault:a,gap:_,loadingIcon:w,expanded:R,pauseWhenPageIsHidden:S,swipeDirections:e.swipeDirections})})):null}))});const yee=t=>{var e=me(t,[]);const{theme:r="system"}=WQ();return s.jsx(xee,M({theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}}},e))};var _ee=J5[" useId ".trim().toString()]||(()=>{}),wee=0;function _s(e){const[t,r]=y.useState(_ee());return is(()=>{e||r(n=>n!=null?n:String(wee++))},[e]),e||(t?`radix-${t}`:"")}const bee=["top","right","bottom","left"],kd=Math.min,_a=Math.max,w2=Math.round,Bx=Math.floor,xl=e=>({x:e,y:e}),jee={left:"right",right:"left",bottom:"top",top:"bottom"},Nee={start:"end",end:"start"};function N3(e,t,r){return _a(e,kd(t,r))}function _c(e,t){return typeof e=="function"?e(t):e}function wc(e){return e.split("-")[0]}function Hm(e){return e.split("-")[1]}function Xk(e){return e==="x"?"y":"x"}function Jk(e){return e==="y"?"height":"width"}const See=new Set(["top","bottom"]);function ol(e){return See.has(wc(e))?"y":"x"}function Qk(e){return Xk(ol(e))}function kee(e,t,r){r===void 0&&(r=!1);const n=Hm(e),i=Qk(e),a=Jk(i);let o=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(o=b2(o)),[o,b2(o)]}function Eee(e){const t=b2(e);return[S3(e),t,S3(t)]}function S3(e){return e.replace(/start|end/g,t=>Nee[t])}const BP=["left","right"],zP=["right","left"],Cee=["top","bottom"],Pee=["bottom","top"];function Aee(e,t,r){switch(e){case"top":case"bottom":return r?t?zP:BP:t?BP:zP;case"left":case"right":return t?Cee:Pee;default:return[]}}function Tee(e,t,r,n){const i=Hm(e);let a=Aee(wc(e),r==="start",n);return i&&(a=a.map(o=>o+"-"+i),t&&(a=a.concat(a.map(S3)))),a}function b2(e){return e.replace(/left|right|bottom|top/g,t=>jee[t])}function Oee(e){return M({top:0,right:0,bottom:0,left:0},e)}function pI(e){return typeof e!="number"?Oee(e):{top:e,right:e,bottom:e,left:e}}function j2(e){const{x:t,y:r,width:n,height:i}=e;return{width:n,height:i,top:r,left:t,right:t+n,bottom:r+i,x:t,y:r}}function VP(e,t,r){let{reference:n,floating:i}=e;const a=ol(t),o=Qk(t),l=Jk(o),c=wc(t),d=a==="y",u=n.x+n.width/2-i.width/2,h=n.y+n.height/2-i.height/2,f=n[l]/2-i[l]/2;let p;switch(c){case"top":p={x:u,y:n.y-i.height};break;case"bottom":p={x:u,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:h};break;case"left":p={x:n.x-i.width,y:h};break;default:p={x:n.x,y:n.y}}switch(Hm(t)){case"start":p[o]-=f*(r&&d?-1:1);break;case"end":p[o]+=f*(r&&d?-1:1);break}return p}const Ree=(e,t,r)=>E(void 0,null,function*(){const{placement:n="bottom",strategy:i="absolute",middleware:a=[],platform:o}=r,l=a.filter(Boolean),c=yield o.isRTL==null?void 0:o.isRTL(t);let d=yield o.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:h}=VP(d,n,c),f=n,p={},x=0;for(let g=0;g<l.length;g++){const{name:v,fn:_}=l[g],{x:w,y:b,data:N,reset:S}=yield _({x:u,y:h,initialPlacement:n,placement:f,strategy:i,middlewareData:p,rects:d,platform:o,elements:{reference:e,floating:t}});u=w!=null?w:u,h=b!=null?b:h,p=W(M({},p),{[v]:M(M({},p[v]),N)}),S&&x<=50&&(x++,typeof S=="object"&&(S.placement&&(f=S.placement),S.rects&&(d=S.rects===!0?yield o.getElementRects({reference:e,floating:t,strategy:i}):S.rects),{x:u,y:h}=VP(d,f,c)),g=-1)}return{x:u,y:h,placement:f,strategy:i,middlewareData:p}});function lg(e,t){return E(this,null,function*(){var r;t===void 0&&(t={});const{x:n,y:i,platform:a,rects:o,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:f=!1,padding:p=0}=_c(t,e),x=pI(p),v=l[f?h==="floating"?"reference":"floating":h],_=j2(yield a.getClippingRect({element:(r=yield a.isElement==null?void 0:a.isElement(v))==null||r?v:v.contextElement||(yield a.getDocumentElement==null?void 0:a.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:c})),w=h==="floating"?{x:n,y:i,width:o.floating.width,height:o.floating.height}:o.reference,b=yield a.getOffsetParent==null?void 0:a.getOffsetParent(l.floating),N=(yield a.isElement==null?void 0:a.isElement(b))?(yield a.getScale==null?void 0:a.getScale(b))||{x:1,y:1}:{x:1,y:1},S=j2(a.convertOffsetParentRelativeRectToViewportRelativeRect?yield a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:w,offsetParent:b,strategy:c}):w);return{top:(_.top-S.top+x.top)/N.y,bottom:(S.bottom-_.bottom+x.bottom)/N.y,left:(_.left-S.left+x.left)/N.x,right:(S.right-_.right+x.right)/N.x}})}const Mee=e=>({name:"arrow",options:e,fn(r){return E(this,null,function*(){const{x:n,y:i,placement:a,rects:o,platform:l,elements:c,middlewareData:d}=r,{element:u,padding:h=0}=_c(e,r)||{};if(u==null)return{};const f=pI(h),p={x:n,y:i},x=Qk(a),g=Jk(x),v=yield l.getDimensions(u),_=x==="y",w=_?"top":"left",b=_?"bottom":"right",N=_?"clientHeight":"clientWidth",S=o.reference[g]+o.reference[x]-p[x]-o.floating[g],k=p[x]-o.reference[x],O=yield l.getOffsetParent==null?void 0:l.getOffsetParent(u);let A=O?O[N]:0;(!A||!(yield l.isElement==null?void 0:l.isElement(O)))&&(A=c.floating[N]||o.floating[g]);const T=S/2-k/2,$=A/2-v[g]/2-1,R=kd(f[w],$),F=kd(f[b],$),D=R,B=A-v[g]-F,U=A/2-v[g]/2+T,V=N3(D,U,B),Y=!d.arrow&&Hm(a)!=null&&U!==V&&o.reference[g]/2-(U<D?R:F)-v[g]/2<0,z=Y?U<D?U-D:U-B:0;return{[x]:p[x]+z,data:M({[x]:V,centerOffset:U-V-z},Y&&{alignmentOffset:z}),reset:Y}})}}),Dee=function(e){return e===void 0&&(e={}),{name:"flip",options:e,fn(r){return E(this,null,function*(){var n,i;const{placement:a,middlewareData:o,rects:l,initialPlacement:c,platform:d,elements:u}=r,U=_c(e,r),{mainAxis:h=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:x="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:v=!0}=U,_=me(U,["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"]);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const w=wc(a),b=ol(c),N=wc(c)===c,S=yield d.isRTL==null?void 0:d.isRTL(u.floating),k=p||(N||!v?[b2(c)]:Eee(c)),O=g!=="none";!p&&O&&k.push(...Tee(c,v,g,S));const A=[c,...k],T=yield lg(r,_),$=[];let R=((i=o.flip)==null?void 0:i.overflows)||[];if(h&&$.push(T[w]),f){const V=kee(a,l,S);$.push(T[V[0]],T[V[1]])}if(R=[...R,{placement:a,overflows:$}],!$.every(V=>V<=0)){var F,D;const V=(((F=o.flip)==null?void 0:F.index)||0)+1,Y=A[V];if(Y&&(!(f==="alignment"?b!==ol(Y):!1)||R.every(Z=>Z.overflows[0]>0&&ol(Z.placement)===b)))return{data:{index:V,overflows:R},reset:{placement:Y}};let z=(D=R.filter(K=>K.overflows[0]<=0).sort((K,Z)=>K.overflows[1]-Z.overflows[1])[0])==null?void 0:D.placement;if(!z)switch(x){case"bestFit":{var B;const K=(B=R.filter(Z=>{if(O){const G=ol(Z.placement);return G===b||G==="y"}return!0}).map(Z=>[Z.placement,Z.overflows.filter(G=>G>0).reduce((G,X)=>G+X,0)]).sort((Z,G)=>Z[1]-G[1])[0])==null?void 0:B[0];K&&(z=K);break}case"initialPlacement":z=c;break}if(a!==z)return{reset:{placement:z}}}return{}})}}};function qP(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function WP(e){return bee.some(t=>e[t]>=0)}const Iee=function(e){return e===void 0&&(e={}),{name:"hide",options:e,fn(r){return E(this,null,function*(){const{rects:n}=r,o=_c(e,r),{strategy:i="referenceHidden"}=o,a=me(o,["strategy"]);switch(i){case"referenceHidden":{const l=yield lg(r,W(M({},a),{elementContext:"reference"})),c=qP(l,n.reference);return{data:{referenceHiddenOffsets:c,referenceHidden:WP(c)}}}case"escaped":{const l=yield lg(r,W(M({},a),{altBoundary:!0})),c=qP(l,n.floating);return{data:{escapedOffsets:c,escaped:WP(c)}}}default:return{}}})}}},gI=new Set(["left","top"]);function $ee(e,t){return E(this,null,function*(){const{placement:r,platform:n,elements:i}=e,a=yield n.isRTL==null?void 0:n.isRTL(i.floating),o=wc(r),l=Hm(r),c=ol(r)==="y",d=gI.has(o)?-1:1,u=a&&c?-1:1,h=_c(t,e);let{mainAxis:f,crossAxis:p,alignmentAxis:x}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof x=="number"&&(p=l==="end"?x*-1:x),c?{x:p*u,y:f*d}:{x:f*d,y:p*u}})}const Lee=function(e){return e===void 0&&(e=0),{name:"offset",options:e,fn(r){return E(this,null,function*(){var n,i;const{x:a,y:o,placement:l,middlewareData:c}=r,d=yield $ee(r,e);return l===((n=c.offset)==null?void 0:n.placement)&&(i=c.arrow)!=null&&i.alignmentOffset?{}:{x:a+d.x,y:o+d.y,data:W(M({},d),{placement:l})}})}}},Fee=function(e){return e===void 0&&(e={}),{name:"shift",options:e,fn(r){return E(this,null,function*(){const{x:n,y:i,placement:a}=r,_=_c(e,r),{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:w=>{let{x:b,y:N}=w;return{x:b,y:N}}}}=_,d=me(_,["mainAxis","crossAxis","limiter"]),u={x:n,y:i},h=yield lg(r,d),f=ol(wc(a)),p=Xk(f);let x=u[p],g=u[f];if(o){const w=p==="y"?"top":"left",b=p==="y"?"bottom":"right",N=x+h[w],S=x-h[b];x=N3(N,x,S)}if(l){const w=f==="y"?"top":"left",b=f==="y"?"bottom":"right",N=g+h[w],S=g-h[b];g=N3(N,g,S)}const v=c.fn(W(M({},r),{[p]:x,[f]:g}));return W(M({},v),{data:{x:v.x-n,y:v.y-i,enabled:{[p]:o,[f]:l}}})})}}},Uee=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:i,rects:a,middlewareData:o}=t,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=_c(e,t),u={x:r,y:n},h=ol(i),f=Xk(h);let p=u[f],x=u[h];const g=_c(l,t),v=typeof g=="number"?{mainAxis:g,crossAxis:0}:M({mainAxis:0,crossAxis:0},g);if(c){const b=f==="y"?"height":"width",N=a.reference[f]-a.floating[b]+v.mainAxis,S=a.reference[f]+a.reference[b]-v.mainAxis;p<N?p=N:p>S&&(p=S)}if(d){var _,w;const b=f==="y"?"width":"height",N=gI.has(wc(i)),S=a.reference[h]-a.floating[b]+(N&&((_=o.offset)==null?void 0:_[h])||0)+(N?0:v.crossAxis),k=a.reference[h]+a.reference[b]+(N?0:((w=o.offset)==null?void 0:w[h])||0)-(N?v.crossAxis:0);x<S?x=S:x>k&&(x=k)}return{[f]:p,[h]:x}}}},Bee=function(e){return e===void 0&&(e={}),{name:"size",options:e,fn(r){return E(this,null,function*(){var n,i;const{placement:a,rects:o,platform:l,elements:c}=r,R=_c(e,r),{apply:d=()=>{}}=R,u=me(R,["apply"]),h=yield lg(r,u),f=wc(a),p=Hm(a),x=ol(a)==="y",{width:g,height:v}=o.floating;let _,w;f==="top"||f==="bottom"?(_=f,w=p===((yield l.isRTL==null?void 0:l.isRTL(c.floating))?"start":"end")?"left":"right"):(w=f,_=p==="end"?"top":"bottom");const b=v-h.top-h.bottom,N=g-h.left-h.right,S=kd(v-h[_],b),k=kd(g-h[w],N),O=!r.middlewareData.shift;let A=S,T=k;if((n=r.middlewareData.shift)!=null&&n.enabled.x&&(T=N),(i=r.middlewareData.shift)!=null&&i.enabled.y&&(A=b),O&&!p){const F=_a(h.left,0),D=_a(h.right,0),B=_a(h.top,0),U=_a(h.bottom,0);x?T=g-2*(F!==0||D!==0?F+D:_a(h.left,h.right)):A=v-2*(B!==0||U!==0?B+U:_a(h.top,h.bottom))}yield d(W(M({},r),{availableWidth:T,availableHeight:A}));const $=yield l.getDimensions(c.floating);return g!==$.width||v!==$.height?{reset:{rects:!0}}:{}})}}};function yw(){return typeof window!="undefined"}function Gm(e){return vI(e)?(e.nodeName||"").toLowerCase():"#document"}function ka(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function El(e){var t;return(t=(vI(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function vI(e){return yw()?e instanceof Node||e instanceof ka(e).Node:!1}function Mo(e){return yw()?e instanceof Element||e instanceof ka(e).Element:!1}function jl(e){return yw()?e instanceof HTMLElement||e instanceof ka(e).HTMLElement:!1}function HP(e){return!yw()||typeof ShadowRoot=="undefined"?!1:e instanceof ShadowRoot||e instanceof ka(e).ShadowRoot}const zee=new Set(["inline","contents"]);function _v(e){const{overflow:t,overflowX:r,overflowY:n,display:i}=Do(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!zee.has(i)}const Vee=new Set(["table","td","th"]);function qee(e){return Vee.has(Gm(e))}const Wee=[":popover-open",":modal"];function _w(e){return Wee.some(t=>{try{return e.matches(t)}catch(r){return!1}})}const Hee=["transform","translate","scale","rotate","perspective"],Gee=["transform","translate","scale","rotate","perspective","filter"],Yee=["paint","layout","strict","content"];function eE(e){const t=tE(),r=Mo(e)?Do(e):e;return Hee.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||Gee.some(n=>(r.willChange||"").includes(n))||Yee.some(n=>(r.contain||"").includes(n))}function Kee(e){let t=Ed(e);for(;jl(t)&&!Qh(t);){if(eE(t))return t;if(_w(t))return null;t=Ed(t)}return null}function tE(){return typeof CSS=="undefined"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Zee=new Set(["html","body","#document"]);function Qh(e){return Zee.has(Gm(e))}function Do(e){return ka(e).getComputedStyle(e)}function ww(e){return Mo(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ed(e){if(Gm(e)==="html")return e;const t=e.assignedSlot||e.parentNode||HP(e)&&e.host||El(e);return HP(t)?t.host:t}function xI(e){const t=Ed(e);return Qh(t)?e.ownerDocument?e.ownerDocument.body:e.body:jl(t)&&_v(t)?t:xI(t)}function cg(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const i=xI(e),a=i===((n=e.ownerDocument)==null?void 0:n.body),o=ka(i);if(a){const l=k3(o);return t.concat(o,o.visualViewport||[],_v(i)?i:[],l&&r?cg(l):[])}return t.concat(i,cg(i,[],r))}function k3(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function yI(e){const t=Do(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const i=jl(e),a=i?e.offsetWidth:r,o=i?e.offsetHeight:n,l=w2(r)!==a||w2(n)!==o;return l&&(r=a,n=o),{width:r,height:n,$:l}}function rE(e){return Mo(e)?e:e.contextElement}function kh(e){const t=rE(e);if(!jl(t))return xl(1);const r=t.getBoundingClientRect(),{width:n,height:i,$:a}=yI(t);let o=(a?w2(r.width):r.width)/n,l=(a?w2(r.height):r.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const Xee=xl(0);function _I(e){const t=ka(e);return!tE()||!t.visualViewport?Xee:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Jee(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==ka(e)?!1:t}function qu(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const i=e.getBoundingClientRect(),a=rE(e);let o=xl(1);t&&(n?Mo(n)&&(o=kh(n)):o=kh(e));const l=Jee(a,r,n)?_I(a):xl(0);let c=(i.left+l.x)/o.x,d=(i.top+l.y)/o.y,u=i.width/o.x,h=i.height/o.y;if(a){const f=ka(a),p=n&&Mo(n)?ka(n):n;let x=f,g=k3(x);for(;g&&n&&p!==x;){const v=kh(g),_=g.getBoundingClientRect(),w=Do(g),b=_.left+(g.clientLeft+parseFloat(w.paddingLeft))*v.x,N=_.top+(g.clientTop+parseFloat(w.paddingTop))*v.y;c*=v.x,d*=v.y,u*=v.x,h*=v.y,c+=b,d+=N,x=ka(g),g=k3(x)}}return j2({width:u,height:h,x:c,y:d})}function nE(e,t){const r=ww(e).scrollLeft;return t?t.left+r:qu(El(e)).left+r}function wI(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),i=n.left+t.scrollLeft-(r?0:nE(e,n)),a=n.top+t.scrollTop;return{x:i,y:a}}function Qee(e){let{elements:t,rect:r,offsetParent:n,strategy:i}=e;const a=i==="fixed",o=El(n),l=t?_w(t.floating):!1;if(n===o||l&&a)return r;let c={scrollLeft:0,scrollTop:0},d=xl(1);const u=xl(0),h=jl(n);if((h||!h&&!a)&&((Gm(n)!=="body"||_v(o))&&(c=ww(n)),jl(n))){const p=qu(n);d=kh(n),u.x=p.x+n.clientLeft,u.y=p.y+n.clientTop}const f=o&&!h&&!a?wI(o,c,!0):xl(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-c.scrollLeft*d.x+u.x+f.x,y:r.y*d.y-c.scrollTop*d.y+u.y+f.y}}function ete(e){return Array.from(e.getClientRects())}function tte(e){const t=El(e),r=ww(e),n=e.ownerDocument.body,i=_a(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),a=_a(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+nE(e);const l=-r.scrollTop;return Do(n).direction==="rtl"&&(o+=_a(t.clientWidth,n.clientWidth)-i),{width:i,height:a,x:o,y:l}}function rte(e,t){const r=ka(e),n=El(e),i=r.visualViewport;let a=n.clientWidth,o=n.clientHeight,l=0,c=0;if(i){a=i.width,o=i.height;const d=tE();(!d||d&&t==="fixed")&&(l=i.offsetLeft,c=i.offsetTop)}return{width:a,height:o,x:l,y:c}}const nte=new Set(["absolute","fixed"]);function ste(e,t){const r=qu(e,!0,t==="fixed"),n=r.top+e.clientTop,i=r.left+e.clientLeft,a=jl(e)?kh(e):xl(1),o=e.clientWidth*a.x,l=e.clientHeight*a.y,c=i*a.x,d=n*a.y;return{width:o,height:l,x:c,y:d}}function GP(e,t,r){let n;if(t==="viewport")n=rte(e,r);else if(t==="document")n=tte(El(e));else if(Mo(t))n=ste(t,r);else{const i=_I(e);n={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return j2(n)}function bI(e,t){const r=Ed(e);return r===t||!Mo(r)||Qh(r)?!1:Do(r).position==="fixed"||bI(r,t)}function ite(e,t){const r=t.get(e);if(r)return r;let n=cg(e,[],!1).filter(l=>Mo(l)&&Gm(l)!=="body"),i=null;const a=Do(e).position==="fixed";let o=a?Ed(e):e;for(;Mo(o)&&!Qh(o);){const l=Do(o),c=eE(o);!c&&l.position==="fixed"&&(i=null),(a?!c&&!i:!c&&l.position==="static"&&!!i&&nte.has(i.position)||_v(o)&&!c&&bI(e,o))?n=n.filter(u=>u!==o):i=l,o=Ed(o)}return t.set(e,n),n}function ate(e){let{element:t,boundary:r,rootBoundary:n,strategy:i}=e;const o=[...r==="clippingAncestors"?_w(t)?[]:ite(t,this._c):[].concat(r),n],l=o[0],c=o.reduce((d,u)=>{const h=GP(t,u,i);return d.top=_a(h.top,d.top),d.right=kd(h.right,d.right),d.bottom=kd(h.bottom,d.bottom),d.left=_a(h.left,d.left),d},GP(t,l,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function ote(e){const{width:t,height:r}=yI(e);return{width:t,height:r}}function lte(e,t,r){const n=jl(t),i=El(t),a=r==="fixed",o=qu(e,!0,a,t);let l={scrollLeft:0,scrollTop:0};const c=xl(0);function d(){c.x=nE(i)}if(n||!n&&!a)if((Gm(t)!=="body"||_v(i))&&(l=ww(t)),n){const p=qu(t,!0,a,t);c.x=p.x+t.clientLeft,c.y=p.y+t.clientTop}else i&&d();a&&!n&&i&&d();const u=i&&!n&&!a?wI(i,l):xl(0),h=o.left+l.scrollLeft-c.x-u.x,f=o.top+l.scrollTop-c.y-u.y;return{x:h,y:f,width:o.width,height:o.height}}function Qb(e){return Do(e).position==="static"}function YP(e,t){if(!jl(e)||Do(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return El(e)===r&&(r=r.ownerDocument.body),r}function jI(e,t){const r=ka(e);if(_w(e))return r;if(!jl(e)){let i=Ed(e);for(;i&&!Qh(i);){if(Mo(i)&&!Qb(i))return i;i=Ed(i)}return r}let n=YP(e,t);for(;n&&qee(n)&&Qb(n);)n=YP(n,t);return n&&Qh(n)&&Qb(n)&&!eE(n)?r:n||Kee(e)||r}const cte=function(e){return E(this,null,function*(){const t=this.getOffsetParent||jI,r=this.getDimensions,n=yield r(e.floating);return{reference:lte(e.reference,yield t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}})};function dte(e){return Do(e).direction==="rtl"}const ute={convertOffsetParentRelativeRectToViewportRelativeRect:Qee,getDocumentElement:El,getClippingRect:ate,getOffsetParent:jI,getElementRects:cte,getClientRects:ete,getDimensions:ote,getScale:kh,isElement:Mo,isRTL:dte};function NI(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function fte(e,t){let r=null,n;const i=El(e);function a(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),a();const d=e.getBoundingClientRect(),{left:u,top:h,width:f,height:p}=d;if(l||t(),!f||!p)return;const x=Bx(h),g=Bx(i.clientWidth-(u+f)),v=Bx(i.clientHeight-(h+p)),_=Bx(u),b={rootMargin:-x+"px "+-g+"px "+-v+"px "+-_+"px",threshold:_a(0,kd(1,c))||1};let N=!0;function S(k){const O=k[0].intersectionRatio;if(O!==c){if(!N)return o();O?o(!1,O):n=setTimeout(()=>{o(!1,1e-7)},1e3)}O===1&&!NI(d,e.getBoundingClientRect())&&o(),N=!1}try{r=new IntersectionObserver(S,W(M({},b),{root:i.ownerDocument}))}catch(k){r=new IntersectionObserver(S,b)}r.observe(e)}return o(!0),a}function hte(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:a=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,d=rE(e),u=i||a?[...d?cg(d):[],...cg(t)]:[];u.forEach(_=>{i&&_.addEventListener("scroll",r,{passive:!0}),a&&_.addEventListener("resize",r)});const h=d&&l?fte(d,r):null;let f=-1,p=null;o&&(p=new ResizeObserver(_=>{let[w]=_;w&&w.target===d&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var b;(b=p)==null||b.observe(t)})),r()}),d&&!c&&p.observe(d),p.observe(t));let x,g=c?qu(e):null;c&&v();function v(){const _=qu(e);g&&!NI(g,_)&&r(),g=_,x=requestAnimationFrame(v)}return r(),()=>{var _;u.forEach(w=>{i&&w.removeEventListener("scroll",r),a&&w.removeEventListener("resize",r)}),h==null||h(),(_=p)==null||_.disconnect(),p=null,c&&cancelAnimationFrame(x)}}const mte=Lee,pte=Fee,gte=Dee,vte=Bee,xte=Iee,KP=Mee,yte=Uee,_te=(e,t,r)=>{const n=new Map,i=M({platform:ute},r),a=W(M({},i.platform),{_c:n});return Ree(e,t,W(M({},i),{platform:a}))};var wte=typeof document!="undefined",bte=function(){},Ly=wte?y.useLayoutEffect:bte;function N2(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!N2(e[n],t[n]))return!1;return!0}if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){const a=i[n];if(!(a==="_owner"&&e.$$typeof)&&!N2(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function SI(e){return typeof window=="undefined"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ZP(e,t){const r=SI(e);return Math.round(t*r)/r}function ej(e){const t=y.useRef(e);return Ly(()=>{t.current=e}),t}function jte(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:a,floating:o}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[u,h]=y.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=y.useState(n);N2(f,n)||p(n);const[x,g]=y.useState(null),[v,_]=y.useState(null),w=y.useCallback(z=>{z!==k.current&&(k.current=z,g(z))},[]),b=y.useCallback(z=>{z!==O.current&&(O.current=z,_(z))},[]),N=a||x,S=o||v,k=y.useRef(null),O=y.useRef(null),A=y.useRef(u),T=c!=null,$=ej(c),R=ej(i),F=ej(d),D=y.useCallback(()=>{if(!k.current||!O.current)return;const z={placement:t,strategy:r,middleware:f};R.current&&(z.platform=R.current),_te(k.current,O.current,z).then(K=>{const Z=W(M({},K),{isPositioned:F.current!==!1});B.current&&!N2(A.current,Z)&&(A.current=Z,Ya.flushSync(()=>{h(Z)}))})},[f,t,r,R,F]);Ly(()=>{d===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,h(z=>W(M({},z),{isPositioned:!1})))},[d]);const B=y.useRef(!1);Ly(()=>(B.current=!0,()=>{B.current=!1}),[]),Ly(()=>{if(N&&(k.current=N),S&&(O.current=S),N&&S){if($.current)return $.current(N,S,D);D()}},[N,S,D,$,T]);const U=y.useMemo(()=>({reference:k,floating:O,setReference:w,setFloating:b}),[w,b]),V=y.useMemo(()=>({reference:N,floating:S}),[N,S]),Y=y.useMemo(()=>{const z={position:r,left:0,top:0};if(!V.floating)return z;const K=ZP(V.floating,u.x),Z=ZP(V.floating,u.y);return l?M(W(M({},z),{transform:"translate("+K+"px, "+Z+"px)"}),SI(V.floating)>=1.5&&{willChange:"transform"}):{position:r,left:K,top:Z}},[r,l,V.floating,u.x,u.y]);return y.useMemo(()=>W(M({},u),{update:D,refs:U,elements:V,floatingStyles:Y}),[u,D,U,V,Y])}const Nte=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:i}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?KP({element:n.current,padding:i}).fn(r):{}:n?KP({element:n,padding:i}).fn(r):{}}}},Ste=(e,t)=>W(M({},mte(e)),{options:[e,t]}),kte=(e,t)=>W(M({},pte(e)),{options:[e,t]}),Ete=(e,t)=>W(M({},yte(e)),{options:[e,t]}),Cte=(e,t)=>W(M({},gte(e)),{options:[e,t]}),Pte=(e,t)=>W(M({},vte(e)),{options:[e,t]}),Ate=(e,t)=>W(M({},xte(e)),{options:[e,t]}),Tte=(e,t)=>W(M({},Nte(e)),{options:[e,t]});var Ote="Arrow",kI=y.forwardRef((e,t)=>{const o=e,{children:r,width:n=10,height:i=5}=o,a=me(o,["children","width","height"]);return s.jsx(Nt.svg,W(M({},a),{ref:t,width:n,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:s.jsx("polygon",{points:"0,0 30,0 15,10"})}))});kI.displayName=Ote;var Rte=kI;function bw(e){const[t,r]=y.useState(void 0);return is(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const a=i[0];let o,l;if("borderBoxSize"in a){const c=a.borderBoxSize,d=Array.isArray(c)?c[0]:c;o=d.inlineSize,l=d.blockSize}else o=e.offsetWidth,l=e.offsetHeight;r({width:o,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var sE="Popper",[EI,Rd]=js(sE),[Mte,CI]=EI(sE),PI=e=>{const{__scopePopper:t,children:r}=e,[n,i]=y.useState(null);return s.jsx(Mte,{scope:t,anchor:n,onAnchorChange:i,children:r})};PI.displayName=sE;var AI="PopperAnchor",TI=y.forwardRef((e,t)=>{const c=e,{__scopePopper:r,virtualRef:n}=c,i=me(c,["__scopePopper","virtualRef"]),a=CI(AI,r),o=y.useRef(null),l=sr(t,o);return y.useEffect(()=>{a.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:s.jsx(Nt.div,W(M({},i),{ref:l}))});TI.displayName=AI;var iE="PopperContent",[Dte,Ite]=EI(iE),OI=y.forwardRef((e,t)=>{var xe,ge,ie,ee,H,le,Se,ae;const ne=e,{__scopePopper:r,side:n="bottom",sideOffset:i=0,align:a="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:x}=ne,g=me(ne,["__scopePopper","side","sideOffset","align","alignOffset","arrowPadding","avoidCollisions","collisionBoundary","collisionPadding","sticky","hideWhenDetached","updatePositionStrategy","onPlaced"]),v=CI(iE,r),[_,w]=y.useState(null),b=sr(t,fe=>w(fe)),[N,S]=y.useState(null),k=bw(N),O=(xe=k==null?void 0:k.width)!=null?xe:0,A=(ge=k==null?void 0:k.height)!=null?ge:0,T=n+(a!=="center"?"-"+a:""),$=typeof u=="number"?u:M({top:0,right:0,bottom:0,left:0},u),R=Array.isArray(d)?d:[d],F=R.length>0,D={padding:$,boundary:R.filter(Lte),altBoundary:F},{refs:B,floatingStyles:U,placement:V,isPositioned:Y,middlewareData:z}=jte({strategy:"fixed",placement:T,whileElementsMounted:(...fe)=>hte(...fe,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[Ste({mainAxis:i+A,alignmentAxis:o}),c&&kte(M({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?Ete():void 0},D)),c&&Cte(M({},D)),Pte(W(M({},D),{apply:({elements:fe,rects:he,availableWidth:pe,availableHeight:Ae})=>{const{width:qe,height:Fe}=he.reference,ve=fe.floating.style;ve.setProperty("--radix-popper-available-width",`${pe}px`),ve.setProperty("--radix-popper-available-height",`${Ae}px`),ve.setProperty("--radix-popper-anchor-width",`${qe}px`),ve.setProperty("--radix-popper-anchor-height",`${Fe}px`)}})),N&&Tte({element:N,padding:l}),Fte({arrowWidth:O,arrowHeight:A}),f&&Ate(M({strategy:"referenceHidden"},D))]}),[K,Z]=DI(V),G=ss(x);is(()=>{Y&&(G==null||G())},[Y,G]);const X=(ie=z.arrow)==null?void 0:ie.x,te=(ee=z.arrow)==null?void 0:ee.y,se=((H=z.arrow)==null?void 0:H.centerOffset)!==0,[ue,ye]=y.useState();return is(()=>{_&&ye(window.getComputedStyle(_).zIndex)},[_]),s.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:M(W(M({},U),{transform:Y?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ue,"--radix-popper-transform-origin":[(le=z.transformOrigin)==null?void 0:le.x,(Se=z.transformOrigin)==null?void 0:Se.y].join(" ")}),((ae=z.hide)==null?void 0:ae.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}),dir:e.dir,children:s.jsx(Dte,{scope:r,placedSide:K,onArrowChange:S,arrowX:X,arrowY:te,shouldHideArrow:se,children:s.jsx(Nt.div,W(M({"data-side":K,"data-align":Z},g),{ref:b,style:W(M({},g.style),{animation:Y?void 0:"none"})}))})})});OI.displayName=iE;var RI="PopperArrow",$te={top:"bottom",right:"left",bottom:"top",left:"right"},MI=y.forwardRef(function(t,r){const l=t,{__scopePopper:n}=l,i=me(l,["__scopePopper"]),a=Ite(RI,n),o=$te[a.placedSide];return s.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:s.jsx(Rte,W(M({},i),{ref:r,style:W(M({},i.style),{display:"block"})}))})});MI.displayName=RI;function Lte(e){return e!==null}var Fte=e=>({name:"transformOrigin",options:e,fn(t){var v,_,w,b,N;const{placement:r,rects:n,middlewareData:i}=t,o=((v=i.arrow)==null?void 0:v.centerOffset)!==0,l=o?0:e.arrowWidth,c=o?0:e.arrowHeight,[d,u]=DI(r),h={start:"0%",center:"50%",end:"100%"}[u],f=((w=(_=i.arrow)==null?void 0:_.x)!=null?w:0)+l/2,p=((N=(b=i.arrow)==null?void 0:b.y)!=null?N:0)+c/2;let x="",g="";return d==="bottom"?(x=o?h:`${f}px`,g=`${-c}px`):d==="top"?(x=o?h:`${f}px`,g=`${n.floating.height+c}px`):d==="right"?(x=`${-c}px`,g=o?h:`${p}px`):d==="left"&&(x=`${n.floating.width+c}px`,g=o?h:`${p}px`),{data:{x,y:g}}}});function DI(e){const[t,r="center"]=e.split("-");return[t,r]}var jw=PI,wv=TI,Nw=OI,Sw=MI,[kw,cFe]=js("Tooltip",[Rd]),Ew=Rd(),II="TooltipProvider",Ute=700,E3="tooltip.open",[Bte,aE]=kw(II),$I=e=>{const{__scopeTooltip:t,delayDuration:r=Ute,skipDelayDuration:n=300,disableHoverableContent:i=!1,children:a}=e,o=y.useRef(!0),l=y.useRef(!1),c=y.useRef(0);return y.useEffect(()=>{const d=c.current;return()=>window.clearTimeout(d)},[]),s.jsx(Bte,{scope:t,isOpenDelayedRef:o,delayDuration:r,onOpen:y.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:y.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:y.useCallback(d=>{l.current=d},[]),disableHoverableContent:i,children:a})};$I.displayName=II;var dg="Tooltip",[zte,Cw]=kw(dg),LI=e=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:i,onOpenChange:a,disableHoverableContent:o,delayDuration:l}=e,c=aE(dg,e.__scopeTooltip),d=Ew(t),[u,h]=y.useState(null),f=_s(),p=y.useRef(0),x=o!=null?o:c.disableHoverableContent,g=l!=null?l:c.delayDuration,v=y.useRef(!1),[_,w]=Di({prop:n,defaultProp:i!=null?i:!1,onChange:O=>{O?(c.onOpen(),document.dispatchEvent(new CustomEvent(E3))):c.onClose(),a==null||a(O)},caller:dg}),b=y.useMemo(()=>_?v.current?"delayed-open":"instant-open":"closed",[_]),N=y.useCallback(()=>{window.clearTimeout(p.current),p.current=0,v.current=!1,w(!0)},[w]),S=y.useCallback(()=>{window.clearTimeout(p.current),p.current=0,w(!1)},[w]),k=y.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{v.current=!0,w(!0),p.current=0},g)},[g,w]);return y.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),s.jsx(jw,W(M({},d),{children:s.jsx(zte,{scope:t,contentId:f,open:_,stateAttribute:b,trigger:u,onTriggerChange:h,onTriggerEnter:y.useCallback(()=>{c.isOpenDelayedRef.current?k():N()},[c.isOpenDelayedRef,k,N]),onTriggerLeave:y.useCallback(()=>{x?S():(window.clearTimeout(p.current),p.current=0)},[S,x]),onOpen:N,onClose:S,disableHoverableContent:x,children:r})}))};LI.displayName=dg;var C3="TooltipTrigger",FI=y.forwardRef((e,t)=>{const f=e,{__scopeTooltip:r}=f,n=me(f,["__scopeTooltip"]),i=Cw(C3,r),a=aE(C3,r),o=Ew(r),l=y.useRef(null),c=sr(t,l,i.onTriggerChange),d=y.useRef(!1),u=y.useRef(!1),h=y.useCallback(()=>d.current=!1,[]);return y.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),s.jsx(wv,W(M({asChild:!0},o),{children:s.jsx(Nt.button,W(M({"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute},n),{ref:c,onPointerMove:mt(e.onPointerMove,p=>{p.pointerType!=="touch"&&!u.current&&!a.isPointerInTransitRef.current&&(i.onTriggerEnter(),u.current=!0)}),onPointerLeave:mt(e.onPointerLeave,()=>{i.onTriggerLeave(),u.current=!1}),onPointerDown:mt(e.onPointerDown,()=>{i.open&&i.onClose(),d.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:mt(e.onFocus,()=>{d.current||i.onOpen()}),onBlur:mt(e.onBlur,i.onClose),onClick:mt(e.onClick,i.onClose)}))}))});FI.displayName=C3;var Vte="TooltipPortal",[dFe,qte]=kw(Vte,{forceMount:void 0}),em="TooltipContent",UI=y.forwardRef((e,t)=>{const r=qte(em,e.__scopeTooltip),l=e,{forceMount:n=r.forceMount,side:i="top"}=l,a=me(l,["forceMount","side"]),o=Cw(em,e.__scopeTooltip);return s.jsx($s,{present:n||o.open,children:o.disableHoverableContent?s.jsx(BI,W(M({side:i},a),{ref:t})):s.jsx(Wte,W(M({side:i},a),{ref:t}))})}),Wte=y.forwardRef((e,t)=>{const r=Cw(em,e.__scopeTooltip),n=aE(em,e.__scopeTooltip),i=y.useRef(null),a=sr(t,i),[o,l]=y.useState(null),{trigger:c,onClose:d}=r,u=i.current,{onPointerInTransitChange:h}=n,f=y.useCallback(()=>{l(null),h(!1)},[h]),p=y.useCallback((x,g)=>{const v=x.currentTarget,_={x:x.clientX,y:x.clientY},w=Zte(_,v.getBoundingClientRect()),b=Xte(_,w),N=Jte(g.getBoundingClientRect()),S=ere([...b,...N]);l(S),h(!0)},[h]);return y.useEffect(()=>()=>f(),[f]),y.useEffect(()=>{if(c&&u){const x=v=>p(v,u),g=v=>p(v,c);return c.addEventListener("pointerleave",x),u.addEventListener("pointerleave",g),()=>{c.removeEventListener("pointerleave",x),u.removeEventListener("pointerleave",g)}}},[c,u,p,f]),y.useEffect(()=>{if(o){const x=g=>{const v=g.target,_={x:g.clientX,y:g.clientY},w=(c==null?void 0:c.contains(v))||(u==null?void 0:u.contains(v)),b=!Qte(_,o);w?f():b&&(f(),d())};return document.addEventListener("pointermove",x),()=>document.removeEventListener("pointermove",x)}},[c,u,o,d,f]),s.jsx(BI,W(M({},e),{ref:a}))}),[Hte,Gte]=kw(dg,{isInside:!1}),Yte=jD("TooltipContent"),BI=y.forwardRef((e,t)=>{const h=e,{__scopeTooltip:r,children:n,"aria-label":i,onEscapeKeyDown:a,onPointerDownOutside:o}=h,l=me(h,["__scopeTooltip","children","aria-label","onEscapeKeyDown","onPointerDownOutside"]),c=Cw(em,r),d=Ew(r),{onClose:u}=c;return y.useEffect(()=>(document.addEventListener(E3,u),()=>document.removeEventListener(E3,u)),[u]),y.useEffect(()=>{if(c.trigger){const f=p=>{const x=p.target;x!=null&&x.contains(c.trigger)&&u()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[c.trigger,u]),s.jsx(of,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:f=>f.preventDefault(),onDismiss:u,children:s.jsxs(Nw,W(M(M({"data-state":c.stateAttribute},d),l),{ref:t,style:W(M({},l.style),{"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}),children:[s.jsx(Yte,{children:n}),s.jsx(Hte,{scope:r,isInside:!0,children:s.jsx(QX,{id:c.contentId,role:"tooltip",children:i||n})})]}))})});UI.displayName=em;var zI="TooltipArrow",Kte=y.forwardRef((e,t)=>{const o=e,{__scopeTooltip:r}=o,n=me(o,["__scopeTooltip"]),i=Ew(r);return Gte(zI,r).isInside?null:s.jsx(Sw,W(M(M({},i),n),{ref:t}))});Kte.displayName=zI;function Zte(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),i=Math.abs(t.right-e.x),a=Math.abs(t.left-e.x);switch(Math.min(r,n,i,a)){case a:return"left";case i:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function Xte(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function Jte(e){const{top:t,right:r,bottom:n,left:i}=e;return[{x:i,y:t},{x:r,y:t},{x:r,y:n},{x:i,y:n}]}function Qte(e,t){const{x:r,y:n}=e;let i=!1;for(let a=0,o=t.length-1;a<t.length;o=a++){const l=t[a],c=t[o],d=l.x,u=l.y,h=c.x,f=c.y;u>n!=f>n&&r<(h-d)*(n-u)/(f-u)+d&&(i=!i)}return i}function ere(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),tre(t)}function tre(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const i=e[n];for(;t.length>=2;){const a=t[t.length-1],o=t[t.length-2];if((a.x-o.x)*(i.y-o.y)>=(a.y-o.y)*(i.x-o.x))t.pop();else break}t.push(i)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const i=e[n];for(;r.length>=2;){const a=r[r.length-1],o=r[r.length-2];if((a.x-o.x)*(i.y-o.y)>=(a.y-o.y)*(i.x-o.x))r.pop();else break}r.push(i)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var rre=$I,nre=LI,sre=FI,VI=UI;const oE=rre,qI=nre,WI=sre,lE=y.forwardRef((i,n)=>{var a=i,{className:e,sideOffset:t=4}=a,r=me(a,["className","sideOffset"]);return s.jsx(VI,M({ref:n,sideOffset:t,className:ke("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e)},r))});lE.displayName=VI.displayName;var Pw=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Aw=typeof window=="undefined"||"Deno"in globalThis;function mo(){}function ire(e,t){return typeof e=="function"?e(t):e}function are(e){return typeof e=="number"&&e>=0&&e!==1/0}function ore(e,t){return Math.max(e+(t||0)-Date.now(),0)}function P3(e,t){return typeof e=="function"?e(t):e}function lre(e,t){return typeof e=="function"?e(t):e}function XP(e,t){const{type:r="all",exact:n,fetchStatus:i,predicate:a,queryKey:o,stale:l}=e;if(o){if(n){if(t.queryHash!==cE(o,t.options))return!1}else if(!fg(t.queryKey,o))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||i&&i!==t.state.fetchStatus||a&&!a(t))}function JP(e,t){const{exact:r,status:n,predicate:i,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(r){if(ug(t.options.mutationKey)!==ug(a))return!1}else if(!fg(t.options.mutationKey,a))return!1}return!(n&&t.state.status!==n||i&&!i(t))}function cE(e,t){return((t==null?void 0:t.queryKeyHashFn)||ug)(e)}function ug(e){return JSON.stringify(e,(t,r)=>A3(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function fg(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>fg(e[r],t[r])):!1}function HI(e,t){if(e===t)return e;const r=QP(e)&&QP(t);if(r||A3(e)&&A3(t)){const n=r?e:Object.keys(e),i=n.length,a=r?t:Object.keys(t),o=a.length,l=r?[]:{},c=new Set(n);let d=0;for(let u=0;u<o;u++){const h=r?u:a[u];(!r&&c.has(h)||r)&&e[h]===void 0&&t[h]===void 0?(l[h]=void 0,d++):(l[h]=HI(e[h],t[h]),l[h]===e[h]&&e[h]!==void 0&&d++)}return i===o&&d===i?e:l}return t}function QP(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function A3(e){if(!e7(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!e7(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function e7(e){return Object.prototype.toString.call(e)==="[object Object]"}function cre(e){return new Promise(t=>{setTimeout(t,e)})}function dre(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?HI(e,t):t}function ure(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function fre(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var dE=Symbol();function GI(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===dE?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var _u,td,Lh,tR,hre=(tR=class extends Pw{constructor(){super();nn(this,_u);nn(this,td);nn(this,Lh);wr(this,Lh,t=>{if(!Aw&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){it(this,td)||this.setEventListener(it(this,Lh))}onUnsubscribe(){var t;this.hasListeners()||((t=it(this,td))==null||t.call(this),wr(this,td,void 0))}setEventListener(t){var r;wr(this,Lh,t),(r=it(this,td))==null||r.call(this),wr(this,td,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){it(this,_u)!==t&&(wr(this,_u,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof it(this,_u)=="boolean"?it(this,_u):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},_u=new WeakMap,td=new WeakMap,Lh=new WeakMap,tR),YI=new hre,Fh,rd,Uh,rR,mre=(rR=class extends Pw{constructor(){super();nn(this,Fh,!0);nn(this,rd);nn(this,Uh);wr(this,Uh,t=>{if(!Aw&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){it(this,rd)||this.setEventListener(it(this,Uh))}onUnsubscribe(){var t;this.hasListeners()||((t=it(this,rd))==null||t.call(this),wr(this,rd,void 0))}setEventListener(t){var r;wr(this,Uh,t),(r=it(this,rd))==null||r.call(this),wr(this,rd,t(this.setOnline.bind(this)))}setOnline(t){it(this,Fh)!==t&&(wr(this,Fh,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return it(this,Fh)}},Fh=new WeakMap,rd=new WeakMap,Uh=new WeakMap,rR),S2=new mre;function pre(){let e,t;const r=new Promise((i,a)=>{e=i,t=a});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),e(i)},r.reject=i=>{n({status:"rejected",reason:i}),t(i)},r}function gre(e){return Math.min(1e3*Tp(2,e),3e4)}function KI(e){return(e!=null?e:"online")==="online"?S2.isOnline():!0}var ZI=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function tj(e){return e instanceof ZI}function XI(e){let t=!1,r=0,n=!1,i;const a=pre(),o=g=>{var v;n||(f(new ZI(g)),(v=e.abort)==null||v.call(e))},l=()=>{t=!0},c=()=>{t=!1},d=()=>YI.isFocused()&&(e.networkMode==="always"||S2.isOnline())&&e.canRun(),u=()=>KI(e.networkMode)&&e.canRun(),h=g=>{var v;n||(n=!0,(v=e.onSuccess)==null||v.call(e,g),i==null||i(),a.resolve(g))},f=g=>{var v;n||(n=!0,(v=e.onError)==null||v.call(e,g),i==null||i(),a.reject(g))},p=()=>new Promise(g=>{var v;i=_=>{(n||d())&&g(_)},(v=e.onPause)==null||v.call(e)}).then(()=>{var g;i=void 0,n||(g=e.onContinue)==null||g.call(e)}),x=()=>{if(n)return;let g;const v=r===0?e.initialPromise:void 0;try{g=v!=null?v:e.fn()}catch(_){g=Promise.reject(_)}Promise.resolve(g).then(h).catch(_=>{var k,O,A;if(n)return;const w=(k=e.retry)!=null?k:Aw?0:3,b=(O=e.retryDelay)!=null?O:gre,N=typeof b=="function"?b(r,_):b,S=w===!0||typeof w=="number"&&r<w||typeof w=="function"&&w(r,_);if(t||!S){f(_);return}r++,(A=e.onFail)==null||A.call(e,r,_),cre(N).then(()=>d()?void 0:p()).then(()=>{t?f(_):x()})})};return{promise:a,cancel:o,continue:()=>(i==null||i(),a),cancelRetry:l,continueRetry:c,canStart:u,start:()=>(u()?x():p().then(x),a)}}var vre=e=>setTimeout(e,0);function xre(){let e=[],t=0,r=l=>{l()},n=l=>{l()},i=vre;const a=l=>{t?e.push(l):i(()=>{r(l)})},o=()=>{const l=e;e=[],l.length&&i(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{a(()=>{l(...c)})},schedule:a,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{i=l}}}var Ai=xre(),wu,nR,JI=(nR=class{constructor(){nn(this,wu)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),are(this.gcTime)&&wr(this,wu,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e!=null?e:Aw?1/0:5*60*1e3)}clearGcTimeout(){it(this,wu)&&(clearTimeout(it(this,wu)),wr(this,wu,void 0))}},wu=new WeakMap,nR),Bh,bu,Ia,ju,pi,uv,Nu,po,zl,sR,yre=(sR=class extends JI{constructor(t){var r;super();nn(this,po);nn(this,Bh);nn(this,bu);nn(this,Ia);nn(this,ju);nn(this,pi);nn(this,uv);nn(this,Nu);wr(this,Nu,!1),wr(this,uv,t.defaultOptions),this.setOptions(t.options),this.observers=[],wr(this,ju,t.client),wr(this,Ia,it(this,ju).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,wr(this,Bh,wre(this.options)),this.state=(r=t.state)!=null?r:it(this,Bh),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=it(this,pi))==null?void 0:t.promise}setOptions(t){this.options=M(M({},it(this,uv)),t),this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&it(this,Ia).remove(this)}setData(t,r){const n=dre(this.state.data,t,this.options);return fi(this,po,zl).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){fi(this,po,zl).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,i;const r=(n=it(this,pi))==null?void 0:n.promise;return(i=it(this,pi))==null||i.cancel(t),r?r.then(mo).catch(mo):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(it(this,Bh))}isActive(){return this.observers.some(t=>lre(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===dE||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>P3(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!ore(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=it(this,pi))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=it(this,pi))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),it(this,Ia).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(it(this,pi)&&(it(this,Nu)?it(this,pi).cancel({revert:!0}):it(this,pi).cancelRetry()),this.scheduleGc()),it(this,Ia).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||fi(this,po,zl).call(this,{type:"invalidate"})}fetch(t,r){var d,u,h;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(it(this,pi))return it(this,pi).continueRetry(),it(this,pi).promise}if(t&&this.setOptions(t),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}const n=new AbortController,i=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(wr(this,Nu,!0),n.signal)})},a=()=>{const f=GI(this.options,r),x=(()=>{const g={client:it(this,ju),queryKey:this.queryKey,meta:this.meta};return i(g),g})();return wr(this,Nu,!1),this.options.persister?this.options.persister(f,x,this):f(x)},l=(()=>{const f={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:it(this,ju),state:this.state,fetchFn:a};return i(f),f})();(d=this.options.behavior)==null||d.onFetch(l,this),wr(this,bu,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=l.fetchOptions)==null?void 0:u.meta))&&fi(this,po,zl).call(this,{type:"fetch",meta:(h=l.fetchOptions)==null?void 0:h.meta});const c=f=>{var p,x,g,v;tj(f)&&f.silent||fi(this,po,zl).call(this,{type:"error",error:f}),tj(f)||((x=(p=it(this,Ia).config).onError)==null||x.call(p,f,this),(v=(g=it(this,Ia).config).onSettled)==null||v.call(g,this.state.data,f,this)),this.scheduleGc()};return wr(this,pi,XI({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:f=>{var p,x,g,v;if(f===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(_){c(_);return}(x=(p=it(this,Ia).config).onSuccess)==null||x.call(p,f,this),(v=(g=it(this,Ia).config).onSettled)==null||v.call(g,f,this.state.error,this),this.scheduleGc()},onError:c,onFail:(f,p)=>{fi(this,po,zl).call(this,{type:"failed",failureCount:f,error:p})},onPause:()=>{fi(this,po,zl).call(this,{type:"pause"})},onContinue:()=>{fi(this,po,zl).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),it(this,pi).start()}},Bh=new WeakMap,bu=new WeakMap,Ia=new WeakMap,ju=new WeakMap,pi=new WeakMap,uv=new WeakMap,Nu=new WeakMap,po=new WeakSet,zl=function(t){const r=n=>{var i,a;switch(t.type){case"failed":return W(M({},n),{fetchFailureCount:t.failureCount,fetchFailureReason:t.error});case"pause":return W(M({},n),{fetchStatus:"paused"});case"continue":return W(M({},n),{fetchStatus:"fetching"});case"fetch":return W(M(M({},n),_re(n.data,this.options)),{fetchMeta:(i=t.meta)!=null?i:null});case"success":return wr(this,bu,void 0),M(W(M({},n),{data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:(a=t.dataUpdatedAt)!=null?a:Date.now(),error:null,isInvalidated:!1,status:"success"}),!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null});case"error":const o=t.error;return tj(o)&&o.revert&&it(this,bu)?W(M({},it(this,bu)),{fetchStatus:"idle"}):W(M({},n),{error:o,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"});case"invalidate":return W(M({},n),{isInvalidated:!0});case"setState":return M(M({},n),t.state)}};this.state=r(this.state),Ai.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),it(this,Ia).notify({query:this,type:"updated",action:t})})},sR);function _re(e,t){return M({fetchFailureCount:0,fetchFailureReason:null,fetchStatus:KI(t.networkMode)?"fetching":"paused"},e===void 0&&{error:null,status:"pending"})}function wre(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n!=null?n:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Qo,iR,bre=(iR=class extends Pw{constructor(t={}){super();nn(this,Qo);this.config=t,wr(this,Qo,new Map)}build(t,r,n){var l;const i=r.queryKey,a=(l=r.queryHash)!=null?l:cE(i,r);let o=this.get(a);return o||(o=new yre({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(o)),o}add(t){it(this,Qo).has(t.queryHash)||(it(this,Qo).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=it(this,Qo).get(t.queryHash);r&&(t.destroy(),r===t&&it(this,Qo).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ai.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return it(this,Qo).get(t)}getAll(){return[...it(this,Qo).values()]}find(t){const r=M({exact:!0},t);return this.getAll().find(n=>XP(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>XP(t,n)):r}notify(t){Ai.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Ai.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ai.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Qo=new WeakMap,iR),el,Ei,Su,tl,Vc,aR,jre=(aR=class extends JI{constructor(t){super();nn(this,tl);nn(this,el);nn(this,Ei);nn(this,Su);this.mutationId=t.mutationId,wr(this,Ei,t.mutationCache),wr(this,el,[]),this.state=t.state||Nre(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){it(this,el).includes(t)||(it(this,el).push(t),this.clearGcTimeout(),it(this,Ei).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){wr(this,el,it(this,el).filter(r=>r!==t)),this.scheduleGc(),it(this,Ei).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){it(this,el).length||(this.state.status==="pending"?this.scheduleGc():it(this,Ei).remove(this))}continue(){var t,r;return(r=(t=it(this,Su))==null?void 0:t.continue())!=null?r:this.execute(this.state.variables)}execute(t){return E(this,null,function*(){var a,o,l,c,d,u,h,f,p,x,g,v,_,w,b,N,S,k,O,A,T;const r=()=>{fi(this,tl,Vc).call(this,{type:"continue"})};wr(this,Su,XI({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:($,R)=>{fi(this,tl,Vc).call(this,{type:"failed",failureCount:$,error:R})},onPause:()=>{fi(this,tl,Vc).call(this,{type:"pause"})},onContinue:r,retry:(a=this.options.retry)!=null?a:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>it(this,Ei).canRun(this)}));const n=this.state.status==="pending",i=!it(this,Su).canStart();try{if(n)r();else{fi(this,tl,Vc).call(this,{type:"pending",variables:t,isPaused:i}),yield(l=(o=it(this,Ei).config).onMutate)==null?void 0:l.call(o,t,this);const R=yield(d=(c=this.options).onMutate)==null?void 0:d.call(c,t);R!==this.state.context&&fi(this,tl,Vc).call(this,{type:"pending",context:R,variables:t,isPaused:i})}const $=yield it(this,Su).start();return yield(h=(u=it(this,Ei).config).onSuccess)==null?void 0:h.call(u,$,t,this.state.context,this),yield(p=(f=this.options).onSuccess)==null?void 0:p.call(f,$,t,this.state.context),yield(g=(x=it(this,Ei).config).onSettled)==null?void 0:g.call(x,$,null,this.state.variables,this.state.context,this),yield(_=(v=this.options).onSettled)==null?void 0:_.call(v,$,null,t,this.state.context),fi(this,tl,Vc).call(this,{type:"success",data:$}),$}catch($){try{throw yield(b=(w=it(this,Ei).config).onError)==null?void 0:b.call(w,$,t,this.state.context,this),yield(S=(N=this.options).onError)==null?void 0:S.call(N,$,t,this.state.context),yield(O=(k=it(this,Ei).config).onSettled)==null?void 0:O.call(k,void 0,$,this.state.variables,this.state.context,this),yield(T=(A=this.options).onSettled)==null?void 0:T.call(A,void 0,$,t,this.state.context),$}finally{fi(this,tl,Vc).call(this,{type:"error",error:$})}}finally{it(this,Ei).runNext(this)}})}},el=new WeakMap,Ei=new WeakMap,Su=new WeakMap,tl=new WeakSet,Vc=function(t){const r=n=>{switch(t.type){case"failed":return W(M({},n),{failureCount:t.failureCount,failureReason:t.error});case"pause":return W(M({},n),{isPaused:!0});case"continue":return W(M({},n),{isPaused:!1});case"pending":return W(M({},n),{context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()});case"success":return W(M({},n),{data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1});case"error":return W(M({},n),{data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"})}};this.state=r(this.state),Ai.batch(()=>{it(this,el).forEach(n=>{n.onMutationUpdate(t)}),it(this,Ei).notify({mutation:this,type:"updated",action:t})})},aR);function Nre(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Kl,go,fv,oR,Sre=(oR=class extends Pw{constructor(t={}){super();nn(this,Kl);nn(this,go);nn(this,fv);this.config=t,wr(this,Kl,new Set),wr(this,go,new Map),wr(this,fv,0)}build(t,r,n){const i=new jre({mutationCache:this,mutationId:++yx(this,fv)._,options:t.defaultMutationOptions(r),state:n});return this.add(i),i}add(t){it(this,Kl).add(t);const r=zx(t);if(typeof r=="string"){const n=it(this,go).get(r);n?n.push(t):it(this,go).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(it(this,Kl).delete(t)){const r=zx(t);if(typeof r=="string"){const n=it(this,go).get(r);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&it(this,go).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=zx(t);if(typeof r=="string"){const n=it(this,go).get(r),i=n==null?void 0:n.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){var n,i;const r=zx(t);if(typeof r=="string"){const a=(n=it(this,go).get(r))==null?void 0:n.find(o=>o!==t&&o.state.isPaused);return(i=a==null?void 0:a.continue())!=null?i:Promise.resolve()}else return Promise.resolve()}clear(){Ai.batch(()=>{it(this,Kl).forEach(t=>{this.notify({type:"removed",mutation:t})}),it(this,Kl).clear(),it(this,go).clear()})}getAll(){return Array.from(it(this,Kl))}find(t){const r=M({exact:!0},t);return this.getAll().find(n=>JP(r,n))}findAll(t={}){return this.getAll().filter(r=>JP(t,r))}notify(t){Ai.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Ai.batch(()=>Promise.all(t.map(r=>r.continue().catch(mo))))}},Kl=new WeakMap,go=new WeakMap,fv=new WeakMap,oR);function zx(e){var t;return(t=e.options.scope)==null?void 0:t.id}function t7(e){return{onFetch:(t,r)=>{var u,h,f,p,x;const n=t.options,i=(f=(h=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,a=((p=t.state.data)==null?void 0:p.pages)||[],o=((x=t.state.data)==null?void 0:x.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=()=>E(this,null,function*(){var b;let g=!1;const v=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},_=GI(t.options,t.fetchOptions),w=(N,S,k)=>E(this,null,function*(){if(g)return Promise.reject();if(S==null&&N.pages.length)return Promise.resolve(N);const A=(()=>{const F={client:t.client,queryKey:t.queryKey,pageParam:S,direction:k?"backward":"forward",meta:t.options.meta};return v(F),F})(),T=yield _(A),{maxPages:$}=t.options,R=k?fre:ure;return{pages:R(N.pages,T,$),pageParams:R(N.pageParams,S,$)}});if(i&&a.length){const N=i==="backward",S=N?kre:r7,k={pages:a,pageParams:o},O=S(n,k);l=yield w(k,O,N)}else{const N=e!=null?e:a.length;do{const S=c===0?(b=o[0])!=null?b:n.initialPageParam:r7(n,l);if(c>0&&S==null)break;l=yield w(l,S),c++}while(c<N)}return l});t.options.persister?t.fetchFn=()=>{var g,v;return(v=(g=t.options).persister)==null?void 0:v.call(g,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=d}}}function r7(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function kre(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var es,nd,sd,zh,Vh,id,qh,Wh,lR,Ere=(lR=class{constructor(e={}){nn(this,es);nn(this,nd);nn(this,sd);nn(this,zh);nn(this,Vh);nn(this,id);nn(this,qh);nn(this,Wh);wr(this,es,e.queryCache||new bre),wr(this,nd,e.mutationCache||new Sre),wr(this,sd,e.defaultOptions||{}),wr(this,zh,new Map),wr(this,Vh,new Map),wr(this,id,0)}mount(){yx(this,id)._++,it(this,id)===1&&(wr(this,qh,YI.subscribe(e=>E(this,null,function*(){e&&(yield this.resumePausedMutations(),it(this,es).onFocus())}))),wr(this,Wh,S2.subscribe(e=>E(this,null,function*(){e&&(yield this.resumePausedMutations(),it(this,es).onOnline())}))))}unmount(){var e,t;yx(this,id)._--,it(this,id)===0&&((e=it(this,qh))==null||e.call(this),wr(this,qh,void 0),(t=it(this,Wh))==null||t.call(this),wr(this,Wh,void 0))}isFetching(e){return it(this,es).findAll(W(M({},e),{fetchStatus:"fetching"})).length}isMutating(e){return it(this,nd).findAll(W(M({},e),{status:"pending"})).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=it(this,es).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=it(this,es).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(P3(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return it(this,es).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),i=it(this,es).get(n.queryHash),a=i==null?void 0:i.state.data,o=ire(t,a);if(o!==void 0)return it(this,es).build(this,n).setData(o,W(M({},r),{manual:!0}))}setQueriesData(e,t,r){return Ai.batch(()=>it(this,es).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=it(this,es).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=it(this,es);Ai.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=it(this,es);return Ai.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries(M({type:"active"},e),t)))}cancelQueries(e,t={}){const r=M({revert:!0},t),n=Ai.batch(()=>it(this,es).findAll(e).map(i=>i.cancel(r)));return Promise.all(n).then(mo).catch(mo)}invalidateQueries(e,t={}){return Ai.batch(()=>{var r,n;return it(this,es).findAll(e).forEach(i=>{i.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries(W(M({},e),{type:(n=(r=e==null?void 0:e.refetchType)!=null?r:e==null?void 0:e.type)!=null?n:"active"}),t)})}refetchQueries(e,t={}){var i;const r=W(M({},t),{cancelRefetch:(i=t.cancelRefetch)!=null?i:!0}),n=Ai.batch(()=>it(this,es).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let o=a.fetch(void 0,r);return r.throwOnError||(o=o.catch(mo)),a.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(mo)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=it(this,es).build(this,t);return r.isStaleByTime(P3(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(mo).catch(mo)}fetchInfiniteQuery(e){return e.behavior=t7(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(mo).catch(mo)}ensureInfiniteQueryData(e){return e.behavior=t7(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return S2.isOnline()?it(this,nd).resumePausedMutations():Promise.resolve()}getQueryCache(){return it(this,es)}getMutationCache(){return it(this,nd)}getDefaultOptions(){return it(this,sd)}setDefaultOptions(e){wr(this,sd,e)}setQueryDefaults(e,t){it(this,zh).set(ug(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...it(this,zh).values()],r={};return t.forEach(n=>{fg(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){it(this,Vh).set(ug(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...it(this,Vh).values()],r={};return t.forEach(n=>{fg(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t=W(M(M(M({},it(this,sd).queries),this.getQueryDefaults(e.queryKey)),e),{_defaulted:!0});return t.queryHash||(t.queryHash=cE(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===dE&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:W(M(M(M({},it(this,sd).mutations),(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey)),e),{_defaulted:!0})}clear(){it(this,es).clear(),it(this,nd).clear()}},es=new WeakMap,nd=new WeakMap,sd=new WeakMap,zh=new WeakMap,Vh=new WeakMap,id=new WeakMap,qh=new WeakMap,Wh=new WeakMap,lR),Cre=y.createContext(void 0),Pre=({client:e,children:t})=>(y.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),s.jsx(Cre.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hg(){return hg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hg.apply(this,arguments)}var ec;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ec||(ec={}));const n7="popstate";function Are(e){e===void 0&&(e={});function t(n,i){let{pathname:a,search:o,hash:l}=n.location;return T3("",{pathname:a,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:uE(i)}return Ore(t,r,null,e)}function ws(e,t){if(e===!1||e===null||typeof e=="undefined")throw new Error(t)}function QI(e,t){if(!e){typeof console!="undefined"&&console.warn(t);try{throw new Error(t)}catch(r){}}}function Tre(){return Math.random().toString(36).substr(2,8)}function s7(e,t){return{usr:e.state,key:e.key,idx:t}}function T3(e,t,r,n){return r===void 0&&(r=null),hg({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?df(t):t,{state:r,key:t&&t.key||n||Tre()})}function uE(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function df(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Ore(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,o=i.history,l=ec.Pop,c=null,d=u();d==null&&(d=0,o.replaceState(hg({},o.state,{idx:d}),""));function u(){return(o.state||{idx:null}).idx}function h(){l=ec.Pop;let v=u(),_=v==null?null:v-d;d=v,c&&c({action:l,location:g.location,delta:_})}function f(v,_){l=ec.Push;let w=T3(g.location,v,_);d=u()+1;let b=s7(w,d),N=g.createHref(w);try{o.pushState(b,"",N)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(N)}a&&c&&c({action:l,location:g.location,delta:1})}function p(v,_){l=ec.Replace;let w=T3(g.location,v,_);d=u();let b=s7(w,d),N=g.createHref(w);o.replaceState(b,"",N),a&&c&&c({action:l,location:g.location,delta:0})}function x(v){let _=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof v=="string"?v:uE(v);return w=w.replace(/ $/,"%20"),ws(_,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,_)}let g={get action(){return l},get location(){return e(i,o)},listen(v){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(n7,h),c=v,()=>{i.removeEventListener(n7,h),c=null}},createHref(v){return t(i,v)},createURL:x,encodeLocation(v){let _=x(v);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:f,replace:p,go(v){return o.go(v)}};return g}var i7;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(i7||(i7={}));function e$(e,t,r){return r===void 0&&(r="/"),Rre(e,t,r,!1)}function Rre(e,t,r,n){let i=typeof t=="string"?df(t):t,a=n$(i.pathname||"/",r);if(a==null)return null;let o=t$(e);Mre(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=Wre(a);l=Vre(o[c],d,n)}return l}function t$(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(ws(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Au([n,c.relativePath]),u=r.concat(c);a.children&&a.children.length>0&&(ws(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),t$(a.children,t,u,d)),!(a.path==null&&!a.index)&&t.push({path:d,score:Bre(d,a.index),routesMeta:u})};return e.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))i(a,o);else for(let c of r$(a.path))i(a,o,c)}),t}function r$(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let o=r$(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),i&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function Mre(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:zre(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Dre=/^:[\w-]+$/,Ire=3,$re=2,Lre=1,Fre=10,Ure=-2,a7=e=>e==="*";function Bre(e,t){let r=e.split("/"),n=r.length;return r.some(a7)&&(n+=Ure),t&&(n+=$re),r.filter(i=>!a7(i)).reduce((i,a)=>i+(Dre.test(a)?Ire:a===""?Lre:Fre),n)}function zre(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function Vre(e,t,r){let{routesMeta:n}=e,i={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,u=a==="/"?t:t.slice(a.length)||"/",h=O3({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),f=c.route;if(!h&&d&&r&&!n[n.length-1].route.index&&(h=O3({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:Au([a,h.pathname]),pathnameBase:Yre(Au([a,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(a=Au([a,h.pathnameBase]))}return o}function O3(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=qre(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((d,u,h)=>{let{paramName:f,isOptional:p}=u;if(f==="*"){let g=l[h]||"";o=a.slice(0,a.length-g.length).replace(/(.)\/+$/,"$1")}const x=l[h];return p&&!x?d[f]=void 0:d[f]=(x||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:e}}function qre(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),QI(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function Wre(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return QI(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function n$(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function s$(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?df(e):e;return{pathname:r?r.startsWith("/")?r:Hre(r,t):t,search:Kre(n),hash:Zre(i)}}function Hre(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function rj(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Gre(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function i$(e,t){let r=Gre(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function a$(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=df(e):(i=hg({},e),ws(!i.pathname||!i.pathname.includes("?"),rj("?","pathname","search",i)),ws(!i.pathname||!i.pathname.includes("#"),rj("#","pathname","hash",i)),ws(!i.search||!i.search.includes("#"),rj("#","search","hash",i)));let a=e===""||i.pathname==="",o=a?"/":i.pathname,l;if(o==null)l=r;else{let h=t.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;i.pathname=f.join("/")}l=h>=0?t[h]:"/"}let c=s$(i,l),d=o&&o!=="/"&&o.endsWith("/"),u=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const Au=e=>e.join("/").replace(/\/\/+/g,"/"),Yre=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Kre=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Zre=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function o$(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const l$=["post","put","patch","delete"];new Set(l$);const Xre=["get",...l$];new Set(Xre);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function mg(){return mg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mg.apply(this,arguments)}const Tw=y.createContext(null),c$=y.createContext(null),Ym=y.createContext(null),bv=y.createContext(null),Ec=y.createContext({outlet:null,matches:[],isDataRoute:!1}),d$=y.createContext(null);function Km(){return y.useContext(bv)!=null}function Md(){return Km()||ws(!1),y.useContext(bv).location}function u$(e){y.useContext(Ym).static||y.useLayoutEffect(e)}function ci(){let{isDataRoute:e}=y.useContext(Ec);return e?lne():Jre()}function Jre(){Km()||ws(!1);let e=y.useContext(Tw),{basename:t,future:r,navigator:n}=y.useContext(Ym),{matches:i}=y.useContext(Ec),{pathname:a}=Md(),o=JSON.stringify(i$(i,r.v7_relativeSplatPath)),l=y.useRef(!1);return u$(()=>{l.current=!0}),y.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let h=a$(d,JSON.parse(o),a,u.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Au([t,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[t,n,o,a,e])}function Ow(){let{matches:e}=y.useContext(Ec),t=e[e.length-1];return t?t.params:{}}function f$(e,t){return Qre(e,t)}function Qre(e,t,r,n){Km()||ws(!1);let{navigator:i}=y.useContext(Ym),{matches:a}=y.useContext(Ec),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=Md(),u;if(t){var h;let v=typeof t=="string"?df(t):t;c==="/"||(h=v.pathname)!=null&&h.startsWith(c)||ws(!1),u=v}else u=d;let f=u.pathname||"/",p=f;if(c!=="/"){let v=c.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let x=e$(e,{pathname:p}),g=sne(x&&x.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:Au([c,i.encodeLocation?i.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:Au([c,i.encodeLocation?i.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),a,r,n);return t&&g?y.createElement(bv.Provider,{value:{location:mg({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:ec.Pop}},g):g}function ene(){let e=p$(),t=o$(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},t),r?y.createElement("pre",{style:i},r):null,null)}const tne=y.createElement(ene,null);class rne extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?y.createElement(Ec.Provider,{value:this.props.routeContext},y.createElement(d$.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function nne(e){let{routeContext:t,match:r,children:n}=e,i=y.useContext(Tw);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),y.createElement(Ec.Provider,{value:t},n)}function sne(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(i=r)==null?void 0:i.errors;if(l!=null){let u=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);u>=0||ws(!1),o=o.slice(0,Math.min(o.length,u+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=u),h.route.id){let{loaderData:f,errors:p}=r,x=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||x){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((u,h,f)=>{let p,x=!1,g=null,v=null;r&&(p=l&&h.route.id?l[h.route.id]:void 0,g=h.route.errorElement||tne,c&&(d<0&&f===0?(x=!0,v=null):d===f&&(x=!0,v=h.route.hydrateFallbackElement||null)));let _=t.concat(o.slice(0,f+1)),w=()=>{let b;return p?b=g:x?b=v:h.route.Component?b=y.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=u,y.createElement(nne,{match:h,routeContext:{outlet:u,matches:_,isDataRoute:r!=null},children:b})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?y.createElement(rne,{location:r.location,revalidation:r.revalidation,component:g,error:p,children:w(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):w()},null)}var h$=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(h$||{}),k2=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(k2||{});function ine(e){let t=y.useContext(Tw);return t||ws(!1),t}function ane(e){let t=y.useContext(c$);return t||ws(!1),t}function one(e){let t=y.useContext(Ec);return t||ws(!1),t}function m$(e){let t=one(),r=t.matches[t.matches.length-1];return r.route.id||ws(!1),r.route.id}function p$(){var e;let t=y.useContext(d$),r=ane(k2.UseRouteError),n=m$(k2.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function lne(){let{router:e}=ine(h$.UseNavigateStable),t=m$(k2.UseNavigateStable),r=y.useRef(!1);return u$(()=>{r.current=!0}),y.useCallback(function(i,a){a===void 0&&(a={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,mg({fromRouteId:t},a)))},[e,t])}function cne(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function g$(e){let{to:t,replace:r,state:n,relative:i}=e;Km()||ws(!1);let{future:a,static:o}=y.useContext(Ym),{matches:l}=y.useContext(Ec),{pathname:c}=Md(),d=ci(),u=a$(t,i$(l,a.v7_relativeSplatPath),c,i==="path"),h=JSON.stringify(u);return y.useEffect(()=>d(JSON.parse(h),{replace:r,state:n,relative:i}),[d,h,i,r,n]),null}function Bs(e){ws(!1)}function v$(e){let{basename:t="/",children:r=null,location:n,navigationType:i=ec.Pop,navigator:a,static:o=!1,future:l}=e;Km()&&ws(!1);let c=t.replace(/^\/*/,"/"),d=y.useMemo(()=>({basename:c,navigator:a,static:o,future:mg({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof n=="string"&&(n=df(n));let{pathname:u="/",search:h="",hash:f="",state:p=null,key:x="default"}=n,g=y.useMemo(()=>{let v=n$(u,c);return v==null?null:{location:{pathname:v,search:h,hash:f,state:p,key:x},navigationType:i}},[c,u,h,f,p,x,i]);return g==null?null:y.createElement(Ym.Provider,{value:d},y.createElement(bv.Provider,{children:r,value:g}))}function fE(e){let{children:t,location:r}=e;return f$(pg(t),r)}new Promise(()=>{});function pg(e,t){t===void 0&&(t=[]);let r=[];return y.Children.forEach(e,(n,i)=>{if(!y.isValidElement(n))return;let a=[...t,i];if(n.type===y.Fragment){r.push.apply(r,pg(n.props.children,a));return}n.type!==Bs&&ws(!1),!n.props.index||!n.props.children||ws(!1);let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=pg(n.props.children,a)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const dne="6";try{window.__reactRouterVersion=dne}catch(e){}const une="startTransition",o7=J5[une];function x$(e){let{basename:t,children:r,future:n,window:i}=e,a=y.useRef();a.current==null&&(a.current=Are({window:i,v5Compat:!0}));let o=a.current,[l,c]=y.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},u=y.useCallback(h=>{d&&o7?o7(()=>c(h)):c(h)},[c,d]);return y.useLayoutEffect(()=>o.listen(u),[o,u]),y.useEffect(()=>cne(n),[n]),y.createElement(v$,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}var l7;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(l7||(l7={}));var c7;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(c7||(c7={}));const fne=Object.freeze(Object.defineProperty({__proto__:null,BrowserRouter:x$,Navigate:g$,get NavigationType(){return ec},Route:Bs,Router:v$,Routes:fE,UNSAFE_DataRouterContext:Tw,UNSAFE_DataRouterStateContext:c$,UNSAFE_LocationContext:bv,UNSAFE_NavigationContext:Ym,UNSAFE_RouteContext:Ec,createPath:uE,createRoutesFromChildren:pg,createRoutesFromElements:pg,isRouteErrorResponse:o$,matchPath:O3,matchRoutes:e$,parsePath:df,resolvePath:s$,useInRouterContext:Km,useLocation:Md,useNavigate:ci,useParams:Ow,useRouteError:p$,useRoutes:f$},Symbol.toStringTag,{value:"Module"})),hne=()=>{const e=Md();return y.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),s.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),s.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},mne="modulepreload",pne=function(e,t){return new URL(e,t).href},d7={},on=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){const o=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=Promise.allSettled(r.map(d=>{if(d=pne(d,n),d in d7)return;d7[d]=!0;const u=d.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(!!n)for(let x=o.length-1;x>=0;x--){const g=o[x];if(g.href===d&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${h}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":mne,u||(p.as="script"),p.crossOrigin="",p.href=d,c&&p.setAttribute("nonce",c),document.head.appendChild(p),u)return new Promise((x,g)=>{p.addEventListener("load",x),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return t().catch(a)})},gne=e=>{let t;return e?t=e:typeof fetch=="undefined"?t=(...r)=>on(()=>E(void 0,null,function*(){const{default:n}=yield Promise.resolve().then(()=>Zm);return{default:n}}),void 0,import.meta.url).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class hE extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class vne extends hE{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class u7 extends hE{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class f7 extends hE{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var R3;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(R3||(R3={}));var xne=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(h){o(h)}}function c(u){try{d(n.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class yne{constructor(t,{headers:r={},customFetch:n,region:i=R3.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=gne(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return xne(this,void 0,void 0,function*(){try{const{headers:i,method:a,body:o}=r;let l={},{region:c}=r;c||(c=this.region);const d=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let u;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob!="undefined"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData!="undefined"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(d.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),i),body:u}).catch(g=>{throw new vne(g)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new u7(h);if(!h.ok)throw new f7(h);let p=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return p==="application/json"?x=yield h.json():p==="application/octet-stream"?x=yield h.blob():p==="text/event-stream"?x=h:p==="multipart/form-data"?x=yield h.formData():x=yield h.text(),{data:x,error:null,response:h}}catch(i){return{data:null,error:i,response:i instanceof f7||i instanceof u7?i.context:void 0}}})}}var Ki={},mE={},Rw={},jv={},Mw={},Dw={},_ne=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object")},tm=_ne();const wne=tm.fetch,y$=tm.fetch.bind(tm),_$=tm.Headers,bne=tm.Request,jne=tm.Response,Zm=Object.freeze(Object.defineProperty({__proto__:null,Headers:_$,Request:bne,Response:jne,default:y$,fetch:wne},Symbol.toStringTag,{value:"Module"})),Nne=XY(Zm);var Iw={};Object.defineProperty(Iw,"__esModule",{value:!0});let Sne=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Iw.default=Sne;var w$=Ks&&Ks.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Dw,"__esModule",{value:!0});const kne=w$(Nne),Ene=w$(Iw);let Cne=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch=="undefined"?this.fetch=kne.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(a=>E(this,null,function*(){var o,l,c,d;let u=null,h=null,f=null,p=a.status,x=a.statusText;if(a.ok){if(this.method!=="HEAD"){const w=yield a.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?h=w:h=JSON.parse(w))}const v=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),_=(c=a.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");v&&_&&_.length>1&&(f=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(u={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,f=null,p=406,x="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const v=yield a.text();try{u=JSON.parse(v),Array.isArray(u)&&a.status===404&&(h=[],u=null,p=200,x="OK")}catch(_){a.status===404&&v===""?(p=204,x="No Content"):u={message:v}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,p=200,x="OK"),u&&this.shouldThrowOnError)throw new Ene.default(u)}return{error:u,data:h,count:f,status:p,statusText:x}}));return this.shouldThrowOnError||(i=i.catch(a=>{var o,l,c;return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(l=a==null?void 0:a.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=a==null?void 0:a.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,r)}returns(){return this}overrideTypes(){return this}};Dw.default=Cne;var Pne=Ks&&Ks.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mw,"__esModule",{value:!0});const Ane=Pne(Dw);let Tne=class extends Ane.default{select(t){let r=!1;const n=(t!=null?t:"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:i,referencedTable:a=i}={}){const o=a?`${a}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n=="undefined"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:i=n}={}){const a=typeof i=="undefined"?"offset":`${i}.offset`,o=typeof i=="undefined"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:a=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,a?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Mw.default=Tne;var One=Ks&&Ks.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jv,"__esModule",{value:!0});const Rne=One(Mw);let Mne=class extends Rne.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:i}={}){let a="";i==="plain"?a="pl":i==="phrase"?a="ph":i==="websearch"&&(a="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${a}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};jv.default=Mne;var Dne=Ks&&Ks.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Rw,"__esModule",{value:!0});const zp=Dne(jv);let Ine=class{constructor(t,{headers:r={},schema:n,fetch:i}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=i}select(t,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let a=!1;const o=(t!=null?t:"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new zp.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var i;const a="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new zp.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:a=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),i&&this.headers.append("Prefer",`count=${i}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new zp.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:r}={}){var n;const i="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new zp.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new zp.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Rw.default=Ine;var b$=Ks&&Ks.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(mE,"__esModule",{value:!0});const $ne=b$(Rw),Lne=b$(jv);let Fne=class j${constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=i}from(t){const r=new URL(`${this.url}/${t}`);return new $ne.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new j$(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:a}={}){var o;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;n||i?(l=n?"HEAD":"GET",Object.entries(r).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{c.searchParams.append(h,f)})):(l="POST",d=r);const u=new Headers(this.headers);return a&&u.set("Prefer",`count=${a}`),new Lne.default({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};mE.default=Fne;var Xm=Ks&&Ks.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ki,"__esModule",{value:!0});Ki.PostgrestError=Ki.PostgrestBuilder=Ki.PostgrestTransformBuilder=Ki.PostgrestFilterBuilder=Ki.PostgrestQueryBuilder=Ki.PostgrestClient=void 0;const N$=Xm(mE);Ki.PostgrestClient=N$.default;const S$=Xm(Rw);Ki.PostgrestQueryBuilder=S$.default;const k$=Xm(jv);Ki.PostgrestFilterBuilder=k$.default;const E$=Xm(Mw);Ki.PostgrestTransformBuilder=E$.default;const C$=Xm(Dw);Ki.PostgrestBuilder=C$.default;const P$=Xm(Iw);Ki.PostgrestError=P$.default;var Une=Ki.default={PostgrestClient:N$.default,PostgrestQueryBuilder:S$.default,PostgrestFilterBuilder:k$.default,PostgrestTransformBuilder:E$.default,PostgrestBuilder:C$.default,PostgrestError:P$.default};const{PostgrestClient:Bne,PostgrestQueryBuilder:gFe,PostgrestFilterBuilder:vFe,PostgrestTransformBuilder:xFe,PostgrestBuilder:yFe,PostgrestError:_Fe}=Une;class zne{static detectEnvironment(){var t;if(typeof WebSocket!="undefined")return{type:"native",constructor:WebSocket};if(typeof globalThis!="undefined"&&typeof globalThis.WebSocket!="undefined")return{type:"native",constructor:globalThis.WebSocket};if(typeof global!="undefined"&&typeof global.WebSocket!="undefined")return{type:"native",constructor:global.WebSocket};if(typeof globalThis!="undefined"&&typeof globalThis.WebSocketPair!="undefined"&&typeof globalThis.WebSocket=="undefined")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis!="undefined"&&globalThis.EdgeRuntime||typeof navigator!="undefined"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process!="undefined"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket!="undefined"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch(t){return!1}}}const Vne="2.15.5",qne=`realtime-js/${Vne}`,Wne="1.0.0",M3=1e4,Hne=1e3,Gne=100;var R0;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(R0||(R0={}));var Cs;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Cs||(Cs={}));var xo;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(xo||(xo={}));var D3;(function(e){e.websocket="websocket"})(D3||(D3={}));var su;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(su||(su={}));class Yne{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),a=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(t.slice(o,o+i));o=o+i;const c=n.decode(t.slice(o,o+a));o=o+a;const d=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class A${constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Cn;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Cn||(Cn={}));const h7=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((a,o)=>(a[o]=Kne(o,e,t,i),a),{})},Kne=(e,t,r,n)=>{const i=t.find(l=>l.name===e),a=i==null?void 0:i.type,o=r[e];return a&&!n.includes(a)?T$(a,o):I3(o)},T$=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Qne(t,r)}switch(e){case Cn.bool:return Zne(t);case Cn.float4:case Cn.float8:case Cn.int2:case Cn.int4:case Cn.int8:case Cn.numeric:case Cn.oid:return Xne(t);case Cn.json:case Cn.jsonb:return Jne(t);case Cn.timestamp:return ese(t);case Cn.abstime:case Cn.date:case Cn.daterange:case Cn.int4range:case Cn.int8range:case Cn.money:case Cn.reltime:case Cn.text:case Cn.time:case Cn.timestamptz:case Cn.timetz:case Cn.tsrange:case Cn.tstzrange:return I3(t);default:return I3(t)}},I3=e=>e,Zne=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Xne=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Jne=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Qne=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const o=e.slice(1,r);try{a=JSON.parse("["+o+"]")}catch(l){a=o?o.split(","):[]}return a.map(l=>T$(t,l))}return e},ese=e=>typeof e=="string"?e.replace(" ","T"):e,O$=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class nj{constructor(t,r,n={},i=M3){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var m7;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(m7||(m7={}));class M0{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=M0.syncState(this.state,i,a,o),this.pendingDiffs.forEach(c=>{this.state=M0.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=M0.syncDiff(this.state,i,a,o),l())}),this.onJoin((i,a,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:o})}),this.onLeave((i,a,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const a=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(a,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const h=a[d];if(h){const f=u.map(v=>v.presence_ref),p=h.map(v=>v.presence_ref),x=u.filter(v=>p.indexOf(v.presence_ref)<0),g=h.filter(v=>f.indexOf(v.presence_ref)<0);x.length>0&&(l[d]=x),g.length>0&&(c[d]=g)}else l[d]=u}),this.syncDiff(a,{joins:l,leaves:c},n,i)}static syncDiff(t,r,n,i){const{joins:a,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(a,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const h=t[l].map(p=>p.presence_ref),f=u.filter(p=>h.indexOf(p.presence_ref)<0);t[l].unshift(...f)}n(l,u,c)}),this.map(o,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),t[l]=d,i(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var p7;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(p7||(p7={}));var D0;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(D0||(D0={}));var Gl;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Gl||(Gl={}));class pE{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Cs.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new nj(this,xo.join,this.params,this.timeout),this.rejoinTimer=new A$(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Cs.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Cs.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Cs.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Cs.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Cs.errored,this.rejoinTimer.scheduleTimeout())}),this._on(xo.reply,{},(i,a)=>{this._trigger(this._replyEventName(a),i)}),this.presence=new M0(this),this.broadcastEndpointURL=O$(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,i,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Cs.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[D0.PRESENCE]&&this.bindings[D0.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>t==null?void 0:t(Gl.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(Gl.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",x=>E(this,[x],function*({postgres_changes:p}){var g;if(this.socket.setAuth(),p===void 0){t==null||t(Gl.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,_=(g=v==null?void 0:v.length)!==null&&g!==void 0?g:0,w=[];for(let b=0;b<_;b++){const N=v[b],{filter:{event:S,schema:k,table:O,filter:A}}=N,T=p&&p[b];if(T&&T.event===S&&T.schema===k&&T.table===O&&T.filter===A)w.push(Object.assign(Object.assign({},N),{id:T.id}));else{this.unsubscribe(),this.state=Cs.errored,t==null||t(Gl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(Gl.SUBSCRIBED);return}})).receive("error",p=>{this.state=Cs.errored,t==null||t(Gl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Gl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(n){return E(this,arguments,function*(t,r={}){return yield this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)})}untrack(){return E(this,arguments,function*(t={}){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,r,n){return this.state===Cs.joined&&t===D0.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}send(n){return E(this,arguments,function*(t,r={}){var i,a;if(!this._canPush()&&t.type==="broadcast"){const{event:o,payload:l}=t,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:l,private:this.private}]})};try{const u=yield this._fetchWithTimeout(this.broadcastEndpointURL,d,(i=r.timeout)!==null&&i!==void 0?i:this.timeout);return yield(a=u.body)===null||a===void 0?void 0:a.cancel(),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var l,c,d;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&o("ok"),u.receive("ok",()=>o("ok")),u.receive("error",()=>o("error")),u.receive("timeout",()=>o("timed out"))})})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Cs.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(xo.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new nj(this,xo.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Cs.closed,this.bindings={}}_fetchWithTimeout(t,r,n){return E(this,null,function*(){const i=new AbortController,a=setTimeout(()=>i.abort(),n),o=yield this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(a),o})}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new nj(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Gne){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,a;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=xo;if(n&&[l,c,d,u].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var x,g,v;return((x=p.filter)===null||x===void 0?void 0:x.event)==="*"||((v=(g=p.filter)===null||g===void 0?void 0:g.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(p=>p.callback(f,n)):(a=this.bindings[o])===null||a===void 0||a.filter(p=>{var x,g,v,_,w,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const N=p.id,S=(x=p.filter)===null||x===void 0?void 0:x.event;return N&&((g=r.ids)===null||g===void 0?void 0:g.includes(N))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const N=(w=(_=p==null?void 0:p.filter)===null||_===void 0?void 0:_.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return N==="*"||N===((b=r==null?void 0:r.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const x=f.data,{schema:g,table:v,commit_timestamp:_,type:w,errors:b}=x;f=Object.assign(Object.assign({},{schema:g,table:v,commit_timestamp:_,eventType:w,new:{},old:{},errors:b}),this._getPayloadRecords(x))}p.callback(f,n)})}_isClosed(){return this.state===Cs.closed}_isJoined(){return this.state===Cs.joined}_isJoining(){return this.state===Cs.joining}_isLeaving(){return this.state===Cs.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),a={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&pE.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(xo.close,{},t)}_onError(t){this._on(xo.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Cs.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=h7(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=h7(t.columns,t.old_record)),r}}const sj=()=>{},Vx={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},tse=[1e3,2e3,5e3,1e4],rse=1e4,nse=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class sse{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=M3,this.transport=null,this.heartbeatIntervalMs=Vx.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=sj,this.ref=0,this.reconnectTimer=null,this.logger=sj,this.conn=null,this.sendBuffer=[],this.serializer=new Yne,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch=="undefined"?a=(...o)=>on(()=>E(this,null,function*(){const{default:l}=yield Promise.resolve().then(()=>Zm);return{default:l}}),void 0,import.meta.url).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${D3.websocket}`,this.httpEndpoint=O$(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=zne.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Wne}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r!=null?r:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}removeChannel(t){return E(this,null,function*(){const r=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),r})}removeAllChannels(){return E(this,null,function*(){const t=yield Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t})}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case R0.connecting:return su.Connecting;case R0.open:return su.Open;case R0.closing:return su.Closing;default:return su.Closed}}isConnected(){return this.connectionState()===su.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(a=>a.topic===n);if(i)return i;{const a=new pE(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:i,ref:a}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${a})`,i),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(t=null){return E(this,null,function*(){this._authPromise=this._performAuth(t);try{yield this._authPromise}finally{this._authPromise=null}})}sendHeartbeat(){return E(this,null,function*(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Hne,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Vx.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")})}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:a,ref:o}=r,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${n} ${i} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(i,a,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(xo.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([nse],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}_performAuth(t=null){return E(this,null,function*(){let r;t?r=t:this.accessToken?r=yield this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:qne};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(xo.access_token,{access_token:r})}))})}_waitForAuthIfNeeded(){return E(this,null,function*(){this._authPromise&&(yield this._authPromise)})}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new A$(()=>E(this,null,function*(){setTimeout(()=>E(this,null,function*(){yield this._waitForAuthIfNeeded(),this.isConnected()||this.connect()}),Vx.RECONNECT_DELAY)}),this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,a,o,l,c,d,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:M3,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:Vx.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:sj,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:h=>tse[h-1]||rse,this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(h,f)=>f(JSON.stringify(h)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window!="undefined"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class gE extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Ps(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class ise extends gE{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class $3 extends gE{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var ase=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(h){o(h)}}function c(u){try{d(n.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const R$=e=>{let t;return e?t=e:typeof fetch=="undefined"?t=(...r)=>on(()=>E(void 0,null,function*(){const{default:n}=yield Promise.resolve().then(()=>Zm);return{default:n}}),void 0,import.meta.url).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},ose=()=>ase(void 0,void 0,void 0,function*(){return typeof Response=="undefined"?(yield on(()=>Promise.resolve().then(()=>Zm),void 0,import.meta.url)).Response:Response}),L3=e=>{if(Array.isArray(e))return e.map(r=>L3(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[i]=L3(n)}),t},lse=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var uf=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(h){o(h)}}function c(u){try{d(n.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const ij=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),cse=(e,t,r)=>uf(void 0,void 0,void 0,function*(){const n=yield ose();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{const a=e.status||500,o=(i==null?void 0:i.statusCode)||a+"";t(new ise(ij(i),a,o))}).catch(i=>{t(new $3(ij(i),i))}):t(new $3(ij(e),e))}),dse=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?i:(lse(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),r))};function Nv(e,t,r,n,i,a){return uf(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,dse(t,n,i,a)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>cse(c,l,n))})})}function E2(e,t,r,n){return uf(this,void 0,void 0,function*(){return Nv(e,"GET",t,r,n)})}function Zo(e,t,r,n,i){return uf(this,void 0,void 0,function*(){return Nv(e,"POST",t,n,i,r)})}function F3(e,t,r,n,i){return uf(this,void 0,void 0,function*(){return Nv(e,"PUT",t,n,i,r)})}function use(e,t,r,n){return uf(this,void 0,void 0,function*(){return Nv(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function M$(e,t,r,n,i){return uf(this,void 0,void 0,function*(){return Nv(e,"DELETE",t,n,i,r)})}var ki=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(h){o(h)}}function c(u){try{d(n.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const fse={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},g7={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class hse{constructor(t,r={},n,i){this.url=t,this.headers=r,this.bucketId=n,this.fetch=R$(i)}uploadOrUpdate(t,r,n,i){return ki(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},g7),i);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob!="undefined"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",n)):typeof FormData!="undefined"&&n instanceof FormData?(a=n,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),h=yield(t=="PUT"?F3:Zo)(this.fetch,`${this.url}/object/${u}`,a,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(a){if(Ps(a))return{data:null,error:a};throw a}})}upload(t,r,n){return ki(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return ki(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:g7.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob!="undefined"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData!="undefined"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield F3(this.fetch,l.toString(),c,{headers:u});return{data:{path:a,fullPath:h.Key},error:null}}catch(c){if(Ps(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return ki(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const a=yield Zo(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new gE("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(Ps(n))return{data:null,error:n};throw n}})}update(t,r,n){return ki(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return ki(this,void 0,void 0,function*(){try{return{data:yield Zo(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(Ps(i))return{data:null,error:i};throw i}})}copy(t,r,n){return ki(this,void 0,void 0,function*(){try{return{data:{path:(yield Zo(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(Ps(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return ki(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),a=yield Zo(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(i){if(Ps(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return ki(this,void 0,void 0,function*(){try{const i=yield Zo(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(i){if(Ps(i))return{data:null,error:i};throw i}})}download(t,r){return ki(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)!="undefined"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=a?`?${a}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield E2(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Ps(l))return{data:null,error:l};throw l}})}info(t){return ki(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield E2(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:L3(n),error:null}}catch(n){if(Ps(n))return{data:null,error:n};throw n}})}exists(t){return ki(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield use(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Ps(n)&&n instanceof $3){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&i.push(a);const l=typeof(r==null?void 0:r.transform)!="undefined"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&i.push(c);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(t){return ki(this,void 0,void 0,function*(){try{return{data:yield M$(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Ps(r))return{data:null,error:r};throw r}})}list(t,r,n){return ki(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},fse),r),{prefix:t||""});return{data:yield Zo(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(Ps(i))return{data:null,error:i};throw i}})}listV2(t,r){return ki(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Zo(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Ps(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer!="undefined"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const mse="2.11.0",pse={"X-Client-Info":`storage-js/${mse}`};var Af=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(h){o(h)}}function c(u){try{d(n.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class gse{constructor(t,r={},n,i){const a=new URL(t);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},pse),r),this.fetch=R$(n)}listBuckets(){return Af(this,void 0,void 0,function*(){try{return{data:yield E2(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Ps(t))return{data:null,error:t};throw t}})}getBucket(t){return Af(this,void 0,void 0,function*(){try{return{data:yield E2(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Ps(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Af(this,void 0,void 0,function*(){try{return{data:yield Zo(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Ps(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Af(this,void 0,void 0,function*(){try{return{data:yield F3(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Ps(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Af(this,void 0,void 0,function*(){try{return{data:yield Zo(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Ps(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Af(this,void 0,void 0,function*(){try{return{data:yield M$(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Ps(r))return{data:null,error:r};throw r}})}}class vse extends gse{constructor(t,r={},n,i){super(t,r,n,i)}from(t){return new hse(this.url,this.headers,t,this.fetch)}}const xse="2.57.2";let x0="";typeof Deno!="undefined"?x0="deno":typeof document!="undefined"?x0="web":typeof navigator!="undefined"&&navigator.product==="ReactNative"?x0="react-native":x0="node";const yse={"X-Client-Info":`supabase-js-${x0}/${xse}`},_se={headers:yse},wse={schema:"public"},bse={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},jse={};var Nse=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(h){o(h)}}function c(u){try{d(n.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const Sse=e=>{let t;return e?t=e:typeof fetch=="undefined"?t=y$:t=fetch,(...r)=>t(...r)},kse=()=>typeof Headers=="undefined"?_$:Headers,Ese=(e,t,r)=>{const n=Sse(r),i=kse();return(a,o)=>Nse(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let d=new i(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(a,Object.assign(Object.assign({},o),{headers:d}))})};var Cse=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(h){o(h)}}function c(u){try{d(n.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};function Pse(e){return e.endsWith("/")?e:e+"/"}function Ase(e,t){var r,n;const{db:i,auth:a,realtime:o,global:l}=e,{db:c,auth:d,realtime:u,global:h}=t,f={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>Cse(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}const D$="2.71.1",Gf=30*1e3,U3=3,aj=U3*Gf,Tse="http://localhost:9999",Ose="supabase.auth.token",Rse={"X-Client-Info":`gotrue-js/${D$}`},B3="X-Supabase-Api-Version",I$={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Mse=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Dse=10*60*1e3;class vE extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Sr(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Ise extends vE{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function $se(e){return Sr(e)&&e.name==="AuthApiError"}class $$ extends vE{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Dd extends vE{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class qc extends Dd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Lse(e){return Sr(e)&&e.name==="AuthSessionMissingError"}class qx extends Dd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Wx extends Dd{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Hx extends Dd{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Fse(e){return Sr(e)&&e.name==="AuthImplicitGrantRedirectError"}class v7 extends Dd{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class z3 extends Dd{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function oj(e){return Sr(e)&&e.name==="AuthRetryableFetchError"}class x7 extends Dd{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class V3 extends Dd{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const C2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),y7=` 	
\r=`.split(""),Use=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<y7.length;t+=1)e[y7[t].charCodeAt(0)]=-2;for(let t=0;t<C2.length;t+=1)e[C2[t].charCodeAt(0)]=t;return e})();function _7(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(C2[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(C2[n]),t.queuedBits-=6}}function L$(e,t,r){const n=Use[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function w7(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=o=>{Vse(o,n,r)};for(let o=0;o<e.length;o+=1)L$(e.charCodeAt(o),i,a);return t.join("")}function Bse(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function zse(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}Bse(n,t)}}function Vse(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function qse(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)L$(e.charCodeAt(i),r,n);return new Uint8Array(t)}function Wse(e){const t=[];return zse(e,r=>t.push(r)),new Uint8Array(t)}function Hse(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>_7(i,r,n)),_7(null,r,n),t.join("")}function Gse(e){return Math.round(Date.now()/1e3)+e}function Yse(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const co=()=>typeof window!="undefined"&&typeof document!="undefined",Hd={tested:!1,writable:!1},F$=()=>{if(!co())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch(t){return!1}if(Hd.tested)return Hd.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Hd.tested=!0,Hd.writable=!0}catch(t){Hd.tested=!0,Hd.writable=!1}return Hd.writable};function Kse(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,a)=>{t[a]=i})}catch(n){}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const U$=e=>{let t;return e?t=e:typeof fetch=="undefined"?t=(...r)=>on(()=>E(void 0,null,function*(){const{default:n}=yield Promise.resolve().then(()=>Zm);return{default:n}}),void 0,import.meta.url).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Zse=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Yf=(e,t,r)=>E(void 0,null,function*(){yield e.setItem(t,JSON.stringify(r))}),Gd=(e,t)=>E(void 0,null,function*(){const r=yield e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(n){return r}}),Bc=(e,t)=>E(void 0,null,function*(){yield e.removeItem(t)});class $w{constructor(){this.promise=new $w.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}$w.promiseConstructor=Promise;function lj(e){const t=e.split(".");if(t.length!==3)throw new V3("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Mse.test(t[n]))throw new V3("JWT not in base64url format");return{header:JSON.parse(w7(t[0])),payload:JSON.parse(w7(t[1])),signature:qse(t[2]),raw:{header:t[0],payload:t[1]}}}function Xse(e){return E(this,null,function*(){return yield new Promise(t=>{setTimeout(()=>t(null),e)})})}function Jse(e,t){return new Promise((n,i)=>{E(this,null,function*(){for(let a=0;a<1/0;a++)try{const o=yield e(a);if(!t(a,null,o)){n(o);return}}catch(o){if(!t(a,o)){i(o);return}}})})}function Qse(e){return("0"+e.toString(16)).substr(-2)}function eie(){const t=new Uint32Array(56);if(typeof crypto=="undefined"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let a=0;a<56;a++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,Qse).join("")}function tie(e){return E(this,null,function*(){const r=new TextEncoder().encode(e),n=yield crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(a=>String.fromCharCode(a)).join("")})}function rie(e){return E(this,null,function*(){if(!(typeof crypto!="undefined"&&typeof crypto.subtle!="undefined"&&typeof TextEncoder!="undefined"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=yield tie(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}function Tf(e,t,r=!1){return E(this,null,function*(){const n=eie();let i=n;r&&(i+="/PASSWORD_RECOVERY"),yield Yf(e,`${t}-code-verifier`,i);const a=yield rie(n);return[a,n===a?"plain":"s256"]})}const nie=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function sie(e){const t=e.headers.get(B3);if(!t||!t.match(nie))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(r){return null}}function iie(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function aie(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const oie=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Of(e){if(!oie.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function cj(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function b7(e){return JSON.parse(JSON.stringify(e))}var lie=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const Qd=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),cie=[502,503,504];function j7(e){return E(this,null,function*(){var t;if(!Zse(e))throw new z3(Qd(e),0);if(cie.includes(e.status))throw new z3(Qd(e),e.status);let r;try{r=yield e.json()}catch(a){throw new $$(Qd(a),a)}let n;const i=sie(e);if(i&&i.getTime()>=I$["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new x7(Qd(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new qc}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new x7(Qd(r),e.status,r.weak_password.reasons);throw new Ise(Qd(r),e.status||500,n)})}const die=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};function $r(e,t,r,n){return E(this,null,function*(){var i;const a=Object.assign({},n==null?void 0:n.headers);a[B3]||(a[B3]=I$["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=yield uie(e,t,r+l,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}})}function uie(e,t,r,n,i,a){return E(this,null,function*(){const o=die(t,n,i,a);let l;try{l=yield e(r,Object.assign({},o))}catch(c){throw console.error(c),new z3(Qd(c),0)}if(l.ok||(yield j7(l)),n!=null&&n.noResolveJson)return l;try{return yield l.json()}catch(c){yield j7(c)}})}function Vl(e){var t;let r=null;pie(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Gse(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function N7(e){const t=Vl(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Jc(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function fie(e){return{data:e,error:null}}function hie(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a}=e,o=lie(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function mie(e){return e}function pie(e){return e.access_token&&e.refresh_token&&e.expires_in}const dj=["global","local","others"];var gie=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class vie{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=U$(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(n){return E(this,arguments,function*(t,r=dj[0]){if(dj.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${dj.join(", ")}`);try{return yield $r(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(Sr(i))return{data:null,error:i};throw i}})}inviteUserByEmail(n){return E(this,arguments,function*(t,r={}){try{return yield $r(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Jc})}catch(i){if(Sr(i))return{data:{user:null},error:i};throw i}})}generateLink(t){return E(this,null,function*(){try{const{options:r}=t,n=gie(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),yield $r(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:hie,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Sr(r))return{data:{properties:null,user:null},error:r};throw r}})}createUser(t){return E(this,null,function*(){try{return yield $r(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Jc})}catch(r){if(Sr(r))return{data:{user:null},error:r};throw r}})}listUsers(t){return E(this,null,function*(){var r,n,i,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=yield $r(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:mie});if(u.error)throw u.error;const h=yield u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(x=>{const g=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(x.split(";")[1].split("=")[1]);d[`${v}Page`]=g}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(Sr(d))return{data:{users:[]},error:d};throw d}})}getUserById(t){return E(this,null,function*(){Of(t);try{return yield $r(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Jc})}catch(r){if(Sr(r))return{data:{user:null},error:r};throw r}})}updateUserById(t,r){return E(this,null,function*(){Of(t);try{return yield $r(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Jc})}catch(n){if(Sr(n))return{data:{user:null},error:n};throw n}})}deleteUser(t,r=!1){return E(this,null,function*(){Of(t);try{return yield $r(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Jc})}catch(n){if(Sr(n))return{data:{user:null},error:n};throw n}})}_listFactors(t){return E(this,null,function*(){Of(t.userId);try{const{data:r,error:n}=yield $r(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Sr(r))return{data:null,error:r};throw r}})}_deleteFactor(t){return E(this,null,function*(){Of(t.userId),Of(t.id);try{return{data:yield $r(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Sr(r))return{data:null,error:r};throw r}})}}function S7(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function xie(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){typeof self!="undefined"&&(self.globalThis=self)}}const Rf={debug:!!(globalThis&&F$()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class B$ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class yie extends B${}function _ie(e,t,r){return E(this,null,function*(){Rf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Rf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},i=>E(this,null,function*(){if(i){Rf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return yield r()}finally{Rf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Rf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new yie(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Rf.debug)try{const a=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield r()}})))})}xie();const wie={url:Tse,storageKey:Ose,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Rse,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};function k7(e,t,r){return E(this,null,function*(){return yield r()})}const Mf={};class gg{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=gg.nextInstanceID,gg.nextInstanceID+=1,this.instanceID>0&&co()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},wie),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new vie({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=U$(i.fetch),this.lock=i.lock||k7,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:co()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=_ie:this.lock=k7,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:F$()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=S7(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=S7(this.memoryStorage)),co()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",a=>E(this,null,function*(){this._debug("received broadcast notification from other tab or client",a),yield this._notifyAllSubscribers(a.data.event,a.data.session,!1)}))}this.initialize()}get jwks(){var t,r;return(r=(t=Mf[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Mf[this.storageKey]=Object.assign(Object.assign({},Mf[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Mf[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Mf[this.storageKey]=Object.assign(Object.assign({},Mf[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${D$}) ${new Date().toISOString()}`,...t),this}initialize(){return E(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=E(this,null,function*(){return yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._initialize()}))}),yield this.initializePromise)})}_initialize(){return E(this,null,function*(){var t;try{const r=Kse(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":(yield this._isPKCECallback(r))&&(n="pkce"),co()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:a}=yield this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Fse(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return yield this._removeSession(),{error:a}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),yield this._saveSession(o),setTimeout(()=>E(this,null,function*(){l==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",o):yield this._notifyAllSubscribers("SIGNED_IN",o)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(r){return Sr(r)?{error:r}:{error:new $$("Unexpected error during initialization",r)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(t){return E(this,null,function*(){var r,n,i;try{const a=yield $r(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:Vl}),{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Sr(a))return{data:{user:null,session:null},error:a};throw a}})}signUp(t){return E(this,null,function*(){var r,n,i;try{let a;if("email"in t){const{email:u,password:h,options:f}=t;let p=null,x=null;this.flowType==="pkce"&&([p,x]=yield Tf(this.storage,this.storageKey)),a=yield $r(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:x},xform:Vl})}else if("phone"in t){const{phone:u,password:h,options:f}=t;a=yield $r(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Vl})}else throw new Wx("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Sr(a))return{data:{user:null,session:null},error:a};throw a}})}signInWithPassword(t){return E(this,null,function*(){try{let r;if("email"in t){const{email:a,password:o,options:l}=t;r=yield $r(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:N7})}else if("phone"in t){const{phone:a,password:o,options:l}=t;r=yield $r(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:N7})}else throw new Wx("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new qx}:(n.session&&(yield this._saveSession(n.session),yield this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Sr(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOAuth(t){return E(this,null,function*(){var r,n,i,a;return yield this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})})}exchangeCodeForSession(t){return E(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>E(this,null,function*(){return this._exchangeCodeForSession(t)}))})}signInWithWeb3(t){return E(this,null,function*(){const{chain:r}=t;if(r==="solana")return yield this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)})}signInWithSolana(t){return E(this,null,function*(){var r,n,i,a,o,l,c,d,u,h,f,p;let x,g;if("message"in t)x=t.message,g=t.signature;else{const{chain:v,wallet:_,statement:w,options:b}=t;let N;if(co())if(typeof _=="object")N=_;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))N=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=_}const S=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in N&&N.signIn){const k=yield N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),w?{statement:w}:null));let O;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")O=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)O=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)x=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),g=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${S.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(i=(n=b==null?void 0:b.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=b==null?void 0:b.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((h=(u=b==null?void 0:b.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...b.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const k=yield N.signMessage(new TextEncoder().encode(x),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=k}}try{const{data:v,error:_}=yield $r(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:Hse(g)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Vl});if(_)throw _;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new qx}:(v.session&&(yield this._saveSession(v.session),yield this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:_})}catch(v){if(Sr(v))return{data:{user:null,session:null},error:v};throw v}})}_exchangeCodeForSession(t){return E(this,null,function*(){const r=yield Gd(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r!=null?r:"").split("/");try{const{data:a,error:o}=yield $r(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Vl});if(yield Bc(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new qx}:(a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:i!=null?i:null}),error:o})}catch(a){if(Sr(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}})}signInWithIdToken(t){return E(this,null,function*(){try{const{options:r,provider:n,token:i,access_token:a,nonce:o}=t,l=yield $r(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Vl}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new qx}:(c.session&&(yield this._saveSession(c.session),yield this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(Sr(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOtp(t){return E(this,null,function*(){var r,n,i,a,o;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=yield Tf(this.storage,this.storageKey));const{error:h}=yield $r(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=yield $r(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new Wx("You must provide either an email or phone number.")}catch(l){if(Sr(l))return{data:{user:null,session:null},error:l};throw l}})}verifyOtp(t){return E(this,null,function*(){var r,n;try{let i,a;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=yield $r(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:Vl});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(yield this._saveSession(c),yield this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Sr(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithSSO(t){return E(this,null,function*(){var r,n,i;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=yield Tf(this.storage,this.storageKey)),yield $r(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:fie})}catch(a){if(Sr(a))return{data:null,error:a};throw a}})}reauthenticate(){return E(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return E(this,null,function*(){try{return yield this._useSession(t=>E(this,null,function*(){const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new qc;const{error:i}=yield $r(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}}))}catch(t){if(Sr(t))return{data:{user:null,session:null},error:t};throw t}})}resend(t){return E(this,null,function*(){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:a}=t,{error:o}=yield $r(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:i,options:a}=t,{data:o,error:l}=yield $r(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Wx("You must provide either an email or phone number and a type")}catch(r){if(Sr(r))return{data:{user:null,session:null},error:r};throw r}})}getSession(){return E(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return this._useSession(r=>E(this,null,function*(){return r}))}))})}_acquireLock(t,r){return E(this,null,function*(){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=E(this,null,function*(){return yield n,yield r()});return this.pendingInLock.push(E(this,null,function*(){try{yield i}catch(a){}})),i}return yield this.lock(`lock:${this.storageKey}`,t,()=>E(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push(E(this,null,function*(){try{yield n}catch(i){}})),yield n;this.pendingInLock.length;){const i=[...this.pendingInLock];yield Promise.all(i),this.pendingInLock.splice(0,i.length)}return yield n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(t){return E(this,null,function*(){this._debug("#_useSession","begin");try{const r=yield this.__loadSession();return yield t(r)}finally{this._debug("#_useSession","end")}})}__loadSession(){return E(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=yield Gd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<aj:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=yield Gd(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=cj()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{session:i,error:a}=yield this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(t){return E(this,null,function*(){return t?yield this._getUser(t):(yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._getUser()})))})}_getUser(t){return E(this,null,function*(){try{return t?yield $r(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Jc}):yield this._useSession(r=>E(this,null,function*(){var n,i,a;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new qc}:yield $r(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:Jc})}))}catch(r){if(Sr(r))return Lse(r)&&(yield this._removeSession(),yield Bc(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}})}updateUser(n){return E(this,arguments,function*(t,r={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._updateUser(t,r)}))})}_updateUser(n){return E(this,arguments,function*(t,r={}){try{return yield this._useSession(i=>E(this,null,function*(){const{data:a,error:o}=i;if(o)throw o;if(!a.session)throw new qc;const l=a.session;let c=null,d=null;this.flowType==="pkce"&&t.email!=null&&([c,d]=yield Tf(this.storage,this.storageKey));const{data:u,error:h}=yield $r(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:Jc});if(h)throw h;return l.user=u.user,yield this._saveSession(l),yield this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}}))}catch(i){if(Sr(i))return{data:{user:null},error:i};throw i}})}setSession(t){return E(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._setSession(t)}))})}_setSession(t){return E(this,null,function*(){try{if(!t.access_token||!t.refresh_token)throw new qc;const r=Date.now()/1e3;let n=r,i=!0,a=null;const{payload:o}=lj(t.access_token);if(o.exp&&(n=o.exp,i=n<=r),i){const{session:l,error:c}=yield this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=yield this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},yield this._saveSession(a),yield this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if(Sr(r))return{data:{session:null,user:null},error:r};throw r}})}refreshSession(t){return E(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._refreshSession(t)}))})}_refreshSession(t){return E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new qc;const{session:i,error:a}=yield this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}}))}catch(r){if(Sr(r))return{data:{user:null,session:null},error:r};throw r}})}_getSessionFromURL(t,r){return E(this,null,function*(){try{if(!co())throw new Hx("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Hx(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new v7("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Hx("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new v7("No code detected.");const{data:w,error:b}=yield this._exchangeCodeForSession(t.code);if(b)throw b;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=t;if(!a||!l||!o||!d)throw new Hx("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let f=u+h;c&&(f=parseInt(c));const p=f-u;p*1e3<=Gf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const x=f-h;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,f,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,f,u);const{data:g,error:v}=yield this._getUser(a);if(v)throw v;const _={provider_token:n,provider_refresh_token:i,access_token:a,expires_in:h,expires_at:f,refresh_token:o,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:_,redirectType:t.type},error:null}}catch(n){if(Sr(n))return{data:{session:null,redirectType:null},error:n};throw n}})}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}_isPKCECallback(t){return E(this,null,function*(){const r=yield Gd(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)})}signOut(){return E(this,arguments,function*(t={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){return yield this._signOut(t)}))})}_signOut(){return E(this,arguments,function*({scope:t}={scope:"global"}){return yield this._useSession(r=>E(this,null,function*(){var n;const{data:i,error:a}=r;if(a)return{error:a};const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=yield this.admin.signOut(o,t);if(l&&!($se(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(yield this._removeSession(),yield Bc(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))})}onAuthStateChange(t){const r=Yse(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),E(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){this._emitInitialSession(r)}))}),{data:{subscription:n}}}_emitInitialSession(t){return E(this,null,function*(){return yield this._useSession(r=>E(this,null,function*(){var n,i;try{const{data:{session:a},error:o}=r;if(o)throw o;yield(n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){yield(i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}}))})}resetPasswordForEmail(n){return E(this,arguments,function*(t,r={}){let i=null,a=null;this.flowType==="pkce"&&([i,a]=yield Tf(this.storage,this.storageKey,!0));try{return yield $r(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:i,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(Sr(o))return{data:null,error:o};throw o}})}getUserIdentities(){return E(this,null,function*(){var t;try{const{data:r,error:n}=yield this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Sr(r))return{data:null,error:r};throw r}})}linkIdentity(t){return E(this,null,function*(){var r;try{const{data:n,error:i}=yield this._useSession(a=>E(this,null,function*(){var o,l,c,d,u;const{data:h,error:f}=a;if(f)throw f;const p=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return yield $r(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})}));if(i)throw i;return co()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Sr(n))return{data:{provider:t.provider,url:null},error:n};throw n}})}unlinkIdentity(t){return E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n,i;const{data:a,error:o}=r;if(o)throw o;return yield $r(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})}))}catch(r){if(Sr(r))return{data:null,error:r};throw r}})}_refreshAccessToken(t){return E(this,null,function*(){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return yield Jse(i=>E(this,null,function*(){return i>0&&(yield Xse(200*Math.pow(2,i-1))),this._debug(r,"refreshing attempt",i),yield $r(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Vl})}),(i,a)=>{const o=200*Math.pow(2,i);return a&&oj(a)&&Date.now()+o-n<Gf})}catch(n){if(this._debug(r,"error",n),Sr(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}})}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}_handleProviderSignIn(t,r){return E(this,null,function*(){const n=yield this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),co()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}})}_recoverAndRefresh(){return E(this,null,function*(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=yield Gd(this.storage,this.storageKey);if(i&&this.userStorage){let o=yield Gd(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},yield Yf(this.userStorage,this.storageKey+"-user",o)),i.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:cj()}else if(i&&!i.user&&!i.user){const o=yield Gd(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,yield Bc(this.storage,this.storageKey+"-user"),yield Yf(this.storage,this.storageKey,i)):i.user=cj()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&(yield this._removeSession());return}const a=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<aj;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${aj}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=yield this._callRefreshToken(i.refresh_token);o&&(console.error(o),oj(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),yield this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=yield this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,yield this._saveSession(i),yield this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else yield this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}})}_callRefreshToken(t){return E(this,null,function*(){var r,n;if(!t)throw new qc;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new $w;const{data:a,error:o}=yield this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new qc;yield this._saveSession(a.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(i,"error",a),Sr(a)){const o={session:null,error:a};return oj(a)||(yield this._removeSession()),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}})}_notifyAllSubscribers(t,r,n=!0){return E(this,null,function*(){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(l=>E(this,null,function*(){try{yield l.callback(t,r)}catch(c){a.push(c)}}));if(yield Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(i,"end")}})}_saveSession(t){return E(this,null,function*(){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&(yield Yf(this.userStorage,this.storageKey+"-user",{user:r.user}));const i=Object.assign({},r);delete i.user;const a=b7(i);yield Yf(this.storage,this.storageKey,a)}else{const i=b7(r);yield Yf(this.storage,this.storageKey,i)}})}_removeSession(){return E(this,null,function*(){this._debug("#_removeSession()"),yield Bc(this.storage,this.storageKey),yield Bc(this.storage,this.storageKey+"-code-verifier"),yield Bc(this.storage,this.storageKey+"-user"),this.userStorage&&(yield Bc(this.userStorage,this.storageKey+"-user")),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&co()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}_startAutoRefresh(){return E(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Gf);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno!="undefined"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(()=>E(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return E(this,null,function*(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)})}startAutoRefresh(){return E(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return E(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return E(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>E(this,null,function*(){try{const t=Date.now();try{return yield this._useSession(r=>E(this,null,function*(){const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Gf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Gf}ms, refresh threshold is ${U3} ticks`),i<=U3&&(yield this._callRefreshToken(n.refresh_token))}))}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(t){if(t.isAcquireTimeout||t instanceof B$)this._debug("auto refresh token tick lock not available");else throw t}})}_handleVisibilityChange(){return E(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!co()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>E(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})}_onVisibilityChanged(t){return E(this,null,function*(){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(yield this.initializePromise,yield this._acquireLock(-1,()=>E(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(t,r,n){return E(this,null,function*(){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=yield Tf(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);i.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`})}_unenroll(t){return E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n;const{data:i,error:a}=r;return a?{data:null,error:a}:yield $r(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})}))}catch(r){if(Sr(r))return{data:null,error:r};throw r}})}_enroll(t){return E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n,i;const{data:a,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:d}=yield $r(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})}))}catch(r){if(Sr(r))return{data:null,error:r};throw r}})}_verify(t){return E(this,null,function*(){return this._acquireLock(-1,()=>E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n;const{data:i,error:a}=r;if(a)return{data:null,error:a};const{data:o,error:l}=yield $r(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})}))}catch(r){if(Sr(r))return{data:null,error:r};throw r}}))})}_challenge(t){return E(this,null,function*(){return this._acquireLock(-1,()=>E(this,null,function*(){try{return yield this._useSession(r=>E(this,null,function*(){var n;const{data:i,error:a}=r;return a?{data:null,error:a}:yield $r(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})}))}catch(r){if(Sr(r))return{data:null,error:r};throw r}}))})}_challengeAndVerify(t){return E(this,null,function*(){const{data:r,error:n}=yield this._challenge({factorId:t.factorId});return n?{data:null,error:n}:yield this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})})}_listFactors(){return E(this,null,function*(){const{data:{user:t},error:r}=yield this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],i=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:i,phone:a},error:null}})}_getAuthenticatorAssuranceLevel(){return E(this,null,function*(){return this._acquireLock(-1,()=>E(this,null,function*(){return yield this._useSession(t=>E(this,null,function*(){var r,n;const{data:{session:i},error:a}=t;if(a)return{data:null,error:a};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=lj(i.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}))})}fetchJwk(n){return E(this,arguments,function*(t,r={keys:[]}){let i=r.keys.find(c=>c.kid===t);if(i)return i;const a=Date.now();if(i=this.jwks.keys.find(c=>c.kid===t),i&&this.jwks_cached_at+Dse>a)return i;const{data:o,error:l}=yield $r(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=a,i=o.keys.find(c=>c.kid===t),!i)?null:i})}getClaims(n){return E(this,arguments,function*(t,r={}){try{let i=t;if(!i){const{data:x,error:g}=yield this.getSession();if(g||!x.session)return{data:null,error:g};i=x.session.access_token}const{header:a,payload:o,signature:l,raw:{header:c,payload:d}}=lj(i);r!=null&&r.allowExpired||iie(o.exp);const u=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:yield this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:x}=yield this.getUser(i);if(x)throw x;return{data:{claims:o,header:a,signature:l},error:null}}const h=aie(a.alg),f=yield crypto.subtle.importKey("jwk",u,h,!0,["verify"]);if(!(yield crypto.subtle.verify(h,f,l,Wse(`${c}.${d}`))))throw new V3("Invalid JWT signature");return{data:{claims:o,header:a,signature:l},error:null}}catch(i){if(Sr(i))return{data:null,error:i};throw i}})}}gg.nextInstanceID=0;const bie=gg;class jie extends bie{constructor(t){super(t)}}var Nie=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{d(n.next(u))}catch(h){o(h)}}function c(u){try{d(n.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Sie{constructor(t,r,n){var i,a,o;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=Pse(t),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:wse,realtime:jse,auth:Object.assign(Object.assign({},bse),{storageKey:d}),global:_se},h=Ase(n!=null?n:{},u);this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=Ese(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Bne(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new vse(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new yne(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return Nie(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:a,storageKey:o,flowType:l,lock:c,debug:d},u,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jie({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:a,flowType:l,lock:c,debug:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new sse(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const kie=(e,t,r)=>new Sie(e,t,r);function Eie(){if(typeof window!="undefined"||typeof process=="undefined")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Eie()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Cie="https://glpiolbrafqikqhnseto.supabase.co",Pie="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdscGlvbGJyYWZxaWtxaG5zZXRvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5Mzc4MjQsImV4cCI6MjA3MjUxMzgyNH0.O5G3fW-YFtpACNqNfo_lsLK44F-3L3p69Ka-G2lSTLE",P=kie(Cie,Pie),Aie=Object.freeze(Object.defineProperty({__proto__:null,supabase:P},Symbol.toStringTag,{value:"Module"})),E7=["view","click","like","share","interest","search","review","comment","navigate","form_submit","profile_update","swipe","follow","unfollow","attendance","ticket_click","streaming_top","streaming_recent"],C7=["event","artist","venue","review","user","profile","view","form","ticket_link","song","album","playlist","genre","scene","search"];class Tie{constructor(){_r(this,"sessionId");_r(this,"eventQueue",[]);_r(this,"batchTimeout",null);_r(this,"BATCH_SIZE",10);_r(this,"BATCH_DELAY",2e3);_r(this,"sessionStartTime");_r(this,"sessionInteractions",0);_r(this,"sessionPageViews",0);_r(this,"UUID_REGEX",/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i);this.sessionId=this.generateSessionId(),this.sessionStartTime=new Date}generateSessionId(){return crypto.randomUUID()}isValidUuid(t){return typeof t=="string"&&this.UUID_REGEX.test(t)}normalizeInteractionEvent(t){return t.entityId&&this.isValidUuid(t.entityId)&&!t.entityUuid?W(M({},t),{entityUuid:t.entityId}):t}validateInteractionData(t){const r=[],n=[];if(t.eventType?E7.includes(t.eventType)||r.push(`Invalid eventType: ${t.eventType}. Must be one of: ${E7.join(", ")}`):r.push("eventType is required"),t.entityType?C7.includes(t.entityType)||r.push(`Invalid entityType: ${t.entityType}. Must be one of: ${C7.join(", ")}`):r.push("entityType is required"),!["search","view","form","ticket_link","song","album","playlist","genre","scene"].includes(t.entityType)?!t.entityUuid&&!t.entityId&&r.push(`entityUuid or entityId is required for entityType: ${t.entityType}`):t.entityId||n.push(`No entity identifier provided for entityType: ${t.entityType}. Consider providing entityId for better tracking.`),t.metadata){const o=this.validateMetadata(t.entityType,t.metadata);o.isValid||r.push(...o.errors),n.push(...o.warnings)}return{isValid:r.length===0,errors:r,warnings:n}}validateMetadata(t,r){const n=[],i=[];switch(t){case"event":r.artist_name&&typeof r.artist_name!="string"&&n.push("artist_name must be a string"),r.venue_name&&typeof r.venue_name!="string"&&n.push("venue_name must be a string"),r.event_date&&!this.isValidDate(r.event_date)&&n.push("event_date must be a valid ISO date string");break;case"artist":r.artist_name&&typeof r.artist_name!="string"&&n.push("artist_name must be a string"),r.genres&&!Array.isArray(r.genres)&&n.push("genres must be an array");break;case"venue":r.venue_name&&typeof r.venue_name!="string"&&n.push("venue_name must be a string"),r.venue_city&&typeof r.venue_city!="string"&&n.push("venue_city must be a string"),r.venue_state&&typeof r.venue_state!="string"&&n.push("venue_state must be a string");break;case"review":r.rating&&(typeof r.rating!="number"||r.rating<1||r.rating>5)&&n.push("rating must be a number between 1 and 5"),r.review_text&&typeof r.review_text!="string"&&n.push("review_text must be a string");break;case"ticket_link":r.price&&typeof r.price!="number"&&n.push("price must be a number"),r.currency&&typeof r.currency!="string"&&n.push("currency must be a string");break}return{isValid:n.length===0,errors:n,warnings:i}}isValidDate(t){const r=new Date(t);return r instanceof Date&&!isNaN(r.getTime())}logError(t,r,n){return E(this,null,function*(){console.error(`[${t}]`,r,n)})}calculateSessionMetrics(){const t=Date.now()-this.sessionStartTime.getTime(),r=this.calculateEngagementScore(),n=this.sessionPageViews<=1?100:0;return{duration:t,interactionCount:this.sessionInteractions,engagementScore:r,pageViews:this.sessionPageViews,bounceRate:n}}calculateEngagementScore(){if(this.sessionInteractions===0)return 0;const r=(Date.now()-this.sessionStartTime.getTime())/(1e3*60);let n=Math.min(this.sessionInteractions*10,50);return r>5&&(n+=20),r>15&&(n+=20),r>30&&(n+=10),r<1&&(n*=.5),Math.min(Math.round(n),100)}logInteraction(t){return E(this,null,function*(){const r=this.normalizeInteractionEvent(t);try{const n=this.validateInteractionData(r);if(!n.isValid){yield this.logError("interaction_validation_error",new Error(n.errors.join(", ")),r),console.warn("Invalid interaction data:",n.errors);return}n.warnings.length>0&&console.warn("Interaction validation warnings:",n.warnings);const{data:{user:i}}=yield P.auth.getUser();if(!i){console.warn("No authenticated user for interaction logging");return}if(this.sessionInteractions++,r.eventType==="view"&&this.sessionPageViews++,!["search","view","form","ticket_link","song","album","playlist","genre","scene"].includes(r.entityType)&&!r.entityUuid){console.warn(`Skipping interaction: entity_type '${r.entityType}' requires entity_uuid but it was not provided`,r);return}console.debug("Interaction logged:",r)}catch(n){yield this.logError("interaction_logging_exception",n,r),console.error("Error logging interaction:",n)}})}queueInteraction(t){this.eventQueue.push(W(M({},t),{sessionId:t.sessionId||this.sessionId,timestamp:new Date().toISOString()})),this.eventQueue.length>=this.BATCH_SIZE?this.flushBatch():(this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(()=>{this.flushBatch()},this.BATCH_DELAY))}flushBatch(){return E(this,null,function*(){if(this.eventQueue.length===0)return;const t=[...this.eventQueue];this.eventQueue=[],this.batchTimeout&&(clearTimeout(this.batchTimeout),this.batchTimeout=null);const r=[];try{const{data:{user:n}}=yield P.auth.getUser();if(!n){console.warn("No authenticated user for batch logging");return}const i=[];for(const l of t){const c=this.normalizeInteractionEvent(l),d=this.validateInteractionData(c);d.isValid?(d.warnings.length>0&&console.warn("Interaction validation warnings:",d.warnings,c),r.push(c)):(i.push({event:c,errors:d.errors}),yield this.logError("interaction_validation_error",new Error(d.errors.join(", ")),c),console.warn("Invalid interaction in batch:",d.errors,c))}if(r.length===0){console.warn("No valid interactions in batch to insert"),i.length>0&&console.warn(`Skipped ${i.length} invalid interactions`);return}const a=["search","view","form","ticket_link","song","album","playlist","genre","scene"],o=r.filter(l=>!a.includes(l.entityType)&&!l.entityUuid?(console.warn(`Skipping interaction: entity_type '${l.entityType}' requires entity_uuid but it was not provided`,l),!1):!0).map(l=>({user_id:n.id,session_id:l.sessionId||this.sessionId,event_type:l.eventType,entity_type:l.entityType,entity_id:l.entityId||null,entity_uuid:l.entityUuid||null,metadata:l.metadata||{}}));console.debug(` Logged ${o.length} interactions (console only)`,o),i.length>0&&console.warn(` Skipped ${i.length} invalid interactions`)}catch(n){console.error("Error logging interaction batch:",n);for(const i of r)yield this.logError("interaction_logging_exception",n,i)}})}flush(){return E(this,null,function*(){yield this.flushBatch()})}startNewSession(){return this.sessionId=this.generateSessionId(),this.sessionStartTime=new Date,this.sessionInteractions=0,this.sessionPageViews=0,this.sessionId}getSessionMetrics(){return this.calculateSessionMetrics()}getSessionId(){return this.sessionId}}const As=new Tie,wn={search:(e,t,r,n)=>{As.queueInteraction({eventType:"search",entityType:t,entityId:r,metadata:M({query:e},n)})},click:(e,t,r)=>{As.queueInteraction({eventType:"click",entityType:e,entityId:t,metadata:r})},like:(e,t,r,n)=>{As.queueInteraction({eventType:"like",entityType:e,entityId:t,metadata:M({isLiked:r},n)})},share:(e,t,r,n)=>{As.queueInteraction({eventType:"share",entityType:e,entityId:t,metadata:M({platform:r},n)})},comment:(e,t,r,n)=>{As.queueInteraction({eventType:"comment",entityType:e,entityId:t,metadata:M({commentLength:r},n)})},review:(e,t,r,n,i)=>{As.queueInteraction({eventType:"review",entityType:e,entityId:t,entityUuid:i||void 0,metadata:M({rating:r},n)})},interest:(e,t,r,n)=>{As.queueInteraction({eventType:"interest",entityType:e,entityId:t,metadata:M({isInterested:r},n)})},swipe:(e,t,r,n)=>{As.queueInteraction({eventType:"swipe",entityType:e,entityId:t,metadata:M({direction:r},n)})},view:(e,t,r,n)=>{As.queueInteraction({eventType:"view",entityType:e,entityId:t,metadata:M({duration:r},n)})},trackFeedImpression:(e,t)=>{As.queueInteraction({eventType:"view",entityType:"event",entityId:e,metadata:M({source:"feed",impression:!0},t)})},navigate:(e,t,r)=>{As.queueInteraction({eventType:"navigate",entityType:"view",entityId:t,metadata:M({fromView:e},r)})},formSubmit:(e,t,r,n,i)=>{As.queueInteraction({eventType:"form_submit",entityType:e,entityId:t,entityUuid:i||void 0,metadata:M({success:r},n)})},profileUpdate:(e,t,r)=>{As.queueInteraction({eventType:"profile_update",entityType:"profile",entityId:t,metadata:M({field:e},r)})}};typeof window!="undefined"&&window.addEventListener("beforeunload",()=>{As.flush()});const Oie=Object.freeze(Object.defineProperty({__proto__:null,interactionTracker:As,trackInteraction:wn},Symbol.toStringTag,{value:"Module"})),Rie={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APPLE_MUSIC_DEVELOPER_TOKEN:"your_apple_music_token",VITE_BACKEND_URL:"http://localhost:3001",VITE_JAMBASE_API_KEY:"e7ed3a9b-e73a-446e-b7c6-a96d1c53a030",VITE_SETLIST_FM_API_KEY:"QxGjjwxk0MUyxyCJa2FADnFRwEqFUy__7wpt",VITE_SPOTIFY_CLIENT_ID:"00c8ab88043a4d53bc3ec13684885ca9",VITE_SPOTIFY_REDIRECT_URI:"https://synth-beta-testing.vercel.app/auth/spotify/callback",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdscGlvbGJyYWZxaWtxaG5zZXRvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5Mzc4MjQsImV4cCI6MjA3MjUxMzgyNH0.O5G3fW-YFtpACNqNfo_lsLK44F-3L3p69Ka-G2lSTLE",VITE_SUPABASE_PROJECT_ID:"glpiolbrafqikqhnseto",VITE_SUPABASE_PUBLISHABLE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdscGlvbGJyYWZxaWtxaG5zZXRvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5Mzc4MjQsImV4cCI6MjA3MjUxMzgyNH0.O5G3fW-YFtpACNqNfo_lsLK44F-3L3p69Ka-G2lSTLE",VITE_SUPABASE_URL:"https://glpiolbrafqikqhnseto.supabase.co"},au=class au{constructor(){_r(this,"accessToken",null);_r(this,"config");const t="00c8ab88043a4d53bc3ec13684885ca9",r="https://synth-beta-testing.vercel.app/auth/spotify/callback";console.log(" Spotify Config Debug:",{hasClientId:!!t,hasRedirectUri:!!r,clientIdLength:t.length,redirectUri:r,envMode:"production",allEnvKeys:Object.keys(Rie)}),this.config={clientId:t,redirectUri:r,scopes:["user-read-private","user-read-email","user-top-read","user-read-recently-played","user-read-playback-state","user-read-currently-playing"]}}static getInstance(){return au.instance||(au.instance=new au),au.instance}isConfigured(){return!!(this.config.clientId&&this.config.redirectUri)}authenticate(){return E(this,null,function*(){if(!this.config.clientId||!this.config.redirectUri)throw console.warn("Spotify not configured. Missing VITE_SPOTIFY_CLIENT_ID or VITE_SPOTIFY_REDIRECT_URI environment variables."),new Error("Spotify integration is not configured. Please contact the administrator.");const t=this.generateRandomString(16),r=this.generateRandomString(64),n=yield this.generateCodeChallenge(r);localStorage.setItem("spotify_auth_state",t),localStorage.setItem("spotify_code_verifier",r);const i=new URL("https://accounts.spotify.com/authorize");i.searchParams.append("client_id",this.config.clientId),i.searchParams.append("response_type","code"),i.searchParams.append("redirect_uri",this.config.redirectUri),i.searchParams.append("state",t),i.searchParams.append("scope",this.config.scopes.join(" ")),i.searchParams.append("code_challenge_method","S256"),i.searchParams.append("code_challenge",n);try{wn.click("spotify",this.config.clientId,{action:"connect_start",scopes:this.config.scopes,redirectUri:this.config.redirectUri})}catch(a){}window.location.href=i.toString()})}reauthenticate(){console.log(" Forcing re-authentication..."),this.logout(),this.authenticate()}validateTokenAndReauthIfNeeded(){return E(this,null,function*(){if(!this.accessToken)return console.log(" No access token available"),!1;const t=new URLSearchParams(window.location.search);if(t.get("code")&&t.get("state"))return console.log(" Currently in auth callback, skipping token validation to avoid race condition"),!1;try{return console.log(" Validating token scopes..."),yield this.spotifyApiCall("/me"),console.log(" Token validation successful"),!0}catch(n){if(console.error(" Token validation failed:",n),n instanceof Error&&n.message.includes("403"))return console.log(" Token has insufficient scopes, clearing old token and forcing re-authentication..."),this.clearStoredData(),this.reauthenticate(),!1;throw n}})}handleAuthCallback(){return E(this,null,function*(){console.log(" Handling Spotify auth callback...");const t=new URLSearchParams(window.location.search),r=t.get("code"),n=t.get("state"),i=t.get("error");if(console.log(" Callback params:",{code:!!r,state:!!n,error:i}),i)throw console.error(" Authentication error:",i),new Error(`Authentication failed: ${i}`);if(!r||!n)return console.log(" No code or state in callback, not a Spotify auth"),!1;const a=localStorage.getItem("spotify_auth_state");if(console.log(" State validation:",{received:n,stored:a,match:n===a}),n!==a)if(console.error(" State mismatch detected"),console.log(" Attempting recovery..."),a){console.error(" State mismatch with stored state present"),console.log(" This might be due to a race condition - attempting token exchange anyway");try{return yield this.exchangeCodeForToken(r),console.log(" Token exchange successful despite state mismatch"),window.history.replaceState({},document.title,window.location.pathname),localStorage.removeItem("spotify_auth_state"),localStorage.removeItem("spotify_code_verifier"),!0}catch(o){throw console.error(" Token exchange failed:",o),new Error("Authentication state mismatch. Please try connecting to Spotify again.")}}else{console.log(" No stored state found - user may have navigated away during auth"),console.log(" Attempting to proceed with token exchange anyway...");try{return yield this.exchangeCodeForToken(r),console.log(" Token exchange successful despite state mismatch"),window.history.replaceState({},document.title,window.location.pathname),!0}catch(o){throw console.error(" Token exchange failed:",o),new Error("Authentication state mismatch. Please try connecting to Spotify again.")}}console.log(" State validated, exchanging code for token..."),yield this.exchangeCodeForToken(r),window.history.replaceState({},document.title,window.location.pathname);try{wn.click("spotify","current_user",{action:"connect_success"})}catch(o){}return console.log(" Authentication completed successfully!"),!0})}syncUserMusicPreferences(){return E(this,null,function*(){var t;try{const[r,n,i]=yield Promise.all([this.getTopArtists("short_term",50,0).catch(()=>({items:[]})),this.getTopArtists("medium_term",50,0).catch(()=>({items:[]})),this.getTopArtists("long_term",50,0).catch(()=>({items:[]}))]),[a,o,l]=yield Promise.all([this.getTopTracks("short_term",50,0).catch(()=>({items:[]})),this.getTopTracks("medium_term",50,0).catch(()=>({items:[]})),this.getTopTracks("long_term",50,0).catch(()=>({items:[]}))]),c=yield this.getRecentlyPlayed(50).catch(()=>({items:[]})),d=yield this.getUserProfile().catch(()=>null),u=[...r.items,...n.items,...i.items],h=[...a.items,...o.items,...l.items];yield this.saveToStreamingProfiles({topArtists:u,topTracks:h,recentlyPlayed:c.items,userProfile:d});const f=(x,g)=>{As.queueInteraction({eventType:"music_pref",entityType:"artist",entityId:x.id,metadata:{name:x.name,genres:x.genres,popularity:x.popularity,timeRange:g}})};r.items.forEach(x=>f(x,"short_term")),n.items.forEach(x=>f(x,"medium_term")),i.items.forEach(x=>f(x,"long_term"));const p=(x,g)=>{var v,_,w;As.queueInteraction({eventType:"music_pref",entityType:"track",entityId:x.id,metadata:{name:x.name,album:(v=x.album)==null?void 0:v.name,artistNames:(_=x.artists)==null?void 0:_.map(b=>b.name),artistIds:(w=x.artists)==null?void 0:w.map(b=>b.id),popularity:x.popularity,timeRange:g}})};a.items.forEach(x=>p(x,"short_term")),o.items.forEach(x=>p(x,"medium_term")),l.items.forEach(x=>p(x,"long_term")),c.items.forEach(x=>{var v,_,w;const g=x.track;g&&As.queueInteraction({eventType:"listen",entityType:"track",entityId:g.id,metadata:{name:g.name,album:(v=g.album)==null?void 0:v.name,artistNames:(_=g.artists)==null?void 0:_.map(b=>b.name),artistIds:(w=g.artists)==null?void 0:w.map(b=>b.id),played_at:x.played_at}})});try{yield As.flush()}catch(x){(x==null?void 0:x.code)==="23505"&&((t=x==null?void 0:x.message)!=null&&t.includes("user_genre_interactions"))?console.warn("Some genre interactions were duplicates (this is expected during sync)"):console.error("Error flushing interactions:",x)}try{const{data:{user:x}}=yield P.auth.getUser();if(x){console.log(" Fetching comprehensive streaming data...");const[g,v,_]=yield Promise.all([this.getAllTopArtists("short_term").catch(()=>[]),this.getAllTopArtists("medium_term").catch(()=>[]),this.getAllTopArtists("long_term").catch(()=>[])]),[w,b,N]=yield Promise.all([this.getAllTopTracks("short_term").catch(()=>[]),this.getAllTopTracks("medium_term").catch(()=>[]),this.getAllTopTracks("long_term").catch(()=>[])]),S=yield Promise.all([this.getRecentlyPlayed(50,void 0,void 0).catch(()=>({items:[]})),this.getRecentlyPlayed(50,void 0,void 0).catch(()=>({items:[]})),this.getRecentlyPlayed(50,void 0,void 0).catch(()=>({items:[]})),this.getRecentlyPlayed(50,void 0,void 0).catch(()=>({items:[]}))]).then(k=>k.flatMap(T=>T.items||[]).filter((T,$,R)=>$===R.findIndex(F=>{var D,B;return((D=F.track)==null?void 0:D.id)===((B=T.track)==null?void 0:B.id)})).slice(0,200));console.log(" Stats table removed - stats not persisted. Fetched:",{short_term:{artists:g.length,tracks:w.length},medium_term:{artists:v.length,tracks:b.length},long_term:{artists:_.length,tracks:N.length},recently_played:S.length});try{const{streamingSyncService:k}=yield on(()=>E(this,null,function*(){const{streamingSyncService:O}=yield Promise.resolve().then(()=>P2);return{streamingSyncService:O}}),void 0,import.meta.url);k.isSyncing()&&k.completeSync()}catch(k){console.warn("Could not notify sync service:",k)}}}catch(x){console.error("Error storing comprehensive Spotify stats:",x);try{const{streamingSyncService:g}=yield on(()=>E(this,null,function*(){const{streamingSyncService:v}=yield Promise.resolve().then(()=>P2);return{streamingSyncService:v}}),void 0,import.meta.url);g.errorSync(x instanceof Error?x.message:"Unknown error")}catch(g){console.warn("Could not notify sync service of error:",g)}}wn.click("spotify","current_user",{action:"sync_complete",artists_short:r.items.length,artists_medium:n.items.length,artists_long:i.items.length,tracks_short:a.items.length,tracks_medium:o.items.length,tracks_long:l.items.length,recently_played:c.items.length})}catch(r){console.error("Spotify sync error:",r)}})}saveToStreamingProfiles(t){return E(this,null,function*(){var r,n,i,a,o,l,c,d,u,h,f;try{const{data:{user:p}}=yield P.auth.getUser();if(!p){console.warn("No authenticated user for streaming profile save");return}const x={topArtists:t.topArtists,topTracks:t.topTracks,recentlyPlayed:t.recentlyPlayed,userProfile:t.userProfile,external_urls:(r=t.userProfile)==null?void 0:r.external_urls,followers:(n=t.userProfile)==null?void 0:n.followers,country:(i=t.userProfile)==null?void 0:i.country,display_name:(a=t.userProfile)==null?void 0:a.display_name,email:(o=t.userProfile)==null?void 0:o.email,images:(l=t.userProfile)==null?void 0:l.images,product:(c=t.userProfile)==null?void 0:c.product,type:(d=t.userProfile)==null?void 0:d.type,uri:(u=t.userProfile)==null?void 0:u.uri},{error:g}=yield P.from("streaming_profiles").upsert({user_id:p.id,service_type:"spotify",profile_data:x,sync_status:"completed",last_updated:new Date().toISOString()},{onConflict:"user_id,service_type",ignoreDuplicates:!1});if(g)if(g.code==="PGRST205")console.warn("Table streaming_profiles does not exist or RLS policy issue");else if(g.code==="23505"){const{error:v}=yield P.from("streaming_profiles").update({profile_data:x,sync_status:"completed",last_updated:new Date().toISOString()}).eq("user_id",p.id).eq("service_type","spotify");v?console.error("Error updating streaming profile:",v):console.log(" Updated streaming profile for user:",p.id)}else console.error("Error upserting streaming profile:",g);else console.log(" Upserted streaming profile for user:",p.id);if((f=(h=t.userProfile)==null?void 0:h.external_urls)!=null&&f.spotify){const{error:v}=yield P.from("users").update({music_streaming_profile:t.userProfile.external_urls.spotify,updated_at:new Date().toISOString()}).eq("user_id",p.id);v?console.warn("Warning: Failed to update user profile with Spotify URL:",v):console.log(" Updated user profile with Spotify URL")}}catch(p){console.error("Error saving to streaming profiles:",p)}})}checkStoredToken(){const t=localStorage.getItem("spotify_access_token"),r=localStorage.getItem("spotify_token_expiry");return t&&r&&Date.now()<parseInt(r)?(this.accessToken=t,console.log(" Found stored token, expires at:",new Date(parseInt(r)).toLocaleString()),!0):(console.log(" No valid stored token found"),!1)}ensureSession(){return E(this,null,function*(){const t=localStorage.getItem("spotify_access_token"),r=localStorage.getItem("spotify_token_expiry");if(t&&r){const n=parseInt(r);return Date.now()<n?(this.accessToken=t,!0):yield this.refreshToken()}return!1})}syncThisSessionLightly(){return E(this,null,function*(){try{yield Promise.all([this.getTopArtists("medium_term",10,0).catch(()=>null),this.getTopTracks("medium_term",10,0).catch(()=>null),this.getRecentlyPlayed(10).catch(()=>null)])}catch(t){console.warn("Light sync skipped:",t)}})}isAuthenticated(){return this.accessToken!==null}checkTokenScopes(){return E(this,null,function*(){try{console.log(" Checking Spotify token scopes..."),console.log(" Requested scopes:",this.config.scopes),console.log(" Access token present:",!!this.accessToken);try{const t=yield this.spotifyApiCall("/me");console.log(" User profile loaded successfully, basic scopes are working"),console.log(" User profile:",t.display_name)}catch(t){throw console.error(" User profile failed:",t),t}try{yield this.spotifyApiCall("/me/top/tracks?limit=1"),console.log(" user-top-read scope is working")}catch(t){console.warn(" user-top-read scope may be missing:",t)}try{yield this.spotifyApiCall("/me/player/recently-played?limit=1"),console.log(" user-read-recently-played scope is working")}catch(t){console.warn(" user-read-recently-played scope may be missing:",t)}return["user-read-private","user-read-email"]}catch(t){throw console.error(" Token scope check failed:",t),new Error("Unable to verify token scopes. Please reconnect to Spotify.")}})}logout(){console.log(" Logging out from Spotify..."),this.accessToken=null,localStorage.removeItem("spotify_access_token"),localStorage.removeItem("spotify_token_expiry"),localStorage.removeItem("spotify_refresh_token"),localStorage.removeItem("spotify_auth_state"),localStorage.removeItem("spotify_code_verifier"),console.log(" Spotify logout completed")}clearStoredData(){console.log(" Clearing all stored Spotify data..."),this.logout(),console.log(" All Spotify data cleared")}forceClearAndReauth(){console.log(" Force clearing all data and re-authenticating..."),this.clearStoredData(),typeof window!="undefined"&&alert("Clearing all Spotify data. Please reconnect with the new authentication method."),this.authenticate()}recoverFromStateMismatch(){console.log(" Recovering from state mismatch..."),this.clearStoredData(),typeof window!="undefined"&&confirm(`Spotify authentication session expired. This can happen if you navigated away during the connection process.

Would you like to try connecting again now?`)&&this.authenticate()}nuclearReset(){console.log(" NUCLEAR RESET: Clearing everything and forcing fresh start..."),["spotify_access_token","spotify_token_expiry","spotify_refresh_token","spotify_auth_state","spotify_code_verifier"].forEach(r=>{localStorage.removeItem(r),console.log(` Removed ${r}`)}),this.accessToken=null,typeof window!="undefined"&&(alert("Nuclear reset complete. All Spotify data cleared. Please refresh the page and reconnect."),window.location.reload())}exchangeCodeForToken(t){return E(this,null,function*(){const r=localStorage.getItem("spotify_code_verifier")||"";if(!this.config.clientId||!this.config.redirectUri)throw new Error("Spotify not configured for token exchange");const n=yield fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",code:t,redirect_uri:this.config.redirectUri,client_id:this.config.clientId,code_verifier:r})}),i=yield n.json();if(!n.ok)throw console.error(" Token exchange failed:",n.status,n.statusText),console.error("Response data:",i),new Error("Failed to exchange code for token");if(console.log(" Token exchange successful!"),console.log(" Granted scopes:",i.scope),console.log(" Token expires in:",i.expires_in,"seconds"),i.access_token){this.accessToken=i.access_token;const a=Date.now()+i.expires_in*1e3;localStorage.setItem("spotify_access_token",i.access_token),localStorage.setItem("spotify_token_expiry",a.toString()),i.refresh_token&&(localStorage.setItem("spotify_refresh_token",i.refresh_token),console.log(" Refresh token saved"))}else throw new Error("No access token received")})}refreshToken(){return E(this,null,function*(){const t=localStorage.getItem("spotify_refresh_token");if(!t)return this.logout(),!1;try{const n=yield(yield fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:t,client_id:this.config.clientId})})).json();if(n.access_token){this.accessToken=n.access_token;const i=Date.now()+n.expires_in*1e3;return localStorage.setItem("spotify_access_token",n.access_token),localStorage.setItem("spotify_token_expiry",i.toString()),!0}return!1}catch(r){return console.error("Token refresh error:",r),!1}})}spotifyApiCall(n){return E(this,arguments,function*(t,r={}){if(!this.accessToken)throw new Error("No access token available");const i=`https://api.spotify.com/v1${t}`,a=yield fetch(i,M({headers:M({Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"},r.headers)},r));if(a.status===401){if(yield this.refreshToken())return this.spotifyApiCall(t,r);throw this.logout(),new Error("Authentication failed")}if(a.status===429){const o=a.headers.get("Retry-After"),l=o?parseInt(o)*1e3:1e3;return yield new Promise(c=>setTimeout(c,l)),this.spotifyApiCall(t,r)}if(a.status===403)throw console.log(" 403 Forbidden detected, clearing all stored data..."),this.clearStoredData(),typeof window!="undefined"&&window.dispatchEvent(new CustomEvent("spotify-token-cleared")),new Error("Access forbidden. Please reconnect with proper permissions.");if(a.status===404)throw new Error("No data found. This might be because you haven't listened to enough music yet.");if(!a.ok){const o=yield a.text().catch(()=>"Unknown error");throw new Error(`Spotify API error: ${a.status} ${a.statusText} - ${o}`)}return a.json()})}getUserProfile(){return E(this,null,function*(){try{return yield this.spotifyApiCall("/me")}catch(t){throw console.error("Error fetching user profile:",t),t instanceof Error&&t.message.includes("403")?new Error("Insufficient permissions. Please reconnect with proper Spotify permissions."):t}})}getTopTracks(t="medium_term",r=20,n=0){return E(this,null,function*(){var o,l;if(r<1||r>50)throw new Error("Limit must be between 1 and 50");if(n<0)throw new Error("Offset must be 0 or greater");const i=new URLSearchParams({time_range:t,limit:r.toString(),offset:n.toString()}),a=yield this.spotifyApiCall(`/me/top/tracks?${i.toString()}`);try{wn.view("spotify","current_user",void 0,{resource:"top_tracks",count:(l=(o=a.items)==null?void 0:o.length)!=null?l:0,timeRange:t})}catch(c){}return a})}getTopArtists(t="medium_term",r=20,n=0){return E(this,null,function*(){var o,l;if(r<1||r>50)throw new Error("Limit must be between 1 and 50");if(n<0)throw new Error("Offset must be 0 or greater");const i=new URLSearchParams({time_range:t,limit:r.toString(),offset:n.toString()}),a=yield this.spotifyApiCall(`/me/top/artists?${i.toString()}`);try{wn.view("spotify","current_user",void 0,{resource:"top_artists",count:(l=(o=a.items)==null?void 0:o.length)!=null?l:0,timeRange:t})}catch(c){}return a})}getRecentlyPlayed(t=20,r,n){return E(this,null,function*(){var o,l;if(t<1||t>50)throw new Error("Limit must be between 1 and 50");const i=new URLSearchParams({limit:t.toString()});r!==void 0&&i.append("after",r.toString()),n!==void 0&&i.append("before",n.toString());const a=yield this.spotifyApiCall(`/me/player/recently-played?${i.toString()}`);try{wn.view("spotify","current_user",void 0,{resource:"recently_played",count:(l=(o=a.items)==null?void 0:o.length)!=null?l:0})}catch(c){}return a})}getCurrentPlayback(){return E(this,null,function*(){try{return this.spotifyApiCall("/me/player")}catch(t){return console.log("No active player found"),null}})}getAllTopTracks(t="medium_term"){return E(this,null,function*(){const r=[];let n=0;const i=50;let a=!0;for(;a;)try{const o=yield this.getTopTracks(t,i,n);r.push(...o.items),a=o.next!==null,n+=i}catch(o){console.error("Error fetching top tracks:",o);break}return r})}getAllTopArtists(t="medium_term"){return E(this,null,function*(){const r=[];let n=0;const i=50;let a=!0;for(;a;)try{const o=yield this.getTopArtists(t,i,n);r.push(...o.items),a=o.next!==null,n+=i}catch(o){console.error("Error fetching top artists:",o);break}return r})}calculateListeningStats(t,r){const n=t.length;if(n===0)return{totalTracks:0,uniqueArtists:0,uniqueAlbums:0,totalHours:0,avgPopularity:0,topGenres:[]};const i=new Set(t.flatMap(h=>h.artists.map(f=>f.id))).size,a=new Set(t.map(h=>h.album.id)).size,o=Math.round(t.reduce((h,f)=>h+f.popularity,0)/n),l=t.reduce((h,f)=>h+f.duration_ms,0),c=Math.round(l/(1e3*60*60)*10)/10,d={};r.forEach(h=>{h.genres.forEach(f=>{d[f]=(d[f]||0)+1})});const u=Object.entries(d).sort(([,h],[,f])=>f-h).slice(0,5).map(([h])=>h);return{totalTracks:n,uniqueArtists:i,uniqueAlbums:a,totalHours:c,avgPopularity:o,topGenres:u}}formatDate(t){const n=new Date().getTime()-t.getTime(),i=Math.floor(n/(1e3*60)),a=Math.floor(n/(1e3*60*60)),o=Math.floor(n/(1e3*60*60*24));return i<60?`${i} minutes ago`:a<24?`${a} hours ago`:o<7?`${o} days ago`:t.toLocaleDateString()}generateRandomString(t){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let i=0;i<t;i++)n+=r.charAt(Math.floor(Math.random()*r.length));return n}generateCodeChallenge(t){return E(this,null,function*(){const n=new TextEncoder().encode(t),i=yield crypto.subtle.digest("SHA-256",n);return btoa(String.fromCharCode(...new Uint8Array(i))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}selfTest(){return E(this,null,function*(){var t,r,n,i;try{const a=yield this.getUserProfile(),o=yield this.getTopArtists("short_term",1,0),l=yield this.getRecentlyPlayed(1);return{ok:!0,profile:a.display_name,topArtists:(r=(t=o.items)==null?void 0:t.length)!=null?r:0,recentlyPlayed:(i=(n=l.items)==null?void 0:n.length)!=null?i:0}}catch(a){return{ok:!1,error:(a==null?void 0:a.message)||String(a)}}})}};_r(au,"instance");let q3=au;const du=q3.getInstance();class Mie{constructor(){_r(this,"syncState",{status:"idle",serviceType:null,startedAt:null,completedAt:null,error:null});_r(this,"listeners",[]);_r(this,"checkInterval",null)}startSync(t){this.syncState={status:"syncing",serviceType:t,startedAt:Date.now(),completedAt:null,error:null},localStorage.setItem("streaming_sync_state",JSON.stringify(this.syncState)),this.notifyListeners(),this.startPolling()}completeSync(){this.syncState=W(M({},this.syncState),{status:"completed",completedAt:Date.now()}),localStorage.setItem("streaming_sync_state",JSON.stringify(this.syncState)),this.notifyListeners(),this.stopPolling()}errorSync(t){this.syncState=W(M({},this.syncState),{status:"error",completedAt:Date.now(),error:t}),localStorage.setItem("streaming_sync_state",JSON.stringify(this.syncState)),this.notifyListeners(),this.stopPolling()}getState(){return M({},this.syncState)}isSyncing(){return this.syncState.status==="syncing"}clearSync(){this.syncState={status:"idle",serviceType:null,startedAt:null,completedAt:null,error:null},localStorage.removeItem("streaming_sync_state"),this.notifyListeners(),this.stopPolling()}restoreState(){localStorage.removeItem("streaming_sync_state"),this.clearSync()}startPolling(){this.stopPolling(),this.syncState.status==="syncing"&&this.completeSync()}stopPolling(){this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)}subscribe(t){return this.listeners.push(t),t(this.getState()),()=>{const r=this.listeners.indexOf(t);r>-1&&this.listeners.splice(r,1)}}notifyListeners(){this.listeners.forEach(t=>t(this.getState()))}}const ll=new Mie,P2=Object.freeze(Object.defineProperty({__proto__:null,streamingSyncService:ll},Symbol.toStringTag,{value:"Module"})),Die=()=>{const{toast:e}=jr(),[t,r]=y.useState("connecting"),[n,i]=y.useState("");return y.useEffect(()=>{E(void 0,null,function*(){try{r("connecting"),(yield du.handleAuthCallback())?(ll.startSync("spotify"),du.syncUserMusicPreferences().catch(l=>{console.error("Background sync error:",l),ll.errorSync(l.message||"Sync failed")}),r("complete"),e({title:"Connected to Spotify",description:"Your stats are syncing in the background. You'll be notified when ready!"}),setTimeout(()=>{window.location.href="/",localStorage.setItem("intendedView","feed")},1500)):(r("error"),i("Authentication was not successful. Please try again."),e({title:"Connection Failed",description:"Failed to connect to Spotify. Please try again.",variant:"destructive"}),setTimeout(()=>{window.location.href="/"},2e3))}catch(o){console.error("Spotify callback error:",o),r("error");let l="Failed to connect to Spotify. Please try again.";o instanceof Error&&(o.message.includes("state mismatch")?l="Authentication session expired. Please try connecting again.":o.message.includes("Authentication failed")?l="Spotify authentication was cancelled or failed.":l=o.message),i(l),e({title:"Connection Failed",description:l,variant:"destructive"}),du.clearStoredData(),setTimeout(()=>{window.location.href="/"},2e3)}})},[e]),s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-white to-beige-50",children:s.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[t==="connecting"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Connecting to Spotify..."}),s.jsx("p",{className:"text-muted-foreground",children:"Please wait while we authenticate your account."})]}),t==="complete"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Successfully Connected!"}),s.jsx("p",{className:"text-muted-foreground mb-2",children:"Your stats are syncing in the background."}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"You'll be notified when they're ready. Redirecting to app..."})]}),t==="error"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("h2",{className:"text-xl font-semibold mb-2 text-red-600",children:"Connection Failed"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:n}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Redirecting to home..."})]})]})})},Iie={house:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M5.4885%2022.0003C4.11417%2022.0003%203%2020.857%203%2019.4453V9.17632C3%208.40049%203.34417%207.66549%203.93333%207.18132L10.7782%201.56032C11.2155%201.19817%2011.7655%201%2012.3333%201C12.9012%201%2013.4512%201.19817%2013.8885%201.56032L20.7322%207.18132C21.3225%207.66549%2021.6667%208.40049%2021.6667%209.17632V19.4453C21.6667%2020.857%2020.5525%2022.0003%2019.1782%2022.0003H5.4885Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M9%2021.75V15.3333C9%2014.7145%209.24583%2014.121%209.68342%2013.6834C10.121%2013.2458%2010.7145%2013%2011.3333%2013H12.5C13.1188%2013%2013.7123%2013.2458%2014.1499%2013.6834C14.5875%2014.121%2014.8333%2014.7145%2014.8333%2015.3333V21.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,houseSelected:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M5.4885%2022.0003C4.11417%2022.0003%203%2020.857%203%2019.4453V9.17632C3%208.40049%203.34417%207.66549%203.93333%207.18132L10.7782%201.56032C11.2155%201.19817%2011.7655%201%2012.3333%201C12.9012%201%2013.4512%201.19817%2013.8885%201.56032L20.7322%207.18132C21.3225%207.66549%2021.6667%208.40049%2021.6667%209.17632V19.4453C21.6667%2020.857%2020.5525%2022.0003%2019.1782%2022.0003H5.4885Z'%20fill='%23CC2486'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M9%2021.75V15.3333C9%2014.7145%209.24583%2014.121%209.68342%2013.6834C10.121%2013.2458%2010.7145%2013%2011.3333%2013H12.5C13.1188%2013%2013.7123%2013.2458%2014.1499%2013.6834C14.5875%2014.121%2014.8333%2014.7145%2014.8333%2015.3333V21.75'%20stroke='%23FDF2F7'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,discover:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2805_8556)'%3e%3cpath%20d='M23%2012C23%2013.4445%2022.7155%2014.8749%2022.1627%2016.2095C21.6099%2017.5441%2020.7996%2018.7567%2019.7782%2019.7782C18.7567%2020.7996%2017.5441%2021.6099%2016.2095%2022.1627C14.8749%2022.7155%2013.4445%2023%2012%2023C10.5555%2023%209.12506%2022.7155%207.79048%2022.1627C6.4559%2021.6099%205.24327%2020.7996%204.22183%2019.7782C3.20038%2018.7567%202.39013%2017.5441%201.83733%2016.2095C1.28452%2014.8749%201%2013.4445%201%2012C1%209.08262%202.15893%206.28473%204.22183%204.22183C6.28473%202.15893%209.08262%201%2012%201C14.9174%201%2017.7153%202.15893%2019.7782%204.22183C21.8411%206.28473%2023%209.08262%2023%2012Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M7%2017L9.5%209.5L17%207L14.5%2014.5L7%2017Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_2805_8556'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,discoverSelected:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_3690_6527)'%3e%3cpath%20d='M23%2012C23%2013.4445%2022.7155%2014.8749%2022.1627%2016.2095C21.6099%2017.5441%2020.7996%2018.7567%2019.7782%2019.7782C18.7567%2020.7996%2017.5441%2021.6099%2016.2095%2022.1627C14.8749%2022.7155%2013.4445%2023%2012%2023C10.5555%2023%209.12506%2022.7155%207.79048%2022.1627C6.4559%2021.6099%205.24327%2020.7996%204.22183%2019.7782C3.20038%2018.7567%202.39013%2017.5441%201.83733%2016.2095C1.28452%2014.8749%201%2013.4445%201%2012C1%209.08262%202.15893%206.28473%204.22183%204.22183C6.28473%202.15893%209.08262%201%2012%201C14.9174%201%2017.7153%202.15893%2019.7782%204.22183C21.8411%206.28473%2023%209.08262%2023%2012Z'%20fill='%23CC2486'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M7%2017L9.5%209.5L17%207L14.5%2014.5L7%2017Z'%20fill='%23FDF2F7'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_3690_6527'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,circleComment:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='CircleComment'%20d='M11.75%2022.75C13.9256%2022.75%2016.0523%2022.1049%2017.8613%2020.8962C19.6702%2019.6875%2021.0801%2017.9695%2021.9127%2015.9595C22.7452%2013.9495%2022.9631%2011.7378%2022.5386%209.60401C22.1142%207.47022%2021.0665%205.51021%2019.5282%203.97183C17.9898%202.43345%2016.0298%201.3858%2013.896%200.961367C11.7622%200.53693%209.55047%200.754766%207.54048%201.58733C5.53049%202.41989%203.81253%203.82979%202.60383%205.63873C1.39514%207.44767%200.75%209.57441%200.75%2011.75C0.75%2013.51%201.16311%2015.1722%201.89889%2016.6474C2.45256%2017.7609%201.68256%2019.263%201.38922%2020.3593C1.32424%2020.6018%201.32422%2020.8571%201.38919%2021.0996C1.45415%2021.3421%201.58181%2021.5632%201.75931%2021.7407C1.93682%2021.9182%202.15792%2022.0458%202.4004%2022.1108C2.64288%2022.1758%202.89819%2022.1758%203.14067%2022.1108C4.237%2021.8174%205.73911%2021.0474%206.85255%2021.6023C8.37448%2022.358%2010.0508%2022.7508%2011.75%2022.75Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,circleCommentSelected:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_3690_6539)'%3e%3cpath%20d='M12%2023C14.1756%2023%2016.3023%2022.3549%2018.1113%2021.1462C19.9202%2019.9375%2021.3301%2018.2195%2022.1627%2016.2095C22.9952%2014.1995%2023.2131%2011.9878%2022.7886%209.85401C22.3642%207.72022%2021.3165%205.76021%2019.7782%204.22183C18.2398%202.68345%2016.2798%201.6358%2014.146%201.21137C12.0122%200.78693%209.80047%201.00477%207.79048%201.83733C5.78049%202.66989%204.06253%204.07979%202.85383%205.88873C1.64514%207.69767%201%209.82441%201%2012C1%2013.76%201.41311%2015.4222%202.14889%2016.8974C2.70256%2018.0109%201.93256%2019.513%201.63922%2020.6093C1.57424%2020.8518%201.57422%2021.1071%201.63919%2021.3496C1.70415%2021.5921%201.83181%2021.8132%202.00931%2021.9907C2.18682%2022.1682%202.40792%2022.2958%202.6504%2022.3608C2.89288%2022.4258%203.14819%2022.4258%203.39067%2022.3608C4.487%2022.0674%205.98911%2021.2974%207.10255%2021.8523C8.62448%2022.608%2010.3008%2023.0008%2012%2023Z'%20fill='%23CC2486'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_3690_6539'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,user:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2021.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='User'%20d='M20.75%2022.75C20.1167%209.91712%201.38335%209.91712%200.750017%2022.75M14.75%204.875C14.75%205.96902%2014.3286%207.01823%2013.5784%207.79182C12.8283%208.5654%2011.8109%209%2010.75%209C9.68915%209%208.67173%208.5654%207.92159%207.79182C7.17144%207.01823%206.75002%205.96902%206.75002%204.875C6.75002%203.78098%207.17144%202.73177%207.92159%201.95818C8.67173%201.1846%209.68915%200.75%2010.75%200.75C11.8109%200.75%2012.8283%201.1846%2013.5784%201.95818C14.3286%202.73177%2014.75%203.78098%2014.75%204.875Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,userSelected:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M16%205.125C16%206.21902%2015.5786%207.26823%2014.8284%208.04182C14.0783%208.8154%2013.0609%209.25%2012%209.25C10.9391%209.25%209.92172%208.8154%209.17157%208.04182C8.42143%207.26823%208%206.21902%208%205.125C8%204.03098%208.42143%202.98177%209.17157%202.20818C9.92172%201.4346%2010.9391%201%2012%201C13.0609%201%2014.0783%201.4346%2014.8284%202.20818C15.5786%202.98177%2016%204.03098%2016%205.125ZM22%2023C21.3667%2010.1671%202.63333%2010.1671%202%2023Z'%20fill='%23CC2486'/%3e%3cpath%20d='M22%2023C21.3667%2010.1671%202.63333%2010.1671%202%2023M16%205.125C16%206.21902%2015.5786%207.26823%2014.8284%208.04182C14.0783%208.8154%2013.0609%209.25%2012%209.25C10.9391%209.25%209.92172%208.8154%209.17157%208.04182C8.42143%207.26823%208%206.21902%208%205.125C8%204.03098%208.42143%202.98177%209.17157%202.20818C9.92172%201.4346%2010.9391%201%2012%201C13.0609%201%2014.0783%201.4346%2014.8284%202.20818C15.5786%202.98177%2016%204.03098%2016%205.125Z'%20stroke='%23CC2486'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,plus:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Plus'%20d='M22.75%2011.75H11.75M11.75%2011.75H0.75M11.75%2011.75V0.75M11.75%2011.75V22.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,plusBox:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='PlusBox'%20d='M16.0278%2011.75H11.75M11.75%2011.75H7.47222M11.75%2011.75V7.47222M11.75%2011.75V16.0278M0.75%208.57222C0.75%205.83444%200.75%204.46556%201.28289%203.41933C1.7516%202.49947%202.49947%201.7516%203.41933%201.28289C4.46556%200.75%205.83444%200.75%208.57222%200.75H14.9278C17.6656%200.75%2019.0344%200.75%2020.0807%201.28289C21.0005%201.7516%2021.7484%202.49947%2022.2171%203.41933C22.75%204.46556%2022.75%205.83444%2022.75%208.57222V14.9278C22.75%2017.6656%2022.75%2019.0344%2022.2171%2020.0807C21.7484%2021.0005%2021.0005%2021.7484%2020.0807%2022.2171C19.0344%2022.75%2017.6656%2022.75%2014.9278%2022.75H8.57222C5.83444%2022.75%204.46556%2022.75%203.41933%2022.2171C2.49947%2021.7484%201.7516%2021.0005%201.28289%2020.0807C0.75%2019.0344%200.75%2017.6656%200.75%2014.9278V8.57222Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,search:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Search'%20d='M18.5078%2018.515L22.75%2022.75M21.4099%2011.0625C21.4099%2013.7975%2020.3215%2016.4206%2018.3843%2018.3545C16.4471%2020.2885%2013.8196%2021.375%2011.0799%2021.375C8.34026%2021.375%205.7128%2020.2885%203.77557%2018.3545C1.83833%2016.4206%200.75%2013.7975%200.75%2011.0625C0.75%208.32745%201.83833%205.70443%203.77557%203.77046C5.7128%201.83649%208.34026%200.75%2011.0799%200.75C13.8196%200.75%2016.4471%201.83649%2018.3843%203.77046C20.3215%205.70443%2021.4099%208.32745%2021.4099%2011.0625Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,send:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Send'%20d='M14.1958%209.30419L10.5284%2012.9712M21.8826%200.785773C21.9986%200.745747%2022.1236%200.73916%2022.2431%200.766765C22.3627%200.794369%2022.4721%200.855052%2022.5588%200.941877C22.6455%201.0287%2022.706%201.13817%2022.7334%201.25776C22.7609%201.37735%2022.7541%201.50225%2022.7139%201.61818L15.472%2022.3122C15.4287%2022.4359%2015.3492%2022.5438%2015.2438%2022.6217C15.1384%2022.6997%2015.012%2022.7442%2014.8811%2022.7495C14.7501%2022.7547%2014.6205%2022.7205%2014.5092%2022.6513C14.3979%2022.582%2014.31%2022.4809%2014.2569%2022.3611L10.3218%2013.509C10.2556%2013.3618%2010.1377%2013.244%209.99048%2013.1778L1.13738%209.24185C1.01794%209.18853%200.917235%209.10062%200.848274%208.98949C0.779313%208.87835%200.745265%208.74909%200.75053%208.6184C0.755795%208.48772%200.80013%208.36161%200.877808%208.25638C0.955486%208.15115%201.06294%208.07162%201.18628%208.02808L21.8826%200.785773Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,share:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2019.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Share'%20d='M12.75%205.02778L6.75%209.30556M12.75%2018.4722L6.75%2014.1944M6.75%2011.75C6.75%2012.5604%206.43393%2013.3376%205.87132%2013.9106C5.30871%2014.4836%204.54565%2014.8056%203.75%2014.8056C2.95435%2014.8056%202.19129%2014.4836%201.62868%2013.9106C1.06607%2013.3376%200.75%2012.5604%200.75%2011.75C0.75%2010.9396%201.06607%2010.1624%201.62868%209.5894C2.19129%209.01637%202.95435%208.69444%203.75%208.69444C4.54565%208.69444%205.30871%209.01637%205.87132%209.5894C6.43393%2010.1624%206.75%2010.9396%206.75%2011.75ZM18.75%2019.6944C18.75%2020.5048%2018.4339%2021.282%2017.8713%2021.855C17.3087%2022.4281%2016.5457%2022.75%2015.75%2022.75C14.9544%2022.75%2014.1913%2022.4281%2013.6287%2021.855C13.0661%2021.282%2012.75%2020.5048%2012.75%2019.6944C12.75%2018.8841%2013.0661%2018.1069%2013.6287%2017.5338C14.1913%2016.9608%2014.9544%2016.6389%2015.75%2016.6389C16.5457%2016.6389%2017.3087%2016.9608%2017.8713%2017.5338C18.4339%2018.1069%2018.75%2018.8841%2018.75%2019.6944ZM18.75%203.80556C18.75%204.61594%2018.4339%205.39313%2017.8713%205.96616C17.3087%206.53919%2016.5457%206.86111%2015.75%206.86111C14.9544%206.86111%2014.1913%206.53919%2013.6287%205.96616C13.0661%205.39313%2012.75%204.61594%2012.75%203.80556C12.75%202.99517%2013.0661%202.21798%2013.6287%201.64495C14.1913%201.07192%2014.9544%200.75%2015.75%200.75C16.5457%200.75%2017.3087%201.07192%2017.8713%201.64495C18.4339%202.21798%2018.75%202.99517%2018.75%203.80556Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,upload:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2022.5%2021.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Upload'%20d='M0.75%2015.5939V16.879C0.75%2017.9057%201.16484%2018.8903%201.90327%2019.6162C2.64169%2020.3422%203.64321%2020.75%204.6875%2020.75H17.8125C18.8568%2020.75%2019.8583%2020.3422%2020.5967%2019.6162C21.3352%2018.8903%2021.75%2017.9057%2021.75%2016.879V15.5887M11.25%2014.9435V0.75M11.25%200.75L15.8438%205.26613M11.25%200.75L6.65625%205.26613'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,download:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2022.5%2021.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Download'%20d='M0.75%2015.5939V16.879C0.75%2017.9057%201.16484%2018.8903%201.90327%2019.6162C2.64169%2020.3422%203.64321%2020.75%204.6875%2020.75H17.8125C18.8568%2020.75%2019.8583%2020.3422%2020.5967%2019.6162C21.3352%2018.8903%2021.75%2017.9057%2021.75%2016.879V15.5887M11.25%200.75V14.9435M11.25%2014.9435L15.8438%2010.4274M11.25%2014.9435L6.65625%2010.4274'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,edit:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2022.5%2022.4994'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='Edit'%3e%3cpath%20id='Edit_2'%20d='M8.37114%2010.2588C8.17386%2010.4561%208.0174%2010.6904%207.91071%2010.9482C7.80402%2011.206%207.74919%2011.4823%207.74937%2011.7613V14.7501H10.7568C11.3202%2014.7501%2011.8615%2014.5261%2012.2605%2014.1271L21.1263%205.25658C21.324%205.05936%2021.4809%204.82508%2021.5879%204.56715C21.6949%204.30922%2021.75%204.03272%2021.75%203.75347C21.75%203.47422%2021.6949%203.19771%2021.5879%202.93978C21.4809%202.68186%2021.324%202.44757%2021.1263%202.25035L20.2502%201.37427C20.053%201.17639%2019.8186%201.01939%2019.5606%200.912268C19.3026%200.805143%2019.0259%200.75%2018.7465%200.75C18.4671%200.75%2018.1905%200.805143%2017.9325%200.912268C17.6744%201.01939%2017.4401%201.17639%2017.2428%201.37427L8.37114%2010.2588Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20id='Edit_3'%20d='M21.7481%2011.2503C21.7481%2016.2%2021.7481%2018.6743%2020.2106%2020.2118C18.673%2021.7494%2016.1976%2021.7494%2011.249%2021.7494C6.3005%2021.7494%203.82505%2021.7494%202.28753%2020.2118C0.75%2018.6743%200.75%2016.1989%200.75%2011.2503C0.75%206.30178%200.75%203.82634%202.28753%202.28881C3.82505%200.751281%206.3005%200.751282%2011.249%200.751282'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3c/svg%3e",import.meta.url).href,trash:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2018.5%2021.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Trash'%20d='M16.05%207.41667L15.098%2016.7478C14.9541%2018.1622%2014.8827%2018.8689%2014.554%2019.4033C14.2657%2019.8738%2013.8418%2020.25%2013.3357%2020.4844C12.7611%2020.75%2012.038%2020.75%2010.5873%2020.75H7.91267C6.46313%2020.75%205.73893%2020.75%205.16433%2020.4833C4.65779%2020.2491%204.23343%2019.8728%203.94487%2019.4022C3.61847%2018.8689%203.54593%2018.1622%203.40087%2016.7478L2.45%207.41667M10.95%2014.6389V9.08333M7.55%2014.6389V9.08333M0.75%204.63889H5.98033M5.98033%204.63889L6.4178%201.67C6.54473%201.13%207.0026%200.75%207.52847%200.75H10.9715C11.4974%200.75%2011.9541%201.13%2012.0822%201.67L12.5197%204.63889M5.98033%204.63889H12.5197M12.5197%204.63889H17.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,refresh:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2805_8631)'%3e%3cpath%20d='M17.1538%208.25H21.7855C21.8683%208.25015%2021.9504%208.23397%2022.027%208.20238C22.1035%208.17079%2022.1731%208.12441%2022.2317%208.06589C22.2904%208.00737%2022.3369%207.93787%2022.3686%207.86136C22.4003%207.78485%2022.4167%207.70283%2022.4167%207.62V3M2%2017.1167C3.624%2020.8255%207.62683%2022.95%2011.9423%2022.95C17.4012%2022.95%2021.8882%2018.806%2022.4167%2013.5'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M21.4167%206.83333C19.7927%203.1245%2015.7898%201%2011.4743%201C6.0155%201%201.5285%205.144%201%2010.45'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M6.26283%2016H1.63117C1.54834%2015.9998%201.46629%2016.016%201.38972%2016.0476C1.31315%2016.0792%201.24356%2016.1256%201.18493%2016.1841C1.12631%2016.2426%201.0798%2016.3121%201.04807%2016.3886C1.01633%2016.4652%201%2016.5472%201%2016.63V21.25'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_2805_8631'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,repeat:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M22%2012V14.3333C22%2015.571%2021.5317%2016.758%2020.6983%2017.6332C19.8648%2018.5083%2018.7343%2019%2017.5556%2019H2'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M1%2011.8V9.53333C1%208.33102%201.46825%207.17795%202.30175%206.32778C3.13524%205.47762%204.2657%205%205.44444%205H21M5.44444%2022L1%2018.6L5.44444%2015.2'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M19%202L22.67%204.7525L19%207.505'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,hamburgerMenu:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2024%2019'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='HamburgerMenu'%3e%3cpath%20id='HamburgerMenu_2'%20d='M1%201.5H23'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20id='HamburgerMenu_3'%20d='M1%209.5H23'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20id='HamburgerMenu_4'%20d='M1%2017.5H23'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3c/svg%3e",import.meta.url).href,bell:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2021.5001%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Bell'%20d='M14.5236%2017.8611H6.97368M14.5236%2017.8611H19.041C21.3859%2017.8611%2020.9897%2015.5878%2019.8035%2014.434C15.531%2010.2846%2021.5997%200.75%2010.7486%200.75C-0.102459%200.75%205.96744%2010.2833%201.69501%2014.434C0.553781%2015.5438%200.0675392%2017.8611%202.4575%2017.8611H6.97368M14.5236%2017.8611C14.5236%2020.2139%2013.7136%2022.75%2010.7486%2022.75C7.78366%2022.75%206.97368%2020.2139%206.97368%2017.8611'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,settings:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2805_8565)'%3e%3cpath%20d='M16%2012C16%2010.9391%2015.5786%209.92172%2014.8284%209.17157C14.0783%208.42143%2013.0609%208%2012%208C10.9391%208%209.92172%208.42143%209.17157%209.17157C8.42143%209.92172%208%2010.9391%208%2012C8%2013.0609%208.42143%2014.0783%209.17157%2014.8284C9.92172%2015.5786%2010.9391%2016%2012%2016C13.0609%2016%2014.0783%2015.5786%2014.8284%2014.8284C15.5786%2014.0783%2016%2013.0609%2016%2012Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M9.69%202.1C9.7203%201.79852%209.8615%201.51905%2010.0862%201.31579C10.3109%201.11254%2010.6031%200.999996%2010.9061%201H13.0939C13.3969%200.999996%2013.6891%201.11254%2013.9138%201.31579C14.1385%201.51905%2014.2797%201.79852%2014.31%202.1L14.3503%202.507C15.3012%202.74242%2016.2114%203.11941%2017.0502%203.62533L17.3668%203.36622C17.6014%203.17443%2017.8988%203.07661%2018.2014%203.09174C18.5041%203.10688%2018.7903%203.23388%2019.0046%203.44811L20.5519%204.99544C20.7661%205.20972%2020.8931%205.49594%2020.9083%205.79856C20.9234%206.10119%2020.8256%206.39864%2020.6338%206.63322L20.3747%206.951C20.8746%207.77722%2021.2547%208.68533%2021.493%209.64967L21.8988%209.69C22.2005%209.72001%2022.4802%209.86109%2022.6838%2010.0858C22.8873%2010.3106%2023%2010.6029%2023%2010.9061V13.0939C23%2013.3969%2022.8875%2013.6891%2022.6842%2013.9138C22.481%2014.1385%2022.2015%2014.2797%2021.9%2014.31L21.493%2014.3503C21.2576%2015.3012%2020.8806%2016.2114%2020.3747%2017.0502L20.6338%2017.3668C20.8256%2017.6014%2020.9234%2017.8988%2020.9083%2018.2014C20.8931%2018.5041%2020.7661%2018.7903%2020.5519%2019.0046L19.0046%2020.5519C18.7903%2020.7661%2018.5041%2020.8931%2018.2014%2020.9083C17.8988%2020.9234%2017.6014%2020.8256%2017.3668%2020.6338L17.049%2020.3747C16.2105%2020.8805%2015.3008%2021.2575%2014.3503%2021.493L14.31%2021.8988C14.28%2022.2005%2014.1389%2022.4802%2013.9142%2022.6838C13.6894%2022.8873%2013.3971%2023%2013.0939%2023H10.9061C10.6031%2023%2010.3109%2022.8875%2010.0862%2022.6842C9.8615%2022.481%209.7203%2022.2015%209.69%2021.9L9.64967%2021.493C8.69876%2021.2576%207.78864%2020.8806%206.94978%2020.3747L6.63322%2020.6338C6.39864%2020.8256%206.10119%2020.9234%205.79856%2020.9083C5.49594%2020.8931%205.20972%2020.7661%204.99544%2020.5519L3.44811%2019.0033C3.23388%2018.7891%203.10688%2018.5028%203.09174%2018.2002C3.07661%2017.8976%203.17443%2017.6001%203.36622%2017.3656L3.62533%2017.0478C3.11952%2016.2093%202.74254%2015.2996%202.507%2014.3491L2.1%2014.31C1.79852%2014.2797%201.51905%2014.1385%201.31579%2013.9138C1.11254%2013.6891%200.999996%2013.3969%201%2013.0939V10.9061C0.999996%2010.6031%201.11254%2010.3109%201.31579%2010.0862C1.51905%209.8615%201.79852%209.7203%202.1%209.69L2.507%209.64967C2.74242%208.69876%203.11941%207.78864%203.62533%206.94978L3.36622%206.63322C3.17443%206.39864%203.07661%206.10119%203.09174%205.79856C3.10688%205.49594%203.23388%205.20972%203.44811%204.99544L4.99667%203.44811C5.21094%203.23388%205.49716%203.10688%205.79978%203.09174C6.10241%203.07661%206.39987%203.17443%206.63444%203.36622L6.95222%203.62533C7.7907%203.11952%208.70041%202.74254%209.65089%202.507L9.69%202.1Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_2805_8565'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,filter:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2020.5%2023.5001'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Filter'%20d='M7.56023%2019.5543V14.1671C7.56023%2013.4053%207.56023%2013.0231%207.49141%2012.6546C7.4292%2012.3292%207.32798%2012.0125%207.18995%2011.7114C7.03303%2011.3717%206.81278%2011.0596%206.37092%2010.4381L1.90136%204.14208C1.12225%203.04622%200.732692%202.4976%200.750587%202.03973C0.758718%201.84337%200.809753%201.65116%200.900112%201.47658C0.990472%201.302%201.11797%201.14928%201.27366%201.02912C1.63707%200.750001%202.31018%200.750001%203.65642%200.750001H16.8449C18.1911%200.750001%2018.8642%200.750001%2019.2262%201.02912C19.3826%201.14863%2019.5106%201.3012%2019.6011%201.47592C19.6915%201.65064%2019.7421%201.84318%2019.7493%202.03973C19.7686%202.4976%2019.3777%203.04622%2018.5999%204.14346L14.1304%2010.4381C13.6899%2011.0596%2013.4683%2011.3717%2013.3113%2011.7114C13.1727%2012.0129%2013.071%2012.3301%2013.0085%2012.656C12.9397%2013.0231%2012.9397%2013.404%2012.9397%2014.1684V22.241M12.9397%2022.241C12.9397%2019.1473%209.83837%2018.5478%207.56161%2019.5543C7.51618%2022.6273%2010.6739%2023.3932%2012.9397%2022.241Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,sort:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2016.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='UpDownArrows'%20d='M5.5625%2015.75V0.75M5.5625%200.75L10.375%205.52273M5.5625%200.75L0.75%205.52273M17.9375%200.75V15.75M17.9375%2015.75L22.75%2010.9773M17.9375%2015.75L13.125%2010.9773'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,sortFilter:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M23.4091%206.49987H8.54559C8.22741%206.49987%207.95469%206.22715%207.95469%205.90896C7.95469%205.59078%208.22741%205.31805%208.54559%205.31805H23.4091C23.7273%205.31805%2024%205.59078%2024%205.90896C24%206.22715%2023.7273%206.49987%2023.4091%206.49987Z'%20fill='%230E0E0E'/%3e%3cpath%20d='M3.90907%206.49987H1.5909C1.27272%206.49987%201%206.22715%201%205.90896C1%205.59078%201.27272%205.31805%201.5909%205.31805H3.90907C4.22724%205.31805%204.49997%205.59078%204.49997%205.90896C4.49997%206.22715%204.2727%206.49987%203.90907%206.49987Z'%20fill='%230E0E0E'/%3e%3cpath%20d='M23.4089%2012.0909H19.4998C19.1817%2012.0909%2018.9089%2011.8181%2018.9089%2011.5C18.9089%2011.1818%2019.1817%2010.9091%2019.4998%2010.9091H23.4089C23.7271%2010.9091%2023.9998%2011.1818%2023.9998%2011.5C23.9998%2011.8181%2023.7271%2012.0909%2023.4089%2012.0909Z'%20fill='%230E0E0E'/%3e%3cpath%20d='M14.8635%2012.0909H1.5909C1.27272%2012.0909%201%2011.8181%201%2011.5C1%2011.1818%201.27272%2010.9091%201.5909%2010.9091H14.8635C15.1817%2010.9091%2015.4544%2011.1818%2015.4544%2011.5C15.4544%2011.8181%2015.1817%2012.0909%2014.8635%2012.0909Z'%20fill='%230E0E0E'/%3e%3cpath%20d='M23.4091%2017.727H8.54559C8.22741%2017.727%207.95469%2017.4543%207.95469%2017.1361C7.95469%2016.8179%208.22741%2016.5452%208.54559%2016.5452H23.4091C23.7273%2016.5452%2024%2016.8179%2024%2017.1361C24%2017.4543%2023.7273%2017.727%2023.4091%2017.727Z'%20fill='%230E0E0E'/%3e%3cpath%20d='M3.90907%2017.7272H1.5909C1.27272%2017.7272%201%2017.4545%201%2017.1363C1%2016.7726%201.27272%2016.4999%201.5909%2016.4999H3.90907C4.22724%2016.4999%204.49997%2016.7726%204.49997%2017.0908C4.54542%2017.4545%204.2727%2017.7272%203.90907%2017.7272Z'%20fill='%230E0E0E'/%3e%3cpath%20d='M6.22712%208.81807C4.63623%208.81807%203.31806%207.49988%203.31806%205.90897C3.31806%204.31806%204.63623%202.99988%206.22712%202.99988C7.81802%202.99988%209.13619%204.31806%209.13619%205.90897C9.13619%207.49988%207.86347%208.81807%206.22712%208.81807ZM6.22712%204.1817C5.27259%204.1817%204.49987%204.95443%204.49987%205.90897C4.49987%206.86352%205.27259%207.63625%206.22712%207.63625C7.18166%207.63625%207.95438%206.86352%207.95438%205.90897C7.95438%204.95443%207.18166%204.1817%206.22712%204.1817Z'%20fill='%230E0E0E'/%3e%3cpath%20d='M17.1816%2014.4089C15.5907%2014.4089%2014.2726%2013.0907%2014.2726%2011.4998C14.2726%209.90891%2015.5907%208.59073%2017.1816%208.59073C18.7725%208.59073%2020.0907%209.90891%2020.0907%2011.4998C20.0907%2013.0907%2018.818%2014.4089%2017.1816%2014.4089ZM17.1816%209.77255C16.2271%209.77255%2015.4544%2010.5453%2015.4544%2011.4998C15.4544%2012.4544%2016.2271%2013.2271%2017.1816%2013.2271C18.1362%2013.2271%2018.9089%2012.4544%2018.9089%2011.4998C18.9089%2010.5453%2018.1362%209.77255%2017.1816%209.77255Z'%20fill='%230E0E0E'/%3e%3cpath%20d='M6.22712%2020.0453C4.63623%2020.0453%203.31806%2018.7271%203.31806%2017.1362C3.31806%2015.4999%204.63623%2014.2271%206.22712%2014.2271C7.81802%2014.2271%209.13619%2015.5453%209.13619%2017.1362C9.18164%2018.7271%207.86347%2020.0453%206.22712%2020.0453ZM6.22712%2015.409C5.27259%2015.409%204.49987%2016.1817%204.49987%2017.1362C4.49987%2018.0908%205.27259%2018.8635%206.22712%2018.8635C7.18166%2018.8635%207.95438%2018.0908%207.95438%2017.1362C7.95438%2016.1817%207.18166%2015.409%206.22712%2015.409Z'%20fill='%230E0E0E'/%3e%3c/svg%3e",import.meta.url).href,x:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2022.5%2022.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='X'%20d='M21.75%200.75L0.75%2021.75M0.75%200.75L21.75%2021.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,check:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2022.5001%2018.5001'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Check'%20d='M0.750001%2012.0144L3.5605%2014.9419C5.111%2016.5569%205.88625%2017.3627%206.75425%2017.6177C7.51725%2017.8404%208.32925%2017.7809%209.0555%2017.4477C9.88325%2017.0669%2010.5465%2016.154%2011.8765%2014.3265L21.75%200.750053'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,checkMark:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5001%2019.5001'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='CheckMark'%20d='M0.750002%2012.677L3.69433%2015.7767C5.31867%2017.4867%206.13083%2018.3399%207.04017%2018.6099C7.8395%2018.8457%208.69017%2018.7827%209.451%2018.4299C10.3182%2018.0267%2011.013%2017.0601%2012.4063%2015.1251L22.75%200.750056'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,circleCheck:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2805_8590)'%3e%3cpath%20d='M9%207.96686L13.1557%2012.6946C13.2466%2012.7962%2013.358%2012.8761%2013.4821%2012.9287C13.6062%2012.9813%2013.74%2013.0053%2013.8741%2012.999C14.0082%2012.9927%2014.1394%2012.9563%2014.2583%2012.8923C14.3773%2012.8283%2014.4811%2012.7383%2014.5627%2012.6286L23%201'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M23%2012C23%2014.1756%2022.3549%2016.3023%2021.1462%2018.1113C19.9375%2019.9202%2018.2195%2021.3301%2016.2095%2022.1627C14.1995%2022.9952%2011.9878%2023.2131%209.85401%2022.7886C7.72022%2022.3642%205.76021%2021.3165%204.22183%2019.7782C2.68345%2018.2398%201.6358%2016.2798%201.21137%2014.146C0.78693%2012.0122%201.00477%209.80047%201.83733%207.79048C2.66989%205.78049%204.07979%204.06253%205.88873%202.85383C7.69767%201.64514%209.82441%201%2012%201'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_2805_8590'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,smallCheck:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2016.5%2013.5001'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='SmallCheck'%20d='M0.75%208.70137L2.7575%2010.7678C3.865%2011.9078%204.41875%2012.4766%205.03875%2012.6566C5.58375%2012.8138%206.16375%2012.7718%206.6825%2012.5366C7.27375%2012.2678%207.7475%2011.6234%208.6975%2010.3334L15.75%200.750049'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,minus:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%201.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Minus'%20d='M0.75%200.75H22.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,questionMark:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2805_8537)'%3e%3cpath%20d='M12%2014.2491C12%2011.2451%2015%2011.9949%2015%208.99091C15%205.00303%209%205.00303%209%208.99091M12%2018V17.2501'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M23%2012C23%2013.4445%2022.7155%2014.8749%2022.1627%2016.2095C21.6099%2017.5441%2020.7996%2018.7567%2019.7782%2019.7782C18.7567%2020.7996%2017.5441%2021.6099%2016.2095%2022.1627C14.8749%2022.7155%2013.4445%2023%2012%2023C10.5555%2023%209.12506%2022.7155%207.79048%2022.1627C6.4559%2021.6099%205.24327%2020.7996%204.22183%2019.7782C3.20038%2018.7567%202.39013%2017.5441%201.83733%2016.2095C1.28452%2014.8749%201%2013.4445%201%2012C1%209.08262%202.15893%206.28473%204.22183%204.22183C6.28473%202.15893%209.08262%201%2012%201C14.9174%201%2017.7153%202.15893%2019.7782%204.22183C21.8411%206.28473%2023%209.08262%2023%2012Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_2805_8537'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,infoCircle:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2805_8601)'%3e%3cpath%20d='M12.5%2016V9.75H12M12%2016H13M12.5%206.625V6'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M23%2012C23%2013.4445%2022.7155%2014.8749%2022.1627%2016.2095C21.6099%2017.5441%2020.7996%2018.7567%2019.7782%2019.7782C18.7567%2020.7996%2017.5441%2021.6099%2016.2095%2022.1627C14.8749%2022.7155%2013.4445%2023%2012%2023C10.5555%2023%209.12506%2022.7155%207.79048%2022.1627C6.4559%2021.6099%205.24327%2020.7996%204.22183%2019.7782C3.20038%2018.7567%202.39013%2017.5441%201.83733%2016.2095C1.28452%2014.8749%201%2013.4445%201%2012C1%209.08262%202.15893%206.28473%204.22183%204.22183C6.28473%202.15893%209.08262%201%2012%201C14.9174%201%2017.7153%202.15893%2019.7782%204.22183C21.8411%206.28473%2023%209.08262%2023%2012Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_2805_8601'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,exclamationTriangle:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='ExclamationTriangle'%20d='M11.7497%207.47222V14.1944M11.7497%2018.163V17.5519M4.39172%2010.2369C7.60382%203.91189%209.20742%200.75%2011.7497%200.75C14.292%200.75%2015.8969%203.91189%2019.1077%2010.2369L19.5074%2011.024C22.1744%2016.2796%2023.5091%2018.9073%2022.3027%2020.8287C21.0976%2022.75%2018.1153%2022.75%2012.1494%2022.75H11.35C5.38542%2022.75%202.40188%2022.75%201.19673%2020.8287C-0.00842298%2018.9073%201.32506%2016.2796%203.99204%2011.024L4.39172%2010.2369Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,arrowDown:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2018.5%2022.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='ArrowDown'%20d='M9.25%200.75V21.75M9.25%2021.75L0.750003%2013.875M9.25%2021.75L17.75%2013.875'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,arrowUp:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2018.5%2022.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='ArrowUp'%20d='M9.25%2021.75V0.75M9.25%200.75L0.750003%208.625M9.25%200.75L17.75%208.625'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,left:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2012.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Left'%20d='M11.75%200.75L0.75%2011.75L11.75%2022.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,leftArrow:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2010.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='LeftArrow'%20d='M5.15%200.75L0.75%205.25M0.75%205.25L5.15%209.75M0.75%205.25H22.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,right:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2012.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Right'%20d='M0.75%2022.75L11.75%2011.75L0.75%200.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,up:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2012.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Up'%20d='M22.75%2011.75L11.75%200.75L0.75%2011.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,upArrow:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2022.5%2022.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='UpArrow'%20d='M12.75%200.75H21.75M21.75%200.75V9.75M21.75%200.75L0.75%2021.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,down:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2012.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Down'%20d='M0.75%200.75L11.75%2011.75L22.75%200.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,heart:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2022.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Heart'%20d='M6.55556%200.75C3.34967%200.75%200.75%203.54176%200.75%206.98453C0.75%2013.875%2011.75%2021.75%2011.75%2021.75C11.75%2021.75%2022.75%2013.875%2022.75%206.98453C22.75%202.71906%2020.1503%200.75%2016.9444%200.75C14.6711%200.75%2012.7033%202.15329%2011.75%204.19647C10.7967%202.15329%208.82889%200.75%206.55556%200.75Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,largeHeart:new URL("data:image/svg+xml,%3csvg%20width='60'%20height='60'%20viewBox='0%200%2060%2060'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M16.3056%203C7.85367%203%201%2010.1788%201%2019.0316C1%2036.75%2030%2057%2030%2057C30%2057%2059%2036.75%2059%2019.0316C59%208.06329%2052.1463%203%2043.6944%203C37.7011%203%2032.5133%206.60847%2030%2011.8624C27.4867%206.60847%2022.2989%203%2016.3056%203Z'%20stroke='%235D646F'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,thumbsUp:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2022.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='ThumbsUp'%20d='M13.7698%209.43388H20.6045C23.7495%209.43388%2019.6608%2022.75%2017.4077%2022.75H1.94083C1.62784%2022.7526%201.32661%2022.6321%201.10333%2022.4151C0.880041%2022.1981%200.752969%2021.9022%200.750034%2021.5925V10.122C0.750034%209.69788%200.988441%209.308%201.37014%209.10511C3.91727%207.75333%206.90539%206.646%208.384%204.05856L9.96515%201.28902C10.0594%201.12446%2010.1963%200.98776%2010.3618%200.893014C10.5273%200.798268%2010.7153%200.748906%2010.9064%200.750018C14.8346%200.750018%2013.6697%206.40889%2013.1361%208.65778C13.1146%208.75141%2013.1149%208.84864%2013.1368%208.94217C13.1588%209.03569%2013.2019%209.12308%2013.2629%209.19777C13.3238%209.27245%2013.4011%209.3325%2013.4889%209.37339C13.5767%209.41429%2013.6727%209.43497%2013.7698%209.43388Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,star:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5078%2023.4962'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Star'%20d='M12.7976%201.3615C12.6936%201.17603%2012.5421%201.02161%2012.3587%200.914133C12.1752%200.806654%2011.9664%200.75%2011.7538%200.75C11.5412%200.75%2011.3324%200.806654%2011.1489%200.914133C10.9655%201.02161%2010.814%201.17603%2010.71%201.3615C10.4656%201.80638%2010.2305%202.25696%2010.0048%202.71325C9.29368%204.1566%208.6891%205.65003%208.19587%207.18159C8.02598%207.70835%207.52242%208.07379%206.94553%208.08968C5.19678%208.13565%203.45373%208.30926%201.73027%208.60911C0.784261%208.77533%200.428592%209.85331%201.10082%2010.5108C1.25401%2010.6616%201.40882%2010.8103%201.56527%2010.9569C2.73502%2012.0616%203.97182%2013.0931%205.26863%2014.0454C5.71719%2014.3742%205.90175%2014.9376%205.73063%2015.4534C5.07881%2017.4126%204.61231%2019.4287%204.33729%2021.4752C4.21507%2022.3979%205.20263%2023.0493%206.06064%2022.6093C7.76203%2021.737%209.38898%2020.7265%2010.9251%2019.5881C11.1657%2019.4125%2011.4559%2019.3178%2011.7538%2019.3178C12.0517%2019.3178%2012.3419%2019.4125%2012.5825%2019.5881C14.1183%2020.727%2015.7453%2021.7375%2017.4469%2022.6093C18.3037%2023.0493%2019.2925%2022.3979%2019.1703%2021.4752C19.123%2021.1289%2019.0713%2020.7846%2019.0151%2020.4424C18.7327%2018.7497%2018.3188%2017.0817%2017.7769%2015.4534C17.6058%2014.9376%2017.7892%2014.3742%2018.239%2014.0454C19.7102%2012.9674%2021.103%2011.7863%2022.4068%2010.5108C23.079%209.85331%2022.7245%208.77533%2021.7773%208.60911C20.0541%208.30751%2018.3109%208.13389%2016.562%208.08968C16.2855%208.08528%2016.0171%207.99572%2015.7934%207.83322C15.5696%207.67071%2015.4014%207.44316%2015.3117%207.18159C14.6623%205.16579%2013.8204%203.21596%2012.7976%201.3615Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,miniStar:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%208.00525%207.99748'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='MiniStar'%20d='M4.33472%200.694568C4.30164%200.635555%204.25343%200.586422%204.19506%200.552224C4.13669%200.518026%204.07026%200.5%204.0026%200.5C3.93495%200.5%203.86852%200.518026%203.81015%200.552224C3.75177%200.586422%203.70357%200.635555%203.67049%200.694568C3.59271%200.836121%203.51791%200.979488%203.4461%201.12467C3.21984%201.58392%203.02747%202.0591%202.87054%202.54641C2.81648%202.71402%202.65626%202.8303%202.4727%202.83535C1.91628%202.84998%201.36167%202.90522%200.813301%203.00063C0.512299%203.05351%200.399131%203.39651%200.613022%203.60572C0.661763%203.65369%200.711023%203.701%200.760801%203.74767C1.13299%204.09916%201.52652%204.42735%201.93914%204.73036C2.08187%204.83497%202.14059%205.01425%202.08614%205.17835C1.87875%205.80175%201.73032%206.44323%201.64281%207.09437C1.60392%207.38797%201.91814%207.59524%202.19115%207.45525C2.7325%207.17768%203.25016%206.85616%203.73893%206.49394C3.81549%206.43806%203.90782%206.40795%204.0026%206.40795C4.09738%206.40795%204.18972%206.43806%204.26627%206.49394C4.75494%206.85631%205.27262%207.17783%205.81406%207.45525C6.08668%207.59524%206.40129%207.38797%206.3624%207.09437C6.34736%206.98418%206.3309%206.87465%206.31301%206.76576C6.22317%206.22719%206.09145%205.69644%205.91906%205.17835C5.86462%205.01425%205.92295%204.83497%206.06606%204.73036C6.53419%204.38737%206.97734%204.01154%207.39219%203.60572C7.60608%203.39651%207.4933%203.05351%207.19191%203.00063C6.64361%202.90466%206.08896%202.84942%205.5325%202.83535C5.44453%202.83395%205.35912%202.80546%205.28792%202.75375C5.21673%202.70204%205.16321%202.62964%205.13467%202.54641C4.92805%201.90502%204.66016%201.28462%204.33472%200.694568Z'%20stroke='%230E0E0E'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,mediumStar:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2034.5078%2034.4962'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='MediumStar'%20d='M18.8194%201.66725C18.6634%201.38905%2018.4362%201.15742%2018.161%200.996199C17.8858%200.834982%2017.5726%200.75%2017.2537%200.75C16.9348%200.75%2016.6216%200.834982%2016.3464%200.996199C16.0712%201.15742%2015.844%201.38905%2015.688%201.66725C15.3213%202.33457%2014.9687%203.01044%2014.6302%203.69487C13.5635%205.85991%2012.6567%208.10005%2011.9168%2010.3974C11.662%2011.1875%2010.9066%2011.7357%2010.0413%2011.7595C7.41819%2011.8285%204.8036%2012.0889%202.21842%2012.5387C0.799404%2012.788%200.2659%2014.405%201.27424%2015.3913C1.50402%2015.6174%201.73624%2015.8404%201.97091%2016.0604C3.72554%2017.7175%205.58074%2019.2646%207.52596%2020.6931C8.19879%2021.1863%208.47563%2022.0315%208.21896%2022.8051C7.24122%2025.744%206.54148%2028.7681%206.12895%2031.8377C5.94561%2033.2219%207.42696%2034.199%208.71397%2033.539C11.2661%2032.2305%2013.7065%2030.7148%2016.0107%2029.0071C16.3716%2028.7437%2016.8069%2028.6017%2017.2537%2028.6017C17.7005%2028.6017%2018.1358%2028.7437%2018.4967%2029.0071C20.8004%2030.7155%2023.2409%2032.2312%2025.7934%2033.539C27.0786%2034.199%2028.5618%2033.2219%2028.3785%2031.8377C28.3076%2031.3183%2028.2299%2030.8019%2028.1456%2030.2886C27.7221%2027.7496%2027.1011%2025.2475%2026.2884%2022.8051C26.0318%2022.0315%2026.3068%2021.1863%2026.9814%2020.6931C29.1883%2019.0762%2031.2775%2017.3044%2033.2332%2015.3913C34.2415%2014.405%2033.7098%2012.788%2032.289%2012.5387C29.7042%2012.0863%2027.0894%2011.8258%2024.4661%2011.7595C24.0513%2011.7529%2023.6487%2011.6186%2023.3131%2011.3748C22.9774%2011.1311%2022.7251%2010.7897%2022.5906%2010.3974C21.6165%207.37368%2020.3536%204.44893%2018.8194%201.66725Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,largeStar:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2059.5077%2059.4962'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='LargeStar'%20d='M32.5053%202.36214C32.2312%201.87317%2031.8318%201.46606%2031.3482%201.18271C30.8645%200.899361%2030.3141%200.75%2029.7535%200.75C29.193%200.75%2028.6425%200.899361%2028.1589%201.18271C27.6752%201.46606%2027.2758%201.87317%2027.0017%202.36214C26.3573%203.535%2025.7375%204.7229%2025.1425%205.92583C23.2678%209.73105%2021.6739%2013.6683%2020.3735%2017.706C19.9257%2019.0948%2018.5981%2020.0582%2017.0772%2020.1001C12.4669%2020.2213%207.87152%2020.6789%203.32786%2021.4695C0.83384%2021.9077%20-0.103834%2024.7496%201.6684%2026.4831C2.07226%2026.8805%202.48041%2027.2726%202.89286%2027.6592C5.97674%2030.5716%209.23741%2033.2909%2012.6563%2035.8016C13.8388%2036.6684%2014.3254%2038.1538%2013.8743%2039.5135C12.1558%2044.6788%2010.926%2049.9939%2010.2009%2055.389C9.87869%2057.8218%2012.4823%2059.5392%2014.7443%2058.3792C19.2298%2056.0793%2023.519%2053.4153%2027.5688%2050.414C28.2031%2049.951%2028.9682%2049.7016%2029.7535%2049.7016C30.5388%2049.7016%2031.3039%2049.951%2031.9382%2050.414C35.9872%2053.4166%2040.2765%2056.0806%2044.7627%2058.3792C47.0215%2059.5392%2049.6283%2057.8218%2049.3061%2055.389C49.1815%2054.4761%2049.0451%2053.5685%2048.8969%2052.6663C48.1525%2048.2038%2047.0611%2043.8062%2045.6327%2039.5135C45.1816%2038.1538%2045.665%2036.6684%2046.8507%2035.8016C50.7295%2032.9596%2054.4013%2029.8456%2057.8386%2026.4831C59.6108%2024.7496%2058.6764%2021.9077%2056.1792%2021.4695C51.6361%2020.6743%2047.0405%2020.2166%2042.4298%2020.1001C41.7009%2020.0885%2040.9932%2019.8524%2040.4033%2019.4239C39.8134%2018.9955%2039.37%2018.3956%2039.1335%2017.706C37.4215%2012.3916%2035.2019%207.25116%2032.5053%202.36214Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,image:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2805_8627)'%3e%3cpath%20d='M1%209C1%206.2%201%204.8%201.545%203.73C2.02436%202.78923%202.78923%202.02436%203.73%201.545C4.8%201%206.2%201%209%201H15.5C18.3%201%2019.7%201%2020.77%201.545C21.7108%202.02436%2022.4756%202.78923%2022.955%203.73C23.5%204.8%2023.5%206.2%2023.5%209V15.5C23.5%2018.3%2023.5%2019.7%2022.955%2020.77C22.4756%2021.7108%2021.7108%2022.4756%2020.77%2022.955C19.7%2023.5%2018.3%2023.5%2015.5%2023.5H9C6.2%2023.5%204.8%2023.5%203.73%2022.955C2.78923%2022.4756%202.02436%2021.7108%201.545%2020.77C1%2019.7%201%2018.3%201%2015.5V9Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M24.0338%209.9875C15.7712%208.8525%208.64625%2014.9875%209.125%2023.125M6%207.5C6%208.16304%206.26339%208.79893%206.73223%209.26777C7.20107%209.73661%207.83696%2010%208.5%2010C9.16304%2010%209.79893%209.73661%2010.2678%209.26777C10.7366%208.79893%2011%208.16304%2011%207.5C11%206.83696%2010.7366%206.20107%2010.2678%205.73223C9.79893%205.26339%209.16304%205%208.5%205C7.83696%205%207.20107%205.26339%206.73223%205.73223C6.26339%206.20107%206%206.83696%206%207.5Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M1%2016.0821C4.475%2015.6008%207.59375%2017.2796%209.28%2019.9571'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_2805_8627'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,photo:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M17.1667%202.00387H20.6667M22.44%2022.3165C22.7993%2021.879%2023%2021.2853%2023%2020.6671V6.66967C23%206.05145%2022.7993%205.45656%2022.44%205.02031C22.0842%204.58172%2021.5988%204.33677%2021.0925%204.33677H10.6147C8.60217%204.33677%208.2125%202.31764%206.46483%202.03419C6.15683%201.98404%205.83717%202.00387%205.52567%202.00387C4.41383%202.00387%203.8585%202.00387%203.421%202.18933C2.86448%202.42584%202.42153%202.86913%202.1855%203.42577C2%203.86086%202%204.41609%202%205.52772V20.6671C2%2021.2853%202.20067%2021.8802%202.56%2022.3165C2.917%2022.7539%203.40233%2023%203.90867%2023H21.0913C21.5977%2023%2022.0818%2022.755%2022.44%2022.3165Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M13%2019C14.3261%2019%2015.5979%2018.4732%2016.5355%2017.5355C17.4732%2016.5979%2018%2015.3261%2018%2014C18%2012.6739%2017.4732%2011.4021%2016.5355%2010.4645C15.5979%209.52678%2014.3261%209%2013%209C11.6739%209%2010.4021%209.52678%209.46447%2010.4645C8.52678%2011.4021%208%2012.6739%208%2014C8%2015.3261%208.52678%2016.5979%209.46447%2017.5355C10.4021%2018.4732%2011.6739%2019%2013%2019Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,video:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2015.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Video'%20d='M0.75%2012.3152V3.18478C0.75%202.53904%201.00754%201.91974%201.46596%201.46313C1.92438%201.00652%202.54614%200.75%203.19444%200.75H13.5833C14.2316%200.75%2014.8534%201.00652%2015.3118%201.46313C15.7702%201.91974%2016.0278%202.53904%2016.0278%203.18478V12.3152C16.0278%2012.961%2015.7702%2013.5803%2015.3118%2014.0369C14.8534%2014.4935%2014.2316%2014.75%2013.5833%2014.75H3.19444C2.54614%2014.75%201.92438%2014.4935%201.46596%2014.0369C1.00754%2013.5803%200.75%2012.961%200.75%2012.3152ZM21.7331%201.65209L16.8442%205.98965C16.7798%206.04664%2016.7282%206.11656%2016.6928%206.19482C16.6574%206.27308%2016.639%206.35791%2016.6389%206.44374V8.60826C16.639%208.69409%2016.6574%208.77892%2016.6928%208.85718C16.7282%208.93544%2016.7798%209.00536%2016.8442%209.06235L21.7331%2013.3999C21.8212%2013.4778%2021.93%2013.5287%2022.0464%2013.5465C22.1629%2013.5642%2022.282%2013.5481%2022.3894%2013.5C22.4969%2013.4518%2022.5881%2013.3738%2022.652%2013.2753C22.716%2013.1768%2022.75%2013.0619%2022.75%2012.9446V2.10739C22.75%201.99006%2022.716%201.87522%2022.652%201.77669C22.5881%201.67816%2022.4969%201.60015%2022.3894%201.55205C22.282%201.50394%2022.1629%201.48779%2022.0464%201.50554C21.93%201.52329%2021.8212%201.57418%2021.7331%201.65209Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,largeVideo:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2058.5%2037.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='LargeVideo'%20d='M0.75%2030.4891V7.01087C0.75%205.35038%201.41726%203.75791%202.60499%202.58377C3.79272%201.40963%205.40363%200.75%207.08333%200.75H34C35.6797%200.75%2037.2906%201.40963%2038.4783%202.58377C39.6661%203.75791%2040.3333%205.35038%2040.3333%207.01087V30.4891C40.3333%2032.1496%2039.6661%2033.7421%2038.4783%2034.9162C37.2906%2036.0904%2035.6797%2036.75%2034%2036.75H7.08333C5.40363%2036.75%203.79272%2036.0904%202.60499%2034.9162C1.41726%2033.7421%200.75%2032.1496%200.75%2030.4891ZM55.1153%203.06965L42.4487%2014.2234C42.2817%2014.3699%2042.148%2014.5497%2042.0563%2014.751C41.9647%2014.9522%2041.9171%2015.1703%2041.9167%2015.391V20.957C41.9171%2021.1777%2041.9647%2021.3958%2042.0563%2021.597C42.148%2021.7983%2042.2817%2021.9781%2042.4487%2022.1246L55.1153%2033.2783C55.3435%2033.4787%2055.6255%2033.6095%2055.9272%2033.6552C56.2289%2033.7008%2056.5375%2033.6593%2056.8158%2033.5356C57.0942%2033.4119%2057.3305%2033.2113%2057.4962%2032.9579C57.662%2032.7046%2057.7501%2032.4093%2057.75%2032.1076V4.24043C57.7501%203.93872%2057.662%203.64341%2057.4962%203.39006C57.3305%203.13671%2057.0942%202.93611%2056.8158%202.8124C56.5375%202.6887%2056.2289%202.64717%2055.9272%202.69281C55.6255%202.73845%2055.3435%202.86932%2055.1153%203.06965Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,largeCamera:new URL("data:image/svg+xml,%3csvg%20width='60'%20height='60'%20viewBox='0%200%2060%2060'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M42.1667%201.01049H51.6667M56.48%2056.1447C57.4553%2054.9574%2058%2053.3459%2058%2051.6678V13.6748C58%2011.9968%2057.4553%2010.3821%2056.48%209.19799C55.5142%208.00754%2054.1968%207.34266%2052.8225%207.34266H24.3827C18.9202%207.34266%2017.8625%201.86217%2013.1188%201.09281C12.2828%200.956671%2011.4152%201.01049%2010.5697%201.01049C7.55183%201.01049%206.0445%201.01049%204.857%201.5139C3.34644%202.15585%202.14414%203.35906%201.5035%204.86995C1%206.0509%201%207.55795%201%2010.5752V51.6678C1%2053.3459%201.54467%2054.9606%202.52%2056.1447C3.489%2057.332%204.80633%2058%206.18067%2058H52.8193C54.1937%2058%2055.5078%2057.3351%2056.48%2056.1447Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M30%2050C33.9782%2050%2037.7936%2048.4196%2040.6066%2045.6066C43.4196%2042.7936%2045%2038.9782%2045%2035C45%2031.0218%2043.4196%2027.2064%2040.6066%2024.3934C37.7936%2021.5804%2033.9782%2020%2030%2020C26.0218%2020%2022.2064%2021.5804%2019.3934%2024.3934C16.5804%2027.2064%2015%2031.0218%2015%2035C15%2038.9782%2016.5804%2042.7936%2019.3934%2045.6066C22.2064%2048.4196%2026.0218%2050%2030%2050Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,music:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2022.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Music'%20d='M7.625%2018.2292C7.625%2020.1737%206.085%2021.75%204.18811%2021.75C2.28878%2021.75%200.75%2020.1737%200.75%2018.2292C0.75%2016.286%202.29%2014.7097%204.18811%2014.7097C6.08622%2014.7097%207.625%2016.2848%207.625%2018.2292ZM7.625%2018.2292V3.17272C7.625%202.53033%208.10655%201.99419%208.73599%201.93613L21.4165%200.755127C21.5862%200.739451%2021.7573%200.759818%2021.9188%200.81492C22.0802%200.870022%2022.2285%200.958642%2022.3541%201.07509C22.4796%201.19154%2022.5797%201.33324%2022.6479%201.4911C22.7161%201.64895%2022.7509%201.81948%2022.75%201.99172V16.8209C22.75%2018.7641%2021.21%2020.3417%2019.3131%2020.3417C17.4138%2020.3417%2015.875%2018.7641%2015.875%2016.8209C15.875%2014.8777%2017.415%2013.3002%2019.3131%2013.3002C21.2112%2013.3002%2022.75%2014.8789%2022.75%2016.8234'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,smallMusic:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2016.5%2015.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='SmallMusic'%20d='M5.4375%2012.4028C5.4375%2013.6991%204.3875%2014.75%203.09417%2014.75C1.79917%2014.75%200.75%2013.6991%200.75%2012.4028C0.75%2011.1073%201.8%2010.0565%203.09417%2010.0565C4.38833%2010.0565%205.4375%2011.1065%205.4375%2012.4028ZM5.4375%2012.4028V2.36515C5.4375%201.93689%205.76583%201.57946%206.195%201.54075L14.8408%200.753418C14.9565%200.742967%2015.0732%200.756545%2015.1833%200.79328C15.2933%200.830015%2015.3944%200.889094%2015.4801%200.966726C15.5657%201.04436%2015.6339%201.13883%2015.6804%201.24406C15.7269%201.3493%2015.7506%201.46298%2015.75%201.57781V11.464C15.75%2012.7594%2014.7%2013.8111%2013.4067%2013.8111C12.1117%2013.8111%2011.0625%2012.7594%2011.0625%2011.464C11.0625%2010.1685%2012.1125%209.11678%2013.4067%209.11678C14.7008%209.11678%2015.75%2010.1693%2015.75%2011.4656'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,mediumMusic:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2034.5%2032.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='MediumMusic'%20d='M11.0625%2026.5527C11.0625%2029.4231%208.75249%2031.75%205.90716%2031.75C3.05817%2031.75%200.75%2029.4231%200.75%2026.5527C0.75%2023.6841%203.06%2021.3572%205.90716%2021.3572C8.75433%2021.3572%2011.0625%2023.6823%2011.0625%2026.5527ZM11.0625%2026.5527V4.32639C11.0625%203.37811%2011.7848%202.58666%2012.729%202.50095L31.7498%200.757569C32.0044%200.734427%2032.261%200.764492%2032.5032%200.845834C32.7454%200.927175%2032.9678%201.05799%2033.1561%201.22989C33.3445%201.40179%2033.4946%201.61097%2033.5969%201.844C33.6991%202.07703%2033.7513%202.32875%2033.75%202.58301V24.4738C33.75%2027.3423%2031.44%2029.6711%2028.5946%2029.6711C25.7456%2029.6711%2023.4375%2027.3423%2023.4375%2024.4738C23.4375%2021.6052%2025.7475%2019.2764%2028.5946%2019.2764C31.4418%2019.2764%2033.75%2021.607%2033.75%2024.4774'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,largeMusic:new URL("data:image/svg+xml,%3csvg%20width='61'%20height='60'%20viewBox='0%200%2061%2060'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M19.1875%2048.6113C19.1875%2053.7965%2015.0575%2058%209.97038%2058C4.87672%2058%200.75%2053.7965%200.75%2048.6113C0.75%2043.4294%204.88%2039.2259%209.97038%2039.2259C15.0608%2039.2259%2019.1875%2043.4261%2019.1875%2048.6113ZM19.1875%2048.6113V8.46058C19.1875%206.74756%2020.4789%205.31784%2022.167%205.16301L56.1739%202.01367C56.629%201.97187%2057.0878%202.02618%2057.5208%202.17312C57.9538%202.32006%2058.3515%202.55638%2058.6882%202.8669C59.025%203.17743%2059.2934%203.5553%2059.4762%203.97626C59.6591%204.39721%2059.7523%204.85194%2059.75%205.31125V44.8558C59.75%2050.0377%2055.62%2054.2445%2050.5329%2054.2445C45.4392%2054.2445%2041.3125%2050.0377%2041.3125%2044.8558C41.3125%2039.6739%2045.4425%2035.4671%2050.5329%2035.4671C55.6232%2035.4671%2059.75%2039.6772%2059.75%2044.8624'%20stroke='%235D646F'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,location:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12.672%2022.7797C12.4762%2022.9229%2012.2411%2023%2012%2023C11.7589%2023%2011.5238%2022.9229%2011.328%2022.7797C5.53301%2018.5729%20-0.617169%209.91965%205.60021%203.66685C7.30707%201.9568%209.60573%200.998929%2012%201C14.4001%201%2016.7029%201.95943%2018.3998%203.66563C24.6172%209.91843%2018.467%2018.5704%2012.672%2022.7797Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M12%2013C12.7956%2013%2013.5587%2012.6839%2014.1213%2012.1213C14.6839%2011.5587%2015%2010.7956%2015%2010C15%209.20435%2014.6839%208.44129%2014.1213%207.87868C13.5587%207.31607%2012.7956%207%2012%207C11.2044%207%2010.4413%207.31607%209.87868%207.87868C9.31607%208.44129%209%209.20435%209%2010C9%2010.7956%209.31607%2011.5587%209.87868%2012.1213C10.4413%2012.6839%2011.2044%2013%2012%2013Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,smallLocation:new URL("data:image/svg+xml,%3csvg%20width='17'%20height='17'%20viewBox='0%200%2017%2017'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8.44801%2015.8498C8.31745%2015.9475%208.16075%2016%208%2016C7.83925%2016%207.68255%2015.9475%207.55199%2015.8498C3.68867%2012.9815%20-0.411446%207.08158%203.73348%202.81831C4.87138%201.65237%206.40382%200.99927%208%201C9.60005%201%2011.1353%201.65416%2012.2665%202.81748C16.4114%207.08075%2012.3113%2012.9798%208.44801%2015.8498Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M8%209C8.53043%209%209.03914%208.78929%209.41421%208.41421C9.78929%208.03914%2010%207.53043%2010%207C10%206.46957%209.78929%205.96086%209.41421%205.58579C9.03914%205.21071%208.53043%205%208%205C7.46957%205%206.96086%205.21071%206.58579%205.58579C6.21071%205.96086%206%206.46957%206%207C6%207.53043%206.21071%208.03914%206.58579%208.41421C6.96086%208.78929%207.46957%209%208%209Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,mediumLocation:new URL("data:image/svg+xml,%3csvg%20width='35'%20height='35'%20viewBox='0%200%2035%2035'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M18.508%2033.6695C18.2143%2033.8844%2017.8617%2034%2017.5%2034C17.1383%2034%2016.7857%2033.8844%2016.492%2033.6695C7.79952%2027.3593%20-1.42575%2014.3795%207.90032%205.00028C10.4606%202.4352%2013.9086%200.998394%2017.5%201C21.1001%201%2024.5544%202.43915%2027.0997%204.99844C36.4258%2014.3776%2027.2005%2027.3556%2018.508%2033.6695Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M17.5%2019C18.6935%2019%2019.8381%2018.5259%2020.682%2017.682C21.5259%2016.8381%2022%2015.6935%2022%2014.5C22%2013.3065%2021.5259%2012.1619%2020.682%2011.318C19.8381%2010.4741%2018.6935%2010%2017.5%2010C16.3065%2010%2015.1619%2010.4741%2014.318%2011.318C13.4741%2012.1619%2013%2013.3065%2013%2014.5C13%2015.6935%2013.4741%2016.8381%2014.318%2017.682C15.1619%2018.5259%2016.3065%2019%2017.5%2019Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,calendar:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2022.5%2022.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Calendar'%20d='M16.5%203.08333V0.75M6%203.08333V0.75M1.04167%206.58333H21.4583M0.75%208.968C0.75%206.5005%200.75%205.26617%201.25867%204.3235C1.71862%203.48269%202.43233%202.80859%203.298%202.39733C4.29667%201.91667%205.60333%201.91667%208.21667%201.91667H14.2833C16.8967%201.91667%2018.2033%201.91667%2019.202%202.39733C20.0805%202.81967%2020.7933%203.494%2021.2413%204.32233C21.75%205.26733%2021.75%206.50167%2021.75%208.96917V14.6998C21.75%2017.1673%2021.75%2018.4017%2021.2413%2019.3443C20.7814%2020.1851%2020.0677%2020.8592%2019.202%2021.2705C18.2033%2021.75%2016.8967%2021.75%2014.2833%2021.75H8.21667C5.60333%2021.75%204.29667%2021.75%203.298%2021.2693C2.4325%2020.8584%201.71881%2020.1847%201.25867%2019.3443C0.75%2018.3993%200.75%2017.165%200.75%2014.6975V8.968Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,ticket:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2018.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Ticket'%20d='M11.75%208.94643V9.55357M11.75%204.39286V5M11.75%2013.5V14.1071M20.3056%2017.75C20.9539%2017.75%2021.5756%2017.4941%2022.034%2017.0387C22.4925%2016.5832%2022.75%2015.9655%2022.75%2015.3214V11.6786C22.1017%2011.6786%2021.4799%2011.4227%2021.0215%2010.9673C20.5631%2010.5118%2020.3056%209.8941%2020.3056%209.25C20.3056%208.6059%2020.5631%207.98819%2021.0215%207.53274C21.4799%207.0773%2022.1017%206.82143%2022.75%206.82143V3.17857C22.75%202.53447%2022.4925%201.91676%2022.034%201.46131C21.5756%201.00587%2020.9539%200.75%2020.3056%200.75H3.19444C2.54614%200.75%201.92438%201.00587%201.46596%201.46131C1.00754%201.91676%200.75%202.53447%200.75%203.17857V6.82143C1.39831%206.82143%202.02006%207.0773%202.47848%207.53274C2.93691%207.98819%203.19444%208.6059%203.19444%209.25C3.19444%209.8941%202.93691%2010.5118%202.47848%2010.9673C2.02006%2011.4227%201.39831%2011.6786%200.75%2011.6786V15.3214C0.75%2015.9655%201.00754%2016.5832%201.46596%2017.0387C1.92438%2017.4941%202.54614%2017.75%203.19444%2017.75H20.3056Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,clock:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2805_8587)'%3e%3cpath%20d='M11%206V14.25L17%2017'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M23%2012C23%2013.4445%2022.7155%2014.8749%2022.1627%2016.2095C21.6099%2017.5441%2020.7996%2018.7567%2019.7782%2019.7782C18.7567%2020.7996%2017.5441%2021.6099%2016.2095%2022.1627C14.8749%2022.7155%2013.4445%2023%2012%2023C10.5555%2023%209.12506%2022.7155%207.79048%2022.1627C6.4559%2021.6099%205.24327%2020.7996%204.22183%2019.7782C3.20038%2018.7567%202.39013%2017.5441%201.83733%2016.2095C1.28452%2014.8749%201%2013.4445%201%2012C1%209.08262%202.15893%206.28473%204.22183%204.22183C6.28473%202.15893%209.08262%201%2012%201C14.9174%201%2017.7153%202.15893%2019.7782%204.22183C21.8411%206.28473%2023%209.08262%2023%2012Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_2805_8587'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,envelope:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5002%2018.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Envelope'%20d='M0.750082%204.39253L8.71233%209.66707C9.81085%2010.3935%2010.3595%2010.7573%2010.9527%2010.899C11.4774%2011.0237%2012.0239%2011.0237%2012.5474%2010.899C13.1406%2010.7573%2013.6893%2010.3935%2014.7878%209.66707L22.7501%204.39253M6.22556%2017.75H17.2746C19.191%2017.75%2020.1492%2017.75%2020.8816%2017.3794C21.525%2017.0532%2022.0481%2016.5331%2022.3759%2015.8936C22.7501%2015.166%2022.7501%2014.214%2022.7501%2012.31V6.19C22.7501%204.286%2022.7501%203.334%2022.3771%202.6064C22.049%201.96668%2021.5255%201.44656%2020.8816%201.1206C20.1492%200.75%2019.191%200.75%2017.2746%200.75H6.22556C4.30914%200.75%203.35093%200.75%202.61859%201.1206C1.97512%201.44676%201.45203%201.96685%201.12424%202.6064C0.750082%203.334%200.750082%204.286%200.750082%206.19V12.31C0.750082%2014.214%200.750082%2015.166%201.1231%2015.8936C1.45119%2016.5333%201.97469%2017.0534%202.61859%2017.3794C3.35093%2017.75%204.30914%2017.75%206.22556%2017.75Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,largeMessaging:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2059.5%2059.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='LargeMessaging'%20d='M29.75%2058.75C35.4856%2058.75%2041.0925%2057.0492%2045.8615%2053.8626C50.6305%2050.6761%2054.3475%2046.1469%2056.5425%2040.8478C58.7374%2035.5488%2059.3117%2029.7178%2058.1928%2024.0924C57.0738%2018.4669%2054.3118%2013.2996%2050.2561%209.24391C46.2004%205.18819%2041.0331%202.42621%2035.4076%201.30724C29.7822%200.188269%2023.9512%200.762565%2018.6522%202.95751C13.3531%205.15245%208.82394%208.86945%205.63738%2013.6385C2.45082%2018.4075%200.75%2024.0143%200.75%2029.75C0.75%2034.39%201.83911%2038.7722%203.77889%2042.6614C5.23855%2045.5969%203.20855%2049.557%202.43522%2052.4473C2.2639%2053.0866%202.26387%2053.7597%202.43514%2054.3989C2.60641%2055.0382%202.94294%2055.6211%203.41091%2056.0891C3.87888%2056.5571%204.4618%2056.8936%205.10106%2057.0649C5.74033%2057.2361%206.41341%2057.2361%207.05266%2057.0648C9.943%2056.2914%2013.9031%2054.2614%2016.8386%2055.7243C20.8509%2057.7166%2025.2703%2058.7522%2029.75%2058.75Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,squareComment:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2021.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='SquareComment'%20d='M2.36041%2016.1144C0.750006%2014.8133%200.750006%2013.8289%200.750006%209.63889C0.750006%205.44889%200.750006%203.35333%202.36041%202.05222C3.97301%200.75%206.56461%200.75%2011.75%200.75C16.9354%200.75%2019.5281%200.75%2021.1385%202.05222C22.7489%203.35444%2022.75%205.44889%2022.75%209.63889C22.75%2013.8289%2022.75%2014.8133%2021.1385%2016.1144C19.5292%2017.4167%2016.9354%2017.4167%2011.75%2017.4167C8.98901%2017.4167%207.57001%2019.3478%205.15001%2020.75V17.1811C3.94661%2017%203.06111%2016.6811%202.36041%2016.1144Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,atSymbol:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2022.5%2022.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='@'%20d='M15.9167%2011.2454V6.58104M15.9167%2011.2454C15.9167%205.22887%206.58333%205.22887%206.58333%2011.2454C6.58333%2017.2736%2015.9167%2017.2071%2015.9167%2011.2454ZM15.9167%2011.2454C15.9167%2017.0788%2021.75%2017.0788%2021.75%2011.2454C21.75%205.4482%2017.0483%200.75%2011.25%200.75C5.45167%200.75%200.75%205.4482%200.75%2011.2454C0.75%2017.0414%205.45167%2021.7396%2011.25%2021.7396C13.2042%2021.8376%2015.8443%2021.2485%2017.9887%2019.6035'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,mediumSend:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2034.5%2034.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='MediumSend'%20d='M20.9186%2013.5813L15.4175%2019.0818M32.4489%200.80366C32.6229%200.743621%2032.8103%200.73374%2032.9897%200.775147C33.169%200.816554%2033.3331%200.907578%2033.4632%201.03782C33.5932%201.16805%2033.684%201.33225%2033.7252%201.51164C33.7663%201.69103%2033.7562%201.87838%2033.6959%202.05227L22.833%2033.0934C22.768%2033.2789%2022.6488%2033.4406%2022.4907%2033.5576C22.3326%2033.6745%2022.1431%2033.7413%2021.9466%2033.7492C21.7501%2033.7571%2021.5558%2033.7058%2021.3889%2033.6019C21.2219%2033.4981%2021.09%2033.3464%2021.0103%2033.1667L15.1077%2019.8885C15.0083%2019.6677%2014.8316%2019.4909%2014.6107%2019.3916L1.33107%2013.4878C1.15191%2013.4078%201.00085%2013.2759%200.897411%2013.1092C0.793969%2012.9425%200.742898%2012.7486%200.750795%2012.5526C0.758693%2012.3566%200.825195%2012.1674%200.941712%2012.0096C1.05823%2011.8517%201.21941%2011.7324%201.40442%2011.6671L32.4489%200.80366Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,userPlus:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2022.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='UserPlus'%20d='M21.75%2022.75C21.085%209.91712%201.41502%209.91712%200.750018%2022.75M8.45002%2020H14.05M11.25%2017.25V22.75M15.45%204.875C15.45%205.96902%2015.0075%207.01823%2014.2199%207.79182C13.4322%208.5654%2012.3639%209%2011.25%209C10.1361%209%209.06782%208.5654%208.28017%207.79182C7.49252%207.01823%207.05002%205.96902%207.05002%204.875C7.05002%203.78098%207.49252%202.73177%208.28017%201.95818C9.06782%201.1846%2010.1361%200.75%2011.25%200.75C12.3639%200.75%2013.4322%201.1846%2014.2199%201.95818C15.0075%202.73177%2015.45%203.78098%2015.45%204.875Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,twoUsers:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2020.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='TwoUsers'%20d='M22.75%2019.75C22.75%2017.1881%2020.7089%2013.5376%2017.8611%2012.7298M15.4167%2019.75C15.4167%2016.5004%2012.1338%2012.3952%208.08333%2012.3952C4.03289%2012.3952%200.75%2016.5004%200.75%2019.75M15.4167%208.10484C16.3891%208.10484%2017.3218%207.7174%2018.0094%207.02775C18.697%206.3381%2019.0833%205.40273%2019.0833%204.42742C19.0833%203.45211%2018.697%202.51674%2018.0094%201.82709C17.3218%201.13744%2016.3891%200.75%2015.4167%200.75M11.75%204.42742C11.75%205.40273%2011.3637%206.3381%2010.6761%207.02775C9.98843%207.7174%209.05579%208.10484%208.08333%208.10484C7.11087%208.10484%206.17824%207.7174%205.49061%207.02775C4.80298%206.3381%204.41667%205.40273%204.41667%204.42742C4.41667%203.45211%204.80298%202.51674%205.49061%201.82709C6.17824%201.13744%207.11087%200.75%208.08333%200.75C9.05579%200.75%209.98843%201.13744%2010.6761%201.82709C11.3637%202.51674%2011.75%203.45211%2011.75%204.42742Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,dollar:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2016.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Dollar'%20d='M14.5%203.19444H8.25M8.25%203.19444H5.125C3.96468%203.19444%202.85188%203.64514%202.03141%204.44738C1.21094%205.24962%200.75%206.33768%200.75%207.47222C0.75%208.60676%201.21094%209.69483%202.03141%2010.4971C2.85188%2011.2993%203.96468%2011.75%205.125%2011.75H8.25M8.25%203.19444V0.75M8.25%203.19444V11.75M8.25%2011.75H11.375C11.9495%2011.75%2012.5184%2011.8606%2013.0492%2012.0756C13.58%2012.2906%2014.0623%2012.6057%2014.4686%2013.0029C14.8748%2013.4002%2015.1971%2013.8717%2015.417%2014.3907C15.6368%2014.9097%2015.75%2015.466%2015.75%2016.0278C15.75%2016.5895%2015.6368%2017.1458%2015.417%2017.6648C15.1971%2018.1838%2014.8748%2018.6554%2014.4686%2019.0526C14.0623%2019.4499%2013.58%2019.7649%2013.0492%2019.9799C12.5184%2020.1949%2011.9495%2020.3056%2011.375%2020.3056H8.25M8.25%2011.75V20.3056M8.25%2020.3056H0.75M8.25%2020.3056V22.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,mediumDollar:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2034.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='MediumDollar'%20d='M20.9167%204.41667H11.75M11.75%204.41667H7.16667C5.46486%204.41667%203.83276%205.09271%202.6294%206.29607C1.42604%207.49942%200.75%209.13153%200.75%2010.8333C0.75%2012.5351%201.42604%2014.1672%202.6294%2015.3706C3.83276%2016.574%205.46486%2017.25%207.16667%2017.25H11.75M11.75%204.41667V0.75M11.75%204.41667V17.25M11.75%2017.25H16.3333C17.176%2017.25%2018.0104%2017.416%2018.7889%2017.7384C19.5674%2018.0609%2020.2748%2018.5336%2020.8706%2019.1294C21.4664%2019.7252%2021.9391%2020.4326%2022.2616%2021.2111C22.584%2021.9896%2022.75%2022.824%2022.75%2023.6667C22.75%2024.5093%2022.584%2025.3437%2022.2616%2026.1222C21.9391%2026.9007%2021.4664%2027.6081%2020.8706%2028.2039C20.2748%2028.7998%2019.5674%2029.2724%2018.7889%2029.5949C18.0104%2029.9174%2017.176%2030.0833%2016.3333%2030.0833H11.75M11.75%2017.25V30.0833M11.75%2030.0833H0.75M11.75%2030.0833V33.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,building:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Building'%20d='M0.75%2022.75H22.75M2.72436%2022.75V6.2258C2.72436%204.3085%202.72436%203.3504%203.09328%202.6178C3.41254%201.98034%203.9302%201.45753%204.57236%201.124C5.29667%200.75%206.24436%200.75%208.13974%200.75H8.59103C10.4864%200.75%2011.4341%200.75%2012.1584%201.124C12.8007%201.45782%2013.3184%201.98104%2013.6375%202.6189C14.0064%203.3504%2014.0064%204.3085%2014.0064%206.2258V22.75M9.49359%205.15H7.23718M9.49359%209.55H7.23718M9.49359%2013.95H7.23718M20.55%2022.75V11.1384C20.55%208.6029%2019.6497%207.6756%2017.25%207.6756H14.0064'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,mediumBuildings:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2033.5%2034.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='MediumBuildings'%20d='M0.75%2033.75H32.75M3.62179%2033.75V8.9637C3.62179%206.08775%203.6218%204.6506%204.15841%203.5517C4.62279%202.59552%205.37575%201.81129%206.30979%201.311C7.36333%200.75%208.7418%200.75%2011.4987%200.75H12.1551C14.9121%200.75%2016.2905%200.75%2017.3441%201.311C18.2783%201.81172%2019.0313%202.59655%2019.4954%203.55335C20.0321%204.6506%2020.0321%206.08775%2020.0321%208.9637V33.75M13.4679%207.35H10.1859M13.4679%2013.95H10.1859M13.4679%2020.55H10.1859M29.55%2033.75V16.3326C29.55%2012.5294%2028.2405%2011.1384%2024.75%2011.1384H20.0321'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,lock:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2021.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Lock'%20d='M6.04412%209.30556V6.86111C6.04412%203.48656%207.50177%200.75%2010.75%200.75C13.9982%200.75%2015.4559%203.48656%2015.4559%206.86111V9.30556M0.75%2018.8389V13.2167C0.75%2011.8478%200.75%2011.1633%201.00647%2010.6414C1.23185%2010.1811%201.59181%209.80667%202.03471%209.572C2.53824%209.30678%203.19706%209.30678%204.51471%209.30678H16.9853C18.3029%209.30678%2018.9618%209.30678%2019.4653%209.572C19.908%209.80635%2020.2679%2010.1803%2020.4935%2010.6402C20.75%2011.1633%2020.75%2011.8478%2020.75%2013.2167V18.8389C20.75%2020.2078%2020.75%2020.8922%2020.4935%2021.4153C20.2679%2021.8753%2019.908%2022.2492%2019.4653%2022.4836C18.9618%2022.75%2018.3029%2022.75%2016.9853%2022.75H4.51471C3.19706%2022.75%202.53824%2022.75%202.03471%2022.4836C1.59199%2022.2492%201.23205%2021.8753%201.00647%2021.4153C0.75%2020.8934%200.75%2020.209%200.75%2018.8389Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,key:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Key'%20d='M15.8591%208.16278L17.4724%209.77611C18.6886%2010.9922%2019.1163%208.74944%2020.814%208.46833C21.3836%208.373%2021.8859%208.17989%2022.101%207.54922C22.2917%206.99189%2022.0753%206.46756%2021.3994%205.79167L19.6944%204.08789M10.5278%2012.9722L22.75%200.75M6.25%2022.75C6.97227%2022.75%207.68747%2022.6077%208.35476%2022.3313C9.02205%2022.0549%209.62836%2021.6498%2010.1391%2021.1391C10.6498%2020.6284%2011.0549%2020.0221%2011.3313%2019.3548C11.6077%2018.6875%2011.75%2017.9723%2011.75%2017.25C11.75%2016.5277%2011.6077%2015.8125%2011.3313%2015.1452C11.0549%2014.478%2010.6498%2013.8716%2010.1391%2013.3609C9.62836%2012.8502%209.02205%2012.4451%208.35476%2012.1687C7.68747%2011.8923%206.97227%2011.75%206.25%2011.75C4.79131%2011.75%203.39236%2012.3295%202.36091%2013.3609C1.32946%2014.3924%200.75%2015.7913%200.75%2017.25C0.75%2018.7087%201.32946%2020.1076%202.36091%2021.1391C3.39236%2022.1705%204.79131%2022.75%206.25%2022.75Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,shield:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2018.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Shield'%20d='M8.60279%2022.5303C8.78883%2022.6728%209.01619%2022.75%209.25%2022.75C9.48381%2022.75%209.71117%2022.6728%209.89721%2022.5303C11.8826%2021.0307%2017.75%2016.1334%2017.75%2010.5481V4.52276C17.7512%204.36734%2017.6952%204.21696%2017.5927%204.10071C17.4902%203.98445%2017.3485%203.91057%2017.1951%203.89334C14.7636%203.64268%2012.4333%202.783%2010.4169%201.39277L9.67621%200.883124C9.55077%200.796414%209.40217%200.75%209.25%200.75C9.09783%200.75%208.94923%200.796414%208.82379%200.883124L8.08307%201.39277C6.06666%202.783%203.73636%203.64268%201.30495%203.89334C1.15148%203.91057%201.0098%203.98445%200.907302%204.10071C0.804806%204.21696%200.748768%204.36734%200.750021%204.52276V10.5481C0.750021%2016.1334%206.61744%2021.0307%208.60279%2022.5278'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,ban:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Ban'%20d='M19.0833%204.41667L4.41667%2019.0833M22.75%2011.75C22.75%2013.1945%2022.4655%2014.6249%2021.9127%2015.9595C21.3599%2017.2941%2020.5496%2018.5067%2019.5282%2019.5282C18.5067%2020.5496%2017.2941%2021.3599%2015.9595%2021.9127C14.6249%2022.4655%2013.1945%2022.75%2011.75%2022.75C10.3055%2022.75%208.87506%2022.4655%207.54048%2021.9127C6.2059%2021.3599%204.99327%2020.5496%203.97183%2019.5282C2.95038%2018.5067%202.14013%2017.2941%201.58733%2015.9595C1.03452%2014.6249%200.75%2013.1945%200.75%2011.75C0.75%208.83262%201.90893%206.03473%203.97183%203.97183C6.03473%201.90893%208.83262%200.75%2011.75%200.75C14.6674%200.75%2017.4653%201.90893%2019.5282%203.97183C21.5911%206.03473%2022.75%208.83262%2022.75%2011.75Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,flag:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2021.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Flag'%20d='M0.75%2022.75V16.2565M0.75%2016.2565C8.0225%2010.6955%2013.4775%2021.8174%2020.75%2016.2565V2.35526C13.4775%207.91623%208.0225%20-3.2057%200.75%202.35526V16.2565Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,barChart:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='BarChart'%20d='M22.75%2022.75H8.57222C5.83444%2022.75%204.46556%2022.75%203.41933%2022.2171C2.49947%2021.7484%201.7516%2021.0005%201.28289%2020.0807C0.75%2019.0344%200.75%2017.6656%200.75%2014.9278V0.75M17.25%2017.8611V11.75M11.75%2017.8611V5.63889M6.25%2017.8611V9.30556'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,pieChart:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='PieChart'%20d='M11.7499%200.75C9.94095%200.750016%208.15992%201.19616%206.56457%202.0489C4.96922%202.90165%203.6088%204.13468%202.60381%205.63877C1.59881%207.14287%200.98027%208.8716%200.802968%2010.6718C0.625665%2012.4721%200.895075%2014.2883%201.58733%2015.9595C2.27959%2017.6308%203.37333%2019.1055%204.77167%2020.2531C6.17001%2021.4007%207.82979%2022.1857%209.60398%2022.5386C11.3782%2022.8915%2013.212%2022.8015%2014.9431%2022.2764C16.6741%2021.7513%2018.249%2020.8073%2019.5281%2019.5282M11.7499%200.75C13.9255%200.749981%2016.0523%201.39511%2017.8612%202.6038C19.6702%203.8125%2021.0801%205.53047%2021.9127%207.54047C22.7452%209.55047%2022.9631%2011.7622%2022.5386%2013.896C22.1142%2016.0298%2021.0665%2017.9898%2019.5281%2019.5282M11.7499%200.75V11.75L19.5281%2019.5282'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,trendingUp:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2015.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='TrendingUp'%20d='M22.75%200.75L14.7118%209.0632C12.0113%2011.8394%209.066%206.056%206.25138%209.0618L0.750001%2014.75M22.75%200.75V10.55M22.75%200.75H13.125'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,globe:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Globe'%20d='M11.75%2022.75C13.1945%2022.75%2014.6249%2022.4655%2015.9595%2021.9127C17.2941%2021.3599%2018.5067%2020.5496%2019.5282%2019.5282C20.5496%2018.5067%2021.3599%2017.2941%2021.9127%2015.9595C22.4655%2014.6249%2022.75%2013.1945%2022.75%2011.75C22.75%2010.3055%2022.4655%208.87506%2021.9127%207.54048C21.3599%206.2059%2020.5496%204.99327%2019.5282%203.97183C18.5067%202.95038%2017.2941%202.14013%2015.9595%201.58733C14.6249%201.03452%2013.1945%200.75%2011.75%200.75M11.75%2022.75C10.3055%2022.75%208.87506%2022.4655%207.54048%2021.9127C6.2059%2021.3599%204.99327%2020.5496%203.97183%2019.5282C2.95038%2018.5067%202.14013%2017.2941%201.58733%2015.9595C1.03452%2014.6249%200.75%2013.1945%200.75%2011.75C0.75%2010.3055%201.03452%208.87506%201.58733%207.54048C2.14013%206.2059%202.95038%204.99327%203.97183%203.97183C4.99327%202.95038%206.2059%202.14013%207.54048%201.58733C8.87506%201.03452%2010.3055%200.75%2011.75%200.75M11.75%2022.75C15.1246%2022.75%2016.5668%2016.4397%2016.5668%2011.75C16.5668%207.06033%2015.1246%200.75%2011.75%200.75M11.75%2022.75C8.37544%2022.75%206.93322%2016.4397%206.93322%2011.75C6.93322%207.06033%208.37544%200.75%2011.75%200.75M1.36111%208.08333H22.1389M1.36111%2015.4167H22.1389'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,eye:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1.60458%2014.0064C1.30537%2013.6068%201.15576%2013.4064%201.05236%2013.0207C0.982548%2012.6773%200.982548%2012.3238%201.05236%2011.9804C1.15576%2011.5936%201.30537%2011.3932%201.60458%2010.9946C3.24255%208.80357%206.83309%205%2012%205C17.1669%205%2020.7575%208.80357%2022.3954%2010.9936C22.6946%2011.3932%2022.8442%2011.5936%2022.9476%2011.9793C23.0175%2012.3227%2023.0175%2012.6762%2022.9476%2013.0196C22.8442%2013.4064%2022.6946%2013.6068%2022.3954%2014.0054C20.7575%2016.1964%2017.1669%2020%2012%2020C6.83309%2020%203.24255%2016.1964%201.60458%2014.0064Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M12%2015C12.7956%2015%2013.5587%2014.6839%2014.1213%2014.1213C14.6839%2013.5587%2015%2012.7956%2015%2012C15%2011.2044%2014.6839%2010.4413%2014.1213%209.87868C13.5587%209.31607%2012.7956%209%2012%209C11.2044%209%2010.4413%209.31607%209.87868%209.87868C9.31607%2010.4413%209%2011.2044%209%2012C9%2012.7956%209.31607%2013.5587%209.87868%2014.1213C10.4413%2014.6839%2011.2044%2015%2012%2015Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,externalLink:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='ExternalLink'%20d='M22.75%200.75H14.5M22.75%200.75V9M22.75%200.75L12.6667%2010.8333M8.57222%200.75C5.83444%200.75%204.46556%200.75%203.41933%201.28289C2.49947%201.7516%201.7516%202.49947%201.28289%203.41933C0.75%204.46556%200.75%205.83444%200.75%208.57222V14.9278C0.75%2017.6656%200.75%2019.0344%201.28289%2020.0807C1.7516%2021.0005%202.49947%2021.7484%203.41933%2022.2171C4.46556%2022.75%205.83444%2022.75%208.57222%2022.75H14.9278C17.6656%2022.75%2019.0344%2022.75%2020.0807%2022.2171C21.0005%2021.7484%2021.7484%2021.0005%2022.2171%2020.0807C22.75%2019.0344%2022.75%2017.6656%2022.75%2014.9278V13.5833'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,maximize:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2021.5%2021.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='Maximize'%20d='M13.25%200.75H20.75M20.75%200.75V8.25M20.75%200.75L13.25%208.25M8.25%2020.75H0.75M0.75%2020.75V13.25M0.75%2020.75L8.25%2013.25'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,mousePointer:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2023.5013%2023.5013'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='MousePointer'%20d='M12.942%2012.942L20.6805%209.62551C21.9758%209.07001%2021.8988%207.20826%2020.5623%206.76276L2.77112%200.832366C1.57349%200.433615%200.433615%201.57349%200.832366%202.77112L6.76276%2020.5623C7.20826%2021.8988%209.07001%2021.9758%209.62551%2020.6805L12.942%2012.942ZM12.942%2012.942L22.7513%2022.7513'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,target:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2805_8593)'%3e%3cpath%20d='M12%2014C12.5304%2014%2013.0391%2013.7893%2013.4142%2013.4142C13.7893%2013.0391%2014%2012.5304%2014%2012C14%2011.4696%2013.7893%2010.9609%2013.4142%2010.5858C13.0391%2010.2107%2012.5304%2010%2012%2010C11.4696%2010%2010.9609%2010.2107%2010.5858%2010.5858C10.2107%2010.9609%2010%2011.4696%2010%2012C10%2012.5304%2010.2107%2013.0391%2010.5858%2013.4142C10.9609%2013.7893%2011.4696%2014%2012%2014Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M12%2019C13.8565%2019%2015.637%2018.2625%2016.9497%2016.9497C18.2625%2015.637%2019%2013.8565%2019%2012C19%2010.1435%2018.2625%208.36301%2016.9497%207.05025C15.637%205.7375%2013.8565%205%2012%205C10.1435%205%208.36301%205.7375%207.05025%207.05025C5.7375%208.36301%205%2010.1435%205%2012C5%2013.8565%205.7375%2015.637%207.05025%2016.9497C8.36301%2018.2625%2010.1435%2019%2012%2019Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M23%2012C23%2013.4445%2022.7155%2014.8749%2022.1627%2016.2095C21.6099%2017.5441%2020.7996%2018.7567%2019.7782%2019.7782C18.7567%2020.7996%2017.5441%2021.6099%2016.2095%2022.1627C14.8749%2022.7155%2013.4445%2023%2012%2023C10.5555%2023%209.12506%2022.7155%207.79048%2022.1627C6.4559%2021.6099%205.24327%2020.7996%204.22183%2019.7782C3.20038%2018.7567%202.39013%2017.5441%201.83733%2016.2095C1.28452%2014.8749%201%2013.4445%201%2012C1%209.08262%202.15893%206.28473%204.22183%204.22183C6.28473%202.15893%209.08262%201%2012%201C14.9174%201%2017.7153%202.15893%2019.7782%204.22183C21.8411%206.28473%2023%209.08262%2023%2012Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_2805_8593'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,ribbonAward:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.20833%2014L6%2021.7817C6%2022.7604%208.15325%2023.396%208.95679%2022.9586L11.5015%2021.5726C11.6671%2021.4819%2011.8529%2021.4343%2012.0417%2021.4343C12.2305%2021.4343%2012.4162%2021.4819%2012.5818%2021.5726L15.1265%2022.9586C15.9301%2023.396%2018.0833%2022.7592%2018.0833%2021.7805L16.875%2014'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M19.5%208.25C19.5%2010.1728%2018.7362%2012.0169%2017.3765%2013.3765C16.0169%2014.7362%2014.1728%2015.5%2012.25%2015.5C10.3272%2015.5%208.48311%2014.7362%207.12348%2013.3765C5.76384%2012.0169%205%2010.1728%205%208.25C5%206.32718%205.76384%204.48311%207.12348%203.12348C8.48311%201.76384%2010.3272%201%2012.25%201C14.1728%201%2016.0169%201.76384%2017.3765%203.12348C18.7362%204.48311%2019.5%206.32718%2019.5%208.25Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,mediumShootingStar:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2034.5%2034.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='MediumShootingStar'%20d='M17.25%205.60283L12.3972%200.75M13.3688%2013.367L2.68967%202.69333M5.60283%2017.25L0.75%2012.3972M10.4557%2022.1028L18.2198%2018.2198L22.1028%2010.4557L25.9858%2018.2198L33.75%2022.1028L25.9858%2025.9858L22.1028%2033.75L18.2198%2025.9858L10.4557%2022.1028Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,mediumMicrophone:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2027%2033'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='MediumMicrophone'%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.64665%201.62564e-09C4.94391%20-3.74968e-05%203.23831%200.648651%201.94301%201.94523C-0.647446%204.53822%20-0.647895%208.7655%201.94301%2011.355C3.66541%2013.0787%205.81866%2013.4729%207.71139%2012.9838L22.3723%2025.8153C22.4445%2025.8774%2022.5279%2025.9251%2022.618%2025.9559C23.349%2026.2228%2024.0841%2026.0692%2024.689%2025.7099C25.3314%2026.5367%2025.535%2027.3464%2025.4963%2028.0886C25.4512%2028.9578%2025.0412%2029.775%2024.4082%2030.3972C23.7752%2031.0194%2022.9306%2031.4225%2022.0914%2031.4869C21.2536%2031.5513%2020.4211%2031.3127%2019.6577%2030.5612C19.6577%2030.5612%2019.6577%2030.5503%2019.6577%2030.5496L10.9642%2021.8546C10.0576%2020.9471%208.97097%2020.5422%207.93372%2020.5539C7.86456%2020.5539%207.7917%2020.5494%207.72311%2020.5539C6.62591%2020.6264%205.62943%2021.1394%204.87988%2021.8898C4.13022%2022.6401%203.6185%2023.6504%203.54597%2024.749C3.47356%2025.8476%203.87771%2027.027%204.84476%2027.995C4.91419%2028.0665%204.99715%2028.1233%205.08879%2028.1623C5.18042%2028.2012%205.2789%2028.2215%205.37845%2028.2219C5.478%2028.2223%205.57664%2028.2028%205.66858%2028.1646C5.76053%2028.1264%205.84394%2028.0702%205.91395%2027.9993C5.98395%2027.9284%206.03914%2027.8443%206.07629%2027.7518C6.11343%2027.6593%206.13179%2027.5602%206.13029%2027.4606C6.12879%2027.3609%206.10746%2027.2625%206.06754%2027.1712C6.02762%2027.0798%205.96992%2026.9974%205.89781%2026.9286C5.19945%2026.2296%204.9867%2025.529%205.03197%2024.8428C5.07724%2024.1565%205.41537%2023.4743%205.9329%2022.9561C6.45049%2022.438%207.13081%2022.0992%207.81671%2022.0538C8.50261%2022.0085%209.21285%2022.222%209.9111%2022.921L18.6047%2031.6159C18.6046%2031.6198%2018.6046%2031.6237%2018.6047%2031.6275C19.659%2032.6681%2020.9761%2033.0816%2022.2084%2032.9869C23.4408%2032.8922%2024.5915%2032.3184%2025.4612%2031.4635C26.3309%2030.6086%2026.927%2029.4486%2026.994%2028.1589C27.0541%2027.0026%2026.6655%2025.7712%2025.742%2024.6435C26.0682%2024.0548%2026.1917%2023.3334%2025.9175%2022.6279C25.8842%2022.546%2025.8367%2022.4706%2025.7771%2022.4053C21.2447%2017.2472%2017.478%2012.8542%2012.965%207.72233C13.4471%205.82472%2013.0576%203.66282%2011.3386%201.94523C10.0453%200.648989%208.34899%202.25007e-05%206.64665%201.62564e-09ZM6.64665%201.49994C7.963%201.4999%209.27859%202.00187%2010.2855%203.01159C10.3177%203.0438%2010.3482%203.07296%2010.3791%203.10534C10.3791%203.148%2010.3724%203.25672%2010.2972%203.48032C10.2009%203.76681%2010.012%204.16544%209.73561%204.59355C9.18278%205.44976%208.31256%206.46328%207.37209%207.39422C6.43162%208.32515%205.41332%209.17713%204.55226%209.72615C4.12153%2010.0006%203.7279%2010.1912%203.44069%2010.2886C3.21379%2010.3656%203.10083%2010.3694%203.06627%2010.3707C3.04193%2010.347%203.02025%2010.3246%202.99606%2010.3003C0.978619%208.28435%200.97787%205.03177%202.99606%203.01159C4.00516%202.00151%205.33031%201.49996%206.64665%201.49994ZM11.4088%204.6873C11.8283%205.75533%2011.7529%206.85092%2011.3503%207.8981C10.7359%209.49415%209.28889%2010.8932%207.67631%2011.437C7.66058%2011.4404%207.64497%2011.4443%207.6295%2011.4486C6.64549%2011.7721%205.62722%2011.8161%204.63415%2011.4134C4.86958%2011.2925%205.11415%2011.148%205.35959%2010.9915C6.35367%2010.3578%207.42365%209.4517%208.42514%208.46039C9.4266%207.46909%2010.3463%206.39532%2010.9876%205.40191C11.145%205.15832%2011.2872%204.92223%2011.4088%204.6873ZM14.919%2012.2221C18.1337%2015.9066%2021.1172%2019.3663%2024.5486%2023.2724C24.6239%2023.5923%2024.4883%2023.9382%2024.1976%2024.2216C23.9103%2024.5016%2023.5422%2024.6295%2023.2381%2024.5731L12.2161%2014.9291L14.919%2012.2221Z'%20fill='%230E0E0E'/%3e%3c/svg%3e",import.meta.url).href,mediumEdit:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2030.5%2034.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='MediumEdit'%20d='M0.75%2033.75H29.75M3.76962%2019.4264C2.9968%2020.2099%202.56269%2021.2713%202.5625%2022.378V28.2501H8.40419C9.49894%2028.2501%2010.5484%2027.8101%2011.3223%2027.0255L28.5411%209.59995C29.3136%208.8164%2029.7475%207.75495%2029.7475%206.64834C29.7475%205.54173%2029.3136%204.48028%2028.5411%203.69673L26.8409%201.97343C26.4575%201.58541%2026.0023%201.27764%2025.5012%201.06772C25.0001%200.857794%2024.463%200.74983%2023.9206%200.75C23.3783%200.75017%2022.8412%200.858471%2022.3403%201.06871C21.8393%201.27895%2021.3842%201.587%2021.0011%201.97526L3.76962%2019.4264Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,logOut:new URL("data:image/svg+xml,%3csvg%20preserveAspectRatio='none'%20width='100%25'%20height='100%25'%20overflow='visible'%20style='display:%20block;'%20viewBox='0%200%2019.5%2023.5'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20id='LogOut'%20d='M11.5452%2022.75H3.15C1.824%2022.75%200.75%2021.3432%200.75%2019.6077V3.89111C0.75%202.15678%201.824%200.75%203.15%200.75H11.55M14.55%2016.0278L18.75%2011.75L14.55%207.47222M6.75%2011.7451H18.75'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",import.meta.url).href,spotifyLogo:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2805_8727)'%3e%3cpath%20d='M19.0984%2010.6382C15.2303%208.34104%208.84992%208.12986%205.15732%209.25057C4.56419%209.43048%203.9372%209.09581%203.75762%208.50278C3.57793%207.90944%203.91227%207.28277%204.50562%207.10255C8.7446%205.8159%2015.7909%206.06438%2020.244%208.70773C20.7775%209.02445%2020.9522%209.71323%2020.6362%2010.2456C20.3198%2010.779%2019.6304%2010.955%2019.0984%2010.6382ZM18.9716%2014.0406C18.7003%2014.481%2018.1245%2014.6191%2017.6847%2014.3487C14.46%2012.3665%209.54246%2011.7922%205.72724%2012.9503C5.23255%2013.0996%204.70992%2012.8209%204.55967%2012.3269C4.48805%2012.0895%204.5135%2011.8333%204.63045%2011.6146C4.7474%2011.3959%204.9463%2011.2325%205.18354%2011.1602C9.54182%209.83757%2014.96%2010.4781%2018.6638%2012.7543C19.1036%2013.0252%2019.242%2013.6012%2018.9716%2014.0406ZM17.5033%2017.3081C17.4522%2017.3921%2017.385%2017.4651%2017.3056%2017.5231C17.2263%2017.581%2017.1362%2017.6228%2017.0407%2017.6459C16.9452%2017.669%2016.846%2017.673%2016.7489%2017.6578C16.6518%2017.6425%2016.5587%2017.6083%2016.4749%2017.557C13.657%2015.8348%2010.1101%2015.4458%205.93305%2016.4C5.83734%2016.4219%205.73825%2016.4247%205.64145%2016.4083C5.54465%2016.3918%205.45204%2016.3565%205.36889%2016.3043C5.28575%2016.2521%205.2137%2016.184%205.15688%2016.1039C5.10005%2016.0239%205.05956%2015.9334%205.0377%2015.8377C5.0157%2015.7419%205.01279%2015.6428%205.02916%2015.5459C5.04553%2015.4491%205.08084%2015.3564%205.13309%2015.2732C5.18533%2015.19%205.25347%2015.1179%205.33361%2015.0611C5.41374%2015.0043%205.5043%2014.9638%205.6001%2014.942C10.1712%2013.8972%2014.0921%2014.3468%2017.2551%2016.2796C17.339%2016.3308%2017.4119%2016.3981%2017.4698%2016.4775C17.5276%2016.5569%2017.5693%2016.6469%2017.5923%2016.7424C17.6154%2016.8379%2017.6194%2016.937%2017.6041%2017.0341C17.5889%2017.1312%2017.5545%2017.2243%2017.5033%2017.3081ZM11.9998%200C5.37269%200%200%205.37248%200%2011.9998C0%2018.6277%205.37269%2024%2011.9999%2024C18.6274%2024%2024%2018.6277%2024%2011.9998C24%205.37258%2018.6274%200%2011.9998%200Z'%20fill='%231DB954'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_2805_8727'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,appleMusicLogo:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2805_8528)'%3e%3ccircle%20cx='12'%20cy='12'%20r='11.75'%20fill='url(%23paint0_linear_2805_8528)'%20stroke='%23C9C9C9'%20stroke-width='0.5'/%3e%3cpath%20d='M8.6875%2016.6528C8.6875%2017.9491%207.6375%2019%206.34417%2019C5.04917%2019%204%2017.9491%204%2016.6528C4%2015.3573%205.05%2014.3065%206.34417%2014.3065C7.63833%2014.3065%208.6875%2015.3565%208.6875%2016.6528ZM8.6875%2016.6528V6.61515C8.6875%206.18689%209.01583%205.82946%209.445%205.79075L18.0908%205.00342C18.2065%204.99297%2018.3232%205.00654%2018.4333%205.04328C18.5433%205.08001%2018.6444%205.13909%2018.7301%205.21673C18.8157%205.29436%2018.8839%205.38883%2018.9304%205.49406C18.9769%205.5993%2019.0006%205.71298%2019%205.82781V15.714C19%2017.0094%2017.95%2018.0611%2016.6567%2018.0611C15.3617%2018.0611%2014.3125%2017.0094%2014.3125%2015.714C14.3125%2014.4185%2015.3625%2013.3668%2016.6567%2013.3668C17.9508%2013.3668%2019%2014.4193%2019%2015.7156'%20stroke='%23FCFCFC'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_2805_8528'%20x1='12'%20y1='0'%20x2='12'%20y2='24'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23FF4E6B'/%3e%3cstop%20offset='1'%20stop-color='%23FF0436'/%3e%3c/linearGradient%3e%3cclipPath%20id='clip0_2805_8528'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href,instagram:new URL("data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2805_8637)'%3e%3cpath%20d='M16.9514%2011.8405C17.038%2012.4251%2017.0086%2013.021%2016.865%2013.5942C16.7213%2014.1674%2016.4661%2014.7067%2016.114%2015.1813C15.7619%2015.6559%2015.3197%2016.0565%2014.8128%2016.3602C14.3059%2016.6639%2013.7441%2016.8648%2013.1595%2016.9514C12.575%2017.038%2011.9791%2017.0086%2011.4058%2016.865C10.8326%2016.7213%2010.2933%2016.4661%209.81874%2016.114C8.86026%2015.4029%208.22352%2014.3401%208.04861%2013.1595C7.8737%2011.9789%208.17493%2010.7772%208.88605%209.81874C9.59716%208.86026%2010.6599%208.22352%2011.8405%208.04861C13.0211%207.8737%2014.2228%208.17493%2015.1813%208.88605C16.1398%209.59716%2016.7765%2010.6599%2016.9514%2011.8405Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M18.1111%205.27778H18.7222M1%208.82222C1%206.08444%201%204.71556%201.53289%203.66933C2.0016%202.74947%202.74947%202.0016%203.66933%201.53289C4.71556%201%206.08444%201%208.82222%201H15.1778C17.9156%201%2019.2844%201%2020.3307%201.53289C21.2505%202.0016%2021.9984%202.74947%2022.4671%203.66933C23%204.71556%2023%206.08444%2023%208.82222V15.1778C23%2017.9156%2023%2019.2844%2022.4671%2020.3307C21.9984%2021.2505%2021.2505%2021.9984%2020.3307%2022.4671C19.2844%2023%2017.9156%2023%2015.1778%2023H8.82222C6.08444%2023%204.71556%2023%203.66933%2022.4671C2.74947%2021.9984%202.0016%2021.2505%201.53289%2020.3307C1%2019.2844%201%2017.9156%201%2015.1778V8.82222Z'%20stroke='%230E0E0E'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_2805_8637'%3e%3crect%20width='24'%20height='24'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",import.meta.url).href},Ca=({name:e,size:t=24,alt:r,className:n})=>{const i=Iie[e];return i?s.jsx("img",{src:i,alt:r||`${e} icon`,width:t,height:t,className:n,style:{display:"block",flexShrink:0,margin:0,padding:0,verticalAlign:"middle"}}):(console.warn(`Icon "${e}" not found in icons mapping`),null)},$ie=({menuOpen:e=!1,onMenuClick:t})=>s.jsx("button",{className:"global-hamburger-button",onClick:t,"aria-label":e?"Close menu":"Open menu","aria-expanded":e,type:"button",children:e?s.jsx(Ca,{name:"x",size:24,alt:""}):s.jsx(Ca,{name:"hamburgerMenu",size:24,alt:""})}),Lie=({size:e,variant:t,initial:r,imageUrl:n,alt:i,className:a})=>{const o="profile-picture",l=`${o}--${e}`,c=`${o}--${t}`,d=[o,l,c,a].filter(Boolean).join(" "),u=()=>t==="image"&&n?s.jsx("img",{src:n,alt:i||"",className:"profile-picture__image"}):(t==="image"||t==="initial")&&r?s.jsx("span",{className:"profile-picture__initial","aria-hidden":i?void 0:!0,children:r.charAt(0).toUpperCase()}):s.jsx(Ca,{name:"music",size:24,alt:i||"Music",className:"profile-picture__icon"});return s.jsx("div",{className:d,role:i?"img":void 0,"aria-label":i,children:u()})},Fie=({name:e,username:t,initial:r,variant:n,followers:i,following:a,events:o,imageUrl:l,className:c})=>{let d=45,u="initial";n==="artist"?(d=45,u="musicIcon"):n==="chat"?(d=32,u=l?"image":"initial"):n==="userProfile"?(d=75,u=l?"image":"initial"):(d=45,u=l?"image":"initial");const h=["user-info",`user-info--${n}`,c].filter(Boolean).join(" "),f=(n==="user"||n==="userProfile")&&t,p=n==="userProfile",x=[{key:"followers",label:"Followers",value:i},{key:"following",label:"Following",value:a},{key:"events",label:"Events",value:o}];return s.jsxs("div",{className:h,children:[s.jsx("div",{className:"user-info__avatar",children:s.jsx(Lie,{size:d,variant:u,initial:r,imageUrl:l,alt:e})}),s.jsxs("div",{className:"user-info__content",children:[s.jsx("p",{className:"user-info__name",children:e}),f&&s.jsxs("p",{className:"user-info__username",children:["@",t]}),p&&s.jsx("div",{className:"user-info__stats","aria-label":"User statistics",children:x.map(g=>{var v;return s.jsxs("div",{className:"user-info__stat",children:[s.jsx("span",{className:"user-info__stat-value",children:(v=g.value)!=null?v:0}),s.jsx("span",{className:"user-info__stat-label",children:g.label})]},g.key)})})]})]})},Uie=d=>{var u=d,{variant:e="primary",size:t="standard",icon:r,iconPosition:n="left",fullWidth:i=!1,children:a,className:o="",disabled:l}=u,c=me(u,["variant","size","icon","iconPosition","fullWidth","children","className","disabled"]);const h=l||e==="disabled",f=h?"disabled":e,p="synth-button",x=`synth-button--${f}`,g=`synth-button--${t}`,w=[p,x,g,i?"synth-button--full-width":"",t==="iconOnly"?"synth-button--icon-only":"",o].filter(Boolean).join(" "),b=()=>{switch(t){case"iconOnly":return 24;case"tertiary":return 16;case"standard":default:return 24}},N=()=>{if(!r)return null;const k=b();return s.jsx(Ca,{name:r,size:k,className:"synth-button__icon"})},S=t==="iconOnly"||!a&&r;return s.jsxs("button",W(M({type:"button",className:w,disabled:h,"aria-label":S&&!c["aria-label"]&&!a?r:c["aria-label"]},c),{children:[r&&n==="left"&&N(),a&&s.jsx("span",{className:"synth-button__text",children:a}),r&&n==="right"&&N(),S&&!a&&N()]}))},Bie=({text:e,icon:t,iconPosition:r,className:n="",onClick:i})=>{const a="icon-text",o=`icon-text--${r}`,c=[a,o,i?"icon-text--clickable":"",n].filter(Boolean).join(" "),d=s.jsxs(s.Fragment,{children:[r==="left"&&s.jsxs(s.Fragment,{children:[s.jsx(Ca,{name:t,size:24,alt:"",className:"icon-text__icon"}),s.jsx("span",{className:"icon-text__text",children:e})]}),r==="right"&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"icon-text__text",children:e}),s.jsx(Ca,{name:t,size:24,alt:"",className:"icon-text__icon"})]})]});return i?s.jsx("button",{className:c,onClick:i,type:"button","aria-label":e,children:d}):s.jsx("div",{className:c,children:d})},Gx=({label:e,icon:t,onPress:r,className:n=""})=>{const o=["menu-category",r?"menu-category--clickable":"",n].filter(Boolean).join(" "),l=s.jsx("div",{className:"menu-category__content",children:s.jsx(Bie,{text:e,icon:t,iconPosition:"left",className:"menu-category__icon-text"})});return r?s.jsx("button",{className:o,onClick:r,type:"button","aria-label":e,children:l}):s.jsx("div",{className:o,children:l})};class A2{static refreshSignals(){return E(this,null,function*(){try{const{data:t,error:r}=yield P.rpc("refresh_user_preference_signals");return r?(console.error("Error refreshing preference signals:",r),{success:!1,error:r.message}):t&&t.success?(console.log(" Preference signals refreshed:",{signalsUpdated:t.signals_updated,timestamp:t.timestamp}),{success:!0,signalsUpdated:t.signals_updated}):{success:!1,error:"Unknown error"}}catch(t){return console.error("Exception refreshing preference signals:",t),{success:!1,error:t instanceof Error?t.message:"Unknown error"}}})}static shouldRefreshForSession(){const t=localStorage.getItem(this.SESSION_REFRESH_KEY);if(!t)return!0;const r=parseInt(t,10);return Date.now()-r>this.REFRESH_COOLDOWN_MS}static markRefreshed(){localStorage.setItem(this.SESSION_REFRESH_KEY,Date.now().toString())}static clearRefreshMarker(){localStorage.removeItem(this.SESSION_REFRESH_KEY)}static refreshIfNeeded(){return E(this,null,function*(){if(!this.shouldRefreshForSession()){console.log(" Skipping preference signals refresh (recently refreshed)");return}console.log(" Refreshing preference signals at session start..."),(yield this.refreshSignals()).success?this.markRefreshed():console.warn(" Preference signals refresh failed, will retry on next session")})}}_r(A2,"SESSION_REFRESH_KEY","preference_signals_refreshed"),_r(A2,"REFRESH_COOLDOWN_MS",60*60*1e3);function os(){const[e,t]=y.useState(null),[r,n]=y.useState(null),[i,a]=y.useState(!0),[o,l]=y.useState(!1),c=y.useRef(null);return y.useEffect(()=>{E(this,null,function*(){try{const{data:{session:x},error:g}=yield P.auth.getSession();if(g)console.error("Error getting session:",g),l(!0),n(null),t(null);else if(x){const v=Math.floor(Date.now()/1e3);x.expires_at&&x.expires_at<v?(console.log("Initial session expired"),l(!0),n(null),t(null)):(l(!1),n(x),t(x.user),c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{A2.refreshIfNeeded().catch(_=>{console.warn("Failed to refresh preference signals:",_)}),c.current=null},1e3))}else l(!1),n(null),t(null)}catch(x){console.error("Error in getInitialSession:",x),l(!0),n(null),t(null)}finally{a(!1)}});const f=setInterval(()=>E(this,null,function*(){try{const{data:{session:x},error:g}=yield P.auth.getSession();if(g)console.error("Error checking session:",g),l(!0),n(null),t(null);else if(x){const v=Math.floor(Date.now()/1e3);x.expires_at&&x.expires_at<v&&(console.log("Session expired during periodic check"),l(!0),n(null),t(null))}}catch(x){console.error("Error in periodic session check:",x)}}),5*60*1e3),{data:{subscription:p}}=P.auth.onAuthStateChange((x,g)=>E(this,null,function*(){var v;if(console.log("Auth state changed:",x,(v=g==null?void 0:g.user)==null?void 0:v.id),x==="SIGNED_OUT")console.log("User signed out"),l(!1),n(null),t(null);else if(x==="TOKEN_REFRESHED"&&!g)console.log("Session expired - no valid session after token refresh"),l(!0),n(null),t(null);else if(g){const _=Math.floor(Date.now()/1e3);g.expires_at&&g.expires_at<_?(console.log("Session expired - expires_at is in the past"),l(!0),n(null),t(null)):(console.log("Valid session found"),l(!1),n(g),t(g.user),(x==="SIGNED_IN"||x==="TOKEN_REFRESHED"||x==="INITIAL_SESSION")&&(c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{A2.refreshIfNeeded().catch(w=>{console.warn("Failed to refresh preference signals:",w)}),c.current=null},1e3)))}else console.log("No session available"),l(!1),n(null),t(null);a(!1)}));return()=>{p.unsubscribe(),clearInterval(f),c.current&&(clearTimeout(c.current),c.current=null)}},[]),{user:e,session:r,loading:i,sessionExpired:o,signOut:()=>E(this,null,function*(){try{a(!0);const{error:h}=yield P.auth.signOut();h&&console.error("Error signing out:",h)}catch(h){console.error("Error in signOut:",h)}finally{a(!1)}}),resetSessionExpired:()=>{l(!1)}}}class zie{constructor(){_r(this,"cache",new Map);_r(this,"maxSize",1e3)}get(t){const r=this.cache.get(t);return r?Date.now()-r.timestamp>r.ttl?(this.cache.delete(t),null):r.data:null}set(t,r,n){if(this.cache.size>=this.maxSize){const i=this.cache.keys().next().value;i&&this.cache.delete(i)}this.cache.set(t,{data:r,timestamp:Date.now(),ttl:n})}delete(t){this.cache.delete(t)}clear(){this.cache.clear()}clearPattern(t){const r=[];for(const n of this.cache.keys())n.startsWith(t)&&r.push(n);r.forEach(n=>this.cache.delete(n))}cleanup(){const t=Date.now(),r=[];for(const[n,i]of this.cache.entries())t-i.timestamp>i.ttl&&r.push(n);r.forEach(n=>this.cache.delete(n))}getStats(){const t=Date.now();let r=0,n=0;for(const i of this.cache.values())t-i.timestamp>i.ttl?r++:n++;return{total:this.cache.size,active:n,expired:r}}}const Eo=new zie;typeof window!="undefined"&&setInterval(()=>{Eo.cleanup()},5*60*1e3);const W3={connectionDegree:(e,t)=>`connection_degree_${t}_${e}`,connectionInterests:e=>`connection_interests_${e}`,reviews:(e,t,r)=>`reviews_${e}_${t}_${r}`,chatPreviews:e=>`chat_previews_${e}`,userProfile:e=>`user_profile_${e}`,notifications:(e,t)=>`notifications_${e}_${t}`,messages:e=>`messages_${e}`},vg={CONNECTION_DATA:10*60*1e3,REVIEWS:3*60*1e3,CHAT_PREVIEWS:2*60*1e3,USER_PROFILE:5*60*1e3,NOTIFICATIONS:2*60*1e3,MESSAGES:1*60*1e3},sn={log:(...e)=>{},warn:(...e)=>{},error:(...e)=>{console.error(...e)},info:(...e)=>{},debug:(...e)=>{}};function Wu(){const{user:e}=os(),[t,r]=y.useState(null),[n,i]=y.useState(!0),[a,o]=y.useState(null);y.useEffect(()=>{if(!e){r(null),i(!1);return}l()},[e]);const l=()=>E(this,null,function*(){if(e)try{i(!0),o(null);const g=W3.userProfile(e.id),v=Eo.get(g);if(v){r(v),i(!1);return}const{data:_,error:w}=yield P.from("users_complete").select("account_type, subscription_tier, verified, verification_level, business_info").eq("user_id",e.id).single();if(w)sn.error(" useAccountType: Error fetching account info:",w),o(w.message),r({account_type:"user",subscription_tier:"free",verified:!1,verification_level:"none"});else{const b={account_type:_.account_type||"user",subscription_tier:_.subscription_tier||"free",verified:_.verified||!1,verification_level:_.verification_level||"none",business_info:_.business_info};r(b),Eo.set(g,b,vg.USER_PROFILE)}}catch(g){sn.error(" useAccountType: Error in fetchAccountInfo:",g),o("Failed to fetch account information"),r({account_type:"user",subscription_tier:"free",verified:!1,verification_level:"none"})}finally{i(!1)}});return{accountInfo:t,loading:n,error:a,hasAnalyticsAccess:()=>t?["creator","business","admin"].includes(t.account_type):!1,isAdmin:()=>(t==null?void 0:t.account_type)==="admin",isCreator:()=>(t==null?void 0:t.account_type)==="creator",isBusiness:()=>(t==null?void 0:t.account_type)==="business",isRegularUser:()=>(t==null?void 0:t.account_type)==="user",hasPremiumFeatures:()=>t?["premium","professional","enterprise"].includes(t.subscription_tier):!1,getAnalyticsDashboardRoute:()=>{if(!t)return null;switch(t.account_type){case"creator":return"/analytics/creator";case"business":return"/analytics/business";case"admin":return"/analytics/admin";default:return null}},refetch:l}}const He=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx("div",M({ref:r,className:ke("synth-card synth-hover-lift",e)},t))});He.displayName="Card";const xr=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx("div",M({ref:r,className:ke("flex flex-col space-y-1.5 p-6 relative",e)},t))});xr.displayName="CardHeader";const Cr=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx("h3",M({ref:r,className:ke("text-2xl font-semibold leading-none tracking-tight synth-heading",e)},t))});Cr.displayName="CardTitle";const Hu=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx("p",M({ref:r,className:ke("text-sm text-muted-foreground synth-text",e)},t))});Hu.displayName="CardDescription";const st=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx("div",M({ref:r,className:ke("p-6 pt-0 relative",e)},t))});st.displayName="CardContent";const Vie=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx("div",M({ref:r,className:ke("flex items-center p-6 pt-0 relative",e)},t))});Vie.displayName="CardFooter";const xg=qm("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 synth-focus",{variants:{variant:{default:"btn-synth-primary",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 hover:shadow-lg hover:shadow-destructive/25 hover:-translate-y-0.5",outline:"border border-input bg-background/80 backdrop-blur-sm hover:bg-accent hover:text-accent-foreground hover:shadow-md hover:-translate-y-0.5",secondary:"btn-synth-secondary",ghost:"hover:bg-accent hover:text-accent-foreground hover:shadow-sm hover:-translate-y-0.5",link:"text-primary underline-offset-4 hover:underline",synth:"btn-synth-primary","synth-secondary":"btn-synth-secondary"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-lg px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),oe=y.forwardRef((o,a)=>{var l=o,{className:e,variant:t,size:r,asChild:n=!1}=l,i=me(l,["className","variant","size","asChild"]);const c=n?AX:"button";return s.jsx(c,M({className:ke(xg({variant:t,size:r,className:e})),ref:a},i))});oe.displayName="Button";var xE="Progress",yE=100,[qie,wFe]=js(xE),[Wie,Hie]=qie(xE),z$=y.forwardRef((e,t)=>{const u=e,{__scopeProgress:r,value:n=null,max:i,getValueLabel:a=Gie}=u,o=me(u,["__scopeProgress","value","max","getValueLabel"]);(i||i===0)&&!P7(i)&&console.error(Yie(`${i}`,"Progress"));const l=P7(i)?i:yE;n!==null&&!A7(n,l)&&console.error(Kie(`${n}`,"Progress"));const c=A7(n,l)?n:null,d=T2(c)?a(c,l):void 0;return s.jsx(Wie,{scope:r,value:c,max:l,children:s.jsx(Nt.div,W(M({"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":T2(c)?c:void 0,"aria-valuetext":d,role:"progressbar","data-state":W$(c,l),"data-value":c!=null?c:void 0,"data-max":l},o),{ref:t}))})});z$.displayName=xE;var V$="ProgressIndicator",q$=y.forwardRef((e,t)=>{var o;const a=e,{__scopeProgress:r}=a,n=me(a,["__scopeProgress"]),i=Hie(V$,r);return s.jsx(Nt.div,W(M({"data-state":W$(i.value,i.max),"data-value":(o=i.value)!=null?o:void 0,"data-max":i.max},n),{ref:t}))});q$.displayName=V$;function Gie(e,t){return`${Math.round(e/t*100)}%`}function W$(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function T2(e){return typeof e=="number"}function P7(e){return T2(e)&&!isNaN(e)&&e>0}function A7(e,t){return T2(e)&&!isNaN(e)&&e<=t&&e>=0}function Yie(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${yE}\`.`}function Kie(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${yE} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var H$=z$,Zie=q$;const yg=y.forwardRef((i,n)=>{var a=i,{className:e,value:t}=a,r=me(a,["className","value"]);return s.jsx(H$,W(M({ref:n,className:ke("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e)},r),{children:s.jsx(Zie,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}))});yg.displayName=H$.displayName;const Xie=qm("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Be(n){var i=n,{className:e,variant:t}=i,r=me(i,["className","variant"]);return s.jsx("div",M({className:ke(Xie({variant:t}),e)},r))}function Jie(e){switch(e){case"business":return{icon:nQ,colors:{from:"#3B82F6",to:"#2563EB",text:"text-blue-600"},label:"Verified Business",description:"This is a verified business account with confirmed venue or promoter credentials."};case"creator":return{icon:Jt,colors:{from:"#A855F7",to:"#9333EA",text:"text-purple-600"},label:"Verified Creator",description:"This is a verified creator account with confirmed artist or influencer credentials."};case"admin":return{icon:zu,colors:{from:"#F59E0B",to:"#D97706",text:"text-amber-600"},label:"Admin",description:"This is an official Synth platform administrator."};case"user":default:return{icon:Jl,colors:{from:"#10B981",to:"#059669",text:"text-emerald-600"},label:"Verified User",description:"This user has met trust and safety criteria for verification."}}}function T7(e,t=0,r=0,n=0,i=0){const a={profileComplete:!!(e.name&&e.bio&&e.avatar_url&&e.birthday&&e.gender),streamingConnected:!!e.music_streaming_profile,hasReviews:t>=3,hasFriends:r>=10,hasEvents:n>=10,accountAge:e.created_at?new Date().getTime()-new Date(e.created_at).getTime()>=2592e6:!1,emailVerified:!0,hasAttended:i>=3},o=Object.values(a).filter(Boolean).length,l=Object.keys(a).length,c=Math.round(o/l*100),d=o>=4;return{score:c,criteriaMet:o,totalCriteria:l,criteria:a,isVerified:d}}function Qie(e){const t=["name","bio","avatar_url","birthday","gender"];let r=0;for(const n of t)e[n]&&r++;return Math.round(r/t.length*100)}function eae(e,t,r){let n;return e==="profileComplete"&&t&&(n=Qie(t)),{profileComplete:{label:"Complete Profile",description:"Fill out your name, bio, avatar, birthday, and gender",target:n!==void 0?`${n}% complete`:"100% complete"},streamingConnected:{label:"Streaming Account",description:"Connect your Spotify or Apple Music account",target:"Connected"},hasReviews:{label:"Event Reviews",description:"Share your concert experiences by posting reviews",target:"3+ reviews"},hasFriends:{label:"Friend Network",description:"Build your network by connecting with other users",target:r!==void 0?`${r}+ friends`:"10+ friends"},hasEvents:{label:"Event Interests",description:"Show interest in concerts you want to attend",target:"10+ events"},accountAge:{label:"Account Age",description:"Be an active member of the community",target:"30+ days"},emailVerified:{label:"Email Verified",description:"Verify your email address",target:"Verified"},hasAttended:{label:"Event Attendance",description:"Attend and review concerts",target:"3+ attended"}}[e]}class O2{static checkVerificationStatus(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("users").select("account_type").eq("user_id",t).single();if(n||!r)throw new Error("User not found");const{data:i,error:a}=yield P.from("user_verifications").select("*").eq("user_id",t).single();if(r.account_type!=="user")return(a||!i)&&(yield P.from("user_verifications").upsert({user_id:t,verified:!0,verification_level:"premium",trust_score:100})),{verified:(i==null?void 0:i.verified)||!0,trustScore:(i==null?void 0:i.trust_score)||100,criteriaMet:8};const{count:o}=yield P.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t),{count:l}=yield P.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`),{count:c}=yield P.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("user_id",t).in("relationship_type",["interested","going","maybe"]),{count:d}=yield P.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("was_there",!0),{data:u,error:h}=yield P.from("users_complete").select("*").eq("user_id",t).single();if(h||!u)throw console.error("Error fetching profile for trust score calculation:",h),new Error("Profile not found for trust score calculation");const f=T7(u,o||0,l||0,c||0,d||0),{error:p}=yield P.from("user_verifications").upsert({user_id:t,trust_score:f.score,verification_criteria_met:f.criteria,verified:f.isVerified,verified_at:f.isVerified&&!(i!=null&&i.verified_at)?new Date().toISOString():i==null?void 0:i.verified_at});return p&&console.error("Error updating verification status:",p),{verified:f.isVerified,trustScore:f.score,criteriaMet:f.criteriaMet}}catch(r){throw console.error("Error checking verification status:",r),r}})}static getTrustScoreBreakdown(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("users_complete").select("*").eq("user_id",t).single();if(n||!r)throw new Error("Profile not found");const{count:i}=yield P.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t),{count:a}=yield P.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`),{count:o}=yield P.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("user_id",t).in("relationship_type",["interested","going","maybe"]),{count:l}=yield P.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("was_there",!0),c=T7(r,i||0,a||0,o||0,l||0);return W(M({},c),{profile:r,friendCount:a||0})}catch(r){throw console.error("Error getting trust score breakdown:",r),r}})}static refreshVerificationStatus(t){return E(this,null,function*(){yield this.checkVerificationStatus(t)})}static manuallyVerifyUser(t,r,n){return E(this,null,function*(){try{const{data:i}=yield P.from("users").select("account_type").eq("user_id",r).single();if((i==null?void 0:i.account_type)!=="admin")throw new Error("Only admins can manually verify users");const{error:a}=yield P.from("user_verifications").upsert({user_id:t,verified:n,verified_by:n?r:null,verified_at:n?new Date().toISOString():null});if(a)throw a}catch(i){throw console.error("Error manually verifying user:",i),i}})}static getUsersNearVerification(t=50){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("users").select(`
          *,
          user_verifications!inner (
            verified,
            trust_score,
            verification_level
          )
        `).eq("account_type","user").eq("user_verifications.verified",!1).gte("user_verifications.trust_score",40).order("user_verifications.trust_score",{ascending:!1}).limit(t);if(n)throw n;return r||[]}catch(r){throw console.error("Error getting users near verification:",r),r}})}}function tae(e){const[t,r]=y.useState(null),[n,i]=y.useState(!0),[a,o]=y.useState(null);return y.useEffect(()=>{if(!e){r(null),i(!1);return}let l=!0;return E(this,null,function*(){try{i(!0);const d=yield O2.getTrustScoreBreakdown(e);if(!l)return;r(d),o(null)}catch(d){if(!l)return;o(d instanceof Error?d.message:"Unknown error")}finally{l&&i(!1)}}),()=>{l=!1}},[e]),{breakdown:t,loading:n,error:a}}function G$({userId:e,accountType:t,verified:r}){const{breakdown:n,loading:i,error:a}=tae(e),[o,l]=y.useState(!1),{toast:c}=jr();if(t!=="user")return r?s.jsxs(He,{children:[s.jsxs(xr,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(oa,{className:"w-5 h-5 text-primary"}),s.jsx(Cr,{children:"Verified Account"})]}),s.jsxs(Hu,{children:["Your ",t," account is verified and trusted by the Synth community."]})]}),s.jsx(st,{children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(Jl,{className:"w-16 h-16 text-green-500"})})})]}):null;const d=()=>E(this,null,function*(){try{l(!0),yield O2.refreshVerificationStatus(e),c({title:"Status Updated",description:"Your verification status has been refreshed."})}catch(h){c({title:"Error",description:"Failed to refresh verification status.",variant:"destructive"})}finally{l(!1)}});if(i)return s.jsxs(He,{children:[s.jsx(xr,{children:s.jsx(Cr,{children:"Verification Status"})}),s.jsx(st,{children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]});if(a||!n)return null;const u=n.criteriaMet/n.totalCriteria*100;return s.jsxs(He,{children:[s.jsx(xr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs(Cr,{className:"flex items-center gap-2",children:["Verification Status",r&&s.jsx(Jl,{className:"w-5 h-5 text-green-500"})]}),s.jsx(Hu,{children:r?"You are a verified member of the Synth community":"Complete criteria to earn verification"})]}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:d,disabled:o,children:s.jsx(Sa,{className:`w-4 h-4 ${o?"animate-spin":""}`})})]})}),s.jsxs(st,{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Trust Score"}),s.jsxs("span",{className:"text-2xl font-bold text-primary",children:[n.score,"%"]})]}),s.jsx(yg,{value:u,className:"h-2"}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.criteriaMet," of ",n.totalCriteria," criteria met",!r&&n.criteriaMet<4&&s.jsxs(s.Fragment,{children:["  ",4-n.criteriaMet," more needed for verification"]})]})]}),r&&s.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Jl,{className:"w-8 h-8 text-green-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-green-900",children:"Verified User"}),s.jsx("p",{className:"text-sm text-green-700",children:"You have earned the trusted user badge"})]})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-semibold text-sm",children:"Verification Criteria"}),Object.entries(n.criteria).map(([h,f])=>{const p=eae(h,n.profile,n.friendCount);return s.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg border ${f?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[s.jsx("div",{className:"flex-shrink-0 mt-0.5",children:f?s.jsx(Jl,{className:"w-5 h-5 text-green-600"}):s.jsx(ZD,{className:"w-5 h-5 text-gray-400"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("h5",{className:"font-medium text-sm",children:p.label}),s.jsx(Be,{variant:f?"default":"secondary",className:"text-xs",children:p.target})]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:p.description})]})]},h)})]}),!r&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-sm text-blue-900 mb-2",children:"Tips to Get Verified"}),s.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[s.jsx("li",{children:" Complete your profile with all information"}),s.jsx("li",{children:" Connect your music streaming account"}),s.jsx("li",{children:" Post reviews for concerts you attend"}),s.jsx("li",{children:" Build your friend network"}),s.jsx("li",{children:" Mark concerts you're interested in"})]})]})]})]})}const Y$=({isOpen:e,onClose:t,onToggle:r,onNavigateToNotifications:n,onNavigateToProfile:i,onNavigateToSettings:a,onNavigateToVerification:o})=>{var _;const{user:l}=os(),{accountInfo:c}=Wu(),[d,u]=y.useState(null),[h,f]=y.useState(!0);y.useEffect(()=>{E(void 0,null,function*(){if(!l){console.log("SideMenu: No user, setting loading to false"),f(!1),u(null);return}try{console.log("SideMenu: Fetching user profile for user.id:",l.id),f(!0);const{data:b,error:N}=yield P.from("users").select("name, username, avatar_url").eq("user_id",l.id).maybeSingle();if(console.log("SideMenu: Query result by user_id:",{data:b,error:N}),N)if(N.code==="PGRST116"){console.log("SideMenu: No user found by user_id, trying by id");const{data:S,error:k}=yield P.from("users").select("name, username, avatar_url").eq("id",l.id).maybeSingle();console.log("SideMenu: Fallback query result by id:",{fallbackData:S,fallbackError:k}),k&&k.code!=="PGRST116"&&console.error("SideMenu: Error in fallback query:",k),S?(console.log("SideMenu: Setting profile from fallback:",S),u(S)):(console.warn("SideMenu: No user profile found in database"),u(null))}else console.error("SideMenu: Error fetching user profile:",N),u(null);else b?(console.log("SideMenu: Setting profile from primary query:",b),u(b)):(console.warn("SideMenu: No data returned from query"),u(null))}catch(b){console.error("SideMenu: Exception in fetchUserProfile:",b),u(null)}finally{f(!1),console.log("SideMenu: Loading set to false")}})},[e,l]);const p=w=>{if(!w)return"?";const b=w.trim();return b.length===0?"?":b[0].toUpperCase()},x=w=>{w.target===w.currentTarget&&t()},g=()=>{t(),r&&r()},v=()=>E(void 0,null,function*(){try{yield P.auth.signOut(),window.location.href="/"}catch(w){console.error("Error signing out:",w)}});return e?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"side-menu__overlay",onClick:x,"aria-hidden":"true"}),s.jsxs("aside",{className:"side-menu__drawer",role:"dialog","aria-modal":"true","aria-label":"Navigation menu",children:[s.jsx("div",{className:"side-menu__safe-area-spacer"}),s.jsx("div",{className:"side-menu__header-bar",children:s.jsx("button",{className:"side-menu__close-button",onClick:g,"aria-label":"Close menu",type:"button",children:s.jsx(Ca,{name:"x",size:24,alt:""})})}),s.jsxs("div",{className:"side-menu__content",children:[s.jsx("div",{className:"side-menu__user-info-section",children:h?s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-[45px] h-[45px] rounded-full bg-gray-200 animate-pulse"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"h-5 w-32 bg-gray-200 rounded animate-pulse mb-2"}),s.jsx("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"})]})]}):s.jsx(Fie,{variant:"user",name:(d==null?void 0:d.name)||((_=l==null?void 0:l.email)==null?void 0:_.split("@")[0])||"User",username:(d==null?void 0:d.username)||void 0,initial:p((d==null?void 0:d.name)||(l==null?void 0:l.email)),imageUrl:(d==null?void 0:d.avatar_url)||void 0})}),s.jsxs("div",{className:"side-menu__list",children:[s.jsx(Gx,{label:"Notifications",icon:"bell",onPress:()=>{n&&n(),t()}}),s.jsx(Gx,{label:"Event Timeline",icon:"music",onPress:()=>{i&&i(void 0,"timeline"),t()}}),s.jsx(Gx,{label:"Interested",icon:"heart",onPress:()=>{i&&i(void 0,"interested"),t()}}),s.jsx(Gx,{label:"Settings",icon:"settings",onPress:()=>{a?a():console.log("Settings clicked"),t()}})]}),l&&c&&s.jsx("div",{className:"side-menu__verification-section",children:s.jsx(G$,{userId:l.id,accountType:c.account_type||"user",verified:c.verified||!1})}),s.jsx("div",{className:"side-menu__logout-section",children:s.jsx(Uie,{variant:"primary",size:"standard",fullWidth:!0,onClick:()=>{v(),t()},children:"Log out"})})]})]})]}):null},O7=({currentView:e,onViewChange:t,onOpenEventReview:r})=>{const n=e==="feed",i=e==="search",a=e==="chat",o=e==="profile",l=[{id:"home",label:"Home",icon:n?"houseSelected":"house",onClick:()=>t("feed"),isActive:n},{id:"discover",label:"Discover",icon:i?"discoverSelected":"discover",onClick:()=>t("search"),isActive:i},{id:"post",label:"Post",icon:"plus",onClick:()=>{r?r():t("search")},isCTA:!0},{id:"messages",label:"Messages",icon:a?"circleCommentSelected":"circleComment",onClick:()=>t("chat"),isActive:a},{id:"profile",label:"Profile",icon:o?"userSelected":"user",onClick:()=>t("profile"),isActive:o}];return s.jsx("nav",{className:"bottom-nav",role:"navigation","aria-label":"Main navigation",children:s.jsx("div",{className:"bottom-nav__container",children:l.map(c=>c.isCTA?s.jsx("button",{className:"bottom-nav__item bottom-nav__item--cta",onClick:c.onClick,"aria-label":c.label,"aria-current":c.isActive?"page":void 0,type:"button",children:s.jsx(Ca,{name:c.icon,size:24,alt:""})},c.id):s.jsx("button",{className:`bottom-nav__item ${c.isActive?"bottom-nav__item--active":""}`,onClick:c.onClick,"aria-label":c.label,"aria-current":c.isActive?"page":void 0,type:"button",children:s.jsx(Ca,{name:c.icon,size:24,alt:""})},c.id))})})},K$=e=>{y.useEffect(()=>{if(e){const t=window.scrollY;return document.body.style.position="fixed",document.body.style.top=`-${t}px`,document.body.style.width="100%",document.body.style.overflow="hidden",()=>{document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,t)}}},[e])};var uj="focusScope.autoFocusOnMount",fj="focusScope.autoFocusOnUnmount",R7={bubbles:!1,cancelable:!0},rae="FocusScope",Sv=y.forwardRef((e,t)=>{const g=e,{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:a}=g,o=me(g,["loop","trapped","onMountAutoFocus","onUnmountAutoFocus"]),[l,c]=y.useState(null),d=ss(i),u=ss(a),h=y.useRef(null),f=sr(t,v=>c(v)),p=y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;y.useEffect(()=>{if(n){let v=function(N){if(p.paused||!l)return;const S=N.target;l.contains(S)?h.current=S:Wc(h.current,{select:!0})},_=function(N){if(p.paused||!l)return;const S=N.relatedTarget;S!==null&&(l.contains(S)||Wc(h.current,{select:!0}))},w=function(N){if(document.activeElement===document.body)for(const k of N)k.removedNodes.length>0&&Wc(l)};document.addEventListener("focusin",v),document.addEventListener("focusout",_);const b=new MutationObserver(w);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",_),b.disconnect()}}},[n,l,p.paused]),y.useEffect(()=>{if(l){D7.add(p);const v=document.activeElement;if(!l.contains(v)){const w=new CustomEvent(uj,R7);l.addEventListener(uj,d),l.dispatchEvent(w),w.defaultPrevented||(nae(lae(Z$(l)),{select:!0}),document.activeElement===v&&Wc(l))}return()=>{l.removeEventListener(uj,d),setTimeout(()=>{const w=new CustomEvent(fj,R7);l.addEventListener(fj,u),l.dispatchEvent(w),w.defaultPrevented||Wc(v!=null?v:document.body,{select:!0}),l.removeEventListener(fj,u),D7.remove(p)},0)}}},[l,d,u,p]);const x=y.useCallback(v=>{if(!r&&!n||p.paused)return;const _=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,w=document.activeElement;if(_&&w){const b=v.currentTarget,[N,S]=sae(b);N&&S?!v.shiftKey&&w===S?(v.preventDefault(),r&&Wc(N,{select:!0})):v.shiftKey&&w===N&&(v.preventDefault(),r&&Wc(S,{select:!0})):w===b&&v.preventDefault()}},[r,n,p.paused]);return s.jsx(Nt.div,W(M({tabIndex:-1},o),{ref:f,onKeyDown:x}))});Sv.displayName=rae;function nae(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Wc(n,{select:t}),document.activeElement!==r)return}function sae(e){const t=Z$(e),r=M7(t,e),n=M7(t.reverse(),e);return[r,n]}function Z$(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function M7(e,t){for(const r of e)if(!iae(r,{upTo:t}))return r}function iae(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function aae(e){return e instanceof HTMLInputElement&&"select"in e}function Wc(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&aae(e)&&t&&e.select()}}var D7=oae();function oae(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=I7(e,t),e.unshift(t)},remove(t){var r;e=I7(e,t),(r=e[0])==null||r.resume()}}}function I7(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function lae(e){return e.filter(t=>t.tagName!=="A")}var hj=0;function Lw(){y.useEffect(()=>{var t,r;const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=e[0])!=null?t:$7()),document.body.insertAdjacentElement("beforeend",(r=e[1])!=null?r:$7()),hj++,()=>{hj===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),hj--}},[])}function $7(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var il=function(){return il=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},il.apply(this,arguments)};function X$(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function cae(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var Fy="right-scroll-bar-position",Uy="width-before-scroll-bar",dae="with-scroll-bars-hidden",uae="--removed-body-scroll-bar-size";function mj(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function fae(e,t){var r=y.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=t,r.facade}var hae=typeof window!="undefined"?y.useLayoutEffect:y.useEffect,L7=new WeakMap;function mae(e,t){var r=fae(null,function(n){return e.forEach(function(i){return mj(i,n)})});return hae(function(){var n=L7.get(r);if(n){var i=new Set(n),a=new Set(e),o=r.current;i.forEach(function(l){a.has(l)||mj(l,null)}),a.forEach(function(l){i.has(l)||mj(l,o)})}L7.set(r,e)},[e]),r}function pae(e){return e}function gae(e,t){t===void 0&&(t=pae);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(a){var o=t(a,n);return r.push(o),function(){r=r.filter(function(l){return l!==o})}},assignSyncMedium:function(a){for(n=!0;r.length;){var o=r;r=[],o.forEach(a)}r={push:function(l){return a(l)},filter:function(){return r}}},assignMedium:function(a){n=!0;var o=[];if(r.length){var l=r;r=[],l.forEach(a),o=r}var c=function(){var u=o;o=[],u.forEach(a)},d=function(){return Promise.resolve().then(c)};d(),r={push:function(u){o.push(u),d()},filter:function(u){return o=o.filter(u),r}}}};return i}function vae(e){e===void 0&&(e={});var t=gae(null);return t.options=il({async:!0,ssr:!1},e),t}var J$=function(e){var t=e.sideCar,r=X$(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return y.createElement(n,il({},r))};J$.isSideCarExport=!0;function xae(e,t){return e.useMedium(t),J$}var Q$=vae(),pj=function(){},Fw=y.forwardRef(function(e,t){var r=y.useRef(null),n=y.useState({onScrollCapture:pj,onWheelCapture:pj,onTouchMoveCapture:pj}),i=n[0],a=n[1],o=e.forwardProps,l=e.children,c=e.className,d=e.removeScrollBar,u=e.enabled,h=e.shards,f=e.sideCar,p=e.noRelative,x=e.noIsolation,g=e.inert,v=e.allowPinchZoom,_=e.as,w=_===void 0?"div":_,b=e.gapMode,N=X$(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=f,k=mae([r,t]),O=il(il({},N),i);return y.createElement(y.Fragment,null,u&&y.createElement(S,{sideCar:Q$,removeScrollBar:d,shards:h,noRelative:p,noIsolation:x,inert:g,setCallbacks:a,allowPinchZoom:!!v,lockRef:r,gapMode:b}),o?y.cloneElement(y.Children.only(l),il(il({},O),{ref:k})):y.createElement(w,il({},O,{className:c,ref:k}),l))});Fw.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Fw.classNames={fullWidth:Uy,zeroRight:Fy};var yae=function(){if(typeof __webpack_nonce__!="undefined")return __webpack_nonce__};function _ae(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=yae();return t&&e.setAttribute("nonce",t),e}function wae(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function bae(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var jae=function(){var e=0,t=null;return{add:function(r){e==0&&(t=_ae())&&(wae(t,r),bae(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Nae=function(){var e=jae();return function(t,r){y.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},eL=function(){var e=Nae(),t=function(r){var n=r.styles,i=r.dynamic;return e(n,i),null};return t},Sae={left:0,top:0,right:0,gap:0},gj=function(e){return parseInt(e||"",10)||0},kae=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[gj(r),gj(n),gj(i)]},Eae=function(e){if(e===void 0&&(e="margin"),typeof window=="undefined")return Sae;var t=kae(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Cae=eL(),Eh="data-scroll-locked",Pae=function(e,t,r,n){var i=e.left,a=e.top,o=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(dae,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(Eh,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Fy,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(Uy,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(Fy," .").concat(Fy,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Uy," .").concat(Uy,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Eh,`] {
    `).concat(uae,": ").concat(l,`px;
  }
`)},F7=function(){var e=parseInt(document.body.getAttribute(Eh)||"0",10);return isFinite(e)?e:0},Aae=function(){y.useEffect(function(){return document.body.setAttribute(Eh,(F7()+1).toString()),function(){var e=F7()-1;e<=0?document.body.removeAttribute(Eh):document.body.setAttribute(Eh,e.toString())}},[])},Tae=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,i=n===void 0?"margin":n;Aae();var a=y.useMemo(function(){return Eae(i)},[i]);return y.createElement(Cae,{styles:Pae(a,!t,i,r?"":"!important")})},H3=!1;if(typeof window!="undefined")try{var Yx=Object.defineProperty({},"passive",{get:function(){return H3=!0,!0}});window.addEventListener("test",Yx,Yx),window.removeEventListener("test",Yx,Yx)}catch(e){H3=!1}var Df=H3?{passive:!1}:!1,Oae=function(e){return e.tagName==="TEXTAREA"},tL=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Oae(e)&&r[t]==="visible")},Rae=function(e){return tL(e,"overflowY")},Mae=function(e){return tL(e,"overflowX")},U7=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot!="undefined"&&n instanceof ShadowRoot&&(n=n.host);var i=rL(e,n);if(i){var a=nL(e,n),o=a[1],l=a[2];if(o>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Dae=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Iae=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},rL=function(e,t){return e==="v"?Rae(t):Mae(t)},nL=function(e,t){return e==="v"?Dae(t):Iae(t)},$ae=function(e,t){return e==="h"&&t==="rtl"?-1:1},Lae=function(e,t,r,n,i){var a=$ae(e,window.getComputedStyle(t).direction),o=a*n,l=r.target,c=t.contains(l),d=!1,u=o>0,h=0,f=0;do{if(!l)break;var p=nL(e,l),x=p[0],g=p[1],v=p[2],_=g-v-a*x;(x||_)&&rL(e,l)&&(h+=_,f+=x);var w=l.parentNode;l=w&&w.nodeType===Node.DOCUMENT_FRAGMENT_NODE?w.host:w}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(u&&(Math.abs(h)<1||!i)||!u&&(Math.abs(f)<1||!i))&&(d=!0),d},Kx=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},B7=function(e){return[e.deltaX,e.deltaY]},z7=function(e){return e&&"current"in e?e.current:e},Fae=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Uae=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Bae=0,If=[];function zae(e){var t=y.useRef([]),r=y.useRef([0,0]),n=y.useRef(),i=y.useState(Bae++)[0],a=y.useState(eL)[0],o=y.useRef(e);y.useEffect(function(){o.current=e},[e]),y.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var g=cae([e.lockRef.current],(e.shards||[]).map(z7),!0).filter(Boolean);return g.forEach(function(v){return v.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),g.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var l=y.useCallback(function(g,v){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var _=Kx(g),w=r.current,b="deltaX"in g?g.deltaX:w[0]-_[0],N="deltaY"in g?g.deltaY:w[1]-_[1],S,k=g.target,O=Math.abs(b)>Math.abs(N)?"h":"v";if("touches"in g&&O==="h"&&k.type==="range")return!1;var A=U7(O,k);if(!A)return!0;if(A?S=O:(S=O==="v"?"h":"v",A=U7(O,k)),!A)return!1;if(!n.current&&"changedTouches"in g&&(b||N)&&(n.current=S),!S)return!0;var T=n.current||S;return Lae(T,v,g,T==="h"?b:N,!0)},[]),c=y.useCallback(function(g){var v=g;if(!(!If.length||If[If.length-1]!==a)){var _="deltaY"in v?B7(v):Kx(v),w=t.current.filter(function(S){return S.name===v.type&&(S.target===v.target||v.target===S.shadowParent)&&Fae(S.delta,_)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var b=(o.current.shards||[]).map(z7).filter(Boolean).filter(function(S){return S.contains(v.target)}),N=b.length>0?l(v,b[0]):!o.current.noIsolation;N&&v.cancelable&&v.preventDefault()}}},[]),d=y.useCallback(function(g,v,_,w){var b={name:g,delta:v,target:_,should:w,shadowParent:Vae(_)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(N){return N!==b})},1)},[]),u=y.useCallback(function(g){r.current=Kx(g),n.current=void 0},[]),h=y.useCallback(function(g){d(g.type,B7(g),g.target,l(g,e.lockRef.current))},[]),f=y.useCallback(function(g){d(g.type,Kx(g),g.target,l(g,e.lockRef.current))},[]);y.useEffect(function(){return If.push(a),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Df),document.addEventListener("touchmove",c,Df),document.addEventListener("touchstart",u,Df),function(){If=If.filter(function(g){return g!==a}),document.removeEventListener("wheel",c,Df),document.removeEventListener("touchmove",c,Df),document.removeEventListener("touchstart",u,Df)}},[]);var p=e.removeScrollBar,x=e.inert;return y.createElement(y.Fragment,null,x?y.createElement(a,{styles:Uae(i)}):null,p?y.createElement(Tae,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function Vae(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const qae=xae(Q$,zae);var kv=y.forwardRef(function(e,t){return y.createElement(Fw,il({},e,{ref:t,sideCar:qae}))});kv.classNames=Fw.classNames;var Wae=function(e){if(typeof document=="undefined")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},$f=new WeakMap,Zx=new WeakMap,Xx={},vj=0,sL=function(e){return e&&(e.host||sL(e.parentNode))},Hae=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=sL(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Gae=function(e,t,r,n){var i=Hae(t,Array.isArray(e)?e:[e]);Xx[r]||(Xx[r]=new WeakMap);var a=Xx[r],o=[],l=new Set,c=new Set(i),d=function(h){!h||l.has(h)||(l.add(h),d(h.parentNode))};i.forEach(d);var u=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(f){if(l.has(f))u(f);else try{var p=f.getAttribute(n),x=p!==null&&p!=="false",g=($f.get(f)||0)+1,v=(a.get(f)||0)+1;$f.set(f,g),a.set(f,v),o.push(f),g===1&&x&&Zx.set(f,!0),v===1&&f.setAttribute(r,"true"),x||f.setAttribute(n,"true")}catch(_){console.error("aria-hidden: cannot operate on ",f,_)}})};return u(t),l.clear(),vj++,function(){o.forEach(function(h){var f=$f.get(h)-1,p=a.get(h)-1;$f.set(h,f),a.set(h,p),f||(Zx.has(h)||h.removeAttribute(n),Zx.delete(h)),p||h.removeAttribute(r)}),vj--,vj||($f=new WeakMap,$f=new WeakMap,Zx=new WeakMap,Xx={})}},Uw=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),i=Wae(e);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live]"))),Gae(n,i,r,"aria-hidden")):function(){return null}},Bw="Dialog",[iL,aL]=js(Bw),[Yae,Lo]=iL(Bw),oL=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:i,onOpenChange:a,modal:o=!0}=e,l=y.useRef(null),c=y.useRef(null),[d,u]=Di({prop:n,defaultProp:i!=null?i:!1,onChange:a,caller:Bw});return s.jsx(Yae,{scope:t,triggerRef:l,contentRef:c,contentId:_s(),titleId:_s(),descriptionId:_s(),open:d,onOpenChange:u,onOpenToggle:y.useCallback(()=>u(h=>!h),[u]),modal:o,children:r})};oL.displayName=Bw;var lL="DialogTrigger",cL=y.forwardRef((e,t)=>{const o=e,{__scopeDialog:r}=o,n=me(o,["__scopeDialog"]),i=Lo(lL,r),a=sr(t,i.triggerRef);return s.jsx(Nt.button,W(M({type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":bE(i.open)},n),{ref:a,onClick:mt(e.onClick,i.onOpenToggle)}))});cL.displayName=lL;var _E="DialogPortal",[Kae,dL]=iL(_E,{forceMount:void 0}),uL=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:i}=e,a=Lo(_E,t);return s.jsx(Kae,{scope:t,forceMount:r,children:y.Children.map(n,o=>s.jsx($s,{present:r||a.open,children:s.jsx(Vm,{asChild:!0,container:i,children:o})}))})};uL.displayName=_E;var R2="DialogOverlay",fL=y.forwardRef((e,t)=>{const r=dL(R2,e.__scopeDialog),o=e,{forceMount:n=r.forceMount}=o,i=me(o,["forceMount"]),a=Lo(R2,e.__scopeDialog);return a.modal?s.jsx($s,{present:n||a.open,children:s.jsx(Xae,W(M({},i),{ref:t}))}):null});fL.displayName=R2;var Zae=Nd("DialogOverlay.RemoveScroll"),Xae=y.forwardRef((e,t)=>{const a=e,{__scopeDialog:r}=a,n=me(a,["__scopeDialog"]),i=Lo(R2,r);return s.jsx(kv,{as:Zae,allowPinchZoom:!0,shards:[i.contentRef],children:s.jsx(Nt.div,W(M({"data-state":bE(i.open)},n),{ref:t,style:M({pointerEvents:"auto"},n.style)}))})}),Gu="DialogContent",hL=y.forwardRef((e,t)=>{const r=dL(Gu,e.__scopeDialog),o=e,{forceMount:n=r.forceMount}=o,i=me(o,["forceMount"]),a=Lo(Gu,e.__scopeDialog);return s.jsx($s,{present:n||a.open,children:a.modal?s.jsx(Jae,W(M({},i),{ref:t})):s.jsx(Qae,W(M({},i),{ref:t}))})});hL.displayName=Gu;var Jae=y.forwardRef((e,t)=>{const r=Lo(Gu,e.__scopeDialog),n=y.useRef(null),i=sr(t,r.contentRef,n);return y.useEffect(()=>{const a=n.current;if(a)return Uw(a)},[]),s.jsx(mL,W(M({},e),{ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:mt(e.onCloseAutoFocus,a=>{var o;a.preventDefault(),(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:mt(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&a.preventDefault()}),onFocusOutside:mt(e.onFocusOutside,a=>a.preventDefault())}))}),Qae=y.forwardRef((e,t)=>{const r=Lo(Gu,e.__scopeDialog),n=y.useRef(!1),i=y.useRef(!1);return s.jsx(mL,W(M({},e),{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,a),a.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),a.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:a=>{var c,d;(c=e.onInteractOutside)==null||c.call(e,a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const o=a.target;((d=r.triggerRef.current)==null?void 0:d.contains(o))&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&i.current&&a.preventDefault()}}))}),mL=y.forwardRef((e,t)=>{const u=e,{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:a}=u,o=me(u,["__scopeDialog","trapFocus","onOpenAutoFocus","onCloseAutoFocus"]),l=Lo(Gu,r),c=y.useRef(null),d=sr(t,c);return Lw(),s.jsxs(s.Fragment,{children:[s.jsx(Sv,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:a,children:s.jsx(of,W(M({role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":bE(l.open)},o),{ref:d,onDismiss:()=>l.onOpenChange(!1)}))}),s.jsxs(s.Fragment,{children:[s.jsx(toe,{titleId:l.titleId}),s.jsx(noe,{contentRef:c,descriptionId:l.descriptionId})]})]})}),wE="DialogTitle",pL=y.forwardRef((e,t)=>{const a=e,{__scopeDialog:r}=a,n=me(a,["__scopeDialog"]),i=Lo(wE,r);return s.jsx(Nt.h2,W(M({id:i.titleId},n),{ref:t}))});pL.displayName=wE;var gL="DialogDescription",vL=y.forwardRef((e,t)=>{const a=e,{__scopeDialog:r}=a,n=me(a,["__scopeDialog"]),i=Lo(gL,r);return s.jsx(Nt.p,W(M({id:i.descriptionId},n),{ref:t}))});vL.displayName=gL;var xL="DialogClose",yL=y.forwardRef((e,t)=>{const a=e,{__scopeDialog:r}=a,n=me(a,["__scopeDialog"]),i=Lo(xL,r);return s.jsx(Nt.button,W(M({type:"button"},n),{ref:t,onClick:mt(e.onClick,()=>i.onOpenChange(!1))}))});yL.displayName=xL;function bE(e){return e?"open":"closed"}var _L="DialogTitleWarning",[eoe,wL]=CX(_L,{contentName:Gu,titleName:wE,docsSlug:"dialog"}),toe=({titleId:e})=>{const t=wL(_L),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return y.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},roe="DialogDescriptionWarning",noe=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${wL(roe).contentName}}.`;return y.useEffect(()=>{var a;const i=(a=e.current)==null?void 0:a.getAttribute("aria-describedby");t&&i&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},zw=oL,soe=cL,Vw=uL,Jm=fL,Qm=hL,Ev=pL,Cv=vL,qw=yL;const tn=zw,ioe=Vw,bL=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(Jm,M({ref:r,className:ke("fixed inset-0 z-[9999] bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e)},t))});bL.displayName=Jm.displayName;const Xr=y.forwardRef((a,i)=>{var o=a,{className:e,children:t,hideCloseButton:r=!1}=o,n=me(o,["className","children","hideCloseButton"]);return s.jsxs(ioe,{children:[s.jsx(bL,{}),s.jsxs(Qm,W(M({ref:i,className:ke("fixed left-[50%] top-[50%] z-[9999] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-4 sm:p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg max-h-[90vh] overflow-hidden",e)},n),{children:[t,!r&&s.jsxs(qw,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[s.jsx(pr,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]}))]})});Xr.displayName=Qm.displayName;const Mn=r=>{var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("flex flex-col space-y-1.5 text-center sm:text-left",e)},t))};Mn.displayName="DialogHeader";const ff=r=>{var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e)},t))};ff.displayName="DialogFooter";const an=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(Ev,M({ref:r,className:ke("text-lg font-semibold leading-none tracking-tight",e)},t))});an.displayName=Ev.displayName;const Kn=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(Cv,M({ref:r,className:ke("text-sm text-muted-foreground",e)},t))});Kn.displayName=Cv.displayName;var jL={exports:{}},NL={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rm=y;function aoe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ooe=typeof Object.is=="function"?Object.is:aoe,loe=rm.useState,coe=rm.useEffect,doe=rm.useLayoutEffect,uoe=rm.useDebugValue;function foe(e,t){var r=t(),n=loe({inst:{value:r,getSnapshot:t}}),i=n[0].inst,a=n[1];return doe(function(){i.value=r,i.getSnapshot=t,xj(i)&&a({inst:i})},[e,r,t]),coe(function(){return xj(i)&&a({inst:i}),e(function(){xj(i)&&a({inst:i})})},[e]),uoe(r),r}function xj(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ooe(e,r)}catch(n){return!0}}function hoe(e,t){return t()}var moe=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?hoe:foe;NL.useSyncExternalStore=rm.useSyncExternalStore!==void 0?rm.useSyncExternalStore:moe;jL.exports=NL;var poe=jL.exports;function goe(){return poe.useSyncExternalStore(voe,()=>!0,()=>!1)}function voe(){return()=>{}}var jE="Avatar",[xoe,bFe]=js(jE),[yoe,SL]=xoe(jE),kL=y.forwardRef((e,t)=>{const o=e,{__scopeAvatar:r}=o,n=me(o,["__scopeAvatar"]),[i,a]=y.useState("idle");return s.jsx(yoe,{scope:r,imageLoadingStatus:i,onImageLoadingStatusChange:a,children:s.jsx(Nt.span,W(M({},n),{ref:t}))})});kL.displayName=jE;var EL="AvatarImage",CL=y.forwardRef((e,t)=>{const d=e,{__scopeAvatar:r,src:n,onLoadingStatusChange:i=()=>{}}=d,a=me(d,["__scopeAvatar","src","onLoadingStatusChange"]),o=SL(EL,r),l=_oe(n,a),c=ss(u=>{i(u),o.onImageLoadingStatusChange(u)});return is(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?s.jsx(Nt.img,W(M({},a),{ref:t,src:n})):null});CL.displayName=EL;var PL="AvatarFallback",AL=y.forwardRef((e,t)=>{const c=e,{__scopeAvatar:r,delayMs:n}=c,i=me(c,["__scopeAvatar","delayMs"]),a=SL(PL,r),[o,l]=y.useState(n===void 0);return y.useEffect(()=>{if(n!==void 0){const d=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(d)}},[n]),o&&a.imageLoadingStatus!=="loaded"?s.jsx(Nt.span,W(M({},i),{ref:t})):null});AL.displayName=PL;function V7(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function _oe(e,{referrerPolicy:t,crossOrigin:r}){const n=goe(),i=y.useRef(null),a=n?(i.current||(i.current=new window.Image),i.current):null,[o,l]=y.useState(()=>V7(a,e));return is(()=>{l(V7(a,e))},[a,e]),is(()=>{const c=h=>()=>{l(h)};if(!a)return;const d=c("loaded"),u=c("error");return a.addEventListener("load",d),a.addEventListener("error",u),t&&(a.referrerPolicy=t),typeof r=="string"&&(a.crossOrigin=r),()=>{a.removeEventListener("load",d),a.removeEventListener("error",u)}},[a,r,t]),o}var TL=kL,OL=CL,RL=AL;const Vr=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(TL,M({ref:r,className:ke("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e)},t))});Vr.displayName=TL.displayName;const Qr=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(OL,M({ref:r,className:ke("aspect-square h-full w-full",e)},t))});Qr.displayName=OL.displayName;const qr=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(RL,M({ref:r,className:ke("flex h-full w-full items-center justify-center rounded-full bg-muted",e)},t))});qr.displayName=RL.displayName;var woe=y.createContext(void 0);function hf(e){const t=y.useContext(woe);return e||t||"ltr"}var yj="rovingFocusGroup.onEntryFocus",boe={bubbles:!1,cancelable:!0},Pv="RovingFocusGroup",[G3,ML,joe]=zm(Pv),[Noe,Ww]=js(Pv,[joe]),[Soe,koe]=Noe(Pv),DL=y.forwardRef((e,t)=>s.jsx(G3.Provider,{scope:e.__scopeRovingFocusGroup,children:s.jsx(G3.Slot,{scope:e.__scopeRovingFocusGroup,children:s.jsx(Eoe,W(M({},e),{ref:t}))})}));DL.displayName=Pv;var Eoe=y.forwardRef((e,t)=>{const A=e,{__scopeRovingFocusGroup:r,orientation:n,loop:i=!1,dir:a,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1}=A,h=me(A,["__scopeRovingFocusGroup","orientation","loop","dir","currentTabStopId","defaultCurrentTabStopId","onCurrentTabStopIdChange","onEntryFocus","preventScrollOnEntryFocus"]),f=y.useRef(null),p=sr(t,f),x=hf(a),[g,v]=Di({prop:o,defaultProp:l!=null?l:null,onChange:c,caller:Pv}),[_,w]=y.useState(!1),b=ss(d),N=ML(r),S=y.useRef(!1),[k,O]=y.useState(0);return y.useEffect(()=>{const T=f.current;if(T)return T.addEventListener(yj,b),()=>T.removeEventListener(yj,b)},[b]),s.jsx(Soe,{scope:r,orientation:n,dir:x,loop:i,currentTabStopId:g,onItemFocus:y.useCallback(T=>v(T),[v]),onItemShiftTab:y.useCallback(()=>w(!0),[]),onFocusableItemAdd:y.useCallback(()=>O(T=>T+1),[]),onFocusableItemRemove:y.useCallback(()=>O(T=>T-1),[]),children:s.jsx(Nt.div,W(M({tabIndex:_||k===0?-1:0,"data-orientation":n},h),{ref:p,style:M({outline:"none"},e.style),onMouseDown:mt(e.onMouseDown,()=>{S.current=!0}),onFocus:mt(e.onFocus,T=>{const $=!S.current;if(T.target===T.currentTarget&&$&&!_){const R=new CustomEvent(yj,boe);if(T.currentTarget.dispatchEvent(R),!R.defaultPrevented){const F=N().filter(Y=>Y.focusable),D=F.find(Y=>Y.active),B=F.find(Y=>Y.id===g),V=[D,B,...F].filter(Boolean).map(Y=>Y.ref.current);LL(V,u)}}S.current=!1}),onBlur:mt(e.onBlur,()=>w(!1))}))})}),IL="RovingFocusGroupItem",$L=y.forwardRef((e,t)=>{const v=e,{__scopeRovingFocusGroup:r,focusable:n=!0,active:i=!1,tabStopId:a,children:o}=v,l=me(v,["__scopeRovingFocusGroup","focusable","active","tabStopId","children"]),c=_s(),d=a||c,u=koe(IL,r),h=u.currentTabStopId===d,f=ML(r),{onFocusableItemAdd:p,onFocusableItemRemove:x,currentTabStopId:g}=u;return y.useEffect(()=>{if(n)return p(),()=>x()},[n,p,x]),s.jsx(G3.ItemSlot,{scope:r,id:d,focusable:n,active:i,children:s.jsx(Nt.span,W(M({tabIndex:h?0:-1,"data-orientation":u.orientation},l),{ref:t,onMouseDown:mt(e.onMouseDown,_=>{n?u.onItemFocus(d):_.preventDefault()}),onFocus:mt(e.onFocus,()=>u.onItemFocus(d)),onKeyDown:mt(e.onKeyDown,_=>{if(_.key==="Tab"&&_.shiftKey){u.onItemShiftTab();return}if(_.target!==_.currentTarget)return;const w=Aoe(_,u.orientation,u.dir);if(w!==void 0){if(_.metaKey||_.ctrlKey||_.altKey||_.shiftKey)return;_.preventDefault();let N=f().filter(S=>S.focusable).map(S=>S.ref.current);if(w==="last")N.reverse();else if(w==="prev"||w==="next"){w==="prev"&&N.reverse();const S=N.indexOf(_.currentTarget);N=u.loop?Toe(N,S+1):N.slice(S+1)}setTimeout(()=>LL(N))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:g!=null}):o}))})});$L.displayName=IL;var Coe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Poe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Aoe(e,t,r){const n=Poe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Coe[n]}function LL(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function Toe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var FL=DL,UL=$L,Hw="Tabs",[Ooe,jFe]=js(Hw,[Ww]),BL=Ww(),[Roe,NE]=Ooe(Hw),zL=y.forwardRef((e,t)=>{const p=e,{__scopeTabs:r,value:n,onValueChange:i,defaultValue:a,orientation:o="horizontal",dir:l,activationMode:c="automatic"}=p,d=me(p,["__scopeTabs","value","onValueChange","defaultValue","orientation","dir","activationMode"]),u=hf(l),[h,f]=Di({prop:n,onChange:i,defaultProp:a!=null?a:"",caller:Hw});return s.jsx(Roe,{scope:r,baseId:_s(),value:h,onValueChange:f,orientation:o,dir:u,activationMode:c,children:s.jsx(Nt.div,W(M({dir:u,"data-orientation":o},d),{ref:t}))})});zL.displayName=Hw;var VL="TabsList",qL=y.forwardRef((e,t)=>{const l=e,{__scopeTabs:r,loop:n=!0}=l,i=me(l,["__scopeTabs","loop"]),a=NE(VL,r),o=BL(r);return s.jsx(FL,W(M({asChild:!0},o),{orientation:a.orientation,dir:a.dir,loop:n,children:s.jsx(Nt.div,W(M({role:"tablist","aria-orientation":a.orientation},i),{ref:t}))}))});qL.displayName=VL;var WL="TabsTrigger",HL=y.forwardRef((e,t)=>{const h=e,{__scopeTabs:r,value:n,disabled:i=!1}=h,a=me(h,["__scopeTabs","value","disabled"]),o=NE(WL,r),l=BL(r),c=KL(o.baseId,n),d=ZL(o.baseId,n),u=n===o.value;return s.jsx(UL,W(M({asChild:!0},l),{focusable:!i,active:u,children:s.jsx(Nt.button,W(M({type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:c},a),{ref:t,onMouseDown:mt(e.onMouseDown,f=>{!i&&f.button===0&&f.ctrlKey===!1?o.onValueChange(n):f.preventDefault()}),onKeyDown:mt(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&o.onValueChange(n)}),onFocus:mt(e.onFocus,()=>{const f=o.activationMode!=="manual";!u&&!i&&f&&o.onValueChange(n)})}))}))});HL.displayName=WL;var GL="TabsContent",YL=y.forwardRef((e,t)=>{const f=e,{__scopeTabs:r,value:n,forceMount:i,children:a}=f,o=me(f,["__scopeTabs","value","forceMount","children"]),l=NE(GL,r),c=KL(l.baseId,n),d=ZL(l.baseId,n),u=n===l.value,h=y.useRef(u);return y.useEffect(()=>{const p=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(p)},[]),s.jsx($s,{present:i||u,children:({present:p})=>s.jsx(Nt.div,W(M({"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!p,id:d,tabIndex:0},o),{ref:t,style:W(M({},e.style),{animationDuration:h.current?"0s":void 0}),children:p&&a}))})});YL.displayName=GL;function KL(e,t){return`${e}-trigger-${t}`}function ZL(e,t){return`${e}-content-${t}`}var Moe=zL,XL=qL,JL=HL,QL=YL;const Cl=Moe,Fo=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(XL,M({ref:r,className:ke("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e)},t))});Fo.displayName=XL.displayName;const Tn=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(JL,M({ref:r,className:ke("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e)},t))});Tn.displayName=JL.displayName;const On=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(QL,M({ref:r,className:ke("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e)},t))});On.displayName=QL.displayName;const M2=({size:e="md",className:t})=>{const r={sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16",xl:"w-24 h-24"};return s.jsx("div",{className:ke("inline-block",r[e],t),children:s.jsx("img",{src:"/Logos/Main logo black background.png",alt:"Synth Logo",className:"w-full h-full object-contain"})})};function _j(){return s.jsxs("div",{className:"synth-card relative w-full max-w-sm mx-auto overflow-hidden shadow-lg border border-white/20",role:"status","aria-label":"Loading content","aria-busy":"true",children:[s.jsxs("div",{className:"relative h-72 bg-gradient-to-br from-pink-50 via-white to-pink-100 animate-pulse",children:[s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx(M2,{size:"lg",className:"opacity-40 animate-breathe animate-float"})}),s.jsx("div",{className:"absolute top-4 left-4",children:s.jsx("div",{className:"w-20 h-6 bg-pink-200 animate-pulse rounded-full"})}),s.jsx("div",{className:"absolute top-4 right-4",children:s.jsx("div",{className:"w-16 h-6 bg-gradient-to-r from-pink-300 to-pink-400 animate-pulse rounded-full"})})]}),s.jsxs("div",{className:"p-6 space-y-5 bg-white",children:[s.jsxs("div",{children:[s.jsx("div",{className:"h-7 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-4/5 mb-3"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-50 to-white rounded animate-pulse w-3/4"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-50 to-white rounded animate-pulse w-1/2 mt-1"})]}),s.jsxs("div",{className:"space-y-3 bg-gradient-to-r from-pink-50/50 to-white rounded-xl p-4 border border-pink-100/50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 bg-pink-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-32"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 bg-pink-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-24"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 bg-pink-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-20"})]})]}),s.jsxs("div",{className:"flex gap-4 pt-2",children:[s.jsx("div",{className:"flex-1 h-14 bg-gradient-to-r from-gray-100 to-white rounded-lg animate-pulse border border-pink-100"}),s.jsx("div",{className:"flex-1 h-14 bg-gradient-to-r from-pink-200 to-pink-300 rounded-lg animate-pulse"})]})]}),s.jsx("span",{className:"sr-only",children:"Loading event details..."})]})}function eF({promotionTier:e,className:t=""}){const n=(a=>({icon:zu,text:"Promoted",className:"bg-gradient-to-r from-yellow-100 to-amber-100 text-yellow-800 border-yellow-300 hover:from-yellow-200 hover:to-amber-200 shadow-lg shadow-yellow-200/50",iconClassName:"text-yellow-600"}))(),i=n.icon;return s.jsxs(Be,{variant:"secondary",className:`flex items-center gap-1 text-xs font-medium ${n.className} ${t}`,children:[s.jsx(i,{className:`w-3 h-3 ${n.iconClassName}`}),n.text]})}const Doe=({icon:e,title:t,description:r,action:n})=>s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6 text-center",children:[e&&s.jsx("div",{className:"mb-6 text-gray-300",children:e}),s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2 text-balance",children:t}),s.jsx("p",{className:"text-gray-600 mb-6 max-w-md text-pretty leading-relaxed",children:r}),n&&s.jsx("button",{onClick:n.onClick,className:"px-6 py-3 bg-[#FF3399] text-white rounded-lg font-medium hover:bg-[#E6007A] transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#FF3399] focus:ring-offset-2","aria-label":n.label,children:n.label})]});class q7{static getAvailableCities(t=1,r=1e3){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("city_centers").select("*").limit(r);return i?(console.warn(" city_centers table not available or has different structure, using events table:",i.message),yield this.getCitiesFromEvents(t,r)):!n||n.length===0?yield this.getCitiesFromEvents(t,r):n.map(a=>{const o=a.city_name||a.name||a.normalized_name||"";return{name:o,city_name:o,normalized_name:o,state:a.state||null,center_latitude:a.center_latitude?Number(a.center_latitude):a.latitude?Number(a.latitude):void 0,center_longitude:a.center_longitude?Number(a.center_longitude):a.longitude?Number(a.longitude):void 0,event_count:a.event_count||a.upcoming_events_count||0,aliases:[]}})}catch(n){return console.error("Error in getAvailableCities:",n),[]}})}static getCitiesFromEvents(t=1,r=1e3){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("events").select("venue_city, venue_state").not("venue_city","is",null).gte("event_date",new Date().toISOString());if(i)return console.error("Error fetching cities from events:",i),[];const a=new Map;return(n||[]).forEach(l=>{const c=l.venue_city?`${l.venue_city}${l.venue_state?`, ${l.venue_state}`:""}`:null;c&&a.set(c,(a.get(c)||0)+1)}),Array.from(a.entries()).filter(([l,c])=>c>=t).sort(([l,c],[d,u])=>u-c).slice(0,r).map(([l,c])=>l)}catch(n){return console.error("Error in getCitiesFromEvents:",n),[]}})}}function gr(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function ca(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function qs(e,t){const r=gr(e);return isNaN(t)?ca(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Io(e,t){const r=gr(e);if(isNaN(t))return ca(e,NaN);if(!t)return r;const n=r.getDate(),i=ca(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const a=i.getDate();return n>=a?i:(r.setFullYear(i.getFullYear(),i.getMonth(),n),r)}const SE=6048e5,Ioe=864e5,tF=6e4,rF=36e5,Jx=43200,W7=1440;let $oe={};function ep(){return $oe}function Nl(e,t){var l,c,d,u,h,f,p,x;const r=ep(),n=(x=(p=(u=(d=t==null?void 0:t.weekStartsOn)!=null?d:(c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)!=null?u:r.weekStartsOn)!=null?p:(f=(h=r.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)!=null?x:0,i=gr(e),a=i.getDay(),o=(a<n?7:0)+a-n;return i.setDate(i.getDate()-o),i.setHours(0,0,0,0),i}function Yu(e){return Nl(e,{weekStartsOn:1})}function nF(e){const t=gr(e),r=t.getFullYear(),n=ca(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=Yu(n),a=ca(e,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=Yu(a);return t.getTime()>=i.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function nm(e){const t=gr(e);return t.setHours(0,0,0,0),t}function sm(e){const t=gr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function cl(e,t){const r=nm(e),n=nm(t),i=+r-sm(r),a=+n-sm(n);return Math.round((i-a)/Ioe)}function Loe(e){const t=nF(e),r=ca(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Yu(r)}function Y3(e,t){const r=t*7;return qs(e,r)}function Foe(e,t){return Io(e,t*12)}function Uoe(e){let t;return e.forEach(function(r){const n=gr(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function Boe(e){let t;return e.forEach(r=>{const n=gr(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function By(e,t){const r=gr(e),n=gr(t),i=r.getTime()-n.getTime();return i<0?-1:i>0?1:i}function zoe(e){return ca(e,Date.now())}function ea(e,t){const r=nm(e),n=nm(t);return+r==+n}function kE(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Voe(e){if(!kE(e)&&typeof e!="number")return!1;const t=gr(e);return!isNaN(Number(t))}function im(e,t){const r=gr(e),n=gr(t),i=r.getFullYear()-n.getFullYear(),a=r.getMonth()-n.getMonth();return i*12+a}function qoe(e,t,r){const n=Nl(e,r),i=Nl(t,r),a=+n-sm(n),o=+i-sm(i);return Math.round((a-o)/SE)}function Woe(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function Hoe(e,t){return+gr(e)-+gr(t)}function Goe(e){const t=gr(e);return t.setHours(23,59,59,999),t}function Gw(e){const t=gr(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Yoe(e){const t=gr(e);return+Goe(t)==+Gw(t)}function Koe(e,t){const r=gr(e),n=gr(t),i=By(r,n),a=Math.abs(im(r,n));let o;if(a<1)o=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-i*a);let l=By(r,n)===-i;Yoe(gr(e))&&a===1&&By(e,n)===1&&(l=!1),o=i*(a-Number(l))}return o===0?0:o}function Zoe(e,t,r){const n=Hoe(e,t)/1e3;return Woe(r==null?void 0:r.roundingMethod)(n)}function la(e){const t=gr(e);return t.setDate(1),t.setHours(0,0,0,0),t}function sF(e){const t=gr(e),r=ca(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function EE(e,t){var l,c,d,u,h,f,p,x;const r=ep(),n=(x=(p=(u=(d=t==null?void 0:t.weekStartsOn)!=null?d:(c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)!=null?u:r.weekStartsOn)!=null?p:(f=(h=r.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)!=null?x:0,i=gr(e),a=i.getDay(),o=(a<n?-7:0)+6-(a-n);return i.setDate(i.getDate()+o),i.setHours(23,59,59,999),i}function iF(e){return EE(e,{weekStartsOn:1})}const Xoe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Joe=(e,t,r)=>{let n;const i=Xoe[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function wj(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Qoe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ele={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},tle={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},rle={date:wj({formats:Qoe,defaultWidth:"full"}),time:wj({formats:ele,defaultWidth:"full"}),dateTime:wj({formats:tle,defaultWidth:"full"})},nle={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},sle=(e,t,r,n)=>nle[e];function Vp(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;i=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[l]||e.values[o]}const a=e.argumentCallback?e.argumentCallback(t):t;return i[a]}}const ile={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ale={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},ole={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},lle={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},cle={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},dle={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ule=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},fle={ordinalNumber:ule,era:Vp({values:ile,defaultWidth:"wide"}),quarter:Vp({values:ale,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Vp({values:ole,defaultWidth:"wide"}),day:Vp({values:lle,defaultWidth:"wide"}),dayPeriod:Vp({values:cle,defaultWidth:"wide",formattingValues:dle,defaultFormattingWidth:"wide"})};function qp(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],a=t.match(i);if(!a)return null;const o=a[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?mle(l,h=>h.test(o)):hle(l,h=>h.test(o));let d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const u=t.slice(o.length);return{value:d,rest:u}}}function hle(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function mle(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function ple(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const i=n[0],a=t.match(e.parsePattern);if(!a)return null;let o=e.valueCallback?e.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(i.length);return{value:o,rest:l}}}const gle=/^(\d+)(th|st|nd|rd)?/i,vle=/\d+/i,xle={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},yle={any:[/^b/i,/^(a|c)/i]},_le={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},wle={any:[/1/i,/2/i,/3/i,/4/i]},ble={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},jle={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Nle={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Sle={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},kle={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Ele={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Cle={ordinalNumber:ple({matchPattern:gle,parsePattern:vle,valueCallback:e=>parseInt(e,10)}),era:qp({matchPatterns:xle,defaultMatchWidth:"wide",parsePatterns:yle,defaultParseWidth:"any"}),quarter:qp({matchPatterns:_le,defaultMatchWidth:"wide",parsePatterns:wle,defaultParseWidth:"any",valueCallback:e=>e+1}),month:qp({matchPatterns:ble,defaultMatchWidth:"wide",parsePatterns:jle,defaultParseWidth:"any"}),day:qp({matchPatterns:Nle,defaultMatchWidth:"wide",parsePatterns:Sle,defaultParseWidth:"any"}),dayPeriod:qp({matchPatterns:kle,defaultMatchWidth:"any",parsePatterns:Ele,defaultParseWidth:"any"})},CE={code:"en-US",formatDistance:Joe,formatLong:rle,formatRelative:sle,localize:fle,match:Cle,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Ple(e){const t=gr(e);return cl(t,sF(t))+1}function aF(e){const t=gr(e),r=+Yu(t)-+Loe(t);return Math.round(r/SE)+1}function oF(e,t){var u,h,f,p,x,g,v,_;const r=gr(e),n=r.getFullYear(),i=ep(),a=(_=(v=(p=(f=t==null?void 0:t.firstWeekContainsDate)!=null?f:(h=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)!=null?p:i.firstWeekContainsDate)!=null?v:(g=(x=i.locale)==null?void 0:x.options)==null?void 0:g.firstWeekContainsDate)!=null?_:1,o=ca(e,0);o.setFullYear(n+1,0,a),o.setHours(0,0,0,0);const l=Nl(o,t),c=ca(e,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const d=Nl(c,t);return r.getTime()>=l.getTime()?n+1:r.getTime()>=d.getTime()?n:n-1}function Ale(e,t){var l,c,d,u,h,f,p,x;const r=ep(),n=(x=(p=(u=(d=t==null?void 0:t.firstWeekContainsDate)!=null?d:(c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)!=null?u:r.firstWeekContainsDate)!=null?p:(f=(h=r.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)!=null?x:1,i=oF(e,t),a=ca(e,0);return a.setFullYear(i,0,n),a.setHours(0,0,0,0),Nl(a,t)}function lF(e,t){const r=gr(e),n=+Nl(r,t)-+Ale(r,t);return Math.round(n/SE)+1}function mn(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const zc={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return mn(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):mn(r+1,2)},d(e,t){return mn(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return mn(e.getHours()%12||12,t.length)},H(e,t){return mn(e.getHours(),t.length)},m(e,t){return mn(e.getMinutes(),t.length)},s(e,t){return mn(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return mn(i,t.length)}},Lf={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},H7={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return zc.y(e,t)},Y:function(e,t,r,n){const i=oF(e,n),a=i>0?i:1-i;if(t==="YY"){const o=a%100;return mn(o,2)}return t==="Yo"?r.ordinalNumber(a,{unit:"year"}):mn(a,t.length)},R:function(e,t){const r=nF(e);return mn(r,t.length)},u:function(e,t){const r=e.getFullYear();return mn(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return mn(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return mn(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return zc.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return mn(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const i=lF(e,n);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):mn(i,t.length)},I:function(e,t,r){const n=aF(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):mn(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):zc.d(e,t)},D:function(e,t,r){const n=Ple(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):mn(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const i=e.getDay(),a=(i-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return mn(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const i=e.getDay(),a=(i-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return mn(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),i=n===0?7:n;switch(t){case"i":return String(i);case"ii":return mn(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let i;switch(n===12?i=Lf.noon:n===0?i=Lf.midnight:i=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let i;switch(n>=17?i=Lf.evening:n>=12?i=Lf.afternoon:n>=4?i=Lf.morning:i=Lf.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return zc.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):zc.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):mn(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):mn(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):zc.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):zc.s(e,t)},S:function(e,t){return zc.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Y7(n);case"XXXX":case"XX":return eu(n);case"XXXXX":case"XXX":default:return eu(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Y7(n);case"xxxx":case"xx":return eu(n);case"xxxxx":case"xxx":default:return eu(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+G7(n,":");case"OOOO":default:return"GMT"+eu(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+G7(n,":");case"zzzz":default:return"GMT"+eu(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return mn(n,t.length)},T:function(e,t,r){const n=e.getTime();return mn(n,t.length)}};function G7(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.trunc(n/60),a=n%60;return a===0?r+String(i):r+String(i)+t+mn(a,2)}function Y7(e,t){return e%60===0?(e>0?"-":"+")+mn(Math.abs(e)/60,2):eu(e,t)}function eu(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=mn(Math.trunc(n/60),2),a=mn(n%60,2);return r+i+t+a}const K7=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},cF=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Tle=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return K7(e,t);let a;switch(n){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",K7(n,t)).replace("{{time}}",cF(i,t))},Ole={p:cF,P:Tle},Rle=/^D+$/,Mle=/^Y+$/,Dle=["D","DD","YY","YYYY"];function Ile(e){return Rle.test(e)}function $le(e){return Mle.test(e)}function Lle(e,t,r){const n=Fle(e,t,r);if(console.warn(n),Dle.includes(e))throw new RangeError(n)}function Fle(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Ule=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ble=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,zle=/^'([^]*?)'?$/,Vle=/''/g,qle=/[a-zA-Z]/;function Dt(e,t,r){var u,h,f,p,x,g,v,_,w,b,N,S,k,O,A,T,$,R;const n=ep(),i=(h=(u=r==null?void 0:r.locale)!=null?u:n.locale)!=null?h:CE,a=(b=(w=(g=(x=r==null?void 0:r.firstWeekContainsDate)!=null?x:(p=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)!=null?g:n.firstWeekContainsDate)!=null?w:(_=(v=n.locale)==null?void 0:v.options)==null?void 0:_.firstWeekContainsDate)!=null?b:1,o=(R=($=(O=(k=r==null?void 0:r.weekStartsOn)!=null?k:(S=(N=r==null?void 0:r.locale)==null?void 0:N.options)==null?void 0:S.weekStartsOn)!=null?O:n.weekStartsOn)!=null?$:(T=(A=n.locale)==null?void 0:A.options)==null?void 0:T.weekStartsOn)!=null?R:0,l=gr(e);if(!Voe(l))throw new RangeError("Invalid time value");let c=t.match(Ble).map(F=>{const D=F[0];if(D==="p"||D==="P"){const B=Ole[D];return B(F,i.formatLong)}return F}).join("").match(Ule).map(F=>{if(F==="''")return{isToken:!1,value:"'"};const D=F[0];if(D==="'")return{isToken:!1,value:Wle(F)};if(H7[D])return{isToken:!0,value:F};if(D.match(qle))throw new RangeError("Format string contains an unescaped latin alphabet character `"+D+"`");return{isToken:!1,value:F}});i.localize.preprocessor&&(c=i.localize.preprocessor(l,c));const d={firstWeekContainsDate:a,weekStartsOn:o,locale:i};return c.map(F=>{if(!F.isToken)return F.value;const D=F.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&$le(D)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Ile(D))&&Lle(D,t,String(e));const B=H7[D[0]];return B(l,D,i.localize,d)}).join("")}function Wle(e){const t=e.match(zle);return t?t[1].replace(Vle,"'"):e}function Hle(e,t,r){var x,g;const n=ep(),i=(g=(x=r==null?void 0:r.locale)!=null?x:n.locale)!=null?g:CE,a=2520,o=By(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o});let c,d;o>0?(c=gr(t),d=gr(e)):(c=gr(e),d=gr(t));const u=Zoe(d,c),h=(sm(d)-sm(c))/1e3,f=Math.round((u-h)/60);let p;if(f<2)return r!=null&&r.includeSeconds?u<5?i.formatDistance("lessThanXSeconds",5,l):u<10?i.formatDistance("lessThanXSeconds",10,l):u<20?i.formatDistance("lessThanXSeconds",20,l):u<40?i.formatDistance("halfAMinute",0,l):u<60?i.formatDistance("lessThanXMinutes",1,l):i.formatDistance("xMinutes",1,l):f===0?i.formatDistance("lessThanXMinutes",1,l):i.formatDistance("xMinutes",f,l);if(f<45)return i.formatDistance("xMinutes",f,l);if(f<90)return i.formatDistance("aboutXHours",1,l);if(f<W7){const v=Math.round(f/60);return i.formatDistance("aboutXHours",v,l)}else{if(f<a)return i.formatDistance("xDays",1,l);if(f<Jx){const v=Math.round(f/W7);return i.formatDistance("xDays",v,l)}else if(f<Jx*2)return p=Math.round(f/Jx),i.formatDistance("aboutXMonths",p,l)}if(p=Koe(d,c),p<12){const v=Math.round(f/Jx);return i.formatDistance("xMonths",v,l)}else{const v=p%12,_=Math.trunc(p/12);return v<3?i.formatDistance("aboutXYears",_,l):v<9?i.formatDistance("overXYears",_,l):i.formatDistance("almostXYears",_+1,l)}}function D2(e,t){return Hle(e,zoe(e),t)}function Gle(e){const t=gr(e),r=t.getFullYear(),n=t.getMonth(),i=ca(e,0);return i.setFullYear(r,n+1,0),i.setHours(0,0,0,0),i.getDate()}function Yle(e){return Math.trunc(+gr(e)/1e3)}function Kle(e){const t=gr(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function Zle(e,t){return qoe(Kle(e),la(e),t)+1}function K3(e,t){const r=gr(e),n=gr(t);return r.getTime()>n.getTime()}function dF(e,t){const r=gr(e),n=gr(t);return+r<+n}function PE(e,t){const r=gr(e),n=gr(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function Xle(e,t){const r=gr(e),n=gr(t);return r.getFullYear()===n.getFullYear()}function bj(e,t){return qs(e,-t)}function Ws(e,t){const n=tce(e);let i;if(n.date){const c=rce(n.date,2);i=nce(c.restDateString,c.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);const a=i.getTime();let o=0,l;if(n.time&&(o=sce(n.time),isNaN(o)))return new Date(NaN);if(n.timezone){if(l=ice(n.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(a+o),d=new Date(0);return d.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),d.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),d}return new Date(a+o+l)}const Qx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Jle=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Qle=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,ece=/^([+-])(\d{2})(?::?(\d{2}))?$/;function tce(e){const t={},r=e.split(Qx.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],Qx.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Qx.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const i=Qx.timezone.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}function rce(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const i=n[1]?parseInt(n[1]):null,a=n[2]?parseInt(n[2]):null;return{year:a===null?i:a*100,restDateString:e.slice((n[1]||n[2]).length)}}function nce(e,t){if(t===null)return new Date(NaN);const r=e.match(Jle);if(!r)return new Date(NaN);const n=!!r[4],i=Wp(r[1]),a=Wp(r[2])-1,o=Wp(r[3]),l=Wp(r[4]),c=Wp(r[5])-1;if(n)return dce(t,l,c)?ace(t,l,c):new Date(NaN);{const d=new Date(0);return!lce(t,a,o)||!cce(t,i)?new Date(NaN):(d.setUTCFullYear(t,a,Math.max(i,o)),d)}}function Wp(e){return e?parseInt(e):1}function sce(e){const t=e.match(Qle);if(!t)return NaN;const r=jj(t[1]),n=jj(t[2]),i=jj(t[3]);return uce(r,n,i)?r*rF+n*tF+i*1e3:NaN}function jj(e){return e&&parseFloat(e.replace(",","."))||0}function ice(e){if(e==="Z")return 0;const t=e.match(ece);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return fce(n,i)?r*(n*rF+i*tF):NaN}function ace(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const i=n.getUTCDay()||7,a=(t-1)*7+r+1-i;return n.setUTCDate(n.getUTCDate()+a),n}const oce=[31,null,31,30,31,30,31,31,30,31,30,31];function uF(e){return e%400===0||e%4===0&&e%100!==0}function lce(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(oce[t]||(uF(e)?29:28))}function cce(e,t){return t>=1&&t<=(uF(e)?366:365)}function dce(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function uce(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function fce(e,t){return t>=0&&t<=59}function Nj(e,t){const r=gr(e),n=r.getFullYear(),i=r.getDate(),a=ca(e,0);a.setFullYear(n,t,15),a.setHours(0,0,0,0);const o=Gle(a);return r.setMonth(t,Math.min(i,o)),r}function Z7(e,t){const r=gr(e);return isNaN(+r)?ca(e,NaN):(r.setFullYear(t),r)}function AE(e){return E(this,null,function*(){try{const{data:t,error:r}=yield P.rpc("get_user_chats",{user_id:e});return r?(console.error("Error fetching user chats:",r),{data:null,error:r}):{data:t,error:null}}catch(t){return console.error("Error in fetchUserChats:",t),{data:null,error:t}}})}class Kf{static getNotifications(){return E(this,arguments,function*(t={}){try{const{data:{user:r}}=yield P.auth.getUser();if(!r)throw new Error("User not authenticated");const n=!t.offset&&!t.type&&t.is_read===void 0,i=n?`notifications_${r.id}_${t.limit||50}`:null;if(n&&i){const a=Eo.get(i);if(a)return a}try{let a=P.from("notifications_with_details").select("*",{count:"exact"}).eq("user_id",r.id).order("created_at",{ascending:!1});t.type&&(a=a.eq("type",t.type)),t.is_read!==void 0&&(a=a.eq("is_read",t.is_read));const o=t.limit||20,l=t.offset||0,c=Math.ceil(o*1.5);a=a.range(l,l+c-1);const{data:d,error:u,count:h}=yield a;if(u){const f=u.code||(u==null?void 0:u.statusCode)||(u==null?void 0:u.status),p=(u.message||String(u)||"").toLowerCase(),x=((u==null?void 0:u.details)||"").toLowerCase(),g=((u==null?void 0:u.hint)||"").toLowerCase();if(f==="PGRST205"||f==="42P01"||f===404||f==="404"||String(f)==="404"||(p==null?void 0:p.includes("notifications_with_details"))||(p==null?void 0:p.includes("does not exist"))||(p==null?void 0:p.includes("relation"))||(p==null?void 0:p.includes("not found"))||(p==null?void 0:p.includes("404"))||(x==null?void 0:x.includes("notifications_with_details"))||(g==null?void 0:g.includes("notifications_with_details"))||(u==null?void 0:u.status)===404||(u==null?void 0:u.statusCode)===404)return yield this.getNotificationsWithManualJoin(t);throw u}if(d!=null){const f=(d||[]).filter(w=>{var b;return w.type==="friend_request"&&((b=w.data)==null?void 0:b.request_id)});let p=new Set;if(f.length>0)try{const w=f.map(b=>b.data.request_id).filter(Boolean);if(w.length>0){const{data:b}=yield P.from("user_relationships").select("id").in("id",w).eq("relationship_type","friend").neq("status","pending");b&&(p=new Set(b.map(N=>N.id)))}}catch(w){}const _={notifications:(d||[]).map(w=>{var b;if(w.type==="friend_request"&&((b=w.data)!=null&&b.request_id)){const N=w.data.request_id;if(p.has(N))return null}return w}).filter(w=>w!==null).slice(0,o),total:h||0};return n&&i&&Eo.set(i,_,vg.NOTIFICATIONS),_}else return yield this.getNotificationsWithManualJoin(t)}catch(a){const o=(a==null?void 0:a.message)||String(a)||"",l=(a==null?void 0:a.code)||(a==null?void 0:a.statusCode)||(a==null?void 0:a.status);if(l==="PGRST205"||l==="42P01"||l===404||o!=null&&o.includes("notifications_with_details")||o!=null&&o.includes("does not exist")||o!=null&&o.includes("Not Found")||o!=null&&o.includes("404"))return yield this.getNotificationsWithManualJoin(t);throw a}}catch(r){throw console.error("Error fetching notifications:",r),new Error(`Failed to get notifications: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getNotificationsWithManualJoin(){return E(this,arguments,function*(t={}){const{data:{user:r}}=yield P.auth.getUser();if(!r)throw new Error("User not authenticated");let n=P.from("notifications").select("*",{count:"exact"}).eq("user_id",r.id).order("created_at",{ascending:!1});t.type&&(n=n.eq("type",t.type)),t.is_read!==void 0&&(n=n.eq("is_read",t.is_read));const i=t.limit||20,a=t.offset||0,o=Math.ceil(i*1.5);n=n.range(a,a+o-1);const{data:l,error:c,count:d}=yield n;if(c)throw c;if(!l||l.length===0)return{notifications:[],total:d||0};const u=l.filter(v=>{var _;return v.type==="friend_request"&&((_=v.data)==null?void 0:_.request_id)});let h=new Set;if(u.length>0)try{const v=u.map(_=>_.data.request_id).filter(Boolean);if(v.length>0){const{data:_}=yield P.from("user_relationships").select("id").in("id",v).eq("relationship_type","friend").neq("status","pending");_&&(h=new Set(_.map(w=>w.id)))}}catch(v){}const x=l.map(v=>{var _;if(v.type==="friend_request"&&((_=v.data)!=null&&_.request_id)){const w=v.data.request_id;if(h.has(w))return null}return v}).filter(v=>v!==null).slice(0,i);return x.length===0?{notifications:[],total:d||0}:{notifications:yield Promise.all(x.map(v=>E(this,null,function*(){const _=M({},v);if(v.actor_user_id)try{let w=null;const{data:b,error:N}=yield P.from("users").select("name, avatar_url").eq("user_id",v.actor_user_id).single();if(!N&&b)w=b;else{const{data:S,error:k}=yield P.from("profiles").select("name, avatar_url").eq("user_id",v.actor_user_id).single();!k&&S&&(w=S)}w&&(_.actor_name=w.name,_.actor_avatar=w.avatar_url)}catch(w){console.log("Could not fetch actor profile:",w)}if(v.review_id){const{data:w}=yield P.from("user_reviews").select("review_text, rating, event_id").eq("id",v.review_id).single();if(w&&(_.review_text=w.review_text,_.rating=w.rating,w.event_id)){const{data:b}=yield P.from("jambase_events").select("title, artist_name, venue_name").eq("id",w.event_id).single();b&&(_.event_title=b.title,_.artist_name=b.artist_name,_.venue_name=b.venue_name)}}return _}))),total:d||0}})}static enrichNotification(t){return E(this,null,function*(){const r=M({},t);if(t.actor_user_id)try{let n=null;const{data:i,error:a}=yield P.from("users").select("name, avatar_url").eq("user_id",t.actor_user_id).single();if(!a&&i)n=i;else{const{data:o,error:l}=yield P.from("profiles").select("name, avatar_url").eq("user_id",t.actor_user_id).single();!l&&o&&(n=o)}n&&(r.actor_name=n.name,r.actor_avatar=n.avatar_url)}catch(n){console.log("Could not fetch actor profile:",n)}if(t.review_id){const{data:n}=yield P.from("user_reviews").select("review_text, rating, event_id").eq("id",t.review_id).single();if(n&&(r.review_text=n.review_text,r.rating=n.rating,n.event_id)){const{data:i}=yield P.from("jambase_events").select("title, artist_name, venue_name").eq("id",n.event_id).single();i&&(r.event_title=i.title,r.artist_name=i.artist_name,r.venue_name=i.venue_name)}}return r})}static getUnreadNotifications(){return E(this,null,function*(){return(yield this.getNotifications({is_read:!1,limit:50})).notifications})}static getNotificationStats(){return E(this,null,function*(){var t;try{const{data:r,error:n}=yield P.from("notifications").select("type, is_read").eq("user_id",(t=(yield P.auth.getUser()).data.user)==null?void 0:t.id);if(n)throw n;const i={total:(r==null?void 0:r.length)||0,unread:(r==null?void 0:r.filter(a=>!a.is_read).length)||0,by_type:{friend_request:0,friend_accepted:0,match:0,message:0,review_liked:0,review_commented:0,comment_replied:0,event_interest:0,event_attendance_reminder:0,artist_followed:0,artist_new_event:0,artist_profile_updated:0,venue_new_event:0,venue_profile_updated:0,event_share:0,friend_rsvp_going:0,friend_rsvp_changed:0,friend_review_posted:0,friend_attended_same_event:0,event_reminder:0,group_chat_invite:0,trending_in_network:0,mutual_attendance:0,flag_reviewed:0,user_warned:0,user_restricted:0,user_suspended:0}};return r==null||r.forEach(a=>{i.by_type[a.type]++}),i}catch(r){throw console.error("Error fetching notification stats:",r),new Error(`Failed to get notification stats: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getUnreadCount(){return E(this,null,function*(){try{const{data:{user:t}}=yield P.auth.getUser();if(!t)return console.log("No user found, returning 0 unread count"),0;const r=`unread_count_${t.id}`,n=Eo.get(r);if(n!==null)return n;const{data:i,error:a}=yield P.from("notifications").select("id, type, data, is_read").eq("user_id",t.id).eq("is_read",!1);if(a)return console.error("Error fetching notifications for unread count:",a),0;if(!i||i.length===0)return 0;const o=i.filter(u=>{var h;return u.type==="friend_request"&&((h=u.data)==null?void 0:h.request_id)});let l=new Set;if(o.length>0)try{const u=o.map(h=>h.data.request_id).filter(Boolean);if(u.length>0){const{data:h}=yield P.from("user_relationships").select("id").in("id",u).eq("relationship_type","friend").neq("status","pending");h&&(l=new Set(h.map(f=>f.id)))}}catch(u){}const d=i.filter(u=>{var h;if(u.type==="friend_request"&&((h=u.data)!=null&&h.request_id)){const f=u.data.request_id;return!l.has(f)}return!0}).length;return Eo.set(r,d,vg.NOTIFICATIONS),d}catch(t){return console.error("Error fetching unread count:",t),0}})}static markAsRead(t){return E(this,null,function*(){var r,n;try{const{error:i}=yield P.rpc("mark_notification_read",{notification_id:t});if(i){if(i.code==="PGRST202"||(r=i.message)!=null&&r.includes("Could not find the function")){console.log("Notification function not found, falling back to direct update");const{error:a}=yield P.from("notifications").update({is_read:!0}).eq("id",t).eq("user_id",(n=(yield P.auth.getUser()).data.user)==null?void 0:n.id);if(a)throw a;return}throw i}}catch(i){throw console.error("Error marking notification as read:",i),new Error(`Failed to mark notification as read: ${i instanceof Error?i.message:"Unknown error"}`)}})}static markAllAsRead(){return E(this,null,function*(){var t,r;try{const{error:n}=yield P.rpc("mark_all_notifications_read");if(n){if(n.code==="PGRST202"||(t=n.message)!=null&&t.includes("Could not find the function")){console.log("Notification function not found, falling back to direct update");const{error:i}=yield P.from("notifications").update({is_read:!0}).eq("user_id",(r=(yield P.auth.getUser()).data.user)==null?void 0:r.id).eq("is_read",!1);if(i)throw i;return}throw n}}catch(n){throw console.error("Error marking all notifications as read:",n),new Error(`Failed to mark all notifications as read: ${n instanceof Error?n.message:"Unknown error"}`)}})}static subscribeToNotifications(t,r,n){return E(this,null,function*(){const{data:{user:i}}=yield P.auth.getUser();if(!i)return console.error("Cannot subscribe to notifications: User not authenticated"),null;const a=i.id;return P.channel("notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${a}`},l=>E(this,null,function*(){try{let c=null;const{data:d,error:u}=yield P.from("notifications_with_details").select("*").eq("id",l.new.id).single();if(u){const h=u.code||(u==null?void 0:u.statusCode)||(u==null?void 0:u.status),f=(u.message||String(u)||"").toLowerCase();h==="PGRST205"||h==="42P01"||h===404||h==="404"||String(h)==="404"||(u==null?void 0:u.status)===404||(u==null?void 0:u.statusCode)===404||(f==null?void 0:f.includes("notifications_with_details"))||(f==null?void 0:f.includes("does not exist"))||(f==null?void 0:f.includes("not found"))||(f==null?void 0:f.includes("404"))||console.warn("Unexpected error fetching from notifications_with_details view:",u)}else d&&(c=d);if(!c){const{data:h}=yield P.from("notifications").select("*").eq("id",l.new.id).single();h&&(c=yield this.enrichNotification(h))}c&&t(c)}catch(c){console.error("Error fetching new notification details:",c)}})).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notifications",filter:`user_id=eq.${a}`},l=>E(this,null,function*(){try{let c=null;const{data:d,error:u}=yield P.from("notifications_with_details").select("*").eq("id",l.new.id).single();if(u){const h=u.code||(u==null?void 0:u.statusCode)||(u==null?void 0:u.status),f=(u.message||String(u)||"").toLowerCase();h==="PGRST205"||h==="42P01"||h===404||h==="404"||String(h)==="404"||(u==null?void 0:u.status)===404||(u==null?void 0:u.statusCode)===404||(f==null?void 0:f.includes("notifications_with_details"))||(f==null?void 0:f.includes("does not exist"))||(f==null?void 0:f.includes("not found"))||(f==null?void 0:f.includes("404"))||console.warn("Unexpected error fetching from notifications_with_details view:",u)}else d&&(c=d);if(!c){const{data:h}=yield P.from("notifications").select("*").eq("id",l.new.id).single();h&&(c=yield this.enrichNotification(h))}c&&r(c)}catch(c){console.error("Error fetching updated notification details:",c)}})).on("postgres_changes",{event:"DELETE",schema:"public",table:"notifications",filter:`user_id=eq.${a}`},l=>{n(l.old.id)}).subscribe()})}static unsubscribeFromNotifications(t){t&&P.removeChannel(t)}static getNotificationIcon(t){switch(t){case"friend_request":return"";case"friend_accepted":return"";case"review_liked":return"";case"review_commented":return"";case"comment_replied":return"";case"match":return"";case"message":return"";case"event_interest":return"";case"event_attendance_reminder":return"";case"artist_followed":return"";case"artist_new_event":return"";case"artist_profile_updated":return"";case"venue_new_event":return"";case"venue_profile_updated":return"";default:return""}}static getNotificationColor(t){switch(t){case"friend_request":return"bg-blue-100 text-blue-800 border-blue-200";case"friend_accepted":return"bg-green-100 text-green-800 border-green-200";case"review_liked":return"bg-red-100 text-red-800 border-red-200";case"review_commented":return"bg-purple-100 text-purple-800 border-purple-200";case"comment_replied":return"bg-orange-100 text-orange-800 border-orange-200";case"match":return"bg-pink-100 text-pink-800 border-pink-200";case"message":return"bg-indigo-100 text-indigo-800 border-indigo-200";case"event_interest":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"event_attendance_reminder":return"bg-teal-100 text-teal-800 border-teal-200";case"artist_followed":return"bg-purple-100 text-purple-800 border-purple-200";case"artist_new_event":return"bg-pink-100 text-pink-800 border-pink-200";case"artist_profile_updated":return"bg-indigo-100 text-indigo-800 border-indigo-200";case"venue_new_event":return"bg-blue-100 text-blue-800 border-blue-200";case"venue_profile_updated":return"bg-cyan-100 text-cyan-800 border-cyan-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}}static formatNotificationTime(t){const r=new Date,n=new Date(t),i=Math.floor((r.getTime()-n.getTime())/(1e3*60));return i<1?"Just now":i<60?`${i}m ago`:i<1440?`${Math.floor(i/60)}h ago`:`${Math.floor(i/1440)}d ago`}static handleAttendanceReminderAction(t,r,n){return E(this,null,function*(){try{const{data:{user:i}}=yield P.auth.getUser();if(!i)throw new Error("User not authenticated");const{UserEventService:a}=yield on(()=>E(this,null,function*(){const{UserEventService:o}=yield Promise.resolve().then(()=>rue);return{UserEventService:o}}),void 0,import.meta.url);yield a.markUserAttendance(i.id,r,n),yield this.markAsRead(t),console.log(` Attendance marked for event ${r}: ${n?"attended":"did not attend"}`)}catch(i){throw console.error("Error handling attendance reminder action:",i),new Error(`Failed to mark attendance: ${i instanceof Error?i.message:"Unknown error"}`)}})}static requiresAction(t){return["friend_request","event_attendance_reminder"].includes(t)}static getNotificationActions(t){switch(t){case"friend_request":return[{label:"Accept",action:"accept",variant:"success"},{label:"Decline",action:"decline",variant:"secondary"}];case"event_attendance_reminder":return[{label:"Yes, I attended",action:"attended",variant:"primary"},{label:"No, I didn't go",action:"not_attended",variant:"secondary"},{label:"Dismiss",action:"dismiss",variant:"secondary"}];default:return[]}}}function hce({onClick:e,className:t}){const[r,n]=y.useState(0),[i,a]=y.useState(!0);return y.useEffect(()=>{let o=null;const l=()=>E(this,null,function*(){try{const d=yield Kf.getUnreadCount();console.log(" NotificationBell: Unread count loaded:",d),n(d)}catch(d){console.error("Error loading unread count:",d)}finally{a(!1)}}),c=()=>E(this,null,function*(){try{const{data:{user:d},error:u}=yield P.auth.getUser();if(u||!d){console.error("Error getting user for notification subscription:",u),a(!1);return}o=P.channel("notification-bell").on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`user_id=eq.${d.id}`},h=>{console.log(" NotificationBell: Notification change detected:",h.eventType),l()}).subscribe(h=>{h==="SUBSCRIBED"?console.log(" NotificationBell: Successfully subscribed to notifications"):h==="CHANNEL_ERROR"&&console.error(" NotificationBell: Channel subscription error")})}catch(d){console.error("Error setting up notification subscription:",d),a(!1)}});return l(),c(),()=>{o&&P.removeChannel(o)}},[]),i?s.jsx(oe,{variant:"outline",size:"icon",className:ke("relative",t),disabled:!0,children:s.jsx(Uu,{className:"h-5 w-5"})}):s.jsxs(oe,{variant:"outline",size:"icon",className:ke("relative",t),onClick:e,"aria-label":"Notifications",children:[s.jsx(Uu,{className:"h-5 w-5"}),r>0&&s.jsx(Be,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 rounded-full p-0 flex items-center justify-center text-xs",children:r>99?"99+":r})]})}const mce=({currentUserId:e,onNavigateToNotifications:t,onNavigateToChat:r,className:n})=>{const[i,a]=y.useState(!1);return y.useEffect(()=>{let o=!1;const l=()=>E(void 0,null,function*(){try{const{data:d,error:u}=yield AE(e);if(u||o||!d)return;const{data:h}=yield P.from("chat_participants").select("chat_id, last_read_at").eq("user_id",e),f=new Map;h==null||h.forEach(p=>{f.set(p.chat_id,p.last_read_at)});for(const p of d){if(o)break;const x=f.get(p.id),g=P.from("messages").select("id").eq("chat_id",p.id).neq("sender_id",e).limit(1);x&&g.gt("created_at",x);const{data:v}=yield g.maybeSingle();if(v){o||a(!0);return}}o||a(!1)}catch(d){console.error("Error loading unread status:",d)}});l();const c=P.channel("page-actions-unread").on("postgres_changes",{event:"*",schema:"public",table:"messages"},l).subscribe();return()=>{o=!0,P.removeChannel(c)}},[e]),s.jsxs("div",{className:ke("flex items-center gap-2",n),children:[s.jsx(hce,{onClick:t,className:"h-10 w-10 rounded-full border-2 hover:bg-synth-pink/10 hover:border-synth-pink/50 transition-colors"}),s.jsxs(oe,{variant:"outline",size:"icon",className:"h-10 w-10 rounded-full border-2 hover:bg-synth-pink/10 hover:border-synth-pink/50 transition-colors relative",onClick:()=>r==null?void 0:r(e),"aria-label":"Open chat",children:[s.jsx(Wn,{className:"h-5 w-5"}),i&&s.jsx("span",{className:"absolute -top-1 -right-1 bg-synth-pink rounded-full h-3 w-3 shadow-lg shadow-synth-pink/30 animate-pulse"})]})]})},pce=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,ey=e=>typeof e=="string"&&pce.test(e);class fs{static setEventReview(t,r,n,i,a){return E(this,null,function*(){var o,l,c,d,u,h,f,p,x,g,v,_,w,b,N,S,k,O;try{let A;if(n.Event_date&&(n.Event_date instanceof Date?A=n.Event_date.toISOString().split("T")[0]:typeof n.Event_date=="string"&&(A=n.Event_date)),!A&&r&&ey(r))try{const{data:z}=yield P.from("events").select("event_date").eq("id",r).maybeSingle();z!=null&&z.event_date&&(A=new Date(z.event_date).toISOString().split("T")[0])}catch(z){console.warn(" ReviewService: Could not fetch event date:",z)}const T=z=>{const K=X=>Math.max(.5,Math.min(5,X));if(typeof z.rating=="number"&&!Number.isNaN(z.rating))return Number(K(z.rating).toFixed(1));const Z=[z.artist_performance_rating,z.production_rating,z.venue_rating,z.location_rating,z.value_rating].filter(X=>typeof X=="number"&&X>0);if(Z.length>0){const X=Z.reduce((te,se)=>te+se,0)/Z.length;return Number(K(X).toFixed(1))}const G=[z.artist_rating].filter(X=>typeof X=="number"&&X>0);return G.length>0?K(Math.round(G[0])):3},$=r?ey(r):!1,R=ey(i)?i:void 0,F=ey(a)?a:void 0;if(i&&!R&&console.warn(" ReviewService: Received non-UUID venueId parameter, ignoring",i),a&&!F&&console.warn(" ReviewService: Received non-UUID artistId parameter, ignoring",a),!$&&(!F||!R))throw new Error("Either eventId or both artistId and venueId must be provided");let D=null,B=null;if($){const z=yield P.from("reviews").select("id, is_draft").eq("user_id",t).eq("event_id",r).eq("is_draft",!1).maybeSingle(),K=yield P.from("reviews").select("id, is_draft").eq("user_id",t).eq("event_id",r).eq("is_draft",!0).maybeSingle(),Z=z.data,G=K.data;if(console.log(" ReviewService: Checked for existing reviews by event_id:",{published:!!Z,published_id:Z==null?void 0:Z.id,draft:!!G,draft_id:G==null?void 0:G.id}),Z){if(D=Z,B=z.error,G){console.log(" ReviewService: Found both published review and draft - deleting draft:",G.id);try{const{error:X}=yield P.from("reviews").delete().eq("id",G.id);X?console.warn(" Failed to delete draft:",X):console.log(" Deleted draft:",G.id)}catch(X){console.warn(" Error deleting draft:",X)}}}else G?(D=G,B=K.error):(D=null,B=null)}else if(F&&R){const z=yield P.from("reviews").select("id, is_draft").eq("user_id",t).eq("artist_id",F).eq("venue_id",R).is("event_id",null).eq("is_draft",!1).maybeSingle(),K=yield P.from("reviews").select("id, is_draft").eq("user_id",t).eq("artist_id",F).eq("venue_id",R).is("event_id",null).eq("is_draft",!0).maybeSingle(),Z=z.data,G=K.data;if(console.log(" ReviewService: Checked for existing reviews by artist_id + venue_id:",{published:!!Z,published_id:Z==null?void 0:Z.id,draft:!!G,draft_id:G==null?void 0:G.id}),Z){if(D=Z,B=z.error,G){console.log(" ReviewService: Found both published review and draft - deleting draft:",G.id);try{const{error:X}=yield P.from("reviews").delete().eq("id",G.id);X?console.warn(" Failed to delete draft:",X):console.log(" Deleted draft:",G.id)}catch(X){console.warn(" Error deleting draft:",X)}}}else G?(D=G,B=K.error):(D=null,B=null)}if(B&&B.code!=="PGRST116"&&B.status!==406)throw B;if(D){if(D.is_draft===!0){console.log(" ReviewService: Existing review is a draft - deleting it completely before creating published review:",D.id);try{const{error:K}=yield P.from("reviews").delete().eq("user_id",t).eq("event_id",r).eq("is_draft",!0);if(K)throw console.error(" Failed to delete draft before creating published review:",K),K;console.log(" Deleted draft completely - will create fresh published review"),D=null}catch(K){throw console.error(" Exception deleting draft:",K),K}}else if(console.log(" ReviewService: Existing review is already published - updating it:",D.id),$)try{let K=P.from("reviews").delete().eq("user_id",t).eq("is_draft",!0);$&&r?K=K.eq("event_id",r):F&&R&&(K=K.eq("artist_id",F).eq("venue_id",R).is("event_id",null));const{error:Z}=yield K;Z?console.warn(" Error deleting drafts before update:",Z):console.log(" Deleted all drafts before updating published review")}catch(K){console.warn(" Exception deleting drafts before update:",K)}if(D){console.log(" ReviewService: Updating existing published review:",D.id);const{data:K}=yield P.from("reviews").select("setlist, custom_setlist").eq("id",D.id).maybeSingle(),Z=W(M(W(M(M({},R?{venue_id:R}:{}),F?{artist_id:F}:{}),{review_text:n.review_text,is_public:n.is_public,is_draft:!1,draft_data:null,last_saved_at:null}),A?{Event_date:A}:{}),{artist_performance_rating:typeof n.artist_performance_rating=="number"&&!isNaN(n.artist_performance_rating)&&n.artist_performance_rating>0?Number(Math.max(.5,Math.min(5,n.artist_performance_rating)).toFixed(1)):void 0,production_rating:typeof n.production_rating=="number"&&!isNaN(n.production_rating)&&n.production_rating>0?Number(Math.max(.5,Math.min(5,n.production_rating)).toFixed(1)):void 0,venue_rating:typeof n.venue_rating=="number"&&!isNaN(n.venue_rating)&&n.venue_rating>0?Number(Math.max(.5,Math.min(5,n.venue_rating)).toFixed(1)):void 0,location_rating:typeof n.location_rating=="number"&&!isNaN(n.location_rating)&&n.location_rating>0?Number(Math.max(.5,Math.min(5,n.location_rating)).toFixed(1)):void 0,value_rating:typeof n.value_rating=="number"&&!isNaN(n.value_rating)&&n.value_rating>0?Number(Math.max(.5,Math.min(5,n.value_rating)).toFixed(1)):void 0,artist_performance_feedback:((o=n.artist_performance_feedback)==null?void 0:o.trim())||void 0,production_feedback:((l=n.production_feedback)==null?void 0:l.trim())||void 0,venue_feedback:((c=n.venue_feedback)==null?void 0:c.trim())||void 0,location_feedback:((d=n.location_feedback)==null?void 0:d.trim())||void 0,value_feedback:((u=n.value_feedback)==null?void 0:u.trim())||void 0,ticket_price_paid:n.ticket_price_paid,artist_rating:n.artist_rating,review_type:n.review_type,venue_tags:n.venue_tags,artist_tags:n.artist_tags,photos:n.photos,setlist:n.setlist!==void 0?n.setlist:(K==null?void 0:K.setlist)||null,custom_setlist:n.custom_setlist!==void 0?n.custom_setlist:(K==null?void 0:K.custom_setlist)||null,attendees:n.attendees,met_on_synth:n.met_on_synth,was_there:!0,updated_at:new Date().toISOString()});console.log(" ReviewService: Update payload category ratings:",{artist_performance_rating:Z.artist_performance_rating,production_rating:Z.production_rating,venue_rating:Z.venue_rating,location_rating:Z.location_rating,value_rating:Z.value_rating}),console.log(" ReviewService: Update payload category feedback:",{artist_performance_feedback:Z.artist_performance_feedback,production_feedback:Z.production_feedback,venue_feedback:Z.venue_feedback,location_feedback:Z.location_feedback,value_feedback:Z.value_feedback});let{error:G}=yield P.from("reviews").update(Z).eq("id",D.id),X=null;if(!G){const te=yield P.from("reviews").select("*").eq("id",D.id).maybeSingle();X=te.data,G=te.error,console.log(" ReviewService: Updated review category ratings:",{artist_performance_rating:X==null?void 0:X.artist_performance_rating,production_rating:X==null?void 0:X.production_rating,venue_rating:X==null?void 0:X.venue_rating,location_rating:X==null?void 0:X.location_rating,value_rating:X==null?void 0:X.value_rating}),console.log(" ReviewService: Updated review category feedback:",{artist_performance_feedback:X==null?void 0:X.artist_performance_feedback,production_feedback:X==null?void 0:X.production_feedback,venue_feedback:X==null?void 0:X.venue_feedback,location_feedback:X==null?void 0:X.location_feedback,value_feedback:X==null?void 0:X.value_feedback})}if(G){const te=W(M({},R?{venue_id:R}:{}),{rating:typeof n.rating=="number"?Number(n.rating.toFixed(1)):T(n),review_text:n.review_text,is_public:n.is_public,is_draft:!1,draft_data:null,last_saved_at:null,photos:n.photos,was_there:!0,updated_at:new Date().toISOString()}),se=yield P.from("reviews").update(te).eq("id",D.id).select().single();X=se.data,G=se.error}if(G)throw G;if($&&X)try{const te=yield P.from("reviews").select("id, is_draft").eq("id",X.id).maybeSingle();te.data&&te.data.is_draft===!0&&(console.warn(" ReviewService: Draft flag still true after update, forcing is_draft = false"),yield P.from("reviews").update({is_draft:!1,draft_data:null,last_saved_at:null}).eq("id",X.id));let se=P.from("reviews").delete().eq("user_id",t).eq("is_draft",!0);$&&r?se=se.eq("event_id",r):F&&R&&(se=se.eq("artist_id",F).eq("venue_id",R).is("event_id",null));const ue=yield se;if(ue.error)console.warn(" ReviewService: Failed to delete drafts after update:",ue.error);else{const ye=((h=ue.data)==null?void 0:h.length)||0;ye>0?console.log(` Deleted ${ye} draft review(s) after submitting review for event:`,r):console.log(" ReviewService: No drafts found to delete (review is now published)");let ne=P.from("reviews").select("id, is_draft").eq("user_id",t).eq("is_draft",!0);$&&r?ne=ne.eq("event_id",r):F&&R&&(ne=ne.eq("artist_id",F).eq("venue_id",R).is("event_id",null));const xe=yield ne;xe.data&&xe.data.length>0?console.warn(` ReviewService: WARNING - ${xe.data.length} draft(s) still exist after cleanup for event:`,r):console.log(" ReviewService: Verified - no drafts remain for this event")}}catch(te){console.warn(" ReviewService: Error during draft cleanup after update:",te)}return X}}const U=W(M(W(M(M(M({user_id:t},$&&r?{event_id:r}:{}),R?{venue_id:R}:{}),F?{artist_id:F}:{}),{reaction_emoji:n.reaction_emoji,review_text:n.review_text,is_public:(f=n.is_public)!=null?f:!0,is_draft:!1}),A?{Event_date:A}:{}),{artist_performance_rating:typeof n.artist_performance_rating=="number"&&!isNaN(n.artist_performance_rating)&&n.artist_performance_rating>0?Number(Math.max(.5,Math.min(5,n.artist_performance_rating)).toFixed(1)):void 0,production_rating:typeof n.production_rating=="number"&&!isNaN(n.production_rating)&&n.production_rating>0?Number(Math.max(.5,Math.min(5,n.production_rating)).toFixed(1)):void 0,venue_rating:typeof n.venue_rating=="number"&&!isNaN(n.venue_rating)&&n.venue_rating>0?Number(Math.max(.5,Math.min(5,n.venue_rating)).toFixed(1)):void 0,location_rating:typeof n.location_rating=="number"&&!isNaN(n.location_rating)&&n.location_rating>0?Number(Math.max(.5,Math.min(5,n.location_rating)).toFixed(1)):void 0,value_rating:typeof n.value_rating=="number"&&!isNaN(n.value_rating)&&n.value_rating>0?Number(Math.max(.5,Math.min(5,n.value_rating)).toFixed(1)):void 0,artist_performance_feedback:((p=n.artist_performance_feedback)==null?void 0:p.trim())||void 0,production_feedback:((x=n.production_feedback)==null?void 0:x.trim())||void 0,venue_feedback:((g=n.venue_feedback)==null?void 0:g.trim())||void 0,location_feedback:((v=n.location_feedback)==null?void 0:v.trim())||void 0,value_feedback:((_=n.value_feedback)==null?void 0:_.trim())||void 0,ticket_price_paid:n.ticket_price_paid,artist_rating:n.artist_rating,review_type:n.review_type,venue_tags:n.venue_tags,artist_tags:n.artist_tags,photos:n.photos,setlist:n.setlist||null,attendees:n.attendees,met_on_synth:n.met_on_synth,was_there:!0});if(console.log(" ReviewService: Insert payload category ratings:",{artist_performance_rating:U.artist_performance_rating,production_rating:U.production_rating,venue_rating:U.venue_rating,location_rating:U.location_rating,value_rating:U.value_rating}),console.log(" ReviewService: Insert payload category feedback:",{artist_performance_feedback:U.artist_performance_feedback,production_feedback:U.production_feedback,venue_feedback:U.venue_feedback,location_feedback:U.location_feedback,value_feedback:U.value_feedback}),$&&r){console.log(" ReviewService: Checking event JamBase IDs for eventId:",r);const{data:z,error:K}=yield P.from("events_with_artist_venue").select("id, artist_id, artist_name_normalized, venue_id, venue_name_normalized").eq("id",r).single();if(K)console.error(" ReviewService: Error fetching event data:",K);else{console.log(" ReviewService: Event data:",z);const Z=z==null?void 0:z.artist_id;Z&&!F?(console.log(" ReviewService: Using JamBase artist_id from event:",Z),U.artist_id=Z):F?(console.log(" ReviewService: Using provided artistId parameter:",F),U.artist_id=F):console.log(" ReviewService: No artist_id found for event"),R?(console.log(" ReviewService: Using venueId parameter:",R),U.venue_id=R):i?console.warn(" ReviewService: Ignoring non-UUID venueId parameter",i):console.log(" ReviewService: No venueId parameter provided")}}else F&&(console.log(" ReviewService: Using provided artistId (no event):",F),U.artist_id=F),R&&(console.log(" ReviewService: Using provided venueId (no event):",R),U.venue_id=R);console.log(" ReviewService: Final insert payload:",W(M({},U),{category_ratings:{artist_performance_rating:U.artist_performance_rating,production_rating:U.production_rating,venue_rating:U.venue_rating,location_rating:U.location_rating,value_rating:U.value_rating},category_feedback:{artist_performance_feedback:U.artist_performance_feedback,production_feedback:U.production_feedback,venue_feedback:U.venue_feedback,location_feedback:U.location_feedback,value_feedback:U.value_feedback}}));let{data:V,error:Y}=yield P.from("reviews").insert(U).select().maybeSingle();if(Y){const z=Y;if((z==null?void 0:z.code)==="23505"||/duplicate key/i.test((z==null?void 0:z.message)||"")){const K=yield P.from("reviews").update(U).eq("user_id",t).eq("event_id",r).select().maybeSingle();V=K.data,Y=K.error}}if(Y){const z=W(M(W(M({user_id:t,event_id:r},R?{venue_id:R}:{}),{review_text:n.review_text,is_public:(w=n.is_public)!=null?w:!0,is_draft:!1}),A?{Event_date:A}:{}),{artist_performance_rating:typeof n.artist_performance_rating=="number"&&!isNaN(n.artist_performance_rating)&&n.artist_performance_rating>0?Number(Math.max(.5,Math.min(5,n.artist_performance_rating)).toFixed(1)):void 0,production_rating:typeof n.production_rating=="number"&&!isNaN(n.production_rating)&&n.production_rating>0?Number(Math.max(.5,Math.min(5,n.production_rating)).toFixed(1)):void 0,venue_rating:typeof n.venue_rating=="number"&&!isNaN(n.venue_rating)&&n.venue_rating>0?Number(Math.max(.5,Math.min(5,n.venue_rating)).toFixed(1)):void 0,location_rating:typeof n.location_rating=="number"&&!isNaN(n.location_rating)&&n.location_rating>0?Number(Math.max(.5,Math.min(5,n.location_rating)).toFixed(1)):void 0,value_rating:typeof n.value_rating=="number"&&!isNaN(n.value_rating)&&n.value_rating>0?Number(Math.max(.5,Math.min(5,n.value_rating)).toFixed(1)):void 0,artist_performance_feedback:((b=n.artist_performance_feedback)==null?void 0:b.trim())||void 0,production_feedback:((N=n.production_feedback)==null?void 0:N.trim())||void 0,venue_feedback:((S=n.venue_feedback)==null?void 0:S.trim())||void 0,location_feedback:((k=n.location_feedback)==null?void 0:k.trim())||void 0,value_feedback:((O=n.value_feedback)==null?void 0:O.trim())||void 0,ticket_price_paid:n.ticket_price_paid,photos:n.photos,setlist:n.setlist||null,was_there:!0});console.error(" ReviewService: First insert failed, retrying with minimal insert. Error:",Y);const K=yield P.from("reviews").insert(z).select().single();V=K.data,Y=K.error}if(Y)throw console.error(" ReviewService: Final insert/update error:",Y),Y;if(console.log(" ReviewService: Review saved successfully. Data:",V),console.log(" ReviewService: Saved category ratings:",{artist_performance_rating:V==null?void 0:V.artist_performance_rating,production_rating:V==null?void 0:V.production_rating,venue_rating:V==null?void 0:V.venue_rating,location_rating:V==null?void 0:V.location_rating,value_rating:V==null?void 0:V.value_rating}),console.log(" ReviewService: Saved category feedback:",{artist_performance_feedback:V==null?void 0:V.artist_performance_feedback,production_feedback:V==null?void 0:V.production_feedback,venue_feedback:V==null?void 0:V.venue_feedback,location_feedback:V==null?void 0:V.location_feedback,value_feedback:V==null?void 0:V.value_feedback}),$&&V)try{const{error:z,data:K}=yield P.from("reviews").delete().eq("user_id",t).eq("event_id",r).eq("is_draft",!0).select("id");if(z)console.error(" CRITICAL: Failed to delete drafts after creating review:",z);else{const Z=(K==null?void 0:K.length)||0;Z>0&&console.log(` NUCLEAR: Deleted ${Z} draft(s) after review creation`);const G=yield P.from("reviews").select("id").eq("user_id",t).eq("event_id",r).eq("is_draft",!0);G.data&&G.data.length>0?(console.error(` CRITICAL ERROR: ${G.data.length} draft(s) STILL EXIST after deletion!`,G.data),yield P.from("reviews").delete().eq("user_id",t).eq("event_id",r).eq("is_draft",!0)):console.log(" Verified: All drafts deleted successfully")}}catch(z){console.error(" CRITICAL: Exception during draft cleanup:",z);try{yield P.from("reviews").delete().eq("user_id",t).eq("event_id",r).eq("is_draft",!0)}catch(K){console.error(" CRITICAL: Retry deletion also failed:",K)}}return V}catch(A){const T=A,$=(T==null?void 0:T.message)||(T==null?void 0:T.error_description)||(T==null?void 0:T.details)||(T==null?void 0:T.hint)||JSON.stringify(T);throw console.error("Error setting event review:",T),new Error(`Failed to set event review: ${$}`)}})}static getUserEventReview(t,r){return E(this,null,function*(){try{if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r))return console.log(" Invalid event ID format (not a UUID), skipping review lookup:",r),null;const{data:i,error:a}=yield P.from("reviews").select("*").eq("user_id",t).eq("event_id",r).single();if(a&&a.code!=="PGRST116")throw a;return i||null}catch(n){const i=n;return(i==null?void 0:i.code)!=="22P02"&&console.error("Error getting user event review:",n),null}})}static getPreviousVenueReview(t,r,n){return E(this,null,function*(){try{if(!r)return null;const i=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;if(!i.test(r))return null;const a=P.from("reviews").select("*").eq("user_id",t).eq("venue_id",r).eq("is_draft",!1).order("created_at",{ascending:!1});n&&i.test(n)&&a.neq("event_id",n);const{data:o,error:l}=yield a;return l&&l.code!=="PGRST116"?(console.error("Error getting previous venue review:",l),null):!o||o.length===0?null:o.find(d=>d.venue_rating!=null||d.location_rating!=null||d.venue_feedback||d.location_feedback)||null}catch(i){return console.error("Error getting previous venue review:",i),null}})}static getEventReviews(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("reviews").select(`
          *,
          events_with_artist_venue:event_id (id, title, artist_name_normalized, venue_name_normalized, event_date),
          review_likes!left(id, user_id)
        `).eq("event_id",t).eq("is_public",!0);if(n&&n.sort((d,u)=>{const h=typeof d.rating=="number"?d.rating:0,f=typeof u.rating=="number"?u.rating:0;return f!==h?f-h:new Date(u.created_at).getTime()-new Date(d.created_at).getTime()}),i)throw i;let a=[];if(r){const{data:d}=yield P.from("engagements").select("entity_id").eq("user_id",r).eq("entity_type","review").eq("engagement_type","like").in("entity_id",(n==null?void 0:n.map(u=>u.id))||[]);a=(d==null?void 0:d.map(u=>u.entity_id))||[]}const o=(n||[]).map(d=>{var u,h,f,p,x,g;return W(M({},d),{artist_name:((u=d.events_with_artist_venue)==null?void 0:u.artist_name_normalized)||((h=d.events)==null?void 0:h.artist_name),artist_id:d.artist_id||null,venue_name:((f=d.events_with_artist_venue)==null?void 0:f.venue_name_normalized)||((p=d.events)==null?void 0:p.venue_name),venue_id:d.venue_id||null,is_liked_by_user:a.includes(d.id),user_like_id:a.includes(d.id)?(g=(x=d.review_likes)==null?void 0:x.find(v=>v.user_id===r))==null?void 0:g.id:void 0,review_type:d.review_type,is_public:d.is_public})}),l=o.length,c=l>0?o.reduce((d,u)=>d+u.rating,0)/l:0;return{reviews:o,averageRating:c,totalReviews:l}}catch(n){throw console.error("Error getting event reviews:",n),new Error(`Failed to get event reviews: ${n instanceof Error?n.message:"Unknown error"}`)}})}static getUserReviewHistory(t){return E(this,null,function*(){var r,n;try{console.log(" ReviewService: Getting user review history for userId:",t),console.log(" ReviewService: Starting query for userId:",t);const{count:i}=yield P.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t);console.log(" ReviewService: Total reviews (including drafts) for user:",i);const{data:a,error:o,count:l}=yield P.from("reviews").select('*, "Event_date"',{count:"exact"}).eq("user_id",t).eq("is_draft",!1).order("created_at",{ascending:!1});if(a&&a.length>0&&(console.log(" ReviewService: First review column names:",Object.keys(a[0])),console.log(" ReviewService: First review Event_date check:",{hasEventDate:"event_date"in a[0],hasEventDateCapital:"Event_date"in a[0],event_date:a[0].event_date,Event_date:a[0].Event_date})),a&&a.sort((_,w)=>{const b=typeof _.rating=="number"?_.rating:0,N=typeof w.rating=="number"?w.rating:0;return N!==b?N-b:_.rank_order!=null&&w.rank_order!=null?_.rank_order-w.rank_order:_.rank_order!=null?-1:w.rank_order!=null?1:new Date(w.created_at).getTime()-new Date(_.created_at).getTime()}),console.log(" ReviewService: Query completed. Count:",l,"Data length:",a==null?void 0:a.length),a&&a.length>0&&console.log(" ReviewService: First review sample:",{id:a[0].id,user_id:a[0].user_id,event_id:a[0].event_id,is_draft:a[0].is_draft,was_there:a[0].was_there,review_text:(r=a[0].review_text)==null?void 0:r.substring(0,50)}),console.log(" ReviewService: Raw query result:",{dataLength:a==null?void 0:a.length,error:o,firstReview:a==null?void 0:a[0],userId:t}),o)throw console.error(" ReviewService: Query error:",o),o;if(!a||a.length===0)return console.warn(" ReviewService: No reviews found for user:",t),{reviews:[],total:0};const c=[...new Set((a||[]).map(_=>_.event_id).filter(Boolean))];console.log(" ReviewService: Event IDs to fetch:",c.length,c);let d={};const u=[...new Set((a||[]).map(_=>_.artist_id).filter(Boolean))],h=[...new Set((a||[]).map(_=>_.venue_id).filter(Boolean))];if(c.length>0){const{data:_,error:w}=yield P.from("events").select("id, title, artist_name, venue_name, artist_id, venue_id, event_date, doors_time, venue_city, venue_state, venue_zip").in("id",c);if(console.log(" ReviewService: Events query result:",{dataLength:_==null?void 0:_.length,error:w,firstEvent:_==null?void 0:_[0]}),!w&&_){const b=[...new Set(_.map(T=>T.artist_id).filter(Boolean))],N=[...new Set(_.map(T=>T.venue_id).filter(Boolean))],S=[...new Set([...b,...u])],k=[...new Set([...N,...h])];let O={};if(S.length>0){const{data:T}=yield P.from("artists").select("id, name, image_url").in("id",S);T&&(O=T.reduce(($,R)=>($[R.id]=R,$),{}))}let A={};if(k.length>0){const{data:T}=yield P.from("venues").select("id, name, image_url").in("id",k);T&&(A=T.reduce(($,R)=>($[R.id]=R,$),{}))}d=_.reduce((T,$)=>{var R,F;return T[$.id]=W(M({},$),{artist_name:((R=O[$.artist_id])==null?void 0:R.name)||$.artist_name,venue_name:((F=A[$.venue_id])==null?void 0:F.name)||$.venue_name,artist_id:$.artist_id,venue_id:$.venue_id}),T},{}),console.log(" ReviewService: Events map created with",Object.keys(d).length,"events"),console.log(" ReviewService: Sample event in map:",d[Object.keys(d)[0]])}else w&&console.error(" ReviewService: Error fetching events:",w)}else console.warn(" ReviewService: No event IDs found in reviews");let f={},p={};if(u.length>0){const{data:_}=yield P.from("artists").select("id, name, image_url").in("id",u);_&&(f=_.reduce((w,b)=>(w[b.id]=b,w),{}))}if(h.length>0){const{data:_}=yield P.from("venues").select("id, name, image_url").in("id",h);_&&(p=_.reduce((w,b)=>(w[b.id]=b,w),{}))}const x=a,g=(x||[]).filter(_=>!!(_.was_there===!0||_.review_text&&_.review_text!=="ATTENDANCE_ONLY"));console.log(" ReviewService: Total reviews fetched:",x==null?void 0:x.length),console.log(" ReviewService: Reviews after filtering:",g.length),console.log(" ReviewService: Sample filtered review:",g[0]?{id:g[0].id,user_id:g[0].user_id,event_id:g[0].event_id,was_there:g[0].was_there,review_text:g[0].review_text,hasEventInMap:!!d[g[0].event_id],eventTitle:(n=d[g[0].event_id])==null?void 0:n.title}:"No reviews");const v={reviews:g.map(_=>{var k,O;let b=_.event_id&&d[_.event_id]||null;!b&&(_.artist_id||_.venue_id)&&(b={id:null,title:null,artist_name:_.artist_id&&((k=f[_.artist_id])==null?void 0:k.name)||null,venue_name:_.venue_id&&((O=p[_.venue_id])==null?void 0:O.name)||null,artist_id:_.artist_id,venue_id:_.venue_id,event_date:null}),b&&(!b.artist_name||!b.venue_name)&&(!b.artist_name&&_.artist_id&&f[_.artist_id]&&(b.artist_name=f[_.artist_id].name,b.artist_id=_.artist_id),!b.venue_name&&_.venue_id&&p[_.venue_id]&&(b.venue_name=p[_.venue_id].name,b.venue_id=_.venue_id));let N;const S=_.Event_date||_.event_date;if(S){const[A,T,$]=S.split("-").map(Number);if(A&&T&&$){const R=new Date(A,T-1,$);isNaN(R.getTime())||(N=R)}}return{review:{id:_.id,user_id:_.user_id,event_id:_.event_id,artist_id:_.artist_id,venue_id:_.venue_id,rating:_.rating,rank_order:_.rank_order,review_type:_.review_type,review_text:_.review_text,photos:_.photos,videos:_.videos,setlist:_.setlist,mood_tags:_.mood_tags,genre_tags:_.genre_tags,context_tags:_.context_tags,artist_rating:_.artist_rating,artist_performance_rating:_.artist_performance_rating,production_rating:_.production_rating,venue_rating:_.venue_rating,location_rating:_.location_rating,value_rating:_.value_rating,artist_performance_feedback:_.artist_performance_feedback,production_feedback:_.production_feedback,venue_feedback:_.venue_feedback,location_feedback:_.location_feedback,value_feedback:_.value_feedback,Event_date:N,ticket_price_paid:_.ticket_price_paid,created_at:_.created_at,updated_at:_.updated_at,likes_count:_.likes_count,comments_count:_.comments_count,shares_count:_.shares_count,is_public:_.is_public,was_there:_.was_there,attendees:_.attendees,met_on_synth:_.met_on_synth},event:b}}),total:Array.isArray(x)?x.length:0};return console.log(" ReviewService: Processed result:",v),v}catch(i){throw console.error(" ReviewService: Error getting user review history:",i),new Error(`Failed to get user review history: ${i instanceof Error?i.message:"Unknown error"}`)}})}static setRankOrderForRatingGroup(t,r,n){return E(this,null,function*(){console.log(" Saving rank order:",{userId:t,rating:r,count:n.length});const i=Math.round(r*10)/10,a=n.map((o,l)=>({id:o,rank_order:l+1}));try{const{data:o,error:l}=yield P.from("reviews").select("id, rating, artist_performance_rating, production_rating, venue_rating, location_rating, value_rating").eq("user_id",t).eq("is_draft",!1);if(l)console.warn(" Could not fetch reviews to clear rank_order:",l);else if(o){const c=o.filter(d=>{const u=[d.artist_performance_rating,d.production_rating,d.venue_rating,d.location_rating,d.value_rating].filter(f=>typeof f=="number"&&f>0);if(u.length>0){const f=u.reduce((x,g)=>x+g,0)/u.length;return Math.round(f*10)/10===i}return(d.rating?Math.round(d.rating*10)/10:null)===i});for(const d of c)n.includes(d.id)||(yield P.from("reviews").update({rank_order:null}).eq("id",d.id).eq("user_id",t))}for(const c of a){console.log(`  Updating review ${c.id.slice(0,8)}...  rank_order = ${c.rank_order}`);const{error:d}=yield P.from("reviews").update({rank_order:c.rank_order}).eq("id",c.id).eq("user_id",t);if(d)throw console.error(` Error updating review ${c.id}:`,d),d}console.log(" All rankings saved successfully")}catch(o){throw console.error(" Error updating rank order group:",o),new Error(`Failed to update ranking: ${o instanceof Error?o.message:"Unknown error"}`)}})}static clearRankOnRatingChange(t){return E(this,null,function*(){try{const{error:r}=yield P.from("reviews").update({rank_order:null}).eq("id",t);if(r)throw r}catch(r){console.warn("Failed to clear rank_order on rating change",r)}})}static deleteEventReview(t,r){return E(this,null,function*(){try{console.log(" Deleting review:",{userId:t,reviewId:r});const{error:n}=yield P.from("reviews").delete().eq("id",r).eq("user_id",t);if(n)throw console.error("Error deleting review:",n),n;console.log(" Review deleted successfully")}catch(n){throw console.error("Error deleting __event review:",n),new Error(`Failed to delete event review: ${n instanceof Error?n.message:"Unknown error"}`)}})}static likeReview(t,r){return E(this,null,function*(){console.log(" ReviewService: likeReview called",{userId:t,reviewId:r});try{console.log(" ReviewService: Checking for existing like...");const{data:n,error:i}=yield P.from("engagements").select("id").eq("user_id",t).eq("entity_type","review").eq("entity_id",r).eq("engagement_type","like").maybeSingle();if(console.log(" ReviewService: Existing like check result:",{existingLike:n,checkError:i}),i&&i.code!=="PGRST116")throw console.error(" ReviewService: Error checking existing like:",i),i;if(n)return console.log(" ReviewService: User already liked this review, returning existing like"),n;console.log(" ReviewService: Inserting new like...");const{data:a,error:o}=yield P.from("engagements").insert({user_id:t,entity_type:"review",entity_id:r,engagement_type:"like"}).select().single();if(console.log(" ReviewService: Insert result:",{data:a,error:o}),o){if(console.error(" ReviewService: Error inserting like:",o),o.code==="23505"){console.log(" ReviewService: Duplicate key error, fetching existing like...");const{data:l}=yield P.from("engagements").select("*").eq("user_id",t).eq("entity_type","review").eq("entity_id",r).eq("engagement_type","like").single();return console.log(" ReviewService: Found existing like after duplicate error:",l),l}throw o}return console.log(" ReviewService: Like inserted successfully:",a),a}catch(n){throw console.error(" ReviewService: Error liking review:",n),new Error(`Failed to like review: ${n instanceof Error?n.message:"Unknown error"}`)}})}static unlikeReview(t,r){return E(this,null,function*(){try{const{error:n}=yield P.from("engagements").delete().eq("user_id",t).eq("entity_type","review").eq("entity_id",r).eq("engagement_type","like");if(n)throw n}catch(n){throw console.error("Error unliking review:",n),new Error(`Failed to unlike review: ${n instanceof Error?n.message:"Unknown error"}`)}})}static addComment(t,r,n,i){return E(this,null,function*(){try{const{data:a,error:o}=yield P.from("comments").insert({user_id:t,entity_type:"review",entity_id:r,comment_text:n,parent_comment_id:i}).select().single();if(o)throw o;return yield this.updateReviewCounts(r,"comments",1),a}catch(a){throw console.error("Error adding comment:",a),new Error(`Failed to add comment: ${a instanceof Error?a.message:"Unknown error"}`)}})}static getReviewComments(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("comments").select("*").eq("entity_type","review").eq("entity_id",t).order("created_at",{ascending:!0});if(n)throw n;if(!r||r.length===0)return[];const i=[...new Set(r.map(d=>d.user_id))],{data:a,error:o}=yield P.from("users").select("id, name, avatar_url, user_id").in("user_id",i);if(o)throw o;const l=new Map;return a==null||a.forEach(d=>{l.set(d.user_id,{id:d.id,name:d.name,avatar_url:d.avatar_url})}),r.map(d=>W(M({},d),{user:l.get(d.user_id)||{id:d.user_id,name:"Unknown User",avatar_url:void 0}}))}catch(r){throw console.error("Error getting review comments:",r),new Error(`Failed to get review comments: ${r instanceof Error?r.message:"Unknown error"}`)}})}static shareReview(t,r,n){return E(this,null,function*(){try{const{data:i,error:a}=yield P.from("engagements").insert({user_id:t,entity_type:"review",entity_id:r,engagement_type:"share",engagement_value:n||"unknown",metadata:{review_id:r,share_platform:n}}).select().single();if(a)throw a;return yield this.updateReviewCounts(r,"shares",1),i}catch(i){throw console.error("Error sharing review:",i),new Error(`Failed to share review: ${i instanceof Error?i.message:"Unknown error"}`)}})}static getPublicReviewsWithProfiles(t,r,n=20,i=0){return E(this,null,function*(){try{let a=P.from("reviews").select(`
          *,
          users:users!reviews_user_id_fkey (
            user_id,
            name,
            avatar_url,
            account_type
          )
          events_with_artist_venue:event_id (
            id,
            title,
            artist_name_normalized,
            venue_name_normalized,
            event_date
          )
        `,{count:"exact"}).eq("is_public",!0).eq("is_draft",!1).order("created_at",{ascending:!1}).range(i,i+n-1);t&&(a=a.eq("event_id",t)),r&&(a=a.eq("venue_id",r));const{data:o,error:l,count:c}=yield a;if(l)throw l;const d=(o||[]).map(f=>f.user_id).filter(Boolean),u=new Map;if(d.length>0){const{data:f}=yield P.from("user_verifications").select("user_id, verified").in("user_id",d);f==null||f.forEach(p=>{u.set(p.user_id,p.verified||!1)})}return{reviews:(o||[]).map(f=>{var p,x,g,v,_,w,b,N,S,k,O;return W(M({},f),{reviewer_name:(p=f.users)==null?void 0:p.name,reviewer_avatar:(x=f.users)==null?void 0:x.avatar_url,reviewer_verified:u.get(f.user_id)||!1,reviewer_account_type:(g=f.users)==null?void 0:g.account_type,event_title:((v=f.events_with_artist_venue)==null?void 0:v.title)||((_=f.events)==null?void 0:_.title),artist_name:((w=f.events_with_artist_venue)==null?void 0:w.artist_name_normalized)||((b=f.events)==null?void 0:b.artist_name),venue_name:((N=f.events_with_artist_venue)==null?void 0:N.venue_name_normalized)||((S=f.events)==null?void 0:S.venue_name),event_date:((k=f.events_with_artist_venue)==null?void 0:k.event_date)||((O=f.events)==null?void 0:O.event_date)})}),total:c||0}}catch(a){throw console.error("Error getting public reviews with profiles:",a),new Error(`Failed to get public reviews: ${a instanceof Error?a.message:"Unknown error"}`)}})}static updateReviewCounts(t,r,n){return E(this,null,function*(){try{const i=`${r}_count`;console.log(" ReviewService: Updating review counts",{reviewId:t,type:r,delta:n,column:i});const{data:a,error:o}=yield P.from("reviews").select("likes_count, comments_count, shares_count").eq("id",t).single();if(o){console.error(" ReviewService: Error fetching current counts:",o);return}const l=(a==null?void 0:a[i])||0,c=Math.max(0,l+n);console.log(" ReviewService: Updating count",{currentCount:l,nextCount:c});const{error:d}=yield P.from("reviews").update({[i]:c}).eq("id",t);d?console.error(" ReviewService: Error updating count:",d):console.log(" ReviewService: Successfully updated count")}catch(i){console.error(` ReviewService: Error updating ${r} count:`,i)}})}static getReviewEngagement(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.rpc("get_review_engagement",{review_id_param:t,user_id_param:r||null});if(!i&&n&&Array.isArray(n)&&n.length>0&&typeof n[0]=="object")return n[0];console.log(" ReviewService: RPC failed, using direct queries");const{data:a,error:o}=yield P.from("reviews").select("likes_count, comments_count, shares_count").eq("id",t).single();if(o)throw console.error(" ReviewService: Error fetching review data:",o),o;let l=!1;if(r){const{data:c,error:d}=yield P.from("engagements").select("id").eq("entity_type","review").eq("entity_id",t).eq("engagement_type","like").eq("user_id",r).maybeSingle();d?console.error(" ReviewService: Error checking like status:",d):l=!!c}return{likes_count:(a==null?void 0:a.likes_count)||0,comments_count:(a==null?void 0:a.comments_count)||0,shares_count:(a==null?void 0:a.shares_count)||0,is_liked_by_user:l}}catch(n){return console.warn("ReviewService.getReviewEngagement failed",n),null}})}static getReviewsEngagement(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("reviews").select(`
          id, 
          likes_count, 
          comments_count, 
          shares_count,
          review_likes!left(id, user_id)
        `).in("id",t);if(i)throw i;const a={};return n==null||n.forEach(o=>{const l=Array.isArray(o.review_likes)?o.review_likes:[],c=r?l.some(d=>d.user_id===r):!1;a[o.id]={likes_count:o.likes_count||0,comments_count:o.comments_count||0,shares_count:o.shares_count||0,is_liked_by_user:c}}),a}catch(n){return console.warn("ReviewService.getReviewsEngagement failed",n),{}}})}static getPopularTags(t){return E(this,null,function*(){try{const r=`${t}_tags`,{data:n,error:i}=yield P.from("reviews").select(r).not(r,"is",null).eq("is_public",!0);if(i)throw i;const a={};return n==null||n.forEach(o=>{(o[r]||[]).forEach(c=>{a[c]=(a[c]||0)+1})}),Object.entries(a).map(([o,l])=>({tag:o,count:l})).sort((o,l)=>l.count-o.count).slice(0,20)}catch(r){return console.error("Error getting popular tags:",r),[]}})}static getVenueStats(t){return E(this,null,function*(){try{let r=t;if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)){const{data:o}=yield P.from("venues_with_external_ids").select("jambase_venue_id").eq("id",t).maybeSingle();o!=null&&o.jambase_venue_id&&(r=o.jambase_venue_id)}const{data:i,error:a}=yield P.rpc("get_venue_stats",{venue_jambase_id:r});if(a)throw a;return i[0]||{total_reviews:0,average_venue_rating:0,average_artist_rating:0,average_overall_rating:0,rating_distribution:{"1_star":0,"2_star":0,"3_star":0,"4_star":0,"5_star":0}}}catch(r){throw console.error("Error getting venue stats:",r),new Error(`Failed to get venue stats: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getPopularVenueTags(t){return E(this,null,function*(){try{let r=t;if(t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)){const{data:o}=yield P.from("venues_with_external_ids").select("jambase_venue_id").eq("id",t).maybeSingle();o!=null&&o.jambase_venue_id&&(r=o.jambase_venue_id)}const{data:n,error:i}=yield P.rpc("get_popular_venue_tags",r?{venue_jambase_id:r}:{});if(i)throw i;return n||[]}catch(r){return console.error("Error getting popular venue tags:",r),[]}})}static getVenueReviews(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("reviews").select(`
          *,
          review_likes!left(id, user_id)
        `).eq("venue_id",t).eq("is_public",!0).order("created_at",{ascending:!1});if(i)throw i;let a=[];if(r){const{data:d}=yield P.from("engagements").select("entity_id").eq("user_id",r).eq("entity_type","review").eq("engagement_type","like").in("entity_id",(n==null?void 0:n.map(u=>u.id))||[]);a=(d==null?void 0:d.map(u=>u.entity_id))||[]}const o=(n||[]).map(d=>{var u,h;return W(M({},d),{is_liked_by_user:a.includes(d.id),user_like_id:a.includes(d.id)?(h=(u=d.review_likes)==null?void 0:u.find(f=>f.user_id===r))==null?void 0:h.id:void 0,review_type:d.review_type,is_public:d.is_public})}),l=o.length,c=l>0?o.reduce((d,u)=>d+u.rating,0)/l:0;return{reviews:o,averageRating:c,totalReviews:l}}catch(n){throw console.error("Error getting venue reviews:",n),new Error(`Failed to get venue reviews: ${n instanceof Error?n.message:"Unknown error"}`)}})}static getArtistReviews(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("reviews").select(`
          *,
          review_likes!left(id, user_id)
        `).eq("artist_id",t).eq("is_public",!0).order("created_at",{ascending:!1});if(i)throw i;let a=[];if(r){const{data:d}=yield P.from("engagements").select("entity_id").eq("user_id",r).eq("entity_type","review").eq("engagement_type","like").in("entity_id",(n==null?void 0:n.map(u=>u.id))||[]);a=(d==null?void 0:d.map(u=>u.entity_id))||[]}const o=(n||[]).map(d=>{var u,h;return W(M({},d),{is_liked_by_user:a.includes(d.id),user_like_id:a.includes(d.id)?(h=(u=d.review_likes)==null?void 0:u.find(f=>f.user_id===r))==null?void 0:h.id:void 0,review_type:d.review_type,is_public:d.is_public})}),l=o.length,c=l>0?o.reduce((d,u)=>d+u.rating,0)/l:0;return{reviews:o,averageRating:c,totalReviews:l}}catch(n){throw console.error("Error getting artist reviews:",n),new Error(`Failed to get artist reviews: ${n instanceof Error?n.message:"Unknown error"}`)}})}static getArtistStats(t){return E(this,null,function*(){try{let r=t;if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)){const{data:o}=yield P.from("artists").select("jambase_artist_id").eq("id",t).single();o!=null&&o.jambase_artist_id&&(r=o.jambase_artist_id)}const{data:i,error:a}=yield P.rpc("get_artist_stats",{artist_jambase_id:r});if(a)throw a;return i[0]||{total_reviews:0,average_rating:0,rating_distribution:{"1_star":0,"2_star":0,"3_star":0,"4_star":0,"5_star":0}}}catch(r){throw console.error("Error getting artist stats:",r),new Error(`Failed to get artist stats: ${r instanceof Error?r.message:"Unknown error"}`)}})}}const or=y.forwardRef((i,n)=>{var a=i,{className:e,type:t}=a,r=me(a,["className","type"]);return s.jsx("input",M({type:t,className:ke("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n},r))});or.displayName="Input";var gce="Label",fF=y.forwardRef((e,t)=>s.jsx(Nt.label,W(M({},e),{ref:t,onMouseDown:r=>{var i;r.target.closest("button, input, select, textarea")||((i=e.onMouseDown)==null||i.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}})));fF.displayName=gce;var hF=fF;const vce=qm("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ut=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(hF,M({ref:r,className:ke(vce(),e)},t))});Ut.displayName=hF.displayName;const xce=e=>{switch(e){case"1min":return 4;case"3min":return 6;case"5min":return 9;default:return 1}},Ch=8,X7={reviewDuration:null,selectedArtist:null,selectedVenue:null,eventDate:"",selectedSetlist:null,customSetlist:[],artistPerformanceRating:0,productionRating:0,venueRating:0,locationRating:0,valueRating:0,artistPerformanceFeedback:"",productionFeedback:"",venueFeedback:"",locationFeedback:"",valueFeedback:"",ticketPricePaid:"",rating:0,reviewText:"",photos:[],videos:[],attendees:[],metOnSynth:!1,isPublic:!0,reviewType:"event"};function yce(){const[e,t]=y.useState({currentStep:1,formData:X7,errors:{},isLoading:!1,isValid:!1}),r=g=>{switch(g){case"1min":return"quick";case"3min":return"standard";case"5min":return"detailed";default:return null}},n=g=>xce(g),i=y.useCallback((g,v)=>{const _={},w=r(v.reviewDuration);if(n(v.reviewDuration),g===1&&!v.reviewDuration)return _.reviewDuration="Please select how much time you want to spend",_;switch(w){case"quick":g===2?(v.selectedArtist||(_.selectedArtist="Please select an artist"),v.selectedVenue||(_.selectedVenue="Please select a venue"),v.eventDate||(_.eventDate="Please select a date")):g===3&&((!v.rating||v.rating<.5||v.rating>5)&&(_.rating="Please provide an overall rating (0.5 - 5 stars)"),!v.reviewText||v.reviewText.trim()===""?_.reviewText="Please share a brief description of your experience":v.reviewText.length>200&&(_.reviewText="Review text must be 200 characters or less for quick review"));break;case"standard":g===2?(v.selectedArtist||(_.selectedArtist="Please select an artist"),v.selectedVenue||(_.selectedVenue="Please select a venue"),v.eventDate||(_.eventDate="Please select a date")):g===3?(!v.artistPerformanceRating||v.artistPerformanceRating<.5||v.artistPerformanceRating>5)&&(_.artistPerformanceRating="Please rate the artist performance (0.5 - 5 stars)"):g===4?(!v.venueRating||v.venueRating<.5||v.venueRating>5)&&(_.venueRating="Please rate the venue (0.5 - 5 stars)"):g===5&&(!v.reviewText||v.reviewText.trim()===""?_.reviewText="Please share a description of your experience":v.reviewText.length>400&&(_.reviewText="Review text must be 400 characters or less for standard review"));break;case"detailed":g===2?(v.selectedArtist||(_.selectedArtist="Please select an artist"),v.selectedVenue||(_.selectedVenue="Please select a venue"),v.eventDate||(_.eventDate="Please select a date")):g===3?(!v.artistPerformanceRating||v.artistPerformanceRating<.5||v.artistPerformanceRating>5)&&(_.artistPerformanceRating="Please rate the artist performance (0.5 - 5 stars)"):g===4?(!v.productionRating||v.productionRating<.5||v.productionRating>5)&&(_.productionRating="Please rate the production quality (0.5 - 5 stars)"):g===5?(!v.venueRating||v.venueRating<.5||v.venueRating>5)&&(_.venueRating="Please rate the venue (0.5 - 5 stars)"):g===6?(!v.locationRating||v.locationRating<.5||v.locationRating>5)&&(_.locationRating="Please rate the location & logistics (0.5 - 5 stars)"):g===7?((!v.valueRating||v.valueRating<.5||v.valueRating>5)&&(_.valueRating="Please rate the value for the ticket (0.5 - 5 stars)"),v.ticketPricePaid&&Number.isNaN(Number(v.ticketPricePaid))?_.ticketPricePaid="Ticket price must be a valid number":v.ticketPricePaid&&Number(v.ticketPricePaid)<0&&(_.ticketPricePaid="Ticket price cannot be negative")):g===8&&(!v.reviewText||v.reviewText.trim()===""?_.reviewText="Please share a brief description of your experience":v.reviewText.length>500&&(_.reviewText="Review text must be 500 characters or less"));break}return _},[]),a=y.useCallback(g=>{const v=[];if(g.artistPerformanceRating&&g.artistPerformanceRating>0&&v.push(g.artistPerformanceRating),g.productionRating&&g.productionRating>0&&v.push(g.productionRating),g.venueRating&&g.venueRating>0&&v.push(g.venueRating),g.locationRating&&g.locationRating>0&&v.push(g.locationRating),g.valueRating&&g.valueRating>0&&v.push(g.valueRating),v.length===0)return 0;const _=v.reduce((w,b)=>w+b,0)/v.length;return Math.round(_*10)/10},[]),o=y.useCallback(g=>{console.log(" useReviewForm: updateFormData called with:",g),t(v=>{const _=M(M({},v.formData),g);console.log(" useReviewForm: Previous formData:",v.formData),console.log(" useReviewForm: New formData:",_),(g.artistPerformanceRating!==void 0||g.productionRating!==void 0||g.venueRating!==void 0||g.locationRating!==void 0||g.valueRating!==void 0)&&(_.rating=a(_));const w=i(v.currentStep,_),b=Object.keys(w).length===0;return console.log(" useReviewForm: Step validation errors:",w),console.log(" useReviewForm: Form is valid:",b),W(M({},v),{formData:_,errors:w,isValid:b})})},[i,a]),l=y.useCallback(()=>{t(g=>{const v=i(g.currentStep,g.formData);if(!(Object.keys(v).length===0))return W(M({},g),{errors:v});const w=n(g.formData.reviewDuration),b=w>0?w:Ch,N=Math.min(g.currentStep+1,b);return W(M({},g),{currentStep:N,errors:{},isValid:!0})})},[i]),c=y.useCallback(()=>{t(g=>W(M({},g),{currentStep:Math.max(g.currentStep-1,1),errors:{}}))},[]),d=y.useCallback(g=>{t(v=>{const _=n(v.formData.reviewDuration),w=_>0?_:Ch;return W(M({},v),{currentStep:Math.max(1,Math.min(g,w)),errors:{}})})},[]),u=y.useCallback(g=>{t(v=>W(M({},v),{isLoading:g}))},[]),h=y.useCallback(()=>{t({currentStep:1,formData:X7,errors:{},isLoading:!1,isValid:!1})},[]),f=y.useCallback(g=>{t(v=>{const _=M(M({},v.formData),g);(g.artistPerformanceRating!==void 0||g.productionRating!==void 0||g.venueRating!==void 0||g.locationRating!==void 0||g.valueRating!==void 0)&&(_.rating=a(_));const w=i(v.currentStep,_),b=Object.keys(w).length===0;return W(M({},v),{formData:_,errors:w,isValid:b})})},[i,a]),p=n(e.formData.reviewDuration),x=p>0?p:Ch;return W(M({},e),{updateFormData:o,nextStep:l,prevStep:c,setStep:d,setLoading:u,resetForm:h,setFormData:f,canProceed:e.isValid,canGoBack:e.currentStep>1,isLastStep:e.currentStep===x,totalSteps:x,currentFlow:r(e.formData.reviewDuration)})}function _ce({reviewDuration:e,onSelectDuration:t}){const r=[{value:"1min",label:"1 Minute",subtitle:"Quick Review",description:"Overall rating + brief text",features:["Overall rating","Brief review text (200 chars)","Optional setlist"]},{value:"3min",label:"3 Minutes",subtitle:"Standard Review",description:"Key ratings + text + photos",features:["Overall rating","Artist Performance & Venue ratings","Review text (400 chars)","Optional photos","Optional setlist"]},{value:"5min",label:"5 Minutes",subtitle:"Detailed Review",description:"Full detailed review",features:["All 5 category ratings","Category feedback","Full review text (500 chars)","Photos & videos","Optional setlist","Optional ticket price"]}];return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("header",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Get Started"}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"How much time do you want to spend?"}),s.jsx("p",{className:"text-sm text-gray-600 max-w-xl mx-auto",children:"Choose the review style that works best for you."})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:r.map(n=>{const i=e===n.value;return s.jsxs("button",{type:"button",onClick:()=>t(n.value),className:ke("relative p-6 rounded-2xl border-2 text-left transition-all","hover:shadow-lg hover:scale-[1.02]",i?"border-pink-500 bg-gradient-to-br from-pink-50 to-rose-50 shadow-md":"border-gray-200 bg-white hover:border-pink-300"),children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx(ai,{className:ke("w-5 h-5",i?"text-pink-600":"text-gray-400")}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n.label}),s.jsx("p",{className:"text-sm text-gray-500",children:n.subtitle})]})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:n.description}),s.jsx("ul",{className:"space-y-1.5",children:n.features.map((a,o)=>s.jsxs("li",{className:"text-xs text-gray-500 flex items-start gap-2",children:[s.jsx("span",{className:"text-pink-500 mt-0.5",children:""}),s.jsx("span",{children:a})]},o))}),i&&s.jsx("div",{className:"absolute top-4 right-4",children:s.jsx("div",{className:"w-6 h-6 rounded-full bg-pink-500 flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})})]},n.value)})})]})}class Av{static searchArtistsTrigram(t,r=20){return E(this,null,function*(){if(!t||t.length<2)return[];try{return yield this.getFuzzyMatchedResults(t,r)}catch(n){return console.error("Error in trigram search:",n),this.searchArtists(t,r,!1)}})}static searchArtists(t,r=20,n=!1,i=!0){return E(this,null,function*(){if(!t||t.length<2)return[];try{console.log(` Searching for artists: "${t}" (useApi: ${n}, useTrigram: ${i})`);let a=[];try{i?(a=yield this.searchArtistsTrigram(t,r),console.log(` Found ${a.length} artists using trigram search`)):(a=yield this.getFuzzyMatchedResults(t,r),console.log(` Found ${a.length} artists from local database`))}catch(l){if(console.warn("  Could not get fuzzy results from database:",l),i)try{a=yield this.getFuzzyMatchedResults(t,r),console.log(` Fallback: Found ${a.length} artists using client-side search`)}catch(c){console.warn("  Fallback search also failed:",c)}}if(!n)return console.log(` Returning ${a.length} results from local database (no API call)`),a;let o=[];try{i?(o=yield this.searchArtistsTrigram(t,r),console.log(` Final trigram search results: ${o.length}`)):(o=yield this.getFuzzyMatchedResults(t,r),console.log(` Final database results: ${o.length}`))}catch(l){if(console.warn("  Could not get final results from database:",l),i)try{o=yield this.getFuzzyMatchedResults(t,r),console.log(` Fallback final results: ${o.length}`)}catch(c){console.warn("  Fallback final search also failed:",c)}}return o.length>0?o:(console.log(" No results found in database"),[])}catch(a){return console.error(" Error in unified artist search:",a),[]}})}static searchTicketmasterAttractions(t,r){return E(this,null,function*(){return[]})}static searchJamBaseAPI(t,r){return E(this,null,function*(){return[]})}static getFallbackArtists(t,r){const a=[{id:"cage-the-elephant-1",name:"Cage The Elephant",identifier:"jambase:cage-the-elephant-1",image:"https://picsum.photos/300/300?random=1",genres:["alternative rock","indie rock","garage rock"],"x-bandOrMusician":"band","x-numUpcomingEvents":12},{id:"goose-1",name:"Goose",identifier:"jambase:goose-1",image:"https://picsum.photos/300/300?random=2",genres:["jam band","rock","funk"],"x-bandOrMusician":"band","x-numUpcomingEvents":25},{id:"phish-1",name:"Phish",identifier:"jambase:194164",image:"https://picsum.photos/300/300?random=3",genres:["rock","jam band","psychedelic rock"],"x-bandOrMusician":"band","x-numUpcomingEvents":12},{id:"dead-company-1",name:"Dead & Company",identifier:"jambase:123456",image:"https://picsum.photos/300/300?random=4",genres:["rock","jam band","psychedelic rock"],"x-bandOrMusician":"band","x-numUpcomingEvents":8},{id:"grateful-dead-1",name:"Grateful Dead",identifier:"jambase:789012",image:"https://picsum.photos/300/300?random=5",genres:["rock","jam band","psychedelic rock"],"x-bandOrMusician":"band","x-numUpcomingEvents":0},{id:"tame-impala-1",name:"Tame Impala",identifier:"jambase:345678",image:"https://picsum.photos/300/300?random=6",genres:["psychedelic rock","indie rock","electronic"],"x-bandOrMusician":"band","x-numUpcomingEvents":15},{id:"radiohead-1",name:"Radiohead",identifier:"jambase:901234",image:"https://picsum.photos/300/300?random=7",genres:["alternative rock","electronic","experimental"],"x-bandOrMusician":"band","x-numUpcomingEvents":6},{id:"taylor-swift-1",name:"Taylor Swift",identifier:"jambase:taylor-swift-1",image:"https://picsum.photos/300/300?random=8",genres:["pop","country","folk"],"x-bandOrMusician":"musician","x-numUpcomingEvents":50},{id:"drake-1",name:"Drake",identifier:"jambase:drake-1",image:"https://picsum.photos/300/300?random=9",genres:["hip-hop","r&b","pop"],"x-bandOrMusician":"musician","x-numUpcomingEvents":30},{id:"joe-russo-1",name:"Joe Russo",identifier:"jambase:joe-russo-1",image:"https://picsum.photos/300/300?random=10",genres:["rock","jam band","drummer"],"x-bandOrMusician":"musician","x-numUpcomingEvents":5},{id:"joe-russo-almost-dead-1",name:"Joe Russo's Almost Dead",identifier:"jambase:joe-russo-almost-dead-1",image:"https://picsum.photos/300/300?random=11",genres:["jam band","rock","grateful dead"],"x-bandOrMusician":"band","x-numUpcomingEvents":15}].map(o=>W(M({},o),{match_score:this.calculateFuzzyMatchScore(t,o.name)})).filter(o=>o.match_score>15).sort((o,l)=>l.match_score-o.match_score).slice(0,r);return console.log(` Fallback search for "${t}": ${a.length} matches found`),a}static populateArtistProfiles(t){return E(this,null,function*(){var n,i,a,o,l,c;const r=[];if(!t||t.length===0)return r;for(const d of t)try{const u=((n=d.identifier)==null?void 0:n.split(":")[1])||d.identifier||d.id;if(!u){console.warn(` Skipping artist ${d.name} - no identifier available`);continue}let h=null;try{const{data:g,error:v}=yield P.from("artists_with_external_ids").select("*").eq("jambase_artist_id",u).maybeSingle();g&&!v&&(h=g),v&&(v.code==="PGRST301"||v.status===406||((i=v.message)==null?void 0:i.includes("406"))||((a=v.message)==null?void 0:a.includes("Not Acceptable")))?console.warn(`  406 error checking artist ${d.name}, continuing anyway:`,v.message):v&&v.code!=="PGRST116"&&console.warn(`  Database error checking artist ${d.name}:`,v)}catch(g){console.warn(`  Exception checking artist ${d.name}:`,g)}if(h){console.log(`  Artist ${d.name} already exists in database`),r.push(h);continue}const f={name:d.name,identifier:d.identifier,url:d.url||null,image_url:d.image||null,date_published:new Date().toISOString(),date_modified:new Date().toISOString()};let p=null;try{const{data:g,error:v}=yield P.from("artists_with_external_ids").select("id").eq("jambase_artist_id",u).maybeSingle();g&&!v&&(p=g),v&&(v.code==="PGRST301"||v.status===406||((o=v.message)==null?void 0:o.includes("406"))||((l=v.message)==null?void 0:l.includes("Not Acceptable")))?(console.warn(`  406 error checking artist ${d.name} for update, will try insert:`,v.message),p=null):v&&v.code!=="PGRST116"&&console.warn(`  Error checking artist ${d.name}:`,v)}catch(g){console.warn(`  Exception checking artist ${d.name}:`,g),p=null}let x;if(p){const{data:g,error:v}=yield P.from("artists").update(f).eq("id",p.id).select().maybeSingle();v?(console.error(` Error updating artist ${d.name}:`,v),x=p):(x=g,yield P.from("external_entity_ids").upsert({entity_type:"artist",entity_uuid:x.id,source:"jambase",external_id:u},{onConflict:"entity_uuid,source,entity_type"}).catch(()=>{}))}else{const{data:g,error:v}=yield P.from("artists").insert(f).select().maybeSingle();v?(console.error(` Error inserting artist ${d.name}:`,v),x=null):(x=g,yield P.from("external_entity_ids").insert({entity_type:"artist",entity_uuid:x.id,source:"jambase",external_id:u}).catch(()=>{}))}if(!x){console.error(` Failed to save artist ${d.name}`);continue}console.log(` Saved artist ${d.name} to database`),r.push(x)}catch(u){console.error(` Error processing artist ${d.name}:`,u);const h=((c=d.identifier)==null?void 0:c.split(":")[1])||d.identifier||d.id;if(!h)continue;r.push({id:d.id||h,jambase_artist_id:h,name:d.name,description:d.description||`Artist: ${d.name}`,genres:d.genres||[],image_url:d.image,popularity_score:d["x-numUpcomingEvents"]||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),identifier:d.identifier||h,band_or_musician:d["x-bandOrMusician"]||"band",num_upcoming_events:d["x-numUpcomingEvents"]||0,last_synced_at:new Date().toISOString()});continue}return r})}static fetchFullArtistDetails(t){return E(this,null,function*(){throw new Error("JamBase API removed - use database queries instead")})}static getFuzzyMatchedResults(t,r){return E(this,null,function*(){try{const n=t.trim(),a=n.split(/\s+/).length===1&&n.length>0?`${n}%`:`%${n}%`,{data:o,error:l}=yield P.from("artists").select("id, name, identifier, image_url, genres").ilike("name",a).limit(Math.max(r*5,100));return l?(console.warn(`  Database error getting artists: ${l.message}`),[]):!o||o.length===0?(console.log(" No artists found in database for artist search"),[]):o.filter(u=>typeof u=="object"&&u!==null&&typeof u.id=="string"&&typeof u.name=="string").map(u=>({id:u.id,name:u.name,identifier:u.identifier||`manual:${u.id}`,image_url:u.image_url||void 0,genres:u.genres||[],band_or_musician:"band",num_upcoming_events:0,match_score:this.calculateFuzzyMatchScore(t,u.name),is_from_database:!0})).filter(u=>u.match_score>5).sort((u,h)=>h.match_score-u.match_score).slice(0,r)}catch(n){return console.error(" Error getting fuzzy matched results:",n),[]}})}static calculateFuzzyMatchScore(t,r){const n=t.toLowerCase().trim(),i=r.toLowerCase().trim();if(i===n)return 100;if(i.startsWith(n))return 95;if(i.includes(n)){const h=n.length/i.length;return h>=.3?85+Math.round(h*10):70+Math.round(h*15)}const a=n.split(/[\s']+/).filter(h=>h.length>0),o=i.split(/[\s']+/).filter(h=>h.length>0);if(a.length>1){let h=0;for(const f of a)o.includes(f)&&h++;if(h>=Math.ceil(a.length*.5))return 80+h/a.length*15}if(a.length===1&&o.includes(a[0]))return 85;let l=0;for(const h of a)for(const f of o)if(f.includes(h)||h.includes(f)){l++;break}if(l>0)return 50+l/a.length*30;const c=this.levenshteinDistance(n,i),d=Math.max(n.length,i.length),u=1-c/d;return u>.5?Math.round(u*60):0}static searchAllContent(t,r=20,n=!1){return E(this,null,function*(){try{console.log(` Searching all content for: "${t}" with limit: ${r} (useApi: ${n})`),console.log(` Searching artists with limit: ${Math.floor(r*.5)}`);const i=yield this.searchArtists(t,Math.floor(r*.5),n);console.log(` Searching events with limit: ${Math.floor(r*.3)}`);const a=yield this.searchEvents(t,Math.floor(r*.3));console.log(` Searching users with limit: ${Math.floor(r*.2)}`);const o=yield this.searchUsers(t,Math.floor(r*.2));return console.log(" Search results summary:",{artists:i.length,events:a.length,users:o.length}),{artists:i,events:a,users:o}}catch(i){return console.error(" Error searching all content:",i),{artists:[],events:[],users:[]}}})}static searchEvents(t,r){return E(this,null,function*(){try{console.log(` Searching events for: "${t}" with limit: ${r}`);const{data:n,error:i}=yield P.from("events").select("*").or(`artist_name.ilike.%${t}%,venue_name.ilike.%${t}%,title.ilike.%${t}%`).order("event_date",{ascending:!0}).limit(r);return i?(console.warn("  Error searching events:",i),[]):(console.log(` Found ${(n==null?void 0:n.length)||0} events:`,n==null?void 0:n.map(a=>a.title||a.artist_name)),n||[])}catch(n){return console.error(" Error searching events:",n),[]}})}static searchUsers(t,r){return E(this,null,function*(){try{console.log(` Searching users for: "${t}" with limit: ${r}`);const{data:n,error:i}=yield P.from("users").select("user_id, name, bio, avatar_url, instagram_handle").or(`name.ilike.%${t}%,bio.ilike.%${t}%,instagram_handle.ilike.%${t}%`).order("created_at",{ascending:!1}).limit(r);return i?(console.warn("  Error searching users:",i),[]):(console.log(` Found ${(n==null?void 0:n.length)||0} users:`,n==null?void 0:n.map(a=>a.name)),n||[])}catch(n){return console.error(" Error searching users:",n),[]}})}static levenshteinDistance(t,r){const n=Array(r.length+1).fill(null).map(()=>Array(t.length+1).fill(null));for(let i=0;i<=t.length;i++)n[0][i]=i;for(let i=0;i<=r.length;i++)n[i][0]=i;for(let i=1;i<=r.length;i++)for(let a=1;a<=t.length;a++){const o=t[a-1]===r[i-1]?0:1;n[i][a]=Math.min(n[i][a-1]+1,n[i-1][a]+1,n[i-1][a-1]+o)}return n[r.length][t.length]}static getArtistSuggestions(t,r=10){return E(this,null,function*(){return this.searchArtists(t,r)})}static getArtistById(t){return E(this,null,function*(){const{data:r,error:n}=yield P.from("artists_with_external_ids").select("*").eq("jambase_artist_id",t).maybeSingle();if(n){if(n.code==="PGRST116")return null;throw new Error(`Database error: ${n.message}`)}return r})}static getAllArtists(t=50){return E(this,null,function*(){const{data:r,error:n}=yield P.from("artists").select("*").order("created_at",{ascending:!1}).limit(t);if(n)throw new Error(`Database error: ${n.message}`);return r||[]})}static clearAllArtists(){return E(this,null,function*(){const{error:t}=yield P.from("artists").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw new Error(`Database error: ${t.message}`)})}static testJamBaseAPI(){return E(this,null,function*(){return{success:!1,message:"JamBase API has been removed. Use database queries instead."}})}}const wce=Object.freeze(Object.defineProperty({__proto__:null,UnifiedArtistSearchService:Av},Symbol.toStringTag,{value:"Module"}));function TE({onArtistSelect:e,placeholder:t="Search for an artist...",className:r,hideClearButton:n=!1,onSearchStateChange:i}){const[a,o]=y.useState(""),[l,c]=y.useState(null),[d,u]=y.useState(!1),[h,f]=y.useState(!1),[p,x]=y.useState(-1),g=y.useRef(null),v=y.useRef(null);y.useEffect(()=>{if(!a.trim()){c(null),f(!1),i==null||i(!1);return}const A=setTimeout(()=>E(this,null,function*(){yield _(a)}),300);return()=>clearTimeout(A)},[a]),y.useEffect(()=>{const A=T=>{if(!(!h||!l))switch(T.key){case"ArrowDown":T.preventDefault(),x($=>$<l.artists.length-1?$+1:$);break;case"ArrowUp":T.preventDefault(),x($=>$>0?$-1:-1);break;case"Enter":T.preventDefault(),p>=0&&p<l.artists.length&&w(l.artists[p]);break;case"Escape":f(!1),x(-1);break}};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[h,l,p]),y.useEffect(()=>{if(p>=0&&v.current){const A=v.current.children[p];A&&A.scrollIntoView({block:"nearest"})}},[p]);const _=A=>E(this,null,function*(){try{u(!0);const T=yield Av.searchArtists(A,10),$={artists:T.map(R=>{var F;return{id:R.id,jambase_artist_id:((F=R.identifier)==null?void 0:F.replace("jambase:",""))||R.id,name:R.name,description:`${R.num_upcoming_events||0} upcoming events`,genres:R.genres||[],image_url:R.image_url,popularity_score:R.num_upcoming_events||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),source:R.is_from_database?"database":"jambase"}}),totalFound:T.length,query:A};c($),f(!0),x(-1),i==null||i(!0)}catch(T){console.error("Artist search error:",T),c({artists:[],totalFound:0,query:A}),f(!0)}finally{u(!1)}}),w=A=>{var T;try{wn.click("artist",A.id||A.jambase_artist_id||A.name,{source:"artist_search_box",name:A.name})}catch($){}e(A),o(A.name),f(!1),x(-1),i==null||i(!1),(T=g.current)==null||T.blur()},b=A=>{o(A.target.value)},N=()=>{l&&l.artists.length>0&&f(!0)},S=()=>{setTimeout(()=>{f(!1),x(-1),i==null||i(!1)},150)},k=()=>{var A;o(""),c(null),f(!1),x(-1),i==null||i(!1),(A=g.current)==null||A.focus()},O=(A=[])=>A.slice(0,3).join(", ");return s.jsxs("div",{className:ke("relative w-full",r),children:[s.jsxs("div",{className:"relative",children:[s.jsx(Mi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx(or,{id:"artist-search-input",name:"artistSearch",ref:g,type:"text",placeholder:t,value:a,onChange:b,onFocus:N,onBlur:S,className:"pl-10 pr-20 border-2 border-synth-pink focus:border-synth-pink focus:ring-2 focus:ring-synth-pink/20 rounded-lg",autoComplete:"off"}),s.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[d&&s.jsx(er,{className:"w-4 h-4 animate-spin text-gray-400"}),a&&!d&&!n&&s.jsx(oe,{type:"button",variant:"ghost",size:"sm",onClick:k,className:"h-6 w-6 p-0 hover:bg-gray-100",children:s.jsx(pr,{className:"w-3 h-3"})})]})]}),h&&l&&s.jsx("div",{className:"absolute top-full left-0 right-0 z-[9999] mt-2 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",children:l.artists.length>0?s.jsxs("div",{ref:v,className:"max-h-[min(500px,calc(100vh-300px))] overflow-y-auto overscroll-contain synth-scrollbar",style:{scrollBehavior:"smooth"},children:[l.artists.map((A,T)=>s.jsxs("div",{className:ke("relative px-4 py-3 cursor-pointer transition-all duration-150","flex items-center gap-3","hover:bg-gray-50",p===T&&"bg-blue-50"),onClick:()=>w(A),onMouseEnter:()=>x(T),children:[p===T&&s.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-blue-500 rounded-r"}),s.jsx("div",{className:"flex-shrink-0",children:A.image_url?s.jsx("img",{src:A.image_url,alt:A.name,className:"w-12 h-12 rounded-full object-cover ring-2 ring-gray-100"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-pink-100 to-purple-100 flex items-center justify-center ring-2 ring-gray-100",children:s.jsx(Ct,{className:"w-6 h-6 text-pink-500"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm leading-tight truncate",children:A.name}),A.genres&&A.genres.length>0&&s.jsx("p",{className:"text-xs text-gray-500 mt-0.5 truncate",children:O(A.genres)})]})]},A.id)),l.totalFound>l.artists.length&&s.jsxs("div",{className:"sticky bottom-0 px-4 py-2 text-xs text-gray-500 text-center bg-gray-50 border-t border-gray-200",children:["Showing ",l.artists.length," of ",l.totalFound," artists"]})]}):s.jsxs("div",{className:"px-6 py-12 text-center text-gray-500",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:s.jsx(Ct,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No artists found"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Try a different search term"})]})})]})}class mF{static searchVenues(t,r=20,n=!1){return E(this,null,function*(){if(!t||t.length<2)return[];try{console.log(` Searching for venues: "${t}" (useApi: ${n})`);let i=[];try{i=yield this.getFuzzyMatchedResults(t,r),console.log(` Found ${i.length} venues from local database`)}catch(a){console.warn("  Could not get fuzzy results from database:",a)}if(!n)return console.log(` Returning ${i.length} results from local database (no API call)`),i;console.log(" Explicit search triggered - searching for new venues in database...");try{i=yield this.getFuzzyMatchedResults(t,r),console.log(` Final database results: ${i.length}`)}catch(a){console.warn("  Could not get final results from database:",a)}return i.length>0?i:(console.log(" No venues found in database"),[])}catch(i){return console.error(" Error in venue search:",i),[]}})}static searchJamBaseAPI(t,r){return E(this,null,function*(){return[]})}static getFallbackVenues(t,r){const n=[{id:"madison-square-garden",name:"Madison Square Garden",identifier:"jambase:msg-1",image:"https://picsum.photos/300/300?random=1",address:{streetAddress:"4 Pennsylvania Plaza",addressLocality:"New York",addressRegion:"NY",postalCode:"10001",addressCountry:"US"},geo:{latitude:40.7505,longitude:-73.9934},maximumAttendeeCapacity:20789,num_upcoming_events:25},{id:"hollywood-bowl",name:"Hollywood Bowl",identifier:"jambase:hb-1",image:"https://picsum.photos/300/300?random=2",address:{streetAddress:"2301 N Highland Ave",addressLocality:"Los Angeles",addressRegion:"CA",postalCode:"90068",addressCountry:"US"},geo:{latitude:34.1122,longitude:-118.339},maximumAttendeeCapacity:17500,num_upcoming_events:30},{id:"the-factory",name:"The Factory",identifier:"jambase:factory-1",image:"https://picsum.photos/300/300?random=3",address:{streetAddress:"123 Factory St",addressLocality:"St. Louis",addressRegion:"MO",postalCode:"63101",addressCountry:"US"},geo:{latitude:38.627,longitude:-90.1994},maximumAttendeeCapacity:2500,num_upcoming_events:15},{id:"red-rocks",name:"Red Rocks Amphitheatre",identifier:"jambase:rr-1",image:"https://picsum.photos/300/300?random=4",address:{streetAddress:"18300 W Alameda Pkwy",addressLocality:"Morrison",addressRegion:"CO",postalCode:"80465",addressCountry:"US"},geo:{latitude:39.6654,longitude:-105.2056},maximumAttendeeCapacity:9525,num_upcoming_events:40},{id:"brooklyn-bowl",name:"Brooklyn Bowl",identifier:"jambase:bb-1",image:"https://picsum.photos/300/300?random=5",address:{streetAddress:"61 Wythe Ave",addressLocality:"Brooklyn",addressRegion:"NY",postalCode:"11249",addressCountry:"US"},geo:{latitude:40.7214,longitude:-73.9575},maximumAttendeeCapacity:1200,num_upcoming_events:15},{id:"the-fillmore",name:"The Fillmore",identifier:"jambase:tf-1",image:"https://picsum.photos/300/300?random=6",address:{streetAddress:"1805 Geary Blvd",addressLocality:"San Francisco",addressRegion:"CA",postalCode:"94115",addressCountry:"US"},geo:{latitude:37.7849,longitude:-122.4334},maximumAttendeeCapacity:1250,num_upcoming_events:20},{id:"house-of-blues",name:"House of Blues",identifier:"jambase:hob-1",image:"https://picsum.photos/300/300?random=7",address:{streetAddress:"225 Decatur St",addressLocality:"New Orleans",addressRegion:"LA",postalCode:"70130",addressCountry:"US"},geo:{latitude:29.9584,longitude:-90.0644},maximumAttendeeCapacity:1e3,num_upcoming_events:18},{id:"radio-city-music-hall",name:"Radio City Music Hall",identifier:"jambase:rcmh-1",image:"https://picsum.photos/300/300?random=8",address:{streetAddress:"1260 6th Ave",addressLocality:"New York",addressRegion:"NY",postalCode:"10020",addressCountry:"US"},geo:{latitude:40.76,longitude:-73.9798},maximumAttendeeCapacity:6e3,num_upcoming_events:12},{id:"the-greek-theatre",name:"The Greek Theatre",identifier:"jambase:tgt-1",image:"https://picsum.photos/300/300?random=9",address:{streetAddress:"2700 N Vermont Ave",addressLocality:"Los Angeles",addressRegion:"CA",postalCode:"90027",addressCountry:"US"},geo:{latitude:34.1183,longitude:-118.3003},maximumAttendeeCapacity:5900,num_upcoming_events:22}],i=n.filter(a=>{var o,l,c,d;return a.name.toLowerCase().includes(t.toLowerCase())||((l=(o=a.address)==null?void 0:o.addressLocality)==null?void 0:l.toLowerCase().includes(t.toLowerCase()))||((d=(c=a.address)==null?void 0:c.addressRegion)==null?void 0:d.toLowerCase().includes(t.toLowerCase()))});return i.length===0?n.slice(0,r):i.slice(0,r)}static populateVenueProfiles(t){return E(this,null,function*(){var n,i,a,o,l,c,d,u,h;const r=[];if(!t||t.length===0)return r;for(const f of t)try{const p=((n=f.identifier)==null?void 0:n.split(":")[1])||f.identifier,{data:x,error:g}=yield P.from("venues_with_external_ids").select("*").eq("jambase_venue_id",p).maybeSingle();if(x&&!g){console.log(`  Venue ${f.name} already exists in database`),r.push(W(M({},x),{address:{streetAddress:x.address,addressLocality:x.city,addressRegion:x.state,postalCode:x.zip,addressCountry:x.country},geo:{latitude:x.latitude,longitude:x.longitude}}));continue}if(g&&(g.code==="PGRST116"||g.code==="42P01")){console.warn(`  venues table doesn't exist yet. Skipping database operations for ${f.name}`),r.push({id:f.id,jambase_venue_id:p,name:f.name,address:f.address,geo:f.geo,maximum_attendee_capacity:f.maximumAttendeeCapacity,num_upcoming_events:f["x-numUpcomingEvents"]||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),identifier:f.identifier});continue}if(g){console.warn(`  Database error checking venue ${f.name}:`,g),r.push({id:f.id,jambase_venue_id:p,name:f.name,address:f.address,geo:f.geo,maximum_attendee_capacity:f.maximumAttendeeCapacity,num_upcoming_events:f["x-numUpcomingEvents"]||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),identifier:f.identifier});continue}const v={name:f.name,identifier:f.identifier,address:((i=f.address)==null?void 0:i.streetAddress)||null,city:((a=f.address)==null?void 0:a.addressLocality)||null,state:((o=f.address)==null?void 0:o.addressRegion)||null,zip:((l=f.address)==null?void 0:l.postalCode)||null,country:((c=f.address)==null?void 0:c.addressCountry)||"US",latitude:((d=f.geo)==null?void 0:d.latitude)||null,longitude:((u=f.geo)==null?void 0:u.longitude)||null,image_url:f.image,url:f.url,date_published:new Date().toISOString(),date_modified:new Date().toISOString()},{data:_}=yield P.from("venues_with_external_ids").select("id").eq("jambase_venue_id",f.id).maybeSingle();let w;if(_){const{data:b,error:N}=yield P.from("venues").update(v).eq("id",_.id).select().single();N?(console.error(` Error updating venue ${f.name}:`,N),w=_):(w=b,yield P.from("external_entity_ids").upsert({entity_type:"venue",entity_uuid:w.id,source:"jambase",external_id:p},{onConflict:"entity_uuid,source,entity_type"}).catch(()=>{}))}else{const{data:b,error:N}=yield P.from("venues").insert(v).select().single();N?(console.error(` Error inserting venue ${f.name}:`,N),w=null):(w=b,yield P.from("external_entity_ids").insert({entity_type:"venue",entity_uuid:w.id,source:"jambase",external_id:p}).catch(()=>{}))}if(!w){console.error(` Failed to save venue ${f.name}`);continue}console.log(` Saved venue ${f.name} to database`),r.push(W(M({},w),{address:{streetAddress:w.address,addressLocality:w.city,addressRegion:w.state,postalCode:w.zip,addressCountry:w.country},geo:{latitude:w.latitude,longitude:w.longitude}}))}catch(p){console.error(` Error processing venue ${f.name}:`,p),r.push({id:f.id,jambase_venue_id:((h=f.identifier)==null?void 0:h.split(":")[1])||f.identifier,name:f.name,address:f.address,geo:f.geo,maximum_attendee_capacity:f.maximumAttendeeCapacity,num_upcoming_events:f["x-numUpcomingEvents"]||0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),identifier:f.identifier,last_synced_at:new Date().toISOString()});continue}return r})}static getFuzzyMatchedResults(t,r){return E(this,null,function*(){try{const n=t.trim(),a=n.split(/\s+/).length===1&&n.length>0?`${n}%`:`%${n}%`,{data:o,error:l}=yield P.from("venues").select("*").ilike("name",a).order("num_upcoming_events",{ascending:!1,nullsFirst:!1}).limit(Math.max(r*5,100));return l?(l.code==="PGRST116"||l.code==="42P01"?console.warn("  venues table doesn't exist yet. Returning empty results for fuzzy matching."):console.warn(`  Database error getting venues: ${l.message}`),[]):!o||o.length===0?(console.log(" No venues found in database"),[]):Array.isArray(o)?o.filter(u=>typeof u=="object"&&u!==null&&typeof u.id=="string"&&typeof u.name=="string").map(u=>({id:u.id,name:u.name,identifier:u.identifier||`manual:${u.id}`,image_url:u.image_url||void 0,address:{streetAddress:u.street_address||void 0,addressLocality:void 0,addressRegion:u.state||void 0,postalCode:u.zip||void 0,addressCountry:u.country||void 0},geo:(()=>{if(u.geo)try{if(typeof u.geo=="object"&&u.geo!==null)return{latitude:u.geo.latitude||u.latitude,longitude:u.geo.longitude||u.longitude};if(typeof u.geo=="string"){const h=JSON.parse(u.geo);return{latitude:h.latitude||u.latitude,longitude:h.longitude||u.longitude}}}catch(h){}if(u.latitude&&u.longitude)return{latitude:u.latitude,longitude:u.longitude}})(),maximumAttendeeCapacity:u.maximum_attendee_capacity||void 0,num_upcoming_events:u.num_upcoming_events||0,match_score:this.calculateFuzzyMatchScore(t,u.name),is_from_database:!0})).filter(u=>u.match_score>5).sort((u,h)=>h.match_score!==u.match_score?h.match_score-u.match_score:(h.num_upcoming_events||0)-(u.num_upcoming_events||0)).slice(0,r):(console.warn("  Invalid venue data received from database"),[])}catch(n){return console.error(" Error getting fuzzy matched results:",n),[]}})}static calculateFuzzyMatchScore(t,r){const n=t.toLowerCase().trim(),i=r.toLowerCase().trim();if(i===n)return 100;if(i.startsWith(n))return 95;const a=n.split(/\s+/),o=i.split(/\s+/);let l=0;for(const f of a)o.includes(f)&&l++;if(l>0)return 85+l/a.length*10;if(i.includes(n))return 75;let c=0;for(const f of a)for(const p of o)if(p.includes(f)||f.includes(p)){c++;break}if(c>0)return 60+c/a.length*15;const d=this.levenshteinDistance(n,i),u=Math.max(n.length,i.length),h=1-d/u;return Math.round(h*50)}static levenshteinDistance(t,r){const n=Array(r.length+1).fill(null).map(()=>Array(t.length+1).fill(null));for(let i=0;i<=t.length;i++)n[0][i]=i;for(let i=0;i<=r.length;i++)n[i][0]=i;for(let i=1;i<=r.length;i++)for(let a=1;a<=t.length;a++){const o=t[a-1]===r[i-1]?0:1;n[i][a]=Math.min(n[i][a-1]+1,n[i-1][a]+1,n[i-1][a-1]+o)}return n[r.length][t.length]}static getVenueSuggestions(t,r=10){return E(this,null,function*(){return this.searchVenues(t,r)})}}function pF({onVenueSelect:e,placeholder:t="Search for a venue...",className:r,hideClearButton:n=!1,onSearchStateChange:i}){const[a,o]=y.useState(""),[l,c]=y.useState([]),[d,u]=y.useState(!1),[h,f]=y.useState(!1),[p,x]=y.useState(-1),g=y.useRef(null),v=y.useRef(null),_=y.useRef(null);y.useEffect(()=>{if(!a.trim()){c([]),f(!1),i==null||i(!1);return}const T=setTimeout(()=>E(this,null,function*(){yield w(a)}),300);return()=>clearTimeout(T)},[a]),y.useEffect(()=>{const T=$=>{if(!(!h||!l))switch($.key){case"ArrowDown":$.preventDefault(),x(R=>R<l.length-1?R+1:R);break;case"ArrowUp":$.preventDefault(),x(R=>R>0?R-1:-1);break;case"Enter":$.preventDefault(),p>=0&&p<l.length&&b(l[p]);break;case"Escape":f(!1),x(-1);break}};return document.addEventListener("keydown",T),()=>document.removeEventListener("keydown",T)},[h,l,p]),y.useEffect(()=>{if(p>=0&&v.current){const T=v.current.children[p];T&&T.scrollIntoView({block:"nearest"})}},[p]);const w=T=>E(this,null,function*(){try{u(!0);const $=yield mF.searchVenues(T,10);c($),f(!0),x(-1),i==null||i(!0)}catch($){console.error("Venue search error:",$),c([]),f(!0)}finally{u(!1)}}),b=T=>{var $,R,F;try{wn.click("venue",T.id||T.identifier||T.name,{source:"venue_search_box",name:T.name,city:($=T.address)==null?void 0:$.addressLocality,state:(R=T.address)==null?void 0:R.addressRegion})}catch(D){}e(T),o(T.name),f(!1),x(-1),i==null||i(!1),(F=g.current)==null||F.blur()};y.useEffect(()=>{const T=$=>{const R=$.target,F=_.current;F&&!F.contains(R)&&(f(!1),x(-1),i==null||i(!1))};if(h){const $=setTimeout(()=>{document.addEventListener("mousedown",T)},100);return()=>{clearTimeout($),document.removeEventListener("mousedown",T)}}},[h]);const N=T=>{o(T.target.value)},S=()=>{l&&l.length>0&&f(!0)},k=T=>{var R;const $=T.relatedTarget;$&&((R=v.current)!=null&&R.contains($))||setTimeout(()=>{f(!1),x(-1),i==null||i(!1)},100)},O=()=>{var T;o(""),c([]),f(!1),x(-1),i==null||i(!1),(T=g.current)==null||T.focus()},A=T=>{var R,F;const $=[];return(R=T.address)!=null&&R.addressLocality&&$.push(T.address.addressLocality),(F=T.address)!=null&&F.addressRegion&&$.push(T.address.addressRegion),$.join(", ")};return s.jsxs("div",{ref:_,className:ke("relative w-full",r),children:[s.jsxs("div",{className:"relative",children:[s.jsx(Mi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx(or,{id:"venue-search-input",name:"venueSearch",ref:g,type:"text",placeholder:t,value:a,onChange:N,onFocus:S,onBlur:k,className:"pl-10 pr-20 border-2 border-synth-pink focus:border-synth-pink focus:ring-2 focus:ring-synth-pink/20 rounded-lg",autoComplete:"off"}),s.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[d&&s.jsx(er,{className:"w-4 h-4 animate-spin text-gray-400"}),a&&!d&&!n&&s.jsx(oe,{type:"button",variant:"ghost",size:"sm",onClick:O,className:"h-6 w-6 p-0 hover:bg-gray-100",children:s.jsx(pr,{className:"w-3 h-3"})})]})]}),h&&l&&s.jsx("div",{className:"absolute top-full left-0 right-0 z-[9999] mt-2 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",children:l.length>0?s.jsx("div",{ref:v,className:"max-h-[min(500px,calc(100vh-300px))] overflow-y-auto overscroll-contain synth-scrollbar",style:{scrollBehavior:"smooth"},children:l.map((T,$)=>s.jsxs("div",{className:ke("relative px-4 py-3 cursor-pointer transition-all duration-150","flex items-center gap-3","hover:bg-gray-50",p===$&&"bg-blue-50"),onClick:R=>{R.preventDefault(),R.stopPropagation(),b(T)},onMouseDown:R=>{R.preventDefault(),R.stopPropagation()},onMouseEnter:()=>x($),children:[p===$&&s.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-blue-500 rounded-r"}),s.jsx("div",{className:"flex-shrink-0",children:T.image_url?s.jsx("img",{src:T.image_url,alt:T.name,className:"w-12 h-12 rounded-full object-cover ring-2 ring-gray-100"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-100 to-indigo-100 flex items-center justify-center ring-2 ring-gray-100",children:s.jsx(Xt,{className:"w-6 h-6 text-blue-500"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm leading-tight truncate",children:T.name}),A(T)&&s.jsx("p",{className:"text-xs text-gray-500 mt-0.5 truncate",children:A(T)})]})]},T.id))}):s.jsxs("div",{className:"px-6 py-12 text-center text-gray-500",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:s.jsx(Xt,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No venues found"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Try a different search term"})]})})]})}const OE=e=>{const t=new Date(e),r=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=new Date(r.getFullYear(),r.getMonth(),r.getDate());return n>=i?"upcoming":"past"},J7=e=>OE(e)==="past",gF=(e,t)=>e.filter(r=>OE(r.event_date)===t),bce=e=>gF(e,"upcoming"),jce=e=>gF(e,"past");function Sj({formData:e,errors:t,onUpdateFormData:r,onClose:n}){const[i,a]=Q.useState(""),[o,l]=Q.useState([]),[c,d]=Q.useState(!1),[u,h]=Q.useState(!1);Q.useEffect(()=>{const N=setTimeout(()=>E(this,null,function*(){const S=i.trim();if(S.length<2){l([]);return}try{d(!0);const{data:k,error:O}=yield P.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date, artist_id, venue_id").or(`artist_name_normalized.ilike.%${S}%,title.ilike.%${S}%,venue_name_normalized.ilike.%${S}%`).order("event_date",{ascending:!1}).limit(50);if(!O&&k){const T=k.filter($=>J7($.event_date)).sort(($,R)=>new Date(R.event_date).getTime()-new Date($.event_date).getTime());l(T),h(!0)}else l([]),h(!1)}finally{d(!1)}}),300);return()=>clearTimeout(N)},[i]);const f=N=>E(this,null,function*(){const S=N!=null&&N.event_date?String(N.event_date).split("T")[0]:"",k=(N==null?void 0:N.artist_name_normalized)||(N==null?void 0:N.artist_name),O=k?{id:N.artist_id||`manual-${k}`,name:k,is_from_database:!!N.artist_id}:null;let A=null;const T=(N==null?void 0:N.venue_name_normalized)||(N==null?void 0:N.venue_name);if(T)try{if(N.venue_id){const{data:R}=yield P.from("venues").select("id, name, identifier").eq("id",N.venue_id).single();R&&(A={id:R.id,name:R.name,identifier:R.identifier,is_from_database:!0})}A||(A={id:N.venue_id||`manual-${T}`,name:T,is_from_database:!!N.venue_id})}catch(R){console.error("Error looking up venue:",R);const F=(N==null?void 0:N.venue_name_normalized)||(N==null?void 0:N.venue_name)||"Unknown Venue";A={id:N.venue_id||`manual-${F}`,name:F,is_from_database:!1}}const $={reviewType:"event"};O&&($.selectedArtist=O),A&&($.selectedVenue=A),S&&($.eventDate=S),r($),h(!1),O&&_(!0),A&&b(!0)}),p=N=>{console.log(" Artist selected in EventDetailsStep:",{name:N.name,id:N.id}),r({selectedArtist:N}),_(!0)},x=N=>{console.log(" Venue selected in EventDetailsStep:",{name:N.name,id:N.id,is_from_database:N.is_from_database,identifier:N.identifier}),console.log(" Before update - formData.selectedVenue:",e.selectedVenue),console.log(" Before update - venueLocked:",w),r({selectedVenue:N}),console.log(" After update - setting venueLocked to true"),b(!0)},g=N=>{r({eventDate:N.target.value})},[v,_]=Q.useState(!!e.selectedArtist),[w,b]=Q.useState(!!e.selectedVenue);return console.log(" EventDetailsStep: Debug:",{hasSelectedArtist:!!e.selectedArtist,artistLocked:v,shouldShowButton:!e.selectedArtist||!v,hasSetlist:!!e.selectedSetlist}),Q.useEffect(()=>{e.selectedArtist?_(!0):_(!1)},[e.selectedArtist]),Q.useEffect(()=>{e.selectedVenue?b(!0):b(!1)},[e.selectedVenue]),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Ut,{className:"text-sm font-medium",children:"Quick search existing event (optional)"}),n&&s.jsx(oe,{variant:"ghost",size:"sm",onClick:n,className:"h-8 w-8 p-0","aria-label":"Close",children:s.jsx(pr,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"relative",children:[s.jsx(or,{placeholder:"Search by artist, event title, or venue...","aria-label":"Quick search existing event",value:i,onChange:N=>a(N.target.value),onFocus:()=>{o.length>0&&h(!0)}}),u&&(o.length>0||c)&&s.jsxs("div",{className:"absolute z-20 mt-1 w-full max-h-64 overflow-auto rounded-md border bg-white shadow",children:[c&&s.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"Searching"}),!c&&o.map(N=>(OE(N.event_date),J7(N.event_date),s.jsxs("button",{type:"button",className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50 border-l-4 border-l-green-500 bg-green-50/30",onClick:()=>f(N),children:[s.jsx("div",{className:"font-medium text-gray-900",children:N.title||`${N.artist_name_normalized||N.artist_name||"Artist"} @ ${N.venue_name_normalized||N.venue_name||"Venue"}`}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center justify-between",children:[s.jsxs("span",{children:[N.artist_name_normalized||N.artist_name||"Artist","  ",N.venue_name_normalized||N.venue_name||"Venue","  ",new Date(N.event_date).toLocaleDateString()]}),s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Past Event"})]})]},N.id))),!c&&o.length===0&&s.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No past events found"})]})]})]}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Event Details"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Tell us about the concert you attended"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-start",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"artist",className:"text-sm font-medium",children:"Artist or Band *"}),!e.selectedArtist||!v?s.jsx(TE,{onArtistSelect:p,placeholder:"Search for an artist or band...",className:"w-full",hideClearButton:!!e.selectedArtist}):s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200",children:[s.jsx("div",{children:s.jsx("p",{className:"text-sm font-medium text-green-800",children:e.selectedArtist.name})}),s.jsx("button",{className:"text-xs text-red-600",onClick:()=>{r({selectedArtist:null}),_(!1)},children:""})]})}),t.selectedArtist&&s.jsx("p",{className:"text-sm text-red-600",children:t.selectedArtist})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"venue",className:"text-sm font-medium",children:"Venue *"}),(()=>{var N;return console.log(" Venue render check:",{hasSelectedVenue:!!e.selectedVenue,venueLocked:w,selectedVenueName:(N=e.selectedVenue)==null?void 0:N.name,shouldShowSearch:!e.selectedVenue||!w}),null})(),!e.selectedVenue||!w?s.jsx(pF,{onVenueSelect:x,placeholder:"Search for a venue...",className:"w-full",hideClearButton:!!e.selectedVenue}):s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-green-800",children:e.selectedVenue.name}),e.selectedVenue.address&&s.jsx("p",{className:"text-xs text-green-700",children:[e.selectedVenue.address.addressLocality,e.selectedVenue.address.addressRegion].filter(Boolean).join(", ")})]}),s.jsx("button",{className:"text-xs text-red-600",onClick:()=>{r({selectedVenue:null}),b(!1)},children:""})]}),t.selectedVenue&&s.jsx("p",{className:"text-sm text-red-600",children:t.selectedVenue})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ut,{htmlFor:"eventDate",className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(Et,{className:"w-4 h-4"}),"Date *"]}),s.jsx(or,{id:"eventDate",type:"date",value:e.eventDate,onChange:g,className:"w-full",max:new Date().toISOString().split("T")[0]}),t.eventDate&&s.jsx("p",{className:"text-sm text-red-600",children:t.eventDate})]})]}),e.selectedArtist&&e.selectedVenue&&e.eventDate&&s.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[s.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Event Summary"}),s.jsxs("div",{className:"text-sm text-blue-800",children:[s.jsx("p",{children:s.jsx("button",{className:"font-bold hover:text-blue-600 hover:underline cursor-pointer",onClick:N=>{var k,O;N.preventDefault(),N.stopPropagation();const S=new CustomEvent("open-artist-card",{detail:{artistId:(k=e.selectedArtist)==null?void 0:k.id,artistName:(O=e.selectedArtist)==null?void 0:O.name}});document.dispatchEvent(S)},"aria-label":`View artist ${e.selectedArtist.name}`,children:e.selectedArtist.name})}),s.jsxs("p",{children:["at"," ",s.jsx("button",{className:"font-bold hover:text-blue-600 hover:underline cursor-pointer",onClick:N=>{var k,O;N.preventDefault(),N.stopPropagation();const S=new CustomEvent("open-venue-card",{detail:{venueId:(k=e.selectedVenue)==null?void 0:k.id,venueName:(O=e.selectedVenue)==null?void 0:O.name}});document.dispatchEvent(S)},"aria-label":`View venue ${e.selectedVenue.name}`,children:e.selectedVenue.name})]}),s.jsxs("p",{children:["on ",new Date(e.eventDate+"T12:00:00").toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})]})]})]})]})}const as=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx("textarea",M({className:ke("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r},t))});as.displayName="Textarea";function Yd({config:e,formData:t,errors:r,onUpdateFormData:n,children:i,previousVenueReview:a}){var _;const[o,l]=y.useState(null),c=t[e.ratingKey],d=t[e.feedbackKey],u=(_=o!=null?o:c)!=null?_:0,h=a&&(e.ratingKey==="venueRating"||e.ratingKey==="locationRating"),f=()=>{if(!a||!h)return;const w={};if(e.ratingKey==="venueRating"){const b=a.venue_rating;if(b){const N=typeof b=="number"?b:parseFloat(String(b));!isNaN(N)&&N>0&&(w.venueRating=N)}a.venue_feedback&&(w.venueFeedback=a.venue_feedback)}else if(e.ratingKey==="locationRating"){const b=a.location_rating;if(b){const N=typeof b=="number"?b:parseFloat(String(b));!isNaN(N)&&N>0&&(w.locationRating=N)}a.location_feedback&&(w.locationFeedback=a.location_feedback)}n(w)},p=y.useMemo(()=>u?`${u.toFixed(1)} / 5.0`:"Not rated yet",[u]),x=w=>{n({[e.ratingKey]:w})},g=w=>{const b={};if(!d||d.trim().length===0)b[e.feedbackKey]=w.description||w.label;else{const N=d.trim(),S=w.description||w.label;b[e.feedbackKey]=N+(N?" ":"")+S}n(b)},v=w=>d&&(d.includes(w.label)||d.includes(w.description||""));return s.jsxs("div",{className:"space-y-6 w-full max-w-full overflow-x-hidden",children:[s.jsxs("header",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Step"}),s.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-900 break-words",children:e.title}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 max-w-full mx-auto break-words",children:e.subtitle})]}),s.jsx("section",{className:"bg-gradient-to-br from-pink-50 via-rose-50 to-fuchsia-50 border border-pink-200/60 rounded-2xl p-4 sm:p-6 shadow-sm text-center space-y-4 w-full max-w-full overflow-x-hidden",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-pink-600 font-semibold",children:"Your rating"}),s.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4 flex-wrap",children:[s.jsx("div",{className:"flex items-center flex-shrink-0",onMouseLeave:()=>l(null),children:Array.from({length:5},(w,b)=>{const N=b+1,S=N,k=N-.5,O=u>=S,A=!O&&u===k;return s.jsxs("div",{className:"relative w-8 h-8 sm:w-10 sm:h-10 cursor-pointer flex-shrink-0",children:[s.jsx(Jt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-300"}),(O||A)&&s.jsx("div",{className:ke("absolute left-0 top-0 h-full overflow-hidden pointer-events-none",O?"w-full":"w-1/2"),children:s.jsx(Jt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-pink-500 fill-current"})}),s.jsx("button",{type:"button","aria-label":`Set ${e.title} rating to ${k.toFixed(1)} stars`,className:"absolute left-0 top-0 h-full w-1/2",onMouseEnter:()=>l(k),onFocus:()=>l(k),onBlur:()=>l(null),onClick:()=>x(k)}),s.jsx("button",{type:"button","aria-label":`Set ${e.title} rating to ${S.toFixed(1)} stars`,className:"absolute right-0 top-0 h-full w-1/2",onMouseEnter:()=>l(S),onFocus:()=>l(S),onBlur:()=>l(null),onClick:()=>x(S)})]},b)})}),s.jsx("span",{className:"text-2xl sm:text-3xl font-extrabold text-gray-900 break-words",children:p})]}),e.helperText&&s.jsx("p",{className:"text-xs text-pink-500 break-words",children:e.helperText}),r[e.ratingKey]&&s.jsx("p",{className:"text-xs sm:text-sm text-red-600 break-words",children:r[e.ratingKey]})]})}),h&&s.jsx("section",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4 w-full max-w-full overflow-x-hidden",children:s.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-xs sm:text-sm font-medium text-blue-900 break-words",children:"Copy from previous review at this venue?"}),s.jsx("p",{className:"text-xs text-blue-700 mt-1 break-words",children:"You've reviewed this venue before. Copy your venue and location ratings and feedback."})]}),s.jsxs(oe,{type:"button",variant:"outline",size:"sm",onClick:f,className:"sm:ml-4 border-blue-300 text-blue-700 hover:bg-blue-100 flex-shrink-0",children:[s.jsx(OJ,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),"Copy"]})]})}),s.jsxs("section",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[s.jsx(Ut,{htmlFor:`${e.ratingKey}-feedback`,className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:"Add a quick note (optional)"}),s.jsx(as,{id:`${e.ratingKey}-feedback`,placeholder:"Share any highlights or watch-outs for future fans...",value:d,onChange:w=>n({[e.feedbackKey]:w.target.value}),rows:4,className:"resize-none text-sm sm:text-base w-full max-w-full min-w-0",maxLength:400}),s.jsxs("p",{className:"text-xs text-gray-400 text-right",children:[(d||"").length,"/400"]})]}),s.jsxs("section",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Need inspiration? Tap a vibe:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:e.suggestions.map(w=>s.jsx(oe,{type:"button",variant:v(w)?"default":"outline",className:ke("px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm rounded-full border flex-shrink-0",w.sentiment==="positive"?"border-emerald-200 text-emerald-700 hover:bg-emerald-50":"border-rose-200 text-rose-700 hover:bg-rose-50",v(w)&&"bg-pink-500 text-white hover:bg-pink-600 border-transparent"),onClick:()=>g(w),children:w.label},w.id))})]}),i&&s.jsx("section",{className:"space-y-4 w-full max-w-full overflow-x-hidden",children:i})]})}class Nce{constructor(){_r(this,"DEFAULT_OPTIONS",{maxSizeMB:5,allowedTypes:["image/jpeg","image/jpg","image/png","image/webp","image/heic"],compressionQuality:.8})}uploadPhoto(a,o,l){return E(this,arguments,function*(t,r,n,i={}){var _,w,b;const c=M(M({},this.DEFAULT_OPTIONS),i);if(!((_=c.allowedTypes)!=null&&_.includes(t.type)))throw new Error(`Invalid file type. Allowed types: ${(w=c.allowedTypes)==null?void 0:w.join(", ")}`);const d=(c.maxSizeMB||5)*1024*1024;if(t.size>d)throw new Error(`File size exceeds ${c.maxSizeMB}MB limit. Current size: ${(t.size/1024/1024).toFixed(2)}MB`);const u=yield this.processImage(t,c),h=((b=t.name.split(".").pop())==null?void 0:b.toLowerCase())||"jpg",f=`${Date.now()}-${Math.random().toString(36).substring(7)}.${h}`,p=`${n}/${f}`,{data:x,error:g}=yield P.storage.from(r).upload(p,u,{cacheControl:"3600",upsert:!1});if(g)throw console.error("Upload error:",g),new Error(`Failed to upload photo: ${g.message}`);const{data:{publicUrl:v}}=P.storage.from(r).getPublicUrl(x.path);return{url:v,path:x.path}})}uploadPhotos(a,o,l){return E(this,arguments,function*(t,r,n,i={}){const c=t.map(d=>this.uploadPhoto(d,r,n,i));return Promise.all(c)})}deletePhoto(t,r){return E(this,null,function*(){const{error:n}=yield P.storage.from(t).remove([r]);if(n)throw console.error("Delete error:",n),new Error(`Failed to delete photo: ${n.message}`)})}deletePhotos(t,r){return E(this,null,function*(){const{error:n}=yield P.storage.from(t).remove(r);if(n)throw console.error("Delete error:",n),new Error(`Failed to delete photos: ${n.message}`)})}getPathFromUrl(t,r){try{return new URL(t).pathname.split(`/storage/v1/object/public/${r}/`)[1]||null}catch(n){return null}}processImage(t,r){return E(this,null,function*(){return t.size<5e5||r.compressionQuality===1?t:new Promise((n,i)=>{const a=new FileReader;a.readAsDataURL(t),a.onload=o=>{var c;const l=new Image;l.src=(c=o.target)==null?void 0:c.result,l.onload=()=>{const d=document.createElement("canvas");let u=l.width,h=l.height;const f=1920;(u>f||h>f)&&(u>h?(h=h/u*f,u=f):(u=u/h*f,h=f)),d.width=u,d.height=h;const p=d.getContext("2d");p==null||p.drawImage(l,0,0,u,h),d.toBlob(x=>{x?n(x):i(new Error("Failed to compress image"))},t.type,r.compressionQuality||.8)},l.onerror=()=>i(new Error("Failed to load image"))},a.onerror=()=>i(new Error("Failed to read file"))})})}validateImage(t,r={}){var a,o;const n=M(M({},this.DEFAULT_OPTIONS),r);if(!((a=n.allowedTypes)!=null&&a.includes(t.type)))return{valid:!1,error:`Invalid file type. Please use: ${(o=n.allowedTypes)==null?void 0:o.join(", ")}`};const i=(n.maxSizeMB||5)*1024*1024;return t.size>i?{valid:!1,error:`File too large. Maximum size: ${n.maxSizeMB}MB`}:{valid:!0}}uploadVideo(a,o,l){return E(this,arguments,function*(t,r,n,i={}){var v,_,w;const c=M({maxSizeMB:100,allowedTypes:["video/mp4","video/webm","video/quicktime","video/x-msvideo","video/3gpp","video/x-flv"]},i);if(!((v=c.allowedTypes)!=null&&v.includes(t.type)))throw new Error(`Invalid file type. Allowed types: ${(_=c.allowedTypes)==null?void 0:_.join(", ")}`);const d=(c.maxSizeMB||100)*1024*1024;if(t.size>d)throw new Error(`File size exceeds ${c.maxSizeMB}MB limit. Current size: ${(t.size/1024/1024).toFixed(2)}MB`);const u=((w=t.name.split(".").pop())==null?void 0:w.toLowerCase())||"mp4",h=`${Date.now()}-${Math.random().toString(36).substring(7)}.${u}`,f=`${n}/${h}`,{data:p,error:x}=yield P.storage.from(r).upload(f,t,{cacheControl:"3600",upsert:!1});if(x)throw console.error("Upload error:",x),new Error(`Failed to upload video: ${x.message}`);const{data:{publicUrl:g}}=P.storage.from(r).getPublicUrl(p.path);return{url:g,path:p.path}})}uploadVideos(a,o,l){return E(this,arguments,function*(t,r,n,i={}){const c=t.map(d=>this.uploadVideo(d,r,n,i));return Promise.all(c)})}deleteVideo(t,r){return E(this,null,function*(){const{error:n}=yield P.storage.from(t).remove([r]);if(n)throw console.error("Delete error:",n),new Error(`Failed to delete video: ${n.message}`)})}deleteVideos(t,r){return E(this,null,function*(){const{error:n}=yield P.storage.from(t).remove(r);if(n)throw console.error("Delete error:",n),new Error(`Failed to delete videos: ${n.message}`)})}validateVideo(t,r={}){var a,o;const n=M({maxSizeMB:100,allowedTypes:["video/mp4","video/webm","video/quicktime","video/x-msvideo","video/3gpp","video/x-flv"]},r);if(!((a=n.allowedTypes)!=null&&a.includes(t.type)))return{valid:!1,error:`Invalid file type. Please use: ${(o=n.allowedTypes)==null?void 0:o.join(", ")}`};const i=(n.maxSizeMB||100)*1024*1024;return t.size>i?{valid:!1,error:`File too large. Maximum size: ${n.maxSizeMB}MB`}:{valid:!0}}}const Zi=new Nce;function Sce({value:e=[],onChange:t,userId:r,bucket:n,maxPhotos:i=5,maxSizeMB:a=5,label:o="Photos",helperText:l,className:c,disabled:d=!1}){const[u,h]=y.useState(!1),[f,p]=y.useState(0),x=y.useRef(null),{toast:g}=jr(),v=b=>E(this,null,function*(){const N=Array.from(b.target.files||[]);if(N.length!==0){if(e.length+N.length>i){g({title:"Too many photos",description:`You can only upload up to ${i} photos`,variant:"destructive"});return}for(const S of N){const k=Zi.validateImage(S,{maxSizeMB:a});if(!k.valid){g({title:"Invalid file",description:k.error,variant:"destructive"});return}}h(!0),p(0);try{const S=[];for(let k=0;k<N.length;k++){const O=yield Zi.uploadPhoto(N[k],n,r,{maxSizeMB:a});S.push(O.url),p((k+1)/N.length*100)}t([...e,...S]),g({title:"Upload successful",description:`${N.length} photo${N.length>1?"s":""} uploaded`})}catch(S){console.error("Upload error:",S),g({title:"Upload failed",description:S instanceof Error?S.message:"Failed to upload photos",variant:"destructive"})}finally{h(!1),p(0),x.current&&(x.current.value="")}}}),_=(b,N)=>E(this,null,function*(){try{const S=Zi.getPathFromUrl(b,n);S&&(yield Zi.deletePhoto(n,S));const k=e.filter((O,A)=>A!==N);t(k),g({title:"Photo removed",description:"Photo deleted successfully"})}catch(S){console.error("Delete error:",S),g({title:"Delete failed",description:"Failed to delete photo",variant:"destructive"})}}),w=()=>{var b;(b=x.current)==null||b.click()};return s.jsxs("div",{className:ke("space-y-3",c),children:[o&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium",children:o}),l&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.map((b,N)=>s.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100 group",children:[s.jsx("img",{src:b,alt:`Photo ${N+1}`,className:"w-full h-full object-cover"}),s.jsx("button",{type:"button",onClick:()=>_(b,N),disabled:d||u,className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",children:s.jsx(pr,{className:"w-4 h-4"})})]},b)),e.length<i&&s.jsx("button",{type:"button",onClick:w,disabled:d||u,className:ke("aspect-square rounded-lg border-2 border-dashed border-gray-300 hover:border-gray-400","flex flex-col items-center justify-center gap-2 transition-colors","disabled:opacity-50 disabled:cursor-not-allowed",u&&"border-primary"),children:u?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-6 h-6 animate-spin text-primary"}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[f.toFixed(0),"%"]})]}):s.jsxs(s.Fragment,{children:[s.jsx(x2,{className:"w-6 h-6 text-gray-400"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"Add Photo"})]})})]}),s.jsx("input",{ref:x,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,image/heic",multiple:!0,onChange:v,className:"hidden",disabled:d||u}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.length," / ",i," photos  Max ",a,"MB per photo"]})]})}function kce({value:e,onChange:t,userId:r,bucket:n,maxSizeMB:i=25,label:a="Photo",helperText:o,className:l,disabled:c=!1,aspectRatio:d="square"}){const[u,h]=y.useState(!1),[f,p]=y.useState(!1),x=y.useRef(null),g=y.useRef(null),{toast:v}=jr(),_=()=>{var k;(k=x.current)==null||k.click()},w=()=>{var k;(k=g.current)==null||k.click()},b=k=>E(this,null,function*(){var T;const O=(T=k.target.files)==null?void 0:T[0];if(!O)return;p(!1);const A=Zi.validateImage(O,{maxSizeMB:i});if(!A.valid){v({title:"Invalid file",description:A.error,variant:"destructive"});return}h(!0);try{if(e){const R=Zi.getPathFromUrl(e,n);R&&(yield Zi.deletePhoto(n,R).catch(console.error))}const $=yield Zi.uploadPhoto(O,n,r,{maxSizeMB:i});t($.url),v({title:"Upload successful",description:"Photo uploaded successfully"})}catch($){console.error("Upload error:",$),v({title:"Upload failed",description:$ instanceof Error?$.message:"Failed to upload photo",variant:"destructive"})}finally{h(!1),g.current&&(g.current.value=""),x.current&&(x.current.value="")}}),N=()=>E(this,null,function*(){if(e)try{const k=Zi.getPathFromUrl(e,n);k&&(yield Zi.deletePhoto(n,k)),t(null),v({title:"Photo removed",description:"Photo deleted successfully"})}catch(k){console.error("Delete error:",k),v({title:"Delete failed",description:"Failed to delete photo",variant:"destructive"})}}),S=()=>{var k;(k=g.current)==null||k.click()};return s.jsxs("div",{className:ke("space-y-3",l),children:[a&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium",children:a}),o&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:o})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:ke("relative w-24 h-24 bg-gray-100 overflow-hidden group",d==="circle"?"rounded-full":"rounded-lg"),children:e?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:e,alt:"Upload",className:"w-full h-full object-cover"}),s.jsx("button",{type:"button",onClick:N,disabled:c||u,className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",children:s.jsx(pr,{className:"w-6 h-6 text-white"})})]}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(y2,{className:"w-8 h-8 text-gray-400"})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx(oe,{type:"button",variant:"outline",onClick:S,disabled:c||u,className:"w-full",children:u?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(x2,{className:"w-4 h-4 mr-2"}),e?"Change Photo":"Upload Photo"]})}),o&&s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:o})]})]}),s.jsx("input",{ref:x,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,image/heic",onChange:b,className:"hidden",disabled:c||u,capture:"environment"}),s.jsx("input",{ref:g,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,image/heic",onChange:b,className:"hidden",disabled:c||u}),f&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4 text-center",children:"Choose Photo Source"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(oe,{onClick:_,className:"w-full flex items-center justify-center gap-3 py-3",variant:"outline",disabled:c||u,children:[s.jsx(x2,{className:"w-5 h-5"}),"Take Photo"]}),s.jsxs(oe,{onClick:w,className:"w-full flex items-center justify-center gap-3 py-3",variant:"outline",disabled:c||u,children:[s.jsx(y2,{className:"w-5 h-5"}),"Choose from Gallery"]})]}),s.jsx(oe,{onClick:()=>p(!1),variant:"ghost",className:"w-full mt-4",children:"Cancel"})]})})]})}function Ece({value:e=[],onChange:t,userId:r,bucket:n,maxVideos:i=3,maxSizeMB:a=100,label:o="Videos",helperText:l,className:c,disabled:d=!1}){const[u,h]=y.useState(!1),[f,p]=y.useState(0),x=y.useRef(null),{toast:g}=jr(),v=b=>E(this,null,function*(){const N=Array.from(b.target.files||[]);if(N.length!==0){if(e.length+N.length>i){g({title:"Too many videos",description:`You can only upload up to ${i} videos`,variant:"destructive"});return}for(const S of N){const k=Zi.validateVideo(S,{maxSizeMB:a});if(!k.valid){g({title:"Invalid file",description:k.error,variant:"destructive"});return}}h(!0),p(0);try{const S=[];for(let k=0;k<N.length;k++){const O=yield Zi.uploadVideo(N[k],n,r,{maxSizeMB:a});S.push(O.url),p((k+1)/N.length*100)}t([...e,...S]),g({title:"Upload successful",description:`${N.length} video${N.length>1?"s":""} uploaded`})}catch(S){console.error("Upload error:",S),g({title:"Upload failed",description:S instanceof Error?S.message:"Failed to upload videos",variant:"destructive"})}finally{h(!1),p(0),x.current&&(x.current.value="")}}}),_=(b,N)=>E(this,null,function*(){try{const S=Zi.getPathFromUrl(b,n);S&&(yield Zi.deleteVideo(n,S));const k=e.filter((O,A)=>A!==N);t(k),g({title:"Video removed",description:"Video deleted successfully"})}catch(S){console.error("Delete error:",S),g({title:"Delete failed",description:"Failed to delete video",variant:"destructive"})}}),w=()=>{var b;(b=x.current)==null||b.click()};return s.jsxs("div",{className:ke("space-y-3",c),children:[o&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium",children:o}),l&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.map((b,N)=>s.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100 group",children:[s.jsx("video",{src:b,className:"w-full h-full object-cover",muted:!0,playsInline:!0}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:s.jsx("div",{className:"bg-black/50 rounded-full p-2",children:s.jsx(QJ,{className:"w-6 h-6 text-white",fill:"white"})})}),s.jsx("button",{type:"button",onClick:()=>_(b,N),disabled:d||u,className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",children:s.jsx(pr,{className:"w-4 h-4"})})]},b)),e.length<i&&s.jsx("button",{type:"button",onClick:w,disabled:d||u,className:ke("aspect-square rounded-lg border-2 border-dashed border-gray-300 hover:border-gray-400","flex flex-col items-center justify-center gap-2 transition-colors","disabled:opacity-50 disabled:cursor-not-allowed",u&&"border-primary"),children:u?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-6 h-6 animate-spin text-primary"}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[f.toFixed(0),"%"]})]}):s.jsxs(s.Fragment,{children:[s.jsx(aQ,{className:"w-6 h-6 text-gray-400"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"Add Video"})]})})]}),s.jsx("input",{ref:x,type:"file",accept:"video/mp4,video/webm,video/quicktime,video/x-msvideo,video/3gpp,video/x-flv",multiple:!0,onChange:v,className:"hidden",disabled:d||u}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.length," / ",i," videos  Max ",a,"MB per video"]})]})}function Cce({value:e,onChange:t,userId:r,metOnSynth:n,onMetOnSynthChange:i}){const[a,o]=y.useState(""),[l,c]=y.useState([]),[d,u]=y.useState(!1),[h,f]=y.useState(""),[p,x]=y.useState(""),g=y.useRef(null);y.useEffect(()=>{if(!a.trim()){c([]);return}const b=setTimeout(()=>E(this,null,function*(){u(!0);try{const{data:N,error:S}=yield P.from("users").select("user_id, name, avatar_url").ilike("name",`%${a}%`).neq("user_id",r).order("name",{ascending:!0}).limit(10);S?(console.error("Error searching users:",S),c([])):c(N||[])}catch(N){console.error("Error searching users:",N),c([])}finally{u(!1)}}),300);return()=>clearTimeout(b)},[a,r]),y.useEffect(()=>{const b=N=>{g.current&&!g.current.contains(N.target)&&o("")};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]);const v=b=>{const N={type:"user",user_id:b.user_id,name:b.name,avatar_url:b.avatar_url};e.some(k=>k.type==="user"&&k.user_id===b.user_id)||t([...e,N]),o("")},_=b=>{t(e.filter((N,S)=>S!==b))},w=()=>{if(!h.trim())return;const b={type:"phone",phone:h,name:p.trim()||void 0};e.some(S=>S.type==="phone"&&S.phone===h)||t([...e,b]),f(""),x("")};return s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"relative",ref:g,children:s.jsxs("div",{className:"relative",children:[s.jsx(Mi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx(or,{type:"text",placeholder:"Search Synth users or invite by phone...",value:a,onChange:b=>o(b.target.value),className:"pl-10"})]})}),a&&s.jsx("div",{className:"w-full bg-white border-2 border-pink-200 rounded-lg shadow-2xl max-h-[500px] overflow-y-auto",children:d?s.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Searching..."}):l.length>0?s.jsxs(s.Fragment,{children:[l.map(b=>{const N=e.some(S=>S.type==="user"&&S.user_id===b.user_id);return s.jsxs("button",{onClick:()=>v(b),disabled:N,className:"w-full flex items-center gap-3 p-3 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsxs(Vr,{className:"h-10 w-10",children:[s.jsx(Qr,{src:b.avatar_url,alt:b.name}),s.jsx(qr,{children:b.name.charAt(0)})]}),s.jsx("div",{className:"flex-1 text-left",children:s.jsx("p",{className:"text-sm font-medium text-gray-900",children:b.name})}),N&&s.jsx("span",{className:"text-xs text-green-600",children:"Added"})]},b.user_id)}),s.jsxs("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:[s.jsx(Ut,{className:"text-xs font-semibold text-gray-700 mb-2 block",children:"Add by Phone"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(or,{type:"tel",placeholder:"Phone: +1234567890",value:h,onChange:b=>f(b.target.value),className:"text-sm"}),s.jsx(or,{type:"text",placeholder:"Name (optional)",value:p,onChange:b=>x(b.target.value),className:"text-sm"}),s.jsx(oe,{size:"sm",onClick:w,disabled:!h.trim(),className:"w-full text-sm",children:"Add Contact"})]})]})]}):s.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"No users found. Use the phone option below to add them."})}),e.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:e.map((b,N)=>s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 rounded-full",children:[b.type==="user"?s.jsxs(s.Fragment,{children:[s.jsxs(Vr,{className:"h-6 w-6",children:[s.jsx(Qr,{src:b.avatar_url,alt:b.name}),s.jsx(qr,{children:b.name.charAt(0)})]}),s.jsx("span",{className:"text-sm text-gray-900",children:b.name})]}):s.jsxs(s.Fragment,{children:[s.jsx(JJ,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{className:"text-sm text-gray-900",children:b.name||b.phone})]}),s.jsx("button",{onClick:()=>_(N),className:"ml-1 text-gray-400 hover:text-gray-600",children:s.jsx(pr,{className:"h-4 w-4"})})]},N))}),e.length>0&&e.some(b=>b.type==="user")&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",id:"metOnSynth",checked:n,onChange:b=>i(b.target.checked),className:"h-4 w-4 rounded border-gray-300 text-pink-600 focus:ring-pink-500"}),s.jsx(Ut,{htmlFor:"metOnSynth",className:"text-sm text-gray-700 cursor-pointer",children:"Did you meet or plan this on Synth?"})]})]})}function Q7({formData:e,errors:t,onUpdateFormData:r,maxCharacters:n=500}){const{user:i}=os(),a=e.reviewText.length,o=a>n*.8;return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("header",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Almost there"}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Share the story"}),s.jsx("p",{className:"text-sm text-gray-600 max-w-xl mx-auto",children:"Bring the show to life with a short recap and any photos you snapped."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(Ut,{htmlFor:"reviewText",className:"text-base font-semibold text-gray-900",children:"Overall Experience *"}),s.jsx(as,{id:"reviewText",placeholder:"What made this night unforgettable? Any standout moments future fans should know?",value:e.reviewText,onChange:l=>r({reviewText:l.target.value}),rows:6,className:"resize-none text-base",maxLength:n}),s.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[s.jsx("span",{children:"Minimum 1-2 sentences is perfect."}),s.jsxs("span",{className:ke(o?"text-orange-600":"text-gray-500"),children:[a,"/",n]})]}),t.reviewText&&s.jsx("p",{className:"text-sm text-red-600",children:t.reviewText})]}),i&&s.jsx(Sce,{value:e.photos||[],onChange:l=>r({photos:l}),userId:i.id,bucket:"review-photos",maxPhotos:5,maxSizeMB:5,label:"Photos (Optional)",helperText:"Add up to 5 photos to give fans a feel for the night."}),i&&s.jsx(Ece,{value:e.videos||[],onChange:l=>r({videos:l}),userId:i.id,bucket:"review-videos",maxVideos:3,maxSizeMB:100,label:"Videos (Optional)",helperText:"Add videos from the event (max 100MB per video)"}),i&&s.jsx(He,{className:"border-2 border-pink-100 bg-gradient-to-br from-pink-50/50 to-purple-50/30",children:s.jsxs(st,{className:"p-8 pb-12",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[s.jsx(Ar,{className:"w-6 h-6 text-pink-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Who tagged along? (Optional)"})]}),s.jsx(Cce,{value:e.attendees,onChange:l=>r({attendees:l}),userId:i.id,metOnSynth:e.metOnSynth,onMetOnSynthChange:l=>r({metOnSynth:l})})]})})]})}var Pce="Separator",eA="horizontal",Ace=["horizontal","vertical"],vF=y.forwardRef((e,t)=>{const c=e,{decorative:r,orientation:n=eA}=c,i=me(c,["decorative","orientation"]),a=Tce(n)?n:eA,l=r?{role:"none"}:{"aria-orientation":a==="vertical"?a:void 0,role:"separator"};return s.jsx(Nt.div,W(M(M({"data-orientation":a},l),i),{ref:t}))});vF.displayName=Pce;function Tce(e){return Ace.includes(e)}var xF=vF;const Jo=y.forwardRef((a,i)=>{var o=a,{className:e,orientation:t="horizontal",decorative:r=!0}=o,n=me(o,["className","orientation","decorative"]);return s.jsx(xF,M({ref:i,decorative:r,orientation:t,className:ke("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e)},n))});Jo.displayName=xF.displayName;const tA="https://synth-beta-testing.vercel.app",Oce=()=>{if(typeof window=="undefined")return"http://localhost:3001";const e=window.location.hostname;return e==="localhost"||e.startsWith("127.0.0.1")||e.startsWith("192.168.")||e.startsWith("10.0.")||e.startsWith("172.")?"http://localhost:3001":window.Capacitor?"https://synth-beta-testing.vercel.app":""};class Ph{static searchSetlists(t){return E(this,null,function*(){const r=this.buildQueryString(t),i=`${Oce()}/api/setlists/search?${r}`;try{console.log(" SetlistService: Making request to setlist.fm API via backend proxy:",i);const a=yield fetch(i,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!a.ok){if(a.status===404)return console.log(" No results from setlist.fm API"),null;throw new Error(`Backend API error: ${a.status} ${a.statusText}`)}const o=yield a.json();return!o.setlist||o.setlist.length===0?(console.log(" No results from setlist.fm API"),null):(console.log(" SetlistService: Received setlists from setlist.fm API:",o.setlist.length),o.setlist)}catch(a){console.error(" Error with setlist.fm API proxy:",a);const o=new Error("setlist-service-offline");throw o.name="SetlistServiceOfflineError",o}})}static buildQueryString(t){const r=new URLSearchParams;return t.artistName&&r.append("artistName",t.artistName),t.date&&r.append("date",t.date),t.venueName&&r.append("venueName",t.venueName),t.cityName&&r.append("cityName",t.cityName),t.stateCode&&r.append("stateCode",t.stateCode),r.toString()}static searchSetlistsViaServerless(t,r){return E(this,null,function*(){var n;try{const i=`/api/setlists/search?${r}`;console.log(" SetlistService: Trying serverless proxy:",i);const a=yield fetch(i,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!a.ok){if(a.status===404)return null;throw new Error(`Serverless proxy error: ${a.status} ${a.statusText}`)}if(!((n=a.headers.get("content-type"))!=null?n:"").includes("application/json"))return console.warn(" Serverless proxy returned non-JSON payload"),null;const l=yield a.json();return!l.setlist||l.setlist.length===0?null:(console.log(" SetlistService: Received setlists from serverless proxy:",l.setlist.length),l.setlist)}catch(i){return console.warn(" Serverless setlist proxy failed:",i),null}})}static searchSetlistsViaRemoteProxy(t,r){return E(this,null,function*(){var n,i;try{const a=`${tA}/api/setlists/search?${r}`;console.log(" SetlistService: Trying remote proxy:",a);const o=yield fetch(a,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!o.ok){if(o.status===404)return null;try{yield fetch(`${tA}/api/setlists/health`,{method:"GET"})}catch(f){console.warn(" Remote proxy health check failed:",f)}const d=yield fetch(a,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!d.ok)throw new Error(`Remote proxy error: ${d.status} ${d.statusText}`);if(!((n=d.headers.get("content-type"))!=null?n:"").includes("application/json"))return console.warn(" Remote proxy retry returned non-JSON payload"),null;const h=yield d.json();return!h.setlist||h.setlist.length===0?null:(console.log(" SetlistService: Received setlists from remote proxy (retry):",h.setlist.length),h.setlist)}if(!((i=o.headers.get("content-type"))!=null?i:"").includes("application/json"))return console.warn(" Remote proxy returned non-JSON payload"),null;const c=yield o.json();return!c.setlist||c.setlist.length===0?null:(console.log(" SetlistService: Received setlists from remote proxy:",c.setlist.length),c.setlist)}catch(a){return console.warn(" Remote setlist proxy failed:",a),null}})}static searchSetlistsFromDatabase(t){return E(this,null,function*(){try{let r=P.from("events").select("id, setlist, artist_id, venue_id, event_date").not("setlist","is",null);if(t.artistName){const{data:o}=yield P.from("artists").select("id").ilike("name",`%${t.artistName}%`).limit(1).maybeSingle();if(o!=null&&o.id)r=r.eq("artist_id",o.id);else return null}if(t.venueName){const{data:o}=yield P.from("venues").select("id").ilike("name",`%${t.venueName}%`).limit(1).maybeSingle();if(o!=null&&o.id)r=r.eq("venue_id",o.id);else return null}if(t.date){const o=t.date.trim();if(/^\d{4}-\d{2}-\d{2}$/.test(o)){const l=new Date(o+"T00:00:00Z"),c=new Date(o+"T23:59:59Z");r=r.gte("event_date",l.toISOString()).lte("event_date",c.toISOString())}else r=r.eq("event_date",o)}const{data:n,error:i}=yield r.limit(10);if(i)return console.error(" Supabase setlist fallback error:",i),null;if(!n||n.length===0)return null;const a=n.map(o=>o.setlist).filter(o=>!!o);return a.length===0?null:(console.log(" SetlistService: Served setlists from Supabase cache:",a.length),a)}catch(r){return console.error(" Supabase setlist fallback exception:",r),null}})}static getSetlistForEvent(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("events").select("setlist, setlist_enriched, setlist_song_count, setlist_fm_id, event_date").eq("id",t).single();if(n)throw n;return r!=null&&r.setlist?r.setlist:null}catch(r){return console.error("Error getting setlist for event:",r),null}})}static searchSetlistsByArtist(t,r){return E(this,null,function*(){return this.searchSetlists({artistName:t,date:r})})}static searchSetlistsByArtistAndVenue(t,r,n){return E(this,null,function*(){return this.searchSetlists({artistName:t,venueName:r,date:n})})}}function yF({isOpen:e,onClose:t,artistName:r,venueName:n,eventDate:i,onSetlistSelect:a}){const[o,l]=y.useState([]),[c,d]=y.useState(!1),[u,h]=y.useState(null),[f,p]=y.useState("none"),[x,g]=y.useState(null),{toast:v}=jr();y.useEffect(()=>{e&&r&&_()},[e,r,n,i]);const _=()=>E(this,null,function*(){try{d(!0),h(null),p("none"),console.log(" SetlistModal: fetchSetlists called with:",{artistName:r,venueName:n,eventDate:i,eventDateType:typeof i});let S=[];if(n&&i)try{console.log(" Searching by artist, venue, and date:",{artistName:r,venueName:n,eventDate:i});const T=yield Ph.searchSetlistsByArtistAndVenue(r,n,i);T&&T.length>0&&(console.log(` Found ${T.length} results from venue+date search`),S=[...S,...T])}catch(T){console.warn(" Venue+date search failed:",T)}if(S.length>0){console.log(" Using venue+date results, skipping additional searches to avoid rate limits"),l(S),d(!1);return}if(i)try{console.log(" Searching by artist and date:",{artistName:r,eventDate:i});const T=yield Ph.searchSetlistsByArtist(r,i);T&&T.length>0&&(console.log(` Found ${T.length} results from artist+date search`),S=[...S,...T])}catch(T){console.warn(" Artist+date search failed:",T)}if(S.length>0){console.log(" Using artist+date results, skipping additional searches to avoid rate limits"),l(S),d(!1);return}try{console.log(" Searching by artist only:",{artistName:r});const T=yield Ph.searchSetlistsByArtist(r);T&&T.length>0&&(console.log(` Found ${T.length} results from artist-only search`),S=[...S,...T])}catch(T){console.warn(" Artist-only search failed:",T)}const k=S.filter(T=>{var B;const $=r.toLowerCase().trim(),R=(((B=T.artist)==null?void 0:B.name)||"").toLowerCase().trim();return R===$||R.split(" ")[0]===$&&R.length<=$.length+2});console.log(` Filtered ${S.length} results to ${k.length} matching artist name`),console.log(" Filtered results:",k.map(T=>{var $;return($=T.artist)==null?void 0:$.name}));const A=k.filter((T,$,R)=>$===R.findIndex(F=>F.setlistFmId===T.setlistFmId)).sort((T,$)=>{if(!i)return 0;const R=new Date(i),F=new Date(T.eventDate),D=new Date($.eventDate),B=F.toDateString()===R.toDateString(),U=D.toDateString()===R.toDateString();if(B&&!U)return-1;if(!B&&U)return 1;const V=Math.abs(F.getTime()-R.getTime()),Y=Math.abs(D.getTime()-R.getTime());return V-Y});if(console.log(" Final sorted setlists:",A.length),l(A),i&&A.length>0){const T=A.find($=>{const R=w($.eventDate),F=w(i)||new Date(i);return R?R.toDateString()===F.toDateString():!1});T&&(console.log(" Auto-selecting exact date match:",T.eventDate),g(T))}A.length===0&&(p("not-found"),h("We couldnt find official setlists for this artist. Feel free to add the songs manually below."))}catch(S){console.error("Error fetching setlists:",S),S instanceof Error&&S.name==="SetlistServiceOfflineError"?(p("offline"),h("Setlist import is offline. Start the local proxy or add the setlist manually in the form."),v({title:"Setlist import unavailable",description:"Run `npm run backend:dev` in another terminal or enter the songs manually.",variant:"destructive"})):(p("generic"),h("Failed to fetch setlists. Please try again."),v({title:"Error",description:"Failed to fetch setlists. Please try again.",variant:"destructive"}))}finally{d(!1)}}),w=S=>{if(!S)return null;try{if(S.includes("-")&&S.length===10){const O=S.split("-");if(O.length===3){if(O[0].length===2&&O[1].length===2&&O[2].length===4){const A=parseInt(O[2],10),T=parseInt(O[1],10)-1,$=parseInt(O[0],10);return new Date(A,T,$)}else if(O[0].length===4)return new Date(S)}}const k=new Date(S);if(!isNaN(k.getTime()))return k}catch(k){}return null},b=S=>{const k=w(S);return!k||isNaN(k.getTime())?(console.warn("Invalid date string:",S),"Date TBD"):k.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})},N=S=>{const k={};return S.forEach(O=>{k[O.setNumber]||(k[O.setNumber]=[]),k[O.setNumber].push(O)}),k};return e?s.jsx(tn,{open:e,onOpenChange:t,children:s.jsxs(Xr,{className:"max-w-4xl w-[95vw] h-[90vh] max-h-[90vh] p-0 overflow-hidden flex flex-col",hideCloseButton:!0,children:[s.jsx(Mn,{className:"px-6 py-4 border-b border-gray-200 bg-white sticky top-0 z-10",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(an,{className:"text-xl font-semibold",children:["Setlists for ",r]}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0",children:s.jsx(pr,{className:"h-4 w-4"})})]})}),s.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-6",children:[c&&s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(er,{className:"h-8 w-8 animate-spin mr-3"}),s.jsx("span",{children:"Searching for setlists..."})]}),u&&!c&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ct,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:f==="offline"?"Setlist Import Offline":f==="not-found"?"No Setlists Found":"Something Went Wrong"}),s.jsx("p",{className:"text-gray-600 mb-4 max-w-lg mx-auto whitespace-pre-wrap",children:u}),f==="offline"&&s.jsxs("div",{className:"bg-pink-50 border border-pink-100 rounded-lg p-4 text-left max-w-md mx-auto mb-6 text-sm text-pink-900",children:[s.jsx("p",{className:"font-medium mb-2",children:"To import from setlist.fm locally:"}),s.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[s.jsx("li",{children:"Open a new terminal window"}),s.jsxs("li",{children:["Run ",s.jsx("code",{className:"px-1 py-0.5 bg-white rounded border border-pink-200 text-xs",children:"npm run backend:dev"})]}),s.jsx("li",{children:"Keep it running while you use the import"})]}),s.jsx("p",{className:"mt-3",children:"Or close this modal and add the songs manually using the Add your own setlist section in the form."})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3",children:[s.jsx(oe,{onClick:_,variant:"outline",children:"Try Again"}),s.jsx(oe,{variant:"ghost",onClick:t,children:"Close & add manually"})]})]}),!c&&!u&&o.length>0&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Found ",o.length," setlist",o.length!==1?"s":""," for ",r]}),o.map((S,k)=>{const O=N(S.songs),A=(x==null?void 0:x.setlistFmId)===S.setlistFmId,T=w(S.eventDate),$=i?w(i)||new Date(i):null,R=i&&T&&$&&T.toDateString()===$.toDateString();return s.jsxs(He,{className:`overflow-hidden transition-all duration-200 ${A?"ring-2 ring-blue-500 shadow-lg":"hover:shadow-md"}`,children:[s.jsx(xr,{className:`bg-gradient-to-r from-purple-50 to-pink-50 ${A?"bg-gradient-to-r from-blue-50 to-indigo-50":""}`,children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Cr,{className:"text-lg",children:S.artist.name}),R&&s.jsx(Be,{variant:"default",className:"bg-green-500 hover:bg-green-600",children:"Exact Match"}),A&&s.jsx(Be,{variant:"default",className:"bg-blue-500 hover:bg-blue-600",children:"Selected"})]}),s.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Et,{className:"h-4 w-4"}),b(S.eventDate)]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"h-4 w-4"}),S.venue.name,", ",S.venue.city,S.venue.state&&`, ${S.venue.state}`]}),S.tour&&s.jsx("div",{className:"text-purple-600 font-medium",children:S.tour})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs(Be,{variant:"secondary",className:"mb-2",children:[S.songCount," songs"]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[Object.keys(O).length," set",Object.keys(O).length!==1?"s":""]})]})]})}),s.jsxs(st,{className:"p-6",children:[S.info&&s.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-800",children:S.info}),s.jsx("div",{className:"space-y-4",children:Object.entries(O).map(([F,D])=>{var B;return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Be,{variant:"outline",className:"font-medium",children:((B=D[0])==null?void 0:B.setName)||`Set ${F}`}),s.jsxs("span",{className:"text-sm text-gray-500",children:[D.length," song",D.length!==1?"s":""]})]}),s.jsx("div",{className:"space-y-1",children:D.map((U,V)=>s.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-500 w-8 text-right",children:[U.position,"."]}),s.jsx("span",{className:"text-sm flex-1",children:U.name}),U.cover&&s.jsx(Be,{variant:"secondary",className:"text-xs",children:U.cover.artist}),U.tape&&s.jsx(Be,{variant:"outline",className:"text-xs",children:"Tape"})]},V))}),parseInt(F)<Object.keys(O).length&&s.jsx(Jo,{className:"my-4"})]},F)})}),s.jsx("div",{className:"mt-6 pt-4 border-t",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(oe,{variant:A?"default":"outline",size:"sm",onClick:()=>{g(S),a&&a(S),v({title:"Setlist Selected",description:`Selected setlist from ${S.venue.name} on ${b(S.eventDate)}`}),setTimeout(()=>{t()},1e3)},className:"flex-1",children:A?s.jsxs(s.Fragment,{children:[s.jsx(Ct,{className:"h-4 w-4 mr-2"}),"Selected"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ct,{className:"h-4 w-4 mr-2"}),"Select This Setlist"]})}),s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>window.open(S.url,"_blank"),children:[s.jsx(aa,{className:"h-4 w-4 mr-2"}),"View on Setlist.fm"]})]})})]})]},S.setlistFmId)})]})]})]})}):null}function Z3({songs:e,onChange:t,className:r,disabled:n=!1}){const[i,a]=y.useState(!1),[o,l]=y.useState(null),[c,d]=y.useState({song_name:"",cover_artist:"",notes:""}),u=()=>{var _,w;if(!c.song_name.trim())return;const v={song_name:c.song_name.trim(),cover_artist:((_=c.cover_artist)==null?void 0:_.trim())||void 0,notes:((w=c.notes)==null?void 0:w.trim())||void 0,position:e.length+1};t([...e,v]),d({song_name:"",cover_artist:"",notes:""}),a(!1)},h=v=>{const _=e[v];d({song_name:_.song_name,cover_artist:_.cover_artist||"",notes:_.notes||""}),l(v),a(!0)},f=()=>{var _,w;if(o===null||!c.song_name.trim())return;const v=[...e];v[o]={song_name:c.song_name.trim(),cover_artist:((_=c.cover_artist)==null?void 0:_.trim())||void 0,notes:((w=c.notes)==null?void 0:w.trim())||void 0,position:o+1},t(v),d({song_name:"",cover_artist:"",notes:""}),l(null),a(!1)},p=()=>{d({song_name:"",cover_artist:"",notes:""}),l(null),a(!1)},x=v=>{const w=e.filter((b,N)=>N!==v).map((b,N)=>W(M({},b),{position:N+1}));t(w)},g=(v,_)=>{if(_==="up"&&v===0||_==="down"&&v===e.length-1)return;const w=_==="up"?v-1:v+1,b=[...e];[b[v],b[w]]=[b[w],b[v]];const N=b.map((S,k)=>W(M({},S),{position:k+1}));t(N)};return s.jsxs("div",{className:ke("space-y-3",r,n&&"opacity-50 pointer-events-none"),children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ct,{className:ke("w-5 h-5",n?"text-gray-400":"text-purple-600")}),s.jsx(Ut,{className:ke("text-sm font-medium",n&&"text-gray-500"),children:n?"Custom Setlist (Disabled)":"Custom Setlist (Optional)"}),e.length>0&&s.jsxs(Be,{variant:"secondary",className:ke(n?"bg-gray-100 text-gray-600":"bg-purple-100 text-purple-800"),children:[e.length," song",e.length!==1?"s":""]})]}),!i&&!n&&s.jsxs(oe,{type:"button",variant:"outline",size:"sm",onClick:()=>a(!0),className:"text-purple-600 border-purple-300 hover:bg-purple-50",children:[s.jsx(eo,{className:"w-4 h-4 mr-1"}),"Add Song"]})]}),s.jsx("p",{className:ke("text-xs",n?"text-gray-400":"text-gray-500"),children:n?"Custom setlist creation is disabled because an API setlist was selected.":"Create your own setlist for this show. Add songs in the order they were played."}),e.length>0&&s.jsx("div",{className:"space-y-2",children:e.map((v,_)=>s.jsx(He,{className:"border-purple-200 bg-purple-50/30",children:s.jsx(st,{className:"p-3",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs("div",{className:"flex flex-col gap-1 pt-1",children:[s.jsx("button",{type:"button",onClick:()=>g(_,"up"),disabled:_===0,className:"text-purple-400 hover:text-purple-600 disabled:opacity-30 disabled:cursor-not-allowed","aria-label":"Move up",children:s.jsx(y3,{className:"w-4 h-4"})}),s.jsx("button",{type:"button",onClick:()=>g(_,"down"),disabled:_===e.length-1,className:"text-purple-400 hover:text-purple-600 disabled:opacity-30 disabled:cursor-not-allowed","aria-label":"Move down",children:s.jsx(y3,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-purple-100 text-purple-700 font-semibold text-sm flex-shrink-0",children:_+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium text-purple-900",children:v.song_name}),v.cover_artist&&s.jsx("div",{className:"text-xs text-purple-600 mt-1",children:s.jsxs(Be,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:["Cover: ",v.cover_artist]})}),v.notes&&s.jsxs("div",{className:"text-xs text-purple-700 mt-1 italic",children:['"',v.notes,'"']})]}),s.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[s.jsx(oe,{type:"button",variant:"ghost",size:"sm",onClick:()=>h(_),className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:s.jsx(eI,{className:"h-4 w-4"})}),s.jsx(oe,{type:"button",variant:"ghost",size:"sm",onClick:()=>x(_),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:s.jsx(yc,{className:"h-4 w-4"})})]})]})})},_))}),i&&s.jsxs(He,{className:"border-purple-300 bg-purple-50",children:[s.jsx(xr,{className:"pb-3",children:s.jsx("h4",{className:"text-sm font-semibold text-purple-900",children:o!==null?"Edit Song":"Add Song"})}),s.jsxs(st,{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"song_name",className:"text-xs font-medium text-purple-900",children:"Song Name *"}),s.jsx(or,{id:"song_name",value:c.song_name,onChange:v=>d(W(M({},c),{song_name:v.target.value})),placeholder:"Enter song name...",maxLength:200,className:"border-purple-200"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"cover_artist",className:"text-xs font-medium text-purple-900",children:"Cover Artist (Optional)"}),s.jsx(or,{id:"cover_artist",value:c.cover_artist,onChange:v=>d(W(M({},c),{cover_artist:v.target.value})),placeholder:"If this was a cover, enter original artist...",maxLength:100,className:"border-purple-200"}),s.jsx("p",{className:"text-xs text-purple-600",children:"Leave blank if it's an original by the performing artist"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"notes",className:"text-xs font-medium text-purple-900",children:"Special Notes (Optional)"}),s.jsx(as,{id:"notes",value:c.notes,onChange:v=>d(W(M({},c),{notes:v.target.value})),placeholder:"Any special notes about this performance...",maxLength:300,rows:2,className:"border-purple-200 resize-none"}),s.jsx("p",{className:"text-xs text-purple-600",children:'E.g., "Extended guitar solo", "First time played live", "Crowd favorite"'})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs(oe,{type:"button",onClick:o!==null?f:u,disabled:!c.song_name.trim(),className:"bg-purple-600 hover:bg-purple-700",children:[s.jsx(Kk,{className:"w-4 h-4 mr-1"}),o!==null?"Save Changes":"Add Song"]}),s.jsxs(oe,{type:"button",variant:"outline",onClick:p,className:"border-purple-300 text-purple-700 hover:bg-purple-50",children:[s.jsx(pr,{className:"w-4 h-4 mr-1"}),"Cancel"]})]})]})]}),e.length===0&&!i&&s.jsxs("div",{className:"text-center py-6 border-2 border-dashed border-purple-200 rounded-lg bg-purple-50/30",children:[s.jsx(Ct,{className:"w-8 h-8 text-purple-300 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-purple-600 mb-2",children:"No songs added yet"}),s.jsxs(oe,{type:"button",variant:"outline",size:"sm",onClick:()=>a(!0),className:"text-purple-600 border-purple-300 hover:bg-purple-50",children:[s.jsx(eo,{className:"w-4 h-4 mr-1"}),"Add Your First Song"]})]})]})}function Rce({formData:e,errors:t,onUpdateFormData:r,artistName:n,venueName:i,eventDate:a}){var b,N,S;const[o,l]=y.useState(null),[c,d]=y.useState(!1),u=(b=o!=null?o:e.rating)!=null?b:0,h=e.reviewText.length,f=200,p=h>f*.8,x=k=>{r({selectedSetlist:k}),d(!1)},g=()=>{r({selectedSetlist:null})},v=k=>{r({customSetlist:k})},_=k=>{r({rating:k})},w=k=>{if(!k)return"";const O=new Date(k);return Number.isNaN(O.getTime())?"":O.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})};return s.jsxs("div",{className:"space-y-6 w-full max-w-full overflow-x-hidden",children:[s.jsxs("header",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Quick Review"}),s.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-900 break-words",children:"Share your experience"}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 max-w-full mx-auto break-words",children:"Rate the overall experience and share a brief recap."})]}),s.jsx("section",{className:"bg-gradient-to-br from-pink-50 via-rose-50 to-fuchsia-50 border border-pink-200/60 rounded-2xl p-4 sm:p-6 shadow-sm text-center space-y-4 w-full max-w-full overflow-x-hidden",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-pink-600 font-semibold",children:"Overall Rating"}),s.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4 flex-wrap",children:[s.jsx("div",{className:"flex items-center flex-shrink-0",onMouseLeave:()=>l(null),children:Array.from({length:5},(k,O)=>{const A=O+1,T=A,$=A-.5,R=u>=T,F=!R&&u===$;return s.jsxs("div",{className:"relative w-8 h-8 sm:w-10 sm:h-10 cursor-pointer flex-shrink-0",children:[s.jsx(Jt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-300"}),(R||F)&&s.jsx("div",{className:ke("absolute left-0 top-0 h-full overflow-hidden pointer-events-none",R?"w-full":"w-1/2"),children:s.jsx(Jt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-pink-500 fill-current"})}),s.jsx("button",{type:"button",className:"absolute inset-0",onMouseEnter:()=>l(T),onClick:()=>_(T),"aria-label":`Rate ${T} stars`}),s.jsx("button",{type:"button",className:"absolute inset-0 left-0 w-1/2",onMouseEnter:()=>l($),onClick:()=>_($),"aria-label":`Rate ${$} stars`})]},O)})}),s.jsx("span",{className:"text-base sm:text-lg font-semibold text-gray-700 break-words",children:u>0?`${u.toFixed(1)} / 5.0`:"Not rated yet"})]}),t.rating&&s.jsx("p",{className:"text-xs sm:text-sm text-red-600 break-words",children:t.rating})]})}),s.jsxs("div",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[s.jsx(Ut,{htmlFor:"reviewText",className:"text-sm sm:text-base font-semibold text-gray-900",children:"Brief Review *"}),s.jsx(as,{id:"reviewText",placeholder:"What made this night memorable? Share a quick recap.",value:e.reviewText,onChange:k=>r({reviewText:k.target.value}),rows:4,className:"resize-none text-sm sm:text-base w-full max-w-full min-w-0",maxLength:f}),s.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[s.jsx("span",{className:"break-words",children:"Keep it brief - 1-2 sentences is perfect."}),s.jsxs("span",{className:ke(p?"text-orange-600":"text-gray-500","flex-shrink-0 ml-2"),children:[h,"/",f]})]}),t.reviewText&&s.jsx("p",{className:"text-xs sm:text-sm text-red-600 break-words",children:t.reviewText})]}),s.jsxs("div",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[s.jsx(Ut,{className:"text-sm sm:text-base font-semibold text-gray-900",children:"Setlist (Optional)"}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 break-words",children:"Add the setlist if you remember it"}),e.selectedSetlist?s.jsxs("div",{className:"p-3 sm:p-4 bg-pink-50 rounded-lg border border-pink-200 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx(Ct,{className:"w-4 h-4 sm:w-5 sm:h-5 text-pink-600 flex-shrink-0"}),s.jsx("span",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:"Setlist Selected"})]}),s.jsx(oe,{type:"button",variant:"ghost",size:"sm",onClick:g,className:"h-8 w-8 p-0 flex-shrink-0",children:s.jsx(pr,{className:"w-4 h-4"})})]}),s.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 break-words",children:[(N=e.selectedSetlist.artist)==null?void 0:N.name," - ",w(e.selectedSetlist.eventDate)]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.selectedSetlist.songCount||((S=e.selectedSetlist.songs)==null?void 0:S.length)||0," songs"]})]}):e.customSetlist.length>0?s.jsxs("div",{className:"p-3 sm:p-4 bg-pink-50 rounded-lg border border-pink-200 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx(Ct,{className:"w-4 h-4 sm:w-5 sm:h-5 text-pink-600 flex-shrink-0"}),s.jsx("span",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:"Custom Setlist"})]}),s.jsx(oe,{type:"button",variant:"ghost",size:"sm",onClick:()=>r({customSetlist:[]}),className:"h-8 w-8 p-0 flex-shrink-0",children:s.jsx(pr,{className:"w-4 h-4"})})]}),s.jsxs("p",{className:"text-xs sm:text-sm text-gray-600",children:[e.customSetlist.length," songs"]})]}):s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[s.jsxs(oe,{type:"button",variant:"outline",onClick:()=>d(!0),className:"flex items-center justify-center gap-2 w-full sm:w-auto flex-shrink-0",children:[s.jsx(Ct,{className:"w-4 h-4"}),"Import from setlist.fm"]}),s.jsx(Z3,{songs:e.customSetlist,onChange:v})]}),c&&n&&s.jsx(yF,{isOpen:c,onClose:()=>d(!1),artistName:n,venueName:i,eventDate:a,onSetlistSelect:x})]})]})}function kj({formData:e,errors:t,onUpdateFormData:r,onSubmit:n,isLoading:i,averageRating:a,categoryBreakdown:o}){var p,x,g,v,_,w,b,N;const l=S=>{r({isPublic:S})},c=S=>{if(!S)return"Date TBD";const k=new Date(S);return Number.isNaN(k.getTime())?"Date TBD":k.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},d=(S=0,k="sm")=>{const O=k==="lg"?"w-6 h-6":k==="md"?"w-5 h-5":"w-4 h-4",A=k==="lg"?"text-pink-200":"text-gray-300",T=k==="lg"?"text-white":"text-yellow-400";return Array.from({length:5},($,R)=>{const F=R+1,D=S>=F-.01,B=!D&&S>=F-.5&&S<F;return s.jsxs("div",{className:"relative",children:[s.jsx(Jt,{className:ke(O,D?`${T} fill-current drop-shadow`:A)}),B&&s.jsx("div",{className:"absolute inset-0 overflow-hidden w-1/2",children:s.jsx(Jt,{className:`${O} ${T} fill-current`})})]},R)})},u=Number.isFinite(a)&&a>0?Math.round(a*10)/10:0,h=u?u.toFixed(1):"",f=e.ticketPricePaid&&!Number.isNaN(Number(e.ticketPricePaid))?Number(e.ticketPricePaid).toFixed(2):null;return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:"Final Step"}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Review & Share"}),s.jsx("p",{className:"text-sm text-gray-600 max-w-2xl mx-auto",children:"Take a final look at your ratings, highlight anything fans should know, and choose who can see your review."})]}),s.jsx("section",{className:"rounded-3xl bg-gradient-to-br from-pink-500 via-rose-500 to-purple-500 text-white shadow-lg p-8 space-y-4",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.25em] text-white/80",children:"Average rating"}),s.jsxs("div",{className:"flex items-baseline gap-4 mt-2",children:[s.jsx("span",{className:"text-5xl font-bold tracking-tight",children:h}),s.jsx("div",{className:"flex items-center gap-1",children:d(u,"lg")})]}),s.jsx("p",{className:"text-sm text-white/80 mt-2",children:"Based on five categories of your concert experience."})]}),s.jsxs("div",{className:"flex flex-col items-start sm:items-end gap-2",children:[((p=e.selectedArtist)==null?void 0:p.name)&&((x=e.selectedVenue)==null?void 0:x.name)&&s.jsxs("div",{className:"text-sm font-medium",children:[(g=e.selectedArtist)==null?void 0:g.name," @ ",(v=e.selectedVenue)==null?void 0:v.name]}),e.eventDate&&s.jsxs("div",{className:"text-xs text-white/80 flex items-center gap-2",children:[s.jsx(Et,{className:"w-4 h-4"}),c(e.eventDate)]})]})]})}),s.jsx("section",{className:"grid gap-4 md:grid-cols-2",children:o.map(S=>{var k;return s.jsx("div",{className:"rounded-xl border border-pink-100 bg-white shadow-sm p-4 space-y-3",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:S.label}),S.annotation&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:S.annotation})]}),s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsx("span",{className:"text-lg font-semibold text-gray-900",children:S.rating?S.rating.toFixed(1):""}),s.jsx("div",{className:"flex gap-0.5",children:d((k=S.rating)!=null?k:0,"sm")})]})]})},S.label)})}),s.jsx(He,{className:"border-gray-200 shadow-sm",children:s.jsxs(st,{className:"p-4",children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"What you're sharing"}),s.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[((_=e.selectedArtist)==null?void 0:_.name)&&((w=e.selectedVenue)==null?void 0:w.name)&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Gs,{className:"w-4 h-4 text-green-500"}),s.jsxs("span",{children:[s.jsx("strong",{children:(b=e.selectedArtist)==null?void 0:b.name})," at"," ",s.jsx("strong",{children:(N=e.selectedVenue)==null?void 0:N.name})]})]}),e.eventDate&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Gs,{className:"w-4 h-4 text-green-500"}),s.jsx("span",{children:c(e.eventDate)})]}),f&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Gs,{className:"w-4 h-4 text-green-500"}),s.jsxs("span",{children:["Ticket price (kept private): $",f]})]}),e.reviewText&&s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Gs,{className:"w-4 h-4 text-green-500 mt-0.5"}),s.jsxs("span",{children:["Written story (",e.reviewText.length," characters)"]})]}),Array.isArray(e.photos)&&e.photos.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Gs,{className:"w-4 h-4 text-green-500"}),s.jsxs("span",{children:[e.photos.length," photo",e.photos.length!==1?"s":""," attached"]})]})]})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(Ut,{className:"text-sm font-medium text-gray-900",children:"Who can see this review?"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"radio",id:"public",name:"privacy",checked:e.isPublic,onChange:()=>l(!0),className:"sr-only"}),s.jsxs("label",{htmlFor:"public",className:ke("flex items-center space-x-3 p-4 rounded-lg border-2 cursor-pointer transition-all duration-200",e.isPublic?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[s.jsx("div",{className:ke("w-5 h-5 rounded-full border-2 flex items-center justify-center",e.isPublic?"border-blue-500 bg-blue-500":"border-gray-300"),children:e.isPublic&&s.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(No,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-900",children:"Public"}),s.jsx(Be,{variant:"secondary",className:"text-xs",children:"Recommended"})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Everyone can see your review. Help the community decide where to go."})]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"radio",id:"private",name:"privacy",checked:!e.isPublic,onChange:()=>l(!1),className:"sr-only"}),s.jsxs("label",{htmlFor:"private",className:ke("flex items-center space-x-3 p-4 rounded-lg border-2 cursor-pointer transition-all duration-200",e.isPublic?"border-gray-200 hover:border-gray-300":"border-blue-500 bg-blue-50"),children:[s.jsx("div",{className:ke("w-5 h-5 rounded-full border-2 flex items-center justify-center",e.isPublic?"border-gray-300":"border-blue-500 bg-blue-500"),children:!e.isPublic&&s.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(og,{className:"w-5 h-5 text-gray-600"}),s.jsx("span",{className:"font-medium text-gray-900",children:"Private"})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Only you can see this review. You can always share it later."})]})]})]})]})]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(XD,{className:"w-4 h-4 text-gray-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-gray-600",children:[s.jsx("p",{className:"font-medium mb-1",children:"About privacy:"}),s.jsxs("ul",{className:"space-y-1 text-xs",children:[s.jsx("li",{children:" Public reviews help the community discover amazing shows"}),s.jsx("li",{children:" You can change the privacy setting any time in your profile"}),s.jsx("li",{children:" Private reviews are only visible to you"}),s.jsx("li",{children:" All reviews follow Synths community guidelines"})]})]})]})}),s.jsxs("div",{className:"pt-6 pb-4",children:[s.jsx(oe,{onClick:n,disabled:i,className:"w-full bg-pink-500 hover:bg-pink-600 text-white py-3 text-base font-medium",children:i?s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Submitting Review..."})]}):s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Gs,{className:"w-5 h-5"}),s.jsx("span",{children:"Submit Review"})]})}),t.submit&&s.jsx("p",{className:"text-sm text-red-600 text-center mt-2",children:t.submit})]}),s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-xs text-gray-500",children:"By submitting, you agree to our terms of service and community guidelines."})})]})}function Mce({isOpen:e,onClose:t,userId:r,newReview:n,rating:i}){var $;console.log(" PostSubmitRankingModal MOUNTED/RENDERING with props:",{isOpen:e,userId:r==null?void 0:r.slice(0,8),newReviewId:($=n==null?void 0:n.id)==null?void 0:$.slice(0,8),rating:i});const[a,o]=y.useState([]),[l,c]=y.useState([]),[d,u]=y.useState(!0),[h,f]=y.useState(!1),[p,x]=y.useState(null),{toast:g}=jr(),v=Math.round(i*10)/10;y.useEffect(()=>{var R;console.log(" PostSubmitRankingModal useEffect triggered:",{isOpen:e,userId:r==null?void 0:r.slice(0,8),rating:i,newReviewId:(R=n==null?void 0:n.id)==null?void 0:R.slice(0,8)}),e&&r?(console.log("   Conditions met, loading reviews..."),_()):console.log("   Conditions not met, skipping load")},[e,r,i]);const _=()=>E(this,null,function*(){u(!0);try{console.log(" Loading reviews for rating:",v,"userId:",r);const{reviews:R}=yield fs.getUserReviewHistory(r);console.log(" Total user reviews fetched:",R.length);const F=R.map(({review:D,event:B})=>W(M({},D),{event_title:B==null?void 0:B.title,artist_name:B==null?void 0:B.artist_name,venue_name:B==null?void 0:B.venue_name,event_date:B==null?void 0:B.event_date,effectiveRating:w(D),rank_order:D.rank_order||null})).filter(D=>{const B=Math.round(D.effectiveRating*10)/10,U=B===v;return console.log(`  Review ${D.id.slice(0,8)}: rating=${D.rating}, effective=${D.effectiveRating}, rounded=${B}, matches=${U}`),U});console.log(` Found ${F.length} reviews matching ${v}`),F.sort((D,B)=>D.rank_order!=null&&B.rank_order!=null?D.rank_order-B.rank_order:D.rank_order!=null?-1:B.rank_order!=null?1:new Date(B.created_at).getTime()-new Date(D.created_at).getTime()),o(F),c(F.map(D=>D.id))}catch(R){console.error(" Error loading reviews with same rating:",R),g({title:"Error",description:"Failed to load reviews for ranking",variant:"destructive"})}finally{u(!1)}}),w=R=>{const F=[R.artist_performance_rating,R.production_rating,R.venue_rating,R.location_rating,R.value_rating].filter(D=>typeof D=="number"&&D>0);if(F.length>0){const D=F.reduce((B,U)=>B+U,0)/F.length;return Math.round(D*10)/10}return R.rating||0};y.useEffect(()=>{console.log(" PostSubmitRankingModal state:",{isOpen:e,reviewsCount:a.length,displayRating:v,newReviewId:n.id})},[e,a.length,v,n.id]);const b=R=>{x(R)},N=(R,F)=>{if(R.preventDefault(),p===null||p===F)return;const D=[...l],B=D[p];D.splice(p,1),D.splice(F,0,B),c(D),x(F)},S=()=>{x(null)},k=(R,F)=>{console.log(" Moving review:",{index:R,direction:F,total:l.length});const D=F==="up"?R-1:R+1;if(D<0||D>=l.length){console.log(" Cannot move - out of bounds");return}const B=[...l],U=B[R];B[R]=B[D],B[D]=U,console.log(" New order:",B),c(B)},O=()=>E(this,null,function*(){f(!0);try{yield fs.setRankOrderForRatingGroup(r,v,l),g({title:"Rankings Saved! ",description:`Your ${v.toFixed(1)} reviews have been ranked.`}),t()}catch(R){console.error("Error saving rankings:",R),g({title:"Error",description:"Failed to save rankings. Please try again.",variant:"destructive"})}finally{f(!1)}}),A=()=>{t()},T=R=>a.find(F=>F.id===R);return d?s.jsx(tn,{open:e,onOpenChange:t,children:s.jsxs(Xr,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsx(Mn,{children:s.jsx(an,{children:"Loading reviews..."})}),s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-pink-500 border-t-transparent rounded-full"})})]})}):!d&&a.length<=1?(console.log(" Only 1 or fewer reviews found, closing modal"),e&&setTimeout(()=>t(),100),null):s.jsx(tn,{open:e,onOpenChange:t,children:s.jsxs(Xr,{className:"max-w-3xl max-h-[85vh] overflow-hidden flex flex-col",children:[s.jsxs(Mn,{children:[s.jsxs(an,{className:"flex items-center gap-2",children:[s.jsx(Jt,{className:"w-5 h-5 text-yellow-400 fill-current"}),"Rank Your ",v.toFixed(1)," Reviews"]}),s.jsxs(Kn,{children:["You have ",a.length," reviews rated ",v.toFixed(1),". Drag to reorder them from your favorite (top) to least favorite (bottom). This helps us give you better recommendations!"]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto py-4 space-y-3",children:l.map((R,F)=>{const D=T(R);if(!D)return null;const B=D.id===n.id;return s.jsx(He,{draggable:!0,onDragStart:()=>b(F),onDragOver:U=>N(U,F),onDragEnd:S,className:ke("p-4 cursor-move transition-all",p===F&&"opacity-50",B&&"border-2 border-pink-500 bg-pink-50/50"),children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs("div",{className:"flex flex-col items-center justify-center pt-1",children:[s.jsx(y3,{className:"w-5 h-5 text-gray-400"}),s.jsx("div",{className:"mt-1 flex items-center justify-center w-7 h-7 rounded-full bg-gray-100 text-sm font-semibold text-gray-700",children:F+1})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold text-gray-900 truncate",children:D.event_title||D.artist_name||"Concert"}),s.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm text-gray-600",children:[D.artist_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ct,{className:"w-3.5 h-3.5"}),s.jsx("span",{className:"truncate",children:D.artist_name})]}),D.venue_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Xt,{className:"w-3.5 h-3.5"}),s.jsx("span",{className:"truncate",children:D.venue_name})]})]}),D.event_date&&s.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-gray-500",children:[s.jsx(Et,{className:"w-3 h-3"}),s.jsx("span",{children:new Date(D.event_date).toLocaleDateString()})]}),D.review_text&&s.jsx("p",{className:"mt-2 text-sm text-gray-700 line-clamp-2",children:D.review_text})]}),B&&s.jsx("div",{className:"flex-shrink-0",children:s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-pink-100 text-pink-800",children:"New"})})]}),s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsx(oe,{type:"button",variant:"outline",size:"sm",onClick:U=>{U.preventDefault(),U.stopPropagation(),k(F,"up")},disabled:F===0,className:"text-xs",children:" Move Up"}),s.jsx(oe,{type:"button",variant:"outline",size:"sm",onClick:U=>{U.preventDefault(),U.stopPropagation(),k(F,"down")},disabled:F===l.length-1,className:"text-xs",children:" Move Down"})]})]})]})},D.id)})}),s.jsxs(ff,{className:"gap-2",children:[s.jsx(oe,{type:"button",variant:"outline",onClick:A,disabled:h,children:"Skip for Now"}),s.jsx(oe,{type:"button",onClick:O,disabled:h,className:"bg-pink-500 hover:bg-pink-600",children:h?"Saving...":"Save Rankings"})]})]})})}const Dce=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,iu=e=>typeof e=="string"&&Dce.test(e),rA=e=>{var r,n;if(!e||typeof e!="object")return e;const t=M({},e);return"id"in t&&!iu(t.id)&&(typeof t.id=="string"&&(t.jambase_id=(r=t.jambase_id)!=null?r:t.id),t.id=null),"identifier"in t&&!iu(t.identifier)&&(t.jambase_identifier=(n=t.jambase_identifier)!=null?n:t.identifier),t};class Ah{static ensureEventArtistUuid(t,r){return E(this,null,function*(){var n,i,a;try{const{data:o,error:l}=yield P.from("events").select("id, artist_id, artist_name").eq("id",t).maybeSingle();if(l&&console.warn(" DraftReviewService: Failed to fetch event for artist resolution",l),o!=null&&o.artist_id){const h=o.artist_id.trim();if(iu(h))return h;{const{data:f}=yield P.from("artists_with_external_ids").select("id").eq("jambase_artist_id",h).maybeSingle();if(f!=null&&f.id)return f.id}}const c=r.selectedArtist||null;let d,u;if(c&&typeof c=="object"){const h=c.id;iu(h)&&(d=h),u=u||c.jambase_id||(typeof h=="string"&&!iu(h)?h:void 0)||(typeof c.identifier=="string"?(a=(i=(n=c.identifier).split)==null?void 0:i.call(n,":"))==null?void 0:a[1]:void 0)}if(!u&&(o!=null&&o.artist_id)){const h=o.artist_id.trim();iu(h)?d=h:h&&(u=h)}if(!d&&u){let h=yield P.from("artists_with_external_ids").select("id").eq("jambase_artist_id",u).limit(1);if(!h.error&&Array.isArray(h.data)&&h.data.length>0)d=h.data[0].id;else if(!h.error)try{const{UnifiedArtistSearchService:f}=yield on(()=>E(this,null,function*(){const{UnifiedArtistSearchService:p}=yield Promise.resolve().then(()=>wce);return{UnifiedArtistSearchService:p}}),void 0,import.meta.url);yield f.searchArtists((c==null?void 0:c.name)||(o==null?void 0:o.artist_name)||"",20,!1),h=yield P.from("artists_with_external_ids").select("id").eq("jambase_artist_id",u).limit(1),!h.error&&Array.isArray(h.data)&&h.data.length>0&&(d=h.data[0].id)}catch(f){console.warn(" DraftReviewService: Artist search retry failed",f)}}if(d&&iu(d))return yield P.from("events").update({artist_uuid:d}).eq("id",t),d}catch(o){console.warn(" DraftReviewService: ensureEventArtistUuid encountered error",o)}})}static saveDraft(t,r,n){return E(this,null,function*(){try{if(console.log(" Saving draft:",{userId:t,eventId:r,draftData:n}),!t||!r)return console.error(" Missing required parameters:",{userId:t,eventId:r}),null;if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r))return console.error(" Event ID is not a valid UUID:",r),null;const{data:a,error:o}=yield P.from("reviews").select("id, is_draft").eq("user_id",t).eq("event_id",r).eq("is_draft",!1).maybeSingle();if(o&&o.code!=="PGRST116"&&console.error(" Error checking for existing published review:",o),a&&!a.is_draft)return console.log(" Draft save blocked: Published review already exists for this event"),console.log("   Published review ID:",a.id),null;const l=yield this.ensureEventArtistUuid(r,n),c=l?W(M({},n),{selectedArtist:n.selectedArtist?W(M({},n.selectedArtist),{id:l}):n.selectedArtist}):n,d=W(M({},c),{selectedArtist:rA(c.selectedArtist),selectedVenue:rA(c.selectedVenue)}),{data:u,error:h}=yield P.rpc("save_review_draft",{p_user_id:t,p_event_id:r,p_draft_data:d});return h?(console.error(" Error saving draft:",h),console.error(" Error details:",JSON.stringify(h,null,2)),null):(console.log(" Draft saved successfully:",u),u)}catch(i){return console.error(" Exception saving draft:",i),null}})}static getUserDrafts(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.rpc("get_user_draft_reviews",{p_user_id:t});return n?(console.error("Error fetching drafts:",n),[]):r||[]}catch(r){return console.error("Error fetching drafts:",r),[]}})}static publishDraft(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.rpc("publish_review_draft",{p_draft_id:t,p_final_data:r});return i?(console.error("Error publishing draft:",i),null):n}catch(n){return console.error("Error publishing draft:",n),null}})}static deleteDraft(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.rpc("delete_review_draft",{p_draft_id:t,p_user_id:r});return i?(console.error("Error deleting draft:",i),!1):n}catch(n){return console.error("Error deleting draft:",n),!1}})}static loadDraftForEvent(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("reviews").select("draft_data").eq("user_id",t).eq("entity_type","event").eq("entity_id",r).eq("is_draft",!0).single();return i?(i.code==="PGRST116"||console.error("Error loading draft:",i),null):(n==null?void 0:n.draft_data)||null}catch(n){return console.error("Error loading draft:",n),null}})}static hasDraftForEvent(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("reviews").select("id").eq("user_id",t).eq("event_id",r).eq("is_draft",!0).single();return i?(i.code==="PGRST116"||console.error("Error checking draft:",i),!1):!!n}catch(n){return console.error("Error checking draft:",n),!1}})}}function Ice({userId:e,eventId:t,formData:r,enabled:n=!0,debounceMs:i=2e3,onSave:a,onEventIdChange:o}){const l=y.useRef(),c=y.useRef(""),d=y.useRef(!1),u=y.useCallback(v=>v?/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(v):!1,[]),h=y.useCallback((v,_)=>E(this,null,function*(){if(!n||!e){console.log(" Auto-save skipped:",{enabled:n,userId:!!e});return}const w=_||t;if(!w||!u(w)){console.log(" Auto-save: No valid event ID yet, saving to localStorage as fallback");try{const N=`review_draft_${e}_new`;localStorage.setItem(N,JSON.stringify({data:v,timestamp:Date.now(),eventId:null})),a==null||a(!0),c.current=JSON.stringify(v)}catch(N){console.error("Auto-save to localStorage failed:",N),a==null||a(!1)}return}if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(w)){console.log(" Auto-save skipped: Invalid event ID format:",w);return}if(d.current){console.log(" Auto-save: Already saving, skipping...");return}try{d.current=!0,console.log(" Auto-saving draft to database:",{userId:e,eventId:w});const N=yield Ah.saveDraft(e,w,v);N?(console.log(" Auto-saved draft successfully:",N),a==null||a(!0),c.current=JSON.stringify(v)):(console.warn(" Auto-save returned null (may be expected)"),a==null||a(!1))}catch(N){console.error(" Auto-save to database failed:",N),a==null||a(!1)}finally{d.current=!1}}),[e,t,n,a,u]),f=y.useCallback(v=>{l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{h(v)},i)},[h,i]);y.useEffect(()=>{if(!n||!e)return;JSON.stringify(r)!==c.current&&Object.values(r).some(w=>Array.isArray(w)?w.length>0:typeof w=="object"&&w!==null?Object.keys(w).length>0:w!=null&&w!=="")&&f(r)},[r,f,n,e]),y.useEffect(()=>{if(!n||!e||!t||!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t))return;Object.values(r).some(w=>Array.isArray(w)?w.length>0:typeof w=="object"&&w!==null?Object.keys(w).length>0:w!=null&&w!=="")&&(console.log(" Event ID available, saving draft immediately"),l.current&&clearTimeout(l.current),h(r,t),o==null||o(t))},[t,n,e,r,h,o]),y.useEffect(()=>()=>{l.current&&clearTimeout(l.current)},[]);const p=y.useCallback(()=>E(this,null,function*(){console.log(" Manual save triggered:",{userId:e,eventId:t,hasFormData:!!r}),l.current&&clearTimeout(l.current),yield h(r,t||void 0)}),[h,r,e,t]),x=y.useCallback(v=>{try{const _=`review_draft_${e}_${v||"new"}`,w=localStorage.getItem(_);if(w){const b=JSON.parse(w);return console.log(" Loaded draft from localStorage:",_),b.data}}catch(_){console.error("Error loading draft from localStorage:",_)}return null},[e]),g=y.useCallback(v=>{try{const _=`review_draft_${e}_${v||"new"}`;localStorage.removeItem(_),console.log(" Cleared draft from localStorage:",_)}catch(_){console.error("Error clearing draft from localStorage:",_)}},[e]);return{manualSave:p,loadDraft:x,clearDraft:g}}function _g(e,[t,r]){return Math.min(r,Math.max(t,e))}function $ce(e,t){return y.useReducer((r,n)=>{const i=t[r][n];return i!=null?i:r},e)}var RE="ScrollArea",[_F,NFe]=js(RE),[Lce,ro]=_F(RE),wF=y.forwardRef((e,t)=>{const R=e,{__scopeScrollArea:r,type:n="hover",dir:i,scrollHideDelay:a=600}=R,o=me(R,["__scopeScrollArea","type","dir","scrollHideDelay"]),[l,c]=y.useState(null),[d,u]=y.useState(null),[h,f]=y.useState(null),[p,x]=y.useState(null),[g,v]=y.useState(null),[_,w]=y.useState(0),[b,N]=y.useState(0),[S,k]=y.useState(!1),[O,A]=y.useState(!1),T=sr(t,F=>c(F)),$=hf(i);return s.jsx(Lce,{scope:r,type:n,dir:$,scrollHideDelay:a,scrollArea:l,viewport:d,onViewportChange:u,content:h,onContentChange:f,scrollbarX:p,onScrollbarXChange:x,scrollbarXEnabled:S,onScrollbarXEnabledChange:k,scrollbarY:g,onScrollbarYChange:v,scrollbarYEnabled:O,onScrollbarYEnabledChange:A,onCornerWidthChange:w,onCornerHeightChange:N,children:s.jsx(Nt.div,W(M({dir:$},o),{ref:T,style:M({position:"relative","--radix-scroll-area-corner-width":_+"px","--radix-scroll-area-corner-height":b+"px"},e.style)}))})});wF.displayName=RE;var bF="ScrollAreaViewport",jF=y.forwardRef((e,t)=>{const d=e,{__scopeScrollArea:r,children:n,nonce:i}=d,a=me(d,["__scopeScrollArea","children","nonce"]),o=ro(bF,r),l=y.useRef(null),c=sr(t,l,o.onViewportChange);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),s.jsx(Nt.div,W(M({"data-radix-scroll-area-viewport":""},a),{ref:c,style:M({overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden"},e.style),children:s.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:n})}))]})});jF.displayName=bF;var Pl="ScrollAreaScrollbar",ME=y.forwardRef((e,t)=>{const c=e,{forceMount:r}=c,n=me(c,["forceMount"]),i=ro(Pl,e.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:o}=i,l=e.orientation==="horizontal";return y.useEffect(()=>(l?a(!0):o(!0),()=>{l?a(!1):o(!1)}),[l,a,o]),i.type==="hover"?s.jsx(Fce,W(M({},n),{ref:t,forceMount:r})):i.type==="scroll"?s.jsx(Uce,W(M({},n),{ref:t,forceMount:r})):i.type==="auto"?s.jsx(NF,W(M({},n),{ref:t,forceMount:r})):i.type==="always"?s.jsx(DE,W(M({},n),{ref:t})):null});ME.displayName=Pl;var Fce=y.forwardRef((e,t)=>{const l=e,{forceMount:r}=l,n=me(l,["forceMount"]),i=ro(Pl,e.__scopeScrollArea),[a,o]=y.useState(!1);return y.useEffect(()=>{const c=i.scrollArea;let d=0;if(c){const u=()=>{window.clearTimeout(d),o(!0)},h=()=>{d=window.setTimeout(()=>o(!1),i.scrollHideDelay)};return c.addEventListener("pointerenter",u),c.addEventListener("pointerleave",h),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",u),c.removeEventListener("pointerleave",h)}}},[i.scrollArea,i.scrollHideDelay]),s.jsx($s,{present:r||a,children:s.jsx(NF,W(M({"data-state":a?"visible":"hidden"},n),{ref:t}))})}),Uce=y.forwardRef((e,t)=>{const d=e,{forceMount:r}=d,n=me(d,["forceMount"]),i=ro(Pl,e.__scopeScrollArea),a=e.orientation==="horizontal",o=Kw(()=>c("SCROLL_END"),100),[l,c]=$ce("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return y.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,i.scrollHideDelay,c]),y.useEffect(()=>{const u=i.viewport,h=a?"scrollLeft":"scrollTop";if(u){let f=u[h];const p=()=>{const x=u[h];f!==x&&(c("SCROLL"),o()),f=x};return u.addEventListener("scroll",p),()=>u.removeEventListener("scroll",p)}},[i.viewport,a,c,o]),s.jsx($s,{present:r||l!=="hidden",children:s.jsx(DE,W(M({"data-state":l==="hidden"?"hidden":"visible"},n),{ref:t,onPointerEnter:mt(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:mt(e.onPointerLeave,()=>c("POINTER_LEAVE"))}))})}),NF=y.forwardRef((e,t)=>{const r=ro(Pl,e.__scopeScrollArea),d=e,{forceMount:n}=d,i=me(d,["forceMount"]),[a,o]=y.useState(!1),l=e.orientation==="horizontal",c=Kw(()=>{if(r.viewport){const u=r.viewport.offsetWidth<r.viewport.scrollWidth,h=r.viewport.offsetHeight<r.viewport.scrollHeight;o(l?u:h)}},10);return am(r.viewport,c),am(r.content,c),s.jsx($s,{present:n||a,children:s.jsx(DE,W(M({"data-state":a?"visible":"hidden"},i),{ref:t}))})}),DE=y.forwardRef((e,t)=>{const f=e,{orientation:r="vertical"}=f,n=me(f,["orientation"]),i=ro(Pl,e.__scopeScrollArea),a=y.useRef(null),o=y.useRef(0),[l,c]=y.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=PF(l.viewport,l.content),u=W(M({},n),{sizes:l,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:p=>a.current=p,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:p=>o.current=p});function h(p,x){return Hce(p,o.current,l,x)}return r==="horizontal"?s.jsx(Bce,W(M({},u),{ref:t,onThumbPositionChange:()=>{if(i.viewport&&a.current){const p=i.viewport.scrollLeft,x=nA(p,l,i.dir);a.current.style.transform=`translate3d(${x}px, 0, 0)`}},onWheelScroll:p=>{i.viewport&&(i.viewport.scrollLeft=p)},onDragScroll:p=>{i.viewport&&(i.viewport.scrollLeft=h(p,i.dir))}})):r==="vertical"?s.jsx(zce,W(M({},u),{ref:t,onThumbPositionChange:()=>{if(i.viewport&&a.current){const p=i.viewport.scrollTop,x=nA(p,l);a.current.style.transform=`translate3d(0, ${x}px, 0)`}},onWheelScroll:p=>{i.viewport&&(i.viewport.scrollTop=p)},onDragScroll:p=>{i.viewport&&(i.viewport.scrollTop=h(p))}})):null}),Bce=y.forwardRef((e,t)=>{const u=e,{sizes:r,onSizesChange:n}=u,i=me(u,["sizes","onSizesChange"]),a=ro(Pl,e.__scopeScrollArea),[o,l]=y.useState(),c=y.useRef(null),d=sr(t,c,a.onScrollbarXChange);return y.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),s.jsx(kF,W(M({"data-orientation":"horizontal"},i),{ref:d,sizes:r,style:M({bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Yw(r)+"px"},e.style),onThumbPointerDown:h=>e.onThumbPointerDown(h.x),onDragScroll:h=>e.onDragScroll(h.x),onWheelScroll:(h,f)=>{if(a.viewport){const p=a.viewport.scrollLeft+h.deltaX;e.onWheelScroll(p),TF(p,f)&&h.preventDefault()}},onResize:()=>{c.current&&a.viewport&&o&&n({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:$2(o.paddingLeft),paddingEnd:$2(o.paddingRight)}})}}))}),zce=y.forwardRef((e,t)=>{const u=e,{sizes:r,onSizesChange:n}=u,i=me(u,["sizes","onSizesChange"]),a=ro(Pl,e.__scopeScrollArea),[o,l]=y.useState(),c=y.useRef(null),d=sr(t,c,a.onScrollbarYChange);return y.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),s.jsx(kF,W(M({"data-orientation":"vertical"},i),{ref:d,sizes:r,style:M({top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Yw(r)+"px"},e.style),onThumbPointerDown:h=>e.onThumbPointerDown(h.y),onDragScroll:h=>e.onDragScroll(h.y),onWheelScroll:(h,f)=>{if(a.viewport){const p=a.viewport.scrollTop+h.deltaY;e.onWheelScroll(p),TF(p,f)&&h.preventDefault()}},onResize:()=>{c.current&&a.viewport&&o&&n({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:$2(o.paddingTop),paddingEnd:$2(o.paddingBottom)}})}}))}),[Vce,SF]=_F(Pl),kF=y.forwardRef((e,t)=>{const T=e,{__scopeScrollArea:r,sizes:n,hasThumb:i,onThumbChange:a,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:u,onResize:h}=T,f=me(T,["__scopeScrollArea","sizes","hasThumb","onThumbChange","onThumbPointerUp","onThumbPointerDown","onThumbPositionChange","onDragScroll","onWheelScroll","onResize"]),p=ro(Pl,r),[x,g]=y.useState(null),v=sr(t,$=>g($)),_=y.useRef(null),w=y.useRef(""),b=p.viewport,N=n.content-n.viewport,S=ss(u),k=ss(c),O=Kw(h,10);function A($){if(_.current){const R=$.clientX-_.current.left,F=$.clientY-_.current.top;d({x:R,y:F})}}return y.useEffect(()=>{const $=R=>{const F=R.target;(x==null?void 0:x.contains(F))&&S(R,N)};return document.addEventListener("wheel",$,{passive:!1}),()=>document.removeEventListener("wheel",$,{passive:!1})},[b,x,N,S]),y.useEffect(k,[n,k]),am(x,O),am(p.content,O),s.jsx(Vce,{scope:r,scrollbar:x,hasThumb:i,onThumbChange:ss(a),onThumbPointerUp:ss(o),onThumbPositionChange:k,onThumbPointerDown:ss(l),children:s.jsx(Nt.div,W(M({},f),{ref:v,style:M({position:"absolute"},f.style),onPointerDown:mt(e.onPointerDown,$=>{$.button===0&&($.target.setPointerCapture($.pointerId),_.current=x.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),A($))}),onPointerMove:mt(e.onPointerMove,A),onPointerUp:mt(e.onPointerUp,$=>{const R=$.target;R.hasPointerCapture($.pointerId)&&R.releasePointerCapture($.pointerId),document.body.style.webkitUserSelect=w.current,p.viewport&&(p.viewport.style.scrollBehavior=""),_.current=null})}))})}),I2="ScrollAreaThumb",EF=y.forwardRef((e,t)=>{const a=e,{forceMount:r}=a,n=me(a,["forceMount"]),i=SF(I2,e.__scopeScrollArea);return s.jsx($s,{present:r||i.hasThumb,children:s.jsx(qce,M({ref:t},n))})}),qce=y.forwardRef((e,t)=>{const h=e,{__scopeScrollArea:r,style:n}=h,i=me(h,["__scopeScrollArea","style"]),a=ro(I2,r),o=SF(I2,r),{onThumbPositionChange:l}=o,c=sr(t,f=>o.onThumbChange(f)),d=y.useRef(void 0),u=Kw(()=>{d.current&&(d.current(),d.current=void 0)},100);return y.useEffect(()=>{const f=a.viewport;if(f){const p=()=>{if(u(),!d.current){const x=Gce(f,l);d.current=x,l()}};return l(),f.addEventListener("scroll",p),()=>f.removeEventListener("scroll",p)}},[a.viewport,u,l]),s.jsx(Nt.div,W(M({"data-state":o.hasThumb?"visible":"hidden"},i),{ref:c,style:M({width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)"},n),onPointerDownCapture:mt(e.onPointerDownCapture,f=>{const x=f.target.getBoundingClientRect(),g=f.clientX-x.left,v=f.clientY-x.top;o.onThumbPointerDown({x:g,y:v})}),onPointerUp:mt(e.onPointerUp,o.onThumbPointerUp)}))});EF.displayName=I2;var IE="ScrollAreaCorner",CF=y.forwardRef((e,t)=>{const r=ro(IE,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?s.jsx(Wce,W(M({},e),{ref:t})):null});CF.displayName=IE;var Wce=y.forwardRef((e,t)=>{const u=e,{__scopeScrollArea:r}=u,n=me(u,["__scopeScrollArea"]),i=ro(IE,r),[a,o]=y.useState(0),[l,c]=y.useState(0),d=!!(a&&l);return am(i.scrollbarX,()=>{var f;const h=((f=i.scrollbarX)==null?void 0:f.offsetHeight)||0;i.onCornerHeightChange(h),c(h)}),am(i.scrollbarY,()=>{var f;const h=((f=i.scrollbarY)==null?void 0:f.offsetWidth)||0;i.onCornerWidthChange(h),o(h)}),d?s.jsx(Nt.div,W(M({},n),{ref:t,style:M({width:a,height:l,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0},e.style)})):null});function $2(e){return e?parseInt(e,10):0}function PF(e,t){const r=e/t;return isNaN(r)?0:r}function Yw(e){const t=PF(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-r)*t;return Math.max(n,18)}function Hce(e,t,r,n="ltr"){const i=Yw(r),a=i/2,o=t||a,l=i-o,c=r.scrollbar.paddingStart+o,d=r.scrollbar.size-r.scrollbar.paddingEnd-l,u=r.content-r.viewport,h=n==="ltr"?[0,u]:[u*-1,0];return AF([c,d],h)(e)}function nA(e,t,r="ltr"){const n=Yw(t),i=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=t.scrollbar.size-i,o=t.content-t.viewport,l=a-n,c=r==="ltr"?[0,o]:[o*-1,0],d=_g(e,c);return AF([0,o],[0,l])(d)}function AF(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function TF(e,t){return e>0&&e<t}var Gce=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return function i(){const a={left:e.scrollLeft,top:e.scrollTop},o=r.left!==a.left,l=r.top!==a.top;(o||l)&&t(),r=a,n=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(n)};function Kw(e,t){const r=ss(e),n=y.useRef(0);return y.useEffect(()=>()=>window.clearTimeout(n.current),[]),y.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function am(e,t){const r=ss(t);is(()=>{let n=0;if(e){const i=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return i.observe(e),()=>{window.cancelAnimationFrame(n),i.unobserve(e)}}},[e,r])}var OF=wF,Yce=jF,Kce=CF;const Zw=y.forwardRef((i,n)=>{var a=i,{className:e,children:t}=a,r=me(a,["className","children"]);return s.jsxs(OF,W(M({ref:n,className:ke("relative overflow-hidden",e)},r),{children:[s.jsx(Yce,{className:"h-full w-full rounded-[inherit]",children:t}),s.jsx($E,{}),s.jsx(Kce,{})]}))});Zw.displayName=OF.displayName;const $E=y.forwardRef((i,n)=>{var a=i,{className:e,orientation:t="vertical"}=a,r=me(a,["className","orientation"]);return s.jsx(ME,W(M({ref:n,orientation:t,className:ke("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e)},r),{children:s.jsx(EF,{className:"relative flex-1 rounded-full bg-border"})}))});$E.displayName=ME.displayName;function Zce({userId:e,onSelectDraft:t,onNewReview:r,currentMode:n}){const[i,a]=y.useState([]),[o,l]=y.useState(!1),[c,d]=y.useState(!1),{toast:u}=jr(),h=()=>E(this,null,function*(){d(!0);try{const g=yield Ah.getUserDrafts(e);a(g)}catch(g){console.error("Error loading drafts:",g),u({title:"Error",description:"Failed to load draft reviews",variant:"destructive"})}finally{d(!1)}});y.useEffect(()=>{o&&h()},[o,e]);const f=g=>E(this,null,function*(){try{(yield Ah.deleteDraft(g,e))?(a(_=>_.filter(w=>w.id!==g)),u({title:"Draft Deleted",description:"Draft review has been deleted"})):u({title:"Error",description:"Failed to delete draft",variant:"destructive"})}catch(v){console.error("Error deleting draft:",v),u({title:"Error",description:"Failed to delete draft",variant:"destructive"})}}),p=g=>{t(g),l(!1)},x=g=>{var _,w;const v=[];return(_=g.selectedArtist)!=null&&_.name&&v.push(`Artist: ${g.selectedArtist.name}`),(w=g.selectedVenue)!=null&&w.name&&v.push(`Venue: ${g.selectedVenue.name}`),g.eventDate&&v.push(`Date: ${Dt(new Date(g.eventDate),"MMM d, yyyy")}`),g.performanceRating&&v.push(`Performance: ${g.performanceRating}/5`),g.venueRating&&v.push(`Venue: ${g.venueRating}/5`),g.overallExperienceRating&&v.push(`Overall: ${g.overallExperienceRating}/5`),g.reviewText&&v.push(`Review: ${g.reviewText.substring(0,50)}...`),v.length>0?v.join("  "):"Empty draft"};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsxs(oe,{variant:n==="new"?"default":"outline",size:"sm",onClick:r,className:"flex items-center gap-2",children:[s.jsx(Cu,{className:"w-4 h-4"}),"New Review"]}),s.jsxs(oe,{variant:n==="draft"?"default":"outline",size:"sm",onClick:()=>l(!0),className:"flex items-center gap-2",children:[s.jsx(ai,{className:"w-4 h-4"}),"View Drafts",i.length>0&&s.jsx(Be,{variant:"secondary",className:"ml-1",children:i.length})]})]}),s.jsx(tn,{open:o,onOpenChange:l,children:s.jsxs(Xr,{className:"max-w-2xl max-h-[80vh]",children:[s.jsx(Mn,{children:s.jsxs(an,{className:"flex items-center gap-2",children:[s.jsx(ai,{className:"w-5 h-5"}),"Draft Reviews"]})}),s.jsx(Zw,{className:"max-h-[60vh]",children:c?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-sm text-gray-500",children:"Loading drafts..."})}):i.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(ai,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Draft Reviews"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"You don't have any draft reviews. Start writing a review to create your first draft."}),s.jsx(oe,{onClick:r,children:"Create New Review"})]}):s.jsx("div",{className:"space-y-4",children:i.map(g=>s.jsxs(He,{className:"hover:shadow-md transition-shadow",children:[s.jsx(xr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx(Cr,{className:"text-base mb-1",children:g.event_title||"Untitled Event"}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[g.artist_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ct,{className:"w-3 h-3"}),g.artist_name]}),g.venue_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Xt,{className:"w-3 h-3"}),g.venue_name]}),g.event_date&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Et,{className:"w-3 h-3"}),Dt(new Date(g.event_date),"MMM d, yyyy")]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>p(g),className:"flex items-center gap-1",children:[s.jsx(Cu,{className:"w-3 h-3"}),"Continue"]}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>f(g.id),className:"flex items-center gap-1 text-red-600 hover:text-red-700",children:s.jsx(yc,{className:"w-3 h-3"})})]})]})}),s.jsxs(st,{className:"pt-0",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-2",children:x(g.draft_data)}),s.jsxs("div",{className:"text-xs text-gray-400",children:["Last saved: ",Dt(new Date(g.last_saved_at),"MMM d, yyyy 'at' h:mm a")]})]})]},g.id))})})]})})]})}class Xce{static sendReviewInvitations(t,r,n){return E(this,null,function*(){try{console.log(" Sending SMS invitations:",{phoneNumbers:t,reviewId:r,senderName:n});const{error:i}=yield P.functions.invoke("send-review-invitations",{body:{phoneNumbers:t,reviewId:r,senderName:n,message:`${n} tagged you in a concert review on Synth! Check it out: https://synth.app/reviews/${r}`}});i?console.error("Error invoking SMS function:",i):console.log(" SMS invitations sent successfully")}catch(i){console.error("Failed to send SMS invitations:",i)}})}static validatePhoneNumber(t){return/^\+[1-9]\d{1,14}$/.test(t)}static formatPhoneNumber(t){const r=t.replace(/[^\d+]/g,"");return r.startsWith("+")?r:`+${r}`}}const Jce=[{id:"artist-electric",label:"Electric energy",description:"The band fed off the crowd with nonstop energy.",sentiment:"positive"},{id:"artist-tight",label:"Tight musicianship",description:"Flawless set and tight transitions all night.",sentiment:"positive"},{id:"artist-weak-vocals",label:"Vocals struggled",description:"Vocals were off pitch for most of the night.",sentiment:"negative"},{id:"artist-short-set",label:"Short setlist",description:"Felt too quickleft wanting a few more songs.",sentiment:"negative"}],Qce=[{id:"production-lights",label:"Insane light show",description:"Lighting design elevated every drop.",sentiment:"positive"},{id:"production-soundmix",label:"Crystal clear mix",description:"Sound mix was balanced and immersive.",sentiment:"positive"},{id:"production-feedback",label:"Feedback issues",description:"Persistent sound issues distracted from songs.",sentiment:"negative"},{id:"production-lag",label:"Stage delays",description:"Long pauses between songs killed the momentum.",sentiment:"negative"}],ede=[{id:"venue-staff",label:"Staff was incredible",description:"Friendly staff kept lines moving smoothly.",sentiment:"positive"},{id:"venue-comfort",label:"Comfortable layout",description:"Plenty of space and easy sightlines.",sentiment:"positive"},{id:"venue-crowded",label:"Overcrowded",description:"Packed to the brim with no room to breathe.",sentiment:"negative"},{id:"venue-sound",label:"Muddy house sound",description:"Venue acoustics made everything sound muffled.",sentiment:"negative"}],tde=[{id:"location-easy",label:"Easy transit",description:"Quick rideshare + plenty of parking nearby.",sentiment:"positive"},{id:"location-food",label:"Great pre-show spots",description:"Awesome food and bars in walking distance.",sentiment:"positive"},{id:"location-traffic",label:"Nightmare traffic",description:"Getting there and back took forever.",sentiment:"negative"},{id:"location-safety",label:"Felt unsafe",description:"Area felt sketchy walking back to the car.",sentiment:"negative"}],rde=[{id:"value-worth-every-dollar",label:"Worth every dollar",description:"Totally justified the ticket price.",sentiment:"positive"},{id:"value-underpriced",label:"Steal of a night",description:"Felt like we paid half of what it was worth.",sentiment:"positive"},{id:"value-overpriced",label:"Overpriced",description:"Fun night, but tickets were overpriced.",sentiment:"negative"},{id:"value-hidden-fees",label:"Too many fees",description:"Fees and merch prices added up fast.",sentiment:"negative"}],Ej=e=>{if(!e)return["Select time"];switch(e){case"quick":return["Select time","Event details","Quick review","Submit"];case"standard":return["Select time","Event details","Artist performance","Venue","Review content","Submit"];case"detailed":return["Select time","Event details","Artist performance","Production","Venue","Location","Value","Review content","Submit"];default:return[]}};function RF({event:e,userId:t,onSubmitted:r,onDeleted:n,onClose:i}){var qt,lr,Ge,Le,yt;const{toast:a}=jr(),{formData:o,errors:l,isLoading:c,updateFormData:d,setLoading:u,resetForm:h,setFormData:f,currentStep:p,nextStep:x,prevStep:g,canProceed:v,canGoBack:_,isLastStep:w,totalSteps:b,currentFlow:N}=yce(),[S,k]=y.useState(null),[O]=y.useState([]),[A,T]=y.useState(!1),[$,R]=y.useState(null),[F,D]=y.useState(!1),[B,U]=y.useState(null),[V,Y]=y.useState(!1);y.useEffect(()=>{Y(!1)},[e==null?void 0:e.id]);const z=Ne=>Ne?/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Ne):!1,K=()=>{var Ne;return(Ne=e.id)!=null&&Ne.startsWith("new-review")||z(e.id)?e.id:""},[Z,G]=y.useState(K()),[X,te]=y.useState(null),[se,ue]=y.useState(!1),[ye,ne]=y.useState(null);y.useEffect(()=>{E(this,null,function*(){var Qe;if(!((Qe=o.selectedVenue)!=null&&Qe.is_from_database)||!o.selectedVenue.id||!t||S){ne(null);return}const Oe=o.selectedVenue.id,ce=Z||e.id||"";if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Oe)){ne(null);return}try{const vt=yield fs.getPreviousVenueReview(t,Oe,ce);ne(vt)}catch(vt){console.error("Error checking for previous venue review:",vt),ne(null)}})},[(qt=o.selectedVenue)==null?void 0:qt.id,t,Z,e.id,S]);const xe=Ne=>{if(!Ne)return"";const Oe=new Date(Ne);return Number.isNaN(Oe.getTime())?"":Oe.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},ge=Ne=>{d({selectedSetlist:Ne}),ue(!1)},ie=()=>{d({selectedSetlist:null})},ee=Ne=>{d({customSetlist:Ne})},{manualSave:H,loadDraft:le,clearDraft:Se}=Ice({userId:t,eventId:Z||null,formData:o,enabled:!V,debounceMs:2e3,onSave:Ne=>{D(!1),Ne&&U(new Date)},onEventIdChange:Ne=>{Ne&&Ne!==Z&&G(Ne)}}),ae=y.useMemo(()=>{var Oe,ce;const Ne=(Oe=o.selectedArtist)==null?void 0:Oe.name;return{2:{title:"Artist Performance",subtitle:Ne?`How did ${Ne} deliver live? Share your honest take.`:"How did the artist deliver live? Share your honest take.",ratingKey:"artistPerformanceRating",feedbackKey:"artistPerformanceFeedback",helperText:"Tap a star (half points allowed) to capture the performance.",suggestions:Jce},3:{title:"Production Quality",subtitle:"Lights, visuals, sound mix  did the production elevate the night?",ratingKey:"productionRating",feedbackKey:"productionFeedback",helperText:"Think about sound clarity, lighting, visuals, and pacing.",suggestions:Qce},4:{title:"Venue Experience",subtitle:(ce=o.selectedVenue)!=null&&ce.name?`What was ${o.selectedVenue.name} like to be in?`:"Consider the staff, comfort, lines, and vibe inside the venue.",ratingKey:"venueRating",feedbackKey:"venueFeedback",helperText:"Include staff vibes, comfort, and amenities.",suggestions:ede},5:{title:"Location & Logistics",subtitle:"Getting there, getting home, nearby spots  how easy was the night?",ratingKey:"locationRating",feedbackKey:"locationFeedback",helperText:"Parking, transit, food options, safety  it all counts.",suggestions:tde},6:{title:"Value for Ticket Price",subtitle:"Given what you paid, did the experience feel worth it?",ratingKey:"valueRating",feedbackKey:"valueFeedback",helperText:"Honest value helps fans budget for future shows.",suggestions:rde}}},[(lr=o.selectedArtist)==null?void 0:lr.name,(Ge=o.selectedVenue)==null?void 0:Ge.name]);y.useEffect(()=>{E(this,null,function*(){var Oe,ce,Ee,Qe,vt,wt,Ht,Rt,Te;if(!(!e||!t))try{const bt=e==null?void 0:e.existing_review_id;let $e=null;if(bt&&z(bt)){const{data:Ie,error:Ue}=yield P.from("reviews").select("*").eq("id",bt).maybeSingle();Ie&&!Ue&&($e=Ie)}else z(e.id)&&($e=yield fs.getUserEventReview(t,e.id));if(!$e){const Ie=le(e.id);Ie&&(console.log(" Loaded draft from localStorage for event:",e.id),f(Ie))}if($e){k($e);let Ie=null;if(e){const dt="artist_id"in e||"venue_id"in e;Ie={artist_name:"artist_name"in e?e.artist_name:void 0,artist_id:dt&&"artist_id"in e?e.artist_id:void 0,venue_name:"venue_name"in e?e.venue_name:void 0,venue_id:dt&&"venue_id"in e?e.venue_id:void 0,event_date:"event_date"in e?e.event_date:void 0}}const Ue=Ie!=null&&Ie.event_date?String(Ie.event_date).split("T")[0]:e!=null&&e.event_date?String(e.event_date).split("T")[0]:($e.created_at||"").split("T")[0];f({selectedArtist:null,selectedVenue:null,eventDate:Ue,artistPerformanceRating:$e.artist_performance_rating||$e.rating,productionRating:$e.production_rating||$e.artist_performance_rating||$e.rating,venueRating:$e.venue_rating||$e.rating,locationRating:$e.location_rating||$e.venue_rating||$e.rating,valueRating:$e.value_rating||$e.rating,artistPerformanceFeedback:$e.artist_performance_feedback||"",productionFeedback:$e.production_feedback||"",venueFeedback:$e.venue_feedback||"",locationFeedback:$e.location_feedback||"",valueFeedback:$e.value_feedback||"",ticketPricePaid:$e.ticket_price_paid?String($e.ticket_price_paid):"",rating:$e.rating,reviewText:$e.review_text||"",photos:$e.photos||[],videos:$e.videos||[],selectedSetlist:$e.setlist||null,customSetlist:$e.custom_setlist||[],isPublic:$e.is_public,reviewType:$e.review_type||"event"});try{const dt=(Ie==null?void 0:Ie.artist_name)||(e==null?void 0:e.artist_name)||((Oe=e==null?void 0:e.artist)==null?void 0:Oe.name),be=(Ie==null?void 0:Ie.artist_id)||(e==null?void 0:e.artist_id)||((ce=e==null?void 0:e.artist)==null?void 0:ce.id),Re=(Ie==null?void 0:Ie.venue_name)||(e==null?void 0:e.venue_name)||((Ee=e==null?void 0:e.venue)==null?void 0:Ee.name),We=(Ie==null?void 0:Ie.venue_id)||$e.venue_id||((Qe=e==null?void 0:e.venue)==null?void 0:Qe.id),St=Ie!=null&&Ie.event_date?String(Ie.event_date).split("T")[0]:e!=null&&e.event_date?String(e.event_date).split("T")[0]:null,Ye=dt?{id:be||`manual-${dt}`,name:dt,is_from_database:!!be}:null,ir=Re?{id:We||`manual-${Re}`,name:Re,is_from_database:!!We}:null,jt={selectedArtist:Ye,selectedVenue:ir,selectedSetlist:e.setlist||((vt=e==null?void 0:e.existing_review)==null?void 0:vt.selectedSetlist)||null,eventDate:St||o.eventDate};console.log(" Pre-populating form data for edit:",{selectedArtist:Ye,selectedVenue:ir,hasSetlist:!!jt.selectedSetlist,eventDate:jt.eventDate,eventDateFromEvent:St,eventDetails:Ie}),f(jt)}catch(dt){console.error(" Error pre-populating artist/venue:",dt)}}else{k(null),h(),Y(!1);try{const Ie=(e==null?void 0:e.artist_name)||((wt=e==null?void 0:e.artist)==null?void 0:wt.name),Ue=(e==null?void 0:e.artist_id)||((Ht=e==null?void 0:e.artist)==null?void 0:Ht.id)||void 0,dt=(e==null?void 0:e.venue_name)||((Rt=e==null?void 0:e.venue)==null?void 0:Rt.name),be=(e==null?void 0:e.venue_id)||((Te=e==null?void 0:e.venue)==null?void 0:Te.id)||void 0,Re=(e==null?void 0:e.event_date)||(e==null?void 0:e.date)||void 0,We=Ie?{id:Ue||`manual-${Ie}`,name:Ie,is_from_database:!!Ue}:null,St=dt?{id:be||`manual-${dt}`,name:dt,is_from_database:!!be}:null,Ye=Re?String(Re).split("T")[0]:"";f(M(M(M({reviewType:"event"},We?{selectedArtist:We}:{}),St?{selectedVenue:St}:{}),Ye?{eventDate:Ye}:{}))}catch(Ie){f({reviewType:"event"})}}}catch(bt){console.error("Error loading review for single page form",bt)}})},[e==null?void 0:e.id,t]);const fe=()=>E(this,null,function*(){var $e,Ie,Ue,dt,be,Re,We,St,Ye,ir,jt,pt,vn,Jn,Fs,Mt,re,_e,Ke,ht,ct,Pe,et,nt,Me,gt,cr,Wr,bn,xn,fn,Bn,ms,ls;if(!t){a({title:"Authentication Required",description:"Please log in to submit a review.",variant:"destructive"});return}const Ne=[];o.reviewType==="event"?(o.selectedArtist||Ne.push("Please select an artist"),o.selectedVenue||Ne.push("Please select a venue"),o.eventDate||Ne.push("Please select an event date")):o.reviewType==="venue"?o.selectedVenue||Ne.push("Please select a venue"):o.reviewType==="artist"&&(o.selectedArtist||Ne.push("Please select an artist"));const Oe=N||"detailed";if(Oe==="quick"?((!o.rating||o.rating<.5||o.rating>5)&&Ne.push("Please provide an overall rating (0.5 - 5 stars)"),!o.reviewText||o.reviewText.trim()===""?Ne.push("Please share a brief description of your experience"):o.reviewText.length>200&&Ne.push("Review text must be 200 characters or less for quick review")):Oe==="standard"?((!o.artistPerformanceRating||o.artistPerformanceRating<.5||o.artistPerformanceRating>5)&&Ne.push("Please rate the artist performance (0.5 - 5 stars)"),(!o.venueRating||o.venueRating<.5||o.venueRating>5)&&Ne.push("Please rate the venue (0.5 - 5 stars)"),!o.reviewText||o.reviewText.trim()===""?Ne.push("Please share a description of your experience"):o.reviewText.length>400&&Ne.push("Review text must be 400 characters or less for standard review")):([[o.artistPerformanceRating,"artist performance"],[o.productionRating,"production quality"],[o.venueRating,"venue"],[o.locationRating,"location & logistics"],[o.valueRating,"value for the ticket price"]].forEach(([Pt,It])=>{!Pt||Pt===0?Ne.push(`Please rate the ${It}`):(Pt<.5||Pt>5)&&Ne.push(`The ${It} rating must be between 0.5 and 5.0 stars`)}),!o.reviewText||o.reviewText.trim()===""?Ne.push("Please share a brief description of your experience"):o.reviewText.length>500&&Ne.push("Review text must be 500 characters or less")),[[o.artistPerformanceFeedback,"Artist performance note must be 400 characters or less"],[o.productionFeedback,"Production note must be 400 characters or less"],[o.venueFeedback,"Venue note must be 400 characters or less"],[o.locationFeedback,"Location note must be 400 characters or less"],[o.valueFeedback,"Value note must be 400 characters or less"]].forEach(([Bt,Pt])=>{Bt&&Bt.length>400&&Ne.push(Pt)}),o.ticketPricePaid){const Bt=Number(o.ticketPricePaid);Number.isNaN(Bt)?Ne.push("Ticket price must be a valid number"):Bt<0&&Ne.push("Ticket price cannot be negative")}if(Ne.length>0){const Bt=Ne.length===1?Ne[0]:`Please complete the following:
 ${Ne.join(`
 `)}`;a({title:"Incomplete Review",description:Bt,variant:"destructive",duration:6e3});return}let Ee=z(Z)?Z:z(e.id)?e.id:Z||e.id,Qe;try{const Bt=o.selectedArtist||(e==null?void 0:e.artist)||null,Pt=(Bt==null?void 0:Bt.id)||((Ue=(Ie=($e=Bt==null?void 0:Bt.identifier)==null?void 0:$e.split)==null?void 0:Ie.call($e,":"))==null?void 0:Ue[1]);if(console.log(" EventReviewForm: Artist resolution - candidate:",Bt,"jambaseArtistId:",Pt),Pt){if(console.log(" EventReviewForm: Looking up artist with jambaseArtistId:",Pt),Bt!=null&&Bt.identifier){const{data:It}=yield P.from("artists").select("id").eq("identifier",Bt.identifier).limit(1).maybeSingle();It&&(Qe=It.id,console.log(" EventReviewForm: Found existing artist by identifier:",Qe))}if(!Qe&&(Bt!=null&&Bt.name)){const{data:It}=yield P.from("artists").select("id").ilike("name",Bt.name).limit(1).maybeSingle();It&&(Qe=It.id,console.log(" EventReviewForm: Found existing artist by name:",Qe))}Qe||console.log(" EventReviewForm: Artist not found in database")}}catch(Bt){}let vt=(dt=o.selectedVenue)!=null&&dt.is_from_database?o.selectedVenue.id:void 0;if(!vt&&o.selectedVenue)try{const Bt=o.selectedVenue.identifier,Pt=typeof Bt=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Bt);let It;if(Pt){const kt=yield P.from("venues").select("id").eq("identifier",Bt).limit(1);It=Array.isArray(kt.data)&&kt.data.length>0?kt.data[0].id:void 0}if(It)vt=It;else{const kt=yield P.from("venues").select("id").ilike("name",`%${o.selectedVenue.name}%`).limit(1);It=Array.isArray(kt.data)&&kt.data.length>0?kt.data[0].id:void 0,It&&(vt=It)}}catch(Bt){}vt&&!z(vt)&&(vt=void 0);const wt=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Ee),Ht=!wt||((be=e==null?void 0:e.id)==null?void 0:be.startsWith("new-review")),Rt=o.selectedArtist&&S&&o.selectedArtist.name!==(S.artist_name||(e==null?void 0:e.artist_name)),Te=o.selectedVenue&&S&&o.selectedVenue.name!==(S.venue_name||(e==null?void 0:e.venue_name)),bt=Ht||Rt||Te;if(wt&&!((Re=e==null?void 0:e.id)!=null&&Re.startsWith("new-review"))&&!bt&&o.eventDate&&o.eventDate.trim()!=="")try{const Bt=new Date(o.eventDate+"T20:00:00Z");if(!isNaN(Bt.getTime())){const{data:Pt}=yield P.from("events").select("event_date").eq("id",Ee).single();if(Pt){const It=new Date(Pt.event_date),kt=Bt;Math.abs((kt.getTime()-It.getTime())/(1e3*60*60*24))>1&&(console.log(" Updating event date from",It,"to",kt),yield P.from("events").update({event_date:Bt.toISOString()}).eq("id",Ee))}}}catch(Bt){console.error(" Error updating event date:",Bt)}if(bt)try{if(!o.eventDate||o.eventDate.trim()==="")throw new Error("Event date is required");const Bt=new Date(o.eventDate+"T20:00:00Z");if(isNaN(Bt.getTime()))throw new Error(`Invalid event date: ${o.eventDate}`);const Pt=(We=o.selectedVenue)!=null&&We.is_from_database&&z(o.selectedVenue.id)?o.selectedVenue.id:null,It=(St=o.selectedArtist)==null?void 0:St.is_from_database,kt=Qe||(It&&z((Ye=o.selectedArtist)==null?void 0:Ye.id)?o.selectedArtist.id:null);let rr=W(M(M({title:`${((ir=o.selectedArtist)==null?void 0:ir.name)||"Concert"} at ${((jt=o.selectedVenue)==null?void 0:jt.name)||"Venue"}`},kt?{artist_id:kt}:{}),Pt?{venue_id:Pt}:{}),{venue_city:((vn=(pt=o.selectedVenue)==null?void 0:pt.address)==null?void 0:vn.addressLocality)||"Unknown",venue_state:((Fs=(Jn=o.selectedVenue)==null?void 0:Jn.address)==null?void 0:Fs.addressRegion)||"Unknown",event_date:Bt.toISOString(),description:`Concert by ${((Mt=o.selectedArtist)==null?void 0:Mt.name)||""} at ${((re=o.selectedVenue)==null?void 0:re.name)||""}`}),mr={data:null,error:null};try{const{MissingEntityRequestService:Hr}=yield on(()=>E(this,null,function*(){const{MissingEntityRequestService:dn}=yield import("./missingEntityRequestService-DTKxUBjt.js");return{MissingEntityRequestService:dn}}),[],import.meta.url);yield Hr.submitRequest({entity_type:"event",entity_name:rr.title,entity_date:rr.event_date,entity_location:`${rr.venue_city}, ${rr.venue_state}`,additional_info:{artist_id:kt,venue_id:Pt}}),console.log(" Submitted request for missing event:",rr.title),a({title:"Event Request Submitted",description:"Your event request has been submitted for review. You can still write your review."}),mr.data={id:`pending-${Date.now()}`}}catch(Hr){console.error(" Error submitting event request:",Hr),mr.error=Hr,a({title:"Request Submission Failed",description:"Could not submit event request, but you can still write your review.",variant:"destructive"})}if(!mr.error&&vt?console.log(" EventReviewForm: VenueId resolved for ReviewService:",vt):console.log(" EventReviewForm: No venueId resolved:",{venueId:vt,hasError:!!mr.error}),mr.error)throw mr.error;Ee=mr.data.id,G(mr.data.id),S&&(Rt||Te)&&(console.log(" EventReviewForm: Artist/venue changed, deleting old review and creating new one"),yield P.from("reviews").delete().eq("id",S.id),k(null))}catch(Bt){console.error("Error creating event:",Bt),a({title:"Error",description:"Failed to create event entry. Please try again.",variant:"destructive"});return}u(!0),Y(!0);try{const Bt=O.length?`

Show rankings:
${O.slice().sort((Kt,Nr)=>Nr.rating-Kt.rating||Kt.order-Nr.order).map((Kt,Nr)=>`${Nr+1}. ${Kt.show_name||"Show"}${Kt.show_date?` (${Kt.show_date})`:""}${Kt.venue_name?` @ ${Kt.venue_name}`:""}  ${Kt.rating}/5${O.filter(zr=>zr.rating===Kt.rating).length>1?` [tie #${Kt.order}]`:""}`).join(`
`)}
        `:"",Pt=N||"detailed";let It;if(Pt==="quick")It=typeof o.rating=="number"&&o.rating>0?o.rating:void 0;else if(Pt==="standard"){const Kt=[o.artistPerformanceRating,o.venueRating].filter(Nr=>typeof Nr=="number"&&Nr>0);It=Kt.length>0?Number((Kt.reduce((Nr,zr)=>Nr+zr,0)/Kt.length).toFixed(1)):typeof o.rating=="number"&&o.rating>0?o.rating:void 0}else{const Kt=[o.artistPerformanceRating,o.productionRating,o.venueRating,o.locationRating,o.valueRating].filter(Nr=>typeof Nr=="number"&&Nr>0);It=Kt.length>0?Number((Kt.reduce((Nr,zr)=>Nr+zr,0)/Kt.length).toFixed(1)):typeof o.rating=="number"&&o.rating>0?o.rating:void 0}const kt=o.ticketPricePaid?Number(o.ticketPricePaid):void 0;let rr;Pt==="quick"?rr=typeof It=="number"&&It>0?Number(It.toFixed(1)):void 0:rr=typeof o.artistPerformanceRating=="number"&&o.artistPerformanceRating>0?Number(o.artistPerformanceRating.toFixed(1)):void 0;const mr=typeof o.productionRating=="number"&&o.productionRating>0?Number(o.productionRating.toFixed(1)):void 0,Hr=typeof o.venueRating=="number"&&o.venueRating>0?Number(o.venueRating.toFixed(1)):void 0,dn=typeof o.locationRating=="number"&&o.locationRating>0?Number(o.locationRating.toFixed(1)):void 0,bi=typeof o.valueRating=="number"&&o.valueRating>0?Number(o.valueRating.toFixed(1)):void 0,tr=((_e=o.artistPerformanceFeedback)==null?void 0:_e.trim())||void 0,Gr=((Ke=o.productionFeedback)==null?void 0:Ke.trim())||void 0,Ui=((ht=o.venueFeedback)==null?void 0:ht.trim())||void 0,di=((ct=o.locationFeedback)==null?void 0:ct.trim())||void 0,Dr=((Pe=o.valueFeedback)==null?void 0:Pe.trim())||void 0,Ur={review_type:"event",rating:typeof It=="number"&&It>0?It:void 0,artist_performance_rating:rr,production_rating:mr,venue_rating:Hr,location_rating:dn,value_rating:bi,artist_performance_feedback:tr,production_feedback:Gr,venue_feedback:Ui,location_feedback:di,value_feedback:Dr,ticket_price_paid:typeof kt=="number"&&!Number.isNaN(kt)?kt:void 0,review_text:(o.reviewText.trim()+Bt).trim()||void 0,photos:o.photos&&o.photos.length>0?o.photos:void 0,videos:o.videos&&o.videos.length>0?o.videos:void 0,setlist:o.selectedSetlist!==void 0?o.selectedSetlist:(S==null?void 0:S.setlist)||void 0,custom_setlist:o.customSetlist&&o.customSetlist.length>0?o.customSetlist:void 0,is_public:o.isPublic};console.log(" EventReviewForm: Review data being saved:",{rating:Ur.rating,decimalAverage:It,hasSetlist:!!Ur.setlist,setlistData:Ur.setlist,formDataSelectedSetlist:o.selectedSetlist,hasCustomSetlist:!!Ur.custom_setlist,customSetlistSongCount:((et=Ur.custom_setlist)==null?void 0:et.length)||0,categoryRatings:{artist_performance_rating:Ur.artist_performance_rating,production_rating:Ur.production_rating,venue_rating:Ur.venue_rating,location_rating:Ur.location_rating,value_rating:Ur.value_rating},categoryFeedback:{artist_performance_feedback:Ur.artist_performance_feedback,production_feedback:Ur.production_feedback,venue_feedback:Ur.venue_feedback,location_feedback:Ur.location_feedback,value_feedback:Ur.value_feedback},formDataRatings:{artistPerformanceRating:o.artistPerformanceRating,productionRating:o.productionRating,venueRating:o.venueRating,locationRating:o.locationRating,valueRating:o.valueRating},formDataFeedback:{artistPerformanceFeedback:o.artistPerformanceFeedback,productionFeedback:o.productionFeedback,venueFeedback:o.venueFeedback,locationFeedback:o.locationFeedback,valueFeedback:o.valueFeedback}});let jn=(nt=o.selectedVenue)!=null&&nt.is_from_database?o.selectedVenue.id:void 0;if(!jn&&o.selectedVenue)try{const Kt=o.selectedVenue.identifier,Nr=typeof Kt=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Kt);let zr;if(Nr){const hn=yield P.from("venues").select("id").eq("identifier",Kt).limit(1);zr=Array.isArray(hn.data)&&hn.data.length>0?hn.data[0].id:void 0}if(zr)jn=zr;else{const hn=yield P.from("venues").select("id").ilike("name",`%${o.selectedVenue.name}%`).limit(1),ps=Array.isArray(hn.data)&&hn.data.length>0?hn.data[0].id:void 0;if(ps)jn=ps;else{const ma=`user-created-${Date.now()}`;if(!(yield P.from("venues").insert({jambase_venue_id:ma,name:o.selectedVenue.name,identifier:Nr?Kt:`user-created-${o.selectedVenue.name.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`,address:typeof o.selectedVenue.address=="string"?o.selectedVenue.address:((Me=o.selectedVenue.address)==null?void 0:Me.streetAddress)||null,city:((gt=o.selectedVenue.address)==null?void 0:gt.addressLocality)||null,state:((cr=o.selectedVenue.address)==null?void 0:cr.addressRegion)||null,zip:((Wr=o.selectedVenue.address)==null?void 0:Wr.postalCode)||null,country:((bn=o.selectedVenue.address)==null?void 0:bn.addressCountry)||"US",latitude:((xn=o.selectedVenue.geo)==null?void 0:xn.latitude)||null,longitude:((fn=o.selectedVenue.geo)==null?void 0:fn.longitude)||null,image_url:o.selectedVenue.image_url||null,url:o.selectedVenue.url||null,date_published:new Date().toISOString(),date_modified:new Date().toISOString()})).error){if(Nr){const yn=yield P.from("venues").select("id").eq("identifier",Kt).limit(1);Array.isArray(yn.data)&&yn.data.length>0&&(jn=yn.data[0].id)}if(!jn){const yn=yield P.from("venues").select("id").ilike("name",`%${o.selectedVenue.name}%`).limit(1);Array.isArray(yn.data)&&yn.data.length>0&&(jn=yn.data[0].id)}}}}}catch(Kt){}jn&&!z(jn)&&(jn=void 0);const zn=z(Ee)?Ee:void 0,Yr=jn&&z(jn)?jn:void 0,Ns=Qe&&z(Qe)?Qe:void 0;if(!zn&&(!Ns||!Yr))throw new Error("Unable to determine a valid event ID or artist+venue combination for this review.");let Ta;if(o.eventDate&&o.eventDate.trim()!==""){const Kt=new Date(o.eventDate+"T00:00:00Z");isNaN(Kt.getTime())||(Ta=Kt)}else e!=null&&e.event_date&&(Ta=new Date(e.event_date));const qo=M(M({},Ur),Ta?{Event_date:Ta}:{}),Nn=yield fs.setEventReview(t,zn,qo,Yr,Ns);zn&&Se(zn);try{console.log(" EventReviewForm: Starting NUCLEAR draft deletion:",{eventId:zn,artistId:Ns,venueId:Yr});let Kt=P.from("reviews").delete().eq("user_id",t).eq("is_draft",!0).select("id");zn?Kt=Kt.eq("event_id",zn):Ns&&Yr&&(Kt=Kt.eq("artist_id",Ns).eq("venue_id",Yr).is("event_id",null));const{error:Nr,data:zr}=yield Kt;if(Nr)console.error(" EventReviewForm: First deletion failed:",Nr);else{const ps=(zr==null?void 0:zr.length)||0;console.log(` EventReviewForm: Deleted ${ps} draft(s)`)}if((Bn=o.selectedArtist)!=null&&Bn.name&&((ms=o.selectedVenue)!=null&&ms.name)&&o.eventDate){console.log(" EventReviewForm: Looking for matching drafts by artist/venue/date...");const{data:ps,error:ma}=yield P.from("reviews").select("id, event_id, draft_data, is_draft").eq("user_id",t).eq("is_draft",!0);if(!ma&&ps){const ji=ps.filter(yn=>{var Rc,Mc,Tl,Ol;if(!yn.draft_data)return!1;const Qn=yn.draft_data,wf=((Rc=Qn==null?void 0:Qn.selectedArtist)==null?void 0:Rc.name)||(Qn==null?void 0:Qn.artist_name),dr=((Mc=Qn==null?void 0:Qn.selectedVenue)==null?void 0:Mc.name)||(Qn==null?void 0:Qn.venue_name),Bi=Qn==null?void 0:Qn.eventDate,cn=wf===((Tl=o.selectedArtist)==null?void 0:Tl.name)&&dr===((Ol=o.selectedVenue)==null?void 0:Ol.name)&&Bi===o.eventDate;return cn&&console.log(` EventReviewForm: Found matching draft ${yn.id} for same concert (different event_id)`),cn});for(const yn of ji)console.log(` EventReviewForm: Deleting matching draft ${yn.id}`),yield P.from("reviews").delete().eq("id",yn.id);ji.length>0&&console.log(` EventReviewForm: Deleted ${ji.length} matching draft(s) for same concert`)}}yield new Promise(ps=>setTimeout(ps,200));const hn=yield P.from("reviews").select("id, is_draft").eq("user_id",t).eq("event_id",Ee).eq("is_draft",!0);hn.data&&hn.data.length>0?(console.error(` EventReviewForm: ${hn.data.length} draft(s) STILL EXIST! Force deleting...`,hn.data),yield P.from("reviews").delete().eq("user_id",t).eq("event_id",Ee).eq("is_draft",!0)):console.log(" EventReviewForm: Verified - all drafts for this event successfully deleted")}catch(Kt){console.error(" EventReviewForm: CRITICAL error during draft deletion:",Kt)}try{const Kt=Nn.id||"unknown",Nr=z(Nn.id)?Nn.id:null;let zr,hn,ps=null;Ns?(zr="artist",hn=Ns,ps=Ns):Yr?(zr="venue",hn=Yr,ps=Yr):zn&&(zr="event",hn=zn,ps=zn);const ma={artist_performance_rating:Ur.artist_performance_rating,production_rating:Ur.production_rating,venue_rating:Ur.venue_rating,location_rating:Ur.location_rating,value_rating:Ur.value_rating,is_public:Ur.is_public,has_text:!!Ur.review_text,text_length:((ls=Ur.review_text)==null?void 0:ls.length)||0,reviewType:o.reviewType};zr&&hn&&(ma.reviewed_entity_type=zr,ma.reviewed_entity_id=hn),wn.review("review",Kt,Ur.rating,ma,Nr);const ji={reviewType:o.reviewType};zr&&hn&&(ji.reviewed_entity_type=zr,ji.reviewed_entity_id=hn),wn.formSubmit("review",Kt,!0,ji,Nr)}catch(Kt){}if(a({title:S?"Review Updated":"Review Submitted! ",description:S?"Your review has been updated.":"Thanks for sharing your concert experience!"}),o.attendees&&o.attendees.length>0){const Kt=o.attendees.filter(Nr=>Nr.type==="phone").map(Nr=>Nr.phone);if(Kt.length>0)try{const{data:Nr}=yield P.from("users").select("name").eq("user_id",t).single(),zr=(Nr==null?void 0:Nr.name)||"A friend";yield Xce.sendReviewInvitations(Kt,Nn.id,zr)}catch(Nr){console.error("Failed to send SMS invitations:",Nr)}}if(S){if(r){console.log(" Calling onSubmitted callback immediately after edit");const Kt=r(Nn);Kt instanceof Promise&&(yield Kt)}}else{console.log(" New review submitted, checking if we should show ranking modal"),console.log("  Review data:",{id:Nn.id,rating:Nn.rating,artist_performance_rating:Nn.artist_performance_rating,production_rating:Nn.production_rating,venue_rating:Nn.venue_rating,location_rating:Nn.location_rating,value_rating:Nn.value_rating});const Kt=[Nn.artist_performance_rating,Nn.production_rating,Nn.venue_rating,Nn.location_rating,Nn.value_rating].filter(zr=>typeof zr=="number"&&zr>0),Nr=Kt.length===5?Kt.reduce((zr,hn)=>zr+hn,0)/Kt.length:Nn.rating;console.log("  Effective rating for modal:",Nr),console.log("  Opening ranking modal with review ID:",Nn.id),console.log("   Deferring onSubmitted callback until ranking modal closes to avoid unmounting component"),R(Nn),setTimeout(()=>{T(!0),console.log("   Modal state updated:",{showRankingModal:!0,submittedReview:Nn.id})},100)}}catch(Bt){const Pt=Bt instanceof Error?Bt.message:String(Bt);console.error("Error submitting review:",Bt),a({title:"Error",description:`Failed to submit review: ${Pt}`,variant:"destructive"}),Y(!1)}finally{u(!1)}}),he=()=>E(this,null,function*(){console.log(" Ranking modal closing"),T(!1);const Ne=$;if(R(null),h(),Y(!1),r&&Ne){console.log(" Calling onSubmitted callback after ranking modal close");const Oe=r(Ne);Oe instanceof Promise&&(yield Oe)}}),pe=()=>{const Ne=[o.artistPerformanceRating,o.productionRating,o.venueRating,o.locationRating,o.valueRating].filter(Oe=>typeof Oe=="number"&&Oe>0);return Ne.length>0?Ne.reduce((Oe,ce)=>Oe+ce,0)/Ne.length:o.rating},Ae=pe(),qe=b||Ch,Fe=Math.min(100,Math.max(0,Math.round(p/qe*100))),ve=Ej(N||"detailed"),rt=p<qe&&ve[p]?ve[p]:null,Ve=[{label:"Artist performance",rating:o.artistPerformanceRating,annotation:o.artistPerformanceFeedback},{label:"Production quality",rating:o.productionRating,annotation:o.productionFeedback},{label:"Venue experience",rating:o.venueRating,annotation:o.venueFeedback},{label:"Location & logistics",rating:o.locationRating,annotation:o.locationFeedback},{label:"Value for ticket",rating:o.valueRating,annotation:o.valueFeedback}],lt=()=>{var Oe,ce,Ee,Qe;const Ne=((Oe=o.selectedArtist)==null?void 0:Oe.name)&&o.eventDate;return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs(oe,{type:"button",variant:"outline",onClick:()=>ue(!0),disabled:!Ne,className:"border-pink-200 text-pink-600 hover:bg-pink-50 w-full sm:w-auto",children:[s.jsx(Ct,{className:"w-4 h-4 mr-2"}),"Import from setlist.fm"]}),o.selectedSetlist&&s.jsx(oe,{type:"button",variant:"ghost",onClick:ie,className:"text-gray-500 hover:text-gray-700 w-full sm:w-auto",children:"Clear setlist"})]}),!Ne&&s.jsx("p",{className:"text-xs text-gray-500",children:"Select an artist (and date if you know it) to search official setlists."}),o.selectedSetlist?s.jsxs("div",{className:"rounded-xl border border-pink-100 bg-pink-50/40 p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:((ce=o.selectedSetlist.artist)==null?void 0:ce.name)||((Ee=o.selectedArtist)==null?void 0:Ee.name)}),s.jsxs("p",{className:"text-xs text-gray-600",children:[(Qe=o.selectedSetlist.venue)==null?void 0:Qe.name,o.selectedSetlist.eventDate&&s.jsxs(s.Fragment,{children:["  ",xe(o.selectedSetlist.eventDate)]})]})]}),s.jsxs(Be,{variant:"secondary",className:"bg-white text-pink-600 border-pink-100",children:[o.selectedSetlist.songCount," songs"]})]}),s.jsx("ul",{className:"grid gap-1 text-xs text-gray-700 sm:grid-cols-2",children:(o.selectedSetlist.songs||[]).slice(0,8).map((vt,wt)=>{var Ht;return s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsxs("span",{className:"font-medium text-pink-600",children:[wt+1,"."]}),s.jsxs("span",{className:"flex-1",children:[vt.name,((Ht=vt.cover)==null?void 0:Ht.artist)&&s.jsxs("span",{className:"block text-[11px] text-gray-500",children:["Cover: ",vt.cover.artist]})]})]},`${vt.name}-${wt}`)})}),Array.isArray(o.selectedSetlist.songs)&&o.selectedSetlist.songs.length>8&&s.jsxs("p",{className:"text-[11px] text-gray-500",children:["+",o.selectedSetlist.songs.length-8," more in the setlist"]})]}):s.jsx("p",{className:"text-xs text-gray-500",children:"Can't find it? Add your own setlist below so other fans know what was played."}),s.jsx(Z3,{songs:o.customSetlist||[],onChange:ee,disabled:!!o.selectedSetlist,className:"mt-2"})]})},ut=()=>{var Oe,ce,Ee,Qe;const Ne=!!((Oe=o.selectedArtist)!=null&&Oe.name);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[s.jsxs(oe,{type:"button",variant:"outline",onClick:()=>ue(!0),disabled:!Ne,className:"border-pink-200 text-pink-600 hover:bg-pink-50 w-full sm:w-auto",children:[s.jsx(Ct,{className:"w-4 h-4 mr-2"}),"Import from setlist.fm"]}),o.selectedSetlist&&s.jsx(oe,{type:"button",variant:"ghost",onClick:ie,className:"text-gray-500 hover:text-gray-700 w-full sm:w-auto",children:"Clear setlist"})]}),!Ne&&s.jsx("p",{className:"text-xs text-gray-500",children:"Select an artist (and date if you know it) to search official setlists."}),o.selectedSetlist?s.jsxs("div",{className:"rounded-xl border border-pink-100 bg-pink-50/40 p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:((ce=o.selectedSetlist.artist)==null?void 0:ce.name)||((Ee=o.selectedArtist)==null?void 0:Ee.name)}),s.jsxs("p",{className:"text-xs text-gray-600",children:[(Qe=o.selectedSetlist.venue)==null?void 0:Qe.name,o.selectedSetlist.eventDate&&s.jsxs(s.Fragment,{children:["  ",xe(o.selectedSetlist.eventDate)]})]})]}),s.jsxs(Be,{variant:"secondary",className:"bg-white text-pink-600 border-pink-100",children:[o.selectedSetlist.songCount," songs"]})]}),s.jsx("ul",{className:"grid gap-1 text-xs text-gray-700 sm:grid-cols-2",children:(o.selectedSetlist.songs||[]).slice(0,8).map((vt,wt)=>{var Ht;return s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsxs("span",{className:"font-medium text-pink-600",children:[wt+1,"."]}),s.jsxs("span",{className:"flex-1",children:[vt.name,((Ht=vt.cover)==null?void 0:Ht.artist)&&s.jsxs("span",{className:"block text-[11px] text-gray-500",children:["Cover: ",vt.cover.artist]})]})]},`${vt.name}-${wt}`)})}),Array.isArray(o.selectedSetlist.songs)&&o.selectedSetlist.songs.length>8&&s.jsxs("p",{className:"text-[11px] text-gray-500",children:["+",o.selectedSetlist.songs.length-8," more in the setlist"]})]}):s.jsx("p",{className:"text-xs text-gray-500",children:"Cant find it? Add your own setlist below so other fans know what was played."}),s.jsx(Z3,{songs:o.customSetlist||[],onChange:ee,disabled:!!o.selectedSetlist,className:"mt-2"})]})},Ze=()=>{var Oe,ce;const Ne=N||"detailed";if(p===1)return s.jsx(_ce,{reviewDuration:o.reviewDuration,onSelectDuration:Ee=>{d({reviewDuration:Ee}),setTimeout(()=>x(),100)}});switch(Ne){case"quick":if(p===2)return s.jsx(Sj,{formData:o,errors:l,onUpdateFormData:d});if(p===3)return s.jsx(Rce,{formData:o,errors:l,onUpdateFormData:d,artistName:(Oe=o.selectedArtist)==null?void 0:Oe.name,venueName:(ce=o.selectedVenue)==null?void 0:ce.name,eventDate:o.eventDate});if(p===4)return s.jsx(kj,{formData:o,errors:l,onUpdateFormData:d,onSubmit:fe,isLoading:c,averageRating:o.rating,categoryBreakdown:[]});break;case"standard":if(p===2)return s.jsx(Sj,{formData:o,errors:l,onUpdateFormData:d});if(p===3)return s.jsx(Yd,{config:ae[2],formData:o,errors:l,onUpdateFormData:d,children:ut()});if(p===4)return s.jsx(Yd,{config:ae[4],formData:o,errors:l,onUpdateFormData:d,previousVenueReview:ye});if(p===5)return s.jsxs(s.Fragment,{children:[s.jsx(Q7,{formData:o,errors:l,onUpdateFormData:d,maxCharacters:400}),s.jsxs("div",{className:"mt-8 space-y-4",children:[s.jsx(Ut,{className:"text-base font-semibold text-gray-900",children:"Setlist (Optional)"}),lt()]})]});if(p===6){const Ee=o.artistPerformanceRating>0&&o.venueRating>0?(o.artistPerformanceRating+o.venueRating)/2:o.rating;return s.jsx(kj,{formData:o,errors:l,onUpdateFormData:d,onSubmit:fe,isLoading:c,averageRating:Ee,categoryBreakdown:[{label:"Artist Performance",rating:o.artistPerformanceRating},{label:"Venue",rating:o.venueRating}]})}break;case"detailed":if(p===2)return s.jsx(Sj,{formData:o,errors:l,onUpdateFormData:d});if(p===3)return s.jsx(Yd,{config:ae[2],formData:o,errors:l,onUpdateFormData:d,children:ut()});if(p===4)return s.jsx(Yd,{config:ae[3],formData:o,errors:l,onUpdateFormData:d});if(p===5)return s.jsx(Yd,{config:ae[4],formData:o,errors:l,onUpdateFormData:d,previousVenueReview:ye});if(p===6)return s.jsx(Yd,{config:ae[5],formData:o,errors:l,onUpdateFormData:d,previousVenueReview:ye});if(p===7)return s.jsx(Yd,{config:ae[6],formData:o,errors:l,onUpdateFormData:d,children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs(Ut,{htmlFor:"ticketPricePaid",className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(bo,{className:"w-4 h-4 text-pink-500"}),"What did you pay? (kept private)"]}),s.jsx(or,{id:"ticketPricePaid",type:"number",min:"0",step:"0.01",placeholder:"e.g. 78.50",value:o.ticketPricePaid,onChange:Ee=>d({ticketPricePaid:Ee.target.value})}),s.jsx("p",{className:"text-xs text-gray-500",children:"Only you can see this number. It helps calibrate value for other fans."})]})});if(p===8)return s.jsxs(s.Fragment,{children:[s.jsx(Q7,{formData:o,errors:l,onUpdateFormData:d,maxCharacters:500}),s.jsxs("div",{className:"mt-8 space-y-4",children:[s.jsx(Ut,{className:"text-base font-semibold text-gray-900",children:"Setlist (Optional)"}),lt()]})]});if(p===9)return s.jsx(kj,{formData:o,errors:l,onUpdateFormData:d,onSubmit:fe,isLoading:c,averageRating:Ae,categoryBreakdown:Ve});break}return null};return console.log(" EventReviewForm render state:",{existingReview:!!S,isLoading:c,actualEventId:Z,hasFormData:!!o}),s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-6 space-y-6 sm:space-y-8 w-full max-w-full overflow-x-hidden",children:[!S&&s.jsx(Zce,{userId:t,onSelectDraft:Ne=>{te(Ne),Ne.draft_data&&f(Ne.draft_data),i&&i()},onNewReview:()=>{te(null),h(),Y(!1)},currentMode:X?"draft":"new"}),!S&&s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200 w-full max-w-full overflow-x-hidden",children:s.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-blue-700",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full flex-shrink-0"}),s.jsx("span",{className:"break-words",children:"Your progress is automatically saved locally"})]})}),s.jsxs("div",{className:"space-y-3 sm:space-y-4 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[s.jsxs("div",{className:"min-w-0",children:[s.jsxs("p",{className:"text-xs uppercase tracking-[0.3em] text-pink-500 font-semibold",children:["Step ",p," of ",b||Ch]}),s.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mt-1 break-words",children:Ej(N||"detailed")[p-1]||"Review"})]}),s.jsx("div",{className:"w-full sm:w-48 h-2 bg-gray-100 rounded-full overflow-hidden flex-shrink-0",children:s.jsx("div",{className:"h-full bg-pink-500 transition-all duration-300",style:{width:`${Fe}%`}})})]}),s.jsx("div",{className:"flex flex-wrap gap-2 w-full max-w-full overflow-x-hidden",children:Ej(N||"detailed").map((Ne,Oe)=>{const ce=Oe+1,Ee=ce===p,Qe=ce<p;return s.jsxs("span",{className:ke("px-2 sm:px-3 py-1 rounded-full text-xs font-medium transition-colors flex-shrink-0",Ee?"bg-pink-500 text-white shadow-sm":Qe?"bg-pink-100 text-pink-700":"bg-gray-100 text-gray-500"),children:[ce,". ",Ne]},`${Ne}-${Oe}`)})})]}),s.jsx("div",{className:"min-h-[420px] w-full max-w-full overflow-x-hidden",children:Ze()}),s.jsxs("div",{className:"space-y-3 sm:space-y-4 border-t pt-3 sm:pt-4 w-full max-w-full overflow-x-hidden",children:[s.jsx("div",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-center justify-between gap-2 w-full",children:[s.jsx(oe,{variant:"ghost",onClick:g,disabled:!_,className:"flex-shrink-0",size:"sm",children:"Back"}),s.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500 flex-shrink-0",children:F?s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse flex-shrink-0"}),s.jsx("span",{className:"whitespace-nowrap",children:"Auto-saving"})]}):B?s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full flex-shrink-0"}),s.jsxs("span",{className:"whitespace-nowrap hidden sm:inline",children:["Auto-saved ",B.toLocaleTimeString()]}),s.jsx("span",{className:"whitespace-nowrap sm:hidden",children:"Saved"})]}):s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"w-2 h-2 bg-gray-300 rounded-full flex-shrink-0"}),s.jsx("span",{className:"whitespace-nowrap hidden sm:inline",children:"Auto-save active"}),s.jsx("span",{className:"whitespace-nowrap sm:hidden",children:"Saved"})]})}),p<(b||Ch)&&s.jsxs(oe,{onClick:x,disabled:!v,className:"bg-pink-500 hover:bg-pink-600 flex-shrink-0",size:"sm",children:["Next",rt?`: ${rt}`:""]})]})}),S&&s.jsx("div",{className:"flex justify-end",children:s.jsx(oe,{variant:"outline",onClick:()=>E(this,null,function*(){console.log(" Deleting review:",{reviewId:S==null?void 0:S.id,eventId:e.id,userId:t});try{if(!(S!=null&&S.id))throw new Error("No review ID found");yield fs.deleteEventReview(t,S.id),console.log(" Review deleted successfully");try{wn.click("review",e.id,{action:"delete",source:"event_review_form"})}catch(Ne){}if(a({title:"Review Deleted",description:"Your review has been deleted."}),k(null),h(),Y(!1),n){console.log(" Calling onDeleted callback");const Ne=n();Ne instanceof Promise&&(yield Ne)}}catch(Ne){console.error(" Error deleting review:",Ne);const Oe=Ne instanceof Error?Ne.message:"Unknown error";a({title:"Error",description:`Failed to delete review: ${Oe}`,variant:"destructive"})}}),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:"Delete Review"})})]})]}),s.jsx(yF,{isOpen:se,onClose:()=>ue(!1),artistName:((Le=o.selectedArtist)==null?void 0:Le.name)||"",venueName:((yt=o.selectedVenue)==null?void 0:yt.name)||void 0,eventDate:o.eventDate||void 0,onSetlistSelect:ge}),$&&s.jsx(Mce,{isOpen:A,onClose:he,userId:t,newReview:$,rating:pe()})]})}function MF({event:e,userId:t,isOpen:r,onClose:n,onReviewSubmitted:i}){if(!e&&!r)return null;const a=()=>{n()};return s.jsx(tn,{open:r,onOpenChange:a,children:s.jsxs(Xr,{className:"max-w-[393px] w-full mx-auto h-[90dvh] max-h-[90dvh] p-0 overflow-hidden flex flex-col",children:[s.jsx(Mn,{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200 bg-white sticky top-0 z-10",children:s.jsx(an,{className:"text-base sm:text-lg font-semibold text-center",children:"Share Your Concert Experience"})}),s.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto px-4 sm:px-6 py-4 sm:py-6 w-full max-w-full overflow-x-hidden",children:s.jsx("div",{className:"w-full max-w-full mx-auto",children:s.jsx(RF,{event:e,userId:t,onSubmitted:o=>E(this,null,function*(){if(i){const l=i(o);l instanceof Promise&&(yield l)}n()}),onDeleted:()=>E(this,null,function*(){if(i){const o=i(null);o instanceof Promise&&(yield o)}n()})})})})]})})}function LE({accountType:e,verified:t,size:r="md",className:n="",showTooltip:i=!0}){if(!t)return null;const a=Jie(e),o=a.icon,l={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"},c=s.jsx("div",{className:`inline-flex items-center justify-center ${l[r]} ${n}`,style:{background:`linear-gradient(135deg, ${a.colors.from}, ${a.colors.to})`,borderRadius:"50%",padding:"2px"},children:s.jsx(o,{className:"w-full h-full text-white",strokeWidth:2.5,fill:"white"})});return i?s.jsx(oE,{children:s.jsxs(qI,{children:[s.jsx(WI,{asChild:!0,children:c}),s.jsx(lE,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"font-semibold",children:a.label}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1 max-w-[200px]",children:a.description})]})})]})}):c}class ld{static getShareTargets(t){return E(this,null,function*(){try{const{data:r,error:n}=yield AE(t);if(n)throw console.error("Error fetching share targets:",n),n;return(r||[]).map(a=>({id:a.id,name:a.chat_name,type:a.is_group_chat?"group":"direct",users:a.users||[],avatar_url:null}))}catch(r){throw console.error("Error getting share targets:",r),new Error(`Failed to get share targets: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getFriends(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("user_relationships").select("id, user_id, related_user_id, created_at").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`).order("created_at",{ascending:!1});if(n)throw console.error("Error fetching friends:",n),n;if(!r||r.length===0)return[];const i=r.map(l=>l.user_id===t?l.related_user_id:l.user_id),{data:a,error:o}=yield P.from("users").select("user_id, name, avatar_url").in("user_id",i);if(o)throw console.error("Error fetching friend profiles:",o),o;return a||[]}catch(r){throw console.error("Error getting friends:",r),new Error(`Failed to get friends: ${r instanceof Error?r.message:"Unknown error"}`)}})}static shareEventToChat(t,r,n,i){return E(this,null,function*(){var a;try{const o=i||"Check out this event!",{data:l,error:c}=yield P.from("messages").insert({chat_id:r,sender_id:n,content:o,message_type:"event_share",shared_event_id:t,metadata:{custom_message:i,share_context:"in_app_share"}}).select("id, chat_id").single();if(c){if(console.error("Error creating share message:",c),c.code==="23503"||(a=c.message)!=null&&a.includes("foreign key")||c.code==="42703"){console.warn("FK constraint or column error, retrying without shared_event_id FK");const{data:d,error:u}=yield P.from("messages").insert({chat_id:r,sender_id:n,content:o,message_type:"event_share",shared_event_id:null,metadata:{custom_message:i,share_context:"in_app_share",event_id:t}}).select("id, chat_id").single();if(u)return{success:!1,error:"Failed to share event: "+(u.message||"Unknown error")};try{yield P.from("event_shares").insert({event_id:t,sharer_user_id:n,chat_id:r,message_id:d.id,share_type:"direct_chat"})}catch(h){console.warn("Failed to track event share in analytics (non-critical):",h)}return{success:!0,message_id:d.id,chat_id:d.chat_id}}return{success:!1,error:"Failed to share event: "+(c.message||"Unknown error")}}try{yield P.from("event_shares").insert({event_id:t,sharer_user_id:n,chat_id:r,message_id:l.id,share_type:"direct_chat"})}catch(d){console.warn("Failed to track event share in analytics (non-critical):",d)}return{success:!0,message_id:l.id,chat_id:l.chat_id}}catch(o){return console.error("Error sharing event to chat:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}})}static shareEventToMultipleChats(t,r,n,i){return E(this,null,function*(){const a=[];for(const c of r){const d=yield this.shareEventToChat(t,c,n,i);a.push(d)}const o=a.filter(c=>c.success).length,l=a.filter(c=>!c.success).length;return{successCount:o,failureCount:l,results:a}})}static shareEventToNewChat(t,r,n,i){return E(this,null,function*(){try{const{data:a,error:o}=yield P.rpc("create_direct_chat",{user1_id:n,user2_id:r});return o||!a?{success:!1,error:"Failed to create chat"}:yield this.shareEventToChat(t,a,n,i)}catch(a){return console.error("Error sharing event to new chat:",a),{success:!1,error:a instanceof Error?a.message:"Unknown error"}}})}static getEventShareStats(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("event_shares").select("share_type").eq("event_id",t);if(n)return console.error("Error fetching share stats:",n),{total_shares:0,direct_shares:0,group_shares:0};const i=(r==null?void 0:r.length)||0,a=(r==null?void 0:r.filter(l=>l.share_type==="direct_chat").length)||0,o=(r==null?void 0:r.filter(l=>l.share_type==="group_chat").length)||0;return{total_shares:i,direct_shares:a,group_shares:o}}catch(r){return console.error("Error getting event share stats:",r),{total_shares:0,direct_shares:0,group_shares:0}}})}static shareReviewToChat(t,r,n,i){return E(this,null,function*(){var a;try{const{data:o,error:l}=yield P.from("reviews").select("id, review_text, rating, event_id, user_id").eq("id",t).single();if(l||!o)return{success:!1,error:"Review not found"};const c=i||"Check out this review!",{data:d,error:u}=yield P.from("messages").insert({chat_id:r,sender_id:n,content:c,message_type:"review_share",shared_review_id:t,metadata:{custom_message:i,share_context:"in_app_share"}}).select("id, chat_id").single();if(u){if(console.error("Error creating review share message:",u),u.code==="23503"||(a=u.message)!=null&&a.includes("foreign key")||u.code==="42703"){console.warn("FK constraint or column error, retrying without shared_review_id FK");const{data:h,error:f}=yield P.from("messages").insert({chat_id:r,sender_id:n,content:c,message_type:"review_share",shared_review_id:null,metadata:{custom_message:i,share_context:"in_app_share",review_id:t}}).select("id, chat_id").single();return f?{success:!1,error:"Failed to share review: "+(f.message||"Unknown error")}:{success:!0,message_id:h.id,chat_id:h.chat_id}}return{success:!1,error:"Failed to share review: "+(u.message||"Unknown error")}}return{success:!0,message_id:d.id,chat_id:d.chat_id}}catch(o){return console.error("Error sharing review to chat:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}})}static shareReviewToMultipleChats(t,r,n,i){return E(this,null,function*(){const a=[];for(const c of r){const d=yield this.shareReviewToChat(t,c,n,i);a.push(d)}const o=a.filter(c=>c.success).length,l=a.filter(c=>!c.success).length;return{successCount:o,failureCount:l,results:a}})}static shareReviewToNewChat(t,r,n,i){return E(this,null,function*(){try{const{data:a,error:o}=yield P.rpc("create_direct_chat",{user1_id:n,user2_id:r});return o||!a?{success:!1,error:"Failed to create chat"}:yield this.shareReviewToChat(t,a,n,i)}catch(a){return console.error("Error sharing review to new chat:",a),{success:!1,error:a instanceof Error?a.message:"Unknown error"}}})}}class I0{static getBaseUrl(){return typeof window!="undefined"&&window.location?window.location.origin:"https://plusone.app"}static getEventUrl(t){return`${this.getBaseUrl()}/?event=${encodeURIComponent(t)}`}static getReviewUrl(t){return`${this.getBaseUrl()}/?review=${encodeURIComponent(t)}`}static shareEvent(t,r,n){return E(this,null,function*(){var a;const i=this.getEventUrl(t);try{navigator.share?yield navigator.share({title:r||"PlusOne Event",text:n,url:i}):(a=navigator.clipboard)!=null&&a.writeText&&(yield navigator.clipboard.writeText(i))}catch(o){}return i})}static shareReview(t,r,n){return E(this,null,function*(){var a;const i=this.getReviewUrl(t);try{navigator.share?yield navigator.share({title:r||"PlusOne Review",text:n,url:i}):(a=navigator.clipboard)!=null&&a.writeText&&(yield navigator.clipboard.writeText(i))}catch(o){}return i})}}function DF({review:e,currentUserId:t,isOpen:r,onClose:n,onShareComplete:i}){const[a,o]=y.useState([]),[l,c]=y.useState([]),[d,u]=y.useState(new Set);y.useState(new Set);const[h,f]=y.useState(""),[p,x]=y.useState(""),[g,v]=y.useState(!1),[_,w]=y.useState(!1),[b,N]=y.useState(!1),{toast:S}=jr(),k=e.artist_name?`${e.artist_name}${e.venue_name?` at ${e.venue_name}`:""}`:e.venue_name||"Concert Review",O=()=>E(this,null,function*(){try{const U=yield I0.shareReview(e.id,"PlusOne Review",e.review_text||void 0);navigator.share?(yield navigator.share({title:`Review: ${k}`,text:e.review_text||"Check out this concert review!",url:U}),S({title:"Shared!",description:"Review shared successfully"})):(yield navigator.clipboard.writeText(U),S({title:"Link Copied!",description:"Review link copied to clipboard"}))}catch(U){U.name!=="AbortError"&&(console.error("Error sharing externally:",U),S({title:"Error",description:"Failed to share review",variant:"destructive"}))}});y.useEffect(()=>{r&&(A(),T(),N(!1))},[r,t]);const A=()=>E(this,null,function*(){try{v(!0);const U=yield ld.getShareTargets(t);o(U)}catch(U){console.error("Error loading share targets:",U),S({title:"Error",description:"Failed to load chats",variant:"destructive"})}finally{v(!1)}}),T=()=>E(this,null,function*(){try{const U=yield ld.getFriends(t);c(U)}catch(U){console.error("Error loading friends:",U)}}),$=U=>{u(V=>{const Y=new Set(V);return Y.has(U)?Y.delete(U):Y.add(U),Y})},R=()=>E(this,null,function*(){if(d.size===0){S({title:"No chats selected",description:"Please select at least one chat to share with",variant:"destructive"});return}try{w(!0);const U=Array.from(d),V=U.filter(K=>!K.startsWith("friend-")),Y=U.filter(K=>K.startsWith("friend-")).map(K=>K.replace("friend-",""));let z={successCount:0,errors:[]};if(V.length>0){const K=yield ld.shareReviewToMultipleChats(e.id,V,t,h||void 0);z.successCount+=K.successCount,z.errors.push(...K.results.filter(Z=>!Z.success).map(Z=>Z.error||"Unknown error"))}for(const K of Y)try{const Z=yield ld.shareReviewToNewChat(e.id,K,t,h||void 0);Z.success?z.successCount+=1:z.errors.push(Z.error||"Failed to share with friend")}catch(Z){z.errors.push(`Failed to share with friend: ${Z}`)}if(z.successCount>0){try{yield fs.shareReview(t,e.id,"in_app_chat"),i&&i()}catch(K){console.warn("Failed to record share in analytics (non-critical):",K)}S({title:"Review Shared! ",description:`Successfully shared to ${z.successCount} chat${z.successCount>1?"s":""}`}),u(new Set),f(""),n()}z.errors.length>0&&S({title:"Partial Success",description:`${z.errors.length} share${z.errors.length>1?"s":""} failed`,variant:"destructive"})}catch(U){console.error("Error sharing review:",U),S({title:"Error",description:"Failed to share review",variant:"destructive"})}finally{w(!1)}}),F=a.filter(U=>U.name.toLowerCase().includes(p.toLowerCase())&&!U.name.toLowerCase().includes("direct chat")&&!U.name.toLowerCase().includes("dc direct")),D=l.filter(U=>U.name.toLowerCase().includes(p.toLowerCase())),B=[...F.map(U=>W(M({},U),{type:"group",isGroup:!0})),...D.map(U=>({id:`friend-${U.user_id}`,name:U.name,avatar_url:U.avatar_url,type:"friend",isGroup:!1,user_id:U.user_id}))];return s.jsx(tn,{open:r,onOpenChange:n,children:s.jsxs(Xr,{className:"max-w-lg max-h-[85vh] overflow-hidden flex flex-col",children:[s.jsxs(Mn,{children:[s.jsx(an,{className:"text-xl font-bold",children:"Share Review"}),s.jsxs(Kn,{children:['Share "',k,'" with your friends']})]}),s.jsxs("div",{className:"bg-gradient-to-r from-pink-50 to-purple-50 rounded-lg p-3 border border-pink-200",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((U,V)=>s.jsx(Jt,{className:`w-4 h-4 ${V<(e.rating||0)?"fill-pink-500 text-pink-500":"text-gray-300"}`},V))}),s.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:k})]}),e.review_text&&s.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:e.review_text})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(oe,{onClick:O,variant:"outline",className:"h-auto py-4 border-pink-200 hover:bg-pink-50 flex flex-col items-center gap-2",children:[s.jsx(Vu,{className:"w-6 h-6 text-pink-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Share Externally"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Phone, Apps, etc."})]}),s.jsxs(oe,{onClick:()=>{N(!b),!b&&a.length===0&&l.length===0&&!g&&(A(),T())},variant:b?"default":"outline",className:`h-auto py-4 border-pink-200 flex flex-col items-center gap-2 ${b?"bg-pink-500 hover:bg-pink-600 text-white border-pink-500":"hover:bg-pink-50"}`,children:[s.jsx(Wn,{className:`w-6 h-6 ${b?"text-white":"text-pink-500"}`}),s.jsx("span",{className:"text-sm font-medium",children:"Share in Chat"}),s.jsx("span",{className:`text-xs ${b?"text-pink-100":"text-gray-500"}`,children:"Within Synth"})]})]}),b&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-1 mt-4 border-t pt-4",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Add a message (optional)"}),s.jsx(as,{placeholder:"Check out this review! ",value:h,onChange:U=>f(U.target.value),rows:1,className:"resize-none text-sm"})]}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden mt-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Wn,{className:"w-5 h-5 text-pink-500"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Choose Chats"})]}),s.jsxs("div",{className:"relative mb-3",children:[s.jsx(Mi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx(or,{placeholder:"Search chats...",value:p,onChange:U=>x(U.target.value),className:"pl-10"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2",children:g?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(er,{className:"w-6 h-6 animate-spin text-pink-500"})}):B.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Wn,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),s.jsx("p",{children:"No chats found"}),s.jsx("p",{className:"text-sm",children:"Start a conversation to share reviews"})]}):B.map(U=>{var V;return s.jsxs("div",{onClick:()=>$(U.id),className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all ${d.has(U.id)?"bg-pink-50 border-2 border-pink-300":"bg-white border border-gray-200 hover:border-pink-200"}`,children:[s.jsxs(Vr,{className:"w-10 h-10",children:[s.jsx(Qr,{src:U.avatar_url||void 0}),s.jsx(qr,{children:U.isGroup?s.jsx(Wn,{className:"w-5 h-5"}):U.name.split(" ").map(Y=>Y[0]).join("")})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:U.name}),s.jsx("p",{className:"text-xs text-gray-500",children:U.isGroup?`${((V=U.users)==null?void 0:V.length)||U.member_count||0} members`:"Direct message"})]}),d.has(U.id)&&s.jsx("div",{className:"w-6 h-6 rounded-full bg-pink-500 flex items-center justify-center",children:s.jsx(Gs,{className:"w-4 h-4 text-white"})})]},U.id)})}),s.jsxs("div",{className:"mt-4 pt-4 border-t flex gap-2",children:[s.jsx(oe,{onClick:n,variant:"outline",className:"flex-1",children:"Cancel"}),s.jsx(oe,{onClick:R,disabled:d.size===0||_,className:"flex-1 bg-pink-500 hover:bg-pink-600 text-white",children:_?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-4 h-4 mr-2 animate-spin"}),"Sharing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(cf,{className:"w-4 h-4 mr-2"}),"Share (",d.size,")"]})})]})]})]})]})})}function sA({setlist:e,customSetlist:t,className:r,compact:n=!1,type:i}){var p,x,g,v;const[a,o]=y.useState(!1),l=i||(t?"custom":"api");if(!(l==="custom"?t:e))return null;if(l==="custom"){const _=t||[],w=_.length;return w===0?null:n?s.jsxs("div",{children:[s.jsxs("button",{className:ke("flex items-center justify-between gap-2 p-3 bg-purple-50 rounded-lg border border-purple-200 hover:bg-purple-100 transition-colors w-full",r),onClick:b=>{b.stopPropagation(),o(!a)},children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(li,{className:"w-4 h-4 text-purple-600"}),s.jsxs("span",{className:"text-sm font-medium text-purple-800",children:["Custom Setlist  ",w," song",w!==1?"s":""]})]}),a?s.jsx(al,{className:"w-4 h-4 text-purple-600"}):s.jsx(Qi,{className:"w-4 h-4 text-purple-600"})]}),a&&s.jsx("div",{className:"mt-2 p-4 bg-white rounded-lg border border-purple-200",children:s.jsx("div",{className:"space-y-2",children:_.map((b,N)=>s.jsxs("div",{className:"flex items-start gap-3 p-2 bg-purple-50/30 rounded",children:[s.jsxs("span",{className:"text-sm font-medium text-purple-500 w-8 text-right flex-shrink-0",children:[b.position,"."]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 block",children:b.song_name}),b.cover_artist&&s.jsxs(Be,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700 mt-1",children:["Cover: ",b.cover_artist]}),b.notes&&s.jsxs("p",{className:"text-xs text-gray-600 mt-1 italic",children:['"',b.notes,'"']})]})]},N))})})]}):s.jsxs(He,{className:ke("border-purple-300 bg-gradient-to-br from-purple-50 to-pink-50",r),children:[s.jsx(xr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(li,{className:"w-5 h-5 text-purple-600"}),s.jsx("h4",{className:"font-semibold text-purple-900",children:"Custom Setlist"}),s.jsxs(Be,{variant:"secondary",className:"bg-purple-100 text-purple-800",children:[w," song",w!==1?"s":""]})]}),s.jsx("p",{className:"text-xs text-purple-600",children:"User-created setlist for this show"})]}),s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>o(!a),className:"text-purple-600 border-purple-300 hover:bg-purple-100",children:[a?s.jsx(al,{className:"w-4 h-4 mr-1"}):s.jsx(Qi,{className:"w-4 h-4 mr-1"}),a?"Hide":"Show"," Setlist"]})]})}),a&&s.jsx(st,{className:"pt-0",children:s.jsx("div",{className:"space-y-2",children:_.map((b,N)=>s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white/60 rounded border border-purple-100",children:[s.jsxs("span",{className:"text-sm font-medium text-purple-500 w-8 text-right flex-shrink-0",children:[b.position,"."]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("span",{className:"text-sm font-medium text-purple-900 block",children:b.song_name}),b.cover_artist&&s.jsx("div",{className:"mt-1",children:s.jsxs(Be,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:["Cover: ",b.cover_artist]})}),b.notes&&s.jsxs("p",{className:"text-xs text-purple-700 mt-1 italic",children:['"',b.notes,'"']})]})]},N))})})]})}if(!e)return null;const d=_=>{try{return new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch(w){return _}},h=(_=>{const w={};return _.forEach(b=>{w[b.setNumber]||(w[b.setNumber]=[]),w[b.setNumber].push(b)}),w})(e.songs||[]),f=((p=e.songs)==null?void 0:p.length)||0;return n?s.jsxs("div",{children:[s.jsxs("button",{className:ke("flex items-center justify-between gap-2 p-3 bg-purple-50 rounded-lg border border-purple-200 hover:bg-purple-100 transition-colors w-full",r),onClick:_=>{_.stopPropagation(),o(!a)},children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ct,{className:"w-4 h-4 text-purple-600"}),s.jsxs("span",{className:"text-sm font-medium text-purple-800",children:[f," songs  ",Object.keys(h).length," set",Object.keys(h).length!==1?"s":""]})]}),a?s.jsx(al,{className:"w-4 h-4 text-purple-600"}):s.jsx(Qi,{className:"w-4 h-4 text-purple-600"})]}),a&&s.jsx("div",{className:"mt-2 p-4 bg-white rounded-lg border border-purple-200",children:Object.entries(h).map(([_,w])=>s.jsxs("div",{className:"mb-4 last:mb-0",children:[s.jsxs("h5",{className:"text-sm font-bold text-purple-900 mb-2",children:["Set ",_," (",w.length," songs)"]}),s.jsx("div",{className:"space-y-1",children:w.map((b,N)=>s.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[s.jsxs("span",{className:"text-purple-400 font-medium w-6 text-right flex-shrink-0",children:[N+1,"."]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-gray-900",children:b.name}),b.info&&s.jsxs("span",{className:"text-gray-500 ml-2 text-xs",children:["(",b.info,")"]})]})]},N))})]},_))})]}):s.jsxs(He,{className:ke("border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50",r),children:[s.jsx(xr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ct,{className:"w-5 h-5 text-purple-600"}),s.jsx("h4",{className:"font-semibold text-purple-900",children:"Setlist"}),s.jsxs(Be,{variant:"secondary",className:"bg-purple-100 text-purple-800",children:[f," songs"]})]}),s.jsxs("div",{className:"space-y-1 text-sm text-purple-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Et,{className:"h-3 w-3"}),d(e.eventDate)]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"h-3 w-3"}),(x=e.venue)==null?void 0:x.name,", ",(g=e.venue)==null?void 0:g.city,((v=e.venue)==null?void 0:v.state)&&`, ${e.venue.state}`]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>o(!a),className:"text-purple-600 border-purple-300 hover:bg-purple-100",children:[a?s.jsx(al,{className:"w-4 h-4 mr-1"}):s.jsx(Qi,{className:"w-4 h-4 mr-1"}),a?"Hide":"Show"," Setlist"]}),e.url&&s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>window.open(e.url,"_blank"),className:"text-purple-600 border-purple-300 hover:bg-purple-100",children:[s.jsx(aa,{className:"w-4 h-4 mr-1"}),"Setlist.fm"]})]})]})}),a&&s.jsxs(st,{className:"pt-0",children:[e.info&&s.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-800",children:e.info}),s.jsx("div",{className:"space-y-4",children:Object.entries(h).map(([_,w])=>{var b;return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Be,{variant:"outline",className:"font-medium border-purple-300 text-purple-700",children:((b=w[0])==null?void 0:b.setName)||`Set ${_}`}),s.jsxs("span",{className:"text-sm text-purple-600",children:[w.length," song",w.length!==1?"s":""]})]}),s.jsx("div",{className:"space-y-1",children:w.map((N,S)=>s.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white/60 rounded border border-purple-100",children:[s.jsxs("span",{className:"text-sm font-medium text-purple-500 w-8 text-right",children:[N.position,"."]}),s.jsx("span",{className:"text-sm flex-1 text-purple-900",children:N.name}),N.cover&&s.jsx(Be,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:N.cover.artist}),N.tape&&s.jsx(Be,{variant:"outline",className:"text-xs border-purple-300 text-purple-600",children:"Tape"})]},S))})]},_)})})]})]})}class $a{static setArtistFollow(t,r,n){return E(this,null,function*(){var i,a,o,l;try{const{error:c}=yield P.rpc("set_artist_follow",{p_artist_id:r,p_following:n});if(c&&(c.code==="42883"||c.code==="PGRST404"||c.code==="42P01"||((i=c.message)==null?void 0:i.includes("404"))||((a=c.message)==null?void 0:a.includes("does not exist"))||((o=c.message)==null?void 0:o.includes("function"))||((l=c.message)==null?void 0:l.includes("relation"))))if(console.warn(" RPC function set_artist_follow not available, using direct table operations"),n){const{error:u}=yield P.from("artist_follows").insert({user_id:t,artist_id:r});if(u&&u.code!=="23505")throw u}else{const{error:u}=yield P.from("artist_follows").delete().eq("user_id",t).eq("artist_id",r);if(u)throw u}else if(c)throw c;console.log(` Artist follow ${n?"added":"removed"}:`,{userId:t,artistId:r})}catch(c){throw console.error("Error setting artist follow:",c),new Error(`Failed to ${n?"follow":"unfollow"} artist: ${c instanceof Error?c.message:"Unknown error"}`)}})}static setArtistFollowByName(t,r,n,i=!0){return E(this,null,function*(){try{let a=null;const{data:o,error:l}=yield P.from("artists").select("id").ilike("name",r).limit(1).maybeSingle();if(l&&console.warn("Error searching for existing artist:",l),o)a=o.id;else{const{data:c,error:d}=yield P.from("artists").insert({name:r,identifier:n||`manual:${r.toLowerCase().replace(/\s+/g,"-")}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("id").single();if(d)throw d;a=c.id}if(!a)throw new Error("Failed to find or create artist");yield this.setArtistFollow(t,a,i)}catch(a){throw console.error("Error setting artist follow by name:",a),new Error(`Failed to ${i?"follow":"unfollow"} artist: ${a instanceof Error?a.message:"Unknown error"}`)}})}static isFollowingArtist(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("artist_follows").select("id").eq("user_id",r).eq("artist_id",t).maybeSingle();return i&&i.code!=="PGRST116"?(console.error("Error checking if following artist:",i),!1):!!n}catch(n){return console.error("Error checking if following artist:",n),!1}})}static getFollowerCount(t){return E(this,null,function*(){try{const{count:r,error:n}=yield P.from("artist_follows").select("*",{count:"exact",head:!0}).eq("artist_id",t);return n?(console.error("Error getting follower count:",n),0):r||0}catch(r){return console.error("Error getting follower count:",r),0}})}static getArtistFollowStats(t,r){return E(this,null,function*(){try{const[n,i]=yield Promise.all([this.getFollowerCount(t),r?this.isFollowingArtist(t,r):Promise.resolve(!1)]);return{follower_count:n,is_following:i}}catch(n){return console.error("Error getting artist follow stats:",n),{follower_count:0,is_following:!1}}})}static getArtistFollowStatsByName(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("artists").select("id").ilike("name",t).limit(1).maybeSingle();return i?(console.warn("Error searching for artist in getArtistFollowStatsByName:",i),{follower_count:0,is_following:!1}):n?yield this.getArtistFollowStats(n.id,r):{follower_count:0,is_following:!1}}catch(n){return console.error("Error getting artist follow stats by name:",n),{follower_count:0,is_following:!1}}})}static getUserFollowedArtists(t){return E(this,null,function*(){try{console.log(" Getting followed artists for user:",t);const{data:r,error:n}=yield P.from("artist_follows").select("id, artist_id, user_id, created_at, updated_at").eq("user_id",t).order("created_at",{ascending:!1});if(console.log(" ArtistFollowService query result:",{followsLength:(r==null?void 0:r.length)||0,error:n,firstFollow:r==null?void 0:r[0]}),n)return console.error(" Error fetching artist follows:",n),console.error(" Error details:",JSON.stringify(n,null,2)),[];if(!r||r.length===0)return console.log(" No artist follows found for user:",t),[];console.log(` Found ${r.length} artist follows`);const i=r.map(d=>d.artist_id).filter(Boolean);if(console.log("Artist IDs to fetch:",i.length),i.length===0)return[];const{data:a,error:o}=yield P.from("artists").select("id, name, image_url, identifier").in("id",i);if(o)return console.error("Error fetching artist details:",o),[];const l=new Map((a||[]).map(d=>[d.id,d])),c=r.map(d=>{const u=l.get(d.artist_id);return{id:d.id,user_id:t,artist_id:d.artist_id,created_at:d.created_at,artist_name:(u==null?void 0:u.name)||null,artist_image_url:(u==null?void 0:u.image_url)||null,jambase_artist_id:(u==null?void 0:u.identifier)||null,num_upcoming_events:null,genres:null,user_name:null,user_avatar_url:null}});return console.log(" Followed artists fetched:",c.length),c}catch(r){return console.error("Error getting followed artists:",r),[]}})}static getArtistFollowers(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("artist_follows_with_details").select("*").eq("artist_id",t).order("created_at",{ascending:!1});if(n)throw n;return r||[]}catch(r){throw console.error("Error getting artist followers:",r),new Error(`Failed to get artist followers: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getArtistUuidByJambaseId(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.rpc("get_entity_uuid_by_external_id",{p_external_id:t,p_source:"jambase",p_entity_type:"artist"});if(!n&&r)return r;const{data:i,error:a}=yield P.from("artists_with_external_ids").select("id").eq("jambase_artist_id",t).maybeSingle();if(a&&a.code!=="PGRST116")console.warn("Artists table query failed:",a);else if(i)return i.id;return null}catch(r){return console.error("Error getting artist UUID:",r),null}})}static getArtistUuidByName(t){return E(this,null,function*(){try{let{data:r,error:n}=yield P.from("artists").select("id").ilike("name",t).limit(1).maybeSingle();if(n&&n.code!=="PGRST116")console.warn("Artists table query failed:",n);else if(r)return r.id;return null}catch(r){return console.error("Error getting artist UUID by name:",r),null}})}static subscribeToArtistFollows(t,r){return P.channel("artist-follows").on("postgres_changes",{event:"INSERT",schema:"public",table:"artist_follows",filter:`user_id=eq.${t}`},i=>{r(i.new,"INSERT")}).on("postgres_changes",{event:"DELETE",schema:"public",table:"artist_follows",filter:`user_id=eq.${t}`},i=>{r(i.old,"DELETE")}).subscribe()}}class tc{static getOrCreateVerifiedChat(t,r,n){return E(this,null,function*(){try{console.log(" Calling get_or_create_verified_chat RPC:",{p_entity_type:t,p_entity_id:r,p_entity_name:n});const{data:i,error:a}=yield P.rpc("get_or_create_verified_chat",{p_entity_type:t,p_entity_id:r,p_entity_name:n});if(a)throw console.error(" Error getting/creating verified chat:",a),a;return console.log(" get_or_create_verified_chat RPC returned:",i),i}catch(i){throw console.error(" Error in getOrCreateVerifiedChat:",i),i}})}static joinVerifiedChat(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.rpc("join_verified_chat",{p_chat_id:t,p_user_id:r});if(i)throw console.error("Error joining verified chat:",i),i;return n}catch(n){throw console.error("Error in joinVerifiedChat:",n),n}})}static getVerifiedChatInfo(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.rpc("get_verified_chat_info",{p_entity_type:t,p_entity_id:r});if(i)throw console.error("Error getting verified chat info:",i),i;if(!n||n.length===0)return null;const a=n[0];return{chat_id:a.chat_id,chat_name:a.chat_name,member_count:a.member_count||0,last_activity_at:a.last_activity_at,is_user_member:a.is_user_member||!1,current_user_id:a.current_user_id}}catch(n){throw console.error("Error in getVerifiedChatInfo:",n),n}})}static isUserMember(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("chat_participants").select("user_id").eq("chat_id",t).eq("user_id",r).maybeSingle();return i?(console.error("Error checking user membership:",i),!1):!!n}catch(n){return console.error("Error in isUserMember:",n),!1}})}static joinOrOpenVerifiedChat(t,r,n,i){return E(this,null,function*(){try{console.log(" VerifiedChatService.joinOrOpenVerifiedChat called:",{entityType:t,entityId:r,entityName:n,userId:i});const a=yield this.getVerifiedChatInfo(t,r);console.log(" Chat info retrieved:",a);let o;return a!=null&&a.chat_id?(o=a.chat_id,console.log(" Chat exists, chatId:",o),a.is_user_member?console.log(" User already a member"):(console.log(" User not a member, joining chat..."),yield this.joinVerifiedChat(o,i),console.log(" User joined chat successfully"))):(console.log(" Chat does not exist, creating new verified chat..."),o=yield this.getOrCreateVerifiedChat(t,r,n),console.log(" Verified chat created, chatId:",o),console.log(" Joining newly created chat..."),yield this.joinVerifiedChat(o,i),console.log(" User joined newly created chat successfully")),console.log(" joinOrOpenVerifiedChat completed successfully, returning chatId:",o),o}catch(a){throw console.error(" Error in joinOrOpenVerifiedChat:",a),a}})}}const nde=Object.freeze(Object.defineProperty({__proto__:null,VerifiedChatService:tc},Symbol.toStringTag,{value:"Module"}));function Tv({artistId:e,artistName:t,jambaseArtistId:r,userId:n,variant:i="outline",size:a="sm",showFollowerCount:o=!1,className:l,onFollowChange:c}){const[d,u]=y.useState(!1),[h,f]=y.useState(0),[p,x]=y.useState(!1),[g,v]=y.useState(e||null),[_,w]=y.useState(null),{toast:b}=jr();y.useEffect(()=>{E(this,null,function*(){if(e){v(e),w(e);return}if(r){const k=yield $a.getArtistUuidByJambaseId(r);if(k){v(k),w(k);return}}if(t){const k=yield $a.getArtistUuidByName(t);if(k){v(k),w(k);return}}w(null)})},[e,r,t]),y.useEffect(()=>{E(this,null,function*(){if(n)try{let k;if(_&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(_))k=yield $a.getArtistFollowStats(_,n);else if(t)k=yield $a.getArtistFollowStatsByName(t,n);else return;u(k.is_following),f(k.follower_count)}catch(k){if(console.error("Error loading follow status:",k),t)try{const O=yield $a.getArtistFollowStatsByName(t,n);u(O.is_following),f(O.follower_count)}catch(O){console.error("Error in fallback follow status lookup:",O)}}})},[_,t,n]),y.useEffect(()=>{if(!n)return;const S=$a.subscribeToArtistFollows(n,(k,O)=>{if(_?k.artist_id===_:!1){const T=O==="INSERT";u(T),f($=>T?$+1:Math.max(0,$-1))}});return()=>{S.unsubscribe()}},[n,_,t]);const N=S=>E(this,null,function*(){if(S.preventDefault(),S.stopPropagation(),!n){b({title:"Error",description:"Please log in to follow artists.",variant:"destructive"});return}x(!0);try{const k=!d;if(_)yield $a.setArtistFollow(n,_,k);else if(t)yield $a.setArtistFollowByName(n,t,r,k);else throw new Error("No artist information available");if(u(k),f(O=>k?O+1:Math.max(0,O-1)),k)try{console.log(" ArtistFollowButton: User followed artist, joining verified chat...",{artistId:_,artistName:t,jambaseArtistId:r,userId:n});const O=_||r||t||"";O?(yield tc.joinOrOpenVerifiedChat("artist",O,t||"Artist",n),console.log(" ArtistFollowButton: Successfully joined artist verified chat")):console.warn(" ArtistFollowButton: Could not determine entityId for chat join")}catch(O){console.error(" ArtistFollowButton: Error joining artist verified chat (non-fatal):",O)}b({title:k?"Following!":"Unfollowed",description:k?`You'll receive notifications when ${t||"this artist"} has new events or updates`:`You won't receive notifications from ${t||"this artist"} anymore`}),c==null||c(k)}catch(k){console.error("Error toggling follow:",k),b({title:"Error",description:`Failed to ${d?"unfollow":"follow"} artist`,variant:"destructive"})}finally{x(!1)}});return n?s.jsxs(oe,{variant:d?"secondary":i,size:a,className:ke("gap-2",l),onClick:N,disabled:p,"data-artist-name":t,"data-testid":"artist-follow-button",children:[p?s.jsx(er,{className:"h-4 w-4 animate-spin"}):d?s.jsx(v0,{className:"h-4 w-4"}):s.jsx(Pu,{className:"h-4 w-4"}),s.jsxs("span",{children:[d?"Following":"Follow",o&&h>0&&` (${h})`]})]}):(console.warn(" ArtistFollowButton: No userId provided, not rendering"),null)}class uu{static normalizeVenueName(t){return t.trim()}static setVenueFollowByName(t,r,n,i,a=!0){return E(this,null,function*(){try{const o=this.normalizeVenueName(r);let l=null;if(l=yield this.getVenueIdByName(o,n,i),!l)throw new Error(`Venue not found: ${o}. Cannot follow venue that doesn't exist in database.`);if(a){const{error:c}=yield P.from("user_venue_relationships").insert({user_id:t,venue_id:l});if(c&&c.code!=="23505")throw c}else{const{error:c}=yield P.from("user_venue_relationships").delete().eq("user_id",t).eq("venue_id",l);if(c)throw c}console.log(` Venue follow ${a?"added":"removed"}:`,{userId:t,venueName:o,venueCity:n,venueState:i})}catch(o){throw console.error("Error setting venue follow:",o),new Error(`Failed to ${a?"follow":"unfollow"} venue: ${o instanceof Error?o.message:"Unknown error"}`)}})}static getVenueIdByName(t,r,n){return E(this,null,function*(){try{const i=this.normalizeVenueName(t);let a=P.from("venues").select("id, state").ilike("name",`%${i}%`).limit(10);n&&(a=a.ilike("state",`%${n}%`));const{data:o,error:l}=yield a;if(l)return console.warn("Error querying venues by name:",l),null;if(!o||o.length===0)return null;if(r){const c=o.map(u=>u.id),{data:d}=yield P.from("events").select("venue_id").in("venue_id",c).ilike("venue_city",`%${r}%`).limit(100);if(d&&d.length>0){const u=new Map;d.forEach(p=>{p.venue_id&&u.set(p.venue_id,(u.get(p.venue_id)||0)+1)});let h=0,f=null;if(u.forEach((p,x)=>{p>h&&(h=p,f=x)}),f)return f}}return o[0].id}catch(i){return console.error("Error getting venue ID by name:",i),null}})}static isFollowingVenueByName(t,r,n,i){return E(this,null,function*(){try{const a=this.normalizeVenueName(t);let o=P.from("venues").select("id").ilike("name",a);n&&(o=o.ilike("state",n));let{data:l}=yield o;if(r&&l&&l.length>0){const u=l.map(f=>f.id),{data:h}=yield P.from("events").select("venue_id").in("venue_id",u).ilike("venue_city",`%${r}%`).limit(100);if(h&&h.length>0){const f=new Set(h.map(p=>p.venue_id));l=l.filter(p=>f.has(p.id))}}if(!l||l.length===0)return!1;const c=l.map(u=>u.id),{count:d}=yield P.from("user_venue_relationships").select("*",{count:"exact",head:!0}).eq("user_id",i).in("venue_id",c);return(d||0)>0}catch(a){return!1}})}static getFollowerCountByName(t,r,n){return E(this,null,function*(){try{const i=this.normalizeVenueName(t);let a=P.from("venues").select("id").ilike("name",i);n&&(a=a.ilike("state",n));let{data:o}=yield a;if(r&&o&&o.length>0){const c=o.map(u=>u.id),{data:d}=yield P.from("events").select("venue_id").in("venue_id",c).ilike("venue_city",`%${r}%`).limit(100);if(d&&d.length>0){const u=new Set(d.map(h=>h.venue_id));o=o.filter(h=>u.has(h.id))}}let l=0;if(o&&o.length>0){const c=o.map(u=>u.id),{count:d}=yield P.from("user_venue_relationships").select("*",{count:"exact",head:!0}).in("venue_id",c);l+=d||0}return l}catch(i){return 0}})}static getVenueFollowStatsByName(t,r,n,i){return E(this,null,function*(){try{const[a,o]=yield Promise.all([this.getFollowerCountByName(t,r,n),i?this.isFollowingVenueByName(t,r,n,i):Promise.resolve(!1)]);return{follower_count:a,is_following:o}}catch(a){return console.error("Error getting venue follow stats:",a),{follower_count:0,is_following:!1}}})}static getUserFollowedVenues(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("user_venue_relationships").select("id, user_id, venue_id, created_at").eq("user_id",t).order("created_at",{ascending:!1});if(n)throw n;if(!r||r.length===0)return[];const i=[...new Set(r.map(l=>l.venue_id).filter(Boolean))],a=new Map;if(i.length>0){const{data:l}=yield P.from("venues").select("id, name, image_url, street_address, state, country, zip").in("id",i);l&&l.forEach(c=>{a.set(c.id,c)})}const{data:o}=yield P.from("users").select("user_id, name, avatar_url").eq("user_id",t).maybeSingle();return r.map(l=>{const c=a.get(l.venue_id);return{id:l.id,user_id:l.user_id,venue_id:l.venue_id,venue_name:(c==null?void 0:c.name)||null,venue_city:null,venue_state:(c==null?void 0:c.state)||null,venue_address:(c==null?void 0:c.street_address)||null,venue_image_url:(c==null?void 0:c.image_url)||null,num_upcoming_events:null,created_at:l.created_at,user_name:(o==null?void 0:o.name)||null,user_avatar_url:(o==null?void 0:o.avatar_url)||null}})}catch(r){return console.error("Error getting followed venues:",r),[]}})}static getVenueFollowersByName(t,r,n){return E(this,null,function*(){try{const i=this.normalizeVenueName(t);let a=P.from("venues").select("id, name, state").ilike("name",i);n&&(a=a.ilike("state",n));let{data:o,error:l}=yield a;if(r&&o&&o.length>0){const x=o.map(v=>v.id),{data:g}=yield P.from("events").select("venue_id").in("venue_id",x).ilike("venue_city",`%${r}%`).limit(100);if(g&&g.length>0){const v=new Set(g.map(_=>_.venue_id));o=o.filter(_=>v.has(_.id))}}if(l)throw l;if(!o||o.length===0)return[];const c=o.map(x=>x.id),{data:d,error:u}=yield P.from("user_venue_relationships").select("id, user_id, venue_id, created_at").in("venue_id",c).order("created_at",{ascending:!1});if(u)throw u;if(!d||d.length===0)return[];const h=[...new Set(d.map(x=>x.user_id).filter(Boolean))],f=new Map;if(h.length>0){const{data:x}=yield P.from("users").select("user_id, name, avatar_url").in("user_id",h);x&&x.forEach(g=>{f.set(g.user_id,g)})}const p=new Map;return o.forEach(x=>{p.set(x.id,x)}),d.map(x=>{const g=p.get(x.venue_id)||{},v=f.get(x.user_id)||{};return{id:x.id,user_id:x.user_id,venue_id:x.venue_id,venue_name:g.name||null,venue_city:g.city||null,venue_state:g.state||null,venue_image_url:g.image_url||null,num_upcoming_events:null,created_at:x.created_at,user_name:v.name||null,user_avatar_url:v.avatar_url||null}})}catch(i){throw console.error("Error getting venue followers:",i),new Error(`Failed to get venue followers: ${i instanceof Error?i.message:"Unknown error"}`)}})}static subscribeToVenueFollows(t,r){return P.channel(`venue-follows-${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"user_venue_relationships",filter:`user_id=eq.${t}`},i=>{(()=>{P.from("venues").select("name, address, city, state").eq("id",i.new.venue_id).maybeSingle().then(({data:o})=>{const l={id:i.new.id,user_id:i.new.user_id,venue_name:(o==null?void 0:o.name)||null,venue_city:(o==null?void 0:o.city)||null,venue_state:(o==null?void 0:o.state)||null,created_at:i.new.created_at,updated_at:i.new.updated_at||i.new.created_at};r(l,"INSERT")}).catch(o=>{console.error("Error fetching venue details in realtime callback:",o);const l={id:i.new.id,user_id:i.new.user_id,venue_name:null,venue_city:null,venue_state:null,created_at:i.new.created_at,updated_at:i.new.updated_at||i.new.created_at};r(l,"INSERT")})})()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"user_venue_relationships",filter:`user_id=eq.${t}`},i=>{const a={id:i.old.id,user_id:i.old.user_id,venue_name:null,venue_city:null,venue_state:null,created_at:i.old.created_at,updated_at:i.old.updated_at||i.old.created_at};r(a,"DELETE")}).subscribe()}}function Xw({venueName:e,venueCity:t,venueState:r,userId:n,variant:i="outline",size:a="sm",showFollowerCount:o=!1,className:l,onFollowChange:c}){const[d,u]=y.useState(!1),[h,f]=y.useState(0),[p,x]=y.useState(!1),{toast:g}=jr();y.useEffect(()=>{E(this,null,function*(){if(!(!n||!e))try{const w=yield uu.getVenueFollowStatsByName(e,t,r,n);u(w.is_following),f(w.follower_count)}catch(w){console.error("Error loading venue follow status:",w)}})},[e,t,r,n]),y.useEffect(()=>{if(!n)return;const _=uu.subscribeToVenueFollows(n,(w,b)=>{var S,k;if(w.venue_name.toLowerCase()===e.toLowerCase()&&(!t||((S=w.venue_city)==null?void 0:S.toLowerCase())===t.toLowerCase())&&(!r||((k=w.venue_state)==null?void 0:k.toLowerCase())===r.toLowerCase())){const O=b==="INSERT";u(O),f(A=>O?A+1:Math.max(0,A-1))}});return()=>{_.unsubscribe()}},[n,e,t,r]);const v=_=>E(this,null,function*(){if(_.preventDefault(),_.stopPropagation(),!n){g({title:"Error",description:"Please log in to follow venues.",variant:"destructive"});return}if(!e){g({title:"Error",description:"Venue name is required.",variant:"destructive"});return}x(!0);try{const w=!d;let b=null;if(w&&(b=yield uu.getVenueIdByName(e,t,r)),yield uu.setVenueFollowByName(n,e,t,r,w),u(w),f(S=>w?S+1:Math.max(0,S-1)),w&&b)try{console.log(" VenueFollowButton: User followed venue, joining verified chat...",{venueId:b,venueName:e,venueCity:t,venueState:r,userId:n}),yield tc.joinOrOpenVerifiedChat("venue",b,e,n),console.log(" VenueFollowButton: Successfully joined venue verified chat")}catch(S){console.error(" VenueFollowButton: Error joining venue verified chat (non-fatal):",S)}else if(w&&!b)try{console.log(" VenueFollowButton: No venueId found, using venue name as entity_id"),yield tc.joinOrOpenVerifiedChat("venue",e,e,n),console.log(" VenueFollowButton: Successfully joined venue verified chat (using name)")}catch(S){console.error(" VenueFollowButton: Error joining venue verified chat with name (non-fatal):",S)}const N=t&&r?` in ${t}, ${r}`:t?` in ${t}`:"";g({title:w?"Following!":"Unfollowed",description:w?`You'll receive notifications when ${e}${N} has new events`:`You won't receive notifications from ${e}${N} anymore`}),c==null||c(w)}catch(w){console.error("Error toggling venue follow:",w),g({title:"Error",description:`Failed to ${d?"unfollow":"follow"} venue`,variant:"destructive"})}finally{x(!1)}});return n?e?s.jsxs(oe,{variant:d?"secondary":i,size:a,className:ke("gap-2",l),onClick:v,disabled:p,"data-venue-name":e,"data-testid":"venue-follow-button",children:[p?s.jsx(er,{className:"h-4 w-4 animate-spin"}):d?s.jsx(GJ,{className:"h-4 w-4"}):s.jsx(Xt,{className:"h-4 w-4"}),s.jsxs("span",{children:[d?"Following":"Follow",o&&h>0&&` (${h})`]})]}):(console.warn(" VenueFollowButton: No venueName provided, not rendering"),null):(console.warn(" VenueFollowButton: No userId provided, not rendering"),null)}const dh={spam:{label:"Spam",description:"Unwanted or repetitive content",icon:""},inappropriate_content:{label:"Inappropriate Content",description:"Offensive, explicit, or disturbing content",icon:""},harassment:{label:"Harassment or Bullying",description:"Targeting someone with hateful or threatening content",icon:""},misinformation:{label:"False Information",description:"Spreading false or misleading information",icon:""},copyright_violation:{label:"Copyright Violation",description:"Unauthorized use of copyrighted material",icon:""},fake_event:{label:"Fake or Fraudulent Event",description:"Event that doesn't exist or is misleading",icon:""},duplicate:{label:"Duplicate Content",description:"Same content posted multiple times",icon:""},other:{label:"Other",description:"Something else that violates guidelines",icon:""}};class Tu{static reportContent(t){return E(this,null,function*(){var r;try{const{data:{user:n},error:i}=yield P.auth.getUser();if(i||!n)throw new Error("User must be authenticated to report content");const o={spam:"spam",inappropriate_content:"inappropriate_content",harassment:"harassment",misinformation:"misinformation",copyright_violation:"copyright_violation",fake_event:"fake_content",duplicate:"spam",other:"other"}[t.flag_reason]||"other";let l=t.content_type;if(l==="comment"||l==="profile"||l==="message")if(l==="comment")l="review";else if(l==="profile")l="artist";else throw new Error(`Content type ${l} is not supported for moderation flags`);const{data:c,error:d}=yield P.from("users").select("user_id").eq("user_id",n.id).maybeSingle(),u=(c==null?void 0:c.user_id)||n.id,{data:h,error:f}=yield P.from("moderation_flags").insert({flagged_by_user_id:u,content_type:l,content_id:t.content_id,flag_reason:t.flag_reason,flag_category:o,additional_details:((r=t.flag_details)==null?void 0:r.trim())||null,status:"pending"}).select("id").single();if(f)throw f.code==="23505"?new Error("You have already reported this content"):f;return h.id}catch(n){throw console.error("Error reporting content:",n),n instanceof Error?n:new Error("Failed to report content")}})}static blockUser(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.rpc("block_user",{p_blocked_user_id:t.blocked_user_id,p_block_reason:t.block_reason||null});if(n)throw n;return r}catch(r){throw console.error("Error blocking user:",r),r}})}static unblockUser(t){return E(this,null,function*(){try{const{error:r}=yield P.rpc("unblock_user",{p_blocked_user_id:t});if(r)throw r}catch(r){throw console.error("Error unblocking user:",r),r}})}static isUserBlocked(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.rpc("is_user_blocked",{p_user_id:t,p_by_user_id:r||null});if(i)throw i;return n||!1}catch(n){return console.error("Error checking block status:",n),!1}})}static getBlockedUsers(){return E(this,null,function*(){try{const{data:t,error:r}=yield P.rpc("get_blocked_users");if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching blocked users:",t),t}})}static getUserReports(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield P.auth.getUser();if(n||!r)throw new Error("User not authenticated");const i=t||r.id,{data:a,error:o}=yield P.from("moderation_flags").select("*").eq("flagged_by_user_id",i).order("created_at",{ascending:!1});if(o)throw o;return a||[]}catch(r){throw console.error("Error fetching user reports:",r),r}})}static moderateContent(t,r,n,i=!0){return E(this,null,function*(){try{const{error:a}=yield P.rpc("moderate_content",{p_flag_id:t,p_action:r,p_review_notes:n||null,p_notify_user:i});if(a)throw a}catch(a){throw console.error("Error moderating content:",a),a}})}static getFlaggedContentDetails(t,r){return E(this,null,function*(){try{let n;switch(t){case"event":n=P.from("events").select("*").eq("id",r).single();break;case"review":n=P.from("reviews").select(`
              *,
              user:users!reviews_user_id_fkey(name, avatar_url)
            `).eq("id",r).single();break;case"comment":n=P.from("comments").select(`
              *,
              user:users!comments_user_id_fkey(name, avatar_url)
            `).eq("id",r).single();break;case"profile":n=P.from("users").select("*").eq("user_id",r).single();break;default:throw new Error("Unsupported content type")}const{data:i,error:a}=yield n;if(a)throw a;return i}catch(n){throw console.error("Error fetching content details:",n),n}})}static getFlagReasons(){return dh}static getUserModerationStatus(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("users").select("moderation_status, warning_count, last_warned_at, suspended_until, ban_reason").eq("user_id",t).single();if(n)throw n;return r}catch(r){throw console.error("Error fetching moderation status:",r),r}})}static canReportContent(t,r){return E(this,null,function*(){try{const{data:{user:n}}=yield P.auth.getUser();if(!n)return!1;const{data:i,error:a}=yield P.from("moderation_flags").select("id").eq("flagged_by_user_id",n.id).eq("content_type",t).eq("content_id",r).single();return a&&a.code==="PGRST116"?!0:!i}catch(n){return console.error("Error checking report eligibility:",n),!1}})}static getContentTypeDisplayName(t){return{event:"Event",review:"Review",comment:"Comment",profile:"Profile",message:"Message"}[t]||t}}function Jw({open:e,onClose:t,contentType:r,contentId:n,contentTitle:i,onReportSubmitted:a}){const{toast:o}=jr(),[l,c]=y.useState(!1),[d,u]=y.useState(""),[h,f]=y.useState(""),p=g=>E(this,null,function*(){if(g.preventDefault(),!d){o({title:"Please select a reason",description:"Select why you're reporting this content",variant:"destructive"});return}c(!0);try{yield Tu.reportContent({content_type:r,content_id:n,flag_reason:d,flag_details:h.trim()||void 0}),o({title:"Report Submitted",description:"Thank you for helping keep our community safe. We'll review this report shortly."}),a==null||a(),x()}catch(v){console.error("Error submitting report:",v),o({title:"Error",description:v instanceof Error?v.message:"Failed to submit report",variant:"destructive"})}finally{c(!1)}}),x=()=>{l||(u(""),f(""),t())};return s.jsx(tn,{open:e,onOpenChange:x,children:s.jsxs(Xr,{className:"sm:max-w-[550px] max-h-[90vh] flex flex-col",children:[s.jsxs(Mn,{className:"flex-shrink-0",children:[s.jsxs(an,{className:"flex items-center gap-2",children:[s.jsx(Va,{className:"h-5 w-5 text-red-600"}),"Report ",Tu.getContentTypeDisplayName(r)]}),s.jsx(Kn,{children:"Help us understand what's wrong with this content. Your report is anonymous."})]}),i&&s.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200 flex-shrink-0",children:s.jsx("p",{className:"text-sm text-gray-700 font-medium truncate",children:i})}),s.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs(Ut,{children:["Why are you reporting this? ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("div",{className:"space-y-2",children:Object.entries(dh).map(([g,v])=>s.jsxs("label",{className:`flex items-start p-3 border rounded-lg cursor-pointer transition-colors ${d===g?"border-red-500 bg-red-50":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"reason",value:g,checked:d===g,onChange:_=>u(_.target.value),disabled:l,className:"mt-0.5 mr-3"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-lg",children:v.icon}),s.jsx("span",{className:"font-medium text-sm",children:v.label})]}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:v.description})]})]},g))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"details",children:"Additional Details (Optional)"}),s.jsx(as,{id:"details",placeholder:"Provide any additional context that might help us review this report...",value:h,onChange:g=>f(g.target.value),disabled:l,rows:4}),s.jsx("p",{className:"text-xs text-gray-500",children:"Do not include personal information in your report."})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex gap-3",children:[s.jsx(ag,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-900",children:[s.jsx("p",{className:"font-medium mb-1",children:"What happens next?"}),s.jsxs("ul",{className:"text-xs space-y-1 list-disc list-inside",children:[s.jsx("li",{children:"Your report will be reviewed by our moderation team"}),s.jsx("li",{children:"We may remove content that violates our guidelines"}),s.jsx("li",{children:"You'll receive a notification about the outcome"}),s.jsx("li",{children:"Reports are confidential and anonymous"})]})]})]})]})}),s.jsxs(ff,{className:"flex-shrink-0 border-t pt-4",children:[s.jsx(oe,{type:"button",variant:"outline",onClick:x,disabled:l,children:"Cancel"}),s.jsx(oe,{type:"submit",variant:"destructive",disabled:l||!d,onClick:p,children:l?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-4 h-4 mr-2 animate-spin"}),"Submitting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Va,{className:"w-4 h-4 mr-2"}),"Submit Report"]})})]})]})})}var Qw="Collapsible",[sde,IF]=js(Qw),[ide,FE]=sde(Qw),$F=y.forwardRef((e,t)=>{const u=e,{__scopeCollapsible:r,open:n,defaultOpen:i,disabled:a,onOpenChange:o}=u,l=me(u,["__scopeCollapsible","open","defaultOpen","disabled","onOpenChange"]),[c,d]=Di({prop:n,defaultProp:i!=null?i:!1,onChange:o,caller:Qw});return s.jsx(ide,{scope:r,disabled:a,contentId:_s(),open:c,onOpenToggle:y.useCallback(()=>d(h=>!h),[d]),children:s.jsx(Nt.div,W(M({"data-state":VE(c),"data-disabled":a?"":void 0},l),{ref:t}))})});$F.displayName=Qw;var LF="CollapsibleTrigger",UE=y.forwardRef((e,t)=>{const a=e,{__scopeCollapsible:r}=a,n=me(a,["__scopeCollapsible"]),i=FE(LF,r);return s.jsx(Nt.button,W(M({type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":VE(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled},n),{ref:t,onClick:mt(e.onClick,i.onOpenToggle)}))});UE.displayName=LF;var BE="CollapsibleContent",zE=y.forwardRef((e,t)=>{const a=e,{forceMount:r}=a,n=me(a,["forceMount"]),i=FE(BE,e.__scopeCollapsible);return s.jsx($s,{present:r||i.open,children:({present:o})=>s.jsx(ade,W(M({},n),{ref:t,present:o}))})});zE.displayName=BE;var ade=y.forwardRef((e,t)=>{const w=e,{__scopeCollapsible:r,present:n,children:i}=w,a=me(w,["__scopeCollapsible","present","children"]),o=FE(BE,r),[l,c]=y.useState(n),d=y.useRef(null),u=sr(t,d),h=y.useRef(0),f=h.current,p=y.useRef(0),x=p.current,g=o.open||l,v=y.useRef(g),_=y.useRef(void 0);return y.useEffect(()=>{const b=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(b)},[]),is(()=>{const b=d.current;if(b){_.current=_.current||{transitionDuration:b.style.transitionDuration,animationName:b.style.animationName},b.style.transitionDuration="0s",b.style.animationName="none";const N=b.getBoundingClientRect();h.current=N.height,p.current=N.width,v.current||(b.style.transitionDuration=_.current.transitionDuration,b.style.animationName=_.current.animationName),c(n)}},[o.open,n]),s.jsx(Nt.div,W(M({"data-state":VE(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!g},a),{ref:u,style:M({"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":x?`${x}px`:void 0},e.style),children:g&&i}))});function VE(e){return e?"open":"closed"}var FF=$F,ode=UE,lde=zE;const cde=FF,dde=UE,ude=zE;function L2({review:e,currentUserId:t,onLike:r,onComment:n,onShare:i,onEdit:a,onDelete:o,showEventInfo:l=!1,onReport:c,userProfile:d,followedArtists:u=[],followedVenues:h=[]}){var wt,Ht,Rt,Te,bt,$e,Ie,Ue,dt,be,Re,We,St,Ye,ir,jt,pt,vn,Jn,Fs,Mt;const[f,p]=y.useState(null);y.useEffect(()=>{const re=e.artist_performance_rating!=null||e.production_rating!=null||e.venue_rating!=null||e.location_rating!=null||e.value_rating!=null,Ke=!!e.venue_feedback&&e.venue_rating==null;!re||Ke?(console.log(" BelliStyleReviewCard - Missing category ratings, fetching full review data for:",e.id),P.from("reviews").select("rating, artist_performance_rating, production_rating, venue_rating, location_rating, value_rating, artist_performance_feedback, production_feedback, venue_feedback, location_feedback, value_feedback").eq("id",e.id).single().then(({data:ht,error:ct})=>{!ct&&ht?(console.log(" BelliStyleReviewCard - Fetched review data:",ht),p(ht)):ct&&console.error(" BelliStyleReviewCard - Error fetching review data:",ct)})):console.log(" BelliStyleReviewCard - Full review object:",{id:e.id,venue_rating:e.venue_rating,artist_performance_rating:e.artist_performance_rating,production_rating:e.production_rating,location_rating:e.location_rating,value_rating:e.value_rating,rating:e.rating,allKeys:Object.keys(e)})},[e.id]);const[x,g]=y.useState(e.is_liked_by_user||!1),[v,_]=y.useState(e.likes_count),[w,b]=y.useState(!1),[N,S]=y.useState(!1),[k,O]=y.useState([]),[A,T]=y.useState(e.comments_count||0),[$,R]=y.useState(!1),[F,D]=y.useState(""),[B,U]=y.useState(!1);y.useState(!1);const V=Array.isArray(e==null?void 0:e.photos)?e.photos:[],[Y,z]=y.useState(!1),[K,Z]=y.useState(0),[G,X]=y.useState(!1),[te,se]=y.useState(!1),[ue,ye]=y.useState(!1),{toast:ne}=jr(),[xe,ge]=y.useState(null),[ie,ee]=y.useState("loading"),[H,le]=y.useState(!1),Se=()=>E(this,null,function*(){if(!(!t||w)){b(!0);try{x?(yield fs.unlikeReview(t,e.id),_(re=>Math.max(0,re-1)),g(!1)):(yield fs.likeReview(t,e.id),_(re=>re+1),g(!0)),r&&r(e.id,!x)}catch(re){console.error("Error toggling like:",re),x?(_(_e=>_e+1),g(!0)):(_(_e=>Math.max(0,_e-1)),g(!1))}finally{b(!1)}}}),ae=()=>E(this,null,function*(){const re=!N;if(S(re),re&&k.length===0)try{R(!0);const _e=yield fs.getReviewComments(e.id);O(_e),T(_e.length)}catch(_e){console.error("Error loading comments:",_e)}finally{R(!1)}}),fe=()=>E(this,null,function*(){if(!(!t||!F.trim()||B))try{U(!0);const re=yield fs.addComment(t,e.id,F.trim());O(_e=>[..._e,W(M({},re),{user:{id:re.user_id,name:(d==null?void 0:d.name)||"You",avatar_url:d==null?void 0:d.avatar_url}})]),D(""),T(_e=>_e+1)}finally{U(!1)}}),he=()=>{i&&i(e.id),ye(!0)},pe=re=>{re.preventDefault(),re.stopPropagation(),console.log("BelliStyleReviewCard: Edit button clicked",{reviewId:e.id}),a?a(e):console.warn("onEdit handler not provided to BelliStyleReviewCard")},Ae=()=>E(this,null,function*(){o&&window.confirm("Are you sure you want to delete this review?")&&o(e.id)}),qe=t&&e.user_id===t;f&&M(M({},e),f);const Fe=(wt=f==null?void 0:f.artist_performance_rating)!=null?wt:e.artist_performance_rating,ve=(Ht=f==null?void 0:f.production_rating)!=null?Ht:e.production_rating,rt=(Rt=f==null?void 0:f.venue_rating)!=null?Rt:e.venue_rating,Ve=(Te=f==null?void 0:f.location_rating)!=null?Te:e.location_rating,lt=(bt=f==null?void 0:f.value_rating)!=null?bt:e.value_rating,ut=[Fe,ve,rt,Ve,lt].filter(re=>typeof re=="number"&&!isNaN(re)&&re>0),Ze=ut.length>0?Number((ut.reduce((re,_e)=>re+_e,0)/ut.length).toFixed(1)):null,qt=typeof e.rating=="string"?parseFloat(e.rating):typeof e.rating=="number"?e.rating:null,lr=f!=null&&f.rating?typeof f.rating=="string"?parseFloat(f.rating):f.rating:null,Ge=lr!=null&&!Number.isNaN(lr)&&lr>=0?lr:qt!=null&&!Number.isNaN(qt)&&qt>=0?qt:Ze!=null&&Ze>=0?Ze:null;y.useEffect(()=>{console.log(" Overall Rating Debug:",{reviewRating:e.rating,reviewRatingType:typeof e.rating,reviewRatingValue:qt,computedAverage:Ze,categoryAverages:ut,overallRating:Ge,fetchedReviewData:!!f,willDisplay:Ge>0})},[e.rating,qt,Ze,Ge,f]);const Le=re=>re>=4.5?"ring-green-500":re>=3.5?"ring-yellow-500":re>=2.5?"ring-orange-500":"ring-red-500",yt=re=>re>=4.5?"from-green-400 to-green-600":re>=3.5?"from-yellow-400 to-yellow-600":re>=2.5?"from-orange-400 to-orange-600":"from-red-400 to-red-600",Ne=(re,_e="sm")=>{const Ke=_e==="sm"?"w-3 h-3":"w-4 h-4";return Array.from({length:5},(ht,ct)=>{const Pe=ct+1,et=re>=Pe,nt=!et&&re>=Pe-.5;return s.jsxs("div",{className:ke("relative",Ke),children:[s.jsx(Jt,{className:ke(Ke,"text-gray-300")}),(nt||et)&&s.jsx("div",{className:ke("absolute left-0 top-0 h-full overflow-hidden pointer-events-none",et?"w-full":"w-1/2"),children:s.jsx(Jt,{className:ke(Ke,"text-yellow-400 fill-current")})})]},ct)})};y.useEffect(()=>{const re=Ke=>{Ke.stopPropagation(),ae()},_e=document.getElementById(`belli-review-card-${e.id}`);return _e==null||_e.addEventListener("toggle-review-comments",re),()=>_e==null?void 0:_e.removeEventListener("toggle-review-comments",re)},[e.id,N,k.length]),y.useEffect(()=>{E(this,null,function*(){if(!t||!e.user_id||t===e.user_id){ge(null),ee("none");return}try{const{data:_e,error:Ke}=yield P.rpc("get_connection_info",{current_user_id:t,target_user_id:e.user_id});Ke?(console.warn("Error fetching connection info:",Ke),ge(null)):_e&&_e.length>0&&_e[0].degree<=3?ge({degree:_e[0].degree,label:_e[0].label,color:_e[0].color}):ge(null);const{data:ht,error:ct}=yield P.from("user_relationships").select("id, user_id, related_user_id, status").eq("relationship_type","friend").eq("status","accepted").or(`and(user_id.eq.${t},related_user_id.eq.${e.user_id}),and(user_id.eq.${e.user_id},related_user_id.eq.${t})`).maybeSingle();if(ct&&ct.code!=="PGRST116"&&console.warn("Error checking friend status:",ct),ht)ee("friends");else{const{data:Pe,error:et}=yield P.from("user_relationships").select("id, user_id, related_user_id, status").eq("relationship_type","friend").eq("status","pending").or(`and(user_id.eq.${t},related_user_id.eq.${e.user_id}),and(user_id.eq.${e.user_id},related_user_id.eq.${t})`).maybeSingle();et&&et.code!=="PGRST116"&&console.warn("Error checking friend request:",et),Pe?Pe.user_id===t?ee("pending_sent"):ee("pending_received"):ee("none")}}catch(_e){console.error("Error fetching connection/friend info:",_e),ge(null),ee("none")}})},[t,e.user_id]),y.useEffect(()=>{E(this,null,function*(){if(t)try{const _e=yield fs.getReviewEngagement(e.id,t);_e&&(_(_e.likes_count),T(_e.comments_count),g(_e.is_liked_by_user))}catch(_e){console.error("Error refreshing engagement data:",_e)}})},[e.id,t]);const Oe=re=>{Z(re),z(!0)},ce=()=>z(!1),Ee=()=>E(this,null,function*(){if(!(!t||!e.user_id||H))try{le(!0);const{data:re,error:_e}=yield P.rpc("create_friend_request",{receiver_user_id:e.user_id});if(_e)throw _e;ee("pending_sent"),ne({title:"Friend Request Sent! ",description:"Your friend request has been sent."})}catch(re){console.error("Error sending friend request:",re),ne({title:"Error",description:re.message||"Failed to send friend request. Please try again.",variant:"destructive"})}finally{le(!1)}}),Qe=re=>{re&&re.stopPropagation(),V.length&&Z(_e=>(_e-1+V.length)%V.length)},vt=re=>{re&&re.stopPropagation(),V.length&&Z(_e=>(_e+1)%V.length)};return s.jsxs(He,{className:"w-full border-2 shadow-lg hover:shadow-xl transition-all duration-300 bg-gray-50 rounded-xl overflow-hidden",id:`belli-review-card-${e.id}`,children:[s.jsxs(xr,{className:"pb-4 bg-gradient-to-br from-gray-50 via-white to-gray-50 border-b-2 relative",children:[Ge!=null&&Ge>=0&&s.jsxs("div",{className:ke("absolute top-4 right-4 w-16 h-16 rounded-full flex flex-col items-center justify-center","bg-gradient-to-br shadow-lg",yt(Math.max(.5,Ge)),"text-white font-bold z-10"),children:[s.jsx("span",{className:"text-2xl leading-none",children:Ge.toFixed(1)}),s.jsx("div",{className:"flex items-center gap-0.5 mt-1",children:Array.from({length:5},(re,_e)=>s.jsx(Jt,{className:ke("w-2 h-2",_e<Math.round(Ge)?"fill-white text-white":"text-white/40")},_e))})]}),s.jsxs("div",{className:"flex items-start gap-4 pr-20",children:[s.jsxs(Vr,{className:ke("w-14 h-14 ring-4",Le(Ge)),children:[s.jsx(Qr,{src:(d==null?void 0:d.avatar_url)||void 0,alt:(d==null?void 0:d.name)||"User"}),s.jsx(qr,{className:"text-lg font-semibold bg-gradient-to-br from-[#FF3399] to-[#FF66B3] text-white",children:(($e=d==null?void 0:d.name)==null?void 0:$e.charAt(0).toUpperCase())||((Ie=e.user_id)==null?void 0:Ie.slice(0,1).toUpperCase())||"U"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1 flex-wrap gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:(d==null?void 0:d.name)||"User"}),(d==null?void 0:d.verified)&&(d==null?void 0:d.account_type)&&s.jsx(LE,{accountType:d.account_type,verified:d.verified,size:"md"}),t&&e.user_id!==t&&xe&&xe.degree<=3&&s.jsx(Be,{className:ke("text-xs font-semibold px-2 py-0.5 border-2 border-black",xe.color==="dark-green"?"bg-green-700 text-white hover:bg-green-800":xe.color==="light-green"?"bg-green-400 text-green-900 hover:bg-green-500":xe.color==="yellow"?"bg-yellow-400 text-yellow-900 hover:bg-yellow-500":xe.color==="red"?"bg-red-500 text-white hover:bg-red-600":xe.color==="blue"?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-500 text-white hover:bg-gray-600"),children:xe.label})]}),t&&e.user_id!==t&&ie!=="friends"&&ie!=="pending_sent"&&ie!=="loading"&&s.jsxs(oe,{size:"sm",variant:"outline",onClick:re=>{re.preventDefault(),re.stopPropagation(),Ee()},disabled:H,className:"h-7 text-xs px-2 gap-1",children:[s.jsx(Pu,{className:"w-3 h-3"}),H?"Sending...":ie==="pending_received"?"Pending":"Add Friend"]})]}),s.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:["Reviewed ",s.jsx("span",{className:"text-[#FF3399] font-semibold",children:e.artist_name||((Ue=e.event)==null?void 0:Ue.artist_name)||"Artist"}),(e.venue_name||((dt=e.event)==null?void 0:dt.venue_name))&&s.jsxs(s.Fragment,{children:[" ","at ",s.jsx("span",{className:"text-gray-800",children:e.venue_name||((be=e.event)==null?void 0:be.venue_name)})]})]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center gap-2",children:[s.jsx("span",{children:D2(new Date(e.created_at),{addSuffix:!0})}),e.venue_city&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Xt,{className:"w-3 h-3"}),e.venue_city,", ",e.venue_state]})]})]})]}),qe&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(oe,{variant:"ghost",size:"sm",onClick:re=>pe(re),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"Edit review",children:s.jsx(Cu,{className:"h-4 w-4"})}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:Ae,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:s.jsx(yc,{className:"h-4 w-4"})})]})]})]}),s.jsxs(st,{className:"pt-5 px-5 pb-2",children:[e.review_text&&e.review_text!=="ATTENDANCE_ONLY"&&s.jsx("div",{className:"mb-4",children:s.jsx("p",{className:"text-base leading-relaxed text-gray-800",children:e.review_text})}),V.length>0&&s.jsx("div",{className:"mb-4",children:V.length===1?s.jsx("div",{className:"rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm",children:s.jsx("img",{src:V[0],alt:"Review photo",className:"w-full h-80 object-cover cursor-zoom-in hover:opacity-95 transition-opacity",loading:"lazy",onClick:re=>{re.stopPropagation(),Oe(0)}})}):s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx("div",{className:"col-span-2 row-span-2 rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm",children:s.jsx("img",{src:V[0],alt:"Review photo 1",className:"w-full h-full object-cover cursor-zoom-in hover:opacity-95 transition-opacity",loading:"lazy",onClick:re=>{re.stopPropagation(),Oe(0)}})}),V.slice(1,5).map((re,_e)=>s.jsx("div",{className:"rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm aspect-square",children:s.jsx("img",{src:re,alt:`Review photo ${_e+2}`,className:"w-full h-full object-cover cursor-zoom-in hover:opacity-95 transition-opacity",loading:"lazy",onClick:Ke=>{Ke.stopPropagation(),Oe(_e+1)}})},_e)),V.length>5&&s.jsxs("button",{onClick:re=>{re.stopPropagation(),Oe(5)},className:"rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm aspect-square bg-black/60 flex items-center justify-center text-white font-bold text-lg hover:bg-black/70 transition-colors",children:["+",V.length-5]})]})}),s.jsxs(cde,{open:te,onOpenChange:se,children:[s.jsx(dde,{asChild:!0,children:s.jsxs(oe,{variant:"outline",className:"w-full mb-3 flex items-center justify-between hover:bg-gray-50",onClick:re=>{re.stopPropagation(),se(!te)},children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(oa,{className:"w-4 h-4"}),"View Rating Details"]}),te?s.jsx(al,{className:"w-4 h-4"}):s.jsx(Qi,{className:"w-4 h-4"})]})}),s.jsx(ude,{className:"space-y-3 mb-4",children:[{label:"Artist Performance",rating:(Re=f==null?void 0:f.artist_performance_rating)!=null?Re:e.artist_performance_rating,feedback:(We=f==null?void 0:f.artist_performance_feedback)!=null?We:e.artist_performance_feedback,icon:ZJ,border:"border-[#FF3399]",gradient:"from-[#FF3399]/5 to-[#FF3399]/10",iconColor:"text-[#FF3399]"},{label:"Production Quality",rating:(St=f==null?void 0:f.production_rating)!=null?St:e.production_rating,feedback:(Ye=f==null?void 0:f.production_feedback)!=null?Ye:e.production_feedback,icon:VJ,border:"border-purple-500",gradient:"from-purple-50 to-purple-50/30",iconColor:"text-purple-600"},{label:"Venue Experience",rating:(jt=(ir=f==null?void 0:f.venue_rating)!=null?ir:e.venue_rating)!=null?jt:void 0,feedback:(pt=f==null?void 0:f.venue_feedback)!=null?pt:e.venue_feedback,recommendation:e.venue_recommendation,icon:Ba,border:"border-blue-500",gradient:"from-blue-50 to-blue-50/30",iconColor:"text-blue-600"},{label:"Location & Logistics",rating:(vn=f==null?void 0:f.location_rating)!=null?vn:e.location_rating,feedback:(Jn=f==null?void 0:f.location_feedback)!=null?Jn:e.location_feedback,recommendation:e.location_recommendation,icon:TJ,border:"border-emerald-500",gradient:"from-emerald-50 to-emerald-50/30",iconColor:"text-emerald-600"},{label:"Value for Ticket",rating:(Fs=f==null?void 0:f.value_rating)!=null?Fs:e.value_rating,feedback:(Mt=f==null?void 0:f.value_feedback)!=null?Mt:e.value_feedback,recommendation:e.value_recommendation,icon:bo,border:"border-amber-500",gradient:"from-amber-50 to-amber-50/30",iconColor:"text-amber-600"}].map(re=>{const _e=typeof re.rating=="string"?parseFloat(re.rating):re.rating,Ke=typeof _e=="number"&&!isNaN(_e)&&_e>0?_e:void 0;if(re.label==="Venue Experience"&&console.log(" Venue Experience Debug:",{label:re.label,rawRating:re.rating,ratingValue:_e,resolvedRating:Ke,reviewVenueRating:e.venue_rating,fetchedVenueRating:f==null?void 0:f.venue_rating,hasFeedback:!!re.feedback}),!Ke&&!re.feedback)return null;const ht=re.icon;return s.jsxs("div",{className:ke("border-l-4 rounded-r-lg p-4 shadow-sm bg-gradient-to-r",re.border,re.gradient),children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ht,{className:ke("w-5 h-5",re.iconColor)}),s.jsx("span",{className:"text-sm font-bold text-gray-900",children:re.label})]}),Ke&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex items-center gap-0.5",children:Ne(Ke,"md")}),s.jsx("span",{className:"text-lg font-bold text-gray-900",children:Ke.toFixed(1)})]})]}),re.feedback&&s.jsxs("p",{className:"text-sm text-gray-700 italic leading-relaxed",children:['"',re.feedback,'"']})]},re.label)})})]}),e.setlist&&s.jsx("div",{className:"mb-4",children:s.jsx(sA,{setlist:e.setlist,compact:!0,type:"api"})}),e.custom_setlist&&e.custom_setlist.length>0&&s.jsx("div",{className:"mb-4",children:s.jsx(sA,{customSetlist:e.custom_setlist,compact:!0,type:"custom"})}),s.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg border-2 border-gray-200",children:s.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[e.artist_name&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:ke("px-3 py-1.5 rounded-full font-medium text-sm transition-all shadow-sm flex items-center gap-1.5",u.includes(e.artist_name)?"bg-[#FF3399] text-white border-2 border-[#FF3399]":"bg-white border-2 border-[#FF3399]/30 hover:border-[#FF3399] hover:bg-[#FF3399]/5"),onClick:re=>{re.preventDefault(),re.stopPropagation();const _e=e.artist_id||e.artist_uuid,Ke=new CustomEvent("open-artist-card",{detail:{artistId:_e,artistName:e.artist_name}});document.dispatchEvent(Ke)},"aria-label":`View artist ${e.artist_name}`,children:[u.includes(e.artist_name)&&s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})," ",e.artist_name]}),t&&s.jsx(Tv,{artistName:e.artist_name,userId:t,variant:"outline",size:"sm",showFollowerCount:!1,className:"h-8 text-xs border-2"})]}),e.venue_name&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:ke("px-3 py-1.5 rounded-full font-medium text-sm transition-all shadow-sm flex items-center gap-1.5",h.some(re=>re.name===e.venue_name&&(!re.city||re.city===e.venue_city)&&(!re.state||re.state===e.venue_state))?"bg-blue-600 text-white border-2 border-blue-600":"bg-white border-2 border-blue-200 hover:border-blue-400 hover:bg-blue-50"),onClick:re=>{re.preventDefault(),re.stopPropagation();const _e=e.venue_id||e.venue_uuid,Ke=new CustomEvent("open-venue-card",{detail:{venueId:_e,venueName:e.venue_name}});document.dispatchEvent(Ke)},"aria-label":`View venue ${e.venue_name}`,children:[h.some(re=>re.name===e.venue_name&&(!re.city||re.city===e.venue_city)&&(!re.state||re.state===e.venue_state))&&s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})," ",e.venue_name]}),t&&s.jsx(Xw,{venueName:e.venue_name,venueCity:e.venue_city,venueState:e.venue_state,userId:t,variant:"outline",size:"sm",showFollowerCount:!1,className:"h-8 text-xs border-2"})]})]})}),s.jsxs("div",{className:"flex items-center justify-between pt-3 pb-2 border-t-2",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onMouseDown:re=>{re.stopPropagation()},onClick:re=>{re.preventDefault(),re.stopPropagation(),Se()},disabled:!t||w,className:ke("flex items-center gap-2 px-4 py-2 rounded-full font-medium transition-all",x?"bg-[#FF3399]/10 text-[#FF3399] hover:bg-[#FF3399]/20":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[s.jsx(iQ,{className:ke("h-5 w-5",x&&"fill-current")}),s.jsx("span",{className:"font-semibold",children:v}),s.jsx("span",{className:"hidden sm:inline",children:"Helpful"})]}),s.jsxs(oe,{variant:"ghost",size:"sm",onMouseDown:re=>{re.stopPropagation()},onClick:re=>{re.preventDefault(),re.stopPropagation(),ae()},className:"flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium transition-all",children:[s.jsx(Wn,{className:"h-5 w-5"}),s.jsx("span",{className:"font-semibold",children:A}),s.jsx("span",{className:"hidden sm:inline",children:"Comments"})]}),s.jsxs(oe,{variant:"ghost",size:"sm",onMouseDown:re=>{re.stopPropagation()},onClick:re=>{re.preventDefault(),re.stopPropagation(),he()},className:"flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium transition-all",children:[s.jsx(Vu,{className:"h-5 w-5"}),s.jsx("span",{className:"hidden sm:inline",children:"Share"})]})]}),t&&!qe&&s.jsx(oe,{variant:"ghost",size:"sm",onMouseDown:re=>{re.stopPropagation()},onClick:re=>{re.preventDefault(),re.stopPropagation(),X(!0)},className:"rounded-full p-2 text-gray-500 hover:text-red-600 hover:bg-red-50",title:"Report this review",children:s.jsx(Va,{className:"h-5 w-5"})})]})]}),N&&s.jsx("div",{className:"px-5 pb-3 pt-3 border-t-2",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Wn,{className:"w-5 h-5 text-[#FF3399]"}),"Comments (",A,")"]}),$?s.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[s.jsx(er,{className:"h-4 w-4 animate-spin mr-2"}),"Loading comments"]}):k.length===0?s.jsx("div",{className:"text-sm text-gray-500 italic text-center py-4 bg-gray-50 rounded-lg",children:"No comments yet. Be the first to comment!"}):s.jsx("div",{className:"space-y-3",children:k.map(re=>{var _e,Ke,ht,ct;return s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsxs(Vr,{className:"w-9 h-9",children:[s.jsx(Qr,{src:((_e=re.user)==null?void 0:_e.avatar_url)||void 0,alt:((Ke=re.user)==null?void 0:Ke.name)||"User"}),s.jsx(qr,{className:"text-xs bg-gradient-to-br from-[#FF3399] to-[#FF66B3] text-white",children:(((ht=re.user)==null?void 0:ht.name)||"U").charAt(0).toUpperCase()})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:((ct=re.user)==null?void 0:ct.name)||"User"}),s.jsx("span",{className:"text-xs text-gray-500",children:D2(new Date(re.created_at),{addSuffix:!0})})]}),s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:re.comment_text})]})]},re.id)})}),s.jsxs("div",{className:"flex items-end gap-2 mt-4",children:[s.jsx(as,{value:F,onChange:re=>D(re.target.value),placeholder:t?"Write a comment":"Sign in to comment",disabled:!t||B,className:"min-h-[60px] border-2 focus:border-[#FF3399] rounded-lg"}),s.jsx(oe,{onClick:fe,disabled:!t||B||!F.trim(),className:"bg-gradient-to-r from-[#FF3399] to-[#FF66B3] hover:from-[#FF66B3] hover:to-[#FF3399] text-white",size:"lg",children:B?s.jsx(er,{className:"h-5 w-5 animate-spin"}):s.jsx(cf,{className:"h-5 w-5"})})]})]})}),Y&&V.length>0&&s.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center",onClick:ce,role:"dialog","aria-modal":"true",children:[s.jsx("button",{className:"absolute top-4 right-4 text-white/80 hover:text-white text-3xl w-12 h-12 flex items-center justify-center rounded-full hover:bg-white/10","aria-label":"Close",onClick:re=>{re.stopPropagation(),ce()},children:""}),V.length>1&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"absolute left-4 text-white/80 hover:text-white text-4xl w-12 h-12 flex items-center justify-center rounded-full hover:bg-white/10","aria-label":"Previous image",onClick:Qe,children:""}),s.jsx("button",{className:"absolute right-4 text-white/80 hover:text-white text-4xl w-12 h-12 flex items-center justify-center rounded-full hover:bg-white/10","aria-label":"Next image",onClick:vt,children:""})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("img",{src:V[K],alt:`Review photo ${K+1}`,className:"max-h-[85vh] max-w-[90vw] object-contain rounded-lg shadow-2xl",onClick:re=>re.stopPropagation()}),s.jsxs("p",{className:"text-white/70 mt-4 text-sm",children:[K+1," / ",V.length]})]})]}),s.jsx(Jw,{open:G,onClose:()=>X(!1),contentType:"review",contentId:e.id,contentTitle:`Review for ${e.artist_name} at ${e.venue_name}`,onReportSubmitted:()=>{X(!1),c==null||c(e.id)}}),ue&&t&&s.jsx(DF,{review:e,currentUserId:t,isOpen:ue,onClose:()=>ye(!1)})]})}var Uo="Accordion",fde=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[qE,hde,mde]=zm(Uo),[e1,SFe]=js(Uo,[mde,IF]),WE=IF(),UF=Q.forwardRef((e,t)=>{const o=e,{type:r}=o,n=me(o,["type"]),i=n,a=n;return s.jsx(qE.Provider,{scope:e.__scopeAccordion,children:r==="multiple"?s.jsx(xde,W(M({},a),{ref:t})):s.jsx(vde,W(M({},i),{ref:t}))})});UF.displayName=Uo;var[BF,pde]=e1(Uo),[zF,gde]=e1(Uo,{collapsible:!1}),vde=Q.forwardRef((e,t)=>{const d=e,{value:r,defaultValue:n,onValueChange:i=()=>{},collapsible:a=!1}=d,o=me(d,["value","defaultValue","onValueChange","collapsible"]),[l,c]=Di({prop:r,defaultProp:n!=null?n:"",onChange:i,caller:Uo});return s.jsx(BF,{scope:e.__scopeAccordion,value:Q.useMemo(()=>l?[l]:[],[l]),onItemOpen:c,onItemClose:Q.useCallback(()=>a&&c(""),[a,c]),children:s.jsx(zF,{scope:e.__scopeAccordion,collapsible:a,children:s.jsx(VF,W(M({},o),{ref:t}))})})}),xde=Q.forwardRef((e,t)=>{const u=e,{value:r,defaultValue:n,onValueChange:i=()=>{}}=u,a=me(u,["value","defaultValue","onValueChange"]),[o,l]=Di({prop:r,defaultProp:n!=null?n:[],onChange:i,caller:Uo}),c=Q.useCallback(h=>l((f=[])=>[...f,h]),[l]),d=Q.useCallback(h=>l((f=[])=>f.filter(p=>p!==h)),[l]);return s.jsx(BF,{scope:e.__scopeAccordion,value:o,onItemOpen:c,onItemClose:d,children:s.jsx(zF,{scope:e.__scopeAccordion,collapsible:!0,children:s.jsx(VF,W(M({},a),{ref:t}))})})}),[yde,t1]=e1(Uo),VF=Q.forwardRef((e,t)=>{const p=e,{__scopeAccordion:r,disabled:n,dir:i,orientation:a="vertical"}=p,o=me(p,["__scopeAccordion","disabled","dir","orientation"]),l=Q.useRef(null),c=sr(l,t),d=hde(r),h=hf(i)==="ltr",f=mt(e.onKeyDown,x=>{var T;if(!fde.includes(x.key))return;const g=x.target,v=d().filter($=>{var R;return!((R=$.ref.current)!=null&&R.disabled)}),_=v.findIndex($=>$.ref.current===g),w=v.length;if(_===-1)return;x.preventDefault();let b=_;const N=0,S=w-1,k=()=>{b=_+1,b>S&&(b=N)},O=()=>{b=_-1,b<N&&(b=S)};switch(x.key){case"Home":b=N;break;case"End":b=S;break;case"ArrowRight":a==="horizontal"&&(h?k():O());break;case"ArrowDown":a==="vertical"&&k();break;case"ArrowLeft":a==="horizontal"&&(h?O():k());break;case"ArrowUp":a==="vertical"&&O();break}const A=b%w;(T=v[A].ref.current)==null||T.focus()});return s.jsx(yde,{scope:r,disabled:n,direction:i,orientation:a,children:s.jsx(qE.Slot,{scope:r,children:s.jsx(Nt.div,W(M({},o),{"data-orientation":a,ref:c,onKeyDown:n?void 0:f}))})})}),F2="AccordionItem",[_de,HE]=e1(F2),qF=Q.forwardRef((e,t)=>{const h=e,{__scopeAccordion:r,value:n}=h,i=me(h,["__scopeAccordion","value"]),a=t1(F2,r),o=pde(F2,r),l=WE(r),c=_s(),d=n&&o.value.includes(n)||!1,u=a.disabled||e.disabled;return s.jsx(_de,{scope:r,open:d,disabled:u,triggerId:c,children:s.jsx(FF,W(M(M({"data-orientation":a.orientation,"data-state":ZF(d)},l),i),{ref:t,disabled:u,open:d,onOpenChange:f=>{f?o.onItemOpen(n):o.onItemClose(n)}}))})});qF.displayName=F2;var WF="AccordionHeader",HF=Q.forwardRef((e,t)=>{const o=e,{__scopeAccordion:r}=o,n=me(o,["__scopeAccordion"]),i=t1(Uo,r),a=HE(WF,r);return s.jsx(Nt.h3,W(M({"data-orientation":i.orientation,"data-state":ZF(a.open),"data-disabled":a.disabled?"":void 0},n),{ref:t}))});HF.displayName=WF;var X3="AccordionTrigger",GF=Q.forwardRef((e,t)=>{const c=e,{__scopeAccordion:r}=c,n=me(c,["__scopeAccordion"]),i=t1(Uo,r),a=HE(X3,r),o=gde(X3,r),l=WE(r);return s.jsx(qE.ItemSlot,{scope:r,children:s.jsx(ode,W(M(M({"aria-disabled":a.open&&!o.collapsible||void 0,"data-orientation":i.orientation,id:a.triggerId},l),n),{ref:t}))})});GF.displayName=X3;var YF="AccordionContent",KF=Q.forwardRef((e,t)=>{const l=e,{__scopeAccordion:r}=l,n=me(l,["__scopeAccordion"]),i=t1(Uo,r),a=HE(YF,r),o=WE(r);return s.jsx(lde,W(M(M({role:"region","aria-labelledby":a.triggerId,"data-orientation":i.orientation},o),n),{ref:t,style:M({"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)"},e.style)}))});KF.displayName=YF;function ZF(e){return e?"open":"closed"}var wde=UF,bde=qF,jde=HF,XF=GF,JF=KF;const Nde=wde,QF=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(bde,M({ref:r,className:ke("border-b",e)},t))});QF.displayName="AccordionItem";const eU=y.forwardRef((i,n)=>{var a=i,{className:e,children:t}=a,r=me(a,["className","children"]);return s.jsx(jde,{className:"flex",children:s.jsxs(XF,W(M({ref:n,className:ke("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e)},r),{children:[t,s.jsx(Qi,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]}))})});eU.displayName=XF.displayName;const tU=y.forwardRef((i,n)=>{var a=i,{className:e,children:t}=a,r=me(a,["className","children"]);return s.jsx(JF,W(M({ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"},r),{children:s.jsx("div",{className:ke("pb-4 pt-0",e),children:t})}))});tU.displayName=JF.displayName;class Cj{static resolveInternalEventId(t){return E(this,null,function*(){if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t))return t;const{data:n}=yield P.from("events").select("id").eq("jambase_event_id",t).limit(1).single();return(n==null?void 0:n.id)||t})}static getEventComments(t,r=20,n=0){return E(this,null,function*(){const i=yield this.resolveInternalEventId(t),{count:a,error:o}=yield P.from("comments").select("*",{count:"exact",head:!0}).eq("entity_type","event").eq("entity_id",i);if(o&&o.code!=="PGRST205")throw o;const l=a||0,{data:c,error:d}=yield P.from("comments").select("*").eq("entity_type","event").eq("entity_id",i).order("created_at",{ascending:!0}).range(n,n+r-1);if(d){if(d.code==="PGRST205")return console.warn("comments table not found. Did you run the consolidation migration?"),{comments:[],total:0,hasMore:!1};throw d}if(!c||c.length===0)return{comments:[],total:l,hasMore:!1};const u=[...new Set(c.map(v=>v.user_id))],{data:h,error:f}=yield P.from("users").select("id, name, avatar_url, user_id").in("user_id",u);if(f)throw f;const p=new Map;h==null||h.forEach(v=>{p.set(v.user_id,{id:v.id,name:v.name,avatar_url:v.avatar_url||void 0})});const x=c.map(v=>{var _;return{id:v.id,user_id:v.user_id,event_id:v.event_id,parent_comment_id:(_=v.parent_comment_id)!=null?_:null,comment_text:v.comment_text,created_at:v.created_at,updated_at:v.updated_at,user:p.get(v.user_id)||{id:v.user_id,name:"Unknown User"}}}),g=n+c.length<l;return{comments:x,total:l,hasMore:g}})}static addEventComment(t,r,n,i){return E(this,null,function*(){const a=yield this.resolveInternalEventId(r),{data:o,error:l}=yield P.from("comments").insert({user_id:t,entity_type:"event",entity_id:a,comment_text:n,parent_comment_id:i}).select().single();if(l)throw l.code==="PGRST205"?new Error("Event comments are not yet enabled. Please apply the consolidation migration."):l;return o})}}function rU({eventId:e,isOpen:t,onClose:r,currentUserId:n,onCommentAdded:i,onCommentsLoaded:a}){const[o,l]=y.useState([]),[c,d]=y.useState(!1),[u,h]=y.useState(!1),[f,p]=y.useState(""),[x,g]=y.useState(null),[v,_]=y.useState(!1),[w,b]=y.useState(!1);y.useEffect(()=>{t&&e&&N()},[t,e]);const N=()=>E(this,null,function*(){if(e)try{d(!0),g(null);const O=yield Cj.getEventComments(e,20,0);l(O.comments),_(O.hasMore),a&&a(O.comments.length)}catch(O){console.error("Failed to load event comments",O),g("Failed to load comments")}finally{d(!1)}}),S=()=>E(this,null,function*(){if(!(!e||w||!v))try{b(!0);const O=yield Cj.getEventComments(e,20,o.length);l(A=>[...A,...O.comments]),_(O.hasMore)}catch(O){console.error("Failed to load more comments",O),g("Failed to load more comments")}finally{b(!1)}}),k=()=>E(this,null,function*(){if(!(!n||!e||!f.trim()||u))try{h(!0);const O=yield Cj.addEventComment(n,e,f.trim());l(A=>[...A,W(M({},O),{user:{id:O.user_id,name:"You"}})]),p(""),i&&i()}catch(O){console.error("Failed to add comment",O),g("Failed to add comment")}finally{h(!1)}});return s.jsx(tn,{open:t,onOpenChange:O=>!O&&r(),children:s.jsxs(Xr,{className:"sm:max-w-lg",children:[s.jsxs(Mn,{children:[s.jsx(an,{children:"Event Comments"}),s.jsx(Kn,{children:"Discuss this event."})]}),s.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-1",children:[c?s.jsxs("div",{className:"flex items-center justify-center py-8 text-muted-foreground",children:[s.jsx(er,{className:"h-5 w-5 animate-spin mr-2"})," Loading comments..."]}):x?s.jsx("div",{className:"text-sm text-red-600 py-4",children:x}):o.length===0?s.jsx("div",{className:"text-sm text-muted-foreground py-4",children:"No comments yet. Be the first to comment!"}):o.map(O=>s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs(Vr,{className:"h-8 w-8",children:[s.jsx(Qr,{src:O.user.avatar_url||void 0}),s.jsx(qr,{children:(O.user.name||"U").slice(0,2).toUpperCase()})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-sm font-medium text-foreground",children:O.user.name||"User"}),s.jsx("div",{className:"text-sm text-foreground whitespace-pre-wrap",children:O.comment_text}),s.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(O.created_at).toLocaleString()})]})]},O.id)),v&&!c&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(oe,{variant:"outline",size:"sm",onClick:S,disabled:w,className:"text-sm",children:w?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"h-4 w-4 animate-spin mr-2"}),"Loading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Qi,{className:"h-4 w-4 mr-2"}),"Load More Comments"]})})})]}),s.jsx("div",{className:"pt-2 border-t mt-2",children:s.jsxs("div",{className:"flex items-end gap-2",children:[s.jsx(as,{value:f,onChange:O=>p(O.target.value),placeholder:n?"Write a comment":"Sign in to comment",disabled:!n||u,className:"min-h-[72px]"}),s.jsx(oe,{onClick:k,disabled:!n||u||!f.trim(),className:"bg-pink-500 hover:bg-pink-600 text-white",children:u?s.jsx(er,{className:"h-4 w-4 animate-spin"}):s.jsx(cf,{className:"h-4 w-4"})})]})})]})})}function Sde({eventId:e,onClick:t}){const[r,n]=y.useState(0),[i,a]=y.useState(!0);y.useEffect(()=>{o()},[e]);const o=()=>E(this,null,function*(){try{const{data:{user:l}}=yield P.auth.getUser();if(!l){a(!1);return}const{data:c}=yield P.from("friends").select("user1_id, user2_id").or(`user1_id.eq.${l.id},user2_id.eq.${l.id}`);if(!c||c.length===0){a(!1);return}const d=c.map(f=>f.user1_id===l.id?f.user2_id:f.user1_id),{data:u,error:h}=yield P.from("user_event_relationships").select("user_id").eq("event_id",e).eq("relationship_type","interested").in("user_id",d);if(h)throw h;n((u==null?void 0:u.length)||0)}catch(l){console.error("Error loading friends interested:",l)}finally{a(!1)}});return i||r===0?null:s.jsxs(Be,{variant:"secondary",className:"bg-blue-100 text-blue-800 hover:bg-blue-200 cursor-pointer",onClick:t,children:[s.jsx(Ar,{className:"h-3 w-3 mr-1"}),r," friend",r!==1?"s":""," interested"]})}function kde({eventId:e,className:t}){const[r,n]=y.useState(!1),[i,a]=y.useState(!0);y.useEffect(()=>{o()},[e]);const o=()=>E(this,null,function*(){var l;try{const c=new Date;c.setHours(c.getHours()-24);const{count:d,error:u}=yield P.from("interactions").select("id",{count:"exact",head:!0}).eq("entity_type","event").eq("entity_id",e).gte("occurred_at",c.toISOString());if(u){if(u.code==="PGRST205"||(l=u.message)!=null&&l.includes("does not exist"))return;throw u}n((d||0)>=20)}catch(c){console.debug("Trending status check failed (non-critical):",c)}finally{a(!1)}});return i||!r?null:s.jsxs(Be,{variant:"default",className:`bg-gradient-to-r from-orange-500 to-pink-500 ${t}`,children:[s.jsx($J,{className:"h-3 w-3 mr-1 fill-current"}),"Trending"]})}function Ede({interestedCount:e,attendanceCount:t,className:r}){const i=(()=>{const o=e+(t||0);return o>=100?{tier:"mega",label:"Mega Popular",icon:zu,className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white"}:o>=50?{tier:"very",label:"Very Popular",icon:oa,className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white"}:o>=20?{tier:"popular",label:"Popular",icon:Jt,className:"bg-blue-100 text-blue-800"}:null})();if(!i)return null;const a=i.icon;return s.jsxs(Be,{className:`${i.className} ${r}`,children:[s.jsx(a,{className:"h-3 w-3 mr-1 fill-current"}),i.label]})}class Pj{static recordSwipe(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield P.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{error:i}=yield P.from("engagements").insert({user_id:r.id,entity_type:"user",entity_id:t.swiped_user_id,engagement_type:"swipe",engagement_value:t.is_interested?"right":"left",metadata:{event_id:t.event_id,swiped_user_id:t.swiped_user_id,is_interested:t.is_interested}});if(i)throw i;t.is_interested&&(yield this.checkForMatch(r.id,t.swiped_user_id,t.event_id))}catch(r){throw console.error("Error recording swipe:",r),r}})}static checkForMatch(t,r,n){return E(this,null,function*(){var i,a;try{const{data:o}=yield P.from("engagements").select("*").eq("user_id",r).eq("entity_type","user").eq("entity_id",t).eq("engagement_type","swipe").eq("engagement_value","right").eq("metadata->>event_id",n).single();if(o){yield P.from("user_relationships").insert([{user_id:t,related_user_id:r,relationship_type:"match",status:"accepted",metadata:{event_id:n,matched_user_id:r}},{user_id:r,related_user_id:t,relationship_type:"match",status:"accepted",metadata:{event_id:n,matched_user_id:t}}]);const{data:l}=yield P.from("events_with_artist_venue").select("title, artist_name_normalized").eq("id",n).single(),[c,d]=yield Promise.all([P.from("users").select("name").eq("user_id",t).single(),P.from("users").select("name").eq("user_id",r).single()]),u=((i=c.data)==null?void 0:i.name)||"Someone",h=((a=d.data)==null?void 0:a.name)||"Someone",f=(l==null?void 0:l.title)||"an event",p=[{user_id:t,type:"match",title:" It's a Match!",message:`You and ${h} both want to meet up at ${f}!`,data:{match_user_id:r,match_user_name:h,event_id:n,event_title:f,event_artist:l==null?void 0:l.artist_name_normalized},actor_user_id:r},{user_id:r,type:"match",title:" It's a Match!",message:`You and ${u} both want to meet up at ${f}!`,data:{match_user_id:t,match_user_name:u,event_id:n,event_title:f,event_artist:l==null?void 0:l.artist_name_normalized},actor_user_id:t}];yield P.from("notifications").insert(p),yield this.createMatchChat(t,r,n)}}catch(o){console.error("Error checking for match:",o)}})}static getPotentialMatches(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield P.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:i,error:a}=yield P.from("user_event_relationships").select("user_id").eq("event_id",t).in("relationship_type",["interested","going","maybe"]).neq("user_id",r.id);if(a)throw a;if(!i||i.length===0)return[];const o=i.map(u=>u.user_id),{data:l,error:c}=yield P.from("users").select(`
          user_id,
          name,
          avatar_url,
          bio,
          music_streaming_profile,
          gender,
          birthday,
          instagram_handle
        `).in("user_id",o);if(c)throw c;return(yield Promise.all((l||[]).map(u=>E(this,null,function*(){if(!u)return null;const{data:h}=yield P.from("engagements").select("id").eq("user_id",r.id).eq("entity_type","user").eq("entity_id",u.user_id).eq("engagement_type","swipe").eq("metadata->>event_id",t).single();if(h)return null;const{data:f}=yield P.rpc("is_user_blocked",{p_user_id:u.user_id,p_by_user_id:r.id});if(f)return null;const p=yield this.calculateCompatibility(r.id,u.user_id),x=yield this.getSharedPreferences(r.id,u.user_id);return{user_id:u.user_id,name:u.name,avatar_url:u.avatar_url,bio:u.bio,gender:u.gender,birthday:u.birthday,instagram_handle:u.instagram_handle,compatibility_score:p,shared_artists:x.artists,shared_genres:x.genres,music_streaming_profile:u.music_streaming_profile}})))).filter(u=>u!==null)}catch(r){throw console.error("Error getting potential matches:",r),r}})}static calculateCompatibility(t,r){return E(this,null,function*(){var n,i;try{const[a,o]=yield Promise.all([P.from("user_preferences").select("music_preference_signals").eq("user_id",t).single(),P.from("user_preferences").select("music_preference_signals").eq("user_id",r).single()]),l=((n=a.data)==null?void 0:n.music_preference_signals)||[],c=((i=o.data)==null?void 0:i.music_preference_signals)||[];if(!l.length||!c.length)return 50;const d=l.filter(v=>v.preference_type==="artist").map(v=>v.preference_value.toLowerCase()),u=l.filter(v=>v.preference_type==="genre").map(v=>v.preference_value.toLowerCase()),h=c.filter(v=>v.preference_type==="artist").map(v=>v.preference_value.toLowerCase()),f=c.filter(v=>v.preference_type==="genre").map(v=>v.preference_value.toLowerCase()),p=this.calculateOverlap(d,h),x=this.calculateOverlap(u,f),g=p*.6+x*.4;return Math.round(Math.min(100,Math.max(0,g*100)))}catch(a){return console.error("Error calculating compatibility:",a),50}})}static calculateOverlap(t,r){if(!(t!=null&&t.length)||!(r!=null&&r.length))return 0;const n=new Set(t),i=new Set(r);return[...n].filter(o=>i.has(o)).length/Math.max(n.size,i.size)}static getSharedPreferences(t,r){return E(this,null,function*(){var n,i;try{const[a,o]=yield Promise.all([P.from("user_preferences").select("music_preference_signals").eq("user_id",t).single(),P.from("user_preferences").select("music_preference_signals").eq("user_id",r).single()]),l=((n=a.data)==null?void 0:n.music_preference_signals)||[],c=((i=o.data)==null?void 0:i.music_preference_signals)||[];if(!l.length||!c.length)return{artists:[],genres:[]};const d=l.filter(g=>g.preference_type==="artist").map(g=>g.preference_value),u=l.filter(g=>g.preference_type==="genre").map(g=>g.preference_value),h=c.filter(g=>g.preference_type==="artist").map(g=>g.preference_value),f=c.filter(g=>g.preference_type==="genre").map(g=>g.preference_value),p=d.filter(g=>h.some(v=>v.toLowerCase()===g.toLowerCase())),x=u.filter(g=>f.some(v=>v.toLowerCase()===g.toLowerCase()));return{artists:p.slice(0,5),genres:x.slice(0,3)}}catch(a){return console.error("Error getting shared preferences:",a),{artists:[],genres:[]}}})}static createMatchChat(t,r,n){return E(this,null,function*(){try{const{data:i,error:a}=yield P.from("chat_participants").select("chat_id").eq("user_id",t);if(a)throw new Error(`Failed to check existing chats for user1: ${a.message}`);const{data:o,error:l}=yield P.from("chat_participants").select("chat_id").eq("user_id",r);if(l)throw new Error(`Failed to check existing chats for user2: ${l.message}`);const c=new Set((i==null?void 0:i.map(_=>_.chat_id))||[]),d=new Set((o==null?void 0:o.map(_=>_.chat_id))||[]),u=[...c].filter(_=>d.has(_));if(u.length>0){const{data:_,error:w}=yield P.from("chats").select("id").in("id",u).eq("is_group_chat",!1).limit(1);if(w)console.error("Error checking for existing direct chat:",w);else if(_&&_.length>0)return}const{data:h}=yield P.from("events_with_artist_venue").select("title, artist_name_normalized").eq("id",n).single(),f=(h==null?void 0:h.title)||"Concert Chat",{data:p,error:x}=yield P.from("chats").insert({chat_name:f,is_group_chat:!1}).select().single();if(x||!p)throw new Error(`Failed to create chat: ${(x==null?void 0:x.message)||"Unknown error"}`);const{error:g}=yield P.from("chat_participants").insert([{chat_id:p.id,user_id:t},{chat_id:p.id,user_id:r}]);if(g){const{error:_}=yield P.from("chats").delete().eq("id",p.id);throw _?(console.error(`CRITICAL: Failed to cleanup orphaned chat ${p.id} after participant insert failure. Original error: ${g.message}. Cleanup error: ${_.message}`),new Error(`Failed to add participants to chat: ${g.message}. CRITICAL: Cleanup also failed - orphaned chat ${p.id} may exist: ${_.message}`)):new Error(`Failed to add participants to chat: ${g.message}`)}const{error:v}=yield P.from("messages").insert({chat_id:p.id,sender_id:t,content:` You matched! Start chatting about ${(h==null?void 0:h.title)||"the event"}!`});v&&console.warn("Failed to send welcome message, but chat was created successfully:",v)}catch(i){console.error("Error creating match chat:",i)}})}static getEventMatches(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield P.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:i,error:a}=yield P.from("user_relationships").select("*").eq("relationship_type","match").eq("user_id",r.id).eq("metadata->>event_id",t);if(a)throw a;return yield Promise.all((i||[]).map(l=>E(this,null,function*(){var f;const c=l.related_user_id,d=(f=l.metadata)==null?void 0:f.event_id,[u,h]=yield Promise.all([P.from("users").select("user_id, name, avatar_url, bio").eq("user_id",c).single(),d?P.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date").eq("id",d).single():Promise.resolve({data:null})]);return W(M({},l),{user1_id:l.user_id,user2_id:l.related_user_id,event_id:d||t,matched_user:u.data,event:h.data})})))}catch(r){throw console.error("Error getting event matches:",r),r}})}static getAllMatches(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield P.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{data:n,error:i}=yield P.from("user_relationships").select("*").eq("relationship_type","match").eq("user_id",t.id).order("created_at",{ascending:!1});if(i)throw i;return yield Promise.all((n||[]).map(o=>E(this,null,function*(){var h;const l=o.related_user_id,c=(h=o.metadata)==null?void 0:h.event_id,[d,u]=yield Promise.all([P.from("users").select("user_id, name, avatar_url, bio, music_streaming_profile").eq("user_id",l).single(),c?P.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date, images").eq("id",c).single():Promise.resolve({data:null})]);return W(M({},o),{user1_id:o.user_id,user2_id:o.related_user_id,event_id:c||"",matched_user:d.data,event:u.data})})))}catch(t){throw console.error("Error getting all matches:",t),t}})}static hasSwipedOn(t,r){return E(this,null,function*(){try{const{data:{user:n},error:i}=yield P.auth.getUser();if(i||!n)throw new Error("User not authenticated");const{data:a}=yield P.from("engagements").select("id").eq("user_id",n.id).eq("entity_type","user").eq("entity_id",r).eq("engagement_type","swipe").eq("metadata->>event_id",t).single();return!!a}catch(n){return!1}})}static getMatchCount(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield P.auth.getUser();if(r||!t)return 0;const{count:n,error:i}=yield P.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","match").eq("user_id",t.id);if(i)throw i;return n||0}catch(t){return console.error("Error getting match count:",t),0}})}static getNotifications(t=20){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield P.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:i,error:a}=yield P.from("notifications").select(`
          *,
          actor_profile:actor_user_id (
            name,
            avatar_url
          )
        `).eq("user_id",r.id).order("created_at",{ascending:!1}).limit(t);if(a)throw a;return i||[]}catch(r){throw console.error("Error getting notifications:",r),r}})}static markNotificationRead(t){return E(this,null,function*(){try{const{error:r}=yield P.from("notifications").update({is_read:!0}).eq("id",t);if(r)throw r}catch(r){throw console.error("Error marking notification as read:",r),r}})}static getUnreadNotificationCount(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield P.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{count:n,error:i}=yield P.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",t.id).eq("is_read",!1);if(i)throw i;return n||0}catch(t){return console.error("Error getting unread notification count:",t),0}})}static getChats(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield P.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{data:n,error:i}=yield P.from("chat_participants").select("chat_id").eq("user_id",t.id);if(i)throw i;const a=(n==null?void 0:n.map(c=>c.chat_id))||[];if(a.length===0)return[];const{data:o,error:l}=yield P.from("chats").select(`
          *,
          messages (
            id,
            message,
            sender_id,
            created_at
          )
        `).in("id",a).order("updated_at",{ascending:!1});if(l)throw l;if(o&&o.length>0){const c=o.map(h=>h.id),{data:d}=yield P.from("chat_participants").select("chat_id, user_id").in("chat_id",c),u=new Map;return d==null||d.forEach(h=>{const f=u.get(h.chat_id)||[];f.push(h.user_id),u.set(h.chat_id,f)}),o.map(h=>W(M({},h),{users:u.get(h.id)||[]}))}return[]}catch(t){throw console.error("Error getting chats:",t),t}})}static sendMessage(t,r){return E(this,null,function*(){try{const{data:{user:n},error:i}=yield P.auth.getUser();if(i||!n)throw new Error("User not authenticated");const{error:a}=yield P.from("messages").insert({chat_id:t,sender_id:n.id,content:r});if(a)throw a;yield P.from("chats").update({updated_at:new Date().toISOString()}).eq("id",t)}catch(n){throw console.error("Error sending message:",n),n}})}}class U2{static requestPermission(){return E(this,null,function*(){if(!this.isSupported)return console.log("Push notifications not supported"),!1;try{return this.permission=yield Notification.requestPermission(),this.permission==="granted"}catch(t){return console.error("Error requesting notification permission:",t),!1}})}static isEnabled(){return this.isSupported&&this.permission==="granted"}static showMatchNotification(t){if(!this.isEnabled())return;const r=new Notification(" It's a Match!",{body:`You and ${t.userName} both want to meet up at ${t.eventTitle}!`,icon:"/favicon.png",badge:"/favicon.png",tag:"match-notification",requireInteraction:!0,actions:[{action:"view",title:"View Match"},{action:"chat",title:"Start Chat"}]});r.onclick=()=>{window.focus(),window.location.href="/matches",r.close()}}static showMessageNotification(t){if(!this.isEnabled())return;const r=new Notification(`Message from ${t.senderName}`,{body:t.message,icon:"/favicon.png",badge:"/favicon.png",tag:`message-${t.chatId}`,requireInteraction:!1});r.onclick=()=>{window.focus(),window.location.href=`/chat/${t.chatId}`,r.close()}}static initialize(){return E(this,null,function*(){this.isSupported&&(this.permission=Notification.permission,this.permission==="default"&&console.log("Notification permission not set. Consider showing a UI prompt."))})}static subscribeToServiceWorker(){return E(this,null,function*(){if("serviceWorker"in navigator)try{const t=yield navigator.serviceWorker.register("/sw.js");console.log("Service Worker registered:",t)}catch(t){console.error("Service Worker registration failed:",t)}})}}_r(U2,"isSupported","Notification"in window),_r(U2,"permission","default");typeof window!="undefined"&&U2.initialize();function Cde({eventId:e,eventTitle:t,interestedCount:r,onMatchCreated:n,onNavigateToProfile:i}){const{toast:a}=jr(),[o,l]=y.useState([]),[c,d]=y.useState(0),[u,h]=y.useState(!0),[f,p]=y.useState(!1),[x,g]=y.useState(null);y.useEffect(()=>{v()},[e]);const v=()=>E(this,null,function*(){h(!0);try{const b=yield Pj.getPotentialMatches(e);l(b),d(0)}catch(b){console.error("Error loading potential matches:",b),a({title:"Error",description:"Failed to load potential concert buddies",variant:"destructive"})}finally{h(!1)}}),_=b=>E(this,null,function*(){const N=o[c];if(!(!N||f)){p(!0),g(b?"right":"left");try{yield Pj.recordSwipe({event_id:e,swiped_user_id:N.user_id,is_interested:b}),b&&((yield Pj.getEventMatches(e)).find(O=>O.user1_id===N.user_id||O.user2_id===N.user_id)?(a({title:" It's a Match!",description:`You and ${N.name} both want to meet up!`}),U2.showMatchNotification({userName:N.name,eventTitle:t}),n&&n(N)):a({title:" Sent!",description:`If ${N.name} swipes right too, you'll match!`})),setTimeout(()=>{d(S=>S+1),g(null),p(!1)},300)}catch(S){console.error("Error swiping:",S),a({title:"Error",description:"Failed to record swipe",variant:"destructive"}),g(null),p(!1)}}});if(u)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(er,{className:"h-8 w-8 animate-spin text-purple-600"})});if(o.length===0)return s.jsx(He,{children:s.jsxs(st,{className:"py-12 text-center",children:[s.jsx(hs,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),r===0?s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No One Going Yet"}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Be the first to show interest in this event! Share it with friends to meet people going."})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"All Caught Up!"}),s.jsx("p",{className:"text-gray-600 text-sm",children:"You've swiped through everyone going to this event. Check back later for new people!"})]})]})});if(c>=o.length)return s.jsx(He,{children:s.jsxs(st,{className:"py-12 text-center",children:[s.jsx(oa,{className:"h-16 w-16 text-purple-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"All Done!"}),s.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"You've reviewed all people going to this event"}),s.jsx(oe,{onClick:v,variant:"outline",children:"Check for New People"})]})});const w=o[c];return s.jsxs("div",{className:"max-w-md mx-auto",children:[s.jsxs("div",{className:"mb-4 flex items-center justify-between text-sm text-gray-600",children:[s.jsxs("span",{children:[c+1," of ",o.length]}),s.jsxs("span",{className:"text-purple-600 font-medium",children:["Meet People Going to ",t]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(He,{className:`transition-all duration-300 cursor-pointer hover:shadow-lg ${x==="left"?"translate-x-[-100%] opacity-0":x==="right"?"translate-x-[100%] opacity-0":""}`,onClick:b=>{b.stopPropagation(),i&&i(w.user_id)},children:s.jsxs(st,{className:"p-0",children:[s.jsx("div",{className:"relative h-96 bg-gradient-to-br from-purple-100 to-pink-100 rounded-t-lg",children:w.avatar_url?s.jsx("img",{src:w.avatar_url,alt:w.name,className:"w-full h-full object-cover rounded-t-lg"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx("span",{className:"text-8xl font-bold text-purple-300",children:w.name.charAt(0).toUpperCase()})})}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-1",children:w.name}),w.bio&&s.jsx("p",{className:"text-gray-700 text-sm",children:w.bio})]}),w.music_streaming_profile&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Ct,{className:"h-4 w-4"}),s.jsx("span",{children:"Has Spotify connected"})]}),w.shared_artists&&w.shared_artists.length>0&&s.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-sm font-medium text-purple-900 mb-2",children:"Shared Artists"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:w.shared_artists.slice(0,5).map((b,N)=>s.jsx(Be,{variant:"outline",className:"text-xs",children:b},N))})]}),(w.gender||w.birthday||w.instagram_handle)&&s.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Profile Highlights"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.gender&&s.jsx(Be,{variant:"outline",className:"text-xs",children:w.gender}),w.birthday&&(()=>{const b=new Date().getFullYear()-new Date(w.birthday).getFullYear();return s.jsxs(Be,{variant:"outline",className:"text-xs",children:[b," years old"]})})(),w.instagram_handle&&s.jsxs(Be,{variant:"outline",className:"text-xs",children:["@",w.instagram_handle]})]})]}),w.compatibility_score!==void 0&&s.jsx("div",{className:"text-center pt-2",children:s.jsx("p",{className:"text-xs text-gray-500",children:"Based on music taste and preferences"})})]})]})}),s.jsxs("div",{className:"flex items-center justify-center gap-8 mt-6",children:[s.jsx(oe,{size:"lg",variant:"outline",onClick:()=>_(!1),disabled:f,className:"w-20 h-20 rounded-full border-2 border-red-300 hover:bg-red-50 hover:border-red-400",children:s.jsx(pr,{className:"h-10 w-10 text-red-500"})}),s.jsx(oe,{size:"lg",variant:"default",onClick:()=>_(!0),disabled:f,className:"w-24 h-24 rounded-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 shadow-lg",children:s.jsx(hs,{className:"h-12 w-12 fill-current"})})]}),s.jsxs("div",{className:"mt-6 text-center text-sm text-gray-600",children:[s.jsx("p",{children:"Swipe right if you'd like to meet up at this event"}),s.jsx("p",{className:"text-xs mt-1",children:"If they swipe right too, you'll match and can chat!"})]})]})]})}const Hp={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"},Pde={sm:"text-xs",md:"text-sm",lg:"text-base",xl:"text-lg"},wg=({size:e="md",variant:t="spinner",text:r,fullPage:n=!1,inline:i=!1,className:a,background:o="blur"})=>{const l=()=>{switch(t){case"spinner":return s.jsx("div",{className:ke("relative",Hp[e],"animate-spin rounded-full border-4 border-synth-pink/20","border-t-synth-pink border-r-synth-pink"),children:s.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-transparent border-t-synth-pink/40 animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})});case"pulse":return s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:ke("rounded-full bg-gradient-to-br from-synth-pink to-synth-pink-light","animate-pulse",Hp[e]),style:{boxShadow:"0 0 20px rgba(255, 51, 153, 0.4)"}}),s.jsx("div",{className:ke("absolute inset-0 rounded-full bg-gradient-to-br from-synth-pink to-synth-pink-light","animate-ping opacity-75",Hp[e])})]});case"dots":return s.jsx("div",{className:"flex items-center gap-2",children:[0,1,2].map(d=>s.jsx("div",{className:ke("rounded-full bg-synth-pink",e==="sm"?"w-1.5 h-1.5":e==="md"?"w-2 h-2":e==="lg"?"w-3 h-3":"w-4 h-4","animate-bounce"),style:{animationDelay:`${d*.15}s`,animationDuration:"0.6s"}},d))});case"logo":return s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:ke("flex items-center justify-center","rounded-full bg-gradient-to-br from-synth-pink/20 to-synth-pink-light/20","backdrop-blur-sm border-2 border-synth-pink/30",Hp[e]),children:s.jsx(Ct,{className:ke("text-synth-pink animate-pulse",e==="sm"?"w-2 h-2":e==="md"?"w-4 h-4":e==="lg"?"w-6 h-6":"w-8 h-8")})}),s.jsx("div",{className:ke("absolute inset-0 rounded-full border-2 border-synth-pink/40","animate-ping",Hp[e])})]});default:return null}},c=s.jsxs("div",{className:ke("flex flex-col items-center justify-center gap-3",a),children:[l(),r&&s.jsx("p",{className:ke("text-muted-foreground font-medium animate-pulse",Pde[e]),children:r})]});return n?s.jsx("div",{className:ke("fixed inset-0 z-50 flex items-center justify-center",o==="blur"&&"bg-background/80 backdrop-blur-sm",o==="solid"&&"bg-background",o==="transparent"&&"bg-transparent"),children:s.jsx("div",{className:"text-center space-y-6",children:c})}):i?s.jsx("div",{className:ke("flex items-center justify-center py-8",a),children:c}):c},GE=({text:e="Loading...",showLogo:t=!1})=>s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-white via-synth-beige/30 to-white",children:s.jsxs("div",{className:"text-center space-y-6 px-4",children:[t&&s.jsx("div",{className:"w-32 h-32 mx-auto mb-4",children:s.jsxs("div",{className:"relative w-full h-full",children:[s.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-synth-pink/20 to-synth-pink-light/20 animate-pulse"}),s.jsx("div",{className:"absolute inset-2 rounded-full bg-gradient-to-br from-synth-pink to-synth-pink-light flex items-center justify-center",children:s.jsx(Ct,{className:"w-16 h-16 text-white"})}),s.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-synth-pink/40 animate-ping"})]})}),s.jsx(wg,{variant:"spinner",size:"lg",text:e})]})}),yd=({text:e,size:t="md",variant:r="spinner"})=>s.jsx(wg,{variant:r,size:t,text:e,inline:!0});class Ade{static uploadPhoto(t){return E(this,null,function*(){throw new Error("Photo uploads are handled through reviews. Please add photos when creating or editing a review.")})}static getEventPhotos(t,r=20,n=0){return E(this,null,function*(){try{const{data:{user:i}}=yield P.auth.getUser(),{data:a,error:o}=yield P.from("event_media").select(`
          id,
          url,
          review_id,
          created_at,
          review:reviews!event_media_review_id_fkey (
            user_id,
            user:users!reviews_user_id_fkey (
              name,
              avatar_url
            )
          )
        `).eq("event_id",t).eq("media_type","photo").order("created_at",{ascending:!1}).range(n,n+r-1);return o?(console.warn("Error getting event photos from event_media:",o),[]):(a||[]).map(c=>{const d=c.review,u=d==null?void 0:d.user;return{id:c.id,event_id:t,photo_url:c.url,caption:void 0,likes_count:0,comments_count:0,is_featured:!1,user_id:(d==null?void 0:d.user_id)||"",user_name:(u==null?void 0:u.name)||"Unknown",user_avatar_url:(u==null?void 0:u.avatar_url)||null,user_has_liked:!1,created_at:c.created_at}})}catch(i){return console.error("Error getting event photos:",i),[]}})}static togglePhotoLike(t,r){return E(this,null,function*(){console.warn("Photo likes not supported - photos are part of reviews")})}static addComment(t,r){return E(this,null,function*(){throw new Error("Photo comments not supported - photos are part of reviews. Please comment on the review instead.")})}static getPhotoComments(t){return E(this,null,function*(){return[]})}static deletePhoto(t){return E(this,null,function*(){throw new Error("Photos are part of reviews. Please edit the review to remove photos.")})}static updateCaption(t,r){return E(this,null,function*(){throw new Error("Photo captions not supported - photos are part of reviews.")})}static getUserPhotos(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield P.auth.getUser();if(n||!r)throw new Error("User not authenticated");const i=t||r.id,{data:a,error:o}=yield P.from("reviews").select("id").eq("user_id",i).eq("is_public",!0).eq("is_draft",!1);if(o||!a||a.length===0)return[];const l=a.map(h=>h.id),{data:c,error:d}=yield P.from("event_media").select(`
          id,
          url,
          review_id,
          event_id,
          created_at,
          review:reviews!event_media_review_id_fkey (
            user:users!reviews_user_id_fkey (
              name,
              avatar_url
            )
          ),
          event:events (
            id,
            title,
            artist_name,
            event_date
          )
        `).in("review_id",l).eq("media_type","photo").order("created_at",{ascending:!1});return d?(console.warn("Error getting user photos from event_media:",d),[]):(c||[]).map(h=>{const f=h.review,p=f==null?void 0:f.user;return{id:h.id,event_id:h.event_id||"",photo_url:h.url,caption:void 0,likes_count:0,comments_count:0,is_featured:!1,user_id:(f==null?void 0:f.user_id)||i,user_name:(p==null?void 0:p.name)||"Unknown",user_avatar_url:(p==null?void 0:p.avatar_url)||null,user_has_liked:!1,created_at:h.created_at}})}catch(r){return console.error("Error getting user photos:",r),[]}})}static toggleFeatured(t,r){return E(this,null,function*(){throw new Error("Photo featuring not supported - photos are part of reviews.")})}}function Tde({eventId:e,eventTitle:t,canUpload:r=!0}){const{user:n}=os(),{toast:i}=jr(),[a,o]=y.useState([]),[l,c]=y.useState(!0);y.useEffect(()=>{d()},[e]);const d=()=>E(this,null,function*(){c(!0);try{const p=yield Ade.getEventPhotos(e,50);o(p)}catch(p){console.error("Error loading photos:",p),o([])}finally{c(!1)}}),u=p=>E(this,null,function*(){i({title:"Info",description:"Photos are part of reviews. Like the review instead."})}),h=p=>E(this,null,function*(){i({title:"Info",description:"Photos are part of reviews. Please edit the review to remove photos."})}),f=({photo:p})=>s.jsxs(He,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:p.photo_url,alt:p.caption||"Event photo",className:"w-full aspect-square object-cover cursor-pointer",onClick:()=>{}}),p.is_featured&&s.jsx(Be,{className:"absolute top-2 right-2 bg-yellow-500",children:" Featured"})]}),s.jsxs(st,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p.user_avatar_url?s.jsx("img",{src:p.user_avatar_url,alt:p.user_name,className:"w-8 h-8 rounded-full"}):s.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center",children:s.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:p.user_name.charAt(0)})}),s.jsx("span",{className:"font-medium text-sm",children:p.user_name})]}),p.caption&&s.jsx("p",{className:"text-sm text-gray-700 mb-3",children:p.caption}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>u(),className:p.user_has_liked?"text-red-500":"text-gray-600",children:[s.jsx(hs,{className:`h-4 w-4 mr-1 ${p.user_has_liked?"fill-current":""}`}),p.likes_count]}),s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>{i({title:"Info",description:"Photos are part of reviews. Comment on the review instead."})},className:"text-gray-600",children:[s.jsx(Wn,{className:"h-4 w-4 mr-1"}),p.comments_count]}),(n==null?void 0:n.id)===p.user_id&&s.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>h(),className:"text-gray-600 hover:text-red-600 ml-auto",children:s.jsx(yc,{className:"h-4 w-4"})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(p.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})})]})]});return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold",children:"Event Photos"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[a.length," photo",a.length!==1?"s":""]})]}),r&&s.jsxs(oe,{onClick:()=>{i({title:"Info",description:"Photos are added through reviews. Please create or edit a review to add photos."})},size:"sm",children:[s.jsx(_3,{className:"h-4 w-4 mr-2"}),"Upload Photo"]})]}),l?s.jsx(yd,{text:"Loading photos...",size:"lg"}):a.length===0?s.jsx(He,{children:s.jsxs(st,{className:"py-12 text-center",children:[s.jsx(y2,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),s.jsx("h4",{className:"text-lg font-semibold mb-2",children:"No Photos Yet"}),s.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Be the first to share a photo from this event!"}),r&&s.jsxs(oe,{onClick:()=>{i({title:"Info",description:"Photos are added through reviews. Please create or edit a review to add photos."})},children:[s.jsx(_3,{className:"h-4 w-4 mr-2"}),"Upload First Photo"]})]})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(p=>s.jsx(f,{photo:p},p.id))})]})}class Ode{static createGroup(t){return E(this,null,function*(){var r;try{const{data:n,error:i}=yield P.rpc("create_event_group",{p_event_id:t.event_id,p_name:t.name,p_description:t.description||null,p_is_public:(r=t.is_public)!=null?r:!0,p_max_members:t.max_members||null});if(i)throw i;return n}catch(n){throw console.error("Error creating group:",n),n}})}static getEventGroups(t){return E(this,null,function*(){return[]})}static joinGroup(t){return E(this,null,function*(){try{const{error:r}=yield P.rpc("join_event_group",{p_group_id:t});if(r)throw r}catch(r){throw console.error("Error joining group:",r),r}})}static leaveGroup(t){return E(this,null,function*(){try{const{error:r}=yield P.rpc("leave_event_group",{p_group_id:t});if(r)throw r}catch(r){throw console.error("Error leaving group:",r),r}})}static getGroupMembers(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("event_group_members").select(`
          *,
          user:users!event_group_members_user_id_fkey (
            user_id,
            name,
            avatar_url,
            bio
          )
        `).eq("group_id",t).order("joined_at",{ascending:!0});if(n)throw n;return r||[]}catch(r){throw console.error("Error getting group members:",r),r}})}static getUserGroups(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield P.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{data:n,error:i}=yield P.from("event_group_members").select(`
          group:event_groups (
            *,
            event:events (
              id,
              title,
              artist_name,
              event_date,
              poster_image_url
            ),
            creator:users!event_groups_created_by_user_id_fkey (
              name,
              avatar_url
            )
          )
        `).eq("user_id",t.id).order("joined_at",{ascending:!1});if(i)throw i;return(n||[]).map(a=>a.group).filter(Boolean)}catch(t){throw console.error("Error getting user groups:",t),t}})}static updateGroup(t,r){return E(this,null,function*(){try{const{error:n}=yield P.from("event_groups").update(W(M({},r),{updated_at:new Date().toISOString()})).eq("id",t);if(n)throw n}catch(n){throw console.error("Error updating group:",n),n}})}static deleteGroup(t){return E(this,null,function*(){try{const{error:r}=yield P.from("event_groups").delete().eq("id",t);if(r)throw r}catch(r){throw console.error("Error deleting group:",r),r}})}static isMember(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield P.auth.getUser();if(n||!r)return!1;const{data:i}=yield P.from("event_group_members").select("id").eq("group_id",t).eq("user_id",r.id).single();return!!i}catch(r){return!1}})}static getGroup(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("event_groups").select(`
          *,
          event:jambase_events (
            id,
            title,
            artist_name,
            venue_name,
            event_date,
            poster_image_url
          ),
          creator:profiles!event_groups_created_by_user_id_fkey (
            name,
            avatar_url
          )
        `).eq("id",t).single();if(n)throw n;return r}catch(r){throw console.error("Error getting group:",r),r}})}}function Rde({open:e,onClose:t,event:r,onGroupCreated:n}){const{toast:i}=jr(),[a,o]=y.useState(!1),[l,c]=y.useState({name:"",description:"",is_public:!0,max_members:""}),d=p=>{const{name:x,value:g}=p.target;c(v=>W(M({},v),{[x]:g}))},u=p=>E(this,null,function*(){if(p.preventDefault(),!l.name.trim()){i({title:"Group name required",description:"Please enter a name for your group",variant:"destructive"});return}o(!0);try{const x=yield Ode.createGroup({event_id:r.id,name:l.name.trim(),description:l.description.trim()||void 0,is_public:l.is_public,max_members:l.max_members?parseInt(l.max_members):void 0});i({title:"Group Created! ",description:`${l.name} is ready for members`}),n==null||n(x),h()}catch(x){console.error("Error creating group:",x),i({title:"Error",description:x instanceof Error?x.message:"Failed to create group",variant:"destructive"})}finally{o(!1)}}),h=()=>{a||(c({name:"",description:"",is_public:!0,max_members:""}),t())},f=p=>new Date(p).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"});return s.jsx(tn,{open:e,onOpenChange:h,children:s.jsxs(Xr,{className:"sm:max-w-[550px]",children:[s.jsxs(Mn,{children:[s.jsxs(an,{className:"flex items-center gap-2",children:[s.jsx(Ar,{className:"h-5 w-5 text-purple-600"}),"Create Event Group"]}),s.jsx(Kn,{children:"Start a community for this event. Chat, share plans, and meet up!"})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[s.jsx("p",{className:"font-semibold text-sm mb-1",children:r.title}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-700",children:[s.jsx(Et,{className:"h-3 w-3"}),s.jsx("span",{children:f(r.event_date)})]})]}),s.jsxs("form",{onSubmit:u,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ut,{htmlFor:"name",children:["Group Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(or,{id:"name",name:"name",placeholder:"e.g., Taylor Swift Squad, VIP Section Crew",value:l.name,onChange:d,disabled:a,maxLength:50})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"description",children:"Description (Optional)"}),s.jsx(as,{id:"description",name:"description",placeholder:"What's this group about?",value:l.description,onChange:d,disabled:a,rows:3,maxLength:200})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(Ut,{children:"Privacy"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-start p-3 border rounded-lg cursor-pointer",children:[s.jsx("input",{type:"radio",name:"privacy",checked:l.is_public,onChange:()=>c(p=>W(M({},p),{is_public:!0})),disabled:a,className:"mt-0.5 mr-3"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(No,{className:"h-4 w-4 text-green-600"}),s.jsx("span",{className:"font-medium text-sm",children:"Public"})]}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Anyone can find and join this group"})]})]}),s.jsxs("label",{className:"flex items-start p-3 border rounded-lg cursor-pointer",children:[s.jsx("input",{type:"radio",name:"privacy",checked:!l.is_public,onChange:()=>c(p=>W(M({},p),{is_public:!1})),disabled:a,className:"mt-0.5 mr-3"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(og,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{className:"font-medium text-sm",children:"Private"})]}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Only you can invite members"})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"max_members",children:"Max Members (Optional)"}),s.jsx(or,{id:"max_members",name:"max_members",type:"number",placeholder:"Leave blank for unlimited",value:l.max_members,onChange:d,disabled:a,min:"2",max:"100"})]}),s.jsxs(ff,{children:[s.jsx(oe,{type:"button",variant:"outline",onClick:h,disabled:a,children:"Cancel"}),s.jsx(oe,{type:"submit",disabled:a||!l.name.trim(),children:a?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ar,{className:"w-4 h-4 mr-2"}),"Create Group"]})})]})]})]})})}class Th{static isUserVisible(t,r,n=!1){if(t.user_id===r||n)return!0;const i=t.avatar_url&&t.avatar_url.trim()!=="",a=t.is_public_profile===!0;return i&&a}static filterVisibleUsers(t,r,n=[]){return t.filter(i=>{const a=n.includes(i.user_id);return this.isUserVisible(i,r,a)})}static isVisibleInSearch(t,r,n=!1){return t.user_id===r,!0}static isVisibleForMatching(t,r,n=!1){if(t.user_id===r||n)return!0;const i=t.avatar_url&&t.avatar_url.trim()!=="",a=t.is_public_profile===!0;return i&&a}static formatLastActive(t){if(!t)return"Recently";try{const r=typeof t=="string"?new Date(t):t,i=new Date().getTime()-r.getTime(),a=Math.floor(i/(1e3*60)),o=Math.floor(i/(1e3*60*60)),l=Math.floor(i/(1e3*60*60*24));return a<1?"Just now":a<60?`${a}m ago`:o<24?`${o}h ago`:l<7?`${l}d ago`:D2(r,{addSuffix:!0})}catch(r){return console.error("Error formatting last active time:",r),"Recently"}}static updateLastActive(t){return E(this,null,function*(){try{const{error:r}=yield P.rpc("update_user_last_active",{user_id_param:t});r&&console.error("Error updating last active:",r)}catch(r){console.error("Failed to update last active:",r)}})}static getUserVisibilitySettings(t){return E(this,null,function*(){var r;try{const{data:n,error:i}=yield P.from("users").select("avatar_url, is_public_profile, last_active_at").eq("user_id",t).single();return i?(console.error("Error fetching visibility settings:",i),null):{has_avatar:!!(n!=null&&n.avatar_url),is_public_profile:(r=n==null?void 0:n.is_public_profile)!=null?r:!0,last_active_at:(n==null?void 0:n.last_active_at)||new Date().toISOString()}}catch(n){return console.error("Failed to fetch visibility settings:",n),null}})}static setProfileVisibility(t,r){return E(this,null,function*(){try{const{error:n}=yield P.from("users").update({is_public_profile:r}).eq("user_id",t);return n?(console.error("Error updating profile visibility:",n),!1):!0}catch(n){return console.error("Failed to update profile visibility:",n),!1}})}static hasProfilePicture(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("users").select("avatar_url").eq("user_id",t).single();return n?(console.error("Error checking profile picture:",n),!1):!!(r!=null&&r.avatar_url&&r.avatar_url.trim()!=="")}catch(r){return console.error("Failed to check profile picture:",r),!1}})}static getFriendIds(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);return n?(console.error("Error fetching friends:",n),[]):(r||[]).map(i=>i.user_id===t?i.related_user_id:i.user_id)}catch(r){return console.error("Failed to fetch friends:",r),[]}})}}const Mde=({friend:e,isOpen:t,onClose:r,onStartChat:n,onAddFriend:i,onUnfriend:a,onNavigateToProfile:o})=>t?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:9999},children:s.jsxs(He,{className:"w-full max-w-md max-h-[80vh] overflow-y-auto",children:[s.jsx(xr,{className:"pb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Cr,{className:"text-xl font-bold",children:"Profile"}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:r,className:"h-8 w-8 p-0",children:s.jsx(pr,{className:"h-4 w-4"})})]})}),s.jsxs(st,{className:"space-y-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs(Vr,{className:"w-20 h-20 mx-auto mb-3",children:[s.jsx(Qr,{src:e.avatar_url||void 0}),s.jsx(qr,{className:"text-xl",children:e.name?e.name.split(" ").map(l=>l[0]).join(""):"F"})]}),s.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:e.name}),e.verified&&e.account_type&&s.jsx(LE,{accountType:e.account_type,verified:e.verified,size:"md"})]}),s.jsxs("p",{className:"text-gray-600 mb-2 text-sm",children:["@",e.username]}),(e.gender||e.birthday)&&s.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2 w-full",children:[e.gender&&s.jsx(Be,{variant:"secondary",className:"text-xs",children:e.gender}),e.birthday&&s.jsx(Be,{variant:"secondary",className:"text-xs",children:(()=>{const l=new Date(e.birthday),c=new Date;let d=c.getFullYear()-l.getFullYear();const u=c.getMonth()-l.getMonth();return(u<0||u===0&&c.getDate()<l.getDate())&&d--,`${d} years old`})()})]}),e.last_active_at&&s.jsxs(Be,{variant:"secondary",className:"mb-2 flex items-center gap-1 text-xs mx-auto w-fit",children:[s.jsx(ai,{className:"w-3 h-3"}),Th.formatLastActive(e.last_active_at)]}),s.jsxs(Be,{variant:"secondary",className:"bg-blue-100 text-blue-800 text-xs",children:[s.jsx(li,{className:"w-3 h-3 mr-1"}),"Friend"]})]}),e.bio&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"About"}),s.jsx("p",{className:"text-gray-700 text-sm leading-relaxed px-2",children:e.bio})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx(Et,{className:"w-3 h-3"}),s.jsxs("span",{children:["Member since ",(()=>{try{return Dt(Ws(e.created_at),"MMMM yyyy")}catch(l){return e.created_at}})()]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Music Preferences"}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.jsxs(Be,{variant:"outline",className:"text-xs",children:[s.jsx(Ct,{className:"w-3 h-3 mr-1"}),"Concert Lover"]}),s.jsxs(Be,{variant:"outline",className:"text-xs",children:[s.jsx(hs,{className:"w-3 h-3 mr-1"}),"Live Music"]}),s.jsxs(Be,{variant:"outline",className:"text-xs",children:[s.jsx(Jt,{className:"w-3 h-3 mr-1"}),"Music Enthusiast"]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Recent Activity"}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),s.jsx("span",{children:"Active now"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx(Ct,{className:"w-3 h-3"}),s.jsx("span",{children:"Recently reviewed a concert"})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-2 pt-3 border-t",children:[s.jsxs("div",{className:"flex gap-2",children:[i&&s.jsx(oe,{variant:"outline",className:"flex-1 text-sm",size:"sm",onClick:l=>E(void 0,null,function*(){l.preventDefault(),l.stopPropagation(),console.log(" Add Friend button clicked for:",e.name,"ID:",e.user_id);try{yield i(e.user_id),console.log(" Add friend request completed")}catch(c){console.error(" Error in Add Friend:",c)}}),children:"Add Friend"}),s.jsxs(oe,{variant:"outline",className:"flex-1 text-sm",size:"sm",onClick:l=>{l.preventDefault(),l.stopPropagation(),o&&(o(e.user_id),r())},children:[s.jsx(li,{className:"w-3 h-3 mr-1"}),"Full Profile"]}),s.jsxs(oe,{className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white text-sm",size:"sm",onClick:l=>{l.preventDefault(),l.stopPropagation(),n&&n(e.user_id),r()},children:[s.jsx(Wn,{className:"w-3 h-3 mr-1"}),"Start Chat"]})]}),a&&s.jsxs(oe,{variant:"destructive",className:"w-full text-sm",size:"sm",onClick:()=>E(void 0,null,function*(){try{yield a(e.user_id),r()}catch(l){console.error("Error unfriending user:",l)}}),children:[s.jsx(nI,{className:"w-3 h-3 mr-1"}),"Unfriend"]})]})]})]})}):null;function bg(e){if(!e)return"";if(e.startsWith("$"))return e;if(e.includes("-")){const[t,r]=e.split("-");return`$${t.trim()}-$${r.trim()}`}return`$${e.trim()}`}function Dde(e){if(!e)return 0;const t=e.match(/\$?(\d+)/);return t?parseInt(t[1]):0}const Fl=e=>typeof e.rating=="number"?e.rating:0;function YE({artistName:e,venueName:t,artistId:r,venueId:n}){const[i,a]=y.useState({totalReviews:0,averageRating:0,loading:!0}),[o,l]=y.useState({totalReviews:0,averageRating:0,loading:!0}),[c,d]=y.useState([]),[u,h]=y.useState([]),[f,p]=y.useState("newest"),[x,g]=y.useState("newest"),[v,_]=y.useState(!1),[w,b]=y.useState(!1);y.useEffect(()=>{E(this,null,function*(){console.log(" ArtistVenueReviews - Searching for:",{artistName:e,venueName:t});try{let T=[];const{data:$}=yield P.from("artists").select("id, name").ilike("name",e).maybeSingle();if($){const{data:B,error:U}=yield P.from("events_with_artist_venue").select("id").eq("artist_id",$.id).limit(1e3);!U&&B&&(T=B)}if(T.length===0){const{data:B,error:U}=yield P.from("events_with_artist_venue").select("id").ilike("artist_name_normalized",`${e}%`).limit(500);!U&&B&&(T=B)}if(T.length===0){const{data:B,error:U}=yield P.from("events_with_artist_venue").select("id").ilike("artist_name_normalized",`%${e}%`).limit(500);if(U){console.error("Error fetching event IDs for artist:",U),a({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load artist reviews"});return}B&&(T=B)}const R=T.map(B=>B.id);if(R.length===0){a({totalReviews:0,averageRating:0,loading:!1});return}const{data:F,error:D}=yield P.from("reviews").select(`
            rating,
            review_text,
            created_at,
            event_id
          `).eq("is_public",!0).in("event_id",R);if(D)console.error("Error fetching artist reviews:",D),a({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load artist reviews"});else if(F&&F.length>0){const B=F.map(K=>Fl(K)).filter(K=>typeof K=="number"&&K>0),U=B.length,V=U>0?B.reduce((K,Z)=>K+Z,0)/U:0;a({totalReviews:U,averageRating:V,loading:!1});const{data:Y,error:z}=yield P.from("reviews").select(`
              id,
              user_id,
              event_id,
              rating,
              artist_performance_rating,
              production_rating,
              venue_rating,
              location_rating,
              value_rating,
              artist_performance_feedback,
              production_feedback,
              venue_feedback,
              location_feedback,
              value_feedback,
              ticket_price_paid,
              review_text,
              created_at,
              mood_tags,
              genre_tags,
              reaction_emoji,
              photos
            `).eq("is_public",!0);if(!z&&Y){const K=Y.filter(ue=>!0),Z=K.map(ue=>ue.user_id).filter(Boolean),{data:G}=yield P.from("users").select("user_id, name, avatar_url").in("user_id",Z),X=K.map(ue=>ue.event_id).filter(Boolean),{data:te}=yield P.from("events_with_artist_venue").select("id, artist_id, venue_id, event_date, title, artist_name_normalized, venue_name_normalized").in("id",X),se=K.map(ue=>{var ge,ie,ee,H,le,Se,ae,fe,he,pe,Ae;const ye=G==null?void 0:G.find(qe=>qe.user_id===ue.user_id),ne=te==null?void 0:te.find(qe=>qe.id===ue.event_id);return{id:ue.id,rating:ue.rating,artist_performance_rating:(ge=ue.artist_performance_rating)!=null?ge:void 0,production_rating:(ie=ue.production_rating)!=null?ie:void 0,venue_rating:(ee=ue.venue_rating)!=null?ee:void 0,location_rating:(H=ue.location_rating)!=null?H:void 0,value_rating:(le=ue.value_rating)!=null?le:void 0,artist_performance_feedback:(Se=ue.artist_performance_feedback)!=null?Se:void 0,production_feedback:(ae=ue.production_feedback)!=null?ae:void 0,venue_feedback:(fe=ue.venue_feedback)!=null?fe:void 0,location_feedback:(he=ue.location_feedback)!=null?he:void 0,value_feedback:(pe=ue.value_feedback)!=null?pe:void 0,ticket_price_paid:(Ae=ue.ticket_price_paid)!=null?Ae:void 0,review_text:ue.review_text,created_at:ue.created_at,reviewer_name:(ye==null?void 0:ye.name)||"Anonymous",reviewer_avatar:(ye==null?void 0:ye.avatar_url)||null,event_title:(ne==null?void 0:ne.title)||"",event_date:(ne==null?void 0:ne.event_date)||"",mood_tags:ue.mood_tags||[],genre_tags:ue.genre_tags||[],reaction_emoji:ue.reaction_emoji||null,artist_name:(ne==null?void 0:ne.artist_name_normalized)||"",venue_name:(ne==null?void 0:ne.venue_name_normalized)||"",photos:Array.isArray(ue.photos)?ue.photos:[],category_average:Fl(ue)}}).filter(ue=>ue.artist_name&&ue.artist_name.toLowerCase().includes(e.toLowerCase()));d(se)}}else a({totalReviews:0,averageRating:0,loading:!1})}catch(T){console.error("Error fetching artist reviews:",T),a({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load artist reviews"}),d([])}try{const{data:T,error:$}=yield P.from("events_with_artist_venue").select("id").ilike("venue_name_normalized",`%${t}%`);if($){console.error("Error fetching event IDs for venue:",$),l({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load venue reviews"});return}const R=(T==null?void 0:T.map(V=>V.id))||[];if(R.length===0){l({totalReviews:0,averageRating:0,loading:!1});return}const{data:F,error:D}=yield P.from("reviews").select(`
            rating,
            review_text,
            created_at,
            event_id
          `).eq("is_public",!0).in("event_id",R),{data:B,error:U}=R.length>0?yield P.from("reviews").select(`
                id,
                event_id
              `).eq("is_public",!0).in("event_id",R):{data:[],error:null};if(D)console.error("Error fetching venue reviews:",D),l({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load venue reviews"});else if(F&&F.length>0){const V=F.map(G=>Fl(G)).filter(G=>typeof G=="number"&&G>0),Y=V.length,z=Y>0?V.reduce((G,X)=>G+X,0)/Y:0;l({totalReviews:Y,averageRating:z,loading:!1});const{data:K,error:Z}=yield P.from("reviews").select(`
              id,
              user_id,
              event_id,
              rating,
              artist_performance_rating,
              production_rating,
              venue_rating,
              location_rating,
              value_rating,
              artist_performance_feedback,
              production_feedback,
              venue_feedback,
              location_feedback,
              value_feedback,
              ticket_price_paid,
              review_text,
              created_at,
              mood_tags,
              genre_tags,
              reaction_emoji,
              photos
            `).eq("is_public",!0);if(!Z&&K){const G=K.filter(ne=>ne.venue_rating||ne.artist_performance_rating||ne.production_rating||ne.location_rating||ne.value_rating),X=G.map(ne=>ne.user_id).filter(Boolean),{data:te}=yield P.from("users").select("user_id, name, avatar_url").in("user_id",X),se=G.map(ne=>ne.event_id).filter(Boolean),{data:ue}=yield P.from("events_with_artist_venue").select("id, artist_id, venue_id, event_date, title, artist_name_normalized, venue_name_normalized").in("id",se),ye=G.map(ne=>{var ie,ee,H,le,Se,ae,fe,he,pe,Ae,qe;const xe=te==null?void 0:te.find(Fe=>Fe.user_id===ne.user_id),ge=ue==null?void 0:ue.find(Fe=>Fe.id===ne.event_id);return{id:ne.id,rating:ne.rating,artist_performance_rating:(ie=ne.artist_performance_rating)!=null?ie:void 0,production_rating:(ee=ne.production_rating)!=null?ee:void 0,venue_rating:(H=ne.venue_rating)!=null?H:void 0,location_rating:(le=ne.location_rating)!=null?le:void 0,value_rating:(Se=ne.value_rating)!=null?Se:void 0,artist_performance_feedback:(ae=ne.artist_performance_feedback)!=null?ae:void 0,production_feedback:(fe=ne.production_feedback)!=null?fe:void 0,venue_feedback:(he=ne.venue_feedback)!=null?he:void 0,location_feedback:(pe=ne.location_feedback)!=null?pe:void 0,value_feedback:(Ae=ne.value_feedback)!=null?Ae:void 0,ticket_price_paid:(qe=ne.ticket_price_paid)!=null?qe:void 0,review_text:ne.review_text,created_at:ne.created_at,reviewer_name:(xe==null?void 0:xe.name)||"Anonymous",reviewer_avatar:(xe==null?void 0:xe.avatar_url)||null,event_title:(ge==null?void 0:ge.title)||"",event_date:(ge==null?void 0:ge.event_date)||"",mood_tags:ne.mood_tags||[],genre_tags:ne.genre_tags||[],reaction_emoji:ne.reaction_emoji||null,artist_name:(ge==null?void 0:ge.artist_name)||"",venue_name:(ge==null?void 0:ge.venue_name)||"",photos:Array.isArray(ne.photos)?ne.photos:[],category_average:Fl(ne)}}).filter(ne=>{const xe=ne.venue_name&&ne.venue_name.toLowerCase().includes(t.toLowerCase());return console.log(" Venue matching:",{reviewVenue:ne.venue_name,searchVenue:t,matches:xe}),xe});h(ye)}}else l({totalReviews:0,averageRating:0,loading:!1})}catch(T){console.error("Error fetching venue reviews:",T),l({totalReviews:0,averageRating:0,loading:!1,error:"Failed to load venue reviews"}),h([])}})},[e,t]);const N=(A,T)=>{const $=[...A];switch(T){case"newest":return $.sort((R,F)=>new Date(F.created_at).getTime()-new Date(R.created_at).getTime());case"oldest":return $.sort((R,F)=>new Date(R.created_at).getTime()-new Date(F.created_at).getTime());case"highest_rating":return $.sort((R,F)=>{var U,V;const D=(U=R.category_average)!=null?U:Fl(R);return(((V=F.category_average)!=null?V:Fl(F))||0)-(D||0)});case"lowest_rating":return $.sort((R,F)=>{var U,V;const D=(U=R.category_average)!=null?U:Fl(R),B=(V=F.category_average)!=null?V:Fl(F);return(D||0)-(B||0)});default:return $}},S=A=>{const T=[],$=Math.floor(A),R=A%1>=.5;for(let D=0;D<$;D++)T.push(s.jsx(Jt,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},D));R&&T.push(s.jsx(Jt,{className:"w-4 h-4 fill-yellow-400/50 text-yellow-400"},"half"));const F=5-Math.ceil(A);for(let D=0;D<F;D++)T.push(s.jsx(Jt,{className:"w-4 h-4 text-gray-300"},`empty-${D}`));return T},k=A=>new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),O=(A,T=!0)=>{var R;const $=(R=A.category_average)!=null?R:Fl(A);return s.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("img",{src:A.reviewer_avatar||"/placeholder.svg",alt:A.reviewer_name,className:"w-8 h-8 rounded-full"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-sm",children:A.reviewer_name}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(Et,{className:"w-3 h-3"}),k(A.event_date)]}),T&&A.venue_name&&s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx(Xt,{className:"w-3 h-3"}),A.venue_name]}),!T&&A.artist_name&&s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx(Ct,{className:"w-3 h-3"}),A.artist_name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[S($),s.jsx("span",{className:"text-sm font-medium ml-1",children:$.toFixed(1)})]})]}),A.review_text&&s.jsx("p",{className:"text-sm text-gray-700",children:A.review_text}),[{label:"Artist performance",rating:A.artist_performance_rating,feedback:A.artist_performance_feedback},{label:"Production",rating:A.production_rating,feedback:A.production_feedback},{label:"Venue",rating:A.venue_rating,feedback:A.venue_feedback},{label:"Location",rating:A.location_rating,feedback:A.location_feedback},{label:"Value",rating:A.value_rating,feedback:A.value_feedback}].filter(({rating:F,feedback:D})=>F||D).map(({label:F,rating:D,feedback:B})=>s.jsxs("div",{className:"text-sm border-l-4 border-pink-200 pl-2 mt-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium text-gray-600",children:F}),typeof D=="number"&&s.jsx("span",{className:"text-xs text-gray-500",children:D.toFixed(1)})]}),B&&s.jsxs("div",{className:"text-xs text-gray-700 italic",children:["",B,""]})]},F)),A.mood_tags&&A.mood_tags.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:A.mood_tags.map((F,D)=>s.jsx(Be,{variant:"secondary",className:"text-xs",children:F},D))}),A.reaction_emoji&&s.jsx("div",{className:"text-lg",children:A.reaction_emoji})]},A.id)};return s.jsxs("div",{className:"space-y-6 mb-6",children:[s.jsxs(He,{className:"border-gray-200",children:[s.jsx(xr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ct,{className:"w-5 h-5 text-pink-500"}),s.jsx(Cr,{className:"text-lg",children:"Artist Reviews"})]}),i.totalReviews>0&&s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>_(!v),className:"flex items-center gap-1",children:[v?s.jsx(al,{className:"w-4 h-4"}):s.jsx(Qi,{className:"w-4 h-4"}),v?"Hide":"View"," Reviews"]})]})}),s.jsx(st,{className:"pt-0",children:i.loading?s.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."}):i.totalReviews>0?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[S(i.averageRating),s.jsx("span",{className:"text-sm font-medium",children:i.averageRating.toFixed(1)}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",i.totalReviews," review",i.totalReviews!==1?"s":"",")"]})]}),v&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),s.jsxs("select",{value:f,onChange:A=>p(A.target.value),className:"w-40 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500",children:[s.jsx("option",{value:"newest",children:"Newest"}),s.jsx("option",{value:"oldest",children:"Oldest"}),s.jsx("option",{value:"highest_rating",children:"Highest Rating"}),s.jsx("option",{value:"lowest_rating",children:"Lowest Rating"})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:N(c,f).map(A=>O(A,!0))})]})]}):s.jsxs("div",{className:"text-sm text-gray-500",children:["No reviews yet for ",e]})})]}),s.jsxs(He,{className:"border-gray-200",children:[s.jsx(xr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"w-5 h-5 text-pink-500"}),s.jsx(Cr,{className:"text-lg",children:"Venue Reviews"})]}),o.totalReviews>0&&s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>b(!w),className:"flex items-center gap-1",children:[w?s.jsx(al,{className:"w-4 h-4"}):s.jsx(Qi,{className:"w-4 h-4"}),w?"Hide":"View"," Reviews"]})]})}),s.jsx(st,{className:"pt-0",children:o.loading?s.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."}):o.totalReviews>0?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[S(o.averageRating),s.jsx("span",{className:"text-sm font-medium",children:o.averageRating.toFixed(1)}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",o.totalReviews," review",o.totalReviews!==1?"s":"",")"]})]}),w&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),s.jsxs("select",{value:x,onChange:A=>g(A.target.value),className:"w-40 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500",children:[s.jsx("option",{value:"newest",children:"Newest"}),s.jsx("option",{value:"oldest",children:"Oldest"}),s.jsx("option",{value:"highest_rating",children:"Highest Rating"}),s.jsx("option",{value:"lowest_rating",children:"Lowest Rating"})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:N(u,x).map(A=>O(A,!1))})]})]}):s.jsxs("div",{className:"text-sm text-gray-500",children:["No reviews yet for ",t]})})]})]})}function nU(e,t){const r=y.useRef(t);y.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}function Ide(e,t,r){t.center!==r.center&&e.setLatLng(t.center),t.radius!=null&&t.radius!==r.radius&&e.setRadius(t.radius)}const $de=1;function Lde(e){return Object.freeze({__version:$de,map:e})}function KE(e,t){return Object.freeze(M(M({},e),t))}const sU=y.createContext(null),iU=sU.Provider;function r1(){const e=y.useContext(sU);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function aU(e){function t(r,n){const{instance:i,context:a}=e(r).current;return y.useImperativeHandle(n,()=>i),r.children==null?null:Q.createElement(iU,{value:a},r.children)}return y.forwardRef(t)}function Fde(e){function t(r,n){const[i,a]=y.useState(!1),{instance:o}=e(r,a).current;y.useImperativeHandle(n,()=>o),y.useEffect(function(){i&&o.update()},[o,i,r.children]);const l=o._contentNode;return l?Ya.createPortal(r.children,l):null}return y.forwardRef(t)}function Ude(e){function t(r,n){const{instance:i}=e(r).current;return y.useImperativeHandle(n,()=>i),null}return y.forwardRef(t)}function ZE(e,t){const r=y.useRef();y.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function n1(e,t){var n;const r=(n=e.pane)!=null?n:t.pane;return r?W(M({},e),{pane:r}):e}function Bde(e,t){return function(n,i){const a=r1(),o=e(n1(n,a),a);return nU(a.map,n.attribution),ZE(o.current,n.eventHandlers),t(o.current,a,n,i),o}}var J3={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,n){n(t)})(Ks,function(r){var n="1.9.4";function i(m){var j,C,I,q;for(C=1,I=arguments.length;C<I;C++){q=arguments[C];for(j in q)m[j]=q[j]}return m}var a=Object.create||function(){function m(){}return function(j){return m.prototype=j,new m}}();function o(m,j){var C=Array.prototype.slice;if(m.bind)return m.bind.apply(m,C.call(arguments,1));var I=C.call(arguments,2);return function(){return m.apply(j,I.length?I.concat(C.call(arguments)):arguments)}}var l=0;function c(m){return"_leaflet_id"in m||(m._leaflet_id=++l),m._leaflet_id}function d(m,j,C){var I,q,J,we;return we=function(){I=!1,q&&(J.apply(C,q),q=!1)},J=function(){I?q=arguments:(m.apply(C,arguments),setTimeout(we,j),I=!0)},J}function u(m,j,C){var I=j[1],q=j[0],J=I-q;return m===I&&C?m:((m-q)%J+J)%J+q}function h(){return!1}function f(m,j){if(j===!1)return m;var C=Math.pow(10,j===void 0?6:j);return Math.round(m*C)/C}function p(m){return m.trim?m.trim():m.replace(/^\s+|\s+$/g,"")}function x(m){return p(m).split(/\s+/)}function g(m,j){Object.prototype.hasOwnProperty.call(m,"options")||(m.options=m.options?a(m.options):{});for(var C in j)m.options[C]=j[C];return m.options}function v(m,j,C){var I=[];for(var q in m)I.push(encodeURIComponent(C?q.toUpperCase():q)+"="+encodeURIComponent(m[q]));return(!j||j.indexOf("?")===-1?"?":"&")+I.join("&")}var _=/\{ *([\w_ -]+) *\}/g;function w(m,j){return m.replace(_,function(C,I){var q=j[I];if(q===void 0)throw new Error("No value provided for variable "+C);return typeof q=="function"&&(q=q(j)),q})}var b=Array.isArray||function(m){return Object.prototype.toString.call(m)==="[object Array]"};function N(m,j){for(var C=0;C<m.length;C++)if(m[C]===j)return C;return-1}var S="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function k(m){return window["webkit"+m]||window["moz"+m]||window["ms"+m]}var O=0;function A(m){var j=+new Date,C=Math.max(0,16-(j-O));return O=j+C,window.setTimeout(m,C)}var T=window.requestAnimationFrame||k("RequestAnimationFrame")||A,$=window.cancelAnimationFrame||k("CancelAnimationFrame")||k("CancelRequestAnimationFrame")||function(m){window.clearTimeout(m)};function R(m,j,C){if(C&&T===A)m.call(j);else return T.call(window,o(m,j))}function F(m){m&&$.call(window,m)}var D={__proto__:null,extend:i,create:a,bind:o,get lastId(){return l},stamp:c,throttle:d,wrapNum:u,falseFn:h,formatNum:f,trim:p,splitWords:x,setOptions:g,getParamString:v,template:w,isArray:b,indexOf:N,emptyImageUrl:S,requestFn:T,cancelFn:$,requestAnimFrame:R,cancelAnimFrame:F};function B(){}B.extend=function(m){var j=function(){g(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},C=j.__super__=this.prototype,I=a(C);I.constructor=j,j.prototype=I;for(var q in this)Object.prototype.hasOwnProperty.call(this,q)&&q!=="prototype"&&q!=="__super__"&&(j[q]=this[q]);return m.statics&&i(j,m.statics),m.includes&&(U(m.includes),i.apply(null,[I].concat(m.includes))),i(I,m),delete I.statics,delete I.includes,I.options&&(I.options=C.options?a(C.options):{},i(I.options,m.options)),I._initHooks=[],I.callInitHooks=function(){if(!this._initHooksCalled){C.callInitHooks&&C.callInitHooks.call(this),this._initHooksCalled=!0;for(var J=0,we=I._initHooks.length;J<we;J++)I._initHooks[J].call(this)}},j},B.include=function(m){var j=this.prototype.options;return i(this.prototype,m),m.options&&(this.prototype.options=j,this.mergeOptions(m.options)),this},B.mergeOptions=function(m){return i(this.prototype.options,m),this},B.addInitHook=function(m){var j=Array.prototype.slice.call(arguments,1),C=typeof m=="function"?m:function(){this[m].apply(this,j)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(C),this};function U(m){if(!(typeof L=="undefined"||!L||!L.Mixin)){m=b(m)?m:[m];for(var j=0;j<m.length;j++)m[j]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var V={on:function(m,j,C){if(typeof m=="object")for(var I in m)this._on(I,m[I],j);else{m=x(m);for(var q=0,J=m.length;q<J;q++)this._on(m[q],j,C)}return this},off:function(m,j,C){if(!arguments.length)delete this._events;else if(typeof m=="object")for(var I in m)this._off(I,m[I],j);else{m=x(m);for(var q=arguments.length===1,J=0,we=m.length;J<we;J++)q?this._off(m[J]):this._off(m[J],j,C)}return this},_on:function(m,j,C,I){if(typeof j!="function"){console.warn("wrong listener type: "+typeof j);return}if(this._listens(m,j,C)===!1){C===this&&(C=void 0);var q={fn:j,ctx:C};I&&(q.once=!0),this._events=this._events||{},this._events[m]=this._events[m]||[],this._events[m].push(q)}},_off:function(m,j,C){var I,q,J;if(this._events&&(I=this._events[m],!!I)){if(arguments.length===1){if(this._firingCount)for(q=0,J=I.length;q<J;q++)I[q].fn=h;delete this._events[m];return}if(typeof j!="function"){console.warn("wrong listener type: "+typeof j);return}var we=this._listens(m,j,C);if(we!==!1){var De=I[we];this._firingCount&&(De.fn=h,this._events[m]=I=I.slice()),I.splice(we,1)}}},fire:function(m,j,C){if(!this.listens(m,C))return this;var I=i({},j,{type:m,target:this,sourceTarget:j&&j.sourceTarget||this});if(this._events){var q=this._events[m];if(q){this._firingCount=this._firingCount+1||1;for(var J=0,we=q.length;J<we;J++){var De=q[J],ze=De.fn;De.once&&this.off(m,ze,De.ctx),ze.call(De.ctx||this,I)}this._firingCount--}}return C&&this._propagateEvent(I),this},listens:function(m,j,C,I){typeof m!="string"&&console.warn('"string" type argument expected');var q=j;typeof j!="function"&&(I=!!j,q=void 0,C=void 0);var J=this._events&&this._events[m];if(J&&J.length&&this._listens(m,q,C)!==!1)return!0;if(I){for(var we in this._eventParents)if(this._eventParents[we].listens(m,j,C,I))return!0}return!1},_listens:function(m,j,C){if(!this._events)return!1;var I=this._events[m]||[];if(!j)return!!I.length;C===this&&(C=void 0);for(var q=0,J=I.length;q<J;q++)if(I[q].fn===j&&I[q].ctx===C)return q;return!1},once:function(m,j,C){if(typeof m=="object")for(var I in m)this._on(I,m[I],j,!0);else{m=x(m);for(var q=0,J=m.length;q<J;q++)this._on(m[q],j,C,!0)}return this},addEventParent:function(m){return this._eventParents=this._eventParents||{},this._eventParents[c(m)]=m,this},removeEventParent:function(m){return this._eventParents&&delete this._eventParents[c(m)],this},_propagateEvent:function(m){for(var j in this._eventParents)this._eventParents[j].fire(m.type,i({layer:m.target,propagatedFrom:m.target},m),!0)}};V.addEventListener=V.on,V.removeEventListener=V.clearAllEventListeners=V.off,V.addOneTimeEventListener=V.once,V.fireEvent=V.fire,V.hasEventListeners=V.listens;var Y=B.extend(V);function z(m,j,C){this.x=C?Math.round(m):m,this.y=C?Math.round(j):j}var K=Math.trunc||function(m){return m>0?Math.floor(m):Math.ceil(m)};z.prototype={clone:function(){return new z(this.x,this.y)},add:function(m){return this.clone()._add(Z(m))},_add:function(m){return this.x+=m.x,this.y+=m.y,this},subtract:function(m){return this.clone()._subtract(Z(m))},_subtract:function(m){return this.x-=m.x,this.y-=m.y,this},divideBy:function(m){return this.clone()._divideBy(m)},_divideBy:function(m){return this.x/=m,this.y/=m,this},multiplyBy:function(m){return this.clone()._multiplyBy(m)},_multiplyBy:function(m){return this.x*=m,this.y*=m,this},scaleBy:function(m){return new z(this.x*m.x,this.y*m.y)},unscaleBy:function(m){return new z(this.x/m.x,this.y/m.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=K(this.x),this.y=K(this.y),this},distanceTo:function(m){m=Z(m);var j=m.x-this.x,C=m.y-this.y;return Math.sqrt(j*j+C*C)},equals:function(m){return m=Z(m),m.x===this.x&&m.y===this.y},contains:function(m){return m=Z(m),Math.abs(m.x)<=Math.abs(this.x)&&Math.abs(m.y)<=Math.abs(this.y)},toString:function(){return"Point("+f(this.x)+", "+f(this.y)+")"}};function Z(m,j,C){return m instanceof z?m:b(m)?new z(m[0],m[1]):m==null?m:typeof m=="object"&&"x"in m&&"y"in m?new z(m.x,m.y):new z(m,j,C)}function G(m,j){if(m)for(var C=j?[m,j]:m,I=0,q=C.length;I<q;I++)this.extend(C[I])}G.prototype={extend:function(m){var j,C;if(!m)return this;if(m instanceof z||typeof m[0]=="number"||"x"in m)j=C=Z(m);else if(m=X(m),j=m.min,C=m.max,!j||!C)return this;return!this.min&&!this.max?(this.min=j.clone(),this.max=C.clone()):(this.min.x=Math.min(j.x,this.min.x),this.max.x=Math.max(C.x,this.max.x),this.min.y=Math.min(j.y,this.min.y),this.max.y=Math.max(C.y,this.max.y)),this},getCenter:function(m){return Z((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,m)},getBottomLeft:function(){return Z(this.min.x,this.max.y)},getTopRight:function(){return Z(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(m){var j,C;return typeof m[0]=="number"||m instanceof z?m=Z(m):m=X(m),m instanceof G?(j=m.min,C=m.max):j=C=m,j.x>=this.min.x&&C.x<=this.max.x&&j.y>=this.min.y&&C.y<=this.max.y},intersects:function(m){m=X(m);var j=this.min,C=this.max,I=m.min,q=m.max,J=q.x>=j.x&&I.x<=C.x,we=q.y>=j.y&&I.y<=C.y;return J&&we},overlaps:function(m){m=X(m);var j=this.min,C=this.max,I=m.min,q=m.max,J=q.x>j.x&&I.x<C.x,we=q.y>j.y&&I.y<C.y;return J&&we},isValid:function(){return!!(this.min&&this.max)},pad:function(m){var j=this.min,C=this.max,I=Math.abs(j.x-C.x)*m,q=Math.abs(j.y-C.y)*m;return X(Z(j.x-I,j.y-q),Z(C.x+I,C.y+q))},equals:function(m){return m?(m=X(m),this.min.equals(m.getTopLeft())&&this.max.equals(m.getBottomRight())):!1}};function X(m,j){return!m||m instanceof G?m:new G(m,j)}function te(m,j){if(m)for(var C=j?[m,j]:m,I=0,q=C.length;I<q;I++)this.extend(C[I])}te.prototype={extend:function(m){var j=this._southWest,C=this._northEast,I,q;if(m instanceof ue)I=m,q=m;else if(m instanceof te){if(I=m._southWest,q=m._northEast,!I||!q)return this}else return m?this.extend(ye(m)||se(m)):this;return!j&&!C?(this._southWest=new ue(I.lat,I.lng),this._northEast=new ue(q.lat,q.lng)):(j.lat=Math.min(I.lat,j.lat),j.lng=Math.min(I.lng,j.lng),C.lat=Math.max(q.lat,C.lat),C.lng=Math.max(q.lng,C.lng)),this},pad:function(m){var j=this._southWest,C=this._northEast,I=Math.abs(j.lat-C.lat)*m,q=Math.abs(j.lng-C.lng)*m;return new te(new ue(j.lat-I,j.lng-q),new ue(C.lat+I,C.lng+q))},getCenter:function(){return new ue((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ue(this.getNorth(),this.getWest())},getSouthEast:function(){return new ue(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(m){typeof m[0]=="number"||m instanceof ue||"lat"in m?m=ye(m):m=se(m);var j=this._southWest,C=this._northEast,I,q;return m instanceof te?(I=m.getSouthWest(),q=m.getNorthEast()):I=q=m,I.lat>=j.lat&&q.lat<=C.lat&&I.lng>=j.lng&&q.lng<=C.lng},intersects:function(m){m=se(m);var j=this._southWest,C=this._northEast,I=m.getSouthWest(),q=m.getNorthEast(),J=q.lat>=j.lat&&I.lat<=C.lat,we=q.lng>=j.lng&&I.lng<=C.lng;return J&&we},overlaps:function(m){m=se(m);var j=this._southWest,C=this._northEast,I=m.getSouthWest(),q=m.getNorthEast(),J=q.lat>j.lat&&I.lat<C.lat,we=q.lng>j.lng&&I.lng<C.lng;return J&&we},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(m,j){return m?(m=se(m),this._southWest.equals(m.getSouthWest(),j)&&this._northEast.equals(m.getNorthEast(),j)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function se(m,j){return m instanceof te?m:new te(m,j)}function ue(m,j,C){if(isNaN(m)||isNaN(j))throw new Error("Invalid LatLng object: ("+m+", "+j+")");this.lat=+m,this.lng=+j,C!==void 0&&(this.alt=+C)}ue.prototype={equals:function(m,j){if(!m)return!1;m=ye(m);var C=Math.max(Math.abs(this.lat-m.lat),Math.abs(this.lng-m.lng));return C<=(j===void 0?1e-9:j)},toString:function(m){return"LatLng("+f(this.lat,m)+", "+f(this.lng,m)+")"},distanceTo:function(m){return xe.distance(this,ye(m))},wrap:function(){return xe.wrapLatLng(this)},toBounds:function(m){var j=180*m/40075017,C=j/Math.cos(Math.PI/180*this.lat);return se([this.lat-j,this.lng-C],[this.lat+j,this.lng+C])},clone:function(){return new ue(this.lat,this.lng,this.alt)}};function ye(m,j,C){return m instanceof ue?m:b(m)&&typeof m[0]!="object"?m.length===3?new ue(m[0],m[1],m[2]):m.length===2?new ue(m[0],m[1]):null:m==null?m:typeof m=="object"&&"lat"in m?new ue(m.lat,"lng"in m?m.lng:m.lon,m.alt):j===void 0?null:new ue(m,j,C)}var ne={latLngToPoint:function(m,j){var C=this.projection.project(m),I=this.scale(j);return this.transformation._transform(C,I)},pointToLatLng:function(m,j){var C=this.scale(j),I=this.transformation.untransform(m,C);return this.projection.unproject(I)},project:function(m){return this.projection.project(m)},unproject:function(m){return this.projection.unproject(m)},scale:function(m){return 256*Math.pow(2,m)},zoom:function(m){return Math.log(m/256)/Math.LN2},getProjectedBounds:function(m){if(this.infinite)return null;var j=this.projection.bounds,C=this.scale(m),I=this.transformation.transform(j.min,C),q=this.transformation.transform(j.max,C);return new G(I,q)},infinite:!1,wrapLatLng:function(m){var j=this.wrapLng?u(m.lng,this.wrapLng,!0):m.lng,C=this.wrapLat?u(m.lat,this.wrapLat,!0):m.lat,I=m.alt;return new ue(C,j,I)},wrapLatLngBounds:function(m){var j=m.getCenter(),C=this.wrapLatLng(j),I=j.lat-C.lat,q=j.lng-C.lng;if(I===0&&q===0)return m;var J=m.getSouthWest(),we=m.getNorthEast(),De=new ue(J.lat-I,J.lng-q),ze=new ue(we.lat-I,we.lng-q);return new te(De,ze)}},xe=i({},ne,{wrapLng:[-180,180],R:6371e3,distance:function(m,j){var C=Math.PI/180,I=m.lat*C,q=j.lat*C,J=Math.sin((j.lat-m.lat)*C/2),we=Math.sin((j.lng-m.lng)*C/2),De=J*J+Math.cos(I)*Math.cos(q)*we*we,ze=2*Math.atan2(Math.sqrt(De),Math.sqrt(1-De));return this.R*ze}}),ge=6378137,ie={R:ge,MAX_LATITUDE:85.0511287798,project:function(m){var j=Math.PI/180,C=this.MAX_LATITUDE,I=Math.max(Math.min(C,m.lat),-C),q=Math.sin(I*j);return new z(this.R*m.lng*j,this.R*Math.log((1+q)/(1-q))/2)},unproject:function(m){var j=180/Math.PI;return new ue((2*Math.atan(Math.exp(m.y/this.R))-Math.PI/2)*j,m.x*j/this.R)},bounds:function(){var m=ge*Math.PI;return new G([-m,-m],[m,m])}()};function ee(m,j,C,I){if(b(m)){this._a=m[0],this._b=m[1],this._c=m[2],this._d=m[3];return}this._a=m,this._b=j,this._c=C,this._d=I}ee.prototype={transform:function(m,j){return this._transform(m.clone(),j)},_transform:function(m,j){return j=j||1,m.x=j*(this._a*m.x+this._b),m.y=j*(this._c*m.y+this._d),m},untransform:function(m,j){return j=j||1,new z((m.x/j-this._b)/this._a,(m.y/j-this._d)/this._c)}};function H(m,j,C,I){return new ee(m,j,C,I)}var le=i({},xe,{code:"EPSG:3857",projection:ie,transformation:function(){var m=.5/(Math.PI*ie.R);return H(m,.5,-m,.5)}()}),Se=i({},le,{code:"EPSG:900913"});function ae(m){return document.createElementNS("http://www.w3.org/2000/svg",m)}function fe(m,j){var C="",I,q,J,we,De,ze;for(I=0,J=m.length;I<J;I++){for(De=m[I],q=0,we=De.length;q<we;q++)ze=De[q],C+=(q?"L":"M")+ze.x+" "+ze.y;C+=j?pt.svg?"z":"x":""}return C||"M0 0"}var he=document.documentElement.style,pe="ActiveXObject"in window,Ae=pe&&!document.addEventListener,qe="msLaunchUri"in navigator&&!("documentMode"in document),Fe=jt("webkit"),ve=jt("android"),rt=jt("android 2")||jt("android 3"),Ve=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),lt=ve&&jt("Google")&&Ve<537&&!("AudioNode"in window),ut=!!window.opera,Ze=!qe&&jt("chrome"),qt=jt("gecko")&&!Fe&&!ut&&!pe,lr=!Ze&&jt("safari"),Ge=jt("phantom"),Le="OTransition"in he,yt=navigator.platform.indexOf("Win")===0,Ne=pe&&"transition"in he,Oe="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!rt,ce="MozPerspective"in he,Ee=!window.L_DISABLE_3D&&(Ne||Oe||ce)&&!Le&&!Ge,Qe=typeof orientation!="undefined"||jt("mobile"),vt=Qe&&Fe,wt=Qe&&Oe,Ht=!window.PointerEvent&&window.MSPointerEvent,Rt=!!(window.PointerEvent||Ht),Te="ontouchstart"in window||!!window.TouchEvent,bt=!window.L_NO_TOUCH&&(Te||Rt),$e=Qe&&ut,Ie=Qe&&qt,Ue=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,dt=function(){var m=!1;try{var j=Object.defineProperty({},"passive",{get:function(){m=!0}});window.addEventListener("testPassiveEventSupport",h,j),window.removeEventListener("testPassiveEventSupport",h,j)}catch(C){}return m}(),be=function(){return!!document.createElement("canvas").getContext}(),Re=!!(document.createElementNS&&ae("svg").createSVGRect),We=!!Re&&function(){var m=document.createElement("div");return m.innerHTML="<svg/>",(m.firstChild&&m.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),St=!Re&&function(){try{var m=document.createElement("div");m.innerHTML='<v:shape adj="1"/>';var j=m.firstChild;return j.style.behavior="url(#default#VML)",j&&typeof j.adj=="object"}catch(C){return!1}}(),Ye=navigator.platform.indexOf("Mac")===0,ir=navigator.platform.indexOf("Linux")===0;function jt(m){return navigator.userAgent.toLowerCase().indexOf(m)>=0}var pt={ie:pe,ielt9:Ae,edge:qe,webkit:Fe,android:ve,android23:rt,androidStock:lt,opera:ut,chrome:Ze,gecko:qt,safari:lr,phantom:Ge,opera12:Le,win:yt,ie3d:Ne,webkit3d:Oe,gecko3d:ce,any3d:Ee,mobile:Qe,mobileWebkit:vt,mobileWebkit3d:wt,msPointer:Ht,pointer:Rt,touch:bt,touchNative:Te,mobileOpera:$e,mobileGecko:Ie,retina:Ue,passiveEvents:dt,canvas:be,svg:Re,vml:St,inlineSvg:We,mac:Ye,linux:ir},vn=pt.msPointer?"MSPointerDown":"pointerdown",Jn=pt.msPointer?"MSPointerMove":"pointermove",Fs=pt.msPointer?"MSPointerUp":"pointerup",Mt=pt.msPointer?"MSPointerCancel":"pointercancel",re={touchstart:vn,touchmove:Jn,touchend:Fs,touchcancel:Mt},_e={touchstart:Wr,touchmove:cr,touchend:cr,touchcancel:cr},Ke={},ht=!1;function ct(m,j,C){return j==="touchstart"&&gt(),_e[j]?(C=_e[j].bind(this,C),m.addEventListener(re[j],C,!1),C):(console.warn("wrong event specified:",j),h)}function Pe(m,j,C){if(!re[j]){console.warn("wrong event specified:",j);return}m.removeEventListener(re[j],C,!1)}function et(m){Ke[m.pointerId]=m}function nt(m){Ke[m.pointerId]&&(Ke[m.pointerId]=m)}function Me(m){delete Ke[m.pointerId]}function gt(){ht||(document.addEventListener(vn,et,!0),document.addEventListener(Jn,nt,!0),document.addEventListener(Fs,Me,!0),document.addEventListener(Mt,Me,!0),ht=!0)}function cr(m,j){if(j.pointerType!==(j.MSPOINTER_TYPE_MOUSE||"mouse")){j.touches=[];for(var C in Ke)j.touches.push(Ke[C]);j.changedTouches=[j],m(j)}}function Wr(m,j){j.MSPOINTER_TYPE_TOUCH&&j.pointerType===j.MSPOINTER_TYPE_TOUCH&&gs(j),cr(m,j)}function bn(m){var j={},C,I;for(I in m)C=m[I],j[I]=C&&C.bind?C.bind(m):C;return m=j,j.type="dblclick",j.detail=2,j.isTrusted=!1,j._simulated=!0,j}var xn=200;function fn(m,j){m.addEventListener("dblclick",j);var C=0,I;function q(J){if(J.detail!==1){I=J.detail;return}if(!(J.pointerType==="mouse"||J.sourceCapabilities&&!J.sourceCapabilities.firesTouchEvents)){var we=ex(J);if(!(we.some(function(ze){return ze instanceof HTMLLabelElement&&ze.attributes.for})&&!we.some(function(ze){return ze instanceof HTMLInputElement||ze instanceof HTMLSelectElement}))){var De=Date.now();De-C<=xn?(I++,I===2&&j(bn(J))):I=1,C=De}}}return m.addEventListener("click",q),{dblclick:j,simDblclick:q}}function Bn(m,j){m.removeEventListener("dblclick",j.dblclick),m.removeEventListener("click",j.simDblclick)}var ms=jn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ls=jn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Bt=ls==="webkitTransition"||ls==="OTransition"?ls+"End":"transitionend";function Pt(m){return typeof m=="string"?document.getElementById(m):m}function It(m,j){var C=m.style[j]||m.currentStyle&&m.currentStyle[j];if((!C||C==="auto")&&document.defaultView){var I=document.defaultView.getComputedStyle(m,null);C=I?I[j]:null}return C==="auto"?null:C}function kt(m,j,C){var I=document.createElement(m);return I.className=j||"",C&&C.appendChild(I),I}function rr(m){var j=m.parentNode;j&&j.removeChild(m)}function mr(m){for(;m.firstChild;)m.removeChild(m.firstChild)}function Hr(m){var j=m.parentNode;j&&j.lastChild!==m&&j.appendChild(m)}function dn(m){var j=m.parentNode;j&&j.firstChild!==m&&j.insertBefore(m,j.firstChild)}function bi(m,j){if(m.classList!==void 0)return m.classList.contains(j);var C=di(m);return C.length>0&&new RegExp("(^|\\s)"+j+"(\\s|$)").test(C)}function tr(m,j){if(m.classList!==void 0)for(var C=x(j),I=0,q=C.length;I<q;I++)m.classList.add(C[I]);else if(!bi(m,j)){var J=di(m);Ui(m,(J?J+" ":"")+j)}}function Gr(m,j){m.classList!==void 0?m.classList.remove(j):Ui(m,p((" "+di(m)+" ").replace(" "+j+" "," ")))}function Ui(m,j){m.className.baseVal===void 0?m.className=j:m.className.baseVal=j}function di(m){return m.correspondingElement&&(m=m.correspondingElement),m.className.baseVal===void 0?m.className:m.className.baseVal}function Dr(m,j){"opacity"in m.style?m.style.opacity=j:"filter"in m.style&&Ur(m,j)}function Ur(m,j){var C=!1,I="DXImageTransform.Microsoft.Alpha";try{C=m.filters.item(I)}catch(q){if(j===1)return}j=Math.round(j*100),C?(C.Enabled=j!==100,C.Opacity=j):m.style.filter+=" progid:"+I+"(opacity="+j+")"}function jn(m){for(var j=document.documentElement.style,C=0;C<m.length;C++)if(m[C]in j)return m[C];return!1}function zn(m,j,C){var I=j||new z(0,0);m.style[ms]=(pt.ie3d?"translate("+I.x+"px,"+I.y+"px)":"translate3d("+I.x+"px,"+I.y+"px,0)")+(C?" scale("+C+")":"")}function Yr(m,j){m._leaflet_pos=j,pt.any3d?zn(m,j):(m.style.left=j.x+"px",m.style.top=j.y+"px")}function Ns(m){return m._leaflet_pos||new z(0,0)}var Ta,qo,Nn;if("onselectstart"in document)Ta=function(){dr(window,"selectstart",gs)},qo=function(){cn(window,"selectstart",gs)};else{var Kt=jn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ta=function(){if(Kt){var m=document.documentElement.style;Nn=m[Kt],m[Kt]="none"}},qo=function(){Kt&&(document.documentElement.style[Kt]=Nn,Nn=void 0)}}function Nr(){dr(window,"dragstart",gs)}function zr(){cn(window,"dragstart",gs)}var hn,ps;function ma(m){for(;m.tabIndex===-1;)m=m.parentNode;m.style&&(ji(),hn=m,ps=m.style.outlineStyle,m.style.outlineStyle="none",dr(window,"keydown",ji))}function ji(){hn&&(hn.style.outlineStyle=ps,hn=void 0,ps=void 0,cn(window,"keydown",ji))}function yn(m){do m=m.parentNode;while((!m.offsetWidth||!m.offsetHeight)&&m!==document.body);return m}function Qn(m){var j=m.getBoundingClientRect();return{x:j.width/m.offsetWidth||1,y:j.height/m.offsetHeight||1,boundingClientRect:j}}var wf={__proto__:null,TRANSFORM:ms,TRANSITION:ls,TRANSITION_END:Bt,get:Pt,getStyle:It,create:kt,remove:rr,empty:mr,toFront:Hr,toBack:dn,hasClass:bi,addClass:tr,removeClass:Gr,setClass:Ui,getClass:di,setOpacity:Dr,testProp:jn,setTransform:zn,setPosition:Yr,getPosition:Ns,get disableTextSelection(){return Ta},get enableTextSelection(){return qo},disableImageDrag:Nr,enableImageDrag:zr,preventOutline:ma,restoreOutline:ji,getSizedParentNode:yn,getScale:Qn};function dr(m,j,C,I){if(j&&typeof j=="object")for(var q in j)Tl(m,q,j[q],C);else{j=x(j);for(var J=0,we=j.length;J<we;J++)Tl(m,j[J],C,I)}return this}var Bi="_leaflet_events";function cn(m,j,C,I){if(arguments.length===1)Rc(m),delete m[Bi];else if(j&&typeof j=="object")for(var q in j)Ol(m,q,j[q],C);else if(j=x(j),arguments.length===2)Rc(m,function(De){return N(j,De)!==-1});else for(var J=0,we=j.length;J<we;J++)Ol(m,j[J],C,I);return this}function Rc(m,j){for(var C in m[Bi]){var I=C.split(/\d/)[0];(!j||j(I))&&Ol(m,I,null,null,C)}}var Mc={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Tl(m,j,C,I){var q=j+c(C)+(I?"_"+c(I):"");if(m[Bi]&&m[Bi][q])return this;var J=function(De){return C.call(I||m,De||window.event)},we=J;!pt.touchNative&&pt.pointer&&j.indexOf("touch")===0?J=ct(m,j,J):pt.touch&&j==="dblclick"?J=fn(m,J):"addEventListener"in m?j==="touchstart"||j==="touchmove"||j==="wheel"||j==="mousewheel"?m.addEventListener(Mc[j]||j,J,pt.passiveEvents?{passive:!1}:!1):j==="mouseenter"||j==="mouseleave"?(J=function(De){De=De||window.event,bf(m,De)&&we(De)},m.addEventListener(Mc[j],J,!1)):m.addEventListener(j,we,!1):m.attachEvent("on"+j,J),m[Bi]=m[Bi]||{},m[Bi][q]=J}function Ol(m,j,C,I,q){q=q||j+c(C)+(I?"_"+c(I):"");var J=m[Bi]&&m[Bi][q];if(!J)return this;!pt.touchNative&&pt.pointer&&j.indexOf("touch")===0?Pe(m,j,J):pt.touch&&j==="dblclick"?Bn(m,J):"removeEventListener"in m?m.removeEventListener(Mc[j]||j,J,!1):m.detachEvent("on"+j,J),m[Bi][q]=null}function ui(m){return m.stopPropagation?m.stopPropagation():m.originalEvent?m.originalEvent._stopped=!0:m.cancelBubble=!0,this}function Wo(m){return Tl(m,"wheel",ui),this}function qd(m){return dr(m,"mousedown touchstart dblclick contextmenu",ui),m._leaflet_disable_click=!0,this}function gs(m){return m.preventDefault?m.preventDefault():m.returnValue=!1,this}function Rl(m){return gs(m),ui(m),this}function ex(m){if(m.composedPath)return m.composedPath();for(var j=[],C=m.target;C;)j.push(C),C=C.parentNode;return j}function tx(m,j){if(!j)return new z(m.clientX,m.clientY);var C=Qn(j),I=C.boundingClientRect;return new z((m.clientX-I.left)/C.x-j.clientLeft,(m.clientY-I.top)/C.y-j.clientTop)}var rx=pt.linux&&pt.chrome?window.devicePixelRatio:pt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function wp(m){return pt.edge?m.wheelDeltaY/2:m.deltaY&&m.deltaMode===0?-m.deltaY/rx:m.deltaY&&m.deltaMode===1?-m.deltaY*20:m.deltaY&&m.deltaMode===2?-m.deltaY*60:m.deltaX||m.deltaZ?0:m.wheelDelta?(m.wheelDeltaY||m.wheelDelta)/2:m.detail&&Math.abs(m.detail)<32765?-m.detail*20:m.detail?m.detail/-32765*60:0}function bf(m,j){var C=j.relatedTarget;if(!C)return!0;try{for(;C&&C!==m;)C=C.parentNode}catch(I){return!1}return C!==m}var nx={__proto__:null,on:dr,off:cn,stopPropagation:ui,disableScrollPropagation:Wo,disableClickPropagation:qd,preventDefault:gs,stop:Rl,getPropagationPath:ex,getMousePosition:tx,getWheelDelta:wp,isExternalTarget:bf,addListener:dr,removeListener:cn},bp=Y.extend({run:function(m,j,C,I){this.stop(),this._el=m,this._inProgress=!0,this._duration=C||.25,this._easeOutPower=1/Math.max(I||.5,.2),this._startPos=Ns(m),this._offset=j.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=R(this._animate,this),this._step()},_step:function(m){var j=+new Date-this._startTime,C=this._duration*1e3;j<C?this._runFrame(this._easeOut(j/C),m):(this._runFrame(1),this._complete())},_runFrame:function(m,j){var C=this._startPos.add(this._offset.multiplyBy(m));j&&C._round(),Yr(this._el,C),this.fire("step")},_complete:function(){F(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(m){return 1-Math.pow(1-m,this._easeOutPower)}}),Ir=Y.extend({options:{crs:le,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(m,j){j=g(this,j),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(m),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),j.maxBounds&&this.setMaxBounds(j.maxBounds),j.zoom!==void 0&&(this._zoom=this._limitZoom(j.zoom)),j.center&&j.zoom!==void 0&&this.setView(ye(j.center),j.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ls&&pt.any3d&&!pt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),dr(this._proxy,Bt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(m,j,C){if(j=j===void 0?this._zoom:this._limitZoom(j),m=this._limitCenter(ye(m),j,this.options.maxBounds),C=C||{},this._stop(),this._loaded&&!C.reset&&C!==!0){C.animate!==void 0&&(C.zoom=i({animate:C.animate},C.zoom),C.pan=i({animate:C.animate,duration:C.duration},C.pan));var I=this._zoom!==j?this._tryAnimatedZoom&&this._tryAnimatedZoom(m,j,C.zoom):this._tryAnimatedPan(m,C.pan);if(I)return clearTimeout(this._sizeTimer),this}return this._resetView(m,j,C.pan&&C.pan.noMoveStart),this},setZoom:function(m,j){return this._loaded?this.setView(this.getCenter(),m,{zoom:j}):(this._zoom=m,this)},zoomIn:function(m,j){return m=m||(pt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+m,j)},zoomOut:function(m,j){return m=m||(pt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-m,j)},setZoomAround:function(m,j,C){var I=this.getZoomScale(j),q=this.getSize().divideBy(2),J=m instanceof z?m:this.latLngToContainerPoint(m),we=J.subtract(q).multiplyBy(1-1/I),De=this.containerPointToLatLng(q.add(we));return this.setView(De,j,{zoom:C})},_getBoundsCenterZoom:function(m,j){j=j||{},m=m.getBounds?m.getBounds():se(m);var C=Z(j.paddingTopLeft||j.padding||[0,0]),I=Z(j.paddingBottomRight||j.padding||[0,0]),q=this.getBoundsZoom(m,!1,C.add(I));if(q=typeof j.maxZoom=="number"?Math.min(j.maxZoom,q):q,q===1/0)return{center:m.getCenter(),zoom:q};var J=I.subtract(C).divideBy(2),we=this.project(m.getSouthWest(),q),De=this.project(m.getNorthEast(),q),ze=this.unproject(we.add(De).divideBy(2).add(J),q);return{center:ze,zoom:q}},fitBounds:function(m,j){if(m=se(m),!m.isValid())throw new Error("Bounds are not valid.");var C=this._getBoundsCenterZoom(m,j);return this.setView(C.center,C.zoom,j)},fitWorld:function(m){return this.fitBounds([[-90,-180],[90,180]],m)},panTo:function(m,j){return this.setView(m,this._zoom,{pan:j})},panBy:function(m,j){if(m=Z(m).round(),j=j||{},!m.x&&!m.y)return this.fire("moveend");if(j.animate!==!0&&!this.getSize().contains(m))return this._resetView(this.unproject(this.project(this.getCenter()).add(m)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new bp,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),j.noMoveStart||this.fire("movestart"),j.animate!==!1){tr(this._mapPane,"leaflet-pan-anim");var C=this._getMapPanePos().subtract(m).round();this._panAnim.run(this._mapPane,C,j.duration||.25,j.easeLinearity)}else this._rawPanBy(m),this.fire("move").fire("moveend");return this},flyTo:function(m,j,C){if(C=C||{},C.animate===!1||!pt.any3d)return this.setView(m,j,C);this._stop();var I=this.project(this.getCenter()),q=this.project(m),J=this.getSize(),we=this._zoom;m=ye(m),j=j===void 0?we:j;var De=Math.max(J.x,J.y),ze=De*this.getZoomScale(we,j),ft=q.distanceTo(I)||1,$t=1.42,fr=$t*$t;function Rr(vs){var vx=vs?-1:1,VY=vs?ze:De,qY=ze*ze-De*De+vx*fr*fr*ft*ft,WY=2*VY*fr*ft,yb=qY/WY,m6=Math.sqrt(yb*yb+1)-yb,HY=m6<1e-9?-18:Math.log(m6);return HY}function Si(vs){return(Math.exp(vs)-Math.exp(-vs))/2}function Us(vs){return(Math.exp(vs)+Math.exp(-vs))/2}function Oa(vs){return Si(vs)/Us(vs)}var Vi=Rr(0);function Cf(vs){return De*(Us(Vi)/Us(Vi+$t*vs))}function FY(vs){return De*(Us(Vi)*Oa(Vi+$t*vs)-Si(Vi))/fr}function UY(vs){return 1-Math.pow(1-vs,1.5)}var BY=Date.now(),f6=(Rr(1)-Vi)/$t,zY=C.duration?1e3*C.duration:1e3*f6*.8;function h6(){var vs=(Date.now()-BY)/zY,vx=UY(vs)*f6;vs<=1?(this._flyToFrame=R(h6,this),this._move(this.unproject(I.add(q.subtract(I).multiplyBy(FY(vx)/ft)),we),this.getScaleZoom(De/Cf(vx),we),{flyTo:!0})):this._move(m,j)._moveEnd(!0)}return this._moveStart(!0,C.noMoveStart),h6.call(this),this},flyToBounds:function(m,j){var C=this._getBoundsCenterZoom(m,j);return this.flyTo(C.center,C.zoom,j)},setMaxBounds:function(m){return m=se(m),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),m.isValid()?(this.options.maxBounds=m,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(m){var j=this.options.minZoom;return this.options.minZoom=m,this._loaded&&j!==m&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(m):this},setMaxZoom:function(m){var j=this.options.maxZoom;return this.options.maxZoom=m,this._loaded&&j!==m&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(m):this},panInsideBounds:function(m,j){this._enforcingBounds=!0;var C=this.getCenter(),I=this._limitCenter(C,this._zoom,se(m));return C.equals(I)||this.panTo(I,j),this._enforcingBounds=!1,this},panInside:function(m,j){j=j||{};var C=Z(j.paddingTopLeft||j.padding||[0,0]),I=Z(j.paddingBottomRight||j.padding||[0,0]),q=this.project(this.getCenter()),J=this.project(m),we=this.getPixelBounds(),De=X([we.min.add(C),we.max.subtract(I)]),ze=De.getSize();if(!De.contains(J)){this._enforcingBounds=!0;var ft=J.subtract(De.getCenter()),$t=De.extend(J).getSize().subtract(ze);q.x+=ft.x<0?-$t.x:$t.x,q.y+=ft.y<0?-$t.y:$t.y,this.panTo(this.unproject(q),j),this._enforcingBounds=!1}return this},invalidateSize:function(m){if(!this._loaded)return this;m=i({animate:!1,pan:!0},m===!0?{animate:!0}:m);var j=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var C=this.getSize(),I=j.divideBy(2).round(),q=C.divideBy(2).round(),J=I.subtract(q);return!J.x&&!J.y?this:(m.animate&&m.pan?this.panBy(J):(m.pan&&this._rawPanBy(J),this.fire("move"),m.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:j,newSize:C}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(m){if(m=this._locateOptions=i({timeout:1e4,watch:!1},m),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var j=o(this._handleGeolocationResponse,this),C=o(this._handleGeolocationError,this);return m.watch?this._locationWatchId=navigator.geolocation.watchPosition(j,C,m):navigator.geolocation.getCurrentPosition(j,C,m),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(m){if(this._container._leaflet_id){var j=m.code,C=m.message||(j===1?"permission denied":j===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:j,message:"Geolocation error: "+C+"."})}},_handleGeolocationResponse:function(m){if(this._container._leaflet_id){var j=m.coords.latitude,C=m.coords.longitude,I=new ue(j,C),q=I.toBounds(m.coords.accuracy*2),J=this._locateOptions;if(J.setView){var we=this.getBoundsZoom(q);this.setView(I,J.maxZoom?Math.min(we,J.maxZoom):we)}var De={latlng:I,bounds:q,timestamp:m.timestamp};for(var ze in m.coords)typeof m.coords[ze]=="number"&&(De[ze]=m.coords[ze]);this.fire("locationfound",De)}},addHandler:function(m,j){if(!j)return this;var C=this[m]=new j(this);return this._handlers.push(C),this.options[m]&&C.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(j){this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),rr(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(F(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var m;for(m in this._layers)this._layers[m].remove();for(m in this._panes)rr(this._panes[m]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(m,j){var C="leaflet-pane"+(m?" leaflet-"+m.replace("Pane","")+"-pane":""),I=kt("div",C,j||this._mapPane);return m&&(this._panes[m]=I),I},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var m=this.getPixelBounds(),j=this.unproject(m.getBottomLeft()),C=this.unproject(m.getTopRight());return new te(j,C)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(m,j,C){m=se(m),C=Z(C||[0,0]);var I=this.getZoom()||0,q=this.getMinZoom(),J=this.getMaxZoom(),we=m.getNorthWest(),De=m.getSouthEast(),ze=this.getSize().subtract(C),ft=X(this.project(De,I),this.project(we,I)).getSize(),$t=pt.any3d?this.options.zoomSnap:1,fr=ze.x/ft.x,Rr=ze.y/ft.y,Si=j?Math.max(fr,Rr):Math.min(fr,Rr);return I=this.getScaleZoom(Si,I),$t&&(I=Math.round(I/($t/100))*($t/100),I=j?Math.ceil(I/$t)*$t:Math.floor(I/$t)*$t),Math.max(q,Math.min(J,I))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new z(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(m,j){var C=this._getTopLeftPoint(m,j);return new G(C,C.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(m){return this.options.crs.getProjectedBounds(m===void 0?this.getZoom():m)},getPane:function(m){return typeof m=="string"?this._panes[m]:m},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(m,j){var C=this.options.crs;return j=j===void 0?this._zoom:j,C.scale(m)/C.scale(j)},getScaleZoom:function(m,j){var C=this.options.crs;j=j===void 0?this._zoom:j;var I=C.zoom(m*C.scale(j));return isNaN(I)?1/0:I},project:function(m,j){return j=j===void 0?this._zoom:j,this.options.crs.latLngToPoint(ye(m),j)},unproject:function(m,j){return j=j===void 0?this._zoom:j,this.options.crs.pointToLatLng(Z(m),j)},layerPointToLatLng:function(m){var j=Z(m).add(this.getPixelOrigin());return this.unproject(j)},latLngToLayerPoint:function(m){var j=this.project(ye(m))._round();return j._subtract(this.getPixelOrigin())},wrapLatLng:function(m){return this.options.crs.wrapLatLng(ye(m))},wrapLatLngBounds:function(m){return this.options.crs.wrapLatLngBounds(se(m))},distance:function(m,j){return this.options.crs.distance(ye(m),ye(j))},containerPointToLayerPoint:function(m){return Z(m).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(m){return Z(m).add(this._getMapPanePos())},containerPointToLatLng:function(m){var j=this.containerPointToLayerPoint(Z(m));return this.layerPointToLatLng(j)},latLngToContainerPoint:function(m){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ye(m)))},mouseEventToContainerPoint:function(m){return tx(m,this._container)},mouseEventToLayerPoint:function(m){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(m))},mouseEventToLatLng:function(m){return this.layerPointToLatLng(this.mouseEventToLayerPoint(m))},_initContainer:function(m){var j=this._container=Pt(m);if(j){if(j._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");dr(j,"scroll",this._onScroll,this),this._containerId=c(j)},_initLayout:function(){var m=this._container;this._fadeAnimated=this.options.fadeAnimation&&pt.any3d,tr(m,"leaflet-container"+(pt.touch?" leaflet-touch":"")+(pt.retina?" leaflet-retina":"")+(pt.ielt9?" leaflet-oldie":"")+(pt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var j=It(m,"position");j!=="absolute"&&j!=="relative"&&j!=="fixed"&&j!=="sticky"&&(m.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var m=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Yr(this._mapPane,new z(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(tr(m.markerPane,"leaflet-zoom-hide"),tr(m.shadowPane,"leaflet-zoom-hide"))},_resetView:function(m,j,C){Yr(this._mapPane,new z(0,0));var I=!this._loaded;this._loaded=!0,j=this._limitZoom(j),this.fire("viewprereset");var q=this._zoom!==j;this._moveStart(q,C)._move(m,j)._moveEnd(q),this.fire("viewreset"),I&&this.fire("load")},_moveStart:function(m,j){return m&&this.fire("zoomstart"),j||this.fire("movestart"),this},_move:function(m,j,C,I){j===void 0&&(j=this._zoom);var q=this._zoom!==j;return this._zoom=j,this._lastCenter=m,this._pixelOrigin=this._getNewPixelOrigin(m),I?C&&C.pinch&&this.fire("zoom",C):((q||C&&C.pinch)&&this.fire("zoom",C),this.fire("move",C)),this},_moveEnd:function(m){return m&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return F(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(m){Yr(this._mapPane,this._getMapPanePos().subtract(m))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(m){this._targets={},this._targets[c(this._container)]=this;var j=m?cn:dr;j(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&j(window,"resize",this._onResize,this),pt.any3d&&this.options.transform3DLimit&&(m?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){F(this._resizeRequest),this._resizeRequest=R(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var m=this._getMapPanePos();Math.max(Math.abs(m.x),Math.abs(m.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(m,j){for(var C=[],I,q=j==="mouseout"||j==="mouseover",J=m.target||m.srcElement,we=!1;J;){if(I=this._targets[c(J)],I&&(j==="click"||j==="preclick")&&this._draggableMoved(I)){we=!0;break}if(I&&I.listens(j,!0)&&(q&&!bf(J,m)||(C.push(I),q))||J===this._container)break;J=J.parentNode}return!C.length&&!we&&!q&&this.listens(j,!0)&&(C=[this]),C},_isClickDisabled:function(m){for(;m&&m!==this._container;){if(m._leaflet_disable_click)return!0;m=m.parentNode}},_handleDOMEvent:function(m){var j=m.target||m.srcElement;if(!(!this._loaded||j._leaflet_disable_events||m.type==="click"&&this._isClickDisabled(j))){var C=m.type;C==="mousedown"&&ma(j),this._fireDOMEvent(m,C)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(m,j,C){if(m.type==="click"){var I=i({},m);I.type="preclick",this._fireDOMEvent(I,I.type,C)}var q=this._findEventTargets(m,j);if(C){for(var J=[],we=0;we<C.length;we++)C[we].listens(j,!0)&&J.push(C[we]);q=J.concat(q)}if(q.length){j==="contextmenu"&&gs(m);var De=q[0],ze={originalEvent:m};if(m.type!=="keypress"&&m.type!=="keydown"&&m.type!=="keyup"){var ft=De.getLatLng&&(!De._radius||De._radius<=10);ze.containerPoint=ft?this.latLngToContainerPoint(De.getLatLng()):this.mouseEventToContainerPoint(m),ze.layerPoint=this.containerPointToLayerPoint(ze.containerPoint),ze.latlng=ft?De.getLatLng():this.layerPointToLatLng(ze.layerPoint)}for(we=0;we<q.length;we++)if(q[we].fire(j,ze,!0),ze.originalEvent._stopped||q[we].options.bubblingMouseEvents===!1&&N(this._mouseEvents,j)!==-1)return}},_draggableMoved:function(m){return m=m.dragging&&m.dragging.enabled()?m:this,m.dragging&&m.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var m=0,j=this._handlers.length;m<j;m++)this._handlers[m].disable()},whenReady:function(m,j){return this._loaded?m.call(j||this,{target:this}):this.on("load",m,j),this},_getMapPanePos:function(){return Ns(this._mapPane)||new z(0,0)},_moved:function(){var m=this._getMapPanePos();return m&&!m.equals([0,0])},_getTopLeftPoint:function(m,j){var C=m&&j!==void 0?this._getNewPixelOrigin(m,j):this.getPixelOrigin();return C.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(m,j){var C=this.getSize()._divideBy(2);return this.project(m,j)._subtract(C)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(m,j,C){var I=this._getNewPixelOrigin(C,j);return this.project(m,j)._subtract(I)},_latLngBoundsToNewLayerBounds:function(m,j,C){var I=this._getNewPixelOrigin(C,j);return X([this.project(m.getSouthWest(),j)._subtract(I),this.project(m.getNorthWest(),j)._subtract(I),this.project(m.getSouthEast(),j)._subtract(I),this.project(m.getNorthEast(),j)._subtract(I)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(m){return this.latLngToLayerPoint(m).subtract(this._getCenterLayerPoint())},_limitCenter:function(m,j,C){if(!C)return m;var I=this.project(m,j),q=this.getSize().divideBy(2),J=new G(I.subtract(q),I.add(q)),we=this._getBoundsOffset(J,C,j);return Math.abs(we.x)<=1&&Math.abs(we.y)<=1?m:this.unproject(I.add(we),j)},_limitOffset:function(m,j){if(!j)return m;var C=this.getPixelBounds(),I=new G(C.min.add(m),C.max.add(m));return m.add(this._getBoundsOffset(I,j))},_getBoundsOffset:function(m,j,C){var I=X(this.project(j.getNorthEast(),C),this.project(j.getSouthWest(),C)),q=I.min.subtract(m.min),J=I.max.subtract(m.max),we=this._rebound(q.x,-J.x),De=this._rebound(q.y,-J.y);return new z(we,De)},_rebound:function(m,j){return m+j>0?Math.round(m-j)/2:Math.max(0,Math.ceil(m))-Math.max(0,Math.floor(j))},_limitZoom:function(m){var j=this.getMinZoom(),C=this.getMaxZoom(),I=pt.any3d?this.options.zoomSnap:1;return I&&(m=Math.round(m/I)*I),Math.max(j,Math.min(C,m))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Gr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(m,j){var C=this._getCenterOffset(m)._trunc();return(j&&j.animate)!==!0&&!this.getSize().contains(C)?!1:(this.panBy(C,j),!0)},_createAnimProxy:function(){var m=this._proxy=kt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(m),this.on("zoomanim",function(j){var C=ms,I=this._proxy.style[C];zn(this._proxy,this.project(j.center,j.zoom),this.getZoomScale(j.zoom,1)),I===this._proxy.style[C]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){rr(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var m=this.getCenter(),j=this.getZoom();zn(this._proxy,this.project(m,j),this.getZoomScale(j,1))},_catchTransitionEnd:function(m){this._animatingZoom&&m.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(m,j,C){if(this._animatingZoom)return!0;if(C=C||{},!this._zoomAnimated||C.animate===!1||this._nothingToAnimate()||Math.abs(j-this._zoom)>this.options.zoomAnimationThreshold)return!1;var I=this.getZoomScale(j),q=this._getCenterOffset(m)._divideBy(1-1/I);return C.animate!==!0&&!this.getSize().contains(q)?!1:(R(function(){this._moveStart(!0,C.noMoveStart||!1)._animateZoom(m,j,!0)},this),!0)},_animateZoom:function(m,j,C,I){this._mapPane&&(C&&(this._animatingZoom=!0,this._animateToCenter=m,this._animateToZoom=j,tr(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:m,zoom:j,noUpdate:I}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Gr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function sx(m,j){return new Ir(m,j)}var zi=B.extend({options:{position:"topright"},initialize:function(m){g(this,m)},getPosition:function(){return this.options.position},setPosition:function(m){var j=this._map;return j&&j.removeControl(this),this.options.position=m,j&&j.addControl(this),this},getContainer:function(){return this._container},addTo:function(m){this.remove(),this._map=m;var j=this._container=this.onAdd(m),C=this.getPosition(),I=m._controlCorners[C];return tr(j,"leaflet-control"),C.indexOf("bottom")!==-1?I.insertBefore(j,I.firstChild):I.appendChild(j),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(rr(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(m){this._map&&m&&m.screenX>0&&m.screenY>0&&this._map.getContainer().focus()}}),Dc=function(m){return new zi(m)};Ir.include({addControl:function(m){return m.addTo(this),this},removeControl:function(m){return m.remove(),this},_initControlPos:function(){var m=this._controlCorners={},j="leaflet-",C=this._controlContainer=kt("div",j+"control-container",this._container);function I(q,J){var we=j+q+" "+j+J;m[q+J]=kt("div",we,C)}I("top","left"),I("top","right"),I("bottom","left"),I("bottom","right")},_clearControlPos:function(){for(var m in this._controlCorners)rr(this._controlCorners[m]);rr(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var jp=zi.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(m,j,C,I){return C<I?-1:I<C?1:0}},initialize:function(m,j,C){g(this,C),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var I in m)this._addLayer(m[I],I);for(I in j)this._addLayer(j[I],I,!0)},onAdd:function(m){this._initLayout(),this._update(),this._map=m,m.on("zoomend",this._checkDisabledLayers,this);for(var j=0;j<this._layers.length;j++)this._layers[j].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(m){return zi.prototype.addTo.call(this,m),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var m=0;m<this._layers.length;m++)this._layers[m].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(m,j){return this._addLayer(m,j),this._map?this._update():this},addOverlay:function(m,j){return this._addLayer(m,j,!0),this._map?this._update():this},removeLayer:function(m){m.off("add remove",this._onLayerChange,this);var j=this._getLayer(c(m));return j&&this._layers.splice(this._layers.indexOf(j),1),this._map?this._update():this},expand:function(){tr(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var m=this._map.getSize().y-(this._container.offsetTop+50);return m<this._section.clientHeight?(tr(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=m+"px"):Gr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Gr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var m="leaflet-control-layers",j=this._container=kt("div",m),C=this.options.collapsed;j.setAttribute("aria-haspopup",!0),qd(j),Wo(j);var I=this._section=kt("section",m+"-list");C&&(this._map.on("click",this.collapse,this),dr(j,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var q=this._layersLink=kt("a",m+"-toggle",j);q.href="#",q.title="Layers",q.setAttribute("role","button"),dr(q,{keydown:function(J){J.keyCode===13&&this._expandSafely()},click:function(J){gs(J),this._expandSafely()}},this),C||this.expand(),this._baseLayersList=kt("div",m+"-base",I),this._separator=kt("div",m+"-separator",I),this._overlaysList=kt("div",m+"-overlays",I),j.appendChild(I)},_getLayer:function(m){for(var j=0;j<this._layers.length;j++)if(this._layers[j]&&c(this._layers[j].layer)===m)return this._layers[j]},_addLayer:function(m,j,C){this._map&&m.on("add remove",this._onLayerChange,this),this._layers.push({layer:m,name:j,overlay:C}),this.options.sortLayers&&this._layers.sort(o(function(I,q){return this.options.sortFunction(I.layer,q.layer,I.name,q.name)},this)),this.options.autoZIndex&&m.setZIndex&&(this._lastZIndex++,m.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;mr(this._baseLayersList),mr(this._overlaysList),this._layerControlInputs=[];var m,j,C,I,q=0;for(C=0;C<this._layers.length;C++)I=this._layers[C],this._addItem(I),j=j||I.overlay,m=m||!I.overlay,q+=I.overlay?0:1;return this.options.hideSingleBase&&(m=m&&q>1,this._baseLayersList.style.display=m?"":"none"),this._separator.style.display=j&&m?"":"none",this},_onLayerChange:function(m){this._handlingClick||this._update();var j=this._getLayer(c(m.target)),C=j.overlay?m.type==="add"?"overlayadd":"overlayremove":m.type==="add"?"baselayerchange":null;C&&this._map.fire(C,j)},_createRadioElement:function(m,j){var C='<input type="radio" class="leaflet-control-layers-selector" name="'+m+'"'+(j?' checked="checked"':"")+"/>",I=document.createElement("div");return I.innerHTML=C,I.firstChild},_addItem:function(m){var j=document.createElement("label"),C=this._map.hasLayer(m.layer),I;m.overlay?(I=document.createElement("input"),I.type="checkbox",I.className="leaflet-control-layers-selector",I.defaultChecked=C):I=this._createRadioElement("leaflet-base-layers_"+c(this),C),this._layerControlInputs.push(I),I.layerId=c(m.layer),dr(I,"click",this._onInputClick,this);var q=document.createElement("span");q.innerHTML=" "+m.name;var J=document.createElement("span");j.appendChild(J),J.appendChild(I),J.appendChild(q);var we=m.overlay?this._overlaysList:this._baseLayersList;return we.appendChild(j),this._checkDisabledLayers(),j},_onInputClick:function(){if(!this._preventClick){var m=this._layerControlInputs,j,C,I=[],q=[];this._handlingClick=!0;for(var J=m.length-1;J>=0;J--)j=m[J],C=this._getLayer(j.layerId).layer,j.checked?I.push(C):j.checked||q.push(C);for(J=0;J<q.length;J++)this._map.hasLayer(q[J])&&this._map.removeLayer(q[J]);for(J=0;J<I.length;J++)this._map.hasLayer(I[J])||this._map.addLayer(I[J]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var m=this._layerControlInputs,j,C,I=this._map.getZoom(),q=m.length-1;q>=0;q--)j=m[q],C=this._getLayer(j.layerId).layer,j.disabled=C.options.minZoom!==void 0&&I<C.options.minZoom||C.options.maxZoom!==void 0&&I>C.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var m=this._section;this._preventClick=!0,dr(m,"click",gs),this.expand();var j=this;setTimeout(function(){cn(m,"click",gs),j._preventClick=!1})}}),ix=function(m,j,C){return new jp(m,j,C)},de=zi.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(m){var j="leaflet-control-zoom",C=kt("div",j+" leaflet-bar"),I=this.options;return this._zoomInButton=this._createButton(I.zoomInText,I.zoomInTitle,j+"-in",C,this._zoomIn),this._zoomOutButton=this._createButton(I.zoomOutText,I.zoomOutTitle,j+"-out",C,this._zoomOut),this._updateDisabled(),m.on("zoomend zoomlevelschange",this._updateDisabled,this),C},onRemove:function(m){m.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(m){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(m.shiftKey?3:1))},_zoomOut:function(m){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(m.shiftKey?3:1))},_createButton:function(m,j,C,I,q){var J=kt("a",C,I);return J.innerHTML=m,J.href="#",J.title=j,J.setAttribute("role","button"),J.setAttribute("aria-label",j),qd(J),dr(J,"click",Rl),dr(J,"click",q,this),dr(J,"click",this._refocusOnMap,this),J},_updateDisabled:function(){var m=this._map,j="leaflet-disabled";Gr(this._zoomInButton,j),Gr(this._zoomOutButton,j),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||m._zoom===m.getMinZoom())&&(tr(this._zoomOutButton,j),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||m._zoom===m.getMaxZoom())&&(tr(this._zoomInButton,j),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ir.mergeOptions({zoomControl:!0}),Ir.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new de,this.addControl(this.zoomControl))});var Ce=function(m){return new de(m)},tt=zi.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(m){var j="leaflet-control-scale",C=kt("div",j),I=this.options;return this._addScales(I,j+"-line",C),m.on(I.updateWhenIdle?"moveend":"move",this._update,this),m.whenReady(this._update,this),C},onRemove:function(m){m.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(m,j,C){m.metric&&(this._mScale=kt("div",j,C)),m.imperial&&(this._iScale=kt("div",j,C))},_update:function(){var m=this._map,j=m.getSize().y/2,C=m.distance(m.containerPointToLatLng([0,j]),m.containerPointToLatLng([this.options.maxWidth,j]));this._updateScales(C)},_updateScales:function(m){this.options.metric&&m&&this._updateMetric(m),this.options.imperial&&m&&this._updateImperial(m)},_updateMetric:function(m){var j=this._getRoundNum(m),C=j<1e3?j+" m":j/1e3+" km";this._updateScale(this._mScale,C,j/m)},_updateImperial:function(m){var j=m*3.2808399,C,I,q;j>5280?(C=j/5280,I=this._getRoundNum(C),this._updateScale(this._iScale,I+" mi",I/C)):(q=this._getRoundNum(j),this._updateScale(this._iScale,q+" ft",q/j))},_updateScale:function(m,j,C){m.style.width=Math.round(this.options.maxWidth*C)+"px",m.innerHTML=j},_getRoundNum:function(m){var j=Math.pow(10,(Math.floor(m)+"").length-1),C=m/j;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:1,j*C}}),je=function(m){return new tt(m)},Zt='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',At=zi.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(pt.inlineSvg?Zt+" ":"")+"Leaflet</a>"},initialize:function(m){g(this,m),this._attributions={}},onAdd:function(m){m.attributionControl=this,this._container=kt("div","leaflet-control-attribution"),qd(this._container);for(var j in m._layers)m._layers[j].getAttribution&&this.addAttribution(m._layers[j].getAttribution());return this._update(),m.on("layeradd",this._addAttribution,this),this._container},onRemove:function(m){m.off("layeradd",this._addAttribution,this)},_addAttribution:function(m){m.layer.getAttribution&&(this.addAttribution(m.layer.getAttribution()),m.layer.once("remove",function(){this.removeAttribution(m.layer.getAttribution())},this))},setPrefix:function(m){return this.options.prefix=m,this._update(),this},addAttribution:function(m){return m?(this._attributions[m]||(this._attributions[m]=0),this._attributions[m]++,this._update(),this):this},removeAttribution:function(m){return m?(this._attributions[m]&&(this._attributions[m]--,this._update()),this):this},_update:function(){if(this._map){var m=[];for(var j in this._attributions)this._attributions[j]&&m.push(j);var C=[];this.options.prefix&&C.push(this.options.prefix),m.length&&C.push(m.join(", ")),this._container.innerHTML=C.join(' <span aria-hidden="true">|</span> ')}}});Ir.mergeOptions({attributionControl:!0}),Ir.addInitHook(function(){this.options.attributionControl&&new At().addTo(this)});var Ot=function(m){return new At(m)};zi.Layers=jp,zi.Zoom=de,zi.Scale=tt,zi.Attribution=At,Dc.layers=ix,Dc.zoom=Ce,Dc.scale=je,Dc.attribution=Ot;var Tt=B.extend({initialize:function(m){this._map=m},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Tt.addTo=function(m,j){return m.addHandler(j,this),this};var vr={Events:V},Tr=pt.touch?"touchstart mousedown":"mousedown",nr=Y.extend({options:{clickTolerance:3},initialize:function(m,j,C,I){g(this,I),this._element=m,this._dragStartTarget=j||m,this._preventOutline=C},enable:function(){this._enabled||(dr(this._dragStartTarget,Tr,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(nr._dragging===this&&this.finishDrag(!0),cn(this._dragStartTarget,Tr,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(m){if(this._enabled&&(this._moved=!1,!bi(this._element,"leaflet-zoom-anim"))){if(m.touches&&m.touches.length!==1){nr._dragging===this&&this.finishDrag();return}if(!(nr._dragging||m.shiftKey||m.which!==1&&m.button!==1&&!m.touches)&&(nr._dragging=this,this._preventOutline&&ma(this._element),Nr(),Ta(),!this._moving)){this.fire("down");var j=m.touches?m.touches[0]:m,C=yn(this._element);this._startPoint=new z(j.clientX,j.clientY),this._startPos=Ns(this._element),this._parentScale=Qn(C);var I=m.type==="mousedown";dr(document,I?"mousemove":"touchmove",this._onMove,this),dr(document,I?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(m){if(this._enabled){if(m.touches&&m.touches.length>1){this._moved=!0;return}var j=m.touches&&m.touches.length===1?m.touches[0]:m,C=new z(j.clientX,j.clientY)._subtract(this._startPoint);!C.x&&!C.y||Math.abs(C.x)+Math.abs(C.y)<this.options.clickTolerance||(C.x/=this._parentScale.x,C.y/=this._parentScale.y,gs(m),this._moved||(this.fire("dragstart"),this._moved=!0,tr(document.body,"leaflet-dragging"),this._lastTarget=m.target||m.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),tr(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(C),this._moving=!0,this._lastEvent=m,this._updatePosition())}},_updatePosition:function(){var m={originalEvent:this._lastEvent};this.fire("predrag",m),Yr(this._element,this._newPos),this.fire("drag",m)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(m){Gr(document.body,"leaflet-dragging"),this._lastTarget&&(Gr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),cn(document,"mousemove touchmove",this._onMove,this),cn(document,"mouseup touchend touchcancel",this._onUp,this),zr(),qo();var j=this._moved&&this._moving;this._moving=!1,nr._dragging=!1,j&&this.fire("dragend",{noInertia:m,distance:this._newPos.distanceTo(this._startPos)})}});function Kr(m,j,C){var I,q=[1,4,2,8],J,we,De,ze,ft,$t,fr,Rr;for(J=0,$t=m.length;J<$t;J++)m[J]._code=Ho(m[J],j);for(De=0;De<4;De++){for(fr=q[De],I=[],J=0,$t=m.length,we=$t-1;J<$t;we=J++)ze=m[J],ft=m[we],ze._code&fr?ft._code&fr||(Rr=Wd(ft,ze,fr,j,C),Rr._code=Ho(Rr,j),I.push(Rr)):(ft._code&fr&&(Rr=Wd(ft,ze,fr,j,C),Rr._code=Ho(Rr,j),I.push(Rr)),I.push(ze));m=I}return m}function cs(m,j){var C,I,q,J,we,De,ze,ft,$t;if(!m||m.length===0)throw new Error("latlngs not passed");Ni(m)||(console.warn("latlngs are not flat! Only the first ring will be used"),m=m[0]);var fr=ye([0,0]),Rr=se(m),Si=Rr.getNorthWest().distanceTo(Rr.getSouthWest())*Rr.getNorthEast().distanceTo(Rr.getNorthWest());Si<1700&&(fr=Qt(m));var Us=m.length,Oa=[];for(C=0;C<Us;C++){var Vi=ye(m[C]);Oa.push(j.project(ye([Vi.lat-fr.lat,Vi.lng-fr.lng])))}for(De=ze=ft=0,C=0,I=Us-1;C<Us;I=C++)q=Oa[C],J=Oa[I],we=q.y*J.x-J.y*q.x,ze+=(q.x+J.x)*we,ft+=(q.y+J.y)*we,De+=we*3;De===0?$t=Oa[0]:$t=[ze/De,ft/De];var Cf=j.unproject(Z($t));return ye([Cf.lat+fr.lat,Cf.lng+fr.lng])}function Qt(m){for(var j=0,C=0,I=0,q=0;q<m.length;q++){var J=ye(m[q]);j+=J.lat,C+=J.lng,I++}return ye([j/I,C/I])}var Br={__proto__:null,clipPolygon:Kr,polygonCenter:cs,centroid:Qt};function En(m,j){if(!j||!m.length)return m.slice();var C=j*j;return m=un(m,C),m=ei(m,C),m}function yr(m,j,C){return Math.sqrt(Ic(m,j,C,!0))}function Yt(m,j,C){return Ic(m,j,C)}function ei(m,j){var C=m.length,I=typeof Uint8Array!="undefined"?Uint8Array:Array,q=new I(C);q[0]=q[C-1]=1,ur(m,q,j,0,C-1);var J,we=[];for(J=0;J<C;J++)q[J]&&we.push(m[J]);return we}function ur(m,j,C,I,q){var J=0,we,De,ze;for(De=I+1;De<=q-1;De++)ze=Ic(m[De],m[I],m[q],!0),ze>J&&(we=De,J=ze);J>C&&(j[we]=1,ur(m,j,C,I,we),ur(m,j,C,we,q))}function un(m,j){for(var C=[m[0]],I=1,q=0,J=m.length;I<J;I++)ax(m[I],m[q])>j&&(C.push(m[I]),q=I);return q<J-1&&C.push(m[J-1]),C}var Np;function Sp(m,j,C,I,q){var J=I?Np:Ho(m,C),we=Ho(j,C),De,ze,ft;for(Np=we;;){if(!(J|we))return[m,j];if(J&we)return!1;De=J||we,ze=Wd(m,j,De,C,q),ft=Ho(ze,C),De===J?(m=ze,J=ft):(j=ze,we=ft)}}function Wd(m,j,C,I,q){var J=j.x-m.x,we=j.y-m.y,De=I.min,ze=I.max,ft,$t;return C&8?(ft=m.x+J*(ze.y-m.y)/we,$t=ze.y):C&4?(ft=m.x+J*(De.y-m.y)/we,$t=De.y):C&2?(ft=ze.x,$t=m.y+we*(ze.x-m.x)/J):C&1&&(ft=De.x,$t=m.y+we*(De.x-m.x)/J),new z(ft,$t,q)}function Ho(m,j){var C=0;return m.x<j.min.x?C|=1:m.x>j.max.x&&(C|=2),m.y<j.min.y?C|=4:m.y>j.max.y&&(C|=8),C}function ax(m,j){var C=j.x-m.x,I=j.y-m.y;return C*C+I*I}function Ic(m,j,C,I){var q=j.x,J=j.y,we=C.x-q,De=C.y-J,ze=we*we+De*De,ft;return ze>0&&(ft=((m.x-q)*we+(m.y-J)*De)/ze,ft>1?(q=C.x,J=C.y):ft>0&&(q+=we*ft,J+=De*ft)),we=m.x-q,De=m.y-J,I?we*we+De*De:new z(q,J)}function Ni(m){return!b(m[0])||typeof m[0][0]!="object"&&typeof m[0][0]!="undefined"}function kp(m){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ni(m)}function WC(m,j){var C,I,q,J,we,De,ze,ft;if(!m||m.length===0)throw new Error("latlngs not passed");Ni(m)||(console.warn("latlngs are not flat! Only the first ring will be used"),m=m[0]);var $t=ye([0,0]),fr=se(m),Rr=fr.getNorthWest().distanceTo(fr.getSouthWest())*fr.getNorthEast().distanceTo(fr.getNorthWest());Rr<1700&&($t=Qt(m));var Si=m.length,Us=[];for(C=0;C<Si;C++){var Oa=ye(m[C]);Us.push(j.project(ye([Oa.lat-$t.lat,Oa.lng-$t.lng])))}for(C=0,I=0;C<Si-1;C++)I+=Us[C].distanceTo(Us[C+1])/2;if(I===0)ft=Us[0];else for(C=0,J=0;C<Si-1;C++)if(we=Us[C],De=Us[C+1],q=we.distanceTo(De),J+=q,J>I){ze=(J-I)/q,ft=[De.x-ze*(De.x-we.x),De.y-ze*(De.y-we.y)];break}var Vi=j.unproject(Z(ft));return ye([Vi.lat+$t.lat,Vi.lng+$t.lng])}var mY={__proto__:null,simplify:En,pointToSegmentDistance:yr,closestPointOnSegment:Yt,clipSegment:Sp,_getEdgeIntersection:Wd,_getBitCode:Ho,_sqClosestPointOnSegment:Ic,isFlat:Ni,_flat:kp,polylineCenter:WC},hb={project:function(m){return new z(m.lng,m.lat)},unproject:function(m){return new ue(m.y,m.x)},bounds:new G([-180,-90],[180,90])},mb={R:6378137,R_MINOR:6356752314245179e-9,bounds:new G([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(m){var j=Math.PI/180,C=this.R,I=m.lat*j,q=this.R_MINOR/C,J=Math.sqrt(1-q*q),we=J*Math.sin(I),De=Math.tan(Math.PI/4-I/2)/Math.pow((1-we)/(1+we),J/2);return I=-C*Math.log(Math.max(De,1e-10)),new z(m.lng*j*C,I)},unproject:function(m){for(var j=180/Math.PI,C=this.R,I=this.R_MINOR/C,q=Math.sqrt(1-I*I),J=Math.exp(-m.y/C),we=Math.PI/2-2*Math.atan(J),De=0,ze=.1,ft;De<15&&Math.abs(ze)>1e-7;De++)ft=q*Math.sin(we),ft=Math.pow((1-ft)/(1+ft),q/2),ze=Math.PI/2-2*Math.atan(J*ft)-we,we+=ze;return new ue(we*j,m.x*j/C)}},pY={__proto__:null,LonLat:hb,Mercator:mb,SphericalMercator:ie},gY=i({},xe,{code:"EPSG:3395",projection:mb,transformation:function(){var m=.5/(Math.PI*mb.R);return H(m,.5,-m,.5)}()}),HC=i({},xe,{code:"EPSG:4326",projection:hb,transformation:H(1/180,1,-1/180,.5)}),vY=i({},ne,{projection:hb,transformation:H(1,0,-1,0),scale:function(m){return Math.pow(2,m)},zoom:function(m){return Math.log(m)/Math.LN2},distance:function(m,j){var C=j.lng-m.lng,I=j.lat-m.lat;return Math.sqrt(C*C+I*I)},infinite:!0});ne.Earth=xe,ne.EPSG3395=gY,ne.EPSG3857=le,ne.EPSG900913=Se,ne.EPSG4326=HC,ne.Simple=vY;var io=Y.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(m){return m.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(m){return m&&m.removeLayer(this),this},getPane:function(m){return this._map.getPane(m?this.options[m]||m:this.options.pane)},addInteractiveTarget:function(m){return this._map._targets[c(m)]=this,this},removeInteractiveTarget:function(m){return delete this._map._targets[c(m)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(m){var j=m.target;if(j.hasLayer(this)){if(this._map=j,this._zoomAnimated=j._zoomAnimated,this.getEvents){var C=this.getEvents();j.on(C,this),this.once("remove",function(){j.off(C,this)},this)}this.onAdd(j),this.fire("add"),j.fire("layeradd",{layer:this})}}});Ir.include({addLayer:function(m){if(!m._layerAdd)throw new Error("The provided object is not a Layer.");var j=c(m);return this._layers[j]?this:(this._layers[j]=m,m._mapToAdd=this,m.beforeAdd&&m.beforeAdd(this),this.whenReady(m._layerAdd,m),this)},removeLayer:function(m){var j=c(m);return this._layers[j]?(this._loaded&&m.onRemove(this),delete this._layers[j],this._loaded&&(this.fire("layerremove",{layer:m}),m.fire("remove")),m._map=m._mapToAdd=null,this):this},hasLayer:function(m){return c(m)in this._layers},eachLayer:function(m,j){for(var C in this._layers)m.call(j,this._layers[C]);return this},_addLayers:function(m){m=m?b(m)?m:[m]:[];for(var j=0,C=m.length;j<C;j++)this.addLayer(m[j])},_addZoomLimit:function(m){(!isNaN(m.options.maxZoom)||!isNaN(m.options.minZoom))&&(this._zoomBoundLayers[c(m)]=m,this._updateZoomLevels())},_removeZoomLimit:function(m){var j=c(m);this._zoomBoundLayers[j]&&(delete this._zoomBoundLayers[j],this._updateZoomLevels())},_updateZoomLevels:function(){var m=1/0,j=-1/0,C=this._getZoomSpan();for(var I in this._zoomBoundLayers){var q=this._zoomBoundLayers[I].options;m=q.minZoom===void 0?m:Math.min(m,q.minZoom),j=q.maxZoom===void 0?j:Math.max(j,q.maxZoom)}this._layersMaxZoom=j===-1/0?void 0:j,this._layersMinZoom=m===1/0?void 0:m,C!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var jf=io.extend({initialize:function(m,j){g(this,j),this._layers={};var C,I;if(m)for(C=0,I=m.length;C<I;C++)this.addLayer(m[C])},addLayer:function(m){var j=this.getLayerId(m);return this._layers[j]=m,this._map&&this._map.addLayer(m),this},removeLayer:function(m){var j=m in this._layers?m:this.getLayerId(m);return this._map&&this._layers[j]&&this._map.removeLayer(this._layers[j]),delete this._layers[j],this},hasLayer:function(m){var j=typeof m=="number"?m:this.getLayerId(m);return j in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(m){var j=Array.prototype.slice.call(arguments,1),C,I;for(C in this._layers)I=this._layers[C],I[m]&&I[m].apply(I,j);return this},onAdd:function(m){this.eachLayer(m.addLayer,m)},onRemove:function(m){this.eachLayer(m.removeLayer,m)},eachLayer:function(m,j){for(var C in this._layers)m.call(j,this._layers[C]);return this},getLayer:function(m){return this._layers[m]},getLayers:function(){var m=[];return this.eachLayer(m.push,m),m},setZIndex:function(m){return this.invoke("setZIndex",m)},getLayerId:function(m){return c(m)}}),xY=function(m,j){return new jf(m,j)},Ml=jf.extend({addLayer:function(m){return this.hasLayer(m)?this:(m.addEventParent(this),jf.prototype.addLayer.call(this,m),this.fire("layeradd",{layer:m}))},removeLayer:function(m){return this.hasLayer(m)?(m in this._layers&&(m=this._layers[m]),m.removeEventParent(this),jf.prototype.removeLayer.call(this,m),this.fire("layerremove",{layer:m})):this},setStyle:function(m){return this.invoke("setStyle",m)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var m=new te;for(var j in this._layers){var C=this._layers[j];m.extend(C.getBounds?C.getBounds():C.getLatLng())}return m}}),yY=function(m,j){return new Ml(m,j)},Nf=B.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(m){g(this,m)},createIcon:function(m){return this._createIcon("icon",m)},createShadow:function(m){return this._createIcon("shadow",m)},_createIcon:function(m,j){var C=this._getIconUrl(m);if(!C){if(m==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var I=this._createImg(C,j&&j.tagName==="IMG"?j:null);return this._setIconStyles(I,m),(this.options.crossOrigin||this.options.crossOrigin==="")&&(I.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),I},_setIconStyles:function(m,j){var C=this.options,I=C[j+"Size"];typeof I=="number"&&(I=[I,I]);var q=Z(I),J=Z(j==="shadow"&&C.shadowAnchor||C.iconAnchor||q&&q.divideBy(2,!0));m.className="leaflet-marker-"+j+" "+(C.className||""),J&&(m.style.marginLeft=-J.x+"px",m.style.marginTop=-J.y+"px"),q&&(m.style.width=q.x+"px",m.style.height=q.y+"px")},_createImg:function(m,j){return j=j||document.createElement("img"),j.src=m,j},_getIconUrl:function(m){return pt.retina&&this.options[m+"RetinaUrl"]||this.options[m+"Url"]}});function _Y(m){return new Nf(m)}var Ep=Nf.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(m){return typeof Ep.imagePath!="string"&&(Ep.imagePath=this._detectIconPath()),(this.options.imagePath||Ep.imagePath)+Nf.prototype._getIconUrl.call(this,m)},_stripUrl:function(m){var j=function(C,I,q){var J=I.exec(C);return J&&J[q]};return m=j(m,/^url\((['"])?(.+)\1\)$/,2),m&&j(m,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var m=kt("div","leaflet-default-icon-path",document.body),j=It(m,"background-image")||It(m,"backgroundImage");if(document.body.removeChild(m),j=this._stripUrl(j),j)return j;var C=document.querySelector('link[href$="leaflet.css"]');return C?C.href.substring(0,C.href.length-11-1):""}}),GC=Tt.extend({initialize:function(m){this._marker=m},addHooks:function(){var m=this._marker._icon;this._draggable||(this._draggable=new nr(m,m,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),tr(m,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Gr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(m){var j=this._marker,C=j._map,I=this._marker.options.autoPanSpeed,q=this._marker.options.autoPanPadding,J=Ns(j._icon),we=C.getPixelBounds(),De=C.getPixelOrigin(),ze=X(we.min._subtract(De).add(q),we.max._subtract(De).subtract(q));if(!ze.contains(J)){var ft=Z((Math.max(ze.max.x,J.x)-ze.max.x)/(we.max.x-ze.max.x)-(Math.min(ze.min.x,J.x)-ze.min.x)/(we.min.x-ze.min.x),(Math.max(ze.max.y,J.y)-ze.max.y)/(we.max.y-ze.max.y)-(Math.min(ze.min.y,J.y)-ze.min.y)/(we.min.y-ze.min.y)).multiplyBy(I);C.panBy(ft,{animate:!1}),this._draggable._newPos._add(ft),this._draggable._startPos._add(ft),Yr(j._icon,this._draggable._newPos),this._onDrag(m),this._panRequest=R(this._adjustPan.bind(this,m))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(m){this._marker.options.autoPan&&(F(this._panRequest),this._panRequest=R(this._adjustPan.bind(this,m)))},_onDrag:function(m){var j=this._marker,C=j._shadow,I=Ns(j._icon),q=j._map.layerPointToLatLng(I);C&&Yr(C,I),j._latlng=q,m.latlng=q,m.oldLatLng=this._oldLatLng,j.fire("move",m).fire("drag",m)},_onDragEnd:function(m){F(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",m)}}),ox=io.extend({options:{icon:new Ep,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(m,j){g(this,j),this._latlng=ye(m)},onAdd:function(m){this._zoomAnimated=this._zoomAnimated&&m.options.markerZoomAnimation,this._zoomAnimated&&m.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(m){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&m.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(m){var j=this._latlng;return this._latlng=ye(m),this.update(),this.fire("move",{oldLatLng:j,latlng:this._latlng})},setZIndexOffset:function(m){return this.options.zIndexOffset=m,this.update()},getIcon:function(){return this.options.icon},setIcon:function(m){return this.options.icon=m,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var m=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(m)}return this},_initIcon:function(){var m=this.options,j="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),C=m.icon.createIcon(this._icon),I=!1;C!==this._icon&&(this._icon&&this._removeIcon(),I=!0,m.title&&(C.title=m.title),C.tagName==="IMG"&&(C.alt=m.alt||"")),tr(C,j),m.keyboard&&(C.tabIndex="0",C.setAttribute("role","button")),this._icon=C,m.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&dr(C,"focus",this._panOnFocus,this);var q=m.icon.createShadow(this._shadow),J=!1;q!==this._shadow&&(this._removeShadow(),J=!0),q&&(tr(q,j),q.alt=""),this._shadow=q,m.opacity<1&&this._updateOpacity(),I&&this.getPane().appendChild(this._icon),this._initInteraction(),q&&J&&this.getPane(m.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&cn(this._icon,"focus",this._panOnFocus,this),rr(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&rr(this._shadow),this._shadow=null},_setPos:function(m){this._icon&&Yr(this._icon,m),this._shadow&&Yr(this._shadow,m),this._zIndex=m.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(m){this._icon&&(this._icon.style.zIndex=this._zIndex+m)},_animateZoom:function(m){var j=this._map._latLngToNewLayerPoint(this._latlng,m.zoom,m.center).round();this._setPos(j)},_initInteraction:function(){if(this.options.interactive&&(tr(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),GC)){var m=this.options.draggable;this.dragging&&(m=this.dragging.enabled(),this.dragging.disable()),this.dragging=new GC(this),m&&this.dragging.enable()}},setOpacity:function(m){return this.options.opacity=m,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var m=this.options.opacity;this._icon&&Dr(this._icon,m),this._shadow&&Dr(this._shadow,m)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var m=this._map;if(m){var j=this.options.icon.options,C=j.iconSize?Z(j.iconSize):Z(0,0),I=j.iconAnchor?Z(j.iconAnchor):Z(0,0);m.panInside(this._latlng,{paddingTopLeft:I,paddingBottomRight:C.subtract(I)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function wY(m,j){return new ox(m,j)}var $c=io.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(m){this._renderer=m.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(m){return g(this,m),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&m&&Object.prototype.hasOwnProperty.call(m,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),lx=$c.extend({options:{fill:!0,radius:10},initialize:function(m,j){g(this,j),this._latlng=ye(m),this._radius=this.options.radius},setLatLng:function(m){var j=this._latlng;return this._latlng=ye(m),this.redraw(),this.fire("move",{oldLatLng:j,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(m){return this.options.radius=this._radius=m,this.redraw()},getRadius:function(){return this._radius},setStyle:function(m){var j=m&&m.radius||this._radius;return $c.prototype.setStyle.call(this,m),this.setRadius(j),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var m=this._radius,j=this._radiusY||m,C=this._clickTolerance(),I=[m+C,j+C];this._pxBounds=new G(this._point.subtract(I),this._point.add(I))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(m){return m.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function bY(m,j){return new lx(m,j)}var pb=lx.extend({initialize:function(m,j,C){if(typeof j=="number"&&(j=i({},C,{radius:j})),g(this,j),this._latlng=ye(m),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(m){return this._mRadius=m,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var m=[this._radius,this._radiusY||this._radius];return new te(this._map.layerPointToLatLng(this._point.subtract(m)),this._map.layerPointToLatLng(this._point.add(m)))},setStyle:$c.prototype.setStyle,_project:function(){var m=this._latlng.lng,j=this._latlng.lat,C=this._map,I=C.options.crs;if(I.distance===xe.distance){var q=Math.PI/180,J=this._mRadius/xe.R/q,we=C.project([j+J,m]),De=C.project([j-J,m]),ze=we.add(De).divideBy(2),ft=C.unproject(ze).lat,$t=Math.acos((Math.cos(J*q)-Math.sin(j*q)*Math.sin(ft*q))/(Math.cos(j*q)*Math.cos(ft*q)))/q;(isNaN($t)||$t===0)&&($t=J/Math.cos(Math.PI/180*j)),this._point=ze.subtract(C.getPixelOrigin()),this._radius=isNaN($t)?0:ze.x-C.project([ft,m-$t]).x,this._radiusY=ze.y-we.y}else{var fr=I.unproject(I.project(this._latlng).subtract([this._mRadius,0]));this._point=C.latLngToLayerPoint(this._latlng),this._radius=this._point.x-C.latLngToLayerPoint(fr).x}this._updateBounds()}});function jY(m,j,C){return new pb(m,j,C)}var Dl=$c.extend({options:{smoothFactor:1,noClip:!1},initialize:function(m,j){g(this,j),this._setLatLngs(m)},getLatLngs:function(){return this._latlngs},setLatLngs:function(m){return this._setLatLngs(m),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(m){for(var j=1/0,C=null,I=Ic,q,J,we=0,De=this._parts.length;we<De;we++)for(var ze=this._parts[we],ft=1,$t=ze.length;ft<$t;ft++){q=ze[ft-1],J=ze[ft];var fr=I(m,q,J,!0);fr<j&&(j=fr,C=I(m,q,J))}return C&&(C.distance=Math.sqrt(j)),C},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return WC(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(m,j){return j=j||this._defaultShape(),m=ye(m),j.push(m),this._bounds.extend(m),this.redraw()},_setLatLngs:function(m){this._bounds=new te,this._latlngs=this._convertLatLngs(m)},_defaultShape:function(){return Ni(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(m){for(var j=[],C=Ni(m),I=0,q=m.length;I<q;I++)C?(j[I]=ye(m[I]),this._bounds.extend(j[I])):j[I]=this._convertLatLngs(m[I]);return j},_project:function(){var m=new G;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,m),this._bounds.isValid()&&m.isValid()&&(this._rawPxBounds=m,this._updateBounds())},_updateBounds:function(){var m=this._clickTolerance(),j=new z(m,m);this._rawPxBounds&&(this._pxBounds=new G([this._rawPxBounds.min.subtract(j),this._rawPxBounds.max.add(j)]))},_projectLatlngs:function(m,j,C){var I=m[0]instanceof ue,q=m.length,J,we;if(I){for(we=[],J=0;J<q;J++)we[J]=this._map.latLngToLayerPoint(m[J]),C.extend(we[J]);j.push(we)}else for(J=0;J<q;J++)this._projectLatlngs(m[J],j,C)},_clipPoints:function(){var m=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(m))){if(this.options.noClip){this._parts=this._rings;return}var j=this._parts,C,I,q,J,we,De,ze;for(C=0,q=0,J=this._rings.length;C<J;C++)for(ze=this._rings[C],I=0,we=ze.length;I<we-1;I++)De=Sp(ze[I],ze[I+1],m,I,!0),De&&(j[q]=j[q]||[],j[q].push(De[0]),(De[1]!==ze[I+1]||I===we-2)&&(j[q].push(De[1]),q++))}},_simplifyPoints:function(){for(var m=this._parts,j=this.options.smoothFactor,C=0,I=m.length;C<I;C++)m[C]=En(m[C],j)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(m,j){var C,I,q,J,we,De,ze=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(m))return!1;for(C=0,J=this._parts.length;C<J;C++)for(De=this._parts[C],I=0,we=De.length,q=we-1;I<we;q=I++)if(!(!j&&I===0)&&yr(m,De[q],De[I])<=ze)return!0;return!1}});function NY(m,j){return new Dl(m,j)}Dl._flat=kp;var Sf=Dl.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return cs(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(m){var j=Dl.prototype._convertLatLngs.call(this,m),C=j.length;return C>=2&&j[0]instanceof ue&&j[0].equals(j[C-1])&&j.pop(),j},_setLatLngs:function(m){Dl.prototype._setLatLngs.call(this,m),Ni(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ni(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var m=this._renderer._bounds,j=this.options.weight,C=new z(j,j);if(m=new G(m.min.subtract(C),m.max.add(C)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(m))){if(this.options.noClip){this._parts=this._rings;return}for(var I=0,q=this._rings.length,J;I<q;I++)J=Kr(this._rings[I],m,!0),J.length&&this._parts.push(J)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(m){var j=!1,C,I,q,J,we,De,ze,ft;if(!this._pxBounds||!this._pxBounds.contains(m))return!1;for(J=0,ze=this._parts.length;J<ze;J++)for(C=this._parts[J],we=0,ft=C.length,De=ft-1;we<ft;De=we++)I=C[we],q=C[De],I.y>m.y!=q.y>m.y&&m.x<(q.x-I.x)*(m.y-I.y)/(q.y-I.y)+I.x&&(j=!j);return j||Dl.prototype._containsPoint.call(this,m,!0)}});function SY(m,j){return new Sf(m,j)}var Il=Ml.extend({initialize:function(m,j){g(this,j),this._layers={},m&&this.addData(m)},addData:function(m){var j=b(m)?m:m.features,C,I,q;if(j){for(C=0,I=j.length;C<I;C++)q=j[C],(q.geometries||q.geometry||q.features||q.coordinates)&&this.addData(q);return this}var J=this.options;if(J.filter&&!J.filter(m))return this;var we=cx(m,J);return we?(we.feature=fx(m),we.defaultOptions=we.options,this.resetStyle(we),J.onEachFeature&&J.onEachFeature(m,we),this.addLayer(we)):this},resetStyle:function(m){return m===void 0?this.eachLayer(this.resetStyle,this):(m.options=i({},m.defaultOptions),this._setLayerStyle(m,this.options.style),this)},setStyle:function(m){return this.eachLayer(function(j){this._setLayerStyle(j,m)},this)},_setLayerStyle:function(m,j){m.setStyle&&(typeof j=="function"&&(j=j(m.feature)),m.setStyle(j))}});function cx(m,j){var C=m.type==="Feature"?m.geometry:m,I=C?C.coordinates:null,q=[],J=j&&j.pointToLayer,we=j&&j.coordsToLatLng||gb,De,ze,ft,$t;if(!I&&!C)return null;switch(C.type){case"Point":return De=we(I),YC(J,m,De,j);case"MultiPoint":for(ft=0,$t=I.length;ft<$t;ft++)De=we(I[ft]),q.push(YC(J,m,De,j));return new Ml(q);case"LineString":case"MultiLineString":return ze=dx(I,C.type==="LineString"?0:1,we),new Dl(ze,j);case"Polygon":case"MultiPolygon":return ze=dx(I,C.type==="Polygon"?1:2,we),new Sf(ze,j);case"GeometryCollection":for(ft=0,$t=C.geometries.length;ft<$t;ft++){var fr=cx({geometry:C.geometries[ft],type:"Feature",properties:m.properties},j);fr&&q.push(fr)}return new Ml(q);case"FeatureCollection":for(ft=0,$t=C.features.length;ft<$t;ft++){var Rr=cx(C.features[ft],j);Rr&&q.push(Rr)}return new Ml(q);default:throw new Error("Invalid GeoJSON object.")}}function YC(m,j,C,I){return m?m(j,C):new ox(C,I&&I.markersInheritOptions&&I)}function gb(m){return new ue(m[1],m[0],m[2])}function dx(m,j,C){for(var I=[],q=0,J=m.length,we;q<J;q++)we=j?dx(m[q],j-1,C):(C||gb)(m[q]),I.push(we);return I}function vb(m,j){return m=ye(m),m.alt!==void 0?[f(m.lng,j),f(m.lat,j),f(m.alt,j)]:[f(m.lng,j),f(m.lat,j)]}function ux(m,j,C,I){for(var q=[],J=0,we=m.length;J<we;J++)q.push(j?ux(m[J],Ni(m[J])?0:j-1,C,I):vb(m[J],I));return!j&&C&&q.length>0&&q.push(q[0].slice()),q}function kf(m,j){return m.feature?i({},m.feature,{geometry:j}):fx(j)}function fx(m){return m.type==="Feature"||m.type==="FeatureCollection"?m:{type:"Feature",properties:{},geometry:m}}var xb={toGeoJSON:function(m){return kf(this,{type:"Point",coordinates:vb(this.getLatLng(),m)})}};ox.include(xb),pb.include(xb),lx.include(xb),Dl.include({toGeoJSON:function(m){var j=!Ni(this._latlngs),C=ux(this._latlngs,j?1:0,!1,m);return kf(this,{type:(j?"Multi":"")+"LineString",coordinates:C})}}),Sf.include({toGeoJSON:function(m){var j=!Ni(this._latlngs),C=j&&!Ni(this._latlngs[0]),I=ux(this._latlngs,C?2:j?1:0,!0,m);return j||(I=[I]),kf(this,{type:(C?"Multi":"")+"Polygon",coordinates:I})}}),jf.include({toMultiPoint:function(m){var j=[];return this.eachLayer(function(C){j.push(C.toGeoJSON(m).geometry.coordinates)}),kf(this,{type:"MultiPoint",coordinates:j})},toGeoJSON:function(m){var j=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(j==="MultiPoint")return this.toMultiPoint(m);var C=j==="GeometryCollection",I=[];return this.eachLayer(function(q){if(q.toGeoJSON){var J=q.toGeoJSON(m);if(C)I.push(J.geometry);else{var we=fx(J);we.type==="FeatureCollection"?I.push.apply(I,we.features):I.push(we)}}}),C?kf(this,{geometries:I,type:"GeometryCollection"}):{type:"FeatureCollection",features:I}}});function KC(m,j){return new Il(m,j)}var kY=KC,hx=io.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(m,j,C){this._url=m,this._bounds=se(j),g(this,C)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(tr(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){rr(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(m){return this.options.opacity=m,this._image&&this._updateOpacity(),this},setStyle:function(m){return m.opacity&&this.setOpacity(m.opacity),this},bringToFront:function(){return this._map&&Hr(this._image),this},bringToBack:function(){return this._map&&dn(this._image),this},setUrl:function(m){return this._url=m,this._image&&(this._image.src=m),this},setBounds:function(m){return this._bounds=se(m),this._map&&this._reset(),this},getEvents:function(){var m={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(m.zoomanim=this._animateZoom),m},setZIndex:function(m){return this.options.zIndex=m,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var m=this._url.tagName==="IMG",j=this._image=m?this._url:kt("img");if(tr(j,"leaflet-image-layer"),this._zoomAnimated&&tr(j,"leaflet-zoom-animated"),this.options.className&&tr(j,this.options.className),j.onselectstart=h,j.onmousemove=h,j.onload=o(this.fire,this,"load"),j.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(j.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),m){this._url=j.src;return}j.src=this._url,j.alt=this.options.alt},_animateZoom:function(m){var j=this._map.getZoomScale(m.zoom),C=this._map._latLngBoundsToNewLayerBounds(this._bounds,m.zoom,m.center).min;zn(this._image,C,j)},_reset:function(){var m=this._image,j=new G(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),C=j.getSize();Yr(m,j.min),m.style.width=C.x+"px",m.style.height=C.y+"px"},_updateOpacity:function(){Dr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var m=this.options.errorOverlayUrl;m&&this._url!==m&&(this._url=m,this._image.src=m)},getCenter:function(){return this._bounds.getCenter()}}),EY=function(m,j,C){return new hx(m,j,C)},ZC=hx.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var m=this._url.tagName==="VIDEO",j=this._image=m?this._url:kt("video");if(tr(j,"leaflet-image-layer"),this._zoomAnimated&&tr(j,"leaflet-zoom-animated"),this.options.className&&tr(j,this.options.className),j.onselectstart=h,j.onmousemove=h,j.onloadeddata=o(this.fire,this,"load"),m){for(var C=j.getElementsByTagName("source"),I=[],q=0;q<C.length;q++)I.push(C[q].src);this._url=C.length>0?I:[j.src];return}b(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(j.style,"objectFit")&&(j.style.objectFit="fill"),j.autoplay=!!this.options.autoplay,j.loop=!!this.options.loop,j.muted=!!this.options.muted,j.playsInline=!!this.options.playsInline;for(var J=0;J<this._url.length;J++){var we=kt("source");we.src=this._url[J],j.appendChild(we)}}});function CY(m,j,C){return new ZC(m,j,C)}var XC=hx.extend({_initImage:function(){var m=this._image=this._url;tr(m,"leaflet-image-layer"),this._zoomAnimated&&tr(m,"leaflet-zoom-animated"),this.options.className&&tr(m,this.options.className),m.onselectstart=h,m.onmousemove=h}});function PY(m,j,C){return new XC(m,j,C)}var Go=io.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(m,j){m&&(m instanceof ue||b(m))?(this._latlng=ye(m),g(this,j)):(g(this,m),this._source=j),this.options.content&&(this._content=this.options.content)},openOn:function(m){return m=arguments.length?m:this._source._map,m.hasLayer(this)||m.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(m){return this._map?this.close():(arguments.length?this._source=m:m=this._source,this._prepareOpen(),this.openOn(m._map)),this},onAdd:function(m){this._zoomAnimated=m._zoomAnimated,this._container||this._initLayout(),m._fadeAnimated&&Dr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),m._fadeAnimated&&Dr(this._container,1),this.bringToFront(),this.options.interactive&&(tr(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(m){m._fadeAnimated?(Dr(this._container,0),this._removeTimeout=setTimeout(o(rr,void 0,this._container),200)):rr(this._container),this.options.interactive&&(Gr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(m){return this._latlng=ye(m),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(m){return this._content=m,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var m={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(m.zoomanim=this._animateZoom),m},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Hr(this._container),this},bringToBack:function(){return this._map&&dn(this._container),this},_prepareOpen:function(m){var j=this._source;if(!j._map)return!1;if(j instanceof Ml){j=null;var C=this._source._layers;for(var I in C)if(C[I]._map){j=C[I];break}if(!j)return!1;this._source=j}if(!m)if(j.getCenter)m=j.getCenter();else if(j.getLatLng)m=j.getLatLng();else if(j.getBounds)m=j.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(m),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var m=this._contentNode,j=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof j=="string")m.innerHTML=j;else{for(;m.hasChildNodes();)m.removeChild(m.firstChild);m.appendChild(j)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var m=this._map.latLngToLayerPoint(this._latlng),j=Z(this.options.offset),C=this._getAnchor();this._zoomAnimated?Yr(this._container,m.add(C)):j=j.add(m).add(C);var I=this._containerBottom=-j.y,q=this._containerLeft=-Math.round(this._containerWidth/2)+j.x;this._container.style.bottom=I+"px",this._container.style.left=q+"px"}},_getAnchor:function(){return[0,0]}});Ir.include({_initOverlay:function(m,j,C,I){var q=j;return q instanceof m||(q=new m(I).setContent(j)),C&&q.setLatLng(C),q}}),io.include({_initOverlay:function(m,j,C,I){var q=C;return q instanceof m?(g(q,I),q._source=this):(q=j&&!I?j:new m(I,this),q.setContent(C)),q}});var mx=Go.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(m){return m=arguments.length?m:this._source._map,!m.hasLayer(this)&&m._popup&&m._popup.options.autoClose&&m.removeLayer(m._popup),m._popup=this,Go.prototype.openOn.call(this,m)},onAdd:function(m){Go.prototype.onAdd.call(this,m),m.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof $c||this._source.on("preclick",ui))},onRemove:function(m){Go.prototype.onRemove.call(this,m),m.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof $c||this._source.off("preclick",ui))},getEvents:function(){var m=Go.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(m.preclick=this.close),this.options.keepInView&&(m.moveend=this._adjustPan),m},_initLayout:function(){var m="leaflet-popup",j=this._container=kt("div",m+" "+(this.options.className||"")+" leaflet-zoom-animated"),C=this._wrapper=kt("div",m+"-content-wrapper",j);if(this._contentNode=kt("div",m+"-content",C),qd(j),Wo(this._contentNode),dr(j,"contextmenu",ui),this._tipContainer=kt("div",m+"-tip-container",j),this._tip=kt("div",m+"-tip",this._tipContainer),this.options.closeButton){var I=this._closeButton=kt("a",m+"-close-button",j);I.setAttribute("role","button"),I.setAttribute("aria-label","Close popup"),I.href="#close",I.innerHTML='<span aria-hidden="true">&#215;</span>',dr(I,"click",function(q){gs(q),this.close()},this)}},_updateLayout:function(){var m=this._contentNode,j=m.style;j.width="",j.whiteSpace="nowrap";var C=m.offsetWidth;C=Math.min(C,this.options.maxWidth),C=Math.max(C,this.options.minWidth),j.width=C+1+"px",j.whiteSpace="",j.height="";var I=m.offsetHeight,q=this.options.maxHeight,J="leaflet-popup-scrolled";q&&I>q?(j.height=q+"px",tr(m,J)):Gr(m,J),this._containerWidth=this._container.offsetWidth},_animateZoom:function(m){var j=this._map._latLngToNewLayerPoint(this._latlng,m.zoom,m.center),C=this._getAnchor();Yr(this._container,j.add(C))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var m=this._map,j=parseInt(It(this._container,"marginBottom"),10)||0,C=this._container.offsetHeight+j,I=this._containerWidth,q=new z(this._containerLeft,-C-this._containerBottom);q._add(Ns(this._container));var J=m.layerPointToContainerPoint(q),we=Z(this.options.autoPanPadding),De=Z(this.options.autoPanPaddingTopLeft||we),ze=Z(this.options.autoPanPaddingBottomRight||we),ft=m.getSize(),$t=0,fr=0;J.x+I+ze.x>ft.x&&($t=J.x+I-ft.x+ze.x),J.x-$t-De.x<0&&($t=J.x-De.x),J.y+C+ze.y>ft.y&&(fr=J.y+C-ft.y+ze.y),J.y-fr-De.y<0&&(fr=J.y-De.y),($t||fr)&&(this.options.keepInView&&(this._autopanning=!0),m.fire("autopanstart").panBy([$t,fr]))}},_getAnchor:function(){return Z(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),AY=function(m,j){return new mx(m,j)};Ir.mergeOptions({closePopupOnClick:!0}),Ir.include({openPopup:function(m,j,C){return this._initOverlay(mx,m,j,C).openOn(this),this},closePopup:function(m){return m=arguments.length?m:this._popup,m&&m.close(),this}}),io.include({bindPopup:function(m,j){return this._popup=this._initOverlay(mx,this._popup,m,j),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(m){return this._popup&&(this instanceof Ml||(this._popup._source=this),this._popup._prepareOpen(m||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(m){return this._popup&&this._popup.setContent(m),this},getPopup:function(){return this._popup},_openPopup:function(m){if(!(!this._popup||!this._map)){Rl(m);var j=m.layer||m.target;if(this._popup._source===j&&!(j instanceof $c)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(m.latlng);return}this._popup._source=j,this.openPopup(m.latlng)}},_movePopup:function(m){this._popup.setLatLng(m.latlng)},_onKeyPress:function(m){m.originalEvent.keyCode===13&&this._openPopup(m)}});var px=Go.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(m){Go.prototype.onAdd.call(this,m),this.setOpacity(this.options.opacity),m.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(m){Go.prototype.onRemove.call(this,m),m.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var m=Go.prototype.getEvents.call(this);return this.options.permanent||(m.preclick=this.close),m},_initLayout:function(){var m="leaflet-tooltip",j=m+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=kt("div",j),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(m){var j,C,I=this._map,q=this._container,J=I.latLngToContainerPoint(I.getCenter()),we=I.layerPointToContainerPoint(m),De=this.options.direction,ze=q.offsetWidth,ft=q.offsetHeight,$t=Z(this.options.offset),fr=this._getAnchor();De==="top"?(j=ze/2,C=ft):De==="bottom"?(j=ze/2,C=0):De==="center"?(j=ze/2,C=ft/2):De==="right"?(j=0,C=ft/2):De==="left"?(j=ze,C=ft/2):we.x<J.x?(De="right",j=0,C=ft/2):(De="left",j=ze+($t.x+fr.x)*2,C=ft/2),m=m.subtract(Z(j,C,!0)).add($t).add(fr),Gr(q,"leaflet-tooltip-right"),Gr(q,"leaflet-tooltip-left"),Gr(q,"leaflet-tooltip-top"),Gr(q,"leaflet-tooltip-bottom"),tr(q,"leaflet-tooltip-"+De),Yr(q,m)},_updatePosition:function(){var m=this._map.latLngToLayerPoint(this._latlng);this._setPosition(m)},setOpacity:function(m){this.options.opacity=m,this._container&&Dr(this._container,m)},_animateZoom:function(m){var j=this._map._latLngToNewLayerPoint(this._latlng,m.zoom,m.center);this._setPosition(j)},_getAnchor:function(){return Z(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),TY=function(m,j){return new px(m,j)};Ir.include({openTooltip:function(m,j,C){return this._initOverlay(px,m,j,C).openOn(this),this},closeTooltip:function(m){return m.close(),this}}),io.include({bindTooltip:function(m,j){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(px,this._tooltip,m,j),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(m){if(!(!m&&this._tooltipHandlersAdded)){var j=m?"off":"on",C={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?C.add=this._openTooltip:(C.mouseover=this._openTooltip,C.mouseout=this.closeTooltip,C.click=this._openTooltip,this._map?this._addFocusListeners():C.add=this._addFocusListeners),this._tooltip.options.sticky&&(C.mousemove=this._moveTooltip),this[j](C),this._tooltipHandlersAdded=!m}},openTooltip:function(m){return this._tooltip&&(this instanceof Ml||(this._tooltip._source=this),this._tooltip._prepareOpen(m)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(m){return this._tooltip&&this._tooltip.setContent(m),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(m){var j=typeof m.getElement=="function"&&m.getElement();j&&(dr(j,"focus",function(){this._tooltip._source=m,this.openTooltip()},this),dr(j,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(m){var j=typeof m.getElement=="function"&&m.getElement();j&&j.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(m){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var j=this;this._map.once("moveend",function(){j._openOnceFlag=!1,j._openTooltip(m)});return}this._tooltip._source=m.layer||m.target,this.openTooltip(this._tooltip.options.sticky?m.latlng:void 0)}},_moveTooltip:function(m){var j=m.latlng,C,I;this._tooltip.options.sticky&&m.originalEvent&&(C=this._map.mouseEventToContainerPoint(m.originalEvent),I=this._map.containerPointToLayerPoint(C),j=this._map.layerPointToLatLng(I)),this._tooltip.setLatLng(j)}});var JC=Nf.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(m){var j=m&&m.tagName==="DIV"?m:document.createElement("div"),C=this.options;if(C.html instanceof Element?(mr(j),j.appendChild(C.html)):j.innerHTML=C.html!==!1?C.html:"",C.bgPos){var I=Z(C.bgPos);j.style.backgroundPosition=-I.x+"px "+-I.y+"px"}return this._setIconStyles(j,"icon"),j},createShadow:function(){return null}});function OY(m){return new JC(m)}Nf.Default=Ep;var Cp=io.extend({options:{tileSize:256,opacity:1,updateWhenIdle:pt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(m){g(this,m)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(m){m._addZoomLimit(this)},onRemove:function(m){this._removeAllTiles(),rr(this._container),m._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Hr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(dn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(m){return this.options.opacity=m,this._updateOpacity(),this},setZIndex:function(m){return this.options.zIndex=m,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var m=this._clampZoom(this._map.getZoom());m!==this._tileZoom&&(this._tileZoom=m,this._updateLevels()),this._update()}return this},getEvents:function(){var m={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),m.move=this._onMove),this._zoomAnimated&&(m.zoomanim=this._animateZoom),m},createTile:function(){return document.createElement("div")},getTileSize:function(){var m=this.options.tileSize;return m instanceof z?m:new z(m,m)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(m){for(var j=this.getPane().children,C=-m(-1/0,1/0),I=0,q=j.length,J;I<q;I++)J=j[I].style.zIndex,j[I]!==this._container&&J&&(C=m(C,+J));isFinite(C)&&(this.options.zIndex=C+m(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!pt.ielt9){Dr(this._container,this.options.opacity);var m=+new Date,j=!1,C=!1;for(var I in this._tiles){var q=this._tiles[I];if(!(!q.current||!q.loaded)){var J=Math.min(1,(m-q.loaded)/200);Dr(q.el,J),J<1?j=!0:(q.active?C=!0:this._onOpaqueTile(q),q.active=!0)}}C&&!this._noPrune&&this._pruneTiles(),j&&(F(this._fadeFrame),this._fadeFrame=R(this._updateOpacity,this))}},_onOpaqueTile:h,_initContainer:function(){this._container||(this._container=kt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var m=this._tileZoom,j=this.options.maxZoom;if(m!==void 0){for(var C in this._levels)C=Number(C),this._levels[C].el.children.length||C===m?(this._levels[C].el.style.zIndex=j-Math.abs(m-C),this._onUpdateLevel(C)):(rr(this._levels[C].el),this._removeTilesAtZoom(C),this._onRemoveLevel(C),delete this._levels[C]);var I=this._levels[m],q=this._map;return I||(I=this._levels[m]={},I.el=kt("div","leaflet-tile-container leaflet-zoom-animated",this._container),I.el.style.zIndex=j,I.origin=q.project(q.unproject(q.getPixelOrigin()),m).round(),I.zoom=m,this._setZoomTransform(I,q.getCenter(),q.getZoom()),h(I.el.offsetWidth),this._onCreateLevel(I)),this._level=I,I}},_onUpdateLevel:h,_onRemoveLevel:h,_onCreateLevel:h,_pruneTiles:function(){if(this._map){var m,j,C=this._map.getZoom();if(C>this.options.maxZoom||C<this.options.minZoom){this._removeAllTiles();return}for(m in this._tiles)j=this._tiles[m],j.retain=j.current;for(m in this._tiles)if(j=this._tiles[m],j.current&&!j.active){var I=j.coords;this._retainParent(I.x,I.y,I.z,I.z-5)||this._retainChildren(I.x,I.y,I.z,I.z+2)}for(m in this._tiles)this._tiles[m].retain||this._removeTile(m)}},_removeTilesAtZoom:function(m){for(var j in this._tiles)this._tiles[j].coords.z===m&&this._removeTile(j)},_removeAllTiles:function(){for(var m in this._tiles)this._removeTile(m)},_invalidateAll:function(){for(var m in this._levels)rr(this._levels[m].el),this._onRemoveLevel(Number(m)),delete this._levels[m];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(m,j,C,I){var q=Math.floor(m/2),J=Math.floor(j/2),we=C-1,De=new z(+q,+J);De.z=+we;var ze=this._tileCoordsToKey(De),ft=this._tiles[ze];return ft&&ft.active?(ft.retain=!0,!0):(ft&&ft.loaded&&(ft.retain=!0),we>I?this._retainParent(q,J,we,I):!1)},_retainChildren:function(m,j,C,I){for(var q=2*m;q<2*m+2;q++)for(var J=2*j;J<2*j+2;J++){var we=new z(q,J);we.z=C+1;var De=this._tileCoordsToKey(we),ze=this._tiles[De];if(ze&&ze.active){ze.retain=!0;continue}else ze&&ze.loaded&&(ze.retain=!0);C+1<I&&this._retainChildren(q,J,C+1,I)}},_resetView:function(m){var j=m&&(m.pinch||m.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),j,j)},_animateZoom:function(m){this._setView(m.center,m.zoom,!0,m.noUpdate)},_clampZoom:function(m){var j=this.options;return j.minNativeZoom!==void 0&&m<j.minNativeZoom?j.minNativeZoom:j.maxNativeZoom!==void 0&&j.maxNativeZoom<m?j.maxNativeZoom:m},_setView:function(m,j,C,I){var q=Math.round(j);this.options.maxZoom!==void 0&&q>this.options.maxZoom||this.options.minZoom!==void 0&&q<this.options.minZoom?q=void 0:q=this._clampZoom(q);var J=this.options.updateWhenZooming&&q!==this._tileZoom;(!I||J)&&(this._tileZoom=q,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),q!==void 0&&this._update(m),C||this._pruneTiles(),this._noPrune=!!C),this._setZoomTransforms(m,j)},_setZoomTransforms:function(m,j){for(var C in this._levels)this._setZoomTransform(this._levels[C],m,j)},_setZoomTransform:function(m,j,C){var I=this._map.getZoomScale(C,m.zoom),q=m.origin.multiplyBy(I).subtract(this._map._getNewPixelOrigin(j,C)).round();pt.any3d?zn(m.el,q,I):Yr(m.el,q)},_resetGrid:function(){var m=this._map,j=m.options.crs,C=this._tileSize=this.getTileSize(),I=this._tileZoom,q=this._map.getPixelWorldBounds(this._tileZoom);q&&(this._globalTileRange=this._pxBoundsToTileRange(q)),this._wrapX=j.wrapLng&&!this.options.noWrap&&[Math.floor(m.project([0,j.wrapLng[0]],I).x/C.x),Math.ceil(m.project([0,j.wrapLng[1]],I).x/C.y)],this._wrapY=j.wrapLat&&!this.options.noWrap&&[Math.floor(m.project([j.wrapLat[0],0],I).y/C.x),Math.ceil(m.project([j.wrapLat[1],0],I).y/C.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(m){var j=this._map,C=j._animatingZoom?Math.max(j._animateToZoom,j.getZoom()):j.getZoom(),I=j.getZoomScale(C,this._tileZoom),q=j.project(m,this._tileZoom).floor(),J=j.getSize().divideBy(I*2);return new G(q.subtract(J),q.add(J))},_update:function(m){var j=this._map;if(j){var C=this._clampZoom(j.getZoom());if(m===void 0&&(m=j.getCenter()),this._tileZoom!==void 0){var I=this._getTiledPixelBounds(m),q=this._pxBoundsToTileRange(I),J=q.getCenter(),we=[],De=this.options.keepBuffer,ze=new G(q.getBottomLeft().subtract([De,-De]),q.getTopRight().add([De,-De]));if(!(isFinite(q.min.x)&&isFinite(q.min.y)&&isFinite(q.max.x)&&isFinite(q.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ft in this._tiles){var $t=this._tiles[ft].coords;($t.z!==this._tileZoom||!ze.contains(new z($t.x,$t.y)))&&(this._tiles[ft].current=!1)}if(Math.abs(C-this._tileZoom)>1){this._setView(m,C);return}for(var fr=q.min.y;fr<=q.max.y;fr++)for(var Rr=q.min.x;Rr<=q.max.x;Rr++){var Si=new z(Rr,fr);if(Si.z=this._tileZoom,!!this._isValidTile(Si)){var Us=this._tiles[this._tileCoordsToKey(Si)];Us?Us.current=!0:we.push(Si)}}if(we.sort(function(Vi,Cf){return Vi.distanceTo(J)-Cf.distanceTo(J)}),we.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Oa=document.createDocumentFragment();for(Rr=0;Rr<we.length;Rr++)this._addTile(we[Rr],Oa);this._level.el.appendChild(Oa)}}}},_isValidTile:function(m){var j=this._map.options.crs;if(!j.infinite){var C=this._globalTileRange;if(!j.wrapLng&&(m.x<C.min.x||m.x>C.max.x)||!j.wrapLat&&(m.y<C.min.y||m.y>C.max.y))return!1}if(!this.options.bounds)return!0;var I=this._tileCoordsToBounds(m);return se(this.options.bounds).overlaps(I)},_keyToBounds:function(m){return this._tileCoordsToBounds(this._keyToTileCoords(m))},_tileCoordsToNwSe:function(m){var j=this._map,C=this.getTileSize(),I=m.scaleBy(C),q=I.add(C),J=j.unproject(I,m.z),we=j.unproject(q,m.z);return[J,we]},_tileCoordsToBounds:function(m){var j=this._tileCoordsToNwSe(m),C=new te(j[0],j[1]);return this.options.noWrap||(C=this._map.wrapLatLngBounds(C)),C},_tileCoordsToKey:function(m){return m.x+":"+m.y+":"+m.z},_keyToTileCoords:function(m){var j=m.split(":"),C=new z(+j[0],+j[1]);return C.z=+j[2],C},_removeTile:function(m){var j=this._tiles[m];j&&(rr(j.el),delete this._tiles[m],this.fire("tileunload",{tile:j.el,coords:this._keyToTileCoords(m)}))},_initTile:function(m){tr(m,"leaflet-tile");var j=this.getTileSize();m.style.width=j.x+"px",m.style.height=j.y+"px",m.onselectstart=h,m.onmousemove=h,pt.ielt9&&this.options.opacity<1&&Dr(m,this.options.opacity)},_addTile:function(m,j){var C=this._getTilePos(m),I=this._tileCoordsToKey(m),q=this.createTile(this._wrapCoords(m),o(this._tileReady,this,m));this._initTile(q),this.createTile.length<2&&R(o(this._tileReady,this,m,null,q)),Yr(q,C),this._tiles[I]={el:q,coords:m,current:!0},j.appendChild(q),this.fire("tileloadstart",{tile:q,coords:m})},_tileReady:function(m,j,C){j&&this.fire("tileerror",{error:j,tile:C,coords:m});var I=this._tileCoordsToKey(m);C=this._tiles[I],C&&(C.loaded=+new Date,this._map._fadeAnimated?(Dr(C.el,0),F(this._fadeFrame),this._fadeFrame=R(this._updateOpacity,this)):(C.active=!0,this._pruneTiles()),j||(tr(C.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:C.el,coords:m})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),pt.ielt9||!this._map._fadeAnimated?R(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(m){return m.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(m){var j=new z(this._wrapX?u(m.x,this._wrapX):m.x,this._wrapY?u(m.y,this._wrapY):m.y);return j.z=m.z,j},_pxBoundsToTileRange:function(m){var j=this.getTileSize();return new G(m.min.unscaleBy(j).floor(),m.max.unscaleBy(j).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var m in this._tiles)if(!this._tiles[m].loaded)return!1;return!0}});function RY(m){return new Cp(m)}var Ef=Cp.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(m,j){this._url=m,j=g(this,j),j.detectRetina&&pt.retina&&j.maxZoom>0?(j.tileSize=Math.floor(j.tileSize/2),j.zoomReverse?(j.zoomOffset--,j.minZoom=Math.min(j.maxZoom,j.minZoom+1)):(j.zoomOffset++,j.maxZoom=Math.max(j.minZoom,j.maxZoom-1)),j.minZoom=Math.max(0,j.minZoom)):j.zoomReverse?j.minZoom=Math.min(j.maxZoom,j.minZoom):j.maxZoom=Math.max(j.minZoom,j.maxZoom),typeof j.subdomains=="string"&&(j.subdomains=j.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(m,j){return this._url===m&&j===void 0&&(j=!0),this._url=m,j||this.redraw(),this},createTile:function(m,j){var C=document.createElement("img");return dr(C,"load",o(this._tileOnLoad,this,j,C)),dr(C,"error",o(this._tileOnError,this,j,C)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(C.referrerPolicy=this.options.referrerPolicy),C.alt="",C.src=this.getTileUrl(m),C},getTileUrl:function(m){var j={r:pt.retina?"@2x":"",s:this._getSubdomain(m),x:m.x,y:m.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var C=this._globalTileRange.max.y-m.y;this.options.tms&&(j.y=C),j["-y"]=C}return w(this._url,i(j,this.options))},_tileOnLoad:function(m,j){pt.ielt9?setTimeout(o(m,this,null,j),0):m(null,j)},_tileOnError:function(m,j,C){var I=this.options.errorTileUrl;I&&j.getAttribute("src")!==I&&(j.src=I),m(C,j)},_onTileRemove:function(m){m.tile.onload=null},_getZoomForUrl:function(){var m=this._tileZoom,j=this.options.maxZoom,C=this.options.zoomReverse,I=this.options.zoomOffset;return C&&(m=j-m),m+I},_getSubdomain:function(m){var j=Math.abs(m.x+m.y)%this.options.subdomains.length;return this.options.subdomains[j]},_abortLoading:function(){var m,j;for(m in this._tiles)if(this._tiles[m].coords.z!==this._tileZoom&&(j=this._tiles[m].el,j.onload=h,j.onerror=h,!j.complete)){j.src=S;var C=this._tiles[m].coords;rr(j),delete this._tiles[m],this.fire("tileabort",{tile:j,coords:C})}},_removeTile:function(m){var j=this._tiles[m];if(j)return j.el.setAttribute("src",S),Cp.prototype._removeTile.call(this,m)},_tileReady:function(m,j,C){if(!(!this._map||C&&C.getAttribute("src")===S))return Cp.prototype._tileReady.call(this,m,j,C)}});function QC(m,j){return new Ef(m,j)}var e6=Ef.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(m,j){this._url=m;var C=i({},this.defaultWmsParams);for(var I in j)I in this.options||(C[I]=j[I]);j=g(this,j);var q=j.detectRetina&&pt.retina?2:1,J=this.getTileSize();C.width=J.x*q,C.height=J.y*q,this.wmsParams=C},onAdd:function(m){this._crs=this.options.crs||m.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var j=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[j]=this._crs.code,Ef.prototype.onAdd.call(this,m)},getTileUrl:function(m){var j=this._tileCoordsToNwSe(m),C=this._crs,I=X(C.project(j[0]),C.project(j[1])),q=I.min,J=I.max,we=(this._wmsVersion>=1.3&&this._crs===HC?[q.y,q.x,J.y,J.x]:[q.x,q.y,J.x,J.y]).join(","),De=Ef.prototype.getTileUrl.call(this,m);return De+v(this.wmsParams,De,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+we},setParams:function(m,j){return i(this.wmsParams,m),j||this.redraw(),this}});function MY(m,j){return new e6(m,j)}Ef.WMS=e6,QC.wms=MY;var $l=io.extend({options:{padding:.1},initialize:function(m){g(this,m),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),tr(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var m={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(m.zoomanim=this._onAnimZoom),m},_onAnimZoom:function(m){this._updateTransform(m.center,m.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(m,j){var C=this._map.getZoomScale(j,this._zoom),I=this._map.getSize().multiplyBy(.5+this.options.padding),q=this._map.project(this._center,j),J=I.multiplyBy(-C).add(q).subtract(this._map._getNewPixelOrigin(m,j));pt.any3d?zn(this._container,J,C):Yr(this._container,J)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var m in this._layers)this._layers[m]._reset()},_onZoomEnd:function(){for(var m in this._layers)this._layers[m]._project()},_updatePaths:function(){for(var m in this._layers)this._layers[m]._update()},_update:function(){var m=this.options.padding,j=this._map.getSize(),C=this._map.containerPointToLayerPoint(j.multiplyBy(-m)).round();this._bounds=new G(C,C.add(j.multiplyBy(1+m*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),t6=$l.extend({options:{tolerance:0},getEvents:function(){var m=$l.prototype.getEvents.call(this);return m.viewprereset=this._onViewPreReset,m},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){$l.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var m=this._container=document.createElement("canvas");dr(m,"mousemove",this._onMouseMove,this),dr(m,"click dblclick mousedown mouseup contextmenu",this._onClick,this),dr(m,"mouseout",this._handleMouseOut,this),m._leaflet_disable_events=!0,this._ctx=m.getContext("2d")},_destroyContainer:function(){F(this._redrawRequest),delete this._ctx,rr(this._container),cn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var m;this._redrawBounds=null;for(var j in this._layers)m=this._layers[j],m._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){$l.prototype._update.call(this);var m=this._bounds,j=this._container,C=m.getSize(),I=pt.retina?2:1;Yr(j,m.min),j.width=I*C.x,j.height=I*C.y,j.style.width=C.x+"px",j.style.height=C.y+"px",pt.retina&&this._ctx.scale(2,2),this._ctx.translate(-m.min.x,-m.min.y),this.fire("update")}},_reset:function(){$l.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(m){this._updateDashArray(m),this._layers[c(m)]=m;var j=m._order={layer:m,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=j),this._drawLast=j,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(m){this._requestRedraw(m)},_removePath:function(m){var j=m._order,C=j.next,I=j.prev;C?C.prev=I:this._drawLast=I,I?I.next=C:this._drawFirst=C,delete m._order,delete this._layers[c(m)],this._requestRedraw(m)},_updatePath:function(m){this._extendRedrawBounds(m),m._project(),m._update(),this._requestRedraw(m)},_updateStyle:function(m){this._updateDashArray(m),this._requestRedraw(m)},_updateDashArray:function(m){if(typeof m.options.dashArray=="string"){var j=m.options.dashArray.split(/[, ]+/),C=[],I,q;for(q=0;q<j.length;q++){if(I=Number(j[q]),isNaN(I))return;C.push(I)}m.options._dashArray=C}else m.options._dashArray=m.options.dashArray},_requestRedraw:function(m){this._map&&(this._extendRedrawBounds(m),this._redrawRequest=this._redrawRequest||R(this._redraw,this))},_extendRedrawBounds:function(m){if(m._pxBounds){var j=(m.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new G,this._redrawBounds.extend(m._pxBounds.min.subtract([j,j])),this._redrawBounds.extend(m._pxBounds.max.add([j,j]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var m=this._redrawBounds;if(m){var j=m.getSize();this._ctx.clearRect(m.min.x,m.min.y,j.x,j.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var m,j=this._redrawBounds;if(this._ctx.save(),j){var C=j.getSize();this._ctx.beginPath(),this._ctx.rect(j.min.x,j.min.y,C.x,C.y),this._ctx.clip()}this._drawing=!0;for(var I=this._drawFirst;I;I=I.next)m=I.layer,(!j||m._pxBounds&&m._pxBounds.intersects(j))&&m._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(m,j){if(this._drawing){var C,I,q,J,we=m._parts,De=we.length,ze=this._ctx;if(De){for(ze.beginPath(),C=0;C<De;C++){for(I=0,q=we[C].length;I<q;I++)J=we[C][I],ze[I?"lineTo":"moveTo"](J.x,J.y);j&&ze.closePath()}this._fillStroke(ze,m)}}},_updateCircle:function(m){if(!(!this._drawing||m._empty())){var j=m._point,C=this._ctx,I=Math.max(Math.round(m._radius),1),q=(Math.max(Math.round(m._radiusY),1)||I)/I;q!==1&&(C.save(),C.scale(1,q)),C.beginPath(),C.arc(j.x,j.y/q,I,0,Math.PI*2,!1),q!==1&&C.restore(),this._fillStroke(C,m)}},_fillStroke:function(m,j){var C=j.options;C.fill&&(m.globalAlpha=C.fillOpacity,m.fillStyle=C.fillColor||C.color,m.fill(C.fillRule||"evenodd")),C.stroke&&C.weight!==0&&(m.setLineDash&&m.setLineDash(j.options&&j.options._dashArray||[]),m.globalAlpha=C.opacity,m.lineWidth=C.weight,m.strokeStyle=C.color,m.lineCap=C.lineCap,m.lineJoin=C.lineJoin,m.stroke())},_onClick:function(m){for(var j=this._map.mouseEventToLayerPoint(m),C,I,q=this._drawFirst;q;q=q.next)C=q.layer,C.options.interactive&&C._containsPoint(j)&&(!(m.type==="click"||m.type==="preclick")||!this._map._draggableMoved(C))&&(I=C);this._fireEvent(I?[I]:!1,m)},_onMouseMove:function(m){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var j=this._map.mouseEventToLayerPoint(m);this._handleMouseHover(m,j)}},_handleMouseOut:function(m){var j=this._hoveredLayer;j&&(Gr(this._container,"leaflet-interactive"),this._fireEvent([j],m,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(m,j){if(!this._mouseHoverThrottled){for(var C,I,q=this._drawFirst;q;q=q.next)C=q.layer,C.options.interactive&&C._containsPoint(j)&&(I=C);I!==this._hoveredLayer&&(this._handleMouseOut(m),I&&(tr(this._container,"leaflet-interactive"),this._fireEvent([I],m,"mouseover"),this._hoveredLayer=I)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,m),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(m,j,C){this._map._fireDOMEvent(j,C||j.type,m)},_bringToFront:function(m){var j=m._order;if(j){var C=j.next,I=j.prev;if(C)C.prev=I;else return;I?I.next=C:C&&(this._drawFirst=C),j.prev=this._drawLast,this._drawLast.next=j,j.next=null,this._drawLast=j,this._requestRedraw(m)}},_bringToBack:function(m){var j=m._order;if(j){var C=j.next,I=j.prev;if(I)I.next=C;else return;C?C.prev=I:I&&(this._drawLast=I),j.prev=null,j.next=this._drawFirst,this._drawFirst.prev=j,this._drawFirst=j,this._requestRedraw(m)}}});function r6(m){return pt.canvas?new t6(m):null}var Pp=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(m){return document.createElement("<lvml:"+m+' class="lvml">')}}catch(m){}return function(m){return document.createElement("<"+m+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),DY={_initContainer:function(){this._container=kt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||($l.prototype._update.call(this),this.fire("update"))},_initPath:function(m){var j=m._container=Pp("shape");tr(j,"leaflet-vml-shape "+(this.options.className||"")),j.coordsize="1 1",m._path=Pp("path"),j.appendChild(m._path),this._updateStyle(m),this._layers[c(m)]=m},_addPath:function(m){var j=m._container;this._container.appendChild(j),m.options.interactive&&m.addInteractiveTarget(j)},_removePath:function(m){var j=m._container;rr(j),m.removeInteractiveTarget(j),delete this._layers[c(m)]},_updateStyle:function(m){var j=m._stroke,C=m._fill,I=m.options,q=m._container;q.stroked=!!I.stroke,q.filled=!!I.fill,I.stroke?(j||(j=m._stroke=Pp("stroke")),q.appendChild(j),j.weight=I.weight+"px",j.color=I.color,j.opacity=I.opacity,I.dashArray?j.dashStyle=b(I.dashArray)?I.dashArray.join(" "):I.dashArray.replace(/( *, *)/g," "):j.dashStyle="",j.endcap=I.lineCap.replace("butt","flat"),j.joinstyle=I.lineJoin):j&&(q.removeChild(j),m._stroke=null),I.fill?(C||(C=m._fill=Pp("fill")),q.appendChild(C),C.color=I.fillColor||I.color,C.opacity=I.fillOpacity):C&&(q.removeChild(C),m._fill=null)},_updateCircle:function(m){var j=m._point.round(),C=Math.round(m._radius),I=Math.round(m._radiusY||C);this._setPath(m,m._empty()?"M0 0":"AL "+j.x+","+j.y+" "+C+","+I+" 0,"+65535*360)},_setPath:function(m,j){m._path.v=j},_bringToFront:function(m){Hr(m._container)},_bringToBack:function(m){dn(m._container)}},gx=pt.vml?Pp:ae,Ap=$l.extend({_initContainer:function(){this._container=gx("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=gx("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){rr(this._container),cn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){$l.prototype._update.call(this);var m=this._bounds,j=m.getSize(),C=this._container;(!this._svgSize||!this._svgSize.equals(j))&&(this._svgSize=j,C.setAttribute("width",j.x),C.setAttribute("height",j.y)),Yr(C,m.min),C.setAttribute("viewBox",[m.min.x,m.min.y,j.x,j.y].join(" ")),this.fire("update")}},_initPath:function(m){var j=m._path=gx("path");m.options.className&&tr(j,m.options.className),m.options.interactive&&tr(j,"leaflet-interactive"),this._updateStyle(m),this._layers[c(m)]=m},_addPath:function(m){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(m._path),m.addInteractiveTarget(m._path)},_removePath:function(m){rr(m._path),m.removeInteractiveTarget(m._path),delete this._layers[c(m)]},_updatePath:function(m){m._project(),m._update()},_updateStyle:function(m){var j=m._path,C=m.options;j&&(C.stroke?(j.setAttribute("stroke",C.color),j.setAttribute("stroke-opacity",C.opacity),j.setAttribute("stroke-width",C.weight),j.setAttribute("stroke-linecap",C.lineCap),j.setAttribute("stroke-linejoin",C.lineJoin),C.dashArray?j.setAttribute("stroke-dasharray",C.dashArray):j.removeAttribute("stroke-dasharray"),C.dashOffset?j.setAttribute("stroke-dashoffset",C.dashOffset):j.removeAttribute("stroke-dashoffset")):j.setAttribute("stroke","none"),C.fill?(j.setAttribute("fill",C.fillColor||C.color),j.setAttribute("fill-opacity",C.fillOpacity),j.setAttribute("fill-rule",C.fillRule||"evenodd")):j.setAttribute("fill","none"))},_updatePoly:function(m,j){this._setPath(m,fe(m._parts,j))},_updateCircle:function(m){var j=m._point,C=Math.max(Math.round(m._radius),1),I=Math.max(Math.round(m._radiusY),1)||C,q="a"+C+","+I+" 0 1,0 ",J=m._empty()?"M0 0":"M"+(j.x-C)+","+j.y+q+C*2+",0 "+q+-C*2+",0 ";this._setPath(m,J)},_setPath:function(m,j){m._path.setAttribute("d",j)},_bringToFront:function(m){Hr(m._path)},_bringToBack:function(m){dn(m._path)}});pt.vml&&Ap.include(DY);function n6(m){return pt.svg||pt.vml?new Ap(m):null}Ir.include({getRenderer:function(m){var j=m.options.renderer||this._getPaneRenderer(m.options.pane)||this.options.renderer||this._renderer;return j||(j=this._renderer=this._createRenderer()),this.hasLayer(j)||this.addLayer(j),j},_getPaneRenderer:function(m){if(m==="overlayPane"||m===void 0)return!1;var j=this._paneRenderers[m];return j===void 0&&(j=this._createRenderer({pane:m}),this._paneRenderers[m]=j),j},_createRenderer:function(m){return this.options.preferCanvas&&r6(m)||n6(m)}});var s6=Sf.extend({initialize:function(m,j){Sf.prototype.initialize.call(this,this._boundsToLatLngs(m),j)},setBounds:function(m){return this.setLatLngs(this._boundsToLatLngs(m))},_boundsToLatLngs:function(m){return m=se(m),[m.getSouthWest(),m.getNorthWest(),m.getNorthEast(),m.getSouthEast()]}});function IY(m,j){return new s6(m,j)}Ap.create=gx,Ap.pointsToPath=fe,Il.geometryToLayer=cx,Il.coordsToLatLng=gb,Il.coordsToLatLngs=dx,Il.latLngToCoords=vb,Il.latLngsToCoords=ux,Il.getFeature=kf,Il.asFeature=fx,Ir.mergeOptions({boxZoom:!0});var i6=Tt.extend({initialize:function(m){this._map=m,this._container=m._container,this._pane=m._panes.overlayPane,this._resetStateTimeout=0,m.on("unload",this._destroy,this)},addHooks:function(){dr(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){cn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){rr(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(m){if(!m.shiftKey||m.which!==1&&m.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ta(),Nr(),this._startPoint=this._map.mouseEventToContainerPoint(m),dr(document,{contextmenu:Rl,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(m){this._moved||(this._moved=!0,this._box=kt("div","leaflet-zoom-box",this._container),tr(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(m);var j=new G(this._point,this._startPoint),C=j.getSize();Yr(this._box,j.min),this._box.style.width=C.x+"px",this._box.style.height=C.y+"px"},_finish:function(){this._moved&&(rr(this._box),Gr(this._container,"leaflet-crosshair")),qo(),zr(),cn(document,{contextmenu:Rl,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(m){if(!(m.which!==1&&m.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var j=new te(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(j).fire("boxzoomend",{boxZoomBounds:j})}},_onKeyDown:function(m){m.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ir.addInitHook("addHandler","boxZoom",i6),Ir.mergeOptions({doubleClickZoom:!0});var a6=Tt.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(m){var j=this._map,C=j.getZoom(),I=j.options.zoomDelta,q=m.originalEvent.shiftKey?C-I:C+I;j.options.doubleClickZoom==="center"?j.setZoom(q):j.setZoomAround(m.containerPoint,q)}});Ir.addInitHook("addHandler","doubleClickZoom",a6),Ir.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var o6=Tt.extend({addHooks:function(){if(!this._draggable){var m=this._map;this._draggable=new nr(m._mapPane,m._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),m.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),m.on("zoomend",this._onZoomEnd,this),m.whenReady(this._onZoomEnd,this))}tr(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Gr(this._map._container,"leaflet-grab"),Gr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var m=this._map;if(m._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var j=se(this._map.options.maxBounds);this._offsetLimit=X(this._map.latLngToContainerPoint(j.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(j.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;m.fire("movestart").fire("dragstart"),m.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(m){if(this._map.options.inertia){var j=this._lastTime=+new Date,C=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(C),this._times.push(j),this._prunePositions(j)}this._map.fire("move",m).fire("drag",m)},_prunePositions:function(m){for(;this._positions.length>1&&m-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var m=this._map.getSize().divideBy(2),j=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=j.subtract(m).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(m,j){return m-(m-j)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var m=this._draggable._newPos.subtract(this._draggable._startPos),j=this._offsetLimit;m.x<j.min.x&&(m.x=this._viscousLimit(m.x,j.min.x)),m.y<j.min.y&&(m.y=this._viscousLimit(m.y,j.min.y)),m.x>j.max.x&&(m.x=this._viscousLimit(m.x,j.max.x)),m.y>j.max.y&&(m.y=this._viscousLimit(m.y,j.max.y)),this._draggable._newPos=this._draggable._startPos.add(m)}},_onPreDragWrap:function(){var m=this._worldWidth,j=Math.round(m/2),C=this._initialWorldOffset,I=this._draggable._newPos.x,q=(I-j+C)%m+j-C,J=(I+j+C)%m-j-C,we=Math.abs(q+C)<Math.abs(J+C)?q:J;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=we},_onDragEnd:function(m){var j=this._map,C=j.options,I=!C.inertia||m.noInertia||this._times.length<2;if(j.fire("dragend",m),I)j.fire("moveend");else{this._prunePositions(+new Date);var q=this._lastPos.subtract(this._positions[0]),J=(this._lastTime-this._times[0])/1e3,we=C.easeLinearity,De=q.multiplyBy(we/J),ze=De.distanceTo([0,0]),ft=Math.min(C.inertiaMaxSpeed,ze),$t=De.multiplyBy(ft/ze),fr=ft/(C.inertiaDeceleration*we),Rr=$t.multiplyBy(-fr/2).round();!Rr.x&&!Rr.y?j.fire("moveend"):(Rr=j._limitOffset(Rr,j.options.maxBounds),R(function(){j.panBy(Rr,{duration:fr,easeLinearity:we,noMoveStart:!0,animate:!0})}))}}});Ir.addInitHook("addHandler","dragging",o6),Ir.mergeOptions({keyboard:!0,keyboardPanDelta:80});var l6=Tt.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(m){this._map=m,this._setPanDelta(m.options.keyboardPanDelta),this._setZoomDelta(m.options.zoomDelta)},addHooks:function(){var m=this._map._container;m.tabIndex<=0&&(m.tabIndex="0"),dr(m,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),cn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var m=document.body,j=document.documentElement,C=m.scrollTop||j.scrollTop,I=m.scrollLeft||j.scrollLeft;this._map._container.focus(),window.scrollTo(I,C)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(m){var j=this._panKeys={},C=this.keyCodes,I,q;for(I=0,q=C.left.length;I<q;I++)j[C.left[I]]=[-1*m,0];for(I=0,q=C.right.length;I<q;I++)j[C.right[I]]=[m,0];for(I=0,q=C.down.length;I<q;I++)j[C.down[I]]=[0,m];for(I=0,q=C.up.length;I<q;I++)j[C.up[I]]=[0,-1*m]},_setZoomDelta:function(m){var j=this._zoomKeys={},C=this.keyCodes,I,q;for(I=0,q=C.zoomIn.length;I<q;I++)j[C.zoomIn[I]]=m;for(I=0,q=C.zoomOut.length;I<q;I++)j[C.zoomOut[I]]=-m},_addHooks:function(){dr(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){cn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(m){if(!(m.altKey||m.ctrlKey||m.metaKey)){var j=m.keyCode,C=this._map,I;if(j in this._panKeys){if(!C._panAnim||!C._panAnim._inProgress)if(I=this._panKeys[j],m.shiftKey&&(I=Z(I).multiplyBy(3)),C.options.maxBounds&&(I=C._limitOffset(Z(I),C.options.maxBounds)),C.options.worldCopyJump){var q=C.wrapLatLng(C.unproject(C.project(C.getCenter()).add(I)));C.panTo(q)}else C.panBy(I)}else if(j in this._zoomKeys)C.setZoom(C.getZoom()+(m.shiftKey?3:1)*this._zoomKeys[j]);else if(j===27&&C._popup&&C._popup.options.closeOnEscapeKey)C.closePopup();else return;Rl(m)}}});Ir.addInitHook("addHandler","keyboard",l6),Ir.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var c6=Tt.extend({addHooks:function(){dr(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){cn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(m){var j=wp(m),C=this._map.options.wheelDebounceTime;this._delta+=j,this._lastMousePos=this._map.mouseEventToContainerPoint(m),this._startTime||(this._startTime=+new Date);var I=Math.max(C-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),I),Rl(m)},_performZoom:function(){var m=this._map,j=m.getZoom(),C=this._map.options.zoomSnap||0;m._stop();var I=this._delta/(this._map.options.wheelPxPerZoomLevel*4),q=4*Math.log(2/(1+Math.exp(-Math.abs(I))))/Math.LN2,J=C?Math.ceil(q/C)*C:q,we=m._limitZoom(j+(this._delta>0?J:-J))-j;this._delta=0,this._startTime=null,we&&(m.options.scrollWheelZoom==="center"?m.setZoom(j+we):m.setZoomAround(this._lastMousePos,j+we))}});Ir.addInitHook("addHandler","scrollWheelZoom",c6);var $Y=600;Ir.mergeOptions({tapHold:pt.touchNative&&pt.safari&&pt.mobile,tapTolerance:15});var d6=Tt.extend({addHooks:function(){dr(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){cn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(m){if(clearTimeout(this._holdTimeout),m.touches.length===1){var j=m.touches[0];this._startPos=this._newPos=new z(j.clientX,j.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(dr(document,"touchend",gs),dr(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",j))},this),$Y),dr(document,"touchend touchcancel contextmenu",this._cancel,this),dr(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function m(){cn(document,"touchend",gs),cn(document,"touchend touchcancel",m)},_cancel:function(){clearTimeout(this._holdTimeout),cn(document,"touchend touchcancel contextmenu",this._cancel,this),cn(document,"touchmove",this._onMove,this)},_onMove:function(m){var j=m.touches[0];this._newPos=new z(j.clientX,j.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(m,j){var C=new MouseEvent(m,{bubbles:!0,cancelable:!0,view:window,screenX:j.screenX,screenY:j.screenY,clientX:j.clientX,clientY:j.clientY});C._simulated=!0,j.target.dispatchEvent(C)}});Ir.addInitHook("addHandler","tapHold",d6),Ir.mergeOptions({touchZoom:pt.touch,bounceAtZoomLimits:!0});var u6=Tt.extend({addHooks:function(){tr(this._map._container,"leaflet-touch-zoom"),dr(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Gr(this._map._container,"leaflet-touch-zoom"),cn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(m){var j=this._map;if(!(!m.touches||m.touches.length!==2||j._animatingZoom||this._zooming)){var C=j.mouseEventToContainerPoint(m.touches[0]),I=j.mouseEventToContainerPoint(m.touches[1]);this._centerPoint=j.getSize()._divideBy(2),this._startLatLng=j.containerPointToLatLng(this._centerPoint),j.options.touchZoom!=="center"&&(this._pinchStartLatLng=j.containerPointToLatLng(C.add(I)._divideBy(2))),this._startDist=C.distanceTo(I),this._startZoom=j.getZoom(),this._moved=!1,this._zooming=!0,j._stop(),dr(document,"touchmove",this._onTouchMove,this),dr(document,"touchend touchcancel",this._onTouchEnd,this),gs(m)}},_onTouchMove:function(m){if(!(!m.touches||m.touches.length!==2||!this._zooming)){var j=this._map,C=j.mouseEventToContainerPoint(m.touches[0]),I=j.mouseEventToContainerPoint(m.touches[1]),q=C.distanceTo(I)/this._startDist;if(this._zoom=j.getScaleZoom(q,this._startZoom),!j.options.bounceAtZoomLimits&&(this._zoom<j.getMinZoom()&&q<1||this._zoom>j.getMaxZoom()&&q>1)&&(this._zoom=j._limitZoom(this._zoom)),j.options.touchZoom==="center"){if(this._center=this._startLatLng,q===1)return}else{var J=C._add(I)._divideBy(2)._subtract(this._centerPoint);if(q===1&&J.x===0&&J.y===0)return;this._center=j.unproject(j.project(this._pinchStartLatLng,this._zoom).subtract(J),this._zoom)}this._moved||(j._moveStart(!0,!1),this._moved=!0),F(this._animRequest);var we=o(j._move,j,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=R(we,this,!0),gs(m)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,F(this._animRequest),cn(document,"touchmove",this._onTouchMove,this),cn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ir.addInitHook("addHandler","touchZoom",u6),Ir.BoxZoom=i6,Ir.DoubleClickZoom=a6,Ir.Drag=o6,Ir.Keyboard=l6,Ir.ScrollWheelZoom=c6,Ir.TapHold=d6,Ir.TouchZoom=u6,r.Bounds=G,r.Browser=pt,r.CRS=ne,r.Canvas=t6,r.Circle=pb,r.CircleMarker=lx,r.Class=B,r.Control=zi,r.DivIcon=JC,r.DivOverlay=Go,r.DomEvent=nx,r.DomUtil=wf,r.Draggable=nr,r.Evented=Y,r.FeatureGroup=Ml,r.GeoJSON=Il,r.GridLayer=Cp,r.Handler=Tt,r.Icon=Nf,r.ImageOverlay=hx,r.LatLng=ue,r.LatLngBounds=te,r.Layer=io,r.LayerGroup=jf,r.LineUtil=mY,r.Map=Ir,r.Marker=ox,r.Mixin=vr,r.Path=$c,r.Point=z,r.PolyUtil=Br,r.Polygon=Sf,r.Polyline=Dl,r.Popup=mx,r.PosAnimation=bp,r.Projection=pY,r.Rectangle=s6,r.Renderer=$l,r.SVG=Ap,r.SVGOverlay=XC,r.TileLayer=Ef,r.Tooltip=px,r.Transformation=ee,r.Util=D,r.VideoOverlay=ZC,r.bind=o,r.bounds=X,r.canvas=r6,r.circle=jY,r.circleMarker=bY,r.control=Dc,r.divIcon=OY,r.extend=i,r.featureGroup=yY,r.geoJSON=KC,r.geoJson=kY,r.gridLayer=RY,r.icon=_Y,r.imageOverlay=EY,r.latLng=ye,r.latLngBounds=se,r.layerGroup=xY,r.map=sx,r.marker=wY,r.point=Z,r.polygon=SY,r.polyline=NY,r.popup=AY,r.rectangle=IY,r.setOptions=g,r.stamp=c,r.svg=n6,r.svgOverlay=PY,r.tileLayer=QC,r.tooltip=TY,r.transformation=H,r.version=n,r.videoOverlay=CY;var LY=window.L;r.noConflict=function(){return window.L=LY,this},window.L=r})})(J3,J3.exports);var ua=J3.exports;const oU=rn(ua);function Ov(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function s1(e,t){return t==null?function(n,i){const a=y.useRef();return a.current||(a.current=e(n,i)),a}:function(n,i){const a=y.useRef();a.current||(a.current=e(n,i));const o=y.useRef(n),{instance:l}=a.current;return y.useEffect(function(){o.current!==n&&(t(l,n,o.current),o.current=n)},[l,n,i]),a}}function lU(e,t){y.useEffect(function(){var i;return((i=t.layerContainer)!=null?i:t.map).addLayer(e.instance),function(){var o;(o=t.layerContainer)==null||o.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function cU(e){return function(r){const n=r1(),i=e(n1(r,n),n);return nU(n.map,r.attribution),ZE(i.current,r.eventHandlers),lU(i.current,n),i}}function zde(e,t){const r=y.useRef();y.useEffect(function(){var i;if(t.pathOptions!==r.current){const a=(i=t.pathOptions)!=null?i:{};e.instance.setStyle(a),r.current=a}},[e,t])}function Vde(e){return function(r){const n=r1(),i=e(n1(r,n),n);return ZE(i.current,r.eventHandlers),lU(i.current,n),zde(i.current,r),i}}function qde(e,t){const r=s1(e,t),n=cU(r);return aU(n)}function Wde(e,t){const r=s1(e),n=Bde(r,t);return Fde(n)}function dU(e,t){const r=s1(e,t),n=Vde(r);return aU(n)}function Hde(e,t){const r=s1(e,t),n=cU(r);return Ude(n)}function Gde(e,t,r){const{opacity:n,zIndex:i}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),i!=null&&i!==r.zIndex&&e.setZIndex(i)}function tp(){return r1().map}const Yde=dU(function(a,i){var o=a,{center:t,children:r}=o,n=me(o,["center","children"]);const l=new ua.Circle(t,n);return Ov(l,KE(i,{overlayContainer:l}))},Ide);function Q3(){return Q3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Q3.apply(this,arguments)}function Kde(f,h){var p=f,{bounds:e,boundsOptions:t,center:r,children:n,className:i,id:a,placeholder:o,style:l,whenReady:c,zoom:d}=p,u=me(p,["bounds","boundsOptions","center","children","className","id","placeholder","style","whenReady","zoom"]);const[x]=y.useState({className:i,id:a,style:l}),[g,v]=y.useState(null);y.useImperativeHandle(h,()=>{var b;return(b=g==null?void 0:g.map)!=null?b:null},[g]);const _=y.useCallback(b=>{if(b!==null&&g===null){const N=new ua.Map(b,u);r!=null&&d!=null?N.setView(r,d):e!=null&&N.fitBounds(e,t),c!=null&&N.whenReady(c),v(Lde(N))}},[]);y.useEffect(()=>()=>{g==null||g.map.remove()},[g]);const w=g?Q.createElement(iU,{value:g},n):o!=null?o:null;return Q.createElement("div",Q3({},x,{ref:_}),w)}const i1=y.forwardRef(Kde),jg=qde(function(i,n){var a=i,{position:t}=a,r=me(a,["position"]);const o=new ua.Marker(t,r);return Ov(o,KE(n,{overlayContainer:o}))},function(t,r,n){r.position!==n.position&&t.setLatLng(r.position),r.icon!=null&&r.icon!==n.icon&&t.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==n.zIndexOffset&&t.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==n.opacity&&t.setOpacity(r.opacity),t.dragging!=null&&r.draggable!==n.draggable&&(r.draggable===!0?t.dragging.enable():t.dragging.disable())}),Zde=dU(function(i,n){var a=i,{positions:t}=a,r=me(a,["positions"]);const o=new ua.Polyline(t,r);return Ov(o,KE(n,{overlayContainer:o}))},function(t,r,n){r.positions!==n.positions&&t.setLatLngs(r.positions)}),uU=Wde(function(t,r){const n=new ua.Popup(t,r.overlayContainer);return Ov(n,r)},function(t,r,{position:n},i){y.useEffect(function(){const{instance:o}=t;function l(d){d.popup===o&&(o.update(),i(!0))}function c(d){d.popup===o&&i(!1)}return r.map.on({popupopen:l,popupclose:c}),r.overlayContainer==null?(n!=null&&o.setLatLng(n),o.openOn(r.map)):r.overlayContainer.bindPopup(o),function(){var u;r.map.off({popupopen:l,popupclose:c}),(u=r.overlayContainer)==null||u.unbindPopup(),r.map.removeLayer(o)}},[t,r,i,n])}),a1=Hde(function(i,n){var a=i,{url:t}=a,r=me(a,["url"]);const o=new ua.TileLayer(t,n1(r,n));return Ov(o,n)},function(t,r,n){Gde(t,r,n);const{url:i}=r;i!=null&&i!==n.url&&t.setUrl(i)}),fU="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",hU="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",mU="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",Xde=e=>{const t=new Map;return e.forEach(r=>{if(!r.latitude||!r.longitude)return;const n=Number(r.latitude),i=Number(r.longitude);if(isNaN(n)||isNaN(i))return;const a=r.venue_id||`${r.venue_name}-${n}-${i}`;t.has(a)?t.get(a).events.push(r):t.set(a,{venueId:r.venue_id||a,venueName:r.venue_name||"Unknown Venue",venueAddress:r.venue_address||"",venueCity:r.venue_city||"",venueState:r.venue_state||"",latitude:n,longitude:i,events:[r]})}),t.forEach(r=>{r.events.sort((n,i)=>{const a=new Date(n.event_date),o=new Date(i.event_date);return a.getTime()-o.getTime()})}),Array.from(t.values())},Jde=new ua.Icon({iconUrl:hU,iconRetinaUrl:fU,shadowUrl:mU,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),Qde=({center:e,zoom:t})=>{const r=tp();return y.useEffect(()=>{r.setView(e,t)},[r,e,t]),null},eue=({onMapMove:e})=>{const t=tp();return y.useEffect(()=>{if(!e)return;const r=()=>{const n=t.getBounds();e({north:n.getNorth(),south:n.getSouth(),east:n.getEast(),west:n.getWest()})};return r(),t.on("moveend",r),t.on("zoomend",r),()=>{t.off("moveend",r),t.off("zoomend",r)}},[t,e]),null},XE=({center:e,zoom:t,events:r,onEventClick:n,onMapMove:i,showRadius:a=!1,radiusMiles:o=30,onVenueClick:l})=>{const c=y.useRef(null),d=r.filter(h=>{if(!h)return!1;const f=Number(h.latitude),p=Number(h.longitude);return h.latitude!=null&&h.longitude!=null&&!Number.isNaN(f)&&!Number.isNaN(p)}),u=Xde(d);return s.jsxs("div",{className:"w-full h-full",children:[s.jsx("style",{children:`
        .custom-scrollbar::-webkit-scrollbar {
          width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: #f1f5f9;
          border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: #e2e8f0;
          border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: #cbd5e1;
        }
        .venue-popup .leaflet-popup-content {
          margin: 0;
          padding: 0;
          border-radius: 12px;
          overflow: hidden;
          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
      `}),s.jsxs(i1,{center:e,zoom:t,style:{height:"100%",width:"100%"},ref:c,children:[s.jsx(a1,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(Qde,{center:e,zoom:t}),s.jsx(eue,{onMapMove:i}),a&&s.jsx(Yde,{center:e,radius:o*1609.34,pathOptions:{color:"#ec4899",fillColor:"#ec4899",fillOpacity:.1,weight:2,opacity:.6}}),u.map(h=>s.jsx(jg,{position:[h.latitude,h.longitude],icon:Jde,eventHandlers:{click:()=>{l&&l(h.venueId,h.venueName,h.latitude,h.longitude)}}},h.venueId))]})]})};class dl{static checkTableExists(){return E(this,null,function*(){return this.tableExistsCache!==null?this.tableExistsCache:this.tableCheckPromise?this.tableCheckPromise:(this.tableCheckPromise=E(this,null,function*(){var t,r;try{const{error:n}=yield P.from("event_promotions").select("id").limit(0),i=!n||n.code!=="PGRST205"&&n.code!=="42P01"&&!((t=n.message)!=null&&t.includes("does not exist"))&&!((r=n.message)!=null&&r.includes("Not Found"));return this.tableExistsCache=i,i}catch(n){return this.tableExistsCache=!1,!1}finally{this.tableCheckPromise=null}}),this.tableCheckPromise)})}static trackPromotionInteraction(t,r,n,i){return E(this,null,function*(){try{if(!(yield this.checkTableExists()))return;const{data:o,error:l}=yield P.from("event_promotions").select("id, impressions, clicks, conversions").eq("event_id",t).eq("promotion_status","active").lte("starts_at",new Date().toISOString()).gte("expires_at",new Date().toISOString());if(l||!o||o.length===0)return;for(const c of o){const d={};switch(n){case"view":d.impressions=(c.impressions||0)+1;break;case"click":d.clicks=(c.clicks||0)+1;break;case"conversion":d.conversions=(c.conversions||0)+1;break}if(Object.keys(d).length>0){const{error:u}=yield P.from("event_promotions").update(d).eq("id",c.id);u?console.error(`Error updating promotion ${c.id}:`,u):console.log(` Updated promotion ${c.id} ${n}:`,d)}}}catch(a){console.error("Error tracking promotion interaction:",a)}})}static getPromotionMetricsFromInteractions(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("event_promotions").select("*").eq("id",t).single();if(i||!n)throw new Error("Promotion not found");const{data:a,error:o}=yield P.from("interactions").select("event_type, entity_type, occurred_at").eq("entity_id",r).eq("entity_type","event").gte("occurred_at",n.starts_at).lte("occurred_at",n.expires_at);if(o)return console.error("Error fetching interactions for promotion metrics:",o),{impressions:n.impressions||0,clicks:n.clicks||0,conversions:n.conversions||0,ctr:0,conversion_rate:0};const l=(a==null?void 0:a.filter(f=>f.event_type==="view").length)||0,c=(a==null?void 0:a.filter(f=>f.event_type==="click").length)||0,d=(a==null?void 0:a.filter(f=>f.event_type==="click"&&f.entity_type==="ticket_link").length)||0,u=l>0?c/l*100:0,h=c>0?d/c*100:0;return{impressions:l,clicks:c,conversions:d,ctr:Math.round(u*100)/100,conversion_rate:Math.round(h*100)/100}}catch(n){return console.error("Error calculating promotion metrics from interactions:",n),{impressions:0,clicks:0,conversions:0,ctr:0,conversion_rate:0}}})}static syncPromotionMetrics(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("event_promotions").select("event_id, starts_at, expires_at").eq("id",t).single();if(n||!r)throw new Error("Promotion not found");const i=yield this.getPromotionMetricsFromInteractions(t,r.event_id),{error:a}=yield P.from("event_promotions").update({impressions:i.impressions,clicks:i.clicks,conversions:i.conversions}).eq("id",t);a?console.error("Error syncing promotion metrics:",a):console.log(` Synced promotion ${t} metrics:`,i)}catch(r){console.error("Error syncing promotion metrics:",r)}})}}_r(dl,"tableExistsCache",null),_r(dl,"tableCheckPromise",null);const tue=Object.freeze(Object.defineProperty({__proto__:null,PromotionTrackingService:dl},Symbol.toStringTag,{value:"Module"}));class Hn{static setEventInterest(t,r,n){return E(this,null,function*(){try{console.log(" setEventInterest called with:",{userId:t,jambaseEventId:r,interested:n});let i=r;const a=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(r),{data:o,error:l}=yield P.from("events").select("id").eq("id",r).maybeSingle();if(l)throw new Error(`Failed to verify event existence: ${l.message}`);if(a){if(!o)throw new Error(`Event not found: ${r}`)}else{const{data:S,error:k}=yield P.from("events").select("id").eq("jambase_event_id",r).maybeSingle();if(k)throw new Error(`Failed to lookup event by jambase_event_id: ${k.message}`);if(S)i=S.id;else throw new Error(`Event not found: ${r}`)}const{data:c,error:d}=yield P.auth.getUser();d&&console.warn(" Error getting auth user:",d);const u=c==null?void 0:c.user;(u==null?void 0:u.id)!==t&&console.warn(" User ID mismatch: auth.uid() =",u==null?void 0:u.id,"but userId param =",t);const{error:h,data:f}=yield P.rpc("set_user_interest",{p_event_id:String(i),interested:n});if(console.log(" RPC call result:",{error:h,eventUuid:i,rpcData:f}),h)throw console.error(" Detailed RPC error:",JSON.stringify(h,null,2)),h;console.log(" Checking if relationship was saved:",{userId:t,eventUuid:i,interested:n}),yield new Promise(S=>setTimeout(S,300));const{data:p,error:x}=yield P.rpc("check_user_interest",{p_event_id:String(i)});x&&console.warn(" check_user_interest RPC error (non-fatal):",x);const{data:g,error:v}=yield P.auth.getUser();v&&console.warn(" Error getting auth user:",v);const _=g==null?void 0:g.user,w=(_==null?void 0:_.id)||t;let{data:b,error:N}=yield P.from("user_event_relationships").select("*").eq("user_id",w).eq("event_id",i).eq("relationship_type","interested").maybeSingle();if(console.log(" Fresh state check result:",{found:!!b,error:N,eventUuid:i,interested:n}),N)throw N;if(n)try{console.log(" UserEventService: User expressed interest, joining verified chat...",{eventUuid:i,jambaseEventId:r,userId:t});const{data:S}=yield P.from("events").select("title, id").eq("id",i).maybeSingle(),k=(S==null?void 0:S.title)||"Event";yield tc.joinOrOpenVerifiedChat("event",i,k,t),console.log(" UserEventService: Successfully joined event verified chat")}catch(S){console.error(" UserEventService: Error joining event verified chat (non-fatal):",S)}try{wn.interest("event",r,n),console.log(" Tracked interest interaction:",{jambaseEventId:r,interested:n})}catch(S){console.error("Error tracking interest interaction:",S)}return b||{}}catch(i){throw console.error("Error setting event interest:",i),new Error(`Failed to set event interest: ${i instanceof Error?i.message:"Unknown error"}`)}})}static removeEventInterest(t,r){return E(this,null,function*(){try{let n=r;if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(r)){const{data:o}=yield P.from("events").select("id").eq("jambase_event_id",r).maybeSingle();if(o)n=o.id;else throw new Error(`Event not found: ${r}`)}const{error:a}=yield P.rpc("set_user_interest",{p_event_id:String(n),interested:!1});if(a)throw a;try{wn.interest("event",r,!1,{action:"remove"})}catch(o){}}catch(n){throw console.error("Error removing event interest:",n),new Error(`Failed to remove event interest: ${n instanceof Error?n.message:"Unknown error"}`)}})}static isUserInterested(t,r){return E(this,null,function*(){try{let n=r;if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(r)){const{data:h}=yield P.from("events").select("id").eq("jambase_event_id",r).maybeSingle();if(h)n=h.id;else return!1}const{data:a,error:o}=yield P.auth.getUser();o&&console.warn(" Error getting auth user:",o);const l=a==null?void 0:a.user,c=(l==null?void 0:l.id)||t,{data:d,error:u}=yield P.from("user_event_relationships").select("user_id, event_id").eq("user_id",c).eq("event_id",n).in("relationship_type",["interested","going","maybe"]).maybeSingle();if(u&&u.code!=="PGRST116")throw u;return!!d}catch(n){return console.error("Error checking event interest:",n),!1}})}static getUserInterestedEvents(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.auth.getUser();n&&console.warn(" Error getting auth user:",n);const i=r==null?void 0:r.user,a=(i==null?void 0:i.id)||t,{data:o,error:l}=yield P.from("user_event_relationships").select("*").eq("user_id",a).in("relationship_type",["interested","going","maybe"]).order("created_at",{ascending:!1});if(l)throw l;if(!o||o.length===0)return{events:[],total:0};const c=o.map(x=>x.event_id).filter(Boolean);if(c.length===0)return{events:[],total:0};const{data:d,error:u}=yield P.from("events").select("*").in("id",c);if(u)throw u;const h=d||[],f=new Map(h.map(x=>[x.id,x])),p=o.map(x=>{const g=f.get(x.event_id)||null;return{interest:{id:x.id,user_id:x.user_id,jambase_event_id:(g==null?void 0:g.jambase_event_id)||null,created_at:x.created_at},event:g}}).filter(x=>x.event!==null);return{events:p,total:p.length}}catch(r){throw console.error("Error getting user interested events:",r),new Error(`Failed to get user interested events: ${r instanceof Error?r.message:"Unknown error"}`)}})}static setEventReview(t,r,n){return E(this,null,function*(){try{const{data:i,error:a}=yield P.from("reviews").select("*").eq("user_id",t).eq("entity_type","event").eq("entity_id",r).maybeSingle();if(a)throw a;if(i){const{data:o,error:l}=yield P.from("reviews").update(W(M({},n),{updated_at:new Date().toISOString()})).eq("user_id",t).eq("entity_type","event").eq("entity_id",r).select().single();if(l)throw l;if(!o||typeof o!="object"||o.id===void 0)throw new Error("Failed to update event review");return o}else{const{data:o,error:l}=yield P.from("reviews").insert(M({user_id:t,entity_type:"event",entity_id:r},n)).select().single();if(l)throw l;if(!o||typeof o!="object"||o.id===void 0)throw new Error("Failed to create event review");return o}}catch(i){throw console.error("Error setting event review:",i),new Error(`Failed to set event review: ${i instanceof Error?i.message:"Unknown error"}`)}})}static getUserEventReview(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("reviews").select("*").eq("user_id",t).eq("entity_type","event").eq("entity_id",r).single();if(i&&i.code!=="PGRST116")throw i;return!n||typeof n!="object"||n.id===void 0?null:n}catch(n){return console.error("Error getting user event review:",n),null}})}static getEventReviews(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("reviews").select(`
          id,
          user_id,
          entity_id,
          rating,
          review_text,
          created_at,
          user:users!reviews_user_id_fkey (
            user_id,
            name,
            avatar_url
          )
        `).eq("entity_type","event").eq("entity_id",t).order("created_at",{ascending:!1});if(n)throw new Error(`Failed to fetch event reviews: ${n.message}`);const i=r||[],a=i.length,o=a>0?i.reduce((l,c)=>l+c.rating,0)/a:0;return{reviews:i,averageRating:o,totalReviews:a}}catch(r){throw console.error("Error getting event reviews:",r),new Error(`Failed to get event reviews: ${r instanceof Error?r.message:"Unknown error"}`)}})}static getUserEventHistory(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("reviews").select(`
          id,
          user_id,
          entity_id,
          rating,
          review_text,
          created_at,
          user:users!reviews_user_id_fkey (
            user_id,
            name,
            avatar_url
          ),
          event:events!reviews_entity_id_fkey(*)
        `).eq("user_id",t).eq("entity_type","event").order("created_at",{ascending:!1});if(n)throw new Error(`Failed to fetch user event history: ${n.message}`);return{reviews:r||[],total:(r==null?void 0:r.length)||0}}catch(r){throw console.error("Error getting user event history:",r),new Error(`Failed to get user event history: ${r instanceof Error?r.message:"Unknown error"}`)}})}static deleteEventReview(t,r){return E(this,null,function*(){try{const{error:n}=yield P.from("reviews").delete().eq("user_id",t).eq("entity_type","event").eq("entity_id",r);if(n)throw n}catch(n){throw console.error("Error deleting event review:",n),new Error(`Failed to delete event review: ${n instanceof Error?n.message:"Unknown error"}`)}})}static getUserUpcomingEvents(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.auth.getUser();n&&console.warn(" Error getting auth user:",n);const i=r==null?void 0:r.user,a=(i==null?void 0:i.id)||t,o=new Date;o.setHours(0,0,0,0);const l=o.toISOString().split("T")[0],{data:c,error:d}=yield P.from("user_event_relationships").select(`
          *,
          events:events!user_event_relationships_event_id_fkey!inner(*)
        `).eq("user_id",a).in("relationship_type",["interested","going","maybe"]).gte("events.event_date",l).order("events.event_date",{ascending:!0});if(d)throw new Error(`Failed to fetch upcoming events: ${d.message}`);return{events:(c||[]).map(u=>{const h=u.events;return{interest:{id:u.id,user_id:u.user_id,jambase_event_id:(h==null?void 0:h.jambase_event_id)||null,created_at:u.created_at},event:h}}),total:(c==null?void 0:c.length)||0}}catch(r){throw console.error("Error getting user upcoming events:",r),new Error(`Failed to get user upcoming events: ${r instanceof Error?r.message:"Unknown error"}`)}})}static markUserAttendance(t,r,n){return E(this,null,function*(){try{const{data:i,error:a}=yield P.from("reviews").select("id, was_there, review_text").eq("user_id",t).eq("entity_type","event").eq("entity_id",r).maybeSingle();if(a&&a.code!=="PGRST116")throw a;if(i)if(n){const{error:o}=yield P.from("reviews").update({was_there:n,updated_at:new Date().toISOString()}).eq("user_id",t).eq("entity_type","event").eq("entity_id",r);if(o)throw o}else if(i.review_text==="ATTENDANCE_ONLY"){console.log(" Deleting ATTENDANCE_ONLY record for:",{userId:t,eventId:r});const{error:o}=yield P.from("reviews").delete().eq("user_id",t).eq("event_id",r);if(o)throw console.error(" Error deleting ATTENDANCE_ONLY record:",o),o;console.log(" Successfully deleted ATTENDANCE_ONLY record")}else{const{error:o}=yield P.from("reviews").update({was_there:n,updated_at:new Date().toISOString()}).eq("user_id",t).eq("event_id",r);if(o)throw o}else if(n){console.log(" Creating ATTENDANCE_ONLY record for:",{userId:t,eventId:r,wasThere:n});const o={user_id:t,event_id:r,rating:1,review_text:"ATTENDANCE_ONLY",was_there:n,is_public:!1,is_draft:!1,likes_count:0,comments_count:0,shares_count:0,review_type:"event",artist_performance_rating:null,production_rating:null,venue_rating:null,location_rating:null,value_rating:null,artist_performance_feedback:null,production_feedback:null,venue_feedback:null,location_feedback:null,value_feedback:null,artist_performance_recommendation:null,production_recommendation:null,venue_recommendation:null,location_recommendation:null,value_recommendation:null,ticket_price_paid:null,rank_order:0};console.log(" ATTENDANCE_ONLY record data:",o);const{data:l,error:c}=yield P.from("reviews").insert(o).select("id, is_public, review_text").single();if(c)throw console.error(" Error creating ATTENDANCE_ONLY record:",c),c;if(console.log(" ATTENDANCE_ONLY record created:",l),l&&l.is_public===!0){console.error(" CRITICAL: ATTENDANCE_ONLY record was created as PUBLIC! This should not happen!"),console.error(" Record data:",l);const{error:d}=yield P.from("reviews").update({is_public:!1}).eq("id",l.id);d?console.error(" Failed to fix is_public flag:",d):console.log(" Fixed is_public flag for ATTENDANCE_ONLY record")}}try{wn.interest("event",r,n,{action:"attendance"})}catch(o){}}catch(i){throw console.error("Error marking user attendance:",i),new Error(`Failed to mark attendance: ${i instanceof Error?i.message:"Unknown error"}`)}})}static getUserAttendance(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("reviews").select("was_there, review_text, id, created_at").eq("user_id",t).eq("event_id",r).maybeSingle();if(console.log(" getUserAttendance:",{userId:t,eventId:r,data:n,error:i}),i&&i.code!=="PGRST116")throw i;if(n){const l=n.review_text&&n.review_text!=="ATTENDANCE_ONLY",c=!!n.was_there;return console.log(" Attendance check:",{hasReview:l,wasThere:c,reviewText:n.review_text,reviewId:n.id}),l&&!c?(console.log(" Auto-fixing attendance for review:",r),yield P.from("reviews").update({was_there:!0}).eq("user_id",t).eq("event_id",r),!0):c}console.log(" No review found, checking for any reviews for this user...");const{data:a,error:o}=yield P.from("reviews").select("id, event_id, review_text, was_there, created_at").eq("user_id",t).order("created_at",{ascending:!1}).limit(5);return console.log(" Recent reviews for user:",{allUserReviews:a,allError:o}),!1}catch(n){return console.error("Error checking user attendance:",n),!1}})}static getEventAttendanceCount(t){return E(this,null,function*(){try{const{count:r,error:n}=yield P.from("reviews").select("*",{count:"exact",head:!0}).eq("event_id",t).eq("was_there",!0);if(n)throw n;return r||0}catch(r){return console.error("Error getting event attendance count:",r),0}})}static getEventAttendees(t,r=10){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("reviews").select(`
          user_id,
          user:users!reviews_user_id_fkey(
            user_id,
            name,
            avatar_url
          )
        `).eq("event_id",t).eq("was_there",!0).limit(r);if(i)throw i;return(n||[]).map(a=>({user_id:a.user_id,name:a.profiles.name,avatar_url:a.profiles.avatar_url}))}catch(n){return console.error("Error getting event attendees:",n),[]}})}}const rue=Object.freeze(Object.defineProperty({__proto__:null,UserEventService:Hn},Symbol.toStringTag,{value:"Module"}));function iA(e,t={}){var r,n,i,a,o,l,c,d,u,h,f;return M({event_id:e.id,artist_name:e.artist_name||((r=e.event_data)==null?void 0:r.artist_name),venue_name:e.venue_name||((n=e.event_data)==null?void 0:n.venue_name),venue_city:e.venue_city||((i=e.event_data)==null?void 0:i.venue_city),venue_state:e.venue_state||((a=e.event_data)==null?void 0:a.venue_state),event_date:e.event_date||((o=e.event_data)==null?void 0:o.event_date),price_range:e.price_range||((l=e.event_data)==null?void 0:l.price_range),has_ticket_urls:!!((c=e.ticket_urls)!=null&&c.length||(u=(d=e.event_data)==null?void 0:d.ticket_urls)!=null&&u.length),has_setlist:!!(e.setlist||(h=e.event_data)!=null&&h.setlist),genres:e.genres||((f=e.event_data)==null?void 0:f.genres)},t)}function Gp(e){const t=new Date().getTime(),n=new Date(e).getTime()-t;return Math.ceil(n/(1e3*60*60*24))}function nue(e){const t=new URLSearchParams;return t.set("utm_source",e.source||"synth"),t.set("utm_medium",e.medium||"app"),t.set("utm_campaign",e.campaign||"event_discovery"),e.content&&t.set("utm_content",e.content),e.term&&t.set("utm_term",e.term),t}function sue(e,t){try{const r=new URL(e);return nue({source:"synth",medium:"app",campaign:"event_modal",content:`event_${t.eventId}`,term:t.userId}).forEach((i,a)=>{r.searchParams.set(a,i)}),t.userId&&r.searchParams.set("synth_user_id",t.userId),r.searchParams.set("synth_event_id",t.eventId),r.toString()}catch(r){return console.error("Error adding UTM parameters:",r),e}}function iue(e){try{const r=new URL(e).hostname.replace("www.",""),n={"ticketmaster.com":"Ticketmaster","stubhub.com":"StubHub","seatgeek.com":"SeatGeek","viagogo.com":"Viagogo","eventbrite.com":"Eventbrite","axs.com":"AXS","ticketfly.com":"Ticketfly","etix.com":"Etix","ticketweb.com":"TicketWeb","universe.com":"Universe"};for(const[i,a]of Object.entries(n))if(r.includes(i))return a;return r.split(".")[0]}catch(t){return"unknown"}}function o1({entityType:e,entityId:t,entityName:r,currentUserId:n,onChatOpen:i,className:a,variant:o="default"}){const[l,c]=y.useState(null),[d,u]=y.useState(!1),[h,f]=y.useState(!1),{toast:p}=jr();y.useEffect(()=>{console.log(" VerifiedChatBadge: Component mounted/updated",{entityType:e,entityId:t,entityName:r,currentUserId:n}),x()},[e,t,n]);const x=()=>E(this,null,function*(){try{console.log(" VerifiedChatBadge: Loading chat info...",{entityType:e,entityId:t,entityName:r}),u(!0);let w=yield tc.getVerifiedChatInfo(e,t);if(console.log(" VerifiedChatBadge: Initial chat info check:",w),!w||!w.chat_id){console.log(" VerifiedChatBadge: Chat does not exist, creating verified chat...");try{const b=yield tc.getOrCreateVerifiedChat(e,t,r);console.log(" VerifiedChatBadge: Verified chat created, chatId:",b),w=yield tc.getVerifiedChatInfo(e,t),console.log(" VerifiedChatBadge: Chat info after creation:",w)}catch(b){console.error(" VerifiedChatBadge: Error creating verified chat:",b)}}c(w)}catch(w){console.error(" VerifiedChatBadge: Error loading chat info:",w)}finally{u(!1)}}),g=()=>E(this,null,function*(){if(console.log(" VerifiedChatBadge: handleJoinOrOpen called",{entityType:e,entityId:t,entityName:r,currentUserId:n,hasOnChatOpen:!!i}),!n){console.log(" VerifiedChatBadge: No currentUserId, showing sign in toast"),p({title:"Please sign in",description:"You need to be signed in to join chats",variant:"destructive"});return}try{f(!0),console.log(" VerifiedChatBadge: Calling joinOrOpenVerifiedChat...");const w=yield tc.joinOrOpenVerifiedChat(e,t,r,n);console.log(" VerifiedChatBadge: joinOrOpenVerifiedChat returned chatId:",w),console.log(" VerifiedChatBadge: Reloading chat info..."),yield x(),console.log(" VerifiedChatBadge: Chat info reloaded"),i?(console.log(" VerifiedChatBadge: Calling onChatOpen callback with chatId:",w),i(w)):(console.log(" VerifiedChatBadge: No onChatOpen callback, showing toast"),p({title:"Chat opened",description:"You can now participate in the chat"})),console.log(" VerifiedChatBadge: handleJoinOrOpen completed successfully")}catch(w){console.error(" VerifiedChatBadge: Error joining/opening chat:",w),p({title:"Error",description:"Failed to join chat. Please try again.",variant:"destructive"})}finally{f(!1)}}),v=()=>{if(!(l!=null&&l.last_activity_at))return null;try{const w=new Date(l.last_activity_at);return D2(w,{addSuffix:!0})}catch(w){return null}},_=()=>{if(!(l!=null&&l.last_activity_at))return!1;try{const w=new Date(l.last_activity_at);return(Date.now()-w.getTime())/(1e3*60*60)<24}catch(w){return!1}};return o==="compact"?s.jsxs(oe,{variant:"ghost",size:"sm",onClick:g,disabled:h||d,className:ke("h-8 px-2",a),children:[h||d?s.jsx(er,{className:"h-4 w-4 animate-spin"}):s.jsx(g0,{className:"h-4 w-4"}),l!=null&&l.member_count?s.jsx("span",{className:"ml-1 text-xs",children:l.member_count}):null]}):s.jsxs("div",{className:ke("flex items-center gap-2",a),children:[d?s.jsxs(oe,{variant:"outline",size:"sm",disabled:!0,children:[s.jsx(er,{className:"h-4 w-4 animate-spin mr-2"}),"Loading..."]}):l!=null&&l.chat_id?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Be,{variant:"outline",className:"flex items-center gap-1.5 px-2 py-1",children:[s.jsx(g0,{className:"h-3.5 w-3.5 text-synth-pink"}),s.jsxs("span",{className:"text-xs font-medium",children:[l.member_count||0," ",l.member_count===1?"member":"members"]}),_()&&s.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-green-500",title:"Active"})]}),s.jsx(oe,{variant:l.is_user_member?"default":"outline",size:"sm",onClick:g,disabled:h,className:"h-8",children:h?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"h-3.5 w-3.5 animate-spin mr-1.5"}),"Joining..."]}):l.is_user_member?s.jsxs(s.Fragment,{children:[s.jsx(g0,{className:"h-3.5 w-3.5 mr-1.5"}),"Open Chat"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ar,{className:"h-3.5 w-3.5 mr-1.5"}),"Join Chat"]})})]}):s.jsx(oe,{variant:"outline",size:"sm",onClick:g,disabled:h,className:"h-8",children:h?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"h-3.5 w-3.5 animate-spin mr-1.5"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(g0,{className:"h-3.5 w-3.5 mr-1.5"}),"Start Chat"]})}),(l==null?void 0:l.last_activity_at)&&v()&&s.jsx("span",{className:"text-xs text-muted-foreground hidden sm:inline",children:v()})]})}function Cc({event:e,currentUserId:t,isOpen:r,onClose:n,onInterestToggle:i,onReview:a,onAttendanceChange:o,isInterested:l=!1,hasReviewed:c=!1,onNavigateToProfile:d,onNavigateToChat:u}){const h=ci(),[f,p]=y.useState(e),[x,g]=y.useState(!1),[v,_]=y.useState(l),[w,b]=y.useState(null),[N,S]=y.useState(!1),[k,O]=y.useState(null);y.useState(!1),y.useState([]),y.useState(1),y.useState(0);const[A,T]=y.useState(!1),[$,R]=y.useState(!1),[F,D]=y.useState(!1),[B,U]=y.useState(!1),[V,Y]=y.useState(!1),[z,K]=y.useState(!1),[Z,G]=y.useState(!1),[X,te]=y.useState(!1),[se,ue]=y.useState([]),[ye,ne]=y.useState(null),[xe,ge]=y.useState(!1),ie=y.useRef(!1),[ee,H]=y.useState(null),[le,Se]=y.useState(null),[ae,fe]=y.useState(!1),{toast:he}=jr(),{isCreator:pe,isAdmin:Ae,isBusiness:qe}=Wu(),Fe=y.useRef(null),ve=y.useRef(!1);y.useEffect(()=>{p(e),ie.current=!1},[e,pe,Ae]),y.useEffect(()=>{r&&(f!=null&&f.id)&&t&&!ie.current&&(ie.current=!0,rt())},[r,f==null?void 0:f.id,t]),y.useEffect(()=>{_(l)},[l]);const rt=()=>E(this,null,function*(){if(!(!(f!=null&&f.id)||!t||xe))try{ge(!0);const{VerifiedChatService:ce}=yield on(()=>E(this,null,function*(){const{VerifiedChatService:vt}=yield Promise.resolve().then(()=>nde);return{VerifiedChatService:vt}}),void 0,import.meta.url),Ee=yield ce.getOrCreateVerifiedChat("event",f.id,f.title||"Event"),Qe=yield ce.getVerifiedChatInfo("event",f.id);ne(Qe)}catch(ce){console.error("Error loading verified chat:",ce),ie.current=!1}finally{ge(!1)}});if(y.useEffect(()=>{var ce;if(r&&(f!=null&&f.id)){Fe.current=Date.now(),ve.current=!1;const Ee=iA(f,{source:"event_modal",has_ticket_urls:!!((ce=f.ticket_urls)!=null&&ce.length),has_setlist:!!f.setlist,price_range:f.price_range,days_until_event:f.event_date?Gp(f.event_date):void 0});wn.view("event",f.id,void 0,Ee)}return()=>{if(Fe.current&&(f!=null&&f.id)){const Ee=Math.floor((Date.now()-Fe.current)/1e3);wn.view("event",f.id,Ee,{source:"event_modal_close",duration_seconds:Ee,interacted:ve.current}),Fe.current=null}}},[r,f==null?void 0:f.id]),y.useEffect(()=>{var ce;if(r&&(f!=null&&f.id)){Fe.current=Date.now(),ve.current=!1;const Ee=iA(f,{source:"event_modal",has_ticket_urls:!!((ce=f.ticket_urls)!=null&&ce.length),has_setlist:!!f.setlist,price_range:f.price_range,days_until_event:f.event_date?Gp(f.event_date):void 0});wn.view("event",f.id,void 0,Ee)}return()=>{if(Fe.current&&(f!=null&&f.id)){const Ee=Math.floor((Date.now()-Fe.current)/1e3);wn.view("event",f.id,Ee,{source:"event_modal_close",duration_seconds:Ee,interacted:ve.current}),Fe.current=null}}},[r,f==null?void 0:f.id]),y.useEffect(()=>{r&&e&&(p(e),g(!1))},[r,e]),y.useEffect(()=>{f&&r&&new Date(f.event_date)<new Date&&Le()},[f==null?void 0:f.id,r,t]),y.useEffect(()=>{if(!f||!r)return;const ce=new Date(f.event_date)<new Date,Ee=f.setlist,Qe=Ee&&Ee!==null&&typeof Ee=="object"&&Object.keys(Ee).length>0&&(Array.isArray(Ee)||Ee.songs&&Array.isArray(Ee.songs)||Ee.setlist&&Array.isArray(Ee.setlist)),vt=f.setlist_enriched===!0;ce&&!Qe&&!vt&&f.artist_name&&E(this,null,function*(){U(!0);try{const Ht=new Date(f.event_date),Rt=`${String(Ht.getDate()).padStart(2,"0")}-${String(Ht.getMonth()+1).padStart(2,"0")}-${Ht.getFullYear()}`;let Te=null;if(Te=yield Ph.searchSetlists({artistName:f.artist_name,date:Rt,venueName:f.venue_name,cityName:f.venue_city,stateCode:f.venue_state}),(!Te||Te.length===0)&&(Te=yield Ph.searchSetlists({artistName:f.artist_name,date:Rt})),(!Te||Te.length===0)&&(Te=yield Ph.searchSetlists({artistName:f.artist_name})),Te&&Te.length>0){let bt=Te.find($e=>{var Re,We;const Ie=new Date($e.eventDate),Ue=new Date(f.event_date),dt=Ie.toDateString()===Ue.toDateString(),be=$e.venue.name.toLowerCase().includes(((Re=f.venue_name)==null?void 0:Re.toLowerCase())||"")||((We=f.venue_name)==null?void 0:We.toLowerCase().includes($e.venue.name.toLowerCase()));return dt&&be});bt||(bt=Te.find($e=>{const Ie=new Date($e.eventDate),Ue=new Date(f.event_date);return Ie.toDateString()===Ue.toDateString()})),bt||(bt=Te[0]),p($e=>$e&&W(M({},$e),{setlist:bt,setlist_enriched:!0,setlist_song_count:bt.songCount||0,setlist_fm_id:bt.setlistFmId,setlist_fm_url:bt.url,setlist_source:"setlist.fm",setlist_last_updated:new Date().toISOString()}))}}catch(Ht){console.error("Error fetching setlist from setlist.fm:",Ht)}finally{U(!1)}})},[f==null?void 0:f.id,f==null?void 0:f.event_date,f==null?void 0:f.artist_name,f==null?void 0:f.venue_name,r]),y.useEffect(()=>{E(this,null,function*(){if(f!=null&&f.id)try{const Ee=f.id,{count:Qe,error:vt}=yield P.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("event_id",Ee).eq("relationship_type","interested").neq("user_id",t),{data:wt,error:Ht}=yield P.from("user_event_relationships").select("user_id").eq("event_id",Ee).eq("relationship_type","interested");if(vt){const{data:Rt,error:Te}=yield P.from("user_event_relationships").select("user_id").eq("event_id",Ee).eq("relationship_type","interested");if(Te)throw console.error("Alternative query also failed:",Te),Te;const $e=((Rt==null?void 0:Rt.filter(Ie=>Ie&&"user_id"in Ie&&Ie.user_id!==t))||[]).length;b($e)}else{const Rt=Qe!=null?Qe:0;b(Rt)}}catch(Ee){console.error(" Error fetching interested count:",Ee),b(null)}})},[f==null?void 0:f.id,t]),!f)return null;const Ve=ce=>new Date(ce).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),lt=ce=>new Date(ce).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),ut=ce=>ce?new Date(ce).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):null,Ze=new Date(f.event_date)<new Date,qt=new Date(f.event_date)>=new Date,lr=()=>{const ce=[f.venue_city,f.venue_state].filter(Boolean);return ce.length>0?ce.join(", "):"Location TBD"},Ge=()=>f.venue_address?f.venue_address:lr(),Le=()=>E(this,null,function*(){try{if(fe(!0),!(f!=null&&f.id)||!t){H(!1),Se(0);return}const ce=yield Hn.getUserAttendance(t,f.id);H(ce);const Ee=yield Hn.getEventAttendanceCount(f.id);Se(Ee)}catch(ce){console.error("Error loading attendance data:",ce),H(!1),Se(0)}finally{fe(!1)}}),yt=()=>E(this,null,function*(){try{fe(!0);const ce=!ee;if(!(f!=null&&f.id))throw new Error("Event ID is missing");yield Hn.markUserAttendance(t,f.id,ce),H(ce);const Ee=yield Hn.getEventAttendanceCount(f.id);Se(Ee),o&&o(f.id,ce),he({title:ce?"Marked as attended!":"Removed attendance",description:ce?"You've marked that you were at this event. Add a review to share your experience!":"You've removed your attendance for this event"}),yield Le()}catch(ce){console.error("Error toggling attendance:",ce),he({title:"Error",description:"Failed to update attendance",variant:"destructive"})}finally{fe(!1)}}),Ne=()=>{f.artist_name&&(wn.click("artist",f.artist_name,{source:"event_modal",event_id:f.id,artist_name:f.artist_name,from_view:window.location.pathname}),wn.click("event",f.id,{source:"event_modal_artist_click",artist_name:f.artist_name,venue_name:f.venue_name,event_date:f.event_date,genres:f.genres,price_range:f.price_range,days_until_event:f.event_date?Gp(f.event_date):void 0}),dl.trackPromotionInteraction(f.id,t||"","click",{source:"event_modal_artist_click",artist_name:f.artist_name,venue_name:f.venue_name}),ve.current=!0,n(),h(`/artist/${encodeURIComponent(f.artist_name)}`,{state:{fromFeed:window.location.pathname,eventId:f.id}}))},Oe=()=>{f.venue_name&&(wn.click("venue",f.venue_name,{source:"event_modal",event_id:f.id,venue_name:f.venue_name,venue_city:f.venue_city,venue_state:f.venue_state,from_view:window.location.pathname}),wn.click("event",f.id,{source:"event_modal_venue_click",artist_name:f.artist_name,venue_name:f.venue_name,event_date:f.event_date,genres:f.genres,price_range:f.price_range,days_until_event:f.event_date?Gp(f.event_date):void 0}),dl.trackPromotionInteraction(f.id,t||"","click",{source:"event_modal_venue_click",artist_name:f.artist_name,venue_name:f.venue_name}),ve.current=!0,n(),h(`/venue/${encodeURIComponent(f.venue_name)}`,{state:{fromFeed:window.location.pathname,eventId:f.id}}))};return r?s.jsxs("div",{className:"fixed inset-0 z-50 bg-[#fcfcfc] overflow-y-auto overflow-x-hidden w-full max-w-full",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))",pointerEvents:"auto"},children:[s.jsxs("div",{className:"bg-[#fcfcfc] border-b border-gray-200 w-full max-w-full",children:[s.jsxs("div",{className:"px-4 py-3 flex items-start justify-between gap-2",children:[s.jsx("h1",{className:"text-lg font-bold leading-tight flex-1 min-w-0 pr-2 break-words",children:f.title}),s.jsx("button",{onClick:n,className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",children:s.jsx(pr,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"px-4 pb-3",children:[s.jsxs("div",{className:"mb-2 flex gap-1.5 flex-wrap",children:[qt&&i&&s.jsxs(oe,{variant:v?"default":"outline",size:"sm",type:"button",onClick:()=>E(this,null,function*(){console.log("Interest button clicked",{currentState:v,eventId:f==null?void 0:f.id});const ce=!v;_(ce),ce&&dl.trackPromotionInteraction(f.id,t||"","conversion",{source:"event_modal_interest_button",action:"interested"});try{yield i==null?void 0:i(f.id,ce)}catch(Ee){console.error("Error toggling interest:",Ee),_(!ce)}}),className:v?"bg-red-500 hover:bg-red-600 text-white text-xs px-3 py-1 h-7":"hover:bg-red-50 hover:text-red-600 hover:border-red-300 text-xs px-3 py-1 h-7",style:{pointerEvents:"auto",zIndex:10,position:"relative"},children:[s.jsx(hs,{className:`w-4 h-4 mr-1 ${v?"fill-current":""}`}),v?"Interested":"I'm Interested"]}),s.jsxs("button",{type:"button",onClick:ce=>{ce.preventDefault(),ce.stopPropagation(),console.log("Report button clicked",{eventId:f==null?void 0:f.id}),f!=null&&f.id?(console.log("Opening report modal, current state:",$),R(!0),console.log("Report modal should now be open")):he({title:"Error",description:"Unable to report this content",variant:"destructive"})},className:"text-gray-600 hover:text-red-600 text-xs px-3 py-1 h-7 cursor-pointer flex items-center gap-1 rounded-md hover:bg-gray-100 transition-colors",style:{pointerEvents:"auto",zIndex:100,position:"relative"},children:[s.jsx(Va,{className:"w-3 h-3"}),s.jsx("span",{className:"text-xs",children:"Report"})]})]}),s.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground mb-3 flex-wrap",children:[s.jsx(Et,{className:"w-4 h-4"}),s.jsx("span",{children:Ve(f.event_date)}),s.jsx("span",{children:""}),s.jsx(ai,{className:"w-4 h-4"}),s.jsx("span",{children:lt(f.event_date)}),f.doors_time&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{children:["Doors: ",ut(f.doors_time)]})]}),(()=>{var wt,Ht;const ce=f,Ee=ce==null?void 0:ce.price_range,Qe=(wt=ce==null?void 0:ce.ticket_price_min)!=null?wt:ce==null?void 0:ce.price_min,vt=(Ht=ce==null?void 0:ce.ticket_price_max)!=null?Ht:ce==null?void 0:ce.price_max;if(Ee||Qe||vt){let Rt="";return Ee?Rt=bg(Ee):Qe&&vt?Rt=`$${Qe} - $${vt}`:Qe?Rt=`$${Qe}+`:vt&&(Rt=`Up to $${vt}`),s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsx(xc,{className:"w-4 h-4"}),s.jsx("span",{className:"font-medium text-gray-900",children:Rt})]})}return null})()]}),Ze&&i&&v&&s.jsxs(oe,{variant:"outline",size:"sm",type:"button",onClick:()=>{console.log("Remove interest button clicked"),i(f.id,!1)},className:"text-gray-600 hover:text-red-600 hover:border-red-300",style:{pointerEvents:"auto",zIndex:10},children:[s.jsx(pr,{className:"w-4 h-4 mr-1"}),"Remove Interest"]})]})]}),s.jsxs("div",{className:`flex flex-col px-4 pb-28 w-full max-w-full overflow-x-hidden ${N?"pb-40":""}`,id:"event-details-desc",children:[s.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-3",children:[Ze&&s.jsx(Be,{variant:"secondary",className:"text-sm",children:"Past Event"}),qt&&s.jsx(Be,{variant:"default",className:"text-sm",children:"Upcoming"}),s.jsx(kde,{eventId:f.id}),s.jsx(Sde,{eventId:f.id}),s.jsx(Ede,{interestedCount:w||0,attendanceCount:le||0})]}),s.jsxs("div",{className:"flex flex-col gap-3 mb-3",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 w-full",children:[s.jsxs("h3",{className:"text-sm font-semibold mb-1.5 flex items-center gap-1.5",children:[s.jsx(Ct,{className:"w-4 h-4 flex-shrink-0"}),s.jsx("span",{children:"Artist"})]}),s.jsx("div",{className:"font-medium text-sm cursor-pointer hover:text-pink-600 transition-colors break-words",onClick:Ne,title:"Click to view all events for this artist",children:f.artist_name}),f.genres&&f.genres.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-1.5",children:f.genres.slice(0,3).map((ce,Ee)=>s.jsx(Be,{variant:"secondary",className:"text-xs",children:ce},Ee))})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 w-full",children:[s.jsxs("h3",{className:"text-sm font-semibold mb-1.5 flex items-center gap-1.5",children:[s.jsx(Xt,{className:"w-4 h-4 flex-shrink-0"}),s.jsx("span",{children:"Venue"})]}),s.jsx("div",{className:"font-medium text-sm mb-1 cursor-pointer hover:text-pink-600 transition-colors break-words",onClick:Oe,title:"Click to view all events at this venue",children:f.venue_name}),s.jsx("div",{className:"text-muted-foreground text-xs break-words",children:Ge()}),f.venue_zip&&s.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["ZIP: ",f.venue_zip]})]})]}),s.jsx(YE,{artistName:f.artist_name,venueName:f.venue_name,artistId:f.artist_id,venueId:f.venue_id}),s.jsxs("div",{className:"mt-4 space-y-3",children:[s.jsxs("div",{className:"flex gap-1 border-b pb-2 flex-wrap",children:[s.jsx(oe,{variant:Z?"default":"ghost",size:"sm",className:"text-xs px-2 py-1 h-7",onClick:()=>{G(!Z),K(!1),Y(!1)},children:s.jsx("span",{className:"text-xs",children:" Photos"})}),s.jsxs(oe,{variant:z?"default":"ghost",size:"sm",className:"text-xs px-2 py-1 h-7 whitespace-nowrap",onClick:()=>{K(!z),G(!1),Y(!1)},children:[s.jsx(Ar,{className:"h-3 w-3 mr-1 flex-shrink-0"}),s.jsxs("span",{className:"text-xs",children:["Groups (",se.length+(ye!=null&&ye.chat_id?1:0),")"]})]}),qt&&s.jsxs(oe,{variant:V?"default":"ghost",size:"sm",className:"text-xs px-2 py-1 h-7 whitespace-nowrap",onClick:()=>{Y(!V),G(!1),K(!1)},children:[s.jsx(hs,{className:"h-3 w-3 mr-1 flex-shrink-0"}),s.jsxs("span",{className:"text-xs",children:["Meet (",w!==null?w:0,")"]})]})]}),Z&&s.jsx(Tde,{eventId:f.id,eventTitle:f.title,canUpload:Ze}),z&&s.jsx("div",{className:"flex items-center justify-center py-24",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(Wn,{className:"w-12 h-12 mx-auto text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Verified chats are coming soon!"})]})}),V&&s.jsx(Cde,W(M({eventId:f.id,eventTitle:f.title},w!==null&&{interestedCount:w}),{onMatchCreated:ce=>{he({title:"New Match! ",description:`You matched with ${ce.name}!`})},onNavigateToProfile:ce=>{d&&(d(ce),n())}}))]}),(()=>{const ce=f==null?void 0:f.setlist,Ee=ce&&ce!==null&&typeof ce=="object"&&Object.keys(ce).length>0&&(Array.isArray(ce)||ce.songs&&Array.isArray(ce.songs)||ce.setlist&&Array.isArray(ce.setlist)),Qe=(f==null?void 0:f.setlist_enriched)===!0,vt=(f==null?void 0:f.setlist_song_count)&&f.setlist_song_count>0;return Ze&&(Ee||Qe||vt||B)})()&&s.jsx(Nde,{type:"single",collapsible:!0,value:F?"setlist":"",onValueChange:ce=>D(ce==="setlist"),className:"mb-6",children:s.jsxs(QF,{value:"setlist",className:"border border-purple-200 rounded-lg",children:[s.jsx(eU,{className:"px-6 py-4 hover:no-underline",children:s.jsxs("div",{className:"flex items-center gap-3 w-full",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center",children:s.jsx(Ct,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("h3",{className:"text-lg font-bold text-purple-900",children:"Setlist from this Show"}),s.jsxs("p",{className:"text-sm text-purple-700",children:[(()=>{if(f.setlist_song_count&&f.setlist_song_count>0)return f.setlist_song_count;const ce=f.setlist;return ce&&ce.songs?ce.songs.length:"Multiple"})()," songs performed"]})]}),f.setlist_fm_url&&s.jsx(oe,{variant:"outline",size:"sm",asChild:!0,className:"border-purple-300 hover:bg-purple-100",onClick:ce=>ce.stopPropagation(),children:s.jsxs("a",{href:f.setlist_fm_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1",children:[s.jsx("span",{children:"View on setlist.fm"}),s.jsx(aa,{className:"w-3 h-3"})]})})]})}),s.jsx(tU,{className:"px-6 pb-6 max-h-96 overflow-y-auto",children:B?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ct,{className:"w-8 h-8 text-purple-500 mx-auto mb-3 animate-pulse"}),s.jsx("p",{className:"text-purple-700",children:"Loading setlist from setlist.fm..."})]}):(()=>{const ce=f.setlist;let Ee=[];return ce&&typeof ce=="object"&&(Array.isArray(ce)?Ee=ce:ce.songs&&Array.isArray(ce.songs)?Ee=ce.songs:ce.setlist&&Array.isArray(ce.setlist)&&(Ee=ce.setlist)),!Ee||Ee.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx("p",{className:"text-purple-700",children:"Setlist data is available but in an unexpected format."}),s.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Data keys: ",ce?Object.keys(ce).join(", "):"none"]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Setlist type: ",typeof ce]})]}):s.jsxs("div",{className:"space-y-4",children:[Array.from(new Set(Ee.map(Qe=>Qe.setNumber||1))).map(Qe=>{var Ht;const vt=Ee.filter(Rt=>(Rt.setNumber||1)===Qe),wt=((Ht=vt[0])==null?void 0:Ht.setName)||`Set ${Qe}`;return s.jsxs("div",{className:"bg-white/70 rounded-lg p-4",children:[s.jsxs("h4",{className:"font-semibold text-purple-900 mb-3 flex items-center gap-2",children:[s.jsx(Ct,{className:"w-4 h-4"}),wt]}),s.jsx("div",{className:"space-y-1",children:vt.map((Rt,Te)=>s.jsxs("div",{className:"flex items-start gap-3 py-1",children:[s.jsxs("span",{className:"text-purple-600 font-medium min-w-[28px] text-sm",children:[Rt.position||Te+1,"."]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("span",{className:"text-gray-900 text-sm font-medium",children:Rt.name||Rt.title||Rt.song||"Unknown Song"}),Rt.cover&&s.jsxs("span",{className:"text-xs text-purple-600 bg-purple-100 px-2 py-0.5 rounded-full",children:[Rt.cover.artist||Rt.cover," cover"]})]}),(Rt.info||Rt.notes)&&s.jsx("p",{className:"text-xs text-gray-600 mt-1 italic",children:Rt.info||Rt.notes})]})]},Rt.position||Te))})]},Qe)}),ce.info&&s.jsx("div",{className:"bg-purple-100/50 rounded-lg p-3 mt-4",children:s.jsxs("p",{className:"text-sm text-purple-900",children:[s.jsx("span",{className:"font-semibold",children:"Note:"})," ",ce.info]})}),ce.tour&&s.jsx("div",{className:"bg-blue-100/50 rounded-lg p-3 mt-4",children:s.jsxs("p",{className:"text-sm text-blue-900",children:[s.jsx("span",{className:"font-semibold",children:"Tour:"})," ",ce.tour]})})]})})()})]})}),Ze&&s.jsxs("div",{className:"mb-6 rounded-md border p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center",children:s.jsx(Ar,{className:"w-4 h-4 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-blue-900",children:"Event Attendance"}),s.jsx("p",{className:"text-sm text-blue-700",children:ae?"Loading...":le===null?"Loading attendance...":le===0?"No one has marked attendance yet":`${le} person${le===1?"":"s"} attended this event`})]})]}),s.jsx(oe,{size:"sm",variant:ee?"default":"outline",onClick:yt,disabled:ae,className:ee?"bg-blue-600 hover:bg-blue-700 text-white":"border-blue-300 text-blue-700 hover:bg-blue-100",children:ae?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):ee?s.jsxs(s.Fragment,{children:[s.jsx(Ar,{className:"w-4 h-4 mr-2"}),"I was there"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ar,{className:"w-4 h-4 mr-2"}),"I was there"]})})]}),ee&&s.jsx("div",{className:"text-sm text-blue-700 bg-blue-100/50 rounded-lg p-2",children:" You've marked that you attended this event"})]}),qt&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Location"}),f.latitude!=null&&f.longitude!=null&&!Number.isNaN(Number(f.latitude))&&!Number.isNaN(Number(f.longitude))?s.jsx("div",{className:"rounded-lg overflow-hidden border h-[400px]",children:s.jsx(XE,{center:[Number(f.latitude),Number(f.longitude)],zoom:13,events:[e],onEventClick:()=>{}})}):s.jsx("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center h-[400px]",children:s.jsxs("div",{className:"text-center text-gray-500",children:[s.jsx(Xt,{className:"w-8 h-8 mx-auto mb-2"}),s.jsx("p",{children:"Location not available"})]})})]}),s.jsx("div",{className:`pt-3 border-t ${N?"mt-2":"mt-4"} w-full max-w-full overflow-x-hidden`,children:Ze?s.jsx("div",{className:"flex flex-wrap items-center gap-2 w-full",children:a&&s.jsxs(oe,{variant:c?"default":"outline",size:"sm",onClick:()=>a(f.id),className:`text-xs px-3 py-1 h-7 ${c?"bg-yellow-500 hover:bg-yellow-600 text-white":"hover:bg-yellow-50 hover:text-yellow-600 hover:border-yellow-300"}`,children:[c?s.jsx(Jt,{className:"w-3 h-3 mr-1 fill-current"}):s.jsx(Jt,{className:"w-3 h-3 mr-1"}),s.jsx("span",{className:"text-xs",children:c?"Reviewed":"I Was There!"})]})}):s.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full",children:[s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>T(!0),className:"text-xs px-3 py-1 h-7",children:[s.jsx(g0,{className:"w-3 h-3 mr-1 flex-shrink-0"}),s.jsx("span",{className:"text-xs",children:"Comments"})]}),(()=>{var wt,Ht;const ce=f,Ee=ce==null?void 0:ce.price_range,Qe=(wt=ce==null?void 0:ce.ticket_price_min)!=null?wt:ce==null?void 0:ce.price_min,vt=(Ht=ce==null?void 0:ce.ticket_price_max)!=null?Ht:ce==null?void 0:ce.price_max;if(Ee||Qe||vt){let Rt="";return Ee?Rt=bg(Ee):Qe&&vt?Rt=`$${Qe}-$${vt}`:Qe?Rt=`$${Qe}+`:vt&&(Rt=`$${vt}`),s.jsxs("div",{className:"text-xs flex items-center",children:[s.jsx("span",{className:"text-muted-foreground",children:"Price: "}),s.jsx("span",{className:"font-medium",children:Rt})]})}return null})(),t&&(f==null?void 0:f.id)&&s.jsx("div",{className:"flex items-center flex-shrink-0",children:s.jsx(o1,{entityType:"event",entityId:f.id,entityName:f.title||"Event",currentUserId:t,onChatOpen:ce=>{console.log(" EventDetailsModal: Chat opened, navigating to chat:",ce),u?u(ce):window.location.href=`/chats?chatId=${ce}`}})})]}),s.jsx("div",{className:"flex flex-wrap items-center gap-2 w-full",children:(f.ticket_urls&&f.ticket_urls.length>0||f.ticket_url)&&s.jsxs(oe,{variant:"default",size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-xs px-3 py-1 h-7",onClick:()=>{var wt;const ce=((wt=f.ticket_urls)==null?void 0:wt[0])||f.ticket_url,Ee=iue(ce),Qe=f.event_date?Gp(f.event_date):void 0;wn.click("ticket_link",f.id,{ticket_url:ce,ticket_provider:Ee,price_range:f.price_range,event_date:f.event_date,artist_name:f.artist_name,venue_name:f.venue_name,days_until_event:Qe,source:"event_modal",user_interested:v}),dl.trackPromotionInteraction(f.id,t||"","click",{source:"event_modal_ticket_click",ticket_url:ce,ticket_provider:Ee}),ve.current=!0;const vt=sue(ce,{eventId:f.id,userId:t,source:"event_modal"});window.open(vt,"_blank","noopener,noreferrer")},children:[s.jsx(xc,{className:"w-3 h-3 mr-1 flex-shrink-0"}),s.jsx("span",{className:"text-xs",children:"Get Tickets"}),s.jsx(aa,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})})]})}),s.jsx("div",{className:`${N?"h-20":"h-2"}`})]}),N&&k&&s.jsx(Mde,{friend:k,isOpen:N,onClose:()=>S(!1),onStartChat:ce=>{if(u)u(ce),n();else{const Ee=new CustomEvent("start-chat",{detail:{friendUserId:ce,eventId:f.id}});window.dispatchEvent(Ee)}S(!1)},onNavigateToProfile:ce=>{d&&(d(ce),n())},onAddFriend:ce=>E(this,null,function*(){try{const{error:Ee}=yield P.rpc("create_friend_request",{receiver_user_id:ce});if(Ee)throw Ee;console.log(" Friend request sent successfully")}catch(Ee){console.error(" Failed to send friend request:",Ee)}})}),s.jsx(rU,{eventId:f.id,isOpen:A,onClose:()=>T(!1),currentUserId:t}),(f==null?void 0:f.id)&&s.jsx(Jw,{open:$,onClose:()=>{console.log("Closing report modal"),R(!1)},contentType:"event",contentId:f.id,contentTitle:f.title||"Event",onReportSubmitted:()=>{console.log("Report submitted, closing modal"),R(!1),he({title:"Report Submitted",description:"Thank you for helping keep our community safe"})}}),s.jsx(Rde,{open:X,onClose:()=>te(!1),event:{id:f.id,title:f.title,artist_name:f.artist_name,event_date:f.event_date},onGroupCreated:ce=>{te(!1),he({title:"Group Created! ",description:"Your event group is ready"})}})]}):null}function aue({reviewId:e,isOpen:t,onClose:r,currentUserId:n,onCommentAdded:i,onCommentsLoaded:a}){const[o,l]=y.useState([]),[c,d]=y.useState(!1),[u,h]=y.useState(!1),[f,p]=y.useState(""),[x,g]=y.useState(null);y.useEffect(()=>{t&&e&&v()},[t,e]);const v=()=>E(this,null,function*(){if(e)try{d(!0),g(null);const b=yield fs.getReviewComments(e);l(b),a&&a(b.length)}catch(b){console.error("Failed to load review comments",b),g("Failed to load comments")}finally{d(!1)}}),_=()=>E(this,null,function*(){if(!(!n||!e||!f.trim()||u))try{h(!0),g(null);const b=yield fs.addComment(n,e,f.trim()),N=W(M({},b),{user:{id:n,name:"You",avatar_url:void 0}});l(S=>[...S,N]),p(""),i&&i()}catch(b){console.error("Failed to add comment",b),g("Failed to add comment")}finally{h(!1)}}),w=b=>{b.key==="Enter"&&(b.ctrlKey||b.metaKey)&&(b.preventDefault(),_())};return s.jsx(tn,{open:t,onOpenChange:r,children:s.jsxs(Xr,{className:"max-w-2xl w-[95vw] h-[85dvh] max-h-[85dvh] md:max-h-[80vh] p-0 overflow-hidden flex flex-col",children:[s.jsxs(Mn,{className:"px-4 py-3 border-b border-gray-200 bg-white sticky top-0 z-10",children:[s.jsx(an,{children:"Review Comments"}),s.jsx(Kn,{children:"Share your thoughts about this review"})]}),s.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto px-4 py-4 space-y-4",children:c?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(er,{className:"h-6 w-6 animate-spin mr-2"}),s.jsx("span",{children:"Loading comments..."})]}):x?s.jsxs("div",{className:"text-center py-8 text-red-600",children:[s.jsx("p",{children:x}),s.jsx(oe,{variant:"outline",onClick:v,className:"mt-2",children:"Try Again"})]}):o.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx("p",{children:"No comments yet."}),s.jsx("p",{className:"text-sm",children:"Be the first to share your thoughts!"})]}):s.jsx("div",{className:"space-y-4",children:o.map(b=>s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsxs(Vr,{className:"w-8 h-8",children:[s.jsx(Qr,{src:b.user.avatar_url}),s.jsx(qr,{className:"text-xs",children:(b.user.name||"U").slice(0,2).toUpperCase()})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"font-medium text-sm",children:b.user.name||"User"}),s.jsx("span",{className:"text-xs text-gray-500",children:new Date(b.created_at).toLocaleString()})]}),s.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap break-words",children:b.comment_text})]})]},b.id))})}),s.jsxs("div",{className:"border-t border-gray-200 p-4 bg-white",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(as,{value:f,onChange:b=>p(b.target.value),onKeyDown:w,placeholder:n?"Write a comment...":"Sign in to comment",disabled:!n||u,className:"min-h-[60px] resize-none"}),s.jsx(oe,{onClick:_,disabled:!n||u||!f.trim(),className:"px-3",children:u?s.jsx(er,{className:"h-4 w-4 animate-spin"}):s.jsx(cf,{className:"h-4 w-4"})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Press Ctrl+Enter to submit"})]})]})})}class oue{static resolveInternalEventId(t){return E(this,null,function*(){if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t))return t;const{data:n}=yield P.from("events").select("id").eq("jambase_event_id",t).limit(1).single();return(n==null?void 0:n.id)||t})}static likeEvent(t,r){return E(this,null,function*(){const n=yield this.resolveInternalEventId(r);if(yield this.isLikedByUser(t,r)){const{data:l}=yield P.from("engagements").select("*").eq("user_id",t).eq("entity_type","event").eq("entity_id",n).eq("engagement_type","like").single();return l}const{data:a,error:o}=yield P.from("engagements").insert({user_id:t,entity_type:"event",entity_id:n,engagement_type:"like"}).select("*").single();if(o){if(o.code==="PGRST205")return console.warn("event_likes table not found. Add migration to enable event likes."),null;if(o.code==="23505"||o.status===409){const{data:l}=yield P.from("event_likes").select("*").eq("user_id",t).eq("event_id",n).single();return l}throw o}return a})}static unlikeEvent(t,r){return E(this,null,function*(){const n=yield this.resolveInternalEventId(r),{error:i}=yield P.from("engagements").delete().eq("user_id",t).eq("entity_type","event").eq("entity_id",n).eq("engagement_type","like");if(i){if(i.code==="PGRST205")return;throw i}})}static getEventLikers(t){return E(this,null,function*(){const r=yield this.resolveInternalEventId(t),{data:n,error:i}=yield P.from("engagements").select("user_id").eq("entity_type","event").eq("entity_id",r).eq("engagement_type","like");if(i){if(i.code==="PGRST205")return[];throw i}const a=(n||[]).map(c=>c.user_id);if(a.length===0)return[];const{data:o,error:l}=yield P.from("users").select("id, user_id, name, avatar_url").in("user_id",a);if(l)throw l;return o||[]})}static isLikedByUser(t,r){return E(this,null,function*(){try{const n=yield this.resolveInternalEventId(r),{data:i,error:a}=yield P.from("engagements").select("id").eq("user_id",t).eq("entity_type","event").eq("entity_id",n).eq("engagement_type","like").limit(1).maybeSingle();if(a){if(a.code==="PGRST205")return!1;throw a}return!!i}catch(n){return console.error("Error checking if event is liked by user:",n),!1}})}}function lue({eventId:e,isOpen:t,onClose:r}){const[n,i]=y.useState([]),[a,o]=y.useState(!1);return y.useEffect(()=>{!t||!e||E(this,null,function*(){o(!0);try{const l=yield oue.getEventLikers(e);i(l)}finally{o(!1)}})},[t,e]),s.jsx(tn,{open:t,onOpenChange:l=>!l&&r(),children:s.jsxs(Xr,{className:"sm:max-w-md",children:[s.jsxs(Mn,{children:[s.jsx(an,{children:"Likes"}),s.jsx(Kn,{children:"People who liked this event"})]}),s.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-1",children:a?s.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading"}):n.length===0?s.jsx("div",{className:"text-sm text-muted-foreground",children:"No likes yet."}):n.map(l=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Vr,{className:"h-8 w-8",children:[s.jsx(Qr,{src:l.avatar_url||void 0}),s.jsx(qr,{children:(l.name||"U").slice(0,2).toUpperCase()})]}),s.jsx("div",{className:"text-sm",children:l.name||"User"})]},l.user_id))})]})})}function JE({event:e,currentUserId:t,isOpen:r,onClose:n}){y.useState("all");const[i,a]=y.useState([]),[o,l]=y.useState([]),[c,d]=y.useState(new Set);y.useState(new Set);const[u,h]=y.useState(""),[f,p]=y.useState(""),[x,g]=y.useState(!1),[v,_]=y.useState(!1),[w,b]=y.useState(!1),{toast:N}=jr(),S=()=>E(this,null,function*(){try{const D=yield I0.shareEvent(e.id,e.title,e.description||void 0);navigator.share?(yield navigator.share({title:e.title,text:e.description||"Check out this concert!",url:D}),N({title:"Shared!",description:"Event shared successfully"})):(yield navigator.clipboard.writeText(D),N({title:"Link Copied!",description:"Event link copied to clipboard"}))}catch(D){D.name!=="AbortError"&&(console.error("Error sharing externally:",D),N({title:"Error",description:"Failed to share event",variant:"destructive"}))}});y.useEffect(()=>{r&&(k(),O(),b(!1))},[r,t]);const k=()=>E(this,null,function*(){try{g(!0);const D=yield ld.getShareTargets(t);a(D)}catch(D){console.error("Error loading share targets:",D),N({title:"Error",description:"Failed to load chats",variant:"destructive"})}finally{g(!1)}}),O=()=>E(this,null,function*(){try{const D=yield ld.getFriends(t);l(D)}catch(D){console.error("Error loading friends:",D)}}),A=D=>{d(B=>{const U=new Set(B);return U.has(D)?U.delete(D):U.add(D),U})},T=()=>E(this,null,function*(){if(c.size===0){N({title:"No chats selected",description:"Please select at least one chat to share with",variant:"destructive"});return}try{_(!0);const D=Array.from(c),B=D.filter(Y=>!Y.startsWith("friend-")),U=D.filter(Y=>Y.startsWith("friend-")).map(Y=>Y.replace("friend-",""));let V={successCount:0,errors:[]};if(B.length>0){const Y=yield ld.shareEventToMultipleChats(e.id,B,t,u||void 0);V.successCount+=Y.successCount,V.errors.push(...Y.results.filter(z=>!z.success).map(z=>z.error||"Unknown error"))}for(const Y of U)try{const z=yield ld.shareEventToNewChat(e.id,Y,t,u||void 0);z.success?V.successCount+=1:V.errors.push(z.error||"Failed to share with friend")}catch(z){V.errors.push(`Failed to share with friend: ${z}`)}V.successCount>0&&(N({title:"Event Shared! ",description:`Successfully shared to ${V.successCount} chat${V.successCount>1?"s":""}`}),d(new Set),h(""),n()),V.errors.length>0&&N({title:"Partial Success",description:`${V.errors.length} share${V.errors.length>1?"s":""} failed`,variant:"destructive"})}catch(D){console.error("Error sharing event:",D),N({title:"Error",description:"Failed to share event",variant:"destructive"})}finally{_(!1)}}),$=i.filter(D=>D.name.toLowerCase().includes(f.toLowerCase())&&!D.name.toLowerCase().includes("direct chat")&&!D.name.toLowerCase().includes("dc direct")),R=o.filter(D=>D.name.toLowerCase().includes(f.toLowerCase())),F=[...$.map(D=>W(M({},D),{type:"group",isGroup:!0})),...R.map(D=>({id:`friend-${D.user_id}`,name:D.name,avatar_url:D.avatar_url,type:"friend",isGroup:!1,user_id:D.user_id}))];return s.jsx(tn,{open:r,onOpenChange:n,children:s.jsxs(Xr,{className:"max-w-lg max-h-[85vh] overflow-hidden flex flex-col",children:[s.jsxs(Mn,{children:[s.jsx(an,{className:"text-xl font-bold",children:"Share Event"}),s.jsxs(Kn,{children:['Share "',e.title,'" with your friends']})]}),s.jsxs("div",{className:"bg-gradient-to-r from-pink-50 to-purple-50 rounded-lg p-3 border border-pink-200",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:e.title}),s.jsxs("p",{className:"text-xs text-gray-600",children:[e.venue_name,"  ",new Date(e.event_date).toLocaleDateString()]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(oe,{onClick:S,variant:"outline",className:"h-auto py-4 border-pink-200 hover:bg-pink-50 flex flex-col items-center gap-2",children:[s.jsx(Vu,{className:"w-6 h-6 text-pink-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Share Externally"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Phone, Apps, etc."})]}),s.jsxs(oe,{onClick:()=>{b(!w),!w&&i.length===0&&o.length===0&&!x&&(k(),O())},variant:w?"default":"outline",className:`h-auto py-4 border-pink-200 flex flex-col items-center gap-2 ${w?"bg-pink-500 hover:bg-pink-600 text-white border-pink-500":"hover:bg-pink-50"}`,children:[s.jsx(Wn,{className:`w-6 h-6 ${w?"text-white":"text-pink-500"}`}),s.jsx("span",{className:"text-sm font-medium",children:"Share in Chat"}),s.jsx("span",{className:`text-xs ${w?"text-pink-100":"text-gray-500"}`,children:"Within Synth"})]})]}),w&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-1 mt-4 border-t pt-4",children:[s.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Add a message (optional)"}),s.jsx(as,{placeholder:"Let's go to this show together! ",value:u,onChange:D=>h(D.target.value),rows:1,className:"resize-none text-sm"})]}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden mt-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Wn,{className:"w-5 h-5 text-pink-500"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Choose Chats"})]}),s.jsxs("div",{className:"relative mb-3",children:[s.jsx(Mi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx(or,{placeholder:"Search chats...",value:f,onChange:D=>p(D.target.value),className:"pl-10"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2",children:x?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(er,{className:"w-6 h-6 animate-spin text-pink-500"})}):F.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Wn,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),s.jsx("p",{children:"No chats found"}),s.jsx("p",{className:"text-sm",children:"Start a conversation to share events"})]}):F.map(D=>{var B;return s.jsxs("div",{onClick:()=>A(D.id),className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all ${c.has(D.id)?"bg-pink-50 border-2 border-pink-300":"bg-white border border-gray-200 hover:border-pink-200"}`,children:[s.jsxs(Vr,{className:"w-10 h-10",children:[s.jsx(Qr,{src:D.avatar_url||void 0}),s.jsx(qr,{children:D.isGroup?s.jsx(Ar,{className:"w-5 h-5"}):D.name.split(" ").map(U=>U[0]).join("")})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:D.name}),s.jsx("p",{className:"text-xs text-gray-500",children:D.isGroup?`${((B=D.users)==null?void 0:B.length)||D.member_count||0} members`:"Direct message"})]}),c.has(D.id)&&s.jsx("div",{className:"w-6 h-6 rounded-full bg-pink-500 flex items-center justify-center",children:s.jsx(Gs,{className:"w-4 h-4 text-white"})})]},D.id)})}),s.jsxs("div",{className:"mt-4 pt-4 border-t flex gap-2",children:[s.jsx(oe,{onClick:n,variant:"outline",className:"flex-1",children:"Cancel"}),s.jsx(oe,{onClick:T,disabled:c.size===0||v,className:"flex-1 bg-pink-500 hover:bg-pink-600 text-white",children:v?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-4 h-4 mr-2 animate-spin"}),"Sharing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(cf,{className:"w-4 h-4 mr-2"}),"Share (",c.size,")"]})})]})]})]})]})})}function l1(e){const t=y.useRef({value:e,previous:e});return y.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var cue=[" ","Enter","ArrowUp","ArrowDown"],due=[" ","Enter"],Ku="Select",[c1,d1,uue]=zm(Ku),[rp,kFe]=js(Ku,[uue,Rd]),u1=Rd(),[fue,Id]=rp(Ku),[hue,mue]=rp(Ku),pU=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:i,onOpenChange:a,value:o,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:h,disabled:f,required:p,form:x}=e,g=u1(t),[v,_]=y.useState(null),[w,b]=y.useState(null),[N,S]=y.useState(!1),k=hf(d),[O,A]=Di({prop:n,defaultProp:i!=null?i:!1,onChange:a,caller:Ku}),[T,$]=Di({prop:o,defaultProp:l,onChange:c,caller:Ku}),R=y.useRef(null),F=v?x||!!v.closest("form"):!0,[D,B]=y.useState(new Set),U=Array.from(D).map(V=>V.props.value).join(";");return s.jsx(jw,W(M({},g),{children:s.jsxs(fue,{required:p,scope:t,trigger:v,onTriggerChange:_,valueNode:w,onValueNodeChange:b,valueNodeHasChildren:N,onValueNodeHasChildrenChange:S,contentId:_s(),value:T,onValueChange:$,open:O,onOpenChange:A,dir:k,triggerPointerDownPosRef:R,disabled:f,children:[s.jsx(c1.Provider,{scope:t,children:s.jsx(hue,{scope:e.__scopeSelect,onNativeOptionAdd:y.useCallback(V=>{B(Y=>new Set(Y).add(V))},[]),onNativeOptionRemove:y.useCallback(V=>{B(Y=>{const z=new Set(Y);return z.delete(V),z})},[]),children:r})}),F?s.jsxs(FU,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:h,value:T,onChange:V=>$(V.target.value),disabled:f,form:x,children:[T===void 0?s.jsx("option",{value:""}):null,Array.from(D)]},U):null]})}))};pU.displayName=Ku;var gU="SelectTrigger",vU=y.forwardRef((e,t)=>{const g=e,{__scopeSelect:r,disabled:n=!1}=g,i=me(g,["__scopeSelect","disabled"]),a=u1(r),o=Id(gU,r),l=o.disabled||n,c=sr(t,o.onTriggerChange),d=d1(r),u=y.useRef("touch"),[h,f,p]=BU(v=>{const _=d().filter(N=>!N.disabled),w=_.find(N=>N.value===o.value),b=zU(_,v,w);b!==void 0&&o.onValueChange(b.value)}),x=v=>{l||(o.onOpenChange(!0),p()),v&&(o.triggerPointerDownPosRef.current={x:Math.round(v.pageX),y:Math.round(v.pageY)})};return s.jsx(wv,W(M({asChild:!0},a),{children:s.jsx(Nt.button,W(M({type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":UU(o.value)?"":void 0},i),{ref:c,onClick:mt(i.onClick,v=>{v.currentTarget.focus(),u.current!=="mouse"&&x(v)}),onPointerDown:mt(i.onPointerDown,v=>{u.current=v.pointerType;const _=v.target;_.hasPointerCapture(v.pointerId)&&_.releasePointerCapture(v.pointerId),v.button===0&&v.ctrlKey===!1&&v.pointerType==="mouse"&&(x(v),v.preventDefault())}),onKeyDown:mt(i.onKeyDown,v=>{const _=h.current!=="";!(v.ctrlKey||v.altKey||v.metaKey)&&v.key.length===1&&f(v.key),!(_&&v.key===" ")&&cue.includes(v.key)&&(x(),v.preventDefault())})}))}))});vU.displayName=gU;var xU="SelectValue",yU=y.forwardRef((e,t)=>{const f=e,{__scopeSelect:r,className:n,style:i,children:a,placeholder:o=""}=f,l=me(f,["__scopeSelect","className","style","children","placeholder"]),c=Id(xU,r),{onValueNodeHasChildrenChange:d}=c,u=a!==void 0,h=sr(t,c.onValueNodeChange);return is(()=>{d(u)},[d,u]),s.jsx(Nt.span,W(M({},l),{ref:h,style:{pointerEvents:"none"},children:UU(c.value)?s.jsx(s.Fragment,{children:o}):a}))});yU.displayName=xU;var pue="SelectIcon",_U=y.forwardRef((e,t)=>{const a=e,{__scopeSelect:r,children:n}=a,i=me(a,["__scopeSelect","children"]);return s.jsx(Nt.span,W(M({"aria-hidden":!0},i),{ref:t,children:n||""}))});_U.displayName=pue;var gue="SelectPortal",wU=e=>s.jsx(Vm,M({asChild:!0},e));wU.displayName=gue;var Zu="SelectContent",bU=y.forwardRef((e,t)=>{const r=Id(Zu,e.__scopeSelect),[n,i]=y.useState();if(is(()=>{i(new DocumentFragment)},[]),!r.open){const a=n;return a?Ya.createPortal(s.jsx(jU,{scope:e.__scopeSelect,children:s.jsx(c1.Slot,{scope:e.__scopeSelect,children:s.jsx("div",{children:e.children})})}),a):null}return s.jsx(NU,W(M({},e),{ref:t}))});bU.displayName=Zu;var fo=10,[jU,$d]=rp(Zu),vue="SelectContentImpl",xue=Nd("SelectContent.RemoveScroll"),NU=y.forwardRef((e,t)=>{const ne=e,{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:a,onPointerDownOutside:o,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:h,collisionBoundary:f,collisionPadding:p,sticky:x,hideWhenDetached:g,avoidCollisions:v}=ne,_=me(ne,["__scopeSelect","position","onCloseAutoFocus","onEscapeKeyDown","onPointerDownOutside","side","sideOffset","align","alignOffset","arrowPadding","collisionBoundary","collisionPadding","sticky","hideWhenDetached","avoidCollisions"]),w=Id(Zu,r),[b,N]=y.useState(null),[S,k]=y.useState(null),O=sr(t,xe=>N(xe)),[A,T]=y.useState(null),[$,R]=y.useState(null),F=d1(r),[D,B]=y.useState(!1),U=y.useRef(!1);y.useEffect(()=>{if(b)return Uw(b)},[b]),Lw();const V=y.useCallback(xe=>{const[ge,...ie]=F().map(le=>le.ref.current),[ee]=ie.slice(-1),H=document.activeElement;for(const le of xe)if(le===H||(le==null||le.scrollIntoView({block:"nearest"}),le===ge&&S&&(S.scrollTop=0),le===ee&&S&&(S.scrollTop=S.scrollHeight),le==null||le.focus(),document.activeElement!==H))return},[F,S]),Y=y.useCallback(()=>V([A,b]),[V,A,b]);y.useEffect(()=>{D&&Y()},[D,Y]);const{onOpenChange:z,triggerPointerDownPosRef:K}=w;y.useEffect(()=>{if(b){let xe={x:0,y:0};const ge=ee=>{var H,le,Se,ae;xe={x:Math.abs(Math.round(ee.pageX)-((le=(H=K.current)==null?void 0:H.x)!=null?le:0)),y:Math.abs(Math.round(ee.pageY)-((ae=(Se=K.current)==null?void 0:Se.y)!=null?ae:0))}},ie=ee=>{xe.x<=10&&xe.y<=10?ee.preventDefault():b.contains(ee.target)||z(!1),document.removeEventListener("pointermove",ge),K.current=null};return K.current!==null&&(document.addEventListener("pointermove",ge),document.addEventListener("pointerup",ie,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ge),document.removeEventListener("pointerup",ie,{capture:!0})}}},[b,z,K]),y.useEffect(()=>{const xe=()=>z(!1);return window.addEventListener("blur",xe),window.addEventListener("resize",xe),()=>{window.removeEventListener("blur",xe),window.removeEventListener("resize",xe)}},[z]);const[Z,G]=BU(xe=>{const ge=F().filter(H=>!H.disabled),ie=ge.find(H=>H.ref.current===document.activeElement),ee=zU(ge,xe,ie);ee&&setTimeout(()=>ee.ref.current.focus())}),X=y.useCallback((xe,ge,ie)=>{const ee=!U.current&&!ie;(w.value!==void 0&&w.value===ge||ee)&&(T(xe),ee&&(U.current=!0))},[w.value]),te=y.useCallback(()=>b==null?void 0:b.focus(),[b]),se=y.useCallback((xe,ge,ie)=>{const ee=!U.current&&!ie;(w.value!==void 0&&w.value===ge||ee)&&R(xe)},[w.value]),ue=n==="popper"?eS:SU,ye=ue===eS?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:h,collisionBoundary:f,collisionPadding:p,sticky:x,hideWhenDetached:g,avoidCollisions:v}:{};return s.jsx(jU,{scope:r,content:b,viewport:S,onViewportChange:k,itemRefCallback:X,selectedItem:A,onItemLeave:te,itemTextRefCallback:se,focusSelectedItem:Y,selectedItemText:$,position:n,isPositioned:D,searchRef:Z,children:s.jsx(kv,{as:xue,allowPinchZoom:!0,children:s.jsx(Sv,{asChild:!0,trapped:w.open,onMountAutoFocus:xe=>{xe.preventDefault()},onUnmountAutoFocus:mt(i,xe=>{var ge;(ge=w.trigger)==null||ge.focus({preventScroll:!0}),xe.preventDefault()}),children:s.jsx(of,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:xe=>xe.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:s.jsx(ue,W(M(M({role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:xe=>xe.preventDefault()},_),ye),{onPlaced:()=>B(!0),ref:O,style:M({display:"flex",flexDirection:"column",outline:"none"},_.style),onKeyDown:mt(_.onKeyDown,xe=>{const ge=xe.ctrlKey||xe.altKey||xe.metaKey;if(xe.key==="Tab"&&xe.preventDefault(),!ge&&xe.key.length===1&&G(xe.key),["ArrowUp","ArrowDown","Home","End"].includes(xe.key)){let ee=F().filter(H=>!H.disabled).map(H=>H.ref.current);if(["ArrowUp","End"].includes(xe.key)&&(ee=ee.slice().reverse()),["ArrowUp","ArrowDown"].includes(xe.key)){const H=xe.target,le=ee.indexOf(H);ee=ee.slice(le+1)}setTimeout(()=>V(ee)),xe.preventDefault()}})}))})})})})});NU.displayName=vue;var yue="SelectItemAlignedPosition",SU=y.forwardRef((e,t)=>{const O=e,{__scopeSelect:r,onPlaced:n}=O,i=me(O,["__scopeSelect","onPlaced"]),a=Id(Zu,r),o=$d(Zu,r),[l,c]=y.useState(null),[d,u]=y.useState(null),h=sr(t,A=>u(A)),f=d1(r),p=y.useRef(!1),x=y.useRef(!0),{viewport:g,selectedItem:v,selectedItemText:_,focusSelectedItem:w}=o,b=y.useCallback(()=>{if(a.trigger&&a.valueNode&&l&&d&&g&&v&&_){const A=a.trigger.getBoundingClientRect(),T=d.getBoundingClientRect(),$=a.valueNode.getBoundingClientRect(),R=_.getBoundingClientRect();if(a.dir!=="rtl"){const H=R.left-T.left,le=$.left-H,Se=A.left-le,ae=A.width+Se,fe=Math.max(ae,T.width),he=window.innerWidth-fo,pe=_g(le,[fo,Math.max(fo,he-fe)]);l.style.minWidth=ae+"px",l.style.left=pe+"px"}else{const H=T.right-R.right,le=window.innerWidth-$.right-H,Se=window.innerWidth-A.right-le,ae=A.width+Se,fe=Math.max(ae,T.width),he=window.innerWidth-fo,pe=_g(le,[fo,Math.max(fo,he-fe)]);l.style.minWidth=ae+"px",l.style.right=pe+"px"}const F=f(),D=window.innerHeight-fo*2,B=g.scrollHeight,U=window.getComputedStyle(d),V=parseInt(U.borderTopWidth,10),Y=parseInt(U.paddingTop,10),z=parseInt(U.borderBottomWidth,10),K=parseInt(U.paddingBottom,10),Z=V+Y+B+K+z,G=Math.min(v.offsetHeight*5,Z),X=window.getComputedStyle(g),te=parseInt(X.paddingTop,10),se=parseInt(X.paddingBottom,10),ue=A.top+A.height/2-fo,ye=D-ue,ne=v.offsetHeight/2,xe=v.offsetTop+ne,ge=V+Y+xe,ie=Z-ge;if(ge<=ue){const H=F.length>0&&v===F[F.length-1].ref.current;l.style.bottom="0px";const le=d.clientHeight-g.offsetTop-g.offsetHeight,Se=Math.max(ye,ne+(H?se:0)+le+z),ae=ge+Se;l.style.height=ae+"px"}else{const H=F.length>0&&v===F[0].ref.current;l.style.top="0px";const Se=Math.max(ue,V+g.offsetTop+(H?te:0)+ne)+ie;l.style.height=Se+"px",g.scrollTop=ge-ue+g.offsetTop}l.style.margin=`${fo}px 0`,l.style.minHeight=G+"px",l.style.maxHeight=D+"px",n==null||n(),requestAnimationFrame(()=>p.current=!0)}},[f,a.trigger,a.valueNode,l,d,g,v,_,a.dir,n]);is(()=>b(),[b]);const[N,S]=y.useState();is(()=>{d&&S(window.getComputedStyle(d).zIndex)},[d]);const k=y.useCallback(A=>{A&&x.current===!0&&(b(),w==null||w(),x.current=!1)},[b,w]);return s.jsx(wue,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:p,onScrollButtonChange:k,children:s.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:N},children:s.jsx(Nt.div,W(M({},i),{ref:h,style:M({boxSizing:"border-box",maxHeight:"100%"},i.style)}))})})});SU.displayName=yue;var _ue="SelectPopperPosition",eS=y.forwardRef((e,t)=>{const l=e,{__scopeSelect:r,align:n="start",collisionPadding:i=fo}=l,a=me(l,["__scopeSelect","align","collisionPadding"]),o=u1(r);return s.jsx(Nw,W(M(M({},o),a),{ref:t,align:n,collisionPadding:i,style:W(M({boxSizing:"border-box"},a.style),{"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"})}))});eS.displayName=_ue;var[wue,QE]=rp(Zu,{}),tS="SelectViewport",kU=y.forwardRef((e,t)=>{const d=e,{__scopeSelect:r,nonce:n}=d,i=me(d,["__scopeSelect","nonce"]),a=$d(tS,r),o=QE(tS,r),l=sr(t,a.onViewportChange),c=y.useRef(0);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),s.jsx(c1.Slot,{scope:r,children:s.jsx(Nt.div,W(M({"data-radix-select-viewport":"",role:"presentation"},i),{ref:l,style:M({position:"relative",flex:1,overflow:"hidden auto"},i.style),onScroll:mt(i.onScroll,u=>{const h=u.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:p}=o;if(p!=null&&p.current&&f){const x=Math.abs(c.current-h.scrollTop);if(x>0){const g=window.innerHeight-fo*2,v=parseFloat(f.style.minHeight),_=parseFloat(f.style.height),w=Math.max(v,_);if(w<g){const b=w+x,N=Math.min(g,b),S=b-N;f.style.height=N+"px",f.style.bottom==="0px"&&(h.scrollTop=S>0?S:0,f.style.justifyContent="flex-end")}}}c.current=h.scrollTop})}))})]})});kU.displayName=tS;var EU="SelectGroup",[bue,jue]=rp(EU),Nue=y.forwardRef((e,t)=>{const a=e,{__scopeSelect:r}=a,n=me(a,["__scopeSelect"]),i=_s();return s.jsx(bue,{scope:r,id:i,children:s.jsx(Nt.div,W(M({role:"group","aria-labelledby":i},n),{ref:t}))})});Nue.displayName=EU;var CU="SelectLabel",PU=y.forwardRef((e,t)=>{const a=e,{__scopeSelect:r}=a,n=me(a,["__scopeSelect"]),i=jue(CU,r);return s.jsx(Nt.div,W(M({id:i.id},n),{ref:t}))});PU.displayName=CU;var B2="SelectItem",[Sue,AU]=rp(B2),TU=y.forwardRef((e,t)=>{const w=e,{__scopeSelect:r,value:n,disabled:i=!1,textValue:a}=w,o=me(w,["__scopeSelect","value","disabled","textValue"]),l=Id(B2,r),c=$d(B2,r),d=l.value===n,[u,h]=y.useState(a!=null?a:""),[f,p]=y.useState(!1),x=sr(t,b=>{var N;return(N=c.itemRefCallback)==null?void 0:N.call(c,b,n,i)}),g=_s(),v=y.useRef("touch"),_=()=>{i||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return s.jsx(Sue,{scope:r,value:n,disabled:i,textId:g,isSelected:d,onItemTextChange:y.useCallback(b=>{h(N=>{var S;return N||((S=b==null?void 0:b.textContent)!=null?S:"").trim()})},[]),children:s.jsx(c1.ItemSlot,{scope:r,value:n,disabled:i,textValue:u,children:s.jsx(Nt.div,W(M({role:"option","aria-labelledby":g,"data-highlighted":f?"":void 0,"aria-selected":d&&f,"data-state":d?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1},o),{ref:x,onFocus:mt(o.onFocus,()=>p(!0)),onBlur:mt(o.onBlur,()=>p(!1)),onClick:mt(o.onClick,()=>{v.current!=="mouse"&&_()}),onPointerUp:mt(o.onPointerUp,()=>{v.current==="mouse"&&_()}),onPointerDown:mt(o.onPointerDown,b=>{v.current=b.pointerType}),onPointerMove:mt(o.onPointerMove,b=>{var N;v.current=b.pointerType,i?(N=c.onItemLeave)==null||N.call(c):v.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:mt(o.onPointerLeave,b=>{var N;b.currentTarget===document.activeElement&&((N=c.onItemLeave)==null||N.call(c))}),onKeyDown:mt(o.onKeyDown,b=>{var S;((S=c.searchRef)==null?void 0:S.current)!==""&&b.key===" "||(due.includes(b.key)&&_(),b.key===" "&&b.preventDefault())})}))})})});TU.displayName=B2;var y0="SelectItemText",OU=y.forwardRef((e,t)=>{const _=e,{__scopeSelect:r,className:n,style:i}=_,a=me(_,["__scopeSelect","className","style"]),o=Id(y0,r),l=$d(y0,r),c=AU(y0,r),d=mue(y0,r),[u,h]=y.useState(null),f=sr(t,w=>h(w),c.onItemTextChange,w=>{var b;return(b=l.itemTextRefCallback)==null?void 0:b.call(l,w,c.value,c.disabled)}),p=u==null?void 0:u.textContent,x=y.useMemo(()=>s.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:g,onNativeOptionRemove:v}=d;return is(()=>(g(x),()=>v(x)),[g,v,x]),s.jsxs(s.Fragment,{children:[s.jsx(Nt.span,W(M({id:c.textId},a),{ref:f})),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Ya.createPortal(a.children,o.valueNode):null]})});OU.displayName=y0;var RU="SelectItemIndicator",MU=y.forwardRef((e,t)=>{const a=e,{__scopeSelect:r}=a,n=me(a,["__scopeSelect"]);return AU(RU,r).isSelected?s.jsx(Nt.span,W(M({"aria-hidden":!0},n),{ref:t})):null});MU.displayName=RU;var rS="SelectScrollUpButton",DU=y.forwardRef((e,t)=>{const r=$d(rS,e.__scopeSelect),n=QE(rS,e.__scopeSelect),[i,a]=y.useState(!1),o=sr(t,n.onScrollButtonChange);return is(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollTop>0;a(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),i?s.jsx($U,W(M({},e),{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}})):null});DU.displayName=rS;var nS="SelectScrollDownButton",IU=y.forwardRef((e,t)=>{const r=$d(nS,e.__scopeSelect),n=QE(nS,e.__scopeSelect),[i,a]=y.useState(!1),o=sr(t,n.onScrollButtonChange);return is(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;a(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),i?s.jsx($U,W(M({},e),{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}})):null});IU.displayName=nS;var $U=y.forwardRef((e,t)=>{const d=e,{__scopeSelect:r,onAutoScroll:n}=d,i=me(d,["__scopeSelect","onAutoScroll"]),a=$d("SelectScrollButton",r),o=y.useRef(null),l=d1(r),c=y.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return y.useEffect(()=>()=>c(),[c]),is(()=>{var h;const u=l().find(f=>f.ref.current===document.activeElement);(h=u==null?void 0:u.ref.current)==null||h.scrollIntoView({block:"nearest"})},[l]),s.jsx(Nt.div,W(M({"aria-hidden":!0},i),{ref:t,style:M({flexShrink:0},i.style),onPointerDown:mt(i.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:mt(i.onPointerMove,()=>{var u;(u=a.onItemLeave)==null||u.call(a),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:mt(i.onPointerLeave,()=>{c()})}))}),kue="SelectSeparator",LU=y.forwardRef((e,t)=>{const i=e,{__scopeSelect:r}=i,n=me(i,["__scopeSelect"]);return s.jsx(Nt.div,W(M({"aria-hidden":!0},n),{ref:t}))});LU.displayName=kue;var sS="SelectArrow",Eue=y.forwardRef((e,t)=>{const l=e,{__scopeSelect:r}=l,n=me(l,["__scopeSelect"]),i=u1(r),a=Id(sS,r),o=$d(sS,r);return a.open&&o.position==="popper"?s.jsx(Sw,W(M(M({},i),n),{ref:t})):null});Eue.displayName=sS;var Cue="SelectBubbleInput",FU=y.forwardRef((i,n)=>{var a=i,{__scopeSelect:e,value:t}=a,r=me(a,["__scopeSelect","value"]);const o=y.useRef(null),l=sr(n,o),c=l1(t);return y.useEffect(()=>{const d=o.current;if(!d)return;const u=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(u,"value").set;if(c!==t&&f){const p=new Event("change",{bubbles:!0});f.call(d,t),d.dispatchEvent(p)}},[c,t]),s.jsx(Nt.select,W(M({},r),{style:M(M({},ED),r.style),ref:l,defaultValue:t}))});FU.displayName=Cue;function UU(e){return e===""||e===void 0}function BU(e){const t=ss(e),r=y.useRef(""),n=y.useRef(0),i=y.useCallback(o=>{const l=r.current+o;t(l),function c(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),a=y.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return y.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,i,a]}function zU(e,t,r){const i=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,a=r?e.indexOf(r):-1;let o=Pue(e,Math.max(a,0));i.length===1&&(o=o.filter(d=>d!==r));const c=o.find(d=>d.textValue.toLowerCase().startsWith(i.toLowerCase()));return c!==r?c:void 0}function Pue(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var Aue=pU,VU=vU,Tue=yU,Oue=_U,Rue=wU,qU=bU,Mue=kU,WU=PU,HU=TU,Due=OU,Iue=MU,GU=DU,YU=IU,KU=LU;const Xs=Aue,Js=Tue,Ds=y.forwardRef((i,n)=>{var a=i,{className:e,children:t}=a,r=me(a,["className","children"]);return s.jsxs(VU,W(M({ref:n,className:ke("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e)},r),{children:[t,s.jsx(Oue,{asChild:!0,children:s.jsx(Qi,{className:"h-4 w-4 opacity-50"})})]}))});Ds.displayName=VU.displayName;const ZU=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(GU,W(M({ref:r,className:ke("flex cursor-default items-center justify-center py-1",e)},t),{children:s.jsx(al,{className:"h-4 w-4"})}))});ZU.displayName=GU.displayName;const XU=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(YU,W(M({ref:r,className:ke("flex cursor-default items-center justify-center py-1",e)},t),{children:s.jsx(Qi,{className:"h-4 w-4"})}))});XU.displayName=YU.displayName;const Is=y.forwardRef((a,i)=>{var o=a,{className:e,children:t,position:r="popper"}=o,n=me(o,["className","children","position"]);return s.jsx(Rue,{children:s.jsxs(qU,W(M({ref:i,className:ke("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r},n),{children:[s.jsx(ZU,{}),s.jsx(Mue,{className:ke("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),s.jsx(XU,{})]}))})});Is.displayName=qU.displayName;const $ue=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(WU,M({ref:r,className:ke("py-1.5 pl-8 pr-2 text-sm font-semibold",e)},t))});$ue.displayName=WU.displayName;const Lt=y.forwardRef((i,n)=>{var a=i,{className:e,children:t}=a,r=me(a,["className","children"]);return s.jsxs(HU,W(M({ref:n,className:ke("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e)},r),{children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(Iue,{children:s.jsx(Gs,{className:"h-4 w-4"})})}),s.jsx(Due,{children:t})]}))});Lt.displayName=HU.displayName;const Lue=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(KU,M({ref:r,className:ke("-mx-1 my-1 h-px bg-muted",e)},t))});Lue.displayName=KU.displayName;class Fue{static flagContent(t){return E(this,null,function*(){var r;try{const{data:{user:n},error:i}=yield P.auth.getUser();if(i||!n)throw new Error("User must be authenticated to flag content");const{data:a,error:o}=yield P.from("users").select("user_id").eq("user_id",n.id).maybeSingle(),l=(a==null?void 0:a.user_id)||n.id,{data:c,error:d}=yield P.from("moderation_flags").insert({flagged_by_user_id:l,content_type:t.content_type,content_id:t.content_id,flag_reason:t.flag_reason.trim(),flag_category:t.flag_category||null,additional_details:((r=t.additional_details)==null?void 0:r.trim())||null,status:"pending"}).select().single();if(d)throw d.code==="23505"?new Error("You have already flagged this content"):(console.error("Database error flagging content:",d),d);return c}catch(n){throw console.error("Error flagging content:",n),n instanceof Error?n:new Error("Failed to flag content")}})}static hasUserFlagged(t,r,n){return E(this,null,function*(){try{const{data:i,error:a}=yield P.from("moderation_flags").select("id").eq("flagged_by_user_id",t).eq("content_type",r).eq("content_id",n).maybeSingle();if(a&&a.code!=="PGRST116")throw a;return!!i}catch(i){return console.error("Error checking if user flagged content:",i),!1}})}static getFlagsForContent(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("moderation_flags").select("*").eq("content_type",t).eq("content_id",r).order("created_at",{ascending:!1});if(i)throw i;return n||[]}catch(n){return console.error("Error getting flags for content:",n),[]}})}}const JU=({isOpen:e,onClose:t,contentType:r,contentId:n,contentTitle:i})=>{const[a,o]=y.useState(""),[l,c]=y.useState(""),[d,u]=y.useState(""),[h,f]=y.useState(!1),{toast:p}=jr(),x=[{value:"spam",label:"Spam"},{value:"harassment",label:"Harassment"},{value:"inappropriate_content",label:"Inappropriate Content"},{value:"misinformation",label:"Misinformation"},{value:"copyright_violation",label:"Copyright Violation"},{value:"fake_content",label:"Fake Content"},{value:"other",label:"Other"}],g=()=>E(void 0,null,function*(){if(!a||!l.trim()){p({title:"Missing Information",description:"Please select a category and provide a reason for flagging.",variant:"destructive"});return}f(!0);try{yield Fue.flagContent({content_type:r,content_id:n,flag_reason:l.trim(),flag_category:a,additional_details:d.trim()||void 0}),p({title:"Content Flagged",description:"Thank you for reporting this. Our team will review it shortly."}),o(""),c(""),u(""),t()}catch(_){console.error("Error flagging content:",_),p({title:"Error",description:_.message||"Failed to flag content. Please try again.",variant:"destructive"})}finally{f(!1)}}),v={event:"Event",review:"Review",artist:"Artist",venue:"Venue"};return s.jsx(tn,{open:e,onOpenChange:t,children:s.jsxs(Xr,{className:"sm:max-w-[500px]",children:[s.jsxs(Mn,{children:[s.jsxs(an,{className:"flex items-center gap-2",children:[s.jsx(Va,{className:"w-5 h-5 text-red-500"}),"Flag ",v[r]]}),s.jsxs(Kn,{children:[i&&s.jsx("span",{className:"font-semibold",children:i}),s.jsx("br",{}),"Help us keep the community safe by reporting content that violates our guidelines."]})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"flag-category",children:"Category *"}),s.jsxs(Xs,{value:a,onValueChange:o,children:[s.jsx(Ds,{id:"flag-category",children:s.jsx(Js,{placeholder:"Select a category"})}),s.jsx(Is,{children:x.map(_=>s.jsx(Lt,{value:_.value,children:_.label},_.value))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"flag-reason",children:"Reason *"}),s.jsx(as,{id:"flag-reason",placeholder:"Please describe why you're flagging this content...",value:l,onChange:_=>c(_.target.value),rows:4,className:"resize-none"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"additional-details",children:"Additional Details (Optional)"}),s.jsx(as,{id:"additional-details",placeholder:"Any additional information that might help us review this...",value:d,onChange:_=>u(_.target.value),rows:3,className:"resize-none"})]})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(oe,{variant:"outline",onClick:t,disabled:h,children:"Cancel"}),s.jsx(oe,{onClick:g,disabled:h,children:h?"Submitting...":"Submit Flag"})]})]})})},Uue={threshold:.5,rootMargin:"0px",trackOnce:!0,debounce:500};function Bue(e,t,r={}){const n=y.useRef(null),i=y.useRef(new Set),a=y.useRef(new Map),o=M(M({},Uue),r);return y.useEffect(()=>{const c=new IntersectionObserver(d=>{d.forEach(u=>{const h=u.target.getAttribute("data-track-id");if(h)if(u.isIntersecting){if(o.trackOnce&&i.current.has(h))return;const f=a.current.get(h);f&&clearTimeout(f);const p=setTimeout(()=>{const x=t.find(g=>g.id===h);x&&(wn.view(e,h,void 0,W(M({},x.metadata),{viewport_time:Date.now(),tracked_via:"intersection_observer_list"})),i.current.add(h)),a.current.delete(h)},o.debounce);a.current.set(h,p)}else{const f=a.current.get(h);f&&(clearTimeout(f),a.current.delete(h))}})},{threshold:o.threshold,rootMargin:o.rootMargin});return n.current=c,()=>{a.current.forEach(d=>clearTimeout(d)),a.current.clear(),c.disconnect()}},[e,t,o.threshold,o.rootMargin,o.debounce,o.trackOnce]),y.useCallback((c,d)=>{!c||!n.current||(c.setAttribute("data-track-id",d),n.current.observe(c))},[])}const Ys=e=>!e||typeof e!="string"?"":e.toLowerCase().trim().replace(/\bdc\b/g,"district of columbia").replace(/\bd\.c\.\b/g,"district of columbia").replace(/\bd c\b/g,"district of columbia").replace(/\bny\b/g,"new york").replace(/\bn\.y\.\b/g,"new york").replace(/\bnyc\b/g,"new york city").replace(/\bla\b/g,"los angeles").replace(/\bl\.a\.\b/g,"los angeles").replace(/\bsf\b/g,"san francisco").replace(/\bs\.f\.\b/g,"san francisco").replace(/\bchi\b/g,"chicago").replace(/\bchi\.\b/g,"chicago").replace(/\bmia\b/g,"miami").replace(/\bmia\.\b/g,"miami").replace(/\bsea\b/g,"seattle").replace(/\bsea\.\b/g,"seattle").replace(/\bphx\b/g,"phoenix").replace(/\bphx\.\b/g,"phoenix").replace(/\bden\b/g,"denver").replace(/\bden\.\b/g,"denver").replace(/\bvegas\b/g,"las vegas").replace(/\blv\b/g,"las vegas").replace(/\bl\.v\.\b/g,"las vegas").replace(/\s+/g," ").replace(/[^\w\s]/g,"").trim(),QU=e=>{const t=e.map(r=>Ys(r));if(t.some(r=>r.includes("washington")&&r.includes("district of columbia"))){const r=e.find(n=>n.toLowerCase().includes("washington")&&(n.toLowerCase().includes("dc")||n.toLowerCase().includes("d.c.")||n.toLowerCase().includes("d c")));if(r)return r}if(t.some(r=>r.includes("new york"))){const r=e.find(i=>i.toLowerCase().includes("nyc"));if(r)return r;const n=e.find(i=>i.toLowerCase().includes("new york"));if(n)return n}if(t.some(r=>r.includes("los angeles"))){const r=e.find(n=>n.toLowerCase().includes("los angeles"));if(r)return r}return e.sort((r,n)=>r.length!==n.length?r.length-n.length:r.localeCompare(n))[0]},uh=e=>{if(!e||e.length===0)return[];const t=new Map;e.forEach(i=>{if(!i||typeof i!="string")return;const a=Ys(i);a&&(t.has(a)||t.set(a,[]),t.get(a).push(i))});const r=[];return t.forEach((i,a)=>{const o=QU(i);r.push(o)}),r.some(i=>Ys(i).includes("washington")&&(i.toLowerCase().includes("dc")||i.toLowerCase().includes("d.c")))?r.filter(i=>!(Ys(i).includes("washington")&&!i.toLowerCase().includes("dc")&&!i.toLowerCase().includes("d.c"))):r},zy=e=>{if(!e||typeof e!="string")return"";const t=e.trim(),r={sea:"Seattle",den:"Denver",nyc:"New York",ny:"New York",la:"Los Angeles",sf:"San Francisco",chi:"Chicago",mia:"Miami",phx:"Phoenix",lv:"Las Vegas",vegas:"Las Vegas",dc:"Washington DC","d.c.":"Washington DC","d c":"Washington DC",washington:"Washington DC"},n=t.toLowerCase();if(r[n])return r[n];const i=t.match(/^(.+?),\s*([A-Z]{2})$/);return i?i[1].trim():t.split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()).join(" ")},aA=Object.freeze(Object.defineProperty({__proto__:null,deduplicateCities:uh,formatCityNameForDisplay:zy,getCanonicalCityName:QU,normalizeCityName:Ys},Symbol.toStringTag,{value:"Module"})),oA=50;new Date(0).toISOString();class Oh{static getPersonalizedFeedV3(t,r=50,n=0,i){return E(this,null,function*(){var c,d,u,h,f;const a=typeof performance!="undefined"?performance.now():Date.now(),o=yield this.normalizeFilters(i),l={p_user_id:t,p_limit:r,p_offset:n,p_city_lat:(d=(c=o.cityCoordinates)==null?void 0:c.lat)!=null?d:null,p_city_lng:(h=(u=o.cityCoordinates)==null?void 0:u.lng)!=null?h:null,p_radius_miles:o.radiusMiles};try{console.log(" Calling get_personalized_feed_v3 with payload:",l);const{data:p,error:x}=yield P.rpc("get_personalized_feed_v3",l);if(x)throw x.code==="42P01"||x.code==="PGRST204"||x.code==="PGRST116"||(f=x.message)!=null&&f.includes("does not exist")?(console.warn(" get_personalized_feed_v3 RPC function not found"),x):(console.error(" get_personalized_feed_v3 error:",{code:x.code,message:x.message,details:x.details,hint:x.hint,error:x}),x);const g=(p!=null?p:[]).map(w=>({id:String(w.id),type:w.type,score:Number(w.score)||0,payload:w.payload||{},context:w.context||{},created_at:w.created_at||new Date().toISOString()})),_=(typeof performance!="undefined"?performance.now():Date.now())-a;return console.log(" Unified feed v3 (RPC):",{userId:t,itemCount:g.length,types:g.reduce((w,b)=>(w[b.type]=(w[b.type]||0)+1,w),{}),loadTimeMs:Math.round(_)}),{items:g,has_more:g.length===r}}catch(p){throw console.error(" get_personalized_feed_v3 exception:",p),p}})}static getPersonalizedFeed(t,r=50,n=0,i=!1,a){return E(this,null,function*(){var h,f,p,x,g,v,_,w,b,N,S,k,O,A,T,$,R,F;const o=typeof performance!="undefined"?performance.now():Date.now(),l=yield this.normalizeFilters(a),c=n===0&&!i,d=c?`personalized_feed_${t}_${r}_${(h=l.cityCoordinates)==null?void 0:h.lat}_${(f=l.cityCoordinates)==null?void 0:f.lng}_${(p=l.genres)==null?void 0:p.join(",")}_${l.followingOnly}`:null;if(c&&d){const D=Eo.get(d);if(D)return sn.log(" Personalized feed (cached):",{count:D.length,userId:t}),D}const u={p_user_id:t,p_limit:r,p_offset:n,p_city_lat:(g=(x=l.cityCoordinates)==null?void 0:x.lat)!=null?g:null,p_city_lng:(_=(v=l.cityCoordinates)==null?void 0:v.lng)!=null?_:null,p_radius_miles:(w=l.radiusMiles)!=null?w:50};try{sn.debug(" Calling get_personalized_feed_v3 with payload:",u);const{data:D,error:B}=yield P.rpc("get_personalized_feed_v3",u);if(B)return B.code==="42P01"||B.code==="PGRST204"||B.code==="PGRST116"||(b=B.message)!=null&&b.includes("does not exist")||(N=B.message)!=null&&N.includes("Could not find the function")?(sn.warn(" get_personalized_feed_v3 RPC function not found, using fallback feed"),this.getFallbackFeed(t,r,n,i,l)):B.code==="400"||B.code==="PGRST202"?(sn.error(" get_personalized_feed_v3 parameter/signature mismatch:",{code:B.code,message:B.message,hint:B.hint,payload:u}),sn.warn(" Falling back to basic feed due to function signature mismatch"),this.getFallbackFeed(t,r,n,i,l)):(sn.error(" get_personalized_feed_v3 error:",B),this.getFallbackFeed(t,r,n,i,l));const U=(D!=null?D:[]).filter(Z=>Z.type==="event").map(Z=>{var X,te,se,ue,ye,ne,xe,ge,ie,ee,H,le,Se,ae,fe,he,pe,Ae,qe,Fe,ve,rt,Ve,lt,ut,Ze,qt,lr,Ge;const G=Z.payload||{};return{event_id:G.event_id||Z.id||"",title:(X=G.title)!=null?X:null,artist_name:(te=G.artist_name)!=null?te:null,artist_id:(se=G.artist_id)!=null?se:null,artist_uuid:(ue=G.artist_uuid)!=null?ue:null,venue_name:(ye=G.venue_name)!=null?ye:null,venue_id:(ne=G.venue_id)!=null?ne:null,venue_uuid:(xe=G.venue_uuid)!=null?xe:null,venue_city:(ge=G.venue_city)!=null?ge:null,venue_state:(ie=G.venue_state)!=null?ie:null,venue_address:(ee=G.venue_address)!=null?ee:null,venue_zip:(H=G.venue_zip)!=null?H:null,event_date:G.event_date,doors_time:(le=G.doors_time)!=null?le:null,description:(Se=G.description)!=null?Se:null,genres:Array.isArray(G.genres)?G.genres:[],latitude:(ae=G.latitude)!=null?ae:null,longitude:(fe=G.longitude)!=null?fe:null,ticket_urls:Array.isArray(G.ticket_urls)?G.ticket_urls:[],ticket_available:(he=G.ticket_available)!=null?he:null,price_range:(pe=G.price_range)!=null?pe:null,ticket_price_min:(Ae=G.ticket_price_min)!=null?Ae:null,ticket_price_max:(qe=G.ticket_price_max)!=null?qe:null,relevance_score:(Fe=Z.score)!=null?Fe:null,friend_interest_count:(ve=G.friend_interest_count)!=null?ve:null,total_interest_count:(rt=G.interested_count)!=null?rt:null,is_promoted:(Ve=G.is_promoted)!=null?Ve:null,promotion_tier:(lt=G.promotion_tier)!=null?lt:null,distance_miles:(ut=G.distance_miles)!=null?ut:null,poster_image_url:(Ze=G.poster_image_url)!=null?Ze:null,images:(qt=G.images)!=null?qt:null,created_at:(lr=Z.created_at)!=null?lr:null,updated_at:(Ge=G.updated_at)!=null?Ge:null}});sn.debug(" RPC v3 response (events only):",{rawDataCount:(S=D==null?void 0:D.length)!=null?S:0,eventCount:U.length,sampleEvent:U[0]?{title:U[0].title,venue_city:U[0].venue_city,event_date:U[0].event_date,genres:U[0].genres,event_date_parsed:U[0].event_date?new Date(U[0].event_date).toISOString():null,isPast:U[0].event_date?new Date(U[0].event_date).getTime()<Date.now():null}:null,filters:l.debugSummary,allEventTypes:(D==null?void 0:D.map(Z=>Z.type))||[],cityCoordinates:l.cityCoordinates,cleanedCities:l.cleanedCities,originalCities:l.originalCities});const V=this.applyClientSideFilters(U,l,i);sn.debug(" After client-side filtering:",{filteredCount:V.length,removedCount:U.length-V.length,sampleRemoved:U.length>V.length&&U[0]?{title:U[0].title,event_date:U[0].event_date,venue_city:U[0].venue_city,genres:U[0].genres}:null});const Y=V.map(Z=>this.mapRowToEvent(Z));if(V.length===0&&n===0){const Z=U.slice(0,3).map(G=>{const X=G.event_date?new Date(G.event_date):null,te=l.dateStart,se=l.dateEnd;let ue=null;if((te||se)&&X){const ye=X.getUTCFullYear(),ne=X.getUTCMonth(),xe=X.getUTCDate();if(te){const ge=new Date(te),ie=ge.getUTCFullYear(),ee=ge.getUTCMonth(),H=ge.getUTCDate();ue=W(M({},ue),{beforeStart:ye<ie||ye===ie&&ne<ee||ye===ie&&ne===ee&&xe<H,startDate:`${ie}-${String(ee+1).padStart(2,"0")}-${String(H).padStart(2,"0")}`})}if(se){const ge=new Date(se),ie=ge.getUTCFullYear(),ee=ge.getUTCMonth(),H=ge.getUTCDate();ue=W(M({},ue),{afterEnd:ye>ie||ye===ie&&ne>ee||ye===ie&&ne===ee&&xe>H,endDate:`${ie}-${String(ee+1).padStart(2,"0")}-${String(H).padStart(2,"0")}`,eventDate:`${ye}-${String(ne+1).padStart(2,"0")}-${String(xe).padStart(2,"0")}`})}}return{title:G.title,event_date:G.event_date,event_date_parsed:X==null?void 0:X.toISOString(),venue_city:G.venue_city,genres:G.genres,isPast:X?X.getTime()<Date.now():null,dateRangeCheck:ue}});return sn.warn(" RPC returned no events at offset 0  falling back to basic feed.",{rawDataCount:(k=D==null?void 0:D.length)!=null?k:0,mappedRowsCount:U.length,filteredCount:V.length,sampleEvents:Z,activeFilters:{includePast:i,hasCityFilter:!l.cityCoordinates&&!!((O=l.cleanedCities)!=null&&O.length||(A=l.originalCities)!=null&&A.length),hasCityCoordinates:!!l.cityCoordinates,hasGenreFilter:!!((T=l.genres)!=null&&T.length),hasDateRange:!!(l.dateStart||l.dateEnd),dateRange:l.dateStart||l.dateEnd?{start:($=l.dateStart)==null?void 0:$.toISOString(),end:(R=l.dateEnd)==null?void 0:R.toISOString()}:null,hasDaysOfWeek:!!((F=l.daysOfWeek)!=null&&F.length)}}),this.getFallbackFeed(t,r,n,i,l)}const K=(typeof performance!="undefined"?performance.now():Date.now())-o;return c&&d&&Eo.set(d,Y,vg.REVIEWS),sn.log(" Personalized feed (RPC):",{userId:t,count:Y.length,limit:r,offset:n,loadTimeMs:Math.round(K),cached:c&&!!d}),Y}catch(D){return sn.error(" get_personalized_feed_v2 exception:",D),this.getFallbackFeed(t,r,n,i,l)}})}static getFallbackFeed(t,r,n,i,a){return E(this,null,function*(){var o,l,c,d;try{let u=P.from("events").select("*").order("event_date",{ascending:!0}).range(n,n+r-1);if(i||(u=u.gte("event_date",new Date().toISOString())),(o=a.genres)!=null&&o.length&&(u=u.overlaps("genres",a.genres)),a.cleanedCities&&a.cleanedCities.length>0){const g=[];a.cleanedCities.forEach(v=>{g.push(`venue_city.ilike.%${v}%`),(v.includes("washington")||v.includes("district"))&&(g.push("venue_city.ilike.%Washington%"),g.push("venue_city.ilike.%DC%"),g.push("venue_city.ilike.%D.C%"))}),g.length>0&&(u=u.or(g.join(",")))}else if(a.originalCities&&a.originalCities.length>0){const g=[];a.originalCities.forEach(v=>{var w;const _=(w=v.split(",")[0])==null?void 0:w.trim();_&&g.push(`venue_city.ilike.%${_}%`)}),g.length>0&&(u=u.or(g.join(",")))}a.dateStartIso&&(u=u.gte("event_date",a.dateStartIso)),a.dateEndIso&&(u=u.lte("event_date",a.dateEndIso));const{data:h,error:f}=yield u;if(f)return sn.error(" Fallback feed query error:",f),[];let p=(h!=null?h:[]).map(g=>{var v,_,w,b,N,S,k;return{event_id:g.id,title:g.title,artist_name:g.artist_name,artist_id:g.artist_id,artist_uuid:(v=g.artist_uuid)!=null?v:null,venue_name:g.venue_name,venue_id:g.venue_id,venue_city:g.venue_city,venue_state:g.venue_state,venue_address:g.venue_address,venue_zip:g.venue_zip,event_date:g.event_date,doors_time:g.doors_time,description:g.description,genres:g.genres,latitude:g.latitude,longitude:g.longitude,ticket_urls:g.ticket_urls,ticket_available:g.ticket_available,price_range:g.price_range,ticket_price_min:(_=g.ticket_price_min)!=null?_:g.price_min,ticket_price_max:(w=g.ticket_price_max)!=null?w:g.price_max,relevance_score:0,friend_interest_count:0,total_interest_count:0,is_promoted:(b=g.is_promoted)!=null?b:!1,promotion_tier:(N=g.promotion_tier)!=null?N:null,distance_miles:null,poster_image_url:(S=g.poster_image_url)!=null?S:null,images:(k=g.images)!=null?k:null,created_at:g.created_at,updated_at:g.updated_at}});if(((l=a.cityCoordinates)==null?void 0:l.lat)!==void 0&&((c=a.cityCoordinates)==null?void 0:c.lng)!==void 0){const{lat:g,lng:v}=a.cityCoordinates,_=(d=a.radiusMiles)!=null?d:oA;p=p.map(w=>{var N;if(w.latitude==null||w.longitude==null)return w;const b=this.calculateDistanceMiles(typeof w.latitude=="string"?Number(w.latitude):w.latitude,typeof w.longitude=="string"?Number(w.longitude):w.longitude,g,v);return W(M({},w),{distance_miles:Number.isFinite(b)?b:(N=w.distance_miles)!=null?N:null})}).filter(w=>{if(w.distance_miles==null)return!0;const b=typeof w.distance_miles=="string"?Number(w.distance_miles):w.distance_miles;return Number.isFinite(b)?b<=_:!0})}let x=this.applyClientSideFilters(p,a,i);if(a.followingOnly){const{followedUuidSet:g,followedJambaseSet:v,followedNameSet:_}=yield this.getFollowedArtistIdentifiers(t);if(g.size===0&&v.size===0&&_.size===0)return[];x=x.filter(w=>{const b=w.artist_uuid?String(w.artist_uuid).toLowerCase():null,N=w.artist_id?String(w.artist_id).toLowerCase():null,S=w.artist_name?w.artist_name.toLowerCase().trim():null;return!!(b&&g.has(b)||N&&v.has(N)||S&&_.has(S))})}return x.map(g=>this.mapRowToEvent(g))}catch(u){return sn.error(" Fallback feed exception:",u),[]}})}static getFollowedArtistIdentifiers(t){return E(this,null,function*(){const r=new Set,n=new Set,i=new Set;try{const{data:a,error:o}=yield P.from("artist_follows").select("artist_id").eq("user_id",t);if(o)return sn.warn(" Unable to load artist_follows for fallback filter:",o),{followedUuidSet:r,followedJambaseSet:n,followedNameSet:i};const l=(a!=null?a:[]).map(c=>c.artist_id?String(c.artist_id):null).filter(c=>!!c);if(l.forEach(c=>r.add(c.toLowerCase())),l.length>0){const{data:c,error:d}=yield P.from("artists_with_external_ids").select("id, jambase_artist_id, name").in("id",l);if(d)sn.warn(" Unable to load artists for fallback filter:",d);else for(const u of c!=null?c:[])u.jambase_artist_id&&n.add(String(u.jambase_artist_id).toLowerCase()),u.name&&i.add(String(u.name).toLowerCase().trim())}}catch(a){}return{followedUuidSet:r,followedJambaseSet:n,followedNameSet:i}})}static getUserMusicProfile(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.rpc("get_user_music_profile_summary",{p_user_id:t});if(n)throw n;return!r||typeof r!="object"?null:r}catch(r){return sn.error(" Error fetching music profile:",r),null}})}static getUserTopGenres(t,r=10){return E(this,null,function*(){try{const{data:n,error:i}=yield P.rpc("get_user_top_genres",{p_user_id:t,p_limit:r});if(i)throw i;return Array.isArray(n)?n:[]}catch(n){return sn.error(" Error fetching top genres:",n),[]}})}static getUserTopArtists(t,r=20){return E(this,null,function*(){try{const{data:n,error:i}=yield P.rpc("get_user_top_artists",{p_user_id:t,p_limit:r});if(i)throw i;return Array.isArray(n)?n:[]}catch(n){return sn.error(" Error fetching top artists:",n),[]}})}static userHasMusicData(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("user_preferences").select("music_preference_signals").eq("user_id",t).maybeSingle();if(n)throw n;const i=(r==null?void 0:r.music_preference_signals)||[];return Array.isArray(i)&&i.length>0}catch(r){return sn.error(" Error checking music data:",r),!1}})}static getEventRelevanceScore(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.rpc("calculate_event_relevance_score",{p_user_id:t,p_event_id:r});if(i)throw i;return n||0}catch(n){return sn.error(" Error calculating relevance:",n),0}})}static mapRowToEvent(t){var l,c,d,u,h,f,p,x,g,v,_,w,b,N,S,k,O,A,T,$,R,F;const r=new Date().toISOString(),n=t.latitude!==null&&t.latitude!==void 0?Number(t.latitude):null,i=t.longitude!==null&&t.longitude!==void 0?Number(t.longitude):null,a=t.distance_miles!==null&&t.distance_miles!==void 0?Number(t.distance_miles):null,o=Array.isArray(t.ticket_urls)?t.ticket_urls:[];return{id:t.event_id,jambase_event_id:t.event_id,title:(l=t.title)!=null?l:"Untitled Event",artist_name:(c=t.artist_name)!=null?c:"Unknown Artist",artist_id:(d=t.artist_id)!=null?d:null,venue_name:(u=t.venue_name)!=null?u:"Unknown Venue",venue_id:(h=t.venue_id)!=null?h:null,venue_city:(f=t.venue_city)!=null?f:null,venue_state:(p=t.venue_state)!=null?p:null,venue_address:(x=t.venue_address)!=null?x:null,venue_zip:(g=t.venue_zip)!=null?g:null,event_date:t.event_date,doors_time:(v=t.doors_time)!=null?v:null,description:(_=t.description)!=null?_:null,genres:(w=t.genres)!=null?w:[],latitude:n,longitude:i,ticket_urls:o,ticket_available:(b=t.ticket_available)!=null?b:o.length>0,price_range:(N=t.price_range)!=null?N:null,ticket_price_min:t.ticket_price_min!==void 0&&t.ticket_price_min!==null?Number(t.ticket_price_min):null,ticket_price_max:t.ticket_price_max!==void 0&&t.ticket_price_max!==null?Number(t.ticket_price_max):null,ticket_url:o.length>0?o[0]:null,setlist:null,setlist_enriched:!1,setlist_song_count:null,setlist_fm_id:null,setlist_fm_url:null,setlist_source:null,setlist_last_updated:null,tour_name:null,created_at:(S=t.created_at)!=null?S:r,updated_at:(k=t.updated_at)!=null?k:r,relevance_score:(O=t.relevance_score)!=null?O:0,user_is_interested:void 0,interested_count:(A=t.total_interest_count)!=null?A:0,friends_interested_count:(T=t.friend_interest_count)!=null?T:0,artist_frequency_rank:void 0,diversity_penalty:void 0,is_promoted:($=t.is_promoted)!=null?$:!1,promotion_tier:t.promotion_tier==="basic"||t.promotion_tier==="premium"||t.promotion_tier==="featured"?t.promotion_tier:null,active_promotion_id:null,distance_miles:a,poster_image_url:(R=t.poster_image_url)!=null?R:null,images:(F=t.images)!=null?F:null}}static normalizeFilters(t){return E(this,null,function*(){var f,p,x,g,v,_,w,b,N,S,k;const r=(p=(f=t==null?void 0:t.selectedCities)==null?void 0:f.map(O=>{var A;return(A=O.split(",")[0])==null?void 0:A.trim()}).filter(Boolean).map(O=>Ys(O||"")))!=null?p:void 0,n=(g=(x=t==null?void 0:t.city)!=null?x:r==null?void 0:r[0])!=null?g:null,i=n?Ys(n):null,a=t!=null&&t.genres&&t.genres.length>0?t.genres:void 0,o=t!=null&&t.daysOfWeek&&t.daysOfWeek.length>0?t.daysOfWeek:void 0,l=(t==null?void 0:t.filterByFollowing)==="following",c=(v=t==null?void 0:t.dateRange)==null?void 0:v.from,d=(_=t==null?void 0:t.dateRange)==null?void 0:_.to,u=(w=t==null?void 0:t.radiusMiles)!=null?w:oA;let h=null;if(n)try{const{RadiusSearchService:O}=yield on(()=>E(this,null,function*(){const{RadiusSearchService:A}=yield Promise.resolve().then(()=>oS);return{RadiusSearchService:A}}),void 0,import.meta.url);h=yield O.getCityCoordinates(n),h?sn.log(` Found coordinates for "${n}":`,h):sn.warn(` No coordinates found for city: "${n}"`)}catch(O){sn.error("Error looking up city coordinates:",O)}return{genres:a,cleanedCities:r,originalCities:(b=t==null?void 0:t.selectedCities)!=null?b:[],city:i,cityCoordinates:h,radiusMiles:u,dateStartIso:c?c.toISOString():void 0,dateEndIso:d?d.toISOString():void 0,dateStart:c,dateEnd:d,daysOfWeek:o,followingOnly:l,debugSummary:{city:i,radius:u,genres:(N=a==null?void 0:a.length)!=null?N:0,citiesSelected:(S=r==null?void 0:r.length)!=null?S:0,daysOfWeek:(k=o==null?void 0:o.length)!=null?k:0,followingOnly:l}}})}static applyClientSideFilters(t,r,n){var l;let i=t;const a=t.length;if(!n&&!r.cityCoordinates&&!r.dateStart&&!r.dateEnd){const c=Date.now(),d=i.length;i=i.filter(u=>{if(!u.event_date)return!0;const h=Date.parse(u.event_date);return Number.isNaN(h)?!0:h>=c}),i.length<d&&sn.debug(` Date filter removed ${d-i.length} past events`)}if(!r.cityCoordinates){const c=r.cleanedCities&&r.cleanedCities.length>0?r.cleanedCities:r.originalCities&&r.originalCities.length>0?r.originalCities:void 0;if(c&&c.length>0){const d=f=>Ys(f||"").replace(/\s+/g," ").trim(),u=new Set(c.map(d)),h=i.length;i=i.filter(f=>{const p=f.venue_city?d(f.venue_city):"",x=u.has(p);return!x&&h>0&&sn.debug(` City filter removing event: "${f.title}" (city: "${f.venue_city}" -> normalized: "${p}", allowed: ${Array.from(u).join(", ")})`),x}),i.length<h&&sn.debug(` City filter removed ${h-i.length} events (allowed cities: ${Array.from(u).join(", ")})`)}}if(r.genres&&r.genres.length>0){const c=new Set(r.genres.map(u=>u.toLowerCase())),d=i.length;i=i.filter(u=>!u.genres||u.genres.length===0?!1:u.genres.some(h=>c.has(h.toLowerCase()))),i.length<d&&sn.debug(` Genre filter removed ${d-i.length} events`)}if((r.dateStart||r.dateEnd)&&!r.cityCoordinates){const c=i.length,d=r.dateStart?new Date(r.dateStart):null;d&&d.setUTCHours(0,0,0,0);const u=r.dateEnd?new Date(r.dateEnd):null;u&&u.setUTCHours(23,59,59,999),i=i.filter(h=>{if(!h.event_date)return!0;const f=Date.parse(h.event_date);if(Number.isNaN(f))return!0;const p=new Date(f);return!(d&&p.getTime()<d.getTime()||u&&p.getTime()>u.getTime())}),i.length<c&&sn.debug(` Date range filter removed ${c-i.length} events`)}if((l=r.daysOfWeek)!=null&&l.length){const c=new Set(r.daysOfWeek),d=i.length;i=i.filter(u=>{if(!u.event_date)return!0;const h=new Date(u.event_date);return Number.isNaN(h.getTime())?!0:c.has(h.getDay())}),i.length<d&&sn.debug(` Days of week filter removed ${d-i.length} events`)}return i.length<a&&sn.debug(` Client-side filters: ${a}  ${i.length} events (removed ${a-i.length})`),i}static calculateDistanceMiles(t,r,n,i){const o=h=>h*(Math.PI/180),l=o(n-t),c=o(i-r),d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(o(t))*Math.cos(o(n))*Math.sin(c/2)*Math.sin(c/2);return 3959*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}static mapRpcRowToFeedRow(t){var n,i,a,o,l,c,d,u,h,f,p,x,g,v,_,w,b,N,S,k,O,A,T,$,R,F,D,B,U,V,Y,z,K;const r=Array.isArray(t.ticket_urls)?t.ticket_urls:t.ticket_url?[t.ticket_url]:[];return{event_id:String((i=(n=t.event_id)!=null?n:t.id)!=null?i:""),title:(a=t.title)!=null?a:null,artist_name:(o=t.artist_name)!=null?o:null,artist_id:(l=t.artist_id)!=null?l:null,artist_uuid:(c=t.artist_uuid)!=null?c:null,venue_name:(d=t.venue_name)!=null?d:null,venue_id:(u=t.venue_id)!=null?u:null,venue_uuid:(h=t.venue_uuid)!=null?h:null,venue_city:(f=t.venue_city)!=null?f:null,venue_state:(p=t.venue_state)!=null?p:null,venue_address:(x=t.venue_address)!=null?x:null,venue_zip:(g=t.venue_zip)!=null?g:null,event_date:t.event_date,doors_time:(v=t.doors_time)!=null?v:null,description:(_=t.description)!=null?_:null,genres:Array.isArray(t.genres)?t.genres:[],latitude:(w=t.latitude)!=null?w:null,longitude:(b=t.longitude)!=null?b:null,ticket_urls:r,ticket_available:(S=t.ticket_available)!=null?S:r.length>0?!0:(N=t.ticket_available)!=null?N:null,price_range:(k=t.price_range)!=null?k:null,ticket_price_min:(O=t.ticket_price_min)!=null?O:null,ticket_price_max:(A=t.ticket_price_max)!=null?A:null,relevance_score:(T=t.relevance_score)!=null?T:null,friend_interest_count:(R=($=t.friend_interest_count)!=null?$:t.friends_interested_count)!=null?R:null,total_interest_count:(D=(F=t.total_interest_count)!=null?F:t.interested_count)!=null?D:null,is_promoted:(B=t.is_promoted)!=null?B:null,promotion_tier:(U=t.promotion_tier)!=null?U:null,distance_miles:(V=t.distance_miles)!=null?V:null,poster_image_url:(Y=t.poster_image_url)!=null?Y:null,created_at:(z=t.created_at)!=null?z:null,updated_at:(K=t.updated_at)!=null?K:null}}}class lA{static getFriendsReviews(t,r=20,n=0){return E(this,null,function*(){try{const{data:i,error:a}=yield P.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(a)throw a;if(!i||i.length===0)return[];const o=i.map(d=>d.user_id===t?d.related_user_id:d.user_id),{data:l,error:c}=yield P.from("reviews").select(`
          *,
          user:users!reviews_user_id_fkey (
            name,
            avatar_url,
            verified,
            account_type
          ),
          events (
            id,
            title,
            venue_name,
            event_date,
            artist_name,
            artist_id
          )
        `).in("user_id",o).eq("is_public",!0).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).range(n,n+r-1);if(c)throw c;return(l||[]).map(d=>{var h,f,p;const u=d.events;return{id:`friends-review-${d.id}`,type:"review",review_id:d.id,title:`${((h=d.user)==null?void 0:h.name)||"Friend"}'s Review`,content:d.review_text||"",author:{id:d.user_id,name:((f=d.user)==null?void 0:f.name)||"Anonymous",avatar_url:(p=d.user)==null?void 0:p.avatar_url},created_at:d.created_at,updated_at:d.updated_at,rating:d.rating,is_public:!0,photos:d.photos||void 0,setlist:d.setlist||void 0,likes_count:d.likes_count||0,comments_count:d.comments_count||0,shares_count:d.shares_count||0,artist_performance_rating:d.artist_performance_rating,production_rating:d.production_rating,venue_rating:d.venue_rating,location_rating:d.location_rating,value_rating:d.value_rating,artist_performance_feedback:d.artist_performance_feedback,production_feedback:d.production_feedback,venue_feedback:d.venue_feedback,location_feedback:d.location_feedback,value_feedback:d.value_feedback,event_info:{event_name:(u==null?void 0:u.title)||"Concert Review",venue_name:(u==null?void 0:u.venue_name)||"Unknown Venue",event_date:(u==null?void 0:u.event_date)||d.created_at,artist_name:u==null?void 0:u.artist_name,artist_id:u==null?void 0:u.artist_id},relevance_score:this.calculateFriendReviewRelevance(d,1)}})}catch(i){return console.error("Error fetching friends reviews:",i),[]}})}static getFriendsPlusOneReviews(t,r=20,n=0){return E(this,null,function*(){try{const{data:i,error:a}=yield P.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(a)throw a;if(!i||i.length===0)return[];const o=i.map(p=>p.user_id===t?p.related_user_id:p.user_id),{data:l,error:c}=yield P.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").in("user_id",o);if(c)throw c;const d=(l||[]).map(p=>p.user_id===t?p.related_user_id:p.user_id).filter(p=>!o.includes(p)&&p!==t),u=[...o,...d];if(u.length===0)return[];const{data:h,error:f}=yield P.from("reviews").select(`
          *,
          user:users!reviews_user_id_fkey (
            name,
            avatar_url,
            verified,
            account_type
          ),
          events (
            id,
            title,
            venue_name,
            event_date,
            artist_name,
            artist_id
          )
        `).in("user_id",u).eq("is_public",!0).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).range(n,n+r-1);if(f)throw f;return(h||[]).map(p=>{var _,w,b;const g=o.includes(p.user_id)?1:2,v=p.events;return{id:`friends-plus-one-review-${p.id}`,type:"review",review_id:p.id,title:`${((_=p.user)==null?void 0:_.name)||"Friend"}'s Review`,content:p.review_text||"",author:{id:p.user_id,name:((w=p.profiles)==null?void 0:w.name)||"Anonymous",avatar_url:(b=p.profiles)==null?void 0:b.avatar_url},created_at:p.created_at,updated_at:p.updated_at,rating:p.rating,is_public:!0,photos:p.photos||void 0,setlist:p.setlist||void 0,likes_count:p.likes_count||0,comments_count:p.comments_count||0,shares_count:p.shares_count||0,event_info:{event_name:(v==null?void 0:v.title)||"Concert Review",venue_name:(v==null?void 0:v.venue_name)||"Unknown Venue",event_date:(v==null?void 0:v.event_date)||p.created_at,artist_name:v==null?void 0:v.artist_name,artist_id:v==null?void 0:v.artist_id},relevance_score:this.calculateFriendReviewRelevance(p,g)}})}catch(i){return console.error("Error fetching friends plus one reviews:",i),[]}})}static getFriendActivity(t,r=10){return E(this,null,function*(){try{const n=yield this.getFriendsReviews(t,Math.floor(r*.7),0),{data:i,error:a}=yield P.from("notifications").select("id, type, title, message, data, created_at").eq("user_id",t).in("type",["friend_accepted"]).order("created_at",{ascending:!1}).limit(5);if(a)return console.error("Error fetching friend notifications:",a),n.slice(0,r);const o=[...n];return i&&i.length>0&&i.forEach(l=>{o.push({id:`friend-activity-${l.id}`,type:"friend_activity",title:l.title,content:l.message,author:{id:"system",name:"Synth",avatar_url:void 0},created_at:l.created_at,relevance_score:.8})}),o.slice(0,r)}catch(n){return console.error("Error fetching friend activity:",n),[]}})}static calculateFriendReviewRelevance(t,r){let n=.5;r===1?n+=.4:r===2&&(n+=.2);const i=Math.floor((Date.now()-new Date(t.created_at).getTime())/(1e3*60*60*24));return i<=7?n+=.2:i<=30&&(n+=.1),t.review_text&&t.review_text.length>50&&(n+=.1),t.photos&&t.photos.length>0&&(n+=.1),t.rating>=4&&(n+=.1),Math.min(n,1)}static getFriendCount(t){return E(this,null,function*(){try{const{count:r,error:n}=yield P.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(n)throw n;return r||0}catch(r){return console.error("Error getting friend count:",r),0}})}static areFriends(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("user_relationships").select("id").eq("relationship_type","friend").eq("status","accepted").or(`and(user_id.eq.${t},related_user_id.eq.${r}),and(user_id.eq.${r},related_user_id.eq.${t})`).single();if(i&&i.code!=="PGRST116")throw i;return!!n}catch(n){return console.error("Error checking friendship:",n),!1}})}static getConnectionDegreeReviews(t,r=20,n=0){return E(this,null,function*(){try{if(n===0){const l=W3.reviews(t,r,n),c=Eo.get(l);if(c)return c}const{data:i,error:a}=yield P.rpc("get_connection_degree_reviews",{p_user_id:t,p_limit:r,p_offset:n});if(a){console.warn(" RPC function get_connection_degree_reviews failed, using direct query with connection functions"),console.warn("Error details:",{code:a.code,message:a.message,details:a.details});try{const[l,c]=yield Promise.all([P.rpc("get_first_degree_connections",{target_user_id:t}),P.rpc("get_second_degree_connections",{target_user_id:t})]),d=(l.data||[]).map(x=>x.connected_user_id),u=(c.data||[]).map(x=>x.connected_user_id),h=[...d,...u];if(h.length===0)return[];const{data:f,error:p}=yield P.from("reviews").select(`
              *,
              users:user_id (
                user_id,
                name,
                avatar_url,
                verified,
                account_type
              ),
              events (
                id,
                title,
                venue_name,
                event_date,
                artist_name
              )
            `).in("user_id",h).eq("is_public",!0).eq("is_draft",!1).not("review_text","is",null).order("created_at",{ascending:!1}).range(n,n+r-1);return p?(console.warn("Direct reviews query failed, returning empty array:",p),[]):(f||[]).map(x=>{const g=d.includes(x.user_id)?1:2,v=x.users||{},_=x.events||{};return{id:`review-${x.id}`,type:"review",review_id:x.id,title:`${v.name||"User"}'s Review`,content:x.review_text||"",author:{id:x.user_id,name:v.name||"Anonymous",avatar_url:v.avatar_url,verified:v.verified,account_type:v.account_type},created_at:x.created_at,updated_at:x.updated_at,rating:x.rating,is_public:x.is_public,photos:x.photos||void 0,setlist:x.setlist||void 0,likes_count:x.likes_count||0,comments_count:x.comments_count||0,shares_count:x.shares_count||0,artist_performance_rating:x.artist_performance_rating,production_rating:x.production_rating,venue_rating:x.venue_rating,location_rating:x.location_rating,value_rating:x.value_rating,artist_performance_feedback:x.artist_performance_feedback,production_feedback:x.production_feedback,venue_feedback:x.venue_feedback,location_feedback:x.location_feedback,value_feedback:x.value_feedback,event_info:{event_name:_.title||"Concert Review",venue_name:_.venue_name||"Unknown Venue",event_date:_.event_date||x.created_at,artist_name:_.artist_name,artist_id:_.artist_id},connection_degree:g,connection_type_label:g===1?"Friend":"Mutual Friend",relevance_score:this.calculateFriendReviewRelevance(x,g)}})}catch(l){return console.warn("Error in fallback query, returning empty array:",l),[]}}const o=(i||[]).map(l=>this.transformConnectionReview(l));if(n===0){const l=W3.reviews(t,r,n);Eo.set(l,o,vg.REVIEWS)}return o}catch(i){return console.error("Error fetching connection degree reviews:",i),this.getFriendsPlusOneReviews(t,r,n)}})}static transformConnectionReview(t){return{id:`connection-review-${t.review_id}`,type:"review",review_id:t.review_id,title:`${t.reviewer_name||"User"}'s Review`,content:t.review_text||t.content||"",author:{id:t.reviewer_id,name:t.reviewer_name||"Anonymous",avatar_url:t.reviewer_avatar,verified:t.reviewer_verified,account_type:t.reviewer_account_type},created_at:t.created_at,updated_at:t.updated_at,rating:t.rating,is_public:t.is_public,photos:t.photos||void 0,setlist:t.setlist||void 0,likes_count:t.likes_count||0,comments_count:t.comments_count||0,shares_count:t.shares_count||0,event_info:{event_name:t.event_title||"Concert Review",venue_name:t.venue_name||"Unknown Venue",event_date:t.Event_date||t.event_date||t.event_date||t.created_at,artist_name:t.artist_name,artist_id:t.artist_id},connection_degree:t.connection_degree,connection_type_label:t.connection_type_label,connection_color:t.connection_color,relevance_score:this.calculateFriendReviewRelevance(t,t.connection_degree||3)}}static fetchEventsByIds(t){return E(this,null,function*(){const r=new Map,n=Array.from(new Set(t));if(n.length===0)return r;try{const{data:i,error:a}=yield P.from("events").select("id, title, artist_name, artist_id, venue_name, venue_id, event_date, venue_city, venue_state").in("id",n);if(a)return console.warn(" Unable to load events for friend reviews:",a),r;for(const o of i!=null?i:[])o.id&&r.set(o.id,o)}catch(i){console.warn(" Unexpected error while loading events for friend reviews:",i)}return r})}}class Aj{static getFeedItems(t){return E(this,null,function*(){const{userId:r,limit:n=50,offset:i=0,userLocation:a,includePrivateReviews:o=!0,feedType:l="all",filters:c}=t;try{switch(l){case"friends":case"friends_plus_one":return yield lA.getConnectionDegreeReviews(r,n,i);case"public_only":return yield this.getPublicReviews(r,n);case"all":default:return yield this.getUnifiedFeed(t)}}catch(d){throw console.error("Error fetching unified feed:",d),new Error(`Failed to fetch feed: ${d instanceof Error?d.message:"Unknown error"}`)}})}static getUnifiedFeed(t){return E(this,null,function*(){const{userId:r,limit:n=50,offset:i=0,userLocation:a,includePrivateReviews:o=!0,filters:l}=t;try{const c=[];if(o){const x=yield this.getUserReviews(r);c.push(...x)}try{const x=yield lA.getConnectionDegreeReviews(r,n);c.push(...x)}catch(x){console.warn("Error fetching connection degree reviews, falling back to public reviews:",x);const g=yield this.getPublicReviews(r,n);c.push(...g)}const d=yield this.getRecentEvents(a,20,r,i,l);c.push(...d);const u=yield this.getFriendActivity(r,10);c.push(...u);const h=this.deduplicateFeedItems(c),f=this.sortByRelevanceAndTime(h,a);return this.enforceArtistDiversity(f,1).slice(i,i+n)}catch(c){throw console.error("Error fetching unified feed:",c),new Error(`Failed to fetch feed: ${c instanceof Error?c.message:"Unknown error"}`)}})}static getUserReviews(t){return E(this,null,function*(){try{const{data:r}=yield P.from("users").select("name, avatar_url, verified, account_type").eq("user_id",t).single(),{data:n,error:i}=yield P.from("reviews").select("*").eq("user_id",t).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).limit(20);if(i)throw i;const a=yield this.fetchEventsByIds((n||[]).map(o=>o.event_id).filter(o=>!!o));return(n||[]).map(o=>{const l=o.event_id?a.get(o.event_id):null,c=Array.isArray(o.events)?o.events[0]:o.events,d=o.setlist||(c==null?void 0:c.setlist)||(l==null?void 0:l.setlist);return console.log(" getUserReviews: Processing review:",{reviewId:o.id,hasUserReviewSetlist:!!o.setlist,hasEventSetlist:!!(c!=null&&c.setlist||l!=null&&l.setlist),setlistToUse:!!d}),{id:`review-${o.id}`,type:"review",review_id:o.id,title:(c==null?void 0:c.title)||(l==null?void 0:l.title)||(o.is_public?"Your Public Review":"Your Private Review"),content:o.review_text||"",author:{id:t,name:(r==null?void 0:r.name)||"You",avatar_url:r==null?void 0:r.avatar_url,verified:r==null?void 0:r.verified,account_type:r==null?void 0:r.account_type},created_at:o.created_at,updated_at:o.updated_at,rating:o.rating,is_public:o.is_public,photos:o.photos||void 0,setlist:d||void 0,artist_performance_rating:o.artist_performance_rating,production_rating:o.production_rating,venue_rating:o.venue_rating,location_rating:o.location_rating,value_rating:o.value_rating,artist_performance_feedback:o.artist_performance_feedback,production_feedback:o.production_feedback,venue_feedback:o.venue_feedback,location_feedback:o.location_feedback,value_feedback:o.value_feedback,likes_count:o.likes_count||0,comments_count:o.comments_count||0,shares_count:o.shares_count||0,event_info:{event_name:(c==null?void 0:c.title)||(l==null?void 0:l.title)||"Concert Review",venue_name:(c==null?void 0:c.venue_name)||(l==null?void 0:l.venue_name)||"Unknown Venue",event_date:o.Event_date||o.event_date||(c==null?void 0:c.event_date)||(l==null?void 0:l.event_date)||o.created_at,artist_name:(c==null?void 0:c.artist_name)||(l==null?void 0:l.artist_name),artist_id:(c==null?void 0:c.artist_id)||(l==null?void 0:l.artist_id)},relevance_score:this.calculateReviewRelevance(o,!0)}})}catch(r){return console.error("Error fetching user reviews:",r),[]}})}static fetchEventsByIds(t){return E(this,null,function*(){const r=new Map,n=Array.from(new Set(t));if(n.length===0)return r;try{const{data:i,error:a}=yield P.from("events").select("id, title, artist_name, artist_id, venue_name, venue_id, event_date, venue_city, venue_state, setlist").in("id",n);if(a)return console.warn(" Unable to load events for reviews:",a),r;for(const o of i!=null?i:[])o.id&&r.set(o.id,o)}catch(i){console.warn(" Unexpected error while loading events for reviews:",i)}return r})}static fetchUsersByIds(t){return E(this,null,function*(){const r=new Map,n=Array.from(new Set(t));if(n.length===0)return r;try{const{data:i,error:a}=yield P.from("users").select("user_id, name, avatar_url, verified, account_type").in("user_id",n);if(a)return console.warn(" Unable to load users for reviews:",a),r;for(const o of i!=null?i:[])o.user_id&&r.set(o.user_id,o)}catch(i){console.warn(" Unexpected error while loading users for reviews:",i)}return r})}static getPublicReviews(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("reviews").select("*").neq("user_id",t).eq("is_public",!0).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).limit(r);if(i)throw i;const a=yield this.fetchEventsByIds((n||[]).map(l=>l.event_id).filter(l=>!!l)),o=yield this.fetchUsersByIds((n||[]).map(l=>l.user_id).filter(l=>!!l));return(n||[]).map(l=>{const c=l.event_id?a.get(l.event_id):null,d=l.user_id?o.get(l.user_id):null;return{id:`public-review-${l.id}`,type:"review",review_id:l.id,title:`${(d==null?void 0:d.name)||"Someone"}'s Review`,content:l.review_text||"",author:{id:l.user_id,name:(d==null?void 0:d.name)||"Anonymous",avatar_url:d==null?void 0:d.avatar_url,verified:d==null?void 0:d.verified,account_type:d==null?void 0:d.account_type},created_at:l.created_at,rating:l.rating,is_public:!0,photos:l.photos||void 0,setlist:(c==null?void 0:c.setlist)||void 0,likes_count:l.likes_count||0,comments_count:l.comments_count||0,shares_count:l.shares_count||0,event_info:{event_name:(c==null?void 0:c.title)||"Concert Review",venue_name:(c==null?void 0:c.venue_name)||"Unknown Venue",event_date:(c==null?void 0:c.event_date)||l.created_at,artist_name:c==null?void 0:c.artist_name,artist_id:l.artist_id},relevance_score:this.calculateReviewRelevance(l,!1)}})}catch(n){return console.error("Error fetching public reviews:",n),[]}})}static getRecentEvents(t,r=20,n,i=0,a){return E(this,null,function*(){var o,l;try{if(n){console.log(" Attempting personalized feed for user:",n);try{const x=yield Oh.getPersonalizedFeed(n,r,i,!1,a),g=x.length>0&&x.some(_=>_.relevance_score!==void 0&&_.relevance_score!==null);return g||x.length===0||i>0?(x.length>0?console.log(" Using PERSONALIZED feed:",{count:x.length,topScore:(o=x[0])==null?void 0:o.relevance_score,topArtist:(l=x[0])==null?void 0:l.artist_name,hasScores:g,scores:x.slice(0,5).map(_=>({artist:_.artist_name,score:_.relevance_score}))}):console.log(" Using PERSONALIZED feed (empty - end of results at this offset):",{offset:i,limit:r,reason:i>0?"pagination":"no personalized events available"}),x.map(_=>this.transformPersonalizedEventToFeedItem(_,t))):(console.warn(" Personalized feed returned events without scores at offset 0. Using anyway (scores may be 0/null but still personalized)."),x.map(_=>this.transformPersonalizedEventToFeedItem(_,t)))}catch(x){console.warn(" Personalized feed failed, falling back to standard:",x)}}console.log(" Using STANDARD feed (no personalization)");let c=P.from("events").select("*").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0});const d=Math.max(r*2,40);c=c.limit(d);const{data:u,error:h}=yield c;if(h)throw h;let f=u||[];if(f.length<r&&i===0){console.log(` Standard feed: Only got ${f.length} events, fetching more to reach ${r}...`);const{data:x}=yield P.from("events").select("*").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(r*3);x&&x.length>f.length&&(f=x,console.log(` Standard feed: Got ${f.length} events from expanded query`))}let p=(f||[]).map(x=>{const g={id:`event-${x.id}`,type:"event",title:x.title,content:x.description||`${x.artist_name} is performing at ${x.venue_name}`,author:{id:"system",name:"",avatar_url:void 0},created_at:x.created_at||x.event_date,event_data:M(M(M(M(M({id:x.id,jambase_event_id:x.jambase_event_id,title:x.title,artist_name:x.artist_name,artist_id:x.artist_id||"",venue_name:x.venue_name,venue_id:x.venue_id||"",event_date:x.event_date,doors_time:x.doors_time,description:x.description,genres:x.genres,venue_address:x.venue_address,venue_city:x.venue_city,venue_state:x.venue_state,venue_zip:x.venue_zip,latitude:x.latitude?Number(x.latitude):void 0,longitude:x.longitude?Number(x.longitude):void 0,ticket_available:x.ticket_available,price_range:x.price_range,ticket_urls:x.ticket_urls||(x.ticket_url?[x.ticket_url]:[]),setlist:x.setlist,setlist_enriched:x.setlist_enriched,setlist_song_count:x.setlist_song_count,setlist_fm_id:x.setlist_fm_id,setlist_fm_url:x.setlist_fm_url,tour_name:x.tour_name,created_at:x.created_at,updated_at:x.updated_at},x.price_min&&{ticket_price_min:x.price_min}),x.price_max&&{ticket_price_max:x.price_max}),x.ticket_url&&{ticket_url:x.ticket_url}),x.price_min&&{price_min:x.price_min}),x.price_max&&{price_max:x.price_max}),event_info:{event_name:x.title,venue_name:x.venue_name,event_date:x.event_date,artist_name:x.artist_name,artist_id:x.artist_id},location:x.latitude&&x.longitude?{lat:Number(x.latitude),lng:Number(x.longitude),venue_name:x.venue_name,venue_address:x.venue_address}:void 0,relevance_score:this.calculateEventRelevance(x,t)};return t&&g.location&&(g.distance_miles=this.calculateDistance(t.lat,t.lng,g.location.lat,g.location.lng)),g});return t&&(p=p.filter(x=>!x.distance_miles||x.distance_miles<=50).slice(0,r)),p}catch(c){return console.error("Error fetching recent events:",c),[]}})}static transformPersonalizedEventToFeedItem(t,r){var o,l,c;const n=t.id||t.event_id||t.jambase_event_id,i=W(M({},t),{id:n,ticket_price_min:(o=t.ticket_price_min)!=null?o:null,ticket_price_max:(l=t.ticket_price_max)!=null?l:null,ticket_url:(c=t.ticket_url)!=null?c:null}),a={id:`event-${n||"unknown"}`,type:"event",title:t.title,content:t.description||`${t.artist_name} is performing at ${t.venue_name}`,author:{id:"system",name:"",avatar_url:void 0},created_at:t.created_at,event_data:i,event_info:{event_name:t.title,venue_name:t.venue_name,event_date:t.event_date,artist_name:t.artist_name,artist_id:t.artist_id||void 0},location:t.latitude&&t.longitude?{lat:Number(t.latitude),lng:Number(t.longitude),venue_name:t.venue_name,venue_address:t.venue_address||void 0}:void 0,relevance_score:(t.relevance_score||0)/100};return r&&a.location&&(a.distance_miles=this.calculateDistance(r.lat,r.lng,a.location.lat,a.location.lng)),a}static getFriendActivity(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("user_relationships").select("id, user_id, related_user_id, created_at").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`).order("created_at",{ascending:!1}).limit(r);if(i)throw i;if(!n||n.length===0)return[];const a=n.map(d=>d.user_id===t?d.related_user_id:d.user_id),{data:o,error:l}=yield P.from("users").select("user_id, name, avatar_url").in("user_id",a);if(l)return console.error("Error fetching friend profiles:",l),[];const c=new Map((o==null?void 0:o.map(d=>[d.user_id,d]))||[]);return n.map(d=>{const u=d.user_id===t?d.related_user_id:d.user_id,h=c.get(u);return{id:`friend-activity-${d.id}`,type:"friend_activity",title:`You're now friends with ${(h==null?void 0:h.name)||"someone"}!`,content:"Start chatting and discover concerts together.",author:{id:u,name:(h==null?void 0:h.name)||"Unknown",avatar_url:h==null?void 0:h.avatar_url},created_at:d.created_at,relevance_score:this.calculateFriendActivityRelevance(d)}})}catch(n){return console.error("Error fetching friend activity:",n),[]}})}static sortByRelevanceAndTime(t,r){return t.sort((n,i)=>{const a=i.relevance_score-n.relevance_score;if(Math.abs(a)>.1)return a;const o=new Date(n.created_at).getTime();return new Date(i.created_at).getTime()-o})}static calculateReviewRelevance(t,r){let n=r?.9:.5;t.is_public&&!r&&(n+=.2);const i=(Date.now()-new Date(t.created_at).getTime())/(1e3*60*60*24);i<1?n+=.3:i<7?n+=.2:i<30&&(n+=.1);const a=(t.likes_count||0)+(t.comments_count||0);return n+=Math.min(a*.05,.3),Math.min(n,1)}static calculateEventRelevance(t,r){let n=.6;const a=(new Date(t.event_date).getTime()-Date.now())/(1e3*60*60*24);return a>=0&&a<=30?n+=.3:a>30&&a<=90&&(n+=.2),t.latitude&&t.longitude&&(n+=.1),t.ticket_available&&(n+=.1),Math.min(n,1)}static calculateFriendActivityRelevance(t){let r=.7;const n=(Date.now()-new Date(t.created_at).getTime())/(1e3*60*60*24);return n<1?r+=.2:n<7&&(r+=.1),Math.min(r,1)}static calculateDistance(t,r,n,i){const o=this.toRadians(n-t),l=this.toRadians(i-r),c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(this.toRadians(t))*Math.cos(this.toRadians(n))*Math.sin(l/2)*Math.sin(l/2);return 3959*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}static toRadians(t){return t*(Math.PI/180)}static deduplicateFeedItems(t){var a,o,l,c,d,u,h;const r=new Set,n=[],i=[];for(const f of t){let p=null;if(f.type==="event"&&((a=f.event_data)!=null&&a.id)&&(p=`id-${String(f.event_data.id)}`),!p&&f.type==="event"){const x=(((o=f.event_info)==null?void 0:o.artist_name)||f.title||"").toLowerCase().trim().replace(/\s+/g," ").replace(/[^\w\s]/g,""),g=(((l=f.event_info)==null?void 0:l.venue_name)||((c=f.event_data)==null?void 0:c.venue_name)||"").toLowerCase().trim().replace(/\s+/g," ").replace(/\bthe\s+/gi,"").replace(/\bo2\s+/gi,"").replace(/[^\w\s]/g,""),v=(d=f.event_info)!=null&&d.event_date?f.event_info.event_date.split("T")[0]:(u=f.event_data)!=null&&u.event_date?f.event_data.event_date.split("T")[0]:"";x&&g&&v&&(p=`match-${x}|${g}|${v}`)}if(!p){n.push(f);continue}if(!r.has(p))r.add(p),n.push(f);else{i.push(p);const x=((h=f.event_info)==null?void 0:h.event_name)||f.title||"Unknown";console.log(` Duplicate event filtered: ${x} (key: ${p})`)}}return i.length>0&&console.log(` Deduplication: Removed ${i.length} duplicate event(s) from feed`),n}static enforceArtistDiversity(t,r){var a,o;const n=new Map,i=[];for(const l of t){const c=(((a=l.event_info)==null?void 0:a.artist_name)||((o=l.event_data)==null?void 0:o.artist_name)||"").toString();if(!c){i.push(l);continue}const d=c.toLowerCase().trim().replace(/\s+/g," ").replace(/[^[\w\s]]/g,""),u=n.get(d)||0;u<r&&(i.push(l),n.set(d,u+1))}return i}}const zue=new ua.Icon({iconUrl:hU,iconRetinaUrl:fU,shadowUrl:mU,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),Vue=({center:e,zoom:t,onCenterChange:r})=>{const n=tp(),i=y.useRef(!1),a=y.useRef(e),o=y.useRef(t);return y.useEffect(()=>{const l=Math.abs(a.current[0]-e[0])>1e-4||Math.abs(a.current[1]-e[1])>1e-4,c=o.current!==t;(l||c)&&!i.current&&(a.current=e,o.current=t,n.setView(e,t,{animate:!1}))},[n,e,t]),y.useEffect(()=>{const l=()=>{i.current=!0},c=()=>{const d=n.getCenter();r&&r([d.lat,d.lng]),setTimeout(()=>{i.current=!1},300)};return n.on("movestart",l),n.on("dragstart",l),n.on("zoomstart",l),n.on("wheel",l),n.on("moveend",c),n.on("dragend",c),n.on("zoomend",c),()=>{n.off("movestart",l),n.off("dragstart",l),n.off("zoomstart",l),n.off("wheel",l),n.off("moveend",c),n.off("dragend",c),n.off("zoomend",c)}},[n,r]),null},que=({events:e,onBoundsChange:t})=>{const r=tp(),n=y.useRef(null),i=y.useRef(e),a=y.useRef(t);return y.useEffect(()=>{i.current=e,a.current=t},[e,t]),y.useEffect(()=>{const o=()=>{const c=r.getBounds(),d={north:c.getNorth(),south:c.getSouth(),east:c.getEast(),west:c.getWest()},u=`${d.north.toFixed(4)}_${d.south.toFixed(4)}_${d.east.toFixed(4)}_${d.west.toFixed(4)}`;if(n.current===u)return;n.current=u;const h=i.current.filter(f=>{if(!f.latitude||!f.longitude)return!1;const p=Number(f.latitude),x=Number(f.longitude);return Number.isNaN(p)||Number.isNaN(x)?!1:p>=d.south&&p<=d.north&&x>=d.west&&x<=d.east});a.current&&a.current(h)};r.on("moveend",o),r.on("zoomend",o);const l=setTimeout(o,100);return()=>{clearTimeout(l),r.off("moveend",o),r.off("zoomend",o)}},[r]),null},eB=({center:e,zoom:t,events:r,onEventClick:n,onMapCenterChange:i})=>{const a=y.useRef(null),[o,l]=y.useState([]),c=r.filter(u=>{const h=Number(u.latitude),f=Number(u.longitude);return u.latitude!=null&&u.longitude!=null&&!Number.isNaN(h)&&!Number.isNaN(f)}),d=o.length>0?o:c;return s.jsx("div",{className:"w-full h-full",children:s.jsxs(i1,{center:e,zoom:t,style:{height:"100%",width:"100%"},ref:a,scrollWheelZoom:!0,wheelPxPerZoomLevel:60,children:[s.jsx(a1,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(Vue,{center:e,zoom:t,onCenterChange:i}),s.jsx(que,{events:c,onBoundsChange:l}),d.map(u=>s.jsx(jg,{position:[Number(u.latitude),Number(u.longitude)],icon:zue,children:s.jsx(uU,{maxWidth:300,className:"event-popup",children:s.jsxs("div",{className:"p-2",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-sm text-gray-900 mb-1 truncate",children:u.title}),s.jsx("p",{className:"text-sm text-blue-600 font-medium mb-1",children:u.artist_name})]}),s.jsxs(Be,{variant:"outline",className:"text-xs ml-2",children:[s.jsx(Ct,{className:"w-3 h-3 mr-1"}),"Event"]})]}),s.jsxs("div",{className:"space-y-2 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx(Xt,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:u.venue_name})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[s.jsx(Et,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{children:(()=>{try{return Dt(Ws(u.event_date),"MMM d, yyyy h:mm a")}catch(h){return u.event_date}})()})]}),u.venue_address&&s.jsxs("p",{className:"text-xs text-gray-500 line-clamp-2",children:[u.venue_address,u.venue_city&&`, ${u.venue_city}`,u.venue_state&&`, ${u.venue_state}`]}),u.genres&&u.genres.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:u.genres.slice(0,3).map((h,f)=>s.jsx(Be,{variant:"secondary",className:"text-xs",children:h},f))}),u.price_range&&s.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-600",children:[s.jsx(xc,{className:"w-3 h-3"}),s.jsx("span",{children:bg(u.price_range)})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{size:"sm",onClick:h=>{h.stopPropagation(),n(u)},className:"flex-1 text-xs bg-pink-500 hover:bg-pink-600",children:[s.jsx(Ct,{className:"w-3 h-3 mr-1"}),"Review"]}),u.ticket_urls&&u.ticket_urls.length>0&&s.jsxs(oe,{size:"sm",variant:"outline",onClick:h=>{h.stopPropagation(),window.open(u.ticket_urls[0],"_blank")},className:"text-xs",children:[s.jsx(xc,{className:"w-3 h-3 mr-1"}),"Tickets"]})]})]})})},u.id))]})})};var iS=["Enter"," "],Wue=["ArrowDown","PageUp","Home"],tB=["ArrowUp","PageDown","End"],Hue=[...Wue,...tB],Gue={ltr:[...iS,"ArrowRight"],rtl:[...iS,"ArrowLeft"]},Yue={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Rv="Menu",[Ng,Kue,Zue]=zm(Rv),[mf,rB]=js(Rv,[Zue,Rd,Ww]),f1=Rd(),nB=Ww(),[Xue,pf]=mf(Rv),[Jue,Mv]=mf(Rv),sB=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:i,onOpenChange:a,modal:o=!0}=e,l=f1(t),[c,d]=y.useState(null),u=y.useRef(!1),h=ss(a),f=hf(i);return y.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",x,{capture:!0,once:!0}),document.addEventListener("pointermove",x,{capture:!0,once:!0})},x=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",x,{capture:!0}),document.removeEventListener("pointermove",x,{capture:!0})}},[]),s.jsx(jw,W(M({},l),{children:s.jsx(Xue,{scope:t,open:r,onOpenChange:h,content:c,onContentChange:d,children:s.jsx(Jue,{scope:t,onClose:y.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:u,dir:f,modal:o,children:n})})}))};sB.displayName=Rv;var Que="MenuAnchor",e4=y.forwardRef((e,t)=>{const a=e,{__scopeMenu:r}=a,n=me(a,["__scopeMenu"]),i=f1(r);return s.jsx(wv,W(M(M({},i),n),{ref:t}))});e4.displayName=Que;var t4="MenuPortal",[efe,iB]=mf(t4,{forceMount:void 0}),aB=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:i}=e,a=pf(t4,t);return s.jsx(efe,{scope:t,forceMount:r,children:s.jsx($s,{present:r||a.open,children:s.jsx(Vm,{asChild:!0,container:i,children:n})})})};aB.displayName=t4;var Ka="MenuContent",[tfe,r4]=mf(Ka),oB=y.forwardRef((e,t)=>{const r=iB(Ka,e.__scopeMenu),l=e,{forceMount:n=r.forceMount}=l,i=me(l,["forceMount"]),a=pf(Ka,e.__scopeMenu),o=Mv(Ka,e.__scopeMenu);return s.jsx(Ng.Provider,{scope:e.__scopeMenu,children:s.jsx($s,{present:n||a.open,children:s.jsx(Ng.Slot,{scope:e.__scopeMenu,children:o.modal?s.jsx(rfe,W(M({},i),{ref:t})):s.jsx(nfe,W(M({},i),{ref:t}))})})})}),rfe=y.forwardRef((e,t)=>{const r=pf(Ka,e.__scopeMenu),n=y.useRef(null),i=sr(t,n);return y.useEffect(()=>{const a=n.current;if(a)return Uw(a)},[]),s.jsx(n4,W(M({},e),{ref:i,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:mt(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)}))}),nfe=y.forwardRef((e,t)=>{const r=pf(Ka,e.__scopeMenu);return s.jsx(n4,W(M({},e),{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)}))}),sfe=Nd("MenuContent.ScrollLock"),n4=y.forwardRef((e,t)=>{const K=e,{__scopeMenu:r,loop:n=!1,trapFocus:i,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:f,onDismiss:p,disableOutsideScroll:x}=K,g=me(K,["__scopeMenu","loop","trapFocus","onOpenAutoFocus","onCloseAutoFocus","disableOutsidePointerEvents","onEntryFocus","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss","disableOutsideScroll"]),v=pf(Ka,r),_=Mv(Ka,r),w=f1(r),b=nB(r),N=Kue(r),[S,k]=y.useState(null),O=y.useRef(null),A=sr(t,O,v.onContentChange),T=y.useRef(0),$=y.useRef(""),R=y.useRef(0),F=y.useRef(null),D=y.useRef("right"),B=y.useRef(0),U=x?kv:y.Fragment,V=x?{as:sfe,allowPinchZoom:!0}:void 0,Y=Z=>{var xe,ge;const G=$.current+Z,X=N().filter(ie=>!ie.disabled),te=document.activeElement,se=(xe=X.find(ie=>ie.ref.current===te))==null?void 0:xe.textValue,ue=X.map(ie=>ie.textValue),ye=gfe(ue,G,se),ne=(ge=X.find(ie=>ie.textValue===ye))==null?void 0:ge.ref.current;(function ie(ee){$.current=ee,window.clearTimeout(T.current),ee!==""&&(T.current=window.setTimeout(()=>ie(""),1e3))})(G),ne&&setTimeout(()=>ne.focus())};y.useEffect(()=>()=>window.clearTimeout(T.current),[]),Lw();const z=y.useCallback(Z=>{var X,te;return D.current===((X=F.current)==null?void 0:X.side)&&xfe(Z,(te=F.current)==null?void 0:te.area)},[]);return s.jsx(tfe,{scope:r,searchRef:$,onItemEnter:y.useCallback(Z=>{z(Z)&&Z.preventDefault()},[z]),onItemLeave:y.useCallback(Z=>{var G;z(Z)||((G=O.current)==null||G.focus(),k(null))},[z]),onTriggerLeave:y.useCallback(Z=>{z(Z)&&Z.preventDefault()},[z]),pointerGraceTimerRef:R,onPointerGraceIntentChange:y.useCallback(Z=>{F.current=Z},[]),children:s.jsx(U,W(M({},V),{children:s.jsx(Sv,{asChild:!0,trapped:i,onMountAutoFocus:mt(a,Z=>{var G;Z.preventDefault(),(G=O.current)==null||G.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:s.jsx(of,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:f,onDismiss:p,children:s.jsx(FL,W(M({asChild:!0},b),{dir:_.dir,orientation:"vertical",loop:n,currentTabStopId:S,onCurrentTabStopIdChange:k,onEntryFocus:mt(c,Z=>{_.isUsingKeyboardRef.current||Z.preventDefault()}),preventScrollOnEntryFocus:!0,children:s.jsx(Nw,W(M(M({role:"menu","aria-orientation":"vertical","data-state":jB(v.open),"data-radix-menu-content":"",dir:_.dir},w),g),{ref:A,style:M({outline:"none"},g.style),onKeyDown:mt(g.onKeyDown,Z=>{const X=Z.target.closest("[data-radix-menu-content]")===Z.currentTarget,te=Z.ctrlKey||Z.altKey||Z.metaKey,se=Z.key.length===1;X&&(Z.key==="Tab"&&Z.preventDefault(),!te&&se&&Y(Z.key));const ue=O.current;if(Z.target!==ue||!Hue.includes(Z.key))return;Z.preventDefault();const ne=N().filter(xe=>!xe.disabled).map(xe=>xe.ref.current);tB.includes(Z.key)&&ne.reverse(),mfe(ne)}),onBlur:mt(e.onBlur,Z=>{Z.currentTarget.contains(Z.target)||(window.clearTimeout(T.current),$.current="")}),onPointerMove:mt(e.onPointerMove,Sg(Z=>{const G=Z.target,X=B.current!==Z.clientX;if(Z.currentTarget.contains(G)&&X){const te=Z.clientX>B.current?"right":"left";D.current=te,B.current=Z.clientX}}))}))}))})})}))})});oB.displayName=Ka;var ife="MenuGroup",s4=y.forwardRef((e,t)=>{const i=e,{__scopeMenu:r}=i,n=me(i,["__scopeMenu"]);return s.jsx(Nt.div,W(M({role:"group"},n),{ref:t}))});s4.displayName=ife;var afe="MenuLabel",lB=y.forwardRef((e,t)=>{const i=e,{__scopeMenu:r}=i,n=me(i,["__scopeMenu"]);return s.jsx(Nt.div,W(M({},n),{ref:t}))});lB.displayName=afe;var z2="MenuItem",cA="menu.itemSelect",h1=y.forwardRef((e,t)=>{const h=e,{disabled:r=!1,onSelect:n}=h,i=me(h,["disabled","onSelect"]),a=y.useRef(null),o=Mv(z2,e.__scopeMenu),l=r4(z2,e.__scopeMenu),c=sr(t,a),d=y.useRef(!1),u=()=>{const f=a.current;if(!r&&f){const p=new CustomEvent(cA,{bubbles:!0,cancelable:!0});f.addEventListener(cA,x=>n==null?void 0:n(x),{once:!0}),Vk(f,p),p.defaultPrevented?d.current=!1:o.onClose()}};return s.jsx(cB,W(M({},i),{ref:c,disabled:r,onClick:mt(e.onClick,u),onPointerDown:f=>{var p;(p=e.onPointerDown)==null||p.call(e,f),d.current=!0},onPointerUp:mt(e.onPointerUp,f=>{var p;d.current||(p=f.currentTarget)==null||p.click()}),onKeyDown:mt(e.onKeyDown,f=>{const p=l.searchRef.current!=="";r||p&&f.key===" "||iS.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})}))});h1.displayName=z2;var cB=y.forwardRef((e,t)=>{const x=e,{__scopeMenu:r,disabled:n=!1,textValue:i}=x,a=me(x,["__scopeMenu","disabled","textValue"]),o=r4(z2,r),l=nB(r),c=y.useRef(null),d=sr(t,c),[u,h]=y.useState(!1),[f,p]=y.useState("");return y.useEffect(()=>{var v;const g=c.current;g&&p(((v=g.textContent)!=null?v:"").trim())},[a.children]),s.jsx(Ng.ItemSlot,{scope:r,disabled:n,textValue:i!=null?i:f,children:s.jsx(UL,W(M({asChild:!0},l),{focusable:!n,children:s.jsx(Nt.div,W(M({role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0},a),{ref:d,onPointerMove:mt(e.onPointerMove,Sg(g=>{n?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:mt(e.onPointerLeave,Sg(g=>o.onItemLeave(g))),onFocus:mt(e.onFocus,()=>h(!0)),onBlur:mt(e.onBlur,()=>h(!1))}))}))})}),ofe="MenuCheckboxItem",dB=y.forwardRef((e,t)=>{const a=e,{checked:r=!1,onCheckedChange:n}=a,i=me(a,["checked","onCheckedChange"]);return s.jsx(pB,{scope:e.__scopeMenu,checked:r,children:s.jsx(h1,W(M({role:"menuitemcheckbox","aria-checked":V2(r)?"mixed":r},i),{ref:t,"data-state":a4(r),onSelect:mt(i.onSelect,()=>n==null?void 0:n(V2(r)?!0:!r),{checkForDefaultPrevented:!1})}))})});dB.displayName=ofe;var uB="MenuRadioGroup",[lfe,cfe]=mf(uB,{value:void 0,onValueChange:()=>{}}),fB=y.forwardRef((e,t)=>{const o=e,{value:r,onValueChange:n}=o,i=me(o,["value","onValueChange"]),a=ss(n);return s.jsx(lfe,{scope:e.__scopeMenu,value:r,onValueChange:a,children:s.jsx(s4,W(M({},i),{ref:t}))})});fB.displayName=uB;var hB="MenuRadioItem",mB=y.forwardRef((e,t)=>{const o=e,{value:r}=o,n=me(o,["value"]),i=cfe(hB,e.__scopeMenu),a=r===i.value;return s.jsx(pB,{scope:e.__scopeMenu,checked:a,children:s.jsx(h1,W(M({role:"menuitemradio","aria-checked":a},n),{ref:t,"data-state":a4(a),onSelect:mt(n.onSelect,()=>{var l;return(l=i.onValueChange)==null?void 0:l.call(i,r)},{checkForDefaultPrevented:!1})}))})});mB.displayName=hB;var i4="MenuItemIndicator",[pB,dfe]=mf(i4,{checked:!1}),gB=y.forwardRef((e,t)=>{const o=e,{__scopeMenu:r,forceMount:n}=o,i=me(o,["__scopeMenu","forceMount"]),a=dfe(i4,r);return s.jsx($s,{present:n||V2(a.checked)||a.checked===!0,children:s.jsx(Nt.span,W(M({},i),{ref:t,"data-state":a4(a.checked)}))})});gB.displayName=i4;var ufe="MenuSeparator",vB=y.forwardRef((e,t)=>{const i=e,{__scopeMenu:r}=i,n=me(i,["__scopeMenu"]);return s.jsx(Nt.div,W(M({role:"separator","aria-orientation":"horizontal"},n),{ref:t}))});vB.displayName=ufe;var ffe="MenuArrow",xB=y.forwardRef((e,t)=>{const a=e,{__scopeMenu:r}=a,n=me(a,["__scopeMenu"]),i=f1(r);return s.jsx(Sw,W(M(M({},i),n),{ref:t}))});xB.displayName=ffe;var hfe="MenuSub",[EFe,yB]=mf(hfe),_0="MenuSubTrigger",_B=y.forwardRef((e,t)=>{const r=pf(_0,e.__scopeMenu),n=Mv(_0,e.__scopeMenu),i=yB(_0,e.__scopeMenu),a=r4(_0,e.__scopeMenu),o=y.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=a,d={__scopeMenu:e.__scopeMenu},u=y.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return y.useEffect(()=>u,[u]),y.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),s.jsx(e4,W(M({asChild:!0},d),{children:s.jsx(cB,W(M({id:i.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":i.contentId,"data-state":jB(r.open)},e),{ref:vc(t,i.onTriggerChange),onClick:h=>{var f;(f=e.onClick)==null||f.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:mt(e.onPointerMove,Sg(h=>{a.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!r.open&&!o.current&&(a.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:mt(e.onPointerLeave,Sg(h=>{var p,x;u();const f=(p=r.content)==null?void 0:p.getBoundingClientRect();if(f){const g=(x=r.content)==null?void 0:x.dataset.side,v=g==="right",_=v?-5:5,w=f[v?"left":"right"],b=f[v?"right":"left"];a.onPointerGraceIntentChange({area:[{x:h.clientX+_,y:h.clientY},{x:w,y:f.top},{x:b,y:f.top},{x:b,y:f.bottom},{x:w,y:f.bottom}],side:g}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(h),h.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:mt(e.onKeyDown,h=>{var p;const f=a.searchRef.current!=="";e.disabled||f&&h.key===" "||Gue[n.dir].includes(h.key)&&(r.onOpenChange(!0),(p=r.content)==null||p.focus(),h.preventDefault())})}))}))});_B.displayName=_0;var wB="MenuSubContent",bB=y.forwardRef((e,t)=>{const r=iB(Ka,e.__scopeMenu),u=e,{forceMount:n=r.forceMount}=u,i=me(u,["forceMount"]),a=pf(Ka,e.__scopeMenu),o=Mv(Ka,e.__scopeMenu),l=yB(wB,e.__scopeMenu),c=y.useRef(null),d=sr(t,c);return s.jsx(Ng.Provider,{scope:e.__scopeMenu,children:s.jsx($s,{present:n||a.open,children:s.jsx(Ng.Slot,{scope:e.__scopeMenu,children:s.jsx(n4,W(M({id:l.contentId,"aria-labelledby":l.triggerId},i),{ref:d,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:h=>{var f;o.isUsingKeyboardRef.current&&((f=c.current)==null||f.focus()),h.preventDefault()},onCloseAutoFocus:h=>h.preventDefault(),onFocusOutside:mt(e.onFocusOutside,h=>{h.target!==l.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:mt(e.onEscapeKeyDown,h=>{o.onClose(),h.preventDefault()}),onKeyDown:mt(e.onKeyDown,h=>{var x;const f=h.currentTarget.contains(h.target),p=Yue[o.dir].includes(h.key);f&&p&&(a.onOpenChange(!1),(x=l.trigger)==null||x.focus(),h.preventDefault())})}))})})})});bB.displayName=wB;function jB(e){return e?"open":"closed"}function V2(e){return e==="indeterminate"}function a4(e){return V2(e)?"indeterminate":e?"checked":"unchecked"}function mfe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function pfe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function gfe(e,t,r){const i=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,a=r?e.indexOf(r):-1;let o=pfe(e,Math.max(a,0));i.length===1&&(o=o.filter(d=>d!==r));const c=o.find(d=>d.toLowerCase().startsWith(i.toLowerCase()));return c!==r?c:void 0}function vfe(e,t){const{x:r,y:n}=e;let i=!1;for(let a=0,o=t.length-1;a<t.length;o=a++){const l=t[a],c=t[o],d=l.x,u=l.y,h=c.x,f=c.y;u>n!=f>n&&r<(h-d)*(n-u)/(f-u)+d&&(i=!i)}return i}function xfe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return vfe(r,t)}function Sg(e){return t=>t.pointerType==="mouse"?e(t):void 0}var yfe=sB,_fe=e4,wfe=aB,bfe=oB,jfe=s4,Nfe=lB,Sfe=h1,kfe=dB,Efe=fB,Cfe=mB,Pfe=gB,Afe=vB,Tfe=xB,Ofe=_B,Rfe=bB,m1="DropdownMenu",[Mfe,CFe]=js(m1,[rB]),Fi=rB(),[Dfe,NB]=Mfe(m1),SB=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:i,defaultOpen:a,onOpenChange:o,modal:l=!0}=e,c=Fi(t),d=y.useRef(null),[u,h]=Di({prop:i,defaultProp:a!=null?a:!1,onChange:o,caller:m1});return s.jsx(Dfe,{scope:t,triggerId:_s(),triggerRef:d,contentId:_s(),open:u,onOpenChange:h,onOpenToggle:y.useCallback(()=>h(f=>!f),[h]),modal:l,children:s.jsx(yfe,W(M({},c),{open:u,onOpenChange:h,dir:n,modal:l,children:r}))})};SB.displayName=m1;var kB="DropdownMenuTrigger",EB=y.forwardRef((e,t)=>{const l=e,{__scopeDropdownMenu:r,disabled:n=!1}=l,i=me(l,["__scopeDropdownMenu","disabled"]),a=NB(kB,r),o=Fi(r);return s.jsx(_fe,W(M({asChild:!0},o),{children:s.jsx(Nt.button,W(M({type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":n?"":void 0,disabled:n},i),{ref:vc(t,a.triggerRef),onPointerDown:mt(e.onPointerDown,c=>{!n&&c.button===0&&c.ctrlKey===!1&&(a.onOpenToggle(),a.open||c.preventDefault())}),onKeyDown:mt(e.onKeyDown,c=>{n||(["Enter"," "].includes(c.key)&&a.onOpenToggle(),c.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(c.key)&&c.preventDefault())})}))}))});EB.displayName=kB;var Ife="DropdownMenuPortal",CB=e=>{const i=e,{__scopeDropdownMenu:t}=i,r=me(i,["__scopeDropdownMenu"]),n=Fi(t);return s.jsx(wfe,M(M({},n),r))};CB.displayName=Ife;var PB="DropdownMenuContent",AB=y.forwardRef((e,t)=>{const l=e,{__scopeDropdownMenu:r}=l,n=me(l,["__scopeDropdownMenu"]),i=NB(PB,r),a=Fi(r),o=y.useRef(!1);return s.jsx(bfe,W(M(M({id:i.contentId,"aria-labelledby":i.triggerId},a),n),{ref:t,onCloseAutoFocus:mt(e.onCloseAutoFocus,c=>{var d;o.current||(d=i.triggerRef.current)==null||d.focus(),o.current=!1,c.preventDefault()}),onInteractOutside:mt(e.onInteractOutside,c=>{const d=c.detail.originalEvent,u=d.button===0&&d.ctrlKey===!0,h=d.button===2||u;(!i.modal||h)&&(o.current=!0)}),style:W(M({},e.style),{"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))});AB.displayName=PB;var $fe="DropdownMenuGroup",Lfe=y.forwardRef((e,t)=>{const a=e,{__scopeDropdownMenu:r}=a,n=me(a,["__scopeDropdownMenu"]),i=Fi(r);return s.jsx(jfe,W(M(M({},i),n),{ref:t}))});Lfe.displayName=$fe;var Ffe="DropdownMenuLabel",TB=y.forwardRef((e,t)=>{const a=e,{__scopeDropdownMenu:r}=a,n=me(a,["__scopeDropdownMenu"]),i=Fi(r);return s.jsx(Nfe,W(M(M({},i),n),{ref:t}))});TB.displayName=Ffe;var Ufe="DropdownMenuItem",OB=y.forwardRef((e,t)=>{const a=e,{__scopeDropdownMenu:r}=a,n=me(a,["__scopeDropdownMenu"]),i=Fi(r);return s.jsx(Sfe,W(M(M({},i),n),{ref:t}))});OB.displayName=Ufe;var Bfe="DropdownMenuCheckboxItem",RB=y.forwardRef((e,t)=>{const a=e,{__scopeDropdownMenu:r}=a,n=me(a,["__scopeDropdownMenu"]),i=Fi(r);return s.jsx(kfe,W(M(M({},i),n),{ref:t}))});RB.displayName=Bfe;var zfe="DropdownMenuRadioGroup",Vfe=y.forwardRef((e,t)=>{const a=e,{__scopeDropdownMenu:r}=a,n=me(a,["__scopeDropdownMenu"]),i=Fi(r);return s.jsx(Efe,W(M(M({},i),n),{ref:t}))});Vfe.displayName=zfe;var qfe="DropdownMenuRadioItem",MB=y.forwardRef((e,t)=>{const a=e,{__scopeDropdownMenu:r}=a,n=me(a,["__scopeDropdownMenu"]),i=Fi(r);return s.jsx(Cfe,W(M(M({},i),n),{ref:t}))});MB.displayName=qfe;var Wfe="DropdownMenuItemIndicator",DB=y.forwardRef((e,t)=>{const a=e,{__scopeDropdownMenu:r}=a,n=me(a,["__scopeDropdownMenu"]),i=Fi(r);return s.jsx(Pfe,W(M(M({},i),n),{ref:t}))});DB.displayName=Wfe;var Hfe="DropdownMenuSeparator",IB=y.forwardRef((e,t)=>{const a=e,{__scopeDropdownMenu:r}=a,n=me(a,["__scopeDropdownMenu"]),i=Fi(r);return s.jsx(Afe,W(M(M({},i),n),{ref:t}))});IB.displayName=Hfe;var Gfe="DropdownMenuArrow",Yfe=y.forwardRef((e,t)=>{const a=e,{__scopeDropdownMenu:r}=a,n=me(a,["__scopeDropdownMenu"]),i=Fi(r);return s.jsx(Tfe,W(M(M({},i),n),{ref:t}))});Yfe.displayName=Gfe;var Kfe="DropdownMenuSubTrigger",$B=y.forwardRef((e,t)=>{const a=e,{__scopeDropdownMenu:r}=a,n=me(a,["__scopeDropdownMenu"]),i=Fi(r);return s.jsx(Ofe,W(M(M({},i),n),{ref:t}))});$B.displayName=Kfe;var Zfe="DropdownMenuSubContent",LB=y.forwardRef((e,t)=>{const a=e,{__scopeDropdownMenu:r}=a,n=me(a,["__scopeDropdownMenu"]),i=Fi(r);return s.jsx(Rfe,W(M(M({},i),n),{ref:t,style:W(M({},e.style),{"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))});LB.displayName=Zfe;var Xfe=SB,Jfe=EB,Qfe=CB,FB=AB,UB=TB,BB=OB,zB=RB,VB=MB,qB=DB,WB=IB,HB=$B,GB=LB;const o4=Xfe,l4=Jfe,ehe=y.forwardRef((a,i)=>{var o=a,{className:e,inset:t,children:r}=o,n=me(o,["className","inset","children"]);return s.jsxs(HB,W(M({ref:i,className:ke("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e)},n),{children:[r,s.jsx(vw,{className:"ml-auto h-4 w-4"})]}))});ehe.displayName=HB.displayName;const the=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(GB,M({ref:r,className:ke("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e)},t))});the.displayName=GB.displayName;const p1=y.forwardRef((i,n)=>{var a=i,{className:e,sideOffset:t=4}=a,r=me(a,["className","sideOffset"]);return s.jsx(Qfe,{children:s.jsx(FB,M({ref:n,sideOffset:t,className:ke("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e)},r))})});p1.displayName=FB.displayName;const jo=y.forwardRef((i,n)=>{var a=i,{className:e,inset:t}=a,r=me(a,["className","inset"]);return s.jsx(BB,M({ref:n,className:ke("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e)},r))});jo.displayName=BB.displayName;const rhe=y.forwardRef((a,i)=>{var o=a,{className:e,children:t,checked:r}=o,n=me(o,["className","children","checked"]);return s.jsxs(zB,W(M({ref:i,className:ke("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r},n),{children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(qB,{children:s.jsx(Gs,{className:"h-4 w-4"})})}),t]}))});rhe.displayName=zB.displayName;const nhe=y.forwardRef((i,n)=>{var a=i,{className:e,children:t}=a,r=me(a,["className","children"]);return s.jsxs(VB,W(M({ref:n,className:ke("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e)},r),{children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(qB,{children:s.jsx(ZD,{className:"h-2 w-2 fill-current"})})}),t]}))});nhe.displayName=VB.displayName;const she=y.forwardRef((i,n)=>{var a=i,{className:e,inset:t}=a,r=me(a,["className","inset"]);return s.jsx(UB,M({ref:n,className:ke("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e)},r))});she.displayName=UB.displayName;const Vy=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(WB,M({ref:r,className:ke("-mx-1 my-1 h-px bg-muted",e)},t))});Vy.displayName=WB.displayName;class fu{static getFriends(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("user_relationships").select("id, user_id, related_user_id, created_at").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`).order("created_at",{ascending:!1});if(n)return console.error("Error fetching friends:",n),[];if(!r||r.length===0)return[];const i=new Set;r.forEach(d=>{const u=d.user_id===t?d.related_user_id:d.user_id;u&&u!==t&&i.add(String(u))});const a=Array.from(i);if(a.length===0)return[];const{data:o,error:l}=yield P.from("users").select("id, name, avatar_url, bio, user_id, created_at").in("user_id",a);if(l)return console.error("Error fetching friend profiles:",l),[];const c=new Map;return r.forEach(d=>{const u=d.user_id===t?String(d.related_user_id):String(d.user_id);if(c.has(u)||u===t)return;const h=o==null?void 0:o.find(f=>String(f.user_id)===u);c.set(u,{id:(h==null?void 0:h.id)||u,user_id:u,name:(h==null?void 0:h.name)||"Unknown User",username:((h==null?void 0:h.name)||"unknown").toLowerCase().replace(/\s+/g,""),avatar_url:(h==null?void 0:h.avatar_url)||null,bio:(h==null?void 0:h.bio)||null,friendship_id:d.id,created_at:d.created_at})}),Array.from(c.values())}catch(r){return console.error("Error getting friends:",r),[]}})}static unfriendUser(t){return E(this,null,function*(){var r,n;try{const{error:i}=yield P.rpc("unfriend_user",{friend_user_id:t});if(i){if((r=i.message)!=null&&r.includes("Friendship does not exist")||i.code==="P0001"){console.log("Friendship already removed or does not exist:",t);return}throw console.error("Error unfriending user:",i),i}}catch(i){if((n=i==null?void 0:i.message)!=null&&n.includes("Friendship does not exist")||(i==null?void 0:i.code)==="P0001"){console.log("Friendship already removed or does not exist:",t);return}throw console.error("Error in unfriendUser:",i),i}})}static cancelFriendRequest(t){return E(this,null,function*(){try{const{error:r}=yield P.rpc("cancel_friend_request",{request_id:t});if(r)throw console.error("Error cancelling friend request:",r),r}catch(r){throw console.error("Error in cancelFriendRequest:",r),r}})}static getPendingRequestId(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("user_relationships").select("id").eq("user_id",t).eq("related_user_id",r).eq("relationship_type","friend").eq("status","pending").single();return i?(i.code==="PGRST116"||console.error("Error getting pending request ID:",i),null):(n==null?void 0:n.id)||null}catch(n){return console.error("Error in getPendingRequestId:",n),null}})}static getRecommendedFriends(t,r=10){return E(this,null,function*(){try{const[n,i]=yield Promise.all([P.rpc("get_second_degree_connections",{target_user_id:t}),P.rpc("get_third_degree_connections",{target_user_id:t})]);n.error&&console.error("Error fetching second degree connections:",n.error),i.error&&console.error("Error fetching third degree connections:",i.error);const a=n.data||[],o=i.data||[],l=[];return a.forEach(d=>{l.push({user_id:d.connected_user_id,name:d.name||"Unknown User",avatar_url:d.avatar_url||null,verified:d.is_public_profile!==!1,connection_depth:2,mutual_friends_count:d.mutual_friends_count||0})}),o.forEach(d=>{l.push({user_id:d.connected_user_id,name:d.name||"Unknown User",avatar_url:d.avatar_url||null,verified:d.is_public_profile!==!1,connection_depth:3,mutual_friends_count:d.mutual_friends_count||0})}),l.sort((d,u)=>d.mutual_friends_count!==u.mutual_friends_count?u.mutual_friends_count-d.mutual_friends_count:d.connection_depth-u.connection_depth),Array.from(new Map(l.map(d=>[d.user_id,d])).values()).slice(0,r)}catch(n){return console.error("Error getting recommended friends:",n),[]}})}}function dA({eventId:e,customMessage:t,onEventClick:r,onInterestToggle:n,onAttendanceToggle:i,currentUserId:a,className:o="",refreshTrigger:l}){const[c,d]=y.useState(null),[u,h]=y.useState(!0),[f,p]=y.useState(!1),[x,g]=y.useState(!1),[v,_]=y.useState(!1),[w,b]=y.useState(!1);y.useEffect(()=>{k()},[e]),y.useEffect(()=>{c&&a&&(N(),S())},[c,a]),y.useEffect(()=>{l&&c&&a&&(N(),S())},[l,c,a]);const N=()=>E(this,null,function*(){if(!(!c||!a))try{console.log(" checkInterest called with:",{eventId:c.id,currentUserId:a});const R=yield Hn.isUserInterested(a,c.id);console.log(" checkInterest result:",{interested:R}),p(R)}catch(R){console.log(" checkInterest error:",R),p(!1)}}),S=()=>E(this,null,function*(){if(!(!c||!a))try{const{data:R,error:F}=yield P.from("reviews").select("was_there").eq("user_id",a).eq("event_id",c.id).maybeSingle();if(F){if(F.code==="PGRST116"||F.code==="406"){_(!1);return}console.error("Error checking attendance:",F),_(!1);return}_(R?!!R.was_there:!1)}catch(R){console.error("Error checking attendance:",R),_(!1)}}),k=()=>E(this,null,function*(){try{h(!0);const{data:R,error:F}=yield P.from("events").select("*").eq("id",e).single();if(F){console.error("Error loading shared event:",F);return}d(R)}catch(R){console.error("Error loading shared event:",R)}finally{h(!1)}}),O=R=>{try{return Dt(Ws(R),"EEE, MMM d, yyyy")}catch(F){return R}},A=R=>{try{return Dt(Ws(R),"h:mm a")}catch(F){return""}},T=c?new Date(c.event_date)<new Date:!1,$=c?new Date(c.event_date)>=new Date:!1;return u?s.jsx(He,{className:`p-4 bg-gradient-to-r from-pink-50 to-purple-50 border-pink-200 animate-pulse ${o}`,children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-pink-200 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-pink-200 rounded w-1/2"}),s.jsx("div",{className:"h-3 bg-pink-200 rounded w-2/3"})]})}):c?s.jsxs(He,{className:`overflow-hidden bg-gradient-to-br from-white via-pink-50/30 to-purple-50/30 border-2 border-pink-200 hover:border-pink-300 transition-all duration-200 hover:shadow-lg cursor-pointer ${o}`,onClick:()=>r==null?void 0:r(c),children:[s.jsxs("div",{className:"bg-gradient-to-r from-pink-500 to-purple-600 p-3 flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:s.jsx(Ct,{className:"w-5 h-5 text-white"})}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-white text-xs font-medium",children:"Shared Event"})}),$&&s.jsx(Be,{className:"bg-green-500 text-white text-xs",children:"Upcoming"}),T&&s.jsx(Be,{variant:"secondary",className:"text-xs",children:"Past Event"})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[t&&s.jsx("div",{className:"bg-white/80 rounded-lg p-3 border border-pink-200",children:s.jsxs("p",{className:"text-sm text-gray-700 italic",children:['"',t,'"']})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-gray-900 leading-tight mb-1",children:c.title}),s.jsx("p",{className:"text-pink-600 font-semibold text-sm",children:c.artist_name})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[s.jsx(Et,{className:"w-4 h-4 text-pink-500"}),s.jsx("span",{className:"font-medium",children:O(c.event_date)}),s.jsx("span",{className:"text-gray-400",children:""}),s.jsx("span",{children:A(c.event_date)})]}),s.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-700",children:[s.jsx(Xt,{className:"w-4 h-4 text-pink-500 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:c.venue_name}),s.jsx("p",{className:"text-xs text-gray-500",children:[c.venue_city,c.venue_state].filter(Boolean).join(", ")})]})]}),c.genres&&c.genres.length>0&&s.jsxs("div",{className:"flex flex-wrap gap-1",children:[c.genres.slice(0,3).map((R,F)=>s.jsx(Be,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:R},F)),c.genres.length>3&&s.jsxs(Be,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:["+",c.genres.length-3]})]}),c.price_range&&s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Price: "}),s.jsx("span",{className:"font-semibold text-gray-900",children:c.price_range})]}),s.jsxs("div",{className:"pt-2 border-t border-pink-100 flex gap-2",children:[$&&a&&n&&s.jsxs(oe,{size:"sm",disabled:x,className:`flex-1 ${f?"bg-green-500 hover:bg-green-600":"bg-pink-500 hover:bg-pink-600"} text-white`,onClick:R=>E(this,null,function*(){R.stopPropagation(),g(!0);try{const F=!f;console.log(" Interest button clicked:",{eventId:c.id,newInterestState:F,currentUserId:a}),yield n(c.id,F),p(F)}catch(F){console.error("Error toggling interest:",F)}finally{g(!1)}}),children:[s.jsx(hs,{className:`w-3 h-3 mr-1 ${f?"fill-current":""}`}),f?"Interested!":"I'm Interested"]}),T&&a&&i&&s.jsxs(oe,{size:"sm",disabled:w,className:`flex-1 ${v?"bg-blue-500 hover:bg-blue-600":"bg-yellow-500 hover:bg-yellow-600"} text-white`,onClick:R=>E(this,null,function*(){R.stopPropagation(),b(!0);try{const F=!v;yield i(c.id,F),_(F)}catch(F){console.error("Error toggling attendance:",F)}finally{b(!1)}}),children:[w?s.jsx("div",{className:"w-3 h-3 mr-1 animate-spin rounded-full border-b-2 border-white"}):s.jsx(Jt,{className:`w-3 h-3 mr-1 ${v?"fill-current":""}`}),w?"Updating...":v?"I Was There!":"I Was There"]}),c.ticket_urls&&c.ticket_urls.length>0&&$&&s.jsx(oe,{size:"sm",variant:"outline",className:"flex-1 border-blue-300 text-blue-700 hover:bg-blue-50",asChild:!0,onClick:R=>R.stopPropagation(),children:s.jsxs("a",{href:c.ticket_urls[0],target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-1",children:[s.jsx(xc,{className:"w-3 h-3"}),"Tickets",s.jsx(aa,{className:"w-3 h-3"})]})})]}),s.jsx(oe,{variant:"ghost",size:"sm",className:"w-full text-pink-600 hover:text-pink-700 hover:bg-pink-50",onClick:()=>r==null?void 0:r(c),children:"View Full Details "})]})]}):s.jsx(He,{className:`p-4 bg-gray-50 border-gray-200 ${o}`,children:s.jsx("p",{className:"text-sm text-gray-500",children:"Event not found"})})}function uA({reviewId:e,customMessage:t,onReviewClick:r,currentUserId:n,className:i="",metadata:a}){const[o,l]=y.useState(null),[c,d]=y.useState(!0),[u,h]=y.useState("User"),[f,p]=y.useState(null);y.useEffect(()=>{x()},[e]);const x=()=>E(this,null,function*(){try{d(!0);const{data:w,error:b}=yield P.from("reviews").select(`
          id,
          user_id,
          event_id,
          rating,
          review_text,
          photos,
          created_at,
          updated_at,
          likes_count,
          comments_count,
          shares_count
        `).eq("id",e).single();if(b){console.error("Error loading review:",b),d(!1);return}if(!w){d(!1);return}let N="User",S=null;if(w.user_id){const{data:$}=yield P.from("users").select("user_id, name, avatar_url").eq("user_id",w.user_id).single();$&&(N=$.name||"User",S=$.avatar_url||null)}let k="",O="",A="";if(w.event_id){const{data:$}=yield P.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date").eq("id",w.event_id).single();$&&(k=$.artist_name_normalized||"",O=$.venue_name_normalized||"",A=$.title||"")}const T={id:w.id,user_id:w.user_id,event_id:w.event_id||"",rating:w.rating||0,review_text:w.review_text||"",is_public:!0,created_at:w.created_at,updated_at:w.updated_at||w.created_at,likes_count:w.likes_count||0,comments_count:w.comments_count||0,shares_count:w.shares_count||0,is_liked_by_user:!1,reaction_emoji:"",photos:Array.isArray(w.photos)?w.photos:[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:k,artist_id:"",venue_name:O,venue_id:""};l(T),h(N),p(S)}catch(w){console.error("Error loading review:",w)}finally{d(!1)}});if(c)return s.jsx(He,{className:`p-4 bg-gradient-to-r from-pink-50 to-purple-50 border-pink-200 animate-pulse ${i}`,children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-pink-200 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-pink-200 rounded w-1/2"}),s.jsx("div",{className:"h-3 bg-pink-200 rounded w-2/3"})]})});if(!o)return s.jsx(He,{className:`p-4 bg-gray-50 border-gray-200 ${i}`,children:s.jsx("p",{className:"text-sm text-gray-500",children:"Review not found"})});const g=o.artist_name&&o.venue_name?`${o.artist_name} at ${o.venue_name}`:o.artist_name||o.venue_name||"Concert Review",v=o.review_text?o.review_text.length>100?o.review_text.substring(0,100)+"...":o.review_text:"No review text",_=o.created_at?Dt(Ws(o.created_at),"MMM d, yyyy"):"";return s.jsxs(He,{className:`overflow-hidden bg-gradient-to-br from-white via-pink-50/30 to-purple-50/30 border-2 border-pink-200 hover:border-pink-300 transition-all duration-200 hover:shadow-lg cursor-pointer ${i}`,onClick:()=>r==null?void 0:r(o),children:[s.jsxs("div",{className:"bg-gradient-to-r from-pink-500 to-purple-600 p-3 flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:s.jsx(Jt,{className:"w-5 h-5 text-white fill-white"})}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-white text-xs font-medium",children:"Shared Review"})})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[t&&s.jsx("div",{className:"bg-white/80 rounded-lg p-3 border border-pink-200",children:s.jsx("p",{className:"text-sm text-gray-700",children:t})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-pink-400 to-purple-500 flex items-center justify-center text-white text-xs font-semibold overflow-hidden",children:f?s.jsx("img",{src:f,alt:u,className:"w-full h-full object-cover"}):s.jsx(li,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:u}),_&&s.jsx("p",{className:"text-xs text-gray-500",children:_})]})]}),s.jsx("div",{children:s.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-1",children:g})}),o.rating>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(w,b)=>{const N=b+1,S=N<=Math.floor(o.rating||0),k=!S&&N-.5<=(o.rating||0);return s.jsxs("div",{className:"relative w-4 h-4",children:[s.jsx(Jt,{className:`w-4 h-4 ${S||k?"text-yellow-400 fill-yellow-400":"text-gray-300"}`}),k&&s.jsx("div",{className:"absolute left-0 top-0 h-full w-1/2 overflow-hidden pointer-events-none",children:s.jsx(Jt,{className:"w-4 h-4 text-yellow-400 fill-yellow-400"})})]},b)})}),s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[o.rating,"/5"]})]}),s.jsx("div",{className:"bg-white/60 rounded-lg p-3 border border-pink-100",children:s.jsx("p",{className:"text-sm text-gray-700 line-clamp-3",children:v})}),(o.artist_name||o.venue_name)&&s.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-gray-600",children:[o.artist_name&&s.jsxs(Be,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:[s.jsx(Ct,{className:"w-3 h-3 mr-1"}),o.artist_name]}),o.venue_name&&s.jsxs(Be,{variant:"secondary",className:"bg-blue-100 text-blue-800 border-blue-200",children:[s.jsx(Xt,{className:"w-3 h-3 mr-1"}),o.venue_name]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 pt-2 border-t border-pink-100",children:[s.jsxs("span",{children:[o.likes_count||0," likes"]}),s.jsxs("span",{children:[o.comments_count||0," comments"]})]})]})]})}const YB=({currentUserId:e,onBack:t})=>{var Ht,Rt,Te,bt,$e,Ie,Ue,dt;const[r,n]=y.useState([]),[i,a]=y.useState(null),[o,l]=y.useState([]),[c,d]=y.useState(""),[u,h]=y.useState([]),[f,p]=y.useState(!1),[x,g]=y.useState(new Map),[v,_]=y.useState(!1),[w,b]=y.useState(""),[N,S]=y.useState([]);y.useState("");const[k,O]=y.useState(!0);y.useState(!1),y.useState("");const{toast:A}=jr(),[T,$]=y.useState(!1),[R,F]=y.useState(null),[D,B]=y.useState(!1),[U,V]=y.useState(0),[Y,z]=y.useState(!1),[K,Z]=y.useState(null),[G,X]=y.useState(!1),[te,se]=y.useState(null),[ue,ye]=y.useState(new Set);y.useState(!1);const[ne,xe]=y.useState([]),[ge,ie]=y.useState(!1),[ee,H]=y.useState(null),[le,Se]=y.useState(!1),ae=y.useRef(null);y.useEffect(()=>{qe(),Fe()},[e]),y.useEffect(()=>{console.log(" users changed:",u),console.log(" users length:",u.length)},[u]),y.useEffect(()=>{console.log(" selectedChat changed:",i),console.log(" selectedChat exists:",!!i),console.log(" selectedChat id:",i==null?void 0:i.id)},[i]),y.useEffect(()=>{i&&(ve(i.id),yt(i.id),Ne(i.id),Ge(i.id))},[i]),y.useEffect(()=>{if(!i)return;const be=P.channel(`chat-messages-${i.id}`).on("postgres_changes",{event:"*",schema:"public",table:"messages",filter:`chat_id=eq.${i.id}`},Re=>{console.log(" Real-time message update:",Re),(Re.eventType==="INSERT"||Re.eventType==="UPDATE"||Re.eventType==="DELETE")&&(ve(i.id),qe())}).subscribe(Re=>{Re==="SUBSCRIBED"?console.log(" Subscribed to messages for chat:",i.id):Re==="CHANNEL_ERROR"&&console.error(" Error subscribing to messages")});return()=>{P.removeChannel(be)}},[i==null?void 0:i.id]),y.useEffect(()=>{if(!e)return;const be=P.channel("chat-list-updates").on("postgres_changes",{event:"*",schema:"public",table:"chats"},Re=>{console.log(" Real-time chat update:",Re);const We=Re.new,St=Re.old,Ye=(We==null?void 0:We.users)||(St==null?void 0:St.users)||[];Array.isArray(Ye)&&Ye.includes(e)&&qe()}).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},Re=>{console.log(" New message in any chat:",Re),qe()}).subscribe(Re=>{Re==="SUBSCRIBED"?console.log(" Subscribed to chat list updates"):Re==="CHANNEL_ERROR"&&console.error(" Error subscribing to chat list")});return()=>{P.removeChannel(be)}},[e]),y.useEffect(()=>{f&&Fe()},[f]);const fe=be=>E(void 0,null,function*(){F(be);try{const Re=yield Hn.isUserInterested(e,be.id);B(Re)}catch(Re){console.error("Error checking interest:",Re),B(!1)}$(!0)}),he=(be,Re)=>E(void 0,null,function*(){try{yield Hn.setEventInterest(e,be,Re),B(Re),V(We=>We+1),A({title:Re?"Added to interested events!":"Removed from interested events",description:Re?"This event will appear in your profile":"Event removed from your interested list"})}catch(We){console.error("Error toggling interest:",We),A({title:"Error",description:"Failed to update interest",variant:"destructive"})}}),pe=be=>E(void 0,null,function*(){let Re="User",We;if(be.user_id)try{const{data:Ye,error:ir}=yield P.from("users").select("user_id, name, avatar_url").eq("user_id",be.user_id).maybeSingle();!ir&&Ye&&(Re=Ye.name||"User",We=Ye.avatar_url||void 0)}catch(Ye){console.error("Error fetching author information:",Ye)}const St={id:be.id,type:"review",review_id:be.id,title:be.artist_name&&be.venue_name?`${be.artist_name} at ${be.venue_name}`:be.artist_name||be.venue_name||"Concert Review",content:be.review_text||"",author:{id:be.user_id,name:Re,avatar_url:We},created_at:be.created_at,rating:be.rating,photos:be.photos||[],likes_count:be.likes_count||0,comments_count:be.comments_count||0,shares_count:be.shares_count||0,is_liked:be.is_liked_by_user||!1,event_info:{artist_name:be.artist_name,venue_name:be.venue_name,artist_id:be.artist_id,venue_id:be.venue_id},relevance_score:0};Z(St),z(!0),X(!0),se(null);try{const{data:Ye,error:ir}=yield P.from("reviews").select(`
            photos,
            videos,
            artist_performance_rating,
            production_rating,
            venue_rating,
            venue_rating,
            location_rating,
            value_rating,
            artist_performance_feedback,
            production_feedback,
            venue_feedback,
            location_feedback,
            value_feedback,
            mood_tags,
            genre_tags,
            context_tags,
            venue_tags,
            artist_tags,
            reaction_emoji,
            review_text
          `).eq("id",be.id).maybeSingle();if(ir){console.error("Error fetching review details:",ir),se(null),X(!1);return}Ye&&se({photos:Array.isArray(Ye.photos)?Ye.photos:[],videos:Array.isArray(Ye.videos)?Ye.videos:[],categoryRatings:{performance:typeof Ye.performance_rating=="number"?Ye.performance_rating:void 0,venue:typeof Ye.venue_rating=="number"?Ye.venue_rating:void 0,overallExperience:typeof Ye.overall_experience_rating=="number"?Ye.overall_experience_rating:void 0},categoryTexts:{performance:Ye.performance_review_text||void 0,venue:Ye.venue_review_text||void 0,overallExperience:Ye.overall_experience_review_text||void 0},moodTags:Array.isArray(Ye.mood_tags)&&Ye.mood_tags.length>0?Ye.mood_tags:void 0,genreTags:Array.isArray(Ye.genre_tags)&&Ye.genre_tags.length>0?Ye.genre_tags:void 0,contextTags:Array.isArray(Ye.context_tags)&&Ye.context_tags.length>0?Ye.context_tags:void 0,venueTags:Array.isArray(Ye.venue_tags)&&Ye.venue_tags.length>0?Ye.venue_tags:void 0,artistTags:Array.isArray(Ye.artist_tags)&&Ye.artist_tags.length>0?Ye.artist_tags:void 0,reactionEmoji:Ye.reaction_emoji||void 0})}catch(Ye){console.error("Error fetching review details:",Ye),se(null)}finally{X(!1)}}),Ae=(be,Re)=>E(void 0,null,function*(){try{yield Hn.markUserAttendance(e,be,Re),A({title:Re?"Marked as attended!":"Removed attendance",description:Re?"This event will appear in your attended events":"Attendance removed"})}catch(We){console.error("Error toggling attendance:",We),A({title:"Error",description:"Failed to update attendance",variant:"destructive"})}}),qe=()=>E(void 0,null,function*(){try{const{data:be,error:Re}=yield AE(e);if(Re){console.error("Error fetching chats:",Re);return}const{data:We}=yield P.from("chat_participants").select("chat_id, last_read_at").eq("user_id",e),St=new Map;We==null||We.forEach(Mt=>{St.set(Mt.chat_id,Mt.last_read_at)});const ir=(yield Promise.all((be||[]).map(Mt=>E(void 0,null,function*(){try{const re=St.get(Mt.id),_e=P.from("messages").select("id").eq("chat_id",Mt.id).neq("sender_id",e).limit(1);re&&_e.gt("created_at",re);const{data:Ke}=yield _e.maybeSingle();return W(M({},Mt),{has_unread:!!Ke,unread_count:0})}catch(re){return console.error("Error checking unread status for chat:",Mt.id,re),W(M({},Mt),{has_unread:!1,unread_count:0})}})))).sort((Mt,re)=>{if(Mt.has_unread&&!re.has_unread)return-1;if(!Mt.has_unread&&re.has_unread)return 1;const _e=Mt.latest_message_created_at?new Date(Mt.latest_message_created_at).getTime():0;return(re.latest_message_created_at?new Date(re.latest_message_created_at).getTime():0)-_e}),jt=ir.filter(Mt=>Mt.is_group_chat).map(Mt=>Mt.id),pt=new Map;if(console.log(" fetchChats: Group chat IDs:",jt),jt.length>0){const{data:Mt,error:re}=yield P.from("chats").select("id, entity_type, entity_uuid").in("id",jt);console.log(" fetchChats: Chat entities:",Mt,"Error:",re);const _e=(Mt==null?void 0:Mt.filter(Ke=>Ke.entity_type==="event"&&Ke.entity_uuid))||[];if(console.log(" fetchChats: Event chats:",_e),_e.length>0){const Ke=_e.map(et=>et.entity_uuid).filter(Boolean);console.log(" fetchChats: Event IDs:",Ke);const{data:ht,error:ct}=yield P.from("events").select("id, artist_id").in("id",Ke);console.log(" fetchChats: Events with artist_id:",ht,"Error:",ct);const Pe=[...new Set(ht==null?void 0:ht.map(et=>et.artist_id).filter(Boolean))];if(console.log(" fetchChats: Artist UUIDs:",Pe),Pe.length>0){const{data:et,error:nt}=yield P.from("artists").select("id, image_url").in("id",Pe);if(console.log(" fetchChats: Artists fetched by UUID:",et,"Error:",nt),et&&et.length>0){const Me=new Map;et.forEach(gt=>{gt.image_url&&gt.id&&(Me.set(gt.id,gt.image_url),console.log(` Mapped artist UUID: ${gt.id} -> image_url: ${gt.image_url}`))}),console.log(" fetchChats: Artist image map:",Array.from(Me.entries())),ht==null||ht.forEach(gt=>{const cr=_e.find(Wr=>Wr.entity_uuid===gt.id);if(cr&&gt.artist_id){const Wr=Me.get(gt.artist_id);console.log(` fetchChats: Mapping chat ${cr.id} to artist image:`,{eventId:gt.id,artist_id:gt.artist_id,imageUrl:Wr}),Wr&&pt.set(cr.id,{entity_type:cr.entity_type,entity_uuid:cr.entity_uuid,event_image_url:Wr})}}),console.log(" fetchChats: Final entityDataMap:",Array.from(pt.entries()))}else console.log(" fetchChats: No artists found for UUIDs:",Pe)}}}const vn=ir.map(Mt=>{var Ke,ht,ct,Pe,et,nt,Me,gt,cr,Wr,bn,xn,fn;const re=Mt,_e=pt.get(Mt.id);return W(M({},Mt),{latest_message_id:(Ke=Mt.latest_message_id)!=null?Ke:null,latest_message:(ht=Mt.latest_message)!=null?ht:null,latest_message_created_at:(ct=Mt.latest_message_created_at)!=null?ct:null,latest_message_sender_name:(Pe=Mt.latest_message_sender_name)!=null?Pe:null,group_admin_id:(et=Mt.group_admin_id)!=null?et:null,member_count:(nt=re.member_count)!=null?nt:null,entity_type:(gt=(Me=_e==null?void 0:_e.entity_type)!=null?Me:re.entity_type)!=null?gt:null,entity_uuid:(Wr=(cr=_e==null?void 0:_e.entity_uuid)!=null?cr:re.entity_uuid)!=null?Wr:null,event_image_url:(bn=_e==null?void 0:_e.event_image_url)!=null?bn:null,created_at:(xn=Mt.created_at)!=null?xn:new Date().toISOString(),updated_at:(fn=Mt.updated_at)!=null?fn:new Date().toISOString()})});n(vn);const Jn=ir.filter(Mt=>!Mt.is_group_chat).map(Mt=>Mt.id);if(Jn.length>0){const{data:Mt,error:re}=yield P.from("chat_participants").select("chat_id, user_id").in("chat_id",Jn).neq("user_id",e);re&&console.error("Error fetching chat participants for direct chats:",re);const _e=new Map,Ke=new Set;if(Mt==null||Mt.forEach(ht=>{_e.set(ht.chat_id,ht.user_id),Ke.add(ht.user_id)}),g(_e),Ke.size>0){const ht=Array.from(Ke).filter(ct=>!u.some(Pe=>Pe.user_id===ct));if(ht.length>0){const{data:ct}=yield P.from("users").select("user_id, name, avatar_url, bio").in("user_id",ht);ct&&ct.length>0&&h(Pe=>{const et=new Set(Pe.map(Me=>Me.user_id)),nt=ct.filter(Me=>!et.has(Me.user_id));return[...Pe,...nt]})}}}const Fs=new Set;for(const Mt of ir)Mt.is_group_chat&&(yield qt(Mt.id))&&Fs.add(Mt.id);ye(Fs)}catch(be){console.error("Error fetching chats:",be)}finally{setTimeout(()=>{O(!1)},800)}}),Fe=()=>E(void 0,null,function*(){try{console.log(" Current user ID:",e),console.log(" User ID type:",typeof e);const be=yield fu.getFriends(e);console.log(" Friends fetched successfully:",be),console.log(" Number of friends:",be.length),h(be)}catch(be){console.error("Error fetching friends:",be),h([])}}),ve=be=>E(void 0,null,function*(){try{const{data:Re,error:We}=yield P.from("messages").select(`
          id,
          chat_id,
          sender_id,
          content,
          created_at,
          message_type,
          shared_event_id,
          shared_review_id,
          metadata
        `).eq("chat_id",be).order("created_at",{ascending:!0});if(We){console.error("Error fetching messages:",We);return}const St=[...new Set((Re||[]).map(jt=>jt.sender_id))],{data:Ye}=yield P.from("users").select("user_id, name, avatar_url").in("user_id",St),ir=(Re||[]).map(jt=>{const pt=Ye==null?void 0:Ye.find(vn=>vn.user_id===jt.sender_id);return{id:jt.id,chat_id:jt.chat_id,sender_id:jt.sender_id,content:jt.content,created_at:jt.created_at,sender_name:(pt==null?void 0:pt.name)||"Unknown",sender_avatar:(pt==null?void 0:pt.avatar_url)||null,message_type:jt.message_type||"text",shared_event_id:jt.shared_event_id,shared_review_id:jt.shared_review_id,metadata:jt.metadata}});l(ir.map(jt=>W(M({},jt),{message_type:jt.message_type==="text"||jt.message_type==="event_share"||jt.message_type==="review_share"||jt.message_type==="system"?jt.message_type:"text"}))),setTimeout(()=>{var jt;(jt=ae.current)==null||jt.scrollIntoView({behavior:"smooth"})},100)}catch(Re){console.error("Error fetching messages:",Re)}});y.useEffect(()=>{o.length>0&&setTimeout(()=>{var be;(be=ae.current)==null||be.scrollIntoView({behavior:"smooth"})},100)},[o.length]);const rt=()=>E(void 0,null,function*(){if(!c.trim()||!i)return;const be=c.trim();d("");try{const{data:Re,error:We}=yield P.from("messages").insert({chat_id:i.id,sender_id:e,content:be}).select().single();if(We){console.error("Error sending message:",We),d(be),A({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"});return}ve(i.id),A({title:"Message Sent! ",description:"Your message has been delivered"})}catch(Re){console.error("Error sending message:",Re),A({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"})}}),Ve=be=>E(void 0,null,function*(){try{if(console.log("Creating direct chat between:",e,"and",be),!u.some(Ye=>Ye.user_id===be)){A({title:"Not Friends Yet",description:"You can only chat with people who have accepted your friend request.",variant:"destructive"});return}const{data:We,error:St}=yield P.rpc("create_direct_chat",{user1_id:e,user2_id:be});if(St){console.error("Error creating direct chat:",St),A({title:"Error",description:"Failed to create chat. Please try again.",variant:"destructive"});return}qe(),p(!1),A({title:"Chat Created! ",description:"You can now start chatting!"})}catch(Re){console.error("Error creating direct chat:",Re),A({title:"Error",description:"Failed to create chat. Please try again.",variant:"destructive"})}}),lt=be=>E(void 0,null,function*(){try{const{error:Re}=yield P.from("chats").delete().eq("id",be);if(Re){console.error("Error deleting chat:",Re),A({title:"Error",description:"Failed to delete chat. Please try again.",variant:"destructive"});return}n(We=>We.filter(St=>St.id!==be)),(i==null?void 0:i.id)===be&&(a(null),l([])),A({title:"Chat Deleted",description:"Chat has been removed."})}catch(Re){console.error("Error deleting chat:",Re),A({title:"Error",description:"Failed to delete chat. Please try again.",variant:"destructive"})}}),ut=u.filter(be=>be.name.toLowerCase().includes(w.toLowerCase())),Ze=be=>{if(be.is_group_chat)return be.chat_name.replace(/\s+Group\s+Chat\s*$/,"");const Re=x.get(be.id);if(!Re)return be.chat_name||"Unknown User";const We=u.find(St=>St.user_id===Re);return(We==null?void 0:We.name)||"Unknown User"},qt=be=>E(void 0,null,function*(){return!1}),lr=be=>{if(be.is_group_chat){const St=be.event_image_url;return console.log(" getChatAvatar for group chat:",{chatId:be.id,chatName:be.chat_name,event_image_url:St,entity_type:be.entity_type,entity_uuid:be.entity_uuid}),St||null}const Re=x.get(be.id);if(!Re)return null;const We=u.find(St=>St.user_id===Re);return(We==null?void 0:We.avatar_url)||null},Ge=be=>E(void 0,null,function*(){try{const{error:Re}=yield P.rpc("mark_chat_as_read",{p_chat_id:be});Re&&console.error("Error updating last_read_at:",Re),n(We=>We.map(St=>St.id===be?W(M({},St),{has_unread:!1,unread_count:0}):St))}catch(Re){console.error("Error marking chat as read:",Re)}}),Le=be=>{if(!be)return"";const Re=Ws(be),We=new Date,St=new Date(We.getFullYear(),We.getMonth(),We.getDate()),Ye=new Date(St);Ye.setDate(Ye.getDate()-1);const ir=new Date(Re.getFullYear(),Re.getMonth(),Re.getDate());return ir.getTime()===St.getTime()?Dt(Re,"h:mm a"):ir.getTime()===Ye.getTime()?`Yesterday ${Dt(Re,"h:mm a")}`:Math.floor((St.getTime()-ir.getTime())/864e5)<7?`${Dt(Re,"EEEE")} ${Dt(Re,"h:mm a")}`:Dt(Re,"MMM d, h:mm a")},yt=be=>E(void 0,null,function*(){try{const{data:Re,error:We}=yield P.from("chat_participants").select(`
          id,
          user_id,
          joined_at,
          last_read_at,
          is_admin,
          notifications_enabled,
          users!user_id(
            user_id,
            name,
            avatar_url,
            bio,
            account_type
          )
        `).eq("chat_id",be).order("joined_at",{ascending:!0});if(We){console.error("Error fetching chat participants:",We);return}if(!Re||Re.length===0){xe([]);return}const St=Re.map(jt=>jt.user_id).filter(Boolean),Ye=new Map;if(St.length>0){const{data:jt}=yield P.from("user_verifications").select("user_id, verified").in("user_id",St);jt&&jt.forEach(pt=>{Ye.set(pt.user_id,pt.verified||!1)})}const ir=Re.map(jt=>{const pt=jt.users;if(!pt)return null;const vn=Ye.get(jt.user_id)||!1;return{id:jt.id,user_id:jt.user_id,name:pt.name||"Unknown User",avatar_url:pt.avatar_url||null,bio:pt.bio||null,verified:vn,account_type:pt.account_type||null,joined_at:jt.joined_at,last_read_at:jt.last_read_at,is_admin:jt.is_admin||!1,notifications_enabled:jt.notifications_enabled!==!1}}).filter(Boolean);xe(ir)}catch(Re){console.error("Error fetching chat participants:",Re)}}),Ne=be=>E(void 0,null,function*(){var Re;try{const{data:We,error:St}=yield P.from("messages").select("shared_event_id, metadata").eq("chat_id",be).eq("message_type","event_share").order("created_at",{ascending:!1}).limit(1).maybeSingle(),Ye=(We==null?void 0:We.shared_event_id)||((Re=We==null?void 0:We.metadata)==null?void 0:Re.event_id);if(!St&&Ye){const{data:ir,error:jt}=yield P.from("events_with_artist_venue").select("id, title, event_date, images, artist_name_normalized, venue_name_normalized").eq("id",Ye).maybeSingle();if(!jt&&ir){H(W(M({},ir),{artist_name:ir.artist_name_normalized,venue_name:ir.venue_name_normalized}));return}}}catch(We){}}),Oe=()=>{!i||!i.is_group_chat||(yt(i.id),Se(!0))},ce=be=>{A({title:"View Profile",description:"Profile view functionality will be implemented soon"})},Ee=be=>{A({title:"Block User",description:"Block user functionality will be implemented soon"})},Qe=()=>{ie(!ge),A({title:ge?"Notifications Unmuted":"Notifications Muted",description:ge?"You will receive notifications for this chat":"You will not receive notifications for this chat"})},vt=()=>{ee&&(F(ee),$(!0))},wt=()=>E(void 0,null,function*(){if(!(!i||!window.confirm(`Are you sure you want to delete this ${i.is_group_chat?"group":"chat"}? This action cannot be undone.`)))try{const{error:Re}=yield P.from("chats").delete().eq("id",i.id);if(Re){console.error("Error deleting chat:",Re),A({title:"Error",description:"Failed to delete chat",variant:"destructive"});return}a(null),qe(),A({title:"Chat Deleted",description:"The chat has been removed"})}catch(Re){console.error("Error deleting chat:",Re),A({title:"Error",description:"Failed to delete chat",variant:"destructive"})}});return k?s.jsx(GE,{text:"Loading messages..."}):s.jsxs("div",{className:"flex min-h-screen bg-[#fcfcfc] w-full max-w-[393px] mx-auto",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},children:[!i&&s.jsxs("div",{className:"w-full border-synth-black/10 bg-white/98 backdrop-blur-md flex flex-col shadow-2xl",children:[s.jsxs("div",{className:"p-5 border-b border-synth-black/10 bg-[#fcfcfc] shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)]",children:[s.jsx("div",{className:"mb-5",children:s.jsx("h1",{className:"text-[36px] font-bold text-[#0e0e0e] leading-[normal]",children:"Messages"})}),s.jsxs(oe,{className:"w-full bg-[#cc2486] hover:bg-[#b01f75] text-white font-normal shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)] hover:shadow-lg transition-all duration-300 rounded-[10px] py-2 px-[15px] h-[36px] border-2 border-[#cc2486] flex items-center justify-center gap-[10px]",onClick:be=>{be.preventDefault(),console.log(" Button clicked! Opening user search"),p(!0)},children:[s.jsx("span",{className:"text-[16px]",children:"New Chat"}),s.jsx(eo,{className:"w-6 h-6"})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:r.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center gap-[60px] p-8 min-h-full",children:[s.jsxs("div",{className:"flex flex-col gap-[6px] items-center justify-center",children:[s.jsx(Wn,{className:"w-[60px] h-[60px] text-[#5d646f] stroke-2"}),s.jsx("h2",{className:"font-medium text-[20px] leading-[normal] text-[#0e0e0e] text-center",children:"No Conversations Yet"}),s.jsx("p",{className:"font-normal text-[16px] leading-[normal] text-[#5d646f] text-center",children:"Start chatting with your friends!"})]}),s.jsx("div",{className:"bg-[#fdf2f7] border-[3px] border-[#b00056] rounded-[12px] p-3 w-[353px] min-h-[110px] flex items-center justify-center",children:s.jsxs("ul",{className:"list-disc text-[16px] font-normal leading-[normal] text-[#0e0e0e] space-y-0 ml-6",children:[s.jsx("li",{className:"mb-0",children:s.jsx("span",{children:"Send friend requests first"})}),s.jsx("li",{className:"mb-0",children:s.jsx("span",{children:"Wait for them to accept"})}),s.jsx("li",{children:s.jsx("span",{children:"Then start chatting!"})})]})})]}):s.jsx("div",{className:"p-3 space-y-2",children:r.map(be=>s.jsx(He,{className:`cursor-pointer transition-all duration-300 rounded-2xl border-2 ${(i==null?void 0:i.id)===be.id?"bg-gradient-to-br from-synth-pink/15 to-synth-pink/5 border-synth-pink/40 shadow-xl shadow-synth-pink/10 transform scale-[1.02]":"hover:bg-gradient-to-br hover:from-synth-beige/40 hover:to-synth-beige-light/20 hover:border-synth-black/20 hover:shadow-lg border-synth-black/10 bg-white/60 backdrop-blur-sm"}`,children:s.jsx(st,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[be.has_unread?s.jsx("div",{className:"w-3 h-3 bg-gradient-to-br from-synth-pink to-synth-pink-light rounded-full flex-shrink-0 shadow-lg shadow-synth-pink/30 animate-pulse"}):s.jsx("div",{className:"w-3 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 flex items-center gap-4 cursor-pointer min-w-0",onClick:()=>a(be),children:[s.jsxs(Vr,{className:`w-12 h-12 flex-shrink-0 ring-2 transition-all duration-300 ${(i==null?void 0:i.id)===be.id?"ring-synth-pink/30 shadow-lg":"ring-synth-black/5 hover:ring-synth-pink/20"}`,children:[s.jsx(Qr,{src:lr(be)||void 0}),s.jsx(qr,{className:`${(i==null?void 0:i.id)===be.id?"bg-gradient-to-br from-synth-pink/20 to-synth-pink-light/10 text-synth-black font-semibold":"bg-synth-beige/50 text-synth-black font-medium"}`,children:be.is_group_chat?s.jsx(Ar,{className:"w-6 h-6"}):Ze(be).split(" ").map(Re=>Re[0]).join("")})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[s.jsx("h3",{className:`font-semibold break-words transition-colors ${(i==null?void 0:i.id)===be.id?"text-synth-black":"text-gray-900"}`,children:Ze(be)}),be.latest_message_created_at&&s.jsx("span",{className:`text-xs flex-shrink-0 font-medium whitespace-nowrap ${(i==null?void 0:i.id)===be.id?"text-synth-black/60":"text-gray-500"}`,children:Le(be.latest_message_created_at)})]}),s.jsx("p",{className:`text-sm break-words mb-1 ${(i==null?void 0:i.id)===be.id?"text-synth-black/70":"text-gray-600"}`,children:be.latest_message?s.jsxs("span",{children:[s.jsxs("span",{className:"font-medium",children:[be.latest_message_sender_name,":"]})," ",be.latest_message]}):s.jsx("span",{className:"text-gray-400 italic",children:"No messages yet"})}),be.is_group_chat&&be.is_verified&&s.jsx("div",{className:"flex items-center gap-2 mt-2",children:s.jsxs(Be,{variant:"default",className:"text-xs bg-gradient-to-r from-green-100 to-emerald-50 text-green-800 border-green-300/50 shadow-sm font-medium",children:[s.jsx(Ql,{className:"w-3 h-3 mr-1"}),"Verified ",be.entity_type?be.entity_type.charAt(0).toUpperCase()+be.entity_type.slice(1):"Chat"]})})]})]}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:Re=>{Re.stopPropagation(),lt(be.id)},className:"text-gray-400 hover:text-red-500 hover:bg-red-50 p-2 flex-shrink-0 rounded-lg transition-all duration-200",children:s.jsx(yc,{className:"w-4 h-4"})})]})})},be.id))})})]}),i&&s.jsx("div",{className:"w-full flex flex-col bg-white min-h-0",children:s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"h-[44px] bg-[#fcfcfc] shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)] flex items-center justify-between px-5",children:[s.jsxs("div",{className:"flex items-center gap-[6px]",children:[s.jsx("button",{onClick:()=>a(null),className:"w-6 h-6 flex items-center justify-center cursor-pointer",children:s.jsx(us,{className:"w-6 h-6 text-[#0e0e0e]"})}),s.jsxs(Vr,{className:"w-8 h-8 flex-shrink-0",children:[s.jsx(Qr,{src:lr(i)||void 0}),s.jsx(qr,{className:"bg-synth-beige/50 text-synth-black font-medium text-base",children:i.is_group_chat?s.jsx(Ar,{className:"w-5 h-5"}):Ze(i).split(" ").map(be=>be[0]).join("")})]}),s.jsx("h2",{className:"font-bold text-[24px] text-[#0e0e0e] leading-[normal]",children:Ze(i)})]}),s.jsxs(o4,{children:[s.jsx(l4,{asChild:!0,children:s.jsx(oe,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:s.jsx(MJ,{className:"h-6 w-6 text-[#0e0e0e]"})})}),s.jsxs(p1,{align:"end",className:"w-56",children:[i.is_group_chat&&s.jsxs(s.Fragment,{children:[s.jsxs(jo,{onClick:Oe,children:[s.jsx(Ar,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"View Users"})]}),s.jsx(Vy,{})]}),s.jsxs(jo,{onClick:()=>ce(i.users.find(be=>be!==e)||""),children:[s.jsx(li,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"View Profile"})]}),s.jsxs(jo,{onClick:()=>Ee(i.users.find(be=>be!==e)||""),children:[s.jsx(w3,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Block User"})]}),s.jsxs(jo,{onClick:Qe,children:[ge?s.jsx(Uu,{className:"mr-2 h-4 w-4"}):s.jsx(EJ,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:ge?"Unmute Notifications":"Mute Notifications"})]}),ee&&s.jsxs(s.Fragment,{children:[s.jsx(Vy,{}),s.jsxs(jo,{onClick:vt,children:[s.jsx(Et,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"View Event"})]})]}),s.jsx(Vy,{}),s.jsxs(jo,{onClick:wt,className:"text-red-600 focus:text-red-600",children:[s.jsx(yc,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Delete Chat"})]})]})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto bg-white px-5 py-6",children:i.is_group_chat?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(Wn,{className:"w-12 h-12 mx-auto text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Group chats are still in development"})]})}):o.length===0?s.jsxs("div",{className:"flex flex-col gap-[6px] items-center justify-center h-full",children:[s.jsx(Wn,{className:"w-[60px] h-[60px] text-[#cc2486] stroke-2"}),s.jsx("p",{className:"font-medium text-[20px] text-[#0e0e0e] leading-[normal]",children:"No Messages Yet"}),s.jsx("p",{className:"font-normal text-[16px] text-[#5d646f] leading-[normal]",children:"Start the conversation!"})]}):s.jsxs("div",{className:"flex flex-col gap-[24px]",children:[(()=>{const be=[];let Re=[];return o.forEach((We,St)=>{const Ye=St>0?o[St-1]:null;Ye&&Ye.sender_id===We.sender_id&&Ye.message_type===We.message_type&&(We.message_type==="text"||We.message_type==="event_share"||We.message_type==="review_share")?Re.push(We):(Re.length>0&&be.push(Re),Re=[We])}),Re.length>0&&be.push(Re),be.map((We,St)=>{var _e,Ke,ht,ct,Pe,et;const Ye=We[0];We[We.length-1];const ir=St>0?be[St-1]:null,jt=ir?ir[ir.length-1]:null,pt=(i==null?void 0:i.is_group_chat)&&Ye.sender_id!==e&&(jt===null||jt.sender_id!==Ye.sender_id||jt.message_type!=="text"&&jt.message_type!=="review_share"&&jt.message_type!=="event_share"),vn=Ws(Ye.created_at),Jn=jt?Ws(jt.created_at):null,Fs=!Jn||Dt(vn,"yyyy-MM-dd")!==Dt(Jn,"yyyy-MM-dd"),Mt=Dt(vn,"yyyy-MM-dd")===Dt(new Date,"yyyy-MM-dd"),re=Ye.sender_id===e;return s.jsxs("div",{className:`flex flex-col ${re?"items-end":"items-start"}`,children:[Fs&&St===0&&s.jsx("div",{className:"flex justify-center w-full mb-6",children:s.jsx("p",{className:"font-normal text-[16px] text-[#0e0e0e] leading-[normal]",children:Mt?`Today ${Dt(vn,"h:mm a")}`:Dt(vn,"MMMM d, yyyy")})}),pt&&s.jsxs("div",{className:"flex items-center gap-[6px] mb-[12px]",children:[s.jsxs(Vr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(Qr,{src:Ye.sender_avatar||void 0}),s.jsx(qr,{className:"bg-synth-beige/50 text-synth-black font-medium text-sm",children:Ye.sender_name.split(" ").map(nt=>nt[0]).join("")})]}),s.jsx("p",{className:"font-normal text-[16px] text-[#0e0e0e] leading-[normal]",children:Ye.sender_name})]}),We.length===1?s.jsx("div",{className:"flex flex-col gap-[6px]",children:Ye.message_type==="review_share"&&(Ye.shared_review_id||(_e=Ye.metadata)!=null&&_e.review_id)?s.jsxs(s.Fragment,{children:[s.jsx(uA,{reviewId:Ye.shared_review_id||((Ke=Ye.metadata)==null?void 0:Ke.review_id),customMessage:(ht=Ye.metadata)==null?void 0:ht.custom_message,onReviewClick:pe,currentUserId:e,metadata:Ye.metadata}),s.jsx("p",{className:"text-[16px] text-[#5d646f] font-normal leading-[normal]",children:Dt(Ws(Ye.created_at),"h:mm a")})]}):Ye.message_type==="event_share"&&(Ye.shared_event_id||(ct=Ye.metadata)!=null&&ct.event_id)?s.jsxs(s.Fragment,{children:[s.jsx(dA,{eventId:Ye.shared_event_id||((Pe=Ye.metadata)==null?void 0:Pe.event_id),customMessage:(et=Ye.metadata)==null?void 0:et.custom_message,onEventClick:fe,onInterestToggle:he,onAttendanceToggle:Ae,currentUserId:e,refreshTrigger:U}),s.jsx("p",{className:"text-[16px] text-[#5d646f] font-normal leading-[normal]",children:Dt(Ws(Ye.created_at),"h:mm a")})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`max-w-[172px] p-[12px] rounded-[10px] border border-[#c9c9c9] ${Ye.sender_id===e?"bg-[#cc2486] text-[#fcfcfc]":"bg-[rgba(201,201,201,0.5)] text-[#0e0e0e]"}`,children:s.jsx("p",{className:"font-normal text-[16px] leading-[normal] break-words whitespace-pre-wrap w-[150px]",children:Ye.content})}),s.jsx("p",{className:"text-[16px] text-[#5d646f] font-normal leading-[normal]",children:Dt(Ws(Ye.created_at),"h:mm a")})]})}):s.jsx("div",{className:"flex flex-col gap-[6px]",children:We.map((nt,Me)=>{var cr,Wr,bn,xn,fn,Bn;const gt=Me===We.length-1;return s.jsxs("div",{className:"flex flex-col gap-[6px]",children:[nt.message_type==="review_share"&&(nt.shared_review_id||(cr=nt.metadata)!=null&&cr.review_id)?s.jsx(uA,{reviewId:nt.shared_review_id||((Wr=nt.metadata)==null?void 0:Wr.review_id),customMessage:(bn=nt.metadata)==null?void 0:bn.custom_message,onReviewClick:pe,currentUserId:e,metadata:nt.metadata}):nt.message_type==="event_share"&&(nt.shared_event_id||(xn=nt.metadata)!=null&&xn.event_id)?s.jsx(dA,{eventId:nt.shared_event_id||((fn=nt.metadata)==null?void 0:fn.event_id),customMessage:(Bn=nt.metadata)==null?void 0:Bn.custom_message,onEventClick:fe,onInterestToggle:he,onAttendanceToggle:Ae,currentUserId:e,refreshTrigger:U}):s.jsx("div",{className:`max-w-[172px] p-[12px] rounded-[10px] border border-[#c9c9c9] ${nt.sender_id===e?"bg-[#cc2486] text-[#fcfcfc]":"bg-[rgba(201,201,201,0.5)] text-[#0e0e0e]"}`,children:s.jsx("p",{className:"font-normal text-[16px] leading-[normal] break-words whitespace-pre-wrap w-[150px]",children:nt.content})}),gt&&s.jsx("p",{className:"text-[16px] text-[#5d646f] font-normal leading-[normal]",children:Dt(Ws(nt.created_at),"h:mm a")})]},nt.id)})})]},`group-${St}`)})})(),s.jsx("div",{ref:ae})]})}),!i.is_group_chat&&s.jsx("div",{className:"px-5 pb-5 bg-white",children:s.jsxs("div",{className:"bg-[#fcfcfc] border-2 border-[#c9c9c9] rounded-[10px] flex items-center justify-between h-[44px] pl-5 pr-[1px]",children:[s.jsx(or,{value:c,onChange:be=>d(be.target.value),placeholder:"Type a message...",onKeyPress:be=>be.key==="Enter"&&rt(),className:"bg-transparent border-0 flex-1 h-full text-[16px] text-[#5d646f] placeholder:text-[#5d646f] focus-visible:ring-0 focus-visible:ring-offset-0 px-0"}),s.jsx(oe,{onClick:rt,disabled:!c.trim(),className:"bg-[#cc2486] hover:bg-[#b01f75] text-white h-[44px] w-[44px] p-0 rounded-br-[10px] rounded-tr-[10px] rounded-bl-0 rounded-tl-0 disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0",children:s.jsx(cf,{className:"w-[22px] h-[22px] text-[#fcfcfc]"})})]})})]})}),f&&s.jsx("div",{className:"fixed inset-0 bg-[rgba(14,14,14,0.5)] flex items-center justify-center z-[9999]",children:s.jsxs("div",{className:"bg-[#fcfcfc] border border-[#5d646f] rounded-[10px] shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)] w-[353px] h-[452px] flex flex-col p-3 relative",children:[s.jsx("button",{onClick:()=>{p(!1),S([]),b("")},className:"absolute top-3 right-3 w-6 h-6 flex items-center justify-center cursor-pointer hover:bg-gray-100 rounded transition-colors",children:s.jsx(pr,{className:"w-5 h-5 text-[#0e0e0e]"})}),s.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[s.jsx("h2",{className:"font-bold text-[20px] text-[#0e0e0e] leading-[normal]",children:"Select Users to Chat With"}),s.jsxs("div",{className:"relative",children:[s.jsx(or,{placeholder:"Search users...",value:w,onChange:be=>b(be.target.value),className:"bg-[#fcfcfc] border-2 border-[#5d646f] rounded-[10px] h-[45px] pl-[9px] pr-[40px] text-[16px] text-[#5d646f] placeholder:text-[#5d646f] focus:border-[#5d646f] focus:ring-0"}),s.jsx(Mi,{className:"absolute right-[9px] top-1/2 -translate-y-1/2 w-6 h-6 text-[#5d646f]"})]}),s.jsx("div",{className:"flex flex-col gap-3 h-[235px] overflow-y-auto overflow-x-hidden",children:ut.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ar,{className:"w-12 h-12 mx-auto mb-2 text-[#5d646f]"}),s.jsx("p",{className:"text-[#0e0e0e] font-medium mb-1",children:"No friends to chat with yet"}),s.jsx("p",{className:"text-sm text-[#5d646f]",children:"You need to be friends with someone before you can chat with them."})]}):ut.map(be=>{const Re=N.some(We=>We.user_id===be.user_id);return s.jsxs("div",{className:`bg-[#fcfcfc] border border-[#cc2486] rounded-[10px] shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)] h-[60px] cursor-pointer flex items-center px-[7px] gap-[45px] transition-all ${Re?"bg-synth-pink/5":"hover:bg-gray-50"}`,onClick:()=>{Ve(be.user_id),p(!1),S([]),b("")},children:[s.jsxs("div",{className:"flex items-center gap-[6px] flex-1 min-w-0",children:[s.jsxs(Vr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(Qr,{src:be.avatar_url||void 0}),s.jsx(qr,{className:"bg-synth-beige/50 text-synth-black font-medium text-sm",children:be.name.split(" ").map(We=>We[0]).join("")})]}),s.jsxs("div",{className:"flex flex-col gap-[6px] justify-center min-w-0 flex-1",children:[s.jsx("p",{className:"font-bold text-[20px] text-[#0e0e0e] leading-[normal] truncate",children:be.name}),be.bio&&s.jsx("p",{className:"font-normal text-[16px] text-[#5d646f] leading-[normal] truncate",children:be.bio})]})]}),s.jsx(vw,{className:"w-6 h-6 text-[#0e0e0e] flex-shrink-0"})]},be.user_id)})})]})]})}),v&&s.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[9999]",children:s.jsxs("div",{className:"bg-white rounded-3xl p-8 w-full max-w-lg mx-4 shadow-2xl border-2 border-synth-black/10",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-synth-black",children:"Create Group Chat"}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>_(!1),className:"rounded-xl hover:bg-synth-black/5 h-9 w-9 p-0",children:s.jsx(pr,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex items-center justify-center py-16",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(Wn,{className:"w-12 h-12 mx-auto text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Group chats are still in development"})]})}),s.jsx(oe,{onClick:()=>_(!1),className:"w-full bg-gradient-to-r from-synth-pink to-synth-pink-light hover:from-synth-pink-dark hover:to-synth-pink text-white shadow-lg hover:shadow-xl rounded-xl py-6 font-semibold text-base transition-all duration-300",children:"Close"})]})}),Y&&K&&s.jsx(tn,{open:Y,onOpenChange:be=>{z(be),be||(Z(null),se(null),X(!1))},children:s.jsxs(Xr,{className:"max-w-6xl w-[95vw] h-[95vh] max-h-[95vh] p-0 overflow-hidden flex flex-col",hideCloseButton:!0,children:[s.jsx(an,{className:"sr-only",children:"Review Details"}),s.jsx(Kn,{className:"sr-only",children:"Review details"}),s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Vr,{className:"w-10 h-10",children:[s.jsx(Qr,{src:((Ht=K.author)==null?void 0:Ht.avatar_url)||void 0}),s.jsx(qr,{className:"bg-gradient-to-br from-pink-500 to-purple-600 text-white",children:((Te=(Rt=K.author)==null?void 0:Rt.name)==null?void 0:Te.charAt(0))||"U"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("span",{className:"font-semibold",children:((bt=K.author)==null?void 0:bt.name)||"User"})}),s.jsx("div",{className:"text-xs text-gray-500",children:new Date(K.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]}),s.jsx(oe,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>z(!1),children:s.jsx(pr,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s.jsxs("div",{className:"flex-1 bg-black flex items-center justify-center min-h-0 relative",children:[te!=null&&te.photos&&te.photos.length>0||K.photos&&K.photos.length>0?s.jsx("img",{src:(te==null?void 0:te.photos[0])||(($e=K.photos)==null?void 0:$e[0]),alt:"Review photo",className:"max-w-full max-h-full object-contain"}):s.jsxs("div",{className:"text-center text-white",children:[s.jsxs("div",{className:"text-6xl font-bold mb-4",children:[s.jsx("span",{className:"text-pink-500",children:"S"}),"ynth"]}),s.jsx("div",{className:"w-32 h-0.5 bg-white mx-auto mb-4"}),s.jsx("div",{className:"text-sm opacity-80",children:"Concert Review"})]}),(te==null?void 0:te.reactionEmoji)&&s.jsx("div",{className:"absolute top-4 right-4 text-4xl bg-white/20 backdrop-blur-sm rounded-full w-16 h-16 flex items-center justify-center",children:te.reactionEmoji})]}),s.jsx("div",{className:"flex-1 flex flex-col bg-white overflow-y-auto",children:G?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsxs("div",{className:"text-center",children:[s.jsx(er,{className:"h-8 w-8 animate-spin text-indigo-500 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Loading review details..."})]})}):s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:((Ie=K.event_info)==null?void 0:Ie.event_name)||K.title||"Concert Review"}),s.jsx("div",{className:"flex flex-wrap items-center gap-2 text-sm text-gray-600 mb-3",children:((Ue=K.event_info)==null?void 0:Ue.artist_name)&&s.jsx(Be,{variant:"secondary",className:"cursor-pointer hover:bg-indigo-100",children:K.event_info.artist_name})}),((dt=K.event_info)==null?void 0:dt.venue_name)&&s.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[s.jsx(Xt,{className:"w-4 h-4"}),s.jsx("span",{children:K.event_info.venue_name})]})]}),K.rating&&s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(be,Re)=>{const We=Re+1,St=K.rating||0,Ye=We<=Math.floor(St),ir=!Ye&&We-.5<=St;return s.jsxs("div",{className:"relative w-6 h-6",children:[s.jsx(Jt,{className:"w-6 h-6 text-gray-300"}),(ir||Ye)&&s.jsx("div",{className:`absolute left-0 top-0 h-full overflow-hidden pointer-events-none ${Ye?"w-full":"w-1/2"}`,children:s.jsx(Jt,{className:"w-6 h-6 text-yellow-500 fill-yellow-500"})})]},Re)})}),s.jsxs("span",{className:"text-lg font-semibold",children:[K.rating,"/5"]})]}),K.content&&s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold mb-2 text-gray-900",children:"Review"}),s.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:K.content})]}),s.jsxs("div",{className:"flex items-center gap-6 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[s.jsx(hs,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:K.likes_count||0})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[s.jsx(Wn,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:K.comments_count||0})]})]})]})})]})]})}),R&&s.jsx(Cc,{event:R,currentUserId:e,isOpen:T,onClose:()=>{$(!1),F(null),V(be=>be+1)},onInterestToggle:he,isInterested:D}),le&&i&&i.is_group_chat&&s.jsx(tn,{open:le,onOpenChange:Se,children:s.jsxs(Xr,{className:"max-w-[393px] max-h-[80vh] overflow-y-auto bg-[#fcfcfc]",children:[s.jsxs(DialogHeader,{children:[s.jsxs(an,{className:"text-[20px] font-bold text-[#0e0e0e]",children:["Group Members (",ne.length,")"]}),s.jsx(Kn,{className:"text-[16px] text-[#5d646f]",children:"Members of this group chat"})]}),s.jsx("div",{className:"space-y-3 mt-4",children:ne.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ar,{className:"w-12 h-12 text-[#5d646f] mx-auto mb-4"}),s.jsx("p",{className:"text-[16px] text-[#5d646f]",children:"No members found"})]}):ne.map(be=>{const Re=be.user_id===e,We=be.is_admin;return s.jsxs("div",{className:"flex items-center justify-between p-3 border border-[#c9c9c9] rounded-[10px] bg-white hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 cursor-pointer",onClick:()=>{ce(be.user_id),Se(!1)},children:[s.jsxs(Vr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(Qr,{src:be.avatar_url||void 0}),s.jsx(qr,{className:"bg-synth-beige/50 text-synth-black font-medium",children:be.name.split(" ").map(St=>St[0]).join("")})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h3",{className:"font-semibold text-[16px] text-[#0e0e0e] truncate",children:[be.name,Re&&s.jsx("span",{className:"text-[14px] text-[#5d646f] font-normal ml-1",children:"(You)"})]}),be.verified&&s.jsx(Be,{variant:"default",className:"text-[10px] bg-green-500 text-white",children:" Verified"})]}),be.bio&&s.jsx("p",{className:"text-[14px] text-[#5d646f] truncate mt-1",children:be.bio}),s.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[We&&s.jsx(Be,{variant:"default",className:"text-[12px] bg-[#cc2486] text-white",children:"Admin"}),s.jsxs("span",{className:"text-[12px] text-[#5d646f]",children:["Joined ",Dt(Ws(be.joined_at),"MMM d, yyyy")]})]})]})]}),!Re&&s.jsx(oe,{variant:"ghost",size:"sm",onClick:St=>{St.stopPropagation(),ce(be.user_id),Se(!1)},className:"text-[#5d646f] hover:text-[#cc2486] hover:bg-pink-50 p-2 flex-shrink-0",children:s.jsx(li,{className:"w-4 h-4"})})]},be.id||be.user_id)})})]})})]})};class fh{static fetchAllNews(){return E(this,null,function*(){const t=this.getCachedNews();if(t)return console.log(" Using cached news articles"),t;console.log(" Fetching fresh news articles from RSS feeds");const r=[],n=this.SOURCES.map(a=>this.fetchFromSource(a));return(yield Promise.allSettled(n)).forEach((a,o)=>{a.status==="fulfilled"?(r.push(...a.value),console.log(` ${this.SOURCES[o].displayName}: ${a.value.length} articles`)):console.error(` ${this.SOURCES[o].displayName}: ${a.reason}`)}),r.sort((a,o)=>new Date(o.pubDate).getTime()-new Date(a.pubDate).getTime()),this.cacheNews(r),r})}static fetchFromSource(t){return E(this,null,function*(){try{const r=`https://api.allorigins.win/raw?url=${encodeURIComponent(t.url)}`,n=yield fetch(r);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const i=yield n.text();return this.parseRSSFeed(i,t)}catch(r){return console.error(`Error fetching from ${t.displayName}:`,r),[]}})}static parseRSSFeed(t,r){const n=[];try{const a=new DOMParser().parseFromString(t,"text/xml"),o=a.querySelector("parsererror");if(o)throw new Error(`XML parsing error: ${o.textContent}`);a.querySelectorAll("item").forEach((c,d)=>{var u,h,f,p,x,g,v,_,w,b,N,S,k,O,A;try{const T=((h=(u=c.querySelector("title"))==null?void 0:u.textContent)==null?void 0:h.trim())||"",$=((p=(f=c.querySelector("description"))==null?void 0:f.textContent)==null?void 0:p.trim())||"",R=((g=(x=c.querySelector("link"))==null?void 0:x.textContent)==null?void 0:g.trim())||"",F=((_=(v=c.querySelector("pubDate"))==null?void 0:v.textContent)==null?void 0:_.trim())||"",D=((b=(w=c.querySelector("author"))==null?void 0:w.textContent)==null?void 0:b.trim())||((S=(N=c.querySelector("dc\\:creator"))==null?void 0:N.textContent)==null?void 0:S.trim())||((O=(k=c.querySelector("creator"))==null?void 0:k.textContent)==null?void 0:O.trim())||"";let B="";const U=c.querySelector("media\\:content"),V=c.querySelector("enclosure");if(U)B=U.getAttribute("url")||"";else if(V&&((A=V.getAttribute("type"))!=null&&A.startsWith("image/")))B=V.getAttribute("url")||"";else{const Y=$.match(/<img[^>]+src="([^"]+)"/i);Y&&(B=Y[1])}T&&R&&this.isMusicRelated(T,$)&&n.push({id:`${r.name}-${d}-${Date.now()}`,title:this.cleanText(T),description:this.cleanText($),link:R,pubDate:this.parseDate(F),source:r.displayName,imageUrl:B||void 0,author:D||void 0})}catch(T){console.error(`Error parsing item ${d} from ${r.displayName}:`,T)}})}catch(i){console.error(`Error parsing RSS feed from ${r.displayName}:`,i)}return n}static isMusicRelated(t,r){const n=`${t} ${r}`.toLowerCase(),i=["music","song","album","artist","band","concert","tour","live music","musician","singer","guitarist","drummer","bassist","pianist","vocalist","rock","pop","hip hop","rap","jazz","blues","country","electronic","indie","alternative","metal","punk","reggae","soul","r&b","folk","festival","gig","venue","music video","single","ep","soundtrack","record label","music producer","dj","remix","cover","collaboration","music industry","streaming","spotify","apple music","billboard","grammy","mtv","music awards","chart","top 40","radio","playlist"],a=["game","gaming","video game","xbox","playstation","nintendo","movie","film","tv show","television","series","netflix","sports","football","basketball","soccer","baseball","tennis","politics","election","president","government","political","technology","tech","computer","software","hardware","iphone","business","economy","finance","stock","market","crypto","food","restaurant","recipe","cooking","chef","fashion","clothing","style","beauty","makeup","travel","vacation","hotel","flight","tourism"];for(const o of a)if(n.includes(o))return console.log(` Filtered out non-music article: "${t}" (keyword: ${o})`),!1;for(const o of i)if(n.includes(o))return console.log(` Music article found: "${t}" (keyword: ${o})`),!0;return console.log(` Unclear content filtered out: "${t}"`),!1}static cleanText(t){return t.replace(/<[^>]*>/g,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&nbsp;/g," ").trim()}static parseDate(t){try{const r=new Date(t);return isNaN(r.getTime())?new Date().toISOString():r.toISOString()}catch(r){return console.error("Error parsing date:",t,r),new Date().toISOString()}}static getCachedNews(){try{const t=localStorage.getItem("news-cache");if(!t)return null;const r=JSON.parse(t);return Date.now()<r.expiresAt?r.articles:(localStorage.removeItem("news-cache"),null)}catch(t){return console.error("Error reading news cache:",t),localStorage.removeItem("news-cache"),null}}static cacheNews(t){try{const r=Date.now(),n={articles:t,timestamp:r,expiresAt:r+this.CACHE_DURATION};localStorage.setItem("news-cache",JSON.stringify(n)),console.log(` Cached ${t.length} news articles for ${this.CACHE_DURATION/1e3/60} minutes`)}catch(r){console.error("Error caching news:",r)}}static getSources(){return this.SOURCES.map(t=>M({},t))}static filterBySource(t,r){if(r==="all")return t;const n=this.SOURCES.find(i=>i.name===r);return n?t.filter(i=>i.source===n.displayName):t}static clearCache(){localStorage.removeItem("news-cache"),console.log(" News cache cleared - will fetch fresh articles with music filtering")}static scoreArticleRelevance(t,r,n){let i=0;const a=`${t.title} ${t.description}`.toLowerCase();for(const u of r)if(a.includes(u.artist_name.toLowerCase())){i+=Math.min(u.score*1.5,60),console.log(` Artist match: "${u.artist_name}" in "${t.title}" (+${Math.min(u.score*1.5,60)} pts)`);break}let o=0,l=0;const c=[];for(const u of n)a.includes(u.genre.toLowerCase())&&(o+=u.score,l++,c.push(u.genre));if(l>0){const u=Math.min(o/l*1.33,40);i+=u,console.log(` Genre match: [${c.join(", ")}] in "${t.title}" (+${u.toFixed(1)} pts)`)}const d=Math.min(i,100);return d>0&&console.log(` Article scored: "${t.title}" = ${d.toFixed(1)}/100`),d}static getPersonalizedNews(t){return E(this,null,function*(){var r,n,i,a,o;try{console.log(" Fetching personalized news for user:",t);const l=yield this.fetchAllNews();if(!(yield Oh.userHasMusicData(t)))return console.log(" No music data for user, returning all news sorted by date"),l;const d=yield Oh.getUserTopArtists(t,50),u=yield Oh.getUserTopGenres(t,20);if(console.log(" User music profile:",{artists:d.length,genres:u.length,topArtist:(r=d[0])==null?void 0:r.artist_name,topGenre:(n=u[0])==null?void 0:n.genre}),d.length===0&&u.length===0)return console.log(" No artist/genre preferences found, returning all news"),l;const f=l.map(p=>{const x=this.scoreArticleRelevance(p,d,u);return W(M({},p),{relevance_score:x})}).sort((p,x)=>x.relevance_score!==p.relevance_score?(x.relevance_score||0)-(p.relevance_score||0):new Date(x.pubDate).getTime()-new Date(p.pubDate).getTime());return console.log(" Personalized news complete:",{total:f.length,topScore:(a=(i=f[0])==null?void 0:i.relevance_score)==null?void 0:a.toFixed(1),topArticle:(o=f[0])==null?void 0:o.title,personalizedCount:f.filter(p=>(p.relevance_score||0)>0).length}),f}catch(l){return console.error(" Error in personalized news:",l),this.fetchAllNews()}})}}_r(fh,"CACHE_DURATION",5*60*1e3),_r(fh,"SOURCES",[{name:"pitchfork",url:"https://pitchfork.com/rss/news/",displayName:"Pitchfork"},{name:"rollingstone",url:"https://www.rollingstone.com/music/rss/",displayName:"Rolling Stone"},{name:"nme",url:"https://www.nme.com/music/feed/",displayName:"NME"},{name:"billboard",url:"https://www.billboard.com/feed/rss",displayName:"Billboard"}]);function ihe({article:e,className:t=""}){const r=a=>{try{const o=Ws(a),c=Math.abs(new Date().getTime()-o.getTime())/(1e3*60*60);return c<24?Dt(o,"h:mm a"):c<168?Dt(o,"EEEE"):Dt(o,"MMM d")}catch(o){return"Recent"}},n=(a,o=150)=>a.length<=o?a:a.substring(0,o).trim()+"...",i=()=>{window.open(e.link,"_blank","noopener,noreferrer")};return s.jsxs(He,{className:`overflow-hidden hover:shadow-md transition-all duration-200 cursor-pointer group ${t}`,children:[e.imageUrl&&s.jsx("div",{className:"h-48 w-full overflow-hidden bg-gray-100",children:s.jsx("img",{src:e.imageUrl,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",loading:"lazy",onError:a=>{const o=a.target;o.style.display="none",o.parentElement.style.display="none"}})}),s.jsxs(st,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Be,{variant:"secondary",className:"flex items-center gap-1 text-xs bg-pink-100 text-pink-700 hover:bg-pink-200",children:[s.jsx(Yk,{className:"w-3 h-3"}),e.source]}),e.relevance_score&&e.relevance_score>50&&s.jsxs(Be,{variant:"secondary",className:"flex items-center gap-1 text-xs bg-gradient-to-r from-purple-100 to-pink-100 text-purple-700 border-purple-200",children:[s.jsx(Jt,{className:"w-3 h-3 fill-purple-500"}),"For You"]})]}),s.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[s.jsx(Et,{className:"w-3 h-3"}),r(e.pubDate)]})]}),s.jsx("h3",{className:"font-semibold text-lg mb-2 line-clamp-2 text-gray-900 group-hover:text-pink-600 transition-colors",children:e.title}),e.description&&s.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-3 leading-relaxed",children:n(e.description)}),e.author&&s.jsxs("div",{className:"flex items-center gap-1 mb-3 text-xs text-gray-500",children:[s.jsx(li,{className:"w-3 h-3"}),s.jsx("span",{children:e.author})]}),s.jsxs(oe,{onClick:i,variant:"outline",size:"sm",className:"w-full border-pink-200 text-pink-600 hover:bg-pink-50 hover:border-pink-300 transition-colors",children:[s.jsx(aa,{className:"w-4 h-4 mr-2"}),"Read More"]})]})]})}function ahe({className:e=""}){return s.jsxs(He,{className:`overflow-hidden ${e}`,children:[s.jsx("div",{className:"h-48 w-full bg-gray-200 animate-pulse"}),s.jsxs(st,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"h-5 w-20 bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"})]}),s.jsxs("div",{className:"space-y-2 mb-2",children:[s.jsx("div",{className:"h-5 w-full bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-5 w-3/4 bg-gray-200 rounded animate-pulse"})]}),s.jsxs("div",{className:"space-y-2 mb-3",children:[s.jsx("div",{className:"h-3 w-full bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-3 w-full bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"h-3 w-2/3 bg-gray-200 rounded animate-pulse"})]}),s.jsx("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse mb-3"}),s.jsx("div",{className:"h-8 w-full bg-gray-200 rounded animate-pulse"})]})]})}function ohe({artist:e,events:t,totalEvents:r,source:n,userId:i,onBack:a,onViewAllEvents:o,showAllEvents:l=!1,className:c}){const[d,u]=Q.useState(i);Q.useEffect(()=>{i||P.auth.getUser().then(({data:_})=>{var w;u((w=_.user)==null?void 0:w.id)})},[i]);const h=t.filter(_=>new Date(_.event_date)>new Date),f=l?h:h.slice(0,10),p=_=>new Date(_).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),x=_=>new Date(_).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),g=_=>_?new Date(_).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):null,v=_=>{const w=[_.venue_city,_.venue_state].filter(Boolean);return w.length>0?w.join(", "):"Location TBD"};return s.jsxs("div",{className:ke("w-full max-w-4xl mx-auto space-y-6 overflow-x-hidden",c),children:[a&&s.jsx(oe,{variant:"ghost",onClick:a,className:"mb-4",children:" Back to Search"}),s.jsx(He,{children:s.jsx(xr,{children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsxs(Vr,{className:"w-20 h-20",children:[s.jsx(Qr,{src:e.image_url||void 0}),s.jsx(qr,{className:"text-2xl",children:s.jsx(Ct,{className:"w-10 h-10"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[s.jsx(Cr,{className:"text-3xl",children:e.name}),s.jsx("div",{className:"flex items-center gap-2",children:d&&s.jsxs(s.Fragment,{children:[s.jsx(o1,{entityType:"artist",entityId:e.id||e.jambase_artist_id,entityName:e.name,currentUserId:d,onChatOpen:_=>{window.location.href=`/chats?chatId=${_}`},variant:"compact"}),s.jsx(Tv,{artistName:e.name,jambaseArtistId:e.jambase_artist_id,userId:d,variant:"outline",size:"default",showFollowerCount:!0})]})})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jambase_artist_id&&s.jsxs(Be,{variant:"outline",className:"flex items-center gap-1",children:[s.jsx(aa,{className:"w-3 h-3"}),"JamBase Verified"]}),s.jsx(Be,{variant:"secondary",children:n==="api"?"Live Data":"Cached Data"})]}),e.description&&s.jsx("p",{className:"text-muted-foreground leading-relaxed mb-4",children:e.description}),e.genres&&e.genres.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsx("div",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Genres"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:e.genres.map((_,w)=>s.jsx(Be,{variant:"secondary",className:"text-xs",children:_},w))})]}),s.jsxs("div",{className:"flex items-center gap-6 text-sm text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Et,{className:"w-4 h-4"}),s.jsxs("span",{children:[r," total events"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ai,{className:"w-4 h-4"}),s.jsxs("span",{children:[h.length," upcoming"]})]}),e.popularity_score&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Jt,{className:"w-4 h-4 text-yellow-400 fill-current"}),s.jsxs("span",{children:["Score: ",e.popularity_score]})]})]})]})]})})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Events"}),o&&r>t.length&&s.jsxs(oe,{variant:"outline",onClick:o,children:["View All ",r," Events"]})]}),h.length>0&&s.jsxs("div",{className:"w-full overflow-x-hidden",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[s.jsx(Et,{className:"w-5 h-5"}),"Upcoming Events (",h.length,")"]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 w-full max-w-full overflow-x-hidden",children:f.map(_=>s.jsx(He,{className:"hover:bg-muted/50 cursor-pointer w-full max-w-full min-w-0 overflow-hidden",children:s.jsx(st,{className:"p-2",children:s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"font-medium text-xs break-words",children:p(_.event_date)}),s.jsxs("div",{className:"text-xs text-muted-foreground break-words",children:[x(_.event_date),_.doors_time&&s.jsxs("span",{className:"ml-1 block",children:["Doors: ",g(_.doors_time)]})]}),s.jsx("div",{className:"font-medium text-xs truncate min-w-0",title:_.venue_name,children:_.venue_name||"Venue TBD"}),s.jsx("div",{className:"text-xs text-muted-foreground truncate min-w-0",children:v(_)}),_.price_range?s.jsxs("div",{className:"font-medium text-xs",children:["$",_.price_range]}):s.jsx("div",{className:"text-muted-foreground text-xs",children:"Price TBD"}),_.ticket_available&&_.ticket_urls&&_.ticket_urls.length>0?s.jsx(oe,{variant:"outline",size:"sm",asChild:!0,className:"text-blue-600 hover:text-blue-700 text-xs px-1.5 py-0.5 h-5 mt-1 w-full",children:s.jsxs("a",{href:_.ticket_urls[0],target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-1",children:[s.jsx(xc,{className:"w-2.5 h-2.5"}),s.jsx("span",{className:"text-xs",children:"Buy"})]})}):null,s.jsx(Be,{variant:"default",className:"text-xs mt-1 w-full text-center",children:"Upcoming"})]})})},_.jambase_event_id))}),!l&&h.length>10&&s.jsx("div",{className:"mt-2",children:s.jsxs(oe,{variant:"outline",onClick:o,className:"w-full",children:["Show ",h.length-10," More Upcoming Events"]})}),l&&h.length>10&&s.jsx("div",{className:"mt-2",children:s.jsx(oe,{variant:"outline",onClick:()=>o==null?void 0:o(),className:"w-full",children:"Show Less (Back to 10 events)"})})]}),t.length===0&&s.jsx(He,{children:s.jsxs(st,{className:"text-center py-12",children:[s.jsx(Ct,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Events Found"}),s.jsxs("p",{className:"text-muted-foreground",children:["No events found for ",e.name,". This could mean:"]}),s.jsxs("ul",{className:"text-sm text-muted-foreground mt-2 space-y-1",children:[s.jsx("li",{children:" The artist has no upcoming or recent events"}),s.jsx("li",{children:" The artist name might be spelled differently"}),s.jsx("li",{children:" The events might not be in our database yet"})]})]})})]})]})}function lhe({venueId:e,venueName:t,onClose:r}){var h,f,p,x;const[n,i]=y.useState(null),[a,o]=y.useState([]),[l,c]=y.useState([]),[d,u]=y.useState(null);return y.useEffect(()=>{P.auth.getUser().then(({data:g})=>{var v;u(((v=g.user)==null?void 0:v.id)||null)})},[]),y.useEffect(()=>{E(this,null,function*(){try{if(e){const{data:g}=yield P.from("venues").select("latitude, longitude").eq("id",e).single();g!=null&&g.latitude&&(g!=null&&g.longitude)&&i({lat:g.latitude,lng:g.longitude})}}catch(g){}try{if(e){const g=yield fs.getVenueReviews(e);o(g.reviews||[])}}catch(g){}try{const g=yield fetch(`/api/jambase/venues/upcoming?name=${encodeURIComponent(t)}`);if(g.ok){const v=yield g.json();c(Array.isArray(v==null?void 0:v.events)?v.events.slice(0,5):[])}}catch(g){}})},[e,t]),s.jsx(He,{className:"border-gray-200",children:s.jsxs(st,{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1 flex-1",children:[s.jsx("h3",{className:"text-base font-semibold",children:t}),n&&s.jsxs("div",{className:"text-xs text-gray-600 flex items-center gap-1",children:[s.jsx(Xt,{className:"w-3 h-3"}),s.jsxs("span",{children:[(h=n.lat)==null?void 0:h.toFixed(3),", ",(f=n.lng)==null?void 0:f.toFixed(3)]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[d&&e&&s.jsx(o1,{entityType:"venue",entityId:e,entityName:t,currentUserId:d,onChatOpen:g=>{window.location.href=`/chats?chatId=${g}`},variant:"compact"}),r&&s.jsx(oe,{variant:"ghost",size:"sm",onClick:r,children:""})]})]}),s.jsx("div",{className:"w-full h-40 rounded border flex items-center justify-center text-sm text-gray-500",children:n?`Map: ${(p=n.lat)==null?void 0:p.toFixed(3)}, ${(x=n.lng)==null?void 0:x.toFixed(3)}`:"Map location unavailable"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium mb-2",children:"Recent Reviews"}),a.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No venue reviews yet."}):s.jsx("div",{className:"space-y-2",children:a.slice(0,3).map(g=>s.jsxs("div",{className:"text-sm text-gray-700 flex items-center gap-2",children:[s.jsx(Jt,{className:"w-3 h-3 text-yellow-400 fill-current"}),s.jsxs("span",{children:[g.rating,"/5"]}),s.jsx("span",{className:"text-gray-500",children:""}),s.jsx("span",{className:"truncate",children:g.review_text||"No text"})]},g.id))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium mb-2",children:"Upcoming Events"}),l.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No upcoming events found."}):s.jsx("div",{className:"space-y-2",children:l.map((g,v)=>s.jsxs("div",{className:"text-sm text-gray-700 flex items-center gap-2",children:[s.jsx(Et,{className:"w-3 h-3"}),s.jsx("span",{className:"truncate",children:g.title||g.name||"Event"})]},v))})]})]})})}function che({followedArtists:e,followedVenues:t,artistName:r,venueName:n,venueCity:i,venueState:a}){const o=r&&e.includes(r),l=n&&t.some(c=>c.name===n&&(!c.city||c.city===i)&&(!c.state||c.state===a));return!o&&!l?null:o&&l?s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsxs(Be,{className:"bg-[#FF3399] text-white text-xs px-2 py-0.5 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"Following Artist"})]}),s.jsxs(Be,{className:"bg-blue-600 text-white text-xs px-2 py-0.5 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"Following Venue"})]})]}):o?s.jsxs(Be,{className:"bg-[#FF3399] text-white text-xs px-2 py-1 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"Following Artist"})]}):l?s.jsxs(Be,{className:"bg-blue-600 text-white text-xs px-2 py-1 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"Following Venue"})]}):null}var hr=function(){return hr=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},hr.apply(this,arguments)};function dhe(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function KB(e,t,r){for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function Dv(e){return e.mode==="multiple"}function Iv(e){return e.mode==="range"}function g1(e){return e.mode==="single"}var uhe={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function fhe(e,t){return Dt(e,"LLLL y",t)}function hhe(e,t){return Dt(e,"d",t)}function mhe(e,t){return Dt(e,"LLLL",t)}function phe(e){return"".concat(e)}function ghe(e,t){return Dt(e,"cccccc",t)}function vhe(e,t){return Dt(e,"yyyy",t)}var xhe=Object.freeze({__proto__:null,formatCaption:fhe,formatDay:hhe,formatMonthCaption:mhe,formatWeekNumber:phe,formatWeekdayName:ghe,formatYearCaption:vhe}),yhe=function(e,t,r){return Dt(e,"do MMMM (EEEE)",r)},_he=function(){return"Month: "},whe=function(){return"Go to next month"},bhe=function(){return"Go to previous month"},jhe=function(e,t){return Dt(e,"cccc",t)},Nhe=function(e){return"Week n. ".concat(e)},She=function(){return"Year: "},khe=Object.freeze({__proto__:null,labelDay:yhe,labelMonthDropdown:_he,labelNext:whe,labelPrevious:bhe,labelWeekNumber:Nhe,labelWeekday:jhe,labelYearDropdown:She});function Ehe(){var e="buttons",t=uhe,r=CE,n={},i={},a=1,o={},l=new Date;return{captionLayout:e,classNames:t,formatters:xhe,labels:khe,locale:r,modifiersClassNames:n,modifiers:i,numberOfMonths:a,styles:o,today:l,mode:"default"}}function Che(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,i=e.toMonth,a=e.fromDate,o=e.toDate;return n?a=la(n):t&&(a=new Date(t,0,1)),i?o=Gw(i):r&&(o=new Date(r,11,31)),{fromDate:a?nm(a):void 0,toDate:o?nm(o):void 0}}var ZB=y.createContext(void 0);function Phe(e){var t,r=e.initialProps,n=Ehe(),i=Che(r),a=i.fromDate,o=i.toDate,l=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;l!=="buttons"&&(!a||!o)&&(l="buttons");var c;(g1(r)||Dv(r)||Iv(r))&&(c=r.onSelect);var d=hr(hr(hr({},n),r),{captionLayout:l,classNames:hr(hr({},n.classNames),r.classNames),components:hr({},r.components),formatters:hr(hr({},n.formatters),r.formatters),fromDate:a,labels:hr(hr({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:hr(hr({},n.modifiers),r.modifiers),modifiersClassNames:hr(hr({},n.modifiersClassNames),r.modifiersClassNames),onSelect:c,styles:hr(hr({},n.styles),r.styles),toDate:o});return s.jsx(ZB.Provider,{value:d,children:e.children})}function Dn(){var e=y.useContext(ZB);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function XB(e){var t=Dn(),r=t.locale,n=t.classNames,i=t.styles,a=t.formatters.formatCaption;return s.jsx("div",{className:n.caption_label,style:i.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:a(e.displayMonth,{locale:r})})}function Ahe(e){return s.jsx("svg",hr({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:s.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function JB(e){var t,r,n=e.onChange,i=e.value,a=e.children,o=e.caption,l=e.className,c=e.style,d=Dn(),u=(r=(t=d.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:Ahe;return s.jsxs("div",{className:l,style:c,children:[s.jsx("span",{className:d.classNames.vhidden,children:e["aria-label"]}),s.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:d.classNames.dropdown,style:d.styles.dropdown,value:i,onChange:n,children:a}),s.jsxs("div",{className:d.classNames.caption_label,style:d.styles.caption_label,"aria-hidden":"true",children:[o,s.jsx(u,{className:d.classNames.dropdown_icon,style:d.styles.dropdown_icon})]})]})}function The(e){var t,r=Dn(),n=r.fromDate,i=r.toDate,a=r.styles,o=r.locale,l=r.formatters.formatMonthCaption,c=r.classNames,d=r.components,u=r.labels.labelMonthDropdown;if(!n)return s.jsx(s.Fragment,{});if(!i)return s.jsx(s.Fragment,{});var h=[];if(Xle(n,i))for(var f=la(n),p=n.getMonth();p<=i.getMonth();p++)h.push(Nj(f,p));else for(var f=la(new Date),p=0;p<=11;p++)h.push(Nj(f,p));var x=function(v){var _=Number(v.target.value),w=Nj(la(e.displayMonth),_);e.onChange(w)},g=(t=d==null?void 0:d.Dropdown)!==null&&t!==void 0?t:JB;return s.jsx(g,{name:"months","aria-label":u(),className:c.dropdown_month,style:a.dropdown_month,onChange:x,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:o}),children:h.map(function(v){return s.jsx("option",{value:v.getMonth(),children:l(v,{locale:o})},v.getMonth())})})}function Ohe(e){var t,r=e.displayMonth,n=Dn(),i=n.fromDate,a=n.toDate,o=n.locale,l=n.styles,c=n.classNames,d=n.components,u=n.formatters.formatYearCaption,h=n.labels.labelYearDropdown,f=[];if(!i)return s.jsx(s.Fragment,{});if(!a)return s.jsx(s.Fragment,{});for(var p=i.getFullYear(),x=a.getFullYear(),g=p;g<=x;g++)f.push(Z7(sF(new Date),g));var v=function(w){var b=Z7(la(r),Number(w.target.value));e.onChange(b)},_=(t=d==null?void 0:d.Dropdown)!==null&&t!==void 0?t:JB;return s.jsx(_,{name:"years","aria-label":h(),className:c.dropdown_year,style:l.dropdown_year,onChange:v,value:r.getFullYear(),caption:u(r,{locale:o}),children:f.map(function(w){return s.jsx("option",{value:w.getFullYear(),children:u(w,{locale:o})},w.getFullYear())})})}function Rhe(e,t){var r=y.useState(e),n=r[0],i=r[1],a=t===void 0?n:t;return[a,i]}function Mhe(e){var t=e.month,r=e.defaultMonth,n=e.today,i=t||r||n||new Date,a=e.toDate,o=e.fromDate,l=e.numberOfMonths,c=l===void 0?1:l;if(a&&im(a,i)<0){var d=-1*(c-1);i=Io(a,d)}return o&&im(i,o)<0&&(i=o),la(i)}function Dhe(){var e=Dn(),t=Mhe(e),r=Rhe(t,e.month),n=r[0],i=r[1],a=function(o){var l;if(!e.disableNavigation){var c=la(o);i(c),(l=e.onMonthChange)===null||l===void 0||l.call(e,c)}};return[n,a]}function Ihe(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,i=la(e),a=la(Io(i,n)),o=im(a,i),l=[],c=0;c<o;c++){var d=Io(i,c);l.push(d)}return r&&(l=l.reverse()),l}function $he(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,i=t.numberOfMonths,a=i===void 0?1:i,o=n?a:1,l=la(e);if(!r)return Io(l,o);var c=im(r,e);if(!(c<a))return Io(l,o)}}function Lhe(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,i=t.numberOfMonths,a=i===void 0?1:i,o=n?a:1,l=la(e);if(!r)return Io(l,-o);var c=im(l,r);if(!(c<=0))return Io(l,-o)}}var QB=y.createContext(void 0);function Fhe(e){var t=Dn(),r=Dhe(),n=r[0],i=r[1],a=Ihe(n,t),o=$he(n,t),l=Lhe(n,t),c=function(h){return a.some(function(f){return PE(h,f)})},d=function(h,f){c(h)||(f&&dF(h,f)?i(Io(h,1+t.numberOfMonths*-1)):i(h))},u={currentMonth:n,displayMonths:a,goToMonth:i,goToDate:d,previousMonth:l,nextMonth:o,isDateDisplayed:c};return s.jsx(QB.Provider,{value:u,children:e.children})}function $v(){var e=y.useContext(QB);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function fA(e){var t,r=Dn(),n=r.classNames,i=r.styles,a=r.components,o=$v().goToMonth,l=function(u){o(Io(u,e.displayIndex?-e.displayIndex:0))},c=(t=a==null?void 0:a.CaptionLabel)!==null&&t!==void 0?t:XB,d=s.jsx(c,{id:e.id,displayMonth:e.displayMonth});return s.jsxs("div",{className:n.caption_dropdowns,style:i.caption_dropdowns,children:[s.jsx("div",{className:n.vhidden,children:d}),s.jsx(The,{onChange:l,displayMonth:e.displayMonth}),s.jsx(Ohe,{onChange:l,displayMonth:e.displayMonth})]})}function Uhe(e){return s.jsx("svg",hr({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:s.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Bhe(e){return s.jsx("svg",hr({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:s.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var q2=y.forwardRef(function(e,t){var r=Dn(),n=r.classNames,i=r.styles,a=[n.button_reset,n.button];e.className&&a.push(e.className);var o=a.join(" "),l=hr(hr({},i.button_reset),i.button);return e.style&&Object.assign(l,e.style),s.jsx("button",hr({},e,{ref:t,type:"button",className:o,style:l}))});function zhe(e){var t,r,n=Dn(),i=n.dir,a=n.locale,o=n.classNames,l=n.styles,c=n.labels,d=c.labelPrevious,u=c.labelNext,h=n.components;if(!e.nextMonth&&!e.previousMonth)return s.jsx(s.Fragment,{});var f=d(e.previousMonth,{locale:a}),p=[o.nav_button,o.nav_button_previous].join(" "),x=u(e.nextMonth,{locale:a}),g=[o.nav_button,o.nav_button_next].join(" "),v=(t=h==null?void 0:h.IconRight)!==null&&t!==void 0?t:Bhe,_=(r=h==null?void 0:h.IconLeft)!==null&&r!==void 0?r:Uhe;return s.jsxs("div",{className:o.nav,style:l.nav,children:[!e.hidePrevious&&s.jsx(q2,{name:"previous-month","aria-label":f,className:p,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:i==="rtl"?s.jsx(v,{className:o.nav_icon,style:l.nav_icon}):s.jsx(_,{className:o.nav_icon,style:l.nav_icon})}),!e.hideNext&&s.jsx(q2,{name:"next-month","aria-label":x,className:g,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:i==="rtl"?s.jsx(_,{className:o.nav_icon,style:l.nav_icon}):s.jsx(v,{className:o.nav_icon,style:l.nav_icon})})]})}function hA(e){var t=Dn().numberOfMonths,r=$v(),n=r.previousMonth,i=r.nextMonth,a=r.goToMonth,o=r.displayMonths,l=o.findIndex(function(x){return PE(e.displayMonth,x)}),c=l===0,d=l===o.length-1,u=t>1&&(c||!d),h=t>1&&(d||!c),f=function(){n&&a(n)},p=function(){i&&a(i)};return s.jsx(zhe,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:h,nextMonth:i,previousMonth:n,onPreviousClick:f,onNextClick:p})}function Vhe(e){var t,r=Dn(),n=r.classNames,i=r.disableNavigation,a=r.styles,o=r.captionLayout,l=r.components,c=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:XB,d;return i?d=s.jsx(c,{id:e.id,displayMonth:e.displayMonth}):o==="dropdown"?d=s.jsx(fA,{displayMonth:e.displayMonth,id:e.id}):o==="dropdown-buttons"?d=s.jsxs(s.Fragment,{children:[s.jsx(fA,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),s.jsx(hA,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):d=s.jsxs(s.Fragment,{children:[s.jsx(c,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),s.jsx(hA,{displayMonth:e.displayMonth,id:e.id})]}),s.jsx("div",{className:n.caption,style:a.caption,children:d})}function qhe(e){var t=Dn(),r=t.footer,n=t.styles,i=t.classNames.tfoot;return r?s.jsx("tfoot",{className:i,style:n.tfoot,children:s.jsx("tr",{children:s.jsx("td",{colSpan:8,children:r})})}):s.jsx(s.Fragment,{})}function Whe(e,t,r){for(var n=r?Yu(new Date):Nl(new Date,{locale:e,weekStartsOn:t}),i=[],a=0;a<7;a++){var o=qs(n,a);i.push(o)}return i}function Hhe(){var e=Dn(),t=e.classNames,r=e.styles,n=e.showWeekNumber,i=e.locale,a=e.weekStartsOn,o=e.ISOWeek,l=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,d=Whe(i,a,o);return s.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&s.jsx("td",{style:r.head_cell,className:t.head_cell}),d.map(function(u,h){return s.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":c(u,{locale:i}),children:l(u,{locale:i})},h)})]})}function Ghe(){var e,t=Dn(),r=t.classNames,n=t.styles,i=t.components,a=(e=i==null?void 0:i.HeadRow)!==null&&e!==void 0?e:Hhe;return s.jsx("thead",{style:n.head,className:r.head,children:s.jsx(a,{})})}function Yhe(e){var t=Dn(),r=t.locale,n=t.formatters.formatDay;return s.jsx(s.Fragment,{children:n(e.date,{locale:r})})}var c4=y.createContext(void 0);function Khe(e){if(!Dv(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return s.jsx(c4.Provider,{value:t,children:e.children})}return s.jsx(Zhe,{initialProps:e.initialProps,children:e.children})}function Zhe(e){var t=e.initialProps,r=e.children,n=t.selected,i=t.min,a=t.max,o=function(d,u,h){var f,p;(f=t.onDayClick)===null||f===void 0||f.call(t,d,u,h);var x=!!(u.selected&&i&&(n==null?void 0:n.length)===i);if(!x){var g=!!(!u.selected&&a&&(n==null?void 0:n.length)===a);if(!g){var v=n?KB([],n):[];if(u.selected){var _=v.findIndex(function(w){return ea(d,w)});v.splice(_,1)}else v.push(d);(p=t.onSelect)===null||p===void 0||p.call(t,v,d,u,h)}}},l={disabled:[]};n&&l.disabled.push(function(d){var u=a&&n.length>a-1,h=n.some(function(f){return ea(f,d)});return!!(u&&!h)});var c={selected:n,onDayClick:o,modifiers:l};return s.jsx(c4.Provider,{value:c,children:r})}function d4(){var e=y.useContext(c4);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function Xhe(e,t){var r=t||{},n=r.from,i=r.to;return n&&i?ea(i,e)&&ea(n,e)?void 0:ea(i,e)?{from:i,to:void 0}:ea(n,e)?void 0:K3(n,e)?{from:e,to:i}:{from:n,to:e}:i?K3(e,i)?{from:i,to:e}:{from:e,to:i}:n?dF(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var u4=y.createContext(void 0);function Jhe(e){if(!Iv(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return s.jsx(u4.Provider,{value:t,children:e.children})}return s.jsx(Qhe,{initialProps:e.initialProps,children:e.children})}function Qhe(e){var t=e.initialProps,r=e.children,n=t.selected,i=n||{},a=i.from,o=i.to,l=t.min,c=t.max,d=function(p,x,g){var v,_;(v=t.onDayClick)===null||v===void 0||v.call(t,p,x,g);var w=Xhe(p,n);(_=t.onSelect)===null||_===void 0||_.call(t,w,p,x,g)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(a?(u.range_start=[a],o?(u.range_end=[o],ea(a,o)||(u.range_middle=[{after:a,before:o}])):u.range_end=[a]):o&&(u.range_start=[o],u.range_end=[o]),l&&(a&&!o&&u.disabled.push({after:bj(a,l-1),before:qs(a,l-1)}),a&&o&&u.disabled.push({after:a,before:qs(a,l-1)}),!a&&o&&u.disabled.push({after:bj(o,l-1),before:qs(o,l-1)})),c){if(a&&!o&&(u.disabled.push({before:qs(a,-c+1)}),u.disabled.push({after:qs(a,c-1)})),a&&o){var h=cl(o,a)+1,f=c-h;u.disabled.push({before:bj(a,f)}),u.disabled.push({after:qs(o,f)})}!a&&o&&(u.disabled.push({before:qs(o,-c+1)}),u.disabled.push({after:qs(o,c-1)}))}return s.jsx(u4.Provider,{value:{selected:n,onDayClick:d,modifiers:u},children:r})}function f4(){var e=y.useContext(u4);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function qy(e){return Array.isArray(e)?KB([],e):e!==void 0?[e]:[]}function eme(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],i=r[1];t[n]=qy(i)}),t}var $o;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})($o||($o={}));var tme=$o.Selected,Ul=$o.Disabled,rme=$o.Hidden,nme=$o.Today,Tj=$o.RangeEnd,Oj=$o.RangeMiddle,Rj=$o.RangeStart,sme=$o.Outside;function ime(e,t,r){var n,i=(n={},n[tme]=qy(e.selected),n[Ul]=qy(e.disabled),n[rme]=qy(e.hidden),n[nme]=[e.today],n[Tj]=[],n[Oj]=[],n[Rj]=[],n[sme]=[],n);return e.fromDate&&i[Ul].push({before:e.fromDate}),e.toDate&&i[Ul].push({after:e.toDate}),Dv(e)?i[Ul]=i[Ul].concat(t.modifiers[Ul]):Iv(e)&&(i[Ul]=i[Ul].concat(r.modifiers[Ul]),i[Rj]=r.modifiers[Rj],i[Oj]=r.modifiers[Oj],i[Tj]=r.modifiers[Tj]),i}var ez=y.createContext(void 0);function ame(e){var t=Dn(),r=d4(),n=f4(),i=ime(t,r,n),a=eme(t.modifiers),o=hr(hr({},i),a);return s.jsx(ez.Provider,{value:o,children:e.children})}function tz(){var e=y.useContext(ez);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function ome(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function lme(e){return!!(e&&typeof e=="object"&&"from"in e)}function cme(e){return!!(e&&typeof e=="object"&&"after"in e)}function dme(e){return!!(e&&typeof e=="object"&&"before"in e)}function ume(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function fme(e,t){var r,n=t.from,i=t.to;if(n&&i){var a=cl(i,n)<0;a&&(r=[i,n],n=r[0],i=r[1]);var o=cl(e,n)>=0&&cl(i,e)>=0;return o}return i?ea(i,e):n?ea(n,e):!1}function hme(e){return kE(e)}function mme(e){return Array.isArray(e)&&e.every(kE)}function pme(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(hme(r))return ea(e,r);if(mme(r))return r.includes(e);if(lme(r))return fme(e,r);if(ume(r))return r.dayOfWeek.includes(e.getDay());if(ome(r)){var n=cl(r.before,e),i=cl(r.after,e),a=n>0,o=i<0,l=K3(r.before,r.after);return l?o&&a:a||o}return cme(r)?cl(e,r.after)>0:dme(r)?cl(r.before,e)>0:typeof r=="function"?r(e):!1})}function h4(e,t,r){var n=Object.keys(t).reduce(function(a,o){var l=t[o];return pme(e,l)&&a.push(o),a},[]),i={};return n.forEach(function(a){return i[a]=!0}),r&&!PE(e,r)&&(i.outside=!0),i}function gme(e,t){for(var r=la(e[0]),n=Gw(e[e.length-1]),i,a,o=r;o<=n;){var l=h4(o,t),c=!l.disabled&&!l.hidden;if(!c){o=qs(o,1);continue}if(l.selected)return o;l.today&&!a&&(a=o),i||(i=o),o=qs(o,1)}return a||i}var vme=365;function rz(e,t){var r=t.moveBy,n=t.direction,i=t.context,a=t.modifiers,o=t.retry,l=o===void 0?{count:0,lastFocused:e}:o,c=i.weekStartsOn,d=i.fromDate,u=i.toDate,h=i.locale,f={day:qs,week:Y3,month:Io,year:Foe,startOfWeek:function(v){return i.ISOWeek?Yu(v):Nl(v,{locale:h,weekStartsOn:c})},endOfWeek:function(v){return i.ISOWeek?iF(v):EE(v,{locale:h,weekStartsOn:c})}},p=f[r](e,n==="after"?1:-1);n==="before"&&d?p=Uoe([d,p]):n==="after"&&u&&(p=Boe([u,p]));var x=!0;if(a){var g=h4(p,a);x=!g.disabled&&!g.hidden}return x?p:l.count>vme?l.lastFocused:rz(p,{moveBy:r,direction:n,context:i,modifiers:a,retry:hr(hr({},l),{count:l.count+1})})}var nz=y.createContext(void 0);function xme(e){var t=$v(),r=tz(),n=y.useState(),i=n[0],a=n[1],o=y.useState(),l=o[0],c=o[1],d=gme(t.displayMonths,r),u=(i!=null?i:l&&t.isDateDisplayed(l))?l:d,h=function(){c(i),a(void 0)},f=function(v){a(v)},p=Dn(),x=function(v,_){if(i){var w=rz(i,{moveBy:v,direction:_,context:p,modifiers:r});ea(i,w)||(t.goToDate(w,i),f(w))}},g={focusedDay:i,focusTarget:u,blur:h,focus:f,focusDayAfter:function(){return x("day","after")},focusDayBefore:function(){return x("day","before")},focusWeekAfter:function(){return x("week","after")},focusWeekBefore:function(){return x("week","before")},focusMonthBefore:function(){return x("month","before")},focusMonthAfter:function(){return x("month","after")},focusYearBefore:function(){return x("year","before")},focusYearAfter:function(){return x("year","after")},focusStartOfWeek:function(){return x("startOfWeek","before")},focusEndOfWeek:function(){return x("endOfWeek","after")}};return s.jsx(nz.Provider,{value:g,children:e.children})}function m4(){var e=y.useContext(nz);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function yme(e,t){var r=tz(),n=h4(e,r,t);return n}var p4=y.createContext(void 0);function _me(e){if(!g1(e.initialProps)){var t={selected:void 0};return s.jsx(p4.Provider,{value:t,children:e.children})}return s.jsx(wme,{initialProps:e.initialProps,children:e.children})}function wme(e){var t=e.initialProps,r=e.children,n=function(a,o,l){var c,d,u;if((c=t.onDayClick)===null||c===void 0||c.call(t,a,o,l),o.selected&&!t.required){(d=t.onSelect)===null||d===void 0||d.call(t,void 0,a,o,l);return}(u=t.onSelect)===null||u===void 0||u.call(t,a,a,o,l)},i={selected:t.selected,onDayClick:n};return s.jsx(p4.Provider,{value:i,children:r})}function sz(){var e=y.useContext(p4);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function bme(e,t){var r=Dn(),n=sz(),i=d4(),a=f4(),o=m4(),l=o.focusDayAfter,c=o.focusDayBefore,d=o.focusWeekAfter,u=o.focusWeekBefore,h=o.blur,f=o.focus,p=o.focusMonthBefore,x=o.focusMonthAfter,g=o.focusYearBefore,v=o.focusYearAfter,_=o.focusStartOfWeek,w=o.focusEndOfWeek,b=function(Y){var z,K,Z,G;g1(r)?(z=n.onDayClick)===null||z===void 0||z.call(n,e,t,Y):Dv(r)?(K=i.onDayClick)===null||K===void 0||K.call(i,e,t,Y):Iv(r)?(Z=a.onDayClick)===null||Z===void 0||Z.call(a,e,t,Y):(G=r.onDayClick)===null||G===void 0||G.call(r,e,t,Y)},N=function(Y){var z;f(e),(z=r.onDayFocus)===null||z===void 0||z.call(r,e,t,Y)},S=function(Y){var z;h(),(z=r.onDayBlur)===null||z===void 0||z.call(r,e,t,Y)},k=function(Y){var z;(z=r.onDayMouseEnter)===null||z===void 0||z.call(r,e,t,Y)},O=function(Y){var z;(z=r.onDayMouseLeave)===null||z===void 0||z.call(r,e,t,Y)},A=function(Y){var z;(z=r.onDayPointerEnter)===null||z===void 0||z.call(r,e,t,Y)},T=function(Y){var z;(z=r.onDayPointerLeave)===null||z===void 0||z.call(r,e,t,Y)},$=function(Y){var z;(z=r.onDayTouchCancel)===null||z===void 0||z.call(r,e,t,Y)},R=function(Y){var z;(z=r.onDayTouchEnd)===null||z===void 0||z.call(r,e,t,Y)},F=function(Y){var z;(z=r.onDayTouchMove)===null||z===void 0||z.call(r,e,t,Y)},D=function(Y){var z;(z=r.onDayTouchStart)===null||z===void 0||z.call(r,e,t,Y)},B=function(Y){var z;(z=r.onDayKeyUp)===null||z===void 0||z.call(r,e,t,Y)},U=function(Y){var z;switch(Y.key){case"ArrowLeft":Y.preventDefault(),Y.stopPropagation(),r.dir==="rtl"?l():c();break;case"ArrowRight":Y.preventDefault(),Y.stopPropagation(),r.dir==="rtl"?c():l();break;case"ArrowDown":Y.preventDefault(),Y.stopPropagation(),d();break;case"ArrowUp":Y.preventDefault(),Y.stopPropagation(),u();break;case"PageUp":Y.preventDefault(),Y.stopPropagation(),Y.shiftKey?g():p();break;case"PageDown":Y.preventDefault(),Y.stopPropagation(),Y.shiftKey?v():x();break;case"Home":Y.preventDefault(),Y.stopPropagation(),_();break;case"End":Y.preventDefault(),Y.stopPropagation(),w();break}(z=r.onDayKeyDown)===null||z===void 0||z.call(r,e,t,Y)},V={onClick:b,onFocus:N,onBlur:S,onKeyDown:U,onKeyUp:B,onMouseEnter:k,onMouseLeave:O,onPointerEnter:A,onPointerLeave:T,onTouchCancel:$,onTouchEnd:R,onTouchMove:F,onTouchStart:D};return V}function jme(){var e=Dn(),t=sz(),r=d4(),n=f4(),i=g1(e)?t.selected:Dv(e)?r.selected:Iv(e)?n.selected:void 0;return i}function Nme(e){return Object.values($o).includes(e)}function Sme(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var i=e.modifiersClassNames[n];if(i)r.push(i);else if(Nme(n)){var a=e.classNames["day_".concat(n)];a&&r.push(a)}}),r}function kme(e,t){var r=hr({},e.styles.day);return Object.keys(t).forEach(function(n){var i;r=hr(hr({},r),(i=e.modifiersStyles)===null||i===void 0?void 0:i[n])}),r}function Eme(e,t,r){var n,i,a,o=Dn(),l=m4(),c=yme(e,t),d=bme(e,c),u=jme(),h=!!(o.onDayClick||o.mode!=="default");y.useEffect(function(){var k;c.outside||l.focusedDay&&h&&ea(l.focusedDay,e)&&((k=r.current)===null||k===void 0||k.focus())},[l.focusedDay,e,r,h,c.outside]);var f=Sme(o,c).join(" "),p=kme(o,c),x=!!(c.outside&&!o.showOutsideDays||c.hidden),g=(a=(i=o.components)===null||i===void 0?void 0:i.DayContent)!==null&&a!==void 0?a:Yhe,v=s.jsx(g,{date:e,displayMonth:t,activeModifiers:c}),_={style:p,className:f,children:v,role:"gridcell"},w=l.focusTarget&&ea(l.focusTarget,e)&&!c.outside,b=l.focusedDay&&ea(l.focusedDay,e),N=hr(hr(hr({},_),(n={disabled:c.disabled,role:"gridcell"},n["aria-selected"]=c.selected,n.tabIndex=b||w?0:-1,n)),d),S={isButton:h,isHidden:x,activeModifiers:c,selectedDays:u,buttonProps:N,divProps:_};return S}function Cme(e){var t=y.useRef(null),r=Eme(e.date,e.displayMonth,t);return r.isHidden?s.jsx("div",{role:"gridcell"}):r.isButton?s.jsx(q2,hr({name:"day",ref:t},r.buttonProps)):s.jsx("div",hr({},r.divProps))}function Pme(e){var t=e.number,r=e.dates,n=Dn(),i=n.onWeekNumberClick,a=n.styles,o=n.classNames,l=n.locale,c=n.labels.labelWeekNumber,d=n.formatters.formatWeekNumber,u=d(Number(t),{locale:l});if(!i)return s.jsx("span",{className:o.weeknumber,style:a.weeknumber,children:u});var h=c(Number(t),{locale:l}),f=function(p){i(t,r,p)};return s.jsx(q2,{name:"week-number","aria-label":h,className:o.weeknumber,style:a.weeknumber,onClick:f,children:u})}function Ame(e){var t,r,n=Dn(),i=n.styles,a=n.classNames,o=n.showWeekNumber,l=n.components,c=(t=l==null?void 0:l.Day)!==null&&t!==void 0?t:Cme,d=(r=l==null?void 0:l.WeekNumber)!==null&&r!==void 0?r:Pme,u;return o&&(u=s.jsx("td",{className:a.cell,style:i.cell,children:s.jsx(d,{number:e.weekNumber,dates:e.dates})})),s.jsxs("tr",{className:a.row,style:i.row,children:[u,e.dates.map(function(h){return s.jsx("td",{className:a.cell,style:i.cell,role:"presentation",children:s.jsx(c,{displayMonth:e.displayMonth,date:h})},Yle(h))})]})}function mA(e,t,r){for(var n=r!=null&&r.ISOWeek?iF(t):EE(t,r),i=r!=null&&r.ISOWeek?Yu(e):Nl(e,r),a=cl(n,i),o=[],l=0;l<=a;l++)o.push(qs(i,l));var c=o.reduce(function(d,u){var h=r!=null&&r.ISOWeek?aF(u):lF(u,r),f=d.find(function(p){return p.weekNumber===h});return f?(f.dates.push(u),d):(d.push({weekNumber:h,dates:[u]}),d)},[]);return c}function Tme(e,t){var r=mA(la(e),Gw(e),t);if(t!=null&&t.useFixedWeeks){var n=Zle(e,t);if(n<6){var i=r[r.length-1],a=i.dates[i.dates.length-1],o=Y3(a,6-n),l=mA(Y3(a,1),o,t);r.push.apply(r,l)}}return r}function Ome(e){var t,r,n,i=Dn(),a=i.locale,o=i.classNames,l=i.styles,c=i.hideHead,d=i.fixedWeeks,u=i.components,h=i.weekStartsOn,f=i.firstWeekContainsDate,p=i.ISOWeek,x=Tme(e.displayMonth,{useFixedWeeks:!!d,ISOWeek:p,locale:a,weekStartsOn:h,firstWeekContainsDate:f}),g=(t=u==null?void 0:u.Head)!==null&&t!==void 0?t:Ghe,v=(r=u==null?void 0:u.Row)!==null&&r!==void 0?r:Ame,_=(n=u==null?void 0:u.Footer)!==null&&n!==void 0?n:qhe;return s.jsxs("table",{id:e.id,className:o.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!c&&s.jsx(g,{}),s.jsx("tbody",{className:o.tbody,style:l.tbody,children:x.map(function(w){return s.jsx(v,{displayMonth:e.displayMonth,dates:w.dates,weekNumber:w.weekNumber},w.weekNumber)})}),s.jsx(_,{displayMonth:e.displayMonth})]})}function Rme(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}var Mme=Rme()?y.useLayoutEffect:y.useEffect,Mj=!1,Dme=0;function pA(){return"react-day-picker-".concat(++Dme)}function Ime(e){var t,r=e!=null?e:Mj?pA():null,n=y.useState(r),i=n[0],a=n[1];return Mme(function(){i===null&&a(pA())},[]),y.useEffect(function(){Mj===!1&&(Mj=!0)},[]),(t=e!=null?e:i)!==null&&t!==void 0?t:void 0}function $me(e){var t,r,n=Dn(),i=n.dir,a=n.classNames,o=n.styles,l=n.components,c=$v().displayMonths,d=Ime(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),u=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,h=[a.month],f=o.month,p=e.displayIndex===0,x=e.displayIndex===c.length-1,g=!p&&!x;i==="rtl"&&(t=[p,x],x=t[0],p=t[1]),p&&(h.push(a.caption_start),f=hr(hr({},f),o.caption_start)),x&&(h.push(a.caption_end),f=hr(hr({},f),o.caption_end)),g&&(h.push(a.caption_between),f=hr(hr({},f),o.caption_between));var v=(r=l==null?void 0:l.Caption)!==null&&r!==void 0?r:Vhe;return s.jsxs("div",{className:h.join(" "),style:f,children:[s.jsx(v,{id:d,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),s.jsx(Ome,{id:u,"aria-labelledby":d,displayMonth:e.displayMonth})]},e.displayIndex)}function Lme(e){var t=Dn(),r=t.classNames,n=t.styles;return s.jsx("div",{className:r.months,style:n.months,children:e.children})}function Fme(e){var t,r,n=e.initialProps,i=Dn(),a=m4(),o=$v(),l=y.useState(!1),c=l[0],d=l[1];y.useEffect(function(){i.initialFocus&&a.focusTarget&&(c||(a.focus(a.focusTarget),d(!0)))},[i.initialFocus,c,a.focus,a.focusTarget,a]);var u=[i.classNames.root,i.className];i.numberOfMonths>1&&u.push(i.classNames.multiple_months),i.showWeekNumber&&u.push(i.classNames.with_weeknumber);var h=hr(hr({},i.styles.root),i.style),f=Object.keys(n).filter(function(x){return x.startsWith("data-")}).reduce(function(x,g){var v;return hr(hr({},x),(v={},v[g]=n[g],v))},{}),p=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:Lme;return s.jsx("div",hr({className:u.join(" "),style:h,dir:i.dir,id:i.id,nonce:n.nonce,title:n.title,lang:n.lang},f,{children:s.jsx(p,{children:o.displayMonths.map(function(x,g){return s.jsx($me,{displayIndex:g,displayMonth:x},g)})})}))}function Ume(e){var t=e.children,r=dhe(e,["children"]);return s.jsx(Phe,{initialProps:r,children:s.jsx(Fhe,{children:s.jsx(_me,{initialProps:r,children:s.jsx(Khe,{initialProps:r,children:s.jsx(Jhe,{initialProps:r,children:s.jsx(ame,{children:s.jsx(xme,{children:t})})})})})})})}function Bme(e){return s.jsx(Ume,hr({},e,{children:s.jsx(Fme,{initialProps:e})}))}function v1(i){var a=i,{className:e,classNames:t,showOutsideDays:r=!0}=a,n=me(a,["className","classNames","showOutsideDays"]);return s.jsx(Bme,M({showOutsideDays:r,className:ke("p-3",e),classNames:M({months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:ke(xg({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:ke(xg({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible"},t),components:{IconLeft:l=>{var o=me(l,[]);return s.jsx(KD,{className:"h-4 w-4"})},IconRight:l=>{var o=me(l,[]);return s.jsx(vw,{className:"h-4 w-4"})}}},n))}v1.displayName="Calendar";var x1="Popover",[iz,PFe]=js(x1,[Rd]),Lv=Rd(),[zme,Ld]=iz(x1),az=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:i,onOpenChange:a,modal:o=!1}=e,l=Lv(t),c=y.useRef(null),[d,u]=y.useState(!1),[h,f]=Di({prop:n,defaultProp:i!=null?i:!1,onChange:a,caller:x1});return s.jsx(jw,W(M({},l),{children:s.jsx(zme,{scope:t,contentId:_s(),triggerRef:c,open:h,onOpenChange:f,onOpenToggle:y.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:d,onCustomAnchorAdd:y.useCallback(()=>u(!0),[]),onCustomAnchorRemove:y.useCallback(()=>u(!1),[]),modal:o,children:r})}))};az.displayName=x1;var oz="PopoverAnchor",Vme=y.forwardRef((e,t)=>{const c=e,{__scopePopover:r}=c,n=me(c,["__scopePopover"]),i=Ld(oz,r),a=Lv(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=i;return y.useEffect(()=>(o(),()=>l()),[o,l]),s.jsx(wv,W(M(M({},a),n),{ref:t}))});Vme.displayName=oz;var lz="PopoverTrigger",cz=y.forwardRef((e,t)=>{const c=e,{__scopePopover:r}=c,n=me(c,["__scopePopover"]),i=Ld(lz,r),a=Lv(r),o=sr(t,i.triggerRef),l=s.jsx(Nt.button,W(M({type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":mz(i.open)},n),{ref:o,onClick:mt(e.onClick,i.onOpenToggle)}));return i.hasCustomAnchor?l:s.jsx(wv,W(M({asChild:!0},a),{children:l}))});cz.displayName=lz;var g4="PopoverPortal",[qme,Wme]=iz(g4,{forceMount:void 0}),dz=e=>{const{__scopePopover:t,forceMount:r,children:n,container:i}=e,a=Ld(g4,t);return s.jsx(qme,{scope:t,forceMount:r,children:s.jsx($s,{present:r||a.open,children:s.jsx(Vm,{asChild:!0,container:i,children:n})})})};dz.displayName=g4;var om="PopoverContent",uz=y.forwardRef((e,t)=>{const r=Wme(om,e.__scopePopover),o=e,{forceMount:n=r.forceMount}=o,i=me(o,["forceMount"]),a=Ld(om,e.__scopePopover);return s.jsx($s,{present:n||a.open,children:a.modal?s.jsx(Gme,W(M({},i),{ref:t})):s.jsx(Yme,W(M({},i),{ref:t}))})});uz.displayName=om;var Hme=Nd("PopoverContent.RemoveScroll"),Gme=y.forwardRef((e,t)=>{const r=Ld(om,e.__scopePopover),n=y.useRef(null),i=sr(t,n),a=y.useRef(!1);return y.useEffect(()=>{const o=n.current;if(o)return Uw(o)},[]),s.jsx(kv,{as:Hme,allowPinchZoom:!0,children:s.jsx(fz,W(M({},e),{ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:mt(e.onCloseAutoFocus,o=>{var l;o.preventDefault(),a.current||(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:mt(e.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;a.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:mt(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})}))})}),Yme=y.forwardRef((e,t)=>{const r=Ld(om,e.__scopePopover),n=y.useRef(!1),i=y.useRef(!1);return s.jsx(fz,W(M({},e),{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,a),a.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),a.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:a=>{var c,d;(c=e.onInteractOutside)==null||c.call(e,a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const o=a.target;((d=r.triggerRef.current)==null?void 0:d.contains(o))&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&i.current&&a.preventDefault()}}))}),fz=y.forwardRef((e,t)=>{const x=e,{__scopePopover:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u}=x,h=me(x,["__scopePopover","trapFocus","onOpenAutoFocus","onCloseAutoFocus","disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside"]),f=Ld(om,r),p=Lv(r);return Lw(),s.jsx(Sv,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:a,children:s.jsx(of,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>f.onOpenChange(!1),children:s.jsx(Nw,W(M(M({"data-state":mz(f.open),role:"dialog",id:f.contentId},p),h),{ref:t,style:W(M({},h.style),{"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"})}))})})}),hz="PopoverClose",Kme=y.forwardRef((e,t)=>{const a=e,{__scopePopover:r}=a,n=me(a,["__scopePopover"]),i=Ld(hz,r);return s.jsx(Nt.button,W(M({type:"button"},n),{ref:t,onClick:mt(e.onClick,()=>i.onOpenChange(!1))}))});Kme.displayName=hz;var Zme="PopoverArrow",Xme=y.forwardRef((e,t)=>{const a=e,{__scopePopover:r}=a,n=me(a,["__scopePopover"]),i=Lv(r);return s.jsx(Sw,W(M(M({},i),n),{ref:t}))});Xme.displayName=Zme;function mz(e){return e?"open":"closed"}var Jme=az,Qme=cz,epe=dz,pz=uz;const rc=Jme,nc=Qme,ul=y.forwardRef((a,i)=>{var o=a,{className:e,align:t="center",sideOffset:r=4}=o,n=me(o,["className","align","sideOffset"]);return s.jsx(epe,{children:s.jsx(pz,M({ref:i,align:t,sideOffset:r,className:ke("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e)},n))})});ul.displayName=pz.displayName;var y1="Checkbox",[tpe,AFe]=js(y1),[rpe,v4]=tpe(y1);function npe(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:i,disabled:a,form:o,name:l,onCheckedChange:c,required:d,value:u="on",internal_do_not_use_render:h}=e,[f,p]=Di({prop:r,defaultProp:i!=null?i:!1,onChange:c,caller:y1}),[x,g]=y.useState(null),[v,_]=y.useState(null),w=y.useRef(!1),b=x?!!o||!!x.closest("form"):!0,N={checked:f,disabled:a,setChecked:p,control:x,setControl:g,name:l,form:o,value:u,hasConsumerStoppedPropagationRef:w,required:d,defaultChecked:_d(i)?!1:i,isFormControl:b,bubbleInput:v,setBubbleInput:_};return s.jsx(rpe,W(M({scope:t},N),{children:spe(h)?h(N):n}))}var gz="CheckboxTrigger",vz=y.forwardRef((a,i)=>{var o=a,{__scopeCheckbox:e,onKeyDown:t,onClick:r}=o,n=me(o,["__scopeCheckbox","onKeyDown","onClick"]);const{control:l,value:c,disabled:d,checked:u,required:h,setControl:f,setChecked:p,hasConsumerStoppedPropagationRef:x,isFormControl:g,bubbleInput:v}=v4(gz,e),_=sr(i,f),w=y.useRef(u);return y.useEffect(()=>{const b=l==null?void 0:l.form;if(b){const N=()=>p(w.current);return b.addEventListener("reset",N),()=>b.removeEventListener("reset",N)}},[l,p]),s.jsx(Nt.button,W(M({type:"button",role:"checkbox","aria-checked":_d(u)?"mixed":u,"aria-required":h,"data-state":bz(u),"data-disabled":d?"":void 0,disabled:d,value:c},n),{ref:_,onKeyDown:mt(t,b=>{b.key==="Enter"&&b.preventDefault()}),onClick:mt(r,b=>{p(N=>_d(N)?!0:!N),v&&g&&(x.current=b.isPropagationStopped(),x.current||b.stopPropagation())})}))});vz.displayName=gz;var x4=y.forwardRef((e,t)=>{const f=e,{__scopeCheckbox:r,name:n,checked:i,defaultChecked:a,required:o,disabled:l,value:c,onCheckedChange:d,form:u}=f,h=me(f,["__scopeCheckbox","name","checked","defaultChecked","required","disabled","value","onCheckedChange","form"]);return s.jsx(npe,{__scopeCheckbox:r,checked:i,defaultChecked:a,disabled:l,required:o,onCheckedChange:d,name:n,form:u,value:c,internal_do_not_use_render:({isFormControl:p})=>s.jsxs(s.Fragment,{children:[s.jsx(vz,W(M({},h),{ref:t,__scopeCheckbox:r})),p&&s.jsx(wz,{__scopeCheckbox:r})]})})});x4.displayName=y1;var xz="CheckboxIndicator",yz=y.forwardRef((e,t)=>{const o=e,{__scopeCheckbox:r,forceMount:n}=o,i=me(o,["__scopeCheckbox","forceMount"]),a=v4(xz,r);return s.jsx($s,{present:n||_d(a.checked)||a.checked===!0,children:s.jsx(Nt.span,W(M({"data-state":bz(a.checked),"data-disabled":a.disabled?"":void 0},i),{ref:t,style:M({pointerEvents:"none"},e.style)}))})});yz.displayName=xz;var _z="CheckboxBubbleInput",wz=y.forwardRef((n,r)=>{var i=n,{__scopeCheckbox:e}=i,t=me(i,["__scopeCheckbox"]);const{control:a,hasConsumerStoppedPropagationRef:o,checked:l,defaultChecked:c,required:d,disabled:u,name:h,value:f,form:p,bubbleInput:x,setBubbleInput:g}=v4(_z,e),v=sr(r,g),_=l1(l),w=bw(a);y.useEffect(()=>{const N=x;if(!N)return;const S=window.HTMLInputElement.prototype,O=Object.getOwnPropertyDescriptor(S,"checked").set,A=!o.current;if(_!==l&&O){const T=new Event("click",{bubbles:A});N.indeterminate=_d(l),O.call(N,_d(l)?!1:l),N.dispatchEvent(T)}},[x,_,l,o]);const b=y.useRef(_d(l)?!1:l);return s.jsx(Nt.input,W(M({type:"checkbox","aria-hidden":!0,defaultChecked:c!=null?c:b.current,required:d,disabled:u,name:h,value:f,form:p},t),{tabIndex:-1,ref:v,style:W(M(M({},t.style),w),{position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"})}))});wz.displayName=_z;function spe(e){return typeof e=="function"}function _d(e){return e==="indeterminate"}function bz(e){return _d(e)?"indeterminate":e?"checked":"unchecked"}const W2=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(x4,W(M({ref:r,className:ke("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e)},t),{children:s.jsx(yz,{className:ke("flex items-center justify-center text-current"),children:s.jsx(Gs,{className:"h-4 w-4"})})}))});W2.displayName=x4.displayName;const ipe=["Rock","Pop","Hip-Hop","Electronic","Jazz","Classical","Country","R&B","Reggae","Folk","Blues","Alternative","Indie","Punk","Metal","Funk","Soul","Gospel","Latin","World"],ape=({filters:e,onFiltersChange:t,availableGenres:r=ipe,availableCities:n=[],className:i="",onOverlayChange:a,onClearVenueSelection:o})=>{var xe,ge,ie;const[l,c]=y.useState(e.selectedCities||[]),[d,u]=y.useState(!1),[h,f]=y.useState(""),[p,x]=y.useState(!1),[g,v]=y.useState(!1),[_,w]=y.useState(""),[b,N]=y.useState([]),[S,k]=y.useState(!1),[O,A]=y.useState(!1);y.useEffect(()=>{if(e.selectedCities&&e.selectedCities.length>0){const ee=uh(e.selectedCities);(ee.length!==e.selectedCities.length||!ee.every((H,le)=>H===e.selectedCities[le]))&&t(W(M({},e),{selectedCities:ee}))}},[e.selectedCities]),y.useEffect(()=>{g&&T()},[g]);const T=()=>E(void 0,null,function*(){k(!0);try{const{data:ee,error:H}=yield P.rpc("get_available_cities_for_filter",{min_event_count:1,limit_count:500});if(H){console.warn("Error loading cities from database function, falling back to direct query:",H);const{data:le,error:Se}=yield P.from("events").select("display_city, venue_state").not("display_city","is",null).gte("event_date",new Date().toISOString());if(Se)throw Se;const ae=new Map;(le||[]).forEach(he=>{var Fe,ve;const pe=(Fe=he.display_city)==null?void 0:Fe.trim(),Ae=((ve=he.venue_state)==null?void 0:ve.trim())||"",qe=`${pe}|${Ae}`;pe&&(ae.has(qe)||ae.set(qe,{state:Ae,count:0}),ae.get(qe).count++)});const fe=Array.from(ae.entries()).map(([he,pe])=>{const Ae=he.split("|")[0];return{city:zy(Ae),state:pe.state,eventCount:pe.count}}).sort((he,pe)=>pe.eventCount-he.eventCount);N(fe)}else{const le=(ee||[]).map(pe=>({city:pe.city_name,state:pe.state||"",eventCount:Number(pe.event_count)})),Se=pe=>{if(!pe)return"";const Ae=pe.trim().toUpperCase();return Ae==="DC"||Ae==="D.C."||Ae==="DISTRICT OF COLUMBIA"?"DC":pe.trim()},ae=pe=>{let Ae=pe.trim().toLowerCase();return Ae=Ae.replace(/\s+dc$/,""),Ae=Ae.replace(/\s+d\.c\.$/,""),Ae=Ae.replace(/\s+/g," "),Ae},fe=new Map;le.forEach(pe=>{const Ae=ae(pe.city),qe=Se(pe.state),Fe=`${Ae}|${qe}`;if(!fe.has(Fe))fe.set(Fe,pe);else{const ve=fe.get(Fe);(pe.eventCount>ve.eventCount||pe.eventCount===ve.eventCount&&pe.state&&!ve.state)&&fe.set(Fe,pe)}});const he=Array.from(fe.values()).map(pe=>W(M({},pe),{city:zy(pe.city)})).sort((pe,Ae)=>Ae.eventCount-pe.eventCount);N(he)}}catch(ee){console.error("Error loading cities:",ee),N([])}finally{k(!1)}}),$=ee=>{var le,Se,ae,fe;const H=((le=ee==null?void 0:ee.genres)!=null?le:p)||((Se=ee==null?void 0:ee.locations)!=null?Se:g)||((ae=ee==null?void 0:ee.date)!=null?ae:d)||((fe=ee==null?void 0:ee.daysOfWeek)!=null?fe:O);a&&a(H)},R=ee=>{const H=e.genres.includes(ee)?e.genres.filter(le=>le!==ee):[...e.genres,ee];t(W(M({},e),{genres:H}))},F=()=>{if(_.trim()&&!e.genres.includes(_.trim())){const ee=[...e.genres,_.trim()];t(W(M({},e),{genres:ee})),w("")}},D=ee=>{ee.key==="Enter"&&F()},B=()=>{const ee=uh(l);t(W(M({},e),{selectedCities:ee}))},U=()=>{c([]),t(W(M({},e),{selectedCities:[]}))},V=ee=>{const H={from:ee.from?(()=>{const le=new Date(ee.from);return le.setHours(0,0,0,0),le})():void 0,to:ee.to?(()=>{const le=new Date(ee.to);return le.setHours(23,59,59,999),le})():void 0};if(H.from&&!H.to){const le=new Date(H.from);le.setHours(23,59,59,999),H.to=le}else if(!H.from&&H.to){const le=new Date(H.to);le.setHours(0,0,0,0),H.from=le}t(W(M({},e),{dateRange:H})),H.from&&H.to&&u(!1)},Y=()=>{t(W(M({},e),{dateRange:{from:void 0,to:void 0}}))},z=ee=>{const H={from:(()=>{const le=new Date(ee.from);return le.setHours(0,0,0,0),le})(),to:(()=>{const le=new Date(ee.to);return le.setHours(23,59,59,999),le})()};t(W(M({},e),{dateRange:H})),u(!1)},K=()=>{if(!e.dateRange.from||!e.dateRange.to)return null;const ee=ne(),H=e.dateRange.from,le=e.dateRange.to,Se=he=>{const pe=new Date(he);return pe.setHours(0,0,0,0),pe.getTime()},ae=Se(H),fe=Se(le);return ee.find(he=>{const pe=Se(he.value.from),Ae=Se(he.value.to);return pe===ae&&Ae===fe})},Z=ee=>{const H=e.daysOfWeek.includes(ee)?e.daysOfWeek.filter(le=>le!==ee):[...e.daysOfWeek,ee];t(W(M({},e),{daysOfWeek:H}))},G=()=>{const ee=[0,1,2,3,4];if(ee.every(le=>e.daysOfWeek.includes(le)))t(W(M({},e),{daysOfWeek:e.daysOfWeek.filter(le=>!ee.includes(le))}));else{const le=[...new Set([...e.daysOfWeek,...ee])];t(W(M({},e),{daysOfWeek:le}))}},X=()=>{const ee=[5,6];if(ee.every(le=>e.daysOfWeek.includes(le)))t(W(M({},e),{daysOfWeek:e.daysOfWeek.filter(le=>!ee.includes(le))}));else{const le=[...new Set([...e.daysOfWeek,...ee])];t(W(M({},e),{daysOfWeek:le}))}},te=()=>{t({genres:[],selectedCities:[],dateRange:{from:void 0,to:void 0},showFilters:e.showFilters,radiusMiles:e.radiusMiles,filterByFollowing:"all",daysOfWeek:[]}),c([]),o&&o()},se=e.genres.length>0||e.selectedCities&&e.selectedCities.length>0||e.dateRange.from||e.dateRange.to||e.filterByFollowing==="following"||e.daysOfWeek.length>0;y.useMemo(()=>b.slice(0,10),[b]);const ue=y.useMemo(()=>{const ee=h.trim().toLowerCase(),H=b.length>0?b:(n||[]).map(le=>({city:le,state:"",eventCount:0}));return ee?H.filter(le=>{const Se=typeof le=="string"?le:le.city,ae=typeof le=="string"?"":le.state,fe=Ys(Se),he=ae.toLowerCase().trim(),pe=Ys(ee);return fe.includes(pe)||he.includes(pe)||Se.toLowerCase().includes(ee)||ae.toLowerCase().includes(ee)}):H},[b,n,h]),ye=()=>{if(e.dateRange.from&&e.dateRange.to){const ee=e.dateRange.from.toDateString(),H=e.dateRange.to.toDateString();return ee===H?Dt(e.dateRange.from,"MMM d, yyyy"):`${Dt(e.dateRange.from,"MMM d")} - ${Dt(e.dateRange.to,"MMM d")}`}else{if(e.dateRange.from)return Dt(e.dateRange.from,"MMM d, yyyy");if(e.dateRange.to)return`Until ${Dt(e.dateRange.to,"MMM d, yyyy")}`}return"Calendar"},ne=()=>{const ee=new Date;ee.setHours(0,0,0,0);const H=new Date(ee);H.setHours(23,59,59,999);const le=qs(ee,7);le.setHours(23,59,59,999);const Se=qs(ee,30);Se.setHours(23,59,59,999);const ae=qs(ee,90);return ae.setHours(23,59,59,999),[{label:"Today",value:{from:new Date(ee),to:H}},{label:"This Week",value:{from:new Date(ee),to:le}},{label:"This Month",value:{from:new Date(ee),to:Se}},{label:"Next 3 Months",value:{from:new Date(ee),to:ae}}]};return s.jsxs("div",{className:ke("space-y-4",i),children:[s.jsxs("div",{className:"flex items-center gap-2 bg-white/60 backdrop-blur-sm rounded-2xl p-4 border border-white/20 overflow-x-auto",children:[s.jsxs(rc,{open:p,onOpenChange:ee=>{x(ee),$({genres:ee})},children:[s.jsx(nc,{asChild:!0,children:s.jsxs(oe,{variant:"outline",size:"sm",className:"rounded-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0",children:[s.jsx(Ct,{className:"h-4 w-4 mr-1"}),"Genres",e.genres.length>0&&s.jsx(Be,{variant:"secondary",className:"ml-2 h-5 rounded-full px-2 bg-synth-pink/20 text-synth-pink border-synth-pink/30",children:e.genres.length})]})}),s.jsx(ul,{className:"w-80 z-[60] bg-white/95 backdrop-blur-md border border-gray-200/50 rounded-2xl shadow-xl",children:s.jsxs("div",{className:"space-y-4 p-2",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(ee=>s.jsx(Be,{variant:e.genres.includes(ee)?"default":"outline",className:`cursor-pointer transition-all duration-200 ${e.genres.includes(ee)?"bg-synth-pink text-white hover:bg-synth-pink-dark":"hover:bg-synth-pink/10 hover:text-synth-pink hover:border-synth-pink/30"}`,onClick:()=>R(ee),children:ee},ee))}),s.jsx("div",{className:"border-t border-gray-200/50 pt-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",placeholder:"Other: _____",value:_,onChange:ee=>w(ee.target.value),onKeyPress:D,className:"synth-input flex-1 h-9 text-sm"}),s.jsx(oe,{size:"sm",onClick:F,disabled:!_.trim()||e.genres.includes(_.trim()),className:"h-9 px-4",children:"Add"})]})})]})})]}),s.jsxs(rc,{open:g,onOpenChange:ee=>{v(ee),$({locations:ee})},children:[s.jsx(nc,{asChild:!0,children:s.jsxs(oe,{variant:"outline",size:"sm",className:"rounded-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0",children:[s.jsx(Xt,{className:"h-4 w-4 mr-1"}),"Locations",(((xe=e.selectedCities)==null?void 0:xe.length)||0)>0&&s.jsx(Be,{variant:"secondary",className:"ml-2 h-5 rounded-full px-2 bg-synth-pink/20 text-synth-pink border-synth-pink/30",children:e.selectedCities.length})]})}),s.jsx(ul,{className:"w-96 z-[60] bg-white/95 backdrop-blur-md border border-gray-200/50 rounded-2xl shadow-xl",children:s.jsxs("div",{className:"space-y-4 p-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Mi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search cities...",value:h,onChange:ee=>f(ee.target.value),className:"synth-input w-full pl-10 h-9 text-sm"})]}),s.jsx(oe,{size:"sm",onClick:B,disabled:l.length===(((ge=e.selectedCities)==null?void 0:ge.length)||0)&&l.every(ee=>e.selectedCities.includes(ee)),children:"Apply"}),e.selectedCities&&e.selectedCities.length>0&&s.jsx(oe,{size:"sm",variant:"outline",onClick:U,children:s.jsx(pr,{className:"h-4 w-4"})})]}),(l.length>0||e.selectedCities&&e.selectedCities.length>0)&&s.jsxs("div",{className:"border-t border-gray-200/50 pt-3 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Search Radius"}),s.jsxs("span",{className:"text-sm text-gray-600",children:[e.radiusMiles," miles"]})]}),s.jsx("input",{type:"range",min:"5",max:"100",step:"5",value:e.radiusMiles||25,onChange:ee=>{t(W(M({},e),{radiusMiles:parseInt(ee.target.value,10)}))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-synth-pink"}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[s.jsx("span",{children:"5 mi"}),s.jsx("span",{children:"25 mi"}),s.jsx("span",{children:"50 mi"}),s.jsx("span",{children:"100 mi"})]})]}),s.jsxs("div",{className:"max-h-48 overflow-auto pr-1 space-y-1 synth-scrollbar",children:[S?s.jsxs("div",{className:"flex items-center justify-center py-4",children:[s.jsx(er,{className:"h-4 w-4 animate-spin mr-2"}),s.jsx("span",{className:"text-sm text-gray-600",children:"Loading cities..."})]}):ue.map((ee,H)=>{let le=typeof ee=="string"?ee:ee.city,Se=typeof ee=="string"?"":ee.state;const ae=le.match(/^(.+?),\s*([A-Z]{2})$/);ae&&(le=ae[1].trim(),Se=ae[2].trim()||Se);const fe=zy(le),he=Se?Se.trim().toUpperCase().replace(/\./g,""):"",pe=fe,Ae=l.some(Fe=>{const ve=Fe.includes(",")?Fe.split(",")[0].trim():Fe,rt=Ys(ve),Ve=Ys(fe);return rt===Ve}),qe=he?`${fe}-${he}-${H}`:`${fe}-${H}`;return s.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer select-none p-2 rounded-lg hover:bg-synth-pink/5 transition-colors",children:[s.jsx(W2,{checked:Ae,onCheckedChange:Fe=>{if(!!Fe)c(rt=>{const Ve=[...rt,pe];return uh(Ve)});else{const rt=Ys(fe);c(Ve=>Ve.filter(lt=>{const ut=lt.includes(",")?lt.split(",")[0].trim():lt;return Ys(ut)!==rt}))}}}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium truncate",children:fe}),he&&s.jsx("div",{className:"text-xs text-gray-500 truncate",children:he})]})]},qe)}),!S&&ue.length===0&&s.jsx("div",{className:"text-xs text-muted-foreground text-center py-4",children:h?`No cities found for "${h}"`:"No cities available"})]})]})})]}),s.jsxs(rc,{open:O,onOpenChange:ee=>{A(ee),$({daysOfWeek:ee})},children:[s.jsx(nc,{asChild:!0,children:s.jsxs(oe,{variant:"outline",size:"sm",className:"rounded-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0",children:[s.jsx(Et,{className:"h-4 w-4 mr-1"}),"Days",e.daysOfWeek.length>0&&s.jsx(Be,{variant:"secondary",className:"ml-2 h-5 rounded-full px-2 bg-synth-pink/20 text-synth-pink border-synth-pink/30",children:e.daysOfWeek.length})]})}),s.jsx(ul,{className:"w-80 z-[60] bg-white/95 backdrop-blur-md border border-gray-200/50 rounded-2xl shadow-xl",children:s.jsxs("div",{className:"space-y-4 p-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(oe,{variant:"outline",size:"sm",onClick:G,className:ke("flex-1 text-xs",[0,1,2,3,4].every(ee=>e.daysOfWeek.includes(ee))?"bg-synth-pink text-white hover:bg-synth-pink-dark":"bg-white/80 border-synth-pink/20 hover:border-synth-pink/40"),children:"Weekdays"}),s.jsx(oe,{variant:"outline",size:"sm",onClick:X,className:ke("flex-1 text-xs",[5,6].every(ee=>e.daysOfWeek.includes(ee))?"bg-synth-pink text-white hover:bg-synth-pink-dark":"bg-white/80 border-synth-pink/20 hover:border-synth-pink/40"),children:"Weekend"})]}),s.jsx("div",{className:"grid grid-cols-7 gap-2",children:[{label:"Su",value:0},{label:"M",value:1},{label:"T",value:2},{label:"W",value:3},{label:"Th",value:4},{label:"F",value:5},{label:"Sa",value:6}].map(ee=>s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>Z(ee.value),className:ke("h-10 p-0 text-xs font-medium",e.daysOfWeek.includes(ee.value)?"bg-synth-pink text-white hover:bg-synth-pink-dark border-synth-pink":"bg-white/80 border-gray-300 hover:border-synth-pink/40 hover:bg-synth-pink/10"),children:ee.label},ee.value))}),e.daysOfWeek.length>0&&s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>t(W(M({},e),{daysOfWeek:[]})),className:"w-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40",children:[s.jsx(pr,{className:"h-4 w-4 mr-1"}),"Clear Days"]})]})})]}),s.jsxs(rc,{open:d,onOpenChange:ee=>{u(ee),$({date:ee})},children:[s.jsx(nc,{asChild:!0,children:s.jsxs(oe,{variant:"outline",size:"sm",className:"rounded-full bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0 max-w-[180px]",children:[s.jsx(Et,{className:"h-4 w-4 mr-1 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:K()?(ie=K())==null?void 0:ie.label:e.dateRange.from||e.dateRange.to?ye():"Calendar"}),(e.dateRange.from||e.dateRange.to)&&s.jsx(Be,{variant:"secondary",className:"ml-2 h-5 rounded-full px-2 bg-synth-pink/20 text-synth-pink border-synth-pink/30 flex-shrink-0",children:K()?"Range":"Custom"})]})}),s.jsx(ul,{className:"w-auto p-4 z-[60] bg-white/95 backdrop-blur-md border border-gray-200/50 rounded-2xl shadow-xl",align:"start",children:s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:ne().map(ee=>{var le;const H=((le=K())==null?void 0:le.label)===ee.label;return s.jsxs(oe,{variant:H?"default":"outline",size:"sm",onClick:()=>z(ee.value),className:`text-xs ${H?"bg-synth-pink text-white hover:bg-synth-pink-dark":"bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40"}`,children:[s.jsx(ai,{className:"h-3 w-3 mr-1"}),ee.label]},ee.label)})}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("span",{className:"w-full border-t"})}),s.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:s.jsx("span",{className:"bg-white px-2 text-gray-500",children:"Or select custom dates"})})]}),s.jsx(v1,{initialFocus:!0,mode:"range",defaultMonth:e.dateRange.from||new Date,selected:e.dateRange.from?{from:e.dateRange.from,to:e.dateRange.to||e.dateRange.from}:void 0,onSelect:ee=>{if(ee)if(ee.from&&ee.to&&ee.from.getTime()===ee.to.getTime()){const H=new Date(ee.from);H.setHours(0,0,0,0);const le=new Date(ee.from);le.setHours(23,59,59,999),V({from:H,to:le})}else V(ee)},numberOfMonths:2,disabled:ee=>{const H=new Date;H.setHours(0,0,0,0);const le=new Date(ee);return le.setHours(0,0,0,0),le<H}}),(e.dateRange.from||e.dateRange.to)&&s.jsxs(oe,{variant:"outline",size:"sm",onClick:Y,className:"bg-white/80 backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40",children:[s.jsx(pr,{className:"h-4 w-4 mr-1"}),"Clear Date"]})]})})]}),s.jsxs(oe,{variant:e.filterByFollowing==="following"?"default":"outline",size:"sm",onClick:()=>t(W(M({},e),{filterByFollowing:e.filterByFollowing==="following"?"all":"following"})),className:`rounded-full backdrop-blur-sm border-synth-pink/20 hover:border-synth-pink/40 flex-shrink-0 ${e.filterByFollowing==="following"?"bg-synth-pink text-white":"bg-white/80"}`,children:[s.jsx(Ar,{className:"h-4 w-4 mr-1"}),"Following"]}),se&&s.jsxs(oe,{variant:"ghost",size:"sm",onClick:te,className:"text-muted-foreground hover:text-foreground bg-white/60 backdrop-blur-sm border border-white/20 hover:bg-white/80 flex-shrink-0",children:[s.jsx(pr,{className:"h-4 w-4 mr-1"}),"Clear all"]})]}),se&&s.jsxs("div",{className:"flex flex-wrap gap-2 bg-white/40 backdrop-blur-sm rounded-2xl p-3 border border-white/20",children:[e.genres.map(ee=>s.jsxs(Be,{variant:"secondary",className:"flex items-center gap-1 bg-synth-pink/20 text-synth-pink border-synth-pink/30 hover:bg-synth-pink/30 transition-colors",children:[s.jsx(Ct,{className:"h-3 w-3"}),ee,s.jsx(pr,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>R(ee)})]},ee)),uh(e.selectedCities||[]).map((ee,H)=>s.jsxs(Be,{variant:"secondary",className:"flex items-center gap-1 bg-synth-beige/30 text-synth-black border-synth-beige-dark hover:bg-synth-beige/50 transition-colors",children:[s.jsx(Xt,{className:"h-3 w-3"}),ee,s.jsx(pr,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>t(W(M({},e),{selectedCities:(e.selectedCities||[]).filter(le=>le!==ee)}))})]},`selected-city-${ee}-${H}`)),(e.dateRange.from||e.dateRange.to)&&s.jsxs(Be,{variant:"secondary",className:"flex items-center gap-1 bg-synth-pink/20 text-synth-pink border-synth-pink/30 hover:bg-synth-pink/30 transition-colors",children:[s.jsx(Et,{className:"h-3 w-3"}),ye(),s.jsx(pr,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:Y})]}),e.daysOfWeek.length>0&&s.jsxs(Be,{variant:"secondary",className:"flex items-center gap-1 bg-synth-beige/30 text-synth-black border-synth-beige-dark hover:bg-synth-beige/50 transition-colors",children:[s.jsx(Et,{className:"h-3 w-3"}),e.daysOfWeek.length===7?"All Days":e.daysOfWeek.sort().map(ee=>["Su","M","T","W","Th","F","Sa"][ee]).join(", "),s.jsx(pr,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>t(W(M({},e),{daysOfWeek:[]}))})]})]})]})},ope=({suggestions:e,onUserClick:t,onDismiss:r,onAddFriend:n})=>{const[i,a]=y.useState(new Set);y.useEffect(()=>{E(void 0,null,function*(){if(e.length!==0)try{const{data:{user:d}}=yield P.auth.getUser();if(!d)return;const u=e.map(v=>v.user_id),{data:h,error:f}=yield P.from("user_relationships").select("related_user_id").eq("user_id",d.id).eq("relationship_type","friend").eq("status","pending").in("related_user_id",u);f&&console.error("Error checking sent friend requests:",f);const{data:p,error:x}=yield P.from("user_relationships").select("user_id").eq("related_user_id",d.id).eq("relationship_type","friend").eq("status","pending").in("user_id",u);x&&console.error("Error checking received friend requests:",x);const g=new Set;h&&h.forEach(v=>g.add(v.related_user_id)),p&&p.forEach(v=>g.add(v.user_id)),g.size>0&&a(g)}catch(d){console.error("Error checking friend requests:",d)}})},[e]);const o=c=>E(void 0,null,function*(){var d,u;if(!i.has(c))try{n&&(yield n(c),a(h=>new Set(h).add(c)))}catch(h){console.error("Error sending friend request:",h),((d=h==null?void 0:h.message)!=null&&d.includes("already sent")||(u=h==null?void 0:h.message)!=null&&u.includes("Friend request already sent"))&&a(f=>new Set(f).add(c))}});if(e.length===0)return null;const l=c=>c.split(" ").map(d=>d[0]).join("").toUpperCase().slice(0,2);return s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 px-1",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-synth-black",children:"Who You Should Know"}),s.jsx("p",{className:"text-sm text-synth-black/60",children:"People you may know"})]}),r&&s.jsx(oe,{variant:"ghost",size:"sm",onClick:r,className:"h-8 w-8 p-0",children:s.jsx(pr,{className:"h-4 w-4"})})]}),s.jsxs(Zw,{className:"w-full",children:[s.jsx("div",{className:"flex space-x-4 pb-4 pt-1",children:e.map(c=>{var d;return s.jsxs("div",{className:"flex flex-col items-center min-w-[120px] max-w-[120px] group cursor-pointer",onClick:()=>t==null?void 0:t(c.user_id),children:[s.jsxs("div",{className:"relative mb-2 mt-1",children:[s.jsxs(Vr,{className:"h-16 w-16 ring-2 ring-synth-pink/20 group-hover:ring-synth-pink/40 transition-all",children:[s.jsx(Qr,{src:c.avatar_url||void 0,alt:c.name}),s.jsx(qr,{className:"bg-synth-pink/10 text-synth-pink",children:l(c.name)})]}),c.verified&&s.jsx("div",{className:"absolute -bottom-1 -right-1 bg-synth-pink rounded-full p-0.5",children:s.jsx(kJ,{className:"h-3 w-3 text-white"})})]}),s.jsx("p",{className:"text-sm font-medium text-synth-black text-center truncate w-full mb-1",children:c.name}),s.jsxs("div",{className:"text-xs text-synth-black/60 text-center space-y-0.5",children:[c.mutual_friends_count>0&&s.jsxs("p",{children:[c.mutual_friends_count," mutual friend",c.mutual_friends_count!==1?"s":""]}),((d=c.shared_genres_count)!=null?d:0)>0&&s.jsxs("p",{children:[c.shared_genres_count," shared genre",c.shared_genres_count!==1?"s":""]})]}),n&&s.jsx(oe,{size:"sm",variant:(i.has(c.user_id),"outline"),className:ke("mt-2 h-7 text-xs w-full",i.has(c.user_id)&&"border-synth-pink/30 bg-synth-pink/5"),disabled:i.has(c.user_id),onClick:u=>{u.stopPropagation(),o(c.user_id)},children:i.has(c.user_id)?s.jsxs(s.Fragment,{children:[s.jsx(Gs,{className:"h-3 w-3 mr-1"}),"Requested"]}):s.jsxs(s.Fragment,{children:[s.jsx(Pu,{className:"h-3 w-3 mr-1"}),"Add"]})})]},c.user_id)})}),s.jsx($E,{orientation:"horizontal"})]})]})};function jz(e,t,r,n){const a=ty(r-e),o=ty(n-t),l=Math.sin(a/2)*Math.sin(a/2)+Math.cos(ty(e))*Math.cos(ty(r))*Math.sin(o/2)*Math.sin(o/2),d=3959*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)));return Math.round(d*100)/100}function ty(e){return e*(Math.PI/180)}function Nz(e){if(e.length===0)return[39.8283,-98.5795];if(e.length===1)return e[0];const t=e.reduce((n,[i])=>n+i,0),r=e.reduce((n,[,i])=>n+i,0);return[t/e.length,r/e.length]}function Sz(e,t=.1){if(e.length===0)return{north:40,south:39,east:-97,west:-99};const r=e.map(([i])=>i),n=e.map(([,i])=>i);return{north:Math.max(...r)+t,south:Math.min(...r)-t,east:Math.max(...n)+t,west:Math.min(...n)-t}}function kz(e){const t=e.north-e.south,r=e.east-e.west,n=Math.max(t,r);return n>50?4:n>20?5:n>10?6:n>5?7:n>2?8:n>1?9:n>.5?10:n>.2?11:n>.1?12:n>.05?13:n>.02?14:n>.01?15:16}function aS(e,t,r,n){return e.filter(i=>i.latitude!=null&&i.longitude!=null&&!Number.isNaN(Number(i.latitude))&&!Number.isNaN(Number(i.longitude))).map(i=>{const a=jz(t,r,Number(i.latitude),Number(i.longitude));return W(M({},i),{distance_miles:a})}).filter(i=>i.distance_miles<=n).sort((i,a)=>i.distance_miles-a.distance_miles)}const lpe=Object.freeze(Object.defineProperty({__proto__:null,calculateBounds:Sz,calculateCenter:Nz,calculateDistance:jz,calculateZoomLevel:kz,filterEventsByRadius:aS},Symbol.toStringTag,{value:"Module"}));class y4{static getEventsNearZip(t){return E(this,null,function*(){try{const{zipCode:r,radiusMiles:n=25,limit:i=100}=t;if(!r)throw new Error("Zip code is required");const a=yield this.getZipCoordinates(r);if(!a)return[];const o=n/69,l=n/(69*Math.cos(a.lat*Math.PI/180)),{data:c,error:d}=yield P.from("events").select("*").gte("event_date",new Date().toISOString()).gte("latitude",a.lat-o).lte("latitude",a.lat+o).gte("longitude",a.lng-l).lte("longitude",a.lng+l).not("latitude","is",null).not("longitude","is",null).limit(500);if(d)throw d;const u=(c||[]).map(f=>({id:f.id,jambase_event_id:f.jambase_event_id,title:f.title,artist_name:f.artist_name,artist_id:f.artist_id||"",venue_name:f.venue_name,venue_id:f.venue_id||"",event_date:f.event_date,doors_time:f.doors_time,description:f.description,genres:f.genres,venue_address:f.venue_address,venue_city:f.venue_city,venue_state:f.venue_state,venue_zip:f.venue_zip,latitude:f.latitude,longitude:f.longitude,ticket_available:f.ticket_available,price_range:f.price_range,ticket_urls:f.ticket_urls,setlist:f.setlist,tour_name:f.tour_name,created_at:f.created_at,updated_at:f.updated_at}));return aS(u,a.lat,a.lng,n).slice(0,i)}catch(r){return[]}})}static getEventsNearCity(t){return E(this,null,function*(){try{const{city:r,state:n,radiusMiles:i=25,limit:a=100}=t;if(!r)throw new Error("City is required");const o=yield this.getCityCoordinates(r,n);if(!o)return[];const l=i/69,c=i/(69*Math.cos(o.lat*Math.PI/180)),{data:d,error:u}=yield P.from("events").select("*").gte("event_date",new Date().toISOString()).gte("latitude",o.lat-l).lte("latitude",o.lat+l).gte("longitude",o.lng-c).lte("longitude",o.lng+c).not("latitude","is",null).not("longitude","is",null).limit(500);if(u)throw u;const h=(d||[]).map(p=>({id:p.id,jambase_event_id:p.jambase_event_id,title:p.title,artist_name:p.artist_name,artist_id:p.artist_id||"",venue_name:p.venue_name,venue_id:p.venue_id||"",event_date:p.event_date,doors_time:p.doors_time,description:p.description,genres:p.genres,venue_address:p.venue_address,venue_city:p.venue_city,venue_state:p.venue_state,venue_zip:p.venue_zip,latitude:p.latitude,longitude:p.longitude,ticket_available:p.ticket_available,price_range:p.price_range,ticket_urls:p.ticket_urls,setlist:p.setlist,tour_name:p.tour_name,created_at:p.created_at,updated_at:p.updated_at}));return aS(h,o.lat,o.lng,i).slice(0,a)}catch(r){return[]}})}static getZipsNearCity(t,r,n=25){return E(this,null,function*(){try{let i=P.from("events").select("venue_zip, venue_city, venue_state, latitude, longitude").eq("venue_city",t).gte("event_date",new Date().toISOString()).not("venue_zip","is",null);r&&(i=i.eq("venue_state",r));const{data:a,error:o}=yield i;if(o)throw o;const l=new Map;return(a||[]).forEach(c=>{c.venue_zip&&c.venue_zip!==""&&l.set(c.venue_zip,{zip_code:c.venue_zip,city:c.venue_city,state:c.venue_state,latitude:c.latitude,longitude:c.longitude,distance_miles:0})}),Array.from(l.values())}catch(i){return[]}})}static getZipCoordinates(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("events").select("latitude, longitude").eq("venue_zip",t).not("latitude","is",null).not("longitude","is",null).limit(1).single();if(n)throw n;return r?{lat:Number(r.latitude),lng:Number(r.longitude)}:null}catch(r){return null}})}static getCityCoordinates(t,r){return E(this,null,function*(){var n;try{const i=Ys(t),a=r?r.toLowerCase().trim():null,o=dpe(i,a),l=new Set(o.map(g=>Ys(g)));let c=P.from("city_centers").select("normalized_name, state, center_latitude, center_longitude, aliases, event_count");if(o.length>0){const g=o.map(w=>`normalized_name.ilike.%${w}%`).join(","),v=o.map(w=>`aliases.cs.{${w}}`).join(","),_=[g,v].filter(Boolean).join(",");_&&(c=c.or(_))}const{data:d,error:u}=yield c.limit(10);if(!u&&d&&d.length>0){const v=(n=d.map(_=>({match:_,score:upe(_,l,a)})).sort((_,w)=>w.score-_.score)[0])==null?void 0:n.match;if(v&&v.center_latitude&&v.center_longitude)return{lat:Number(v.center_latitude),lng:Number(v.center_longitude)}}let h=P.from("events").select("latitude, longitude, venue_city, venue_state").ilike("venue_city",`%${i}%`).not("latitude","is",null).not("longitude","is",null);r&&(h=h.ilike("venue_state",`%${r.toLowerCase().trim()}%`));const{data:f,error:p}=yield h.limit(5);if(!p&&f&&f.length>0){const g=f.filter(v=>v.latitude!=null&&v.longitude!=null&&!Number.isNaN(Number(v.latitude))&&!Number.isNaN(Number(v.longitude)));if(g.length>0){const v=g.reduce((w,b)=>w+Number(b.latitude),0)/g.length,_=g.reduce((w,b)=>w+Number(b.longitude),0)/g.length;return{lat:v,lng:_}}}const x=[...o,i];for(const g of x){const v=g.replace(/\s+/g," ").trim();if(v&&this.CITY_COORDINATES[v])return this.CITY_COORDINATES[v]}return null}catch(i){return console.error("Error getting city coordinates:",i),null}})}static searchEventsByLocation(t,r=25,n=100){return E(this,null,function*(){if(/^\d{5}(-\d{4})?$/.test(t.trim()))return this.getEventsNearZip({zipCode:t.trim(),radiusMiles:r,limit:n});{const[a,o]=t.split(",").map(l=>l.trim());return this.getEventsNearCity({city:a,state:o||void 0,radiusMiles:r,limit:n})}})}static getMapConfigForEvents(t,r){const n=t.filter(c=>c.latitude!=null&&c.longitude!=null&&!Number.isNaN(Number(c.latitude))&&!Number.isNaN(Number(c.longitude)));if(n.length===0)return{center:r||[39.8283,-98.5795],zoom:4};if(n.length===1)return{center:[Number(n[0].latitude),Number(n[0].longitude)],zoom:12};const i=n.map(c=>[Number(c.latitude),Number(c.longitude)]),a=Nz(i),o=Sz(i,.05),l=kz(o);return{center:a,zoom:l,bounds:o}}static getEventsNearZipWithRPC(t){return E(this,null,function*(){try{const{zipCode:r,radiusMiles:n=25,limit:i=100}=t;if(!r)throw new Error("Zip code is required");try{const{data:a,error:o}=yield P.rpc("get_events_near_zip_improved",{search_zip:r,radius_miles:n});if(!o&&a)return a.slice(0,i).map(l=>({id:l.id,jambase_event_id:l.jambase_event_id,title:l.title,artist_name:l.artist_name,artist_id:l.artist_id||"",venue_name:l.venue_name,venue_id:l.venue_id||"",event_date:l.event_date,doors_time:l.doors_time,description:l.description,genres:l.genres,venue_address:l.venue_address,venue_city:l.venue_city,venue_state:l.venue_state,venue_zip:l.venue_zip,latitude:l.latitude,longitude:l.longitude,ticket_available:l.ticket_available,price_range:l.price_range,ticket_urls:l.ticket_urls,setlist:l.setlist,tour_name:l.tour_name,created_at:l.created_at,updated_at:l.updated_at,distance_miles:l.distance_miles}))}catch(a){}return this.getEventsNearZip(t)}catch(r){return[]}})}}_r(y4,"CITY_COORDINATES",{washington:{lat:38.9072,lng:-77.0369},"washington dc":{lat:38.9072,lng:-77.0369},"new york":{lat:40.7128,lng:-74.006},"los angeles":{lat:34.0522,lng:-118.2437},chicago:{lat:41.8781,lng:-87.6298},houston:{lat:29.7604,lng:-95.3698},phoenix:{lat:33.4484,lng:-112.074},philadelphia:{lat:39.9526,lng:-75.1652},"san antonio":{lat:29.4241,lng:-98.4936},"san diego":{lat:32.7157,lng:-117.1611},dallas:{lat:32.7767,lng:-96.797},"san jose":{lat:37.3382,lng:-121.8863},austin:{lat:30.2672,lng:-97.7431},jacksonville:{lat:30.3322,lng:-81.6557},"san francisco":{lat:37.7749,lng:-122.4194},columbus:{lat:39.9612,lng:-82.9988},"fort worth":{lat:32.7555,lng:-97.3308},indianapolis:{lat:39.7684,lng:-86.1581},charlotte:{lat:35.2271,lng:-80.8431},seattle:{lat:47.6062,lng:-122.3321},denver:{lat:39.7392,lng:-104.9903},boston:{lat:42.3601,lng:-71.0589},detroit:{lat:42.3314,lng:-83.0458},nashville:{lat:36.1627,lng:-86.7816},portland:{lat:45.5152,lng:-122.6784},"las vegas":{lat:36.1699,lng:-115.1398},memphis:{lat:35.1495,lng:-90.049},louisville:{lat:38.2527,lng:-85.7585},baltimore:{lat:39.2904,lng:-76.6122},milwaukee:{lat:43.0389,lng:-87.9065},albuquerque:{lat:35.0844,lng:-106.6504},tucson:{lat:32.2226,lng:-110.9747},fresno:{lat:36.7378,lng:-119.7871},sacramento:{lat:38.5816,lng:-121.4944},"kansas city":{lat:39.0997,lng:-94.5786},mesa:{lat:33.4152,lng:-111.8315},atlanta:{lat:33.749,lng:-84.388},omaha:{lat:41.2565,lng:-95.9345},"colorado springs":{lat:38.8339,lng:-104.8214},raleigh:{lat:35.7796,lng:-78.6382},miami:{lat:25.7617,lng:-80.1918},"long beach":{lat:33.7701,lng:-118.1937},"virginia beach":{lat:36.8529,lng:-75.978},oakland:{lat:37.8044,lng:-122.2712},minneapolis:{lat:44.9778,lng:-93.265},tulsa:{lat:36.154,lng:-95.9928},arlington:{lat:32.7357,lng:-97.1081},tampa:{lat:27.9506,lng:-82.4572}});const cpe=["district of columbia","city","county","borough","metro area","metropolitan area","municipality","township","parish"];function dpe(e,t){const r=new Set,n=e.replace(/\s+/g," ").trim();n&&r.add(n);const i=t?t.toLowerCase().trim():null;i&&(r.add(i),n.endsWith(i)&&r.add(n.slice(0,-i.length).trim())),cpe.forEach(o=>{n.endsWith(` ${o}`)&&r.add(n.slice(0,-o.length).trim())});const a=n.split(" ").filter(Boolean);return a.length>1&&(r.add(a.slice(0,a.length-1).join(" ")),r.add(a.slice(0,Math.min(a.length,2)).join(" ")),r.add(a[0])),!r.has("washington")&&n.includes("washington")&&(r.add("washington"),r.add("washington dc")),Array.from(r).map(o=>o.replace(/\s+/g," ").trim()).filter(Boolean)}function upe(e,t,r){let n=0;const i=Ys(e.normalized_name||"");t.has(i)&&(n+=50),Array.isArray(e.aliases)&&e.aliases.map(l=>Ys(l)).some(l=>t.has(l))&&(n+=40);const a=e.state?e.state.toLowerCase().trim():null;return r&&a&&(a===r||a===r.replace(/\s+/g,""))&&(n+=20),typeof e.event_count=="number"&&(n+=Math.min(e.event_count,500)),n}const oS=Object.freeze(Object.defineProperty({__proto__:null,RadiusSearchService:y4},Symbol.toStringTag,{value:"Module"})),gA=[39.8283,-98.5795],Dj=["events","reviews","news"],fpe={events:{label:"Events",icon:Et},reviews:{label:"Reviews",icon:Jt},news:{label:"News",icon:Yk}},hpe=({currentUserId:e,onBack:t,onNavigateToNotifications:r,onViewChange:n,onNavigateToProfile:i,onNavigateToChat:a,headerTitle:o,headerSubtitle:l,visibleSections:c,enableMap:d,sectionLayout:u="tabs",onHighlightUpdate:h,embedded:f=!1,showSectionTabs:p=!0})=>{var rx,wp,bf,nx,bp,Ir,sx,zi,Dc,jp,ix;const x=y.useRef(!1);!x.current&&e&&(console.log(" UnifiedFeed initialized:",{currentUserId:e,hasCurrentUserId:!!e,onNavigateToProfile:!!i,onNavigateToChat:!!a}),x.current=!0);const g=y.useMemo(()=>{if(!c||c.length===0)return Dj;const de=c.filter(Ce=>Dj.includes(Ce));return de.length>0?de:Dj},[c]),v=g.length,_=u==="stacked",w=v===1?"grid-cols-1":v===2?"grid-cols-2":"grid-cols-3",b=f,N=b?"w-full":"min-h-screen bg-[#f9fafb]",S=b?{}:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},k=b?"w-full space-y-0":"max-w-4xl mx-auto p-6 space-y-8",O=b?"mb-0":"mb-8",A=o!=null?o:"Feed",T=l!=null?l:"Discover reviews and events from friends and the community",$=A.trim(),R=T.trim(),F=$.length>0,D=R.length>0,B=F||D,U=d!=null?d:!0,[V,Y]=y.useState([]),[z,K]=y.useState(!0),[Z,G]=y.useState(!1),[X,te]=y.useState(!0),[se,ue]=y.useState(!1),[ye,ne]=y.useState(null),[xe,ge]=y.useState(),[ie,ee]=y.useState(!1),[H,le]=y.useState(gA),[Se,ae]=y.useState(!1),{toast:fe}=jr(),{sessionExpired:he}=os(),pe=ci(),[Ae,qe]=y.useState(!1),[Fe,ve]=y.useState(null),[rt,Ve]=y.useState(!1),[lt,ut]=y.useState(null),[Ze,qt]=y.useState(null),[lr,Ge]=y.useState(null),[Le,yt]=y.useState(null);y.useState("review"),y.useState(!1),y.useState(null),y.useState(!1);const[Ne,Oe]=y.useState(!1),[ce,Ee]=y.useState(null),[Qe,vt]=y.useState("relevance"),[wt,Ht]=y.useState("desc"),Rt=typeof window!="undefined"&&localStorage.getItem("feedFilter")==="following"?(localStorage.removeItem("feedFilter"),"following"):"all",[Te,bt]=y.useState(Rt),[$e,Ie]=y.useState({genres:[],selectedCities:[],dateRange:{from:void 0,to:void 0},showFilters:!1,radiusMiles:30,filterByFollowing:Rt,daysOfWeek:[]}),[Ue,dt]=y.useState($e),[be,Re]=y.useState([]),We=y.useRef(!1),St=y.useRef(!1),Ye=y.useRef(null),[ir,jt]=y.useState(0);y.useState({}),y.useState({}),y.useState({}),y.useState({});const[pt,vn]=y.useState(new Set),[Jn,Fs]=y.useState(new Set),[Mt,re]=y.useState(new Set),[_e,Ke]=y.useState(!1),[ht,ct]=y.useState(null),[Pe,et]=y.useState([]),[nt,Me]=y.useState([]),[gt,cr]=y.useState(!1),[Wr,bn]=y.useState(!1),[xn,fn]=y.useState(null),[Bn,ms]=y.useState(!1),[ls,Bt]=y.useState(null),[Pt,It]=y.useState([]),[kt,rr]=y.useState(!1),[mr,Hr]=y.useState("all"),[dn,bi]=y.useState(()=>{var de;return(de=g[0])!=null?de:"events"}),[tr,Gr]=y.useState([]),[Ui,di]=y.useState(!1);y.useEffect(()=>{var de;_||g.includes(dn)||bi((de=g[0])!=null?de:"events")},[g,dn,_]);const[Dr,Ur]=y.useState({open:!1,artist:null}),[jn,zn]=y.useState({open:!1,venueId:null,venueName:""}),[Yr,Ns]=y.useState(!1);y.useEffect(()=>{E(void 0,null,function*(){if(!(!Dr.open||!Dr.artist)&&!(Dr.events&&Dr.events.length>0)){Ns(!0);try{const Ce=Dr.artist.name,{data:tt,error:je}=yield P.from("events").select("*").ilike("artist_name",`%${Ce}%`).order("event_date",{ascending:!0}).limit(200);if(je){console.error("Error fetching events:",je);return}const At=[...(tt||[]).map(Tt=>W(M({},Tt),{source:"manual"}))],Ot=Ta(At);Ot.sort((Tt,vr)=>new Date(Tt.event_date).getTime()-new Date(vr.event_date).getTime()),Ur(Tt=>W(M({},Tt),{events:Ot,totalEvents:Ot.length}))}catch(Ce){console.error("Error fetching artist dialog events:",Ce)}finally{Ns(!1)}}})},[Dr.open,(rx=Dr.artist)==null?void 0:rx.name]);const Ta=de=>{const Ce=new Map;return de.filter(tt=>{var Tt;const je=(tt.artist_name||"").toLowerCase().trim(),Zt=(tt.venue_name||"").toLowerCase().replace(/\s+/g," ").replace(/\bthe\s+/gi,"").replace(/[^\w\s]/g,"").trim(),At=((Tt=tt.event_date)==null?void 0:Tt.split("T")[0])||"",Ot=`${je}|${Zt}|${At}`;return Ce.has(Ot)?(Ce.get(Ot),!1):(Ce.set(Ot,tt),!0)})},qo=()=>E(void 0,null,function*(){rr(!0);try{const de=yield fh.getPersonalizedNews(e);It(de);const Ce=de.filter(tt=>(tt.relevance_score||0)>0).length;fe({title:"News updated",description:Ce>0?`Loaded ${de.length} articles (${Ce} personalized for you)`:`Loaded ${de.length} articles`})}catch(de){console.error("Error fetching news:",de),fe({title:"Error",description:"Failed to load news articles",variant:"destructive"})}finally{rr(!1)}}),Nn=de=>{bi(de),de==="news"&&g.includes("news")&&(fh.clearCache(),qo()),de==="reviews"&&g.includes("reviews")&&Kt()},Kt=()=>E(void 0,null,function*(){if(!(Ui||tr.length>0)){di(!0);try{const de=yield fu.getRecommendedFriends(e,10);Gr(de)}catch(de){console.error("Error loading recommended friends:",de)}finally{di(!1)}}}),Nr=de=>E(void 0,null,function*(){try{const{error:Ce}=yield P.rpc("create_friend_request",{receiver_user_id:de});if(Ce)throw Ce;fe({title:"Friend Request Sent! ",description:"Your friend request has been sent."})}catch(Ce){throw console.error("Error sending friend request:",Ce),fe({title:"Error",description:Ce.message||"Failed to send friend request. Please try again.",variant:"destructive"}),Ce}});y.useEffect(()=>{if(he){K(!1);return}if(!e)return;E(void 0,null,function*(){try{const{data:Ce}=yield P.from("users").select("location_city").eq("user_id",e).maybeSingle();if(Ce!=null&&Ce.location_city&&!St.current){const tt=Ce.location_city.trim();console.log(" User location_city from profile:",tt);let je=tt;try{const Ot=yield q7.getAvailableCities(1,1e3);if(Ot&&Ot.length>0){const Tt=tt.toLowerCase().trim();let vr=Ot.find(Tr=>{var nr;return((nr=Tr.city_name)==null?void 0:nr.toLowerCase().trim())===Tt});vr||(vr=Ot.find(Tr=>{var nr,Kr;return((nr=Tr.city_name)==null?void 0:nr.toLowerCase().includes(Tt))||Tt.includes(((Kr=Tr.city_name)==null?void 0:Kr.toLowerCase())||"")})),!vr&&(Tt.includes("washington")||Tt.includes("dc")||Tt.includes("district"))&&(vr=Ot.find(Tr=>{var Kr;const nr=((Kr=Tr.city_name)==null?void 0:Kr.toLowerCase())||"";return nr.includes("washington")&&(nr.includes("dc")||Tr.state==="DC")||Tr.state==="DC"&&nr.includes("washington")})),!vr&&(Tt==="dc"||Tt==="district of columbia")&&(vr=Ot.find(Tr=>{var nr;return Tr.state==="DC"&&((nr=Tr.city_name)==null?void 0:nr.toLowerCase().includes("washington"))})),vr?(je=typeof vr=="object"&&vr!==null&&"city_name"in vr?vr.city_name:typeof vr=="string"?vr:tt,console.log(" Matched user city to database city:",tt,"",je)):(console.warn(" Could not match user city to available cities. Using raw city name:",tt),je=tt)}}catch(Ot){console.warn(" Could not load available cities. Using raw city name:",Ot),je=tt}console.log(" Auto-applying city filter from profile:",je);const Zt=uh([je]),At={genres:[],selectedCities:Zt,dateRange:{from:void 0,to:void 0},daysOfWeek:[],filterByFollowing:"all",showFilters:!1,radiusMiles:50};if(dt(At),Ie(At),je)try{const Ot=yield y4.getCityCoordinates(je);Ot&&(console.log("Got city coordinates:",Ot),ge(Ot),le([Ot.lat,Ot.lng]))}catch(Ot){console.warn("Could not get city coordinates:",Ot)}We.current=!0,console.log(" Initial load with auto-applied city filter:",je),jt(0),yn(0,!1,!1,At),Promise.all([Qn(),zr(),Rc()]).catch(Ot=>console.warn("Error loading parallel data:",Ot));return}}catch(Ce){console.warn(" Error loading user city from profile:",Ce)}Promise.all([Promise.resolve(yn(0,!1)),Qn(),zr(),Rc(),Kt(),wf()]).catch(Ce=>console.warn("Error loading parallel data:",Ce))})},[he,e]),y.useEffect(()=>{E(void 0,null,function*(){if(xe&&!We.current&&!($e.selectedCities&&$e.selectedCities.length>0))try{const Ce=yield q7.getAvailableCities(1,200);if(!Array.isArray(Ce)||Ce.length===0)return;const tt=Tt=>Tt*(Math.PI/180),je=(Tt,vr,Tr,nr)=>{const cs=tt(Tr-Tt),Qt=tt(nr-vr),Br=Tp(Math.sin(cs/2),2)+Math.cos(tt(Tt))*Math.cos(tt(Tr))*Tp(Math.sin(Qt/2),2);return 2*3959*Math.atan2(Math.sqrt(Br),Math.sqrt(1-Br))};let Zt=Ce[0],At=1/0;for(const Tt of Ce){const vr=je(xe.lat,xe.lng,Number(Tt.center_latitude),Number(Tt.center_longitude));vr<At&&(At=vr,Zt=Tt)}const Ot=Zt.city_name;if(Ot){We.current=!0;const{deduplicateCities:Tt}=yield on(()=>E(void 0,null,function*(){const{deduplicateCities:nr}=yield Promise.resolve().then(()=>aA);return{deduplicateCities:nr}}),void 0,import.meta.url),vr=Tt([Ot]),Tr=W(M({},$e),{selectedCities:vr});Ie(Tr),dt(Tr),jt(0),yn(0,!1)}}catch(Ce){}})},[xe,$e.selectedCities]),y.useEffect(()=>()=>{Ye.current&&clearTimeout(Ye.current)},[]),y.useEffect(()=>{const de=tt=>{const je=tt.detail||{},Zt=je.venueId||je.venueName;Zt&&pe(`/venue/${encodeURIComponent(Zt)}`)},Ce=tt=>E(void 0,null,function*(){const je=tt.detail||{};if(je.artistName){const Zt=je.artistId&&je.artistId!=="manual"?je.artistId:encodeURIComponent(je.artistName);pe(`/artist/${Zt}`)}});return document.addEventListener("open-venue-card",de),document.addEventListener("open-artist-card",Ce),()=>{document.removeEventListener("open-venue-card",de),document.removeEventListener("open-artist-card",Ce)}},[pe]);const zr=()=>E(void 0,null,function*(){if(e){cr(!0);try{const de=yield $a.getUserFollowedArtists(e);et(de.map(tt=>tt.artist_name));const Ce=yield uu.getUserFollowedVenues(e);Me(Ce.map(tt=>({name:tt.venue_name,city:tt.venue_city,state:tt.venue_state})))}catch(de){console.error("Error loading followed data:",de)}finally{cr(!1)}}});y.useEffect(()=>{const de=localStorage.getItem("reopenEventId");if(console.log(" UnifiedFeed: Checking for reopenEventId in localStorage:",de),console.log(" UnifiedFeed: feedItems.length:",V.length),de&&V.length>0){console.log(" UnifiedFeed: Looking for event with id:",de);const Ce=V.find(tt=>{var je;return tt.type==="event"&&((je=tt.event_data)==null?void 0:je.id)===de});console.log(" UnifiedFeed: Found eventItem:",Ce),Ce&&Ce.event_data&&(console.log(" UnifiedFeed: Re-opening modal for event:",Ce.event_data),ve(Ce.event_data),qe(!0),localStorage.removeItem("reopenEventId"))}},[V]),y.useEffect(()=>{(()=>{const Ce=localStorage.getItem("selectedEvent");if(Ce)try{const tt=JSON.parse(Ce);console.log(" UnifiedFeed: Opening event from localStorage:",tt),ve(tt),qe(!0),localStorage.removeItem("selectedEvent")}catch(tt){console.error("Error parsing selectedEvent from localStorage:",tt),localStorage.removeItem("selectedEvent")}})()},[]),y.useEffect(()=>{if(!e||V.length===0)return;const de=V.filter(je=>{var Zt;return je.type==="event"&&((Zt=je.event_data)==null?void 0:Zt.id)});de.length===0||de.map(je=>je.event_data.id).filter(Boolean).filter(je=>!Mt.has(je)).length===0||wf()},[V,e,Mt]);const hn=de=>{const Ce=ui.find(tt=>{var je;return tt.type==="event"&&((je=tt.event_data)==null?void 0:je.id)===de.id});Ce!=null&&Ce.event_data?ve(Ce.event_data):ve(de),qe(!0),ae(!1)},ps=de=>E(void 0,null,function*(){if(!e)return;const Ce=pt.has(de.id),tt=new Set(pt);Ce?tt.delete(de.id):tt.add(de.id),vn(tt);try{yield wn.like(de.type,de.review_id||de.id,!!e)}catch(je){console.error("Error tracking like:",je)}}),ma=de=>E(void 0,null,function*(){const Ce=Jn.has(de.id),tt=new Set(Jn);Ce?tt.delete(de.id):tt.add(de.id),Fs(tt)}),ji=de=>{const Ce=Ws(de),je=Math.floor((new Date().getTime()-Ce.getTime())/1e3);return je<60?`${je}s`:je<3600?`${Math.floor(je/60)}m`:je<86400?`${Math.floor(je/3600)}h`:`${Math.floor(je/86400)}d`};y.useEffect(()=>{const de=()=>{window.innerHeight+document.documentElement.scrollTop>=document.documentElement.offsetHeight-1e3&&!Z&&X&&yn(V.length)};return window.addEventListener("scroll",de),()=>window.removeEventListener("scroll",de)},[Z,X,V.length]);const yn=(de=0,Ce=!1,tt=!1,je)=>E(void 0,null,function*(){try{const Zt=je!=null?je:$e,At=tt?je!=null?je:Ue:Zt,Ot=At.genres&&At.genres.length>0||At.selectedCities&&At.selectedCities.length>0||At.dateRange.from||At.dateRange.to||At.daysOfWeek&&At.daysOfWeek.length>0||At.filterByFollowing==="following",Tt=Ce?0:de;console.log(" loadFeedData called with offset:",Tt,"isRefresh:",Ce,"isFilterUpdate:",tt,"hasActiveFilters:",Ot),tt?(K(!1),G(!0),te(!0)):de===0&&!Ce?(K(!0),Y([]),te(!0)):Ce?K(!0):G(!0);const{deduplicateCities:vr}=yield on(()=>E(void 0,null,function*(){const{deduplicateCities:Yt}=yield Promise.resolve().then(()=>aA);return{deduplicateCities:Yt}}),void 0,import.meta.url),Tr=At.selectedCities&&At.selectedCities.length>0?vr(At.selectedCities):void 0,nr={genres:At.genres&&At.genres.length>0?At.genres:void 0,selectedCities:Tr,dateRange:At.dateRange.from||At.dateRange.to?At.dateRange:void 0,daysOfWeek:At.daysOfWeek&&At.daysOfWeek.length>0?At.daysOfWeek:void 0,filterByFollowing:At.filterByFollowing!=="all"?At.filterByFollowing:void 0,radiusMiles:At.radiusMiles!==void 0?At.radiusMiles:void 0},Kr=nr.genres||nr.selectedCities||nr.dateRange||nr.daysOfWeek||nr.filterByFollowing?nr:void 0,Qt=(yield Aj.getFeedItems({userId:e,limit:20,offset:Tt,includePrivateReviews:!0,filters:Kr})).filter(Yt=>!(Yt.type==="review"&&(Yt.deleted_at||Yt.is_deleted||!Yt.content&&(!Yt.photos||Yt.photos.length===0)||Yt.content==="ATTENDANCE_ONLY"||Yt.content==="[deleted]"||Yt.content==="DELETED")));if(tt)Y(Qt),jt(0);else if(de===0&&!Ce)Y(Qt);else if(Ce)if(Qt.length>0)Y(Qt),jt(0);else{console.log(" Refresh: No items at current offset, resetting to 0..."),jt(0);const ei=(yield Aj.getFeedItems({userId:e,limit:20,offset:0,includePrivateReviews:!0})).filter(ur=>!(ur.type==="review"&&(ur.deleted_at||ur.is_deleted||!ur.content&&(!ur.photos||ur.photos.length===0)||ur.content==="ATTENDANCE_ONLY"||ur.content==="[deleted]"||ur.content==="DELETED")));ei.length>0?(Y(ei),jt(0)):console.warn(" Refresh: No items found even at offset 0, keeping existing feed")}else Y(Yt=>[...Yt,...Qt]);const Br=Qt.filter(Yt=>Yt.type==="event"),yr=Qt.length>=20||Br.length>=20;console.log(` Loaded ${Qt.length} items (${Br.length} events), hasMore: ${yr}`),te(yr)}catch(Zt){if(console.error("Error loading feed data:",Zt),Ce&&V.length===0){console.log(" Refresh failed with no items, retrying from offset 0...");try{const Ot=(yield Aj.getFeedItems({userId:e,limit:20,offset:0,includePrivateReviews:!0})).filter(Tt=>!(Tt.type==="review"&&(Tt.deleted_at||Tt.is_deleted||!Tt.content&&(!Tt.photos||Tt.photos.length===0)||Tt.content==="ATTENDANCE_ONLY"||Tt.content==="[deleted]"||Tt.content==="DELETED")));if(Ot.length>0){Y(Ot),jt(20);return}}catch(At){console.error("Retry also failed:",At)}}fe({title:"Error",description:"Failed to load feed data. Please try again.",variant:"destructive"})}finally{console.log(" Setting loading to false"),K(!1),G(!1)}}),Qn=()=>E(void 0,null,function*(){try{console.log("Loading upcoming events...")}catch(de){console.error("Error loading upcoming events:",de)}}),wf=()=>E(void 0,null,function*(){if(e)try{const{data:de,error:Ce}=yield P.from("user_event_relationships").select("event_id").eq("user_id",e).eq("relationship_type","interested");if(Ce){console.error("Error loading all interested events:",Ce);return}const tt=new Set;de&&de.forEach(je=>{je.event_id&&tt.add(String(je.event_id))}),re(tt),console.log(" Loaded all interested events:",tt.size,"events")}catch(de){console.error("Error loading all interested events:",de)}}),dr=de=>E(void 0,null,function*(){var Ce,tt,je,Zt,At;try{if(de.type==="event"&&de.event_data)try{yield wn.click("share",de.event_data.id,{source:"feed_event_card",artist_name:de.event_data.artist_name,venue_name:de.event_data.venue_name})}catch(Ot){console.error("Error tracking share:",Ot)}if(de.type==="event"&&de.event_data)fn(de.event_data),bn(!0);else if(de.type==="review"){const Ot={id:de.review_id||de.id,user_id:((Ce=de.author)==null?void 0:Ce.id)||e,event_id:de.event_id||"",rating:typeof de.rating=="number"?de.rating:de.artist_performance_rating||0,review_text:de.content||"",is_public:!0,created_at:de.created_at,updated_at:de.updated_at||de.created_at,likes_count:de.likes_count||0,comments_count:de.comments_count||0,shares_count:de.shares_count||0,is_liked_by_user:pt.has(de.id),reaction_emoji:"",photos:de.photos||[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:(tt=de.event_info)==null?void 0:tt.artist_name,artist_id:(je=de.event_info)==null?void 0:je.artist_id,venue_name:(Zt=de.event_info)==null?void 0:Zt.venue_name,venue_id:(At=de.event_info)==null?void 0:At.venue_id};Bt(Ot),ms(!0)}else{const Ot=`Check out this ${de.type}: ${de.title}`;yield navigator.clipboard.writeText(Ot),fe({title:"Shared!",description:"Link copied to clipboard"})}}catch(Ot){console.error("Error sharing item:",Ot)}}),Bi=de=>E(void 0,null,function*(){if(!e||!de.event_data)return;const tt=!Mt.has(de.event_data.id);tt?Mt.add(de.event_data.id):Mt.delete(de.event_data.id),re(new Set(Mt));try{yield Hn.setEventInterest(e,de.event_data.id,tt),fe({title:tt?"You're interested!":"Interest removed",description:tt?"We'll notify you about this event":"You'll no longer receive notifications for this event"})}catch(je){console.error("Error toggling interest:",je),tt?Mt.delete(de.event_data.id):Mt.add(de.event_data.id),re(new Set(Mt)),fe({title:"Error",description:"Failed to update interest",variant:"destructive"})}}),cn=de=>[...de].sort((Ce,tt)=>{var Zt,At,Ot,Tt;let je=0;switch(Qe){case"date":{const nr=Ce.type==="event"&&((Zt=Ce.event_data)!=null&&Zt.event_date)?new Date(Ce.event_data.event_date).getTime():new Date(Ce.created_at).getTime(),Kr=tt.type==="event"&&((At=tt.event_data)!=null&&At.event_date)?new Date(tt.event_data.event_date).getTime():new Date(tt.created_at).getTime();je=nr-Kr;break}case"price":{const nr=Ol(Ce),Kr=Ol(tt);je=nr-Kr;break}case"popularity":{const nr=(Ce.likes_count||0)+(Ce.comments_count||0)+(Ce.shares_count||0),Kr=(tt.likes_count||0)+(tt.comments_count||0)+(tt.shares_count||0);je=nr-Kr;break}case"distance":{const nr=Ce.distance_miles||1/0,Kr=tt.distance_miles||1/0;je=nr-Kr;break}case"relevance":default:const vr=(Ot=Ce.relevance_score)!=null?Ot:0,Tr=(Tt=tt.relevance_score)!=null?Tt:0;je=vr-Tr;break}return wt==="asc"?je:-je}),Rc=()=>E(void 0,null,function*(){try{const{data:de,error:Ce}=yield P.from("events").select("venue_city").not("venue_city","is",null);if(Ce)throw Ce;const tt=Array.from(new Set((de||[]).map(je=>je.venue_city.trim()).filter(Boolean))).sort();Re(tt)}catch(de){console.error("Failed to load cities:",de),Re([])}}),Mc=y.useMemo(()=>{const de=new Set;return V.forEach(Ce=>{var tt;Ce.type==="event"&&((tt=Ce.event_data)!=null&&tt.genres)&&Ce.event_data.genres.forEach(je=>de.add(je))}),Array.from(de).sort()},[V]),Tl=y.useMemo(()=>{let de=[...V];if($e.filterByFollowing==="following"){const Ce=de.filter(Zt=>Zt.type==="event"),tt=de.filter(Zt=>Zt.type!=="event");return[...Ce.filter(Zt=>{if(!Zt.event_data)return!1;const At=Zt.event_data;return At.artist_name&&Pe.includes(At.artist_name)?!0:At.venue_name?nt.some(Ot=>Ot.name===At.venue_name&&(!Ot.city||Ot.city===At.venue_city)&&(!Ot.state||Ot.state===At.venue_state)):!1}),...tt]}return de},[V,$e.filterByFollowing,Pe,nt]);y.useEffect(()=>{dt($e)},[$e]);const Ol=de=>{var Ce;return de.type==="event"&&((Ce=de.event_data)!=null&&Ce.price_range)?Dde(de.event_data.price_range):0},ui=y.useMemo(()=>cn(Tl),[Tl,Qe,wt]),Wo=y.useMemo(()=>ui.filter(de=>de.type==="event"&&!!de.event_data).map(de=>{var Zt,At,Ot,Tt,vr,Tr,nr,Kr,cs,Qt,Br,En,yr,Yt,ei,ur,un,Np,Sp,Wd,Ho,ax,Ic,Ni,kp;const Ce=de.event_data,tt=Ce.latitude!=null?Number(Ce.latitude):void 0,je=Ce.longitude!=null?Number(Ce.longitude):void 0;return{id:Ce.id,jambase_event_id:(Zt=Ce.jambase_event_id)!=null?Zt:Ce.id,title:(Ot=(At=Ce.title)!=null?At:Ce.artist_name)!=null?Ot:"Untitled Event",artist_name:(Tt=Ce.artist_name)!=null?Tt:"",artist_id:(vr=Ce.artist_id)!=null?vr:"",venue_name:(Tr=Ce.venue_name)!=null?Tr:"",venue_id:(nr=Ce.venue_id)!=null?nr:"",event_date:Ce.event_date,doors_time:Ce.doors_time,description:Ce.description,genres:(Kr=Ce.genres)!=null?Kr:[],venue_address:Ce.venue_address,venue_city:Ce.venue_city,venue_state:Ce.venue_state,venue_zip:Ce.venue_zip,latitude:tt,longitude:je,ticket_available:Ce.ticket_available,price_range:Ce.price_range,ticket_urls:(cs=Ce.ticket_urls)!=null?cs:Ce.ticket_url?[Ce.ticket_url]:[],poster_image_url:(Qt=Ce.poster_image_url)!=null?Qt:null,setlist:(Br=Ce.setlist)!=null?Br:null,setlist_enriched:(En=Ce.setlist_enriched)!=null?En:!1,setlist_song_count:(yr=Ce.setlist_song_count)!=null?yr:null,setlist_fm_id:(Yt=Ce.setlist_fm_id)!=null?Yt:null,setlist_fm_url:(ei=Ce.setlist_fm_url)!=null?ei:null,setlist_source:(ur=Ce.setlist_source)!=null?ur:null,setlist_last_updated:(un=Ce.setlist_last_updated)!=null?un:null,tour_name:(Np=Ce.tour_name)!=null?Np:null,created_at:(Sp=Ce.created_at)!=null?Sp:null,updated_at:(Wd=Ce.updated_at)!=null?Wd:null,is_promoted:(Ho=Ce.is_promoted)!=null?Ho:!1,promotion_tier:(ax=Ce.promotion_tier)!=null?ax:null,active_promotion_id:(Ic=Ce.active_promotion_id)!=null?Ic:null,ticket_price_min:(Ni=Ce.ticket_price_min)!=null?Ni:null,ticket_price_max:(kp=Ce.ticket_price_max)!=null?kp:null}}).filter(de=>typeof de.latitude=="number"&&typeof de.longitude=="number"),[ui]),qd=Wo.length>1?6:9,gs=y.useMemo(()=>{var je,Zt,At,Ot;const de=ui.find(Tt=>Tt.type==="event"&&!!Tt.event_data);if(!de||!de.event_data)return null;const Ce=de.event_data,tt=Ce.poster_image_url||(Array.isArray(Ce.images)?(je=Ce.images.find(Tt=>Tt==null?void 0:Tt.url))==null?void 0:je.url:void 0)||null;return{eventId:Ce.id||de.id,title:Ce.title||de.title||Ce.artist_name||"Upcoming Event",artistName:Ce.artist_name||((Zt=de.event_info)==null?void 0:Zt.artist_name),venueName:Ce.venue_name||((At=de.event_info)==null?void 0:At.venue_name),eventDate:Ce.event_date||((Ot=de.event_info)==null?void 0:Ot.event_date),imageUrl:tt,distanceMiles:de.distance_miles,eventData:Ce}},[ui]);y.useEffect(()=>{h&&h(gs)},[gs,h]),y.useEffect(()=>{if(Se)return;const de=Wo.find(Ce=>typeof Ce.latitude=="number"&&typeof Ce.longitude=="number");de&&typeof de.latitude=="number"&&typeof de.longitude=="number"?le([de.latitude,de.longitude]):le(gA)},[Wo,Se]);const Rl=y.useMemo(()=>ui.filter(de=>de.type==="event").map((de,Ce)=>{var tt,je,Zt,At,Ot;return{id:((tt=de.event_data)==null?void 0:tt.id)||de.id,metadata:{source:"feed",position:Ce,feed_tab:dn,feed_type:Te,artist_name:((je=de.event_data)==null?void 0:je.artist_name)||((Zt=de.event_info)==null?void 0:Zt.artist_name),venue_name:((At=de.event_data)==null?void 0:At.venue_name)||((Ot=de.event_info)==null?void 0:Ot.venue_name),distance_miles:de.distance_miles,relevance_score:de.relevance_score}}}),[ui,dn,Te]),ex=Bue("event",Rl,{threshold:.5,trackOnce:!0,debounce:500}),tx=({item:de})=>{var je,Zt;const[Ce,tt]=y.useState(null);return y.useEffect(()=>{E(void 0,null,function*(){var At,Ot,Tt;try{if(Array.isArray(de.photos)&&de.photos.length>0){console.log("ReviewHeroImage: Using item photos:",de.photos[0]),tt(de.photos[0]);return}const vr=((At=de.event_info)==null?void 0:At.artist_name)||"";if(!vr){console.log("ReviewHeroImage: No artist name, setting null"),tt(null);return}const{data:Tr}=yield P.from("events").select("id").ilike("artist_name",`%${vr}%`).limit(20);if(Tr&&Tr.length>0){const nr=Tr.map(Qt=>Qt.id),Kr=yield P.from("reviews").select("photos").not("photos","is",null).in("event_id",nr).order("likes_count",{ascending:!1}).limit(1),cs=Array.isArray(Kr.data)&&((Tt=(Ot=Kr.data[0])==null?void 0:Ot.photos)==null?void 0:Tt[0]);if(cs){console.log("ReviewHeroImage: Using artist review photo:",cs),tt(cs);return}}tt(null)}catch(vr){console.error("ReviewHeroImage: Error resolving image:",vr),tt(null)}})},[de.id,de.photos,(je=de.event_info)==null?void 0:je.artist_name]),Ce?s.jsx("div",{className:"h-44 w-full overflow-hidden rounded-t-lg",children:s.jsx("img",{src:Ce,alt:((Zt=de.event_info)==null?void 0:Zt.event_name)||de.title,className:"w-full h-full object-cover",loading:"lazy"})}):null};return z?(console.log(" Showing skeleton loading state"),s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6 w-full",children:[s.jsx(_j,{}),s.jsx(_j,{}),s.jsx(_j,{})]})})):s.jsxs("div",{className:N,style:S,children:[s.jsxs("div",{className:k,children:[B&&s.jsx("div",{className:O,children:s.jsxs("div",{children:[F&&s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:$}),D&&s.jsx("p",{className:"text-gray-600 mt-2",children:R})]})}),s.jsxs(Cl,{value:dn,onValueChange:de=>Nn(de),children:[p!==!1&&s.jsx(Fo,{className:`grid w-full ${b?"mb-1 mt-0":"mb-6"} bg-white/60 backdrop-blur-sm border border-white/20 rounded-2xl p-1 ${w}`,children:g.map(de=>{const{label:Ce,icon:tt}=fpe[de];return s.jsxs(Tn,{value:de,className:"flex items-center gap-2 data-[state=active]:bg-synth-pink data-[state=active]:text-white rounded-xl",children:[s.jsx(tt,{className:"w-4 h-4"}),Ce]},de)})}),dn==="events"&&g.includes("events")&&s.jsxs("div",{className:`${b?"mb-1 pt-0":"mb-6"} flex flex-col gap-2 md:flex-row md:items-center md:justify-between`,children:[s.jsx("div",{className:`${b?"flex-1":"md:flex-1"}`,children:s.jsx(ape,{filters:Ue,onFiltersChange:de=>{console.log(" Filter change detected:",de),St.current=!0,We.current=!0,dt(de),Ye.current&&clearTimeout(Ye.current),Ye.current=setTimeout(()=>{console.log(" Applying debounced filters, regenerating personalized feed..."),Ie(de),jt(0),e&&yn(0,!1,!0,de)},400)},availableGenres:Mc,availableCities:be,onOverlayChange:de=>dt(Ce=>W(M({},Ce),{showFilters:de})),className:b?"space-y-0":""})}),b&&r&&a&&s.jsx("div",{className:"flex items-center gap-2 flex-shrink-0 -mt-1",children:s.jsx(mce,{currentUserId:e,onNavigateToNotifications:r,onNavigateToChat:a,className:"flex-shrink-0"})}),!b&&U&&s.jsxs(oe,{variant:"outline",size:"sm",className:"md:self-start",onClick:()=>ae(!0),disabled:Wo.length===0,children:[s.jsx(YJ,{className:"h-4 w-4 mr-2"}),"Map View"]})]}),g.includes("events")&&s.jsxs(On,{value:"events",className:"mt-0 space-y-4",children:[s.jsx("div",{className:"space-y-4",children:ui.filter(de=>de.type==="event").map((de,Ce)=>{var tt,je,Zt,At,Ot,Tt,vr,Tr,nr,Kr,cs;return s.jsx(He,{className:ke("cursor-pointer overflow-hidden group",((tt=de.event_data)==null?void 0:tt.is_promoted)&&"ring-2 ring-yellow-400/50 shadow-lg shadow-yellow-200/30 border-yellow-200/50"),ref:Qt=>{var Br;return Qt&&ex(Qt,((Br=de.event_data)==null?void 0:Br.id)||de.id)},"data-tour":Ce===0?"event-card":void 0,onClick:Qt=>E(void 0,null,function*(){if(!Qt.defaultPrevented&&de.event_data){const{PromotionTrackingService:Br}=yield on(()=>E(void 0,null,function*(){const{PromotionTrackingService:En}=yield Promise.resolve().then(()=>tue);return{PromotionTrackingService:En}}),void 0,import.meta.url);Br.trackPromotionInteraction(de.event_data.id,e,"click",{source:"feed_event_card_click",artist_name:de.event_data.artist_name,venue_name:de.event_data.venue_name}),ve(de.event_data);try{const En=yield Hn.isUserInterested(e,de.event_data.id);Ve(En)}catch(En){Ve(!1)}qe(!0)}}),children:s.jsxs(st,{className:"p-6",children:[de.type!=="event"&&s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Vr,{className:"w-10 h-10 ring-2 ring-synth-pink/20",children:[s.jsx(Qr,{src:((je=de.author)==null?void 0:je.avatar_url)||void 0}),s.jsx(qr,{className:"text-sm font-semibold bg-synth-pink/10 text-synth-pink",children:((At=(Zt=de.author)==null?void 0:Zt.name)==null?void 0:At.split(" ").map(Qt=>Qt[0]).join(""))||"U"})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-sm text-gray-900",children:((Ot=de.author)==null?void 0:Ot.name)||"Anonymous"}),s.jsx("p",{className:"text-xs text-gray-500",children:de.type.charAt(0).toUpperCase()+de.type.slice(1)})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(Be,{className:"synth-badge text-xs",children:[s.jsx(Et,{className:"w-3 h-3 mr-1"}),de.type.charAt(0).toUpperCase()+de.type.slice(1)]})})]}),s.jsx("div",{className:"mb-4",children:s.jsx(tx,{item:de})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h2",{className:"font-bold text-lg text-gray-900",children:de.title}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(che,{followedArtists:Pe,followedVenues:nt,artistName:(Tt=de.event_data)==null?void 0:Tt.artist_name,venueName:(vr=de.event_data)==null?void 0:vr.venue_name,venueCity:(Tr=de.event_data)==null?void 0:Tr.venue_city,venueState:(nr=de.event_data)==null?void 0:nr.venue_state}),((Kr=de.event_data)==null?void 0:Kr.is_promoted)&&((cs=de.event_data)==null?void 0:cs.promotion_tier)&&s.jsx(eF,{promotionTier:de.event_data.promotion_tier})]})]}),de.event_data&&s.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"w-4 h-4 text-synth-pink"}),s.jsx("span",{children:de.event_data.venue_name}),de.event_data.venue_city&&s.jsxs("span",{className:"text-gray-500",children:[" ",de.event_data.venue_city]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Et,{className:"w-4 h-4 text-synth-pink"}),s.jsx("span",{children:Dt(Ws(de.event_data.event_date),"EEEE, MMMM d, yyyy")})]}),(()=>{var Yt,ei;const Qt=de.event_data,Br=Qt==null?void 0:Qt.price_range,En=(Yt=Qt==null?void 0:Qt.ticket_price_min)!=null?Yt:Qt==null?void 0:Qt.price_min,yr=(ei=Qt==null?void 0:Qt.ticket_price_max)!=null?ei:Qt==null?void 0:Qt.price_max;if(Br||En||yr){let ur="";return Br?ur=bg(Br):En&&yr?ur=`$${En} - $${yr}`:En?ur=`$${En}+`:yr&&(ur=`Up to $${yr}`),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(xc,{className:"w-4 h-4 text-synth-pink"}),s.jsx("span",{className:"font-medium",children:ur})]})}return null})()]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[de.type==="event"&&de.event_data?s.jsxs("button",{onClick:Qt=>{Qt.stopPropagation(),Bi(de)},className:`flex items-center gap-1 text-sm transition-colors px-3 py-1 rounded-md ${Mt.has(de.event_data.id)?"bg-pink-500 text-white hover:bg-pink-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[s.jsx(hs,{className:`w-4 h-4 ${Mt.has(de.event_data.id)?"fill-current":""}`}),s.jsx("span",{children:Mt.has(de.event_data.id)?"Interested":"I'm Interested"})]}):s.jsxs("button",{onClick:Qt=>{Qt.stopPropagation(),ps(de)},className:`flex items-center gap-1 text-sm transition-colors ${pt.has(de.id)?"text-red-500":"text-gray-500 hover:text-red-500"}`,children:[s.jsx(hs,{className:`w-4 h-4 ${pt.has(de.id)?"fill-current":""}`}),s.jsx("span",{children:de.likes_count||0})]}),s.jsxs("button",{onClick:Qt=>{var Br;Qt.stopPropagation(),ut(((Br=de.event_data)==null?void 0:Br.id)||de.id)},className:"flex items-center gap-1 text-sm text-gray-500 hover:text-blue-500 transition-colors",children:[s.jsx(Wn,{className:"w-4 h-4"}),s.jsx("span",{children:de.comments_count||0})]}),s.jsxs("button",{onClick:Qt=>{Qt.stopPropagation(),dr(de)},className:"flex items-center gap-1 text-sm text-gray-500 hover:text-green-500 transition-colors",children:[s.jsx(Vu,{className:"w-4 h-4"}),s.jsx("span",{children:"Share"})]})]}),s.jsx("div",{className:"text-xs text-gray-400",children:ji(de.created_at)})]})]})]})},`event-${de.id}-${Ce}`)})}),V.length>0&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-6 mt-6",children:[!X&&s.jsx("p",{className:"text-gray-500 text-sm mb-3",children:"You're all caught up! "}),s.jsx(oe,{onClick:()=>yn(V.length),disabled:Z||!X,className:ke("text-white shadow-lg px-6 py-2",X?"bg-synth-pink hover:bg-synth-pink-dark":"bg-gray-400 cursor-not-allowed"),children:Z?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"h-4 w-4 mr-2 animate-spin"}),"Loading more events..."]}):X?s.jsx(s.Fragment,{children:"Load more (20 events)"}):s.jsx(s.Fragment,{children:"You're all caught up"})})]})]}),g.includes("reviews")&&s.jsx(On,{value:"reviews",className:"mt-6",children:V.filter(de=>de.type==="review"&&!de.deleted_at&&!de.is_deleted).length===0?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Jt,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No reviews yet"}),s.jsx("p",{className:"text-gray-500",children:"Be the first to share a concert review!"})]})}):s.jsx("div",{className:"space-y-6",children:(()=>{const de=V.filter(je=>je.type==="review"&&!je.deleted_at&&!je.is_deleted),Ce=de.slice(0,3),tt=de.slice(3);return s.jsxs(s.Fragment,{children:[Ce.map((je,Zt)=>{var At,Ot,Tt,vr,Tr,nr,Kr,cs,Qt,Br,En;return console.log(" Review item author data:",{id:je.id,authorName:(At=je.author)==null?void 0:At.name,avatarUrl:(Ot=je.author)==null?void 0:Ot.avatar_url,authorId:(Tt=je.author)==null?void 0:Tt.id,fullAuthor:je.author}),s.jsx(L2,{review:{id:je.review_id||je.id,user_id:((vr=je.author)==null?void 0:vr.id)||e,event_id:je.event_id||"",rating:typeof je.rating=="number"?je.rating:(Tr=typeof je.rating=="string"?parseFloat(je.rating):null)!=null?Tr:0,review_text:je.content||"",is_public:!0,created_at:je.created_at,updated_at:je.updated_at||je.created_at,likes_count:je.likes_count||0,comments_count:je.comments_count||0,shares_count:je.shares_count||0,is_liked_by_user:pt.has(je.id),reaction_emoji:je.reaction_emoji||"",photos:je.photos||[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:(nr=je.event_info)==null?void 0:nr.artist_name,venue_name:(Kr=je.event_info)==null?void 0:Kr.venue_name,artist_performance_rating:je.artist_performance_rating,production_rating:je.production_rating,venue_rating:je.venue_rating,location_rating:je.location_rating,value_rating:je.value_rating,artist_performance_feedback:je.artist_performance_feedback,production_feedback:je.production_feedback,venue_feedback:je.venue_feedback,location_feedback:je.location_feedback,value_feedback:je.value_feedback,ticket_price_paid:je.ticket_price_paid,setlist:je.setlist,custom_setlist:je.custom_setlist,connection_degree:je.connection_degree,connection_type_label:je.connection_type_label},currentUserId:e,onLike:(yr,Yt)=>{console.log(" BelliStyle onLike:",{reviewId:yr,isLiked:Yt,itemId:je.id}),vn(Yt?ei=>new Set([...ei,je.id]):ei=>{const ur=new Set(ei);return ur.delete(je.id),ur})},onComment:()=>qt(je.review_id||je.id),onShare:yr=>{dr(je)},onEdit:()=>{console.log("Edit button clicked for review:",je.review_id||je.id),console.log("Full item data:",je),E(void 0,null,function*(){try{const{data:Yt,error:ei}=yield P.from("reviews").select(`
                              *,
                              events!inner (
                                id,
                                title,
                                artist_name,
                                artist_id,
                                venue_name,
                                venue_id,
                                venue_city,
                                venue_state,
                                venue_zip,
                                venue_address,
                                event_date,
                                doors_time,
                                description,
                                genres,
                                price_range,
                                ticket_urls,
                                setlist
                              )
                            `).eq("id",je.review_id||je.id).single();if(ei){console.error("Error fetching review:",ei);return}if(Yt&&Yt.events){const ur=Yt.events,un=Yt;console.log(" Setting up edit modal with event data:",{eventId:ur.id,artistName:ur.artist_name,venueName:ur.venue_name,hasSetlist:!!ur.setlist,reviewId:un.id}),ne({id:ur.id,jambase_event_id:ur.jambase_event_id,title:ur.title||"Concert Review",artist_name:ur.artist_name,artist_id:ur.artist_id,venue_name:ur.venue_name,venue_id:ur.venue_id,event_date:ur.event_date,doors_time:ur.doors_time,description:ur.description,genres:ur.genres,venue_city:ur.venue_city,venue_state:ur.venue_state,venue_zip:ur.venue_zip,venue_address:ur.venue_address,price_range:ur.price_range,ticket_urls:ur.ticket_urls,setlist:ur.setlist,existing_review_id:un.id,existing_review:{rating:un.rating,review_text:un.review_text,artist_performance_rating:un.artist_performance_rating,production_rating:un.production_rating,venue_rating:un.venue_rating,location_rating:un.location_rating,value_rating:un.value_rating,artist_performance_feedback:un.artist_performance_feedback,production_feedback:un.production_feedback,venue_feedback:un.venue_feedback,location_feedback:un.location_feedback,value_feedback:un.value_feedback,ticket_price_paid:un.ticket_price_paid,reaction_emoji:un.reaction_emoji,is_public:un.is_public,review_type:un.review_type,photos:un.photos,custom_setlist:un.custom_setlist,selectedSetlist:ur.setlist,venue_tags:un.venue_tags,artist_tags:un.artist_tags,mood_tags:un.mood_tags,genre_tags:un.genre_tags,context_tags:un.context_tags}}),ue(!0)}}catch(Yt){console.error("Error loading review data for edit:",Yt)}})},onDelete:yr=>E(void 0,null,function*(){try{yield fs.deleteEventReview(e,yr),yn(0),fe({title:"Review Deleted",description:"Your review has been deleted."})}catch(Yt){console.error("Error deleting review:",Yt),fe({title:"Error",description:"Failed to delete review.",variant:"destructive"})}}),onReport:()=>yt(je.id),userProfile:{name:((cs=je.author)==null?void 0:cs.name)||"User",avatar_url:((Qt=je.author)==null?void 0:Qt.avatar_url)||void 0,verified:(Br=je.author)==null?void 0:Br.verified,account_type:(En=je.author)==null?void 0:En.account_type},followedArtists:Pe,followedVenues:nt},`${je.id}-${Zt}`)}),tr.length>0&&s.jsx(ope,{suggestions:tr,onUserClick:je=>i==null?void 0:i(je),onAddFriend:Nr}),tt.map((je,Zt)=>{var At,Ot,Tt,vr,Tr,nr,Kr,cs;return s.jsx(L2,{review:{id:je.review_id||je.id,user_id:((At=je.author)==null?void 0:At.id)||e,event_id:je.event_id||"",rating:typeof je.rating=="number"?je.rating:(Ot=typeof je.rating=="string"?parseFloat(je.rating):null)!=null?Ot:0,review_text:je.content||"",is_public:!0,created_at:je.created_at,updated_at:je.updated_at||je.created_at,likes_count:je.likes_count||0,comments_count:je.comments_count||0,shares_count:je.shares_count||0,is_liked_by_user:pt.has(je.id),reaction_emoji:je.reaction_emoji||"",photos:je.photos||[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:(Tt=je.event_info)==null?void 0:Tt.artist_name,venue_name:(vr=je.event_info)==null?void 0:vr.venue_name,artist_performance_rating:je.artist_performance_rating,production_rating:je.production_rating,venue_rating:je.venue_rating,location_rating:je.location_rating,value_rating:je.value_rating,artist_performance_feedback:je.artist_performance_feedback,production_feedback:je.production_feedback,venue_feedback:je.venue_feedback,location_feedback:je.location_feedback,value_feedback:je.value_feedback,ticket_price_paid:je.ticket_price_paid,setlist:je.setlist,custom_setlist:je.custom_setlist,connection_degree:je.connection_degree,connection_type_label:je.connection_type_label},currentUserId:e,onLike:(Qt,Br)=>{vn(Br?En=>new Set([...En,je.id]):En=>{const yr=new Set(En);return yr.delete(je.id),yr})},onComment:()=>qt(je.review_id||je.id),onShare:Qt=>dr(je),onEdit:()=>{E(void 0,null,function*(){try{const{data:Br,error:En}=yield P.from("reviews").select(`
                                    *,
                                    events!inner (
                                      id, title, artist_name, artist_id, venue_name, venue_id,
                                      venue_city, venue_state, venue_zip, venue_address,
                                      event_date, doors_time, description, genres,
                                      price_range, ticket_urls, setlist
                                    )
                                  `).eq("id",je.review_id||je.id).single();if(En||!Br||!Br.events)return;const yr=Br.events,Yt=Br;ne({id:yr.id,jambase_event_id:yr.jambase_event_id,title:yr.title||"Concert Review",artist_name:yr.artist_name,artist_id:yr.artist_id,venue_name:yr.venue_name,venue_id:yr.venue_id,event_date:yr.event_date,doors_time:yr.doors_time,description:yr.description,genres:yr.genres,venue_city:yr.venue_city,venue_state:yr.venue_state,venue_zip:yr.venue_zip,venue_address:yr.venue_address,price_range:yr.price_range,ticket_urls:yr.ticket_urls,setlist:yr.setlist,existing_review_id:Yt.id,existing_review:{rating:Yt.rating,review_text:Yt.review_text,artist_performance_rating:Yt.artist_performance_rating,production_rating:Yt.production_rating,venue_rating:Yt.venue_rating,location_rating:Yt.location_rating,value_rating:Yt.value_rating,artist_performance_feedback:Yt.artist_performance_feedback,production_feedback:Yt.production_feedback,venue_feedback:Yt.venue_feedback,location_feedback:Yt.location_feedback,value_feedback:Yt.value_feedback,ticket_price_paid:Yt.ticket_price_paid,reaction_emoji:Yt.reaction_emoji,is_public:Yt.is_public,review_type:Yt.review_type,photos:Yt.photos,custom_setlist:Yt.custom_setlist,selectedSetlist:yr.setlist,venue_tags:Yt.venue_tags,artist_tags:Yt.artist_tags,mood_tags:Yt.mood_tags,genre_tags:Yt.genre_tags,context_tags:Yt.context_tags}}),ue(!0)}catch(Br){console.error("Error loading review data for edit:",Br)}})},onDelete:Qt=>E(void 0,null,function*(){try{yield fs.deleteEventReview(e,Qt),yn(0),fe({title:"Review Deleted",description:"Your review has been deleted."})}catch(Br){console.error("Error deleting review:",Br),fe({title:"Error",description:"Failed to delete review.",variant:"destructive"})}}),onReport:()=>yt(je.id),userProfile:{name:((Tr=je.author)==null?void 0:Tr.name)||"User",avatar_url:((nr=je.author)==null?void 0:nr.avatar_url)||void 0,verified:(Kr=je.author)==null?void 0:Kr.verified,account_type:(cs=je.author)==null?void 0:cs.account_type},followedArtists:Pe,followedVenues:nt},`${je.id}-${Zt+3}`)})]})})()})}),g.includes("news")&&s.jsxs(On,{value:"news",className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Music News"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("select",{value:mr,onChange:de=>Hr(de.target.value),className:"px-3 py-1 text-sm border border-gray-200 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-pink-500",children:[s.jsx("option",{value:"all",children:"All Sources"}),s.jsx("option",{value:"pitchfork",children:"Pitchfork"}),s.jsx("option",{value:"rollingstone",children:"Rolling Stone"}),s.jsx("option",{value:"nme",children:"NME"}),s.jsx("option",{value:"billboard",children:"Billboard"})]}),s.jsx(oe,{onClick:()=>{fh.clearCache(),qo()},variant:"outline",size:"sm",disabled:kt,className:"text-pink-600 border-pink-200 hover:bg-pink-50",children:kt?s.jsx("div",{className:"w-4 h-4 animate-spin rounded-full border-2 border-pink-500 border-t-transparent"}):"Refresh"})]})]}),kt&&Pt.length===0&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((de,Ce)=>s.jsx(ahe,{},Ce))}),!kt&&Pt.length>0&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:fh.filterBySource(Pt,mr).map(de=>s.jsx(ihe,{article:de},de.id))}),!kt&&Pt.length===0&&s.jsx(Doe,{icon:s.jsx(Yk,{className:"w-12 h-12 text-gray-400"}),title:"No news articles found",description:"Check back later for the latest music news and updates!"})]})]}),U&&s.jsx(tn,{open:Se,onOpenChange:ae,children:s.jsxs(Xr,{className:"sm:max-w-[900px] w-full h-[80vh]",children:[s.jsxs(Mn,{children:[s.jsx(an,{children:"Events Map"}),s.jsx(Kn,{children:"Explore upcoming events from your feed on an interactive map."})]}),Wo.length>0?s.jsx("div",{className:"h-[calc(80vh-120px)] w-full",children:s.jsx(eB,{center:H,zoom:qd,events:Wo,onEventClick:hn,onMapCenterChange:de=>le(de)})}):s.jsx("div",{className:"flex h-[calc(80vh-120px)] items-center justify-center rounded-lg border border-dashed border-muted-foreground/40",children:s.jsx("p",{className:"px-6 text-center text-sm text-muted-foreground",children:"No events in your feed have location data yet. Try adjusting your filters or check back soon."})})]})})]}),s.jsx("div",{style:{height:"0px"}}),se&&s.jsx(MF,{isOpen:se,onClose:()=>ue(!1),event:ye,userId:e,onReviewSubmitted:()=>{ue(!1),yn()}}),Ae&&Fe&&s.jsx(Cc,{isOpen:Ae,onClose:()=>qe(!1),event:Fe,currentUserId:e,onReview:()=>{Fe&&(ne(Fe),ue(!0))},onInterestToggle:(de,Ce)=>E(void 0,null,function*(){try{yield Hn.setEventInterest(e,de,Ce),Ve(Ce),Y(tt=>tt.map(je=>{var Zt;return je.type==="event"&&((Zt=je.event_data)==null?void 0:Zt.id)===de?W(M({},je),{event_data:W(M({},je.event_data),{isInterested:Ce})}):je})),setTimeout(()=>{yn(0,!1)},500),fe({title:Ce?"Event Added!":"Event Removed",description:Ce?"You're now interested in this event":"You're no longer interested in this event"})}catch(tt){console.error("Failed to toggle interest from feed modal",tt),fe({title:"Error",description:"Failed to update your interest. Please try again.",variant:"destructive"})}}),onAttendanceChange:(de,Ce)=>{console.log(" Attendance changed in feed:",de,Ce),Ce&&Y(tt=>tt.map(je=>{var Zt;return je.type==="event"&&((Zt=je.event_data)==null?void 0:Zt.id)===de?W(M({},je),{event_data:W(M({},je.event_data),{isInterested:!1,hasAttended:!0})}):je}))},isInterested:rt,onNavigateToProfile:i,onNavigateToChat:a}),lt&&s.jsx(rU,{eventId:lt,isOpen:!!lt,onClose:()=>ut(null)}),Ze&&s.jsx(aue,{reviewId:Ze,isOpen:!!Ze,onClose:()=>qt(null)}),lr&&s.jsx(lue,{eventId:lr,isOpen:!!lr,onClose:()=>Ge(null)}),Wr&&xn&&s.jsx(JE,{event:xn,currentUserId:e,isOpen:Wr,onClose:()=>bn(!1)}),Bn&&ls&&s.jsx(DF,{review:ls,currentUserId:e,isOpen:Bn,onClose:()=>{ms(!1),Bt(null)}}),ie&&s.jsx(YB,{currentUserId:e,onBack:()=>ee(!1)}),Ne&&ce&&s.jsx(tn,{open:Ne,onOpenChange:Oe,children:s.jsxs(Xr,{className:"max-w-5xl w-[90vw] h-[90vh] max-h-[90vh] p-0 overflow-hidden flex",children:[s.jsx(an,{className:"sr-only",children:"Review Details"}),s.jsxs(Kn,{className:"sr-only",children:["Review details for ",((wp=ce.event_info)==null?void 0:wp.artist_name)||"artist"]}),s.jsx("div",{className:"flex-1 bg-black flex items-center justify-center min-h-0",children:ce.photos&&ce.photos.length>0?s.jsx("img",{src:ce.photos[0],alt:"Review photo",className:"max-w-full max-h-full object-contain"}):s.jsxs("div",{className:"text-center text-white",children:[s.jsxs("div",{className:"text-6xl font-bold mb-4",children:[s.jsx("span",{className:"text-pink-500",children:"S"}),"ynth"]}),s.jsx("div",{className:"w-32 h-0.5 bg-white mx-auto mb-4"}),s.jsx("div",{className:"text-sm opacity-80",children:"Concert Review"})]})}),s.jsxs("div",{className:"flex-1 flex flex-col bg-white",children:[s.jsx("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white text-sm font-bold",children:((nx=(bf=ce.author)==null?void 0:bf.name)==null?void 0:nx.charAt(0))||"U"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold text-sm",children:((bp=ce.author)==null?void 0:bp.name)||"User"}),s.jsx("div",{className:"text-xs text-gray-500",children:new Date(ce.created_at).toLocaleDateString()})]})]})}),s.jsxs("div",{className:"flex-1 p-4 space-y-4 overflow-y-auto",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("div",{className:"flex items-start justify-between mb-3",children:s.jsxs("div",{className:"flex-1",children:[s.jsx("h2",{className:"text-lg font-semibold mb-1",children:((Ir=ce.event_info)==null?void 0:Ir.event_name)||"Concert Review"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[(sx=ce.event_info)==null?void 0:sx.artist_name,"  ",(zi=ce.event_info)!=null&&zi.event_date?new Date(ce.event_info.event_date).toLocaleDateString():"Date unknown"]}),((Dc=ce.event_info)==null?void 0:Dc.venue_name)&&s.jsx("p",{className:"text-sm text-gray-500",children:ce.event_info.venue_name})]})}),s.jsx("div",{className:"flex items-center gap-2",children:(jp=ce.event_info)!=null&&jp.event_date&&new Date(ce.event_info.event_date)<new Date?s.jsxs(Be,{variant:"secondary",className:"text-xs bg-gray-100 text-gray-700",children:[s.jsx(Et,{className:"w-3 h-3 mr-1"}),"Past Event"]}):s.jsxs(Be,{variant:"secondary",className:"text-xs bg-blue-100 text-blue-700",children:[s.jsx(Et,{className:"w-3 h-3 mr-1"}),"Upcoming"]})})]}),ce.rating&&s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("div",{className:"flex items-center gap-1",children:[Array.from({length:5},(de,Ce)=>s.jsx(Jt,{className:`w-5 h-5 ${Ce<Math.floor(ce.rating)?"text-yellow-500 fill-yellow-500":"text-gray-300"}`},Ce)),s.jsxs("span",{className:"text-sm font-medium ml-1",children:[ce.rating,"/5"]})]})}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Review"}),s.jsx("p",{className:"text-gray-700 leading-relaxed",children:ce.content||"No review text available."})]}),s.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-gray-200",children:[s.jsxs("button",{onClick:()=>ps(ce),className:`flex items-center gap-2 transition-colors ${pt.has(ce.id)?"text-red-500":"text-gray-700 hover:text-red-500"}`,children:[s.jsx(hs,{className:`w-5 h-5 ${pt.has(ce.id)?"fill-current":""}`}),s.jsxs("span",{children:[ce.likes_count||0," likes"]})]}),s.jsxs("button",{onClick:()=>qt(ce.review_id||ce.id),className:"flex items-center gap-2 text-gray-700 hover:text-blue-500 transition-colors",children:[s.jsx(Wn,{className:"w-5 h-5"}),s.jsxs("span",{children:[ce.comments_count||0," comments"]})]}),s.jsxs("button",{onClick:()=>dr(ce),className:"flex items-center gap-2 text-gray-700 hover:text-green-500 transition-colors",children:[s.jsx(Vu,{className:"w-5 h-5"}),s.jsx("span",{children:"Share"})]}),s.jsxs("button",{onClick:()=>ma(ce),className:`flex items-center gap-2 transition-colors ${Jn.has(ce.id)?"text-yellow-500":"text-gray-700 hover:text-yellow-500"}`,children:[s.jsx(CJ,{className:`w-5 h-5 ${Jn.has(ce.id)?"fill-current":""}`}),s.jsx("span",{children:"Save"})]})]})]})]})]})}),s.jsx(tn,{open:Dr.open,onOpenChange:de=>Ur({open:de,artist:null,events:void 0,totalEvents:void 0}),children:s.jsxs(Xr,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(an,{className:"sr-only",children:"Artist Profile"}),s.jsxs(Kn,{className:"sr-only",children:["Artist profile for ",((ix=Dr.artist)==null?void 0:ix.name)||"artist"]}),Dr.artist&&(Yr?s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(er,{className:"w-6 h-6 animate-spin text-pink-500"}),s.jsx("span",{className:"ml-2",children:"Loading events..."})]}):s.jsx(ohe,{artist:Dr.artist,events:Dr.events||[],totalEvents:Dr.totalEvents||0,source:Dr.events&&Dr.events.length>0?"api":"database",userId:e,onBack:()=>Ur({open:!1,artist:null,events:void 0,totalEvents:void 0}),showAllEvents:!0}))]})}),s.jsx(tn,{open:jn.open,onOpenChange:de=>zn({open:de,venueId:null,venueName:""}),children:s.jsxs(Xr,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(an,{className:"sr-only",children:"Venue Profile"}),s.jsxs(Kn,{className:"sr-only",children:["Venue profile for ",jn.venueName||"venue"]}),s.jsx(lhe,{venueId:jn.venueId,venueName:jn.venueName,onClose:()=>zn({open:!1,venueId:null,venueName:""})})]})}),ht&&s.jsx(JU,{isOpen:_e,onClose:()=>{Ke(!1),ct(null)},contentType:"event",contentId:ht.id,contentTitle:ht.title})]})},mpe=({isOpen:e,onClose:t,type:r,friends:n,count:i,onStartChat:a,onViewProfile:o,onUnfriend:l})=>{const c=r==="friends"?"Friends":r==="followers"?"Followers":"Following";return s.jsx(tn,{open:e,onOpenChange:t,children:s.jsxs(Xr,{className:"sm:max-w-lg w-[95vw] max-h-[80vh] flex flex-col",children:[s.jsx(Mn,{className:"flex-shrink-0",children:s.jsx(an,{className:"text-center",children:c})}),s.jsx(Zw,{className:"flex-1 max-h-[60vh]",children:s.jsx("div",{className:"space-y-2 py-2",children:n.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(li,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:r==="friends"?"No friends yet":r==="followers"?"No followers yet":"Not following anyone yet"})]}):n.map(d=>s.jsxs("div",{className:"flex items-center gap-3 hover:bg-muted/40 rounded-lg p-3 transition-colors mx-2",children:[s.jsxs(Vr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(Qr,{src:d.avatar_url||void 0}),s.jsx(qr,{className:"text-sm",children:d.name?d.name.split(" ").map(u=>u[0]).join(""):"U"})]}),s.jsxs("div",{className:"flex-1 min-w-0 mr-2",onClick:()=>o&&o(d),children:[s.jsx("p",{className:"font-semibold text-sm truncate",children:d.name}),s.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["@",d.username]}),d.bio&&s.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:d.bio})]}),s.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[o&&s.jsx(oe,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 hover:bg-gray-100",onClick:u=>{u.stopPropagation(),o(d)},children:s.jsx(lf,{className:"w-4 h-4"})}),a&&s.jsx(oe,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 hover:bg-gray-100",onClick:u=>{u.stopPropagation(),a(d.user_id)},children:s.jsx(Wn,{className:"w-4 h-4"})}),l&&r==="friends"&&s.jsx(oe,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",onClick:u=>E(void 0,null,function*(){u.stopPropagation();try{yield l(d.user_id)}catch(h){console.error("Error unfriending user:",h)}}),children:s.jsx(nI,{className:"w-4 h-4"})})]})]},d.id))})})]})})};function ppe({isOpen:e,onClose:t,userId:r,profileName:n,isOwnProfile:i=!1}){const a=ci(),[o,l]=y.useState([]),[c,d]=y.useState([]),[u,h]=y.useState(!0),[f,p]=y.useState(null),[x,g]=y.useState("artists");y.useEffect(()=>{e&&r?(console.log(" FollowingModal: Loading following for user:",r),v()):(l([]),d([]),h(!0))},[e,r]);const v=()=>E(this,null,function*(){try{h(!0),p(null),console.log(" FollowingModal: Fetching artists and venues for user:",r);const[b,N]=yield Promise.all([$a.getUserFollowedArtists(r),uu.getUserFollowedVenues(r)]);console.log(" FollowingModal: Received artists:",b.length,"venues:",N.length),console.log(" FollowingModal: Artist details:",b.map(O=>({name:O.artist_name,id:O.artist_id})));const S=[...b].sort((O,A)=>(O.artist_name||"").localeCompare(A.artist_name||"",void 0,{sensitivity:"base"})),k=[...N].sort((O,A)=>(O.venue_name||"").localeCompare(A.venue_name||"",void 0,{sensitivity:"base"}));l(S),d(k),console.log(" FollowingModal: Set artists:",S.length,"venues:",k.length)}catch(b){console.error(" FollowingModal: Error loading following:",b),p("Failed to load following")}finally{h(!1)}}),_=b=>{if(!b.artist_name)return;const N=b.artist_id&&b.artist_id!=="manual"?b.artist_id:encodeURIComponent(b.artist_name);a(`/artist/${N}`),t()},w=b=>{if(!b.venue_name)return;const N=b.venue_id||encodeURIComponent(b.venue_name);a(`/venue/${N}`),t()};return o.length+c.length,s.jsx(tn,{open:e,onOpenChange:t,children:s.jsxs(Xr,{className:"sm:max-w-lg w-[95vw] max-h-[80vh] flex flex-col p-0 max-w-[393px] mx-auto",children:[s.jsxs(Mn,{className:"flex-shrink-0 px-6 pt-6 pb-4 border-b relative",children:[s.jsx(an,{className:"text-center text-lg font-semibold",children:"Following"}),s.jsx("button",{onClick:t,className:"absolute right-4 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full bg-[#cc2486] flex items-center justify-center hover:bg-[#b01f75] transition-colors","aria-label":"Close",children:s.jsx(pr,{className:"w-4 h-4 text-white"})})]}),s.jsxs(Cl,{value:x,onValueChange:b=>g(b),className:"flex-1 flex flex-col min-h-0",children:[s.jsxs(Fo,{className:"w-full grid grid-cols-2 rounded-none border-b",children:[s.jsxs(Tn,{value:"artists",className:"rounded-none",children:["Artists (",o.length,")"]}),s.jsxs(Tn,{value:"venues",className:"rounded-none",children:["Venues (",c.length,")"]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4 min-h-0",children:u?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(er,{className:"w-6 h-6 animate-spin text-[#cc2486] mr-2"}),s.jsx("span",{className:"text-muted-foreground",children:"Loading..."})]}):f?s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-red-600",children:f})}):s.jsxs(s.Fragment,{children:[s.jsx(On,{value:"artists",className:"mt-0 space-y-2",children:o.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ct,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:i?"Not following any artists yet":`${n} is not following any artists yet`})]}):o.map(b=>s.jsxs("div",{className:"flex items-center gap-3 hover:bg-[rgba(201,201,201,0.2)] rounded-lg p-3 transition-colors cursor-pointer",onClick:()=>_(b),children:[s.jsxs(Vr,{className:"w-12 h-12 flex-shrink-0",children:[b.artist_image_url?s.jsx(Qr,{src:b.artist_image_url,alt:b.artist_name||"Artist"}):null,s.jsx(qr,{className:"bg-[#fdf2f7]",children:s.jsx(Ct,{className:"w-6 h-6 text-[#cc2486]"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-base truncate",children:b.artist_name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Artist"})]})]},b.artist_id||b.artist_name))}),s.jsx(On,{value:"venues",className:"mt-0 space-y-2",children:c.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Xt,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:i?"Not following any venues yet":`${n} is not following any venues yet`})]}):c.map(b=>s.jsxs("div",{className:"flex items-center gap-3 hover:bg-[rgba(201,201,201,0.2)] rounded-lg p-3 transition-colors cursor-pointer",onClick:()=>w(b),children:[s.jsxs(Vr,{className:"w-12 h-12 flex-shrink-0",children:[b.venue_image_url?s.jsx(Qr,{src:b.venue_image_url,alt:b.venue_name||"Venue"}):null,s.jsx(qr,{className:"bg-[#fdf2f7]",children:s.jsx(Xt,{className:"w-6 h-6 text-[#cc2486]"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-base truncate",children:b.venue_name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:b.venue_state||"Venue"})]})]},b.venue_id||b.venue_name))})]})})]})]})})}function gpe({children:e}){const[t,r]=y.useState(!1);return y.useEffect(()=>{const n=()=>{r(window.innerWidth<768)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),t?s.jsx("div",{className:"flex justify-center py-4",children:s.jsxs("div",{className:"relative w-full max-w-[420px] rounded-3xl border border-gray-200 bg-[#fcfcfc] shadow-lg overflow-hidden",children:[s.jsxs("div",{className:"h-[47px] bg-[#fcfcfc] border-b border-gray-200 flex items-end justify-center px-3 pt-1",children:[s.jsx("div",{className:"flex-1 flex items-center",children:s.jsx("span",{className:"text-[13px] font-semibold text-black ml-1",children:"9:41"})}),s.jsx("div",{className:"flex-1 flex justify-center",children:s.jsx("div",{className:"bg-black h-[28px] w-[108px] rounded-full"})}),s.jsxs("div",{className:"flex-1 flex justify-end items-center gap-1 text-black/80 text-[10px]",children:[s.jsx("div",{className:"w-4 h-[10px] bg-gradient-to-r from-black/10 to-black rounded-[3px]"}),s.jsx("div",{className:"w-4 h-[10px] bg-gradient-to-r from-black/10 to-black rounded-[3px]"}),s.jsx("div",{className:"w-6 h-[10px] border border-black rounded-[3px] flex items-center justify-end pr-[1px]",children:s.jsx("div",{className:"h-[7px] w-[9px] bg-black rounded-[2px]"})})]})]}),s.jsx("div",{className:"max-h-[calc(100vh-140px)] overflow-y-auto px-4 pb-24 pt-4",children:e}),s.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-3 flex justify-center",children:s.jsxs("div",{className:"pointer-events-auto flex items-center justify-between gap-6 rounded-2xl border border-gray-200 bg-[#f9d7e4] px-6 py-3 shadow-md w-[90%] max-w-[360px]",children:[s.jsxs("button",{type:"button",className:"flex flex-col items-center text-xs text-[#cc2486]",children:[s.jsx(BJ,{className:"w-5 h-5"}),s.jsx("span",{className:"mt-1",children:"Home"})]}),s.jsxs("button",{type:"button",className:"flex flex-col items-center text-xs text-[#cc2486]",children:[s.jsx(Mi,{className:"w-5 h-5"}),s.jsx("span",{className:"mt-1",children:"Search"})]}),s.jsx("button",{type:"button",className:"flex items-center justify-center rounded-full bg-[#cc2486] text-white w-[70px] h-10 shadow-sm",children:s.jsx(eo,{className:"w-5 h-5"})}),s.jsxs("button",{type:"button",className:"flex flex-col items-center text-xs text-[#cc2486]",children:[s.jsx(Wn,{className:"w-5 h-5"}),s.jsx("span",{className:"mt-1",children:"Feed"})]}),s.jsxs("button",{type:"button",className:"flex flex-col items-center text-xs text-[#cc2486]",children:[s.jsx(li,{className:"w-5 h-5"}),s.jsx("span",{className:"mt-1",children:"Profile"})]})]})})]})}):s.jsx("div",{className:"flex justify-center py-6",children:s.jsx("div",{className:"w-full max-w-3xl rounded-xl border border-gray-200 bg-[#fcfcfc] shadow-md max-h-[80vh] overflow-y-auto px-6 pb-6 pt-4",children:e})})}function vpe({event:e,userId:t,isOpen:r,onClose:n,onReviewSubmitted:i}){if(!e)return null;const a=()=>{n()};return s.jsx(tn,{open:r,onOpenChange:a,children:s.jsx(Xr,{className:"max-w-4xl w-[98vw] h-[90dvh] max-h-[90dvh] p-0 overflow-hidden flex flex-col bg-transparent border-none shadow-none",hideCloseButton:!0,children:s.jsx(gpe,{children:s.jsx(RF,{event:e,userId:t,onSubmitted:o=>E(this,null,function*(){if(i){const l=i(o);l instanceof Promise&&(yield l)}n()}),onDeleted:()=>E(this,null,function*(){if(i){const o=i(null);o instanceof Promise&&(yield o)}n()}),onClose:n})})})})}class xpe{constructor(){_r(this,"developerToken","your_apple_music_token");_r(this,"musicKit",null);_r(this,"userToken",null);_r(this,"storefront","us");this.init()}init(){return E(this,null,function*(){yield this.loadMusicKit()})}loadMusicKit(){return E(this,null,function*(){if(typeof window!="undefined")if(window.MusicKit)this.configureMusicKit();else return new Promise((t,r)=>{const n=document.createElement("script");n.src="https://js-cdn.music.apple.com/musickit/v1/musickit.js",n.onload=()=>{this.configureMusicKit(),t()},n.onerror=r,document.head.appendChild(n)})})}configureMusicKit(){if(!this.developerToken){console.warn("Apple Music developer token not configured");return}try{window.MusicKit.configure({developerToken:this.developerToken,app:{name:"PlusOne Event Crew",build:"1.0.0"}}),this.musicKit=window.MusicKit.getInstance()}catch(t){console.error("MusicKit configuration error:",t)}}authenticate(){return E(this,null,function*(){if(!this.musicKit)throw new Error("MusicKit not initialized");yield this.musicKit.authorize(),this.musicKit.isAuthorized&&(this.userToken=this.musicKit.musicUserToken,yield this.getUserStorefront(),setTimeout(()=>{this.autoSync().catch(console.error)},2e3))})}checkStoredToken(){var t;return((t=this.musicKit)==null?void 0:t.isAuthorized)||!1}logout(){this.musicKit&&this.musicKit.unauthorize(),this.userToken=null}appleMusicApiCall(n){return E(this,arguments,function*(t,r={}){if(!this.userToken&&!t.includes("/catalog/"))throw new Error("User token required for library access");const a=`https://api.music.apple.com/v1${t}`,o={Authorization:`Bearer ${this.developerToken}`,"Content-Type":"application/json"};this.userToken&&!t.includes("/catalog/")&&(o["Music-User-Token"]=this.userToken);const l=yield fetch(a,M({headers:o},r));if(!l.ok)throw new Error(`Apple Music API error: ${l.status} ${l.statusText}`);return l.json()})}getUserStorefront(){return E(this,null,function*(){try{const t=yield this.appleMusicApiCall("/me/storefront");return t.data&&t.data.length>0?(this.storefront=t.data[0].id,t.data[0]):null}catch(t){return console.error("Error getting user storefront:",t),null}})}getLibrarySongs(t=100){return E(this,null,function*(){return this.appleMusicApiCall(`/me/library/songs?limit=${t}`)})}getLibraryArtists(t=100){return E(this,null,function*(){return this.appleMusicApiCall(`/me/library/artists?limit=${t}`)})}getLibraryAlbums(t=100){return E(this,null,function*(){return this.appleMusicApiCall(`/me/library/albums?limit=${t}`)})}getRecentlyPlayed(t=30){return E(this,null,function*(){return this.appleMusicApiCall(`/me/recent/played/tracks?limit=${t}`)})}getReplayData(){return E(this,null,function*(){try{return this.appleMusicApiCall("/me/library/replay")}catch(t){return console.log("Replay data not available or accessible"),null}})}getHeavyRotation(){return E(this,null,function*(){try{return this.appleMusicApiCall("/me/history/heavy-rotation")}catch(t){return console.log("Heavy rotation data not available"),null}})}getRecommendations(){return E(this,null,function*(){try{return this.appleMusicApiCall("/me/recommendations")}catch(t){return console.log("Recommendations not available"),null}})}getCharts(t="songs,albums,artists",r=20){return E(this,null,function*(){return this.appleMusicApiCall(`/catalog/${this.storefront}/charts?types=${t}&limit=${r}`)})}getLibraryPlaylist(t=100){return E(this,null,function*(){try{return this.appleMusicApiCall(`/me/library/playlists?limit=${t}`)}catch(r){return console.log("Library playlists not available"),null}})}getLibraryStats(){return E(this,null,function*(){try{const[t,r,n,i]=yield Promise.allSettled([this.getLibrarySongs(1e3),this.getLibraryArtists(1e3),this.getLibraryAlbums(1e3),this.getLibraryPlaylist(1e3)]),a=t.status==="fulfilled"?t.value.data:[],o=r.status==="fulfilled"?r.value.data:[],l=n.status==="fulfilled"?n.value.data:[],c=i.status==="fulfilled"?i.value.data:[];return{totalSongs:a.length,totalArtists:o.length,totalAlbums:l.length,totalPlaylists:c.length,songs:a,artists:o,albums:l,playlists:c}}catch(t){return console.error("Error getting library stats:",t),null}})}processLibraryData(t,r){if(!t||!Array.isArray(t))return[];let n=[...t];switch(r){case"last-week":n=t.slice(0,20);break;case"last-month":n=t.slice(0,30);break;case"last-6-months":n=t.slice(0,50);break;default:n=t.slice(0,20)}return n}calculateListeningStats(t,r){const n=t.length,i=r.length,a=new Set;t.forEach(f=>{f.attributes.albumName&&a.add(f.attributes.albumName)});const o=a.size,l=t.reduce((f,p)=>f+(p.attributes.durationInMillis||0),0),c=Math.round(l/(1e3*60*60)*10)/10,d=n>0?Math.round(l/n/1e3):0,u={};[...t,...r].forEach(f=>{(f.attributes.genreNames||[]).forEach(x=>{u[x]=(u[x]||0)+1})});const h=Object.entries(u).sort(([,f],[,p])=>p-f).slice(0,5).map(([f])=>f);return{totalTracks:n,uniqueArtists:i,uniqueAlbums:o,totalHours:c,avgDuration:d,topGenres:h}}formatDuration(t){if(!t)return"";const r=Math.floor(t/6e4),n=Math.floor(t%6e4/1e3);return`${r}:${n.toString().padStart(2,"0")}`}formatDate(t){const n=(new Date().getTime()-t.getTime())/(1e3*60*60);return n<1?"Just now":n<24?`${Math.floor(n)} hours ago`:n<168?`${Math.floor(n/24)} days ago`:t.toLocaleDateString()}getArtworkUrl(t,r=300,n=300){return t!=null&&t.url?t.url.replace("{w}",r.toString()).replace("{h}",n.toString()):""}generateProfileData(){return E(this,null,function*(){try{if(!this.userToken)throw new Error("User not authenticated");const t=yield this.getLibraryStats();if(!t)throw new Error("Failed to get library stats");const[r,n]=yield Promise.allSettled([this.getRecentlyPlayed(50),this.getUserStorefront()]),i=r.status==="fulfilled"?r.value.data:[],a=n.status==="fulfilled"?n.value:null,o=this.calculateListeningStats(t.songs,t.artists),l=this.processLibraryData(t.songs,"last-month").slice(0,20),c=this.processLibraryData(t.artists,"last-month").slice(0,20),d=this.processLibraryData(t.albums,"last-month").slice(0,20);return{storefront:(a==null?void 0:a.id)||"us",libraryStats:t,topTracks:l,topArtists:c,topAlbums:d,recentlyPlayed:i,topGenres:o.topGenres,listeningTime:o.totalHours,lastUpdated:new Date().toISOString()}}catch(t){return console.error("Error generating profile data:",t),null}})}uploadProfileData(t){return E(this,null,function*(){try{const r=yield this.getCurrentUserId(),i=yield fetch("http://localhost:3001/api/user/streaming-profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"apple-music",data:t,userId:r||"anonymous"})});if(!i.ok){const o=yield i.json().catch(()=>({}));throw new Error(`Upload failed: ${i.status} ${i.statusText} - ${o.error||"Unknown error"}`)}const a=yield i.json();console.log("Profile data uploaded successfully:",a);try{const o=yield this.getCurrentUserId();if(o&&t){const l=t.topArtists||[],c=t.topGenres||[],d={user_id:o,service_type:"apple-music",top_artists:l.map(u=>{var h;return{name:u.name||((h=u.attributes)==null?void 0:h.name)||"",popularity:u.popularity||0,id:u.id}}),top_genres:c.map(u=>({genre:typeof u=="string"?u:u.genre||"",count:typeof u=="string"?1:u.count||1})),total_tracks:t.totalTracks||0,unique_artists:l.length,total_listening_hours:t.totalListeningHours||0};console.log(" Stats table removed - stats not persisted");try{const{streamingSyncService:u}=yield on(()=>E(this,null,function*(){const{streamingSyncService:h}=yield Promise.resolve().then(()=>P2);return{streamingSyncService:h}}),void 0,import.meta.url);u.isSyncing()&&u.completeSync()}catch(u){console.warn("Could not notify sync service:",u)}}}catch(o){console.error("Error storing Apple Music stats:",o);try{const{streamingSyncService:l}=yield on(()=>E(this,null,function*(){const{streamingSyncService:c}=yield Promise.resolve().then(()=>P2);return{streamingSyncService:c}}),void 0,import.meta.url);l.errorSync(o instanceof Error?o.message:"Unknown error")}catch(l){console.warn("Could not notify sync service of error:",l)}}return!0}catch(r){return console.error("Error uploading profile data:",r),!1}})}getCurrentUserId(){return E(this,null,function*(){try{const{supabase:t}=yield on(()=>E(this,null,function*(){const{supabase:n}=yield Promise.resolve().then(()=>Aie);return{supabase:n}}),void 0,import.meta.url),{data:{user:r}}=yield t.auth.getUser();return(r==null?void 0:r.id)||null}catch(t){return console.error("Error getting current user:",t),null}})}syncProfileData(){return E(this,null,function*(){try{const t=yield this.generateProfileData();return t?yield this.uploadProfileData(t):!1}catch(t){return console.error("Error syncing profile data:",t),!1}})}shouldSync(){const t=localStorage.getItem("apple-music-last-sync");if(!t)return!0;const r=new Date(t);return(new Date().getTime()-r.getTime())/(1e3*60*60)>=24}markSyncCompleted(){localStorage.setItem("apple-music-last-sync",new Date().toISOString())}autoSync(){return E(this,null,function*(){if(!this.shouldSync()){console.log("Apple Music profile sync not needed yet");return}console.log("Starting Apple Music profile sync..."),(yield this.syncProfileData())?(this.markSyncCompleted(),console.log("Apple Music profile sync completed successfully")):console.log("Apple Music profile sync failed")})}}const Yp=new xpe,Ez=e=>{if(!e)return"unknown";const t=e.toLowerCase();return t.includes("spotify.com")||t.includes("open.spotify")||t.startsWith("spotify:")||/^[a-zA-Z0-9_]{1,}$/.test(e)?"spotify":t.includes("music.apple.com")||t.includes("apple.com/music")||t.includes("applemusic")||t.includes("apple music")?"apple-music":"unknown"};class ype{static getUserStats(t,r=30){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("interactions").select("event_type, entity_type").eq("user_id",t).gte("occurred_at",new Date(Date.now()-r*24*60*60*1e3).toISOString());if(i)throw i;const a={events_viewed:(n==null?void 0:n.filter(d=>d.event_type==="view"&&d.entity_type==="event").length)||0,events_clicked:(n==null?void 0:n.filter(d=>d.event_type==="click"&&d.entity_type==="event").length)||0,events_interested:0,events_attended:0,reviews_written:0,reviews_liked:(n==null?void 0:n.filter(d=>d.event_type==="like"&&d.entity_type==="review").length)||0,ticket_clicks:(n==null?void 0:n.filter(d=>d.event_type==="click"&&d.entity_type==="ticket_link").length)||0,searches_performed:(n==null?void 0:n.filter(d=>d.event_type==="search").length)||0,friends_count:0},[o,l,c]=yield Promise.all([P.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("user_id",t).in("relationship_type",["interested","going","maybe"]),P.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY"),P.from("user_relationships").select("*",{count:"exact",head:!0}).eq("relationship_type","friend").or(`user_id.eq.${t},related_user_id.eq.${t}`)]);return a.events_interested=o.count||0,a.reviews_written=l.count||0,a.friends_count=c.count||0,a}catch(n){throw console.error("Error fetching user stats:",n),n}})}static getTopArtists(t,r=5){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("interactions").select("metadata").eq("user_id",t).not("metadata->artist_name","is",null).gte("occurred_at",new Date(Date.now()-7776e6).toISOString());if(i)throw i;const a=new Map;return n==null||n.forEach(l=>{var d;const c=(d=l.metadata)==null?void 0:d.artist_name;c&&a.set(c,(a.get(c)||0)+1)}),Array.from(a.entries()).map(([l,c])=>({artist_name:l,interaction_count:c,reviews_written:0})).sort((l,c)=>c.interaction_count-l.interaction_count).slice(0,r)}catch(n){return console.error("Error fetching top artists:",n),[]}})}static getTopVenues(t,r=5){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("interactions").select("metadata").eq("user_id",t).not("metadata->venue_name","is",null).gte("occurred_at",new Date(Date.now()-7776e6).toISOString());if(i)throw i;const a=new Map;return n==null||n.forEach(o=>{var u,h,f;const l=(u=o.metadata)==null?void 0:u.venue_name,c=(h=o.metadata)==null?void 0:h.venue_city,d=(f=o.metadata)==null?void 0:f.venue_state;if(l){const p=a.get(l)||{count:0};a.set(l,{count:p.count+1,city:c||p.city,state:d||p.state})}}),Array.from(a.entries()).map(([o,l])=>({venue_name:o,venue_city:l.city,venue_state:l.state,interaction_count:l.count})).sort((o,l)=>l.interaction_count-o.interaction_count).slice(0,r)}catch(n){return console.error("Error fetching top venues:",n),[]}})}static getReviewStats(t){return E(this,null,function*(){var r;try{const{data:n,error:i}=yield P.from("reviews").select("id, rating, likes_count, comments_count, event_id").eq("user_id",t).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").order("likes_count",{ascending:!1});if(i)throw i;const a=[...new Set((n||[]).map(d=>d.event_id).filter(Boolean))];let o={};if(a.length>0){const{data:d,error:u}=yield P.from("events").select("id, title").in("id",a);!u&&d&&(o=d.reduce((h,f)=>(h[f.id]=f,h),{}))}const l=(n||[]).map(d=>W(M({},d),{event:d.event_id&&o[d.event_id]||null}));if(!l||l.length===0)return{review_count:0,avg_rating:0,total_likes:0,total_comments:0};const c={review_count:l.length,avg_rating:l.reduce((d,u)=>d+u.rating,0)/l.length,total_likes:l.reduce((d,u)=>d+(u.likes_count||0),0),total_comments:l.reduce((d,u)=>d+(u.comments_count||0),0)};return l[0]&&l[0].likes_count>0&&(c.most_liked_review={id:l[0].id,event_name:((r=l[0].event)==null?void 0:r.title)||"Unknown Event",likes_count:l[0].likes_count}),c}catch(n){return console.error("Error fetching review stats:",n),{review_count:0,avg_rating:0,total_likes:0,total_comments:0}}})}static getGenreBreakdown(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("interactions").select("metadata").eq("user_id",t).eq("entity_type","event").not("metadata->genres","is",null);if(n)throw n;const i=new Map;let a=0;return r==null||r.forEach(o=>{var c;(((c=o.metadata)==null?void 0:c.genres)||[]).forEach(d=>{i.set(d,(i.get(d)||0)+1),a++})}),Array.from(i.entries()).map(([o,l])=>({genre:o,count:l,percentage:Math.round(l/a*100)})).sort((o,l)=>l.count-o.count).slice(0,5)}catch(r){return console.error("Error fetching genre breakdown:",r),[]}})}static getActualAttendedEventsCount(t){return E(this,null,function*(){try{const{count:r}=yield P.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY"),{count:n}=yield P.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_draft",!0),{count:i}=yield P.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("review_text","ATTENDANCE_ONLY"),a=(r||0)+(n||0)+(i||0);return console.log(` Attended events: ${r||0} reviews + ${n||0} drafts + ${i||0} attendance-only = ${a}`),a}catch(r){return console.error("Error getting actual attended events count:",r),0}})}static getActualUniqueVenuesCount(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("reviews").select(`
          id, 
          is_draft, 
          review_text, 
          events!inner(
            id,
            title, 
            venues(name),
            artists(name)
          )
        `).eq("user_id",t);if(n)return console.error("Error fetching reviews for venue count:",n),0;if(!r||r.length===0)return 0;const i=new Set,a=[];r.forEach(c=>{var p,x;const d=c.events,u=((p=d==null?void 0:d.venues)==null?void 0:p.name)||null,h=((x=d==null?void 0:d.artists)==null?void 0:x.name)||null,f=(d==null?void 0:d.title)||null;if(u){i.add(u);let g="completed";c.is_draft?g="draft":c.review_text==="ATTENDANCE_ONLY"&&(g="attendance-only"),a.push({venue:u,event:f||`${h} concert`,type:g})}});const o=i.size;console.log(` Unique venues: ${o} from ${(r==null?void 0:r.length)||0} total attended events`),console.log(" Venue details:",a),console.log(" Unique venue names:",Array.from(i));const l=a.filter(c=>c.venue==="Ameris Bank Amphitheatre");if(l.length>0){console.log(" PROBLEM FOUND: Incorrect venue data:",l),console.log(" This venue should be removed or corrected in the database");const c=Array.from(i).filter(d=>d!=="Ameris Bank Amphitheatre");return console.log(` Corrected unique venues (excluding problematic): ${c.length}`),console.log(" Corrected venue names:",c),c.length}return o}catch(r){return console.error("Error getting actual unique venues count:",r),0}})}static getActualInterestedEventsCount(t){return E(this,null,function*(){try{const{count:r}=yield P.from("user_event_relationships").select("*",{count:"exact",head:!0}).eq("user_id",t).in("relationship_type",["interested","going","maybe"]),n=r||0;return console.log(` Interested events: ${n}`),n}catch(r){return console.error("Error getting actual interested events count:",r),0}})}static getUserAchievements(t){return E(this,null,function*(){try{const[r,n,i,a]=yield Promise.all([this.getUserStats(t,365),this.getReviewStats(t),this.getTopVenues(t,20),this.getGenreBreakdown(t)]),o=yield this.getActualAttendedEventsCount(t);console.log(" Actual attended events count:",o);const l=yield this.getActualUniqueVenuesCount(t);console.log(" Actual unique venues count:",l);const c=yield this.getActualInterestedEventsCount(t);console.log(" Actual interested events count:",c);const d=[{id:"concert_enthusiast",name:"Concert Enthusiast",description:"Attend 10+ events",icon:"",progress:o,goal:10,unlocked:o>=10,category:"events"},{id:"trusted_reviewer",name:"Trusted Reviewer",description:"Write 5+ reviews with 20+ total likes",icon:"",progress:n.review_count>=5&&n.total_likes>=20?1:0,goal:1,unlocked:n.review_count>=5&&n.total_likes>=20,category:"reviews"},{id:"genre_explorer",name:"Genre Explorer",description:"Review events from 5+ different genres",icon:"",progress:a.length,goal:5,unlocked:a.length>=5,category:"exploration"},{id:"local_expert",name:"Local Expert",description:"Attend events at 10+ different venues",icon:"",progress:l,goal:10,unlocked:l>=10,category:"exploration"},{id:"social_butterfly",name:"Social Butterfly",description:"Connect with 20+ friends",icon:"",progress:r.friends_count,goal:20,unlocked:r.friends_count>=20,category:"social"},{id:"super_fan",name:"Super Fan",description:"Follow 15+ artists",icon:"",progress:0,goal:15,unlocked:!1,category:"social"},{id:"review_master",name:"Review Master",description:"Write 25+ reviews",icon:"",progress:n.review_count,goal:25,unlocked:n.review_count>=25,category:"reviews"},{id:"influencer",name:"Influencer",description:"Get 100+ likes on your reviews",icon:"",progress:n.total_likes,goal:100,unlocked:n.total_likes>=100,category:"reviews"},{id:"early_bird",name:"Early Bird",description:"Mark interested in 50+ events",icon:"",progress:c,goal:50,unlocked:c>=50,category:"events"},{id:"ticket_hunter",name:"Ticket Hunter",description:"Click 100+ ticket links",icon:"",progress:r.ticket_clicks,goal:100,unlocked:r.ticket_clicks>=100,category:"events"}],u=yield this.getArtistFollowsCount(t),h=d.findIndex(f=>f.id==="super_fan");return h!==-1&&(d[h].progress=u||0,d[h].unlocked=(u||0)>=15),d}catch(r){return console.error("Error calculating achievements:",r),[]}})}static getActivityTimeline(t,r=30){return E(this,null,function*(){try{return console.log("Activity timeline not available yet - analytics tables not deployed"),[]}catch(n){return console.error("Error fetching activity timeline:",n),[]}})}static exportUserData(t){return E(this,null,function*(){try{const[r,n,i,a,o]=yield Promise.all([this.getUserStats(t,365),this.getTopArtists(t,20),this.getTopVenues(t,20),this.getReviewStats(t),this.getUserAchievements(t)]);let l=`Synth User Analytics Export
`;return l+=`Generated: ${new Date().toISOString()}

`,l+=`SUMMARY STATS (Last 365 days)
`,l+=`Metric,Value
`,l+=`Events Viewed,${r.events_viewed}
`,l+=`Events Clicked,${r.events_clicked}
`,l+=`Events Interested,${r.events_interested}
`,l+=`Events Attended,${r.events_attended}
`,l+=`Reviews Written,${r.reviews_written}
`,l+=`Ticket Clicks,${r.ticket_clicks}
`,l+=`Friends,${r.friends_count}

`,l+=`TOP ARTISTS
`,l+=`Artist,Interactions
`,n.forEach(c=>l+=`${c.artist_name},${c.interaction_count}
`),l+=`
`,l+=`TOP VENUES
`,l+=`Venue,City,State,Interactions
`,i.forEach(c=>l+=`${c.venue_name},${c.venue_city||""},${c.venue_state||""},${c.interaction_count}
`),l+=`
`,l+=`REVIEW STATS
`,l+=`Total Reviews,Average Rating,Total Likes,Total Comments
`,l+=`${a.review_count},${a.avg_rating.toFixed(2)},${a.total_likes},${a.total_comments}

`,l+=`ACHIEVEMENTS
`,l+=`Achievement,Progress,Goal,Unlocked
`,o.forEach(c=>l+=`${c.name},${c.progress},${c.goal},${c.unlocked}
`),l}catch(r){throw console.error("Error exporting user data:",r),r}})}static getArtistFollowsCount(t){return E(this,null,function*(){try{console.log(` Getting artist follows count for user: ${t}`);const{count:r,error:n}=yield P.from("artist_follows").select("*",{count:"exact",head:!0}).eq("user_id",t);console.log(` Count query result: count=${r}, error=`,n);const{data:i,error:a}=yield P.from("artist_follows").select("id, artist_id, user_id, created_at").eq("user_id",t);if(console.log(` Data query result: data.length=${(i==null?void 0:i.length)||0}, error=`,a),i&&i.length>0&&console.log(" First follow record:",i[0]),n)return console.error(" Artist follows count query error:",n),console.error(" Error details:",JSON.stringify(n,null,2)),!a&&i?(console.log(` Using data length as fallback: ${i.length}`),i.length):0;const o=r!=null?r:(i==null?void 0:i.length)||0;if(console.log(` Artist follows count: ${o} (count query: ${r}, data length: ${(i==null?void 0:i.length)||0})`),o>0&&i&&i.length>0){const l=i.map(c=>c.artist_id).filter(Boolean);if(l.length>0){const{data:c,error:d}=yield P.from("artists").select("id, name").in("id",l);if(!d&&c){const u=c.map(h=>h.name||"Unknown Artist");console.log(` Followed artist names (${c.length}):`,u)}else d&&console.warn(" Could not fetch artist names:",d)}}return o}catch(r){return console.error(" Error getting artist follows count:",r),0}})}static getVenueFollowsCount(t){return E(this,null,function*(){try{console.log(` Getting venue follows count for user: ${t}`);const{count:r,data:n,error:i}=yield P.from("user_venue_relationships").select("*",{count:"exact"}).eq("user_id",t);if(i)return console.error(" Venue follows query error:",i),0;const a=r||(n==null?void 0:n.length)||0;if(console.log(` Venue follows count from user_venue_relationships table: ${a} (from count: ${r}, from data.length: ${n==null?void 0:n.length})`),a>0&&n&&n.length>0){const o=n.map(l=>l.venue_id).filter(Boolean);if(o.length>0){const l=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,c=o.filter(f=>l.test(String(f)));let d=[],u=null;if(c.length>0){const f=yield P.from("venues").select("name").in("id",c);d=f.data||[],u=f.error}const h=o.filter(f=>!l.test(String(f)));if(h.length>0&&!u){const{data:f,error:p}=yield P.from("venues").select("name").in("name",h);!p&&f&&(d=[...d,...f])}if(!u&&d&&d.length>0){const f=d.map(p=>p.name||"Unknown Venue");console.log(" Followed venue names:",f)}else{const f=o.map(p=>p);console.log(" Followed venue IDs/names (could not find in venues table):",f)}}}else console.log(` No venue follows found for user ${t}`);return a}catch(r){return console.error("Error getting venue follows count:",r),0}})}static hasPremium(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("user_subscriptions").select("subscription_tier, subscription_expires_at, status").eq("user_id",t).single();return n?(console.error("Error checking premium status:",n),!1):r?r.subscription_tier&&r.subscription_tier!=="free"&&r.status==="active"&&(!r.subscription_expires_at||new Date(r.subscription_expires_at)>new Date):!1}catch(r){return console.error("Error checking premium status:",r),!1}})}static trackSubscriptionChange(t,r,n,i){return E(this,null,function*(){try{const{trackInteraction:a}=yield on(()=>E(this,null,function*(){const{trackInteraction:o}=yield Promise.resolve().then(()=>Oie);return{trackInteraction:o}}),void 0,import.meta.url);yield a.profileUpdate("subscription_tier",t,{oldTier:r,newTier:n,changeType:i,revenueImpact:this.calculateRevenueImpact(r,n),timestamp:new Date().toISOString()})}catch(a){console.error("Error tracking subscription change:",a)}})}static calculateRevenueImpact(t,r){const n={free:0,premium:4.99,professional:9.99,enterprise:19.99},i=n[t]||0;return(n[r]||0)-i}static getSubscriptionAnalytics(t){return E(this,null,function*(){try{const{data:r}=yield P.from("user_subscriptions").select("subscription_tier, subscription_started_at, subscription_expires_at").eq("user_id",t).single(),{data:n}=yield P.from("interactions").select("*").eq("user_id",t).eq("event_type","profile_update").eq("entity_type","profile").contains("metadata",{field:"subscription_tier"}).order("occurred_at",{ascending:!0}),i=(n==null?void 0:n.map(o=>{const l=o.metadata;return{date:o.occurred_at,tier:(l==null?void 0:l.newTier)||"unknown",changeType:(l==null?void 0:l.changeType)||"unknown",revenueImpact:(l==null?void 0:l.revenueImpact)||0}}))||[],a=i.reduce((o,l)=>o+l.revenueImpact,0);return{currentTier:(r==null?void 0:r.subscription_tier)||"free",subscriptionStartDate:(r==null?void 0:r.subscription_started_at)||null,subscriptionExpiryDate:(r==null?void 0:r.subscription_expires_at)||null,totalRevenue:a,subscriptionHistory:i}}catch(r){return console.error("Error getting subscription analytics:",r),{currentTier:"free",totalRevenue:0,subscriptionHistory:[]}}})}}function _pe({open:e,onClose:t,user:r,isBlocked:n=!1,onBlockToggled:i}){const{toast:a}=jr(),[o,l]=y.useState(!1),[c,d]=y.useState(""),u=()=>E(this,null,function*(){l(!0);try{n?(yield Tu.unblockUser(r.id),a({title:"User Unblocked",description:`You can now see content from ${r.name}`})):(yield Tu.blockUser({blocked_user_id:r.id,block_reason:c.trim()||void 0}),a({title:"User Blocked",description:`You won't see content from ${r.name} anymore`})),i==null||i(),h()}catch(f){console.error("Error toggling block:",f),a({title:"Error",description:f instanceof Error?f.message:"Failed to update block status",variant:"destructive"})}finally{l(!1)}}),h=()=>{o||(d(""),t())};return s.jsx(tn,{open:e,onOpenChange:h,children:s.jsxs(Xr,{className:"sm:max-w-[500px]",children:[s.jsxs(Mn,{children:[s.jsx(an,{className:"flex items-center gap-2",children:n?s.jsxs(s.Fragment,{children:[s.jsx(w3,{className:"h-5 w-5 text-gray-600"}),"Unblock User"]}):s.jsxs(s.Fragment,{children:[s.jsx(x3,{className:"h-5 w-5 text-red-600"}),"Block User"]})}),s.jsx(Kn,{children:n?"You will start seeing content from this user again":"You won't see content from this user anymore"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 flex items-center gap-3",children:[r.avatar_url?s.jsx("img",{src:r.avatar_url,alt:r.name,className:"w-12 h-12 rounded-full object-cover"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center",children:s.jsx("span",{className:"text-purple-600 font-semibold text-lg",children:r.name.charAt(0).toUpperCase()})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:r.name}),s.jsx("p",{className:"text-sm text-gray-600",children:n?"Currently blocked":"Will be blocked"})]})]}),!n&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"reason",children:"Reason for blocking (Optional, for your reference)"}),s.jsx(as,{id:"reason",placeholder:"Why are you blocking this user?",value:c,onChange:f=>d(f.target.value),disabled:o,rows:3})]}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex gap-3",children:[s.jsx(ag,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-yellow-900",children:[s.jsx("p",{className:"font-medium mb-1",children:"When you block someone:"}),s.jsxs("ul",{className:"text-xs space-y-1 list-disc list-inside",children:[s.jsx("li",{children:"You won't see their events, reviews, or comments"}),s.jsx("li",{children:"They won't be able to see your content"}),s.jsx("li",{children:"They won't be notified that you blocked them"}),s.jsx("li",{children:"You can unblock them at any time"})]})]})]})]}),n&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex gap-3",children:[s.jsx(ag,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-900",children:[s.jsx("p",{className:"font-medium mb-1",children:"When you unblock someone:"}),s.jsxs("ul",{className:"text-xs space-y-1 list-disc list-inside",children:[s.jsx("li",{children:"You'll start seeing their content again"}),s.jsx("li",{children:"They'll be able to see your content"}),s.jsx("li",{children:"You can interact with each other normally"})]})]})]}),s.jsxs(ff,{children:[s.jsx(oe,{type:"button",variant:"outline",onClick:h,disabled:o,children:"Cancel"}),s.jsx(oe,{onClick:u,variant:n?"default":"destructive",disabled:o,children:o?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-4 h-4 mr-2 animate-spin"}),n?"Unblocking...":"Blocking..."]}):s.jsx(s.Fragment,{children:n?s.jsxs(s.Fragment,{children:[s.jsx(w3,{className:"w-4 h-4 mr-2"}),"Unblock User"]}):s.jsxs(s.Fragment,{children:[s.jsx(x3,{className:"w-4 h-4 mr-2"}),"Block User"]})})})]})]})})}function wpe({draftCount:e,onClick:t}){return e<=0?null:s.jsxs("button",{type:"button",onClick:t,className:"relative w-full overflow-hidden rounded-2xl shadow-md bg-gradient-to-br from-[#0e0e0e] via-[#1a1a1a] to-[#3b0b22] text-left focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 focus:ring-offset-background",children:[s.jsx("div",{className:"absolute inset-0 opacity-40 bg-[radial-gradient(circle_at_top,_rgba(255,51,153,0.85),_transparent_55%),_radial-gradient(circle_at_bottom,_rgba(186,104,200,0.8),_transparent_55%)]"}),s.jsxs("div",{className:"relative px-4 py-6 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium tracking-[0.18em] uppercase text-pink-200/90",children:"Drafts"}),s.jsxs("p",{className:"mt-1 text-2xl font-semibold text-white drop-shadow",children:[e," in progress"]}),s.jsx("p",{className:"mt-1 text-xs text-pink-100/90",children:"Tap to jump into your unreviewed shows and drafts."})]}),s.jsxs("div",{className:"ml-4 flex flex-col items-end gap-1 text-[11px] text-pink-100/80",children:[s.jsx("span",{className:"px-2 py-1 rounded-full bg-pink-500/30 border border-pink-300/40",children:"Keep the streak"}),s.jsx("span",{className:"px-2 py-1 rounded-full bg-white/10 border border-white/20",children:"Autosave on"})]})]})]})}const lS=["/Generic Images/1.jpeg","/Generic Images/2.jpeg","/Generic Images/3.jpeg","/Generic Images/4.jpeg","/Generic Images/5.jpeg","/Generic Images/6.jpg","/Generic Images/7.jpg","/Generic Images/8.jpg","/Generic Images/9.webp","/Generic Images/10.jpeg","/Generic Images/11.jpeg","/Generic Images/12.jpeg","/Generic Images/13.jpeg","/Generic Images/14.jpeg","/Generic Images/15.jpeg","/Generic Images/16.jpg","/Generic Images/17.jpeg","/Generic Images/18.jpeg","/Generic Images/19.jpeg","/Generic Images/20.jpeg"],Ij=lS.length;function bpe(e){let t=0;for(let r=0;r<e.length;r+=1)t=(t<<5)-t+e.charCodeAt(r),t|=0;return Math.abs(t)}function Cz(e){if(Ij===0)return"/placeholder.svg";if(!e){const r=Math.floor(Math.random()*Ij);return encodeURI(lS[r])}const t=bpe(e)%Ij;return encodeURI(lS[t])}function vA({review:e,ratingValue:t,stars:r,onSelectReview:n,renderStars:i}){const a=e.event||{},o=e.jambase_events||{},l=a.artist_name||o.artist_name||a.artist_name_normalized||"Unknown Artist",c=a.venue_name||o.venue_name||a.venue_name_normalized||"Unknown Venue";let d;const u=e.Event_date||e.event_date;u&&(u instanceof Date?d=u.toISOString().split("T")[0]:typeof u=="string"&&(d=u)),d||(d=a.event_date||e.created_at);const h=(a==null?void 0:a.artist_id)||e.artist_id||(o==null?void 0:o.artist_id)||null,f=Array.isArray(e.photos)&&e.photos.length>0,p=f?e.photos[0]:void 0,[x,g]=y.useState(null);y.useEffect(()=>{!p&&h&&P.from("artists").select("image_url").eq("id",h).maybeSingle().then(({data:w,error:b})=>{!b&&(w!=null&&w.image_url)&&g(w.image_url)})},[p,h]);const v=`${e.id}-${l}-${c}-${d||""}`,_=p||x||Cz(v);return s.jsxs("button",{type:"button",onClick:()=>n==null?void 0:n(e),className:"w-40 shrink-0 rounded-2xl bg-white border border-pink-100 shadow-sm hover:shadow-md transition-shadow text-left overflow-hidden flex flex-col h-auto min-h-0",children:[s.jsxs("div",{className:"relative h-20 w-full overflow-hidden shrink-0",children:[s.jsx("img",{src:_,alt:`${l} at ${c}`,className:`w-full h-full object-cover transition-transform duration-500 ${f?"":"scale-105"}`,loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 via-black/10 to-transparent","aria-hidden":"true"})]}),s.jsxs("div",{className:"px-3 py-2 space-y-1 flex flex-col flex-grow min-h-0",children:[s.jsx("div",{className:"h-8 min-h-[2rem] flex items-center",children:s.jsx("p",{className:"text-sm font-bold text-gray-900 break-words leading-tight line-clamp-2",children:l})}),s.jsx("p",{className:"text-xs text-gray-600 break-words leading-tight",children:c}),s.jsx("p",{className:"text-[11px] text-gray-400 leading-tight shrink-0",children:d?(()=>{const[w,b,N]=d.split("-").map(Number);return w&&b&&N?new Date(w,b-1,N).toLocaleDateString():d})():""}),t>0?s.jsxs("div",{className:"flex items-center justify-between mt-1 shrink-0",children:[i(t),s.jsxs("span",{className:"text-xs font-semibold text-gray-800",children:[Math.round(t*10)/10,""]})]}):s.jsx("div",{className:"mt-1 shrink-0",children:s.jsx("span",{className:"text-xs text-gray-500",children:"No rating"})})]})]},e.id)}function jpe({reviews:e,onSelectReview:t}){const r=y.useMemo(()=>{const o={1:[],2:[],3:[],4:[],5:[]},l=[];for(const u of e||[]){if(u.review_text==="ATTENDANCE_ONLY"&&!u.was_there)continue;const h=typeof u.category_average=="number"?u.category_average:u.category_average===null||u.category_average===void 0?null:typeof u.rating=="number"?u.rating:u.rating===null||u.rating===void 0?null:0;if(h==null){l.push(u);continue}if(!h||h<=0)continue;const f=Math.floor(h);f>=1&&f<=5&&o[f].push(u)}[5,4,3,2,1].forEach(u=>{const h=o[u]||[];o[u]=h.slice().sort((f,p)=>{var b,N;const x=S=>typeof(S==null?void 0:S.category_average)=="number"?S.category_average:typeof(S==null?void 0:S.rating)=="number"?S.rating:u,g=x(f),v=x(p);if(v!==g)return v-g;const _=(f==null?void 0:f.Event_date)||(f==null?void 0:f.event_date)||((b=f==null?void 0:f.event)==null?void 0:b.event_date)||(f==null?void 0:f.created_at),w=(p==null?void 0:p.Event_date)||(p==null?void 0:p.event_date)||((N=p==null?void 0:p.event)==null?void 0:N.event_date)||(p==null?void 0:p.created_at);return new Date(w).getTime()-new Date(_).getTime()})});const d=l.slice().sort((u,h)=>{var x,g;const f=(u==null?void 0:u.Event_date)||(u==null?void 0:u.event_date)||((x=u==null?void 0:u.event)==null?void 0:x.event_date)||(u==null?void 0:u.created_at),p=(h==null?void 0:h.Event_date)||(h==null?void 0:h.event_date)||((g=h==null?void 0:h.event)==null?void 0:g.event_date)||(h==null?void 0:h.created_at);return new Date(p).getTime()-new Date(f).getTime()});return{buckets:o,unrated:d}},[e]),n=o=>{const l=Math.floor(o*2)/2;return s.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5},(c,d)=>{const u=d+1,h=l>=u,f=!h&&l>=u-.5;return s.jsxs("div",{className:"relative w-3 h-3",children:[s.jsx(Jt,{className:`w-3 h-3 ${h?"text-yellow-400 fill-yellow-400":"text-gray-300"}`}),f&&s.jsx("div",{className:"absolute inset-0 overflow-hidden",style:{width:"50%"},children:s.jsx(Jt,{className:"w-3 h-3 text-yellow-400 fill-yellow-400"})})]},d)})})},i=[{stars:5,label:"5 Star Reviews"},{stars:4,label:"4 Star Reviews"},{stars:3,label:"3 Star Reviews"},{stars:2,label:"2 Star Reviews"},{stars:1,label:"1 Star Reviews"}];return i.some(({stars:o})=>r.buckets[o].length>0)||r.unrated.length>0?s.jsxs("div",{className:"space-y-6 mb-8",children:[i.map(({stars:o,label:l})=>{const c=r.buckets[o];return!c||c.length===0?null:s.jsxs("section",{className:"space-y-2",children:[s.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:[l," ",s.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",c.length,")"]})]}),s.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:c.map(d=>{const u=typeof d.category_average=="number"?d.category_average:typeof d.rating=="number"?d.rating:o;return s.jsx(vA,{review:d,ratingValue:u,stars:o,onSelectReview:t,renderStars:n},d.id)})})]},o)}),r.unrated.length>0&&s.jsxs("section",{className:"space-y-2",children:[s.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:["Unrated Reviews ",s.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",r.unrated.length,")"]})]}),s.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:r.unrated.map(o=>s.jsx(vA,{review:o,ratingValue:0,stars:0,onSelectReview:t,renderStars:n},o.id))})]})]}):null}class Co{static getPassportProgress(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("passport_entries").select("*").eq("user_id",t).order("unlocked_at",{ascending:!1});if(n)throw n;const i=r||[];return{cities:i.filter(a=>a.type==="city"),venues:i.filter(a=>a.type==="venue"),artists:i.filter(a=>a.type==="artist"),scenes:i.filter(a=>a.type==="scene"),totalCount:i.length}}catch(r){return console.error("Error fetching passport progress:",r),{cities:[],venues:[],artists:[],scenes:[],totalCount:0}}})}static unlockPassportEntry(t,r,n,i,a,o){return E(this,null,function*(){try{const{data:l,error:c}=yield P.from("passport_entries").insert({user_id:t,type:r,entity_id:n,entity_uuid:a||null,entity_name:i,metadata:o||{}}).select().single();if(c){if(c.code==="23505"){let d=P.from("passport_entries").select("*").eq("user_id",t).eq("type",r);if(a)d=d.eq("entity_uuid",a);else if(n)d=d.eq("entity_id",n);else return console.warn("PassportService: Cannot fetch duplicate entry - both entityUuid and entityId are null"),null;const{data:u,error:h}=yield d.single();return h?(console.warn("PassportService: Error fetching duplicate entry:",h),null):u}throw c}return l}catch(l){return console.error("Error unlocking passport entry:",l),null}})}static getCitiesVisited(t){return E(this,null,function*(){try{const{count:r}=yield P.from("passport_entries").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("type","city");return r||0}catch(r){return console.error("Error counting cities:",r),0}})}static getIconicVenuesUnlocked(t){return E(this,null,function*(){try{const{count:r}=yield P.from("passport_entries").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("type","venue");return r||0}catch(r){return console.error("Error counting venues:",r),0}})}static getArtistMilestones(t){return E(this,null,function*(){try{const{count:r}=yield P.from("passport_entries").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("type","artist");return r||0}catch(r){return console.error("Error counting artists:",r),0}})}static getSceneParticipation(t){return E(this,null,function*(){try{const{count:r}=yield P.from("passport_entries").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("type","scene");return r||0}catch(r){return console.error("Error counting scenes:",r),0}})}static getNextToUnlock(t){return E(this,null,function*(){var r;try{const n=[],i=yield this.getPassportProgress(t),{data:a}=yield P.from("users").select("location_city, location_state").eq("user_id",t).single();if(a!=null&&a.location_city){const l=new Set(i.cities.map(d=>{var u;return(u=d.entity_id)==null?void 0:u.toLowerCase()})),c=`${a.location_city.toLowerCase()}_${(a.location_state||"").toLowerCase()}`;l.has(c)||n.push({type:"city",entity_name:a.location_city,hint:`Review an event in ${a.location_city} to unlock this city`,progress:i.cities.length,goal:i.cities.length+1})}const{data:o}=yield P.from("events").select("artist_id, artists!inner(name)").gte("event_date",new Date().toISOString()).not("artist_id","is",null).limit(10);if(o&&o.length>0){const l=new Set(i.artists.map(d=>d.entity_id)),c=o.find(d=>{var h;const u=d.artist_id||((h=d.artists)==null?void 0:h.id);return u&&!l.has(u)});if(c){const d=((r=c.artists)==null?void 0:r.name)||"Unknown Artist";n.push({type:"artist",entity_name:d,hint:`Attend a show by ${d} to unlock this artist`,progress:i.artists.length,goal:i.artists.length+1})}}return n.slice(0,3)}catch(n){return console.error("Error getting next to unlock:",n),[]}})}static getPassportIdentity(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("passport_identity").select("*, home_scene:scenes(*)").eq("user_id",t).single();if(n&&n.code!=="PGRST116")throw n;return r}catch(r){return console.error("Error fetching passport identity:",r),null}})}static getStampsByRarity(t,r){return E(this,null,function*(){try{let n=P.from("passport_entries").select("*").eq("user_id",t).order("unlocked_at",{ascending:!1});r&&(n=n.eq("rarity",r));const{data:i,error:a}=yield n;if(a)throw a;return i||[]}catch(n){return console.error("Error fetching stamps by rarity:",n),[]}})}static getTimeline(t,r=20){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("passport_timeline").select("*, review:reviews(*)").eq("user_id",t).order("created_at",{ascending:!1}).limit(r);if(i)throw i;return n||[]}catch(n){return console.error("Error fetching timeline:",n),[]}})}static pinTimelineEvent(t,r){return E(this,null,function*(){try{const{count:n}=yield P.from("passport_timeline").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_pinned",!0);if(n&&n>=5)throw new Error("Maximum of 5 pinned timeline items allowed");const{data:i,error:a}=yield P.from("passport_timeline").upsert({user_id:t,review_id:r,is_pinned:!0,updated_at:new Date().toISOString()},{onConflict:"user_id,review_id"}).select().single();if(a)throw a;return i}catch(n){throw console.error("Error pinning timeline event:",n),n}})}static unpinTimelineEvent(t,r){return E(this,null,function*(){try{const{error:n}=yield P.from("passport_timeline").update({is_pinned:!1}).eq("id",r).eq("user_id",t);if(n)throw n}catch(n){throw console.error("Error unpinning timeline event:",n),n}})}static addTimelineMilestone(t,r,n,i){return E(this,null,function*(){var a,o,l,c;try{const{data:d,error:u}=yield P.from("reviews").select(`
          id,
          event_id,
          artist_id,
          venue_id,
          events:event_id (
            artist_id,
            venue_id
          )
        `).eq("id",r).eq("user_id",t).single();if(u||!d)throw new Error("Review not found");const h=((a=d.events)==null?void 0:a.artist_id)||d.artist_id,f=((o=d.events)==null?void 0:o.venue_id)||d.venue_id;let p=null;if(h||f){const[v,_]=yield Promise.all([h?P.from("artists").select("name").eq("id",h).single():Promise.resolve({data:null}),f?P.from("venues").select("name").eq("id",f).single():Promise.resolve({data:null})]),w=(l=v.data)==null?void 0:l.name,b=(c=_.data)==null?void 0:c.name;w&&b?p=`${w} @ ${b}`:w?p=w:b&&(p=b)}const{data:x,error:g}=yield P.from("passport_timeline").upsert({user_id:t,review_id:r,significance:n,description:i||null,Event_name:p,is_auto_selected:!1,updated_at:new Date().toISOString()},{onConflict:"user_id,review_id"}).select().single();if(g)throw g;return x}catch(d){throw console.error("Error adding timeline milestone:",d),d}})}static updateTimelineMilestone(t,r,n,i){return E(this,null,function*(){try{const{data:a,error:o}=yield P.from("passport_timeline").update({significance:n,description:i!==void 0?i:null,updated_at:new Date().toISOString()}).eq("id",r).eq("user_id",t).select().single();if(o)throw o;return a}catch(a){throw console.error("Error updating timeline milestone:",a),a}})}static deleteTimelineEntry(t,r){return E(this,null,function*(){try{const{error:n}=yield P.from("passport_timeline").delete().eq("id",r).eq("user_id",t);if(n)throw n}catch(n){throw console.error("Error deleting timeline entry:",n),n}})}static getUserReviewsForTimeline(t,r=100){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("reviews").select(`
          id,
          rating,
          review_text,
          created_at,
          event_id,
          artist_id,
          venue_id,
          "Event_date"
        `).eq("user_id",t).eq("is_draft",!1).order("created_at",{ascending:!1}).limit(r);if(i)throw i;return n?yield Promise.all(n.map(o=>E(this,null,function*(){let l=null,c=null,d=null,u=null;if(o.event_id){const{data:f}=yield P.from("events").select("artist_uuid, venue_uuid").eq("id",o.event_id).single();d=(f==null?void 0:f.artist_uuid)||o.artist_id,u=(f==null?void 0:f.venue_uuid)||o.venue_id}else d=o.artist_id,u=o.venue_id;if(d){const{data:f}=yield P.from("artists").select("name").eq("id",d).single();l=(f==null?void 0:f.name)||null}if(u){const{data:f}=yield P.from("venues").select("name").eq("id",u).single();c=(f==null?void 0:f.name)||null}const h=l&&c?`${l} @ ${c}`:l||c||"Event";return W(M({},o),{event:{id:o.event_id||null,title:h,artist_name:l,venue_name:c,event_date:o.Event_date||o.created_at}})}))):[]}catch(n){return console.error("Error fetching user reviews for timeline:",n),[]}})}static getTasteMap(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("passport_taste_map").select("*").eq("user_id",t).maybeSingle();if(n&&n.code!=="PGRST116")throw n;return r}catch(r){return console.error("Error fetching taste map:",r),null}})}static calculateAndUpdateIdentity(t){return E(this,null,function*(){try{const{error:r}=yield P.rpc("recalculate_passport_data",{p_user_id:t});if(r)throw r;return!0}catch(r){return console.error("Error recalculating passport identity:",r),!1}})}}class ry{static getFanType(t){return E(this,null,function*(){try{const r=yield this.getIdentity(t);if(r!=null&&r.fan_type)return r.fan_type;yield this.calculateIdentity(t);const n=yield this.getIdentity(t);return(n==null?void 0:n.fan_type)||null}catch(r){return console.error("Error getting fan type:",r),null}})}static getHomeScene(t){return E(this,null,function*(){try{const r=yield this.getIdentity(t);return(r==null?void 0:r.home_scene)||null}catch(r){return console.error("Error getting home scene:",r),null}})}static getJoinYear(t){return E(this,null,function*(){try{const r=yield this.getIdentity(t);return(r==null?void 0:r.join_year)||null}catch(r){return console.error("Error getting join year:",r),null}})}static getIdentity(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("passport_identity").select("*").eq("user_id",t).single();if(n&&n.code!=="PGRST116")throw n;if(!r)return null;const{data:i,error:a}=yield P.from("users").select("location_city").eq("user_id",t).single();return a&&console.error("Error fetching user location_city:",a),W(M({},r),{home_scene:null,home_city:(i==null?void 0:i.location_city)||null})}catch(r){return console.error("Error fetching passport identity:",r),null}})}static calculateIdentity(t){return E(this,null,function*(){try{const{error:r}=yield P.rpc("update_passport_identity",{p_user_id:t});if(r)throw r;return!0}catch(r){return console.error("Error calculating identity:",r),!1}})}static calculateHomeScene(t){return E(this,null,function*(){return!0})}static getFanTypeDisplay(t){return{jam_chaser:{name:"Jam Chaser",description:"High artist loyalty, following favorite acts across multiple shows"},venue_purist:{name:"Venue Purist",description:"Prefers returning to favorite venues, values consistency and atmosphere"},scene_builder:{name:"Scene Builder",description:"Active participant across multiple music scenes, connects communities"},road_tripper:{name:"Road Tripper",description:"Explores diverse cities and regions, music is a journey"},genre_explorer:{name:"Genre Explorer",description:"Diverse musical tastes, always discovering new sounds"},festival_fanatic:{name:"Festival Fanatic",description:"Loves the festival experience, thrives on variety and community"}}[t||""]||{name:"Music Fan",description:"Building your live music journey"}}}function H2(r){var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("animate-pulse rounded-md bg-muted",e)},t))}const Npe=()=>ua.divIcon({className:"travel-tracker-marker",html:`<div style="
      background-color: #FF3399;
      color: white;
      border: 3px solid white;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    "></div>`,iconSize:[32,32],iconAnchor:[16,32]}),Spe=({reviews:e})=>{const t=tp();return y.useEffect(()=>{if(e.length!==0)try{const r=ua.latLngBounds(e.map(n=>[n.latitude,n.longitude]));r.isValid()&&t.fitBounds(r,{padding:[50,50]})}catch(r){console.error("Error fitting map bounds:",r)}},[t,e]),null},kpe=({userId:e})=>{var u,h,f,p;const[t,r]=y.useState([]),[n,i]=y.useState(!0),[a,o]=y.useState(null),[l,c]=y.useState([39.8283,-98.5795]);y.useEffect(()=>{d()},[e]);const d=()=>E(void 0,null,function*(){i(!0);try{const{data:x,error:g}=yield P.from("reviews").select(`
          id,
          event_id,
          venue_id,
          rating,
          review_text,
          created_at,
          Event_date,
          photos,
          mood_tags,
          genre_tags,
          venues:venue_id (
            id,
            name,
            latitude,
            longitude,
            state,
            street_address
          )
        `).eq("user_id",e).eq("is_draft",!1).not("venue_id","is",null).order("Event_date",{ascending:!1});if(g)throw g;const v=(x||[]).map(_=>{const w=Array.isArray(_.venues)?_.venues[0]:_.venues;if(!w)return null;const b=w.latitude?Number(w.latitude):null,N=w.longitude?Number(w.longitude):null;return b&&N&&!isNaN(b)&&!isNaN(N)&&b>=-90&&b<=90&&N>=-180&&N<=180?{id:_.id,event_id:_.event_id,venue_id:_.venue_id,rating:_.rating,review_text:_.review_text,created_at:_.created_at,Event_date:_.Event_date||_.created_at,venue_name:w.name||null,artist_name:null,event_title:null,latitude:b,longitude:N,venue_city:null,venue_state:w.state||null,photos:_.photos||null,mood_tags:_.mood_tags||null,genre_tags:_.genre_tags||null}:null}).filter(_=>_!==null);if(r(v),v.length>0){const _=v.reduce((b,N)=>b+N.latitude,0)/v.length,w=v.reduce((b,N)=>b+N.longitude,0)/v.length;c([_,w])}}catch(x){console.error("Error loading travel data:",x)}finally{i(!1)}});return n?s.jsxs(He,{children:[s.jsx(xr,{children:s.jsxs(Cr,{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"w-5 h-5 text-synth-pink"}),"Travel Tracker"]})}),s.jsx(st,{children:s.jsx(H2,{className:"h-96 w-full"})})]}):t.length===0?s.jsxs(He,{children:[s.jsx(xr,{children:s.jsxs(Cr,{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"w-5 h-5 text-synth-pink"}),"Travel Tracker"]})}),s.jsxs(st,{className:"text-center py-12 text-muted-foreground",children:[s.jsx(Xt,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"No shows tracked yet"}),s.jsx("p",{className:"text-xs mt-1",children:"Start reviewing shows to see your travel map!"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs(He,{children:[s.jsx(xr,{children:s.jsxs(Cr,{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"w-5 h-5 text-synth-pink"}),"Travel Tracker",s.jsxs(Be,{variant:"secondary",className:"ml-auto",children:[t.length," ",t.length===1?"show":"shows"]})]})}),s.jsx(st,{children:s.jsx("div",{className:"h-96 rounded-lg overflow-hidden border relative z-0",children:s.jsxs(i1,{center:l,zoom:4,style:{height:"100%",width:"100%",zIndex:0},children:[s.jsx(a1,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(Spe,{reviews:t}),t.map(x=>s.jsx(jg,{position:[x.latitude,x.longitude],icon:Npe(),eventHandlers:{click:()=>{o(x)}},children:s.jsx(uU,{maxWidth:300,children:s.jsxs("div",{className:"p-2",children:[s.jsx("div",{className:"font-semibold text-sm mb-1",children:x.venue_name||"Show"}),x.venue_state&&s.jsx("div",{className:"text-xs text-gray-600 mb-1",children:x.venue_state}),s.jsx("div",{className:"text-xs text-gray-500 mb-2",children:Dt(new Date(x.Event_date),"MMM d, yyyy")}),x.rating&&s.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[s.jsx(Jt,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"}),s.jsx("span",{children:x.rating.toFixed(1)})]}),s.jsx("button",{onClick:()=>o(x),className:"mt-2 text-xs text-synth-pink hover:underline",children:"View Review "})]})})},x.id))]})})})]}),s.jsx(tn,{open:!!a,onOpenChange:()=>o(null),children:s.jsx(Xr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:a&&s.jsxs(s.Fragment,{children:[s.jsx(Mn,{children:s.jsxs(an,{className:"flex items-center gap-2",children:[s.jsx(Ct,{className:"w-5 h-5 text-synth-pink"}),a.venue_name||"Show Review"]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[a.venue_name&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Xt,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{className:"font-medium",children:a.venue_name}),a.venue_state&&s.jsx("span",{className:"text-muted-foreground",children:a.venue_state})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Et,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{children:Dt(new Date(a.Event_date),"MMMM d, yyyy")})]}),a.rating&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Jt,{className:"w-5 h-5 fill-yellow-400 text-yellow-400"}),s.jsx("span",{className:"text-lg font-semibold",children:a.rating.toFixed(1)})]})]}),a.review_text&&s.jsx("div",{className:"pt-2 border-t",children:s.jsx("p",{className:"text-sm whitespace-pre-wrap",children:a.review_text})}),(((u=a.mood_tags)==null?void 0:u.length)||((h=a.genre_tags)==null?void 0:h.length))&&s.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t",children:[(f=a.mood_tags)==null?void 0:f.map((x,g)=>s.jsx(Be,{variant:"secondary",className:"text-xs",children:x},`mood-${g}`)),(p=a.genre_tags)==null?void 0:p.map((x,g)=>s.jsx(Be,{variant:"outline",className:"text-xs",children:x},`genre-${g}`))]}),a.photos&&a.photos.length>0&&s.jsx("div",{className:"pt-2 border-t",children:s.jsx("div",{className:"grid grid-cols-2 gap-2",children:a.photos.slice(0,4).map((x,g)=>s.jsx("img",{src:x,alt:`Review photo ${g+1}`,className:"w-full h-32 object-cover rounded-lg"},g))})})]})]})})})]})},Epe=({userId:e,userName:t})=>{const[r,n]=y.useState(null),[i,a]=y.useState(!0);y.useEffect(()=>{o()},[e]);const o=()=>E(void 0,null,function*(){a(!0);try{let c=yield ry.getIdentity(e);c||(yield ry.calculateIdentity(e),c=yield ry.getIdentity(e)),n(c)}catch(c){console.error("Error loading passport identity:",c)}finally{a(!1)}});if(i)return s.jsxs("div",{className:"space-y-4",children:[s.jsx(H2,{className:"h-32 w-full"}),s.jsx(H2,{className:"h-24 w-full"})]});if(!r)return s.jsx(He,{children:s.jsx(st,{className:"p-6 text-center text-muted-foreground",children:s.jsx("p",{children:"Identity calculation in progress..."})})});const l=ry.getFanTypeDisplay(r.fan_type);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs(He,{className:"border-2 border-synth-pink/20 bg-gradient-to-br from-white to-pink-50/30",children:[s.jsx(xr,{children:s.jsxs(Cr,{className:"text-2xl font-bold flex items-center gap-2",children:[s.jsx(Ct,{className:"w-6 h-6 text-synth-pink"}),t?`${t}'s`:"Your"," Passport"]})}),s.jsxs(st,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Be,{variant:"secondary",className:"text-base px-4 py-2 bg-synth-pink/10 text-synth-pink border-synth-pink/30",children:l.name}),s.jsx("p",{className:"text-sm text-muted-foreground flex-1",children:l.description})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Et,{className:"w-4 h-4 text-muted-foreground"}),s.jsxs("span",{className:"font-medium",children:["Live since ",r.join_year]})]}),r.home_city&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Xt,{className:"w-4 h-4 text-muted-foreground"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"font-medium",children:"Home Scene: "}),s.jsx("span",{className:"text-muted-foreground",children:r.home_city})]})]}),!r.home_city&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Xt,{className:"w-4 h-4"}),s.jsx("span",{children:"No location set"})]})]})]}),s.jsx(kpe,{userId:e})]})},Cpe=e=>{switch(e){case"legendary":return{border:"border-purple-400",bg:"bg-gradient-to-br from-purple-50/90 to-pink-50/90",badge:"bg-purple-100 text-purple-800 border-purple-300",icon:s.jsx(bl,{className:"w-3 h-3"})};case"uncommon":return{border:"border-blue-400",bg:"bg-gradient-to-br from-blue-50/90 to-cyan-50/90",badge:"bg-blue-100 text-blue-800 border-blue-300",icon:s.jsx(oa,{className:"w-3 h-3"})};default:return{border:"border-yellow-300",bg:"bg-gradient-to-br from-yellow-50/80 to-amber-50/80",badge:"bg-yellow-100 text-yellow-800 border-yellow-300",icon:s.jsx(Gs,{className:"w-3 h-3"})}}},Ppe=({entry:e,onClick:t,className:r,showProgress:n=!1,progress:i,goal:a})=>{var h;y.useState(!1);const o=!!e.unlocked_at,l=i&&a?Math.min(i/a*100,100):0,c=Cpe(e.rarity),d=()=>{if(!e.metadata)return null;if(e.type==="festival"&&e.metadata.years_attended){const f=e.metadata.years_attended;return s.jsxs("p",{className:"text-xs text-muted-foreground mb-1",children:["Attended ",f.length," ",f.length===1?"time":"times"," (",f.join(", "),")"]})}return e.type==="artist_milestone"&&e.metadata.show_count?s.jsxs("p",{className:"text-xs text-muted-foreground mb-1",children:[e.metadata.show_count," shows",e.metadata.year_span>=3&&`  ${e.metadata.year_span} years`]}):e.type==="era"&&e.metadata.event_count?s.jsxs("p",{className:"text-xs text-muted-foreground mb-1",children:[e.metadata.event_count," events  ",e.metadata.year_span," years"]}):null},u=s.jsxs(He,{className:ke("cursor-pointer transition-all hover:shadow-md relative overflow-hidden",o?`border-2 ${c.border} ${c.bg}`:"border-gray-200 bg-gray-50 opacity-75",r),onClick:t,children:[s.jsxs(st,{className:"p-4",children:[s.jsx("div",{className:"flex items-start justify-between mb-2",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[s.jsx("h4",{className:"font-semibold text-sm",children:e.entity_name}),o&&e.rarity&&s.jsxs(Be,{variant:"outline",className:ke("text-xs",c.badge),children:[c.icon,s.jsx("span",{className:"ml-1 capitalize",children:e.rarity})]}),o&&!e.rarity&&s.jsxs(Be,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 text-xs",children:[s.jsx(Gs,{className:"w-3 h-3 mr-1"}),"Unlocked"]}),!o&&s.jsx(og,{className:"w-4 h-4 text-gray-400"})]}),d(),((h=e.metadata)==null?void 0:h.description)&&s.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:e.metadata.description}),o&&e.unlocked_at&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Unlocked ",Dt(new Date(e.unlocked_at),"MMM d, yyyy")]})]})}),n&&!o&&i!==void 0&&a!==void 0&&s.jsxs("div",{className:"mt-3 space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-muted-foreground",children:"Progress"}),s.jsxs("span",{className:"font-semibold",children:[i,"/",a]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:s.jsx("div",{className:"bg-synth-pink h-1.5 rounded-full transition-all",style:{width:`${l}%`}})})]})]}),o&&s.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[s.jsx("div",{className:ke("absolute top-0 left-0 w-8 h-8 border-t-2 border-l-2 rounded-tl-lg",c.border)}),s.jsx("div",{className:ke("absolute top-0 right-0 w-8 h-8 border-t-2 border-r-2 rounded-tr-lg",c.border)}),s.jsx("div",{className:ke("absolute bottom-0 left-0 w-8 h-8 border-b-2 border-l-2 rounded-bl-lg",c.border)}),s.jsx("div",{className:ke("absolute bottom-0 right-0 w-8 h-8 border-b-2 border-r-2 rounded-br-lg",c.border)})]})]});return e.cultural_context&&o?s.jsx(oE,{children:s.jsxs(qI,{children:[s.jsx(WI,{asChild:!0,children:u}),s.jsx(lE,{className:"max-w-xs",children:s.jsx("p",{className:"text-sm",children:e.cultural_context})})]})}):u},Ape=({stamps:e,achievements:t=[],loading:r=!1})=>{var f,p,x,g;const[n,i]=y.useState("all"),[a,o]=y.useState("all"),l=e.reduce((v,_)=>(v[_.type]||(v[_.type]=[]),v[_.type].push(_),v),{}),c=t.filter(v=>v.unlocked),d=e.filter(v=>!(n!=="all"&&v.type!==n||a!=="all"&&v.rarity!==a)),u={all:e.length,city:((f=l.city)==null?void 0:f.length)||0,venue:((p=l.venue)==null?void 0:p.length)||0,artist:((x=l.artist)==null?void 0:x.length)||0,scene:((g=l.scene)==null?void 0:g.length)||0,completed_achievements:c.length},h={all:e.length,common:e.filter(v=>v.rarity==="common").length,uncommon:e.filter(v=>v.rarity==="uncommon").length,legendary:e.filter(v=>v.rarity==="legendary").length};return r?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading stamps..."}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsxs(Xs,{value:n,onValueChange:i,children:[s.jsx(Ds,{className:"w-[180px] bg-white",children:s.jsx(Js,{placeholder:"Filter by type"})}),s.jsxs(Is,{className:"bg-white",children:[s.jsxs(Lt,{value:"all",children:["All Types (",u.all,")"]}),s.jsxs(Lt,{value:"city",children:["Cities (",u.city,")"]}),s.jsxs(Lt,{value:"venue",children:["Venues (",u.venue,")"]}),s.jsxs(Lt,{value:"artist",children:["Artists (",u.artist,")"]}),s.jsxs(Lt,{value:"scene",children:["Scenes (",u.scene,")"]}),s.jsxs(Lt,{value:"completed_achievements",children:["Completed Achievements (",u.completed_achievements,")"]})]})]}),n!=="completed_achievements"&&s.jsxs(Xs,{value:a,onValueChange:o,children:[s.jsx(Ds,{className:"w-[180px] bg-white",children:s.jsx(Js,{placeholder:"Filter by rarity"})}),s.jsxs(Is,{className:"bg-white",children:[s.jsxs(Lt,{value:"all",children:["All Rarities (",h.all,")"]}),s.jsxs(Lt,{value:"common",children:["Common (",h.common,")"]}),s.jsxs(Lt,{value:"uncommon",children:["Uncommon (",h.uncommon,")"]}),s.jsxs(Lt,{value:"legendary",children:["Legendary (",h.legendary,")"]})]})]})]}),n==="completed_achievements"?c.length===0?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:s.jsx("p",{children:"No completed achievements yet."})}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(v=>{const _={gold:"border-yellow-200 bg-yellow-50",silver:"border-gray-200 bg-gray-50",bronze:"border-orange-200 bg-orange-50"};return s.jsx(He,{className:`border-2 ${_[v.tier||"bronze"]}`,children:s.jsx(st,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"text-3xl",children:v.icon}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h4",{className:"font-semibold",children:v.name.replace(/\s+\([^)]+\)$/,"")}),s.jsx(bl,{className:"w-4 h-4 text-muted-foreground"})]}),s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:v.description}),v.unlocked_at&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Unlocked ",new Date(v.unlocked_at).toLocaleDateString()]})]})]})})},v.id||v.type)})}):d.length===0?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:s.jsx("p",{children:"No stamps found with selected filters."})}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(v=>s.jsx(Ppe,{entry:v},v.id))})]})},xA=({isOpen:e,onClose:t,userId:r,existingReviewId:n,existingSignificance:i,existingDescription:a,onSuccess:o})=>{var $,R,F,D,B;const[l,c]=y.useState([]),[d,u]=y.useState(n||""),[h,f]=y.useState("best_setlist"),[p,x]=y.useState(i||""),[g,v]=y.useState(""),[_,w]=y.useState(!1),[b,N]=y.useState(!1),{toast:S}=jr();y.useEffect(()=>{if(e&&(k(),n)){u(n);const U=i||"";U.toLowerCase().includes("best setlist")?(f("best_setlist"),x(a||"")):U.toLowerCase().includes("first time seeing")?(f("first_favorite_artist"),x(a||"")):U.toLowerCase().includes("first time at")?(f("first_favorite_venue"),x(a||"")):(f("custom"),v(U||""),x(a||""))}},[e,n,i,a]);const k=()=>E(void 0,null,function*(){N(!0);try{const U=yield Co.getUserReviewsForTimeline(r,100);c(U)}catch(U){console.error("Error loading reviews:",U),S({title:"Error",description:"Failed to load reviews",variant:"destructive"})}finally{N(!1)}}),O=()=>E(void 0,null,function*(){var K,Z;if(!n&&!d){S({title:"Selection required",description:"Please select a review",variant:"destructive"});return}const U=n||d;if(!U)return;const V=l.find(G=>G.id===U);let Y="",z=null;if(h==="best_setlist")Y="Best setlist",z=p.trim()||null;else if(h==="first_favorite_artist")Y="First time seeing "+(((K=V==null?void 0:V.event)==null?void 0:K.artist_name)||"this artist"),z=p.trim()||null;else if(h==="first_favorite_venue")Y="First time at "+(((Z=V==null?void 0:V.event)==null?void 0:Z.venue_name)||"this venue"),z=p.trim()||null;else if(h==="custom"){if(!g.trim()){S({title:"Milestone name required",description:"Please name your custom milestone",variant:"destructive"});return}Y=g.trim(),z=p.trim()||null}w(!0);try{if(n){const X=(yield Co.getTimeline(r,1e3)).find(te=>te.review_id===n);if(!X)throw new Error("Timeline entry not found");yield Co.updateTimelineMilestone(r,X.id,Y,z)}else yield Co.addTimelineMilestone(r,d,Y,z);S({title:"Success",description:"Timeline milestone added successfully"}),o(),A()}catch(G){console.error("Error saving timeline milestone:",G),S({title:"Error",description:"Failed to save timeline milestone",variant:"destructive"})}finally{w(!1)}}),A=()=>{_||(u(""),f("best_setlist"),x(""),v(""),t())},T=l.find(U=>U.id===d);return s.jsx(tn,{open:e,onOpenChange:U=>{!U&&!_&&A()},children:s.jsxs(Xr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Mn,{children:[s.jsx(an,{children:n?"Edit Timeline Milestone":"Add Timeline Milestone"}),s.jsx(Kn,{children:"Mark a special moment in your music journey. Choose a review and tell us why it's significant."})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[!n&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"review",children:"Select Review"}),b?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(er,{className:"h-6 w-6 animate-spin text-synth-pink"})}):s.jsxs(Xs,{value:d,onValueChange:u,children:[s.jsx(Ds,{id:"review",children:s.jsx(Js,{placeholder:"Choose a review..."})}),s.jsx(Is,{className:"z-[10000] bg-white",children:l.map(U=>{var V,Y,z;return s.jsx(Lt,{value:U.id,children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("span",{className:"font-medium",children:[((V=U.event)==null?void 0:V.artist_name)||"Unknown Artist"," @ ",((Y=U.event)==null?void 0:Y.venue_name)||"Unknown Venue"]}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:[(z=U.event)!=null&&z.event_date?Dt(new Date(U.event.event_date),"MMM d, yyyy"):Dt(new Date(U.created_at),"MMM d, yyyy"),U.rating&&`  ${U.rating.toFixed(1)}`]})]})},U.id)})})]}),T&&s.jsxs("div",{className:"mt-2 p-3 bg-muted rounded-lg",children:[s.jsxs("div",{className:"text-sm font-medium",children:[($=T.event)==null?void 0:$.artist_name," @ ",(R=T.event)==null?void 0:R.venue_name]}),s.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:(F=T.event)!=null&&F.event_date?Dt(new Date(T.event.event_date),"MMM d, yyyy"):Dt(new Date(T.created_at),"MMM d, yyyy")}),T.review_text&&s.jsx("div",{className:"text-sm mt-2 line-clamp-2",children:T.review_text})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"milestone-type",children:"What makes this moment significant?"}),s.jsxs(Xs,{value:h,onValueChange:U=>{f(U),U!=="custom"&&(v(""),x(""))},children:[s.jsx(Ds,{id:"milestone-type",children:s.jsx(Js,{})}),s.jsxs(Is,{className:"z-[10000] bg-white",children:[s.jsx(Lt,{value:"best_setlist",children:"Best Setlist"}),s.jsx(Lt,{value:"first_favorite_artist",children:"First Time Seeing Favorite Artist"}),s.jsx(Lt,{value:"first_favorite_venue",children:"First Time at Favorite Venue"}),s.jsx(Lt,{value:"custom",children:"Custom Milestone"})]})]})]}),h==="custom"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"custom-milestone-name",children:"Milestone Name"}),s.jsx(or,{id:"custom-milestone-name",placeholder:"e.g., First festival, Best encore, Special guest appearance...",value:g,onChange:U=>v(U.target.value),maxLength:100}),s.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[g.length,"/100"]})]}),(h==="custom"||h==="best_setlist")&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"significance",children:h==="best_setlist"?"Why was this the best setlist?":"Description (optional)"}),s.jsx(as,{id:"significance",placeholder:h==="best_setlist"?"Tell us what made this setlist stand out...":"Describe why this moment is significant...",value:p,onChange:U=>x(U.target.value),rows:4,maxLength:500}),s.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[p.length,"/500"]})]}),h==="first_favorite_artist"&&T&&s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-blue-900",children:["This will mark this as your first time seeing ",s.jsx("strong",{children:((D=T.event)==null?void 0:D.artist_name)||"this artist"})," as your favorite artist."]})}),h==="first_favorite_venue"&&T&&s.jsx("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-purple-900",children:["This will mark this as your first time at ",s.jsx("strong",{children:((B=T.event)==null?void 0:B.venue_name)||"this venue"})," as your favorite venue."]})})]}),s.jsxs(ff,{children:[s.jsx(oe,{type:"button",variant:"outline",onClick:A,disabled:_,children:"Cancel"}),s.jsx(oe,{type:"button",onClick:O,disabled:_||!n&&!d,children:_?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):n?"Update":"Add to Timeline"})]})]})})},Tpe=({userId:e})=>{const[t,r]=y.useState([]),[n,i]=y.useState(!0),[a,o]=y.useState(0),[l,c]=y.useState(!1),[d,u]=y.useState(null),{toast:h}=jr();y.useEffect(()=>{f()},[e]);const f=()=>E(void 0,null,function*(){i(!0);try{const b=yield Co.getTimeline(e);r(b),o(b.filter(N=>N.is_pinned).length)}catch(b){console.error("Error loading timeline:",b)}finally{i(!1)}}),p=(b,N)=>E(void 0,null,function*(){try{if(N)yield Co.unpinTimelineEvent(e,b),h({title:"Unpinned",description:"Event removed from pinned timeline"});else{if(a>=5){h({title:"Maximum pins reached",description:"You can pin a maximum of 5 timeline events",variant:"destructive"});return}const S=t.find(k=>k.id===b);S!=null&&S.review_id&&(yield Co.pinTimelineEvent(e,S.review_id),h({title:"Pinned",description:"Event pinned to timeline"}))}yield f()}catch(S){console.error("Error toggling pin:",S),h({title:"Error",description:"Failed to update pin status",variant:"destructive"})}}),x=b=>{if(!b.significance)return{icon:oa,color:"text-synth-pink",bg:"bg-synth-pink/10"};const N=b.significance.toLowerCase();return N.includes("first review")?{icon:_2,color:"text-yellow-600",bg:"bg-yellow-100"}:N.includes("first time seeing")?{icon:Ct,color:"text-blue-600",bg:"bg-blue-100"}:N.includes("first time at")?{icon:Xt,color:"text-purple-600",bg:"bg-purple-100"}:N.includes("best setlist")?{icon:IJ,color:"text-indigo-600",bg:"bg-indigo-100"}:{icon:Jt,color:"text-pink-600",bg:"bg-pink-100"}},g=y.useMemo(()=>[...t].sort((b,N)=>b.is_pinned&&!N.is_pinned?-1:!b.is_pinned&&N.is_pinned?1:new Date(N.created_at).getTime()-new Date(b.created_at).getTime()),[t]);if(n)return s.jsx("div",{className:"space-y-4",children:[...Array(3)].map((b,N)=>s.jsx(H2,{className:"h-32 w-full"},N))});const v=()=>{u(null),c(!0)},_=b=>{u(b),c(!0)},w=()=>{f()};return t.length===0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[s.jsx(oa,{className:"w-12 h-12 mx-auto mb-4 text-synth-pink/30"}),s.jsx("p",{className:"font-medium",children:"No timeline highlights yet."}),s.jsx("p",{className:"text-sm mt-2",children:"Mark special moments in your music journey."}),s.jsxs(oe,{onClick:v,className:"mt-4",variant:"default",children:[s.jsx(eo,{className:"w-4 h-4 mr-2"}),"Add Your First Milestone"]})]}),s.jsx(xA,{isOpen:l,onClose:()=>c(!1),userId:e,existingReviewId:(d==null?void 0:d.review_id)||void 0,existingSignificance:(d==null?void 0:d.significance)||void 0,existingDescription:(d==null?void 0:d.description)||void 0,onSuccess:w})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"mb-6 flex justify-end",children:s.jsxs(oe,{onClick:v,variant:"outline",size:"sm",children:[s.jsx(eo,{className:"w-4 h-4 mr-2"}),"Add Milestone"]})}),s.jsx("div",{className:"absolute left-7 sm:left-9 top-0 bottom-0 w-0.5 bg-gradient-to-b from-synth-pink/30 via-synth-pink/40 to-synth-pink/20"}),s.jsx("div",{className:"space-y-8",children:g.map((b,N)=>{var T,$,R;const S=x(b),k=S.icon,O=(T=b.review)!=null&&T.Event_date?new Date(b.review.Event_date):new Date(b.created_at),A=!b.is_auto_selected;return s.jsxs("div",{className:"relative pl-16 sm:pl-20",children:[s.jsxs("div",{className:"absolute left-0 top-0 flex flex-col items-end pr-2 w-14 sm:w-16",children:[s.jsxs("div",{className:ke("mb-2 px-1.5 py-0.5 rounded text-[10px] sm:text-xs font-semibold whitespace-nowrap shadow-sm text-center w-full",b.is_pinned?"bg-synth-pink text-white":"bg-gray-100 text-gray-700"),children:[s.jsx("div",{className:"leading-tight",children:Dt(O,"MMM")}),s.jsx("div",{className:"leading-tight font-bold",children:Dt(O,"d")}),s.jsx("div",{className:"leading-tight text-[9px] sm:text-[10px] opacity-75",children:Dt(O,"yyyy")})]}),s.jsx("div",{className:ke("w-8 h-8 sm:w-10 sm:h-10 rounded-full border-2 border-white shadow-lg flex items-center justify-center z-10 transition-all duration-300 mx-auto",b.is_pinned?"bg-synth-pink ring-4 ring-synth-pink/30 scale-110 shadow-xl shadow-synth-pink/40":`${S.bg} ring-2 ring-white/80`),children:s.jsx(k,{className:ke("w-4 h-4 sm:w-5 sm:h-5",b.is_pinned?"text-white":S.color)})})]}),s.jsxs(He,{className:ke("relative overflow-hidden transition-all duration-300 hover:shadow-xl w-full max-w-full",b.is_pinned?"border-2 border-synth-pink shadow-lg shadow-synth-pink/20 bg-gradient-to-br from-white to-synth-pink/5":"border border-gray-200 bg-white hover:border-synth-pink/30"),children:[s.jsx(st,{className:"p-4 sm:p-6",children:s.jsxs("div",{className:"flex items-start justify-between gap-3 sm:gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0 overflow-x-hidden",children:[b.significance&&s.jsx("div",{className:"mb-3 sm:mb-4",children:s.jsxs("div",{className:ke("inline-flex items-center gap-1.5 sm:gap-2 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg font-bold text-sm sm:text-base mb-2 sm:mb-3 break-words",b.is_pinned?"bg-synth-pink/10 text-synth-pink border-2 border-synth-pink/30":`${S.bg} ${S.color} border-2 border-current/20`),children:[s.jsx(k,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),s.jsx("span",{className:"break-words",children:b.significance})]})}),b.Event_name&&s.jsx("h4",{className:"font-bold text-base sm:text-lg text-gray-900 mb-2 sm:mb-3 break-words",children:b.Event_name}),(($=b.review)==null?void 0:$.rating)&&s.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 mb-3 sm:mb-4",children:[[...Array(5)].map((F,D)=>s.jsx(Jt,{className:ke("w-4 h-4 sm:w-5 sm:h-5 transition-colors flex-shrink-0",D<Math.round(b.review.rating)?"fill-yellow-400 text-yellow-400":"fill-gray-200 text-gray-200")},D)),s.jsx("span",{className:"text-xs sm:text-sm font-semibold text-gray-700 ml-1 flex-shrink-0",children:b.review.rating.toFixed(1)})]}),((R=b.review)==null?void 0:R.review_text)&&s.jsx("p",{className:"text-xs sm:text-sm text-gray-700 leading-relaxed line-clamp-3 break-words",children:b.review.review_text})]}),s.jsxs("div",{className:"flex flex-col items-end gap-2 shrink-0",children:[b.is_pinned&&s.jsxs(Be,{className:"bg-synth-pink text-white border-0 text-xs",children:[s.jsx(Xb,{className:"w-3 h-3 mr-1 fill-current"}),"Pinned"]}),s.jsxs("div",{className:"flex gap-1",children:[A&&s.jsx(oe,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full text-gray-400 hover:text-synth-pink hover:bg-synth-pink/5",onClick:()=>_(b),title:"Edit milestone",children:s.jsx(eI,{className:"w-4 h-4"})}),s.jsx(oe,{variant:"ghost",size:"sm",className:ke("h-8 w-8 p-0 rounded-full transition-all",b.is_pinned?"text-synth-pink hover:bg-synth-pink/10":"text-gray-400 hover:text-synth-pink hover:bg-synth-pink/5"),onClick:()=>p(b.id,b.is_pinned),disabled:!b.is_pinned&&a>=5,title:b.is_pinned?"Unpin":"Pin to timeline",children:b.is_pinned?s.jsx(Xb,{className:"w-4 h-4 fill-current"}):s.jsx(Xb,{className:"w-4 h-4"})})]})]})]})}),b.is_pinned&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-synth-pink via-synth-pink-light to-transparent"})]})]},b.id)})})]}),s.jsx(xA,{isOpen:l,onClose:()=>c(!1),userId:e,existingReviewId:(d==null?void 0:d.review_id)||void 0,existingSignificance:(d==null?void 0:d.significance)||void 0,existingDescription:(d==null?void 0:d.description)||void 0,onSuccess:w})]})};class ny{static getBucketList(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("bucket_list").select("*").eq("user_id",t).order("added_at",{ascending:!1});if(n)throw n;return yield Promise.all((r||[]).map(a=>E(this,null,function*(){if(a.entity_type==="artist"){const{data:o}=yield P.from("artists").select("id, name, image_url").eq("id",a.entity_id).single();return W(M({},a),{artist:o||void 0})}else if(a.entity_type==="venue"){const{data:o}=yield P.from("venues").select("id, name, image_url").eq("id",a.entity_id).single();return W(M({},a),{venue:o||void 0})}return a})))}catch(r){return console.error("Error fetching bucket list:",r),[]}})}static addArtist(t,r,n){return E(this,null,function*(){try{const{error:i}=yield P.from("bucket_list").insert({user_id:t,entity_type:"artist",entity_id:r,entity_name:n});if(i){if(i.code==="23505")return!0;throw i}return!0}catch(i){return console.error("Error adding artist to bucket list:",i),!1}})}static addVenue(t,r,n){return E(this,null,function*(){try{const{error:i}=yield P.from("bucket_list").insert({user_id:t,entity_type:"venue",entity_id:r,entity_name:n});if(i){if(i.code==="23505")return!0;throw i}return!0}catch(i){return console.error("Error adding venue to bucket list:",i),!1}})}static removeItem(t,r){return E(this,null,function*(){try{const{error:n}=yield P.from("bucket_list").delete().eq("id",r).eq("user_id",t);if(n)throw n;return!0}catch(n){return console.error("Error removing item from bucket list:",n),!1}})}static removeEntity(t,r,n){return E(this,null,function*(){try{const{error:i}=yield P.from("bucket_list").delete().eq("user_id",t).eq("entity_type",r).eq("entity_id",n);if(i)throw i;return!0}catch(i){return console.error("Error removing entity from bucket list:",i),!1}})}static isInBucketList(t,r,n){return E(this,null,function*(){try{const{data:i,error:a}=yield P.from("bucket_list").select("id").eq("user_id",t).eq("entity_type",r).eq("entity_id",n).single();if(a&&a.code!=="PGRST116")throw a;return!!i}catch(i){return console.error("Error checking bucket list:",i),!1}})}static searchBucketList(t,r,n=50){return E(this,null,function*(){try{if(!r.trim())return yield this.getBucketList(t);const{data:i,error:a}=yield P.rpc("search_bucket_list",{p_user_id:t,p_search_query:r.trim(),p_limit:n});if(a)throw a;return(i||[]).map(o=>({id:o.id,user_id:o.user_id,entity_type:o.entity_type,entity_id:o.entity_id,entity_name:o.entity_name,added_at:o.added_at,metadata:o.metadata||{},artist:o.artist_id?{id:o.artist_id,name:o.artist_name||o.entity_name,image_url:o.artist_image_url||void 0}:void 0,venue:o.venue_id?{id:o.venue_id,name:o.venue_name||o.entity_name,image_url:o.venue_image_url||void 0}:void 0}))}catch(i){return console.error("Error searching bucket list:",i),[]}})}}const Ope=({userId:e})=>{const[t,r]=y.useState([]),[n,i]=y.useState(!0),[a,o]=y.useState(!1),[l,c]=y.useState(!1),[d,u]=y.useState(!1),[h,f]=y.useState(!1);y.useEffect(()=>{p()},[e]);const p=()=>E(void 0,null,function*(){i(!0);try{const w=yield ny.getBucketList(e);r(w)}catch(w){console.error("Error loading bucket list:",w)}finally{i(!1)}}),x=w=>E(void 0,null,function*(){u(!0);try{(yield ny.addArtist(e,w.id,w.name))&&(o(!1),yield p())}catch(b){console.error("Error adding artist:",b)}finally{u(!1)}}),g=w=>E(void 0,null,function*(){u(!0);try{(yield ny.addVenue(e,w.id,w.name))&&(c(!1),yield p())}catch(b){console.error("Error adding venue:",b)}finally{u(!1)}}),v=w=>E(void 0,null,function*(){try{(yield ny.removeItem(e,w))&&(yield p())}catch(b){console.error("Error removing item:",b)}}),_=w=>{w.entity_type==="artist"?window.dispatchEvent(new CustomEvent("open-artist-card",{detail:{artistId:w.entity_id,artistName:w.entity_name}})):w.entity_type==="venue"&&window.dispatchEvent(new CustomEvent("open-venue-card",{detail:{venueId:w.entity_id,venueName:w.entity_name}}))};return n?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(er,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):s.jsxs("div",{className:"space-y-4 overflow-visible",children:[s.jsx(He,{className:h?"mb-4":"",style:{overflow:"visible"},children:s.jsxs(st,{className:"p-4",style:{overflow:"visible"},children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[s.jsxs(oe,{variant:"outline",onClick:()=>{o(!a),c(!1),f(!1)},className:"flex-1",children:[s.jsx(eo,{className:"w-4 h-4 mr-2"}),"Add Artist"]}),s.jsxs(oe,{variant:"outline",onClick:()=>{c(!l),o(!1),f(!1)},className:"flex-1",children:[s.jsx(eo,{className:"w-4 h-4 mr-2"}),"Add Venue"]})]}),a&&s.jsxs("div",{className:"mt-4 relative",style:{zIndex:1e3},children:[s.jsx(TE,{onArtistSelect:x,placeholder:"Search for an artist to add...",onSearchStateChange:f}),d&&s.jsxs("div",{className:"flex items-center justify-center mt-2",children:[s.jsx(er,{className:"w-4 h-4 animate-spin text-muted-foreground mr-2"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"Adding..."})]})]}),l&&s.jsxs("div",{className:"mt-4 relative",style:{zIndex:1e3},children:[s.jsx(pF,{onVenueSelect:g,placeholder:"Search for a venue to add...",onSearchStateChange:f}),d&&s.jsxs("div",{className:"flex items-center justify-center mt-2",children:[s.jsx(er,{className:"w-4 h-4 animate-spin text-muted-foreground mr-2"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"Adding..."})]})]})]})}),!h&&s.jsx(s.Fragment,{children:t.length===0?s.jsx(He,{children:s.jsxs(st,{className:"p-8 text-center",children:[s.jsx("p",{className:"text-muted-foreground mb-2",children:"Your bucket list is empty"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Add artists or venues to get notified when new shows are announced!"})]})}):s.jsx("div",{className:"max-h-[600px] overflow-y-auto pr-2 space-y-3",children:t.map(w=>{var b,N,S,k;return s.jsx(He,{className:"cursor-pointer hover:shadow-md transition-shadow border-2 hover:border-synth-pink/50",onClick:()=>_(w),children:s.jsx(st,{className:"p-3",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Vr,{className:"h-10 w-10 flex-shrink-0",children:w.entity_type==="artist"&&((b=w.artist)!=null&&b.image_url)||w.entity_type==="venue"&&((N=w.venue)!=null&&N.image_url)?s.jsx(Qr,{src:w.entity_type==="artist"?(S=w.artist)==null?void 0:S.image_url:(k=w.venue)==null?void 0:k.image_url,alt:w.entity_name}):s.jsx(qr,{className:"text-xs",children:w.entity_type==="artist"?s.jsx(Ct,{className:"w-5 h-5"}):s.jsx(Ba,{className:"w-5 h-5"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("h4",{className:"font-semibold text-sm truncate",children:w.entity_name}),s.jsx(oe,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 flex-shrink-0 hover:bg-red-100 hover:text-red-600",onClick:O=>{O.stopPropagation(),v(w.id)},children:s.jsx(pr,{className:"w-3 h-3"})})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx(Be,{variant:"secondary",className:`text-xs ${w.entity_type==="artist"?"bg-pink-100 text-pink-700":"bg-blue-100 text-blue-700"}`,children:w.entity_type==="artist"?s.jsxs(s.Fragment,{children:[s.jsx(Ct,{className:"w-2.5 h-2.5 mr-1"}),"Artist"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ba,{className:"w-2.5 h-2.5 mr-1"}),"Venue"]})}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:["Added ",new Date(w.added_at).toLocaleDateString()]})]})]})]})})},w.id)})})})]})};class Rpe{static getBehavioralAchievements(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("achievements").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(n)throw n;const{data:i,error:a}=yield P.from("user_achievement_progress").select("*").eq("user_id",t);if(a)throw a;const o=new Map;(i||[]).forEach(c=>{o.set(c.achievement_id,c)});const l=[];return(r||[]).forEach(c=>{const d=o.get(c.id),u=(d==null?void 0:d.current_progress)||0,h=(d==null?void 0:d.highest_tier_achieved)||null,f=parseInt(String(c.bronze_goal))||0,p=parseInt(String(c.silver_goal))||0,x=parseInt(String(c.gold_goal))||0;let g=!1,v=f,_=null,w,b=c.bronze_requirement;h==="gold"?(g=!0,_="gold",v=x,b=c.gold_requirement,w=d==null?void 0:d.gold_achieved_at):h==="silver"?(g=!0,_="silver",v=p,b=c.silver_requirement,w=d==null?void 0:d.silver_achieved_at):h==="bronze"?(g=!0,_="bronze",v=f,b=c.bronze_requirement,w=d==null?void 0:d.bronze_achieved_at):(v=f,_=null,b=c.bronze_requirement);const N=this.getIconForAchievement(c.achievement_key,c.category);l.push({id:c.id,type:c.achievement_key,name:c.name,description:b,icon:N,tier:_||void 0,progress:u,goal:v,unlocked:g,unlocked_at:w,metadata:(d==null?void 0:d.progress_metadata)||{}})}),l.sort((c,d)=>{if(c.unlocked!==d.unlocked)return c.unlocked?-1:1;if(c.unlocked&&d.unlocked){const u={gold:0,silver:1,bronze:2},h=c.tier||"bronze",f=d.tier||"bronze",p=(u[h]||2)-(u[f]||2);if(p!==0)return p}return(d.progress||0)-(c.progress||0)})}catch(r){return console.error("Error fetching behavioral achievements:",r),[]}})}static getIconForAchievement(t,r){const n={genre_curator:"",genre_specialist:"",bucket_list_starter:"",intentional_explorer:"",return_engagement:"",new_blood:"",festival_attendance:"",artist_devotee:"",venue_regular:"",go_with_friends:"",venue_hopper:"",scene_explorer:"",city_crosser:"",era_walker:"",first_through_door:"",trusted_voice:"",deep_cut_reviewer:"",scene_regular:"",road_tripper:"",venue_loyalist:"",genre_blender:"",memory_maker:"",early_adopter:"",connector:"",passport_complete:""};return n[t]?n[t]:{exploration:"",specialization:"",milestones:"",discovery:"",loyalty:"",social:""}[r]||""}static checkAndUnlockAchievements(t){return E(this,null,function*(){try{const{error:r}=yield P.rpc("check_all_achievements",{p_user_id:t});if(r)throw r}catch(r){console.error("Error checking achievements:",r)}})}static mapAchievementToDisplay(t){const r=this.getAchievementInfo(t.achievement_type,t.tier);return{id:t.id,type:t.achievement_type,name:r.name,description:r.description,icon:r.icon,tier:t.tier,progress:t.progress||0,goal:t.goal||0,unlocked:!!t.unlocked_at,unlocked_at:t.unlocked_at,metadata:t.metadata}}static getAchievementInfo(t,r){const n=r?` (${r.charAt(0).toUpperCase()+r.slice(1)})`:"";return{venue_hopper:{name:"Venue Hopper"+n,description:r==="gold"?"Attend shows at 15 different venues":r==="silver"?"Attend shows at 7 different venues":"Attend shows at 3 different venues",icon:""},scene_explorer:{name:"Scene Explorer"+n,description:r==="gold"?"Engage with 7 distinct scenes":r==="silver"?"Engage with 4 distinct scenes":"Engage with 2 distinct scenes",icon:""},city_crosser:{name:"City Crosser"+n,description:r==="gold"?"Attend shows in 10 cities":r==="silver"?"Attend shows in 5 cities":"Attend shows in 2 cities",icon:""},era_walker:{name:"Era Walker"+n,description:r==="gold"?"Attend shows from 5 different eras":r==="silver"?"Attend shows from 3 different eras":"Attend shows from 2 different eras",icon:""},first_through_door:{name:"First Through the Door"+n,description:r==="gold"?"Attend 6 emerging-artist shows":r==="silver"?"Attend 3 emerging-artist shows":"Attend 1 emerging-artist show",icon:""},trusted_voice:{name:"Trusted Voice"+n,description:r==="gold"?"Reviews saved by others 25 times":r==="silver"?"Reviews saved by others 10 times":"Reviews saved by others 3 times",icon:""},deep_cut_reviewer:{name:"Deep Cut Reviewer"+n,description:r==="gold"?"Review 10 non-headliner performances":r==="silver"?"Review 5 non-headliner performances":"Review 2 non-headliner performances",icon:""},scene_regular:{name:"Scene Regular"+n,description:r==="gold"?"Attend 10 events in the same scene":r==="silver"?"Attend 6 events in the same scene":"Attend 3 events in the same scene",icon:""},road_tripper:{name:"Road Tripper"+n,description:r==="gold"?"Attend 6 out-of-town shows":r==="silver"?"Attend 3 out-of-town shows":"Attend 1 out-of-town show",icon:""},venue_loyalist:{name:"Venue Loyalist"+n,description:r==="gold"?"Attend 10 shows at the same venue":r==="silver"?"Attend 6 shows at the same venue":"Attend 3 shows at the same venue",icon:""},genre_blender:{name:"Genre Blender"+n,description:r==="gold"?"Attend shows across 6 genres":r==="silver"?"Attend shows across 4 genres":"Attend shows across 2 genres",icon:""},memory_maker:{name:"Memory Maker"+n,description:r==="gold"?"Pin 5 defining shows to your passport":r==="silver"?"Pin 3 defining shows to your passport":"Pin 1 defining show to your passport",icon:""},early_adopter:{name:"Early Adopter"+n,description:r==="gold"?"Attend 5 shows early after joining":r==="silver"?"Attend 3 shows early after joining":"Attend a show shortly after joining",icon:""},connector:{name:"Connector"+n,description:r==="gold"?"Attend 10 shows with friends":r==="silver"?"Attend 5 shows with friends":"Attend 2 shows with friends",icon:""},passport_complete:{name:"Passport Complete"+n,description:r==="gold"?"Unlock all 15 achievements":r==="silver"?"Unlock 10 achievements":"Unlock 5 achievements",icon:""}}[t]||{name:"Achievement"+n,description:"Awarded for your musical journey",icon:""}}}const Mpe=({isOpen:e,onClose:t,userId:r,userName:n,inline:i=!1})=>{const[a,o]=y.useState({cities:[],venues:[],artists:[],scenes:[],totalCount:0}),[l,c]=y.useState([]),[d,u]=y.useState([]),[h,f]=y.useState([]),[p,x]=y.useState(!0),[g,v]=y.useState("identity");y.useEffect(()=>{(e||i)&&_()},[e,i,r]);const _=()=>E(void 0,null,function*(){x(!0);try{const[b,N,S,k]=yield Promise.all([Co.getPassportProgress(r),Co.getStampsByRarity(r),Rpe.getBehavioralAchievements(r),Co.getNextToUnlock(r)]);o(b),c(N),u(S),f(k)}catch(b){console.error("Error loading passport data:",b)}finally{x(!1)}});if(!e)return null;const w=s.jsxs(s.Fragment,{children:[i&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold gradient-text",children:"Live Music Passport"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your curated, earned, and evolving snapshot of your live-music journey"})]}),p?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(er,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):s.jsxs(Cl,{value:g,onValueChange:b=>v(b),className:`${i?"":"mt-4"} w-full max-w-full overflow-x-hidden`,children:[s.jsxs(Fo,{className:"grid w-full max-w-full grid-cols-5 gap-0.5 p-0.5 overflow-x-hidden",children:[s.jsxs(Tn,{value:"identity",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(li,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Identity"})]}),s.jsxs(Tn,{value:"stamps",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(oa,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Stamps"})]}),s.jsxs(Tn,{value:"achievements",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(bl,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Achievements"})]}),s.jsxs(Tn,{value:"timeline",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(ai,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Timeline"})]}),s.jsxs(Tn,{value:"bucket",className:"flex flex-col items-center justify-center gap-0.5 px-1 py-1.5 text-[10px] sm:text-xs flex-shrink-0 min-w-0",children:[s.jsx(qJ,{className:"w-3 h-3 flex-shrink-0"}),s.jsx("span",{className:"truncate w-full text-center leading-tight",children:"Bucket List"})]})]}),s.jsx(On,{value:"identity",className:"mt-4",children:s.jsx(Epe,{userId:r,userName:n})}),s.jsx(On,{value:"stamps",className:"mt-4",children:s.jsx(Ape,{stamps:l,achievements:d,loading:p})}),s.jsx(On,{value:"achievements",className:"mt-4 w-full max-w-full overflow-x-hidden",children:d.length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx("p",{children:"No achievements unlocked yet."}),s.jsx("p",{className:"text-xs mt-1",children:"Keep attending events and writing reviews to unlock achievements!"})]}):s.jsx("div",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:d.map(b=>{const N=b.goal>0?Math.min(b.progress/b.goal*100,100):0;return s.jsxs("div",{className:`flex gap-[6px] items-center px-6 py-3 rounded-[10px] shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)] w-full max-w-full ${b.unlocked?"bg-[#fcfcfc] border border-[#5d646f]":"bg-[rgba(201,201,201,0.5)] border border-[#5d646f]"}`,children:[s.jsx("p",{className:"font-bold text-[35px] leading-[normal] flex-shrink-0",children:b.icon||""}),s.jsxs("div",{className:"flex flex-col gap-[6px] items-start justify-center flex-1 min-w-0",children:[s.jsx("p",{className:"font-bold leading-[normal] text-[20px] text-black break-words",children:b.name}),s.jsx("p",{className:"font-normal leading-[normal] text-[#5d646f] text-[16px] break-words whitespace-pre-wrap",children:b.description}),b.unlocked?s.jsxs("div",{className:"bg-[#fdf2f7] flex gap-3 h-[22px] items-center px-3 py-3 rounded-[10px] shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)] mt-1",children:[s.jsx("svg",{width:"15",height:"12",viewBox:"0 0 15 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-[17px] h-[17px]",children:s.jsx("path",{d:"M1 6L5 10L14 1",stroke:"#b00056",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),s.jsx("p",{className:"font-normal leading-[normal] text-[16px] text-[#b00056]",children:"Unlocked"})]}):s.jsxs("div",{className:"w-full mt-1",children:[s.jsx("div",{className:"bg-[rgba(201,201,201,0.5)] border border-[#5d646f] h-[10px] rounded-[10px] overflow-hidden relative w-full mb-1",children:s.jsx("div",{className:"absolute bg-[#cc2486] border border-[#5d646f] h-[10px] rounded-l-[10px]",style:{width:`${N}%`}})}),s.jsxs("p",{className:"font-normal leading-[normal] text-[#5d646f] text-[16px] text-right w-full",children:[b.progress,"/",b.goal]})]})]})]},b.id||b.type)})})}),s.jsx(On,{value:"timeline",className:"mt-4",children:s.jsx(Tpe,{userId:r})}),s.jsx(On,{value:"bucket",className:"mt-4 relative overflow-visible",children:s.jsx(Ope,{userId:r})})]})]});return i?s.jsx("div",{className:"w-full",children:w}):s.jsx(tn,{open:e,onOpenChange:t,children:s.jsxs(Xr,{className:"max-w-5xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Mn,{children:[s.jsx(an,{children:"Live Music Passport"}),s.jsx(Kn,{children:"Your curated, earned, and evolving snapshot of your live-music journey"})]}),w]})})},Dpe=({currentUserId:e,profileUserId:t,onBack:r,onEdit:n,onSettings:i,onSignOut:a,onNavigateToProfile:o,onNavigateToChat:l,onNavigateToNotifications:c})=>{var vn,Jn,Fs,Mt;const[d,u]=y.useState(null),[h,f]=y.useState([]),[p,x]=y.useState(!0),[g,v]=y.useState(!1),[_,w]=y.useState(!1),[b,N]=y.useState([]),[S,k]=y.useState(0),[O,A]=y.useState(null),[T,$]=y.useState([]),[R,F]=y.useState("my-events"),[D,B]=y.useState(!1),[U,V]=y.useState([]),[Y,z]=y.useState(!1),[K,Z]=y.useState([]),[G,X]=y.useState(!1),[te,se]=y.useState(!0),[ue,ye]=y.useState(null),[ne,xe]=y.useState(!1),[ge,ie]=y.useState(!1),[ee,H]=y.useState(null),[le,Se]=y.useState(!1),[ae,fe]=y.useState(!1),[he,pe]=y.useState(!1),[Ae,qe]=y.useState(!1),[Fe,ve]=y.useState("friends"),[rt,Ve]=y.useState(!1),[lt,ut]=y.useState("none"),[Ze,qt]=y.useState(null),[lr,Ge]=y.useState(0),[Le,yt]=y.useState({cities:0,venues:0,artists:0,scenes:0}),{toast:Ne}=jr(),{user:Oe,sessionExpired:ce}=os();ci();const Ee=t||e,Qe=!t||t===e;y.useEffect(()=>{if(console.log(" ProfileView: useEffect triggered with:",{targetUserId:Ee,sessionExpired:ce,user:Oe==null?void 0:Oe.id,hasUser:!!Oe}),ce){console.log(" ProfileView: Session expired, skipping data fetch"),x(!1);return}if(!Oe){console.log(" ProfileView: User not available yet, waiting...");return}const re=setTimeout(()=>{console.log(" ProfileView: User is available, fetching data..."),x(!0),console.log(" ProfileView: Loading state set to TRUE"),E(void 0,null,function*(){try{console.log(" ProfileView: fetchData function called - parallelizing queries"),yield Promise.all([vt(),wt(),Rt(),Te(),Ie(),dt(),be(),Ue(),Re(),Qe?Promise.resolve():We()]),console.log(" ProfileView: All data fetched successfully")}catch(Ke){console.error(" ProfileView: Error fetching data:",Ke)}finally{x(!1),console.log(" ProfileView: Loading state set to FALSE")}})},300);return()=>clearTimeout(re)},[Ee,ce,Oe]),y.useEffect(()=>{R==="interested"&&Ee&&(console.log(" ProfileView: User switched to interested tab, refreshing events..."),wt())},[R,Ee]),y.useEffect(()=>{if(window.location.hash.substring(1)==="spotify"){F("spotify");return}if(Qe){const _e=sessionStorage.getItem("profileTab");_e&&["timeline","interested","passport"].includes(_e)&&(F(_e==="timeline"?"passport":_e),sessionStorage.removeItem("profileTab"))}},[Qe]),y.useEffect(()=>{if(!Oe){se(!0);return}if(Oe.id===e){se(!0);return}E(void 0,null,function*(){try{const{data:re}=yield P.from("user_relationships").select("id").eq("relationship_type","friend").eq("status","accepted").or(`and(user_id.eq.${Oe.id},related_user_id.eq.${e}),and(user_id.eq.${e},related_user_id.eq.${Oe.id}))`).limit(1);se(Array.isArray(re)?re.length>0:!1)}catch(re){se(!0)}})},[Oe,e]);const vt=()=>E(void 0,null,function*(){var re,_e,Ke,ht,ct,Pe;try{if(console.log(" ProfileView: Starting profile fetch..."),console.log(" ProfileView: sessionExpired:",ce),console.log(" ProfileView: user:",Oe),console.log(" ProfileView: currentUserId:",e),ce||!Oe){console.log(" Session expired or no user, skipping profile fetch");return}console.log(" Fetching profile for user:",Ee),console.log("ProfileView: Fetching profile for user:",Ee);const et=fn=>E(void 0,null,function*(){return console.log(`ProfileView: Attempting profile lookup by ${fn}`),yield P.from("users").select("*").eq(fn,Ee).maybeSingle()});let nt=null;const{data:Me,error:gt}=yield et("user_id");if(console.log("ProfileView: Profile query result (user_id):",{data:Me,error:gt}),gt&&gt.code!=="PGRST116"){if(console.error("Profile query error:",gt),console.error("Error code:",gt.code),console.error("Error message:",gt.message),console.error("Error details:",gt.details),(re=gt.message)!=null&&re.includes("invalid")||(_e=gt.message)!=null&&_e.includes("API key")||(Ke=gt.message)!=null&&Ke.includes("JWT")||(ht=gt.message)!=null&&ht.includes("expired")){console.error("Session error in ProfileView:",gt),Ne({title:"Session Expired",description:"Your session has expired. Please sign in again.",variant:"destructive"});return}}else nt=Me;if(!nt){const{data:fn,error:Bn}=yield et("id");if(console.log("ProfileView: Profile query result (id):",{fallbackData:fn,fallbackError:Bn}),Bn&&Bn.code!=="PGRST116")throw Bn;nt=fn}if(nt){console.log("Profile found:",nt),u(nt);return}console.log("No profile found for user:",e),console.log("Creating default profile for user:",e);const{data:{user:cr}}=yield P.auth.getUser(),Wr=((ct=cr==null?void 0:cr.user_metadata)==null?void 0:ct.name)||((Pe=cr==null?void 0:cr.email)==null?void 0:Pe.split("@")[0])||"New User";console.log("Creating profile with name:",Wr);const{data:bn,error:xn}=yield P.from("users").insert({user_id:e,name:Wr,bio:"Music lover looking to connect at events!",instagram_handle:null,music_streaming_profile:null}).select().single();console.log("Profile creation result:",{newProfile:bn,insertError:xn}),xn?(console.error("Error creating profile:",xn),console.error("Insert error details:",xn.details),console.error("Insert error hint:",xn.hint),u({id:"temp",user_id:e,name:Wr,avatar_url:null,bio:"Music lover looking to connect at events!",instagram_handle:null,music_streaming_profile:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})):bn&&(console.log("Profile created successfully:",bn),u(bn))}catch(et){console.error("Error fetching profile:",et),u({id:"temp",user_id:e,name:"New User",avatar_url:null,bio:null,instagram_handle:null,music_streaming_profile:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}}),wt=()=>E(void 0,null,function*(){try{if(console.log(" ProfileView: fetchUserEvents called for user:",Ee),ce||!Oe){console.log("Session expired or no user, skipping user events fetch");return}console.log(" ProfileView: Fetching user events from database...");const{data:re}=yield P.from("user_event_relationships").select("event_id").eq("user_id",Ee).eq("relationship_type","interested"),_e=(re==null?void 0:re.map(nt=>nt.event_id))||[];let Ke=[];if(_e.length>0){const{data:nt}=yield P.from("events").select("*").in("id",_e).order("event_date",{ascending:!0});Ke=nt||[]}console.log(" ProfileView: Database query returned:",Ke==null?void 0:Ke.length,"events");const{data:ht}=yield P.from("reviews").select("event_id").eq("user_id",Ee).eq("was_there",!0),ct=new Set((ht==null?void 0:ht.map(nt=>nt.event_id))||[]),et=((Ke==null?void 0:Ke.map(nt=>{var Wr,bn,xn,fn,Bn,ms,ls,Bt,Pt,It,kt,rr,mr,Hr,dn,bi,tr,Gr,Ui,di,Dr,Ur,jn,zn,Yr;const Me=nt,gt=nt;console.log("ProfileView: Processing event in getUserEvents:",{title:Me==null?void 0:Me.title,artist_name:Me==null?void 0:Me.artist_name,venue_name:Me==null?void 0:Me.venue_name,poster_image_url:gt==null?void 0:gt.poster_image_url,images:gt==null?void 0:gt.images}),(Wr=Me==null?void 0:Me.title)!=null&&Wr.includes("Anotha")&&console.log("ProfileView: Found Anotha event in getUserEvents:",{item:nt,jambaseEvent:Me,title:Me==null?void 0:Me.title,artist_name:Me==null?void 0:Me.artist_name,venue_name:Me==null?void 0:Me.venue_name,venue_city:Me==null?void 0:Me.venue_city,venue_state:Me==null?void 0:Me.venue_state});const cr={id:(bn=Me==null?void 0:Me.id)!=null?bn:"",jambase_event_id:(fn=(xn=Me==null?void 0:Me.jambase_event_id)!=null?xn:Me==null?void 0:Me.id)!=null?fn:"",title:(Bn=Me==null?void 0:Me.title)!=null?Bn:"",artist_name:(ms=Me==null?void 0:Me.artist_name)!=null?ms:"",artist_id:(ls=Me==null?void 0:Me.artist_id)!=null?ls:null,venue_name:(Bt=Me==null?void 0:Me.venue_name)!=null?Bt:"",venue_id:(Pt=Me==null?void 0:Me.venue_id)!=null?Pt:null,venue_address:(It=Me==null?void 0:Me.venue_address)!=null?It:null,venue_city:(kt=Me==null?void 0:Me.venue_city)!=null?kt:null,venue_state:(rr=Me==null?void 0:Me.venue_state)!=null?rr:null,venue_zip:(mr=Me==null?void 0:Me.venue_zip)!=null?mr:null,event_date:(Hr=Me==null?void 0:Me.event_date)!=null?Hr:"",doors_time:(dn=Me==null?void 0:Me.doors_time)!=null?dn:null,description:(bi=Me==null?void 0:Me.description)!=null?bi:null,genres:Array.isArray(Me==null?void 0:Me.genres)?Me.genres:[],latitude:(tr=Me==null?void 0:Me.latitude)!=null?tr:null,longitude:(Gr=Me==null?void 0:Me.longitude)!=null?Gr:null,ticket_available:!!(Me!=null&&Me.ticket_available),price_range:(Ui=Me==null?void 0:Me.price_range)!=null?Ui:null,ticket_urls:(Me==null?void 0:Me.ticket_urls)||[],poster_image_url:(di=gt==null?void 0:gt.poster_image_url)!=null?di:null,event_media_url:(Dr=gt==null?void 0:gt.event_media_url)!=null?Dr:null,images:(Ur=gt==null?void 0:gt.images)!=null?Ur:null,media_urls:(jn=gt==null?void 0:gt.media_urls)!=null?jn:null,setlist:null,setlist_enriched:null,setlist_song_count:null,setlist_fm_id:null,setlist_fm_url:null,setlist_source:null,setlist_last_updated:null,tour_name:(zn=Me==null?void 0:Me.tour_name)!=null?zn:null,created_at:nt.created_at,updated_at:nt.created_at};return(Yr=Me==null?void 0:Me.title)!=null&&Yr.includes("Anotha")&&console.log("ProfileView: Processed Anotha event:",{processedEvent:cr,title:cr.title,artist_name:cr.artist_name,venue_name:cr.venue_name,venue_city:cr.venue_city,venue_state:cr.venue_state}),cr}))||[]).filter(nt=>!ct.has(nt.id));console.log("ProfileView: Final filtered events:",et.map(nt=>({title:nt.title,artist_name:nt.artist_name,venue_name:nt.venue_name}))),f(et),console.log(" ProfileView: fetchUserEvents completed successfully")}catch(re){console.error(" ProfileView: Error fetching user events:",re),f([])}finally{x(!1)}}),Ht=g?jce(h):bce(h),Rt=()=>E(void 0,null,function*(){var re;try{if(ce||!Oe){console.log("Session expired or no user, skipping reviews fetch");return}console.log(" ProfileView: Fetching reviews for user:",Ee),console.log(" ProfileView: isViewingOwnProfile:",Qe),console.log(" ProfileView: Session user:",Oe==null?void 0:Oe.id);let _e;try{_e=yield fs.getUserReviewHistory(Ee),console.log(" ProfileView: Raw review data:",_e),console.log(" ProfileView: Number of reviews in result:",_e.reviews.length),_e.reviews.length>0&&console.log(" ProfileView: First review event data:",{reviewId:_e.reviews[0].review.id,eventId:_e.reviews[0].review.event_id,event:_e.reviews[0].event,eventTitle:(re=_e.reviews[0].event)==null?void 0:re.title})}catch(Pe){console.error(" ProfileView: Error calling ReviewService.getUserReviewHistory:",Pe),N([]);return}const Ke=_e.reviews.filter(Pe=>!(!Qe&&!Pe.review.is_public||Pe.review.review_text==="ATTENDANCE_ONLY"&&!Pe.review.was_there)).map(Pe=>{var Me,gt,cr,Wr,bn,xn,fn,Bn,ms,ls,Bt,Pt;let et;const nt=Pe.review.Event_date||Pe.review.event_date;if(nt){if(nt instanceof Date)et=nt;else if(typeof nt=="string"){const[It,kt,rr]=nt.split("-").map(Number);if(It&&kt&&rr){const mr=new Date(It,kt-1,rr);isNaN(mr.getTime())||(et=mr)}}}return{id:Pe.review.id,user_id:Pe.review.user_id,event_id:Pe.review.event_id,artist_id:Pe.review.artist_id,venue_id:Pe.review.venue_id,rating:Pe.review.rating,rank_order:Pe.review.rank_order,artist_performance_rating:Pe.review.artist_performance_rating,production_rating:Pe.review.production_rating,venue_rating:Pe.review.venue_rating,location_rating:Pe.review.location_rating,value_rating:Pe.review.value_rating,review_text:Pe.review.review_text,reaction_emoji:Pe.review.reaction_emoji,artist_performance_feedback:Pe.review.artist_performance_feedback,production_feedback:Pe.review.production_feedback,venue_feedback:Pe.review.venue_feedback,location_feedback:Pe.review.location_feedback,value_feedback:Pe.review.value_feedback,photos:Pe.review.photos||[],videos:Pe.review.videos||[],setlist:Pe.review.setlist,is_public:Pe.review.is_public,is_draft:Pe.review.is_draft||!1,was_there:Pe.review.was_there,created_at:Pe.review.created_at,ticket_price_paid:Pe.review.ticket_price_paid,category_average:bt(Pe.review),Event_date:et,event_date:et,artist_name:(Me=Pe.event)==null?void 0:Me.artist_name,venue_name:(gt=Pe.event)==null?void 0:gt.venue_name,jambase_events:Pe.event||null,event:{event_name:((cr=Pe.event)==null?void 0:cr.title)||((Wr=Pe.event)!=null&&Wr.artist_name&&((bn=Pe.event)!=null&&bn.venue_name)?`${Pe.event.artist_name} at ${Pe.event.venue_name}`:((xn=Pe.event)==null?void 0:xn.event_name)||"Concert Review"),location:((fn=Pe.event)==null?void 0:fn.venue_name)||"Unknown Venue",artist_name:(Bn=Pe.event)==null?void 0:Bn.artist_name,venue_name:(ms=Pe.event)==null?void 0:ms.venue_name,event_date:et?et.toISOString().split("T")[0]:((ls=Pe.event)==null?void 0:ls.event_date)||Pe.review.created_at,event_time:((Bt=Pe.event)==null?void 0:Bt.event_time)||((Pt=Pe.event)==null?void 0:Pt.doors_time)||"TBD",_fullEvent:Pe.event||null}}});console.log(" ProfileView: Transformed reviews:",Ke),console.log(" ProfileView: Number of transformed reviews:",Ke.length);const ht=Ke.filter(Pe=>Pe.setlist);console.log(" ProfileView: Reviews with setlist:",ht.length,ht);const ct=Ke.filter(Pe=>!(Pe.review_text==="ATTENDANCE_ONLY"&&!Pe.was_there));console.log(" ProfileView: Reviews for PostsGrid:",ct.length),console.log(" ProfileView: Reviews for PostsGrid (first 3):",ct.slice(0,3).map(Pe=>{var et;return{id:Pe.id,event_name:(et=Pe.event)==null?void 0:et.event_name,review_text:Pe.review_text,was_there:Pe.was_there}})),N(Ke)}catch(_e){console.error(" ProfileView: Error fetching reviews:",_e),N([])}}),Te=()=>E(void 0,null,function*(){try{console.log(" ProfileView: Fetching reviews count for user:",Ee);let re=P.from("reviews").select("id, was_there, review_text, is_public",{count:"exact"}).eq("user_id",Ee).eq("is_draft",!1);Qe||(re=re.eq("is_public",!0));const{data:_e,count:Ke,error:ht}=yield re;if(ht){console.error(" ProfileView: Error fetching reviews count:",ht),k(0);return}const Pe=(_e||[]).filter(et=>!!(et.was_there===!0||et.review_text&&et.review_text!=="ATTENDANCE_ONLY")).length;console.log(" ProfileView: Reviews count (raw):",Ke),console.log(" ProfileView: Reviews count (filtered):",Pe),k(Pe)}catch(re){console.error(" ProfileView: Error fetching reviews count:",re),k(0)}}),bt=re=>{if(typeof re.rating=="number")return re.rating;if(typeof re.rating=="string"){const _e=parseFloat(re.rating);return isNaN(_e)?null:_e}return re.rating===null||re.rating===void 0?null:re.rating==="good"?5:re.rating==="okay"?3:re.rating==="bad"?1:null},$e=re=>{const _e=bt(re);return parseFloat(_e.toFixed(1))},Ie=()=>E(void 0,null,function*(){try{if(ce||!Oe){console.log("Session expired or no user, skipping friends fetch");return}const re=yield fu.getFriends(Ee);$(re)}catch(re){console.warn("Warning: Error fetching friends:",re),$([])}}),Ue=()=>E(void 0,null,function*(){try{if(ce||!Oe){console.log("Session expired or no user, skipping followed artists count fetch");return}console.log(" ProfileView: Fetching artist follows count for user:",Ee),console.log(" ProfileView: Current authenticated user:",Oe==null?void 0:Oe.id);const re=yield ype.getArtistFollowsCount(Ee);console.log(" ProfileView: Artist follows count:",re);const _e=yield $a.getUserFollowedArtists(Ee);console.log(" ProfileView: Followed artists array length:",_e.length),console.log(" ProfileView: Artist names:",_e.map(ht=>ht.artist_name));const Ke=re!==_e.length?_e.length:re;re!==_e.length&&console.warn(` ProfileView: Count mismatch! Service count: ${re}, Array length: ${_e.length}. Using array length.`),Ge(Ke),console.log(" ProfileView: Final artist follows count set to:",Ke)}catch(re){console.error("Error fetching followed artists count:",re),Ge(0)}}),dt=()=>E(void 0,null,function*(){try{if(ce||!Oe){console.log("Session expired or no user, skipping attended events fetch");return}console.log(" ProfileView: Fetching attended events for user:",Ee),z(!0);const{data:re,error:_e}=yield P.from("reviews").select(`
          id, 
          event_id, 
          rating, 
          review_text, 
          was_there, 
          is_public, 
          created_at, 
          updated_at
        `).eq("user_id",Ee).eq("is_draft",!1).order("created_at",{ascending:!1});if(_e){console.error("Error fetching attended events:",_e),V([]);return}if(!re||re.length===0){V([]);return}const Ke=re.map(gt=>gt.event_id).filter(Boolean),ht=new Map;if(Ke.length>0){const{data:gt}=yield P.from("events_with_artist_venue").select("id, title, artist_name_normalized, venue_name_normalized, event_date, venue_city, venue_state, setlist").in("id",Ke);gt&&gt.forEach(cr=>{ht.set(cr.id,cr)})}const ct=re.map(gt=>W(M({},gt),{events:ht.get(gt.event_id)}));console.log(" ProfileView: Attended events data (raw):",ct),console.log(" ProfileView: Total attended events fetched (raw):",ct==null?void 0:ct.length);const Pe=(ct||[]).filter(gt=>!!(gt.was_there===!0||gt.review_text&&gt.review_text!=="ATTENDANCE_ONLY"));console.log(" ProfileView: Attended events data (filtered):",Pe),console.log(" ProfileView: Total attended events fetched (filtered):",Pe==null?void 0:Pe.length);const et=(Pe==null?void 0:Pe.filter(gt=>gt.review_text&&gt.review_text!=="ATTENDANCE_ONLY").length)||0,nt=(Pe==null?void 0:Pe.filter(gt=>gt.review_text==="ATTENDANCE_ONLY").length)||0,Me=(Pe==null?void 0:Pe.filter(gt=>!gt.review_text).length)||0;if(console.log(" Event breakdown:"),console.log(`   With reviews: ${et}`),console.log(`   Attendance only: ${nt}`),console.log(`   No review: ${Me}`),console.log(`   Total: ${Pe==null?void 0:Pe.length}`),Pe&&Pe.length>0){const gt=Pe.map(cr=>W(M({},cr),{jambase_events:cr.events||null}));V(gt)}else V([])}catch(re){console.error("Error fetching attended events:",re),V([])}finally{z(!1)}}),be=()=>E(void 0,null,function*(){var re,_e,Ke,ht,ct,Pe,et;try{if(ce||!Oe){console.log("Session expired or no user, skipping draft reviews fetch");return}if(console.log(" ProfileView: Fetching draft reviews for user:",Ee),X(!0),!Qe){Z([]);return}const{data:nt,error:Me}=yield P.from("reviews").select("id, event_id, is_draft, draft_data, last_saved_at").eq("user_id",Ee).eq("is_draft",!0);Me&&console.error(" ProfileView: Error fetching drafts directly:",Me),console.log(" ProfileView: All drafts from database (direct query):",(nt==null?void 0:nt.length)||0);const gt=yield Ah.getUserDrafts(Ee);console.log(" ProfileView: Drafts from RPC function:",(gt==null?void 0:gt.length)||0);const{data:cr}=yield P.from("reviews").select(`
          event_id,
          event:events!inner(
            id,
            artist_id,
            venue_id,
            event_date
          )
        `).eq("user_id",Ee).eq("is_draft",!1).not("review_text","is",null).neq("review_text","ATTENDANCE_ONLY"),Wr=new Set((cr||[]).map(Pt=>Pt.event_id).filter(Boolean)),bn=Array.from(Wr);let xn=new Map;if(bn.length>0){const{data:Pt}=yield P.from("events_with_artist_venue").select("id, artist_name_normalized, venue_name_normalized").in("id",bn);Pt&&Pt.forEach(It=>{xn.set(It.id,{artist_name:It.artist_name_normalized||"",venue_name:It.venue_name_normalized||""})})}const fn=new Map;(cr||[]).forEach(Pt=>{if(Pt.event){const It=xn.get(Pt.event.id),kt=(It==null?void 0:It.artist_name)||"",rr=(It==null?void 0:It.venue_name)||"",mr=`${kt.toLowerCase().trim()}|${rr.toLowerCase().trim()}|${Pt.event.event_date}`;fn.set(mr,Pt)}}),console.log(" ProfileView: Published review event IDs:",Array.from(Wr)),console.log(" ProfileView: Published reviews by concert:",fn.size);const Bn=Pt=>{if(!Pt)return null;try{return new Date(Pt).toISOString().split("T")[0]}catch(It){return Pt}},ms=[],ls=[];for(const Pt of gt||[]){if(!Pt.event_id){console.log(" ProfileView: Draft has no event_id:",Pt.id);continue}let It=!1,kt="";if(Wr.has(Pt.event_id))It=!0,kt=`published review exists for event ${Pt.event_id}`;else{const mr=Pt.artist_name||((_e=(re=Pt.draft_data)==null?void 0:re.selectedArtist)==null?void 0:_e.name),Hr=Pt.venue_name||((ht=(Ke=Pt.draft_data)==null?void 0:Ke.selectedVenue)==null?void 0:ht.name),dn=Pt.event_date||((ct=Pt.draft_data)==null?void 0:ct.eventDate);if(mr&&Hr&&dn){const bi=Bn(dn),tr=mr.toLowerCase().trim(),Gr=Hr.toLowerCase().trim();for(const[Ui]of fn.entries()){const[di,Dr,Ur]=Ui.split("|"),jn=Bn(Ur);if(di===tr&&Dr===Gr&&jn===bi){It=!0,kt=`published review exists for same concert (${mr} at ${Hr})`;break}}}}It?(ms.push(Pt.id),console.log(` ProfileView: Marked draft ${Pt.id} for deletion - ${kt}`)):ls.push(Pt)}if(ms.length>0){console.log(` ProfileView: Deleting ${ms.length} orphaned draft(s)...`);const Pt=ms.map(mr=>E(void 0,null,function*(){try{const{error:Hr}=yield P.from("reviews").delete().eq("id",mr);return Hr?(console.error(` ProfileView: Failed to delete orphaned draft ${mr}:`,Hr),{success:!1,draftId:mr,error:Hr}):(console.log(` ProfileView: Successfully deleted orphaned draft ${mr}`),{success:!0,draftId:mr})}catch(Hr){return console.error(` ProfileView: Exception deleting orphaned draft ${mr}:`,Hr),{success:!1,draftId:mr,error:Hr}}})),It=yield Promise.all(Pt),kt=It.filter(mr=>mr.success).length,rr=It.filter(mr=>!mr.success);if(rr.length>0){console.error(` ProfileView: Failed to delete ${rr.length} draft(s):`,rr);const mr=new Set(rr.map(dn=>dn.draftId)),Hr=(gt||[]).filter(dn=>mr.has(dn.id));ls.push(...Hr)}console.log(` ProfileView: Deletion complete - ${kt} successful, ${rr.length} failed`)}const Bt=ls;if(nt)for(const Pt of nt){let It=!1;if(Pt.event_id&&Wr.has(Pt.event_id)&&(console.log(` ProfileView: Found orphaned draft ${Pt.id} in database (same event_id) - deleting`),It=!0),!It&&Pt.draft_data){const kt=Pt.draft_data,rr=(Pe=kt==null?void 0:kt.selectedArtist)==null?void 0:Pe.name,mr=(et=kt==null?void 0:kt.selectedVenue)==null?void 0:et.name,Hr=kt==null?void 0:kt.eventDate;if(rr&&mr&&Hr){const dn=tr=>{if(!tr)return null;try{return new Date(tr).toISOString().split("T")[0]}catch(Gr){return tr}},bi=dn(Hr);for(const[tr]of fn.entries()){const[Gr,Ui,di]=tr.split("|"),Dr=dn(di);if(Gr===rr&&Ui===mr&&Dr===bi){console.log(` ProfileView: Found orphaned draft ${Pt.id} in database (same concert) - deleting`),It=!0;break}}}}It&&(yield P.from("reviews").delete().eq("id",Pt.id))}console.log(" ProfileView: Draft reviews data (final):",Bt),console.log(" ProfileView: Total valid draft reviews (after filtering):",Bt==null?void 0:Bt.length),Z(Bt)}catch(nt){console.error("Error fetching draft reviews:",nt),Z([])}finally{X(!1)}}),Re=()=>E(void 0,null,function*(){try{if(ce||!Oe||!Qe)return;const re=yield Co.getPassportProgress(Ee);yt({cities:re.cities.length,venues:re.venues.length,artists:re.artists.length,scenes:re.scenes.length})}catch(re){console.error("Error loading passport summary:",re)}}),We=()=>E(void 0,null,function*(){try{if(ce||!Oe||Qe)return;const{data:re,error:_e}=yield P.from("user_relationships").select("id, status").eq("relationship_type","friend").or(`and(user_id.eq.${e},related_user_id.eq.${Ee}),and(user_id.eq.${Ee},related_user_id.eq.${e})`).in("status",["accepted"]).limit(1);if(_e){console.warn("Warning: Could not check friendship status:",_e);return}if(re&&re.length>0){ut("friends");return}const{data:Ke,error:ht}=yield P.from("user_relationships").select("id").eq("user_id",e).eq("related_user_id",Ee).eq("relationship_type","friend").eq("status","pending").limit(1);if(ht){console.warn("Warning: Could not check sent friend requests:",ht);return}if(Ke&&Ke.length>0){ut("pending_sent"),qt(Ke[0].id);return}const{data:ct,error:Pe}=yield P.from("user_relationships").select("id").eq("user_id",Ee).eq("related_user_id",e).eq("relationship_type","friend").eq("status","pending").limit(1);if(Pe){console.warn("Warning: Could not check received friend requests:",Pe);return}if(ct&&ct.length>0){ut("pending_received");return}ut("none")}catch(re){console.warn("Warning: Error checking friend status:",re),ut("none")}}),St=()=>E(void 0,null,function*(){try{if(ce||!Oe||Qe)return;console.log("Sending friend request to:",Ee);const{data:re,error:_e}=yield P.rpc("create_friend_request",{receiver_user_id:Ee});if(_e)throw console.error("Error creating friend request:",_e),_e;let Ke=null;re?Ke=re:Ke=yield fu.getPendingRequestId(e,Ee),qt(Ke),ut("pending_sent"),Ne({title:"Friend Request Sent! ",description:"Your friend request has been sent and they'll be notified."})}catch(re){console.error("Error sending friend request:",re),Ne({title:"Error",description:re.message||"Failed to send friend request. Please try again.",variant:"destructive"})}}),Ye=re=>E(void 0,null,function*(){var _e;try{if(ce||!Oe)return;console.log("Unfriending user:",re),yield fu.unfriendUser(re),$(Ke=>Ke.filter(ht=>ht.user_id!==re)),Ee===re&&ut("none"),yield Ie(),Ne({title:"Friend Removed",description:"You are no longer friends with this person."})}catch(Ke){if(console.error("Error unfriending user:",Ke),(_e=Ke==null?void 0:Ke.message)!=null&&_e.includes("Friendship does not exist")){$(ht=>ht.filter(ct=>ct.user_id!==re)),Ee===re&&ut("none"),yield Ie();return}throw Ne({title:"Error",description:Ke.message||"Failed to unfriend user. Please try again.",variant:"destructive"}),Ke}}),ir=re=>E(void 0,null,function*(){if(w(!1),A(null),re!=null&&re.event_id)try{console.log(" ProfileView: NUCLEAR deletion of drafts for event:",re.event_id);const{error:_e}=yield P.from("reviews").delete().eq("user_id",e).eq("event_id",re.event_id).eq("is_draft",!0);_e?console.error(" ProfileView: Failed to delete drafts:",_e):console.log(" ProfileView: Deleted all drafts for event:",re.event_id)}catch(_e){console.error(" ProfileView: Exception deleting drafts:",_e)}yield new Promise(_e=>setTimeout(_e,1e3)),yield Promise.all([Rt(),dt(),be()]),Ne({title:"Review Added",description:"Your concert review has been added!"})}),jt=re=>{var _e,Ke,ht,ct,Pe,et,nt,Me;A({id:re.event_id,title:((_e=re.event)==null?void 0:_e.event_name)||"Concert Review",venue_name:((Ke=re.event)==null?void 0:Ke.venue_name)||((ht=re.event)==null?void 0:ht.location)||"Unknown Venue",event_date:re.Event_date||re.event_date||((ct=re.event)==null?void 0:ct.event_date)||re.created_at,artist_name:((Pe=re.event)==null?void 0:Pe.artist_name)||"Unknown Artist",existing_review_id:re.id,existing_review:{rating:re.rating,review_text:re.review_text,artist_performance_rating:re.artist_performance_rating,production_rating:re.production_rating,venue_rating:re.venue_rating,location_rating:re.location_rating,value_rating:re.value_rating,artist_performance_feedback:re.artist_performance_feedback,production_feedback:re.production_feedback,venue_feedback:re.venue_feedback,location_feedback:re.location_feedback,value_feedback:re.value_feedback,ticket_price_paid:re.ticket_price_paid,reaction_emoji:re.reaction_emoji,is_public:re.is_public,review_type:re.review_type,event_date:re.Event_date||re.event_date||((et=re.event)==null?void 0:et.event_date)||re.created_at,artist_name:(nt=re.event)==null?void 0:nt.artist_name,venue_name:(Me=re.event)==null?void 0:Me.venue_name,venue_id:re.venue_id}}),w(!0)},pt=re=>E(void 0,null,function*(){try{console.log(" ProfileView: Deleting review:",{userId:e,reviewId:re}),yield fs.deleteEventReview(e,re),console.log(" ProfileView: Review deleted successfully"),Rt(),Ne({title:"Review Deleted",description:"Your review has been deleted."})}catch(_e){console.error(" ProfileView: Error deleting review:",_e),Ne({title:"Error",description:`Failed to delete review: ${_e instanceof Error?_e.message:"Unknown error"}`,variant:"destructive"})}});return p||!d?s.jsx(GE,{text:"Loading profile..."}):d?(console.log(" ProfileView: Rendering profile for:",d.name),s.jsxs("div",{className:"min-h-screen bg-[#fcfcfc] pb-48 w-full max-w-[393px] mx-auto overflow-x-hidden",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},children:[s.jsx("div",{className:"bg-[#fcfcfc] border-b border-gray-200 w-full",children:s.jsx("div",{className:"w-full max-w-full px-4 py-3 flex items-center justify-center relative",children:s.jsx("h1",{className:"text-xl font-bold text-gray-900 truncate text-center",children:d.username?`@${d.username}`:d.name})})}),s.jsxs("div",{className:"w-full max-w-full p-4 overflow-x-hidden",children:[s.jsxs("div",{className:"mb-6 bg-gradient-to-br from-white via-pink-50/30 to-purple-50/20 rounded-2xl p-4 sm:p-6 border border-pink-100/50 shadow-sm relative overflow-hidden w-full max-w-full",children:[s.jsxs("div",{className:"flex flex-col items-center gap-4 mb-4 w-full max-w-full",children:[s.jsxs("div",{className:"flex items-center gap-3 w-full justify-center",children:[s.jsxs("div",{className:"relative",children:[s.jsxs(Vr,{className:"w-20 h-20 sm:w-24 sm:h-24 ring-4 ring-white shadow-lg",children:[s.jsx(Qr,{src:d.avatar_url||void 0,alt:`${d.name}'s avatar`,onError:re=>{console.log(" Avatar image failed to load:",d.avatar_url),re.target.style.display="none"},onLoad:()=>{console.log(" Avatar image loaded successfully:",d.avatar_url)}}),s.jsx(qr,{className:"text-3xl font-bold bg-gradient-to-br from-pink-500 to-purple-600 text-white",children:d.name.charAt(0).toUpperCase()})]}),!Qe&&d.last_active_at&&s.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-2 border-white flex items-center justify-center",children:s.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:d.name}),d.verified&&d.account_type&&s.jsx(LE,{accountType:d.account_type,verified:d.verified,size:"lg"})]})]}),!Qe&&d.last_active_at&&s.jsx("div",{className:"w-full flex justify-center",children:s.jsxs(Be,{variant:"secondary",className:"flex items-center gap-1 text-xs bg-green-100 text-green-700 border-green-200",children:[s.jsx(ai,{className:"w-3 h-3"}),Th.formatLastActive(d.last_active_at)]})}),s.jsxs("div",{className:"w-full max-w-full",children:[s.jsxs("div",{className:"flex items-center justify-center gap-6 mb-4 w-full max-w-full",children:[s.jsxs("button",{className:"text-center hover:scale-105 transition-transform group",onClick:()=>{ve("friends"),qe(!0)},children:[s.jsx("div",{className:"text-2xl font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent group-hover:from-pink-700 group-hover:to-purple-700",children:T.length}),s.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Friends"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent",children:S}),s.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Reviews"})]}),s.jsxs("button",{className:"text-center hover:scale-105 transition-transform group",onClick:()=>Ve(!0),children:[s.jsx("div",{className:"text-2xl font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent group-hover:from-pink-700 group-hover:to-purple-700",children:lr}),s.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Following"})]})]}),s.jsx("div",{className:"flex flex-wrap items-center gap-2 w-full max-w-full",children:Qe?s.jsxs(s.Fragment,{children:[s.jsxs(oe,{onClick:n,variant:"default",size:"sm",className:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white shadow-md",children:[s.jsx(Cu,{className:"w-4 h-4 mr-2"}),"Edit Profile"]}),s.jsx(oe,{onClick:i,variant:"outline",size:"sm",className:"border-gray-200 hover:border-gray-300",children:s.jsx(rQ,{className:"w-4 h-4"})})]}):s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[lt==="none"&&s.jsxs(oe,{onClick:St,variant:"default",size:"sm",className:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white shadow-md",children:[s.jsx(eo,{className:"w-4 h-4 mr-2"}),"Add Friend"]}),lt==="pending_sent"&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(oe,{disabled:!0,variant:"outline",size:"sm",className:"border-orange-200 text-orange-600",children:"Friend Request Sent"}),s.jsx(oe,{onClick:()=>E(void 0,null,function*(){if(!Ze){Ne({title:"Cannot Cancel",description:"Request ID not available. Please refresh the page.",variant:"destructive"});return}try{yield fu.cancelFriendRequest(Ze),ut("none"),qt(null),Ne({title:"Request Cancelled",description:"Friend request has been cancelled."})}catch(re){Ne({title:"Error",description:re.message||"Failed to cancel request.",variant:"destructive"})}}),disabled:!Ze,variant:"outline",size:"sm",className:"border-gray-200 text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:Ze?"Cancel friend request":"Request ID not available",children:"Cancel"})]}),lt==="pending_received"&&s.jsx(oe,{disabled:!0,variant:"outline",size:"sm",className:"border-blue-200 text-blue-600",children:"Respond to Request"}),lt==="friends"&&s.jsx(oe,{onClick:()=>Ye(Ee),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:border-red-300 border-red-200",children:"Unfriend"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>fe(!0),className:"text-gray-500 hover:text-red-600 hover:bg-red-50 p-2",children:s.jsx(x3,{className:"w-4 h-4"})}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>Se(!0),className:"text-gray-500 hover:text-red-600 hover:bg-red-50 p-2",children:s.jsx(Va,{className:"w-4 h-4"})})]})]})})]})]}),s.jsxs("div",{className:"border-t border-pink-100/50 pt-6",children:[d.bio&&s.jsx("div",{className:"mb-4",children:s.jsx("p",{className:"text-gray-700 leading-relaxed",children:d.bio})}),s.jsxs("div",{className:"flex flex-wrap gap-3",children:[d.instagram_handle&&s.jsxs("a",{href:`https://instagram.com/${d.instagram_handle}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-pink-500/10 to-purple-500/10 hover:from-pink-500/20 hover:to-purple-500/20 rounded-lg border border-pink-200/50 text-pink-600 hover:text-pink-700 transition-all duration-200 text-sm font-medium",children:[s.jsx(JD,{className:"w-4 h-4"}),s.jsxs("span",{children:["@",d.instagram_handle]}),s.jsx(aa,{className:"w-3 h-3 opacity-60"})]}),!Qe&&d.music_streaming_profile&&(()=>{const re=Ez(d.music_streaming_profile),_e=re==="spotify",Ke=re==="apple-music";let ht=d.music_streaming_profile,ct=d.music_streaming_profile,Pe="bg-blue-500/10 hover:bg-blue-500/20 border-blue-200/50",et="text-blue-600 hover:text-blue-700";return _e?(ht=d.music_streaming_profile.startsWith("http")?d.music_streaming_profile:`https://open.spotify.com/user/${d.music_streaming_profile}`,ct="Spotify Profile",Pe="bg-green-500/10 hover:bg-green-500/20 border-green-200/50",et="text-green-600 hover:text-green-700"):Ke&&(ht=(d.music_streaming_profile.startsWith("http"),d.music_streaming_profile),ct="Apple Music Profile",Pe="bg-red-500/10 hover:bg-red-500/20 border-red-200/50",et="text-red-600 hover:text-red-700"),s.jsxs("a",{href:ht,target:"_blank",rel:"noopener noreferrer",className:`flex items-center gap-2 px-3 py-2 ${Pe} rounded-lg border ${et} transition-all duration-200 text-sm font-medium`,children:[s.jsx(Ct,{className:"w-4 h-4"}),s.jsx("span",{children:ct}),s.jsx(aa,{className:"w-3 h-3 opacity-60"})]})})()]})]})]}),Qe&&!G&&Array.isArray(K)&&K.length>0&&s.jsx("div",{className:"mb-6",children:s.jsx(wpe,{draftCount:K.length,onClick:()=>B("unreviewed")})}),s.jsxs(Cl,{value:R,onValueChange:F,className:"w-full",children:[s.jsxs(Fo,{className:`glass-card inner-glow grid w-full max-w-full mb-4 p-1 floating-shadow overflow-x-hidden ${te?"grid-cols-3":"grid-cols-2"}`,children:[s.jsxs(Tn,{value:"my-events",className:"flex items-center gap-2",children:[s.jsx(Et,{className:"w-4 h-4"}),"Events"]}),te&&s.jsxs(Tn,{value:"interested",className:"flex items-center gap-2",children:[s.jsx(hs,{className:"w-4 h-4"}),"Interested"]}),s.jsxs(Tn,{value:"passport",className:"flex items-center gap-2",children:[s.jsx(oa,{className:"w-4 h-4"}),"Passport"]})]}),s.jsxs(On,{value:"my-events",className:"mt-4 mb-32 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"flex flex-col gap-3 mb-4 p-2 w-full max-w-full",children:[s.jsx("h3",{className:"gradient-text text-lg font-semibold",children:Qe?"My Events":`${(d==null?void 0:d.name)||"User"}'s Events`}),Qe&&s.jsxs("div",{className:"flex flex-col gap-2 w-full max-w-full",children:[s.jsx("span",{className:"text-xs text-gray-600",children:"View mode:"}),s.jsxs("div",{className:"bg-gray-100 rounded-lg p-1 flex w-full max-w-full overflow-x-auto",children:[s.jsx("button",{onClick:()=>B(!1),className:`px-3 py-1 rounded-md text-sm font-medium transition-colors ${D?"text-gray-600 hover:text-gray-900":"bg-white text-gray-900 shadow-sm"}`,children:"Reviews"}),s.jsx("button",{onClick:()=>B(!0),className:`px-3 py-1 rounded-md text-sm font-medium transition-colors ${D?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Rankings"}),s.jsx("button",{onClick:()=>B("unreviewed"),className:`px-3 py-1 rounded-md text-sm font-medium transition-colors ${D==="unreviewed"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Unreviewed"})]})]})]}),D===!1&&s.jsx(jpe,{reviews:b,onSelectReview:re=>{H(re),ie(!0)}}),D===!0&&Qe&&s.jsx("div",{className:"space-y-6",children:Array.from(new Set(b.filter(_e=>_e.review_text!=="ATTENDANCE_ONLY").map(_e=>{const Ke=$e(_e);return Math.round(Ke*10)/10}))).sort((_e,Ke)=>Ke-_e).map(_e=>{const Ke=b.filter(ht=>{if(ht.review_text==="ATTENDANCE_ONLY")return!1;const ct=$e(ht),Pe=Math.round(ct*10)/10;return Math.abs(Pe-_e)<.01});return Ke.length===0?null:s.jsxs("div",{children:[s.jsxs("div",{className:"text-xs font-semibold text-muted-foreground mb-2",children:[_e.toFixed(1),""]}),s.jsx("ul",{className:"glass-card inner-glow divide-y rounded-lg border p-2 floating-shadow",children:Ke.sort((ht,ct)=>{var nt,Me;const Pe=(nt=ht.rank_order)!=null?nt:9999,et=(Me=ct.rank_order)!=null?Me:9999;return Pe!==et?Pe-et:new Date(ct.created_at).getTime()-new Date(ht.created_at).getTime()}).map((ht,ct)=>s.jsxs("li",{className:"flex items-center justify-between px-3 py-2 cursor-pointer hover:bg-gray-50",onClick:()=>{H(ht),ie(!0)},children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-6 w-6 rounded-full bg-gray-100 text-xs flex items-center justify-center border",children:ct+1}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium",children:ht.event.event_name}),s.jsx("div",{className:"text-xs text-muted-foreground",children:(()=>{const Pe=ht.Event_date||(ht.event_date instanceof Date?ht.event_date:ht.event_date?new Date(ht.event_date):null)||(ht.event.event_date?new Date(ht.event.event_date):null);return Pe?Pe.toLocaleDateString():""})()})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[ct>0&&s.jsx(oe,{size:"icon",variant:"ghost",onClick:Pe=>{Pe.stopPropagation();const et=Ke.slice().sort((Me,gt)=>(Me.rank_order||9999)-(gt.rank_order||9999)),nt=et.findIndex(Me=>Me.id===ht.id);if(nt>0){const[Me]=et.splice(nt,1);et.splice(nt-1,0,Me),E(void 0,null,function*(){yield fs.setRankOrderForRatingGroup(e,_e,et.map(gt=>gt.id)),Rt()})}},children:""}),ct<Ke.length-1&&s.jsx(oe,{size:"icon",variant:"ghost",onClick:Pe=>{Pe.stopPropagation();const et=Ke.slice().sort((Me,gt)=>(Me.rank_order||9999)-(gt.rank_order||9999)),nt=et.findIndex(Me=>Me.id===ht.id);if(nt!==-1&&nt<et.length-1){const[Me]=et.splice(nt,1);et.splice(nt+1,0,Me),E(void 0,null,function*(){yield fs.setRankOrderForRatingGroup(e,_e,et.map(gt=>gt.id)),Rt()})}},children:""})]})]},ht.id))})]},_e)})}),D==="unreviewed"&&Qe&&s.jsx("div",{className:"space-y-4",children:Y||G?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-3"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Loading unreviewed events and drafts..."})]}):(()=>{const re=U.filter(ct=>ct.review_text==="ATTENDANCE_ONLY"),_e=new Set(b.filter(ct=>{const Pe=ct.is_draft===!0,et=ct.review_text==="ATTENDANCE_ONLY",nt=ct.review_text&&ct.review_text.trim().length>0;return!Pe&&nt&&!et}).map(ct=>ct.event_id).filter(Boolean)),Ke=K.filter(ct=>{const Pe=ct.event_id;return Pe?!_e.has(Pe):!1}),ht=[...re.map(ct=>({type:"unreviewed",data:ct})),...Ke.map(ct=>({type:"draft",data:ct}))];return ht.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Et,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"All Caught Up!"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"You've reviewed all the events you've attended and have no draft reviews. Great job!"})]}):s.jsx("div",{className:"space-y-4",children:ht.map(ct=>{if(ct.type==="unreviewed"){const Pe=ct.data,et=Pe.jambase_events;return s.jsx(He,{className:"overflow-hidden cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{const nt=et.jambase_event||et,Me=W(M({},nt),{id:nt.id||et.id||Pe.event_id,title:nt.title||et.title||"Unknown Event",artist_name:nt.artist_name||et.artist_name||"Unknown Artist",venue_name:nt.venue_name||et.venue_name||"Unknown Venue",event_date:nt.event_date||et.event_date||new Date().toISOString(),venue_city:nt.venue_city||et.venue_city||null,venue_state:nt.venue_state||et.venue_state||null,setlist:nt.setlist||et.setlist||null,setlist_song_count:nt.setlist_song_count||et.setlist_song_count||null,setlist_fm_url:nt.setlist_fm_url||et.setlist_fm_url||null});console.log("ProfileView: Complete event data for modal:",{originalEvent:et,completeEvent:Me,attendanceEventId:Pe.event_id}),ye(Me),xe(!0)},children:s.jsxs(st,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:et.title}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ct,{className:"w-4 h-4"}),s.jsx("span",{children:et.artist_name})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Xt,{className:"w-4 h-4"}),s.jsx("span",{children:et.venue_name}),et.venue_city&&s.jsxs("span",{className:"text-gray-400",children:[" ",et.venue_city,", ",et.venue_state]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Et,{className:"w-4 h-4"}),s.jsx("span",{children:new Date(et.event_date).toLocaleDateString()})]})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(Be,{variant:"outline",className:"text-orange-600 border-orange-300",children:[s.jsx(Et,{className:"w-3 h-3 mr-1"}),"Needs Review"]})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:["Attended on ",new Date(Pe.created_at).toLocaleDateString()]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(oe,{size:"sm",variant:"outline",onClick:nt=>{nt.stopPropagation();const Me=et.jambase_event||et,gt=W(M({},Me),{id:Me.id||et.id||Pe.event_id,title:Me.title||et.title||"Unknown Event",artist_name:Me.artist_name||et.artist_name||"Unknown Artist",venue_name:Me.venue_name||et.venue_name||"Unknown Venue",event_date:Me.event_date||et.event_date||new Date().toISOString(),venue_city:Me.venue_city||et.venue_city||null,venue_state:Me.venue_state||et.venue_state||null,setlist:Me.setlist||et.setlist||null,setlist_song_count:Me.setlist_song_count||et.setlist_song_count||null,setlist_fm_url:Me.setlist_fm_url||et.setlist_fm_url||null});ye(gt),xe(!0)},children:[s.jsx(aa,{className:"w-4 h-4 mr-2"}),"View Event"]}),s.jsxs(oe,{size:"sm",onClick:nt=>{nt.stopPropagation(),A(et),w(!0)},className:"bg-primary hover:bg-primary/90",children:[s.jsx(Jt,{className:"w-4 h-4 mr-2"}),"Add Review"]})]})]})]})},`unreviewed-${Pe.id}`)}else if(ct.type==="draft"){const Pe=ct.data;return s.jsx(He,{className:"overflow-hidden cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{const et={id:Pe.event_id,title:Pe.event_title||"Draft Review",artist_name:Pe.artist_name||"Unknown Artist",venue_name:Pe.venue_name||"Unknown Venue",event_date:Pe.event_date||new Date().toISOString(),venue_city:null,venue_state:null,setlist:null,setlist_song_count:null,setlist_fm_url:null};A(et),w(!0)},children:s.jsxs(st,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:Pe.event_title||"Draft Review"}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:[Pe.artist_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ct,{className:"w-4 h-4"}),s.jsx("span",{children:Pe.artist_name})]}),Pe.venue_name&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Xt,{className:"w-4 h-4"}),s.jsx("span",{children:Pe.venue_name})]}),Pe.event_date&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Et,{className:"w-4 h-4"}),s.jsx("span",{children:new Date(Pe.event_date).toLocaleDateString()})]})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(Be,{variant:"outline",className:"text-blue-600 border-blue-300",children:[s.jsx(Cu,{className:"w-3 h-3 mr-1"}),"Draft"]})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:["Last saved: ",Pe.last_saved_at?new Date(Pe.last_saved_at).toLocaleDateString():"Unknown"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(oe,{size:"sm",onClick:et=>{et.stopPropagation();const nt={id:Pe.event_id,title:Pe.event_title||"Draft Review",artist_name:Pe.artist_name||"Unknown Artist",venue_name:Pe.venue_name||"Unknown Venue",event_date:Pe.event_date||new Date().toISOString(),venue_city:null,venue_state:null,setlist:null,setlist_song_count:null,setlist_fm_url:null};A(nt),w(!0)},className:"bg-blue-600 hover:bg-blue-700",children:[s.jsx(Cu,{className:"w-4 h-4 mr-2"}),"Continue Draft"]}),s.jsx(oe,{size:"sm",variant:"outline",onClick:et=>E(void 0,null,function*(){if(et.stopPropagation(),confirm("Are you sure you want to delete this draft? This action cannot be undone."))try{if(yield Ah.deleteDraft(Pe.id,e)){const Me=yield Ah.getUserDrafts(e);Z(Me||[]),Ne({title:"Draft Deleted",description:"The draft has been deleted successfully."})}else Ne({title:"Error",description:"Failed to delete draft. Please try again.",variant:"destructive"})}catch(nt){console.error("Error deleting draft:",nt),Ne({title:"Error",description:"Failed to delete draft. Please try again.",variant:"destructive"})}}),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:s.jsx(yc,{className:"w-4 h-4"})})]})]})]})},`draft-${Pe.id}`)}return null})})})()})]}),te&&s.jsxs(On,{value:"interested",className:"mt-4 w-full max-w-full overflow-x-hidden",children:[h.length>0&&s.jsx("div",{className:"flex justify-center mb-4 w-full max-w-full",children:s.jsxs("div",{className:"bg-gray-100 rounded-lg p-1 flex w-full max-w-full",children:[s.jsx("button",{onClick:()=>v(!1),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${g?"text-gray-600 hover:text-gray-900":"bg-white text-gray-900 shadow-sm"}`,children:"Upcoming"}),s.jsx("button",{onClick:()=>v(!0),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${g?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Past"})]})}),h.length===0?s.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[s.jsx(hs,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsx("h3",{className:"text-lg font-semibold",children:"No Interested Events Yet"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Tap the heart on events to add them here."})]}):Ht.length===0?s.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[s.jsx(hs,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsx("h3",{className:"text-lg font-semibold",children:g?"No Past Events":"No Upcoming Events"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:g?"You haven't marked any past events as interested.":"You don't have any upcoming events marked as interested."})]}):s.jsx("div",{className:"grid grid-cols-3 gap-1 w-full max-w-full",children:Ht.sort((re,_e)=>new Date(re.event_date).getTime()-new Date(_e.event_date).getTime()).slice(0,9).map(re=>s.jsx("div",{className:`aspect-square cursor-pointer rounded-md overflow-hidden border bg-white hover:shadow-md transition-shadow relative ${g?"opacity-75":""}`,onClick:()=>{console.log("ProfileView: Event data being passed to modal from interested events:",re);const _e=W(M({},re),{id:re.id||re.jambase_event_id,title:re.title||"Unknown Event",artist_name:re.artist_name||"Unknown Artist",venue_name:re.venue_name||"Unknown Venue",event_date:re.event_date||new Date().toISOString(),venue_city:re.venue_city||null,venue_state:re.venue_state||null,setlist:re.setlist||null,setlist_song_count:re.setlist_song_count||null,setlist_fm_url:re.setlist_fm_url||null});console.log("ProfileView: Complete event data for modal from interested events:",{originalEvent:re,completeEvent:_e,artist_name:_e.artist_name,venue_name:_e.venue_name,venue_city:_e.venue_city,venue_state:_e.venue_state}),ye(_e),xe(!0)},children:s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"h-2/3 w-full relative overflow-hidden bg-gradient-to-br from-pink-400 to-pink-600",children:[(()=>{const _e=re;let Ke;if(_e!=null&&_e.poster_image_url)Ke=_e.poster_image_url;else if(_e!=null&&_e.images&&Array.isArray(_e.images)&&_e.images.length>0){const ht=_e.images.find(ct=>(ct==null?void 0:ct.url)&&((ct==null?void 0:ct.ratio)==="16_9"||(ct==null?void 0:ct.width)&&ct.width>1e3))||_e.images.find(ct=>ct==null?void 0:ct.url);Ke=ht==null?void 0:ht.url}else _e!=null&&_e.media_urls&&Array.isArray(_e.media_urls)&&_e.media_urls.length>0?Ke=_e.media_urls[0]:_e!=null&&_e.event_media_url&&(Ke=_e.event_media_url);return Ke?s.jsx("img",{src:Ke,alt:re.title,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(hs,{className:"w-1/3 h-1/3 text-white"})})})(),!g&&s.jsx("div",{className:"absolute top-1 right-1 bg-white text-black text-[8px] px-1 py-0.5 rounded font-medium",children:"Interested"}),g&&s.jsx("div",{className:"absolute top-1 right-1 bg-white text-black text-[8px] px-1 py-0.5 rounded font-medium",children:"Past"})]}),s.jsxs("div",{className:"p-2 flex-1 flex flex-col justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-xs truncate",children:re.title}),s.jsx("p",{className:"text-xs text-muted-foreground truncate",children:re.venue_name})]}),s.jsxs("div",{className:"text-[10px] text-muted-foreground flex items-center justify-between",children:[s.jsx("span",{children:new Date(re.event_date).toLocaleDateString(void 0,{month:"short",day:"numeric"})}),s.jsx("span",{className:"truncate",children:[re.venue_city,re.venue_state].filter(Boolean).join(", ")})]})]})]})},re.id))})]}),s.jsx(On,{value:"passport",className:"mt-4 mb-32 w-full max-w-full overflow-x-hidden",children:s.jsx(Mpe,{isOpen:!0,onClose:()=>F("my-events"),userId:Ee,userName:(d==null?void 0:d.name)||void 0,inline:!0})})]})]}),s.jsx(vpe,{event:O,userId:e,isOpen:_,onClose:()=>{w(!1),A(null)},onReviewSubmitted:ir}),ge&&ee&&s.jsx(tn,{open:ge,onOpenChange:ie,children:s.jsxs(Xr,{className:"max-w-5xl w-[90vw] h-[90vh] max-h-[90vh] p-0 overflow-hidden bg-transparent border-none shadow-none",children:[s.jsxs(Mn,{className:"sr-only",children:[s.jsx(an,{children:"Review"}),s.jsx(Kn,{children:"View concert review details"})]}),s.jsx("div",{className:"w-full h-full overflow-y-auto p-2",children:s.jsx(L2,{review:{id:ee.id,user_id:ee.user_id||(d==null?void 0:d.user_id)||"",event_id:ee.event_id||"",rating:ee.rating||0,review_text:ee.review_text||"",is_public:(vn=ee.is_public)!=null?vn:!0,created_at:ee.created_at,updated_at:ee.updated_at||ee.created_at,likes_count:ee.likes_count||0,comments_count:ee.comments_count||0,shares_count:ee.shares_count||0,is_liked_by_user:ee.is_liked_by_user||!1,reaction_emoji:ee.reaction_emoji||"",photos:ee.photos||[],videos:ee.videos||[],mood_tags:ee.mood_tags||[],genre_tags:ee.genre_tags||[],context_tags:ee.context_tags||[],artist_name:(Jn=ee.jambase_events)==null?void 0:Jn.artist_name,venue_name:(Fs=ee.jambase_events)==null?void 0:Fs.venue_name,artist_performance_rating:ee.artist_performance_rating,production_rating:ee.production_rating,venue_rating:ee.venue_rating,location_rating:ee.location_rating,value_rating:ee.value_rating,artist_performance_feedback:ee.artist_performance_feedback,production_feedback:ee.production_feedback,venue_feedback:ee.venue_feedback,location_feedback:ee.location_feedback,value_feedback:ee.value_feedback,ticket_price_paid:ee.ticket_price_paid,setlist:ee.setlist||((Mt=ee.jambase_events)==null?void 0:Mt.setlist),custom_setlist:ee.custom_setlist},currentUserId:e,onLike:(re,_e)=>E(void 0,null,function*(){console.log(" ProfileView BelliStyle onLike:",{reviewId:re,isLiked:_e})}),onComment:()=>{console.log("Comment on review from ProfileView")},onShare:()=>{console.log("Share review from ProfileView")},onEdit:()=>{ie(!1),jt(ee)},onDelete:()=>E(void 0,null,function*(){window.confirm("Are you sure you want to delete this review?")&&(yield pt(ee.id),ie(!1),H(null))}),userProfile:{name:(d==null?void 0:d.name)||"User",avatar_url:d==null?void 0:d.avatar_url,verified:d==null?void 0:d.verified,account_type:d==null?void 0:d.account_type}})})]})}),s.jsx(mpe,{isOpen:!!Ae,onClose:()=>qe(!1),type:"friends",friends:Array.isArray(T)?T:[],count:Array.isArray(T)?T.length:0,onStartChat:re=>{console.log("Start chat with friend:",re),l&&l(re)},onViewProfile:re=>{const _e=new CustomEvent("open-user-profile",{detail:{userId:re.user_id}});window.dispatchEvent(_e),qe(!1)},onUnfriend:Ye}),d&&s.jsx(ppe,{isOpen:rt,onClose:()=>Ve(!1),userId:Ee,profileName:d.name,isOwnProfile:Qe}),ne&&ue&&s.jsx(Cc,{event:(console.log(" ProfileView: Event data being passed to EventDetailsModal:",{event:ue,hasSetlist:ue.setlist,hasSetlistEnriched:ue.setlist_enriched,setlistSongCount:ue.setlist_song_count}),ue),currentUserId:e,isOpen:ne,onClose:()=>xe(!1),isInterested:!0,onInterestToggle:(re,_e)=>E(void 0,null,function*(){console.log(" Interest toggled in profile view:",re,_e);try{yield Hn.setEventInterest(e,re,_e),_e||xe(!1),yield wt(),Ne({title:_e?"Interest Added":"Interest Removed",description:_e?"You're now interested in this event":"You've removed this event from your interested list"})}catch(Ke){console.error("Error toggling event interest:",Ke),Ne({title:"Error",description:"Failed to update interest",variant:"destructive"})}}),onNavigateToProfile:o,onNavigateToChat:l,onAttendanceChange:(re,_e)=>E(void 0,null,function*(){console.log(" Attendance changed in profile view:",re,_e),yield Promise.all([wt(),dt()])})}),!Qe&&d&&s.jsx(Jw,{open:le,onClose:()=>Se(!1),contentType:"profile",contentId:Ee,contentTitle:`${d.name}'s profile`,onReportSubmitted:()=>{Se(!1),Ne({title:"Report Submitted",description:"Thank you for helping keep our community safe"})}}),!Qe&&d&&s.jsx(_pe,{open:ae,onClose:()=>fe(!1),user:{id:Ee,name:d.name,avatar_url:d.avatar_url||void 0},isBlocked:he,onBlockToggled:()=>{fe(!1),pe(!he),Ne({title:he?"User Unblocked":"User Blocked",description:he?`You can now see content from ${d.name}`:`You won't see content from ${d.name} anymore`})}})]})):(console.log(" ProfileView: No profile data available after loading"),console.log(" ProfileView: Loading state:",p),console.log(" ProfileView: Current user ID:",e),s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"Profile not found"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Unable to load profile data. Please try again."}),s.jsxs(oe,{onClick:r,children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back"]})]})}))},Ipe=({currentUserId:e,onBack:t,onSave:r})=>{const[n,i]=y.useState(null),[a,o]=y.useState(!0),[l,c]=y.useState(!1),[d,u]=y.useState({name:"",bio:"",instagram_handle:"",music_streaming_profile:"",avatar_url:null,gender:"",birthday:""}),{toast:h}=jr();y.useEffect(()=>{f()},[e]);const f=()=>E(void 0,null,function*(){try{console.log("Fetching profile for user:",e);const g="id, user_id, name, avatar_url, bio, instagram_handle, music_streaming_profile, gender, birthday, created_at, updated_at",v=N=>E(void 0,null,function*(){return console.log(`ProfileEdit: Attempting profile lookup by ${N}`),yield P.from("users").select(g).eq(N,e).maybeSingle()});let _=null;const{data:w,error:b}=yield v("user_id");if(b&&b.code!=="PGRST116")throw console.error("Profile fetch error:",b),console.error("Error code:",b.code),console.error("Error message:",b.message),console.error("Error details:",b.details),b;if(_=w,!_){const{data:N,error:S}=yield v("id");if(S&&S.code!=="PGRST116")throw console.error("Profile fetch fallback error:",S),S;_=N}if(!_){console.log("No profile found, will create one when user saves"),u({name:"",bio:"",instagram_handle:"",music_streaming_profile:"",avatar_url:null,gender:"",birthday:""}),o(!1);return}console.log("Profile data received:",_),i(_),u({name:_.name||"",bio:_.bio||"",instagram_handle:_.instagram_handle||"",music_streaming_profile:_.music_streaming_profile||"",avatar_url:_.avatar_url||null,gender:_.gender||"",birthday:_.birthday||""})}catch(g){console.error("Error fetching profile:",g),h({title:"Error",description:"Failed to load profile",variant:"destructive"})}finally{o(!1)}}),p=()=>E(void 0,null,function*(){if(console.log("Save button clicked, form data:",d),!d.name.trim()){h({title:"Error",description:"Name is required",variant:"destructive"});return}c(!0);try{const g={user_id:e,name:d.name.trim(),bio:d.bio.trim()||null,instagram_handle:d.instagram_handle.trim()||null,music_streaming_profile:d.music_streaming_profile.trim()||null,avatar_url:d.avatar_url||null,gender:d.gender.trim()||null,birthday:d.birthday.trim()||null,updated_at:new Date().toISOString()};console.log("Saving profile with data:",g);let v;if(n&&n.id?(console.log("Updating existing profile"),v=yield P.from("users").update(g).eq("user_id",e).select().single()):(console.log("Creating new profile"),v=yield P.from("users").insert(g).select().single()),v.error)throw console.error("Profile save error:",v.error),v.error;console.log("Profile saved successfully:",v.data),h({title:"Success",description:"Profile saved successfully"}),r()}catch(g){console.error("Error saving profile:",g),h({title:"Error",description:`Failed to save profile: ${g.message}`,variant:"destructive"})}finally{c(!1)}}),x=(g,v)=>{u(_=>W(M({},_),{[g]:v}))};return a?s.jsx(SynthLoadingScreen,{text:"Loading profile..."}):s.jsx("div",{className:"p-4 bg-gray-50",children:s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:t,children:s.jsx(us,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Edit Profile"}),s.jsx("p",{className:"text-muted-foreground",children:"Update your profile information"})]})]}),s.jsxs(He,{children:[s.jsx(xr,{children:s.jsxs(Cr,{className:"flex items-center gap-2",children:[s.jsx(li,{className:"w-5 h-5"}),"Profile Information"]})}),s.jsxs(st,{className:"space-y-6",children:[s.jsx(kce,{value:d.avatar_url,onChange:g=>E(void 0,null,function*(){if(x("avatar_url",g||""),g&&n&&n.id)try{yield P.from("users").update({avatar_url:g}).eq("user_id",e),i(W(M({},n),{avatar_url:g}))}catch(v){console.error("Error auto-saving avatar:",v)}}),userId:e,bucket:"profile-avatars",maxSizeMB:25,label:"Profile Picture",helperText:"Upload a photo to personalize your profile. Max 25MB. Your avatar saves automatically.",aspectRatio:"circle"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"name",children:"Name *"}),s.jsx(or,{id:"name",value:d.name,onChange:g=>x("name",g.target.value),placeholder:"Enter your name",maxLength:50})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"bio",children:"Bio"}),s.jsx(as,{id:"bio",value:d.bio,onChange:g=>x("bio",g.target.value),placeholder:"Tell people about yourself...",maxLength:200,rows:3}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[d.bio.length,"/200 characters"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ut,{htmlFor:"instagram",className:"flex items-center gap-2",children:[s.jsx(JD,{className:"w-4 h-4"}),"Instagram Handle"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-muted-foreground",children:"@"}),s.jsx(or,{id:"instagram",value:d.instagram_handle,onChange:g=>x("instagram_handle",g.target.value.replace("@","")),placeholder:"username",maxLength:100})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your Instagram profile will be linked when people view your profile"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ut,{htmlFor:"music-streaming",className:"flex items-center gap-2",children:[s.jsx(Ct,{className:"w-4 h-4"}),"Music Streaming Profile"]}),s.jsx(or,{id:"music-streaming",value:d.music_streaming_profile,onChange:g=>x("music_streaming_profile",g.target.value),placeholder:"https://open.spotify.com/user/yourusername or @username",maxLength:200}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Share your Spotify, Apple Music, or other streaming profile link. Will display as a clickable link on your profile."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ut,{htmlFor:"gender",className:"flex items-center gap-2",children:[s.jsx(Ar,{className:"w-4 h-4"}),"Gender"]}),s.jsxs(Xs,{value:d.gender||void 0,onValueChange:g=>x("gender",g),children:[s.jsx(Ds,{children:s.jsx(Js,{placeholder:"Select your gender (optional)"})}),s.jsxs(Is,{children:[s.jsx(Lt,{value:"male",children:"Male"}),s.jsx(Lt,{value:"female",children:"Female"}),s.jsx(Lt,{value:"non-binary",children:"Non-binary"}),s.jsx(Lt,{value:"prefer-not-to-say",children:"Prefer not to say"}),s.jsx(Lt,{value:"other",children:"Other"}),s.jsx(Lt,{value:"not-specified",children:"Not specified"})]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your gender will be shown to other users interested in the same events for trust and safety"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ut,{htmlFor:"birthday",className:"flex items-center gap-2",children:[s.jsx(Et,{className:"w-4 h-4"}),"Birthday"]}),s.jsx(or,{id:"birthday",type:"date",value:d.birthday,onChange:g=>x("birthday",g.target.value),max:(()=>{const g=new Date;return g.setFullYear(g.getFullYear()-13),g.toISOString().split("T")[0]})()}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your age (not exact birthday) will be shown to other users interested in the same events. You must be at least 13 years old."})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsxs(oe,{onClick:p,disabled:l||!d.name.trim(),className:"flex-1",children:[s.jsx(Kk,{className:"w-4 h-4 mr-2"}),l?"Saving...":"Save Changes"]}),s.jsx(oe,{variant:"outline",onClick:t,children:"Cancel"})]})]})]})]})})},$pe=`
  @keyframes elegant-shift {
    0% { background-position: 0% 50%; }
    25% { background-position: 100% 50%; }
    50% { background-position: 100% 100%; }
    75% { background-position: 0% 100%; }
    100% { background-position: 0% 50%; }
  }
`;if(typeof document!="undefined"){const e=document.createElement("style");e.textContent=$pe,document.head.appendChild(e)}function Pz({onAuthSuccess:e}){const[t,r]=y.useState(""),[n,i]=y.useState(""),[a,o]=y.useState(""),[l,c]=y.useState(!1),{toast:d}=jr(),u=f=>E(this,null,function*(){f.preventDefault(),c(!0);try{const{error:p}=yield P.auth.signUp({email:t,password:n,options:{emailRedirectTo:"https://synth-beta-testing.vercel.app/#onboarding",data:{name:a}}});if(p)throw p;d({title:"Check your email!",description:"We sent you a confirmation link."})}catch(p){d({title:"Sign up failed",description:p.message,variant:"destructive"})}finally{c(!1)}}),h=f=>E(this,null,function*(){f.preventDefault(),c(!0);try{const{error:p}=yield P.auth.signInWithPassword({email:t,password:n});if(p)throw p;d({title:"Welcome back!",description:"You're now signed in."}),e()}catch(p){d({title:"Sign in failed",description:p.message,variant:"destructive"})}finally{c(!1)}});return s.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{background:"linear-gradient(45deg, #fdf2f8 0%, #ffffff 25%, #fce7f3 50%, #ffffff 75%, #fdf2f8 100%)",backgroundSize:"400% 400%",animation:"elegant-shift 20s ease infinite"},children:s.jsxs(He,{className:"w-full max-w-md bg-white/90 backdrop-blur-lg rounded-3xl shadow-xl border-0",children:[s.jsxs(xr,{className:"text-center pb-8",children:[s.jsx("div",{className:"flex justify-center mb-6",children:s.jsx("img",{src:"/Logos/Main logo black background.png",alt:"Synth Logo",className:"w-20 h-20 rounded-2xl"})}),s.jsx(Cr,{className:"text-3xl font-bold text-black mb-2",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Synth"}),s.jsx(Hu,{className:"text-[#666666] text-base",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Connect with people at events you love"})]}),s.jsx(st,{className:"px-10 pb-10",children:s.jsxs(Cl,{defaultValue:"signin",children:[s.jsxs(Fo,{className:"grid w-full grid-cols-2 bg-[#F5F5DC] rounded-xl p-1",children:[s.jsx(Tn,{value:"signin",className:"data-[state=active]:bg-white data-[state=active]:text-black text-[#666666] font-medium rounded-lg transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Sign In"}),s.jsx(Tn,{value:"signup",className:"data-[state=active]:bg-white data-[state=active]:text-black text-[#666666] font-medium rounded-lg transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:"Sign Up"})]}),s.jsx(On,{value:"signin",className:"mt-6",children:s.jsxs("form",{onSubmit:h,className:"space-y-6",children:[s.jsx("div",{children:s.jsx(or,{id:"signin-email",name:"signinEmail",type:"email",placeholder:"Email",value:t,onChange:f=>r(f.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx("div",{children:s.jsx(or,{id:"signin-password",name:"signinPassword",type:"password",placeholder:"Password",value:n,onChange:f=>i(f.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx(oe,{type:"submit",disabled:l,className:"w-full bg-[#FF3399] hover:bg-[#E6007A] text-white font-semibold py-3 px-6 rounded-lg transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:l?"Signing in...":"Sign In"})]})}),s.jsx(On,{value:"signup",className:"mt-6",children:s.jsxs("form",{onSubmit:u,className:"space-y-6",children:[s.jsx("div",{children:s.jsx(or,{id:"signup-name",name:"signupName",type:"text",placeholder:"Your name",value:a,onChange:f=>o(f.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx("div",{children:s.jsx(or,{id:"signup-email",name:"signupEmail",type:"email",placeholder:"Email",value:t,onChange:f=>r(f.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx("div",{children:s.jsx(or,{id:"signup-password",name:"signupPassword",type:"password",placeholder:"Password (min 6 characters)",value:n,onChange:f=>i(f.target.value),required:!0,minLength:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-[#FF3399] focus:ring-2 focus:ring-[#FF3399]/20 transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"}})}),s.jsx(oe,{type:"submit",disabled:l,className:"w-full bg-[#FF3399] hover:bg-[#E6007A] text-white font-semibold py-3 px-6 rounded-lg transition-all",style:{fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},children:l?"Creating account...":"Sign Up"})]})})]})})]})})}var _1="Switch",[Lpe,TFe]=js(_1),[Fpe,Upe]=Lpe(_1),Az=y.forwardRef((e,t)=>{const b=e,{__scopeSwitch:r,name:n,checked:i,defaultChecked:a,required:o,disabled:l,value:c="on",onCheckedChange:d,form:u}=b,h=me(b,["__scopeSwitch","name","checked","defaultChecked","required","disabled","value","onCheckedChange","form"]),[f,p]=y.useState(null),x=sr(t,N=>p(N)),g=y.useRef(!1),v=f?u||!!f.closest("form"):!0,[_,w]=Di({prop:i,defaultProp:a!=null?a:!1,onChange:d,caller:_1});return s.jsxs(Fpe,{scope:r,checked:_,disabled:l,children:[s.jsx(Nt.button,W(M({type:"button",role:"switch","aria-checked":_,"aria-required":o,"data-state":Mz(_),"data-disabled":l?"":void 0,disabled:l,value:c},h),{ref:x,onClick:mt(e.onClick,N=>{w(S=>!S),v&&(g.current=N.isPropagationStopped(),g.current||N.stopPropagation())})})),v&&s.jsx(Rz,{control:f,bubbles:!g.current,name:n,value:c,checked:_,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"}})]})});Az.displayName=_1;var Tz="SwitchThumb",Oz=y.forwardRef((e,t)=>{const a=e,{__scopeSwitch:r}=a,n=me(a,["__scopeSwitch"]),i=Upe(Tz,r);return s.jsx(Nt.span,W(M({"data-state":Mz(i.checked),"data-disabled":i.disabled?"":void 0},n),{ref:t}))});Oz.displayName=Tz;var Bpe="SwitchBubbleInput",Rz=y.forwardRef((o,a)=>{var l=o,{__scopeSwitch:e,control:t,checked:r,bubbles:n=!0}=l,i=me(l,["__scopeSwitch","control","checked","bubbles"]);const c=y.useRef(null),d=sr(c,a),u=l1(r),h=bw(t);return y.useEffect(()=>{const f=c.current;if(!f)return;const p=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(p,"checked").set;if(u!==r&&g){const v=new Event("click",{bubbles:n});g.call(f,r),f.dispatchEvent(v)}},[u,r,n]),s.jsx("input",W(M({type:"checkbox","aria-hidden":!0,defaultChecked:r},i),{tabIndex:-1,ref:d,style:W(M(M({},i.style),h),{position:"absolute",pointerEvents:"none",opacity:0,margin:0})}))});Rz.displayName=Bpe;function Mz(e){return e?"checked":"unchecked"}var Dz=Az,zpe=Oz;const $0=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(Dz,W(M({className:ke("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e)},t),{ref:r,children:s.jsx(zpe,{className:ke("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}))});$0.displayName=Dz.displayName;class sy{static getUserMusicTags(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("user_preferences").select("preferred_genres, preferred_artists, music_preference_signals").eq("user_id",t).maybeSingle();if(n&&n.code!=="PGRST116")throw n;if(!r)return[];const i=(r.preferred_genres||[]).map(l=>({id:`${t}-genre-${l}`,user_id:t,tag_type:"genre",tag_value:l,tag_source:"manual",weight:5,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),a=r.preferred_artists||[];let o=[];if(a.length>0){const{data:l}=yield P.from("artists").select("id, name").in("id",a);l&&(o=l.map(c=>({id:`${t}-artist-${c.id}`,user_id:t,tag_type:"artist",tag_value:c.name,tag_source:"manual",weight:5,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})))}return[...i,...o]}catch(r){return console.error("Error fetching user music tags:",r),[]}})}static getUserMusicTagsByType(t,r){return E(this,null,function*(){try{return(yield this.getUserMusicTags(t)).filter(i=>i.tag_type===r)}catch(n){return console.error(`Error fetching ${r} tags:`,n),[]}})}static addMusicTag(t,r){return E(this,null,function*(){try{const{data:n}=yield P.from("user_preferences").select("preferred_genres, preferred_artists, id").eq("user_id",t).maybeSingle(),i=(n==null?void 0:n.preferred_genres)||[],a=(n==null?void 0:n.preferred_artists)||[];let o;if(r.tag_type==="genre")i.includes(r.tag_value)||i.push(r.tag_value),o={preferred_genres:i,preferred_artists:a,updated_at:new Date().toISOString()};else{let d=null;const{data:u,error:h}=yield P.from("artists").select("id, name").ilike("name",r.tag_value).limit(1).maybeSingle();if(h&&h.code!=="PGRST116"&&console.warn(`Error searching for artist "${r.tag_value}":`,h),u)d=u.id;else try{const{MissingEntityRequestService:f}=yield on(()=>E(this,null,function*(){const{MissingEntityRequestService:p}=yield import("./missingEntityRequestService-DTKxUBjt.js");return{MissingEntityRequestService:p}}),[],import.meta.url);yield f.submitRequest({entity_type:"artist",entity_name:r.tag_value}),console.log(` Submitted request for missing artist: "${r.tag_value}"`)}catch(f){console.warn(`Error submitting artist request "${r.tag_value}":`,f)}d&&!a.includes(d)&&a.push(d),o={preferred_genres:i,preferred_artists:a,updated_at:new Date().toISOString()}}let l,c;if(n){const d=yield P.from("user_preferences").update(o).eq("user_id",t).select().single();l=d.data,c=d.error}else{const d=yield P.from("user_preferences").insert(M({user_id:t},o)).select().single();l=d.data,c=d.error}if(c)throw c;return{id:`${t}-${r.tag_type}-${r.tag_value}`,user_id:t,tag_type:r.tag_type,tag_value:r.tag_value,tag_source:r.tag_source||"manual",weight:r.weight||5,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}catch(n){return console.error("Error adding music tag:",n),null}})}static removeMusicTag(t){return E(this,null,function*(){try{const r=t.split("-");if(r.length<3)return console.error("Invalid tag ID format:",t),!1;const n=r[0],i=r[1],a=r.slice(2).join("-");return yield this.removeMusicTagByValue(n,i,a)}catch(r){return console.error("Error removing music tag:",r),!1}})}static removeMusicTagByValue(t,r,n){return E(this,null,function*(){try{const{data:i}=yield P.from("user_preferences").select("preferred_genres, preferred_artists").eq("user_id",t).maybeSingle();if(!i)return!0;let a=i.preferred_genres||[],o=i.preferred_artists||[];if(r==="genre")a=a.filter(c=>c!==n);else{const{data:c}=yield P.from("artists").select("id").eq("name",n).maybeSingle();c?o=o.filter(d=>d!==c.id):console.warn(` Artist "${n}" not found in database, cannot remove`)}const{error:l}=yield P.from("user_preferences").update({preferred_genres:a,preferred_artists:o,updated_at:new Date().toISOString()}).eq("user_id",t);if(l)throw l;return!0}catch(i){return console.error("Error removing music tag by value:",i),!1}})}static bulkUpdateMusicTags(t,r){return E(this,null,function*(){try{const n=r.filter(d=>d.tag_type==="genre").map(d=>d.tag_value),i=r.filter(d=>d.tag_type==="artist").map(d=>d.tag_value),a=[];if(i.length>0)for(const d of i)try{const{data:u,error:h}=yield P.from("artists").select("id, name").ilike("name",d).limit(1).maybeSingle();if(h&&h.code!=="PGRST116"){console.warn(`Error searching for artist "${d}":`,h);continue}if(u)a.includes(u.id)||a.push(u.id);else{const f=d.toLowerCase().replace(/\s+/g,"-"),p=`manual:${f}-${Date.now()}`,{data:x,error:g}=yield P.from("artists").insert({name:d,identifier:f,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("id").single();if(g){console.warn(`Error creating artist "${d}":`,g);continue}x&&(yield P.from("external_entity_ids").insert({entity_type:"artist",entity_uuid:x.id,source:"manual",external_id:p}).catch(()=>{}),a.push(x.id),console.log(` Created new artist: "${d}" (${x.id})`))}}catch(u){console.error(`Error processing artist "${d}":`,u)}const{data:o,error:l}=yield P.from("user_preferences").select("id").eq("user_id",t).maybeSingle();if(l&&l.code!=="PGRST116")throw l;const c={preferred_genres:n||[],preferred_artists:a,updated_at:new Date().toISOString()};if(o){const{error:d}=yield P.from("user_preferences").update(c).eq("user_id",t);if(d)throw d}else{const{error:d}=yield P.from("user_preferences").insert({user_id:t,preferred_genres:n||[],preferred_artists:a,updated_at:new Date().toISOString()});if(d)throw d}return!0}catch(n){return console.error("Error bulk updating music tags:",n),!1}})}static syncSpotifyTags(t,r){return E(this,null,function*(){try{const{data:n}=yield P.from("user_preferences").select("preferred_genres, preferred_artists, music_preference_signals, id").eq("user_id",t).maybeSingle();let i=(n==null?void 0:n.preferred_genres)||[],a=(n==null?void 0:n.preferred_artists)||[];const o=(n==null?void 0:n.music_preference_signals)||{},l=r.filter(f=>f.tag_type==="artist").map(f=>f.tag_value),c=[];if(l.length>0)for(const f of l)try{const{data:p,error:x}=yield P.from("artists").select("id, name").ilike("name",f).limit(1).maybeSingle();if(x&&x.code!=="PGRST116"){console.warn(`Error searching for Spotify artist "${f}":`,x);continue}if(p)c.includes(p.id)||c.push(p.id);else{const g=f.toLowerCase().replace(/\s+/g,"-"),{data:v,error:_}=yield P.from("artists").insert({name:f,jambase_artist_id:`spotify:${g}-${Date.now()}`,identifier:g,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("id").single();if(_){console.warn(`Error creating Spotify artist "${f}":`,_);continue}v&&(c.push(v.id),console.log(` Created new Spotify artist: "${f}" (${v.id})`))}}catch(p){console.error(`Error processing Spotify artist "${f}":`,p)}r.forEach(f=>{f.tag_type==="genre"&&(i.includes(f.tag_value)||i.push(f.tag_value))});const d=[...new Set([...a,...c])],u={preferred_genres:i,preferred_artists:d,music_preference_signals:o,updated_at:new Date().toISOString()};let h;if(n?h=(yield P.from("user_preferences").update(u).eq("user_id",t)).error:h=(yield P.from("user_preferences").insert(M({user_id:t},u))).error,h)throw h;return!0}catch(n){return console.error("Error syncing Spotify tags:",n),!1}})}static updateTagWeight(t,r){return E(this,null,function*(){try{const n=t.split("-");if(n.length<3)return console.error("Invalid tag ID format:",t),!1;const i=n[0],a=n[1],o=n.slice(2).join("-"),{data:l}=yield P.from("user_preferences").select("music_preference_signals").eq("user_id",i).single(),c=(l==null?void 0:l.music_preference_signals)||{},d=`${a}_${o}`;c[d]=W(M({},c[d]),{weight:r});const{error:u}=yield P.from("user_preferences").update({music_preference_signals:c,updated_at:new Date().toISOString()}).eq("user_id",i);if(u)throw u;return!0}catch(n){return console.error("Error updating tag weight:",n),!1}})}static getMusicPreferencesSummary(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("user_preferences").select("preferred_genres, preferred_artists, music_preference_signals").eq("user_id",t).maybeSingle();if(n&&n.code!=="PGRST116")throw n;const i=(r==null?void 0:r.preferred_genres)||[],a=(r==null?void 0:r.preferred_artists)||[],o=(r==null?void 0:r.music_preference_signals)||{};let l=[];if(a.length>0){const{data:d}=yield P.from("artists").select("name").in("id",a);d&&(l=d.map(u=>u.name))}const c=Object.keys(o).some(d=>{var u;return typeof o[d]=="object"&&((u=o[d])==null?void 0:u.source)==="spotify"});return{genres:i,artists:l,hasSpotify:c}}catch(r){return console.error("Error getting music preferences summary:",r),{genres:[],artists:[],hasSpotify:!1}}})}}const Iz=["Rock","Pop","Hip Hop","Rap","Electronic","Jazz","Classical","Indie","R&B","Soul","Country","Metal","Folk","Punk","Blues","Reggae","EDM","House","Techno","Dubstep","Trance","Drum & Bass","Ambient","Alternative","Grunge","Hard Rock","Progressive Rock","Psychedelic Rock","Trap","Grime","Afrobeat","Disco","Funk","Dance","Latin","Reggaeton","K-Pop","Salsa","Bossa Nova","Gospel","Bluegrass","Ska","Emo","Screamo","Shoegaze","Post-Rock","Industrial","Experimental","Lo-Fi","Other"],Vpe=({onClose:e})=>{const{user:t}=os(),{toast:r}=jr(),[n,i]=y.useState(null),[a,o]=y.useState([]),[l,c]=y.useState(!0),[d,u]=y.useState(!1),[h,f]=y.useState({location_city:"",gender:"",birthday:"",bio:"",similar_users_notifications:!0}),[p,x]=y.useState({genres:[],artists:[],customGenres:[],customArtists:[]});y.useEffect(()=>{t!=null&&t.id&&g()},[t==null?void 0:t.id]);const g=()=>E(void 0,null,function*(){var b;if(t!=null&&t.id)try{const{data:N,error:S}=yield P.from("users").select("*").eq("user_id",t.id).single();if(S&&S.code!=="PGRST116")throw S;N&&(i(N),f({location_city:N.location_city||"",gender:N.gender||"",birthday:N.birthday||"",bio:N.bio||"",similar_users_notifications:(b=N.similar_users_notifications)!=null?b:!0}));const k=yield sy.getUserMusicTags(t.id);o(k);const O=k.filter(T=>T.tag_type==="genre").map(T=>T.tag_value),A=k.filter(T=>T.tag_type==="artist").map(T=>T.tag_value);x(T=>W(M({},T),{genres:O,artists:A}))}catch(N){console.error("Error fetching user data:",N),r({title:"Error",description:"Failed to load your preferences",variant:"destructive"})}finally{c(!1)}}),v=(b,N)=>{f(S=>W(M({},S),{[b]:N}))},_=(b,N,S)=>E(void 0,null,function*(){if(t!=null&&t.id)try{if(S)yield sy.addMusicTag(t.id,{tag_type:b,tag_value:N,tag_source:"manual",weight:5});else{const T=a.find($=>$.tag_type===b&&$.tag_value===N);T&&(yield sy.removeMusicTag(t.id,T.id))}const k=yield sy.getUserMusicTags(t.id);o(k);const O=k.filter(T=>T.tag_type==="genre").map(T=>T.tag_value),A=k.filter(T=>T.tag_type==="artist").map(T=>T.tag_value);x(T=>W(M({},T),{genres:O,artists:A}))}catch(k){console.error("Error updating music tag:",k),r({title:"Error",description:"Failed to update music preferences",variant:"destructive"})}}),w=()=>E(void 0,null,function*(){if(t!=null&&t.id){u(!0);try{const{error:b}=yield P.from("users").update({location_city:h.location_city.trim()||null,gender:h.gender.trim()||null,birthday:h.birthday.trim()||null,bio:h.bio.trim()||null,similar_users_notifications:h.similar_users_notifications,updated_at:new Date().toISOString()}).eq("user_id",t.id);if(b)throw b;r({title:"Success",description:"Your preferences have been saved"}),e&&e()}catch(b){console.error("Error saving preferences:",b),r({title:"Error",description:"Failed to save preferences",variant:"destructive"})}finally{u(!1)}}});return l?s.jsx("div",{className:"flex items-center justify-center p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading preferences..."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(li,{className:"w-5 h-5 text-primary"}),"Profile & Preferences"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your profile information and personalization settings"})]}),s.jsx(Jo,{}),s.jsxs(He,{children:[s.jsx(xr,{className:"pb-3",children:s.jsxs(Cr,{className:"text-base flex items-center gap-2",children:[s.jsx(Xt,{className:"w-4 h-4"}),"Location"]})}),s.jsx(st,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"location",children:"City"}),s.jsx(or,{id:"location",value:h.location_city,onChange:b=>v("location_city",b.target.value),placeholder:"Enter your city",maxLength:100,className:"bg-white"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Used for local event discovery and recommendations"})]})})]}),s.jsxs(He,{children:[s.jsx(xr,{className:"pb-3",children:s.jsxs(Cr,{className:"text-base flex items-center gap-2",children:[s.jsx(Ar,{className:"w-4 h-4"}),"Demographics"]})}),s.jsxs(st,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"gender",children:"Gender"}),s.jsxs(Xs,{value:h.gender||void 0,onValueChange:b=>v("gender",b),children:[s.jsx(Ds,{className:"bg-white",children:s.jsx(Js,{placeholder:"Select your gender (optional)"})}),s.jsxs(Is,{className:"bg-white",children:[s.jsx(Lt,{value:"male",children:"Male"}),s.jsx(Lt,{value:"female",children:"Female"}),s.jsx(Lt,{value:"non-binary",children:"Non-binary"}),s.jsx(Lt,{value:"prefer-not-to-say",children:"Prefer not to say"}),s.jsx(Lt,{value:"other",children:"Other"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"birthday",children:"Birthday"}),s.jsx(or,{id:"birthday",type:"date",value:h.birthday,onChange:b=>v("birthday",b.target.value),max:(()=>{const b=new Date;return b.setFullYear(b.getFullYear()-13),b.toISOString().split("T")[0]})(),className:"bg-white"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your age (not exact birthday) helps with event recommendations and safety"})]})]})]}),s.jsxs(He,{children:[s.jsx(xr,{className:"pb-3",children:s.jsxs(Cr,{className:"text-base flex items-center gap-2",children:[s.jsx(XJ,{className:"w-4 h-4"}),"Bio"]})}),s.jsx(st,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"bio",children:"About You"}),s.jsx(as,{id:"bio",value:h.bio,onChange:b=>v("bio",b.target.value),placeholder:"Tell people about yourself...",maxLength:200,rows:3,className:"bg-white"}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[h.bio.length,"/200 characters"]})]})})]}),s.jsxs(He,{children:[s.jsx(xr,{className:"pb-3",children:s.jsxs(Cr,{className:"text-base flex items-center gap-2",children:[s.jsx(Ct,{className:"w-4 h-4"}),"Music Preferences"]})}),s.jsxs(st,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Ut,{className:"text-sm font-medium",children:"Favorite Genres"}),s.jsxs(Be,{variant:"secondary",children:[p.genres.length,"/7"]})]}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:Iz.slice(0,20).map(b=>s.jsx(oe,{type:"button",variant:p.genres.includes(b)?"default":"outline",size:"sm",onClick:()=>_("genre",b,!p.genres.includes(b)),disabled:!p.genres.includes(b)&&p.genres.length>=7,className:"justify-start text-xs",children:b},b))}),p.genres.length>=7&&s.jsx("p",{className:"text-xs text-amber-600",children:"Maximum of 7 genres selected"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Ut,{className:"text-sm font-medium",children:"Favorite Artists"}),s.jsxs(Be,{variant:"secondary",children:[p.artists.length,"/15"]})]}),p.artists.length>0?s.jsx("div",{className:"flex flex-wrap gap-2",children:p.artists.map(b=>s.jsxs(Be,{variant:"secondary",className:"flex items-center gap-1",children:[b,s.jsx("button",{type:"button",onClick:()=>_("artist",b,!1),className:"ml-1 text-xs hover:text-destructive",children:""})]},b))}):s.jsx("p",{className:"text-sm text-muted-foreground",children:"Add artists by searching for them in the search bar or during onboarding"})]})]})]}),s.jsxs(He,{children:[s.jsx(xr,{className:"pb-3",children:s.jsxs(Cr,{className:"text-base flex items-center gap-2",children:[s.jsx(Uu,{className:"w-4 h-4"}),"Notifications"]})}),s.jsx(st,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:"Similar Users Notifications"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Get notified when similar users (age, gender, interests) show interest in events"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Helps you connect with people who share your interests and demographics"})]}),s.jsx($0,{checked:h.similar_users_notifications,onCheckedChange:b=>v("similar_users_notifications",b)})]})})]}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsxs(oe,{onClick:w,disabled:d,className:"min-w-[120px]",children:[s.jsx(Kk,{className:"w-4 h-4 mr-2"}),d?"Saving...":"Save Changes"]})})]})};function $z(e){return E(this,null,function*(){try{const{data:t,error:r}=yield P.from("user_settings_preferences").select("*").eq("user_id",e).single();if(r){if(r.code==="PGRST116")return yield Lz(e);throw console.error("Error fetching user settings preferences:",r),r}return t}catch(t){return console.error("Failed to get user settings preferences:",t),null}})}function qpe(){return E(this,null,function*(){try{const{data:{user:e}}=yield P.auth.getUser();if(!e)throw new Error("No authenticated user");return yield $z(e.id)}catch(e){return console.error("Failed to get current user settings preferences:",e),null}})}function Wpe(e,t){return E(this,null,function*(){try{yield Hpe(e);const{data:r,error:n}=yield P.from("user_settings_preferences").update(t).eq("user_id",e).select().single();if(n)throw console.error("Error updating user settings preferences:",n),n;return r}catch(r){return console.error("Failed to update user settings preferences:",r),null}})}function $j(e){return E(this,null,function*(){try{const{data:{user:t}}=yield P.auth.getUser();if(!t)throw new Error("No authenticated user");return yield Wpe(t.id,e)}catch(t){return console.error("Failed to update current user settings preferences:",t),null}})}function Lz(e){return E(this,null,function*(){try{const{data:t,error:r}=yield P.from("user_settings_preferences").insert({user_id:e,enable_push_notifications:!0,enable_emails:!0,is_public_profile:!0}).select().single();if(r)throw console.error("Error creating user settings preferences:",r),r;return t}catch(t){return console.error("Failed to create user settings preferences:",t),null}})}function Hpe(e){return E(this,null,function*(){try{let t=yield $z(e);return t||(t=yield Lz(e)),t}catch(t){return console.error("Failed to ensure user settings preferences exist:",t),null}})}const Gpe=({isOpen:e,onClose:t,onSignOut:r,userEmail:n})=>{const[i,a]=y.useState(!1),[o,l]=y.useState("menu"),[c,d]=y.useState(!1),[u,h]=y.useState(!1),[f,p]=y.useState(""),[x,g]=y.useState(!0),[v,_]=y.useState(!1),[w,b]=y.useState(!0),[N,S]=y.useState("user"),[k,O]=y.useState(!1),[A,T]=y.useState(!0),[$,R]=y.useState(!0),[F,D]=y.useState(!1),{toast:B}=jr(),{user:U}=os(),V=()=>E(void 0,null,function*(){a(!0);try{yield r(),t(),B({title:"Signed out successfully",description:"You've been signed out of your account."})}catch(se){console.error("Error signing out:",se),B({title:"Error",description:"Failed to sign out. Please try again.",variant:"destructive"})}finally{a(!1)}}),Y=()=>{l("menu"),p(""),t()},z=()=>{l("menu"),p("")},K=()=>E(void 0,null,function*(){if(!n){B({title:"Error",description:"No email address found for this account.",variant:"destructive"});return}d(!0);try{const{error:se}=yield P.auth.resetPasswordForEmail(n,{redirectTo:"https://synth-beta-testing.vercel.app/reset-password"});if(se)throw se;B({title:"Password reset email sent",description:"Check your email for instructions to reset your password."})}catch(se){console.error("Error sending password reset:",se),B({title:"Error",description:se.message||"Failed to send password reset email.",variant:"destructive"})}finally{d(!1)}}),Z=()=>E(void 0,null,function*(){if(!f.trim()){B({title:"Error",description:"Please enter a new email address.",variant:"destructive"});return}if(f===n){B({title:"Error",description:"The new email address must be different from your current email.",variant:"destructive"});return}h(!0);try{const{error:se}=yield P.auth.updateUser({email:f});if(se)throw se;B({title:"Email change confirmation sent",description:`Check ${f} for a confirmation link to complete the change.`}),p("")}catch(se){console.error("Error changing email:",se),B({title:"Error",description:se.message||"Failed to send email change confirmation.",variant:"destructive"})}finally{h(!1)}}),G=se=>E(void 0,null,function*(){if(U!=null&&U.id){_(!0);try{if(se&&!(yield Th.hasProfilePicture(U.id))){B({title:"Profile Picture Required",description:"You must upload a profile picture before making your profile public. Go to Edit Profile to add a photo.",variant:"destructive"}),_(!1);return}if(yield Th.setProfileVisibility(U.id,se))yield $j({is_public_profile:se}),g(se),B({title:se?"Profile is now public":"Profile is now private",description:se?"Your profile is visible to all users.":"Your profile is only visible to your friends."});else throw new Error("Failed to update visibility")}catch(ue){console.error("Error toggling profile visibility:",ue),B({title:"Error",description:"Failed to update profile visibility. Please try again.",variant:"destructive"})}finally{_(!1)}}}),X=se=>E(void 0,null,function*(){if(U!=null&&U.id){D(!0);try{if(yield $j({enable_push_notifications:se}))T(se),B({title:se?"Push notifications enabled":"Push notifications disabled",description:se?"You will receive push notifications.":"Push notifications are now disabled."});else throw new Error("Failed to update preferences")}catch(ue){console.error("Error toggling push notifications:",ue),B({title:"Error",description:"Failed to update push notification preferences. Please try again.",variant:"destructive"})}finally{D(!1)}}}),te=se=>E(void 0,null,function*(){if(U!=null&&U.id){D(!0);try{if(yield $j({enable_emails:se}))R(se),B({title:se?"Email notifications enabled":"Email notifications disabled",description:se?"You will receive email notifications.":"Email notifications are now disabled."});else throw new Error("Failed to update preferences")}catch(ue){console.error("Error toggling email notifications:",ue),B({title:"Error",description:"Failed to update email preferences. Please try again.",variant:"destructive"})}finally{D(!1)}}});return y.useEffect(()=>{e&&(U!=null&&U.id)&&(Th.getUserVisibilitySettings(U.id).then(se=>{se&&(g(se.is_public_profile),b(se.has_avatar))}).catch(se=>{console.error("Error loading visibility settings:",se),g(!0),b(!0)}),D(!0),qpe().then(se=>{se&&(T(se.enable_push_notifications),R(se.enable_emails),se.is_public_profile!==void 0&&g(se.is_public_profile))}).catch(se=>{console.error("Error loading user settings preferences:",se)}).finally(()=>{D(!1)}),P.from("users").select("account_type, verified").eq("user_id",U.id).single().then(({data:se})=>{se&&(S(se.account_type||"user"),O(se.verified||!1))}))},[e,U==null?void 0:U.id]),s.jsx(tn,{open:e,onOpenChange:Y,children:s.jsxs(Xr,{className:"max-w-md w-[95vw] max-h-[90vh] overflow-y-auto",children:[s.jsx(Mn,{children:s.jsxs(an,{className:"flex items-center gap-2",children:[o!=="menu"&&s.jsx(oe,{variant:"ghost",size:"sm",onClick:z,className:"mr-2 -ml-2",children:" Back"}),o==="menu"&&s.jsx(Ql,{className:"w-5 h-5"}),o==="menu"?"Settings":o==="onboarding-preferences"?"Profile & Preferences":o==="security-actions"?"Security Actions":o==="verification"?"Verification Status":"Settings"]})}),o==="menu"?s.jsxs("div",{className:"space-y-4",children:[n&&s.jsx("div",{className:"p-3 bg-muted/50 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(li,{className:"w-4 h-4"}),s.jsxs("span",{children:["Signed in as: ",n]})]})}),s.jsx(Jo,{}),s.jsx("div",{className:"p-4 bg-muted/30 rounded-lg border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[x?s.jsx(lf,{className:"w-5 h-5 text-primary mt-0.5"}):s.jsx(DJ,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:"Public Profile"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:x?"Your profile is visible to all users":"Your profile is only visible to friends"}),!w&&s.jsxs("div",{className:"text-xs text-amber-600 mt-1 flex items-center gap-1",children:[s.jsx(ag,{className:"w-3 h-3"}),"Profile picture required to make profile public"]})]})]}),s.jsx($0,{checked:x,onCheckedChange:G,disabled:v})]})}),s.jsx(Jo,{}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"p-4 bg-muted/30 rounded-lg border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[s.jsx(Uu,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:"Push Notifications"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:A?"You will receive push notifications":"Push notifications are disabled"})]})]}),s.jsx($0,{checked:A,onCheckedChange:X,disabled:F})]})}),s.jsx("div",{className:"p-4 bg-muted/30 rounded-lg border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[s.jsx(HJ,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:"Email Notifications"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:$?"You will receive email notifications":"Email notifications are disabled"})]})]}),s.jsx($0,{checked:$,onCheckedChange:te,disabled:F})]})})]}),s.jsx(Jo,{}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(oe,{variant:"ghost",className:"w-full justify-start gap-3 h-12",onClick:()=>l("onboarding-preferences"),children:[s.jsx(li,{className:"w-5 h-5"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-medium",children:"Profile & Preferences"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Manage your profile information and preferences"})]})]}),s.jsxs(oe,{variant:"ghost",className:"w-full justify-start gap-3 h-12",onClick:()=>l("security-actions"),children:[s.jsx(Ql,{className:"w-5 h-5"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-medium",children:"Security Actions"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Change password, email, and security settings"})]})]}),s.jsxs(oe,{variant:"ghost",className:"w-full justify-start gap-3 h-12",onClick:()=>l("verification"),children:[s.jsx(Jl,{className:"w-5 h-5"}),s.jsxs("div",{className:"text-left",children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:["Verification Status",k&&s.jsx("span",{className:"text-xs text-green-600",children:" Verified"})]}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Track your verification progress"})]})]})]}),s.jsx(Jo,{}),s.jsxs(oe,{variant:"destructive",className:"w-full gap-3 h-12",onClick:V,disabled:i,children:[s.jsx(WJ,{className:"w-5 h-5"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-medium",children:i?"Signing out...":"Sign Out"}),s.jsx("div",{className:"text-sm opacity-80",children:i?"Please wait...":"Sign out of your account"})]})]})]}):o==="onboarding-preferences"?s.jsx(Vpe,{onClose:z}):o==="verification"?s.jsx("div",{className:"p-4",children:(U==null?void 0:U.id)&&s.jsx(G$,{userId:U.id,accountType:N,verified:k})}):o==="security-actions"?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ql,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Security Actions"})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your account security settings"})]}),s.jsx(Jo,{}),n&&s.jsx("div",{className:"p-3 bg-muted/50 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(MP,{className:"w-4 h-4"}),s.jsxs("span",{children:["Current email: ",s.jsx("strong",{children:n})]})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[s.jsx(MP,{className:"w-5 h-5"}),"Change Email Address"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Change your email address. You'll receive a confirmation email at the new address."}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx(Ut,{htmlFor:"new-email",children:"New Email Address"}),s.jsx(or,{id:"new-email",type:"email",placeholder:"Enter new email address",value:f,onChange:se=>p(se.target.value),disabled:u})]}),s.jsx(oe,{onClick:Z,disabled:u||!f.trim(),className:"w-full",children:u?"Sending...":"Send Email Change Confirmation"})]})]}),s.jsx(Jo,{}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[s.jsx(zJ,{className:"w-5 h-5"}),"Reset Password"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Send a password reset link to your email address."}),s.jsx(oe,{variant:"outline",onClick:K,disabled:c,className:"w-full",children:c?"Sending...":"Send Password Reset Email"})]}),s.jsx(Jo,{}),s.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(XD,{className:"w-4 h-4 text-blue-600 mt-0.5"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"About Security Emails"}),s.jsx("p",{className:"text-blue-700",children:"All security emails are sent automatically and cannot be disabled for your account protection. Check your email (including spam folder) for confirmation links."})]})]})})]}):null]})})};function Kp(){return s.jsx("div",{className:"bg-white rounded-xl p-4 border border-white/20 shadow-sm animate-pulse",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-100 to-pink-200 rounded-full flex items-center justify-center",children:s.jsx(M2,{size:"sm",className:"opacity-30 animate-breathe"})}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 bg-gradient-to-r from-pink-100 to-white rounded animate-pulse w-3/4"}),s.jsx("div",{className:"h-3 bg-gradient-to-r from-pink-50 to-white rounded animate-pulse w-1/2"}),s.jsx("div",{className:"h-3 bg-gradient-to-r from-pink-50 to-white rounded animate-pulse w-1/4"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-pink-200 to-pink-300 rounded-full animate-pulse"}),s.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-gray-100 to-white rounded-full animate-pulse"})]})]})})}const Ype=({currentUserId:e,onBack:t,onNavigateToProfile:r,onNavigateToEvent:n,onNavigateToArtist:i,onNavigateToVenue:a})=>{const[o,l]=y.useState([]),[c,d]=y.useState(!0),[u,h]=y.useState(0),{toast:f}=jr(),{sessionExpired:p}=os();y.useEffect(()=>{if(p){d(!1);return}x()},[e,p]);const x=()=>E(void 0,null,function*(){try{if(p){console.log("Session expired, skipping notifications fetch"),d(!1);return}const[A,T]=yield Promise.all([Kf.getNotifications({limit:50}),Kf.getUnreadCount()]);l(A.notifications),h(T)}catch(A){console.error("Error fetching notifications:",A),f({title:"Error",description:"Failed to load notifications. Please try again.",variant:"destructive"}),l([]),h(0)}finally{d(!1)}}),g=A=>E(void 0,null,function*(){try{yield Kf.markAsRead(A),l($=>$.map(R=>R.id===A?W(M({},R),{is_read:!0}):R));const T=yield Kf.getUnreadCount();h(T)}catch(T){console.error("Error marking notification as read:",T),f({title:"Error",description:"Failed to mark notification as read",variant:"destructive"})}}),v=()=>E(void 0,null,function*(){try{yield Kf.markAllAsRead(),yield x(),f({title:"All notifications marked as read",description:"You're all caught up!"})}catch(A){console.error("Error marking all notifications as read:",A),f({title:"Error",description:"Failed to mark all notifications as read",variant:"destructive"})}}),_=A=>E(void 0,null,function*(){var T;try{const{data:$,error:R}=yield P.from("user_relationships").select("status").eq("id",A).eq("relationship_type","friend").single();if(R){const F=R.message||"";if(R.code==="PGRST301"||R.code==="42501"||F.includes("406")||F.includes("Not Acceptable")){console.log(" RLS restriction, cannot check status directly");const{data:{user:D}}=yield P.auth.getUser();if(D){const{data:B}=yield P.from("notifications").select("data").eq("type","friend_request").eq("user_id",D.id).eq("data->>request_id",A).single();if((T=B==null?void 0:B.data)!=null&&T.sender_id){const U=B.data.sender_id,{data:V}=yield P.from("user_relationships").select("user_id, related_user_id, status").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${D.id},related_user_id.eq.${D.id}`);if(V&&V.length>0&&V.find(z=>z.user_id===D.id&&z.related_user_id===U||z.user_id===U&&z.related_user_id===D.id))return"accepted"}}return"unknown"}return console.log(" Request not found:",R),"not_found"}return($==null?void 0:$.status)||"not_found"}catch($){return console.error("Error checking friend request status:",$),"not_found"}}),w=A=>E(void 0,null,function*(){try{const{data:T,error:$}=yield P.from("notifications").select("id, data").eq("type","friend_request").eq("user_id",e);if($)throw console.error("Could not fetch notifications for deletion:",$),new Error(`Failed to fetch notifications: ${$.message}`);const R=(T==null?void 0:T.filter(B=>{var V;const U=(V=B.data)==null?void 0:V.request_id;return U==null||A==null?U===A:String(U)===String(A)}))||[];if(R.length===0){console.log("No matching notification found to delete");return}const F=R.map(B=>B.id),{error:D}=yield P.from("notifications").delete().in("id",F);if(D)throw console.error("Could not delete notification:",D),new Error(`Failed to delete notification: ${D.message}`);console.log(` Deleted ${F.length} friend request notification(s)`)}catch(T){throw console.error("Error deleting notification:",T),T}}),b=A=>E(void 0,null,function*(){var T,$,R,F;if(console.log(" Accepting friend request:",A),!A){f({title:"Error",description:"Invalid friend request. Please refresh and try again.",variant:"destructive"});return}try{const D=typeof A=="string"?A:String(A);console.log(" Converted request ID:",D);const{error:B}=yield P.rpc("accept_friend_request",{request_id:D});if(console.log(" Accept friend request result:",B),B){if(console.error("Error accepting friend request:",B),B.code==="23505"||(T=B.message)!=null&&T.includes("duplicate key")||($=B.message)!=null&&$.includes("unique constraint")){console.log(" Friendship already exists, treating as success"),l(U=>U.filter(V=>{var z;const Y=(z=V.data)==null?void 0:z.request_id;return Y==null||A==null?Y!==A:String(Y)!==String(A)}));try{yield w(A)}catch(U){console.error("Failed to delete notification, but continuing:",U)}yield new Promise(U=>setTimeout(U,500)),yield x(),f({title:"Already Friends! ",description:"You're already friends with this person."});return}if((R=B.message)!=null&&R.includes("not found")||(F=B.message)!=null&&F.includes("already processed")){const U=yield _(A);f(U==="accepted"?{title:"Already Friends! ",description:"You're already friends with this person."}:{title:"Request Already Processed",description:"This friend request has already been handled."}),l(V=>V.filter(Y=>{var K;const z=(K=Y.data)==null?void 0:K.request_id;return z==null||A==null?z!==A:String(z)!==String(A)}));try{yield w(A)}catch(V){console.error("Failed to delete notification, but continuing:",V)}yield new Promise(V=>setTimeout(V,500)),yield x();return}throw B}l(U=>U.filter(V=>{var z;const Y=(z=V.data)==null?void 0:z.request_id;return Y==null||A==null?Y!==A:String(Y)!==String(A)}));try{yield w(A)}catch(U){console.error("Failed to delete notification, but continuing:",U)}yield new Promise(U=>setTimeout(U,500)),yield x(),f({title:"Friend Request Accepted! ",description:"You're now friends!"})}catch(D){console.error("Error accepting friend request:",D),f({title:"Error",description:D.message||"Failed to accept friend request. Please try again.",variant:"destructive"})}}),N=A=>E(void 0,null,function*(){var T,$;if(console.log(" Declining friend request:",A),!A){f({title:"Error",description:"Invalid friend request. Please refresh and try again.",variant:"destructive"});return}console.log(" Debug: Declining friend request with ID:",A);try{const{error:R}=yield P.rpc("decline_friend_request",{request_id:A});if(console.log(" Decline friend request result:",R),R){if(console.error("Error declining friend request:",R),(T=R.message)!=null&&T.includes("not found")||($=R.message)!=null&&$.includes("already processed")){f({title:"Request Already Processed",description:"This friend request has already been handled.",variant:"destructive"}),l(F=>F.filter(D=>{var U;const B=(U=D.data)==null?void 0:U.request_id;return B==null||A==null?B!==A:String(B)!==String(A)}));try{yield w(A)}catch(F){console.error("Failed to delete notification, but continuing:",F)}yield new Promise(F=>setTimeout(F,500)),yield x();return}throw R}l(F=>F.filter(D=>{var U;const B=(U=D.data)==null?void 0:U.request_id;return B==null||A==null?B!==A:String(B)!==String(A)}));try{yield w(A)}catch(F){console.error("Failed to delete notification, but continuing:",F)}yield new Promise(F=>setTimeout(F,500)),yield x(),f({title:"Friend Request Declined",description:"The friend request has been declined."})}catch(R){console.error("Error declining friend request:",R),f({title:"Error",description:R.message||"Failed to decline friend request. Please try again.",variant:"destructive"})}}),S=A=>{switch(A){case"friend_request":return s.jsx(Pu,{className:"w-4 h-4"});case"event_interest":return s.jsx(hs,{className:"w-4 h-4"});case"review_like":return s.jsx(Jt,{className:"w-4 h-4"});case"review_comment":return s.jsx(Wn,{className:"w-4 h-4"});case"event_reminder":return s.jsx(Et,{className:"w-4 h-4"});default:return s.jsx(Uu,{className:"w-4 h-4"})}},k=A=>{const T=new Date(A),R=Math.floor((new Date().getTime()-T.getTime())/(1e3*60));return R<1?"Just now":R<60?`${R}m ago`:R<1440?`${Math.floor(R/60)}h ago`:`${Math.floor(R/1440)}d ago`},O=A=>E(void 0,null,function*(){if(A.type==="friend_request"){yield g(A.id);return}g(A.id);const T=A.data;switch(A.type){case"artist_new_event":case"artist_profile_updated":T!=null&&T.event_id&&n?n(T.event_id):T!=null&&T.artist_id&&i?i(T.artist_id):A.artist_name&&i&&i(A.artist_name);break;case"venue_new_event":case"venue_profile_updated":A.venue_name&&a?a(A.venue_name):T!=null&&T.venue_name&&a&&a(T.venue_name),T!=null&&T.event_id&&n&&n(T.event_id);break;case"event_interest":case"event_attendance_reminder":case"event_reminder":case"friend_rsvp_going":case"friend_rsvp_changed":case"friend_review_posted":case"friend_attended_same_event":T!=null&&T.event_id&&n?n(T.event_id):A.event_title&&console.log("Navigate to event:",A.event_title);break;case"friend_request":case"friend_accepted":T!=null&&T.sender_id&&r?r(T.sender_id):T!=null&&T.friend_id&&r?r(T.friend_id):A.actor_user_id&&r&&r(A.actor_user_id);break;case"review_liked":case"review_commented":case"comment_replied":if(T!=null&&T.event_id&&n)n(T.event_id);else if(A.review_id)try{const{data:$}=yield P.from("reviews").select("event_id").eq("id",A.review_id).single();$!=null&&$.event_id&&n&&n($.event_id)}catch($){console.error("Error fetching review event:",$)}break}});return c?s.jsx("div",{className:"min-h-screen synth-gradient-card p-4 pb-20",children:s.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[s.jsx("div",{className:"glass-card inner-glow text-center space-y-3 p-4 mb-6 floating-shadow",children:s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx(M2,{size:"md",className:"hover-icon animate-breathe"}),s.jsx("div",{className:"h-8 bg-gray-200 rounded animate-pulse w-36"})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(Kp,{}),s.jsx(Kp,{}),s.jsx(Kp,{}),s.jsx(Kp,{}),s.jsx(Kp,{})]})]})}):s.jsx("div",{className:"min-h-screen synth-gradient-card p-4 pb-20",children:s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsx("div",{className:"glass-card inner-glow text-center space-y-3 p-4 mb-6 floating-shadow",children:s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"sm",onClick:t,className:"hover-button absolute left-4",children:s.jsx(us,{className:"w-4 h-4 hover-icon"})}),s.jsx(M2,{size:"md",className:"hover-icon"}),s.jsx("h1",{className:"gradient-text text-2xl font-bold",children:"Notifications"}),u>0&&s.jsxs(Be,{variant:"default",className:"gradient-badge",children:[u," unread"]})]})}),o.length>0&&u>0&&s.jsx("div",{className:"glass-card inner-glow p-4 mb-6 floating-shadow",children:s.jsxs(oe,{variant:"outline",size:"sm",onClick:v,className:"hover-button w-full border-gray-200 hover:border-pink-400 hover:text-pink-500",children:[s.jsx(Gs,{className:"w-4 h-4 mr-2 hover-icon"}),"Mark all as read"]})}),o.length===0?s.jsx(He,{className:"glass-card inner-glow floating-shadow",children:s.jsxs(st,{className:"text-center py-12",children:[s.jsx(Uu,{className:"w-12 h-12 mx-auto mb-4 hover-icon",style:{background:"linear-gradient(135deg, #ec4899, #f472b6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}}),s.jsx("h3",{className:"text-lg font-semibold mb-2 gradient-text",children:"No notifications yet"}),s.jsx("p",{className:"text-gray-500",children:"When you get friend requests, event updates, or review activity, they'll appear here."})]})}):s.jsx("div",{className:"space-y-3",children:o.map(A=>s.jsx(He,{className:`glass-card inner-glow hover-card cursor-pointer floating-shadow ${A.is_read?"":"border-pink-300"}`,onClick:()=>O(A),children:s.jsx(st,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 hover-icon",children:Q.cloneElement(S(A.type),{style:{background:"linear-gradient(135deg, #ec4899, #f472b6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h4",{className:"font-semibold text-sm truncate gradient-text",children:A.title}),!A.is_read&&s.jsx("div",{className:"w-2 h-2 gradient-badge rounded-full flex-shrink-0"})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:A.message}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-gray-500 bg-white/30 px-2 py-1 rounded backdrop-blur-sm",children:k(A.created_at)}),A.type==="friend_request"&&s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{size:"sm",variant:"default",className:"hover-button gradient-button h-6 px-2",onClick:T=>E(void 0,null,function*(){var $;T.stopPropagation(),T.preventDefault(),yield b(($=A.data)==null?void 0:$.request_id)}),children:[s.jsx(Gs,{className:"w-3 h-3 mr-1 hover-icon"}),"Accept"]}),s.jsxs(oe,{size:"sm",variant:"outline",className:"hover-button h-6 px-2 border-gray-200 hover:border-red-400 hover:text-red-500",onClick:T=>E(void 0,null,function*(){var $;T.stopPropagation(),T.preventDefault(),yield N(($=A.data)==null?void 0:$.request_id)}),children:[s.jsx(pr,{className:"w-3 h-3 mr-1 hover-icon"}),"Decline"]})]})]})]})]})})},A.id))})]})})};class Wy{static createEvent(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield P.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{MissingEntityRequestService:i}=yield on(()=>E(this,null,function*(){const{MissingEntityRequestService:o}=yield import("./missingEntityRequestService-DTKxUBjt.js");return{MissingEntityRequestService:o}}),[],import.meta.url);return{id:(yield i.submitRequest({entity_type:"event",entity_name:t.title,entity_description:t.artist_name&&t.venue_name?`${t.artist_name} at ${t.venue_name}`:void 0,entity_date:t.event_date,entity_location:t.venue_name,entity_image_url:t.poster_image_url,additional_info:{artist_name:t.artist_name,venue_name:t.venue_name,latitude:t.latitude,longitude:t.longitude,video_url:t.video_url,age_restriction:t.age_restriction,accessibility_info:t.accessibility_info,parking_info:t.parking_info,venue_capacity:t.venue_capacity,estimated_attendance:t.estimated_attendance,media_urls:t.media_urls}})).id,title:t.title,status:"pending",message:"Your event request has been submitted for review."}}catch(r){throw console.error("Error submitting event request:",r),r}})}static getMyCreatedEvents(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield P.auth.getUser();if(r||!t)throw new Error("User not authenticated");const{data:n,error:i}=yield P.from("events").select("*").eq("created_by_user_id",t.id).order("created_at",{ascending:!1});if(i)throw i;return n||[]}catch(t){throw console.error("Error fetching created events:",t),t}})}static updateEvent(t,r){return E(this,null,function*(){try{const{data:{user:n},error:i}=yield P.auth.getUser();if(i||!n)throw new Error("User not authenticated");const{data:a,error:o}=yield P.from("events").select("created_by_user_id").eq("id",t).single();if(o)throw o;if(a.created_by_user_id!==n.id)throw new Error("You can only update events you created");const{data:l,error:c}=yield P.from("events").update(W(M({},r),{updated_at:new Date().toISOString()})).eq("id",t).select().single();if(c)throw c;return l}catch(n){throw console.error("Error updating event:",n),n}})}static deleteEvent(t){return E(this,null,function*(){try{const{data:{user:r},error:n}=yield P.auth.getUser();if(n||!r)throw new Error("User not authenticated");const{data:i,error:a}=yield P.from("events").select("created_by_user_id").eq("id",t).single();if(a)throw a;if(i.created_by_user_id!==r.id)throw new Error("You can only delete events you created");const{error:o}=yield P.from("events").delete().eq("id",t);if(o)throw o}catch(r){throw console.error("Error deleting event:",r),r}})}static canCreateEvents(){return E(this,null,function*(){try{const{data:{user:t},error:r}=yield P.auth.getUser();if(r||!t)return!1;const{data:n,error:i}=yield P.from("users").select("account_type").eq("user_id",t.id).single();return i?!1:["business","creator","admin"].includes(n.account_type)}catch(t){return console.error("Error checking create permissions:",t),!1}})}}function Kpe({open:e,onClose:t,onEventCreated:r,prefilledData:n}){const[i,a]=y.useState(!1),[o,l]=y.useState(M({title:"",artist_name:"",venue_name:"",event_date:"",latitude:void 0,longitude:void 0,poster_image_url:"",video_url:"",age_restriction:"",accessibility_info:"",parking_info:"",venue_capacity:void 0,estimated_attendance:void 0,media_urls:[]},n)),{toast:c}=jr(),d=(f,p)=>{l(x=>W(M({},x),{[f]:p}))},u=f=>E(this,null,function*(){if(f.preventDefault(),!o.title.trim()){c({title:"Title required",description:"Please enter an event title.",variant:"destructive"});return}a(!0);try{const p=yield Wy.createEvent(o);c({title:"Event created!",description:"Your event has been created successfully."}),r==null||r(p),h()}catch(p){console.error("Error creating event:",p),c({title:"Creation failed",description:p instanceof Error?p.message:"Failed to create event",variant:"destructive"})}finally{a(!1)}}),h=()=>{i||(l(M({title:"",artist_name:"",venue_name:"",event_date:"",latitude:void 0,longitude:void 0,poster_image_url:"",video_url:"",age_restriction:"",accessibility_info:"",parking_info:"",venue_capacity:void 0,estimated_attendance:void 0,media_urls:[]},n)),t())};return s.jsx(tn,{open:e,onOpenChange:h,children:s.jsxs(Xr,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[s.jsxs(Mn,{children:[s.jsxs(an,{className:"flex items-center gap-2",children:[s.jsx(Et,{className:"h-5 w-5 text-purple-600"}),"Create New Event"]}),s.jsx(Kn,{children:"Create a new event for your audience. Fill in the details below."})]}),s.jsxs("form",{onSubmit:u,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(Ct,{className:"h-5 w-5"}),"Basic Information"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"title",children:"Event Title *"}),s.jsx(or,{id:"title",value:o.title,onChange:f=>d("title",f.target.value),placeholder:"e.g., Summer Music Festival 2024",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"artist_name",children:"Artist/Performer"}),s.jsx(or,{id:"artist_name",value:o.artist_name||"",onChange:f=>d("artist_name",f.target.value),placeholder:"e.g., The Rolling Stones"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"venue_name",children:"Venue"}),s.jsx(or,{id:"venue_name",value:o.venue_name||"",onChange:f=>d("venue_name",f.target.value),placeholder:"e.g., Madison Square Garden"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"event_date",children:"Event Date & Time"}),s.jsx(or,{id:"event_date",type:"datetime-local",value:o.event_date||"",onChange:f=>d("event_date",f.target.value)})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(Xt,{className:"h-5 w-5"}),"Location Details"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"latitude",children:"Latitude"}),s.jsx(or,{id:"latitude",type:"number",step:"any",value:o.latitude||"",onChange:f=>d("latitude",f.target.value?parseFloat(f.target.value):void 0),placeholder:"40.7128"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"longitude",children:"Longitude"}),s.jsx(or,{id:"longitude",type:"number",step:"any",value:o.longitude||"",onChange:f=>d("longitude",f.target.value?parseFloat(f.target.value):void 0),placeholder:"-74.0060"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(Ar,{className:"h-5 w-5"}),"Additional Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"venue_capacity",children:"Venue Capacity"}),s.jsx(or,{id:"venue_capacity",type:"number",value:o.venue_capacity||"",onChange:f=>d("venue_capacity",f.target.value?parseInt(f.target.value):void 0),placeholder:"5000"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"estimated_attendance",children:"Estimated Attendance"}),s.jsx(or,{id:"estimated_attendance",type:"number",value:o.estimated_attendance||"",onChange:f=>d("estimated_attendance",f.target.value?parseInt(f.target.value):void 0),placeholder:"3000"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"age_restriction",children:"Age Restriction"}),s.jsx(or,{id:"age_restriction",value:o.age_restriction||"",onChange:f=>d("age_restriction",f.target.value),placeholder:"e.g., 18+, All Ages, 21+"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"accessibility_info",children:"Accessibility Information"}),s.jsx(as,{id:"accessibility_info",value:o.accessibility_info||"",onChange:f=>d("accessibility_info",f.target.value),placeholder:"Information about accessibility features...",rows:3})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"parking_info",children:"Parking Information"}),s.jsx(as,{id:"parking_info",value:o.parking_info||"",onChange:f=>d("parking_info",f.target.value),placeholder:"Information about parking options...",rows:3})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(Ct,{className:"h-5 w-5"}),"Media"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"poster_image_url",children:"Poster Image URL"}),s.jsx(or,{id:"poster_image_url",value:o.poster_image_url||"",onChange:f=>d("poster_image_url",f.target.value),placeholder:"https://example.com/poster.jpg"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"video_url",children:"Video URL"}),s.jsx(or,{id:"video_url",value:o.video_url||"",onChange:f=>d("video_url",f.target.value),placeholder:"https://youtube.com/watch?v=..."})]})]})]}),s.jsxs(ff,{children:[s.jsx(oe,{type:"button",variant:"outline",onClick:h,disabled:i,children:"Cancel"}),s.jsx(oe,{type:"submit",onClick:u,disabled:i,className:"bg-purple-600 hover:bg-purple-700",children:i?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Et,{className:"w-4 h-4 mr-2"}),"Create Event"]})})]})]})})}function Zpe(){Wu();const{toast:e}=jr(),[t,r]=y.useState([]),[n,i]=y.useState(!0),[a,o]=y.useState(!1),[l,c]=y.useState(!1);Wu(),y.useEffect(()=>{d(),u()},[]);const d=()=>E(this,null,function*(){try{i(!0);const v=yield Wy.getMyCreatedEvents();r(v)}catch(v){console.error("Error loading events:",v),e({title:"Error loading events",description:"Failed to load your created events.",variant:"destructive"})}finally{i(!1)}}),u=()=>E(this,null,function*(){try{const v=yield Wy.canCreateEvents();c(v)}catch(v){console.error("Error checking permissions:",v),c(!1)}}),h=v=>{r(_=>[v,..._])},f=v=>E(this,null,function*(){if(confirm("Are you sure you want to delete this event? This action cannot be undone."))try{yield Wy.deleteEvent(v),r(_=>_.filter(w=>w.id!==v)),e({title:"Event deleted",description:"The event has been deleted successfully."})}catch(_){console.error("Error deleting event:",_),e({title:"Delete failed",description:_ instanceof Error?_.message:"Failed to delete event",variant:"destructive"})}}),p=v=>new Date(v).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),x=v=>new Date(v).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),g=({event:v})=>s.jsxs(He,{className:"hover:shadow-lg transition-shadow",children:[s.jsx(xr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx(Cr,{className:"text-lg mb-2",children:v.title}),v.artist_name&&s.jsx("p",{className:"text-purple-600 font-medium mb-1",children:v.artist_name}),v.venue_name&&s.jsxs("div",{className:"flex items-center gap-1 text-gray-600 text-sm",children:[s.jsx(Xt,{className:"h-4 w-4"}),s.jsx("span",{children:v.venue_name})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>{e({title:"Edit Event",description:"Event editing features coming soon!"})},children:s.jsx(Cu,{className:"h-4 w-4"})}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>f(v.id),className:"text-red-600 hover:text-red-700 hover:border-red-300",children:s.jsx(yc,{className:"h-4 w-4"})})]})]})}),s.jsx(st,{className:"pt-0",children:s.jsxs("div",{className:"space-y-2",children:[v.event_date&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Et,{className:"h-4 w-4"}),s.jsx("span",{children:p(v.event_date)}),s.jsx(ai,{className:"h-4 w-4 ml-2"}),s.jsx("span",{children:x(v.event_date)})]}),(v.venue_capacity||v.estimated_attendance)&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Ar,{className:"h-4 w-4"}),v.venue_capacity&&s.jsxs("span",{children:["Capacity: ",v.venue_capacity.toLocaleString()]}),v.venue_capacity&&v.estimated_attendance&&s.jsx("span",{children:""}),v.estimated_attendance&&s.jsxs("span",{children:["Est. Attendance: ",v.estimated_attendance.toLocaleString()]})]}),v.age_restriction&&s.jsx(Be,{variant:"outline",className:"text-xs",children:v.age_restriction})]})})]});return l?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Events"}),s.jsx("p",{className:"text-gray-600",children:"Manage your created events"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"outline",onClick:d,disabled:n,children:[s.jsx(Sa,{className:`h-4 w-4 mr-2 ${n?"animate-spin":""}`}),"Refresh"]}),s.jsxs(oe,{onClick:()=>o(!0),children:[s.jsx(eo,{className:"h-4 w-4 mr-2"}),"Create Event"]})]})]})}),n?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(er,{className:"h-8 w-8 animate-spin text-purple-600"})}):s.jsx("div",{className:"space-y-4",children:t.length===0?s.jsx(He,{children:s.jsxs(st,{className:"py-12 text-center",children:[s.jsx(Et,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"You haven't created any events yet"}),s.jsxs(oe,{onClick:()=>o(!0),children:[s.jsx(eo,{className:"h-4 w-4 mr-2"}),"Create Your First Event"]})]})}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(Et,{className:"h-5 w-5"}),"Created Events (",t.length,")"]})}),s.jsx("div",{className:"space-y-3",children:t.map(v=>s.jsx(g,{event:v},v.id))})]})}),s.jsx(Kpe,{open:a,onClose:()=>o(!1),onEventCreated:h})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsx("div",{className:"max-w-4xl mx-auto",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"My Events"}),s.jsx("p",{className:"text-gray-600 mb-8",children:"Only business, creator, and admin accounts can create events."}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-blue-900 mb-2",children:"What you can do:"}),s.jsxs("ul",{className:"text-blue-800 space-y-1",children:[s.jsx("li",{children:" Express interest in events"}),s.jsx("li",{children:" Meet people going to the same events"}),s.jsx("li",{children:" Chat with matched users"}),s.jsx("li",{children:" Leave reviews and ratings"})]})]})]})})})}const Xpe=qm("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),_4=y.forwardRef((i,n)=>{var a=i,{className:e,variant:t}=a,r=me(a,["className","variant"]);return s.jsx("div",M({ref:n,role:"alert",className:ke(Xpe({variant:t}),e)},r))});_4.displayName="Alert";const Jpe=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx("h5",M({ref:r,className:ke("mb-1 font-medium leading-none tracking-tight",e)},t))});Jpe.displayName="AlertTitle";const w4=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx("div",M({ref:r,className:ke("text-sm [&_p]:leading-relaxed",e)},t))});w4.displayName="AlertDescription";const yA="onboarding_reminder_dismissed",Qpe=3*24*60*60*1e3,e0e=({onComplete:e})=>{const[t,r]=y.useState(!1);y.useEffect(()=>{const a=localStorage.getItem(yA);if(a){const o=parseInt(a,10);if(Date.now()-o<Qpe)return}r(!0)},[]);const n=()=>{localStorage.setItem(yA,Date.now().toString()),r(!1)},i=()=>{r(!1),e()};return t?s.jsx(_4,{className:"rounded-none border-x-0 border-t-0 bg-gradient-to-r from-primary/10 to-accent/10",children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs(w4,{className:"flex-1 text-sm",children:[s.jsx("strong",{className:"font-semibold",children:"Complete your profile"})," to get personalized event recommendations and connect with people who share your music taste."]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(oe,{size:"sm",onClick:i,children:"Complete Profile"}),s.jsxs(oe,{size:"sm",variant:"ghost",onClick:n,className:"h-8 w-8 p-0",children:[s.jsx(pr,{className:"w-4 h-4"}),s.jsx("span",{className:"sr-only",children:"Dismiss"})]})]})]})}):null};function Fz(e){return t=>typeof t===e}var t0e=Fz("function"),r0e=e=>e===null,_A=e=>Object.prototype.toString.call(e).slice(8,-1)==="RegExp",wA=e=>!n0e(e)&&!r0e(e)&&(t0e(e)||typeof e=="object"),n0e=Fz("undefined");function s0e(e,t){const{length:r}=e;if(r!==t.length)return!1;for(let n=r;n--!==0;)if(!Ti(e[n],t[n]))return!1;return!0}function i0e(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new DataView(e.buffer),n=new DataView(t.buffer);let i=e.byteLength;for(;i--;)if(r.getUint8(i)!==n.getUint8(i))return!1;return!0}function a0e(e,t){if(e.size!==t.size)return!1;for(const r of e.entries())if(!t.has(r[0]))return!1;for(const r of e.entries())if(!Ti(r[1],t.get(r[0])))return!1;return!0}function o0e(e,t){if(e.size!==t.size)return!1;for(const r of e.entries())if(!t.has(r[0]))return!1;return!0}function Ti(e,t){if(e===t)return!0;if(e&&wA(e)&&t&&wA(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return s0e(e,t);if(e instanceof Map&&t instanceof Map)return a0e(e,t);if(e instanceof Set&&t instanceof Set)return o0e(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return i0e(e,t);if(_A(e)&&_A(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let i=r.length;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;for(let i=r.length;i--!==0;){const a=r[i];if(!(a==="_owner"&&e.$$typeof)&&!Ti(e[a],t[a]))return!1}return!0}return Number.isNaN(e)&&Number.isNaN(t)?!0:e===t}var l0e=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],c0e=["bigint","boolean","null","number","string","symbol","undefined"];function w1(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(/HTML\w+Element/.test(t))return"HTMLElement";if(d0e(t))return t}function Bo(e){return t=>w1(t)===e}function d0e(e){return l0e.includes(e)}function np(e){return t=>typeof t===e}function u0e(e){return c0e.includes(e)}var f0e=["innerHTML","ownerDocument","style","attributes","nodeValue"];function Ft(e){if(e===null)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(Ft.array(e))return"Array";if(Ft.plainFunction(e))return"Function";const t=w1(e);return t||"Object"}Ft.array=Array.isArray;Ft.arrayOf=(e,t)=>!Ft.array(e)&&!Ft.function(t)?!1:e.every(r=>t(r));Ft.asyncGeneratorFunction=e=>w1(e)==="AsyncGeneratorFunction";Ft.asyncFunction=Bo("AsyncFunction");Ft.bigint=np("bigint");Ft.boolean=e=>e===!0||e===!1;Ft.date=Bo("Date");Ft.defined=e=>!Ft.undefined(e);Ft.domElement=e=>Ft.object(e)&&!Ft.plainObject(e)&&e.nodeType===1&&Ft.string(e.nodeName)&&f0e.every(t=>t in e);Ft.empty=e=>Ft.string(e)&&e.length===0||Ft.array(e)&&e.length===0||Ft.object(e)&&!Ft.map(e)&&!Ft.set(e)&&Object.keys(e).length===0||Ft.set(e)&&e.size===0||Ft.map(e)&&e.size===0;Ft.error=Bo("Error");Ft.function=np("function");Ft.generator=e=>Ft.iterable(e)&&Ft.function(e.next)&&Ft.function(e.throw);Ft.generatorFunction=Bo("GeneratorFunction");Ft.instanceOf=(e,t)=>!e||!t?!1:Object.getPrototypeOf(e)===t.prototype;Ft.iterable=e=>!Ft.nullOrUndefined(e)&&Ft.function(e[Symbol.iterator]);Ft.map=Bo("Map");Ft.nan=e=>Number.isNaN(e);Ft.null=e=>e===null;Ft.nullOrUndefined=e=>Ft.null(e)||Ft.undefined(e);Ft.number=e=>np("number")(e)&&!Ft.nan(e);Ft.numericString=e=>Ft.string(e)&&e.length>0&&!Number.isNaN(Number(e));Ft.object=e=>!Ft.nullOrUndefined(e)&&(Ft.function(e)||typeof e=="object");Ft.oneOf=(e,t)=>Ft.array(e)?e.indexOf(t)>-1:!1;Ft.plainFunction=Bo("Function");Ft.plainObject=e=>{if(w1(e)!=="Object")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.getPrototypeOf({})};Ft.primitive=e=>Ft.null(e)||u0e(typeof e);Ft.promise=Bo("Promise");Ft.propertyOf=(e,t,r)=>{if(!Ft.object(e)||!t)return!1;const n=e[t];return Ft.function(r)?r(n):Ft.defined(n)};Ft.regexp=Bo("RegExp");Ft.set=Bo("Set");Ft.string=np("string");Ft.symbol=np("symbol");Ft.undefined=np("undefined");Ft.weakMap=Bo("WeakMap");Ft.weakSet=Bo("WeakSet");var Wt=Ft;function h0e(...e){return e.every(t=>Wt.string(t)||Wt.array(t)||Wt.plainObject(t))}function m0e(e,t,r){return Uz(e,t)?[e,t].every(Wt.array)?!e.some(kA(r))&&t.some(kA(r)):[e,t].every(Wt.plainObject)?!Object.entries(e).some(SA(r))&&Object.entries(t).some(SA(r)):t===r:!1}function bA(e,t,r){const{actual:n,key:i,previous:a,type:o}=r,l=fl(e,i),c=fl(t,i);let d=[l,c].every(Wt.number)&&(o==="increased"?l<c:l>c);return Wt.undefined(n)||(d=d&&c===n),Wt.undefined(a)||(d=d&&l===a),d}function jA(e,t,r){const{key:n,type:i,value:a}=r,o=fl(e,n),l=fl(t,n),c=i==="added"?o:l,d=i==="added"?l:o;if(!Wt.nullOrUndefined(a)){if(Wt.defined(c)){if(Wt.array(c)||Wt.plainObject(c))return m0e(c,d,a)}else return Ti(d,a);return!1}return[o,l].every(Wt.array)?!d.every(b4(c)):[o,l].every(Wt.plainObject)?p0e(Object.keys(c),Object.keys(d)):![o,l].every(u=>Wt.primitive(u)&&Wt.defined(u))&&(i==="added"?!Wt.defined(o)&&Wt.defined(l):Wt.defined(o)&&!Wt.defined(l))}function NA(e,t,{key:r}={}){let n=fl(e,r),i=fl(t,r);if(!Uz(n,i))throw new TypeError("Inputs have different types");if(!h0e(n,i))throw new TypeError("Inputs don't have length");return[n,i].every(Wt.plainObject)&&(n=Object.keys(n),i=Object.keys(i)),[n,i]}function SA(e){return([t,r])=>Wt.array(e)?Ti(e,r)||e.some(n=>Ti(n,r)||Wt.array(r)&&b4(r)(n)):Wt.plainObject(e)&&e[t]?!!e[t]&&Ti(e[t],r):Ti(e,r)}function p0e(e,t){return t.some(r=>!e.includes(r))}function kA(e){return t=>Wt.array(e)?e.some(r=>Ti(r,t)||Wt.array(t)&&b4(t)(r)):Ti(e,t)}function Zp(e,t){return Wt.array(e)?e.some(r=>Ti(r,t)):Ti(e,t)}function b4(e){return t=>e.some(r=>Ti(r,t))}function Uz(...e){return e.every(Wt.array)||e.every(Wt.number)||e.every(Wt.plainObject)||e.every(Wt.string)}function fl(e,t){return Wt.plainObject(e)||Wt.array(e)?Wt.string(t)?t.split(".").reduce((n,i)=>n&&n[i],e):Wt.number(t)?e[t]:e:e}function G2(e,t){if([e,t].some(Wt.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every(u=>Wt.plainObject(u)||Wt.array(u)))throw new Error("Expected plain objects or array");return{added:(u,h)=>{try{return jA(e,t,{key:u,type:"added",value:h})}catch(f){return!1}},changed:(u,h,f)=>{try{const p=fl(e,u),x=fl(t,u),g=Wt.defined(h),v=Wt.defined(f);if(g||v){const _=v?Zp(f,p):!Zp(h,p),w=Zp(h,x);return _&&w}return[p,x].every(Wt.array)||[p,x].every(Wt.plainObject)?!Ti(p,x):p!==x}catch(p){return!1}},changedFrom:(u,h,f)=>{if(!Wt.defined(u))return!1;try{const p=fl(e,u),x=fl(t,u),g=Wt.defined(f);return Zp(h,p)&&(g?Zp(f,x):!g)}catch(p){return!1}},decreased:(u,h,f)=>{if(!Wt.defined(u))return!1;try{return bA(e,t,{key:u,actual:h,previous:f,type:"decreased"})}catch(p){return!1}},emptied:u=>{try{const[h,f]=NA(e,t,{key:u});return!!h.length&&!f.length}catch(h){return!1}},filled:u=>{try{const[h,f]=NA(e,t,{key:u});return!h.length&&!!f.length}catch(h){return!1}},increased:(u,h,f)=>{if(!Wt.defined(u))return!1;try{return bA(e,t,{key:u,actual:h,previous:f,type:"increased"})}catch(p){return!1}},removed:(u,h)=>{try{return jA(e,t,{key:u,type:"removed",value:h})}catch(f){return!1}}}}var g0e=new Error("Element already at target scroll position"),v0e=new Error("Scroll cancelled"),x0e=Math.min,EA=Date.now,y0e={left:CA("scrollLeft"),top:CA("scrollTop")};function CA(e){return function(r,n,i,a){i=i||{},typeof i=="function"&&(a=i,i={}),typeof a!="function"&&(a=w0e);var o=EA(),l=r[e],c=i.ease||_0e,d=isNaN(i.duration)?350:+i.duration,u=!1;return l===n?a(g0e,r[e]):requestAnimationFrame(f),h;function h(){u=!0}function f(p){if(u)return a(v0e,r[e]);var x=EA(),g=x0e(1,(x-o)/d),v=c(g);r[e]=v*(n-l)+l,g<1?requestAnimationFrame(f):requestAnimationFrame(function(){a(null,r[e])})}}}function _0e(e){return .5*(1-Math.cos(Math.PI*e))}function w0e(){}const b0e=rn(y0e);var Bz={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.Scrollparent=r()})(Ks,function(){function t(n){var i=getComputedStyle(n,null).getPropertyValue("overflow");return i.indexOf("scroll")>-1||i.indexOf("auto")>-1}function r(n){if(n instanceof HTMLElement||n instanceof SVGElement){for(var i=n.parentNode;i.parentNode;){if(t(i))return i;i=i.parentNode}return document.scrollingElement||document.documentElement}}return r})})(Bz);var j0e=Bz.exports;const zz=rn(j0e);var N0e=function(e){return Object.prototype.hasOwnProperty.call(e,"props")},S0e=function(e,t){return e+kg(t)},kg=function(e){return e===null||typeof e=="boolean"||typeof e=="undefined"?"":typeof e=="number"?e.toString():typeof e=="string"?e:Array.isArray(e)?e.reduce(S0e,""):N0e(e)&&Object.prototype.hasOwnProperty.call(e.props,"children")?kg(e.props.children):""};kg.default=kg;var k0e=kg;const PA=rn(k0e);var E0e=function(t){return C0e(t)&&!P0e(t)};function C0e(e){return!!e&&typeof e=="object"}function P0e(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||O0e(e)}var A0e=typeof Symbol=="function"&&Symbol.for,T0e=A0e?Symbol.for("react.element"):60103;function O0e(e){return e.$$typeof===T0e}function R0e(e){return Array.isArray(e)?[]:{}}function Eg(e,t){return t.clone!==!1&&t.isMergeableObject(e)?lm(R0e(e),e,t):e}function M0e(e,t,r){return e.concat(t).map(function(n){return Eg(n,r)})}function D0e(e,t){if(!t.customMerge)return lm;var r=t.customMerge(e);return typeof r=="function"?r:lm}function I0e(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}function AA(e){return Object.keys(e).concat(I0e(e))}function Vz(e,t){try{return t in e}catch(r){return!1}}function $0e(e,t){return Vz(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function L0e(e,t,r){var n={};return r.isMergeableObject(e)&&AA(e).forEach(function(i){n[i]=Eg(e[i],r)}),AA(t).forEach(function(i){$0e(e,i)||(Vz(e,i)&&r.isMergeableObject(t[i])?n[i]=D0e(i,r)(e[i],t[i],r):n[i]=Eg(t[i],r))}),n}function lm(e,t,r){r=r||{},r.arrayMerge=r.arrayMerge||M0e,r.isMergeableObject=r.isMergeableObject||E0e,r.cloneUnlessOtherwiseSpecified=Eg;var n=Array.isArray(t),i=Array.isArray(e),a=n===i;return a?n?r.arrayMerge(e,t,r):L0e(e,t,r):Eg(t,r)}lm.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(n,i){return lm(n,i,r)},{})};var F0e=lm,U0e=F0e;const Po=rn(U0e);var qz={exports:{}},B0e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",z0e=B0e,V0e=z0e;function Wz(){}function Hz(){}Hz.resetWarningCache=Wz;var q0e=function(){function e(n,i,a,o,l,c){if(c!==V0e){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Hz,resetWarningCache:Wz};return r.PropTypes=r,r};qz.exports=q0e();var W0e=qz.exports;const at=rn(W0e);/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.16.1
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Fv=typeof window!="undefined"&&typeof document!="undefined"&&typeof navigator!="undefined",H0e=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(Fv&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}();function G0e(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then(function(){t=!1,e()}))}}function Y0e(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},H0e))}}var K0e=Fv&&window.Promise,Z0e=K0e?G0e:Y0e;function Gz(e){var t={};return e&&t.toString.call(e)==="[object Function]"}function gf(e,t){if(e.nodeType!==1)return[];var r=e.ownerDocument.defaultView,n=r.getComputedStyle(e,null);return t?n[t]:n}function j4(e){return e.nodeName==="HTML"?e:e.parentNode||e.host}function Uv(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=gf(e),r=t.overflow,n=t.overflowX,i=t.overflowY;return/(auto|scroll|overlay)/.test(r+i+n)?e:Uv(j4(e))}function Yz(e){return e&&e.referenceNode?e.referenceNode:e}var TA=Fv&&!!(window.MSInputMethodContext&&document.documentMode),OA=Fv&&/MSIE 10/.test(navigator.userAgent);function sp(e){return e===11?TA:e===10?OA:TA||OA}function cm(e){if(!e)return document.documentElement;for(var t=sp(10)?document.body:null,r=e.offsetParent||null;r===t&&e.nextElementSibling;)r=(e=e.nextElementSibling).offsetParent;var n=r&&r.nodeName;return!n||n==="BODY"||n==="HTML"?e?e.ownerDocument.documentElement:document.documentElement:["TH","TD","TABLE"].indexOf(r.nodeName)!==-1&&gf(r,"position")==="static"?cm(r):r}function X0e(e){var t=e.nodeName;return t==="BODY"?!1:t==="HTML"||cm(e.firstElementChild)===e}function cS(e){return e.parentNode!==null?cS(e.parentNode):e}function Y2(e,t){if(!e||!e.nodeType||!t||!t.nodeType)return document.documentElement;var r=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,n=r?e:t,i=r?t:e,a=document.createRange();a.setStart(n,0),a.setEnd(i,0);var o=a.commonAncestorContainer;if(e!==o&&t!==o||n.contains(i))return X0e(o)?o:cm(o);var l=cS(e);return l.host?Y2(l.host,t):Y2(e,cS(t).host)}function dm(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top",r=t==="top"?"scrollTop":"scrollLeft",n=e.nodeName;if(n==="BODY"||n==="HTML"){var i=e.ownerDocument.documentElement,a=e.ownerDocument.scrollingElement||i;return a[r]}return e[r]}function J0e(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=dm(t,"top"),i=dm(t,"left"),a=r?-1:1;return e.top+=n*a,e.bottom+=n*a,e.left+=i*a,e.right+=i*a,e}function RA(e,t){var r=t==="x"?"Left":"Top",n=r==="Left"?"Right":"Bottom";return parseFloat(e["border"+r+"Width"])+parseFloat(e["border"+n+"Width"])}function MA(e,t,r,n){return Math.max(t["offset"+e],t["scroll"+e],r["client"+e],r["offset"+e],r["scroll"+e],sp(10)?parseInt(r["offset"+e])+parseInt(n["margin"+(e==="Height"?"Top":"Left")])+parseInt(n["margin"+(e==="Height"?"Bottom":"Right")]):0)}function Kz(e){var t=e.body,r=e.documentElement,n=sp(10)&&getComputedStyle(r);return{height:MA("Height",t,r,n),width:MA("Width",t,r,n)}}var Q0e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},ege=function(){function e(t,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),um=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},qa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function Cd(e){return qa({},e,{right:e.left+e.width,bottom:e.top+e.height})}function dS(e){var t={};try{if(sp(10)){t=e.getBoundingClientRect();var r=dm(e,"top"),n=dm(e,"left");t.top+=r,t.left+=n,t.bottom+=r,t.right+=n}else t=e.getBoundingClientRect()}catch(h){}var i={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},a=e.nodeName==="HTML"?Kz(e.ownerDocument):{},o=a.width||e.clientWidth||i.width,l=a.height||e.clientHeight||i.height,c=e.offsetWidth-o,d=e.offsetHeight-l;if(c||d){var u=gf(e);c-=RA(u,"x"),d-=RA(u,"y"),i.width-=c,i.height-=d}return Cd(i)}function N4(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=sp(10),i=t.nodeName==="HTML",a=dS(e),o=dS(t),l=Uv(e),c=gf(t),d=parseFloat(c.borderTopWidth),u=parseFloat(c.borderLeftWidth);r&&i&&(o.top=Math.max(o.top,0),o.left=Math.max(o.left,0));var h=Cd({top:a.top-o.top-d,left:a.left-o.left-u,width:a.width,height:a.height});if(h.marginTop=0,h.marginLeft=0,!n&&i){var f=parseFloat(c.marginTop),p=parseFloat(c.marginLeft);h.top-=d-f,h.bottom-=d-f,h.left-=u-p,h.right-=u-p,h.marginTop=f,h.marginLeft=p}return(n&&!r?t.contains(l):t===l&&l.nodeName!=="BODY")&&(h=J0e(h,t)),h}function tge(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=e.ownerDocument.documentElement,n=N4(e,r),i=Math.max(r.clientWidth,window.innerWidth||0),a=Math.max(r.clientHeight,window.innerHeight||0),o=t?0:dm(r),l=t?0:dm(r,"left"),c={top:o-n.top+n.marginTop,left:l-n.left+n.marginLeft,width:i,height:a};return Cd(c)}function Zz(e){var t=e.nodeName;if(t==="BODY"||t==="HTML")return!1;if(gf(e,"position")==="fixed")return!0;var r=j4(e);return r?Zz(r):!1}function Xz(e){if(!e||!e.parentElement||sp())return document.documentElement;for(var t=e.parentElement;t&&gf(t,"transform")==="none";)t=t.parentElement;return t||document.documentElement}function S4(e,t,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,a={top:0,left:0},o=i?Xz(e):Y2(e,Yz(t));if(n==="viewport")a=tge(o,i);else{var l=void 0;n==="scrollParent"?(l=Uv(j4(t)),l.nodeName==="BODY"&&(l=e.ownerDocument.documentElement)):n==="window"?l=e.ownerDocument.documentElement:l=n;var c=N4(l,o,i);if(l.nodeName==="HTML"&&!Zz(o)){var d=Kz(e.ownerDocument),u=d.height,h=d.width;a.top+=c.top-c.marginTop,a.bottom=u+c.top,a.left+=c.left-c.marginLeft,a.right=h+c.left}else a=c}r=r||0;var f=typeof r=="number";return a.left+=f?r:r.left||0,a.top+=f?r:r.top||0,a.right-=f?r:r.right||0,a.bottom-=f?r:r.bottom||0,a}function rge(e){var t=e.width,r=e.height;return t*r}function Jz(e,t,r,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(e.indexOf("auto")===-1)return e;var o=S4(r,n,a,i),l={top:{width:o.width,height:t.top-o.top},right:{width:o.right-t.right,height:o.height},bottom:{width:o.width,height:o.bottom-t.bottom},left:{width:t.left-o.left,height:o.height}},c=Object.keys(l).map(function(f){return qa({key:f},l[f],{area:rge(l[f])})}).sort(function(f,p){return p.area-f.area}),d=c.filter(function(f){var p=f.width,x=f.height;return p>=r.clientWidth&&x>=r.clientHeight}),u=d.length>0?d[0].key:c[0].key,h=e.split("-")[1];return u+(h?"-"+h:"")}function Qz(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=n?Xz(t):Y2(t,Yz(r));return N4(r,i,n)}function eV(e){var t=e.ownerDocument.defaultView,r=t.getComputedStyle(e),n=parseFloat(r.marginTop||0)+parseFloat(r.marginBottom||0),i=parseFloat(r.marginLeft||0)+parseFloat(r.marginRight||0),a={width:e.offsetWidth+i,height:e.offsetHeight+n};return a}function K2(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,function(r){return t[r]})}function tV(e,t,r){r=r.split("-")[0];var n=eV(e),i={width:n.width,height:n.height},a=["right","left"].indexOf(r)!==-1,o=a?"top":"left",l=a?"left":"top",c=a?"height":"width",d=a?"width":"height";return i[o]=t[o]+t[c]/2-n[c]/2,r===l?i[l]=t[l]-n[d]:i[l]=t[K2(l)],i}function Bv(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function nge(e,t,r){if(Array.prototype.findIndex)return e.findIndex(function(i){return i[t]===r});var n=Bv(e,function(i){return i[t]===r});return e.indexOf(n)}function rV(e,t,r){var n=r===void 0?e:e.slice(0,nge(e,"name",r));return n.forEach(function(i){i.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var a=i.function||i.fn;i.enabled&&Gz(a)&&(t.offsets.popper=Cd(t.offsets.popper),t.offsets.reference=Cd(t.offsets.reference),t=a(t,i))}),t}function sge(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=Qz(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=Jz(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=tV(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=rV(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function nV(e,t){return e.some(function(r){var n=r.name,i=r.enabled;return i&&n===t})}function k4(e){for(var t=[!1,"ms","Webkit","Moz","O"],r=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<t.length;n++){var i=t[n],a=i?""+i+r:e;if(typeof document.body.style[a]!="undefined")return a}return null}function ige(){return this.state.isDestroyed=!0,nV(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[k4("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function sV(e){var t=e.ownerDocument;return t?t.defaultView:window}function iV(e,t,r,n){var i=e.nodeName==="BODY",a=i?e.ownerDocument.defaultView:e;a.addEventListener(t,r,{passive:!0}),i||iV(Uv(a.parentNode),t,r,n),n.push(a)}function age(e,t,r,n){r.updateBound=n,sV(e).addEventListener("resize",r.updateBound,{passive:!0});var i=Uv(e);return iV(i,"scroll",r.updateBound,r.scrollParents),r.scrollElement=i,r.eventsEnabled=!0,r}function oge(){this.state.eventsEnabled||(this.state=age(this.reference,this.options,this.state,this.scheduleUpdate))}function lge(e,t){return sV(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach(function(r){r.removeEventListener("scroll",t.updateBound)}),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t}function cge(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=lge(this.reference,this.state))}function E4(e){return e!==""&&!isNaN(parseFloat(e))&&isFinite(e)}function uS(e,t){Object.keys(t).forEach(function(r){var n="";["width","height","top","right","bottom","left"].indexOf(r)!==-1&&E4(t[r])&&(n="px"),e.style[r]=t[r]+n})}function dge(e,t){Object.keys(t).forEach(function(r){var n=t[r];n!==!1?e.setAttribute(r,t[r]):e.removeAttribute(r)})}function uge(e){return uS(e.instance.popper,e.styles),dge(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&uS(e.arrowElement,e.arrowStyles),e}function fge(e,t,r,n,i){var a=Qz(i,t,e,r.positionFixed),o=Jz(r.placement,a,t,e,r.modifiers.flip.boundariesElement,r.modifiers.flip.padding);return t.setAttribute("x-placement",o),uS(t,{position:r.positionFixed?"fixed":"absolute"}),r}function hge(e,t){var r=e.offsets,n=r.popper,i=r.reference,a=Math.round,o=Math.floor,l=function(_){return _},c=a(i.width),d=a(n.width),u=["left","right"].indexOf(e.placement)!==-1,h=e.placement.indexOf("-")!==-1,f=c%2===d%2,p=c%2===1&&d%2===1,x=t?u||h||f?a:o:l,g=t?a:l;return{left:x(p&&!h&&t?n.left-1:n.left),top:g(n.top),bottom:g(n.bottom),right:x(n.right)}}var mge=Fv&&/Firefox/i.test(navigator.userAgent);function pge(e,t){var r=t.x,n=t.y,i=e.offsets.popper,a=Bv(e.instance.modifiers,function(b){return b.name==="applyStyle"}).gpuAcceleration;a!==void 0&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var o=a!==void 0?a:t.gpuAcceleration,l=cm(e.instance.popper),c=dS(l),d={position:i.position},u=hge(e,window.devicePixelRatio<2||!mge),h=r==="bottom"?"top":"bottom",f=n==="right"?"left":"right",p=k4("transform"),x=void 0,g=void 0;if(h==="bottom"?l.nodeName==="HTML"?g=-l.clientHeight+u.bottom:g=-c.height+u.bottom:g=u.top,f==="right"?l.nodeName==="HTML"?x=-l.clientWidth+u.right:x=-c.width+u.right:x=u.left,o&&p)d[p]="translate3d("+x+"px, "+g+"px, 0)",d[h]=0,d[f]=0,d.willChange="transform";else{var v=h==="bottom"?-1:1,_=f==="right"?-1:1;d[h]=g*v,d[f]=x*_,d.willChange=h+", "+f}var w={"x-placement":e.placement};return e.attributes=qa({},w,e.attributes),e.styles=qa({},d,e.styles),e.arrowStyles=qa({},e.offsets.arrow,e.arrowStyles),e}function aV(e,t,r){var n=Bv(e,function(l){var c=l.name;return c===t}),i=!!n&&e.some(function(l){return l.name===r&&l.enabled&&l.order<n.order});if(!i){var a="`"+t+"`",o="`"+r+"`";console.warn(o+" modifier is required by "+a+" modifier in order to work, be sure to include it before "+a+"!")}return i}function gge(e,t){var r;if(!aV(e.instance.modifiers,"arrow","keepTogether"))return e;var n=t.element;if(typeof n=="string"){if(n=e.instance.popper.querySelector(n),!n)return e}else if(!e.instance.popper.contains(n))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var i=e.placement.split("-")[0],a=e.offsets,o=a.popper,l=a.reference,c=["left","right"].indexOf(i)!==-1,d=c?"height":"width",u=c?"Top":"Left",h=u.toLowerCase(),f=c?"left":"top",p=c?"bottom":"right",x=eV(n)[d];l[p]-x<o[h]&&(e.offsets.popper[h]-=o[h]-(l[p]-x)),l[h]+x>o[p]&&(e.offsets.popper[h]+=l[h]+x-o[p]),e.offsets.popper=Cd(e.offsets.popper);var g=l[h]+l[d]/2-x/2,v=gf(e.instance.popper),_=parseFloat(v["margin"+u]),w=parseFloat(v["border"+u+"Width"]),b=g-e.offsets.popper[h]-_-w;return b=Math.max(Math.min(o[d]-x,b),0),e.arrowElement=n,e.offsets.arrow=(r={},um(r,h,Math.round(b)),um(r,f,""),r),e}function vge(e){return e==="end"?"start":e==="start"?"end":e}var oV=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],Lj=oV.slice(3);function DA(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Lj.indexOf(e),n=Lj.slice(r+1).concat(Lj.slice(0,r));return t?n.reverse():n}var Fj={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function xge(e,t){if(nV(e.instance.modifiers,"inner")||e.flipped&&e.placement===e.originalPlacement)return e;var r=S4(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),n=e.placement.split("-")[0],i=K2(n),a=e.placement.split("-")[1]||"",o=[];switch(t.behavior){case Fj.FLIP:o=[n,i];break;case Fj.CLOCKWISE:o=DA(n);break;case Fj.COUNTERCLOCKWISE:o=DA(n,!0);break;default:o=t.behavior}return o.forEach(function(l,c){if(n!==l||o.length===c+1)return e;n=e.placement.split("-")[0],i=K2(n);var d=e.offsets.popper,u=e.offsets.reference,h=Math.floor,f=n==="left"&&h(d.right)>h(u.left)||n==="right"&&h(d.left)<h(u.right)||n==="top"&&h(d.bottom)>h(u.top)||n==="bottom"&&h(d.top)<h(u.bottom),p=h(d.left)<h(r.left),x=h(d.right)>h(r.right),g=h(d.top)<h(r.top),v=h(d.bottom)>h(r.bottom),_=n==="left"&&p||n==="right"&&x||n==="top"&&g||n==="bottom"&&v,w=["top","bottom"].indexOf(n)!==-1,b=!!t.flipVariations&&(w&&a==="start"&&p||w&&a==="end"&&x||!w&&a==="start"&&g||!w&&a==="end"&&v),N=!!t.flipVariationsByContent&&(w&&a==="start"&&x||w&&a==="end"&&p||!w&&a==="start"&&v||!w&&a==="end"&&g),S=b||N;(f||_||S)&&(e.flipped=!0,(f||_)&&(n=o[c+1]),S&&(a=vge(a)),e.placement=n+(a?"-"+a:""),e.offsets.popper=qa({},e.offsets.popper,tV(e.instance.popper,e.offsets.reference,e.placement)),e=rV(e.instance.modifiers,e,"flip"))}),e}function yge(e){var t=e.offsets,r=t.popper,n=t.reference,i=e.placement.split("-")[0],a=Math.floor,o=["top","bottom"].indexOf(i)!==-1,l=o?"right":"bottom",c=o?"left":"top",d=o?"width":"height";return r[l]<a(n[c])&&(e.offsets.popper[c]=a(n[c])-r[d]),r[c]>a(n[l])&&(e.offsets.popper[c]=a(n[l])),e}function _ge(e,t,r,n){var i=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),a=+i[1],o=i[2];if(!a)return e;if(o.indexOf("%")===0){var l=void 0;switch(o){case"%p":l=r;break;case"%":case"%r":default:l=n}var c=Cd(l);return c[t]/100*a}else if(o==="vh"||o==="vw"){var d=void 0;return o==="vh"?d=Math.max(document.documentElement.clientHeight,window.innerHeight||0):d=Math.max(document.documentElement.clientWidth,window.innerWidth||0),d/100*a}else return a}function wge(e,t,r,n){var i=[0,0],a=["right","left"].indexOf(n)!==-1,o=e.split(/(\+|\-)/).map(function(u){return u.trim()}),l=o.indexOf(Bv(o,function(u){return u.search(/,|\s/)!==-1}));o[l]&&o[l].indexOf(",")===-1&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var c=/\s*,\s*|\s+/,d=l!==-1?[o.slice(0,l).concat([o[l].split(c)[0]]),[o[l].split(c)[1]].concat(o.slice(l+1))]:[o];return d=d.map(function(u,h){var f=(h===1?!a:a)?"height":"width",p=!1;return u.reduce(function(x,g){return x[x.length-1]===""&&["+","-"].indexOf(g)!==-1?(x[x.length-1]=g,p=!0,x):p?(x[x.length-1]+=g,p=!1,x):x.concat(g)},[]).map(function(x){return _ge(x,f,t,r)})}),d.forEach(function(u,h){u.forEach(function(f,p){E4(f)&&(i[h]+=f*(u[p-1]==="-"?-1:1))})}),i}function bge(e,t){var r=t.offset,n=e.placement,i=e.offsets,a=i.popper,o=i.reference,l=n.split("-")[0],c=void 0;return E4(+r)?c=[+r,0]:c=wge(r,a,o,l),l==="left"?(a.top+=c[0],a.left-=c[1]):l==="right"?(a.top+=c[0],a.left+=c[1]):l==="top"?(a.left+=c[0],a.top-=c[1]):l==="bottom"&&(a.left+=c[0],a.top+=c[1]),e.popper=a,e}function jge(e,t){var r=t.boundariesElement||cm(e.instance.popper);e.instance.reference===r&&(r=cm(r));var n=k4("transform"),i=e.instance.popper.style,a=i.top,o=i.left,l=i[n];i.top="",i.left="",i[n]="";var c=S4(e.instance.popper,e.instance.reference,t.padding,r,e.positionFixed);i.top=a,i.left=o,i[n]=l,t.boundaries=c;var d=t.priority,u=e.offsets.popper,h={primary:function(p){var x=u[p];return u[p]<c[p]&&!t.escapeWithReference&&(x=Math.max(u[p],c[p])),um({},p,x)},secondary:function(p){var x=p==="right"?"left":"top",g=u[x];return u[p]>c[p]&&!t.escapeWithReference&&(g=Math.min(u[x],c[p]-(p==="right"?u.width:u.height))),um({},x,g)}};return d.forEach(function(f){var p=["left","top"].indexOf(f)!==-1?"primary":"secondary";u=qa({},u,h[p](f))}),e.offsets.popper=u,e}function Nge(e){var t=e.placement,r=t.split("-")[0],n=t.split("-")[1];if(n){var i=e.offsets,a=i.reference,o=i.popper,l=["bottom","top"].indexOf(r)!==-1,c=l?"left":"top",d=l?"width":"height",u={start:um({},c,a[c]),end:um({},c,a[c]+a[d]-o[d])};e.offsets.popper=qa({},o,u[n])}return e}function Sge(e){if(!aV(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,r=Bv(e.instance.modifiers,function(n){return n.name==="preventOverflow"}).boundaries;if(t.bottom<r.top||t.left>r.right||t.top>r.bottom||t.right<r.left){if(e.hide===!0)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(e.hide===!1)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}function kge(e){var t=e.placement,r=t.split("-")[0],n=e.offsets,i=n.popper,a=n.reference,o=["left","right"].indexOf(r)!==-1,l=["top","left"].indexOf(r)===-1;return i[o?"left":"top"]=a[r]-(l?i[o?"width":"height"]:0),e.placement=K2(t),e.offsets.popper=Cd(i),e}var Ege={shift:{order:100,enabled:!0,fn:Nge},offset:{order:200,enabled:!0,fn:bge,offset:0},preventOverflow:{order:300,enabled:!0,fn:jge,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:yge},arrow:{order:500,enabled:!0,fn:gge,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:xge,behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:kge},hide:{order:800,enabled:!0,fn:Sge},computeStyle:{order:850,enabled:!0,fn:pge,gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:uge,onLoad:fge,gpuAcceleration:void 0}},Cge={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:Ege},Cg=function(){function e(t,r){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Q0e(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(n.update)},this.update=Z0e(this.update.bind(this)),this.options=qa({},e.Defaults,i),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=r&&r.jquery?r[0]:r,this.options.modifiers={},Object.keys(qa({},e.Defaults.modifiers,i.modifiers)).forEach(function(o){n.options.modifiers[o]=qa({},e.Defaults.modifiers[o]||{},i.modifiers?i.modifiers[o]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(o){return qa({name:o},n.options.modifiers[o])}).sort(function(o,l){return o.order-l.order}),this.modifiers.forEach(function(o){o.enabled&&Gz(o.onLoad)&&o.onLoad(n.reference,n.popper,n.options,o,n.state)}),this.update();var a=this.options.eventsEnabled;a&&this.enableEventListeners(),this.state.eventsEnabled=a}return ege(e,[{key:"update",value:function(){return sge.call(this)}},{key:"destroy",value:function(){return ige.call(this)}},{key:"enableEventListeners",value:function(){return oge.call(this)}},{key:"disableEventListeners",value:function(){return cge.call(this)}}]),e}();Cg.Utils=(typeof window!="undefined"?window:global).PopperUtils;Cg.placements=oV;Cg.Defaults=Cge;var Pge=["innerHTML","ownerDocument","style","attributes","nodeValue"],Age=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],Tge=["bigint","boolean","null","number","string","symbol","undefined"];function b1(e){var t=Object.prototype.toString.call(e).slice(8,-1);if(/HTML\w+Element/.test(t))return"HTMLElement";if(Oge(t))return t}function zo(e){return function(t){return b1(t)===e}}function Oge(e){return Age.includes(e)}function ip(e){return function(t){return typeof t===e}}function Rge(e){return Tge.includes(e)}function Xe(e){if(e===null)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(Xe.array(e))return"Array";if(Xe.plainFunction(e))return"Function";var t=b1(e);return t||"Object"}Xe.array=Array.isArray;Xe.arrayOf=function(e,t){return!Xe.array(e)&&!Xe.function(t)?!1:e.every(function(r){return t(r)})};Xe.asyncGeneratorFunction=function(e){return b1(e)==="AsyncGeneratorFunction"};Xe.asyncFunction=zo("AsyncFunction");Xe.bigint=ip("bigint");Xe.boolean=function(e){return e===!0||e===!1};Xe.date=zo("Date");Xe.defined=function(e){return!Xe.undefined(e)};Xe.domElement=function(e){return Xe.object(e)&&!Xe.plainObject(e)&&e.nodeType===1&&Xe.string(e.nodeName)&&Pge.every(function(t){return t in e})};Xe.empty=function(e){return Xe.string(e)&&e.length===0||Xe.array(e)&&e.length===0||Xe.object(e)&&!Xe.map(e)&&!Xe.set(e)&&Object.keys(e).length===0||Xe.set(e)&&e.size===0||Xe.map(e)&&e.size===0};Xe.error=zo("Error");Xe.function=ip("function");Xe.generator=function(e){return Xe.iterable(e)&&Xe.function(e.next)&&Xe.function(e.throw)};Xe.generatorFunction=zo("GeneratorFunction");Xe.instanceOf=function(e,t){return!e||!t?!1:Object.getPrototypeOf(e)===t.prototype};Xe.iterable=function(e){return!Xe.nullOrUndefined(e)&&Xe.function(e[Symbol.iterator])};Xe.map=zo("Map");Xe.nan=function(e){return Number.isNaN(e)};Xe.null=function(e){return e===null};Xe.nullOrUndefined=function(e){return Xe.null(e)||Xe.undefined(e)};Xe.number=function(e){return ip("number")(e)&&!Xe.nan(e)};Xe.numericString=function(e){return Xe.string(e)&&e.length>0&&!Number.isNaN(Number(e))};Xe.object=function(e){return!Xe.nullOrUndefined(e)&&(Xe.function(e)||typeof e=="object")};Xe.oneOf=function(e,t){return Xe.array(e)?e.indexOf(t)>-1:!1};Xe.plainFunction=zo("Function");Xe.plainObject=function(e){if(b1(e)!=="Object")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.getPrototypeOf({})};Xe.primitive=function(e){return Xe.null(e)||Rge(typeof e)};Xe.promise=zo("Promise");Xe.propertyOf=function(e,t,r){if(!Xe.object(e)||!t)return!1;var n=e[t];return Xe.function(r)?r(n):Xe.defined(n)};Xe.regexp=zo("RegExp");Xe.set=zo("Set");Xe.string=ip("string");Xe.symbol=ip("symbol");Xe.undefined=ip("undefined");Xe.weakMap=zo("WeakMap");Xe.weakSet=zo("WeakSet");function lV(e){return function(t){return typeof t===e}}var Mge=lV("function"),Dge=function(e){return e===null},IA=function(e){return Object.prototype.toString.call(e).slice(8,-1)==="RegExp"},$A=function(e){return!Ige(e)&&!Dge(e)&&(Mge(e)||typeof e=="object")},Ige=lV("undefined"),fS=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function $ge(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=r;n--!==0;)if(!ta(e[n],t[n]))return!1;return!0}function Lge(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=new DataView(e.buffer),n=new DataView(t.buffer),i=e.byteLength;i--;)if(r.getUint8(i)!==n.getUint8(i))return!1;return!0}function Fge(e,t){var r,n,i,a;if(e.size!==t.size)return!1;try{for(var o=fS(e.entries()),l=o.next();!l.done;l=o.next()){var c=l.value;if(!t.has(c[0]))return!1}}catch(h){r={error:h}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}try{for(var d=fS(e.entries()),u=d.next();!u.done;u=d.next()){var c=u.value;if(!ta(c[1],t.get(c[0])))return!1}}catch(h){i={error:h}}finally{try{u&&!u.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}return!0}function Uge(e,t){var r,n;if(e.size!==t.size)return!1;try{for(var i=fS(e.entries()),a=i.next();!a.done;a=i.next()){var o=a.value;if(!t.has(o[0]))return!1}}catch(l){r={error:l}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return!0}function ta(e,t){if(e===t)return!0;if(e&&$A(e)&&t&&$A(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return $ge(e,t);if(e instanceof Map&&t instanceof Map)return Fge(e,t);if(e instanceof Set&&t instanceof Set)return Uge(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return Lge(e,t);if(IA(e)&&IA(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var i=r.length;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;for(var i=r.length;i--!==0;){var a=r[i];if(!(a==="_owner"&&e.$$typeof)&&!ta(e[a],t[a]))return!1}return!0}return Number.isNaN(e)&&Number.isNaN(t)?!0:e===t}function Bge(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(function(r){return Xe.string(r)||Xe.array(r)||Xe.plainObject(r)})}function zge(e,t,r){return cV(e,t)?[e,t].every(Xe.array)?!e.some(zA(r))&&t.some(zA(r)):[e,t].every(Xe.plainObject)?!Object.entries(e).some(BA(r))&&Object.entries(t).some(BA(r)):t===r:!1}function LA(e,t,r){var n=r.actual,i=r.key,a=r.previous,o=r.type,l=hl(e,i),c=hl(t,i),d=[l,c].every(Xe.number)&&(o==="increased"?l<c:l>c);return Xe.undefined(n)||(d=d&&c===n),Xe.undefined(a)||(d=d&&l===a),d}function FA(e,t,r){var n=r.key,i=r.type,a=r.value,o=hl(e,n),l=hl(t,n),c=i==="added"?o:l,d=i==="added"?l:o;if(!Xe.nullOrUndefined(a)){if(Xe.defined(c)){if(Xe.array(c)||Xe.plainObject(c))return zge(c,d,a)}else return ta(d,a);return!1}return[o,l].every(Xe.array)?!d.every(C4(c)):[o,l].every(Xe.plainObject)?Vge(Object.keys(c),Object.keys(d)):![o,l].every(function(u){return Xe.primitive(u)&&Xe.defined(u)})&&(i==="added"?!Xe.defined(o)&&Xe.defined(l):Xe.defined(o)&&!Xe.defined(l))}function UA(e,t,r){var n=r===void 0?{}:r,i=n.key,a=hl(e,i),o=hl(t,i);if(!cV(a,o))throw new TypeError("Inputs have different types");if(!Bge(a,o))throw new TypeError("Inputs don't have length");return[a,o].every(Xe.plainObject)&&(a=Object.keys(a),o=Object.keys(o)),[a,o]}function BA(e){return function(t){var r=t[0],n=t[1];return Xe.array(e)?ta(e,n)||e.some(function(i){return ta(i,n)||Xe.array(n)&&C4(n)(i)}):Xe.plainObject(e)&&e[r]?!!e[r]&&ta(e[r],n):ta(e,n)}}function Vge(e,t){return t.some(function(r){return!e.includes(r)})}function zA(e){return function(t){return Xe.array(e)?e.some(function(r){return ta(r,t)||Xe.array(t)&&C4(t)(r)}):ta(e,t)}}function Xp(e,t){return Xe.array(e)?e.some(function(r){return ta(r,t)}):ta(e,t)}function C4(e){return function(t){return e.some(function(r){return ta(r,t)})}}function cV(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(Xe.array)||e.every(Xe.number)||e.every(Xe.plainObject)||e.every(Xe.string)}function hl(e,t){if(Xe.plainObject(e)||Xe.array(e)){if(Xe.string(t)){var r=t.split(".");return r.reduce(function(n,i){return n&&n[i]},e)}return Xe.number(t)?e[t]:e}return e}function qge(e,t){if([e,t].some(Xe.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every(function(h){return Xe.plainObject(h)||Xe.array(h)}))throw new Error("Expected plain objects or array");var r=function(h,f){try{return FA(e,t,{key:h,type:"added",value:f})}catch(p){return!1}},n=function(h,f,p){try{var x=hl(e,h),g=hl(t,h),v=Xe.defined(f),_=Xe.defined(p);if(v||_){var w=_?Xp(p,x):!Xp(f,x),b=Xp(f,g);return w&&b}return[x,g].every(Xe.array)||[x,g].every(Xe.plainObject)?!ta(x,g):x!==g}catch(N){return!1}},i=function(h,f,p){if(!Xe.defined(h))return!1;try{var x=hl(e,h),g=hl(t,h),v=Xe.defined(p);return Xp(f,x)&&(v?Xp(p,g):!v)}catch(_){return!1}},a=function(h,f){return Xe.defined(h)?n(h,f):!1},o=function(h,f,p){if(!Xe.defined(h))return!1;try{return LA(e,t,{key:h,actual:f,previous:p,type:"decreased"})}catch(x){return!1}},l=function(h){try{var f=UA(e,t,{key:h}),p=f[0],x=f[1];return!!p.length&&!x.length}catch(g){return!1}},c=function(h){try{var f=UA(e,t,{key:h}),p=f[0],x=f[1];return!p.length&&!!x.length}catch(g){return!1}},d=function(h,f,p){if(!Xe.defined(h))return!1;try{return LA(e,t,{key:h,actual:f,previous:p,type:"increased"})}catch(x){return!1}},u=function(h,f){try{return FA(e,t,{key:h,type:"removed",value:f})}catch(p){return!1}};return{added:r,changed:n,changedFrom:i,changedTo:a,decreased:o,emptied:l,filled:c,increased:d,removed:u}}function VA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Vn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VA(Object(r),!0).forEach(function(n){vi(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uV(n.key),n)}}function Vv(e,t,r){return t&&Wge(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vi(e,t,r){return t=uV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qv(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hS(e,t)}function Z2(e){return Z2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Z2(e)}function hS(e,t){return hS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hS(e,t)}function Hge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Gge(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function dV(e,t){if(e==null)return{};var r=Gge(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ql(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yge(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ql(e)}function Wv(e){var t=Hge();return function(){var n=Z2(e),i;if(t){var a=Z2(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Yge(this,i)}}function Kge(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uV(e){var t=Kge(e,"string");return typeof t=="symbol"?t:String(t)}var Zge={flip:{padding:20},preventOverflow:{padding:10}},Xge="The typeValidator argument must be a function with the signature function(props, propName, componentName).",Jge="The error message is optional, but must be a string if provided.";function Qge(e,t,r,n){return typeof e=="boolean"?e:typeof e=="function"?e(t,r,n):e?!!e:!1}function eve(e,t){return Object.hasOwnProperty.call(e,t)}function tve(e,t,r,n){return new Error("Required ".concat(e[t]," `").concat(t,"` was not specified in `").concat(r,"`."))}function rve(e,t){if(typeof e!="function")throw new TypeError(Xge);if(t&&typeof t!="string")throw new TypeError(Jge)}function qA(e,t,r){return rve(e,r),function(n,i,a){for(var o=arguments.length,l=new Array(o>3?o-3:0),c=3;c<o;c++)l[c-3]=arguments[c];return Qge(t,n,i,a)?eve(n,i)?e.apply(void 0,[n,i,a].concat(l)):tve(n,i,a):e.apply(void 0,[n,i,a].concat(l))}}var Zr={INIT:"init",IDLE:"idle",OPENING:"opening",OPEN:"open",CLOSING:"closing",ERROR:"error"},Jp=Nh.createPortal!==void 0;function rl(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}function Uj(){return"ontouchstart"in window&&/Mobi/.test(navigator.userAgent)}function iy(e){var t=e.title,r=e.data,n=e.warn,i=n===void 0?!1:n,a=e.debug,o=a===void 0?!1:a,l=i?console.warn||console.error:console.log;o&&t&&r&&(console.groupCollapsed("%creact-floater: ".concat(t),"color: #9b00ff; font-weight: bold; font-size: 12px;"),Array.isArray(r)?r.forEach(function(c){Xe.plainObject(c)&&c.key?l.apply(console,[c.key,c.value]):l.apply(console,[c])}):l.apply(console,[r]),console.groupEnd())}function nve(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;e.addEventListener(t,r,n)}function sve(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;e.removeEventListener(t,r,n)}function ive(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i;i=function(o){r(o),sve(e,t,i)},nve(e,t,i,n)}function WA(){}var fV=function(e){qv(r,e);var t=Wv(r);function r(){return zv(this,r),t.apply(this,arguments)}return Vv(r,[{key:"componentDidMount",value:function(){rl()&&(this.node||this.appendNode(),Jp||this.renderPortal())}},{key:"componentDidUpdate",value:function(){rl()&&(Jp||this.renderPortal())}},{key:"componentWillUnmount",value:function(){!rl()||!this.node||(Jp||Nh.unmountComponentAtNode(this.node),this.node&&this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=void 0))}},{key:"appendNode",value:function(){var i=this.props,a=i.id,o=i.zIndex;this.node||(this.node=document.createElement("div"),a&&(this.node.id=a),o&&(this.node.style.zIndex=o),document.body.appendChild(this.node))}},{key:"renderPortal",value:function(){if(!rl())return null;var i=this.props,a=i.children,o=i.setRef;if(this.node||this.appendNode(),Jp)return Nh.createPortal(a,this.node);var l=Nh.unstable_renderSubtreeIntoContainer(this,a.length>1?Q.createElement("div",null,a):a[0],this.node);return o(l),null}},{key:"renderReact16",value:function(){var i=this.props,a=i.hasChildren,o=i.placement,l=i.target;return a?this.renderPortal():l||o==="center"?this.renderPortal():null}},{key:"render",value:function(){return Jp?this.renderReact16():null}}]),r}(Q.Component);vi(fV,"propTypes",{children:at.oneOfType([at.element,at.array]),hasChildren:at.bool,id:at.oneOfType([at.string,at.number]),placement:at.string,setRef:at.func.isRequired,target:at.oneOfType([at.object,at.string]),zIndex:at.number});var hV=function(e){qv(r,e);var t=Wv(r);function r(){return zv(this,r),t.apply(this,arguments)}return Vv(r,[{key:"parentStyle",get:function(){var i=this.props,a=i.placement,o=i.styles,l=o.arrow.length,c={pointerEvents:"none",position:"absolute",width:"100%"};return a.startsWith("top")?(c.bottom=0,c.left=0,c.right=0,c.height=l):a.startsWith("bottom")?(c.left=0,c.right=0,c.top=0,c.height=l):a.startsWith("left")?(c.right=0,c.top=0,c.bottom=0):a.startsWith("right")&&(c.left=0,c.top=0),c}},{key:"render",value:function(){var i=this.props,a=i.placement,o=i.setArrowRef,l=i.styles,c=l.arrow,d=c.color,u=c.display,h=c.length,f=c.margin,p=c.position,x=c.spread,g={display:u,position:p},v,_=x,w=h;return a.startsWith("top")?(v="0,0 ".concat(_/2,",").concat(w," ").concat(_,",0"),g.bottom=0,g.marginLeft=f,g.marginRight=f):a.startsWith("bottom")?(v="".concat(_,",").concat(w," ").concat(_/2,",0 0,").concat(w),g.top=0,g.marginLeft=f,g.marginRight=f):a.startsWith("left")?(w=x,_=h,v="0,0 ".concat(_,",").concat(w/2," 0,").concat(w),g.right=0,g.marginTop=f,g.marginBottom=f):a.startsWith("right")&&(w=x,_=h,v="".concat(_,",").concat(w," ").concat(_,",0 0,").concat(w/2),g.left=0,g.marginTop=f,g.marginBottom=f),Q.createElement("div",{className:"__floater__arrow",style:this.parentStyle},Q.createElement("span",{ref:o,style:g},Q.createElement("svg",{width:_,height:w,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Q.createElement("polygon",{points:v,fill:d}))))}}]),r}(Q.Component);vi(hV,"propTypes",{placement:at.string.isRequired,setArrowRef:at.func.isRequired,styles:at.object.isRequired});var ave=["color","height","width"];function mV(e){var t=e.handleClick,r=e.styles,n=r.color,i=r.height,a=r.width,o=dV(r,ave);return Q.createElement("button",{"aria-label":"close",onClick:t,style:o,type:"button"},Q.createElement("svg",{width:"".concat(a,"px"),height:"".concat(i,"px"),viewBox:"0 0 18 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid"},Q.createElement("g",null,Q.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:n}))))}mV.propTypes={handleClick:at.func.isRequired,styles:at.object.isRequired};function pV(e){var t=e.content,r=e.footer,n=e.handleClick,i=e.open,a=e.positionWrapper,o=e.showCloseButton,l=e.title,c=e.styles,d={content:Q.isValidElement(t)?t:Q.createElement("div",{className:"__floater__content",style:c.content},t)};return l&&(d.title=Q.isValidElement(l)?l:Q.createElement("div",{className:"__floater__title",style:c.title},l)),r&&(d.footer=Q.isValidElement(r)?r:Q.createElement("div",{className:"__floater__footer",style:c.footer},r)),(o||a)&&!Xe.boolean(i)&&(d.close=Q.createElement(mV,{styles:c.close,handleClick:n})),Q.createElement("div",{className:"__floater__container",style:c.container},d.close,d.title,d.content,d.footer)}pV.propTypes={content:at.node.isRequired,footer:at.node,handleClick:at.func.isRequired,open:at.bool,positionWrapper:at.bool.isRequired,showCloseButton:at.bool.isRequired,styles:at.object.isRequired,title:at.node};var gV=function(e){qv(r,e);var t=Wv(r);function r(){return zv(this,r),t.apply(this,arguments)}return Vv(r,[{key:"style",get:function(){var i=this.props,a=i.disableAnimation,o=i.component,l=i.placement,c=i.hideArrow,d=i.status,u=i.styles,h=u.arrow.length,f=u.floater,p=u.floaterCentered,x=u.floaterClosing,g=u.floaterOpening,v=u.floaterWithAnimation,_=u.floaterWithComponent,w={};return c||(l.startsWith("top")?w.padding="0 0 ".concat(h,"px"):l.startsWith("bottom")?w.padding="".concat(h,"px 0 0"):l.startsWith("left")?w.padding="0 ".concat(h,"px 0 0"):l.startsWith("right")&&(w.padding="0 0 0 ".concat(h,"px"))),[Zr.OPENING,Zr.OPEN].indexOf(d)!==-1&&(w=Vn(Vn({},w),g)),d===Zr.CLOSING&&(w=Vn(Vn({},w),x)),d===Zr.OPEN&&!a&&(w=Vn(Vn({},w),v)),l==="center"&&(w=Vn(Vn({},w),p)),o&&(w=Vn(Vn({},w),_)),Vn(Vn({},f),w)}},{key:"render",value:function(){var i=this.props,a=i.component,o=i.handleClick,l=i.hideArrow,c=i.setFloaterRef,d=i.status,u={},h=["__floater"];return a?Q.isValidElement(a)?u.content=Q.cloneElement(a,{closeFn:o}):u.content=a({closeFn:o}):u.content=Q.createElement(pV,this.props),d===Zr.OPEN&&h.push("__floater__open"),l||(u.arrow=Q.createElement(hV,this.props)),Q.createElement("div",{ref:c,className:h.join(" "),style:this.style},Q.createElement("div",{className:"__floater__body"},u.content,u.arrow))}}]),r}(Q.Component);vi(gV,"propTypes",{component:at.oneOfType([at.func,at.element]),content:at.node,disableAnimation:at.bool.isRequired,footer:at.node,handleClick:at.func.isRequired,hideArrow:at.bool.isRequired,open:at.bool,placement:at.string.isRequired,positionWrapper:at.bool.isRequired,setArrowRef:at.func.isRequired,setFloaterRef:at.func.isRequired,showCloseButton:at.bool,status:at.string.isRequired,styles:at.object.isRequired,title:at.node});var vV=function(e){qv(r,e);var t=Wv(r);function r(){return zv(this,r),t.apply(this,arguments)}return Vv(r,[{key:"render",value:function(){var i=this.props,a=i.children,o=i.handleClick,l=i.handleMouseEnter,c=i.handleMouseLeave,d=i.setChildRef,u=i.setWrapperRef,h=i.style,f=i.styles,p;if(a)if(Q.Children.count(a)===1)if(!Q.isValidElement(a))p=Q.createElement("span",null,a);else{var x=Xe.function(a.type)?"innerRef":"ref";p=Q.cloneElement(Q.Children.only(a),vi({},x,d))}else p=a;return p?Q.createElement("span",{ref:u,style:Vn(Vn({},f),h),onClick:o,onMouseEnter:l,onMouseLeave:c},p):null}}]),r}(Q.Component);vi(vV,"propTypes",{children:at.node,handleClick:at.func.isRequired,handleMouseEnter:at.func.isRequired,handleMouseLeave:at.func.isRequired,setChildRef:at.func.isRequired,setWrapperRef:at.func.isRequired,style:at.object,styles:at.object.isRequired});var ove={zIndex:100};function lve(e){var t=Po(ove,e.options||{});return{wrapper:{cursor:"help",display:"inline-flex",flexDirection:"column",zIndex:t.zIndex},wrapperPosition:{left:-1e3,position:"absolute",top:-1e3,visibility:"hidden"},floater:{display:"inline-block",filter:"drop-shadow(0 0 3px rgba(0, 0, 0, 0.3))",maxWidth:300,opacity:0,position:"relative",transition:"opacity 0.3s",visibility:"hidden",zIndex:t.zIndex},floaterOpening:{opacity:1,visibility:"visible"},floaterWithAnimation:{opacity:1,transition:"opacity 0.3s, transform 0.2s",visibility:"visible"},floaterWithComponent:{maxWidth:"100%"},floaterClosing:{opacity:0,visibility:"visible"},floaterCentered:{left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)"},container:{backgroundColor:"#fff",color:"#666",minHeight:60,minWidth:200,padding:20,position:"relative",zIndex:10},title:{borderBottom:"1px solid #555",color:"#555",fontSize:18,marginBottom:5,paddingBottom:6,paddingRight:18},content:{fontSize:15},close:{backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",fontSize:0,height:15,outline:"none",padding:10,position:"absolute",right:0,top:0,width:15,WebkitAppearance:"none"},footer:{borderTop:"1px solid #ccc",fontSize:13,marginTop:10,paddingTop:5},arrow:{color:"#fff",display:"inline-flex",length:16,margin:8,position:"absolute",spread:32},options:t}}var cve=["arrow","flip","offset"],dve=["position","top","right","bottom","left"],P4=function(e){qv(r,e);var t=Wv(r);function r(n){var i;return zv(this,r),i=t.call(this,n),vi(ql(i),"setArrowRef",function(a){i.arrowRef=a}),vi(ql(i),"setChildRef",function(a){i.childRef=a}),vi(ql(i),"setFloaterRef",function(a){i.floaterRef=a}),vi(ql(i),"setWrapperRef",function(a){i.wrapperRef=a}),vi(ql(i),"handleTransitionEnd",function(){var a=i.state.status,o=i.props.callback;i.wrapperPopper&&i.wrapperPopper.instance.update(),i.setState({status:a===Zr.OPENING?Zr.OPEN:Zr.IDLE},function(){var l=i.state.status;o(l===Zr.OPEN?"open":"close",i.props)})}),vi(ql(i),"handleClick",function(){var a=i.props,o=a.event,l=a.open;if(!Xe.boolean(l)){var c=i.state,d=c.positionWrapper,u=c.status;(i.event==="click"||i.event==="hover"&&d)&&(iy({title:"click",data:[{event:o,status:u===Zr.OPEN?"closing":"opening"}],debug:i.debug}),i.toggle())}}),vi(ql(i),"handleMouseEnter",function(){var a=i.props,o=a.event,l=a.open;if(!(Xe.boolean(l)||Uj())){var c=i.state.status;i.event==="hover"&&c===Zr.IDLE&&(iy({title:"mouseEnter",data:[{key:"originalEvent",value:o}],debug:i.debug}),clearTimeout(i.eventDelayTimeout),i.toggle())}}),vi(ql(i),"handleMouseLeave",function(){var a=i.props,o=a.event,l=a.eventDelay,c=a.open;if(!(Xe.boolean(c)||Uj())){var d=i.state,u=d.status,h=d.positionWrapper;i.event==="hover"&&(iy({title:"mouseLeave",data:[{key:"originalEvent",value:o}],debug:i.debug}),l?[Zr.OPENING,Zr.OPEN].indexOf(u)!==-1&&!h&&!i.eventDelayTimeout&&(i.eventDelayTimeout=setTimeout(function(){delete i.eventDelayTimeout,i.toggle()},l*1e3)):i.toggle(Zr.IDLE))}}),i.state={currentPlacement:n.placement,needsUpdate:!1,positionWrapper:n.wrapperOptions.position&&!!n.target,status:Zr.INIT,statusWrapper:Zr.INIT},i._isMounted=!1,i.hasMounted=!1,rl()&&window.addEventListener("load",function(){i.popper&&i.popper.instance.update(),i.wrapperPopper&&i.wrapperPopper.instance.update()}),i}return Vv(r,[{key:"componentDidMount",value:function(){if(rl()){var i=this.state.positionWrapper,a=this.props,o=a.children,l=a.open,c=a.target;this._isMounted=!0,iy({title:"init",data:{hasChildren:!!o,hasTarget:!!c,isControlled:Xe.boolean(l),positionWrapper:i,target:this.target,floater:this.floaterRef},debug:this.debug}),this.hasMounted||(this.initPopper(),this.hasMounted=!0),!o&&c&&Xe.boolean(l)}}},{key:"componentDidUpdate",value:function(i,a){if(rl()){var o=this.props,l=o.autoOpen,c=o.open,d=o.target,u=o.wrapperOptions,h=qge(a,this.state),f=h.changedFrom,p=h.changed;if(i.open!==c){var x;Xe.boolean(c)&&(x=c?Zr.OPENING:Zr.CLOSING),this.toggle(x)}(i.wrapperOptions.position!==u.position||i.target!==d)&&this.changeWrapperPosition(this.props),p("status",Zr.IDLE)&&c?this.toggle(Zr.OPEN):f("status",Zr.INIT,Zr.IDLE)&&l&&this.toggle(Zr.OPEN),this.popper&&p("status",Zr.OPENING)&&this.popper.instance.update(),this.floaterRef&&(p("status",Zr.OPENING)||p("status",Zr.CLOSING))&&ive(this.floaterRef,"transitionend",this.handleTransitionEnd),p("needsUpdate",!0)&&this.rebuildPopper()}}},{key:"componentWillUnmount",value:function(){rl()&&(this._isMounted=!1,this.popper&&this.popper.instance.destroy(),this.wrapperPopper&&this.wrapperPopper.instance.destroy())}},{key:"initPopper",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.target,o=this.state.positionWrapper,l=this.props,c=l.disableFlip,d=l.getPopper,u=l.hideArrow,h=l.offset,f=l.placement,p=l.wrapperOptions,x=f==="top"||f==="bottom"?"flip":["right","bottom-end","top-end","left","top-start","bottom-start"];if(f==="center")this.setState({status:Zr.IDLE});else if(a&&this.floaterRef){var g=this.options,v=g.arrow,_=g.flip,w=g.offset,b=dV(g,cve);new Cg(a,this.floaterRef,{placement:f,modifiers:Vn({arrow:Vn({enabled:!u,element:this.arrowRef},v),flip:Vn({enabled:!c,behavior:x},_),offset:Vn({offset:"0, ".concat(h,"px")},w)},b),onCreate:function(k){var O;if(i.popper=k,!((O=i.floaterRef)!==null&&O!==void 0&&O.isConnected)){i.setState({needsUpdate:!0});return}d(k,"floater"),i._isMounted&&i.setState({currentPlacement:k.placement,status:Zr.IDLE}),f!==k.placement&&setTimeout(function(){k.instance.update()},1)},onUpdate:function(k){i.popper=k;var O=i.state.currentPlacement;i._isMounted&&k.placement!==O&&i.setState({currentPlacement:k.placement})}})}if(o){var N=Xe.undefined(p.offset)?0:p.offset;new Cg(this.target,this.wrapperRef,{placement:p.placement||f,modifiers:{arrow:{enabled:!1},offset:{offset:"0, ".concat(N,"px")},flip:{enabled:!1}},onCreate:function(k){i.wrapperPopper=k,i._isMounted&&i.setState({statusWrapper:Zr.IDLE}),d(k,"wrapper"),f!==k.placement&&setTimeout(function(){k.instance.update()},1)}})}}},{key:"rebuildPopper",value:function(){var i=this;this.floaterRefInterval=setInterval(function(){var a;(a=i.floaterRef)!==null&&a!==void 0&&a.isConnected&&(clearInterval(i.floaterRefInterval),i.setState({needsUpdate:!1}),i.initPopper())},50)}},{key:"changeWrapperPosition",value:function(i){var a=i.target,o=i.wrapperOptions;this.setState({positionWrapper:o.position&&!!a})}},{key:"toggle",value:function(i){var a=this.state.status,o=a===Zr.OPEN?Zr.CLOSING:Zr.OPENING;Xe.undefined(i)||(o=i),this.setState({status:o})}},{key:"debug",get:function(){var i=this.props.debug;return i||rl()&&"ReactFloaterDebug"in window&&!!window.ReactFloaterDebug}},{key:"event",get:function(){var i=this.props,a=i.disableHoverToClick,o=i.event;return o==="hover"&&Uj()&&!a?"click":o}},{key:"options",get:function(){var i=this.props.options;return Po(Zge,i||{})}},{key:"styles",get:function(){var i=this,a=this.state,o=a.status,l=a.positionWrapper,c=a.statusWrapper,d=this.props.styles,u=Po(lve(d),d);if(l){var h;[Zr.IDLE].indexOf(o)===-1||[Zr.IDLE].indexOf(c)===-1?h=u.wrapperPosition:h=this.wrapperPopper.styles,u.wrapper=Vn(Vn({},u.wrapper),h)}if(this.target){var f=window.getComputedStyle(this.target);this.wrapperStyles?u.wrapper=Vn(Vn({},u.wrapper),this.wrapperStyles):["relative","static"].indexOf(f.position)===-1&&(this.wrapperStyles={},l||(dve.forEach(function(p){i.wrapperStyles[p]=f[p]}),u.wrapper=Vn(Vn({},u.wrapper),this.wrapperStyles),this.target.style.position="relative",this.target.style.top="auto",this.target.style.right="auto",this.target.style.bottom="auto",this.target.style.left="auto"))}return u}},{key:"target",get:function(){if(!rl())return null;var i=this.props.target;return i?Xe.domElement(i)?i:document.querySelector(i):this.childRef||this.wrapperRef}},{key:"render",value:function(){var i=this.state,a=i.currentPlacement,o=i.positionWrapper,l=i.status,c=this.props,d=c.children,u=c.component,h=c.content,f=c.disableAnimation,p=c.footer,x=c.hideArrow,g=c.id,v=c.open,_=c.showCloseButton,w=c.style,b=c.target,N=c.title,S=Q.createElement(vV,{handleClick:this.handleClick,handleMouseEnter:this.handleMouseEnter,handleMouseLeave:this.handleMouseLeave,setChildRef:this.setChildRef,setWrapperRef:this.setWrapperRef,style:w,styles:this.styles.wrapper},d),k={};return o?k.wrapperInPortal=S:k.wrapperAsChildren=S,Q.createElement("span",null,Q.createElement(fV,{hasChildren:!!d,id:g,placement:a,setRef:this.setFloaterRef,target:b,zIndex:this.styles.options.zIndex},Q.createElement(gV,{component:u,content:h,disableAnimation:f,footer:p,handleClick:this.handleClick,hideArrow:x||a==="center",open:v,placement:a,positionWrapper:o,setArrowRef:this.setArrowRef,setFloaterRef:this.setFloaterRef,showCloseButton:_,status:l,styles:this.styles,title:N}),k.wrapperInPortal),k.wrapperAsChildren)}}]),r}(Q.Component);vi(P4,"propTypes",{autoOpen:at.bool,callback:at.func,children:at.node,component:qA(at.oneOfType([at.func,at.element]),function(e){return!e.content}),content:qA(at.node,function(e){return!e.component}),debug:at.bool,disableAnimation:at.bool,disableFlip:at.bool,disableHoverToClick:at.bool,event:at.oneOf(["hover","click"]),eventDelay:at.number,footer:at.node,getPopper:at.func,hideArrow:at.bool,id:at.oneOfType([at.string,at.number]),offset:at.number,open:at.bool,options:at.object,placement:at.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto","center"]),showCloseButton:at.bool,style:at.object,styles:at.object,target:at.oneOfType([at.object,at.string]),title:at.node,wrapperOptions:at.shape({offset:at.number,placement:at.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto"]),position:at.bool})});vi(P4,"defaultProps",{autoOpen:!1,callback:WA,debug:!1,disableAnimation:!1,disableFlip:!1,disableHoverToClick:!1,event:"click",eventDelay:.4,getPopper:WA,hideArrow:!1,offset:15,placement:"bottom",showCloseButton:!1,styles:{},target:null,wrapperOptions:{position:!1}});var uve=Object.defineProperty,fve=(e,t,r)=>t in e?uve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Gt=(e,t,r)=>fve(e,typeof t!="symbol"?t+"":t,r),Jr={INIT:"init",START:"start",STOP:"stop",RESET:"reset",PREV:"prev",NEXT:"next",GO:"go",CLOSE:"close",SKIP:"skip",UPDATE:"update"},Os={TOUR_START:"tour:start",STEP_BEFORE:"step:before",BEACON:"beacon",TOOLTIP:"tooltip",STEP_AFTER:"step:after",TOUR_END:"tour:end",TOUR_STATUS:"tour:status",TARGET_NOT_FOUND:"error:target_not_found",ERROR:"error"},br={INIT:"init",READY:"ready",BEACON:"beacon",TOOLTIP:"tooltip",COMPLETE:"complete",ERROR:"error"},Mr={IDLE:"idle",READY:"ready",WAITING:"waiting",RUNNING:"running",PAUSED:"paused",SKIPPED:"skipped",FINISHED:"finished",ERROR:"error"};function Qc(){var e;return!!(typeof window!="undefined"&&((e=window.document)!=null&&e.createElement))}function xV(e){return e?e.getBoundingClientRect():null}function hve(e=!1){const{body:t,documentElement:r}=document;if(!t||!r)return 0;if(e){const n=[t.scrollHeight,t.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight].sort((a,o)=>a-o),i=Math.floor(n.length/2);return n.length%2===0?(n[i-1]+n[i])/2:n[i]}return Math.max(t.scrollHeight,t.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight)}function sc(e){if(typeof e=="string")try{return document.querySelector(e)}catch(t){return null}return e}function mve(e){return!e||e.nodeType!==1?null:getComputedStyle(e)}function Pg(e,t,r){if(!e)return hu();const n=zz(e);if(n){if(n.isSameNode(hu()))return r?document:hu();if(!(n.scrollHeight>n.offsetHeight)&&!t)return n.style.overflow="initial",hu()}return n}function j1(e,t){if(!e)return!1;const r=Pg(e,t);return r?!r.isSameNode(hu()):!1}function pve(e){return e.offsetParent!==document.body}function fm(e,t="fixed"){if(!e||!(e instanceof HTMLElement))return!1;const{nodeName:r}=e,n=mve(e);return r==="BODY"||r==="HTML"?!1:n&&n.position===t?!0:e.parentNode?fm(e.parentNode,t):!1}function gve(e){var t;if(!e)return!1;let r=e;for(;r&&r!==document.body;){if(r instanceof HTMLElement){const{display:n,visibility:i}=getComputedStyle(r);if(n==="none"||i==="hidden")return!1}r=(t=r.parentElement)!=null?t:null}return!0}function vve(e,t,r){var n,i,a;const o=xV(e),l=Pg(e,r),c=j1(e,r),d=fm(e);let u=0,h=(n=o==null?void 0:o.top)!=null?n:0;if(c&&d){const f=(i=e==null?void 0:e.offsetTop)!=null?i:0,p=(a=l==null?void 0:l.scrollTop)!=null?a:0;h=f-p}else l instanceof HTMLElement&&(u=l.scrollTop,!c&&!fm(e)&&(h+=u),l.isSameNode(hu())||(h+=hu().scrollTop));return Math.floor(h-t)}function xve(e,t,r){var n;if(!e)return 0;const{offsetTop:i=0,scrollTop:a=0}=(n=zz(e))!=null?n:{};let o=e.getBoundingClientRect().top+a;i&&(j1(e,r)||pve(e))&&(o-=i);const l=Math.floor(o-t);return l<0?0:l}function hu(){var e;return(e=document.scrollingElement)!=null?e:document.documentElement}function yve(e,t){const{duration:r,element:n}=t;return new Promise((i,a)=>{const{scrollTop:o}=n,l=e>o?e-o:o-e;b0e.top(n,e,{duration:l<100?50:r},c=>c&&c.message!=="Element already at target scroll position"?a(c):i())})}var Qp=Ya.createPortal!==void 0;function yV(e=navigator.userAgent){let t=e;return typeof window=="undefined"?t="node":document.documentMode?t="ie":/Edge/.test(e)?t="edge":window.opera||e.includes(" OPR/")?t="opera":typeof window.InstallTrigger!="undefined"?t="firefox":window.chrome?t="chrome":/(Version\/([\d._]+).*Safari|CriOS|FxiOS| Mobile\/)/.test(e)&&(t="safari"),t}function Hy(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function nl(e,t={}){const{defaultValue:r,step:n,steps:i}=t;let a=PA(e);if(a)(a.includes("{step}")||a.includes("{steps}"))&&n&&i&&(a=a.replace("{step}",n.toString()).replace("{steps}",i.toString()));else if(y.isValidElement(e)&&!Object.values(e.props).length&&Hy(e.type)==="function"){const o=e.type({});a=nl(o,t)}else a=PA(r);return a}function _ve(e,t){return!Wt.plainObject(e)||!Wt.array(t)?!1:Object.keys(e).every(r=>t.includes(r))}function wve(e){const t=/^#?([\da-f])([\da-f])([\da-f])$/i,r=e.replace(t,(i,a,o,l)=>a+a+o+o+l+l),n=/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i.exec(r);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:[]}function HA(e){return e.disableBeacon||e.placement==="center"}function GA(){return!["chrome","safari","firefox","opera"].includes(yV())}function Xu({data:e,debug:t=!1,title:r,warn:n=!1}){const i=n?console.warn||console.error:console.log;t&&(r&&e?(console.groupCollapsed(`%creact-joyride: ${r}`,"color: #ff0044; font-weight: bold; font-size: 12px;"),Array.isArray(e)?e.forEach(a=>{Wt.plainObject(a)&&a.key?i.apply(console,[a.key,a.value]):i.apply(console,[a])}):i.apply(console,[e]),console.groupEnd()):console.error("Missing title or data props"))}function bve(e){return Object.keys(e)}function _V(e,...t){if(!Wt.plainObject(e))throw new TypeError("Expected an object");const r={};for(const n in e)({}).hasOwnProperty.call(e,n)&&(t.includes(n)||(r[n]=e[n]));return r}function jve(e,...t){if(!Wt.plainObject(e))throw new TypeError("Expected an object");if(!t.length)return e;const r={};for(const n in e)({}).hasOwnProperty.call(e,n)&&t.includes(n)&&(r[n]=e[n]);return r}function mS(e,t,r){const n=a=>a.replace("{step}",String(t)).replace("{steps}",String(r));if(Hy(e)==="string")return n(e);if(!y.isValidElement(e))return e;const{children:i}=e.props;if(Hy(i)==="string"&&i.includes("{step}"))return y.cloneElement(e,{children:n(i)});if(Array.isArray(i))return y.cloneElement(e,{children:i.map(a=>typeof a=="string"?n(a):mS(a,t,r))});if(Hy(e.type)==="function"&&!Object.values(e.props).length){const a=e.type({});return mS(a,t,r)}return e}function Nve(e){const{isFirstStep:t,lifecycle:r,previousLifecycle:n,scrollToFirstStep:i,step:a,target:o}=e;return!a.disableScrolling&&(!t||i||r===br.TOOLTIP)&&a.placement!=="center"&&(!a.isFixed||!fm(o))&&n!==r&&[br.BEACON,br.TOOLTIP].includes(r)}var Sve={options:{preventOverflow:{boundariesElement:"scrollParent"}},wrapperOptions:{offset:-18,position:!0}},wV={back:"Back",close:"Close",last:"Last",next:"Next",nextLabelWithProgress:"Next (Step {step} of {steps})",open:"Open the dialog",skip:"Skip"},kve={event:"click",placement:"bottom",offset:10,disableBeacon:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrollParentFix:!1,disableScrolling:!1,hideBackButton:!1,hideCloseButton:!1,hideFooter:!1,isFixed:!1,locale:wV,showProgress:!1,showSkipButton:!1,spotlightClicks:!1,spotlightPadding:10},Eve={continuous:!1,debug:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrolling:!1,disableScrollParentFix:!1,getHelpers:void 0,hideBackButton:!1,run:!0,scrollOffset:20,scrollDuration:300,scrollToFirstStep:!1,showSkipButton:!1,showProgress:!1,spotlightClicks:!1,spotlightPadding:10,steps:[]},Cve={arrowColor:"#fff",backgroundColor:"#fff",beaconSize:36,overlayColor:"rgba(0, 0, 0, 0.5)",primaryColor:"#f04",spotlightShadow:"0 0 15px rgba(0, 0, 0, 0.5)",textColor:"#333",width:380,zIndex:100},e0={backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",cursor:"pointer",fontSize:16,lineHeight:1,padding:8,WebkitAppearance:"none"},YA={borderRadius:4,position:"absolute"};function Pve(e,t){var r,n,i,a,o;const{floaterProps:l,styles:c}=e,d=Po((r=t.floaterProps)!=null?r:{},l!=null?l:{}),u=Po(c!=null?c:{},(n=t.styles)!=null?n:{}),h=Po(Cve,u.options||{}),f=t.placement==="center"||t.disableBeacon;let{width:p}=h;window.innerWidth>480&&(p=380),"width"in h&&(p=typeof h.width=="number"&&window.innerWidth<h.width?window.innerWidth-30:h.width);const x={bottom:0,left:0,overflow:"hidden",position:"absolute",right:0,top:0,zIndex:h.zIndex},g={beacon:W(M({},e0),{display:f?"none":"inline-block",height:h.beaconSize,position:"relative",width:h.beaconSize,zIndex:h.zIndex}),beaconInner:{animation:"joyride-beacon-inner 1.2s infinite ease-in-out",backgroundColor:h.primaryColor,borderRadius:"50%",display:"block",height:"50%",left:"50%",opacity:.7,position:"absolute",top:"50%",transform:"translate(-50%, -50%)",width:"50%"},beaconOuter:{animation:"joyride-beacon-outer 1.2s infinite ease-in-out",backgroundColor:`rgba(${wve(h.primaryColor).join(",")}, 0.2)`,border:`2px solid ${h.primaryColor}`,borderRadius:"50%",boxSizing:"border-box",display:"block",height:"100%",left:0,opacity:.9,position:"absolute",top:0,transformOrigin:"center",width:"100%"},tooltip:{backgroundColor:h.backgroundColor,borderRadius:5,boxSizing:"border-box",color:h.textColor,fontSize:16,maxWidth:"100%",padding:15,position:"relative",width:p},tooltipContainer:{lineHeight:1.4,textAlign:"center"},tooltipTitle:{fontSize:18,margin:0},tooltipContent:{padding:"20px 10px"},tooltipFooter:{alignItems:"center",display:"flex",justifyContent:"flex-end",marginTop:15},tooltipFooterSpacer:{flex:1},buttonNext:W(M({},e0),{backgroundColor:h.primaryColor,borderRadius:4,color:"#fff"}),buttonBack:W(M({},e0),{color:h.primaryColor,marginLeft:"auto",marginRight:5}),buttonClose:W(M({},e0),{color:h.textColor,height:14,padding:15,position:"absolute",right:0,top:0,width:14}),buttonSkip:W(M({},e0),{color:h.textColor,fontSize:14}),overlay:W(M({},x),{backgroundColor:h.overlayColor,mixBlendMode:"hard-light"}),overlayLegacy:M({},x),overlayLegacyCenter:W(M({},x),{backgroundColor:h.overlayColor}),spotlight:W(M({},YA),{backgroundColor:"gray"}),spotlightLegacy:W(M({},YA),{boxShadow:`0 0 0 9999px ${h.overlayColor}, ${h.spotlightShadow}`}),floaterStyles:{arrow:{color:(o=(a=(i=d==null?void 0:d.styles)==null?void 0:i.arrow)==null?void 0:a.color)!=null?o:h.arrowColor},options:{zIndex:h.zIndex+100}},options:h};return Po(g,u)}function Ave(e){return jve(e,"beaconComponent","disableCloseOnEsc","disableOverlay","disableOverlayClose","disableScrolling","disableScrollParentFix","floaterProps","hideBackButton","hideCloseButton","locale","showProgress","showSkipButton","spotlightClicks","spotlightPadding","styles","tooltipComponent")}function Ff(e,t){var r,n,i,a,o,l;const c=t!=null?t:{},d=Po.all([kve,Ave(e),c],{isMergeableObject:Wt.plainObject}),u=Pve(e,d),h=j1(sc(d.target),d.disableScrollParentFix),f=Po.all([Sve,(r=e.floaterProps)!=null?r:{},(n=d.floaterProps)!=null?n:{}]);return f.offset=d.offset,f.styles=Po((i=f.styles)!=null?i:{},u.floaterStyles),f.offset+=(o=(a=e.spotlightPadding)!=null?a:d.spotlightPadding)!=null?o:0,d.placementBeacon&&f.wrapperOptions&&(f.wrapperOptions.placement=d.placementBeacon),h&&f.options.preventOverflow&&(f.options.preventOverflow.boundariesElement="window"),W(M({},d),{locale:Po.all([wV,(l=e.locale)!=null?l:{},d.locale||{}]),floaterProps:f,styles:_V(u,"floaterStyles")})}function bV(e,t=!1){return Wt.plainObject(e)?e.target?!0:(Xu({title:"validateStep",data:"target is missing from the step",warn:!0,debug:t}),!1):(Xu({title:"validateStep",data:"step must be an object",warn:!0,debug:t}),!1)}function KA(e,t=!1){return Wt.array(e)?e.every(r=>bV(r,t)):(Xu({title:"validateSteps",data:"steps must be an array",warn:!0,debug:t}),!1)}var jV={action:"init",controlled:!1,index:0,lifecycle:br.INIT,origin:null,size:0,status:Mr.IDLE},ZA=bve(_V(jV,"controlled","size")),Tve=class{constructor(e){Gt(this,"beaconPopper"),Gt(this,"tooltipPopper"),Gt(this,"data",new Map),Gt(this,"listener"),Gt(this,"store",new Map),Gt(this,"addListener",i=>{this.listener=i}),Gt(this,"setSteps",i=>{const{size:a,status:o}=this.getState(),l={size:i.length,status:o};this.data.set("steps",i),o===Mr.WAITING&&!a&&i.length&&(l.status=Mr.RUNNING),this.setState(l)}),Gt(this,"getPopper",i=>i==="beacon"?this.beaconPopper:this.tooltipPopper),Gt(this,"setPopper",(i,a)=>{i==="beacon"?this.beaconPopper=a:this.tooltipPopper=a}),Gt(this,"cleanupPoppers",()=>{this.beaconPopper=null,this.tooltipPopper=null}),Gt(this,"close",(i=null)=>{const{index:a,status:o}=this.getState();o===Mr.RUNNING&&this.setState(M({},this.getNextState({action:Jr.CLOSE,index:a+1,origin:i})))}),Gt(this,"go",i=>{const{controlled:a,status:o}=this.getState();if(a||o!==Mr.RUNNING)return;const l=this.getSteps()[i];this.setState(W(M({},this.getNextState({action:Jr.GO,index:i})),{status:l?o:Mr.FINISHED}))}),Gt(this,"info",()=>this.getState()),Gt(this,"next",()=>{const{index:i,status:a}=this.getState();a===Mr.RUNNING&&this.setState(this.getNextState({action:Jr.NEXT,index:i+1}))}),Gt(this,"open",()=>{const{status:i}=this.getState();i===Mr.RUNNING&&this.setState(M({},this.getNextState({action:Jr.UPDATE,lifecycle:br.TOOLTIP})))}),Gt(this,"prev",()=>{const{index:i,status:a}=this.getState();a===Mr.RUNNING&&this.setState(M({},this.getNextState({action:Jr.PREV,index:i-1})))}),Gt(this,"reset",(i=!1)=>{const{controlled:a}=this.getState();a||this.setState(W(M({},this.getNextState({action:Jr.RESET,index:0})),{status:i?Mr.RUNNING:Mr.READY}))}),Gt(this,"skip",()=>{const{status:i}=this.getState();i===Mr.RUNNING&&this.setState({action:Jr.SKIP,lifecycle:br.INIT,status:Mr.SKIPPED})}),Gt(this,"start",i=>{const{index:a,size:o}=this.getState();this.setState(W(M({},this.getNextState({action:Jr.START,index:Wt.number(i)?i:a},!0)),{status:o?Mr.RUNNING:Mr.WAITING}))}),Gt(this,"stop",(i=!1)=>{const{index:a,status:o}=this.getState();[Mr.FINISHED,Mr.SKIPPED].includes(o)||this.setState(W(M({},this.getNextState({action:Jr.STOP,index:a+(i?1:0)})),{status:Mr.PAUSED}))}),Gt(this,"update",i=>{var a,o;if(!_ve(i,ZA))throw new Error(`State is not valid. Valid keys: ${ZA.join(", ")}`);this.setState(M({},this.getNextState(W(M(M({},this.getState()),i),{action:(a=i.action)!=null?a:Jr.UPDATE,origin:(o=i.origin)!=null?o:null}),!0)))});const{continuous:t=!1,stepIndex:r,steps:n=[]}=e!=null?e:{};this.setState({action:Jr.INIT,controlled:Wt.number(r),continuous:t,index:Wt.number(r)?r:0,lifecycle:br.INIT,origin:null,status:n.length?Mr.READY:Mr.IDLE},!0),this.beaconPopper=null,this.tooltipPopper=null,this.listener=null,this.setSteps(n)}getState(){return this.store.size?{action:this.store.get("action")||"",controlled:this.store.get("controlled")||!1,index:parseInt(this.store.get("index"),10),lifecycle:this.store.get("lifecycle")||"",origin:this.store.get("origin")||null,size:this.store.get("size")||0,status:this.store.get("status")||""}:M({},jV)}getNextState(e,t=!1){var r,n,i,a,o;const{action:l,controlled:c,index:d,size:u,status:h}=this.getState(),f=Wt.number(e.index)?e.index:d,p=c&&!t?d:Math.min(Math.max(f,0),u);return{action:(r=e.action)!=null?r:l,controlled:c,index:p,lifecycle:(n=e.lifecycle)!=null?n:br.INIT,origin:(i=e.origin)!=null?i:null,size:(a=e.size)!=null?a:u,status:p===u?Mr.FINISHED:(o=e.status)!=null?o:h}}getSteps(){const e=this.data.get("steps");return Array.isArray(e)?e:[]}hasUpdatedState(e){const t=JSON.stringify(e),r=JSON.stringify(this.getState());return t!==r}setState(e,t=!1){const r=this.getState(),{action:n,index:i,lifecycle:a,origin:o=null,size:l,status:c}=M(M({},r),e);this.store.set("action",n),this.store.set("index",i),this.store.set("lifecycle",a),this.store.set("origin",o),this.store.set("size",l),this.store.set("status",c),t&&(this.store.set("controlled",e.controlled),this.store.set("continuous",e.continuous)),this.listener&&this.hasUpdatedState(r)&&this.listener(this.getState())}getHelpers(){return{close:this.close,go:this.go,info:this.info,next:this.next,open:this.open,prev:this.prev,reset:this.reset,skip:this.skip}}};function Ove(e){return new Tve(e)}function Rve({styles:e}){return y.createElement("div",{key:"JoyrideSpotlight",className:"react-joyride__spotlight","data-test-id":"spotlight",style:e})}var Mve=Rve,Dve=class extends y.Component{constructor(){super(...arguments),Gt(this,"isActive",!1),Gt(this,"resizeTimeout"),Gt(this,"scrollTimeout"),Gt(this,"scrollParent"),Gt(this,"state",{isScrolling:!1,mouseOverSpotlight:!1,showSpotlight:!0}),Gt(this,"hideSpotlight",()=>{const{continuous:e,disableOverlay:t,lifecycle:r}=this.props,n=[br.INIT,br.BEACON,br.COMPLETE,br.ERROR];return t||(e?n.includes(r):r!==br.TOOLTIP)}),Gt(this,"handleMouseMove",e=>{const{mouseOverSpotlight:t}=this.state,{height:r,left:n,position:i,top:a,width:o}=this.spotlightStyles,l=i==="fixed"?e.clientY:e.pageY,c=i==="fixed"?e.clientX:e.pageX,d=l>=a&&l<=a+r,h=c>=n&&c<=n+o&&d;h!==t&&this.updateState({mouseOverSpotlight:h})}),Gt(this,"handleScroll",()=>{const{target:e}=this.props,t=sc(e);if(this.scrollParent!==document){const{isScrolling:r}=this.state;r||this.updateState({isScrolling:!0,showSpotlight:!1}),clearTimeout(this.scrollTimeout),this.scrollTimeout=window.setTimeout(()=>{this.updateState({isScrolling:!1,showSpotlight:!0})},50)}else fm(t,"sticky")&&this.updateState({})}),Gt(this,"handleResize",()=>{clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(()=>{this.isActive&&this.forceUpdate()},100)})}componentDidMount(){const{debug:e,disableScrolling:t,disableScrollParentFix:r=!1,target:n}=this.props,i=sc(n);this.scrollParent=Pg(i!=null?i:document.body,r,!0),this.isActive=!0,window.addEventListener("resize",this.handleResize)}componentDidUpdate(e){var t;const{disableScrollParentFix:r,lifecycle:n,spotlightClicks:i,target:a}=this.props,{changed:o}=G2(e,this.props);if(o("target")||o("disableScrollParentFix")){const l=sc(a);this.scrollParent=Pg(l!=null?l:document.body,r,!0)}o("lifecycle",br.TOOLTIP)&&((t=this.scrollParent)==null||t.addEventListener("scroll",this.handleScroll,{passive:!0}),setTimeout(()=>{const{isScrolling:l}=this.state;l||this.updateState({showSpotlight:!0})},100)),(o("spotlightClicks")||o("disableOverlay")||o("lifecycle"))&&(i&&n===br.TOOLTIP?window.addEventListener("mousemove",this.handleMouseMove,!1):n!==br.TOOLTIP&&window.removeEventListener("mousemove",this.handleMouseMove))}componentWillUnmount(){var e;this.isActive=!1,window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("resize",this.handleResize),clearTimeout(this.resizeTimeout),clearTimeout(this.scrollTimeout),(e=this.scrollParent)==null||e.removeEventListener("scroll",this.handleScroll)}get overlayStyles(){const{mouseOverSpotlight:e}=this.state,{disableOverlayClose:t,placement:r,styles:n}=this.props;let i=n.overlay;return GA()&&(i=r==="center"?n.overlayLegacyCenter:n.overlayLegacy),M({cursor:t?"default":"pointer",height:hve(),pointerEvents:e?"none":"auto"},i)}get spotlightStyles(){var e,t,r;const{showSpotlight:n}=this.state,{disableScrollParentFix:i=!1,spotlightClicks:a,spotlightPadding:o=0,styles:l,target:c}=this.props,d=sc(c),u=xV(d),h=fm(d),f=vve(d,o,i);return W(M({},GA()?l.spotlightLegacy:l.spotlight),{height:Math.round(((e=u==null?void 0:u.height)!=null?e:0)+o*2),left:Math.round(((t=u==null?void 0:u.left)!=null?t:0)-o),opacity:n?1:0,pointerEvents:a?"none":"auto",position:h?"fixed":"absolute",top:f,transition:"opacity 0.2s",width:Math.round(((r=u==null?void 0:u.width)!=null?r:0)+o*2)})}updateState(e){this.isActive&&this.setState(t=>M(M({},t),e))}render(){const{showSpotlight:e}=this.state,{onClickOverlay:t,placement:r}=this.props,{hideSpotlight:n,overlayStyles:i,spotlightStyles:a}=this;if(n())return null;let o=r!=="center"&&e&&y.createElement(Mve,{styles:a});if(yV()==="safari"){const l=i,{mixBlendMode:c,zIndex:d}=l,u=me(l,["mixBlendMode","zIndex"]);o=y.createElement("div",{style:M({},u)},o),delete i.backgroundColor}return y.createElement("div",{className:"react-joyride__overlay","data-test-id":"overlay",onClick:t,role:"presentation",style:i},o)}},Ive=class extends y.Component{constructor(){super(...arguments),Gt(this,"node",null)}componentDidMount(){const{id:e}=this.props;Qc()&&(this.node=document.createElement("div"),this.node.id=e,document.body.appendChild(this.node),Qp||this.renderReact15())}componentDidUpdate(){Qc()&&(Qp||this.renderReact15())}componentWillUnmount(){!Qc()||!this.node||(Qp||Ya.unmountComponentAtNode(this.node),this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=null))}renderReact15(){if(!Qc())return;const{children:e}=this.props;this.node&&Ya.unstable_renderSubtreeIntoContainer(this,e,this.node)}renderReact16(){if(!Qc()||!Qp)return null;const{children:e}=this.props;return this.node?Ya.createPortal(e,this.node):null}render(){return Qp?this.renderReact16():null}},$ve=class{constructor(e,t){if(Gt(this,"element"),Gt(this,"options"),Gt(this,"canBeTabbed",r=>{const{tabIndex:n}=r;return n===null||n<0?!1:this.canHaveFocus(r)}),Gt(this,"canHaveFocus",r=>{const n=/input|select|textarea|button|object/,i=r.nodeName.toLowerCase();return(n.test(i)&&!r.getAttribute("disabled")||i==="a"&&!!r.getAttribute("href"))&&this.isVisible(r)}),Gt(this,"findValidTabElements",()=>[].slice.call(this.element.querySelectorAll("*"),0).filter(this.canBeTabbed)),Gt(this,"handleKeyDown",r=>{const{code:n="Tab"}=this.options;r.code===n&&this.interceptTab(r)}),Gt(this,"interceptTab",r=>{r.preventDefault();const n=this.findValidTabElements(),{shiftKey:i}=r;if(!n.length)return;let a=document.activeElement?n.indexOf(document.activeElement):0;a===-1||!i&&a+1===n.length?a=0:i&&a===0?a=n.length-1:a+=i?-1:1,n[a].focus()}),Gt(this,"isHidden",r=>{const n=r.offsetWidth<=0&&r.offsetHeight<=0,i=window.getComputedStyle(r);return n&&!r.innerHTML?!0:n&&i.getPropertyValue("overflow")!=="visible"||i.getPropertyValue("display")==="none"}),Gt(this,"isVisible",r=>{let n=r;for(;n;)if(n instanceof HTMLElement){if(n===document.body)break;if(this.isHidden(n))return!1;n=n.parentNode}return!0}),Gt(this,"removeScope",()=>{window.removeEventListener("keydown",this.handleKeyDown)}),Gt(this,"checkFocus",r=>{document.activeElement!==r&&(r.focus(),window.requestAnimationFrame(()=>this.checkFocus(r)))}),Gt(this,"setFocus",()=>{const{selector:r}=this.options;if(!r)return;const n=this.element.querySelector(r);n&&window.requestAnimationFrame(()=>this.checkFocus(n))}),!(e instanceof HTMLElement))throw new TypeError("Invalid parameter: element must be an HTMLElement");this.element=e,this.options=t,window.addEventListener("keydown",this.handleKeyDown,!1),this.setFocus()}},Lve=class extends y.Component{constructor(e){if(super(e),Gt(this,"beacon",null),Gt(this,"setBeaconRef",i=>{this.beacon=i}),e.beaconComponent)return;const t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.id="joyride-beacon-animation",e.nonce&&r.setAttribute("nonce",e.nonce),r.appendChild(document.createTextNode(`
        @keyframes joyride-beacon-inner {
          20% {
            opacity: 0.9;
          }
        
          90% {
            opacity: 0.7;
          }
        }
        
        @keyframes joyride-beacon-outer {
          0% {
            transform: scale(1);
          }
        
          45% {
            opacity: 0.7;
            transform: scale(0.75);
          }
        
          100% {
            opacity: 0.9;
            transform: scale(1);
          }
        }
      `)),t.appendChild(r)}componentDidMount(){const{shouldFocus:e}=this.props;setTimeout(()=>{Wt.domElement(this.beacon)&&e&&this.beacon.focus()},0)}componentWillUnmount(){const e=document.getElementById("joyride-beacon-animation");e!=null&&e.parentNode&&e.parentNode.removeChild(e)}render(){const{beaconComponent:e,continuous:t,index:r,isLastStep:n,locale:i,onClickOrHover:a,size:o,step:l,styles:c}=this.props,d=nl(i.open),u={"aria-label":d,onClick:a,onMouseEnter:a,ref:this.setBeaconRef,title:d};let h;if(e){const f=e;h=y.createElement(f,M({continuous:t,index:r,isLastStep:n,size:o,step:l},u))}else h=y.createElement("button",M({key:"JoyrideBeacon",className:"react-joyride__beacon","data-test-id":"button-beacon",style:c.beacon,type:"button"},u),y.createElement("span",{style:c.beaconInner}),y.createElement("span",{style:c.beaconOuter}));return h}};function Fve(r){var n=r,{styles:e}=n,t=me(n,["styles"]);const c=e,{color:i,height:a,width:o}=c,l=me(c,["color","height","width"]);return Q.createElement("button",M({style:l,type:"button"},t),Q.createElement("svg",{height:typeof a=="number"?`${a}px`:a,preserveAspectRatio:"xMidYMid",version:"1.1",viewBox:"0 0 18 18",width:typeof o=="number"?`${o}px`:o,xmlns:"http://www.w3.org/2000/svg"},Q.createElement("g",null,Q.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:i}))))}var Uve=Fve;function Bve(e){const{backProps:t,closeProps:r,index:n,isLastStep:i,primaryProps:a,skipProps:o,step:l,tooltipProps:c}=e,{content:d,hideBackButton:u,hideCloseButton:h,hideFooter:f,showSkipButton:p,styles:x,title:g}=l,v={};return v.primary=y.createElement("button",M({"data-test-id":"button-primary",style:x.buttonNext,type:"button"},a)),p&&!i&&(v.skip=y.createElement("button",M({"aria-live":"off","data-test-id":"button-skip",style:x.buttonSkip,type:"button"},o))),!u&&n>0&&(v.back=y.createElement("button",M({"data-test-id":"button-back",style:x.buttonBack,type:"button"},t))),v.close=!h&&y.createElement(Uve,M({"data-test-id":"button-close",styles:x.buttonClose},r)),y.createElement("div",M({key:"JoyrideTooltip","aria-label":nl(g!=null?g:d),className:"react-joyride__tooltip",style:x.tooltip},c),y.createElement("div",{style:x.tooltipContainer},g&&y.createElement("h1",{"aria-label":nl(g),style:x.tooltipTitle},g),y.createElement("div",{style:x.tooltipContent},d)),!f&&y.createElement("div",{style:x.tooltipFooter},y.createElement("div",{style:x.tooltipFooterSpacer},v.skip),v.back,v.primary),v.close)}var zve=Bve,Vve=class extends y.Component{constructor(){super(...arguments),Gt(this,"handleClickBack",e=>{e.preventDefault();const{helpers:t}=this.props;t.prev()}),Gt(this,"handleClickClose",e=>{e.preventDefault();const{helpers:t}=this.props;t.close("button_close")}),Gt(this,"handleClickPrimary",e=>{e.preventDefault();const{continuous:t,helpers:r}=this.props;if(!t){r.close("button_primary");return}r.next()}),Gt(this,"handleClickSkip",e=>{e.preventDefault();const{helpers:t}=this.props;t.skip()}),Gt(this,"getElementsProps",()=>{const{continuous:e,index:t,isLastStep:r,setTooltipRef:n,size:i,step:a}=this.props,{back:o,close:l,last:c,next:d,nextLabelWithProgress:u,skip:h}=a.locale,f=nl(o),p=nl(l),x=nl(c),g=nl(d),v=nl(h);let _=l,w=p;if(e){if(_=d,w=g,a.showProgress&&!r){const b=nl(u,{step:t+1,steps:i});_=mS(u,t+1,i),w=b}r&&(_=c,w=x)}return{backProps:{"aria-label":f,children:o,"data-action":"back",onClick:this.handleClickBack,role:"button",title:f},closeProps:{"aria-label":p,children:l,"data-action":"close",onClick:this.handleClickClose,role:"button",title:p},primaryProps:{"aria-label":w,children:_,"data-action":"primary",onClick:this.handleClickPrimary,role:"button",title:w},skipProps:{"aria-label":v,children:h,"data-action":"skip",onClick:this.handleClickSkip,role:"button",title:v},tooltipProps:{"aria-modal":!0,ref:n,role:"alertdialog"}}})}render(){const{continuous:e,index:t,isLastStep:r,setTooltipRef:n,size:i,step:a}=this.props,u=a,{beaconComponent:o,tooltipComponent:l}=u,c=me(u,["beaconComponent","tooltipComponent"]);let d;if(l){const h=W(M({},this.getElementsProps()),{continuous:e,index:t,isLastStep:r,size:i,step:c,setTooltipRef:n}),f=l;d=y.createElement(f,M({},h))}else d=y.createElement(zve,W(M({},this.getElementsProps()),{continuous:e,index:t,isLastStep:r,size:i,step:a}));return d}},qve=class extends y.Component{constructor(){super(...arguments),Gt(this,"scope",null),Gt(this,"tooltip",null),Gt(this,"handleClickHoverBeacon",e=>{const{step:t,store:r}=this.props;e.type==="mouseenter"&&t.event!=="hover"||r.update({lifecycle:br.TOOLTIP})}),Gt(this,"setTooltipRef",e=>{this.tooltip=e}),Gt(this,"setPopper",(e,t)=>{var r;const{action:n,lifecycle:i,step:a,store:o}=this.props;t==="wrapper"?o.setPopper("beacon",e):o.setPopper("tooltip",e),o.getPopper("beacon")&&(o.getPopper("tooltip")||a.placement==="center")&&i===br.INIT&&o.update({action:n,lifecycle:br.READY}),(r=a.floaterProps)!=null&&r.getPopper&&a.floaterProps.getPopper(e,t)}),Gt(this,"renderTooltip",e=>{const{continuous:t,helpers:r,index:n,size:i,step:a}=this.props;return y.createElement(Vve,M({continuous:t,helpers:r,index:n,isLastStep:n+1===i,setTooltipRef:this.setTooltipRef,size:i,step:a},e))})}componentDidMount(){const{debug:e,index:t}=this.props;Xu({title:`step:${t}`,data:[{key:"props",value:this.props}],debug:e})}componentDidUpdate(e){var t;const{action:r,callback:n,continuous:i,controlled:a,debug:o,helpers:l,index:c,lifecycle:d,shouldScroll:u,status:h,step:f,store:p}=this.props,{changed:x,changedFrom:g}=G2(e,this.props),v=l.info(),_=i&&r!==Jr.CLOSE&&(c>0||r===Jr.PREV),w=x("action")||x("index")||x("lifecycle")||x("status"),b=g("lifecycle",[br.TOOLTIP,br.INIT],br.INIT),N=x("action",[Jr.NEXT,Jr.PREV,Jr.SKIP,Jr.CLOSE]),S=a&&c===e.index;if(N&&(b||S)&&n(W(M({},v),{index:e.index,lifecycle:br.COMPLETE,step:e.step,type:Os.STEP_AFTER})),f.placement==="center"&&h===Mr.RUNNING&&x("index")&&r!==Jr.START&&d===br.INIT&&p.update({lifecycle:br.READY}),w){const k=sc(f.target),O=!!k;O&&gve(k)?(g("status",Mr.READY,Mr.RUNNING)||g("lifecycle",br.INIT,br.READY))&&n(W(M({},v),{step:f,type:Os.STEP_BEFORE})):(console.warn(O?"Target not visible":"Target not mounted",f),n(W(M({},v),{type:Os.TARGET_NOT_FOUND,step:f})),a||p.update({index:c+(r===Jr.PREV?-1:1)}))}g("lifecycle",br.INIT,br.READY)&&p.update({lifecycle:HA(f)||_?br.TOOLTIP:br.BEACON}),x("index")&&Xu({title:`step:${d}`,data:[{key:"props",value:this.props}],debug:o}),x("lifecycle",br.BEACON)&&n(W(M({},v),{step:f,type:Os.BEACON})),x("lifecycle",br.TOOLTIP)&&(n(W(M({},v),{step:f,type:Os.TOOLTIP})),u&&this.tooltip&&(this.scope=new $ve(this.tooltip,{selector:"[data-action=primary]"}),this.scope.setFocus())),g("lifecycle",[br.TOOLTIP,br.INIT],br.INIT)&&((t=this.scope)==null||t.removeScope(),p.cleanupPoppers())}componentWillUnmount(){var e;(e=this.scope)==null||e.removeScope()}get open(){const{lifecycle:e,step:t}=this.props;return HA(t)||e===br.TOOLTIP}render(){const{continuous:e,debug:t,index:r,nonce:n,shouldScroll:i,size:a,step:o}=this.props,l=sc(o.target);return!bV(o)||!Wt.domElement(l)?null:y.createElement("div",{key:`JoyrideStep-${r}`,className:"react-joyride__step"},y.createElement(P4,W(M({},o.floaterProps),{component:this.renderTooltip,debug:t,getPopper:this.setPopper,id:`react-joyride-step-${r}`,open:this.open,placement:o.placement,target:o.target}),y.createElement(Lve,{beaconComponent:o.beaconComponent,continuous:e,index:r,isLastStep:r+1===a,locale:o.locale,nonce:n,onClickOrHover:this.handleClickHoverBeacon,shouldFocus:i,size:a,step:o,styles:o.styles})))}},NV=class extends y.Component{constructor(e){super(e),Gt(this,"helpers"),Gt(this,"store"),Gt(this,"callback",o=>{const{callback:l}=this.props;Wt.function(l)&&l(o)}),Gt(this,"handleKeyboard",o=>{const{index:l,lifecycle:c}=this.state,{steps:d}=this.props,u=d[l];c===br.TOOLTIP&&o.code==="Escape"&&u&&!u.disableCloseOnEsc&&this.store.close("keyboard")}),Gt(this,"handleClickOverlay",()=>{const{index:o}=this.state,{steps:l}=this.props;Ff(this.props,l[o]).disableOverlayClose||this.helpers.close("overlay")}),Gt(this,"syncState",o=>{this.setState(o)});const{debug:t,getHelpers:r,run:n=!0,stepIndex:i}=e;this.store=Ove(W(M({},e),{controlled:n&&Wt.number(i)})),this.helpers=this.store.getHelpers();const{addListener:a}=this.store;Xu({title:"init",data:[{key:"props",value:this.props},{key:"state",value:this.state}],debug:t}),a(this.syncState),r&&r(this.helpers),this.state=this.store.getState()}componentDidMount(){if(!Qc())return;const{debug:e,disableCloseOnEsc:t,run:r,steps:n}=this.props,{start:i}=this.store;KA(n,e)&&r&&i(),t||document.body.addEventListener("keydown",this.handleKeyboard,{passive:!0})}componentDidUpdate(e,t){if(!Qc())return;const{action:r,controlled:n,index:i,status:a}=this.state,{debug:o,run:l,stepIndex:c,steps:d}=this.props,{stepIndex:u,steps:h}=e,{reset:f,setSteps:p,start:x,stop:g,update:v}=this.store,{changed:_}=G2(e,this.props),{changed:w,changedFrom:b}=G2(t,this.state),N=Ff(this.props,d[i]),S=!Ti(h,d),k=Wt.number(c)&&_("stepIndex"),O=sc(N.target);if(S&&(KA(d,o)?p(d):console.warn("Steps are not valid",d)),_("run")&&(l?x(c):g()),k){let $=Wt.number(u)&&u<c?Jr.NEXT:Jr.PREV;r===Jr.STOP&&($=Jr.START),[Mr.FINISHED,Mr.SKIPPED].includes(a)||v({action:r===Jr.CLOSE?Jr.CLOSE:$,index:c,lifecycle:br.INIT})}!n&&a===Mr.RUNNING&&i===0&&!O&&(this.store.update({index:i+1}),this.callback(W(M({},this.state),{type:Os.TARGET_NOT_FOUND,step:N})));const A=W(M({},this.state),{index:i,step:N});if(w("action",[Jr.NEXT,Jr.PREV,Jr.SKIP,Jr.CLOSE])&&w("status",Mr.PAUSED)){const $=Ff(this.props,d[t.index]);this.callback(W(M({},A),{index:t.index,lifecycle:br.COMPLETE,step:$,type:Os.STEP_AFTER}))}if(w("status",[Mr.FINISHED,Mr.SKIPPED])){const $=Ff(this.props,d[t.index]);n||this.callback(W(M({},A),{index:t.index,lifecycle:br.COMPLETE,step:$,type:Os.STEP_AFTER})),this.callback(W(M({},A),{type:Os.TOUR_END,step:$,index:t.index})),f()}else b("status",[Mr.IDLE,Mr.READY],Mr.RUNNING)?this.callback(W(M({},A),{type:Os.TOUR_START})):(w("status")||w("action",Jr.RESET))&&this.callback(W(M({},A),{type:Os.TOUR_STATUS}));this.scrollToStep(t)}componentWillUnmount(){const{disableCloseOnEsc:e}=this.props;e||document.body.removeEventListener("keydown",this.handleKeyboard)}scrollToStep(e){const{index:t,lifecycle:r,status:n}=this.state,{debug:i,disableScrollParentFix:a=!1,scrollDuration:o,scrollOffset:l=20,scrollToFirstStep:c=!1,steps:d}=this.props,u=Ff(this.props,d[t]),h=sc(u.target),f=Nve({isFirstStep:t===0,lifecycle:r,previousLifecycle:e.lifecycle,scrollToFirstStep:c,step:u,target:h});if(n===Mr.RUNNING&&f){const p=j1(h,a),x=Pg(h,a);let g=Math.floor(xve(h,l,a))||0;Xu({title:"scrollToStep",data:[{key:"index",value:t},{key:"lifecycle",value:r},{key:"status",value:n}],debug:i});const v=this.store.getPopper("beacon"),_=this.store.getPopper("tooltip");if(r===br.BEACON&&v){const{offsets:w,placement:b}=v;!["bottom"].includes(b)&&!p&&(g=Math.floor(w.popper.top-l))}else if(r===br.TOOLTIP&&_){const{flipped:w,offsets:b,placement:N}=_;["top","right","left"].includes(N)&&!w&&!p?g=Math.floor(b.popper.top-l):g-=u.spotlightPadding}g=g>=0?g:0,n===Mr.RUNNING&&yve(g,{element:x,duration:o}).then(()=>{setTimeout(()=>{var w;(w=this.store.getPopper("tooltip"))==null||w.instance.update()},10)})}}render(){if(!Qc())return null;const{index:e,lifecycle:t,status:r}=this.state,{continuous:n=!1,debug:i=!1,nonce:a,scrollToFirstStep:o=!1,steps:l}=this.props,c=r===Mr.RUNNING,d={};if(c&&l[e]){const u=Ff(this.props,l[e]);d.step=y.createElement(qve,W(M({},this.state),{callback:this.callback,continuous:n,debug:i,helpers:this.helpers,nonce:a,shouldScroll:!u.disableScrolling&&(e!==0||o),step:u,store:this.store})),d.overlay=y.createElement(Ive,{id:"react-joyride-portal"},y.createElement(Dve,W(M({},u),{continuous:n,debug:i,lifecycle:t,onClickOverlay:this.handleClickOverlay})))}return y.createElement("div",{className:"react-joyride"},d.step,d.overlay)}};Gt(NV,"defaultProps",Eve);var Wve=NV;class mu{static checkOnboardingStatus(t){return E(this,null,function*(){var r,n,i,a;try{const{data:o,error:l}=yield P.from("users").select("onboarding_completed, onboarding_skipped, tour_completed").eq("user_id",t).single();if(l){if(l.code==="42703"||(r=l.message)!=null&&r.includes("does not exist"))return console.warn("Onboarding columns not found in users table, returning defaults"),{onboarding_completed:!1,onboarding_skipped:!1,tour_completed:!1};throw l}return{onboarding_completed:(n=o==null?void 0:o.onboarding_completed)!=null?n:!1,onboarding_skipped:(i=o==null?void 0:o.onboarding_skipped)!=null?i:!1,tour_completed:(a=o==null?void 0:o.tour_completed)!=null?a:!1}}catch(o){return console.error("Error checking onboarding status:",o),{onboarding_completed:!1,onboarding_skipped:!1,tour_completed:!1}}})}static saveProfileSetup(t,r){return E(this,null,function*(){var n,a,o,l;try{const c={updated_at:new Date().toISOString()};r.username!==void 0&&(c.username=String(r.username).toLowerCase().trim()),r.birthday!==void 0&&(c.birthday=r.birthday),r.gender!==void 0&&(c.gender=r.gender),r.bio!==void 0&&(c.bio=r.bio),r.avatar_url!==void 0&&(c.avatar_url=r.avatar_url),r.location_city!==void 0&&(c.location_city=r.location_city);const{error:d}=yield P.from("users").update(c).eq("user_id",t);if(d){if(d.code==="PGRST204"||(n=d.message)!=null&&n.includes("does not exist")){console.warn("Some columns not found, trying without them:",d.message);const i=c,{username:u,location_city:h}=i,f=me(i,["username","location_city"]),{error:p}=yield P.from("users").update(f).eq("user_id",t);if(p)throw p.code==="23505"&&((a=p.message)!=null&&a.includes("username"))?new Error("Username is already taken"):p;return!0}throw d.code==="23505"&&((o=d.message)!=null&&o.includes("username"))?new Error("Username is already taken"):d}return!0}catch(c){if(console.error("Error saving profile setup:",c),(l=c==null?void 0:c.message)!=null&&l.includes("Username is already taken"))throw c;return!1}})}static requestAccountUpgrade(t,r,n){return E(this,null,function*(){try{const{error:i}=yield P.from("account_upgrade_requests").insert({user_id:t,requested_account_type:r,business_info:n,status:"pending"});if(i)throw i;return!0}catch(i){return console.error("Error requesting account upgrade:",i),!1}})}static skipOnboarding(t){return E(this,null,function*(){var r;try{const{error:n}=yield P.from("users").update({onboarding_skipped:!0,updated_at:new Date().toISOString()}).eq("user_id",t);if(n){if(n.code==="42703"||(r=n.message)!=null&&r.includes("does not exist"))return console.warn("onboarding_skipped column not found, skipping update"),!0;throw n}return!0}catch(n){return console.error("Error skipping onboarding:",n),!1}})}static completeOnboarding(t){return E(this,null,function*(){var r;try{const{error:n}=yield P.from("users").update({onboarding_completed:!0,onboarding_skipped:!1,updated_at:new Date().toISOString()}).eq("user_id",t);if(n){if(n.code==="42703"||(r=n.message)!=null&&r.includes("does not exist"))return console.warn("onboarding_completed column not found, skipping update"),!0;throw n}return!0}catch(n){return console.error("Error completing onboarding:",n),!1}})}static completeTour(t){return E(this,null,function*(){var r;try{const{error:n}=yield P.from("users").update({tour_completed:!0,updated_at:new Date().toISOString()}).eq("user_id",t);if(n){if(n.code==="42703"||(r=n.message)!=null&&r.includes("does not exist"))return console.warn("tour_completed column not found, skipping update"),!0;throw n}return!0}catch(n){return console.error("Error completing tour:",n),!1}})}static hasPendingUpgradeRequest(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("account_upgrade_requests").select("id, status").eq("user_id",t).eq("status","pending").maybeSingle();if(n)throw n;return r!==null}catch(r){return console.error("Error checking pending upgrade request:",r),!1}})}static saveMusicPreferences(t,r,n){return E(this,null,function*(){try{const i=[],a=new Date().toISOString();if(r.forEach((o,l)=>{const c=Math.max(10-l,1);i.push({user_id:t,signal_type:"genre_manual_preference",entity_type:"genre",entity_id:null,entity_name:o,signal_weight:c,genre:o,context:{source:"onboarding",order:l+1},occurred_at:a,created_at:a,updated_at:a})}),n.forEach((o,l)=>{const c=Math.max(10-l,1);i.push({user_id:t,signal_type:"artist_manual_preference",entity_type:"artist",entity_id:o.id||null,entity_name:o.name,signal_weight:c,genre:null,context:{source:"onboarding",order:l+1},occurred_at:a,created_at:a,updated_at:a})}),i.length>0){const{error:o}=yield P.from("user_preference_signals").insert(i);if(o)return console.error("Error saving music preferences:",o),!1}return!0}catch(i){return console.error("Error saving music preferences:",i),!1}})}}const Uf=(e,t=8e3,r=50)=>new Promise((n,i)=>{const a=Date.now(),o=document.querySelector(e);if(o&&o.offsetParent!==null&&o.getBoundingClientRect().width>0){n(o);return}const l=new MutationObserver(()=>{const d=document.querySelector(e);if(d){const u=d.getBoundingClientRect();if(d.offsetParent!==null&&u.width>0&&u.height>0){l.disconnect(),n(d);return}}if(Date.now()-a>=t){l.disconnect(),i(new Error(`Timeout waiting for element: ${e}`));return}});l.observe(document.body,{childList:!0,subtree:!0,attributes:!1});const c=setInterval(()=>{const d=document.querySelector(e);if(d){const u=d.getBoundingClientRect();if(d.offsetParent!==null&&u.width>0&&u.height>0){clearInterval(c),l.disconnect(),n(d);return}}Date.now()-a>=t&&(clearInterval(c),l.disconnect(),i(new Error(`Timeout waiting for element: ${e}`)))},r)}),Hve=({run:e,onFinish:t,onViewChange:r})=>{const{user:n}=os(),[i,a]=y.useState(e),[o,l]=y.useState(void 0),[c,d]=y.useState(!1),[u,h]=y.useState(""),f=Q.useRef(null);y.useEffect(()=>{a(e),e||(l(void 0),d(!1),h(""))},[e]),y.useEffect(()=>{if(i&&o===2){const g=setInterval(()=>{(document.querySelector("[data-joyride]")||document.querySelector(".react-joyride__tooltip")||document.querySelector('[role="dialog"]'))&&(console.log("Step 3 tooltip detected, clearing stepIndex for button clicks"),l(void 0),clearInterval(g))},50);return setTimeout(()=>{clearInterval(g),o===2&&(console.log("Timeout clearing stepIndex"),l(void 0))},2e3),()=>clearInterval(g)}},[i,o]),y.useEffect(()=>{i&&f.current===2&&o===void 0&&(console.log("Resuming tour at step 3, setting stepIndex briefly"),l(2),setTimeout(()=>{console.log("Clearing stepIndex after resume"),l(void 0),f.current=null},50))},[i,o]),y.useEffect(()=>{i&&f.current===4&&o===void 0&&(console.log("Resuming tour at step 5, setting stepIndex briefly"),l(4),setTimeout(()=>{console.log("Clearing stepIndex after resume step 5"),l(void 0),f.current=null},50))},[i,o]),y.useEffect(()=>{i&&f.current===5&&o===void 0&&(console.log("Resuming tour at step 6, setting stepIndex briefly"),l(5),setTimeout(()=>{console.log("Clearing stepIndex after resume step 6"),l(void 0),f.current=null},50))},[i,o]);const p=[{target:"body",content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Welcome to Synth! "}),s.jsx("p",{children:"Let's take a quick tour of the app to help you discover shows, connect with friends, and share your concert experiences."})]}),placement:"center",disableBeacon:!0,before:()=>{r&&r("feed")}},{target:'[data-tour="feed-toggle"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Toggle Your Feed"}),s.jsx("p",{children:"Switch between different feed types: Hand Picked Events, Trending Events, Friends Interested, and more. Each feed shows you different perspectives on what's happening."})]}),placement:"bottom",disableBeacon:!0,before:()=>E(void 0,null,function*(){r&&r("feed"),yield new Promise(g=>setTimeout(g,300)),yield new Promise(g=>requestAnimationFrame(g));try{(yield Uf('[data-tour="feed-toggle"]',5e3)).scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(v=>setTimeout(v,400))}catch(g){throw console.error("Step 2: Element not found:",g),g}})},{target:'[data-tour="discover-vibes"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Discover by Vibes"}),s.jsx("p",{children:"Browse Vibes lets you explore events by mood and scene. You can also use the Map & Calendar view to see events by location and date. Try different vibes to find shows that match your energy!"})]}),placement:"bottom",disableBeacon:!0,before:()=>E(void 0,null,function*(){console.log("Step 3 before: Checking if discover view is ready"),r&&r("search"),yield new Promise(_=>setTimeout(_,200)),yield new Promise(_=>requestAnimationFrame(_)),yield new Promise(_=>requestAnimationFrame(_)),console.log("Step 3 before: Waiting for element...");const g=yield Uf('[data-tour="discover-vibes"]',1e4);console.log("Step 3 before: Element found!",g),g.scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(_=>setTimeout(_,400));const v=g.getBoundingClientRect();if(v.width===0||v.height===0||g.offsetParent===null)throw console.error("Step 3 before: Element not visible!",v),new Error("Target element not visible");console.log("Step 3 before: Element verified and ready")})},{target:'[data-tour="create-review"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Share Your Experience"}),s.jsx("p",{children:"Tap the pink plus button to create a review for any show you've attended. Share photos, rate the performance, and let your friends know what you thought!"})]}),placement:"top",disableBeacon:!0,before:()=>E(void 0,null,function*(){r&&r("feed"),yield new Promise(g=>setTimeout(g,300)),yield new Promise(g=>requestAnimationFrame(g));try{(yield Uf('[data-tour="create-review"]',5e3)).scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(v=>setTimeout(v,400))}catch(g){throw console.error("Step 4: Element not found:",g),g}})},{target:'[data-tour="chat"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Connect with Friends"}),s.jsx("p",{children:"Use the messages icon to chat with friends, join group conversations about shows, and stay connected with your concert community."})]}),placement:"top",disableBeacon:!0,before:()=>E(void 0,null,function*(){console.log("Step 5 before: Verifying chat view is loaded");try{Array.from(document.querySelectorAll("h1")).find(_=>{var w;return((w=_.textContent)==null?void 0:w.trim())==="Messages"})||(console.warn("Step 5 before: Messages heading not found, waiting..."),yield new Promise(_=>setTimeout(_,300))),console.log("Step 5 before: Waiting for chat navigation button...");const v=yield Uf('[data-tour="chat"]',8e3);console.log("Step 5 before: Chat navigation button found!"),v.scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(_=>setTimeout(_,400))}catch(g){console.error("Step 5: Element not found:",g)}})},{target:'[data-tour="profile-passport"]',content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Your Live Music Passport"}),s.jsx("p",{children:"Check out your profile and Live Music Passport! See your identity, stamps, achievements, timeline, and bucket list. Track your concert journey all in one place."})]}),placement:"top",disableBeacon:!0,before:()=>E(void 0,null,function*(){console.log("Step 6 before: Navigating to profile view"),r&&r("profile"),yield new Promise(g=>setTimeout(g,400)),yield new Promise(g=>requestAnimationFrame(g)),yield new Promise(g=>requestAnimationFrame(g));try{console.log("Step 6 before: Waiting for profile-passport element...");const g=yield Uf('[data-tour="profile-passport"]',6e3);console.log("Step 6 before: Profile-passport element found!"),g.scrollIntoView({behavior:"smooth",block:"center"}),yield new Promise(v=>setTimeout(v,400))}catch(g){console.error("Step 6: Element not found:",g)}})},{target:"body",content:s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-bold",children:"You're All Set! "}),s.jsx("p",{children:"You've completed the tour! Start exploring shows, connecting with friends, and sharing your concert experiences. Have fun!"})]}),placement:"center",disableBeacon:!0,before:()=>E(void 0,null,function*(){r&&r("feed"),yield new Promise(g=>setTimeout(g,500))})}],x=g=>E(void 0,null,function*(){const{status:v,type:_,index:w,action:b}=g;if(_===Os.STEP_AFTER&&b===Jr.NEXT&&w===1&&r){console.log("Step 2 completed: Pausing tour to load discover view"),a(!1),d(!0),h("Loading discover page..."),r("search"),yield new Promise(N=>setTimeout(N,300)),yield new Promise(N=>requestAnimationFrame(N)),yield new Promise(N=>requestAnimationFrame(N));try{yield Uf('[data-tour="discover-vibes"]',15e3),console.log("Step 3 target is ready, resuming tour"),yield new Promise(N=>setTimeout(N,300)),f.current=2,d(!1),h(""),l(void 0),yield new Promise(N=>setTimeout(N,100)),a(!0)}catch(N){console.error("Step 3 target not ready, resuming anyway:",N),d(!1),h(""),l(void 0),yield new Promise(S=>setTimeout(S,100)),a(!0)}return}if(_===Os.STEP_BEFORE&&w===2&&(console.log("Step 3 shown, immediately clearing stepIndex to enable buttons"),l(void 0),setTimeout(()=>{const N=document.querySelector('[data-test-id="button-primary"]');N&&(console.log("Button found, ensuring it is clickable"),N.style.pointerEvents="auto",N.style.cursor="pointer")},0)),_===Os.STEP_AFTER&&w===2&&o===2&&(console.log("Step 3 completed, clearing stepIndex"),l(void 0)),_===Os.STEP_BEFORE&&w===4&&(console.log("Step 5 shown, immediately clearing stepIndex to enable buttons"),l(void 0),setTimeout(()=>{const N=['[data-action="primary"]','[data-test-id="button-primary"]','button[class*="buttonNext"]','button:contains("Next")',".react-joyride__tooltip button:last-child",'.react-joyride__tooltip [role="button"]:last-child','button[aria-label*="Next"]'],S=new Set;for(const A of N)try{Array.from(document.querySelectorAll(A)).forEach($=>{if(S.has($))return;const R=$.textContent||"";(R.includes("Next")||R.includes("Step 5"))&&(console.log(`Step 5 button found with selector: ${A}`),S.add($),$.style.pointerEvents="auto",$.style.cursor="pointer",$.style.zIndex="99999",$.style.position="relative",$.removeAttribute("disabled"),$ instanceof HTMLButtonElement&&($.disabled=!1,$.setAttribute("aria-disabled","false")))})}catch(T){}Array.from(document.querySelectorAll("button")).forEach(A=>{if(S.has(A))return;const T=A.textContent||"";T.includes("Next")&&T.includes("Step 5")&&(console.log("Step 5 button found by text search"),S.add(A),A.style.pointerEvents="auto",A.style.cursor="pointer",A.style.zIndex="99999",A.style.position="relative",A.disabled=!1,A.removeAttribute("disabled"),A.setAttribute("aria-disabled","false"))}),document.querySelectorAll('[class*="overlay"]').forEach(A=>{A.style.pointerEvents="none",A.style.zIndex="1"})},0),setTimeout(()=>{l(void 0),Array.from(document.querySelectorAll("button")).forEach(S=>{(S.textContent||"").includes("Next")&&(S.style.pointerEvents="auto !important",S.style.cursor="pointer !important",S.disabled=!1)})},100)),_===Os.STEP_AFTER&&w===4&&o===4&&(console.log("Step 5 completed, clearing stepIndex"),l(void 0)),_===Os.STEP_AFTER&&b===Jr.NEXT&&w===4&&r){console.log("Step 5 completed: Pausing tour to load profile view"),a(!1),d(!0),h("Loading Profile page..."),r("profile");try{console.log("Step 5 completed: Waiting for profile view to load..."),yield new Promise(k=>setTimeout(k,500)),yield new Promise(k=>requestAnimationFrame(k)),yield new Promise(k=>requestAnimationFrame(k)),yield new Promise(k=>requestAnimationFrame(k));let N=!1,S=0;for(;!N&&S<100;){if(document.querySelector('[data-tour="profile-passport"]')){console.log("Profile view is ready, resuming tour"),N=!0;break}yield new Promise(O=>setTimeout(O,100)),S++}N||console.warn("Profile view loading timeout, proceeding anyway"),yield new Promise(k=>setTimeout(k,500)),d(!1),h(""),f.current=5,l(void 0),yield new Promise(k=>setTimeout(k,100)),a(!0),setTimeout(()=>{f.current=null},200)}catch(N){console.error("Profile view loading error:",N),d(!1),h(""),f.current=5,l(void 0),yield new Promise(S=>setTimeout(S,100)),a(!0),setTimeout(()=>{f.current=null},200)}return}if(_===Os.STEP_AFTER&&b===Jr.NEXT&&w===3&&r){console.log("Step 4 completed: Pausing tour to load chat view"),a(!1),d(!0),h("Loading Chat page..."),r("chat");try{console.log("Step 4 completed: Waiting for chat view to load..."),yield new Promise(k=>setTimeout(k,500)),yield new Promise(k=>requestAnimationFrame(k)),yield new Promise(k=>requestAnimationFrame(k)),yield new Promise(k=>requestAnimationFrame(k));let N=!1,S=0;for(;!N&&S<100;){if(Array.from(document.querySelectorAll("h1")).find(O=>{var A;return((A=O.textContent)==null?void 0:A.trim())==="Messages"})){console.log("Chat view is ready, resuming tour"),N=!0;break}yield new Promise(O=>setTimeout(O,100)),S++}N||console.warn("Chat view loading timeout, proceeding anyway"),yield new Promise(k=>setTimeout(k,500)),d(!1),h(""),f.current=4,l(void 0),yield new Promise(k=>setTimeout(k,100)),a(!0),setTimeout(()=>{l(void 0),f.current=null},200)}catch(N){console.error("Chat view loading error:",N),d(!1),h(""),f.current=4,l(void 0),yield new Promise(S=>setTimeout(S,100)),a(!0),setTimeout(()=>{l(void 0),f.current=null},200)}return}(v===Mr.FINISHED||v===Mr.SKIPPED)&&(a(!1),l(void 0),d(!1),h(""),n&&(yield mu.completeTour(n.id)),t()),_===Os.TARGET_NOT_FOUND&&console.error("Joyride: Target not found for step",w,g)});return c?s.jsx("div",{className:"fixed inset-0 z-[9999] bg-[#fcfcfc] flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#cc2486] mx-auto"}),s.jsx("p",{className:"text-lg font-medium text-gray-700",children:u})]})}):i?s.jsx(Wve,W(M({steps:p,run:i},typeof o=="number"?{stepIndex:o}:{}),{continuous:!0,disableScrolling:!1,showProgress:!0,showSkipButton:!0,spotlightClicks:!0,callback:x,disableOverlayClose:!1,styles:{options:{primaryColor:"#cc2486",textColor:"#0e0e0e",backgroundColor:"#fcfcfc",arrowColor:"#fcfcfc",overlayColor:"rgba(0, 0, 0, 0)",zIndex:1e4,width:"max(320px, min(393px, 90vw))"},tooltip:{borderRadius:12,padding:20,maxWidth:"393px",fontSize:"14px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},tooltipContainer:{textAlign:"left"},buttonNext:{backgroundColor:"#cc2486",borderRadius:8,fontSize:14,padding:"10px 20px",fontWeight:600,color:"#fff",border:"none",outline:"none",cursor:"pointer !important",pointerEvents:"auto !important",zIndex:10001},buttonBack:{color:"#5d646f",fontSize:14,marginRight:10,border:"none",outline:"none"},buttonSkip:{color:"#5d646f",fontSize:14,border:"none",outline:"none"},overlay:{mixBlendMode:"normal",backgroundColor:"rgba(0, 0, 0, 0)",cursor:"default",pointerEvents:"none"},spotlight:{borderRadius:12,boxShadow:"0 0 0 4px rgba(204, 36, 134, 0.6), 0 0 30px rgba(204, 36, 134, 0.4)",backgroundColor:"transparent"},spotlightLegacy:{borderRadius:12}},locale:{back:"Back",close:"Close",last:"Finish",next:"Next",skip:"Skip Tour"}})):null},Gve=({initialData:e,onNext:t,onSkip:r})=>{const[n,i]=y.useState({username:(e==null?void 0:e.username)||"",location_city:(e==null?void 0:e.location_city)||"",birthday:(e==null?void 0:e.birthday)||"",gender:(e==null?void 0:e.gender)||"",bio:(e==null?void 0:e.bio)||"",avatar_url:(e==null?void 0:e.avatar_url)||""}),[a,o]=y.useState({}),[l,c]=y.useState(!1),[d,u]=y.useState(!1),h=y.useRef(null),{user:f}=os(),{toast:p}=jr(),x=w=>E(void 0,null,function*(){var k;const b=(k=w.target.files)==null?void 0:k[0];if(!b||!f)return;if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(b.type)){p({title:"Invalid file type",description:"Please select a JPEG, PNG, or WebP image.",variant:"destructive"});return}const S=5*1024*1024;if(b.size>S){p({title:"File too large",description:"Please select an image smaller than 5MB.",variant:"destructive"});return}c(!0);try{const O=b.name.split(".").pop(),A=`${f.id}/${Date.now()}.${O}`,{data:T,error:$}=yield P.storage.from("profile-avatars").upload(A,b,{cacheControl:"3600",upsert:!1});if($)throw $;const{data:R}=P.storage.from("profile-avatars").getPublicUrl(T.path);i(W(M({},n),{avatar_url:R.publicUrl})),p({title:"Photo uploaded",description:"Your profile photo has been uploaded successfully."})}catch(O){console.error("Upload error:",O),p({title:"Upload failed",description:"Failed to upload photo. Please try again.",variant:"destructive"})}finally{c(!1)}}),g=w=>E(void 0,null,function*(){if(!w.trim())return!1;try{const{data:b,error:N}=yield P.from("users").select("username").eq("username",w.toLowerCase().trim()).limit(1);return N&&N.code!=="PGRST116"?(console.warn("Error checking username:",N),!0):!b||b.length===0}catch(b){return console.error("Error checking username availability:",b),!0}}),v=()=>E(void 0,null,function*(){const w=n.username.trim();if(!w){o(W(M({},a),{username:""}));return}if(!/^[a-zA-Z0-9_]{3,20}$/.test(w)){o(W(M({},a),{username:"Username must be 3-20 characters, letters, numbers, and underscores only"}));return}u(!0);const N=yield g(w);u(!1),o(N?W(M({},a),{username:""}):W(M({},a),{username:"This username is already taken"}))}),_=w=>E(void 0,null,function*(){w.preventDefault();const b={},N=n.username.trim();if(!N)b.username="Username is required";else if(!/^[a-zA-Z0-9_]{3,20}$/.test(N))b.username="Username must be 3-20 characters, letters, numbers, and underscores only";else{u(!0);const k=yield g(N);u(!1),k||(b.username="This username is already taken")}if(n.location_city.trim()||(b.location_city="City is required"),!n.birthday)b.birthday="Birthday is required";else{const S=new Date(n.birthday),k=new Date,O=k.getFullYear()-S.getFullYear(),A=k.getMonth()-S.getMonth();A<0||A===0&&k.getDate()<S.getDate()?O-1<13&&(b.birthday="You must be at least 13 years old"):O<13&&(b.birthday="You must be at least 13 years old")}if(n.bio.length>120&&(b.bio="Bio must be 120 characters or less"),Object.keys(b).length>0){o(b);return}t(n)});return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Welcome to Synth!"}),s.jsx("p",{className:"text-muted-foreground",children:"Let's set up your profile to personalize your experience"})]}),s.jsxs("form",{onSubmit:_,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ut,{htmlFor:"username",children:["Username ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(or,{id:"username",placeholder:"e.g., musiclover123",value:n.username,onChange:w=>{const b=w.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"");i(W(M({},n),{username:b})),a.username&&o(W(M({},a),{username:""}))},onBlur:v,maxLength:20,className:`bg-white ${a.username?"border-destructive":""}`}),d&&s.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:s.jsx(er,{className:"w-4 h-4 animate-spin text-muted-foreground"})})]}),a.username&&s.jsx("p",{className:"text-sm text-destructive",children:a.username}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your unique username (3-20 characters, letters, numbers, and underscores only)"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{children:"Profile Photo (Optional)"}),s.jsxs("div",{className:"flex items-center gap-4",children:[n.avatar_url?s.jsx("img",{src:n.avatar_url,alt:"Profile",className:"w-20 h-20 rounded-full object-cover"}):s.jsx("div",{className:"w-20 h-20 rounded-full bg-muted flex items-center justify-center",children:s.jsx(_3,{className:"w-8 h-8 text-muted-foreground"})}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("input",{ref:h,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:x,className:"hidden"}),s.jsx(oe,{type:"button",variant:"outline",onClick:()=>{var w;return(w=h.current)==null?void 0:w.click()},disabled:l,className:"w-full",children:l?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(x2,{className:"w-4 h-4 mr-2"}),"Upload Photo"]})}),s.jsx(or,{type:"url",placeholder:"Or paste image URL",value:n.avatar_url,onChange:w=>i(W(M({},n),{avatar_url:w.target.value})),disabled:l,className:"bg-white"})]})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"You can add a photo now or skip and add it later"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ut,{htmlFor:"location_city",children:["City ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsx(or,{id:"location_city",placeholder:"e.g., Los Angeles, CA",value:n.location_city,onChange:w=>i(W(M({},n),{location_city:w.target.value})),className:`bg-white ${a.location_city?"border-destructive":""}`}),a.location_city&&s.jsx("p",{className:"text-sm text-destructive",children:a.location_city}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"We'll show you events happening near you"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Ut,{htmlFor:"birthday",children:["Birthday ",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsx(or,{id:"birthday",type:"date",value:n.birthday,onChange:w=>i(W(M({},n),{birthday:w.target.value})),className:`bg-white ${a.birthday?"border-destructive":""}`}),a.birthday&&s.jsx("p",{className:"text-sm text-destructive",children:a.birthday}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your age will be displayed to other users, but not your exact birthday"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"gender",children:"Gender (Optional)"}),s.jsxs(Xs,{value:n.gender,onValueChange:w=>i(W(M({},n),{gender:w})),children:[s.jsx(Ds,{className:"bg-white",children:s.jsx(Js,{placeholder:"Select your gender"})}),s.jsxs(Is,{className:"bg-white",children:[s.jsx(Lt,{value:"male",children:"Male"}),s.jsx(Lt,{value:"female",children:"Female"}),s.jsx(Lt,{value:"non-binary",children:"Non-binary"}),s.jsx(Lt,{value:"prefer-not-to-say",children:"Prefer not to say"}),s.jsx(Lt,{value:"other",children:"Other"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ut,{htmlFor:"bio",children:"Bio (Optional)"}),s.jsx(as,{id:"bio",placeholder:"Tell us a bit about yourself...",value:n.bio,onChange:w=>i(W(M({},n),{bio:w.target.value})),maxLength:120,className:`bg-white ${a.bio?"border-destructive":""}`}),s.jsxs("p",{className:"text-xs text-muted-foreground text-right",children:[n.bio.length,"/120 characters"]}),a.bio&&s.jsx("p",{className:"text-sm text-destructive",children:a.bio})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(oe,{type:"button",variant:"ghost",onClick:r,className:"flex-1",children:"Skip"}),s.jsx(oe,{type:"submit",className:"flex-1",children:"Continue"})]})]})]})};var XA=1,Yve=.9,Kve=.8,Zve=.17,Bj=.1,zj=.999,Xve=.9999,Jve=.99,Qve=/[\\\/_+.#"@\[\(\{&]/,exe=/[\\\/_+.#"@\[\(\{&]/g,txe=/[\s-]/,SV=/[\s-]/g;function pS(e,t,r,n,i,a,o){if(a===t.length)return i===e.length?XA:Jve;var l=`${i},${a}`;if(o[l]!==void 0)return o[l];for(var c=n.charAt(a),d=r.indexOf(c,i),u=0,h,f,p,x;d>=0;)h=pS(e,t,r,n,d+1,a+1,o),h>u&&(d===i?h*=XA:Qve.test(e.charAt(d-1))?(h*=Kve,p=e.slice(i,d-1).match(exe),p&&i>0&&(h*=Math.pow(zj,p.length))):txe.test(e.charAt(d-1))?(h*=Yve,x=e.slice(i,d-1).match(SV),x&&i>0&&(h*=Math.pow(zj,x.length))):(h*=Zve,i>0&&(h*=Math.pow(zj,d-i))),e.charAt(d)!==t.charAt(a)&&(h*=Xve)),(h<Bj&&r.charAt(d-1)===n.charAt(a+1)||n.charAt(a+1)===n.charAt(a)&&r.charAt(d-1)!==n.charAt(a))&&(f=pS(e,t,r,n,d+1,a+2,o),f*Bj>h&&(h=f*Bj)),h>u&&(u=h),d=r.indexOf(c,d+1);return o[l]=u,u}function JA(e){return e.toLowerCase().replace(SV," ")}function rxe(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,pS(e,t,JA(e),JA(t),0,0,{})}var t0='[cmdk-group=""]',Vj='[cmdk-group-items=""]',nxe='[cmdk-group-heading=""]',kV='[cmdk-item=""]',QA=`${kV}:not([aria-disabled="true"])`,gS="cmdk-item-select",Zf="data-value",sxe=(e,t,r)=>rxe(e,t,r),EV=y.createContext(void 0),Hv=()=>y.useContext(EV),CV=y.createContext(void 0),A4=()=>y.useContext(CV),PV=y.createContext(void 0),AV=y.forwardRef((e,t)=>{let r=Xf(()=>{var te,se;return{search:"",value:(se=(te=e.value)!=null?te:e.defaultValue)!=null?se:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=Xf(()=>new Set),i=Xf(()=>new Map),a=Xf(()=>new Map),o=Xf(()=>new Set),l=TV(e),X=e,{label:c,children:d,value:u,onValueChange:h,filter:f,shouldFilter:p,loop:x,disablePointerSelection:g=!1,vimBindings:v=!0}=X,_=me(X,["label","children","value","onValueChange","filter","shouldFilter","loop","disablePointerSelection","vimBindings"]),w=_s(),b=_s(),N=_s(),S=y.useRef(null),k=pxe();Ju(()=>{if(u!==void 0){let te=u.trim();r.current.value=te,O.emit()}},[u]),Ju(()=>{k(6,D)},[]);let O=y.useMemo(()=>({subscribe:te=>(o.current.add(te),()=>o.current.delete(te)),snapshot:()=>r.current,setState:(te,se,ue)=>{var ye,ne,xe,ge;if(!Object.is(r.current[te],se)){if(r.current[te]=se,te==="search")F(),$(),k(1,R);else if(te==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let ie=document.getElementById(N);ie?ie.focus():(ye=document.getElementById(w))==null||ye.focus()}if(k(7,()=>{var ie;r.current.selectedItemId=(ie=B())==null?void 0:ie.id,O.emit()}),ue||k(5,D),((ne=l.current)==null?void 0:ne.value)!==void 0){let ie=se!=null?se:"";(ge=(xe=l.current).onValueChange)==null||ge.call(xe,ie);return}}O.emit()}},emit:()=>{o.current.forEach(te=>te())}}),[]),A=y.useMemo(()=>({value:(te,se,ue)=>{var ye;se!==((ye=a.current.get(te))==null?void 0:ye.value)&&(a.current.set(te,{value:se,keywords:ue}),r.current.filtered.items.set(te,T(se,ue)),k(2,()=>{$(),O.emit()}))},item:(te,se)=>(n.current.add(te),se&&(i.current.has(se)?i.current.get(se).add(te):i.current.set(se,new Set([te]))),k(3,()=>{F(),$(),r.current.value||R(),O.emit()}),()=>{a.current.delete(te),n.current.delete(te),r.current.filtered.items.delete(te);let ue=B();k(4,()=>{F(),(ue==null?void 0:ue.getAttribute("id"))===te&&R(),O.emit()})}),group:te=>(i.current.has(te)||i.current.set(te,new Set),()=>{a.current.delete(te),i.current.delete(te)}),filter:()=>l.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:w,inputId:N,labelId:b,listInnerRef:S}),[]);function T(te,se){var ue,ye;let ne=(ye=(ue=l.current)==null?void 0:ue.filter)!=null?ye:sxe;return te?ne(te,r.current.search,se):0}function $(){if(!r.current.search||l.current.shouldFilter===!1)return;let te=r.current.filtered.items,se=[];r.current.filtered.groups.forEach(ye=>{let ne=i.current.get(ye),xe=0;ne.forEach(ge=>{let ie=te.get(ge);xe=Math.max(ie,xe)}),se.push([ye,xe])});let ue=S.current;U().sort((ye,ne)=>{var xe,ge;let ie=ye.getAttribute("id"),ee=ne.getAttribute("id");return((xe=te.get(ee))!=null?xe:0)-((ge=te.get(ie))!=null?ge:0)}).forEach(ye=>{let ne=ye.closest(Vj);ne?ne.appendChild(ye.parentElement===ne?ye:ye.closest(`${Vj} > *`)):ue.appendChild(ye.parentElement===ue?ye:ye.closest(`${Vj} > *`))}),se.sort((ye,ne)=>ne[1]-ye[1]).forEach(ye=>{var ne;let xe=(ne=S.current)==null?void 0:ne.querySelector(`${t0}[${Zf}="${encodeURIComponent(ye[0])}"]`);xe==null||xe.parentElement.appendChild(xe)})}function R(){let te=U().find(ue=>ue.getAttribute("aria-disabled")!=="true"),se=te==null?void 0:te.getAttribute(Zf);O.setState("value",se||void 0)}function F(){var te,se,ue,ye;if(!r.current.search||l.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let ne=0;for(let xe of n.current){let ge=(se=(te=a.current.get(xe))==null?void 0:te.value)!=null?se:"",ie=(ye=(ue=a.current.get(xe))==null?void 0:ue.keywords)!=null?ye:[],ee=T(ge,ie);r.current.filtered.items.set(xe,ee),ee>0&&ne++}for(let[xe,ge]of i.current)for(let ie of ge)if(r.current.filtered.items.get(ie)>0){r.current.filtered.groups.add(xe);break}r.current.filtered.count=ne}function D(){var te,se,ue;let ye=B();ye&&(((te=ye.parentElement)==null?void 0:te.firstChild)===ye&&((ue=(se=ye.closest(t0))==null?void 0:se.querySelector(nxe))==null||ue.scrollIntoView({block:"nearest"})),ye.scrollIntoView({block:"nearest"}))}function B(){var te;return(te=S.current)==null?void 0:te.querySelector(`${kV}[aria-selected="true"]`)}function U(){var te;return Array.from(((te=S.current)==null?void 0:te.querySelectorAll(QA))||[])}function V(te){let se=U()[te];se&&O.setState("value",se.getAttribute(Zf))}function Y(te){var se;let ue=B(),ye=U(),ne=ye.findIndex(ge=>ge===ue),xe=ye[ne+te];(se=l.current)!=null&&se.loop&&(xe=ne+te<0?ye[ye.length-1]:ne+te===ye.length?ye[0]:ye[ne+te]),xe&&O.setState("value",xe.getAttribute(Zf))}function z(te){let se=B(),ue=se==null?void 0:se.closest(t0),ye;for(;ue&&!ye;)ue=te>0?hxe(ue,t0):mxe(ue,t0),ye=ue==null?void 0:ue.querySelector(QA);ye?O.setState("value",ye.getAttribute(Zf)):Y(te)}let K=()=>V(U().length-1),Z=te=>{te.preventDefault(),te.metaKey?K():te.altKey?z(1):Y(1)},G=te=>{te.preventDefault(),te.metaKey?V(0):te.altKey?z(-1):Y(-1)};return y.createElement(Nt.div,W(M({ref:t,tabIndex:-1},_),{"cmdk-root":"",onKeyDown:te=>{var se;(se=_.onKeyDown)==null||se.call(_,te);let ue=te.nativeEvent.isComposing||te.keyCode===229;if(!(te.defaultPrevented||ue))switch(te.key){case"n":case"j":{v&&te.ctrlKey&&Z(te);break}case"ArrowDown":{Z(te);break}case"p":case"k":{v&&te.ctrlKey&&G(te);break}case"ArrowUp":{G(te);break}case"Home":{te.preventDefault(),V(0);break}case"End":{te.preventDefault(),K();break}case"Enter":{te.preventDefault();let ye=B();if(ye){let ne=new Event(gS);ye.dispatchEvent(ne)}}}}}),y.createElement("label",{"cmdk-label":"",htmlFor:A.inputId,id:A.labelId,style:vxe},c),N1(e,te=>y.createElement(CV.Provider,{value:O},y.createElement(EV.Provider,{value:A},te))))}),ixe=y.forwardRef((e,t)=>{var r,n;let i=_s(),a=y.useRef(null),o=y.useContext(PV),l=Hv(),c=TV(e),d=(n=(r=c.current)==null?void 0:r.forceMount)!=null?n:o==null?void 0:o.forceMount;Ju(()=>{if(!d)return l.item(i,o==null?void 0:o.id)},[d]);let u=OV(i,a,[e.value,e.children,a],e.keywords),h=A4(),f=Pd(O=>O.value&&O.value===u.current),p=Pd(O=>d||l.filter()===!1?!0:O.search?O.filtered.items.get(i)>0:!0);y.useEffect(()=>{let O=a.current;if(!(!O||e.disabled))return O.addEventListener(gS,x),()=>O.removeEventListener(gS,x)},[p,e.onSelect,e.disabled]);function x(){var O,A;g(),(A=(O=c.current).onSelect)==null||A.call(O,u.current)}function g(){h.setState("value",u.current,!0)}if(!p)return null;let k=e,{disabled:v,value:_,onSelect:w,forceMount:b,keywords:N}=k,S=me(k,["disabled","value","onSelect","forceMount","keywords"]);return y.createElement(Nt.div,W(M({ref:vc(a,t)},S),{id:i,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!f,"data-disabled":!!v,"data-selected":!!f,onPointerMove:v||l.getDisablePointerSelection()?void 0:g,onClick:v?void 0:x}),e.children)}),axe=y.forwardRef((e,t)=>{let p=e,{heading:r,children:n,forceMount:i}=p,a=me(p,["heading","children","forceMount"]),o=_s(),l=y.useRef(null),c=y.useRef(null),d=_s(),u=Hv(),h=Pd(x=>i||u.filter()===!1?!0:x.search?x.filtered.groups.has(o):!0);Ju(()=>u.group(o),[]),OV(o,l,[e.value,e.heading,c]);let f=y.useMemo(()=>({id:o,forceMount:i}),[i]);return y.createElement(Nt.div,W(M({ref:vc(l,t)},a),{"cmdk-group":"",role:"presentation",hidden:h?void 0:!0}),r&&y.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:d},r),N1(e,x=>y.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?d:void 0},y.createElement(PV.Provider,{value:f},x))))}),oxe=y.forwardRef((e,t)=>{let o=e,{alwaysRender:r}=o,n=me(o,["alwaysRender"]),i=y.useRef(null),a=Pd(l=>!l.search);return!r&&!a?null:y.createElement(Nt.div,W(M({ref:vc(i,t)},n),{"cmdk-separator":"",role:"separator"}))}),lxe=y.forwardRef((e,t)=>{let d=e,{onValueChange:r}=d,n=me(d,["onValueChange"]),i=e.value!=null,a=A4(),o=Pd(u=>u.search),l=Pd(u=>u.selectedItemId),c=Hv();return y.useEffect(()=>{e.value!=null&&a.setState("search",e.value)},[e.value]),y.createElement(Nt.input,W(M({ref:t},n),{"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:i?e.value:o,onChange:u=>{i||a.setState("search",u.target.value),r==null||r(u.target.value)}}))}),cxe=y.forwardRef((e,t)=>{let d=e,{children:r,label:n="Suggestions"}=d,i=me(d,["children","label"]),a=y.useRef(null),o=y.useRef(null),l=Pd(u=>u.selectedItemId),c=Hv();return y.useEffect(()=>{if(o.current&&a.current){let u=o.current,h=a.current,f,p=new ResizeObserver(()=>{f=requestAnimationFrame(()=>{let x=u.offsetHeight;h.style.setProperty("--cmdk-list-height",x.toFixed(1)+"px")})});return p.observe(u),()=>{cancelAnimationFrame(f),p.unobserve(u)}}},[]),y.createElement(Nt.div,W(M({ref:vc(a,t)},i),{"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":n,id:c.listId}),N1(e,u=>y.createElement("div",{ref:vc(o,c.listInnerRef),"cmdk-list-sizer":""},u)))}),dxe=y.forwardRef((e,t)=>{let c=e,{open:r,onOpenChange:n,overlayClassName:i,contentClassName:a,container:o}=c,l=me(c,["open","onOpenChange","overlayClassName","contentClassName","container"]);return y.createElement(zw,{open:r,onOpenChange:n},y.createElement(Vw,{container:o},y.createElement(Jm,{"cmdk-overlay":"",className:i}),y.createElement(Qm,{"aria-label":e.label,"cmdk-dialog":"",className:a},y.createElement(AV,M({ref:t},l)))))}),uxe=y.forwardRef((e,t)=>Pd(r=>r.filtered.count===0)?y.createElement(Nt.div,W(M({ref:t},e),{"cmdk-empty":"",role:"presentation"})):null),fxe=y.forwardRef((e,t)=>{let o=e,{progress:r,children:n,label:i="Loading..."}=o,a=me(o,["progress","children","label"]);return y.createElement(Nt.div,W(M({ref:t},a),{"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":i}),N1(e,l=>y.createElement("div",{"aria-hidden":!0},l)))}),fa=Object.assign(AV,{List:cxe,Item:ixe,Input:lxe,Group:axe,Separator:oxe,Dialog:dxe,Empty:uxe,Loading:fxe});function hxe(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function mxe(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function TV(e){let t=y.useRef(e);return Ju(()=>{t.current=e}),t}var Ju=typeof window=="undefined"?y.useEffect:y.useLayoutEffect;function Xf(e){let t=y.useRef();return t.current===void 0&&(t.current=e()),t}function Pd(e){let t=A4(),r=()=>e(t.snapshot());return y.useSyncExternalStore(t.subscribe,r,r)}function OV(e,t,r,n=[]){let i=y.useRef(),a=Hv();return Ju(()=>{var o;let l=(()=>{var d;for(let u of r){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(d=u.current.textContent)==null?void 0:d.trim():i.current}})(),c=n.map(d=>d.trim());a.value(e,l,c),(o=t.current)==null||o.setAttribute(Zf,l),i.current=l}),i}var pxe=()=>{let[e,t]=y.useState(),r=Xf(()=>new Map);return Ju(()=>{r.current.forEach(n=>n()),r.current=new Map},[e]),(n,i)=>{r.current.set(n,i),t({})}};function gxe(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function N1({asChild:e,children:t},r){return e&&y.isValidElement(t)?y.cloneElement(gxe(t),{ref:t.ref},r(t.props.children)):r(t)}var vxe={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const RV=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(fa,M({ref:r,className:ke("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e)},t))});RV.displayName=fa.displayName;const MV=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[s.jsx(Mi,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),s.jsx(fa.Input,M({ref:r,className:ke("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e)},t))]})});MV.displayName=fa.Input.displayName;const xxe=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(fa.List,M({ref:r,className:ke("max-h-[300px] overflow-y-auto overflow-x-hidden",e)},t))});xxe.displayName=fa.List.displayName;const DV=y.forwardRef((e,t)=>s.jsx(fa.Empty,M({ref:t,className:"py-6 text-center text-sm"},e)));DV.displayName=fa.Empty.displayName;const IV=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(fa.Group,M({ref:r,className:ke("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e)},t))});IV.displayName=fa.Group.displayName;const yxe=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(fa.Separator,M({ref:r,className:ke("-mx-1 h-px bg-border",e)},t))});yxe.displayName=fa.Separator.displayName;const $V=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(fa.Item,M({ref:r,className:ke("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e)},t))});$V.displayName=fa.Item.displayName;const _xe=({onNext:e,onBack:t,onSkip:r})=>{const[n,i]=y.useState([]),[a,o]=y.useState([]),[l,c]=y.useState(""),[d,u]=y.useState(""),[h,f]=y.useState(!1),[p,x]=y.useState({}),[g,v]=y.useState([]),[_,w]=y.useState(!1),[b,N]=y.useState(!1),S=y.useRef(null),k=D=>{if(n.length>=7){x(W(M({},p),{genres:"Maximum 7 genres allowed"}));return}n.includes(D)||(i([...n,D]),x(W(M({},p),{genres:""}))),f(!1)},O=()=>{const D=l.trim();if(D){if(n.length>=7){x(W(M({},p),{genres:"Maximum 7 genres allowed"}));return}n.includes(D)||(i([...n,D]),c(""),x(W(M({},p),{genres:""})))}},A=D=>{i(n.filter(B=>B!==D)),x(W(M({},p),{genres:""}))};y.useEffect(()=>{if(d.trim().length<2){v([]),N(!1);return}return S.current&&clearTimeout(S.current),S.current=setTimeout(()=>E(void 0,null,function*(){w(!0);try{const D=yield Av.searchArtistsTrigram(d.trim(),5);v(D),N(D.length>0)}catch(D){console.error("Error searching artists:",D),v([])}finally{w(!1)}}),300),()=>{S.current&&clearTimeout(S.current)}},[d]);const T=D=>{if(a.length>=15){x(W(M({},p),{artists:"Maximum 15 artists allowed"}));return}a.includes(D.name)||(o([...a,D.name]),u(""),v([]),N(!1),x(W(M({},p),{artists:""})))},$=()=>{const D=d.trim();if(D){if(a.length>=15){x(W(M({},p),{artists:"Maximum 15 artists allowed"}));return}a.includes(D)||(o([...a,D]),u(""),v([]),N(!1),x(W(M({},p),{artists:""})))}},R=D=>{o(a.filter(B=>B!==D)),x(W(M({},p),{artists:""}))},F=()=>{const D={};if(n.length<3&&(D.genres="Please select at least 3 genres"),a.length<3&&(D.artists="Please add at least 3 artists"),Object.keys(D).length>0){x(D);return}e({genres:n,artists:a})};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Tell us about your music taste"}),s.jsx("p",{className:"text-muted-foreground",children:"This helps us recommend events and connect you with like-minded people"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Ut,{className:"flex items-center gap-2",children:[s.jsx(Ct,{className:"w-4 h-4"}),"Favorite Genres",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[n.length,"/7 (min 3)"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(rc,{open:h,onOpenChange:f,children:[s.jsx(nc,{asChild:!0,children:s.jsx(oe,{variant:"outline",className:"w-full justify-start bg-white",children:"Select genres..."})}),s.jsx(ul,{className:"w-full p-0 bg-white",align:"start",children:s.jsxs(RV,{className:"bg-white",children:[s.jsx(MV,{placeholder:"Search genres...",className:"bg-white"}),s.jsx(DV,{children:"No genre found."}),s.jsx(IV,{className:"max-h-64 overflow-auto bg-white",children:Iz.filter(D=>!n.includes(D)).map(D=>s.jsx($V,{onSelect:()=>k(D),className:"hover:bg-gray-100",children:D},D))})]})})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(or,{placeholder:"Or type a custom genre...",value:l,onChange:D=>c(D.target.value),onKeyDown:D=>{D.key==="Enter"&&(D.preventDefault(),O())},className:"bg-white"}),s.jsx(oe,{type:"button",onClick:O,variant:"secondary",children:"Add"})]})]}),n.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:n.map((D,B)=>s.jsxs(Be,{variant:B<3?"default":"secondary",className:"px-3 py-1",children:[D,s.jsx("button",{type:"button",onClick:()=>A(D),className:"ml-2 hover:text-destructive",children:s.jsx(pr,{className:"w-3 h-3"})})]},D))}),n.length>0&&s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your top 3 genres get higher weight in recommendations"}),p.genres&&s.jsx("p",{className:"text-sm text-destructive",children:p.genres})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Ut,{className:"flex items-center gap-2",children:[s.jsx(li,{className:"w-4 h-4"}),"Favorite Artists",s.jsx("span",{className:"text-destructive",children:"*"})]}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[a.length,"/15 (min 3)"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(or,{placeholder:"Type an artist name...",value:d,onChange:D=>u(D.target.value),onKeyDown:D=>{D.key==="Enter"&&(D.preventDefault(),g.length>0&&b?T(g[0]):$())},onFocus:()=>{g.length>0&&d.trim().length>=2&&N(!0)},onBlur:()=>{setTimeout(()=>N(!1),200)},className:"bg-white"}),_&&s.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:s.jsx(er,{className:"w-4 h-4 animate-spin text-muted-foreground"})})]}),s.jsx(oe,{type:"button",onClick:$,variant:"secondary",children:"Add"})]}),b&&g.length>0&&s.jsx("div",{className:"border rounded-md bg-white shadow-md max-h-48 overflow-auto z-10",onMouseDown:D=>D.preventDefault(),children:g.map(D=>s.jsxs("button",{type:"button",onClick:()=>T(D),className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",children:[s.jsx("span",{className:"flex-1",children:D.name}),D.genres&&D.genres.length>0&&s.jsx("span",{className:"text-xs text-muted-foreground",children:D.genres[0]})]},D.id))})]}),a.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:a.map((D,B)=>s.jsxs(Be,{variant:B<3?"default":"secondary",className:"px-3 py-1",children:[D,s.jsx("button",{type:"button",onClick:()=>R(D),className:"ml-2 hover:text-destructive",children:s.jsx(pr,{className:"w-3 h-3"})})]},D))}),a.length>0&&s.jsx("p",{className:"text-xs text-muted-foreground",children:"Your top 3 artists get higher weight in recommendations"}),p.artists&&s.jsx("p",{className:"text-sm text-destructive",children:p.artists})]}),s.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg p-4 text-sm",children:s.jsxs("p",{className:"text-blue-700 dark:text-blue-300",children:[" ",s.jsx("strong",{children:"Tip:"})," You can also connect your Spotify account later to automatically sync your music preferences!"]})}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(oe,{type:"button",variant:"ghost",onClick:t,className:"flex-1",children:"Back"}),s.jsx(oe,{type:"button",variant:"outline",onClick:r,className:"flex-1",children:"Skip"}),s.jsx(oe,{onClick:F,className:"flex-1",children:"Complete Setup"})]})]})};var LV="AlertDialog",[wxe,OFe]=js(LV,[aL]),Pc=aL(),FV=e=>{const i=e,{__scopeAlertDialog:t}=i,r=me(i,["__scopeAlertDialog"]),n=Pc(t);return s.jsx(zw,W(M(M({},n),r),{modal:!0}))};FV.displayName=LV;var bxe="AlertDialogTrigger",jxe=y.forwardRef((e,t)=>{const a=e,{__scopeAlertDialog:r}=a,n=me(a,["__scopeAlertDialog"]),i=Pc(r);return s.jsx(soe,W(M(M({},i),n),{ref:t}))});jxe.displayName=bxe;var Nxe="AlertDialogPortal",UV=e=>{const i=e,{__scopeAlertDialog:t}=i,r=me(i,["__scopeAlertDialog"]),n=Pc(t);return s.jsx(Vw,M(M({},n),r))};UV.displayName=Nxe;var Sxe="AlertDialogOverlay",BV=y.forwardRef((e,t)=>{const a=e,{__scopeAlertDialog:r}=a,n=me(a,["__scopeAlertDialog"]),i=Pc(r);return s.jsx(Jm,W(M(M({},i),n),{ref:t}))});BV.displayName=Sxe;var Rh="AlertDialogContent",[kxe,Exe]=wxe(Rh),Cxe=jD("AlertDialogContent"),zV=y.forwardRef((e,t)=>{const d=e,{__scopeAlertDialog:r,children:n}=d,i=me(d,["__scopeAlertDialog","children"]),a=Pc(r),o=y.useRef(null),l=sr(t,o),c=y.useRef(null);return s.jsx(eoe,{contentName:Rh,titleName:VV,docsSlug:"alert-dialog",children:s.jsx(kxe,{scope:r,cancelRef:c,children:s.jsxs(Qm,W(M(M({role:"alertdialog"},a),i),{ref:l,onOpenAutoFocus:mt(i.onOpenAutoFocus,u=>{var h;u.preventDefault(),(h=c.current)==null||h.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[s.jsx(Cxe,{children:n}),s.jsx(Axe,{contentRef:o})]}))})})});zV.displayName=Rh;var VV="AlertDialogTitle",qV=y.forwardRef((e,t)=>{const a=e,{__scopeAlertDialog:r}=a,n=me(a,["__scopeAlertDialog"]),i=Pc(r);return s.jsx(Ev,W(M(M({},i),n),{ref:t}))});qV.displayName=VV;var WV="AlertDialogDescription",HV=y.forwardRef((e,t)=>{const a=e,{__scopeAlertDialog:r}=a,n=me(a,["__scopeAlertDialog"]),i=Pc(r);return s.jsx(Cv,W(M(M({},i),n),{ref:t}))});HV.displayName=WV;var Pxe="AlertDialogAction",GV=y.forwardRef((e,t)=>{const a=e,{__scopeAlertDialog:r}=a,n=me(a,["__scopeAlertDialog"]),i=Pc(r);return s.jsx(qw,W(M(M({},i),n),{ref:t}))});GV.displayName=Pxe;var YV="AlertDialogCancel",KV=y.forwardRef((e,t)=>{const l=e,{__scopeAlertDialog:r}=l,n=me(l,["__scopeAlertDialog"]),{cancelRef:i}=Exe(YV,r),a=Pc(r),o=sr(t,i);return s.jsx(qw,W(M(M({},a),n),{ref:o}))});KV.displayName=YV;var Axe=({contentRef:e})=>{const t=`\`${Rh}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Rh}\` by passing a \`${WV}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Rh}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return y.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},Txe=FV,Oxe=UV,ZV=BV,XV=zV,JV=GV,QV=KV,eq=qV,tq=HV;const Rxe=Txe,Mxe=Oxe,rq=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(ZV,W(M({className:ke("fixed inset-0 z-[9999] bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e)},t),{ref:r}))});rq.displayName=ZV.displayName;const nq=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsxs(Mxe,{children:[s.jsx(rq,{}),s.jsx(XV,M({ref:r,className:ke("fixed left-[50%] top-[50%] z-[9999] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e)},t))]})});nq.displayName=XV.displayName;const sq=r=>{var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("flex flex-col space-y-2 text-center sm:text-left",e)},t))};sq.displayName="AlertDialogHeader";const iq=r=>{var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e)},t))};iq.displayName="AlertDialogFooter";const aq=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(eq,M({ref:r,className:ke("text-lg font-semibold",e)},t))});aq.displayName=eq.displayName;const oq=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(tq,M({ref:r,className:ke("text-sm text-muted-foreground",e)},t))});oq.displayName=tq.displayName;const lq=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(JV,M({ref:r,className:ke(xg(),e)},t))});lq.displayName=JV.displayName;const cq=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(QV,M({ref:r,className:ke(xg({variant:"outline"}),"mt-2 sm:mt-0",e)},t))});cq.displayName=QV.displayName;const Dxe=({open:e,onOpenChange:t,onConfirmSkip:r})=>s.jsx(Rxe,{open:e,onOpenChange:t,children:s.jsxs(nq,{children:[s.jsxs(sq,{children:[s.jsx(aq,{children:"Skip profile setup?"}),s.jsxs(oq,{className:"space-y-3",children:[s.jsx("p",{children:"Completing your profile helps us personalize your experience:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[s.jsx("li",{children:"Discover events that match your music taste"}),s.jsx("li",{children:"Connect with people who share your interests"}),s.jsx("li",{children:"Get better recommendations based on your preferences"})]}),s.jsx("p",{className:"text-sm font-medium",children:"You can always complete this later from your profile settings."})]})]}),s.jsxs(iq,{children:[s.jsx(cq,{children:"Continue Setup"}),s.jsx(lq,{onClick:r,children:"Skip for Now"})]})]})}),Ixe=({onComplete:e})=>{const[t,r]=y.useState(1),[n,i]=y.useState(!1),[a,o]=y.useState(!1),{user:l}=os(),{toast:c}=jr(),[d,u]=y.useState({}),h=2,f=t/h*100,p=_=>E(void 0,null,function*(){if(l){o(!0);try{(yield mu.saveProfileSetup(l.id,_))?(u(_),r(2)):c({title:"Error",description:"Failed to save profile data. Please try again.",variant:"destructive"})}catch(w){const b=(w==null?void 0:w.message)||"An error occurred. Please try again.";c({title:"Error",description:b,variant:"destructive"})}finally{o(!1)}}}),x=_=>E(void 0,null,function*(){if(l){o(!0);try{const w=[];for(const N of _.artists)try{const S=yield Av.searchArtistsTrigram(N,1);if(S.length>0&&S[0].name.toLowerCase()===N.toLowerCase())w.push({name:S[0].name,id:S[0].id});else{w.push({name:N});try{const{MissingEntityRequestService:k}=yield on(()=>E(void 0,null,function*(){const{MissingEntityRequestService:O}=yield import("./missingEntityRequestService-DTKxUBjt.js");return{MissingEntityRequestService:O}}),[],import.meta.url);yield k.submitRequest({entity_type:"artist",entity_name:N})}catch(k){console.warn("Error submitting missing artist request:",k)}}}catch(S){console.warn(`Error searching for artist "${N}":`,S),w.push({name:N})}if(!(yield mu.saveMusicPreferences(l.id,_.genres,w))){c({title:"Error",description:"Failed to save music preferences.",variant:"destructive"}),o(!1);return}yield mu.completeOnboarding(l.id),c({title:"Welcome to Synth!",description:"Your profile is all set up. Let's explore the app!"}),e()}catch(w){console.error("Error in handleMusicTags:",w),c({title:"Error",description:"An error occurred. Please try again.",variant:"destructive"})}finally{o(!1)}}}),g=()=>{i(!0)},v=()=>E(void 0,null,function*(){if(l){o(!0);try{yield mu.skipOnboarding(l.id),c({title:"Onboarding Skipped",description:"You can complete your profile anytime from settings."}),e()}catch(_){c({title:"Error",description:"An error occurred. Please try again.",variant:"destructive"})}finally{o(!1),i(!1)}}});return s.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-primary/10 to-accent/10",children:[s.jsx(He,{className:"w-full max-w-2xl",children:s.jsxs(st,{className:"p-6 md:p-8",children:[s.jsxs("div",{className:"mb-8 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Step ",t," of ",h]}),s.jsxs("span",{children:[Math.round(f),"% complete"]})]}),s.jsx(yg,{value:f})]}),a?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto"}),s.jsx("p",{className:"text-muted-foreground",children:"Saving your information..."})]})}):s.jsxs(s.Fragment,{children:[t===1&&s.jsx(Gve,{initialData:d,onNext:p,onSkip:g}),t===2&&s.jsx(_xe,{onNext:x,onBack:()=>r(1),onSkip:g})]})]})}),s.jsx(Dxe,{open:n,onOpenChange:i,onConfirmSkip:v})]})};function $xe(){const{user:e}=os(),t=y.useRef(0),r=y.useRef(null),n=2*60*1e3,i=()=>E(this,null,function*(){if(!(e!=null&&e.id))return;const a=Date.now();if(!(a-t.current<n))try{yield Th.updateLastActive(e.id),t.current=a,console.log(" Activity tracked: last_active_at updated")}catch(l){console.error("Failed to track activity:",l)}});return y.useEffect(()=>{if(e!=null&&e.id)return i(),r.current=setInterval(()=>{i()},5*60*1e3),()=>{r.current&&clearInterval(r.current)}},[e==null?void 0:e.id]),y.useEffect(()=>{const a=()=>{document.visibilityState==="visible"&&i()};return document.addEventListener("visibilitychange",a),()=>{document.removeEventListener("visibilitychange",a)}},[e==null?void 0:e.id]),{trackActivity:i}}class ns{static getAllProfiles(){return E(this,null,function*(){try{const{data:t,error:r}=yield P.rpc("get_all_profiles_for_analytics");if(r)throw console.error("Error getting all profiles for analytics:",r),r;return t||[]}catch(t){throw console.error("Error in getAllProfiles:",t),t}})}static getProfilesByAccountType(t){return E(this,null,function*(){try{return(yield this.getAllProfiles()).filter(n=>n.account_type===t)}catch(r){throw console.error("Error getting profiles by account type:",r),r}})}static getAllUserInteractions(t,r,n){return E(this,null,function*(){try{let i=P.from("interactions").select("*");t&&t.length>0&&(i=i.in("entity_id",t)),r&&r.length>0&&(i=i.in("event_type",r)),n&&n.length>0&&(i=i.in("entity_type",n));const{data:a,error:o}=yield i;if(o)throw console.error("Error getting user interactions for analytics:",o),o;return a||[]}catch(i){throw console.error("Error in getAllUserInteractions:",i),i}})}static getAllUserReviews(t){return E(this,null,function*(){try{let r=P.from("reviews").select("*").eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY");t&&t.length>0&&(r=r.in("event_id",t));const{data:n,error:i}=yield r;if(i)throw console.error("Error getting user reviews for analytics:",i),i;return n||[]}catch(r){throw console.error("Error in getAllUserReviews:",r),r}})}static getAllInterestedUsers(t){return E(this,null,function*(){try{let r=P.from("user_event_relationships").select("*").in("relationship_type",["interested","going","maybe"]);t&&t.length>0&&(r=r.in("event_id",t));const{data:n,error:i}=yield r;if(i)throw console.error("Error getting interested users for analytics:",i),i;return n||[]}catch(r){throw console.error("Error in getAllInterestedUsers:",r),r}})}static getAllFriendships(){return E(this,null,function*(){try{const{data:t,error:r}=yield P.from("friends").select("*");if(r)throw console.error("Error getting friendships for analytics:",r),r;return t||[]}catch(t){throw console.error("Error in getAllFriendships:",t),t}})}static getProfileById(t){return E(this,null,function*(){try{return(yield this.getAllProfiles()).find(n=>n.user_id===t)||null}catch(r){throw console.error("Error getting profile by ID:",r),r}})}static getProfilesByBusinessInfo(t){return E(this,null,function*(){try{return(yield this.getAllProfiles()).filter(n=>{if(!n.business_info)return!1;for(const[i,a]of Object.entries(t))if(n.business_info[i]!==a)return!1;return!0})}catch(r){throw console.error("Error getting profiles by business info:",r),r}})}}class Bf{static getCreatorStats(t){return E(this,null,function*(){try{const{count:r}=yield P.from("artist_follows").select("*",{count:"exact",head:!0}).eq("artist_id",t);console.log(" CreatorAnalyticsService: Searching for events with creatorId:",t);const{data:n,error:i}=yield P.from("events").select("id, title, artist_name, venue_name, event_date, created_by_user_id").eq("created_by_user_id",t);if(i&&console.error(" CreatorAnalyticsService: Error fetching events:",i),console.log(" CreatorAnalyticsService: Found events for creator",t,":",(n==null?void 0:n.length)||0),n&&n.length>0)console.log(" CreatorAnalyticsService: Event details:",n.map(w=>({id:w.id,title:w.title,created_by:w.created_by_user_id})));else{console.log(" CreatorAnalyticsService: No events found. Let me check all events in database...");const{data:w,error:b}=yield P.from("events").select("id, title, artist_name, created_by_user_id").limit(10);b?console.error(" CreatorAnalyticsService: Error fetching all events:",b):console.log(" CreatorAnalyticsService: Sample events in database:",w==null?void 0:w.map(N=>({id:N.id,title:N.title,created_by:N.created_by_user_id})))}if(!n||n.length===0)return console.log(" CreatorAnalyticsService: No events found for creator",t),{total_followers:r||0,engagement_rate:0,total_event_views:0,total_reviews:0,profile_visits:0,ticket_clicks:0,fan_growth_rate:0,top_venue_performance:0};const a=n.map(w=>w.id),o=yield ns.getAllUserInteractions(a,void 0,["event"]);console.log(" CreatorAnalyticsService: Found interactions for events:",(o==null?void 0:o.length)||0),o&&o.length>0&&console.log(" CreatorAnalyticsService: Interaction details:",o.map(w=>({event_type:w.event_type,entity_id:w.entity_id,user_id:w.user_id})));const{data:l}=yield P.from("reviews").select(`
          *,
          event:events!inner(id, artist_name)
        `).in("event_id",a);console.log(" CreatorAnalyticsService: Found reviews for events:",(l==null?void 0:l.length)||0);const c=r||0,d=(o==null?void 0:o.filter(w=>w.event_type==="view").length)||0,u=(l==null?void 0:l.length)||0,h=(o==null?void 0:o.filter(w=>w.event_type==="profile_visit").length)||0,f=(o==null?void 0:o.filter(w=>w.event_type==="click_ticket").length)||0,p=d+h+f,x=c>0?p/c*100:0,_={total_followers:c,engagement_rate:Math.round(x*100)/100,total_event_views:d,total_reviews:u,profile_visits:h,ticket_clicks:f,fan_growth_rate:0,top_venue_performance:0};return console.log(" CreatorAnalyticsService: Final stats for creator",t,":",_),_}catch(r){return console.error("Error getting creator stats:",r),{total_followers:0,engagement_rate:0,total_event_views:0,total_reviews:0,profile_visits:0,ticket_clicks:0,fan_growth_rate:0,top_venue_performance:0}}})}static getFanInsights(t){return E(this,null,function*(){try{const{data:r}=yield P.from("events").select("*").eq("created_by_user_id",t);if(!r||r.length===0)return[];const n=r.map(l=>l.id),i=yield ns.getAllUserInteractions(n,void 0,["event"]),a=new Map;return r.forEach(l=>{const c=l.venue_name;a.has(c)||a.set(c,{eventCount:0,totalViews:0,interactions:[]}),a.get(c).eventCount++}),i==null||i.forEach(l=>{const c=r.find(d=>d.id===l.entity_id);if(c){const d=c.venue_name,u=a.get(d);u&&(u.interactions.push(l),l.event_type==="view"&&u.totalViews++)}}),Array.from(a.entries()).map(([l,c])=>{const d=c.eventCount>0?c.totalViews/c.eventCount:0,u=c.interactions.length>0?c.interactions.length/c.eventCount:0;return{venue_name:l,event_count:c.eventCount,total_views:c.totalViews,engagement_score:Math.round(d*100)/100,fan_density:Math.round(u*100)/100}}).sort((l,c)=>c.engagement_score-l.engagement_score)}catch(r){return console.error("Error getting fan insights:",r),[]}})}static getGeographicInsights(t){return E(this,null,function*(){try{const{data:r}=yield P.from("events").select("*").eq("created_by_user_id",t);if(!r||r.length===0)return[];const n=r.map(l=>l.id),i=yield ns.getAllUserInteractions(n,void 0,["event"]),a=new Map;return r.forEach(l=>{const c=`${l.venue_city||"Unknown"}, ${l.venue_state||"Unknown"}`;a.has(c)||a.set(c,{eventCount:0,fanCount:0,interactions:[]}),a.get(c).eventCount++}),i==null||i.forEach(l=>{const c=r.find(d=>d.id===l.entity_id);if(c){const d=`${c.venue_city||"Unknown"}, ${c.venue_state||"Unknown"}`,u=a.get(d);u&&(u.interactions.push(l),u.interactions.some(h=>h.user_id===l.user_id)||u.fanCount++)}}),Array.from(a.entries()).map(([l,c])=>{const[d,u]=l.split(", "),h=c.fanCount>0?c.interactions.length/c.fanCount*100:0;return{city:d.trim(),state:u.trim(),fan_count:c.fanCount,event_count:c.eventCount,engagement_rate:Math.round(h*100)/100}}).sort((l,c)=>c.fan_count-l.fan_count)}catch(r){return console.error("Error getting geographic insights:",r),[]}})}static getContentPerformance(t,r=30){return E(this,null,function*(){try{const n=new Date;n.setDate(n.getDate()-r);const{data:i}=yield P.from("events").select("id").eq("created_by_user_id",t);if(!i||i.length===0)return[];const a=i.map(d=>d.id),{data:o}=yield P.from("interactions").select("*").eq("entity_type","event").in("entity_id",a).gte("occurred_at",n.toISOString()),l=new Map;return o==null||o.forEach(d=>{const u=new Date(d.created_at).toISOString().split("T")[0];l.has(u)||l.set(u,{eventViews:0,profileVisits:0,followerGains:0,interactions:[]});const h=l.get(u);h.interactions.push(d),d.event_type==="view"?h.eventViews++:d.event_type==="profile_visit"&&h.profileVisits++}),Array.from(l.entries()).map(([d,u])=>{const h=u.interactions.length>0?u.interactions.length/10*100:0;return{date:d,event_views:u.eventViews,profile_visits:u.profileVisits,follower_gains:u.followerGains,engagement_rate:Math.round(h*100)/100}}).sort((d,u)=>new Date(d.date).getTime()-new Date(u.date).getTime())}catch(n){return console.error("Error getting content performance:",n),[]}})}static getCreatorAchievements(t){return E(this,null,function*(){try{const r=yield this.getCreatorStats(t),n=yield this.getFanInsights(t);return[{id:"first_follower",name:"First Fan",description:"Get your first follower",icon:"",progress:Math.min(r.total_followers,1),goal:1,unlocked:r.total_followers>=1,category:"follower"},{id:"growing_audience",name:"Growing Audience",description:"Reach 100 followers",icon:"",progress:Math.min(r.total_followers,100),goal:100,unlocked:r.total_followers>=100,category:"follower"},{id:"popular_creator",name:"Popular Creator",description:"Reach 1,000 followers",icon:"",progress:Math.min(r.total_followers,1e3),goal:1e3,unlocked:r.total_followers>=1e3,category:"follower"},{id:"engaging_content",name:"Engaging Content",description:"Achieve 10% engagement rate",icon:"",progress:Math.min(r.engagement_rate,10),goal:10,unlocked:r.engagement_rate>=10,category:"engagement"},{id:"highly_engaging",name:"Highly Engaging",description:"Achieve 25% engagement rate",icon:"",progress:Math.min(r.engagement_rate,25),goal:25,unlocked:r.engagement_rate>=25,category:"engagement"},{id:"venue_favorite",name:"Venue Favorite",description:"Perform at 5 different venues",icon:"",progress:Math.min(n.length,5),goal:5,unlocked:n.length>=5,category:"venue"},{id:"touring_artist",name:"Touring Artist",description:"Perform at 10 different venues",icon:"",progress:Math.min(n.length,10),goal:10,unlocked:n.length>=10,category:"venue"},{id:"reviewed_performer",name:"Reviewed Performer",description:"Get 10 reviews from fans",icon:"",progress:Math.min(r.total_reviews,10),goal:10,unlocked:r.total_reviews>=10,category:"engagement"},{id:"fan_favorite",name:"Fan Favorite",description:"Get 50 reviews from fans",icon:"",progress:Math.min(r.total_reviews,50),goal:50,unlocked:r.total_reviews>=50,category:"engagement"},{id:"ticket_seller",name:"Ticket Seller",description:"Generate 100 ticket clicks",icon:"",progress:Math.min(r.ticket_clicks,100),goal:100,unlocked:r.ticket_clicks>=100,category:"revenue"}]}catch(r){return console.error("Error getting creator achievements:",r),[]}})}static exportCreatorData(t){return E(this,null,function*(){const[r,n,i,a,o]=yield Promise.all([this.getCreatorStats(t),this.getFanInsights(t),this.getGeographicInsights(t),this.getContentPerformance(t),this.getCreatorAchievements(t)]);return{stats:r,fanInsights:n,geographicInsights:i,contentPerformance:a,achievements:o}})}}function Xi({title:e,value:t,change:r,changePercent:n,trend:i,icon:a,subtitle:o,className:l,valuePrefix:c="",valueSuffix:d=""}){const u=()=>!i||i==="neutral"?s.jsx(KJ,{className:"w-4 h-4"}):i==="up"?s.jsx(SJ,{className:"w-4 h-4"}):s.jsx(bJ,{className:"w-4 h-4"}),h=()=>!i||i==="neutral"?"text-gray-500":i==="up"?"text-green-600":"text-red-600",f=p=>typeof p=="number"?p.toLocaleString():p;return s.jsxs(He,{className:ke("glass-card inner-glow floating-shadow",l),children:[s.jsx(xr,{className:"pb-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Cr,{className:"text-sm font-medium text-gray-600",children:e}),a&&s.jsx("div",{className:"text-synth-pink",children:a})]})}),s.jsx(st,{children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:[c,f(t),d]}),(r!==void 0||n!==void 0)&&s.jsxs("div",{className:ke("flex items-center gap-1 text-sm",h()),children:[u(),s.jsxs("span",{className:"font-medium",children:[r!==void 0&&`${r>0?"+":""}${r}`,n!==void 0&&` (${n>0?"+":""}${n}%)`]}),o&&s.jsx("span",{className:"text-gray-500 ml-1",children:o})]}),!r&&!n&&o&&s.jsx("div",{className:"text-sm text-gray-500",children:o})]})})]})}function T4({name:e,description:t,icon:r,progress:n,goal:i,unlocked:a,unlockedAt:o,className:l,compact:c=!1}){const d=Math.min(n/i*100,100);return c?s.jsxs("div",{className:ke("flex items-center gap-3 p-3 rounded-lg border transition-all",a?"bg-gradient-to-r from-yellow-50 to-amber-50 border-yellow-200":"bg-gray-50 border-gray-200 opacity-60",l),children:[s.jsx("div",{className:"text-3xl",children:r}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-semibold text-sm text-gray-900",children:e}),a&&s.jsxs(Be,{variant:"secondary",className:"bg-yellow-100 text-yellow-800 text-xs",children:[s.jsx(Gs,{className:"w-3 h-3 mr-1"}),"Unlocked"]}),!a&&s.jsx(og,{className:"w-3 h-3 text-gray-400"})]}),s.jsx("p",{className:"text-xs text-gray-600",children:t}),!a&&s.jsxs("div",{className:"mt-1",children:[s.jsx(yg,{value:d,className:"h-1"}),s.jsxs("span",{className:"text-xs text-gray-500",children:[n,"/",i]})]})]})]}):s.jsx(He,{className:ke("overflow-hidden transition-all hover:shadow-md",a?"glass-card border-2 border-yellow-300 bg-gradient-to-br from-yellow-50/80 to-amber-50/80":"bg-white border-gray-200 opacity-75",l),children:s.jsxs(st,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:ke("text-5xl",a?"animate-bounce":"grayscale"),children:r}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:e}),s.jsx("p",{className:"text-sm text-gray-600",children:t})]})]}),a?s.jsxs(Be,{className:"bg-yellow-500 text-white border-0",children:[s.jsx(Gs,{className:"w-4 h-4 mr-1"}),"Unlocked!"]}):s.jsxs("div",{className:"flex items-center gap-1 text-gray-400",children:[s.jsx(og,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Locked"})]})]}),!a&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Progress"}),s.jsxs("span",{className:"font-semibold text-gray-900",children:[n,"/",i," (",Math.round(d),"%)"]})]}),s.jsx(yg,{value:d,className:"h-2"})]}),a&&o&&s.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:["Unlocked on ",new Date(o).toLocaleDateString()]})]})})}function Wa(){return s.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm animate-pulse",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3"}),s.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded-full"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6"})]}),s.jsxs("div",{className:"flex items-center gap-2 pt-4",children:[s.jsx("div",{className:"h-10 bg-gray-200 rounded w-1/4"}),s.jsx("div",{className:"h-10 bg-gray-200 rounded w-1/4"})]})]})})}function dq({stages:e,title:t="Conversion Funnel",showOptimizationTips:r=!0,className:n=""}){var u,h;const i=f=>f>=1e6?`${(f/1e6).toFixed(1)}M`:f>=1e3?`${(f/1e3).toFixed(1)}K`:f.toString(),a=f=>{const p=["from-blue-500 to-blue-600","from-purple-500 to-purple-600","from-pink-500 to-pink-600","from-green-500 to-green-600","from-yellow-500 to-yellow-600"];return p[f%p.length]},o=f=>f>70?"high":f>40?"medium":"low",l=f=>{switch(f){case"high":return"text-red-600 bg-red-50";case"medium":return"text-yellow-600 bg-yellow-50";case"low":return"text-green-600 bg-green-50"}},c=((u=e[0])==null?void 0:u.users_entered)||0,d=((h=e[e.length-1])==null?void 0:h.conversion_rate)||0;return s.jsxs(He,{className:`glass-card inner-glow ${n}`,children:[s.jsx(xr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Cr,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(So,{className:"w-5 h-5 text-synth-pink"}),t]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Be,{variant:"outline",className:"text-blue-600 border-blue-200",children:[i(c)," Total Users"]}),s.jsxs(Be,{variant:"outline",className:"text-green-600 border-green-200",children:[d.toFixed(1),"% Final Conversion"]})]})]})}),s.jsxs(st,{className:"space-y-4",children:[s.jsx("div",{className:"space-y-3",children:e.map((f,p)=>{const x=p===e.length-1,g=o(f.drop_off_rate),v=a(f.stage_order);return s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"flex items-center gap-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:f.stage_name}),s.jsxs(Be,{variant:"outline",className:`text-xs ${l(g)}`,children:[f.conversion_rate.toFixed(1),"% conversion"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[i(f.users_entered),"  ",i(f.users_completed)]}),s.jsxs("p",{className:"text-xs text-gray-600",children:[f.average_time_spent.toFixed(1),"m avg time"]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-full h-8 bg-gray-200 rounded-lg overflow-hidden",children:s.jsx("div",{className:`h-full bg-gradient-to-r ${v} transition-all duration-500`,style:{width:`${f.users_completed/f.users_entered*100}%`}})}),f.drop_off_rate>0&&s.jsxs("div",{className:"absolute top-0 right-0 flex items-center gap-1",children:[s.jsx(tI,{className:"w-4 h-4 text-red-500"}),s.jsxs("span",{className:"text-xs text-red-600 font-medium",children:["-",f.drop_off_rate.toFixed(1),"%"]})]})]}),f.revenue_attributed>0&&s.jsx("div",{className:"mt-2 flex items-center gap-2",children:s.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["$",f.revenue_attributed.toFixed(0)," revenue"]})})]})}),!x&&s.jsx("div",{className:"flex justify-center my-2",children:s.jsx(jJ,{className:"w-4 h-4 text-gray-400"})})]},f.stage_name)})}),r&&s.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(rI,{className:"w-4 h-4 text-yellow-600"}),s.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Optimization Opportunities"})]}),s.jsxs("div",{className:"space-y-2",children:[e.filter(f=>f.drop_off_rate>40).map((f,p)=>s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full mt-2 flex-shrink-0"}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-xs font-medium text-gray-900",children:[f.stage_name," Stage"]}),s.jsxs("p",{className:"text-xs text-gray-600",children:[f.drop_off_rate.toFixed(1),"% drop-off rate - ",f.optimization_opportunities[0]]})]})]},p)),e.filter(f=>f.drop_off_rate>40).length===0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Jl,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-xs text-green-700",children:"Great! No significant drop-off issues detected."})]})]})]}),s.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Key Actions Across Funnel"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:Array.from(new Set(e.flatMap(f=>f.key_actions))).slice(0,6).map((f,p)=>s.jsx(Be,{variant:"secondary",className:"text-xs",children:f},p))})]})]})]})}function uq({sources:e,totalRevenue:t,title:r="Revenue Attribution",showConfidenceScores:n=!0,showTrends:i=!0,className:a=""}){var h,f;const o=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(p),l=p=>p>=.8?"text-green-600 bg-green-50":p>=.6?"text-yellow-600 bg-yellow-50":p>=.4?"text-orange-600 bg-orange-50":"text-red-600 bg-red-50",c=p=>p>=.8?"High":p>=.6?"Medium":p>=.4?"Low":"Very Low",d=p=>{const x=["from-blue-500 to-blue-600","from-green-500 to-green-600","from-purple-500 to-purple-600","from-pink-500 to-pink-600","from-yellow-500 to-yellow-600","from-indigo-500 to-indigo-600"];return x[p%x.length]},u=p=>p?s.jsxs("div",{className:`flex items-center gap-1 ${p>0?"text-green-600":"text-red-600"}`,children:[s.jsx(Sn,{className:`w-3 h-3 ${p<0?"rotate-180":""}`}),s.jsxs("span",{className:"text-xs",children:[Math.abs(p).toFixed(1),"%"]})]}):null;return s.jsxs(He,{className:`glass-card inner-glow ${a}`,children:[s.jsx(xr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Cr,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(bo,{className:"w-5 h-5 text-synth-pink"}),r]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o(t)}),s.jsx("p",{className:"text-sm text-gray-600",children:"Total Revenue"})]})]})}),s.jsxs(st,{className:"space-y-4",children:[s.jsx("div",{className:"space-y-3",children:e.map((p,x)=>s.jsxs("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-gray-100 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-10 h-10 bg-gradient-to-r ${d(x)} rounded-full flex items-center justify-center`,children:s.jsx(bo,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 capitalize",children:p.source}),s.jsxs("p",{className:"text-sm text-gray-600",children:[p.attribution_window,"h attribution window"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-gray-900",children:o(p.revenue)}),s.jsxs("p",{className:"text-sm text-gray-600",children:[p.percentage.toFixed(1),"% of total"]})]})]}),s.jsx("div",{className:"mb-3",children:s.jsx("div",{className:"w-full h-3 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full bg-gradient-to-r ${d(x)} transition-all duration-500`,style:{width:`${p.percentage}%`}})})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[n&&s.jsxs(Be,{variant:"outline",className:`text-xs ${l(p.confidence_score)}`,children:[c(p.confidence_score)," Confidence"]}),i&&u(p.trend)]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:"text-xs text-gray-600",children:["Confidence: ",(p.confidence_score*100).toFixed(0),"%"]})})]})]},p.source))}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[s.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Gk,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Top Source"})]}),s.jsx("p",{className:"text-lg font-bold text-blue-900",children:((h=e[0])==null?void 0:h.source)||"N/A"}),s.jsxs("p",{className:"text-xs text-blue-700",children:[(f=e[0])==null?void 0:f.percentage.toFixed(1),"% of revenue"]})]}),s.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Bu,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-900",children:"Avg Confidence"})]}),s.jsxs("p",{className:"text-lg font-bold text-green-900",children:[(e.reduce((p,x)=>p+x.confidence_score,0)/e.length*100).toFixed(0),"%"]}),s.jsx("p",{className:"text-xs text-green-700",children:"Data quality score"})]})]}),e.some(p=>p.confidence_score<.5)&&s.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ag,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-900",children:"Data Quality Notice"})]}),s.jsx("p",{className:"text-xs text-yellow-800 mt-1",children:"Some revenue sources have low confidence scores. Consider improving data collection for more accurate attribution."})]}),s.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Attribution Insights"}),s.jsx("div",{className:"space-y-1",children:e.filter(p=>p.percentage>20).map((p,x)=>s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("span",{className:"text-gray-700",children:[p.source," drives ",p.percentage.toFixed(1),"% of revenue"]}),s.jsxs("span",{className:"text-gray-600",children:[p.attribution_window,"h window"]})]},x))})]})]})]})}function fq({metrics:e,title:t="Engagement Score",showBreakdown:r=!0,previousScore:n,className:i=""}){const a=h=>h>=80?"text-green-600":h>=60?"text-yellow-600":h>=40?"text-orange-600":"text-red-600",o=h=>h>=80?"Excellent":h>=60?"Good":h>=40?"Fair":"Poor",l=h=>h>=80?"Outstanding engagement! Users are highly active and invested.":h>=60?"Good engagement levels. Room for improvement in some areas.":h>=40?"Moderate engagement. Focus on improving user experience.":"Low engagement. Significant improvements needed to retain users.",d=n?((h,f)=>{if(!f)return{value:0,isPositive:!0};const p=h-f;return{value:Math.abs(p),isPositive:p>=0}})(e.score,n):null,u=e.score/100*180;return s.jsxs(He,{className:`glass-card inner-glow ${i}`,children:[s.jsx(xr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Cr,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(uo,{className:"w-5 h-5 text-synth-pink"}),t]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Be,{variant:"outline",className:`${a(e.score)} border-current`,children:o(e.score)}),d&&s.jsxs("div",{className:`flex items-center gap-1 text-xs ${d.isPositive?"text-green-600":"text-red-600"}`,children:[s.jsx(Sn,{className:`w-3 h-3 ${d.isPositive?"":"rotate-180"}`}),d.value.toFixed(0)," pts"]})]})]})}),s.jsxs(st,{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-center",children:s.jsxs("div",{className:"relative w-48 h-24",children:[s.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 200 100",children:[s.jsx("path",{d:"M 20 80 A 60 60 0 0 1 180 80",stroke:"#e5e7eb",strokeWidth:"12",fill:"none",strokeLinecap:"round"}),s.jsx("path",{d:"M 20 80 A 60 60 0 0 1 180 80",stroke:e.score>=80?"#10b981":e.score>=60?"#f59e0b":e.score>=40?"#f97316":"#ef4444",strokeWidth:"12",fill:"none",strokeLinecap:"round",strokeDasharray:`${u*1.05} 314`,strokeDashoffset:"157",className:"transition-all duration-1000 ease-out"})]}),s.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[s.jsx("div",{className:`text-3xl font-bold ${a(e.score)}`,children:e.score}),s.jsx("div",{className:"text-sm text-gray-600",children:"/ 100"})]})]})}),s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-sm text-gray-700",children:l(e.score)})}),r&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Engagement Breakdown"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 rounded-lg",children:[s.jsx(ai,{className:"w-4 h-4 text-blue-600"}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.floor(e.sessionDuration/6e4),"m"]}),s.jsx("p",{className:"text-xs text-gray-600",children:"Session Time"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 rounded-lg",children:[s.jsx(QD,{className:"w-4 h-4 text-green-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.interactionCount}),s.jsx("p",{className:"text-xs text-gray-600",children:"Interactions"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 rounded-lg",children:[s.jsx(lf,{className:"w-3 h-3 text-gray-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-900",children:e.pageViews}),s.jsx("p",{className:"text-xs text-gray-600",children:"Views"})]})]}),s.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 rounded-lg",children:[s.jsx(hs,{className:"w-3 h-3 text-gray-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-900",children:e.likes}),s.jsx("p",{className:"text-xs text-gray-600",children:"Likes"})]})]}),s.jsxs("div",{className:"flex items-center gap-1 p-2 bg-gray-50 rounded-lg",children:[s.jsx(uo,{className:"w-3 h-3 text-gray-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-900",children:e.shares}),s.jsx("p",{className:"text-xs text-gray-600",children:"Shares"})]})]})]}),e.bounceRate>70&&s.jsxs("div",{className:"p-2 bg-red-50 border border-red-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),s.jsxs("span",{className:"text-xs font-medium text-red-900",children:["High bounce rate: ",e.bounceRate.toFixed(1),"%"]})]}),s.jsx("p",{className:"text-xs text-red-700 mt-1",children:"Consider improving content relevance and user experience"})]})]}),s.jsxs("div",{className:"p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Improvement Suggestions"}),s.jsxs("div",{className:"space-y-1",children:[e.score<60&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full"}),s.jsx("span",{className:"text-xs text-gray-700",children:"Increase session duration by improving content quality"})]}),e.interactionCount<5&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full"}),s.jsx("span",{className:"text-xs text-gray-700",children:"Add more interactive elements to boost engagement"})]}),e.bounceRate>50&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full"}),s.jsx("span",{className:"text-xs text-gray-700",children:"Optimize page load times and content relevance"})]}),e.score>=80&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-xs text-green-700",children:"Excellent engagement! Keep up the great work"})]})]})]})]})]})}function hq({data:e,title:t="Trend Analysis",valueLabel:r="Value",showTrend:n=!0,showForecast:i=!1,className:a=""}){var g;const o=v=>v>=1e6?`${(v/1e6).toFixed(1)}M`:v>=1e3?`${(v/1e3).toFixed(1)}K`:v.toString(),l=v=>new Date(v).toLocaleDateString("en-US",{month:"short",day:"numeric"}),c=v=>{if(v.length<2)return{direction:"flat",percentage:0};const _=v[0].value,b=(v[v.length-1].value-_)/_*100;return Math.abs(b)<1?{direction:"flat",percentage:0}:{direction:b>0?"up":"down",percentage:Math.abs(b)}},d=()=>Math.max(...e.map(v=>v.value)),u=()=>Math.min(...e.map(v=>v.value)),h=(v,_,w)=>_===w?50:(v-w)/(_-w)*100,f=c(e),p=d(),x=u();return s.jsxs(He,{className:`glass-card inner-glow ${a}`,children:[s.jsx(xr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Cr,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Bu,{className:"w-5 h-5 text-synth-pink"}),t]}),n&&s.jsxs("div",{className:"flex items-center gap-2",children:[f.direction==="up"&&s.jsxs(Be,{variant:"outline",className:"text-green-600 border-green-200",children:[s.jsx(Sn,{className:"w-3 h-3 mr-1"}),"+",f.percentage.toFixed(1),"%"]}),f.direction==="down"&&s.jsxs(Be,{variant:"outline",className:"text-red-600 border-red-200",children:[s.jsx(tI,{className:"w-3 h-3 mr-1"}),"-",f.percentage.toFixed(1),"%"]}),f.direction==="flat"&&s.jsxs(Be,{variant:"outline",className:"text-gray-600 border-gray-200",children:[s.jsx(So,{className:"w-3 h-3 mr-1"}),"Stable"]})]})]})}),s.jsxs(st,{className:"space-y-4",children:[s.jsxs("div",{className:"relative h-48 bg-gradient-to-b from-gray-50 to-white rounded-lg p-4",children:[s.jsx("div",{className:"absolute inset-4",children:[0,25,50,75,100].map((v,_)=>s.jsx("div",{className:"absolute w-full border-t border-gray-200",style:{top:`${v}%`}},_))}),s.jsxs("svg",{className:"absolute inset-4 w-full h-full",children:[s.jsx("polyline",{fill:"none",stroke:"#8b5cf6",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",points:e.map((v,_)=>{const w=_/(e.length-1)*100,b=100-h(v.value,p,x);return`${w},${b}`}).join(" ")}),e.map((v,_)=>{const w=_/(e.length-1)*100,b=100-h(v.value,p,x);return s.jsx("circle",{cx:w,cy:b,r:"4",fill:"#8b5cf6",className:"hover:r-6 transition-all duration-200"},_)})]}),s.jsxs("div",{className:"absolute left-0 top-4 bottom-4 flex flex-col justify-between text-xs text-gray-600",children:[s.jsx("span",{children:o(p)}),s.jsx("span",{children:o((p+x)/2)}),s.jsx("span",{children:o(x)})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-blue-900",children:o(((g=e[e.length-1])==null?void 0:g.value)||0)}),s.jsx("div",{className:"text-xs text-blue-700",children:"Current"})]}),s.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-green-900",children:o(p)}),s.jsx("div",{className:"text-xs text-green-700",children:"Peak"})]}),s.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-purple-900",children:o(e.reduce((v,_)=>v+_.value,0)/e.length)}),s.jsx("div",{className:"text-xs text-purple-700",children:"Average"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Recent Data"}),s.jsx("div",{className:"space-y-1",children:e.slice(-5).map((v,_)=>s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-gray-600",children:l(v.date)}),s.jsx("span",{className:"font-medium text-gray-900",children:o(v.value)}),v.label&&s.jsx("span",{className:"text-gray-500",children:v.label})]},_))})]}),n&&s.jsxs("div",{className:"p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Et,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Trend Analysis"})]}),s.jsxs("p",{className:"text-xs text-gray-700",children:[f.direction==="up"&&`Showing ${f.percentage.toFixed(1)}% growth over the period`,f.direction==="down"&&`Showing ${f.percentage.toFixed(1)}% decline over the period`,f.direction==="flat"&&"Values have remained relatively stable"]})]})]})]})}class da{static logError(t,r,n,i="medium",a="unknown"){return E(this,null,function*(){const o=typeof r=="string"?r:r.message;console.error(`[${i.toUpperCase()}] ${t}:`,o,n)})}static logValidationError(t,r,n){return E(this,null,function*(){yield this.logError(`validation_error: ${t}`,`Validation failed: ${r.join(", ")}`,{validation_errors:r,invalid_data:n},"medium","validation")})}static logNetworkError(t,r,n,i){return E(this,null,function*(){yield this.logError(`network_error: ${t}`,r,{url:n,status_code:i},"high","network")})}static logDatabaseError(t,r,n,i){return E(this,null,function*(){yield this.logError(`database_error: ${t}`,r,{query:n,table:i},"high","database")})}static logAuthError(t,r,n){return E(this,null,function*(){yield this.logError(`auth_error: ${t}`,r,{user_id:n},"medium","authentication")})}static logBusinessLogicError(t,r,n){return E(this,null,function*(){yield this.logError(`business_logic_error: ${t}`,r,n,"medium","business_logic")})}static getErrorStats(t=24){return E(this,null,function*(){return{total_errors:0,errors_by_category:{},errors_by_severity:{},recent_errors:[],error_rate:0}})}static getErrorsByCategory(t,r=50){return E(this,null,function*(){return[]})}static getCriticalErrors(t=20){return E(this,null,function*(){return[]})}static resolveError(t,r){return E(this,null,function*(){return!1})}static getErrorTrends(t=7){return E(this,null,function*(){return[]})}static getErrorCategories(){return this.ERROR_CATEGORIES}static getSeverityLevels(){return this.SEVERITY_LEVELS}}_r(da,"ERROR_CATEGORIES",{validation:"Data validation errors",network:"Network and API errors",database:"Database operation errors",authentication:"User authentication errors",business_logic:"Application logic errors",unknown:"Uncategorized errors"}),_r(da,"SEVERITY_LEVELS",{low:"Minor issues, non-blocking",medium:"Moderate issues, may affect functionality",high:"Serious issues, significant impact",critical:"Critical issues, system-breaking"});const va=da.logError.bind(da);da.logValidationError.bind(da);da.logNetworkError.bind(da);da.logDatabaseError.bind(da);da.logAuthError.bind(da);da.logBusinessLogicError.bind(da);class O4{static analyzeFunnel(t,r,n){return E(this,null,function*(){try{const{data:i}=yield P.from("users").select("user_id").eq("account_type",t);if(!i||i.length===0)return this.createEmptyFunnel(t);const a=i.map(g=>g.user_id),{data:o,error:l}=yield P.from("interactions").select("*").in("user_id",a).gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString()).order("occurred_at",{ascending:!0});if(l)return yield va("funnel_analysis_error",l,{userType:t,timeRange:r}),this.createEmptyFunnel(t);if(!o)return this.createEmptyFunnel(t);const c=yield this.analyzeFunnelStages(o,t),d=new Set(o.map(g=>g.user_id)).size,u=this.calculateOverallConversionRate(c),h=this.calculateTotalRevenue(c),f=this.calculateAverageTimeToConversion(o),p=this.identifyTopDropOffStages(c),x=this.generateRecommendations(c,t);return{funnel_id:`${t}_funnel_${Date.now()}`,funnel_name:`${t.charAt(0).toUpperCase()+t.slice(1)} Conversion Funnel`,total_users:d,overall_conversion_rate:u,stages:c,total_revenue:h,average_time_to_conversion:f,top_drop_off_stages:p,recommendations:x}}catch(i){return yield va("funnel_analysis_exception",i,{userType:t,timeRange:r}),this.createEmptyFunnel(t)}})}static trackUserJourney(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("interactions").select("*").eq("user_id",t).gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString()).order("occurred_at",{ascending:!0});if(i)return yield va("user_journey_tracking_error",i,{userId:t,timeRange:r}),[];if(!n||n.length===0)return[];const a=this.groupInteractionsBySession(n),o=[];for(const l of a){const c=this.analyzeUserJourney(t,l);o.push(c)}return o}catch(n){return yield va("user_journey_tracking_exception",n,{userId:t,timeRange:r}),[]}})}static compareFunnels(t,r){return E(this,null,function*(){const n=r.overall_conversion_rate-t.overall_conversion_rate,i=r.total_revenue-t.total_revenue,a=t.average_time_to_conversion-r.average_time_to_conversion;return{funnel_a:t,funnel_b:r,improvement_metrics:{conversion_rate_improvement:Math.round(n*100)/100,revenue_improvement:Math.round(i*100)/100,time_improvement:Math.round(a*100)/100}}})}static getOptimizationRecommendations(t){return E(this,null,function*(){const r=[];for(const n of t.top_drop_off_stages)n.drop_off_rate>50&&r.push({priority:"high",category:"conversion",title:`Reduce Drop-off at ${n.stage} Stage`,description:`${n.users_lost} users are dropping off at the ${n.stage} stage (${n.drop_off_rate}% drop-off rate)`,expected_impact:`Could improve conversion by ${Math.round(n.drop_off_rate*.3)}%`,implementation_effort:"medium"});return t.overall_conversion_rate<5&&r.push({priority:"high",category:"conversion",title:"Improve Overall Conversion Rate",description:`Current conversion rate is ${t.overall_conversion_rate}%, which is below industry standards`,expected_impact:"Could double conversion rate with optimization",implementation_effort:"high"}),t.average_time_to_conversion>7&&r.push({priority:"medium",category:"engagement",title:"Reduce Time to Conversion",description:`Average time to conversion is ${t.average_time_to_conversion} days`,expected_impact:"Could reduce time to conversion by 30-50%",implementation_effort:"medium"}),r})}static analyzeFunnelStages(t,r){return E(this,null,function*(){const n=[],i=Object.values(this.FUNNEL_STAGES);for(const a of i){const o=t.filter(g=>a.events.includes(g.event_type)),l=new Set(o.map(g=>g.user_id)).size,c=this.calculateUsersCompleted(o,a.order),d=l>0?c/l*100:0,u=l>0?(l-c)/l*100:0,h=this.calculateAverageTimeSpent(o),f=this.calculateStageRevenue(o),p=this.identifyKeyActions(o),x=this.identifyOptimizationOpportunities(a,o);n.push({stage_name:a.name,stage_order:a.order,users_entered:l,users_completed:c,conversion_rate:Math.round(d*100)/100,drop_off_rate:Math.round(u*100)/100,average_time_spent:Math.round(h*100)/100,revenue_attributed:Math.round(f*100)/100,key_actions:p,optimization_opportunities:x})}return n})}static calculateUsersCompleted(t,r){const n=this.getNextStageEvents(r),i=t.filter(a=>n.includes(a.event_type));return new Set(i.map(a=>a.user_id)).size}static getNextStageEvents(t){const n=Object.values(this.FUNNEL_STAGES).find(i=>i.order===t+1);return n?n.events:[]}static calculateAverageTimeSpent(t){if(t.length===0)return 0;const n=this.groupInteractionsBySession(t).map(i=>{const a=new Date(i[0].occurred_at);return(new Date(i[i.length-1].occurred_at).getTime()-a.getTime())/(1e3*60)});return n.reduce((i,a)=>i+a,0)/n.length}static calculateStageRevenue(t){return t.filter(r=>r.event_type==="ticket_click"||r.event_type==="form_submit"),0}static identifyKeyActions(t){const r={};return t.forEach(n=>{r[n.event_type]=(r[n.event_type]||0)+1}),Object.entries(r).sort(([,n],[,i])=>i-n).slice(0,3).map(([n])=>n)}static identifyOptimizationOpportunities(t,r){const n=[];return r.length===0?(n.push("No user activity in this stage - consider improving discovery"),n):(this.calculateStageConversionRate(r)<20&&n.push("Low conversion rate - consider improving user experience"),this.calculateAverageTimeSpent(r)>10&&n.push("Users spending too much time - consider simplifying the process"),n)}static calculateStageConversionRate(t){const r=new Set(t.map(i=>i.user_id)).size,n=new Set(t.filter(i=>i.event_type==="ticket_click"||i.event_type==="form_submit").map(i=>i.user_id)).size;return r>0?n/r*100:0}static groupInteractionsBySession(t){const r={};return t.forEach(n=>{const i=n.session_id||"default";r[i]||(r[i]=[]),r[i].push(n)}),Object.values(r)}static analyzeUserJourney(t,r){const n=r[0].occurred_at,i=r[r.length-1].occurred_at,a=new Date(i).getTime()-new Date(n).getTime(),o=this.identifyStagesCompleted(r),l=this.checkConversionAchieved(r),c=this.calculateJourneyRevenue(r),d=r.map(u=>({timestamp:u.occurred_at,stage:this.mapEventToStage(u.event_type),action:u.event_type,entity_id:u.entity_id,metadata:u.metadata}));return{user_id:t,journey_id:r[0].session_id||crypto.randomUUID(),start_time:n,end_time:i,stages_completed:o,total_duration:a,conversion_achieved:l,revenue_generated:c,touchpoints:d}}static identifyStagesCompleted(t){const r=new Set;return t.forEach(n=>{const i=this.mapEventToStage(n.event_type);i&&r.add(i)}),Array.from(r)}static mapEventToStage(t){for(const[r,n]of Object.entries(this.FUNNEL_STAGES))if(n.events.includes(t))return r;return null}static checkConversionAchieved(t){return t.some(r=>r.event_type==="ticket_click"||r.event_type==="form_submit")}static calculateJourneyRevenue(t){return t.filter(n=>n.event_type==="ticket_click"||n.event_type==="form_submit").length*50}static calculateOverallConversionRate(t){if(t.length===0)return 0;const r=t[0],n=t[t.length-1];return r.users_entered>0?n.users_completed/r.users_entered*100:0}static calculateTotalRevenue(t){return t.reduce((r,n)=>r+n.revenue_attributed,0)}static calculateAverageTimeToConversion(t){const n=this.groupInteractionsBySession(t).filter(a=>a.some(o=>o.event_type==="ticket_click"||o.event_type==="form_submit"));return n.length===0?0:n.reduce((a,o)=>{const l=new Date(o[0].occurred_at),c=new Date(o[o.length-1].occurred_at);return a+(c.getTime()-l.getTime())},0)/(n.length*(1e3*60*60*24))}static identifyTopDropOffStages(t){return t.map(r=>({stage:r.stage_name,drop_off_rate:r.drop_off_rate,users_lost:r.users_entered-r.users_completed})).sort((r,n)=>n.drop_off_rate-r.drop_off_rate).slice(0,3)}static generateRecommendations(t,r){const n=[],i=t.filter(o=>o.drop_off_rate>50);i.length>0&&n.push(`Focus on reducing drop-off in ${i.map(o=>o.stage_name).join(", ")} stages`);const a=t.filter(o=>o.conversion_rate<20);return a.length>0&&n.push(`Improve conversion rates in ${a.map(o=>o.stage_name).join(", ")} stages`),r==="user"?(n.push("Consider implementing social proof and user testimonials"),n.push("Add personalized recommendations based on music taste")):r==="creator"?(n.push("Provide detailed analytics and performance metrics"),n.push("Offer exclusive content and early access features")):r==="business"&&(n.push("Showcase venue capacity and past successful events"),n.push("Provide detailed ROI and revenue projections")),n}static createEmptyFunnel(t){return{funnel_id:`${t}_funnel_empty`,funnel_name:`${t.charAt(0).toUpperCase()+t.slice(1)} Conversion Funnel`,total_users:0,overall_conversion_rate:0,stages:[],total_revenue:0,average_time_to_conversion:0,top_drop_off_stages:[],recommendations:["No data available for analysis"]}}}_r(O4,"FUNNEL_STAGES",{discovery:{name:"Discovery",order:1,events:["view","search","navigate"],description:"User discovers content or platform"},interest:{name:"Interest",order:2,events:["interest","like","follow","share"],description:"User shows interest in content"},consideration:{name:"Consideration",order:3,events:["click","navigate","view"],description:"User considers taking action"},conversion:{name:"Conversion",order:4,events:["ticket_click","form_submit","profile_update"],description:"User completes desired action"}});class hh{static calculateTicketRevenue(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("interactions").select("*").eq("user_id",t).eq("event_type","click").eq("entity_type","ticket_link").gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString());if(i)return yield va("revenue_calculation_error",i,{userId:t,timeRange:r}),[];const a=[];for(const o of n||[]){const l=this.estimateTicketPrice(o.metadata),c=this.calculateConfidenceScore(o.metadata);a.push({id:crypto.randomUUID(),interaction_id:o.id,revenue_type:"ticket_click",estimated_amount:l,currency:"USD",attribution_window_hours:this.ATTRIBUTION_WINDOWS.ticket_click,confidence_score:c,user_id:t,entity_id:o.entity_id,entity_type:o.entity_type,created_at:new Date().toISOString(),metadata:{original_click:o,estimation_method:"ticket_click_analysis"}})}return a}catch(n){return yield va("ticket_revenue_calculation_error",n,{userId:t,timeRange:r}),[]}})}static calculateSubscriptionRevenue(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("interactions").select("*").eq("user_id",t).in("event_type",["profile_update","form_submit"]).gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString());if(i)return yield va("subscription_revenue_calculation_error",i,{userId:t,timeRange:r}),[];const a=[],o=(n==null?void 0:n.filter(l=>{const c=l.metadata;return(c==null?void 0:c.field)==="subscription_tier"||(c==null?void 0:c.formType)==="subscription"}))||[];for(const l of o){const c=this.estimateSubscriptionValue(l.metadata),d=this.calculateSubscriptionConfidence(l.metadata);a.push({id:crypto.randomUUID(),interaction_id:l.id,revenue_type:"subscription",estimated_amount:c,currency:"USD",attribution_window_hours:this.ATTRIBUTION_WINDOWS.subscription,confidence_score:d,user_id:t,entity_id:l.entity_id,entity_type:l.entity_type,created_at:new Date().toISOString(),metadata:{original_interaction:l,estimation_method:"subscription_analysis"}})}return a}catch(n){return yield va("subscription_revenue_calculation_error",n,{userId:t,timeRange:r}),[]}})}static calculateAffiliateRevenue(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("interactions").select("*").eq("user_id",t).eq("event_type","share").gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString());if(i)return yield va("affiliate_revenue_calculation_error",i,{userId:t,timeRange:r}),[];const a=[];for(const o of n||[]){const l=this.estimateAffiliateCommission(o.metadata),c=this.calculateAffiliateConfidence(o.metadata);l>0&&a.push({id:crypto.randomUUID(),interaction_id:o.id,revenue_type:"affiliate",estimated_amount:l,currency:"USD",attribution_window_hours:this.ATTRIBUTION_WINDOWS.affiliate,confidence_score:c,user_id:t,entity_id:o.entity_id,entity_type:o.entity_type,created_at:new Date().toISOString(),metadata:{original_share:o,estimation_method:"affiliate_analysis"}})}return a}catch(n){return yield va("affiliate_revenue_calculation_error",n,{userId:t,timeRange:r}),[]}})}static getUserRevenueMetrics(t,r){return E(this,null,function*(){try{return{total_revenue:0,revenue_by_type:{},conversion_rate:0,average_order_value:0,revenue_per_user:0,top_revenue_sources:[]}}catch(n){return yield va("revenue_metrics_calculation_error",n,{userId:t,timeRange:r}),{total_revenue:0,revenue_by_type:{},conversion_rate:0,average_order_value:0,revenue_per_user:0,top_revenue_sources:[]}}})}static analyzeConversionFunnel(t,r){return E(this,null,function*(){try{const{data:n}=yield P.from("interactions").select("*").eq("user_id",t).gte("occurred_at",r.start.toISOString()).lte("occurred_at",r.end.toISOString());if(!n)return[];const i=[{name:"discovery",events:["view","search"]},{name:"interest",events:["interest","like","follow"]},{name:"consideration",events:["click","navigate"]},{name:"conversion",events:["ticket_click","form_submit"]}],a=[];let o=0;for(let l=0;l<i.length;l++){const c=i[l],d=n.filter(x=>c.events.includes(x.event_type)),u=new Set(d.map(x=>x.user_id)).size,h=o>0?u/o*100:100,f=o>0?(o-u)/o*100:0;a.push({stage:c.name,users:u,conversion_rate:Math.round(h*100)/100,drop_off_rate:Math.round(f*100)/100,revenue_attributed:Math.round(0*100)/100}),o=u}return a}catch(n){return yield va("conversion_funnel_analysis_error",n,{userId:t,timeRange:r}),[]}})}static getRevenueTrends(t,r="day"){return E(this,null,function*(){try{const{data:n}=yield P.from("interactions").select("*").gte("occurred_at",t.start.toISOString()).lte("occurred_at",t.end.toISOString()).in("event_type",["click","ticket_click","form_submit"]);if(!n)return[];const i={};return n.forEach(a=>{const o=new Date(a.occurred_at);let l;switch(r){case"day":l=o.toISOString().split("T")[0];break;case"week":const c=new Date(o);c.setDate(o.getDate()-o.getDay()),l=c.toISOString().split("T")[0];break;case"month":l=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`;break;default:l=o.toISOString().split("T")[0]}i[l]||(i[l]={revenue:0,conversions:0,interactions:0}),i[l].interactions++,a.event_type==="ticket_click"&&(i[l].conversions++,i[l].revenue+=0)}),Object.entries(i).map(([a,o])=>({date:a,revenue:o.revenue,conversions:o.conversions,conversion_rate:o.interactions>0?o.conversions/o.interactions*100:0,average_order_value:o.conversions>0?o.revenue/o.conversions:0})).sort((a,o)=>a.date.localeCompare(o.date))}catch(n){return yield va("revenue_trends_calculation_error",n,{timeRange:t,groupBy:r}),[]}})}static estimateTicketPrice(t){return t!=null&&t.price&&typeof t.price=="number"?t.price:this.ESTIMATED_TICKET_PRICE}static estimateSubscriptionValue(t){switch((t==null?void 0:t.newTier)||(t==null?void 0:t.subscription_tier)){case"premium":return this.ESTIMATED_SUBSCRIPTION_PRICE;case"professional":return this.ESTIMATED_SUBSCRIPTION_PRICE*2;case"enterprise":return this.ESTIMATED_SUBSCRIPTION_PRICE*5;default:return 0}}static estimateAffiliateCommission(t){const r=t==null?void 0:t.platform;return r==="instagram"||r==="twitter"||r==="facebook"?this.ESTIMATED_TICKET_PRICE*this.ESTIMATED_AFFILIATE_COMMISSION:0}static calculateConfidenceScore(t){let r=.5;return t!=null&&t.price&&(r+=.3),t!=null&&t.venue_name&&(r+=.1),t!=null&&t.artist_name&&(r+=.1),Math.min(r,1)}static calculateSubscriptionConfidence(t){let r=.3;return t!=null&&t.newTier&&(r+=.4),t!=null&&t.oldTier&&(r+=.2),t!=null&&t.changeType&&(r+=.1),Math.min(r,1)}static calculateAffiliateConfidence(t){let r=.2;return t!=null&&t.platform&&(r+=.3),t!=null&&t.reach&&(r+=.2),t!=null&&t.engagement&&(r+=.3),Math.min(r,1)}}_r(hh,"ESTIMATED_TICKET_PRICE",50),_r(hh,"ESTIMATED_SUBSCRIPTION_PRICE",4.99),_r(hh,"ESTIMATED_AFFILIATE_COMMISSION",.05),_r(hh,"ATTRIBUTION_WINDOWS",{ticket_click:24,subscription:30*24,affiliate:7*24});class Ua{static getUserPromotions(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("event_promotions").select(`
          *,
          event:jambase_events!event_promotions_event_id_fkey(
            id,
            title,
            artist_name,
            venue_name,
            event_date,
            poster_image_url
          )
        `).eq("promoted_by_user_id",t).order("created_at",{ascending:!1});if(n)throw n;if(r&&r.length>0)for(const a of r)try{yield dl.syncPromotionMetrics(a.id)}catch(o){console.error(`Error syncing metrics for promotion ${a.id}:`,o)}const i=(r==null?void 0:r.map(a=>a.event_id))||[];if(i.length>0){const a=yield ns.getAllUserInteractions(i,void 0,["event"]),o=yield ns.getAllInterestedUsers(i);for(const l of r){const c=(a==null?void 0:a.filter(p=>p.entity_id===l.event_id))||[],d=(o==null?void 0:o.filter(p=>p.jambase_event_id===l.event_id))||[],u=c.filter(p=>p.event_type==="view").length,h=c.filter(p=>p.event_type==="click").length,f=d.length;l.impressions=u,l.clicks=h,l.conversions=f}}return r||[]}catch(r){throw console.error("Error fetching user promotions:",r),r}})}static getPromotionMetrics(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("event_promotions").select(`
          *,
          event:jambase_events!event_promotions_event_id_fkey(
            id,
            title,
            artist_name,
            venue_name,
            event_date
          )
        `).eq("id",t).single();if(n)throw n;if(!r)return null;const i=r.impressions>0?r.clicks/r.impressions*100:0,a=r.clicks>0?r.conversions/r.clicks*100:0,o=r.clicks>0?r.price_paid/r.clicks:0,l=r.conversions>0?r.price_paid/r.conversions:0,d=r.conversions*25,u=d>0?(d-r.price_paid)/r.price_paid*100:-100;return{promotion_id:r.id,event_title:r.event.title,tier:r.promotion_tier,impressions:r.impressions,clicks:r.clicks,conversions:r.conversions,ctr:Math.round(i*100)/100,conversion_rate:Math.round(a*100)/100,cost_per_click:Math.round(o*100)/100,cost_per_conversion:Math.round(l*100)/100,roi:Math.round(u*100)/100,revenue_attributed:Math.round(d*100)/100}}catch(r){throw console.error("Error fetching promotion metrics:",r),r}})}static getPromotionPerformanceComparison(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("event_promotions").select(`
          *,
          event:jambase_events!event_promotions_event_id_fkey(
            id,
            title,
            artist_name,
            venue_name,
            event_date
          )
        `).eq("promoted_by_user_id",t).order("created_at",{ascending:!1});if(n)throw n;if(r&&r.length>0)for(const a of r)try{yield dl.syncPromotionMetrics(a.id)}catch(o){console.error(`Error syncing metrics for promotion ${a.id}:`,o)}const i=(r==null?void 0:r.map(a=>a.event_id))||[];if(i.length>0){const a=yield ns.getAllUserInteractions(i,void 0,["event"]),o=yield ns.getAllInterestedUsers(i);for(const l of r){const c=(a==null?void 0:a.filter(p=>p.entity_id===l.event_id))||[],d=(o==null?void 0:o.filter(p=>p.jambase_event_id===l.event_id))||[],u=c.filter(p=>p.event_type==="view").length,h=c.filter(p=>p.event_type==="click").length,f=d.length;l.impressions=u,l.clicks=h,l.conversions=f}}return r?r.map(a=>{const o=a.impressions>0?a.clicks/a.impressions*100:0,l=a.clicks>0?a.conversions/a.clicks*100:0,c=a.clicks>0?a.price_paid/a.clicks:0,d=a.conversions>0?a.price_paid/a.conversions:0,u=Math.ceil((new Date(a.expires_at).getTime()-new Date(a.starts_at).getTime())/(1e3*60*60*24)),f=a.conversions*25,p=f>0?(f-a.price_paid)/a.price_paid*100:-100;return{promotion_id:a.id,event_title:a.event.title,tier:a.promotion_tier,duration_days:u,total_spend:a.price_paid,impressions:a.impressions,clicks:a.clicks,conversions:a.conversions,ctr:Math.round(o*100)/100,conversion_rate:Math.round(l*100)/100,cost_per_click:Math.round(c*100)/100,cost_per_conversion:Math.round(d*100)/100,roi:Math.round(p*100)/100}}):[]}catch(r){throw console.error("Error fetching promotion comparison:",r),r}})}static getPromotionROI(t){return E(this,null,function*(){try{const r=yield this.getPromotionMetrics(t);if(!r)throw new Error("Promotion not found");const n=r.cost_per_conversion*r.conversions,i=r.revenue_attributed-n,a=Math.ceil(n/25);return{roi:r.roi,revenue_attributed:r.revenue_attributed,cost:n,profit:i,break_even_conversions:a}}catch(r){throw console.error("Error calculating promotion ROI:",r),r}})}static getPromotionTrends(t,r=30){return E(this,null,function*(){try{const n=new Date;n.setDate(n.getDate()-r);const{data:i,error:a}=yield P.from("event_promotions").select("event_id, price_paid, created_at").eq("promoted_by_user_id",t).gte("created_at",n.toISOString()).order("created_at",{ascending:!0});if(a)throw a;if(!i||i.length===0)return[];const o=i.map(u=>u.event_id),l=yield ns.getAllUserInteractions(o,void 0,["event"]),c=yield ns.getAllInterestedUsers(o),d=new Map;for(let u=0;u<r;u++){const h=new Date;h.setDate(h.getDate()-u);const f=h.toISOString().split("T")[0];d.set(f,{impressions:0,clicks:0,conversions:0,spend:0})}for(const u of i){const h=u.created_at.split("T")[0],f=(l==null?void 0:l.filter(w=>w.entity_id===u.event_id))||[],p=(c==null?void 0:c.filter(w=>w.jambase_event_id===u.event_id))||[],x=f.filter(w=>w.event_type==="view").length,g=f.filter(w=>w.event_type==="click").length,v=p.length,_=d.get(h)||{impressions:0,clicks:0,conversions:0,spend:0};d.set(h,{impressions:_.impressions+x,clicks:_.clicks+g,conversions:_.conversions+v,spend:_.spend+(u.price_paid||0)})}return Array.from(d.entries()).map(([u,h])=>M({date:u},h))}catch(n){throw console.error("Error fetching promotion trends:",n),n}})}static getActivePromotions(t=10){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("event_promotions").select(`
          *,
          event:jambase_events!event_promotions_event_id_fkey(
            id,
            title,
            artist_name,
            venue_name,
            event_date,
            poster_image_url
          )
        `).eq("promotion_status","active").lte("starts_at",new Date().toISOString()).gte("expires_at",new Date().toISOString()).order("created_at",{ascending:!1}).limit(t);if(n)throw n;return r||[]}catch(r){throw console.error("Error fetching active promotions:",r),r}})}}function mq({userId:e,enabled:t=!0}){const[r,n]=y.useState(!1),[i,a]=y.useState(null);return y.useEffect(()=>{if(!t||!e)return;const o=P.channel("promotion_analytics").on("postgres_changes",{event:"*",schema:"public",table:"event_promotions",filter:`promoted_by_user_id=eq.${e}`},l=>{console.log("Promotion data changed:",l),a(new Date),n(!0),setTimeout(()=>n(!1),5e3)}).on("postgres_changes",{event:"*",schema:"public",table:"jambase_events",filter:"active_promotion_id=is.not.null"},l=>{console.log("Event promotion status changed:",l),a(new Date),n(!0),setTimeout(()=>n(!1),5e3)}).subscribe();return()=>{P.removeChannel(o)}},[e,t]),{isLive:r,lastUpdate:i}}var Lxe=Array.isArray,ha=Lxe,Fxe=typeof Ks=="object"&&Ks&&Ks.Object===Object&&Ks,pq=Fxe,Uxe=pq,Bxe=typeof self=="object"&&self&&self.Object===Object&&self,zxe=Uxe||Bxe||Function("return this")(),Al=zxe,Vxe=Al,qxe=Vxe.Symbol,Gv=qxe,e9=Gv,gq=Object.prototype,Wxe=gq.hasOwnProperty,Hxe=gq.toString,r0=e9?e9.toStringTag:void 0;function Gxe(e){var t=Wxe.call(e,r0),r=e[r0];try{e[r0]=void 0;var n=!0}catch(a){}var i=Hxe.call(e);return n&&(t?e[r0]=r:delete e[r0]),i}var Yxe=Gxe,Kxe=Object.prototype,Zxe=Kxe.toString;function Xxe(e){return Zxe.call(e)}var Jxe=Xxe,t9=Gv,Qxe=Yxe,eye=Jxe,tye="[object Null]",rye="[object Undefined]",r9=t9?t9.toStringTag:void 0;function nye(e){return e==null?e===void 0?rye:tye:r9&&r9 in Object(e)?Qxe(e):eye(e)}var Ac=nye;function sye(e){return e!=null&&typeof e=="object"}var Tc=sye,iye=Ac,aye=Tc,oye="[object Symbol]";function lye(e){return typeof e=="symbol"||aye(e)&&iye(e)==oye}var ap=lye,cye=ha,dye=ap,uye=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,fye=/^\w*$/;function hye(e,t){if(cye(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||dye(e)?!0:fye.test(e)||!uye.test(e)||t!=null&&e in Object(t)}var R4=hye;function mye(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Fd=mye;const op=rn(Fd);var pye=Ac,gye=Fd,vye="[object AsyncFunction]",xye="[object Function]",yye="[object GeneratorFunction]",_ye="[object Proxy]";function wye(e){if(!gye(e))return!1;var t=pye(e);return t==xye||t==yye||t==vye||t==_ye}var M4=wye;const kr=rn(M4);var bye=Al,jye=bye["__core-js_shared__"],Nye=jye,qj=Nye,n9=function(){var e=/[^.]+$/.exec(qj&&qj.keys&&qj.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Sye(e){return!!n9&&n9 in e}var kye=Sye,Eye=Function.prototype,Cye=Eye.toString;function Pye(e){if(e!=null){try{return Cye.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var vq=Pye,Aye=M4,Tye=kye,Oye=Fd,Rye=vq,Mye=/[\\^$.*+?()[\]{}|]/g,Dye=/^\[object .+?Constructor\]$/,Iye=Function.prototype,$ye=Object.prototype,Lye=Iye.toString,Fye=$ye.hasOwnProperty,Uye=RegExp("^"+Lye.call(Fye).replace(Mye,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Bye(e){if(!Oye(e)||Tye(e))return!1;var t=Aye(e)?Uye:Dye;return t.test(Rye(e))}var zye=Bye;function Vye(e,t){return e==null?void 0:e[t]}var qye=Vye,Wye=zye,Hye=qye;function Gye(e,t){var r=Hye(e,t);return Wye(r)?r:void 0}var vf=Gye,Yye=vf,Kye=Yye(Object,"create"),S1=Kye,s9=S1;function Zye(){this.__data__=s9?s9(null):{},this.size=0}var Xye=Zye;function Jye(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Qye=Jye,e2e=S1,t2e="__lodash_hash_undefined__",r2e=Object.prototype,n2e=r2e.hasOwnProperty;function s2e(e){var t=this.__data__;if(e2e){var r=t[e];return r===t2e?void 0:r}return n2e.call(t,e)?t[e]:void 0}var i2e=s2e,a2e=S1,o2e=Object.prototype,l2e=o2e.hasOwnProperty;function c2e(e){var t=this.__data__;return a2e?t[e]!==void 0:l2e.call(t,e)}var d2e=c2e,u2e=S1,f2e="__lodash_hash_undefined__";function h2e(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=u2e&&t===void 0?f2e:t,this}var m2e=h2e,p2e=Xye,g2e=Qye,v2e=i2e,x2e=d2e,y2e=m2e;function lp(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}lp.prototype.clear=p2e;lp.prototype.delete=g2e;lp.prototype.get=v2e;lp.prototype.has=x2e;lp.prototype.set=y2e;var _2e=lp;function w2e(){this.__data__=[],this.size=0}var b2e=w2e;function j2e(e,t){return e===t||e!==e&&t!==t}var D4=j2e,N2e=D4;function S2e(e,t){for(var r=e.length;r--;)if(N2e(e[r][0],t))return r;return-1}var k1=S2e,k2e=k1,E2e=Array.prototype,C2e=E2e.splice;function P2e(e){var t=this.__data__,r=k2e(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():C2e.call(t,r,1),--this.size,!0}var A2e=P2e,T2e=k1;function O2e(e){var t=this.__data__,r=T2e(t,e);return r<0?void 0:t[r][1]}var R2e=O2e,M2e=k1;function D2e(e){return M2e(this.__data__,e)>-1}var I2e=D2e,$2e=k1;function L2e(e,t){var r=this.__data__,n=$2e(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var F2e=L2e,U2e=b2e,B2e=A2e,z2e=R2e,V2e=I2e,q2e=F2e;function cp(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}cp.prototype.clear=U2e;cp.prototype.delete=B2e;cp.prototype.get=z2e;cp.prototype.has=V2e;cp.prototype.set=q2e;var E1=cp,W2e=vf,H2e=Al,G2e=W2e(H2e,"Map"),I4=G2e,i9=_2e,Y2e=E1,K2e=I4;function Z2e(){this.size=0,this.__data__={hash:new i9,map:new(K2e||Y2e),string:new i9}}var X2e=Z2e;function J2e(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Q2e=J2e,e_e=Q2e;function t_e(e,t){var r=e.__data__;return e_e(t)?r[typeof t=="string"?"string":"hash"]:r.map}var C1=t_e,r_e=C1;function n_e(e){var t=r_e(this,e).delete(e);return this.size-=t?1:0,t}var s_e=n_e,i_e=C1;function a_e(e){return i_e(this,e).get(e)}var o_e=a_e,l_e=C1;function c_e(e){return l_e(this,e).has(e)}var d_e=c_e,u_e=C1;function f_e(e,t){var r=u_e(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var h_e=f_e,m_e=X2e,p_e=s_e,g_e=o_e,v_e=d_e,x_e=h_e;function dp(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}dp.prototype.clear=m_e;dp.prototype.delete=p_e;dp.prototype.get=g_e;dp.prototype.has=v_e;dp.prototype.set=x_e;var $4=dp,xq=$4,y_e="Expected a function";function L4(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(y_e);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var o=e.apply(this,n);return r.cache=a.set(i,o)||a,o};return r.cache=new(L4.Cache||xq),r}L4.Cache=xq;var yq=L4;const __e=rn(yq);var w_e=yq,b_e=500;function j_e(e){var t=w_e(e,function(n){return r.size===b_e&&r.clear(),n}),r=t.cache;return t}var N_e=j_e,S_e=N_e,k_e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,E_e=/\\(\\)?/g,C_e=S_e(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(k_e,function(r,n,i,a){t.push(i?a.replace(E_e,"$1"):n||r)}),t}),P_e=C_e;function A_e(e,t){for(var r=-1,n=e==null?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}var F4=A_e,a9=Gv,T_e=F4,O_e=ha,R_e=ap,M_e=1/0,o9=a9?a9.prototype:void 0,l9=o9?o9.toString:void 0;function _q(e){if(typeof e=="string")return e;if(O_e(e))return T_e(e,_q)+"";if(R_e(e))return l9?l9.call(e):"";var t=e+"";return t=="0"&&1/e==-M_e?"-0":t}var D_e=_q,I_e=D_e;function $_e(e){return e==null?"":I_e(e)}var wq=$_e,L_e=ha,F_e=R4,U_e=P_e,B_e=wq;function z_e(e,t){return L_e(e)?e:F_e(e,t)?[e]:U_e(B_e(e))}var bq=z_e,V_e=ap,q_e=1/0;function W_e(e){if(typeof e=="string"||V_e(e))return e;var t=e+"";return t=="0"&&1/e==-q_e?"-0":t}var P1=W_e,H_e=bq,G_e=P1;function Y_e(e,t){t=H_e(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[G_e(t[r++])];return r&&r==n?e:void 0}var U4=Y_e,K_e=U4;function Z_e(e,t,r){var n=e==null?void 0:K_e(e,t);return n===void 0?r:n}var jq=Z_e;const Za=rn(jq);function X_e(e){return e==null}var J_e=X_e;const Or=rn(J_e);var Q_e=Ac,ewe=ha,twe=Tc,rwe="[object String]";function nwe(e){return typeof e=="string"||!ewe(e)&&twe(e)&&Q_e(e)==rwe}var swe=nwe;const Qu=rn(swe);var Nq={exports:{}},gn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B4=Symbol.for("react.element"),z4=Symbol.for("react.portal"),A1=Symbol.for("react.fragment"),T1=Symbol.for("react.strict_mode"),O1=Symbol.for("react.profiler"),R1=Symbol.for("react.provider"),M1=Symbol.for("react.context"),iwe=Symbol.for("react.server_context"),D1=Symbol.for("react.forward_ref"),I1=Symbol.for("react.suspense"),$1=Symbol.for("react.suspense_list"),L1=Symbol.for("react.memo"),F1=Symbol.for("react.lazy"),awe=Symbol.for("react.offscreen"),Sq;Sq=Symbol.for("react.module.reference");function no(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case B4:switch(e=e.type,e){case A1:case O1:case T1:case I1:case $1:return e;default:switch(e=e&&e.$$typeof,e){case iwe:case M1:case D1:case F1:case L1:case R1:return e;default:return t}}case z4:return t}}}gn.ContextConsumer=M1;gn.ContextProvider=R1;gn.Element=B4;gn.ForwardRef=D1;gn.Fragment=A1;gn.Lazy=F1;gn.Memo=L1;gn.Portal=z4;gn.Profiler=O1;gn.StrictMode=T1;gn.Suspense=I1;gn.SuspenseList=$1;gn.isAsyncMode=function(){return!1};gn.isConcurrentMode=function(){return!1};gn.isContextConsumer=function(e){return no(e)===M1};gn.isContextProvider=function(e){return no(e)===R1};gn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===B4};gn.isForwardRef=function(e){return no(e)===D1};gn.isFragment=function(e){return no(e)===A1};gn.isLazy=function(e){return no(e)===F1};gn.isMemo=function(e){return no(e)===L1};gn.isPortal=function(e){return no(e)===z4};gn.isProfiler=function(e){return no(e)===O1};gn.isStrictMode=function(e){return no(e)===T1};gn.isSuspense=function(e){return no(e)===I1};gn.isSuspenseList=function(e){return no(e)===$1};gn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===A1||e===O1||e===T1||e===I1||e===$1||e===awe||typeof e=="object"&&e!==null&&(e.$$typeof===F1||e.$$typeof===L1||e.$$typeof===R1||e.$$typeof===M1||e.$$typeof===D1||e.$$typeof===Sq||e.getModuleId!==void 0)};gn.typeOf=no;Nq.exports=gn;var owe=Nq.exports,lwe=Ac,cwe=Tc,dwe="[object Number]";function uwe(e){return typeof e=="number"||cwe(e)&&lwe(e)==dwe}var kq=uwe;const fwe=rn(kq);var hwe=kq;function mwe(e){return hwe(e)&&e!=+e}var pwe=mwe;const up=rn(pwe);var Ao=function(t){return t===0?0:t>0?1:-1},pu=function(t){return Qu(t)&&t.indexOf("%")===t.length-1},_t=function(t){return fwe(t)&&!up(t)},gwe=function(t){return Or(t)},Ms=function(t){return _t(t)||Qu(t)},vwe=0,fp=function(t){var r=++vwe;return"".concat(t||"").concat(r)},ef=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!_t(t)&&!Qu(t))return n;var a;if(pu(t)){var o=t.indexOf("%");a=r*parseFloat(t.slice(0,o))/100}else a=+t;return up(a)&&(a=n),i&&a>r&&(a=r),a},ed=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},xwe=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},i=0;i<r;i++)if(!n[t[i]])n[t[i]]=!0;else return!0;return!1},ni=function(t,r){return _t(t)&&_t(r)?function(n){return t+n*(r-t)}:function(){return r}};function X2(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Za(n,t))===r})}var ywe=function(t,r){return _t(t)&&_t(r)?t-r:Qu(t)&&Qu(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function Mh(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function vS(e){"@babel/helpers - typeof";return vS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vS(e)}var _we=["viewBox","children"],wwe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],c9=["points","pathLength"],Wj={svg:_we,polygon:c9,polyline:c9},V4=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],J2=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(y.isValidElement(t)&&(n=t.props),!op(n))return null;var i={};return Object.keys(n).forEach(function(a){V4.includes(a)&&(i[a]=r||function(o){return n[a](n,o)})}),i},bwe=function(t,r,n){return function(i){return t(r,n,i),null}},Q2=function(t,r,n){if(!op(t)||vS(t)!=="object")return null;var i=null;return Object.keys(t).forEach(function(a){var o=t[a];V4.includes(a)&&typeof o=="function"&&(i||(i={}),i[a]=bwe(o,r,n))}),i},jwe=["children"],Nwe=["children"];function d9(e,t){if(e==null)return{};var r=Swe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Swe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function xS(e){"@babel/helpers - typeof";return xS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xS(e)}var u9={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},cc=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},f9=null,Hj=null,q4=function e(t){if(t===f9&&Array.isArray(Hj))return Hj;var r=[];return y.Children.forEach(t,function(n){Or(n)||(owe.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),Hj=r,f9=t,r};function Xa(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(i){return cc(i)}):n=[cc(t)],q4(e).forEach(function(i){var a=Za(i,"type.displayName")||Za(i,"type.name");n.indexOf(a)!==-1&&r.push(i)}),r}function ya(e,t){var r=Xa(e,t);return r&&r[0]}var h9=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,i=r.height;return!(!_t(n)||n<=0||!_t(i)||i<=0)},kwe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Ewe=function(t){return t&&t.type&&Qu(t.type)&&kwe.indexOf(t.type)>=0},Eq=function(t){return t&&xS(t)==="object"&&"clipDot"in t},Cwe=function(t,r,n,i){var a,o=(a=Wj==null?void 0:Wj[i])!==null&&a!==void 0?a:[];return r.startsWith("data-")||!kr(t)&&(i&&o.includes(r)||wwe.includes(r))||n&&V4.includes(r)},Pr=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if(y.isValidElement(t)&&(i=t.props),!op(i))return null;var a={};return Object.keys(i).forEach(function(o){var l;Cwe((l=i)===null||l===void 0?void 0:l[o],o,r,n)&&(a[o]=i[o])}),a},yS=function e(t,r){if(t===r)return!0;var n=y.Children.count(t);if(n!==y.Children.count(r))return!1;if(n===0)return!0;if(n===1)return m9(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var i=0;i<n;i++){var a=t[i],o=r[i];if(Array.isArray(a)||Array.isArray(o)){if(!e(a,o))return!1}else if(!m9(a,o))return!1}return!0},m9=function(t,r){if(Or(t)&&Or(r))return!0;if(!Or(t)&&!Or(r)){var n=t.props||{},i=n.children,a=d9(n,jwe),o=r.props||{},l=o.children,c=d9(o,Nwe);return i&&l?Mh(a,c)&&yS(i,l):!i&&!l?Mh(a,c):!1}return!1},p9=function(t,r){var n=[],i={};return q4(t).forEach(function(a,o){if(Ewe(a))n.push(a);else if(a){var l=cc(a.type),c=r[l]||{},d=c.handler,u=c.once;if(d&&(!u||!i[l])){var h=d(a,l,o);n.push(h),i[l]=!0}}}),n},Pwe=function(t){var r=t&&t.type;return r&&u9[r]?u9[r]:null},Awe=function(t,r){return q4(r).indexOf(t)},Twe=["children","width","height","viewBox","className","style","title","desc"];function _S(){return _S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_S.apply(this,arguments)}function Owe(e,t){if(e==null)return{};var r=Rwe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Rwe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function wS(e){var t=e.children,r=e.width,n=e.height,i=e.viewBox,a=e.className,o=e.style,l=e.title,c=e.desc,d=Owe(e,Twe),u=i||{width:r,height:n,x:0,y:0},h=Lr("recharts-surface",a);return Q.createElement("svg",_S({},Pr(d,!0,"svg"),{className:h,width:r,height:n,style:o,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),Q.createElement("title",null,l),Q.createElement("desc",null,c),t)}var Mwe=["children","className"];function bS(){return bS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bS.apply(this,arguments)}function Dwe(e,t){if(e==null)return{};var r=Iwe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Iwe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Rn=Q.forwardRef(function(e,t){var r=e.children,n=e.className,i=Dwe(e,Mwe),a=Lr("recharts-layer",n);return Q.createElement("g",bS({className:a},Pr(i,!0),{ref:t}),r)}),dc=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a]};function $we(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),r=r>i?i:r,r<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(i);++n<i;)a[n]=e[n+t];return a}var Lwe=$we,Fwe=Lwe;function Uwe(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:Fwe(e,t,r)}var Bwe=Uwe,zwe="\\ud800-\\udfff",Vwe="\\u0300-\\u036f",qwe="\\ufe20-\\ufe2f",Wwe="\\u20d0-\\u20ff",Hwe=Vwe+qwe+Wwe,Gwe="\\ufe0e\\ufe0f",Ywe="\\u200d",Kwe=RegExp("["+Ywe+zwe+Hwe+Gwe+"]");function Zwe(e){return Kwe.test(e)}var Cq=Zwe;function Xwe(e){return e.split("")}var Jwe=Xwe,Pq="\\ud800-\\udfff",Qwe="\\u0300-\\u036f",e1e="\\ufe20-\\ufe2f",t1e="\\u20d0-\\u20ff",r1e=Qwe+e1e+t1e,n1e="\\ufe0e\\ufe0f",s1e="["+Pq+"]",jS="["+r1e+"]",NS="\\ud83c[\\udffb-\\udfff]",i1e="(?:"+jS+"|"+NS+")",Aq="[^"+Pq+"]",Tq="(?:\\ud83c[\\udde6-\\uddff]){2}",Oq="[\\ud800-\\udbff][\\udc00-\\udfff]",a1e="\\u200d",Rq=i1e+"?",Mq="["+n1e+"]?",o1e="(?:"+a1e+"(?:"+[Aq,Tq,Oq].join("|")+")"+Mq+Rq+")*",l1e=Mq+Rq+o1e,c1e="(?:"+[Aq+jS+"?",jS,Tq,Oq,s1e].join("|")+")",d1e=RegExp(NS+"(?="+NS+")|"+c1e+l1e,"g");function u1e(e){return e.match(d1e)||[]}var f1e=u1e,h1e=Jwe,m1e=Cq,p1e=f1e;function g1e(e){return m1e(e)?p1e(e):h1e(e)}var v1e=g1e,x1e=Bwe,y1e=Cq,_1e=v1e,w1e=wq;function b1e(e){return function(t){t=w1e(t);var r=y1e(t)?_1e(t):void 0,n=r?r[0]:t.charAt(0),i=r?x1e(r,1).join(""):t.slice(1);return n[e]()+i}}var j1e=b1e,N1e=j1e,S1e=N1e("toUpperCase"),k1e=S1e;const U1=rn(k1e);function Pn(e){return function(){return e}}const Dq=Math.cos,e_=Math.sin,Vo=Math.sqrt,t_=Math.PI,B1=2*t_,SS=Math.PI,kS=2*SS,tu=1e-6,E1e=kS-tu;function Iq(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function C1e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Iq;const r=Tp(10,t);return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class P1e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Iq:C1e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,a,o){this._append`C${+t},${+r},${+n},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(t,r,n,i,a){if(t=+t,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,l=this._y1,c=n-t,d=i-r,u=o-t,h=l-r,f=u*u+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(f>tu)if(!(Math.abs(h*c-d*u)>tu)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-o,x=i-l,g=c*c+d*d,v=p*p+x*x,_=Math.sqrt(g),w=Math.sqrt(f),b=a*Math.tan((SS-Math.acos((g+f-v)/(2*_*w)))/2),N=b/w,S=b/_;Math.abs(N-1)>tu&&this._append`L${t+N*u},${r+N*h}`,this._append`A${a},${a},0,0,${+(h*p>u*x)},${this._x1=t+S*c},${this._y1=r+S*d}`}}arc(t,r,n,i,a,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(i),c=n*Math.sin(i),d=t+l,u=r+c,h=1^o,f=o?i-a:a-i;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>tu||Math.abs(this._y1-u)>tu)&&this._append`L${d},${u}`,n&&(f<0&&(f=f%kS+kS),f>E1e?this._append`A${n},${n},0,1,${h},${t-l},${r-c}A${n},${n},0,1,${h},${this._x1=d},${this._y1=u}`:f>tu&&this._append`A${n},${n},0,${+(f>=SS)},${h},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function W4(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new P1e(t)}function H4(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function $q(e){this._context=e}$q.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function z1(e){return new $q(e)}function Lq(e){return e[0]}function Fq(e){return e[1]}function Uq(e,t){var r=Pn(!0),n=null,i=z1,a=null,o=W4(l);e=typeof e=="function"?e:e===void 0?Lq:Pn(e),t=typeof t=="function"?t:t===void 0?Fq:Pn(t);function l(c){var d,u=(c=H4(c)).length,h,f=!1,p;for(n==null&&(a=i(p=o())),d=0;d<=u;++d)!(d<u&&r(h=c[d],d,c))===f&&((f=!f)?a.lineStart():a.lineEnd()),f&&a.point(+e(h,d,c),+t(h,d,c));if(p)return a=null,p+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:Pn(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:Pn(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Pn(!!c),l):r},l.curve=function(c){return arguments.length?(i=c,n!=null&&(a=i(n)),l):i},l.context=function(c){return arguments.length?(c==null?n=a=null:a=i(n=c),l):n},l}function ay(e,t,r){var n=null,i=Pn(!0),a=null,o=z1,l=null,c=W4(d);e=typeof e=="function"?e:e===void 0?Lq:Pn(+e),t=typeof t=="function"?t:Pn(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?Fq:Pn(+r);function d(h){var f,p,x,g=(h=H4(h)).length,v,_=!1,w,b=new Array(g),N=new Array(g);for(a==null&&(l=o(w=c())),f=0;f<=g;++f){if(!(f<g&&i(v=h[f],f,h))===_)if(_=!_)p=f,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),x=f-1;x>=p;--x)l.point(b[x],N[x]);l.lineEnd(),l.areaEnd()}_&&(b[f]=+e(v,f,h),N[f]=+t(v,f,h),l.point(n?+n(v,f,h):b[f],r?+r(v,f,h):N[f]))}if(w)return l=null,w+""||null}function u(){return Uq().defined(i).curve(o).context(a)}return d.x=function(h){return arguments.length?(e=typeof h=="function"?h:Pn(+h),n=null,d):e},d.x0=function(h){return arguments.length?(e=typeof h=="function"?h:Pn(+h),d):e},d.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:Pn(+h),d):n},d.y=function(h){return arguments.length?(t=typeof h=="function"?h:Pn(+h),r=null,d):t},d.y0=function(h){return arguments.length?(t=typeof h=="function"?h:Pn(+h),d):t},d.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:Pn(+h),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(n).y(t)},d.defined=function(h){return arguments.length?(i=typeof h=="function"?h:Pn(!!h),d):i},d.curve=function(h){return arguments.length?(o=h,a!=null&&(l=o(a)),d):o},d.context=function(h){return arguments.length?(h==null?a=l=null:l=o(a=h),d):a},d}class Bq{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function A1e(e){return new Bq(e,!0)}function T1e(e){return new Bq(e,!1)}const G4={draw(e,t){const r=Vo(t/t_);e.moveTo(r,0),e.arc(0,0,r,0,B1)}},O1e={draw(e,t){const r=Vo(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},zq=Vo(1/3),R1e=zq*2,M1e={draw(e,t){const r=Vo(t/R1e),n=r*zq;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},D1e={draw(e,t){const r=Vo(t),n=-r/2;e.rect(n,n,r,r)}},I1e=.8908130915292852,Vq=e_(t_/10)/e_(7*t_/10),$1e=e_(B1/10)*Vq,L1e=-Dq(B1/10)*Vq,F1e={draw(e,t){const r=Vo(t*I1e),n=$1e*r,i=L1e*r;e.moveTo(0,-r),e.lineTo(n,i);for(let a=1;a<5;++a){const o=B1*a/5,l=Dq(o),c=e_(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*i,c*n+l*i)}e.closePath()}},Gj=Vo(3),U1e={draw(e,t){const r=-Vo(t/(Gj*3));e.moveTo(0,r*2),e.lineTo(-Gj*r,-r),e.lineTo(Gj*r,-r),e.closePath()}},Ra=-.5,Ma=Vo(3)/2,ES=1/Vo(12),B1e=(ES/2+1)*3,z1e={draw(e,t){const r=Vo(t/B1e),n=r/2,i=r*ES,a=n,o=r*ES+r,l=-a,c=o;e.moveTo(n,i),e.lineTo(a,o),e.lineTo(l,c),e.lineTo(Ra*n-Ma*i,Ma*n+Ra*i),e.lineTo(Ra*a-Ma*o,Ma*a+Ra*o),e.lineTo(Ra*l-Ma*c,Ma*l+Ra*c),e.lineTo(Ra*n+Ma*i,Ra*i-Ma*n),e.lineTo(Ra*a+Ma*o,Ra*o-Ma*a),e.lineTo(Ra*l+Ma*c,Ra*c-Ma*l),e.closePath()}};function V1e(e,t){let r=null,n=W4(i);e=typeof e=="function"?e:Pn(e||G4),t=typeof t=="function"?t:Pn(t===void 0?64:+t);function i(){let a;if(r||(r=a=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),a)return r=null,a+""||null}return i.type=function(a){return arguments.length?(e=typeof a=="function"?a:Pn(a),i):e},i.size=function(a){return arguments.length?(t=typeof a=="function"?a:Pn(+a),i):t},i.context=function(a){return arguments.length?(r=a==null?null:a,i):r},i}function r_(){}function n_(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function qq(e){this._context=e}qq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:n_(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:n_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function q1e(e){return new qq(e)}function Wq(e){this._context=e}Wq.prototype={areaStart:r_,areaEnd:r_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:n_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function W1e(e){return new Wq(e)}function Hq(e){this._context=e}Hq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:n_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function H1e(e){return new Hq(e)}function Gq(e){this._context=e}Gq.prototype={areaStart:r_,areaEnd:r_,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function G1e(e){return new Gq(e)}function g9(e){return e<0?-1:1}function v9(e,t,r){var n=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(n||i<0&&-0),o=(r-e._y1)/(i||n<0&&-0),l=(a*i+o*n)/(n+i);return(g9(a)+g9(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(l))||0}function x9(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Yj(e,t,r){var n=e._x0,i=e._y0,a=e._x1,o=e._y1,l=(a-n)/3;e._context.bezierCurveTo(n+l,i+l*t,a-l,o-l*r,a,o)}function s_(e){this._context=e}s_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Yj(this,this._t0,x9(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Yj(this,x9(this,r=v9(this,e,t)),r);break;default:Yj(this,this._t0,r=v9(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Yq(e){this._context=new Kq(e)}(Yq.prototype=Object.create(s_.prototype)).point=function(e,t){s_.prototype.point.call(this,t,e)};function Kq(e){this._context=e}Kq.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,a){this._context.bezierCurveTo(t,e,n,r,a,i)}};function Y1e(e){return new s_(e)}function K1e(e){return new Yq(e)}function Zq(e){this._context=e}Zq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=y9(e),i=y9(t),a=0,o=1;o<r;++a,++o)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function y9(e){var t,r=e.length-1,n,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function Z1e(e){return new Zq(e)}function V1(e,t){this._context=e,this._t=t}V1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function X1e(e){return new V1(e,.5)}function J1e(e){return new V1(e,0)}function Q1e(e){return new V1(e,1)}function hm(e,t){if((o=e.length)>1)for(var r=1,n,i,a=e[t[0]],o,l=a.length;r<o;++r)for(i=a,a=e[t[r]],n=0;n<l;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function CS(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function ebe(e,t){return e[t]}function tbe(e){const t=[];return t.key=e,t}function rbe(){var e=Pn([]),t=CS,r=hm,n=ebe;function i(a){var o=Array.from(e.apply(this,arguments),tbe),l,c=o.length,d=-1,u;for(const h of a)for(l=0,++d;l<c;++l)(o[l][d]=[0,+n(h,o[l].key,d,a)]).data=h;for(l=0,u=H4(t(o));l<c;++l)o[u[l]].index=l;return r(o,u),o}return i.keys=function(a){return arguments.length?(e=typeof a=="function"?a:Pn(Array.from(a)),i):e},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:Pn(+a),i):n},i.order=function(a){return arguments.length?(t=a==null?CS:typeof a=="function"?a:Pn(Array.from(a)),i):t},i.offset=function(a){return arguments.length?(r=a==null?hm:a,i):r},i}function nbe(e,t){if((n=e.length)>0){for(var r,n,i=0,a=e[0].length,o;i<a;++i){for(o=r=0;r<n;++r)o+=e[r][i][1]||0;if(o)for(r=0;r<n;++r)e[r][i][1]/=o}hm(e,t)}}function sbe(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,a=n.length;r<a;++r){for(var o=0,l=0;o<i;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}hm(e,t)}}function ibe(e,t){if(!(!((o=e.length)>0)||!((a=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,a,o;n<a;++n){for(var l=0,c=0,d=0;l<o;++l){for(var u=e[t[l]],h=u[n][1]||0,f=u[n-1][1]||0,p=(h-f)/2,x=0;x<l;++x){var g=e[t[x]],v=g[n][1]||0,_=g[n-1][1]||0;p+=v-_}c+=h,d+=p*h}i[n-1][1]+=i[n-1][0]=r,c&&(r-=d/c)}i[n-1][1]+=i[n-1][0]=r,hm(e,t)}}function Ag(e){"@babel/helpers - typeof";return Ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ag(e)}var abe=["type","size","sizeType"];function PS(){return PS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},PS.apply(this,arguments)}function _9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function w9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_9(Object(r),!0).forEach(function(n){obe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function obe(e,t,r){return t=lbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lbe(e){var t=cbe(e,"string");return Ag(t)=="symbol"?t:t+""}function cbe(e,t){if(Ag(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ag(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dbe(e,t){if(e==null)return{};var r=ube(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ube(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Xq={symbolCircle:G4,symbolCross:O1e,symbolDiamond:M1e,symbolSquare:D1e,symbolStar:F1e,symbolTriangle:U1e,symbolWye:z1e},fbe=Math.PI/180,hbe=function(t){var r="symbol".concat(U1(t));return Xq[r]||G4},mbe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var i=18*fbe;return 1.25*t*t*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},pbe=function(t,r){Xq["symbol".concat(U1(t))]=r},Y4=function(t){var r=t.type,n=r===void 0?"circle":r,i=t.size,a=i===void 0?64:i,o=t.sizeType,l=o===void 0?"area":o,c=dbe(t,abe),d=w9(w9({},c),{},{type:n,size:a,sizeType:l}),u=function(){var v=hbe(n),_=V1e().type(v).size(mbe(a,l,n));return _()},h=d.className,f=d.cx,p=d.cy,x=Pr(d,!0);return f===+f&&p===+p&&a===+a?Q.createElement("path",PS({},x,{className:Lr("recharts-symbols",h),transform:"translate(".concat(f,", ").concat(p,")"),d:u()})):null};Y4.registerSymbol=pbe;function mm(e){"@babel/helpers - typeof";return mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mm(e)}function AS(){return AS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},AS.apply(this,arguments)}function b9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function gbe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b9(Object(r),!0).forEach(function(n){Tg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xbe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qq(n.key),n)}}function ybe(e,t,r){return t&&xbe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _be(e,t,r){return t=i_(t),wbe(e,Jq()?Reflect.construct(t,r||[],i_(e).constructor):t.apply(e,r))}function wbe(e,t){if(t&&(mm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bbe(e)}function bbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Jq=function(){return!!e})()}function i_(e){return i_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},i_(e)}function jbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TS(e,t)}function TS(e,t){return TS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TS(e,t)}function Tg(e,t,r){return t=Qq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qq(e){var t=Nbe(e,"string");return mm(t)=="symbol"?t:t+""}function Nbe(e,t){if(mm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Da=32,K4=function(e){function t(){return vbe(this,t),_be(this,t,arguments)}return jbe(t,e),ybe(t,[{key:"renderIcon",value:function(n){var i=this.props.inactiveColor,a=Da/2,o=Da/6,l=Da/3,c=n.inactive?i:n.color;if(n.type==="plainline")return Q.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:a,x2:Da,y2:a,className:"recharts-legend-icon"});if(n.type==="line")return Q.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(a,"h").concat(l,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*l,",").concat(a,`
            H`).concat(Da,"M").concat(2*l,",").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(l,",").concat(a),className:"recharts-legend-icon"});if(n.type==="rect")return Q.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Da/8,"h").concat(Da,"v").concat(Da*3/4,"h").concat(-Da,"z"),className:"recharts-legend-icon"});if(Q.isValidElement(n.legendIcon)){var d=gbe({},n);return delete d.legendIcon,Q.cloneElement(n.legendIcon,d)}return Q.createElement(Y4,{fill:c,cx:a,cy:a,size:Da,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,i=this.props,a=i.payload,o=i.iconSize,l=i.layout,c=i.formatter,d=i.inactiveColor,u={x:0,y:0,width:Da,height:Da},h={display:l==="horizontal"?"inline-block":"block",marginRight:10},f={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(p,x){var g=p.formatter||c,v=Lr(Tg(Tg({"recharts-legend-item":!0},"legend-item-".concat(x),!0),"inactive",p.inactive));if(p.type==="none")return null;var _=kr(p.value)?null:p.value;dc(!kr(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var w=p.inactive?d:p.color;return Q.createElement("li",AS({className:v,style:h,key:"legend-item-".concat(x)},Q2(n.props,p,x)),Q.createElement(wS,{width:o,height:o,viewBox:u,style:f},n.renderIcon(p)),Q.createElement("span",{className:"recharts-legend-item-text",style:{color:w}},g?g(_,p,x):_))})}},{key:"render",value:function(){var n=this.props,i=n.payload,a=n.layout,o=n.align;if(!i||!i.length)return null;var l={padding:0,margin:0,textAlign:a==="horizontal"?o:"left"};return Q.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(y.PureComponent);Tg(K4,"displayName","Legend");Tg(K4,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Sbe=E1;function kbe(){this.__data__=new Sbe,this.size=0}var Ebe=kbe;function Cbe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var Pbe=Cbe;function Abe(e){return this.__data__.get(e)}var Tbe=Abe;function Obe(e){return this.__data__.has(e)}var Rbe=Obe,Mbe=E1,Dbe=I4,Ibe=$4,$be=200;function Lbe(e,t){var r=this.__data__;if(r instanceof Mbe){var n=r.__data__;if(!Dbe||n.length<$be-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ibe(n)}return r.set(e,t),this.size=r.size,this}var Fbe=Lbe,Ube=E1,Bbe=Ebe,zbe=Pbe,Vbe=Tbe,qbe=Rbe,Wbe=Fbe;function hp(e){var t=this.__data__=new Ube(e);this.size=t.size}hp.prototype.clear=Bbe;hp.prototype.delete=zbe;hp.prototype.get=Vbe;hp.prototype.has=qbe;hp.prototype.set=Wbe;var eW=hp,Hbe="__lodash_hash_undefined__";function Gbe(e){return this.__data__.set(e,Hbe),this}var Ybe=Gbe;function Kbe(e){return this.__data__.has(e)}var Zbe=Kbe,Xbe=$4,Jbe=Ybe,Qbe=Zbe;function a_(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Xbe;++t<r;)this.add(e[t])}a_.prototype.add=a_.prototype.push=Jbe;a_.prototype.has=Qbe;var tW=a_;function eje(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var rW=eje;function tje(e,t){return e.has(t)}var nW=tje,rje=tW,nje=rW,sje=nW,ije=1,aje=2;function oje(e,t,r,n,i,a){var o=r&ije,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var d=a.get(e),u=a.get(t);if(d&&u)return d==t&&u==e;var h=-1,f=!0,p=r&aje?new rje:void 0;for(a.set(e,t),a.set(t,e);++h<l;){var x=e[h],g=t[h];if(n)var v=o?n(g,x,h,t,e,a):n(x,g,h,e,t,a);if(v!==void 0){if(v)continue;f=!1;break}if(p){if(!nje(t,function(_,w){if(!sje(p,w)&&(x===_||i(x,_,r,n,a)))return p.push(w)})){f=!1;break}}else if(!(x===g||i(x,g,r,n,a))){f=!1;break}}return a.delete(e),a.delete(t),f}var sW=oje,lje=Al,cje=lje.Uint8Array,dje=cje;function uje(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}var fje=uje;function hje(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var Z4=hje,j9=Gv,N9=dje,mje=D4,pje=sW,gje=fje,vje=Z4,xje=1,yje=2,_je="[object Boolean]",wje="[object Date]",bje="[object Error]",jje="[object Map]",Nje="[object Number]",Sje="[object RegExp]",kje="[object Set]",Eje="[object String]",Cje="[object Symbol]",Pje="[object ArrayBuffer]",Aje="[object DataView]",S9=j9?j9.prototype:void 0,Kj=S9?S9.valueOf:void 0;function Tje(e,t,r,n,i,a,o){switch(r){case Aje:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Pje:return!(e.byteLength!=t.byteLength||!a(new N9(e),new N9(t)));case _je:case wje:case Nje:return mje(+e,+t);case bje:return e.name==t.name&&e.message==t.message;case Sje:case Eje:return e==t+"";case jje:var l=gje;case kje:var c=n&xje;if(l||(l=vje),e.size!=t.size&&!c)return!1;var d=o.get(e);if(d)return d==t;n|=yje,o.set(e,t);var u=pje(l(e),l(t),n,i,a,o);return o.delete(e),u;case Cje:if(Kj)return Kj.call(e)==Kj.call(t)}return!1}var Oje=Tje;function Rje(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var iW=Rje,Mje=iW,Dje=ha;function Ije(e,t,r){var n=t(e);return Dje(e)?n:Mje(n,r(e))}var $je=Ije;function Lje(e,t){for(var r=-1,n=e==null?0:e.length,i=0,a=[];++r<n;){var o=e[r];t(o,r,e)&&(a[i++]=o)}return a}var Fje=Lje;function Uje(){return[]}var Bje=Uje,zje=Fje,Vje=Bje,qje=Object.prototype,Wje=qje.propertyIsEnumerable,k9=Object.getOwnPropertySymbols,Hje=k9?function(e){return e==null?[]:(e=Object(e),zje(k9(e),function(t){return Wje.call(e,t)}))}:Vje,Gje=Hje;function Yje(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var Kje=Yje,Zje=Ac,Xje=Tc,Jje="[object Arguments]";function Qje(e){return Xje(e)&&Zje(e)==Jje}var eNe=Qje,E9=eNe,tNe=Tc,aW=Object.prototype,rNe=aW.hasOwnProperty,nNe=aW.propertyIsEnumerable,sNe=E9(function(){return arguments}())?E9:function(e){return tNe(e)&&rNe.call(e,"callee")&&!nNe.call(e,"callee")},X4=sNe,o_={exports:{}};function iNe(){return!1}var aNe=iNe;o_.exports;(function(e,t){var r=Al,n=aNe,i=t&&!t.nodeType&&t,a=i&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===i,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d})(o_,o_.exports);var oW=o_.exports,oNe=9007199254740991,lNe=/^(?:0|[1-9]\d*)$/;function cNe(e,t){var r=typeof e;return t=t==null?oNe:t,!!t&&(r=="number"||r!="symbol"&&lNe.test(e))&&e>-1&&e%1==0&&e<t}var J4=cNe,dNe=9007199254740991;function uNe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=dNe}var Q4=uNe,fNe=Ac,hNe=Q4,mNe=Tc,pNe="[object Arguments]",gNe="[object Array]",vNe="[object Boolean]",xNe="[object Date]",yNe="[object Error]",_Ne="[object Function]",wNe="[object Map]",bNe="[object Number]",jNe="[object Object]",NNe="[object RegExp]",SNe="[object Set]",kNe="[object String]",ENe="[object WeakMap]",CNe="[object ArrayBuffer]",PNe="[object DataView]",ANe="[object Float32Array]",TNe="[object Float64Array]",ONe="[object Int8Array]",RNe="[object Int16Array]",MNe="[object Int32Array]",DNe="[object Uint8Array]",INe="[object Uint8ClampedArray]",$Ne="[object Uint16Array]",LNe="[object Uint32Array]",Ln={};Ln[ANe]=Ln[TNe]=Ln[ONe]=Ln[RNe]=Ln[MNe]=Ln[DNe]=Ln[INe]=Ln[$Ne]=Ln[LNe]=!0;Ln[pNe]=Ln[gNe]=Ln[CNe]=Ln[vNe]=Ln[PNe]=Ln[xNe]=Ln[yNe]=Ln[_Ne]=Ln[wNe]=Ln[bNe]=Ln[jNe]=Ln[NNe]=Ln[SNe]=Ln[kNe]=Ln[ENe]=!1;function FNe(e){return mNe(e)&&hNe(e.length)&&!!Ln[fNe(e)]}var UNe=FNe;function BNe(e){return function(t){return e(t)}}var lW=BNe,l_={exports:{}};l_.exports;(function(e,t){var r=pq,n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===n,o=a&&r.process,l=function(){try{var c=i&&i.require&&i.require("util").types;return c||o&&o.binding&&o.binding("util")}catch(d){}}();e.exports=l})(l_,l_.exports);var zNe=l_.exports,VNe=UNe,qNe=lW,C9=zNe,P9=C9&&C9.isTypedArray,WNe=P9?qNe(P9):VNe,cW=WNe,HNe=Kje,GNe=X4,YNe=ha,KNe=oW,ZNe=J4,XNe=cW,JNe=Object.prototype,QNe=JNe.hasOwnProperty;function e3e(e,t){var r=YNe(e),n=!r&&GNe(e),i=!r&&!n&&KNe(e),a=!r&&!n&&!i&&XNe(e),o=r||n||i||a,l=o?HNe(e.length,String):[],c=l.length;for(var d in e)(t||QNe.call(e,d))&&!(o&&(d=="length"||i&&(d=="offset"||d=="parent")||a&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||ZNe(d,c)))&&l.push(d);return l}var t3e=e3e,r3e=Object.prototype;function n3e(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||r3e;return e===r}var s3e=n3e;function i3e(e,t){return function(r){return e(t(r))}}var dW=i3e,a3e=dW,o3e=a3e(Object.keys,Object),l3e=o3e,c3e=s3e,d3e=l3e,u3e=Object.prototype,f3e=u3e.hasOwnProperty;function h3e(e){if(!c3e(e))return d3e(e);var t=[];for(var r in Object(e))f3e.call(e,r)&&r!="constructor"&&t.push(r);return t}var m3e=h3e,p3e=M4,g3e=Q4;function v3e(e){return e!=null&&g3e(e.length)&&!p3e(e)}var Yv=v3e,x3e=t3e,y3e=m3e,_3e=Yv;function w3e(e){return _3e(e)?x3e(e):y3e(e)}var q1=w3e,b3e=$je,j3e=Gje,N3e=q1;function S3e(e){return b3e(e,N3e,j3e)}var k3e=S3e,A9=k3e,E3e=1,C3e=Object.prototype,P3e=C3e.hasOwnProperty;function A3e(e,t,r,n,i,a){var o=r&E3e,l=A9(e),c=l.length,d=A9(t),u=d.length;if(c!=u&&!o)return!1;for(var h=c;h--;){var f=l[h];if(!(o?f in t:P3e.call(t,f)))return!1}var p=a.get(e),x=a.get(t);if(p&&x)return p==t&&x==e;var g=!0;a.set(e,t),a.set(t,e);for(var v=o;++h<c;){f=l[h];var _=e[f],w=t[f];if(n)var b=o?n(w,_,f,t,e,a):n(_,w,f,e,t,a);if(!(b===void 0?_===w||i(_,w,r,n,a):b)){g=!1;break}v||(v=f=="constructor")}if(g&&!v){var N=e.constructor,S=t.constructor;N!=S&&"constructor"in e&&"constructor"in t&&!(typeof N=="function"&&N instanceof N&&typeof S=="function"&&S instanceof S)&&(g=!1)}return a.delete(e),a.delete(t),g}var T3e=A3e,O3e=vf,R3e=Al,M3e=O3e(R3e,"DataView"),D3e=M3e,I3e=vf,$3e=Al,L3e=I3e($3e,"Promise"),F3e=L3e,U3e=vf,B3e=Al,z3e=U3e(B3e,"Set"),uW=z3e,V3e=vf,q3e=Al,W3e=V3e(q3e,"WeakMap"),H3e=W3e,OS=D3e,RS=I4,MS=F3e,DS=uW,IS=H3e,fW=Ac,mp=vq,T9="[object Map]",G3e="[object Object]",O9="[object Promise]",R9="[object Set]",M9="[object WeakMap]",D9="[object DataView]",Y3e=mp(OS),K3e=mp(RS),Z3e=mp(MS),X3e=mp(DS),J3e=mp(IS),ru=fW;(OS&&ru(new OS(new ArrayBuffer(1)))!=D9||RS&&ru(new RS)!=T9||MS&&ru(MS.resolve())!=O9||DS&&ru(new DS)!=R9||IS&&ru(new IS)!=M9)&&(ru=function(e){var t=fW(e),r=t==G3e?e.constructor:void 0,n=r?mp(r):"";if(n)switch(n){case Y3e:return D9;case K3e:return T9;case Z3e:return O9;case X3e:return R9;case J3e:return M9}return t});var Q3e=ru,Zj=eW,eSe=sW,tSe=Oje,rSe=T3e,I9=Q3e,$9=ha,L9=oW,nSe=cW,sSe=1,F9="[object Arguments]",U9="[object Array]",oy="[object Object]",iSe=Object.prototype,B9=iSe.hasOwnProperty;function aSe(e,t,r,n,i,a){var o=$9(e),l=$9(t),c=o?U9:I9(e),d=l?U9:I9(t);c=c==F9?oy:c,d=d==F9?oy:d;var u=c==oy,h=d==oy,f=c==d;if(f&&L9(e)){if(!L9(t))return!1;o=!0,u=!1}if(f&&!u)return a||(a=new Zj),o||nSe(e)?eSe(e,t,r,n,i,a):tSe(e,t,c,r,n,i,a);if(!(r&sSe)){var p=u&&B9.call(e,"__wrapped__"),x=h&&B9.call(t,"__wrapped__");if(p||x){var g=p?e.value():e,v=x?t.value():t;return a||(a=new Zj),i(g,v,r,n,a)}}return f?(a||(a=new Zj),rSe(e,t,r,n,i,a)):!1}var oSe=aSe,lSe=oSe,z9=Tc;function hW(e,t,r,n,i){return e===t?!0:e==null||t==null||!z9(e)&&!z9(t)?e!==e&&t!==t:lSe(e,t,r,n,hW,i)}var eC=hW,cSe=eW,dSe=eC,uSe=1,fSe=2;function hSe(e,t,r,n){var i=r.length,a=i,o=!n;if(e==null)return!a;for(e=Object(e);i--;){var l=r[i];if(o&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++i<a;){l=r[i];var c=l[0],d=e[c],u=l[1];if(o&&l[2]){if(d===void 0&&!(c in e))return!1}else{var h=new cSe;if(n)var f=n(d,u,c,e,t,h);if(!(f===void 0?dSe(u,d,uSe|fSe,n,h):f))return!1}}return!0}var mSe=hSe,pSe=Fd;function gSe(e){return e===e&&!pSe(e)}var mW=gSe,vSe=mW,xSe=q1;function ySe(e){for(var t=xSe(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,vSe(i)]}return t}var _Se=ySe;function wSe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var pW=wSe,bSe=mSe,jSe=_Se,NSe=pW;function SSe(e){var t=jSe(e);return t.length==1&&t[0][2]?NSe(t[0][0],t[0][1]):function(r){return r===e||bSe(r,e,t)}}var kSe=SSe;function ESe(e,t){return e!=null&&t in Object(e)}var CSe=ESe,PSe=bq,ASe=X4,TSe=ha,OSe=J4,RSe=Q4,MSe=P1;function DSe(e,t,r){t=PSe(t,e);for(var n=-1,i=t.length,a=!1;++n<i;){var o=MSe(t[n]);if(!(a=e!=null&&r(e,o)))break;e=e[o]}return a||++n!=i?a:(i=e==null?0:e.length,!!i&&RSe(i)&&OSe(o,i)&&(TSe(e)||ASe(e)))}var ISe=DSe,$Se=CSe,LSe=ISe;function FSe(e,t){return e!=null&&LSe(e,t,$Se)}var USe=FSe,BSe=eC,zSe=jq,VSe=USe,qSe=R4,WSe=mW,HSe=pW,GSe=P1,YSe=1,KSe=2;function ZSe(e,t){return qSe(e)&&WSe(t)?HSe(GSe(e),t):function(r){var n=zSe(r,e);return n===void 0&&n===t?VSe(r,e):BSe(t,n,YSe|KSe)}}var XSe=ZSe;function JSe(e){return e}var pp=JSe;function QSe(e){return function(t){return t==null?void 0:t[e]}}var e5e=QSe,t5e=U4;function r5e(e){return function(t){return t5e(t,e)}}var n5e=r5e,s5e=e5e,i5e=n5e,a5e=R4,o5e=P1;function l5e(e){return a5e(e)?s5e(o5e(e)):i5e(e)}var c5e=l5e,d5e=kSe,u5e=XSe,f5e=pp,h5e=ha,m5e=c5e;function p5e(e){return typeof e=="function"?e:e==null?f5e:typeof e=="object"?h5e(e)?u5e(e[0],e[1]):d5e(e):m5e(e)}var Ud=p5e;function g5e(e,t,r,n){for(var i=e.length,a=r+(n?1:-1);n?a--:++a<i;)if(t(e[a],a,e))return a;return-1}var gW=g5e;function v5e(e){return e!==e}var x5e=v5e;function y5e(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}var _5e=y5e,w5e=gW,b5e=x5e,j5e=_5e;function N5e(e,t,r){return t===t?j5e(e,t,r):w5e(e,b5e,r)}var S5e=N5e,k5e=S5e;function E5e(e,t){var r=e==null?0:e.length;return!!r&&k5e(e,t,0)>-1}var C5e=E5e;function P5e(e,t,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}var A5e=P5e;function T5e(){}var O5e=T5e,Xj=uW,R5e=O5e,M5e=Z4,D5e=1/0,I5e=Xj&&1/M5e(new Xj([,-0]))[1]==D5e?function(e){return new Xj(e)}:R5e,$5e=I5e,L5e=tW,F5e=C5e,U5e=A5e,B5e=nW,z5e=$5e,V5e=Z4,q5e=200;function W5e(e,t,r){var n=-1,i=F5e,a=e.length,o=!0,l=[],c=l;if(r)o=!1,i=U5e;else if(a>=q5e){var d=t?null:z5e(e);if(d)return V5e(d);o=!1,i=B5e,c=new L5e}else c=t?[]:l;e:for(;++n<a;){var u=e[n],h=t?t(u):u;if(u=r||u!==0?u:0,o&&h===h){for(var f=c.length;f--;)if(c[f]===h)continue e;t&&c.push(h),l.push(u)}else i(c,h,r)||(c!==l&&c.push(h),l.push(u))}return l}var H5e=W5e,G5e=Ud,Y5e=H5e;function K5e(e,t){return e&&e.length?Y5e(e,G5e(t)):[]}var Z5e=K5e;const V9=rn(Z5e);function vW(e,t,r){return t===!0?V9(e,r):kr(t)?V9(e,t):e}function pm(e){"@babel/helpers - typeof";return pm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pm(e)}var X5e=["ref"];function q9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Bl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q9(Object(r),!0).forEach(function(n){W1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yW(n.key),n)}}function Q5e(e,t,r){return t&&W9(e.prototype,t),r&&W9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eke(e,t,r){return t=c_(t),tke(e,xW()?Reflect.construct(t,r||[],c_(e).constructor):t.apply(e,r))}function tke(e,t){if(t&&(pm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rke(e)}function rke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(xW=function(){return!!e})()}function c_(e){return c_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},c_(e)}function nke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$S(e,t)}function $S(e,t){return $S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$S(e,t)}function W1(e,t,r){return t=yW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yW(e){var t=ske(e,"string");return pm(t)=="symbol"?t:t+""}function ske(e,t){if(pm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ike(e,t){if(e==null)return{};var r=ake(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ake(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function oke(e){return e.value}function lke(e,t){if(Q.isValidElement(e))return Q.cloneElement(e,t);if(typeof e=="function")return Q.createElement(e,t);t.ref;var r=ike(t,X5e);return Q.createElement(K4,r)}var H9=1,Ou=function(e){function t(){var r;J5e(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=eke(this,t,[].concat(i)),W1(r,"lastBoundingBox",{width:-1,height:-1}),r}return nke(t,e),Q5e(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>H9||Math.abs(i.height-this.lastBoundingBox.height)>H9)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,n&&n(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Bl({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var i=this.props,a=i.layout,o=i.align,l=i.verticalAlign,c=i.margin,d=i.chartWidth,u=i.chartHeight,h,f;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&a==="vertical"){var p=this.getBBoxSnapshot();h={left:((d||0)-p.width)/2}}else h=o==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var x=this.getBBoxSnapshot();f={top:((u||0)-x.height)/2}}else f=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return Bl(Bl({},h),f)}},{key:"render",value:function(){var n=this,i=this.props,a=i.content,o=i.width,l=i.height,c=i.wrapperStyle,d=i.payloadUniqBy,u=i.payload,h=Bl(Bl({position:"absolute",width:o||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return Q.createElement("div",{className:"recharts-legend-wrapper",style:h,ref:function(p){n.wrapperNode=p}},lke(a,Bl(Bl({},this.props),{},{payload:vW(u,d,oke)})))}}],[{key:"getWithHeight",value:function(n,i){var a=Bl(Bl({},this.defaultProps),n.props),o=a.layout;return o==="vertical"&&_t(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||i}:null}}])}(y.PureComponent);W1(Ou,"displayName","Legend");W1(Ou,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var G9=Gv,cke=X4,dke=ha,Y9=G9?G9.isConcatSpreadable:void 0;function uke(e){return dke(e)||cke(e)||!!(Y9&&e&&e[Y9])}var fke=uke,hke=iW,mke=fke;function _W(e,t,r,n,i){var a=-1,o=e.length;for(r||(r=mke),i||(i=[]);++a<o;){var l=e[a];t>0&&r(l)?t>1?_W(l,t-1,r,n,i):hke(i,l):n||(i[i.length]=l)}return i}var wW=_W;function pke(e){return function(t,r,n){for(var i=-1,a=Object(t),o=n(t),l=o.length;l--;){var c=o[e?l:++i];if(r(a[c],c,a)===!1)break}return t}}var gke=pke,vke=gke,xke=vke(),yke=xke,_ke=yke,wke=q1;function bke(e,t){return e&&_ke(e,t,wke)}var bW=bke,jke=Yv;function Nke(e,t){return function(r,n){if(r==null)return r;if(!jke(r))return e(r,n);for(var i=r.length,a=t?i:-1,o=Object(r);(t?a--:++a<i)&&n(o[a],a,o)!==!1;);return r}}var Ske=Nke,kke=bW,Eke=Ske,Cke=Eke(kke),tC=Cke,Pke=tC,Ake=Yv;function Tke(e,t){var r=-1,n=Ake(e)?Array(e.length):[];return Pke(e,function(i,a,o){n[++r]=t(i,a,o)}),n}var jW=Tke;function Oke(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var Rke=Oke,K9=ap;function Mke(e,t){if(e!==t){var r=e!==void 0,n=e===null,i=e===e,a=K9(e),o=t!==void 0,l=t===null,c=t===t,d=K9(t);if(!l&&!d&&!a&&e>t||a&&o&&c&&!l&&!d||n&&o&&c||!r&&c||!i)return 1;if(!n&&!a&&!d&&e<t||d&&r&&i&&!n&&!a||l&&r&&i||!o&&i||!c)return-1}return 0}var Dke=Mke,Ike=Dke;function $ke(e,t,r){for(var n=-1,i=e.criteria,a=t.criteria,o=i.length,l=r.length;++n<o;){var c=Ike(i[n],a[n]);if(c){if(n>=l)return c;var d=r[n];return c*(d=="desc"?-1:1)}}return e.index-t.index}var Lke=$ke,Jj=F4,Fke=U4,Uke=Ud,Bke=jW,zke=Rke,Vke=lW,qke=Lke,Wke=pp,Hke=ha;function Gke(e,t,r){t.length?t=Jj(t,function(a){return Hke(a)?function(o){return Fke(o,a.length===1?a[0]:a)}:a}):t=[Wke];var n=-1;t=Jj(t,Vke(Uke));var i=Bke(e,function(a,o,l){var c=Jj(t,function(d){return d(a)});return{criteria:c,index:++n,value:a}});return zke(i,function(a,o){return qke(a,o,r)})}var Yke=Gke;function Kke(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var Zke=Kke,Xke=Zke,Z9=Math.max;function Jke(e,t,r){return t=Z9(t===void 0?e.length-1:t,0),function(){for(var n=arguments,i=-1,a=Z9(n.length-t,0),o=Array(a);++i<a;)o[i]=n[t+i];i=-1;for(var l=Array(t+1);++i<t;)l[i]=n[i];return l[t]=r(o),Xke(e,this,l)}}var Qke=Jke;function eEe(e){return function(){return e}}var tEe=eEe,rEe=vf,nEe=function(){try{var e=rEe(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),NW=nEe,sEe=tEe,X9=NW,iEe=pp,aEe=X9?function(e,t){return X9(e,"toString",{configurable:!0,enumerable:!1,value:sEe(t),writable:!0})}:iEe,oEe=aEe,lEe=800,cEe=16,dEe=Date.now;function uEe(e){var t=0,r=0;return function(){var n=dEe(),i=cEe-(n-r);if(r=n,i>0){if(++t>=lEe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var fEe=uEe,hEe=oEe,mEe=fEe,pEe=mEe(hEe),gEe=pEe,vEe=pp,xEe=Qke,yEe=gEe;function _Ee(e,t){return yEe(xEe(e,t,vEe),e+"")}var wEe=_Ee,bEe=D4,jEe=Yv,NEe=J4,SEe=Fd;function kEe(e,t,r){if(!SEe(r))return!1;var n=typeof t;return(n=="number"?jEe(r)&&NEe(t,r.length):n=="string"&&t in r)?bEe(r[t],e):!1}var H1=kEe,EEe=wW,CEe=Yke,PEe=wEe,J9=H1,AEe=PEe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&J9(e,t[0],t[1])?t=[]:r>2&&J9(t[0],t[1],t[2])&&(t=[t[0]]),CEe(e,EEe(t,1),[])}),TEe=AEe;const rC=rn(TEe);function Og(e){"@babel/helpers - typeof";return Og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Og(e)}function LS(){return LS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},LS.apply(this,arguments)}function OEe(e,t){return IEe(e)||DEe(e,t)||MEe(e,t)||REe()}function REe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MEe(e,t){if(e){if(typeof e=="string")return Q9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Q9(e,t)}}function Q9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DEe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,d=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,i=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw i}}return l}}function IEe(e){if(Array.isArray(e))return e}function e8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Qj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e8(Object(r),!0).forEach(function(n){$Ee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $Ee(e,t,r){return t=LEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LEe(e){var t=FEe(e,"string");return Og(t)=="symbol"?t:t+""}function FEe(e,t){if(Og(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Og(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UEe(e){return Array.isArray(e)&&Ms(e[0])&&Ms(e[1])?e.join(" ~ "):e}var BEe=function(t){var r=t.separator,n=r===void 0?" : ":r,i=t.contentStyle,a=i===void 0?{}:i,o=t.itemStyle,l=o===void 0?{}:o,c=t.labelStyle,d=c===void 0?{}:c,u=t.payload,h=t.formatter,f=t.itemSorter,p=t.wrapperClassName,x=t.labelClassName,g=t.label,v=t.labelFormatter,_=t.accessibilityLayer,w=_===void 0?!1:_,b=function(){if(u&&u.length){var F={padding:0,margin:0},D=(f?rC(u,f):u).map(function(B,U){if(B.type==="none")return null;var V=Qj({display:"block",paddingTop:4,paddingBottom:4,color:B.color||"#000"},l),Y=B.formatter||h||UEe,z=B.value,K=B.name,Z=z,G=K;if(Y&&Z!=null&&G!=null){var X=Y(z,K,B,U,u);if(Array.isArray(X)){var te=OEe(X,2);Z=te[0],G=te[1]}else Z=X}return Q.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(U),style:V},Ms(G)?Q.createElement("span",{className:"recharts-tooltip-item-name"},G):null,Ms(G)?Q.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Q.createElement("span",{className:"recharts-tooltip-item-value"},Z),Q.createElement("span",{className:"recharts-tooltip-item-unit"},B.unit||""))});return Q.createElement("ul",{className:"recharts-tooltip-item-list",style:F},D)}return null},N=Qj({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),S=Qj({margin:0},d),k=!Or(g),O=k?g:"",A=Lr("recharts-default-tooltip",p),T=Lr("recharts-tooltip-label",x);k&&v&&u!==void 0&&u!==null&&(O=v(g,u));var $=w?{role:"status","aria-live":"assertive"}:{};return Q.createElement("div",LS({className:A,style:N},$),Q.createElement("p",{className:T,style:S},Q.isValidElement(O)?O:"".concat(O)),b())};function Rg(e){"@babel/helpers - typeof";return Rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rg(e)}function ly(e,t,r){return t=zEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zEe(e){var t=VEe(e,"string");return Rg(t)=="symbol"?t:t+""}function VEe(e,t){if(Rg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n0="recharts-tooltip-wrapper",qEe={visibility:"hidden"};function WEe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return Lr(n0,ly(ly(ly(ly({},"".concat(n0,"-right"),_t(r)&&t&&_t(t.x)&&r>=t.x),"".concat(n0,"-left"),_t(r)&&t&&_t(t.x)&&r<t.x),"".concat(n0,"-bottom"),_t(n)&&t&&_t(t.y)&&n>=t.y),"".concat(n0,"-top"),_t(n)&&t&&_t(t.y)&&n<t.y))}function t8(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,i=e.offsetTopLeft,a=e.position,o=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,d=e.viewBoxDimension;if(a&&_t(a[n]))return a[n];var u=r[n]-l-i,h=r[n]+i;if(t[n])return o[n]?u:h;if(o[n]){var f=u,p=c[n];return f<p?Math.max(h,c[n]):Math.max(u,c[n])}var x=h+l,g=c[n]+d;return x>g?Math.max(u,c[n]):Math.max(h,c[n])}function HEe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function GEe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,i=e.position,a=e.reverseDirection,o=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,d,u,h;return o.height>0&&o.width>0&&r?(u=t8({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),h=t8({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),d=HEe({translateX:u,translateY:h,useTranslate3d:l})):d=qEe,{cssProperties:d,cssClasses:WEe({translateX:u,translateY:h,coordinate:r})}}function gm(e){"@babel/helpers - typeof";return gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gm(e)}function r8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function n8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r8(Object(r),!0).forEach(function(n){US(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KEe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kW(n.key),n)}}function ZEe(e,t,r){return t&&KEe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function XEe(e,t,r){return t=d_(t),JEe(e,SW()?Reflect.construct(t,r||[],d_(e).constructor):t.apply(e,r))}function JEe(e,t){if(t&&(gm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QEe(e)}function QEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(SW=function(){return!!e})()}function d_(e){return d_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},d_(e)}function e4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FS(e,t)}function FS(e,t){return FS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},FS(e,t)}function US(e,t,r){return t=kW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kW(e){var t=t4e(e,"string");return gm(t)=="symbol"?t:t+""}function t4e(e,t){if(gm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var s8=1,r4e=function(e){function t(){var r;YEe(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=XEe(this,t,[].concat(i)),US(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),US(r,"handleKeyDown",function(o){if(o.key==="Escape"){var l,c,d,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(d=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&d!==void 0?d:0}})}}),r}return e4e(t,e),ZEe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>s8||Math.abs(n.height-this.state.lastBoundingBox.height)>s8)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,i=this.props,a=i.active,o=i.allowEscapeViewBox,l=i.animationDuration,c=i.animationEasing,d=i.children,u=i.coordinate,h=i.hasPayload,f=i.isAnimationActive,p=i.offset,x=i.position,g=i.reverseDirection,v=i.useTranslate3d,_=i.viewBox,w=i.wrapperStyle,b=GEe({allowEscapeViewBox:o,coordinate:u,offsetTopLeft:p,position:x,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:v,viewBox:_}),N=b.cssClasses,S=b.cssProperties,k=n8(n8({transition:f&&a?"transform ".concat(l,"ms ").concat(c):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&a&&h?"visible":"hidden",position:"absolute",top:0,left:0},w);return Q.createElement("div",{tabIndex:-1,className:N,style:k,ref:function(A){n.wrapperNode=A}},d)}}])}(y.PureComponent),n4e=function(){return!(typeof window!="undefined"&&window.document&&window.document.createElement&&window.setTimeout)},yl={isSsr:n4e(),get:function(t){return yl[t]},set:function(t,r){if(typeof t=="string")yl[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(i){yl[i]=t[i]})}}};function vm(e){"@babel/helpers - typeof";return vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vm(e)}function i8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function a8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i8(Object(r),!0).forEach(function(n){nC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function s4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i4e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CW(n.key),n)}}function a4e(e,t,r){return t&&i4e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function o4e(e,t,r){return t=u_(t),l4e(e,EW()?Reflect.construct(t,r||[],u_(e).constructor):t.apply(e,r))}function l4e(e,t){if(t&&(vm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c4e(e)}function c4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(EW=function(){return!!e})()}function u_(e){return u_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},u_(e)}function d4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BS(e,t)}function BS(e,t){return BS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},BS(e,t)}function nC(e,t,r){return t=CW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CW(e){var t=u4e(e,"string");return vm(t)=="symbol"?t:t+""}function u4e(e,t){if(vm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function f4e(e){return e.dataKey}function h4e(e,t){return Q.isValidElement(e)?Q.cloneElement(e,t):typeof e=="function"?Q.createElement(e,t):Q.createElement(BEe,t)}var Hs=function(e){function t(){return s4e(this,t),o4e(this,t,arguments)}return d4e(t,e),a4e(t,[{key:"render",value:function(){var n=this,i=this.props,a=i.active,o=i.allowEscapeViewBox,l=i.animationDuration,c=i.animationEasing,d=i.content,u=i.coordinate,h=i.filterNull,f=i.isAnimationActive,p=i.offset,x=i.payload,g=i.payloadUniqBy,v=i.position,_=i.reverseDirection,w=i.useTranslate3d,b=i.viewBox,N=i.wrapperStyle,S=x!=null?x:[];h&&S.length&&(S=vW(x.filter(function(O){return O.value!=null&&(O.hide!==!0||n.props.includeHidden)}),g,f4e));var k=S.length>0;return Q.createElement(r4e,{allowEscapeViewBox:o,animationDuration:l,animationEasing:c,isAnimationActive:f,active:a,coordinate:u,hasPayload:k,offset:p,position:v,reverseDirection:_,useTranslate3d:w,viewBox:b,wrapperStyle:N},h4e(d,a8(a8({},this.props),{},{payload:S})))}}])}(y.PureComponent);nC(Hs,"displayName","Tooltip");nC(Hs,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!yl.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var m4e=Al,p4e=function(){return m4e.Date.now()},g4e=p4e,v4e=/\s/;function x4e(e){for(var t=e.length;t--&&v4e.test(e.charAt(t)););return t}var y4e=x4e,_4e=y4e,w4e=/^\s+/;function b4e(e){return e&&e.slice(0,_4e(e)+1).replace(w4e,"")}var j4e=b4e,N4e=j4e,o8=Fd,S4e=ap,l8=NaN,k4e=/^[-+]0x[0-9a-f]+$/i,E4e=/^0b[01]+$/i,C4e=/^0o[0-7]+$/i,P4e=parseInt;function A4e(e){if(typeof e=="number")return e;if(S4e(e))return l8;if(o8(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=o8(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=N4e(e);var r=E4e.test(e);return r||C4e.test(e)?P4e(e.slice(2),r?2:8):k4e.test(e)?l8:+e}var PW=A4e,T4e=Fd,eN=g4e,c8=PW,O4e="Expected a function",R4e=Math.max,M4e=Math.min;function D4e(e,t,r){var n,i,a,o,l,c,d=0,u=!1,h=!1,f=!0;if(typeof e!="function")throw new TypeError(O4e);t=c8(t)||0,T4e(r)&&(u=!!r.leading,h="maxWait"in r,a=h?R4e(c8(r.maxWait)||0,t):a,f="trailing"in r?!!r.trailing:f);function p(k){var O=n,A=i;return n=i=void 0,d=k,o=e.apply(A,O),o}function x(k){return d=k,l=setTimeout(_,t),u?p(k):o}function g(k){var O=k-c,A=k-d,T=t-O;return h?M4e(T,a-A):T}function v(k){var O=k-c,A=k-d;return c===void 0||O>=t||O<0||h&&A>=a}function _(){var k=eN();if(v(k))return w(k);l=setTimeout(_,g(k))}function w(k){return l=void 0,f&&n?p(k):(n=i=void 0,o)}function b(){l!==void 0&&clearTimeout(l),d=0,n=c=i=l=void 0}function N(){return l===void 0?o:w(eN())}function S(){var k=eN(),O=v(k);if(n=arguments,i=this,c=k,O){if(l===void 0)return x(c);if(h)return clearTimeout(l),l=setTimeout(_,t),p(c)}return l===void 0&&(l=setTimeout(_,t)),o}return S.cancel=b,S.flush=N,S}var I4e=D4e,$4e=I4e,L4e=Fd,F4e="Expected a function";function U4e(e,t,r){var n=!0,i=!0;if(typeof e!="function")throw new TypeError(F4e);return L4e(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),$4e(e,t,{leading:n,maxWait:t,trailing:i})}var B4e=U4e;const AW=rn(B4e);function Mg(e){"@babel/helpers - typeof";return Mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mg(e)}function d8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d8(Object(r),!0).forEach(function(n){z4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z4e(e,t,r){return t=V4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V4e(e){var t=q4e(e,"string");return Mg(t)=="symbol"?t:t+""}function q4e(e,t){if(Mg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W4e(e,t){return K4e(e)||Y4e(e,t)||G4e(e,t)||H4e()}function H4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G4e(e,t){if(e){if(typeof e=="string")return u8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u8(e,t)}}function u8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Y4e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,d=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,i=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw i}}return l}}function K4e(e){if(Array.isArray(e))return e}var Wl=y.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,i=n===void 0?{width:-1,height:-1}:n,a=e.width,o=a===void 0?"100%":a,l=e.height,c=l===void 0?"100%":l,d=e.minWidth,u=d===void 0?0:d,h=e.minHeight,f=e.maxHeight,p=e.children,x=e.debounce,g=x===void 0?0:x,v=e.id,_=e.className,w=e.onResize,b=e.style,N=b===void 0?{}:b,S=y.useRef(null),k=y.useRef();k.current=w,y.useImperativeHandle(t,function(){return Object.defineProperty(S.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),S.current},configurable:!0})});var O=y.useState({containerWidth:i.width,containerHeight:i.height}),A=W4e(O,2),T=A[0],$=A[1],R=y.useCallback(function(D,B){$(function(U){var V=Math.round(D),Y=Math.round(B);return U.containerWidth===V&&U.containerHeight===Y?U:{containerWidth:V,containerHeight:Y}})},[]);y.useEffect(function(){var D=function(K){var Z,G=K[0].contentRect,X=G.width,te=G.height;R(X,te),(Z=k.current)===null||Z===void 0||Z.call(k,X,te)};g>0&&(D=AW(D,g,{trailing:!0,leading:!1}));var B=new ResizeObserver(D),U=S.current.getBoundingClientRect(),V=U.width,Y=U.height;return R(V,Y),B.observe(S.current),function(){B.disconnect()}},[R,g]);var F=y.useMemo(function(){var D=T.containerWidth,B=T.containerHeight;if(D<0||B<0)return null;dc(pu(o)||pu(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,c),dc(!r||r>0,"The aspect(%s) must be greater than zero.",r);var U=pu(o)?D:o,V=pu(c)?B:c;r&&r>0&&(U?V=U/r:V&&(U=V*r),f&&V>f&&(V=f)),dc(U>0||V>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,U,V,o,c,u,h,r);var Y=!Array.isArray(p)&&cc(p.type).endsWith("Chart");return Q.Children.map(p,function(z){return Q.isValidElement(z)?y.cloneElement(z,cy({width:U,height:V},Y?{style:cy({height:"100%",width:"100%",maxHeight:V,maxWidth:U},z.props.style)}:{})):z})},[r,p,c,f,h,u,T,o]);return Q.createElement("div",{id:v?"".concat(v):void 0,className:Lr("recharts-responsive-container",_),style:cy(cy({},N),{},{width:o,height:c,minWidth:u,minHeight:h,maxHeight:f}),ref:S},F)}),TW=function(t){return null};TW.displayName="Cell";function Dg(e){"@babel/helpers - typeof";return Dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dg(e)}function f8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function zS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f8(Object(r),!0).forEach(function(n){Z4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z4e(e,t,r){return t=X4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X4e(e){var t=J4e(e,"string");return Dg(t)=="symbol"?t:t+""}function J4e(e,t){if(Dg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zf={widthCache:{},cacheCount:0},Q4e=2e3,eCe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},h8="recharts_measurement_span";function tCe(e){var t=zS({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var L0=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||yl.isSsr)return{width:0,height:0};var n=tCe(r),i=JSON.stringify({text:t,copyStyle:n});if(zf.widthCache[i])return zf.widthCache[i];try{var a=document.getElementById(h8);a||(a=document.createElement("span"),a.setAttribute("id",h8),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var o=zS(zS({},eCe),n);Object.assign(a.style,o),a.textContent="".concat(t);var l=a.getBoundingClientRect(),c={width:l.width,height:l.height};return zf.widthCache[i]=c,++zf.cacheCount>Q4e&&(zf.cacheCount=0,zf.widthCache={}),c}catch(d){return{width:0,height:0}}},rCe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Ig(e){"@babel/helpers - typeof";return Ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ig(e)}function f_(e,t){return aCe(e)||iCe(e,t)||sCe(e,t)||nCe()}function nCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sCe(e,t){if(e){if(typeof e=="string")return m8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m8(e,t)}}function m8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iCe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,d=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,i=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw i}}return l}}function aCe(e){if(Array.isArray(e))return e}function oCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cCe(n.key),n)}}function lCe(e,t,r){return t&&p8(e.prototype,t),r&&p8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cCe(e){var t=dCe(e,"string");return Ig(t)=="symbol"?t:t+""}function dCe(e,t){if(Ig(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ig(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var g8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,v8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,uCe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,fCe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,OW={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},hCe=Object.keys(OW),mh="NaN";function mCe(e,t){return e*OW[t]}var dy=function(){function e(t,r){oCe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!uCe.test(r)&&(this.num=NaN,this.unit=""),hCe.includes(r)&&(this.num=mCe(t,r),this.unit="px")}return lCe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,i=(n=fCe.exec(r))!==null&&n!==void 0?n:[],a=f_(i,3),o=a[1],l=a[2];return new e(parseFloat(o),l!=null?l:"")}}])}();function RW(e){if(e.includes(mh))return mh;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=g8.exec(t))!==null&&r!==void 0?r:[],i=f_(n,4),a=i[1],o=i[2],l=i[3],c=dy.parse(a!=null?a:""),d=dy.parse(l!=null?l:""),u=o==="*"?c.multiply(d):c.divide(d);if(u.isNaN())return mh;t=t.replace(g8,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var h,f=(h=v8.exec(t))!==null&&h!==void 0?h:[],p=f_(f,4),x=p[1],g=p[2],v=p[3],_=dy.parse(x!=null?x:""),w=dy.parse(v!=null?v:""),b=g==="+"?_.add(w):_.subtract(w);if(b.isNaN())return mh;t=t.replace(v8,b.toString())}return t}var x8=/\(([^()]*)\)/;function pCe(e){for(var t=e;t.includes("(");){var r=x8.exec(t),n=f_(r,2),i=n[1];t=t.replace(x8,RW(i))}return t}function gCe(e){var t=e.replace(/\s+/g,"");return t=pCe(t),t=RW(t),t}function vCe(e){try{return gCe(e)}catch(t){return mh}}function tN(e){var t=vCe(e.slice(5,-1));return t===mh?"":t}var xCe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],yCe=["dx","dy","angle","className","breakAll"];function VS(){return VS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VS.apply(this,arguments)}function y8(e,t){if(e==null)return{};var r=_Ce(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _Ce(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function _8(e,t){return NCe(e)||jCe(e,t)||bCe(e,t)||wCe()}function wCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bCe(e,t){if(e){if(typeof e=="string")return w8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w8(e,t)}}function w8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jCe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,d=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,i=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw i}}return l}}function NCe(e){if(Array.isArray(e))return e}var MW=/[ \f\n\r\t\v\u2028\u2029]+/,DW=function(t){var r=t.children,n=t.breakAll,i=t.style;try{var a=[];Or(r)||(n?a=r.toString().split(""):a=r.toString().split(MW));var o=a.map(function(c){return{word:c,width:L0(c,i).width}}),l=n?0:L0("",i).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch(c){return null}},SCe=function(t,r,n,i,a){var o=t.maxLines,l=t.children,c=t.style,d=t.breakAll,u=_t(o),h=l,f=function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return U.reduce(function(V,Y){var z=Y.word,K=Y.width,Z=V[V.length-1];if(Z&&(i==null||a||Z.width+K+n<Number(i)))Z.words.push(z),Z.width+=K+n;else{var G={words:[z],width:K};V.push(G)}return V},[])},p=f(r),x=function(U){return U.reduce(function(V,Y){return V.width>Y.width?V:Y})};if(!u)return p;for(var g="",v=function(U){var V=h.slice(0,U),Y=DW({breakAll:d,style:c,children:V+g}).wordsWithComputedWidth,z=f(Y),K=z.length>o||x(z).width>Number(i);return[K,z]},_=0,w=h.length-1,b=0,N;_<=w&&b<=h.length-1;){var S=Math.floor((_+w)/2),k=S-1,O=v(k),A=_8(O,2),T=A[0],$=A[1],R=v(S),F=_8(R,1),D=F[0];if(!T&&!D&&(_=S+1),T&&D&&(w=S-1),!T&&D){N=$;break}b++}return N||p},b8=function(t){var r=Or(t)?[]:t.toString().split(MW);return[{words:r}]},kCe=function(t){var r=t.width,n=t.scaleToFit,i=t.children,a=t.style,o=t.breakAll,l=t.maxLines;if((r||n)&&!yl.isSsr){var c,d,u=DW({breakAll:o,children:i,style:a});if(u){var h=u.wordsWithComputedWidth,f=u.spaceWidth;c=h,d=f}else return b8(i);return SCe({breakAll:o,children:i,maxLines:l,style:a},c,d,r,n)}return b8(i)},j8="#808080",h_=function(t){var r=t.x,n=r===void 0?0:r,i=t.y,a=i===void 0?0:i,o=t.lineHeight,l=o===void 0?"1em":o,c=t.capHeight,d=c===void 0?"0.71em":c,u=t.scaleToFit,h=u===void 0?!1:u,f=t.textAnchor,p=f===void 0?"start":f,x=t.verticalAnchor,g=x===void 0?"end":x,v=t.fill,_=v===void 0?j8:v,w=y8(t,xCe),b=y.useMemo(function(){return kCe({breakAll:w.breakAll,children:w.children,maxLines:w.maxLines,scaleToFit:h,style:w.style,width:w.width})},[w.breakAll,w.children,w.maxLines,h,w.style,w.width]),N=w.dx,S=w.dy,k=w.angle,O=w.className,A=w.breakAll,T=y8(w,yCe);if(!Ms(n)||!Ms(a))return null;var $=n+(_t(N)?N:0),R=a+(_t(S)?S:0),F;switch(g){case"start":F=tN("calc(".concat(d,")"));break;case"middle":F=tN("calc(".concat((b.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:F=tN("calc(".concat(b.length-1," * -").concat(l,")"));break}var D=[];if(h){var B=b[0].width,U=w.width;D.push("scale(".concat((_t(U)?U/B:1)/B,")"))}return k&&D.push("rotate(".concat(k,", ").concat($,", ").concat(R,")")),D.length&&(T.transform=D.join(" ")),Q.createElement("text",VS({},Pr(T,!0),{x:$,y:R,className:Lr("recharts-text",O),textAnchor:p,fill:_.includes("url")?j8:_}),b.map(function(V,Y){var z=V.words.join(A?"":" ");return Q.createElement("tspan",{x:$,dy:Y===0?F:l,key:"".concat(z,"-").concat(Y)},z)}))};function wd(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ECe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function sC(e){let t,r,n;e.length!==2?(t=wd,r=(l,c)=>wd(e(l),c),n=(l,c)=>e(l)-c):(t=e===wd||e===ECe?e:CCe,r=e,n=e);function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const h=d+u>>>1;r(l[h],c)<0?d=h+1:u=h}while(d<u)}return d}function a(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const h=d+u>>>1;r(l[h],c)<=0?d=h+1:u=h}while(d<u)}return d}function o(l,c,d=0,u=l.length){const h=i(l,c,d,u-1);return h>d&&n(l[h-1],c)>-n(l[h],c)?h-1:h}return{left:i,center:o,right:a}}function CCe(){return 0}function IW(e){return e===null?NaN:+e}function*PCe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const ACe=sC(wd),Kv=ACe.right;sC(IW).center;class N8 extends Map{constructor(t,r=RCe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(S8(this,t))}has(t){return super.has(S8(this,t))}set(t,r){return super.set(TCe(this,t),r)}delete(t){return super.delete(OCe(this,t))}}function S8({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function TCe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function OCe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function RCe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function MCe(e=wd){if(e===wd)return $W;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function $W(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const DCe=Math.sqrt(50),ICe=Math.sqrt(10),$Ce=Math.sqrt(2);function m_(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),o=a>=DCe?10:a>=ICe?5:a>=$Ce?2:1;let l,c,d;return i<0?(d=Math.pow(10,-i)/o,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,i)*o,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?m_(e,t,r*2):[l,c,d]}function qS(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[i,a,o]=n?m_(t,e,r):m_(e,t,r);if(!(a>=i))return[];const l=a-i+1,c=new Array(l);if(n)if(o<0)for(let d=0;d<l;++d)c[d]=(a-d)/-o;else for(let d=0;d<l;++d)c[d]=(a-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(i+d)/-o;else for(let d=0;d<l;++d)c[d]=(i+d)*o;return c}function WS(e,t,r){return t=+t,e=+e,r=+r,m_(e,t,r)[2]}function HS(e,t,r){t=+t,e=+e,r=+r;const n=t<e,i=n?WS(t,e,r):WS(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function k8(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function E8(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function LW(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?$W:MCe(i);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,u=Math.log(c),h=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*h*(c-h)/c)*(d-c/2<0?-1:1),p=Math.max(r,Math.floor(t-d*h/c+f)),x=Math.min(n,Math.floor(t+(c-d)*h/c+f));LW(e,t,p,x,i)}const a=e[t];let o=r,l=n;for(s0(e,r,t),i(e[n],a)>0&&s0(e,r,n);o<l;){for(s0(e,o,l),++o,--l;i(e[o],a)<0;)++o;for(;i(e[l],a)>0;)--l}i(e[r],a)===0?s0(e,r,l):(++l,s0(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function s0(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function LCe(e,t,r){if(e=Float64Array.from(PCe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return E8(e);if(t>=1)return k8(e);var n,i=(n-1)*t,a=Math.floor(i),o=k8(LW(e,a).subarray(0,a+1)),l=E8(e.subarray(a+1));return o+(l-o)*(i-a)}}function FCe(e,t,r=IW){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,a=Math.floor(i),o=+r(e[a],a,e),l=+r(e[a+1],a+1,e);return o+(l-o)*(i-a)}}function UCe(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(i);++n<i;)a[n]=e+n*r;return a}function so(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Oc(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const GS=Symbol("implicit");function iC(){var e=new N8,t=[],r=[],n=GS;function i(a){let o=e.get(a);if(o===void 0){if(n!==GS)return n;e.set(a,o=t.push(a)-1)}return r[o%r.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new N8;for(const o of a)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return iC(t,r).unknown(n)},so.apply(i,arguments),i}function $g(){var e=iC().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,a,o,l=!1,c=0,d=0,u=.5;delete e.unknown;function h(){var f=t().length,p=i<n,x=p?i:n,g=p?n:i;a=(g-x)/Math.max(1,f-c+d*2),l&&(a=Math.floor(a)),x+=(g-x-a*(f-c))*u,o=a*(1-c),l&&(x=Math.round(x),o=Math.round(o));var v=UCe(f).map(function(_){return x+a*_});return r(p?v.reverse():v)}return e.domain=function(f){return arguments.length?(t(f),h()):t()},e.range=function(f){return arguments.length?([n,i]=f,n=+n,i=+i,h()):[n,i]},e.rangeRound=function(f){return[n,i]=f,n=+n,i=+i,l=!0,h()},e.bandwidth=function(){return o},e.step=function(){return a},e.round=function(f){return arguments.length?(l=!!f,h()):l},e.padding=function(f){return arguments.length?(c=Math.min(1,d=+f),h()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),h()):c},e.paddingOuter=function(f){return arguments.length?(d=+f,h()):d},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),h()):u},e.copy=function(){return $g(t(),[n,i]).round(l).paddingInner(c).paddingOuter(d).align(u)},so.apply(h(),arguments)}function FW(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return FW(t())},e}function F0(){return FW($g.apply(null,arguments).paddingInner(1))}function aC(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function UW(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Zv(){}var Lg=.7,p_=1/Lg,Dh="\\s*([+-]?\\d+)\\s*",Fg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",BCe=/^#([0-9a-f]{3,8})$/,zCe=new RegExp(`^rgb\\(${Dh},${Dh},${Dh}\\)$`),VCe=new RegExp(`^rgb\\(${_l},${_l},${_l}\\)$`),qCe=new RegExp(`^rgba\\(${Dh},${Dh},${Dh},${Fg}\\)$`),WCe=new RegExp(`^rgba\\(${_l},${_l},${_l},${Fg}\\)$`),HCe=new RegExp(`^hsl\\(${Fg},${_l},${_l}\\)$`),GCe=new RegExp(`^hsla\\(${Fg},${_l},${_l},${Fg}\\)$`),C8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};aC(Zv,Ug,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:P8,formatHex:P8,formatHex8:YCe,formatHsl:KCe,formatRgb:A8,toString:A8});function P8(){return this.rgb().formatHex()}function YCe(){return this.rgb().formatHex8()}function KCe(){return BW(this).formatHsl()}function A8(){return this.rgb().formatRgb()}function Ug(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=BCe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?T8(t):r===3?new ra(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?uy(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?uy(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=zCe.exec(e))?new ra(t[1],t[2],t[3],1):(t=VCe.exec(e))?new ra(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=qCe.exec(e))?uy(t[1],t[2],t[3],t[4]):(t=WCe.exec(e))?uy(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=HCe.exec(e))?M8(t[1],t[2]/100,t[3]/100,1):(t=GCe.exec(e))?M8(t[1],t[2]/100,t[3]/100,t[4]):C8.hasOwnProperty(e)?T8(C8[e]):e==="transparent"?new ra(NaN,NaN,NaN,0):null}function T8(e){return new ra(e>>16&255,e>>8&255,e&255,1)}function uy(e,t,r,n){return n<=0&&(e=t=r=NaN),new ra(e,t,r,n)}function ZCe(e){return e instanceof Zv||(e=Ug(e)),e?(e=e.rgb(),new ra(e.r,e.g,e.b,e.opacity)):new ra}function YS(e,t,r,n){return arguments.length===1?ZCe(e):new ra(e,t,r,n==null?1:n)}function ra(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}aC(ra,YS,UW(Zv,{brighter(e){return e=e==null?p_:Math.pow(p_,e),new ra(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Lg:Math.pow(Lg,e),new ra(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ra(Ru(this.r),Ru(this.g),Ru(this.b),g_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:O8,formatHex:O8,formatHex8:XCe,formatRgb:R8,toString:R8}));function O8(){return`#${gu(this.r)}${gu(this.g)}${gu(this.b)}`}function XCe(){return`#${gu(this.r)}${gu(this.g)}${gu(this.b)}${gu((isNaN(this.opacity)?1:this.opacity)*255)}`}function R8(){const e=g_(this.opacity);return`${e===1?"rgb(":"rgba("}${Ru(this.r)}, ${Ru(this.g)}, ${Ru(this.b)}${e===1?")":`, ${e})`}`}function g_(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ru(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function gu(e){return e=Ru(e),(e<16?"0":"")+e.toString(16)}function M8(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ko(e,t,r,n)}function BW(e){if(e instanceof ko)return new ko(e.h,e.s,e.l,e.opacity);if(e instanceof Zv||(e=Ug(e)),!e)return new ko;if(e instanceof ko)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=NaN,l=a-i,c=(a+i)/2;return l?(t===a?o=(r-n)/l+(r<n)*6:r===a?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?a+i:2-a-i,o*=60):l=c>0&&c<1?0:o,new ko(o,l,c,e.opacity)}function JCe(e,t,r,n){return arguments.length===1?BW(e):new ko(e,t,r,n==null?1:n)}function ko(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}aC(ko,JCe,UW(Zv,{brighter(e){return e=e==null?p_:Math.pow(p_,e),new ko(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Lg:Math.pow(Lg,e),new ko(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new ra(rN(e>=240?e-240:e+120,i,n),rN(e,i,n),rN(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new ko(D8(this.h),fy(this.s),fy(this.l),g_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=g_(this.opacity);return`${e===1?"hsl(":"hsla("}${D8(this.h)}, ${fy(this.s)*100}%, ${fy(this.l)*100}%${e===1?")":`, ${e})`}`}}));function D8(e){return e=(e||0)%360,e<0?e+360:e}function fy(e){return Math.max(0,Math.min(1,e||0))}function rN(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const oC=e=>()=>e;function QCe(e,t){return function(r){return e+r*t}}function e6e(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function t6e(e){return(e=+e)==1?zW:function(t,r){return r-t?e6e(t,r,e):oC(isNaN(t)?r:t)}}function zW(e,t){var r=t-e;return r?QCe(e,r):oC(isNaN(e)?t:e)}const I8=function e(t){var r=t6e(t);function n(i,a){var o=r((i=YS(i)).r,(a=YS(a)).r),l=r(i.g,a.g),c=r(i.b,a.b),d=zW(i.opacity,a.opacity);return function(u){return i.r=o(u),i.g=l(u),i.b=c(u),i.opacity=d(u),i+""}}return n.gamma=e,n}(1);function r6e(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function n6e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function s6e(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=gp(e[o],t[o]);for(;o<r;++o)a[o]=t[o];return function(l){for(o=0;o<n;++o)a[o]=i[o](l);return a}}function i6e(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function v_(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function a6e(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=gp(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var KS=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nN=new RegExp(KS.source,"g");function o6e(e){return function(){return e}}function l6e(e){return function(t){return e(t)+""}}function c6e(e,t){var r=KS.lastIndex=nN.lastIndex=0,n,i,a,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=KS.exec(e))&&(i=nN.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),l[o]?l[o]+=a:l[++o]=a),(n=n[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:v_(n,i)})),r=nN.lastIndex;return r<t.length&&(a=t.slice(r),l[o]?l[o]+=a:l[++o]=a),l.length<2?c[0]?l6e(c[0].x):o6e(t):(t=c.length,function(d){for(var u=0,h;u<t;++u)l[(h=c[u]).i]=h.x(d);return l.join("")})}function gp(e,t){var r=typeof t,n;return t==null||r==="boolean"?oC(t):(r==="number"?v_:r==="string"?(n=Ug(t))?(t=n,I8):c6e:t instanceof Ug?I8:t instanceof Date?i6e:n6e(t)?r6e:Array.isArray(t)?s6e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?a6e:v_)(e,t)}function lC(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function d6e(e,t){t===void 0&&(t=e,e=gp);for(var r=0,n=t.length-1,i=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(i,i=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return a[l](o-l)}}function u6e(e){return function(){return e}}function x_(e){return+e}var $8=[0,1];function Oi(e){return e}function ZS(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:u6e(isNaN(t)?NaN:.5)}function f6e(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function h6e(e,t,r){var n=e[0],i=e[1],a=t[0],o=t[1];return i<n?(n=ZS(i,n),a=r(o,a)):(n=ZS(n,i),a=r(a,o)),function(l){return a(n(l))}}function m6e(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=ZS(e[o],e[o+1]),a[o]=r(t[o],t[o+1]);return function(l){var c=Kv(e,l,1,n)-1;return a[c](i[c](l))}}function Xv(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function G1(){var e=$8,t=$8,r=gp,n,i,a,o=Oi,l,c,d;function u(){var f=Math.min(e.length,t.length);return o!==Oi&&(o=f6e(e[0],e[f-1])),l=f>2?m6e:h6e,c=d=null,h}function h(f){return f==null||isNaN(f=+f)?a:(c||(c=l(e.map(n),t,r)))(n(o(f)))}return h.invert=function(f){return o(i((d||(d=l(t,e.map(n),v_)))(f)))},h.domain=function(f){return arguments.length?(e=Array.from(f,x_),u()):e.slice()},h.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},h.rangeRound=function(f){return t=Array.from(f),r=lC,u()},h.clamp=function(f){return arguments.length?(o=f?!0:Oi,u()):o!==Oi},h.interpolate=function(f){return arguments.length?(r=f,u()):r},h.unknown=function(f){return arguments.length?(a=f,h):a},function(f,p){return n=f,i=p,u()}}function cC(){return G1()(Oi,Oi)}function p6e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function y_(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function xm(e){return e=y_(Math.abs(e)),e?e[1]:NaN}function g6e(e,t){return function(r,n){for(var i=r.length,a=[],o=0,l=e[0],c=0;i>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),a.push(r.substring(i-=l,i+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return a.reverse().join(t)}}function v6e(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var x6e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Bg(e){if(!(t=x6e.exec(e)))throw new Error("invalid format: "+e);var t;return new dC({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Bg.prototype=dC.prototype;function dC(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}dC.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function y6e(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var VW;function _6e(e,t){var r=y_(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(VW=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+y_(e,Math.max(0,t+a-1))[0]}function L8(e,t){var r=y_(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const F8={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:p6e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>L8(e*100,t),r:L8,s:_6e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function U8(e){return e}var B8=Array.prototype.map,z8=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function w6e(e){var t=e.grouping===void 0||e.thousands===void 0?U8:g6e(B8.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?U8:v6e(B8.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(h){h=Bg(h);var f=h.fill,p=h.align,x=h.sign,g=h.symbol,v=h.zero,_=h.width,w=h.comma,b=h.precision,N=h.trim,S=h.type;S==="n"?(w=!0,S="g"):F8[S]||(b===void 0&&(b=12),N=!0,S="g"),(v||f==="0"&&p==="=")&&(v=!0,f="0",p="=");var k=g==="$"?r:g==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",O=g==="$"?n:/[%p]/.test(S)?o:"",A=F8[S],T=/[defgprs%]/.test(S);b=b===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function $(R){var F=k,D=O,B,U,V;if(S==="c")D=A(R)+D,R="";else{R=+R;var Y=R<0||1/R<0;if(R=isNaN(R)?c:A(Math.abs(R),b),N&&(R=y6e(R)),Y&&+R==0&&x!=="+"&&(Y=!1),F=(Y?x==="("?x:l:x==="-"||x==="("?"":x)+F,D=(S==="s"?z8[8+VW/3]:"")+D+(Y&&x==="("?")":""),T){for(B=-1,U=R.length;++B<U;)if(V=R.charCodeAt(B),48>V||V>57){D=(V===46?i+R.slice(B+1):R.slice(B))+D,R=R.slice(0,B);break}}}w&&!v&&(R=t(R,1/0));var z=F.length+R.length+D.length,K=z<_?new Array(_-z+1).join(f):"";switch(w&&v&&(R=t(K+R,K.length?_-D.length:1/0),K=""),p){case"<":R=F+R+D+K;break;case"=":R=F+K+R+D;break;case"^":R=K.slice(0,z=K.length>>1)+F+R+D+K.slice(z);break;default:R=K+F+R+D;break}return a(R)}return $.toString=function(){return h+""},$}function u(h,f){var p=d((h=Bg(h),h.type="f",h)),x=Math.max(-8,Math.min(8,Math.floor(xm(f)/3)))*3,g=Math.pow(10,-x),v=z8[8+x/3];return function(_){return p(g*_)+v}}return{format:d,formatPrefix:u}}var hy,uC,qW;b6e({thousands:",",grouping:[3],currency:["$",""]});function b6e(e){return hy=w6e(e),uC=hy.format,qW=hy.formatPrefix,hy}function j6e(e){return Math.max(0,-xm(Math.abs(e)))}function N6e(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(xm(t)/3)))*3-xm(Math.abs(e)))}function S6e(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,xm(t)-xm(e))+1}function WW(e,t,r,n){var i=HS(e,t,r),a;switch(n=Bg(n==null?",f":n),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=N6e(i,o))&&(n.precision=a),qW(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=S6e(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=j6e(i))&&(n.precision=a-(n.type==="%")*2);break}}return uC(n)}function Bd(e){var t=e.domain;return e.ticks=function(r){var n=t();return qS(n[0],n[n.length-1],r==null?10:r)},e.tickFormat=function(r,n){var i=t();return WW(i[0],i[i.length-1],r==null?10:r,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,a=n.length-1,o=n[i],l=n[a],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=i,i=a,a=d);u-- >0;){if(d=WS(o,l,r),d===c)return n[i]=o,n[a]=l,t(n);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function __(){var e=cC();return e.copy=function(){return Xv(e,__())},so.apply(e,arguments),Bd(e)}function HW(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,x_),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return HW(e).unknown(t)},e=arguments.length?Array.from(e,x_):[0,1],Bd(r)}function GW(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],a=e[n],o;return a<i&&(o=r,r=n,n=o,o=i,i=a,a=o),e[r]=t.floor(i),e[n]=t.ceil(a),e}function V8(e){return Math.log(e)}function q8(e){return Math.exp(e)}function k6e(e){return-Math.log(-e)}function E6e(e){return-Math.exp(-e)}function C6e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function P6e(e){return e===10?C6e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function A6e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function W8(e){return(t,r)=>-e(-t,r)}function fC(e){const t=e(V8,q8),r=t.domain;let n=10,i,a;function o(){return i=A6e(n),a=P6e(n),r()[0]<0?(i=W8(i),a=W8(a),e(k6e,E6e)):e(V8,q8),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const h=u<d;h&&([d,u]=[u,d]);let f=i(d),p=i(u),x,g;const v=l==null?10:+l;let _=[];if(!(n%1)&&p-f<v){if(f=Math.floor(f),p=Math.ceil(p),d>0){for(;f<=p;++f)for(x=1;x<n;++x)if(g=f<0?x/a(-f):x*a(f),!(g<d)){if(g>u)break;_.push(g)}}else for(;f<=p;++f)for(x=n-1;x>=1;--x)if(g=f>0?x/a(-f):x*a(f),!(g<d)){if(g>u)break;_.push(g)}_.length*2<v&&(_=qS(d,u,v))}else _=qS(f,p,Math.min(p-f,v)).map(a);return h?_.reverse():_},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=Bg(c)).precision==null&&(c.trim=!0),c=uC(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return u=>{let h=u/a(Math.round(i(u)));return h*n<n-.5&&(h*=n),h<=d?c(u):""}},t.nice=()=>r(GW(r(),{floor:l=>a(Math.floor(i(l))),ceil:l=>a(Math.ceil(i(l)))})),t}function YW(){const e=fC(G1()).domain([1,10]);return e.copy=()=>Xv(e,YW()).base(e.base()),so.apply(e,arguments),e}function H8(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function G8(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function hC(e){var t=1,r=e(H8(t),G8(t));return r.constant=function(n){return arguments.length?e(H8(t=+n),G8(t)):t},Bd(r)}function KW(){var e=hC(G1());return e.copy=function(){return Xv(e,KW()).constant(e.constant())},so.apply(e,arguments)}function Y8(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function T6e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function O6e(e){return e<0?-e*e:e*e}function mC(e){var t=e(Oi,Oi),r=1;function n(){return r===1?e(Oi,Oi):r===.5?e(T6e,O6e):e(Y8(r),Y8(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},Bd(t)}function pC(){var e=mC(G1());return e.copy=function(){return Xv(e,pC()).exponent(e.exponent())},so.apply(e,arguments),e}function R6e(){return pC.apply(null,arguments).exponent(.5)}function K8(e){return Math.sign(e)*e*e}function M6e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function ZW(){var e=cC(),t=[0,1],r=!1,n;function i(a){var o=M6e(e(a));return isNaN(o)?n:r?Math.round(o):o}return i.invert=function(a){return e.invert(K8(a))},i.domain=function(a){return arguments.length?(e.domain(a),i):e.domain()},i.range=function(a){return arguments.length?(e.range((t=Array.from(a,x_)).map(K8)),i):t.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(e.clamp(a),i):e.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return ZW(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},so.apply(i,arguments),Bd(i)}function XW(){var e=[],t=[],r=[],n;function i(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=FCe(e,o/l);return a}function a(o){return o==null||isNaN(o=+o)?n:t[Kv(r,o)]}return a.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(wd),i()},a.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return XW().domain(e).range(t).unknown(n)},so.apply(a,arguments)}function JW(){var e=0,t=1,r=1,n=[.5],i=[0,1],a;function o(c){return c!=null&&c<=c?i[Kv(n,c,0,r)]:a}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(i=Array.from(c)).length-1,l()):i.slice()},o.invertExtent=function(c){var d=i.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},o.unknown=function(c){return arguments.length&&(a=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return JW().domain([e,t]).range(i).unknown(a)},so.apply(Bd(o),arguments)}function QW(){var e=[.5],t=[0,1],r,n=1;function i(a){return a!=null&&a<=a?t[Kv(e,a,0,n)]:r}return i.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return QW().domain(e).range(t).unknown(r)},so.apply(i,arguments)}const sN=new Date,iN=new Date;function Ls(e,t,r,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(e(a=new Date(+a)),a),i.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),i.round=a=>{const o=i(a),l=i.ceil(a);return a-o<l-a?o:l},i.offset=(a,o)=>(t(a=new Date(+a),o==null?1:Math.floor(o)),a),i.range=(a,o,l)=>{const c=[];if(a=i.ceil(a),l=l==null?1:Math.floor(l),!(a<o)||!(l>0))return c;let d;do c.push(d=new Date(+a)),t(a,l),e(a);while(d<a&&a<o);return c},i.filter=a=>Ls(o=>{if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!a(o););else for(;--l>=0;)for(;t(o,1),!a(o););}),r&&(i.count=(a,o)=>(sN.setTime(+a),iN.setTime(+o),e(sN),e(iN),Math.floor(r(sN,iN))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?o=>n(o)%a===0:o=>i.count(0,o)%a===0):i)),i}const w_=Ls(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);w_.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ls(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):w_);w_.range;const ic=1e3,Ha=ic*60,ac=Ha*60,bc=ac*24,gC=bc*7,Z8=bc*30,aN=bc*365,vu=Ls(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ic)},(e,t)=>(t-e)/ic,e=>e.getUTCSeconds());vu.range;const vC=Ls(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ic)},(e,t)=>{e.setTime(+e+t*Ha)},(e,t)=>(t-e)/Ha,e=>e.getMinutes());vC.range;const xC=Ls(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ha)},(e,t)=>(t-e)/Ha,e=>e.getUTCMinutes());xC.range;const yC=Ls(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ic-e.getMinutes()*Ha)},(e,t)=>{e.setTime(+e+t*ac)},(e,t)=>(t-e)/ac,e=>e.getHours());yC.range;const _C=Ls(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ac)},(e,t)=>(t-e)/ac,e=>e.getUTCHours());_C.range;const Jv=Ls(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ha)/bc,e=>e.getDate()-1);Jv.range;const Y1=Ls(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/bc,e=>e.getUTCDate()-1);Y1.range;const eH=Ls(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/bc,e=>Math.floor(e/bc));eH.range;function xf(e){return Ls(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ha)/gC)}const K1=xf(0),b_=xf(1),D6e=xf(2),I6e=xf(3),ym=xf(4),$6e=xf(5),L6e=xf(6);K1.range;b_.range;D6e.range;I6e.range;ym.range;$6e.range;L6e.range;function yf(e){return Ls(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/gC)}const Z1=yf(0),j_=yf(1),F6e=yf(2),U6e=yf(3),_m=yf(4),B6e=yf(5),z6e=yf(6);Z1.range;j_.range;F6e.range;U6e.range;_m.range;B6e.range;z6e.range;const wC=Ls(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());wC.range;const bC=Ls(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());bC.range;const jc=Ls(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());jc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ls(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});jc.range;const Nc=Ls(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Nc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ls(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Nc.range;function tH(e,t,r,n,i,a){const o=[[vu,1,ic],[vu,5,5*ic],[vu,15,15*ic],[vu,30,30*ic],[a,1,Ha],[a,5,5*Ha],[a,15,15*Ha],[a,30,30*Ha],[i,1,ac],[i,3,3*ac],[i,6,6*ac],[i,12,12*ac],[n,1,bc],[n,2,2*bc],[r,1,gC],[t,1,Z8],[t,3,3*Z8],[e,1,aN]];function l(d,u,h){const f=u<d;f&&([d,u]=[u,d]);const p=h&&typeof h.range=="function"?h:c(d,u,h),x=p?p.range(d,+u+1):[];return f?x.reverse():x}function c(d,u,h){const f=Math.abs(u-d)/h,p=sC(([,,v])=>v).right(o,f);if(p===o.length)return e.every(HS(d/aN,u/aN,h));if(p===0)return w_.every(Math.max(HS(d,u,h),1));const[x,g]=o[f/o[p-1][2]<o[p][2]/f?p-1:p];return x.every(g)}return[l,c]}const[V6e,q6e]=tH(Nc,bC,Z1,eH,_C,xC),[W6e,H6e]=tH(jc,wC,K1,Jv,yC,vC);function oN(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function lN(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function i0(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function G6e(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,a=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,d=a0(i),u=o0(i),h=a0(a),f=o0(a),p=a0(o),x=o0(o),g=a0(l),v=o0(l),_=a0(c),w=o0(c),b={a:Y,A:z,b:K,B:Z,c:null,d:rT,e:rT,f:gPe,g:kPe,G:CPe,H:hPe,I:mPe,j:pPe,L:rH,m:vPe,M:xPe,p:G,q:X,Q:iT,s:aT,S:yPe,u:_Pe,U:wPe,V:bPe,w:jPe,W:NPe,x:null,X:null,y:SPe,Y:EPe,Z:PPe,"%":sT},N={a:te,A:se,b:ue,B:ye,c:null,d:nT,e:nT,f:RPe,g:VPe,G:WPe,H:APe,I:TPe,j:OPe,L:sH,m:MPe,M:DPe,p:ne,q:xe,Q:iT,s:aT,S:IPe,u:$Pe,U:LPe,V:FPe,w:UPe,W:BPe,x:null,X:null,y:zPe,Y:qPe,Z:HPe,"%":sT},S={a:$,A:R,b:F,B:D,c:B,d:eT,e:eT,f:cPe,g:Q8,G:J8,H:tT,I:tT,j:iPe,L:lPe,m:sPe,M:aPe,p:T,q:nPe,Q:uPe,s:fPe,S:oPe,u:J6e,U:Q6e,V:ePe,w:X6e,W:tPe,x:U,X:V,y:Q8,Y:J8,Z:rPe,"%":dPe};b.x=k(r,b),b.X=k(n,b),b.c=k(t,b),N.x=k(r,N),N.X=k(n,N),N.c=k(t,N);function k(ge,ie){return function(ee){var H=[],le=-1,Se=0,ae=ge.length,fe,he,pe;for(ee instanceof Date||(ee=new Date(+ee));++le<ae;)ge.charCodeAt(le)===37&&(H.push(ge.slice(Se,le)),(he=X8[fe=ge.charAt(++le)])!=null?fe=ge.charAt(++le):he=fe==="e"?" ":"0",(pe=ie[fe])&&(fe=pe(ee,he)),H.push(fe),Se=le+1);return H.push(ge.slice(Se,le)),H.join("")}}function O(ge,ie){return function(ee){var H=i0(1900,void 0,1),le=A(H,ge,ee+="",0),Se,ae;if(le!=ee.length)return null;if("Q"in H)return new Date(H.Q);if("s"in H)return new Date(H.s*1e3+("L"in H?H.L:0));if(ie&&!("Z"in H)&&(H.Z=0),"p"in H&&(H.H=H.H%12+H.p*12),H.m===void 0&&(H.m="q"in H?H.q:0),"V"in H){if(H.V<1||H.V>53)return null;"w"in H||(H.w=1),"Z"in H?(Se=lN(i0(H.y,0,1)),ae=Se.getUTCDay(),Se=ae>4||ae===0?j_.ceil(Se):j_(Se),Se=Y1.offset(Se,(H.V-1)*7),H.y=Se.getUTCFullYear(),H.m=Se.getUTCMonth(),H.d=Se.getUTCDate()+(H.w+6)%7):(Se=oN(i0(H.y,0,1)),ae=Se.getDay(),Se=ae>4||ae===0?b_.ceil(Se):b_(Se),Se=Jv.offset(Se,(H.V-1)*7),H.y=Se.getFullYear(),H.m=Se.getMonth(),H.d=Se.getDate()+(H.w+6)%7)}else("W"in H||"U"in H)&&("w"in H||(H.w="u"in H?H.u%7:"W"in H?1:0),ae="Z"in H?lN(i0(H.y,0,1)).getUTCDay():oN(i0(H.y,0,1)).getDay(),H.m=0,H.d="W"in H?(H.w+6)%7+H.W*7-(ae+5)%7:H.w+H.U*7-(ae+6)%7);return"Z"in H?(H.H+=H.Z/100|0,H.M+=H.Z%100,lN(H)):oN(H)}}function A(ge,ie,ee,H){for(var le=0,Se=ie.length,ae=ee.length,fe,he;le<Se;){if(H>=ae)return-1;if(fe=ie.charCodeAt(le++),fe===37){if(fe=ie.charAt(le++),he=S[fe in X8?ie.charAt(le++):fe],!he||(H=he(ge,ee,H))<0)return-1}else if(fe!=ee.charCodeAt(H++))return-1}return H}function T(ge,ie,ee){var H=d.exec(ie.slice(ee));return H?(ge.p=u.get(H[0].toLowerCase()),ee+H[0].length):-1}function $(ge,ie,ee){var H=p.exec(ie.slice(ee));return H?(ge.w=x.get(H[0].toLowerCase()),ee+H[0].length):-1}function R(ge,ie,ee){var H=h.exec(ie.slice(ee));return H?(ge.w=f.get(H[0].toLowerCase()),ee+H[0].length):-1}function F(ge,ie,ee){var H=_.exec(ie.slice(ee));return H?(ge.m=w.get(H[0].toLowerCase()),ee+H[0].length):-1}function D(ge,ie,ee){var H=g.exec(ie.slice(ee));return H?(ge.m=v.get(H[0].toLowerCase()),ee+H[0].length):-1}function B(ge,ie,ee){return A(ge,t,ie,ee)}function U(ge,ie,ee){return A(ge,r,ie,ee)}function V(ge,ie,ee){return A(ge,n,ie,ee)}function Y(ge){return o[ge.getDay()]}function z(ge){return a[ge.getDay()]}function K(ge){return c[ge.getMonth()]}function Z(ge){return l[ge.getMonth()]}function G(ge){return i[+(ge.getHours()>=12)]}function X(ge){return 1+~~(ge.getMonth()/3)}function te(ge){return o[ge.getUTCDay()]}function se(ge){return a[ge.getUTCDay()]}function ue(ge){return c[ge.getUTCMonth()]}function ye(ge){return l[ge.getUTCMonth()]}function ne(ge){return i[+(ge.getUTCHours()>=12)]}function xe(ge){return 1+~~(ge.getUTCMonth()/3)}return{format:function(ge){var ie=k(ge+="",b);return ie.toString=function(){return ge},ie},parse:function(ge){var ie=O(ge+="",!1);return ie.toString=function(){return ge},ie},utcFormat:function(ge){var ie=k(ge+="",N);return ie.toString=function(){return ge},ie},utcParse:function(ge){var ie=O(ge+="",!0);return ie.toString=function(){return ge},ie}}}var X8={"-":"",_:" ",0:"0"},Qs=/^\s*\d+/,Y6e=/^%/,K6e=/[\\^$*+?|[\]().{}]/g;function ln(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function Z6e(e){return e.replace(K6e,"\\$&")}function a0(e){return new RegExp("^(?:"+e.map(Z6e).join("|")+")","i")}function o0(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function X6e(e,t,r){var n=Qs.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function J6e(e,t,r){var n=Qs.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Q6e(e,t,r){var n=Qs.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function ePe(e,t,r){var n=Qs.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function tPe(e,t,r){var n=Qs.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function J8(e,t,r){var n=Qs.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function Q8(e,t,r){var n=Qs.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function rPe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function nPe(e,t,r){var n=Qs.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function sPe(e,t,r){var n=Qs.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function eT(e,t,r){var n=Qs.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function iPe(e,t,r){var n=Qs.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function tT(e,t,r){var n=Qs.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function aPe(e,t,r){var n=Qs.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function oPe(e,t,r){var n=Qs.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function lPe(e,t,r){var n=Qs.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function cPe(e,t,r){var n=Qs.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function dPe(e,t,r){var n=Y6e.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function uPe(e,t,r){var n=Qs.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function fPe(e,t,r){var n=Qs.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function rT(e,t){return ln(e.getDate(),t,2)}function hPe(e,t){return ln(e.getHours(),t,2)}function mPe(e,t){return ln(e.getHours()%12||12,t,2)}function pPe(e,t){return ln(1+Jv.count(jc(e),e),t,3)}function rH(e,t){return ln(e.getMilliseconds(),t,3)}function gPe(e,t){return rH(e,t)+"000"}function vPe(e,t){return ln(e.getMonth()+1,t,2)}function xPe(e,t){return ln(e.getMinutes(),t,2)}function yPe(e,t){return ln(e.getSeconds(),t,2)}function _Pe(e){var t=e.getDay();return t===0?7:t}function wPe(e,t){return ln(K1.count(jc(e)-1,e),t,2)}function nH(e){var t=e.getDay();return t>=4||t===0?ym(e):ym.ceil(e)}function bPe(e,t){return e=nH(e),ln(ym.count(jc(e),e)+(jc(e).getDay()===4),t,2)}function jPe(e){return e.getDay()}function NPe(e,t){return ln(b_.count(jc(e)-1,e),t,2)}function SPe(e,t){return ln(e.getFullYear()%100,t,2)}function kPe(e,t){return e=nH(e),ln(e.getFullYear()%100,t,2)}function EPe(e,t){return ln(e.getFullYear()%1e4,t,4)}function CPe(e,t){var r=e.getDay();return e=r>=4||r===0?ym(e):ym.ceil(e),ln(e.getFullYear()%1e4,t,4)}function PPe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ln(t/60|0,"0",2)+ln(t%60,"0",2)}function nT(e,t){return ln(e.getUTCDate(),t,2)}function APe(e,t){return ln(e.getUTCHours(),t,2)}function TPe(e,t){return ln(e.getUTCHours()%12||12,t,2)}function OPe(e,t){return ln(1+Y1.count(Nc(e),e),t,3)}function sH(e,t){return ln(e.getUTCMilliseconds(),t,3)}function RPe(e,t){return sH(e,t)+"000"}function MPe(e,t){return ln(e.getUTCMonth()+1,t,2)}function DPe(e,t){return ln(e.getUTCMinutes(),t,2)}function IPe(e,t){return ln(e.getUTCSeconds(),t,2)}function $Pe(e){var t=e.getUTCDay();return t===0?7:t}function LPe(e,t){return ln(Z1.count(Nc(e)-1,e),t,2)}function iH(e){var t=e.getUTCDay();return t>=4||t===0?_m(e):_m.ceil(e)}function FPe(e,t){return e=iH(e),ln(_m.count(Nc(e),e)+(Nc(e).getUTCDay()===4),t,2)}function UPe(e){return e.getUTCDay()}function BPe(e,t){return ln(j_.count(Nc(e)-1,e),t,2)}function zPe(e,t){return ln(e.getUTCFullYear()%100,t,2)}function VPe(e,t){return e=iH(e),ln(e.getUTCFullYear()%100,t,2)}function qPe(e,t){return ln(e.getUTCFullYear()%1e4,t,4)}function WPe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?_m(e):_m.ceil(e),ln(e.getUTCFullYear()%1e4,t,4)}function HPe(){return"+0000"}function sT(){return"%"}function iT(e){return+e}function aT(e){return Math.floor(+e/1e3)}var Vf,aH,oH;GPe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function GPe(e){return Vf=G6e(e),aH=Vf.format,Vf.parse,oH=Vf.utcFormat,Vf.utcParse,Vf}function YPe(e){return new Date(e)}function KPe(e){return e instanceof Date?+e:+new Date(+e)}function jC(e,t,r,n,i,a,o,l,c,d){var u=cC(),h=u.invert,f=u.domain,p=d(".%L"),x=d(":%S"),g=d("%I:%M"),v=d("%I %p"),_=d("%a %d"),w=d("%b %d"),b=d("%B"),N=d("%Y");function S(k){return(c(k)<k?p:l(k)<k?x:o(k)<k?g:a(k)<k?v:n(k)<k?i(k)<k?_:w:r(k)<k?b:N)(k)}return u.invert=function(k){return new Date(h(k))},u.domain=function(k){return arguments.length?f(Array.from(k,KPe)):f().map(YPe)},u.ticks=function(k){var O=f();return e(O[0],O[O.length-1],k==null?10:k)},u.tickFormat=function(k,O){return O==null?S:d(O)},u.nice=function(k){var O=f();return(!k||typeof k.range!="function")&&(k=t(O[0],O[O.length-1],k==null?10:k)),k?f(GW(O,k)):u},u.copy=function(){return Xv(u,jC(e,t,r,n,i,a,o,l,c,d))},u}function ZPe(){return so.apply(jC(W6e,H6e,jc,wC,K1,Jv,yC,vC,vu,aH).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function XPe(){return so.apply(jC(V6e,q6e,Nc,bC,Z1,Y1,_C,xC,vu,oH).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function X1(){var e=0,t=1,r,n,i,a,o=Oi,l=!1,c;function d(h){return h==null||isNaN(h=+h)?c:o(i===0?.5:(h=(a(h)-r)*i,l?Math.max(0,Math.min(1,h)):h))}d.domain=function(h){return arguments.length?([e,t]=h,r=a(e=+e),n=a(t=+t),i=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(h){return arguments.length?(l=!!h,d):l},d.interpolator=function(h){return arguments.length?(o=h,d):o};function u(h){return function(f){var p,x;return arguments.length?([p,x]=f,o=h(p,x),d):[o(0),o(1)]}}return d.range=u(gp),d.rangeRound=u(lC),d.unknown=function(h){return arguments.length?(c=h,d):c},function(h){return a=h,r=h(e),n=h(t),i=r===n?0:1/(n-r),d}}function zd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function lH(){var e=Bd(X1()(Oi));return e.copy=function(){return zd(e,lH())},Oc.apply(e,arguments)}function cH(){var e=fC(X1()).domain([1,10]);return e.copy=function(){return zd(e,cH()).base(e.base())},Oc.apply(e,arguments)}function dH(){var e=hC(X1());return e.copy=function(){return zd(e,dH()).constant(e.constant())},Oc.apply(e,arguments)}function NC(){var e=mC(X1());return e.copy=function(){return zd(e,NC()).exponent(e.exponent())},Oc.apply(e,arguments)}function JPe(){return NC.apply(null,arguments).exponent(.5)}function uH(){var e=[],t=Oi;function r(n){if(n!=null&&!isNaN(n=+n))return t((Kv(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(wd),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>LCe(e,a/n))},r.copy=function(){return uH(t).domain(e)},Oc.apply(r,arguments)}function J1(){var e=0,t=.5,r=1,n=1,i,a,o,l,c,d=Oi,u,h=!1,f;function p(g){return isNaN(g=+g)?f:(g=.5+((g=+u(g))-a)*(n*g<n*a?l:c),d(h?Math.max(0,Math.min(1,g)):g))}p.domain=function(g){return arguments.length?([e,t,r]=g,i=u(e=+e),a=u(t=+t),o=u(r=+r),l=i===a?0:.5/(a-i),c=a===o?0:.5/(o-a),n=a<i?-1:1,p):[e,t,r]},p.clamp=function(g){return arguments.length?(h=!!g,p):h},p.interpolator=function(g){return arguments.length?(d=g,p):d};function x(g){return function(v){var _,w,b;return arguments.length?([_,w,b]=v,d=d6e(g,[_,w,b]),p):[d(0),d(.5),d(1)]}}return p.range=x(gp),p.rangeRound=x(lC),p.unknown=function(g){return arguments.length?(f=g,p):f},function(g){return u=g,i=g(e),a=g(t),o=g(r),l=i===a?0:.5/(a-i),c=a===o?0:.5/(o-a),n=a<i?-1:1,p}}function fH(){var e=Bd(J1()(Oi));return e.copy=function(){return zd(e,fH())},Oc.apply(e,arguments)}function hH(){var e=fC(J1()).domain([.1,1,10]);return e.copy=function(){return zd(e,hH()).base(e.base())},Oc.apply(e,arguments)}function mH(){var e=hC(J1());return e.copy=function(){return zd(e,mH()).constant(e.constant())},Oc.apply(e,arguments)}function SC(){var e=mC(J1());return e.copy=function(){return zd(e,SC()).exponent(e.exponent())},Oc.apply(e,arguments)}function QPe(){return SC.apply(null,arguments).exponent(.5)}const oT=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:$g,scaleDiverging:fH,scaleDivergingLog:hH,scaleDivergingPow:SC,scaleDivergingSqrt:QPe,scaleDivergingSymlog:mH,scaleIdentity:HW,scaleImplicit:GS,scaleLinear:__,scaleLog:YW,scaleOrdinal:iC,scalePoint:F0,scalePow:pC,scaleQuantile:XW,scaleQuantize:JW,scaleRadial:ZW,scaleSequential:lH,scaleSequentialLog:cH,scaleSequentialPow:NC,scaleSequentialQuantile:uH,scaleSequentialSqrt:JPe,scaleSequentialSymlog:dH,scaleSqrt:R6e,scaleSymlog:KW,scaleThreshold:QW,scaleTime:ZPe,scaleUtc:XPe,tickFormat:WW},Symbol.toStringTag,{value:"Module"}));var e7e=ap;function t7e(e,t,r){for(var n=-1,i=e.length;++n<i;){var a=e[n],o=t(a);if(o!=null&&(l===void 0?o===o&&!e7e(o):r(o,l)))var l=o,c=a}return c}var pH=t7e;function r7e(e,t){return e>t}var n7e=r7e,s7e=pH,i7e=n7e,a7e=pp;function o7e(e){return e&&e.length?s7e(e,a7e,i7e):void 0}var l7e=o7e;const cd=rn(l7e);function c7e(e,t){return e<t}var d7e=c7e,u7e=pH,f7e=d7e,h7e=pp;function m7e(e){return e&&e.length?u7e(e,h7e,f7e):void 0}var p7e=m7e;const Q1=rn(p7e);var g7e=F4,v7e=Ud,x7e=jW,y7e=ha;function _7e(e,t){var r=y7e(e)?g7e:x7e;return r(e,v7e(t))}var w7e=_7e,b7e=wW,j7e=w7e;function N7e(e,t){return b7e(j7e(e,t),1)}var S7e=N7e;const k7e=rn(S7e);var E7e=eC;function C7e(e,t){return E7e(e,t)}var P7e=C7e;const wm=rn(P7e);var vp=1e9,A7e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},EC,Gn=!0,to="[DecimalError] ",Mu=to+"Invalid argument: ",kC=to+"Exponent out of range: ",xp=Math.floor,nu=Math.pow,T7e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,wa,zs=1e7,Fn=7,gH=9007199254740991,N_=xp(gH/Fn),Vt={};Vt.absoluteValue=Vt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Vt.comparedTo=Vt.cmp=function(e){var t,r,n,i,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(n=a.d.length,i=e.d.length,t=0,r=n<i?n:i;t<r;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};Vt.decimalPlaces=Vt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Fn;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Vt.dividedBy=Vt.div=function(e){return uc(this,new this.constructor(e))};Vt.dividedToIntegerBy=Vt.idiv=function(e){var t=this,r=t.constructor;return kn(uc(t,new r(e),0,1),r.precision)};Vt.equals=Vt.eq=function(e){return!this.cmp(e)};Vt.exponent=function(){return bs(this)};Vt.greaterThan=Vt.gt=function(e){return this.cmp(e)>0};Vt.greaterThanOrEqualTo=Vt.gte=function(e){return this.cmp(e)>=0};Vt.isInteger=Vt.isint=function(){return this.e>this.d.length-2};Vt.isNegative=Vt.isneg=function(){return this.s<0};Vt.isPositive=Vt.ispos=function(){return this.s>0};Vt.isZero=function(){return this.s===0};Vt.lessThan=Vt.lt=function(e){return this.cmp(e)<0};Vt.lessThanOrEqualTo=Vt.lte=function(e){return this.cmp(e)<1};Vt.logarithm=Vt.log=function(e){var t,r=this,n=r.constructor,i=n.precision,a=i+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(wa))throw Error(to+"NaN");if(r.s<1)throw Error(to+(r.s?"NaN":"-Infinity"));return r.eq(wa)?new n(0):(Gn=!1,t=uc(zg(r,a),zg(e,a),a),Gn=!0,kn(t,i))};Vt.minus=Vt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?yH(t,e):vH(t,(e.s=-e.s,e))};Vt.modulo=Vt.mod=function(e){var t,r=this,n=r.constructor,i=n.precision;if(e=new n(e),!e.s)throw Error(to+"NaN");return r.s?(Gn=!1,t=uc(r,e,0,1).times(e),Gn=!0,r.minus(t)):kn(new n(r),i)};Vt.naturalExponential=Vt.exp=function(){return xH(this)};Vt.naturalLogarithm=Vt.ln=function(){return zg(this)};Vt.negated=Vt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Vt.plus=Vt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?vH(t,e):yH(t,(e.s=-e.s,e))};Vt.precision=Vt.sd=function(e){var t,r,n,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Mu+e);if(t=bs(i)+1,n=i.d.length-1,r=n*Fn+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Vt.squareRoot=Vt.sqrt=function(){var e,t,r,n,i,a,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(to+"NaN")}for(e=bs(l),Gn=!1,i=Math.sqrt(+l),i==0||i==1/0?(t=ml(l.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=xp((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(i.toString()),r=c.precision,i=o=r+3;;)if(a=n,n=a.plus(uc(l,a,o+2)).times(.5),ml(a.d).slice(0,o)===(t=ml(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(kn(a,r+1,0),a.times(a).eq(l)){n=a;break}}else if(t!="9999")break;o+=4}return Gn=!0,kn(n,r)};Vt.times=Vt.mul=function(e){var t,r,n,i,a,o,l,c,d,u=this,h=u.constructor,f=u.d,p=(e=new h(e)).d;if(!u.s||!e.s)return new h(0);for(e.s*=u.s,r=u.e+e.e,c=f.length,d=p.length,c<d&&(a=f,f=p,p=a,o=c,c=d,d=o),a=[],o=c+d,n=o;n--;)a.push(0);for(n=d;--n>=0;){for(t=0,i=c+n;i>n;)l=a[i]+p[n]*f[i-n-1]+t,a[i--]=l%zs|0,t=l/zs|0;a[i]=(a[i]+t)%zs|0}for(;!a[--o];)a.pop();return t?++r:a.shift(),e.d=a,e.e=r,Gn?kn(e,h.precision):e};Vt.toDecimalPlaces=Vt.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Sl(e,0,vp),t===void 0?t=n.rounding:Sl(t,0,8),kn(r,e+bs(r)+1,t))};Vt.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=tf(n,!0):(Sl(e,0,vp),t===void 0?t=i.rounding:Sl(t,0,8),n=kn(new i(n),e+1,t),r=tf(n,!0,e+1)),r};Vt.toFixed=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?tf(i):(Sl(e,0,vp),t===void 0?t=a.rounding:Sl(t,0,8),n=kn(new a(i),e+bs(i)+1,t),r=tf(n.abs(),!1,e+bs(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Vt.toInteger=Vt.toint=function(){var e=this,t=e.constructor;return kn(new t(e),bs(e)+1,t.rounding)};Vt.toNumber=function(){return+this};Vt.toPower=Vt.pow=function(e){var t,r,n,i,a,o,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(wa);if(l=new c(l),!l.s){if(e.s<1)throw Error(to+"Infinity");return l}if(l.eq(wa))return l;if(n=c.precision,e.eq(wa))return kn(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,a=l.s,o){if((r=u<0?-u:u)<=gH){for(i=new c(wa),t=Math.ceil(n/Fn+4),Gn=!1;r%2&&(i=i.times(l),cT(i.d,t)),r=xp(r/2),r!==0;)l=l.times(l),cT(l.d,t);return Gn=!0,e.s<0?new c(wa).div(i):kn(i,n)}}else if(a<0)throw Error(to+"NaN");return a=a<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Gn=!1,i=e.times(zg(l,n+d)),Gn=!0,i=xH(i),i.s=a,i};Vt.toPrecision=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?(r=bs(i),n=tf(i,r<=a.toExpNeg||r>=a.toExpPos)):(Sl(e,1,vp),t===void 0?t=a.rounding:Sl(t,0,8),i=kn(new a(i),e,t),r=bs(i),n=tf(i,e<=r||r<=a.toExpNeg,e)),n};Vt.toSignificantDigits=Vt.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Sl(e,1,vp),t===void 0?t=n.rounding:Sl(t,0,8)),kn(new n(r),e,t)};Vt.toString=Vt.valueOf=Vt.val=Vt.toJSON=Vt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=bs(e),r=e.constructor;return tf(e,t<=r.toExpNeg||t>=r.toExpPos)};function vH(e,t){var r,n,i,a,o,l,c,d,u=e.constructor,h=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Gn?kn(t,h):t;if(c=e.d,d=t.d,o=e.e,i=t.e,c=c.slice(),a=o-i,a){for(a<0?(n=c,a=-a,l=d.length):(n=d,i=o,l=c.length),o=Math.ceil(h/Fn),l=o>l?o+1:l+1,a>l&&(a=l,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(l=c.length,a=d.length,l-a<0&&(a=l,n=d,d=c,c=n),r=0;a;)r=(c[--a]=c[a]+d[a]+r)/zs|0,c[a]%=zs;for(r&&(c.unshift(r),++i),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=i,Gn?kn(t,h):t}function Sl(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Mu+e)}function ml(e){var t,r,n,i=e.length-1,a="",o=e[0];if(i>0){for(a+=o,t=1;t<i;t++)n=e[t]+"",r=Fn-n.length,r&&(a+=Kc(r)),a+=n;o=e[t],n=o+"",r=Fn-n.length,r&&(a+=Kc(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}var uc=function(){function e(n,i){var a,o=0,l=n.length;for(n=n.slice();l--;)a=n[l]*i+o,n[l]=a%zs|0,o=a/zs|0;return o&&n.unshift(o),n}function t(n,i,a,o){var l,c;if(a!=o)c=a>o?1:-1;else for(l=c=0;l<a;l++)if(n[l]!=i[l]){c=n[l]>i[l]?1:-1;break}return c}function r(n,i,a){for(var o=0;a--;)n[a]-=o,o=n[a]<i[a]?1:0,n[a]=o*zs+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,o){var l,c,d,u,h,f,p,x,g,v,_,w,b,N,S,k,O,A,T=n.constructor,$=n.s==i.s?1:-1,R=n.d,F=i.d;if(!n.s)return new T(n);if(!i.s)throw Error(to+"Division by zero");for(c=n.e-i.e,O=F.length,S=R.length,p=new T($),x=p.d=[],d=0;F[d]==(R[d]||0);)++d;if(F[d]>(R[d]||0)&&--c,a==null?w=a=T.precision:o?w=a+(bs(n)-bs(i))+1:w=a,w<0)return new T(0);if(w=w/Fn+2|0,d=0,O==1)for(u=0,F=F[0],w++;(d<S||u)&&w--;d++)b=u*zs+(R[d]||0),x[d]=b/F|0,u=b%F|0;else{for(u=zs/(F[0]+1)|0,u>1&&(F=e(F,u),R=e(R,u),O=F.length,S=R.length),N=O,g=R.slice(0,O),v=g.length;v<O;)g[v++]=0;A=F.slice(),A.unshift(0),k=F[0],F[1]>=zs/2&&++k;do u=0,l=t(F,g,O,v),l<0?(_=g[0],O!=v&&(_=_*zs+(g[1]||0)),u=_/k|0,u>1?(u>=zs&&(u=zs-1),h=e(F,u),f=h.length,v=g.length,l=t(h,g,f,v),l==1&&(u--,r(h,O<f?A:F,f))):(u==0&&(l=u=1),h=F.slice()),f=h.length,f<v&&h.unshift(0),r(g,h,v),l==-1&&(v=g.length,l=t(F,g,O,v),l<1&&(u++,r(g,O<v?A:F,v))),v=g.length):l===0&&(u++,g=[0]),x[d++]=u,l&&g[0]?g[v++]=R[N]||0:(g=[R[N]],v=1);while((N++<S||g[0]!==void 0)&&w--)}return x[0]||x.shift(),p.e=c,kn(p,o?a+bs(p)+1:a)}}();function xH(e,t){var r,n,i,a,o,l,c=0,d=0,u=e.constructor,h=u.precision;if(bs(e)>16)throw Error(kC+bs(e));if(!e.s)return new u(wa);for(t==null?(Gn=!1,l=h):l=t,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(n=Math.log(nu(2,d))/Math.LN10*2+5|0,l+=n,r=i=a=new u(wa),u.precision=l;;){if(i=kn(i.times(e),l),r=r.times(++c),o=a.plus(uc(i,r,l)),ml(o.d).slice(0,l)===ml(a.d).slice(0,l)){for(;d--;)a=kn(a.times(a),l);return u.precision=h,t==null?(Gn=!0,kn(a,h)):a}a=o}}function bs(e){for(var t=e.e*Fn,r=e.d[0];r>=10;r/=10)t++;return t}function cN(e,t,r){if(t>e.LN10.sd())throw Gn=!0,r&&(e.precision=r),Error(to+"LN10 precision limit exceeded");return kn(new e(e.LN10),t)}function Kc(e){for(var t="";e--;)t+="0";return t}function zg(e,t){var r,n,i,a,o,l,c,d,u,h=1,f=10,p=e,x=p.d,g=p.constructor,v=g.precision;if(p.s<1)throw Error(to+(p.s?"NaN":"-Infinity"));if(p.eq(wa))return new g(0);if(t==null?(Gn=!1,d=v):d=t,p.eq(10))return t==null&&(Gn=!0),cN(g,d);if(d+=f,g.precision=d,r=ml(x),n=r.charAt(0),a=bs(p),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=ml(p.d),n=r.charAt(0),h++;a=bs(p),n>1?(p=new g("0."+r),a++):p=new g(n+"."+r.slice(1))}else return c=cN(g,d+2,v).times(a+""),p=zg(new g(n+"."+r.slice(1)),d-f).plus(c),g.precision=v,t==null?(Gn=!0,kn(p,v)):p;for(l=o=p=uc(p.minus(wa),p.plus(wa),d),u=kn(p.times(p),d),i=3;;){if(o=kn(o.times(u),d),c=l.plus(uc(o,new g(i),d)),ml(c.d).slice(0,d)===ml(l.d).slice(0,d))return l=l.times(2),a!==0&&(l=l.plus(cN(g,d+2,v).times(a+""))),l=uc(l,new g(h),d),g.precision=v,t==null?(Gn=!0,kn(l,v)):l;l=c,i+=2}}function lT(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(n,i),t){if(i-=n,r=r-n-1,e.e=xp(r/Fn),e.d=[],n=(r+1)%Fn,r<0&&(n+=Fn),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=Fn;n<i;)e.d.push(+t.slice(n,n+=Fn));t=t.slice(n),n=Fn-t.length}else n-=i;for(;n--;)t+="0";if(e.d.push(+t),Gn&&(e.e>N_||e.e<-N_))throw Error(kC+r)}else e.s=0,e.e=0,e.d=[0];return e}function kn(e,t,r){var n,i,a,o,l,c,d,u,h=e.d;for(o=1,a=h[0];a>=10;a/=10)o++;if(n=t-o,n<0)n+=Fn,i=t,d=h[u=0];else{if(u=Math.ceil((n+1)/Fn),a=h.length,u>=a)return e;for(d=a=h[u],o=1;a>=10;a/=10)o++;n%=Fn,i=n-Fn+o}if(r!==void 0&&(a=nu(10,o-i-1),l=d/a%10|0,c=t<0||h[u+1]!==void 0||d%a,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?i>0?d/nu(10,o-i):0:h[u-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return c?(a=bs(e),h.length=1,t=t-a-1,h[0]=nu(10,(Fn-t%Fn)%Fn),e.e=xp(-t/Fn)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(n==0?(h.length=u,a=1,u--):(h.length=u+1,a=nu(10,Fn-n),h[u]=i>0?(d/nu(10,o-i)%nu(10,i)|0)*a:0),c)for(;;)if(u==0){(h[0]+=a)==zs&&(h[0]=1,++e.e);break}else{if(h[u]+=a,h[u]!=zs)break;h[u--]=0,a=1}for(n=h.length;h[--n]===0;)h.pop();if(Gn&&(e.e>N_||e.e<-N_))throw Error(kC+bs(e));return e}function yH(e,t){var r,n,i,a,o,l,c,d,u,h,f=e.constructor,p=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),Gn?kn(t,p):t;if(c=e.d,h=t.d,n=t.e,d=e.e,c=c.slice(),o=d-n,o){for(u=o<0,u?(r=c,o=-o,l=h.length):(r=h,n=d,l=c.length),i=Math.max(Math.ceil(p/Fn),l)+2,o>i&&(o=i,r.length=1),r.reverse(),i=o;i--;)r.push(0);r.reverse()}else{for(i=c.length,l=h.length,u=i<l,u&&(l=i),i=0;i<l;i++)if(c[i]!=h[i]){u=c[i]<h[i];break}o=0}for(u&&(r=c,c=h,h=r,t.s=-t.s),l=c.length,i=h.length-l;i>0;--i)c[l++]=0;for(i=h.length;i>o;){if(c[--i]<h[i]){for(a=i;a&&c[--a]===0;)c[a]=zs-1;--c[a],c[i]+=zs}c[i]-=h[i]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Gn?kn(t,p):t):new f(0)}function tf(e,t,r){var n,i=bs(e),a=ml(e.d),o=a.length;return t?(r&&(n=r-o)>0?a=a.charAt(0)+"."+a.slice(1)+Kc(n):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+Kc(-i-1)+a,r&&(n=r-o)>0&&(a+=Kc(n))):i>=o?(a+=Kc(i+1-o),r&&(n=r-i-1)>0&&(a=a+"."+Kc(n))):((n=i+1)<o&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(a+="."),a+=Kc(n))),e.s<0?"-"+a:a}function cT(e,t){if(e.length>t)return e.length=t,!0}function _H(e){var t,r,n;function i(a){var o=this;if(!(o instanceof i))return new i(a);if(o.constructor=i,a instanceof i){o.s=a.s,o.e=a.e,o.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Mu+a);if(a>0)o.s=1;else if(a<0)a=-a,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(a===~~a&&a<1e7){o.e=0,o.d=[a];return}return lT(o,a.toString())}else if(typeof a!="string")throw Error(Mu+a);if(a.charCodeAt(0)===45?(a=a.slice(1),o.s=-1):o.s=1,T7e.test(a))lT(o,a);else throw Error(Mu+a)}if(i.prototype=Vt,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=_H,i.config=i.set=O7e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function O7e(e){if(!e||typeof e!="object")throw Error(to+"Object expected");var t,r,n,i=["precision",1,vp,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((n=e[r=i[t]])!==void 0)if(xp(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(Mu+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Mu+r+": "+n);return this}var EC=_H(A7e);wa=new EC(1);const _n=EC;function R7e(e){return $7e(e)||I7e(e)||D7e(e)||M7e()}function M7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D7e(e,t){if(e){if(typeof e=="string")return XS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XS(e,t)}}function I7e(e){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function $7e(e){if(Array.isArray(e))return XS(e)}function XS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var L7e=function(t){return t},wH={"@@functional/placeholder":!0},bH=function(t){return t===wH},dT=function(t){return function r(){return arguments.length===0||arguments.length===1&&bH(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},F7e=function e(t,r){return t===1?r:dT(function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];var o=i.filter(function(l){return l!==wH}).length;return o>=t?r.apply(void 0,i):e(t-o,dT(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=i.map(function(h){return bH(h)?c.shift():h});return r.apply(void 0,R7e(u).concat(c))}))})},eb=function(t){return F7e(t.length,t)},JS=function(t,r){for(var n=[],i=t;i<r;++i)n[i-t]=i;return n},U7e=eb(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),B7e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return L7e;var i=r.reverse(),a=i[0],o=i.slice(1);return function(){return o.reduce(function(l,c){return c(l)},a.apply(void 0,arguments))}},QS=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},jH=function(t){var r=null,n=null;return function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r&&a.every(function(l,c){return l===r[c]})||(r=a,n=t.apply(void 0,a)),n}};function z7e(e){var t;return e===0?t=1:t=Math.floor(new _n(e).abs().log(10).toNumber())+1,t}function V7e(e,t,r){for(var n=new _n(e),i=0,a=[];n.lt(t)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}var q7e=eb(function(e,t,r){var n=+e,i=+t;return n+r*(i-n)}),W7e=eb(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),H7e=eb(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const tb={rangeStep:V7e,getDigitCount:z7e,interpolateNumber:q7e,uninterpolateNumber:W7e,uninterpolateTruncation:H7e};function e5(e){return K7e(e)||Y7e(e)||NH(e)||G7e()}function G7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y7e(e){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function K7e(e){if(Array.isArray(e))return t5(e)}function Vg(e,t){return J7e(e)||X7e(e,t)||NH(e,t)||Z7e()}function Z7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NH(e,t){if(e){if(typeof e=="string")return t5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t5(e,t)}}function t5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function X7e(e,t){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),l;!(n=(l=o.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){i=!0,a=c}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return r}}function J7e(e){if(Array.isArray(e))return e}function SH(e){var t=Vg(e,2),r=t[0],n=t[1],i=r,a=n;return r>n&&(i=n,a=r),[i,a]}function kH(e,t,r){if(e.lte(0))return new _n(0);var n=tb.getDigitCount(e.toNumber()),i=new _n(10).pow(n),a=e.div(i),o=n!==1?.05:.1,l=new _n(Math.ceil(a.div(o).toNumber())).add(r).mul(o),c=l.mul(i);return t?c:new _n(Math.ceil(c))}function Q7e(e,t,r){var n=1,i=new _n(e);if(!i.isint()&&r){var a=Math.abs(e);a<1?(n=new _n(10).pow(tb.getDigitCount(e)-1),i=new _n(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new _n(Math.floor(e)))}else e===0?i=new _n(Math.floor((t-1)/2)):r||(i=new _n(Math.floor(e)));var o=Math.floor((t-1)/2),l=B7e(U7e(function(c){return i.add(new _n(c-o).mul(n)).toNumber()}),JS);return l(0,t)}function EH(e,t,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new _n(0),tickMin:new _n(0),tickMax:new _n(0)};var a=kH(new _n(t).sub(e).div(r-1),n,i),o;e<=0&&t>=0?o=new _n(0):(o=new _n(e).add(t).div(2),o=o.sub(new _n(o).mod(a)));var l=Math.ceil(o.sub(e).div(a).toNumber()),c=Math.ceil(new _n(t).sub(o).div(a).toNumber()),d=l+c+1;return d>r?EH(e,t,r,n,i+1):(d<r&&(c=t>0?c+(r-d):c,l=t>0?l:l+(r-d)),{step:a,tickMin:o.sub(new _n(l).mul(a)),tickMax:o.add(new _n(c).mul(a))})}function eAe(e){var t=Vg(e,2),r=t[0],n=t[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),l=SH([r,n]),c=Vg(l,2),d=c[0],u=c[1];if(d===-1/0||u===1/0){var h=u===1/0?[d].concat(e5(JS(0,i-1).map(function(){return 1/0}))):[].concat(e5(JS(0,i-1).map(function(){return-1/0})),[u]);return r>n?QS(h):h}if(d===u)return Q7e(d,i,a);var f=EH(d,u,o,a),p=f.step,x=f.tickMin,g=f.tickMax,v=tb.rangeStep(x,g.add(new _n(.1).mul(p)),p);return r>n?QS(v):v}function tAe(e,t){var r=Vg(e,2),n=r[0],i=r[1],a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=SH([n,i]),l=Vg(o,2),c=l[0],d=l[1];if(c===-1/0||d===1/0)return[n,i];if(c===d)return[c];var u=Math.max(t,2),h=kH(new _n(d).sub(c).div(u-1),a,0),f=[].concat(e5(tb.rangeStep(new _n(c),new _n(d).sub(new _n(.99).mul(h)),h)),[d]);return n>i?QS(f):f}var rAe=jH(eAe),nAe=jH(tAe),sAe="Invariant failed";function rf(e,t){throw new Error(sAe)}var iAe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function bm(e){"@babel/helpers - typeof";return bm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bm(e)}function S_(){return S_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S_.apply(this,arguments)}function aAe(e,t){return dAe(e)||cAe(e,t)||lAe(e,t)||oAe()}function oAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lAe(e,t){if(e){if(typeof e=="string")return uT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uT(e,t)}}function uT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cAe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,d=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,i=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw i}}return l}}function dAe(e){if(Array.isArray(e))return e}function uAe(e,t){if(e==null)return{};var r=fAe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function fAe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function hAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mAe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AH(n.key),n)}}function pAe(e,t,r){return t&&mAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function gAe(e,t,r){return t=k_(t),vAe(e,CH()?Reflect.construct(t,r||[],k_(e).constructor):t.apply(e,r))}function vAe(e,t){if(t&&(bm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xAe(e)}function xAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(CH=function(){return!!e})()}function k_(e){return k_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},k_(e)}function yAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r5(e,t)}function r5(e,t){return r5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},r5(e,t)}function PH(e,t,r){return t=AH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AH(e){var t=_Ae(e,"string");return bm(t)=="symbol"?t:t+""}function _Ae(e,t){if(bm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qv=function(e){function t(){return hAe(this,t),gAe(this,t,arguments)}return yAe(t,e),pAe(t,[{key:"render",value:function(){var n=this.props,i=n.offset,a=n.layout,o=n.width,l=n.dataKey,c=n.data,d=n.dataPointFormatter,u=n.xAxis,h=n.yAxis,f=uAe(n,iAe),p=Pr(f,!1);this.props.direction==="x"&&u.type!=="number"&&rf();var x=c.map(function(g){var v=d(g,l),_=v.x,w=v.y,b=v.value,N=v.errorVal;if(!N)return null;var S=[],k,O;if(Array.isArray(N)){var A=aAe(N,2);k=A[0],O=A[1]}else k=O=N;if(a==="vertical"){var T=u.scale,$=w+i,R=$+o,F=$-o,D=T(b-k),B=T(b+O);S.push({x1:B,y1:R,x2:B,y2:F}),S.push({x1:D,y1:$,x2:B,y2:$}),S.push({x1:D,y1:R,x2:D,y2:F})}else if(a==="horizontal"){var U=h.scale,V=_+i,Y=V-o,z=V+o,K=U(b-k),Z=U(b+O);S.push({x1:Y,y1:Z,x2:z,y2:Z}),S.push({x1:V,y1:K,x2:V,y2:Z}),S.push({x1:Y,y1:K,x2:z,y2:K})}return Q.createElement(Rn,S_({className:"recharts-errorBar",key:"bar-".concat(S.map(function(G){return"".concat(G.x1,"-").concat(G.x2,"-").concat(G.y1,"-").concat(G.y2)}))},p),S.map(function(G){return Q.createElement("line",S_({},G,{key:"line-".concat(G.x1,"-").concat(G.x2,"-").concat(G.y1,"-").concat(G.y2)}))}))});return Q.createElement(Rn,{className:"recharts-errorBars"},x)}}])}(Q.Component);PH(Qv,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});PH(Qv,"displayName","ErrorBar");function qg(e){"@babel/helpers - typeof";return qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qg(e)}function fT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Kd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fT(Object(r),!0).forEach(function(n){wAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wAe(e,t,r){return t=bAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bAe(e){var t=jAe(e,"string");return qg(t)=="symbol"?t:t+""}function jAe(e,t){if(qg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TH=function(t){var r=t.children,n=t.formattedGraphicalItems,i=t.legendWidth,a=t.legendContent,o=ya(r,Ou);if(!o)return null;var l=Ou.defaultProps,c=l!==void 0?Kd(Kd({},l),o.props):{},d;return o.props&&o.props.payload?d=o.props&&o.props.payload:a==="children"?d=(n||[]).reduce(function(u,h){var f=h.item,p=h.props,x=p.sectors||p.data||[];return u.concat(x.map(function(g){return{type:o.props.iconType||f.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):d=(n||[]).map(function(u){var h=u.item,f=h.type.defaultProps,p=f!==void 0?Kd(Kd({},f),h.props):{},x=p.dataKey,g=p.name,v=p.legendType,_=p.hide;return{inactive:_,dataKey:x,type:c.iconType||v||"square",color:CC(h),value:g||x,payload:p}}),Kd(Kd(Kd({},c),Ou.getWithHeight(o,i)),{},{payload:d,item:o})};function Wg(e){"@babel/helpers - typeof";return Wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wg(e)}function hT(e){return EAe(e)||kAe(e)||SAe(e)||NAe()}function NAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SAe(e,t){if(e){if(typeof e=="string")return n5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n5(e,t)}}function kAe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EAe(e){if(Array.isArray(e))return n5(e)}function n5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function rs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mT(Object(r),!0).forEach(function(n){Ih(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ih(e,t,r){return t=CAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CAe(e){var t=PAe(e,"string");return Wg(t)=="symbol"?t:t+""}function PAe(e,t){if(Wg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ii(e,t,r){return Or(e)||Or(t)?r:Ms(t)?Za(e,t,r):kr(t)?t(e):r}function U0(e,t,r,n){var i=k7e(e,function(l){return Ii(l,t)});if(r==="number"){var a=i.filter(function(l){return _t(l)||parseFloat(l)});return a.length?[Q1(a),cd(a)]:[1/0,-1/0]}var o=n?i.filter(function(l){return!Or(l)}):i;return o.map(function(l){return Ms(l)||l instanceof Date?l:""})}var AAe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=-1,l=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var c=a.range,d=0;d<l;d++){var u=d>0?i[d-1].coordinate:i[l-1].coordinate,h=i[d].coordinate,f=d>=l-1?i[0].coordinate:i[d+1].coordinate,p=void 0;if(Ao(h-u)!==Ao(f-h)){var x=[];if(Ao(f-h)===Ao(c[1]-c[0])){p=f;var g=h+c[1]-c[0];x[0]=Math.min(g,(g+u)/2),x[1]=Math.max(g,(g+u)/2)}else{p=u;var v=f+c[1]-c[0];x[0]=Math.min(h,(v+h)/2),x[1]=Math.max(h,(v+h)/2)}var _=[Math.min(h,(p+h)/2),Math.max(h,(p+h)/2)];if(t>_[0]&&t<=_[1]||t>=x[0]&&t<=x[1]){o=i[d].index;break}}else{var w=Math.min(u,f),b=Math.max(u,f);if(t>(w+h)/2&&t<=(b+h)/2){o=i[d].index;break}}}else for(var N=0;N<l;N++)if(N===0&&t<=(n[N].coordinate+n[N+1].coordinate)/2||N>0&&N<l-1&&t>(n[N].coordinate+n[N-1].coordinate)/2&&t<=(n[N].coordinate+n[N+1].coordinate)/2||N===l-1&&t>(n[N].coordinate+n[N-1].coordinate)/2){o=n[N].index;break}return o},CC=function(t){var r,n=t,i=n.type.displayName,a=(r=t.type)!==null&&r!==void 0&&r.defaultProps?rs(rs({},t.type.defaultProps),t.props):t.props,o=a.stroke,l=a.fill,c;switch(i){case"Line":c=o;break;case"Area":case"Radar":c=o&&o!=="none"?o:l;break;default:c=l;break}return c},TAe=function(t){var r=t.barSize,n=t.totalSize,i=t.stackGroups,a=i===void 0?{}:i;if(!a)return{};for(var o={},l=Object.keys(a),c=0,d=l.length;c<d;c++)for(var u=a[l[c]].stackGroups,h=Object.keys(u),f=0,p=h.length;f<p;f++){var x=u[h[f]],g=x.items,v=x.cateAxisId,_=g.filter(function(O){return cc(O.type).indexOf("Bar")>=0});if(_&&_.length){var w=_[0].type.defaultProps,b=w!==void 0?rs(rs({},w),_[0].props):_[0].props,N=b.barSize,S=b[v];o[S]||(o[S]=[]);var k=Or(N)?r:N;o[S].push({item:_[0],stackList:_.slice(1),barSize:Or(k)?void 0:ef(k,n,0)})}}return o},OAe=function(t){var r=t.barGap,n=t.barCategoryGap,i=t.bandSize,a=t.sizeList,o=a===void 0?[]:a,l=t.maxBarSize,c=o.length;if(c<1)return null;var d=ef(r,i,0,!0),u,h=[];if(o[0].barSize===+o[0].barSize){var f=!1,p=i/c,x=o.reduce(function(N,S){return N+S.barSize||0},0);x+=(c-1)*d,x>=i&&(x-=(c-1)*d,d=0),x>=i&&p>0&&(f=!0,p*=.9,x=c*p);var g=(i-x)/2>>0,v={offset:g-d,size:0};u=o.reduce(function(N,S){var k={item:S.item,position:{offset:v.offset+v.size+d,size:f?p:S.barSize}},O=[].concat(hT(N),[k]);return v=O[O.length-1].position,S.stackList&&S.stackList.length&&S.stackList.forEach(function(A){O.push({item:A,position:v})}),O},h)}else{var _=ef(n,i,0,!0);i-2*_-(c-1)*d<=0&&(d=0);var w=(i-2*_-(c-1)*d)/c;w>1&&(w>>=0);var b=l===+l?Math.min(w,l):w;u=o.reduce(function(N,S,k){var O=[].concat(hT(N),[{item:S.item,position:{offset:_+(w+d)*k+(w-b)/2,size:b}}]);return S.stackList&&S.stackList.length&&S.stackList.forEach(function(A){O.push({item:A,position:O[O.length-1].position})}),O},h)}return u},RAe=function(t,r,n,i){var a=n.children,o=n.width,l=n.margin,c=o-(l.left||0)-(l.right||0),d=TH({children:a,legendWidth:c});if(d){var u=i||{},h=u.width,f=u.height,p=d.align,x=d.verticalAlign,g=d.layout;if((g==="vertical"||g==="horizontal"&&x==="middle")&&p!=="center"&&_t(t[p]))return rs(rs({},t),{},Ih({},p,t[p]+(h||0)));if((g==="horizontal"||g==="vertical"&&p==="center")&&x!=="middle"&&_t(t[x]))return rs(rs({},t),{},Ih({},x,t[x]+(f||0)))}return t},MAe=function(t,r,n){return Or(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},OH=function(t,r,n,i,a){var o=r.props.children,l=Xa(o,Qv).filter(function(d){return MAe(i,a,d.props.direction)});if(l&&l.length){var c=l.map(function(d){return d.props.dataKey});return t.reduce(function(d,u){var h=Ii(u,n);if(Or(h))return d;var f=Array.isArray(h)?[Q1(h),cd(h)]:[h,h],p=c.reduce(function(x,g){var v=Ii(u,g,0),_=f[0]-Math.abs(Array.isArray(v)?v[0]:v),w=f[1]+Math.abs(Array.isArray(v)?v[1]:v);return[Math.min(_,x[0]),Math.max(w,x[1])]},[1/0,-1/0]);return[Math.min(p[0],d[0]),Math.max(p[1],d[1])]},[1/0,-1/0])}return null},DAe=function(t,r,n,i,a){var o=r.map(function(l){return OH(t,l,n,a,i)}).filter(function(l){return!Or(l)});return o&&o.length?o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},RH=function(t,r,n,i,a){var o=r.map(function(c){var d=c.props.dataKey;return n==="number"&&d&&OH(t,c,d,i)||U0(t,d,n,a)});if(n==="number")return o.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);var l={};return o.reduce(function(c,d){for(var u=0,h=d.length;u<h;u++)l[d[u]]||(l[d[u]]=!0,c.push(d[u]));return c},[])},MH=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},DH=function(t,r,n,i){if(i)return t.map(function(c){return c.coordinate});var a,o,l=t.map(function(c){return c.coordinate===r&&(a=!0),c.coordinate===n&&(o=!0),c.coordinate});return a||l.push(r),o||l.push(n),l},oc=function(t,r,n){if(!t)return null;var i=t.scale,a=t.duplicateDomain,o=t.type,l=t.range,c=t.realScaleType==="scaleBand"?i.bandwidth()/2:2,d=(r||n)&&o==="category"&&i.bandwidth?i.bandwidth()/c:0;if(d=t.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?Ao(l[0]-l[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(h){var f=a?a.indexOf(h):h;return{coordinate:i(f)+d,value:h,offset:d}});return u.filter(function(h){return!up(h.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(h,f){return{coordinate:i(h)+d,value:h,index:f,offset:d}}):i.ticks&&!n?i.ticks(t.tickCount).map(function(h){return{coordinate:i(h)+d,value:h,offset:d}}):i.domain().map(function(h,f){return{coordinate:i(h)+d,value:a?a[h]:h,index:f,offset:d}})},dN=new WeakMap,my=function(t,r){if(typeof r!="function")return t;dN.has(t)||dN.set(t,new WeakMap);var n=dN.get(t);if(n.has(r))return n.get(r);var i=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,i),i},IAe=function(t,r,n){var i=t.scale,a=t.type,o=t.layout,l=t.axisType;if(i==="auto")return o==="radial"&&l==="radiusAxis"?{scale:$g(),realScaleType:"band"}:o==="radial"&&l==="angleAxis"?{scale:__(),realScaleType:"linear"}:a==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:F0(),realScaleType:"point"}:a==="category"?{scale:$g(),realScaleType:"band"}:{scale:__(),realScaleType:"linear"};if(Qu(i)){var c="scale".concat(U1(i));return{scale:(oT[c]||F0)(),realScaleType:oT[c]?c:"point"}}return kr(i)?{scale:i}:{scale:F0(),realScaleType:"point"}},pT=1e-4,$Ae=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,i=t.range(),a=Math.min(i[0],i[1])-pT,o=Math.max(i[0],i[1])+pT,l=t(r[0]),c=t(r[n-1]);(l<a||l>o||c<a||c>o)&&t.domain([r[0],r[n-1]])}},LAe=function(t,r){if(!t)return null;for(var n=0,i=t.length;n<i;n++)if(t[n].item===r)return t[n].position;return null},FAe=function(t,r){if(!r||r.length!==2||!_t(r[0])||!_t(r[1]))return t;var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]),a=[t[0],t[1]];return(!_t(t[0])||t[0]<n)&&(a[0]=n),(!_t(t[1])||t[1]>i)&&(a[1]=i),a[0]>i&&(a[0]=i),a[1]<n&&(a[1]=n),a},UAe=function(t){var r=t.length;if(!(r<=0))for(var n=0,i=t[0].length;n<i;++n)for(var a=0,o=0,l=0;l<r;++l){var c=up(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=a,t[l][n][1]=a+c,a=t[l][n][1]):(t[l][n][0]=o,t[l][n][1]=o+c,o=t[l][n][1])}},BAe=function(t){var r=t.length;if(!(r<=0))for(var n=0,i=t[0].length;n<i;++n)for(var a=0,o=0;o<r;++o){var l=up(t[o][n][1])?t[o][n][0]:t[o][n][1];l>=0?(t[o][n][0]=a,t[o][n][1]=a+l,a=t[o][n][1]):(t[o][n][0]=0,t[o][n][1]=0)}},zAe={sign:UAe,expand:nbe,none:hm,silhouette:sbe,wiggle:ibe,positive:BAe},VAe=function(t,r,n){var i=r.map(function(l){return l.props.dataKey}),a=zAe[n],o=rbe().keys(i).value(function(l,c){return+Ii(l,c,0)}).order(CS).offset(a);return o(t)},qAe=function(t,r,n,i,a,o){if(!t)return null;var l=o?r.reverse():r,c={},d=l.reduce(function(h,f){var p,x=(p=f.type)!==null&&p!==void 0&&p.defaultProps?rs(rs({},f.type.defaultProps),f.props):f.props,g=x.stackId,v=x.hide;if(v)return h;var _=x[n],w=h[_]||{hasStack:!1,stackGroups:{}};if(Ms(g)){var b=w.stackGroups[g]||{numericAxisId:n,cateAxisId:i,items:[]};b.items.push(f),w.hasStack=!0,w.stackGroups[g]=b}else w.stackGroups[fp("_stackId_")]={numericAxisId:n,cateAxisId:i,items:[f]};return rs(rs({},h),{},Ih({},_,w))},c),u={};return Object.keys(d).reduce(function(h,f){var p=d[f];if(p.hasStack){var x={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(g,v){var _=p.stackGroups[v];return rs(rs({},g),{},Ih({},v,{numericAxisId:n,cateAxisId:i,items:_.items,stackedData:VAe(t,_.items,a)}))},x)}return rs(rs({},h),{},Ih({},f,p))},u)},WAe=function(t,r){var n=r.realScaleType,i=r.type,a=r.tickCount,o=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(a&&i==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var d=t.domain();if(!d.length)return null;var u=rAe(d,a,l);return t.domain([Q1(u),cd(u)]),{niceTicks:u}}if(a&&i==="number"){var h=t.domain(),f=nAe(h,a,l);return{niceTicks:f}}return null};function E_(e){var t=e.axis,r=e.ticks,n=e.bandSize,i=e.entry,a=e.index,o=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Or(i[t.dataKey])){var l=X2(r,"value",i[t.dataKey]);if(l)return l.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var c=Ii(i,Or(o)?t.dataKey:o);return Or(c)?null:t.scale(c)}var gT=function(t){var r=t.axis,n=t.ticks,i=t.offset,a=t.bandSize,o=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+i:null;var c=Ii(o,r.dataKey,r.domain[l]);return Or(c)?null:r.scale(c)-a/2+i},HAe=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var i=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return i<=0&&a>=0?0:a<0?a:i}return n[0]},GAe=function(t,r){var n,i=(n=t.type)!==null&&n!==void 0&&n.defaultProps?rs(rs({},t.type.defaultProps),t.props):t.props,a=i.stackId;if(Ms(a)){var o=r[a];if(o){var l=o.items.indexOf(t);return l>=0?o.stackedData[l]:null}}return null},YAe=function(t){return t.reduce(function(r,n){return[Q1(n.concat([r[0]]).filter(_t)),cd(n.concat([r[1]]).filter(_t))]},[1/0,-1/0])},IH=function(t,r,n){return Object.keys(t).reduce(function(i,a){var o=t[a],l=o.stackedData,c=l.reduce(function(d,u){var h=YAe(u.slice(r,n+1));return[Math.min(d[0],h[0]),Math.max(d[1],h[1])]},[1/0,-1/0]);return[Math.min(c[0],i[0]),Math.max(c[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},vT=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,xT=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,s5=function(t,r,n){if(kr(t))return t(r,n);if(!Array.isArray(t))return r;var i=[];if(_t(t[0]))i[0]=n?t[0]:Math.min(t[0],r[0]);else if(vT.test(t[0])){var a=+vT.exec(t[0])[1];i[0]=r[0]-a}else kr(t[0])?i[0]=t[0](r[0]):i[0]=r[0];if(_t(t[1]))i[1]=n?t[1]:Math.max(t[1],r[1]);else if(xT.test(t[1])){var o=+xT.exec(t[1])[1];i[1]=r[1]+o}else kr(t[1])?i[1]=t[1](r[1]):i[1]=r[1];return i},C_=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var i=t.scale.bandwidth();if(!n||i>0)return i}if(t&&r&&r.length>=2){for(var a=rC(r,function(h){return h.coordinate}),o=1/0,l=1,c=a.length;l<c;l++){var d=a[l],u=a[l-1];o=Math.min((d.coordinate||0)-(u.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},yT=function(t,r,n){return!t||!t.length||wm(t,Za(n,"type.defaultProps.domain"))?r:t},$H=function(t,r){var n=t.type.defaultProps?rs(rs({},t.type.defaultProps),t.props):t.props,i=n.dataKey,a=n.name,o=n.unit,l=n.formatter,c=n.tooltipType,d=n.chartType,u=n.hide;return rs(rs({},Pr(t,!1)),{},{dataKey:i,unit:o,formatter:l,name:a||i,color:CC(t),value:Ii(r,i),type:c,payload:r,chartType:d,hide:u})};function Hg(e){"@babel/helpers - typeof";return Hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hg(e)}function _T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function wT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_T(Object(r),!0).forEach(function(n){KAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_T(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KAe(e,t,r){return t=ZAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZAe(e){var t=XAe(e,"string");return Hg(t)=="symbol"?t:t+""}function XAe(e,t){if(Hg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P_=Math.PI/180,JAe=function(t){return t*180/Math.PI},si=function(t,r,n,i){return{x:t+Math.cos(-P_*i)*n,y:r+Math.sin(-P_*i)*n}},QAe=function(t,r){var n=t.x,i=t.y,a=r.x,o=r.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(i-o,2))},e9e=function(t,r){var n=t.x,i=t.y,a=r.cx,o=r.cy,l=QAe({x:n,y:i},{x:a,y:o});if(l<=0)return{radius:l};var c=(n-a)/l,d=Math.acos(c);return i>o&&(d=2*Math.PI-d),{radius:l,angle:JAe(d),angleInRadian:d}},t9e=function(t){var r=t.startAngle,n=t.endAngle,i=Math.floor(r/360),a=Math.floor(n/360),o=Math.min(i,a);return{startAngle:r-o*360,endAngle:n-o*360}},r9e=function(t,r){var n=r.startAngle,i=r.endAngle,a=Math.floor(n/360),o=Math.floor(i/360),l=Math.min(a,o);return t+l*360},bT=function(t,r){var n=t.x,i=t.y,a=e9e({x:n,y:i},r),o=a.radius,l=a.angle,c=r.innerRadius,d=r.outerRadius;if(o<c||o>d)return!1;if(o===0)return!0;var u=t9e(r),h=u.startAngle,f=u.endAngle,p=l,x;if(h<=f){for(;p>f;)p-=360;for(;p<h;)p+=360;x=p>=h&&p<=f}else{for(;p>h;)p-=360;for(;p<f;)p+=360;x=p>=f&&p<=h}return x?wT(wT({},r),{},{radius:o,angle:r9e(p,r)}):null};function Gg(e){"@babel/helpers - typeof";return Gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gg(e)}var n9e=["offset"];function s9e(e){return l9e(e)||o9e(e)||a9e(e)||i9e()}function i9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a9e(e,t){if(e){if(typeof e=="string")return i5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i5(e,t)}}function o9e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function l9e(e){if(Array.isArray(e))return i5(e)}function i5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c9e(e,t){if(e==null)return{};var r=d9e(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function d9e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function jT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Es(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jT(Object(r),!0).forEach(function(n){u9e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u9e(e,t,r){return t=f9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f9e(e){var t=h9e(e,"string");return Gg(t)=="symbol"?t:t+""}function h9e(e,t){if(Gg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yg(){return Yg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yg.apply(this,arguments)}var m9e=function(t){var r=t.value,n=t.formatter,i=Or(t.children)?r:t.children;return kr(n)?n(i):i},p9e=function(t,r){var n=Ao(r-t),i=Math.min(Math.abs(r-t),360);return n*i},g9e=function(t,r,n){var i=t.position,a=t.viewBox,o=t.offset,l=t.className,c=a,d=c.cx,u=c.cy,h=c.innerRadius,f=c.outerRadius,p=c.startAngle,x=c.endAngle,g=c.clockWise,v=(h+f)/2,_=p9e(p,x),w=_>=0?1:-1,b,N;i==="insideStart"?(b=p+w*o,N=g):i==="insideEnd"?(b=x-w*o,N=!g):i==="end"&&(b=x+w*o,N=g),N=_<=0?N:!N;var S=si(d,u,v,b),k=si(d,u,v,b+(N?1:-1)*359),O="M".concat(S.x,",").concat(S.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(N?0:1,`,
    `).concat(k.x,",").concat(k.y),A=Or(t.id)?fp("recharts-radial-line-"):t.id;return Q.createElement("text",Yg({},n,{dominantBaseline:"central",className:Lr("recharts-radial-bar-label",l)}),Q.createElement("defs",null,Q.createElement("path",{id:A,d:O})),Q.createElement("textPath",{xlinkHref:"#".concat(A)},r))},v9e=function(t){var r=t.viewBox,n=t.offset,i=t.position,a=r,o=a.cx,l=a.cy,c=a.innerRadius,d=a.outerRadius,u=a.startAngle,h=a.endAngle,f=(u+h)/2;if(i==="outside"){var p=si(o,l,d+n,f),x=p.x,g=p.y;return{x,y:g,textAnchor:x>=o?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"end"};var v=(c+d)/2,_=si(o,l,v,f),w=_.x,b=_.y;return{x:w,y:b,textAnchor:"middle",verticalAnchor:"middle"}},x9e=function(t){var r=t.viewBox,n=t.parentViewBox,i=t.offset,a=t.position,o=r,l=o.x,c=o.y,d=o.width,u=o.height,h=u>=0?1:-1,f=h*i,p=h>0?"end":"start",x=h>0?"start":"end",g=d>=0?1:-1,v=g*i,_=g>0?"end":"start",w=g>0?"start":"end";if(a==="top"){var b={x:l+d/2,y:c-h*i,textAnchor:"middle",verticalAnchor:p};return Es(Es({},b),n?{height:Math.max(c-n.y,0),width:d}:{})}if(a==="bottom"){var N={x:l+d/2,y:c+u+f,textAnchor:"middle",verticalAnchor:x};return Es(Es({},N),n?{height:Math.max(n.y+n.height-(c+u),0),width:d}:{})}if(a==="left"){var S={x:l-v,y:c+u/2,textAnchor:_,verticalAnchor:"middle"};return Es(Es({},S),n?{width:Math.max(S.x-n.x,0),height:u}:{})}if(a==="right"){var k={x:l+d+v,y:c+u/2,textAnchor:w,verticalAnchor:"middle"};return Es(Es({},k),n?{width:Math.max(n.x+n.width-k.x,0),height:u}:{})}var O=n?{width:d,height:u}:{};return a==="insideLeft"?Es({x:l+v,y:c+u/2,textAnchor:w,verticalAnchor:"middle"},O):a==="insideRight"?Es({x:l+d-v,y:c+u/2,textAnchor:_,verticalAnchor:"middle"},O):a==="insideTop"?Es({x:l+d/2,y:c+f,textAnchor:"middle",verticalAnchor:x},O):a==="insideBottom"?Es({x:l+d/2,y:c+u-f,textAnchor:"middle",verticalAnchor:p},O):a==="insideTopLeft"?Es({x:l+v,y:c+f,textAnchor:w,verticalAnchor:x},O):a==="insideTopRight"?Es({x:l+d-v,y:c+f,textAnchor:_,verticalAnchor:x},O):a==="insideBottomLeft"?Es({x:l+v,y:c+u-f,textAnchor:w,verticalAnchor:p},O):a==="insideBottomRight"?Es({x:l+d-v,y:c+u-f,textAnchor:_,verticalAnchor:p},O):op(a)&&(_t(a.x)||pu(a.x))&&(_t(a.y)||pu(a.y))?Es({x:l+ef(a.x,d),y:c+ef(a.y,u),textAnchor:"end",verticalAnchor:"end"},O):Es({x:l+d/2,y:c+u/2,textAnchor:"middle",verticalAnchor:"middle"},O)},y9e=function(t){return"cx"in t&&_t(t.cx)};function yi(e){var t=e.offset,r=t===void 0?5:t,n=c9e(e,n9e),i=Es({offset:r},n),a=i.viewBox,o=i.position,l=i.value,c=i.children,d=i.content,u=i.className,h=u===void 0?"":u,f=i.textBreakAll;if(!a||Or(l)&&Or(c)&&!y.isValidElement(d)&&!kr(d))return null;if(y.isValidElement(d))return y.cloneElement(d,i);var p;if(kr(d)){if(p=y.createElement(d,i),y.isValidElement(p))return p}else p=m9e(i);var x=y9e(a),g=Pr(i,!0);if(x&&(o==="insideStart"||o==="insideEnd"||o==="end"))return g9e(i,p,g);var v=x?v9e(i):x9e(i);return Q.createElement(h_,Yg({className:Lr("recharts-label",h)},g,v,{breakAll:f}),p)}yi.displayName="Label";var LH=function(t){var r=t.cx,n=t.cy,i=t.angle,a=t.startAngle,o=t.endAngle,l=t.r,c=t.radius,d=t.innerRadius,u=t.outerRadius,h=t.x,f=t.y,p=t.top,x=t.left,g=t.width,v=t.height,_=t.clockWise,w=t.labelViewBox;if(w)return w;if(_t(g)&&_t(v)){if(_t(h)&&_t(f))return{x:h,y:f,width:g,height:v};if(_t(p)&&_t(x))return{x:p,y:x,width:g,height:v}}return _t(h)&&_t(f)?{x:h,y:f,width:0,height:0}:_t(r)&&_t(n)?{cx:r,cy:n,startAngle:a||i||0,endAngle:o||i||0,innerRadius:d||0,outerRadius:u||c||l||0,clockWise:_}:t.viewBox?t.viewBox:{}},_9e=function(t,r){return t?t===!0?Q.createElement(yi,{key:"label-implicit",viewBox:r}):Ms(t)?Q.createElement(yi,{key:"label-implicit",viewBox:r,value:t}):y.isValidElement(t)?t.type===yi?y.cloneElement(t,{key:"label-implicit",viewBox:r}):Q.createElement(yi,{key:"label-implicit",content:t,viewBox:r}):kr(t)?Q.createElement(yi,{key:"label-implicit",content:t,viewBox:r}):op(t)?Q.createElement(yi,Yg({viewBox:r},t,{key:"label-implicit"})):null:null},w9e=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var i=t.children,a=LH(t),o=Xa(i,yi).map(function(c,d){return y.cloneElement(c,{viewBox:r||a,key:"label-".concat(d)})});if(!n)return o;var l=_9e(t.label,r||a);return[l].concat(s9e(o))};yi.parseViewBox=LH;yi.renderCallByParent=w9e;function b9e(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var j9e=b9e;const N9e=rn(j9e);function Kg(e){"@babel/helpers - typeof";return Kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kg(e)}var S9e=["valueAccessor"],k9e=["data","dataKey","clockWise","id","textBreakAll"];function E9e(e){return T9e(e)||A9e(e)||P9e(e)||C9e()}function C9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P9e(e,t){if(e){if(typeof e=="string")return a5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a5(e,t)}}function A9e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function T9e(e){if(Array.isArray(e))return a5(e)}function a5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A_(){return A_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A_.apply(this,arguments)}function NT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ST(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NT(Object(r),!0).forEach(function(n){O9e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function O9e(e,t,r){return t=R9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R9e(e){var t=M9e(e,"string");return Kg(t)=="symbol"?t:t+""}function M9e(e,t){if(Kg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kT(e,t){if(e==null)return{};var r=D9e(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function D9e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var I9e=function(t){return Array.isArray(t.value)?N9e(t.value):t.value};function fc(e){var t=e.valueAccessor,r=t===void 0?I9e:t,n=kT(e,S9e),i=n.data,a=n.dataKey,o=n.clockWise,l=n.id,c=n.textBreakAll,d=kT(n,k9e);return!i||!i.length?null:Q.createElement(Rn,{className:"recharts-label-list"},i.map(function(u,h){var f=Or(a)?r(u,h):Ii(u&&u.payload,a),p=Or(l)?{}:{id:"".concat(l,"-").concat(h)};return Q.createElement(yi,A_({},Pr(u,!0),d,p,{parentViewBox:u.parentViewBox,value:f,textBreakAll:c,viewBox:yi.parseViewBox(Or(o)?u:ST(ST({},u),{},{clockWise:o})),key:"label-".concat(h),index:h}))}))}fc.displayName="LabelList";function $9e(e,t){return e?e===!0?Q.createElement(fc,{key:"labelList-implicit",data:t}):Q.isValidElement(e)||kr(e)?Q.createElement(fc,{key:"labelList-implicit",data:t,content:e}):op(e)?Q.createElement(fc,A_({data:t},e,{key:"labelList-implicit"})):null:null}function L9e(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,i=Xa(n,fc).map(function(o,l){return y.cloneElement(o,{data:t,key:"labelList-".concat(l)})});if(!r)return i;var a=$9e(e.label,t);return[a].concat(E9e(i))}fc.renderCallByParent=L9e;function Zg(e){"@babel/helpers - typeof";return Zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zg(e)}function o5(){return o5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o5.apply(this,arguments)}function ET(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function CT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ET(Object(r),!0).forEach(function(n){F9e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ET(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F9e(e,t,r){return t=U9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U9e(e){var t=B9e(e,"string");return Zg(t)=="symbol"?t:t+""}function B9e(e,t){if(Zg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z9e=function(t,r){var n=Ao(r-t),i=Math.min(Math.abs(r-t),359.999);return n*i},py=function(t){var r=t.cx,n=t.cy,i=t.radius,a=t.angle,o=t.sign,l=t.isExternal,c=t.cornerRadius,d=t.cornerIsExternal,u=c*(l?1:-1)+i,h=Math.asin(c/u)/P_,f=d?a:a+o*h,p=si(r,n,u,f),x=si(r,n,i,f),g=d?a-o*h:a,v=si(r,n,u*Math.cos(h*P_),g);return{center:p,circleTangency:x,lineTangency:v,theta:h}},FH=function(t){var r=t.cx,n=t.cy,i=t.innerRadius,a=t.outerRadius,o=t.startAngle,l=t.endAngle,c=z9e(o,l),d=o+c,u=si(r,n,a,o),h=si(r,n,a,d),f="M ".concat(u.x,",").concat(u.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>d),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(i>0){var p=si(r,n,i,o),x=si(r,n,i,d);f+="L ".concat(x.x,",").concat(x.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=d),`,
            `).concat(p.x,",").concat(p.y," Z")}else f+="L ".concat(r,",").concat(n," Z");return f},V9e=function(t){var r=t.cx,n=t.cy,i=t.innerRadius,a=t.outerRadius,o=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,h=Ao(u-d),f=py({cx:r,cy:n,radius:a,angle:d,sign:h,cornerRadius:o,cornerIsExternal:c}),p=f.circleTangency,x=f.lineTangency,g=f.theta,v=py({cx:r,cy:n,radius:a,angle:u,sign:-h,cornerRadius:o,cornerIsExternal:c}),_=v.circleTangency,w=v.lineTangency,b=v.theta,N=c?Math.abs(d-u):Math.abs(d-u)-g-b;if(N<0)return l?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):FH({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:d,endAngle:u});var S="M ".concat(x.x,",").concat(x.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(N>180),",").concat(+(h<0),",").concat(_.x,",").concat(_.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(w.x,",").concat(w.y,`
  `);if(i>0){var k=py({cx:r,cy:n,radius:i,angle:d,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),O=k.circleTangency,A=k.lineTangency,T=k.theta,$=py({cx:r,cy:n,radius:i,angle:u,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),R=$.circleTangency,F=$.lineTangency,D=$.theta,B=c?Math.abs(d-u):Math.abs(d-u)-T-D;if(B<0&&o===0)return"".concat(S,"L").concat(r,",").concat(n,"Z");S+="L".concat(F.x,",").concat(F.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(R.x,",").concat(R.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(B>180),",").concat(+(h>0),",").concat(O.x,",").concat(O.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(A.x,",").concat(A.y,"Z")}else S+="L".concat(r,",").concat(n,"Z");return S},q9e={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},UH=function(t){var r=CT(CT({},q9e),t),n=r.cx,i=r.cy,a=r.innerRadius,o=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,d=r.cornerIsExternal,u=r.startAngle,h=r.endAngle,f=r.className;if(o<a||u===h)return null;var p=Lr("recharts-sector",f),x=o-a,g=ef(l,x,0,!0),v;return g>0&&Math.abs(u-h)<360?v=V9e({cx:n,cy:i,innerRadius:a,outerRadius:o,cornerRadius:Math.min(g,x/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:h}):v=FH({cx:n,cy:i,innerRadius:a,outerRadius:o,startAngle:u,endAngle:h}),Q.createElement("path",o5({},Pr(r,!0),{className:p,d:v,role:"img"}))};function Xg(e){"@babel/helpers - typeof";return Xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xg(e)}function l5(){return l5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l5.apply(this,arguments)}function PT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function AT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PT(Object(r),!0).forEach(function(n){W9e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W9e(e,t,r){return t=H9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H9e(e){var t=G9e(e,"string");return Xg(t)=="symbol"?t:t+""}function G9e(e,t){if(Xg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TT={curveBasisClosed:W1e,curveBasisOpen:H1e,curveBasis:q1e,curveBumpX:A1e,curveBumpY:T1e,curveLinearClosed:G1e,curveLinear:z1,curveMonotoneX:Y1e,curveMonotoneY:K1e,curveNatural:Z1e,curveStep:X1e,curveStepAfter:Q1e,curveStepBefore:J1e},gy=function(t){return t.x===+t.x&&t.y===+t.y},l0=function(t){return t.x},c0=function(t){return t.y},Y9e=function(t,r){if(kr(t))return t;var n="curve".concat(U1(t));return(n==="curveMonotone"||n==="curveBump")&&r?TT["".concat(n).concat(r==="vertical"?"Y":"X")]:TT[n]||z1},K9e=function(t){var r=t.type,n=r===void 0?"linear":r,i=t.points,a=i===void 0?[]:i,o=t.baseLine,l=t.layout,c=t.connectNulls,d=c===void 0?!1:c,u=Y9e(n,l),h=d?a.filter(function(g){return gy(g)}):a,f;if(Array.isArray(o)){var p=d?o.filter(function(g){return gy(g)}):o,x=h.map(function(g,v){return AT(AT({},g),{},{base:p[v]})});return l==="vertical"?f=ay().y(c0).x1(l0).x0(function(g){return g.base.x}):f=ay().x(l0).y1(c0).y0(function(g){return g.base.y}),f.defined(gy).curve(u),f(x)}return l==="vertical"&&_t(o)?f=ay().y(c0).x1(l0).x0(o):_t(o)?f=ay().x(l0).y1(c0).y0(o):f=Uq().x(l0).y(c0),f.defined(gy).curve(u),f(h)},$h=function(t){var r=t.className,n=t.points,i=t.path,a=t.pathRef;if((!n||!n.length)&&!i)return null;var o=n&&n.length?K9e(t):i;return y.createElement("path",l5({},Pr(t,!1),J2(t),{className:Lr("recharts-curve",r),d:o,ref:a}))},Z9e=Object.getOwnPropertyNames,X9e=Object.getOwnPropertySymbols,J9e=Object.prototype.hasOwnProperty;function OT(e,t){return function(n,i,a){return e(n,i,a)&&t(n,i,a)}}function vy(e){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,i);var a=i.cache,o=a.get(r),l=a.get(n);if(o&&l)return o===n&&l===r;a.set(r,n),a.set(n,r);var c=e(r,n,i);return a.delete(r),a.delete(n),c}}function RT(e){return Z9e(e).concat(X9e(e))}var Q9e=Object.hasOwn||function(e,t){return J9e.call(e,t)};function _f(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var e8e="__v",t8e="__o",r8e="_owner",MT=Object.getOwnPropertyDescriptor,DT=Object.keys;function n8e(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function s8e(e,t){return _f(e.getTime(),t.getTime())}function i8e(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function a8e(e,t){return e===t}function IT(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var i=new Array(n),a=e.entries(),o,l,c=0;(o=a.next())&&!o.done;){for(var d=t.entries(),u=!1,h=0;(l=d.next())&&!l.done;){if(i[h]){h++;continue}var f=o.value,p=l.value;if(r.equals(f[0],p[0],c,h,e,t,r)&&r.equals(f[1],p[1],f[0],p[0],e,t,r)){u=i[h]=!0;break}h++}if(!u)return!1;c++}return!0}var o8e=_f;function l8e(e,t,r){var n=DT(e),i=n.length;if(DT(t).length!==i)return!1;for(;i-- >0;)if(!BH(e,t,r,n[i]))return!1;return!0}function d0(e,t,r){var n=RT(e),i=n.length;if(RT(t).length!==i)return!1;for(var a,o,l;i-- >0;)if(a=n[i],!BH(e,t,r,a)||(o=MT(e,a),l=MT(t,a),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function c8e(e,t){return _f(e.valueOf(),t.valueOf())}function d8e(e,t){return e.source===t.source&&e.flags===t.flags}function $T(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var i=new Array(n),a=e.values(),o,l;(o=a.next())&&!o.done;){for(var c=t.values(),d=!1,u=0;(l=c.next())&&!l.done;){if(!i[u]&&r.equals(o.value,l.value,o.value,l.value,e,t,r)){d=i[u]=!0;break}u++}if(!d)return!1}return!0}function u8e(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function f8e(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function BH(e,t,r,n){return(n===r8e||n===t8e||n===e8e)&&(e.$$typeof||t.$$typeof)?!0:Q9e(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var h8e="[object Arguments]",m8e="[object Boolean]",p8e="[object Date]",g8e="[object Error]",v8e="[object Map]",x8e="[object Number]",y8e="[object Object]",_8e="[object RegExp]",w8e="[object Set]",b8e="[object String]",j8e="[object URL]",N8e=Array.isArray,LT=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,FT=Object.assign,S8e=Object.prototype.toString.call.bind(Object.prototype.toString);function k8e(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,i=e.areFunctionsEqual,a=e.areMapsEqual,o=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,u=e.areSetsEqual,h=e.areTypedArraysEqual,f=e.areUrlsEqual;return function(x,g,v){if(x===g)return!0;if(x==null||g==null)return!1;var _=typeof x;if(_!==typeof g)return!1;if(_!=="object")return _==="number"?o(x,g,v):_==="function"?i(x,g,v):!1;var w=x.constructor;if(w!==g.constructor)return!1;if(w===Object)return l(x,g,v);if(N8e(x))return t(x,g,v);if(LT!=null&&LT(x))return h(x,g,v);if(w===Date)return r(x,g,v);if(w===RegExp)return d(x,g,v);if(w===Map)return a(x,g,v);if(w===Set)return u(x,g,v);var b=S8e(x);return b===p8e?r(x,g,v):b===_8e?d(x,g,v):b===v8e?a(x,g,v):b===w8e?u(x,g,v):b===y8e?typeof x.then!="function"&&typeof g.then!="function"&&l(x,g,v):b===j8e?f(x,g,v):b===g8e?n(x,g,v):b===h8e?l(x,g,v):b===m8e||b===x8e||b===b8e?c(x,g,v):!1}}function E8e(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,i={areArraysEqual:n?d0:n8e,areDatesEqual:s8e,areErrorsEqual:i8e,areFunctionsEqual:a8e,areMapsEqual:n?OT(IT,d0):IT,areNumbersEqual:o8e,areObjectsEqual:n?d0:l8e,arePrimitiveWrappersEqual:c8e,areRegExpsEqual:d8e,areSetsEqual:n?OT($T,d0):$T,areTypedArraysEqual:n?d0:u8e,areUrlsEqual:f8e};if(r&&(i=FT({},i,r(i))),t){var a=vy(i.areArraysEqual),o=vy(i.areMapsEqual),l=vy(i.areObjectsEqual),c=vy(i.areSetsEqual);i=FT({},i,{areArraysEqual:a,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:c})}return i}function C8e(e){return function(t,r,n,i,a,o,l){return e(t,r,l)}}function P8e(e){var t=e.circular,r=e.comparator,n=e.createState,i=e.equals,a=e.strict;if(n)return function(c,d){var u=n(),h=u.cache,f=h===void 0?t?new WeakMap:void 0:h,p=u.meta;return r(c,d,{cache:f,equals:i,meta:p,strict:a})};if(t)return function(c,d){return r(c,d,{cache:new WeakMap,equals:i,meta:void 0,strict:a})};var o={cache:void 0,equals:i,meta:void 0,strict:a};return function(c,d){return r(c,d,o)}}var A8e=Vd();Vd({strict:!0});Vd({circular:!0});Vd({circular:!0,strict:!0});Vd({createInternalComparator:function(){return _f}});Vd({strict:!0,createInternalComparator:function(){return _f}});Vd({circular:!0,createInternalComparator:function(){return _f}});Vd({circular:!0,createInternalComparator:function(){return _f},strict:!0});function Vd(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,i=e.createState,a=e.strict,o=a===void 0?!1:a,l=E8e(e),c=k8e(l),d=n?n(c):C8e(c);return P8e({circular:r,comparator:c,createState:i,equals:d,strict:o})}function T8e(e){typeof requestAnimationFrame!="undefined"&&requestAnimationFrame(e)}function UT(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function i(a){r<0&&(r=a),a-r>t?(e(a),r=-1):T8e(i)};requestAnimationFrame(n)}function c5(e){"@babel/helpers - typeof";return c5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c5(e)}function O8e(e){return I8e(e)||D8e(e)||M8e(e)||R8e()}function R8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M8e(e,t){if(e){if(typeof e=="string")return BT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BT(e,t)}}function BT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function D8e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function I8e(e){if(Array.isArray(e))return e}function $8e(){var e={},t=function(){return null},r=!1,n=function i(a){if(!r){if(Array.isArray(a)){if(!a.length)return;var o=a,l=O8e(o),c=l[0],d=l.slice(1);if(typeof c=="number"){UT(i.bind(null,d),c);return}i(c),UT(i.bind(null,d));return}c5(a)==="object"&&(e=a,t(e)),typeof a=="function"&&a()}};return{stop:function(){r=!0},start:function(a){r=!1,n(a)},subscribe:function(a){return t=a,function(){t=function(){return null}}}}}function Jg(e){"@babel/helpers - typeof";return Jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jg(e)}function zT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function VT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zT(Object(r),!0).forEach(function(n){zH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zH(e,t,r){return t=L8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L8e(e){var t=F8e(e,"string");return Jg(t)==="symbol"?t:String(t)}function F8e(e,t){if(Jg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U8e=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,i){return n.filter(function(a){return i.includes(a)})})},B8e=function(t){return t},z8e=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},B0=function(t,r){return Object.keys(r).reduce(function(n,i){return VT(VT({},n),{},zH({},i,t(i,r[i])))},{})},qT=function(t,r,n){return t.map(function(i){return"".concat(z8e(i)," ").concat(r,"ms ").concat(n)}).join(",")};function V8e(e,t){return H8e(e)||W8e(e,t)||VH(e,t)||q8e()}function q8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W8e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,d=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,i=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw i}}return l}}function H8e(e){if(Array.isArray(e))return e}function G8e(e){return Z8e(e)||K8e(e)||VH(e)||Y8e()}function Y8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VH(e,t){if(e){if(typeof e=="string")return d5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d5(e,t)}}function K8e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Z8e(e){if(Array.isArray(e))return d5(e)}function d5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var T_=1e-4,qH=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},WH=function(t,r){return t.map(function(n,i){return n*Math.pow(r,i)}).reduce(function(n,i){return n+i})},WT=function(t,r){return function(n){var i=qH(t,r);return WH(i,n)}},X8e=function(t,r){return function(n){var i=qH(t,r),a=[].concat(G8e(i.map(function(o,l){return o*l}).slice(1)),[0]);return WH(a,n)}},HT=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0],a=r[1],o=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":i=0,a=0,o=1,l=1;break;case"ease":i=.25,a=.1,o=.25,l=1;break;case"ease-in":i=.42,a=0,o=1,l=1;break;case"ease-out":i=.42,a=0,o=.58,l=1;break;case"ease-in-out":i=0,a=0,o=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var d=c[1].split(")")[0].split(",").map(function(v){return parseFloat(v)}),u=V8e(d,4);i=u[0],a=u[1],o=u[2],l=u[3]}}}var h=WT(i,o),f=WT(a,l),p=X8e(i,o),x=function(_){return _>1?1:_<0?0:_},g=function(_){for(var w=_>1?1:_,b=w,N=0;N<8;++N){var S=h(b)-w,k=p(b);if(Math.abs(S-w)<T_||k<T_)return f(b);b=x(b-S/k)}return f(b)};return g.isStepper=!1,g},J8e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,i=t.damping,a=i===void 0?8:i,o=t.dt,l=o===void 0?17:o,c=function(u,h,f){var p=-(u-h)*n,x=f*a,g=f+(p-x)*l/1e3,v=f*l/1e3+u;return Math.abs(v-h)<T_&&Math.abs(g)<T_?[h,0]:[v,g]};return c.isStepper=!0,c.dt=l,c},Q8e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return HT(i);case"spring":return J8e();default:if(i.split("(")[0]==="cubic-bezier")return HT(i)}return typeof i=="function"?i:null};function Qg(e){"@babel/helpers - typeof";return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qg(e)}function GT(e){return rTe(e)||tTe(e)||HH(e)||eTe()}function eTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tTe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rTe(e){if(Array.isArray(e))return f5(e)}function YT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ti(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YT(Object(r),!0).forEach(function(n){u5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u5(e,t,r){return t=nTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nTe(e){var t=sTe(e,"string");return Qg(t)==="symbol"?t:String(t)}function sTe(e,t){if(Qg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iTe(e,t){return lTe(e)||oTe(e,t)||HH(e,t)||aTe()}function aTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HH(e,t){if(e){if(typeof e=="string")return f5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f5(e,t)}}function f5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oTe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,d=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,i=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw i}}return l}}function lTe(e){if(Array.isArray(e))return e}var O_=function(t,r,n){return t+(r-t)*n},h5=function(t){var r=t.from,n=t.to;return r!==n},cTe=function e(t,r,n){var i=B0(function(a,o){if(h5(o)){var l=t(o.from,o.to,o.velocity),c=iTe(l,2),d=c[0],u=c[1];return ti(ti({},o),{},{from:d,velocity:u})}return o},r);return n<1?B0(function(a,o){return h5(o)?ti(ti({},o),{},{velocity:O_(o.velocity,i[a].velocity,n),from:O_(o.from,i[a].from,n)}):o},r):e(t,i,n-1)};const dTe=function(e,t,r,n,i){var a=U8e(e,t),o=a.reduce(function(v,_){return ti(ti({},v),{},u5({},_,[e[_],t[_]]))},{}),l=a.reduce(function(v,_){return ti(ti({},v),{},u5({},_,{from:e[_],velocity:0,to:t[_]}))},{}),c=-1,d,u,h=function(){return null},f=function(){return B0(function(_,w){return w.from},l)},p=function(){return!Object.values(l).filter(h5).length},x=function(_){d||(d=_);var w=_-d,b=w/r.dt;l=cTe(r,l,b),i(ti(ti(ti({},e),t),f())),d=_,p()||(c=requestAnimationFrame(h))},g=function(_){u||(u=_);var w=(_-u)/n,b=B0(function(S,k){return O_.apply(void 0,GT(k).concat([r(w)]))},o);if(i(ti(ti(ti({},e),t),b)),w<1)c=requestAnimationFrame(h);else{var N=B0(function(S,k){return O_.apply(void 0,GT(k).concat([r(1)]))},o);i(ti(ti(ti({},e),t),N))}};return h=r.isStepper?x:g,function(){return requestAnimationFrame(h),function(){cancelAnimationFrame(c)}}};function jm(e){"@babel/helpers - typeof";return jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jm(e)}var uTe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function fTe(e,t){if(e==null)return{};var r=hTe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hTe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function uN(e){return vTe(e)||gTe(e)||pTe(e)||mTe()}function mTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pTe(e,t){if(e){if(typeof e=="string")return m5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m5(e,t)}}function gTe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vTe(e){if(Array.isArray(e))return m5(e)}function m5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function lo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KT(Object(r),!0).forEach(function(n){w0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function w0(e,t,r){return t=GH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yTe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GH(n.key),n)}}function _Te(e,t,r){return t&&yTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function GH(e){var t=wTe(e,"string");return jm(t)==="symbol"?t:String(t)}function wTe(e,t){if(jm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p5(e,t)}function p5(e,t){return p5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},p5(e,t)}function jTe(e){var t=NTe();return function(){var n=R_(e),i;if(t){var a=R_(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return g5(this,i)}}function g5(e,t){if(t&&(jm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v5(e)}function v5(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NTe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function R_(e){return R_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},R_(e)}var kl=function(e){bTe(r,e);var t=jTe(r);function r(n,i){var a;xTe(this,r),a=t.call(this,n,i);var o=a.props,l=o.isActive,c=o.attributeName,d=o.from,u=o.to,h=o.steps,f=o.children,p=o.duration;if(a.handleStyleChange=a.handleStyleChange.bind(v5(a)),a.changeStyle=a.changeStyle.bind(v5(a)),!l||p<=0)return a.state={style:{}},typeof f=="function"&&(a.state={style:u}),g5(a);if(h&&h.length)a.state={style:h[0].style};else if(d){if(typeof f=="function")return a.state={style:d},g5(a);a.state={style:c?w0({},c,d):d}}else a.state={style:{}};return a}return _Te(r,[{key:"componentDidMount",value:function(){var i=this.props,a=i.isActive,o=i.canBegin;this.mounted=!0,!(!a||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var a=this.props,o=a.isActive,l=a.canBegin,c=a.attributeName,d=a.shouldReAnimate,u=a.to,h=a.from,f=this.state.style;if(l){if(!o){var p={style:c?w0({},c,u):u};this.state&&f&&(c&&f[c]!==u||!c&&f!==u)&&this.setState(p);return}if(!(A8e(i.to,u)&&i.canBegin&&i.isActive)){var x=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=x||d?h:i.to;if(this.state&&f){var v={style:c?w0({},c,g):g};(c&&f[c]!==g||!c&&f!==g)&&this.setState(v)}this.runAnimation(lo(lo({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var i=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),i&&i()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var a=this,o=i.from,l=i.to,c=i.duration,d=i.easing,u=i.begin,h=i.onAnimationEnd,f=i.onAnimationStart,p=dTe(o,l,Q8e(d),c,this.changeStyle),x=function(){a.stopJSAnimation=p()};this.manager.start([f,u,x,c,h])}},{key:"runStepAnimation",value:function(i){var a=this,o=i.steps,l=i.begin,c=i.onAnimationStart,d=o[0],u=d.style,h=d.duration,f=h===void 0?0:h,p=function(g,v,_){if(_===0)return g;var w=v.duration,b=v.easing,N=b===void 0?"ease":b,S=v.style,k=v.properties,O=v.onAnimationEnd,A=_>0?o[_-1]:v,T=k||Object.keys(S);if(typeof N=="function"||N==="spring")return[].concat(uN(g),[a.runJSAnimation.bind(a,{from:A.style,to:S,duration:w,easing:N}),w]);var $=qT(T,w,N),R=lo(lo(lo({},A.style),S),{},{transition:$});return[].concat(uN(g),[R,w,O]).filter(B8e)};return this.manager.start([c].concat(uN(o.reduce(p,[u,Math.max(f,l)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=$8e());var a=i.begin,o=i.duration,l=i.attributeName,c=i.to,d=i.easing,u=i.onAnimationStart,h=i.onAnimationEnd,f=i.steps,p=i.children,x=this.manager;if(this.unSubscribe=x.subscribe(this.handleStyleChange),typeof d=="function"||typeof p=="function"||d==="spring"){this.runJSAnimation(i);return}if(f.length>1){this.runStepAnimation(i);return}var g=l?w0({},l,c):c,v=qT(Object.keys(g),o,d);x.start([u,a,lo(lo({},g),{},{transition:v}),o,h])}},{key:"render",value:function(){var i=this.props,a=i.children;i.begin;var o=i.duration;i.attributeName,i.easing;var l=i.isActive;i.steps,i.from,i.to,i.canBegin,i.onAnimationEnd,i.shouldReAnimate,i.onAnimationReStart;var c=fTe(i,uTe),d=y.Children.count(a),u=this.state.style;if(typeof a=="function")return a(u);if(!l||d===0||o<=0)return a;var h=function(p){var x=p.props,g=x.style,v=g===void 0?{}:g,_=x.className,w=y.cloneElement(p,lo(lo({},c),{},{style:lo(lo({},v),u),className:_}));return w};return d===1?h(y.Children.only(a)):Q.createElement("div",null,y.Children.map(a,function(f){return h(f)}))}}]),r}(y.PureComponent);kl.displayName="Animate";kl.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};kl.propTypes={from:at.oneOfType([at.object,at.string]),to:at.oneOfType([at.object,at.string]),attributeName:at.string,duration:at.number,begin:at.number,easing:at.oneOfType([at.string,at.func]),steps:at.arrayOf(at.shape({duration:at.number.isRequired,style:at.object.isRequired,easing:at.oneOfType([at.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),at.func]),properties:at.arrayOf("string"),onAnimationEnd:at.func})),children:at.oneOfType([at.node,at.func]),isActive:at.bool,canBegin:at.bool,onAnimationEnd:at.func,shouldReAnimate:at.bool,onAnimationStart:at.func,onAnimationReStart:at.func};function ev(e){"@babel/helpers - typeof";return ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ev(e)}function M_(){return M_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},M_.apply(this,arguments)}function STe(e,t){return PTe(e)||CTe(e,t)||ETe(e,t)||kTe()}function kTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ETe(e,t){if(e){if(typeof e=="string")return ZT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZT(e,t)}}function ZT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function CTe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,d=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,i=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw i}}return l}}function PTe(e){if(Array.isArray(e))return e}function XT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function JT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XT(Object(r),!0).forEach(function(n){ATe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ATe(e,t,r){return t=TTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TTe(e){var t=OTe(e,"string");return ev(t)=="symbol"?t:t+""}function OTe(e,t){if(ev(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ev(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QT=function(t,r,n,i,a){var o=Math.min(Math.abs(n)/2,Math.abs(i)/2),l=i>=0?1:-1,c=n>=0?1:-1,d=i>=0&&n>=0||i<0&&n<0?1:0,u;if(o>0&&a instanceof Array){for(var h=[0,0,0,0],f=0,p=4;f<p;f++)h[f]=a[f]>o?o:a[f];u="M".concat(t,",").concat(r+l*h[0]),h[0]>0&&(u+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(d,",").concat(t+c*h[0],",").concat(r)),u+="L ".concat(t+n-c*h[1],",").concat(r),h[1]>0&&(u+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(d,`,
        `).concat(t+n,",").concat(r+l*h[1])),u+="L ".concat(t+n,",").concat(r+i-l*h[2]),h[2]>0&&(u+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(d,`,
        `).concat(t+n-c*h[2],",").concat(r+i)),u+="L ".concat(t+c*h[3],",").concat(r+i),h[3]>0&&(u+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+i-l*h[3])),u+="Z"}else if(o>0&&a===+a&&a>0){var x=Math.min(o,a);u="M ".concat(t,",").concat(r+l*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(d,",").concat(t+c*x,",").concat(r,`
            L `).concat(t+n-c*x,",").concat(r,`
            A `).concat(x,",").concat(x,",0,0,").concat(d,",").concat(t+n,",").concat(r+l*x,`
            L `).concat(t+n,",").concat(r+i-l*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(d,",").concat(t+n-c*x,",").concat(r+i,`
            L `).concat(t+c*x,",").concat(r+i,`
            A `).concat(x,",").concat(x,",0,0,").concat(d,",").concat(t,",").concat(r+i-l*x," Z")}else u="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(i," h ").concat(-n," Z");return u},RTe=function(t,r){if(!t||!r)return!1;var n=t.x,i=t.y,a=r.x,o=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var d=Math.min(a,a+l),u=Math.max(a,a+l),h=Math.min(o,o+c),f=Math.max(o,o+c);return n>=d&&n<=u&&i>=h&&i<=f}return!1},MTe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},PC=function(t){var r=JT(JT({},MTe),t),n=y.useRef(),i=y.useState(-1),a=STe(i,2),o=a[0],l=a[1];y.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var N=n.current.getTotalLength();N&&l(N)}catch(S){}},[]);var c=r.x,d=r.y,u=r.width,h=r.height,f=r.radius,p=r.className,x=r.animationEasing,g=r.animationDuration,v=r.animationBegin,_=r.isAnimationActive,w=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||h!==+h||u===0||h===0)return null;var b=Lr("recharts-rectangle",p);return w?Q.createElement(kl,{canBegin:o>0,from:{width:u,height:h,x:c,y:d},to:{width:u,height:h,x:c,y:d},duration:g,animationEasing:x,isActive:w},function(N){var S=N.width,k=N.height,O=N.x,A=N.y;return Q.createElement(kl,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:g,isActive:_,easing:x},Q.createElement("path",M_({},Pr(r,!0),{className:b,d:QT(O,A,S,k,f),ref:n})))}):Q.createElement("path",M_({},Pr(r,!0),{className:b,d:QT(c,d,u,h,f)}))};function x5(){return x5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},x5.apply(this,arguments)}var rb=function(t){var r=t.cx,n=t.cy,i=t.r,a=t.className,o=Lr("recharts-dot",a);return r===+r&&n===+n&&i===+i?y.createElement("circle",x5({},Pr(t,!1),J2(t),{className:o,cx:r,cy:n,r:i})):null};function tv(e){"@babel/helpers - typeof";return tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tv(e)}var DTe=["x","y","top","left","width","height","className"];function y5(){return y5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y5.apply(this,arguments)}function eO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ITe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eO(Object(r),!0).forEach(function(n){$Te(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $Te(e,t,r){return t=LTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LTe(e){var t=FTe(e,"string");return tv(t)=="symbol"?t:t+""}function FTe(e,t){if(tv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UTe(e,t){if(e==null)return{};var r=BTe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function BTe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var zTe=function(t,r,n,i,a,o){return"M".concat(t,",").concat(a,"v").concat(i,"M").concat(o,",").concat(r,"h").concat(n)},VTe=function(t){var r=t.x,n=r===void 0?0:r,i=t.y,a=i===void 0?0:i,o=t.top,l=o===void 0?0:o,c=t.left,d=c===void 0?0:c,u=t.width,h=u===void 0?0:u,f=t.height,p=f===void 0?0:f,x=t.className,g=UTe(t,DTe),v=ITe({x:n,y:a,top:l,left:d,width:h,height:p},g);return!_t(n)||!_t(a)||!_t(h)||!_t(p)||!_t(l)||!_t(d)?null:Q.createElement("path",y5({},Pr(v,!0),{className:Lr("recharts-cross",x),d:zTe(n,a,h,p,l,d)}))},qTe=dW,WTe=qTe(Object.getPrototypeOf,Object),HTe=WTe,GTe=Ac,YTe=HTe,KTe=Tc,ZTe="[object Object]",XTe=Function.prototype,JTe=Object.prototype,YH=XTe.toString,QTe=JTe.hasOwnProperty,eOe=YH.call(Object);function tOe(e){if(!KTe(e)||GTe(e)!=ZTe)return!1;var t=YTe(e);if(t===null)return!0;var r=QTe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&YH.call(r)==eOe}var rOe=tOe;const nOe=rn(rOe);var sOe=Ac,iOe=Tc,aOe="[object Boolean]";function oOe(e){return e===!0||e===!1||iOe(e)&&sOe(e)==aOe}var lOe=oOe;const cOe=rn(lOe);function rv(e){"@babel/helpers - typeof";return rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rv(e)}function D_(){return D_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D_.apply(this,arguments)}function dOe(e,t){return mOe(e)||hOe(e,t)||fOe(e,t)||uOe()}function uOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fOe(e,t){if(e){if(typeof e=="string")return tO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tO(e,t)}}function tO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hOe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,d=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,i=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw i}}return l}}function mOe(e){if(Array.isArray(e))return e}function rO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rO(Object(r),!0).forEach(function(n){pOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pOe(e,t,r){return t=gOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gOe(e){var t=vOe(e,"string");return rv(t)=="symbol"?t:t+""}function vOe(e,t){if(rv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sO=function(t,r,n,i,a){var o=n-i,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-o/2,",").concat(r+a),l+="L ".concat(t+n-o/2-i,",").concat(r+a),l+="L ".concat(t,",").concat(r," Z"),l},xOe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},yOe=function(t){var r=nO(nO({},xOe),t),n=y.useRef(),i=y.useState(-1),a=dOe(i,2),o=a[0],l=a[1];y.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var b=n.current.getTotalLength();b&&l(b)}catch(N){}},[]);var c=r.x,d=r.y,u=r.upperWidth,h=r.lowerWidth,f=r.height,p=r.className,x=r.animationEasing,g=r.animationDuration,v=r.animationBegin,_=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||h!==+h||f!==+f||u===0&&h===0||f===0)return null;var w=Lr("recharts-trapezoid",p);return _?Q.createElement(kl,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:f,x:c,y:d},to:{upperWidth:u,lowerWidth:h,height:f,x:c,y:d},duration:g,animationEasing:x,isActive:_},function(b){var N=b.upperWidth,S=b.lowerWidth,k=b.height,O=b.x,A=b.y;return Q.createElement(kl,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:g,easing:x},Q.createElement("path",D_({},Pr(r,!0),{className:w,d:sO(O,A,N,S,k),ref:n})))}):Q.createElement("g",null,Q.createElement("path",D_({},Pr(r,!0),{className:w,d:sO(c,d,u,h,f)})))},_Oe=["option","shapeType","propTransformer","activeClassName","isActive"];function nv(e){"@babel/helpers - typeof";return nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nv(e)}function wOe(e,t){if(e==null)return{};var r=bOe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function bOe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function iO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function I_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iO(Object(r),!0).forEach(function(n){jOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jOe(e,t,r){return t=NOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NOe(e){var t=SOe(e,"string");return nv(t)=="symbol"?t:t+""}function SOe(e,t){if(nv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kOe(e,t){return I_(I_({},t),e)}function EOe(e,t){return e==="symbols"}function aO(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Q.createElement(PC,r);case"trapezoid":return Q.createElement(yOe,r);case"sector":return Q.createElement(UH,r);case"symbols":if(EOe(t))return Q.createElement(Y4,r);break;default:return null}}function COe(e){return y.isValidElement(e)?e.props:e}function POe(e){var t=e.option,r=e.shapeType,n=e.propTransformer,i=n===void 0?kOe:n,a=e.activeClassName,o=a===void 0?"recharts-active-shape":a,l=e.isActive,c=wOe(e,_Oe),d;if(y.isValidElement(t))d=y.cloneElement(t,I_(I_({},c),COe(t)));else if(kr(t))d=t(c);else if(nOe(t)&&!cOe(t)){var u=i(t,c);d=Q.createElement(aO,{shapeType:r,elementProps:u})}else{var h=c;d=Q.createElement(aO,{shapeType:r,elementProps:h})}return l?Q.createElement(Rn,{className:o},d):d}function nb(e,t){return t!=null&&"trapezoids"in e.props}function sb(e,t){return t!=null&&"sectors"in e.props}function sv(e,t){return t!=null&&"points"in e.props}function AOe(e,t){var r,n,i=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,a=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return i&&a}function TOe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function OOe(e,t){var r=e.x===t.x,n=e.y===t.y,i=e.z===t.z;return r&&n&&i}function ROe(e,t){var r;return nb(e,t)?r=AOe:sb(e,t)?r=TOe:sv(e,t)&&(r=OOe),r}function MOe(e,t){var r;return nb(e,t)?r="trapezoids":sb(e,t)?r="sectors":sv(e,t)&&(r="points"),r}function DOe(e,t){if(nb(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(sb(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return sv(e,t)?t.payload:{}}function IOe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,i=MOe(r,t),a=DOe(r,t),o=n.filter(function(c,d){var u=wm(a,c),h=r.props[i].filter(function(x){var g=ROe(r,t);return g(x,t)}),f=r.props[i].indexOf(h[h.length-1]),p=d===f;return u&&p}),l=n.indexOf(o[o.length-1]);return l}var $Oe=Math.ceil,LOe=Math.max;function FOe(e,t,r,n){for(var i=-1,a=LOe($Oe((t-e)/(r||1)),0),o=Array(a);a--;)o[n?a:++i]=e,e+=r;return o}var UOe=FOe,BOe=PW,oO=1/0,zOe=17976931348623157e292;function VOe(e){if(!e)return e===0?e:0;if(e=BOe(e),e===oO||e===-oO){var t=e<0?-1:1;return t*zOe}return e===e?e:0}var KH=VOe,qOe=UOe,WOe=H1,fN=KH;function HOe(e){return function(t,r,n){return n&&typeof n!="number"&&WOe(t,r,n)&&(r=n=void 0),t=fN(t),r===void 0?(r=t,t=0):r=fN(r),n=n===void 0?t<r?1:-1:fN(n),qOe(t,r,n,e)}}var GOe=HOe,YOe=GOe,KOe=YOe(),ZOe=KOe;const $_=rn(ZOe);function iv(e){"@babel/helpers - typeof";return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iv(e)}function lO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lO(Object(r),!0).forEach(function(n){ZH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZH(e,t,r){return t=XOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XOe(e){var t=JOe(e,"string");return iv(t)=="symbol"?t:t+""}function JOe(e,t){if(iv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QOe=["Webkit","Moz","O","ms"],eRe=function(t,r){var n=t.replace(/(\w)/,function(a){return a.toUpperCase()}),i=QOe.reduce(function(a,o){return cO(cO({},a),{},ZH({},o+n,r))},{});return i[t]=r,i};function Nm(e){"@babel/helpers - typeof";return Nm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nm(e)}function L_(){return L_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},L_.apply(this,arguments)}function dO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function hN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dO(Object(r),!0).forEach(function(n){ga(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JH(n.key),n)}}function rRe(e,t,r){return t&&uO(e.prototype,t),r&&uO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nRe(e,t,r){return t=F_(t),sRe(e,XH()?Reflect.construct(t,r||[],F_(e).constructor):t.apply(e,r))}function sRe(e,t){if(t&&(Nm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iRe(e)}function iRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(XH=function(){return!!e})()}function F_(e){return F_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},F_(e)}function aRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_5(e,t)}function _5(e,t){return _5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_5(e,t)}function ga(e,t,r){return t=JH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JH(e){var t=oRe(e,"string");return Nm(t)=="symbol"?t:t+""}function oRe(e,t){if(Nm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lRe=function(t){var r=t.data,n=t.startIndex,i=t.endIndex,a=t.x,o=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,d=F0().domain($_(0,c)).range([a,a+o-l]),u=d.domain().map(function(h){return d(h)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(n),endX:d(i),scale:d,scaleValues:u}},fO=function(t){return t.changedTouches&&!!t.changedTouches.length},Sm=function(e){function t(r){var n;return tRe(this,t),n=nRe(this,t,[r]),ga(n,"handleDrag",function(i){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(i):n.state.isSlideMoving&&n.handleSlideDrag(i)}),ga(n,"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&n.handleDrag(i.changedTouches[0])}),ga(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=n.props,a=i.endIndex,o=i.onDragEnd,l=i.startIndex;o==null||o({endIndex:a,startIndex:l})}),n.detachDragEndListener()}),ga(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),ga(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),ga(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),ga(n,"handleSlideDragStart",function(i){var a=fO(i)?i.changedTouches[0]:i;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:a.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return aRe(t,e),rRe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var i=n.startX,a=n.endX,o=this.state.scaleValues,l=this.props,c=l.gap,d=l.data,u=d.length-1,h=Math.min(i,a),f=Math.max(i,a),p=t.getIndexInRange(o,h),x=t.getIndexInRange(o,f);return{startIndex:p-p%c,endIndex:x===u?u:x-x%c}}},{key:"getTextOfTick",value:function(n){var i=this.props,a=i.data,o=i.tickFormatter,l=i.dataKey,c=Ii(a[n],l,n);return kr(o)?o(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var i=this.state,a=i.slideMoveStartX,o=i.startX,l=i.endX,c=this.props,d=c.x,u=c.width,h=c.travellerWidth,f=c.startIndex,p=c.endIndex,x=c.onChange,g=n.pageX-a;g>0?g=Math.min(g,d+u-h-l,d+u-h-o):g<0&&(g=Math.max(g,d-o,d-l));var v=this.getIndex({startX:o+g,endX:l+g});(v.startIndex!==f||v.endIndex!==p)&&x&&x(v),this.setState({startX:o+g,endX:l+g,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,i){var a=fO(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var i=this.state,a=i.brushMoveStartX,o=i.movingTravellerId,l=i.endX,c=i.startX,d=this.state[o],u=this.props,h=u.x,f=u.width,p=u.travellerWidth,x=u.onChange,g=u.gap,v=u.data,_={startX:this.state.startX,endX:this.state.endX},w=n.pageX-a;w>0?w=Math.min(w,h+f-p-d):w<0&&(w=Math.max(w,h-d)),_[o]=d+w;var b=this.getIndex(_),N=b.startIndex,S=b.endIndex,k=function(){var A=v.length-1;return o==="startX"&&(l>c?N%g===0:S%g===0)||l<c&&S===A||o==="endX"&&(l>c?S%g===0:N%g===0)||l>c&&S===A};this.setState(ga(ga({},o,d+w),"brushMoveStartX",n.pageX),function(){x&&k()&&x(b)})}},{key:"handleTravellerMoveKeyboard",value:function(n,i){var a=this,o=this.state,l=o.scaleValues,c=o.startX,d=o.endX,u=this.state[i],h=l.indexOf(u);if(h!==-1){var f=h+n;if(!(f===-1||f>=l.length)){var p=l[f];i==="startX"&&p>=d||i==="endX"&&p<=c||this.setState(ga({},i,p),function(){a.props.onChange(a.getIndex({startX:a.state.startX,endX:a.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,i=n.x,a=n.y,o=n.width,l=n.height,c=n.fill,d=n.stroke;return Q.createElement("rect",{stroke:d,fill:c,x:i,y:a,width:o,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,i=n.x,a=n.y,o=n.width,l=n.height,c=n.data,d=n.children,u=n.padding,h=y.Children.only(d);return h?Q.cloneElement(h,{x:i,y:a,width:o,height:l,margin:u,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,i){var a,o,l=this,c=this.props,d=c.y,u=c.travellerWidth,h=c.height,f=c.traveller,p=c.ariaLabel,x=c.data,g=c.startIndex,v=c.endIndex,_=Math.max(n,this.props.x),w=hN(hN({},Pr(this.props,!1)),{},{x:_,y:d,width:u,height:h}),b=p||"Min value: ".concat((a=x[g])===null||a===void 0?void 0:a.name,", Max value: ").concat((o=x[v])===null||o===void 0?void 0:o.name);return Q.createElement(Rn,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function(S){["ArrowLeft","ArrowRight"].includes(S.key)&&(S.preventDefault(),S.stopPropagation(),l.handleTravellerMoveKeyboard(S.key==="ArrowRight"?1:-1,i))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(f,w))}},{key:"renderSlide",value:function(n,i){var a=this.props,o=a.y,l=a.height,c=a.stroke,d=a.travellerWidth,u=Math.min(n,i)+d,h=Math.max(Math.abs(i-n)-d,0);return Q.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:u,y:o,width:h,height:l})}},{key:"renderText",value:function(){var n=this.props,i=n.startIndex,a=n.endIndex,o=n.y,l=n.height,c=n.travellerWidth,d=n.stroke,u=this.state,h=u.startX,f=u.endX,p=5,x={pointerEvents:"none",fill:d};return Q.createElement(Rn,{className:"recharts-brush-texts"},Q.createElement(h_,L_({textAnchor:"end",verticalAnchor:"middle",x:Math.min(h,f)-p,y:o+l/2},x),this.getTextOfTick(i)),Q.createElement(h_,L_({textAnchor:"start",verticalAnchor:"middle",x:Math.max(h,f)+c+p,y:o+l/2},x),this.getTextOfTick(a)))}},{key:"render",value:function(){var n=this.props,i=n.data,a=n.className,o=n.children,l=n.x,c=n.y,d=n.width,u=n.height,h=n.alwaysShowText,f=this.state,p=f.startX,x=f.endX,g=f.isTextActive,v=f.isSlideMoving,_=f.isTravellerMoving,w=f.isTravellerFocused;if(!i||!i.length||!_t(l)||!_t(c)||!_t(d)||!_t(u)||d<=0||u<=0)return null;var b=Lr("recharts-brush",a),N=Q.Children.count(o)===1,S=eRe("userSelect","none");return Q.createElement(Rn,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:S},this.renderBackground(),N&&this.renderPanorama(),this.renderSlide(p,x),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(x,"endX"),(g||v||_||w||h)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var i=n.x,a=n.y,o=n.width,l=n.height,c=n.stroke,d=Math.floor(a+l/2)-1;return Q.createElement(Q.Fragment,null,Q.createElement("rect",{x:i,y:a,width:o,height:l,fill:c,stroke:"none"}),Q.createElement("line",{x1:i+1,y1:d,x2:i+o-1,y2:d,fill:"none",stroke:"#fff"}),Q.createElement("line",{x1:i+1,y1:d+2,x2:i+o-1,y2:d+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,i){var a;return Q.isValidElement(n)?a=Q.cloneElement(n,i):kr(n)?a=n(i):a=t.renderDefaultTraveller(i),a}},{key:"getDerivedStateFromProps",value:function(n,i){var a=n.data,o=n.width,l=n.x,c=n.travellerWidth,d=n.updateId,u=n.startIndex,h=n.endIndex;if(a!==i.prevData||d!==i.prevUpdateId)return hN({prevData:a,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:o},a&&a.length?lRe({data:a,width:o,x:l,travellerWidth:c,startIndex:u,endIndex:h}):{scale:null,scaleValues:null});if(i.scale&&(o!==i.prevWidth||l!==i.prevX||c!==i.prevTravellerWidth)){i.scale.range([l,l+o-c]);var f=i.scale.domain().map(function(p){return i.scale(p)});return{prevData:a,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:o,startX:i.scale(n.startIndex),endX:i.scale(n.endIndex),scaleValues:f}}return null}},{key:"getIndexInRange",value:function(n,i){for(var a=n.length,o=0,l=a-1;l-o>1;){var c=Math.floor((o+l)/2);n[c]>i?l=c:o=c}return i>=n[l]?l:o}}])}(y.PureComponent);ga(Sm,"displayName","Brush");ga(Sm,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var cRe=tC;function dRe(e,t){var r;return cRe(e,function(n,i,a){return r=t(n,i,a),!r}),!!r}var uRe=dRe,fRe=rW,hRe=Ud,mRe=uRe,pRe=ha,gRe=H1;function vRe(e,t,r){var n=pRe(e)?fRe:mRe;return r&&gRe(e,t,r)&&(t=void 0),n(e,hRe(t))}var xRe=vRe;const yRe=rn(xRe);var wl=function(t,r){var n=t.alwaysShow,i=t.ifOverflow;return n&&(i="extendDomain"),i===r},hO=NW;function _Re(e,t,r){t=="__proto__"&&hO?hO(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var wRe=_Re,bRe=wRe,jRe=bW,NRe=Ud;function SRe(e,t){var r={};return t=NRe(t),jRe(e,function(n,i,a){bRe(r,i,t(n,i,a))}),r}var kRe=SRe;const ERe=rn(kRe);function CRe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var PRe=CRe,ARe=tC;function TRe(e,t){var r=!0;return ARe(e,function(n,i,a){return r=!!t(n,i,a),r}),r}var ORe=TRe,RRe=PRe,MRe=ORe,DRe=Ud,IRe=ha,$Re=H1;function LRe(e,t,r){var n=IRe(e)?RRe:MRe;return r&&$Re(e,t,r)&&(t=void 0),n(e,DRe(t))}var FRe=LRe;const QH=rn(FRe);var URe=["x","y"];function av(e){"@babel/helpers - typeof";return av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},av(e)}function w5(){return w5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w5.apply(this,arguments)}function mO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function u0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mO(Object(r),!0).forEach(function(n){BRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BRe(e,t,r){return t=zRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zRe(e){var t=VRe(e,"string");return av(t)=="symbol"?t:t+""}function VRe(e,t){if(av(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(av(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qRe(e,t){if(e==null)return{};var r=WRe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function WRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function HRe(e,t){var r=e.x,n=e.y,i=qRe(e,URe),a="".concat(r),o=parseInt(a,10),l="".concat(n),c=parseInt(l,10),d="".concat(t.height||i.height),u=parseInt(d,10),h="".concat(t.width||i.width),f=parseInt(h,10);return u0(u0(u0(u0(u0({},t),i),o?{x:o}:{}),c?{y:c}:{}),{},{height:u,width:f,name:t.name,radius:t.radius})}function pO(e){return Q.createElement(POe,w5({shapeType:"rectangle",propTransformer:HRe,activeClassName:"recharts-active-bar"},e))}var GRe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,i){if(typeof t=="number")return t;var a=_t(n)||gwe(n);return a?t(n,i):(a||rf(),r)}},YRe=["value","background"],eG;function km(e){"@babel/helpers - typeof";return km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},km(e)}function KRe(e,t){if(e==null)return{};var r=ZRe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ZRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function U_(){return U_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U_.apply(this,arguments)}function gO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function xs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gO(Object(r),!0).forEach(function(n){dd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rG(n.key),n)}}function JRe(e,t,r){return t&&vO(e.prototype,t),r&&vO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QRe(e,t,r){return t=B_(t),eMe(e,tG()?Reflect.construct(t,r||[],B_(e).constructor):t.apply(e,r))}function eMe(e,t){if(t&&(km(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tMe(e)}function tMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(tG=function(){return!!e})()}function B_(e){return B_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},B_(e)}function rMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b5(e,t)}function b5(e,t){return b5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},b5(e,t)}function dd(e,t,r){return t=rG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rG(e){var t=nMe(e,"string");return km(t)=="symbol"?t:t+""}function nMe(e,t){if(km(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(km(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ja=function(e){function t(){var r;XRe(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=QRe(this,t,[].concat(i)),dd(r,"state",{isAnimationFinished:!1}),dd(r,"id",fp("recharts-bar-")),dd(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),dd(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return rMe(t,e),JRe(t,[{key:"renderRectanglesStatically",value:function(n){var i=this,a=this.props,o=a.shape,l=a.dataKey,c=a.activeIndex,d=a.activeBar,u=Pr(this.props,!1);return n&&n.map(function(h,f){var p=f===c,x=p?d:o,g=xs(xs(xs({},u),h),{},{isActive:p,option:x,index:f,dataKey:l,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return Q.createElement(Rn,U_({className:"recharts-bar-rectangle"},Q2(i.props,h,f),{key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value,"-").concat(f)}),Q.createElement(pO,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,i=this.props,a=i.data,o=i.layout,l=i.isAnimationActive,c=i.animationBegin,d=i.animationDuration,u=i.animationEasing,h=i.animationId,f=this.state.prevData;return Q.createElement(kl,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var x=p.t,g=a.map(function(v,_){var w=f&&f[_];if(w){var b=ni(w.x,v.x),N=ni(w.y,v.y),S=ni(w.width,v.width),k=ni(w.height,v.height);return xs(xs({},v),{},{x:b(x),y:N(x),width:S(x),height:k(x)})}if(o==="horizontal"){var O=ni(0,v.height),A=O(x);return xs(xs({},v),{},{y:v.y+v.height-A,height:A})}var T=ni(0,v.width),$=T(x);return xs(xs({},v),{},{width:$})});return Q.createElement(Rn,null,n.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var n=this.props,i=n.data,a=n.isAnimationActive,o=this.state.prevData;return a&&i&&i.length&&(!o||!wm(o,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var n=this,i=this.props,a=i.data,o=i.dataKey,l=i.activeIndex,c=Pr(this.props.background,!1);return a.map(function(d,u){d.value;var h=d.background,f=KRe(d,YRe);if(!h)return null;var p=xs(xs(xs(xs(xs({},f),{},{fill:"#eee"},h),c),Q2(n.props,d,u)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:u,className:"recharts-bar-background-rectangle"});return Q.createElement(pO,U_({key:"background-bar-".concat(u),option:n.props.background,isActive:u===l},p))})}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.data,l=a.xAxis,c=a.yAxis,d=a.layout,u=a.children,h=Xa(u,Qv);if(!h)return null;var f=d==="vertical"?o[0].height/2:o[0].width/2,p=function(v,_){var w=Array.isArray(v.value)?v.value[1]:v.value;return{x:v.x,y:v.y,value:w,errorVal:Ii(v,_)}},x={clipPath:n?"url(#clipPath-".concat(i,")"):null};return Q.createElement(Rn,x,h.map(function(g){return Q.cloneElement(g,{key:"error-bar-".concat(i,"-").concat(g.props.dataKey),data:o,xAxis:l,yAxis:c,layout:d,offset:f,dataPointFormatter:p})}))}},{key:"render",value:function(){var n=this.props,i=n.hide,a=n.data,o=n.className,l=n.xAxis,c=n.yAxis,d=n.left,u=n.top,h=n.width,f=n.height,p=n.isAnimationActive,x=n.background,g=n.id;if(i||!a||!a.length)return null;var v=this.state.isAnimationFinished,_=Lr("recharts-bar",o),w=l&&l.allowDataOverflow,b=c&&c.allowDataOverflow,N=w||b,S=Or(g)?this.id:g;return Q.createElement(Rn,{className:_},w||b?Q.createElement("defs",null,Q.createElement("clipPath",{id:"clipPath-".concat(S)},Q.createElement("rect",{x:w?d:d-h/2,y:b?u:u-f/2,width:w?h:h*2,height:b?f:f*2}))):null,Q.createElement(Rn,{className:"recharts-bar-rectangles",clipPath:N?"url(#clipPath-".concat(S,")"):null},x?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(N,S),(!p||v)&&fc.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:i.curData}:n.data!==i.curData?{curData:n.data}:null}}])}(y.PureComponent);eG=ja;dd(ja,"displayName","Bar");dd(ja,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!yl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});dd(ja,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,i=e.bandSize,a=e.xAxis,o=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,d=e.stackedData,u=e.dataStartIndex,h=e.displayedData,f=e.offset,p=LAe(n,r);if(!p)return null;var x=t.layout,g=r.type.defaultProps,v=g!==void 0?xs(xs({},g),r.props):r.props,_=v.dataKey,w=v.children,b=v.minPointSize,N=x==="horizontal"?o:a,S=d?N.scale.domain():null,k=HAe({numericAxis:N}),O=Xa(w,TW),A=h.map(function(T,$){var R,F,D,B,U,V;d?R=FAe(d[u+$],S):(R=Ii(T,_),Array.isArray(R)||(R=[k,R]));var Y=GRe(b,eG.defaultProps.minPointSize)(R[1],$);if(x==="horizontal"){var z,K=[o.scale(R[0]),o.scale(R[1])],Z=K[0],G=K[1];F=gT({axis:a,ticks:l,bandSize:i,offset:p.offset,entry:T,index:$}),D=(z=G!=null?G:Z)!==null&&z!==void 0?z:void 0,B=p.size;var X=Z-G;if(U=Number.isNaN(X)?0:X,V={x:F,y:o.y,width:B,height:o.height},Math.abs(Y)>0&&Math.abs(U)<Math.abs(Y)){var te=Ao(U||Y)*(Math.abs(Y)-Math.abs(U));D-=te,U+=te}}else{var se=[a.scale(R[0]),a.scale(R[1])],ue=se[0],ye=se[1];if(F=ue,D=gT({axis:o,ticks:c,bandSize:i,offset:p.offset,entry:T,index:$}),B=ye-ue,U=p.size,V={x:a.x,y:D,width:a.width,height:U},Math.abs(Y)>0&&Math.abs(B)<Math.abs(Y)){var ne=Ao(B||Y)*(Math.abs(Y)-Math.abs(B));B+=ne}}return xs(xs(xs({},T),{},{x:F,y:D,width:B,height:U,value:d?R:R[1],payload:T,background:V},O&&O[$]&&O[$].props),{},{tooltipPayload:[$H(r,T)],tooltipPosition:{x:F+B/2,y:D+U/2}})});return xs({data:A,layout:x},f)});function ov(e){"@babel/helpers - typeof";return ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ov(e)}function sMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nG(n.key),n)}}function iMe(e,t,r){return t&&xO(e.prototype,t),r&&xO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function yo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yO(Object(r),!0).forEach(function(n){ib(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ib(e,t,r){return t=nG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nG(e){var t=aMe(e,"string");return ov(t)=="symbol"?t:t+""}function aMe(e,t){if(ov(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ov(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AC=function(t,r,n,i,a){var o=t.width,l=t.height,c=t.layout,d=t.children,u=Object.keys(r),h={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},f=!!ya(d,ja);return u.reduce(function(p,x){var g=r[x],v=g.orientation,_=g.domain,w=g.padding,b=w===void 0?{}:w,N=g.mirror,S=g.reversed,k="".concat(v).concat(N?"Mirror":""),O,A,T,$,R;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var F=_[1]-_[0],D=1/0,B=g.categoricalDomain.sort(ywe);if(B.forEach(function(se,ue){ue>0&&(D=Math.min((se||0)-(B[ue-1]||0),D))}),Number.isFinite(D)){var U=D/F,V=g.layout==="vertical"?n.height:n.width;if(g.padding==="gap"&&(O=U*V/2),g.padding==="no-gap"){var Y=ef(t.barCategoryGap,U*V),z=U*V/2;O=z-Y-(z-Y)/V*Y}}}i==="xAxis"?A=[n.left+(b.left||0)+(O||0),n.left+n.width-(b.right||0)-(O||0)]:i==="yAxis"?A=c==="horizontal"?[n.top+n.height-(b.bottom||0),n.top+(b.top||0)]:[n.top+(b.top||0)+(O||0),n.top+n.height-(b.bottom||0)-(O||0)]:A=g.range,S&&(A=[A[1],A[0]]);var K=IAe(g,a,f),Z=K.scale,G=K.realScaleType;Z.domain(_).range(A),$Ae(Z);var X=WAe(Z,yo(yo({},g),{},{realScaleType:G}));i==="xAxis"?(R=v==="top"&&!N||v==="bottom"&&N,T=n.left,$=h[k]-R*g.height):i==="yAxis"&&(R=v==="left"&&!N||v==="right"&&N,T=h[k]-R*g.width,$=n.top);var te=yo(yo(yo({},g),X),{},{realScaleType:G,x:T,y:$,scale:Z,width:i==="xAxis"?n.width:g.width,height:i==="yAxis"?n.height:g.height});return te.bandSize=C_(te,X),!g.hide&&i==="xAxis"?h[k]+=(R?-1:1)*te.height:g.hide||(h[k]+=(R?-1:1)*te.width),yo(yo({},p),{},ib({},x,te))},{})},sG=function(t,r){var n=t.x,i=t.y,a=r.x,o=r.y;return{x:Math.min(n,a),y:Math.min(i,o),width:Math.abs(a-n),height:Math.abs(o-i)}},oMe=function(t){var r=t.x1,n=t.y1,i=t.x2,a=t.y2;return sG({x:r,y:n},{x:i,y:a})},iG=function(){function e(t){sMe(this,e),this.scale=t}return iMe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.bandAware,a=n.position;if(r!==void 0){if(a)switch(a){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(i){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),i=n[0],a=n[n.length-1];return i<=a?r>=i&&r<=a:r>=a&&r<=i}}],[{key:"create",value:function(r){return new e(r)}}])}();ib(iG,"EPS",1e-4);var TC=function(t){var r=Object.keys(t).reduce(function(n,i){return yo(yo({},n),{},ib({},i,iG.create(t[i])))},{});return yo(yo({},r),{},{apply:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=a.bandAware,l=a.position;return ERe(i,function(c,d){return r[d].apply(c,{bandAware:o,position:l})})},isInRange:function(i){return QH(i,function(a,o){return r[o].isInRange(a)})}})};function lMe(e){return(e%180+180)%180}var cMe=function(t){var r=t.width,n=t.height,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=lMe(i),o=a*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},dMe=Ud,uMe=Yv,fMe=q1;function hMe(e){return function(t,r,n){var i=Object(t);if(!uMe(t)){var a=dMe(r);t=fMe(t),r=function(l){return a(i[l],l,i)}}var o=e(t,r,n);return o>-1?i[a?t[o]:o]:void 0}}var mMe=hMe,pMe=KH;function gMe(e){var t=pMe(e),r=t%1;return t===t?r?t-r:t:0}var vMe=gMe,xMe=gW,yMe=Ud,_Me=vMe,wMe=Math.max;function bMe(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var i=r==null?0:_Me(r);return i<0&&(i=wMe(n+i,0)),xMe(e,yMe(t),i)}var jMe=bMe,NMe=mMe,SMe=jMe,kMe=NMe(SMe),EMe=kMe;const CMe=rn(EMe);var PMe=__e(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),OC=y.createContext(void 0),RC=y.createContext(void 0),aG=y.createContext(void 0),oG=y.createContext({}),lG=y.createContext(void 0),cG=y.createContext(0),dG=y.createContext(0),_O=function(t){var r=t.state,n=r.xAxisMap,i=r.yAxisMap,a=r.offset,o=t.clipPathId,l=t.children,c=t.width,d=t.height,u=PMe(a);return Q.createElement(OC.Provider,{value:n},Q.createElement(RC.Provider,{value:i},Q.createElement(oG.Provider,{value:a},Q.createElement(aG.Provider,{value:u},Q.createElement(lG.Provider,{value:o},Q.createElement(cG.Provider,{value:d},Q.createElement(dG.Provider,{value:c},l)))))))},AMe=function(){return y.useContext(lG)},uG=function(t){var r=y.useContext(OC);r==null&&rf();var n=r[t];return n==null&&rf(),n},TMe=function(){var t=y.useContext(OC);return ed(t)},OMe=function(){var t=y.useContext(RC),r=CMe(t,function(n){return QH(n.domain,Number.isFinite)});return r||ed(t)},fG=function(t){var r=y.useContext(RC);r==null&&rf();var n=r[t];return n==null&&rf(),n},RMe=function(){var t=y.useContext(aG);return t},MMe=function(){return y.useContext(oG)},MC=function(){return y.useContext(dG)},DC=function(){return y.useContext(cG)};function Em(e){"@babel/helpers - typeof";return Em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Em(e)}function DMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IMe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mG(n.key),n)}}function $Me(e,t,r){return t&&IMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function LMe(e,t,r){return t=z_(t),FMe(e,hG()?Reflect.construct(t,r||[],z_(e).constructor):t.apply(e,r))}function FMe(e,t){if(t&&(Em(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UMe(e)}function UMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(hG=function(){return!!e})()}function z_(e){return z_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},z_(e)}function BMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j5(e,t)}function j5(e,t){return j5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},j5(e,t)}function wO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function bO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wO(Object(r),!0).forEach(function(n){IC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IC(e,t,r){return t=mG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mG(e){var t=zMe(e,"string");return Em(t)=="symbol"?t:t+""}function zMe(e,t){if(Em(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Em(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VMe(e,t){return GMe(e)||HMe(e,t)||WMe(e,t)||qMe()}function qMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WMe(e,t){if(e){if(typeof e=="string")return jO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jO(e,t)}}function jO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HMe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,d=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,i=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw i}}return l}}function GMe(e){if(Array.isArray(e))return e}function N5(){return N5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},N5.apply(this,arguments)}var YMe=function(t,r){var n;return Q.isValidElement(t)?n=Q.cloneElement(t,r):kr(t)?n=t(r):n=Q.createElement("line",N5({},r,{className:"recharts-reference-line-line"})),n},KMe=function(t,r,n,i,a,o,l,c,d){var u=a.x,h=a.y,f=a.width,p=a.height;if(n){var x=d.y,g=t.y.apply(x,{position:o});if(wl(d,"discard")&&!t.y.isInRange(g))return null;var v=[{x:u+f,y:g},{x:u,y:g}];return c==="left"?v.reverse():v}if(r){var _=d.x,w=t.x.apply(_,{position:o});if(wl(d,"discard")&&!t.x.isInRange(w))return null;var b=[{x:w,y:h+p},{x:w,y:h}];return l==="top"?b.reverse():b}if(i){var N=d.segment,S=N.map(function(k){return t.apply(k,{position:o})});return wl(d,"discard")&&yRe(S,function(k){return!t.isInRange(k)})?null:S}return null};function ZMe(e){var t=e.x,r=e.y,n=e.segment,i=e.xAxisId,a=e.yAxisId,o=e.shape,l=e.className,c=e.alwaysShow,d=AMe(),u=uG(i),h=fG(a),f=RMe();if(!d||!f)return null;dc(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=TC({x:u.scale,y:h.scale}),x=Ms(t),g=Ms(r),v=n&&n.length===2,_=KMe(p,x,g,v,f,e.position,u.orientation,h.orientation,e);if(!_)return null;var w=VMe(_,2),b=w[0],N=b.x,S=b.y,k=w[1],O=k.x,A=k.y,T=wl(e,"hidden")?"url(#".concat(d,")"):void 0,$=bO(bO({clipPath:T},Pr(e,!0)),{},{x1:N,y1:S,x2:O,y2:A});return Q.createElement(Rn,{className:Lr("recharts-reference-line",l)},YMe(o,$),yi.renderCallByParent(e,oMe({x1:N,y1:S,x2:O,y2:A})))}var $C=function(e){function t(){return DMe(this,t),LMe(this,t,arguments)}return BMe(t,e),$Me(t,[{key:"render",value:function(){return Q.createElement(ZMe,this.props)}}])}(Q.Component);IC($C,"displayName","ReferenceLine");IC($C,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function S5(){return S5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S5.apply(this,arguments)}function Cm(e){"@babel/helpers - typeof";return Cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cm(e)}function NO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function SO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NO(Object(r),!0).forEach(function(n){ab(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JMe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gG(n.key),n)}}function QMe(e,t,r){return t&&JMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function eDe(e,t,r){return t=V_(t),tDe(e,pG()?Reflect.construct(t,r||[],V_(e).constructor):t.apply(e,r))}function tDe(e,t){if(t&&(Cm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rDe(e)}function rDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(pG=function(){return!!e})()}function V_(e){return V_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},V_(e)}function nDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k5(e,t)}function k5(e,t){return k5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},k5(e,t)}function ab(e,t,r){return t=gG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gG(e){var t=sDe(e,"string");return Cm(t)=="symbol"?t:t+""}function sDe(e,t){if(Cm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iDe=function(t){var r=t.x,n=t.y,i=t.xAxis,a=t.yAxis,o=TC({x:i.scale,y:a.scale}),l=o.apply({x:r,y:n},{bandAware:!0});return wl(t,"discard")&&!o.isInRange(l)?null:l},ob=function(e){function t(){return XMe(this,t),eDe(this,t,arguments)}return nDe(t,e),QMe(t,[{key:"render",value:function(){var n=this.props,i=n.x,a=n.y,o=n.r,l=n.alwaysShow,c=n.clipPathId,d=Ms(i),u=Ms(a);if(dc(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!d||!u)return null;var h=iDe(this.props);if(!h)return null;var f=h.x,p=h.y,x=this.props,g=x.shape,v=x.className,_=wl(this.props,"hidden")?"url(#".concat(c,")"):void 0,w=SO(SO({clipPath:_},Pr(this.props,!0)),{},{cx:f,cy:p});return Q.createElement(Rn,{className:Lr("recharts-reference-dot",v)},t.renderDot(g,w),yi.renderCallByParent(this.props,{x:f-o,y:p-o,width:2*o,height:2*o}))}}])}(Q.Component);ab(ob,"displayName","ReferenceDot");ab(ob,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});ab(ob,"renderDot",function(e,t){var r;return Q.isValidElement(e)?r=Q.cloneElement(e,t):kr(e)?r=e(t):r=Q.createElement(rb,S5({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function E5(){return E5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},E5.apply(this,arguments)}function Pm(e){"@babel/helpers - typeof";return Pm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pm(e)}function kO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function EO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kO(Object(r),!0).forEach(function(n){lb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oDe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xG(n.key),n)}}function lDe(e,t,r){return t&&oDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cDe(e,t,r){return t=q_(t),dDe(e,vG()?Reflect.construct(t,r||[],q_(e).constructor):t.apply(e,r))}function dDe(e,t){if(t&&(Pm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uDe(e)}function uDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(vG=function(){return!!e})()}function q_(e){return q_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},q_(e)}function fDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C5(e,t)}function C5(e,t){return C5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},C5(e,t)}function lb(e,t,r){return t=xG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xG(e){var t=hDe(e,"string");return Pm(t)=="symbol"?t:t+""}function hDe(e,t){if(Pm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mDe=function(t,r,n,i,a){var o=a.x1,l=a.x2,c=a.y1,d=a.y2,u=a.xAxis,h=a.yAxis;if(!u||!h)return null;var f=TC({x:u.scale,y:h.scale}),p={x:t?f.x.apply(o,{position:"start"}):f.x.rangeMin,y:n?f.y.apply(c,{position:"start"}):f.y.rangeMin},x={x:r?f.x.apply(l,{position:"end"}):f.x.rangeMax,y:i?f.y.apply(d,{position:"end"}):f.y.rangeMax};return wl(a,"discard")&&(!f.isInRange(p)||!f.isInRange(x))?null:sG(p,x)},cb=function(e){function t(){return aDe(this,t),cDe(this,t,arguments)}return fDe(t,e),lDe(t,[{key:"render",value:function(){var n=this.props,i=n.x1,a=n.x2,o=n.y1,l=n.y2,c=n.className,d=n.alwaysShow,u=n.clipPathId;dc(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=Ms(i),f=Ms(a),p=Ms(o),x=Ms(l),g=this.props.shape;if(!h&&!f&&!p&&!x&&!g)return null;var v=mDe(h,f,p,x,this.props);if(!v&&!g)return null;var _=wl(this.props,"hidden")?"url(#".concat(u,")"):void 0;return Q.createElement(Rn,{className:Lr("recharts-reference-area",c)},t.renderRect(g,EO(EO({clipPath:_},Pr(this.props,!0)),v)),yi.renderCallByParent(this.props,v))}}])}(Q.Component);lb(cb,"displayName","ReferenceArea");lb(cb,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});lb(cb,"renderRect",function(e,t){var r;return Q.isValidElement(e)?r=Q.cloneElement(e,t):kr(e)?r=e(t):r=Q.createElement(PC,E5({},t,{className:"recharts-reference-area-rect"})),r});function yG(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],i=0;i<e.length;i+=t)n.push(e[i]);return n}function pDe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return cMe(n,r)}function gDe(e,t,r){var n=r==="width",i=e.x,a=e.y,o=e.width,l=e.height;return t===1?{start:n?i:a,end:n?i+o:a+l}:{start:n?i+o:a+l,end:n?i:a}}function W_(e,t,r,n,i){if(e*t<e*n||e*t>e*i)return!1;var a=r();return e*(t-e*a/2-n)>=0&&e*(t+e*a/2-i)<=0}function vDe(e,t){return yG(e,t+1)}function xDe(e,t,r,n,i){for(var a=(n||[]).slice(),o=t.start,l=t.end,c=0,d=1,u=o,h=function(){var x=n==null?void 0:n[c];if(x===void 0)return{v:yG(n,d)};var g=c,v,_=function(){return v===void 0&&(v=r(x,g)),v},w=x.coordinate,b=c===0||W_(e,w,_,u,l);b||(c=0,u=o,d+=1),b&&(u=w+e*(_()/2+i),c+=d)},f;d<=a.length;)if(f=h(),f)return f.v;return[]}function lv(e){"@babel/helpers - typeof";return lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lv(e)}function CO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function gi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CO(Object(r),!0).forEach(function(n){yDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yDe(e,t,r){return t=_De(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _De(e){var t=wDe(e,"string");return lv(t)=="symbol"?t:t+""}function wDe(e,t){if(lv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bDe(e,t,r,n,i){for(var a=(n||[]).slice(),o=a.length,l=t.start,c=t.end,d=function(f){var p=a[f],x,g=function(){return x===void 0&&(x=r(p,f)),x};if(f===o-1){var v=e*(p.coordinate+e*g()/2-c);a[f]=p=gi(gi({},p),{},{tickCoord:v>0?p.coordinate-v*e:p.coordinate})}else a[f]=p=gi(gi({},p),{},{tickCoord:p.coordinate});var _=W_(e,p.tickCoord,g,l,c);_&&(c=p.tickCoord-e*(g()/2+i),a[f]=gi(gi({},p),{},{isShow:!0}))},u=o-1;u>=0;u--)d(u);return a}function jDe(e,t,r,n,i,a){var o=(n||[]).slice(),l=o.length,c=t.start,d=t.end;if(a){var u=n[l-1],h=r(u,l-1),f=e*(u.coordinate+e*h/2-d);o[l-1]=u=gi(gi({},u),{},{tickCoord:f>0?u.coordinate-f*e:u.coordinate});var p=W_(e,u.tickCoord,function(){return h},c,d);p&&(d=u.tickCoord-e*(h/2+i),o[l-1]=gi(gi({},u),{},{isShow:!0}))}for(var x=a?l-1:l,g=function(w){var b=o[w],N,S=function(){return N===void 0&&(N=r(b,w)),N};if(w===0){var k=e*(b.coordinate-e*S()/2-c);o[w]=b=gi(gi({},b),{},{tickCoord:k<0?b.coordinate-k*e:b.coordinate})}else o[w]=b=gi(gi({},b),{},{tickCoord:b.coordinate});var O=W_(e,b.tickCoord,S,c,d);O&&(c=b.tickCoord+e*(S()/2+i),o[w]=gi(gi({},b),{},{isShow:!0}))},v=0;v<x;v++)g(v);return o}function LC(e,t,r){var n=e.tick,i=e.ticks,a=e.viewBox,o=e.minTickGap,l=e.orientation,c=e.interval,d=e.tickFormatter,u=e.unit,h=e.angle;if(!i||!i.length||!n)return[];if(_t(c)||yl.isSsr)return vDe(i,typeof c=="number"&&_t(c)?c:0);var f=[],p=l==="top"||l==="bottom"?"width":"height",x=u&&p==="width"?L0(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=function(b,N){var S=kr(d)?d(b.value,N):b.value;return p==="width"?pDe(L0(S,{fontSize:t,letterSpacing:r}),x,h):L0(S,{fontSize:t,letterSpacing:r})[p]},v=i.length>=2?Ao(i[1].coordinate-i[0].coordinate):1,_=gDe(a,v,p);return c==="equidistantPreserveStart"?xDe(v,_,g,i,o):(c==="preserveStart"||c==="preserveStartEnd"?f=jDe(v,_,g,i,o,c==="preserveStartEnd"):f=bDe(v,_,g,i,o),f.filter(function(w){return w.isShow}))}var NDe=["viewBox"],SDe=["viewBox"],kDe=["ticks"];function Am(e){"@babel/helpers - typeof";return Am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Am(e)}function ph(){return ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ph.apply(this,arguments)}function PO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ss(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PO(Object(r),!0).forEach(function(n){FC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mN(e,t){if(e==null)return{};var r=EDe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function EDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function CDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wG(n.key),n)}}function PDe(e,t,r){return t&&AO(e.prototype,t),r&&AO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ADe(e,t,r){return t=H_(t),TDe(e,_G()?Reflect.construct(t,r||[],H_(e).constructor):t.apply(e,r))}function TDe(e,t){if(t&&(Am(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ODe(e)}function ODe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _G(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_G=function(){return!!e})()}function H_(e){return H_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},H_(e)}function RDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P5(e,t)}function P5(e,t){return P5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},P5(e,t)}function FC(e,t,r){return t=wG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wG(e){var t=MDe(e,"string");return Am(t)=="symbol"?t:t+""}function MDe(e,t){if(Am(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Am(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yp=function(e){function t(r){var n;return CDe(this,t),n=ADe(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return RDe(t,e),PDe(t,[{key:"shouldComponentUpdate",value:function(n,i){var a=n.viewBox,o=mN(n,NDe),l=this.props,c=l.viewBox,d=mN(l,SDe);return!Mh(a,c)||!Mh(o,d)||!Mh(i,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var i=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var i=this.props,a=i.x,o=i.y,l=i.width,c=i.height,d=i.orientation,u=i.tickSize,h=i.mirror,f=i.tickMargin,p,x,g,v,_,w,b=h?-1:1,N=n.tickSize||u,S=_t(n.tickCoord)?n.tickCoord:n.coordinate;switch(d){case"top":p=x=n.coordinate,v=o+ +!h*c,g=v-b*N,w=g-b*f,_=S;break;case"left":g=v=n.coordinate,x=a+ +!h*l,p=x-b*N,_=p-b*f,w=S;break;case"right":g=v=n.coordinate,x=a+ +h*l,p=x+b*N,_=p+b*f,w=S;break;default:p=x=n.coordinate,v=o+ +h*c,g=v+b*N,w=g+b*f,_=S;break}return{line:{x1:p,y1:g,x2:x,y2:v},tick:{x:_,y:w}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,i=n.orientation,a=n.mirror,o;switch(i){case"left":o=a?"start":"end";break;case"right":o=a?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,i=n.orientation,a=n.mirror,o="end";switch(i){case"left":case"right":o="middle";break;case"top":o=a?"start":"end";break;default:o=a?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.x,a=n.y,o=n.width,l=n.height,c=n.orientation,d=n.mirror,u=n.axisLine,h=Ss(Ss(Ss({},Pr(this.props,!1)),Pr(u,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var f=+(c==="top"&&!d||c==="bottom"&&d);h=Ss(Ss({},h),{},{x1:i,y1:a+f*l,x2:i+o,y2:a+f*l})}else{var p=+(c==="left"&&!d||c==="right"&&d);h=Ss(Ss({},h),{},{x1:i+p*o,y1:a,x2:i+p*o,y2:a+l})}return Q.createElement("line",ph({},h,{className:Lr("recharts-cartesian-axis-line",Za(u,"className"))}))}},{key:"renderTicks",value:function(n,i,a){var o=this,l=this.props,c=l.tickLine,d=l.stroke,u=l.tick,h=l.tickFormatter,f=l.unit,p=LC(Ss(Ss({},this.props),{},{ticks:n}),i,a),x=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),v=Pr(this.props,!1),_=Pr(u,!1),w=Ss(Ss({},v),{},{fill:"none"},Pr(c,!1)),b=p.map(function(N,S){var k=o.getTickLineCoord(N),O=k.line,A=k.tick,T=Ss(Ss(Ss(Ss({textAnchor:x,verticalAnchor:g},v),{},{stroke:"none",fill:d},_),A),{},{index:S,payload:N,visibleTicksCount:p.length,tickFormatter:h});return Q.createElement(Rn,ph({className:"recharts-cartesian-axis-tick",key:"tick-".concat(N.value,"-").concat(N.coordinate,"-").concat(N.tickCoord)},Q2(o.props,N,S)),c&&Q.createElement("line",ph({},w,O,{className:Lr("recharts-cartesian-axis-tick-line",Za(c,"className"))})),u&&t.renderTickItem(u,T,"".concat(kr(h)?h(N.value,S):N.value).concat(f||"")))});return Q.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var n=this,i=this.props,a=i.axisLine,o=i.width,l=i.height,c=i.ticksGenerator,d=i.className,u=i.hide;if(u)return null;var h=this.props,f=h.ticks,p=mN(h,kDe),x=f;return kr(c)&&(x=f&&f.length>0?c(this.props):c(p)),o<=0||l<=0||!x||!x.length?null:Q.createElement(Rn,{className:Lr("recharts-cartesian-axis",d),ref:function(v){n.layerReference=v}},a&&this.renderAxisLine(),this.renderTicks(x,this.state.fontSize,this.state.letterSpacing),yi.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,i,a){var o,l=Lr(i.className,"recharts-cartesian-axis-tick-value");return Q.isValidElement(n)?o=Q.cloneElement(n,Ss(Ss({},i),{},{className:l})):kr(n)?o=n(Ss(Ss({},i),{},{className:l})):o=Q.createElement(h_,ph({},i,{className:"recharts-cartesian-axis-tick-value"}),a),o}}])}(y.Component);FC(yp,"displayName","CartesianAxis");FC(yp,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var DDe=["x1","y1","x2","y2","key"],IDe=["offset"];function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function TO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _i(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TO(Object(r),!0).forEach(function(n){$De(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $De(e,t,r){return t=LDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LDe(e){var t=FDe(e,"string");return nf(t)=="symbol"?t:t+""}function FDe(e,t){if(nf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xu(){return xu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xu.apply(this,arguments)}function OO(e,t){if(e==null)return{};var r=UDe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function UDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var BDe=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,i=t.x,a=t.y,o=t.width,l=t.height,c=t.ry;return Q.createElement("rect",{x:i,y:a,ry:c,width:o,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function bG(e,t){var r;if(Q.isValidElement(e))r=Q.cloneElement(e,t);else if(kr(e))r=e(t);else{var n=t.x1,i=t.y1,a=t.x2,o=t.y2,l=t.key,c=OO(t,DDe),d=Pr(c,!1);d.offset;var u=OO(d,IDe);r=Q.createElement("line",xu({},u,{x1:n,y1:i,x2:a,y2:o,fill:"none",key:l}))}return r}function zDe(e){var t=e.x,r=e.width,n=e.horizontal,i=n===void 0?!0:n,a=e.horizontalPoints;if(!i||!a||!a.length)return null;var o=a.map(function(l,c){var d=_i(_i({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return bG(i,d)});return Q.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function VDe(e){var t=e.y,r=e.height,n=e.vertical,i=n===void 0?!0:n,a=e.verticalPoints;if(!i||!a||!a.length)return null;var o=a.map(function(l,c){var d=_i(_i({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return bG(i,d)});return Q.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function qDe(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,i=e.y,a=e.width,o=e.height,l=e.horizontalPoints,c=e.horizontal,d=c===void 0?!0:c;if(!d||!t||!t.length)return null;var u=l.map(function(f){return Math.round(f+i-i)}).sort(function(f,p){return f-p});i!==u[0]&&u.unshift(0);var h=u.map(function(f,p){var x=!u[p+1],g=x?i+o-f:u[p+1]-f;if(g<=0)return null;var v=p%t.length;return Q.createElement("rect",{key:"react-".concat(p),y:f,x:n,height:g,width:a,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Q.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function WDe(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,i=e.fillOpacity,a=e.x,o=e.y,l=e.width,c=e.height,d=e.verticalPoints;if(!r||!n||!n.length)return null;var u=d.map(function(f){return Math.round(f+a-a)}).sort(function(f,p){return f-p});a!==u[0]&&u.unshift(0);var h=u.map(function(f,p){var x=!u[p+1],g=x?a+l-f:u[p+1]-f;if(g<=0)return null;var v=p%n.length;return Q.createElement("rect",{key:"react-".concat(p),x:f,y:o,width:g,height:c,stroke:"none",fill:n[v],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return Q.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var HDe=function(t,r){var n=t.xAxis,i=t.width,a=t.height,o=t.offset;return DH(LC(_i(_i(_i({},yp.defaultProps),n),{},{ticks:oc(n,!0),viewBox:{x:0,y:0,width:i,height:a}})),o.left,o.left+o.width,r)},GDe=function(t,r){var n=t.yAxis,i=t.width,a=t.height,o=t.offset;return DH(LC(_i(_i(_i({},yp.defaultProps),n),{},{ticks:oc(n,!0),viewBox:{x:0,y:0,width:i,height:a}})),o.top,o.top+o.height,r)},qf={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Xo(e){var t,r,n,i,a,o,l=MC(),c=DC(),d=MMe(),u=_i(_i({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:qf.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:qf.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:qf.horizontal,horizontalFill:(i=e.horizontalFill)!==null&&i!==void 0?i:qf.horizontalFill,vertical:(a=e.vertical)!==null&&a!==void 0?a:qf.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:qf.verticalFill,x:_t(e.x)?e.x:d.left,y:_t(e.y)?e.y:d.top,width:_t(e.width)?e.width:d.width,height:_t(e.height)?e.height:d.height}),h=u.x,f=u.y,p=u.width,x=u.height,g=u.syncWithTicks,v=u.horizontalValues,_=u.verticalValues,w=TMe(),b=OMe();if(!_t(p)||p<=0||!_t(x)||x<=0||!_t(h)||h!==+h||!_t(f)||f!==+f)return null;var N=u.verticalCoordinatesGenerator||HDe,S=u.horizontalCoordinatesGenerator||GDe,k=u.horizontalPoints,O=u.verticalPoints;if((!k||!k.length)&&kr(S)){var A=v&&v.length,T=S({yAxis:b?_i(_i({},b),{},{ticks:A?v:b.ticks}):void 0,width:l,height:c,offset:d},A?!0:g);dc(Array.isArray(T),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(nf(T),"]")),Array.isArray(T)&&(k=T)}if((!O||!O.length)&&kr(N)){var $=_&&_.length,R=N({xAxis:w?_i(_i({},w),{},{ticks:$?_:w.ticks}):void 0,width:l,height:c,offset:d},$?!0:g);dc(Array.isArray(R),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(nf(R),"]")),Array.isArray(R)&&(O=R)}return Q.createElement("g",{className:"recharts-cartesian-grid"},Q.createElement(BDe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),Q.createElement(zDe,xu({},u,{offset:d,horizontalPoints:k,xAxis:w,yAxis:b})),Q.createElement(VDe,xu({},u,{offset:d,verticalPoints:O,xAxis:w,yAxis:b})),Q.createElement(qDe,xu({},u,{horizontalPoints:k})),Q.createElement(WDe,xu({},u,{verticalPoints:O})))}Xo.displayName="CartesianGrid";var YDe=["type","layout","connectNulls","ref"],KDe=["key"];function Tm(e){"@babel/helpers - typeof";return Tm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tm(e)}function RO(e,t){if(e==null)return{};var r=ZDe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ZDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function z0(){return z0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},z0.apply(this,arguments)}function MO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MO(Object(r),!0).forEach(function(n){_o(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wf(e){return eIe(e)||QDe(e)||JDe(e)||XDe()}function XDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JDe(e,t){if(e){if(typeof e=="string")return A5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A5(e,t)}}function QDe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eIe(e){if(Array.isArray(e))return A5(e)}function A5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NG(n.key),n)}}function rIe(e,t,r){return t&&DO(e.prototype,t),r&&DO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nIe(e,t,r){return t=G_(t),sIe(e,jG()?Reflect.construct(t,r||[],G_(e).constructor):t.apply(e,r))}function sIe(e,t){if(t&&(Tm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iIe(e)}function iIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(jG=function(){return!!e})()}function G_(e){return G_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},G_(e)}function aIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T5(e,t)}function T5(e,t){return T5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},T5(e,t)}function _o(e,t,r){return t=NG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NG(e){var t=oIe(e,"string");return Tm(t)=="symbol"?t:t+""}function oIe(e,t){if(Tm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Om=function(e){function t(){var r;tIe(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=nIe(this,t,[].concat(i)),_o(r,"state",{isAnimationFinished:!0,totalLength:0}),_o(r,"generateSimpleStrokeDasharray",function(o,l){return"".concat(l,"px ").concat(o-l,"px")}),_o(r,"getStrokeDasharray",function(o,l,c){var d=c.reduce(function(_,w){return _+w});if(!d)return r.generateSimpleStrokeDasharray(l,o);for(var u=Math.floor(o/d),h=o%d,f=l-o,p=[],x=0,g=0;x<c.length;g+=c[x],++x)if(g+c[x]>h){p=[].concat(Wf(c.slice(0,x)),[h-g]);break}var v=p.length%2===0?[0,f]:[f];return[].concat(Wf(t.repeat(c,u)),Wf(p),v).map(function(_){return"".concat(_,"px")}).join(", ")}),_o(r,"id",fp("recharts-line-")),_o(r,"pathRef",function(o){r.mainCurve=o}),_o(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),_o(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return aIe(t,e),rIe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch(i){return 0}}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.points,l=a.xAxis,c=a.yAxis,d=a.layout,u=a.children,h=Xa(u,Qv);if(!h)return null;var f=function(g,v){return{x:g.x,y:g.y,value:g.value,errorVal:Ii(g.payload,v)}},p={clipPath:n?"url(#clipPath-".concat(i,")"):null};return Q.createElement(Rn,p,h.map(function(x){return Q.cloneElement(x,{key:"bar-".concat(x.props.dataKey),data:o,xAxis:l,yAxis:c,layout:d,dataPointFormatter:f})}))}},{key:"renderDots",value:function(n,i,a){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,d=l.points,u=l.dataKey,h=Pr(this.props,!1),f=Pr(c,!0),p=d.map(function(g,v){var _=pa(pa(pa({key:"dot-".concat(v),r:3},h),f),{},{index:v,cx:g.x,cy:g.y,value:g.value,dataKey:u,payload:g.payload,points:d});return t.renderDotItem(c,_)}),x={clipPath:n?"url(#clipPath-".concat(i?"":"dots-").concat(a,")"):null};return Q.createElement(Rn,z0({className:"recharts-line-dots",key:"dots"},x),p)}},{key:"renderCurveStatically",value:function(n,i,a,o){var l=this.props,c=l.type,d=l.layout,u=l.connectNulls;l.ref;var h=RO(l,YDe),f=pa(pa(pa({},Pr(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(a,")"):null,points:n},o),{},{type:c,layout:d,connectNulls:u});return Q.createElement($h,z0({},f,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,i){var a=this,o=this.props,l=o.points,c=o.strokeDasharray,d=o.isAnimationActive,u=o.animationBegin,h=o.animationDuration,f=o.animationEasing,p=o.animationId,x=o.animateNewValues,g=o.width,v=o.height,_=this.state,w=_.prevPoints,b=_.totalLength;return Q.createElement(kl,{begin:u,duration:h,isActive:d,easing:f,from:{t:0},to:{t:1},key:"line-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(N){var S=N.t;if(w){var k=w.length/l.length,O=l.map(function(F,D){var B=Math.floor(D*k);if(w[B]){var U=w[B],V=ni(U.x,F.x),Y=ni(U.y,F.y);return pa(pa({},F),{},{x:V(S),y:Y(S)})}if(x){var z=ni(g*2,F.x),K=ni(v/2,F.y);return pa(pa({},F),{},{x:z(S),y:K(S)})}return pa(pa({},F),{},{x:F.x,y:F.y})});return a.renderCurveStatically(O,n,i)}var A=ni(0,b),T=A(S),$;if(c){var R="".concat(c).split(/[,\s]+/gim).map(function(F){return parseFloat(F)});$=a.getStrokeDasharray(T,b,R)}else $=a.generateSimpleStrokeDasharray(b,T);return a.renderCurveStatically(l,n,i,{strokeDasharray:$})})}},{key:"renderCurve",value:function(n,i){var a=this.props,o=a.points,l=a.isAnimationActive,c=this.state,d=c.prevPoints,u=c.totalLength;return l&&o&&o.length&&(!d&&u>0||!wm(d,o))?this.renderCurveWithAnimation(n,i):this.renderCurveStatically(o,n,i)}},{key:"render",value:function(){var n,i=this.props,a=i.hide,o=i.dot,l=i.points,c=i.className,d=i.xAxis,u=i.yAxis,h=i.top,f=i.left,p=i.width,x=i.height,g=i.isAnimationActive,v=i.id;if(a||!l||!l.length)return null;var _=this.state.isAnimationFinished,w=l.length===1,b=Lr("recharts-line",c),N=d&&d.allowDataOverflow,S=u&&u.allowDataOverflow,k=N||S,O=Or(v)?this.id:v,A=(n=Pr(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},T=A.r,$=T===void 0?3:T,R=A.strokeWidth,F=R===void 0?2:R,D=Eq(o)?o:{},B=D.clipDot,U=B===void 0?!0:B,V=$*2+F;return Q.createElement(Rn,{className:b},N||S?Q.createElement("defs",null,Q.createElement("clipPath",{id:"clipPath-".concat(O)},Q.createElement("rect",{x:N?f:f-p/2,y:S?h:h-x/2,width:N?p:p*2,height:S?x:x*2})),!U&&Q.createElement("clipPath",{id:"clipPath-dots-".concat(O)},Q.createElement("rect",{x:f-V/2,y:h-V/2,width:p+V,height:x+V}))):null,!w&&this.renderCurve(k,O),this.renderErrorBar(k,O),(w||o)&&this.renderDots(k,U,O),(!g||_)&&fc.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:i.curPoints}:n.points!==i.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,i){for(var a=n.length%2!==0?[].concat(Wf(n),[0]):n,o=[],l=0;l<i;++l)o=[].concat(Wf(o),Wf(a));return o}},{key:"renderDotItem",value:function(n,i){var a;if(Q.isValidElement(n))a=Q.cloneElement(n,i);else if(kr(n))a=n(i);else{var o=i.key,l=RO(i,KDe),c=Lr("recharts-line-dot",typeof n!="boolean"?n.className:"");a=Q.createElement(rb,z0({key:o},l,{className:c}))}return a}}])}(y.PureComponent);_o(Om,"displayName","Line");_o(Om,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!yl.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});_o(Om,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,i=e.xAxisTicks,a=e.yAxisTicks,o=e.dataKey,l=e.bandSize,c=e.displayedData,d=e.offset,u=t.layout,h=c.map(function(f,p){var x=Ii(f,o);return u==="horizontal"?{x:E_({axis:r,ticks:i,bandSize:l,entry:f,index:p}),y:Or(x)?null:n.scale(x),value:x,payload:f}:{x:Or(x)?null:r.scale(x),y:E_({axis:n,ticks:a,bandSize:l,entry:f,index:p}),value:x,payload:f}});return pa({points:h,layout:u},d)});var lIe=["layout","type","stroke","connectNulls","isRange","ref"],cIe=["key"],SG;function Rm(e){"@babel/helpers - typeof";return Rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rm(e)}function kG(e,t){if(e==null)return{};var r=dIe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function dIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function yu(){return yu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yu.apply(this,arguments)}function IO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Hc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IO(Object(r),!0).forEach(function(n){pl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CG(n.key),n)}}function fIe(e,t,r){return t&&$O(e.prototype,t),r&&$O(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hIe(e,t,r){return t=Y_(t),mIe(e,EG()?Reflect.construct(t,r||[],Y_(e).constructor):t.apply(e,r))}function mIe(e,t){if(t&&(Rm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pIe(e)}function pIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(EG=function(){return!!e})()}function Y_(e){return Y_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Y_(e)}function gIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O5(e,t)}function O5(e,t){return O5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},O5(e,t)}function pl(e,t,r){return t=CG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CG(e){var t=vIe(e,"string");return Rm(t)=="symbol"?t:t+""}function vIe(e,t){if(Rm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sc=function(e){function t(){var r;uIe(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=hIe(this,t,[].concat(i)),pl(r,"state",{isAnimationFinished:!0}),pl(r,"id",fp("recharts-area-")),pl(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),kr(o)&&o()}),pl(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),kr(o)&&o()}),r}return gIe(t,e),fIe(t,[{key:"renderDots",value:function(n,i,a){var o=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(o&&!l)return null;var c=this.props,d=c.dot,u=c.points,h=c.dataKey,f=Pr(this.props,!1),p=Pr(d,!0),x=u.map(function(v,_){var w=Hc(Hc(Hc({key:"dot-".concat(_),r:3},f),p),{},{index:_,cx:v.x,cy:v.y,dataKey:h,value:v.value,payload:v.payload,points:u});return t.renderDotItem(d,w)}),g={clipPath:n?"url(#clipPath-".concat(i?"":"dots-").concat(a,")"):null};return Q.createElement(Rn,yu({className:"recharts-area-dots"},g),x)}},{key:"renderHorizontalRect",value:function(n){var i=this.props,a=i.baseLine,o=i.points,l=i.strokeWidth,c=o[0].x,d=o[o.length-1].x,u=n*Math.abs(c-d),h=cd(o.map(function(f){return f.y||0}));return _t(a)&&typeof a=="number"?h=Math.max(a,h):a&&Array.isArray(a)&&a.length&&(h=Math.max(cd(a.map(function(f){return f.y||0})),h)),_t(h)?Q.createElement("rect",{x:c<d?c:c-u,y:0,width:u,height:Math.floor(h+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var i=this.props,a=i.baseLine,o=i.points,l=i.strokeWidth,c=o[0].y,d=o[o.length-1].y,u=n*Math.abs(c-d),h=cd(o.map(function(f){return f.x||0}));return _t(a)&&typeof a=="number"?h=Math.max(a,h):a&&Array.isArray(a)&&a.length&&(h=Math.max(cd(a.map(function(f){return f.x||0})),h)),_t(h)?Q.createElement("rect",{x:0,y:c<d?c:c-u,width:h+(l?parseInt("".concat(l),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(n){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,i,a,o){var l=this.props,c=l.layout,d=l.type,u=l.stroke,h=l.connectNulls,f=l.isRange;l.ref;var p=kG(l,lIe);return Q.createElement(Rn,{clipPath:a?"url(#clipPath-".concat(o,")"):null},Q.createElement($h,yu({},Pr(p,!0),{points:n,connectNulls:h,type:d,baseLine:i,layout:c,stroke:"none",className:"recharts-area-area"})),u!=="none"&&Q.createElement($h,yu({},Pr(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:h,fill:"none",points:n})),u!=="none"&&f&&Q.createElement($h,yu({},Pr(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:h,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(n,i){var a=this,o=this.props,l=o.points,c=o.baseLine,d=o.isAnimationActive,u=o.animationBegin,h=o.animationDuration,f=o.animationEasing,p=o.animationId,x=this.state,g=x.prevPoints,v=x.prevBaseLine;return Q.createElement(kl,{begin:u,duration:h,isActive:d,easing:f,from:{t:0},to:{t:1},key:"area-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(_){var w=_.t;if(g){var b=g.length/l.length,N=l.map(function(A,T){var $=Math.floor(T*b);if(g[$]){var R=g[$],F=ni(R.x,A.x),D=ni(R.y,A.y);return Hc(Hc({},A),{},{x:F(w),y:D(w)})}return A}),S;if(_t(c)&&typeof c=="number"){var k=ni(v,c);S=k(w)}else if(Or(c)||up(c)){var O=ni(v,0);S=O(w)}else S=c.map(function(A,T){var $=Math.floor(T*b);if(v[$]){var R=v[$],F=ni(R.x,A.x),D=ni(R.y,A.y);return Hc(Hc({},A),{},{x:F(w),y:D(w)})}return A});return a.renderAreaStatically(N,S,n,i)}return Q.createElement(Rn,null,Q.createElement("defs",null,Q.createElement("clipPath",{id:"animationClipPath-".concat(i)},a.renderClipRect(w))),Q.createElement(Rn,{clipPath:"url(#animationClipPath-".concat(i,")")},a.renderAreaStatically(l,c,n,i)))})}},{key:"renderArea",value:function(n,i){var a=this.props,o=a.points,l=a.baseLine,c=a.isAnimationActive,d=this.state,u=d.prevPoints,h=d.prevBaseLine,f=d.totalLength;return c&&o&&o.length&&(!u&&f>0||!wm(u,o)||!wm(h,l))?this.renderAreaWithAnimation(n,i):this.renderAreaStatically(o,l,n,i)}},{key:"render",value:function(){var n,i=this.props,a=i.hide,o=i.dot,l=i.points,c=i.className,d=i.top,u=i.left,h=i.xAxis,f=i.yAxis,p=i.width,x=i.height,g=i.isAnimationActive,v=i.id;if(a||!l||!l.length)return null;var _=this.state.isAnimationFinished,w=l.length===1,b=Lr("recharts-area",c),N=h&&h.allowDataOverflow,S=f&&f.allowDataOverflow,k=N||S,O=Or(v)?this.id:v,A=(n=Pr(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},T=A.r,$=T===void 0?3:T,R=A.strokeWidth,F=R===void 0?2:R,D=Eq(o)?o:{},B=D.clipDot,U=B===void 0?!0:B,V=$*2+F;return Q.createElement(Rn,{className:b},N||S?Q.createElement("defs",null,Q.createElement("clipPath",{id:"clipPath-".concat(O)},Q.createElement("rect",{x:N?u:u-p/2,y:S?d:d-x/2,width:N?p:p*2,height:S?x:x*2})),!U&&Q.createElement("clipPath",{id:"clipPath-dots-".concat(O)},Q.createElement("rect",{x:u-V/2,y:d-V/2,width:p+V,height:x+V}))):null,w?null:this.renderArea(k,O),(o||w)&&this.renderDots(k,U,O),(!g||_)&&fc.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:n.points!==i.curPoints||n.baseLine!==i.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(y.PureComponent);SG=Sc;pl(Sc,"displayName","Area");pl(Sc,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!yl.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});pl(Sc,"getBaseValue",function(e,t,r,n){var i=e.layout,a=e.baseValue,o=t.props.baseValue,l=o!=null?o:a;if(_t(l)&&typeof l=="number")return l;var c=i==="horizontal"?n:r,d=c.scale.domain();if(c.type==="number"){var u=Math.max(d[0],d[1]),h=Math.min(d[0],d[1]);return l==="dataMin"?h:l==="dataMax"||u<0?u:Math.max(Math.min(d[0],d[1]),0)}return l==="dataMin"?d[0]:l==="dataMax"?d[1]:d[0]});pl(Sc,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,i=e.yAxis,a=e.xAxisTicks,o=e.yAxisTicks,l=e.bandSize,c=e.dataKey,d=e.stackedData,u=e.dataStartIndex,h=e.displayedData,f=e.offset,p=t.layout,x=d&&d.length,g=SG.getBaseValue(t,r,n,i),v=p==="horizontal",_=!1,w=h.map(function(N,S){var k;x?k=d[u+S]:(k=Ii(N,c),Array.isArray(k)?_=!0:k=[g,k]);var O=k[1]==null||x&&Ii(N,c)==null;return v?{x:E_({axis:n,ticks:a,bandSize:l,entry:N,index:S}),y:O?null:i.scale(k[1]),value:k,payload:N}:{x:O?null:n.scale(k[1]),y:E_({axis:i,ticks:o,bandSize:l,entry:N,index:S}),value:k,payload:N}}),b;return x||_?b=w.map(function(N){var S=Array.isArray(N.value)?N.value[0]:null;return v?{x:N.x,y:S!=null&&N.y!=null?i.scale(S):null}:{x:S!=null?n.scale(S):null,y:N.y}}):b=v?i.scale(g):n.scale(g),Hc({points:w,baseLine:b,layout:p,isRange:_},f)});pl(Sc,"renderDotItem",function(e,t){var r;if(Q.isValidElement(e))r=Q.cloneElement(e,t);else if(kr(e))r=e(t);else{var n=Lr("recharts-area-dot",typeof e!="boolean"?e.className:""),i=t.key,a=kG(t,cIe);r=Q.createElement(rb,yu({},a,{key:i,className:n}))}return r});function Mm(e){"@babel/helpers - typeof";return Mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mm(e)}function xIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yIe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TG(n.key),n)}}function _Ie(e,t,r){return t&&yIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function wIe(e,t,r){return t=K_(t),bIe(e,PG()?Reflect.construct(t,r||[],K_(e).constructor):t.apply(e,r))}function bIe(e,t){if(t&&(Mm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jIe(e)}function jIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(PG=function(){return!!e})()}function K_(e){return K_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},K_(e)}function NIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R5(e,t)}function R5(e,t){return R5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},R5(e,t)}function AG(e,t,r){return t=TG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TG(e){var t=SIe(e,"string");return Mm(t)=="symbol"?t:t+""}function SIe(e,t){if(Mm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function M5(){return M5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},M5.apply(this,arguments)}function kIe(e){var t=e.xAxisId,r=MC(),n=DC(),i=uG(t);return i==null?null:y.createElement(yp,M5({},i,{className:Lr("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(o){return oc(o,!0)}}))}var Hi=function(e){function t(){return xIe(this,t),wIe(this,t,arguments)}return NIe(t,e),_Ie(t,[{key:"render",value:function(){return y.createElement(kIe,this.props)}}])}(y.Component);AG(Hi,"displayName","XAxis");AG(Hi,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Dm(e){"@babel/helpers - typeof";return Dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dm(e)}function EIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CIe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MG(n.key),n)}}function PIe(e,t,r){return t&&CIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function AIe(e,t,r){return t=Z_(t),TIe(e,OG()?Reflect.construct(t,r||[],Z_(e).constructor):t.apply(e,r))}function TIe(e,t){if(t&&(Dm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OIe(e)}function OIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(OG=function(){return!!e})()}function Z_(e){return Z_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Z_(e)}function RIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D5(e,t)}function D5(e,t){return D5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},D5(e,t)}function RG(e,t,r){return t=MG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MG(e){var t=MIe(e,"string");return Dm(t)=="symbol"?t:t+""}function MIe(e,t){if(Dm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I5(){return I5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I5.apply(this,arguments)}var DIe=function(t){var r=t.yAxisId,n=MC(),i=DC(),a=fG(r);return a==null?null:y.createElement(yp,I5({},a,{className:Lr("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(l){return oc(l,!0)}}))},Gi=function(e){function t(){return EIe(this,t),AIe(this,t,arguments)}return RIe(t,e),PIe(t,[{key:"render",value:function(){return y.createElement(DIe,this.props)}}])}(y.Component);RG(Gi,"displayName","YAxis");RG(Gi,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function LO(e){return FIe(e)||LIe(e)||$Ie(e)||IIe()}function IIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Ie(e,t){if(e){if(typeof e=="string")return $5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $5(e,t)}}function LIe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FIe(e){if(Array.isArray(e))return $5(e)}function $5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var L5=function(t,r,n,i,a){var o=Xa(t,$C),l=Xa(t,ob),c=[].concat(LO(o),LO(l)),d=Xa(t,cb),u="".concat(i,"Id"),h=i[0],f=r;if(c.length&&(f=c.reduce(function(g,v){if(v.props[u]===n&&wl(v.props,"extendDomain")&&_t(v.props[h])){var _=v.props[h];return[Math.min(g[0],_),Math.max(g[1],_)]}return g},f)),d.length){var p="".concat(h,"1"),x="".concat(h,"2");f=d.reduce(function(g,v){if(v.props[u]===n&&wl(v.props,"extendDomain")&&_t(v.props[p])&&_t(v.props[x])){var _=v.props[p],w=v.props[x];return[Math.min(g[0],_,w),Math.max(g[1],_,w)]}return g},f)}return a&&a.length&&(f=a.reduce(function(g,v){return _t(v)?[Math.min(g[0],v),Math.max(g[1],v)]:g},f)),f},DG={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function a(c,d,u,h,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new i(u,h||c,f),x=r?r+d:d;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],p]:c._events[x].push(p):(c._events[x]=p,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,h;if(this._eventsCount===0)return d;for(h in u=this._events)t.call(u,h)&&d.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,p=h.length,x=new Array(p);f<p;f++)x[f]=h[f].fn;return x},l.prototype.listenerCount=function(d){var u=r?r+d:d,h=this._events[u];return h?h.fn?1:h.length:0},l.prototype.emit=function(d,u,h,f,p,x){var g=r?r+d:d;if(!this._events[g])return!1;var v=this._events[g],_=arguments.length,w,b;if(v.fn){switch(v.once&&this.removeListener(d,v.fn,void 0,!0),_){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,h),!0;case 4:return v.fn.call(v.context,u,h,f),!0;case 5:return v.fn.call(v.context,u,h,f,p),!0;case 6:return v.fn.call(v.context,u,h,f,p,x),!0}for(b=1,w=new Array(_-1);b<_;b++)w[b-1]=arguments[b];v.fn.apply(v.context,w)}else{var N=v.length,S;for(b=0;b<N;b++)switch(v[b].once&&this.removeListener(d,v[b].fn,void 0,!0),_){case 1:v[b].fn.call(v[b].context);break;case 2:v[b].fn.call(v[b].context,u);break;case 3:v[b].fn.call(v[b].context,u,h);break;case 4:v[b].fn.call(v[b].context,u,h,f);break;default:if(!w)for(S=1,w=new Array(_-1);S<_;S++)w[S-1]=arguments[S];v[b].fn.apply(v[b].context,w)}}return!0},l.prototype.on=function(d,u,h){return a(this,d,u,h,!1)},l.prototype.once=function(d,u,h){return a(this,d,u,h,!0)},l.prototype.removeListener=function(d,u,h,f){var p=r?r+d:d;if(!this._events[p])return this;if(!u)return o(this,p),this;var x=this._events[p];if(x.fn)x.fn===u&&(!f||x.once)&&(!h||x.context===h)&&o(this,p);else{for(var g=0,v=[],_=x.length;g<_;g++)(x[g].fn!==u||f&&!x[g].once||h&&x[g].context!==h)&&v.push(x[g]);v.length?this._events[p]=v.length===1?v[0]:v:o(this,p)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(DG);var UIe=DG.exports;const BIe=rn(UIe);var pN=new BIe,gN="recharts.syncMouseEvents";function cv(e){"@babel/helpers - typeof";return cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cv(e)}function zIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VIe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IG(n.key),n)}}function qIe(e,t,r){return t&&VIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vN(e,t,r){return t=IG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IG(e){var t=WIe(e,"string");return cv(t)=="symbol"?t:t+""}function WIe(e,t){if(cv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(cv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var HIe=function(){function e(){zIe(this,e),vN(this,"activeIndex",0),vN(this,"coordinateList",[]),vN(this,"layout","horizontal")}return qIe(e,[{key:"setDetails",value:function(r){var n,i=r.coordinateList,a=i===void 0?null:i,o=r.container,l=o===void 0?null:o,c=r.layout,d=c===void 0?null:c,u=r.offset,h=u===void 0?null:u,f=r.mouseHandlerCallback,p=f===void 0?null:f;this.coordinateList=(n=a!=null?a:this.coordinateList)!==null&&n!==void 0?n:[],this.container=l!=null?l:this.container,this.layout=d!=null?d:this.layout,this.offset=h!=null?h:this.offset,this.mouseHandlerCallback=p!=null?p:this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),a=i.x,o=i.y,l=i.height,c=this.coordinateList[this.activeIndex].coordinate,d=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((n=window)===null||n===void 0?void 0:n.scrollY)||0,h=a+c+d,f=o+this.offset.top+l/2+u;this.mouseHandlerCallback({pageX:h,pageY:f})}}}])}();function GIe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],i=e==null?void 0:e[1];if(n&&i&&_t(n)&&_t(i))return!0}return!1}function YIe(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function $G(e){var t=e.cx,r=e.cy,n=e.radius,i=e.startAngle,a=e.endAngle,o=si(t,r,n,i),l=si(t,r,n,a);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:i,endAngle:a}}function KIe(e,t,r){var n,i,a,o;if(e==="horizontal")n=t.x,a=n,i=r.top,o=r.top+r.height;else if(e==="vertical")i=t.y,o=i,n=r.left,a=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,d=t.innerRadius,u=t.outerRadius,h=t.angle,f=si(l,c,d,h),p=si(l,c,u,h);n=f.x,i=f.y,a=p.x,o=p.y}else return $G(t);return[{x:n,y:i},{x:a,y:o}]}function dv(e){"@babel/helpers - typeof";return dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dv(e)}function FO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function xy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FO(Object(r),!0).forEach(function(n){ZIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZIe(e,t,r){return t=XIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XIe(e){var t=JIe(e,"string");return dv(t)=="symbol"?t:t+""}function JIe(e,t){if(dv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QIe(e){var t,r,n=e.element,i=e.tooltipEventType,a=e.isActive,o=e.activeCoordinate,l=e.activePayload,c=e.offset,d=e.activeTooltipIndex,u=e.tooltipAxisBandSize,h=e.layout,f=e.chartName,p=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!p||!a||!o||f!=="ScatterChart"&&i!=="axis")return null;var x,g=$h;if(f==="ScatterChart")x=o,g=VTe;else if(f==="BarChart")x=YIe(h,o,c,u),g=PC;else if(h==="radial"){var v=$G(o),_=v.cx,w=v.cy,b=v.radius,N=v.startAngle,S=v.endAngle;x={cx:_,cy:w,startAngle:N,endAngle:S,innerRadius:b,outerRadius:b},g=UH}else x={points:KIe(h,o,c)},g=$h;var k=xy(xy(xy(xy({stroke:"#ccc",pointerEvents:"none"},c),x),Pr(p,!1)),{},{payload:l,payloadIndex:d,className:Lr("recharts-tooltip-cursor",p.className)});return y.isValidElement(p)?y.cloneElement(p,k):y.createElement(g,k)}var e$e=["item"],t$e=["children","className","width","height","style","compact","title","desc"];function Im(e){"@babel/helpers - typeof";return Im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Im(e)}function gh(){return gh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gh.apply(this,arguments)}function UO(e,t){return s$e(e)||n$e(e,t)||FG(e,t)||r$e()}function r$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n$e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,d=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,i=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw i}}return l}}function s$e(e){if(Array.isArray(e))return e}function BO(e,t){if(e==null)return{};var r=i$e(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function i$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function a$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o$e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UG(n.key),n)}}function l$e(e,t,r){return t&&o$e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function c$e(e,t,r){return t=X_(t),d$e(e,LG()?Reflect.construct(t,r||[],X_(e).constructor):t.apply(e,r))}function d$e(e,t){if(t&&(Im(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u$e(e)}function u$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(LG=function(){return!!e})()}function X_(e){return X_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},X_(e)}function f$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F5(e,t)}function F5(e,t){return F5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},F5(e,t)}function $m(e){return p$e(e)||m$e(e)||FG(e)||h$e()}function h$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FG(e,t){if(e){if(typeof e=="string")return U5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U5(e,t)}}function m$e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function p$e(e){if(Array.isArray(e))return U5(e)}function U5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Je(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zO(Object(r),!0).forEach(function(n){ar(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ar(e,t,r){return t=UG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UG(e){var t=g$e(e,"string");return Im(t)=="symbol"?t:t+""}function g$e(e,t){if(Im(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Im(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var v$e={xAxis:["bottom","top"],yAxis:["left","right"]},x$e={width:"100%",height:"100%"},BG={x:0,y:0};function yy(e){return e}var y$e=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},_$e=function(t,r,n,i){var a=r.find(function(u){return u&&u.index===n});if(a){if(t==="horizontal")return{x:a.coordinate,y:i.y};if(t==="vertical")return{x:i.x,y:a.coordinate};if(t==="centric"){var o=a.coordinate,l=i.radius;return Je(Je(Je({},i),si(i.cx,i.cy,l,o)),{},{angle:o,radius:l})}var c=a.coordinate,d=i.angle;return Je(Je(Je({},i),si(i.cx,i.cy,c,d)),{},{angle:d,radius:c})}return BG},db=function(t,r){var n=r.graphicalItems,i=r.dataStartIndex,a=r.dataEndIndex,o=(n!=null?n:[]).reduce(function(l,c){var d=c.props.data;return d&&d.length?[].concat($m(l),$m(d)):l},[]);return o.length>0?o:t&&t.length&&_t(i)&&_t(a)?t.slice(i,a+1):[]};function zG(e){return e==="number"?[0,"auto"]:void 0}var B5=function(t,r,n,i){var a=t.graphicalItems,o=t.tooltipAxis,l=db(r,t);return n<0||!a||!a.length||n>=l.length?null:a.reduce(function(c,d){var u,h=(u=d.props.data)!==null&&u!==void 0?u:r;h&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(h=h.slice(t.dataStartIndex,t.dataEndIndex+1));var f;if(o.dataKey&&!o.allowDuplicatedCategory){var p=h===void 0?l:h;f=X2(p,o.dataKey,i)}else f=h&&h[n]||l[n];return f?[].concat($m(c),[$H(d,f)]):c},[])},VO=function(t,r,n,i){var a=i||{x:t.chartX,y:t.chartY},o=y$e(a,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,d=t.tooltipTicks,u=AAe(o,l,d,c);if(u>=0&&d){var h=d[u]&&d[u].value,f=B5(t,r,u,h),p=_$e(n,l,u,a);return{activeTooltipIndex:u,activeLabel:h,activePayload:f,activeCoordinate:p}}return null},w$e=function(t,r){var n=r.axes,i=r.graphicalItems,a=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,h=t.children,f=t.stackOffset,p=MH(u,a);return n.reduce(function(x,g){var v,_=g.type.defaultProps!==void 0?Je(Je({},g.type.defaultProps),g.props):g.props,w=_.type,b=_.dataKey,N=_.allowDataOverflow,S=_.allowDuplicatedCategory,k=_.scale,O=_.ticks,A=_.includeHidden,T=_[o];if(x[T])return x;var $=db(t.data,{graphicalItems:i.filter(function(X){var te,se=o in X.props?X.props[o]:(te=X.type.defaultProps)===null||te===void 0?void 0:te[o];return se===T}),dataStartIndex:c,dataEndIndex:d}),R=$.length,F,D,B;GIe(_.domain,N,w)&&(F=s5(_.domain,null,N),p&&(w==="number"||k!=="auto")&&(B=U0($,b,"category")));var U=zG(w);if(!F||F.length===0){var V,Y=(V=_.domain)!==null&&V!==void 0?V:U;if(b){if(F=U0($,b,w),w==="category"&&p){var z=xwe(F);S&&z?(D=F,F=$_(0,R)):S||(F=yT(Y,F,g).reduce(function(X,te){return X.indexOf(te)>=0?X:[].concat($m(X),[te])},[]))}else if(w==="category")S?F=F.filter(function(X){return X!==""&&!Or(X)}):F=yT(Y,F,g).reduce(function(X,te){return X.indexOf(te)>=0||te===""||Or(te)?X:[].concat($m(X),[te])},[]);else if(w==="number"){var K=DAe($,i.filter(function(X){var te,se,ue=o in X.props?X.props[o]:(te=X.type.defaultProps)===null||te===void 0?void 0:te[o],ye="hide"in X.props?X.props.hide:(se=X.type.defaultProps)===null||se===void 0?void 0:se.hide;return ue===T&&(A||!ye)}),b,a,u);K&&(F=K)}p&&(w==="number"||k!=="auto")&&(B=U0($,b,"category"))}else p?F=$_(0,R):l&&l[T]&&l[T].hasStack&&w==="number"?F=f==="expand"?[0,1]:IH(l[T].stackGroups,c,d):F=RH($,i.filter(function(X){var te=o in X.props?X.props[o]:X.type.defaultProps[o],se="hide"in X.props?X.props.hide:X.type.defaultProps.hide;return te===T&&(A||!se)}),w,u,!0);if(w==="number")F=L5(h,F,T,a,O),Y&&(F=s5(Y,F,N));else if(w==="category"&&Y){var Z=Y,G=F.every(function(X){return Z.indexOf(X)>=0});G&&(F=Z)}}return Je(Je({},x),{},ar({},T,Je(Je({},_),{},{axisType:a,domain:F,categoricalDomain:B,duplicateDomain:D,originalDomain:(v=_.domain)!==null&&v!==void 0?v:U,isCategorical:p,layout:u})))},{})},b$e=function(t,r){var n=r.graphicalItems,i=r.Axis,a=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,h=t.children,f=db(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:d}),p=f.length,x=MH(u,a),g=-1;return n.reduce(function(v,_){var w=_.type.defaultProps!==void 0?Je(Je({},_.type.defaultProps),_.props):_.props,b=w[o],N=zG("number");if(!v[b]){g++;var S;return x?S=$_(0,p):l&&l[b]&&l[b].hasStack?(S=IH(l[b].stackGroups,c,d),S=L5(h,S,b,a)):(S=s5(N,RH(f,n.filter(function(k){var O,A,T=o in k.props?k.props[o]:(O=k.type.defaultProps)===null||O===void 0?void 0:O[o],$="hide"in k.props?k.props.hide:(A=k.type.defaultProps)===null||A===void 0?void 0:A.hide;return T===b&&!$}),"number",u),i.defaultProps.allowDataOverflow),S=L5(h,S,b,a)),Je(Je({},v),{},ar({},b,Je(Je({axisType:a},i.defaultProps),{},{hide:!0,orientation:Za(v$e,"".concat(a,".").concat(g%2),null),domain:S,originalDomain:N,isCategorical:x,layout:u})))}return v},{})},j$e=function(t,r){var n=r.axisType,i=n===void 0?"xAxis":n,a=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.children,h="".concat(i,"Id"),f=Xa(u,a),p={};return f&&f.length?p=w$e(t,{axes:f,graphicalItems:o,axisType:i,axisIdKey:h,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):o&&o.length&&(p=b$e(t,{Axis:a,graphicalItems:o,axisType:i,axisIdKey:h,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),p},N$e=function(t){var r=ed(t),n=oc(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:rC(n,function(i){return i.coordinate}),tooltipAxis:r,tooltipAxisBandSize:C_(r,n)}},qO=function(t){var r=t.children,n=t.defaultShowTooltip,i=ya(r,Sm),a=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(a=i.props.startIndex),i.props.endIndex>=0&&(o=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},S$e=function(t){return!t||!t.length?!1:t.some(function(r){var n=cc(r&&r.type);return n&&n.indexOf("Bar")>=0})},WO=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},k$e=function(t,r){var n=t.props,i=t.graphicalItems,a=t.xAxisMap,o=a===void 0?{}:a,l=t.yAxisMap,c=l===void 0?{}:l,d=n.width,u=n.height,h=n.children,f=n.margin||{},p=ya(h,Sm),x=ya(h,Ou),g=Object.keys(c).reduce(function(S,k){var O=c[k],A=O.orientation;return!O.mirror&&!O.hide?Je(Je({},S),{},ar({},A,S[A]+O.width)):S},{left:f.left||0,right:f.right||0}),v=Object.keys(o).reduce(function(S,k){var O=o[k],A=O.orientation;return!O.mirror&&!O.hide?Je(Je({},S),{},ar({},A,Za(S,"".concat(A))+O.height)):S},{top:f.top||0,bottom:f.bottom||0}),_=Je(Je({},v),g),w=_.bottom;p&&(_.bottom+=p.props.height||Sm.defaultProps.height),x&&r&&(_=RAe(_,i,n,r));var b=d-_.left-_.right,N=u-_.top-_.bottom;return Je(Je({brushBottom:w},_),{},{width:Math.max(b,0),height:Math.max(N,0)})},E$e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},UC=function(t){var r=t.chartName,n=t.GraphicalChild,i=t.defaultTooltipEventType,a=i===void 0?"axis":i,o=t.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=t.axisComponents,d=t.legendContent,u=t.formatAxisMap,h=t.defaultProps,f=function(_,w){var b=w.graphicalItems,N=w.stackGroups,S=w.offset,k=w.updateId,O=w.dataStartIndex,A=w.dataEndIndex,T=_.barSize,$=_.layout,R=_.barGap,F=_.barCategoryGap,D=_.maxBarSize,B=WO($),U=B.numericAxisName,V=B.cateAxisName,Y=S$e(b),z=[];return b.forEach(function(K,Z){var G=db(_.data,{graphicalItems:[K],dataStartIndex:O,dataEndIndex:A}),X=K.type.defaultProps!==void 0?Je(Je({},K.type.defaultProps),K.props):K.props,te=X.dataKey,se=X.maxBarSize,ue=X["".concat(U,"Id")],ye=X["".concat(V,"Id")],ne={},xe=c.reduce(function(Fe,ve){var rt=w["".concat(ve.axisType,"Map")],Ve=X["".concat(ve.axisType,"Id")];rt&&rt[Ve]||ve.axisType==="zAxis"||rf();var lt=rt[Ve];return Je(Je({},Fe),{},ar(ar({},ve.axisType,lt),"".concat(ve.axisType,"Ticks"),oc(lt)))},ne),ge=xe[V],ie=xe["".concat(V,"Ticks")],ee=N&&N[ue]&&N[ue].hasStack&&GAe(K,N[ue].stackGroups),H=cc(K.type).indexOf("Bar")>=0,le=C_(ge,ie),Se=[],ae=Y&&TAe({barSize:T,stackGroups:N,totalSize:E$e(xe,V)});if(H){var fe,he,pe=Or(se)?D:se,Ae=(fe=(he=C_(ge,ie,!0))!==null&&he!==void 0?he:pe)!==null&&fe!==void 0?fe:0;Se=OAe({barGap:R,barCategoryGap:F,bandSize:Ae!==le?Ae:le,sizeList:ae[ye],maxBarSize:pe}),Ae!==le&&(Se=Se.map(function(Fe){return Je(Je({},Fe),{},{position:Je(Je({},Fe.position),{},{offset:Fe.position.offset-Ae/2})})}))}var qe=K&&K.type&&K.type.getComposedData;qe&&z.push({props:Je(Je({},qe(Je(Je({},xe),{},{displayedData:G,props:_,dataKey:te,item:K,bandSize:le,barPosition:Se,offset:S,stackedData:ee,layout:$,dataStartIndex:O,dataEndIndex:A}))),{},ar(ar(ar({key:K.key||"item-".concat(Z)},U,xe[U]),V,xe[V]),"animationId",k)),childIndex:Awe(K,_.children),item:K})}),z},p=function(_,w){var b=_.props,N=_.dataStartIndex,S=_.dataEndIndex,k=_.updateId;if(!h9({props:b}))return null;var O=b.children,A=b.layout,T=b.stackOffset,$=b.data,R=b.reverseStackOrder,F=WO(A),D=F.numericAxisName,B=F.cateAxisName,U=Xa(O,n),V=qAe($,U,"".concat(D,"Id"),"".concat(B,"Id"),T,R),Y=c.reduce(function(X,te){var se="".concat(te.axisType,"Map");return Je(Je({},X),{},ar({},se,j$e(b,Je(Je({},te),{},{graphicalItems:U,stackGroups:te.axisType===D&&V,dataStartIndex:N,dataEndIndex:S}))))},{}),z=k$e(Je(Je({},Y),{},{props:b,graphicalItems:U}),w==null?void 0:w.legendBBox);Object.keys(Y).forEach(function(X){Y[X]=u(b,Y[X],z,X.replace("Map",""),r)});var K=Y["".concat(B,"Map")],Z=N$e(K),G=f(b,Je(Je({},Y),{},{dataStartIndex:N,dataEndIndex:S,updateId:k,graphicalItems:U,stackGroups:V,offset:z}));return Je(Je({formattedGraphicalItems:G,graphicalItems:U,offset:z,stackGroups:V},Z),Y)},x=function(v){function _(w){var b,N,S;return a$e(this,_),S=c$e(this,_,[w]),ar(S,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),ar(S,"accessibilityManager",new HIe),ar(S,"handleLegendBBoxUpdate",function(k){if(k){var O=S.state,A=O.dataStartIndex,T=O.dataEndIndex,$=O.updateId;S.setState(Je({legendBBox:k},p({props:S.props,dataStartIndex:A,dataEndIndex:T,updateId:$},Je(Je({},S.state),{},{legendBBox:k}))))}}),ar(S,"handleReceiveSyncEvent",function(k,O,A){if(S.props.syncId===k){if(A===S.eventEmitterSymbol&&typeof S.props.syncMethod!="function")return;S.applySyncEvent(O)}}),ar(S,"handleBrushChange",function(k){var O=k.startIndex,A=k.endIndex;if(O!==S.state.dataStartIndex||A!==S.state.dataEndIndex){var T=S.state.updateId;S.setState(function(){return Je({dataStartIndex:O,dataEndIndex:A},p({props:S.props,dataStartIndex:O,dataEndIndex:A,updateId:T},S.state))}),S.triggerSyncEvent({dataStartIndex:O,dataEndIndex:A})}}),ar(S,"handleMouseEnter",function(k){var O=S.getMouseInfo(k);if(O){var A=Je(Je({},O),{},{isTooltipActive:!0});S.setState(A),S.triggerSyncEvent(A);var T=S.props.onMouseEnter;kr(T)&&T(A,k)}}),ar(S,"triggeredAfterMouseMove",function(k){var O=S.getMouseInfo(k),A=O?Je(Je({},O),{},{isTooltipActive:!0}):{isTooltipActive:!1};S.setState(A),S.triggerSyncEvent(A);var T=S.props.onMouseMove;kr(T)&&T(A,k)}),ar(S,"handleItemMouseEnter",function(k){S.setState(function(){return{isTooltipActive:!0,activeItem:k,activePayload:k.tooltipPayload,activeCoordinate:k.tooltipPosition||{x:k.cx,y:k.cy}}})}),ar(S,"handleItemMouseLeave",function(){S.setState(function(){return{isTooltipActive:!1}})}),ar(S,"handleMouseMove",function(k){k.persist(),S.throttleTriggeredAfterMouseMove(k)}),ar(S,"handleMouseLeave",function(k){S.throttleTriggeredAfterMouseMove.cancel();var O={isTooltipActive:!1};S.setState(O),S.triggerSyncEvent(O);var A=S.props.onMouseLeave;kr(A)&&A(O,k)}),ar(S,"handleOuterEvent",function(k){var O=Pwe(k),A=Za(S.props,"".concat(O));if(O&&kr(A)){var T,$;/.*touch.*/i.test(O)?$=S.getMouseInfo(k.changedTouches[0]):$=S.getMouseInfo(k),A((T=$)!==null&&T!==void 0?T:{},k)}}),ar(S,"handleClick",function(k){var O=S.getMouseInfo(k);if(O){var A=Je(Je({},O),{},{isTooltipActive:!0});S.setState(A),S.triggerSyncEvent(A);var T=S.props.onClick;kr(T)&&T(A,k)}}),ar(S,"handleMouseDown",function(k){var O=S.props.onMouseDown;if(kr(O)){var A=S.getMouseInfo(k);O(A,k)}}),ar(S,"handleMouseUp",function(k){var O=S.props.onMouseUp;if(kr(O)){var A=S.getMouseInfo(k);O(A,k)}}),ar(S,"handleTouchMove",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&S.throttleTriggeredAfterMouseMove(k.changedTouches[0])}),ar(S,"handleTouchStart",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&S.handleMouseDown(k.changedTouches[0])}),ar(S,"handleTouchEnd",function(k){k.changedTouches!=null&&k.changedTouches.length>0&&S.handleMouseUp(k.changedTouches[0])}),ar(S,"handleDoubleClick",function(k){var O=S.props.onDoubleClick;if(kr(O)){var A=S.getMouseInfo(k);O(A,k)}}),ar(S,"handleContextMenu",function(k){var O=S.props.onContextMenu;if(kr(O)){var A=S.getMouseInfo(k);O(A,k)}}),ar(S,"triggerSyncEvent",function(k){S.props.syncId!==void 0&&pN.emit(gN,S.props.syncId,k,S.eventEmitterSymbol)}),ar(S,"applySyncEvent",function(k){var O=S.props,A=O.layout,T=O.syncMethod,$=S.state.updateId,R=k.dataStartIndex,F=k.dataEndIndex;if(k.dataStartIndex!==void 0||k.dataEndIndex!==void 0)S.setState(Je({dataStartIndex:R,dataEndIndex:F},p({props:S.props,dataStartIndex:R,dataEndIndex:F,updateId:$},S.state)));else if(k.activeTooltipIndex!==void 0){var D=k.chartX,B=k.chartY,U=k.activeTooltipIndex,V=S.state,Y=V.offset,z=V.tooltipTicks;if(!Y)return;if(typeof T=="function")U=T(z,k);else if(T==="value"){U=-1;for(var K=0;K<z.length;K++)if(z[K].value===k.activeLabel){U=K;break}}var Z=Je(Je({},Y),{},{x:Y.left,y:Y.top}),G=Math.min(D,Z.x+Z.width),X=Math.min(B,Z.y+Z.height),te=z[U]&&z[U].value,se=B5(S.state,S.props.data,U),ue=z[U]?{x:A==="horizontal"?z[U].coordinate:G,y:A==="horizontal"?X:z[U].coordinate}:BG;S.setState(Je(Je({},k),{},{activeLabel:te,activeCoordinate:ue,activePayload:se,activeTooltipIndex:U}))}else S.setState(k)}),ar(S,"renderCursor",function(k){var O,A=S.state,T=A.isTooltipActive,$=A.activeCoordinate,R=A.activePayload,F=A.offset,D=A.activeTooltipIndex,B=A.tooltipAxisBandSize,U=S.getTooltipEventType(),V=(O=k.props.active)!==null&&O!==void 0?O:T,Y=S.props.layout,z=k.key||"_recharts-cursor";return Q.createElement(QIe,{key:z,activeCoordinate:$,activePayload:R,activeTooltipIndex:D,chartName:r,element:k,isActive:V,layout:Y,offset:F,tooltipAxisBandSize:B,tooltipEventType:U})}),ar(S,"renderPolarAxis",function(k,O,A){var T=Za(k,"type.axisType"),$=Za(S.state,"".concat(T,"Map")),R=k.type.defaultProps,F=R!==void 0?Je(Je({},R),k.props):k.props,D=$&&$[F["".concat(T,"Id")]];return y.cloneElement(k,Je(Je({},D),{},{className:Lr(T,D.className),key:k.key||"".concat(O,"-").concat(A),ticks:oc(D,!0)}))}),ar(S,"renderPolarGrid",function(k){var O=k.props,A=O.radialLines,T=O.polarAngles,$=O.polarRadius,R=S.state,F=R.radiusAxisMap,D=R.angleAxisMap,B=ed(F),U=ed(D),V=U.cx,Y=U.cy,z=U.innerRadius,K=U.outerRadius;return y.cloneElement(k,{polarAngles:Array.isArray(T)?T:oc(U,!0).map(function(Z){return Z.coordinate}),polarRadius:Array.isArray($)?$:oc(B,!0).map(function(Z){return Z.coordinate}),cx:V,cy:Y,innerRadius:z,outerRadius:K,key:k.key||"polar-grid",radialLines:A})}),ar(S,"renderLegend",function(){var k=S.state.formattedGraphicalItems,O=S.props,A=O.children,T=O.width,$=O.height,R=S.props.margin||{},F=T-(R.left||0)-(R.right||0),D=TH({children:A,formattedGraphicalItems:k,legendWidth:F,legendContent:d});if(!D)return null;var B=D.item,U=BO(D,e$e);return y.cloneElement(B,Je(Je({},U),{},{chartWidth:T,chartHeight:$,margin:R,onBBoxUpdate:S.handleLegendBBoxUpdate}))}),ar(S,"renderTooltip",function(){var k,O=S.props,A=O.children,T=O.accessibilityLayer,$=ya(A,Hs);if(!$)return null;var R=S.state,F=R.isTooltipActive,D=R.activeCoordinate,B=R.activePayload,U=R.activeLabel,V=R.offset,Y=(k=$.props.active)!==null&&k!==void 0?k:F;return y.cloneElement($,{viewBox:Je(Je({},V),{},{x:V.left,y:V.top}),active:Y,label:U,payload:Y?B:[],coordinate:D,accessibilityLayer:T})}),ar(S,"renderBrush",function(k){var O=S.props,A=O.margin,T=O.data,$=S.state,R=$.offset,F=$.dataStartIndex,D=$.dataEndIndex,B=$.updateId;return y.cloneElement(k,{key:k.key||"_recharts-brush",onChange:my(S.handleBrushChange,k.props.onChange),data:T,x:_t(k.props.x)?k.props.x:R.left,y:_t(k.props.y)?k.props.y:R.top+R.height+R.brushBottom-(A.bottom||0),width:_t(k.props.width)?k.props.width:R.width,startIndex:F,endIndex:D,updateId:"brush-".concat(B)})}),ar(S,"renderReferenceElement",function(k,O,A){if(!k)return null;var T=S,$=T.clipPathId,R=S.state,F=R.xAxisMap,D=R.yAxisMap,B=R.offset,U=k.type.defaultProps||{},V=k.props,Y=V.xAxisId,z=Y===void 0?U.xAxisId:Y,K=V.yAxisId,Z=K===void 0?U.yAxisId:K;return y.cloneElement(k,{key:k.key||"".concat(O,"-").concat(A),xAxis:F[z],yAxis:D[Z],viewBox:{x:B.left,y:B.top,width:B.width,height:B.height},clipPathId:$})}),ar(S,"renderActivePoints",function(k){var O=k.item,A=k.activePoint,T=k.basePoint,$=k.childIndex,R=k.isRange,F=[],D=O.props.key,B=O.item.type.defaultProps!==void 0?Je(Je({},O.item.type.defaultProps),O.item.props):O.item.props,U=B.activeDot,V=B.dataKey,Y=Je(Je({index:$,dataKey:V,cx:A.x,cy:A.y,r:4,fill:CC(O.item),strokeWidth:2,stroke:"#fff",payload:A.payload,value:A.value},Pr(U,!1)),J2(U));return F.push(_.renderActiveDot(U,Y,"".concat(D,"-activePoint-").concat($))),T?F.push(_.renderActiveDot(U,Je(Je({},Y),{},{cx:T.x,cy:T.y}),"".concat(D,"-basePoint-").concat($))):R&&F.push(null),F}),ar(S,"renderGraphicChild",function(k,O,A){var T=S.filterFormatItem(k,O,A);if(!T)return null;var $=S.getTooltipEventType(),R=S.state,F=R.isTooltipActive,D=R.tooltipAxis,B=R.activeTooltipIndex,U=R.activeLabel,V=S.props.children,Y=ya(V,Hs),z=T.props,K=z.points,Z=z.isRange,G=z.baseLine,X=T.item.type.defaultProps!==void 0?Je(Je({},T.item.type.defaultProps),T.item.props):T.item.props,te=X.activeDot,se=X.hide,ue=X.activeBar,ye=X.activeShape,ne=!!(!se&&F&&Y&&(te||ue||ye)),xe={};$!=="axis"&&Y&&Y.props.trigger==="click"?xe={onClick:my(S.handleItemMouseEnter,k.props.onClick)}:$!=="axis"&&(xe={onMouseLeave:my(S.handleItemMouseLeave,k.props.onMouseLeave),onMouseEnter:my(S.handleItemMouseEnter,k.props.onMouseEnter)});var ge=y.cloneElement(k,Je(Je({},T.props),xe));function ie(ve){return typeof D.dataKey=="function"?D.dataKey(ve.payload):null}if(ne)if(B>=0){var ee,H;if(D.dataKey&&!D.allowDuplicatedCategory){var le=typeof D.dataKey=="function"?ie:"payload.".concat(D.dataKey.toString());ee=X2(K,le,U),H=Z&&G&&X2(G,le,U)}else ee=K==null?void 0:K[B],H=Z&&G&&G[B];if(ye||ue){var Se=k.props.activeIndex!==void 0?k.props.activeIndex:B;return[y.cloneElement(k,Je(Je(Je({},T.props),xe),{},{activeIndex:Se})),null,null]}if(!Or(ee))return[ge].concat($m(S.renderActivePoints({item:T,activePoint:ee,basePoint:H,childIndex:B,isRange:Z})))}else{var ae,fe=(ae=S.getItemByXY(S.state.activeCoordinate))!==null&&ae!==void 0?ae:{graphicalItem:ge},he=fe.graphicalItem,pe=he.item,Ae=pe===void 0?k:pe,qe=he.childIndex,Fe=Je(Je(Je({},T.props),xe),{},{activeIndex:qe});return[y.cloneElement(Ae,Fe),null,null]}return Z?[ge,null,null]:[ge,null]}),ar(S,"renderCustomized",function(k,O,A){return y.cloneElement(k,Je(Je({key:"recharts-customized-".concat(A)},S.props),S.state))}),ar(S,"renderMap",{CartesianGrid:{handler:yy,once:!0},ReferenceArea:{handler:S.renderReferenceElement},ReferenceLine:{handler:yy},ReferenceDot:{handler:S.renderReferenceElement},XAxis:{handler:yy},YAxis:{handler:yy},Brush:{handler:S.renderBrush,once:!0},Bar:{handler:S.renderGraphicChild},Line:{handler:S.renderGraphicChild},Area:{handler:S.renderGraphicChild},Radar:{handler:S.renderGraphicChild},RadialBar:{handler:S.renderGraphicChild},Scatter:{handler:S.renderGraphicChild},Pie:{handler:S.renderGraphicChild},Funnel:{handler:S.renderGraphicChild},Tooltip:{handler:S.renderCursor,once:!0},PolarGrid:{handler:S.renderPolarGrid,once:!0},PolarAngleAxis:{handler:S.renderPolarAxis},PolarRadiusAxis:{handler:S.renderPolarAxis},Customized:{handler:S.renderCustomized}}),S.clipPathId="".concat((b=w.id)!==null&&b!==void 0?b:fp("recharts"),"-clip"),S.throttleTriggeredAfterMouseMove=AW(S.triggeredAfterMouseMove,(N=w.throttleDelay)!==null&&N!==void 0?N:1e3/60),S.state={},S}return f$e(_,v),l$e(_,[{key:"componentDidMount",value:function(){var b,N;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(N=this.props.margin.top)!==null&&N!==void 0?N:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,N=b.children,S=b.data,k=b.height,O=b.layout,A=ya(N,Hs);if(A){var T=A.props.defaultIndex;if(!(typeof T!="number"||T<0||T>this.state.tooltipTicks.length-1)){var $=this.state.tooltipTicks[T]&&this.state.tooltipTicks[T].value,R=B5(this.state,S,T,$),F=this.state.tooltipTicks[T].coordinate,D=(this.state.offset.top+k)/2,B=O==="horizontal",U=B?{x:F,y:D}:{y:F,x:D},V=this.state.formattedGraphicalItems.find(function(z){var K=z.item;return K.type.name==="Scatter"});V&&(U=Je(Je({},U),V.props.points[T].tooltipPosition),R=V.props.points[T].tooltipPayload);var Y={activeTooltipIndex:T,isTooltipActive:!0,activeLabel:$,activePayload:R,activeCoordinate:U};this.setState(Y),this.renderCursor(A),this.accessibilityManager.setIndex(T)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,N){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==N.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var S,k;this.accessibilityManager.setDetails({offset:{left:(S=this.props.margin.left)!==null&&S!==void 0?S:0,top:(k=this.props.margin.top)!==null&&k!==void 0?k:0}})}return null}},{key:"componentDidUpdate",value:function(b){yS([ya(b.children,Hs)],[ya(this.props.children,Hs)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=ya(this.props.children,Hs);if(b&&typeof b.props.shared=="boolean"){var N=b.props.shared?"axis":"item";return l.indexOf(N)>=0?N:a}return a}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var N=this.container,S=N.getBoundingClientRect(),k=rCe(S),O={chartX:Math.round(b.pageX-k.left),chartY:Math.round(b.pageY-k.top)},A=S.width/N.offsetWidth||1,T=this.inRange(O.chartX,O.chartY,A);if(!T)return null;var $=this.state,R=$.xAxisMap,F=$.yAxisMap,D=this.getTooltipEventType(),B=VO(this.state,this.props.data,this.props.layout,T);if(D!=="axis"&&R&&F){var U=ed(R).scale,V=ed(F).scale,Y=U&&U.invert?U.invert(O.chartX):null,z=V&&V.invert?V.invert(O.chartY):null;return Je(Je({},O),{},{xValue:Y,yValue:z},B)}return B?Je(Je({},O),B):null}},{key:"inRange",value:function(b,N){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,k=this.props.layout,O=b/S,A=N/S;if(k==="horizontal"||k==="vertical"){var T=this.state.offset,$=O>=T.left&&O<=T.left+T.width&&A>=T.top&&A<=T.top+T.height;return $?{x:O,y:A}:null}var R=this.state,F=R.angleAxisMap,D=R.radiusAxisMap;if(F&&D){var B=ed(F);return bT({x:O,y:A},B)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,N=this.getTooltipEventType(),S=ya(b,Hs),k={};S&&N==="axis"&&(S.props.trigger==="click"?k={onClick:this.handleClick}:k={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var O=J2(this.props,this.handleOuterEvent);return Je(Je({},O),k)}},{key:"addListener",value:function(){pN.on(gN,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){pN.removeListener(gN,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,N,S){for(var k=this.state.formattedGraphicalItems,O=0,A=k.length;O<A;O++){var T=k[O];if(T.item===b||T.props.key===b.key||N===cc(T.item.type)&&S===T.childIndex)return T}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,N=this.state.offset,S=N.left,k=N.top,O=N.height,A=N.width;return Q.createElement("defs",null,Q.createElement("clipPath",{id:b},Q.createElement("rect",{x:S,y:k,height:O,width:A})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(N,S){var k=UO(S,2),O=k[0],A=k[1];return Je(Je({},N),{},ar({},O,A.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(N,S){var k=UO(S,2),O=k[0],A=k[1];return Je(Je({},N),{},ar({},O,A.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var N;return(N=this.state.xAxisMap)===null||N===void 0||(N=N[b])===null||N===void 0?void 0:N.scale}},{key:"getYScaleByAxisId",value:function(b){var N;return(N=this.state.yAxisMap)===null||N===void 0||(N=N[b])===null||N===void 0?void 0:N.scale}},{key:"getItemByXY",value:function(b){var N=this.state,S=N.formattedGraphicalItems,k=N.activeItem;if(S&&S.length)for(var O=0,A=S.length;O<A;O++){var T=S[O],$=T.props,R=T.item,F=R.type.defaultProps!==void 0?Je(Je({},R.type.defaultProps),R.props):R.props,D=cc(R.type);if(D==="Bar"){var B=($.data||[]).find(function(z){return RTe(b,z)});if(B)return{graphicalItem:T,payload:B}}else if(D==="RadialBar"){var U=($.data||[]).find(function(z){return bT(b,z)});if(U)return{graphicalItem:T,payload:U}}else if(nb(T,k)||sb(T,k)||sv(T,k)){var V=IOe({graphicalItem:T,activeTooltipItem:k,itemData:F.data}),Y=F.activeIndex===void 0?V:F.activeIndex;return{graphicalItem:Je(Je({},T),{},{childIndex:Y}),payload:sv(T,k)?F.data[V]:T.props.data[V]}}}return null}},{key:"render",value:function(){var b=this;if(!h9(this))return null;var N=this.props,S=N.children,k=N.className,O=N.width,A=N.height,T=N.style,$=N.compact,R=N.title,F=N.desc,D=BO(N,t$e),B=Pr(D,!1);if($)return Q.createElement(_O,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Q.createElement(wS,gh({},B,{width:O,height:A,title:R,desc:F}),this.renderClipPath(),p9(S,this.renderMap)));if(this.props.accessibilityLayer){var U,V;B.tabIndex=(U=this.props.tabIndex)!==null&&U!==void 0?U:0,B.role=(V=this.props.role)!==null&&V!==void 0?V:"application",B.onKeyDown=function(z){b.accessibilityManager.keyboardEvent(z)},B.onFocus=function(){b.accessibilityManager.focus()}}var Y=this.parseEventsOfWrapper();return Q.createElement(_O,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Q.createElement("div",gh({className:Lr("recharts-wrapper",k),style:Je({position:"relative",cursor:"default",width:O,height:A},T)},Y,{ref:function(K){b.container=K}}),Q.createElement(wS,gh({},B,{width:O,height:A,title:R,desc:F,style:x$e}),this.renderClipPath(),p9(S,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(y.Component);ar(x,"displayName",r),ar(x,"defaultProps",Je({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),ar(x,"getDerivedStateFromProps",function(v,_){var w=v.dataKey,b=v.data,N=v.children,S=v.width,k=v.height,O=v.layout,A=v.stackOffset,T=v.margin,$=_.dataStartIndex,R=_.dataEndIndex;if(_.updateId===void 0){var F=qO(v);return Je(Je(Je({},F),{},{updateId:0},p(Je(Je({props:v},F),{},{updateId:0}),_)),{},{prevDataKey:w,prevData:b,prevWidth:S,prevHeight:k,prevLayout:O,prevStackOffset:A,prevMargin:T,prevChildren:N})}if(w!==_.prevDataKey||b!==_.prevData||S!==_.prevWidth||k!==_.prevHeight||O!==_.prevLayout||A!==_.prevStackOffset||!Mh(T,_.prevMargin)){var D=qO(v),B={chartX:_.chartX,chartY:_.chartY,isTooltipActive:_.isTooltipActive},U=Je(Je({},VO(_,b,O)),{},{updateId:_.updateId+1}),V=Je(Je(Je({},D),B),U);return Je(Je(Je({},V),p(Je({props:v},V),_)),{},{prevDataKey:w,prevData:b,prevWidth:S,prevHeight:k,prevLayout:O,prevStackOffset:A,prevMargin:T,prevChildren:N})}if(!yS(N,_.prevChildren)){var Y,z,K,Z,G=ya(N,Sm),X=G&&(Y=(z=G.props)===null||z===void 0?void 0:z.startIndex)!==null&&Y!==void 0?Y:$,te=G&&(K=(Z=G.props)===null||Z===void 0?void 0:Z.endIndex)!==null&&K!==void 0?K:R,se=X!==$||te!==R,ue=!Or(b),ye=ue&&!se?_.updateId:_.updateId+1;return Je(Je({updateId:ye},p(Je(Je({props:v},_),{},{updateId:ye,dataStartIndex:X,dataEndIndex:te}),_)),{},{prevChildren:N,dataStartIndex:X,dataEndIndex:te})}return null}),ar(x,"renderActiveDot",function(v,_,w){var b;return y.isValidElement(v)?b=y.cloneElement(v,_):kr(v)?b=v(_):b=Q.createElement(rb,_),Q.createElement(Rn,{className:"recharts-active-dot",key:w},b)});var g=y.forwardRef(function(_,w){return Q.createElement(x,gh({},_,{ref:w}))});return g.displayName=x.displayName,g},HO=UC({chartName:"LineChart",GraphicalChild:Om,axisComponents:[{axisType:"xAxis",AxisComp:Hi},{axisType:"yAxis",AxisComp:Gi}],formatAxisMap:AC}),b0=UC({chartName:"BarChart",GraphicalChild:ja,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Hi},{axisType:"yAxis",AxisComp:Gi}],formatAxisMap:AC}),GO=UC({chartName:"AreaChart",GraphicalChild:Sc,axisComponents:[{axisType:"xAxis",AxisComp:Hi},{axisType:"yAxis",AxisComp:Gi}],formatAxisMap:AC});function VG({data:e,className:t=""}){if(!e||e.length===0)return s.jsxs(He,{className:t,children:[s.jsx(xr,{children:s.jsxs(Cr,{className:"flex items-center gap-2",children:[s.jsx(Sn,{className:"h-5 w-5"}),"Promotion Performance"]})}),s.jsx(st,{children:s.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500",children:"No performance data available"})})]});const r=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"});return s.jsxs(He,{className:t,children:[s.jsx(xr,{children:s.jsxs(Cr,{className:"flex items-center gap-2",children:[s.jsx(Sn,{className:"h-5 w-5"}),"Promotion Performance Over Time"]})}),s.jsx(st,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),s.jsx("span",{children:"Impressions"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded"}),s.jsx("span",{children:"Clicks"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),s.jsx("span",{children:"Conversions"})]})]}),s.jsx("div",{className:"h-64 w-full",children:s.jsx(Wl,{width:"100%",height:"100%",children:s.jsxs(b0,{data:e,margin:{top:20,right:30,left:20,bottom:5},children:[s.jsx(Xo,{strokeDasharray:"3 3"}),s.jsx(Hi,{dataKey:"date",tickFormatter:r,angle:-45,textAnchor:"end",height:60}),s.jsx(Gi,{}),s.jsx(Hs,{formatter:(n,i)=>[n.toLocaleString(),i],labelFormatter:n=>`Date: ${r(n)}`}),s.jsx(Ou,{}),s.jsx(ja,{dataKey:"impressions",fill:"#3b82f6",name:"Impressions"}),s.jsx(ja,{dataKey:"clicks",fill:"#8b5cf6",name:"Clicks"}),s.jsx(ja,{dataKey:"conversions",fill:"#10b981",name:"Conversions"})]})})}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-4 border-t",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600 mb-1",children:[s.jsx(lf,{className:"h-4 w-4"}),s.jsx("span",{children:"Total Impressions"})]}),s.jsx("p",{className:"text-lg font-semibold",children:e.reduce((n,i)=>n+i.impressions,0).toLocaleString()})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600 mb-1",children:[s.jsx(QD,{className:"h-4 w-4"}),s.jsx("span",{children:"Total Clicks"})]}),s.jsx("p",{className:"text-lg font-semibold",children:e.reduce((n,i)=>n+i.clicks,0).toLocaleString()})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600 mb-1",children:[s.jsx(So,{className:"h-4 w-4"}),s.jsx("span",{children:"Total Conversions"})]}),s.jsx("p",{className:"text-lg font-semibold",children:e.reduce((n,i)=>n+i.conversions,0).toLocaleString()})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex items-center justify-center gap-1 text-sm text-gray-600 mb-1",children:s.jsx("span",{children:"Total Spend"})}),s.jsxs("p",{className:"text-lg font-semibold",children:["$",e.reduce((n,i)=>n+i.spend,0).toLocaleString()]})]})]})]})})]})}function C$e(){const{user:e}=os(),[t,r]=y.useState(!0),[n,i]=y.useState(null),[a,o]=y.useState([]),[l,c]=y.useState([]),[d,u]=y.useState([]),[h,f]=y.useState([]),[p,x]=y.useState("overview"),[g,v]=y.useState(!1),_=()=>E(this,null,function*(){if(e){v(!0);try{console.log(" CreatorAnalyticsDashboard: Loading promotion data...");const[G,X,te]=yield Promise.all([Ua.getUserPromotions(e.id),Ua.getPromotionPerformanceComparison(e.id),Ua.getPromotionTrends(e.id,30)]);console.log(" CreatorAnalyticsDashboard: Promotion data loaded:",{promotions:G.length,comparisons:X.length,trends:te.length}),R(G),D(X),U(te)}catch(G){console.error("Error loading promotion data:",G)}finally{v(!1)}}}),[w,b]=y.useState(null),[N,S]=y.useState(null),[k,O]=y.useState([]),[A,T]=y.useState(null),[$,R]=y.useState([]),[F,D]=y.useState([]),[B,U]=y.useState([]),{isLive:V,lastUpdate:Y}=mq({userId:(e==null?void 0:e.id)||"",enabled:!!e});y.useEffect(()=>{e&&z()},[e]),y.useEffect(()=>{p==="promotions"&&e&&_()},[p,e]);const z=()=>E(this,null,function*(){if(e)try{r(!0);const G=e.id;console.log(" CreatorAnalyticsDashboard: Fetching data for creatorId:",G);const[X,te,se,ue,ye]=yield Promise.all([Bf.getCreatorStats(G),Bf.getFanInsights(G),Bf.getGeographicInsights(G),Bf.getContentPerformance(G),Bf.getCreatorAchievements(G)]);i(X),o(te),c(se),u(ue),f(ye),yield K(G)}catch(G){console.error("Error fetching creator data:",G)}finally{r(!1)}}),K=G=>E(this,null,function*(){try{const X={start:new Date(Date.now()-2592e6),end:new Date},te=yield O4.analyzeFunnel("creator",X);b(te);const se=yield hh.getUserRevenueMetrics(G,X);S(se);const ue=d.map(ie=>({date:ie.date,value:ie.follower_gains,label:"New Followers"}));O(ue);const ye={score:(n==null?void 0:n.engagement_rate)||0,sessionDuration:0,interactionCount:(n==null?void 0:n.total_event_views)||0,pageViews:(n==null?void 0:n.total_event_views)||0,likes:(n==null?void 0:n.total_reviews)||0,shares:0,comments:0,bounceRate:0};T(ye);const[ne,xe,ge]=yield Promise.all([Ua.getUserPromotions(G),Ua.getPromotionPerformanceComparison(G),Ua.getPromotionTrends(G,30)]);R(ne),D(xe),U(ge)}catch(X){console.error("Error loading enhanced analytics:",X)}}),Z=()=>E(this,null,function*(){if(e)try{const G=yield Bf.exportCreatorData(e.id),X=new Blob([JSON.stringify(G,null,2)],{type:"application/json"}),te=URL.createObjectURL(X),se=document.createElement("a");se.href=te,se.download=`creator-analytics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(se),se.click(),document.body.removeChild(se),URL.revokeObjectURL(te)}catch(G){console.error("Error exporting data:",G)}});return t?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsx(Wa,{})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((G,X)=>s.jsx(Wa,{},X))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(Wa,{}),s.jsx(Wa,{})]})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(zu,{className:"w-8 h-8 text-purple-600"}),s.jsx("h1",{className:"gradient-text text-3xl font-bold",children:"Creator Analytics"})]}),s.jsx("p",{className:"text-gray-600",children:"Track your fan engagement, content performance, and growth metrics"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:Z,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[s.jsx(yv,{className:"w-4 h-4"}),"Export Data"]}),s.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all",children:"Upgrade to Pro"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(Xi,{title:"Total Followers",value:(n==null?void 0:n.total_followers)||0,icon:s.jsx(Ar,{className:"w-6 h-6"}),trend:(n==null?void 0:n.fan_growth_rate)>0?"up":(n==null?void 0:n.fan_growth_rate)<0?"down":"neutral",subtitle:"growth this month"}),s.jsx(Xi,{title:"Engagement Rate",value:`${(n==null?void 0:n.engagement_rate)||0}%`,icon:s.jsx(Sn,{className:"w-6 h-6"}),trend:"neutral",subtitle:"interactions per follower"}),s.jsx(Xi,{title:"Event Views",value:(n==null?void 0:n.total_event_views)||0,icon:s.jsx(lf,{className:"w-6 h-6"}),trend:"neutral",subtitle:"total views"}),s.jsx(Xi,{title:"Fan Reviews",value:(n==null?void 0:n.total_reviews)||0,icon:s.jsx(Jt,{className:"w-6 h-6"}),trend:"neutral",subtitle:"reviews received"})]}),s.jsx("div",{className:"mb-8",children:s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:Bu},{id:"fans",label:"Fan Insights",icon:Ar},{id:"content",label:"Content Performance",icon:Et},{id:"promotions",label:"Promotions",icon:Sn},{id:"achievements",label:"Achievements",icon:Sd}].map(G=>s.jsxs("button",{onClick:()=>x(G.id),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${p===G.id?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(G.icon,{className:"w-4 h-4"}),G.label]},G.id))})})}),p==="overview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[A&&s.jsx(fq,{metrics:A,title:"Creator Engagement Score",showBreakdown:!0}),k.length>0&&s.jsx(hq,{data:k,title:"Follower Growth",valueLabel:"New Followers",showTrend:!0})]}),w&&w.stages.length>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Sn,{className:"w-5 h-5 text-synth-pink"}),"Fan Conversion Funnel"]}),s.jsx(dq,{stages:w.stages,title:"Fan Journey Analysis",showOptimizationTips:!0})]}),N&&N.total_revenue>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Jt,{className:"w-5 h-5 text-synth-pink"}),"Revenue Attribution"]}),s.jsx(uq,{sources:N.top_revenue_sources.map(G=>({source:G.source,revenue:G.revenue,percentage:G.percentage,confidence_score:.8,attribution_window:24})),totalRevenue:N.total_revenue,title:"Revenue Sources",showConfidenceScores:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Xt,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Venues"})]}),a.length>0?s.jsx("div",{className:"space-y-3",children:a.slice(0,5).map((G,X)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center text-sm font-semibold text-purple-600",children:X+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:G.venue_name}),s.jsxs("p",{className:"text-sm text-gray-500",children:[G.event_count," events"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:G.total_views}),s.jsx("p",{className:"text-sm text-gray-500",children:"views"})]})]},G.venue_name))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Xt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No venue data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(No,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Geographic Reach"})]}),l.length>0?s.jsx("div",{className:"space-y-3",children:l.slice(0,5).map((G,X)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm font-semibold text-blue-600",children:X+1}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900",children:[G.city,", ",G.state]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[G.event_count," events"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:G.fan_count}),s.jsx("p",{className:"text-sm text-gray-500",children:"fans"})]})]},`${G.city}-${G.state}`))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(No,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]})]})]}),p==="fans"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Venue Performance"}),a.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Venue"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Events"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Views"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Engagement"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Fan Density"})]})}),s.jsx("tbody",{children:a.map(G=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:G.venue_name}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:G.event_count}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:G.total_views}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:G.engagement_score}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:G.fan_density})]},G.venue_name))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ar,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No fan insights available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Geographic Distribution"}),l.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Location"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Fans"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Events"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Engagement"})]})}),s.jsx("tbody",{children:l.map(G=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsxs("td",{className:"py-3 px-4 font-medium text-gray-900",children:[G.city,", ",G.state]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:G.fan_count}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:G.event_count}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[G.engagement_rate,"%"]})]},`${G.city}-${G.state}`))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(No,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]})]}),p==="content"&&s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Content Performance"}),d.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Date"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Event Views"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Profile Visits"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Follower Gains"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Engagement"})]})}),s.jsx("tbody",{children:d.map(G=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:new Date(G.date).toLocaleDateString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:G.event_views}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:G.profile_visits}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:G.follower_gains}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[G.engagement_rate,"%"]})]},G.date))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Et,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No content performance data available"})]})]}),p==="achievements"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[s.jsx(Sd,{className:"w-8 h-8 text-yellow-500"}),s.jsx("h2",{className:"gradient-text text-2xl font-bold",children:"Creator Achievements"})]}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Track your milestones as a creator and artist"})]}),["follower","engagement","venue","revenue"].map(G=>{const X=h.filter(se=>se.category===G),te={follower:"Follower Milestones",engagement:"Engagement Goals",venue:"Venue Performance",revenue:"Revenue Targets"};return s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(bl,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:te[G]})]}),X.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:X.map(se=>s.jsx(T4,{name:se.name,description:se.description,icon:se.icon,progress:se.progress,goal:se.goal,unlocked:se.unlocked,unlockedAt:se.unlockedAt,compact:!0},se.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(bl,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No achievements in this category yet"})]})]},G)})]}),p==="promotions"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Promotion Analytics"}),V&&s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live"]})]}),s.jsx("p",{className:"text-gray-600",children:"Track your event promotion performance and ROI"}),Y&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Last updated: ",Y.toLocaleTimeString()]})]})}),$.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Sn,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Promotions Yet"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Start promoting your events to see detailed analytics here"}),s.jsx("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Promote Your First Event"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:$.slice(0,3).map(G=>s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold text-lg truncate",children:G.event.title}),s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${G.promotion_tier==="featured"?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800":G.promotion_tier==="premium"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:G.promotion_tier})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Impressions"}),s.jsx("p",{className:"text-xl font-bold",children:G.impressions.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Clicks"}),s.jsx("p",{className:"text-xl font-bold",children:G.clicks.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Conversions"}),s.jsx("p",{className:"text-xl font-bold text-green-600",children:G.conversions.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"CTR"}),s.jsxs("p",{className:"text-xl font-bold",children:[(G.clicks/G.impressions*100).toFixed(1),"%"]})]})]})]},G.id))}),s.jsx(VG,{data:B.map(G=>({date:G.date,impressions:G.impressions||0,clicks:G.clicks||0,conversions:G.conversions||0,spend:G.spend||0})),className:"bg-white rounded-xl shadow-sm border"}),F.length>0&&s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Promotion Comparison"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b",children:[s.jsx("th",{className:"text-left py-2",children:"Event"}),s.jsx("th",{className:"text-left py-2",children:"Tier"}),s.jsx("th",{className:"text-left py-2",children:"Impressions"}),s.jsx("th",{className:"text-left py-2",children:"Clicks"}),s.jsx("th",{className:"text-left py-2",children:"Conversions"}),s.jsx("th",{className:"text-left py-2",children:"CTR"}),s.jsx("th",{className:"text-left py-2",children:"ROI"})]})}),s.jsx("tbody",{children:F.slice(0,5).map(G=>s.jsxs("tr",{className:"border-b",children:[s.jsx("td",{className:"py-2 font-medium truncate max-w-32",children:G.event_title}),s.jsx("td",{className:"py-2",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs ${G.tier==="featured"?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800":G.tier==="premium"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:G.tier})}),s.jsx("td",{className:"py-2",children:G.impressions.toLocaleString()}),s.jsx("td",{className:"py-2",children:G.clicks.toLocaleString()}),s.jsx("td",{className:"py-2",children:G.conversions.toLocaleString()}),s.jsxs("td",{className:"py-2",children:[G.ctr.toFixed(1),"%"]}),s.jsx("td",{className:"py-2",children:s.jsxs("span",{className:`font-semibold ${G.roi>=0?"text-green-600":"text-red-600"}`,children:[G.roi>=0?"+":"",G.roi.toFixed(1),"%"]})})]},G.promotion_id))})]})})]})]})]})]})})}class Zd{static getBusinessStats(t){return E(this,null,function*(){try{console.log(" BusinessAnalyticsService: Getting business stats for user:",t);const{data:r,error:n}=yield P.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published");if(n)throw console.error("Error fetching business events:",n),n;if(console.log(" BusinessAnalyticsService: Found events:",(r==null?void 0:r.length)||0),!r||r.length===0)return console.log(" BusinessAnalyticsService: No events found, returning default stats"),{total_events:0,total_attendees:0,total_revenue:0,conversion_rate:0,customer_satisfaction:0,repeat_customer_rate:0,avg_event_attendance:0,revenue_growth_rate:0};const i=r.map(N=>N.id),a=yield ns.getAllUserInteractions(i,void 0,["event"]),o=yield ns.getAllUserReviews(i),l=yield ns.getAllInterestedUsers(i),c=r.length,d=(a==null?void 0:a.filter(N=>N.event_type==="view").length)||0,u=(a==null?void 0:a.filter(N=>N.event_type==="click_ticket").length)||0,h=(o==null?void 0:o.length)||0,f=(l==null?void 0:l.length)||0,p=d>0?u/d*100:0,x=(o==null?void 0:o.length)>0?o.reduce((N,S)=>N+(S.rating||0),0)/o.length:0,g=new Set((l==null?void 0:l.map(N=>N.user_id))||[]),v=Array.from(g).filter(N=>(l==null?void 0:l.filter(S=>S.user_id===N).length)>1).length,_=g.size>0?v/g.size*100:0,w=c>0?f/c:0;return{total_events:c,total_attendees:f,total_revenue:0,conversion_rate:Math.round(p*100)/100,customer_satisfaction:Math.round(x*100)/100,repeat_customer_rate:Math.round(_*100)/100,avg_event_attendance:Math.round(w*100)/100,revenue_growth_rate:0}}catch(r){return console.error("Error getting business stats:",r),{total_events:0,total_attendees:0,total_revenue:0,conversion_rate:0,customer_satisfaction:0,repeat_customer_rate:0,avg_event_attendance:0,revenue_growth_rate:0}}})}static getEventPerformance(t){return E(this,null,function*(){try{console.log(" BusinessAnalyticsService: Getting event performance for user:",t);const{data:r,error:n}=yield P.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published");if(n)throw console.error("Error fetching business events for performance:",n),n;if(console.log(" BusinessAnalyticsService: Found events for performance:",(r==null?void 0:r.length)||0),!r||r.length===0)return console.log(" BusinessAnalyticsService: No events found for performance, returning empty array"),[];const i=r.map(d=>d.id),a=yield ns.getAllUserInteractions(i,void 0,["event"]),o=yield ns.getAllUserReviews(i),l=yield ns.getAllInterestedUsers(i);return r.map(d=>{const u=(a==null?void 0:a.filter(w=>w.entity_id===d.id))||[],h=(o==null?void 0:o.filter(w=>w.event_id===d.id))||[],f=(l==null?void 0:l.filter(w=>w.event_id===d.id))||[],p=u.filter(w=>w.event_type==="view").length,x=u.filter(w=>w.event_type==="click_ticket").length,g=h.length>0?h.reduce((w,b)=>w+(b.rating||0),0)/h.length:0,v=0,_=p>0?f.length/p*100:0;return{event_id:d.id,title:d.title,artist_name:d.artist_name,event_date:d.event_date,venue_name:d.venue_name,total_views:p,total_interested:f.length,ticket_clicks:x,reviews_count:h.length,avg_rating:Math.round(g*100)/100,revenue_generated:v,attendance_rate:Math.round(_*100)/100}}).sort((d,u)=>u.revenue_generated-d.revenue_generated)}catch(r){return console.error("Error getting event performance:",r),[]}})}static getCustomerInsights(t){return E(this,null,function*(){try{console.log(" BusinessAnalyticsService: Getting customer insights for user:",t);const{data:r,error:n}=yield P.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published");if(n)throw console.error("Error fetching business events for customer insights:",n),n;if(console.log(" BusinessAnalyticsService: Found events for customer insights:",(r==null?void 0:r.length)||0),!r||r.length===0)return console.log(" BusinessAnalyticsService: No events found for customer insights, returning empty array"),[];const i=r.map(h=>h.id),{data:a}=yield P.from("user_event_relationships").select("*").in("relationship_type",["interested","going","maybe"]).in("event_id",i),{data:o}=yield P.from("reviews").select("*").in("event_id",i),l=new Map,c=new Map;return a==null||a.forEach(h=>{const f=l.get(h.user_id)||0;l.set(h.user_id,f+1)}),o==null||o.forEach(h=>{c.has(h.user_id)||c.set(h.user_id,[]),c.get(h.user_id).push(h.rating||0)}),Object.entries({"New Customers":{min:1,max:1},"Regular Customers":{min:2,max:4},"VIP Customers":{min:5,max:1/0}}).map(([h,f])=>{const p=Array.from(l.entries()).filter(([k,O])=>O>=f.min&&O<=f.max),x=l.size,g=p.length,v=x>0?g/x*100:0,_=g>0?p.reduce((k,[O,A])=>k+A,0)/g:0,w=_*50,b=p.map(([k,O])=>c.get(k)||[]),N=b.length>0?b.reduce((k,O)=>k+O.reduce((A,T)=>A+T,0)/O.length,0)/b.length:0,S=_*20+N*10;return{customer_segment:h,count:g,percentage:Math.round(v*100)/100,avg_events_attended:Math.round(_*100)/100,avg_spending:Math.round(w*100)/100,loyalty_score:Math.round(S*100)/100}})}catch(r){return console.error("Error getting customer insights:",r),[]}})}static getRevenueInsights(t,r=30){return E(this,null,function*(){try{const n=new Date;n.setDate(n.getDate()-r);const{data:i,error:a}=yield P.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published").gte("event_date",n.toISOString());if(a)throw console.error("Error fetching business events for revenue insights:",a),a;if(console.log(" BusinessAnalyticsService: Found events for revenue insights:",(i==null?void 0:i.length)||0),!i||i.length===0)return[];const o=i.map(u=>u.id),{data:l}=yield P.from("interactions").select("*").in("entity_id",o).eq("entity_type","event").gte("created_at",n.toISOString()),c=new Map;return l==null||l.forEach(u=>{const h=new Date(u.created_at).toISOString().split("T")[0];c.has(h)||c.set(h,{revenue:0,ticketClicks:0,views:0});const f=c.get(h);u.event_type==="view"?f.views++:u.event_type==="click_ticket"&&(f.ticketClicks++,f.revenue+=0)}),Array.from(c.entries()).map(([u,h])=>{const f=h.views>0?h.ticketClicks/h.views*100:0,p=h.ticketClicks>0?h.revenue/h.ticketClicks:0;return{date:u,revenue:h.revenue,ticket_clicks:h.ticketClicks,conversion_rate:Math.round(f*100)/100,avg_ticket_price:Math.round(p*100)/100}}).sort((u,h)=>new Date(u.date).getTime()-new Date(h.date).getTime())}catch(n){return console.error("Error getting revenue insights:",n),[]}})}static getArtistPerformance(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("events").select("*").eq("created_by_user_id",t).eq("event_status","published");if(n)throw console.error("Error fetching business events for artist performance:",n),n;if(console.log(" BusinessAnalyticsService: Found events for artist performance:",(r==null?void 0:r.length)||0),!r||r.length===0)return[];const i=r.map(p=>p.id),[a,o,l]=yield Promise.all([P.from("interactions").select("*").in("entity_id",i).eq("entity_type","event"),P.from("reviews").select("*").in("event_id",i),P.from("user_event_relationships").select("*").in("relationship_type",["interested","going","maybe"]).in("event_id",i)]),c=a.data||[],d=o.data||[],u=l.data||[],h=new Map;return r.forEach(p=>{const x=p.artist_name;h.has(x)||h.set(x,{events:[],interactions:[],reviews:[],interested:[]}),h.get(x).events.push(p)}),c.forEach(p=>{var g;const x=r.find(v=>v.id===p.entity_id);x&&((g=h.get(x.artist_name))==null||g.interactions.push(p))}),d.forEach(p=>{var g;const x=r.find(v=>v.id===p.event_id);x&&((g=h.get(x.artist_name))==null||g.reviews.push(p))}),u.forEach(p=>{var g;const x=r.find(v=>v.id===p.event_id);x&&((g=h.get(x.artist_name))==null||g.interested.push(p))}),Array.from(h.entries()).map(([p,x])=>{const g=x.events.length,v=x.interactions.filter(O=>O.event_type==="view").length,_=x.interactions.filter(O=>O.event_type==="click_ticket").length*50,w=x.reviews.length>0?x.reviews.reduce((O,A)=>O+(A.rating||0),0)/x.reviews.length:0,b=w*20,N=new Set(x.interested.map(O=>O.user_id)),S=Array.from(N).filter(O=>x.interested.filter(A=>A.user_id===O).length>1).length,k=N.size>0?S/N.size*100:0;return{artist_name:p,events_count:g,total_views:v,avg_rating:Math.round(w*100)/100,total_revenue:_,customer_satisfaction:Math.round(b*100)/100,repeat_rate:Math.round(k*100)/100}}).sort((p,x)=>x.total_revenue-p.total_revenue)}catch(r){return console.error("Error getting artist performance:",r),[]}})}static getBusinessAchievements(t){return E(this,null,function*(){try{const r=yield this.getBusinessStats(t),n=yield this.getEventPerformance(t),i=yield this.getCustomerInsights(t);return[{id:"first_event",name:"First Event",description:"Host your first event",icon:"",progress:Math.min(r.total_events,1),goal:1,unlocked:r.total_events>=1,category:"events"},{id:"busy_venue",name:"Busy Venue",description:"Host 10 events",icon:"",progress:Math.min(r.total_events,10),goal:10,unlocked:r.total_events>=10,category:"events"},{id:"event_venue",name:"Event Venue",description:"Host 50 events",icon:"",progress:Math.min(r.total_events,50),goal:50,unlocked:r.total_events>=50,category:"events"},{id:"first_revenue",name:"First Revenue",description:"Generate $1,000 in ticket revenue",icon:"",progress:Math.min(r.total_revenue,1e3),goal:1e3,unlocked:r.total_revenue>=1e3,category:"revenue"},{id:"revenue_generator",name:"Revenue Generator",description:"Generate $10,000 in ticket revenue",icon:"",progress:Math.min(r.total_revenue,1e4),goal:1e4,unlocked:r.total_revenue>=1e4,category:"revenue"},{id:"high_conversion",name:"High Conversion",description:"Achieve 10% conversion rate",icon:"",progress:Math.min(r.conversion_rate,10),goal:10,unlocked:r.conversion_rate>=10,category:"growth"},{id:"customer_satisfaction",name:"Customer Satisfaction",description:"Achieve 4.5+ average rating",icon:"",progress:Math.min(r.customer_satisfaction,4.5),goal:4.5,unlocked:r.customer_satisfaction>=4.5,category:"customers"},{id:"loyal_customers",name:"Loyal Customers",description:"Achieve 30% repeat customer rate",icon:"",progress:Math.min(r.repeat_customer_rate,30),goal:30,unlocked:r.repeat_customer_rate>=30,category:"customers"},{id:"popular_venue",name:"Popular Venue",description:"Attract 1,000 total attendees",icon:"",progress:Math.min(r.total_attendees,1e3),goal:1e3,unlocked:r.total_attendees>=1e3,category:"growth"},{id:"successful_business",name:"Successful Business",description:"Generate $50,000 in total revenue",icon:"",progress:Math.min(r.total_revenue,5e4),goal:5e4,unlocked:r.total_revenue>=5e4,category:"revenue"}]}catch(r){return console.error("Error getting business achievements:",r),[]}})}static exportBusinessData(t){return E(this,null,function*(){const[r,n,i,a,o,l]=yield Promise.all([this.getBusinessStats(t),this.getEventPerformance(t),this.getCustomerInsights(t),this.getRevenueInsights(t),this.getArtistPerformance(t),this.getBusinessAchievements(t)]);return{stats:r,eventPerformance:n,customerInsights:i,revenueInsights:a,artistPerformance:o,achievements:l}})}}class xN{static getVIPCustomers(t,r=50){return E(this,null,function*(){try{console.log(" VIPAnalyticsService: Getting VIP customers for user:",t);const{data:n,error:i}=yield P.from("events").select("id").eq("created_by_user_id",t);if(i)throw console.error("Error fetching user events for VIP analysis:",i),i;if(!n||n.length===0)return console.log(" VIPAnalyticsService: No events found, returning empty VIP list"),[];const a=n.map(_=>_.id),{data:o,error:l}=yield P.from("interactions").select("user_id, event_type, entity_type, occurred_at").in("entity_id",a).eq("entity_type","event");if(l)throw console.error("Error fetching interactions for VIP analysis:",l),l;const{data:c,error:d}=yield P.from("user_event_relationships").select("user_id, event_id").in("relationship_type",["interested","going","maybe"]).in("event_id",a);if(d)throw console.error("Error fetching interested users for VIP analysis:",d),d;const{data:u,error:h}=yield P.from("reviews").select("user_id, event_id, review_text, rating, created_at").in("event_id",a).eq("is_draft",!1);if(h)throw console.error("Error fetching reviews for VIP analysis:",h),h;const f=[...new Set([...(o==null?void 0:o.map(_=>_.user_id))||[],...(c==null?void 0:c.map(_=>_.user_id))||[],...(u==null?void 0:u.map(_=>_.user_id))||[]])];if(f.length===0)return console.log(" VIPAnalyticsService: No users found, returning empty VIP list"),[];const x=(yield ns.getAllProfiles()).filter(_=>f.includes(_.user_id)),g=[];for(const _ of x||[]){const w=(o==null?void 0:o.filter(R=>R.user_id===_.user_id))||[],b=(c==null?void 0:c.filter(R=>R.user_id===_.user_id))||[],N=(u==null?void 0:u.filter(R=>R.user_id===_.user_id))||[],S=0,k=b.length,O=N.length,A=w.length;let T=0;T+=Math.min(S*5,30),T+=Math.min(k*2,20),T+=Math.min(O*4,20),T+=Math.min(A*.5,15);const $=_.subscription_tier==="premium"?15:_.subscription_tier==="professional"?12:_.subscription_tier==="enterprise"?15:0;if(T+=$,T>=20){const R=Math.floor((Date.now()-new Date(_.created_at).getTime())/864e5),F=w.length>0?w.sort((B,U)=>new Date(U.occurred_at).getTime()-new Date(B.occurred_at).getTime())[0].occurred_at:_.created_at;let D;T>=80?D="platinum":T>=60?D="gold":T>=40?D="silver":D="bronze",g.push({user_id:_.user_id,email:"",display_name:_.name||"Anonymous User",vip_score:Math.round(T),vip_tier:D,total_events_attended:S,total_events_interested:k,total_reviews_written:O,total_spending:0,subscription_tier:_.subscription_tier||"free",account_age_days:R,last_activity:F,engagement_score:Math.round(A/Math.max(R,1)*100)/100})}}const v=g.sort((_,w)=>w.vip_score-_.vip_score);return console.log(" VIPAnalyticsService: Found VIP customers:",v.length),v.slice(0,r)}catch(n){throw console.error("Error getting VIP customers:",n),n}})}static getVIPMetrics(t){return E(this,null,function*(){try{console.log(" VIPAnalyticsService: Getting VIP metrics for user:",t);const r=yield this.getVIPCustomers(t,1e3);if(r.length===0)return{total_vip_customers:0,vip_by_tier:{bronze:0,silver:0,gold:0,platinum:0},vip_growth_rate:0,avg_vip_score:0,vip_retention_rate:0,vip_revenue_contribution:0};const n=r.reduce((d,u)=>(d[u.vip_tier]++,d),{bronze:0,silver:0,gold:0,platinum:0}),i=r.reduce((d,u)=>d+u.vip_score,0)/r.length,a=new Date(Date.now()-30*24*60*60*1e3),l=r.filter(d=>new Date(d.last_activity)>a).length/r.length*100,c=r.reduce((d,u)=>d+u.total_spending,0);return console.log(" VIPAnalyticsService: VIP metrics calculated:",{total:r.length,tiers:n,avgScore:Math.round(i),retention:Math.round(l)}),{total_vip_customers:r.length,vip_by_tier:n,vip_growth_rate:0,avg_vip_score:Math.round(i*100)/100,vip_retention_rate:Math.round(l*100)/100,vip_revenue_contribution:c}}catch(r){throw console.error("Error getting VIP metrics:",r),r}})}static getVIPTrends(t,r=30){return E(this,null,function*(){try{console.log(" VIPAnalyticsService: Getting VIP trends for user:",t);const n=[],i=new Date;for(let a=r-1;a>=0;a--){const o=new Date(i);o.setDate(o.getDate()-a),n.push({date:o.toISOString().split("T")[0],total_vips:Math.floor(Math.random()*10)+5,new_vips:Math.floor(Math.random()*3),vip_revenue:Math.floor(Math.random()*1e3)+500})}return console.log(" VIPAnalyticsService: VIP trends generated:",n.length,"days"),n}catch(n){throw console.error("Error getting VIP trends:",n),n}})}}function P$e(e){return E(this,null,function*(){try{console.log(" Syncing all promotion metrics for user:",e);const{data:t,error:r}=yield P.from("event_promotions").select("id, event_id").eq("promoted_by_user_id",e);if(r){console.error("Error fetching user promotions:",r);return}if(!t||t.length===0){console.log("No promotions found for user");return}console.log(`Found ${t.length} promotions to sync`);for(const n of t)try{yield dl.syncPromotionMetrics(n.id),console.log(` Synced promotion ${n.id}`)}catch(i){console.error(` Error syncing promotion ${n.id}:`,i)}console.log(" All promotion metrics synced successfully!")}catch(t){console.error("Error syncing user promotions:",t)}})}function A$e(){const{user:e}=os(),[t,r]=y.useState(!0),[n,i]=y.useState(null),[a,o]=y.useState([]),[l,c]=y.useState([]),[d,u]=y.useState([]),[h,f]=y.useState([]),[p,x]=y.useState([]),[g,v]=y.useState("overview"),[_,w]=y.useState(!1),b=()=>E(this,null,function*(){if(e){w(!0);try{console.log(" BusinessAnalyticsDashboard: Loading promotion data...");const[H,le,Se]=yield Promise.allSettled([Ua.getUserPromotions(e.id),Ua.getPromotionPerformanceComparison(e.id),Ua.getPromotionTrends(e.id,30)]).then(ae=>ae.map(fe=>fe.status==="fulfilled"?fe.value:[]));console.log(" BusinessAnalyticsDashboard: Promotion data loaded:",{promotions:H.length,comparisons:le.length,trends:Se.length}),B(H),V(le),z(Se)}catch(H){console.error("Error loading promotion data:",H)}finally{w(!1)}}}),N=()=>E(this,null,function*(){if(e){ye(!0);try{console.log(" BusinessAnalyticsDashboard: Loading VIP data...");const[H,le,Se]=yield Promise.allSettled([xN.getVIPCustomers(e.id,20),xN.getVIPMetrics(e.id),xN.getVIPTrends(e.id,30)]).then(ae=>ae.map(fe=>fe.status==="fulfilled"?fe.value:[]));console.log(" BusinessAnalyticsDashboard: VIP data loaded:",{customers:Array.isArray(H)?H.length:0,metrics:le,trends:Array.isArray(Se)?Se.length:0}),Z(Array.isArray(H)?H:[]),X(le&&typeof le=="object"&&!Array.isArray(le)?le:null),se(Array.isArray(Se)?Se:[])}catch(H){console.error("Error loading VIP data:",H)}finally{ye(!1)}}}),[S,k]=y.useState(null),[O,A]=y.useState(null),[T,$]=y.useState([]),[R,F]=y.useState(null),[D,B]=y.useState([]),[U,V]=y.useState([]),[Y,z]=y.useState([]),[K,Z]=y.useState([]),[G,X]=y.useState(null),[te,se]=y.useState([]),[ue,ye]=y.useState(!1),{isLive:ne,lastUpdate:xe}=mq({userId:(e==null?void 0:e.id)||"",enabled:!!e});y.useEffect(()=>{e&&ge()},[e]),y.useEffect(()=>{g==="promotions"&&e&&b()},[g,e]),y.useEffect(()=>{g==="customers"&&e&&N()},[g,e]);const ge=()=>E(this,null,function*(){if(e)try{r(!0),console.log(" BusinessAnalyticsDashboard: Fetching business data for user:",e.id),console.log(" BusinessAnalyticsDashboard: Loading analytics for user:",e.id);const[H,le,Se,ae,fe,he]=yield Promise.all([Zd.getBusinessStats(e.id),Zd.getEventPerformance(e.id),Zd.getCustomerInsights(e.id),Zd.getRevenueInsights(e.id),Zd.getArtistPerformance(e.id),Zd.getBusinessAchievements(e.id)]);i(H),o(le),c(Se),u(ae),f(fe),x(he),yield ie()}catch(H){console.error("Error fetching business data:",H)}finally{r(!1)}}),ie=()=>E(this,null,function*(){try{const H={start:new Date(Date.now()-2592e6),end:new Date},le=yield O4.analyzeFunnel("business",H);k(le);const Se=yield hh.getUserRevenueMetrics((e==null?void 0:e.id)||"",H);A(Se);const ae=d.map(he=>({date:he.date,value:he.revenue,label:"Daily Revenue"}));$(ae);const fe={score:(n==null?void 0:n.conversion_rate)||0,sessionDuration:0,interactionCount:(n==null?void 0:n.total_events)||0,pageViews:(n==null?void 0:n.total_events)||0,likes:(n==null?void 0:n.customer_satisfaction)||0,shares:0,comments:0,bounceRate:0};if(F(fe),e){const[he,pe,Ae]=yield Promise.all([Ua.getUserPromotions(e.id),Ua.getPromotionPerformanceComparison(e.id),Ua.getPromotionTrends(e.id,30)]);B(he),V(pe),z(Ae)}}catch(H){console.error("Error loading enhanced analytics:",H)}}),ee=()=>E(this,null,function*(){if(e)try{const le=yield Zd.exportBusinessData("Sample Venue"),Se=new Blob([JSON.stringify(le,null,2)],{type:"application/json"}),ae=URL.createObjectURL(Se),fe=document.createElement("a");fe.href=ae,fe.download=`business-analytics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(fe),fe.click(),document.body.removeChild(fe),URL.revokeObjectURL(ae)}catch(H){console.error("Error exporting data:",H)}});return t?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsx(Wa,{})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((H,le)=>s.jsx(Wa,{},le))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(Wa,{}),s.jsx(Wa,{})]})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(Ba,{className:"w-8 h-8 text-blue-600"}),s.jsx("h1",{className:"gradient-text text-3xl font-bold",children:"Business Analytics"})]}),s.jsx("p",{className:"text-gray-600",children:"Track your venue performance, revenue, and customer insights"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:ee,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[s.jsx(yv,{className:"w-4 h-4"}),"Export Data"]}),s.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all",children:"Upgrade to Pro"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(Xi,{title:"Total Events",value:(n==null?void 0:n.total_events)||0,icon:s.jsx(Et,{className:"w-6 h-6"}),trend:"neutral"}),s.jsx(Xi,{title:"Total Revenue",value:`$${((n==null?void 0:n.total_revenue)||0).toLocaleString()}`,icon:s.jsx(bo,{className:"w-6 h-6"}),trend:(n==null?void 0:n.revenue_growth_rate)>0?"up":(n==null?void 0:n.revenue_growth_rate)<0?"down":"neutral"}),s.jsx(Xi,{title:"Conversion Rate",value:`${(n==null?void 0:n.conversion_rate)||0}%`,icon:s.jsx(So,{className:"w-6 h-6"}),trend:"neutral"}),s.jsx(Xi,{title:"Customer Satisfaction",value:`${(n==null?void 0:n.customer_satisfaction)||0}/5`,icon:s.jsx(Jt,{className:"w-6 h-6"}),trend:"neutral"})]}),s.jsx("div",{className:"mb-8",children:s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:Bu},{id:"revenue",label:"Revenue",icon:bo},{id:"customers",label:"Customers",icon:Ar},{id:"events",label:"Events",icon:Et},{id:"promotions",label:"Promotions",icon:Sn},{id:"achievements",label:"Achievements",icon:Sd}].map(H=>s.jsxs("button",{onClick:()=>v(H.id),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${g===H.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(H.icon,{className:"w-4 h-4"}),H.label]},H.id))})})}),g==="overview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[R&&s.jsx(fq,{metrics:R,title:"Business Performance Score",showBreakdown:!0}),T.length>0&&s.jsx(hq,{data:T,title:"Revenue Trends",valueLabel:"Daily Revenue",showTrend:!0})]}),S&&S.stages.length>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(So,{className:"w-5 h-5 text-synth-pink"}),"Customer Conversion Funnel"]}),s.jsx(dq,{stages:S.stages,title:"Customer Journey Analysis",showOptimizationTips:!0})]}),O&&O.total_revenue>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(bo,{className:"w-5 h-5 text-synth-pink"}),"Revenue Attribution"]}),s.jsx(uq,{sources:O.top_revenue_sources.map(H=>({source:H.source,revenue:H.revenue,percentage:H.percentage,confidence_score:.8,attribution_window:24})),totalRevenue:O.total_revenue,title:"Revenue Sources",showConfidenceScores:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Sn,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Performing Events"})]}),a.length>0?s.jsx("div",{className:"space-y-3",children:a.slice(0,5).map((H,le)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm font-semibold text-blue-600",children:le+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:H.title}),s.jsx("p",{className:"text-sm text-gray-500",children:H.artist_name})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-semibold text-gray-900",children:["$",H.revenue_generated]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[H.total_views," views"]})]})]},H.event_id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Et,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 mb-2",children:"No events created yet"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Create your first event to see performance analytics"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Gk,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Customer Segments"})]}),l.length>0?s.jsx("div",{className:"space-y-3",children:l.map((H,le)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center text-sm font-semibold text-green-600",children:le+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:H.customer_segment}),s.jsxs("p",{className:"text-sm text-gray-500",children:[H.avg_events_attended," avg events"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:H.count}),s.jsxs("p",{className:"text-sm text-gray-500",children:[H.percentage,"%"]})]})]},H.customer_segment))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ar,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 mb-2",children:"No customer data yet"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Customer insights will appear as people interact with your events"})]})]})]})]}),g==="revenue"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(bo,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Total Revenue"})]}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:["$",((n==null?void 0:n.total_revenue)||0).toLocaleString()]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(So,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Conversion Rate"})]}),s.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:[(n==null?void 0:n.conversion_rate)||0,"%"]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Sn,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Avg Ticket Price"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:"$50"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Revenue Trends"}),d.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Date"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Revenue"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Ticket Clicks"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Conversion Rate"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Avg Price"})]})}),s.jsx("tbody",{children:d.slice(-10).map(H=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:new Date(H.date).toLocaleDateString()}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",H.revenue]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:H.ticket_clicks}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[H.conversion_rate,"%"]}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",H.avg_ticket_price]})]},H.date))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(bo,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No revenue data available"})]})]})]}),g==="customers"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ar,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Attendees"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:((n==null?void 0:n.total_attendees)||0).toLocaleString()})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(eQ,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Repeat Rate"})]}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[(n==null?void 0:n.repeat_customer_rate)||0,"%"]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Jt,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"Satisfaction"})]}),s.jsxs("p",{className:"text-2xl font-bold text-yellow-900",children:[(n==null?void 0:n.customer_satisfaction)||0,"/5"]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Customer Segmentation"}),l.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Segment"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Count"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Percentage"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Avg Events"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Avg Spending"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Loyalty Score"})]})}),s.jsx("tbody",{children:l.map(H=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:H.customer_segment}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:H.count}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[H.percentage,"%"]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:H.avg_events_attended}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",H.avg_spending]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:H.loyalty_score})]},H.customer_segment))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ar,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No customer data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"VIP Customers"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Your most engaged and valuable customers"})]}),s.jsxs("button",{onClick:N,disabled:ue,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors flex items-center gap-2",children:[s.jsx(Sa,{className:`w-4 h-4 ${ue?"animate-spin":""}`}),"Refresh"]})]}),ue?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(er,{className:"w-8 h-8 animate-spin text-purple-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading VIP customers..."})]}):K.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(zu,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No VIP Customers Yet"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"VIP customers will appear as people engage more with your events"}),s.jsx("p",{className:"text-sm text-gray-400",children:"VIP status is based on event attendance, reviews, and engagement"})]}):s.jsxs("div",{className:"space-y-6",children:[G&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(zu,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-700",children:"Total VIPs"})]}),s.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:G.total_vip_customers})]}),s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Sn,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Avg Score"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:G.avg_vip_score})]}),s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Ar,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-700",children:"Retention"})]}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[G.vip_retention_rate,"%"]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(bo,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Revenue"})]}),s.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:["$",G.vip_revenue_contribution]})]})]}),G&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"VIP Tier Distribution"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(G.vip_by_tier).map(([H,le])=>s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`w-12 h-12 rounded-full mx-auto mb-2 flex items-center justify-center text-white font-bold ${H==="platinum"?"bg-gradient-to-r from-gray-400 to-gray-600":H==="gold"?"bg-gradient-to-r from-yellow-400 to-yellow-600":H==="silver"?"bg-gradient-to-r from-gray-300 to-gray-500":"bg-gradient-to-r from-orange-400 to-orange-600"}`,children:H.charAt(0).toUpperCase()}),s.jsx("p",{className:"text-sm font-medium text-gray-900 capitalize",children:H}),s.jsx("p",{className:"text-lg font-bold text-gray-700",children:le})]},H))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Top VIP Customers"}),s.jsx("div",{className:"space-y-3",children:K.slice(0,10).map((H,le)=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold ${H.vip_tier==="platinum"?"bg-gradient-to-r from-gray-400 to-gray-600":H.vip_tier==="gold"?"bg-gradient-to-r from-yellow-400 to-yellow-600":H.vip_tier==="silver"?"bg-gradient-to-r from-gray-300 to-gray-500":"bg-gradient-to-r from-orange-400 to-orange-600"}`,children:le+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:H.display_name}),s.jsxs("p",{className:"text-sm text-gray-500 capitalize",children:[H.vip_tier," VIP  ",H.engagement_score," engagement"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-semibold text-gray-900",children:[H.vip_score," pts"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[H.total_events_attended," events"]})]})]},H.user_id))})]})]})]})]}),g==="events"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Event Performance"}),a.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Event"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Artist"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Date"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Views"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Interested"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Revenue"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Rating"})]})}),s.jsx("tbody",{children:a.map(H=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:H.title}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:H.artist_name}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:new Date(H.event_date).toLocaleDateString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:H.total_views}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:H.total_interested}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",H.revenue_generated]}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[H.avg_rating,"/5"]})]},H.event_id))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Et,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No event data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Artist Performance"}),h.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Artist"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Events"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Views"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Revenue"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Rating"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Repeat Rate"})]})}),s.jsx("tbody",{children:h.map(H=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:H.artist_name}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:H.events_count}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:H.total_views}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:["$",H.total_revenue]}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[H.avg_rating,"/5"]}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[H.repeat_rate,"%"]})]},H.artist_name))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Sn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No artist performance data available"})]})]})]}),g==="achievements"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[s.jsx(Sd,{className:"w-8 h-8 text-yellow-500"}),s.jsx("h2",{className:"gradient-text text-2xl font-bold",children:"Business Achievements"})]}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Track your business milestones and growth metrics"})]}),["events","revenue","customers","growth"].map(H=>{const le=p.filter(ae=>ae.category===H),Se={events:"Event Hosting",revenue:"Revenue Goals",customers:"Customer Satisfaction",growth:"Growth Metrics"};return s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(bl,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Se[H]})]}),le.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:le.map(ae=>s.jsx(T4,{name:ae.name,description:ae.description,icon:ae.icon,progress:ae.progress,goal:ae.goal,unlocked:ae.unlocked,unlockedAt:ae.unlockedAt,compact:!0},ae.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(bl,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No achievements in this category yet"})]})]},H)})]}),g==="promotions"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Promotion Analytics"}),ne&&s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live"]})]}),s.jsx("p",{className:"text-gray-600",children:"Track your venue's event promotion performance and ROI"}),xe&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Last updated: ",xe.toLocaleTimeString()]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>E(this,null,function*(){e&&(yield P$e(e.id),yield b())}),className:"px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded-lg transition-colors flex items-center gap-2",children:[s.jsx(Sn,{className:"w-4 h-4"}),"Sync Metrics"]}),s.jsxs("button",{onClick:b,disabled:_,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors flex items-center gap-2",children:[s.jsx(Sa,{className:`w-4 h-4 ${_?"animate-spin":""}`}),"Refresh"]})]})]}),_?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(er,{className:"w-8 h-8 animate-spin text-purple-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading promotion data..."})]}):D.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Sn,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Promotions Yet"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Start promoting your venue's events to see detailed analytics here"}),s.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Promote Your First Event"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:D.slice(0,3).map(H=>s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold text-lg truncate",children:H.event.title}),s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${H.promotion_tier==="featured"?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800":H.promotion_tier==="premium"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:H.promotion_tier})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Impressions"}),s.jsx("p",{className:"text-xl font-bold",children:H.impressions.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Clicks"}),s.jsx("p",{className:"text-xl font-bold",children:H.clicks.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Conversions"}),s.jsx("p",{className:"text-xl font-bold text-green-600",children:H.conversions.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"CTR"}),s.jsxs("p",{className:"text-xl font-bold",children:[(H.clicks/H.impressions*100).toFixed(1),"%"]})]})]})]},H.id))}),s.jsx(VG,{data:Y.map(H=>({date:H.date,impressions:H.impressions||0,clicks:H.clicks||0,conversions:H.conversions||0,spend:H.spend||0})),className:"bg-white rounded-xl shadow-sm border"}),U.length>0&&s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Promotion Comparison"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b",children:[s.jsx("th",{className:"text-left py-2",children:"Event"}),s.jsx("th",{className:"text-left py-2",children:"Tier"}),s.jsx("th",{className:"text-left py-2",children:"Impressions"}),s.jsx("th",{className:"text-left py-2",children:"Clicks"}),s.jsx("th",{className:"text-left py-2",children:"Conversions"}),s.jsx("th",{className:"text-left py-2",children:"CTR"}),s.jsx("th",{className:"text-left py-2",children:"ROI"})]})}),s.jsx("tbody",{children:U.slice(0,5).map(H=>s.jsxs("tr",{className:"border-b",children:[s.jsx("td",{className:"py-2 font-medium truncate max-w-32",children:H.event_title}),s.jsx("td",{className:"py-2",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs ${H.tier==="featured"?"bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800":H.tier==="premium"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:H.tier})}),s.jsx("td",{className:"py-2",children:H.impressions.toLocaleString()}),s.jsx("td",{className:"py-2",children:H.clicks.toLocaleString()}),s.jsx("td",{className:"py-2",children:H.conversions.toLocaleString()}),s.jsxs("td",{className:"py-2",children:[H.ctr.toFixed(1),"%"]}),s.jsx("td",{className:"py-2",children:s.jsxs("span",{className:`font-semibold ${H.roi>=0?"text-green-600":"text-red-600"}`,children:[H.roi>=0?"+":"",H.roi.toFixed(1),"%"]})})]},H.promotion_id))})]})})]})]})]})]})})}class ks{static getPlatformStats(){return E(this,null,function*(){try{const{count:t}=yield P.from("users").select("*",{count:"exact",head:!0}),{count:r}=yield P.from("events").select("*",{count:"exact",head:!0}),i=(yield ns.getAllUserInteractions()).length,a=new Date;a.setHours(0,0,0,0);const o=new Date(a);o.setHours(23,59,59,999);const{count:l}=yield P.from("users").select("*",{count:"exact",head:!0}).gte("last_active_at",a.toISOString()).lte("last_active_at",o.toISOString()),c=new Date;c.setDate(c.getDate()-29),c.setHours(0,0,0,0);const{count:d}=yield P.from("users").select("*",{count:"exact",head:!0}).gte("last_active_at",c.toISOString()),u=new Date;u.setDate(1);const{count:h}=yield P.from("users").select("*",{count:"exact",head:!0}).gte("created_at",u.toISOString()),f=new Date;f.setMonth(f.getMonth()-1),f.setDate(1);const{count:p}=yield P.from("users").select("*",{count:"exact",head:!0}).gte("created_at",f.toISOString()).lt("created_at",u.toISOString()),x=p>0?(h-p)/p*100:0;return{total_users:t||0,total_events:r||0,total_interactions:i||0,active_users_today:l||0,daily_active_users:l||0,monthly_active_users:d||0,new_users_this_month:h||0,platform_growth_rate:x,average_session_duration:0}}catch(t){return console.error("Error getting platform stats:",t),{total_users:0,total_events:0,total_interactions:0,active_users_today:0,daily_active_users:0,monthly_active_users:0,new_users_this_month:0,platform_growth_rate:0,average_session_duration:0}}})}static getUserGrowth(t=30){return E(this,null,function*(){try{const r=new Date;r.setDate(r.getDate()-t);const{data:n}=yield P.from("users").select("created_at").gte("created_at",r.toISOString()),{data:i}=yield P.from("interactions").select("user_id, created_at").gte("created_at",r.toISOString()),a=new Map;n==null||n.forEach(c=>{const d=new Date(c.created_at).toISOString().split("T")[0];a.has(d)||a.set(d,{newUsers:0,activeUsers:new Set,totalUsers:0}),a.get(d).newUsers++}),i==null||i.forEach(c=>{const d=new Date(c.created_at).toISOString().split("T")[0];a.has(d)||a.set(d,{newUsers:0,activeUsers:new Set,totalUsers:0}),a.get(d).activeUsers.add(c.user_id)});let o=0;const l=[];return Array.from(a.entries()).sort((c,d)=>c[0].localeCompare(d[0])).forEach(([c,d])=>{o+=d.newUsers;const u=d.activeUsers.size,h=o>0?u/o*100:0;l.push({date:c,new_users:d.newUsers,active_users:u,total_users:o,retention_rate:Math.round(h*100)/100})}),l}catch(r){return console.error("Error getting user growth:",r),[]}})}static getEngagementMetrics(){return E(this,null,function*(){try{const{data:t}=yield P.from("interactions").select("*"),r=(t==null?void 0:t.filter(u=>u.event_type==="view").length)||0,n=(t==null?void 0:t.filter(u=>u.event_type==="search").length)||0,i=(t==null?void 0:t.filter(u=>u.event_type==="click_ticket").length)||0,{count:a}=yield P.from("reviews").select("*",{count:"exact",head:!0}),l=new Set((t==null?void 0:t.map(u=>u.user_id))||[]).size;return{total_page_views:r,total_sessions:l,average_session_duration:0,bounce_rate:0,events_viewed:r,searches_performed:n,reviews_written:a||0,tickets_clicked:i}}catch(t){return console.error("Error getting engagement metrics:",t),{total_page_views:0,total_sessions:0,average_session_duration:0,bounce_rate:0,events_viewed:0,searches_performed:0,reviews_written:0,tickets_clicked:0}}})}static getActiveUserMetrics(){return E(this,null,function*(){try{const t=yield ns.getAllUserInteractions(),r=new Map;t.forEach(D=>{const B=D.user_id;r.set(B,(r.get(B)||0)+1)});const n=Array.from(r.entries()).filter(([D,B])=>B>=10).map(([D])=>D),i=n.length,a=new Date,o=new Date(a);o.setDate(o.getDate()-7);const l=new Date(a);l.setDate(l.getDate()-30);const c=new Date(a);c.setDate(c.getDate()-90);const d=new Set,u=new Set,h=new Set;t.forEach(D=>{if(n.includes(D.user_id)){const B=new Date(D.occurred_at);B>=c&&h.add(D.user_id),B>=l&&u.add(D.user_id),B>=o&&d.add(D.user_id)}});const f=n.reduce((D,B)=>D+(r.get(B)||0),0),p=i>0?f/i:0,{data:x}=yield P.from("users").select("user_id, location_city, created_at").in("user_id",n),g=new Map;x==null||x.forEach(D=>{const B=D.location_city||"Unknown";g.has(B)||g.set(B,{users:0,newUsers:0});const U=g.get(B);U.users++;const V=new Date(D.created_at),Y=new Date;Y.setDate(Y.getDate()-30),V>=Y&&U.newUsers++});const v=Array.from(g.entries()).map(([D,B])=>({country:"USA",city:D,users:B.users,events:0,revenue:0,growth_rate:B.users>0?B.newUsers/B.users*100:0})).sort((D,B)=>B.users-D.users).slice(0,20),{data:_}=yield P.from("users").select("user_id, verified, trust_score, verification_criteria_met").in("user_id",n),w=(_==null?void 0:_.filter(D=>D.verified).length)||0,b=(_==null?void 0:_.reduce((D,B)=>D+(B.trust_score||0),0))||0,N=(_==null?void 0:_.length)>0?b/_.length:0,S=(_==null?void 0:_.reduce((D,B)=>{const U=B.verification_criteria_met||{};return D+Object.values(U).filter(Boolean).length},0))||0,k=(_==null?void 0:_.length)>0?S/_.length:0,O=(_==null?void 0:_.filter(D=>(D.trust_score||0)>=40&&!D.verified).length)||0,A=(x==null?void 0:x.reduce((D,B)=>{const U=(a.getTime()-new Date(B.created_at).getTime())/864e5;return D+U},0))||0,T=(x==null?void 0:x.length)>0?A/x.length:0,$=yield this.getDAUOverTime(30),R=yield this.getWeeklyActiveUsers(12),F=yield this.getMAUOverTime(12);return{total_active_users:i,active_users_7d:d.size,active_users_30d:u.size,active_users_90d:h.size,avg_interactions_per_active_user:Math.round(p*100)/100,avg_account_age_days:Math.round(T*100)/100,geographic_distribution:v,verification_stats:{total_verified:w,avg_trust_score:Math.round(N*100)/100,avg_verification_progress:Math.round(k*100)/100,users_near_verification:O},time_series_data:{daily:$,weekly:R,monthly:F}}}catch(t){return console.error("Error getting active user metrics:",t),{total_active_users:0,active_users_7d:0,active_users_30d:0,active_users_90d:0,avg_interactions_per_active_user:0,avg_account_age_days:0,geographic_distribution:[],verification_stats:{total_verified:0,avg_trust_score:0,avg_verification_progress:0,users_near_verification:0},time_series_data:{daily:[],weekly:[],monthly:[]}}}})}static getWeeklyActiveUsers(t=12){return E(this,null,function*(){try{const r=new Date;r.setDate(r.getDate()-t*7),r.setHours(0,0,0,0);const{data:n}=yield P.from("interactions").select("user_id, occurred_at").gte("occurred_at",r.toISOString()),i=new Map;return n==null||n.forEach(o=>{const l=new Date(o.occurred_at),c=new Date(l);c.setDate(l.getDate()-l.getDay()),c.setHours(0,0,0,0);const d=c.toISOString().split("T")[0];i.has(d)||i.set(d,new Set),i.get(d).add(o.user_id)}),Array.from(i.entries()).map(([o,l])=>({date:o,value:l.size})).sort((o,l)=>o.date.localeCompare(l.date))}catch(r){return console.error("Error getting weekly active users:",r),[]}})}static getContentMetrics(){return E(this,null,function*(){try{const[t,r,n,i]=yield Promise.all([P.from("events").select("*",{count:"exact",head:!0}),P.from("artists").select("*",{count:"exact",head:!0}),P.from("venues").select("*",{count:"exact",head:!0}),P.from("reviews").select("*",{count:"exact",head:!0})]),a=new Date;a.setDate(1);const{count:o}=yield P.from("events").select("*",{count:"exact",head:!0}).gte("created_at",a.toISOString()),{data:l}=yield P.from("reviews").select("rating").not("rating","is",null),c=(l==null?void 0:l.length)>0?l.reduce((u,h)=>u+(h.rating||0),0)/l.length:0;return{total_events:t.count||0,events_this_month:o||0,total_artists:r.count||0,total_venues:n.count||0,total_reviews:i.count||0,average_event_rating:Math.round(c*100)/100,content_growth_rate:0}}catch(t){return console.error("Error getting content metrics:",t),{total_events:0,events_this_month:0,total_artists:0,total_venues:0,total_reviews:0,average_event_rating:0,content_growth_rate:0}}})}static getFeatureUsage(){return E(this,null,function*(){try{const t=yield ns.getAllUserInteractions(),r={"view:event":{name:"Event Views",category:"Event Discovery"},"click:event":{name:"Event Clicks",category:"Event Discovery"},"interest:event":{name:"Event Interest/RSVP",category:"Event Engagement"},"attendance:event":{name:"Event Attendance",category:"Event Engagement"},"share:event":{name:"Event Shares",category:"Social"},"view:artist":{name:"Artist Views",category:"Content Discovery"},"click:artist":{name:"Artist Clicks",category:"Content Discovery"},"view:venue":{name:"Venue Views",category:"Content Discovery"},"click:venue":{name:"Venue Clicks",category:"Content Discovery"},"review:event":{name:"Event Reviews",category:"Content Creation"},"review:artist":{name:"Artist Reviews",category:"Content Creation"},"review:venue":{name:"Venue Reviews",category:"Content Creation"},"like:review":{name:"Review Likes",category:"Social Engagement"},search:{name:"Search",category:"Discovery"},"click:ticket":{name:"Ticket Clicks",category:"Event Engagement"},"click:ticket_link":{name:"Ticket Link Clicks",category:"Event Engagement"},"follow:artist":{name:"Artist Follows",category:"Social"},"follow:user":{name:"User Follows",category:"Social"},navigate:{name:"Navigation",category:"Platform Usage"},profile_update:{name:"Profile Updates",category:"Profile Management"},"view:spotify":{name:"Spotify Integration",category:"Music Integration"},"click:spotify":{name:"Spotify Clicks",category:"Music Integration"}},n=new Map,i=new Date,a=new Date(i);a.setDate(a.getDate()-7);const o=new Date(i);o.setDate(o.getDate()-30),t.forEach(u=>{const h=`${u.event_type}:${u.entity_type}`,f=r[h]||{name:`${u.event_type} (${u.entity_type})`,category:"Other"};n.has(f.name)||n.set(f.name,{totalUses:0,uniqueUsers:new Set,usesLast7d:0,usesLast30d:0,usesLast7dUsers:new Set,usesLast30dUsers:new Set});const p=n.get(f.name);p.totalUses++,p.uniqueUsers.add(u.user_id);const x=new Date(u.occurred_at);x>=o&&(p.usesLast30d++,p.usesLast30dUsers.add(u.user_id)),x>=a&&(p.usesLast7d++,p.usesLast7dUsers.add(u.user_id))});const l=new Date(i);l.setDate(l.getDate()-14);const c=new Map;return t.forEach(u=>{const h=`${u.event_type}:${u.entity_type}`,f=r[h];if(f){const p=new Date(u.occurred_at);p>=l&&p<a&&c.set(f.name,(c.get(f.name)||0)+1)}}),Array.from(n.entries()).map(([u,h])=>{const f=Object.values(r).find(g=>g.name===u)||{name:u,category:"Other"},p=c.get(u)||0,x=p>0?(h.usesLast7d-p)/p*100:0;return{feature_name:u,feature_category:f.category,total_uses:h.totalUses,unique_users:h.uniqueUsers.size,uses_last_7d:h.usesLast7d,uses_last_30d:h.usesLast30d,avg_uses_per_user:h.uniqueUsers.size>0?h.totalUses/h.uniqueUsers.size:0,growth_rate:Math.round(x*100)/100}}).sort((u,h)=>h.total_uses-u.total_uses)}catch(t){return console.error("Error getting feature usage:",t),[]}})}static getUserSegments(){return E(this,null,function*(){try{const{data:t}=yield P.from("users").select("user_id, created_at"),{data:r}=yield P.from("interactions").select("user_id, created_at"),n=new Map;return r==null||r.forEach(o=>{const l=o.user_id;n.has(l)||n.set(l,{sessions:0,daysActive:new Set});const c=n.get(l);c.sessions++,c.daysActive.add(new Date(o.created_at).toISOString().split("T")[0])}),Object.entries({"New Users":{minSessions:0,maxSessions:5},"Active Users":{minSessions:6,maxSessions:20},"Power Users":{minSessions:21,maxSessions:1/0}}).map(([o,l])=>{const c=Array.from(n.entries()).filter(([x,g])=>g.sessions>=l.minSessions&&g.sessions<=l.maxSessions),d=c.length,u=n.size,h=u>0?d/u*100:0,f=d>0?c.reduce((x,[g,v])=>x+v.sessions,0)/d:0,p=d>0?c.reduce((x,[g,v])=>x+v.daysActive.size,0)/d/30*100:0;return{segment:o,count:d,percentage:Math.round(h*100)/100,avg_sessions:Math.round(f*100)/100,retention_rate:Math.round(p*100)/100}})}catch(t){return console.error("Error getting user segments:",t),[]}})}static getGeographicDistribution(){return E(this,null,function*(){try{const{data:t}=yield P.from("users").select("user_id, location_city, created_at");if(!t||t.length===0)return[];const r=new Map;t.forEach(l=>{const c=l.location_city||"Unknown";r.has(c)||r.set(c,{users:0,events:0,newUsers:0});const d=r.get(c);d.users++;const u=new Date(l.created_at),h=new Date;h.setDate(h.getDate()-30),u>=h&&d.newUsers++});const i=(yield P.from("events").select("*",{count:"exact",head:!0})).count||0,a=t.length;return r.forEach((l,c)=>{l.events=Math.round(l.users/a*i)}),Array.from(r.entries()).map(([l,c])=>{const d=c.users>0?c.newUsers/c.users*100:0;return{country:"USA",city:l,users:c.users,events:c.events,revenue:0,growth_rate:Math.round(d*100)/100}}).sort((l,c)=>c.users-l.users).slice(0,20)}catch(t){return console.error("Error getting geographic distribution:",t),[]}})}static getDAUOverTime(t=30){return E(this,null,function*(){var r;try{const n=new Date;n.setDate(n.getDate()-t),n.setHours(0,0,0,0);const{data:i}=yield P.from("interactions").select("user_id, occurred_at").gte("occurred_at",n.toISOString()),a=new Map;i==null||i.forEach(u=>{const h=new Date(u.occurred_at).toISOString().split("T")[0];a.has(h)||a.set(h,new Set),a.get(h).add(u.user_id)});const{data:o}=yield P.from("users").select("user_id, last_active_at").not("last_active_at","is",null).gte("last_active_at",n.toISOString());o==null||o.forEach(u=>{const h=new Date(u.last_active_at).toISOString().split("T")[0];a.has(h)||a.set(h,new Set),a.get(h).add(u.user_id)});const l=[],c=new Date(n),d=new Date;for(d.setHours(23,59,59,999);c<=d;){const u=c.toISOString().split("T")[0],h=((r=a.get(u))==null?void 0:r.size)||0;l.push({date:u,value:h}),c.setDate(c.getDate()+1)}return l}catch(n){return console.error("Error getting DAU over time:",n),[]}})}static getMAUOverTime(t=12){return E(this,null,function*(){var r;try{const n=new Date;n.setMonth(n.getMonth()-t),n.setDate(1),n.setHours(0,0,0,0);const{data:i}=yield P.from("interactions").select("user_id, occurred_at").gte("occurred_at",n.toISOString()),{data:a}=yield P.from("users").select("user_id, last_active_at").not("last_active_at","is",null).gte("last_active_at",n.toISOString()),o=new Map;i==null||i.forEach(d=>{const u=new Date(d.occurred_at),h=`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}`;o.has(h)||o.set(h,new Set),o.get(h).add(d.user_id)}),a==null||a.forEach(d=>{const u=new Date(d.last_active_at),h=`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}`;o.has(h)||o.set(h,new Set),o.get(h).add(d.user_id)});const l=[],c=new Date(n);for(;c<=new Date;){const d=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}`,u=((r=o.get(d))==null?void 0:r.size)||0;l.push({date:d,value:u}),c.setMonth(c.getMonth()+1)}return l}catch(n){return console.error("Error getting MAU over time:",n),[]}})}static getNewUsersOverTime(t=30){return E(this,null,function*(){try{const r=new Date;r.setDate(r.getDate()-t),r.setHours(0,0,0,0);const{data:n}=yield P.from("users").select("created_at").gte("created_at",r.toISOString()),i=new Map;n==null||n.forEach(c=>{const d=new Date(c.created_at).toISOString().split("T")[0];i.set(d,(i.get(d)||0)+1)});const a=[],o=new Date(r),l=new Date;for(l.setHours(23,59,59,999);o<=l;){const c=o.toISOString().split("T")[0];a.push({date:c,value:i.get(c)||0}),o.setDate(o.getDate()+1)}return a}catch(r){return console.error("Error getting new users over time:",r),[]}})}static getUserStats(){return E(this,null,function*(){try{const t=new Date,r=new Date(t);r.setDate(r.getDate()-7);const n=new Date(t);n.setDate(n.getDate()-30);const{count:i}=yield P.from("users").select("*",{count:"exact",head:!0}),{count:a}=yield P.from("users").select("*",{count:"exact",head:!0}).eq("verified",!0),{count:o}=yield P.from("users").select("*",{count:"exact",head:!0}).gte("last_active_at",r.toISOString()),{count:l}=yield P.from("users").select("*",{count:"exact",head:!0}).gte("last_active_at",n.toISOString()),{count:c}=yield P.from("users").select("*",{count:"exact",head:!0}).gte("created_at",r.toISOString()),{count:d}=yield P.from("users").select("*",{count:"exact",head:!0}).gte("created_at",n.toISOString()),{data:u}=yield P.from("users").select("created_at"),h=u&&u.length>0?u.reduce((v,_)=>{const w=(t.getTime()-new Date(_.created_at).getTime())/864e5;return v+w},0)/u.length:0,{data:f}=yield P.from("reviews").select("user_id").eq("is_draft",!1),p=new Set((f==null?void 0:f.map(v=>v.user_id))||[]).size,{data:x}=yield P.from("user_relationships").eq("relationship_type","friend").eq("status","accepted").select("user_id, related_user_id"),g=new Set([...(x==null?void 0:x.map(v=>v.user_id))||[],...(x==null?void 0:x.map(v=>v.related_user_id))||[]]).size;return{total_users:i||0,verified_users:a||0,active_users_7d:o||0,active_users_30d:l||0,new_users_7d:c||0,new_users_30d:d||0,avg_account_age_days:Math.round(h*100)/100,users_with_reviews:p,users_with_friends:g}}catch(t){return console.error("Error getting user stats:",t),{total_users:0,verified_users:0,active_users_7d:0,active_users_30d:0,new_users_7d:0,new_users_30d:0,avg_account_age_days:0,users_with_reviews:0,users_with_friends:0}}})}static getAdminAchievements(){return E(this,null,function*(){try{const t=yield this.getPlatformStats(),r=yield this.getContentMetrics();return[{id:"first_users",name:"First Users",description:"Reach 100 total users",icon:"",progress:Math.min(t.total_users,100),goal:100,unlocked:t.total_users>=100,category:"users"},{id:"growing_platform",name:"Growing Platform",description:"Reach 1,000 total users",icon:"",progress:Math.min(t.total_users,1e3),goal:1e3,unlocked:t.total_users>=1e3,category:"users"},{id:"popular_platform",name:"Popular Platform",description:"Reach 10,000 total users",icon:"",progress:Math.min(t.total_users,1e4),goal:1e4,unlocked:t.total_users>=1e4,category:"users"},{id:"content_creator",name:"Content Creator",description:"Host 100 events on the platform",icon:"",progress:Math.min(r.total_events,100),goal:100,unlocked:r.total_events>=100,category:"content"},{id:"event_platform",name:"Event Platform",description:"Host 1,000 events on the platform",icon:"",progress:Math.min(r.total_events,1e3),goal:1e3,unlocked:r.total_events>=1e3,category:"content"},{id:"high_engagement",name:"High Engagement",description:"Achieve 10,000 total interactions",icon:"",progress:Math.min(t.total_interactions,1e4),goal:1e4,unlocked:t.total_interactions>=1e4,category:"platform"},{id:"viral_platform",name:"Viral Platform",description:"Achieve 100,000 total interactions",icon:"",progress:Math.min(t.total_interactions,1e5),goal:1e5,unlocked:t.total_interactions>=1e5,category:"platform"}]}catch(t){return console.error("Error getting admin achievements:",t),[]}})}static getNorthStarMetric(){return E(this,null,function*(){try{const t=new Date,r=new Date(t.getFullYear(),t.getMonth(),1),n=new Date(t.getFullYear(),t.getMonth()-1,1),i=new Date(t.getFullYear(),t.getMonth(),0),{data:a}=yield P.from("interactions").select("user_id, event_type, entity_type, entity_id, metadata").gte("occurred_at",r.toISOString()).in("event_type",["interest","share","attendance"]).eq("entity_type","event"),{data:o}=yield P.from("interactions").select("user_id, event_type, entity_type, entity_id, metadata").gte("occurred_at",n.toISOString()).lt("occurred_at",i.toISOString()).in("event_type",["interest","share","attendance"]).eq("entity_type","event"),{data:l}=yield P.from("user_event_relationships").in("relationship_type",["going","maybe"]).select("user_id, event_id, relationship_type").gte("created_at",r.toISOString()),{data:c}=yield P.from("user_event_relationships").in("relationship_type",["going","maybe"]).select("user_id, event_id, relationship_type").gte("created_at",n.toISOString()).lt("created_at",i.toISOString()),d=b=>{var N,S,k,O,A,T;return(b==null?void 0:b.entity_id)||((N=b==null?void 0:b.metadata)==null?void 0:N.event_id)||((S=b==null?void 0:b.metadata)==null?void 0:S.eventId)||((O=(k=b==null?void 0:b.metadata)==null?void 0:k.event)==null?void 0:O.id)||((A=b==null?void 0:b.metadata)==null?void 0:A.jambase_event_id)||((T=b==null?void 0:b.metadata)==null?void 0:T.jambaseEventId)||null},u=(b,N,S=!1)=>{const k=new Map,O=new Set,A=new Set;let T=0;const $=S?{saves:0,rsvps:0,shares:0}:null,R=(F,D,B)=>{if(!F)return;const U=D==="interest"?"save":D,V=`${F}:${U}:${B||"unknown"}`;A.has(V)||(A.add(V),O.add(F),k.set(F,(k.get(F)||0)+1),T+=1,$&&(U==="save"?$.saves+=1:U==="share"?$.shares+=1:U==="rsvp"&&($.rsvps+=1)))};return b==null||b.forEach(F=>{const D=d(F);R(F.user_id,F.event_type,D)}),N==null||N.forEach(F=>{R(F.user_id,"rsvp",F.event_id)}),{userScores:k,engagedCount:O.size,totalIntents:T,breakdown:$||{saves:0,rsvps:0,shares:0}}},h=u(a,l,!0),f=u(o,c,!1),p=h.engagedCount,x=f.engagedCount,g=p>0?h.totalIntents/p:0,v=x>0?f.totalIntents/x:0,_=v>0?(g-v)/v*100:0,w=Array.from(h.userScores.entries()).sort((b,N)=>N[1]-b[1]).slice(0,5).map(([b,N])=>({user_id:b,user_name:`User ${b.slice(0,8)}`,eci_score:N}));if(w.length>0){const b=w.map(S=>S.user_id),{data:N}=yield P.from("users").select("user_id, name").in("user_id",b);N==null||N.forEach(S=>{const k=w.find(O=>O.user_id===S.user_id);k&&(k.user_name=S.name||`User ${S.user_id.slice(0,8)}`)})}return{eci_per_user:Math.round(g*100)/100,total_engaged_users:p,total_concert_intents:h.totalIntents,monthly_growth_rate:Math.round(_*100)/100,breakdown:h.breakdown,top_engaged_users:w}}catch(t){return console.error("Error calculating North Star Metric:",t),{eci_per_user:0,total_engaged_users:0,total_concert_intents:0,monthly_growth_rate:0,breakdown:{saves:0,rsvps:0,shares:0},top_engaged_users:[]}}})}static getFeatureAdoptionFunnel(){return E(this,null,function*(){try{const t=yield ns.getAllUserInteractions(),r=[{name:"Event Interest/RSVP",eventType:"interest",entityType:"event"},{name:"Event Reviews",eventType:"review",entityType:"event"},{name:"Event Shares",eventType:"share",entityType:"event"},{name:"Search",eventType:"search",entityType:"search"},{name:"Ticket Clicks",eventType:"click_ticket",entityType:"ticket_link"}],n=new Date,i=new Date(n);i.setDate(i.getDate()-30);const a=new Date(n);a.setDate(a.getDate()-60);const o=[];for(const l of r){const c=new Set,d=new Set,u=new Set,h=new Set,f=t.filter(N=>N.event_type===l.eventType&&(l.entityType==="search"||N.entity_type===l.entityType)),p=new Map,x=new Map,g=new Map;f.forEach(N=>{const S=N.user_id,k=new Date(N.occurred_at);p.set(S,(p.get(S)||0)+1),(!x.has(S)||k<x.get(S))&&x.set(S,k),(!g.has(S)||k>g.get(S))&&g.set(S,k)}),p.forEach((N,S)=>{const k=x.get(S),O=g.get(S);c.add(S),N>=1&&N<=2?d.add(S):N>=3&&N<=10?u.add(S):N>10&&O>=i&&h.add(S)});const v=c.size,_=d.size,w=u.size,b=h.size;o.push({feature_name:l.name,discovery_count:v,trial_count:_,adoption_count:w,retention_count:b,discovery_to_trial_rate:v>0?_/v*100:0,trial_to_adoption_rate:_>0?w/_*100:0,adoption_to_retention_rate:w>0?b/w*100:0})}return o}catch(t){return console.error("Error getting feature adoption funnel:",t),[]}})}static getSessionAnalytics(){return E(this,null,function*(){try{const t=yield ns.getAllUserInteractions(),r=new Map;t.forEach(_=>{const w=_.session_id||"no-session",b=new Date(_.occurred_at);r.has(w)||r.set(w,{startTime:b,endTime:b,pageViews:0,userId:_.user_id});const N=r.get(w);b<N.startTime&&(N.startTime=b),b>N.endTime&&(N.endTime=b),_.event_type==="view"&&N.pageViews++});const n=[],i=[];r.forEach(_=>{const w=(_.endTime.getTime()-_.startTime.getTime())/6e4;n.push(w),i.push(_.pageViews||1)});const a=r.size,o=n.length>0?n.reduce((_,w)=>_+w,0)/n.length:0,l=i.length>0?i.reduce((_,w)=>_+w,0)/i.length:0,c=new Date,d=new Date(c);d.setDate(d.getDate()-7);const u=new Date(c);u.setDate(u.getDate()-30);const h=Array.from(r.values()).filter(_=>_.startTime>=d).length,f=Array.from(r.values()).filter(_=>_.startTime>=u).length,p=Array.from(r.values()).filter(_=>_.pageViews<=1).length,x=a>0?p/a*100:0,g=new Map;r.forEach(_=>{const w=_.startTime.getHours();g.set(w,(g.get(w)||0)+1)});const v=Array.from({length:24},(_,w)=>({hour:w,session_count:g.get(w)||0}));return{total_sessions:a,avg_session_duration_minutes:Math.round(o*100)/100,avg_pages_per_session:Math.round(l*100)/100,sessions_last_7d:h,sessions_last_30d:f,bounce_rate:Math.round(x*100)/100,sessions_by_hour:v}}catch(t){return console.error("Error getting session analytics:",t),{total_sessions:0,avg_session_duration_minutes:0,avg_pages_per_session:0,sessions_last_7d:0,sessions_last_30d:0,bounce_rate:0,sessions_by_hour:[]}}})}static getSocialGraphMetrics(){return E(this,null,function*(){try{const{data:t}=yield P.from("user_relationships").eq("relationship_type","friend").eq("status","accepted").select("user_id, related_user_id, created_at"),{count:r}=yield P.from("users").select("*",{count:"exact",head:!0}),n=new Map,i=new Set;t==null||t.forEach(b=>{n.set(b.user_id,(n.get(b.user_id)||0)+1),n.set(b.related_user_id,(n.get(b.related_user_id)||0)+1),i.add(b.user_id),i.add(b.related_user_id)});const a=(t==null?void 0:t.length)||0,o=i.size,l=(r||0)-o,c=Array.from(n.values()).reduce((b,N)=>b+N,0),d=o>0?c/o:0,u=o>0?a/o:0,h=o>1?o*(o-1)/2:0,f=h>0?a/h*100:0,p=new Date,x=new Date(p);x.setDate(x.getDate()-30);const g=new Date(p);g.setDate(g.getDate()-60);const v=(t==null?void 0:t.filter(b=>new Date(b.created_at)>=x).length)||0,_=(t==null?void 0:t.filter(b=>{const N=new Date(b.created_at);return N>=g&&N<x}).length)||0,w=_>0?(v-_)/_*100:0;return{total_connections:a,avg_connections_per_user:Math.round(d*100)/100,users_with_connections:o,users_without_connections:l,connection_growth_rate:Math.round(w*100)/100,avg_connection_degree:Math.round(u*100)/100,network_density:Math.round(f*100)/100}}catch(t){return console.error("Error getting social graph metrics:",t),{total_connections:0,avg_connections_per_user:0,users_with_connections:0,users_without_connections:0,connection_growth_rate:0,avg_connection_degree:0,network_density:0}}})}static getSearchEffectiveness(){return E(this,null,function*(){try{const t=yield ns.getAllUserInteractions(),r=t.filter(_=>_.event_type==="search"),n=new Set(r.map(_=>_.user_id)),i=new Date,a=new Date(i);a.setDate(a.getDate()-7);const o=new Date(i);o.setDate(o.getDate()-30);const l=r.filter(_=>new Date(_.occurred_at)>=a).length,c=r.filter(_=>new Date(_.occurred_at)>=o).length,d=new Map;r.forEach(_=>{var N,S;const w=((N=_.metadata)==null?void 0:N.query)||((S=_.metadata)==null?void 0:S.search_query)||"unknown";d.has(w)||d.set(w,{count:0,clicks:0,interests:0,searchers:new Set});const b=d.get(w);b.count++,b.searchers.add(_.user_id)}),r.forEach(_=>{var O,A;const w=new Date(_.occurred_at),b=_.user_id,N=((O=_.metadata)==null?void 0:O.query)||((A=_.metadata)==null?void 0:A.search_query)||"unknown",S=new Date(w.getTime()+5*60*1e3),k=t.filter(T=>T.user_id===b&&new Date(T.occurred_at)>=w&&new Date(T.occurred_at)<=S&&(T.event_type==="click"||T.event_type==="interest"));if(k.length>0){const T=d.get(N);T&&k.forEach($=>{$.event_type==="click"?T.clicks++:$.event_type==="interest"&&T.interests++})}});const u=Array.from(d.entries()).map(([_,w])=>({query:_,count:w.count,click_rate:w.count>0?w.clicks/w.count*100:0})).sort((_,w)=>w.count-_.count).slice(0,10),h=Array.from(d.values()).reduce((_,w)=>_+w.clicks,0),f=r.length>0?h/r.length*100:0,p=Array.from(d.values()).reduce((_,w)=>_+w.interests,0),x=r.length>0?p/r.length*100:0,g=new Map;r.forEach(_=>{var k;const w=((k=_.metadata)==null?void 0:k.category)||_.entity_type||"general";g.has(w)||g.set(w,{count:0,successes:0}),g.get(w).count++;const b=new Date(_.occurred_at),N=new Date(b.getTime()+5*60*1e3);t.some(O=>O.user_id===_.user_id&&new Date(O.occurred_at)>=b&&new Date(O.occurred_at)<=N&&(O.event_type==="click"||O.event_type==="interest"))&&g.get(w).successes++});const v=Array.from(g.entries()).map(([_,w])=>({category:_,count:w.count,success_rate:w.count>0?w.successes/w.count*100:0})).sort((_,w)=>w.count-_.count);return{total_searches:r.length,unique_searchers:n.size,searches_last_7d:l,searches_last_30d:c,search_to_click_rate:Math.round(f*100)/100,search_to_interest_rate:Math.round(x*100)/100,top_queries:u.map(_=>W(M({},_),{click_rate:Math.round(_.click_rate*100)/100})),searches_by_category:v.map(_=>W(M({},_),{success_rate:Math.round(_.success_rate*100)/100}))}}catch(t){return console.error("Error getting search effectiveness:",t),{total_searches:0,unique_searchers:0,searches_last_7d:0,searches_last_30d:0,search_to_click_rate:0,search_to_interest_rate:0,top_queries:[],searches_by_category:[]}}})}static exportAdminData(){return E(this,null,function*(){const[t,r,n,i,a,o,l,c,d,u,h,f,p,x]=yield Promise.all([this.getPlatformStats(),this.getUserGrowth(),this.getEngagementMetrics(),this.getContentMetrics(),this.getActiveUserMetrics(),this.getFeatureUsage(),this.getFeatureAdoptionFunnel(),this.getSessionAnalytics(),this.getSocialGraphMetrics(),this.getSearchEffectiveness(),this.getUserSegments(),this.getGeographicDistribution(),this.getAdminAchievements(),this.getNorthStarMetric()]);return{platformStats:t,userGrowth:r,engagementMetrics:n,contentMetrics:i,activeUserMetrics:a,featureUsage:o,featureAdoptionFunnel:l,sessionAnalytics:c,socialGraphMetrics:d,searchEffectiveness:u,userSegments:h,geographicDistribution:f,achievements:p,northStarMetric:x}})}}function T$e(){var T,$,R,F,D;const{isAdmin:e,accountInfo:t,loading:r}=Wu(),{toast:n}=jr(),[i,a]=y.useState(!0),[o,l]=y.useState([]),[c,d]=y.useState([]),[u,h]=y.useState(null),[f,p]=y.useState(""),[x,g]=y.useState(!1),[v,_]=y.useState(null);y.useEffect(()=>{if(console.log(" AdminModerationPanel: useEffect triggered"),console.log(" AdminModerationPanel: accountLoading:",r),console.log(" AdminModerationPanel: accountInfo:",t),console.log(" AdminModerationPanel: isAdmin() check:",e()),r){console.log(" AdminModerationPanel: Account still loading, waiting...");return}e()?(console.log(" AdminModerationPanel: User is admin, calling loadFlags()"),w()):console.log(" AdminModerationPanel: User is NOT admin, skipping loadFlags()")},[r,t]);const w=()=>E(this,null,function*(){var B;a(!0);try{console.log(" AdminModerationPanel: Loading flags..."),console.log(" AdminModerationPanel: isAdmin() result:",e());const{data:U,error:V}=yield P.from("moderation_flags").select("id, flag_status, flag_reason, created_at").order("created_at",{ascending:!1});if(console.log(" AdminModerationPanel: All flags in database:",U),console.log(" AdminModerationPanel: All flags error:",V),U&&Array.isArray(U)){const te=U.reduce((se,ue)=>(se[ue.flag_status]=(se[ue.flag_status]||0)+1,se),{});console.log(" AdminModerationPanel: Flags by status:",te)}console.log(" AdminModerationPanel: Trying direct pending flags query...");const{data:Y,error:z}=yield P.from("moderation_flags").select("*").eq("flag_status","pending").order("created_at",{ascending:!0});console.log(" AdminModerationPanel: Direct pending flags query result:",Y),console.log(" AdminModerationPanel: Direct pending flags query error:",z);let K=Y||[];if(K.length>0){const te=K.map(ue=>ue.flagged_by_user_id);console.log(" AdminModerationPanel: Fetching profiles for pending flags user IDs:",te);const{data:se}=yield P.from("users").select("user_id, name, avatar_url").in("user_id",te);console.log(" AdminModerationPanel: Profiles for pending flags:",se),K=K.map(ue=>W(M({},ue),{flagger:se==null?void 0:se.find(ye=>ye.user_id===ue.flagged_by_user_id)}))}const{data:Z,error:G}=yield P.from("moderation_flags").select("*").neq("flag_status","pending").order("reviewed_at",{ascending:!1});console.log(" AdminModerationPanel: Reviewed flags from DB:",Z),console.log(" AdminModerationPanel: Reviewed flags error:",G);let X=Z||[];if(X.length>0){const te=X.map(ue=>ue.flagged_by_user_id);console.log(" AdminModerationPanel: Fetching profiles for reviewed flags user IDs:",te);const{data:se}=yield P.from("users").select("user_id, name, avatar_url").in("user_id",te);console.log(" AdminModerationPanel: Profiles for reviewed flags:",se),X=X.map(ue=>W(M({},ue),{flagger:se==null?void 0:se.find(ye=>ye.user_id===ue.flagged_by_user_id)}))}console.log(" AdminModerationPanel: Raw pending flags response:",K),console.log(" AdminModerationPanel: Raw reviewed flags response:",X),console.log(" AdminModerationPanel: Pending flags type:",typeof K),console.log(" AdminModerationPanel: Pending flags is array:",Array.isArray(K)),console.log(" AdminModerationPanel: Pending flags length:",(K==null?void 0:K.length)||"undefined"),console.log(" AdminModerationPanel: Reviewed flags length:",(X==null?void 0:X.length)||"undefined"),K&&Array.isArray(K)&&(console.log(" AdminModerationPanel: Individual pending flags:"),K.forEach((te,se)=>{console.log(`  [${se}] Flag ID: ${te.id}, Status: ${te.flag_status}, Reason: ${te.flag_reason}`)})),l(K),d(X.slice(0,20)),console.log(" AdminModerationPanel: State updated - pendingFlags.length:",(K==null?void 0:K.length)||0),console.log(" AdminModerationPanel: State updated - reviewedFlags.length:",((B=X==null?void 0:X.slice(0,20))==null?void 0:B.length)||0)}catch(U){console.error(" AdminModerationPanel: Error loading flags:",U),console.error(" AdminModerationPanel: Error details:",JSON.stringify(U,null,2)),n({title:"Error",description:"Failed to load moderation flags",variant:"destructive"})}finally{a(!1),console.log(" AdminModerationPanel: Loading completed")}}),b=B=>E(this,null,function*(){try{const U=yield Tu.getFlaggedContentDetails(B.content_type,B.content_id);_(U)}catch(U){console.error("Error loading content preview:",U),_(null)}}),N=B=>{h(B),p(""),b(B)},S=B=>E(this,null,function*(){if(u){g(!0);try{yield Tu.moderateContent(u.id,B,f.trim()||void 0,!0),n({title:"Content Moderated",description:`Successfully ${B==="remove"?"removed":B==="warn"?"warned about":"dismissed"} the flagged content`}),h(null),_(null),p(""),w()}catch(U){console.error("Error moderating content:",U),n({title:"Error",description:"Failed to moderate content",variant:"destructive"})}finally{g(!1)}}}),k=B=>new Date(B).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),O=B=>{const U={pending:"default",resolved:"secondary",dismissed:"outline"};return s.jsx(Be,{variant:U[B]||"default",className:"capitalize",children:B})},A=({flag:B,onClick:U,isSelected:V})=>{var Y,z,K;return s.jsx(He,{className:`cursor-pointer transition-all hover:shadow-md ${V?"border-purple-500 bg-purple-50":""}`,onClick:()=>U(B),children:s.jsx(st,{className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-2xl",children:((Y=dh[B.flag_reason])==null?void 0:Y.icon)||""}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-semibold text-sm",children:((z=dh[B.flag_reason])==null?void 0:z.label)||B.flag_reason}),s.jsx("p",{className:"text-xs text-gray-600 capitalize",children:Tu.getContentTypeDisplayName(B.content_type)})]})]}),B.flag_details&&s.jsxs("p",{className:"text-sm text-gray-700 line-clamp-2 mb-2",children:['"',B.flag_details,'"']}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[s.jsxs("span",{children:["By ",((K=B.flagger)==null?void 0:K.name)||"Unknown"]}),s.jsx("span",{children:""}),s.jsx("span",{children:k(B.created_at)})]})]}),O(B.flag_status)]})})})};return e()?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Content Moderation"}),s.jsx("p",{className:"text-gray-600",children:"Review and moderate flagged content"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs(Cl,{defaultValue:"pending",children:[s.jsxs(Fo,{className:"w-full",children:[s.jsxs(Tn,{value:"pending",className:"flex-1",children:["Pending (",o.length,")"]}),s.jsx(Tn,{value:"reviewed",className:"flex-1",children:"Reviewed"})]}),s.jsx(On,{value:"pending",className:"space-y-3 mt-4",children:i?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(er,{className:"h-8 w-8 animate-spin text-purple-600"})}):o.length===0?s.jsx(He,{className:"border-dashed border-2 border-gray-200",children:s.jsxs(st,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(Va,{className:"h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Pending Flags"}),s.jsx("p",{className:"text-sm text-gray-500 text-center max-w-sm",children:"There are no content flags waiting for review. Great job keeping the community safe! "})]})}):o.map(B=>s.jsx(A,{flag:B,onClick:N,isSelected:(u==null?void 0:u.id)===B.id},B.id))}),s.jsx(On,{value:"reviewed",className:"space-y-3 mt-4",children:c.length===0?s.jsx(He,{className:"border-dashed border-2 border-gray-200",children:s.jsxs(st,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(Va,{className:"h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Reviewed Flags"}),s.jsx("p",{className:"text-sm text-gray-500 text-center max-w-sm",children:"No content flags have been reviewed yet. This is where completed moderation actions will appear."})]})}):c.map(B=>s.jsx(A,{flag:B,onClick:N,isSelected:!1},B.id))})]})}),s.jsx("div",{className:"lg:col-span-2",children:u?s.jsxs(He,{children:[s.jsxs(xr,{children:[s.jsx(Cr,{children:"Review Flagged Content"}),s.jsx(Hu,{children:(T=dh[u.flag_reason])==null?void 0:T.description})]}),s.jsxs(st,{className:"space-y-4",children:[s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Va,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-semibold text-red-900",children:($=dh[u.flag_reason])==null?void 0:$.label}),s.jsx("p",{className:"text-sm text-red-800 mt-1",children:u.flag_details}),s.jsxs("p",{className:"text-xs text-red-700 mt-2",children:["Reported by ",(R=u.flagger)==null?void 0:R.name," on ",k(u.created_at)]})]})]})}),v&&s.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[s.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[s.jsx(lf,{className:"h-4 w-4"}),"Content Preview"]}),s.jsxs("div",{className:"text-sm space-y-2",children:[u.content_type==="event"&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Title:"})," ",v.title]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Artist:"})," ",v.artist_name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Description:"})," ",v.description]})]}),u.content_type==="review"&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"By:"})," ",(F=v.user)==null?void 0:F.name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Rating:"})," ",v.rating,"/5"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Review:"})," ",v.review]})]}),u.content_type==="comment"&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"By:"})," ",(D=v.user)==null?void 0:D.name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Comment:"})," ",v.comment]})]})]})]}),u.flag_status==="pending"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Review Notes (Optional)"}),s.jsx(as,{placeholder:"Add notes about your decision...",value:f,onChange:B=>p(B.target.value),disabled:x,rows:3})]}),u.flag_status==="pending"?s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(oe,{variant:"destructive",onClick:()=>S("remove"),disabled:x,className:"flex-1",children:[x?s.jsx(er,{className:"h-4 w-4 mr-2 animate-spin"}):s.jsx(yc,{className:"h-4 w-4 mr-2"}),"Remove Content"]}),s.jsxs(oe,{variant:"outline",onClick:()=>S("warn"),disabled:x,className:"flex-1 border-yellow-500 text-yellow-700 hover:bg-yellow-50",children:[s.jsx(rI,{className:"h-4 w-4 mr-2"}),"Warn User"]}),s.jsxs(oe,{variant:"outline",onClick:()=>S("dismiss"),disabled:x,className:"flex-1",children:[s.jsx(pr,{className:"h-4 w-4 mr-2"}),"Dismiss"]})]}):s.jsxs("div",{className:"bg-gray-100 rounded-lg p-4",children:[s.jsx("p",{className:"font-semibold",children:"This flag has been reviewed"}),u.action_taken&&s.jsxs("p",{className:"text-sm text-gray-700 mt-1",children:["Action taken: ",s.jsx("span",{className:"font-medium capitalize",children:u.action_taken})]}),u.review_notes&&s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:u.review_notes})]})]})]}):s.jsx(He,{children:s.jsxs(st,{className:"py-12 text-center",children:[s.jsx(Va,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"Select a flag to review"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Choose a flagged content item from the list to begin moderation"})]})})})]})]}):s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsx("p",{className:"text-gray-600",children:"Access denied. Admin privileges required."})})}function O$e({currentUserId:e}){const[t,r]=y.useState([]),[n,i]=y.useState([]),[a,o]=y.useState(!0),[l,c]=y.useState(null),[d,u]=y.useState(""),[h,f]=y.useState("all"),[p,x]=y.useState("score"),{toast:g}=jr();y.useEffect(()=>{v()},[]),y.useEffect(()=>{let N=[...t];d&&(N=N.filter(S=>S.name.toLowerCase().includes(d.toLowerCase()))),h!=="all"&&(N=N.filter(S=>h==="verified"?S.verified:!S.verified)),N.sort((S,k)=>p==="score"?(k.trust_score||0)-(S.trust_score||0):new Date(k.created_at).getTime()-new Date(S.created_at).getTime()),i(N)},[t,d,h,p]);const v=()=>E(this,null,function*(){try{o(!0);const N=yield O2.getUsersNearVerification(50);r(N)}catch(N){console.error("Error fetching users:",N),g({title:"Error",description:"Failed to load users near verification.",variant:"destructive"})}finally{o(!1)}}),_=(N,S)=>E(this,null,function*(){try{c(N),yield O2.manuallyVerifyUser(N,e,S),g({title:"Success",description:`User ${S?"verified":"unverified"} successfully.`}),yield v()}catch(k){console.error("Error verifying user:",k),g({title:"Error",description:"Failed to update user verification status.",variant:"destructive"})}finally{c(null)}}),w=N=>N?Object.values(N).filter(Boolean).length:0,b=()=>{const N=[["Name","Trust Score","Criteria Met","Verified","Account Age","Created At"].join(","),...n.map(A=>[A.name,A.trust_score||0,`${w(A.verification_criteria_met)}/8`,A.verified?"Yes":"No",Math.floor((Date.now()-new Date(A.created_at).getTime())/864e5),new Date(A.created_at).toLocaleDateString()].join(","))].join(`
`),S=new Blob([N],{type:"text/csv"}),k=window.URL.createObjectURL(S),O=document.createElement("a");O.href=k,O.download=`verification-stats-${new Date().toISOString().split("T")[0]}.csv`,O.click(),window.URL.revokeObjectURL(k)};return a?s.jsxs(He,{children:[s.jsxs(xr,{children:[s.jsx(Cr,{children:"Verification Management"}),s.jsx(Hu,{children:"Manage user verification requests"})]}),s.jsx(st,{children:s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(He,{children:[s.jsxs(xr,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs(Cr,{className:"flex items-center gap-2",children:[s.jsx(Sn,{className:"w-5 h-5"}),"Verification Management"]}),s.jsx(Hu,{children:"Users close to verification threshold (40%+ trust score)"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"outline",size:"sm",onClick:b,disabled:n.length===0,children:[s.jsx(yv,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),s.jsxs(oe,{variant:"outline",size:"sm",onClick:v,disabled:a,children:[s.jsx(Sa,{className:`w-4 h-4 mr-2 ${a?"animate-spin":""}`}),"Refresh"]})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Mi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx(or,{placeholder:"Search by name...",value:d,onChange:N=>u(N.target.value),className:"pl-10"})]}),s.jsxs(Xs,{value:h,onValueChange:N=>f(N),children:[s.jsxs(Ds,{className:"w-[180px]",children:[s.jsx(xw,{className:"w-4 h-4 mr-2"}),s.jsx(Js,{placeholder:"Filter status"})]}),s.jsxs(Is,{children:[s.jsx(Lt,{value:"all",children:"All Users"}),s.jsx(Lt,{value:"verified",children:"Verified"}),s.jsx(Lt,{value:"unverified",children:"Unverified"})]})]}),s.jsxs(Xs,{value:p,onValueChange:N=>x(N),children:[s.jsx(Ds,{className:"w-[180px]",children:s.jsx(Js,{placeholder:"Sort by"})}),s.jsxs(Is,{children:[s.jsx(Lt,{value:"score",children:"Trust Score"}),s.jsx(Lt,{value:"date",children:"Join Date"})]})]})]})]}),s.jsx(st,{children:n.length===0?s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:t.length===0?"No users near verification threshold":"No users match your filters"})}):s.jsx("div",{className:"space-y-4",children:n.map(N=>{const S=w(N.verification_criteria_met),k=8,O=l===N.user_id;return s.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsxs(Vr,{className:"w-12 h-12",children:[s.jsx(Qr,{src:N.avatar_url||void 0}),s.jsx(qr,{children:N.name.charAt(0).toUpperCase()})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h4",{className:"font-semibold truncate",children:N.name}),N.verified&&s.jsx(Be,{variant:"default",className:"text-xs",children:"Verified"}),s.jsx(Be,{variant:"secondary",className:"text-xs",children:N.account_type})]}),s.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Trust Score: ",N.trust_score,"%"]}),s.jsxs("span",{children:["Criteria: ",S,"/",k]}),s.jsxs("span",{children:["Member since ",Dt(new Date(N.created_at),"MMM yyyy")]})]}),s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:N.verification_criteria_met&&Object.entries(N.verification_criteria_met).map(([A,T])=>T?s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:A},A):null)})]}),s.jsx("div",{className:"flex items-center gap-2",children:N.verified?s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>_(N.user_id,!1),disabled:O,children:O?s.jsx(Sa,{className:"w-4 h-4 animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(AJ,{className:"w-4 h-4 mr-2"}),"Unverify"]})}):s.jsx(oe,{variant:"default",size:"sm",onClick:()=>_(N.user_id,!0),disabled:O,children:O?s.jsx(Sa,{className:"w-4 h-4 animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(Jl,{className:"w-4 h-4 mr-2"}),"Verify"]})})})]},N.id)})})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(He,{children:s.jsx(st,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-primary",children:t.length}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Near Verification"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"40%+ trust score"})]})})}),s.jsx(He,{children:s.jsx(st,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600",children:t.filter(N=>N.verified).length}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Verified"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:t.length>0?`${Math.round(t.filter(N=>N.verified).length/t.length*100)}% conversion`:"0% conversion"})]})})}),s.jsx(He,{children:s.jsx(st,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-amber-600",children:t.filter(N=>!N.verified).length}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Pending Review"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Awaiting criteria"})]})})}),s.jsx(He,{children:s.jsx(st,{className:"pt-6",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[Math.round(t.reduce((N,S)=>N+S.trust_score,0)/t.length)||0,"%"]}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Avg Trust Score"}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Range: ",Math.min(...t.map(N=>N.trust_score)),"% - ",Math.max(...t.map(N=>N.trust_score)),"%"]})]})})})]})]})}function R$e(){const{user:e}=os(),[t,r]=y.useState(!0),[n,i]=y.useState(null),[a,o]=y.useState([]),[l,c]=y.useState(null),[d,u]=y.useState(null),[h,f]=y.useState([]),[p,x]=y.useState([]),[g,v]=y.useState([]),[_,w]=y.useState(null),[b,N]=y.useState([]),[S,k]=y.useState([]),[O,A]=y.useState([]),[T,$]=y.useState(null),[R,F]=y.useState(null),[D,B]=y.useState([]),[U,V]=y.useState([]),[Y,z]=y.useState(null),[K,Z]=y.useState(null),[G,X]=y.useState(null),[te,se]=y.useState("overview");y.useEffect(()=>{console.log(" AdminAnalyticsDashboard: activeTab changed to:",te)},[te]),y.useEffect(()=>{e&&ue()},[e]);const ue=()=>E(this,null,function*(){if(e)try{r(!0);const[ne,xe,ge,ie,ee,H,le,Se,ae,fe,he,pe,Ae,qe,Fe,ve,rt,Ve]=yield Promise.all([ks.getPlatformStats(),ks.getUserGrowth(),ks.getEngagementMetrics(),ks.getContentMetrics(),ks.getUserSegments(),ks.getGeographicDistribution(),ks.getAdminAchievements(),ks.getNorthStarMetric(),ks.getDAUOverTime(30),ks.getMAUOverTime(12),ks.getNewUsersOverTime(30),ks.getUserStats(),ks.getActiveUserMetrics(),ks.getFeatureUsage(),ks.getFeatureAdoptionFunnel(),ks.getSessionAnalytics(),ks.getSocialGraphMetrics(),ks.getSearchEffectiveness()]);i(ne),o(xe),c(ge),u(ie),f(ee),x(H),v(le),w(Se),N(ae),k(fe),A(he),$(pe),F(Ae),B(qe),V(Fe),z(ve),Z(rt),X(Ve)}catch(ne){console.error("Error fetching admin data:",ne)}finally{r(!1)}}),ye=()=>E(this,null,function*(){if(e)try{const ne=yield ks.exportAdminData(),xe=new Blob([JSON.stringify(ne,null,2)],{type:"application/json"}),ge=URL.createObjectURL(xe),ie=document.createElement("a");ie.href=ge,ie.download=`admin-analytics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),URL.revokeObjectURL(ge)}catch(ne){console.error("Error exporting data:",ne)}});return t?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsx(Wa,{})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((ne,xe)=>s.jsx(Wa,{},xe))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(Wa,{}),s.jsx(Wa,{})]})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(Ql,{className:"w-8 h-8 text-red-600"}),s.jsx("h1",{className:"gradient-text text-3xl font-bold",children:"Admin Analytics"})]}),s.jsx("p",{className:"text-gray-600",children:"Platform-wide analytics, system health, and business intelligence"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:ye,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[s.jsx(yv,{className:"w-4 h-4"}),"Export Data"]}),s.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-red-600 to-orange-600 text-white rounded-lg hover:from-red-700 hover:to-orange-700 transition-all",children:"System Settings"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(Xi,{title:"North Star: ECI/U",value:(_==null?void 0:_.eci_per_user)||0,icon:s.jsx(So,{className:"w-6 h-6"}),trend:(_==null?void 0:_.monthly_growth_rate)>0?"up":(_==null?void 0:_.monthly_growth_rate)<0?"down":"neutral",subtitle:"concert intents per user"}),s.jsx(Xi,{title:"Total Users",value:(n==null?void 0:n.total_users)||0,icon:s.jsx(Ar,{className:"w-6 h-6"}),trend:(n==null?void 0:n.platform_growth_rate)>0?"up":(n==null?void 0:n.platform_growth_rate)<0?"down":"neutral"}),s.jsx(Xi,{title:"Daily Active Users",value:(n==null?void 0:n.daily_active_users)||0,icon:s.jsx(uo,{className:"w-6 h-6"}),subtitle:"active today"}),s.jsx(Xi,{title:"Monthly Active Users",value:(n==null?void 0:n.monthly_active_users)||0,icon:s.jsx(Sn,{className:"w-6 h-6"}),subtitle:"last 30 days"}),s.jsx(Xi,{title:"Active Users (10+ interactions)",value:(R==null?void 0:R.total_active_users)||0,icon:s.jsx(v0,{className:"w-6 h-6"}),subtitle:"users with 10+ interactions"}),s.jsx(Xi,{title:"Total Events",value:(n==null?void 0:n.total_events)||0,icon:s.jsx(Et,{className:"w-6 h-6"}),trend:(d==null?void 0:d.content_growth_rate)>0?"up":(d==null?void 0:d.content_growth_rate)<0?"down":"neutral",subtitle:"events this month"})]}),s.jsx("div",{className:"mb-8",children:s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:Bu},{id:"users",label:"Users",icon:Ar},{id:"active-users",label:"Active Users",icon:v0},{id:"content",label:"Content",icon:Et},{id:"moderation",label:"Moderation",icon:Va},{id:"achievements",label:"Achievements",icon:Sd}].map(ne=>s.jsxs("button",{onClick:()=>{console.log(" AdminAnalyticsDashboard: Tab clicked:",ne.id),se(ne.id)},className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${te===ne.id?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(ne.icon,{className:"w-4 h-4"}),ne.label]},ne.id))})})}),te==="overview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gradient-to-r from-pink-50 to-red-50 rounded-xl p-6 shadow-sm border border-pink-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-gradient-to-r from-pink-500 to-red-500 rounded-lg",children:s.jsx(So,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"North Star Metric"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Engaged Concert Intent per User (ECI/U)"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-pink-600 mb-1",children:(_==null?void 0:_.eci_per_user)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Average ECI per User"}),s.jsx("div",{className:"text-xs text-gray-500",children:"This month"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:(_==null?void 0:_.total_engaged_users)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Engaged Users"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Active this month"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600 mb-1",children:(_==null?void 0:_.total_concert_intents)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Total Concert Intents"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Saves + RSVPs + Shares"})]})]}),s.jsxs("div",{className:"mt-6 pt-6 border-t border-pink-200",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Intent Breakdown"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[s.jsx("div",{className:"text-lg font-semibold text-pink-600",children:(_==null?void 0:_.breakdown.saves)||0}),s.jsx("div",{className:"text-xs text-gray-600",children:"Saves"})]}),s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[s.jsx("div",{className:"text-lg font-semibold text-blue-600",children:(_==null?void 0:_.breakdown.rsvps)||0}),s.jsx("div",{className:"text-xs text-gray-600",children:"RSVPs"})]}),s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[s.jsx("div",{className:"text-lg font-semibold text-purple-600",children:(_==null?void 0:_.breakdown.shares)||0}),s.jsx("div",{className:"text-xs text-gray-600",children:"Shares"})]})]})]}),(_==null?void 0:_.top_engaged_users)&&_.top_engaged_users.length>0&&s.jsxs("div",{className:"mt-6 pt-6 border-t border-pink-200",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Engaged Users"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:_.top_engaged_users.slice(0,6).map((ne,xe)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-pink-400 to-red-400 rounded-full flex items-center justify-center text-white text-xs font-bold",children:xe+1}),s.jsx("span",{className:"text-sm font-medium text-gray-900 truncate",children:ne.user_name})]}),s.jsxs("div",{className:"text-sm font-semibold text-pink-600",children:[ne.eci_score," ECI"]})]},ne.user_id))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(lf,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Page Views"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(l==null?void 0:l.total_page_views)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Mi,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Searches"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:(l==null?void 0:l.searches_performed)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Jt,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"Reviews"})]}),s.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:(l==null?void 0:l.reviews_written)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(xc,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Ticket Clicks"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:(l==null?void 0:l.tickets_clicked)||0})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(_2,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Feature Usage"})]}),D.length>0?s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Feature"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Category"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Total Uses"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Unique Users"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Last 7d"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Last 30d"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Growth"})]})}),s.jsx("tbody",{children:D.slice(0,15).map((ne,xe)=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:ne.feature_name}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs bg-purple-100 text-purple-700",children:ne.feature_category})}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ne.total_uses.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ne.unique_users.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ne.uses_last_7d.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ne.uses_last_30d.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("span",{className:`font-semibold ${ne.growth_rate>0?"text-green-600":ne.growth_rate<0?"text-red-600":"text-gray-600"}`,children:[ne.growth_rate>0?"+":"",ne.growth_rate.toFixed(1),"%"]})})]},ne.feature_name))})]})})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(_2,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No feature usage data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(So,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Feature Adoption Funnel"})]}),U.length>0?s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Feature"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Discovery"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Trial"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Adoption"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Retention"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"DiscoveryTrial"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"TrialAdoption"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"AdoptionRetention"})]})}),s.jsx("tbody",{children:U.map(ne=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:ne.feature_name}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ne.discovery_count.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ne.trial_count.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ne.adoption_count.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ne.retention_count.toLocaleString()}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("span",{className:"font-semibold text-blue-600",children:[ne.discovery_to_trial_rate.toFixed(1),"%"]})}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("span",{className:"font-semibold text-green-600",children:[ne.trial_to_adoption_rate.toFixed(1),"%"]})}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsxs("span",{className:"font-semibold text-purple-600",children:[ne.adoption_to_retention_rate.toFixed(1),"%"]})})]},ne.feature_name))})]})})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(So,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No feature adoption data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(Mi,{className:"w-5 h-5 text-green-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Search Effectiveness"})]}),G?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Total Searches"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:G.total_searches.toLocaleString()})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"SearchClick Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[G.search_to_click_rate.toFixed(1),"%"]})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-purple-900 mb-1",children:"SearchInterest Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[G.search_to_interest_rate.toFixed(1),"%"]})]}),s.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-orange-900 mb-1",children:"Unique Searchers"}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:G.unique_searchers.toLocaleString()})]})]}),G.top_queries.length>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Search Queries"}),s.jsx("div",{className:"space-y-2",children:G.top_queries.slice(0,10).map((ne,xe)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-green-400 to-blue-400 rounded-full flex items-center justify-center text-white text-xs font-bold",children:xe+1}),s.jsx("span",{className:"font-medium text-gray-900",children:ne.query})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[ne.count," searches"]}),s.jsxs("span",{className:"text-sm font-semibold text-green-600",children:[ne.click_rate.toFixed(1),"% click rate"]})]})]},xe))})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Mi,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No search data available"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Segments"}),h.length>0?s.jsx("div",{className:"space-y-3",children:h.map(ne=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:ne.segment}),s.jsxs("p",{className:"text-sm text-gray-500",children:[ne.avg_sessions," avg sessions"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:ne.count}),s.jsxs("p",{className:"text-sm text-gray-500",children:[ne.percentage,"%"]})]})]},ne.segment))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ar,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No user segment data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Geographic Distribution"}),p.length>0?s.jsx("div",{className:"space-y-3",children:p.slice(0,5).map(ne=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:ne.country}),s.jsxs("p",{className:"text-sm text-gray-500",children:[ne.events," events"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:ne.users}),s.jsx("p",{className:"text-sm text-gray-500",children:"users"})]})]},ne.country))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(No,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]})]})]}),te==="users"&&s.jsxs("div",{className:"space-y-6",children:[T&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ar,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:T.total_users.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"All registered users"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(v0,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Verified Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:T.verified_users.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:T.total_users>0?`${Math.round(T.verified_users/T.total_users*100)}% verified`:"0% verified"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(uo,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Active (7d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:T.active_users_7d.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Active in last 7 days"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Pu,{className:"w-4 h-4 text-pink-600"}),s.jsx("span",{className:"text-sm font-medium text-pink-600",children:"New (7d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-pink-900",children:T.new_users_7d.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"New users this week"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Sn,{className:"w-4 h-4 text-orange-600"}),s.jsx("span",{className:"text-sm font-medium text-orange-600",children:"Active (30d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:T.active_users_30d.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Active in last 30 days"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Jt,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"With Reviews"})]}),s.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:T.users_with_reviews.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Users who wrote reviews"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(hs,{className:"w-4 h-4 text-red-600"}),s.jsx("span",{className:"text-sm font-medium text-red-600",children:"With Friends"})]}),s.jsx("p",{className:"text-2xl font-bold text-red-900",children:T.users_with_friends.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Users with connections"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Et,{className:"w-4 h-4 text-indigo-600"}),s.jsx("span",{className:"text-sm font-medium text-indigo-600",children:"Avg Account Age"})]}),s.jsx("p",{className:"text-2xl font-bold text-indigo-900",children:Math.round(T.avg_account_age_days)}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Days since registration"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Daily Active Users (DAU)"}),s.jsx(uo,{className:"w-5 h-5 text-blue-600"})]}),b.length>0?s.jsx(Wl,{width:"100%",height:300,children:s.jsxs(GO,{data:b,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"dauGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),s.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),s.jsx(Xo,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(Hi,{dataKey:"date",stroke:"#6b7280",tickFormatter:ne=>{const xe=new Date(ne);return`${xe.getMonth()+1}/${xe.getDate()}`}}),s.jsx(Gi,{stroke:"#6b7280"}),s.jsx(Hs,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},labelFormatter:ne=>new Date(ne).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),s.jsx(Sc,{type:"monotone",dataKey:"value",stroke:"#3b82f6",fillOpacity:1,fill:"url(#dauGradient)",name:"Active Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(uo,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No DAU data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Monthly Active Users (MAU)"}),s.jsx(Sn,{className:"w-5 h-5 text-green-600"})]}),S.length>0?s.jsx(Wl,{width:"100%",height:300,children:s.jsxs(HO,{data:S,children:[s.jsx(Xo,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(Hi,{dataKey:"date",stroke:"#6b7280",tickFormatter:ne=>{const[xe,ge]=ne.split("-");return`${ge}/${xe.slice(2)}`}}),s.jsx(Gi,{stroke:"#6b7280"}),s.jsx(Hs,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},labelFormatter:ne=>{const[xe,ge]=ne.split("-");return new Date(parseInt(xe),parseInt(ge)-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}}),s.jsx(Om,{type:"monotone",dataKey:"value",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",r:4},name:"Active Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Sn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No MAU data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"New Users Over Time"}),s.jsx(Pu,{className:"w-5 h-5 text-pink-600"})]}),O.length>0?s.jsx(Wl,{width:"100%",height:300,children:s.jsxs(b0,{data:O,children:[s.jsx(Xo,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(Hi,{dataKey:"date",stroke:"#6b7280",tickFormatter:ne=>{const xe=new Date(ne);return`${xe.getMonth()+1}/${xe.getDate()}`}}),s.jsx(Gi,{stroke:"#6b7280"}),s.jsx(Hs,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},labelFormatter:ne=>new Date(ne).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),s.jsx(ja,{dataKey:"value",fill:"#ec4899",radius:[8,8,0,0],name:"New Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Pu,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No new users data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"User Geography"}),s.jsx(No,{className:"w-5 h-5 text-indigo-600"})]}),p.length>0?s.jsxs("div",{className:"space-y-4",children:[s.jsx(Wl,{width:"100%",height:300,children:s.jsxs(b0,{data:p.slice(0,10),layout:"vertical",children:[s.jsx(Xo,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(Hi,{type:"number",stroke:"#6b7280"}),s.jsx(Gi,{type:"category",dataKey:"city",stroke:"#6b7280",width:120}),s.jsx(Hs,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:ne=>[ne.toLocaleString(),"Users"]}),s.jsx(ja,{dataKey:"users",fill:"#6366f1",radius:[0,8,8,0],name:"Users"})]})}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Cities by User Count"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:p.slice(0,12).map((ne,xe)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-indigo-400 to-purple-400 rounded-full flex items-center justify-center text-white text-xs font-bold",children:xe+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:ne.city||"Unknown"}),s.jsx("p",{className:"text-xs text-gray-500",children:ne.country})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:ne.users.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500",children:"users"})]})]},`${ne.city||"Unknown"}-${ne.country}-${xe}`))})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(No,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Segmentation"}),h.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Segment"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Count"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Percentage"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Avg Sessions"}),s.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Retention"})]})}),s.jsx("tbody",{children:h.map(ne=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:ne.segment}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ne.count}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[ne.percentage,"%"]}),s.jsx("td",{className:"py-3 px-4 text-right text-gray-600",children:ne.avg_sessions}),s.jsxs("td",{className:"py-3 px-4 text-right text-gray-600",children:[ne.retention_rate,"%"]})]},ne.segment))})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Gk,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No user segment data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(uo,{className:"w-5 h-5 text-indigo-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Session Analytics"})]}),Y?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Total Sessions"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Y.total_sessions.toLocaleString()}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"All time"})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Avg Duration"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[Y.avg_session_duration_minutes.toFixed(1)," min"]}),s.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Per session"})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-purple-900 mb-1",children:"Avg Pages"}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:Y.avg_pages_per_session.toFixed(1)}),s.jsx("p",{className:"text-xs text-purple-700 mt-1",children:"Per session"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-orange-900 mb-1",children:"Sessions (7d)"}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:Y.sessions_last_7d.toLocaleString()})]}),s.jsxs("div",{className:"bg-pink-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-pink-900 mb-1",children:"Sessions (30d)"}),s.jsx("p",{className:"text-2xl font-bold text-pink-900",children:Y.sessions_last_30d.toLocaleString()})]}),s.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-red-900 mb-1",children:"Bounce Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-red-900",children:[Y.bounce_rate.toFixed(1),"%"]}),s.jsx("p",{className:"text-xs text-red-700 mt-1",children:"1 page view only"})]})]}),Y.sessions_by_hour.length>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Sessions by Hour of Day"}),s.jsx(Wl,{width:"100%",height:250,children:s.jsxs(b0,{data:Y.sessions_by_hour,children:[s.jsx(Xo,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(Hi,{dataKey:"hour",stroke:"#6b7280",tickFormatter:ne=>`${ne%24}:00`}),s.jsx(Gi,{stroke:"#6b7280"}),s.jsx(Hs,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},labelFormatter:ne=>`${ne}:00`,formatter:ne=>[ne.toLocaleString(),"Sessions"]}),s.jsx(ja,{dataKey:"session_count",fill:"#6366f1",radius:[8,8,0,0],name:"Sessions"})]})})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(uo,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No session data available"})]})]})]}),te==="content"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Et,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Events"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(d==null?void 0:d.total_events)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ar,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Total Artists"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:(d==null?void 0:d.total_artists)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(zu,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Total Venues"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:(d==null?void 0:d.total_venues)||0})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Jt,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"Avg Rating"})]}),s.jsxs("p",{className:"text-2xl font-bold text-yellow-900",children:[(d==null?void 0:d.average_event_rating)||0,"/5"]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Content Statistics"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Events This Month"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(d==null?void 0:d.events_this_month)||0}),s.jsx("p",{className:"text-xs text-blue-700",children:"New events added"})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Total Reviews"}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:(d==null?void 0:d.total_reviews)||0}),s.jsx("p",{className:"text-xs text-green-700",children:"User reviews written"})]})]})]})]}),te==="achievements"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[s.jsx(Sd,{className:"w-8 h-8 text-yellow-500"}),s.jsx("h2",{className:"gradient-text text-2xl font-bold",children:"Platform Achievements"})]}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Track your platform milestones and growth metrics"})]}),["users","content","platform"].map(ne=>{const xe=g.filter(ie=>ie.category===ne),ge={users:"User Growth",content:"Content Creation",platform:"Platform Engagement"};return s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(bl,{className:"w-5 h-5 text-red-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ge[ne]})]}),xe.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:xe.map(ie=>s.jsx(T4,{name:ie.name,description:ie.description,icon:ie.icon,progress:ie.progress,goal:ie.goal,unlocked:ie.unlocked,unlockedAt:ie.unlockedAt,compact:!0},ie.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(bl,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No achievements in this category yet"})]})]},ne)})]}),te==="active-users"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(v0,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Active Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(R==null?void 0:R.total_active_users)||0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"10+ interactions"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(uo,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Active (7d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:(R==null?void 0:R.active_users_7d)||0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Last 7 days"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Sn,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Active (30d)"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:(R==null?void 0:R.active_users_30d)||0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Last 30 days"})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(So,{className:"w-4 h-4 text-orange-600"}),s.jsx("span",{className:"text-sm font-medium text-orange-600",children:"Avg Interactions"})]}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:(R==null?void 0:R.avg_interactions_per_active_user)||0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Per active user"})]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-xl p-6 shadow-sm border border-green-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(Jl,{className:"w-6 h-6 text-green-600"}),s.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Verification Statistics"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600 mb-1",children:(R==null?void 0:R.verification_stats.total_verified)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Verified Users"}),s.jsx("div",{className:"text-xs text-gray-500",children:(R==null?void 0:R.total_active_users)>0?`${Math.round(R.verification_stats.total_verified/R.total_active_users*100)}% of active users`:"0%"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:[(R==null?void 0:R.verification_stats.avg_trust_score)||0,"%"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Avg Trust Score"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Across active users"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold text-purple-600 mb-1",children:[(R==null?void 0:R.verification_stats.avg_verification_progress)||0,"/8"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Avg Progress"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Criteria met"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-1",children:(R==null?void 0:R.verification_stats.users_near_verification)||0}),s.jsx("div",{className:"text-sm text-gray-600",children:"Near Verification"}),s.jsx("div",{className:"text-xs text-gray-500",children:"40%+ trust score"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(hs,{className:"w-5 h-5 text-pink-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Social Graph Metrics"})]}),K?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-pink-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-pink-900 mb-1",children:"Total Connections"}),s.jsx("p",{className:"text-2xl font-bold text-pink-900",children:K.total_connections.toLocaleString()}),s.jsx("p",{className:"text-xs text-pink-700 mt-1",children:"Friendships"})]}),s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Avg Connections"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:K.avg_connections_per_user.toFixed(1)}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Per user"})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Network Density"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[K.network_density.toFixed(2),"%"]}),s.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Connectedness"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-purple-900 mb-1",children:"With Connections"}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:K.users_with_connections.toLocaleString()})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Without Connections"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:K.users_without_connections.toLocaleString()})]}),s.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-orange-900 mb-1",children:"Avg Degree"}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:K.avg_connection_degree.toFixed(1)})]}),s.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-medium text-indigo-900 mb-1",children:"Growth Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-indigo-900",children:[K.connection_growth_rate>0?"+":"",K.connection_growth_rate.toFixed(1),"%"]})]})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(hs,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No social graph data available"})]})]}),e&&s.jsx("div",{className:"bg-white rounded-xl shadow-sm",children:s.jsx(O$e,{currentUserId:e.id})}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Geographic Distribution"}),s.jsx(No,{className:"w-5 h-5 text-indigo-600"})]}),R!=null&&R.geographic_distribution&&R.geographic_distribution.length>0?s.jsxs("div",{className:"space-y-4",children:[s.jsx(Wl,{width:"100%",height:300,children:s.jsxs(b0,{data:R.geographic_distribution.slice(0,10),layout:"vertical",children:[s.jsx(Xo,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(Hi,{type:"number",stroke:"#6b7280"}),s.jsx(Gi,{type:"category",dataKey:"city",stroke:"#6b7280",width:120}),s.jsx(Hs,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:ne=>[ne.toLocaleString(),"Users"]}),s.jsx(ja,{dataKey:"users",fill:"#6366f1",radius:[0,8,8,0],name:"Users"})]})}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Cities by Active Users"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:R.geographic_distribution.slice(0,12).map((ne,xe)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-indigo-400 to-purple-400 rounded-full flex items-center justify-center text-white text-xs font-bold",children:xe+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:ne.city||"Unknown"}),s.jsx("p",{className:"text-xs text-gray-500",children:ne.country})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:ne.users.toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-500",children:"users"})]})]},`${ne.city||"Unknown"}-${ne.country}-${xe}`))})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(No,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No geographic data available"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Daily Active Users"}),s.jsx(uo,{className:"w-5 h-5 text-blue-600"})]}),R!=null&&R.time_series_data.daily&&R.time_series_data.daily.length>0?s.jsx(Wl,{width:"100%",height:250,children:s.jsxs(GO,{data:R.time_series_data.daily,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"dauGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),s.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),s.jsx(Xo,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(Hi,{dataKey:"date",stroke:"#6b7280",tickFormatter:ne=>{const xe=new Date(ne);return`${xe.getMonth()+1}/${xe.getDate()}`}}),s.jsx(Gi,{stroke:"#6b7280"}),s.jsx(Hs,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),s.jsx(Sc,{type:"monotone",dataKey:"value",stroke:"#3b82f6",fillOpacity:1,fill:"url(#dauGradient)",name:"Active Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(uo,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No data available"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Active Users"}),s.jsx(Sn,{className:"w-5 h-5 text-green-600"})]}),R!=null&&R.time_series_data.weekly&&R.time_series_data.weekly.length>0?s.jsx(Wl,{width:"100%",height:250,children:s.jsxs(HO,{data:R.time_series_data.weekly,children:[s.jsx(Xo,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),s.jsx(Hi,{dataKey:"date",stroke:"#6b7280",tickFormatter:ne=>{const xe=new Date(ne);return`${xe.getMonth()+1}/${xe.getDate()}`}}),s.jsx(Gi,{stroke:"#6b7280"}),s.jsx(Hs,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),s.jsx(Om,{type:"monotone",dataKey:"value",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",r:4},name:"Active Users"})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Sn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No data available"})]})]})]})]}),te==="moderation"&&s.jsxs("div",{className:"space-y-6",children:[(console.log(" AdminAnalyticsDashboard: Rendering moderation tab, activeTab:",te),null),s.jsx(T$e,{})]})]})})}var qG=["PageUp","PageDown"],WG=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],HG={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},_p="Slider",[z5,M$e,D$e]=zm(_p),[GG,RFe]=js(_p,[D$e]),[I$e,ub]=GG(_p),YG=y.forwardRef((e,t)=>{const R=e,{name:r,min:n=0,max:i=100,step:a=1,orientation:o="horizontal",disabled:l=!1,minStepsBetweenThumbs:c=0,defaultValue:d=[n],value:u,onValueChange:h=()=>{},onValueCommit:f=()=>{},inverted:p=!1,form:x}=R,g=me(R,["name","min","max","step","orientation","disabled","minStepsBetweenThumbs","defaultValue","value","onValueChange","onValueCommit","inverted","form"]),v=y.useRef(new Set),_=y.useRef(0),b=o==="horizontal"?$$e:L$e,[N=[],S]=Di({prop:u,defaultProp:d,onChange:F=>{var B;(B=[...v.current][_.current])==null||B.focus(),h(F)}}),k=y.useRef(N);function O(F){const D=V$e(N,F);$(F,D)}function A(F){$(F,_.current)}function T(){const F=k.current[_.current];N[_.current]!==F&&f(N)}function $(F,D,{commit:B}={commit:!1}){const U=G$e(a),V=Y$e(Math.round((F-n)/a)*a+n,U),Y=_g(V,[n,i]);S((z=[])=>{const K=B$e(z,Y,D);if(H$e(K,c*a)){_.current=K.indexOf(Y);const Z=String(K)!==String(z);return Z&&B&&f(K),Z?K:z}else return z})}return s.jsx(I$e,{scope:e.__scopeSlider,name:r,disabled:l,min:n,max:i,valueIndexToChangeRef:_,thumbs:v.current,values:N,orientation:o,form:x,children:s.jsx(z5.Provider,{scope:e.__scopeSlider,children:s.jsx(z5.Slot,{scope:e.__scopeSlider,children:s.jsx(b,W(M({"aria-disabled":l,"data-disabled":l?"":void 0},g),{ref:t,onPointerDown:mt(g.onPointerDown,()=>{l||(k.current=N)}),min:n,max:i,inverted:p,onSlideStart:l?void 0:O,onSlideMove:l?void 0:A,onSlideEnd:l?void 0:T,onHomeKeyDown:()=>!l&&$(n,0,{commit:!0}),onEndKeyDown:()=>!l&&$(i,N.length-1,{commit:!0}),onStepKeyDown:({event:F,direction:D})=>{if(!l){const V=qG.includes(F.key)||F.shiftKey&&WG.includes(F.key)?10:1,Y=_.current,z=N[Y],K=a*V*D;$(z+K,Y,{commit:!0})}}}))})})})});YG.displayName=_p;var[KG,ZG]=GG(_p,{startEdge:"left",endEdge:"right",size:"width",direction:1}),$$e=y.forwardRef((e,t)=>{const b=e,{min:r,max:n,dir:i,inverted:a,onSlideStart:o,onSlideMove:l,onSlideEnd:c,onStepKeyDown:d}=b,u=me(b,["min","max","dir","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"]),[h,f]=y.useState(null),p=sr(t,N=>f(N)),x=y.useRef(void 0),g=hf(i),v=g==="ltr",_=v&&!a||!v&&a;function w(N){const S=x.current||h.getBoundingClientRect(),k=[0,S.width],A=BC(k,_?[r,n]:[n,r]);return x.current=S,A(N-S.left)}return s.jsx(KG,{scope:e.__scopeSlider,startEdge:_?"left":"right",endEdge:_?"right":"left",direction:_?1:-1,size:"width",children:s.jsx(XG,W(M({dir:g,"data-orientation":"horizontal"},u),{ref:p,style:W(M({},u.style),{"--radix-slider-thumb-transform":"translateX(-50%)"}),onSlideStart:N=>{const S=w(N.clientX);o==null||o(S)},onSlideMove:N=>{const S=w(N.clientX);l==null||l(S)},onSlideEnd:()=>{x.current=void 0,c==null||c()},onStepKeyDown:N=>{const k=HG[_?"from-left":"from-right"].includes(N.key);d==null||d({event:N,direction:k?-1:1})}}))})}),L$e=y.forwardRef((e,t)=>{const g=e,{min:r,max:n,inverted:i,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c}=g,d=me(g,["min","max","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"]),u=y.useRef(null),h=sr(t,u),f=y.useRef(void 0),p=!i;function x(v){const _=f.current||u.current.getBoundingClientRect(),w=[0,_.height],N=BC(w,p?[n,r]:[r,n]);return f.current=_,N(v-_.top)}return s.jsx(KG,{scope:e.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:s.jsx(XG,W(M({"data-orientation":"vertical"},d),{ref:h,style:W(M({},d.style),{"--radix-slider-thumb-transform":"translateY(50%)"}),onSlideStart:v=>{const _=x(v.clientY);a==null||a(_)},onSlideMove:v=>{const _=x(v.clientY);o==null||o(_)},onSlideEnd:()=>{f.current=void 0,l==null||l()},onStepKeyDown:v=>{const w=HG[p?"from-bottom":"from-top"].includes(v.key);c==null||c({event:v,direction:w?-1:1})}}))})}),XG=y.forwardRef((e,t)=>{const h=e,{__scopeSlider:r,onSlideStart:n,onSlideMove:i,onSlideEnd:a,onHomeKeyDown:o,onEndKeyDown:l,onStepKeyDown:c}=h,d=me(h,["__scopeSlider","onSlideStart","onSlideMove","onSlideEnd","onHomeKeyDown","onEndKeyDown","onStepKeyDown"]),u=ub(_p,r);return s.jsx(Nt.span,W(M({},d),{ref:t,onKeyDown:mt(e.onKeyDown,f=>{f.key==="Home"?(o(f),f.preventDefault()):f.key==="End"?(l(f),f.preventDefault()):qG.concat(WG).includes(f.key)&&(c(f),f.preventDefault())}),onPointerDown:mt(e.onPointerDown,f=>{const p=f.target;p.setPointerCapture(f.pointerId),f.preventDefault(),u.thumbs.has(p)?p.focus():n(f)}),onPointerMove:mt(e.onPointerMove,f=>{f.target.hasPointerCapture(f.pointerId)&&i(f)}),onPointerUp:mt(e.onPointerUp,f=>{const p=f.target;p.hasPointerCapture(f.pointerId)&&(p.releasePointerCapture(f.pointerId),a(f))})}))}),JG="SliderTrack",QG=y.forwardRef((e,t)=>{const a=e,{__scopeSlider:r}=a,n=me(a,["__scopeSlider"]),i=ub(JG,r);return s.jsx(Nt.span,W(M({"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation},n),{ref:t}))});QG.displayName=JG;var V5="SliderRange",eY=y.forwardRef((e,t)=>{const f=e,{__scopeSlider:r}=f,n=me(f,["__scopeSlider"]),i=ub(V5,r),a=ZG(V5,r),o=y.useRef(null),l=sr(t,o),c=i.values.length,d=i.values.map(p=>nY(p,i.min,i.max)),u=c>1?Math.min(...d):0,h=100-Math.max(...d);return s.jsx(Nt.span,W(M({"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0},n),{ref:l,style:W(M({},e.style),{[a.startEdge]:u+"%",[a.endEdge]:h+"%"})}))});eY.displayName=V5;var q5="SliderThumb",tY=y.forwardRef((e,t)=>{const r=M$e(e.__scopeSlider),[n,i]=y.useState(null),a=sr(t,l=>i(l)),o=y.useMemo(()=>n?r().findIndex(l=>l.ref.current===n):-1,[r,n]);return s.jsx(F$e,W(M({},e),{ref:a,index:o}))}),F$e=y.forwardRef((e,t)=>{const w=e,{__scopeSlider:r,index:n,name:i}=w,a=me(w,["__scopeSlider","index","name"]),o=ub(q5,r),l=ZG(q5,r),[c,d]=y.useState(null),u=sr(t,b=>d(b)),h=c?o.form||!!c.closest("form"):!0,f=bw(c),p=o.values[n],x=p===void 0?0:nY(p,o.min,o.max),g=z$e(n,o.values.length),v=f==null?void 0:f[l.size],_=v?q$e(v,x,l.direction):0;return y.useEffect(()=>{if(c)return o.thumbs.add(c),()=>{o.thumbs.delete(c)}},[c,o.thumbs]),s.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[l.startEdge]:`calc(${x}% + ${_}px)`},children:[s.jsx(z5.ItemSlot,{scope:e.__scopeSlider,children:s.jsx(Nt.span,W(M({role:"slider","aria-label":e["aria-label"]||g,"aria-valuemin":o.min,"aria-valuenow":p,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0},a),{ref:u,style:p===void 0?{display:"none"}:e.style,onFocus:mt(e.onFocus,()=>{o.valueIndexToChangeRef.current=n})}))}),h&&s.jsx(rY,{name:i!=null?i:o.name?o.name+(o.values.length>1?"[]":""):void 0,form:o.form,value:p},n)]})});tY.displayName=q5;var U$e="RadioBubbleInput",rY=y.forwardRef((i,n)=>{var a=i,{__scopeSlider:e,value:t}=a,r=me(a,["__scopeSlider","value"]);const o=y.useRef(null),l=sr(o,n),c=l1(t);return y.useEffect(()=>{const d=o.current;if(!d)return;const u=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(u,"value").set;if(c!==t&&f){const p=new Event("input",{bubbles:!0});f.call(d,t),d.dispatchEvent(p)}},[c,t]),s.jsx(Nt.input,W(M({style:{display:"none"}},r),{ref:l,defaultValue:t}))});rY.displayName=U$e;function B$e(e=[],t,r){const n=[...e];return n[r]=t,n.sort((i,a)=>i-a)}function nY(e,t,r){const a=100/(r-t)*(e-t);return _g(a,[0,100])}function z$e(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function V$e(e,t){if(e.length===1)return 0;const r=e.map(i=>Math.abs(i-t)),n=Math.min(...r);return r.indexOf(n)}function q$e(e,t,r){const n=e/2,a=BC([0,50],[0,n]);return(n-a(t)*r)*r}function W$e(e){return e.slice(0,-1).map((t,r)=>e[r+1]-t)}function H$e(e,t){if(t>0){const r=W$e(e);return Math.min(...r)>=t}return!0}function BC(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function G$e(e){return(String(e).split(".")[1]||"").length}function Y$e(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}var sY=YG,K$e=QG,Z$e=eY,X$e=tY;const iY=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsxs(sY,W(M({ref:r,className:ke("relative flex w-full touch-none select-none items-center",e)},t),{children:[s.jsx(K$e,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:s.jsx(Z$e,{className:"absolute h-full bg-primary"})}),s.jsx(X$e,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}))});iY.displayName=sY.displayName;const yN=["all","users","artists","events","venues"],Hf=2,_y=()=>({users:[],artists:[],events:[],venues:[]}),J$e=[{key:"all",label:"All",icon:LJ,emptyMessage:"No results found."},{key:"users",label:"Users",icon:Ar,emptyMessage:"No users match that search yet."},{key:"artists",label:"Artists",icon:Ct,emptyMessage:"No artists found. Try a different spelling?"},{key:"events",label:"Events",icon:Et,emptyMessage:"No upcoming events match that search."},{key:"venues",label:"Venues",icon:Xt,emptyMessage:"No venues found. Try another location or name."}],YO=({userId:e,allowedTabs:t,showMap:r=!0,layout:n="full",mode:i="full",showResults:a=!0,headerTitle:o,headerDescription:l,headerAccessory:c,showHelperText:d=!0,initialSearchQuery:u="",hideSearchInput:h=!1,onSearchStateChange:f,onNavigateToProfile:p,onNavigateToChat:x,onEventClick:g})=>{var Fe;const v=n==="compact",_=i==="embedded",w=a,b=y.useMemo(()=>{if(!t||t.length===0)return yN;const ve=t.filter(rt=>yN.includes(rt));return ve.length>0?ve:yN},[t]),[N,S]=y.useState(u),[k,O]=y.useState(""),[A,T]=y.useState(()=>{var ve;return(ve=b[0])!=null?ve:"all"}),[$,R]=y.useState(_y),[F,D]=y.useState({all:!1,users:!1,artists:!1,events:!1,venues:!1}),[B,U]=y.useState({}),[V,Y]=y.useState({all:{page:1,hasMore:!1},users:{page:1,hasMore:!1},artists:{page:1,hasMore:!1},events:{page:1,hasMore:!1},venues:{page:1,hasMore:!1}}),z=20,[K,Z]=y.useState([]),[G,X]=y.useState([39.8283,-98.5795]),[te,se]=y.useState(!1),ue=y.useMemo(()=>J$e.filter(({key:ve})=>b.includes(ve)),[b]),ye=ue.length,ne=ye>=4?"grid-cols-4":ye===3?"grid-cols-3":ye===2?"grid-cols-2":"grid-cols-1";y.useEffect(()=>{var ve;b.includes(A)||T((ve=b[0])!=null?ve:"users")},[b,A]),y.useEffect(()=>{u!==N&&S(u)},[u]),y.useEffect(()=>{const ve=setTimeout(()=>O(N.trim()),300);return()=>clearTimeout(ve)},[N]),y.useEffect(()=>{k.length>=Hf&&(Y({all:{page:1,hasMore:!1},users:{page:1,hasMore:!1},artists:{page:1,hasMore:!1},events:{page:1,hasMore:!1},venues:{page:1,hasMore:!1}}),R(_y()))},[k]),y.useEffect(()=>{if(k.length<Hf){R(_y()),U({}),D({all:!1,users:!1,artists:!1,events:!1,venues:!1});return}let ve=!1;return E(void 0,null,function*(){var Ne;D({all:!0,users:!0,artists:!0,events:!0,venues:!0}),U({});const Ve=((Ne=V[A])==null?void 0:Ne.page)||1,lt=z,ut=(Ve-1)*lt,Ze=lt*Ve,qt=lt*Ve,[lr,Ge,Le,yt]=yield Promise.all([Q$e(k,e,lt,ut),Av.searchArtists(k,Ze+1,!1),eLe(k,lt,ut),mF.searchVenues(k,qt+1,!1)]);if(!ve){const Oe=lr.length===lt,ce=Ge.length>Ze,Ee=Le.length===lt,Qe=yt.length>qt,vt=Ve===1?0:$.artists.length,wt=Ve===1?0:$.venues.length,Ht=Ge.slice(vt,vt+lt),Rt=yt.slice(wt,wt+lt);R(Te=>({users:Ve===1?lr:[...Te.users,...lr],artists:Ve===1?Ge.slice(0,lt):[...Te.artists,...Ht],events:Ve===1?Le:[...Te.events,...Le],venues:Ve===1?yt.slice(0,lt):[...Te.venues,...Rt]})),Y(Te=>W(M({},Te),{all:{page:Ve,hasMore:Oe||ce||Ee||Qe},users:{page:Ve,hasMore:Oe},artists:{page:Ve,hasMore:ce},events:{page:Ve,hasMore:Ee},venues:{page:Ve,hasMore:Qe}})),D({all:!1,users:!1,artists:!1,events:!1,venues:!1})}}).catch(()=>{ve||(R(_y()),U({[A]:"Something went wrong. Please try again."}),D({all:!1,users:!1,artists:!1,events:!1,venues:!1}))}),()=>{ve=!0}},[k,e,A,(Fe=V[A])==null?void 0:Fe.page]),y.useEffect(()=>{r&&xe()},[r]);const xe=()=>E(void 0,null,function*(){try{se(!0);const{data:ve,error:rt}=yield P.from("events").select("venue_id, venue_name, venue_city, venue_state, latitude, longitude").not("latitude","is",null).not("longitude","is",null).limit(1e3);if(rt){console.error("Error loading venues for map:",rt);return}if(ve){const Ve=new Map;ve.forEach(Ze=>{var yt,Ne,Oe;const qt=typeof Ze.latitude=="number"?Ze.latitude:Number(Ze.latitude),lr=typeof Ze.longitude=="number"?Ze.longitude:Number(Ze.longitude);if(!Number.isFinite(qt)||!Number.isFinite(lr))return;const Ge=(Ne=(yt=Ze.venue_id)!=null?yt:Ze.venue_name)!=null?Ne:`venue-${qt}-${lr}`,Le=Ve.get(Ge);if(Le){Le.count+=1;return}Ve.set(Ge,{id:Ge,name:(Oe=Ze.venue_name)!=null?Oe:"Unknown Venue",city:Ze.venue_city,state:Ze.venue_state,latitude:qt,longitude:lr,count:1})});const lt=Array.from(Ve.values()).slice(0,500);Z(lt);const ut=lt[0];ut&&X([ut.latitude,ut.longitude])}}finally{se(!1)}}),ge=A==="all"?[...$.users.slice(0,3),...$.artists.slice(0,3),...$.events.slice(0,3),...$.venues.slice(0,3)]:$[A],ie=F[A],ee=B[A],H=y.useMemo(()=>d?N?N.trim().length<Hf?"Type at least 2 characters to see results.":null:"Search for artists, events, venues, or people.":null,[N,d]);y.useEffect(()=>{f==null||f({query:N,debouncedQuery:k})},[N,k,f]);const le=_?"w-full":`${v?"":"min-h-screen"} bg-background`,Se=_?`w-full ${v?"space-y-2":"space-y-4"}`:`max-w-5xl mx-auto px-4 ${v?"py-4 space-y-6":"py-8 space-y-8"}`,fe=(o!=null?o:"Search").trim(),he=fe.length>0,Ae=(l!=null?l:"Find friends, discover artists, and track upcoming shows  all in one place.").trim(),qe=!v&&Ae.length>0;return s.jsx("div",{className:le,children:s.jsxs("div",{className:Se,children:[s.jsxs("div",{className:_&&v?"space-y-1":`${v?"space-y-2":"space-y-4"}`,children:[he&&s.jsx("h1",{className:`${v?"text-2xl font-semibold":"text-3xl font-bold"} text-foreground`,children:fe}),qe&&s.jsx("p",{className:"text-muted-foreground",children:Ae}),!h&&s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Mi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s.jsx(or,{value:N,onChange:ve=>S(ve.target.value),placeholder:'Try "Radiohead"',className:`pl-9 ${v?"h-10 text-sm":""}`,id:"global-search",autoComplete:"off"})]}),c&&s.jsx("div",{className:"flex-shrink-0",children:c})]}),H&&s.jsx("p",{className:`${v?"text-xs":"text-sm"} text-muted-foreground`,"aria-live":"polite",children:H})]}),w&&r&&k.length<Hf&&s.jsx(He,{className:"border border-dashed border-muted-foreground/40 bg-muted/10",children:s.jsxs(st,{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Explore venues on the map"}),s.jsx(Be,{variant:"secondary",className:"text-xs",children:te?"Loading":`${K.length.toLocaleString()} venues`})]}),te&&K.length===0?s.jsxs("div",{className:"flex h-[360px] items-center justify-center text-muted-foreground",children:[s.jsx(er,{className:"h-5 w-5 animate-spin mr-2"}),"Loading venues"]}):K.length===0?s.jsx("div",{className:"flex h-[360px] items-center justify-center text-muted-foreground text-sm",children:"No venues with map data yet. Add some favorites or try searching above."}):s.jsx("div",{className:"h-[420px] rounded-2xl overflow-hidden",children:s.jsx(eB,{center:G,zoom:4,events:K.map(ve=>({id:ve.id,jambase_event_id:ve.id,title:ve.name,artist_name:ve.city?`${ve.name}`:ve.name,artist_id:"",venue_name:ve.name,venue_id:ve.id,event_date:new Date().toISOString(),latitude:ve.latitude,longitude:ve.longitude})),onEventClick:()=>{}})})]})}),w&&k.length>=Hf&&ue.length>0&&s.jsxs(Cl,{value:A,onValueChange:ve=>T(ve),children:[s.jsx(Fo,{className:`grid w-full md:w-auto md:inline-flex bg-muted/60 ${ne}`,children:ue.map(({key:ve,label:rt,icon:Ve})=>s.jsxs(Tn,{value:ve,className:"flex items-center gap-2",children:[s.jsx(Ve,{className:"h-4 w-4"}),s.jsx("span",{children:rt})]},ve))}),ue.map(({key:ve,emptyMessage:rt})=>s.jsx(On,{value:ve,className:"mt-6 space-y-4",children:A===ve&&s.jsxs(s.Fragment,{children:[ie&&s.jsxs("div",{className:"flex items-center justify-center py-16 text-muted-foreground",children:[s.jsx(er,{className:"h-6 w-6 animate-spin mr-2"}),"Searching ",ve,"..."]}),!ie&&ee&&s.jsx(_4,{variant:"destructive",children:s.jsx(w4,{children:ee})}),!ie&&!ee&&k.length>=Hf&&(A==="all"?$.users.length===0&&$.artists.length===0&&$.events.length===0&&$.venues.length===0:ge.length===0)&&s.jsx("div",{className:"rounded-xl border border-dashed border-muted-foreground/30 bg-muted/20 p-12 text-center",children:s.jsx("p",{className:"text-muted-foreground",children:rt})}),!ie&&(A==="all"?$.users.length>0||$.artists.length>0||$.events.length>0||$.venues.length>0:ge.length>0)&&s.jsxs("div",{className:"space-y-4",children:[ve==="all"&&s.jsx(iLe,{results:$,onNavigateToProfile:p,onEventClick:g,onTabChange:T}),ve==="users"&&s.jsxs(s.Fragment,{children:[s.jsx(tLe,{results:$.users,onNavigateToProfile:p}),V.users.hasMore&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(oe,{variant:"outline",onClick:()=>Y(Ve=>W(M({},Ve),{users:W(M({},Ve.users),{page:Ve.users.page+1})})),disabled:F.users,children:F.users?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Load More"})})]}),ve==="artists"&&s.jsxs(s.Fragment,{children:[s.jsx(rLe,{results:$.artists}),V.artists.hasMore&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(oe,{variant:"outline",onClick:()=>Y(Ve=>W(M({},Ve),{artists:W(M({},Ve.artists),{page:Ve.artists.page+1})})),disabled:F.artists,children:F.artists?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Load More"})})]}),ve==="events"&&s.jsxs(s.Fragment,{children:[s.jsx(nLe,{results:$.events,onEventClick:g}),V.events.hasMore&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(oe,{variant:"outline",onClick:()=>Y(Ve=>W(M({},Ve),{events:W(M({},Ve.events),{page:Ve.events.page+1})})),disabled:F.events,children:F.events?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Load More"})})]}),ve==="venues"&&s.jsxs(s.Fragment,{children:[s.jsx(sLe,{results:$.venues}),V.venues.hasMore&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(oe,{variant:"outline",onClick:()=>Y(Ve=>W(M({},Ve),{venues:W(M({},Ve.venues),{page:Ve.venues.page+1})})),disabled:F.venues,children:F.venues?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Load More"})})]})]})]})},ve))]})]})})},Q$e=(e,t,r=25,n=0)=>E(void 0,null,function*(){try{const i=e.trim(),o=i.split(/\s+/).length===1&&i.length>0?`${i}%`:`%${i}%`,{data:l,error:c}=yield P.from("users").select("user_id, name, avatar_url, bio, account_type").ilike("name",o).neq("user_id",t).order("name",{ascending:!0}).range(n,n+r-1);return c?(console.error("Error searching users:",c),[]):(l||[]).map(d=>({id:d.user_id,name:d.name,username:d.name,avatar_url:d.avatar_url,bio:d.bio,verified:!1,account_type:d.account_type}))}catch(i){return console.error("Error searching users:",i),[]}}),eLe=(e,t=25,r=0)=>E(void 0,null,function*(){try{const n=e.trim(),a=n.split(/\s+/).length===1&&n.length>0?`${n}%`:`%${n}%`,{data:o,error:l}=yield P.from("events").select(`
        id,
        title,
        event_date,
        images,
        event_media_url,
        media_urls,
        artist_id,
        venue_id,
        artists(id, name),
        venues(id, name)
      `).ilike("title",a).order("event_date",{ascending:!0}).range(r,r+t-1);return l?(console.error("Error searching events:",l),[]):(o||[]).map(c=>{var f,p,x;let d=null;if(c.event_media_url)d=c.event_media_url;else if(Array.isArray(c.media_urls)&&c.media_urls.length>0)d=c.media_urls[0];else if(Array.isArray(c.images)&&c.images.length>0){const g=c.images.find(v=>v==null?void 0:v.url);d=(f=g==null?void 0:g.url)!=null?f:null}const u=((p=c.artists)==null?void 0:p.name)||null,h=((x=c.venues)==null?void 0:x.name)||null;return{id:c.id,title:c.title,artistName:u,venueName:h,eventDate:c.event_date,imageUrl:d}})}catch(n){return console.error("Error searching events:",n),[]}}),tLe=({results:e,onNavigateToProfile:t})=>s.jsx(s.Fragment,{children:e.map(r=>{var n;return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>t==null?void 0:t(r.id),children:s.jsxs(st,{className:"p-4 flex items-center gap-4",children:[s.jsx(Vr,{className:"h-12 w-12",children:r.avatar_url?s.jsx(Qr,{src:r.avatar_url,alt:r.name}):s.jsx(qr,{children:(n=r.name)==null?void 0:n.slice(0,2).toUpperCase()})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-semibold truncate",children:r.name}),r.verified&&s.jsx(Be,{variant:"outline",children:"Verified"})]}),r.username&&s.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:["@",r.username]}),r.bio&&s.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mt-1",children:r.bio})]})]})},r.id)})}),rLe=({results:e})=>{const t=ci();return console.log(" ArtistResults - Artists with images:",e.map(r=>({name:r.name,hasImage:!!r.image_url,imageUrl:r.image_url}))),s.jsx(s.Fragment,{children:e.map(r=>{const n=r.image_url&&r.image_url.trim().length>0;return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>t(`/artist/${encodeURIComponent(r.name)}`),children:s.jsxs(st,{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0 relative",children:n?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:r.image_url,alt:r.name,className:"h-12 w-12 rounded-full object-cover",onError:i=>{console.warn(` Failed to load image for artist "${r.name}": ${r.image_url}`);const a=i.currentTarget;a.style.display="none";const o=a.nextElementSibling;o&&o.classList.remove("hidden")},onLoad:()=>{console.log(` Loaded image for "${r.name}": ${r.image_url}`)}}),s.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center hidden",children:s.jsx(Ct,{className:"h-5 w-5 text-muted-foreground"})})]}):s.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center",children:s.jsx(Ct,{className:"h-5 w-5 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold truncate",children:r.name}),r.genres&&r.genres.length>0&&s.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:r.genres.slice(0,3).map(i=>s.jsx(Be,{variant:"secondary",className:"text-xs",children:i},i))}),typeof r.num_upcoming_events=="number"&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[r.num_upcoming_events," upcoming ",r.num_upcoming_events===1?"show":"shows"]})]})]})},r.id)})})},nLe=({results:e,onEventClick:t})=>(ci(),s.jsx(s.Fragment,{children:e.map(r=>{var i,a,o,l;const n=(()=>{if(!r.eventDate)return null;try{return Dt(Ws(r.eventDate),"MMM d, yyyy  h:mm a")}catch(c){return r.eventDate}})();return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>{t?t(r):r.id&&window.dispatchEvent(new CustomEvent("open-event-details",{detail:{event:r,eventId:r.id}}))},children:s.jsxs(st,{className:"p-4 flex items-center gap-4",children:[s.jsxs("div",{className:"flex-shrink-0",children:[r.imageUrl?s.jsx("img",{src:r.imageUrl,alt:(a=(i=r.title)!=null?i:r.artistName)!=null?a:"Event",className:"h-16 w-16 rounded-lg object-cover",onError:c=>{var d;c.currentTarget.style.display="none",(d=c.currentTarget.nextElementSibling)==null||d.classList.remove("hidden")}}):null,s.jsx("div",{className:`h-16 w-16 rounded-lg bg-muted flex items-center justify-center ${r.imageUrl?"hidden":""}`,children:s.jsx(Et,{className:"h-5 w-5 text-muted-foreground"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold truncate",children:(l=(o=r.title)!=null?o:r.artistName)!=null?l:"Untitled Event"}),s.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-0.5",children:[r.artistName&&s.jsx("p",{children:r.artistName}),r.venueName&&s.jsx("p",{children:r.venueName}),n&&s.jsx("p",{children:n})]})]})]})},r.id)})})),sLe=({results:e})=>{const t=ci();return s.jsx(s.Fragment,{children:e.map(r=>{var n,i;return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>t(`/venue/${encodeURIComponent(r.name)}`),children:s.jsxs(st,{className:"p-4 flex items-start gap-4",children:[s.jsxs("div",{className:"flex-shrink-0",children:[r.image_url?s.jsx("img",{src:r.image_url,alt:r.name,className:"h-12 w-12 rounded-lg object-cover",onError:a=>{var o;a.currentTarget.style.display="none",(o=a.currentTarget.nextElementSibling)==null||o.classList.remove("hidden")}}):null,s.jsx("div",{className:`h-12 w-12 rounded-lg bg-muted flex items-center justify-center ${r.image_url?"hidden":""}`,children:s.jsx(Xt,{className:"h-5 w-5 text-muted-foreground"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold truncate",children:r.name}),(((n=r.address)==null?void 0:n.addressRegion)||((i=r.address)==null?void 0:i.addressCountry))&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.address.addressRegion||"",r.address.addressRegion&&r.address.addressCountry?", ":"",r.address.addressCountry||""]}),typeof r.num_upcoming_events=="number"&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[r.num_upcoming_events," upcoming ",r.num_upcoming_events===1?"show":"shows"]})]})]})},r.id)})})},iLe=({results:e,onNavigateToProfile:t,onEventClick:r,onTabChange:n})=>(e.users.length+e.artists.length+e.events.length+e.venues.length,s.jsxs("div",{className:"space-y-6",children:[s.jsx(He,{children:s.jsxs(st,{className:"p-4",children:[s.jsx("h3",{className:"font-semibold mb-4",children:"Search Results"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 p-3 rounded-lg transition-colors",onClick:()=>n("users"),children:[s.jsx("div",{className:"text-2xl font-bold",children:e.users.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Users"})]}),s.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 p-3 rounded-lg transition-colors",onClick:()=>n("artists"),children:[s.jsx("div",{className:"text-2xl font-bold",children:e.artists.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Artists"})]}),s.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 p-3 rounded-lg transition-colors",onClick:()=>n("events"),children:[s.jsx("div",{className:"text-2xl font-bold",children:e.events.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Events"})]}),s.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 p-3 rounded-lg transition-colors",onClick:()=>n("venues"),children:[s.jsx("div",{className:"text-2xl font-bold",children:e.venues.length}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Venues"})]})]})]})}),e.users.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold",children:"Users"}),s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>n("users"),children:["View all (",e.users.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:e.users.slice(0,3).map(i=>{var a;return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>t==null?void 0:t(i.id),children:s.jsxs(st,{className:"p-3 flex items-center gap-3",children:[s.jsx(Vr,{className:"h-10 w-10",children:i.avatar_url?s.jsx(Qr,{src:i.avatar_url,alt:i.name}):s.jsx(qr,{children:(a=i.name)==null?void 0:a.slice(0,2).toUpperCase()})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-semibold text-sm truncate",children:i.name}),i.verified&&s.jsx(Be,{variant:"outline",className:"text-xs",children:"Verified"})]}),i.bio&&s.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1 mt-0.5",children:i.bio})]})]})},i.id)})})]}),e.artists.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold",children:"Artists"}),s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>n("artists"),children:["View all (",e.artists.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:e.artists.slice(0,3).map(i=>s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>n("artists"),children:s.jsxs(st,{className:"p-3 flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:i.image_url?s.jsx("img",{src:i.image_url,alt:i.name,className:"h-10 w-10 rounded-full object-cover"}):s.jsx("div",{className:"h-10 w-10 rounded-full bg-muted flex items-center justify-center",children:s.jsx(Ct,{className:"h-5 w-5 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h5",{className:"font-semibold text-sm truncate",children:i.name}),i.genres&&i.genres.length>0&&s.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:i.genres.slice(0,2).map(a=>s.jsx(Be,{variant:"secondary",className:"text-xs",children:a},a))})]})]})},i.id))})]}),e.events.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold",children:"Events"}),s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>n("events"),children:["View all (",e.events.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:e.events.slice(0,3).map(i=>{var o,l,c,d;const a=(()=>{if(!i.eventDate)return null;try{return Dt(Ws(i.eventDate),"MMM d, yyyy")}catch(u){return i.eventDate}})();return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>r==null?void 0:r(i),children:s.jsxs(st,{className:"p-3 flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:i.imageUrl?s.jsx("img",{src:i.imageUrl,alt:(l=(o=i.title)!=null?o:i.artistName)!=null?l:"Event",className:"h-12 w-12 rounded-lg object-cover"}):s.jsx("div",{className:"h-12 w-12 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Et,{className:"h-5 w-5 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h5",{className:"font-semibold text-sm truncate",children:(d=(c=i.title)!=null?c:i.artistName)!=null?d:"Untitled Event"}),s.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5",children:[i.artistName&&s.jsx("p",{className:"truncate",children:i.artistName}),a&&s.jsx("p",{children:a})]})]})]})},i.id)})})]}),e.venues.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold",children:"Venues"}),s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>n("venues"),children:["View all (",e.venues.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:e.venues.slice(0,3).map(i=>{var a,o;return s.jsx(He,{className:"hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>n("venues"),children:s.jsxs(st,{className:"p-3 flex items-center gap-3",children:[s.jsxs("div",{className:"flex-shrink-0",children:[i.image_url?s.jsx("img",{src:i.image_url,alt:i.name,className:"h-10 w-10 rounded-lg object-cover",onError:l=>{var c;l.currentTarget.style.display="none",(c=l.currentTarget.nextElementSibling)==null||c.classList.remove("hidden")}}):null,s.jsx("div",{className:`h-10 w-10 rounded-lg bg-muted flex items-center justify-center ${i.image_url?"hidden":""}`,children:s.jsx(Xt,{className:"h-4 w-4 text-muted-foreground"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h5",{className:"font-semibold text-sm truncate",children:i.name}),(((a=i.address)==null?void 0:a.addressRegion)||((o=i.address)==null?void 0:o.addressCountry))&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[i.address.addressRegion||"",i.address.addressRegion&&i.address.addressCountry?", ":"",i.address.addressCountry||""]})]})]})},i.id)})})]})]})),aLe=zw,oLe=Vw,aY=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(Jm,W(M({className:ke("fixed inset-0 z-[9999] bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e)},t),{ref:r}))});aY.displayName=Jm.displayName;const lLe=qm("fixed z-[9999] gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),oY=y.forwardRef((a,i)=>{var o=a,{side:e="right",className:t,children:r}=o,n=me(o,["side","className","children"]);return s.jsxs(oLe,{children:[s.jsx(aY,{}),s.jsxs(Qm,W(M({ref:i,className:ke(lLe({side:e}),t)},n),{children:[r,s.jsxs(qw,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[s.jsx(pr,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]}))]})});oY.displayName=Qm.displayName;const lY=r=>{var n=r,{className:e}=n,t=me(n,["className"]);return s.jsx("div",M({className:ke("flex flex-col space-y-2 text-center sm:text-left",e)},t))};lY.displayName="SheetHeader";const cY=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(Ev,M({ref:r,className:ke("text-lg font-semibold text-foreground",e)},t))});cY.displayName=Ev.displayName;const dY=y.forwardRef((n,r)=>{var i=n,{className:e}=i,t=me(i,["className"]);return s.jsx(Cv,M({ref:r,className:ke("text-sm text-muted-foreground",e)},t))});dY.displayName=Cv.displayName;const wy=({title:e,description:t,icon:r,onClick:n,className:i})=>s.jsx(He,{className:ke("cursor-pointer transition-all hover:shadow-md hover:scale-[1.02]",i),onClick:n,children:s.jsx(st,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg bg-synth-pink/10 flex items-center justify-center",children:s.jsx(r,{className:"w-5 h-5 text-synth-pink"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold text-sm mb-1",children:e}),s.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:t})]})]})})}),by=[{id:"similar-artists",title:"Similar to Artists You Love",description:"Events by artists similar to ones you've seen",icon:Ct,category:"taste"},{id:"last-5-attended",title:"Based on Your Last 5 Shows",description:"Recommendations from your recent attendance",icon:Et,category:"taste"},{id:"similar-taste-users",title:"Highly Rated by Similar Tastes",description:"Events loved by users with similar music taste",icon:Ar,category:"taste"},{id:"this-weekend",title:"This Weekend",description:"Shows happening this Saturday and Sunday",icon:Et,category:"context"},{id:"under-25",title:"Under $25",description:"Affordable shows under $25",icon:bo,category:"context"},{id:"small-venues",title:"Small Venues",description:"Intimate shows at smaller venues",icon:Ba,category:"context"},{id:"late-shows",title:"Late Shows",description:"Shows starting after 10 PM",icon:ai,category:"context"},{id:"up-and-coming",title:"Up-and-Coming Artists",description:"Artists with fewer than 10 reviews",icon:Sn,category:"discovery"},{id:"less-than-10-reviews",title:"Events with <10 Reviews",description:"Be among the first to review these shows",icon:oa,category:"discovery"},{id:"highest-rated-month",title:"Highest-Rated This Month",description:"Events rated 4.5+ stars this month",icon:Jt,category:"opinion"},{id:"best-venues",title:"Best Venues",description:"Events at venues rated 4+ stars",icon:bl,category:"opinion"},{id:"best-value",title:"Best Value",description:"Events rated highly for value-for-price",icon:_2,category:"opinion"}],cLe=({isOpen:e,onClose:t,onSelectVibe:r,isMobile:n=!1})=>{const i=u=>{r(u),t()},a=by.filter(u=>u.category==="taste"),o=by.filter(u=>u.category==="context"),l=by.filter(u=>u.category==="discovery"),c=by.filter(u=>u.category==="opinion"),d=s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold mb-2",children:"Start with a Vibe"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose a curated entry point to discover events through different perspectives"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:"By Taste"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:a.map(u=>s.jsx(wy,{title:u.title,description:u.description,icon:u.icon,onClick:()=>i(u.id)},u.id))})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:"By Context"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:o.map(u=>s.jsx(wy,{title:u.title,description:u.description,icon:u.icon,onClick:()=>i(u.id)},u.id))})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:"By Discovery Energy"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:l.map(u=>s.jsx(wy,{title:u.title,description:u.description,icon:u.icon,onClick:()=>i(u.id)},u.id))})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:"By Opinion"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:c.map(u=>s.jsx(wy,{title:u.title,description:u.description,icon:u.icon,onClick:()=>i(u.id)},u.id))})]})]});return n?s.jsx(aLe,{open:e,onOpenChange:t,children:s.jsxs(oY,{side:"bottom",className:"h-[90vh] overflow-y-auto",children:[s.jsxs(lY,{children:[s.jsx(cY,{children:"Browse by Vibe"}),s.jsx(dY,{children:"Choose a curated entry point to discover events"})]}),s.jsx("div",{className:"mt-6",children:d})]})}):s.jsx(tn,{open:e,onOpenChange:t,children:s.jsxs(Xr,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Mn,{children:[s.jsx(an,{children:"Browse by Vibe"}),s.jsx(Kn,{children:"Choose a curated entry point to discover events through different perspectives"})]}),s.jsx("div",{className:"mt-4",children:d})]})})};class qi{static applyFilters(t,r){var n,i,a,o;if(!r)return t;if((n=r.dateRange)!=null&&n.from&&(t=t.gte("event_date",r.dateRange.from.toISOString())),(i=r.dateRange)!=null&&i.to&&(t=t.lte("event_date",r.dateRange.to.toISOString())),!((a=r.dateRange)!=null&&a.from)&&!((o=r.dateRange)!=null&&o.to)&&(t=t.gte("event_date",new Date().toISOString())),r.genres&&r.genres.length>0&&(t=t.overlaps("genres",r.genres)),r.cities&&r.cities.length>0){const l=r.cities.map(c=>`venue_city.ilike.%${c}%`).join(",");t=t.or(l)}else if(r.latitude&&r.longitude&&r.radiusMiles){const l=r.radiusMiles/69,c=r.radiusMiles/(69*Math.cos(r.latitude*Math.PI/180));t=t.not("latitude","is",null).not("longitude","is",null).gte("latitude",r.latitude-l).lte("latitude",r.latitude+l).gte("longitude",r.longitude-c).lte("longitude",r.longitude+c)}return t}static getSimilarArtists(t,r=20,n){return E(this,null,function*(){try{console.log(" [VIBE] getSimilarArtists - Starting");const i=new Date;i.setDate(i.getDate()-90),console.log(` [VIBE] getSimilarArtists - Using recency filter: last 90 days (since ${i.toISOString()})`);const{data:a}=yield P.from("reviews").select("events:event_id(artist_name)").eq("user_id",t).eq("is_draft",!1).not("events.artist_name","is",null).gte("created_at",i.toISOString()).order("created_at",{ascending:!1}).limit(50);console.log(` [VIBE] getSimilarArtists - Fetched ${(a==null?void 0:a.length)||0} reviews from last 90 days`);const o=new Set((a||[]).map(d=>{var u;return(u=d.events)==null?void 0:u.artist_name}).filter(Boolean));if(console.log(` [VIBE] getSimilarArtists - Found ${o.size} unique artists from reviews`),o.size===0)return console.log(" [VIBE] getSimilarArtists - No artists found, returning empty"),{events:[],title:"Similar to Artists You Love",description:"We need more data about your music taste to show similar artists.",totalCount:0};let l=P.from("events").select("*").in("artist_name",Array.from(o));l=qi.applyFilters(l,n);const{data:c}=yield l.order("event_date",{ascending:!0}).limit(r);return console.log(` [VIBE] getSimilarArtists - Found ${(c==null?void 0:c.length)||0} events, returning results`),{events:c||[],title:"Similar to Artists You Love",description:"Events by artists you've seen live",totalCount:(c==null?void 0:c.length)||0}}catch(i){return console.error("Error getting similar artists:",i),{events:[],title:"Similar to Artists You Love",description:"Unable to load similar artists.",totalCount:0}}})}static getLast5Attended(t,r=20,n){return E(this,null,function*(){try{console.log(" [VIBE] getLast5Attended - Starting");const{data:i}=yield P.from("reviews").select("events:event_id(artist_name, genres, venue_name)").eq("user_id",t).eq("is_draft",!1).eq("was_there",!0).order("created_at",{ascending:!1}).limit(5);if(console.log(` [VIBE] getLast5Attended - Fetched ${(i==null?void 0:i.length)||0} recent attended events`),!i||i.length===0)return{events:[],title:"Based on Your Last 5 Shows",description:"Attend and review events to get personalized recommendations.",totalCount:0};const a=new Set;i.forEach(c=>{var d;(d=c.events)!=null&&d.genres&&c.events.genres.forEach(u=>a.add(u))});let o=P.from("events").select("*").overlaps("genres",Array.from(a));o=qi.applyFilters(o,n);const{data:l}=yield o.order("event_date",{ascending:!0}).limit(r);return{events:l||[],title:"Based on Your Last 5 Shows",description:"Events similar to shows you've recently attended",totalCount:(l==null?void 0:l.length)||0}}catch(i){return console.error("Error getting last 5 attended:",i),{events:[],title:"Based on Your Last 5 Shows",description:"Unable to load recommendations.",totalCount:0}}})}static getSimilarTasteUsers(t,r=20,n){return E(this,null,function*(){try{console.log(" [VIBE] getSimilarTasteUsers - Starting");const i=new Date;i.setDate(i.getDate()-90),console.log(` [VIBE] getSimilarTasteUsers - Using recency filter: last 90 days (since ${i.toISOString()})`);const{data:a}=yield P.from("reviews").select("events:event_id(genres)").eq("user_id",t).eq("is_draft",!1).not("events.genres","is",null).gte("created_at",i.toISOString()).order("created_at",{ascending:!1}).limit(50);console.log(` [VIBE] getSimilarTasteUsers - Fetched ${(a==null?void 0:a.length)||0} user reviews from last 90 days`);const o=new Set;if((a||[]).forEach(f=>{var p;(p=f.events)!=null&&p.genres&&f.events.genres.forEach(x=>o.add(x))}),console.log(` [VIBE] getSimilarTasteUsers - Found ${o.size} unique genres from user reviews`),o.size===0)return console.log(" [VIBE] getSimilarTasteUsers - No genres found, returning empty"),{events:[],title:"Highly Rated by Similar Tastes",description:"We need more data about your music taste.",totalCount:0};const{data:l}=yield P.from("reviews").select("event_id").gte("rating",4).eq("is_draft",!1).gte("created_at",i.toISOString()).order("created_at",{ascending:!1}).limit(500);if(console.log(` [VIBE] getSimilarTasteUsers - Fetched ${(l==null?void 0:l.length)||0} high-rated reviews (4+) from last 90 days`),!l||l.length===0)return console.log(" [VIBE] getSimilarTasteUsers - No high-rated reviews found, returning empty"),{events:[],title:"Highly Rated by Similar Tastes",description:"No highly rated events found",totalCount:0};const c=[...new Set(l.map(f=>f.event_id))];console.log(` [VIBE] getSimilarTasteUsers - Found ${c.length} unique high-rated events`);let d=P.from("events").select("*").in("id",c).overlaps("genres",Array.from(o));d=qi.applyFilters(d,n);const{data:u}=yield d.order("event_date",{ascending:!0}).limit(r);console.log(` [VIBE] getSimilarTasteUsers - Found ${(u==null?void 0:u.length)||0} events matching genres`);const h=new Map;return(u||[]).forEach(f=>{h.has(f.id)||h.set(f.id,f)}),console.log(` [VIBE] getSimilarTasteUsers - Returning ${h.size} deduplicated events`),{events:Array.from(h.values()),title:"Highly Rated by Similar Tastes",description:"Events rated 4+ stars by users who like similar genres",totalCount:h.size}}catch(i){return console.error("Error getting similar taste users:",i),{events:[],title:"Highly Rated by Similar Tastes",description:"Unable to load recommendations.",totalCount:0}}})}static getThisWeekend(t=20,r){return E(this,null,function*(){try{const n=new Date,i=new Date(n);i.setDate(n.getDate()+(6-n.getDay())%7),i.setHours(0,0,0,0);const a=new Date(i);a.setDate(i.getDate()+1),a.setHours(23,59,59,999);let o=P.from("events").select("*").gte("event_date",i.toISOString()).lte("event_date",a.toISOString());const l=r&&W(M({},r),{dateRange:{from:i,to:a}});o=qi.applyFilters(o,l);const{data:c}=yield o.order("event_date",{ascending:!0}).limit(t);return{events:c||[],title:"This Weekend",description:`Events happening ${i.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${a.toLocaleDateString("en-US",{month:"short",day:"numeric"})}`,totalCount:(c==null?void 0:c.length)||0}}catch(n){return console.error("Error getting weekend events:",n),{events:[],title:"This Weekend",description:"Unable to load weekend events.",totalCount:0}}})}static getUnder25(t=20,r){return E(this,null,function*(){try{let n=P.from("events").select("*").or("price_min.lte.25,price_max.lte.25");n=qi.applyFilters(n,r);const{data:i}=yield n.order("event_date",{ascending:!0}).limit(t);return{events:i||[],title:"Under $25",description:"Affordable shows under $25",totalCount:(i==null?void 0:i.length)||0}}catch(n){return console.error("Error getting under $25 events:",n),{events:[],title:"Under $25",description:"Unable to load affordable events.",totalCount:0}}})}static getSmallVenues(t=20,r){return E(this,null,function*(){try{const{data:n}=yield P.from("venues").select("id").not("maximum_attendee_capacity","is",null).lt("maximum_attendee_capacity",500).limit(100);if(!n||n.length===0)return{events:[],title:"Small Venues",description:"Intimate shows at smaller venues",totalCount:0};const i=n.map(l=>l.id);let a=P.from("events").select("*").in("venue_jambase_id",i);a=qi.applyFilters(a,r);const{data:o}=yield a.order("event_date",{ascending:!0}).limit(t);return{events:o||[],title:"Small Venues",description:"Intimate shows at smaller venues (< 500 capacity)",totalCount:(o==null?void 0:o.length)||0}}catch(n){return console.error("Error getting small venues:",n),{events:[],title:"Small Venues",description:"Unable to load small venue events.",totalCount:0}}})}static getLateShows(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getLateShows - Starting");const n=new Date;new Date(n).setHours(22,0,0,0);let a=P.from("events").select("*").not("doors_time","is",null);a=qi.applyFilters(a,r);const{data:o}=yield a.order("event_date",{ascending:!0}).limit(t*3);console.log(` [VIBE] getLateShows - Fetched ${(o==null?void 0:o.length)||0} events with doors_time`);const l=(o||[]).filter(c=>{if(!c.doors_time)return!1;const d=new Date(c.doors_time),u=d.getHours()>=22;return u&&console.log(` [VIBE] getLateShows - Found late show: ${c.title} at ${d.toLocaleTimeString()}`),u}).slice(0,t);return console.log(` [VIBE] getLateShows - Filtered to ${l.length} late shows (doors_time >= 22:00)`),{events:l,title:"Late Shows",description:"Shows starting after 10 PM",totalCount:l.length}}catch(n){return console.error("Error getting late shows:",n),{events:[],title:"Late Shows",description:"Unable to load late shows.",totalCount:0}}})}static getUpAndComing(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getUpAndComing - Starting");const n=new Date;n.setDate(n.getDate()-180),console.log(` [VIBE] getUpAndComing - Using recency filter: last 180 days (since ${n.toISOString()})`);const{data:i}=yield P.from("reviews").select("events:event_id(artist_name)").eq("is_draft",!1).not("events.artist_name","is",null).gte("created_at",n.toISOString()).order("created_at",{ascending:!1}).limit(2e3);console.log(` [VIBE] getUpAndComing - Fetched ${(i==null?void 0:i.length)||0} reviews from last 180 days`);const a=new Map;(i||[]).forEach(d=>{var h;const u=(h=d.events)==null?void 0:h.artist_name;u&&a.set(u,(a.get(u)||0)+1)}),console.log(` [VIBE] getUpAndComing - Found ${a.size} unique artists with reviews`);const o=Array.from(a.entries()).filter(([d,u])=>u<10).map(([d])=>d);if(console.log(` [VIBE] getUpAndComing - Found ${o.length} artists with <10 reviews`),o.length===0)return{events:[],title:"Up-and-Coming Artists",description:"Artists with fewer than 10 reviews",totalCount:0};let l=P.from("events").select("*").in("artist_name",o.slice(0,50));l=qi.applyFilters(l,r);const{data:c}=yield l.order("event_date",{ascending:!0}).limit(t);return console.log(` [VIBE] getUpAndComing - Found ${(c==null?void 0:c.length)||0} events for up-and-coming artists`),{events:c||[],title:"Up-and-Coming Artists",description:"Artists with fewer than 10 reviews - discover them early",totalCount:(c==null?void 0:c.length)||0}}catch(n){return console.error("Error getting up-and-coming artists:",n),{events:[],title:"Up-and-Coming Artists",description:"Unable to load up-and-coming artists.",totalCount:0}}})}static getLessThan10Reviews(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getLessThan10Reviews - Starting");const n=new Date;n.setDate(n.getDate()-180),console.log(` [VIBE] getLessThan10Reviews - Using recency filter: last 180 days (since ${n.toISOString()})`);const{data:i}=yield P.from("reviews").select("event_id").eq("is_draft",!1).gte("created_at",n.toISOString()).order("created_at",{ascending:!1}).limit(2e3);console.log(` [VIBE] getLessThan10Reviews - Fetched ${(i==null?void 0:i.length)||0} reviews from last 180 days`);const a=new Map;(i||[]).forEach(d=>{a.set(d.event_id,(a.get(d.event_id)||0)+1)}),console.log(` [VIBE] getLessThan10Reviews - Found ${a.size} unique events with reviews`);let o=P.from("events").select("*");o=qi.applyFilters(o,r);const{data:l}=yield o.order("event_date",{ascending:!0}).limit(t*2),c=(l||[]).filter(d=>(a.get(d.id)||0)<10).slice(0,t);return console.log(` [VIBE] getLessThan10Reviews - Filtered to ${c.length} events with <10 reviews`),{events:c,title:"Events with <10 Reviews",description:"Be among the first to review these shows",totalCount:c.length}}catch(n){return console.error("Error getting events with <10 reviews:",n),{events:[],title:"Events with <10 Reviews",description:"Unable to load events.",totalCount:0}}})}static getHighestRatedMonth(t=20,r){return E(this,null,function*(){var n,i;try{console.log(" [VIBE] getHighestRatedMonth - Starting");const a=new Date,o=new Date(a.getFullYear(),a.getMonth(),1),l=new Date(a.getFullYear(),a.getMonth()+1,0,23,59,59);console.log(` [VIBE] getHighestRatedMonth - Filtering reviews from ${o.toISOString()} to ${l.toISOString()}`);const{data:c}=yield P.from("reviews").select("event_id").gte("rating",4.5).eq("is_draft",!1).gte("created_at",o.toISOString()).lte("created_at",l.toISOString()).order("created_at",{ascending:!1}).limit(500);if(console.log(` [VIBE] getHighestRatedMonth - Fetched ${(c==null?void 0:c.length)||0} reviews with rating >= 4.5 this month`),!c||c.length===0)return{events:[],title:"Highest-Rated This Month",description:"No highly rated events this month",totalCount:0};const d=[...new Set(c.map(x=>x.event_id))];console.log(` [VIBE] getHighestRatedMonth - Found ${d.length} unique events with rating >= 4.5 this month`);let u=P.from("events").select("*").gte("event_date",o.toISOString()).lte("event_date",l.toISOString()).in("id",d);const h=r?W(M({},r),{dateRange:{from:(n=r.dateRange)!=null&&n.from&&r.dateRange.from>o?r.dateRange.from:o,to:(i=r.dateRange)!=null&&i.to&&r.dateRange.to<l?r.dateRange.to:l}}):{dateRange:{from:o,to:l}};u=qi.applyFilters(u,h);const{data:f}=yield u.order("event_date",{ascending:!0}).limit(t);console.log(` [VIBE] getHighestRatedMonth - Found ${(f==null?void 0:f.length)||0} events matching filters`);const p=new Map;return(f||[]).forEach(x=>{p.has(x.id)||p.set(x.id,x)}),console.log(` [VIBE] getHighestRatedMonth - Returning ${p.size} deduplicated events`),{events:Array.from(p.values()),title:"Highest-Rated This Month",description:"Events rated 4.5+ stars this month",totalCount:p.size}}catch(a){return console.error("Error getting highest-rated month:",a),{events:[],title:"Highest-Rated This Month",description:"Unable to load highest-rated events.",totalCount:0}}})}static getBestVenues(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getBestVenues - Starting");const n=new Date;n.setDate(n.getDate()-180),console.log(` [VIBE] getBestVenues - Using recency filter: last 180 days (since ${n.toISOString()})`);const{data:i}=yield P.from("reviews").select("event_id, venue_rating_new, venue_rating").eq("is_draft",!1).gte("created_at",n.toISOString()).order("created_at",{ascending:!1}).limit(1e3);if(console.log(` [VIBE] getBestVenues - Fetched ${(i==null?void 0:i.length)||0} reviews from last 180 days`),!i||i.length===0)return{events:[],title:"Best Venues",description:"No highly rated venues found",totalCount:0};const a=i.filter(p=>{const x=p.venue_rating_new||p.venue_rating;return x&&x>=4});if(console.log(` [VIBE] getBestVenues - Found ${a.length} reviews with rating >= 4`),a.length===0)return console.log(" [VIBE] getBestVenues - No high-rated reviews found, returning empty"),{events:[],title:"Best Venues",description:"No highly rated venues found",totalCount:0};const o=[...new Set(a.map(p=>p.event_id))];console.log(` [VIBE] getBestVenues - Found ${o.length} unique events with high venue ratings`);const{data:l}=yield P.from("events").select("id, venue_jambase_id, venue_name").in("id",o);console.log(` [VIBE] getBestVenues - Fetched ${(l==null?void 0:l.length)||0} event details`);const c=new Map,d=new Map((l||[]).map(p=>[p.id,p]));a.forEach(p=>{const x=d.get(p.event_id);if(!x)return;const g=x.venue_jambase_id,v=x.venue_name,_=p.venue_rating_new||p.venue_rating;if(g&&v&&_){const w=c.get(g)||{name:v,avgRating:0,count:0};w.avgRating=(w.avgRating*w.count+_)/(w.count+1),w.count+=1,c.set(g,w)}});const u=Array.from(c.entries()).sort(([p,x],[g,v])=>v.avgRating-x.avgRating).slice(0,20).map(([p])=>p);if(u.length===0)return{events:[],title:"Best Venues",description:"No highly rated venues found",totalCount:0};let h=P.from("events").select("*").in("venue_jambase_id",u);h=qi.applyFilters(h,r);const{data:f}=yield h.order("event_date",{ascending:!0}).limit(t);return console.log(` [VIBE] getBestVenues - Found ${(f==null?void 0:f.length)||0} events at best venues`),{events:f||[],title:"Best Venues",description:"Events at venues rated 4+ stars",totalCount:(f==null?void 0:f.length)||0}}catch(n){return console.error("Error getting best venues:",n),{events:[],title:"Best Venues",description:"Unable to load best venue events.",totalCount:0}}})}static getBestValue(t=20,r){return E(this,null,function*(){try{console.log(" [VIBE] getBestValue - Starting");const n=new Date;n.setDate(n.getDate()-90),console.log(` [VIBE] getBestValue - Using recency filter: last 90 days (since ${n.toISOString()})`);const{data:i}=yield P.from("reviews").select("event_id").gte("value_rating",4).eq("is_draft",!1).not("value_rating","is",null).gte("created_at",n.toISOString()).order("created_at",{ascending:!1}).limit(500);if(console.log(` [VIBE] getBestValue - Fetched ${(i==null?void 0:i.length)||0} reviews with value_rating >= 4 from last 90 days`),!i||i.length===0)return console.log(" [VIBE] getBestValue - No high-value reviews found, returning empty"),{events:[],title:"Best Value",description:"No high value events found",totalCount:0};const a=[...new Set(i.map(d=>d.event_id))];console.log(` [VIBE] getBestValue - Found ${a.length} unique events with high value ratings`);let o=P.from("events").select("*").in("id",a);o=qi.applyFilters(o,r);const{data:l}=yield o.order("event_date",{ascending:!0}).limit(t);console.log(` [VIBE] getBestValue - Found ${(l==null?void 0:l.length)||0} events matching filters`);const c=new Map;return(l||[]).forEach(d=>{c.has(d.id)||c.set(d.id,d)}),console.log(` [VIBE] getBestValue - Returning ${c.size} deduplicated events`),{events:Array.from(c.values()),title:"Best Value",description:"Events rated highly for value-for-price",totalCount:c.size}}catch(n){return console.error("Error getting best value:",n),{events:[],title:"Best Value",description:"Unable to load best value events.",totalCount:0}}})}static executeVibe(t,r,n=20,i){return E(this,null,function*(){switch(console.log(` [VIBE] executeVibe - Executing vibe: ${t} for user: ${r}, limit: ${n}`),i&&console.log(" [VIBE] executeVibe - Filters:",JSON.stringify(i,null,2)),t){case"similar-artists":return this.getSimilarArtists(r,n,i);case"last-5-attended":return this.getLast5Attended(r,n,i);case"similar-taste-users":return this.getSimilarTasteUsers(r,n,i);case"this-weekend":return this.getThisWeekend(n,i);case"under-25":return this.getUnder25(n,i);case"small-venues":return this.getSmallVenues(n,i);case"late-shows":return this.getLateShows(n,i);case"up-and-coming":return this.getUpAndComing(n,i);case"less-than-10-reviews":return this.getLessThan10Reviews(n,i);case"highest-rated-month":return this.getHighestRatedMonth(n,i);case"best-venues":return this.getBestVenues(n,i);case"best-value":return this.getBestValue(n,i);default:return{events:[],title:"Unknown Vibe",description:"Unknown vibe type",totalCount:0}}})}}const zC=({event:e,onClick:t,socialProofCount:r,reasonLabel:n,className:i})=>{var l,c,d;const a=u=>{try{return Dt(new Date(u),"MMM d")}catch(h){return""}},o=((c=(l=e.images)==null?void 0:l[0])==null?void 0:c.url)||e.event_media_url||((d=e.media_urls)==null?void 0:d[0]);return s.jsxs(He,{className:ke("w-[280px] cursor-pointer transition-all hover:shadow-lg overflow-hidden",i),onClick:t,children:[o&&s.jsx("div",{className:"w-full h-32 bg-gray-200 overflow-hidden",children:s.jsx("img",{src:o,alt:e.title||e.artist_name||"Event",className:"w-full h-full object-cover"})}),s.jsxs(st,{className:"p-3",children:[s.jsx("h4",{className:"font-semibold text-sm mb-1 line-clamp-1",children:e.title||e.artist_name||"Event"}),e.artist_name&&s.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:e.artist_name}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-2 flex-wrap",children:[e.event_date&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Et,{className:"w-3 h-3"}),s.jsx("span",{children:a(e.event_date)})]}),(e.venue_city||e.venue_state)&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Xt,{className:"w-3 h-3"}),s.jsx("span",{className:"line-clamp-1",children:e.venue_city?e.venue_state?`${e.venue_city}, ${e.venue_state}`:e.venue_city:e.venue_state||""})]}),(e.price_min||e.price_max||e.price_range)&&s.jsx("div",{className:"flex items-center gap-1 text-xs font-medium text-foreground",children:e.price_range||(e.price_min&&e.price_max?`$${e.price_min}${e.price_min!==e.price_max?`-$${e.price_max}`:""}`:e.price_min?`$${e.price_min}+`:e.price_max?`Up to $${e.price_max}`:"")})]}),(r!==void 0||n)&&s.jsxs("div",{className:"flex items-center gap-2",children:[r!==void 0&&r>0&&s.jsxs(Be,{variant:"secondary",className:"text-xs",children:[r," ",r===1?"person":"people"]}),n&&s.jsx("span",{className:"text-xs text-muted-foreground",children:n})]})]})]})},dLe=["Rock","Pop","Hip-Hop","Electronic","Jazz","Classical","Country","R&B","Reggae","Folk","Blues","Alternative","Indie","Punk","Metal","Funk","Soul","Gospel","Latin","World"],uLe=({vibeType:e,userId:t,filters:r,onBack:n,onNavigateToProfile:i,onNavigateToChat:a})=>{var ee,H,le,Se,ae,fe,he;const[o,l]=y.useState(null),[c,d]=y.useState(!0),[u,h]=y.useState(1),[f,p]=y.useState(null),[x,g]=y.useState(!1),[v,_]=y.useState(!1),[w,b]=y.useState(new Set),[N,S]=y.useState(r||{}),[k,O]=y.useState(!1),[A,T]=y.useState(!1),[$,R]=y.useState(!1),[F,D]=y.useState([]),[B,U]=y.useState([]),[V,Y]=y.useState(!1),z=20;y.useEffect(()=>{$&&K()},[$]),y.useEffect(()=>{ye(),ue()},[e,t,N]);const K=()=>E(void 0,null,function*(){Y(!0);try{const{data:pe}=yield P.from("events").select("venue_city, venue_state").gte("event_date",new Date().toISOString()).not("venue_city","is",null).limit(1e3),Ae=new Map;(pe||[]).forEach(qe=>{if(qe.venue_city){const Fe=`${qe.venue_city}, ${qe.venue_state||""}`.trim(),ve=Ae.get(Fe);ve?ve.eventCount+=1:Ae.set(Fe,{city:qe.venue_city,state:qe.venue_state||"",eventCount:1})}}),U(Array.from(Ae.values()).sort((qe,Fe)=>Fe.eventCount-qe.eventCount).slice(0,50))}catch(pe){console.error("Error loading cities:",pe)}finally{Y(!1)}}),Z=pe=>{var qe;const Ae=(qe=N.genres)!=null&&qe.includes(pe)?N.genres.filter(Fe=>Fe!==pe):[...N.genres||[],pe];S(W(M({},N),{genres:Ae}))},G=()=>{S(W(M({},N),{cities:F})),R(!1)},X=pe=>{D(Ae=>Ae.includes(pe)?Ae.filter(qe=>qe!==pe):[...Ae,pe])},te=()=>{S({dateRange:void 0,genres:[],cities:[],radiusMiles:r==null?void 0:r.radiusMiles,latitude:r==null?void 0:r.latitude,longitude:r==null?void 0:r.longitude}),D([])},se=!!((ee=N.dateRange)!=null&&ee.from||(H=N.dateRange)!=null&&H.to||N.genres&&N.genres.length>0||N.cities&&N.cities.length>0),ue=()=>E(void 0,null,function*(){try{const{data:pe}=yield P.from("user_event_relationships").select("event_id").eq("user_id",t).eq("relationship_type","interested");pe&&b(new Set(pe.map(Ae=>Ae.event_id)))}catch(pe){console.error("Error loading interested events:",pe)}}),ye=()=>E(void 0,null,function*(){d(!0);try{const pe=yield qi.executeVibe(e,t,z*3,N);l(pe),h(1)}catch(pe){console.error("Error loading vibe results:",pe),l({events:[],title:"Error",description:"Unable to load results",totalCount:0})}finally{d(!1)}}),ne=pe=>E(void 0,null,function*(){try{const{data:Ae}=yield P.from("events").select("*").eq("id",pe.id).single();if(Ae){p(Ae);const qe=yield Hn.isUserInterested(t,Ae.id);_(qe),g(!0)}else p(pe),_(w.has(pe.id||"")),g(!0)}catch(Ae){console.error("Error fetching event details:",Ae),p(pe),_(w.has(pe.id||"")),g(!0)}}),xe=(pe,Ae)=>E(void 0,null,function*(){try{yield Hn.setEventInterest(t,pe,Ae),b(qe=>{const Fe=new Set(qe);return Ae?Fe.add(pe):Fe.delete(pe),Fe}),_(Ae)}catch(qe){console.error("Error toggling interest:",qe)}}),ge=(o==null?void 0:o.events.slice(0,u*z))||[],ie=o?ge.length<o.events.length:!1;return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsxs("div",{className:"max-w-6xl mx-auto px-4 pt-4 pb-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:n,className:"mb-4",children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back to Discover"]}),o&&s.jsxs(s.Fragment,{children:[s.jsx("h1",{className:"text-2xl font-bold mb-2",children:o.title}),s.jsx("p",{className:"text-muted-foreground",children:o.description})]})]}),s.jsxs("div",{className:"mb-6 flex items-center gap-2 flex-wrap",children:[s.jsxs(rc,{open:k,onOpenChange:O,children:[s.jsx(nc,{asChild:!0,children:s.jsx(oe,{variant:"outline",size:"sm",className:"p-2 flex-shrink-0",children:s.jsx(Et,{className:"h-4 w-4 text-black"})})}),s.jsx(ul,{className:"w-auto p-0 bg-white",align:"start",children:s.jsx(v1,{mode:"range",selected:{from:(le=N.dateRange)==null?void 0:le.from,to:(Se=N.dateRange)==null?void 0:Se.to},onSelect:pe=>{S(W(M({},N),{dateRange:pe})),pe!=null&&pe.from&&(pe!=null&&pe.to)&&O(!1)},numberOfMonths:2})})]}),s.jsxs(rc,{open:A,onOpenChange:T,children:[s.jsx(nc,{asChild:!0,children:s.jsxs(oe,{variant:"outline",size:"sm",className:"p-2 relative flex-shrink-0",children:[s.jsx(Ct,{className:"h-4 w-4 text-black"}),N.genres&&N.genres.length>0&&s.jsx(Be,{variant:"secondary",className:"absolute -top-1 -right-1 h-4 min-w-4 px-1 text-xs flex items-center justify-center",children:N.genres.length})]})}),s.jsx(ul,{className:"w-80 bg-white",align:"start",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"font-semibold text-sm mb-2",children:"Select Genres"}),s.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-64 overflow-y-auto",children:dLe.map(pe=>{var Ae;return s.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer p-2 rounded hover:bg-accent",children:[s.jsx(W2,{checked:((Ae=N.genres)==null?void 0:Ae.includes(pe))||!1,onCheckedChange:()=>Z(pe)}),s.jsx("span",{children:pe})]},pe)})})]})})]}),s.jsxs(rc,{open:$,onOpenChange:pe=>{R(pe),pe&&D(N.cities||[])},children:[s.jsx(nc,{asChild:!0,children:s.jsxs(oe,{variant:"outline",size:"sm",className:"p-2 relative flex-shrink-0",children:[s.jsx(Xt,{className:"h-4 w-4 text-black"}),N.cities&&N.cities.length>0&&s.jsx(Be,{variant:"secondary",className:"absolute -top-1 -right-1 h-4 min-w-4 px-1 text-xs flex items-center justify-center",children:N.cities.length})]})}),s.jsx(ul,{className:"w-80 bg-white",align:"start",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"font-semibold text-sm mb-2",children:"Select Cities"}),V?s.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading cities..."}):s.jsx("div",{className:"max-h-64 overflow-y-auto space-y-1",children:B.map((pe,Ae)=>{const qe=pe.state?`${pe.city}, ${pe.state}`:pe.city,Fe=F.includes(qe);return s.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer p-2 rounded hover:bg-accent",children:[s.jsx(W2,{checked:Fe,onCheckedChange:()=>X(qe)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:pe.city}),pe.state&&s.jsx("div",{className:"text-xs text-muted-foreground",children:pe.state})]}),s.jsx("div",{className:"text-xs text-muted-foreground",children:pe.eventCount})]},`${qe}-${Ae}`)})}),s.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[s.jsx(oe,{size:"sm",onClick:G,className:"flex-1",children:"Apply"}),s.jsx(oe,{size:"sm",variant:"outline",onClick:()=>{D([]),S(W(M({},N),{cities:[]}))},children:"Clear"})]})]})})]}),se&&s.jsx(oe,{variant:"ghost",size:"sm",onClick:te,className:"p-2 text-muted-foreground hover:text-foreground flex-shrink-0",children:s.jsx(pr,{className:"h-4 w-4 text-black"})})]}),se&&s.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-4",children:[((ae=N.dateRange)==null?void 0:ae.from)&&s.jsxs(Be,{variant:"secondary",className:"gap-1",children:["Date: ",Dt(N.dateRange.from,"MMM d"),N.dateRange.to&&` - ${Dt(N.dateRange.to,"MMM d")}`,s.jsx("button",{onClick:()=>S(W(M({},N),{dateRange:void 0})),className:"ml-1 hover:text-destructive",children:s.jsx(pr,{className:"h-3 w-3"})})]}),(fe=N.genres)==null?void 0:fe.map(pe=>s.jsxs(Be,{variant:"secondary",className:"gap-1",children:[pe,s.jsx("button",{onClick:()=>Z(pe),className:"ml-1 hover:text-destructive",children:s.jsx(pr,{className:"h-3 w-3"})})]},pe)),(he=N.cities)==null?void 0:he.map(pe=>s.jsxs(Be,{variant:"secondary",className:"gap-1",children:[pe,s.jsx("button",{onClick:()=>{var Ae;S(W(M({},N),{cities:(Ae=N.cities)==null?void 0:Ae.filter(qe=>qe!==pe)}))},className:"ml-1 hover:text-destructive",children:s.jsx(pr,{className:"h-3 w-3"})})]},pe))]}),c?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(er,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):o&&o.events.length===0?s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:"No events found for this vibe."})}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:ge.map(pe=>s.jsx(zC,{event:pe,onClick:()=>ne(pe),socialProofCount:void 0},pe.id))}),ie&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(oe,{variant:"outline",onClick:()=>h(pe=>pe+1),children:"Load More"})}),!ie&&o&&o.events.length>0&&s.jsxs("div",{className:"text-center py-4 text-sm text-muted-foreground",children:["Showing all ",o.events.length," events"]})]})]}),x&&f&&s.jsx(Cc,{isOpen:x,onClose:()=>{g(!1),p(null)},event:f,currentUserId:t,isInterested:v,onInterestToggle:xe,onReview:()=>{console.log("Review event:",f.id)},onNavigateToProfile:i,onNavigateToChat:a})]})},VC=({title:e,description:t,items:r,loading:n=!1,emptyMessage:i="No items to display",className:a,itemClassName:o,showTitle:l=!0})=>n?s.jsxs("div",{className:ke("space-y-2",a),children:[l&&e&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold",children:e}),t&&s.jsx("p",{className:"text-sm text-muted-foreground",children:t})]}),s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(er,{className:"w-6 h-6 animate-spin text-muted-foreground"})})]}):r.length===0?s.jsxs("div",{className:ke("space-y-2",a),children:[l&&e&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold",children:e}),t&&s.jsx("p",{className:"text-sm text-muted-foreground",children:t})]}),s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:s.jsx("p",{children:i})})]}):s.jsxs("div",{className:ke("space-y-2",a),children:[l&&e&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold",children:e}),t&&s.jsx("p",{className:"text-sm text-muted-foreground",children:t})]}),s.jsx("div",{className:"overflow-x-auto pb-2 -mx-4 px-4 scrollbar-hide",children:s.jsx("div",{className:"flex gap-4 items-stretch",style:{width:"max-content",minWidth:"100%",justifyContent:"center"},children:r.map((c,d)=>s.jsx("div",{className:ke("flex-shrink-0 h-full",o),children:c},d))})})]});class fLe{static getEventsByArtist(t,r,n=10){return E(this,null,function*(){try{const i=yield Oh.getUserTopArtists(t,20);if(!i.some(c=>c.artist_name.toLowerCase()===r.toLowerCase())){const{data:c}=yield P.from("events").select("*").ilike("artist_name",`%${r}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(n);return(c||[]).map(d=>W(M({},d),{reason:`Because you like ${r}`,sourceArtist:r}))}const o=i.filter(c=>c.artist_name.toLowerCase()===r.toLowerCase()).flatMap(c=>c.genres||[]);if(o.length===0){const{data:c}=yield P.from("events").select("*").ilike("artist_name",`%${r}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(n);return(c||[]).map(d=>W(M({},d),{reason:`Because you like ${r}`,sourceArtist:r}))}const{data:l}=yield P.from("events").select("*").gte("event_date",new Date().toISOString()).overlaps("genres",o).not("artist_name","ilike",`%${r}%`).order("event_date",{ascending:!0}).limit(n);return(l||[]).map(c=>W(M({},c),{reason:`Similar to ${r}`,sourceArtist:r}))}catch(i){return console.error("Error getting events by artist:",i),[]}})}static getEventsByVenue(t,r,n=10){return E(this,null,function*(){try{const{data:i}=yield P.from("events").select("*").ilike("venue_name",`%${r}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(n);return(i||[]).map(a=>W(M({},a),{reason:`At ${r} (you rated this venue highly)`,sourceVenue:r}))}catch(i){return console.error("Error getting events by venue:",i),[]}})}static getEventsByGenre(t,r,n=10){return E(this,null,function*(){try{const{data:i}=yield P.from("events").select("*").gte("event_date",new Date().toISOString()).contains("genres",[r]).order("event_date",{ascending:!0}).limit(n);return(i||[]).map(a=>W(M({},a),{reason:`Because you attend ${r} shows`,sourceGenre:r}))}catch(i){return console.error("Error getting events by genre:",i),[]}})}static getAllBecauseYouLike(t){return E(this,null,function*(){try{const r=[],n=yield Oh.getUserTopArtists(t,5);for(const f of n.slice(0,3)){const p=yield this.getEventsByArtist(t,f.artist_name,10);p.length>0&&r.push({title:`Because you like ${f.artist_name}`,events:p,type:"artist"})}const{data:i,error:a}=yield P.from("reviews").select("venue_rating, event_id").eq("user_id",t).eq("is_draft",!1).gte("venue_rating",4).not("venue_rating","is",null).limit(10);if(a)return console.warn("Error fetching venue reviews:",a),r;if(!i||i.length===0)return r;const o=i.map(f=>f.event_id).filter(Boolean),l=new Map;if(o.length>0){const{data:f}=yield P.from("events").select("id, venue_name").in("id",o);(f||[]).forEach(p=>{p.venue_name&&l.set(p.id,p.venue_name)})}const c=new Set;i.forEach(f=>{const p=l.get(f.event_id);p&&c.add(p)});for(const f of Array.from(c).slice(0,2)){const p=yield this.getEventsByVenue(t,f,10);p.length>0&&r.push({title:`At ${f} (you rated this venue highly)`,events:p,type:"venue"})}const{data:d}=yield P.from("reviews").select("events:event_id(genres)").eq("user_id",t).eq("is_draft",!1).not("events.genres","is",null).limit(20),u=new Map;(d||[]).forEach(f=>{var p;(p=f.events)!=null&&p.genres&&f.events.genres.forEach(x=>{u.set(x,(u.get(x)||0)+1)})});const h=Array.from(u.entries()).sort(([f,p],[x,g])=>g-p).slice(0,2).map(([f])=>f);for(const f of h){const p=yield this.getEventsByGenre(t,f,10);p.length>0&&r.push({title:`Because you attend ${f} shows`,events:p,type:"genre"})}return r}catch(r){return console.error("Error getting all because you like:",r),[]}})}static dismissRecommendation(t,r,n){return E(this,null,function*(){try{const{data:i}=yield P.from("users").select("dismissed_recommendations").eq("user_id",t).single(),a=(i==null?void 0:i.dismissed_recommendations)||[],o=`${r}:${n}`;a.includes(o)||(yield P.from("users").update({dismissed_recommendations:[...a,o]}).eq("user_id",t))}catch(i){console.error("Error dismissing recommendation:",i)}})}}const hLe=({currentUserId:e,onNavigateToProfile:t,onNavigateToChat:r})=>{const[n,i]=y.useState([]),[a,o]=y.useState(!0),[l,c]=y.useState(new Set),[d,u]=y.useState(null),[h,f]=y.useState(!1),[p,x]=y.useState(!1),[g,v]=y.useState(new Set);y.useEffect(()=>{b(),_(),w()},[e]);const _=()=>E(void 0,null,function*(){try{const{data:A}=yield P.from("user_event_relationships").select("event_id").eq("user_id",e).eq("relationship_type","interested");A&&v(new Set(A.map(T=>T.event_id)))}catch(A){console.error("Error loading interested events:",A)}}),w=()=>E(void 0,null,function*(){try{const{data:A}=yield P.from("users").select("dismissed_recommendations").eq("user_id",e).single();A!=null&&A.dismissed_recommendations&&c(new Set(A.dismissed_recommendations))}catch(A){console.error("Error loading dismissed carousels:",A)}}),b=()=>E(void 0,null,function*(){o(!0);try{const A=yield fLe.getAllBecauseYouLike(e);i(A)}catch(A){console.error("Error loading because you like carousels:",A),i([])}finally{o(!1)}}),N=A=>E(void 0,null,function*(){try{const T=`${A.type}:${A.title}`;c(F=>new Set(F).add(T));const{data:$}=yield P.from("users").select("dismissed_recommendations").eq("user_id",e).single(),R=($==null?void 0:$.dismissed_recommendations)||[];R.includes(T)||(yield P.from("users").update({dismissed_recommendations:[...R,T]}).eq("user_id",e)),i(F=>F.filter(D=>D.title!==A.title))}catch(T){console.error("Error dismissing carousel:",T)}}),S=A=>E(void 0,null,function*(){try{const{data:T}=yield P.from("events").select("*").eq("id",A.id).single();if(T){u(T);const $=yield Hn.isUserInterested(e,T.id);x($),f(!0)}else u(A),x(g.has(A.id||"")),f(!0)}catch(T){console.error("Error fetching event details:",T),u(A),x(g.has(A.id||"")),f(!0)}}),k=(A,T)=>E(void 0,null,function*(){try{yield Hn.setEventInterest(e,A,T),v($=>{const R=new Set($);return T?R.add(A):R.delete(A),R}),x(T)}catch($){console.error("Error toggling interest:",$)}}),O=n.filter(A=>{const T=`${A.type}:${A.title}`;return!l.has(T)});return O.length===0&&!a?null:s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-6",children:O.map(A=>s.jsxs("div",{className:"relative",children:[s.jsx(VC,{title:A.title,items:A.events.slice(0,10).map(T=>s.jsx(zC,{event:T,onClick:()=>S(T)},T.id)),loading:a,emptyMessage:`No events found for ${A.title}`}),s.jsx(oe,{variant:"ghost",size:"sm",className:"absolute top-0 right-0",onClick:()=>N(A),children:s.jsx(pr,{className:"w-4 h-4"})})]},A.title))}),h&&d&&s.jsx(Cc,{isOpen:h,onClose:()=>{f(!1),u(null)},event:d,currentUserId:e,isInterested:p,onInterestToggle:k,onReview:()=>{console.log("Review event:",d.id)},onNavigateToProfile:t,onNavigateToChat:r})]})},mLe=({scene:e,onClick:t,className:r})=>{var u,h,f,p,x;const n=e.userProgress,i=((u=e.participants)==null?void 0:u.length)||(((h=e.participating_artists)==null?void 0:h.length)||0)+(((f=e.participating_venues)==null?void 0:f.length)||0)+(((p=e.participating_cities)==null?void 0:p.length)||0)+(((x=e.participating_genres)==null?void 0:x.length)||0),a=n?(n.artists_experienced||0)+(n.venues_experienced||0)+(n.cities_experienced||0)+(n.genres_experienced||0):0,o=i,l=a,c=o>0?Math.min(l/o*100,100):0,d=()=>{if(c<30){const g=c/30;return`linear-gradient(90deg, rgb(239, 68, 68) 0%, rgb(${239-Math.round(g*100)}, ${68+Math.round(g*100)}, ${68-Math.round(g*50)}) 100%)`}else if(c<70){const g=(c-30)/40;return`linear-gradient(90deg, rgb(234, 179, 8) 0%, rgb(${234-Math.round(g*100)}, ${179+Math.round(g*50)}, ${8+Math.round(g*50)}) 100%)`}else return"linear-gradient(90deg, rgb(34, 197, 94) 0%, rgb(22, 163, 74) 100%)"};return s.jsxs(He,{className:ke("cursor-pointer transition-all hover:shadow-lg flex flex-col h-full min-h-[400px] w-[320px] flex-shrink-0",r),onClick:t,children:[s.jsxs(xr,{className:"pb-2",children:[s.jsx(Cr,{className:"text-lg font-bold leading-tight",children:e.name}),e.short_description&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:e.short_description})]}),s.jsxs(st,{className:"flex-1 flex flex-col space-y-3",children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-muted-foreground font-medium",children:"Progress"}),s.jsxs("span",{className:"font-semibold",children:[l,"/",o," participants"]})]}),s.jsx("div",{className:"w-full bg-muted rounded-full h-2.5 overflow-hidden",children:s.jsx("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${c}%`,background:d()}})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide",children:"Participants"}),e.participants&&e.participants.length>0?s.jsxs(s.Fragment,{children:[(()=>{const g=e.participants.filter(v=>v.participant_type==="artist"&&v.artist_name);return g.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[s.jsx(Ct,{className:"w-3 h-3"}),s.jsxs("span",{className:"font-medium",children:["Artists (",g.length,")"]})]}),s.jsxs("p",{className:"text-xs font-medium line-clamp-1 text-foreground",children:[g.slice(0,3).map(v=>v.artist_name).filter(Boolean).join(", "),g.length>3&&` +${g.length-3}`]})]})})(),(()=>{const g=e.participants.filter(v=>v.participant_type==="venue"&&v.venue_name);return g.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[s.jsx(Xt,{className:"w-3 h-3"}),s.jsxs("span",{className:"font-medium",children:["Venues (",g.length,")"]})]}),s.jsxs("p",{className:"text-xs font-medium line-clamp-1 text-foreground",children:[g.slice(0,3).map(v=>v.venue_name).filter(Boolean).join(", "),g.length>3&&` +${g.length-3}`]})]})})()]}):s.jsxs(s.Fragment,{children:[e.participating_venues&&e.participating_venues.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[s.jsx(Xt,{className:"w-3 h-3"}),s.jsxs("span",{className:"font-medium",children:["Venues (",e.participating_venues.length,")"]})]}),s.jsxs("p",{className:"text-xs font-medium line-clamp-1 text-foreground",children:[e.participating_venues.slice(0,3).join(", "),e.participating_venues.length>3&&` +${e.participating_venues.length-3}`]})]}),e.participating_artists&&e.participating_artists.length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[s.jsx(Ct,{className:"w-3 h-3"}),s.jsxs("span",{className:"font-medium",children:["Artists (",e.participating_artists.length,")"]})]}),s.jsxs("p",{className:"text-xs font-medium line-clamp-1 text-foreground",children:[e.participating_artists.slice(0,3).join(", "),e.participating_artists.length>3&&` +${e.participating_artists.length-3}`]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-2 border-t mt-auto",children:[s.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[s.jsx(Et,{className:"w-3 h-3"}),s.jsxs("span",{children:[e.upcomingEventsCount||0," upcoming"]})]}),s.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[s.jsx(Ar,{className:"w-3 h-3"}),s.jsxs("span",{children:[e.activeReviewersCount||0," reviewers"]})]})]})]})]})};class uY{static getScenes(t=10,r){return E(this,null,function*(){try{let n=P.from("scenes").select("*").eq("is_active",!0).order("sort_order",{ascending:!0}).order("is_featured",{ascending:!1}).limit(t);const{data:i,error:a}=yield n;if(a)throw a;if(!i||i.length===0)return[];let o=new Map;if(r)try{const g=i.map(w=>w.id),{data:v,error:_}=yield P.from("user_scene_progress").select("*").eq("user_id",r).in("scene_id",g);!_&&v&&v.forEach(w=>{o.set(w.scene_id,w)})}catch(g){}const l=i.map(g=>g.id),{data:c}=yield P.from("scene_participants").select(`
          id,
          scene_id,
          participant_type,
          artist_id,
          venue_id,
          text_value
        `).in("scene_id",l),d=[...new Set((c==null?void 0:c.filter(g=>g.artist_id).map(g=>g.artist_id))||[])],u=[...new Set((c==null?void 0:c.filter(g=>g.venue_id).map(g=>g.venue_id))||[])],h=new Map;if(d.length>0){const{data:g}=yield P.from("artists").select("id, name").in("id",d);g==null||g.forEach(v=>h.set(v.id,v.name))}const f=new Map;if(u.length>0){const{data:g}=yield P.from("venues").select("id, name").in("id",u);g==null||g.forEach(v=>f.set(v.id,v.name))}const p=new Map;return c&&c.forEach(g=>{p.has(g.scene_id)||p.set(g.scene_id,[]),p.get(g.scene_id).push({id:g.id,participant_type:g.participant_type,artist_id:g.artist_id,venue_id:g.venue_id,text_value:g.text_value,artist_name:g.artist_id?h.get(g.artist_id):void 0,venue_name:g.venue_id?f.get(g.venue_id):void 0})}),yield Promise.all(i.map(g=>E(this,null,function*(){const v=p.get(g.id)||[],_=v.filter(O=>O.participant_type==="artist"&&O.artist_id).map(O=>O.artist_id),w=v.filter(O=>O.participant_type==="venue"&&O.venue_id).map(O=>O.venue_id),b=v.filter(O=>O.participant_type==="city"&&O.text_value).map(O=>O.text_value),N=v.filter(O=>O.participant_type==="genre"&&O.text_value).map(O=>O.text_value),S=yield this.getUpcomingEventsCount(W(M({},g),{participating_artists:_,participating_venues:w,participating_cities:b,participating_genres:N})),k=yield this.getActiveReviewersCount(g.id,N);return W(M({},g),{participants:v,participating_artists:_,participating_venues:w,participating_cities:b,participating_genres:N,upcomingEventsCount:S,activeReviewersCount:k,userProgress:o.get(g.id)})})))}catch(n){return console.error("Error getting scenes:",n),[]}})}static getActiveReviewersCount(t,r){return E(this,null,function*(){try{const{data:n}=yield P.from("scenes").select("*").eq("id",t).single();if(!n)return 0;let i=P.from("events").select("id").gte("event_date",new Date().toISOString());n.participating_artists&&n.participating_artists.length>0&&(i=i.in("artist_id",n.participating_artists).not("artist_id","is",null)),n.participating_venues&&n.participating_venues.length>0&&(i=i.in("venue_id",n.participating_venues).not("venue_id","is",null)),n.participating_cities&&n.participating_cities.length>0&&(i=i.in("venue_city",n.participating_cities)),r&&r.length>0&&(i=i.overlaps("genres",r));const{data:a}=yield i.limit(100);if(!a||a.length===0)return 0;const o=a.map(d=>d.id),{count:l,error:c}=yield P.from("reviews").select("user_id",{count:"exact",head:!0}).in("event_id",o).eq("is_draft",!1).eq("was_there",!0);if(c)throw c;return l||0}catch(n){return console.error("Error counting active reviewers:",n),0}})}static getUpcomingEventsCount(t){return E(this,null,function*(){try{let r=P.from("events").select("id",{count:"exact",head:!0}).gte("event_date",new Date().toISOString());t.participating_artists&&t.participating_artists.length>0&&(r=r.in("artist_id",t.participating_artists).not("artist_id","is",null)),t.participating_venues&&t.participating_venues.length>0&&(r=r.in("venue_id",t.participating_venues).not("venue_id","is",null)),t.participating_cities&&t.participating_cities.length>0&&(r=r.in("venue_city",t.participating_cities)),t.participating_genres&&t.participating_genres.length>0&&(r=r.overlaps("genres",t.participating_genres));const{count:n,error:i}=yield r;if(i)throw i;return n||0}catch(r){return console.error("Error counting upcoming events:",r),0}})}static getUserSceneProgress(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("user_scene_progress").select("*").eq("user_id",t).eq("scene_id",r).maybeSingle();return i?i.code==="PGRST116"?null:i.code==="PGRST301"||i.status===406?(console.warn("RLS blocking access to user_scene_progress:",{code:i.code,status:i.status,message:i.message}),null):(console.warn("Error getting user scene progress:",i),null):n}catch(n){return console.warn("Error getting user scene progress:",n),null}})}static refreshSceneProgress(t,r){return E(this,null,function*(){try{const{error:n}=yield P.rpc("calculate_scene_progress",{p_user_id:t,p_scene_id:r});return n?(console.warn("Scene progress calculation failed (non-critical):",n),!1):!0}catch(n){return console.warn("Error refreshing scene progress (non-critical):",n),!1}})}static getAllUserSceneProgress(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.rpc("get_all_user_scene_progress",{p_user_id:t});if(!n&&r)return r;n&&n.status!==406&&console.warn("RPC function error (non-critical):",n);const{data:i,error:a}=yield P.from("user_scene_progress").select("*").eq("user_id",t).order("last_activity_at",{ascending:!1});return a?a.code==="PGRST301"||a.status===406?[]:(console.warn("Error getting all user scene progress:",a),[]):i||[]}catch(r){return console.warn("Error getting all user scene progress:",r),[]}})}static generateScenes(t=10){return E(this,null,function*(){return this.getScenes(t)})}static getSceneDetails(t,r){return E(this,null,function*(){try{const{data:n,error:i}=yield P.from("scenes").select("*").eq("id",t).eq("is_active",!0).single();if(i||!n)return null;let a=null;if(r)try{a=yield this.getUserSceneProgress(r,t)}catch(R){}const{data:o}=yield P.from("scene_participants").select(`
          id,
          participant_type,
          artist_id,
          venue_id,
          text_value
        `).eq("scene_id",t),l=[...new Set((o==null?void 0:o.filter(R=>R.artist_id).map(R=>R.artist_id))||[])],c=[...new Set((o==null?void 0:o.filter(R=>R.venue_id).map(R=>R.venue_id))||[])],d=new Map;if(l.length>0){const{data:R}=yield P.from("artists").select("id, name, identifier").in("id",l);R==null||R.forEach(F=>d.set(F.id,{name:F.name,identifier:F.identifier}))}const u=new Map;if(c.length>0){const{data:R}=yield P.from("venues").select("id, name, identifier").in("id",c);R==null||R.forEach(F=>u.set(F.id,{name:F.name,identifier:F.identifier}))}const h=[],f=[],p=[],x=[],g=[];o&&o.forEach(R=>{var F,D;if(g.push({id:R.id,participant_type:R.participant_type,artist_id:R.artist_id,venue_id:R.venue_id,text_value:R.text_value,artist_name:R.artist_id?(F=d.get(R.artist_id))==null?void 0:F.name:void 0,venue_name:R.venue_id?(D=u.get(R.venue_id))==null?void 0:D.name:void 0}),R.participant_type==="artist"&&R.artist_id){const B=d.get(R.artist_id);B!=null&&B.identifier&&h.push(B.identifier)}else if(R.participant_type==="venue"&&R.venue_id){const B=u.get(R.venue_id);B!=null&&B.identifier&&f.push(B.identifier)}else R.participant_type==="city"&&R.text_value?p.push(R.text_value):R.participant_type==="genre"&&R.text_value&&x.push(R.text_value)});const v=[],_=new Set,w=[];if(h.length>0){const R=P.from("events").select("*").gte("event_date",new Date().toISOString()).not("artist_id","is",null).order("event_date",{ascending:!0}).limit(200).then(({data:F,error:D})=>{if(D)throw D;return F?F.filter(U=>U.artist_id?h.some(V=>{if(U.artist_id===V)return!0;const Y=U.artist_id.replace(/^jambase:/,""),z=V.replace(/^jambase:/,"");return Y===z}):!1):[]});v.push(R)}if(f.length>0){const R=g.filter(D=>D.participant_type==="venue"&&D.venue_name).map(D=>D.venue_name).filter(Boolean),F=P.from("events").select("*").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(500).then(({data:D,error:B})=>{if(B)throw B;return D?D.filter(V=>V.venue_id&&f.some(z=>{if(V.venue_id===z)return!0;const K=V.venue_id.replace(/^jambase:/,""),Z=z.replace(/^jambase:/,"");return K===Z})?!0:V.venue_name&&R.length>0?R.some(Y=>{var Z;const z=(Z=V.venue_name)==null?void 0:Z.toLowerCase().trim(),K=Y==null?void 0:Y.toLowerCase().trim();return!z||!K?!1:z===K||z.includes(K)||K.includes(z)}):!1):[]});v.push(F)}if(p.length>0){const R=P.from("events").select("*").gte("event_date",new Date().toISOString()).in("venue_city",p).order("event_date",{ascending:!0}).limit(50);v.push(R)}if(x.length>0){const R=P.from("events").select("*").gte("event_date",new Date().toISOString()).overlaps("genres",x).order("event_date",{ascending:!0}).limit(50);v.push(R)}if(v.length>0)try{(yield Promise.all(v)).forEach((F,D)=>{let B=[];Array.isArray(F)?B=F:F&&typeof F=="object"&&"data"in F&&(B=F.data||[]),B.forEach(U=>{U&&U.id&&!_.has(U.id)&&(_.add(U.id),w.push(U))})})}catch(R){console.error("Error fetching scene events:",R)}const b=w.sort((R,F)=>new Date(R.event_date).getTime()-new Date(F.event_date).getTime()).slice(0,20),N=(b||[]).map(R=>R.id);let S=P.from("reviews").select("user_id, event_id").eq("is_draft",!1).eq("was_there",!0).limit(100);N.length>0?S=S.in("event_id",N):S=S.eq("event_id","00000000-0000-0000-0000-000000000000");const{data:k}=yield S,O=[...new Set((k||[]).map(R=>R.user_id))],{data:A}=yield P.from("users").select("user_id, name, avatar_url").in("user_id",O.length>0?O:[""]),T=new Map,$=new Map((A||[]).map(R=>[R.user_id,R]));return(k||[]).forEach(R=>{const F=R.user_id,D=$.get(F);if(F&&D){const B=T.get(F)||{user_id:F,name:D.name||"User",avatar_url:D.avatar_url,review_count:0};B.review_count+=1,T.set(F,B)}}),W(M({},n),{participants:g,participating_artists:h,participating_venues:f,participating_cities:p,participating_genres:x,userProgress:a||void 0,upcomingEvents:b||[],activeReviewers:Array.from(T.values()).sort((R,F)=>F.review_count-R.review_count).slice(0,10)})}catch(n){return console.error("Error getting scene details:",n),null}})}static getSceneEvents(t,r=20){return E(this,null,function*(){try{const n=yield this.getSceneDetails(t);return n?n.upcomingEvents.slice(0,r):[]}catch(n){return console.error("Error getting scene events:",n),[]}})}static getSceneReviewers(t){return E(this,null,function*(){try{const r=yield this.getSceneDetails(t);return r?r.activeReviewers:[]}catch(r){return console.error("Error getting scene reviewers:",r),[]}})}}const pLe=({isOpen:e,onClose:t,artistId:r,artistName:n,currentUserId:i})=>{const a=ci(),[o,l]=y.useState(null),[c,d]=y.useState(0),[u,h]=y.useState(0),[f,p]=y.useState(0),[x,g]=y.useState(null),[v,_]=y.useState(0),[w,b]=y.useState(!0);y.useEffect(()=>{e&&N()},[e,r,n]);const N=()=>E(void 0,null,function*(){var S;try{b(!0);const{data:k}=yield P.from("artists").select("id, name, image_url").eq("id",r).maybeSingle();k!=null&&k.image_url&&l(k.image_url);const{data:O}=yield P.from("events").select("id, event_date, images").eq("artist_id",r);if(O){d(O.length);const T=new Date,$=O.filter(R=>new Date(R.event_date)>=T).length;if(h($),p(O.length-$),!o){const R=O.find(F=>F.images&&Array.isArray(F.images)&&F.images.length>0);if(R!=null&&R.images){const F=(S=R.images.find(D=>D==null?void 0:D.url))==null?void 0:S.url;F&&l(F)}}}const A=(O==null?void 0:O.map(T=>T.id))||[];if(A.length>0){const{data:T}=yield P.from("reviews").select("rating").in("event_id",A).eq("is_public",!0).eq("is_draft",!1);if(T&&T.length>0){const $=T.reduce((R,F)=>R+(F.rating||0),0)/T.length;g($),_(T.length)}}}catch(k){console.error("Error loading artist data:",k)}finally{b(!1)}});return e?s.jsxs("div",{className:"fixed inset-0 z-50 bg-[#fcfcfc] overflow-y-auto overflow-x-hidden w-full max-w-full",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},children:[s.jsx("div",{className:"bg-[#fcfcfc] border-b border-gray-200 w-full max-w-full",children:s.jsxs("div",{className:"px-4 py-3 flex items-center justify-between gap-2",children:[s.jsx("h1",{className:"text-lg font-bold flex-1 pr-2 break-words min-w-0",children:n}),s.jsx("button",{onClick:t,className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",children:s.jsx(pr,{className:"w-5 h-5"})})]})}),s.jsx("div",{className:"px-4 py-4 w-full max-w-full overflow-x-hidden",children:w?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start gap-3 w-full",children:[o?s.jsx("img",{src:o,alt:n,className:"w-16 h-16 rounded-full object-cover flex-shrink-0"}):s.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center flex-shrink-0",children:s.jsx(Ct,{className:"w-8 h-8 text-muted-foreground"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-lg font-bold mb-2 break-words",children:n}),x!==null&&s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"flex items-center",children:Array.from({length:5}).map((S,k)=>s.jsx(Jt,{className:`w-4 h-4 ${k<Math.floor(x)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},k))}),s.jsx("span",{className:"text-sm font-medium",children:x.toFixed(1)}),v>0&&s.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",v," ",v===1?"review":"reviews",")"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-3 flex-wrap",children:[s.jsx(Tv,{artistName:n,artistId:r,userId:i}),s.jsx(oe,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>{a(`/artist/${encodeURIComponent(n)}`),t()},children:"View All Events"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 w-full",children:[s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:c}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Events"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:u}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Upcoming"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:f}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Past"})]})]}),v>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-4",children:"Reviews"}),s.jsx(YE,{artistName:n,artistId:r})]}),s.jsx(oe,{variant:"outline",className:"w-full",onClick:()=>{a(`/artist/${encodeURIComponent(n)}`),t()},children:"View Full Artist Page"})]})})]}):null},gLe=({isOpen:e,onClose:t,venueId:r,venueName:n,currentUserId:i})=>{const a=ci(),[o,l]=y.useState(null),[c,d]=y.useState(null),[u,h]=y.useState(null),[f,p]=y.useState(null),[x,g]=y.useState(0),[v,_]=y.useState(0),[w,b]=y.useState(0),[N,S]=y.useState(null),[k,O]=y.useState(0),[A,T]=y.useState(!0);y.useEffect(()=>{e&&$()},[e,r,n]);const $=()=>E(void 0,null,function*(){try{T(!0);const{data:R,error:F}=yield P.from("events").select("id, event_date, venue_city, venue_state, latitude, longitude").eq("venue_id",r).limit(100);F&&console.warn("Error fetching venue events:",F);try{const{data:B}=yield P.from("venues").select("id, name, state, latitude, longitude, street_address, zip, country").eq("id",r).maybeSingle();B&&(B.state&&!c&&d(B.state),B.latitude&&!u&&h(Number(B.latitude)),B.longitude&&!f&&p(Number(B.longitude)))}catch(B){console.warn("Could not fetch venue details (non-critical):",B)}if(R&&R.length>0){g(R.length);const B=new Date,U=R.filter(Y=>new Date(Y.event_date)>=B).length;_(U),b(R.length-U);const V=R[0];V.venue_city&&l(V.venue_city),V.venue_state&&d(V.venue_state),V.latitude&&h(Number(V.latitude)),V.longitude&&p(Number(V.longitude))}if(R&&R.length>0){g(R.length);const B=new Date,U=R.filter(V=>new Date(V.event_date)>=B).length;if(_(U),b(R.length-U),!o||!c){const V=R[0];V.venue_city&&!o&&l(V.venue_city),V.venue_state&&!c&&d(V.venue_state),V.latitude&&!u&&h(Number(V.latitude)),V.longitude&&!f&&p(Number(V.longitude))}}const D=(R==null?void 0:R.map(B=>B.id))||[];if(D.length>0){const{data:B}=yield P.from("reviews").select("venue_rating, rating").in("event_id",D).eq("is_public",!0).eq("is_draft",!1);if(B&&B.length>0){const U=B.map(V=>V.venue_rating||V.rating).filter(V=>typeof V=="number"&&!isNaN(V)&&V>0);if(U.length>0){const V=U.reduce((Y,z)=>Y+z,0)/U.length;S(V)}else S(null);O(U.length)}}}catch(R){console.error("Error loading venue data:",R)}finally{T(!1)}});return e?s.jsxs("div",{className:"fixed inset-0 z-50 bg-[#fcfcfc] overflow-y-auto overflow-x-hidden w-full max-w-full",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},children:[s.jsx("div",{className:"bg-[#fcfcfc] border-b border-gray-200 w-full max-w-full",children:s.jsxs("div",{className:"px-4 py-3 flex items-center justify-between gap-2",children:[s.jsx("h1",{className:"text-lg font-bold flex-1 pr-2 break-words min-w-0",children:n}),s.jsx("button",{onClick:t,className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",children:s.jsx(pr,{className:"w-5 h-5"})})]})}),s.jsx("div",{className:"px-4 py-4 w-full max-w-full overflow-x-hidden",children:A?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start gap-3 w-full",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center flex-shrink-0",children:s.jsx(Xt,{className:"w-8 h-8 text-muted-foreground"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-lg font-bold mb-2 break-words",children:n}),(o||c)&&s.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground mb-2",children:[s.jsx(Xt,{className:"w-4 h-4"}),s.jsx("span",{children:[o,c].filter(Boolean).join(", ")})]}),N!==null&&s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"flex items-center",children:Array.from({length:5}).map((R,F)=>s.jsx(Jt,{className:`w-4 h-4 ${F<Math.floor(N)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},F))}),s.jsx("span",{className:"text-sm font-medium",children:N.toFixed(1)}),k>0&&s.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",k," ",k===1?"review":"reviews",")"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-3 flex-wrap",children:[s.jsx(Xw,{venueName:n,venueCity:o||void 0,venueState:c||void 0,userId:i}),s.jsx(oe,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>{a(`/venue/${encodeURIComponent(n)}`),t()},children:"View All Events"})]})]})]}),u&&f&&s.jsx("div",{className:"h-64 rounded-lg overflow-hidden border",children:s.jsx(XE,{center:[u,f],zoom:15,events:[{id:r,jambase_event_id:r,title:n,artist_name:n,artist_id:"",venue_name:n,venue_id:r,event_date:new Date().toISOString(),latitude:u,longitude:f}],onEventClick:()=>{}})}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 w-full",children:[s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:x}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Events"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:v}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Upcoming"})]}),s.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:w}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"Past"})]})]}),k>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-4",children:"Reviews"}),s.jsx(YE,{artistName:"",venueName:n,venueId:r})]}),s.jsx(oe,{variant:"outline",className:"w-full",onClick:()=>{a(`/venue/${encodeURIComponent(n)}`),t()},children:"View Full Venue Page"})]})})]}):null},vLe=({sceneId:e,userId:t,onBack:r,onNavigateToProfile:n,onNavigateToChat:i})=>{var pe,Ae,qe,Fe;const a=ci(),[o,l]=y.useState(null),[c,d]=y.useState(!0),[u,h]=y.useState(null),[f,p]=y.useState(!1),[x,g]=y.useState(!1),[v,_]=y.useState(new Set),[w,b]=y.useState(new Set),[N,S]=y.useState(new Map),[k,O]=y.useState(new Map),[A,T]=y.useState(!1),[$,R]=y.useState(!1),[F,D]=y.useState(null),[B,U]=y.useState(""),[V,Y]=y.useState(null),[z,K]=y.useState("");y.useEffect(()=>{ue(),Z()},[e,t]),y.useEffect(()=>{o&&(G(),X(),te())},[o,t]);const Z=()=>E(void 0,null,function*(){try{const{data:ve}=yield P.from("user_event_relationships").select("event_id").eq("user_id",t).eq("relationship_type","interested");ve&&_(new Set(ve.map(rt=>rt.event_id)))}catch(ve){console.error("Error loading interested events:",ve)}}),G=()=>E(void 0,null,function*(){if(o!=null&&o.participants)try{const ve=o.participants.filter(ut=>ut.participant_type==="artist"&&ut.artist_id).map(ut=>ut.artist_id),rt=o.participants.filter(ut=>ut.participant_type==="venue"&&ut.venue_id).map(ut=>ut.venue_id),Ve=new Set;if(ve.length>0){const ut=new Set(ve),{data:Ze}=yield P.from("passport_entries").select("entity_id, entity_uuid").eq("user_id",t).eq("type","artist").in("entity_uuid",ve),qt=new Map;yield Promise.all(ve.map(Ne=>E(void 0,null,function*(){const{data:Oe}=yield P.rpc("get_external_id",{p_entity_uuid:Ne,p_source:"jambase",p_entity_type:"artist"});Oe&&qt.set(Ne,Oe)})));const lr=Array.from(qt.values()),Ge=new Set;lr.forEach(Ne=>{Ge.add(Ne),Ge.add(`jambase:${Ne}`)});let Le=[];if(lr.length>0){const{data:Ne}=yield P.from("passport_entries").select("entity_id, entity_uuid").eq("user_id",t).eq("type","artist").is("entity_uuid",null);Le=(Ne||[]).filter(Oe=>{if(!Oe.entity_id)return!1;const ce=Oe.entity_id.replace(/^jambase:/,"");return Ge.has(Oe.entity_id)||Ge.has(ce)})}[...Ze||[],...Le].forEach(Ne=>{var Oe;if(Ne.entity_uuid&&ut.has(Ne.entity_uuid))Ve.add(`artist:${Ne.entity_uuid}`);else if(Ne.entity_id){const ce=Ne.entity_id.replace(/^jambase:/,""),Ee=(Oe=Array.from(qt.entries()).find(([Qe,vt])=>vt===ce||`jambase:${vt}`===Ne.entity_id))==null?void 0:Oe[0];Ee&&Ve.add(`artist:${Ee}`)}})}if(rt.length>0){const ut=new Set(rt),{data:Ze}=yield P.from("passport_entries").select("entity_id, entity_uuid").eq("user_id",t).eq("type","venue").in("entity_uuid",rt),qt=new Map;yield Promise.all(rt.map(Ne=>E(void 0,null,function*(){const{data:Oe}=yield P.rpc("get_external_id",{p_entity_uuid:Ne,p_source:"jambase",p_entity_type:"venue"});Oe&&qt.set(Ne,Oe)})));const lr=Array.from(qt.values()),Ge=new Set;lr.forEach(Ne=>{Ge.add(Ne),Ge.add(`jambase:${Ne}`)});let Le=[];if(lr.length>0){const{data:Ne}=yield P.from("passport_entries").select("entity_id, entity_uuid").eq("user_id",t).eq("type","venue").is("entity_uuid",null);Le=(Ne||[]).filter(Oe=>{if(!Oe.entity_id)return!1;const ce=Oe.entity_id.replace(/^jambase:/,"");return Ge.has(Oe.entity_id)||Ge.has(ce)})}[...Ze||[],...Le].forEach(Ne=>{var Oe;if(Ne.entity_uuid&&ut.has(Ne.entity_uuid))Ve.add(`venue:${Ne.entity_uuid}`);else if(Ne.entity_id){const ce=Ne.entity_id.replace(/^jambase:/,""),Ee=(Oe=Array.from(qt.entries()).find(([Qe,vt])=>vt===ce||`jambase:${vt}`===Ne.entity_id))==null?void 0:Oe[0];Ee&&Ve.add(`venue:${Ee}`)}})}const lt=o.participants.filter(ut=>ut.participant_type==="city"&&ut.text_value).map(ut=>ut.text_value);if(lt.length>0){const{data:ut}=yield P.from("passport_entries").select("entity_name").eq("user_id",t).eq("type","city").in("entity_name",lt);ut==null||ut.forEach(Ze=>Ve.add(`city:${Ze.entity_name}`))}b(Ve)}catch(ve){console.error("Error loading participant experience:",ve)}}),X=()=>E(void 0,null,function*(){if(!(o!=null&&o.participants))return;const ve=new Map,rt=new Date().toISOString();try{yield Promise.all(o.participants.map(Ve=>E(void 0,null,function*(){let lt=0;const ut=`${Ve.participant_type}:${Ve.artist_id||Ve.venue_id||Ve.text_value}`;try{if(Ve.participant_type==="artist"&&Ve.artist_id){const{count:Ze}=yield P.from("events").select("id",{count:"exact",head:!0}).gte("event_date",rt).eq("artist_id",Ve.artist_id);lt=Ze||0}else if(Ve.participant_type==="venue"&&Ve.venue_id){const{count:Ze}=yield P.from("events").select("id",{count:"exact",head:!0}).gte("event_date",rt).eq("venue_id",Ve.venue_id);lt=Ze||0}else if(Ve.participant_type==="city"&&Ve.text_value){const{count:Ze}=yield P.from("events").select("id",{count:"exact",head:!0}).gte("event_date",rt).eq("venue_city",Ve.text_value);lt=Ze||0}ve.set(ut,lt)}catch(Ze){console.error(`Error loading event count for ${ut}:`,Ze),ve.set(ut,0)}}))),S(ve)}catch(Ve){console.error("Error loading participant event counts:",Ve)}}),te=()=>E(void 0,null,function*(){if(!(o!=null&&o.participants))return;const ve=new Map;try{const rt=o.participants.filter(lt=>lt.participant_type==="artist"&&lt.artist_id).map(lt=>lt.artist_id);if(rt.length>0){const{data:lt}=yield P.from("artists").select("id, image_url").in("id",rt);lt==null||lt.forEach(ut=>{ut.image_url&&ve.set(`artist:${ut.id}`,ut.image_url)})}const Ve=o.participants.filter(lt=>lt.participant_type==="venue"&&lt.venue_id).map(lt=>lt.venue_id);if(Ve.length>0){const{data:lt}=yield P.from("venues").select("id, image_url").in("id",Ve);lt==null||lt.forEach(ut=>{ut.image_url&&ve.set(`venue:${ut.id}`,ut.image_url)})}O(ve)}catch(rt){console.error("Error loading participant images:",rt)}}),se=ve=>{ve.type==="artist"&&ve.participantId?a(`/artist/${ve.participantId}`):ve.type==="venue"&&ve.participantId?a(`/venue/${ve.participantId}`):ve.type==="artist"&&ve.name?a(`/artist/${encodeURIComponent(ve.name)}`):ve.type==="venue"&&ve.name&&a(`/venue/${encodeURIComponent(ve.name)}`)},ue=()=>E(void 0,null,function*(){d(!0);try{const ve=yield uY.getSceneDetails(e,t);l(ve)}catch(ve){console.error("Error loading scene details:",ve)}finally{d(!1)}}),ye=ve=>E(void 0,null,function*(){try{const{data:rt}=yield P.from("events").select("*").eq("id",ve.id).single();if(rt){h(rt);const Ve=yield Hn.isUserInterested(t,rt.id);g(Ve),p(!0)}else h(ve),g(v.has(ve.id||"")),p(!0)}catch(rt){console.error("Error fetching event details:",rt),h(ve),g(v.has(ve.id||"")),p(!0)}}),ne=(ve,rt)=>E(void 0,null,function*(){try{yield Hn.setEventInterest(t,ve,rt),_(Ve=>{const lt=new Set(Ve);return rt?lt.add(ve):lt.delete(ve),lt}),g(rt)}catch(Ve){console.error("Error toggling interest:",Ve)}});if(c)return s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx(er,{className:"w-6 h-6 animate-spin text-muted-foreground"})});if(!o)return s.jsx("div",{className:"min-h-screen bg-background",children:s.jsxs("div",{className:"max-w-6xl mx-auto px-4 pt-4 pb-6",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:r,className:"mb-4",children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back to Discover"]}),s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:"Scene not found"})})]})});const xe=o.userProgress,ge=xe&&xe.discovery_state!=="undiscovered",ie=((pe=o.participants)==null?void 0:pe.filter(ve=>ve.participant_type==="venue"&&ve.venue_name))||[],ee=((Ae=o.participants)==null?void 0:Ae.filter(ve=>ve.participant_type==="artist"&&ve.artist_name))||[],H=((qe=o.participants)==null?void 0:qe.filter(ve=>ve.participant_type==="genre"&&ve.text_value))||[],le=((Fe=o.participants)==null?void 0:Fe.filter(ve=>ve.participant_type==="city"&&ve.text_value))||[],Se=ee.length,ae=ie.length,fe=le.length,he=H.length;return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/20",children:[s.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 pt-4 pb-12",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:r,className:"mb-6",children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back to Discover"]}),s.jsxs("div",{className:"mb-8",children:[(o.image_url||o.scene_url)&&s.jsx("div",{className:"w-full h-80 rounded-2xl overflow-hidden mb-6 shadow-lg",children:s.jsx("img",{src:o.image_url||o.scene_url||"",alt:o.name,className:"w-full h-full object-cover"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h1",{className:"text-4xl font-bold tracking-tight",children:o.name}),o.short_description&&s.jsx("p",{className:"text-xl text-muted-foreground font-medium",children:o.short_description}),o.description&&s.jsx("p",{className:"text-base text-muted-foreground leading-relaxed max-w-3xl",children:o.description})]})]}),ge&&s.jsx(He,{className:"mb-8 border-2 border-synth-pink/20 shadow-lg",children:s.jsxs(st,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"p-2 rounded-lg bg-synth-pink/10",children:s.jsx(Sn,{className:"w-5 h-5 text-synth-pink"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Your Progress"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Track your journey through this scene"})]}),s.jsx(Be,{variant:xe.discovery_state==="completed"?"default":"secondary",className:"text-sm px-3 py-1",children:xe.discovery_state.replace("_"," ")})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Overall Progress"}),s.jsxs("span",{className:"text-lg font-bold text-synth-pink",children:[xe.progress_percentage,"%"]})]}),s.jsx("div",{className:"w-full bg-muted rounded-full h-3 overflow-hidden",children:s.jsx("div",{className:"bg-gradient-to-r from-synth-pink to-purple-500 h-3 rounded-full transition-all duration-500",style:{width:`${xe.progress_percentage}%`}})})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[Se>0&&s.jsxs("div",{className:"p-4 rounded-lg bg-muted/50 border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ct,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{className:"text-sm font-medium",children:"Artists"})]}),s.jsxs("span",{className:"text-sm font-bold",children:[xe.artists_experienced,"/",Se]})]}),s.jsx("div",{className:"w-full bg-background rounded-full h-2",children:s.jsx("div",{className:"bg-synth-pink h-2 rounded-full transition-all",style:{width:`${Se>0?xe.artists_experienced/Se*100:0}%`}})})]}),ae>0&&s.jsxs("div",{className:"p-4 rounded-lg bg-muted/50 border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{className:"text-sm font-medium",children:"Venues"})]}),s.jsxs("span",{className:"text-sm font-bold",children:[xe.venues_experienced,"/",ae]})]}),s.jsx("div",{className:"w-full bg-background rounded-full h-2",children:s.jsx("div",{className:"bg-synth-pink h-2 rounded-full transition-all",style:{width:`${ae>0?xe.venues_experienced/ae*100:0}%`}})})]}),fe>0&&s.jsxs("div",{className:"p-4 rounded-lg bg-muted/50 border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{className:"text-sm font-medium",children:"Cities"})]}),s.jsxs("span",{className:"text-sm font-bold",children:[xe.cities_experienced,"/",fe]})]}),s.jsx("div",{className:"w-full bg-background rounded-full h-2",children:s.jsx("div",{className:"bg-synth-pink h-2 rounded-full transition-all",style:{width:`${fe>0?xe.cities_experienced/fe*100:0}%`}})})]}),he>0&&s.jsxs("div",{className:"p-4 rounded-lg bg-muted/50 border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(oa,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{className:"text-sm font-medium",children:"Genres"})]}),s.jsxs("span",{className:"text-sm font-bold",children:[xe.genres_experienced,"/",he]})]}),s.jsx("div",{className:"w-full bg-background rounded-full h-2",children:s.jsx("div",{className:"bg-synth-pink h-2 rounded-full transition-all",style:{width:`${he>0?xe.genres_experienced/he*100:0}%`}})})]})]}),xe.events_experienced>0&&s.jsxs("div",{className:"mt-4 p-3 rounded-lg bg-synth-pink/10 border border-synth-pink/20 flex items-center gap-3",children:[s.jsx(Fx,{className:"w-5 h-5 text-synth-pink flex-shrink-0"}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium",children:[s.jsx("span",{className:"text-synth-pink font-bold",children:xe.events_experienced})," events attended"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Keep exploring to complete this scene!"})]})]})]})}),s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[s.jsx(oa,{className:"w-5 h-5 text-synth-pink"}),s.jsx("h2",{className:"text-2xl font-bold",children:"Participants"})]}),s.jsxs("div",{className:"space-y-3",children:[ie.map(ve=>{const rt=`venue:${ve.venue_id}`,Ve=w.has(rt),lt=N.get(rt)||0,ut=k.get(rt);return s.jsx(He,{className:`cursor-pointer transition-all hover:shadow-lg border-2 ${Ve?"border-green-500 bg-green-50/50 hover:bg-green-50":"border-red-500 bg-red-50/50 hover:bg-red-50"}`,onClick:()=>se({type:"venue",name:ve.venue_name||"",id:ve.id,participantId:ve.venue_id}),children:s.jsx(st,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:ut?s.jsx("img",{src:ut,alt:ve.venue_name,className:"w-16 h-16 rounded-lg object-cover"}):s.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Xt,{className:"w-8 h-8 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"text-lg font-semibold truncate",children:ve.venue_name}),Ve&&s.jsx(Fx,{className:"w-5 h-5 text-green-600 flex-shrink-0"})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Et,{className:"w-4 h-4"}),lt," ",lt===1?"upcoming event":"upcoming events"]}),s.jsx(Be,{variant:Ve?"default":"destructive",className:"text-xs",children:Ve?"Experienced":"Not Experienced"})]})]})]})})},ve.id)}),ee.map(ve=>{const rt=`artist:${ve.artist_id}`,Ve=w.has(rt),lt=N.get(rt)||0,ut=k.get(rt);return s.jsx(He,{className:`cursor-pointer transition-all hover:shadow-lg border-2 ${Ve?"border-green-500 bg-green-50/50 hover:bg-green-50":"border-red-500 bg-red-50/50 hover:bg-red-50"}`,onClick:()=>se({type:"artist",name:ve.artist_name||"",id:ve.id,participantId:ve.artist_id}),children:s.jsx(st,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:ut?s.jsx("img",{src:ut,alt:ve.artist_name,className:"w-16 h-16 rounded-lg object-cover"}):s.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Ct,{className:"w-8 h-8 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"text-lg font-semibold truncate",children:ve.artist_name}),Ve&&s.jsx(Fx,{className:"w-5 h-5 text-green-600 flex-shrink-0"})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Et,{className:"w-4 h-4"}),lt," ",lt===1?"upcoming event":"upcoming events"]}),s.jsx(Be,{variant:Ve?"default":"destructive",className:"text-xs",children:Ve?"Experienced":"Not Experienced"})]})]})]})})},ve.id)}),le.map(ve=>{const rt=`city:${ve.text_value}`,Ve=w.has(rt),lt=N.get(rt)||0;return s.jsx(He,{className:`cursor-pointer transition-all hover:shadow-lg border-2 ${Ve?"border-green-500 bg-green-50/50 hover:bg-green-50":"border-red-500 bg-red-50/50 hover:bg-red-50"}`,onClick:()=>se({type:"city",name:ve.text_value||"",id:ve.id,textValue:ve.text_value}),children:s.jsx(st,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(Xt,{className:"w-8 h-8 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"text-lg font-semibold truncate",children:ve.text_value}),Ve&&s.jsx(Fx,{className:"w-5 h-5 text-green-600 flex-shrink-0"})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Et,{className:"w-4 h-4"}),lt," ",lt===1?"upcoming event":"upcoming events"]}),s.jsx(Be,{variant:Ve?"default":"destructive",className:"text-xs",children:Ve?"Experienced":"Not Experienced"})]})]})]})})},ve.id)}),H.map(ve=>{const rt=`genre:${ve.text_value}`,Ve=N.get(rt)||0;return s.jsx(He,{className:"cursor-pointer transition-all hover:shadow-lg border-2 border-muted",onClick:()=>se({type:"genre",name:ve.text_value||"",id:ve.id,textValue:ve.text_value}),children:s.jsx(st,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center",children:s.jsx(oa,{className:"w-8 h-8 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"flex items-center gap-2 mb-1",children:s.jsx("h3",{className:"text-lg font-semibold truncate",children:ve.text_value})}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Et,{className:"w-4 h-4"}),Ve," ",Ve===1?"upcoming event":"upcoming events"]}),s.jsx(Be,{variant:"secondary",className:"text-xs",children:"Genre"})]})]})]})})},ve.id)})]})]}),o.upcomingEvents.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Et,{className:"w-5 h-5 text-synth-pink"}),s.jsxs("h2",{className:"text-2xl font-bold",children:["Upcoming Events (",o.upcomingEvents.length,")"]})]}),s.jsx(VC,{title:"",showTitle:!1,items:o.upcomingEvents.map(ve=>s.jsx(zC,{event:ve,onClick:()=>ye(ve)},ve.id)),emptyMessage:"No upcoming events"})]}),o.activeReviewers.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Ar,{className:"w-5 h-5 text-synth-pink"}),s.jsxs("h2",{className:"text-2xl font-bold",children:["Active Reviewers (",o.activeReviewers.length,")"]})]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:o.activeReviewers.map(ve=>s.jsx(He,{className:"cursor-pointer hover:shadow-md transition-all hover:border-synth-pink/50",onClick:()=>n==null?void 0:n(ve.user_id),children:s.jsx(st,{className:"p-4",children:s.jsxs("div",{className:"flex flex-col items-center text-center space-y-2",children:[s.jsxs(Vr,{className:"w-12 h-12",children:[s.jsx(Qr,{src:ve.avatar_url||void 0}),s.jsx(qr,{className:"bg-synth-pink/10 text-synth-pink",children:ve.name.charAt(0).toUpperCase()})]}),s.jsxs("div",{className:"w-full",children:[s.jsx("p",{className:"text-sm font-medium truncate",children:ve.name}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[ve.review_count," ",ve.review_count===1?"review":"reviews"]})]})]})})},ve.user_id))})]})]}),f&&u&&s.jsx(Cc,{isOpen:f,onClose:()=>{p(!1),h(null)},event:u,currentUserId:t,isInterested:x,onInterestToggle:ne,onReview:()=>{console.log("Review event:",u.id)},onNavigateToProfile:n,onNavigateToChat:i}),F&&s.jsx(pLe,{isOpen:A,onClose:()=>{T(!1),D(null),U("")},artistId:F,artistName:B,currentUserId:t}),V&&s.jsx(gLe,{isOpen:$,onClose:()=>{R(!1),Y(null),K("")},venueId:V,venueName:z,currentUserId:t})]})},xLe=({currentUserId:e,onNavigateToProfile:t,onNavigateToChat:r})=>{const[n,i]=y.useState([]),[a,o]=y.useState(!0),[l,c]=y.useState(null);y.useEffect(()=>{d()},[e]);const d=()=>E(void 0,null,function*(){o(!0);try{const f=yield uY.getScenes(10,e);i(f)}catch(f){console.error("Error loading scenes:",f),i([])}finally{o(!1)}}),u=f=>{c(f)},h=()=>{c(null)};return l?s.jsx(vLe,{sceneId:l,userId:e,onBack:h,onNavigateToProfile:t,onNavigateToChat:r}):n.length===0&&!a?null:s.jsx(VC,{title:"Scenes & Signals",description:"Music scenes defined by genre overlap, venue clusters, and co-attendance patterns",items:n.map(f=>s.jsx(mLe,{scene:f,onClick:()=>u(f.id)},f.id)),loading:a,emptyMessage:"No scenes found",itemClassName:"w-[320px]"})};class _N{static getArtistTourEvents(t){return E(this,null,function*(){try{console.log(` [TOUR_TRACKER] Fetching tour events for artist ID: ${t}`);const{data:r,error:n}=yield P.from("artists").select("id, name, identifier").eq("id",t).single();if(n||!r)return console.error(" [TOUR_TRACKER] Artist not found:",n),[];console.log(` [TOUR_TRACKER] Found artist: ${r.name} (UUID: ${r.id}, Identifier: ${r.identifier})`);const{data:i,error:a}=yield P.from("events").select("*").eq("artist_id",r.id).gte("event_date",new Date().toISOString()).not("latitude","is",null).not("longitude","is",null).order("event_date",{ascending:!0});if(a)throw console.error(" [TOUR_TRACKER] Error fetching events:",a),a;return console.log(` [TOUR_TRACKER] Found ${(i==null?void 0:i.length)||0} upcoming events for ${r.name}`),(i||[]).map(o=>W(M({},o),{latitude:Number(o.latitude),longitude:Number(o.longitude),venue_city:o.venue_city||"",venue_state:o.venue_state||void 0}))}catch(r){return console.error("Error fetching artist tour events:",r),[]}})}static calculateTourRoute(t){const r=[...t].sort((i,a)=>{const o=new Date(i.event_date).getTime(),l=new Date(a.event_date).getTime();return o-l}),n=[];for(let i=0;i<r.length-1;i++){const a=r[i],o=r[i+1];a.latitude&&a.longitude&&o.latitude&&o.longitude&&n.push({from:{lat:a.latitude,lng:a.longitude,city:`${a.venue_city}${a.venue_state?`, ${a.venue_state}`:""}`},to:{lat:o.latitude,lng:o.longitude,city:`${o.venue_city}${o.venue_state?`, ${o.venue_state}`:""}`}})}return{events:r,route:n}}static getArtistGroupChats(t,r){return E(this,null,function*(){try{const n=[],{data:i}=yield P.from("artists").select("id, name, identifier").eq("id",t).single();if(!i)return console.warn(` [TOUR_TRACKER] Artist not found for ID: ${t}`),[];const a=i.name,{data:o,error:l}=yield P.from("chats").select("id, chat_name, users").ilike("chat_name",`%${a}%`).eq("is_group_chat",!0);if(!l&&o)for(const d of o){const u=Array.isArray(d.users)?d.users.length:0;n.push({id:d.id,name:d.chat_name||"Unnamed Chat",chat_id:d.id,member_count:u})}const{data:c}=yield P.from("events").select("id, title").eq("artist_id",i.id).gte("event_date",new Date().toISOString()).limit(10);if(c)for(const d of c){const{data:u}=yield P.from("chats").select("id, chat_name, users").ilike("chat_name",`%${d.title}%`).eq("is_group_chat",!0);if(u){for(const h of u)if(!n.find(f=>f.id===h.id)){const f=Array.isArray(h.users)?h.users.length:0;n.push({id:h.id,name:h.chat_name||"Unnamed Chat",chat_id:h.id,event_id:d.id,member_count:f})}}}return n}catch(n){return console.error("Error fetching artist group chats:",n),[]}})}}class yLe{constructor(){_r(this,"pendingRequests",new Map);_r(this,"REQUEST_TIMEOUT",3e4)}deduplicate(t,r){return E(this,null,function*(){this.cleanupExpiredRequests();const n=this.pendingRequests.get(t);if(n)return console.log(` Request deduplication: Reusing pending request for key: ${t}`),n.promise;console.log(` Request deduplication: Creating new request for key: ${t}`);const i=r().finally(()=>{this.pendingRequests.delete(t)});return this.pendingRequests.set(t,{promise:i,timestamp:Date.now()}),i})}cleanupExpiredRequests(){const t=Date.now();for(const[r,n]of this.pendingRequests.entries())t-n.timestamp>this.REQUEST_TIMEOUT&&(console.log(` Request deduplication: Cleaning up expired request for key: ${r}`),this.pendingRequests.delete(r))}clear(){console.log(` Request deduplication: Clearing ${this.pendingRequests.size} pending requests`),this.pendingRequests.clear()}getPendingCount(){return this.pendingRequests.size}}const _Le=new yLe,wLe={events:e=>`events_${e.userId||"anonymous"}_${e.limit||20}_${e.offset||0}`,promotions:e=>`promotions_${e.userId||"anonymous"}_${e.tier||"all"}_${e.limit||10}`,profile:e=>`profile_${e}`,reviews:e=>`reviews_${e.eventId||"all"}_${e.userId||"anonymous"}_${e.limit||20}`,friends:e=>`friends_${e}`,search:e=>`search_${e.query}_${e.type||"all"}_${e.limit||20}`,location:e=>`location_${e.lat}_${e.lng}_${e.radius||25}`},KO={basic:{name:"Basic",price:49.99,duration_days:7,features:["Homepage promotion","Search boost","Basic analytics","7-day duration"],color:"blue"},premium:{name:"Premium",price:149.99,duration_days:14,features:["Homepage featured section","Priority in search","Advanced analytics","Social media sharing","14-day duration"],color:"purple"},featured:{name:"Featured",price:499.99,duration_days:30,features:["Top homepage placement","Email newsletter feature","Premium badge","Full analytics suite","Dedicated support","30-day duration"],color:"gold"}};class bLe{static createPromotion(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.rpc("promote_event",{p_event_id:t.event_id,p_promotion_tier:t.promotion_tier,p_starts_at:t.starts_at,p_expires_at:t.expires_at,p_target_cities:t.target_cities||null,p_target_genres:t.target_genres||null});if(n)throw n;return r}catch(r){throw console.error("Error creating promotion:",r),r}})}static getUserPromotions(t){return E(this,null,function*(){const r=wLe.promotions({userId:t});return _Le.deduplicate(r,()=>E(this,null,function*(){try{const{data:{user:n},error:i}=yield P.auth.getUser();if(i||!n)throw new Error("User not authenticated");const a=t||n.id,{data:o,error:l}=yield P.from("event_promotions").select(`
            *,
            event:events(
              id,
              title,
              artist_name,
              venue_name,
              event_date,
              poster_image_url
            )
          `).eq("promoted_by_user_id",a).order("created_at",{ascending:!1});if(l)throw l;return o||[]}catch(n){throw console.error("Error fetching user promotions:",n),n}}))})}static getActivePromotions(t,r=10){return E(this,null,function*(){try{let n=P.from("event_promotions").select(`
          *,
          event:events(*)
        `).eq("promotion_status","active").lte("starts_at",new Date().toISOString()).gte("expires_at",new Date().toISOString()).order("created_at",{ascending:!1}).limit(r);t&&(n=n.eq("promotion_tier",t));const{data:i,error:a}=yield n;if(a)throw a;return i||[]}catch(n){throw console.error("Error fetching active promotions:",n),n}})}static getPromotion(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("event_promotions").select(`
          *,
          event:events(*)
        `).eq("id",t).single();if(n)throw n;return r}catch(r){throw console.error("Error fetching promotion:",r),r}})}static getPendingPromotions(){return E(this,null,function*(){try{const{data:t,error:r}=yield P.from("event_promotions").select(`
          *,
          event:jambase_events(
            id,
            title,
            artist_name,
            venue_name,
            event_date,
            poster_image_url
          ),
          promoter:users!event_promotions_promoted_by_user_id_fkey(
            user_id,
            name,
            avatar_url,
            account_type
          )
        `).eq("promotion_status","pending").order("created_at",{ascending:!0});if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching pending promotions:",t),t}})}static reviewPromotion(t,r,n,i){return E(this,null,function*(){try{const{error:a}=yield P.rpc("review_event_promotion",{p_promotion_id:t,p_approved:r,p_admin_notes:n||null,p_rejection_reason:i||null});if(a)throw a}catch(a){throw console.error("Error reviewing promotion:",a),a}})}static cancelPromotion(t){return E(this,null,function*(){try{const{error:r}=yield P.from("event_promotions").update({promotion_status:"paused",updated_at:new Date().toISOString()}).eq("id",t);if(r)throw r}catch(r){throw console.error("Error canceling promotion:",r),r}})}static trackImpression(t){return E(this,null,function*(){try{const{error:r}=yield P.rpc("increment",{table_name:"event_promotions",row_id:t,column_name:"impressions"});if(r){const{data:n}=yield P.from("event_promotions").select("impressions").eq("id",t).single();n&&(yield P.from("event_promotions").update({impressions:(n.impressions||0)+1}).eq("id",t))}}catch(r){console.error("Error tracking impression:",r)}})}static trackClick(t){return E(this,null,function*(){try{const{data:r}=yield P.from("event_promotions").select("clicks").eq("id",t).single();r&&(yield P.from("event_promotions").update({clicks:(r.clicks||0)+1}).eq("id",t))}catch(r){console.error("Error tracking click:",r)}})}static trackConversion(t){return E(this,null,function*(){try{const{data:r}=yield P.from("event_promotions").select("conversions").eq("id",t).single();r&&(yield P.from("event_promotions").update({conversions:(r.conversions||0)+1}).eq("id",t))}catch(r){console.error("Error tracking conversion:",r)}})}static getPromotionAnalytics(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.from("event_promotions").select("impressions, clicks, conversions, price_paid").eq("id",t).single();if(n)throw n;const i=r.impressions>0?r.clicks/r.impressions*100:0,a=r.clicks>0?r.conversions/r.clicks*100:0,o=r.clicks>0?r.price_paid/r.clicks:0,l=r.conversions>0?r.price_paid/r.conversions:0;return W(M({},r),{ctr:i.toFixed(2),conversion_rate:a.toFixed(2),cost_per_click:o.toFixed(2),cost_per_conversion:l.toFixed(2)})}catch(r){throw console.error("Error fetching promotion analytics:",r),r}})}static getPromotionPricing(t){return KO[t].price}static getPromotionTierInfo(t){return KO[t]}static canPromoteEvent(t){return E(this,null,function*(){try{const{data:{user:r}}=yield P.auth.getUser();if(!r)return!1;const{data:n}=yield P.from("events").select("created_by_user_id").eq("id",t).single();return n?n.created_by_user_id===r.id:!1}catch(r){return console.error("Error checking promotion eligibility:",r),!1}})}}function jLe({promotionId:e,enabled:t=!0,threshold:r=1}){const n=y.useRef(null),i=y.useRef(null),a=y.useRef(!1),o=`promotion_impression_${e}`,l=y.useCallback(()=>E(this,null,function*(){if(!t||a.current)return;if(sessionStorage.getItem(o)){a.current=!0;return}try{yield bLe.trackImpression(e),sessionStorage.setItem(o,"true"),a.current=!0}catch(d){console.error("Error tracking promotion impression:",d)}}),[e,t,o]);return y.useEffect(()=>{if(!t||!n.current)return;const c=n.current;let d;const u=f=>{f[0].isIntersecting?i.current=Date.now():i.current=null};d=new IntersectionObserver(u,{threshold:.5,rootMargin:"0px"}),d.observe(c);const h=setInterval(()=>{i.current&&!a.current&&(Date.now()-i.current)/1e3>=r&&l()},500);return()=>{d.disconnect(),clearInterval(h)}},[t,r,l]),n}function NLe(e){return!e||e.trim()===""||e==="NULL"?"Venue TBD":e.trim()}function fY(e,t){const r=[];return e&&e.trim()!==""&&e!=="NULL"&&r.push(e.trim()),t&&t.trim()!==""&&t!=="NULL"&&r.push(t.trim()),r.length>0?r.join(", "):""}function SLe(e,t,r,n){const i=[];e&&e.trim()!==""&&e!=="NULL"&&i.push(e.trim());const a=fY(t,r);return a&&i.push(a),n&&n.trim()!==""&&n!=="NULL"&&i.push(n.trim()),i.length>0?i.join(", "):""}function hY({event:e,onInterestToggle:t,onReview:r,isInterested:n=!1,hasReviewed:i=!1,showInterestButton:a=!0,showReviewButton:o=!0,currentUserId:l,onOpenInterestedUsers:c,className:d,onClick:u}){const[h,f]=y.useState(!1),[p,x]=y.useState(null),[g,v]=y.useState(null),[_,w]=y.useState(!1),{toast:b}=jr(),N=jLe({promotionId:e.active_promotion_id||"",enabled:e.is_promoted&&!!e.active_promotion_id}),S=V=>new Date(V).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),k=V=>new Date(V).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),O=V=>V?new Date(V).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):null,A=new Date(e.event_date)<new Date,T=new Date(e.event_date)>=new Date,$=V=>E(this,null,function*(){if(V.stopPropagation(),!(!t||h)){f(!0);try{yield t(e.id,!n)}catch(Y){console.error("Error toggling interest:",Y)}finally{f(!1)}}}),R=V=>{V.stopPropagation(),r&&r(e.id)},F=NLe(e.venue_name),D=fY(e.venue_city,e.venue_state),B=SLe(e.venue_address,e.venue_city,e.venue_state,e.venue_zip);y.useEffect(()=>{E(this,null,function*(){try{const{count:Y,error:z}=yield P.from("user_jambase_events").select("*",{count:"exact",head:!0}).eq("jambase_event_id",e.id).neq("user_id",l||"");if(z)throw z;x(Y!=null?Y:0)}catch(Y){console.error("Error fetching interested count:",Y),x(null)}})},[e.id,l]),y.useEffect(()=>{E(this,null,function*(){var V,Y,z,K;try{if(e.images&&Array.isArray(e.images)&&e.images.length>0){const X=e.images.find(te=>te.url&&(te.ratio==="16_9"||te.width&&te.width>1e3))||e.images.find(te=>te.url);if(X!=null&&X.url){v(X.url);return}}const Z=yield P.from("reviews").select("photos").eq("event_id",e.id).not("photos","is",null).order("likes_count",{ascending:!1}).limit(1),G=Array.isArray(Z.data)&&((Y=(V=Z.data[0])==null?void 0:V.photos)==null?void 0:Y[0]);if(G){v(G);return}if(e.artist_name&&e.id){const X=yield P.from("reviews").select("photos").not("photos","is",null).eq("event_id",e.id).order("likes_count",{ascending:!1}).limit(1),te=Array.isArray(X.data)&&((K=(z=X.data[0])==null?void 0:z.photos)==null?void 0:K[0]);if(te){v(te);return}}}catch(Z){console.error("Error resolving event image:",Z)}v(null)})},[e.id,e.artist_id,e.artist_name,e.images]);const U=()=>{if(!e.ticket_urls||e.ticket_urls.length===0)return null;const V=["stubhub","vividseats","seatgeek","ticketmaster","axs"],Y=e.ticket_urls.map(z=>({url:z,l:z.toLowerCase()}));for(const z of V){const K=Y.find(Z=>Z.l.includes(z));if(K)return K.url}return e.ticket_urls[0]};return s.jsxs(He,{ref:N,className:ke("w-full transition-all duration-200 hover:shadow-lg",e.is_promoted&&"ring-2 ring-yellow-400/50 shadow-lg shadow-yellow-200/30 border-yellow-200/50",d),onClick:u,children:[g&&s.jsxs("div",{className:"h-48 w-full overflow-hidden rounded-t-lg relative",children:[s.jsx("img",{src:g,alt:e.title,className:"w-full h-full object-cover",loading:"lazy",onError:V=>{console.warn("Failed to load event image:",g),v(null)}}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/10 to-transparent pointer-events-none"})]}),s.jsx(xr,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx(Cr,{className:"text-lg leading-tight mb-2",children:e.title}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-2",children:[s.jsx(Et,{className:"w-4 h-4"}),s.jsx("span",{children:S(e.event_date)}),s.jsx("span",{children:""}),s.jsx(ai,{className:"w-4 h-4"}),s.jsx("span",{children:k(e.event_date)}),e.doors_time&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{children:["Doors: ",O(e.doors_time)]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[e.is_promoted&&e.promotion_tier&&s.jsx(eF,{promotionTier:e.promotion_tier}),A&&s.jsx(Be,{variant:"secondary",className:"text-xs",children:"Past Event"}),T&&s.jsx(Be,{variant:"default",className:"text-xs",children:"Upcoming"})]})]})}),s.jsxs(st,{className:"pt-0 space-y-4",children:[F&&s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Xt,{className:"w-4 h-4 text-muted-foreground mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"font-medium text-sm",children:F}),l&&e.venue_name&&e.venue_name!=="Venue TBD"&&s.jsx(Xw,{venueName:e.venue_name,venueCity:e.venue_city,venueState:e.venue_state,userId:l,variant:"ghost",size:"sm",showFollowerCount:!1,className:"h-6 text-xs"})]}),B&&s.jsx("div",{className:"text-sm text-muted-foreground",children:B}),!B&&D&&s.jsx("div",{className:"text-sm text-muted-foreground",children:D})]})]}),e.latitude!=null&&e.longitude!=null&&!Number.isNaN(Number(e.latitude))&&!Number.isNaN(Number(e.longitude))&&s.jsx("div",{className:"h-40 rounded-md overflow-hidden border border-gray-100",children:s.jsx(XE,{center:[Number(e.latitude),Number(e.longitude)],zoom:12,events:[e],onEventClick:()=>{}})}),e.description&&s.jsx("div",{className:"text-sm text-muted-foreground leading-relaxed",children:e.description.length>200?`${e.description.substring(0,200)}...`:e.description}),e.artist_name&&s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx(Be,{variant:"outline",className:"text-xs",children:e.artist_name})}),l&&s.jsx(Tv,{artistId:e.artist_id,artistName:e.artist_name,userId:l,variant:"ghost",size:"sm",showFollowerCount:!1,className:"h-7 text-xs"})]}),e.genres&&e.genres.length>0&&s.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.genres.slice(0,4).map((V,Y)=>s.jsx(Be,{variant:"secondary",className:"text-xs",children:V},Y)),e.genres.length>4&&s.jsxs(Be,{variant:"secondary",className:"text-xs",children:["+",e.genres.length-4," more"]})]}),e.tour_name&&s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Tour: "}),s.jsx("span",{className:"font-medium",children:e.tour_name})]}),e.price_range&&s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Price: "}),s.jsx("span",{className:"font-medium",children:bg(e.price_range)})]}),l&&s.jsx("div",{className:"flex items-center justify-start pt-2 pb-2 border-t border-gray-100",children:s.jsx(o1,{entityType:"event",entityId:e.id,entityName:e.title,currentUserId:l,onChatOpen:V=>{window.location.href=`/chats?chatId=${V}`}})}),s.jsxs("div",{className:"flex items-center justify-between pt-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[T&&a&&t&&s.jsxs(oe,{variant:n?"default":"outline",size:"sm",onClick:$,disabled:h,className:ke("transition-colors",n?"bg-red-500 hover:bg-red-600 text-white":"hover:bg-red-50 hover:text-red-600 hover:border-red-300"),children:[n?s.jsx(hs,{className:"w-4 h-4 mr-1 fill-current"}):s.jsx(UJ,{className:"w-4 h-4 mr-1"}),n?"Interested":"Interested?"]}),A&&o&&r&&s.jsxs(oe,{variant:i?"default":"outline",size:"sm",onClick:R,className:ke("transition-colors",i?"bg-yellow-500 hover:bg-yellow-600 text-white":"hover:bg-yellow-50 hover:text-yellow-600 hover:border-yellow-300"),children:[i?s.jsx(Jt,{className:"w-4 h-4 mr-1 fill-current"}):s.jsx(sQ,{className:"w-4 h-4 mr-1"}),i?"Reviewed":"I Was There"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(o4,{children:[s.jsx(l4,{asChild:!0,children:s.jsxs(oe,{variant:"ghost",size:"sm",onClick:V=>{V.stopPropagation()},className:"text-pink-600 hover:text-pink-700 hover:bg-pink-50",children:[s.jsx(Vu,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline ml-1",children:"Share"})]})}),s.jsxs(p1,{align:"end",className:"w-52 bg-white/95 backdrop-blur-sm border shadow-lg z-50",children:[l&&s.jsxs(jo,{onClick:V=>{V.stopPropagation(),w(!0)},className:"cursor-pointer bg-white hover:bg-gray-50",children:[s.jsx(Ar,{className:"w-4 h-4 mr-2"}),"Share with Synth Friends"]}),s.jsxs(jo,{onClick:V=>E(this,null,function*(){V.stopPropagation();try{const Y=yield I0.shareEvent(e.id,e.title,e.description||void 0);navigator.share?yield navigator.share({title:e.title,text:e.description||"Check out this event!",url:Y}):(yield navigator.clipboard.writeText(Y),b({title:"Link copied",description:Y}))}catch(Y){try{const z=yield I0.shareEvent(e.id,e.title,e.description||void 0);yield navigator.clipboard.writeText(z),b({title:"Link copied",description:z})}catch(z){b({title:"Error",description:"Failed to share",variant:"destructive"})}}}),className:"cursor-pointer bg-white hover:bg-gray-50",children:[s.jsx(No,{className:"w-4 h-4 mr-2"}),"Share"]}),s.jsxs(jo,{onClick:V=>E(this,null,function*(){V.stopPropagation();try{const Y=yield I0.shareEvent(e.id,e.title,e.description||void 0);yield navigator.clipboard.writeText(Y),b({title:"Link copied",description:Y})}catch(Y){b({title:"Error",description:"Failed to copy link",variant:"destructive"})}}),className:"cursor-pointer bg-white hover:bg-gray-50",children:[s.jsx(Vu,{className:"w-4 h-4 mr-2"}),"Copy Link"]})]})]}),e.ticket_urls&&e.ticket_urls.length>0&&s.jsx(oe,{variant:"ghost",size:"sm",asChild:!0,className:"text-blue-600 hover:text-blue-700",children:s.jsxs("a",{href:U()||e.ticket_urls[0],target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1",onClick:()=>{try{wn.click("ticket",e.id,{providerUrl:U()||e.ticket_urls[0]})}catch(V){}},children:[s.jsx(xc,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Tickets"}),s.jsx(aa,{className:"w-3 h-3"})]})})]})]}),s.jsxs("div",{className:"mt-3 flex items-center justify-between rounded-md border p-2",children:[s.jsx("div",{className:"text-sm text-muted-foreground",children:p===null?"Loading people going":`${p} others are interested`}),c&&s.jsx(oe,{size:"sm",variant:"outline",onClick:()=>c(e.id),children:"Meet people going"})]}),e.setlist&&s.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[s.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Setlist Preview:"}),s.jsx("div",{className:"text-sm",children:typeof e.setlist=="string"?e.setlist.substring(0,100)+"...":JSON.stringify(e.setlist).substring(0,100)+"..."})]})]}),l&&s.jsx(JE,{event:e,currentUserId:l,isOpen:_,onClose:()=>w(!1)})]})}const J_=({event:e,interestedCount:t=0,isInterested:r=!1,onInterestClick:n,onShareClick:i,onFlagClick:a,onClick:o,className:l})=>{const c=e.poster_image_url||e.image_url,d=e.event_date?new Date(e.event_date):null;return s.jsxs("div",{className:ke("flex flex-col rounded-lg overflow-hidden","bg-gray-100 hover:shadow-lg transition-all duration-200","relative group",l),children:[s.jsxs("div",{onClick:o,className:"relative w-full aspect-square cursor-pointer",children:[c?s.jsx("img",{src:c,alt:e.title,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full bg-gradient-to-br from-synth-pink/20 to-synth-pink/40 flex items-center justify-center",children:s.jsx("div",{className:"text-center px-2",children:s.jsx("p",{className:"text-xs font-semibold text-synth-pink line-clamp-2",children:e.title})})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-2 text-white",children:[s.jsx("p",{className:"text-xs font-semibold line-clamp-1 mb-1",children:e.title}),e.artist_name&&s.jsx("p",{className:"text-[10px] opacity-90 line-clamp-1",children:e.artist_name}),d&&s.jsx("p",{className:"text-[10px] opacity-75 mt-1",children:Dt(d,"MMM d")})]})})]}),s.jsx("div",{className:"px-2 pt-2 pb-1 bg-white",children:s.jsx("p",{className:"text-sm font-semibold text-[#0e0e0e] line-clamp-2 leading-tight",children:e.title})}),s.jsxs("div",{className:"flex items-center justify-between px-2 py-2 bg-white min-h-[40px]",children:[s.jsxs("div",{className:"text-sm text-[#0e0e0e] font-normal flex-shrink-0",children:[s.jsx("span",{className:"font-semibold",children:t})," interested"]}),s.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[s.jsx("button",{onClick:u=>{u.stopPropagation(),a==null||a(u)},className:"p-1 rounded transition-colors bg-transparent text-[#0e0e0e] hover:bg-gray-100 flex-shrink-0","aria-label":"Flag event",children:s.jsx(Va,{className:"w-4 h-4",strokeWidth:2})}),s.jsx("button",{onClick:u=>{u.stopPropagation(),i==null||i(u)},className:"p-1 rounded transition-colors bg-transparent text-[#0e0e0e] hover:bg-gray-100 flex-shrink-0","aria-label":"Share event",children:s.jsx(cf,{className:"w-4 h-4",strokeWidth:2})}),s.jsx("button",{onClick:u=>{u.stopPropagation(),n==null||n(u)},className:ke("p-1 rounded transition-colors flex-shrink-0",r?"bg-[#b00056] text-white":"bg-transparent text-[#0e0e0e] hover:bg-gray-100"),"aria-label":r?"Remove interest":"Mark as interested",children:s.jsx(eo,{className:ke("w-4 h-4",r&&"rotate-45"),strokeWidth:2})})]})]})]})},kLe=e=>ua.divIcon({className:"numbered-marker",html:`<div style="
      background-color: #ec4899;
      color: white;
      border: 2px solid white;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    ">${e}</div>`,iconSize:[32,32],iconAnchor:[16,16]}),ELe=({events:e})=>{const t=tp();return y.useEffect(()=>{if(e.length===0)return;const r=ua.latLngBounds(e.map(n=>[n.latitude,n.longitude]));r.isValid()&&t.fitBounds(r,{padding:[50,50]})},[t,e]),null},CLe=({currentUserId:e,filters:t,onNavigateToProfile:r,onNavigateToChat:n})=>{const i=ci(),[a,o]=y.useState("calendar"),[l,c]=y.useState(new Date),[d,u]=y.useState(new Map),[h,f]=y.useState(void 0),[p,x]=y.useState([]),[g,v]=y.useState(!1),[_,w]=y.useState(null),[b,N]=y.useState([]),[S,k]=y.useState([]),[O,A]=y.useState([]),[T,$]=y.useState(!1),[R,F]=y.useState(null),[D,B]=y.useState(!1),[U,V]=y.useState(new Set),[Y,z]=y.useState(new Map),K=y.useRef(""),Z=y.useRef(!1),G=y.useCallback(()=>E(void 0,null,function*(){v(!0);try{const H=new Date;H.setHours(0,0,0,0),console.log(" [CALENDAR] Loading upcoming events with optimized spatial filtering");let le=[];if(t!=null&&t.latitude&&(t!=null&&t.longitude)&&(t!=null&&t.radiusMiles)){console.log(" [CALENDAR] Using RPC function with spatial index");const{data:ae,error:fe}=yield P.rpc("get_calendar_events",{p_latitude:t.latitude,p_longitude:t.longitude,p_radius_miles:t.radiusMiles,p_min_date:H.toISOString(),p_genres:t!=null&&t.genres&&t.genres.length>0?t.genres:null,p_limit:1500});if(fe)throw fe;le=ae||[],console.log(` [CALENDAR] Loaded ${le.length} events within ${t.radiusMiles} miles (using spatial index)`)}else if(t!=null&&t.cities&&t.cities.length>0){let ae=P.from("events").select("*").gte("event_date",H.toISOString()).in("venue_city",t.cities);t!=null&&t.genres&&t.genres.length>0&&(ae=ae.overlaps("genres",t.genres),console.log(" [CALENDAR] Applied genre filters:",t.genres));const{data:fe,error:he}=yield ae.order("event_date",{ascending:!0}).limit(1e4);if(he)throw he;le=fe||[],console.log(" [CALENDAR] City filter:",le.length,"events")}else{console.log(" [CALENDAR] Using RPC function without location filter");const{data:ae,error:fe}=yield P.rpc("get_calendar_events",{p_latitude:null,p_longitude:null,p_radius_miles:null,p_min_date:H.toISOString(),p_genres:t!=null&&t.genres&&t.genres.length>0?t.genres:null,p_limit:1e4});if(fe)throw fe;le=ae||[],console.log(" [CALENDAR] No location filter:",le.length,"events")}console.log(` [CALENDAR] Final count: ${le.length} events`);const Se=new Map;le.forEach(ae=>{const fe=new Date(ae.event_date),he=Dt(fe,"yyyy-MM-dd");Se.has(he)||Se.set(he,[]),Se.get(he).push(ae)}),console.log(` [CALENDAR] Grouped events into ${Se.size} unique dates`),u(Se)}catch(H){console.error("Error loading calendar events:",H)}finally{v(!1)}}),[t==null?void 0:t.latitude,t==null?void 0:t.longitude,t==null?void 0:t.radiusMiles,t==null?void 0:t.cities,t==null?void 0:t.genres]);y.useEffect(()=>{if(a!=="calendar")return;const H=JSON.stringify({lat:t==null?void 0:t.latitude,lng:t==null?void 0:t.longitude,radius:t==null?void 0:t.radiusMiles,cities:t==null?void 0:t.cities,genres:t==null?void 0:t.genres});if(H===K.current)return;const le=(t==null?void 0:t.latitude)&&(t==null?void 0:t.longitude)&&(t==null?void 0:t.radiusMiles),Se=(t==null?void 0:t.cities)&&t.cities.length>0;if(!le&&!Se&&Z.current){console.log(" [CALENDAR] Skipping load - filters cleared but we already have data");return}if(!le&&!Se&&!Z.current){console.log(" [CALENDAR] Skipping initial load - waiting for filters to be set");return}K.current=H,Z.current=!0,G()},[a,t==null?void 0:t.latitude,t==null?void 0:t.longitude,t==null?void 0:t.radiusMiles,t==null?void 0:t.cities,t==null?void 0:t.genres,G]),y.useEffect(()=>{a==="tour"&&_&&X()},[a,_]);const X=()=>E(void 0,null,function*(){if(!(!_||!_.id)){$(!0);try{const H=yield _N.getArtistTourEvents(_.id);N(H);const le=_N.calculateTourRoute(H);k(le.route);const Se=yield _N.getArtistGroupChats(_.id,e);A(Se),e&&H.length>0&&(yield te(H.map(ae=>ae.id)))}catch(H){console.error("Error loading tour data:",H)}finally{$(!1)}}}),te=H=>E(void 0,null,function*(){if(!(!e||H.length===0))try{const{data:le,error:Se}=yield P.from("user_event_relationships").select("event_id").eq("user_id",e).eq("relationship_type","interested").in("event_id",H);if(!Se&&le){const he=new Set;le.forEach(pe=>{pe.event_id&&he.add(String(pe.event_id))}),V(he)}const{data:ae,error:fe}=yield P.from("user_event_relationships").select("event_id").eq("relationship_type","interested").in("event_id",H);if(!fe&&ae){const he=new Map;ae.forEach(pe=>{if(pe.event_id){const Ae=String(pe.event_id);he.set(Ae,(he.get(Ae)||0)+1)}}),z(he)}}catch(le){console.error("Error loading interested data:",le)}}),se=H=>{if(f(H),!H){x([]);return}};y.useEffect(()=>{if(!h){x([]);return}const H=Dt(h,"yyyy-MM-dd"),Se=[...d.get(H)||[]].sort((ae,fe)=>new Date(ae.event_date).getTime()-new Date(fe.event_date).getTime());x(Se)},[d,h]);const ue=H=>{const le=Dt(H,"yyyy-MM-dd");return d.get(le)||[]},ye=H=>{F(H),B(!0)},ne=b.length>0?[...b].sort((H,le)=>new Date(H.event_date).getTime()-new Date(le.event_date).getTime()):[],xe=H=>`${H.venue_name||""}|${H.venue_city||""}|${H.venue_state||""}`.toLowerCase(),ge=Q.useMemo(()=>{if(ne.length===0)return[];const H=[],le=new Set;let Se=1;for(const ae of ne){const fe=xe(ae);if(H.findIndex(pe=>pe.venueKey===fe)===-1)H.push({venueKey:fe,venueName:ae.venue_name||"Unknown Venue",venueCity:ae.venue_city||"",venueState:ae.venue_state,latitude:ae.latitude,longitude:ae.longitude,number:Se++,events:[ae],firstEventDate:new Date(ae.event_date)}),le.add(fe);else{const pe=H[H.length-1];pe.venueKey===fe?pe.events.push(ae):H.push({venueKey:fe,venueName:ae.venue_name||"Unknown Venue",venueCity:ae.venue_city||"",venueState:ae.venue_state,latitude:ae.latitude,longitude:ae.longitude,number:Se++,events:[ae],firstEventDate:new Date(ae.event_date)})}}return H},[ne]);Q.useMemo(()=>{const H=new Map;return ge.forEach(le=>{le.events.forEach(Se=>{H.set(Se.id,le.number)})}),H},[ge]);const ie=Q.useMemo(()=>{if(ge.length<2)return[];const H=[];for(let le=0;le<ge.length-1;le++){const Se=ge[le],ae=ge[le+1];H.push({from:{lat:Se.latitude,lng:Se.longitude,city:`${Se.venueCity}${Se.venueState?`, ${Se.venueState}`:""}`},to:{lat:ae.latitude,lng:ae.longitude,city:`${ae.venueCity}${ae.venueState?`, ${ae.venueState}`:""}`}})}return H},[ge]),ee=()=>{if(b.length===0)return[39.8283,-98.5795];const H=b.reduce((Se,ae)=>Se+ae.latitude,0)/b.length,le=b.reduce((Se,ae)=>Se+ae.longitude,0)/b.length;return[H,le]};return s.jsxs("div",{className:"mb-2 space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:"Discover Events"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Discover events by date, leaderboards, or artist tour"})]})}),s.jsxs(Cl,{value:a,onValueChange:H=>o(H),children:[s.jsxs(Fo,{className:"grid w-full grid-cols-3",children:[s.jsxs(Tn,{value:"calendar",className:"flex items-center gap-2",children:[s.jsx(Et,{className:"w-4 h-4"}),"Calendar"]}),s.jsxs(Tn,{value:"leaderboards",className:"flex items-center gap-2",children:[s.jsx(Sd,{className:"w-4 h-4"}),"Leaderboards"]}),s.jsxs(Tn,{value:"tour",className:"flex items-center gap-2",children:[s.jsx(tQ,{className:"w-4 h-4"}),"Tour Tracker"]})]}),s.jsx(On,{value:"calendar",className:"mt-4",children:g?s.jsx(yd,{text:"Loading calendar...",size:"lg"}):s.jsxs("div",{className:"space-y-4 flex flex-col items-center justify-center",children:[s.jsx("div",{className:"flex justify-center w-full",children:s.jsx(v1,{mode:"single",selected:h,onSelect:se,month:l,onMonthChange:c,className:"rounded-md border",numberOfMonths:1,disabled:H=>{const le=new Date;le.setHours(0,0,0,0);const Se=new Date(H);return Se.setHours(0,0,0,0),Se<le},modifiers:{hasEvents:H=>ue(H).length>0},modifiersClassNames:{hasEvents:"bg-synth-pink/20 border-synth-pink"}})}),h&&p.length>0&&s.jsxs("div",{className:"mt-4 space-y-2 w-full max-w-2xl",children:[s.jsxs("h3",{className:"font-semibold",children:["Events on ",Dt(h,"MMMM d, yyyy")]}),s.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-96 overflow-y-auto",children:p.map(H=>s.jsx(He,{className:"cursor-pointer hover:shadow-md",onClick:()=>ye(H),children:s.jsx(st,{className:"p-4",children:s.jsx("div",{className:"flex items-start justify-between",children:s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold",children:H.title}),s.jsx("p",{className:"text-sm text-muted-foreground",children:H.venue_name}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:Dt(new Date(H.event_date),"MMMM d, yyyy  h:mm a")})]})})})},H.id))})]}),h&&p.length===0&&!g&&s.jsx("div",{className:"mt-4 text-center text-muted-foreground",children:s.jsx("p",{children:"No events found for the selected date."})})]})}),s.jsx(On,{value:"leaderboards",className:"mt-4",children:s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(Sd,{className:"w-12 h-12 mx-auto text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Leaderboards are still in development"})]})})}),s.jsx(On,{value:"tour",className:"mt-4",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search for an Artist"}),s.jsx(TE,{onArtistSelect:H=>w(H),placeholder:"Search for an artist to track their tour..."})]}),_&&s.jsx(He,{className:"overflow-hidden border-2 border-synth-pink/20 shadow-lg cursor-pointer hover:shadow-xl transition-shadow",onClick:()=>{const H=_.id||encodeURIComponent(_.name);i(`/artist/${H}`)},children:s.jsx("div",{className:"relative p-6",style:{background:"linear-gradient(135deg, rgba(255, 51, 153, 0.1) 0%, rgba(255, 51, 153, 0.05) 100%)"},children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex-shrink-0",children:[_.image_url?s.jsx("img",{src:_.image_url,alt:_.name,className:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-lg",onError:H=>{var Se;const le=H.target;le.style.display="none",(Se=le.nextElementSibling)==null||Se.classList.remove("hidden")}}):null,!_.image_url&&s.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-synth-pink to-purple-500 flex items-center justify-center border-4 border-white shadow-lg",children:s.jsx(Ct,{className:"w-12 h-12 text-white"})})]}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2 truncate",children:_.name}),s.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[b.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Et,{className:"w-4 h-4 text-synth-pink"}),s.jsxs("span",{className:"text-sm font-medium text-foreground",children:[b.length," ",b.length===1?"Tour Date":"Tour Dates"]})]}),_.genres&&_.genres.length>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ct,{className:"w-4 h-4 text-synth-pink"}),s.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[_.genres.slice(0,3).map((H,le)=>s.jsx(Be,{variant:"secondary",className:"text-xs bg-white/80 text-foreground border-synth-pink/20",children:H},le)),_.genres.length>3&&s.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",_.genres.length-3," more"]})]})]})]})]}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:H=>{H.stopPropagation(),w(null),N([]),k([]),A([])},className:"flex-shrink-0 text-muted-foreground hover:text-foreground",children:s.jsx(pr,{className:"w-4 h-4"})})]})})]})})}),T?s.jsx(yd,{text:"Loading tour data...",size:"lg"}):_&&b.length>0?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"h-96 rounded-lg overflow-hidden border relative z-0",children:s.jsxs(i1,{center:ee(),zoom:5,style:{height:"100%",width:"100%",zIndex:0},boundsOptions:{padding:[50,50]},children:[s.jsx(a1,{url:"https://api.mapbox.com/styles/v1/mapbox/light-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic2xvaXRlcnN0ZWluIiwiYSI6ImNtamhvM3ozOTFnOHIza29yZHJmcGQ0ZGkifQ.5FU9eVyo5DAhSfESdWrI9w",attribution:' <a href="https://www.mapbox.com/about/maps/">Mapbox</a>  <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),s.jsx(ELe,{events:ne}),ie.map((H,le)=>{const Se=H.from.lat,ae=H.from.lng,fe=H.to.lat,he=H.to.lng,pe=fe-Se,Ae=he-ae,qe=Se+pe*.85,Fe=ae+Ae*.85,Ve=`
                        <svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
                          <g transform="translate(10,10) rotate(${Math.atan2(pe,Ae)*180/Math.PI}) translate(-10,-10)">
                            <polygon points="10,2 4,16 16,16" fill="#ec4899" stroke="white" stroke-width="1.5"/>
                          </g>
                        </svg>
                      `;return s.jsxs(Q.Fragment,{children:[s.jsx(Zde,{positions:[[Se,ae],[fe,he]],pathOptions:{color:"#ec4899",weight:3,opacity:.7}}),s.jsx(jg,{position:[qe,Fe],icon:ua.divIcon({className:"arrowhead-marker",html:Ve,iconSize:[20,20],iconAnchor:[10,10]})})]},le)}),ge.map(H=>s.jsx(jg,{position:[H.latitude,H.longitude],icon:kLe(H.number),eventHandlers:{click:()=>{H.events.length>0&&ye(H.events[0])}}},`${H.venueKey}-${H.number}`))]})}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("h3",{className:"font-semibold mb-3",children:["Tour Dates (",ne.length,")"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 max-h-96 overflow-y-auto",children:ne.map(H=>{const le=U.has(H.id),Se=Y.get(H.id)||0;return s.jsx(J_,{event:{id:H.id,title:H.title||"",artist_name:H.artist_name,venue_name:H.venue_name,event_date:H.event_date,venue_city:H.venue_city,image_url:H.image_url,poster_image_url:H.poster_image_url},interestedCount:Se,isInterested:le,onInterestClick:ae=>E(void 0,null,function*(){if(ae.stopPropagation(),!e)return;const fe=!le;V(he=>{const pe=new Set(he);return fe?pe.add(H.id):pe.delete(H.id),pe});try{yield Hn.toggleEventInterest(e,H.id,fe),z(he=>{const pe=new Map(he),Ae=pe.get(H.id)||0;return pe.set(H.id,fe?Ae+1:Math.max(0,Ae-1)),pe})}catch(he){console.error("Error toggling interest:",he),V(pe=>{const Ae=new Set(pe);return le?Ae.add(H.id):Ae.delete(H.id),Ae})}}),onClick:()=>ye(H)},H.id)})})]}),O.length>0&&s.jsxs("div",{className:"mt-4",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Related Group Chats"}),s.jsx("div",{className:"grid grid-cols-1 gap-2",children:O.map(H=>s.jsx(He,{className:"cursor-pointer hover:shadow-md",onClick:()=>n&&H.chat_id&&n(H.chat_id),children:s.jsx(st,{className:"p-4",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold",children:H.name}),H.member_count!==void 0&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[H.member_count," members"]})]})})})},H.id))})]})]}):_?s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsxs("p",{children:["No upcoming events found for ",_.name]})}):s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:"Search for an artist to see their tour route"})})]})})]}),s.jsx(tn,{open:D,onOpenChange:B,children:s.jsx(Xr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:R&&s.jsx(hY,{event:R,currentUserId:e,onInterestToggle:()=>E(void 0,null,function*(){}),onReview:()=>E(void 0,null,function*(){}),isInterested:!1,hasReviewed:!1,showInterestButton:!0,showReviewButton:!0})})})]})},vh=class vh{static searchCity(t){const r=t.toLowerCase().trim();return this.CITY_COORDINATES[r]||null}static getAllCities(){return Object.values(this.CITY_COORDINATES)}static searchEventsByLocation(t){return E(this,null,function*(){try{const{latitude:r,longitude:n,radius:i,limit:a=50,startDate:o,endDate:l}=t,c=i/69,d=i/(69*Math.cos(r*Math.PI/180)),u=r-c,h=r+c,f=n-d,p=n+d;let x=P.from("events").select("*").not("latitude","is",null).not("longitude","is",null).gte("latitude",u).lte("latitude",h).gte("longitude",f).lte("longitude",p).gte("event_date",new Date().toISOString());o&&(x=x.gte("event_date",o)),l&&(x=x.lte("event_date",l)),!o&&!l&&(x=x.gte("event_date",new Date().toISOString()));const{data:g,error:v}=yield x.order("event_date",{ascending:!0}).limit(a);if(v)throw v;return(g||[]).map(b=>({id:b.id,jambase_event_id:b.jambase_event_id,title:b.title,artist_name:b.artist_name,artist_id:b.artist_id||"",venue_name:b.venue_name,venue_id:b.venue_id||"",event_date:b.event_date,doors_time:b.doors_time,description:b.description,genres:b.genres,venue_address:b.venue_address,venue_city:b.venue_city,venue_state:b.venue_state,venue_zip:b.venue_zip,latitude:b.latitude?Number(b.latitude):void 0,longitude:b.longitude?Number(b.longitude):void 0,ticket_available:b.ticket_available,price_range:b.price_range,ticket_urls:b.ticket_urls,setlist:b.setlist,tour_name:b.tour_name,created_at:b.created_at,updated_at:b.updated_at})).map(b=>W(M({},b),{distance:vh.calculateDistance(r,n,b.latitude||0,b.longitude||0)})).filter(b=>b.distance<=i).sort((b,N)=>b.distance-N.distance)}catch(r){throw console.error("Error searching events by location:",r),new Error(`Failed to search events by location: ${r instanceof Error?r.message:"Unknown error"}`)}})}static calculateDistance(t,r,n,i){const o=h=>h*(Math.PI/180),l=o(n-t),c=o(i-r),d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(o(t))*Math.cos(o(n))*Math.sin(c/2)*Math.sin(c/2);return 3959*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}static toRadians(t){return t*(Math.PI/180)}static getCurrentLocation(){return E(this,null,function*(){return new Promise((t,r)=>{if(!navigator.geolocation){r(new Error("Geolocation is not supported by this browser"));return}navigator.geolocation.getCurrentPosition(n=>{t({latitude:n.coords.latitude,longitude:n.coords.longitude})},n=>{r(new Error(`Failed to get location: ${n.message}`))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})})})}static reverseGeocode(t,r){return E(this,null,function*(){try{let n=null;const i=Object.values(this.CITY_COORDINATES);for(const l of i){const c=vh.calculateDistance(t,r,l.lat,l.lng);(!n||c<n.distance)&&(n={name:l.state?`${l.name}, ${l.state}`:l.name,distance:c})}if(n&&n.distance<=25)return n.name;const a=yield fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${t}&lon=${r}&zoom=10&addressdetails=1`,{headers:{"User-Agent":"Synth-App/1.0"}});if(!a.ok)return console.warn("Reverse geocoding API failed, using nearest city fallback"),(n==null?void 0:n.name)||null;const o=yield a.json();if(o&&o.address){const l=o.address.city||o.address.town||o.address.village||o.address.municipality,c=o.address.state;if(l)return c?`${l}, ${c}`:l}return(n==null?void 0:n.name)||null}catch(n){console.error("Error in reverse geocoding:",n);let i=null;const a=Object.values(this.CITY_COORDINATES);for(const o of a){const l=vh.calculateDistance(t,r,o.lat,o.lng);(!i||l<i.distance)&&(i={name:o.state?`${o.name}, ${o.state}`:o.name,distance:l})}return(i==null?void 0:i.name)||null}})}static searchEventsByCity(t,r=25,n=50){return E(this,null,function*(){const i=this.searchCity(t);return i?{events:yield this.searchEventsByLocation({latitude:i.lat,longitude:i.lng,radius:r,limit:n}),city:i}:{events:[],city:null}})}};_r(vh,"CITY_COORDINATES",{"new york":{name:"New York",lat:40.7128,lng:-74.006,state:"NY"},"los angeles":{name:"Los Angeles",lat:34.0522,lng:-118.2437,state:"CA"},chicago:{name:"Chicago",lat:41.8781,lng:-87.6298,state:"IL"},houston:{name:"Houston",lat:29.7604,lng:-95.3698,state:"TX"},phoenix:{name:"Phoenix",lat:33.4484,lng:-112.074,state:"AZ"},philadelphia:{name:"Philadelphia",lat:39.9526,lng:-75.1652,state:"PA"},"san antonio":{name:"San Antonio",lat:29.4241,lng:-98.4936,state:"TX"},"san diego":{name:"San Diego",lat:32.7157,lng:-117.1611,state:"CA"},dallas:{name:"Dallas",lat:32.7767,lng:-96.797,state:"TX"},austin:{name:"Austin",lat:30.2672,lng:-97.7431,state:"TX"},"washington dc":{name:"Washington DC",lat:38.9072,lng:-77.0369,state:"DC"},boston:{name:"Boston",lat:42.3601,lng:-71.0589,state:"MA"},denver:{name:"Denver",lat:39.7392,lng:-104.9903,state:"CO"},seattle:{name:"Seattle",lat:47.6062,lng:-122.3321,state:"WA"},"san francisco":{name:"San Francisco",lat:37.7749,lng:-122.4194,state:"CA"},miami:{name:"Miami",lat:25.7617,lng:-80.1918,state:"FL"},atlanta:{name:"Atlanta",lat:33.749,lng:-84.388,state:"GA"},nashville:{name:"Nashville",lat:36.1627,lng:-86.7816,state:"TN"},portland:{name:"Portland",lat:45.5152,lng:-122.6784,state:"OR"},"las vegas":{name:"Las Vegas",lat:36.1699,lng:-115.1398,state:"NV"},detroit:{name:"Detroit",lat:42.3314,lng:-83.0458,state:"MI"},memphis:{name:"Memphis",lat:35.1495,lng:-90.049,state:"TN"},baltimore:{name:"Baltimore",lat:39.2904,lng:-76.6122,state:"MD"},milwaukee:{name:"Milwaukee",lat:43.0389,lng:-87.9065,state:"WI"},albuquerque:{name:"Albuquerque",lat:35.0844,lng:-106.6504,state:"NM"},tucson:{name:"Tucson",lat:32.2226,lng:-110.9747,state:"AZ"},fresno:{name:"Fresno",lat:36.7378,lng:-119.7871,state:"CA"},sacramento:{name:"Sacramento",lat:38.5816,lng:-121.4944,state:"CA"},"kansas city":{name:"Kansas City",lat:39.0997,lng:-94.5786,state:"MO"},mesa:{name:"Mesa",lat:33.4152,lng:-111.8315,state:"AZ"},"virginia beach":{name:"Virginia Beach",lat:36.8529,lng:-75.978,state:"VA"},omaha:{name:"Omaha",lat:41.2524,lng:-95.998,state:"NE"},"colorado springs":{name:"Colorado Springs",lat:38.8339,lng:-104.8214,state:"CO"},raleigh:{name:"Raleigh",lat:35.7796,lng:-78.6382,state:"NC"},"long beach":{name:"Long Beach",lat:33.7701,lng:-118.1937,state:"CA"}});let Pi=vh;const W5=Object.freeze(Object.defineProperty({__proto__:null,LocationService:Pi},Symbol.toStringTag,{value:"Module"})),PLe=({currentUserId:e,onBack:t,onNavigateToNotifications:r,onNavigateToProfile:n,onNavigateToChat:i,onViewChange:a})=>{const[o,l]=y.useState(""),[c,d]=y.useState(!1),[u,h]=y.useState(!1),[f,p]=y.useState(null),[x,g]=y.useState(!1),[v,_]=y.useState({radiusMiles:30}),[w,b]=y.useState(!1),[N,S]=y.useState(""),[k,O]=y.useState(""),[A,T]=y.useState(!1),[$,R]=y.useState(null);y.useEffect(()=>{const Z=()=>{g(window.innerWidth<768)};return Z(),window.addEventListener("resize",Z),()=>window.removeEventListener("resize",Z)},[]),y.useEffect(()=>{F()},[e]);const F=()=>E(void 0,null,function*(){try{const{data:Z}=yield P.from("users").select("latitude, longitude, location_city").eq("user_id",e).single();if(Z!=null&&Z.latitude&&(Z!=null&&Z.longitude)){const G={latitude:Z.latitude,longitude:Z.longitude};R(G),_(X=>W(M({},X),{latitude:G.latitude,longitude:G.longitude,radiusMiles:30})),O(Z.location_city||"Current Location")}else try{const G=yield Pi.getCurrentLocation();R(G),_(X=>W(M({},X),{latitude:G.latitude,longitude:G.longitude,radiusMiles:30}));try{const X=yield Pi.reverseGeocode(G.latitude,G.longitude);O(X||"Current Location")}catch(X){console.error("Error reverse geocoding:",X),O("Current Location")}}catch(G){console.error("Error getting current location:",G)}}catch(Z){console.error("Error loading user location:",Z);try{const G=yield Pi.getCurrentLocation();R(G),_(X=>W(M({},X),{latitude:G.latitude,longitude:G.longitude,radiusMiles:30}));try{const X=yield Pi.reverseGeocode(G.latitude,G.longitude);O(X||"Current Location")}catch(X){console.error("Error reverse geocoding:",X),O("Current Location")}}catch(G){console.error("Error getting current location:",G)}}}),D=Z=>{p(Z)},B=()=>{p(null)},U=()=>E(void 0,null,function*(){T(!0);try{const Z=yield Pi.getCurrentLocation();R(Z),_(W(M({},v),{latitude:Z.latitude,longitude:Z.longitude,radiusMiles:v.radiusMiles||30}));try{const G=yield Pi.reverseGeocode(Z.latitude,Z.longitude);O(G||"Current Location")}catch(G){console.error("Error reverse geocoding:",G),O("Current Location")}b(!1)}catch(Z){console.error("Error getting current location:",Z),alert("Failed to get your current location. Please try again or enter a city name.")}finally{T(!1)}}),V=()=>{const Z=N.trim();if(!Z)return;const G=Pi.searchCity(Z);G?(_(W(M({},v),{latitude:G.lat,longitude:G.lng,radiusMiles:v.radiusMiles||30})),O(G.state?`${G.name}, ${G.state}`:G.name),S(""),b(!1)):alert(`City "${Z}" not found. Please try a major city name.`)},Y=Z=>{_(W(M({},v),{radiusMiles:Z[0]}))},z=()=>{_(W(M({},v),{latitude:void 0,longitude:void 0,radiusMiles:30})),O("")},K=!!(v.latitude&&v.longitude);return f?s.jsx(uLe,{vibeType:f,userId:e,filters:v,onBack:B,onNavigateToProfile:n,onNavigateToChat:i}):s.jsxs("div",{className:"min-h-screen bg-[#fcfcfc]",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},children:[s.jsx("div",{className:"bg-[#fcfcfc] border-b border-gray-200",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-3",children:s.jsx("div",{className:"flex items-center gap-3",children:s.jsx("div",{className:"flex-1",children:s.jsx(YO,{userId:e,allowedTabs:["artists","venues","users","events"],showMap:!1,layout:"compact",mode:"embedded",headerTitle:"",headerDescription:"",showHelperText:!1,initialSearchQuery:o,hideSearchInput:!1,showResults:!1,onSearchStateChange:({query:Z,debouncedQuery:G})=>{l(Z),d(G.trim().length>=2)},onNavigateToProfile:n,onNavigateToChat:i})})})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 pb-6 space-y-2",children:[s.jsxs("div",{className:"mb-2 flex items-center gap-2 flex-wrap overflow-x-auto",children:[s.jsxs(oe,{onClick:()=>h(!0),className:"bg-synth-pink hover:bg-synth-pink/90 text-white gap-2 flex-shrink-0",size:"sm","data-tour":"discover-vibes",children:[s.jsx(oa,{className:"h-4 w-4"}),"Browse Vibes"]}),s.jsxs(rc,{open:w,onOpenChange:b,children:[s.jsx(nc,{asChild:!0,children:s.jsxs(oe,{variant:"outline",size:"sm",className:"gap-2 flex-shrink-0",children:[s.jsx(Xt,{className:"h-4 w-4"}),"Location"]})}),s.jsx(ul,{className:"w-80 bg-white",align:"start",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"font-semibold text-sm",children:"Set Location"}),s.jsx(oe,{onClick:U,disabled:A,variant:"outline",className:"w-full",size:"sm",children:A?s.jsxs(s.Fragment,{children:[s.jsx(er,{className:"h-4 w-4 mr-2 animate-spin"}),"Getting location..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Xt,{className:"h-4 w-4 mr-2"}),"Use Current Location"]})}),s.jsx("div",{className:"text-sm text-muted-foreground text-center",children:"or"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(or,{placeholder:"Enter city name (e.g., New York, Los Angeles)",value:N,onChange:Z=>S(Z.target.value),onKeyDown:Z=>{Z.key==="Enter"&&V()}}),s.jsx(oe,{onClick:V,disabled:!N.trim(),className:"w-full",size:"sm",children:"Search City"})]}),K&&s.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("span",{children:["Radius: ",v.radiusMiles||30," miles"]}),s.jsx("span",{className:"text-muted-foreground",children:"Max: 50"})]}),s.jsx(iY,{value:[v.radiusMiles||30],onValueChange:Y,min:1,max:50,step:1,className:"w-full"})]}),K&&s.jsx(oe,{onClick:z,variant:"ghost",size:"sm",className:"w-full",children:"Clear Location"})]})})]})]}),K&&s.jsx("div",{className:"mb-2",children:s.jsxs(Be,{variant:"secondary",className:"gap-1 bg-synth-pink/10 text-synth-pink border-synth-pink/30",children:[s.jsx(Xt,{className:"h-3 w-3"}),k||"Location"," (",v.radiusMiles||30," mi radius)",s.jsx("button",{onClick:z,className:"ml-2 hover:text-destructive",children:s.jsx(pr,{className:"h-3 w-3"})})]})}),c&&s.jsx("div",{className:"mt-4",children:s.jsx(YO,{userId:e,allowedTabs:["artists","venues","users","events"],showMap:!1,layout:"compact",mode:"embedded",headerTitle:"",headerDescription:"",showHelperText:!1,initialSearchQuery:o,hideSearchInput:!0,showResults:!0,onNavigateToProfile:n,onNavigateToChat:i})}),!c&&s.jsxs(s.Fragment,{children:[s.jsx(hLe,{currentUserId:e,onNavigateToProfile:n,onNavigateToChat:i}),s.jsx(CLe,{currentUserId:e,filters:v,onNavigateToProfile:n,onNavigateToChat:i}),s.jsx("div",{className:"mt-8",children:s.jsx(xLe,{currentUserId:e,onNavigateToProfile:n,onNavigateToChat:i})})]})]}),s.jsx(cLe,{isOpen:u,onClose:()=>h(!1),onSelectVibe:D,isMobile:x})]})};class jy{static getFirstDegreeNetworkEvents(t,r=20){return E(this,null,function*(){try{const{data:n,error:i}=yield P.rpc("get_first_degree_connections",{target_user_id:t});if(i)throw i;if(!n||n.length===0)return[];const a=n.map(x=>x.connected_user_id),{data:o,error:l}=yield P.from("user_event_relationships").select(`
          id,
          user_id,
          event_id,
          relationship_type,
          created_at,
          users:user_id (
            user_id,
            name,
            avatar_url
          )
        `).in("user_id",a).in("relationship_type",["interest","going","maybe"]).order("created_at",{ascending:!1}).limit(r*10);if(l)throw l;if(!o||o.length===0)return[];const c=[...new Set((o||[]).map(x=>x.event_id))];if(c.length===0)return[];const{data:d,error:u}=yield P.from("events").select("id, title, venue_city, event_date, images, artist_id, artists(name), venue_id, venues(name)").in("id",c);if(u)throw u;const h=new Map((d||[]).map(x=>[x.id,x])),f=new Map;(o||[]).forEach(x=>{const g=x.event_id;f.has(g)||f.set(g,[]),f.get(g).push(x)});const p=[];return f.forEach((x,g)=>{var b,N,S;const v=h.get(g);if(!v)return;const _=x[0],w=_.users;p.push({event_id:v.id,title:v.title||((b=v.artists)==null?void 0:b.name)||"Event",artist_name:((N=v.artists)==null?void 0:N.name)||"Unknown Artist",venue_name:((S=v.venues)==null?void 0:S.name)||"Unknown Venue",venue_city:v.venue_city||void 0,event_date:v.event_date,friend_id:(w==null?void 0:w.user_id)||_.user_id,friend_name:(w==null?void 0:w.name)||"Friend",friend_avatar:(w==null?void 0:w.avatar_url)||null,action_type:"interested",connection_degree:1,created_at:_.created_at,images:v.images,interested_count:x.length})}),p.sort((x,g)=>new Date(g.created_at).getTime()-new Date(x.created_at).getTime()).slice(0,r)}catch(n){return console.error("Error fetching first-degree network events:",n),[]}})}static getSecondDegreeNetworkEvents(t,r=15){return E(this,null,function*(){try{const{data:n,error:i}=yield P.rpc("get_second_degree_connections",{target_user_id:t});if(i)throw i;if(!n||n.length===0)return[];const a=n.map(f=>f.connected_user_id),{data:o,error:l}=yield P.from("user_event_relationships").select(`
          event_id,
          relationship_type,
          users:user_id (
            user_id,
            name,
            avatar_url
          )
        `).in("user_id",a).in("relationship_type",["interest","going","maybe"]);if(l)throw l;if(!o||o.length===0)return[];const c=new Map;(o||[]).forEach(f=>{const p=f.event_id,x=c.get(p)||{count:0,users:[]};x.count+=1,x.users.push(f.users),c.set(p,x)});const d=Array.from(c.entries()).sort((f,p)=>p[1].count-f[1].count).slice(0,r).map(([f])=>f);if(d.length===0)return[];const{data:u,error:h}=yield P.from("events").select("id, title, venue_city, event_date, images, artist_id, artists(name), venue_id, venues(name)").in("id",d);if(h)throw h;return(u||[]).map(f=>{var g,v,_,w;const p=c.get(f.id),x=(g=p==null?void 0:p.users)==null?void 0:g[0];return{event_id:f.id,title:f.title||((v=f.artists)==null?void 0:v.name)||"Event",artist_name:((_=f.artists)==null?void 0:_.name)||"Unknown Artist",venue_name:((w=f.venues)==null?void 0:w.name)||"Unknown Venue",venue_city:f.venue_city||void 0,event_date:f.event_date,friend_id:(x==null?void 0:x.user_id)||"",friend_name:(x==null?void 0:x.name)||"Friend",friend_avatar:(x==null?void 0:x.avatar_url)||null,action_type:"interested",connection_degree:2,created_at:new Date().toISOString(),images:f.images,interested_count:(p==null?void 0:p.count)||0}})}catch(n){return console.error("Error fetching second-degree network events:",n),[]}})}static getTrendingEvents(t,r,n,i=50,a=20,o){return E(this,null,function*(){console.log(" [TRENDING SERVICE] getTrendingEvents called:",{userId:t,cityLat:r,cityLng:n,radiusMiles:i,limit:a,city:o});try{console.log(" [TRENDING SERVICE] Fetching user_event_relationships...");const{data:l,error:c}=yield P.from("user_event_relationships").select("event_id").eq("relationship_type","interest");if(c)throw console.error(" [TRENDING SERVICE] Error fetching interests:",c),c;console.log(" [TRENDING SERVICE] Fetched interests:",{count:(l==null?void 0:l.length)||0});const d=new Map;(l||[]).forEach(D=>{const B=D.event_id;d.set(B,(d.get(B)||0)+1)}),console.log(" [TRENDING SERVICE] Interested counts calculated:",{uniqueEvents:d.size}),console.log(" [TRENDING SERVICE] Fetching reviews...");const{data:u,error:h}=yield P.from("reviews").select("event_id").eq("is_public",!0);if(h)throw console.error(" [TRENDING SERVICE] Error fetching reviews:",h),h;console.log(" [TRENDING SERVICE] Fetched reviews:",{count:(u==null?void 0:u.length)||0,reviews:u==null?void 0:u.map(D=>({id:D.id,event_id:D.event_id,artist_id:D.artist_id,venue_id:D.venue_id,rating:D.rating,created_at:D.created_at}))});const f=[...new Set((u||[]).map(D=>D.event_id).filter(D=>D!=null))];console.log(" [TRENDING SERVICE] Review event IDs:",{count:f.length,ids:f});const p=[...new Set((u||[]).map(D=>D.artist_id).filter(D=>D!=null))],x=[...new Set((u||[]).map(D=>D.venue_id).filter(D=>D!=null))];console.log(" [TRENDING SERVICE] Review artist/venue IDs:",{artistIds:p.length,venueIds:x.length});let g=new Map;if(f.length>0){console.log(" [TRENDING SERVICE] Fetching events for reviews (checking dates)...");const{data:D,error:B}=yield P.from("events").select("id, title, event_date, venue_city, latitude, longitude, artist_id, artists(name), venue_id, venues(name)").in("id",f);if(B)console.error(" [TRENDING SERVICE] Error fetching events for reviews:",B);else{const U=new Date().toISOString(),V=(D==null?void 0:D.filter(z=>z.event_date>=U))||[],Y=(D==null?void 0:D.filter(z=>z.event_date<U))||[];console.log(" [TRENDING SERVICE] Events with reviews:",{total:(D==null?void 0:D.length)||0,upcoming:V.length,past:Y.length,events:D==null?void 0:D.map(z=>({id:z.id,title:z.title,event_date:z.event_date,isUpcoming:z.event_date>=U}))})}!B&&D&&((D||[]).forEach(U=>{var Y,z;const V=((Y=U.artists)==null?void 0:Y.name)||((z=U.title)==null?void 0:z.split(" at ")[0])||U.title||"Unknown Artist";if(V){const K=(u||[]).filter(Z=>Z.event_id===U.id).length;g.set(V,(g.get(V)||0)+K)}}),console.log(" [TRENDING SERVICE] Artist review counts:",Object.fromEntries(g)))}const v=Array.from(g.entries()).sort((D,B)=>B[1]-D[1]).slice(0,10).map(([D])=>D),_=Array.from(d.keys()),w=f,b=Array.from(new Set([..._,...w]));if(console.log(" [TRENDING SERVICE] Event IDs combined:",{fromInterests:_.length,fromReviews:w.length,total:b.length}),b.length===0){console.log(" [TRENDING SERVICE] No events with interests or reviews, trying fallback to recent upcoming events...");let D=P.from("events").select("id, title, venue_city, venue_state, event_date, event_media_url, latitude, longitude, genres, artist_id, artists(name), venue_id, venues(name)").gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0});if(r&&n&&i){const Y=i/69*1.1,z=i/(69*Math.cos(r*Math.PI/180))*1.1;D=D.not("latitude","is",null).not("longitude","is",null).gte("latitude",r-Y).lte("latitude",r+Y).gte("longitude",n-z).lte("longitude",n+z).limit(300)}else D=D.limit(a*3);const{data:B,error:U}=yield D;if(U)return console.error(" [TRENDING SERVICE] Error fetching fallback events:",U),[];if(!B||B.length===0)return console.log(" [TRENDING SERVICE] No fallback events found either"),[];console.log(" [TRENDING SERVICE] Using fallback events (before exact distance filter):",{count:B.length});let V=B;if(r&&n&&i&&B){const{LocationService:Y}=yield on(()=>E(this,null,function*(){const{LocationService:z}=yield Promise.resolve().then(()=>W5);return{LocationService:z}}),void 0,import.meta.url);V=B.filter(z=>!z.latitude||!z.longitude?!1:Y.calculateDistance(r,n,Number(z.latitude),Number(z.longitude))<=i),console.log(" [TRENDING SERVICE] After exact distance filter:",{before:B.length,after:V.length})}return V.slice(0,a).map(Y=>{var z,K,Z;return{event_id:Y.id,title:Y.title||((z=Y.artists)==null?void 0:z.name)||"Event",artist_name:((K=Y.artists)==null?void 0:K.name)||"Unknown Artist",venue_name:((Z=Y.venues)==null?void 0:Z.name)||"Unknown Venue",venue_city:Y.venue_city||void 0,event_date:Y.event_date,trending_score:0,save_velocity:0,attendance_markings:0,network_overlap:0,trending_label:void 0,event_media_url:Y.event_media_url||void 0}})}console.log(" [TRENDING SERVICE] Fetching event details for",b.length,"events...");const N=new Date().toISOString();console.log(" [TRENDING SERVICE] Filtering for events after:",N);let S=P.from("events").select("id, title, venue_city, venue_state, event_date, event_media_url, latitude, longitude, genres, artist_id, artists(name), venue_id, venues(name)").in("id",b).gte("event_date",N);if(r&&n&&i){const D=i/69*1.1,B=i/(69*Math.cos(r*Math.PI/180))*1.1;S=S.gte("latitude",r-D).lte("latitude",r+D).gte("longitude",n-B).lte("longitude",n+B),console.log(" [TRENDING SERVICE] Applied bounding box filter:",{cityLat:r,cityLng:n,radiusMiles:i,latDelta:D,lngDelta:B})}const{data:k,error:O}=yield S.order("event_date",{ascending:!0}).limit(a*3);if(O)throw console.error(" [TRENDING SERVICE] Error fetching events:",O),O;console.log(" [TRENDING SERVICE] Fetched events:",{count:(k==null?void 0:k.length)||0,events:k==null?void 0:k.map(D=>({id:D.id,title:D.title,event_date:D.event_date,venue_city:D.venue_city,hasCoords:!!(D.latitude&&D.longitude)}))});let A=k||[];if(r&&n&&i&&k){console.log(" [TRENDING SERVICE] Applying exact distance filter...");const{LocationService:D}=yield on(()=>E(this,null,function*(){const{LocationService:B}=yield Promise.resolve().then(()=>W5);return{LocationService:B}}),void 0,import.meta.url);A=k.filter(B=>{if(!B.latitude||!B.longitude)return console.log(" [TRENDING SERVICE] Event missing coordinates:",B.id,B.title),!1;const U=D.calculateDistance(r,n,Number(B.latitude),Number(B.longitude)),V=U<=i;return V||console.log(" [TRENDING SERVICE] Event outside radius:",B.id,B.title,{distance:U,radiusMiles:i}),V}),console.log(" [TRENDING SERVICE] After exact distance filter:",{before:k.length,after:A.length,radiusMiles:i})}else console.log(" [TRENDING SERVICE] Skipping distance filter:",{cityLat:r,cityLng:n,radiusMiles:i,hasEvents:!!k});const T=new Map;(u||[]).forEach(D=>{D.event_id&&T.set(D.event_id,(T.get(D.event_id)||0)+1)});const $=new Map;(u||[]).forEach(D=>{if(D.event_id&&D.rating){const B=$.get(D.event_id)||{sum:0,count:0};$.set(D.event_id,{sum:B.sum+Number(D.rating),count:B.count+1})}});const R=new Map;$.forEach((D,B)=>{R.set(B,D.sum/D.count)}),console.log(" [TRENDING SERVICE] Calculating trending scores...");const F=A.map(D=>{var se,ue,ye;const B=d.get(D.id)||0,U=T.get(D.id)||0,V=R.get(D.id)||0,Y=((se=D.artists)==null?void 0:se.name)||((ue=D.title)==null?void 0:ue.split(" at ")[0])||"Unknown Artist",z=g.get(Y)||0,K=v.includes(Y),Z=B*3,G=U>0?U*2+V*5+(K?z*2:0):0,X=Z+G;let te="";return B>=15?te=" Very Hot":B>=10?te=" Trending":U>=10&&V>=4?te=" Highly Reviewed":K&&(B>=5||U>=3)?te=" Popular":B>=5?te=" Getting Attention":U>=5&&(te=" Well Reviewed"),{event_id:D.id,title:D.title||Y||"Event",artist_name:Y,venue_name:((ye=D.venues)==null?void 0:ye.name)||"Unknown Venue",venue_city:D.venue_city||void 0,event_date:D.event_date,trending_score:X,save_velocity:B,attendance_markings:0,network_overlap:0,trending_label:te||void 0,event_media_url:D.event_media_url||void 0}}).filter(D=>D.trending_score>0).sort((D,B)=>B.trending_score-D.trending_score).slice(0,a);return console.log(" [TRENDING SERVICE] Final trending events:",{count:F.length,events:F}),F}catch(l){return console.error(" [TRENDING SERVICE] Error fetching trending events:",l),[]}})}static getEventLists(t,r=5){return E(this,null,function*(){try{const n=[],{data:i,error:a}=yield P.from("reviews").select("event_id, rating").eq("user_id",t).gte("rating",4).order("rating",{ascending:!1}).limit(10);if(!a&&i&&i.length>0){const l=i.map(d=>d.event_id),{data:c}=yield P.from("events").select("id, title, venue_city, event_date, images, genres, artist_id, artists(name), venue_id, venues(name)").in("id",l).gte("event_date",new Date().toISOString()).limit(10);c&&c.length>0&&n.push({id:"user-top-rated",title:"Shows I'd See Again",description:"Based on your highest-rated reviews",list_type:"user_created",events:c.map(d=>{var u,h,f;return{id:d.id,title:d.title||((u=d.artists)==null?void 0:u.name)||"Event",artist_name:((h=d.artists)==null?void 0:h.name)||"Unknown Artist",venue_name:((f=d.venues)==null?void 0:f.name)||"Unknown Venue",event_date:d.event_date,genres:d.genres||[]}}),created_at:new Date().toISOString()})}const o=yield this.getFriendIds(t);if(o.length>0){const{data:l}=yield P.from("reviews").select("event_id, rating").in("user_id",o).gte("rating",4).order("rating",{ascending:!1}).limit(10);if(l&&l.length>0){const c=l.map(u=>u.event_id),{data:d}=yield P.from("events").select("id, title, venue_city, event_date, images, genres, artist_id, artists(name), venue_id, venues(name)").in("id",c).gte("event_date",new Date().toISOString()).lte("event_date",new Date(Date.now()+7*24*60*60*1e3).toISOString()).limit(10);d&&d.length>0&&n.push({id:"network-weekend",title:"Top Rated This Weekend in Your Network",description:"Highly rated by your friends",list_type:"system_generated",events:d.map(u=>({id:u.id,title:u.title||u.artist_name||"Event",artist_name:u.artist_name||"Unknown Artist",venue_name:u.venue_name||"Unknown Venue",event_date:u.event_date,genres:u.genres||[]})),created_at:new Date().toISOString()})}}return n.slice(0,r)}catch(n){return console.error("Error fetching event lists:",n),[]}})}static getNetworkReviews(t,r=20){return E(this,null,function*(){try{console.log(" [NETWORK_REVIEWS] Fetching network reviews for user:",t);const{data:n,error:i}=yield P.from("user_relationships").select("user_id, related_user_id").eq("relationship_type","friend").eq("status","accepted").or(`user_id.eq.${t},related_user_id.eq.${t}`);if(i)throw console.error(" [NETWORK_REVIEWS] Error fetching friends:",i),i;if(console.log(" [NETWORK_REVIEWS] Found friends:",(n==null?void 0:n.length)||0),!n||n.length===0)return console.log(" [NETWORK_REVIEWS] No friends found, returning empty array"),[];const a=n.map(_=>_.user_id===t?_.related_user_id:_.user_id);console.log(" [NETWORK_REVIEWS] Friend IDs:",a);const{data:o,error:l}=yield P.from("reviews").select(`
          id,
          user_id,
          event_id,
          artist_id,
          venue_id,
          rating,
          review_text,
          photos,
          created_at,
          events (
            id,
            title,
            event_date,
            artist_id,
            venue_id
          )
        `).in("user_id",a).eq("is_public",!0).eq("is_draft",!1).neq("review_text","ATTENDANCE_ONLY").not("review_text","is",null).order("created_at",{ascending:!1}).limit(r);if(l)throw console.error(" [NETWORK_REVIEWS] Error fetching reviews:",l),l;if(console.log(" [NETWORK_REVIEWS] Found reviews:",(o==null?void 0:o.length)||0),!o||o.length===0)return console.log(" [NETWORK_REVIEWS] No reviews found, returning empty array"),[];const c=[...new Set(o.map(_=>_.user_id))],{data:d,error:u}=yield P.from("users").select("user_id, name, avatar_url").in("user_id",c);if(u)throw console.error(" [NETWORK_REVIEWS] Error fetching users:",u),u;const h=new Map;d==null||d.forEach(_=>h.set(_.user_id,_));const f=new Set,p=new Set;o.forEach(_=>{var w,b;_.artist_id&&f.add(_.artist_id),_.venue_id&&p.add(_.venue_id),(w=_.events)!=null&&w.artist_id&&f.add(_.events.artist_id),(b=_.events)!=null&&b.venue_id&&p.add(_.events.venue_id)});const x=new Map,g=new Map;if(f.size>0){const{data:_}=yield P.from("artists").select("id, name").in("id",Array.from(f));_==null||_.forEach(w=>x.set(w.id,w.name))}if(p.size>0){const{data:_}=yield P.from("venues").select("id, name").in("id",Array.from(p));_==null||_.forEach(w=>g.set(w.id,w.name))}return o.filter(_=>h.has(_.user_id)).map(_=>{var O,A,T;const w=h.get(_.user_id),b=_.artist_id||((O=_.events)==null?void 0:O.artist_id),N=_.venue_id||((A=_.events)==null?void 0:A.venue_id),S=b?x.get(b):void 0,k=N?g.get(N):void 0;return{id:_.id,author:{id:w.user_id,name:w.name||"User",avatar_url:w.avatar_url||void 0},created_at:_.created_at,rating:_.rating||void 0,content:_.review_text||void 0,photos:_.photos||void 0,event_info:{artist_name:S||void 0,venue_name:k||void 0,event_date:((T=_.events)==null?void 0:T.event_date)||void 0},connection_degree:1}})}catch(n){return console.error("Error fetching network reviews:",n),[]}})}static getFriendIds(t){return E(this,null,function*(){try{const{data:r,error:n}=yield P.rpc("get_first_degree_connections",{target_user_id:t});if(n)throw n;return(r||[]).map(i=>i.connected_user_id)}catch(r){return console.error("Error getting friend IDs:",r),[]}})}}const ALe=({review:e,onClick:t,className:r})=>{var h,f,p;const n=e.author.name||"User",i=((h=e.event_info)==null?void 0:h.artist_name)||"Artist",a=((f=e.event_info)==null?void 0:f.venue_name)||"Venue",o=e.Event_date||e.event_date,l=o?Dt(new Date(o),"MMM d, yyyy"):(p=e.event_info)!=null&&p.event_date?Dt(new Date(e.event_info.event_date),"MMM d, yyyy"):e.created_at?Dt(new Date(e.created_at),"MMM d, yyyy"):"",c=e.rating||0,d=e.content||"",u=e.photos||[];return s.jsxs("div",{onClick:t,className:ke("bg-white border border-gray-200 rounded-lg p-2 cursor-pointer hover:shadow-md transition-shadow",r),children:[s.jsx("div",{className:"mb-1.5",children:s.jsxs("p",{className:"text-xs font-semibold text-gray-900 leading-tight",children:[s.jsx("span",{className:"font-bold",children:n})," reviewed ",s.jsx("span",{className:"font-bold",children:i}),a&&s.jsxs(s.Fragment,{children:[" at ",s.jsx("span",{className:"font-bold",children:a})]}),l&&s.jsxs(s.Fragment,{children:[" on ",s.jsx("span",{className:"font-bold",children:l})]})]})}),c>0&&s.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[s.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5}).map((x,g)=>s.jsx(Jt,{className:ke("w-3 h-3",g<Math.floor(c)?"fill-synth-pink text-synth-pink":"text-gray-300"),strokeWidth:1.5},g))}),s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:c.toFixed(1)})]}),d&&s.jsx("p",{className:"text-xs text-gray-700 mb-1.5 line-clamp-2 leading-tight",children:d}),u.length>0&&s.jsxs("div",{className:"flex gap-1.5 overflow-x-auto scrollbar-hide",children:[u.slice(0,2).map((x,g)=>s.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded overflow-hidden bg-gray-100",children:s.jsx("img",{src:x,alt:`Review photo ${g+1}`,className:"w-full h-full object-cover",onError:v=>{v.target.style.display="none"}})},g)),u.length>2&&s.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded bg-gray-100 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(y2,{className:"w-4 h-4 text-gray-400 mx-auto"}),s.jsxs("span",{className:"text-[9px] text-gray-500",children:["+",u.length-2]})]})})]})]})};class TLe{static getFeed(t,r=20,n=0,i,a=!1){return E(this,null,function*(){var o,l,c,d,u;try{console.log(" PreferencesV4Feed: Fetching feed for user:",t,{limit:r,offset:n,filters:i,skipFollowing:a});let h=(o=i==null?void 0:i.city)!=null?o:null;if(i!=null&&i.latitude&&(i!=null&&i.longitude)&&!h)try{const{LocationService:v}=yield on(()=>E(this,null,function*(){const{LocationService:w}=yield Promise.resolve().then(()=>W5);return{LocationService:w}}),void 0,import.meta.url),_=yield v.reverseGeocode(i.latitude,i.longitude);_&&(h=_.split(",")[0].trim(),console.log(` Reverse geocoded ${i.latitude},${i.longitude} to city: ${h}`))}catch(v){console.error("Error reverse geocoding for feed filter:",v)}const{data:f,error:p}=yield P.rpc("get_preferences_v4_feed",{p_user_id:t,p_limit:r,p_offset:n,p_include_past:(l=i==null?void 0:i.includePast)!=null?l:!1,p_city_filter:h,p_state_filter:(c=i==null?void 0:i.state)!=null?c:null,p_max_days_ahead:(d=i==null?void 0:i.maxDaysAhead)!=null?d:90,p_skip_following:a,p_radius_miles:(u=i==null?void 0:i.radiusMiles)!=null?u:null});if(p)throw console.error(" PreferencesV4Feed: Error fetching feed:",p),p;if(!f||f.length===0)return console.log(" PreferencesV4Feed: No events found"),{events:[],hasMore:!1};let x=f.map(v=>{var _,w,b,N;return{id:v.event_id,jambase_event_id:v.jambase_event_id,title:v.title||v.artist_name||"Event",artist_name:v.artist_name||"Unknown Artist",artist_id:v.artist_id,venue_name:v.venue_name||"Unknown Venue",venue_id:v.venue_id,event_date:v.event_date,doors_time:v.doors_time,description:v.description,genres:v.genres||[],venue_address:v.venue_address,venue_city:v.venue_city,venue_state:v.venue_state,venue_zip:v.venue_zip,latitude:v.latitude?Number(v.latitude):null,longitude:v.longitude?Number(v.longitude):null,ticket_available:(_=v.ticket_available)!=null?_:!0,price_range:v.price_range,ticket_urls:v.ticket_urls||[],setlist:v.setlist,setlist_enriched:v.setlist_enriched,setlist_song_count:v.setlist_song_count,setlist_fm_id:v.setlist_fm_id,setlist_fm_url:v.setlist_fm_url,setlist_source:v.setlist_source,setlist_last_updated:v.setlist_last_updated,tour_name:v.tour_name,poster_image_url:v.event_media_url||null,created_at:v.created_at,updated_at:v.updated_at,relevance_score:v.relevance_score?Number(v.relevance_score):void 0,user_is_interested:(w=v.user_is_interested)!=null?w:!1,interested_count:(b=v.interested_count)!=null?b:0,friends_interested_count:(N=v.friends_interested_count)!=null?N:0,recommendation_reason:v.recommendation_reason||void 0,recommendation_context:v.recommendation_context||void 0}});if(i!=null&&i.genres&&i.genres.length>0&&(x=x.filter(v=>{const _=v.genres||[];return i.genres.some(w=>_.some(b=>b.toLowerCase().includes(w.toLowerCase())||w.toLowerCase().includes(b.toLowerCase())))})),i!=null&&i.dateRange){const{from:v,to:_}=i.dateRange;(v||_)&&(x=x.filter(w=>{if(!w.event_date)return!1;const b=new Date(w.event_date);if(v&&b<v)return!1;if(_){const N=new Date(_);if(N.setHours(23,59,59,999),b>N)return!1}return!0}))}if(i!=null&&i.latitude&&(i!=null&&i.longitude)&&(i!=null&&i.radiusMiles)&&i.radiusMiles<50){const{filterEventsByRadius:v}=yield on(()=>E(this,null,function*(){const{filterEventsByRadius:w}=yield Promise.resolve().then(()=>lpe);return{filterEventsByRadius:w}}),void 0,import.meta.url),_=x.length;x=v(x,i.latitude,i.longitude,i.radiusMiles),console.log(` Client-side radius filter: ${_} -> ${x.length} events (${i.radiusMiles}mi radius)`)}const g=f.length===r&&x.length>0;return console.log(` PreferencesV4Feed: Found ${x.length} events`,{hasMore:g,avgScore:x.length>0?x.reduce((v,_)=>v+(_.relevance_score||0),0)/x.length:0}),{events:x,hasMore:g}}catch(h){return console.error(" PreferencesV4Feed: Error in getFeed:",h),{events:[],hasMore:!1}}})}static getFeedPaginated(t,r=0,n=20,i,a=!1){return E(this,null,function*(){const o=r*n;return this.getFeed(t,n,o,i,a)})}}const OLe=({userId:e,onEventClick:t,filters:r,className:n,filterControls:i})=>{const[a,o]=y.useState([]),[l,c]=y.useState(!0),[d,u]=y.useState(!1),[h,f]=y.useState(!0),[p,x]=y.useState(0),[g,v]=y.useState(null),[_,w]=y.useState(!1),[b,N]=y.useState(new Set),[S,k]=y.useState(!1),[O,A]=y.useState(null),[T,$]=y.useState(!1),[R,F]=y.useState(null),{toast:D}=jr(),B=20,U=()=>E(void 0,null,function*(){if(e)try{const{data:G,error:X}=yield P.from("user_event_relationships").select("event_id").eq("user_id",e).eq("relationship_type","interested");if(X){console.error("Error loading all interested events:",X);return}const te=new Set;G&&G.forEach(se=>{se.event_id&&te.add(String(se.event_id))}),N(te),console.log(" PreferencesV4FeedSection: Loaded all interested events:",te.size)}catch(G){console.error("Error loading all interested events:",G)}});y.useEffect(()=>{e&&U()},[e]);const V=(G,X)=>E(void 0,null,function*(){if(X.stopPropagation(),!e)return;const se=!b.has(G);N(ue=>{const ye=new Set(ue);return se?ye.add(G):ye.delete(G),ye});try{yield Hn.setEventInterest(e,G,se),o(ue=>ue.map(ye=>ye.id===G?W(M({},ye),{user_is_interested:se}):ye)),D({title:se?"You're interested!":"Interest removed",description:se?"We'll notify you about this event":"You'll no longer receive notifications for this event"})}catch(ue){console.error("Error toggling interest:",ue),N(ye=>{const ne=new Set(ye);return se?ne.delete(G):ne.add(G),ne}),D({title:"Error",description:"Failed to update interest",variant:"destructive"})}}),Y=(G,X)=>{X.stopPropagation(),A(G),k(!0)},z=(G,X)=>{X.stopPropagation(),X.preventDefault(),console.log("Flag button clicked for event:",G.id,G.title),F(G),$(!0),console.log("Opening flag modal")},K=(G=0,X=!1,te)=>E(void 0,null,function*(){var se,ue,ye;try{G===0?(o([]),c(!0)):u(!0),v(null);let ne;if(r)if("genres"in r&&"selectedCities"in r){const ge=r,ie=ge.selectedCities&&ge.selectedCities.length>0?ge.selectedCities[0]:void 0;ie?ne={city:ie,genres:ge.genres,dateRange:ge.dateRange,includePast:!1,maxDaysAhead:(se=ge.dateRange)!=null&&se.to?Math.ceil((ge.dateRange.to.getTime()-new Date().getTime())/(1e3*60*60*24)):90,radiusMiles:ge.radiusMiles}:ge.latitude&&ge.longitude?ne={latitude:ge.latitude,longitude:ge.longitude,genres:ge.genres,dateRange:ge.dateRange,includePast:!1,maxDaysAhead:(ue=ge.dateRange)!=null&&ue.to?Math.ceil((ge.dateRange.to.getTime()-new Date().getTime())/(1e3*60*60*24)):90,radiusMiles:ge.radiusMiles}:ne={genres:ge.genres,dateRange:ge.dateRange,includePast:!1,maxDaysAhead:(ye=ge.dateRange)!=null&&ye.to?Math.ceil((ge.dateRange.to.getTime()-new Date().getTime())/(1e3*60*60*24)):90,radiusMiles:ge.radiusMiles}}else ne=r;const xe=yield TLe.getFeedPaginated(e,G,B,ne,te!==void 0?te:_);o(X?ge=>{const ie=new Set(ge.map(H=>H.id)),ee=xe.events.filter(H=>!ie.has(H.id));return[...ge,...ee]}:xe.events),f(xe.hasMore),x(G)}catch(ne){console.error("Error loading Preferences V4 feed:",ne),v("Failed to load recommendations")}finally{c(!1),u(!1)}});if(y.useEffect(()=>{K(0,!1)},[e,r&&"city"in r?r.city:void 0,r&&"selectedCities"in r?r.selectedCities:void 0,r&&"latitude"in r?r.latitude:void 0,r&&"longitude"in r?r.longitude:void 0,r&&"radiusMiles"in r?r.radiusMiles:void 0,r&&"genres"in r?r.genres:void 0,r&&"dateRange"in r?r.dateRange:void 0,r&&"includePast"in r?r.includePast:void 0,r&&"maxDaysAhead"in r?r.maxDaysAhead:void 0]),l&&a.length===0)return s.jsx("div",{className:n,children:s.jsx(yd,{text:"Loading recommendations...",size:"md"})});if(l&&p===0)return s.jsx("div",{className:n,children:s.jsx(yd,{text:"Loading recommendations...",size:"md"})});if(g&&a.length===0)return s.jsxs("div",{className:`text-center py-6 text-muted-foreground text-sm ${n}`,children:[s.jsx("p",{children:g}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>K(0,!1),className:"mt-2",children:"Try Again"})]});const Z=()=>{!d&&h&&K(p+1,!0)};return s.jsxs("div",{className:`space-y-4 ${n}`,children:[a.length>0?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:a.map((G,X)=>{let te;if(G.poster_image_url)te=G.poster_image_url;else if(G.images&&Array.isArray(G.images)&&G.images.length>0){const ue=G.images.find(ye=>(ye==null?void 0:ye.url)&&((ye==null?void 0:ye.ratio)==="16_9"||(ye==null?void 0:ye.width)&&ye.width>1e3))||G.images.find(ye=>ye==null?void 0:ye.url);te=ue==null?void 0:ue.url}const se=`${G.id||"event"}-${X}`;return s.jsx(J_,{event:{id:G.id||"",title:G.title||G.artist_name||"Event",artist_name:G.artist_name,venue_name:G.venue_name,event_date:G.event_date,venue_city:G.venue_city||void 0,image_url:te,poster_image_url:G.poster_image_url||void 0},interestedCount:(G.interested_count||0)+(b.has(G.id)||G.user_is_interested?1:0),isInterested:b.has(G.id)||G.user_is_interested||!1,onInterestClick:ue=>V(G.id,ue),onShareClick:ue=>Y(G,ue),onFlagClick:ue=>z(G,ue),onClick:()=>t==null?void 0:t(G.id)},se)})}):s.jsxs("div",{className:"text-center py-6 text-muted-foreground text-sm",children:[s.jsx("p",{children:"No personalized recommendations yet."}),s.jsx("p",{className:"text-xs mt-1",children:"Start following artists or marking events as interested!"})]}),a.length>0&&h&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(oe,{variant:"outline",size:"sm",onClick:Z,disabled:d,className:"flex items-center gap-2",children:d?s.jsxs(s.Fragment,{children:[s.jsx(wg,{variant:"spinner",size:"sm"}),"Loading..."]}):"Load More"})}),O&&s.jsx(JE,{event:O,currentUserId:e,isOpen:S,onClose:()=>{k(!1),A(null)}}),T&&R&&s.jsx(Jw,{open:T,onClose:()=>{console.log("Closing flag modal"),$(!1),F(null)},contentType:"event",contentId:R.id,contentTitle:R.title||"Event",onReportSubmitted:()=>{console.log("Report submitted"),$(!1),F(null),D({title:"Report Submitted",description:"Thank you for helping keep our community safe"})}})]})},RLe=({currentUserId:e,onNavigateToProfile:t,onNavigateToChat:r,onNavigateToNotifications:n,onViewChange:i})=>{var ce,Ee,Qe,vt,wt,Ht,Rt;const[a,o]=y.useState(null);y.useState("next_30_days");const[l,c]=y.useState(null),[d,u]=y.useState({genres:[],selectedCities:[],dateRange:{},showFilters:!1,radiusMiles:50,filterByFollowing:"all",daysOfWeek:[]});y.useRef(!1),y.useState(["Rock","Pop","Hip-Hop","Electronic","Jazz","Classical","Country","R&B","Reggae","Folk","Blues","Alternative","Indie","Punk","Metal","Funk","Soul","Gospel","Latin","World"]);const[h,f]=y.useState([]);y.useState([]);const[p,x]=y.useState([]),[g,v]=y.useState([]),[_,w]=y.useState([]);y.useState([]);const[b,N]=y.useState([]),[S,k]=y.useState(0),[O,A]=y.useState(0),[T,$]=y.useState(!0),[R,F]=y.useState(!0);y.useState([]),y.useState(new Set),y.useState(new Set),y.useState(new Set);const[D,B]=y.useState(new Set),[U,V]=y.useState([]);y.useState(!0);const[Y,z]=y.useState(!0),[K,Z]=y.useState(!0);y.useState(!0);const[G,X]=y.useState(!0);y.useState(!1);const[te,se]=y.useState(!1),[ue,ye]=y.useState([]),[ne,xe]=y.useState(!1),[ge,ie]=y.useState(null),[ee,H]=y.useState("recommended"),[le,Se]=y.useState(null),[ae,fe]=y.useState(null),[he,pe]=y.useState(!1),[Ae,qe]=y.useState(!1),[Fe,ve]=y.useState(null),[rt,Ve]=y.useState(!1);y.useState([]),y.useEffect(()=>{ut(),lt()},[e]),y.useEffect(()=>{const Te=()=>E(void 0,null,function*(){try{const $e=localStorage.getItem("selectedEvent");if($e){const Ie=JSON.parse($e);if(localStorage.removeItem("selectedEvent"),fe(Ie),Ie.id){const Ue=yield Hn.isUserInterested(e,Ie.id);qe(Ue)}setTimeout(()=>{pe(!0)},50)}}catch($e){console.error("Error loading selectedEvent from localStorage:",$e),localStorage.removeItem("selectedEvent")}});Te();const bt=$e=>{const Ie=$e.detail;Ie!=null&&Ie.event&&Te()};return window.addEventListener("open-event-details",bt),()=>{window.removeEventListener("open-event-details",bt)}},[e]),y.useEffect(()=>{E(void 0,null,function*(){try{const{data:bt}=yield P.rpc("get_available_cities_for_filter",{min_event_count:1,limit_count:500});bt&&f(bt.map($e=>$e.city_name))}catch(bt){console.error("Error loading cities:",bt)}})},[]),y.useEffect(()=>{console.log(" [HOME FEED] Feed type changed:",ee),ee==="trending"?(console.log(" [HOME FEED] Loading trending events..."),Ge(!0)):ee==="friends"?Ze(!0):ee==="group-chats"?(yt(),Le()):ee==="reviews"&&qt()},[ee]),y.useEffect(()=>{ee==="trending"&&Ge(!0)},[d.genres,d.selectedCities,d.dateRange]);const lt=()=>E(void 0,null,function*(){try{let Te=null,bt="Current Location";try{Te=yield Pi.getCurrentLocation();const We=yield Pi.reverseGeocode(Te.latitude,Te.longitude);We&&(bt=We)}catch(We){console.error("Error getting current location:",We)}const{data:$e}=yield P.from("users").select("location_city, latitude, longitude").eq("user_id",e).single();let Ie,Ue,dt;if($e!=null&&$e.location_city){Ie=$e.location_city;try{const{RadiusSearchService:We}=yield on(()=>E(void 0,null,function*(){const{RadiusSearchService:Ye}=yield Promise.resolve().then(()=>oS);return{RadiusSearchService:Ye}}),void 0,import.meta.url),St=yield We.getCityCoordinates($e.location_city);St&&(Ue=St.lat,dt=St.lng)}catch(We){console.error("Error converting city to coordinates:",We)}}else if($e!=null&&$e.latitude&&($e!=null&&$e.longitude)){Ue=$e.latitude,dt=$e.longitude;try{const We=yield Pi.reverseGeocode($e.latitude,$e.longitude);We&&(Ie=We)}catch(We){console.error("Error reverse geocoding specified location:",We)}}const be=Ue||(Te==null?void 0:Te.latitude),Re=dt||(Te==null?void 0:Te.longitude);be&&Re?(Se({latitude:be,longitude:Re,radiusMiles:50,locationName:bt,specifiedLocationName:Ie,specifiedLatitude:Ue,specifiedLongitude:dt}),u(We=>W(M({},We),{latitude:be,longitude:Re,radiusMiles:We.radiusMiles||50,selectedCities:[]}))):Te&&(Se({latitude:Te.latitude,longitude:Te.longitude,radiusMiles:50,locationName:bt}),u(We=>W(M({},We),{latitude:Te.latitude,longitude:Te.longitude,radiusMiles:We.radiusMiles||50,selectedCities:[]})))}catch(Te){console.error("Error loading feed location:",Te)}}),ut=()=>E(void 0,null,function*(){try{const{data:Te,error:bt}=yield P.from("users").select("location_city").eq("user_id",e).single();if(bt)throw bt;if(Te!=null&&Te.location_city){o(Te.location_city);try{const{RadiusSearchService:$e}=yield on(()=>E(void 0,null,function*(){const{RadiusSearchService:Ue}=yield Promise.resolve().then(()=>oS);return{RadiusSearchService:Ue}}),void 0,import.meta.url),Ie=yield $e.getCityCoordinates(Te.location_city);Ie&&c(Ie)}catch($e){console.error("Error getting city coordinates:",$e)}}else o(null)}catch(Te){console.error("Error loading user city:",Te),o(null)}}),Ze=(Te=!1)=>E(void 0,null,function*(){Te&&(A(0),z(!0));try{const[$e,Ie]=yield Promise.all([jy.getFirstDegreeNetworkEvents(e,(O+1)*10),jy.getSecondDegreeNetworkEvents(e,(O+1)*8)]);Te?(x($e.slice(0,10)),v(Ie.slice(0,8))):(x(dt=>[...dt,...$e.slice(O*10,(O+1)*10)]),v(dt=>[...dt,...Ie.slice(O*8,(O+1)*8)]));const Ue=$e.length+Ie.length;F(Ue>(O+1)*18)}catch(bt){console.error("Error loading network events:",bt),Te&&(x([]),v([]))}finally{z(!1)}}),qt=()=>E(void 0,null,function*(){Z(!0);try{const Te=yield jy.getNetworkReviews(e,20);w(Te)}catch(Te){console.error("Error loading reviews:",Te),w([])}finally{Z(!1)}}),lr=Te=>{console.log(" [FILTER] applyFiltersToEvents called:",{eventCount:Te.length,filters:{selectedCities:d.selectedCities,dateRange:d.dateRange,genres:d.genres}});const bt=Te.filter(($e,Ie)=>{if(d.dateRange.from||d.dateRange.to){if(!$e.event_date)return console.log(` [FILTER] Event ${Ie} filtered out: no event_date`),!1;const Ue=new Date($e.event_date);if(d.dateRange.from&&Ue<d.dateRange.from)return console.log(` [FILTER] Event ${Ie} filtered out: before date range`,Ue),!1;if(d.dateRange.to){const dt=new Date(d.dateRange.to);if(dt.setHours(23,59,59,999),Ue>dt)return console.log(` [FILTER] Event ${Ie} filtered out: after date range`,Ue),!1}}if(d.genres&&d.genres.length>0){const Ue=($e.genres||[]).map(be=>be.toLowerCase());if(Ue.length===0)return console.log(` [FILTER] Event ${Ie} filtered out: no genres`),!1;if(!d.genres.some(be=>Ue.some(Re=>Re.includes(be.toLowerCase())||be.toLowerCase().includes(Re))))return console.log(` [FILTER] Event ${Ie} filtered out: genre mismatch`,{eventGenres:Ue,filterGenres:d.genres}),!1}return!0});return console.log(" [FILTER] applyFiltersToEvents result:",{inputCount:Te.length,outputCount:bt.length}),bt},Ge=(Te=!1)=>E(void 0,null,function*(){console.log(" [TRENDING] loadTrendingEvents called",{reset:Te,trendingPage:S,cityCoordinates:l}),Te&&(k(0),X(!0));try{console.log(" [TRENDING] Calling getTrendingEvents with params:",{userId:e,cityLat:l==null?void 0:l.lat,cityLng:l==null?void 0:l.lng,radiusMiles:50,limit:(S+1)*12,activeCity:a});const $e=yield jy.getTrendingEvents(e,l==null?void 0:l.lat,l==null?void 0:l.lng,50,(S+1)*12,a||void 0);console.log(" [TRENDING] getTrendingEvents returned:",{eventCount:$e.length,events:$e});const Ie=lr($e);console.log(" [TRENDING] After applying filters:",{filteredCount:Ie.length}),Te?(N(Ie.slice(0,12)),console.log(" [TRENDING] Set trending events (reset):",Ie.slice(0,12).length)):N(Ue=>{const dt=[...Ue,...Ie.slice(S*12,(S+1)*12)];return console.log(" [TRENDING] Set trending events (append):",{prevCount:Ue.length,newCount:dt.length}),dt}),$(Ie.length>(S+1)*12),console.log(" [TRENDING] Load complete:",{hasMore:Ie.length>(S+1)*12})}catch(bt){console.error(" [TRENDING] Error loading trending events:",bt),Te&&N([])}finally{X(!1),console.log(" [TRENDING] Loading state set to false")}}),Le=()=>E(void 0,null,function*(){try{const Te=yield fu.getRecommendedFriends(e);ye(Te)}catch(Te){console.error("Error loading friend suggestions for rail:",Te),ye([])}}),yt=()=>E(void 0,null,function*(){se(!0);try{console.log(" Loading recommended chats for user:",e);const{data:Te,error:bt}=yield P.rpc("get_recommended_chats",{p_user_id:e,p_limit:20,p_offset:0,p_radius_miles:50});if(bt)throw console.error(" Error calling get_recommended_chats:",bt),bt;console.log(" Raw recommended chats from RPC:",Te);const $e=(Te||[]).filter(Ie=>!D.has(Ie.chat_id)).map(Ie=>{let Ue=0;if(Ie.member_count!=null&&Ie.member_count!==void 0){const dt=Ie.member_count;if(typeof dt=="number")Ue=Math.max(0,Math.floor(dt));else{const be=String(dt).replace(/[^0-9]/g,""),Re=parseInt(be,10);!isNaN(Re)&&Re>=0&&(Ue=Re)}}return Ue=Number(Ue),(isNaN(Ue)||Ue<0)&&(Ue=0),{id:Ie.chat_id,chat_name:Ie.chat_name||Ie.entity_name||"Unnamed Group",member_count:Ue,friends_in_chat_count:0,entity_type:Ie.entity_type,entity_name:Ie.entity_name,entity_image_url:Ie.entity_image_url,relevance_score:Ie.relevance_score,distance_miles:Ie.distance_miles}});console.log(" Loaded recommended chats:",$e.length),console.log(" Member counts:",$e.map(Ie=>({id:Ie.id,name:Ie.chat_name,member_count:Ie.member_count,type:typeof Ie.member_count}))),V($e)}catch(Te){console.error(" Error loading recommended group chats:",Te),V([])}finally{se(!1)}}),Ne=Te=>E(void 0,null,function*(){try{const{data:bt}=yield P.from("events").select("*").eq("id",Te).single();if(bt){fe(bt);const $e=yield Hn.isUserInterested(e,bt.id);qe($e),pe(!0)}}catch(bt){console.error("Error fetching event details:",bt)}}),Oe=[{value:"recommended",label:"Hand Picked Events"},{value:"trending",label:"Trending Events"},{value:"friends",label:"Friends Interested"},{value:"group-chats",label:"Recommended Group Chats"},{value:"reviews",label:"Reviews"}];return s.jsxs("div",{className:"min-h-screen bg-[#fcfcfc]",style:{paddingTop:"env(safe-area-inset-top, 0px)",paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))"},children:[s.jsx("div",{className:"bg-[#fcfcfc] border-b border-gray-200",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-3 flex items-center justify-between",children:s.jsx("div",{className:"flex-1 flex justify-center",children:s.jsxs(o4,{children:[s.jsx(l4,{asChild:!0,children:s.jsxs(oe,{variant:"outline",className:"flex items-center gap-2 bg-white","data-tour":"feed-toggle",children:[((ce=Oe.find(Te=>Te.value===ee))==null?void 0:ce.label)||"Hand Picked Events",s.jsx(Qi,{className:"h-4 w-4"})]})}),s.jsx(p1,{className:"bg-white",children:Oe.map(Te=>s.jsx(jo,{onClick:()=>H(Te.value),children:Te.label},Te.value))})]})})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 pb-6",children:[le&&s.jsxs("div",{className:"mb-3 flex items-center justify-between gap-4 text-xs text-gray-600 bg-white rounded-md px-3 py-2 border border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx("span",{className:"font-medium text-gray-700",children:"Location:"}),s.jsx("span",{className:"truncate",children:le.locationName||"Not set"})]}),le.specifiedLocationName&&s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx("span",{className:"font-medium text-gray-700",children:"Specified:"}),s.jsx("span",{className:"truncate",children:le.specifiedLocationName})]})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[s.jsx("span",{className:"font-medium text-gray-700",children:"Radius:"}),s.jsx("select",{value:le.radiusMiles,onChange:Te=>{const bt=parseInt(Te.target.value,10);Se($e=>$e?W(M({},$e),{radiusMiles:bt}):null),u($e=>W(M({},$e),{radiusMiles:bt}))},className:"text-xs border border-gray-300 rounded px-2 py-1 bg-white text-gray-700 focus:outline-none focus:ring-1 focus:ring-gray-400",children:[1,5,10,15,20,25,30,40,50].map(Te=>s.jsxs("option",{value:Te,children:[Te," mi"]},Te))})]})]}),ee==="recommended"&&s.jsx(OLe,{userId:e,onEventClick:Ne,filters:d}),ee==="trending"&&s.jsx("div",{className:"space-y-4",children:G&&b.length===0?s.jsx(yd,{text:"Loading trending events...",size:"md"}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:b.map(Te=>s.jsx(J_,{event:{id:Te.event_id,title:Te.title,artist_name:Te.artist_name,venue_name:Te.venue_name,event_date:Te.event_date,venue_city:Te.venue_city||void 0,image_url:Te.event_media_url||void 0},onClick:()=>Ne(Te.event_id),onFlagClick:()=>{ie({id:Te.event_id,title:Te.title}),xe(!0)}},Te.event_id))}),T&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(oe,{variant:"outline",onClick:()=>{k(Te=>Te+1),Ge(!1)},disabled:G,children:G?s.jsxs(s.Fragment,{children:[s.jsx(wg,{variant:"spinner",size:"sm"}),"Loading..."]}):"Load More"})})]})}),ee==="friends"&&s.jsx("div",{className:"space-y-4",children:Y&&p.length===0&&g.length===0?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(yd,{})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:[...p,...g].map(Te=>s.jsx(J_,{event:{id:Te.event_id,title:Te.title,artist_name:Te.artist_name,venue_name:Te.venue_name,event_date:Te.event_date,venue_city:Te.venue_city||void 0},onClick:()=>Ne(Te.event_id)},Te.event_id))}),R&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(oe,{variant:"outline",onClick:()=>{A(Te=>Te+1),Ze(!1)},disabled:Y,children:Y?s.jsxs(s.Fragment,{children:[s.jsx(wg,{variant:"spinner",size:"sm"}),"Loading..."]}):"Load More"})})]})}),ee==="group-chats"&&s.jsx("div",{className:"flex items-center justify-center py-24",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx(Wn,{className:"w-12 h-12 mx-auto text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Coming Soon"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Group chats are still in development"})]})}),!1,ee==="reviews"&&s.jsx("div",{className:"space-y-4",children:K?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(yd,{})}):_.length===0?s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:s.jsx("p",{children:"No reviews yet. Be the first to review an event!"})}):s.jsx("div",{className:"space-y-3",children:_.map(Te=>s.jsx(ALe,{review:{id:Te.id,author:{id:Te.author.id,name:Te.author.name,avatar_url:Te.author.avatar_url},created_at:Te.created_at,rating:Te.rating,content:Te.content,photos:Te.photos,event_info:Te.event_info},onClick:()=>{var $e;const bt={id:Te.id,type:"review",title:(($e=Te.event_info)==null?void 0:$e.artist_name)||"Review",author:Te.author,created_at:Te.created_at,content:Te.content,rating:Te.rating,photos:Te.photos,event_info:Te.event_info,relevance_score:0};ve(bt),Ve(!0)}},Te.id))})})]}),he&&ae&&s.jsx(Cc,{isOpen:he,onClose:()=>{pe(!1),fe(null)},event:ae,currentUserId:e,isInterested:Ae,onInterestToggle:(Te,bt)=>E(void 0,null,function*(){try{yield Hn.setEventInterest(e,Te,bt),qe(bt)}catch($e){console.error("Error toggling interest:",$e)}}),onReview:()=>{console.log("Review event:",ae.id)},onNavigateToProfile:t,onNavigateToChat:r}),rt&&Fe&&s.jsx(tn,{open:rt,onOpenChange:Ve,children:s.jsxs(Xr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(an,{className:"sr-only",children:"Review Details"}),s.jsxs(Kn,{className:"sr-only",children:["Detailed view of ",Fe.author.name,"'s review"]}),s.jsx(L2,{review:{id:Fe.review_id||Fe.id,user_id:Fe.author.id,event_id:((Ee=Fe.event_info)==null?void 0:Ee.event_id)||"",rating:Fe.rating||0,review_text:Fe.content||"",is_public:(Qe=Fe.is_public)!=null?Qe:!0,created_at:Fe.created_at,updated_at:Fe.updated_at||Fe.created_at,likes_count:Fe.likes_count||0,comments_count:Fe.comments_count||0,shares_count:Fe.shares_count||0,is_liked_by_user:Fe.is_liked||!1,reaction_emoji:"",photos:Fe.photos||[],videos:[],mood_tags:[],genre_tags:[],context_tags:[],artist_name:(vt=Fe.event_info)==null?void 0:vt.artist_name,artist_id:(wt=Fe.event_info)==null?void 0:wt.artist_id,venue_name:(Ht=Fe.event_info)==null?void 0:Ht.venue_name,venue_id:(Rt=Fe.event_info)==null?void 0:Rt.venue_id,artist_performance_rating:Fe.artist_performance_rating,production_rating:Fe.production_rating,venue_rating:Fe.venue_rating,location_rating:Fe.location_rating,value_rating:Fe.value_rating,artist_performance_feedback:Fe.artist_performance_feedback,production_feedback:Fe.production_feedback,venue_feedback:Fe.venue_feedback,location_feedback:Fe.location_feedback,value_feedback:Fe.value_feedback},currentUserId:e,onLike:()=>E(void 0,null,function*(){}),onComment:()=>{},onShare:()=>{},userProfile:{name:Fe.author.name,avatar_url:Fe.author.avatar_url,verified:Fe.author.verified,account_type:Fe.author.account_type}})]})}),ge&&s.jsx(JU,{isOpen:ne,onClose:()=>{xe(!1),ie(null)},contentType:"event",contentId:ge.id,contentTitle:ge.title})]})};class H5{static registerToken(t,r="ios",n,i){return E(this,null,function*(){try{const{error:a}=yield P.rpc("register_device_token",{p_device_token:t,p_platform:r,p_device_id:n,p_app_version:i});if(a)throw a;console.log(" Device token registered successfully")}catch(a){throw console.error(" Error registering device token:",a),a}})}static unregisterToken(t){return E(this,null,function*(){try{const{error:r}=yield P.rpc("unregister_device_token",{p_device_token:t});if(r)throw r;console.log(" Device token unregistered successfully")}catch(r){console.error(" Error unregistering device token:",r)}})}static getStoredToken(){return typeof window=="undefined"?null:localStorage.getItem("device_token")}static storeToken(t){typeof window!="undefined"&&localStorage.setItem("device_token",t)}static initialize(){return E(this,null,function*(){var r;if(this.initialized){console.log("Push notifications already initialized");return}if(typeof window=="undefined"){console.log("Window not available, skipping push notification initialization");return}if(!((r=window.Capacitor)==null?void 0:r.isNativePlatform())){console.log("Not on native platform, skipping push notification initialization");return}try{const{PushNotifications:n}=yield on(()=>E(this,null,function*(){const{PushNotifications:a}=yield import("./index-vXeaLoWg.js");return{PushNotifications:a}}),[],import.meta.url);if((yield n.requestPermissions()).receive==="granted")yield n.register(),console.log(" Push notifications registered");else{console.log(" Push notification permission denied");return}n.addListener("registration",a=>E(this,null,function*(){var l;console.log(" Device token received:",a.value),this.storeToken(a.value);const o=((l=window.Capacitor)==null?void 0:l.getPlatform())==="ios"?(yield on(()=>E(this,null,function*(){const{App:c}=yield import("./index-CWEBDTBD.js");return{App:c}}),[],import.meta.url)).App.getInfo().then(c=>c.version):void 0;yield this.registerToken(a.value,"ios",void 0,yield o)})),n.addListener("registrationError",a=>{console.error(" Push notification registration error:",a)}),n.addListener("pushNotificationReceived",a=>{console.log(" Push notification received:",a)}),n.addListener("pushNotificationActionPerformed",a=>E(this,null,function*(){console.log(" Push notification action performed:",a);const o=a.notification.data;o!=null&&o.type&&(yield this.handleNotificationNavigation(o))})),window.addEventListener("DeviceTokenReceived",a=>E(this,null,function*(){var l,c;const o=((l=a.detail)==null?void 0:l.token)||((c=a.detail)==null?void 0:c.token);o&&(console.log(" Device token received via native event:",o),this.storeToken(o),yield this.registerToken(o,"ios"))})),window.addEventListener("PushNotificationTapped",a=>E(this,null,function*(){const o=a.detail||a.detail;o&&(yield this.handleNotificationNavigation(o))})),this.initialized=!0,console.log(" Push notification service initialized")}catch(n){console.error(" Error initializing push notifications:",n)}})}static handleNotificationNavigation(t){return E(this,null,function*(){try{const{type:r,chat_id:n,event_id:i,sender_id:a}=t,{useRouter:o}=yield on(()=>E(this,null,function*(){const{useRouter:l}=yield Promise.resolve().then(()=>fne);return{useRouter:l}}),void 0,import.meta.url);switch(r){case"friend_request":a&&(window.location.href=`/profile/${a}`);break;case"message":n&&(window.location.href=`/chat/${n}`);break;case"event_interest":case"event_reminder_1_week":case"event_reminder_3_days":case"event_reminder_1_day":case"event_reminder_day_after":case"artist_new_event":case"venue_new_event":(i||t.event_id)&&(window.location.href=`/event/${i||t.event_id}`);break;default:window.location.href="/notifications"}}catch(r){console.error("Error handling notification navigation:",r)}})}static cleanup(){return E(this,null,function*(){const t=this.getStoredToken();t&&(yield this.unregisterToken(t),localStorage.removeItem("device_token")),this.initialized=!1})}}_r(H5,"initialized",!1);const MLe=({onSignOut:e})=>{const[t,r]=y.useState("feed"),[n,i]=y.useState([]),[a,o]=y.useState(void 0),[l,c]=y.useState(void 0),[d,u]=y.useState(void 0),[h,f]=y.useState(!1),[p,x]=y.useState(!1),{toast:g}=jr(),{user:v,session:_,loading:w,sessionExpired:b,signOut:N,resetSessionExpired:S}=os(),{accountInfo:k}=Wu();$xe(),y.useEffect(()=>{ll.restoreState();const fe=ll.subscribe(he=>{if(he.status==="completed"&&he.serviceType){const pe=he.serviceType==="spotify"?"Spotify":"Apple Music";g({title:" Stats Ready!",description:`Your ${pe} streaming stats have been synced and are ready to view.`,action:s.jsx(uI,{altText:"View stats",onClick:()=>{window.location.href="/streaming-stats",localStorage.setItem("intendedView","profile")},className:"bg-pink-500 hover:bg-pink-600 text-white",children:"View Stats"})}),setTimeout(()=>{ll.clearSync()},1e3)}else he.status==="error"&&g({title:"Sync Error",description:`Failed to sync your ${he.serviceType==="spotify"?"Spotify":"Apple Music"} stats: ${he.error||"Unknown error"}`,variant:"destructive"})});return()=>{fe()}},[g]),y.useEffect(()=>{!w&&v&&E(void 0,null,function*(){if(!v)return;const he=yield mu.checkOnboardingStatus(v.id);he&&(!he.onboarding_completed&&!he.onboarding_skipped?r("onboarding"):he.onboarding_skipped&&!he.onboarding_completed?f(!0):he.onboarding_completed&&!he.tour_completed&&t==="feed"&&setTimeout(()=>x(!0),1500))})},[v,w,t]),y.useEffect(()=>(!w&&v&&H5.initialize().catch(fe=>{console.error("Failed to initialize push notifications:",fe)}),()=>{v||H5.cleanup().catch(fe=>{console.error("Failed to cleanup push notifications:",fe)})}),[v,w]),y.useEffect(()=>{V();const fe=window.location.hash;fe==="#onboarding"?(r("onboarding"),window.history.replaceState(null,"",window.location.pathname)):fe==="#profile"&&(r("profile"),window.history.replaceState(null,"",window.location.pathname));const he=localStorage.getItem("intendedView");he&&["feed","search","profile","onboarding"].includes(he)&&(r(he),localStorage.removeItem("intendedView"));const pe=Fe=>{(Fe.ctrlKey||Fe.metaKey)&&Fe.key==="l"&&(Fe.preventDefault(),A(!0))};window.addEventListener("keydown",pe);const Ae=Fe=>{const ve=Fe.detail;ve!=null&&ve.userId&&(o(ve.userId),r("profile"))},qe=Fe=>E(void 0,null,function*(){const ve=Fe.detail;if(ve!=null&&ve.event)localStorage.setItem("selectedEvent",JSON.stringify(ve.event)),r("feed");else if(ve!=null&&ve.eventId)try{const{data:rt,error:Ve}=yield P.from("events").select("*").eq("id",ve.eventId).single();rt&&!Ve&&(localStorage.setItem("selectedEvent",JSON.stringify(rt)),r("feed"))}catch(rt){console.error("Error fetching event:",rt)}});return window.addEventListener("open-user-profile",Ae),window.addEventListener("open-event-details",qe),()=>{window.removeEventListener("keydown",pe),window.removeEventListener("open-user-profile",Ae),window.removeEventListener("open-event-details",qe)}},[]),y.useEffect(()=>{b&&(g({title:"Session Expired",description:"Your session has expired. Please sign in again.",variant:"destructive"}),r("feed"),A(!0))},[b,g]),y.useEffect(()=>{const fe=he=>{var pe,Ae;(Ae=(pe=he.detail)==null?void 0:pe.message)!=null&&Ae.includes("Invalid API key")&&(A(!0),g({title:"Configuration Error",description:"Please check your Supabase configuration and sign in again.",variant:"destructive"}))};return window.addEventListener("api-error",fe),()=>window.removeEventListener("api-error",fe)},[g]);const[O,A]=y.useState(!1),[T,$]=y.useState(!1),[R,F]=y.useState(!1),[D,B]=y.useState(!1);K$(D);const U=()=>E(void 0,null,function*(){A(!1),S()}),V=()=>E(void 0,null,function*(){try{if(b||!v)return;const{data:fe,error:he}=yield P.from("events").select("*").order("event_date",{ascending:!0});if(he)throw he;const pe=(fe||[]).map(Ae=>({id:Ae.id,title:Ae.title||Ae.event_name||"Untitled Event",venue:Ae.venue||Ae.location||"Unknown Venue",date:Ae.event_date||Ae.date||new Date().toISOString().split("T")[0],time:Ae.event_time||Ae.time||"TBD",category:"music",description:Ae.description||"No description available",image:Ae.image||Cz(Ae.id||Ae.title||Ae.event_name||"synth-event"),price:Ae.event_price||void 0,attendeeCount:Math.floor(Math.random()*100)+1}));i(pe)}catch(fe){g({title:"Error",description:"Failed to load events",variant:"destructive"})}}),Y=fe=>{r(fe),fe==="profile"?t==="profile"&&o(void 0):o(void 0),fe!=="chat"&&c(void 0)},z=()=>{r("profile-edit")},K=()=>{$(!0)},Z=()=>{r("profile")},G=()=>E(void 0,null,function*(){try{yield N(),A(!1),$(!1),g({title:"Signed out",description:"You've been successfully signed out."})}catch(fe){g({title:"Error",description:"Failed to sign out. Please try again.",variant:"destructive"})}}),X=()=>{r("feed"),c(void 0)},te=()=>{r("notifications")},se=fe=>E(void 0,null,function*(){try{const{data:he,error:pe}=yield P.from("events").select("*").eq("id",fe).single();if(pe){console.error("Error fetching event:",pe),g({title:"Error",description:"Failed to load event details",variant:"destructive"});return}he&&(localStorage.setItem("selectedEvent",JSON.stringify(he)),r("feed"),window.dispatchEvent(new CustomEvent("open-event-details",{detail:{event:he}})))}catch(he){console.error("Error navigating to event:",he),g({title:"Error",description:"Failed to load event",variant:"destructive"})}}),ue=fe=>{window.location.href=`/artist/${encodeURIComponent(fe)}`},ye=fe=>{window.location.href=`/venue/${encodeURIComponent(fe)}`},ne=(fe,he)=>{o(void 0),fe&&fe!=="timeline"&&fe!=="interested"&&fe!=="passport"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(fe)&&o(fe),r("profile"),he?sessionStorage.setItem("profileTab",he==="timeline"?"passport":he):sessionStorage.removeItem("profileTab")},xe=fe=>{fe.includes("-")&&fe.length===36?(u(fe),c(void 0)):(c(fe),u(void 0)),r("chat")},ge=()=>{B(!D)},ie=()=>{B(!1)},ee=()=>E(void 0,null,function*(){if(r("feed"),f(!1),v){const fe=yield mu.checkOnboardingStatus(v.id);fe&&!fe.tour_completed&&setTimeout(()=>x(!0),1e3)}}),H=()=>{x(!1)};if(w)return s.jsx(GE,{text:"Loading Synth..."});if(O||b||!(v!=null&&v.id))return s.jsx(Pz,{onAuthSuccess:U});const le=!1,Se=()=>{switch(t){case"onboarding":return s.jsx(Ixe,{onComplete:ee});case"feed":return s.jsx(RLe,{currentUserId:v.id,onNavigateToNotifications:te,onNavigateToProfile:ne,onNavigateToChat:xe,onViewChange:Y});case"search":return s.jsx(PLe,{currentUserId:v.id,onBack:X,onNavigateToProfile:ne,onNavigateToChat:xe,onNavigateToNotifications:te,onViewChange:Y});case"profile":return s.jsx(Dpe,{currentUserId:v.id,profileUserId:a,onBack:X,onEdit:z,onSettings:K,onSignOut:G,onNavigateToProfile:ne,onNavigateToChat:xe,onNavigateToNotifications:te,onViewChange:Y});case"profile-edit":return s.jsx(Ipe,{currentUserId:v.id,onBack:()=>r("profile"),onSave:Z});case"notifications":return s.jsx(Ype,{currentUserId:v.id,onBack:X,onNavigateToProfile:ne,onNavigateToEvent:se,onNavigateToArtist:ue,onNavigateToVenue:ye});case"chat":return s.jsx(YB,{currentUserId:v.id,onBack:X});case"analytics":if(!k)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-gray-600",children:"Loading account information..."})})});switch(console.log(" MainApp: Account info for analytics:",k),console.log(" MainApp: Account type:",k.account_type),k.account_type){case"creator":return console.log(" MainApp: Rendering CreatorAnalyticsDashboard"),s.jsx(C$e,{});case"business":return console.log(" MainApp: Rendering BusinessAnalyticsDashboard"),s.jsx(A$e,{});case"admin":return console.log(" MainApp: Rendering AdminAnalyticsDashboard"),s.jsx(R$e,{});default:return console.log(" MainApp: Unknown account type, showing not available message"),s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-gray-600",children:"Analytics not available for your account type."}),s.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Account type: ",k.account_type]})]})})}case"events":return s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsx(Zpe,{})});default:return s.jsx(hpe,{currentUserId:v.id,onBack:X,onViewChange:Y,onNavigateToNotifications:te,onNavigateToProfile:ne,onNavigateToChat:xe})}};if(t==="onboarding")return Se();const ae=["feed","search","profile","chat"].includes(t);return s.jsxs("div",{className:"min-h-screen",style:{paddingBottom:"max(5rem, calc(5rem + env(safe-area-inset-bottom, 0px)))",backgroundColor:"transparent"},children:[s.jsx($ie,{menuOpen:D,onMenuClick:ge}),h&&s.jsx(e0e,{onComplete:()=>r("onboarding")}),le,s.jsx("div",{className:ae?"pb-[100px]":"pb-20",children:Se()}),ae&&s.jsx(O7,{currentView:t,onViewChange:Y,onOpenEventReview:()=>F(!0)}),!ae&&t!=="profile-edit"&&s.jsx(O7,{currentView:t,onViewChange:Y,onOpenEventReview:()=>F(!0)}),s.jsx(Y$,{isOpen:D,onClose:ie,onToggle:ge,onNavigateToNotifications:te,onNavigateToProfile:ne,onNavigateToSettings:()=>$(!0),onNavigateToVerification:()=>{ne()}}),s.jsx(Gpe,{isOpen:T,onClose:()=>$(!1),onSignOut:G,userEmail:v==null?void 0:v.email}),(v==null?void 0:v.id)&&s.jsx(MF,{isOpen:R,onClose:()=>F(!1),event:{id:"new-review"},userId:v.id,onReviewSubmitted:()=>{F(!1)}}),s.jsx(Hve,{run:p,onFinish:H,onViewChange:Y})]})},DLe=()=>(console.log(" App component is rendering..."),s.jsx(MLe,{}));function ILe({}){const{artistId:e}=Ow(),t=ci(),r=Md(),{user:n}=os(),[i,a]=y.useState([]),[o,l]=y.useState(""),[c,d]=y.useState(!0),[u,h]=y.useState(null),f=ae=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(ae),[p,x]=y.useState(null),[g,v]=y.useState(!1),[_,w]=y.useState({totalReviews:0,averageRating:0,loading:!0}),[b,N]=y.useState([]),[S,k]=y.useState(""),[O,A]=y.useState(""),[T,$]=y.useState(!1),[R,F]=y.useState("newest"),[D,B]=y.useState("all"),[U,V]=y.useState("date"),[Y,z]=y.useState("asc"),K=ae=>typeof ae.rating=="number"?ae.rating:0,Z=ae=>E(this,null,function*(){try{let fe=null,he=ae?decodeURIComponent(ae):"";if(ae&&f(ae)){fe=ae;const{data:Ge}=yield P.from("artists").select("id, name, image_url").eq("id",fe).maybeSingle();Ge&&(l(Ge.name),Ge.image_url&&A(Ge.image_url))}else{const{data:Ge}=yield P.from("artists").select("id, name, image_url").ilike("name",`%${he}%`).limit(1).maybeSingle();Ge?(fe=Ge.id,l(Ge.name),Ge.image_url&&A(Ge.image_url)):l(he)}let pe=[];if(fe){const{data:Ge,error:Le}=yield P.from("events").select("id").eq("artist_id",fe).limit(1e3);!Le&&Ge&&(pe=Ge)}if(pe.length===0&&he){const{data:Ge,error:Le}=yield P.from("events").select("id").ilike("artist_name",`${he}%`).limit(500);!Le&&Ge&&(pe=Ge)}if(pe.length===0&&he){const{data:Ge,error:Le}=yield P.from("events").select("id").ilike("artist_name",`%${he}%`).limit(500);if(Le){console.error("Error fetching event IDs for artist:",Le);return}Ge&&(pe=Ge)}const Ae=pe.map(Ge=>Ge.id);if(Ae.length===0){if(!O&&!artistDataForEvents){const{data:Ge}=yield P.from("artists").select("id, name, jambase_artist_id, image_url").ilike("name",o).maybeSingle();Ge!=null&&Ge.image_url&&A(Ge.image_url)}w({totalReviews:0,averageRating:0,loading:!1}),N([]);return}const{data:qe,error:Fe}=yield P.from("reviews").select(`
          id,
          user_id,
          event_id,
          rating,
          review_text,
          created_at,
          mood_tags,
          genre_tags,
          photos
        `).eq("is_public",!0).eq("is_draft",!1).in("event_id",Ae);if(Fe){console.error("Error fetching artist reviews:",Fe);return}const ve=(qe==null?void 0:qe.map(Ge=>Ge.event_id).filter(Boolean))||[],rt=new Map;if(ve.length>0){const{data:Ge}=yield P.from("events").select("id, venue_name, event_date, title, artist_id").in("id",ve),Le=[...new Set((Ge==null?void 0:Ge.map(Ne=>Ne.artist_id).filter(Boolean))||[])],yt=new Map;if(Le.length>0){const{data:Ne}=yield P.from("artists").select("id, name").in("id",Le);Ne==null||Ne.forEach(Oe=>yt.set(Oe.id,Oe.name))}Ge&&Ge.forEach(Ne=>{rt.set(Ne.id,Ne)})}const Ve=(qe==null?void 0:qe.map(Ge=>Ge.user_id).filter(Boolean))||[],{data:lt}=yield P.from("users").select("user_id, name, avatar_url").in("user_id",Ve),ut=(qe==null?void 0:qe.map(Ge=>{const Le=lt==null?void 0:lt.find(Oe=>Oe.user_id===Ge.user_id),yt=rt.get(Ge.event_id),Ne=yt!=null&&yt.artist_id?artistMap.get(yt.artist_id):"";return{id:Ge.id,user_id:Ge.user_id,event_id:Ge.event_id,rating:Ge.rating,review_text:Ge.review_text,created_at:Ge.created_at,reviewer_name:(Le==null?void 0:Le.name)||"Anonymous",reviewer_avatar:(Le==null?void 0:Le.avatar_url)||null,event_title:(yt==null?void 0:yt.title)||"",event_date:(yt==null?void 0:yt.event_date)||"",venue_name:(yt==null?void 0:yt.venue_name)||"",artist_name:Ne||"",mood_tags:Ge.mood_tags||[],genre_tags:Ge.genre_tags||[],photos:Ge.photos||[],category_average:K(Ge)}}))||[],Ze=ut.map(Ge=>{var Le;return(Le=Ge.category_average)!=null?Le:K(Ge)}).filter(Ge=>typeof Ge=="number"&&Ge>0),qt=Ze.length,lr=qt>0?Ze.reduce((Ge,Le)=>Ge+Le,0)/qt:0;if(w({totalReviews:qt,averageRating:lr,loading:!1}),N(ut),!O&&!artistDataForEvents){const{data:Ge}=yield P.from("artists").select("id, name, jambase_artist_id, image_url").ilike("name",o).maybeSingle();Ge&&(k(""),Ge.image_url&&A(Ge.image_url))}else k("");if(!O&&!artistDataForEvents){const{data:Ge}=yield P.from("artists").select("id, name, jambase_artist_id, image_url").eq("name",o).maybeSingle();Ge!=null&&Ge.image_url&&A(Ge.image_url)}}catch(fe){console.error("Error fetching artist profile:",fe),w(he=>W(M({},he),{loading:!1}))}});y.useEffect(()=>{if(!e){h("No artist ID provided"),d(!1);return}X()},[e]),y.useEffect(()=>{e&&Z(e)},[e]);const G=e?decodeURIComponent(e):"",X=()=>E(this,null,function*(){try{d(!0),h(null);const ae=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(G);let fe=G,he=G;if(ae){const{data:Ze,error:qt}=yield P.from("artists").select("id, name, image_url, jambase_artist_id").eq("id",G).maybeSingle();!qt&&Ze?(Ze.jambase_artist_id&&(he=Ze.jambase_artist_id),Ze.name&&(fe=Ze.name),console.log(" Found artist from UUID:",{name:fe,jambaseId:he}),Ze.image_url&&A(Ze.image_url)):console.warn(" Could not find artist by UUID, will try to use as JamBase ID")}let pe=null,Ae=null;if(ae){const Ze=yield P.from("events").select("*").eq("artist_id",G).order("event_date",{ascending:!0});pe=Ze.data,Ae=Ze.error}if(!pe||pe.length===0){const{data:Ze,error:qt}=yield P.from("artists").select("id, name").ilike("name",fe).maybeSingle();if(!qt&&(Ze!=null&&Ze.id)){const{data:lr,error:Ge}=yield P.from("events").select("*").eq("artist_id",Ze.id).order("event_date",{ascending:!0});!Ge&&lr&&lr.length>0?(pe=lr,Ae=null,fe=Ze.name):pe||(pe=lr||[],Ae=Ge)}else pe||(pe=[],Ae=null)}if(Ae)throw Ae;if(ae&&G&&!fe){const{data:Ze}=yield P.from("artists").select("name").eq("id",G).maybeSingle();Ze!=null&&Ze.name&&(fe=Ze.name)}const qe=[...new Set((pe||[]).map(Ze=>Ze.artist_id).filter(Boolean))],Fe=new Map;if(qe.length>0){const{data:Ze}=yield P.from("artists").select("id, name").in("id",qe);Ze==null||Ze.forEach(qt=>Fe.set(qt.id,qt.name))}const rt=[...(pe||[]).map(Ze=>W(M({},Ze),{artist_name:Fe.get(Ze.artist_id)||fe||"",source:Ze.source||"jambase"}))],Ve=te(rt);Ve.sort((Ze,qt)=>new Date(Ze.event_date).getTime()-new Date(qt.event_date).getTime()),a(Ve);let lt=fe;if((!lt||lt===G)&&ae&&G){const{data:Ze}=yield P.from("artists").select("name").eq("id",G).maybeSingle();Ze!=null&&Ze.name&&(lt=Ze.name)}(!lt||lt===G||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(lt))&&(lt="Unknown Artist"),l(lt);let ut=!1;if(ae&&G){const{data:Ze}=yield P.from("artists").select("id, name, image_url, jambase_artist_id").eq("id",G).maybeSingle();Ze!=null&&Ze.image_url&&(A(Ze.image_url),ut=!0)}if(!ut&&lt){const{data:Ze}=yield P.from("artists").select("id, name, image_url, jambase_artist_id").ilike("name",lt).maybeSingle();Ze!=null&&Ze.image_url&&A(Ze.image_url)}}catch(ae){console.error("Error fetching artist events:",ae),h("Failed to load artist events")}finally{d(!1)}}),te=ae=>{const fe=new Map;return ae.filter(he=>{var rt;const Ae=(he.artist_name||"").toLowerCase().trim(),qe=(he.venue_name||"").toLowerCase().replace(/\s+/g," ").replace(/\bthe\s+/gi,"").replace(/[^\w\s]/g,"").trim(),Fe=((rt=he.event_date)==null?void 0:rt.split("T")[0])||"",ve=`${Ae}|${qe}|${Fe}`;return fe.has(ve)?!1:(fe.set(ve,he),!0)})},se=ae=>new Date(ae).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),ue=ae=>new Date(ae).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),ye=ae=>{const fe=[],he=Math.floor(ae),pe=ae%1>=.5;for(let qe=0;qe<he;qe++)fe.push(s.jsx(Jt,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},qe));pe&&fe.push(s.jsx(Jt,{className:"w-4 h-4 fill-yellow-400/50 text-yellow-400"},"half"));const Ae=5-Math.ceil(ae);for(let qe=0;qe<Ae;qe++)fe.push(s.jsx(Jt,{className:"w-4 h-4 text-gray-300"},`empty-${qe}`));return fe},ne=(ae,fe)=>{const he=[...ae];switch(fe){case"newest":return he.sort((pe,Ae)=>new Date(Ae.created_at).getTime()-new Date(pe.created_at).getTime());case"oldest":return he.sort((pe,Ae)=>new Date(pe.created_at).getTime()-new Date(Ae.created_at).getTime());case"highest_rating":return he.sort((pe,Ae)=>{var ve,rt;const qe=(ve=pe.category_average)!=null?ve:K(pe);return(((rt=Ae.category_average)!=null?rt:K(Ae))||0)-(qe||0)});case"lowest_rating":return he.sort((pe,Ae)=>{var ve,rt;const qe=(ve=pe.category_average)!=null?ve:K(pe),Fe=(rt=Ae.category_average)!=null?rt:K(Ae);return(qe||0)-(Fe||0)});default:return he}},xe=(ae,fe)=>{if(fe==="all")return ae;const he=parseInt(fe.split("_")[0]);return ae.filter(pe=>{var qe;const Ae=(qe=pe.category_average)!=null?qe:K(pe);return Math.floor(Ae)===he})},ge=ae=>new Date(ae).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),ie=ae=>new Date(ae)>=new Date,ee=ae=>{const fe=[ae.venue_city,ae.venue_state].filter(Boolean);return fe.length>0?fe.join(", "):"Location TBD"},H=ae=>{x(ae),v(!0)};if(c)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading artist events..."})]})})})});if(u)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:u}),s.jsxs(oe,{onClick:()=>t(-1),children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})})})});const Se=((ae,fe)=>[...ae].sort((he,pe)=>{var qe,Fe;let Ae=0;switch(fe){case"date":Ae=new Date(he.event_date).getTime()-new Date(pe.event_date).getTime();break;case"location":const ve=`${he.venue_city||""}, ${he.venue_state||""}`.trim(),rt=`${pe.venue_city||""}, ${pe.venue_state||""}`.trim();Ae=ve.localeCompare(rt);break;case"price":const Ve=parseFloat(((qe=he.price_range)==null?void 0:qe.replace(/[^0-9.]/g,""))||"0"),lt=parseFloat(((Fe=pe.price_range)==null?void 0:Fe.replace(/[^0-9.]/g,""))||"0");Ae=Ve-lt;break}return Y==="asc"?Ae:-Ae}))(i.filter(ae=>ie(ae.event_date)),U);return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50 overflow-x-hidden w-full max-w-full",children:[s.jsxs("div",{className:"container mx-auto px-4 py-8 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs(oe,{variant:"ghost",onClick:()=>{var he,pe;const ae=(he=r.state)==null?void 0:he.fromFeed,fe=(pe=r.state)==null?void 0:pe.eventId;console.log(" ArtistEvents: Back button clicked"),console.log(" ArtistEvents: fromFeed:",ae),console.log(" ArtistEvents: eventId:",fe),fe&&(localStorage.setItem("reopenEventId",fe),console.log(" ArtistEvents: Stored eventId in localStorage:",fe)),ae?(console.log(" ArtistEvents: Navigating to",ae),t(ae)):(console.log(" ArtistEvents: No fromFeed, navigating to /"),t("/"))},className:"mb-4 hover-button",children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex-shrink-0",children:s.jsx(Ct,{className:"w-6 h-6 text-white"})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("h1",{className:"text-2xl font-bold gradient-text break-words truncate",children:o||"Unknown Artist"})}),(n==null?void 0:n.id)&&s.jsx(Tv,{artistName:o,userId:n.id,variant:"outline",size:"sm",showFollowerCount:!1,className:"flex-shrink-0"})]}),o&&s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>window.open(`https://open.spotify.com/search/${encodeURIComponent(o)}`,"_blank"),className:"flex items-center gap-1.5 hover:bg-green-50 hover:border-green-300 text-xs px-2 py-1 h-7",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-sm flex items-center justify-center",children:s.jsx("span",{className:"text-white text-[8px] font-bold",children:""})}),s.jsx("span",{className:"text-xs",children:"Spotify"})]}),s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>window.open(`https://music.apple.com/search?term=${encodeURIComponent(o)}`,"_blank"),className:"flex items-center gap-1.5 hover:bg-gray-50 hover:border-gray-400 text-xs px-2 py-1 h-7",children:[s.jsx("div",{className:"w-3 h-3 bg-black rounded-sm flex items-center justify-center",children:s.jsx("span",{className:"text-white text-[8px] font-bold",children:""})}),s.jsx("span",{className:"text-xs",children:"Apple Music"})]}),s.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:"All events for this artist"})]}),s.jsx("div",{className:"flex items-center gap-2 text-sm",children:s.jsxs(Be,{variant:"default",className:"bg-green-100 text-green-800",children:[Se.length," Upcoming"]})})]}),s.jsxs("div",{className:"mb-8 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx(He,{children:s.jsxs(st,{className:"p-3 text-center",children:[s.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:ye(_.averageRating)}),s.jsx("div",{className:"text-xl font-bold text-gray-900",children:_.averageRating.toFixed(1)}),s.jsx("div",{className:"text-xs text-gray-600",children:"Average Rating"})]})}),s.jsx(He,{children:s.jsxs(st,{className:"p-3 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-gray-900",children:_.totalReviews}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Reviews"})]})}),s.jsx(He,{children:s.jsxs(st,{className:"p-3 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-pink-600",children:Se.length}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Events"})]})})]}),S&&s.jsx(He,{children:s.jsxs(st,{className:"p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-3",children:["About ",o]}),s.jsx("p",{className:"text-gray-700 leading-relaxed",children:S})]})}),_.totalReviews>0&&s.jsx(He,{children:s.jsxs(st,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Jt,{className:"w-5 h-5 text-yellow-500"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Reviews"})]}),s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>$(!T),className:"flex items-center gap-1",children:[T?s.jsx(al,{className:"w-4 h-4"}):s.jsx(Qi,{className:"w-4 h-4"}),T?"Hide":"View"," Reviews"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[ye(_.averageRating),s.jsx("span",{className:"text-sm font-medium",children:_.averageRating.toFixed(1)}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",_.totalReviews," review",_.totalReviews!==1?"s":"",")"]})]}),T&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(xw,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Filter by rating:"}),s.jsxs(Xs,{value:D,onValueChange:ae=>B(ae),children:[s.jsx(Ds,{className:"w-32",children:s.jsx(Js,{})}),s.jsxs(Is,{children:[s.jsx(Lt,{value:"all",children:"All Ratings"}),s.jsx(Lt,{value:"5_star",children:"5 Stars"}),s.jsx(Lt,{value:"4_star",children:"4 Stars"}),s.jsx(Lt,{value:"3_star",children:"3 Stars"}),s.jsx(Lt,{value:"2_star",children:"2 Stars"}),s.jsx(Lt,{value:"1_star",children:"1 Star"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),s.jsxs(Xs,{value:R,onValueChange:ae=>F(ae),children:[s.jsx(Ds,{className:"w-40",children:s.jsx(Js,{})}),s.jsxs(Is,{children:[s.jsx(Lt,{value:"newest",children:"Newest"}),s.jsx(Lt,{value:"oldest",children:"Oldest"}),s.jsx(Lt,{value:"highest_rating",children:"Highest Rating"}),s.jsx(Lt,{value:"lowest_rating",children:"Lowest Rating"})]})]})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:ne(xe(b,D),R).map(ae=>{var fe,he;return s.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs(Vr,{className:"w-8 h-8",children:[s.jsx(Qr,{src:ae.reviewer_avatar||void 0}),s.jsx(qr,{className:"text-xs",children:ae.reviewer_name.charAt(0).toUpperCase()})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-sm",children:ae.reviewer_name}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(Et,{className:"w-3 h-3"}),ge(ae.event_date)]}),ae.venue_name&&s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx(Xt,{className:"w-3 h-3"}),ae.venue_name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[ye((fe=ae.category_average)!=null?fe:K(ae)),s.jsx("span",{className:"text-sm font-medium ml-1",children:((he=ae.category_average)!=null?he:K(ae)).toFixed(1)})]})]}),ae.review_text&&s.jsx("p",{className:"text-sm text-gray-700",children:ae.review_text}),ae.mood_tags&&ae.mood_tags.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:ae.mood_tags.map((pe,Ae)=>s.jsx(Be,{variant:"secondary",className:"text-xs",children:pe},Ae))})]},ae.id)})})]})]})})]}),Se.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-2xl font-semibold gradient-text",children:"Upcoming Events"}),s.jsxs(Xs,{value:U,onValueChange:ae=>V(ae),children:[s.jsx(Ds,{className:"w-24 h-8 text-xs",children:s.jsx(Js,{})}),s.jsxs(Is,{children:[s.jsx(Lt,{value:"date",children:"Date"}),s.jsx(Lt,{value:"location",children:"Location"}),s.jsx(Lt,{value:"price",children:"Price"})]})]})]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 w-full max-w-full overflow-x-hidden",children:Se.map(ae=>s.jsx(He,{className:"overflow-hidden cursor-pointer w-full max-w-full min-w-0 hover:shadow-md transition-shadow",onClick:()=>H(ae),children:s.jsxs("div",{className:"p-2 w-full max-w-full overflow-x-hidden",children:[s.jsx("h3",{className:"font-semibold text-xs mb-1 line-clamp-2 break-words min-h-[32px]",children:ae.title}),s.jsxs("div",{className:"space-y-1 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[s.jsx(Et,{className:"w-3 h-3 text-pink-500 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:se(ae.event_date)})]}),s.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[s.jsx(ai,{className:"w-3 h-3 text-pink-500 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:ue(ae.event_date)})]}),s.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[s.jsx(Xt,{className:"w-3 h-3 text-pink-500 flex-shrink-0"}),s.jsx("span",{className:"truncate text-muted-foreground",children:ee(ae)})]})]}),ae.genres&&ae.genres.length>0&&s.jsx("div",{className:"flex flex-wrap gap-0.5",children:ae.genres.slice(0,2).map((fe,he)=>s.jsx(Be,{variant:"secondary",className:"text-[10px] px-1 py-0 h-4",children:fe},he))})]})},ae.id))})]}),i.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ct,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Events Found"}),s.jsxs("p",{className:"text-muted-foreground mb-4",children:["No events found for ",o||"this artist","."]}),s.jsxs(oe,{onClick:()=>t(-1),children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})]}),s.jsx(Cc,{event:p,currentUserId:(n==null?void 0:n.id)||"",isOpen:g,onClose:()=>{v(!1),x(null)}})]})}delete oU.Icon.Default.prototype._getIconUrl;oU.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});function $Le({}){const{venueId:e}=Ow(),t=ci(),r=Md(),{user:n}=os(),[i,a]=y.useState([]),[o,l]=y.useState(""),[c,d]=y.useState(""),[u,h]=y.useState(!0),[f,p]=y.useState(null),[x,g]=y.useState(null),[v,_]=y.useState(!1),[w,b]=y.useState({totalReviews:0,averageRating:0,loading:!0}),[N,S]=y.useState([]),[k,O]=y.useState(""),[A,T]=y.useState(""),[$,R]=y.useState(""),[F,D]=y.useState(""),[B,U]=y.useState(""),[V,Y]=y.useState(""),[z,K]=y.useState(null),[Z,G]=y.useState(""),[X,te]=y.useState(!1),[se,ue]=y.useState("newest"),[ye,ne]=y.useState("all"),[xe,ge]=y.useState(null),[ie,ee]=y.useState("date"),[H,le]=y.useState("asc"),Se=Le=>typeof Le.rating=="number"?Le.rating:0,ae=Le=>E(this,null,function*(){var yt;try{const{data:Ne,error:Oe}=yield P.from("reviews").select(`
          id,
          user_id,
          event_id,
          rating,
          venue_rating,
          artist_performance_rating,
          production_rating,
          location_rating,
          value_rating,
          artist_performance_feedback,
          production_feedback,
          venue_feedback,
          location_feedback,
          value_feedback,
          ticket_price_paid,
          review_text,
          created_at,
          mood_tags,
          genre_tags,
          photos,
          was_there,
          is_public,
          is_draft
        `).eq("is_public",!0).eq("is_draft",!1).not("review_text","is",null).neq("review_text","ATTENDANCE_ONLY");if(Oe){console.error("Error fetching venue reviews:",Oe);return}const ce=(Ne==null?void 0:Ne.map(Ue=>Ue.event_id).filter(Boolean))||[],Ee=new Map;if(ce.length>0){const{data:Ue}=yield P.from("events").select("id, venue_uuid, artist_name, event_date, title, venue_city, venue_state").in("id",ce);if(Ue){const dt=Ue.map(Re=>Re.venue_uuid).filter(Boolean);let be=new Map;if(dt.length>0){const{data:Re}=yield P.from("venues").select("id, name").in("id",dt);Re==null||Re.forEach(We=>{be.set(We.id,We.name)})}Ue.forEach(Re=>{const We=Re.venue_uuid?be.get(Re.venue_uuid):null;Ee.set(Re.id,W(M({},Re),{venue_name:We}))})}}const Qe=(Ne||[]).filter(Ue=>{var be;const dt=Ee.get(Ue.event_id);return dt&&((be=dt.venue_name)==null?void 0:be.toLowerCase().includes(Le.toLowerCase()))}),vt=(Qe==null?void 0:Qe.map(Ue=>Ue.user_id).filter(Boolean))||[],{data:wt}=yield P.from("users").select("user_id, name, avatar_url").in("user_id",vt),Ht=(Qe==null?void 0:Qe.map(Ue=>{const dt=wt==null?void 0:wt.find(Re=>Re.user_id===Ue.user_id),be=Ee.get(Ue.event_id);return{id:Ue.id,rating:Ue.rating,venue_rating:Ue.venue_rating,artist_performance_rating:Ue.artist_performance_rating,production_rating:Ue.production_rating,location_rating:Ue.location_rating,value_rating:Ue.value_rating,artist_performance_feedback:Ue.artist_performance_feedback,production_feedback:Ue.production_feedback,venue_feedback:Ue.venue_feedback,location_feedback:Ue.location_feedback,value_feedback:Ue.value_feedback,ticket_price_paid:Ue.ticket_price_paid,review_text:Ue.review_text,created_at:Ue.created_at,reviewer_name:(dt==null?void 0:dt.name)||"Anonymous",reviewer_avatar:(dt==null?void 0:dt.avatar_url)||null,event_title:(be==null?void 0:be.title)||"",event_date:(be==null?void 0:be.event_date)||"",artist_name:(be==null?void 0:be.artist_name)||"",mood_tags:Ue.mood_tags||[],genre_tags:Ue.genre_tags||[],photos:Array.isArray(Ue.photos)?Ue.photos:[],category_average:Ue.rating}}))||[],Rt=Ht.map(Ue=>{var dt;return(dt=Ue.rating)!=null?dt:null}).filter(Ue=>typeof Ue=="number"&&Ue>0),Te=Rt.length,bt=Te>0?Rt.reduce((Ue,dt)=>Ue+dt,0)/Te:0;b({totalReviews:Te,averageRating:bt,loading:!1}),S(Ht);let $e=null;if(Le)try{const{data:Ue,error:dt}=yield P.from("venues").select("id, name, url, image_url").ilike("name",`%${Le}%`).limit(1).maybeSingle();!dt&&Ue?$e=Ue:dt&&console.debug("Venue query failed (non-critical):",dt.message||dt)}catch(Ue){console.debug("Venue query exception (non-critical):",(Ue==null?void 0:Ue.message)||Ue)}$e?(console.log(" Venue data found:",$e),O($e.address||""),T($e.city||""),R($e.state||""),D($e.zip||""),U(""),Y($e.url||""),K(null),G($e.image_url||"")):(console.log(" No venue data found in database for:",Le),Le.toLowerCase().includes("masquerade")&&(O("695 North Ave NE"),T("Atlanta"),R("GA"),D("30308")));let Ie="";if($e!=null&&$e.address&&($e!=null&&$e.city)&&($e!=null&&$e.state))Ie=`${$e.address}, ${$e.city}, ${$e.state}${$e.zip?` ${$e.zip}`:""}`;else if(i.length>0){const Ue=i[0];Ue.venue_city&&Ue.venue_state&&(Ie=`${Le}, ${Ue.venue_city}, ${Ue.venue_state}`)}if(Ie)try{if(Ie.toLowerCase().includes("atlanta"))console.log(" Setting Atlanta coordinates for venue:",Le),ge({lat:33.749,lng:-84.388});else{const Ue=(yt=Ie.split(",")[1])==null?void 0:yt.trim().toLowerCase();if(Ue){const dt=Pi.searchCity(Ue);dt&&ge({lat:dt.lat,lng:dt.lng})}}}catch(Ue){console.error("Error getting venue coordinates:",Ue)}}catch(Ne){console.error("Error fetching venue profile:",Ne),b(Oe=>W(M({},Oe),{loading:!1}))}});y.useEffect(()=>{if(!e){p("No venue ID provided"),h(!1);return}pe()},[e]),y.useEffect(()=>{o&&ae(o)},[o]),y.useEffect(()=>{E(this,null,function*(){if(!xe&&i.length>0&&o){const yt=i[0];if(yt.venue_city&&yt.venue_state){const Ne=`${o}, ${yt.venue_city}, ${yt.venue_state}`;try{if(Ne.toLowerCase().includes("atlanta"))console.log(" Setting Atlanta coordinates from events for venue:",o),ge({lat:33.749,lng:-84.388});else{const Oe=yt.venue_city.toLowerCase(),ce=Pi.searchCity(Oe);ce&&ge({lat:ce.lat,lng:ce.lng})}}catch(Oe){console.error("Error getting coordinates from events:",Oe)}}}})},[i,o,xe]);const fe=e?decodeURIComponent(e):"",he=Le=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(Le),pe=()=>E(this,null,function*(){try{h(!0),p(null);let Le=null,yt=null,Ne=fe,Oe="Location TBD",ce=null;if(e&&he(e)){ce=e;const{data:wt}=yield P.from("venues").select("id, name, state, street_address").eq("id",ce).maybeSingle();if(wt){Ne=wt.name;const Ht=[wt.street_address,wt.state].filter(Boolean);Oe=Ht.length>0?Ht.join(", "):"Location TBD"}}else{let wt=null;const{data:Ht}=yield P.from("venues").select("id, name, state, street_address").ilike("name",`%${fe}%`).limit(5);if(Ht&&Ht.length>0&&(wt=Ht.find(Te=>Te.name.toLowerCase()===fe.toLowerCase())||Ht[0]),wt){ce=wt.id,Ne=wt.name;const Rt=[wt.street_address,wt.state].filter(Boolean);Oe=Rt.length>0?Rt.join(", "):"Location TBD"}}if(ce){const wt=yield P.from("events").select("*").eq("venue_id",ce).order("event_date",{ascending:!0});Le=wt.data,yt=wt.error}else Le=[],yt=null,console.warn(`Venue not found: ${fe}`);if(yt)throw yt;d(Oe);const Qe=[...(Le||[]).map(wt=>W(M({},wt),{source:"manual"}))],vt=Ae(Qe);if(vt.sort((wt,Ht)=>new Date(wt.event_date).getTime()-new Date(Ht.event_date).getTime()),a(vt),l(Ne||fe||"Unknown Venue"),vt.length>0){const wt=vt[0],Ht=[wt.venue_city,wt.venue_state].filter(Boolean);d(Ht.length>0?Ht.join(", "):"Location TBD")}}catch(Le){console.error("Error fetching venue events:",Le),p("Failed to load venue events")}finally{h(!1)}}),Ae=Le=>{const yt=new Map;return Le.filter(Ne=>{var wt;const Oe=(Ne.artist_name||"").toLowerCase().trim(),Ee=(Ne.venue_name||`${Ne.venue_city||""} ${Ne.venue_state||""}`.trim()||Ne.venue_uuid||"").toLowerCase().replace(/\s+/g," ").replace(/\bthe\s+/gi,"").replace(/[^\w\s]/g,"").trim(),Qe=((wt=Ne.event_date)==null?void 0:wt.split("T")[0])||"",vt=`${Oe}|${Ee}|${Qe}`;return yt.has(vt)?(yt.get(vt),!1):(yt.set(vt,Ne),!0)})},qe=Le=>new Date(Le).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),Fe=Le=>new Date(Le).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),ve=Le=>{const yt=[],Ne=Math.floor(Le),Oe=Le%1>=.5;for(let Ee=0;Ee<Ne;Ee++)yt.push(s.jsx(Jt,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},Ee));Oe&&yt.push(s.jsx(Jt,{className:"w-4 h-4 fill-yellow-400/50 text-yellow-400"},"half"));const ce=5-Math.ceil(Le);for(let Ee=0;Ee<ce;Ee++)yt.push(s.jsx(Jt,{className:"w-4 h-4 text-gray-300"},`empty-${Ee}`));return yt},rt=(Le,yt)=>{const Ne=[...Le];switch(yt){case"newest":return Ne.sort((Oe,ce)=>new Date(ce.created_at).getTime()-new Date(Oe.created_at).getTime());case"oldest":return Ne.sort((Oe,ce)=>new Date(Oe.created_at).getTime()-new Date(ce.created_at).getTime());case"highest_rating":return Ne.sort((Oe,ce)=>{var Ee,Qe,vt,wt;return((Qe=(Ee=ce.venue_rating)!=null?Ee:ce.rating)!=null?Qe:0)-((wt=(vt=Oe.venue_rating)!=null?vt:Oe.rating)!=null?wt:0)});case"lowest_rating":return Ne.sort((Oe,ce)=>{var Ee,Qe,vt,wt;return((Qe=(Ee=Oe.venue_rating)!=null?Ee:Oe.rating)!=null?Qe:0)-((wt=(vt=ce.venue_rating)!=null?vt:ce.rating)!=null?wt:0)});default:return Ne}},Ve=(Le,yt)=>{if(yt==="all")return Le;const Ne=parseInt(yt.split("_")[0],10);return Le.filter(Oe=>{var Ee,Qe;const ce=(Qe=(Ee=Oe.venue_rating)!=null?Ee:Oe.rating)!=null?Qe:0;return Math.floor(ce)===Ne})},lt=Le=>new Date(Le).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),ut=Le=>new Date(Le)>=new Date,Ze=Le=>{const yt=[Le.venue_city,Le.venue_state].filter(Boolean);return yt.length>0?yt.join(", "):"Location TBD"},qt=Le=>{g(Le),_(!0)};if(u)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading venue events..."})]})})})});if(f)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:f}),s.jsxs(oe,{onClick:()=>t(-1),children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})})})});const Ge=((Le,yt)=>[...Le].sort((Ne,Oe)=>{var Ee,Qe;let ce=0;switch(yt){case"date":ce=new Date(Ne.event_date).getTime()-new Date(Oe.event_date).getTime();break;case"artist":ce=(Ne.artist_name||"").localeCompare(Oe.artist_name||"");break;case"price":const vt=parseFloat(((Ee=Ne.price_range)==null?void 0:Ee.replace(/[^0-9.]/g,""))||"0"),wt=parseFloat(((Qe=Oe.price_range)==null?void 0:Qe.replace(/[^0-9.]/g,""))||"0");ce=vt-wt;break}return H==="asc"?ce:-ce}))(i.filter(Le=>ut(Le.event_date)),ie);return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50 overflow-x-hidden w-full max-w-full",children:[s.jsxs("div",{className:"container mx-auto px-4 py-8 w-full max-w-full overflow-x-hidden",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs(oe,{variant:"ghost",onClick:()=>{var Ne,Oe;const Le=(Ne=r.state)==null?void 0:Ne.fromFeed,yt=(Oe=r.state)==null?void 0:Oe.eventId;yt&&localStorage.setItem("reopenEventId",yt),t(Le||"/")},className:"mb-4 hover-button",children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex-shrink-0",children:s.jsx(Ba,{className:"w-6 h-6 text-white"})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("h1",{className:"text-2xl font-bold gradient-text break-words truncate",children:o||"Unknown Venue"})}),(n==null?void 0:n.id)&&o&&s.jsx(Xw,{venueName:o,venueCity:A,venueState:$,userId:n.id,variant:"outline",size:"sm",showFollowerCount:!1,className:"flex-shrink-0"})]}),c&&s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("span",{className:"text-xs text-muted-foreground",children:"All events at this venue"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:""}),s.jsx("span",{className:"text-xs text-muted-foreground",children:c})]}),s.jsx("div",{className:"flex items-center gap-2 text-sm",children:s.jsxs(Be,{variant:"default",className:"bg-green-100 text-green-800",children:[Ge.length," Upcoming"]})})]}),s.jsxs("div",{className:"mb-8 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx(He,{children:s.jsxs(st,{className:"p-3 text-center",children:[s.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:ve(w.averageRating)}),s.jsx("div",{className:"text-xl font-bold text-gray-900",children:w.averageRating.toFixed(1)}),s.jsx("div",{className:"text-xs text-gray-600",children:"Average Rating"})]})}),s.jsx(He,{children:s.jsxs(st,{className:"p-3 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-gray-900",children:w.totalReviews}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Reviews"})]})}),s.jsx(He,{children:s.jsxs(st,{className:"p-3 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-pink-600",children:Ge.length}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Events"})]})})]}),w.totalReviews>0&&s.jsx(He,{children:s.jsxs(st,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Jt,{className:"w-5 h-5 text-yellow-500"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Reviews"})]}),s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>te(!X),className:"flex items-center gap-1",children:[X?s.jsx(al,{className:"w-4 h-4"}):s.jsx(Qi,{className:"w-4 h-4"}),X?"Hide":"View"," Reviews"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[ve(w.averageRating),s.jsx("span",{className:"text-sm font-medium",children:w.averageRating.toFixed(1)}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",w.totalReviews," review",w.totalReviews!==1?"s":"",")"]})]}),X&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(xw,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Filter by rating:"}),s.jsxs(Xs,{value:ye,onValueChange:Le=>ne(Le),children:[s.jsx(Ds,{className:"w-32",children:s.jsx(Js,{})}),s.jsxs(Is,{children:[s.jsx(Lt,{value:"all",children:"All Ratings"}),s.jsx(Lt,{value:"5_star",children:"5 Stars"}),s.jsx(Lt,{value:"4_star",children:"4 Stars"}),s.jsx(Lt,{value:"3_star",children:"3 Stars"}),s.jsx(Lt,{value:"2_star",children:"2 Stars"}),s.jsx(Lt,{value:"1_star",children:"1 Star"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium",children:"Sort by:"}),s.jsxs(Xs,{value:se,onValueChange:Le=>ue(Le),children:[s.jsx(Ds,{className:"w-40",children:s.jsx(Js,{})}),s.jsxs(Is,{children:[s.jsx(Lt,{value:"newest",children:"Newest"}),s.jsx(Lt,{value:"oldest",children:"Oldest"}),s.jsx(Lt,{value:"highest_rating",children:"Highest Rating"}),s.jsx(Lt,{value:"lowest_rating",children:"Lowest Rating"})]})]})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:rt(Ve(N,ye),se).map(Le=>{var yt,Ne;return s.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs(Vr,{className:"w-8 h-8",children:[s.jsx(Qr,{src:Le.reviewer_avatar||void 0}),s.jsx(qr,{className:"text-xs",children:Le.reviewer_name.charAt(0).toUpperCase()})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-sm",children:Le.reviewer_name}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(Et,{className:"w-3 h-3"}),lt(Le.event_date)]}),Le.artist_name&&s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx(Ct,{className:"w-3 h-3"}),Le.artist_name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[ve((yt=Le.category_average)!=null?yt:Se(Le)),s.jsx("span",{className:"text-sm font-medium ml-1",children:((Ne=Le.category_average)!=null?Ne:Se(Le)).toFixed(1)})]})]}),Le.review_text&&s.jsx("p",{className:"text-sm text-gray-700",children:Le.review_text}),typeof Le.ticket_price_paid=="number"&&Le.ticket_price_paid>0&&s.jsxs("div",{className:"text-xs text-gray-600 bg-gray-100 inline-flex px-2 py-1 rounded",children:["Ticket price (private): $",Le.ticket_price_paid.toFixed(2)]}),[{label:"Artist performance",rating:Le.artist_performance_rating,feedback:Le.artist_performance_feedback},{label:"Production",rating:Le.production_rating,feedback:Le.production_feedback,recommendation:Le.production_recommendation},{label:"Venue",rating:Le.venue_rating,feedback:Le.venue_feedback,recommendation:Le.venue_recommendation},{label:"Location",rating:Le.location_rating,feedback:Le.location_feedback,recommendation:Le.location_recommendation},{label:"Value",rating:Le.value_rating,feedback:Le.value_feedback,recommendation:Le.value_recommendation}].filter(({rating:Oe,feedback:ce})=>Oe||ce).map(({label:Oe,rating:ce,feedback:Ee})=>s.jsxs("div",{className:"text-sm border-l-4 border-blue-200 pl-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium text-gray-600",children:Oe}),typeof ce=="number"&&s.jsx("span",{className:"text-xs text-gray-500",children:ce.toFixed(1)})]}),Ee&&s.jsxs("div",{className:"text-xs text-gray-700 italic",children:["",Ee,""]})]},Oe)),Le.mood_tags&&Le.mood_tags.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:Le.mood_tags.map((Oe,ce)=>s.jsx(Be,{variant:"secondary",className:"text-xs",children:Oe},ce))})]},Le.id)})})]})]})})]}),Ge.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-2xl font-semibold gradient-text",children:"Upcoming Events"}),s.jsxs(Xs,{value:ie,onValueChange:Le=>ee(Le),children:[s.jsx(Ds,{className:"w-24 h-8 text-xs",children:s.jsx(Js,{})}),s.jsxs(Is,{children:[s.jsx(Lt,{value:"date",children:"Date"}),s.jsx(Lt,{value:"artist",children:"Artist"}),s.jsx(Lt,{value:"price",children:"Price"})]})]})]}),s.jsx("div",{className:"grid grid-cols-3 gap-2 w-full max-w-full overflow-x-hidden",children:Ge.map(Le=>s.jsx(He,{className:"overflow-hidden cursor-pointer w-full max-w-full min-w-0 hover:shadow-md transition-shadow",onClick:()=>qt(Le),children:s.jsxs("div",{className:"p-2 w-full max-w-full overflow-x-hidden",children:[s.jsx("h3",{className:"font-semibold text-xs mb-1 line-clamp-2 break-words min-h-[32px]",children:Le.title}),s.jsxs("div",{className:"space-y-1 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[s.jsx(Et,{className:"w-3 h-3 text-pink-500 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:qe(Le.event_date)})]}),s.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[s.jsx(ai,{className:"w-3 h-3 text-pink-500 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:Fe(Le.event_date)})]}),s.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[s.jsx(Xt,{className:"w-3 h-3 text-pink-500 flex-shrink-0"}),s.jsx("span",{className:"truncate text-muted-foreground",children:Ze(Le)})]})]}),Le.genres&&Le.genres.length>0&&s.jsx("div",{className:"flex flex-wrap gap-0.5",children:Le.genres.slice(0,2).map((yt,Ne)=>s.jsx(Be,{variant:"secondary",className:"text-[10px] px-1 py-0 h-4",children:yt},Ne))})]})},Le.id))})]}),i.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ba,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Events Found"}),s.jsxs("p",{className:"text-muted-foreground mb-4",children:["No events found for ",o||"this venue","."]}),s.jsxs(oe,{onClick:()=>t(-1),children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})]}),s.jsx(Cc,{event:x,currentUserId:(n==null?void 0:n.id)||"",isOpen:v,onClose:()=>{_(!1),g(null)}})]})}const LLe=()=>{const{user:e,loading:t}=os(),{toast:r}=jr(),[n,i]=y.useState(!0),[a,o]=y.useState(!1),[l,c]=y.useState(null),[d,u]=y.useState(null),[h,f]=y.useState("unknown"),[p,x]=y.useState(!1),[g,v]=y.useState(!1),[_,w]=y.useState("all_time");y.useState([]),y.useEffect(()=>{if(!t){if(!e){window.location.href="/";return}N()}},[e,t]),y.useEffect(()=>{if(e)if(l!==null){const T=Ez(l),$=T==="spotify"?"spotify":T==="apple-music"?"apple-music":"unknown";f($),$!=="unknown"?S():(i(!1),x(!0))}else l===null&&!g&&!n&&(v(!0),b())},[l,e]);const b=()=>E(void 0,null,function*(){e&&(i(!1),x(!0))}),N=()=>E(void 0,null,function*(){if(e)try{i(!0);const{data:T,error:$}=yield P.from("users").select("music_streaming_profile").eq("user_id",e.id).single();if($&&$.code!=="PGRST116"){console.error("Error loading profile:",$),c(null),i(!1),x(!0);return}const R=(T==null?void 0:T.music_streaming_profile)||null;c(R)}catch(T){console.error("Error in loadUserProfile:",T),c(null),i(!1),x(!0)}}),S=T=>E(void 0,null,function*(){if(!e||h==="unknown"){i(!1),x(!0);return}i(!1),x(!0)}),k=()=>E(void 0,null,function*(){try{if(!du.isConfigured()){r({title:"Spotify Not Configured",description:"Spotify integration is not available.",variant:"destructive"});return}yield du.authenticate()}catch(T){console.error("Error connecting Spotify:",T),r({title:"Connection Failed",description:"Failed to connect to Spotify. Please try again.",variant:"destructive"})}}),O=()=>E(void 0,null,function*(){try{o(!0),r({title:"Connecting to Apple Music",description:"Please authorize in the popup window..."}),yield Yp.authenticate(),ll.startSync("apple-music"),r({title:"Connected!",description:"Your stats are syncing in the background. You'll be notified when ready!"}),Yp.syncProfileData().then(()=>{ll.completeSync(),S(_),x(!1)}).catch(T=>{console.error("Background sync error:",T),ll.errorSync(T.message||"Sync failed")}),setTimeout(()=>{window.location.href="/",localStorage.setItem("intendedView","feed")},1500)}catch(T){console.error("Error connecting Apple Music:",T),ll.errorSync(T instanceof Error?T.message:"Connection failed"),r({title:"Connection Failed",description:"Failed to connect to Apple Music. Please try again.",variant:"destructive"}),o(!1)}}),A=()=>E(void 0,null,function*(){if(!(!e||h==="unknown"))try{if(o(!0),r({title:"Syncing Stats",description:"Fetching comprehensive streaming data... This may take a moment."}),h==="spotify"){if(!du.isAuthenticated()){r({title:"Not Connected",description:"Please connect your Spotify account first.",variant:"destructive"}),x(!0);return}yield du.syncUserMusicPreferences()}else if(h==="apple-music"){if(!Yp.checkStoredToken()){r({title:"Not Connected",description:"Please connect your Apple Music account first.",variant:"destructive"}),x(!0);return}const T=yield Yp.generateProfileData();if(T){yield Yp.uploadProfileData(T);const $=T.topArtists||[],R=T.topGenres||[],F={user_id:e.id,service_type:"apple-music",top_artists:$.map(D=>{var B;return{name:D.name||((B=D.attributes)==null?void 0:B.name)||"",popularity:D.popularity||0,id:D.id}}),top_genres:R.map(D=>({genre:typeof D=="string"?D:D.genre||"",count:typeof D=="string"?1:D.count||1})),total_tracks:T.totalTracks||0,unique_artists:$.length,total_listening_hours:T.totalListeningHours||0}}}yield S(_),x(!1),r({title:"Sync Complete",description:"Your streaming stats have been synced from your music service. Note: Stats are not stored permanently."})}catch(T){console.error("Error syncing stats:",T),r({title:"Sync Failed",description:"Failed to sync streaming stats. Please try again.",variant:"destructive"})}finally{o(!1)}});return t||n?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx("div",{className:"flex items-center justify-center py-20",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading streaming stats..."})]})})})}):e?p&&!d?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"flex items-center mb-6",children:s.jsxs(oe,{variant:"ghost",onClick:()=>{console.log(" StreamingStatsPage: Back button clicked"),window.location.href="/",localStorage.setItem("intendedView","profile")},children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back to Profile"]})}),s.jsxs(He,{className:"max-w-2xl mx-auto",children:[s.jsx(xr,{children:s.jsxs(Cr,{className:"flex items-center gap-2 text-2xl",children:[s.jsx(Ct,{className:"w-6 h-6 text-pink-500"}),"Connect Your Streaming Service"]})}),s.jsxs(st,{className:"text-center py-12 space-y-6",children:[s.jsx("div",{className:"w-20 h-20 bg-pink-100 rounded-full flex items-center justify-center mx-auto",children:s.jsx(Ct,{className:"w-10 h-10 text-pink-500"})}),s.jsx("h3",{className:"text-xl font-semibold",children:"Connect Your Music"}),s.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Connect your Spotify or Apple Music account to view your comprehensive streaming statistics and personalize your feed."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-8",children:[s.jsx(He,{className:"border-2 hover:border-green-500 transition-colors cursor-pointer",onClick:k,children:s.jsxs(st,{className:"pt-6",children:[s.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Ct,{className:"w-6 h-6 text-white"})}),s.jsx("h4",{className:"font-semibold mb-2",children:"Connect Spotify"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"View your top artists, tracks, and listening habits"}),s.jsxs(oe,{className:"w-full bg-green-500 hover:bg-green-600",children:[s.jsx(DP,{className:"w-4 h-4 mr-2"}),"Connect Spotify"]})]})}),s.jsx(He,{className:"border-2 hover:border-red-500 transition-colors cursor-pointer",onClick:O,children:s.jsxs(st,{className:"pt-6",children:[s.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Ct,{className:"w-6 h-6 text-white"})}),s.jsx("h4",{className:"font-semibold mb-2",children:"Connect Apple Music"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Sync your library and listening history"}),s.jsxs(oe,{className:"w-full bg-red-500 hover:bg-red-600",children:[s.jsx(DP,{className:"w-4 h-4 mr-2"}),"Connect Apple Music"]})]})})]})]})]})]})}):d||h!=="unknown"?s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs(oe,{variant:"ghost",onClick:()=>{window.location.href="/",localStorage.setItem("intendedView","profile")},children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-3",children:[a&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Sa,{className:"w-4 h-4 animate-spin text-pink-500"}),s.jsx("span",{children:"Syncing your stats..."})]}),s.jsxs(oe,{onClick:A,disabled:a,variant:"outline",className:"bg-pink-50 hover:bg-pink-100 border-pink-200",children:[s.jsx(Sa,{className:`w-4 h-4 mr-2 ${a?"animate-spin":""}`}),a?"Syncing...":"Refresh Stats"]})]})]}),s.jsx(He,{className:"mb-6",children:s.jsxs(st,{className:"pt-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-1",children:"Time Period"}),(d==null?void 0:d.last_updated)&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.jsx("span",{className:"font-medium text-pink-600",children:"Last synced:"})," ",Dt(new Date(d.last_updated),"MMM d, yyyy h:mm a"),s.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Data is permanently stored)"})]})]})}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["last_day","last_week","last_month","last_3_months","last_6_months","last_year","last_3_years","last_5_years","all_time"].map(T=>{const $=d!==null,R=_===T;return s.jsxs(oe,{variant:R?"default":"outline",size:"sm",disabled:!$||n,onClick:()=>E(void 0,null,function*(){R||(w(T),i(!0),yield S())}),className:R?"bg-pink-500 hover:bg-pink-600 text-white":$?"hover:bg-pink-50":"opacity-50 cursor-not-allowed",children:[T==="last_day"&&"Day",T==="last_week"&&"Week",T==="last_month"&&"Month",T==="last_3_months"&&"3 Months",T==="last_6_months"&&"6 Months",T==="last_year"&&"Year",T==="last_3_years"&&"3 Years",T==="last_5_years"&&"5 Years",T==="all_time"&&"All Time"]},T)})})]})}),s.jsx(He,{className:"mb-6 border-2",children:s.jsx(xr,{children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center ${h==="spotify"?"bg-green-500":"bg-red-500"}`,children:s.jsx(Ct,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{children:[s.jsxs(Cr,{className:"text-3xl",children:[h==="spotify"?"Spotify":"Apple Music"," Streaming Stats"]}),d&&s.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Last updated: ",Dt(new Date(d.last_updated),"PPp")]})]})]})})})}),d?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsx(He,{children:s.jsx(st,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx(FJ,{className:"w-6 h-6 text-pink-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Tracks"}),s.jsx("p",{className:"text-3xl font-bold",children:d.total_tracks})]})]})})}),s.jsx(He,{children:s.jsx(st,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx(li,{className:"w-6 h-6 text-pink-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Unique Artists"}),s.jsx("p",{className:"text-3xl font-bold",children:d.unique_artists})]})]})})}),s.jsx(He,{children:s.jsx(st,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx(ai,{className:"w-6 h-6 text-pink-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Listening Hours"}),s.jsx("p",{className:"text-3xl font-bold",children:Math.round(d.total_listening_hours)})]})]})})}),s.jsx(He,{children:s.jsx(st,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx(Bu,{className:"w-6 h-6 text-pink-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Top Genres"}),s.jsx("p",{className:"text-3xl font-bold",children:d.top_genres.length})]})]})})})]}),s.jsxs(Cl,{defaultValue:"artists",className:"space-y-4",children:[s.jsxs(Fo,{className:"grid w-full grid-cols-4",children:[s.jsx(Tn,{value:"artists",children:"Top Artists"}),s.jsx(Tn,{value:"tracks",children:"Top Tracks"}),s.jsx(Tn,{value:"genres",children:"Top Genres"}),s.jsx(Tn,{value:"insights",children:"Insights"})]}),s.jsx(On,{value:"artists",className:"space-y-4",children:s.jsxs(He,{children:[s.jsx(xr,{children:s.jsx(Cr,{children:"Your Top Artists"})}),s.jsx(st,{children:d.top_artists.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.top_artists.slice(0,20).map((T,$)=>s.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-lg border hover:bg-muted/50 transition-colors",children:[s.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-pink-400 to-purple-500 flex items-center justify-center text-white font-bold text-lg",children:$+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-lg truncate",children:T.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Popularity: ",T.popularity,"/100"]})]})]},T.id||T.name))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ct,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4 opacity-50"}),s.jsx("p",{className:"text-muted-foreground",children:"No artist data available. Sync your stats to see your top artists."})]})})]})}),s.jsx(On,{value:"tracks",className:"space-y-4",children:s.jsxs(He,{children:[s.jsx(xr,{children:s.jsx(Cr,{children:"Your Top Tracks"})}),s.jsx(st,{children:d.top_tracks&&d.top_tracks.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.top_tracks.slice(0,30).map((T,$)=>s.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-lg border hover:bg-muted/50 transition-colors",children:[s.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-purple-400 to-pink-500 flex items-center justify-center text-white font-bold text-lg",children:$+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-lg truncate",children:T.name||"Unknown Track"}),s.jsx("p",{className:"text-sm text-muted-foreground truncate",children:T.artist||"Unknown Artist"}),T.popularity!==void 0&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Popularity: ",T.popularity,"/100"]})]})]},T.id||`${T.name}-${$}`))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(PJ,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4 opacity-50"}),s.jsx("p",{className:"text-muted-foreground",children:"No track data available. Sync your stats to see your top tracks."})]})})]})}),s.jsx(On,{value:"genres",className:"space-y-4",children:s.jsxs(He,{children:[s.jsx(xr,{children:s.jsx(Cr,{children:"Your Top Genres"})}),s.jsx(st,{children:d.top_genres.length>0?s.jsx("div",{className:"space-y-3",children:d.top_genres.map((T,$)=>s.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border hover:bg-muted/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-pink-100 flex items-center justify-center text-pink-600 font-bold",children:$+1}),s.jsx("span",{className:"font-semibold text-lg",children:T.genre})]}),s.jsxs(Be,{variant:"secondary",className:"text-lg px-3 py-1",children:[T.count," ",T.count===1?"artist":"artists"]})]},T.genre))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Bu,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4 opacity-50"}),s.jsx("p",{className:"text-muted-foreground",children:"No genre data available. Sync your stats to see your top genres."})]})})]})}),s.jsx(On,{value:"insights",className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs(He,{children:[s.jsx(xr,{children:s.jsxs(Cr,{className:"flex items-center gap-2",children:[s.jsx(Sn,{className:"w-5 h-5"}),"Listening Activity"]})}),s.jsxs(st,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Tracks"}),s.jsx("p",{className:"text-2xl font-bold",children:d.total_tracks})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Estimated Listening Time"}),s.jsxs("p",{className:"text-2xl font-bold",children:[Math.round(d.total_listening_hours)," hours"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Artist Diversity"}),s.jsxs("p",{className:"text-2xl font-bold",children:[d.unique_artists," unique artists"]})]})]})]}),s.jsxs(He,{children:[s.jsx(xr,{children:s.jsxs(Cr,{className:"flex items-center gap-2",children:[s.jsx(RJ,{className:"w-5 h-5"}),"Music Preferences"]})}),s.jsxs(st,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Top Genre"}),d.top_genres.length>0?s.jsx(Be,{variant:"default",className:"text-lg px-3 py-1",children:d.top_genres[0].genre}):s.jsx("p",{className:"text-muted-foreground",children:"No data"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Top Artist"}),d.top_artists.length>0?s.jsx("p",{className:"text-lg font-semibold",children:d.top_artists[0].name}):s.jsx("p",{className:"text-muted-foreground",children:"No data"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Genre Diversity"}),s.jsxs("p",{className:"text-2xl font-bold",children:[d.top_genres.length," genres"]})]})]})]})]})})]})]}):s.jsx(He,{children:s.jsxs(st,{className:"py-12 text-center",children:[s.jsx("p",{className:"text-muted-foreground mb-4",children:"No stats available yet."}),s.jsxs(oe,{onClick:A,disabled:a,children:[s.jsx(Sa,{className:`w-4 h-4 mr-2 ${a?"animate-spin":""}`}),a?"Syncing...":"Sync Your Stats"]})]})})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs(oe,{variant:"ghost",onClick:()=>{window.location.href="/",localStorage.setItem("intendedView","profile")},className:"mb-6",children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx(He,{children:s.jsx(st,{className:"py-12 text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"Unable to load streaming stats."})})})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-b from-white to-beige-50 p-4",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx("div",{className:"flex items-center justify-center py-20",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"Please log in to view streaming stats."})})})})})};function ZO(){var ge;const e=ci(),{userId:t}=Ow(),{user:r}=os(),[n,i]=y.useState("artists"),[a,o]=y.useState([]),[l,c]=y.useState([]),[d,u]=y.useState(!0),[h,f]=y.useState(null),[p,x]=y.useState([]),[g,v]=y.useState(null),[_,w]=y.useState(null),[b,N]=y.useState(null),[S,k]=y.useState("events"),[O,A]=y.useState("date"),[T,$]=y.useState("asc"),[R,F]=y.useState("all"),D=t||(r==null?void 0:r.id)||"",B=!t||t===(r==null?void 0:r.id),U=((ge=r==null?void 0:r.user_metadata)==null?void 0:ge.name)||"User";y.useEffect(()=>{D&&(V(),Y())},[D]),y.useEffect(()=>{(a.length>0||l.length>0)&&z()},[O,T,R]);const V=()=>E(this,null,function*(){try{u(!0),f(null);const ie=yield $a.getUserFollowedArtists(D),ee=yield Promise.all(ie.map(H=>E(this,null,function*(){try{const{data:le}=yield supabase.from("events").select("*").ilike("artist_name",`%${H.artist_name}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(50),Se=(le||[]).map(he=>({id:he.id,title:he.title,artist_name:he.artist_name||H.artist_name,venue_name:he.venue_name,venue_id:he.venue_id,venue_city:he.venue_city,venue_state:he.venue_state,venue_address:he.venue_address,venue_zip:he.venue_zip,event_date:he.event_date,doors_time:he.doors_time,description:he.description,ticket_urls:he.ticket_urls||[],price_range:he.price_range,ticket_available:he.ticket_available,genres:he.genres,source:he.source||"jambase"}));console.log(` Checking events for "${H.artist_name}":`,{totalEvents:Se.length,events:Se.map(he=>({title:he.title,artist:he.artist_name,date:he.event_date,source:he.source}))});const ae=new Date,fe=Se.filter(he=>{var Ve,lt;const pe=he.event_date,qe=new Date(pe)>ae,Fe=(Ve=he.title)==null?void 0:Ve.toLowerCase().includes(H.artist_name.toLowerCase()),ve=((lt=he.artist_name)==null?void 0:lt.toLowerCase())===H.artist_name.toLowerCase(),rt=qe&&(Fe||ve);return!rt&&qe&&console.log(` Event not matched for "${H.artist_name}":`,{title:he.title,artistInEvent:he.artist_name,titleContainsArtist:Fe,exactArtistMatch:ve}),rt});return console.log(` Filtered upcoming events for "${H.artist_name}":`,{count:fe.length,events:fe.map(he=>({title:he.title,date:he.event_date,source:he.source}))}),W(M({},H),{upcomingEvents:fe})}catch(le){return console.warn(`Error loading events for artist ${H.artist_name}:`,le),W(M({},H),{upcomingEvents:[]})}})));o(ee)}catch(ie){console.error("Error loading followed artists:",ie),f("Failed to load followed artists")}finally{u(!1)}}),Y=()=>E(this,null,function*(){try{const ie=yield uu.getUserFollowedVenues(D),ee=yield Promise.all(ie.map(H=>E(this,null,function*(){try{const{data:le}=yield supabase.from("events").select("*").ilike("venue_name",`%${H.venue_name}%`).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(50),Se=(le||[]).map(he=>({id:he.id,title:he.title,artist_name:he.artist_name||"Unknown Artist",venue_name:he.venue_name,venue_id:he.venue_id,venue_city:he.venue_city,venue_state:he.venue_state,venue_address:he.venue_address,venue_zip:he.venue_zip,event_date:he.event_date,doors_time:he.doors_time,description:he.description,ticket_urls:he.ticket_urls||[],price_range:he.price_range,ticket_available:he.ticket_available,genres:he.genres,source:he.source||"jambase"})),ae=new Date,fe=Se.filter(he=>new Date(he.event_date)>ae);return console.log(` Filtered upcoming events for "${H.venue_name}":`,{count:fe.length,events:fe.map(he=>({title:he.title,date:he.event_date,source:he.source}))}),W(M({},H),{upcomingEvents:fe})}catch(le){return console.warn(`Error loading events for venue ${H.venue_name}:`,le),W(M({},H),{upcomingEvents:[]})}})));c(ee)}catch(ie){console.error("Error loading followed venues:",ie)}});y.useEffect(()=>{(a.length>0||l.length>0)&&z()},[a,l]);const z=()=>{const ie=a.flatMap(ae=>ae.upcomingEvents.map(fe=>W(M({},fe),{source:"artist",sourceName:ae.artist_name}))),ee=l.flatMap(ae=>ae.upcomingEvents.map(fe=>W(M({},fe),{source:"venue",sourceName:ae.venue_name}))),H=[...ie,...ee],le=se(H),Se=ue(le);x(Se)},K=ie=>{v(ie)},Z=ie=>{w(ie),N(null),v(null),k("artist")},G=ie=>{N(ie),w(null),v(null),k("venue")},X=(ie,ee)=>{if(ie==="artist"){const H=a.find(le=>le.artist_name===ee);H&&Z(H)}else if(ie==="venue"){const H=l.find(le=>le.venue_name===ee);H&&G(H)}},te=()=>{localStorage.setItem("intendedView","profile"),e("/")},se=ie=>R==="all"?ie:ie.filter(ee=>ee.source===R),ue=ie=>[...ie].sort((ee,H)=>{let le=0;switch(O){case"date":le=new Date(ee.event_date).getTime()-new Date(H.event_date).getTime();break;case"location":const Se=`${ee.venue_city}, ${ee.venue_state}`.toLowerCase(),ae=`${H.venue_city}, ${H.venue_state}`.toLowerCase();le=Se.localeCompare(ae);break;case"price":const fe=ee.price_range||"",he=H.price_range||"";le=fe.localeCompare(he);break}return T==="asc"?le:-le}),ye=()=>_?s.jsx("div",{className:"h-full overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Vr,{className:"w-16 h-16",children:[s.jsx(Qr,{src:_.artist_image_url}),s.jsx(qr,{className:"bg-pink-100 text-pink-600",children:s.jsx(Ct,{className:"w-8 h-8"})})]}),s.jsxs("div",{children:[s.jsx("button",{className:"text-2xl font-bold text-left hover:text-pink-600 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 rounded",onClick:()=>{console.log(" Artist name clicked in header:",_.artist_name),e(`/artist/${_.artist_id||encodeURIComponent(_.artist_name)}`)},title:`Click to view ${_.artist_name}'s full profile`,children:_.artist_name}),s.jsxs("p",{className:"text-gray-600",children:["Following since ",Dt(new Date(_.created_at),"MMM d, yyyy")]})]})]}),s.jsxs(oe,{variant:"default",size:"sm",onClick:()=>{console.log(" Back to all events clicked from artist details"),k("events"),w(null)},className:"bg-pink-500 hover:bg-pink-600 text-white border-0 shadow-sm",children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back to All Events"]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(Et,{className:"w-5 h-5 text-pink-500"}),"Upcoming Events (",_.upcomingEvents.length,")"]}),_.upcomingEvents.length>0?s.jsx("div",{className:"space-y-4",children:ue(_.upcomingEvents).map(ie=>s.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>K(ie),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("h4",{className:"font-medium text-lg",children:ie.title})}),ie.sourceName&&s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["via"," ",s.jsx("button",{onClick:ee=>{ee.stopPropagation(),X(ie.source,ie.sourceName)},className:"text-pink-600 hover:text-pink-700 hover:underline cursor-pointer",children:ie.sourceName})]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Et,{className:"w-4 h-4"}),Dt(new Date(ie.event_date),"MMM d, yyyy")]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Xt,{className:"w-4 h-4"}),ie.venue_city,", ",ie.venue_state]})]}),ie.venue_address&&ie.venue_address!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-500 mb-2",children:ie.venue_address}),ie.description&&ie.description!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:ie.description})]}),s.jsx("div",{className:"flex flex-col items-end gap-2",children:ie.ticket_urls&&ie.ticket_urls.length>0&&s.jsx(aa,{className:"w-4 h-4 text-pink-500"})})]})},ie.id))}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Et,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:"No upcoming events found"})]})]})]})}):null,ne=()=>b?s.jsx("div",{className:"h-full overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(Vr,{className:"w-16 h-16",children:s.jsx(qr,{className:"bg-blue-100 text-blue-600",children:s.jsx(Ba,{className:"w-8 h-8"})})}),s.jsxs("div",{children:[s.jsx("button",{className:"text-2xl font-bold text-left hover:text-blue-600 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded",onClick:()=>{console.log(" Venue name clicked in header:",b.venue_name),e(`/venue/${encodeURIComponent(b.venue_name)}`)},title:`Click to view ${b.venue_name}'s full profile`,children:b.venue_name}),s.jsxs("p",{className:"text-gray-600",children:[b.venue_city,", ",b.venue_state]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Following since ",Dt(new Date(b.created_at),"MMM d, yyyy")]})]})]}),s.jsxs(oe,{variant:"default",size:"sm",onClick:()=>{k("events"),N(null)},className:"bg-blue-500 hover:bg-blue-600 text-white border-0 shadow-sm",children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back to All Events"]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(Et,{className:"w-5 h-5 text-blue-500"}),"Upcoming Events (",b.upcomingEvents.length,")"]}),b.upcomingEvents.length>0?s.jsx("div",{className:"space-y-4",children:ue(b.upcomingEvents).map(ie=>s.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>K(ie),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("h4",{className:"font-medium text-lg",children:ie.title}),ie.artist_name&&s.jsx("p",{className:"text-sm text-gray-600",children:ie.artist_name})]}),s.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Et,{className:"w-4 h-4"}),Dt(new Date(ie.event_date),"MMM d, yyyy")]})}),ie.description&&ie.description!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:ie.description})]}),s.jsx("div",{className:"flex flex-col items-end gap-2",children:ie.ticket_urls&&ie.ticket_urls.length>0&&s.jsx(aa,{className:"w-4 h-4 text-blue-500"})})]})},ie.id))}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Et,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:"No upcoming events found"})]})]})]})}):null,xe=()=>p.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[s.jsx(Et,{className:"w-16 h-16 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Upcoming Events"}),s.jsx("p",{className:"text-gray-500 mb-4",children:a.length===0&&l.length===0?B?"Start following artists and venues to see their upcoming events here!":"This user isn't following any artists or venues yet.":"None of your followed artists or venues have upcoming events at the moment."}),B&&a.length===0&&l.length===0&&s.jsxs(oe,{onClick:()=>e("/search"),className:"bg-pink-500 hover:bg-pink-600",children:[s.jsx(Ct,{className:"w-4 h-4 mr-2"}),"Discover Artists & Venues"]})]}):s.jsx("div",{className:"h-full overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Et,{className:"w-6 h-6 text-pink-500"}),s.jsx("h2",{className:"text-xl font-bold",children:S==="artist"?`${_==null?void 0:_.artist_name}'s Events`:"Upcoming Events"}),s.jsx(Be,{variant:"secondary",className:"bg-pink-100 text-pink-700",children:S==="artist"?_==null?void 0:_.upcomingEvents.length:p.length})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(xw,{className:"w-4 h-4 text-gray-500"}),s.jsxs(Xs,{value:R,onValueChange:ie=>F(ie),children:[s.jsx(Ds,{className:"w-32 bg-white border border-gray-300 hover:border-pink-300 focus:border-pink-500",children:s.jsx(Js,{})}),s.jsxs(Is,{className:"bg-white border border-gray-200 shadow-lg",children:[s.jsx(Lt,{value:"all",className:"hover:bg-pink-50 focus:bg-pink-50",children:"All"}),s.jsx(Lt,{value:"artists",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Artists"}),s.jsx(Lt,{value:"venues",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Venues"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Xs,{value:O,onValueChange:ie=>A(ie),children:[s.jsx(Ds,{className:"w-32 bg-white border border-gray-300 hover:border-pink-300 focus:border-pink-500",children:s.jsx(Js,{})}),s.jsxs(Is,{className:"bg-white border border-gray-200 shadow-lg",children:[s.jsx(Lt,{value:"date",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Date"}),s.jsx(Lt,{value:"location",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Location"}),s.jsx(Lt,{value:"price",className:"hover:bg-pink-50 focus:bg-pink-50",children:"Price"})]})]}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>$(T==="asc"?"desc":"asc"),className:"px-2",children:T==="asc"?s.jsx(NJ,{className:"w-4 h-4"}):s.jsx(wJ,{className:"w-4 h-4"})})]}),S==="artist"&&s.jsxs(oe,{variant:"default",size:"sm",onClick:()=>{console.log(" Back to all events clicked"),k("events"),w(null)},className:"bg-pink-500 hover:bg-pink-600 text-white border-0 shadow-sm",children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back to All Events"]})]})]}),s.jsx("div",{className:"space-y-4",children:(S==="artist"&&_?_.upcomingEvents:p).map(ie=>s.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>K(ie),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("h4",{className:"font-medium text-lg",children:ie.title})}),ie.sourceName&&s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["via"," ",s.jsx("button",{onClick:ee=>{ee.stopPropagation(),X(ie.source,ie.sourceName)},className:"text-pink-600 hover:text-pink-700 hover:underline cursor-pointer",children:ie.sourceName})]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Et,{className:"w-4 h-4"}),Dt(new Date(ie.event_date),"MMM d, yyyy")]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Xt,{className:"w-4 h-4"}),ie.venue_city,", ",ie.venue_state]})]}),ie.venue_address&&ie.venue_address!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-500 mb-2",children:ie.venue_address}),ie.description&&ie.description!=="NULL"&&s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:ie.description})]}),s.jsx("div",{className:"flex flex-col items-end gap-2",children:ie.ticket_urls&&ie.ticket_urls.length>0&&s.jsx(aa,{className:"w-4 h-4 text-pink-500"})})]})},`${ie.id}-${ie.title}-${ie.artist_name}`))})]})});return d?s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx(er,{className:"w-8 h-8 animate-spin text-pink-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading followed artists..."})]})})}):h?s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:h}),s.jsxs(oe,{onClick:te,variant:"outline",children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:te,className:"hover:bg-gray-100",children:[s.jsx(us,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"flex items-center gap-3",children:[n==="artists"?s.jsx(Ct,{className:"w-6 h-6 text-pink-500"}):s.jsx(Ba,{className:"w-6 h-6 text-blue-500"}),s.jsx("h1",{className:"text-2xl font-bold",children:B?"Following":`${U}'s Following`}),s.jsx(Be,{variant:"secondary",className:"bg-gray-100 text-gray-700",children:a.length+l.length})]})]}),s.jsx(Cl,{value:n,onValueChange:ie=>{i(ie),w(null),N(null),v(null),k("events")},children:s.jsxs(Fo,{children:[s.jsxs(Tn,{value:"artists",className:"gap-2",children:[s.jsx(Ct,{className:"w-4 h-4"}),"Artists (",a.length,")"]}),s.jsxs(Tn,{value:"venues",className:"gap-2",children:[s.jsx(Ba,{className:"w-4 h-4"}),"Venues (",l.length,")"]})]})})]})}),s.jsxs("div",{className:"flex h-[calc(100vh-80px)]",children:[s.jsxs("div",{className:"w-1/3 bg-white border-r border-gray-200 flex flex-col",children:[s.jsxs("div",{className:"p-4 border-b border-gray-200",children:[s.jsx("h2",{className:"font-semibold text-gray-900",children:n==="artists"?"Followed Artists":"Followed Venues"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:n==="artists"?`Click an artist to view their details  ${a.reduce((ie,ee)=>ie+ee.upcomingEvents.length,0)} upcoming events`:`Click a venue to view their details  ${l.reduce((ie,ee)=>ie+ee.upcomingEvents.length,0)} upcoming events`})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:n==="artists"?a.length===0?s.jsxs("div",{className:"p-4 text-center text-gray-500",children:[s.jsx(Ct,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"No artists followed"})]}):s.jsx("div",{className:"divide-y divide-gray-100",children:a.map(ie=>s.jsx("div",{"data-artist-id":ie.artist_id,className:`p-4 cursor-pointer transition-colors hover:bg-gray-50 ${(_==null?void 0:_.artist_id)===ie.artist_id?"bg-pink-50 border-r-2 border-pink-500":""}`,onClick:()=>Z(ie),children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Vr,{className:"w-10 h-10 flex-shrink-0",children:[s.jsx(Qr,{src:ie.artist_image_url}),s.jsx(qr,{className:"bg-pink-100 text-pink-600",children:s.jsx(Ct,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-medium text-gray-900 truncate",children:ie.artist_name}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsxs("p",{className:"text-xs text-gray-500",children:[ie.upcomingEvents.length," upcoming events"]}),ie.upcomingEvents.length>0&&s.jsx(Be,{variant:"secondary",className:"text-xs bg-green-100 text-green-700",children:ie.upcomingEvents.length})]})]})]})},ie.artist_id))}):l.length===0?s.jsxs("div",{className:"p-4 text-center text-gray-500",children:[s.jsx(Ba,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"No venues followed"})]}):s.jsx("div",{className:"divide-y divide-gray-100",children:l.map(ie=>s.jsx("div",{className:`p-4 cursor-pointer transition-colors hover:bg-gray-50 ${(b==null?void 0:b.id)===ie.id?"bg-blue-50 border-r-2 border-blue-500":""}`,onClick:()=>G(ie),children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Vr,{className:"w-10 h-10 flex-shrink-0",children:s.jsx(qr,{className:"bg-blue-100 text-blue-600",children:s.jsx(Ba,{className:"w-5 h-5"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-medium text-gray-900 truncate",children:ie.venue_name}),s.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[ie.venue_city,", ",ie.venue_state]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsxs("p",{className:"text-xs text-gray-500",children:[ie.upcomingEvents.length," upcoming events"]}),ie.upcomingEvents.length>0&&s.jsx(Be,{variant:"secondary",className:"text-xs bg-green-100 text-green-700",children:ie.upcomingEvents.length})]})]})]})},ie.id))})})]}),s.jsx("div",{className:"flex-1 bg-white",children:S==="artist"&&_?ye():S==="venue"&&b?ne():xe()})]}),g&&s.jsx(tn,{open:!!g,onOpenChange:()=>v(null),children:s.jsxs(Xr,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsx(Mn,{children:s.jsxs(an,{className:"flex items-center gap-2",children:[s.jsx(Et,{className:"w-5 h-5 text-pink-500"}),"Event Details"]})}),s.jsx("div",{className:"mt-4",children:s.jsx(hY,{event:g,currentUserId:(r==null?void 0:r.id)||"",showInterestButton:!1,showReviewButton:!1})})]})})]})}function FLe(){const{user:e,loading:t,sessionExpired:r}=os(),{accountInfo:n,loading:i,isAdmin:a}=Wu(),[o,l]=y.useState([]),[c,d]=y.useState(!0),[u,h]=y.useState(null),[f,p]=y.useState(""),[x,g]=y.useState(1),[v,_]=y.useState(0),[w,b]=y.useState(""),N=50,S=()=>{};y.useEffect(()=>{e&&a()&&k()},[e,x,w]);const k=()=>E(this,null,function*(){try{d(!0),h(null);const $=(x-1)*N;let R=P.from("users_complete").select("*",{count:"exact"}).order("created_at",{ascending:!1}).range($,$+N-1);w&&(R=R.eq("account_type",w)),f&&(R=R.or(`name.ilike.%${f}%,username.ilike.%${f}%,instagram_handle.ilike.%${f}%`));const{data:F,error:D,count:B}=yield R;if(D)throw D;l(F||[]),_(B||0)}catch($){console.error("Error fetching users:",$),h($.message||"Failed to fetch users")}finally{d(!1)}}),O=()=>{E(this,null,function*(){try{d(!0),h(null);let R=P.from("users_complete").select("*",{count:"exact"}).order("created_at",{ascending:!1}).range(0,N-1);w&&(R=R.eq("account_type",w)),f&&(R=R.or(`name.ilike.%${f}%,username.ilike.%${f}%,instagram_handle.ilike.%${f}%`));const{data:F,error:D,count:B}=yield R;if(D)throw D;l(F||[]),_(B||0),g(1)}catch(R){console.error("Error fetching users:",R),h(R.message||"Failed to fetch users")}finally{d(!1)}})},A=()=>{const $=["ID","User ID","Name","Username","Email","Account Type","Verified","Subscription Tier","Moderation Status","Location","Created At","Last Active"],R=o.map(V=>[V.id,V.user_id,V.name||"",V.username||"","",V.account_type,V.verified?"Yes":"No",V.subscription_tier,V.moderation_status,`${V.location_city||""}${V.location_state?", "+V.location_state:""}`,new Date(V.created_at).toLocaleDateString(),V.last_active_at?new Date(V.last_active_at).toLocaleDateString():"Never"]),F=[$.join(","),...R.map(V=>V.map(Y=>`"${Y}"`).join(","))].join(`
`),D=new Blob([F],{type:"text/csv"}),B=URL.createObjectURL(D),U=document.createElement("a");U.href=B,U.download=`users-export-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(B)},T=Math.ceil(v/N);return t||i?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Sa,{className:"w-8 h-8 animate-spin text-pink-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):!e||r?s.jsx(Pz,{onAuthSuccess:S}):a()?s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(Ql,{className:"w-8 h-8 text-pink-600"}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"})]}),s.jsx("p",{className:"text-gray-600",children:"Manage users and monitor platform activity"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:k,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50",children:[s.jsx(Sa,{className:`w-4 h-4 ${c?"animate-spin":""}`}),"Refresh"]}),s.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2 bg-pink-600 hover:bg-pink-700 text-white rounded-lg transition-colors",children:[s.jsx(yv,{className:"w-4 h-4"}),"Export CSV"]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ar,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.toLocaleString()})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ql,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Verified Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter($=>$.verified).length})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ar,{className:"w-5 h-5 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Active Users"})]}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter($=>{if(!$.last_active_at)return!1;const R=new Date($.last_active_at),F=new Date(Date.now()-7*24*60*60*1e3);return R>F}).length})]}),s.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ql,{className:"w-5 h-5 text-red-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Moderation Issues"})]}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter($=>$.moderation_status!=="good_standing").length})]})]}),s.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm mb-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(Mi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search by name, username, or Instagram handle...",value:f,onChange:$=>p($.target.value),onKeyPress:$=>$.key==="Enter"&&O(),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent"})]})}),s.jsxs("select",{value:w,onChange:$=>{b($.target.value),g(1)},className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"All Account Types"}),s.jsx("option",{value:"user",children:"User"}),s.jsx("option",{value:"creator",children:"Creator"}),s.jsx("option",{value:"business",children:"Business"}),s.jsx("option",{value:"admin",children:"Admin"})]}),s.jsx("button",{onClick:O,className:"px-6 py-2 bg-pink-600 hover:bg-pink-700 text-white rounded-lg transition-colors",children:"Search"})]})}),u&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-800",children:u})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:c?s.jsxs("div",{className:"p-12 text-center",children:[s.jsx(Sa,{className:"w-8 h-8 animate-spin text-pink-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading users..."})]}):o.length===0?s.jsxs("div",{className:"p-12 text-center",children:[s.jsx(Ar,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"No users found"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subscription"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Active"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map($=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:$.avatar_url?s.jsx("img",{className:"h-10 w-10 rounded-full",src:$.avatar_url,alt:$.name}):s.jsx("div",{className:"h-10 w-10 rounded-full bg-pink-100 flex items-center justify-center",children:s.jsx("span",{className:"text-pink-600 font-medium",children:$.name.charAt(0).toUpperCase()})})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:$.name}),s.jsxs("div",{className:"text-sm text-gray-500",children:[$.username&&`@${$.username}`,$.instagram_handle&&`  ${$.instagram_handle}`]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${$.account_type==="admin"?"bg-red-100 text-red-800":$.account_type==="creator"?"bg-purple-100 text-purple-800":$.account_type==="business"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:$.account_type})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${$.moderation_status==="good_standing"?"bg-green-100 text-green-800":$.moderation_status==="warned"?"bg-yellow-100 text-yellow-800":$.moderation_status==="restricted"?"bg-orange-100 text-orange-800":$.moderation_status==="suspended"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:$.moderation_status.replace("_"," ")}),$.verified&&s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Verified"})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${$.subscription_tier==="enterprise"?"bg-purple-100 text-purple-800":$.subscription_tier==="professional"?"bg-blue-100 text-blue-800":$.subscription_tier==="premium"?"bg-pink-100 text-pink-800":"bg-gray-100 text-gray-800"}`,children:$.subscription_tier})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[$.location_city||"N/A",$.location_state&&`, ${$.location_state}`]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date($.created_at).toLocaleDateString()}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:$.last_active_at?new Date($.last_active_at).toLocaleDateString():"Never"})]},$.id))})]})}),T>1&&s.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(x-1)*N+1," to ",Math.min(x*N,v)," of ",v," users"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>g($=>Math.max(1,$-1)),disabled:x===1,className:"px-3 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:s.jsx(KD,{className:"w-4 h-4"})}),s.jsxs("span",{className:"px-4 py-2 text-sm text-gray-700",children:["Page ",x," of ",T]}),s.jsx("button",{onClick:()=>g($=>Math.min(T,$+1)),disabled:x===T,className:"px-3 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:s.jsx(vw,{className:"w-4 h-4"})})]})]})]})})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:s.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8 text-center",children:[s.jsx(Ql,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"You need administrator privileges to access this page."}),s.jsx("button",{onClick:()=>window.location.href="/",className:"px-6 py-2 bg-pink-600 hover:bg-pink-700 text-white rounded-lg transition-colors",children:"Go to Home"})]})})}const ULe=({menuOpen:e=!1,onMenuClick:t})=>s.jsx("header",{className:"mobile-header",role:"banner",children:s.jsxs("div",{className:"mobile-header__container",children:[s.jsx("div",{className:"mobile-header__center"}),s.jsx("button",{className:"mobile-header__menu-button",onClick:t,"aria-label":e?"Close menu":"Open menu","aria-expanded":e,type:"button",children:e?s.jsx(Ca,{name:"x",size:24,alt:""}):s.jsx(Ca,{name:"hamburgerMenu",size:24,alt:""})})]})}),BLe=()=>{const e=ci(),r=Md().pathname,n=r==="/mobile-preview/home"||r==="/mobile-preview",i=r==="/mobile-preview/discover",a=r==="/mobile-preview/post",o=r==="/mobile-preview/messages",l=r==="/mobile-preview/profile",c=[{id:"home",label:"Home",icon:n?"houseSelected":"house",path:"/mobile-preview/home",isActive:n},{id:"discover",label:"Discover",icon:i?"discoverSelected":"discover",path:"/mobile-preview/discover",isActive:i},{id:"post",label:"Post",icon:"plus",path:"/mobile-preview/post",isActive:a,isCTA:!0},{id:"messages",label:"Messages",icon:o?"circleCommentSelected":"circleComment",path:"/mobile-preview/messages",isActive:o},{id:"profile",label:"Profile",icon:l?"userSelected":"user",path:"/mobile-preview/profile",isActive:l}],d=u=>{e(u)};return s.jsx("nav",{className:"bottom-nav",role:"navigation","aria-label":"Main navigation",children:s.jsx("div",{className:"bottom-nav__container",children:c.map(u=>u.isCTA?s.jsx("button",{className:"bottom-nav__item bottom-nav__item--cta",onClick:()=>d(u.path),"aria-label":u.label,"aria-current":u.isActive?"page":void 0,type:"button",children:s.jsx(Ca,{name:u.icon,size:24,alt:""})},u.id):s.jsx("button",{className:`bottom-nav__item ${u.isActive?"bottom-nav__item--active":""}`,onClick:()=>d(u.path),"aria-label":u.label,"aria-current":u.isActive?"page":void 0,type:"button",children:s.jsx(Ca,{name:u.icon,size:24,alt:""})},u.id))})})},zLe=()=>s.jsx("div",{className:"mobile-page",children:s.jsx("h1",{className:"mobile-page__title",children:"Home"})}),VLe=()=>s.jsx("div",{className:"mobile-page",children:s.jsx("h1",{className:"mobile-page__title",children:"Discover"})}),qLe=()=>s.jsx("div",{className:"mobile-page",children:s.jsx("h1",{className:"mobile-page__title",children:"Post"})}),WLe=()=>s.jsx("div",{className:"mobile-page",children:s.jsx("h1",{className:"mobile-page__title",children:"Messages"})}),HLe=()=>s.jsx("div",{className:"mobile-page",children:s.jsx("h1",{className:"mobile-page__title",children:"Profile"})}),GLe=()=>{const[e,t]=Q.useState(!1);K$(e);const r=()=>{t(!e)},n=()=>{t(!1)};return s.jsxs("div",{className:"mobile-preview",children:[s.jsx(ULe,{menuOpen:e,onMenuClick:r}),s.jsx("main",{className:"mobile-preview__content",children:s.jsxs(fE,{children:[s.jsx(Bs,{index:!0,element:s.jsx(g$,{to:"home",replace:!0})}),s.jsx(Bs,{path:"home",element:s.jsx(zLe,{})}),s.jsx(Bs,{path:"discover",element:s.jsx(VLe,{})}),s.jsx(Bs,{path:"post",element:s.jsx(qLe,{})}),s.jsx(Bs,{path:"messages",element:s.jsx(WLe,{})}),s.jsx(Bs,{path:"profile",element:s.jsx(HLe,{})})]})}),s.jsx(BLe,{}),s.jsx(Y$,{isOpen:e,onClose:n,onToggle:r})]})},YLe=new Ere,KLe=()=>(console.log(" App component is rendering..."),s.jsx("div",{className:"synth-app",children:s.jsx(Pre,{client:YLe,children:s.jsxs(oE,{children:[s.jsx(BQ,{}),s.jsx(yee,{}),s.jsx(x$,{children:s.jsxs(fE,{children:[s.jsx(Bs,{path:"/",element:s.jsx(DLe,{})}),s.jsx(Bs,{path:"/admin",element:s.jsx(FLe,{})}),s.jsx(Bs,{path:"/artist/:artistId",element:s.jsx(ILe,{})}),s.jsx(Bs,{path:"/venue/:venueId",element:s.jsx($Le,{})}),s.jsx(Bs,{path:"/streaming-stats",element:s.jsx(LLe,{})}),s.jsx(Bs,{path:"/following",element:s.jsx(ZO,{})}),s.jsx(Bs,{path:"/following/:userId",element:s.jsx(ZO,{})}),s.jsx(Bs,{path:"/auth/spotify/callback",element:s.jsx(Die,{})}),s.jsx(Bs,{path:"/mobile-preview/*",element:s.jsx(GLe,{})}),s.jsx(Bs,{path:"*",element:s.jsx(hne,{})})]})})]})})}));/*! Capacitor: https://capacitorjs.com/ - MIT License */var Lm;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(Lm||(Lm={}));class wN extends Error{constructor(t,r,n){super(t),this.message=t,this.code=r,this.data=n}}const ZLe=e=>{var t,r;return e!=null&&e.androidBridge?"android":!((r=(t=e==null?void 0:e.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},XLe=e=>{const t=e.CapacitorCustomPlatform||null,r=e.Capacitor||{},n=r.Plugins=r.Plugins||{},i=()=>t!==null?t.name:ZLe(e),a=()=>i()!=="web",o=h=>{const f=d.get(h);return!!(f!=null&&f.platforms.has(i())||l(h))},l=h=>{var f;return(f=r.PluginHeaders)===null||f===void 0?void 0:f.find(p=>p.name===h)},c=h=>e.console.error(h),d=new Map,u=(h,f={})=>{const p=d.get(h);if(p)return console.warn(`Capacitor plugin "${h}" already registered. Cannot register plugins twice.`),p.proxy;const x=i(),g=l(h);let v;const _=()=>E(void 0,null,function*(){return!v&&x in f?v=typeof f[x]=="function"?v=yield f[x]():v=f[x]:t!==null&&!v&&"web"in f&&(v=typeof f.web=="function"?v=yield f.web():v=f.web),v}),w=(A,T)=>{var $,R;if(g){const F=g==null?void 0:g.methods.find(D=>T===D.name);if(F)return F.rtype==="promise"?D=>r.nativePromise(h,T.toString(),D):(D,B)=>r.nativeCallback(h,T.toString(),D,B);if(A)return($=A[T])===null||$===void 0?void 0:$.bind(A)}else{if(A)return(R=A[T])===null||R===void 0?void 0:R.bind(A);throw new wN(`"${h}" plugin is not implemented on ${x}`,Lm.Unimplemented)}},b=A=>{let T;const $=(...R)=>{const F=_().then(D=>{const B=w(D,A);if(B){const U=B(...R);return T=U==null?void 0:U.remove,U}else throw new wN(`"${h}.${A}()" is not implemented on ${x}`,Lm.Unimplemented)});return A==="addListener"&&(F.remove=()=>E(void 0,null,function*(){return T()})),F};return $.toString=()=>`${A.toString()}() { [capacitor code] }`,Object.defineProperty($,"name",{value:A,writable:!1,configurable:!1}),$},N=b("addListener"),S=b("removeListener"),k=(A,T)=>{const $=N({eventName:A},T),R=()=>E(void 0,null,function*(){const D=yield $;S({eventName:A,callbackId:D},T)}),F=new Promise(D=>$.then(()=>D({remove:R})));return F.remove=()=>E(void 0,null,function*(){console.warn("Using addListener() without 'await' is deprecated."),yield R()}),F},O=new Proxy({},{get(A,T){switch(T){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return g?k:N;case"removeListener":return S;default:return b(T)}}});return n[h]=O,d.set(h,{name:h,proxy:O,platforms:new Set([...Object.keys(f),...g?[x]:[]])}),O};return r.convertFileSrc||(r.convertFileSrc=h=>h),r.getPlatform=i,r.handleError=c,r.isNativePlatform=a,r.isPluginAvailable=o,r.registerPlugin=u,r.Exception=wN,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},JLe=e=>e.Capacitor=XLe(e),G5=JLe(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{}),fb=G5.registerPlugin;class qC{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,r){let n=!1;this.listeners[t]||(this.listeners[t]=[],n=!0),this.listeners[t].push(r);const a=this.windowListeners[t];a&&!a.registered&&this.addWindowListener(a),n&&this.sendRetainedArgumentsForEvent(t);const o=()=>E(this,null,function*(){return this.removeListener(t,r)});return Promise.resolve({remove:o})}removeAllListeners(){return E(this,null,function*(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}})}notifyListeners(t,r,n){const i=this.listeners[t];if(!i){if(n){let a=this.retainedEventArguments[t];a||(a=[]),a.push(r),this.retainedEventArguments[t]=a}return}i.forEach(a=>a(r))}hasListeners(t){var r;return!!(!((r=this.listeners[t])===null||r===void 0)&&r.length)}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:n=>{this.notifyListeners(r,n)}}}unimplemented(t="not implemented"){return new G5.Exception(t,Lm.Unimplemented)}unavailable(t="not available"){return new G5.Exception(t,Lm.Unavailable)}removeListener(t,r){return E(this,null,function*(){const n=this.listeners[t];if(!n)return;const i=n.indexOf(r);this.listeners[t].splice(i,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])})}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const r=this.retainedEventArguments[t];r&&(delete this.retainedEventArguments[t],r.forEach(n=>{this.notifyListeners(t,n)}))}}const XO=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),JO=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class QLe extends qC{getCookies(){return E(this,null,function*(){const t=document.cookie,r={};return t.split(";").forEach(n=>{if(n.length<=0)return;let[i,a]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");i=JO(i).trim(),a=JO(a).trim(),r[i]=a}),r})}setCookie(t){return E(this,null,function*(){try{const r=XO(t.key),n=XO(t.value),i=`; expires=${(t.expires||"").replace("expires=","")}`,a=(t.path||"/").replace("path=",""),o=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${n||""}${i}; path=${a}; ${o};`}catch(r){return Promise.reject(r)}})}deleteCookie(t){return E(this,null,function*(){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}})}clearCookies(){return E(this,null,function*(){try{const t=document.cookie.split(";")||[];for(const r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}})}clearAllCookies(){return E(this,null,function*(){try{yield this.clearCookies()}catch(t){return Promise.reject(t)}})}}fb("CapacitorCookies",{web:()=>new QLe});const eFe=e=>E(void 0,null,function*(){return new Promise((t,r)=>{const n=new FileReader;n.onload=()=>{const i=n.result;t(i.indexOf(",")>=0?i.split(",")[1]:i)},n.onerror=i=>r(i),n.readAsDataURL(e)})}),tFe=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(i=>i.toLocaleLowerCase()).reduce((i,a,o)=>(i[a]=e[t[o]],i),{})},rFe=(e,t=!0)=>e?Object.entries(e).reduce((n,i)=>{const[a,o]=i;let l,c;return Array.isArray(o)?(c="",o.forEach(d=>{l=t?encodeURIComponent(d):d,c+=`${a}=${l}&`}),c.slice(0,-1)):(l=t?encodeURIComponent(o):o,c=`${a}=${l}`),`${n}&${c}`},"").substr(1):null,nFe=(e,t={})=>{const r=Object.assign({method:e.method||"GET",headers:e.headers},t),i=tFe(e.headers)["content-type"]||"";if(typeof e.data=="string")r.body=e.data;else if(i.includes("application/x-www-form-urlencoded")){const a=new URLSearchParams;for(const[o,l]of Object.entries(e.data||{}))a.set(o,l);r.body=a.toString()}else if(i.includes("multipart/form-data")||e.data instanceof FormData){const a=new FormData;if(e.data instanceof FormData)e.data.forEach((l,c)=>{a.append(c,l)});else for(const l of Object.keys(e.data))a.append(l,e.data[l]);r.body=a;const o=new Headers(r.headers);o.delete("content-type"),r.headers=o}else(i.includes("application/json")||typeof e.data=="object")&&(r.body=JSON.stringify(e.data));return r};class sFe extends qC{request(t){return E(this,null,function*(){const r=nFe(t,t.webFetchExtra),n=rFe(t.params,t.shouldEncodeUrlParams),i=n?`${t.url}?${n}`:t.url,a=yield fetch(i,r),o=a.headers.get("content-type")||"";let{responseType:l="text"}=a.ok?t:{};o.includes("application/json")&&(l="json");let c,d;switch(l){case"arraybuffer":case"blob":d=yield a.blob(),c=yield eFe(d);break;case"json":c=yield a.json();break;case"document":case"text":default:c=yield a.text()}const u={};return a.headers.forEach((h,f)=>{u[f]=h}),{data:c,headers:u,status:a.status,url:a.url}})}get(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))})}post(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))})}put(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))})}patch(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))})}delete(t){return E(this,null,function*(){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))})}}fb("CapacitorHttp",{web:()=>new sFe});var QO;(function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"})(QO||(QO={}));var eR;(function(e){e.StatusBar="StatusBar",e.NavigationBar="NavigationBar"})(eR||(eR={}));class iFe extends qC{setStyle(){return E(this,null,function*(){this.unavailable("not available for web")})}setAnimation(){return E(this,null,function*(){this.unavailable("not available for web")})}show(){return E(this,null,function*(){this.unavailable("not available for web")})}hide(){return E(this,null,function*(){this.unavailable("not available for web")})}}fb("SystemBars",{web:()=>new iFe});const aFe=fb("SplashScreen",{web:()=>on(()=>import("./web-7t4THLBO.js"),[],import.meta.url).then(e=>new e.SplashScreenWeb)});console.log(" Main.tsx is executing...");const Gy=document.getElementById("root");console.log(" Root element:",Gy);if(!Gy)console.error(" Root element not found!");else{console.log(" Root element found, creating React root...");try{const e=wD(Gy);console.log(" React root created, rendering App..."),e.render(s.jsx(KLe,{})),console.log(" App rendered successfully!"),window.Capacitor!==void 0&&setTimeout(()=>E(void 0,null,function*(){try{yield aFe.hide(),console.log(" Splash screen hidden")}catch(r){console.log(" Splash screen not available:",r)}}),1e3)}catch(e){console.error(" Error rendering React app:",e),Gy.innerHTML="<h1>Error loading app</h1><p>Check console for details</p>"}}export{qC as W,on as _,fb as r,P as s};
